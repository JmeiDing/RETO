 1. The initial dropper malware is executed on the victim system. 2. The dropper contacts a command and control server and receives the upnphost payload. 3. Upnphost gathers system information and exfiltrates it via HTTPS to a C2 server. 4. Upnphost receives additional commands from the C2 server. 5. Upnphost exploits CVE-2015-1701 to escalate privileges and execute code in the Windows kernel. 6. The exploit hooks the Windows kernel callback table and overwrites a function pointer. 7. When window object creation calls the overwritten function, the malware's code executes instead. 8. The malware's code sets the window procedure to point to a kernel address. 9. The kernel executes the malware's window procedure code, achieving arbitrary code execution. 10. The malware copies the SYSTEM process token to gain complete privileges. 