 1. MuddyWater sends spear-phishing emails with document attachments containing malicious macros. 2. If the victim enables macros, a malicious VBE file is dropped and executed. 3. The VBE file contains obfuscated PowerShell code that gets decoded and saved with a .jpeg extension. 4. The PowerShell code collects system info and saves it to a file. 5. The malware queries the C2 server for commands, downloads a second stage payload if directed, and uploads system info. 6. The second stage payload can take screenshots, execute commands, and run PowerShell code. It communicates with the C2 via PHP scripts. 7. The group can then proceed with further attacks, data exfiltration, etc. using the foothold on the compromised system. 