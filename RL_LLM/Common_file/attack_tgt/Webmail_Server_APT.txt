 1. The attackers installed a malicious OWAAUTH.DLL module on the OWA server that impersonated a legitimate DLL file. 2. The malicious module intercepted HTTP requests to the OWA server and looked for username and password parameters. 3. When found, it encrypted and logged the usernames and passwords to a local file. Over 11,000 credentials were stolen. 4. The module also created a backdoor triggered by a special HTTP request parameter unique to the customer. 5. This backdoor allowed the attackers to execute code and SQL queries on the server. 6. The module used an HTTP module and request handlers to persist on the server and intercept traffic. 7. The attackers used the stolen credentials and backdoor access to maintain persistent control over the environment. 8. Cybereason detected the attack using endpoint visibility and malware hunting capabilities. 9. The customer was able to remediate the compromised OWA server. 