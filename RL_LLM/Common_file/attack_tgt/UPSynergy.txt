 1. Bemstour establishes an SMB connection to the victim and sends malformed packets to trigger a type confusion vulnerability, similar to EternalRomance. 2. This results in an out-of-bounds write primitive that Bemstour utilizes to overwrite data. 3. Bemstour uses a 0-day info leak vulnerability to disclose the address of a kernel object called CCB. 4. Using the write primitive from step 2, Bemstour overwrites a function pointer in the CCB to point to shellcode. 5. When the SMB connection is closed, the overwritten destructor function is called, executing Bemstour's shellcode. 6. The shellcode decrypts and executes DoublePulsar, setting up a hook for invalid SMB commands. 7. Further payloads can be sent via SMB and injected into processes using DoublePulsar. 