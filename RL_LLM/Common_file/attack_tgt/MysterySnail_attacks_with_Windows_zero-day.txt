1. The attacker sends a specially crafted request to the Windows server to trigger the CVE-2021-40449 vulnerability in the Win32k driver. 2. The exploit achieves a use-after-free condition during execution of the ResetDC function, allowing arbitrary code execution in the kernel. 3. The exploit leaks addresses of kernel modules to bypass kernel protections. 4. The elevated exploit process downloads and executes the MysterySnail remote access trojan (RAT). 5. The RAT gathers system information and sends it to the attacker's command and control server. 6. The attacker uses the RAT to execute commands and actions on the compromised server. 