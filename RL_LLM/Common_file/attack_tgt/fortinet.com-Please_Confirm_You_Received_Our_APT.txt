 1. The attackers send a spearphishing email to a Jordanian diplomat posing as IT staff. 2. The email contains a malicious Excel file with a macro that uses advanced techniques like sheet toggling and mouse checks. 3. The macro drops three files: a signed Microsoft binary, a config file, and the main malware update.exe. 4. Update.exe uses DNS tunneling and a DGA algorithm to communicate with three C2 servers. 5. The malware receives tasks and files from the C2 via the DNS tunnel. 6. It runs hardcoded PowerShell discovery commands focused on the victim's network. 7. Encrypted command output is exfiltrated back to the C2 through DNS requests. 8. Persistence is achieved via the Excel macro's scheduled task, not the malware itself. 9. Many details suggest the known APT group APT34 (OilRig) is behind this attack. 