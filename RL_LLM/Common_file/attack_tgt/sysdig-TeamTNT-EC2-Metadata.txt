1. TeamTNT exploits a misconfigured Kubernetes dashboard to gain access to a WordPress pod. 2. The attackers use wget to download a malicious bash script called aws2.sh. 3. The script attempts to steal AWS credentials using the EC2 instance metadata endpoint (169.254.169.254). 4. It extracts the AWS access key ID, secret access key, and session token from the metadata. 5. The credentials are saved to a local file called STEALER_OUT. 6. The file is exfiltrated to a remote server controlled by the attackers using curl. 7. With the stolen credentials, the attackers can move laterally in the cloud environment. 8. The metadata endpoint provides information about an EC2 instance and cannot be restricted through ACLs. 9. Recommended mitigations include disabling metadata access, using IMDSv2, restricting IAM roles, and minimizing privileges. 10. Detection can happen through tools like Falco that monitor for unexpected connections to the metadata endpoint. 