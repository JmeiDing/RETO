1. The attack starts with a malicious RTF file that exploits CVE-2012-0158. 2. The RTF file contains embedded shellcode that uses egghunting to find the RTF file in memory. 3. The first stage shellcode locates a second stage obfuscated shellcode and deobfuscates it. 4. The second stage shellcode extracts an embedded VBS file and decrypts it in two iterations. 5. The VBS file drops and decrypts a DLL file named wmiprvse.dll. 6. The wmiprvse.dll uses multiple layers of unpacking over several minutes to avoid analysis. 7. It builds its own import table at runtime to hide API calls. 8. Finally it connects to a WebDAV C&C server to exfiltrate system and user data using hardcoded credentials. 