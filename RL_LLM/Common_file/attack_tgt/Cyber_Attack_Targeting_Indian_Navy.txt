1. On January 25, 2017, the attackers sent spear-phishing emails purporting to be from the company Hidrofersa to targets at Mazagon Dock Shipbuilders Limited (MDL). 2. The emails contained Excel attachments with malicious macros. 3. If the victim enabled macros, the Excel file would execute a macro to download and install the KeyBase malware. 4. The macro used obfuscation and junk code to avoid detection and analysis. 5. The macro decoded a PowerShell script that downloaded the KeyBase executable file from a compromised university website. 6. The PowerShell script executed a UAC bypass technique to run the malware with high privileges. 7. The malware established persistence by copying itself to the All Users profile and adding a registry key to ensure it runs on startup. 8. The malware tracked user activity like keystrokes and screenshots but did not immediately connect to its command and control server. 9. After a long sleep time, the malware connected to the C2 server tripleshop[.]id hosted on a server in Indonesia. 10. The malware sent all the tracked user activity and screenshots to the C2 server. 11. Analysis suggests the attack originated from a Pakistan-based company, indicating a possible state-sponsored espionage campaign. 