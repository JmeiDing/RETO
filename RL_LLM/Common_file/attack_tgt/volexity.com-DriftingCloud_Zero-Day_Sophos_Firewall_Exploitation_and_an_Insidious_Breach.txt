1. The attacker exploited a zero-day vulnerability in Sophos firewall devices to gain initial access and compromise the firewall. 2. The attacker installed a malicious Java class file on the firewall to create a webshell backdoor on the user portal. 3. The attacker performed man-in-the-middle attacks to intercept credentials and cookies for externally hosted websites. 4. The stolen cookies were used to remotely access admin consoles and install PHP webshells on the websites. 5. The webshells were used to deploy malware like PupyRAT, Pantegana, and Sliver on the compromised web servers. 6. Privilege escalation attempts were made to gain broader access. 