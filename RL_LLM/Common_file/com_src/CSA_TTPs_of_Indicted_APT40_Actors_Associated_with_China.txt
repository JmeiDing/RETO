TLP:WHITETactics, Techniques, and Procedures of Indicted APT40 Actors Associated with China’s MSS Hainan State Security DepartmentProduct ID: AA21-200A July 19, 2021SUMMARY This Joint Cybersecurity Advisory was written by the Federal Bureau of Investigation (FBI) and the Cybersecurity and Infrastructure Security Agency (CISA) to provide information on a Chinese Advanced Persistent Threat (APT) group known in open-source reporting as APT40. This advisory provides APT40’s tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help cybersecurity practitioners identify and remediate APT40 intrusions and established footholds.APT40—aka BRONZE MOHAWK, FEVERDREAM, G0065, Gadolinium, GreenCrash, Hellsing, Kryptonite Panda, Leviathan, MUDCARP, Periscope, Temp.Periscope, and Temp.Jumper—is located in Haikou, Hainan Province, People’s Republic of China (PRC), and has been active since at least 2009. APT40 has targeted governmental organizations, companies, and universities in a wide range of industries—including biomedical, robotics, and maritime research—across the United States, Canada, Europe, the Middle East, and the South China Sea area, as well as industries included in China’s Belt and Road Initiative.On July 19, 2021, the U.S. Department of Justice (DOJ) unsealed an indictment against four APT40 cyber actors for their illicit computer network exploitation (CNE) activities via front company Hainan Xiandun Technology Development Company (Hainan Xiandun). Hainan Xiandun employee Wu Shurong cooperated with and carried out orders from PRC Ministry of State Security (MSS) Hainan State Security Department (HSSD) intelligence officers Ding Xiaoyang, Zhu Yunmin, and Cheng Qingmin to conduct CNE. Wu’s CNE activities resulted in the theft of trade secrets, intellectual property, and other high-value information from companies and organizations in the United States and abroad, as well as from multiple foreign governments. These MSS-affiliated actors targeted victims in the following industries: academia, aerospace/aviation, biomedical, defense industrial base, education, government, healthcare, manufacturing, maritime, research institutes, and transportation (rail and shipping).To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact your local FBI field office at www.fbi.gov/contact-us/field, or the FBI’s 24/7 Cyber Watch (CyWatch) at (855) 292-3937 or by e-mail at CyWatch@fbi.gov. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact. To request incident response resources or technical assistance related to these threats, contact CISA at CISAServiceDesk@cisa.dhs.gov. This document is marked TLP:WHITE. Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction. For more information on the Traffic Light Protocol, see url DETAILS This Joint Cybersecurity Advisory uses the MITRE ATT&CK® framework, version 9. See the ATT&CK for Enterprise framework for all referenced threat actor tactics and techniques.FBI | CISATLP:WHITEAPT40 [G0065] has used a variety of tactics and techniques and a large library of custom and open- source malware—much of which is shared with multiple other suspected Chinese groups—to establish initial access via user and administrator credentials, enable lateral movement once inside the network, and locate high value assets in order to exfiltrate data. Table 1 provides details on these tactics and techniques. Note: see the appendix for a list of the domains, file names, and malware MD5 hash values used to facilitate this activity.Table 1: APT40 ATT&CK Tactics and TechniquesTacticsActivities and Techniques• Gathered victim identity information [T1589] by collectingcompromised credentials [T1589.001]• Acquire infrastructure [T1583] to establish domains thatimpersonate legitimate entities [T1583.001], aka ‘typosquatting’, to use in watering hole attacks and as command and control (C2) [TA0011] infrastructure• Establish new [T1585.002] and compromise existing[T1586.002] email and social media accounts [1585.001] to conduct social engineering attacks• External remote services (e.g., virtual private network[VPN] services) [T1133]• Spearphishing emails with malicious attachments[T1566.001] and links [T1566.002]• Drive-by compromises [T1189] and exploitation of public-facing applications [T1190]• Access to valid [T1078], compromised administrative[T1078.001] accounts• Command and scripting interpreters [T1059] such asPowerShell [T1059.001]• Exploitation of software vulnerabilities in client applications to execute code [T1203] using lure documents that dropped malware exploiting various Common Vulnerabilities and Exposures (CVEs)Reconnaissance [TA0043] and Resource Development [TA0042]Initial Access [TA0001]Execution [TA0002]Page 2 of 14 | Product ID: AA21-200ATLP: WHITETLP:WHITEFBI | CISA• User execution [T1204] of malicious files [T1204.002] andlinks [T1566.002] attached to spearphishing emails [T1566.001]Persistence [TA0003], Privilege Escalation [TA0004], Credential Access [TA0006], Lateral Movement [TA0008]APT40 has used a combination of tool frameworks and malware to establish persistence, escalate privileges, map, and move laterally on victim networks. Additionally, APT 40 conducted internal spearphishing attacks [T1534] • BADFLICK/Greencrash • China Chopper [S0020] • Cobalt Strike [S0154] • Derusbi/PHOTO [S0021] • Murkytop (mt.exe)• NanHaiShu [S0228] • Orz/AirBreak [S0229] • PowerShell Empirejjdoor/Transporter jumpkick[S0363]• PowerSploit [S0194] • Server softwarecomponent: Web Shell [TA1505.003][S0233]Defense Evasion [TA0005], Command and Control [TA0011], Exfiltration [TA0010]• Use of steganography [T1027.003] to hide stolen datainside other files stored on GitHub• Protocol impersonation [T1001.003] by using ApplicationProgramming Interface (API) keys for Dropbox accounts in commands to upload stolen data to make it appear that the activity was a legitimate use of the Dropbox service• Protocol tunneling [T1572] and multi-hop proxies[T1090.003], including the use of Tor [S0183]• Use of domain typosquatting for C2 infrastructure[T1583.001]• Archive [T1560], encrypt [T1532], and stage collected data locally [T1074.001] and remotely [T1074.002] for exfiltration• Exfiltration over C2 channel [T1041]APT40 Indicators of Compromise See AA21-200.stix and the appendix for IOCs.Page 3 of 14 | Product ID: AA21-200ATLP: WHITEFBI | CISATLP:WHITEMITIGATIONS Network Defense-in-Depth Proper network defense-in-depth and adherence to information security best practices can assist in mitigating the threat and reducing the risk. The following guidance may assist organizations in developing network defense procedures. Patch and Vulnerability Management•Install vendor-provided and verified patches on all systems for critical vulnerabilities, prioritizing timely patching of internet-connected servers and software processing internet data—such as web browsers, browser plugins, and document readers.• Ensure proper migrating steps or compensating controls are implemented for vulnerabilitiesthat cannot be patched in a timely manner.• Maintain up-to-date antivirus signatures and engines. • Routinely audit configuration and patch management programs to ensure the ability to trackand mitigate emerging threats. Implementing a rigorous configuration and patch management program will hamper sophisticated cyber threat actors’ operations and protect resources and information systems.• Review the articles in the References section for more information on Chinese APTexploitation of common vulnerabilities.Protect Credentials• Strengthen credential requirements, regularly change passwords, and implement multi-factor authentication to protect individual accounts, particularly for webmail and VPN access and for accounts that access critical systems. Do not reuse passwords for multiple accounts.• Audit all remote authentications from trusted networks or service providers. • Detect mismatches by correlating credentials used within internal networks with thoseemployed on external-facing systems.• Log use of system administrator commands such as net, ipconfig, and ping. • Enforce principle of least privilege.Network Hygiene and Monitoring• Actively scan and monitor internet-accessible applications for unauthorized access,modification, and anomalous activities.• Actively monitor server disk use and audit for significant changes. • Log Domain Name Service (DNS) queries and consider blocking all outbound DNS requeststhat do not originate from approved DNS servers. Monitor DNS queries for C2 over DNS.• Develop and monitor the network and system baselines to allow for the identification ofanomalous activity. Audit logs for suspicious behavior.Page 4 of 14 | Product ID: AA21-200ATLP: WHITETLP:WHITEFBI | CISAIdentify and suspend access of users exhibiting unusual activity.• • Use allowlist or baseline comparison to monitor Windows event logs and network traffic todetect when a user maps a privileged administrative share on a Windows system.• Leverage multi-sourced threat-reputation services for files, DNS, URLs, IP addresses, andemail addresses.• Network device management interfaces—such as Telnet, Secure Shell (SSH), Winbox, and HTTP—should be turned off for wide area network (WAN) interfaces and secured with strong passwords and encryption when enabled.• When possible, segment critical information on air-gapped systems. Use strict access controlmeasures for critical data.REFERENCES• DOJ Press Release • Talos Intelligence: China Chopper Still Active 9 Years Later –url• CISA China Cyber Threat Overview webpage – url • CISA Alert TA15-314A: Compromised Web Servers and Web Shells - Threat Awareness andGuidance – url• CISA Alert AA20-133A: Top 10 Routinely Exploited Vulnerabilities – url• CISA Alert AA20-275A: Potential for China Cyber Response to Heightened U.S.-ChinaTensions – url• NSA Cybersecurity Advisory U/OO/179811-20: Chinese State-Sponsored Actors Exploit Publicly Known Vulnerabilities – url 1/0/CSA_CHINESE_EXPLOIT_VULNERABILITIES_UOO179811.PDFPage 5 of 14 | Product ID: AA21-200ATLP: WHITETLP:WHITEAPPENDIX: APT40 INDICATORS OF COMPROMISE APT40 used the following domains, file names, and malware MD5 hash values to facilitate the CNE activity outlined in this CSA between 2009 through 2018. DomainsProduct ID: AA21-200A July 19, 2021airbusocean[.]com ens-smithjonathan.rhcloud[.]com fishgatesite.wordpress[.]com goo2k88yyh2.chickenkiller[.]com gttdoskip[.]com url ed/ url 27469/angle-swift url 04206/swiftr-angle url 63346/gkimertdssdads url loader/commit/f9de338fb474fd970 a7375030642d04179b9245d url jack-newnb[.]com kAty197.chickenkiller[.]com louisdreyfu[.]com mail2.ignorelist[.]com masterroot[.]pw microsql-update[.]info newbb-news[.]com nfmybb[.]com nmw4xhipveaca7hm[.]onion.link/en _US/all.js nobug[.]uk.to notesof992.wordpress[.]com porndec143.chickenkiller[.]comsantaclarasystem[.]us Soure7788.chickenkiller[.]com testdomain2019.chickenkiller[.]com thyssenkrupp-marinesystems[.]org togetno992.mooo[.]com tojenner97.chickenkiller[.]com vser.mooo[.]com wsmcoff[.]com www.yorkshire-espana- sa[.]com/english/servicios/ xbug.uk[.]to yootypes[.]comPage 6 of 14 | Product ID: AA20-###ATLP:WHITETLP:WHITEMD5 Malware HashesProduct ID: AA21-200A 