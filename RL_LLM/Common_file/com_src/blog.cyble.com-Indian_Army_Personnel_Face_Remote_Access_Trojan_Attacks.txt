Indian Army Personnel Face Remote Access Trojan Attacksblog.cyble.com/2022/01/28/indian-army-personnel-face-remote-access-trojan-attacks/January 28, 2022Cyble Research Labs has come across a Twitter post wherein security researchers have brought to focus an Android malware that pretends to be the legitimate ARMAAN application. The Army Mobile Aadhaar App Network (ARMAAN) is an umbrella application covering various facets of information & services concerning all ranks of the Indian Army, and the app is used only by Indian Army personnel. Threat Actors (TAs) have customized the legitimate ARMAAN app and added malicious code into it.During our analysis, we observed that this malicious application uses the icon, name, and even source code of the legitimate ARMAAN app. To create this malicious application, attackers have added an extra package in the legitimate application’s source code to enable it to perform RAT activities.From our analysis, we concluded that upon successful execution, this malicious application could steal sensitive data such as contacts, call logs, SMSes, location, files from external storage, record audio, etc., from the victims’ devices.Technical Analysis APK Metadata InformationApp Name: ARMAAN Package Name: in.gov.armaan shown in the figure below.Figure 2 – App Icon and Name2/10Figure 3 – App Requests KYC DocumentsWhen the user inputs the AADHAAR number, the malware communicates with the official ARMAAN server to verify the account, as shown below.Figure 4 – App Communicates to Legitimate ServerOn comparing the legitimate ARMAAN application and the modified malicious ARMAAN application, we identified that the TAs have added an extra package containing malicious code, as shown in the figure below.3/10Figure 5 – Added Source Code Package in Malicious AppManifest Description The malware requests the user for 22 different permissions. Out of these, it abuses ten permissions. These dangerous permissions are listed below.PermissionsREAD_SMSRECEIVE_SMSREAD_CALL_LOGREAD_CONTACTSREAD_PHONE_STATERECORD_AUDIOACCESS_COARSE_LOCATIONACCESS_FINE_LOCATIONDescriptionAccess SMSes in the device database (DB).Intercept SMSes received on the victim’s deviceAccess Call LogsAccess phone contacts.Allows access to phone state, including the current cellular network information, the phone number and the serial number of the phone, the status of any ongoing calls, and a list of any Phone Accounts registered on the device.Allows the app to record audio with the microphone, which the attackers can misuse.Allows the app to get the approximate location of the device network sources such as cell towers and Wi-Fi.Allows the app to get the device’s precise location using the Global Positioning System (GPS).ACCESS_BACKGROUND_LOCATION Allows an app to access location in the background.ACCESS_WIFI_STATEAllows the app to get information about Wi-Fi connectivity.We observed added services and receivers entries in the manifest file of the malicious app, as shown in Figure 6.4/10Figure 6 – Added Entries in ManifestIt is also observed in the manifest that the TAs have added dangerous permissions entries such as READ_CONTACTS, READ_CALL_LOG, RECORD_AUDIO, ACCESS_COARSE_LOCATION, etc. in modified malicious ARMAAN applications.Figure 7 – Added Permissions Entry in Malicious APPSource Code Review Our static analysis indicated that the malware steals sensitive data such as Contacts, SMSes, and Call logs, besides recording audio and taking pictures from the camera, etc., on commands from the C&C.The malware uses a fixed hardcoded array containing the IP’s ASCII values: 173[.]212.220.230 and port: 3617 Details. The malware then converts and uses them for its C&C communication, as shown in Figure 8.5/10Figure 8 – Malware CommunicationThe getAlluserInfo() method has been used to collect the user’s device information such as phone number, device manufacturer’s details, etc., from the device, as shown in Figure 9.Figure 9 – Collects User’s InformationThrough the getAllSMS() method, we identified that the malware collects SMSs data from the device, as shown in the below figure.6/10The method getAllContacts() has been used to collect Contacts data from the device, as shown below.Figure 10 – Code to Collect SMSsFigure 11 – Code to Collect Contacts DataMethod getAllCallLogs() depicts the malware’s ability to collect Call logs data from the device. Refer to Figure 12.Figure 12 – Code to Collect Call logsThe code snippet shown in the below image depicts the malware’s ability to collect the device’s location data from the device.Figure 13 – Collects Location Data from the DeviceThe image shown below showcases the malware’s code that collects and sends images from the WhatsApp directory in the device to the server on commands from the TAs.Figure 14 – Steals Images from WhatsApp Directory7/10The method sentMicRecording() shown in the below image depicts the malware’s ability to record mic and send the recorded data to the server on the TAs command. After the data is sent, the malware deletes the file.The below figure represents the malware’s ability to capture images from the front and back camera and send the recorded data to the server on the TAs command.Figure 15 – Records MicFigure 16 – Capture Images from Front and Back CameraThe malware collects the document files from the device through the remainingDocumentFiles() method shown in the figure below.Below are the commands used by the TA to control the infected device:Figure 17 – Code to Collect Document Files8/10Command DescriptionD%r6t*Get SMS datas%7n@2Get Contacts datai*g4#3Get Call logs dataO@y7J&Start mic recording5w$I!71^R$4tj*7e@4Get document filesGet images from the WhatsApp folderClick photos from the device cameraA website with the domain name hxxps://armaanapp[.]in was registered around a year ago. It seems that TAs used this website to deliver malicious versions of the ARMAAN application, as shown in the below figure below.Figure 18 – Fake WebsiteConclusion The modified, malicious ARMAAN app poses a serious threat to the Indian Armed Forces. It can perform RAT activities with the potential to steal Indian Army personnel’s sensitive data, including contacts, call logs, SMSes, Location, and files from external storage, in addition to the ability to record sensitive audio.TAs constantly adapt their methods to avoid detection and find new ways to target users through increasingly sophisticated techniques. Such malicious applications often masquerade as legitimate applications to trick users into installing them. This situation makes it imperative for users to install applications only after verifying their authenticity. Apps should only be installed exclusively via the official Google Play Store and other trusted portals to avoid such attacks.Our Recommendations We have listed some essential cybersecurity best practices that create the first line of control against attackers. We recommend that our readers follow the best practices given below:How to prevent malware infection?Download and install software only from official app stores like Google Play Store or the iOS App Store. Use a reputed anti-virus and internet security software package on your connected devices, such as PCs, laptops, and mobile devices. Use strong passwords and enforce multi-factor authentication wherever possible. Enable biometric security features such as fingerprint or facial recognition for unlocking the mobile device where possible. Be wary of opening any links received via SMS or emails delivered to your phone. Ensure that Google Play Protect is enabled on Android devices. Be careful while enabling any permissions. Keep your devices, operating systems, and applications updated.9/10How to identify whether you are infected?Regularly check the Mobile/Wi-Fi data usage of applications installed in mobile devices. Keep an eye on the alerts provided by Anti-viruses and Android OS and take necessary actions accordingly.What to do when you are infected?Disable Wi-Fi/Mobile data and remove SIM card – as in some cases, the malware can re-enable the Mobile Data. Perform a factory reset. Remove the application in case a factory reset is not possible. Take a backup of personal media Files (excluding mobile applications) and perform a device reset.What to do in case of any fraudulent transaction?In case of a fraudulent transaction, immediately report it to the concerned bank.What should banks do to protect their customers?Banks and other financial entities should educate customers on safeguarding themselves from malware attacks via telephone, SMSes, or emails.MITRE ATT&CK® TechniquesTacticInitial AccessInitial AccessExecutionCollectionCollectionCollectionCollectionCollectionCollectionCollectionTechnique ID Technique NameT1476T1444T1575T1433T1412T1432T1429T1512T1533T1430Deliver Malicious App via Other Mean.Masquerade as Legitimate ApplicationNative CodeAccess Call LogCapture SMS MessagesAccess Contact ListCapture AudioCapture CameraData from Local SystemLocation TrackingCommand and Control T1436Commonly Used PortsIndicators of Compromise (IOCs)IndicatorsIndicator 