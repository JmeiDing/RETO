2/23/2022New Sandworm malware Cyclops Blink replaces VPNFilter - NCSC.GOV.UKNEWSNew Sandworm malware Cyclops Blink replaces VPNFilter The Sandworm actor has replaced the exposed VPNFilter malware with a new more advanced framework.Background The UK National Cyber Security Centre (NCSC), the Cybersecurity and Infrastructure Security Agency (CISA), the National Security Agency (NSA) and the Federal Bureau of Investigation (FBI) in the US have identified that the actor known as Sandworm or Voodoo Bear is using a new malware, referred to here as Cyclops Blink. The NCSC, CISA, FBI and NSA have previously attributed the Sandworm actor to the Russian GRU’s Main Centre for Special Technologies GTsST.The malicious cyber activity below has previously been attributed to Sandworm:The BlackEnergy disruption of Ukrainian electricity in 2015 Industroyer in 2016 NotPetya in 2017 Attacks against the Winter Olympics and Paralympics in 2018 A series of disruptive attacks against Georgia in 2019Cyclops Blink appears to be a replacement framework for the VPNFilter malware exposed in 2018, which exploited network devices, primarily small office/home office (SOHO) routers, and network attached storage (NAS) devices.This advisory summarises the VPNFilter malware it replaces, and provides more detail on Cyclops Blink, as well as the associated tactics, techniques andurlﬁlter1/102/23/2022New Sandworm malware Cyclops Blink replaces VPNFilter - NCSC.GOV.UKprocedures (TTPs) used by Sandworm. An NCSC malware analysis report on Cyclops Blink is also available and can be read in parallel.It also points to mitigation measures to help organisations that may be affected by this malware.VPNFilterFirst exposed in 2018 A series of articles published by Cisco Talos in 2018 describes VPNFilter and its modules in detail. VPNFilter was deployed in stages, with most functionality in the third-stage modules. These modules enabled traffic manipulation, destruction of the infected host device, and likely enabled downstream devices to be exploited. They also allowed monitoring of Modbus SCADA protocols, which appears to be an ongoing requirement for Sandworm, as also seen in their previous attacks against ICS networks.VPNFilter targeting was widespread and appeared indiscriminate, with some exceptions: Cisco Talos reported an increase of victims in Ukraine in May 2018. Sandworm also deployed VPNFilter against targets in the Republic of Korea before the 2018 Winter Olympics.In May 2018 Cisco Talos published the blog that exposed VPNFilter, and the US Department of Justice linked the activity to Sandworm, and announced its disruption of the botnet.Activity since its exposure A Trendmicro blog in January 2021 detailed residual VPNFilter infections and provided data showing a reduction in requests to a known C2 domain. Since the disruption in May 2018, Sandworm has shown limited interest in existing VPNFilter footholds, instead preferring to retool.urlﬁlter2/102/23/2022New Sandworm malware Cyclops Blink replaces VPNFilter - NCSC.GOV.UKCyclops BlinkActive since 2019 The NCSC, CISA, FBI and NSA, along with industry partners, have now identified a large-scale modular malware framework which is affecting network devices. The new malware is referred to here as Cyclops Blink and has been deployed since at least June 2019, fourteen months after VPNFilter was disrupted. In common with VPNFilter, Cyclops Blink deployment also appears indiscriminate and widespread.The actor has so far primarily deployed Cyclops Blink to WatchGuard devices, but it is likely that Sandworm would be capable of compiling the malware for other architectures and firmware.Note: Note that only WatchGuard devices that were reconfigured from the manufacturer default settings to open remote management interfaces to external access could be infectedMalware overviewThe malware itself is sophisticated and modular with basic core functionality to beacon (T1132.002) device information back to a server and enable files to be downloaded and executed. There is also functionality to add new modules while the malware is running, which allows Sandworm to implement additional capability as required.The NCSC has published a malware analysis report on Cyclops Blink which provides more detail about the malware.urlﬁlter3/102/23/2022New Sandworm malware Cyclops Blink replaces VPNFilter - NCSC.GOV.UKPost exploitationPost exploitation, Cyclops Blink is generally deployed as part of a firmware ‘update’ (T1542.001). This achieves persistence when the device is rebooted and makes remediation harder.Victim devices are organised into clusters and each deployment of Cyclops Blink has a list of command and control (C2) IP addresses and ports that it uses (T1008). All the known C2 IP addresses to date have been used by compromised WatchGuard firewall devices. Communications between Cyclops Blink clients and servers are protected under Transport Layer Security (TLS) (T1071.001), using individually generated keys and certificates. Sandworm manages Cyclops Blink by connecting to the C2 layer through the Tor network:Mitigation Cyclops Blink persists on reboot and throughout the legitimate firmware update process. Affected organisations should therefore take steps to remove theurlﬁlter4/102/23/2022malware.New Sandworm malware Cyclops Blink replaces VPNFilter - NCSC.GOV.UKWatchGuard has worked closely with the FBI, CISA and the NCSC, and has provided tooling and guidance to enable detection and removal of Cyclops Blink on WatchGuard devices through a non-standard upgrade process. Device owners should follow each step in these instructions to ensure that devices are patched to the latest version and that any infection is removed.The WatchGuard tooling and guidance is available at: url addition:If your device is identified as infected with Cyclops Blink, you should assume that any passwords present on the device have been compromised and replace them (see NCSC password guidance for organisations). You should ensure that the management interface of network devices is not exposed to the internet.In addition:If your device is identified as infected with Cyclops Blink, you should assume that any passwords present on the device have been compromised and replace them (see the NCSC's password guidance for organisations) You should ensure that the management interface of network devices is not exposed to the internetIndicators of compromise Please refer to the accompanying Cyclops Blink malware analysis report for indicators of compromise which may help to detect this activity.urlﬁlter5/102/23/2022New Sandworm malware Cyclops Blink replaces VPNFilter - NCSC.GOV.UKMITRE ATT&CK® This advisory has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible knowledge base of adversary tactics and techniques based on real-world observations.TacticInitial AccessTechniqueT1133ProcedureExternal Remote ServicesThe actors most likely deploy modified device firmware images by exploiting an externally available serviceExecutionT1059.004Command and Scripting Interpreter: Unix ShellCyclops Blink executes downloaded files using the Linux APIPersistenceT1542.001Pre-OS Boot: System FirmwareCyclops Blink is deployed within a modified device firmware imageT1037.004Boot or Logon Initialisation Scripts: RC ScriptsDefence EvasionT1562.004Cyclops Blink is executed on device startup, using a modified RC scriptImpair Defenses: Disable or Modify System FirewallCyclops Blink modifies the Linux system firewall to enable C2 communicationT1036.005Masquerading: Match Legitimate Name or Locationurlﬁlter6/102/23/2022New Sandworm malware Cyclops Blink replaces VPNFilter - NCSC.GOV.UKCyclops Blink masquerades as a Linux kernel thread processDiscoveryT1082System Information DiscoveryCyclops Blink regularly queries device informationCommand and ControlT1090ProxyT1132.002Data Encoding: Non-Standard EncodingCyclops Blink command messages use a custom binary scheme to encode dataT1008Fallback ChannelsCyclops Blink randomly selects a C2 server from contained lists of IPv4 addresses and port numbersT1071.001Application Layer Protocol: Web ProtocolsCyclops Blink can download files via HTTP or HTTPST1573.002Encrypted Channel: Asymmetric CryptographyCyclops Blink C2 messages are individually encrypted using AES-256-CBC and sent underneath TLST1571Non-Standard PortThe list of port numbers used by Cyclops Blink includes non-standard ports not typically associated with HTTP or HTTPS trafficurlﬁlter7/102/23/2022New Sandworm malware Cyclops Blink replaces VPNFilter - NCSC.GOV.UKExfiltrationT1041Exfiltration Over C2 ChannelCyclops Blink can upload files to a C2 serverConclusion A Cyclops Blink infection does not mean that an organisation is the primary target, but it may be selected to be, or its machines could be used to conduct attacks.Organisations are advised to follow the mitigation advice in this advisory and to refer to indicators of compromise (not exhaustive) in the Cyclops Blink malware analysis report to detect possible activity on networks.UK organisations affected by the activity outlined in this advisory should report any compromises to the NCSC via our website.Further guidance A variety of mitigations will be of use in defending against the malware featured in this advisory:Do not expose management interfaces of network devices to the internet the management interface is a significant attack surface, so not exposing them reduces the risk. See NCSC guidance: Acquiring, managing and disposing of network devices Protect your devices and networks by keeping them up to date use the latest supported versions, apply security patches promptly, use anti-virus and scan regularly to guard against known malware threats. See NCSC guidance: Mitigating malware Use multi-factor authentication to reduce the impact of password compromisesurlﬁlter8/102/23/2022New Sandworm malware Cyclops Blink replaces VPNFilter - NCSC.GOV.UKsee NCSC guidance: Multi-factor authentication for online services and Setting up 2-Step Verification (2SV) Treat people as your first line of defence tell staff how to report suspected phishing emails, and ensure they feel confident to do so. Investigate their reports promptly and thoroughly. Never punish users for clicking phishing links or opening attachments. See NCSC guidance: Phishing attacks: defending your organisation Set up a security monitoring capability so you are collecting the data needed to analyse network intrusions. See NCSC guidance: Introduction to logging for security purposes Prevent and detect lateral movement in your organisation’s networks see NCSC guidance: Preventing Lateral MovementPUBLISHED 23 February 2022NEWS T YPE AlertWRIT T EN FOR Cyber security professionals Large organisations Public sectorWas this articlehelpful?YesNourlﬁlter9/102/23/2022New Sandworm malware Cyclops Blink replaces VPNFilter - NCSC.GOV.UKurlﬁlter10/10 