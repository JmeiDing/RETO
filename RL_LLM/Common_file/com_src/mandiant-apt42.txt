T H R E A T I N T E L L I G E N C E R E P O R TAPT42: Crooked Charms, Cons and CompromisesAPT42Executive Summary2Mandiant assesses with high confidence that APT42 is an Iranian state-sponsored cyber espionage group tasked with conducting information collection and surveillance operations against individuals and organizations of strategic interest to the Iranian government. We further estimate with moderate confidence that APT42 operates on behalf of the Islamic Revolutionary Guard Corps (IRGC) Intelligence Organization (IRGC-IO) based on targeting patterns that align with the organization's operational mandates and priorities.Active since at least 2015, APT42 is characterized by highly targeted spear phishing and surveillance operations against individuals and organizations of strategic interest to Iran. The group’s operations, which are designed to build trust and rapport with their victims, have included accessing the personal and corporate email accounts of government officials, former Iranian policymakers or political figures, members of the Iranian diaspora and opposition groups, journalists, and academics who are involved in research on Iran. After gaining access, the group has deployed mobile malware capable of tracking victim locations, recording phone conversations, accessing videos and images, and extracting entire SMS inboxes.APT42 has a demonstrated ability to alter its operational focus as Iran’s priorities evolve over time. We anticipate APT42 will continue to conduct cyber espionage operations in support of Iran’s strategic priorities in the long term based on their extensive operational history and imperviousness to public reporting and infrastructure takedowns.OverviewMandiant assesses with high confidence that APT42 is a prolific and well-resourced threat actor that carries out Iranian state- sponsored espionage and surveillance activity in support of Iran’s strategic priorities. The group has been active since at least early 2015 and relies primarily on highly targeted social engineering efforts to achieve its objectives against both individuals and organizations of interest to the Iranian government. APT42 operations broadly fall into three categories:• Credential harvesting: APT42 frequently targets corporate and personal email accounts through highly targeted spear- phishing campaigns with enhanced emphasis on building trust and rapport with the target before attempting to steal their credentials. Mandiant also has indications that the group uses credential harvesting to collect Multi-Factor Authentication (MFA) codes to bypass authentication methods and has used compromised credentials to pursue access to the networks, devices and accounts of employers, colleagues and relatives.3• Surveillance operations: As of at least late 2015, a subsetof APT42’s infrastructure served as command-and-control (C2) servers for Android mobile malware designed to track locations, monitor communications and generally surveil the activities of individuals of interest to the Iranian government, including activists and dissidents inside Iran.• Malware deployment: While APT42 primarily prefers credentialharvesting over activity on disk, several custom backdoors and lightweight tools complement its arsenal. The group likely incorporates these tools into their operations when the objectives extend beyond credential harvesting.Mandiant has observed over 30 confirmed APT42 targeted operations spanning these categories since early 2015. The total number of APT42 intrusion operations is almost certainly much higher based on the group’s high operational tempo, visibility gaps caused in part by the group’s targeting of personal email accounts and domestically focused efforts and extensive open-source industry reporting on threat clusters likely associated with APT42.APT42 had been previously tracked by Mandiant as UNC788.APT42Credential HarvestingSurveillance OperationsMalware DevelopmentFIGURE 1. APT42 operations by category.4APT42 has targeted the following sectors:• Civil society and nonprofits• Education• Governments• Healthcare• Legal and professional services• Manufacturing• Media and entertainment• PharmaceuticalsAPT42 has targeted organizations in at least 14 countries since our first observation of its activity in 2015, including in Australia, Europe, the Middle East and the United States.TargetingThe targeting patterns for APT42 operations are similar to other Iranian cyber espionage actors, with a large segment of activity focused on the Middle East region. However, unlike other suspected IRGC-affiliated cyber espionage groups that have focused on targeting the defense industrial base or conducting large-scale collection of personally identifiable information (PII), APT42 primarily targets organizations and individuals deemed opponents or enemies of the regime, specifically gaining access to their personal accounts and mobile devices. The group has consistently targeted Western think tanks, researchers, journalists, current Western government officials, former Iranian government officials and the Iranian diaspora abroad.Some APT42 activity indicates the group alters its operational focus as Iran’s priorities evolve. This includes targeted operations against the pharmaceutical sector at the onset of the COVID-19 pandemic in March 2020 and the pursuit of domestic and foreign-based opposition groups prior to an Iranian presidential election. This indicates that APT42 is trusted by the Iranian government to quickly react to geopolitical changes by adjusting their flexible operations to targets of operational interest to Tehran. APT 42 TargetingTargeted IndustriesCivil society and non-profitsEducationGovernmentsHealthcareLegal and professional servicesManufacturingMedia and entertainmentPharmaceuticalsFIGURE 2. Countries and industries targeted directly by APT42.5Personal Email Targeting APT42 has consistently targeted the personal email accounts and MFA codes of individuals of interest to the Iranian government.• In May 2017, APT42 targeted the senior leadership of an Iranianopposition group operating from Europe and North America with spear-phishing emails mimicking legitimate Google correspondence. The emails contained links to fake Google Books pages which redirected to sign-in pages designed to steal credentials and two-factor authentication codes.Cyber Espionage OperationsAPT42 operations are consistent with Iran’s strategic priorities and reflect an operational mandate to collect information on individuals and organizations of interest to the Iranian government or deemed to pose a threat to the regime. The group’s activity focuses on social engineering and exhibits patience and resource-intensive efforts to craft targeted decoy content and build rapport with targets before providing a credential harvesting link or malicious attachment.Credential Harvesting Activity APT42 has consistently targeted Western think tanks and academics, media organizations, members of the Iranian diaspora in the United Kingdom, Israel, the United States and high-profile Iranian individuals within Iran in efforts to collect credentials of individuals of interest to the Iranian government. Some credential harvesting efforts have also included components designed to steal MFA codes.FIGURE 3. APT42 fake Google Books page.• In April 2018, APT42 targeted the Google Gmail account of an Iranian environmental activist with a fake login page. The individual hadpreviously been arrested by the Iranian government which cracked down on environmental activism in early 2018.6FIGURE 4. Gmail login page personalized for a redacted victim (left), spoofed two-factor authentication (right).• In October 2019, APT42 attempted to steal the personal Gmail credentials of an Iranian lecturer and newspaper editor in Israel.• In February 2021, APT42 targeted the personal email credentials of a senior Israeli government official with a credential harvestingpage mimicking the Gmail login page.FIGURE 5. Pre-filled login form for credential harvesting.• In June 2020, APT42 sent a spear-phishing email to an employee of a U.S.-based non-profit organization who had previously publishedon the condition of Iran’s civil society.7– After sending an email from the compromised inbox, APT42attempted to cover their tracks by deleting the message from the victim’s Sent folder.– APT42 also attempted to access the personal email accountsof their targets, taking careful steps to avoid detection.– APT42 was able to bypass multi-factor authentication bycapturing SMS-based one-time passwords and successfully setting up two-factor verification using the Microsoft Authenticator application.– Once inside one victim organization, APT42 accessed filesrelating to Iran through their M365 environment.– The group authenticated to the compromised accountsusing an Outlook client, suggesting existing mail items may have been synchronized with the attacker's host.Impersonation and Building Trust APT42 often attempts to build rapport with their target by impersonating journalists or researchers and engaging the target in benign conversation for multiple days or weeks before sending a malicious link. In some cases, the group uses compromised email accounts in follow-on operations targeting colleagues, acquaintances or relatives of the initial victim.• APT42 used a compromised email account belonging to a U.S.- based think tank employee to target Middle East researchers at other think tanks and academic organizations, U.S. government officials involved in Middle East and Iran policy, a former Iranian government official, and high-ranking members of an Iranian opposition group between March and June 2021.– The actor posed as a well-known journalist from a U.S. media organization requesting an interview and engaged the initial target for 37 days to gain their trust before finally directing them to a credential harvesting page. In other instances, APT42 provided a Dropbox link to a PDF with an embedded URL shortening link that led to a credential harvesting page (shown in Figure 6).FIGURE 6. PDF document with embedded link to credential harvesting page.• APT42 impersonated a legitimate British news organization to obtain the personal email credentials of political science professorswith ties to local governments or with relatives holding dual citizenship with Iran in February 2022. The group invited its targets, located in Belgium and the United Arab Emirates, to an online interview via a customized PDF document containing an embedded link leading to a Gmail credential harvesting page.8FIGURE 7. PDF with interview invitation.• In the weeks ahead of Iran’s June 18, 2021, presidentialelection, APT42 used a compromised email address belonging to an Iran researcher at a U.S. think tank to spear phish a member of an Iranian opposition group headquartered in Europe in a probable attempt to gain access to the organization and its other members. The group impersonated the researcher and invited the target to review and provide feedback on one of the researcher’s articles on Iranian nuclear issues in a likely effort to build trust with the target before engaging in further conversation.• Between March and June 2020, APT42 targeted high-profile individuals in the U.S. pharmaceutical industry in what may have been a temporary shift to support Iranian public health priorities amid the COVID-19 pandemic. APT42 attempted to steal personal email credentials with credential harvesting forms masquerading as popular email services such as Gmail and Yahoo and impersonated a legitimate vaccinologist at the University of Oxford, claiming to have identified an information leakage from the targeted organization.9FIGURE 8. APT42 impersonates University of Oxford vaccinologist.FIGURE 9. APT42 Credential harvesting page masquerading as a Yahoo login portal.Surveillance Operations Mandiant assesses with high confidence that APT42 conducts surveillance and monitoring operations against individuals of interest to the Iranian government. In addition to credential harvesting activity, the group uses mobile malware to target individuals of interest, including those with connections to the Green Movement in Iran and other political targets. Mandiant observed APT42 target individuals who claimed to be able to provide tools to bypass government restrictions such as those imposed on Telegram.• APT42 likely delivers its Android malware such as VINETHORNand PINEFLOWER via text messages.1 0• Between July 2020 and March 2021, the group successfully used PINEFLOWER Android malware to compromise several dozen Android devices we believe belong to individuals residing in Iran.– APT42 exfiltrated recorded phone calls, room audiorecordings, images and entire SMS inboxes from at least 10 compromised devices, often daily.– APT42 used earlier versions of PINEFLOWER as early as 2015.• APT42 infrastructure served as command and control for a VINETHORN payload masquerading as a legitimate VPN application between April and October 2021.• Mandiant most recently observed APT42 PINEFLOWER activitytargeting Iran-based individuals with ties to universities, reformist political groups, and human rights activists between June and August 2022.FIGURE 10. VINETHORN malicious Android application.• In early July 2021, APT42 hosted malicious webpages masquerading as an adult content website and a free audio/video calling and instantmessenger software. The landing pages profiled visitors to the page, requested the user to turn on location services, and sent the data back to a hard-coded Telegram chat. In one instance, the page supported formatting for mobile devices and displayed requests to the user in Arabic, suggesting Arabic speakers may have been targeted. Iran saw significant protests in July 2021, including in the Khuzestan region, which is home to Iran’s Arab minority.1 1Malware Operations While APT42 focuses on credential harvesting rather than deploying malware on a system, several custom backdoors and lightweight tools complement its arsenal. Since 2020, APT42 has primarily relied on lightweight toehold backdoors over fully functional modular tools. Mandiant assesses that APT42 has limited in-house malware development resources because recent malware families such as TABBYCAT and VBREVSHELL have included or largely consisted of publicly available code copied from GitHub projects.• In September 2021, APT42 used a compromised Europeangovernment email account to send a phishing email to almost 150 email addresses associated with individuals or entities employed by or affiliated with civil society, government or intergovernmental organizations around the world. The email used lure content pertaining the organizational chart of an embassy in Tehran and contained a Google Drive link to a malicious macro document leading to TAMECAT, a PowerShell toehold backdoor.• In January and February 2022, APT42 hosted severalmalicious Office documents on an Amazon Web Service instance, Google Drive and Dropbox. Likely delivered via a link sent in a spear-phishing email, the malicious documents used geopolitically themed decoy content and fetched a password-protected remote template document via Microsoft OneDrive links. These documents led to TABBYCAT and VBREVSHELL malware, which are a VBA-based dropper and reverse shell macro, respectively.• APT42 infrastructure hosted malicious PowerShell codein the banners of odd ports in early March 2022. The code, when run, retrieved additional PowerShell payloads including POWERPOST, a custom reconnaissance tool that can collect data on a local host, including system information and local account names.FIGURE 11. APT42 domain masquerades as legitimate messaging platform.The use of Android malware to target individuals of interest to the Iranian government provides APT42 with a productive method of obtaining sensitive information on targets, including movement, contacts and personal information. The group’s proven ability to record phone calls, activate the microphone and record the audio, exfiltrate images and take pictures on command, read SMS messages and track the victim's GPS location in real time poses a real-world risk to individual victims of this campaign.FIGURE 12. Banner response (left) versus de-obfuscated PowerShell code (right).1 2Potential Ties Between APT42 and Ransomware ActivityMandiant further highlights open-source reporting from Microsoft claiming a connection between intrusion activity clusters that generally align with APT42 and UNC2448, an Iran-nexus threat actor known for widespread scanning for various vulnerabilities, the use of the Fast Reverse Proxy tool, and reported ransomware activity using BitLocker. Notably, Mandiant has not observed technical overlaps between APT42 and UNC2448.• In November 2021, Microsoft reported that “Phosphorus”had targeted Fortinet FortiOS SSL VPN and unpatched on-premises Exchange servers globally with the intent of deploying ransomware such as BitLocker on vulnerable networks, aligning with activity we track as UNC2448. Previous reporting on Phosphorus generally aligned with APT42’s credential harvesting and spear-phishing operations.While Mandiant has not observed technical overlaps between APT42 and UNC2448, the latter may also have ties to the IRGC-IO. We assess with moderate confidence that UNC2448 and the Revengers Telegram persona are operated by at least two Iranian front companies, Najee Technology and Afkar System, based on open-source information and operational security lapses by the threat actors. Public leaking campaigns from the Lab Dookhtegan Telegram account further allege these companies are responsible for threat activity aligned with UNC2448 and operate on behalf of the IRGC-IO.• Mandiant identified links between UNC2448, the Revengerspersona, an individual named Ahmad Khatibi, and a likely Iranian front company named Afkar System.• The Revengers persona had offered data and access toprimarily Israeli companies for sale on its Telegram channel between February and September 2021.• Additionally, infrastructure overlaps likely caused by humanerror indicate that UNC2448 has connections to a second front company, Najee Technology.• Public posts by the Lab Dookhtegan Telegram channel in July2022 claim Afkar System and Najee Technology are front companies conducting cyber operations on behalf of the IRGC’s Intelligence Organization.AttributionMandiant assesses with high confidence that APT42 conducts cyber espionage operations on behalf of the Iranian government based on years of activity targeting unique, high-priority targets both inside and outside of Iran. Both Iran’s Islamic Revolutionary Guard Corps and Ministry of Intelligence and Security have the mandate to conduct cyber espionage operations against the domestic populace and foreign targets of strategic intelligence value. However, we estimate with moderate confidence that APT42 operates on behalf of the Islamic Revolutionary Guard Corps’ Intelligence Organization based on targeting patterns that align with the organization’s operational mandates and priorities, which includes defending the regime against internal and external threats, pursuing perceived domestic enemies, and confronting “revolutionary” ideas emanating from the West.Historical Connections to APT35APT42 generally corresponds with activity other organizations have referred to as TA453 (Proofpoint), Yellow Garuda (PwC), and ITG18 (IBM). The group is also consistent with a sub-section of publicly reported threat clusters: Phosphorus (Microsoft) and Charming Kitten (ClearSky and CERTFA). Similarity in malicious cyber operations between various Iranian groups and a dynamic institutional ecosystem in Iran contributed to significant conflation of historical APT42 and APT35 activity.Mandiant assesses with moderate confidence that both APT35 and APT42 operate on behalf of the IRGC but originate from different missions and contracts or contractors based on substantial differences in their respective targeting patterns and tactics, techniques and procedures.• Historical APT35 operations focused on long-term,resource intensive operations targeting the U.S. and Middle Eastern military, diplomatic, and government personnel, organizations in the media, energy, and defense industrial base, and engineering, business services, and telecommunications sectors.• In contrast, APT42 operations focus on individualsand organizations of interest to the Iranian government for domestic politics, foreign policy, and regime stability purposes.• While both APT42 and APT35 have used MAGICDROP and BROKEYOLK malware, Mandiant observed no similarities between the respective C2 infrastructure or how the groups operationalized the malware.• The IRGC frequently relies on contractors to execute differentcyber operations mission sets (such as U.S. Treasury Department sanctions against Net Peygard Samavat).Outlook and ImplicationsAPT42 has consistently targeted the personal email credentials, Multi-factor authentication codes and mobile device location and communication data of individuals of interest to the Iranian government. They can use this access to enable follow-on compromises of corporate networks such as those of Western think tanks, academics, media organizations, biomedical research and pharmaceutical companies and governments. The group’s surveillance activity highlights the real-world risk to individual targets of APT42 operations, which include Iranian dual-nationals, former government officials and dissidents both inside Iran and those who previously left the country, often out of fear for their personal safety.1 3We do not anticipate significant changes to APT42’s operational tactics and mandate given the long history of activity and imperviousness to infrastructure take downs and a media spotlight on operational security failures. Nevertheless, the group has displayed its ability to rapidly alter its operational focus as Iran’s priorities change over time with evolving domestic and geopolitical conditions. We assess with high confidence that APT42 will continue to perform cyber espionage and surveillance operations aligned with evolving Iranian operational intelligence collection requirements.Technical Annex: Attack Lifecycle1 4• CHAIRSMACK • Adding alternate email address to accounts • Deleting login notiﬁcation emails • Deleting sent emails • Windows Registry modiﬁcations• Accessing victim’s personal email accounts • Spear phishing additional victims using a compromised accountMAINTAIN PRESENCEMOVE LATERALLYESCALATE PRIVILEGEINTERNALRECONNAISSANCE• CHAIRSMACK • Browsing victom’s contacts • Synchronizing mail items • Taking screenshotsCOMPLETE MISSION• Credential theft • Obtaining ﬁles from victim Sharepoint • Personal data theft • Phishing additional victims from compromised accountINITIAL COMPROMISEESTABLISH FOOTHOLD• Byoassing MFA • Credential theft • Credential harvesting forms • Patient social engineering • SMS messages for Android malware • Spear phishing• BROKEYOLK Authenticator applicationFIGURE 13. APT42 Attack Lifecycle.Initial Compromise APT42 primarily relies on spear phishing to perform an initial compromise. The group is patient and creative in their social engineering efforts, often engaging their target for days or weeks to build trust before providing a link to a credential harvesting page or attaching a malicious attachment to their correspondence. APT42 is capable of bypassing MFA and intercepting SMS-based one-time passwords using credential harvesting forms and likely delivers Android malware via SMS messages.• APT42 frequently impersonates well-known journalists or public figures ostensibly requesting interviews with their targets. In one instance, APT42 conversed with their target for 37 days before sending them a URL shortening link that redirected to a credential harvesting page.• APT42 sends spear phishing emails containing a PDFdocument attachment or links to Google Drive or Dropbox- hosted PDF documents with an embedded link to a credential harvesting page.• The group is capable of intercepting MFA authentication codesvia credential harvesting forms.Establish Foothold Once successfully authenticated to a victim’s personal or corporate email account, APT42 registers their own Microsoft Authenticator application as a new MFA method. environments, APT42 uses a variety of primarily lightweight malware, some of which are based on publicly available scripts. Examples include:• BROKEYOLK• CHAIRSMACK• GHAMBAR• MAGICDROP• POWERPOST• PINEFLOWER• TABBYCAT• TAMECAT• VBREVSHELL• VINETHORNEscalate Privileges APT42 uses custom malware capable of logging keystrokes and stealing logins and cookie data for common browsers to perform privilege escalation in a victim environment. Examples include:Maintain Presence To maintain their presence in a victim’s environment, APT42 relies on custom malware using scheduled tasks or Windows registry modifications for persistence, including:1 5• CHAIRSMACK• GHAMBARAdditionally, APT42 uses various techniques to maintain access to a victim’s personal or corporate email account, including registering their Microsoft Authenticator application to receive MFA codes to their own devices. When APT42 sends spear- phishing emails from a compromised account or attempts to move laterally to a different account, the group deletes login notification emails and clears the messages from the Sent folder to cover their tracks.Complete Mission Mandiant assesses that APT42’s objective is two-fold:• APT42 seeks to steal credentials to personal and corporate email accounts and use those credentials to conduct follow- on operations and steal personal or business documents and research pertinent to Iran.• APT42 seeks to track the locations, monitor the phone andemail communications and generally surveil the activities of individuals of interest to the Iranian government, including activists and dissidents inside Iran.We have no evidence to suggest APT42 hands harvested credentials to other threat actors for follow-on operations at this time.• CHAIRSMACK• DOSTEALER• GHAMBARInternal Reconnaissance After logging in to the target environment with stolen credentials, APT42 conducts internal reconnaissance by browsing the compromised user’s contacts and accessing the targeted organization’s collaborative spaces, such as Sharepoint. The group also logs in to compromised accounts with a Microsoft Outlook client, which can lead the existing mail items from affected users to be synchronized with the attacker’s host. This access can be used to spear phish additional targets with legitimate, stolen content from the compromised organization or pre-existing email conversations.APT42 also uses malware capable of taking screenshots and collecting system and network information, including:• GHAMBAR• POWERPOSTLateral Movement To move laterally, APT42 often attempts to use the compromised personal email account of the victim to access other the victim’s corporate accounts, and vice versa. The group sends spear- phishing emails from compromised email accounts to additional targets both internal and external to the targeted organization.• In April 2021, APT42 used a compromised corporate emailaccount of an employee at a U.S.-based think tank to access the individual’s personal email account. The corporate account, configured as a recovery email, received login verification codes from the personal email provider, which APT42 deleted to cover their tracks.• On multiple occasions, APT42 used their victim’s trusted relationships with their contacts to send additional spear- phishing emails to follow-on targets, including coworkers, industry peers and relatives.1 6Appendix 1. MITRE ATT&CK MappingTABLE 1. Resource Development.T1583.003T1584T1587.003T1588.004TABLE 2. Initial Access.T1133T1566.001T1566.002TABLE 3. Execution.T1047T1059.001T1059.005T1059.007T1569.002T1204.001T1204.002TABLE 4. Persistence.T1098.002T1133T1543.003T1547.001T1547.004TABLE 5. Privilege Escalation.T1055T1134T1543.003T1547.001T1547.004Acquire Infrastructure: Virtual Private ServerCompromise InfrastructureDevelop Capabilities: Digital CertificatesObtain Capabilities: Digital CertificatesExternal Remote ServicesSpear-phishing AttachmentSpear-phishing LinkWindows Management InstrumentationCommand and Scripting Interpreter: PowerShellCommand and Scripting Interpreter: Visual BasicCommand and Scripting Interpreter: JavaScript/JscriptSystem Services: Service ExecutionUser Execution: Malicious LinkUser Execution: Malicious FileAccount Manipulation: Exchange Email Delegate PermissionsExternal Remote ServicesCreate or Modify System Process: Windows ServiceBoot or Logon Autostart Execution: Registry Run Keys / Startup FolderBoot or Logon Autostart Execution: Winlogon Helper DLLProcess InjectionAccess Token ManipulationCreate or Modify System Process: Windows ServiceBoot or Logon Autostart Execution: Registry Run Keys / Startup FolderBoot or Logon Autostart Execution: Winlogon Helper DLL1 7TABLE 6. Defense Evasion.T1027.002T1027.005T1055T1070.004T1112T1134T1140T1221T1497.001T1497.003T1564.003TABLE 7. Credential Access.T1003T1111T1056.001TABLE 8. Discovery.T1012T1016T1082T1083T1087.001T1497.001T1497.003T1518Obfuscated Files or Information: Software PackingObfuscated Files or Information: Indicator Removal from ToolsProcess InjectionIndicator Removal on Host: File DeletionModify RegistryAccess Token ManipulationDeobfuscate/Decode Files or InformationTemplate InjectionVirtualization/Sandbox Evasion: System ChecksVirtualization/Sandbox Evasion: Time Based EvasionHide Artifacts: Hidden WindowOS Credential DumpingTwo-Factor Authentication InterceptionInput Capture: KeyloggingQuery RegistrySystem Network Configuration DiscoverySystem Information DiscoveryFile and Directory DiscoveryAccount Discovery: Local AccountVirtualization/Sandbox Evasion: System ChecksVirtualization/Sandbox Evasion: Time Based EvasionSoftware DiscoveryTABLE 8. Lateral Movement.T1021.001T1021.004Remote Services: Remote Desktop ProtocolRemote Services: SSH1 8TABLE 9. Collection.T1056.001T1113T1115T1123T1125T1213Input Capture: KeyloggingScreen CaptureClipboard DataAudio CaptureVideo CaptureData from Information Repositories: SharepointT1560.002Archive Collected Data: Archive via LibraryTABLE 10. Command and Control.T1071.001T1071.002T1095T1102T1105T1132Application Layer Protocol: Web ProtocolsApplication Layer Protocol: File Transfer ProtocolsNon-Application Layer ProtocolWeb ServiceIngress Tool TransferData Encoding: Standard EncodingT1573.002Encrypted Channel: Asymmetric CryptographicTABLE 11. Exfiltration.T1041TABLE 12. Impact.T1529Exfiltration over C2 ChannelSystem Shutdown/Reboot1 9Appendix 2. Malware Used by APT42TABLE 13. Malware used by APT42.MalwareBROKEYOLKCHAIRSMACKDOSTEALERGHAMBARMAGICDROPPINEFLOWERPOWERPOSTSILENTUPLOADERTABBYCATTAMECATVBREVSHELLVINETHORNDescriptionBROKEYOLK is a .NET downloader that downloads and executes a file from a hard-coded command and control (C2) server. The malware communicates via SOAP (Simple Object Access Protocol) requests using HTTP.CHAIRSMACK is a backdoor written in C++ that communicates using HTTP. CHAIRSMACK's core functionality involves expanding its capabilities by retrieving plugins from a C2 server. Downloaded plugins are cached on disk for future use. Capabilities added via plugins are inferred based on supported backdoor command names. These capabilities include shell command execution, screenshot capture, audio capture, keylogging, file transfer, and file execution.DOSTEALER is a dataminer that mines browser login and cookie data. It is also capable of taking screenshots and logging keystrokes.GHAMBAR is a remote administration tool (RAT) that communicates with its C2 server using SOAP requests over HTTP. Its capabilities include filesystem manipulation, file upload and download, shell command execution, keylogging, screen capture, clipboard monitoring, and additional plugin execution.MAGICDROP is a dropper written in C++. It decrypts files from its .data section and writes them to disk in the system's %TEMP% directory. The files dropped often include a decoy file, a next-stage payload, and sometimes an installer for the payload.PINEFLOWER is an Android malware family capable of a wide range of backdoor functionality, including stealing system inform information, logging and recording phone calls, initiating audio recordings, reading SMS inboxes and sending SMS messages. The malware also has features to facilitate device location tracking, deleting, downloading, and uploading files, reading connectivity state, speed, and activity, and toggling Bluetooth, Wi-Fi, and mobile data settings.POWERPOST is a reconnaissance tool written in PowerShell that can collect data on a local host including system information and user account names. POWERPOST writes the data to disk and then sends the collected data to a hardcoded remote server via HTTP POSTs.SILENTUPLOADER is an uploader written in MSIL that is dropped by DOSTEALER and is designed to work specifically in tandem with it. It checks for files in a specified folder every 30 seconds and uploads them to a remote server.TABBYCAT is a Microsoft Word VBA macro that functions as a dropper. It relies on social engineering in order to be executed as a macro within a decoy Microsoft Word document. It decodes a payload embedded in a UserForm and launches it. TABBYCAT has been observed dropping the VBREVSHELL backdoor.TAMECAT is a PowerShell toehold that can execute arbitrary PowerShell or C# content. TAMECAT has been observed dropped by malicious macro documents, communicates with its C2 node via HTTP, and expects data from the C2 to be Base64-encoded.VBREVSHELL is a VBA macro that spawns a reverse shell relying exclusively on Windows API calls.VINETHORN is an Android malware family capable of a wide range of backdoor functionality. It can steal system information, read SMS names are or may be trademarks or service marks of their respective owners. I-EXT-RT-US-EN-000454-01 