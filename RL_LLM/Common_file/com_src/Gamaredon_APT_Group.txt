4/27/2020Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogTrend Micro About TrendLabs Security Intelligence BlogSearch:Home CategoriesHome ¬ª Malware ¬ª Gamaredon APT Group Use Covid-19 Lure in CampaignsGamaredon APT Group Use Covid-19 Lure in CampaignsPosted on:April 17, 2020 at 5:12 am Posted in:Malware, Spam, Targeted Attacks Author: Trend Micro0By Hiroyuki Kakara and Erina Maruyama Gamaredon is an advanced persistent threat (APT) group that has been active since 2013. Their campaigns are generally known for targeting Ukrainian government institutions. From late 2019 to February of this year, researchers published several reports on Gamaredon, tracking the group‚Äôs activities. In March, we came across an email with a malware attachment that used the Gamaredon group‚Äôs tactics. Some of the emails used the coronavirus pandemic as a topic to lure victims into opening emails and attachments. These campaigns targeted victims in European countries and others. A brief history of Gamaredon In 2015, researchers from LookingGlass published the Ô¨Årst report on Gamaredon. According to that report, the early campaigns used Microsoft Word documents that, when inspected, showed that its most recent user went by the name of Armagedon (a misspelled ‚ÄúArmageddon‚Äù), which became the basis of the group‚Äôs namesake. The report also described Gamaredon‚Äôs political beginnings, particularly its ties to the Ukrainian revolution in 2014. Before the revolution they had targeted Ukrainian government ofÔ¨Åcials, opposition party members, and journalists. They moved on to Ukrainian government institutions after the revolution. In 2018, CERT- UA published an advisory against the malware Pterodo, which the group allegedly used. The group remained active, with several Gamaredon-related activities reported in February 2020. In March, they were among the threat groups that were identiÔ¨Åed taking advantage of the coronavirus pandemic to trick targets. Gamaredon and Covid-19-related cover emailsurl‚Ä¶ 1/74/27/2020Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogFigure 1. The infection chain of the Gamaredon campaignThe case we found arrived through a targeted email that contained a document Ô¨Åle (in docx format). Opening document starts a template injection technique for loading the document template from the internet. The downloaded document template contains the malicious macro codes, which executes a VBScript (VBS). We found a mechanism for decrypting, executing, and downloading an additional payload from the C&C server. During the time of the analysis however, the C&C server was not accessible, which made us unable to get additional payloads. The attacks we found all arrived through targeted emails (MITRE ATT&CK framework ID T1193). One of them even had the subject ‚ÄúCoronavirus (2019-nCoV).‚Äù The use of socially relevant topics is a common practice for attackers who wish to make their emails and documents more tempting to open. The email that used the coronavirus-related subject came with an attached document Ô¨Åle. Opening this Ô¨Åle (MITRE ATT&CK framework ID T1204) executes the template injection method (MITRE ATT&CK framework ID T1221).Figure 2. Code for downloading the document template with the malicious macroThe downloaded document template (in dot format) could differ slightly depending on each download. However, its Exif info or metadata remains consistent and shares the following details: IdentiÔ¨Åcation: Word 8.0 Language code: Russian System: Windows Author: –ê–î–ú–ò–ù (‚ÄúAdministrator‚Äù in Russian) Code page: Windows CyrillicFigure 3. A sample of malicious macro in the downloaded template documentAs mentioned, the template contains malicious macro (MITRE ATT&CK framework ID T1064), which exports VBS (MITRE ATT&CK framework ID T1064) to execute itself. More speciÔ¨Åcally it drops ‚Äú%USERPROFILE%\Documents\MediaPlayer\PlayList.vbs,‚Äù which is hardcoded in the macro, and then executed in ‚Äúwscript.exe //b %USERPROFILE%\Documents\MediaPlayer\PlayList.vbs.‚ÄùPlayList.vbs contains the obfuscated codes (MITRE ATT&CK framework ID T1140), which it executes after decrypting the obfuscations. This particular behavior is a slight departure from previously reported attacks by Gamaredon, which did not use this technique.Figure 4. A content sample for VBS dropped by malicious macrourl‚Ä¶ 2/74/27/2020Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogFigure 5 shows a snippet of the VBS executed by the Execute function. The routines it follows are enumerated below.Figure 5. A sample of executed VBS1. Register the RUN key in the registry below, so that the VBS Ô¨Åle is executed every time the machine starts (MITRE ATT&CK framework ID T1060)Registry: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce\MediaPlayer wscript.exe //b ÔºÖUSERPROFILE%\Documents\MediaPlayer\PlayList.vbsT1043, T1071, T1082) framework ID T1105) decrypted result is saved as ‚Äú%APPDATA%\\Microsoft\Windows\Cookies.exe‚Äù (T1001)2. Connect with ‚Äúhxxp:// kristom[.]hopto[.]org /{computer name}_{hexadecimal volume serious number}/help_05_03[.]php‚Äù (MITRE ATT&CK framework IDs 3. If the downloaded Ô¨Åle size in the Ô¨Årst step exceeds 10,485 bytes, then the Ô¨Åle is saved as ‚Äú%APPDATA%\\Microsoft\Windows\Cookies.txt‚Äù (MITRE ATT&CK 4. Use XOR for the Ô¨Åle saved from the second step, where ASCII code converted from its own hexadecimal volume serial number is used as the key. The 5. If the Ô¨Åle size of ‚Äú%APPDATA%\\Microsoft\Windows\Cookies.exe‚Äù exceeds 4,485 bytes, it is executed. 6. Both ‚Äú%APPDATA%\\Microsoft\Windows\Cookies.txt‚Äù and ‚Äú%APPDATA%\\Microsoft\Windows\Cookies.exe‚Äù are then deleted (MITRE ATT&CKframework ID T1107)The observed routines of this VBS closely follow the other reports published on Gamaredon, such as the one from SentinelOne. However, the macro generated VBS was obfuscated in this case, likely as an additional evasive tactic. Interestingly, after decoding the VBS, we saw what appeared to be a programming mistake by the attacker. Lines 53 and 54 in Ô¨Ågure 6 are for closing those downloaded and decoded TXT and EXE Ô¨Åles, which are variables deÔ¨Åned right before the IF statement. If, however, these lines do not pass through this IF statement, an error would occur. It shows that this malware is not tested enough, and may still be under development. Our analysis found several URLs of the network destinations for both template injection and VBS. While resolving them to IP addresses to understand their attack bases, we also found that they were all linked to the following IP addresses.Network destination for template injection: 176[.]119[.]147[.]225 Network destination for VBS: 176[.]57[.]215[.]115These IP addresses are from Russian hosting companies. Most likely, the attackers rented Virtual Private Server (VPS) as their attack base. Their URL for VBS (shown below) likely includes the data when they conducted the attack.hxxp://{FQDN}/{computer name}_{hexadecimal volume serial number}/help_{day}_{month}[.]phpConclusion Gameradon is not the Ô¨Årst group to take advantage of the Covid-19 topic. Some cybercriminals have taken to indirect means of proÔ¨Åting, such as by targeting communication platforms that have increased in popularity after organizations shifted to work from home setups. In this case, they used Covid-19 as a cover for their relatively typical APT routine. We recommend these countermeasures to prevent similar APT attacks in the future:url‚Ä¶ 3/74/27/2020Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogCheck the email sender, subject, and body for anything suspicious before downloading and opening email attachments. Be especially wary of unsolicited emails, that come from unknown senders. Check the Ô¨Åle extension of the attached Ô¨Åle and make sure it is the intended Ô¨Åle format. Avoid activating macro for any attached Microsoft OfÔ¨Åce Ô¨Åles, especially for emails that request macro activation using an image of the body of the opened Ô¨Åle or those that don‚Äôt show anything. Watch out for spoofed domains embedded in emails before opening them. Subtle changes to a popular URL can be one indicator of malicious content.In addition to these actions, users can also implement a multi-layer approach and take advantage of these solutions.Trend Micro‚Ñ¢ Smart Protection Suitesand¬†Worry-Free‚Ñ¢ Business Security¬†protects users and businesses from similar threats by detecting malicious Ô¨Åles and spammed messages as well as blocking all related malicious URLs.¬†Trend Micro Deep Discovery‚Ñ¢¬†has an email inspection layer that can protect enterprises by detecting malicious attachments and URLs. Trend Micro‚Ñ¢ Hosted Email Securityis a no-maintenance cloud solution that delivers continuously updated protection to stop spam, malware, spear phishing, ransomware, and advanced targeted attacks before they reach the network. It protects Microsoft Exchange,¬†Microsoft OfÔ¨Åce 365, Google Apps, and other hosted and on-premises email solutions. Trend Micro‚Ñ¢ OfÔ¨ÅceScan‚Ñ¢with¬†XGen‚Ñ¢¬†endpoint security infuses high-Ô¨Ådelity machine learning with other detection technologies and global threat intelligence for comprehensive protection against advanced malware. The¬†Trend MicroTMXDR¬†solution effectively protects connected emails, endpoints, servers, cloud workloads, and networks. Trend Micro XDR uses powerful AI and expert security analytics to correlate data, as well as deliver fewer yet higher-Ô¨Ådelity alerts for early threat detection. In a single console, it provides a Aurl‚Ä¶ 4/7Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog4/27/2020 C&C addressesDetection Name Trojan.X97M.CVE20171 1882.THCOCBO TrojanSpy.Win32.FAREI T.UHBAZCLIZ Trojan.X97M.CVE20171 1882.THCOCBO Backdoor.Win32.REMC OS.USMANEAGFG Trojan.MSIL.AGENTTE SLA.THCOCBO Trojan.X97M.CVE20171 1882.THCOCBO Backdoor.Win32.REMC OS.USMANEAGFE TrojanSpy.Win32.FAREI T.UHBAZCLIZTrendX Downloader.VBA.TRX Downloader.VBA.TRX .XXVBAF01FF006 Troj.Win32.TRX.XXP Troj.Win32.TRX.XXP E50FFF034 Troj.Win32.TRX.XXP E50FFF034Bambinos[.]bounceme[.]net kristoffer[.]hopto[.]org kristom[.]hopto[.]org papir[.]hopto[.]org sabdja[.]3utilities[.]com sakira[.]3utilities[.]com seliconos[.]3utilities[.]com solod[.]bounceme[.]net sonik[.]hopto[.]org tele[.]3utilities[.]com violina[.]website voyager[.]myftp[.]biz voyaget[.]myftp[.]bizMitre ATT&CK Framework Related Posts:Operation ENDTRADE: Finding Multi-Stage Backdoors that TICK Spam Campaign Targets Colombian Entities with Custom-made ‚ÄòProyecto RAT,‚Äô Uses Email Service YOPmail for C&C Mac Backdoor Linked to Lazarus Targets Korean Users Outlaw Updates Kit to Kill Older Miner Versions, Targets More SystemsLearn how to protect Enterprises, Small Businesses, and Home Users from ransomware:ENTERPRISE¬ªSMALL BUSINESS¬ªHOME¬ªTags: APTurl‚Ä¶ 5/74/27/2020 0 CommentsTrendLabsüîí¬†Privacy PolicyGamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogLoginÓòÉ1 Sort by BestRecommendÔÑàt Tweet f ShareStart the discussion‚Ä¶LOG IN WITHOR SIGN UP WITH DISQUS?SubscribeAdd Disqus to your siteAdd DisqusAddd‚úâ Security Predictions for 2020D N t S ll M D t‚ö†Cybersecurity in 2020 will be viewed through many lenses ‚Äî from differing attacker motivations and cybercriminal arsenal to technological developments and global threat intelligence ‚Äî only so defenders can keep up with the broad range of threats. Read our security predictions for 2020.Business Process CompromiseAttackers are starting to invest in long-term operations that target speciÔ¨Åc processes enterprises rely on. They scout for vulnerable practices, susceptible systems and operational loopholes that they can leverage or abuse. To learn more, read our Security 101: Business Process Compromise.Recent PostsExposed Redis Instances Abused for Remote Code Execution, Cryptocurrency Mining Grouping Linux IoT Malware Samples With Trend Micro ELF Hash Gamaredon APT Group Use Covid-19 Lure in Campaigns Exposing Modular Adware: How DealPly, IsErIk, and ManageX Persist in Systems April Patch Tuesday: Fixes for Font-Related, Microsoft SharePoint, Windows Components VulnerabilitiesPopular PostsMore Than 8,000 Unsecured Redis Instances Found in the Cloud Raccoon Stealer‚Äôs Abuse of Google Cloud Services and Multiple Delivery Techniques Dissecting Geost: Exposing the Anatomy of the Android Trojan Targeting Russian Banks Operation Poisoned News: Hong Kong Users Targeted With Mobile Malware via Local News Links Coronavirus Update App Leads to Project Spy Android and iOS SpywareStay Updated Email SubscriptionHome and Home OfÔ¨Åce About Trend Micro Asia PaciÔ¨Åc Region (APAC): Australia / New Zealand, ‰∏≠ÂõΩ, ‚ΩáÊú¨, ÎåÄÌïúÎØºÍµ≠, Âè∞ÁÅ£ Latin America Region (LAR): Brasil, M√©xico North America Region (NABU): United States, Canada Europe, Middle East, & Africa Region (EMEA): France, Deutschland / √ñsterreich / Schweiz, Italia, –†–æ—Å—Å–∏—è, Espa√±a, United Kingdom / Irelandurl‚Ä¶ 6/74/27/2020Gamaredon APT Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogPrivacy Statement Legal Policies Copyright ¬© 2020 Trend Micro Incorporated. All rights reserved.url‚Ä¶ 7/7 