1/6/2020First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence BlogTrend Micro About TrendLabs Security Intelligence BlogSearch:Home CategoriesHome » Exploits » First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT GroupFirst Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT GroupPosted on:January 6, 2020 at 5:00 am Posted in:Exploits, Mobile Author: Trend Micro0Will you take a few moments to answer a few ques‐ tions surrounding your blog preferences?by Ecular Xu and Joseph C Chen We found three malicious apps in the Google Play Store that work together to compromise a victim’s device and collect user information. One of these apps, called Camero, exploits CVE-2019-2215, a vulnerability that exists in Binder (the main Inter-Process Communication system in Android). This is the ﬁrst known active attack in the wild that uses the use-after-free vulnerability. Interestingly, upon further investigation we also found that the three apps are likely to be part of the SideWinder threat actor group’s arsenal. SideWinder, aurlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/1/12First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog1/6/2020 group that has been active since 2012, is a known threat and has reportedly targeted military entities’ Windows machines. The three malicious apps were disguised as photography and ﬁle manager tools. We speculate that these apps have been active since March 2019 based on the certiﬁcate information on one of the apps. The apps have since been removed from Google Play.Figure 1. The three apps related to SideWinder groupFigure 2. Certiﬁcate information of one of the appsInstallation SideWinder installs the payload app in two stages. It ﬁrst downloads a DEX ﬁle (an Android ﬁle format) from its command and control (C&C) server. We found that the group employs Apps Conversion Tracking to conﬁgure the C&C server address. The address was encoded by Base64 then set to referrer parameter in the URL used in the distribution of the malware.Will you take a few moments to answer a few ques‐ tions surrounding your blog preferences?urlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/2/121/6/2020First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence BlogFigure 3. Parsed C&C Server addressAfter this step, the downloaded DEX ﬁle downloads an APK ﬁle and installs it after exploiting the device or employing accessibility. All of this is done without user awareness or intervention. To evade detection, it uses many techniques such as obfuscation, data encryption, and invoking dynamic code. The apps Camero and FileCrypt Manger act as droppers. After downloading the extra DEX ﬁle from the C&C server, the second-layer droppers invoke extra code to download, install, and launch the callCam app on the device.Figure 4. Two-stage payload deploymentWill you take a few moments to answer a few ques‐ tions surrounding your blog preferences?urlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/3/121/6/2020First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence BlogFigure 5. Code showing how the dropper invokes extra DEX codeTo deploy the payload app callCam on the device without the user’s awareness, SideWinder does the following: 1. Device Rooting This approach is done by the dropper app Camero and only works on Google Pixel (Pixel 2, Pixel 2 XL), Nokia 3 (TA-1032), LG V20 (LG-H990), Oppo F9 (CPH1881), and Redmi 6A devices. The malware retrieves a speciﬁc exploit from the C&C server depending on the DEX downloaded by the dropper.Figure 6. Code snippet from Extra DEX downloaded by CameroWe were able to download ﬁve exploits from the C&C server during our investigation. They use the vulnerabilities CVE-2019-2215 and MediaTek-SU to get root privilege.Figure 7. CVE-2019-2215 exploitWill you take a few moments to answer a few ques‐ tions surrounding your blog preferences?urlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/4/121/6/2020First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence BlogFigure 8. MediaTek-SU exploitAfter acquiring root privilege, the malware installs the app callCam, enables its accessibility permission, and then launches it.Figure 9. Commands install app, launch app, and enable accessibility2. Using the Accessibility Permission This approach is used by the dropper app FileCrypt Manager and works on most typical Android phones above Android 1.6. After its launch, the app asks the user to enable accessibility.Will you take a few moments to answer a few ques‐ tions surrounding your blog preferences?urlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/5/121/6/2020First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence BlogFigure 10. Steps FileCrypt Manager prompts user to doOnce granted, the app shows a full screen window that says that it requires further setup steps. In reality, that is just an overlay screen that is displayed on top of all activity windows on the device. The overlay window sets its attributions to FLAG_NOT_FOCUSABLE and FLAG_NOT_TOUCHABLE, allowing the activity windows to detect and receive the users’ touch events through the overlay screen.Will you take a few moments to answer a few ques‐ tions surrounding your blog preferences?urlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/6/121/6/2020First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence BlogFigure 11. Overlay screenMeanwhile, the app invokes code from the extra DEX ﬁle to enable the installation of unknown apps and the installation of the payload app callCam. It also enables the payload app’s accessibility permission, and then launches the payload app. All of this happens behind the overlay screen, unbeknownst to the user. And, all these steps are performed by employing Accessibility.Figure 12. Code enabling install of unknown apps and new APKFigure 13. Code enable accessibility permission of the newly installed appcallCam’s Activities The app callCam hides its icon on the device after being launched. It collects the following information and sends it back to the C&C server in the background:Will you take a few moments to answer a few ques‐ tions surrounding your blog preferences?Location Battery status Files on device Installed app list Wiﬁ informationurlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/7/121/6/2020First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence BlogData of WeChat, Outlook, Twitter, Yahoo Mail, Facebook, Gmail, and ChromeThe app encrypts all stolen data using RSA and AES encryption algorithms. It uses SHA256 to verify data integrity and customize the encoding routine. When encrypting, it creates a block of data we named headData. This block contains the ﬁrst 9 bytes of origin data, origin data length, random AES IV, the RSA- encrypted AES encrypt key, and the SHA256 value of AES-encrypted origin data. Then the headData is encoded through the customized routine. After the encoding, it is stored in the head of the ﬁnal encrypted ﬁle followed by the data of the AES-encrypted original data.Figure 14. Data encryption processWill you take a few moments to answer a few ques‐ tions surrounding your blog preferences?Relation to SideWinderFigure 15. Customized encoding routine doneurlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/8/12First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog1/6/2020 These apps may be attributed to SideWinder as the C&C servers it uses are suspected to be part of SideWinder’s infrastructure. In addition, a URL linking to one of the apps’ Google Play pages is also found on one of the C&C servers.Figure 16. Google Play URL of FileManager app found in one of the C&C servers.Trend Micro Solutions Trend Micro solutions such as the Trend Micro™ Mobile Security for Android™ can detect these malicious apps. End users can also beneﬁt from its multilayered security capabilities that secure the device owner’s data and privacy and safeguard them from ransomware, fraudulent websites, and identity theft. For organizations, the Trend Micro Mobile Security for Enterprise suite provides device, compliance, and application management, data protection, and conﬁguration provisioning. It also protects devices from attacks that exploit vulnerabilities, prevents unauthorized access to apps, and detects and blocks malware and fraudulent websites. Trend Micro’s Mobile App Reputation Service (MARS) covers Android and iOS threats using leading sandbox and machine learning technologies to protect users against malware, zero-day and known exploits, privacy leaks, and application vulnerabilities.Indicators of CompromiseSHA256 73d2bb915d198ae42Package Name/File type App Name/Detection com.callCam.android.call callCamm Cam2baseWill you take a few moments to answer a few ques‐ tions surrounding your blog preferences?Package Name/File type com.abdulrauf.ﬁlemanager com.callCam.android.callCam2baseApp Name/Detection callCammurlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/9/12First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence BlogCamero1/6/2020 com.camero.android.camera2basic C&C Servers ms-ethics.net deb-cn.net ap1-acl.net ms-db.net aws-check.net reawk.netMITRE ATT&CK Matrix™Will you take a few moments to answer a few ques‐ Learn how to protect Enterprises, Small Businesses, and Home Users from ransomware: tions surrounding your blog preferences?ENTERPRISE»SMALL BUSINESS»HOME»Tags: appAPTgoogle playurlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/10/12First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence BlogLogin1 Sort by Best1/6/2020 0 CommentsTrendLabsRecommendt Tweet f ShareStart the discussion…LOG IN WITHOR SIGN UP WITH DISQUS?Be the ﬁrst to comment.SubscribeAdd Disqus to your siteAdd DisqusAddd✉ Featured StoriesDisqus' Privacy PolicyPrivacy PolicyPrivacy🔒systemd Vulnerability Leads to Denial of Service on Linux qkG Filecoder: Self-Replicating, Document-Encrypting Ransomware Mitigating CVE-2017-5689, an Intel Management Engine Vulnerability A Closer Look at North Korea’s Internet From Cybercrime to CyberpropagandaSecurity Predictions for 2019Our security predictions for 2019 are based on our experts’ analysis of the progress of current and emerging technologies, user behavior, and market trends, and their impact on the threat landscape. We have categorized them according to the main areas that are likely to be affected, given the sprawling nature of the technological and sociopolitical changes under consideration. Read our security predictions for 2019.Business Process CompromiseWill you take a few moments to answer a few ques‐ tions surrounding your blog preferences?Attackers are starting to invest in long-term operations that target speciﬁc processes enterprises rely on. They scout for vulnerable practices, susceptible systems and operational loopholes that they can leverage or abuse. To learn more, read our Security 101: Business Process Compromise.urlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/11/121/6/2020 Recent PostsFirst Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence BlogFirst Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group Looking into Attacks and Techniques Used Against WordPress Sites Why Running a Privileged Container in Docker Is a Bad Idea DDoS Attacks and IoT Exploits: New Activity from Momentum Botnet More than a Dozen Obfuscated APT33 Botnets Used for Extreme Narrow TargetingPopular PostsMore than a Dozen Obfuscated APT33 Botnets Used for Extreme Narrow Targeting Banking Trojan DRIDEX Uses Macros for Infection Microsoft November 2019 Patch Tuesday Reveals 74 Patches Before Major Windows Update (Almost) Hollow and Innocent: Monero Miner Remains Undetected via Process Hollowing April Patch Tuesday: Microsoft Patches Ofﬁce Vulnerability Used in Zero-Day AttacksStay Updated Email SubscriptionHome and Home Ofﬁce About Trend Micro Asia Paciﬁc Region (APAC): Australia / New Zealand, 中国, ⽇本, 대한민국, 台灣 Latin America Region (LAR): Brasil, México North America Region (NABU): United States, Canada Europe, Middle East, & Africa Region (EMEA): France, Deutschland / Österreich / Schweiz, Italia, Россия, España, United Kingdom / Ireland Copyright © 2020 Trend Micro Incorporated. All rights reserved.Will you take a few moments to answer a few ques‐ tions surrounding your blog preferences?urlﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/12/12 