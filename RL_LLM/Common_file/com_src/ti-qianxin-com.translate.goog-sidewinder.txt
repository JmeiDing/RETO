ti-qianxin-com.translate.goog /blog/articles/sidewinder-group's-recent-attack-activity-briefing/ Hidden Fangs in South Asiaâ€”A Briefing on Recent Rattlesnake AttacksbackgroundSidewinder, also known as APT-C-17, Qi Anxin's internal tracking number is APT-Q-39. Its attack activities can be traced back as early as 2012. The organization mainly launched attacks against countries such as Pakistan, China, Afghanistan, Nepal, and Bangladesh, aiming to steal confidential information from government diplomatic agencies, defense and military departments, and higher education institutions. Activities have a strong political background. The organization is capable of attacking both Windows and Android platforms.The group primarily utilizes email spear-phishing, exploit documents, and DLL sideloading techniques to evade detection and deliver targeted implants. Commonly used attack bait types are: office documents and Ink. Among them, after Ink is executed, Powershell will release the real file and download and execute the hta script to load subsequent malicious files; Office documents are the group's favorite attack bait, which are executed by exploiting known vulnerabilities (such as the CVE-2017-11882 vulnerability) follow-up activities. The organization will also use the method of white and black to load malicious files [1] .overviewThe Rattlesnake Organization has always been our focus. Recently, the Red Raindrop team of Qi Anxin Threat Intelligence Center captured multiple attack samples of the organization in daily threat hunting. This type of sample uses Pakistan-related schools or the army as bait to carry out harpoon attacks, and its attack techniques and tactics (TTP) use the DotNetToJScript tool to generate JS code to load .net programs. In the recent attack activities, we summarized the characteristics of the attack methods of the Sidewinder organization:(1) Make good use of social engineering and use more appropriate bait, even the bait comes from real documents;(2) Multi-stage download and obfuscation of subsequent loads;(3) Use a lightweight remote Shell backdoor, and continue to use related C2 even after being exposed.After discovering the attack, the Red Raindrop team immediately alerted the security community [2] , but this seems to have alerted the operators of the Rattlesnake organization, and shut down C2 immediately.1/16sample informationThe basic information of the bait file captured this time is as follows:--2/16- typeGUIDELINES FOR JOURNAL - 2023 PAKISTAN NAVY WAR COLLEGE (PNWC).docx(Journal Guide - 2023 Pakistan Naval War College) 666B2B178CE52E30BE9E69DE93CC60A9 13115 bytes-docxUsing relevant documents of the Pakistan Navy as bait, the content of the bait is as follows:There is no macro code in the decoy sample, and remote template injection is used to pull subsequent loads for execution, reducing the possibility of being killed by anti-software in the early stage. Its remote template injection address is url it can be seen that its domain name is disguised as pnwc Naval War College, Pakistan, agreed with the content of the bait.3/16sample analysisremote template fileThe remote template file is an RTF file, which uses the CVE-2017-11882 vulnerability to execute Shellcode, and releases the subsequent payload 1.a file to the %temp% directory through the RTF file feature.4/16After the vulnerability is executed, execute a ROP chain to jump to the Shellcode location, and the exploit will trigger two pieces of shellcode. The main function of the first shellcode is to obtain the specified memory block by calling the Globallock function, then calculate the starting position of the second shellcode, and jump to the second shellcode for execution.The shellcode contains a large number of wasteful instructions, which indicates that Sidewinder is gradually improving its shellcode to slow down the analysis speed of analysts. The main function of Shellcode is to load mshtml.dll, call the API RunHTMLApplication function in it, and execute XOR-decrypted commands.javascript:eval\("sa=ActiveXObject;ab=new sa\ (\\"Scripting\.FileSystemObject\\"\);eval\(ab\.OpenTextFile\(ab\.GetSpecialFolder\ (2\)\+\\"\\\\\\\\1\.a\\",1\)\.ReadAll\(\)\);window\.close\(\)"\)1.a fileThe basic information of the released 1.a file is as follows.-file name 1.a MD5-749A2FC5A803A5B58C2023B9D8C2B6865/16-File size 208968 bytes file type JavaScript-1.a file should be generated by modifying the open source tool DotNetToJScript. The string is obfuscated by multi- layer nested conversion functions, and the embedded PE file is divided into two parts. The former part is obfuscated, and the latter part is used BASE64 for encoding.The script first decrypts the App.dll, and loads the Work function in the DLL reflectively, and passes 4 parameters to the Work function. The parameter 1 is the URL for downloading file.hta, and the parameter 2 is the uploaded antivirus information. Since the decoy file has been displayed , here parameter 3 and parameter 4 are empty, unlike the previously encrypted decoy document content and decoy document name.6/16App.dllApp.dll is actually a dll written in .net, and it has also been obfuscated, but the obfuscator did not obfuscate the key code too much, and the core code is still readable.Its main function is to download the follow-up payload from the URL parameter. The relevant method to initiate a request to C2 is Program.osteologistfearfullestprofessionallystreptolysinconsumerisms. The content downloaded from the URL corresponding to parameter 1 of the Work method will be decrypted through simple xor, and then loaded and executed.7/16Regrettably, C2 was closed shortly after we disclosed it for the first time, and we failed to download the follow-up paylaod. In the follow-up, as we continued to pay attention, the organization still uploaded attack files similar to TTP, such as Pakistani Naval procurement information is used as bait to attack.8/16The domain name of the link injected into the remote template is also faked to be related to the decoy content.9/16Some subsequent remote template files are basically consistent with the above. Based on this, we analyze the recent attack activities organized by the Sidewinder organization. The remote template file information is as follows:MD5 619885D19F4FB97E79227D61E085498E pnwc.bol-north.com 356F30BA570428A6D0896E3960DE8B70 paknavy-gov-pk.downld.netThe download domain name of the subsequent payload---Traceability associationIn addition, in the follow-up clue sorting, we also found another attack component of the Sidewinder organization. As of the completion of this manuscript, the C2 that delivered the attack component is still active. Since this component has been analyzed by a friend, we only make a brief disclosure and do not analyze it in detail.The details of the attack components are as follows:MD5 DE4438081659A1EF086B8F060CD1C733 kito.countpro.infoC2-10/16-- 41E72581C919A8BC5C80B6D43F2A72B0 preag.info C5CF7EEDA09C88CE5415CF8FF9AF9846 dolper. top AED57E12F7DD03911F48AE87413283A6 ongrep.xyzThe actual function of this attack component is a downloader, which also downloads and decrypts the JS code generated by the DotNetToJScript tool and executes it. The difference is that in the win10 system, Microsoft introduced AMSI and added the script features based on DotNetToJScript to the detection sequence, so if you do not bypass the processing and directly run the script generated by DotNetToJScript, it will be directly intercepted by the system . So the Sidewinder organization registered the DLL notification callback in the attack component and hooked the "AmsiScanBuffer" function to bypass detection.The file downloaded from C2 is an encrypted JS file, which is executed in memory after XOR decryption.11/16The JS code also reflectively loads LiveConsoleModule.dll in the memory. This dll is actually a remote Shell RAT, which listens to the local TCP port 12323 and uses cmd to execute remote Shell commands.12/16SummarizeFor a long time, the Rattlesnake organization has been good at using social engineering to attack, especially using special file stealers to steal important information in the victim's network environment. In addition to causing leaks, the stolen information can also be used to make new bait, and in its attack activities, the fake C2 domain name also appears, which is very confusing.Qi'anxin Red Raindrop team hereby reminds all users, do not open links from unknown sources shared by social media, do not click on and execute email attachments from unknown sources, do not run unknown files with exaggerated titles, and do not install apps from informal sources. Back up important files in time and update and install patches.If you need to run or install applications from unknown sources, you can first identify them through the Qi Anxin threat intelligence file in-depth analysis platform (url At present, it supports in- depth analysis of files in various formats including Windows and Android platforms.13/16At present, the full line of products based on the threat intelligence data of Qi Anxin Threat Intelligence Center, including Qi Anxin Threat Intelligence Platform (TIP), Tianqing, Tianyan Advanced Threat Detection System, Qi Anxin Tiangou Vulnerability Attack Protection System, Qi Anxin NGSOC, Qi Anxin Situation Perception, etc., have supported the precise detection of such attacks.IOCsMD5666B2B178CE52E30BE9E69DE93CC60A903940342FA0CCD5F3C40DA659776FD56749A2FC5A803A5B58C2023B9D8C2B6868934F22ED2D4390F2E6170E4CFDBD483619885D19F4FB97E79227D61E085498E14/1636D40B74ACBA4C051EDC140159025AC43B853AE547346BEFE5F3D06290635CF6619885D19F4FB97E79227D61E085498E356F30BA570428A6D0896E3960DE8B70DE4438081659A1EF086B8F060CD1C73341E72581C919A8BC5C80B6D43F2A72B05D9FF132811DC200EEF3ED7860CA625112A69185E72B8298AE1613E9DC5DC822AED57E12F7DD03911F48AE87413283A6C5CF7EEDA09C88CE5415CF8FF9AF9846URLurl f9da4b04/1/url north.com/5808/1/3686/3/1/1/1857177634/AxRXAaDisLX12wCdCYmCVIaTQnRk0pN3aa4eAgGn/files-9183e1c1/1/url pk.downld.net/14578/1/6277/3/1/1/1856303893/Fra9anCDjiaq12rCbUAhXveAk5kMltaItuPZDQRd/files-1f77d26e/1/url topongrep.xyzreference link[1] url url 