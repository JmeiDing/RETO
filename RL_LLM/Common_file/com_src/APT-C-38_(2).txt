5/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogSaber Lions Organization (APT-C-38) Attacks Uncoveredblogs.360.cn/post/analysis-of-APT-C-38.htmlMay 27, 2019 Saber lion organization (APT-C-38) attack activity revealedI. Overview Since July 2015, the Army Lions Organization (APT-C-38) has launched an organized, planned and targeted uninterrupted attack in the Middle East. Its attack platform is Windows and Android. Up to now, 360 Beaconlab has captured 25 Android platform attack samples, 4 Windows platform attack samples, and 16 C2 domain names.In May 2018, Kaspersky security vendor published the report " Who's who in the Zoo ", the ﬁrst time to disclose the organization as an unafﬁliated espionage organization focused on the Middle East target, and named ZooPark, the attack weapon involved contains four iterations The version of the Android-side RAT, load delivery methods include puddles and Telegram channels.In 2019, 360 Campﬁre Lab captured the latest attack activity of the Saber Lions organization. In addition to discovering Android-side attacks, it also found that the organization had Windows-side attacks, and the Android-side RAT still belongs to the fourth generation. We combine the geopolitical factors of the APT attack, the language used by the attacking organization, and the historical attack activities initiated by the organization. The analysis considers the organization to be an APT organization in the background of a country in the Middle East in West Asia. In addition, we would like to thank our brother team----360 Advanced Threat Response Team for the completion of the Windows side RAT content of this report.Because of the main target of the Saber-Like organization, the Kurdish target is a Kurdish country in the Middle East and West Asia. In addition, the Windows side RAT contains multiple "Saber" under the PDB path, and the Asian lion is the representative animal of the Middle East. Some of the other characteristics of the organization and the 360 naming rules for the APT organization, we named the organization the Saber Lion (APT-C-38).blogs.360.cn/post/analysis-of-APT-C-38.html1/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogFigure 1.1 The time of the key attack activity of the saber lion Second, load delivery and network infrastructure The way the saber lion organizes the payload delivery is mainly the puddle attack and the Telegram channel. It should be noted that after the organization was ﬁrst leaked in early May 2018, the attacking organization used a new batch of network infrastructure at the end of the month.- Puddle attackTwo Arab news newspaper websites (Annahar, Kuwait and Al-Nahar, Egypt), which are popular in the Middle East, have been found to have been used by the organization for puddle attacks.blogs.360.cn/post/analysis-of-APT-C-38.html2/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogFigure 2.1 Egypt Al-Nahar website- Telegram channelIn addition to the above two puddle attacks against the designated Arab countries in the Middle East, we also found that the organization used the Telegram channel to spread the Kurdish people in the Middle East when attacking its main target (such as the election of the Kurdistan Province before the Islamic Parliament). Attacks and attacks in the Kurwana Nanda quarter of Kurdistan Province, etc.).Figure 2.2 Telegram channel against the Kurdish provincial elections before the Islamic Parliament- Network infrastructureTo date, the Saber Lions organization has used multiple network infrastructures.Table 1 Network infrastructure used by the Army Lions organizationRhubarb2.com C2 serverRhubarb3.com C2 serverAndroidup‐ daters.comDlgmail.comIntermediate age)IR'Sanan IR'TehranIR'Tehran+98.9303938251 Pilton86 ProtectPrivacyProtect+98.2188561212 Asghark‐ hof@gma il.com+98.2188888299 Silent.c‐ 98652145231663976888blogs.360.cn/post/analysis-of-APT-C-38.html3/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogDlstubes.comGoogleupda‐ age)Dlstube.comAdobeactive‐ Null Null Null+98.8877588798 Bold‐man.sam +98.8877588798 Bold‐man.sam +98.8877588798 Bold‐man.sam +98.2177888991 Bold‐man.sam @mail.‐ com+98.2122694575 Kimkallia n@gmail. com+98.9106145178 Sirus_viru NullIt should be noted that on May 23, 2018, a new batch of network infrastructure was applied. The latest mobile attack load was deployed in one of the servers in March 2019. There are 4 intermediate servers and 3 of them. It still survives and resolves to the same IP, and these servers act as intermediate servers for the PC and mobile RATs.blogs.360.cn/post/analysis-of-APT-C-38.html4/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogFigure 2.3 A batch of network infrastructure newly deployed by the Saber Lions organization in the month after being disclosed Third, the way of induction The Saber lion organization mainly uses the following two induction methods in this operation:- Camouﬂage with normal APP functionFor better avoidance, it is noticed that in addition to masquerading the ﬁle icon, the normal APP interface will be displayed when the RAT starts. Currently, the four-initiative version of the Android RAT will display the normal interface after running, but Espionage in the background is turned on at runtime or when a speciﬁed broadcast is received.blogs.360.cn/post/analysis-of-APT-C-38.html5/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogFigure 3.1 Second and fourth generation Android RAT post-run demonstration examples- File icon camouﬂageFigure 3.2 Disguised application software icon Fourth, RAT attack sample analysis As of now, the Saber has been using different RATs for Android and Windows platforms. After analysis, we believe that the latest Android RAT and PC RAT should be purchased from the same commercial development organization, one of the developers nicknamed "Apasec ".- AndroidThe Android side uses a total of four iterations of the RAT. In this report, we only introduce the fourth-generation RAT used by the latest attack activities. We are called UnitMM. The RAT is currently only available in the saber lion organization. For other versions of the RAT, refer to the information. The Kaspersky Security Vendor Report mentioned earlier in this report.blogs.360.cn/post/analysis-of-APT-C-38.html6/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogThe fourth generation RAT of the UnitMM Saber Lion organization. We named it UnitMM based on the class name and database name used by the RAT. The latest version of UnitMM controls dozens of feature conﬁgurations to steal SMS, contacts, geolocation, browser bookmarks and search history, clipboard information, externally speciﬁed application data, capture photos/video/audio A variety of malicious behaviors.In addition, UnitMM can also interact in response to speciﬁed instructions from C2.Table 2 C2 instruction and function correspondence tableUpdate malicious feature conﬁguration Execute shell command Compress and save the speciﬁed ﬁle/folder to the default directory Write the task content to a temporary zip ﬁle, extract all the content from it and delete it Copy the speciﬁed ﬁle/folder to the speciﬁed directory Move the speciﬁed ﬁle/folder to the speciﬁed directory Rename the speciﬁed ﬁle/folder Delete speciﬁed ﬁle/folder Create the speciﬁed directory Silently send the speciﬁed content message to the speciﬁed number Dial the speciﬁed numberGet the ﬁle list information under the speciﬁed path and save it to the default directory Update intermediate server (C2 steganographic picture) list2 26- WindowsA RAT has been discovered on the Windows side. We have been named SpecialSaber. The RAT is currently only available in the Army Lions organization, with a total of four.SpecialSaber This is a RAT that has not been exposed before. According to the directory name under the latest version of the PDB path, we are named SpecialSaber. It has detection and killing (including Bitdefender, Kaspersky, Avira, Avast, AVG, ClamWin, ESET, Norton, McAfee, Panda, Symantec), stealing a variety of browser information, a variety of mailbox information, user account information, disk ﬁle information, etc. With a variety of malicious behaviors such as keyloggers and screenshots. After stealing various information, it will be saved in the ﬁle's own working directory. The ﬁle name is randomly generated š string, and the ﬁle is stored in the speciﬁed format.blogs.360.cn/post/analysis-of-APT-C-38.html7/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogFigure 4.1 Example of a screenshot ﬁle stored in a uniform formatTable 3 Table of some ﬁle type values and ﬁle meanings1 fourScreenshot, jpeg format A list of all ﬁles for each drive, including directory, ﬁle name, ﬁle size information Keylogger Account password information for FireFox, Chrome, IE, Opera, Safari, Thunder‐ bird, Outlook History of FireFox, Chrome, IE, Opera, Safari Bookmark information for FireFox, Chrome, IE, Opera, Safari Yahoo Messenger account password information User account list and details for each account Logical drive size, free space and drive letter Complete TCP/IP conﬁguration for all adapters Zip compressed ﬁle Detailed conﬁguration information of the operating system, including soft kill in‐ formation, product ID, hardware attributes, etc.In addition, SpecialSaber can also interact in response to speciﬁed instructions from C2.Table 4 Part C2 instruction and function correspondence table3 4 6Create the speciﬁed directory Rename the speciﬁed ﬁle/folder ﬁle downloadblogs.360.cn/post/analysis-of-APT-C-38.html8/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogFile compression encryption (Zip, AES)7 10 Get account password information for FireFox, Chrome, IE, Opera, Safari, Thunder‐bird, Outlook11 Get bookmark information for FireFox, Chrome, IE, Opera, Safari 12 Get the history of FireFox, Chrome, IE, Opera, Safari 14 Get the name of the uninstaller list 16 Get the size of the logical drive, the remaining space and the drive letter 17 Get full TCP/IP conﬁguration for all adapters 18 Get a list of user accounts and details for each account 25 Get Yahoo Messenger account password information- Suspected to be purchased from the same commercial development companyBy comparing the UnitMM RAT on the Android side with the SpecialSaber RAT on the Windows side, we see that the two adopt a similar approach in the C2 communication link, and the information stolen by the two has a special commonality. We think that the two should come from the same business. Development organization.In addition, we found a developer named "Apasec" in the path of a PDB. We found that the name appeared in the C2 panels of the organization's mobile terminal many times. This ﬁnding further veriﬁes our judgment. V. Distribution of the attacked area Up to now, 360 Campﬁre Labs has found that there are 7 countries affected by the attack of the Saber Lions, of which Iran is the most affected. This is related to the attack on the Kurds who found the country during our analysis. It doesn't matter.Figure 5.1 Distribution of the attacked areablogs.360.cn/post/analysis-of-APT-C-38.html9/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogSixth, the attacker portrait Based on the attacker's special attacks on the attack, the language used, and the geopolitical factors of the APT attack, we summarized the following views of the attack organization:Familiar with Persian, Arabic, with Persian being the most frequently used. It is mainly aimed at Kurdish people in a certain province in the Middle East in West Asia. It can deploy attacks on activities at certain moments in real time and even in advance, and it also targets several Arab countries in the Middle East. APT attacks are mostly based on internal and geopolitical factors (national or hostile). From the perspective of the victim's background and the duration of the attack, the target of the attacker's focus is signiﬁcant at the political and strategic level and lasts longer.In summary, 360 Campﬁre Lab believes that the attacker is an APT organization from a country in the Middle East in West Asia. Seven, summary In recent years, we have seen that APT attacks have evolved with the times. The PC side is no longer a unique target. More and more attack organizations will also use the mobile end as another necessary target for attacks, and even invest frequently. The cyber war under the background of some countries in the Middle East and the Asia- Paciﬁc region.APT attacks are developing rapidly, especially the development of mobile attacks. We have seen that some of the attacking organizations in the past few years are still relatively rudimentary. Even some security vendors use kittens and other names to name them to show low respect for the attacking capabilities of the corresponding attacking organizations. However, as the attack gains value and the attack organization increases its investment, we see that the attack is more and more complex, and the pertinence and effectiveness are getting stronger. If the former kitten is used as an example, it is like a young one. The kitten gradually became a mature lion. This saber lion organization is undoubtedly a typical representative of the development of APT attacks. Based on the special background of the organization and the current situation of its afﬁliated countries, we believe that the organization's attack may have a new round of changes.Appendix A: Sample MD5blogs.360.cn/post/analysis-of-APT-C-38.html10/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology BlogMD5MD5 WindowsAndroid solar64.xp3.biz entekhab10.xp3.bizAppendix C: PDBC:\Users\apasec110\Desktop\Saber1\client\Saber1-Develop\Release\Saber1- Dev.pdb C:\Users\apasec110\Desktop\Saber1\client\editing saber\Saber1-Develop- changed\Release\Saber1-Dev.pdb C:\Users\M&M\Desktop\Saber1\Special-Saber1-Windows-Client- binder_backup(last stable socket communication)\Release\Saber1-Dev.pdb C:\Users\M&M\Desktop\Saber1\Special-Saber1-Windows-Client- binder_backup\Release\Saber1-Dev.pdbAppendix D: Reference Linksblogs.360.cn/post/analysis-of-APT-C-38.html11/125/27/2019Saber Lions Organization (APT-C-38) Attacks Uncovered - 360 Core Security Technology Blog[1] https: [5] https:This article links: url EOF --Author published in 2019-05-27 10:15:30 , added classiﬁcation under and added ' ' label, last modiﬁed 2019-05-27 11:04:14 360 android360 BeaconlabAPT Android 360mobileblogs.360.cn/post/analysis-of-APT-C-38.html12/12 