2016/7/14The Dropping Elephant actor - SecurelistThe Dropping Elephant – aggressive cyber- espionage in the Asian regionBy GReAT on July 8, 2016. 5:57 amRESEARCHAPT SPEAR-PHISHING VULNERABILITIESGReAT Kaspersky Lab's Global Research & Analysis Team@e_kaspersky/greatDropping Elephant (also known as “Chinastrats” and “Patchwork“) is a relatively new threat actor that is targeting a variety of high profile diplomatic and economic targets using a custom set of attack tools. Its victims are all involved with China’s foreign relations in some way, and are generally caught through spear­ phishing or watering hole attacks.Overall, the activities of this actor show that low investment and ready­made offensive toolsets can be very effective when combined with high quality social engineering. We have seen more such open source toolset dependency with meterpreter and BeEF, and expect to see this trend continue.The Attack Method: Infection VectorDropping Elephant uses two main infection vectors that share a common, and fairly elaborately maintained, social engineering theme – foreign relations with China.The first approach involves spear­phishing targets using aurl Dropping Elephant actor - Securelistdocument with remote content. As soon as the user opens the document, a “ping” request is sent to the attackers’ server. At this point, the attackers know the user has opened the document and send another spear­phishing email, this time containing an MS Word document with an embedded executable. The Word document usually exploits CVE­2012­0158. Sometimes the attackers send an MS PowerPoint document instead, which exploits CVE­2014­6352.Once the payload is executed, an UPX packed AutoIT executable is dropped. Upon execution, this downloads additional components from the attackers’ servers. Then the stealing of documents and data begins.The second approach involves capturing victims through watering hole attacks. The actor created a website that downloads genuine news articles from other websites. If a website visitor wants to view the whole article they would need to download a PowerPoint document. This reveals the rest of the article, but also asks the visitor to download a malicious artifact.The two main infection vectors are supported by other approaches. Sometimes, the attackers email out links to their watering hole websites. They also maintain Google+, Facebook and twitter accounts to develop relevant SEO and to reach out to wider targets. Occasionally, these links get retweeted, indiscriminately bringing more potential victims to their watering holes.The Attack Tools1. Malware AnalysisThe backdoor is usually UPX packed but still quite large in size. The reason for this is that most of the file comprises meaningless overlay data, since the file is an automatically generated AutoIT executable with an AutoIT3 script embedded inside. Once started, it downloads additional malware from the C2 and also uploads some basic system information, stealing, among other things, the user’s Google Chrome credentials. The backdoor also pings the C2 server at regular intervals. A good security analyst can spot this while analyzing firewall log files and thereby find out that something suspicious might be going on in the network.Generally speaking, backdoors download additional malware inurl Dropping Elephant actor - Securelistthe form of encrypted or packed executables/libraries. But, in the case of Dropping Elephant, the backdoor downloads encoded blobs that are then decoded to powershell command line “scripts”. These scripts are run and, in turn download the additional malware.One of the more interesting malware samples downloaded is the file­stealer module. When this file­stealer is executed, it makes another callback to the C2 server, downloading and executing yet another malware sample. It repeatedly attempts to iterate through directories and to collect files with the following extensions: doc, docx, ppt, pptx, pps, ppsx, xls, xlsx, and pdf. These files are then uploaded to the C2 server.Also interesting are the resilient communications used by this group. Much like the known actors Miniduke or CommentCrew, it hides base64 encoded and encrypted control server locations in comments on legitimate web sites. However, unlike the previous actors, the encrypted data provides information about the next hop, or the true C2 for the backdoor, instead of initial commands.2. C2 AnalysisIn many cases it was very difficult to get a good overview of the campaign and to find out how successful it is. By combining KSN data with partner­provided C2 server data, we were able to obtain a much fuller picture of the incident.We examined connections and attack logins to this particular C2. As it turned out, the attackers often logged in via a VPN, but sometimes via IPs belonging to an ordinary ISP in India. We then looked at the time the attackers were active, of which you can find an image below.url Proﬁle and Geography3/102016/7/14Victim Proﬁle and GeographyThe Dropping Elephant actor - SecurelistWe also wanted to get a better idea of the geolocation of most visitors. Analysis of the image provided access counts and times, along with the IP of the visiting system.Noteworthy are the many IPs located in China. This focus on China­related foreign relations was apparent from the ongoing social engineering themes that were constant throughout the attacks. The concentration of visits from CN (People’s Republic of China) could be for a variety of reasons – diplomatic staff are visiting these sites from their CN offices, CN academics and analysts are very interested in researching what they believe to be CN­focused think tanks, or some of the IPs are unknown and not self­identifying as bots or scrapers. Regardless, because we were able to determine that multiple targets are diplomatic and governmental entities, these foreign relations efforts are likely to represent the main interest of the attackers.ConclusionCampaigns do not always need to be technically advanced to be successful. In this case, a small group reusing exploit code, some powershell­based malware and mostly social engineering has been able to steal sensitive documents and data from victims since at least November 2015.Our analysis of the C2 server confirmed the high profile of most victims, mainly based in the Asian region and specially focused on Chinese interests. Actually, some hints suggest the group has been successful enough to have recently expanded its operations, perhaps after proving its effectiveness and the value of the data stolen.This is quite worrying, especially given the fact that no 0 days or advanced techniques were used against such high profile targets. Simply applying software patches will prevent attacks based on old exploits, as well as training in the most basic social engineering attacks.However, it should be noted that in this case Microsoft´s patch for exploit CVE­2014­1761 just warns the user not to allow the execution of the suspicious file.url Dropping Elephant actor - SecurelistDropping Elephant artifacts are detected by Kaspersky Lab products as: Exploit.Win32.CVE­2012­0158.* Exploit.MSWord.CVE­2014­1761.* Trojan­Downloader.Win32.Genome.* HEUR:Trojan.Win32.GenericAs usual Kaspersky Lab actively collaborates with CERTs and LEAs to notify victims and help to mitigate the threat. If you need more information about this actor, please contact intelreports@kaspersky.comMore information on how Kaspersky Lab technologies protect against such cyberespionage attacks is available on Kaspersky 13_Five_Year_Plan_2016­20­1.pps Reconciliation_China’s_PLAN.doc url url url url url­cn[.]org alfred.ignorelist[.]com url url url url url url ussainbolt.mooo[.]com ussainbolt1.mooo[.]com updatesys.zapto[.]org updatesoft.zapto[.]orgC2 redirectors (with obfuscated comments)url url url url url url Dropping Elephant actor - SecurelistUpdate: our friends from Cymmetria have released their analysis of the Dropping Elephant / Patchwork APT – make sure to check it as well for more data about the attacks.Related PostsOPERATION DAYBREAKCVE-2016-4171 – ADOBE FLASH ZERO-DAY USED THREATSurl 