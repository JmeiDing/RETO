blogs.infoblox.com /cyber-threat-intelligence/nobelium-campaigns-and-malware/ NOBELIUM Campaigns and Malware Cyber Intel Unit ⋮ ⋮ 6/3/2021Author: James BarnettTLP: WHITE 1. Executive SummaryBetween 27 and 28 May, Microsoft published two reports on NOBELIUM, the threat actor behind the December 2020 supply chain attacks1 on SolarWinds’ Orion platform. The first report detailed an ongoing spearphishing campaign that leveraged a variety of techniques to distribute a Cobalt Strike Beacon payload that allows NOBELIUM to remotely control the targeted system through an encrypted network tunnel.2 The second report detailed four tools that were part of NOBELIUM’s unique infection chain in that campaign: EnvyScout, BoomBox, NativeZone, and VaporRage.3 2. Analysis 2.1. Spearphishing CampaignsMicrosoft reports that NOBELIUM has been conducting a new malicious email campaign since February 2021. It differs significantly from their previous operations that ran from September 2019 to January 2021 and that led to the breach of the SolarWinds Orion platform. In this new campaign, NOBELIUM distributed multiple waves of spearphishing emails, each revealing an evolution of their malware delivery techniques.The first wave of the campaign, discovered in February, leveraged the legitimate Google Firebase platform to stage an ISO file containing a malicious payload, as well as to record attributes of visitors who accessed the URLs included in the phishing emails. This wave included a brief reconnaissance period starting on 28 January, during which NOBELIUM sent the Firebase tracking URL to targets and recorded when they clicked on the URL. They did not deliver the malicious ISO payload at this stage.The next waves of the campaign began in March and used a malicious HTML file attached to a spearphishing email in an attempt to compromise targeted users. This HTML file used JavaScript to write an ISO file containing a malicious payload directly to the target’s disk, including a message that encouraged the target to open the ISO. If the target did so, the ISO file would then be mounted in the same manner as an external drive. This allowed a shortcut file (LNK) within the ISO to execute an included dynamic-link library (DLL) that ultimately resulted in the delivery and execution of a Cobalt Strike Beacon payload. During these waves, NOBELIUM began to experiment with a distribution method that involved embedding the ISO file within the HTML attachment rather than the previous method of hosting the ISO on Firebase.1/10The next waves of the campaign began in April and involved NOBELIUM completely abandoning Firebase for both its ISO distribution and victim tracking. They shifted to distributing the ISOs using the aforementioned HTML embedding method and began to use a new method of victim tracking. The campaign evolved again in May when NOBELIUM added a custom .NET module to perform reconnaissance and download additional payloads that they had stored on Dropbox.On 25 May, NOBELIUM’s campaign began using the legitimate mass-mailing service Constant Contact to target roughly 3,000 unique accounts across more than 150 organizations. This new wave of spearphishing emails used several different types of lures, one of which imitated a special alert from the United States Agency for International Development (USAID), stating that Donald Trump had published new documents regarding election fraud, and included a link where these documents would purportedly be found. In reality, this link used Constant Contact’s legitimate redirector service to send victims to a different URL that would deliver NOBELIUM’s malicious ISO file.On 1 June, the U.S. Department of Justice announced that they had seized two of the domains involved in NOBELIUM’s spearphishing campaign (theyardservice[.]com and worldhomeoutlet[.]com) pursuant to a court order on 28 May.82.2. EnvyScoutEnvyScout is a malicious HTML file that deobfuscates and writes a malicious ISO file to disk. In this campaign, the threat actors delivered the file NV.html as an attachment to the campaign’s spearphishing emails. The body of this HTML file included tracking and credential harvesting URLs, an encoded ISO payload, an embedded JavaScript to decode the payload, and another embedded JavaScript to allow the HTML file to write the decoded ISO file to disk.2.3. BoomBoxBoomBox is a malicious downloader distributed as an executable named BOOM.exe contained within the ISO dropped by EnvyScout. When executed, it checks to ensure that a directory named NV is present in its working directory and terminates if it does not find this directory. BoomBox also performs another check to ensure that the system does not contain a file named %AppData%\Microsoft\NativeCache\NativeCacheSvc.dll and will terminate if it finds the file.After performing these checks, BoomBox proceeds to gather information about the infected system, including its hostname, domain name, IP address, and the victim’s username. It encrypts this information using the Advanced Encryption Standard (AES) with a hardcoded encryption key 123do3y4r378o5t34onf7t3o573tfo73 and initialization vector (IV) value 1233t04p7jn3n4rg. After encryption, BoomBox adds PDF file signatures to the beginning and end of the data so that the encrypted data appears to be a valid PDF file, and then uploads the file to Dropbox.Once BoomBox has uploaded information about the victim’s system, it proceeds to download the NativeZone and VaporRage payloads from Dropbox. It then decrypts and executes these payloads to start the next stage of the attack chain.2.4. NativeZone2/10NativeZone is Microsoft’s name for NOBELIUM’s wide variety of custom Cobalt Strike Beacon loaders. These loaders were previously tracked under unique names including TEARDROP4 and Raindrop, but Microsoft is now tracking them under the single name NativeZone due to their disposable nature and similar purpose within NOBELIUM’s attack chain. All variants of NativeZone are malicious DLLs that decrypt and load a malicious payload from an embedded code buffer or from another accompanying file.2.5. VaporRageVaporRage is a malicious DLL file that acts as a shellcode downloader. It contains functions that are called by NativeZone in order to download, decode, and execute arbitrary shellcode from the attacker’s command and control (C&C) servers. The most common shellcode payload that VaporRage currently delivers is Cobalt Strike Beacon, as observed in NOBELIUM’s previous campaigns.2.6. Cobalt StrikeCobalt Strike is a legitimate penetration testing tool that has become increasingly popular amongst threat actors due to its many powerful features. Its capabilities include keylogging, taking screenshots, deploying additional payloads, exploiting system vulnerabilities to facilitate additional attacks, evading detection with various countermeasures, rapidly exfiltrating data through encrypted tunnels, and more.5 3. Prevention and MitigationThe Cybersecurity and Infrastructure Security Agency (CISA) provides the following list of best practices to strengthen the security of an organization.6 In addition, CISA references the publication from the National Institute of Standards and Technology (NIST), “Guide to Malware Incident Prevention & Handling for Desktops and Laptops” for more information on malware incident prevention and handling.7Maintain up-to-date antivirus signatures and engines. Keep operating system patches up-to-date. Disable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication. Restrict users’ ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required. Enforce a strong password policy and implement regular password changes. Exercise caution when opening email attachments even if the attachment is expected and the sender appears to be known. Enable a personal firewall on agency workstations, configured to deny unsolicited connection requests. Disable unnecessary services on agency workstations and servers. Scan for and remove suspicious email attachments; ensure the scanned attachment is its “true file type” (i.e., the extension matches the file header). Monitor users’ web browsing habits; restrict access to sites with unfavorable content. Exercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.). Scan all software downloaded from the Internet prior to executing. Maintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).3/104. Indicators of CompromiseIndicator 74d6b7b2[.]app[.]giftbox4u[.]comDescription SHA256saimsecurity[.]netcityloss[.]comcontent[.]pcmsar[.]netcross-checking[.]comgiftbox4u[.]comhanproud[.]comnewstepsco[.]comstockmarketon[.]comstsnews[.]comtacomanewspaper[.]comtrendignews[.]com 139[.]99[.]167[.]177 desktop[.]dlldiassvcs[.]dlldxgim[.]dllGraphicalComponent[.]dllimgmountingservice[.]dllinformation[.]exeJava_SRE_runtime_update[.]dllmsch[.]dllmsdiskmountservice[.]dllmshost[.]dllmstu[.]dllCobalt Strike C&C domainsCobalt Strike C&C IP Cobalt Strike DLL filenames4/10WRAR600[.]EXE Attachment[.]htmlattachment[.]htmlcert[.]htmlinformation[.]htmlInvitation[.]htmlNV[.]htmlnv[.]htmlCobalt Strike DLL SHA256sCobalt Strike EnvyScout C&C filenamesReply slip[.]html cdn[.]theyardservice[.]comdailydews[.]comdataplane[.]theyardservice[.]comdoggroomingnews[.]comemail[.]theyardservice[.]comemergencystreet[.]comsmtp2[.]theyardservice[.]comstatic[.]theyardservice[.]comtheyardservice[.]comusaid[.]theyardservice[.]comworldhomeoutlet[.]com documents[.]dllKM[.]FileSystem[.]dllNativeCacheSvc[.]dllRtlSvcMicro[.]dllWbtr[.]dll financialmarket[.]orgNativeZone C&C NOBELIUM C&C6/10pcmsar[.]nettechiefly[.]comtheadminforum[.]com 185[.]158[.]250[.]239195[.]206[.]181[.]16937[.]120[.]247[.]13545[.]135[.]167[.]2751[.]254[.]241[.]15851[.]38[.]85[.]225 ica-declass[.]pdfMeeting info[.]docxnv[.]pdfstate ellection changes[.]docx cdnappservice[.]firebaseio[.]comeventbrite-com-default-rtdb[.]firebaseio[.]comhumanitarian-forum-default-rtdb[.]firebaseio[.]comsecurity-updater-default-rtdb[.]firebaseio[.]comsupportcdn-default-rtdb[.]firebaseio[.]com AktualizC!ciu[.]imgAttachment[.]imgattachment[.]imgattachment[.]isodppy_empty[.]isoica-declass[.]imgICA-declass[.]isoinformation[.]isoInvitation Document[.]isodomainsNOBELIUM C&C filenames7/10nv[.]imgNV[.]imgReply slip[.]isoSMM_Report[.]imgtopics_of_discussion[.]iso AKTUALIZ[.]LNKAttachment[.]lnkattachment[.]lnkinformation[.]txt[.]lnkIntegrated Review[.]lnkNV[.]lnknv[.]lnkPlending forms[.]lnkProgramme outline[.]lnkreply slip[.]lnkReply slip[.]rtf[.]lnkNOBELIUM ISO SHA256sNOBELIUM LNK filenames8/10reports[.]lnkScanClientUpdate[.]lnk CertPKIProvider[.]dllmswsc[.]dll VaporRage C&C SHA256Endnotes1. url url url url 5. url 6. url 7. url 8. url 