symantec-enterprise-blogs.security.com /blogs/threat-intelligence/espionage-asia-governments New Wave of Espionage Activity Targets Asian GovernmentsA distinct group of espionage attackers who were formerly associated with the ShadowPad remote access Trojan (RAT) has adopted a new, diverse toolset to mount an ongoing campaign against a range of government and state-owned organizations in a number of Asian countries. The attacks, which have been underway since at least early 2021, appear to have intelligence gathering as their main goal. TargetsThe current campaign appears to be almost exclusively focused on government or public entities, including:Head of government/Prime Minister’s Office Government institutions linked to finance Government-owned aerospace and defense companies State-owned telecoms companies State-owned IT organizations State-owned media companiesToolsA notable feature of these attacks is that the attackers leverage a wide range of legitimate software packages in order to load their malware payloads using a technique known as DLL side-loading. Usually, the attackers used multiple software packages in a single attack. In many cases, old and outdated1/9versions of software are used, including security software, graphics software, and web browsers. In some cases, legitimate system files from the legacy operating system Windows XP are used. The reason for using outdated versions is that most current versions of the software used would have mitigation against side-loading built-in.DLL side-loading is a well-known technique that involves attackers placing a malicious DLL in a directory where a legitimate DLL is expected to be found. The attacker then runs the legitimate application themselves (having installed it themselves in most cases). The legitimate application then loads and executes the payload.Once a malicious DLL is loaded by the attackers, malicious code is executed, which in turn loads a .dat file. This file contains arbitrary shellcode that is used to execute a variety of payloads and associated commands in memory. In some cases, the arbitrary shellcode is encrypted.The attackers also leverage these legitimate software packages to deploy additional tools, which are used to further aid in lateral movement. These tools include credential dumping tools, a number of network scanning tools (NBTScan, TCPing, FastReverseProxy, and FScan), and the Ladon penetration testing framework.Attacks usually unfold in the following manner:Once backdoor access is gained, the attackers use Mimikatz and ProcDump to steal credentials. In some cases, the attackers dump credentials via the registry. They then use network scanning tools to identify other computers of interest, such as those running RDP, which could facilitate lateral movement. They leverage PsExec to run old versions of legitimate software, which are then used to load additional malware tools such as off-the-shelf RATS via DLL side-loading on other computers on the networks. The attackers also use a number of living-off-the-land tools such as Ntdsutil to mount snapshots of Active Directory servers in order to gain access to Active Directory databases and log files. The Dnscmd command line tool is also used to enumerate network zone information.Case Study: An unfolding attackIn April 2022, the attackers targeted a government-owned organization in the education sector in Asia and managed to stay on its network until July. During the period of the compromise, the attackers accessed computers hosting databases and emails and eventually made their way to the domain controller.The first sign of malicious activity occurred on April 23, when a malicious command was executed via file imjputyc.exe is a legitimate Windows XP file that was used by the attackers to side-load a malicious DLL file (imjputyc.dll), which in turn was used to load a .dat file (payload - imjputyc.dat). Following this activity, imjputyc.exe was used to launch a network service via svchost.exe, likely created by the malicious payload.CSIDL_SYSTEMX86\svchost.exe NetworkService 79322/9Additionally, around the same time, the attackers leveraged Imjpuex.exe to install and execute an eleven- year-old version of Bitdefender Crash Handler (file name: javac.exe, SHA256: was used for side-loading in this attack, it is just one of many old versions of applications that have been used by this group in recent months.The same Crash Handler executable was copied to CSIDL_SYSTEM_DRIVE\xampp\tmp\vmware.exe and executed.The attackers then installed and executed ProcDump in order to dump credentials from the Local Security Authority Server Service (LSASS):p.exe -accepteula -ma lsass.exe lsass2.dmpThe attackers then launched several command prompts while reloading Crash Handler. This was likely done in order to install additional tools.Shortly afterwards, a file called calc.exe (SHA256: and was executed by the attackers. This was a renamed version of Mimikatz that the attackers then used to dump credentials:calc.exe ""privilege::debug"" ""sekurlsa::logonpasswords full" " exit "On April 26, further malicious activity occurred when the attackers ran the Crash Handler executable and installed a file called cal.exe (SHA256: machine.This file was LadonGo v3.8, a publicly available penetration testing framework that is written in Go. The attackers appear to have used LadonGo to scan the internal network for machines with RDP services running and attempted to exploit or log in to those machines using the credentials they stole several days earlier. There was also some evidence of brute-force login attempts against machines of interest.On May 6, the attackers resumed their attack and ran the Crash Handler executable (this time named svchost.exe) and installed a new variant of Mimikatz named test.exe (SHA256: order to obtain more credentials. The attackers then ran LadonGo and attempted to exploit a Netlogon vulnerability (CVE-2020-1472) against two other computers in the organization in order to elevate privileges.On May 16, the attackers increased their level of activity and began moving laterally across the organization’s network from the initially compromised computer (Computer #1).On a second computer (Computer #2), the attackers launched a command prompt and executed a variant of Mimikatz (file name: test.exe, SHA256: legitimate copies of the Windows command prompt (with 16 bytes of the rich header modified).On a third computer (Computer #3) the attackers used PsExec to execute the same older version of Crash Handler used on Computer #1, this time named javac.exe. A copy of this executable was then made to csidl_program_files\windows mail\winmailservice.exe and was executed.The attackers then ran dnscmd.exe (SHA256: enumerate DNS configuration information on the compromised computer:Dnscmd . /EnumZonesDnscmd is a Microsoft command-line tool for managing DNS servers. It can be used to script batch files to help automate routine DNS management tasks or to perform routine setup of new DNS servers. The enumzones command is used to list the zones that exist on the specified DNS server. If no filters are specified, a complete list of zones is returned.Crash Handler was then used to install imjpuex.exe in the csidl_common_appdata\veritas directory which in turn was used to side-load a DLL file of the same name and load a .dat file to execute an unknown custom payload.Shortly after this, the attackers attempted to list the records of multiple specific zones by specifying the domain on the command line:Dnscmd . /ZonePrint [REDACTED_DOMAIN]On a fourth computer (Computer #4), the attackers used PsExec to execute Crash Handler (this time Computer #4. They also deployed the side-loading technique on Computer #5 to execute the legitimate svchost.exe application, possibly to facilitate some process injection.On May 19, the attackers returned to Computer #5 and used svchost to launch NetworkService. The attackers then used a variant of Mimikatz named calc.exe, which was previously used earlier in the attack used to dump credentials from the compromised host.On May 24, the attackers turned their attention to Computer #3, using PsExec to execute the whoami command and determine the currently logged-in user. They then ran an unknown batch file name t.bat via PsExec.4/9It is likely the following commands were executed from this script in order to create a new user account:net user [REDACTED] CSIDL_SYSTEM\net1 user [REDACTED] Asd123.aaaa /add net localgroup [REDACTED] [REDACTED]/add CSIDL_SYSTEM\net1 localgroup [REDACTED] /add CSIDL_SYSTEM\net1 user [REDACTED] Asd123.aaaa /addThe script uses net.exe to check if a specific user account already exists. It then attempts to create a user account with the password Asd123.aaaa and add it to the local group on the machine. Several minutes later, the task manager was launched followed by a command prompt. The attackers then ran the following command to mount a snapshot of the active directory server.ntdsutil snapshot "mount c2b3e2c6-1ffb-4625-ba8e-3503c27a9fcb" quit quitThese snapshots contain sensitive information such as the active directory database (i.e. user credentials) and log files. The string c2b3e2c6-1ffb-4625-ba8e-3503c27a9fcb is the index number of the snapshot.The attackers then moved to Computer #5, where they used ProcDump (file name: p.exe, SHA256: LSASS:p.exe -accepteula -ma lsass.exe lsass2.dmpOn May 26, the attackers returned to Computer #1 and executed a file called go64.exe. This file was a copy of Fscan. The attackers ran the following command to mass scan for any machines within the other machines on the network, including leveraging one of the ProxyLogon vulnerabilities (CVE-2021- 26855) against an Exchange Server. Suspicious SMB activity also occurred around this time, suggesting the attackers may have also leveraged other exploits (likely EternalBlue) against any open SMB services.On June 6, the attackers ran PsExec on Computer #3 to launch the previously used old version of Crash Handler (file name: winnet.exe) from the %USERPROFILE%\public\ directory.They ran the Dnscmd utility again to enumerate all available zones, before executing winnet.exe again and a copy of Crash Handler located at APPDATA%\t.exe to load additional malicious payloads (likely used to install ProcExplorer):Dnscmd . /EnumZones "CSIDL_COMMON_APPDATA\t.exe"Several hours later, ProcExplorer (64-bit) was launched:5/9"CSIDL_PROFILE\desktop\processexplorer\procexp64.exe"The last known malicious activity occurred on July 8 on Computer #3. The system hive file was dumped from the registry in order to dump user credentials.reg save HKLM\SYSTEM system.hivPayloadsWhile this group of attackers was previously using ShadowPad, it has since moved on and has been deploying a range of payloads.One of the payloads used was a previously unseen, feature-rich information stealer (Infostealer.Logdatter), which appeared to be custom built. Its capabilities included:Keylogging Taking screenshots Connecting to and querying SQL databases Code injection: Reading a file and injecting the contained code into a process Downloading files Stealing clipboard dataOther payloads used by the attackers included:PlugX/Korplug Trojan Ladon penetration testing framework Nirsoft Remote Desktop PassView: A publicly available tool that reveals the password stored by the Microsoft Remote Desktop Connection utility inside .rdp files A Simple Network Management Protocol (SNMP) scanning tool Fscan: A publicly available intranet scanning tool Nbtscan: A command-line tool that scans for open NETBIOS name servers FileZilla: A legitimate FTP client FastReverseProxy: A reverse proxy tool WebPass: A publicly available password collection tool TCPing: A publicly available tool that enables pings over TCP Various process dumpers Various keyloggers A number of PowerSploit scripts Links to earlier activityShadowPad is a modular RAT that was designed as a successor to the Korplug/PlugX Trojan and was, for a period of time, sold on underground forums. However, despite its origins as a publicly available tool, it has since been closely linked to espionage actors. The tool was only sold publicly for a very short period of time and it is believed that it was only sold to a handful of buyers.6/9There is limited evidence to suggest links to past attacks involving the Korplug/PlugX malware and to attacks by a number of known groups, including Blackfly/Grayfly (APT41) and Mustang Panda. For example, the attackers leveraged a legitimate file called HPCustParticUI.exe, which was developed by HP for digital imaging applications. This previously occurred in attacks involving Korplug/Plug X. Furthermore, the attackers used a file called hpcustpartui.dll as a likely loader. The same loader was used in a long-running campaign involving Korplug/Plug X targeting the Roman Catholic Church.The current campaign uses a legitimate Bitdefender file to side-load shellcode. This same file and technique were observed in previous attacks linked to APT41. We have also observed the same keylogging tool deployed in previous attacks against critical infrastructure in South East Asia.The use of legitimate applications to facilitate DLL side-loading appears to be a growing trend among espionage actors operating in the region. Although a well-known technique, it must be yielding some success for attackers given its current popularity. Organizations are encouraged to thoroughly audit software running on their networks and monitor for the presence of outliers, such as old, outdated software or packages that are not officially used by the organization. Protection/MitigationFor the latest protection updates, please visit the Symantec Protection Bulletin. Indicators of CompromiseIf an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that 