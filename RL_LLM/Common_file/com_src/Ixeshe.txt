Trend Micro Incorporated An APT CampaignBy: David Sancho, Jessa dela Torre, Matsukawa Bakuei, Nart Villeneuve, and Robert McArdleCONTENTSIntroduction 1 Victims and Targets 1 Context 1 Attack Vectors 2 Operations 2 Technical Analysis 2 Initial Delivery Method 2 Malware Local System Effects 2 C&C Communications 3 Related AES Campaign 4 C&C Infrastructure 5 Real C&C Location 6Attribution and Unique Fingerprints 7 Unique Fingerprints and Modus Operandi 7 Relationships Between Attack Components 8 Defending Against APTs 15 Local and External Threat Intelligence 15 Mitigation and Cleanup Strategy 16 Educating Employees Against Social Engineering 16 Data-Centric Protection Strategy 16Trend Micro Threat Protection Against IXESHE Campaign Components 17PAGE ii | iXESHEINTRODUCTIONThe number of targeted attacks is undoubtedly on the rise. These highly targeted attacks focus on individual organizations in an effort to extract valuable information. In many ways, this is a return to the “old hacking days” before more widespread attacks targeting millions of users and the rise of computer worms came about. Sometimes, these targeted attacks are allegedly linked to state-sponsored activities but may also be carried out by individual groups with their own goals.Trend Micro continues to track and analyze highly targeted attacks, also known as “advanced persistent threats (APTs).” We have, in fact, published two research papers on the Luckycat1 and Lurid2 campaigns. This research paper will delve into another prominent group of attackers referred to as “IXESHE” (pronounced “i-sushi”), based on one of the more common detection names security companies use for the malware they utilize. This campaign is notable for targeting East Asian governments, electronics manufacturers, and a telecommunications company.The IXESHE campaign makes use of targeted emails with malicious attachments to compromise victims’ systems. The emails are often tailored for specific victims and contain malicious attachments that are almost always “weaponized” .PDF files with known exploits that drop malware executables onto targeted systems. In addition, the IXESHE attackers conducted two specific attacks that leveraged zero-day exploits—one in 2009 and another in 2011.1 url url IXESHE attackers almost always make use of compromised servers as command-and-control (C&C) servers. In some cases, the compromised servers are hosted on target organizations’ networks after successful infiltration so the attackers can increase their control of the victims’ infrastructure. Using this approach, the attackers amassed at least 60 C&C servers over time. This technique also allows the attackers to cover their tracks, as having the C&C server in the victims’ corporate networks means very little C&C traffic leaves them. The attackers’ deliberate use of compromised machines and dynamic Domain Name System (DNS) services allows them to hide traces of their presence by confusing their activities with data belonging to legitimate individuals.Looking at threat intelligence derived from tracking APT campaigns over time primarily based on the network traffic generated by the malware used, we were able to develop indicators of compromise for the IXESHE campaign. The malware samples used in this campaign were not very complicated by nature but do give the attackers almost complete control over their targets’ compromised systems.Victims and targetsMost of the IP addresses of IXESHE’s victims are linked to DSL networks, which made it difficult to determine their identities. Careful research, however, allowed the identification of some of the attackers’ victims:• East Asian governments • Taiwanese electronics manufacturers • A telecommunications companyCampaign victims were identified by using Whois records and open source research. Trend Micro generally notifies customers that are believed to have been specifically targeted by APT campaigns.contextThe IXESHE attackers have been actively launching highly targeted attacks since at least July 2009.PAGE 1 | iXESHETECHNICAL ANALYSISattack Vectorsinitial deliVery methodAvailable data on the IXESHE campaign indicates that targeted emails with malicious .PDF file attachments were the attackers’ vector of choice. In most cases, the attacks involved Adobe Acrobat, Reader, and Flash Player exploits such as:• CVE-2009-43243 • CVE-2009-09274 • CVE-2011-06095 • CVE-2011-06116It should also be noted that this campaign used CVE-2009- 43247 and CVE-2011-06098 exploits when these were still unpatched or considered zero-day vulnerabilities.The IXESHE attackers also used an exploit that affected Microsoft Excel—CVE-2009-3129.9operationsThe IXESHE malware binary allowed the attackers to easily take over and maintain complete control of victims’ systems to do the following:• List all services, processes, and drives • Terminate processes and services • Download and upload files • Start processes and services • Get victims’ user names • Get a machine’s name and domain name • Download and execute arbitrary files • Cause a system to pause or sleep for a specifiednumber of minutes• Spawn a remote shell • List all current files and directories3 url 4 url 5 url 6 url 7 url url url 2 | iXESHEEvery IXESHE case we examined revealed that the original infection vector was a targeted email with a PDF exploit as attachment. Older versions also used an XLS exploit.Opening the .PDF file drops and executes a malware in a victim’s system. The malware displays a blank .PDF file or a decoy document related to the targeted attack. The emails normally come from compromised personal accounts or are entirely spoofed. Emails from spoofed senders were usually sent via mail servers in the United States and China.malware local system effectsOnce dropped onto target systems by means of a document exploit attached to a tailored email, the malware drops an executable file into one of the following folders:• %APPDATA%\Locations\ • %APPDATA%\Adobe • %TEMP%The malware also sets the executable file’s attributes to “Hidden.” Some of the file names the attackers used include:• winhlps.exe • Updater.exeIn order for the malware to survive rebooting, it normally creates the following registry run key:HKEY_CURRENT_USER\Software\Microsoft\Windows\ CurrentVersion\Run The registry run key, in turn, points to the malware that has been dropped. The value name of this entry varies from sample to sample. Some of the names the attackers used for it include:• Adobe Assistant • MigratedSome samples, however, do not use a registry run key as load point. Some of the more recent samples we observed create a shortcut (i.e., .LNK file) in the Startup folder with names such as adobe reader speed launch.lnk.The malware also checks a system’s proxy settings for later use in C&C communications:HKEY_CURRENT_USER\Software\Microsoft\Windows\ CurrentVersion\Internet SettingsProxyEnable ProxyServerc&c communicationsUpon installation, the malware starts communicating with one of its C&C servers. Most of the samples appeared to have at least three C&C servers hard coded for redundancy. The C&C communications are easy to identify, as these tended to be coded in the following predetermined format:url Server]/[ACD] [EW]S[Some Numbers]. jsp?[Encrypted Base64 Blob] Some samples alternatively use an FGKD.jsp or an FPK.jsp file.The Base64 blob is of particular interest. It makes use of a custom Base64 alphabet. Once decoded, this blob reveals a standardized structure of the information sent to the registered C&C server, which includes the following details:• Computer name • Local IP address • Proxy server IP and port • Malware IDTo date, we have seen several custom Base64 alphabets, including:• +NO5RZaGHviIjhYq8b4ndQ=p012ySTcCDrs/xPgUz67FM3wemKfkJLBo9VtWXlEuA• HZa4vjIiGndQ=p012y+NO5RST/xPgUz67FMhYq8b3we•mKfkJLBocCDrs9VtWXlEu j4vpGZaHnIdQ=i012y+N/zPgUO5RSTx67FMhYb8q3we mKckJLBofCDrs9VtWXlEu• p12kJLBofCDrs9VtWXlEuainyj4vd+=H0GZIQNO5RST/zPgUx67FMhYb8q3wemKc• aZHGviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu• ZvQIajHi4ndG=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu• ZaGHviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu• 4HIvZGjaiQdn=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu• pGIaHnZj0vdQ=i421y+NO5RSY/zMgUx67KPhTb8q3wemFckBLJufWErs9VtCXlDo• QpaZIivj4ndG=H021y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu• pGZaHnIj4vdQ=i012y+NO5RST/zPgUx67FMhYb8q3wemKckJLBofCDrs9VtWXlEuSome similarities exist across different versions of the Base64 alphabet, which indicates that these are most likely not completely randomly generated. Instead, the attackers manually cut and pasted older versions after altering some parts.The malware ID seems to be a campaign code with a different IP address for each attack. Some of the campaign codes we have seen include:• 19 • ZWJP_KS_1222It appears that the numbers in the given campaign codes refer to dates when the campaigns were launched in “MMDD” format. The letters are possibly related to the target industry or company.PAGE 3 | iXESHEIf the malware does not get a response from the C&C server, it will choose another random number after the AWS part of the URL and try again.Once connected, the malware specifically waits for the remote server to issue the following commands, which may vary from one version to another:• del	[parameter]: Allows a remote user to delete files.• disk	[parameter]: Lists all available drives.• dos	[parameter]: Allows a remote user to executecommands via cmd.exe.• get	[parameter]: Allows a remote user to download afile from the remote server onto a local machine.• list	[parameter]: Lists files on the victim’s machine.related aes campaignWe have also been tracking another campaign, which we refer to as the “AES campaign,” which appears to be related to IXESHE. The main body of the malware related to the IXESHE campaign can be identified by its connection to a C&C server using a file such as AWS12345.jsp and a custom Base64 blob; the malware associated with the AES campaign operates very similarly. The samples used in the AES campaign slightly differed in terms of C&C communication but had significant similarities with IXESHE malware, which used the format:url Server]/[ACD] ES[Some Numbers].jsp Even though the network traffic format of the AES campaign was slightly similar, instead of the more familiar AWS[random].jsp format, it used several other formats for certain commands or events such as:• ls	[parameter]: Allows a remote user to display thecontents of a directory.• AES: Initial beacon.• kill	[parameter]: Allows a remote user to terminateprocesses.• put	[parameter]: Allows a remote user to upload a filefrom a local machine to a remote server.• rsh	[parameter]: Similar to the sh or dos [parameter] except for the fact that this is an already-existing file or shell.• run	[parameter]: Allows a remote user to executeprograms.• sh	[parameter]: Allows a remote user to executecommands via cmd.exe.• sleep	[parameter]: Causes a system to sleep for acertain amount of time.• DES: Send the path of %systemdir%.• PES: Send the result of the “put” command.• SEU: Send the “error” or “invalid” command.• SUS: Send the system name, which is not encoded,upon receiving the “exit” command.• ZES: Send the result of the “dos” command.Another difference in the traffic is that AWS uses the POST method with the format, “url Server]/FPK [Some Numbers].jsp?[Base64 Blob],” when the “get” command is invoked. The Base64 blob contains the file specified in the “get” command.Analysis of the binaries also revealed similarities between the AES and AWS samples. These included the encoding algorithm and commands used. Even though some commands varied, the format and parameters used essentially remained the same.PAGE 4 | iXESHEC&C INFRASTRUCTUREThe majority of the IXESHE campaign’s C&C servers were based in Taiwan and the United States.Figure 1. Breakdown of C&C servers by countryPAGE 5 | iXESHEThis is, however, not an indicator of attribution. It is not possible to determine where the attackers are based solely on where their C&C infrastructures are located. In addition, not all of the C&C servers are currently active. Many, if not all of them, appear to be compromised machines. In fact, at least 11 of the C&C servers were hosted on the compromised machines of an East Asian government, which made these very useful for launching targeted attacks against it.Most of the malware samples directly accessed an IP address as a C&C server. Connections to domains did exist in some cases. The domains were usually registered using free dynamic DNS service providers or compromised websites.Overall, this strategy was part of the attackers’ modus operandi. By choosing compromised machines to act as C&C servers, fewer clues were left for investigators to follow in an attempt to find out who is behind the attacks compared with those using bulletproof hosting services and registered domain names. To conduct research on these servers, investigators need to differentiate between information related to malicious and legitimate use.This indicated that the front-end servers actually functioned as proxy servers and that the true C&C servers were hidden behind this initial group of C&C servers. This made the network more resistant to takedown and analysis. Due to a server error, however, the attackers revealed the location of one of their back-end servers. We discovered that the IP address, xx.xx.x2.202, is located in Guangdong, China.The particular error returned looked very similar to errors generated by a tool called “HTran.”10 HTran stands for “HUC Packet Transmit Tool,” a connection bouncer that redirects TCP traffic destined for one host to an alternate host, keeping the real host hidden from view. “HUC,” in this case, stands for the hacking group, “Honker Union of China.” It was coded by a hacker who goes by the handle “lion.” This tool’s error-checking code, however, is flawed. Assuming that everything properly works, the tool functions very well as a proxy server but if the real server is currently inaccessible, HTran will send an error message, revealing its whereabouts.Running a port scan on this server revealed some open ports shown in the table below.real c&c locationOne very interesting error revealed more insights into the C&C network’s setup. One of the malware samples we tested was designed to access xxx.xxawan.com via port 443, which, at that time, resolved to xx.xxx.114.87:443, a server located in the United States. The sample, however, received the following error message from the server:[SERVER]connection to xx.xx.x2.202:56413 errorPortStateService80/tcp HTTP AlternativeBased on OS fingerprinting, the server appears to be running Windows 7 Enterprise Server. With only a few open ports, however, it was very difficult to confirm this. In addition, we did not receive a response when we tried to connect to these ports.PAGE 6 | iXESHE10 url AND UNIQUE FINGERPRINTSPrevious research on the IXESHE campaign indicated several connections to groups possibly from China. In addition, the IP address hiding behind the HTran instance was an IP range assigned to China.Upon further investigation of the “manufact” campaign, however, it appears that the gang behind it may be English speakers. The name of the campaign, for one, is most likely a shortened form of “manufacturing.” The OS the C&C server uses is also an English install of Microsoft XP. It is also likely, of course, that the C&C server is a compromised machine so it does not use the attackers’ first language.The malware samples, which appear to have been developed using C++, had a number of strings and error codes in English such as “Enter command” and “Receive command error!”The date format used in the campaign codes (i.e., MMDD) also provided us a clue as to where the attackers may be from. This date format is only commonly used in China, Korea, Iran, Japan, Hungary, Lithuania, and the United States.Based on the limited amount of information we gathered about the attackers, it was very difficult to pinpoint their exact location.unique fingerprints and modus operandiAn attack can be considered associated with the gang behind the IXESHE campaign if it exhibits the following characteristics:• Uses a specially crafted targeted email with amalicious file attachment• Uses document exploits, primarily .PDF files, to dropmalware into target systems• Uses malware detected by security vendors as IXESHEvariants• Uses a malware that sends a GET request to the C&Cserver in the following format:url Server]/[ACD] [EW]S[Some Numbers].jsp?[Encrypted Base64 Blob]• Uses dynamic DNS services for or compromisedmachines as C&C serversPAGE 7 | iXESHERELATIONSHIPS BETWEEN ATTACK COMPONENTSFigure 2. IXESHE targeted campaign #1Figure 3. IXESHE targeted campaign #2PAGE 8 | iXESHEFigure 4. IXESHE targeted campaign #3PAGE 9 | iXESHEPAGE 10 | iXESHEFigure 5. IXESHE targeted campaign #4i5 PTIMELINEThis section lists known incidents exhibiting the same threat actor behaviors and so may be from the same group behind IXESHE dating to as far back as July 2009. With the exception of the samples described in ContagioDump, the dates for other samples refer to when the respective sandboxes saw them for the first time. As such, these dates should be considered “at least by” and not the actual date of the attack.• 15 October 2009• PDF name/Subject hook: 中共二炮部隊導彈之發展 • C&C: xxxxxupsenter.byinter.net •Info: url • C&C: xxx.xx9.124.13 • C&C: xxxxx.compreautos.com.br • C&C: xxxxxfo.athersite.com •Info: url dec-18-adobe-0-day-cve-2009-4324-pdf.html• Campaign code: ML_20091216• 28 December 2009• PDF name/Subject hook: Consumer Welfare Table • C&C: xxx.xx6.148.42 or xxx.xx6.202.49 •Info: url dec-29-cve-2009-4324-adobe-0-day.html• Campaign code: ML_20091223• 26 April 2010• PDF	name/Subject	hook: [研討會]開南大學公共事 務管理學系第五屆「全球化與行政治理」國際學術 • C&C: xxx.x.x5.26 • C&C: xxx.xx.187.130 • C&C: xxx.xx.128.71 • C&C: xxx.xx.128.71 • C&C: xxx.xx6.54.189 • Info: url • C&C: xxxxxck.dnsrd.com or xxx.xx6.34.94 (appearsto be a compromised computer of an East Asian university)• Info: url• Campaign	code: [0802]• 17 August 2010• PDF	name/Subject	hook: [Unknown] • C&C: xxxxxck.dnsrd.com or xxx.xx6.34.94 (appearsto be a compromised computer of an East Asian • C&C: xx.xx.x3.102 • C&C: xx.xx.x0.244 • C&C: xx.xx.x9.165 • C&C: xx.xx.x9.165 • C&C: xx.xx.x9.165 • Info: url• Campaign	code: [Removed due to privacyconcerns]• 22 February 2011• 22 April 2011• PDF	name/Subject	hook: [Unknown] • C&C: xxx.xx.228.58 • C&C: xx.xx.x9.165 • Info: url • C&C: xx.xxx.114.44 • C&C: xxx.xxawan.com or xxx.xx4.230.120 • Info: url• Campaign	code: 19• 3 November 2011• PDF	name/Subject	hook: [Unknown] • MD5: E25DBA0556124D7874D8416DE291CFE2 • C&C: xxxxxfo.sdti.tw or xxx.xx2.246.110 • C&C: xxxxxaga.chickenkiller.com • C&C: xxx.xx6.54.150 or xxxxx.ItemDB.com • C&C: xx.xx.x33.2 • C&C: xxxxxain.qpoe.com • C&C: xxxxxfo.AtHerSite.com • C&C: xxx.xx0.139.67 • C&C: xxx.xx0.63.1 • C&C: xx.xxx.21.41 or king.pirat3.com targeted attacks since 2009. The attackers primarily use malicious .PDF files that exploit vulnerabilities in Adobe Reader, Acrobat, and Flash Player, including the use of two zero-day exploits—one in 2009 and another in 2011. While the attackers primarily targeted East Asian governments in the past, they have also started targeting a telecommunications company and electronics manufacturers. They kept track of their targeted attacks by embedding a “campaign tag” in the malware that appears to describe when each attack was launched and, in some cases, the nature of its target. We found more than 40 of these campaign tags.The IXESHE attackers are notable for their use of compromised machines within a target’s internal network as C&C servers. This helped disguise their activities. In addition, the attackers’ use of the proxy tool, HTran, also helped mask their true location. While their identities remain unknown, the attackers behind the IXESHE campaign demonstrated that they were both determined and capable. While the malware used in the attacks were not very complicated by nature, these proved very effective. This campaign remains an active threat.Sufficiently motivated threat actors can penetrate even networks that use moderately advanced security measures. As such, apart from standard and relevant attack prevention measures and mechanisms such as solid patch management; endpoint and network security; firewall use; and the like, enterprises should also focus on detecting and mitigating attacks. Moreover, data loss prevention (DLP) strategies that identify the data an organization is protecting and take into account the context of data use should be employed.local and external threat intelligenceThreat intelligence refers to indicators that can be used to identify the tools, tactics, and procedures threat actors engaging in targeted attacks utilize. Both external and local threat intelligence is crucial for developing the ability to detect attacks early. The following are the core components of this defense strategy:• Enhanced	visibility: Logs from endpoint, server,and network monitoring are an important and often underused resource that can be aggregated to provide a view of the activities within an organization that can be processed for anomalous behaviors that can indicate a targeted attack.• Integrity	checks: In order to maintain persistence,malware will make modifications to the file system and registry. Monitoring such changes can indicate the presence of malware.• Empowering	the	human	analyst: Humans are best positioned to identify anomalous behaviors when presented with a view of aggregated logs from across a network. This information is used in conjunction with custom alerts based on the local and external threat intelligence available.Technologies available today such as Deep Discovery provide visibility, insight, and control over networks to defend against targeted threats.11 Deep Discovery uniquely detects and identifies evasive threats in real time and provides in-depth analysis and actionable intelligence to prevent, discover, and reduce risks.11 url 15 | iXESHEmitigation and cleanup strategydata-centric protection strategyThe ultimate objective of targeted attacks is to acquire sensitive data. As such, DLP strategies that focus on identifying and protecting confidential information are critical. Enhanced data protection and visibility across an enterprise provides the ability to control access to sensitive data as well as monitor and log successful and unsuccessful attempts to access it. Enhanced access control and logging capabilities allow security analysts to locate and investigate anomalies, respond to incidents, and initiate remediation strategies and damage assessment.Once an attack is identified, the cleanup strategy should focus on the following objectives:• Determine the attack vector and cut offcommunications with the C&C server.• Determine the scope of the compromise.• Assess the damage by analyzing the data and forensicartifacts available on compromised machines.Remediation should be applied soon afterward, which includes steps to fortify affected servers, machines, or devices into secure states, informed in part by how the compromised machines were infiltrated.educating employees against social engineeringSecurity-related policies and procedures combined with education and training programs are essential components of defense. Traditional training methods can be fortified by simulations and exercises using real spear-phishing attempts sent to test employees. Employees trained to expect targeted attacks are better positioned to report potential threats and constitute an important source of threat intelligence.PAGE 16 | iXESHETREND MICRO THREAT PROTECTION AGAINST IXESHE CAMPAIGN COMPONENTSThe following table summarizes the Trend Micro solutions for the components of the IXESHE campaign. Trend Micro recommends a comprehensive security risk management strategy that goes further than advanced protection to meet the real-time threat management requirements of dealing with targeted attacks.Attack ComponentProtection TechnologyTrend Micro SolutionPredetermined C&C communication format: url Server]/ [ACD] [EW]S[Some Numbers]. jsp?[Encrypted Base64 Blob]Web ReputationTROJ_PIDIEF, BKDR_PROXY, TROJ_ DROPR, and TROJ_DEMTRANC variantsFile Reputation (Antivirus/Anti-malware)CVE-2009-4324 CVE-2009-0927 CVE-2011-0609 CVE-2011-0611 CVE-2009-3129Vulnerability Shielding/Virtual PatchingEndpoint (Titanium, Worry-Free Business Security, OfficeScan) Server (Deep Security) Messaging (InterScan Messaging Security, ScanMail Suite for Microsoft Exchange) Network (Deep Discovery) Gateway (InterScan Web Security, InterScan Messaging Security) Mobile (Mobile Security) Endpoint (Titanium, Worry-Free Business Security, OfficeScan) Server (Deep Security) Messaging (InterScan Messaging Security, ScanMail Suite for Microsoft Exchange) Network (Deep Discovery) Gateway (InterScan Web Security, InterScan Messaging Security) Mobile (Mobile Security) Server (Deep Security) Endpoint (OfficeScan with Intrusion Defense Firewall Plug-In)For CVE-2009-4324:• Rule #1004008 (Adobe Reader andAcrobat ‘newplayer()’ JavaScript Method Code Execution)For CVE-2009-0927:• Rule # 1003405 (Adobe AcrobatJavaScript getIcon Method Buffer Overflow)For CVE-2011-0609:• Rule #1004615 (Adobe Flash PlayerXLS Remote Code Execution)For CVE-2011-0611:• Rule # 1004647 (Restrict MicrosoftOffice File with Embedded SWF)For CVE-2009-3129:• Rule #1003817 (Excel FeatheaderRecord Memory Corruption Vulnerability)PAGE 17 | iXESHEAttack ComponentProtection TechnologyTrend Micro SolutionWeb, Domain, and IP ReputationEndpoint (Titanium, Worry-Free Business Security, OfficeScan) Server (Deep Security) Messaging (InterScan Messaging Security, ScanMail Suite for Microsoft Exchange) Network (Deep Discovery) Gateway (InterScan Web Security, InterScan Messaging Security) Mobile (Mobile Security)xxx.x.x87.206 xxx.xx2.36.5 xxx.xx6.129.228 xxx.xx0.139.67 xxx.xx.39.184 xx.xxx.12.18 xxx.xxrver.us xxx.xxt-alice.de xxxxxbaby.mooo.com xxxxxlic.yahoobigdeals.com xx.xx.x1.252 xxx.xx.228.58 xxx.xx.183.86 xxx.xx.128.71 xxx.xx.13.148 xxx.xx5.243.44 xxx.xx2.216.5 xxx.xx.151.190 xxx.xx.63.113 xxx.xx.58.110 xxx.xx.111.151 xxx.xx6.54.150 xxx.xx4.230.120 xxx.xx0.139.67 xxx.xx2.246.110 xx.xxx.223.3 xx.xx.x3.102 xx.xx.x9.165 xx.xx.x0.244 xx.xx.x33.2 xxxxxa.2waky.com xxx.xxawan.com xxxxxmic.dyndns-wiki.com xxxxxain.qpoe.com xxx.xxrver.us xxxxxfo.AtHerSite.com xxxxxem.passingg.as xxx.xxset.com xxxxx.dnset.com xxxx.xirat3.com xxxxxaga.chickenkiller.com xxxxx.otzo.com xxxxxck.dnsrd.com xxxxx.portrelay.com xxxxx.FindHere.orgPAGE 18 | iXESHE PAGE 18 | iXESHEMay 2012 | APT Campaign Quick Profile: IXESHEAdvanced persistent threats (APTs) refer to a category of threats that aggressively pursue and compromise specific targets to maintain persistent presence within the victim’s network so they can move laterally and exfiltrate data. Unlike indiscriminate cybercrime attacks, spam, web threats, and the like, APTs are much harder to detect because of the targeted nature of related components and techniques. Also, while cybercrime focuses on stealing credit card and banking information to gain profit, APTs are better thought of as cyber espionage.IXESHE• First	SeenIndividual targeted attacks are not one-off attempts. Attackers continually try to get inside the target’s network.The IXESHE campaign has been actively staging targeted attacks since at least July of 2009.• Victims	and	TargetsAPT campaigns target specific industries or communities of interest in specific regions.IXESHE has been found to target electronics manufacturers, a telecommunications company, and East Asian governments.• OperationsFirst-stage computer intrusions often use social engineering. Attackers custom-fit attacks to their targets.IXESHE attacks used custom-fit targeted emails with PDF exploits for CVE-2009-4324, CVE-2009-0927, CVE-2011-0609, and CVE-2011-0611. These were used to drop malicious executable files that gave the attackers complete control of their targets’ systems.The attackers used either dynamic Domain Name System (DNS) or compromised servers hosted on networks that they previously successfully infiltrated.• Possible	Indicators	of	CompromiseAttackers want to remain undetected as long as possible. A key characteristic of these attacks is stealth.» Enters networks via a specially crafted, targeted email with a malicious file attachment» Uses document exploits (primarily PDF exploits) to drop malware onto target systems» Uses malware detected as IXESHE by security companies» Sends a GET request to the command-and-control (C&C) server with the format:url Server]/[ACD] [EW]S[Some Numbers].jsp?[Encrypted Base64 Blob]* The campaign codes we have seen so far are detailed in the Trend Micro research paper, “IXESHE: An APT Campaign.” The characteristicshighlighted in this APT campaign quick profile reflect the results of our investigation as of May 2012.May 2012 | APT Campaign Quick Profile: IXESHEAdvanced persistent threats (APTs) refer to a category of threats that aggressively pursue and compromise specific targets to maintain persistent presence within the victim’s network so they can move laterally and exfiltrate data. Unlike indiscriminate cybercrime attacks, spam, web threats, and the like, APTs are much harder to detect because of the targeted nature of related components and techniques. Also, while cybercrime focuses on stealing credit card and banking information to gain profit, APTs are better thought of as cyber espionage.IXESHE• First	SeenIndividual targeted attacks are not one-off attempts. Attackers continually try to get inside the target’s network.The IXESHE campaign has been actively staging targeted attacks since at least July of 2009.• Victims	and	TargetsAPT campaigns target specific industries or communities of interest in specific regions.IXESHE has been found to target electronics manufacturers, a German telecommunications company, and East Asian governments.• OperationsFirst-stage computer intrusions often use social engineering. Attackers custom-fit attacks to their targets.IXESHE attacks used custom-fit targeted emails with PDF exploits for CVE-2009-4324, CVE-2009-0927, CVE-2011-0609, and CVE-2011-0611. These were used to drop malicious executable files that gave the attackers complete control of their targets’ systems.The attackers used either dynamic Domain Name System (DNS) or compromised servers hosted on networks that they previously successfully infiltrated.• Possible	Indicators	of	CompromiseAttackers want to remain undetected as long as possible. A key characteristic of these attacks is stealth.» Enters networks via a specially crafted, targeted email with a malicious file attachment» Uses document exploits (primarily PDF exploits) to drop malware onto target systems» Uses malware detected as IXESHE by security companies» Sends a GET request to the command-and-control (C&C) server with the format:url Server]/[ACD] [EW]S[Some Numbers].jsp?[Encrypted Base64 Blob]* The campaign codes we have seen so far are detailed in the Trend Micro research paper, “IXESHE: An APT Campaign.” The characteristicshighlighted in this APT campaign quick profile reflect the results of our investigation as of May 2012.TREND	MICRO™Trend Micro Incorporated (TYO: 4704; TSE: 4704), a global cloud security leader, creates a world safe for exchanging digital information with its In- ternet content security and threat management solutions for businesses and consumers. A pioneer in server security with over 20 years’ experience, we deliver top-ranked client, server and cloud- based security that fits our customers’ and partners’ needs, stops new threats faster, and protects data in physical, virtualized and cloud environments. Powered by the industry-leading Trend Micro™ Smart Pro- tection Network™ cloud computing security infrastructure, our products and services stop threats where they emerge—from the Internet. They are supported by 1,000+ threat intelligence experts around the globe.TREND	MICRO	INC.10101	N.	De	Anza	Blvd. Cupertino,	CA	95014U.S.	toll	free: 1 +800.228.5651 Phone: 1 +408.257.1500 Fax: 1 +408.257.2003 www.trendmicro.com©2012 by Trend Micro, Incorporated. All rights reserved. Trend Micro and the Trend Micro t-ball logo are trademarks or registered trademarks of Trend Micro, Incorporated. All other product or company names may be trademarks or registered trademarks of their owners.PAGE 19 | iXESHE 