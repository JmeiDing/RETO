to evolve its arsenalBY ASHEER MALHOTRA AND JUSTIN THATTILtalos-external@cisco.com | talosintelligence.compage 1 of 23CONTENTS Summary 3 What’s new? 3 How did it work? 3 So what? 3 Background 4 Early infection chain 4 Latest CetaRAT infection chains 4 njRAT infections 7 MSI-based infection chain 7 Malicious payloads 8 RAT analysis 9 Epicenter RAT 14 Plugin analysis 14 Files manager 14 Browser credential stealer 16 Keyloggers 17 Golang malware — Nodachi 17 Tracking and delivery infrastructure 19 Observations and analyses 20 Targeting 20 Credential Harvesting 22 Conclusion 23 Coverage 23talos-external@cisco.com | talosintelligence.compage 2 of 23SUMMARY • Cisco Talos is tracking an increase in the SideCopy APT's activities targeting governmentpersonnel in India using themes and tactics similar to APT36 (aka Mythic Leopard and Transparent Tribe).• SideCopy is an APT group that mimics the Sidewinder APT’s infection chains to deliver theirown set of malware.• We’ve discovered multiple infection chains delivering bespoke and commodity remote accesstrojans (RATs) such as CetaRAT, Allakore and njRAT.• Apart from the three known malware families utilized by SideCopy, Talos also discovered the usage of four new custom RAT families and two other commodity RATs known as “Lilith” and “Epicenter.” • Post-infection activities by SideCopy consist of deploying a variety of plugins, ranging from fileenumerators to credential-stealers and keyloggers.WHAT’S NEW? Cisco Talos has observed an expansion in the activity of SideCopy malware campaigns, targeting entities in India. In the past, the attackers have used malicious LNK files and documents to distribute their staple C#-based RAT. We are calling this malware “CetaRAT.” SideCopy also relies heavily on the use of Allakore RAT, a publicly available Delphi- based RAT.Recent activity from the group, however, signals a boost in their development operations. Talos has discovered multiple new RAT families and plugins currently used in SideCopy infection chains.Targeting tactics and themes observed in SideCopy campaigns indicate a high degree of similarity to the Transparent Tribe APT (aka APT36) also targeting India. These include using decoys posing as operational documents belonging to the military and think tanks and honeytrap-based infections.HOW DID IT WORK? SideCopy’s infection chains have remained relatively consistent with minor variations — using malicious LNK files as entry points, followed by a convoluted infection chaininvolving multiple HTAs and loader DLLs to deliver the final payloads.Talos also discovered the usage of other new RATs and plugins. These include DetaRAT, ReverseRAT, MargulasRAT and ActionRAT. We’ve also discovered the use of commodity RATs such as njRAT, Lilith and Epicenter by this group since as early as 2019.Successful infection of a victim results in the installation of independent plugins to serve specific purposes such as file enumeration, browser password stealing and keylogging.SO WHAT? These campaigns provide insights into the adversary’s operations: •Their preliminary infection chains involve delivering their staple RATs.• Successful infection of a victim leads to the introductionof a variety of modular plugins.• Development of new RAT malware is an indication thatthis group of attackers are rapidly evolving their malware arsenal and post-infection tools since 2019. Their current infrastructure setup indicates a special interest in victims in Pakistan and India.•talos-external@cisco.com | talosintelligence.compage 3 of 23BACKGROUND SideCopy campaigns use tactics and techniques that mimic the SideWinder APT group to deploy their own set of malware. For instance, this group actively utilizes artifact names and infection vectors identical to the Sidewinder group.SideCopy infection chains primarily consist of archive files containing malicious LNK files delivered to the victims. The filenames are meant to social engineer the victims into opening the LNK files, in turn, infecting them with SideCopy malware. What follows is a convoluted combination of malicious HTML Application files (HTA) and DOT NET-based loader DLLs that instrument CetaRAT and Allakore on the endpoints.EARLY INFECTION CHAIN The earliest discovered infection chain consisted of a LNK file that pulled down and executed an HTA from a remotelocation. This HTA would decode and instrument a loader DLL in memory to drop CetaRAT and another DLL (DUser. dll) (Figure 1).The dropped DLL is side-loaded into credwiz.exe. The DLL then executes CetaRAT on the infected endpoint, thereby completing the infection chain.The actors used this method in 2019 and have evolved it since then. This primitive infection chain doesn’t consist of decoy documents or images and is missing the Allakore RAT component (Figure 2).LATEST CETARAT INFECTION CHAINS Beginning 2020 and into 2021, we saw the attackers improve their infection chains. These infections also begin with malicious LNK files delivered to the victims. However, what follows is a combination of three HTA files, three loader DLLs, two instances of CetaRAT in some cases, and Allakore. This indicates an effort to modularize the attack chains, although it’s over-modularized in this case.Figure 1: LNK with fake PDF icon executing remote HTA using mshta.exe.Figure 2: Primitive SideCopy infection chain.talos-external@cisco.com | talosintelligence.compage 4 of 23Figure 3: Latest SideCopy infection chain.Figure 4: Latest SideCopy infection chain.The latest infection chains have also adopted the practice of displaying a decoy document (PDF) or image to the victims (Figure 3).Stage No. 1 — LNK The malicious LNK contains a command (Figure 4) to run a malicious HTA file hosted on an attacker-controlled website via mshta.exe.Stage No. 2 — HTA The malicious HTA file carries out the following activities: • Creates a JavaScript file to restart the endpoint afterthe malicious HTA has completed the infection process. (The JavaScript waits for a specified time and restarts the system, enough for HTA to complete the infection.) Load and invoke a malicious Dot Net-based loader DLL (Stage 2A) into memory.•Stage No. 2A — Loader DLL The malicious Dot Net-based loader DLL is responsible for: • Decompressing a decoy PDF and displaying it to thevictim on the endpoint.• Downloads another malicious HTA (Stage No. 3A) froma remote URL and executes it on the endpoint.talos-external@cisco.com | talosintelligence.compage 5 of 23• Downloads and executes another malicious HTA file (Stage No. 4) from a remote URL.The decoy document displayed to the victim in this case is an internal Indian Ministry of Defense (MoD) circular related to their Human Resources Management System (HRMS) (Figure 5).Stage No. 3 — Malicious HTA This malicious HTA is similar to those seen previously (usually seen as Stage No. 2 in other infection chains). It is used to deploy the malicious CetaRAT embedded in the HTA file.In some cases, we’ve observed instances of this malicious HTA deploying two distinct CetaRAT payloads on the same endpoint, a deviation from the usual infection chain.Stage No. 4 — Malicious HTA This malicious HTA is similar to the HTA seen in Stage No. 3A of the attack chain. This HTA also: •Loads another loader DLL into memory (Stage No. 4A).• Collects AV product names and passes them to the loader DLL (Stage No. 4A) along with the credwiz.exe binary and DUser.dll malicious DLL to be side-loaded.Stage No. 4A — Malicious loader DLL This DLL is responsible for dropping DUser.dll (Stage No. 4B side-loaded into credwiz) into a variable location, depending on the presence of a specific anti-virus products installed on the endpoint: DefenderFigure 5: Decoy PDF pretending to be an internal Indian Army document.talos-external@cisco.com | talosintelligence.compage 6 of 23Figure 6: njRAT infection chain.This loader DLL also persists Allakore RAT on the endpoint. The side-loaded DLL is then responsible for executing Allakore.•The decoy document is usually a PDF displayed to the victim. These PDFs mainly consist of themes related to the Indian Army and government.Stage No. 4B - Allakore Allakore RAT is a publicly available Delphi-based RAT. It is usually called “Cyrus client” in SideCopy infection chains. Its capabilities include: • Upload and download files. • Capture screenshots from the endpoint. • Steal current clipboard data.Enumerate directories and files. Keylogging.NJRAT INFECTIONS Another recently discovered infection chain (Figure 6) used by SideCopy completely abandons CetaRAT and Allakore and uses njRAT instead. This infection chain is simpler than the ones seen previously.A second variation of njRAT infection chain uses self- extracting RAR-based dropper executables that consists of: • Malicious VB script to set up persistence for njRAT de-ployed by the dropper. njRAT binary dropped and executed by the dropper.•Some examples of the self-extracting dropper filenames: • Indian Army Restructring And Re-Organiza- tion.pdf.exe director_general_level_border_coordination_ conference.pdf.exe Phase-3 of Nationwide Covid-19 Vaccination Registration.pdf.exe••MSI-BASED INFECTION CHAIN Around mid-2020, we observed a deviation from the LNK- based infection chain. In this case, the attackers hosted a malicious archive (ZIP) on an attacker-controlled website freewindowssoftware[.]com. The ZIP file contained an MSI file posing as an installer for the “Libre Video Locker” application. On installation, the malicious MSI would install Allakore RAT into the “Program Files\Libre Software Corporation\LibreVideoLocker” folder (Figure 7).The final payloads consisted of three components: •Loader EXE: Executed first and masquerades as a Libre video player application. It is, however, meant to run Allakore and the malicious BAT file.talos-external@cisco.com | talosintelligence.compage 7 of 23Figure 7: MSI-based infection chain dropping Allakore.• Persistence BAT file: Used to set up persistence forAllakore via the registry HKCU\ \Run key.• Allakore RAT exe: This is a copy of the Allakore RATbuilt in 2019, instrumented to communicate with a known SideCopy C2 IP.MALICIOUS PAYLOADS This is an overview of the different final stages of infections.RATS SideCopy infections utilize a number of RATs. The RAT payloads discovered by Talos so far are: • CetaRAT: SideCopy’s staple RAT first seen in thewild in 2019. This was already disclosed publicly. We are calling it “CetaRAT” to identify it throughout this research piece.• DetaRAT — C#-based RAT: A previously unknown C#-based RAT that contains several RAT capabilities similar to CetaRAT.• ReverseRAT: Another previously undiscovered C#-based reverse shell that also monitors removable drives. It is based on CetaRAT.• MargulasRAT: This is another custom RAT used as part of SideCopy operations. The dropper for MargulasRAT masquerades as a VPN application from India’s National Informatics Centre (NIC).• Allakore: Allakore is a Delphi-based RAT first observedin 2015. This RAT has been used by SideCopy extensively, along with CetaRAT.• ActionRAT: ActionRAT is another Delphi-basedRAT used in SideCopy’s operations. At first glance, it looks quite similar to Allakore but is distinct in its implementation. We also found a C#-based version of the RAT, indicating that the attackers have ported it to the Dot Net platform, as well. Lilith: Lilith is a C++-based RAT first observed in 2016. SideCopy used a customized version of Lilith in early 2019. Lilith has also been utilized by another APT named “TICK” in 2018 - 19. EpicenterRAT: Epicenter is another commodity RAT observed in the wild since 2012. SideCopy’s usage of Epicenter dates back to as early as 2018 - 19.••talos-external@cisco.com | talosintelligence.compage 8 of 23PLUGINS In addition to full-fledged RATs, SideCopy utilizes modular plugins to carry out specific malicious tasks on the infected endpoint: •File manager: A file management component that can enumerate, download and upload files on the endpoint from/to the C2.• Keyloggers: There are two keyloggers used by Side-Xeytan: A publicly available C#-based keylogger available since 2016. Lavao: Another C#-based keylogger.Copy. ○○○• Browser credential stealers: Again, there are twotypes of stealers used: ○C-based stealer component to steal passwords from Firefox and Chrome. C#-based stealer component to steal Chromium browser passwords.• Nodachi: A previously unknown set of plugins uti- lized by SideCopy we’re calling “Nodachi.” These Golang-based plugins have reconnaissance and file-stealing abilities targeting an Indian multi-factor authentication app known as “Kavach.”RAT ANALYSISCETARAT CetaRAT is a C#-based RAT family first seen in the wild since 2019. Its malicious capabilities (Figure 8) include: • Execution: Download and run arbitrary executables and commands. File management: Upload, download, delete, rename and enumerate files.•• Capture: Take screenshots and monitor clipboarddata.• Processes: List or kill processes on the endpoint.Figure 8: CetaRAT command codes.talos-external@cisco.com | talosintelligence.compage 9 of 23DETARAT DetaRAT is a previously unknown C#-based implant used by SideCopy. This implant uses a different set of command codes (Figure 9) with a hardcoded key for communicating with its C2 servers. Its malicious capabilities include: •Files management: Create, move, rename and delete directories and files. File enumeration: Retrieves detailed directory and file information recursively, including creation and last access times. Exfiltration and infiltration: Download and upload files from and to the C2.••• Audio: Record and uploadaudio files.• Remote control: Control mousecursor and clicks.• Hosts file: Retrieve and send /••etc/hosts file contents. Installed Software: Exfiltrate details of installed software from registry. Execution: Run arbitrary commands on the endpoint via cmd.exe.• Clipboard: Get and setclipboard data.• Sysinfo: The following informa- tion is sent to the C2 to finger- print the endpoint: ○○○○IP and MAC addresses. Installed anti-virus software. Processor and GPU info, RAM info, system uptime, OS details, battery charge and life. Hostname, current username and screen dimensions.Figure 9: DetaRAT command codes.talos-external@cisco.com | talosintelligence.compage 10 of 23REVERSERAT This is a simple C#-based malware that opens up a reverse shell (Figure 10) to its C2 server using cmd.exe. This reverse shell also has code built into it to monitor removable drive events (Figure 11), such as connection and removal.MARGULASRAT MargualsRAT is distributed via another C#-based dropper (Figure 12) binary. The dropper masquerades as the same VPN we mentioned previously. NIC is responsible for providing IT services, such as email and VPN access, to Indian government employees, including military personnel.Another variant of the dropper deploys MargulasRAT after displaying a decoy PDF to the victim (Figure 13).This infection chain uses VBScripts to persist MargulasRAT via registry, while the dropper downloads the RAT from a remote location (Figure 14).MargulasRAT (Figure 15) is limited in capabilities, but does include: • Screenshot capture: Capture a screenshot of the reso-lution specified by the C2, AES encrypt and send.• Update self: Receives an encoded binary from C2,Figure 10: ReverseRAT reverse shell.Figure 11: USB device insertion notifier code snippet.Figure 12: Dropper opening the decoy NIC VPN portal and setting up persistence for MargulasRAT.Figure 13: Code used to download and display a decoy PDF related to the Indian Army displayed to the victim followed by activation of MargulasRAT.talos-external@cisco.com | talosintelligence.compage 11 of 23writes it on a disk, and executes it. Runs cmd.exe to terminate itself afterward.• Download more payloads:Receives a name and encoded payload data from the C2, then write it to disk and execute it on the infected endpoint.• Stop communications: Terminatecommunication session with the C2 until the next run.We’ve observed unimplemented command codes in the MargualsRAT indicating that this RAT is actively in development by the attackers.Keylogging.ALLAKORE Allakore is a publicly available Delphi- based RAT that has consistently been used in SideCopy operations along with CetaRAT. Malicious capabilities of Allakore include: List folders and files. • Upload/Download files. • Steal clipboard data. • Grab/change wallpaper. In recent infections, this RAT is named “Cyrus client” (Figure 16).ACTIONRAT ActionRAT is a Delphi-based RAT containing a limited set of capabilities. This RAT also comes in a C# variant, indicating that the attackers have ported it to the Dot Net platform.This RAT typically uses two C2 URLs (Figure 17) — one for the initial check- in to confirm infections (beacon C2 URL) and the other to instrument the RAT and send/recv commands and output data.Figure 14: Malicious VBScript used to persist MargulasRAT across reboots.Figure 15: Command handler of MargulasRAT.Figure 16: Allakore RAT with the name “Cyrus_Client.”talos-external@cisco.com | talosintelligence.compage 12 of 23Figure 17: Two C2 URLs used in ActionRAT.Primary capabilities of the RAT include (Figures 18 and 19): • Gather sysinfo: Collect the following information from the infected endpoint and sends the following informa- tion to the C2 at the beginning of the RAT’s execution. ○Computer name and username. Installed anti-virus product names.○ ○ Operating system name, MAC address (used as in- fection identifier) and architecture type (x86 or x64). • Arbitrary command execution: Run arbitrary commands••specified by the C2 on the endpoint. List drives: Collect drive names and total size for all drives present on the system and send them to the C2. Enumerate files: Enumerate files for a given directory on the endpoint and sends the following information to the C2: ○Directory names and creation time. Filepath, size and creation time.○Figure 18: Command codes included in the Delphi version of ActionRAT.• Download files: Download a file specified by the C2 to alocation on disk.• Download and execute: Download and then execute afile specified by the C2 on the endpoint.• Upload files: Exfiltrate the contents of a specified file tothe C2.LILITH Lilith is a commodity RAT available in the wild since 2016. The version of Lilith used in SideCopy operations consists of the following capabilities (Figure 20): • • Download and execute files from specified locations. • • Reverse shell.Terminate or restart self.Enumerate files.Figure 19: C#-based ActionRAT’s command handler.talos-external@cisco.com | talosintelligence.compage 13 of 23Figure 20: Command codes and handlers in Lilith.Figure 21: Epicenter command handler.EPICENTER RAT Epicenter is a commodity RAT used by SideCopy since 2018. It contains a variety of capabilities (Figure 21) including: • Gathering system information. • Gather installed Antivirus product names. • Shutdown, reboot system or log the user off. • Block keyboard and mouse inputs to self. • Uninstall self.Enumerate, launch and kill processes. Take screenshots. Enumerate directories, delete files and folders.• • Check persistence status for self.PLUGIN ANALYSISFILES MANAGER The files manager plugin used can scan all drives on the system recursively and record file paths to a log file namedtalos-external@cisco.com | talosintelligence.compage 14 of 23“YYYYMMDDHHMMSS_di_output. txt” based on the current time (Figure 22). The file paths recorded must match the following extensions:doc, ppt, xls, txt, pdf, zip, mdb, accdb, db, rar, jpg, bmp, gif, csv, bmp, docx, pptx, xlsx and png.The files manager will also send preliminary system information to the C2 and receive a command code in return:hname=<MachineName>&uname= <Username> &osname=<Windows ProductName>&hid=<processor ID_BIOS_SerialNumber_Disk_ Signature>&mcc=<MACAddress> &avname=<AVInstalled>&arc= •hname = computer name. uname = username of currently logged in user. osname = Windows version name string. hid = hardware id i.e. a com- bination of processor ID, serial number and disk signature•••• mcc = Mac Address of the end-point. avname = either “Defender”, “Avira” or “N/A” depending on whichever AV is found installed. arc = “x64” or “x86”••Command codes: •“filelist” and “updatefilelist”: Send recorded file paths from “YYYYMMDDHHMMSS_di_output. txt” to C2 server. “download|”: Read contents of file path specified by C2 and exfiltrate.Figure 22: Files manager command handler module.• •“upload|”: Get specified file from C2 and write to specified location on disk. “execute|”: Download a specific file to a location on a disk specified by the C2 and execute it.SideCopy also uses a document copier (Figure 23). This component searches for files with specific extensions across removable and fixed drives and creates an encrypted copy for itself. The encrypted copy may be exfiltrated later by another component. So far, this component only searches for doc, docx, ppt, pptx and pdf files.talos-external@cisco.com | talosintelligence.compage 15 of 23We’ve also found standalone implementations of the document copier (called “UPirate”). This consists of document copying and encryption capabilities without the C2 functionality of the file manager component.BROWSER CREDENTIAL STEALER We’ve observed two flavors of browser credential stealer components utilized by SideCopy (Figure 24). The first is a C-based stealer that targets Firefox and Chrome.KinzaThe second credential stealer is C#-based and targets Chromium-based browsers, including: Epic Privacy Browser •SRWare Iron Browser • Opera Neon360 BrowserLiebao BrowserEdge ChromiumuCozMediaFigure 23: Find and save encrypted copy of file extensions specified.Figure 24: C-based browser credential stealer code for obtaining Chrome login data.talos-external@cisco.com | talosintelligence.compage 16 of 23Credentials extracted from any of these browsers installed on the endpoint are then written to a temporary log file on disk and subsequently exfiltrated to a DropBox location (Figure 25).KEYLOGGERS SideCopy uses two dedicated keyloggers for recording keystrokes, the aforementioned Xeytan (Figure 26) and Lavao (Figure 27), which is a custom keylogger first seen around mid-2019 that records timestamps, Window names and pressed key codes into a log file.GOLANG MALWARE — NODACHI Cisco Talos also discovered a GoLang-based component we’re calling “Nodachi.”Figure 25: Credentials exfiltrated using the DropBox upload API.Figure 26: Xeytan keystroke recorder used in SideCopy ops.Figure 27: Lavao keylogger collecting keystrokes and window titles.talos-external@cisco.com | talosintelligence.compage 17 of 23Nodachi is meant for reconnaissance and stealing different types of data from the victim’s endpoint: • Credential stealing: The malwareuses the goLazagne library to steal the login credentials from the infected endpoint, such as internet browsers, credential managers and some sysadmin tools (Figure 28). Once the login credentials are obtained, it copies these files over to the attacker’s Google Drive.• Steal ‘Kavach’ data: Kavach (hindi for “Armor”) is an authentication system used by the Govern- ment of India’s (GoI) NIC agency. Kavach provides its users with an MFA application/client used for authentication of employees to access GoI’s IT infrastructure, such as email. The malware looks for the “kavach.db” database containing login credentials of us- ers in the directory: C:\Users\<username>\ AppData\Roaming\kavach.db If found, the file is copied to the attacker’s Google Drive (Figure 29). File lister: The GoLang malware uses the goLazagne library to lists all files with specific extensions on the endpoint: .docx, .doc, .pptx, .xls and .xml. The files found are logged into a file that is then exfiltrated again to the attackers via Google Drive APIs. One variant of Nodachi also dis- played a decoy PDF downloaded from an attacker-owned Google Drive link. This decoy document is the same as the one seen in one of the latest CetaRAT infec- tion chains (Figure 30).•Figure 28: functionality.Figure 29: Look for kavach.db and open it.Figure 30: The Google Drive on March 25, 2021.talos-external@cisco.com | talosintelligence.compage 18 of 23Figure 31: Country check before serving a specific payload to the requester.TRACKING AND DELIVERY INFRASTRUCTURE SideCopy’s delivery infrastructure consists of either setting up fake websites or using compromised websites to deliver malicious artifacts to specific victims.The delivery scripts verify that requests to receive artifacts/ payloads are from two specific geographies: India and Pakistan (Figure 31). If this matches, then a payload or decoy is served to the requester.All requests are logged to a log file on the delivery server to keep track of artifacts served to potential victims (Figure 32).Figure 32: Victim logging capability of delivery servers.The data recorded in the log files consists of the following requester information: • Source IP address. • Device type: tablet, mobile or computer. • Operating system name. • User-Agent string. • Architecture type: 32- or 64-bit. • City and country of origin.Timestamp of request.talos-external@cisco.com | talosintelligence.compage 19 of 23OBSERVATIONS AND ANALYSESTARGETING SideCopy uses themes predominantly designed to target military personnel in the Indian subcontinent. Many of the LNK files and decoy documents used in their attacks pose as internal, operational documents of the Indian Army.One infection posed as a seniority list of the Indian Army as recently as early 2021 (Figure 33).Apart from military themes, SideCopy also utilized publications, calls for papers/proposals and job openings related to think tanks in India to target potential victims.In one of the infections, the attackers used a malicious LNK file to deliver Allakore and CetaRAT to its victims. This specific attack chain used a decoy document posing as an advertisement of a call for proposals for the Chair of Excellence 2021 for the Centre For Land and Warfare Studies (CLAWS) in India (Figure 34).Interestingly, the same theme was seen in another recent attack conducted by the Transparent Tribe APT to deliver ObliqueRAT payloads to their victims.In another instance, we observed the attackers using a decoy document consisting of an article published by the Centre for Joint Warfare Studies (CENJOWS) in India. The article is a Geo Strategic Scan from August 2020 discussing the political and economic implications of resuming diplomatic talks between the U.S. and China (Figure 34).Figure 33: Decoy document related to the Indian Army.Figure 34: Decoy as a legitimate CENJOWS article.talos-external@cisco.com | talosintelligence.compage 20 of 23More recently, an issue brief of the Observer Research Foundation (ORF, another independent think tank based out of India) was used as a decoy by SideCopy in an attack delivering njRAT to its victims (Figure 35).Another attack from 2020 shows targeting of diplomatic personnel — those working in embassies specifically. The decoy document employed in this case consisted of a circular from the Indian Ministry of External Affairs (MEA) to its employees and attachees. This infection chain also delivered Allakore and CetaRAT (Figure 36).Besides all of these email campaigns we’ve outlined, SideCopy also uses honeytraps to lure victims in. These infections typically consist of malicious LNK files that display explicit photos of women. The infection chain again delivers CetaRAT and Allakore. We’ve also observed APT36 (Transparent Tribe) use these types of honeytraps extensively in campaigns targeting members of India’s military with CrimsonRAT.Also like APT36, SideCopy clones legitimate websites that actually just serve malicious content.In the case of SideCopy, we discovered afghannewsnetwork[.] com, a website posing as the Pajhwok Afghan News, an Afghani independent news agency (Figure 37). This website was used as a C2 for actionRAT, delivered using malicious LNKs that used decoy documents that looked like professional resumes - another targeting tactic closely resembling APT36 (Transparent Tribe).Figure 35: ORF decoy document used in njRAT infections.Figure 36: Ministry of External Affairs Circular decoy document.talos-external@cisco.com | talosintelligence.compage 21 of 23Figure 37: (Left) malicious cloned website vs. (Right) Legitimate website for the Pajhwok Afghan News.CREDENTIAL HARVESTING One of SideCopy’s central motives is credential harvesting. Specifically, the group looks to steal access credentials from central Indian government employees.The group commonly targets Kavach, an MFA app used across India’s government. Kavach allows employees (including military personnel) to access IT resources such as email services.SideCopy has shown a particular interest in Kavach, deploying the njRAT malware with special victim IDs of “kavach.” They also use GoLang-based file recon plugins (Nodachi) to exfiltrate Kavach authentication databases from infected devices. Some droppers for MargulasRAT also masqueraded as installers for Kavach on Windows.We’ve also discovered phishing portals operated by SideCopy posing as the GoI’s webmail to trick victims into divulging their email credentials (Figure 38).Figure 38: Phishing portal for webmail[.]gov[.]in set up by SideCopy.talos-external@cisco.com | talosintelligence.compage 22 of 23CONCLUSION What started as a simple infection vector by SideCopy to deliver a custom RAT (CetaRAT), has evolved into multiple variants of infection chains delivering several RATs. The use of these many infection techniques — ranging from LNK files to self-extracting RAR EXEs and MSI-based installers — is an indication that the actor is aggressively working to infect their victims. This threat actor is also rapidly evolving their malware set using a combination of custom and commodity RATs and plugins. The variety of post-infection plugins specifically used by the attacker signifies a focus on espionage.Targeting tactics used by SideCopy consists of multiple themes, quite similar to those utilized by APT36: military, diplomatic and honeytraps. This indicates that the group continues to target government entities in the Indian subcontinent.This boost in SideCopy’s operations aided by multiple infection chains, RATs and plugins marks the group’s intent to rapidly evolve their TTPs.COVERAGE Ways our customers can detect and block this threat are listed below.Cisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here.Cisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks.Cisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here.Cisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat.Cisco Secure Network/Cloud Analytics (Stealthwatch/ Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device.Cisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products.ProductProtectionCisco Secure Endpoint (AMP for Endpoints)CloudlockCisco Secure EmailCisco Secure Firewall/Secure IPS (Network Security)Cisco Secure Network Analytics (Stealthwatch)Cisco Secure Cloud Analytics (Stealthwatch Cloud)Cisco Secure Malware Analytics (Threat Grid)UmbrellaCisco Secure Web Appliance (Web Security Appliance)N/AN/AN/AUmbrella, Cisco’s secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here.Cisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them.Additional protections with context to your specific environment and threat data are available from the Firewall Management Center.Cisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network.Open-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. SIDs 57842 - 57849 can protect against the threats outlined in this paper.Cisco Secure Endpoint users can use Orbital Advanced Search to run complex OSqueries to see if their endpoints are infected with this specific threat.talos-external@cisco.com | talosintelligence.compage 23 of 23 