WHITEPAPERSecurity More Evidence of APT Hackers-for-Hire Used for Industrial EspionageContentsExecutive Summary: 3 Key Findings: 3 Forensic Analysis 4 Toolset Analysis 5 Command and Control Server 7 Appendix A 7 Appendix B – IOCs 7ContentsAuthors: Victor Vrabie- Security Researcher, Cyber Threat Intelligence Lab Bogdan Rusu - Security Researcher, Cyber Threat Intelligence Lab Alexandru Maximciuc -Team Lead, Cyber Threat Intelligence Lab Co-author: Cristina Vatamanu - Senior Team Lead, Cyber Threat Intelligence LabExecutive Summary:Bitdefender researchers recently investigated a sophisticated APT-style cyberespionage attack targeting an international architectural and video production company, pointing to an advanced threat actor and a South Korean- based C&C infrastructure. As per reports in the past, APT mercenary groups have been used for cyberespionage by private competing companies seeking financial information or negotiation details for high-profile contracts. This attack likely falls under the same category. APT mercenary groups have been known to offer their services to the highest bidder, deploying sophisticated attacks and powerful cyberespionage tools against their contracted victims. The StrongPity APT group is one such example that Bitdefender investigated recently. The group, which has been known to target select victims, was recently associated with a potential Turkish military operation. The commoditization of APT-level hackers-for-hire could potentially entice rival luxury real-estate investors involved in multi-billion-dollar contracts to seek these services to spy on their competition by infiltrating their contractors. Industrial espionage is nothing new and, since the real-estate industry is highly competitive, with contracts valued at billions of dollars, the stakes are high for winning contracts for luxury projects and could justify turning to mercenary APT groups for gaining a negotiation advantage. The targeted company is engaged in architectural projects with billion-dollar luxury real-estate developers in New York, London, Australia and Oman. With offices in London, New York, and Australia, the company’s customers and projects involve luxury residences, high-profile architects and world-renowned A-list interior designers. The sophistication of the attack reveals an APT-style group that had prior knowledge of the company’s security systems and used software applications, carefully planning their attack to infiltrate the company and exfiltrate data undetected. The Bitdefender investigation revealed the cybercriminal group infiltrated the company using a tainted and specially crafted plugin for Autodesk 3ds Max (popular software widely used in 3D computer graphics). The investigation also found that the Command and Control infrastructure used by the cybercriminal group to test their malicious payload against the organization’s security solution, is located in South Korea. During the investigation, Bitdefender researchers also found that threat actors had an entire toolset featuring powerful spying capabilities. Based on Bitdefender’s telemetry, we also found other similar malware samples communicating with the same command and control server, dating back to just under a month ago. Located in South Korea, United States, Japan, and South Africa, it’s likely the cybercriminal group might have also been targeting select victims in these regions as well.Key Findings:Industrial espionage for competitiveness in real-estate industry• Potential APT mercenary group used for industrial cyberespionage • • Malicious payload posing as a plugin for a popular 3D computer graphics software (Autodesk 3ds Max) • Payload tested against the company’s security solution to avoid detection upon delivery • C2 infrastructure based in South Korea While this is not the first incident in which APT mercenary groups have been potentially used to conduct espionage or coordinate with alleged military operations, these events have intensified during the past couple of years. The recently investigated StrongPity APT group has all the characteristics of a mercenary cybercriminal group, known to serve both financial and potentially military objectives. Other groups, such as “Dark Basin” and “Deceptikons,” are only a few recent examples in which APT groups for hire have allegedly acted on behalf of customers seeking to discredit or infiltrate high-profile targets in financial, legal, and now the multi-billion-dollar real-estate industry.3Bitdefender Whitepaper More Evidence of APT Hackers-for-Hire Used for Industrial EspionageThis is likely to become the new normal in terms of the commoditization of APT groups -- not just state-sponsored actors, but by anyone seeking their services for personal gain, across all industries.Forensic Analysis The threat forensic analysis started from a suspicious sample named PhysXPluginStl.mse (hash: behavior.Attack overview In a recent advisory published by Autodesk, users are warned of a third-party MAXScript exploit, “PhysXPluginMfx” (variant of ALC2, ALC, CRP and ADLS), that can corrupt 3ds Max to run malicious code and even propagate to other MAX files. Instructions on how to identify and remove the malware have also been published. However, as our investigation revealed, it’s likely that more victims were affected long before this unknown threat was identified. The file is a Max Script Encrypted script (encryption specific to Autodesk 3dsMax Solution software) and contains an Further analysis of this file lead us to a maxscript that starts with some http post requests, whose responses are executed directly from memory, after some delays. Those two requests are the following: • POST, hxxp://175[.]197.40.61:3445/FRNuzqJIZyb, using a token in body:“t785EyDk/6s4VXZZ6Sb7TFl7vepBKQrgX8LmGURaPLM=”, without any additional information; the execution is postponed 10 seconds• POST, hxxp://175[.]197.40.61:3445/TYEHVSjn2Ny, using a token in body:“RhUzq3wdz8xpCIzZVoqrTDr0FXpOmsgjAnyTy6xh/+w=”, without any additional information; the execution is postponed 4 secondsMoving further, a periodic job is created to clean up some well-known ALC/CRP 3rd party maxscripts, which are known to lead to some issues (see the Appendix A for more information about these issues). This part may look unsuspicious, but, after cleanup, some code is downloaded from the C&C and executed. The download is performed from the following URLs: • hxxp://175[.]197.40.61:3445/Public/Find_Alc • hxxp://175[.]197.40.61:3445//Public/Find_Crp 4The last part of the script takes care of the persistence. A downloaded file (from hxxp://175[.]197.40.61:3445/ grhL1wCYAhf) is stored in “AppData\Local\Autodesk\3dsMax\*\ENU\scripts\startup\ PhysXPluginStl.mse” (in the startup folder of 3ds max software) and the hidden file attribute is set. Investigating the C&C, we managed to reproduce part of the communication protocol and to download buffers of code whose content is executed. Responses from the C&C were valid, indicating that, at the time of the writing, it was still up. The response for the route hxxp://175[.]197.40.61:3445/FRNuzqJIZyb, lead us of them will download and execute other maxscripts whose content is very similar. The new script is meant to collect some information about the victim (computer name, username), encrypt it with a custom algorithm and mask the result so that it appears to be base64 content. Moving further, the obtained data is used in a request sent to the C&C (at hxxp://175[.]197.40.61:3445/TYEHVSjn2Ny), to obtain a new piece of code to be executed. After this, for each 3ds max release, installed on the machine, in scripts\startup\max folder a file named “default.mse” is downloaded from hxxp://175[.]197.40.61:3445/YkSxBJVz using the aforementioned user information, and then, detection evasion techniques are applied (file creation timestamp is modified, the hidden attribute is set on the max folder and the default.mse file. In this case also, a cleanup action is performed, similar to the one mentioned above, which cleans up some well-known ALC/CRP third-party maxscripts. The response for the hxxp://175[.]197.40.61:3445/TYEHVSjn2Ny request, leads us to a .net resource section contains a downloader, which obtains from the C&C (hxxp://175[.]197.40.61:3445/b route), other binaries. We were unable to obtain the responses directly from the C&C, but, based on some quite unique method names invoked by the downloader we managed to obtain a binary of making screenshots, collecting passwords and history from a Chrome browser database. This information is uploaded to the C&C, the same as in our case, strengthening the idea of being the one requested by the downloader. It is not uncommon in targeted attacks for the threat actors to test malicious files against the security solutions used by their victims, so that they can change them until the files are no longer detected. We have also identified a toolset that is described in section below. We have chosen a representative file for each category, all the indicators of compromise being listed in the Appendix B section. Toolset AnalysisLooking through the telemetry of the C&C, we noticed that there are reports, which include some of the discovered .net assembly internal names found initially on the victims’ machine or downloaded from the C&C. After analysis, we have managed to gather more tools, based on direct usage or based on common portions of code. Beside this, we have also noticed that all of them share the C&C address from the victim (address + port).HdCrawler The binary’s role is to list, compress (if needed) and upload a list of specific files (searched by extension). Caution has been taken not to apply useless compression – if the file to be copied has the extension in this list: “.zip”, “.rar”, “.alz”, “.7z”, “.mp4”, “.flv”, “.webm”, “.webp”, “.jpg”, “.jpeg”, “.png”, “.avi”, “.mkv”, “.mp3”, “.mpeg”, “.mpg”, “.apk”, “.obb”, “.pur”, “.uasset” then the file is skipped from compression. There is an interesting aspect to this component – the list of files to be uploaded to the server is built into the binary, which means that, on the other side, the attackers look at the file listings from each of their victims and then compile a HdCrawler binary specific to the victim.5Bitdefender Whitepaper More Evidence of APT Hackers-for-Hire Used for Industrial EspionageWhile searching for more related samples and information, we found two “tools” that should be on the C&C side, used to control and manage the victims and the stolen information by processing the output of the HDCrawler: • LogViewer – a tool with a GUI that seems to be the one that shows the victims and the file listings from them • HddUnpacker - is used by LogViewer to decrypt and decompress the files uploaded by HdCrawler, the screenshotstaken during the attack, the file listings, and the credentials stored in the Chrome browserInfoStealer mentioned before has the OriginalFilename set to B4E6HVVnCvY.dll. In our file repositories we have found a file B4E6HVVnCvY.exe. There is high confidence that this sample is related, also because of the use of the same C&C. This binary has the following capabilities: • Rate-limiting - uses %LOCALAPPDATA%\ Microsoft\Internet Explorer\MSWINSIG.DAT (in which it writesa timestamp) as a rate-limiting mechanism, to run at most once every three hours• Screen capture – makes whole screen capture and uploads it to the C&C server •Information collection – collects the username, computername, the IP addresses of network adapters, Windows ProductName, version of the .NET Framework, information about the processors (number of cores, the speed and other information), total and free RAM, information about the storage, the listing of files set to start automatically when Windows starts up, process listing and recent files; all this information is uploaded to the C&C server. • Tied	to	a	specific	user	on	the	computer - uses %LOCALAPPDATA%\ Microsoft\Internet Explorer\ MSWINTAP.DAT – the first four bytes of it contain a hash on the computername and username; that hash is checked before the content gets loaded; the remaining bytes are received from the C&C and are appended to the following http request messages to the C&C; It makes use of another file “tied” to the user (same hash as in the case of MSWINTAP.DAT) in %PROGRAMDATA%\ Microsoft\Windows\Ringtones; we know it writes 11 characters in it, but its exact intention is yet to be discovered • %LOCALAPPDATA%\ Microsoft\Internet Explorer\ie4uRidd.dat – it’s a .NET class (named internally TaskClass), serialized and encrypted, which represents a task for file listings; it contains a list of disk drives and specific directories that will be recursively listed from now on. This mechanism lets the attackers skip specific directories and disk drives completely and get back only information about the files they are most interested in. If this ie4uRidd.dat file is not present, then a directory listing of all files from B:, C:, D:, K: is sent to the C&C server (we couldn’t find out why these specific drives were chosen).•ObservationsThe authors took an interesting approach to avoid attracting attention. If Task Manager or Performance Monitor applications are running and their respective window is visible, then a flag is set, depending on how much of the area is visible to the user; this flag instructs the binary to sleep more and more often (reducing this way the consumption of CPU). An interesting library we could link to this whole toolkit is LibCredentials. We did not see it used anywhere in our telemetry. According to the class names, it’s responsible for collecting credentials from the current machine: browsers (Internet Explorer, Firefox, Chrome), Outlook, WLan credentials and everything stored in Windows Vault.6Command and Control Server The C&C belongs to AS4766 Korea Telekom, South Korea. Although Shodan (hxxps://beta.shodan.io/ be seen on other IPs too), we have only seen components that communicate to port 3445 and port 6711. (the latter is used by a FTP server, as can be seen in the HdCrawler binaries we found).Appendix ADetails about ALC/CRP 3rd party maxscripts: url B – IOCsFile Hashes: • %LOCALAPPDATA%\ Microsoft\Internet Explorer\MSWINTAP.DAT • %LOCALAPPDATA%\ Microsoft\Internet Explorer\MSWINSIG.DAT • %LOCALAPPDATA%\ Microsoft\Internet Explorer\ie4uRidd.dat URLs: • hxxp://175.197.40[.]61:3445/eYOMAHg • hxxp://175.197.40[.]61:3445/YkSxBJVz • hxxp://175.197.40[.]61:3445/n • hxxp://175.197.40[.]61:3445/r • hxxp://175.197.40[.]61:3445/l • hxxp://175.197.40[.]61:3445/b • hxxp://175.197.40[.]61:3445/TYEHVSjn2Ny • hxxp://175.197.40[.]61:3445/grhL1wCYAhf • hxxp://175.197.40[.]61:3445/Public/Find_Alc • hxxp://175.197.40[.]61:3445//Public/Find_Crp • hxxp://175.197.40[.]61:3445/FRNuzqJIZyb • hxxp://175.197.40[.]61:3445/Public/fixAll • hxxp://175.197.40[.]61:3445/Public/NlWuLNUDzqMC&C IP addresses: • 175[.]197[.]40[.]617Why BitdefenderProudly Serving Our Customers Bitdefender provides solutions and services for small business and medium enterprises, service providers and technology integrators. We take pride in the trust that enterprises such as Mentor, Honeywell, Yamaha, Speedway, Esurance or Safe Systems place in us. Leader in Forrester’s inaugural Wave™ for Cloud Workload Security NSS Labs “Recommended” Rating in the NSS Labs AEP Group Test SC Media Industry Innovator Award for Hypervisor Introspection, 2nd Year in a Row Gartner® Representative Vendor of Cloud-Workload Protection PlatformsDedicated To Our +20.000 Worldwide Partners A channel-exclusive vendor, Bitdefender is proud to share success with tens of thousands of resellers and distributors worldwide. CRN 5-Star Partner, 4th Year in a Row. Recognized on CRN’s Security 100 List. CRN Cloud Partner, 2nd year in a Row More MSP-integrated solutions than any other security vendor 3 Bitdefender Partner Programs - to enable all our partners – resellers, service providers and hybrid partners – to focus on selling Bitdefender solutions that match their own specializationsTrusted Security Authority Bitdefender is a proud technology alliance partner to major virtualization vendors, directly contributing to the development of secure ecosystems with VMware, Nutanix, Citrix, Linux Foundation, Microsoft, AWS, and Pivotal. Through its leading forensics team, Bitdefender is also actively engaged in countering international cybercrime together with major law enforcement agencies such as FBI and Europol, in initiatives such as NoMoreRansom and TechAccord, as well as the takedown of black markets such as Hansa. Starting in 2019, Bitdefender is also a proudly appointed CVE Numbering Authority in MITRE Partnership.RECOGNIZED BY LEADING ANALYSTS AND INDEPENDENT TESTING ORGANIZATIONSTECHNOLOGY ALLIANCES0 