Trend MicroAbout TrendLabs Security Intelligence BlogHomeCategoriesHome » Malware » Supply Chain Attack Operation Red Signature Targets South Korean OrganizationsSupply Chain Attack Operation Red Signature Targets South Korean OrganizationsPosted on: August 21, 2018 at 6:04 am Posted in: Malware, Targeted Attacks Author: Trend Micro Cyber Safety Solutions Team by Jaromir Horejsi, Joseph C. Chen, Kawabata Kohei, and Kenney LuTogether with our colleagues at IssueMakersLab, we uncovered Operation Red Signature, an information theft-driven supply chain attack targeting organizations in South Korea. We discovered the attacks around the end of July, while the media reported the attack in South Korea on August 6.The threat actors compromised the update server of a remote support solutions provider to deliver a remote access tool called 9002 RAT to their targets of interest through the update process. They carried this out by first stealing the company’s certificate then using it to sign the malware. They also configured the update server to only deliver malicious files if the client is located in the range of IP addresses of their target organizations.9002 RAT also installed additional malicious tools: an exploit tool for Internet Information ServicesWeb page converted to PDF with the PDFmyURL PDF creation API!Search:Featured Storiessystemd Vulnerability Leads to Denial of Service on LinuxqkG Filecoder: Self-Replicating, Document- Encrypting RansomwareMitigating CVE-2017-5689, an Intel Management Engine VulnerabilityA Closer Look at North Korea’s InternetFrom Cybercrime to CyberpropagandaSecurity Predictions for 2018Attackers are banking on network vulnerabilities and inherent weaknesses to facilitate massive malware attacks,(IIS) 6 WebDav (exploiting CVE-2017-7269) and an SQL database password dumper. These tools hint at how the attackers are also after data stored in their target’s web server and database.IoT hacks, and operational disruptions. The ever-shifting threats and increasingly expanding attack surface will challenge users and enterprises to catch up with their security. Read our security predictions for 2018.Business Process CompromiseAttackers are starting to invest in long- term operations that target specific processes enterprises rely on. They scout for vulnerable practices, susceptible systems and operational loopholes that they can leverage or abuse. To learn more, read our Security 101: Business Process Compromise.Figure 1. Operation Red Signature’s attack chainRecent PostsHere’s how Operation Red Signature works:1. The code-signing certificate from the remote support solutions provider is stolen. It’s possiblethat the certificate was stolen as early as April 2018, as we found a ShiftDoor malware certificate.Supply Chain Attack Operation Red Signature Targets South Korean OrganizationsUse-after-free (UAF) Vulnerability CVE-2018-8373 in VBScript Engine Affects Internet Explorer to Run Shellcode2. Malicious update files are prepared, signed with the stolen certificate, and uploaded to theAugust Patch Tuesday: A Tale of Two Zero-Daysattacker’s server (207[.]148[.]94[.]157).3. The update server of the company is hacked. 4. The update server is configured to receive an update.zip file from the attackers’ server if aclient is connecting from a specific range of IP addresses belonging to their targeted organizations.Ransomware as a Service Princess Evolution Looking for AffiliatesHow Machine Learning Can Help Identify Web Defacement CampaignsWeb page converted to PDF with the PDFmyURL PDF creation API!5. The malicious update.zip file is sent to the client when the remote support program isexecuted.6. The remote support program recognizes the update files as normal and executes the 9002RAT malware inside it.7. 9002 RAT downloads and executes additional malicious files from the attackers’ server.Technical analysis The update.zip file contains an update.ini file, which has the malicious update configuration that specifies the remote support solution program to download file000.zip and file001.zip and extract them as rcview40u.dll and rcview.log to the installation folder.The program will then execute rcview40u.dll, signed with the stolen certificate, with Microsoft register server (regsvr32.exe). This dynamic-link library (DLL) is responsible for decrypting the encrypted rcview.log file and executing it in memory. 9002 RAT is the decrypted rcview.log payload, which connects to the command-and-control (C&C) server at 66[.]42[.]37[.]101.Popular PostsThe Need for Managed Detection and Response: Persistent and Prevalent Threats in North America’s Security LandscapeNew Underminer Exploit Kit Delivers Bootkit and Cryptocurrency-mining Malware with Encrypted TCP TunnelHow Machine Learning Can Help Identify Web Defacement CampaignsMalware Targeting Bitcoin ATMs Pops Up in the UndergroundRansomware as a Service Princess Evolution Looking for AffiliatesStay UpdatedEmail SubscriptionYour email hereSubscribeWeb page converted to PDF with the PDFmyURL PDF creation API!Figure 2. Contents of the malicious update configurationWeb page converted to PDF with the PDFmyURL PDF creation API!Figure 3. How the compromised update process launches the 9002 RAT malwareFigure 4. Known 9002 RAT string pattern inside the decrypted payload of the rcview.log fileCorrelating 9002 RAT Delving into 9002 RAT, we found that it was compiled on July 17, 2018, and that the configuration files inside update.zip were created on July 18. Our analysis of an update log file we found reveals the remote support program’s update process started around 13:35 on July 18, with the 9002 RAT being downloaded and launched. We also saw the RAT file used for this specific attack was set to be inactive in August, so we can construe that the RAT’s activity was rather short-lived (from July 18 to July 31).Web page converted to PDF with the PDFmyURL PDF creation API!Figure 5. Compilation timestamp on 9002 RAT sample (top), timestamp of the maliciousconfiguration (center), and snapshot of the program’s update log (bottom)Figure 6. Code snippet showing 9002 RAT checking the system time and setting itself to sleep inAugust 2018Additional malware tools The 9002 RAT also serves as a springboard for delivering additional malware. Most of these are downloaded as files compressed with the Microsoft cabinet format (.cab). This is most likely done to avoid detection by antivirus (AV) solutions.Here’s a list of files that 9002 RAT retrieves and delivers to the affected system:Filenamedsget.exeToolDsGetPurposeView active directory objectsdsquery.exeDsQuerySearch for active directory objectssharphound.exeSharpHoundCollect active directory informationaio.exeAll In One (AIO)Publicly available hack toolssms.exeprintdat.dllSQL PassworddumperRAT (PlugXvariant)Dump password from SQL databaseRemote access toolWeb page converted to PDF with the PDFmyURL PDF creation API!w.exeWeb.exeIIS 6 WebDav Exploit ToolWebBrowserPassViewsmb.exeScannerm.exeCustom Mimikatz(including 32bit/ 64bit file)Exploit tool for CVE-2017-7269 (IIS 6)Recover password stored by browserScans the system’s Windows version and computernameVerify computer password and active directorycredentialsFigure 7. Downloaded Web.ex_ cabinet file (left) and decompressed Web.exe file (right)One of the downloaded files printdat.dll, which is another RAT. It is a variant of PlugX malware, and connects to the same C&C server (66[.]42[.]37[.]101).Figure 8. Internal PlugX date dword value inside the printdat.dll fileMitigating supply chain attacks Supply chain attacks don’t just affect users and businesses — they exploit the trust between vendors and its clients or customers. By trojanizing software/applications or manipulating the infrastructures or platforms that run them, supply chain attacks affects the integrity and security of the goods and services that organizations provide. In healthcare, for instance, where the industry heavily relies on third-party and cloud-based services, supply chain attacks can risk the privacy of personally identifiable data and intellectual property, disrupt hospital operations, and evenWeb page converted to PDF with the PDFmyURL PDF creation API!endanger patient health. And when stacked up with regulations such as the EU General Data Protection and Regulation (GDPR), the impact can be exacerbated.Here are some best practices:Oversee third-party products and services; apart from ensuring the security of the organization’s own online premises (e.g., patching, authentication mechanisms), security controls must also be in place in third-party applications being used. Develop a proactive incident response strategy: Supply chain attacks are often targeted; organizations must be able to fully understand, manage, and monitor the risks involved in third-party vendors. Proactively monitor the network for anomalous activities; firewalls and intrusion detection and prevention systems help mitigate network-based threats. Enforce the principle of least privilege: Network segmentation, data categorization, restriction of system administration tools, and application control help deter lateral movement and minimize data being exposed.Trend Micro Solutions The Trend Micro™ Deep Discovery™ solution provides detection, in-depth analysis, and proactive response to today’s stealthy malware and targeted attacks in real time. It provides a comprehensive defense tailored to protect organizations against targeted attacks and advanced threats through specialized engines, custom sandboxing, and seamless correlation across the entire attack life cycle, allowing it to detect threats even without any engine or pattern update. Trend Micro endpoint solutions such as the Smart Protection Suites and Worry-Free Business Security solutions can protect users and businesses from threats by detecting malicious files and blocking all related malicious URLs.Indicators of Compromise (IoCs): detected by Trend Micro as BKDR_SETHC.D HKTL_DELOG — TSPY_KORPLUG.AN (rcview40u.dll) — TROJ_SIDELOADR.A (sharphound.exe) — HKTL_BLOODHOUND — HKTL_PASSDUMP — TROJ_CVE20177269.MOX — HKTL_BROWSERPASSVIEW.GA URLs related to the malicious update file:hxxp://207.148.94[.]157/update/rcv50/update.zip hxxp://207.148.94[.]157/update/rcv50/file000.zip hxxp://207.148.94[.]157/update/rcv50/file001.zipURLs related to additionally downloaded malicious files:hxxp://207[.]148[.]94[.]157/aio.exe hxxp://207[.]148[.]94[.]157/smb.exe hxxp://207[.]148[.]94[.]157/m.ex_ hxxp://207[.]148[.]94[.]157/w hxxp://207[.]148[.]94[.]157/Web.ex_Related C&C server (9002 RAT and PlugX variant):66[.]42[.]37[.]101Related Posts: Related Posts:From Cybercrime to CyberpropagandaWeb page converted to PDF with the PDFmyURL PDF creation API!REDBALDKNIGHT/BRONZE BUTLER’s Daserf Backdoor Now Using Steganography Lazarus Campaign Targeting Cryptocurrencies Reveals Remote Controller Tool, an Evolved RATANKBA, and More Tropic Trooper’s New StrategyLearn how to protect Enterprises, Small Businesses, and Home Users from ransomware:ENTERPRISE»SMALL BUSINESS»HOME»Tags: Operation Red SignatureSouth Koreasupply chainWeb page converted to PDF with the PDFmyURL PDF creation API!HOME AND HOME OFFICE |FOR BUSINESS |SECURITY INTELLIGENCE |ABOUT TREND MICROAsia Pacific Region (APAC): Australia / New Zealand, 中国, 日本, 대한민국, 台灣 Europe, Middle East, & Africa Region (EMEA): France, Deutschland / Österreich / Schw eiz, Italia, Россия, España, United Kingdom / IrelandLatin America Region (LAR): Brasil, MéxicoNorth America Region (NABU): United States, CanadaPrivacy StatementLegal PoliciesCopyright © 2018 Trend Micro Incorporated. All rights reserved.Web page converted to PDF with the PDFmyURL PDF creation API! 