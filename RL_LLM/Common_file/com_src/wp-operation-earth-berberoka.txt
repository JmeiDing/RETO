Operation Earth Berberoka An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesDaniel Lunghi and Jaromir HorejsiContents4 Trend Micro ResearchWritten by Daniel Lunghi Jaromir HorejsiStock image used under license from Envato.comIn recent years, there has been an advent of new technologies that power e-gambling websites and applications, causing the online gambling market to continuously grow. In fact, this market is expected to be valued at more than US$92.9 billion by 2023.1 And when the Covid-19 pandemic happened, online gambling numbers soared even higher. According to a study conducted by the University of Bristol and published in the Journal of Gambling Studies, gamblers were more than six times more likely to participate in online gambling activities compared to before the pandemic struck.2Because malicious actors tend to follow the money trail, it is not at all surprising that the online gambling industry has been targeted by cybercriminals. In 2020, we reported on Operation DRBControl, an advanced persistent threat (APT) group that used malware in a cyberespionage campaign aimed at gambling companies in Southeast Asia.3 And in 2021, Akamai reported that a European gambling company suffered a distributed denial- of-service (DDoS) attack that peaked at a whopping 800 gigabits per second.4We discovered an APT group that we have dubbed Earth Berberoka (aka GamblingPuppet). Based on our analysis, this APT group targets gambling websites. Our investigation also shows that this group’s campaign uses multiple malware families that target the Windows, Linux, and macOS platforms, and that have been attributed to Chinese-speaking actors. Aside from using tried-and-tested malware families that have been upgraded, such as PlugX and Gh0st RAT, Earth Berberoka has also developed a brand-new complex, multistage malware family, which we have dubbed PuppetLoader.In this report, we present a detailed technical analysis of the different malware families that Earth Berberoka uses on the three platforms that it targets. We also provide details on the infection vectors used by the group and information on other cybercriminal groups to which Earth Berberoka is potentially linked.TargetsWe believe that Earth Berberoka’s primary targets have been gambling websites in China, but we alsohave evidence that the group has also targeted one government institution related to education, two ITservices companies, and one electronics manufacturing company.From Dec. 12, 2020, to April 29, 2022, we noted 15 downloads of a fake Adobe Flash Player installer inChina. We also saw eight redirects from certain websites to the malicious Adobe Flash Player website(five from a legitimate news website in the US and three from an unknown website, two of which werefrom Hong Kong and one from Malaysia), and one PlugX DLL detection in Taiwan. (In the context of thiscampaign, a redirect means an HTTP request to the script that redirects to the fake Adobe Flash Playerinstaller. The script itself is hosted in a third-party server. Earth Berberoka thus compromises a website,inserts in that compromised website a redirection to a third-party website, and that third-party websiteredirects to the website hosting the fake Adobe Flash Player installer. We explain this mode of infectionfurther in the “Infection Vectors” subsection of this report.)China 1Figure 1. Earth Berberoka telemetry hits from Dec. 12, 2020, to April 29, 2022We also retrieved logs generated by Earth Berberoka’s keyloggers that showed a hosting provider fromMalaysia that was being compromised. A similar log file found in the wild contained an IP address belongingto a Chinese gambling website. A third log file contained the login page URL of another Chinese gamblingwebsite. These two files reinforced our belief that the gambling industry had indeed been at the crosshairsof this campaign.4 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesAnother hint of Earth Berberoka’s targeted countries can be found in one of the backdoored applicationsthat the group has used. The registration process is restricted to countries in North America and countriesin Asia, including China, Hong Kong, Macao, Taiwan, the Philippines, Japan, and South Korea. A detailedexplanation can be found in the “Infection Vectors” subsection of this report.The last hint resides in the decrypted configuration files from samples of two malware families used byEarth Berberoka to target the Linux platform, Xnote and HelloBot. These samples contain some wordsthat might relate to gambling companies, such as “caipiao”, which translates to “lottery,” and “Yabo”,which could refer to a gambling website.Other decrypted configuration files contain keywords that are related to a Russian defense company,which we have elected not to disclose. This proves that Earth Berberoka also targets other, sensitiveindustries.5 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesTechnical Analysis value based on ComputerNameDLL file of BasicLoaderBMP file with encrypted CoreBMP file with encrypted Client.MainConsoleTable 1. The files created and dropped by the dropper8 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesThe malware inserts the hard-coded GUID ({78106D5F-CD1A-A8C4-A625-6863092B4BBA}) intoCPuppetProcessFileSharer (C:\\Users\\Public\\Pictures\\Desktop.inf), likely as a marker that stage 2 hasbeen completed.Config.ini (C:\Users\Public\Videos\Config.ini) contains the GUID and the reason, which is the hard-codedvalue “StartupBasicLoader” encrypted using the key “whk0q9ogev6ofg8d”.The dropper then starts svchost.exe in suspended mode with this command-line parameter:-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release-InvokeMethodName=Run -InokeMethodParam=NULLThe dropper also encrypts it with the key “whk0q9ogev6ofg8d” and creates a new thread withinsvchost.exe to make it load MSVCPX00.dll, which is the BasicLoader payload. It is interesting to note thatthere is a typographical error in “-InokeMethodParam”.Stage 3: BasicLoaderThe BasicLoader stage starts by adding a hard-coded GUID({78106D5F-CD1A-A8C4-A625-6863092B4BBA}) into CPuppetProcessFileSharer, likely as a marker that stage 3 has started running.BasicLoader then searches for BMP files across directories in Users\\Public, such as Desktop, Documents,Downloads, Music, Pictures, and Videos. It performs a series of checks for each of the BMP file that itfinds. If a BMP file passes those checks and has the required structure, then BasicLoader decrypts, loadsinto memory, and executes the payload appended to the BMP file.As it turns out, the actual BMP file is tiny: It is made up of only 33 by 11 pixels and 338 bytes. The dataappended to it is the payload, encrypted with the same flawed RC4 implementation.Figure 5. A small BMP file, to which the encrypted payload is appendedStage 4: CoreThe Core stage starts by adding a hard-coded GUID ({7D8DA9DC-1F3B-2E5C-AA59-9418E652E4AA})into CPuppetProcessFileSharer. Similar to the other stages, this is likely a marker that stage 4 has startedrunning.9 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesThen, the malware starts a system logger thread, where the logged information, which can come fromother modules or processes, is received via a pipe and is saved to a file with a hard-coded name. Eachentry in the log file is separated by a separator (0xAABBCCDD), followed by a custom RC4 password andmessage length.The decrypted log can include information about which module was run, with which parameters, and atwhich stage (GUID from CPuppetProcessFileSharer) the action was performed.Figure 6. The decrypted log from CoreThe Core stage is run with these command-line arguments:•••••-DisplayName-InokeMethodParam (sic)-InvokeMethodName-NoModuleLoadDLL-LoadShellcode-NoModuleLoadDLL uses the same technique as the stage 1 loader, while -LoadShellcode allocates amemory block, copies shellcode, and executes it. The other arguments are self-explanatory.Stage 5: Client.MainConsoleClient.MainConsole is the main client binary, which is the last stage of PuppetLoader’s infection chain.The client is written in C++ and the code is structured in several classes that handle different tasks, suchas managing the interactive shell, uploading and downloading files, installing new modules, monitoringvictim behavior, and executing callback functions when conditions are met.• CPipeCmdManager – interactive shell managerArguments:-flushusersession-createcmd-destorycmd (sic)10 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites-excutecmd-cmdkeepalive• CommonLib::CcmdMulArgDecoder – command-line argument decoder, additional module related tocommand-line argumentsArguments:-ModuleLog-LogText-ModuleID-ModuleVersion-MountStatus-Path-IsDelete-ModuleKeepAlive-UploadFileThe client then establishes communication with a command-and-control (C&C) server via UDP (UserDatagram Protocol) and recognizes different types of custom UDP packets.UDP packetDescriptionRemoteModuleCommandPacketCommand to be executed by interactive shellRemoteModuleCommandResultPacketResult of running shell commandFileTransferContent_PacketDetermines whether to upload or download a fileUploadFilePacketUploaded file contentFileManage_FolderContent_PacketFolder contentVecProcessPacketInstallModulePacketRemoteClientSystemInfoPacketVector object with running processesBMP file with encrypted module to be installedSent by login callback every time a new user logs iptables rules. Trojan will automatically execute the command “iptables -F”close_iptable=0;运行目录，启动之后会复制自身到这个目录来运行 – Running directory to where it will copy Chinese DNS server.23)Disguised process name appearing in “ps” outputIdentifies whether persistence is enabled or notDeveloper’s remarksDirectory containing additional plug-insExecution of monitoring process time intervalCommands to be executed by the monitoring processAutomatically flushes firewall (iptables) rules if the value is 1. If the value is 0, nothing happens.Directory from which the malicious executable is launchedTable 4. The additional fields in the Linux version of HelloBotThe following is the decrypted Windows version of HelloBot. (The decrypted configuration file includedcomments in Chinese. We translated these comments to English for this report).19 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites[main];上线域名端口 – Active domain name and porthost0=win.googie.ph:443;组名称 – Group namegroup=windows;设置互斥，为空不设置互斥体 – Set a mutex; it will not set the mutex if it is null/emptymutex=;自启动注册表键值 – Autostart registry key valueautorun_key=ctfmon;安装后的文件名 注意：目录必须存在 – Filename after installation. Note: The directory must existinstall_path=c:\windows\system32\ctfmon3.jpg;上线间隔 5 秒重连一下 – Reconnect every 5 secondsretry_interval=5;自启动 – Self-start/self-bootauto_start=1;备注 – Remarknote=-;服务名称 – Service namesvr_name=NetCrypt;服务描述 – Service descriptionsvr_desc=Crypt data transfer on local network;服务显示名称 – Service display namesvr_display_name=Net.Crypt;0 UDP 1 TCP 2 UDP & TCP 3 HTTPprotocol=120 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesThe following table indicates the additional fields in the Windows version.FieldDescriptionmutexName of a mutex set by the malwareautorun_keyValue of the registry key set for persistencesvr_namesvr_descName of the service used for persistenceDescription of the service used for persistencesvr_display_nameDisplay name of the service used for persistenceauto_startprotocolIdentifies whether persistence is enabled or notProtocol used for network communication (UDP, TCP, UDP and TCP, or HTTP)Table 5. The additional fields in the Windows version of HelloBotWe found the “note” values “rootkit” and “web”. We also found the following “group” values in multipleconfiguration files, some of which have possible China- or gambling-related meanings.NoteCould refer to the AITE Institute,24 an international school that has CFileTask, CPortMapTask, and CProxyTaskPerforms file operations such as move, delete, list files, upload, “mì mì (密密)” means “secret,” ergo “secret chat application.” The website links to an installer for both Windows and macOS.If the width of a web browser was lower than 720 pixels, the mobile version of the website was displayed.However, based on our experience, the Android and iOS links were empty or did not contain any values.We are unsure if the website’s template was not properly customized at the time of our investigation or ifthe malicious actors behind the website had planned to target those platforms in the future.28 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesFigure 19. The MiMi chat website as displayed on a screenwith a width higher than 720 pixelsFigure 20. The MiMi chat website as displayed on a screenwith a width lower than 720 pixels (mobile version)29 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesWe could not find any public source for MiMi, so we do not know if the malicious actors behind thechat app wrote it from scratch or if it impersonates a private platform that is relevant to its targets. Itis common for gambling companies in China to use custom chat apps to avoid being spied on by thegovernment. A “private” chat app like this could be an attractive lure as users would think that it wouldnot be monitored by the government, unlike popular chat apps such as WeChat.Installation begins once the MiMi app executable is launched. Meanwhile, another executable withmalware is also downloaded and runs in the background. After the MiMi chat app has been successfullydownloaded, the app’s chat user interface appears.Figure 21. Installation of the MiMi chat app, which begins immediately after the MiMi chat app executable is launchedFigure 22. The launched MiMi chat user interface, shown while another executable with malwareis running in the backgroundBoth the executable’s icon and the image displayed next to the login prompt were taken from publicsources.3430 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesFigure 23. The MiMi chat app registration screen, with the mobile number registration fieldfeaturing a drop-down menu with mostly Asian phone number prefixesMiMi prompts new users to register with either a phone number or an email address. The choices ofcountries that the app supports are limited to the US, Canada, and Asian countries, based on the phonenumber prefixes available in the drop-down menu:• +1: USA• +1: Canada• +63: Philippines• +65: Singapore• +66: Thailand• +81: Japan• +82: South Korea• +852: Hong Kong• +853: Macao• +86: China• +886: TaiwanThis reinforces our belief that gambling websites catering to Asian countries are the primary targets ofEarth Berberoka.31 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesThe MiMi chat app is written using Electron JS, a JavaScript framework using the Node.js runtime softwarestack. In the Resources/app/package.json file, the “private” item is set to “True”, which means that thepackage is not intended for publication. Also, the “main” item points to the ./electron-main.js file, whichcontains some lines that are processed after Electron has finished initializing.35In the macOS version of the MiMi chat app, two different executables are referenced:••./mimi.app/Contents/Resources/app/statics/deps/windowsx64./mimi.app/Contents/Resources/app/statics/deps/darwinx64They are both samples of the oRAT malware that we discuss in a previous subsection of this report. Theyare of the same malware variant — one is compiled in the PE format while the other is compiled as aMach-O executable — and both can be found in the mimi.app/Contents/Resources/app/statics/depsfolder after decompression of the DMG file. Ironically, the Windows executable will never be launchedsince a DMG file will never run on the Windows platform.Figure 24. An excerpt of the macOS version of electron-main.js (beautified)On the Windows platform, the electron-main.js file references a file named USOPrivate.Figure 25. An excerpt of the Windows version of electro-main.js (beautified)32 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesThe resources/app/statics/deps folder contains three files:•••resources/app/statics/deps/USOPrivate.exeresources/app/statics/deps/log.dllresources/app/statics/deps/USOPrivate.datThe USOPrivate.exe file is a legitimate file signed by Bitdefender and is vulnerable to DLL sideloading.By exploiting an untrusted search path vulnerability (CVE-2019-17100),36 the malicious log.dll file isloaded, which in turn loads the USOPrivate.dat file in memory and executes the code inside it. After beingunpacked in memory, the resulting sample is a recent 64-bit version of the PlugX malware.VisitsDeliversTargetChat app’s websiteElectron JS chat appLoads(if Windows)PlugX malwareLoads(if macOS)oRAT malwareFigure 26. Earth Berberoka’s infection chain via the MiMi chat app’s websiteFake BitGet AppIn our investigation, we also saw that Earth Berberoka had created a fake BitGet app for macOS. BitGetis a Singapore-based cryptocurrency exchange app.The preinstall script of the fake BitGet app downloads and executes the oRAT malware.Figure 27. The preinstall script of the fake BitGet appFake Website Delivering Backdoored Adobe Flash Player InstallerWe noticed that Earth Berberoka exploited a persistent cross-site scripting (XSS) vulnerability in alegitimate website to execute JavaScript code hosted in a third-party server. The injected code calls aPHP script named xss.php, verifies that the victim is running Windows, and sets a cookie to ensure thecode will not be executed more than once. Then, it displays a pop-up with a message in Chinese statingthat the version of Adobe Flash Player is too old to display the content and redirects the victim to awebsite offering Adobe Flash Player.33 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesFigure 28. An XSS attack pop-up message on a legitimate websiteWe found multiple websites that promise victims a free version of Adobe Flash Player but in fact tricksthem into downloading malware. While this technique is not new, we thought that the lure would not beas appealing to users since Adobe has not supported Flash Player since Dec. 31, 2020, and all majorbrowsers have disabled Flash plug-ins. However, we discovered that Adobe officially allows a third-partyeditor to deliver a version of Flash Player in mainland China through the flash.cn website.VisitsLoads JS code and PHP scriptLegitimate websiteXSS platformRedirectsTargetC&C or download serverFalls forlureDeliversConnects toFake AdobeFlash Player websiteMalwareFigure 29. Earth Berberoka’s infection chain via a fake website offering a backdooredAdobe Flash Player installerThis malicious website is also written in Chinese, which is consistent with the other fake websites relatedto Earth Berberoka’s campaign. This suggests that Earth Berberoka primarily targets Chinese-speakingindividuals.34 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesFigure 30. A Fake Chinese Adobe Flash Player websiteAll of the Earth Berberoka–related websites that we analyzed looked identical and delivered differentpayloads throughout 2021.During our investigation of the third-party server hosting the injected JavaScript code and xss.php script, we noticed that it also hosted an authentication page titled “Xss平台”, which means “Xss platform.”Figure 31. An XSS platform authentication pageThe message at the bottom of the page is a disclaimer explaining that it is a private access platform andthat there are free XSS platforms available on the internet. Upon checking the HTML source code of this authentication page, we noticed a comment advising to compare the hash of a file named “XSS平台源 码.rar” (“XSS platform source code”) with the hash stored in a now-closed Chinese forum. This comment suggests that the source code for the XSS platform was downloaded from that forum. Our assumptionis that this platform allows malicious actors to automatically search for XSS vulnerabilities in remotewebsites and inject code of their choice. The invoked xss.php script is probably meant to collect statisticson or keep track of victims.Based on our telemetry, we saw that two websites were exploited. One is a news website aimed at theChinese community of a large US city, while the second is an unknown website that was offline and hadno domain name at the time of our investigation.35 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesAttributionC&C domainshopingchina.netOperation DRBControlDomain name (passive DNS)Winnti(Casper/Lead)Connectingthe dotsHyperBroXnoteChinaZOperation PZCHaoIron TigerSigning certiﬁcatefrom GravityFigure 32. Potential links between different threat actor groupsOne of the DLLs used in one of the 64-bit PlugX samples that we found was signed with a stolen certificatefrom the Gravity company. QuoIntelligence believes that Gravity might be one of the gaming companiestargeted by the Winnti group.37 If this proves to be true, Earth Berberoka could be linked to the Winntigroup, based on ESET’s description of the Winnti group in its paper.38One of the Xnote samples we found had linux[.]shopingchina[.]net as its C&C domain. We previously sawthe shopingchina[.]net domain during our investigation of Operation DRBControl.We linked the shopingchina[.]net domain to the following malware families:• A Type 1 sample with test66[.]shopingchina[.]net as its C&C domain• Trochilus samples with fn[.]shopingchina[.]net as their C&C domain• MFC keyloggers with jqb[.]shopingchina[.]net as their C&C domainWe have yet to see the Type 1 malware family, which is a backdoor written in C++ that uses Dropbox asa secondary C&C channel, being used by other threat actors. However, this does not mean it could notbe a shared tool.36 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesThere are two potential connections between Earth Berberoka and Iron Tiger. It should be noted, though,that the possibility of these groups’ being connected is slim. In Operation DRBControl, the HyperBromalware family was used, and we have come to associate it with the Iron Tiger group.According to Dr.Web, Xnote was developed by the ChinaZ group.39 And because of a shared Gh0st RATRC4 decryption key, a report by Intezer mentions some links between ChinaZ and Operation PZChao,40which Bitdefender also believes to be linked to Iron Tiger.41Operation DRBControl also has some links to the Winnti group, according to a report by ClearSky CyberSecurity that features Operation DRBControl’s infrastructure and samples.42 More specifically, BlackBerryattributes the related domain names to the Casper APT group (aka Lead).43, 44Because these links are extremely complicated and do not provide evidence for strict attribution, wedecided to name the threat actors behind this operation. One of our goals for publishing our findings is tohelp other researchers in making their own assessments.Regarding Earth Berberoka’s origin, several clues point toward Chinese-speaking threat actors, althoughnone of them are high-confidence:• The encrypted configuration of some HelloBot samples contain comments or words in Chinese.• Some of the malware families, such as PlugX and Gh0st RAT, are known to be of Chinese origin.• A probable malware control panel we found in a domain related to this group has a login prompt inChinese.Figure 33. A probable malware control panel in Chinese37 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesConclusionThis investigation shows that the threat actor group behind this operation has a lot of manpower, on accountof the large infrastructure and the various tools it has developed and used. Based on our telemetry andother hints we discuss in this report, we were able to assess that the group primarily targets the gamblingindustry catering to Asia, more specifically Chinese-speaking users and operators of gambling websites.Earth Berberoka uses a plethora of tools. Some of these are malware families that have existed for morethan 10 years and that the group has enhanced, while others are malware families that it seemingly builtspecifically for this campaign. It is also interesting to see Earth Berberoka’s use of portable frameworksand languages such as Electron JS and Golang to target multiple platforms.We also found that some Linux malware families that were believed to have been used for cybercrimecould also be used for espionage. Earth Berberoka did not hesitate to use open-source malware familiessuch as the Pupy RAT and the Reptile rootkit for this purpose.Finally, this investigation shows the difficulty in attributing such an infrastructure when the threat actorsbehind it use tools that are shared among multiple groups.4538 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesReferences1 S. Lock. (March 10, 2022). Statista. “Market size of the online gambling industry worldwide from 2019 to 2023.” Last accessedon April 11, 2022, at url University of Bristol. (May 17, 2021). ScienceDaily. “Study shows online gambling soared during lockdown, especially amongregular gamblers.” Accessed on April 11, 2022, at url Trend Micro Research. (Feb. 18, 2020). Trend Micro Security News. “Operation DRBControl: Uncovering a Cyberespionage Campaign Targeting Gambling Companies in Southeast Asia.” Accessed on April 1, 2022, at url vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling- companies-in-southeast-asia.4Ionut Ilascu. (March 31, 2021). Bleeping Computer. “800Gbps DDoS extortion attack hits gambling company.” Accessed on April 11, 2022, at url company/.5 Nick Carr (@ItsReallyNick). (May 15, 2020). Twitter. Accessed on April 18, 2022, at url Microsoft. (Oct. 7, 2021). Microsoft. “PEB_LDR_DATA structure (winternl.h).” Accessed on April 1, 2022, at url Denis Denisov. (Nov. 21, 2020). GitHub. “go-lang tls.” Accessed on April 4, 2022, at url Lucas Clemente. (March 22, 2022). GitHub. “quic-go.” Accessed on April 4, 2022, at url Develop Paper. (Dec. 12, 2020). Develop Paper. “Understanding the implementation of HTTP server in golang.” Accessed onApril 4, 2022, at url Daniel Lunghi and Jaromir Horejsi. (April 27, 2022). Trend Micro Research, News, and Perspectives. “New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware.” Accessed on May 6, 2022, at url com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html.11 Trend Micro. (Sept. 17, 2012). Trend Micro Research, News, and Perspectives. “Unplugging PlugX Capabilities.” Accessed onApril 5, 2022, at url Fabien Perigaud. (June 1, 2014). Airbus Cybersecurity. “PlugX: some uncovered points.” Accessed on April 5, 2022, at url MITRE ATT&CK. (April 23, 2021). MITRE ATT&CK. “gh0st RAT.” Accessed on April 6, 2022, at url Trend Micro. (Sept. 21, 2012). Trend Micro Threat Encyclopedia. “GHOSTRAT.” Accessed on April 6, 2022, at url ThaiHostTalk. (n.d.). ThaiHostTalk. “I am virus! Fuck You slight_smile คััยเคัยเจออาการนี้้�มั่ั�งคัับ ขอคัำาปรึกษาหนี้่อย.” Accessed onApril 6, 2022, at url National Cybersecurity and Communications Integration Center. (March 2017). ICS-CERT. “Destructive Malware.” Accessed on April 6, 2022, at url Dr.Web. (May 12, 2015). Dr.Web. “Linux.BackDoor.Xnote.1.” Accessed on April 6, 2022, at url Weibu Intelligence Bureau. (April 16, 2019). Snowflake News. “Analysis Report of XJ Gang of Gaming Black Production |Weibu Online Report.” Accessed on May 6, 2022, at url Dr.Web. (Feb. 5, 2015). Dr.Web. “New Linux backdoor carries extensive payload.” Accessed on May 6, 2022, at url Trend Micro Research. (Feb. 18, 2020). Trend Micro Security News. “Operation DRBControl: Uncovering a Cyberespionage Campaign Targeting Gambling Companies in Southeast Asia.” Accessed on April 6, 2022, at url vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling- companies-in-southeast-asia.39 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites21 w88you. (n.d.). w88you. “W88 Malaysia.” Accessed on April 6, 2022, at url Imgur. (Jan. 4, 2019). Imgur. “Linux / HelloBot (bot / backdoor / new china origin ELF malware).” Accessed on April 6, 2022, aturl 114DNS. (n.d.). 114DNS. “114DNS.” Accessed on April 6, 2022, at url AITE Institute. (n.d.). AITE Institute. “About us.” Accessed on April 6, 2022, at url IDC China. (n.d.). IDC China. “IDC China.” Accessed on April 6, 2022, at url BetVision. (n.d.). BetVision. “BetVision.” Accessed on April 19, 2022, at url Virus Bulletin. (Sept. 4, 2013). Virus Bulletin. “Malware spoofing HTTP Host header to hide C&C communication.” Accessedon April 6, 2022, at url communication/.28 unixman83. (Jan. 12, 2012). Stack Overflow. “What does a zlib header look like?” Accessed on May 8, 2022, at url Brian Krebs. (Oct. 24, 2010). Krebs On Security. “SpyEye v. ZeuS Rivalry Ends in Quiet Merger.” Accessed on April 6, 2022, aturl n1nj4sec. (Sep. 2, 2021). GitHub. “pupy.” Accessed on May 6, 2022, at url Ighor Augusto. (June 28, 2020). GitHub. “Reptile.” Accessed on April 6, 2022, at url Ighor Augusto. (June 28, 2020). GitHub. “Reptile.” Accessed on April 6, 2022, at url Ilya V. Matveychikov. (Feb. 5, 2020). GitHub. “kmatryoshka.” Accessed on April 6, 2022, at url Helena Zhang. (n.d.). Icon Bolt. “Chat teardrop dots icon.” Accessed on May 6, 2022, at url Electron. (n.d.). Electron. “app.” Accessed on May 6, 2022, at url#event-ready.36 Bitdefender. (Dec. 19, 2019). Bitdefender. “Untrusted Search Path vulnerability in Bitdefender Total Security 2020 (VA-5895).”Accessed on May 8, 2022, at url bitdefender-total-security-2020-va-5895/.37 QuoIntelligence. (April 20, 2020). QuoIntelligence. “WINNTI GROUP: Insights From the Past.” Accessed on May 6, 2022, aturl Marc-Etienne Léveillé and Mathieu Tartare. (Oct. 2019). ESET Research White Papers. “CONNECTING THE DOTS: Exposingthe arsenal and methods of the Winnti Group.” Accessed on April 10, 2022, at url uploads/2019/10/ESET_Winnti.pdf.39 Dr.Web. (May 12, 2015). Dr.Web. “Linux.BackDoor.Xnote.1. Accessed on April 11, 2022, at url Ignacio Sanmillan. (Jan. 7, 2019). Intezer. “ChinaZ Revelations: Revealing ChinaZ Relationships with other Chinese ThreatActor Groups.” Accessed on April 11, 2022, at url Ivona Alexandra Chili. (Feb. 2, 2018). Bitdefender. “Operation PZChao: a possible return of the Iron Tiger APT.” Accessed onApril 11, 2022, at url ClearSky Research Team. (July 18, 2017). ClearSky Cyber Security. “Recent Winnti Infrastructure and Samples.” Accessed onApril 11, 2022, at url BlackBerry. (2020). BlackBerry. “Decade of the RATS: Cross-Platform APT Espionage Attacks Targeting Linux, Windows andAndroid.” Accessed on April 11, 2022, at url direct/report-bb-decade-of-the-rats.pdf.44 Microsoft Defender Security Research Team. (Jan. 25, 2017). Microsoft Security. “Detecting threat actors in recent Germanindustrial attacks with Windows Defender ATP.” Accessed on April 11, 2022, at url blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp/.45 Daniel Lunghi and Jaromir Horejsi. (April 27, 2022). Trend Micro Research, News, and Perspectives. “New APT Group Earth Berberoka Targets Gambling Websites With Old and New Malware.” Accessed on May 6, 2022, at url com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html.40 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling SitesTREND MICROTM RESEARCHTrend Micro, a global leader in cybersecurity, helps to make the world safe for exchanging digital information.Trend Micro Research is powered by experts who are passionate about discovering new threats, sharing key insights, and supporting efforts to stop cybercriminals. Our global team helps identify millions of threats daily, leads the industry in vulnerability disclosures, and publishes innovative research on new threat techniques. We continually work to anticipate new threats and deliver thought- provoking research.www.trendmicro.com41 | Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites 