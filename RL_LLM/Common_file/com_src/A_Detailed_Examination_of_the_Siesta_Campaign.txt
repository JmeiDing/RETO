SolutionsServicesPartnersSupportResourcesCompanyHomeFireEye BlogsThreat ResearchMarch 2014 Threat Research Blog PostsA Detailed Examination of the Siesta Campaign A Detailed Examination of the Siesta CampaignA Detailed Examination of the Siesta CampaignMarch 12, 2014 | by Ned Moran, Mike OppenheimExecutive SummaryFireEye recently looked deeper into the activity discussed in TrendMicro’s blog and dubbed the “Siesta” campaign. The tools, modus operandi, and infrastructure used in the campaign present two possibilities: either the Chinese cyber-espionage unit APT1 is perpetrating this activity, or another group is using the same tactics and tools as the legacy APT1.The Siesta campaign reinforces the fact that analysts and network defenders should remain on the lookout for known, public indicators and for shared attributes that allow security experts to detect multiple actors with one signature.Overview OverviewOn March 6, 2014 TrendMicro reported on the Siesta Campaign. Though not explicitly stated in this report, the tactics, techniques and procedures (TTPs) described in this report share a number of characteristics with historical activity we’ve attributed to APT1 (also known as the “Comment Crew”).We witnessed this same campaign targeting a customer in the telecommunications sector on Feb. 20, 2014, using a spear-phishing message with a link toPDFmyURL - online url to pdf conversionifuedit[.]net/Healthcare_Questionnaire.zip. This zip file contained a malicious executable 02:26:242014-02-20 02:26:24www[.]microsofthomes[.]comwww[.]microsofthomes[.]comPDFmyURL - online url to pdf conversionTechniques, tactics, and procedures analysisThe TTPs described above are consistent with APT1. This group previously relied on establishing a foothold in targeted networks with following methods:Spear-phishing emails with links to archives Callback traffic to a legitimate-looking webpageAnalysis of Related SamplesA related dropper listed in the TrendMicro report on the Siesta campaign is MD5 dating as far back as 2011 — well before the release of the APT1 report. We previously discussed the value of tracking via import hashing here. Other APT1 samples with this within the dropper, and it contained a custom base64 alphabet of oWXYZabcdefghijkl123456789ABCDEFGHIJKL+/MNOPQRSTUVmn0pqrstuvwxyz. This custom alphabet was used by the malware to decode commands issued by the attacker to the victim machine and to Base64 encode the reverse shell from the victims back to the CnC server.This same custom alphabet has been used in previous APT1 samples droppers also had a portable executable (PE) resource with the SHA256 of resource contained the PDF icon used by the dropper to make the executable appear as though it was a PDF document rather than an executable. Previous APT1 samples also 03:27:552010-08-31 07:52:172010-09-16 09:57:092010-10-25 01:59:002011-04-20 07:39:012011-06-13 06:56:042012-03-26 06:50:102012-03-26 07:13:362012-05-15 09:02:25freetrade[.]allowed[.]org worldwide[.]chickenkiller[.]comworldwide[.]chickenkiller[.]com freetrade[.]allowed[.]orgwww[.]rbaparts[.]comwww[.]kayauto[.]netwww[.]kayauto[.]netwww[.]kayauto[.]netwww[.]coachmotor[.]comwww[.]rightnowautoparts[.]comwww[.]bluecoate[.]comLinks to other ActivityThis same PE resource was also used in a number of other samples deployed by thePDFmyURL - online url to pdf conversionThis same PE resource was also used in a number of other samples deployed by the “Menupass” group, which we have detailed in our Poison Ivy report. Previous Menupass Shared ToolsThis shared PE resource between what is believed to be two distinct groups (likely APT1, and Menupass) can be explained by either of the following:APT1 and Menupass are actually one and the same APT1 and Menupass share “binder” toolsPDFmyURL - online url to pdf conversionIt is unlikely that APT1 and Menupass represent the same group. We have observed noIt is unlikely that APT1 and Menupass represent the same group. We have observed no other overlaps in infrastructure or tools between these two groups. A more likely possibility is that the shared resource between APT1 and the Menupass group is a binder tool.A binder tool enables a malicious actor to add an innocuous-looking icon, such as a PDF document icon, to a malicious dropper. This technique facilitates social engineering, presenting the end user with a file that looks like a PDF document rather than an executable. Figure 1 shows a builder that enables actors to bind a JPG image icon to a malicious executable.Figure 1: Binder tool for disguising executable files as JPGsAttributionPDFmyURL - online url to pdf conversionBased on the evidence provided, the following are possibilities:Based on the evidence provided, the following are possibilities:The Siesta campaign was executed by APT1 An unknown group using tools and tactics shared by APT1 executed the Siesta campaignAlthough we are not certain that APT1 is responsible for the Siesta activity, this current campaign shares a number of distinct characteristics with previous activity attributed to APT1.So What? So What?Regardless of which group is responsible for this campaign, our analysis highlights the importance of monitoring for known indicators. As shown above, monitoring for previously disclosed indicators of compromise (IOCs), even IOCs that are years old, can yield value.Additionally, monitoring for IOCs and attributes of malware that are shared by multiple groups may also improve the effectiveness of your network defense operations. In this example, implementing detection for executables with a PE resource with a SHA256 would detect both Menupass and APT1 samples.This entry was posted on Wed Mar 12 19:57 EDT 2014 and filed under Ned Moran and Mike Oppenheim.PDFmyURL - online url to pdf conversionSign up for email updates Get information and insight on today's advanced threats from the leader in advanced threat prevention.First NameLast NameEmail AddressCompany NameThreat Research BlogProducts and Services BlogSUBSCRIBEPDFmyURL - online url to pdf conversionCompany Supplier DocumentsNew s and Events New s and Events Awards and Honors Email PreferencesTechnical Support Report Security Issue Documentation PortalFireEye Blogs Products and Services Executive PerspectivesContact Us Contact Us +1 877-347-3393 Stay ConnectedThreat Map Threat Map View the Latest Threats     Copyright © 2018 FireEye, Inc. All rights reserved. Privacy & Cookies Policy | Privacy Shield | Legal DocumentationSite Language English PDFmyURL - online url to pdf conversion 