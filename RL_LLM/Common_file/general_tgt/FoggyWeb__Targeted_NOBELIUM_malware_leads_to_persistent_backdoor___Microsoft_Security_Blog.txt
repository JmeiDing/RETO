Microsoft analyzed a new backdoor malware used by the threat actor NOBELIUM called FoggyWeb. It targets Active Directory Federation Services (AD FS) servers. FoggyWeb is loaded into the AD FS service process via a malicious DLL. It decrypts and executes another DLL that functions as the backdoor. The backdoor passively listens for HTTP requests with specific URI patterns that act as commands to exfiltrate data. It can retrieve the AD FS token signing and decryption certificates as well as the AD FS configuration database. The backdoor can also download and execute assemblies or source code payloads from the attacker. FoggyWeb leverages AD FS APIs and runs in the same context as the service for full access. This differs from external tools. Microsoft released details on the encryption, command handlers, malicious loader, and certificate theft techniques used by FoggyWeb. IOCs, hunting queries, and security recommendations like restricting AD FS admin access and using HSMs are provided. The malware shows NOBELIUM continues to evolve and heavily invest in specialized tools for persistent access. 