The document describes a highly targeted attack exploiting CVE-2022-1040 affecting firewall devices. Sophos believes two APT groups were involved based on the malware used. The attackers placed malicious files on devices by exploiting the bug. They then restarted services to execute the malware. The malware provided backdoors for remote access and exfiltration. Malware families found included Gh0st RAT, the GoMet remote access tool, and a custom ELF binary wrapped in VMProtect packer. The ELF binary contained BusyBox giving full control. Attackers had extensive knowledge from reverse engineering the firmware. They manipulated internal commands for unauthorized actions like decrypting files, data exfiltration, and filesystem manipulation. A custom CA certificate was used to spoof SSL connections. ICMP ping packets contained encrypted data to open a reverse shell. The malware could also sniff traffic. The initial attack sent a crafted exploit for authentication bypass and command injection as root. Commands tricked the firewall into retrieving then executing payloads disguised as firmware updates. Various staged scripts were used to retrieve additional payloads hosted on compromised devices and domains thematically linked to targets. Payloads were deleted after use. The attacks targeted devices with now-patched CVE-2022-1040. Sophos notified affected organizations and provided IoCs from the attacker infrastructure. The malware showed aptitude of highly skilled attackers. 