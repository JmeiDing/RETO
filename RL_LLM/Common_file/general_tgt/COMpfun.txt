The cybersecurity company Kaspersky has analyzed a new Trojan malware called COMpfun that targets diplomatic entities in Europe. The malware is spread via a spoofed visa application file that is distributed through shared directories on local networks. When opened, it drops executable files that install the Trojan. The Trojan uses an innovative HTTP status code-based command and control system to receive instructions. It sends rare HTTP status codes like 402, 422, etc. to the malware, which then executes commands like installing persistence, gathering system info, spreading via USB, etc. Data exfiltration is encrypted with an RSA public key. The malware has several spying capabilities including keylogging, screenshotting, and gathering host system and network information. It propagates via USB devices and uses thread synchronization techniques to make communications unpredictable. Kaspersky attributes the malware with medium confidence to the Turla advanced persistent threat group, based on code similarities with previous Turla tools like COMpfun and Reductor. The developers have focused on innovative techniques to bypass defenses like hijacking TLS and using rare HTTP codes. Their continued development coupled with precise targeting makes them a formidable threat actor. 