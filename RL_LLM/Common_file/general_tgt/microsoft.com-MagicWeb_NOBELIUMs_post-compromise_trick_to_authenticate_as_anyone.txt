Microsoft discovered a new post-compromise malware capability called MagicWeb used by the threat actor NOBELIUM to maintain persistence in compromised environments. MagicWeb is a malicious DLL that manipulates authentication tokens generated by Active Directory Federated Services (AD FS) servers. It was deployed after gaining admin access to an AD FS server. It injects itself into the AD FS claims process to generate tokens that let NOBELIUM bypass policies and authenticate as any user, including bypassing MFA. MagicWeb hooks legitimate AD FS methods to intercept calls and invoke its own methods for malicious actions like certificate validation bypass and claim injection. Two hardcoded OIDs act as "magic" values that trigger the malicious functionality when present in a certificate or claim. MagicWeb gives NOBELIUM a way to maintain access even during remediation efforts that could remove their presence. It poses a significant threat due to their ability to authenticate as anyone. Recommended mitigations include proper credential hygiene, isolating critical infrastructure, MFA, and upgrading to cloud solutions like Azure AD. Hunting guidance, queries, and detection details provided. The report provides in-depth technical analysis of MagicWeb's code and functionality to inform detection and response efforts against this sophisticated new capability. In summary, the report exposes a stealthy persistence technique used by NOBELIUM leveraging compromised AD FS servers, with technical details and remediation advice. 