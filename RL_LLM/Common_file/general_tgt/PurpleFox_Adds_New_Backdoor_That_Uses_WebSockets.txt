The cybersecurity company Trend Micro discovered that the threat actor group PurpleFox has developed a new backdoor malware that uses WebSockets for communication. This backdoor, nicknamed FoxSocket, was found after investigating suspicious activity in September 2021 related to a PurpleFox operator. The initial infection begins with PowerShell commands that download payloads from compromised servers that are part of the PurpleFox botnet. The payloads exploit vulnerabilities like CVE-2021-1732 to install PurpleFox components and rootkits on 64-bit Windows systems. A few days later, more suspicious PowerShell activity was detected that led to the discovery of the FoxSocket .NET backdoor. The backdoor is downloaded from the same compromised server and configured using encoded parameters that contain C&C domains. FoxSocket establishes a WebSocket connection to a C&C server, which allows for more covert and efficient communication compared to HTTP. After making the WebSocket connection, the FoxSocket malware exchanges encryption keys with the C&C server to establish an encrypted channel. It then fingerprints the victim machine and sends info about the infected system to the C&C. The malware can receive various commands like leaking files, executing processes, and more. Trend Micro discovered several active C&C servers controlling the WebSocket clients, using domains registered around the time the malware was first seen in June 2021. The rootkit capabilities allow PurpleFox to stay hidden while delivering additional payloads. Trend Micro continues to monitor these new malware variants and their activities. 