The cybersecurity company Palo Alto Networks has uncovered a series of cyberattacks targeting multiple government entities related to foreign affairs. The attacks were conducted by a threat actor group known as Sofacy, also referred to as APT28, Fancy Bear, and other names. The attacks started with a phishing email containing a weaponized Excel document. If the victim enabled macros, it installed malware that retrieved and executed additional payloads. The payloads included a custom Trojan downloader and a variant of the SofacyCarberp Trojan. The malware gathered system information and sent it to a command and control server. It was capable of downloading more malware, executing commands, and injecting code into web browsers to communicate with the C2 server. The malware uses some interesting technical methods, like simulating a screenshot keystroke to capture the screen, and resolving APIs by hashing DLL strings instead of importing them. It was configured to communicate with a C2 domain that Palo Alto Networks had previously identified as belonging to Sofacy. In summary, this appears to be a campaign by the Sofacy hacker group using phishing emails and multi-stage malware to target foreign affairs entities. The malware uses evasive techniques but still exhibits ties to Sofacy infrastructure and tools. 